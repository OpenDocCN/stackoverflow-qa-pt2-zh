# StackOverflow 问答 12717000-12717999

# spring - 从文件中读取并在 Spring Batch 中搜索另一个文件

> ID：12717000
> 
> 赞同：1
> 
> 时间：2012-10-03T21:12:30.853
> 
> 标签：spring, file, spring-batch

在我的一个 Spring Batch 过程中，我有一个输入文件。在每条记录的 ItemProcessor 中，我必须在第二个文件中搜索一个值。实现这一目标的最佳解决方案是什么？这两个文件都可能有数千条记录，我不想将第二个文件的数据放在“for”循环中。

谢谢

# delphi - Alphablend 和 TransparentBlt

> ID：12717003
> 
> 赞同：5
> 
> 时间：2012-10-03T21:12:45.683
> 
> 标签：delphi, canvas, gdi, alphablending, ownerdrawn

这个问题与我[之前](https://stackoverflow.com/q/12700165/62576)关于 SO 的问题有关。

我想将两个图层与仅应用于源图层的特定部分的 alpha 结合起来。我尝试的一种方法是将 SourceConstantAlpha 设置为 $ff （并让函数使用源层中的 alpha 通道）。

这种工作 - 虽然很慢（我想我可以通过使用 ScanLines 来加快速度），但我无法弄清楚将 alpha 通道设置为什么。该文档建议计算为：

```
st.Red  = Src.Red   + (1 - Src.Alpha) * Dst.Red 
```

我通过猜测工作尝试了几个不同的值，但我的第一个问题是：如何计算 alpha 值？

在阅读了其他一些 SO 问题后，我遇到了 TransparentBlt 函数，它可以很好地（而且很快）遮蔽但不透明，有没有办法将这两个调用结合在一起（也许使用第三层）？

```
unit MainWnd;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, ControlsEx;

type
{------------------------------------------------------------------------------}
  TfrmMain = class(TForm)
    PaintBox1: TPaintBox;
    procedure PaintBox1Paint(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmMain: TfrmMain;

implementation

{$R *.dfm}

{..............................................................................}
procedure copyToAlpha(const in_bitmap : TBitmap; const in_transparentColor : TColor;
        const in_transparency : integer);
var
  x : integer;
  y : integer;
  p : integer;
begin
  ASSERT(in_bitmap.PixelFormat = pf32bit);

  for x := 0 to in_bitmap.Width - 1 do
  begin
    for y := 0 to in_bitmap.Height - 1 do
    begin
      p := in_bitmap.Canvas.Pixels[x, y];
      if TColor(p) <> in_transparentColor then
      begin
        in_bitmap.Canvas.Pixels[x, y] := p or (in_transparency shl 24);
      end
      else
        in_bitmap.Canvas.Pixels[x, y] := p or ($ff shl 24);
    end;
  end;  
end;

{..............................................................................}
procedure alphaBlendTest(
        const in_target : TCanvas;
        const in_width : integer;
        const in_height : integer);
const
  BARSIZE = 30;
var
  bitmap  : TBitmap;
  r       : TRect;
  blendFn : BLENDFUNCTION;
  ret     : Boolean;
begin
  blendFn.BlendOp             := AC_SRC_OVER;
  blendFn.SourceConstantAlpha := $ff;
  blendFn.BlendFlags          := 0;
  blendFn.alphaFormat         := AC_SRC_ALPHA;

  bitmap := TBitmap.Create;
  try
    bitmap.Width              := in_width;
    bitmap.Height             := in_height;
    bitmap.PixelFormat        := pf32bit;
    bitmap.HandleType         := bmDIB;
    bitmap.TransparentColor   := clFuchsia;
    bitmap.Transparent        := true;  
    bitmap.Canvas.Brush.Color := clFuchsia;
    bitmap.Canvas.FillRect(Bounds(0, 0, in_width, in_height));
    bitmap.Canvas.Brush.Color := clGreen;

    r := Bounds(
        in_width div 2 - (in_width div 3) div 2,
        0,
        (in_width div 3) + 1,
        BARSIZE          + 1);

   bitmap.Canvas.Rectangle(r);
   // done drawing

   //copyToAlpha(bitmap, clFuchsia, 1);
   ret := Windows.TransparentBlt(
        in_target.Handle,
        0,
        0,
        in_width,
        in_height,
        bitmap.Canvas.Handle,
        0,
        0,
        in_width,
        in_height,
        clFuchsia);
        //blendFn);

    ASSERT(ret);
  finally
    bitmap.Free;
  end;
end;

{..............................................................................}
procedure TfrmMain.PaintBox1Paint(Sender: TObject);
var
  r: TRect;
begin
  PaintBox1.Canvas.Brush.Color := clBlue;
  r := Bounds(0, 0, PaintBox1.ClientWidth, PaintBox1.ClientHeight);
  PaintBox1.Canvas.FillRect(r);
  PaintBox1.Canvas.Brush.Color := clRed;
  PaintBox1.Canvas.Ellipse(0, 0, PaintBox1.ClientWidth, PaintBox1.ClientHeight);

  alphaBlendTest(PaintBox1.Canvas, PaintBox1.ClientWidth, PaintBox1.ClientHeight);
end;

end. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T22:35:45.077

技巧：以任何比例混合相同的颜色会产生相同的颜色。

因此，最简单的方法（也许也是最有效的方法）是首先将透明结果绘制到临时位图，然后在目标画布上对该位图进行 alphablend。

在绘图期间访问目标画布：

```
procedure TfrmMain.PaintBox1Paint(Sender: TObject);
const
  BarSize = 30;
var
  R: TRect;
  Bmp: TBitmap;
  BlendFunc: TBlendFunction;
begin
  with PaintBox1 do
  begin
    R := ClientRect;
    Canvas.Brush.Color := clBlue;
    Canvas.FillRect(R);
    Canvas.Brush.Color := clRed;
    Canvas.Ellipse(R);
    Bmp := TBitmap.Create;
    try
      Bmp.Width := Width;
      Bmp.Height := Height;
      BitBlt(Bmp.Canvas.Handle, 0, 0, Width, Height, Canvas.Handle, 0, 0,
        SRCCOPY);
      Bmp.Canvas.Brush.Color := clGreen;
      R := Bounds(Width div 3, 0, Width div 3 + 1, BarSize + 1);
      Bmp.Canvas.Rectangle(R);
      BlendFunc.BlendOp := AC_SRC_OVER;
      BlendFunc.BlendFlags := 0;
      BlendFunc.SourceConstantAlpha := 80;
      BlendFunc.AlphaFormat := 0;
      Windows.AlphaBlend(Canvas.Handle, 0, 0, Width, Height, Bmp.Canvas.Handle,
        0, 0, Width, Height, BlendFunc);
    finally
      Bmp.Free;
    end;
  end;
end; 
```

并且在绘图期间无法访问目标画布：

```
procedure GetRemoteBitmap(Bmp: TBitmap; Width, Height: Integer);
const
  BarSize = 30;
var
  R: TRect;
begin
  Bmp.Canvas.Brush.Color := clFuchsia;
  Bmp.Width := Width;
  Bmp.Height := Height;
  Bmp.TransparentColor := clFuchsia;
  Bmp.Transparent := True;
  Bmp.Canvas.Brush.Color := clGreen;
  R := Bounds(Width div 3, 0, Width div 3 + 1, BarSize + 1);
  Bmp.Canvas.Rectangle(R);
end;

procedure TfrmMain.PaintBox1Paint(Sender: TObject);
var
  R: TRect;
  Bmp: TBitmap;
  Tmp: TBitmap;
  BlendFunc: TBlendFunction;
begin
  with PaintBox1 do
  begin
    R := ClientRect;
    Canvas.Brush.Color := clBlue;
    Canvas.FillRect(R);
    Canvas.Brush.Color := clRed;
    Canvas.Ellipse(R);
    Bmp := TBitmap.Create;
    Tmp := TBitmap.Create;
    try
      GetRemoteBitmap(Bmp, Width, Height);
      Tmp.Width := Width;
      Tmp.Height := Height;
      BitBlt(Tmp.Canvas.Handle, 0, 0, Width, Height, Canvas.Handle, 0, 0,
        SRCCOPY);
      TransparentBlt(Tmp.Canvas.Handle, 0, 0, Width, Height, Bmp.Canvas.Handle,
        0, 0, Width, Height, ColorToRGB(clFuchsia));
      BlendFunc.BlendOp := AC_SRC_OVER;
      BlendFunc.BlendFlags := 0;
      BlendFunc.SourceConstantAlpha := 80;
      BlendFunc.AlphaFormat := 0;
      Windows.AlphaBlend(Canvas.Handle, 0, 0, Width, Height, Tmp.Canvas.Handle,
        0, 0, Width, Height, BlendFunc);
    finally
      Tmp.Free;
      Bmp.Free;
    end;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T23:27:59.220

只是为了完整起见（*“我如何计算 alpha 值？”*）：

```
procedure alphaBlendTest(
        const in_target : TCanvas;
        const in_width : integer;
        const in_height : integer);
const
  BARSIZE = 30;
var
  bitmap  : TBitmap;
  r       : TRect;
  blendFn : BLENDFUNCTION;
  ret     : Boolean;

  x, y: Integer;
  px : PRGBQuad;
begin
  blendFn.BlendOp             := AC_SRC_OVER;
  blendFn.SourceConstantAlpha := $ff;
  blendFn.BlendFlags          := 0;
  blendFn.alphaFormat         := AC_SRC_ALPHA;

  bitmap := TBitmap.Create;
  try
    bitmap.Width              := in_width;
    bitmap.Height             := in_height;
    bitmap.PixelFormat        := pf32bit;
    bitmap.Canvas.Brush.Color := clGreen;

    r := Bounds(
        in_width div 2 - (in_width div 3) div 2,
        0,
        (in_width div 3) + 1,
        BARSIZE          + 1);

    bitmap.Canvas.Rectangle(r);

    for y := 0 to bitmap.Height - 1 do begin
      px := bitmap.ScanLine[y];
      for x := 0 to Bitmap.Width - 1 do begin
        if PtInRect(r, Point(x, y)) then begin
          px.rgbBlue := MulDiv(px.rgbBlue, $A0, $FF);
          px.rgbGreen := MulDiv(px.rgbGreen, $A0, $FF);
          px.rgbRed := MulDiv(px.rgbRed, $A0, $FF);
          px.rgbReserved := $A0;
        end else 
          px.rgbReserved := $00;  // fully transparent
        Inc(px);
      end;
    end;
   // done drawing

   ret := Windows.AlphaBlend(
        in_target.Handle,
        0,
        0,
        in_width,
        in_height,
        bitmap.Canvas.Handle,
        0,
        0,
        in_width,
        in_height,
        blendFn);

    ASSERT(ret);
  finally
    bitmap.Free;
  end;
end; 
```

# c# - unity 基于方法注解拦截变更调用处理程序

> ID：12717009
> 
> 赞同：4
> 
> 时间：2012-10-03T21:13:31.953
> 
> 标签：c#, unity-container, aop, interceptor

我在一个类中有一个方法，我想拦截如下：

```
[CustomTag1(Order = 0)]
[CustomTag2(Order = 1)]
public virtual DoSomething() 
```

使用时如何将订单值注入`ICallHandler.Order`属性`CustomAttributeMatchingRule`？

我不希望订单被硬编码到处理程序本身或注册时。我希望它是方法注释的 Order 属性的变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T23:03:29.620

我已经使用 HandlerAttribute 实现了这一点 - 通常我在 Unity 中使用它来进行属性样式拦截只是因为您不必费心手动创建策略 - 相反，您只需将 HandlerAttribute 应用于您的代码，Unity 将自动创建一个给你的政策。

无论如何，这样的事情可能就是你所追求的。首先像往常一样定义一个调用处理程序，除了参数化它：-

```
public class MyCallHandler : ICallHandler
{
    public MyCallHandler(Int32 value)
    {
        Order = value;
    }

    public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
    {
        Console.WriteLine("Parameterised call handler!");
        return getNext()(input, getNext);
    }

    public int Order { get; set; }
} 
```

现在不要使用 CustomTagAttribute，而是使用 HandlerAttribute：-

```
public class MyHandler : HandlerAttribute
{
    private readonly Int32 value;
    public MyHandler(Int32 value)
    {
        this.value = value;
    }

    public override ICallHandler CreateHandler(IUnityContainer container)
    {
        return new MyCallHandler(value);
    }
} 
```

MyHandler 应用于您的课程。CreateHandler 方法被调用，此时它创建了一个 MyCallHandler 实例：-

```
public class MyClass
{
    [MyHandler(2)] // Order of 2
    public virtual void Foo()
    {
        Console.WriteLine("Inside method!");
    }
} 
```

请注意，我故意将这两个类分开，但实际上您可以只让一个类实现 ICallHandler 接口和 HandlerAttribute 抽象方法（只返回“this”）。

如果没有 HandlerAttribute，您可能可以使用您自己的自定义属性来实现类似的目标，但它可以节省您的时间，因为您无需费心创建自己的策略。

需要注意的一件事 - 如果您采用参数化方法，则不能将调用处理程序作为单例，因为每次都会根据您希望它的顺序创建不同的实例。

# .net-4.5 - AppHarbor 错误 .NET 4.5 .asmx 尚未预编译，无法请求

> ID：12717010
> 
> 赞同：1
> 
> 时间：2012-10-03T21:13:38.343
> 
> 标签：.net-4.5, appharbor

我希望这个老式的 .asmx 文件在 AppHarbor 上与 .NET 4.5 一起使用，但它给了我这个我在本地看不到的错误。有任何想法吗？

是因为我最近转向了 .NET 4.5 吗？该应用程序的其余部分都很好。

```
.asmx has not been pre-compiled, and cannot be requested. 
```

这是一些堆栈跟踪

> System.Web.Compilation.BuildManager.GetVPathBuildResultInternal（VirtualPath virtualPath，布尔 noBuild，布尔allowCrossApp，布尔allowBuildInPrecompile，布尔throwIfNotFound，布尔ensureIsUpToDate）+692
> 
> System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert（HttpContext 上下文，VirtualPath virtualPath，布尔 noBuild，布尔allowCrossApp，布尔allowBuildInPrecompile，布尔throwIfNotFound，布尔ensureIsUpToDate）+103
> 
> System.Web.Compilation.BuildManager.GetVPathBuildResult（HttpContext上下文，VirtualPath virtualPath，布尔noBuild，布尔allowCrossApp，布尔allowBuildInPrecompile，布尔ensureIsUpToDate）+48
> 
> System.Web.Compilation.BuildManager.GetVPathBuildResult(HttpContext context, VirtualPath virtualPath) +16

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T18:40:36.713

万一有人遇到这个......我最终将.asmx功能（我只有一个）重新编写到我的待办事项列表中的WebApi中......所以我只是将它提升到优先级并摆脱了完全是旧技术。

另外值得注意的是，我需要将一个 .gitignore 文件添加到我的项目的根目录中，我最终这样做了......

```
bin/*.dll
obj/*.dll
obj/Debug/*.dll
obj/Debug/TempPE/*.dll 
```

# .htaccess - 如何使用 htaccess 在第一个斜杠之后重定向任何请求

> ID：12717014
> 
> 赞同：2
> 
> 时间：2012-10-03T21:13:51.447
> 
> 标签：.htaccess, webserver

我想使用 htaccess 重定向到一个 cchecks 查询字符串并将其发送到正确页面的页面。例如[http://domain.com/test/one/](http://domain.com/test/one/)被重定向到[http://domain.com/index.php?route=/test/one/](http://domain.com/index.php?route=/test/one/)而不更改浏览器中的 url 结构或修改它。我希望 htaccess 在第一个斜杠之后拾取任何内容并将其发送到 index.php 文件。

PS我发现这个链接[htaccess重定向任何请求](https://stackoverflow.com/questions/9091773/htaccess-to-redirect-any-request)，但它修改了url并抛出301。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:22:19.337

在文档根目录的 htaccess 文件中添加以下规则：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?(.*)$ /index.php?route=/$1 [L,QSA] 
```

另一个答案是通过 301 重定向的原因是该`R=301`标志位于`RewriteRule`.

# magento - 如何在 Magento 的列网格中添加自定义过滤器？

> ID：12717016
> 
> 赞同：2
> 
> 时间：2012-10-03T21:14:03.810
> 
> 标签：magento, magento-1.7

我在 Adminhtml 中有自定义网格。

```
protected function _prepareCollection()
{
    /* @var $collection Mage_Catalog_Model_Resource_Product_Collection */
    $collection = Mage::getModel('catalog/product')->getCollection();
    $collection->addAttributeToSelect('*');
    $collection->joinField('category_id', 'catalog/category_product', 'category_id', 'product_id=entity_id', null, 'left');
    $collection->groupByAttribute('entity_id');
    $collection->addStaticField('category_id');
    $collection->addExpressionAttributeToSelect('category_grp', 'GROUP_CONCAT(category_id)', 'category_id');

    $this->setCollection($collection);
    return parent::_prepareCollection();
}

protected function _prepareColumns()
{
    parent::_prepareColumns();

 $this->addColumn('category_id', array(
        'header'    => Mage::helper('newsletter')->__('Category'),
        'index'     => 'category_grp',
        'type'      => 'categories',
        'options'   => $options,
        'align'     => 'left',
//      'filter_index' => $this->_getFlatExpressionColumn('category'),
    return $this;
} 
```

category_grp 是带有 int 的数组

我的问题是如何将过滤器添加到从字段中过滤项目的标题列？

例如，仅过滤 category_id=7 的产品（category_grp 为 3、6、7、13）...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T09:11:36.020

我认为您不需要任何自定义过滤器。
只需尝试设置`index`符合字段名称：

```
'index'     => 'category_id', 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T10:04:47.313

看看magento`filter_condition_callback`选项

```
$this->addColumn('categories', array(
                   ....                      
                   'filter_condition_callback' => array($this, '_applyMyFilter'),
                    ..
                 )
 );

 protected function _filterCategoriesCondition($collection, $column)
 {
     if (!$value = $column->getFilter()->getValue()) {
         return;
     }

     $this->getCollection()->addFieldToFilter('categories', array('finset' => $value));
 } 
```

看

*   [在 Magento Admin Grid 中过滤具有 MySQL 计算值的文本类型列](https://stackoverflow.com/questions/9530287/filtering-a-text-type-column-with-mysql-computed-values-in-magento-admin-grid)
*   [Magento：如何在管理网格中按多选属性搜索或过滤？](http://blog.chapagain.com.np/magento-how-to-search-or-filter-by-multiselect-attribute-in-admin-grid/)

# php - 将字符串转换为日期

> ID：12717018
> 
> 赞同：-1
> 
> 时间：2012-10-03T21:14:13.423
> 
> 标签：php, date

嗨，我知道这个问题有点琐碎。我用谷歌搜索，但在任何地方都找不到确切的问题。

我有一个包含应用程序填写日期的字符串，如何将此字符串转换为日期

```
 $appln_filling_date = '20020315'; 
```

appln_filling_date 的类型是字符串，我想将其类型转换为日期并希望数据保持不变。数据库中的字段具有类型日期。

**编辑**

这就是我想要做的

```
 $appln_filling_date = strtotime($appln_data['bibliographic-data']['application-reference']['document-id']['1']['date']['$']);
 $appln_filling_date = date('Y-m-d', $appln_filling_date); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T21:17:05.670

如果您的日期采用某些[标准日期格式](http://www.php.net/manual/en/datetime.formats.date.php)，请使用以下示例：

```
$d = new DateTime('20020315');
echo $d->format('Y-m-d');

# or [if you do not have DateTime, which is in php >= 5.2.0]

$t = strtotime('20020315');
echo date('Y-m-d', $t); 
```

如果您的日期不是某种标准格式，请使用以下示例：

```
$d = DateTime::createFromFormat('d . Y - m', '15 . 2002 - 03');
echo $d->format('Y-m-d'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:18:16.790

```
$date = DateTime::createFromFormat('Ymd', $appln_filling_date); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T23:47:43.907

这对我来说就像一个魅力

```
 $appln_filling_date = $appln_data['bibliographic-data']['application-reference']['document-id']['1']['date']['$'];
 $appln_filling_date = date_create(date('Y-m-d', $appln_filling_date)); 
```

感谢您的反对票

# javascript - CSS/JQUERY 使 div 可滚动而不显示滚动条

> ID：12717021
> 
> 赞同：3
> 
> 时间：2012-10-03T21:14:21.453
> 
> 标签：javascript, jquery, css, twitter-bootstrap

有什么方法可以使 div 可以使用 overflow-y:hidden 滚动；和溢出-x：隐藏？

我正在尝试没有成功，也许我需要一些 js 或 jquery 脚本？

我的意思是，我想让 div 在 y 轴上滚动而不在右侧显示滚动条（就像现在一样）。

试了：

```
.get-list{
  position:absolute;
  z-index:444;
  text-align: center;
  display: none;
  bottom:0;
  clear:both !important;
  left:0;
  right:0;
  top:11%;

  margin:0 auto;
  background:#fff;
  max-height:800px;
  overflow-y:no-display;
  overflow-x:hidden;
  display: block;
 } 
```

谢谢

编辑

```
.log-widget-list{
  position:absolute;
  z-index:444;
  text-align: center;
  display: none;
  width:99%;
  margin:0 auto;
  background:#fff;
  height:800px;
  overflow: hidden;
 }

.log-widget-list .scroller{
  overflow: scroll; 
  height:800px;
  width:100%;
} 
```

无论如何它都会显示正确的滚动条

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T21:24:06.260

让我们创建一个宽度为 200px 的 div：（注意`overflow:hidden`）

```
#sidebar{
width: 200px;
height: 300px;
border: 1px solid #000;
overflow: hidden;
} 
```

在该 div 中，我们将创建“可滚动”的 div。看：

```
#sidebar #scroller{
    width: 215px;
    height: 300px;
    padding-bottom: 15px;
    overflow: scroll; 
}​ 
```

尽管我们给出了它`overflow:scroll`，但滚动条是不可见的。这是因为这个 div 的总宽度为 215px，这将使滚动条在 div 之外消失。

另见：http: [//jsfiddle.net/TBsN8/](http://jsfiddle.net/TBsN8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:50:22.510

由 Sebass van Boxel 修复，如图所示

```
.log-widget-list{
  position:absolute;
  display: none;
  width:98% !important;
  top:11%;
  max-height:500px;
  overflow: hidden;
  bottom:0 !important;
  left:0;
  right:0;
  margin:0 auto !important;
 }

.log-widget-list .scroller{
  overflow: scroll; 
  max-height:500px;
  padding-bottom:3%;
  width:104% !important;
} 
```

# php - PHP 与 UTF8 输出到 PHPExcel？

> ID：12717034
> 
> 赞同：4
> 
> 时间：2012-10-03T21:15:04.153
> 
> 标签：php, mysql, phpexcel

我在将数据从 utf8 mysql 数据库导出到带有 PHPExcel 并保留中文字符的 Excel 工作表时遇到问题。我的mysql db是utf8，里面有很多汉字，我将这些数据导出到一个多页xls文件（excel5）中，每次导出汉字都变成“？”。我试过 utf8_encode() 但它对我不起作用。我还尝试将输出更改为 excel2007，认为这将是一个 excel5 作家问题。

有没有办法让汉字正确导出？我必须制作整个 php 文件 utf8 吗？如果是这样，我将如何去做？

这是我遇到问题的部分：

```
$res2 = mysql_query("SHOW COLUMNS FROM ".$sheetnametemp);
while($row2 = mysql_fetch_array($res2, MYSQL_NUM)) {
  $counter = 2;
  $cell = $coltemp;
  $cell .= $counter;
  $objPHPExcel->getActiveSheet()->SetCellValue($cell, $row2[0]);
      $result = mysql_query("SELECT * FROM ".$sheetnametemp);
      while($row = mysql_fetch_array($result))
      {
        $counter++;
        $cell2 = $coltemp;
        $cell2 .= $counter;
        utf8_encode($row[$row2[0]]);
        echo "<br />";
        $objPHPExcel->getActiveSheet()->SetCellValue($cell2,utf8_encode($row[$row2[0]]));
      } 
```

我需要使用这些汉字，因为它是一个多语言目录数据库，所以将其更改为英文将无济于事。另外，如果该信息无论如何都有帮助，我目前正在使用 Xampp 的 Mac。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T20:12:12.693

设置你正在执行的 "SET NAMES utf8" 或 mysql_set_charset("UTF8", $conn); 以确保您与数据库的连接使用 UTF-8。

您可以使用 echo mysql_client_encoding($conn); 测试连接；

确保您不再尝试调用 utf8_encode() 。

注意：Excel 文件使用代码页来标识文件中使用的字符集，但 PHPExcel 在内部将该代码页设置为硬编码值 UTF-8，因此文件中的所有字符串内容都应为 UTF-8，并且Excel 也知道将 MS Excel GUI 中的工作表解释为 UTF-8。如果您在 Excel 本身中查看电子表格时没有看到中文字符，请检查 MS Excel 中的语言设置以查看它是否配置为处理中文

信用：[@马克贝克](https://stackoverflow.com/users/324584/mark-baker)。再次感谢。

# eclipse - 如何使用命令框架在 Eclipse 中为特定对象类型创建可重定向操作？

> ID：12717038
> 
> 赞同：0
> 
> 时间：2012-10-03T21:15:12.343
> 
> 标签：eclipse, command, selection

Eclipse 命令框架允许您创建通用命令和处理程序。但是，当您创建一个以“复制”为目标的扩展点时，运行时会抱怨：

```
<extension point="org.eclipse.ui.handlers">
 <handler class="example.Handler" commandId="org.eclipse.ui.edit.copy"/>
</extension>

!MESSAGE Conflicting handlers for org.eclipse.ui.edit.copy: {org.eclipse.ui.internal.handlers.WidgetMethodHandler:copy} vs {example.Handler} 
```

如果您添加一个`activeWhen`子句，以便仅在查看器中选择特定类型的对象时调用特殊处理程序，那么当您尝试复制时会出现异常：

```
<extension point="org.eclipse.ui.handlers">
 <handler class="example.Handler" commandId="org.eclipse.ui.edit.copy">
     <activeWhen>
        <with
              variable="selection">
           <iterate
                 ifEmpty="false"
                 operator="or">
              <instanceof
                    value="sample.Class">
              </instanceof>
           </iterate>
        </with>
     </activeWhen>
   </handler>
</extension>

Caused by: org.eclipse.core.commands.NotHandledException: There is no handler to execute for command org.eclipse.ui.edit.copy 
```

使用命令框架为特定类型的对象提供特定复制操作的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T00:03:18.660

你的`activeWhen`条款看起来可以接受。重要的是您要进行什么选择。前任：

```
 <handler class="z.ex.cmd.handlers.LongCopyHandler"
        commandId="org.eclipse.ui.edit.copy">
     <activeWhen>
        <with variable="selection">
           <iterate ifEmpty="false"
                 operator="and">
              <adapt type="org.eclipse.core.resources.IMarker"/>
           </iterate>
        </with>
     </activeWhen>
  </handler> 
```

我最初尝试`instanceof`在我的 activeWhen 表达式中访问标记视图中的 IMarker，但这不起作用（对象不实现 IMarker）。我不得不让`adapt`他们让我的处理程序正常工作。这也适用于包资源管理器中的 .java 文件，它们适应`IResource`但它们实际上是 IJavaElements 或其他东西。

# c# - 如何在我的 .aspx 网页中使用 C# 字符串？

> ID：12717039
> 
> 赞同：2
> 
> 时间：2012-10-03T21:15:17.007
> 
> 标签：c#, asp.net

我已使用查询字符串通过 url 将值传递给 C# .net 页面。页面的 url 如下所示：

```
http://contoso.com/products.aspx?field1=value1 
```

在 C# 中，我要抓住它：

```
String myValue = Request.QueryString["field1"]; 
```

我想做的是在页面中使用这个值，如下所示：

```
<h1><%# Eval("myValue") %></h1> 
```

我该怎么做呢？显然这个 HTML 代码不起作用。我已经用尽了一些关于这个主题的谷歌搜索，所以任何信息都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:18:39.593

您可以`Property`在页面上创建一个并使用代码标签，或者将`h1`标签设置为`runat="server"`并设置这样的值。

财产：

```
public string MyString{ get; set; }

public void Page_Load(object sender, EventArgs e)
{
    MyString = Request.QueryString["field1"];
} 
```

然后在您的标记中：

```
<h1><%= MyString %></h1> 
```

或者，使用标签`runat="server"`上的方法：`h1`

标记：

```
<h1 id="myH1" runat="server"></h1> 
```

代码：

```
myH1.InnerText = Request.QueryString["field1"].ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:18:49.077

尝试将`runat="server"`and添加`id`到您的`h1`标签中，以便您可以在 cs-file 中使用它。
HTML：

```
<h1 id="myHeader" runat="server"></h1> 
```

CS：

```
myHeader.InnerText = myValue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:20:01.837

在您的 aspx 文件中，您可以像这样定义一个文本字段：

```
 <h1 Id="label" runat="server"/> 
```

然后，在文件后面的代码中添加：

```
label.InnerText = Request.QueryString["field1"]; 
```

# visual-c++ - 通过 Windows 搜索从 MFC 程序读取文件元数据

> ID：12717040
> 
> 赞同：1
> 
> 时间：2012-10-03T21:15:21.593
> 
> 标签：visual-c++, mfc, metadata, windows-search

我想通过 Windows 搜索索引服务读取 DWG/AutoCAD 文件的元数据。我说的是可以通过在资源管理器中右键单击而无需打开 AutoCAD 来访问的属性。

我有一个用 Visual C++ 2005 编写的基于 MFC 对话框的应用程序，我想从这个应用程序内部访问给定文件的元数据（例如作者、创建日期等）。这是由 iFilter 完成的，但自 Windows XP 以来已被弃用，并且将在 Windows 8 中消失（并且 LoadIFilter 在 VS2005 中不存在）。现在据我了解，可以使用 Windows 搜索来完成 - 如果我错了，请纠正我。我找到的每个示例（包括 msdn）都显示了如何将有关您自己文件的数据提供给 windows 搜索以进行索引。我需要知道如何向 Windows Search 询问给定文件的元数据。

谢谢 tgwilk

编辑：这是我到目前为止的想法：

```
BOOL WSQ_DoQuery( const wchar_t *constr, const wchar_t *querystr, VARIANT &result ) {

    HRESULT hr = 0;

    BOOL ret;
    // Get the ADO connection
    _Connection *con = NULL;
    hr = CoCreateInstance( CLSID_Connection, NULL, CLSCTX_ALL, IID__Connection, (LPVOID *)&con );
    if ( SUCCEEDED(hr) ) {

        _Recordset *rs = NULL;

        // Convert wide strings to BSTR as required by ADO APIs
        BSTR bconstr = SysAllocString( constr );
        BSTR bquerystr = SysAllocString( querystr );

        if ( bconstr && bquerystr ) {

            // Open the connection
            hr = con->Open( bconstr, NULL, NULL, 0 );
            if ( SUCCEEDED(hr) ) {

                // Execute the query
                hr = con->Execute( bquerystr, NULL, 0, &rs );
                if ( SUCCEEDED(hr) ) {

                    // Display the results
                    ret = WSQ_GetCDate( rs ,result);
                    rs->Release();

                } else {
                    TRACE( "Failed to execute query, %08x\r\n", hr );
                }   // if
            } else {
                TRACE( "Failed to open ADO connection, %08x\r\n", hr );
            }   // if

        } else {
            TRACE("Failed to convert wide to BSTR\r\n" );
        }   // if

        con->Release();
        if ( bconstr ) {
            SysFreeString( bconstr );
        }
        if ( bquerystr ) {
            SysFreeString( bquerystr );
        }
    } else {
        TRACE("Failed to get connection, %08x\r\n", hr );
    }   // if
    return ret;
}   // DoQuery 
```

连接字符串 (constr) 是

```
provider=Search.CollatorDSO.1;EXTENDED PROPERTIES="Application=Windows" 
```

由 ISearchQueryHelper 返回。查询（querystr）是

```
SELECT System.Document.DateCreated FROM SystemIndex WHERE System.FileName LIKE 'filename%' AND DIRECTORY='file:C:\path\to\file' 
```

现在的问题是我得到了一个例外：

```
First-chance exception at 0x77c5fc56 in fraudTest.exe: Microsoft C++ exception: CNLBaseException at memory location 0x0012d6d0.. 
```

在这条线上

```
hr = con->Open( bconstr, NULL, NULL, 0 ); 
```

后跟查询的空结果（此代码来自 WSQ_GetCDate）：

```
rs->get_EOF( &eor );
while ( eor != VARIANT_TRUE ) { //this never executes } 
```

出乎意料地`SUCCEEDED(hr)`在异常之后返回 true。我在哪里犯了错误以及如何尝试找到它？

谢谢 tgwilk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T19:40:08.490

我没有解决这个特殊问题，但我了解到我不需要 Windows Search 来获取文件元数据。要查找的关键字是“属性”而不是元数据。我从名为 PropertyEdit 的 Windows SDK v7.0 示例应用程序中获得了一段代码。

# yql - YQL 财务在结果中为空

> ID：12717043
> 
> 赞同：2
> 
> 时间：2012-10-03T21:15:24.510
> 
> 标签：yql

我只是在 YQL 控制台中使用示例数据表之一。YQL 语句是`select * from yahoo.finance.stock where symbol="yhoo"`

为什么我在结果中得到空值？

[使用 YQL 语句链接到 YQL 控制台](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20yahoo.finance.stock%20where%20symbol=%22yhoo%22&env=store://datatables.org/alltableswithkeys#h=select%20%2a%20from%20yahoo.finance.stock%20where%20symbol=%22yhoo%22)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T13:58:15.017

看起来 yahoo.finance.stock YQL 数据表不再有效。在启用诊断的情况下运行时，会出现几个 JavaScript 错误。因为没有官方的 Yahoo Finance API，这个社区表是通过抓取网页来检索数据，因此很容易受到页面更改导致这样的破坏。

yahoo.finance.stocks 表似乎确实有效，但我不确定返回的数据是否是您要查找的数据。

示例查询：

[`select * from yahoo.finance.stocks where symbol="yhoo"`](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20yahoo.finance.stocks%20where%20symbol%3D%22yhoo%22&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-20T22:35:49.477

我对 yahoo.finance.stock 的运气更好（单数，没有“s”）。数据似乎得到了更好的维护。

# clojure - Lamina 撤消虹吸管 - Clojure

> ID：12717046
> 
> 赞同：4
> 
> 时间：2012-10-03T21:15:44.060
> 
> 标签：clojure, publish-subscribe, lamina-clojure

我正在使用[Lamina](https://github.com/ztellman/lamina)来实现基本的 pubsub 模式。

当客户端订阅一个主题时，我`channel`为它创建一个新主题（如果它不存在），然后`siphon`将它添加到客户端的`channel`. 但是，我不知道如何扭转这个让客户退订。我一直在搜索文档和谷歌搜索，但找不到任何东西。

我如何撤消所做`siphon`的操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T00:34:05.073

您可以`fork`将上游通道置于虹吸管上方，然后将下游通道接地，或者如果您的图表允许，您可以关闭您不再希望从上游通道虹吸的通道。

ps：我稍后会尝试添加一个示例...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T06:45:12.623

通常，您会创建一个可以关闭的桥接通道，因此链接是：

主题频道 -> 桥接频道 -> 客户频道

在 0.5.0 中，这很容易，因为 siphon 是可变参数：

```
(defn cancellable-siphon [src dst]
   (let [bridge (channel)]
     (siphon src bridge dst)
     #(close bridge))) 
```

# facebook - CodeIgniter 和 Facebook 连接

> ID：12717048
> 
> 赞同：0
> 
> 时间：2012-10-03T21:15:53.510
> 
> 标签：facebook, codeigniter, sdk

我正在尝试将我的 Codeigniter 网站与 Facebook PHP SDK 集成。我想做的是让用户在他们的 Facebook 墙上分享我网站上的文章，如果他们登录到 Facebook 帐户。我的库似乎可以正确加载，但是每次我尝试做某事时，都会出现某种错误……主要是 auth. getUser 似乎没有返回正确的结果。我设置了我的 facebook 应用程序并为我的库设置了配置变量，但没有运气。它说我没有登录facebook。当我点击“登录”锚点时，链接将我带到同一页面，但使用 facebook url，并且不要求我使用应用程序登录。这是我的代码：

 ``function facebook($article_id){

```
$config = array(
    'appId' => '276870792431073',
    'secret' => '8d49eee575413fb9a8063d22f65dbf6a'
);

$this->load->library('facebook', $config);

$user = $this->facebook->getUser();

if($user){

    try {

        $user_profile = $this->facebook->api('/me');

    } catch (FacebookApiException $e){

        error_log($e);
        $user = null;

    }

}

if($user){

    $article = $this->article->fetch_article($article_id);
    $config = array(
        'message' => 'I just read an '.anchor('articles/'.url_title($article['title']).'/'.$article_id, 'article').' on '.anchor('', 'TrackTheOutbreak.com').'!',

    );

    $this->facebook->api('/me/feed', 'post', $config);

} else {

    $data['MESSAGE_TITLE'] = 'Authentication Error';
    $data['MESSAGE_TEXT'] = 'You must be logged into an existing Facebook account to use this feature.  Click '.anchor($this->facebook->getLoginUrl(), 'here').' to login.';
    $this->parser->parse('error_body.tpl', $data);

} 
```

}`  `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T08:06:21.573

为了访问用户信息并将任何内容发布到他们的墙上，您首先需要从他们那里获取访​​问令牌。为此，您需要确保您已通过 Facebook 的 FB_login（然后是 Open Graph）获得了他们的许可。我会仔细检查本指南，并确保您已正确设置所有内容以发布到他们的时间线。

[https://developers.facebook.com/docs/reference/javascript/FB.login/](https://developers.facebook.com/docs/reference/javascript/FB.login/)

我希望这有帮助``

# php - 从 CakePHP 的 find() 返回数组访问数据

> ID：12717050
> 
> 赞同：1
> 
> 时间：2012-10-03T21:16:14.203
> 
> 标签：php, arrays, cakephp

[下面是一个由 CakePHP 的find()](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html)方法返回的数组示例：

```
Array 
(
    [Tutor] => Array 
    ( 
        [id] => 2 
        [PersonaId] => 1 
    ) 
) 
```

官方文档展示了如何获取记录，但没有展示如何遍历它们甚至读取单个值。在这一点上，我有点迷路了。我正在尝试获取`[id]`数组中的值。这是我尝试过的：

```
// $tutor is the array.
print_r($tutor[0]->id); 
```

> 注意 (8)：未定义偏移量：0 [APP\Controller\PersonasController.php，第 43 行]
> 
> 注意（8）：试图获取非对象的属性 [APP\Controller\PersonasController.php，第 43 行]

我也试过：

```
// $tutor is the array.
print_r($tutor->id); 
```

> 注意（8）：试图获取非对象的属性 [APP\Controller\PersonasController.php，第 44 行]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:19:24.433

在对象中使用访问属性的`->`方式。您向我们展示的是一个数组。在那个例子中，访问 id 需要

```
$tutor['Tutor']['id'] 
```

PHP 官方文档，“[使用方括号语法访问数组元素](http://php.net/manual/en/language.types.array.php)”：

```
<?php
$array = array(
    "foo" => "bar",
    42    => 24,
    "multi" => array(
         "dimensional" => array(
             "array" => "foo"
         )
    )
);

var_dump($array["foo"]); //"bar"
var_dump($array[42]); //24
var_dump($array["multi"]["dimensional"]["array"]); //"foo"
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:18:11.407

返回的值是一个数组，而不是一个对象。这应该有效：

```
echo $tutor['Tutor']['id']; 
```

或者：

```
foreach($tutor as $tut){
    echo $tut['Tutor']['id'] . '<br />';
} 
```

# regex - 匹配指定的第一个子字符串的 Perl 正则表达式

> ID：12717052
> 
> 赞同：1
> 
> 时间：2012-10-03T21:16:32.797
> 
> 标签：regex, perl

我需要从 HTML 文档中提取数据并仅包含有趣信息的 XML 文档。我这样做的方法是将 HTML 文档逐步转换为 XML 文档。我在一行中有 5 个最外面的 XML 标记，现在我正在尝试构建其中的内容。

我有一条这样结构的线：

```
 <myTag> 
      blablabla <a href="link/I/want" *some css* > title I want </a> some other stuff <a href="link that/I/don't/want" *some css*> text I don't want </a> blablabla 
   </myTag> 
```

我想要的是：

```
 <myTag>
    <link>link/I/want</link>
    <title> title I want </title>
    </myTag> 
```

我拥有的正则表达式是：

```
 /a href="(.*)"(.*)>(.*)<\/a>/ 
```

希望得到 #$1 = url ， $2 = 不管 ， $3 = 标题。

这不起作用，因为它取而代之的是：

```
 <myTag>
    <link>link/I/want *some css* > title I want </a> some other stuff <a href="link that/I/don't/want" *some css*</link>
    <titl>text I don't want</title>
    </myTag> 
```

如何提取该行的 FIRST 锚标记的内容？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:17:58.813

只需使用非贪婪表达式：

```
/a href="(.*?)"(.*?)>(.*?)<\/a>/ 
```

每个. `?`_`*`

# asp.net - 将命名空间添加到 Web.config 时出现错误 CS0246

> ID：12717053
> 
> 赞同：0
> 
> 时间：2012-10-03T21:16:47.070
> 
> 标签：asp.net, web-config

我创建了一个 Web 项目，它充当 (ASP).NET Web 应用程序和基于 Web 的 ERP 解决方案之间的链接。其中有四个网站，都使用相同的 .NET Web 应用程序来运行网络商店。我已经成功地将项目应用到一个站点，现在我正在尝试将它应用到其他站点。但是，在第二个站点上设置它时，我不断收到 CS0246 错误。我已将 DLL 文件添加到 BIN 文件夹中，并将名称空间和 Web 引用信息添加到 Web.config 文件中，就像在第一个站点中一样。不过，对于我的生活，我无法弄清楚为什么它会不断导致服务器错误。如果我删除命名空间引用和 DLL 文件，错误就会消失。下面是 Web.config 文件当前的样子：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <configSections>
        <sectionGroup name="AbleCommerce" type="CommerceBuilder.Configuration.AbleCommerceSettings, CommerceBuilder.Configuration">
            <section name="application" type="CommerceBuilder.Configuration.AbleCommerceApplicationSection, CommerceBuilder.Configuration" restartOnExternalChanges="true" requirePermission="false" />
            <section name="encryption" type="CommerceBuilder.Configuration.AbleCommerceEncryptionSection, CommerceBuilder.Configuration" restartOnExternalChanges="false" requirePermission="false" />
        </sectionGroup>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="NS_WebServe.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        </sectionGroup>
        <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" restartOnExternalChanges="false" requirePermission="false" />
        <!-- AJAX -->
        <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
            <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
                <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication" />
                <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
                    <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="Everywhere" />
                    <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication" />
                    <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="false" allowDefinition="MachineToApplication" />
                </sectionGroup>
            </sectionGroup>
        </sectionGroup>
        <!-- AJAX -->
        <section name="microsoft.web.services3" type="Microsoft.Web.Services3.Configuration.WebServicesConfiguration, Microsoft.Web.Services3, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    </configSections>
    <AbleCommerce>
        <application configSource="App_Data\ablecommerce.config" />
        <encryption configSource="App_Data\encryption.config" />
    </AbleCommerce>
    <log4net configSource="App_Data\log4net.config" />
    <connectionStrings configSource="App_Data\database.config" />
    <appSettings>
        <add key="FCKeditor:UserFilesPath" value="~/Assets" />

        <!-- NetSuite Sales Order Addition Login Values -->
        <add key="login.count" value="" />
        <add key="login.email" value="" />
        <add key="login.password" value="" />
        <add key="login.email2" value="" />
        <add key="login.password2" value="" />
        <add key="login.email3" value="" />
        <add key="login.password3" value="" />
        <add key="login.roleId" value="" />
        <add key="login.acct" value="" />

        <!-- Web Site Information Values -->
        <add key="site.name" value="" />
        <add key="order.prefix" value="" />

        <!-- Error E-mail Information -->
        <add key="error.ccmail.recipcount" value="" />
        <add key="error.ccmail.addy1" value="" />
        <add key="error.ccmail.name1" value="" />
        <add key="error.ccmail.addy2" value="" />
        <add key="error.ccmail.name2" value="" />

    </appSettings>
    <system.web>
        <customErrors mode="On" defaultRedirect="~/Errors/GeneralError.aspx">
            <error statusCode="404" redirect="~/Errors/PageNotFound.aspx" />
        </customErrors>
        <pages theme="AbleCommerce" enableEventValidation="false" validateRequest="false">
            <controls>
                <!-- AJAX -->
                <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
                <add tagPrefix="ajax" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
                <add tagPrefix="ajax" namespace="AjaxControlToolkit" assembly="AjaxControlToolkit, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e" />
                <!-- AJAX -->
                <add tagPrefix="cb" namespace="CommerceBuilder.Web.UI.WebControls" assembly="CommerceBuilder.Web" />
                <add tagPrefix="ComponentArt" namespace="ComponentArt.Web.UI" assembly="ComponentArt.Web.UI" />
            </controls>
            <namespaces>
                <add namespace="System" />
                <add namespace="System.Net" />
                <add namespace="System.Web.UI" />
                <add namespace="System.Web.UI.WebControls" />
                <add namespace="System.Collections.Generic" />
                <add namespace="CommerceBuilder.Catalog" />
                <add namespace="CommerceBuilder.DigitalDelivery" />
                <add namespace="CommerceBuilder.Utility" />
                <add namespace="CommerceBuilder.Common" />
                <add namespace="CommerceBuilder.Users" />
                <add namespace="CommerceBuilder.Products" />
                <add namespace="CommerceBuilder.Payments" />
                <add namespace="CommerceBuilder.Payments.Providers" />
                <add namespace="CommerceBuilder.Stores" />
                <add namespace="CommerceBuilder.Messaging" />
                <add namespace="CommerceBuilder.Marketing" />
                <add namespace="CommerceBuilder.Shipping" />
                <add namespace="CommerceBuilder.Taxes" />
                <add namespace="CommerceBuilder.Taxes.Providers" />
                <add namespace="CommerceBuilder.Orders" />
                <add namespace="CommerceBuilder.Reporting" />
                <add namespace="CommerceBuilder.Web.UI" />
                <add namespace="NS_WebServe" />  <<<<<----- this line here is the troublemaker
            </namespaces>
            <tagMapping>
                <add tagType="System.Web.UI.WebControls.CompareValidator" mappedTagType="Sample.Web.UI.Compatibility.CompareValidator, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.CustomValidator" mappedTagType="Sample.Web.UI.Compatibility.CustomValidator, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.RangeValidator" mappedTagType="Sample.Web.UI.Compatibility.RangeValidator, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.RegularExpressionValidator" mappedTagType="Sample.Web.UI.Compatibility.RegularExpressionValidator, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.RequiredFieldValidator" mappedTagType="Sample.Web.UI.Compatibility.RequiredFieldValidator, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.ValidationSummary" mappedTagType="Sample.Web.UI.Compatibility.ValidationSummary, Validators, Version=1.0.0.0" />
                <add tagType="System.Web.UI.WebControls.WebParts.WebPartZone" mappedTagType="CommerceBuilder.Web.UI.WebControls.WebParts.WebPartZone" />
            </tagMapping>
        </pages>
        <!--
          Set compilation debug="true" to insert debugging
          symbols into the compiled page. Because this
          affects performance, set this value to true only
          during development.
    -->
        <trace enabled="false" requestLimit="10" pageOutput="false" localOnly="true" />
        <compilation debug="false" strict="false" explicit="false">
            <assemblies>
                <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
                <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Transactions, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Management, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Data.OracleClient, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Web.Extensions.Design, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
            </assemblies>
        </compilation>
        <httpHandlers>
            <!-- AJAX -->
            <remove verb="*" path="*.asmx" />
            <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false" />
            <!-- AJAX -->
        </httpHandlers>
        <httpModules>
            <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add name="AbleCommerceHttpModule" type="CommerceBuilder.Services.AbleCommerceHttpModule, CommerceBuilder.Services" />
        </httpModules>
        <authentication mode="Forms">
            <forms timeout="90" slidingExpiration="true" name="AC7.ASPXAUTH" />
        </authentication>
        <sessionState mode="InProc" timeout="30" cookieName="AC7.SESSIONID" />
        <siteMap defaultProvider="StoreSiteMap">
            <providers>
                <add name="StoreSiteMap" type="System.Web.XmlSiteMapProvider" siteMapFile="~/Web.sitemap" />
                <add name="AdminMenuMap" type="System.Web.XmlSiteMapProvider" siteMapFile="~/Admin/menu.sitemap" securityTrimmingEnabled="true" />
                <add name="AdminBreadCrumbsMap" type="CommerceBuilder.Web.UI.WebControls.DynamicSiteMapProvider" siteMapFile="~/Admin/breadcrumbs.sitemap" securityTrimmingEnabled="false" />
            </providers>
        </siteMap>
        <roleManager enabled="true" defaultProvider="AbleCommerceRoleProvider">
            <providers>
                <clear />
                <add name="AbleCommerceRoleProvider" type="CommerceBuilder.Users.AbleCommerceRoleProvider" connectionStringName="AbleCommerce6" applicationName="/" />
            </providers>
        </roleManager>
        <membership defaultProvider="AbleCommerceMembershipProvider">
            <providers>
                <clear />
                <add name="AbleCommerceMembershipProvider" connectionStringName="AbleCommerce6" applicationName="/" type="CommerceBuilder.Users.AbleCommerceMembershipProvider" />
            </providers>
        </membership>
        <profile enabled="false" />
        <webParts>
            <personalization defaultProvider="AbleCommercePersonalizationProvider">
                <providers>
                    <clear />
                    <add name="AbleCommercePersonalizationProvider" type="CommerceBuilder.Personalization.PersonalizationProvider" connectionStringName="AbleCommerce6" applicationName="/" />
                </providers>
                <authorization>
                    <allow verbs="enterSharedScope" roles="System,Admin,Jr. Admin,Manage Website" />
                </authorization>
            </personalization>
        </webParts>
        <anonymousIdentification enabled="true" cookieName="AC7.ASPXANONYMOUS" cookieTimeout="1440" />
        <httpRuntime maxRequestLength="4096" />
        <globalization culture="en-US" uiCulture="en-US" />
    </system.web>
    <microsoft.web.services3>
        <policy fileName="Bin\wse3policyCache.config" />
    </microsoft.web.services3>
    <system.web.extensions>
        <scripting>
            <scriptResourceHandler enableCompression="true" enableCaching="true" />
        </scripting>
    </system.web.extensions>
    <system.webServer>
        <validation validateIntegratedModeConfiguration="false" />
        <modules>
            <remove name="ScriptModule" />
            <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add name="AbleCommerceHttpModule" type="CommerceBuilder.Services.AbleCommerceHttpModule, CommerceBuilder.Services" preCondition="managedHandler" />
        </modules>
        <handlers>
            <remove name="WebServiceHandlerFactory-Integrated" />
            <remove name="ScriptHandlerFactory" />
            <remove name="ScriptHandlerFactoryAppServices" />
            <remove name="ScriptResource" />
            <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
        </handlers>
    </system.webServer>
    <system.net>
        <settings>
            <httpWebRequest useUnsafeHeaderParsing="true" />
        </settings>
    </system.net>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35" />
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0" />
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35" />
                <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0" />
            </dependentAssembly>
        </assemblyBinding>
    </runtime>

    <applicationSettings>
        <NS_WebServe.Properties.Settings>
            <setting name="NS_WebServe_com_netsuite_webservices_NetSuiteService"
              serializeAs="String">
                <value>https://webservices.netsuite.com/services/NetSuitePort_2011_2</value>
            </setting>
        </NS_WebServe.Properties.Settings>
    </applicationSettings>

</configuration> 
```

我已经为此绞尽脑汁了一段时间，并且希望能对我在这里忽略的内容有任何额外的见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T15:14:28.077

好的，我知道出了什么问题。基本上，我没有关于远程服务器的完整信息。我成功设置的一个站点正在运行 .NET 4.0，但这些其他站点位于只有 .NET 3.5 的服务器上。由于该项目的目标是 .NET 4.0，我重新定位到 3.5，一切都开始工作了。花了一段时间才终于得到这些信息。

# python - 将表单数据从视图发送到模板

> ID：12717054
> 
> 赞同：4
> 
> 时间：2012-10-03T21:16:59.877
> 
> 标签：python, django, django-forms, django-templates, django-views

**编辑：**
我希望'success_url'（即result.html）显示来自'form.process（）'的'数据'。以下代码显然不起作用。谁能告诉我它有什么问题或建议另一种方式来基本上查看模板中的上下文“数据”（以列表或字典的形式），即在表单之后向用户显示数据的更好方式已经提交。
提前谢谢了。

```
-- urls.py --
url(r'^$', view='main_view'),
url(r'^result/$', view='result_view'),

-- views.py --
class ResultView(TemplateView):
    template_name = "result.html"

class MainView(FormView):
    template_name = 'index.html'
    form_class = UserInputForm
    success_url = 'result/'

    def form_valid(self, form):
        data = form.process()
        return super(MainView, self).form_valid(form)

    def get_context_data(self, **kwargs):
        context = super(MainView, self).get_context_data(**kwargs)
        context['data'] = data
        return context

main_view = MainView.as_view()
result_view = ResultView.as_view() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-10T09:53:33.520

据我了解您的问题，您希望在结果视图中显示用户提交表单的内容。那是对的吗？

在这种情况下，get_context_data 方法根本不会帮助您，因为它只会将数据存储在 MainView 中的当前上下文中。

FormView 的 form_valid 方法会对 success_url 进行 HttpResponseRedirect。所以现在的问题是，我们怎样才能给这个视图提供数据。

正如[Django return redirect() with parameters](https://stackoverflow.com/questions/3209906/django-return-redirect-with-parameters)中所解释的，最简单的方法是将数据放入会话中。在 result.html-template 中，您可以按照[Django 中的说明访问此数据：从模板中访问会话变量？](https://stackoverflow.com/questions/2551933/django-accessing-session-variables-from-within-a-template)

这是代码：

```
class ResultView(TemplateView):
    template_name = "result.html"

class MainView(FormView):
    template_name = 'index.html'
    form_class = UserInputForm
    success_url = 'result/'

    def form_valid(self, form):
        self.request.session['temp_data'] = form.cleaned_data
        return super(MainView, self).form_valid(form) 
```

在 result.html 模板中，您可以访问此 temp_data ：

```
{{ request.session.temp_data }} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:27:56.527

如上所述，您可以覆盖`get_context_data`.

例如，您可以执行以下操作：

```
def get_context_data(self, **kwargs):
    context = super(MainView, self).get_context_data(**kwargs)
    #set some more context below.
    context['foo'] = bar
    ...
    return context 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:24:59.090

在上下文中查找基于`get_context_data`Django[类的视图文档](https://docs.djangoproject.com/en/1.3/ref/class-based-views/)。被覆盖的`dict`方法返回的值将被传递到模板中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T10:19:26.960

有几件事可能是您的问题。首先，在方法中，在调用该类的 parent**之前**`form_valid()`处理表单。此外，您不会将结果存储在一个共同的地方，以便两种方法获取它。尝试类似：**`form_valid()`**

 **```
def form_valid(self, form):
    self.data = form.cleaned_data
    return super(MainView, self).form_valid(form)

def get_context_data(self, **kwargs):
    context = super(MainView, self).get_context_data(**kwargs)
    context['data'] = self.data
    return context 
```**

# c# - 在 while 循环中删除文件并被另一个进程错误使用时出错

> ID：12717059
> 
> 赞同：0
> 
> 时间：2012-10-03T21:17:08.833
> 
> 标签：c#, .net

这是我的一段代码，我想删除一个文件（第 12 行）。

但是出现了一个错误：项目无法访问该文件，因为它正被 c# 中的另一个进程恰好在 while 循环的第二次使用。我处理并关闭了每个对象。

```
while (true)
{
    string strEncrypted;
    int strLenght = 0;
    byte[] cryptedRGB;

    string imgCamFile = Environment.CurrentDirectory + "\\___imgCam\\_sentImg\\__empImg.bmp";
    if (File.Exists(@imgCamFile))
    {
        lock (@imgCamFile)
        {
            //if (camPictureBox.Image != null)
            //    camPictureBox.Image.Dispose();
            GC.Collect();
            System.IO.File.Delete(@imgCamFile);
            GC.Collect();
        }
    }

    strDataType = System.Text.Encoding.UTF8.GetBytes("Frame");
    strEncrypted = clsCryption.Encrypt("Frame");

    strDataType = new byte[strEncrypted.Length];
    foreach (char c in strEncrypted.ToCharArray())
    {
        strDataType[strLenght] = (byte)c;
        strLenght++;
    }
    if (optClient.Checked == true)
        mClient.Send(strDataType);
    else if (optServer.Checked == true)
        mServerHandler.Send(strDataType);

    MemoryStream Ms = new MemoryStream();
    camPictureBox.Image.Save(Ms, System.Drawing.Imaging.ImageFormat.Bmp);
    byte[] mData = Ms.GetBuffer();
    Ms.Close();
    Ms.Dispose();

    FileStream fileStream = new FileStream(imgCamFile, FileMode.Create, FileAccess.Write);
    fileStream.Write(mData, 0, mData.Length);
    fileStream.Close();
    fileStream.Dispose();

    Bitmap bitmap = new Bitmap(imgCamFile);
    Size mS = bitmap.Size;

    string[,] RGB = new string[mS.Width * 3, mS.Height];
    int realWodth = mS.Width * 3;
    byte[] myRGB = new byte[realWodth * mS.Height];

    int cCounter = 0;
    int pRow = 0;

    for (int y = 0; y < mS.Height; y++)
    {
        cCounter = 0;
        for (int x = 0; x < mS.Width; x++)
        {
            Color pixColor = bitmap.GetPixel(x, y);

            RGB[cCounter, y] = pixColor.R.ToString(); ++cCounter;
            RGB[cCounter, y] = pixColor.G.ToString(); ++cCounter;
            RGB[cCounter, y] = pixColor.B.ToString(); ++cCounter;

            myRGB[pRow] = Byte.Parse(pixColor.R.ToString()); pRow++;
            myRGB[pRow] = Byte.Parse(pixColor.G.ToString()); pRow++;
            myRGB[pRow] = Byte.Parse(pixColor.B.ToString()); pRow++;
        }

    }

    int sent;
    if (optClient.Checked == true)
        sent = SendVarData(mClient, myRGB);
    else if (optServer.Checked == true)
        sent = SendVarData(mServerHandler, myRGB);

    System.Threading.Thread.Sleep(4000);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:25:41.080

我相信这是问题所在：

```
 Bitmap bitmap = new Bitmap(imgCamFile); 
```

您永远不会将位图设置为 null，以便保持路径锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:02:35.200

为什么所有的步骤？ `Image -> MemoryStream -> FileStream -> BitMap`

`Bitmap`是`Image`- 你确定它还不是`camPictureBox.Image`a`Bitmap`并且你不能用它来做你的计算吗？

如果不...

```
using(var bitmap = new Bitmap(camPictureBox.Image))
{
   // do your calculations
} 
```

... 或者 ...

```
using (var ms = new MemoryStream())
{
   camPictureBox.Image.Save(ms, System.Drawing.Imaging.ImageFormat.Bmp);

   using (var bitmap = new Bitmap(ms))
   {
       // do your work
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:34:00.667

恕我直言，我同意。你不应该打电话给垃圾收集器。C# 应该自动完成。只需处置所有对象以释放资源。

请记住，这不是必需的：

```
Ms.Close();
Ms.Dispose();

fileStream.Close();
fileStream.Dispose(); 
```

因为 dispose 隐式调用 close。

使用 Bitmap 类后释放资源：

```
Bitmap bitmap = new Bitmap(imgCamFile); 
bitmap.Dispose(); 
```

# jsf - h:selectOneRadio 不适用于 ajax 更改事件

> ID：12717060
> 
> 赞同：0
> 
> 时间：2012-10-03T21:17:17.993
> 
> 标签：jsf, jsf-2

我有两个单选按钮，默认情况下没有选择一个，并且必须选择其中一个，所以这就是我所做的：

```
 <div id="payment_method">
     <h:message for="sel_payment_method" style="Color:red;"/>
     <h:selectOneRadio id="sel_payment_method" required="true" requiredMessage="Please select a payment method" value="#{myBean.selectedPaymentMethod}">  
       <f:selectItem itemLabel="Debit or Credit Card" itemValue="credit" />  
       <f:selectItem itemLabel="Checking Account" itemValue="checking" />
       <f:ajax event="change" render="credit_inputs_fragment checking_inputs_fragements" />             
     </h:selectOneRadio>
    </div> 
```

该`selectedPaymentMethod`属性是一个字符串，其默认值为 null

并且**credit_inputs_fragment**是一个 ui:fragment 包含一个 div

ISSUE：单击单选按钮时，要更改的两个片段不受影响。

请指教，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-04T00:10:21.207

您在描述具体问题时并不完全清楚，但我可以在迄今为止发布的代码中看到至少两个潜在问题：

1.  `<f:ajax event="change">`在单选按钮和复选框的情况下是错误的。应该是`event="click"`。或者，更好的是，完全删除它。它已经默认为正确的。另请参阅[我可以将哪些值传递给 f:ajax 标记的 event 属性？](https://stackoverflow.com/questions/7886453/what-values-can-i-pass-to-the-event-attribute-of-the-fajax-tag/7889098#7889098)

2.  中引用的组件`<f:ajax render>`必须是完整的 JSF UI 组件，并且*始终*呈现给客户端。如果组件本身从未呈现到 HTML，那么 JavaScript 根本无法找到它来更新其内容。您基本上需要另一个始终呈现的组件中的有条件呈现的组件。另请参阅[为什么当我想进行 ajax 更新时，我需要将带有 render="#{some}" 的组件嵌套在另一个组件中？](https://stackoverflow.com/questions/9010734/why-do-i-need-to-nest-a-component-with-rendered-some-in-another-component-w)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:14:45.210

我遵循以下链接中的示例代码，它解决了我的问题：

[JSF：动态改变表单](https://stackoverflow.com/questions/5654269/jsf-dynamically-change-form)

# opencv - opencv给出相机姿势 - rvec和tvec - 坐标系不匹配

> ID：12717068
> 
> 赞同：2
> 
> 时间：2012-10-03T21:18:03.120
> 
> 标签：opencv, camera-calibration, coordinate-transformation

我需要找到相机的姿势（旋转矩阵+平移向量），为此我正在使用`cv2.solvePnP()`，但我从照片中得到的结果不匹配。

为了调试，我（使用 numpy）创建了一个“调试 3d 场景”，由一些对象点（正方形的四个角）、一些相机点（焦点、主点和虚拟投影平面的四个角）和参数组成（焦距，初始方向）。

然后，我通过乘以三个轴旋转矩阵来构造一个通用旋转矩阵，将这个通用旋转应用于相机（`numpy.dot()`），将对象点投影到虚拟投影平面（线平面相交算法），并计算平面内二维坐标（点线距离）到投影平面轴。

这样做之后（通过旋转矩阵将对象点指向图像点），我将图像点和对象点输入`cv2.Rodrigues(cv2.solvePnP(...))`并得到一个与我使用的矩阵“不太相同”的矩阵，只是因为转置和一些具有相反信号的元素（负与正） ，尊重这种关系：

```
solvepnp_rotmatrix = my_original_matrix.transpose * [ 1  1  1] 
                                                    [ 1  1 -1] 
                                                    [-1 -1  1] 
```

虽然旋转矩阵不匹配是“可解决的”这个黑客，但翻译向量给出的坐标对我来说没有意义。

我怀疑我的 3D 模型（惯用手、轴方向、旋转顺序）与 opencv 使用的模型不匹配：

*   我使用类似OpenGL的坐标系（X向右增加，Y向上增加，Z向观察者增加；
*   我以对我更有意义的顺序应用了旋转（所有右手，首先围绕全局 Z，然后围绕全局 X，然后围绕全局 Y）；
*   图像平面位于物体和相机焦点之间（虚拟投影平面，而不是真实/CCD）；
*   我的图像平面（虚拟 CCD）的原点是左下角（Xpix 向右增加，Ypx 向上增加。

我的问题是：

鉴于旋转矩阵的项是相同的，只是转置并且在某些术语中具有不同的信号，我是否可能混淆了一些`openCV`约定（用手习惯、旋转顺序、轴方向）？我怎样才能发现是哪一个？

另外，有没有办法将我的手工翻译向量与返回的 tvec 联系起来`solvePnP`？（当然，理想情况下，最好首先使坐标系匹配）。

任何帮助都将受到欢迎！

# c++ - Lua 函数不做任何事情

> ID：12717075
> 
> 赞同：1
> 
> 时间：2012-10-03T21:18:28.817
> 
> 标签：c++, lua

我终于能够使用 C++ 让 Lua 与我的编译器一起运行。我现在尝试开始一些教程，第一个程序不会做任何事情。我下载了他们使用的代码，但它仍然什么也没做。然而没有错误。测试打印得很好，但我没有得到 luaL_dostring 的响应。我正在使用 v5.1.4-46。是否有可能我以某种不会导致错误的方式错误地安装它？我打印出 lua 状态的内存地址，这似乎可以正常工作。如果有人能给我一些示例代码来运行，我将不胜感激。

这是代码：

```
#include <lua.hpp>
#include <iostream>
#include <string>

using namespace std;

int main()
{
    lua_State *L = lua_open();
    luaL_openlibs(L);

    cout << "Test" << endl;

    luaL_dostring(L, "print(\"Hello from Lua!\n\")");

    lua_close(L);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T21:21:59.413

您的 dostring 语法会生成无效的 Lua 代码...“\n”在执行前被传递给 lua 解析器。你需要一个“\\n”......这样想。所以你的“luaL_dostring”错误代码实际上是一个语法错误。有趣的事...

您不应该将 dostring 用于测试之外。

# lucene - 如何在 Apache Lucene 中的 Document 内的字段中添加多个值

> ID：12717077
> 
> 赞同：1
> 
> 时间：2012-10-03T21:18:31.357
> 
> 标签：lucene

我在向同一文档中的字段添加多个值时遇到了一些问题。我有 bug 列表，每个 bug 都有一个 id、标题和几个带有comment_name、comment_text、comment_time 的评论。如何将这些评论信息添加到文档中，如以下代码？我以后如何搜索它们？先谢谢了~

```
 if (Integer.toString(bg.getBugId()) != null) {
        bugDocument.add(new Field("bug_id",Integer.toString(bg.getBugId()), TextField.TYPE_STORED));
        bugDocument.add(new Field("title",bg.getTitle(), TextField.TYPE_STORED));

    }
    for (int i = 0; i < bg.getComments().size(); i++) {
        bugDocument.add(new Field("comment_name",bg.getComments().get(i).getName(), TextField.TYPE_STORED));
        bugDocument.add(new Field("comment_text",bg.getComments().get(i).getText(), TextField.TYPE_STORED));
        bugDocument.add(new Field("comment_time",bg.getComments().get(i).getTime(), TextField.TYPE_STORED));

    } 
```

# asp.net-mvc-3 - 如何在 MVC Razor 视图中使用具有多个输入的内联模板

> ID：12717079
> 
> 赞同：2
> 
> 时间：2012-10-03T21:18:40.283
> 
> 标签：asp.net-mvc-3, razor

在我看来，我目前有

```
@{
    Func<Website.Security.User[], object> renderUserList = @<text>
        <div class="span4">
            @*<h2>@title</h2>*@
            <ul>
                @foreach (var user in item)
                {
                    <li>@user.UserName - <a href="/Config/User/Edit/@user.UserName">Edit</a></li>
                }
            </ul>
        </div>
    </text>;
}
@renderUserList(Model.AdminUsers) 
```

我怎样才能重做这个，以便 renderUserList 表达式可以接受部分标题的第二个输入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T21:30:36.673

据我了解，您尝试创建帮助程序：[ASP.NET MVC 3 和 Razor 中的 @helper 语法](http://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx)

```
 @helper renderUserList(Website.Security.User[] users, string title)
   {
        <div class="span4"> 
            <h2>@title</h2> 
            <ul> 
                @foreach (var user in users) 
                { 
                    <li>@user.UserName - <a href="/Config/User/Edit/@user.UserName">Edit</a></li> 
                } 
            </ul> 
        </div> 
    } 
```

# javascript - 从网址中提取

> ID：12717082
> 
> 赞同：1
> 
> 时间：2012-10-03T21:18:59.723
> 
> 标签：javascript, jquery, asp.net, url, hyperlink

我只想从下面的链接中提取 Services.aspx

http://localhost:49169/HirenSir/Services.aspx

使用 jQuery/javascript 是令人钦佩的，因为然后必须向包含此 href 参数的锚标记添加一个类..

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:24:55.973

在 Javascript 中试试这个

```
var curPage = location.pathname.substring(location.pathname.lastIndexOf("/") + 1); 
```

如果您当前的位置是 Services.aspx

[检查小提琴](http://jsfiddle.net/sushanth009/Tv8Ay/)

**编辑**

如果你想在这种情况下向锚添加一个类，试试这个

```
$('a[href$="Services.aspx"]').addClass('selected'); 
```

[更新的小提琴](http://jsfiddle.net/sushanth009/Tv8Ay/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:36:35.447

```
"http://localhost:49169/HirenSir/Services.aspx".split('/').pop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:46:42.103

到目前为止，所有解决方案都有效......正则表达式怎么样？

```
var url = "http://localhost:49169/HirenSir/Services.aspx";

// returns array of matches, should only contain one element 
url.match("[^/]*$"); // ["Services.aspx"] 
```

如果你想把它放在一个单行...

```
"http://localhost:49169/HirenSir/Services.aspx".match("[^/]*$")[0]; 
```

# php - 创建自定义 PHP 语法解析器

> ID：12717084
> 
> 赞同：7
> 
> 时间：2012-10-03T21:19:13.413
> 
> 标签：php, javascript, syntax

我正在考虑如何为我为 CSS 和 JS 找到的几个库创建一个 PHP 等效项。

一个是`Less CSS`哪个是一个`dynamic stylesheet language`。背后的基本思想`Less CSS`是，它允许您创建更多动态的 CSS 规则，其中包含“常规” CSS 不支持的实体，例如`mixins`,`functions`等，然后最终将这些语法`Less CSS` **编译**成常规 CSS。

另一个以（某种）类似模式运行的有趣 JS 库是`CoffeeScript`您可以在其中编写“更整洁且更简单”的代码，然后将其**编译**为常规 Javascript。

如何为 PHP 创建一个简单的类似接口？就像概念证明一样；我只是想学习一些东西。让我们看一个扩展类的简单用例。

```
class a
{
    function a_test()
    {
        echo "This is test in a ";
    }
}

class b extends a
{
    function b_test()
    {
        parent::a_test();
        echo "This is test in b";
    }
}

$b = new b();
$b->b_test(); 
```

假设我想让用户将类写`b`为（仅用于示例）：

```
class b[a] //would mean b extends a
{
    function b_test()
    {
        [a_test] //would mean parent::a_test()
        echo "This is test in b";
    }
} 
```

并让他们稍后将该代码“解析”为常规 PHP（我相信通常通过运行单独的命令/进程）。我的问题是我将如何去创造这样的东西。可以用 PHP 完成吗，我需要使用 C/C++ 之类的东西吗？如果我要解决这个问题，我应该如何解决？网上有资源吗？任何指针都非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T21:37:57.960

语言*转码器*并不像人们想象的那么容易。

您提供的示例可以使用`preg_replace`查找类定义并替换`[a]`为`extends a`.

但是更复杂的功能需要一个*转码器*，它是一套较小的逻辑代码片段。

在大多数程序员行话中，人们错误地将转码器称为*编译器*，但编译器和转码器之间的区别在于编译器读取源代码并输出原始二进制机器代码，而转码器读取源代码并输出（不同的）源代码。

例如，PHP（或 JavaScript）运行时既不是编译器也不是转码器，它是一个解释器。

但是关于行话已经够多了，让我们来谈谈转码器：

要构建转码器，您必须首先构建一个标记器，它将源代码分解为标记，这意味着如果它看到一个完整的单词，例如“类”或类的名称或“函数”或函数的名称，它捕获该词并将其视为标记。当它遇到另一个标记时，例如左圆括号或左大括号或方括号等，它认为是另一个标记。

幸运的是，PHP 中可用的所有可识别标记都已被[token_get_all](http://www.php.net/manual/en/function.token-get-all.php)轻松扫描，这是 PHP 捆绑的一个函数。你可能会遇到一些麻烦，因为 PHP 假设了一些关于你如何使用符号的事情，但总的来说你可以使用这个函数。

标记器创建它找到的所有标记的平面列表并将其提供给解析器。

解析器是转码器的第二阶段，它读取令牌列表并决定诸如“如果令牌 [0] 是一个类并且令牌 [1] 是一个 name_value 那么我们有一个类”等内容。在运行完整个令牌列表我们应该有一个抽象语法树。

抽象语法树是一种仅象征性地保留有关源代码的相关信息的结构。

```
$ast = array(
    'my_derived_class' => array(
        'implements' => array(
            'my_interface_1',
            'my_interface_2',
            'my_interface_3'),
        'extends' => 'my_base_class',
        'members' => array(
            'my_property_name' => 'my_default_value',
            'my_method_name' => array( /* ... */ )
        )
    )
); 
```

获得抽象语法树后，您需要遍历它并输出目标源代码。

真正棘手的部分是解析器（取决于您正在解析的语言的复杂性）可能需要回溯算法或其他形式的模式匹配来区分相似的情况。

我建议在 Terence Parr 的书[http://pragprog.com/book/tpdsl/language-implementation-patterns](http://pragprog.com/book/tpdsl/language-implementation-patterns)中阅读有关此内容的内容，该书详细描述了编写代码转换器所需的设计模式。

在 Terrence 的书中，您将了解为什么某些语言（如 HTML 或 CSS）比 PHP 或 JavaScript 简单得多（在结构上），以及这与语言解析器的复杂性有何关系。

# iphone - 视图控制器不释放内存的问题

> ID：12717086
> 
> 赞同：0
> 
> 时间：2012-10-03T21:19:23.240
> 
> 标签：iphone, objective-c, ios, xcode

我正在开发一个应用程序，其中不同的视图控制器通过dismissModalViewControllerAnimated 被推送和解散。

我的应用程序在一段时间后崩溃了一些内存问题。查看泄漏工具，我发现我的整体分配不断增加。即使关闭视图控制器，内存也不会下降。

这有什么明显的原因吗？找出我的应用程序崩溃原因的最简单和最简单的方法是什么？谢谢

**可能的解决方案**

我经历了一些试验和错误以及谷歌搜索并进行了一些更改：

1）委托关系可能一直保留viewController，所以我将对象的委托属性改为weak。

2) NSTimer 应该在关闭 viewController 之前失效。

3) UIView 动画可能会干扰 dealloc 被调用？您可以`[view.layer removeAllAnimations]`在弹出 viewController 之前使用它们来结束它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-06T06:28:26.613

如果你的记忆在 .. 之后没有下降，`dismissModalViewControllerAnimated`这意味着你正在创建的`Global Object`并且`ViewController`在`dismissing`你没有设置`Object = nil`;之后

如果你设置 nil 那么你的内存会自动下降。

# regex - Perl：在已知位置解析未知值

> ID：12717088
> 
> 赞同：0
> 
> 时间：2012-10-03T21:19:26.737
> 
> 标签：regex, perl, parsing

给定以下文本格式，如何在括号之间获取“用户编号”值？格式相同，但括号内的值因文件而异。

```
User name [michael]
User age [25]
User number [2432]
User city [Memphis] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T07:06:27.680

解决方案1：

```
my ($number) = $file_as_string =~ /User number \[(\d+)\]/; 
```

正则表达式匹配仅在列表上下文中返回捕获的值（这就是为什么`my (...)`而不是只是`my ...`）

解决方案2：

```
my $number;
$file_as_string =~ /User number \[(\d+)\]/
     and $number = $1; 
```

它还保存在特殊变量 $1、$2 等中捕获，但要小心：如果匹配不成功，则先前成功匹配的剩余 $1 值可能会潜入您的变量（因此`and`- $number 将是 undef 除非字符串匹配）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:26:18.260

要仅检索用户编号，您可以这样做：

```
/User number \[(\d*)\]/ 
```

现在该数字将在第一个捕获组（由括号定义`()`）中找到。`[`转义and很重要，`]`因为它们是正则表达式中的特殊字符，表示字符类。

# javascript - Javascript new Date(str) - 不同的解析规则

> ID：12717089
> 
> 赞同：2
> 
> 时间：2012-10-03T21:19:32.143
> 
> 标签：javascript

我在 Chrome JS 控制台中尝试了这个，我的语言环境时区设置为 PST：

```
(new Date("07-15-2005")) 
```

=> 2005 年 7 月 15 日星期五 00:00:00 GMT-0700 (PDT)

```
(new Date("07-15-2005")).getTime(); 
```

=> 1121410800000

但....

```
(new Date("2005-07-15")) 
```

=> 2005 年 7 月 14 日星期四 17:00:00 GMT-0700 (PDT)

```
(new Date("2005-07-15")).getTime(); 
```

=> 1121385600000

我期待在两者中都会发生字符串解析。但我不明白为什么在使用格式 YYYY-MM-DD 时，它假定时区偏移。就好像我在本地 TZ 中表示“2005-07-15”，但在 UTC 中表示“07-15-2005”。

是正确的解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:20:59.660

该实现似乎是特定于供应商的，但是查看日期[解析](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse)的文档，我们看到从 1.8.5 开始，javascript 支持[RFC2822](https://www.rfc-editor.org/rfc/rfc2822#page-14)日期和[ISO 8601](http://www.w3.org/TR/NOTE-datetime)日期。

根据[Date.UTC](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/UTC)文档，如果未另行指定，则假定 ISO 8601 日期采用 UTC 时间，因此会自动添加时区差异。

RFC2822 日期似乎被假定为当地时间，因此没有被修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:04:50.713

我似乎无法复制您的结果，但结果似乎因浏览器而异。

见：http: [//jsfiddle.net/f7DMV/](http://jsfiddle.net/f7DMV/)

在 Firefox 和 Opera 中，我只正确解析了中间行，其他都是无效日期。

在 Chrome 中，第一行和第二行都正确解析（并且没有区别），但最后一行仍然无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:22:28.617

它会因浏览器而异。ECMA262 规范说任何没有`YYYY-MM-DD`格式并传递给`Date`函数的字符串，它可能会退回到特定于实现的启发式或特定于实现的日期格式。

# mysql - WHM / cPanel：mySQL 备份

> ID：12717090
> 
> 赞同：0
> 
> 时间：2012-10-03T21:19:37.303
> 
> 标签：mysql, backup

我正在设置一个安装了 WHM / cPanel 的新服务器。

我可以每天进行一次或两次完整的 mySQL 备份，这一点非常重要。

目前数据库非常小（20 mb），但一旦我们获得更多客户，容量就会迅速增加。

我现在可以创建一个 cron 作业并通过电子邮件发送备份。但是，由于这些备份的未来大小，我认为这是一个糟糕的解决方案。

关于每日 mySQL 备份，您有哪些最佳建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:24:46.380

您可以设置一个 cron 作业来备份数据库并将其转储到您选择的目录中：

```
mysqldump --all-databases --skip-lock-tables | gzip -9 > /your/backup/dir/here/`date +%Y%m%d`_backup.sql.gz 
```

你从那里做什么取决于你，但我同意你不应该因为它的大小而通过电子邮件发送它。也许您可以使用[SCP](http://www.hypexr.org/linux_scp_help.php)将其发送到不同的服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:26:56.433

备份的常见做法如下

1.  进行每日备份。
2.  一旦第一天达到一周大，开始删除东西，但保留一周大的东西。
3.  开始保留每月备份，一旦第一个达到一个月大，就每周删除所有备份。

您也可以每年继续执行此操作。

这样做的全部意义在于，您*应该*在备份达到周标记*之前*捕获信息中的任何错误。您真的不需要为任何特定目的保留*真正*旧的备份，这就是您开始删除内容的原因。

除非您在各种磁盘上拥有无限空间，否则最好遵循这种做法，并确保您的数据不会发生任何变化。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:27:51.563

如果您认为您的数据将增长到相当大的规模，以至于会导致大量数据库停机以进行转储，那么您首先应该考虑实施一个复制设置，以便您可以从从站中删除转储。

您当然可以`mysqldump`在 cron 中运行一个简单的命令，将转储文件放入机器上的驱动器中。然后，您可以担心通过其他方式将数据移出机器（您不想通过电子邮件发送）。请记住，只要您的数据转储完成，它就会暂时锁定您的数据库。

如果您想开箱即用，您可以在 Amazon RDS 上实现一个 MySQL 实例。它可以轻松完成复制、数据库快照等操作。

# opengl - 多边形进入着色器

> ID：12717091
> 
> 赞同：1
> 
> 时间：2012-10-03T21:19:41.813
> 
> 标签：opengl, shader, polygon

我正在写游戏。现在有水的渲染。我有一个多边形： ![在此处输入图像描述](../Images/6a8458c291a4c76e17bf1510e8d3c447.png)

所有的场景都被渲染成一个单一的纹理，当水的队列到来时，我想将一个复杂的多边形传递到着色器中。例如，在屏幕上，多边形是红色水面和蓝色边框。如何仅将该多边形内部的区域传递给着色器？例如，我想将多边形内的所有内容填充为红色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:47:36.420

根据您对它的处理，最好将多边形本身渲染为纹理并让您的着色器对其进行采样。如果多边形的大小是可预测的，您可以使用大致具有这些尺寸的纹理，并将该帧在场景中的位置也传递到着色器中。

# jquery - Flexslider 缓慢的图像加载

> ID：12717097
> 
> 赞同：22
> 
> 时间：2012-10-03T21:20:06.433
> 
> 标签：jquery, html, preload, flexslider

我在我正在构建的网站上使用 Flexslider。

我非常喜欢这种响应能力，这就是我不想更改为 nivo-slider 或类似东西的原因。

不利的是，它在加载所有图像之前不显示第一张图像。因此，您必须等待滑块中的所有图像都加载完毕才能使网站看起来正常。这在台式机/笔记本电脑上是可以接受的，但在移动设备上是不可接受的。

我在这里发现了一个类似的问题[Flexslider - image preloader](https://stackoverflow.com/questions/11577369/flexslider-image-preloader)但我无法让它工作。

我用它来触发代码

```
$(window).load(function() {
        $('.flexslider').flexslider();
    }); 
```

这在我的 HTML 中

```
 <ul class="slides">             
                <li>
                    <img src="pictures/slide1.jpg" alt=" ">
                <li>
                    <img src="pictures/slide2.jpg" alt=" ">                         
                </li>
                <li>
                    <img src="pictures/slide3.jpg" alt=" ">
                </li>
                <li>
                    <img src="pictures/slide4.jpg" alt=" ">
                </li>
            </ul> 
```

问题是。如何使滑块尽快显示第一张图像？然后是第二个，依此类推。

编辑：我解决了这个问题。它在下面的正确答案中给出。如果您有更好的解决方案：请分享：D

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-10-04T13:03:11.830

好的。所以我找到了一种方法。

在 flexslider css 文件中添加这一行

```
.flexslider .slides > li:first-child {display: block; -webkit-backface-visibility: visible;} 
```

在此行之后的行：

```
.flexslider .slides > li {display: none; -webkit-backface-visibility: hidden;} 
```

这将使第一个图像出现，它会在旋转之前等待其他图像加载。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-02T16:32:01.023

我知道这是一个老问题，但我有一个更简单的解决方案。

寻找

```
.flexslider .slides > li {display: none; -webkit-backface-visibility: hidden;} 
```

并将选择器更改为

```
.flexslider .slides > li:not(:first-child) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-04T06:14:25.790

我通过在 flexslider 样式表中添加 css 样式来快速解决此问题，样式为：

```
.flexslider .slides > li a img{visibility:visible !important; opacity:1 !important;filter:alpha(opacity=100) !important;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-22T16:08:31.847

我找到了最流畅的方法来做到这一点。

在这样的 flexslider 容器之前添加一个带有滑块的第一个图像的 div。

```
<div class="pre-flexslider-container">
     <img src="slider.jpg">
</div>
<div class="main-flexslider-container" style="display: none">
    <div class="flexslider">
    .
    .
    .
    </div>
</div> 
```

然后将以下代码添加到 flexslider 初始化中：

```
$(window).load(function(){
  $('.flexslider').flexslider({
    .
    .
    .
    .
    .
    start: function(slider){
        $('.pre-flexslider-container').css("display","none");
        $('.main-flexslider-container').css("display","block");
        slider.resize();
    }
  });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-24T09:11:33.303

```
smoothHeight: false //{NEW} Boolean: Allow height of the slider to animate smoothly in horizontal mode 
```

如果您将 smoothHeight 设置为 true 尝试在默认模式下，那么它也可以提高性能

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-03T21:30:28.583

有几种方法可以走。

首先，您可以尝试添加隐藏的图像标签，例如：

```
<img src="pictures/slide1.jpg" style="display:none">
<img src="pictures/slide2.jpg" style="display:none">
<img src="pictures/slide3.jpg" style="display:none">
<img src="pictures/slide4.jpg" style="display:none">
<ul>...your slides...</ul> 
```

预加载您的图像。但是，我建议不要使用这种方法。

另一个可以快速显示您的内容的解决方案（但尚未使用 IE6 测试）是使用[https://github.com/ozzyogkush/jquery.contentSlider](https://github.com/ozzyogkush/jquery.contentSlider)中的滑块。这是我一直在开发的滑块小部件，效果很好。这将需要对您的 DOM 布局进行轻微更改，但您可以根据需要拥有尽可能复杂的幻灯片。

# signalr - 带有 gzip 压缩的 SignalR

> ID：12717101
> 
> 赞同：9
> 
> 时间：2012-10-03T21:20:35.190
> 
> 标签：signalr

在为启用 gzip 压缩的 asp.net 网站中托管的 Hub 开发 SignalR 客户端时遇到一些问题。由于我们使用 IIS 压缩，来自 SignalR 的响应也被压缩，但是，客户端不理解响应，我们在客户端收到 Json 解析错误。

SignalR 内部用于`HttpWebRequest`发出 http 请求，并且`HttpWebRequest`可以配置为使用`AutomaticDecompression`属性自动解压缩响应。所以，如果我能以某种方式获得`HttpWebRequest`SignalR 用来发出请求的对象，我应该能够设置启用自动解压缩。

我认为我应该能够`HttpWebRequest`通过提供`HubConnection.Start`我的自定义实现来访问`IHttpClient`，`IHttpClient.GetAsync`采取`prepareRequest`我认为应该让我访问的操作`HttpWebRequest`，但是，在传递给之前`HttpHelper.GetAsync`包装`HttpWebRequest`并且不提供对 的访问。`HttpWebRequestWrapper``prepareRequest``HttpWebRequestWrapper``HttpWebRequest`

`HttpHelper`类是内部的，所以也不能使用它，所以，我不确定如何使用 SignalR 启用自动解压缩。

我可以公开`HttpWebRequest`in `HttpWebRequestWrapper`，但是，如果存在，我会更喜欢更简单的解决方案。有什么想法吗？

我正在使用 SignalR 版本 0.5.1.10822

我的自动解压HttpClient：

```
public class HttpClientWithAutoDecompression : IHttpClient
{
    readonly DefaultHttpClient _httpClient = new DefaultHttpClient();

    private readonly DecompressionMethods _decompressionMethods;
    public HttpClientWithAutoDecompression(DecompressionMethods decompressionMethods)
    {
        _decompressionMethods = decompressionMethods;
    }

    public Task<IResponse> GetAsync(string url, Action<IRequest> prepareRequest)
    {
        Task<IResponse> task = _httpClient.GetAsync(url, 
            request =>
                {
                    [ERROR: request is actually HttpRequestWrapper and
                     does not expose HttpWebRequest]**              ] 
                    var httpWebRequest = (HttpWebRequest) request; 
                    httpWebRequest.AutomaticDecompression = _decompressionMethods;
                    prepareRequest(request);
                });

        return task.ContinueWith(response =>
        {
            Log.Debug(this, "Response: {0}", response.Result.ReadAsString());
            return response.Result;
        });

    }
....
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T06:45:44.520

据我所知，GZip 编码和流式传输不会混合使用。在永久帧传输的情况下，客户端将无法解码流内容上的任何内容，直到接收到整个响应或至少一个重要的数据块（由于数据的解码方式）。在 Web 套接字的情况下，目前不支持任何类型的编码，尽管对于[正在处理](http://tools.ietf.org/id/draft-tyoshino-hybi-permessage-compression-00.txt)的每个消息编码的规范显然有一个扩展。

也就是说，如果您想尝试为 LongPolling 传输提供支持，我认为这是可能的唯一方法是提供您自己的 SignalR`IHttpClient`实现。您现在可以看到`DefaultHttpClient`该类使用`HttpHelper::GetAsync`which 在`HttpWebRequest`内部创建，而您永远无法掌握它，因为此时您只能访问`IRequest`which `HttpWebRequestWrapper`。

通过创建您自己的`IHttpClient`，您可以接管 . 的初始实例化`HttpWebRequest`，设置`AutomaticDecompression`，然后用`HttpWebRequestWrapper`.

# php - 如何显示 Woocommerce 类别图像？

> ID：12717112
> 
> 赞同：35
> 
> 时间：2012-10-03T21:21:24.427
> 
> 标签：php, wordpress, woocommerce, thumbnails

我在 PHP 中使用此代码：

```
$idcat = 147;
$thumbnail_id = get_woocommerce_term_meta( $idcat, 'thumbnail_id', true );
$image = wp_get_attachment_url( $thumbnail_id );
echo '<img src="'.$image.'" alt="" width="762" height="365" />'; 
```

当前ID在哪里`147`手动设置，但我需要在其他类别的当前ID

有什么建议吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-10-03T21:27:31.783

要在 中显示当前显示的类别的类别图像，请在为 true时`archive-product.php`使用当前类别：`term_id``is_product_category()`

```
// verify that this is a product category page
if ( is_product_category() ){
    global $wp_query;

    // get the query object
    $cat = $wp_query->get_queried_object();

    // get the thumbnail id using the queried category term_id
    $thumbnail_id = get_term_meta( $cat->term_id, 'thumbnail_id', true ); 

    // get the image URL
    $image = wp_get_attachment_url( $thumbnail_id ); 

    // print the IMG HTML
    echo "<img src='{$image}' alt='' width='762' height='365' />";
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-06-25T13:32:21.960

get_woocommerce_term_meta 自 Woo 3.6.0 以来已被弃用。

所以改变

```
$thumbnail_id = get_woocommerce_term_meta($value->term_id, 'thumbnail_id', true ); 
```

into: ($value->term_id 应该是 woo 类别 id)

```
get_term_meta($value->term_id, 'thumbnail_id', true) 
```

有关详细信息，请参阅文档： [https ://docs.woocommerce.com/wc-apidocs/function-get_woocommerce_term_meta.html](https://docs.woocommerce.com/wc-apidocs/function-get_woocommerce_term_meta.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-21T12:58:30.767

从[WooCommerce 页面](https://docs.woocommerce.com/document/woocommerce-display-category-image-on-category-archive/)：

> ```
> // WooCommerce – display category image on category archive
> 
> add_action( 'woocommerce_archive_description', 'woocommerce_category_image', 2 );
> function woocommerce_category_image() {
>     if ( is_product_category() ){
>       global $wp_query;
>       $cat = $wp_query->get_queried_object();
>       $thumbnail_id = get_woocommerce_term_meta( $cat->term_id, 'thumbnail_id', true );
>       $image = wp_get_attachment_url( $thumbnail_id );
>       if ( $image ) {
>           echo '<img src="' . $image . '" alt="" />';
>       }
>   }
> } 
> ```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-08-21T10:52:41.680

您还可以使用 foreach 循环来显示由父 ID 给出的父类别中的类别图像等。

例如，我给出父类别的 74 个 id，然后我将显示来自子类别的图像及其 slug。

```
**<?php
$catTerms = get_terms('product_cat', array('hide_empty' => 0, 'orderby' => 'ASC', 'child_of'=>'74'));
foreach($catTerms as $catTerm) : ?>
<?php $thumbnail_id = get_woocommerce_term_meta( $catTerm->term_id, 'thumbnail_id', true ); 

// get the image URL
$image = wp_get_attachment_url( $thumbnail_id );  ?>
<li><img src="<?php echo $image; ?>" width="152" height="245"/><span><?php echo $catTerm->name; ?></span></li>
<?php endforeach; ?>** 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-11-14T12:53:47.327

为了防止全尺寸类别图像减慢页面速度，您可以使用较小的图像`wp_get_attachment_image_src()`：

```
<?php 

$thumbnail_id = get_woocommerce_term_meta( $term->term_id, 'thumbnail_id', true );

// get the medium-sized image url
$image = wp_get_attachment_image_src( $thumbnail_id, 'medium' );

// Output in img tag
echo '<img src="' . $image[0] . '" alt="" />'; 

// Or as a background for a div
echo '<div class="image" style="background-image: url("' . $image[0] .'")"></div>';

?> 
```

编辑：固定变量名和缺少引号

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-08-02T04:32:50.263

这个解决方案的代码很少。我认为更好。

```
<?php echo wp_get_attachment_image( get_term_meta( get_queried_object_id(), 'thumbnail_id', 1 ), 'thumbnail' ); ?> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-03T07:26:55.257

`/wp-content/plugins/woocommerce/templates/`在循环路径中添加代码

```
 <?php
        if ( is_product_category() ){

            global $wp_query;
            $cat = $wp_query->get_queried_object();    
            $thumbnail_id = get_woocommerce_term_meta( $cat->term_id, 'thumbnail_id', true ); 
            $image = wp_get_attachment_url( $thumbnail_id ); 
            echo "<img src='{$image}' alt='' />";
        }
    ?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-17T06:04:08.787

```
<?php 

	$terms = get_terms( array(
	'taxonomy' => 'product_cat',
	'hide_empty' => false,
	) ); // Get Terms

foreach ($terms as $key => $value) 
{
	$metaterms = get_term_meta($value->term_id);
	$thumbnail_id = get_woocommerce_term_meta($value->term_id, 'thumbnail_id', true );
	$image = wp_get_attachment_url( $thumbnail_id );
	echo '<img src="'.$image.'" alt="" />';
} // Get Images from woocommerce term meta

?>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-13T00:58:01.127

原始答案有所帮助，但已过时。

来自[https://docs.woocommerce.com/document/woocommerce-display-category-image-on-category-archive/](https://docs.woocommerce.com/document/woocommerce-display-category-image-on-category-archive/)

```
 /**
 * Display category image on category archive
 */
add_action( 'woocommerce_archive_description', 'woocommerce_category_image', 2 );
function woocommerce_category_image() {
    if ( is_product_category() ){
        global $wp_query;
        $cat = $wp_query->get_queried_object();
        $thumbnail_id = get_term_meta( $cat->term_id, 'thumbnail_id', true );
        $image = wp_get_attachment_url( $thumbnail_id );
        if ( $image ) {
            echo '<img src="' . $image . '" alt="' . $cat->name . '" />';
        }
    }
} 
```

我添加了一个类`echo '<img src="' . $image . '" alt="' . $cat->name . '" class="catImage" />';`，然后使用

```
.catImage{
  float: left;
  max-height: 100px;
  padding-right: 10px;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-24T11:51:43.403

我是这样做的：

```
function loop_product_category_image(){
    global $wp_query;
    $terms = get_the_terms( $wp_query->ID, 'product_cat' );
    $thumbnail_id = get_term_meta( $terms[0]->term_id, 'thumbnail_id', true );
    $image = wp_get_attachment_url( $thumbnail_id );
    echo "<img src='{$image}' alt='category image' width='162' height='165' />";
} 
```

例如，您可以挂钩：在产品循环中：

```
add_action('woocommerce_before_shop_loop_item', 'loop_product_category_image', 7); 
```

或在产品中：

```
add_action('woocommerce_before_main_content', 'cylkow_loop_product_category_image', 7); 
```

或任何你想要的地方。

您还可以使用条件标签 [https://woocommerce.com/document/conditional-tags/](https://woocommerce.com/document/conditional-tags/)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-08-14T09:51:33.383

使用此代码可能会对您有所帮助。我已经通过了 cat id 17.pass woocommerce cat id 就是这样

```
 <?php
      global $woocommerce;
      global $wp_query;
      $cat_id=17;
      $table_name = $wpdb->prefix . "woocommerce_termmeta";
      $query="SELECT meta_value FROM {$table_name} WHERE `meta_key`='thumbnail_id' and woocommerce_term_id ={$cat_id} LIMIT 0 , 30";
      $result =  $wpdb->get_results($query);

      foreach($result as $result1){
          $img_id= $result1->meta_value;
      }     

      echo '<img src="'.wp_get_attachment_url( $img_id ).'" alt="category image">';
   ?> 
```

# javascript - overlayMouseTarget 与谷歌地图 api v3

> ID：12717116
> 
> 赞同：1
> 
> 时间：2012-10-03T21:21:39.713
> 
> 标签：javascript, jquery, jquery-mobile, google-maps-api-3

现在我已经花了大约 6 个小时来尝试获取在 google maps api v3 上工作的链接。我了解我必须使用 overlayMouseTarget 才能使 ios 设备正常工作。

这是一个示例页面：[http](http://spartanpixel.com/dev/OfficeLocator/stackoverflow.html) : //spartanpixel.com/dev/OfficeLocator/stackoverflow.html 它作为一个 webApp 工作。

我不知道将overlayMouseTarget放在哪里以便我的点击注册，因为我现在拥有它，它适用于chrome但不适用于Firefox：/我想要做的是，当有人点击/点击上面的位置图标时页脚，地图会将您带到您的位置。

我可以很好地定位你，只是它不会让你点击它。我正在使用 jQuery Mobile。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:05:01.920

也许这是去年报道的一个api BUG。我有类似的问题，我使用以下方法解决了它：

```
pane.overlayMouseTarget.appendChild(element); 
```

代替

```
pane.overlayLayer.appendChild(element); 
```

检查这个[http://code.google.com/p/gmaps-api-issues/issues/detail?id=3719](http://code.google.com/p/gmaps-api-issues/issues/detail?id=3719)

# angularjs - AngularJS + Testacular / Jasmine 单元测试：执行 0 of 0 成功

> ID：12717128
> 
> 赞同：5
> 
> 时间：2012-10-03T21:22:58.307
> 
> 标签：angularjs, jasmine

我正在尝试为 AngularJS 项目编写单元测试。该项目基于 angular-seed 并使用 Testacular 运行测试。每次运行 test.sh 脚本的尝试总是以“Executed 0 of 0 SUCCESS”结束。

我尝试了这个超级简单的“测试”：

```
describe('Testing Jasmine', function() {
  console.log('describe');
  var test = 'test';

  it('should be test', function() {
    console.log('it');
    expect(test).toEqual('test');
  });
}); 
```

结果是只记录了“描述”，跳过了“它”部分。当我在干净的角种子克隆上尝试同样的事情时，一切正常 - 所以我假设带有 Testacular 和 Jasmine 的测试系统本身工作正常。我们的项目是基于 Rails 的，但是我正在测试比较的干净的 angular-seed 是在 Apache 上运行的，所以我认为这可能是差异 - 混乱的路径或那个 Rails 项目中的东西。

但是没有错误消息，e2e 测试工作......而且我假设如果某些文件丢失或路径不正确，它将无法在测试中记录“描述” - 如果我理解正确，这意味着 Jasmine 是处理正确的文件（此伪测试中没有其他依赖项）。“描述”部分怎么可能工作得很好，而只有“它”部分似乎被跳过了？

任何提示或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:35:24.243

如果您正在进行单元测试，请不要在 testacular 配置文件中包含 angular-scenario.js 文件。这将破坏单元测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T06:05:15.780

testacular 中的 e2e 测试还有很长的路要走。我为此挣扎了一段时间。事实证明，期望的左侧必须是角度文档中定义的方法之一：http: [//docs.angularjs.org/guide/dev_guide.e2e-testing](http://docs.angularjs.org/guide/dev_guide.e2e-testing)。

下面是一个例子

```
describe('Testing Jasmine', function() {

  it('should be test', function() {
    expect(element('foo').count()).toEqual(1);
  });

}); 
```

请记住，如果您没有将规定的方法调用之一输入到期望中，testacular 将不会运行“它”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T12:54:53.233

还要确保您在要测试的页面上使用了以下属性之一：

```
'ng:app', 'ng-app', 'x-ng-app', 'data-ng-app' 
```

因为如果函数`angularInit()`找不到具有这些参数之一的元素，则运行程序将不会启动。

如果您想在没有 ng-app 的网页上使用 Angular 测试运行器，这一点尤其重要 - 在当前版本中它只是无法工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T04:38:59.427

请检查 Javascript 文件的顺序。

Testacular 报告了一个类似的问题，[重新排序 js 文件解决了这个问题](https://github.com/vojtajina/testacular/issues/66#issuecomment-9535599)。

# c++ - 什么是 Linux 的原生 GUI API？

> ID：12717138
> 
> 赞同：476
> 
> 时间：2012-10-03T21:23:50.997
> 
> 标签：c++, c, linux, user-interface

Windows (Win32 API) 和 OS X (Cocoa) 都有自己的 API 来处理窗口、事件和其他操作系统的东西。关于 Linux 的等价物是什么，我从来没有真正得到明确的答案？

我听说有人说 GTK+，但 GTK+ 是跨平台的。怎么可能是原生的？

* * *

## 回答 #1

> 赞同：637
> 
> 时间：2012-10-03T21:38:00.023

在 Linux 中，图形用户界面不是操作系统的一部分。大多数 Linux 桌面上的图形用户界面是由称为[X Window System](http://en.wikipedia.org/wiki/X_Window_System)的软件提供的，它定义了一种与设备无关的方式来处理屏幕、键盘和指针设备。

X Window 定义了一个用于通信的网络协议，任何知道如何“说出”这个协议的程序都可以使用它。有一个名为[Xlib](http://en.wikipedia.org/wiki/Xlib)的 C 库可以更轻松地使用此协议，因此 Xlib 是一种*原*生 GUI API。Xlib 不是访问 X Window 服务器的唯一方法。还有[XCB](http://en.wikipedia.org/wiki/XCB)。

使用建立在 Xlib 之上的工具包库，例如[GTK+](http://www.gtk.org/)（由[GNOME](http://www.gnome.org/)使用）和[Qt](http://www.qt.io/)（由[KDE](http://www.kde.org/)使用），因为它们更易于编程。例如，它们为您提供跨应用程序的一致外观和感觉，使拖放更容易使用，为现代桌面环境提供标准组件等等。

X 如何在屏幕上绘制内部取决于实现。[X.org](http://www.x.org)有一个设备独立部分和一个设备相关部分。前者管理windows等屏幕资源，后者与显卡驱动通信，通常是内核模块。通信可能通过[直接内存访问](http://en.wikipedia.org/wiki/Direct_memory_access)或通过对内核的[系统调用进行。](http://en.wikipedia.org/wiki/System_call)驱动程序将命令翻译成卡上的硬件可以理解的形式。

从 2013 年开始，一个名为[Wayland](http://wayland.freedesktop.org/)的新窗口系统开始可用，许多发行版都表示他们将在某个时候迁移到它，尽管仍然没有明确的时间表。该系统基于OpenGL/ES API，这意味着未来的OpenGL将成为Linux中的“原生GUI API”。将 GTK+ 和 QT 移植到 Wayland 的工作正在进行中，因此当前流行的应用程序和桌面系统将需要进行最小的更改。无法移植的应用程序将通过 X11 服务器得到支持，就像 OS X 通过 Xquartz 支持 X11 应用程序一样。GTK+ 移植[预计将在一年内完成](https://live.gnome.org/Wayland)，而 Qt 5 已经拥有完整的 Wayland 支持。

更复杂的是，Ubuntu 宣布他们正在开发一个名为[Mir](https://wiki.ubuntu.com/Mir)的新系统，因为他们认为 Wayland 存在问题。这个窗口系统也是基于 OpenGL/ES API。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2012-10-03T21:26:28.927

Linux 是一个内核，而不是一个完整的操作系统。有不同的窗口系统和 gui 运行在 Linux 之上以提供窗口。[X11](http://en.wikipedia.org/wiki/X11)通常是 Linux 发行版使用的窗口系统。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2012-10-03T21:49:32.777

[Wayland](http://wayland.freedesktop.org/)也值得一提，因为它通常被称为“未来的 X11 杀手”。

另请注意，Android 和其他一些移动操作系统不包含 X11，尽管它们具有 Linux 内核，因此从这个意义上说，X11 并不是所有 Linux 系统都原生的。

跨平台与原生无关。Cocoa 也已通过[GNUStep](http://www.gnustep.org/)移植到其他平台，但它仍然是 OS X / macOS 的本机。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-10-03T21:37:37.700

严格来说，Linux 的 API 由它的*系统调用*组成。这些是用户模式（非内核）程序可以调用的所有内核函数。这是一个非常低级的接口，允许程序执行诸如打开和读取文件之类的操作。有关一般介绍，请参阅[http://en.wikipedia.org/wiki/System_call](http://en.wikipedia.org/wiki/System_call)。

一个真正的 Linux 系统还将运行一个完整的其他软件“堆栈”，以提供图形用户界面和其他功能。该堆栈的每个元素都将提供自己的 API。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-10-04T03:40:47.810

为了帮助已经提到的内容，此博客中对 Linux 图形堆栈有一个很好的概述：http: [//blog.mecheye.net/2012/06/the-linux-graphics-stack/](http://blog.mecheye.net/2012/06/the-linux-graphics-stack/)

这解释了 X11/Wayland 等以及它们如何组合在一起。除了已经提到的内容之外，我认为值得添加一些关于您可以在 Linux 中用于图形的以下 API：

[Mesa](http://en.wikipedia.org/wiki/Mesa_%28computer_graphics%29) - “Mesa 有很多东西，但它提供的最着名的主要功能之一是它的 OpenGL 实现。它是 OpenGL API 的开源实现。”

[Cairo](http://en.wikipedia.org/wiki/Cairo_%28graphics%29) - “cairo 是一个绘图库，既可以由 Firefox 等应用程序直接使用，也可以通过 GTK+ 等库用于绘制矢量形状。”

[DRM（直接渲染管理器）](http://en.wikipedia.org/wiki/Direct_Rendering_Infrastructure) -我对此了解最少，但它基本上是内核驱动程序，可让您直接将图形写入帧缓冲区而无需通过 X

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-10-03T21:33:03.127

我想这个问题更像是“什么是 linux 的原生 GUI API”。

在大多数情况下，X（又名 X11）将用于：[http](http://en.wikipedia.org/wiki/X_Window_System) ://en.wikipedia.org/wiki/X_Window_System 。

[您可以在此处](http://xfree86.org/current/manindex3.html)找到 API 文档

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-10-03T21:26:48.670

XWindows 可能是最接近可以称为“本机”的东西 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-27T01:49:06.133

linux 内核图形操作在 /include/linux/fb.h 中作为 struct fb_ops。最终，这就是 X11、Wayland 或 DRM 等附加组件所引用的内容。由于这些操作仅适用于视频卡，而不是矢量或光栅硬拷贝或面向 tty 的终端设备，因此它们作为 GUI 的有用性是有限的；如果您不介意在必要时使用一些汇编程序绕过系统调用，那么您需要这些附加组件来获得图形输出并不完全正确。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-04T07:39:38.330

## 韦兰

正如您可能听说的，**[Wayland](https://wayland.freedesktop.org/)**是当今许多发行版的特色选择，因为它的协议比 X 更简单。

### Wayland 工具包

wayland[建议](https://wayland.freedesktop.org/toolkits.html)的工具包或 gui 库是：

*   QT 5
*   GTK+
*   迷幻剂
*   杂波
*   英语

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-04T00:54:31.520

linux 中最接近 Win32 的是 libc，因为您不仅提到了 UI，还提到了事件和“其他操作系统的东西”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-29T09:37:39.723

GUI 是一种高级别的能力抽象，所以从 XOrg 服务器到 OpenGL 的几乎所有东西都是跨平台移植的，包括 Windows 平台。但是，如果您所说的 GUI API 是指 *nix 图形 API，那么您可能会在“直接渲染基础设施”周围徘徊。

# php - php分页和limit子句的使用

> ID：12717139
> 
> 赞同：0
> 
> 时间：2012-10-03T21:24:00.410
> 
> 标签：php, pagination, limit

想象一下，您有一个 1m 的记录表，并且您想将搜索结果限制在 10,000 条以内，并且不超过 10,000 条。那我有什么用呢？好吧，答案是使用限制条款。

例子

`select recid from mytable order by recid asc limit 10000`

这将为我提供输入到此表中的最后 10,000 条记录。

到目前为止没有分页。但是限制短语已经在使用。

这将问题带到了一个新的水平。

如果我想一次翻阅此记录特定记录集 100 个记录，该怎么办？由于该 `limit`短语已经是原始查询的一部分，我该如何再次使用它，这次来处理分页？

如果组织。查询开始时没有限制子句，我会先调整它`limit 0,100`，然后再调整它`limit 100,100`，然后`limit 200,100`在分页过程中进行调整。但此时，我不能。

你几乎认为你想一个接一个地使用两个限制短语——这是行不通的。

`limit 10000 limit 0,100`肯定会出错。

那么在这种特殊情况下的解决方案是什么？

[编辑]

在我发布这个问题后，我意识到 org. 一旦分页例程启动，查询就变得毫无意义。我不知何故让自己感到困惑，尽管这 `order by recid asc limit 10000`完全是 where 子句的一部分。实际上，该`limit 10000`部分与记录集内容无关 - 除了将记录集限制在请求的限制之外。因此，一旦分页开始，就没有必要保持 10000 的限制。很抱歉在这件事上浪费了你的时间。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:48:09.610

偏移量建议是一个很好的建议，您可能应该使用它。但是，如果由于某种原因偏移量不符合您的需求（例如插入新记录的人会稍微改变您的页面），您还可以在查询中添加 where recid > #### 子句。这就是您在使用 Twitter API 时的分页方式。

这是 PHP 中的一个示例。

```
 <?php
        $query = 'select recid from mytable';
        if(isset($_GET['recid'])&&$_GET['recid']!=''){
            $query = $query.' where recid > '.$_GET['recid'];
        }
        $query = $query.' order by recid asc limit 10000';

        //LOG INTO MYSQL

        $result = mysql_query($query);
        $last_id = '';

        while ($row = mysql_fetch_assoc($result)) {
             //DO YOUR DISPLAY WORK
             $last_id = $row['recid'];
        }

        echo '<a href="?recid='.$last_id.'>Next Page</a>';
   ?> 
```

同样，比需要的要复杂一些，但会返回设置的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:30:17.967

我会说摆脱第一个限制，然后不要费心对表格进行计数，或者取计数和限制中的较小者，即 10000，并以此为基础进行分页。

IE

```
$perpage = 100;
$pages = $totalcount/$perpage;
$page = $get['Page'];
if($page > $pages || $page < 0)
{
     $page = 0;
}
$limit = "LIMIT " . ($page * $perpage) . ", " . $perpage; 
```

要计算总数，请执行

```
SELECT COUNT(*) FROM mytable 
```

然后根据您的限制检查它，即

```
if($totalcount > 10000)
{
    $totalcount = 10000;
} 
```

进行专用计数查询的原因是它需要很少的 DB 到 PHP 数据传输，并且与全表 SELECT 查询相比，许多 DBMS 可以优化其中的废话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T21:34:51.500

LIMIT 可以有两个参数，第一个是偏移量，第二个是要返回的记录数。所以

```
LIMIT 5,10 
```

将跳过前 5 条记录，然后获取接下来的 10 条。

您必须根据当前页面设置限制。就像是

```
LIMIT (CURRENT_PAGE  -1) * PAGE_SIZE , PAGE_SIZE 
```

因此，如果您每页有 10 条记录并且在第 2 页，您将跳过前 10 条记录并抓取接下来的 10 条。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T21:27:53.343

您可以使用偏移量变量。如果这是您的完整查询，那么您可以使用：

```
select recid from mytable order by recid asc limit 100 offset 300 
```

例如会给你从 300-399。显然，您将为每页增加 100 的偏移量。所以对于第一页偏移 = 0，对于第二页偏移 = 100，等等。

一般偏移量 = (page-1)*100

正如@Mathieu Lmbert 所说，您可以确保偏移量不会达到 9900。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-10-03T21:28:28.180

实际上只能有一个限制，并且必须在查询中。因此，唯一的解决方案是调整查询中的 LIMIT 子句。

您不应该做的是阅读所有 10.000 个条目，丢弃您不想要的 9900 个条目。

# sql-server-2008-r2 - 带有文件制作器的 SQL 链接服务器

> ID：12717143
> 
> 赞同：3
> 
> 时间：2012-10-03T21:24:41.237
> 
> 标签：sql-server-2008-r2, sql-server-2012, linked-server, filemaker

我有一个使用 FileMaker Pro 11 Advanced 的客户。

我需要能够通过 SQL 连接到 filemaker 数据库。我用的是MS SQL Server 2008 R2，或者Server 2012都可以。

这些是我尝试过的步骤

0) 在文件中打开 ODBC/JDBC 共享 -> 在 FileMaker Pro 11 Advanced 上为“所有用户”共享

1) 安装 filemaker 光盘中包含的 FileMaker OBDC 驱动程序

2) C:\Windows\SysWOW64 中的 odbcad32.exe 并添加了一个新的 filemaker System DSN 并将其定向到 filemaker 数据库。

3) 尝试使用 Provider Microsoft OLE DB Provider for OBDC Drivers 和我为数据源创建的系统 DSN 名称将链接服务器添加到 SQL。我将所有其他字段留空。

我收到此错误：

```
Cannot initialize the data source object of OLE DB provider "MSDASQL" for linked server "FILEMAKER2".
OLE DB provider "MSDASQL" for linked server "FILEMAKER2" returned message "[Microsoft][ODBC Driver Manager] The specified DSN contains an architecture mismatch between the Driver and Application". (Microsoft SQL Server, Error: 7303) 
```

FILEMAKER2 就是我所说的系统 DSN。

我做错了什么/我需要纠正什么才能使用 SQL 连接到 filemaker？

是否有要为 Provider String 输入的连接字符串？

我尝试通过访问进行测试连接时遇到相同的不匹配错误。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T19:41:02.947

您收到的错误是因为安装的驱动程序是 32 位驱动程序，适用于 64 位系统。在 FM 的下载中查找正确的 xbit 驱动程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T03:11:31.283

我已经使用 PHP 应用程序中的 ODBC 连接到 FM，以执行基本的数据插入、更新和删除。不过，我并没有像您尝试的那样使用它，而且就像@ted 所说的那样，FM 确实不是作为 SQL 平台构建的。

他们对此的回答是反其道而行之。您可以在 FileMaker 中设置外部 SQL 源，并将您的 SQL 数据库绑定到 FM，以便这些表在 FM 中的显示与常规 FM 表相同。然后可以在 FM 脚本中相应地使用这些表，因此您可以在那里设置任何必要的数据同步步骤。例如，您可以创建脚本以在一天中以给定的时间间隔将数据从 FM 布局移动到 SQL DB 布局。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-24T03:19:08.900

FileMaker 11 仅附带 32 位 ODBC 驱动程序。当您将 32 位驱动程序与 64 位 ODBC 管理实用程序一起使用时，会发生错误。使用此处的 32 位实用程序设置您的 DSN：

C:\Windows\SysWOW64\odbcad32.exe

...它会正常工作。

# php - 如何描述三个项目之间的石头剪刀布关系？

> ID：12717149
> 
> 赞同：12
> 
> 时间：2012-10-03T21:25:16.447
> 
> 标签：php, oop

假设我有以下结构：

```
abstract class Hand {}

class Rock extends Hand {}
class Paper extends Hand {}
class Scissors extends Hand {} 
```

目标是创建一个函数（或方法）`Hand::compareHands(Hand $hand1, Hand $hand2)`，它将在剪刀石头布比赛中返回获胜的手。

用一堆`if`s 会很容易，但关键是要有一个更健壮的结构，它依赖于多态性而不是过程代码。

PS 这是在实际生产代码中完成的，如果有人问的话。这不是某种挑战或家庭作业。（这不是真正的石头剪刀布，但你明白了）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-04T11:50:29.960

你的手的唯一性质是它正在击败另一只手。

然后你不想重复代码，同时每个手形都有一个具体的类型，所以你需要参数化。根据您可以允许的自由级别，这可以像受保护的成员一样简单：

```
abstract class Hand {

    protected $beats;

    final public function beats(Hand $opponent) {

        return $opponent instanceof $this->beats;
    }
}

class Rock extends Hand {

    protected beats = 'Scissors';
}

class Paper extends Hand {

    protected beats = 'Rock';
}

class Scissors extends Hand {

    protected beats = 'Paper';
} 
```

我认为这是这里的标准*模板方法模式*，形式非常简单。

将此与[Lusitanian 的答案](https://stackoverflow.com/a/12717221/367456)进行比较，谁应该获得实际代码的学分，我只是对其进行了重新排序。但只有很少。

此外，我需要[感谢 @Leigh 以获得更好的功能和参数命名](https://chat.stackoverflow.com/transcript/message/5626599#5626599)。这应该减少评论的需要。

Lusistanian 建议的第二种选择可以用*策略模式*来表示。它也有点直截了当：

```
class EvaluateHands
{
    private $rules;

    public function __construct(array $rules)
    {
        $this->rules = $rules;
    }

    public function compareHands(Hand $hand1, Hand $hand2)
    {
        return $this->rules[get_class($hand1)] === get_class($hand2) ? $hand1 : $hand2;
    }
}

new EvaluateHands(
    array(
        'Rock' => 'Scissors',
        'Paper' => 'Rock',
        'Scissor' => 'Paper'
    )
); 
```

两只手之间的比较已经完全封装成`EvaluateHands`甚至可配置的类型（如果游戏规则改变），而手将保持不变：

```
abstract class Hand {}

class Rock extends Hand {}

class Paper extends Hand {}

class Scissors extends Hand {} 
```

此代码的学分归功于[gordon](https://chat.stackoverflow.com/transcript/message/5627094#5627094)（在 Lusistanian 旁边）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T21:31:08.520

这个怎么样？

```
class Scissors extends Hand implements Beats<Paper> {} 
```

其中 Beats<> 是一个通用接口，其签名如下所示：

```
interface Beats<Hand> {} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T21:32:32.387

来自 PHP 聊天

OOP 风格

```
<?php
interface Hand {
    function beats(Hand $hand);
}

class Rock implements Hand {
    public function beats(Hand $hand) {
        return $hand instanceof Scissors;
    }
}
class Paper implements Hand {
    public function beats(Hand $hand) {
        return $hand instanceof Rock;
    }
}

class Scissors implements Hand {
    public function beats(Hand $hand) {
        return $hand instanceof Paper;
    }
} 
```

简单的功能

```
<?php
const PAPER = 1;
const ROCK = 2;
const SCISSORS = 3;

function whichHandWon($hand1, $hand2) {
    $winners = [PAPER => ROCK, ROCK => SCISSORS, SCISSORS => PAPER];
    return intval($winners[$hand1] !== $hand2) + 1;
} 
```

# javascript - jquery字符串插值导致问题

> ID：12717150
> 
> 赞同：0
> 
> 时间：2012-10-03T21:25:18.540
> 
> 标签：javascript, jquery, jquery-tokeninput, string-interpolation

我正在使用 jquery tokeninput 插件，并且我希望 json 令牌输入数据依赖于可以在表单中某处找到的值。我的代码如下所示：

```
jQuery(function() {
  var bparam;
  if ($('#tokens')) {
    bparam = $('#select_menu').val();
    return $('#tokens').tokenInput(("/tokens.json?b=" + bparam)({
      theme: 'facebook',
    }));
  }
}); 
```

因此，如果 select_menu div 中的值是 124，插件应该发出诸如 /tokens.json?b=124 之类的请求。

不知何故，这只是行不通，我不知道为什么。我仍然是一个 javascript 新手。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:09:13.433

除了我必须进行的 length > 0 调用（感谢您指出 Stuart Nelson 和 Shusl！），结果发现，coffeescript 中的字符串插值不知何故没有按我的意愿工作。翻译成 javascript 的相同代码确实有效。Coffeescript 被翻译成：

```
jQuery(function() {
  var bparam;
  if ($('#tokens').length > 0) {
    bparam = $('#select_menu').val();
    return $('#tokens').tokenInput(("/tokens.json?b=" + bparam)({
      theme: 'facebook',
    }));
  }
}); 
```

现在，工作代码是直接用 javascript/jquery 编写的，是：

```
jQuery(function() {
if ($("#tokens").length > 0) {
    var bparam
    bparam = $('#select_menu').val();
      return $('#tokens').tokenInput("/tokens.json?b=" + bparam, {
        theme: 'facebook',
      });
   }
}); 
```

注意这些额外的括号

```
(("/tokens.json?b=" + bparam) 
```

然而

```
("/tokens.json?b=" + bparam 
```

是工作解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:36:42.287

`if ($('#tokens'))`将返回一个空数组 ( `[]`)，所以无论如何它总是会评估为真。我猜你`if ($('#tokens').length)`想要 如果数组中有一个项目，它将评估为 true，如果它为空，则评估为 false。

什么让你绊倒是在设置变量时。`bparam`正在设置页面加载。当触发事件发生时，我会将其绑定到设置。

# python - 如何在部署到 Heroku 时中止 Celery 任务

> ID：12717156
> 
> 赞同：4
> 
> 时间：2012-10-03T21:26:05.743
> 
> 标签：python, celery, django-celery

当我的 django 应用程序的新版本部署到 heroku 时，工作人员被迫重新启动。我有一些长时间运行的任务，应该在被杀死之前执行一些清理工作。

我已经尝试注册一个似乎并不是每个都被调用的 worker_shutdown 钩子。

我也尝试过[通知 celery task of worker shutdown](https://stackoverflow.com/questions/8138642/notify-celery-task-of-worker-shutdown)的答案，但我不清楚如何在此上下文中中止给定任务，因为调用 celery.task.control.active() 会引发异常（celery 不再运行）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T19:47:11.663

如果您控制部署，也许您可​​以运行一个对自定义命令执行[Control.broadcast](http://celery.readthedocs.org/en/latest/reference/celery.app.control.html#celery.app.control.Control.broadcast)的脚本，您可以[事先注册](http://docs.celeryproject.org/en/latest/userguide/workers.html#writing-your-own-remote-control-commands)该命令，并且只有在收到所需的回复（您必须实现该逻辑）之后，您才能继续部署（或引发 TimeoutException）？

此外，芹菜已经有一个[预定义的关闭命令](http://docs.celeryproject.org/en/latest/internals/reference/celery.worker.control.html#celery.worker.control.shutdown)，我猜你可能会在你的实例或工作者子类中超载。命令具有传递 Panel 实例的优点，该实例允许您访问[consumer](http://docs.celeryproject.org/en/master/internals/reference/celery.worker.consumer.html#celery.worker.consumer.Consumer)。那应该在那里暴露很多控制权......

# php - setcookie 不能以正确的方式工作

> ID：12717165
> 
> 赞同：0
> 
> 时间：2012-10-03T21:26:36.733
> 
> 标签：php, cookies, setcookie

我有

```
<?php ob_start(); ?>
<?php 
$rng2 = random_string('alnum', 24);
setcookie("rng2", md5($rng2), time()+7200, '/');
?> 
```

作为我页面的前 5 行。`<?php ob_end_flush(); ?>`我的页面末尾确实有。

我也在用这些行重新加载页面后检查 cookie 的值

```
print_r($_COOKIE);

echo "<br /><br />".$_COOKIE['rng2']."/cookie[rng2]<br />";
echo $_POST['f']."/post[f]<br />";
echo md5($_POST['f'])."/md5(post[f])<br />";
if($_COOKIE['rng2'] != md5($_POST['f'])){
    $err .= "There was an error submitting the form.<br />";
} 
```

cookie ['rng2'] 没有出现在我的 print_r() 中，变量 $_COOKIE['rng2'] 显示两个“/”之间没有空格，$_POST['f'] 出现正确。

我似乎无法让它工作。我在网上找不到任何关于设置 cookie 的页面是否包含在内的信息，但我想我会提到它。

任何见解都会有所帮助。谢谢你。

# c++ - C ++模板const char数组到int

> ID：12717174
> 
> 赞同：0
> 
> 时间：2012-10-03T21:27:02.040
> 
> 标签：c++, string, templates

所以，我希望能够拥有一个静态的 const 编译时结构，它通过使用模板来保存基于字符串的一些值。我只需要最多四个字符。我知道'abcd'的类型是`int`，'ab'，'abc'也是，虽然'a'是类型`char`，但它适用于a`template<int v> struct`

我想要做的是取一些 const char “abcd”的大小为 2、3、4、5，并具有与使用“abcd”相同的功能。*请注意，我不是指 1、2、3 或 4，因为我期望空终止符。*

`cout << typeid("abcd").name() << endl;` 告诉我这个硬编码字符串的类型是`char const [5]`，最后包含空终止符。

我知道我需要将值作为字符旋转，因此它们表示为整数。

我不能使用`constexpr`，因为 VS10 不支持它（VS11 也不支持..）

所以，例如在某个地方定义了这个模板，然后是最后一行

```
template <int v> struct something {
    static const int value = v;
};

//Eventually in some method
cout << typeid(something<'abcd'>::value).name() << endl; 
```

工作得很好。

我试过了

```
template<char v[5]> struct something2 {
    static const int value = v[0];
}

template<char const v[5]> struct something2 {
    static const int value = v[0];
}

template<const char v[5]> struct something2 {
    static const int value = v[0];
} 
```

它们都是单独构建的，但是当我进行测试时，

```
cout << typeid(something2<"abcd">::value).name() << endl; 
```

我明白了

```
'something2' : invalid expression as a template argument for 'v'
'something2' : use of class template requires template argument list 
```

* * *

这是不可行的还是我误解了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:34:53.940

14.1 列出了可接受的非类型模板参数类型：

> — 整数或枚举类型，
> — 指向对象的指针或指向函数的指针， — 指向对象的
> 左值引用或指向函数的左值引用，
> — 指向成员的指针，

数组不属于这些类别中的任何一个。

14.3.2/1 列出了允许作为模板参数的类别，14.3.2/2 继续说：

> 注意：字符串文字 (2.14.5) 不满足任何这些类别的要求，因此不是可接受的模板参数。

因此你不能做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:38:39.613

从标准来看，你不能。

14.3.2.1：

> 非类型、非模板模板参数的模板参数应为以下之一：
> 
> *   整数或枚举类型的整数常量表达式；或者
> *   非类型模板参数的名称；或者
> *   具有外部链接的对象或函数的地址，包括函数模板 > 和函数模板 ID，但不包括非静态类成员，表示为 & id-> 表达式，如果名称引用函数或数组，则 & 是可选的，或者如果 >corresponding template-parameter 是一个参考；或者
> *   指向成员的指针，如 5.3.1 中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:23:11.200

有一种方法可以接近你想要的。可能这对您有用，尽管它增加了要维护的额外代码级别。

它需要定义带有外部链接的 const char 数组，然后使用这些数组的名称从模板中实例化类。当然，在实际使用中，这段代码会被分成不同的 .h 和 .cpp 文件。

```
extern const char a[] = "a";
extern const char b[] = "b";
extern const char ab[] = "ab";
extern const char abc[] = "abc";

template <const char * const  T> class Test
{
public:
    Test() {str = typename T;};
private:
    const char * str;
};

SomeFunction()
{
    Test<a> A;
    Test<b> B;
    Test<ab> AB;
    Test<abc> ABC;
} 
```

# java - 我应该从多个线程访问（而不是更改）一个对象吗？

> ID：12717178
> 
> 赞同：0
> 
> 时间：2012-10-03T21:27:47.053
> 
> 标签：java, multithreading, concurrency, synchronization

我的情况是我有两个线程。第一个线程产生许多对象，直到所有对象都被创建后，第二个线程才能访问这些对象。之后，第二个线程读取这些对象中的字段，但与第一个线程同时进行。此时没有线程正在更改对象字段的值。对象不同步。我应该同步它们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T21:30:45.673

我推荐的是使用`AtomicReference<Collection<SomeObject>>`. 第一个线程将生成对象集合并执行`reference.put(collection)`. 第二个线程将在唯一`reference.get()`设置后看到对象（） 。`AtomicReference`以下[是`AtomicReference`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicReference.html). 您还可以将对象设置为数组或任何类型的集合，例如`List`.

如果重要的是要意识到在您设置集合（或数组）之后`AtomicReference`您不能对集合进行任何更改。你不能添加额外的项目，清除它等等。如果你想真正并发访问一组对象，那么你应该看看[`ConcurrentHashMap`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)和朋友。

> 我应该同步它们吗？

如果对象在放入您的集合后根本不会发生变异，那么您*不需要**使*它们同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:30:36.053

同时从多个线程读取数据并没有错。当您尝试修改该数据时会出现问题。只要对象完全初始化并且值使得第二个线程接收实际值（缓存等没有问题），同时从多个线程读取数据就没有问题。

# numpy - python numpy中的子类ndarray：更改数组的大小和值

> ID：12717185
> 
> 赞同：1
> 
> 时间：2012-10-03T21:28:39.943
> 
> 标签：numpy, subclass, multidimensional-array

有人在这里问这个问题：[Subclassing numpy ndarray 问题](https://stackoverflow.com/questions/5149269/subclassing-numpy-ndarray-problem)，但基本上没有答案。

这是我的问题版本。假设您将 numpy.ndarray 子类化为当您尝试将元素设置为超出当前形状时自动扩展的内容。您需要覆盖**setitem**并使用一些 numpy.concatenate 调用来构造一个新数组，然后以某种方式将其分配给“self”。如何将数组分配给“自我”？

```
class myArray(numpy.ndarray):
    def __new__(cls, input_array):
        obj = numpy.asarray(input_array).view(cls)
        return(obj)

    def __array_finalize__(self, obj):
        if obj is None: return

    try:
        super(myArray, self).__setitem__(coords, value)
    except IndexError as e:
        logging.error("Adjusting array")
        ...
        self = new_array # THIS IS WRONG 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:31:16.177

为什么是子类？为什么不给你的包装对象它自己的数据成员，它是一个`ndarray`并使用`__getitem__`和`__setitem__`操作包装的数据成员？这基本上是`ndarray`已经做的，包装了 Python 的内置容器。还可以看看[Python Pandas](http://pandas.pydata.org/)，它已经做了很多你所说的包裹在`ndarray`.

# html - 语义网格系统，媒体查询问题

> ID：12717191
> 
> 赞同：1
> 
> 时间：2012-10-03T21:29:14.913
> 
> 标签：html, responsive-design, media-queries, semantic.gs

我正在使用[语义网格系统](http://www.semantic.gs)来构建响应式站点。然而，媒体查询有些地方不太对劲，一旦达到特定的屏幕尺寸，显然应该启动。

我将引用他们[在网站上的示例的](http://semantic.gs/examples/responsive/responsive.html)意思：例如，如果我在我的 iPhone 上查看它，考虑到它应该在移动设备上调整为单列结构，它仍然会抛出网络版本的页。我的 iPhone 上的 Safari 和 Chrome 都是如此。但是，如果我使用[RWD 小书签](http://responsive.victorcoulon.fr)检查它在不同分辨率下的外观，它会按照移动分辨率的预期显示。此外，具有讽刺意味的是，如果我在桌面上的 Safari 中调整页面大小，一旦我缩小到合适的屏幕尺寸，它也会相应地调整，但在 Firefox 中则不会。

一旦达到 720px，它使用的媒体查询是

```
@media screen and (max-width: 720px) {
#maincolumn,
#sidebar {
    .column(12);
    margin-bottom: 1em;
}
} 
```

我在这里可能有点过分，但我认为这一定是问题所在。但鉴于这直接来自semantic.gs 网站，我认为我没有必要的专业知识来质疑他们自己的代码。

知道问题可能是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:06:44.203

您描述的行为可能是未在标记中使用“视口”元标记的结果：

```
<meta content="width=device-width" name="viewport"> 
```

[http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/)

# perl - Perl 将参数传递给 eval

> ID：12717193
> 
> 赞同：4
> 
> 时间：2012-10-03T21:29:21.613
> 
> 标签：perl, arguments, eval

我在使用 eval 函数时遇到问题。

事实上，我在 SQL 数据库中有一些函数名，我的目标是在 perl 中执行这些函数（在 SQL 中检索之后）。

考虑到 $RssSource->{$k}{Proceed} 包含“&test”作为从 SQL 检索的字符串，这就是我正在做的事情：

```
my $str2 = "ABCD";
eval "$RssSource->{$k}{Proceed}";warn if $@;

sub test
{
   my $arg = shift;

   print "fct TEST -> ", $row, "\n";
} 
```

这工作正常并显示：

```
fct TEST -> 
```

但是我希望能够将 $str2 作为参数传递给 $RssSource->{$k}{Proceed} 但我不知道如何，我尝试的每个语法都返回一个错误：

```
eval "$RssSource->{$k}{Proceed}$str2"
eval "$RssSource->{$k}{Proceed}($str2)"
eval "$RssSource->{$k}{Proceed}"$str2
eval "$RssSource->{$k}{Proceed}"($str2) 
```

有人可以告诉我如何正确地将参数传递给评估函数吗？

非常感谢你的帮助

问候。

弗洛朗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:21:22.827

我将假设`$RssSource->{$k}{Proceed}`始终包含`name`or `&name`，否则您的要求没有多大意义。

```
my $func_name = $RssSource->{$k}{Proceed};
$func_name =~ s/&//;
my $func_ref = \&$func_name;    # Works with strict on!
$func_ref->(@args); 
```

如果要添加一些错误检查，以下将检查是否可以调用 sub：

```
defined(&$func_ref) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T21:33:16.280

如果您正在使用的字符串`eval`始终是子调用，则可以通过以下方式之一构造 eval 字符串：

```
$RssSource->{$k}{Proceed} . '($str2)' 
```

（最一般的），或

```
$RssSource->{$k}{Proceed} . "(\"$str2\")" 
```

（不雅）

以下是您的解决方案遇到的问题：

`eval "$RssSource->{$k}{Proceed}$str2"`评估为`eval "&testABCD"`。这个子不存在。

`eval "$RssSource->{$k}{Proceed}($str2)"`评估为`"&test(ABCD)"`。不允许裸词。

`eval "$RssSource->{$k}{Proceed}"$str2`字符串后面必须跟某种运算符，而不是另一个变量。

`eval "$RssSource->{$k}{Proceed}"($str2)`您正在尝试将字符串作为函数调用。Perl 不支持此功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T21:35:26.220

如果您可以将数据库中的数据更改为只包含一个函数名，也就是说，`test`而不是`&test`，您可以通过符号引用而不是使用 eval 来调用函数：

```
$fn="test";
&{$fn}("argument") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T23:23:20.610

如您所说，如果您的数据库仅包含函数名称，则不需要 eval 。您可以将它们用作符号引用（但请删除 &）。这样做的现代方法不是使用 & 来取消引用它，而是使用箭头运算符：

```
{
    no strict 'refs'; # hopefully you have strict on already...
    $RssSource->{$k}{Proceed}->($str2);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T02:13:03.500

很像ikegami的回答，用的`can`方法，比较符合我的口味。蒂姆托迪。

```
my $func_name = $RssSource->{$k}{Proceed};
$func_name =~ s/&//;
my $func_ref = __PACKAGE__->can($func_name)
  or die "No function named $func_name";
$func_ref->(@args); 
```

# windows - 非常简单的程序中来自 MASM32 的“致命错误 LNK1561：必须定义入口点”错误

> ID：12717196
> 
> 赞同：0
> 
> 时间：2012-10-03T21:29:39.230
> 
> 标签：windows, assembly, x86, masm32, coff

固定的; 这是固定代码（不做任何事情并崩溃，但它会组装，这就是重点）：

```
.686P
.MODEL FLAT
.CODE
_START:
    MOV al, 255
END _START 
```

我还发现我必须将`/c`开关与 ml 一起使用，然后与`/SUBSYSTEM:CONSOLE`.

* * *

刚刚重新发现了 x86 程序集和 MASM32，并且让自己重新熟悉了基础知识。因此，我编写了一个简短而毫无意义的程序，以查看是否可以组装任何东西：

```
.686P
.MODEL FLAT
.CODE
START:
    MOV al, 255
END 
```

我跑了`ml /coff test.asm`，得到了这个输出：

```
Microsoft (R) Macro Assembler Version 6.14.8444
Copyright (C) Microsoft Corp 1981-1997\.  All rights reserved.

 Assembling: test.asm
Microsoft (R) Incremental Linker Version 5.12.8078
Copyright (C) Microsoft Corp 1992-1998\. All rights reserved.

"test.obj"
"/OUT:test.exe"
LINK : fatal error LNK1561: entry point must be defined 
```

我在网上看到 START 是入口点的名称。我做错了还是这是一个不同的问题？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:48:38.837

该 END 指令用于设置入口点： http: [//msdn.microsoft.com/en-us/library/wxy1fb5k (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/wxy1fb5k(v=vs.80).aspx)

所以 END 应该是 END START。入口点标签可以是任何有效的标签名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:45:37.570

我没有 MASM，但通常入口点是`_start:`，而不是`START:`。

请参阅[此 MASM 示例程序](http://snipplr.com/view/4526/simple-masm-program/)。

# php - 下载并调整外部图像的大小

> ID：12717199
> 
> 赞同：1
> 
> 时间：2012-10-03T21:29:52.847
> 
> 标签：php, image-processing

如何使用 php 从远程服务器下载、调整大小和存储图像？这是我正在使用的代码

```
$temp_image = file_get_contents($url);
$image = imagecreatefromstring($temp_image);
$thumb = imageToCanvas($image,100,75,true);
imagejpeg($thumb,$base_image_path . $thumb_path,90)

function imageToCanvas($_image, $_canvasWidth, $_canvasHeight, $forceScale=false,$x=false,$y=false) 
{
    $newImage = imagecreatetruecolor($_canvasWidth, $_canvasHeight);
    $imageinfo = getimagesize($_image);
    $sourceWidth = $imageinfo[0];
    $sourceHeight = $imageinfo[1];  
    $sourceImage = openImage($_image);
    imagecopyresampled($newImage, $sourceImage, 0, 0, 0, 0, $_canvasWidth, $_canvasHeight, $sourceWidth, $sourceHeight);
    return $newImage;
}

function openImage($file) 
{
 // *** Get extension
 $extension = strtolower(strrchr($file, '.'));
 switch($extension) {
   case '.jpg': case '.jpeg':
     $img = @imagecreatefromjpeg($file);
     break;
   case '.gif':
    $img = @imagecreatefromgif($file);
     break;
   case '.png':
     $img = @imagecreatefrompng($file);
     break;
   default:
     $img = false;
     break;
 }
 return $img; 
} 
```

不起作用，我不知道为什么。

`$sourceWidth`&`$sourceHeight`没有值，所以我认为`$image`格式错误

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:34:19.447

如果您在 linux 服务器上并且安装了 ghostscript - 这是一种更简单的方法

```
shell_exec("转换 in.jpg -resize 100x75 out.jpg")
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:37:57.567

php 中没有调用函数，`openImage`所以如果您不自己定义它，那将是一个问题。

如果您确实定义了它，它是什么样的，您是否收到任何错误？

**编辑：**根据您的评论，问题似乎是您将`openImage`函数的输入参数视为文件路径。但是，当您调用它时，您正在为它提供图像资源，即`imagecreatefromstring`.

# excel - Excel - 可变长度数字中的可变数量的前导零？

> ID：12717200
> 
> 赞同：3
> 
> 时间：2012-10-03T21:30:08.460
> 
> 标签：excel, formatting, numbers, zero

多年来，我们的会员号码格式已多次更改，例如 00008、9538、746、0746、00746、100125 和其他各种排列是有效的、唯一的并且需要保留。从我们的数据库导出到大规模更新所需的自定义 Excel 模板会去除前导零，这样 00746 和 0746 都会被截断为 746。

在我们的例子中，插入撇号技巧或格式化为文本不起作用，因为当我们在 Excel 中打开数据时，数据似乎已经被更改。格式化为 zip 不起作用，因为我们有长度小于五位的有效数字不能添加零。而且我对“自定义”格式没有任何运气，因为这似乎需要向数字添加相同数量的前导零，或者为每个数字添加足够的零以使它们的长度相同。

有什么线索吗？我希望有某种方法可以将 Excel 设置为只接受它给出的内容并不管它，但情况似乎并非如此！我将不胜感激任何建议或意见。提前非常感谢大家！

更新 - 感谢大家的帮助！这里有一些更具体的。我们正在使用第 3 方会员管理应用程序——我们无法直接访问数据库，我们需要使用他们的“查询构建器”工具来获取我们想要大规模更新的数据。然后我们使用他们的“模板”格式导出，它被称为 XLSX 但幕后肯定有一些事情发生，因为如果我们尝试导入常规的旧 Excel，我们会得到一个错误。只有他们的模板有效。

数据在数据库中的格式很好，因为所有数字都在基于 Web 的管理工具中正确显示。此外，如果我导出为 CSV，将其另存为 .txt 并将其导入 Excel，则数字显示正常。

我所做的与下面 ooo 的解释类似——我用不正确的数字导出了模板，然后导出为 CSV/txt，然后将这些数字复制/粘贴到模板中并重新导入。我没有收到错误，这是我猜的，但是直到午夜之后我才能知道它是否成功！:-(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:14:37.643

假设数据库中的数据没有损坏，然后尝试从数据库导出到 csv 或文本文件。

然后可以执行以下操作以确保导入格式正确

带有逗号分隔符的文本文件：

![在此处输入图像描述](../Images/812db5ff81224f983706f594f279ba43.png)

在 Excel 数据/来自文本中并选择分隔，然后下一步

![在此处输入图像描述](../Images/71b0a94ce22a0810aab228432ef5acdb.png)

![在此处输入图像描述](../Images/d1dbd18f223cf989e3f6bd28c5dcdf19.png)

在导入向导的第 3 步中。对于您希望作为文本的每一列/字段，突出显示该列并选择文本

![在此处输入图像描述](../Images/7383e00b259628b2a9f0f7e94bd3ea45.png)

然后应将数据作为文本放置并保留前导零。

![在此处输入图像描述](../Images/e47a7789366c87fbdeea0332f1694f83.png)

同样，所有这些都假设数据库包含未损坏的数据，并且您能够导出简单的文本或 csv 文件。它还假设您拥有 Excel 2010，但可以在所有版本之间进行细微的更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T23:23:24.693

希望@ooo 的回答对您有用。我主要出于提供信息的目的提供另一个答案，并且不想处理评论的限制。

要理解的一件事是，Excel 非常积极地将“看起来像数字的”数据视为实际数字。如果您要通过双击打开 CSV 并让 Excel 执行它的操作（而不是使用 ooo 的仔细程序），这些数字仍然会以数字形式出现（没有前导零）。正如您所发现的，解决此问题的一种方法是将明确的非数字字符附加到您的数据中（在 Excel 得到它肮脏的手之前），以*真正让*Excel 相信它正在处理的是文本。

现在，如果上传到他们软件的文件是以 结尾的文件`.xlsx`，那么很可能*是*当前的 Excel 格式（压缩的 XML 文档，Excel 2007 及更高版本使用）。我想你的意思是“常规的旧 Excel” `.xls`（它仍然适用于“兼容模式”下的新 Excel）。

因此，如果您到目前为止尝试的方法不起作用，在诉诸将字符附加到数据末尾之前，仍有一些途径可以探索。（我会根据需要更新这个答案。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T21:34:52.177

你在撇号的正确轨道上。在将数字添加到文件时，您需要将数字作为文本存储在 Excel 中。

你用什么来创建原始的 excel 文件/从数据库导出？这可能是您需要关注出口的地方。

例如，一种方法是您可能会修改数据库导出以`'`在数字前包含符号前缀，以便 excel 知道将它们显示为文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-14T16:06:18.777

我使用公式`=text(cell,"# of zeros of the field")`添加前面的零。

例如，单元格`C2`有*12345*，我需要它有*10 个*字符长。我会放`=text(c2,"0000000000")`.

结果将是*0000012345*。

# jquery - 如何防止用户在表单上按住 Enter 键向我的网站发出请求？

> ID：12717205
> 
> 赞同：0
> 
> 时间：2012-10-03T21:30:37.680
> 
> 标签：jquery, forms, web-applications, double-submit-prevention, abuse

如果按下回车键，我有以下 jquery 代码用于提交表单：

```
$('body').on('keypress', 'input', function(event) {
    if (event.which === 13) {
        event.preventDefault();
        $(this).closest('form').submit();
    }
}); 
```

另外，我在页面加载时的用户名字段上将登录页面设置为 .focus() 。

因此，如果用户只是按住“输入”键，它将提交、失败、返回、聚焦、提交、重复。

我可以将按键事件仅在密码字段中触发，但我宁愿找到一种方法来检测长按键或防止这种情况的发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:33:15.647

限制事件，使其每秒只能发生一次。

```
var timer;
$('body').on('keypress', 'input', function(event) {
    var self = this;
    if (event.which === 13) {
        event.preventDefault();
        clearTimeout(timer);
        timer = setTimeout(function(){
            $(self).closest('form').submit();                
        },1000)
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:06:02.130

就像 Blender 说的那样，对于大多数浏览器来说，这是一种默认行为，对于表单中的输入，当您按下 Enter 键时提交表单（就像单击具有提交类型的输入）。

您的第一个代码似乎有点没用，因为它阻止了默认行为（提交表单），但最终提交了表单。

对于这样的问题，超时解决方案还不错，但在我看来太复杂了。

您的页面是一个登录页面，这意味着您希望在填写登录名和密码时允许登录尝试。此外，您不希望在短时间内允许多次提交同一页面。

你可以写一段代码，比如：

```
// Listening on submit event of the form
$("#FORM_ID").submit(function(submitEvent) {

    // Check if the login and password are not empty
    if (($.trim($("#LOGIN_INPUT_ID").val())).length == 0 ||
        ($.trim($("#PASSWORD_INPUT_ID").val())).length == 0)
    {
        // login or password is empty -> cancel the submit
        submitEvent.preventDefault();

        // TODO : warn user with a message
        // like "Please, fill login and password first !"

        return false;
    }

    // Avoid multiple submit at the same time
    // (for stupid guy clicking 10 times in 1 s)
    if ($(this).hasData('alreadySubmitted'))
    {
        // The form is currently already submit -> cancel the submit
        submitEvent.preventDefault();
        return false;
    }

    // Set the form "submitted"
    $(this).data('alreadySubmitted', true);

   // Let the submit do his job...
   return true;
}); 
```

# visual-studio-2012 - Visual Studio 2012 中的 Chutzpah 不扫描 HTML 测试工具

> ID：12717213
> 
> 赞同：0
> 
> 时间：2012-10-03T21:32:08.043
> 
> 标签：visual-studio-2012, qunit, chutzpah

在 Visual Studio 2012 中使用 Chutzpah。我有一个带有内联测试的 HTML 测试工具。但是 Chutzpah 似乎并没有“扫描”这些文件，以便它们出现在测试资源管理器中。

这是我的 HTML 的正文。我包括 qunit.js 文件。但是测试“我能找到一个名为 myDiv 的 div 吗？” 永远不会出现在测试资源管理器中。我是否需要将 HTML 文件放在某个文件夹中才能被检测到？

在 Tools->Options->Chutzpah 中，我将测试模式设置为“全部”

```
<div id="myDiv"></div>
<div id="qunit"></div>
<div id="qunit-fixture"></div>
<script>
    test("Can I find a div named myDiv?", function () {
        var myDivLength = $('#myDiv').length;
        equal(myDivLength, 1, "expected 1, got " + myDivLength);
    });
</script> 
```

有没有人遇到过类似的问题？我觉得 Chutzpah 将我的 Javascript 放在它自己的测试工具 HTML 文件中，而不是使用我的。但是对于 2.1 版，文档声明它应该使用这些文件： http: [//matthewmanela.com/](http://matthewmanela.com/)

# symfony - 变量的 Twig 模板变量

> ID：12717219
> 
> 赞同：1
> 
> 时间：2012-10-03T21:32:29.927
> 
> 标签：symfony, twig

我在树枝模板中有双倍：

```
<table>
   {% for user in users %}
      <tr>
         {% for field in fields %}
            <td>{{ user.{{field}}  }}</td>
         {% endfor %}   
      </tr>
   {% endfor %} 
</table> 
```

这可以做到吗？**{{ user.{{field}} }}**的正确语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:51:55.133

属性函数执行此操作，它可用于访问变量的“动态”属性：

```
<table>
   {% for user in users %}
      <tr>
         {% for field in fields %}
            <td>{{ attribute(user,field) }}</td>
         {% endfor %}   
      </tr>
   {% endfor %} 
</table> 
```

所以正确的语法是**{{ attribute(user,field) }} ，在**[这里](http://twig.sensiolabs.org/doc/functions/attribute.html)阅读文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:36:54.843

如果用户与字段是一对多的关系（即一个用户可以有多个字段），并且在 ORM 映射和实体中是这样定义的（即`User`实体有一个`getFields()`方法，它返回一个实体集合`Field`），那么你可以这样做：

```
<table>
   {% for user in users %}
      <tr>
         {% for field in user.fields %}
            <td>{{ field }}</td>
         {% endfor %}   
      </tr>
   {% endfor %} 
</table> 
```

但如果情况并非如此，那么它可能有助于更多地描述用户与其字段之间的关系。

# core-animation - 为自定义 CATranstion 使用核心动画

> ID：12717229
> 
> 赞同：0
> 
> 时间：2012-10-03T21:33:32.817
> 
> 标签：core-animation, core-graphics

我想实现一个新的 CATransition。

例如，假设我想做这样的效果：一个由 m 为两侧的层组成的数组，其中一侧具有源图像的一部分，另一侧具有目标图像的一部分。每一层将围绕其 x 轴旋转 180 度以显示另一侧。这样的逻辑（动画 CALayers）可以用于 CATransition 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:48:30.453

我不认为你能做到这一点。`CATransition`自定义内置类型和子类型之外的唯一方法是使用`CIFilter`（来自 iOS 5.0 或 OSX 10.5）。[根据文档](https://developer.apple.com/library/mac/#documentation/graphicsimaging/Reference/QuartzCoreFramework/Classes/CIFilter_Class/Reference/Reference.html)`CIFilter`，除了链接和配置内置过滤器之外，创建自定义的唯一方法是：

> 您可以继承 CIFilter 以创建：
> 
> *   通过将两个或多个内置核心图像过滤器（iOS 和 OS X）链接在一起的过滤器
> *   使用您编写的图像处理内核的自定义过滤器（仅限 OS X）

所以基于 CALayer 动画来做这件事是不可能的。在 OSX 上，这应该可以通过一些数学工作来管理，但不能直接使用 CALayers 动画。在 iOS 中，这根本不可能。

您可以通过直接使用图层来实现相同的效果，而不是执行 CATransition，但显然它不会那么容易地集成到您的 UI 代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T12:05:25.840

我写了一个你描述的过渡效果，但它不是 CATransition。相反，我创建了自己的方法来处理视图转换并调用它。

我的过渡将两个视图切割成垂直切片，然后制作了一个动画，我开始围绕它们的 Y 轴旋转切片，从最左边的切片开始向右工作，这会产生看起来很酷的级联效果。使用 CAAnimationGroup 对象需要做很多工作，加上对每个片段的动画使用 beginTime 来错开它的开始。一个过渡动画大约需要 5 页代码。

# mysql - 在不预先定义列数的情况下创建表

> ID：12717231
> 
> 赞同：0
> 
> 时间：2012-10-03T21:33:50.540
> 
> 标签：mysql, sql, database

有什么方法可以发出 mysql 语句来创建表而无需分配列数？我正在使用 MySQL C API 来获取一些变量，然后将它们存储在一个表中。我遇到的问题是我必须在将变量插入表之前（显然）创建表。这些变量有时是结构（两个、三个或四个变量放在一个表中），所以我正在寻找一种不必说的方法：

`CREATE TABLE Structures(ID varchar(10) primary key, name varchar(25))`

但是创建一个可以插入任意数量列的表？

如果我在这里有点含糊，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:55:57.817

另一种编码方式是使用两个表和它们之间的一对多。

例如，您可能有一个像这样的表 - pcode，

```
table experiment
  experiment_id: long
  experiment_header: varchar(50)

table experiemnt_data
  experiemnt_data_id: long
  experiment_id: long
  key: varchar(20)
  value: long

 @id = insert into experiment  (experiment_header) value("test run")

 insert into experiment_data  (experiment_id, key, value) value(@id, 'x', 1)
 insert into experiment_data  (experiment_id, key, value) value(@id, 'y', 20) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:39:51.303

不，你不能。但是，您可以在运行时使用`ALTER TABLE`.

但是，就个人而言，我不建议这样做。在开始实施之前，您应该知道您的数据库是什么样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-23T15:38:08.387

AS @Mark 和@attis 说：

> 你不能。但是，您可以在运行时使用 ALTER TABLE 添加列。
> 
> 但是，就个人而言，我不建议这样做。在开始实施之前，您应该知道您的数据库是什么样的。

我认为最好的解决方案可能是：创建两个表：

*   `column`与 ( `id`, `name`)
*   `values`与 ( `id`, `column_id`, `value`)

那么您只需加入他们即可轻松获得结果，并且您可以轻松添加其他“列”

您也可以将所有内容存储在`values`表中，但您的数据可能不一致，而且在我看来，查找数字比比较字符串（表锁、索引等）要快

我想评论@Mark 帖子，但不能（声誉太低）

# javascript - 单击另一个链接后，删除链接组的类别

> ID：12717234
> 
> 赞同：0
> 
> 时间：2012-10-03T21:34:13.580
> 
> 标签：javascript, jquery, hyperlink, selector, removeclass

这些链接组是我的导航元素。`var make_button_active`单击链接后删除并插入活动类。使用 CSS，class active 为链接的文本分配橙色。我有另一个链接在这个组之外。它是一个标志作为链接的链接`#home`。我希望一旦单击它，活动类就会从`ul.menu`. 这样，当点击#home 时，导航元素不会保持为橙色。我已经单独尝试过，但我是 javascript 的初学者。

你能帮我完成这个任务吗？

**HTML：**

```
<nav>
    <div id="logo">
        <a href="#home" class="panel"><img src="_img/logo.png" alt="DR logo" /></a>
    </div>
    <div id="categories">
        <ul class="menu">
                <li><a href="#aboutMe">ABOUT ME</a></li>
                <li><a href="#showcase">SHOWCASE</a></li>
                    <li><a href="#howWork">HOW DO I WORK</a></li>
            <li><a href="#meet">LETS MEET</a></li>  
        </ul>
    </div>
    <hr>
</nav> 
```

**CSS：**

```
.menu li.active a {
     color: #ff530d;
}​ 
```

**查询：**

```
<script type="text/javascript"> 
         var make_button_active = function()
           {
              //Get item siblings
              var siblings =($(this).siblings());
              //Remove active class on all buttons
              siblings.each(function (index)
                {
                  $(this).removeClass('active');
                }
              );

              //Add the clicked button class
              $(this).addClass('active');
            }

        var classOut = function()
            {
                $(".menu li").removeClass('active');
            }

             $(document).ready(function() {
            $(".menu li").click(make_button_active);

            $("#home").click(classOut);
        });
        </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:39:25.360

我重写了你的整个 JavaScript，[这](http://jsfiddle.net/C4fwV/4/)有帮助吗？

我将您的 JavaScript 更改为：

```
$(document).ready(function()
{

  $('.menu a').click(function(e)
  {
    e.preventDefault();
    $('.menu a').removeClass('active');
    $(this).addClass('active');        
  });

  $('#logo > a').click(function(e)
  {
    e.preventDefault();
    $('.menu a').removeClass('active');        
  });    

}); 
```

​</p>

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T21:42:24.340

首先：`jQuery !== JavaScript`

此外，`#home`不会选择您的主页链接，因为它不选择 href，而是选择 id。

改为使用`$("#logo a").click(classOut);`

此外，您的函数`make_button_active`应如下所示：

```
var make_button_active = function() {
      $('.active').removeClass('active');
      $(this).addClass('active');
} 
```

您不需要遍历所有兄弟姐妹，`active`一次只能在一个元素上，您只需选择它并删除该类，然后再将其设置在新选择的元素上。

最后，您不一定要执行**函数表达式** `var make_button_active = function(){...}`，**函数声明**在您的情况下是完全可以的：`function make_button_active(){...}`. 但是，通常使用函数是好的，而不是像 Sam 使用匿名函数那样，因为您可以轻松地重用这些函数。

您的整个脚本应如下所示：

```
<script type="text/javascript">

    function make_button_active(){
        $('.active').removeClass('active');
        $(this).addClass('active');
    }
    function classOut(){
        $(".menu li").removeClass('active');
    }

    $(document).ready(function() {
        $(".menu li").click(make_button_active);
        $("#logo a").click(classOut);
    });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T21:38:48.727

`home`您的标记中没有 ID 为的元素：

```
<a href="#home" id='home' class="panel"><img src="_img/logo.png" alt="DR logo" /></a> 
```

您正在使用 ID 选择器，并且您的选择器没有选择具有`#home`href 属性的元素。您可以将 ID 添加到您的元素或使用属性选择器：

```
$("a[href='#home']").click(classOut); 
```

你也不需要使用`each`方法：

```
var make_button_active = function() {
    $(this).addClass('active').siblings().removeClass('active')
}
var classOut = function() {
    $(".menu li").removeClass('active');
}

$(document).ready(function() {
    $(".menu li").click(make_button_active);
    $("#home").click(classOut);
}); 
```

[http://jsfiddle.net/hJdXU/](http://jsfiddle.net/hJdXU/)

# css - 等距的 DIV 也来自父级的边界

> ID：12717235
> 
> 赞同：1
> 
> 时间：2012-10-03T21:34:13.440
> 
> 标签：css, html, inline, spacing

我需要内联 DIV 在彼此之间等距间隔，另外还需要在边框和行中的第一个（或最后一个）DIV 之间。我使用在[具有等间距 DIV 的流体宽度上](https://stackoverflow.com/questions/6865194/fluid-width-with-equally-spaced-divs)找到的解决方案。它使 DIV 之间的间距相等，但左 DIV 贴在左边框上，右 DIV 贴在右边框上。我希望它与边界之间的距离相等，因为它们彼此之间的距离相等。

更新：内容 DIV 是由 Django 动态创建的，所以我不能说一行中有多少（在 1 到 4 之间）。

如何在侧面创建与 DIV 之间的距离相等的额外空间？

这是html：

```
 <div class="container">
        <div class="content">
                <canvas width="130" height="130"></canvas>
            </div>
            <div class="content">
                <canvas width="130" height="130"></canvas>
            </div>
            <div class="content">
                <canvas width="130" height="130"></canvas>
            </div>
        </div> 
```

和CSS：

```
div.container {
    width: 100%;
    text-align: justify;
}

div.content {
    display: inline-block;
    width: 20%;
    margin: 0 auto;
}

div.container:after {
    content: "";
    width: 100%;
    display: inline-block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:41:01.050

您可以使用一定百分比的框布局和填充，如下所示（我只使用了 10% 的填充，但您可以根据需要进行调整）：

[http://jsfiddle.net/XXPwW/2/](http://jsfiddle.net/XXPwW/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:43:01.720

在问完这个问题之后，我就找到了答案（多么讽刺？）。我会分享它以防有人需要它。

我所做的是在第一个和最后一个内容 DIV 之前创建宽度为 0 的间隔 DIV。这是它的样子：

HTML：

```
 <div class="container">
        <div class="spacer"></div>
        <div class="content">
            <canvas width="130" height="130"></canvas>
        </div>
        <div class="content">
            <canvas width="130" height="130"></canvas>
        </div>
        <div class="content">
            <canvas width="130" height="130"></canvas>
        </div>
        <div class="spacer"></div>
    </div> 
```

和CSS：

```
 div.container {
        width: 100%;
        text-align: justify;
    }

    div.content {
        display: inline-block;
        width: 20%;
        margin: 0 auto;
    }

    div.container:after {
        content: "";
        width: 100%;
        display: inline-block;
    }

    div.spacer {
        display: inline-block;
        width: 0;
    } 
```

# java - 在 Java 中为方法设置超时的正确方法

> ID：12717237
> 
> 赞同：1
> 
> 时间：2012-10-03T21:34:21.180
> 
> 标签：java

我已经在 SO 上查看了一些现有的答案，并且我将[Future](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Future.html)与[ExecutorService结合使用，将](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)[TimeUnit](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/TimeUnit.html)设置为方法的超时。

但是我试图在我的服务实现中的一个方法上设置超时，这意味着调用者类正在使用接口。

所以我想避免在我的服务实现中实现可调用，因为我希望这个方法在同一个线程中执行。

是否有其他方法可以在给定方法上设置超时或模拟超时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:43:08.723

您可以[`TimeLimiter`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/TimeLimiter.html)从[guava](/questions/tagged/guava "显示标记为“番石榴”的问题")看一下，它可以采用任何类并生成限时代理。但它仍然在内部使用线程池来等待`Future`（至少是默认[`SimpleTimeLimiter`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/SimpleTimeLimiter.html)实现）。

我想在同一个线程中运行方法，你必须有另一个线程在给定超时后中断它。中断并不总是有效。因而线程池`Future`是唯一的办法。

# code-coverage - 如何在 lcov/genhtml 代码覆盖率输出中包含测试用例描述

> ID：12717239
> 
> 赞同：5
> 
> 时间：2012-10-03T21:34:21.850
> 
> 标签：code-coverage, testcase, lcov

我正在使用 lcov 为 C 代码库生成代码覆盖率报告。我想将测试描述集成到最终输出中（使用 lcov 的 gendesc 实用程序。）

但是，我不知道如何做到这一点，而且关于 gendesc 的文档似乎相当稀疏​​（就老谷歌能够告诉我而言）。

LTP的[gendesc 信息](http://ltp.sourceforge.net/coverage/lcov/gendesc.1.php)描述了如何创建输入测试用例描述文件（正如 genhtml 所期望的那样）。并且[genhtml 信息](http://ltp.sourceforge.net/coverage/lcov/genhtml.1.php)提供`--show-descriptions`, 和`--description-file`用于输入这样的测试用例描述文件。

但是，我不知道如何引用测试用例以便将它们包含在最终报告中。genhtml 将它们视为*未使用的测试用例*，因此将它们排除在生成的 html 输出之外。我可以使用`--keep-descriptions`，但这并不能告诉我运行了哪些测试用例（显然是因为我不知道如何从代码引用到测试描述。）

那么，我们如何告诉 lcov/genhtml 在最终输出中运行了哪些测试？有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-12T14:09:53.600

要将测试用例名称与覆盖率数据相关联，请在使用 lcov 的 --test-name 选项收集覆盖率数据时指定该名称：

```
lcov --capture --directory project-dir --output-file coverage.info --test-name "test01" 
```

然后继续您已经提到的步骤，即创建一个测试用例描述文件“tests.txt”：

```
test01
    Some test 
```

将其转换为 genhtml 所期望的格式：

```
gendesc tests.txt --output-filename tests.desc 
```

最后指定描述文件到genhtml：

```
genhtml coverage.info --output-directory out --description-file tests.desc --show-details 
```

# qt - SVG 文件的 Qt QML 不支持的图像格式

> ID：12717240
> 
> 赞同：0
> 
> 时间：2012-10-03T21:34:25.873
> 
> 标签：qt, qt-creator, qml, embedded-linux, qtembedded

启动使用 QML 的 Qt Embedded 应用程序时，我不断收到以下错误。从谷歌搜索看来，我需要将图像加载插件添加到我的嵌入式系统导出的 nfs 中。所以我试图将它们添加几个地方，但我不断收到错误。我将嵌入式 ARM 版本的 libqsvg.so 添加到以下位置，但仍然出现错误...

```
/home/user/exported-nfs/lib/plugins/imageformats/libqsvg.so
/home/user/exported-nfs/plugins/imageformats/libqsvg.so
/home/user/exported-nfs/usr/bin/plugins/imageformats/libqsvg.so
/home/user/exported-nfs/usr/lib/plugins/imageformats/libqsvg.so
/home/user/exported-nfs/usr/plugins/imageformats/libqsvg.so 
```

这也不起作用：

```
export QT_PLUGIN_PATH=/usr/plugins:/usr/plugins/imageformats
echo $QT_PLUGIN_PATH 
```

我怎样才能解决这个问题？？我需要放置插件以便找到它们的正确位置在哪里？

错误：

> 警告：file:///usr/share/maliit/plugins/org/nemomobile/FunctionKey.qml:98:5：QML 图像：错误解码：file:///usr/share/maliit/plugins/org/nemomobile/ icon-m-input-methods-backspace.svg：不支持的图像格式
> 警告：file:///usr/share/maliit/plugins/org/nemomobile/FunctionKey.qml:98:5：QML 图像：错误解码：文件： ///usr/share/maliit/plugins/org/nemomobile/icon-m-input-methods-shift-lowercase.svg：不支持的图像格式
> 警告：file:///usr/share/maliit/plugins/org/nemomobile /FunctionKey.qml:98:5：QML 图像：解码错误：file:///usr/share/maliit/plugins/org/nemomobile/icon-m-input-methods-backspace.svg：不支持的图像格式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:33:34.903

答案是将插件目录复制到我的嵌入式板上，位于配置步骤中 -plugins 标志指定的位置。在我的情况下是 /usr/lib/qt/plugins。您还可以将环境变量 QT_DEBUG_PLUGINS 设置为 1，以从任何无法加载的插件中获取一些调试输出。

# r - 数据框线性拟合

> ID：12717248
> 
> 赞同：0
> 
> 时间：2012-10-03T21:34:55.377
> 
> 标签：r, dataframe

假设我有一个包含一堆列的数据框。我需要`lm`在第 1 列和第 2 列、第 1 列和第 3 列上调用函数，依此类推。所以基本上我需要在构建模型时遍历所有列并存储拟合结果。我遇到的问题是：

```
lm(df[1]~df[2], data = df) #doesnt work. In this case df is the data frame object 
                           #and df[1] is the first column. 
```

`df`什么是在循环中执行此操作的好方法，例如以迭代方式访问列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:53:20.237

这是第一列`df`作为因变量回归到所有其他列的示例，我认为这是您想要的..

```
x<-1:5
y<-5:1
df<-data.frame(x,y,x,y,x,y)
df1<-df[,1]
df2<-df[,2:6]
resultslist<-lapply(df2,function(x) (lm(df1~x))) 
```

如果您更具体地了解您想要的系数/输出，那么这个答案可能会更好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T03:23:07.303

鉴于您似乎想要循环通过多个适合单项线性模型的列，其中响应是 中的第一列`data.frame`，以下将起作用

```
dat <- data.frame(matrix(rnorm(110),ncol=11))
.names <- names(dat)
.formulae <- lapply(.names[-1], reformulate, response = .names[1])
results_list <- lapply(.formulae, lm, data = dat) 
```

# php - CakeDC 用户插件 - 我无法发送电子邮件

> ID：12717250
> 
> 赞同：0
> 
> 时间：2012-10-03T21:35:05.953
> 
> 标签：php, email, cakephp, smtp, cakedc

对于这个问题的漫无边际，我深表歉意，请多多包涵，我将提供您所需的所有额外信息，以阻止我在看起来非常简单的事情上失败而发疯......

我刚刚安装了 CakePHP 2.2，我做的第一件事是添加 cakeDC 用户插件。除了在用户注册时发送电子邮件验证外，一切正常。

我在 email.php 中尝试了很多不同的东西组合，现在我完全把我的短裤弄得一团糟。不管我做什么，当验证邮件应该发送时，我得到的只是：由于目标机器主动拒绝，无法建立连接。

我的 email.php 目前看起来像这样：

类电子邮件配置 {

```
public $default = array(
    'transport' => 'Smtp',
    'from' => 'blah@gmail.com',
    //'charset' => 'utf-8',
    //'headerCharset' => 'utf-8',
);

public $smtp = array(
    'transport' => 'Smtp',
    'from' => array('Blah <blah@gmail.com>' => 'Chimp'),
    'host' => 'ssl://smtp.gmail.com',
    'port' => 465,  
    'timeout' => 30,
    'username' => 'blah@gmail.com',
    'password' => 'secret',
    'client' => null,
    'log' => false,
    //'charset' => 'utf-8',
    //'headerCharset' => 'utf-8',
);

public $fast = array(
    'from' => 'blah@blah.net',
    'sender' => null,
    'to' => null,
    'cc' => null,
    'bcc' => null,
    'replyTo' => null,
    'readReceipt' => null,
    'returnPath' => null,
    'messageId' => true,
    'subject' => null,
    'message' => null,
    'headers' => null,
    'viewRender' => null,
    'template' => false,
    'layout' => false,
    'viewVars' => null,
    'attachments' => null,
    'emailFormat' => null,
    'transport' => 'Smtp',
    'host' => 'blah.net',
    'port' => 25,
    'timeout' => 30,
    'username' => 'user',
    'password' => 'secret',
    'client' => null,
    'log' => true,
    //'charset' => 'utf-8',
    //'headerCharset' => 'utf-8',
); 
```

}

如何让 cakeDC 用户插件仅发送非 SMTP 电子邮件？还是我*必须*使用例如我的 Gmail 详细信息？但是，如果我必须走 SMTP 路由，那么上面有什么问题？

其他信息：我使用的是最新版本的 XAMPP，并且我的 PHP 安装启用了 ssl。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T04:19:32.670

如果您使用的是 Windows，建议您将 SMTP 与您的 gmail 详细信息一起使用，是的。不要忘记激活 PHP 的 openSSL 扩展，以便能够通过 SSL 发送邮件。

像这样定义您的 $email 变量：

> App::uses('CakeEmail', '网络/电子邮件');
> 
> $email = new CakeEmail('smtp');

看看它是否有效

# java - Java Executor：小任务还是大任务？

> ID：12717251
> 
> 赞同：3
> 
> 时间：2012-10-03T21:35:10.813
> 
> 标签：java, multithreading, concurrency, java.util.concurrent, executor

考虑一个大任务，它可以分解成数百个独立运行的小任务。更具体地说，每个小任务都是发送一个轻量级的网络请求并决定从服务器收到的答案。这些小任务预计不会超过一秒钟，并且总共涉及几台服务器。

我想到了两种使用 Executor 框架来实现它的方法，我想知道哪个更好以及为什么。

1.  创建一些，比如 5 到 10 个任务，每个任务都涉及进行大量发送和接收。
2.  为每个发送和接收创建一个任务（可调用或可运行），并安排所有任务（数百个）由执行程序运行。

很抱歉，如果我的问题表明我懒得测试这些并亲自看看什么更好（至少在性能方面）。我的问题，在寻找这个具体案例的答案时，有一个更普遍的方面。在这种情况下，当您想使用执行器来执行所有调度和其他事情时，创建大量小任务还是将它们分组为更少数量的大任务更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:38:22.903

> 是创建大量小任务还是将它们分组为更少数量的大任务更好？

很难用这样的问题一概而论，但在你的情况下，我认为创建一些每个都做 5 到 10 件事的任务然后将其提交给执行者服务是没有意义的。

我会将所有工作作为一堆单独的小任务提交给`ExecutorService`. 我认为从对象/代码的角度来看，这将使任务更加清晰。他们不必拥有一组请求/响应，可以专注于发出一个请求并处理一个响应。

如果您不想将并发请求发送到特定服务器，则有一个例外。然后让一个任务为特定服务器执行所有请求/响应并为每个服务器提交一个任务是有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T21:47:05.407

一般来说，我会说较小的任务更好，因为它们就像模块并且可以以所需的方式组合，即使需求发生变化。

但是，如果它们只能作为一个块执行，那么您可以更好地了解一项大任务。

性能当然也是一个问题。但这在很大程度上取决于您的服务器/机器的 CPU 数量和整个系统的负载。即使我们知道，您到底在做什么，您也需要进行测试以确定什么更有效。但请记住，任务的初始化和管理也需要一些时间，如果您的操作非常小，您可能会在任务管理上投入比实际执行更多的时间。

对于需要处理请求的应答服务器来说，并行运行所有（小）任务也可能被证明是困难的。请记住，Web 服务通常也对它们可以服务的并行请求数量有限制。

# asp.net - 在标记中绑定 Web 用户控件属性

> ID：12717255
> 
> 赞同：0
> 
> 时间：2012-10-03T21:35:39.493
> 
> 标签：asp.net, vb.net

我确定这是基本的，但我无法弄清楚。

这不起作用**-**绑定表达式作为字符串传递给控件：

```
<uc:usercontrol runtat="server" message='<%#Me.protectedVariable%>'/> 
```

后面的代码包括 page_load 中的 Page.Databind() 调用。

但这确实有效：

```
<uc:usercontrol runat="server" id="usercontrol1"/> 
```

在 page_load 后面的代码中：

```
usercontrol1.message = Me.protectedVariable 
```

我必须从代​​码隐藏中绑定吗？这是页面生命周期问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:46:51.337

将 Page.DataBind() 移至 PreRender 事件处理程序，问题已解决。似乎 web 用户控件的属性尚未绑定到 page_load。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:57:05.160

代码看起来不错。

```
 <uc:usercontrol runtat="server" message='<%#Me.protectedVariable%>'/> 
```

应该管用。

protectedVariable 应该在调用 Page.Databind() 之前设置；

你能告诉，具体的问题是什么。

# ruby - 你将如何在 HAML 中实现“告诉不问”的原则？

> ID：12717257
> 
> 赞同：0
> 
> 时间：2012-10-03T21:35:58.427
> 
> 标签：ruby, haml, helper, tell-dont-ask

事情就是这样。我有一个按钮，根据场景的不同，它的行为、外观和文本都不同。目前大致是这样的：

```
- if params[:param_A] && @statement_A
  %span.button.cancel_button{attribute: "value_B"}
    - if @statement_B
      = t('locale_A')
    - else
      = t('locale_B')
- elsif params[:param_A]
  %span.button.cancel_button{attribute: "value_A"}
    - if @statement_B
      = t('locale_A')
    - else
      = t('locale_B') 
```

还有一个 CSS 类，两个按钮都应该有 IF statement_B 为真。

所以这是一团糟。我最近读到了我非常喜欢的“告诉，不要问”原则，所以我很想在这里应用它......但我不确定如何。

我知道我可以做一个帮手，但我想远离他们，因为原因（我确实有一些正当的理由这样做，但这些超出了这个问题的范围）。我可以将其作为最后的资源，但宁愿找到另一种解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:02:27.600

这与haml无关。您可以使用 tekll-don'r ask 从示例的外观开始：

```
- if params[:param_A] 
  %span.button.cancel_button{attribute: @object1.value}
    = t(@object2.locale) 
```

或者

```
- if params[:param_A] 
  %span.button.cancel_button{attribute: @object.value}
    = t(@object.locale) 
```

（取决于您的偏好/A/B 声明的真正含义）

为此，您需要在渲染之前根据语句值初始化对象。

# javascript - 框架上的 D3.js 转换回调

> ID：12717260
> 
> 赞同：4
> 
> 时间：2012-10-03T21:36:04.017
> 
> 标签：javascript, d3.js, transition

有谁知道我如何为 D3 的转换完成每帧回调。这是我目前正在做的事情的一个例子。

```
link.transition()
    .duration(duration)
    .attr("d", diagonal)
    .each("end",function(e) {
        if(e.target.id == current)
            show_tooltip(e.target)
    }); 
```

这当前在动画结束时为每个元素调用匿名函数。我想为每一帧调用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-14T10:57:41.703

您可以注册一个自定义补间，该补间返回您想要在每个滴答时调用的函数。

```
link.transition()
  .duration(duration)
  .attr("d", diagonal)
  .tween("side-effects", function() {
    return function() {
      console.log(d3.select(this), "tick");
    }
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T11:17:37.523

根据[https://github.com/mbostock/d3/wiki/Transitions#timers上的 D3 文档](https://github.com/mbostock/d3/wiki/Transitions#timers)

定时器队列会回调[requestAnimationFrame](http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/)

您应该能够使用它来实现您的转换。

# python - Python doctest 执行上下文

> ID：12717266
> 
> 赞同：1
> 
> 时间：2012-10-03T21:36:34.967
> 
> 标签：python, doctest

我有以下功能，我用 doctest 进行单元测试。

```
from collections import deque

def fill_q(histq=deque([])):
    """
    >>> fill_q()
    deque([1, 2, 3])
    >>> fill_q()
    deque([1, 2, 3])
    """
    if histq:
        assert(len(histq) == 0)
    histq.append(1)
    histq.append(2)
    histq.append(3)
    return histq

if __name__ == "__main__":
    import doctest
    doctest.testmod() 
```

第一种情况通过，但对 fill_q 的第二次调用失败，但它是相同的代码：

```
**********************************************************************
File "trial.py", line 7, in __main__.fill_q
Failed example:
    fill_q()
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.7/doctest.py", line 1289, in __run
        compileflags, 1) in test.globs
      File "<doctest __main__.fill_q[1]>", line 1, in <module>
        fill_q()
      File "trial.py", line 11, in fill_q
        assert(len(histq) == 0)
    AssertionError
**********************************************************************
1 items had failures:
   1 of   2 in __main__.fill_q
***Test Failed*** 1 failures. 
```

看起来 doctest 重新使用了`histq`第一次测试调用中的局部变量，为什么要这样做？这是非常愚蠢的行为（前提是我不是在这里疯狂地做某事）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:47:24.993

问题不在于`doctest`，而在于您在 中使用的默认参数`def fill_q(histq=deque([]))`。它与此类似：

```
>>> from collections import deque
>>> 
>>> def fill_q(data=deque([])):
...     data.append(1)
...     return data
... 
>>> fill_q()
deque([1])
>>> fill_q()
deque([1, 1])
>>> fill_q()
deque([1, 1, 1]) 
```

当您将可变对象用作列表或字典之类的默认值时，就会发生这种看似奇怪的行为。它实际上使用的是同一个对象：

```
>>> id(fill_q())
4485636624
>>> id(fill_q())
4485636624
>>> id(fill_q())
4485636624 
```

* * *

**为什么？**

`def`当且仅当它们所属的语句被执行时，默认参数值总是被评估[ [ref](http://docs.python.org/reference/compound_stmts.html#function) ]。

* * *

**如何避免这个错误：**

`None`改为用作默认参数，或用于任意对象：

```
my_obj = object()
def sample_func(value=my_obj):
    if value is my_obj:
        value = expression
    # then modify value 
```

* * *

**什么时候使用它？**：

1.  全局名称的本地重新绑定：

    ```
    import math

    def fast_func(sin=math.sin, cos=math.cos): 
    ```

2.  可用于记忆（例如，使某些递归运行得更快）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:45:28.787

你犯了一个非常常见的 Python 错误——如果你将一个对象设置为函数的默认构造函数，[它不会在下一次调用该函数时*重新初始化*](http://www.deadlybloodyserious.com/2008/05/default-argument-blunders/)——并且对该对象的任何更改都将在函数调用中持续存在。

避免此问题的更好策略是将默认值设置为某个已知值，并检查它：

```
def fill_q(histq=None):
    if histq is None:
        histq = deque([])
    ... 
```

# javascript - Code Igniter 显示数据库中的一条记录

> ID：12717273
> 
> 赞同：0
> 
> 时间：2012-10-03T21:37:03.817
> 
> 标签：javascript, database, codeigniter

如何显示数据库中的一条记录？基本上，我有一个页面，其中包含记录列表和每条记录的链接，上面写着投票。当我单击特定记录的投票链接时，我希望它只显示该记录。我该怎么做？

我在视图中显示所有记录的代码是：

```
<h2>List of all polls in this site:</h2>
<?php echo '<table>';?>
<h3>Title</h3>
<?php foreach ($polls as $polls_item): ?>

  <tr><td><a href="http://studweb.cosc.canterbury.ac.nz/~njp63/365/polls/index.php/user">Vote</a>

<?php 

    echo $polls_item['title'] . "</td>";?>
    <div id="main">
        <?php echo "<td>" .  $polls_item['text'] . "</td>";

?>
    </div>
   <td><a href="#">Delete</a></td></tr>

<?php endforeach ?>
<?php echo "</table>"; ?> 
```

我的模型：

```
<?php
class Polls_model extends CI_Model {

    public function __construct()
    {
        $this->load->database();
        $this->load->helper('url');
    }

    public function get_polls($slug = FALSE)
    {
        if ($slug === FALSE)
        {
            $query = $this->db->get('polls');
            return $query->result_array();
        }

        $query = $this->db->get_where('polls', array('slug' => $slug));
        return $query->row_array();
    }

    public function set_polls($title, $text)
    {

        $slug = url_title($this->input->post($title), 'dash', TRUE);

        $data = array(
            //'title' => $this->input->post('title'),
            //'slug' => $slug,
            //'text' => $this->input->post('text')

            'title' => $title,
            'slug' => $slug,
            'text' => $text
        );

        $this->db->insert('polls', $data);
        return $this->db->insert_id();

    }

    public function set_options($option, $pollid)
    {

        $values = $option;

        foreach ($values as $option){

            $options = array(
                'option_item' => $option,
                'poll_id' => $pollid
            );
            $this->db->insert('pollOption', $options);
        }
    }
} 
```

我的控制器：

```
<?php

// Debugging
error_reporting(E_ALL);
ini_set('display_error', '1');

class User extends CI_Controller {

    public function __construct()
    {
        parent::__construct();
        $this->load->model('polls_model');
    }

    public function index()
    {
        $data['polls'] = $this->polls_model->get_polls();
        $this->load->helper('html');
        $data['content'] = $this->load->view('user/index', $data, TRUE);
        $data['title'] = 'Polls archive';
        $this->load->view('templates/master', $data);
    }

    public function view($slug)
    {
        $data['polls_item'] = $this->polls_model->get_polls($slug);

        if (empty($data['polls_item']))
        {
            show_404();
        }

        $this->load->helper('html');
        $data['content'] = $this->load->view('user/view', $data, TRUE);
        $data['title'] = $data['polls_item']['title'];
        $this->load->view('templates/master', $data);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T05:13:30.263

**看法**

```
<?php foreach ($polls as $polls_item): ?>

  <tr><td><a href="siteurl/controller/method/{$polls_item['id']}">Vote</a>

<?php 

    echo $polls_item['title'] . "</td>";?>
    <div id="main">
        <?php echo "<td>" .  $polls_item['text'] . "</td>";

?>
    </div>
   <td><a href="#">Delete</a></td></tr>

<?php endforeach ?> 
```

当您单击`Vote`页面时，将重定向到中指定的 url`href`

**控制器**

```
function method()
{
    $data   =   array();
    $data['record'] =   $this->db->get_where('tbl_name', array('id' => (int)$this->uri->segment(3)))->row_array();  

    //load the view
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:47:01.803

为了只获取一条记录，请使用[WHERE 子句](http://codeigniter.com/user_guide/database/active_record.html#select)指定要从数据库中获取哪条记录。您可以使用 GET 参数来传递有关记录的独特信息，例如 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:16:18.690

你能在这里向我们展示你的控制器和模型吗？您需要在模型中有一个方法，该方法将使用 WHERE 子句查询该单个结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T02:19:25.427

您需要将 item_id 传递给视图中每一行的投票链接：

```
<? echo '<a href="http://studweb.cosc.canterbury.ac.nz/~njp63/365/polls/index.php/user/view/"'.$polls_item['slug'].'">Vote</a>' ?> 
```

# matlab - 在 MATLAB 绘图上缩放日期/时间标签时遇到问题

> ID：12717279
> 
> 赞同：1
> 
> 时间：2012-10-03T21:37:45.063
> 
> 标签：matlab

我正在尝试解决我在 MATLAB 中制作的绘图上的轴的一个棘手问题。我想显示温度预测的日期和时间（因此绘制的日期标签本质上是预测“有效”的小时，以 3 小时为增量）。值的范围大约是 5 天，但是我当前的图**只显示图上的前五个预测时间**（而不是整个范围，但只有几个点），如下图所示：

![不正确的时间轴](../Images/98cecddcdac7ffca43093c3875d9aacc.png)

我目前通过创建包含日期标签的字符串向量（从 DateVectors 矩阵生成）来显示这些标签。执行此操作的代码是：

```
% Format all the dates into strings that can be displayed on the graph
for rid = 1:numRows
    rowdate = formattedDates(rid,:);   % DateVector for this forecast step
    fcstDateStrs{rid} = datestr(rowdate, 'dd-mmm-yyyy HHZ');
end 
```

然后，我将这些日期作为 y 轴与 line `set(gca,'XtickLabel', {}, 'YtickLabel', fcstDateStrs)`。有没有办法可以缩放该轴上的标签以显示所有正确缩放的日期标签（这样第一个就像“03-Oct-2012 06Z”，最后一个就像“08-Oct- 2012 06Z")?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T04:48:54.980

您将不得不弄乱`ytick`轴的属性：

```
ticks = get(gca, 'ytick') 
```

会给你一个当前在 -axis 上分配的刻度线的向量`X`。您可以使用这些来设置所需的刻度数：

```
newTicks = linspace(ticks(1), ticks(end), numel(fcstDateStrs));
set(gca,...
    'Yticks'     , newTicks,...
    'YtickLabels', fcstDateStrs); 
```

请注意，由于您现在已手动设置刻度和刻度标签，因此重新缩放绘图会有些尴尬——只有在您相当确定绘图不会再发生太大变化时才执行此步骤。

# javascript - 如何在输入小部件中定位 x 以清除内容？

> ID：12717280
> 
> 赞同：6
> 
> 时间：2012-10-03T21:37:44.423
> 
> 标签：javascript, jquery, django, twitter-bootstrap

使用 twitter bootstrap 创建搜索样式输入小部件非常简单：

![在此处输入图像描述](../Images/8f7fd5cd96c340659d6025434f527f6b.png)

x 也可以通过 Twitter 引导程序实现，但是将 x 定位在该位置需要一些 CSS 微调。

我设法让 x 处于那个位置，但它不是很可靠。通过响应式设计和不同的分辨率，x 完全被取代。

```
.filter-close {
    float: none;
    position: relative;
    left: 5em;
    top: 1.25em;
    z-index: 3;
}

<form action="." method="get" class="form-search">
 <a class="close filter-close" href="#">x</a>                                           
    <div class="input-append">                  
        {{filter_form.last_name}}<button type="submit" class="btn"><i class='icon-filter'> </i></button>                </div>                          
</form> 
```

在尝试重新发明轮子之前，是否有任何现有的 javascript 库可以在 input-with-an-x-button 中转换输入？类似 Chosen.js 的东西是为了这个目的？或者任何建议我可以如何以更好的方式做到这一点？

非常感谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T22:27:31.800

看看[这个帖子](https://stackoverflow.com/questions/5763258/is-there-something-ready-for-a-clear-button-on-search-textbox)

[这个小提琴](http://jsfiddle.net/Q7fRB/1/)基本上可以做你想做的事情。

你正朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-21T22:49:13.003

通过对一些引导代码和一些 JavaScript 进行一些更改，您可以完成此操作，实际上您可以在文本框中放置您想要的任何控件。这是一个例子：

![在此处输入图像描述](../Images/e380282dc9a66f1a6c4f5dd96af0c72b.png)

这是用于生成它的最终标记：

```
<div class="composite-input">
    <span class="focus-input">Filter:</span> 
    <input type="text" /> 
    <span>×</span>
</div> 
```

有关完整代码，请查看这篇文章：[http ://www.simplygoodcode.com/2013/08/placing-text-and-controls-inside-text.html](http://www.simplygoodcode.com/2013/08/placing-text-and-controls-inside-text.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T04:38:55.947

基本上关键是使用`relative`定位和`left:-20px`清除元素。

例如：

```
<input type="text" /><span id="userclear">x</span>

span#userclear
{
  position: relative;
  left: -20px;
} 
```

这样，跨度将与左侧的输入重叠。您可以将事件处理程序附加到它以清除输入字段。

# javascript - 使用表单关闭 Reveal modal 时，某些行会停留然后消失

> ID：12717281
> 
> 赞同：0
> 
> 时间：2012-10-03T21:37:48.027
> 
> 标签：javascript, css, popup

我在我的登录按钮中添加了一个弹出窗口，因此当您单击它时，它会打开一个带有登录表单的弹出窗口，其中包含一些 HTML5 标记，例如 .

[http://justxp.plutohost.net/slyfiles/index.html](http://justxp.plutohost.net/slyfiles/index.html)

当您单击登录时，一切正常，但是当您关闭登录时，一些内容会保留下来，然后很快就会消失。

像这样的东西：

[http://puu.sh/1b7HB](http://puu.sh/1b7HB)

我该如何解决？

我的 HTML：

```
<a href="#" data-reveal-id="myModal">
      <div class="delogin">
          <div class="login">
                 <div id="lock"></div>
                 <span id="login">LOGIN</span>
          </div>
      </div>
      </a>
<div id="myModal" class="reveal-modal">
<form class="form-horizontal" id="login" method='post' action='?do=login'>
      <fieldset>
        <legend>Login</legend><br />
        <div class="alert alert-error">Are you sure you want to login? All of your registration data entered will be lost.</div>
        <div class="control-group">
          <label class="control-label" for="input01">Username</label>
          <div class="controls">
            <div class="input-prepend">
                <input type="text" class="input" id="username" name="username">
            </div>
          </div>
    </div>

     <div class="control-group">
        <label class="control-label" for="input01">Password</label>
          <div class="controls">
            <div class="input-prepend">
                <input type="password" class="input" id="password" name="password">
            </div>
            <h6><a href="forgotpass.php"><b style="color: #518FDB;">Forgot your password?</b></a></h6>
          </div>
    </div>
    <div class="control-group">
        <label class="control-label" for="input01"></label>
          <div class="controls">
           <button type="submit" class="btn btn-inverse">Login</button>

          </div>
    </div>
    </fieldset>
    </form>
     <a class="close-reveal-modal">&#215;</a>
</div> 
```

CSS

```
.reveal-modal-bg { 
    position: fixed; 
    height: 100%;
    width: 100%;
    background: #000;
    background: rgba(0,0,0,.8);
    z-index: 100;
    display: none;
    top: 0;
    left: 0; 
    }

.reveal-modal {
    visibility: hidden;
    top: 100px; 
    left: 50%;
    margin-left: -300px;
    width: 520px;
    background: #eee url(modal-gloss.png) no-repeat -200px -80px;
    position: absolute;
    z-index: 101;
    padding: 30px 40px 34px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    -moz-box-shadow: 0 0 10px rgba(0,0,0,.4);
    -webkit-box-shadow: 0 0 10px rgba(0,0,0,.4);
    -box-shadow: 0 0 10px rgba(0,0,0,.4);
    }

.reveal-modal.small         { width: 200px; margin-left: -140px;}
.reveal-modal.medium        { width: 400px; margin-left: -240px;}
.reveal-modal.large         { width: 600px; margin-left: -340px;}
.reveal-modal.xlarge        { width: 800px; margin-left: -440px;}

.reveal-modal .close-reveal-modal {
    font-size: 22px;
    line-height: .5;
    position: absolute;
    top: 8px;
    right: 11px;
    color: #aaa;
    text-shadow: 0 -1px 1px rbga(0,0,0,.6);
    font-weight: bold;
    cursor: pointer;
    } 
```

用js和教程显示POPUP：

[http://www.zurb.com/playground/reveal-modal-plugin](http://www.zurb.com/playground/reveal-modal-plugin)

当我添加一些 blablabla 文本时，它不会发生，那么是什么导致这种情况发生？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:50:16.773

想出了如何解决这个问题。

在reveal.js 中添加diplay:none; 到关闭功能。

像这样。

```
//Closing Animation
        modal.bind('reveal:close', function () {
          if(!locked) {
                lockModal();
                if(options.animation == "fadeAndPop") {
                    modalBG.delay(options.animationspeed).fadeOut(options.animationspeed);
                    modal.animate({
                        "top":  $(document).scrollTop()-topOffset + 'px',
                        "opacity" : 0
                    }, options.animationspeed/2, function() {
                        //on the line below add 'display' : 'none'
                        modal.css({'top':topMeasure, 'opacity' : 1, 'visibility' : 'hidden', 'display' : 'none'});
                        unlockModal();
                    });                 
                }   
                if(options.animation == "fade") {
                    modalBG.delay(options.animationspeed).fadeOut(options.animationspeed);
                    modal.animate({
                        "opacity" : 0
                    }, options.animationspeed, function() {
                        modal.css({'opacity' : 1, 'visibility' : 'hidden', 'top' : topMeasure});
                        unlockModal();
                    });                 
                }   
                if(options.animation == "none") {
                    modal.css({'visibility' : 'hidden', 'top' : topMeasure});
                    modalBG.css({'display' : 'none'});  
                }       
            }
            modal.unbind('reveal:close');
        }); 
```

# qt - 为什么我们总是要从 Qt 中的基类派生？

> ID：12717285
> 
> 赞同：3
> 
> 时间：2012-10-03T21:38:01.553
> 
> 标签：qt

当我们使用 Qt 时，我们总是从 Qt 类派生一个新类，并为我们的新类创建一个实例。例如，为了使用 QMainWindow 类，我们从 QMainWindow 派生一个新类，例如称为 MW，并从 MW 创建一个实例。

我的问题是为什么我们不在这种情况下从 QMainWindow 从基类创建一个实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:58:28.560

嗯，我已经使用 Qt 多年了，从来没有想过这个问题——好问题。

我会说如果您可以使用 QMainWindow 而不对其进行子类化 - 继续。但我认为基础 QMainWindow 类本身的用处是相当有限的。

我通常在子类中有成百上千行代码，比如创建菜单、连接信号和插槽等。如果不在子类中，我不确定这些代码在逻辑上会存在于何处。

QMainWindow 也有可能具有纯虚拟，因此您必须覆盖它。不过不知道，没看过。

希望这能回答我理解的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T00:04:28.090

您不需要子类化 QWidget / QMainWindow，但是用于创建新项目和新 UI 文件的 QtCreator 助手会这样做。

原因很简单：

1.  它强制执行更简洁的代码。您将此小部件/窗口的**行为**放在一个类中，而不是在类之外。因此，您的窗口的每个实例都具有相同的行为。如果您只是简单地实例化一个 QWidget / QMainWindow 并从外部添加行为（通过连接到您需要从外部创建的小部件的信号），那么这些实例可能具有不同的行为，这显然不是我们所理解的面向对象设计。

2.  可以将**子小部件**添加为成员。如您所知，只有在子类化时才能将成员添加到类中。不继承它意味着您需要使用小部件/主窗口将这些指针存储在代码中，从而导致代码错误。请注意，您不必存储指向子小部件的指针，因为它们被放入 QObject 树并由 Qt 内部管理。但是连接到信号、从 QLineEdit 读取文本等值等等，只有在您拥有指向这些小部件的指针时才会发生。

3.  **处理事件**需要子类化[*编辑：也可以使用事件过滤器来实现，请参阅评论*]，因为它们是作为虚拟方法而不是作为信号实现的。这还包括自定义绘画，这是通过重新实现 virtual 来完成的`paintEvent`。处理事件还包括对鼠标点击做出反应（除了点击子小部件，它们自己处理）、鼠标滚轮旋转、按键、最小化和最大化等等。如果您启用它，您可以使用信号槽连接处理的窗口上唯一的“操作”是关闭它并请求上下文菜单（右键单击）。所以这两个不一定需要子类化。

在良好的面向对象代码的上下文中更一般地说，创建子类的规则显然如下：

*   如果你有*相同事物的实例，在相同的输入/属性上表现相同*，它**应该是相同的类型**。

*   但是一旦你有实例，你就想*表现得不同，不仅取决于不同的输入/属性*，它**应该是另一种类型（子类）**。

*   只要您需要*更改*类的某些（已定义的）行为（“覆盖它”）或添加一些成员，它就**必须是另一种类型（子类）**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T07:18:39.570

说一个应该“总是”子类听起来很危险。我宁愿遵循“尽可能复合，必要时继承”。

除了在少数情况下它可以充当容器之外，QWidget 本身是无用且空的，并且它意味着专门用于实际做某事。

通过从外部添加中央小部件、菜单栏等，QMainWindow 可以完美地使用而无需子类化。由于来自工具栏按钮、菜单条目等的 QAction 需要连接到某个地方，因此主窗口通常包含作用于这些操作的插槽，这表明子类化。如果没有失控的话，有一个连接不同部分的中心位置，调出对话等是有点自然和好的 IMO。即，如果主窗口包含比转发动作触发器和简单地弹出对话框更多的逻辑，则应考虑将该逻辑移出主窗口。

尽管还有许多其他小部件不是为子类化而设计的，并且默认情况下对它们进行子类化毫无意义，没有充分的理由。子类化 QLineEdit、QPushButton（如果您需要特殊按钮，则子类 QAbstractButton）、QCheckBox 等几乎没有意义，因为它们不提供可以重新实现以更改行为的特定于小部件的虚拟方法。除非您重新实现虚拟方法，否则组合几乎总是实现目标的更好方法。是的，在某些情况下，重新实现 fooEvent() 可能比注册事件过滤器更直接。在这些情况下，这样做，但每当你需要 QLineEdit 时创建一个“MyLinedit”对我来说是荒谬和不好的做法。

# python - 根据模式将一个文件拆分为多个文件（剪切可以发生在行内）

> ID：12717294
> 
> 赞同：6
> 
> 时间：2012-10-03T21:38:50.167
> 
> 标签：python, perl, awk, split, gnu

存在很多解决方案，但这里的特殊性是我需要能够在一行内分割，剪切应该发生在模式之前。前任：

文件：

```
<?xml 1><blabla1>
<blabla><blabla2><blabla>
<blabla><blabla>
<blabla><blabla3><blabla><blabla>
<blabla><blabla><blabla><?xml 4>
<blabla>
<blabla><blabla><blabla>
<blabla><?xml 2><blabla><blabla> 
```

应该变成带图案`<?xml`

输出文件1：

```
<?xml 1><blabla1>
<blabla><blabla2><blabla>
<blabla><blabla>
<blabla><blabla3><blabla><blabla>
<blabla><blabla><blabla> 
```

输出文件2：

```
<?xml 4>
<blabla>
<blabla><blabla><blabla>
<blabla> 
```

文件3：

```
<?xml 2><blabla><blabla> 
```

实际上，[此处](https://stackoverflow.com/questions/8061475/split-one-file-into-multiple-files-based-on-pattern)`perl`验证答案中的脚本适用于我的小示例。但它会为我更大（约 6GB）的实际文件生成错误。错误是：

```
panic: sv_setpvn called with negative strlen at /home/.../split.pl line 7, <> chunk 1. 
```

我没有评论的权限，这就是我开始新帖子的原因。最后，一个`Python`解决方案将更加感激，因为我更好地理解它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T21:59:32.803

这会在不将所有内容读入 RAM 的情况下执行拆分：

```
def files():
    n = 0
    while True:
        n += 1
        yield open('/output/dir/%d.part' % n, 'w')

pat = '<?xml'
fs = files()
outfile = next(fs) 

with open(filename) as infile:
    for line in infile:
        if pat not in line:
            outfile.write(line)
        else:
            items = line.split(pat)
            outfile.write(items[0])
            for item in items[1:]:
                outfile = next(fs)
                outfile.write(pat + item) 
```

一个警告：如果您的模式分布在多行（即包含“\n”），这将不起作用。如果是这种情况，请考虑[mmap 解决方案。](https://stackoverflow.com/a/12717534/989121)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-04T02:00:13.970

Perl 可以逐行解析大文件，而不是将整个文件放入内存中。这是一个简短的脚本（带有解释）：

```
perl -n -E 'if (/(.*)(<\?xml.*)/ ) {
   print $fh $1 if $1;
   open $fh, ">output." . ++$i;
   print $fh $2;
} else { print $fh $_ }'  in.txt 
```

`perl -n`：*-n*标志将逐行遍历您的文件（将内容设置为 $_）

`-E`: 执行以下文本（Perl 默认需要一个文件名）

`if (/(.*)(<\?xml.*) )`如果一行匹配`<?xml`，则将该行（使用正则表达式匹配）拆分为 $1 和 $2。

`print $fh $1 if $1`将行的开头打印到旧文件。

`open $fh, ">output.". ++$i;`为写入创建一个新的文件句柄。

`print $fh $2`将该行的其余部分打印到新文件中。

`} else { print $fn $_ }`如果该行不匹配`<?xml`，只需将其打印到当前文件句柄。

注意：此脚本假定您的输入文件以`<?xml`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-03T22:03:55.167

对于这种大小的文件，您可能需要使用该[`mmap`](http://docs.python.org/library/mmap.html)模块，因此您不必自己处理文件的分块。从那里的文档：

> 内存映射文件对象的行为既像字符串，又像文件对象。然而，与普通字符串对象不同的是，它们是可变的。您可以在大多数需要字符串的地方使用 mmap 对象；例如，您可以使用 re 模块搜索内存映射文件。由于它们是可变的，您可以通过执行更改单个字符`obj[index] = 'a'`，或通过分配给切片来更改子字符串： `obj[i1:i2] = '...'`。您还可以从当前文件位置开始读取和写入数据，并`seek()`通过文件到不同位置。

这是一个快速示例，向您展示如何`<?xml #>`在文件中查找每个出现的 。您可以随时将块写入新文件，但我没有写那部分。

```
import mmap
import re

# a regex to match the "xml" nodes
r = re.compile(r'\<\?xml\s\d+\>')

with open('so.txt','r+b') as f:
    mp = mmap.mmap(f.fileno(),0)
    for m in r.finditer(mp):
        # here you can start collecting the starting positions and 
        # writing chunks to new files 
        print m.start() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T21:45:11.203

只需对您的搜索字词进行拆分

```
for i,part in enumerate(my_xml_Text_string.split("<?xml")):
    if not part.strip():continue # make sure its not empty
    with open("file%d.xml"%i,"w") as f: #open a file to write to
         f.write("<?xml"+part) #write the content putting your search term back in 
```

# ios - 奇怪的相机光圈快门动画

> ID：12717295
> 
> 赞同：0
> 
> 时间：2012-10-03T21:38:51.520
> 
> 标签：ios, ipad, camera, uiimagepickercontroller, uipopovercontroller

当我使用以下代码显示`UIImagePickerController`a时，我看到了相机光圈的奇怪动画：`UIPopoverController`

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
[imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
[popover setContentViewController:imagePicker animated:YES]; 
```

我还应该提到，此时`UIPopoverController`已经与另一个内容视图控制器一起呈现，因此调用`setContentViewController`将弹出框的内容更改为图像选择器。

这是显示图像选择器时的样子： ![奇怪的光圈快门动画](../Images/66706dbbe347799bbb492bc2f376396a.png)

这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:18:10.047

经过几个月的酝酿，我想出了解决方案！

快门动画下方难看的黑条与在将 设置为内容视图控制器之前`UIPopoverController`具有作为其内容视图控制器的事实有关。黑条的高度与导航栏的高度相同。`UINavigationController``UIImagePickerController``UINavigationController`

无论如何，解决方案是`[imagePicker contentSizeForViewInPopover]`在我将`UIPopoverController's`内容视图控制器设置为`UIImagePickerController`.

这是一些代码：

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
[imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
[popover setPopoverContentSize:[imagePicker contentSizeForViewInPopover] animated:YES]
[popover setContentViewController:imagePicker animated:YES]; 
```

关键是这里的调用：

```
[popover setPopoverContentSize:[imagePicker contentSizeForViewInPopover] animated:YES] 
```

# css - Div 不会内联定位

> ID：12717298
> 
> 赞同：0
> 
> 时间：2012-10-03T21:39:26.570
> 
> 标签：css

我有一个 1000 像素的 div 宽度和 100% 的高度，但是当我尝试在它旁边（在右侧）使用以下属性制作另一个 div 时：

```
margin-right: 20%;
border:  1px solid;
float: right;
height: 100%;
width: 10px; 
```

div 出现在主容器 div 结束位置的底部。

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:08:06.757

您可以分配 float:left; 或显示：内联块；到第一个 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:42:59.253

这有点令人困惑，但是将第二个 div 放在代码中的第一个 div 之前，那么浮点数会影响它。现在，第一个 div 是 display:block，它会下推下一行。

现在是：

```
<div id="1">
<div id="2" style="float:right"> 
```

将其更改为

```
<div id="2" style="float:right">
<div id="1"> 
```

# haskell - Haskell 类型同义词声明可能有约束？

> ID：12717301
> 
> 赞同：8
> 
> 时间：2012-10-03T21:39:35.183
> 
> 标签：haskell, types, polymorphism, constraints

假设我想为所有带有 Int 的列表创建一个类型同义词。

我可以做：

```
type NumberList = [Int] 
```

但是如果我想调用所有包含数字 NumberList 的列表呢？我如何设置约束并说只要“Num a”的所有[a]都应该被称为相同的？

编辑:: 看到我重新思考的答案后。似乎我违背了 Haskell 背后的一个基本理念，而且回报相对较小（只是形式上的问题）。我决定这样做：如果一个类型需要两个彼此相同但仅在 Int 或 Float 方面不同的实例，那么它们之间的差异太小，无法保证完成使用 Int 和 Float 所需的解决方法，但调用它们是同一件事，这就是为什么我必须将使用限制在其中之一。但是，如果我应该同时拥有两者有一个重要原因，那么我可能可以在实例名称中反映这个重要原因，从而通过以下方式避免问题：

```
data Thing = Thing_A(String, String Float) | Thing_B(String,String,Int) 
```

---因此坚持使用 Haskell 的类型系统并且仍然接受它们作为数据类型 Thing。一开始我想做的是

```
data Thing = Thing(String, String, Float) | Thing(String, String, Int) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T23:25:11.600

这对应于存在量化。在伪 Haskell 中，

```
type NumberList = exists a . Num a => [a] 
```

我说“伪”是因为 GHC 不允许动态引入存在量词——您需要为此创建一个单独的数据类型。

现在，您将在箭头左侧使用 NumberList 的大多数类型，其中 «exists» 有效地将其含义更改为 «forall»。

也就是说，而不是写

```
isIncreasing :: NumberList -> Bool 
```

这与

```
isIncreasing :: (exists a . Num a => [a]) -> Bool 
```

你可以写

```
isIncreasing :: forall a . Num a => [a] -> Bool 
```

或者干脆

```
isIncreasing :: Num a => [a] -> Bool 
```

当然，拥有类型同义词似乎代码更少，但它也有缺点。顺便说一下，这些缺点对于基于存在方法的面向对象编程来说是典型的。

例如，您想要连接两个列表。通常你会写

```
(++) :: forall a . [a] -> [a] -> [a] 
```

（再次`forall`是不必要的，为了清楚起见添加）。由于`a`在整个签名中是相同的，因此可以确保您连接相同类型的列表。

我们如何连接两个数字列表？一个签名

```
(++) :: NumberList -> NumberList -> NumberList 
```

行不通，因为一个列表可能包含 Ints，而另一个列表可能包含 Doubles。生成的 NumberList 必须包含单一类型的值。

或者，比如说，您想找到列表元素的总和。

通常你写

```
sum :: Num a => [a] -> a 
```

请注意，结果类型与列表元素的类型相同。唉，我们不能对 NumberList 做同样的事情！

```
sum :: NumberList -> ??? 
```

结果类型是什么？我们也可以在那里应用存在量化。

```
sum :: NumberList -> (exists a . Num a => a) 
```

但是现在原始列表类型和 sum 类型之间的联系丢失了——至少对于 Haskell 的类型系统来说是这样。如果您随后决定编写一个函数，例如

```
multiplySum :: Integer -> [Integer] -> Integer
multiplySum x ys = x * sum ys 
```

那么你会得到一个类型错误，因为`sum ys`可能是任何类型，不一定是整数类型。

如果你把所有东西都推到极致，让每一种类型都存在量化，那它会起作用——但是你最终会基本上用另一种类似面向对象的语言来解决它们的所有问题。

（也就是说，存在量化有一些很好的用例，当然。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-04T06:13:38.307

## 使用数据和参数，而不是existentials来获取上下文

我想如果你想要

```
data Thing = Good [(Char,Int)] | Bad String | Indifferent Leg 
```

但有时也

```
data Thing = Good [(Char,Float)] | Bad String | Indifferent Arm 
```

你可以定义

```
data Thing num bodypart = Good [(Char,num)] | Bad String | Indifferent bodypart 
```

或者如果你想确保`num`总是数字，你可以做

```
data Num num => Thing num bodypart = Good [(Char,num)] | Bad String | Indifferent bodypart 
```

最后，您可以`bodypart`通过定义自己的类来限制允许的类型：

```
class Body a where
   -- some useful function(s) here

instance Body Leg where
   -- define useful function(s) on Legs
instance Body Arm
   -- define useful function(s) on Arms

data (Num num,Body bodypart) => Thing num bodypart = 
                                                             Good [(Char,num)] | Bad String | Indifferent bodypart 
```

我想劝阻您不要通过 forall 构造函数或通过 GADT 使用存在类型，因为将`num`参数添加到您的数据类型在实践中*非常*有用，即使它需要更多的输入。

## 类型同义词的限制？

请注意，当您使用类似的约束时

```
data (Num num) => Thing num = T [(Char,num)] 
```

实际上只是将构造函数的类型更改`T`为

```
T :: (Num num) => [(Char,num)] -> Thing num 
```

而不是`T :: [(Char,num)] -> Thing num`. 这意味着每次您使用`T`时，都需要有一个 context `(Num num)`，但这正是您想要的 - 阻止人们将数据放入您的非数字数据类型中。

这个事实的结果是你*不能*写

```
type Num num => [(Char,num)] 
```

因为没有需要`T`上下文的数据构造函数；`(Num num)`如果我有 [('4',False)]，它会自动匹配类型`[(Char,num)]`，因为它是*同义词*。编译器在决定某事物是什么类型之前，不能在您的代码中运行以寻找实例。在这种`data`情况下，它有一个`T`告诉它类型的构造函数，它可以保证有一个`Num num`实例，因为它检查了你对函数的使用`T`。不`T`，没有上下文。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T23:52:22.283

GHC 使用 RankNTypes 允许这样做。

所以你可以这样做：

```
type NumList = forall a . (Num a ,Fractional a) => [a] 
```

然后如果我们有：

```
numList:: NumList
numList = [1,2,3]

fracList:: NumList
fracList = [1.3,1.7] 
```

做一个连接产生：

```
fracList ++ numList :: Fractional a => [a] 
```

其中 NumList 是同义词。总而言之，在这种情况下，我真的不明白这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T06:39:01.420

当您无法恢复原始类型时，拥有这样的类型没有多大意义。如果你只需要某些`Num`s，你应该简单地包装它们而不是变出沉重的魔法：

```
data NumWrapper = WInt Int 
                | WDouble Double 
                | WFloat Float 
                deriving Show

numList :: [NumWrapper]
numList = [WInt 12, WFloat 1.2, WDouble 3.14] 
```

如果您*真的*想对任意`Num`类型开放，那么列表可能只是您的错误集合。有 HLists 等，见[http://www.haskell.org/haskellwiki/Heterogenous_collections](http://www.haskell.org/haskellwiki/Heterogenous_collections)

# java - 在 STS 中部署来自外部项目的资源

> ID：12717302
> 
> 赞同：0
> 
> 时间：2012-10-03T21:39:48.167
> 
> 标签：java, eclipse, sts-springsourcetoolsuite

我有一个使用 Eclipse STS 部署到 Tomcat 7.0 的 Web 应用程序。我的 web 项目有一些自己的 xml 配置文件，但显然它从工作空间中的另一个 java 应用程序中提取或使用了一些外部 xml 文件。

Web 应用在 App>src>main>resources>config>spring>wiring 中有配置文件。另一个项目的 xml 文件位于应用程序运行所需的类似位置。STS 中有没有办法从外部 java 项目中获取 xml 资源以与我的 web 应用程序 xml 文件一起部署？我觉得到目前为止我已经尝试了一切，但没有运气。我的第一个想法是使用部署程序集，但这还没有奏效。

这个应用程序在同事机器上部署和运行正常，但到目前为止我一直无法让它工作。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:50:02.120

在项目属性的 Java 构建路径中，在源选项卡下有一个“链接源”按钮。它允许您将项目外部的文件夹视为包含源和资源。

这是我在环境之间切换配置文件的常规方法之一。

# colorbox - 集成广告库和彩盒

> ID：12717303
> 
> 赞同：2
> 
> 时间：2012-10-03T21:39:50.080
> 
> 标签：colorbox

我有一个 Ad Gallery 插件 (http://adgallery.codeplex.com/documentation)，当我点击图片时，它会打开 colorbox 插件。Ad gallery 提供了这个与 Fancybox 集成的代码片段：

```
$(".ad-gallery").on("click", ".ad-image", function() {
     $.fancybox.open({
           href : $(this).find("img").attr("src"),
           closeBtn: false,
           closeClick : true,
           openEffect : 'elastic',
           openSpeed : 150,
           closeEffect : 'elastic',
           closeSpeed : 150,
           helpers : {
           overlay : null
           }
           });
        }); 
```

colorbox 代码应该如何与 Ad Gallery 集成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-25T15:08:03.150

几乎`colorbox`是一样的：

```
$('.ad-gallery').on('click', '.ad-image', function () {
    $.colorbox({
        href: $(this).find('img').attr('src'),
        title: $(this).find('.ad-image-description').text()
    });
}); 
```

# permissions - 为什么当我尝试在 Wamp2.0 中打开 phpMyAdmin 时收到此消息“您无权访问此服务器上的 /phpmyadmin/。”

> ID：12717306
> 
> 赞同：0
> 
> 时间：2012-10-03T21:39:55.547
> 
> 标签：permissions, wamp, wampserver

我已经阅读了一些我阅读的帖子和解决方案。他们说我需要编辑我的 c:\wamp\alias\phpmyadmin.conf .. 我尝试了许多解决方案，例如：

```
 1\. <Directory "c:/wamp/apps/phpmyadmin3.4.5/">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride all
        Order Deny,Allow
    Deny from all
    Allow from 127.0.0.1
</Directory>

 2\. AllowOverride all
Order Deny,Al
Allow from all

 3\. Order Allow,Deny
Allow from all
Allow from 127.0.0.1 
```

我已经尝试了所有这些，但我仍然无法打开我的 phpMyAdmin。希望有人能解释并帮助我..谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:55:28.250

1.  您的“/phpmyadmin”别名设置不正确，或者指向的目录没有设置权限（在配置中）或权限设置错误。

2.  或者您可能有一个 .htaccess 文件专门阻止访问，尽管听起来不像。

您应该重新安装您的 wamp 风格（无论您使用哪个发行版），或者尝试设置 phpMyAdmin 并准备运行的任何数量的其他 WAMP...

[WampServer](http://www.wampserver.com/en/)、[UniformServer](http://www.uniformserver.com/)、 Wamp [-Developer](http://www.devside.net/server/webdeveloper)（商业）、Xampp 和其他六个...

[http://en.wikipedia.org/wiki/Comparison_of_WAMPs](http://en.wikipedia.org/wiki/Comparison_of_WAMPs)

# javascript - TypeScript 是否为 NodeJS 模块访问提供了明确的公共 API？

> ID：12717309
> 
> 赞同：11
> 
> 时间：2012-10-03T21:40:01.663
> 
> 标签：javascript, node.js, typescript, tsc

从节点应用程序中，我想做：

```
var typeScript = require('typescript'); 

typeScript.compile('...') 
```

我希望将编译器实现到构建系统中，但无法访问公共 API（typescript.compile 等），这是不可能的。

这是我想做的更完整的示例，尽管下面是针对 LiveScript，而不是 TypeScript，在为 Brunch.io 构建系统编写的插件中使用：

```
LiveScript = require 'LiveScript'
sysPath = require 'path'

module.exports = class LiveScriptCompiler
  brunchPlugin: yes
  type: 'javascript'
  extension: 'ls'

  constructor: (@config) ->
    null

  compile: (data, path, callback) ->
    try
      result = LiveScript.compile data, bare: yes
    catch err
      error = err
    finally
      callback error, result

  include: [
    (sysPath.join __dirname, '..', 'vendor', 'prelude-browser-0.6.0.js')
  ] 
```

好奇是否有人找到了解决方法？

**更新**

我最终针对上面和其他地方列出的各种问题实施了自己的解决方案。有关更多信息和用法，请参阅[https://github.com/damassi/TypeScript-Watcher](https://github.com/damassi/TypeScript-Watcher)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T22:52:12.067

这个有点hacky，但它会起作用。

昨天我也想过这个问题，我正在检查他们的代码。如果你从他们的源代码中检查 bin/typscript.js（这是一个非常非常大的文件，有将近 21k 行代码），你会看到它创建了 TypeScript.TypeScriptCompiler，然后你会发现这确实暴露了一种编译方式.

```
var compiler = new TypeScript.TypeScriptCompiler(outfile, errorfile, 
    new TypeScript.NullLogger(), settings); 
```

现在，您需要一种简单的方法来公开它。为此，您将不得不修改他们的代码，这就是为什么这是 hacky。为此，您可以通过添加以下内容来修改 typescript.js：

```
module.exports = exports = TypeScript; 
```

就在文件的末尾。

然后，您可以在模块的根目录中创建一个 index.js 文件（注意：将模块安装在所有这些的本地范围内：“npm install typescript”），它会公开对象。

```
exports.TypeScript = require("bin/typescript"); 
```

准备好了！现在你可以调用它并使用它编译你的代码。您可以在 tsc.js 文件中查看如何使用 API 进行编译。

我提前为前面的可怕代码道歉：

```
var fs = require("fs");
var TypeScript = require("typescript");
var path = "test.ts";
var pathout = "test.js";
var content = fs.readFileSync(path, "utf-8");
var fd = fs.openSync(pathout, 'w'); 
var outFile = { 
    Write: function (str) { 
        fs.writeSync(fd, str); 
    }, 
    WriteLine: function (str) {
    console.log(fd, str); 
        fs.writeSync(fd, str + '\r\n'); 
    }, 
    Close: function () { 
        fs.closeSync(fd); 
        fd = null; 
    } 
};
var createFile = function (path) { 
    function mkdirRecursiveSync(path) { 
        var stats = fs.statSync(path); 
        if(stats.isFile()) { 
            throw "\"" + path + "\" exists but isn't a directory."; 
        } else { 
            if(stats.isDirectory()) { 
                return; 
            } else { 
                mkdirRecursiveSync(_path.dirname(path)); 
                fs.mkdirSync(path, 509); 
            } 
        } 
    } 
    mkdirRecursiveSync(_path.dirname(path));
    console.log(path) 
    var fd = fs.openSync(path, 'w'); 
    return { 
        Write: function (str) { 
            fs.writeSync(fd, str); 
        }, 
        WriteLine: function (str) { 
            fs.writeSync(fd, str + '\r\n'); 
        }, 
        Close: function () { 
            fs.closeSync(fd); 
            fd = null; 
        } 
    }; 
};
var stderr = { 
    Write: function (str) { 
        process.stderr.write(str); 
    }, 
    WriteLine: function (str) { 
        process.stderr.write(str + '\n'); 
    }, 
    Close: function () { 
    } 
}
var compiler = new TypeScript.TypeScriptCompiler(outFile, outFile);
compiler.setErrorOutput(stderr);
compiler.addUnit(content, path);
compiler.typeCheck();
compiler.emit(false, createFile);
outFile.Close(); 
```

出于某种原因，编写代码的人是 C# 的真正粉丝，并继续使用称为 WriteLine、Close 和 Write 的方法，它们实际上只是包装器。您可能会因为必须添加此函数而产生开销，但您必须修改模块中的大量代码，这是不值得的。我认为最好有一个类来扩展（或者如果你还在 JS 上，继承原型）并让它为你做这件事，让它 DRY。

非常棒的一点是，如果您想翻译 500 个 TypeScript 文件并将它们全部放入一个 .js 文件中，您只需调用 compiler.addUnit(anothercontent, anotherpath); 500 次，然后将其全部放入一个文件中 :)

专注于更好的事情：如果你检查 tsc.js 代码，你会发现一个批处理编译器类。如果您希望将其用于构建过程，则最好使用类似它的更健壮的东西。它提供观看文件等。

浏览完代码，我想我只是向开发团队提交一张票，并要求他们提供更清晰的 API ¬¬

注意：这里的所有文件读取都是以同步方式完成的。就性能而言，这很糟糕，非常糟糕。我不确切知道您打算做什么，但是如果可能的话，我不能推荐您找到一种使此异步的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:01:24.873

目前，仅通过 require 和调用 compile 是不可能实现编译的。如果您可以查看harness.ts，则有一个编译器模块提供了一种相当简单的方法，但我建议您在外部调用tsc。

```
///<reference path='node.d.ts'/>
import exec = module('child_process');

var child = exec.exec('tsc foo.ts',
  function (error, stdout, stderr) {
    if (error !== null) {
      console.log('exec error: ' + error);
    }
}); 
```

我相信这会完成这项工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T06:41:23.923

查看niutech 的[这个 github 项目](https://github.com/niutech/typescript-compile)，它可以**在浏览器**中即时将 TypeScript 代码转换为 JS 代码，但我想它可以很容易地修改为在 node.js 中工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-01T15:06:06.687

如果您想要的只是执行/访问打字稿文件，[better-require可以帮助您实现这一目标。](https://github.com/olalonde/better-require)

它可以让你 require() typescript 文件——不需要预编译——以及一堆其他文件格式（coffeescript、clojurescript、yaml、xml 等）

```
require('better-require')();
var myModule = require('./mymodule.ts'); 
```

披露：我写了更好的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-13T11:03:54.397

你可以试试[https://github.com/sinclairzx81/typescript.api](https://github.com/sinclairzx81/typescript.api)。这个项目做了 require() 扩展的东西，但也有一些手动编译 ts 源的功能。应该可以用它创建一个自动构建系统。

请注意，它是基于 typescript 0.9 编译器构建的，因此鉴于语言的各种更新，您可能成功编译 0.8.3 源代码，也可能不成功。

# android - 从 ListView 中删除页脚时的空指针？

> ID：12717316
> 
> 赞同：0
> 
> 时间：2012-10-03T21:40:32.497
> 
> 标签：android, android-layout

> **可能重复：**
> [ListView.removeFooterView(View) 上的崩溃](https://stackoverflow.com/questions/11126422/crash-on-listview-removefooterviewview)

删除页脚视图时如何获得空指针异常？我在调用之前检查了页脚视图和列表视图都不为空

```
myListView.removeFooterView(mFooterView) 
```

这个列表视图确实有一个多列表适配器。我还检查了可以添加的每个页脚的父级，并且每个页脚的父级都为空。

顺便说一句，getAllFooterViews 到底在哪里？有页脚视图（页脚视图）？SDK 中的方法。

PS。我认为编写良好的 API 不应该隐藏此类信息。

```
 FATAL EXCEPTION:  main
  java.lang.NullPointerException
  at android.widget.ListView.removeFooterView(ListView.java:461)
  at com.mypackage.MyActivity.clearAllFooters() 
```

哪个页脚似乎并不重要。它实际上是我此时尝试删除的任何内容，可能已添加的四个页脚中的任何一个。

一些上下文，ListView 当前不可见，确实有焦点，并且在 Async 调用返回后正在清除页脚。我在同一个MyActivity上有三个listview，而这个ListView目前是不可见的，它没有焦点，但还是空指针异常？

我正在编译 4.03 并在 android sdk 2.2 上部署

我还在检查页脚计数是否大于 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:00:09.080

它可能是您的 Android API 的版本。这在这里描述得很好：[Crash on ListView.removeFooterView(View)](https://stackoverflow.com/questions/11126422/crash-on-listview-removefooterviewview)

看起来 Android 团队可能忘记在他们的 API 中检查 NULL。您可以在您的客户适配器类中解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:54:02.307

如您所见，Nullpointer 是由 API 而不是您的代码引起的。这并不意味着你不能处理它。我敢打赌，您的视图对象有一些不好的地方。

```
ListView.java:461 
```

清楚地说它是在android API代码内部引起的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:00:50.760

我会打赌以下两件事之一：

1.  您的*myListView*没有很好地膨胀，即您指向一个未定义的`View`ID（不太可能，因为在添加页脚/页眉或设置列表适配器时您可能会遇到同样的问题）；或者，
2.  我的第二个猜测，也是最有可能的，`mFooterView`是 null。确保你已经膨胀了正确的页脚`View`。

让我知道你的进展。

# sql-server - 字符长度的 900 字节索引大小限制

> ID：12717317
> 
> 赞同：42
> 
> 时间：2012-10-03T21:40:34.497
> 
> 标签：sql-server, indexing, sql-server-2012

SQL Server 2012 的 900 字节索引限制的总字符限制是多少。我创建了一个具有 的列`varchar(2000)`，但我认为它超过了 SQL Server 限制的 900 字节？`varchar(?)`900 字节索引列中的最大值是多少？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-10-03T21:53:28.653

[varchar](http://msdn.microsoft.com/en-us/library/ms176089.aspx)的存储大小是输入数据的实际长度 + 2 个字节。即使列本身有 2 个字节的开销，您也可以将最多[900 个字节](http://msdn.microsoft.com/en-us/library/ms191241.aspx)的 varchar 值放入索引的列中。

实际上，您可以在大于 900 字节的列上*创建索引，但如果您实际尝试**插入*大于 900 字节的内容，则会遇到问题：

```
create table test (
    col varchar(1000)
);
create index test_index on test (col);
-- Warning! The maximum key length is 900 bytes. The index 'test_index' has maximum length of 1000 bytes. For some combination of large values, the insert/update operation will fail.
insert into test select cast(replicate('x', 899) as varchar(1000)); -- Success
insert into test select cast(replicate('y', 900) as varchar(1000)); -- Success
insert into test select cast(replicate('z', 901) as varchar(1000)); -- Fail
-- Msg 1946, Level 16, State 3, Line 8
-- Operation failed. The index entry of length 901 bytes for the index 'test_index' exceeds the maximum length of 900 bytes. 
```

请注意，900 字节的限制包括给定索引键的所有列，如下例所示：

```
create table test (
      col varchar(1000)
    , otherCol bit -- This column will take a byte out of the index below, pun intended
);
create index test_index on test (col, otherCol);
insert into test select cast(replicate('x', 899) as varchar(1000)), 0; -- Success
insert into test select cast(replicate('y', 900) as varchar(1000)), 0; -- Fail
insert into test select cast(replicate('z', 901) as varchar(1000)), 0; -- Fail 
```

对于这些通常对于索引键来说太大的列，您可以通过将它们[包含](http://msdn.microsoft.com/en-us/library/ms190806.aspx)在索引中来获得索引的一些好处。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-11T16:11:08.570

在相关说明中，您可以尝试在宽列上获取索引的另一个选项在[http://www.brentozar.com/archive/2013/05/indexing-wide-keys-in-sql-server中进行了概述/](http://www.brentozar.com/archive/2013/05/indexing-wide-keys-in-sql-server/)其中一个哈希列被添加到表中，然后被索引并在您的查询中使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-02-22T13:14:33.507

对于 SQLServer 2016 上的那些，索引键大小增加到 1700 字节。[数据库引擎中的新增功能 - SQL Server 2016](https://docs.microsoft.com/en-us/sql/database-engine/whats-new-in-sql-server-2016)

> NONCLUSTERED 索引的最大索引键大小已增加到 1700 字节。

**演示：**

```
create table test
(
id varchar(800),
id1 varchar(900)
)

insert into test
select replicate('a',800),replicate('b',900)

create index nci on test(id,id1) 
```

# mysql - SQL选择多个最后一行

> ID：12717318
> 
> 赞同：2
> 
> 时间：2012-10-03T21:40:43.537
> 
> 标签：mysql, row

> **可能重复：**
> [获取 MySQL 中值最高的行](https://stackoverflow.com/questions/4407030/get-the-row-with-the-highest-value-in-mysql)

有没有办法选择多个`last rows`？

所以有一`version_id`列我想用来选择最后的条目。

还有另一列是`actual_id`.

我想`actual_ids`根据它们的最新版本提取一个列表。

`Last()`功能不起作用。我听说这`order by version_id desc limit 1`是一种方法，但它将我得到的任何结果集限制为只有 1 行。

有没有办法解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:42:49.070

所以`order by version_id desc`会给你你想要的数据集。然后限制子句会给你你想要的结果量。

你可以有任何数字，而不仅仅是 1。你可以做限制 5、限制 1000 或任何你想要的。

```
order by version_id desc limit 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:43:05.617

这是获取每个实际 id 的最新版本的一种方法：

```
select t.*
from t join
     (select t.actual_id, max(version_id) as maxv
      from t
      group by t.actual_id
     ) mt
     on t.actual_id = mt.actual_id and t.version = mt.maxv 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:42:52.343

如果您使用的是 SQL Server，我会这样做

```
select top n actual_id, version_id from ActualVersion order by version_id desc 
```

您可以将 n 替换为您要选择的顶级记录数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T21:43:53.623

您可以更改`1`为（例如）`5`：

```
order by version_id desc limit 5 
```

# php - 使用外部数据库在本地测试 PHP

> ID：12717320
> 
> 赞同：0
> 
> 时间：2012-10-03T21:40:53.083
> 
> 标签：php, mysql

我是 PHP 新手，正在为我的网站进行开发。我将有 MySQL 来运行数据库服务器端，我想在本地测试我的 PHP 代码。是否可以上传所有代码并从网站上进行测试，或者是否会更容易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:43:30.293

这是可能的，但是您的 MySQL 用户必须具有远程登录的权限（即`user@'%'`样式条目），并且服务器必须可以通过任何路由和防火墙进行外部访问。对于大多数在线安装来说，这不太可能，因为它会带来潜在的安全问题。

如评论中所述，只需在本地安装 MySQL 即可进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:43:26.870

**您应该能够在本地测试，而不需要任何其他东西，而不是您自己的机器**

如果你需要一个数据库，你应该在本地安装一个。如果大小很重要，只需使用数据库的精简变体（所谓的开发人员数据库）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:44:12.747

查看[WampServer](http://www.wampserver.com/en/)。这是一种快速设置本地测试环境的方法，包含您需要的一切：PHP、Apache（Web 服务器）、MySQL 和其他有用的工具（phpMyAdmin 等）

我也使用过 Zend Server Community Edition，但我更喜欢 WampServer。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T21:44:50.190

我喜欢在尽可能接近最终生产环境的情况下进行测试，所以如果您在不同的本地操作系统和生产环境上运行，我想在像生产服务器这样的服务器上进行测试。

只要您的本地环境可以访问远程 MySQL 服务器，就没有理由不能使用远程 MySQL 服务器。从安全的角度来看，这可能是不可取的。

如果需要，您还可以在本地运行 MySQL（那里有任何主要操作系统的安装程序）。

# codeigniter - 多个子域和站点的相同模型

> ID：12717324
> 
> 赞同：0
> 
> 时间：2012-10-03T21:41:45.330
> 
> 标签：codeigniter

我有多个站点（有些是子域，有些是其他站点）运行相同的数据库 && 缓存。目前，这些项目中的每一个都有一个独特的控制器/视图设置，但模型相同。我遇到了一个问题，我希望每个站点都使用相同的模型，因为让它们都保持最新是很痛苦的。

问题：当每个站点/子域都有自己的视图/控制器时，我如何在多个站点/子域上保持相同的模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T04:01:31.637

看看[这个线程](http://codeigniter.com/forums/viewthread/136321/)以获得灵感。如果您使用 *NIX 框，则接受的约定是使用[符号链接](http://en.wikipedia.org/wiki/Symbolic_link)来共享`models`应用程序目录之外的文件夹。如果您检查`sys/core/Loader.php`，您会发现路径构造所在的位置，因此线程中的一些人讨论了`MY_Loader.php`替代方案。不幸的是，`sys/core/Loader.php`代码因 CodeIgniter 支持的“包”而变得复杂，所以这不是一个简单的字符串更改。

# batch-file - If else 使用 ipconfig 批处理命令

> ID：12717325
> 
> 赞同：0
> 
> 时间：2012-10-03T21:41:47.677
> 
> 标签：batch-file, command, if-statement, ipconfig

我在批处理命令中使用 if else 语句时遇到问题。我正在运行 Windows XP。我写了一个简单的批处理文件来输出我的 ip 地址，它工作正常。但是，如果没有要显示的任何 IP 地址，我想包括“未找到 IP 地址”。我在这里查看了类似的问题，但找不到解决方案。

这是我拥有的代码（当有 IP 地址时可以正常工作）

```
@echo off
color 02
mode con:cols=60 lines=3
Title What's my ip?
:start
echo.
echo                   Here is your ip address!
ipconfig > nul
ipconfig > nul
ipconfig > nul
cls
echo.
ipconfig | find "IP Address"
ipconfig > nul
ipconfig > nul
ipconfig > nul
ipconfig > nul 
```

任何帮助将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:48:23.070

如果没有找到结果，find 将以非零返回值返回。尝试类似的东西

```
ipconfig | find "IP Address" || echo No IP found 
```

作为旁注：您的脚本不适用于我的 Win7 安装，您必须搜索字符串“IPv4-Adresse”或“IPv6-Adresse”。`find "IP"`可能更通用一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-06T15:09:04.513

```
ipconfig /all | find "v4" || echo No IP found 
```

这对我来说效果更好。

# exception - Grails“检查”异常

> ID：12717328
> 
> 赞同：0
> 
> 时间：2012-10-03T21:42:05.197
> 
> 标签：exception, grails, grails-orm

我需要从 Grails 服务中抛出异常。但 ：

1.  必须“检查”异常，以便 Hibernate 在抛出该异常时不会回滚。但看起来 Grails 中的基本异常类（“GrailsException”）未选中（从 RuntimeException 扩展）。Grails 中是否存在任何已检查的异常，我可以针对我的目的进行扩展？如果不是，我如何在 Grails 中创建已检查的异常类？

2.  我不太清楚何时可以将异常称为“已检查”或“未检查”？可能，更具体地说，我的问题是什么是检查异常，它的特征是什么？

如果需要对我的问题进行更多说明，我可以提供代码示例。我试过了：

```
class MyException extends GrailsException { 
} 
```

它正在回滚此异常的事务

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:33:14.580

没有要求您将任何 Grails 异常子类化——将扩展`java.lang.Exception`或任何其他已检查异常作为您的基类。

# django - Django 使用 defer 进行注释仍然在 group by 中使用 defer 列名

> ID：12717334
> 
> 赞同：4
> 
> 时间：2012-10-03T21:42:55.100
> 
> 标签：django, group-by, annotate

在构建 sql 查询时，它看起来`annotate()`没有考虑`defer()`（或）。`only()`这是一个错误还是出于某种原因这样构建的？

模型：

```
class Item(models.Model):
    a_number = models.PositiveIntegerField()
    a_string = models.CharField(max_length=100)
    a_date = models.DateField() 
```

查询集：

```
Item.objects.defer(
    'a_number', 
    'a_date'
).filter(
    a_date__lte=datetime.date.today()
).annotate(
    number_sum=Sum('a_number')
).order_by("-number_sum") 
```

询问：

```
SELECT "app_item"."a_string", SUM("app_item"."a_number") AS "number_sum" 
FROM "app_item" 
WHERE "app_item"."a_date" <= 2012-10-03
GROUP BY "app_item"."id", "app_item"."a_number", "app_item"."a_date", "app_item"."a_string" ORDER BY "number_sum" DESC 
```

我期待：

```
SELECT "app_item"."a_string", SUM("app_item"."a_number") AS "number_sum" 
FROM "app_item" 
WHERE "app_item"."a_date" <= 2012-10-03
GROUP BY "app_item"."id", "app_item"."a_string" ORDER BY "number_sum" DESC 
```

我知道我可以使用`values()`，但我想要模型实例。

也许有一种简单的方法可以删除 group by 列，因为我仍然想删除 "app_item"."id" fom group by？

我现在将使用 raw 但如果有一个跨数据库解决方案会很好。

# php - php 变量 - 从功能到可用

> ID：12717345
> 
> 赞同：0
> 
> 时间：2012-10-03T21:43:49.323
> 
> 标签：php, function, variables

我有一个 PHP 函数，它执行以下操作，从 CSV 文件调用数据：

```
// Calculates the Net Present Value based on the WAL and payment stream.

function calculateNPVByWAL ($paymentRowArray, $debugMode, $isLow, &$maxdiff) {
// Calculate the WAL.
$currentWAL = calculateWAL ($paymentRowArray, $debugMode);
// Get the Low/High rate table.
$csvdata = csv_in_array ('rate_data.csv', ",", "\"", true);
// The current rate.
$currentRate = 0;
// The last line of the low/high rate table used.
$lastLineUsed = 0;

// Loop through the Low/Rate WAL table.
for ($i = 0; $i < count ($csvdata); $i++) {
    // The max diff.
    $maxdiff = $csvdata [$i]['MaxDiff'];

    if ($isLow) {
        if ($currentWAL >= $csvdata[$i]['WAL']) {
            // The WAL is higher the current rate table row.
            $currentRate = $csvdata [$i]['Low'];
            // Store the last line used.
            $lastLineUsed = $i;
            //Set the offer cost and the offer profit
            $offer_cost = 3000;
            $offer_profit = 3000;
            //Get the max difference
            $MaxDiff = $csvdata [$i]['MaxDiff'];
        }
    } else {
        if ($currentWAL >= $csvdata[$i]['WAL']) {
            // The WAL is higher the current rate table row.
            $currentRate = $csvdata [$i]['High'];
            // Store the last line used.
            $lastLineUsed = $i;
        }
    }
}

// Setup the NPV value array.
$npvValueArray = array();

// Loop through the payment stream.
for ($i = 0; $i < count ($paymentRowArray); $i++) {

    // Add the payment stream cash flow.
    $npvValueArray[] = $paymentRowArray[$i]->getCashFlow();
}

if ($debugMode) {

    echo '<table border="2">';
    echo '<tr><td><strong>WAL Bracket</strong></td>';
    echo '<td align="right">' . $lastLineUsed . '</td></tr>';
    echo '<tr><td><strong>Low/High</strong></td>';
    echo '<td align="right">' . ($isLow ? 'Low' : 'High') . '</td></tr>';
    echo '<tr><td><strong>Rate</strong></td>';
    echo '<td align="right">' . $currentRate . '</td></tr>';
    echo '<tr><td><strong>NPV</strong></td>';
    echo '<td align="right">' . round (npv (($currentRate / 12 / 100), $npvValueArray), 2) . '</td></tr>';
    $highvalue = round (npv (($currentRate / 12 / 100), $npvValueArray), 2);

    if ($isLow) {
        $lowvalue = (round (npv (($currentRate / 12 / 100), $npvValueArray), 2) - $offer_cost - $offer_profit);
        echo '<tr><td><strong>Cost of Funds</strong></td>';
        echo '<td align="right">' . $offer_cost . '</td></tr>';
        echo '<tr><td><strong>Profit</strong></td>';
        echo '<td align="right">' . $offer_profit . '</td></tr>';
        echo '<tr><td><strong>Adjusted NPV</strong></td>';
        echo '<td align="right">' . (round (npv (($currentRate / 12 / 100), $npvValueArray), 2) - $offer_cost - $offer_profit) . '</td></tr>';
        echo '<tr><td><strong>Max Difference</strong></td>';
        echo '<td align="right">' . $MaxDiff . '</td></tr>';
    }

    echo '</table><br/>';

} else {

}

// Return the Net Present Value.
return (round (npv (($currentRate / 12 / 100), $npvValueArray), -2));
//return ($maxdiff);

} 
```

然后我可以创建可以使用以下代码操作的变量：

```
$lowRate = calculateNPVByWAL ($paymentRowArray, $debugMode, TRUE, &$maxdiff);
echo 'The low rate value is $' . $lowRate .'<br>';
echo 'The maximum difference value is $' . $maxdiff .'<br>';
$adjlowRate = $lowRate - $offer_cost - $offer_profit;
echo 'The adjusted low rate value is $' . $adjlowRate .'<br>';
$highRate = calculateNPVByWAL ($paymentRowArray, $debugMode, FALSE);
echo 'The high rate value is $' . $highRate .'<br>';
$difference = $adjlowRate - $highRate;
echo 'The difference is $' . $difference .'<br>'; 
```

我的问题是 $maxdiff 变量没有调用正确的值。它似乎调用了 CSV 文件中最后一行的值。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:48:48.490

您在两个不同的地方分配给该变量，如下所示：

```
$maxdiff = $csvdata [$i]['MaxDiff']; 
```

这将分配当前行列的值`MaxDiff`。如果您正在寻找整个 CSV 的最大最大差异，则必须比较这些值。像这样的东西：

```
$realMaxDiff = 0;
if($maxdiff > $realMaxDiff) {
    $realMaxDiff = $maxdiff;
} 
```

*（您必须在定义后* 的某处添加它`$maxdiff`）。

* * *

**更新**- 所以上面不是你实际问题的解决方案

您通过对函数`$maxdiff` **的引用**传递，因此实际上在函数运行后，它的值将是最后一行的值（因为您在进入`for`循环后立即从函数内部重新分配。要解决这个问题，请不要t 通过引用传递，通过`&`从函数签名中删除：

```
function calculateNPVByWAL ($paymentRowArray, $debugMode, $isLow, $maxdiff) {
   // function body can stay the same
} 
```

# java - 当链接的实体名称不是从父实体名称派生时，如何使用 OneToOne 映射避免 NullPointerException？

> ID：12717352
> 
> 赞同：1
> 
> 时间：2012-10-03T21:44:15.430
> 
> 标签：java, hibernate, nullpointerexception, one-to-one

这个问题与我在这个问题上遇到的问题有关，但不完全相同：

[如何避免 NullPointerException 与父实体类的 OneToOne 映射？](https://stackoverflow.com/questions/12683026/)

如果我像这样指定我的映射，则创建 OneToOne 映射似乎可以正常工作：

```
Person + PersonPartDeux
  |
  +--User 
```

但是，如果我在以下位置更改辅助实体的名称，它将不起作用`OneToOne`：

```
Person + DersonPartDeux (note the D)
  |
  +--User 
```

在这种情况下，我收到一个错误：

```
java.lang.NullPointerException
    at org.hibernate.cfg.OneToOneSecondPass.doSecondPass(OneToOneSecondPass.java:135) 
```

我为本示例选择的名称非常糟糕，但我的原始代码中的虚假名称较少，`OneToOne`映射到与原始实体完全不同的名称。

我调试了 Hibernate-Annotations 源，我看到它`personPartDeux`被正确映射为属性（在 中`OneToOneSecondPass.java`），但如果实体/属性名称为`dersonPartDeux`.

**这个属性没有被映射的原因是什么？**

**有没有办法覆盖这种行为（例如，在其中一个注释中指定连接列名称或实体名称）？**

我正在使用 Hibernate 3.2.4.sp1 和 Hibernate Annotations 3.2.1.GA，现在无法升级。

这是有效的代码：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class Person implements Serializable
{
    @Id
    @GeneratedValue
    public Long id;

    @Version
    public int version = 0;

    public String name;

    @OneToOne(cascade = CascadeType.ALL)
    @PrimaryKeyJoinColumn
    public PersonPartDeux personPartDeux;
}

@Entity
public class PersonPartDeux implements Serializable
{
    @Id
    @GeneratedValue(generator = "person-primarykey")
    @GenericGenerator(
        name = "person-primarykey",
        strategy = "foreign",
        parameters = @Parameter(name = "property", value = "person")
    )
    public Long id = null;

    @Version
    public int version = 0;

    @OneToOne(optional=false, mappedBy="personPartDeux")
    public Person person;

    public String someText;
}

@Entity
@PrimaryKeyJoinColumn(name = "person_Id")
public class User extends Person
{
    public String username;
    public String password;
} 
```

如果我替换这两个类，我会得到`NullPointerException`上面引用的 I：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class Person implements Serializable
{
    @Id
    @GeneratedValue
    public Long id;

    @Version
    public int version = 0;

    public String name;

    @OneToOne(cascade = CascadeType.ALL)
    @PrimaryKeyJoinColumn
    public DersonPartDeux dersonPartDeux; // Note D in entity/field name
}

@Entity
public class DersonPartDeux implements Serializable
{
    @Id
    @GeneratedValue(generator = "person-primarykey")
    @GenericGenerator(
        name = "person-primarykey",
        strategy = "foreign",
        parameters = @Parameter(name = "property", value = "person")
    )
    public Long id = null;

    @Version
    public int version = 0;

    @OneToOne(optional=false, mappedBy="dersonPartDeux") // Note the d in the property name
    public Person person;

    public String someText;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T04:58:09.047

在您的项目环境中，您是否需要在 ? 中列出实体类`persistence.xml`？也许您忘记更改`<class>`元素的名称。

# google-sites - 如何让锚点在谷歌网站 HTML 中工作

> ID：12717354
> 
> 赞同：0
> 
> 时间：2012-10-03T21:44:22.687
> 
> 标签：google-sites

我试图让 HTML 锚在我的谷歌网站上工作，但这让我大吃一惊：

*   我可以让 HTML + CSS（加上 JS）与 HTMLBox 小工具一起工作，**但是**如果我的代码上有锚，小工具会重写东西并且锚不再起作用。
*   我可以让 HTML 锚点工作（通过直接编辑页面的 HTML 代码）**但**我不能保留类、id 和 CSS 定义（不是内联），因为谷歌禁止它（并清理它）。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T06:46:57.923

我终于找到了一个解决方案：不使用谷歌网站，而是嵌入（通过 iframe，是的！）我需要疯狂的东西的页面，比如 CSS 和锚点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:12:11.187

你在谈论锚标签吗？

Google 协作平台的常规 HTML 编辑器确实去掉了 CSS 类和 JS。如果您尝试使用带有 ID 和类名的锚点以及内置在 CSS 规则中的规则，那么它将不起作用 - 一切都必须内联。

至于HTML Box，我不知道你的代码是什么样的评论。如果您尝试使用锚标记跳转到页面上的文本，它将不起作用，因为标记 id 将被剥离并且字符在 HTML Box 中是随机的。

除了将 HTML 放在常规文本编辑器框中，使用内联 CSS，然后从菜单中插入目录小部件之外，我知道没有其他选择。希望这可以帮助。

# jquery - 花式框从无序列表中的一个列表项弹出 HTML 页面

> ID：12717357
> 
> 赞同：-1
> 
> 时间：2012-10-03T21:44:32.290
> 
> 标签：jquery, popup, fancybox, html-lists

我有一个无序列表：

```
<ul>
    <li><a id="fancy_popup" href="popup.html" class="fancybox">
        Popup HTML Link</a></li>
    <li><a href="other.html">Other HTML Link</a></li>
    <li><a href="other.html">Other HTML Link</a></li>
</ul> 
```

我有一个 jQuery 脚本：

```
<script type="text/javascript">
$(document).ready(function() {
    $("#fancy_popup").fancybox({
        transitionIn    : 'elastic',
        transitionOut   : 'elastic',
        easingIn        : 'easeInSine',
        easingOut       : 'easeOutSine',
        speedIn         : 400,
        speedOut        : 200,
        titlePosition   : 'inside', 
        titleFormat     : 'document.write("Fancy Box Title");',
        cyclic          : true
    });
});
</script> 
```

这个 jQuery Fancy Box 脚本可以在其他地方使用`div`，`id="fancy_popup"`所以我想为什么不在这种情况下直接将它添加到锚点......我试图弄清楚如何应用 Fancy Box 以便当有人点击弹出 HTML 时上面的链接，根据脚本会弹出一个 Fancy Box 窗口。

我尝试了将, 放在 上`id`并为这些选择器操作脚本的变体，但无济于事。任何帮助表示赞赏。`li``ul`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T03:34:49.550

将fancybox绑定到锚点`<a>`是使用它的正常（和最佳）方式，所以这个

```
<a id="fancy_popup" href="popup.html" class="fancybox">Popup HTML Link</a> 
```

……完全没问题。

现在，由于您正在打开一个外部页面 ( `popup.html`)，您可能需要将内容类型设置为`iframe`... 并最终分配一些维度，因此请尝试

```
<script type="text/javascript">
$(document).ready(function() {
    $("#fancy_popup").fancybox({
        transitionIn    : 'elastic',
        transitionOut   : 'elastic',
        easingIn        : 'easeInSine',
        easingOut       : 'easeOutSine',
        speedIn         : 400,
        speedOut        : 200,
        titlePosition   : 'inside', 
        titleFormat     : 'document.write("Fancy Box Title");',
        cyclic          : true,
        type            : "iframe",
        width           : 640, // or whatever
        height          : 320
    });
});
</script> 
```

另一方面，考虑到您可能也想在fancybox中打开其他html文件，然后使用类而不是ID并将相同的类添加到所有锚点，所以

```
<li><a class="fancy_popup" href="popup.html">Popup HTML Link</a></li>
<li><a class="fancy_popup" href="other.html">Other HTML Link</a></li>
<li><a class="fancy_popup" href="other.html">Other HTML Link</a></li> 
```

并更改您的 jQuery 代码中的选择器，例如

```
$(".fancy_popup").fancybox( ..... ) 
```

因此您可以对多个元素使用相同的脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T11:00:39.043

**代码**

```
<ul>
    <li><a id="fancy_popup" href="popup.html" class="fancybox">Popup HTML Link</a></li>
    <li><a href="other.html">Other HTML Link</a></li>
    <li><a href="other.html">Other HTML Link</a></li>
</ul> 
```

**查询代码**

```
<script type="text/javascript">
$(document).ready(function() {
    $("#fancy_popup").click(function(){
    $(this).fancybox({
        transitionIn    : 'elastic',
        transitionOut   : 'elastic',
        easingIn        : 'easeInSine',
        easingOut       : 'easeOutSine',
        speedIn         : 400,
        speedOut        : 200,
        titlePosition   : 'inside', 
        titleFormat     : 'document.write("Fancy Box Title");',
        cyclic          : true
        });
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:06:00.597

首先，让我感谢上面的答案，因为他们真的帮助我更好地理解了这个该死的 FancyBox 是如何工作的。我知道它必须以某种方式起作用，所以我在这种情况下所做的就是回到基础并使用简单的画廊方法。

我还在这里阅读了其他帖子，即：

[无法显示 fancybox 助手按钮](https://stackoverflow.com/questions/9949496/cant-get-fancybox-helper-buttons-to-show)

和

[fancybox - d.onCleanup 不是一个函数](https://stackoverflow.com/questions/4468348/fancybox-d-oncleanup-is-not-a-function)

并意识到我没有在正确的位置包含 CSS 文件。愚蠢的错误，实际上。在这种情况下，我创建了几个不同的文件，并且我将 CSS 包含在文件链中的错误文件中，我的大脑告诉我它已被处理，但事实并非如此。

再次感谢！

# javascript - 如何两次附加相同的变量？

> ID：12717360
> 
> 赞同：2
> 
> 时间：2012-10-03T21:44:48.030
> 
> 标签：javascript, jquery

我试图两次附加相同的变量，但似乎代码只适用于第二个。

```
var test=document.createElement('option');               
test.innerHTML='some data';

      $('#data1').append(test);
      $('#data2').append(test); 
```

我想在不创建另一个变量的情况下两次附加变量测试。非常感谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T21:46:48.957

尝试像下面一样放入相同的选择器，

**演示**：http: [//jsfiddle.net/mrMva/](http://jsfiddle.net/mrMva/)

```
$('#data1, #data2').append(test); 
```

正如[**Felix**](https://stackoverflow.com/questions/12717360/how-to-append-the-same-variable-twice#comment17173514_12717380)从 jQuery 文档中指出的那样[。**附加**](http://api.jquery.com/append/)

> *但是，如果有多个目标元素，则会为第一个目标之后的每个目标创建插入元素的克隆副本。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T21:46:11.623

克隆它：

```
 $('#data1').append(test);
  $('#data2').append(test.cloneNode(true)); 
```

* * *

或者只是这样做，jQuery 会为你克隆它：

```
$('#data1, #data2').append(test); 
```

或者像这样：

```
$("<option>some data</option>").appendTo('#data1, #data2'); 
```

# java - 插座未连接

> ID：12717362
> 
> 赞同：0
> 
> 时间：2012-10-03T21:44:59.240
> 
> 标签：java, sockets, networking, network-programming, nullpointerexception

我的问题如下：我有以下客户端类：

```
import java.io.IOException;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.Scanner;

public class Client {

    public final int portNumber = 6040;
    public Socket socket;
    private PrintWriter pw;
    /**
     * @param args
     * @throws IOException 
     */
    public void connect() throws IOException{

        // du kan vælge at bruge inetadressen til at connecte i socketet.
        InetAddress adr = InetAddress.getByName("localhost");
        socket = new Socket("localhost", portNumber);
        pw = new PrintWriter(socket.getOutputStream());
        pw.println("Connected waiting for input");
        pw.flush();

    }
    /**
     * This method sends the message (that the client(chat person) writes to the user)
     * @param x
     * @throws NullPointerException
     * @throws IOException 
     */
    public void SendChat(String x) throws NullPointerException{
            pw.print(x);
            pw.flush(); 

    }
    public int sendCommando(int id) throws IOException{

         PrintWriter pw = new PrintWriter(socket.getOutputStream());
        pw.print(id);

        /*
         * this part of the program sends a command to the server if the command is 1 then 1 is = Connect.
         * the program then ask the server is the server is full or is it ok to connect? 
         * if the response is not 10 then the program will allow a connection to happen the return type will be the Id of which 
         * the chat person becomes!
         */

        // should the method return 0 the Application will do NOTHING!
        switch (id) {
        case 1:
    int k = reciveCommando();
            if (k== 10) {
                return 10;
            }else if (k<= 3) {
                return k;
            }else {

            return 10;
            }
            /*
             * Closes the connection with the server!
             */
        case 3:

            socket.close();
            return 0;

        default:
            return 0;
        }

    }
    /*
     * this method recives a command from the server! the comands can be found in the ChatCommands.txt
     * returns the command as an integer!
     */
    public int reciveCommando() throws IOException{
        Scanner commandoFromServer = new Scanner(socket.getInputStream());
        Integer i = Integer.parseInt(commandoFromServer.nextLine());
        return i;
    }
    /**
     * Gets a String response from the server. This method i used to create other users and give them the correct username.
     * 
     * @param i
     * @return
     * @throws IOException
     */
    public String getStringResponse(int i) throws IOException {
        pw.print(i);
        pw.flush();
        Scanner commandFromServer = new Scanner(socket.getInputStream());
        String x = commandFromServer.nextLine();
        return x;

    }

} 
```

除此之外，我有一个用作“主”类的 GUI。

我有一个名为 SocketTest v3.0.0 的程序（如果你们中有人知道的话），它的基本作用是为我创建一个我可以连接的服务器。

现在我的程序运行并连接到服务器！但是当我尝试在我的客户端程序（除了连接）中调用方法 sendCommand 或 sendChat 或任何其他方法时，它会给我一个空指针执行。

我已将问题缩小到当我声明套接字时套接字为空我该如何解决这个问题？因为我无法在我的公共类下初始化套接字！

我希望你明白我的意思，如果没有，请回复，我会详细说明！

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:40:34.137

“sendCommandO”创建自己的打印器而不是使用全局打印器似乎很奇怪。让两台印刷机输入同一个数据流肯定是在自找麻烦。“connect”立即发送“connected...”似乎也很奇怪

一般来说，这个程序的这种结构是行不通的，因为你的写作会阻塞并且在读者读完之前无法解除阻塞。它似乎适用于少量数据。读取和写入必须在单独的线程中完成。

这些都不是你的直接问题，但我建议完全重写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T23:42:26.640

在套接字的生命周期内，您必须使用相同的流、扫描仪等。不要在每次想要进行 I/O 时都创建新的。否则，您将丢失缓冲区中的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T00:14:42.417

首先感谢你们所有的帮助和回复，这就是我的代码工作的原因：

1.  清理代码以确保每个只创建 1 个，并且这些是在客户端连接到服务器时创建的

2.  为了确保我可以在所有方法中同时使用 PrintWriter 和 Scanner，我必须将字段设为静态

感谢您的所有帮助，我的客户端现在连接到服务器并能够来回发送消息！:)

完整的代码在这里：

```
 import java.io.IOException;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.util.Scanner;

public class Client {

    public final static int portNumber = 6040;
    public static Socket socket;
    private static PrintWriter pw;
    private static Scanner input;
    /**
     * @param args
     * @throws IOException 
     */
    public static void connect() throws IOException{

        // du kan vælge at bruge inetadressen til at connecte i socketet.
        InetAddress adr = InetAddress.getByName("localhost");
        socket = new Socket("localhost", portNumber);
        input=new Scanner(socket.getInputStream());
        pw = new PrintWriter(socket.getOutputStream());
        pw.println("Connected waiting for input");
        pw.flush();

    }
    /**
     * This method sends the message (that the client(chat person) writes to the user)
     * @param x
     * @throws NullPointerException
     * @throws IOException 
     */
    public void SendChat(String x) throws NullPointerException{
            pw.print(x);
            pw.flush(); 

    }
    public int sendCommando(int id) throws IOException{
        pw.print(id);
        pw.flush();
        /*
         * this part of the program sends a command to the server if the command is 1 then 1 is = Connect.
         * the program then ask the server is the server is full or is it ok to connect? 
         * if the response is not 10 then the program will allow a connection to happen the return type will be the Id of which 
         * the chat person becomes!
         */

        // should the method return 0 the Application will do NOTHING!
        switch (id) {
        case 1:
    int k = reciveCommando();
            if (k== 10) {
                return 10;
            }else if (k < 3) {
                System.out.println("returned k" + k);
                return k;
            }else {

            return 10;
            }
            /*
             * Closes the connection with the server!
             */
        case 3:

            socket.close();
            return 0;

        default:
            return 0;
        }

    }
    /*
     * this method recives a command from the server! the comands can be found in the ChatCommands.txt
     * returns the command as an integer!
     */
    public int reciveCommando() throws IOException{
        Integer i = input.nextInt();
        return i;
    }
    /**
     * Gets a String response from the server. This method i used to create other users and give them the correct username.
     * 
     * @param i
     * @return
     * @throws IOException
     */
    public String getStringResponse(int i) throws IOException {
        pw.print(i);
        pw.flush();
        String x = input.nextLine();
        return x;

    }

} 
```

# oracle - 如何从可能的编码列表中将 Oracle VARCHAR2 值转换为 UTF-8？

> ID：12717363
> 
> 赞同：11
> 
> 时间：2012-10-03T21:45:05.383
> 
> 标签：oracle, unicode, utf-8, character-encoding

由于遗留原因，我们在 Oracle 10 数据库中有一个 VARCHAR2 列（其中字符编码设置为），其中`AL32UTF8`包含一些非 UTF-8 值。这些值始终位于以下字符集中之一：

*   美国ASCII
*   UTF-8
*   CP1252
*   拉丁语-1

我编写了一个 Perl 函数来修复数据库外的损坏值。对于此数据库列中的值，它会遍历此编码列表并尝试将值转换为 UTF-8。如果转换失败，它会尝试下一个编码。第一个无误转换的是我们保留的值。现在，我想在数据库中复制此功能，以便任何人都可以使用它。

但是，我能找到的只是这个[`CONVERT`函数](http://docs.oracle.com/cd/B28359_01/server.111/b28286/functions027.htm)，它永远不会失败，但会为它无法识别的字符插入一个替换字符。因此，据我所知，无法知道转换何时失败。

因此，我有两个问题：

1.  是否有一些现有的接口试图将字符串转换为编码列表之一，返回第一个成功的？
2.  如果没有，如果它不能将字符串转换为编码，是否有其他接口指示失败？如果是这样，那么我可以编写前面的函数。

* * *

**更新：**

作为参考，我在 PL/pgSQL 中编写了这个 PostgreSQL 函数，它完全符合我的需要：

```
CREATE OR REPLACE FUNCTION encoding_utf8(
    bytea
) RETURNS TEXT LANGUAGE PLPGSQL STRICT IMMUTABLE AS $$
DECLARE
    encoding TEXT;
BEGIN
    FOREACH encoding IN ARRAY ARRAY[
        'UTF8',
        'WIN1252',
        'LATIN1'
    ] LOOP
        BEGIN
            RETURN convert_from($1, encoding);
        EXCEPTION WHEN character_not_in_repertoire OR untranslatable_character THEN
            CONTINUE;
        END;
    END LOOP;
END;
$$; 
```

我非常想知道如何在 Oracle 中做同样的事情。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T00:15:16.730

Thanks to the key information about the illegal characters in UTF-8 from @collapsar, as well as some digging by a co-worker, I've come up with this:

```
CREATE OR REPLACE FUNCTION reencode(string IN VARCHAR2) RETURN VARCHAR2
AS
    encoded VARCHAR2(32767);
    type  array_t IS varray(3) OF VARCHAR2(15);
    array array_t := array_t('AL32UTF8', 'WE8MSWIN1252', 'WE8ISO8859P1');
BEGIN
    FOR I IN 1..array.count LOOP
        encoded := CASE array(i)
            WHEN 'AL32UTF8' THEN string
            ELSE CONVERT(string, 'AL32UTF8', array(i))
        END;
        IF instr(
            rawtohex(
                utl_raw.cast_to_raw(
                    utl_i18n.raw_to_char(utl_raw.cast_to_raw(encoded), 'utf8')
                )
            ),
            'EFBFBD'
        ) = 0 THEN
            RETURN encoded;
        END IF;
    END LOOP;
    RAISE VALUE_ERROR;
END; 
```

Curiously, it never gets to WE8ISO8859P1: WE8MSWIN1252 converts every single one of the list of 800 or so bad values I have without complaint. The same is not true for my Perl or PostgreSQL implementations, where CP1252 fails for some values but ISO-8859-1 succeeds. Still, the values from Oracle seem adequate, and appear to be valid Unicode (tested by loading them into PostgreSQL), so I can't complain. This will be good enough to sanitize my data, I think.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T11:47:39.767

要检查您的数据库列是否包含无效的 utf-8，请使用以下查询：

```
 select CASE
            INSTR (
                  RAWTOHEX (
                      utl_raw.cast_to_raw (
                          utl_i18n.raw_to_char (
                                utl_raw.cast_to_raw ( <your_column> )
                              , 'utf8'
                          )
                      )
                  )
                , 'EFBFBD'
            )
        WHEN 0 THEN 'OK'
        ELSE 'FAIL' 
        END
   from <your_table>
      ; 
```

鉴于您的数据库字符集是 al32utf8。

请注意，这`EF BF BD`表示[utf-8 中的非法编码](https://stackoverflow.com/questions/7487144/grails-serve-html-files-as-utf-8)。

由于您指示的所有其他字符集都是面向字节的，因此转换为 unicode 永远不会失败，但可能会产生不同的代码点。如果没有上下文信息，就不可能自动确定实际的源字符集。

最好的问候，卡斯滕

ps：字符集的oracle名称： `CP1252`-> `WE8MSWIN1252` `LATIN-1`->`WE8ISO8859P1`

# internet-explorer - 如何从可插入协议处理程序中检测主页 url

> ID：12717365
> 
> 赞同：0
> 
> 时间：2012-10-03T21:45:20.683
> 
> 标签：internet-explorer

我正在自己的浏览器应用程序中实现一个[可插入的协议处理程序，以阻止广告。](http://msdn.microsoft.com/en-us/library/aa767916%28VS.85%29.aspx#About_Pluggable_Name)确切地说，它是一个命名空间处理程序。我可以轻松地从命名空间处理程序中获取正在下载的元素的 url。但我也想获取包含该元素的页面的 URL。我正在构建的浏览器应用程序在一个进程中托管了许多 Web 浏览器控件。目前，我不知道有什么方法可以判断是哪个 Web 浏览器控件发出了下载请求。

非常感谢您提供任何有助于解决问题的有用提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:19:08.550

在 iinternetprotocolroot start 中使用 GetBindString 将为您提供页面的 url。

```
pIBindInfo->GetBindString(BINDSTRING_URL, .., .., ..); 
```

# functional-programming - 方案中的循环和迭代。

> ID：12717366
> 
> 赞同：1
> 
> 时间：2012-10-03T21:45:25.207
> 
> 标签：functional-programming, scheme, racket

我正在为我的离散数学课复习一些问题，并阅读了一个引起我注意的练习（注意：这不是家庭作业。我只是好奇）。

问题：对于下面的程序段，“print”语句执行了多少次？（i, j, k, m 是整数）：

```
for i := 1 to 20 do
    for j := 1 to i do
        for k := 1 to j do
            for m := 1 to k do
                print (i * j) + (k * m) 
```

我尝试在 python 中完成它，但它很无聊，因为我在几秒钟内完成了它。因此，为了好玩，我尝试使用 DrRacket 使用方案作为语言来做到这一点。但是，在阅读有关循环的文档后，我似乎无法找到此类循环的参考。那么，使用这个具体的例子（或者我猜是一个具有无限数量循环的一般例子），如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T22:11:03.500

像这样的循环：

```
for i := 1 to 20 do
    for j := 1 to i do
        print [i, j] 
```

等效于 Racket 中的这个，假设一个看起来像这样的循环范围：`1 to 20`包括从 1 到（包括）20 的所有数字。

```
#lang racket

(for* ((i (in-range 1 21))
       (j (in-range 1 (add1 i))))
  (displayln (list i j))) 
```

请注意，上述不限于一个嵌套循环，您可以根据需要声明尽可能多的嵌套循环和迭代变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:08:48.160

麻省理工学院计划：

```
(do ((cnt 0) (i 1 (+ i 1))) ((> i 20) cnt)
   (do ((j 1 (+ 1 j))) ((> j i)) 
     (do ((k 1 (+ 1 k))) ((> k j))
       (do ((m 1 (+ 1 m))) ((> m k)) 
         (set! cnt (+ 1 cnt))))))
;Value: 8855 
```

[`do`在 R5RS 中](http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_sec_4.2.4)。

但这实际上是一个数学问题，而不是编程问题。

# mysql - Mysql：通过选择每第 n 行需要帮助

> ID：12717372
> 
> 赞同：0
> 
> 时间：2012-10-03T21:45:54.837
> 
> 标签：mysql, select, rows

我正在寻找一种方法来选择id以fe“4”结尾的每一行。搜索结果应仅包含以下行“4,14,24,34,44,54,64 等...”

这在MYSQL中可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T21:47:44.463

```
select * from thetable where id like "%4"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:00:24.957

```
select * from tablename where id regexp '4$' 
```

# php - 如何在将页面提供给浏览器之前导出 cytoscape 网络图

> ID：12717376
> 
> 赞同：1
> 
> 时间：2012-10-03T21:46:20.127
> 
> 标签：php, javascript, cytoscape-web

**场景：** 客户在带有搜索栏的页面上，他们输入查询。该查询被传递到服务器使用 php 动态生成的第二个页面。除了提供给 php 脚本的查询信息之外，还传递了一个变量，该变量允许 php 脚本确定客户端浏览器是否可以使用 flash。现在，如果 flash 不可用，php 脚本将显示由 cytoscape web 生成的网络图的 png，如果 flash 可用，则显示该图的 swf。

**问题/问题：** 1.) Cytoscape web 是一个用于显示图形的 javascript 库。它具有导出功能（http://cytoscapeweb.cytoscape.org/documentation#section/exportNetwork），但仅允许浏览器下载导出的文件。我希望能够在 php 运行时导出并保存此文件，然后如果未启用闪存，则将其作为内容嵌入以代替 swf。如果必须在客户端的浏览器中运行 javascript 方法，我将如何执行此操作？

**资源**

*图导出方法一：* [http ://cytoscapeweb.cytoscape.org/documentation#section/png](http://cytoscapeweb.cytoscape.org/documentation#section/png)

*图导出方法二：* [http ://cytoscapeweb.cytoscape.org/documentation#section/exportNetwork](http://cytoscapeweb.cytoscape.org/documentation#section/exportNetwork)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:14:46.737

在 cytoscape web google groups 页面上提出了类似的问题。
[这是问题和答案的链接](https://groups.google.com/forum/?fromgroups=#!topic/cytoscapeweb-discuss/_GiBJAC0Gc8)

以下是所说的：

如果使用 png()，则只能将图像的字节作为字符串（如 Base64）。它不会将图像导出到服务器端，也不会使其可供下载。为此，您必须自己将字符串提交到服务器端，再次将 base64 转换为字节，然后让服务器组件（例如 PHP、Java Servlet）将字节流回浏览器，以便用户下载图片。

还可以选择使用 Flash 组件/插件来获取字节并使其无需 Web 服务器即可下载。当您选择“保存文件”菜单选项时，这正是 Cytoscape Web 演示应用程序 (http://cytoscapeweb.cytoscape.org/demo) 所做的。您可以从演示的 JavaScript 文件中复制示例并使用我们为此开发的 Flash 库。它没有很好的记录，所以我想它可能有点复杂。无论如何，如果您想尝试一下，请看一下：

```
- http://cytoscapeweb.cytoscape.org/js/content/demo.js - search for "org.cytoscapeweb.demo.Exporter"
- http://chianti.ucsd.edu/svn/cytoscapeweb/trunk/file/ - you can download the component project from Subversion with the command:  svn checkout http://chianti.ucsd.edu/svn/cytoscapeweb/trunk/file cwfile-read-only 
```

如果您搜索互联网，您可能会找到类似的插件。

请记住，在调用 vis.draw() 之前，必须从 ready() 函数内部调用 png() 函数 - 例如：

```
vis.ready(function() {
    var png = vis.png();
// handle the png bytes here:
    alert(png);
});
vis.draw(draw_options); 
```

一个更简单的选择是使用 exportNetwork() 函数，它需要一个服务器端部分。见[http://cytoscapeweb.cytoscape.org/documentation/cytoscape_web#section/exportNetwork](http://cytoscapeweb.cytoscape.org/documentation/cytoscape_web#section/exportNetwork)；它甚至包括一个 PHP 示例。JavaScript 部分将是这样的：

```
vis.ready(function() {
    // ...
vis.exportNetwork('png', 'export.php?type=png');
    // ...
}); 
```

输出文件的名称由服务器端代码完成——本例中的“export.php”文件。

我希望这会有所帮助

# javascript - 我可以检查什么以确保 angular 已完成加载并且可以使用

> ID：12717387
> 
> 赞同：1
> 
> 时间：2012-10-03T21:47:15.190
> 
> 标签：javascript, angularjs

我正在开发一个我们需要动态加载（不要问）angular.js 和我们的 js 文件（directives.js、controllers.js 等）的应用程序。我`<script>`在 DOM 中插入了 Angular 和我们的 js 文件的标签，发现当你这样做时，脚本文件是异步加载的。`angular`由于较大的 angular.js 文件尚未返回，因此我收到有关未定义的错误。

无论如何知道角度何时加载并准备好使用？我的第一个想法就是看看是否`angular`已定义，例如`typeof angular != 'undefined'`. 但是，我担心 angular 将被定义，但尚未完全设置，我会遇到其他错误。此检查是否足以开始添加模块和使用`angular`对象？或者我可以检查对象本身的某些东西以确保它已完成设置？

作为旁注，我将手动引导应用程序，因此检查引导后设置的内容对我不起作用。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:59:23.570

如果您使用的是 jQuery，您可以链式加载各种外部脚本文件：

```
$.getScript('js/angular.js', function() {
    $.getScript('js/controllers.js', function() {
        $.getScript('js/next.js', function() {
            // [...]
        });
    });
}); 
```

更多信息：[http ://api.jquery.com/jQuery.getScript/](http://api.jquery.com/jQuery.getScript/)

当然，潜在的缺点是，如果一个脚本加载失败（ajax 问题，服务器负载高，等等），将不会触发成功回调，也不会加载后续脚本。

# c++ - 使用与 c++ D'tor 重叠的 I/O 冲突

> ID：12717388
> 
> 赞同：1
> 
> 时间：2012-10-03T21:47:20.937
> 
> 标签：c++, windows, winapi, overlapped-io

我正在编写一个单客户端（目前）服务器，该服务器具有一个主循环，可以中断客户端请求，并分配一个适当的处理程序。

对于某些任务，我想使用 MS 重叠 I/O（仅适用于 Windows）。在其中一个中，我想从文件中读取并将内容写入套接字。因为我有该动作的类包装，它分配一个缓冲区，文件的大小，然后调用 ReadFile （带有实际的文件系统文件），然后是一个 WriteFile （这次是一个套接字句柄) 两者都被重叠了。

问题是：因为它是异步的，所以会自动调用 d'tor 类，并且在工作完成之前释放文件的缓冲区，

显然，这是我的一个坏设计，我真的很想听听你的建议，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:03:33.043

查看文档，您似乎想`GetOverlappedResult`在`bWait`设置时调用。这将阻塞，直到重叠操作完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T09:44:04.483

谢谢大家，

看起来我错过了一些东西，因为使用另一个线程进行检查，或者只是等待完成，似乎失去了异步 IO 的好处。

我想我要找的是MS计划开发人员使用的使用方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:04:47.037

您可以在异步函数和析构函数内使用互斥锁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T23:24:18.153

可以创建一个在后台工作的线程来验证文件 IO 是否仍然需要完成并保持文件的类打开（即使它只是一个继续等待的循环）。这样，套接字就可以做它需要做的事情，并且 IO 可以不断地（通过你在类的成员变量中设置的标志）来通知它的状态。

然后在析构函数中，检查它是否已解锁并准备好，否则会出现另一个停滞循环。

# ios - iOS 的 NSPathControl 等效项

> ID：12717389
> 
> 赞同：0
> 
> 时间：2012-10-03T21:47:21.950
> 
> 标签：ios, cocoa, nspathcontrol

iOS (iPhone/iPad) 上是否有像 OSX 中的 NSPathControl 一样工作的控件？（要动态地将节点添加到事件的根，可以返回，删除事件的节点......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T11:36:24.400

从来没听说过。不过，自己实现一个应该不会太难。您可以在自定义 UIView 中使用标准 UIButton。

# android - 如何使用 navigateToURL 打开 Adob e AIr 的共享意图对话框

> ID：12717391
> 
> 赞同：1
> 
> 时间：2012-10-03T21:47:34.557
> 
> 标签：android, android-intent, air, adobe, navigatetourl

```
intent:#Intent;action=android.intent.action.SEND;type=text/plain;launchFlags=0x1;S.android.intent.extra.TEXT="+encodeURIComponent(socialShareEvent.message)+";S.android.intent.extra.SUBJECT="+encodeURIComponent(socialShareEvent.subject)+";end 
```

引发文档不支持的错误！？

# php - 可以从php中的数组动态定义类默认公共变量吗？

> ID：12717399
> 
> 赞同：4
> 
> 时间：2012-10-03T21:48:14.587
> 
> 标签：php, class, properties, mutators

我有一个事件类，用于将数据插入/更新到我的数据库中。有没有办法可以从我的 db_fields 数组创建公共变量，这样我就不必复制数据了？

这是我目前有效的结构......

```
class event{
    protected static $table_name='tName';
    protected static $db_fields = array('field1','field2','field3','field4','field5');

    public $field1;
    public $field2;
    public $field3;
    public $field4;
    public $field5;
} 
```

我想要这样的东西。。

```
class event{
    protected static $table_name='tName';
    protected static $db_fields = array('field1','field2','field3','field4','field5');

    function __construct() {
        create_public_vars_here($db_fields);
    }

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:52:06.037

您可以尝试以下方法：

```
class event{

    protected static $table_name='tName';
    protected static $db_fields = array('field1','field2','field3','field4','field5');

    function __construct() {
        foreach (self::$db_fields as $var) {
            $this->$var = $whateverDefaultValue;
        }
        // After the foreach loop, you'll have a bunch of properties of this object with the variable names being the string values of the $db_fiels.
        // For example, you'll have $field1, $field2, etc and they will be loaded with the value $whateverDefaultValue (probably want to set it to null).
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:04:52.193

您可以使用魔法设置器/获取器：

```
class event{

    protected static $table_name='tName';
    protected static $db_fields = array('field1','field2','field3','field4','field5');

    public function __get($key)
    {

        if(!in_array($key, static::$db_fields))
            throw new Exception( $key . " doesn't exist.");

        return $this -> $key;

    }

    public function __set($key, $value)
    {

        if(!in_array($key, static::$db_fields))
            throw new Exception( $key . " doesn't exist.");

        $this -> $key = $value;

    }   

} 
```

这样您就可以确保不会点击列表之外的值：

```
$event -> field1 = 'hello';  // --> OK
$event -> field17 = 'hello'; // --> Exception: field17 doesn't exist

echo $event -> field1;  // --> OK
echo $event -> field17; // --> Exception: field17 doesn't exist 
```

至于在你的代码中有一个显式的公共变量声明，你不需要迭代你的对象——但在这种情况下，你将[`Iterator`](http://php.net/manual/en/class.iterator.php)基于你的静态字段实现接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:50:23.023

使用突变器：

```
class event{
  protected static $table_name='tName';
  protected static $db_fields = array('field1','field2','field3','field4','field5');

  function getVars($var) {
    if(!in_arrary($this->db_fields[$var])) {
      return false;
    } else {
      return $this->db_fields[$var];
    }
  }
} 
```

然后你可以像这样访问它：

```
$eventObject->getVars('field3'); 
```

或者，如果您不从类中创建对象：

```
event::getVars('field3'); 
```

编辑：本着使事情复杂化的精神，这样您就不会违反边界，添加了代码。

# c# - 如何在 C# 中连接 AVT 孔雀鱼相机？

> ID：12717400
> 
> 赞同：1
> 
> 时间：2012-10-03T21:48:18.767
> 
> 标签：c#, camera, connect, avr, firewire

相机在 FireWire 总线上运行，AVT smartView 正在运行，但我找不到任何 c# 代码示例，如何使用相机。我尝试了 Emgu CV，但它不起作用。有人在使用 AVT 相机吗？任何建议如何开始？我只是初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T05:39:33.677

AVT 建议使用[**VIMBA SDK**](http://www.alliedvisiontec.com/apac/products/software/vimba-sdk.html)

完成安装后，您将`VimbaNET.dll`在已安装的文件夹中找到如下所示：

> C:\Programme\Allied Vision Technologies\AVTVimba_1.2\VimbaNET\Bin\Win32

在您的项目中使用它作为参考。这是一个 .NET 2.0 程序集，如果您使用更高的框架，您需要像这样更改 app.config 文件：

```
<configuration>
    <startup useLegacyV2RuntimeActivationPolicy="true">
        <supportedRuntime version="v4.0" sku=".NETFramework ,Version=v4.0" />
    </startup>
</configuration> 
```

列出所有可用 AVT 相机的示例：

```
string strName;
Vimba sys = new Vimba();
CameraCollection cameras = null;

try {
    sys.Startup();
    cameras = sys.Cameras;

    Console.WriteLine("Cameras found: " + cameras.Count);
    Console.WriteLine();

    foreach(Camera camera in cameras) {
        try {
            strName = camera.Name;
        } catch (VimbaException ve) {
            strName = ve.Message;
        }
        Console.WriteLine("/// Camera Name: " + strName);
    }
} finally {
    sys.Shutdown();
} 
```

有关更多示例，请查看文档中的

> C:\Programme\Allied Vision Technologies\AVTVimba_1.2\VimbaNET\Documentation 文件夹。

# linux - 命令“size -A core-file-name”的输出格式

> ID：12717407
> 
> 赞同：2
> 
> 时间：2012-10-03T21:49:17.457
> 
> 标签：linux

运行命令：

```
size -A "core_file" 
```

在核心转储（多线程程序）上显示多个部分`loadNNN`及其大小和地址。有没有办法使用这些信息来找出哪个线程分配了一个特定的部分，比如说`load101`？感谢你的帮助！

# wordpress - WP_Query - 按多个元值过滤并按其他元值排序

> ID：12717408
> 
> 赞同：1
> 
> 时间：2012-10-03T21:49:17.567
> 
> 标签：wordpress, sorting, meta-key

我正在尝试使用 WP_Query 和 meta_query 参数查询帖子：

```
$args = array(
    'post_type' => 'produkty',
    'meta_query' => array(
            'relation' => 'AND',
            array(
                    'key' => 'produkt_aktywny',
                    'value' => '1',
                    'compare' => '='),
            array(
                    'key' => 'produkt_dostepnosc',
                    'value' => '1',
                    'compare' => '=')
            )
);
$query = new WP_Query( $args ); 
```

我应该添加什么来通过其他两个键（'produkt_kategoria'和'produkt_cena'）对结果进行排序？WP Codex 中没有关于它的内容，但是：

```
"Do you know how to sort the query if the meta_value is an array? Write it here :)" 
```

据此，我相信按多个元值排序是可能的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-06-04T14:53:01.467

我想显示来自自定义帖子类型的帖子。按自定义字段对其进行排序，并在其他自定义字段为特定值的情况下添加一个参数，以仅显示选择的帖子。

例如。选择 custom_posts where custom_field_a=xxxx 并按 custom_field_b 排序

我花了一段时间才弄清楚，在搜索它时，我一直在这个帖子上磕磕绊绊。因此，对于所有遇到相同问题的人，这里是最终完成它的（简化的）代码。

```
 $args = array(
            'post_type' => 'my_custom_post_type',
            'meta_key' => 'custom_field_b',
            'orderby' => 'meta_value_num',
            'order' => 'DESC',
            'meta_query' => array(
                    array(
                        'key' => 'custom_field_a',
                        'value' => get_post_meta(get_the_ID(),'other_field',true),
                        'compare' => '='
                    )                   

                ),

        ); 
        $loop2 = new WP_Query($args); 
```

您会看到这是一个循环中的循环，因此该值是动态的。当然，这也可以是硬编码的。

希望它可以帮助某人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:42:48.250

我相信你必须在主 $arg 数组中使用'meta_key'。您可以按该元值排序，但我认为没有内置的按 2 个元值排序的方法。您可以按第二个字段（此处为标题）排序，而不是第二个元值字段（据我所知）。

```
$args = array(
    'post_type' => 'produkty',
    'meta_key' => 'produkt_kategoria',
    'orderby' => 'meta_value title',
    'meta_query' => array(
            'relation' => 'AND',
            array(
                    'key' => 'produkt_aktywny',
                    'value' => '1',
                    'compare' => '='),
            array(
                    'key' => 'produkt_dostepnosc',
                    'value' => '1',
                    'compare' => '=')
            )
); 
```

您可能需要编写一些 SQL。在此页面上向下滚动： [http ://wpquestions.com/question/show/id/1916](http://wpquestions.com/question/show/id/1916)

这也可能有帮助： [https ://wordpress.stackexchange.com/questions/10941/how-do-you-use-orderby-with-meta-query-in-wordpress-3-1](https://wordpress.stackexchange.com/questions/10941/how-do-you-use-orderby-with-meta-query-in-wordpress-3-1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T20:55:12.453

```
<h3>Doing request</h3>

    <?php
        $query = new WP_Query($args);
        unset($GLOBALS['wp_query']);
        $GLOBALS['wp_query'] = $query;
        ?>

<br />
<br />
<h3>Request done but without sorting, all we need from that request is difficult mysql query $query->request. Next lets get this,modificate and do again</h3>
Principle is simple: explode and add mysql string which is needed<br />

    <?php
//****************************************************************************************
    /* THIS IS REQUEST WHICH I WRITE BY HANDS TO ATCHIVE THAT I NEED. VERY USEFULL TO DO THIS BEFO PROGRAMMING!
     * 
     * SELECT wp_posts.ID FROM wp_posts 
     * INNER JOIN wp_postmeta ON (wp_posts.ID = wp_postmeta.post_id) 
     * INNER JOIN wp_postmeta featured ON (wp_posts.ID = featured.post_id) 
     * WHERE 1=1 
     * AND wp_posts.post_type = 'car' 
     * AND (wp_posts.post_status = 'publish') 
     * AND ( (wp_postmeta.meta_key = 'car_year' 
     * AND CAST(wp_postmeta.meta_value AS SIGNED) BETWEEN '1900' AND '2013') ) //DO NOT LOOK AT THIS, EXAMPLE
     * AND ( (featured.meta_key = 'car_is_featured') ) 
     * GROUP BY wp_posts.ID 
     * ORDER BY featured.meta_value ASC, wp_posts.post_modified_gmt DESC LIMIT 0, 20 
     */
//step 1
    $request = str_replace("SQL_CALC_FOUND_ROWS", "", $query->request); //remove unnecessary code
//step 2 - explode to insert mysql code for featured cars
    $tmp_request_array1 = explode('WHERE 1=1', $request);
    $tmp_request_array1[0].=" INNER JOIN $wpdb->postmeta featured ON ($wpdb->posts.ID = featured.post_id) ";
    $request = $tmp_request_array1[0] . " WHERE 1=1 " . $tmp_request_array1[1]; //assemble request again
//step 3 - explode assembled request to order by meta values
    $tmp_request_array1 = explode('ORDER BY', $request);
    $tmp_request_array2 = explode($order, $tmp_request_array1[1]);
    if ($orderby == 'post_modified_gmt') {
        $request = $tmp_request_array1[0] . ' ORDER BY ' . "featured.meta_value DESC, $wpdb->posts.post_modified_gmt $order" . $tmp_request_array2[1];
    } else {
        $request = $tmp_request_array1[0] . ' ORDER BY ' . "featured.meta_value DESC, $wpdb->postmeta.meta_value $order" . $tmp_request_array2[1];
    }
//step 4 - explode assembled request again to say that featured.meta_key is  =  'car_is_featured'
    $tmp_request_array1 = explode('GROUP BY', $request);
    $request = $tmp_request_array1[0] . " AND ( (featured.meta_key = 'car_is_featured') ) " . " GROUP BY " . $tmp_request_array1[1];
//**********************************************************
//step 5 - DO OUR NEW MYSQL REQUEST, AND GET CARS ORDER WE NEED
    $request_result = array();
    $tmp = $wpdb->get_results($request, ARRAY_N);
    foreach ($tmp as $value) {
        $request_result[] = $value[0];
    }
//***

    ?>

<br />
<br /> 
```

全文[阅读这里](http://pluginus.net/wp_query-filter-by-multiple-meta-values-and-order-by-other-meta-values/)

# php - for vs foreach - 引用数组元素

> ID：12717410
> 
> 赞同：0
> 
> 时间：2012-10-03T21:49:47.813
> 
> 标签：php, arrays, loops

我有一个数组，其中包含我必须处理的文件行，数组的每个元素都是文件的一行。处理后，我将文件内爆，写出来并使用它。

当我尝试使用`foreach`它时，它没有用。我怀疑它是在创建元素的副本，而不是直接引用元素，因此使用了`for`循环，它确实有效。

我的问题是，在这种情况下是否有某种方法可以使用`foreach`循环，或者在重新定义数组元素时必须始终使用`for`循环？

示例代码：

```
$fileArray = file('blah.txt');
foreach ($fileArray as $thisLine) {
    if ( condition ) {
        $thisLine = "changed state";
    }
}
$newFileArray = implode('',$fileArray); 
```

没用vs：

```
$fileArray = file('blah.txt');
for ($x=0;$x<count($fileArray);$x++) {
    if ( condition ) {
        $fileArray[$x] = "changed state";
    }
}
$newFileArray = implode('',$fileArray); 
```

效果很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:52:20.327

```
$fileArray = file('blah.txt');
foreach ($fileArray as $key => $thisLine) {
    if ( condition ) {
        $fileArray[$key] = "changed state";
    }
}
$newFileArray = implode('',$fileArray); 
```

或直接通过引用传递：

```
$fileArray = file('blah.txt');
foreach ($fileArray as &$thisLine) {
    if ( condition ) {
        $thisLine = "changed state";
    }
}
$newFileArray = implode('',$fileArray); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:52:53.683

在您的第一个示例中，您正在更改字符串的副本。 `$thisLine`不是对数组中元素的引用，而是数组元素的副本。

在您的第二个示例中，您正在直接更改数组。您可以使用 foreach，但前提是您返回引用数组：

```
foreach ($fileArray as $key => $thisLine) {
    if ( condition ) {
        $fileArray[$key] = "changed state";
    }
} 
```

# c# - 在 Int32 或 UInt32 中散列位的好方法是什么？

> ID：12717413
> 
> 赞同：6
> 
> 时间：2012-10-03T21:50:03.120
> 
> 标签：c#, bit-manipulation, prng

我有一个伪随机数生成器的实现，特别是 George Marsaglia 的 XOR-Shift RNG。我的实现在这里：

[FastRandom.cs](http://sharpneat.svn.sourceforge.net/svnroot/sharpneat/trunk/SharpNeatV2/src/SharpNeatLib/Utility/FastRandom.cs)

事实证明，第一个随机样本与种子非常密切相关，如果您看一下 Reinitialise(int seed) 方法，这一点相当明显。这是不好的。我提出的解决方案是将种子的部分混合如下：

```
_x = (uint)(  (seed * 2147483647) 
           ^ ((seed << 16 | seed >> 48) * 28111) 
           ^ ((seed << 32 | seed >> 32) * 69001)
           ^ ((seed << 48 | seed >> 16) * 45083)); 
```

因此，我通过将种子的位与四个素数相乘并异或返回形成_x，大大削弱了任何相关性。我还在乘法之前旋转种子的位，以确保不同大小的位在 32 位值的整个值范围内混合。

四向轮换似乎在什么都不做和所有可能的轮换之间取得了很好的平衡（32）。素数是“空中的手指”——足够大的量级和位结构来混淆这些位并将它们“传播”到完整的 32 位上，而不管起始种子如何。

我应该使用更大的素数吗？是否有解决这个问题的标准方法，也许有更正式的基础？我试图以最小的 CPU 开销来做到这一点。

谢谢

=== 更新 ===

我决定使用一些素数，其设置位更好地分布在所有 32 位上。结果是我可以省略移位，因为乘法可以达到相同的效果（在 32 位的整个范围内散列位），所以我只需将四个乘积相加即可得到最终的种子......

```
_x = (uint)(  (seed * 1431655781) 
            + (seed * 1183186591) 
            + (seed * 622729787)
            + (seed * 338294347)); 
```

我可能会用更少的素数/乘法来逃脱。两个似乎太少了（我仍然可以在第一个样本中看到模式），三个看起来还不错，所以为了安全起见，我把它变成了四个。

=== 更新 2 ===

仅供参考，上述简化为功能等效：

```
_x = seed * 3575866506U; 
```

我最初没有发现这一点，当我发现时，我想知道在计算的不同阶段溢出是否会导致不同的结果。我相信答案是否定的——这两种计算总是给出相同的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T21:02:41.837

根据一些研究人员的说法，[CrapWow](http://floodyberry.com/noncryptohashzoo/CrapWow.html)、[Crap8](http://floodyberry.com/noncryptohashzoo/Crap8.html)和[Murmur3](http://floodyberry.com/noncryptohashzoo/Murmur3.html)是当今可用的最好的非加密哈希算法，它们既快速、简单且统计良好。

更多信息可在[Non-Cryptographic Hash Function Zoo](http://floodyberry.com/noncryptohashzoo/)中获得。

**编辑：**截至 2021 年 5 月，floodberry.com 指向非加密哈希函数动物园的链接无效。内容仍然可以在[archive.org](https://web.archive.org/web/20150218184651/http://floodyberry.com/noncryptohashzoo/)上找到。

# objective-c - 如何使用 NSFileManager 替换文件或文件夹？

> ID：12717416
> 
> 赞同：2
> 
> 时间：2012-10-03T21:50:23.650
> 
> 标签：objective-c

使用 NSFileManager 的“copyItemAtPath”方法，如果存在相同的文件或文件夹，会发生错误。

NSFileManager 中是否有替换功能？

（如果存在相同的文件，删除并复制如果没有，只需复制。）

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self generateTableContents];

}

- (void)generateTableContents {

    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSArray *appsDirectory = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentPath = [appsDirectory objectAtIndex:0];

    [fileManager changeCurrentDirectoryPath:documentPath];
    [fileManager createDirectoryAtPath:@"user_List1" withIntermediateDirectories:YES attributes:nil error:nil];

    NSString *bundlePath = [[NSBundle mainBundle] resourcePath];

    NSError *error; // to hold the error details if things go wrong
    NSString *sourcePath = [[NSBundle mainBundle] pathForResource:@"IMG_0523" ofType:@"JPG"];

    if ([fileManager copyItemAtPath:sourcePath toPath: @"./user_List1/newIMG_0523.JPG" error:&error]) {
        NSLog(@"Copy complete!");
    } else {
        NSLog(@"Copy Failed : %@", error);
    }

    if ([fileManager copyItemAtPath:@"./user_List1" toPath: @"./user_List2" error:&error]) {
        NSLog(@"Copy complete!");
    } else {
        NSLog(@"Copy Failed : %@", error);
    }

} 
```

执行结果完成。

![在此处输入图像描述](../Images/e3f06480e1814fbe08d3f9cbdebb5aa9.png)

```
/Users/nice7285/Library/Caches/appCode10/DerivedData/tempPrg-dd15264d/Build/Products/Debug-iphonesimulator/tempPrg.app/tempPrg
Simulator session started with process 1184
2012-10-04 06:28:32.653 tempPrg[1184:11303] Copy complete!
2012-10-04 06:28:32.672 tempPrg[1184:11303] Copy complete!

Process finished with exit code 143 
```

但是当已经存在文件夹时。

![在此处输入图像描述](../Images/43bb63deb4be67d2566426d15ce94b60.png)

结果是失败。

```
2012-10-04 06:48:31.488 tempPrg[1243:11303] Copy Failed
2012-10-04 06:48:31.497 tempPrg[1243:11303] Copy Failed 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T22:06:45.303

您需要进行原子保存，例如：

```
NSData *myData = ...; //fetched from somewhere
[myData writeToFile:targetPath atomically:YES]; 
```

但是由于您使用的是 copyItemAtPath，所以我不知道是否可以原子地使用它，所以我只想进行快速肮脏的黑客攻击：

```
if ([fileManager fileExistsAtPath:txtPath] == YES) {
    [fileManager removeItemAtPath:txtPath error:&error]
}

NSString *resourcePath = [[NSBundle mainBundle] pathForResource:@"txtFile" ofType:@"txt"];
[fileManager copyItemAtPath:resourcePath toPath:txtPath error:&error]; 
```

来源：[IOS：在文档文件夹中复制文件](https://stackoverflow.com/questions/6545180/ios-copy-a-file-in-documents-folder)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-05T19:26:43.990

从 iOS 4（和 macOS 10.7）开始，有一种明确的方法可以将一个项目替换为另一个项目。它甚至保留原始文件的属性（可选）

```
- (BOOL)replaceItemAtURL:(NSURL *)originalItemURL withItemAtURL:(NSURL *)newItemURL backupItemName:(NSString *)backupItemName options:(NSFileManagerItemReplacementOptions)options resultingItemURL:(NSURL * _Nullable *)resultingURL error:(NSError * _Nullable *)error; 
```

> 以确保不会发生数据丢失的方式替换指定 URL 处的项目内容。

[replaceItemAtURL:withItemAtURL:backupItemName:options:resultingItemURL:error:](https://developer.apple.com/documentation/foundation/nsfilemanager/1412432-replaceitematurl?language=objc)

# rackspace-cloud - 在 Rackspace CloudFiles 中，我应该为每个用户上传创建一个容器吗？

> ID：12717417
> 
> 赞同：0
> 
> 时间：2012-10-03T21:50:35.987
> 
> 标签：rackspace-cloud, rackspace

只是想知道哪个更好：为每个用户创建一个不同的容器，还是只创建一个容器来上传与用户相关的所有内容？

在应用程序部分，我将需要列出用户拥有的每个文件，这就是为什么拥有不同的容器应该是一个好主意，但另一方面，拥有数千个不同的容器可能很糟糕，不确定。

所以你怎么看？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:18:57.977

无论哪种方式，你都可以做到。当然，轮询这么多容器需要一段时间，所以我建议使用 1 或 2 个容器。这样查询速度会更好。

# javascript - 将 MVC 模型与“contenteditable”属性混合——是否可以以简单的方式将数据发布回服务器？

> ID：12717420
> 
> 赞同：2
> 
> 时间：2012-10-03T21:51:01.420
> 
> 标签：javascript, jquery, asp.net-mvc

我不完全确定这是否可能。所以，如果你知道这不是我应该走的路，请指教！

我正在创建一个 MVC/jQuery Web 应用程序。我正在将模型加载到对话框中，允许用户编辑内容，然后我想将数据发布回服务器以进行保存。

我想我也可以利用 HTML5 的 'contenteditable' 属性。在使元素可编辑时，这似乎是删除加载闪光的好方法。

因此，我有这个：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<CableSolve.Web.Models.Orders.OrderDetailsModel>" %>

<fieldset class="collapsible">
    <legend>
        <%= Html.DisplayFor(model => model.OrderDetailsLegendName)%>
    </legend>
    <table id="OrderDetailsContentTable" class="ContentTable">
        <tr>
            <td><%= Html.DisplayFor(model => model.OrderID.Name)%></td>
            <td><div class="canBeEditable"><%= Html.DisplayFor(model => model.OrderID.Value)%></div></td>
        </tr>
    </table>
</fieldset> 
```

这个 ViewUserControl 被加载到一个 DOM 元素中，并且这些元素在客户端是可编辑的：

```
var workflowDialog = $('#WorkflowDialog');
var workflowDialogContent = $('#WorkflowDialogContent');
workflowDialogContent.load('../../csweb/Orders/OrderDetails/?orderID=' + orderID, function () {
    workflowDialog.find('.canBeEditable').attr('contenteditable', 'true');
} 
```

在这一点上，我希望能够将数据发布回服务器并利用 MVC，这样我就不必显式映射每个属性。

我以为我可以做类似的事情：

```
var dataToPost = workflowDialogContent.serialize();
console.log("Data:", dataToPost); 
```

但是，在查看[文档以进行序列化](http://api.jquery.com/serialize/)时，它似乎正在专门寻找表单元素（例如输入字段）。

我很好奇两件事：

*   我的设计理念的任何陷阱。
*   如何正确序列化我的字段，以便我可以正确地将其发回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T11:38:25.220

您可以使用 HTML5`data-*`属性为内容可编辑部分命名：

```
<div class="canBeEditable" data-name="<%= ViewData.TemplateInfo.GetFullHtmlFieldName("OrderID.Value") %>">
    <%= Html.DisplayFor(model => model.OrderID.Value) %>
</div> 
```

那么您可以使用[serializeObject](https://stackoverflow.com/a/1186309/29407)函数来准备要发布的数据：

```
var form = $('#myForm');
var dataToPost = form.serializeObject();
$('.canBeEditable').each(function() {
    dataToPost[$(this).data('name')] = $(this).val();
}); 
```

最后发布：

```
$.ajax({
    url: '...',
    type: 'POST',
    data: dataToPost,
    success: function(result) {

    }
}); 
```

# php - 从格式不正确的网页中抓取数据

> ID：12717421
> 
> 赞同：0
> 
> 时间：2012-10-03T21:51:05.550
> 
> 标签：php, curl, web-scraping

我正在尝试从网页中抓取数据。网页可以是任何页面。例如，我正在`http://www.google.com/`使用`curl`. 它给出了很多警告，却什么也没做。警告在第 30 行：

> 警告：SimpleXMLElement::__construct(): 在 C:\wamp\www\nbacurl\index.php

这个错误重复了好几次。

我听说过 simplehtmldom ，我下载了它，但不知道如何使用它。我有页面要解析，但我找不到出路。这是一个非常简单的代码，它不起作用。

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://www.google.com' );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$contents = curl_exec ($ch);

$xml = new SimpleXMLElement($contents);
echo '<pre>' , print_r($xml) , '</pre'>; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:56:22.823

不要尝试用`SimpleXMLElement`, 或者`DOMDocument`更适合 HTML 解析的其他解决方案来解析它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:02:38.533

也许尝试[ScriptableBrowser](http://www.lastcraft.com/browser_documentation.php)（用于 PHP）。我个人在 python 中使用 Mechanize 和 BeautifulSoup。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:28:10.170

使用`DOMDocument`and 或者`loadHTML`启用`loadXML`恢复。前者可能是你真正想要的。

```
<?php
$doc = new DOMDocument();
$doc->loadHTML($contents);

...
?> 
```

见：[http ://www.php.net/manual/en/class.domdocument.php#domdocument.props.recover](http://www.php.net/manual/en/class.domdocument.php#domdocument.props.recover)

```
<?php
$doc = new DOMDocument();
$doc->recover = TRUE;
$doc->loadXML($contents);

...
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T21:54:21.460

希望没有人会因为“无关紧要”而投反对票，但我使用[mechanize](http://wwwsearch.sourceforge.net/mechanize/)抓取网页并发现它非常直观和有效。用一个小api很容易学习。

我刚刚看到您使用的是 php 而不是 python。Mechanize 是一个 python/perl 库，所以在这里可能不相关。

# concurrency - hbase 并发写入一行

> ID：12717422
> 
> 赞同：1
> 
> 时间：2012-10-03T21:51:07.663
> 
> 标签：concurrency, hbase

我想知道 hbase-0.90.0 是否存在与多个客户端同时写入同一行相关的任何已知问题。在我的设置中，有超过 10 个节点写入同一个 HBase 表，有时（很少）我看到数据*没有*写入表，我记录了异常等，但我什么也没看到。一种可能性是多个节点一次写入同一行，我想知道这是否会导致这种行为。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:49:16.443

您使用的是什么版本的 Hadoop - 一些旧版本没有持久同步并且可能会丢失数据：

> HBase 将丢失数据，除非它在具有持久同步实现的 HDFS 上运行。Hadoop 0.20.2、Hadoop 0.20.203.0 和 Hadoop 0.20.204.0 没有此属性。目前只有 Hadoop 版本 0.20.205.x 或任何超过此版本的版本（包括 hadoop 1.0.0）具有有效的、持久的同步 [6]。必须通过在客户端（在 hbase-site.xml 中）和服务器端在 hdfs-site.xml 中设置 dfs.support.append 等于 true 来显式启用同步（HBase 需要的同步工具是一个子集附加代码路径）。

有关所有详细信息，请参见[此处](http://hbase.apache.org/book/hadoop.html)

# c - 如何在 Visual Studio 2010 for C 中使用 igraph（和其他库）？

> ID：12717423
> 
> 赞同：1
> 
> 时间：2012-10-03T21:51:15.427
> 
> 标签：c, visual-studio-2010, igraph

我最近刚开始使用 C 并且一直在编写一些基本的 C 代码，但是对于我应该如何在 Visual Studio 2010 中“安装”像 igraph 这样的库有点不知所措。我在这里下载了 igraph“Microsoft Visual Studio 的源代码”：[http://igraph.sourceforge.net/download.html](http://igraph.sourceforge.net/download.html)

（天真）**尝试**

有一个包含所有“.h”文件的“包含”文件夹，我将这些文件复制到我的 Visual Studio 设置为在我使用时查看的目录中，`include < something.h >`但我得到一个“未解析的外部符号”，我知道这意味着库未正确设置。

**问题**

我应该如何“安装” igraph？（可能还有其他 C 库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:56:33.243

查看你的图书馆的文件夹，我想你会在那里找到一个 .lib 文件。

转到您的项目设置并打开链接器设置。你应该在`Input`下面找到`additional dependencies`. 在那里添加您的 .lib 文件。您可能还需要将此 .lib 文件所在的文件夹添加到`library folders`（在 VC++ 文件夹下）。

我在这里有 MSVC 的德语版本，因此您的菜单条目可能会略有不同，但您会找到它们；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T12:53:35.693

马克的回答很有帮助，但还有其他问题。按照这些步骤为我解决了它。希望这将有助于将来的某人。

**第1步**

igraph 包是一堆“.c”和“.h”文件，在 Mark 的回答中缺少“.lib”文件。它必须在 Visual Studio 中打开并构建。然后，“.lib”文件将出现在“Debug”文件夹中。

**第2步**

执行马克答案中的步骤。

但是，在“VC++ 目录”中有一行调用“包含目录”，您必须在其中存储 igraph 包含目录的路径。这样 Visual Studio 可以在您编写时找到正确的文件，例如`#include <include/igraph.h>`.

**第 3 步**

如果您收到“...已经在 MSVCRTD.lib 中定义...”错误。然后，访问此答案：[如何解决 Visual Studio 中的以下链接器错误？](https://stackoverflow.com/questions/925540/how-to-resolve-the-following-linker-errors-in-visual-studio)

您正在使用的每个库/子项目都必须使用“C/C++ -> 代码生成 -> 运行时库”中的相同选项进行编译。

# html - HTML 标签标签在包含内容时在元素上方添加空格

> ID：12717424
> 
> 赞同：0
> 
> 时间：2012-10-03T21:51:21.017
> 
> 标签：html, css

我有一个表单元素列表。标签位于每个元素旁边。有些标签，有些有文字。它们在不同的浏览器中表现不同。

基本上发生的事情是具有文本的标签在列表项上方创建空白。表单比这复杂得多，但我把它归结为这个基本代码：http: [//jsfiddle.net/uZ2Et/](http://jsfiddle.net/uZ2Et/)

```
#cleanVersion li {
    display: inline-block;
    border: 1px solid gray;
    height: 200px;
    margin: 0;
    padding: 0;
}
#cleanVersion label {
    display: inline-block;
    font-size: 70px;
    background-color: blue;
    border: 0;
    margin: 0;
    padding: 0;
    width: 200px;
    height: 150px;
}
​

<div id="cleanVersion">
    <ul>
        <li><label>test</label></li>
        <li><label></label></li>
    </ul>
</div>​ 
```

我试过调整边距、边框、填充、行高......但标签仍然不一致。

如何摆脱出现在带有文本的列表项上方的空白？

编辑：这是一个更复杂的例子，更接近我实际在做的事情：http: [//jsfiddle.net/uZ2Et/6/](http://jsfiddle.net/uZ2Et/6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:53:02.837

`vertical-align: top;`在列表项上使用：http: [//jsfiddle.net/uZ2Et/1/](http://jsfiddle.net/uZ2Et/1/)

# oop - MATLAB - 为什么抱怨 @-folders for classdef'd 对象？

> ID：12717425
> 
> 赞同：6
> 
> 时间：2012-10-03T21:51:27.460
> 
> 标签：oop, matlab

我编写 OOP MATLAB 代码已经有一段时间了。但是，我现在是第一次在 Windows 机器上运行 MATLAB 代码。

我有以下代码：

```
classdef myClass < handle
    properties
        i
    end

    methods
        function obj = myClass()
            obj.i = 0;
        end

        function say(obj)
            obj.i = obj.i + 1;
            fprintf('This is time #%i you invoked me!\n', obj.i);
        end
    end
end 
```

看起来很无害。我尝试实例化一个对象，我得到了这个：

```
>> m = myClass;
Error using myClass
Error: File: myClass.m Line: 1 Column: 10
A class definition must be an "@" directory. 
```

在我编写 OOP MATLAB 代码的过程中，我从来没有使用过 @-folder。我的理解是，如果类方法与 classdef 文件分开编写（我的不是），或者它使用旧式 MATLAB 类语法（我的不是），则它是必需的。

我想我知道交易是什么，我想看看是否有解决方法：我的工作目录的形式是

```
C:\Users\DangKhoa@MyCompany.com\Documents\MATLAB 
```

这是否会导致`@`MATLAB 关闭并让计算机认为我在 @ 文件夹中？如果是，是否有解决方法（显然，除了在我的计算机上创建一个新用户 - 这可能是不可行的）？如果不是，那是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T15:20:20.980

看起来是的，`@`文件夹中间的 导致错误。我向 The MathWorks 提交了一份错误报告。

# jquery - 如何从示例中将 Jquery 终端用作控制台和 RPC 等 Quake

> ID：12717429
> 
> 赞同：2
> 
> 时间：2012-10-03T21:52:08.797
> 
> 标签：jquery, ajax, jquery-ui, jquery-terminal

我在这里使用 JQuery 终端：http: [//terminal.jcubic.pl/](http://terminal.jcubic.pl/)

我正在尝试创建一个控制台样式的终端（类似地震的控制台），如本页示例 2 中所述：http: [//terminal.jcubic.pl/examples.php](http://terminal.jcubic.pl/examples.php)

我还希望它回调 RPC 服务，如示例 1 中所列。

也许有比我更多的 JQuery 经验的人可以告诉我他们是否相信这样做是可能的？我正在尝试同时做这两件事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T08:55:01.513

您可以简单地将字符串作为 tilda 示例插件的第一个参数，也可以在 eval 函数中调用 RPC。

```
 $('#tilda').tilda('rpc-service.php', { <OPTIONS> }); 
```

tilda 的第一个参数被传递给内部执行的终端，因此您可以对 tilda 执行与终端相同的操作。

# java - 当我在 java 中将一个对象序列化为 XML 然后反序列化它时，我无法在预先存在的内容上使用我的函数。谁能解决这个问题？

> ID：12717433
> 
> 赞同：2
> 
> 时间：2012-10-03T21:52:48.873
> 
> 标签：java, serialization, xml-serialization, deserialization

这是我用于我的课程的代码。我已经测试了很多次，如果我不序列化和反序列化，这些功能都可以正常工作。

```
public class Library {

    private String libTitle;
    private Vector<Album> albums;

    public String getLibTitle() {
        return libTitle;
    }

    public void setLibTitle(String libTitle) {
        this.libTitle = libTitle;
}

public Vector<Album> getAlbums() {
    return albums;
}

public void setAlbums(Vector<Album> albums) {
    this.albums = albums;
}

public Library(){
}

public Library(String libTitle) {
    this.libTitle = libTitle;
    this.albums = new Vector<Album>();
    albums.trimToSize();

}

public void addAlbum(String album){
    boolean added = false;
    for (Album alb: this.getAlbums()){
        if (alb.getAlbum()==album){
            added=true;
        }
        if (added){
            break;
        }
    }
    if (!added){
        this.getAlbums().add(new Album(album));
        this.getAlbums().trimToSize();
    }
}

public void removeAlbum(String album){
    for (Album alb : this.getAlbums()){
        if (alb.getAlbum()==album){
            this.getAlbums().remove(alb);
            this.getAlbums().trimToSize();
            break;
        }
    }
}

public void addSong(String title, String author, String album){
    boolean added = false;
    for (Album alb : this.getAlbums()){
        if (alb.getAlbum()==album){
            alb.addSong(title,author);
            added=true;
        }
        if (added){
            break;
        }
    }
    if (!added){
        this.addAlbum(album);
        this.addSong(title, author, album);
    }
}

public void removeSong(String title, String author, String album){
    boolean removed = false;
    for (Album alb : this.getAlbums()){
        if (alb.getAlbum()==album){
            alb.removeSong(title);
            if(alb.getSongs().isEmpty()){
                this.getAlbums().remove(alb);
                this.getAlbums().trimToSize();
            };
            removed=true;
        }
        if (removed){
            break;
        }
    }       
}

public void save()
{
    try {
        FileOutputStream xmlos = new FileOutputStream(this.libTitle +".xml");
            XMLEncoder encoder = new XMLEncoder(xmlos);
        encoder.writeObject(this);
        encoder.close();
        xmlos.close();
        System.out.println("Done exporting a user as xml to "+this.libTitle+".xml");
    }catch(Exception e) {
        e.printStackTrace();
    }
}

public Library restore(String lib)
{
    Library newLib = null;
    try {
        System.out.println("Importing a user as xml from "+lib+".xml");
        FileInputStream inFileStream = new FileInputStream(lib +".xml");
        XMLDecoder decoder = new XMLDecoder(inFileStream);
        newLib = (Library)decoder.readObject();
        decoder.close();
        inFileStream.close();
        System.out.println("Libloaded "+ newLib.getLibTitle());
        return newLib;

    }catch(Exception e) {
        e.printStackTrace();
    }
    return newLib;

}

} 
```

接下来是相册类，在库类中使用

```
public class Album {

private String album;
private Vector<Song> songs;

public Vector<Song> getSongs() {
    return songs;
}

public void setSongs(Vector<Song> songs) {
    this.songs = songs;
}

public Album(){
}

public Album(String album) {
    this.album = album;
    this.songs = new Vector<Song>();
    songs.trimToSize();

}

public String getAlbum() {
    return album;
}

public void setAlbum(String album) {
    this.album = album;
}

public void addSong(String song, String author){
    boolean added = false;
    for (Song son : this.getSongs()){
        if (son.getTitle()==song){
            added=true;
        }
        if (added){
            break;
        }
    }
    if (!added){
        this.getSongs().add(new Song(song, author));
        this.getSongs().trimToSize();
    }
}

public void removeSong(String song){
    for (Song son : this.getSongs()){
        if (son.getTitle()==song){
            this.getSongs().remove(son);
            this.getSongs().trimToSize();
            break;
        }
    }

}

} 
```

之后是歌曲类。

```
public class Song {

private String title,author;

public Song(){
}

public Song(String title, String author) {
    this.title = title;
    this.author = author;
}

public String getTitle() {
    return title;
}

public void setTitle(String title) {
    this.title = title;
}

public String getAuthor() {
    return author;
}

public void setAuthor(String author) {
    this.author = author;
}
} 
```

所以基本上它是一个库，我正在序列化为 XML，然后反序列化我正在制作的应用程序。我的问题是当我运行以下代码时......

```
public class Run {

public static void main(String args[]){
    Library lib = new Library("MYLibrary");
    lib.addSong("Crawling", "Lincoln Park", "Hybrid Theory");
    lib.addSong("In The End", "Lincoln Park", "Hybrid Theory");
    lib.addSong("Fire", "Pyros", "Burning Up");
    lib.addSong("Ocean", "Drowners", "Burning Up");
    lib.save();
    Library lib2 = new Library();
    lib2 =lib2.restore("MYLibrary");
    lib2.setLibTitle("test");
    lib2.removeSong("In The End", "Lincoln Park", "Hybrid Theory");
    lib2.addSong("Crawling in the dark", "me", "Hybrid Theory");
    lib2.removeSong("Crawling in the dark", "me", "Hybrid Theory");
    lib2.removeSong("Ocean", "Drowners", "Burning Up");
    lib2.removeAlbum("Hybrid Theory");
    lib2.save();

}

} 
```

保存的 XML 文件不会只有一首歌曲，因为它应该生成的两个 XML 文件是相同的。我的老师不明白为什么它不起作用，我也不明白。为什么图书馆不改变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:58:47.177

您正在使用`==`not比较专辑和歌曲标题`.equals()`。如果对象被序列化和反序列化，这将不起作用，因为对象引用将发生变化。

更一般地说，在大多数情况下，您应该将字符串与`.equals()`非字符串进行比较。`==`例如：

```
new String("test") == "test" 
```

将评估为`false`。有关更多解释，请参阅[此问题](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)。

如果您的 Album 和 Song 类覆盖`.equals()`and`hashcode()`方法会更好，这样您就可以直接比较它们，而不必提取它们的标题并进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:43:43.133

所有具有字符串比较的方法都`==`用于代替`equals()`. `==`运算符比较对象实例。由于两个对象实例不相同，因此`false`在所有情况下都返回。更新方法以使用正确的比较方法，例如您的 removeAlbum 方法应更新如下：

```
public void removeAlbum(String album) {
    for (Album alb : this.getAlbums()) {
        if (alb.getAlbum().equals(album)) {
            this.getAlbums().remove(alb);
            this.getAlbums().trimToSize();
            break;
        }
    }
} 
```

我也建议`equals`在你的类定义中实现（覆盖）方法。当您在类中添加更多属性时，这会有所帮助。

# python - 如何获取给定字符串中的数字字符总数？

> ID：12717435
> 
> 赞同：3
> 
> 时间：2012-10-03T21:52:54.040
> 
> 标签：python, string

如何计算字符串中的位数？

例如：

```
>>> count_digits("ABC123") 
```

应该返回 3。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-03T21:54:19.267

尝试这个：

```
len("ABC123") 
```

像馅饼一样简单。您可能有必要阅读[有关](http://docs.python.org/library/functions.html#len).`len`

* * *

**编辑**您的原始帖子对于您是否想要总长度或位数模棱两可。看到你想要后者，我应该告诉你，有一百万种方法可以做到，这里有三种：

```
s = "abc123"

print len([c for c in s if c.isdigit()])
print [c.isdigit() for c in s].count(True)
print sum(c.isdigit() for c in s)  # I'd say this would be the best approach 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-03T22:03:48.800

我怀疑您想计算字符串中的位数

```
s = 'ABC123'
len([c for c in s if c.isdigit()]) ## 3 
```

或者也许你想计算相邻数字的数量

```
s = 'ABC123DEF456'
import re
len(re.findall('[\d]+', s)) ## 2 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T22:14:50.270

```
sum(1 for c in "ABC123" if c.isdigit()) 
```

# javascript - 如何在对象中使用 Google 地图标记？

> ID：12717440
> 
> 赞同：1
> 
> 时间：2012-10-03T21:53:25.673
> 
> 标签：javascript, arrays, google-maps, object, google-maps-markers

我有一个这样定义的数组“markerGroups”：

```
var markerGroups = {"foo": [], "bar": [], "foobar": []}; 
```

该数组用于存储谷歌地图中的所有标记。如您所见，我有三个类别来存储标记。一个标记只会存在于一个类别中，而永远不会存在于任何其他类别中。每个标记也由唯一的 ID 标识，例如 ID 可以是 1422。

现在我想以这样一种方式将标记添加到这个组中，例如我可以通过这样做来达到它

```
console.log(markerGroups.foo[1422]); 
```

即使这是该类别中的唯一标记。我还必须能够从类别中完全删除它。

我试图通过定义这样的markerGroups来实现这一点：

```
var markerGroups = {"foo": {}, "bar": {}, "foobar": {}}; 
```

这一行在一个函数中，其中标记被定义为标记，并且类别被传递到函数中，告诉函数将标记存储在哪里。

```
markerGroups[category][marker.ID] = marker; 
```

这很好用，除了标记现在不会出现在我的地图中。

任何想法为什么或如何以更好的方式完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T08:35:32.903

标记是简单的 JS 对象，可以像任何 JS 对象一样进行操作。

您可以控制标记是否显示在地图上的唯一方法是通过它的 setMap() 函数。因此，请检查您的代码，看看您是否为要在地图上显示的标记调用 setMap(your_map)。还要记住，必须设置一些属性（例如位置）才能显示标记。

所以，不用担心简单的 JS 对象操作，只要正确初始化它就不会与 Marker 可见性交互。

当然，这是理论上的观点，如果你做了这一切，仍然不行，你必须提供一些额外的细节和代码。

# java - 为什么 String 是一个类？

> ID：12717451
> 
> 赞同：6
> 
> 时间：2012-10-03T21:54:24.167
> 
> 标签：java, string, syntax

如果它可以启动

```
String s = "Hello"; 
```

那为什么它是一个类？参数在哪里？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-03T21:55:54.847

```
String s = "Hello"; 
```

只是语法糖。它实际上是作为引用类型实现的。（它是一个不可变的引用类型，所以你不能改变它）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-03T21:57:35.393

鉴于这`String`是一个如此有用且经常使用的类，它有一种特殊的语法（通过字符串文字表示：内部的文本`""`）来创建它的实例，但在语义上这两者是等价的：

```
String s = "Hello"; // just syntactic sugar
String s = new String("Hello"); 
```

在幕后，这两种形式*并不是*100% 等效的，因为 using 的语法`""`试图重用 Java 字符串池中的字符串，而显式实例化`new String("")`总是会创建一个新对象。

但请不要误会，任何一种语法都会产生对对象实例的引用，字符串在 Java 中不被视为原始类型，并且是类的实例，就像其他任何语法一样。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-03T21:56:40.867

来自[Java 规范的 §4.3.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3.3)：

> 字符串文字是对 class 实例的引用`String`。

从[§3.10.5 开始](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.5)：

> 字符串文字是对类实例的引用`String`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-03T21:56:41.760

```
String s = "Hello"; 
```

JVM 将其视为：

`String s = new String("Hello");`并将其实习到`String`池中作为`String`文字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T21:55:37.033

您在示例中的行是创建一个 String 对象。没有您正在考虑的传统意义上的任何参数。

# asp.net - ASP.NET MVC3 EF 模型继承不能隐式转换类型

> ID：12717453
> 
> 赞同：0
> 
> 时间：2012-10-03T21:54:38.563
> 
> 标签：asp.net, database, asp.net-mvc-3, inheritance

我确定我只是在这里遗漏了一些非常基本的东西，但我似乎无法弄清楚......也许是因为我已经有一段时间没有使用 .NET 平台了。

无论如何，我在 ASP.NET MVC3 框架中有这个数据库结构，其中我有“Coruse”、“Tool”和“ToolADL”（从工具继承）。“课程”可以有一个或多个“工具”，其中“工具”类型之一是“ToolADL”。

模型/课程.cs：

```
public class Course {
    [Key]
    public int CourseID { get; set; }

    [Required(ErrorMessage = "{0} er påkrævet")]
    [Display(Name = "Værktøj")]
    public virtual ICollection<Tool> Tools { get; set; }
} 
```

模型/工具.cs：

```
public abstract class Tool {
    public Tool(){
        Priority = 0;
    }
    [Key]
    public int ToolID { get; set; }

    [Required]
    public int CourseID { get; set; }

    [Required]
    public int Priority { get; set; }
} 
```

模型/ToolADL.cs：

```
public class ToolADL : Tool {
    [Required]
    public string Image { get; set; }
} 
```

aa 和模型/项目上下文：

```
public class ProjectContext : DbContext {
    // Course context
    public DbSet<Course> Courses { get; set; }

    // Tools
    public DbSet<Tool> Tools { get; set; }

    // ToolADL
    public DbSet<ToolADL> ToolADLs { get; set; }
} 
```

现在，当我尝试创建控制器并连接到 DbContext 和模型到它以便实体框架可以发挥它的魔力时，我在 ToolADL 控制器详细信息函数（和其他函数）中收到以下错误，其中我使用“find()” ：

ToolADLController.Details(int):

```
private ProjectContext db = new ProjectContext();
public ViewResult Details(int id){
    ToolADL tooladl = db.Tools.Find(id);
    return View(tooladl);
} 
```

> 错误 1 ​​无法将类型“Project.Models.Tool”隐式转换为“caREhab_community.Models.ToolADL”。存在显式转换（您是否缺少演员表？） C:\Users\Thor\Documents\Visual Studio 2010\Projects\Project\Project\Project\ToolADLController.cs 29 31 Project

（我将原始项目的名称更改为“项目”）

我根本无法弄清楚我做错了什么，是错误的类型，我遗漏了一些关于继承的基本知识还是其他什么？

希望有好心人能告诉我为什么我是个白痴而无法弄清楚这一点：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:53:45.513

如果返回的对象是`db.Tools.Find(id)`类型，`ToolADL`那么你应该这样做：

```
ToolADL tooladl = db.Tools.Find(id) as ToolADL; 
```

之后，您将拥有您的对象或 null。

如果它不是类型，`ToolADL`那么你不能这样做，因为：

当你有：

```
public class A { }
public class B : A { } 
```

你不能这样做：

```
A a = new A();
B b = a; 
```

这实际上是关于继承的一个基本事实。您可以通过执行以下操作将此隐式转换更改为显式：

```
B b = (B)a; 
```

然后你的代码会编译，但你会得到一个运行时异常：

> 无法将“A”类型的对象转换为“B”类型。

要使其工作，您必须像这样指定显式转换：

```
public class A 
{
    public static explicit operator B(A a)
    {
        return new B();
    }
} 
```

但这会给您带来另一个编译时错误：

> 'A.explicit operator B(A)'：不允许用户定义的与派生类之间的转换

# java - GWT - 将不同的 XML 模板应用到同一个小部件

> ID：12717454
> 
> 赞同：1
> 
> 时间：2012-10-03T21:55:15.083
> 
> 标签：java, templates, gwt, uibinder

为了减少一些重复的代码/类，我尝试只为 1 个所有者类使用多个 XML 模板。[官方 GWT 指南](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Apply_different_xml)已经指出了如何做到这一点。

```
 public class FooPickerDisplay extends Composite{
     @UiTemplate("RedFooPicker.ui.xml")
     interface RedBinder extends UiBinder<Widget, FooPickerDisplay> {}
     private static RedBinder redBinder = GWT.create(RedBinder.class);

     @UiTemplate("BlueFooPicker.ui.xml")
     interface BlueBinder extends UiBinder<Widget, FooPickerDisplay> {}
     private static BlueBinder blueBinder = GWT.create(BlueBinder.class);

     @UiField Button button1;
   } 
```

'@UiField' 会导致编译错误，它说“字段 button1 在模板文件 BlueFooPicker.ui.xml 中没有对应的字段”

我的 RedFooPicker.ui.xml 和 BlueFooPicker.ui.xml 的内容完全不同，所以 RedFooPicker.ui.xml 中有 UiField="button1" 但 BlueFooPicker.ui.xml 中没有 button1。

所以我的问题是，如果有什么方法可以为同一个所有者类使用具有完全不同内容的多个 XML 模板而不会导致这种错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:58:45.410

不，每个人都`UiBinder`必须对不同的所有者类别采取行动。但是，您可以轻松地为其中一个创建内部类`UiBinder`。文档中的示例是关于使用其中一种，而不是同时使用两种。

顺便说一句，为了减少重复，您最好尝试将事物抽象为可重用的小部件。

# php - 如何保护贝宝支付处理的敏感页面？

> ID：12717455
> 
> 赞同：0
> 
> 时间：2012-10-03T21:55:18.283
> 
> 标签：php, paypal, payment-processing

我正在使用遵循以下流程的贝宝快速结帐： ![在此处输入图像描述](../Images/2ff701fd30505ff5db488a915601941a.png)

当他们在 paypal 网站上提交时，它会跟随我网站上的返回 url，该 URL 显示带有确认按钮的订单审查，并且两个 GET 变量从 paypal 传回：`token`和`payerId`. 该令牌允许我请求运输信息并稍后完成付款。

第一个问题是我可以通过在地址栏中输入 URL 直接访问“使用 paypal 结帐”页面，它会将请求提交给 paypal，如果`$_SESSION['Payment_Amount']`未设置变量，它会处理付款金额为 0 并抛出一个错误。

> SetExpressCheckout API 调用失败。详细错误消息：无法处理此交易。要收取的金额为零。

我知道我可以在购物车页面上设置另一个会话变量，以确保他们首先访问购物车，然后在检查后清除该变量，但另一个问题仍然是用户只需要访问购物车页面一次，该变量将设置为允许他们访问向贝宝发送令牌请求的敏感页面。

下一个问题是，在完成所有步骤并且用户按下“确认订单”按钮后，请求被发送到贝宝以处理该订单/资金`token`。用户可以按页面上的“返回”按钮并再次查看订单审查，然后用户可以再次按确认订单，错误将显示该令牌已处理订单。

> GetExpressCheckoutDetails API 调用失败。详细的错误消息：此令牌的成功交易已经完成。

这显然是一件好事，但**我应该实施什么来防止用户访问敏感页面？**我需要跟踪后端数据库中的某些键吗？

目前我正在使用贝宝的沙箱在本地主机上工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:05:33.917

您必须以某种方式创建一个流程，以确保用户按照正确的顺序执行所需的步骤，并防止他跳出这个顺序。

跟踪用户会话中的步骤似乎是很自然的事情。如果会话不允许请求的步骤，请将他重定向到其他地方而不是询问贝宝。

豪华版是您实现了一个状态机，以便以后更容易改进。状态机的缺点是一开始看起来开销很大，如果您最初采用不同的方法，以后实现起来会很麻烦。这就是为什么从一开始就考虑使用一个很重要的原因。

如果您想稍后添加另一个支付提供商怎么办？为此可以轻松扩展状态机 - 其他任何事情都可能是一团糟。

编辑：实际上，贝宝希望您在用户回到您的网站后发送给他们的唯一内容是您要收取的金额。此信息可以通过将其放入您发送到贝宝的返回 url 中来传递。尝试在那里添加一些校验和以防止数据错误和容易被篡改（如果金额不正确，Paypal 会让过程失败），你基本上就完成了。根本不需要会话。

Edit2：这是我的代码的摘录，它定义了贝宝第一步的 nvp 参数。您也需要内部必要的身份验证内容。

```
public function preparePayment(...) {
        $nvp = array(

        'METHOD'    => 'SetExpressCheckout',
        'VERSION'   => '52.0',

        'RETURNURL'     => 'https://'.$request->server['HTTP_HOST'].'/'.$request->getLanguage().'/paypal/success/'.$this->hashAmount($amount),
        'CANCELURL'     => 'https://'.$request->server['HTTP_HOST'].'/'.$request->getLanguage().'/paypal/cancel',

            'CURRENCYCODE'  => $amount->getCurrency(),
            'AMT'           => number_format($amount->getAmount(), 2, '.', ''),
            'ITEMAMT'       => number_format($amount->getNettoAmount(), 2, '.', ''),
            'TAXAMT'        => number_format($amount->getVatAmount(), 2, '.', ''),
            'PAYMENTACTION' => 'Sale',
            'LOCALECODE'    => strtoupper($request->getLanguage())
        );
}
protected function hashAmount(Currency_Class $amount) {
    return urlencode(
        sprintf(
            '%s-%s-%s-%u',
            number_format($amount->getNettoAmount(), 2, '', ''),
            number_format($amount->getVatAmount(), 2, '', ''),
            strtoupper($amount->getCurrency()),
            $this->makeChecksumString(number_format($amount->getNettoAmount(), 2, '', ''), strtoupper($amount->getCurrency()))
        )
    );
}

protected function makeChecksumString($amount, $currency) {
    return crc32(sprintf('%sSaltValue%s', $amount, $currency));
}

protected function dehashAmount($string) {
    $parts = array();
    $found = preg_match('/^(\d+)\-(\d+)\-([A-Z]+)\-(\d+)$/', $string, $parts);
    if ($found) {
        $check = sprintf('%u', $this->makeChecksumString($parts[1], $parts[3]));
        if ($check == $parts[4]) {
            $netto  = floatval(substr($parts[1], 0, -2) .'.'. substr($parts[1], -2));
            $vat    = floatval(substr($parts[2], 0, -2) .'.'. substr($parts[2], -2));
        }
    }
    return ...
} 
```

# text - 如何在 PostScript 的页面上居中旋转文本

> ID：12717457
> 
> 赞同：2
> 
> 时间：2012-10-03T21:55:23.197
> 
> 标签：text, rotation, center, ghostscript, postscript

我使用以下 PostScript 代码将文本*样本放在每个 PDF 页面上：*

```
<<
   /EndPage {
   exch pop 2 lt { 
     gsave
     /Arial-Bold 120 selectfont
     .5 setgray 100 100 moveto 45 rotate (Sample) show
     grestore
     true}
     {false}
     ifelse
   } bind
>> setpagedevice 
```

这会将文本放在 [100; 100] 位置。但我需要将此文本居中（会计文本旋转）。

如何在页面中心对齐这个*45° 旋转*的文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T05:18:19.177

您可以使用`false charpath flattenpath pathbbox`来获取文本的边界框。如果当前点是`0 0`您执行此操作的时间，则左下角坐标将*非常接近* `0 0`，因此右上角坐标描述了文本的宽度和高度。因此，您只需移动到所需的中心点并通过相对移动到 (-width/2, -height/2) 进行备份。

由于旋转中心也是中心点，因此您需要在旋转之前在那里平移。

```
%!
/w 612 def
/h 792 def
/Helvetica-Bold 120 selectfont

w .5 mul h .5 mul translate
0 0 moveto
(Sample) false charpath flattenpath pathbbox % llX llY urX urY
4 2 roll pop pop % urX urY

0 0 moveto
45 rotate
-.5 mul exch -.5 mul exch % -wid/2 -ht/2
rmoveto
(Sample) show 
```

为了更准确，替换`4 2 roll pop pop`为

```
exch % llX llY urY urX
4 1 roll % urX llX llY urY
exch sub % urX llX urY-llY
3 1 roll % urY-llY urX llX
sub exch % urX-llX urY-llY 
```

然后该点可以在任何地方（但*确实*需要一个当前点，因为`charpath`就像构建路径一样`show`，即使`pathbbox`立即破坏它；所以你需要某种`moveto`）。

# android - 为什么 CursorAdapter（使用 ContentProvider）在 UI 线程上加载数据？

> ID：12717462
> 
> 赞同：3
> 
> 时间：2012-10-03T21:55:52.853
> 
> 标签：android, android-cursoradapter, performance

查看 github 上的 CursorAdapter 代码（[core/java/android/widget/CursorAdapter.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/widget/CursorAdapter.java)）

getView 方法调用 mCursor.moveToPosition

```
public View getView(int position, View convertView, ViewGroup parent) {
    if (!mDataValid) {
        throw new IllegalStateException("this should only be called when the cursor is valid");
    }
    if (!mCursor.moveToPosition(position)) {
        throw new IllegalStateException("couldn't move cursor to position " + position);
    }
    View v;
    if (convertView == null) {
        v = newView(mContext, mCursor, parent);
    } else {
        v = convertView;
    }
    bindView(v, mContext, mCursor);
    return v;
} 
```

当我在这里查看 CursorAdapter 代码时，会有一些情况下 fillWindow 被调用[core/java/android/database/sqlite/SQLiteCursor.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/database/sqlite/SQLiteCursor.java)

```
@Override
public boolean onMove(int oldPosition, int newPosition) {
    // Make sure the row at newPosition is present in the window
    if (mWindow == null || newPosition < mWindow.getStartPosition() ||
            newPosition >= (mWindow.getStartPosition() + mWindow.getNumRows())) {
        fillWindow(newPosition);
    }

    return true;
} 
```

如果您继续查看代码，您会发现这最终会进行数据库调用。在 UI 线程上进行数据库调用的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T17:28:12.347

据我了解，光标的窗口方面旨在对调用者隐藏，因此在使用当前 API 从第一个窗口转到溢出窗口时，无法避免从主线程命中数据库。

不过，大多数查询都适合单个窗口，因此通常的做法是在 AsynTask 或 Loader 内的光标上调用 getCount()，然后再将其返回给 UI 线程，这具有加载第一个窗口的副作用。

# objective-c - 你如何管理一个简单的模型对象来加载它的所有实例？

> ID：12717464
> 
> 赞同：0
> 
> 时间：2012-10-03T21:55:54.710
> 
> 标签：objective-c, ios, xcode, design-patterns

我试图解释。简单的示例项目，例如由 Core Data 管理的 Person 类。我有许多 UITableViews 显示数据（一个显示所有人员，允许添加、删除、更新人员，另一个显示中年，另一个显示按相同姓名分组的人员......这些只是一些示例，它没有事情）。当然，我不想在所有视图控制器中编写核心数据代码。在这种情况下，您会怎么做才能编写更易于维护的代码？

*   一个单例“PersonManager”类，（例如）一个包含所有人的 mutableArray，插入-删除-更新方法，一个 NSFetchedResultsController ecc ecc ...

*   Person 对象的类方法？类似“NSArray *array = [personObject allPersons];” 和方法添加-删除-更新？该类知道如何从内存中加载自身 ecc ecc ...？

要不然是啥？

谢谢法比奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:23:55.493

我曾经读过一本关于设计模式和 OOP 的非常好的书，里面说你做的每一堂课都想称之为“经理”的课都是垃圾。我不记得那本书了，但这并不重要。关键是，每个数据对象都应该能够管理自己并管理其关系（例如，一个人对象可以有一个 addFather: 或 addFriend: 方法）。还有一个 Core Data 提示：使用类别来为自动生成的数据对象类实现额外的方法，当您在 Core Data 中添加新的关系或属性时，它会让您的生活变得更加轻松。

因此，在您的情况下，您需要一个将所有人都绑定到它的数据对象。您可以将其称为 AgendaDO 或其他名称。该对象将具有添加、删除人员、按特定顺序获取所有人员、仅对特定人员进行排序等方法。

# ruby - 正则表达式混淆

> ID：12717466
> 
> 赞同：-3
> 
> 时间：2012-10-03T21:55:58.720
> 
> 标签：ruby, regex

为什么一个正则表达式对扫描和匹配方法的行为不同？

```
str = "A man, a plan, a canal -- Panama"

/\w+/.match(str).to_s #=> #<MatchData "A"> i.e. just "A"

str.scan(/\w+/)       #=> ["A", "man", "a", "plan", "a", "canal", "Panama"] 
```

这些方法应该带来相同的结果，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T21:58:49.917

`match`只会返回第一个匹配项，因为它就是这样做的，而`scan`将返回所有匹配项。使用的正则表达式实际上工作完全相同。[看到这个。](https://stackoverflow.com/questions/7993662/whats-the-difference-between-scan-and-match-on-ruby-string)

# jquery - JQuery 验证单选按钮组

> ID：12717467
> 
> 赞同：2
> 
> 时间：2012-10-03T21:55:58.843
> 
> 标签：jquery, jquery-validate

我正在使用 jquery 的验证器插件来验证我的整个表单。我有一组像这样的单选按钮：

```
<div class="radio_options" style="display:none; margin-left:7px;">
    <label><input type="radio" name="options" value="1"> Option1</label>
    <label><input type="radio" name="options" value="2"> Option2</label>
    <label><input type="radio" name="options" value="3"> Option3</label>
</div> 
```

我知道我可以把

```
class="required" 
```

但它会在选项 1 旁边显示所需的消息，使其看起来像需要**该**单选按钮。相反，我想在所有需要选择至少一个的单选按钮上方显示一条*自定义消息。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T22:10:49.990

```
$(".form").validate({
    ...
    ,errorPlacement: function (error, element) {
        if (element.is("input:radio")) {
            element.parents("div:first").before(error);
        } else {
            element.after(error);
        }
    }
    ...
}); 
```

# dialog - 当我有一个需要关闭的弹出对话框时，为什么没有触发 QTP 的恢复方案？

> ID：12717468
> 
> 赞同：2
> 
> 时间：2012-10-03T21:56:04.850
> 
> 标签：dialog, qtp

我有一个与网页交互的 QTP 脚本。有时，此网页会弹出对话框，干扰测试的其余部分，需要通过简单的“确定”将其关闭，然后我才能继续运行测试。

恢复方案应该处理这种确切的情况，但尽我所能，QTP 永远不会识别弹出窗口。恢复方案设置为在看到带有“窗口标题：来自网页的消息”的对话框时触发。我使用了对象间谍，所以我知道这是正确的标识。

附上网页偶尔显示的对话框。非常简单的对话框，为什么 QTP 不能识别呢？

![来自网页的消息对话框](../Images/d0ca9823fba744160e406144a988b6b6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:56:04.850

事实证明，我的恢复方案构建正确，但我遇到的问题是 QTP 不知道何时激活恢复方案。

转到`File > Settings > Recovery`，突出显示要激活的恢复方案，然后更改`Activate recovery scenarios`为`On every step`。

默认情况下，恢复方案仅在**QTP**抛出错误时激活，*而不是*在您的*网页*抛出错误时激活。最后，让恢复方案检查每一步可能会降低性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:32:55.157

您应该检查此窗口何时显示为页面刷新、打开新窗口或单击按钮，或在页面上操作 2 长。那么既然这是你得到的标准窗口，你为什么不添加到对象存储库中。然后创建一个检查此窗口是否存在的函数，当任何可疑情况发生时调用此函数。这不会严重降低与恢复方案相比的性能。

# jquery - 视图中用于保存滚动位置的选项的主干范围

> ID：12717470
> 
> 赞同：0
> 
> 时间：2012-10-03T21:56:12.753
> 
> 标签：jquery, backbone.js, scope

所以我将两个模型传递到主干视图中。我从视图的初始化函数中使用 this.options.model2 获得第二个模型。

```
App.MyView = Backbone.View.extend({
initialize: function() {
        this.stateModel = this.options.model2;

        // test to make sure the stateModel is being set correctly. This works.
        console.log("test: : " + this.stateModel.get("blah"));

        // Save scroll position in model2 on scroll
        $( window ).on( 'scroll', function () {
            this.stateModel.set("savedScrollY", this.pageYOffset);
        });
}); 
```

当我滚动时，我收到错误：

> TypeError：表达式“this.stateModel”[undefined] 的结果不是对象。

我猜这是因为我不了解触发器关闭时应用程序的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:04:52.163

`this`设置为 jQuery 事件回调中原始选择器中的元素。

```
...
var that = this;
$( window ).on( 'scroll', function () {
    // here this = window
    that.stateModel.set("savedScrollY", this.pageYOffset);
}); 
```

# ncurses - 超时 NCURSES 和缓冲区

> ID：12717475
> 
> 赞同：0
> 
> 时间：2012-10-03T21:56:53.087
> 
> 标签：ncurses

我正在尝试向使用 ncurses 创建的终端应用程序添加一些细节。

该应用程序类似于带有超时的测验......如果用户浪费太多时间，则会发生超时并清理屏幕。

现在的问题是：如何显示用户在超时之前插入的文本，并根据需要进行编辑/重新编辑？

例子：

问：你觉得快乐吗？（正确答案是的，我感到很幸福）

A:Yes, I fe (TIMEOUT, clean the screen, question is again but no "Yes, I fe" is printed)。

我不知道是否有可能将其添加到标准输入缓冲区或行缓冲区...

想法...

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:19:13.323

你可以这样做：

*   通过调用禁用阻止键盘读取`nodelay(stdscr, TRUE);`
*   在一个循环中，检查一个键是否被按下`getch()`并检查它是否返回一个值> 0
    *   如果是，照常处理密钥
    *   否则睡眠几微秒（没有忙等待！）使用`usleep()`并检查超时；如果发生超时，则处理它

# sql - 如何从存储过程中捕获错误？在 sql

> ID：12717480
> 
> 赞同：1
> 
> 时间：2012-10-03T21:57:20.680
> 
> 标签：sql, sql-server, variables, parameters, try-catch

我有一个可以返回错误的存储过程这个例子它总是会返回错误

```
create proc regresaerror
as
begin
 raiserror 51001 'Error al borrar los precios especiales' 
end

declare @error varchar(max)
set @error=''
begin try
set @error=exec regresaerror
end try
begin catch
end catch 
```

我试过了（因为我需要在临时表中插入这个错误）但是那个块代码得到了这个错误

> *消息 156，级别 15，状态 1，第 4 行
> 关键字“exec”附近的语法不正确。*

无法更新存储过程以添加输出变量

那我怎么能捕捉到错误呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:00:25.223

第一种解决方案：

```
BEGIN TRY
    EXECUTE regresaerror
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() AS ErrorNumber
        ,ERROR_MESSAGE() AS ErrorMessage;
END CATCH; 
```

[这里](http://msdn.microsoft.com/en-us/library/ms175976.aspx)是 MSDN 的链接。

第二种解决方案：

```
create proc regresaerror 
(
  errmsg varchar(max) out
)
as
begin
 set errmsg =  'Error al borrar los precios especiales' 
 return 51001 -- if error
end 

declare @error varchar(max)
declare @numerror int
set @error=''   
exec @numerror = regresaerror @error out 
```

# jquery - 在本地存储保存功能上，也将变量传递给 MySQL db

> ID：12717482
> 
> 赞同：1
> 
> 时间：2012-10-03T21:57:40.230
> 
> 标签：jquery, mysql, json, local-storage

我有这个脚本，每个用户都可以个性化每个可用的小部件（id、样式、位置……），并且他们的更改被保存到 HTML5 本地存储中 - 但我也想将这些变量传递给 MySQL db，所以如果一个人从不同的浏览器访问站点，他们不必从头开始重新排列所有内容，但是如果本地存储为空，则那些先前设置的变量将从 MySQL 数据库中提取。

我不知道如何将这 3 个变量从本地存储保存的 JS 文件传递​​到 MySQL db。

我猜我应该从 Ajax 调用 PHP 查询文件，但不确定如何。

```
//** SAVE SETTINGS FUNCTION **//        

function saveSettingsWidget(){  
    if(localStorage && o_localStorage){
        var storeSettings = [];

        obj.find(o_widgetClass).each(function(){
            var storeSettingsStr          = {};
            storeSettingsStr['id']        = $(this).attr('id');
            storeSettingsStr['style']     = $(this).attr('data-attstyle');
            storeSettingsStr['hidden']    = ($(this).is(':hidden') ? 1 : 0);

            storeSettings.push(storeSettingsStr);
        });

        var storeSettingsObj = JSON.stringify( {'widget':storeSettings} );

        /* Place it in the storage(only if needed) */
        if(getKeySettings != storeSettingsObj){
            localStorage.setItem(keySettings, storeSettingsObj); 
        }
    }
} 
```

更新：

好的，所以我设法用 Ajax 调用 PHP（带有插入和更新查询），一切正常，MySQL db 更新所有值。

现在，意图是在本地存储为空时调用这些值。

我创建了一个 PHP 查询，它以与本地存储存储它们的方式完全相同的方式输出值：

```
$query = "SELECT id , position , color , title , hidden , collapsed FROM mod_pos  ORDER BY `position` ASC";

if($result = mysql_query($query))
{
    // fetch data
    while ($row = mysql_fetch_assoc($result))
    {
        $row_set[] = $row; 
    }

    // set the output
    $jsonsettings = json_encode($row_set);

} 
$json='{"widget":' .$jsonsettings. '}' ; 
echo $json; 
```

所以输出是

```
{"widget":[{"id":"widget1-42","position":"0","color":"default","title":"Title1","hidden":"0","collapsed":"0"},{"id":"widget5-42","position":"1","color":"default","title":"Title5","hidden":"1","collapsed":"0"}]} 
```

现在 - 如果我的本地存储是空的，我希望这些保存的值被我假设解析：

```
var url = "url-to-php-file-with-json-output.php"
$.getJSON(url,function(json){          }); 
```

但我在哪里做...

在 JS 文件中有一个设置键的部分：

```
if(localStorage && o_localStorage) // this is if localStorage is enabled and there are values in browser's local storage
{               
var keySettings    = 'widgets_settings_'+location.pathname+'_'+objId;
var getKeySettings = localStorage.getItem(keySettings);
} 
```

我应该放一个

```
else { $.getJSON ...} 
```

在这里，我应该以不同的方式定义键，因为通过查看：

```
var keySettings    = 'widgets_settings_'+location.pathname+'_'+objId; 
```

那是本地存储的标识符 - 它取代了实际输出，这与新的数据源无关，现在是 mysql 输出。

或者我应该跳过该部分并在此处指定它：

```
 if(localStorage && o_localStorage && getKeySettings){

var jsonSettings = JSON.parse(getKeySettings); 
```

如何...

我知道这对某些人来说一定是一个完全荒谬的问题，但如果可能的话，我真的很感激更详细的帮助。

谢谢万

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-04T21:40:18.303

是的，阿贾克斯。如果您使用的是框架（jquery），那么网上有很多教程。也许从[这里](http://docs.jquery.com/Tutorials)开始。

# objective-c - 带有自定义转场的自动布局

> ID：12717484
> 
> 赞同：1
> 
> 时间：2012-10-03T21:58:09.297
> 
> 标签：objective-c, ios, xcode, autolayout

我正在尝试使用自定义 segue 在两个视图控制器之间进行交叉溶解，segue 正确启动并按预期执行动画 - 但是在横向模式下，目标视图控制器在动画期间出现在其纵向布局中。一旦动画完成，目标视图控制器就会“捕捉”到它的横向布局。两个视图控制器都是使用自动布局设置的。

下面是我的自定义 segue 的“执行”方法：

```
- (void)perform
{
  UIViewController *srcController = self.sourceViewController;
  UIViewController *dstController = self.destinationViewController;
  dstController.view.transform = srcController.view.transform;

  [UIView transitionFromView:srcController.view 
                      toView:dstController.view 
                    duration:self.animationDuration 
                     options:self.animationOptions 
                  completion:self.animationCompletionBlock];
} 
```

是否需要在显示之前手动告诉目标视图控制器触发自动布局？如果是这样，这将如何执行？使用带有交叉溶解的内置转场似乎不会遇到这个问题，我尝试（没有成功）确定我的自定义转场不是在做什么。

这让我困惑了一段时间，任何帮助将不胜感激，如果需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T13:53:52.860

所以事实证明，这个问题的解决方案比我想象的要简单。添加以下行可确保目标视图控制器在布局其元素时具有正确的边界：

```
dstController.view.bounds = srcController.view.bounds; 
```

所以剩下的代码变成了：

```
- (void)perform
{
  UIViewController *srcController = self.sourceViewController;
  UIViewController *dstController = self.destinationViewController;
  dstController.view.transform = srcController.view.transform;
  dstController.view.bounds = srcController.view.bounds;

  [UIView transitionFromView:srcController.view 
                      toView:dstController.view 
                    duration:self.animationDuration 
                     options:self.animationOptions 
                  completion:self.animationCompletionBlock];
} 
```

# shopify - 控制 robots.txt 和 sitemap.xml

> ID：12717485
> 
> 赞同：4
> 
> 时间：2012-10-03T21:58:23.727
> 
> 标签：shopify

是否有可能通过某些设置或通过开发应用程序来控制shopify商店的robots.txt和sitemap.xml？

我尝试设置 url 重定向，但似乎在 url 方向发生之前使用了这些预生成的文件。反正有一个应用程序可以解决这个问题吗？

查看 api 似乎不太可能，但我想在放弃这个想法之前我会在这里检查一下。现在我能想到的唯一解决方案是购买一个单独的域名作为商店的前面，然后使用 mod_rewrite 将所有不是 robots.txt 的 url 和站点地图 xmls 代理到 store.shopify。 com 网址。

该解决方案会失败吗？

我知道它可能不是超级有效，但从原始的理解来看，我认为它可能会起作用。我想没有办法让子域存储上的所有链接都指向主域存储，当它没有通过 dns 链接时，但这将是一个比使用默认站点地图更小的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T15:21:13.893

这些文件由 Shopify 自动生成，不能被覆盖。

# javafx-2 - 如何用不透明的孩子实现透明窗格？

> ID：12717487
> 
> 赞同：22
> 
> 时间：2012-10-03T21:58:35.263
> 
> 标签：javafx-2

如何在 JavaFX 2 中实现具有非透明子项的透明面板？我想要实现的效果例如应用于 Blender 中的菜单：

![在此处输入图像描述](../Images/e4366a064bd22e3b8eee48f649aa45c6.png)

菜单面板/窗口是透明的，但文本项不透明，这会产生漂亮的效果。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-10-03T22:45:01.577

将窗格的背景设置为具有 alpha 分量的颜色。您可以为此使用样式表或内联样式。

例如，如果您的窗格被命名为 glass，那么下面将给它一个圆形、半透明的青色背景：

```
glass.setStyle("-fx-background-color: rgba(0, 100, 100, 0.5); -fx-background-radius: 10;"); 
```

您还可以使用混合、堆栈窗格或项目组来完成类似的效果，并为堆栈窗格或组后面的项目设置[不透明度](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#opacityProperty)。

这是一个使用 css 后台方法的可执行示例。

```
import javafx.application.Application;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.image.*;
import javafx.scene.layout.*;
import javafx.stage.Stage;

public class TranslucentPane extends Application {
  @Override public void start(final Stage stage) throws Exception {
    final ImageView imageView = new ImageView(
      new Image("https://upload.wikimedia.org/wikipedia/commons/b/b7/Idylls_of_the_King_3.jpg")
    );
    imageView.setFitHeight(300);
    imageView.setFitWidth(228);

    final Label label = new Label("The Once\nand\nFuture King");
    label.setStyle("-fx-text-fill: goldenrod; -fx-font: italic 20 \"serif\"; -fx-padding: 0 0 20 0; -fx-text-alignment: center");

    StackPane glass = new StackPane();
    StackPane.setAlignment(label, Pos.BOTTOM_CENTER);
    glass.getChildren().addAll(label);
    glass.setStyle("-fx-background-color: rgba(0, 100, 100, 0.5); -fx-background-radius: 10;");
    glass.setMaxWidth(imageView.getFitWidth() - 40);
    glass.setMaxHeight(imageView.getFitHeight() - 40);

    final StackPane layout = new StackPane();
    layout.getChildren().addAll(imageView, glass);
    layout.setStyle("-fx-background-color: silver; -fx-padding: 10;");
    stage.setScene(new Scene(layout));
    stage.show();
  }

  public static void main(String[] args) { launch(args); }
} 
```

示例程序输出：

[![曾经和未来](../Images/a9e2737f8a708dfe464761eaf60c9796.png)](https://i.stack.imgur.com/BUHme.png)

# unix - Unix命令：grep -A

> ID：12717489
> 
> 赞同：-2
> 
> 时间：2012-10-03T21:58:49.253
> 
> 标签：unix, grep

当我尝试使用以下命令打印包含单词“CHAPTER”的“result.txt”的前 5 行时：

```
-grep -A 5 "CHAPTER" warandpeace.txt 
```

我不明白我在寻找什么。

我的命令有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:06:26.677

也许您正在寻找命令：

```
grep "CHAPTER" warandpeace.txt | head -n 5 
```

它试图找到 的所有实例`CHAPTER`，但在打印前 5 行后停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:04:40.447

如果您的意思是想要前 5 次出现“CHAPTER”，请尝试

`grep "CHAPTER" warandpeace.txt | head -5`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:05:53.583

试一试`grep -m 5 "CHAPTER" warandpeace.txt`_

# ruby - 理解 RSpec 中对 as_null_object 的需求

> ID：12717494
> 
> 赞同：2
> 
> 时间：2012-10-03T21:59:20.000
> 
> 标签：ruby, testing, rspec, tdd

在阅读 The RSpec Book 时，我遇到了[as_null_object](http://apidock.com/rspec/Spec/Mocks/Methods/as_null_object)方法。我不明白这本书为什么需要它的解释：

> ...最简单的方法是告诉双重输出只听我们告诉它期望的消息并忽略任何其他消息。

但是为什么示例代码会失败？当我们`double('output')`在每个示例中调用时，我们不是为每个示例创建一个新的双对象并发送一条消息吗？

我想要的是对示例代码失败的原因以及如何`as_null_object`解决问题的更深入的解释（比书本）。

```
 it "sends a welcome message" do
    output = double('output')
    game = Game.new(output)
    output.should_receive(:puts).with('Welcome to Codebreaker!')
    game.start
  end

  it "prompts for the first guess" do
    output = double('output')
    game = Game.new(output)
    output.should_receive(:puts).with('Enter guess:')
    game.start
  end 
```

这本书试图在前面的部分解释错误的原因，但我还是不明白这个解释。

> 我们在第一个示例中告诉替身期待`puts`“欢迎来到 Codebreaker！” 我们已经满足了这个要求，但我们只告诉它期待“欢迎使用 Codebreaker！” 它对“输入猜测：”一无所知
> 
> 同样，第二个示例中的 double 期望“输入猜测：”，但它收到的第一条消息是“欢迎使用 Codebreaker”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:44:08.223

当您创建一个 double`output = double('output')`并将其传递给 中的新游戏时`Game.new(output)`，该 double 将收到它在 codebreaker 游戏代码中传递的每条消息。您尚未包含它，但该`start`方法具有以下代码：

```
module Codebreaker
  class Game
    ...
      def start
        @output.puts 'Welcome to Codebreaker!'
        @output.puts 'Enter guess:'
      end
  end
end 
```

在这里，请记住 double`output`已被分配给'方法`@output`中的实例变量，因此在每个规范中，它会通过两条消息调用，首先是“欢迎使用 Codebreaker！”，然后是“输入猜测：”。`game``initialize`

如果没有`as_null_object`，则`output`当它收到与预期不同的任何内容时，双重将失败，即在第一个规范中，除了“欢迎使用 Codebreaker！”之外的任何内容 在第二个规范中，除了“输入猜测：”之外的任何内容。通过`as_null_object`在替身上使用，你告诉它坐下来等待，忽略它所期望的以外的任何东西。这样就避免了上面的问题。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-16T15:24:12.103

我同意解释不是很清楚。这就是我的理解，也许结合shioyama的回答会让这个点击。

创建规范时，您是说输出将包含预期的短语，但并不是说它仅包含预期的短语。因此，假设您通过将所有期望放在一个示例中来解决错误，如下所示：

```
 it "gets expected output" do
     output = double('output')
     game = Game.new(output)
     output.should_receive(:puts).with('Welcome to Codebreaker!')
     output.should_receive(:puts).with('Enter guess:')
     game.start
   end 
```

这会过去的。问题是，如果您稍后决定让游戏开始时说“嗨，乔！”，那么它就会失败。然后您将不得不返回并修复您的规范，而实际上它已经满足规范。您需要一种机制让输出对意外输入做出反应而没有任何行为。这样，当出现意外情况时，您可以获得预期的特定输出示例，而不会失败。这似乎是非常基本的编程和单元测试断言，但在 RSpec 中，他们以您和我似乎不清楚的方式实现它。短语“空对象”带有很多包袱，似乎并没有描述它的含义正在做，但它是空对象模式（[http://en.wikipedia.org/wiki/Null_Object_pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)）的实现。

# mysql - 在 Yii 中对 CHtml::listData 下拉列表进行排序

> ID：12717499
> 
> 赞同：3
> 
> 时间：2012-10-03T21:59:45.750
> 
> 标签：mysql, yii

我的数据库表名为“status”，它有一个名为“order”的列，其类型为 float。

我正在尝试根据从最低到最高的顺序对状态字段进行排序，并将这些字段输入到下拉列表中。

这是我正在使用的代码：

```
echo $form->dropDownListRow($my_model, 'status', CHtml::listData(Status::model()->findAll(array('order'=>"'order' ASC")), 'id', 'name'), array('class'=>'span3','prompt'=>Yii::t('forms', 'Please Select A Status'))); 
```

但该列表始终按状态 ID 排序。我需要做一些类型转换吗？如果是这样，我将如何对我的查询进行类型转换，以便它按“顺序”升序排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:07:01.777

您指定的顺序不正确：

```
array('order'=>"'order' ASC") 
```

（列名）周围有额外的引号`order`，这意味着实际上您根本没有排序。删除引号以解决问题，但将反引号放在它们的位置，因为`order`它是 MySql 中的保留字：

```
array('order'=>"`order` ASC") 
```

# iphone - MFMessageComposeViewController 半透明键盘

> ID：12717504
> 
> 赞同：1
> 
> 时间：2012-10-03T22:00:13.250
> 
> 标签：iphone, ios, keyboard

我正在尝试`MFMessageComposeViewController`使用半透明键盘启动 a。我想让它尽可能透明，但我认为我们不能从我所做的阅读中做到这一点。

`UIKeyboard`创建 时如何设置 的属性`MFMessageComposeViewController`？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:08:41.003

你不。从文档中：

> **重要**消息组合接口本身不可定制，并且不能由您的应用程序修改。此外，在呈现界面后，您的应用程序无法对 SMS 内容进行进一步的更改。用户可以使用界面编辑内容，但程序更改会被忽略。因此，如果需要，您必须在呈现界面之前设置内容字段的值。

您不应该更改此界面，因为 UIKeyboard 是私有的，并且您无法访问此视图上的文本字段。尝试通过视图层次结构访问和修改此文本字段可能会导致您的应用在应用商店中被拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:06:36.540

将文本字段或文本视图的 keyboardAppearance 属性设置为`UIKeyboardAppearanceAlert`会将键盘更改为透明键盘。

我听说公共 API 中只有两种样式可用：

```
[textView setKeyboardAppearance:UIKeyboardAppearanceAlert];
[textView setKeyboardAppearance:UIKeyboardAppearanceDefault]; 
```

但是您可以使用私有 API 方法来检索键盘实现：

```
id keyboardImpl = [objc_getClass("UIKeyboardImpl") sharedInstance]; 
```

并使它不那么不透明，

```
[keyboardImpl setAlpha:0.8f]; 
```

上色，

```
UIView *tint = [[UIView alloc] initWithFrame:[keyboardImpl frame]];
[tint setBackgroundColor:[UIColor colorWithRed:0.0f green:0.0f blue:1.0f alpha:0.3f]];
[tint setUserInteractionEnabled:NO];
[[keyboardImpl superview] insertSubview:tint aboveSubview:keyboardImpl];
[tint release]; 
```

甚至翻转它：

```
[[keyboardImpl window] setTransform:CGAffineTransformMakeScale(-1.0f, 1.0f)]; 
```

希望这是您问题的解决方案。

# c# - 使用 .NET 在内存中进行文本搜索

> ID：12717509
> 
> 赞同：3
> 
> 时间：2012-10-03T22:00:28.840
> 
> 标签：c#, .net, full-text-search

我在内存中有几兆文本存储在二维数组中，其中第一列是行号，第二列是文本本身。我想做的是找到一个现有的解决方案，我可以在其中传递这种数据结构（它是可延展的）和理想情况下带有通配符的布尔搜索查询，并找出哪些行包含匹配项。是否有任何 API 可以做到这一点？我不想使用像 Lucene 这样的东西，因为我不想费心构建索引。我基本上想通过一个字符串集合来枚举并返回那些对传入的查询命中的字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:49:18.390

如果您正在加载数据，搜索一次，然后将其丢弃，那么您最好按照上面评论中的建议走 LINQ+RegEx 路线。也就是说，您最好在第一次遍历数据时进行搜索，而不是像搜索引擎那样对数据进行索引然后搜索索引。

但是，如果您要加载一次数据然后反复搜索，那么您最好使用搜索引擎。如果您仍然不想使用 Lucene.Net，那么具有全文搜索功能的内存中[System.Data.Sqlite数据库也可以很好地工作。](http://system.data.sqlite.org/index.html/doc/trunk/www/index.wiki)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:14:30.930

将它们存储在 SQL Server 中并使用本文档中描述的方法是否有用？

[http://msdn.microsoft.com/en-us/library/ms142571.aspx](http://msdn.microsoft.com/en-us/library/ms142571.aspx)

# php - 使用 PHP 获取当前时间和日期

> ID：12717513
> 
> 赞同：-4
> 
> 时间：2012-10-03T22:01:19.757
> 
> 标签：php, date, time

> **可能重复：**
> [如何根据 ip 确定位置](https://stackoverflow.com/questions/7337692/how-to-determine-location-based-on-ip)

是否有一个 PHP 函数可以返回时间和日期，无论访客来自哪里。

它是否能够识别访客来自哪里并获取时间和日期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:26:27.777

php（服务器端）无法知道客户端的时区。此信息可用于 javascript 等客户端技术。

这可以帮助你：[https ://bitbucket.org/pellepim/jstimezonedetect](https://bitbucket.org/pellepim/jstimezonedetect)

它将客户端的时间和时区存储在一个 cookie 中，然后可以通过 php 访问该 cookie。

# c# - WPF中的禁用按钮

> ID：12717516
> 
> 赞同：0
> 
> 时间：2012-10-03T22:01:38.897
> 
> 标签：c#, xaml, wpf-controls

我正在尝试做一些非常简单和基本的事情。如我错了请纠正我：

考虑一个简单的按钮，然后与它关联的方法如下。但是，如果我在 DrawShapeCanExecute() 上更改返回类型，我会得到任何一个（禁用的按钮），那么我会收到一条错误消息：

*bool WpfApplication8.DrawingCanvas.DrawShapeCanExecute(object, System.Windows.Input.CanExecuteRoutedEventArgs)' 返回类型错误*

```
public static RoutedCommand DrawShape = new RoutedCommand();

private void DrawShapeCanExecute(object sender, CanExecuteRoutedEventArgs e)
{
    e.CanExecute = true; 
} **//Isn't this enough to make it enable?**

private void DrawShape_Executed(object sender, ExecutedRoutedEventArgs e)
{

} 
```

它的 xaml 部分有：

```
<Button Margin="0,2,2,2" Width="70" Content="Line" 
        Command="{x:Static local:DrawingCanvas.DrawShape}"
        CommandTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, 
            AncestorType={x:Type Window}}, Path=DrawingTarget}"
        CommandParameter="Line">           
</Button> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:19:49.117

您需要将事件标记为已处理：

```
e.CanExecute = true;
e.Handled = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:25:11.513

从[http://msdn.microsoft.com/en-us/library/system.windows.input.routedcommand.aspx](http://msdn.microsoft.com/en-us/library/system.windows.input.routedcommand.aspx)我看到你需要绑定 CanExecute 和 Executed 处理程序。它会是这样的：

```
<Window.CommandBindings>
    <CommandBinding Command="{x:Static local:DrawingCanvas.DrawShape }"
                Executed="DrawShape_Executed"
                CanExecute="DrawShapeCanExecute" />
</Window.CommandBindings>

<Button Margin="0,2,2,2" Width="70" Content="Line" 
    Command="{x:Static local:DrawingCanvas.DrawShape}"
    CommandTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, 
        AncestorType={x:Type Window}}, Path=DrawingTarget}"
    CommandParameter="Line">           
</Button> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T23:06:54.327

在 MainWindow.xaml.cs 中添加这个语句可以解决它：

`public IInputElement DrawingTarget { get { return _canvas; } }`

关键是我们不是在表单上而是在画布上添加菜单栏。

# ruby-on-rails - Rails find_or_create 方法和更新记录属性

> ID：12717517
> 
> 赞同：3
> 
> 时间：2012-10-03T22:01:44.433
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

如果找到记录，Rails find_or_create_by() 是否也会更新记录属性。如果没有，有没有简单的方法来查找或创建记录，如果记录已经存在；更新记录属性

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:38:14.240

听起来你想要做 a 的东西`create_or_update_by`，
这可能是这两个步骤：

```
my_app_class = ClassName.find_or_initialize_by_name(last_name, first_name).update_attributes
({
   :last_name => self.last_name,
   :first_name => self.first_name,
}) 
```

# android - Android 可选字边界正则表达式

> ID：12717518
> 
> 赞同：6
> 
> 时间：2012-10-03T22:01:50.147
> 
> 标签：android, regex, patternsyntaxexception

针对 Android 平台 2.2.3 时，我遇到了正则表达式的问题。

以下正则表达式适用于我桌面上的 Java VM，并且正则表达式也适用于 .NET 应用程序。

```
Pattern.compile("\\b?") 
```

但是当我瞄准我的手机时，我得到了一个 PatternSyntaxException。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T23:58:11.503

我可以确认这`PatternSyntaxException`在 Android 模拟器中运行时确实会抛出 a，但在常规 Java 应用程序中则不会。我不明白为什么会这样，除了 Android 中使用的正则表达式实现与普通 Java SDK 不同。从[Pattern](http://developer.android.com/reference/java/util/regex/Pattern.html) Android Developers 页面：

> Android 中使用的正则表达式实现由 ICU 提供。正则表达式的符号主要是其他 Java 语言实现中使用的符号的超集。这意味着现有应用程序通常会按预期工作，但在极少数情况下，Android 可能会接受其他实现不接受的正则表达式。

作为一种解决方法，我确实发现您可以通过将单词边界断言包含在非捕获组中来绕过异常。

```
Pattern.compile("(?:\\b)?"); 
```

（捕获组也可以，但我怀疑你需要它。）

我建议您[将此报告为错误](http://source.android.com/source/report-bugs.html)，看看您是否可以获得官方回复。（我已经搜过了，好像还没有报道。）

# javascript - 来自 png 的具有向上/向上/向下状态的 HTML 按钮

> ID：12717520
> 
> 赞同：1
> 
> 时间：2012-10-03T22:02:15.580
> 
> 标签：javascript, html, css

我的上/下/下按钮状态有三个 png 文件。

如何在html中制作这样的按钮？

寻找类似的东西：

```
<button id="myButton" upState="upstate.png" downState="downstate.png" overState="overState.png" onClick="someFunction()"/> 
```

显然这不是它的工作原理。但这就是我希望它工作的方式。制作这样一个按钮的最简单/最好的方法是什么。不允许闪光。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:04:07.747

CSS 支持活动和悬停状态，这足以满足除按钮释放之外的所有情况。

```
#myButton {
width: 90px;
height: 20px;
background: url(defaultstate.png);
}

#myButton:hover {
background: url(overstate.png);
}

#myButton:active {
background: url(downstate.png);
} 
```

您可能不需要按钮释放状态。如果按钮正在提交表单或以其他方式将访问者发送到新的浏览器页面，他们不太可能在页面开始刷新/加载之前注意到按钮释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:07:38.713

有几种方法。一般来说，CSS sprite 是理想的（也就是说，一个包含所有 3 种图形状态并仅根据当前状态移动的图像）。使用您所拥有的更简单的方法是：

```
<style type="text/css">
#myButton { width: 100px; height: 30px; background: url('upstate.png'); }
#myButton:hover { background: url('overstate.png'); }
#myButton:active { background: url('downstate.png'); }
</style> 
```

如果您想知道如何使用 sprite 方法进行此操作，请查看：[http ://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:22:28.470

添加到上面的帖子中，CSS 只会使用 [hover] 样式扩展器解决您的 [overState] 状态。

如果您熟悉 jQuery，则可以按如下方式设置正确的事件处理：

```
$('#myButton').on('mousedown', function () {
  $(this).css('background','url('downstate.png')');
})

$('#myButton').on('mousedup', function () {
  $(this).css('background','url('upstate.png')');
})

$('#myButton').on('mouseover', function () {
  $(this).css('background','url('overstate.png')');
})

$('#myButton').on('click', function () {
  alert('myButton Clicked');
}) 
```

# php - 非浏览器发送 HTTP 请求和 PHP 会话

> ID：12717522
> 
> 赞同：1
> 
> 时间：2012-10-03T22:02:32.477
> 
> 标签：php, http, session, client-side

PHP 是否能够与不使用浏览器与服务器通信的设备保持会话？我知道任何应用程序都能够遵守 HTTP 协议，但是对于 Actionscript3 和 Java 等在其框架中包含 HTTP 请求类的语言，它们是否像使用浏览器一样发送必要的参数让 PHP 保持会话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:06:14.777

任何 HTTP 客户端库*都可以*支持 cookie（这是 PHP 默认跨请求维护会话令牌状态的方式）。有些会自动处理 cookie，有些会要求在首选项中打开它，有些只会提供一个 API 来访问标头（包括 cookie）。

# php - codeigniter 中的管理页面

> ID：12717526
> 
> 赞同：0
> 
> 时间：2012-10-03T22:02:51.477
> 
> 标签：php, codeigniter

我在应用程序\控制器中创建了一个文件夹 abc。

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Acc_controller extends CI_Controller {

    public function index()
    {

        $this->load->view('abc/index1');

    }
} 
```

之后，我在 view\abc 中创建了文件。我将其命名为 index1.php

```
<li> Mauris risus tellus, sodales quis, sagittis vitae, molestie sed,
nunc. Fusce ornare, turpis vel rutrum blandit, enim diam aliquet purus,
vel accumsan risus enim sit amet nisl. Ut fringilla ornare libero. Nunc
sodales. </li> 
```

问题是我无法访问此文件。但是当我将控制器文件从 abc 文件夹中放到控制器文件夹中时，它就可以工作了。如果我将它放在控制器文件夹中的任何新文件夹中，为什么它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T04:11:17.880

CodeIgniter默认[支持这一点](http://codeigniter.com/user_guide/general/controllers.html#subfolders)——它在多个级别上都失败了，所以你只能深入一个文件夹。

确保您通过首先调用 URL 中的文件夹来访问控制器：

`http://localhost/yourapp/abc/acc/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:51:38.840

此链接可以帮助您：

[http://codeigniter.com/forums/viewthread/190563/](http://codeigniter.com/forums/viewthread/190563/)

不久前我遇到了这个问题，但它是一个稍早的版本。我最终扩展了加载器类并让它按预期工作。不应该太难，你不需要弄乱路由或 htaccess。MY_Loader 类应该足够了。

# wsdl - ServiceStack WSDL 错误。Endpoint 与 Windows 应用商店应用程序不兼容。跳过...

> ID：12717527
> 
> 赞同：3
> 
> 时间：2012-10-03T22:02:53.233
> 
> 标签：wsdl, windows-8, microsoft-metro, servicestack, svcutil.exe

使用 Windows 8（metro 风格）应用程序，并希望从中引用由 ServiceStack 托管的服务。由于我无法使用 ServiceStack 提供的 C# 客户端对象（无法从 Windows 8 项目中引用 DLL），我想我必须退回到使用 svcutil 或从 VS 2012 中添加服务引用。当我这样做时，我收到以下错误：

警告 5 自定义工具警告：地址“http://localhost/ServiceStackRD/soap12”的端点“WSHttpBinding_ISyncReply”与 Windows 应用商店应用程序不兼容。跳过... C:\Development\GridPresenter\GridPresenter\Service References\ServiceReference2\Reference.svcmap 1 1 GridPresenter

有人知道是什么让端点“与 Windows 应用商店应用程序不兼容”吗？如果是这样，我如何告诉 ServiceStack 修改端点定义以使其与 Windows 8 应用程序配合得很好？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:16:42.870

SOAP 和 WSDL 在任何新平台上都是一个丑陋的解决方案，您必须获得太多的活动部件才能使其正常工作。

阻力最小的路径是使用支持 Windows 8 Metro 应用程序的 C# HTTP 客户端，并仅解析从 ServiceStack 的 JSON 服务返回的 JSON。这是使用ServiceStack.Text中的[这些 WebRequest 扩展](https://github.com/ServiceStack/ServiceStack.Text/blob/master/src/ServiceStack.Text/WebRequestExtensions.cs)[解析 GitHub 的 3rd 方 API 的示例。](https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GithubV3ApiTests.cs)

社区尚未贡献 ServiceStack.Text 的 Windows 8/Metro 应用程序版本，因此您可能不得不使用另一个支持它的 JSON 序列化程序。

# php - 如何从表单、php 或 jquery 生成查询字符串（url）？

> ID：12717529
> 
> 赞同：0
> 
> 时间：2012-10-03T22:03:11.867
> 
> 标签：php, jquery, forms, url

我正在尝试从下面的表单中生成一个特定的 url。会有一个日历，日期将进入网址。也是来自 9 种票类型和每张票的数量的值。所以我的网址看起来像这样

[https://sales.site.com/?action=quicksale&venueid=1&businessdate=2012-10-05&ticketids=6,8&quantities=1,1](https://sales.site.com/?action=quicksale&venueid=1&businessdate=2012-10-05&ticketids=6,8&quantities=1,1)

使用这些值：action：总是“quicksale”，venueid：总是“1”，businessdate：请求的销售日期；可以是 mm-dd-yyyy 或 yyyy-mm-dd，ticketids：见下表，数量：按ticketid 列出的顺序。

我将如何解决这个问题，我应该使用 php 还是 jquery？发布或获取。日历应该是 Jquery 吗？

求建议，谢谢

```
 <form method="post" action="">-->
            <div class="quick-book-form-elements">
                <table width="255" class="quick-book-table" cellpadding="4">
                    <tbody>
                        <tr class="quick-book-days">
                            <th>&nbsp;</th>
                            <th><img src="../public/img/1day-small.png" alt="" /></th>
                            <th><img src="../public/img/2day-small.png" alt="" /></th>
                            <th class="quick-book-last"><img src="../public/img/3day-small.png" alt="" /></th>
                        </tr>

                        <tr class="quick-book-adults">
                            <th class="quick-book-labels">
                                Adult
                            </th>
                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$40/ea</span>
                                </div>
                            </td>

                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$50/ea</span>
                                </div>
                            </td>
                            <td class="quick-book-last">
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$60/ea</span>
                                </div>
                            </td>
                        </tr>

                        <tr class="quick-book-child">
                            <th class="quick-book-labels">Child</th>
                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$30/ea</span>
                                </div>
                            </td>
                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$40/ea</span>
                                </div>
                            </td>
                            <td class="quick-book-last">
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$50/ea</span>
                                </div>
                            </td>
                        </tr>

                        <tr class="quick-book-family">
                            <th class="quick-book-labels">Family</th>
                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$125/ea</span>
                                </div>
                            </td>
                            <td>
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$155/ea</span>
                                </div>
                            </td>
                            <td class="quick-book-last">
                                <div class="ticket-style-quick-book">
                                    <select class="adult-ticket-select">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                    </select>
                                    <span class="quick-book-price">$185/ea</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        <a href="http://sales.site.com/" title="" class="quick-book-submit-btn"></a>
        <input type="submit" class="quick-book-submit-btn" name="quick-book-submit-btn" value="" />
    </form>
</div><!-- end quick-book-form div --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:30:25.183

对于日历，确实可以使用 jQuery-ui 之一。这是一个很好的小部件，易于配置且非常强大。

[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)

您可以将其配置为将您想要的格式放入输入中（例如 YYYY-MM-DD）

最后，您应该在提交事件上添加一个侦听器，以执行您的操作修改：

```
// This function will be call before the submit
$("#YOUR_FORM_ID").submit(function(submitEvent) {

    // Initialize the query param array
    var queryParams = [];

    // Fill the query param with values
    queryParams.push("action=quicksale");
    queryParams.push("venueid=1");
    queryParams.push("businessdate=" + $("#YOUR_INPUT_DATE_ID").val());
    // etc...

    // Finally update the form action
    $(this).attr('action', 'https://sales.site.com/?' + queryParams.join("&"));

    // The action has been updated
    // The submit will process
}); 
```

# wcf - 使用本地 SMTP 中继从 IIS 7 发送电子邮件

> ID：12717532
> 
> 赞同：1
> 
> 时间：2012-10-03T22:03:41.803
> 
> 标签：wcf, iis-7, smtp

我正在使用 Windows Server 2008 R2 和 IIS 7.5.7600 所以我已经安装了 SMTP 服务并且它正在运行。我已经使用以下 powershell 脚本测试了它是否可以工作：

```
$emailFrom = "user@yourdomain.com"
$emailTo = "user@yourdomain.com"
$subject = "your subject"
$body = "your body"
$smtpServer = "your smtp server"
$smtp = new-object Net.Mail.SmtpClient($smtpServer)
$smtp.Send($emailFrom, $emailTo, $subject, $body) 
```

电子邮件使用“localhost”作为服务器发送。

但是，在配置 WCF 服务的 web.config 之后：

```
<system.net>
  <mailSettings>
    <smtp deliveryMethod="Network" from="user@yourdomain.com">
      <network
        host="localhost"
        port="25" 
      />
    </smtp>
  </mailSettings>
</system.net> 
```

当我的代码调用时，我收到一个通用的无意义错误：

```
var mail = new MailMessage();
mail.To.Add("user@yourdomain.com");
mail.Subject = "[Smtp Client] TEST";
mail.Body = "TEST";
mail.IsBodyHtml = false;
var smtpMail = new SmtpClient();
smtpMail.Send(mail); 
```

我得到：

```
Failure sending mail.

    at System.Net.Mail.SmtpClient.Send(MailMessage message) 
```

我不知道还要检查什么？是的，我已经在服务器上安装了应用程序服务器角色。是的，WCF 服务工作正常，我的所有其他代码都按预期运行，只有电子邮件发送失败。似乎 IIS 和本地 SMTP 中继之间存在一些断开连接，但我找不到任何讨论这个特定问题的内容（只有那些无法启动和运行 smtp 或无法整理他们的配置的人） .

感谢您的时间和关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T00:27:08.880

所以答案原来是使用元数据库的权限。我之前发现过这个，但我之前遇到的来源只说授予 LM\SMTPSVC 路径的读取权限，并没有提到 LM\SMTPSVC\1 （我认为权限会级联到子文件夹/路径） . 更详细的解释见下文：

取自[这里](http://forums.iis.net/t/1164349.aspx)。

在 2008/IIS7+ 中，ApplicationPoolIdentity 帐户是具有动态分配 SID（在 ApplicationPool 启动时创建和分配）的隐藏帐户。但是这些帐户作为（隐藏）用户存在于本地计算机上的 IIS_IUSRS 组下（这使得他们非常容易获得 AppPools 的权限，因为您可以使用普通的 GUI 界面进行 perms 或在指定本地用户组时使用脚本）。要解决在 IIS7.5 下运行的 ASP 站点无法发送电子邮件的问题：

1.  将 IIS_IUSRS 组的读/写权限授予 Mailroot 文件夹（权限将继承到 Pickup/etc 文件夹）。
2.  现在使用 Metabase Permissions 修改器（Metabase Explorer 有效，2003 年的 METAACL.VBS 也有效），打开 LM\SMTPSVC 和 SMTPSVC\1 并将具有读取权限的 IIS_IUSRS 添加到配置数据库的这些分支。

    cscript metaacl.vbs IIS://LOCALHOST/SMTPSVC %computername%\IIS_IUSRS R cscript metaacl.vbs IIS://LOCALHOST/SMTPSVC/1 %computername%\IIS_IUSRS R

这些权限将允许任何 ApplicationPoolIdentity 用户使用本地 SMTP 服务创建和发送电子邮件。这可以通过停止本地计算机上的 SMTP 服务进行测试，这将强制 .EML 文件显示在 mailroot\pickup 文件夹中。发送电子邮件适用于 NetworkService 和 LocalService 而不是 ApplicationPoolIdentity 的原因是 Metabase 默认具有 SYSTEM 和 NetworkService 的读取权限。这是另一个示例，说明为什么将 AppPools 作为 ApplicationPoolIdentity 运行比作为 NetworkService 运行提供更高的安全性：应用程序必须被赋予对其必须读取或写入的任何注册表项、文件夹层次结构、文件等的显式权限。

# mysql - Mysql 案例和更新

> ID：12717538
> 
> 赞同：0
> 
> 时间：2012-10-03T22:04:08.300
> 
> 标签：mysql

我正在尝试执行这个查询，它只更新第一列是空的。到目前为止，这是一个查询：

```
UPDATE `names` SET 
`name_1` = CASE WHEN `name_1` = '' then 'Jimmy' else `name_1` end,
`name_2` = CASE WHEN `name_1` != '' and `name_2` = '' then 'Jimmy' else `name_2` end 
```

它使用“Jimmy”更新所有列。我认为那是因为 SET 会更新它然后继续下一个 SET 并会更新它等等......我对导致这种情况的原因是正确的吗？如果是这样，我该如何解决？如果不是我应该如何重写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:30:59.447

我认为如果您交换订单，它将正常工作。

试试这个：

```
UPDATE `names` SET 
`name_2` = CASE WHEN `name_1` != '' and `name_2` = '' then 'Jimmy' else `name_2` end,
`name_1` = CASE WHEN `name_1` = '' then 'Jimmy' else `name_1` end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:20:47.370

我想知道空值是否会导致您出现问题。您可以使用 IFNULL 函数将它们转换为空字符串（如果您有空字符串和 NULL）。试试这个：

```
UPDATE `names` SET 
    `name_1` = CASE WHEN IFNULL(`name_1`, '') = '' then 'Jimmy' else `name_1` end,
    `name_2` = CASE WHEN IFNULL(`name_1`, '') != '' and IFNULL(`name_2`, '') = '' then 'Jimmy' else `name_2` end 
```

或者如果你有所有空值：

```
UPDATE `names` SET 
    `name_1` = CASE WHEN `name_1` IS NULL then 'Jimmy' else `name_1` end,
    `name_2` = CASE WHEN `name_1` IS NOT NULL and `name_2` IS NULL then 'Jimmy' else `name_2` end 
```

# shopify - 访问集合模板中的变体选项

> ID：12717547
> 
> 赞同：0
> 
> 时间：2012-10-03T22:05:27.613
> 
> 标签：shopify

我正在开发一个 shopify 应用程序，并且我正在构建一个过滤系统，以通过收集页面中的变体（即颜色、尺寸等）的可用性来过滤产品。

我将变体放入集合页面上的隐藏跨度标记中，但它始终返回信息哈希，而不是变体名称。

跨度标签：

```
<span>
    {% for variant in product.variants %}
       {{ variant }}
    {% endfor %}
</span> 
```

但是，它不会返回诸如“红色”、“黑色”、“蓝色”之类的有用信息，而是返回以下内容：

```
<span>
  "#"
  <productvariantdrop:0x00000003dee880></productvariantdrop:0x00000003dee880>
</span> 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:55:05.523

简单的。{{variant}} 是一个对象。显然是**productvariantdrop**类型。如果您想要变体选项，则必须深入挖掘并通过选项上的迭代器公开它们。**有关变体**的信息，请参阅文档以告诉您更多信息。示例[http://docs.shopify.com/api/product_variant](http://docs.shopify.com/api/product_variant)和 variant.options。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-27T20:45:34.510

使用 {{ variant.title }} 获得红色、绿色等选项标题和 {{ variant | json }} 打印一个完整的转储

# mysql - MongoDB vs Mysql 存储空间比较

> ID：12717551
> 
> 赞同：3
> 
> 时间：2012-10-03T22:05:42.483
> 
> 标签：mysql, mongodb, storage

我正在构建一个超过 15 TB 的数据仓库。虽然存储很便宜，但由于预算有限，我们必须将尽可能多的数据压缩到该空间，同时保持性能和灵活性，因为数据格式经常变化。

我尝试将 Infobright（社区版）作为 SQL 解决方案，它在存储和性能方面表现出色，但对数据/表更改的限制使其几乎不行。infobright 对企业版的定价非常高。

在检查了 MongoDB 之后，除了一件事之外，它似乎很有希望。我在和一个 10gen 的人聊天，他说他们并没有真正考虑存储空间，因为他们将数据扁平化以实现性能和灵活性，而且他们认为存储太便宜了现在要打扰了。

因此，任何有经验的 mongo 用户都可以评论其存储空间与 mysql 的对比（因为它是我们现在比较的标准）。如果它更大或更小，你能给出粗略的比例吗？我知道这种情况取决于您在 SQL 中放入的数据类型以及您如何定义字段、索引等......但我只是想得到一个大致的想法。

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T09:23:51.157

MongoDB 没有针对小磁盘空间进行优化——正如您所说，“磁盘很便宜”。

根据我所见和阅读的内容，很难估计所需的磁盘空间，原因是：

*   填充文档以允许就地更新
*   属性名称存储在每个集合中，因此使用缩写可能会节省很多
*   没有内置压缩（目前）
*   ...

恕我直言，一般方法是构建原型、插入数据并查看您的特定用例需要多少磁盘空间。您可以对查询（插入和更新）进行建模的越真实，结果就会越好。

有关更多详细信息，请参阅[http://www.mongodb.org/display/DOCS/Excessive+Disk+Space](http://www.mongodb.org/display/DOCS/Excessive+Disk+Space)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-04-08T10:26:41.067

**MongoDB的优点和缺点**

在大多数情况下，用户似乎喜欢 MongoDB。对 TrustRadius 的评论给面向文档的数据库 8.3 星（满分 10 星）。

经过身份验证的 MongoDB 用户说他们喜欢该数据库的一些事情包括：

*   可扩展性。
*   可读的查询。
*   无 SQL。
*   更改流和图形查询。
*   用于更改数据元素的灵活模式。
*   快速查询时间。
*   无模式数据模型。
*   简易安装。

用户对 MongoDB 也有负面评价。经过身份验证的用户报告的一些缺点包括：

*   用户界面，具有相当陡峭的学习曲线。
*   缺少连接，这会使一些数据检索项目变得困难。
*   云环境中偶尔出现缓慢。
*   高内存消耗
*   结构不良的文档。
*   缺乏内置分析。

**MySQL的优点和缺点**

MySQL 在 TrustRadius 上的评分略高于 MongoDB（10 颗星中的 8.6 颗星）。尽管评分较高，但经过身份验证的用户仍然提到了选择 MySQL 的许多优点和缺点。

用户经常提到的一些积极特性包括 MySQL：

*   使其轻松连接到辅助数据库的可移植性。
*   存储关系数据的能力。
*   速度快。
*   卓越的可靠性。
*   卓越的数据安全标准。
*   用户友好的界面，可帮助初学者完成项目。
*   易于配置和管理。
*   快速处理。

当然，即使是喜欢使用 MySQL 的人也会发现他们不喜欢的特性。他们的一些抱怨包括：

*   依赖 SQL，这为不懂该语言的用户创造了更陡峭的学习曲线。
*   缺乏对 InnoDB 表中全文搜索的支持。
*   偶尔的稳定性问题。
*   对附加功能的依赖。
*   微调和公用表表达式的限制。
*   一些复杂数据类型的困难。

**MongoDB 与 MySQL 性能对比**

在比较 MongoDB 和 MySQL 的性能时，您必须根据具体情况考虑每个数据库将如何影响您的项目。尽管某些性能特性在客观上看起来很有希望，但您的团队成员可能永远不会使用最初将您吸引到数据库的特性。

**MongoDB 性能**

许多人声称 MongoDB 优于 MySQL，因为它允许他们以多种方式创建查询。换句话说，MongoDB可以在不了解SQL的情况下使用。虽然灵活性提高了某些组织的 MongoDB 性能，但 SQL 查询对于其他组织就足够了。

MongoDB 还因其处理大量非结构化数据的能力而受到赞誉。根据您收集的数据类型，此功能可能非常有用。

MongoDB 不会将您绑定到单一供应商，让您可以自由地提高其性能。如果供应商未能为您提供出色的客户服务，请寻找另一家供应商。

**MySQL 性能**

MySQL 非常适合需要可以将信息存储在多个表中的开源关系数据库的团队。但是，您获得的性能取决于您配置 MySQL 数据库的程度。配置应根据预期用途而有所不同。例如，电子商务网站可能需要与研究科学家团队不同的 MySQL 配置。

无论您打算如何使用 MySQL，全文索引、高速事务系统和防止丢失关键信息或工作的内存缓存都可以提高数据库的性能。

如果您没有从 MySQL 数据仓库和数据库中获得预期的性能，您可以通过将它们与出色的 ETL 工具集成来提高性能，该工具使数据存储和操作比以往任何时候都更容易。

**MySQL vs MongoDB 速度**

在 MySQL 和 MongoDB 之间的大多数速度比较中，MongoDB 是明显的赢家。MongoDB 在接受大量非结构化数据方面比 MySQL 快得多。在处理大型项目时，很难说 MongoDB 比 MySQL 快多少。您获得的速度取决于许多因素，包括互联网连接的带宽、您所在位置与数据库服务器之间的距离以及您组织数据的程度。

如果其他条件相同，MongoDB 应该能够比 MySQL 更快地处理大型数据项目。

**在 MySQL 和 MongoDB 之间进行选择**

您选择 MySQL 还是 MongoDB 可能取决于您计划如何使用您的数据库。

**选择 MySQL**

对于需要强大的关系型数据库管理系统的项目，例如以表格格式存储数据，MySQL 可能是更好的选择。对于需要数据安全性和容错性的情况，MySQL 也是一个不错的选择。如果您拥有长期收集的高质量数据，MySQL 是一个不错的选择。

请记住，要使用 MySQL，您的团队成员需要了解 SQL。如果他们还不知道该语言，您需要提供培训以使他们加快速度。

**选择 MongoDB**

当您想使用 SQL 以外的数据集群和搜索语言时，MongoDB 可能是更好的选择。任何知道如何用现代语言编写代码的人都可以开始使用 MongoDB。MongoDB 还擅长快速扩展，允许多个团队协作，并以多种格式存储数据。

因为 MongoDB 不使用数据表来简化浏览，所以有些人可能很难理解存储在那里的信息。随着时间的推移，用户会逐渐习惯 MongoDB 面向文档的存储系统。

# php - Facebook API 不会注销

> ID：12717553
> 
> 赞同：0
> 
> 时间：2012-10-03T22:06:00.657
> 
> 标签：php, facebook

索引.php：

```
blablabl
<?php include("fb-api/****-api.php"); ?>
blablabal
    <?php if ($user): ?>
      <a href="<?php echo $logoutUrl; ?>">Logout</a>
    <?php else: ?>
      <div>
        <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
      </div>
    <?php endif ?> 
```

* *** -api.php：

```
<?php

require 'src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => '******',
  'secret' => '***********',
));
$user = $facebook->getUser();
    if ($user) {
      $logoutUrl = $facebook->getLogoutUrl();
    } else {
      $loginUrl = $facebook->getLoginUrl();
    }

?> 
```

链接：http://music.x-game.info/ 好的，我登录没有任何问题，但是当我按下注销链接时它并没有注销我，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T09:14:11.937

而不是使用 facebook->getlogouturl 将用户重定向到另一个文件：logout.php 并包含以下内容：

```
 <?php
  $facebook->destroySession();
  session_destroy();
  ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:09:45.640

注销后，用户进入您的主页并自动登录，因为 $user 变量将被设置。

您可以使用数据库来控制登录/注销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T08:56:52.563

在创建注销 URL 时将 redirect_uri 设置为`http://yourdomain.tld/logout.php`.

在该脚本中，首先再次初始化 Facebook SDK，调用它的`destroySession`方法，然后调用 PHP 自己的`session_destroy`.

然后重定向到您的起始页或其他任何内容。

# entity-framework - 从现有 SQL 表快速创建模型类

> ID：12717557
> 
> 赞同：0
> 
> 时间：2012-10-03T22:06:28.973
> 
> 标签：entity-framework

我在具有现有数据库的项目中使用 EF Code First，一切运行良好，到目前为止，我一直在手动为每个表创建类（因为它们非常小），但是要使用更大的表，我只能假设必须以某种方式将表字段“导入”或“转换”为类的更好方法。搜索了一下，并没有真正找到我要找的东西。

为了澄清我想保留它的代码优先。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T08:44:42.023

[EF Power Tools](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)包含用于此目的的[逆向工程功能。](http://blogs.msdn.com/b/adonet/archive/2012/04/09/ef-power-tools-beta-2-available.aspx)

# css - 使用 br 或 div 进行分节符

> ID：12717565
> 
> 赞同：12
> 
> 时间：2012-10-03T22:07:11.543
> 
> 标签：css, layout, html

我在几个地方工作过，看到了两种在 HTML 中进行分节或换行的不同方法。

我见过的一种方法是这样的：

```
<div class="placeholder-100pct">&nbsp;</div> 
```

而另一个只是使用普通的 old `<br />`。

对一个比另一个有什么好处，还是只是风格问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-03T22:14:37.057

`<br/>`当您想要在段落中换行时使用，如下所示：

```
<p>Hi Josh, <br/> How are you?</p> 
```

这在写入地址时可能很有用：

```
<p>John Dough<br/>
1155 Saint. St. #33<br/>
Orlando, FL 32765
</p> 
```

使用 div 会自动给你一个新行，但如果你想要两个元素之间的空间，你可以在 div 上使用一个边距。

**不要**用于`<br/>`在两个 div 之间获得一些空间：

```
<!-- This is not preferred -->
<div>Hello</div>
<br/>
<div>Something else here</div> 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-03T22:09:41.063

div 是一个通用容器。br 是*换行符*。两者都不是特别适合表达分节符。

HTML 5 引入了[部分](http://www.w3.org/TR/html5/the-section-element.html#the-section-element)。您标记每个部分，而不是它们之间的中断。

```
<section>
  <!-- This is a section -->
</section>
<section>
  <!-- This is another section -->
</section> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T22:10:07.887

在语义上有意义时使用 <br />。如果您只需要换行符，那就是它的用途。如果您尝试拆分不同类型内容的部分，则每个部分都应位于自己的容器中。例如，如果您有一个地址，地址的每一行都将显示在单独的行上，那么这样做是有意义的：

```
<address>
123 Main Street<br />
Anywhere, USA 12345
</address> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-03T22:10:20.970

一个明显的区别是它`<br>`是内联元素，而`<div>`不是。

所以这：

```
<span>Some text broken into <br /> lines</span> 
```

... 是有效的 HTML 代码，而这：

```
<span>Some text broken into <div>&nbsp;</div> lines</span> 
```

... 不是，因为您不能将块元素放在内联元素中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-03T22:15:39.303

`<br>`缺点是将部分之间的间隙大小限制为`<span>`它所在的应用或继承的行高。

换句话说，使用 时`<br>`，中断的大小*只能*是一行文本的高度。

*如果您想保留对间距的任何控制，请务必将每个*“部分”包装在它们自己的标签中，并使用边距来控制间距。区别不仅仅在于标记的语义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-14T14:32:34.973

如果您希望在主题中断的意义上在两个内容部分之间提供中断，那么`<hr>`您应该使用该元素。

[W3C 规范](https://www.w3.org/TR/html52/grouping-content.html#the-hr-element)

> hr 元素表示段落级别的主题中断，例如，故事中的场景变化，或参考书部分中到另一个主题的过渡。

根据需要设计这些样式也相对简单，因为它们可以采用您需要的任何尺寸。但是请注意，它是一个 void 元素，不能包含内容（尽管您当然可以根据需要为其添加背景图像）。

# excel - Excel 脚本使用从前一个单元格的逻辑决策派生的值填充相邻单元格

> ID：12717570
> 
> 赞同：0
> 
> 时间：2012-10-03T22:07:58.840
> 
> 标签：excel, vba, scripting

我有一个小型电子表格，其中有一列标题为“CAT”。根据“CAT”中的值，我想在“CAT”旁边插入另一个名为“WHEEL NUMBER”的列。“CAT”值有七个可能的值（CAR、VAN、HARLEY、HUFFY、TRICYCLE、XCYCLE、BUS）。这是我的基本文件：

```
Number  CAT       Description
234     CAR       Family
324     VAN       Happy Family
342     HARLEY    Happy Dad
456     HUFFY     Happy Kid
653     TRICYCLE  Happy Child
543     XCYCLE    Blah Blah
563     BUS       School Stuff
765     CAR       New Family
675     CAR       Big Family
576     HUFFY     Kid Stuff 
```

当我运行完这个脚本后，我想看看：

```
Number  CAT  Wheel Number   Description
234 CAR   Wheel4    Family
324 VAN   Wheel4    Happy Family
342 HARLEY    Wheel2    Happy Dad
456 HUFFY     Wheel2    Happy Kid
653 TRICYCLE  Wheel3    Happy Child
543 XCYCLE    Wheel3    Blah Blah
563 BUS   Wheel6    School Stuff
765 CAR   Wheel4    New Family
675 CAR   Wheel4    Big Family
576 HUFFY     Wheel2    Kid Stuff 
```

基本上，我创建了“WHEEL NUMBER”列，并将 (CAR|VAN) 的“WHEEL4”或 (HARLEY|HUFFY) 的“WHEEL2”或 (TRICYCLE|XCYCLE) 的“WHEEL#”插入到我的新电子表格单元格中。

任何朝着正确方向的踢都将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:42:51.113

我同意@TimWiliams - 如果可能，请尝试使用公式并避免使用 VBA。但是，如果您需要针对您的情况的脚本，您可以试试这个：

```
Sub AddColumn()

    ' Turn off screen updating/calculating
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual

    ' Shift the column
    Columns("C:C").Insert shift:=xlToRight

    ' Name the new column
    Range("C1").Value = "Wheel Number"

    ' Activate the next cell and start populating
    Range("C2").Activate

    ' Use column A (the Number column) to determine the length
    ' of the data (this can be accomplished in other ways)
    ' Depends on there being no blank values in column A
    For i = 1 To Range("A1").End(xlDown).Row - 1
      ' Add the correct value based on the value in column B
      Select Case ActiveCell.Offset(0, -1).Value
        Case "HARLEY", "HUFFY"
          ActiveCell.Value = "Wheel2"
        Case "TRICYCLE", "XCYCLE"
          ActiveCell.Value = "Wheel3"
        Case "CAR", "VAN"
          ActiveCell.Value = "Wheel4"
        Case "BUS"
          ActiveCell.Value = "Wheel6"
      End Select

      ' Go to the next cell
      ActiveCell.Offset(1).Activate

    Next i

    ' Turn screen updating/calculating back on
    Range("A1").Activate
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic

End Sub 
```

# scrapy - 尝试使用 easy_install osx 10.8 安装 scrapy 时出错

> ID：12717577
> 
> 赞同：2
> 
> 时间：2012-10-03T22:09:18.100
> 
> 标签：scrapy, osx-mountain-lion, easy-install

（这里是新手）我一直在尝试使用easy_install安装scrapy，但出现以下错误：

```
 Ben$ easy_install -U Scrapy
    Searching for Scrapy
    Reading http://pypi.python.org/simple/Scrapy/
    Reading http://scrapy.org
    Best match: Scrapy 0.14.4
    Processing Scrapy-0.14.4-py2.7.egg
    Scrapy 0.14.4 is already the active version in easy-install.pth
    Installing scrapy script to /Library/Frameworks/Python.framework/Versions/2.7/bin

    Using /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Scrapy-0.14.4-py2.7.egg
    Processing dependencies for Scrapy
    Searching for lxml
    Reading http://pypi.python.org/simple/lxml/
    Reading http://codespeak.net/lxml
    Best match: lxml 2.3.6
    Downloading http://lxml.de/files/lxml-2.3.6.tgz
    Processing lxml-2.3.6.tgz
    Running lxml-2.3.6/setup.py -q bdist_egg --dist-dir /var/folders/j1/l3w7_q554b3fkk3xyw_998nc0000gn/T/easy_install-w5NqEl/lxml-2.3.6/egg-dist-tmp-6MyEeO
    Building lxml version 2.3.6.
    Building without Cython.
    Using build configuration of libxslt 1.1.26
    unable to execute gcc-4.0: No such file or directory
    error: Setup script exited with error: command 'gcc-4.0' failed with exit status 1 
```

知道我在这里缺少什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:04:34.940

先安装GCC；最简单的方法是通过[https://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)。安装 GCC 后，再次运行 easy_install。

# jquery - 如何仅定位具有相同父级的元素

> ID：12717582
> 
> 赞同：-1
> 
> 时间：2012-10-03T22:09:35.777
> 
> 标签：jquery

我正在为 wordpress 创建自己的小部件。我有以下代码：

```
jQuery("body").on("change", "select[id=elementselect]", function(){  
    var val = jQuery(this).val();
    jQuery('#element1,element2').hide().filter('#element'+val).fadeIn('slow')
}) 
```

该代码运行良好，但如果用户在侧边栏中有两个或更多小部件，它将影响所有小部件。由于它们基于一个类，因此我无法为小部件中的元素提供唯一名称。那么，是否可以仅针对与我当前使用的“选择”元素共享相同父元素的元素？

HTML 看起来像这样（简化）：

```
<form>
  <fieldset>
    <select id="elementselect">
      <option value="1"></option>
      <option value="2"></option>
    </select>
  </fieldset>

  <fieldset id="element1"></fieldset>

  <fieldset id="element2"></fieldset>
</form> 
```

还是有其他解决方案？

编辑：我现在已经修好了。只需将 id 更改为 classes 并使用 .closest()

谢谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:20:35.650

不完全确定您的问题是什么，但是要获得元素兄弟姐妹，您可以这样做：

```
var $siblings = $('#childElement').siblings(); 
```

[http://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:25:47.173

也许这会有所帮助...

这是一个 JS Fiddle 示例，它显示了 jQuery 方法`parent()`、`children()`和如何`siblings()`处理事件：http: [//jsfiddle.net/phillipkregg/GWCyL/](http://jsfiddle.net/phillipkregg/GWCyL/)

代码很简单：

```
$("#parent_div p").on("click", function() {
    console.log($(this).parent().children().siblings())

}); 
```

单击 div 中的段落元素会到达其父级 - div - 然后查找其子级 - p 标签 - 然后记录段落标签的兄弟姐妹。

# jquery - 选择下一个元素内的元素

> ID：12717593
> 
> 赞同：0
> 
> 时间：2012-10-03T22:10:21.753
> 
> 标签：jquery, jquery-selectors

我需要选择每个`$('div span:eq(0)').text()`inside `$('div#first')`。如何将这两个选择器串在一起？

```
<div id="first">Some stuff to be ignored.</div>
<div>
  <div>
    <ul>
      <li>
        <span>Some text</span> <!-- need this -->
        <span>Skipped text</span>
      </li>
    </ul>
  </div>
  <div>
    <ul>
      <li>
        <span>Some text</span>  <!-- and this -->
        <span>Skipped text</span>
      </li>
    </ul>
  </div>
  <!-- this pattern continues unknown # of times -->
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:13:58.493

尝试使用`li`而不是`div`.

```
// Using #first.next()-v as #first just has a &nbsp;
$('li', $('#first').next()).find('span:eq(0)').text('Updated text'); 
```

**演示：http:** [//jsfiddle.net/rFUB8/1/](http://jsfiddle.net/rFUB8/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:13:12.503

```
$('div span:eq(0)', 'div#first').text() 
```

或者，如果您想一次处理一个：

```
$('div span:eq(0)', 'div#first').each(function() {
  console.log($(this).text());
}); 
```

如果您正在谈论将这些跨度放在“div#first”中，您可以使用：

```
$('div#first').append($('div span:eq(0)')); 
```

# android - android如何为片段按钮设置OnClickListener

> ID：12717596
> 
> 赞同：4
> 
> 时间：2012-10-03T22:10:37.100
> 
> 标签：android, nullpointerexception, fragment

我有一个活动和一个片段。片段上有一个按钮。

我加载片段：

```
fragment = new FragmentPIN(this);                   
fragmentTransaction.add(R.id.content,fragment);         
fragmentTransaction.commit(); 
```

然后尝试设置监听器

```
@Override
public void onAttach(Activity activity) {
    super.onAttach(activity);
    try {

        Button cmdOK_PIN = (Button)activity.findViewById(R.id.cmdOK_PIN);
        cmdOK_PIN.setOnClickListener(new View.OnClickListener() {                       
            @Override
            public void onClick(View v) {

            }

        });

    } catch (ClassCastException e) {
        e.printStackTrace();
    }
} 
```

但是我总是在 setOnClickListener 调用上得到一个空指针异常。在我尝试设置侦听器之前，已提交片段事务。或者我认为是。我应该使用另一个覆盖来执行此操作吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T22:51:22.013

尝试更改将侦听器设置为的位置，`onActivityCreated`而不是`onAttach`. 根据 Android[文档](http://developer.android.com/reference/android/app/Fragment.html#onActivityCreated%28android.os.Bundle%29)：

> onActivityCreated 在片段的活动被创建并且这个片段的视图层次被实例化时被调用。

当您`onAttach`在 Activity 设置其视图之前调用它时

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-28T09:03:48.917

嗨，我是 android 新手，当我动态添加一些按钮时，我遇到了 nullpointer 异常。Fragment 还有一个可以覆盖的方法 onViewCreated。从它的名字猜测你可以确定视图在那里:)

```
@Override
public void onViewCreated(View view, Bundle savedInstanceState) {

    super.onViewCreated(view, savedInstanceState);
    } 
```

# python - Python：TypeError：float() 参数必须是字符串或数字

> ID：12717603
> 
> 赞同：0
> 
> 时间：2012-10-03T22:11:08.623
> 
> 标签：python, file

我需要编写一个 python 脚本来对文本文件中的十进制数求和（一行，一个数字）。我写了这个脚本：

```
s = float()
f = open('/home/ale/file_numbers', 'r').readlines()
N = len(f)-1
for i in range(0,N):
    s += float(f) 
```

但问题出在指令上， `s += float(f)` 实际上返回的错误是：

```
TypeError: float() argument must be a string or a number 
```

我不知道如何解决这样的问题有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:13:31.830

这将返回行列表（顾名思义）：

```
open(...).readlines() 
```

但是您可以直接遍历行：

```
s = float()
f = open('/home/ale/file_numbers', 'r')
for line in f:
    s += float(line) 
```

而且，以防万一，如果您`.close()`在打开文件后没有打开文件，则可以使用以下代码：

```
s = float()
with open('/home/ale/file_numbers') as f:
    for line in f:
        s += float(line) 
```

这是因为：

*   `with`语句处理自动退出嵌套块后关​​闭文件，
*   您可以简单地遍历打开的文件，在每次迭代中获取一行（以换行符结尾），
*   默认`mode`为`open()`“ `r`”，所以你可以省略它，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:13:10.560

想想`readlines`. 它不是字符串，而是字符串列表。

您需要以某种方式从文件中选择一个字符串，或者遍历所有行。

```
s += float(f[0]) 
```

# matlab - MATLAB：具有单变量高斯的朴素贝叶斯

> ID：12717607
> 
> 赞同：1
> 
> 时间：2012-10-03T22:11:20.900
> 
> 标签：matlab, machine-learning, naivebayes

我正在尝试使用 UCI 机器学习团队发布的数据集来实现朴素贝叶斯分类器。我是机器学习的新手，并试图理解用于我的工作相关问题的技术，所以我认为最好先理解理论。

我正在使用 pima 数据集（[链接到数据 - UCI-ML](http://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes)），我的目标是为 K 类问题构建朴素贝叶斯单变量高斯分类器（只有 K=2 的数据存在）。我已经完成了数据拆分，并计算了每个班级的平均值、标准偏差、每个班级的先验，但在此之后我有点卡住了，因为我不确定在此之后我应该做什么以及如何做。我有一种感觉，我应该计算后验概率，

这是我的代码，我使用百分比作为向量，因为我想看到当我从 80:20 拆分增加训练数据大小时的行为。基本上，如果您通过 [10 20 30 40]，它将从 80:20 拆分中获取该百分比，并使用 80% 的 10% 作为训练。

```
function[classMean] = naivebayes(file, iter, percent)
dm = load(file);
    for i=1:iter
        idx = randperm(size(dm.data,1))
        %Using same idx for data and labels
        shuffledMatrix_data = dm.data(idx,:);
        shuffledMatrix_label = dm.labels(idx,:);
        percent_data_80 = round((0.8) * length(shuffledMatrix_data));
        %Doing 80-20 split
        train = shuffledMatrix_data(1:percent_data_80,:);
        test = shuffledMatrix_data(percent_data_80+1:length(shuffledMatrix_data),:);
        train_labels = shuffledMatrix_label(1:percent_data_80,:)
        test_labels = shuffledMatrix_data(percent_data_80+1:length(shuffledMatrix_data),:);
        %Getting the array of percents
        for pRows = 1:length(percent)
            percentOfRows = round((percent(pRows)/100) * length(train));
            new_train = train(1:percentOfRows,:)
            new_trin_label = shuffledMatrix_label(1:percentOfRows)
            %get unique labels in training
            numClasses = size(unique(new_trin_label),1)
            classMean = zeros(numClasses,size(new_train,2));
            for kclass=1:numClasses
                classMean(kclass,:) = mean(new_train(new_trin_label == kclass,:))
                std(new_train(new_trin_label == kclass,:))
                priorClassforK = length(new_train(new_trin_label == kclass))/length(new_train)
                priorClassforK_1 = 1 - priorClassforK
            end
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T14:05:20.453

首先，根据频率计数计算每个类别标签的概率。对于数据集中给定的数据样本和给定的类，您可以计算每个特征的概率。之后，将样本中所有特征的条件概率相互乘以所考虑的类标签的概率。最后，比较所有类标签的值，然后选择概率最大的类标签（贝叶斯分类规则）。

为了计算条件概率，您可以简单地使用正态分布函数。

# prolog - 第二端视图谜题，Prolog

> ID：12717609
> 
> 赞同：-1
> 
> 时间：2012-10-03T22:11:23.943
> 
> 标签：prolog, logic, constraints, swi-prolog, clpfd

我在 swi-prolog 中编写代码来解决 Second End View Pazzles 7*7（例如[http://www.funwithpuzzles.com/2009/10/abcd-second-end-view-ev4.html](http://www.funwithpuzzles.com/2009/10/abcd-second-end-view-ev4.html)像这样 5*5）数字 1-6

```
:- [library(clpfd)].

gen_row(Ls):-length(Ls, 7), Ls ins 0..6.

abc_view :-

maplist(gen_row, [R1,R2,R3,R4,R5,R6,R7]),
transpose([R1,R2,R3,R4,R5,R6,R7], [C1,C2,C3,C4,C5,C6,C7]),
maplist(all_distinct, [R1,R2,R3,R4,R5,R6,R7]),
maplist(all_distinct, [C1,C2,C3,C4,C5,C6,C7]),

start(R1, 4),
start(R2, 2),
start(R3, 3),
start(R4, 5),
start(R5, 3),
finish(R1, 6),
finish(R2, 4),
finish(R3, 2),
finish(R5, 1),
finish(R7, 2),

start(C2, 3),
start(C3, 4),
start(C4, 3),
start(C5, 5),
start(C6, 4),
start(C7, 1),
finish(C1, 3),
finish(C2, 2),
finish(C3, 5),
finish(C4, 5),
finish(C5, 6),
finish(C6, 1),
finish(C7, 4),

    maplist(writeln, [R1,R2,R3,R4,R5,R6,R7]). 
```

我需要如何编写逻辑来解决它，也许是 4*4 或 5*5 的更简单的例子。我会很乐意提供任何帮助。我需要为 3 次测试编写它，但即使是一次也很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T08:40:45.253

[我得到了一个解决方案，实际上这个问题比我之前](https://stackoverflow.com/a/8530427/874024)解决的“SkyScrape & Fences”难题要简单得多。

恐怕我之前误解了问题并发表了错误的评论，建议您放弃已经走的（正确的）道路。

```
/*  File:    second_end_view_puzzle.pl
    Author:  Carlo,,,
    Created: Oct  8 2012
    Purpose: help to solve Second End View puzzle as quested at
             https://stackoverflow.com/q/12717609/874024
*/

:- [library(clpfd)].

gen_row(Ls) :-
    length(Ls, 7),
    Ls ins 0..6.

abc_view :-

    Rows = [R1,R2,R3,R4,R5,_R6,R7],
    maplist(gen_row, Rows),
    transpose(Rows, [C1,C2,C3,C4,C5,C6,C7]),
    maplist(all_distinct, Rows),
    maplist(all_distinct, [C1,C2,C3,C4,C5,C6,C7]),

    start(R1, 4),
    start(R2, 2),
    start(R3, 3),
    start(R4, 5),
    start(R5, 3),
    finish(R1, 6),
    finish(R2, 4),
    finish(R3, 2),
    finish(R5, 1),
    finish(R7, 2),

    start(C2, 3),
    start(C3, 4),
    start(C4, 3),
    start(C5, 5),
    start(C6, 4),
    start(C7, 1),
    finish(C1, 3),
    finish(C2, 2),
    finish(C3, 5),
    finish(C4, 5),
    finish(C5, 6),
    finish(C6, 1),
    finish(C7, 4),

    maplist(label, Rows),
    maplist(writeln, Rows).

% place the constraint 'SECOND in that direction' using a reified check
start(Vars, Num) :-
    Vars = [A,B,C|_],
    X #<==> ( A #= 0 #\/ B #= 0 ) #/\ C #= Num,
    Y #<==> A #\= 0 #/\ B #= Num,
    X + Y #= 1 .

finish(Vars, Num) :-
    reverse(Vars, Sarv), start(Sarv, Num). 
```

**编辑**测试：

```
?- abc_view.
[5,4,0,2,1,6,3]
[6,0,2,3,5,4,1]
[1,3,4,6,2,5,0]
[2,5,1,4,0,3,6]
[0,6,3,5,4,1,2]
[3,2,5,1,6,0,4]
[4,1,6,0,3,2,5]
true ;
false. 
```

**此处编辑**是“移植”到 GnuProlog。我已经从 SWI-Prolog CLP(FD) 库中复制了 transpose/2 代码。

```
/*  File:    second_end_view_puzzle.pl
    Author:  Carlo,,,
    Created: Oct  8 2012
    Purpose: help to solve Second End View puzzle as quested at
             https://stackoverflow.com/q/12717609/874024
*/

gen_row(Ls) :-
    length(Ls, 7),
    fd_domain(Ls, 0, 6).

transpose(Ms, Ts) :-
        %must_be(list(list), Ms),
        (   Ms = [] -> Ts = []
        ;   Ms = [F|_],
            transpose(F, Ms, Ts)
        ).

transpose([], _, []).
transpose([_|Rs], Ms, [Ts|Tss]) :-
        lists_firsts_rests(Ms, Ts, Ms1),
        transpose(Rs, Ms1, Tss).

lists_firsts_rests([], [], []).
lists_firsts_rests([[F|Os]|Rest], [F|Fs], [Os|Oss]) :-
        lists_firsts_rests(Rest, Fs, Oss).

writeln(X) :- write(X), nl.

abc_view :-

    Rows = [R1,R2,R3,R4,R5,_R6,R7],
    maplist(gen_row, Rows),
    transpose(Rows, [C1,C2,C3,C4,C5,C6,C7]),
    maplist(fd_all_different, Rows),
    maplist(fd_all_different, [C1,C2,C3,C4,C5,C6,C7]),

    start(R1, 4),
    start(R2, 2),
    start(R3, 3),
    start(R4, 5),
    start(R5, 3),
    finish(R1, 6),
    finish(R2, 4),
    finish(R3, 2),
    finish(R5, 1),
    finish(R7, 2),

    start(C2, 3),
    start(C3, 4),
    start(C4, 3),
    start(C5, 5),
    start(C6, 4),
    start(C7, 1),
    finish(C1, 3),
    finish(C2, 2),
    finish(C3, 5),
    finish(C4, 5),
    finish(C5, 6),
    finish(C6, 1),
    finish(C7, 4),

    maplist(fd_labeling, Rows),
    maplist(writeln, Rows).

% place the constraint 'SECOND in that direction' using a reified check
start(Vars, Num) :-
    Vars = [A,B,C|_],
    X #<=> ( A #= 0 #\/ B #= 0 ) #/\ C #= Num,
    Y #<=> A #\= 0 #/\ B #= Num,
    X + Y #= 1 .

finish(Vars, Num) :-
    reverse(Vars, Sarv), start(Sarv, Num). 
```

# php - Mysql 查询的大小写敏感问题

> ID：12717611
> 
> 赞同：1
> 
> 时间：2012-10-03T22:11:33.220
> 
> 标签：php, mysql, sql

我正在使用一个遗留的 PHP 框架，它会自动为我组装查询。由于某种原因，它正在组装这样的查询：

```
SELECT s.status,c.client FROM client C LEFT JOIN status S ON C.id_status=S.id_status' 
```

这在我的 MacOS X 工作站上不是问题。但是当我在我的生产服务器上测试它时，mysql会引发以下错误：

```
#1054 - Unknown column 's.status' in 'field list' 
```

这绝对是 s.status 上的案例问题。如果我手动运行将 s,c 更改为 S,C 的查询，它将完美运行。

快速浏览谷歌并没有解决问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:17:53.517

好吧，[文档](http://dev.mysql.com/doc/refman/5.0/en/identifier-case-sensitivity.html)中说：

> 默认情况下，表别名在 Unix 上区分大小写，但在 Windows 或 Mac OS X 上不区分大小写。以下语句在 Unix 上不起作用，因为它将别名称为 a 和 A：

```
mysql> SELECT col_name FROM tbl_name AS a
    -> WHERE a.col_name = 1 OR A.col_name = 2; 
```

文档的这一部分也提供了一些解决方案。例如，您可以在所有平台上设置`lower_case_table_names`为`1`强制将名称转换为小写 - 但在这种情况下，您也必须将所有表重命名为小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:18:51.783

MySQL 中的表存储为文件。文件名在 MacOS X 和 Windows 中不区分大小写，而在 Linux 中则区分大小写。您可以在 MacOS X 和 Windows 中使用表名而不考虑大小写，但在 Linux 中则不行。因此，您应该为所有表名选择一致的大小写，并在整个代码中使用它。

我建议使用用下划线分隔的所有小写或大写名称，例如`tbl_etc`，`MY_TBL`等，这样就不会混淆大小写。

# ruby-on-rails - FALSE 属性的 ActiveRecord 查询

> ID：12717613
> 
> 赞同：0
> 
> 时间：2012-10-03T22:11:40.113
> 
> 标签：ruby-on-rails, activerecord, boolean

我不确定正确的术语是什么，所以我的谷歌搜索没有太大帮助。

但无论如何，ActiveRecord 允许您搜索所有具有布尔属性 TRUE 的记录，如下所示：

```
@current_events = Event.current 
```

因此，返回所有具有“当前”属性等于 TRUE 的事件。

是否有一个漂亮的 ActiveRecord 方法来返回所有错误的内容？也许是这样的：

```
@outdated_events = Event.not_current 
```

?

如果没有，那么我可以使用“where”方法。但我只是好奇。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:22:17.063

您可能将 ActiveRecord 的“命名范围”类方法误认为是 Rails 功能。例如，

```
class Foo < ActiveRecord::Base
  def self.current
    where current: true
  end
end 
```

将创建您描述的行为，但不仅仅是在`Foo.current`没有上述内容的情况下调用。所以要创建`not_current`，是的，使用`where`：

```
def self.not_current
  where current: false
end 
```

# xcode - Xcode 故事板崩溃

> ID：12717614
> 
> 赞同：2
> 
> 时间：2012-10-03T22:11:43.053
> 
> 标签：xcode, crash, storyboard, corrupt

每当我将一个对象（特别是 UIButton 或 UILabel）添加到我的 Storyboard 视图中时，Xcode 都会崩溃。我尝试重新启动并重新安装 Xcode。我还尝试在一个新项目中重新创建我的视图。一开始它并没有崩溃，但是一旦我向情节提要添加了几个按钮，它就会崩溃。

当我在导航器中右键单击 MainStoryboard.storyboard 并选择“打开为：属性列表”时，出现错误：“无法读取数据，因为它已损坏。” 事实上，当我尝试以相同方式打开我的 .h 和 .m 文件时，就会出现此错误。

我在 Mountain Lion 上运行最新版本的 Xcode (4.5)。以下是崩溃日志的一部分。如果我需要包含更多内容，请告诉我。

```
Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000

Application Specific Information:
ProductBuildVersion: 4G182
ASSERTION FAILURE in /SourceCache/IDEInterfaceBuilderCocoaTouch/IDEInterfaceBuilderCocoaTouch-1926/IBPlugin/Utilities/IBObjectMarshalling.m:651
Details:  Failed to arbitrate IBNSLayoutConstraint, IBUIButton, IBUILabel, IBUIView, and IBUIViewController. 
```

Interface Builder 在与 iOS 模拟器通信时遇到错误。如果您选择为此问题提交崩溃报告或雷达，请检查 Console.app 以获取“Interface Builder Cocoa Touch Tool”的崩溃报告，并将其内容包含在您的崩溃报告中。

异常名称：IBAssertionFailure 异常原因：ASSERTION FAILURE：原因：所有需要候选约束的视图都已生成约束。这很可能表明存在涉及以下视图布局的错误： > 的布局引擎框架 ({{169, 392}, {64, 43}}) 与画布框架 ({{168, 392}, {64, 43) 不匹配}}）

更新：

显然我研究得不够好。我发现有人遇到完全相同的问题： [Xcode Interface Builder crash when I edit storyboard](https://stackoverflow.com/questions/12580881/xcode-interface-builder-crashes-when-i-edit-storyboard)

在导航器中右键单击 Storyboard -> 显示文件检查器 -> 取消选中“使用自动布局”

问题解决了！

# php - 如何使用 PHP 和 foreach 循环解析这个 fb 帐户信息

> ID：12717619
> 
> 赞同：-2
> 
> 时间：2012-10-03T22:11:52.023
> 
> 标签：php, arrays, facebook

如何使用 PHP 和 foreach 循环解析这个 FB 帐户信息？我正在使用此代码来获取用户页面：

```
$user_profile = $facebook->api('/me/accounts');

print_r($user_profile["data"]); 
```

这是生成的数组，我试图获取名称和 ID：

```
Array
( 
  [0] => Array
  ( 
    [name] => RodBull 
    [access_token] => XXXXXXX
    [category] => Company 
    [id] => 101332379991045 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [1] => Array
  ( 
    [name] => Jobyer 
    [access_token] => XXXXXX
    [category] => Cause 
    [id] => 177780562324865 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [2] => Array
  ( 
    [name] => Testing it 
    [access_token] => XXXXXXX 
    [category] => Education 
    [id] => 338949122821475 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] =>` MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [3] => Array
  ( 
    [name] => Wellness Incentives Plus 
    [access_token] => XXXXXX
    [category] => Consulting/business services 
    [id] => 280634342048932 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [4] => Array
  ( 
    [name] => Cashierr 
    [access_token] => XXXXXX
    [category] => Community organization 
    [id] => 131516906950255 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [5] => Array
  ( 
    [name] => 100x35.me 
    [access_token] => XXXXXX
    [category] => Community organization 
    [id] => 297550586926613 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [6] => Array
  ( 
    [name] => Faaafavdsfsd 
    [access_token] => XXXXXX
    [category] => Cause 
    [id] => 336675629760824 
    [perms] => Array ( 
    [0] => ADMINISTER 
    [1] => EDIT_PROFILE 
    [2] => CREATE_CONTENT 
    [3] => MODERATE_CONTENT 
    [4] => CREATE_ADS 
    [5] => BASIC_ADMIN )
  ) 
  [7] => Array
  ( 
    [name] => The Page App Tab by Santu 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 402022163198499
  ) 
  [8] => Array
  ( 
    [name] => Button blog 
    [access_token] => XXXXXXXX
    [category] => Application 
    [id] => 194345950699984
  ) 
  [9] => Array
  ( 
    [name] => Twit 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 473412539337463
  ) 
  [10] => Array
  ( 
    [name] => Invite Friends 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 112138232257401
  ) 
  [11] => Array
  ( 
    [name] => Candygirl19 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 458913407468223
  ) 
  [12] => Array
  ( 
    [name] => Dokter Winkel 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 214744621969104
  ) 
  [13] => Array
  ( 
    [name] => Testin James 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 186137041506535
  ) 
  [14] => Array
  ( 
    [name] => Fans Avenue 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 129009763896253
  ) 
  [15] => Array
  ( 
    [name] => Automotive 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 304776169593014
  ) 
  [16] => Array
  ( 
    [name] => Dealers 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 267196013320187
  ) 
  [17] => Array
  ( 
    [name] => Empleo 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 110682139041185
  ) 
  [18] => Array
  ( 
    [name] => Free Account 
    [access_token] => XXXXXXXX
    [category] => Application 
    [id] => 227897480601648
  ) 
  [19] => Array
  ( 
    [name] => Bienes Raices 
    [access_token] => XXXXXXX
    [category] => Application 
    [id] => 255317971171412
  ) 
  [20] => Array
  ( 
    [name] => Autos 
    [access_token] => XXXXXX
    [category] => Application 
    [id] => 276616169025835
  )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:23:01.937

```
<?php
  $user_profile = $facebook->api('/me/accounts');
  foreach ($user_profile["data"] as $profile){
    $name = $profile["name"];
    $id = $profile["id"];
    echo "Name is $name and id is $id <br />";
  }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:23:38.037

```
 $names = array();
 $ids = array();
 foreach ($data as $d) {
   $names[] = $d['name'];
   $ids[] = $d['id'];
 } 
```

# vb.net - 使用 ToUpper 将字符串传递给数据库？VB.NET 2010

> ID：12717624
> 
> 赞同：1
> 
> 时间：2012-10-03T22:12:48.100
> 
> 标签：vb.net

我正在尝试验证文本框。如果用户输入所有小写字符，则将其转换为全部大写。因此，当它添加到数据库时，它的全部大写。我的功能需要帮助，我不知道是语法错误还是什么，就在这里。我正在使用 VB.Net 2010

```
Public Function CheckLetters(ByVal strIn As String) As Boolean

    Dim i As Integer
    Dim strOne As String

    For i = 0 To Len(strIn) - 1

        strOne = strIn.Substring(i, 1).ToUpper
        Select Case strOne

            Case "A" To "Z"
            Case Else

                Return False
        End Select
    Next

    Return True
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T04:01:53.213

这个怎么样：

```
Return Regex.IsMatch(strIn, "^[a-z]*$") 
```

或这个

```
Return strIn.All(Function(c) Char.IsLower(c)) 
```

这种方法除了单线之外没有什么好的理由。但如果你真的想遍历字符：

```
For Each c As Char In strIn
   If Not Char.IsLower(c) Then Return False
Next c
Return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:35:35.827

您的代码在这里运行得很好（VB 不需要 ToUpper 之后的括号，但它有利于可读性） - 它接受一个字符串，如果该字符串仅包含字符“A”到“Z”，则返回 True，否则返回 false。该函数不转换任何东西 - 只是返回该布尔结果。

如果您想实际将字符串转换为大写，只需在字符串本身上使用 .ToUpper() ，例如

```
Dim MyString As String = "Contains some text"

MyString = MyString.ToUpper()

' Above would set MyString to "CONTAINS SOME TEXT" 
```

# android - 我的应用程序的服务架构

> ID：12717625
> 
> 赞同：0
> 
> 时间：2012-10-03T22:12:50.203
> 
> 标签：android, service

我有一个应用程序，它通过使用 locationlistener 创建面包屑来跟踪手机的位置。用户可以启动应用程序，然后开始面包屑轨迹记录。路径显示在应用程序中的谷歌地图上，作为旅行记录。面包屑也被发送到影响力数据库，其他应用程序可以访问正在执行的行程。

用户可以结束应用程序，但选择保持面包屑记录，以便其他应用程序仍然可以实时跟踪跟踪。如果用户从不回来停止录制，则录制将在开始后 24 小时内停止。但是，用户可以随时启动应用程序并停止记录轨迹。

看来我的应用程序应该包含一个活动和活动绑定到的服务。没有其他应用程序会使用此服务，因此该服务似乎不必是 IPC 服务。该服务执行所有位置侦听和记录到云数据库。

我的问题是，在第 1226 页的 CommonsWare 书中说，如果我的应用程序调用 unbindService()，android 将关闭该服务。我希望它继续运行，直到活动将其关闭或在 24 小时后自行关闭。

这是否意味着我的服务必须是 IPC 服务？

如何结束我的活动并让服务继续运行？谢谢，加里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:30:34.847

首先，您想让您的服务成为前台服务。

与此类似的东西。（我会在您的服务 onCreate 函数中调用此代码。）

```
 Notification notification = new Notification(
            R.drawable.ic_dialog_info,
            getText(R.string.notification_text),
            System.currentTimeMillis());
    notification.flags |= Notification.FLAG_AUTO_CANCEL;

    Intent activityIntent = new Intent(this, YourMainClass.class);
    activityIntent.setAction(Intent.ACTION_MAIN);
    activityIntent.addCategory(Intent.CATEGORY_LAUNCHER);
    activityIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP
            | Intent.FLAG_ACTIVITY_SINGLE_TOP);

    PendingIntent pendingIntent = PendingIntent.getActivity(this, 0,
            activityIntent, 0);
    notification.setLatestEventInfo(this,
            getText(R.string.notification_title),
            getText(R.string.notification_text), pendingIntent);
    startForeground(123, notification); 
```

另一件事是不要将您的服务绑定到您的活动。如果您的活动被终止，您不希望您的服务也终止。如果您的设备内存不足，如果您的活动不在前台，则可能会被杀死。当然，当内存释放时，Android 会尝试重新创建它。但是您的用户体验会很差。如果您的服务未绑定到您的活动并且是前台服务，那么它应该是在垃圾收集期间被操作系统杀死的最后一件事。

您可以使用以下简单的代码来启动服务而不将其绑定到您的活动： 此代码可以在您的活动中调用 onCreate。

```
Intent service = new Intent(YourContext, YourService.class);
startService(service); 
```

希望这可以帮助你！干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T15:32:12.523

> 看来我的应用程序应该包含一个活动和活动绑定到的服务。

不必要。您可以为此使用命令模式。

> 这是否意味着我的服务必须是 IPC 服务？

不必要。您可以为此使用命令模式。

> 如何结束我的活动并让服务继续运行？

使用 启动服务`startService()`。它是否会存活 24 小时不在您的控制之下（请参阅 Dyarish 的回答，将其设为前台服务，这增加了它存活那么久的几率）。

# windows-8 - windows应用商店访问用户邮箱

> ID：12717626
> 
> 赞同：1
> 
> 时间：2012-10-03T22:13:02.220
> 
> 标签：windows-8, microsoft-metro

我想为用户创建一个反馈表，以便为应用程序提供反馈。是否可以从应用程序访问用户的电子邮件地址？该应用程序可以请求权限吗？如果我无权访问，如何超链接到 windows8 应用商店应用的用户电子邮件客户端？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T08:44:40.533

您可以通过获取主体名称来获取用户的电子邮件地址 - 这通常被记录为地址，但您不能确定因此使用电子邮件验证器来检查它是否真的是电子邮件地址。如果没有提示用户为您输入。

```
var principalName = await Windows.System.UserProfile.UserInformation.GetPrincipalNameAsync(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T13:02:54.370

如果您想打开用户邮件客户端，您可以执行以下操作：

```
await Windows.System.Launcher.LaunchUriAsync(new Uri("mailto:support@email.co.uk?subject=App Feedback")); 
```

这就是我用于我们的支持链接的内容，它打开了正确设置主题的邮件应用程序：o）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T08:23:57.687

您能做的最好的事情就是向他们询问他们的电子邮件地址或使用联系人选择器。就像 John 提到的那样，您可能能够从显示名称中获取有效的电子邮件地址，但不要依赖它是真实的，因为它不是电子邮件地址字段。

# c# - 代理在本地工作，但在上传到虚拟主机时失败

> ID：12717629
> 
> 赞同：6
> 
> 时间：2012-10-03T22:13:19.753
> 
> 标签：c#, asp.net, proxy, html-agility-pack

我现在花了很多时间来配置我的代理。目前，我使用一项名为 proxybonanza 的服务。他们为我提供了一个代理，我用它来获取网页。

我正在使用***HTMLAGILITYPACK***

现在，如果我在没有代理的情况下运行我的代码，则在本地或上传到虚拟主机服务器时都没有问题。

如果我决定使用代理，它需要更长的时间，但它仍然可以在本地工作。

```
 If I publish my solution to, to my webhost I get a SocketException (0x274c) 

 "A connection attempt failed because the connected party did not properly respond
 after a period of time, or established connection failed because connected host has
 failed to respond 38.69.197.71:45623" 
```

我已经调试了很长时间。

我的 app.config 有两个与此相关的条目

```
httpWebRequest useUnsafeHeaderParsing="true" 
httpRuntime executionTimeout="180" 
```

这帮助我解决了几个问题。

现在这是我的 C# 代码。

```
 HtmlWeb htmlweb = new HtmlWeb();
 htmlweb.PreRequest = new HtmlAgilityPack.HtmlWeb.PreRequestHandler(OnPreRequest);
 HtmlDocument htmldoc = htmlweb.Load(@"http://www.websitetofetch.com,
                                         "IP", port, "username", "password");

 //This is the preRequest config
 static bool OnPreRequest(HttpWebRequest request)
    {
      request.KeepAlive = false;
        request.Timeout = 100000;
        request.ReadWriteTimeout = 1000000; 
        request.ProtocolVersion = HttpVersion.Version10;
        return true; // ok, go on
    } 
```

我究竟做错了什么？我在 appconfig 中启用了跟踪器，但我的虚拟主机上没有日志...？

```
 Log stuff from app.config

 <system.diagnostics>
 <sources>
  <source name="System.ServiceModel.MessageLogging" switchValue="Warning, ActivityTracing" >
     <listeners>
        <add name="ServiceModelTraceListener"/>
     </listeners>
  </source>

  <source name="System.ServiceModel" switchValue="Verbose,ActivityTracing">
     <listeners>
        <add name="ServiceModelTraceListener"/>
     </listeners>
     </source>
     <source name="System.Runtime.Serialization" switchValue="Verbose,ActivityTracing">
        <listeners>
           <add name="ServiceModelTraceListener"/>
        </listeners>
     </source>
   </sources>
   <sharedListeners>
   <add initializeData="App_tracelog.svclog"
     type="System.Diagnostics.XmlWriterTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
     name="ServiceModelTraceListener" traceOutputOptions="Timestamp"/>
 </sharedListeners>
 </system.diagnostics> 
```

谁能发现我将这些设置打开和关闭一千次的问题..

```
 request.KeepAlive = false;
  System.Net.ServicePointManager.Expect100Continue = false; 
```

卡尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T00:03:56.727

听起来您的 Web 主机已禁用来自 ASP.NET 应用程序的传出连接以确保安全，因为这将允许其他脚本/应用程序从其服务器执行恶意攻击。

您必须要求他们取消阻止您帐户上的连接，但如果他们拒绝，请不要感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T23:41:37.717

尝试先将页面下载为字符串，然后将其传递给 HtmlAgilityPack。这将使您能够将下载过程中发生的错误与 html 解析过程中发生的错误隔离开来。如果您对 proxybonanza 有疑问（请参阅帖子末尾），您将能够将该问题与 HtmlAgilityPack 配置问题隔离开来。

使用 WebClient 下载页面：

```
// Download page
System.Net.WebClient client = new System.Net.WebClient();
client.Proxy = new System.Net.WebProxy("{proxy address and port}");
string html = client.DownloadString("http://example.com");

// Process result
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();
htmlDoc.LoadHtml(html); 
```

如果您想对请求进行更多控制，请使用[System.Net.HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)：

```
// Create request
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://example.com/");

// Apply settings (including proxy)
request.Proxy = new WebProxy("{proxy address and port}");
request.KeepAlive = false;
request.Timeout = 100000;
request.ReadWriteTimeout = 1000000;
request.ProtocolVersion = HttpVersion.Version10;

// Get response
try
{
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
    Stream stream = response.GetResponseStream();
    StreamReader reader = new StreamReader(stream);
    string html = reader.ReadToEnd();
}
catch (WebException)
{
    // Handle web exceptions
}
catch (Exception)
{
    // Handle other exceptions
}

// Process result
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();
htmlDoc.LoadHtml(html); 
```

此外，请确保您的代理提供商 (proxybonanza) 允许从您的生产环境访问您的代理。大多数提供商将对代理的访问限制为某些 IP 地址。他们可能允许访问您在本地运行的网络的外部 IP，但不允许访问生产环境的外部 IP 地址。

# objective-c - 在 Objective-C 中移动窗口框架而不移动其内容

> ID：12717630
> 
> 赞同：0
> 
> 时间：2012-10-03T22:13:20.773
> 
> 标签：objective-c, window, frame

我有 (+) 和 (-) 按钮... (+) 按钮应该使窗口在向下方向上变长，并且 (-) 按钮应该撤消 (+) 按钮所做的事情，方法是使其从底部。

关键是，框架应该只从底部拉伸，并且大多数 UI 项目应该保持在原位 - 窗口底部的按钮应该跟随窗口高度的变化......

问题是我正在使用它来移动窗口并保持其内容的相同位置......

```
NSRect frame = sender.window.frame;
NSLog(@"\nHeight and width of window frame: (%f,%f).\nThe x and y origin of the window frame: (%f,%f). ", frame.size.height, frame.size.width, frame.origin.x, frame.origin.y);
frame.origin.y -= 22;
frame.size.height += 22;
[sender.window setFrame:frame display:YES animate:NO];

NSRect viewFrame = mainView.frame;
viewFrame.origin.y -= 22;
viewFrame.size.height += 22;
mainView.frame = viewFrame; 
```

但是假设您单击（+）按钮一次；当框架变长时，所有项目都会略微向上移动。如果您在第一次按下后连续单击 (+)，它将按预期工作：框架将向下移动，其内容将保持原位。如果您随后单击 (-) 按钮一次；当框架缩短时，所有项目都会略微向下移动。第一次按下后连续单击（-），它将按预期移动框架。

似乎第一次按下按钮将移动所有窗口内容，而连续按下将按预期工作......我想知道我是否在 XCode 的界面编辑器中遗漏了一些关于自动调整大小的内容。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T04:01:50.987

```
 [mainWindow disableScreenUpdatesUntilFlush];
[mainWindow disableFlushWindow];

NSRect frame = sender.window.frame;
NSRect viewFrame = mainView.frame;

viewFrame.size.height += 25;
frame.size.height += 25;
frame.origin.y -= 25;

[sender.window setFrame:frame display:YES animate:NO];
mainView.frame = viewFrame;

[mainWindow enableFlushWindow]; 
```

这工作正常。我无法获得 NSView 和窗口链接，所以我只是手动移动它们并使用 disableFlushWindow 使其同时无缝发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:25:24.073

假设这`mainView`是您窗口中的主视图，您不应该手动修改它的框架。只要您正确配置了弹簧和支柱（或约束），它就应该随窗口自动调整大小。

# html - HTML & CSS - 内联块元素的问题

> ID：12717633
> 
> 赞同：1
> 
> 时间：2012-10-03T22:13:35.777
> 
> 标签：html, css, block, inline

我制作了一个网站，在主 div 上显示多个 div（作为内联元素），这些 div 包含一个 IMG 和 P 元素。

好吧，如果我留下 P 元素（或没有 p 标签的文本），一切正常，但如果我在 img 后添加文本，则对应的 div 会脱离正常位置。

该页面位于[http://ace-acid.no-ip.org/acid-game-studios/](http://ace-acid.no-ip.org/acid-game-studios/) （即工作版本）

而这个是有问题的版本-> [http://ace-acid.no-ip.org/acid-game-studios-issue/](http://ace-acid.no-ip.org/acid-game-studios-issue/) （在这里你可以清楚地看到所有没有文本的div它，有间隔的下行空间......）

我怎样才能防止这种行为？

谢谢大家^^

<编辑>

我认为这是一个 css 问题（块元素，内联块元素，fextflow，垂直对齐，...）不是吗？

顺便说一句 -> 该网站是一个基于流体网格的网站，因此如果您缩小浏览器，它将显示一个桌面版本和一个移动版本。问题似乎只出现在文本所在的同一行，因为在下一行中，div-blocks 没有间隔下来......

</编辑>

HTML 代码：

```
<!doctype html>
<!--[if lt IE 7]> <html class="ie6 oldie"> <![endif]-->
<!--[if IE 7]>    <html class="ie7 oldie"> <![endif]-->
<!--[if IE 8]>    <html class="ie8 oldie"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>aCID Game Studios</title>
<link rel="stylesheet" type="text/css" href="boilerplate.css">
<link rel="stylesheet" type="text/css"href="style.css">
<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<script src="respond.min.js"></script>
</head>
<body>
<div class="gridContainer clearfix">
    <div id="div_header" align="center">
        <div id="div_header_img"></div>
        <div id="div_menu" align="center">
            <p>&lt; MENU &gt;</p>
        </div>
    </div>
    <div id="div_main" align="center">
        <div id="div_page">
            <br><br><p>&lt; PAGE &gt;</p><br><br>
            <div class="div_game_thumb">
                <img style="vertical-align:middle" src="img/games/LegendOfAce.png" onMouseOver="this.src='img/games/LegendOfAce_hover.png'" onMouseOut="this.src='img/games/LegendOfAce.png'"/>
            </div>
            <div class="div_game_thumb">
                <img src="img/games/GunsOfTheNation.png" onMouseOver="this.src='img/games/GunsOfTheNation_hover.png'" onMouseOut="this.src='img/games/GunsOfTheNation.png'"/>
            </div>
            <div class="div_game_thumb">
                <img src="img/games/LegendOfAce.png" onMouseOver="this.src='img/games/LegendOfAce_hover.png'" onMouseOut="this.src='img/games/LegendOfAce.png'"/>
            </div>
            <div class="div_game_thumb">
                <img src="img/games/GunsOfTheNation.png" onMouseOver="this.src='img/games/GunsOfTheNation_hover.png'" onMouseOut="this.src='img/games/GunsOfTheNation.png'"/>
            </div>
            <div class="div_game_thumb">
                <img src="img/games/LegendOfAce.png" onMouseOver="this.src='img/games/LegendOfAce_hover.png'" onMouseOut="this.src='img/games/LegendOfAce.png'"/>
            </div>
        </div>
    </div>
</div>
</body>
</html> 
```

CSS 代码：

```
@charset "utf-8";
/* Einfache fließende Medien
   Hinweis: Für fließende Medien müssen Sie die Attribute 'height' und 'width' des Medium aus dem HTML-Code entfernen
   http://www.alistapart.com/articles/fluid-images/ 
*/
html{
    margin: 0;
    padding: 0;
    border: 0;
}
body {
    background-color: #0c0d0f;
    color: #3982aa;
}
p {
    margin: 0;
    padding: 10px;
}
img, object, embed, video {
    width: 100%;
}
/* IE 6 unterstützt keine maximale Breite, verwenden Sie daher eine Standardbreite von 100% */
.ie6 img {
    width: 100%;
}
.div_game_thumb {
    width:320px;
    height:350px;
    display:inline-block;
    border:1px solid #fff;
}
/*
    Dreamweaver-Eigenschaften für fließende Raster
    ----------------------------------
    dw-num-cols-mobile:     6;
    dw-num-cols-tablet:     8;
    dw-num-cols-desktop:    14;
    dw-gutter-percentage:   15;

    Idee durch den Artikel "Responsive Web Design" von Ethan Marcotte 
    http://www.alistapart.com/articles/responsive-web-design

    und "Golden Grid System" von Joni Korpi
    http://goldengridsystem.com/
*/

/* Layout für Mobilgeräte: 480 px oder weniger. */

.gridContainer {
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    padding-left: 0;
    padding-right: 0;
}
#div_header {
    clear: both;
    float: left;
    margin: 0;
    width: 100%;
    display: block;
}
#div_header_img {
    width: 450px;
    height: 150px;
    background-color: #999;
    background-position: top center;
    background-repeat: no-repeat;
    background-image: url(img/header_m.png);
}
#div_menu {
    width: 450px;
    height: 50px;
    background-color: #111;
}
#div_main {
    clear: both;
    float: left;
    margin: 0;
    width: 100%;
    display: block;
    min-height: 300px;
}
#div_page {
    width: 450px;
    min-height: 300px;
    background-position: top center;
    background-repeat: repeat-x;
    background-image: url(img/page_border_top.png);
    background-color: #000;
}

/* Layout für Tablet-PCs: 481 bis 768 px. Erbt Stile vom: Layout für Mobilgeräte. */

@media only screen and (min-width: 481px) {
    body {
        background-position: top center;
        background-repeat: repeat;
        background-image: url(img/bg.png);
    }
    #div_header {
        clear: both;
        float: left;
        width: 100%;
        display: block;
        display: block;
        background-position: top center;
        background-repeat: repeat-y;
        background-image: url(img/page_bg_t.png);
    }
    #div_header_img {
        width: 650px;
        height: 150px;
        display: block;
        background-image: url(img/header_t.png);
    }
    #div_menu {
        width: 650px;
        background-position: top center;
        background-repeat: no-repeat;
        background-image: url(img/menu_bg_t.png);
    }
    #div_main {
        clear: both;
        float: left;
        margin: 0;
        width: 100%;
        display: block;
        background-position: top center;
        background-repeat: repeat-y;
        background-image: url(img/page_bg_t.png);
    }
    #div_page {
        width: 650px;
    }
}

/* Desktoplayout: 769 bis maximal 1232 px.  Erbt Stile von: den Layouts für Mobilgeräte und Tablet-PCs. */

@media only screen and (min-width: 769px) {
    #div_header {
        clear: both;
        float: left;
        width: 100%;
        display: block;
        background-image: url(img/page_bg.png);
    }
    #div_header_img {
        width: 1000px;
        height: 200px;
        background-image: url(img/header.png);
    }
    #div_menu {
        width: 1000px;
        background-position: top center;
        background-repeat: no-repeat;
        background-image: url(img/menu_bg.png);
    }
    #div_main {
        clear: both;
        float: left;
        margin: 0;
        width: 100%;
        display: block;
        background-image: url(img/page_bg.png);
    }
    #div_page {
        width: 1000px;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:18:47.520

使用`vertical-align: top;`在`.div_game_thumb`

内联元素服从垂直对齐。

此外，如果您想要跨浏览器内联块 (IE7+)，您需要像这样定义它：

```
display: inline-block;
*zoom: 1;
*display: inline; 
```

*注意：顺序很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:18:36.230

`vertical-align: top`节省一天！穿上它`.div_game_thumb`。

您也可以通过添加来恢复执行此操作后消失的一点点边距`margin: 2px 0;`。

# matlab - 如何在 Matlab 中执行 TukeyHSD 测试并使用字母获得分组对？

> ID：12717635
> 
> 赞同：0
> 
> 时间：2012-10-03T22:13:44.600
> 
> 标签：matlab, statistics

如何在 Matlab 中的 Anova 之后执行 TukeyHSD 事后测试，并使用字母获得排序分组对的表？

例子：

X 在 4 次重复（行）中获得了 3 个处理（列）：

```
x=[9 1 3.1
   5 2 3.2
   7 1.1 3
   8 1.2 3] 
```

单向方差分析：

```
[p,a,s] = anova1(x) 
```

而多重比较结果：

```
[c,m,h,nms] = multcompare(s) 
```

![在此处输入图像描述](../Images/dcd1a8b5da0067daabd1f29d4ceb111a.png)

如何得到这样的结果？

```
treatment   mean      Tukey_group
1           7.2500    a
2           1.3250    b
3           3.0750    b 
```

请参阅 R 中的类似示例：

[https://stats.stackexchange.com/questions/31547/how-to-obtain-the-results-of-a-tukey-hsd-post-hoc-test-in-a-table-showing-groupe](https://stats.stackexchange.com/questions/31547/how-to-obtain-the-results-of-a-tukey-hsd-post-hoc-test-in-a-table-showing-groupe)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:25:11.080

我想我有一个解决办法。我为此开发了一个 Matlab 函数：

**例子：**

```
x=[9.0 1.0 3.1
5.0 2.0 3.2
7.0 1.1 3.0
8.0 1.2 3.0]; 
```

按新月顺序对 x 进行排序

```
[me or]=sort(mean(x),2);
xo=x(:,or); 
```

方差分析

```
[p,a,s] = anova1(xo); 
```

Multcompare 使用 HSD Tukey 在 5% 显着性：

```
[c,m,h,nms] = multcompare(s,'alpha',0.05,'ctype','hsd'); 
```

使用开发功能的事后分组：

```
phg = phgroup(xo,c); 
```

开发的函数phgroup：

```
function phg = phgroup(xo,c)
%
% Input:
% x: data matrix with treatments in rows and observations in columns
% c: matrix of pairwise comparison results from multcompare test
% 
% WARNING: is indispensable that the means of x matrix are sorted in crescent order.
%

% Getting significant pairwise comparisons
gr=1;
for i=1:size(c,1)
if c(i,3)>0&&c(i,5)>0||c(i,3)<0&&c(i,5)<0
tt(c(i,2),c(i,1))=0;
gr=gr+1;
else
tt(c(i,1),c(i,1))=gr;
tt(c(i,2),c(i,1))=gr;
end
end

% Setting groups if all non-significant
if isempty(find(tt>0))==1
for i=1:size(tt,1)
    gr=gr+1;
    tt(i,i)=gr;
end
end

% Setting groups if some non-significant
for i=1:size(tt,1)
    if isempty(find(tt(i,:)>0))==1
        tt(i,i)=gr+1;
        gr=gr+1;
    end
end

% Correcting repeated groups
for i=1:size(tt,2)-1
    if max(find(tt(:,i+1)>0))==max(find(tt(:,i)>0))
        tt(find(tt(:,i+1)>0),i+1)=tt(i,i);
    end
end
mx=max(tt);
for i=1:size(tt,2)-1
    if max(tt(:,i+1))==mx(i)
        tt(find(tt(:,i+1)>0),i+1)=0;
    end
end

% Setting sequential groups
[B,IX] = sort(nonzeros(max(tt))');
for l=1:size(tt,1)
    for c=1:size(tt,2)
        if tt(l,c)>0
            for u=1:size(B,2)
                if tt(l,c)==B(u)
                    tt(l,c)=IX(u);
                end
            end
        end
    end
end

% Assigning letters to groups
gn=['a';'b';'c';'d';'e';'f';'g';'h';'i';'j';'k';'l';'m';'n';'o';'p';'q';'r';'t';'u';'v';'w';'x';'y';'z'];
for i=1:size(tt,1)
tg=[];
    ttu=nonzeros(unique(tt(i,:)))';
    for j=1:size(ttu,2)
            tg=[tg gn(ttu(1,j))];
            TG{i,1}=tg;
    end
end

% Getting output table
m1=[mean(xo);std(xo)]';
m1=[num2cell(m1) TG];
me1=['mean';m1(:,1)];
st=['std';m1(:,2)];
gr=['group';m1(:,3)];
phg=[me1 st gr]; 
```

# javascript - 需要在 Javascript 中验证 MM/dd/yyyy hh:mm tt

> ID：12717638
> 
> 赞同：0
> 
> 时间：2012-10-03T22:13:57.587
> 
> 标签：javascript, validation

我需要在 Javascript 中以特定格式验证日期字符串。

格式为：MM/dd/yyyy hh:mm tt

我很难找到一个可以处理它的日期库，或者一个可以做同样事情的正则表达式函数。

我试过 Date.js，它很接近，但有以下问题：

```
date.parseExact('10/21/2011 06:00 AM', ['MM/dd/yyyy hh:mm tt']); //passes
date.parseExact('10/21/2011 06:00 A', ['MM/dd/yyyy hh:mm tt']); //passes 
```

第二个不应该通过。

有谁知道可以满足这种需求的正则表达式，或者我是否使用了 Date.js 库错误？任何帮助将不胜感激，在 2 小时的大部分时间里，我一直在用头撞墙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:17:27.180

你需要验证它是一个实际的日期，还是只是它遵循那个确切的格式？如果只是格式，您可以使用此正则表达式：

```
/[0-1]\d\/[0-3]\d\/\d{4} [0-1]\d:[0-5]\d [aApP][mM]/ 
```

您可以将 Date.js 与上述正则表达式结合使用来验证它是否是有效日期，并与您的确切格式匹配。例子：

```
01/01/9999 01:00 AM - matches
12/31/9999 01:59 PM - matches
99/99/9999 99:99 AM - no match (day/month out of range)
12/31/9999 99:59 PM - no match (hours out of range)
01/01/9999 99:99 A  - no match (no match on A) 
```

完整的 JS 示例：

```
var re = /[0-1]\d\/[0-3]\d\/\d{4} [0-1]\d:[0-5]\d [AP][M]/; // [aApP][mM] for case insensitive AM/PM
var date = '10/21/2011 06:00 AM';
if (re.test(date) && date.parseExact(date, ['MM/dd/yyyy hh:mm tt']){
    // date is exact format and valid
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:23:09.230

更严格的正则表达式：

```
/[01]\d\/[0-3]\d\/\d{4} [01]\d:[0-5]\d [AP]M/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-02T10:37:07.357

试试这个正则表达式的格式 dd/MM/yyyy hh:mm tt

```
"[0-3][0-9]\/[0-1][0-9]\/[0-9]{4} [0-1][0-9]:[0-5][0-9] [paPA][Mm]" 
```

上面的表达式按以下格式工作

```
01/12/9999 01:00 AM - matches
12/31/9999 01:59 PM - no match
39/19/9999 01:59 PM - matches
39/19/9999 99:99 PM - no match (time out of range)
12/31/9999 99:59 PM - no match (hours out of range) 
```

# outlook - Outlook 2007 和 2010 表格单元格格式因内容过长而丢失

> ID：12717640
> 
> 赞同：1
> 
> 时间：2012-10-03T22:13:58.230
> 
> 标签：outlook, html-table, html-email

设置：

```
 <table width="600" >
    <tr>
        <td width="400" rowspan="2" valign="top">
            With very long content here*
        </td>
        <td width="200" valign="top">
            Top-aligned content
        </td>
    </tr>
    <tr>
      <td valign="bottom">
          *Bottom-aligned content loses vertical alignment
             and appears as if valign="middle"              
       </td>
    </tr>
 </table> 
```

示例代码在 jsfiddle 中，因为它太长（触发错误需要大量内容）。

所以看看这些：

[http://jsfiddle.net/webhelpla/XZyg2/](http://jsfiddle.net/webhelpla/XZyg2/)作为电子邮件发送看起来不错

[http://jsfiddle.net/webhelpla/XZyg2/1/](http://jsfiddle.net/webhelpla/XZyg2/1/)作为电子邮件发送：底部对齐的内容不再是底部对齐。

对此有任何解决方法的想法和经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T18:02:36.970

也尝试添加`vertical-align:bottom;`，

```
 <td valign="bottom" style='vertical-align:bottom;' >
      *Bottom-aligned content loses vertical alignment
         and appears as if valign="middle"              
   </td> 
```

试试[这个](http://jsfiddle.net/XZyg2/2/)小提琴。我`rowspan=2`从 td 中删除了，总是使用 cellpadding 代替它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:39:03.510

将 table-layout:fixed 添加到表格的 css 中，看看是否有帮助。Coder1984 在 td 中添加“style =”标签是正确的，因为一些电子邮件客户端在这方面做得更好......

无论如何，很难预测 html 电子邮件将如何在各种客户端中呈现。我[在 acid 上使用电子邮件](http://emailonacid.com)来检查各种客户端的渲染，从 webmail 通过电子邮件客户端到移动设备......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T21:47:55.250

Outlook 的块内容超过一定大小（如果我没记错的话是 2300 像素）存在问题。您*可以避免*右侧行中的第三个单元格的问题：

```
 <table width="600" >
    <tr>
        <td width="400" rowspan="3" valign="top">
            With very long content here*
        </td>
        <!-- Add minimal heights to force the middle row to take the space -->
        <td width="200" valign="top" height="1">
            Top-aligned content
        </td>
    </tr>
    <tr><td style="page-break:always"><!-- Let's make a page break *here* --></td></tr>
    <tr>
      <td valign="bottom" height="1">
          *Bottom-aligned content loses vertical alignment
             and appears as if valign="middle"              
       </td>
    </tr>
 </table> 
```

# android - Android 4 @font-face 显示

> ID：12717641
> 
> 赞同：0
> 
> 时间：2012-10-03T22:13:59.460
> 
> 标签：android, css, unicode, font-face

**在Android 4.x**上有一个非常奇怪的问题。我使用的字体不会显示**欧洲**货币代码。

在任何*iOS*和*Android 2.x*上都可以正常工作：

```
@font-face {
    font-family: 'Trade Gothic Bold';
    src: url('../../font/tradegothic-bold-webfont.eot');
    src: url('../../font/tradegothic-bold-webfont.woff') format('woff'), 
         url('../../font/tradegothic-bold-webfont.ttf') format('truetype'), 
         url('../../font/tradegothic-bold-webfont.svg#webfontmlgY0et7') format('svg');
    font-weight: normal;
    font-style: normal;
}

body{
    font-family: 'Trade Gothic Bold', Arial, Helvetica, Geneva, sans-serif;
    text-transform: uppercase;
} 
```

奇怪的是，在*4.x*`Trade Gothic Font`的其他地方看起来都很好，甚至其他货币代码也呈现得很好。*`(dollars, pounds, etc)`*

 *有人遇到过这个吗？我通过检测用户代理并将字体切换为 arial 来强制修复，并且渲染效果很好。当我告诉他们这是字体问题时，PM 不太相信我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T09:59:33.237

有一个类似的问题，即MyFonts 许可的**Android 4.0.x**`Trade Gothic Font`手机根本没有在本机浏览器上获取（而不是 Chrome for Android）。

 **一旦确认 css 是正确的并且`truetype`字体文件已由浏览器下载，我尝试将`.ttf`文件替换为相同的字体，但来自不同的提供商，结果证明可以正确呈现字体。

所以请记住，至少对于这种特定字体，某些二进制文件可能在 Android 浏览器上存在问题。***

# javascript - 使用 Highcharts 按 ID 选择一个点

> ID：12717643
> 
> 赞同：6
> 
> 时间：2012-10-03T22:14:16.880
> 
> 标签：javascript, highcharts

使用 Highcharts，如何使用它的 id 选择一个点？例如，如果我使用以下代码创建图表：

```
 chart1 = new Highcharts.Chart({
         chart: {
            renderTo: 'container',
            type: 'scatter'
         },
         title: {
            text: 'Fruit Consumption'
         },
         xAxis: {
            categories: ['Apples', 'Bananas', 'Oranges']
         },
         yAxis: {
            title: {
               text: 'Fruit eaten'
            }
         },
         series: [{
            name: 'Jane',
            data: [{
                name: 'Point1',
                x: 1,
                y: 2
            }, {
                name: 'Point2',
                x: 2,
                y: 5
            }]
         }, {
            name: 'John',
            data: [5, 7, 3]
         }]
      });
   }); 
```

工具提示告诉我，当我将鼠标悬停在一个点上时，id 是什么。但是，我无法弄清楚识别这一点的语法。我知道`chart1.series[0].name`返回`Jane. Also,` chart1.series[0].data[0].name `returns`point1`有没有一种简单的方法可以让我只知道'point1'来选择点并改变颜色？

我想知道除了每次循环遍历所有点之外是否还有更有效的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-03T23:20:22.407

您可以`id`为想要获得的每个点设置一个。

```
series: [{
    name: 'Jane',
    data: [{
        'name': 'Point1',
        'id': 'point1',
        'x': 1,
        'y': 2
    }, {
        'name': 'Point2',
        'id': 'point2',
        'x': 2,
        'y': 5
    }]
}, {
    name: 'John',
    data: [5, 7, 3]
}] 
```

那么就可以通过下面的代码来理解了。

```
// assuming that chart is your chart var
chart.get('point1'); 
```

[**演示**](http://jsfiddle.net/WRcj9/47/)

或者，如果您不想设置一个，`id`您可以通过简单的循环`points`来比较`name`您想要找到的`point name`.

*参考*：

*   [http://api.highcharts.com/highstock#object-Chart](http://api.highcharts.com/highstock#object-Chart)

# json - 子 JSON 对象中的 JS 渲染 For Loop

> ID：12717650
> 
> 赞同：0
> 
> 时间：2012-10-03T22:15:08.210
> 
> 标签：json, jsrender

试图使这项工作。我需要在新 TD 之间显示 FIRST_NAME 和 LAST_NAME 值。该值存储在数据项的对象中。我似乎无法循环遍历子对象。

模板示例

```
<script id="row_tmpl" type="text/x-jsrender">
      <tr id="{{>id}}">
        <td class="textC">{{>id}}</td>
        <td class="">{{>email}}</td>
        {{for data}}

            ??????

        {{/for}}
      </tr>
</script> 
```

下面是发送到模板的 json 对象的示例（实际上，data.results 是发送到模板的）

```
{
  "results":[
     {
     "id":"1",
     "email":"aaaa@test.com",
     "data":{
        "1":{
           "first_name":{
              "value":"Name 1",
              "public":"1",
              "field":"1",
              "mandatory":"1",
              "possible_value":"",
              "type":"text"
           },
           "last_name":{
              "value":"Name 2",
              "public":"1",
              "field":"2",
              "mandatory":"1",
              "possible_value":"",
              "type":"text"
           }
        }
     }
  },
  {
     "id":"2",
     "email":"test2@test.com",
     "data":{
        "2":{
           "first_name":{
              "value":"Name 3",
              "public":"0",
              "field":"1",
              "mandatory":"1",
              "possible_value":"",
              "type":"text"
           },
           "last_name":{
              "value":"Name 4",
              "public":"0",
              "field":"2",
              "mandatory":"1",
              "possible_value":"",
              "type":"text"
           }
        }
     }
  }
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:37:22.817

这是一个结构不佳的回应。我**不需要**知道`id`of`data`的父级来访问它的子级。另外，`data`不是数组。

```
<script id="row_tmpl" type="text/x-jsrender">
      <tr id="{{>id}}">
        <td class="textC">{{>id}}</td>
        <td class="">{{>email}}</td>
        <td class="">{{>data.{{:id}}.first_name.value}}</td>
        <td class="">{{>data.{{:id}}.lastt_name.value}}</td>
      </tr>
</script> 
```

# javascript - 在 d3.js 中制作弧线

> ID：12717652
> 
> 赞同：15
> 
> 时间：2012-10-03T22:15:12.097
> 
> 标签：javascript, canvas, svg, d3.js, data-visualization

我正在使用 javascript 库 d3.js ( [http://d3js.org/](http://d3js.org/) ) 来创建画布数据可视化。我正在尝试制作弧线，但它不接受我数组中的数据参数。有谁知道我做错了什么？这是我的代码：

```
var chartConfig = { "canvasSize" : 800 }

var radius = chartConfig.canvasSize / 2;
var pi = Math.PI;

var vis = d3.select("#chart").append("svg")
    .attr("width", radius * 2)
    .attr("height", radius * 2)
    .append("g")
    .attr("transform", "translate(" + radius + "," + radius + ")");

var arcData = [
  {aS: 0, aE: 45,rI:radius/2,rO:radius}
];
var arc = vis.selectAll("arc").data(arcData).enter().append("arc");
arc.attr("innerRadius", function(d){d.rI}).attr("outerRadius",function(d){d.rO}).attr("class","arc");

function degToRad(degrees){
  return degrees * (pi/180);
} 
```

![在此处输入图像描述](../Images/0b1834502609535480dc6826e517f670.png)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-03T22:54:33.060

SVG中没有`arc`元素，需要定义合适的路径元素。幸运的是，有一个`d3`辅助函数可以做到这一点。

```
var arc = d3.svg.arc()
    .innerRadius(50)
    .outerRadius(70)
    .startAngle(45 * (Math.PI/180)) //converting from degs to radians
    .endAngle(3) //just radians

vis.append("path")
    .attr("d", arc)
    .attr("transform", "translate(200,200)") 
```

[http://jsfiddle.net/g0r9n090/](http://jsfiddle.net/g0r9n090/)的工作示例；

# emacs - 自定义组织模式导出

> ID：12717654
> 
> 赞同：9
> 
> 时间：2012-10-03T22:15:16.047
> 
> 标签：emacs, org-mode

所以，一段时间以来，我一直在使用 org-mode 来记录我的研究笔记。我喜欢如何无缝导出到 Latex（用于我的论文）和 html（用于我的博客）。但是，每当我使用带有#+LATEX_HEADER 的\newcommand 定义宏时，这些宏根本不会出现在HTML 导出中。

我目前通过将所有这些命令作为 (\newcommand \newcommand etc. etc.) 放在顶部然后手动从 tex 文件中删除“(”和“)”来处理这个问题。

我希望我能做的是为这些命令保留一个抽屉，并自定义 org 模式的 html 和 latex 导出以适当地处理这个抽屉。

例如，我将在 org 文件中添加以下内容：

```
:LATEX_MACROS:
\newcommand{\norm}[1]{\lVert{#1}\rVert}
\newcommand{\abs}[1]{\lvert{#1}\rvert}
\newcommand{\half}{\frac{1}{2}}
:END: 
```

导出后，这将逐字显示在标题部分的乳胶文件中，并在 html 文件中显示为

```
\(
\newcommand{\norm}[1]{\lVert{#1}\rVert}
\newcommand{\abs}[1]{\lvert{#1}\rvert}
\newcommand{\half}{\frac{1}{2}}
\) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-12T19:51:18.303

在撰写本文时，这是一种适用于 Org、pdflatex 和 MathJax 的独立方式。确保抽屉（或至少`LATEXMACROS`抽屉）已导出（这是默认设置），然后在 Org 文件顶部附近插入：

```
#+OPTIONS: toc:nil
#+DRAWERS: LATEXMACROS ...

:LATEXMACROS:
@@html:<div style="display: none">@@
\(
\global\def\mymacro{...}
\global\def\mymacrow2args#1#2{...}
...
\)
@@html:</div>@@
:END:

#+TOC: headlines 
```

这可以解决以下问题：

*   我们必须使用数学环境（这里`\( ... \)`），否则 Org 会转义 TeX 语法。

*   我们不能使用`\newcommand`，因为 LaTeX 期望它们出现在序言中，而 MathJaX 没有收到它。`\newcommand`可以在序言之外使用，但是 LaTeX（与 MathJax 不同）将定义的宏限制在当前的数学环境中。我们通常希望在文件中的任何位置使用它们。

*   我们不能使用纯文本，`\def`因为它的行为类似于`\newcommand`范围（MathJax 为全局，LaTeX 为本地）。我们不能使用`\xdef`任何一个，因为 MathJax 不知道它。

*   MathJax 不知道`\global`，但这不会阻止它使用`\def`哪个是全局的。但是，它将为`\global`网页中的每个打印一个红色警告。为了摆脱它们，我们将数学环境放在一个未显示的 HTML 部分中。

*   对于 MathJax，不会及时为默认位置的目录定义宏。如果您在标题中使用宏并需要 TOC，请禁用默认设置`#+OPTIONS: toc:nil`并使用 . 手动将其添加到抽屉之后`#+TOC: headlines`。

注意事项：

*   无法预览使用自定义宏的乳胶片段，因为小的 TeX 文件 Org 构建不会包含我们的环境。

*   不像`\newcommand`，`\def`默默地替换任何东西。此外，它的语法略有不同。

*   数学环境在 pdflatex 的输出中占用了一些垂直空间，所以我们必须把它放在无关紧要的地方（例如，在第一个标题之前）。

*   这可能真的取决于版本：

    *   Org 模式在导出 LaTeX 宏方面可能会变得更好（例如，通过在解析时更智能将它们发送到 MathJax `#+LATEX_HEADER`，提供新的导出选项，而不是转义`\newcommand`并将它们放入正确处理的序言中）。

    *   MathJax 可能会开始接受或忽略`\xdef`的别名（因此不再需要 HTML 部分技巧）。`\def``\global`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T01:26:40.947

我想出了如何自己做。请注意，这可能不是最优雅的解决方案，因为它没有将乳胶部分放在乳胶文件的开头（即在 \begin{document} 之外），但它对我来说已经足够好了。

```
(setq org-export-blocks
  (cons '(latexmacro org-export-blocks-latexmacro) org-export-blocks))

(defun org-export-blocks-latexmacro (body &rest headers)
  (message "exporting latex macros")
  (cond
   ((eq org-export-current-backend 'html) (concat "\\(" body "\\)"))
   ((eq org-export-current-backend 'latex) body)
   (t nil))
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-27T17:37:24.267

替代解决方案（不是独立的），使用 Org 的动态块。

*   它没有我原始解决方案的任何警告（因为它生成了 Org 对 LaTeX 或 HTML 的实际期望）
*   可以在 LaTeX 模式下编辑宏 ( `C-c C-'`)

## 打回来

创建一个以`org-dblock-write:block-macro.el`以下内容命名的文件，并将其添加到 Emacs 的加载路径中。

```
(defun org-dblock-write:block-macro (params)
  (let ((block-name (or (plist-get params :from) "macros"))
    (org-buf (current-buffer)))
    (with-temp-buffer
      (let ((tmp-buf (current-buffer)))
    (set-buffer org-buf)
    (save-excursion
      (org-babel-goto-named-src-block block-name)
      (org-babel-mark-block)
      (let ((mblock-begin (region-beginning))
            (mblock-end (region-end)))
        (set-buffer tmp-buf)
        (insert-buffer-substring org-buf mblock-begin mblock-end)))
    (set-buffer org-buf)
    (insert "#+BEGIN_HTML\n\\(\n")
    (insert-buffer-substring tmp-buf)
    (insert "\\)\n#+END_HTML\n")
    (set-buffer tmp-buf)
    (beginning-of-buffer)
    (while (re-search-forward "^" nil t)
      (replace-match "#+LATEX_HEADER: " nil nil))
    (set-buffer org-buf)
    (insert-buffer-substring tmp-buf))))) 
```

## 组织文件

在文件的某处，创建：

*   一个名为“宏”的 LaTeX 源代码块，其中包含您的宏
*   一个空的`block-macro`动态块

您可以更改源块的名称，并`:from <custom-name>`在动态块中使用标头参数。另外，请注意`:exports none`源代码块中的 （通常您不想导出 LaTeX 源代码）。

```
#+NAME: macros
#+BEGIN_SRC latex :exports none
  \newcommand\a{a}
  \def\b{b}
  \DeclareMathOperator\c{c}
#+END_SRC
#+BEGIN: block-macro
#+END: 
```

现在`C-c C-c`与动态块上的点一起使用，它将更新为：

```
#+BEGIN: block-macro
#+BEGIN_HTML
\(
      \newcommand\a{a}
      \def\b{b}
      \DeclareMathOperator\c{c}
\)
#+END_HTML
#+LATEX_HEADER:       \newcommand\a{a}
#+LATEX_HEADER:       \def\b{b}
#+LATEX_HEADER:       \DeclareMathOperator\c{c}
#+LATEX_HEADER: 
#+END: 
```

每当修改宏时执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-28T23:36:52.287

我通常有一个包含许多自定义定义的文件，我将其用于许多文档，并且我也想在我的组织文档中使用它。

以下是`Blout's`答案的修改，因此请阅读他的答案以获取更多信息。

## 定义宏

```
(defun org-dblock-write:insert-latex-macros (params)
  (let ((text)
    (file (plist-get params :file)))
    (with-temp-buffer
      (insert-file file)
      (setq text (split-string (buffer-string) "\n" t)))
    (insert (mapconcat (lambda (str) (concat "#+LATEX_HEADER: " str)) text "\n"))
    (insert "\n#+BEGIN_HTML\n\\(\n")
    (insert (mapconcat 'identity text "\n"))
    (insert "\n\\)\n#+END_HTML"))) 
```

## 用法

文件`macros.tex`：

```
\newcommand\a{a}
\def\b{b}
\DeclareMathOperator\c{c} 
```

在组织文件中：

```
#+BEGIN: insert-latex-macros :file "macros.tex"
#+BEGIN_HTML
\(
      \newcommand\a{a}
      \def\b{b}
      \DeclareMathOperator\c{c}
\)
#+END_HTML
#+LATEX_HEADER:       \newcommand\a{a}
#+LATEX_HEADER:       \def\b{b}
#+LATEX_HEADER:       \DeclareMathOperator\c{c}
#+LATEX_HEADER: 
#+END: 
```

# jquery - 使用 jQuery 动画化隐藏 div 宽度的变化

> ID：12717655
> 
> 赞同：2
> 
> 时间：2012-10-03T22:15:16.457
> 
> 标签：jquery, html, width, hidden

几天来，我一直试图让它工作。

基本上我有一个 div`Option1Div`和一个带有 id 的图像`Option1`，当您单击图像时，它应该将`div`from更改`Hidden`为`Visible`，并将宽度从 0 更改为 500px，但到目前为止没有任何反应。

```
$('#Option1').click(function() {
  $('#Option1Div').animate({
    opacity: 0.25,
    width: "500 px"
  }, 5000, function() {
    // Animation complete.
  });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:20:49.520

如果您的 div 必须`display:none`首先使其可见，因为显示与不透明度无关。
尝试：

```
$('#Option1').click(function() {
    $('#Option1Div').css({'display':'block','opacity':0}).animate({
        opacity: 0.25,
        width: "500 px"
    }, 5000, function() {
        // Animation complete.
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:21:34.667

我可以看到您直接使用 jQuery animate() 手册中的代码。同样来自该页面：`Note: Unlike shorthand animation methods such as .slideDown() and .fadeIn(), the .animate() method does not make hidden elements visible as part of the effect.`

```
$('#Option1').click(function() {
  $('#Option1Div').show().animate({
    opacity: 0.25,
    width: "500 px"
  }, 5000, function() {
    // Animation complete.
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:32:09.733

你很近。CSS 应该是这样的：

```
 #Option1Div { width: 0; height: 100px; opacity: 0; } 
```

和 jQuery

```
$('#Option1').click(function() {
      var ele = $('#Option1Div');
      ele.animate({

               opacity    : 1,
               width      : '500px'

          }, 5000, function() {
          // Animation complete.
  });
}); 
```

jsfiddle：http: [//jsfiddle.net/haHxC/](http://jsfiddle.net/haHxC/)

# performance - Hadoop减少内存中的shuffle合并

> ID：12717659
> 
> 赞同：3
> 
> 时间：2012-10-03T22:15:50.253
> 
> 标签：performance, hadoop, shuffle, reduce

我在减少合并阶段遇到了一些性能问题，我想知道是否有人可以看看。我有一个 6 GB 数据集（文本），均匀分布在集群上，该数据集有两个键，然后我将它们 GroupBy 分成两个减速器（我正在使用级联）。所以每个reducer都有3GB的数据。我给每个 reducer 12 GB 内存，但我仍然看到 20 分钟的合并阶段。

两个问题：这个合并不应该完全在内存中完成（如果我有 12 GB 的堆）。即使没有内存合并，20 分钟似乎对于合并 3GB 来说太长了，尤其是在一个节点上有 12 个磁盘 (JBOD) 和 12 个内核的情况下。我想知道我是否将部分合并数据写入错误的位置（HDFS，与本地？）。

MAPRFS_BYTES_READ 和 MAPRFS_BYTES_WRITTEN 很有趣。初始数据集为 6GB（显示在 Map 列中）。不知何故，排序将其增加到 17GB，这似乎很奇怪。然后在减少阶段它从 MapRfs 读取 23GB，并写入 17GB。reduce阶段合并数据应该写入MapRFS还是本地FS？为什么大小会比初始数据集增长这么多（不使用压缩，它是纯文本）

* * *

```
 Counter     Map     Reduce  Total
Job Counters    Aggregate execution time of mappers(ms)     0   0   29,887,359
Launched reduce tasks   0   0   2
Rack-local map tasks    0   0   4
Launched map tasks  0   0   353
Data-local map tasks    0   0   311
cascading.flow.SliceCounters    Read_Duration   329,399     366,004     695,403
Tuples_Read     252,000,000     67,896,295  319,896,295
Tuples_Written  252,000,000     0   252,000,000
Process_End_Time    476,294,761,317,139     0   476,294,761,317,139
Write_Duration  2,713,840   0   2,713,840
Process_Begin_Time  476,294,753,764,176     2,698,557,228,678   478,993,310,992,854
FileSystemCounters  MAPRFS_BYTES_READ   6,651,978,400   21,721,014,791  28,372,993,191
MAPRFS_BYTES_WRITTEN    17,044,716,578  17,044,701,398  34,089,417,976
FILE_BYTES_WRITTEN  19,046,005  107,748     19,153,753
Map-Reduce Framework    Map input records   252,000,000     0   252,000,000
Reduce shuffle bytes    0   16,980,659,887  16,980,659,887
Spilled Records     252,000,000     0   252,000,000
Map output bytes    16,540,701,046  0   16,540,701,046
CPU_MILLISECONDS    18,861,020  7,640,360   26,501,380
Map input bytes     6,644,947,675   0   6,644,947,675
Combine input records   0   0   0
SPLIT_RAW_BYTES     97,428  0   97,428
Reduce input records    0   67,896,295  67,896,295
Reduce input groups     0   2   2
Combine output records  0   0   0
PHYSICAL_MEMORY_BYTES   324,852,019,200     15,041,486,848  339,893,506,048
Reduce output records   0   0   0
VIRTUAL_MEMORY_BYTES    626,863,038,464     26,729,230,336  653,592,268,800
Map output records  252,000,000     0   252,000,000
GC time elapsed (ms)    1,568,523   76,636  1,645,159
cascading.flow.StepCounters     Tuples_Read     252,000,000     0   252,000,000 
```

* * *

```
name    value
fs.s3n.impl org.apache.hadoop.fs.s3native.NativeS3FileSystem
mapreduce.heartbeat.100 1000
mapred.task.cache.levels    2
hadoop.tmp.dir  /tmp/hadoop-${user.name}
hadoop.native.lib   true
map.sort.class  org.apache.hadoop.util.QuickSort
mapreduce.jobtracker.recovery.dir   /var/mapr/cluster/mapred/jobTracker/recovery
mapreduce.heartbeat.1000    10000
ipc.client.idlethreshold    4000
mapred.system.dir   /var/mapr/cluster/mapred/jobTracker/system
mapreduce.cluster.reduce.userlog.retain-size    10485760
mapred.job.tracker.persist.jobstatus.hours  0
io.skip.checksum.errors false
fs.default.name maprfs:///
mapred.cluster.reduce.memory.mb -1
mapred.child.tmp    ./tmp
fs.har.impl.disable.cache   true
mapred.jobtracker.jobhistory.lru.cache.size 5
mapred.skip.reduce.max.skip.groups  0
cascading.flow.step.num 1
mapred.jobtracker.instrumentation   org.apache.hadoop.mapred.JobTrackerMetricsInst
mapr.localvolumes.path  /var/mapr/local
mapred.tasktracker.dns.nameserver   default
io.sort.factor  50
mapred.output.value.groupfn.class   cascading.tuple.hadoop.util.GroupingComparator
mapreduce.use.maprfs    true
mapred.task.timeout 600000
mapred.max.tracker.failures 4
hadoop.rpc.socket.factory.class.default org.apache.hadoop.net.StandardSocketFactory
mapred.mapoutput.key.class  cascading.tuple.io.TuplePair
fs.hdfs.impl    org.apache.hadoop.hdfs.DistributedFileSystem
mapred.queue.default.acl-administer-jobs    
mapred.output.key.class org.apache.hadoop.io.Text
mapred.skip.map.auto.incr.proc.count    true
mapred.map.runner.class cascading.flow.hadoop.FlowMapper
mapreduce.job.complete.cancel.delegation.tokens true
mapreduce.tasktracker.heapbased.memory.management   false
io.mapfile.bloom.size   1048576
tasktracker.http.threads    2
mapred.job.shuffle.merge.percent    0.70
cascading.flow.id   853276BF02049D394C31880B08C9E6CC
mapred.child.renice 10
fs.ftp.impl org.apache.hadoop.fs.ftp.FTPFileSystem
user.name   jdavis
mapred.fairscheduler.smalljob.max.inputsize 10737418240
mapred.output.compress  false
io.bytes.per.checksum   512
mapred.healthChecker.script.timeout 600000
topology.node.switch.mapping.impl   org.apache.hadoop.net.ScriptBasedMapping
mapred.reduce.slowstart.completed.maps  0.95
mapred.reduce.max.attempts  4
fs.ramfs.impl   org.apache.hadoop.fs.InMemoryFileSystem
mapr.localoutput.dir    output
mapred.skip.map.max.skip.records    0
mapred.jobtracker.port  9001
mapred.cluster.map.memory.mb    -1
mapreduce.tasktracker.prefetch.maptasks 1.0
hadoop.security.group.mapping   org.apache.hadoop.security.ShellBasedUnixGroupsMapping
mapreduce.tasktracker.task.slowlaunch   false
mapred.job.tracker.persist.jobstatus.dir    /var/mapr/cluster/mapred/jobTracker/jobsInfo
mapred.jar  /var/mapr/cluster/mapred/jobTracker/staging/jdavis/.staging/job_201210022148_0086/job.jar
fs.s3.buffer.dir    ${hadoop.tmp.dir}/s3
job.end.retry.attempts  0
fs.file.impl    org.apache.hadoop.fs.LocalFileSystem
cascading.app.name  omeg
mapred.local.dir.minspacestart  0
mapred.output.compression.type  RECORD
fs.mapr.working.dir /user/$USERNAME/
fs.maprfs.impl  com.mapr.fs.MapRFileSystem
fs.https.impl   cascading.tap.hadoop.io.HttpFileSystem
topology.script.number.args 100
io.mapfile.bloom.error.rate 0.005
mapred.cluster.max.reduce.memory.mb -1
mapred.max.tracker.blacklists   4
mapred.task.profile.maps    0-2
mapred.userlog.retain.hours 24
mapred.job.tracker.persist.jobstatus.active false
hadoop.security.authorization   false
local.cache.size    10737418240
mapred.min.split.size   0
mapred.map.tasks    353
mapred.tasktracker.task-controller.config.overwrite true
cascading.app.appjar.path   /home/jdavis/tmp/omeg.jar
mapred.output.value.class   org.apache.hadoop.io.Text
mapred.partitioner.class    cascading.tuple.hadoop.util.GroupingPartitioner
mapreduce.maprfs.use.compression    true
mapred.job.queue.name   default
mapreduce.tasktracker.reserved.physicalmemory.mb.low    0.90
cascading.group.comparator.size 3
ipc.server.listen.queue.size    128
group.name  common
mapred.inmem.merge.threshold    0
job.end.retry.interval  30000
mapred.fairscheduler.smalljob.max.maps  10
mapred.skip.attempts.to.start.skipping  2
fs.checkpoint.dir   ${hadoop.tmp.dir}/dfs/namesecondary
mapred.reduce.tasks 2
mapred.merge.recordsBeforeProgress  10000
mapred.userlog.limit.kb 0
mapred.job.reduce.memory.mb -1
webinterface.private.actions    true
io.sort.spill.percent   0.99
mapred.job.shuffle.input.buffer.percent 0.80
mapred.job.name [853276BF02049D394C31880B08C9E6CC/DCB7B555F1FC65C767B8E2CD716607AA] copyr/(1/1) /user/jdavis/ctest/end
mapred.map.tasks.speculative.execution  false
hadoop.util.hash.type   murmur
mapred.map.max.attempts 4
mapreduce.job.acl-view-job

mapred.job.tracker.handler.count    10
mapred.input.format.class   cascading.tap.hadoop.io.MultiInputFormat
mapred.tasktracker.expiry.interval  600000
mapred.jobtracker.maxtasks.per.job  -1
mapred.jobtracker.job.history.block.size    3145728
keep.failed.task.files  false
mapred.output.format.class  org.apache.hadoop.mapred.TextOutputFormat
ipc.client.tcpnodelay   false
mapred.task.profile.reduces 0-2
mapred.output.compression.codec org.apache.hadoop.io.compress.DefaultCodec
io.map.index.skip   0
mapred.working.dir  /user/jdavis
ipc.server.tcpnodelay   false
hadoop.proxyuser.root.hosts 
mapred.reducer.class    cascading.flow.hadoop.FlowReducer
cascading.app.id    A593B4669179BB6F06771249E7ADFA48
mapred.used.genericoptionsparser    true
jobclient.progress.monitor.poll.interval    1000
mapreduce.tasktracker.jvm.idle.time 10000
mapred.job.map.memory.mb    -1
hadoop.logfile.size 10000000
mapred.reduce.tasks.speculative.execution   false
mapreduce.job.dir   maprfs:/var/mapr/cluster/mapred/jobTracker/staging/jdavis/.staging/job_201210022148_0086
mapreduce.tasktracker.outofband.heartbeat   true
mapreduce.reduce.input.limit    -1
mapred.tasktracker.ephemeral.tasks.ulimit   4294967296>
fs.s3n.block.size   67108864
fs.inmemory.size.mb 200
mapred.fairscheduler.smalljob.max.reducers  10
hadoop.security.authentication  simple
fs.checkpoint.period    3600
cascading.flow.step.id  DCB7B555F1FC65C767B8E2CD716607AA
mapred.job.reuse.jvm.num.tasks  -1
mapred.jobtracker.completeuserjobs.maximum  5
mapreduce.cluster.map.userlog.retain-size   10485760
mapred.task.tracker.task-controller org.apache.hadoop.mapred.LinuxTaskController
mapred.output.key.comparator.class  cascading.tuple.hadoop.util.GroupingSortingComparator
fs.s3.maxRetries    4
mapred.cluster.max.map.memory.mb    -1
mapred.mapoutput.value.class    cascading.tuple.Tuple
mapred.map.child.java.opts  -XX:ErrorFile=/opt/cores/mapreduce_java_error%p.log
mapred.job.tracker.history.completed.location   /var/mapr/cluster/mapred/jobTracker/history/done
mapred.local.dir    /tmp/mapr-hadoop/mapred/local
fs.hftp.impl    org.apache.hadoop.hdfs.HftpFileSystem
fs.trash.interval   0
fs.s3.sleepTimeSeconds  10
mapred.submit.replication   10
fs.har.impl org.apache.hadoop.fs.HarFileSystem
mapreduce.heartbeat.10  300
cascading.version   Concurrent, Inc - Cascading 2.0.5
mapred.map.output.compression.codec org.apache.hadoop.io.compress.DefaultCodec
mapred.tasktracker.dns.interface    default
hadoop.proxyuser.root.groups    root
mapred.job.tracker  maprfs:///
mapreduce.job.submithost    c10-m001.wowrack.upstream.priv
mapreduce.tasktracker.cache.local.numberdirectories 10000
io.seqfile.sorter.recordlimit   1000000
mapreduce.heartbeat.10000   100000
mapred.line.input.format.linespermap    1
mapred.jobtracker.taskScheduler org.apache.hadoop.mapred.FairScheduler
mapred.tasktracker.instrumentation  org.apache.hadoop.mapred.TaskTrackerMetricsInst
mapred.tasktracker.taskmemorymanager.killtask.maxRSS    false
mapred.child.taskset    true
jobclient.completion.poll.interval  5000
mapred.fairscheduler.smalljob.max.reducer.inputsize 1073741824
mapred.local.dir.minspacekill   0
io.sort.record.percent  0.28
mapr.localspill.dir spill
io.compression.codec.lzo.class  com.hadoop.compression.lzo.LzoCodec
fs.kfs.impl org.apache.hadoop.fs.kfs.KosmosFileSystem
mapred.tasktracker.reduce.tasks.maximum (CPUS > 2) ? (CPUS * 0.70): 1
mapred.temp.dir ${hadoop.tmp.dir}/mapred/temp
mapred.tasktracker.ephemeral.tasks.maximum  1
fs.checkpoint.edits.dir ${fs.checkpoint.dir}
mapred.tasktracker.tasks.sleeptime-before-sigkill   5000
mapred.job.reduce.input.buffer.percent  0.0
mapred.tasktracker.indexcache.mb    10
mapreduce.task.classpath.user.precedence    false
mapreduce.job.split.metainfo.maxsize    -1
hadoop.logfile.count    10
fs.automatic.close  true
mapred.skip.reduce.auto.incr.proc.count true
mapreduce.job.submithostaddress 10.100.0.99
mapred.child.oom_adj    10
io.seqfile.compress.blocksize   1000000
fs.s3.block.size    67108864
mapred.tasktracker.taskmemorymanager.monitoring-interval    3000
mapreduce.tasktracker.volume.healthcheck.interval   60000
mapred.cluster.ephemeral.tasks.memory.limit.mb  200
mapreduce.jobtracker.staging.root.dir   /var/mapr/cluster/mapred/jobTracker/staging
mapred.acls.enabled false
mapred.queue.default.state  RUNNING
mapred.fairscheduler.smalljob.schedule.enable   false
mapred.queue.names  default
fs.hsftp.impl   org.apache.hadoop.hdfs.HsftpFileSystem
mapred.fairscheduler.eventlog.enabled   false
mapreduce.jobtracker.recovery.maxtime   480
mapred.task.tracker.http.address    0.0.0.0:50060
mapreduce.jobtracker.inline.setup.cleanup   false
mapred.reduce.parallel.copies   40
io.seqfile.lazydecompress   true
mapred.tasktracker.ephemeral.tasks.timeout  10000
mapred.output.dir   maprfs:/user/jdavis/ctest/end
mapreduce.tasktracker.group root
hadoop.workaround.non.threadsafe.getpwuid   false
io.sort.mb  512
mapred.reduce.child.java.opts   -Xmx12000m
ipc.client.connection.maxidletime   10000
mapred.compress.map.output  false
hadoop.security.uid.cache.secs  14400
mapred.task.tracker.report.address  127.0.0.1:0
mapred.healthChecker.interval   60000
ipc.client.kill.max 10
ipc.client.connect.max.retries  10
fs.http.impl    cascading.tap.hadoop.io.HttpFileSystem
fs.s3.impl  org.apache.hadoop.fs.s3.S3FileSystem
mapred.fairscheduler.assignmultiple true
mapred.user.jobconf.limit   5242880
mapred.input.dir    maprfs:/user/jdavis/ctest/mid
mapred.job.tracker.http.address 0.0.0.0:50030
io.file.buffer.size 131072
mapred.jobtracker.restart.recover   true
io.serializations   cascading.tuple.hadoop.TupleSerialization,org.apache.hadoop.io.serializer.WritableSerialization
mapreduce.use.fastreduce    false
mapred.reduce.copy.backoff  300
mapred.task.profile false
mapred.jobtracker.retiredjobs.cache.size    300
jobclient.output.filter FAILED
mapred.tasktracker.map.tasks.maximum    (CPUS > 2) ? (CPUS * 0.80) : 1
io.compression.codecs   org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.BZip2Codec,com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec
fs.checkpoint.size  67108864
cascading.sort.comparator.size  3 
```

* * *

```
2012-10-02 19:30:50,676 INFO org.apache.hadoop.metrics.jvm.JvmMetrics: Initializing JVM Metrics with processName=SHUFFLE, sessionId=
2012-10-02 19:30:50,737 INFO org.apache.hadoop.mapreduce.util.ProcessTree: setsid exited with exit code 0
2012-10-02 19:30:50,742 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: /proc/<pid>/status does not have information about swap space used(VmSwap). Can not track swap usage of a task.
2012-10-02 19:30:50,742 INFO org.apache.hadoop.mapred.Task:  Using ResourceCalculatorPlugin : org.apache.hadoop.mapreduce.util.LinuxResourceCalculatorPlugin@27b62aab
2012-10-02 19:30:50,903 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 9115 may have finished in the interim.
2012-10-02 19:31:01,663 INFO org.apache.hadoop.mapred.Merger: Merging 37 sorted segments
2012-10-02 19:31:01,672 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 36 segments left of total size: 1204882102 bytes
2012-10-02 19:31:03,079 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 7596 may have finished in the interim.
2012-10-02 19:31:15,487 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 4803 may have finished in the interim.
2012-10-02 19:31:15,489 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 11069 may have finished in the interim.
2012-10-02 19:33:37,821 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 20846 may have finished in the interim.
2012-10-02 19:33:59,274 INFO org.apache.hadoop.mapred.Merger: Merging 35 sorted segments
2012-10-02 19:33:59,275 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 35 segments left of total size: 1176895576 bytes
2012-10-02 19:34:02,131 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 21791 may have finished in the interim.
2012-10-02 19:34:29,927 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 22847 may have finished in the interim.
2012-10-02 19:36:32,181 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 30438 may have finished in the interim.
2012-10-02 19:37:18,243 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 3852 may have finished in the interim.
2012-10-02 19:37:26,292 INFO org.apache.hadoop.mapred.Merger: Merging 37 sorted segments
2012-10-02 19:37:26,293 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 37 segments left of total size: 1233203028 bytes
2012-10-02 19:39:07,695 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 9813 may have finished in the interim.
2012-10-02 19:39:10,764 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 10045 may have finished in the interim.
2012-10-02 19:39:56,829 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 17383 may have finished in the interim.
2012-10-02 19:40:18,295 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 19584 may have finished in the interim.
2012-10-02 19:40:32,307 INFO org.apache.hadoop.mapred.Merger: Merging 58 sorted segments
2012-10-02 19:40:32,308 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 44 segments left of total size: 1206978885 bytes
2012-10-02 19:41:35,154 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 26361 may have finished in the interim.
2012-10-02 19:43:53,644 INFO org.apache.hadoop.mapred.Merger: Merging 56 sorted segments
2012-10-02 19:43:53,645 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 56 segments left of total size: 1217287352 bytes
2012-10-02 19:46:55,246 INFO org.apache.hadoop.mapred.Merger: Merging 44 sorted segments
2012-10-02 19:46:55,246 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 44 segments left of total size: 1221163604 bytes
2012-10-02 19:49:57,894 INFO org.apache.hadoop.mapred.Merger: Merging 85 sorted segments
2012-10-02 19:49:57,895 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 62 segments left of total size: 1229975233 bytes
2012-10-02 19:52:09,914 WARN org.apache.hadoop.mapreduce.util.ProcfsBasedProcessTree: The process 25247 may have finished in the interim.
2012-10-02 19:52:52,620 INFO org.apache.hadoop.mapred.Merger: Merging 1 sorted segments
2012-10-02 19:52:52,620 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 32065409 bytes
2012-10-02 19:52:53,327 INFO org.apache.hadoop.mapred.Merger: Merging 8 sorted segments
2012-10-02 19:52:53,345 INFO org.apache.hadoop.mapred.Merger: Down to the last merge-pass, with 8 segments left of total size: 8522450575 bytes
2012-10-02 19:52:53,366 INFO cascading.flow.hadoop.FlowReducer: cascading version: Concurrent, Inc - Cascading 2.0.5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T13:53:48.497

好吧，你的问题之一。仅仅给hadoop更多的内存并期望它使用它并且事情自动变得更快是不够的（虽然会非常好！）。但是您需要调整配置属性以利用您的内存。即 io.sort.mb 是一种有助于加快合并/洗牌阶段的设置。

[http://hadoop.apache.org/docs/r0.20.2/mapred-default.html](http://hadoop.apache.org/docs/r0.20.2/mapred-default.html)是大多数配置属性的列表。 [http://www.slideshare.net/cloudera/mr-perf](http://www.slideshare.net/cloudera/mr-perf)给出了一些关于加速合并的明确建议（幻灯片 15）。

启用中间输出压缩（mapred.compress.map.output）通常也会加快速度。

HTH约翰内斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T08:28:19.010

这实际上并不是所有问题的答案，但我可以解释为什么要传输这么多数据。

CoGroup 用原始输入的标签标记每个键。因此，如果您的数据仅包含 2 个键，很容易看出，该数据的大小很容易翻倍（小键 + 相似大小的标签）。那就是为您提供 17GB 的数据。

接下来，353个mapper每个进程17mb（非常小，你有很多小输入文件吗？，默认情况下每个mapper都应该接收blocksize数据（mapr不要在job.xml中暴露它的大小，所以不知道你阻塞了多大是），但在 64GB 的情况下，您应该使用更少量的映射器（~100）来处理这些数据。

我实际上并不知道 Mapr Direct Shuffle (tm) 是如何工作的（现在正在调查），但看起来映射器输出被写入/暴露给 maprfs。因此，reducer 中的 shuffle/sort 阶段直接从 maprfs 下载这些部分。这给了我们 17GB（您可以在减速器日志中汇总所有大小）。但是从哪里出现额外的 6GB - 不知道。可能这个问题可以发送到mapr支持。

# jboss7.x - 为 jboss AS 7 创建骆驼模块

> ID：12717660
> 
> 赞同：0
> 
> 时间：2012-10-03T22:15:56.230
> 
> 标签：jboss7.x, apache-camel

在 Jboss AS 7 的 module.xml 文件中，我有一个依赖项

```
 <dependencies> 
    <module name="org.apache.camel.components"/>            
    </dependencies> 
```

我不知道我必须在文件夹路径 org/apache/camel/components/main/ 中包含哪些骆驼 jar 文件。

请指导我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:07:25.597

首先，您需要camel-core...可能还有其他取决于您需要的[组件](http://camel.apache.org/components.html)...

在这里下载：http: [//mvnrepository.com/artifact/org.apache.camel/camel-core](http://mvnrepository.com/artifact/org.apache.camel/camel-core)

或者如果您使用的是 Maven，只需将此依赖项添加到项目的 pom.xml...

```
<dependency>
    <groupId>org.apache.camel</groupId>
    <artifactId>camel-core</artifactId>
    <version>2.10.1</version>
</dependency> 
```

# java - HttpClient：限制连接寿命

> ID：12717663
> 
> 赞同：1
> 
> 时间：2012-10-03T22:16:12.360
> 
> 标签：java, httpclient

我同时使用 4.x 和 3.x HttpClient，我需要限制持久连接的总寿命。我需要它们被重用，但一段时间后它们必须被关闭，如果不编写自己的连接管理器，我无法找到一种方法来做到这一点。我目前正在使用 MultiThreadedHttpConnectionManager (3.x) 和 ThreadSafeClientConnManager (4.x)。

任何建议将不胜感激。

# c# - C# - 我如何使用微秒？

> ID：12717667
> 
> 赞同：0
> 
> 时间：2012-10-03T22:16:47.647
> 
> 标签：c#, timer

我正在尝试使图片框在 Winform 上平滑移动，它看起来平滑的唯一方法是如果我使用计时器并将像素速度降低到每 1 微秒 1 像素，即使这样，图片框的移动也很慢。

如何使用微秒使图片框移动得更快，同时在移动时仍保持平滑度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:25:54.913

首先，我不知道你在问什么，所以也许这会有所帮助，也许不会。

时间是一个棘手的问题。首先，所有 .net 计时器都以毫秒为分辨率，低于此分辨率，如果不使用某种类型的高分辨率计时器，您无法保证系统返回给您的内容。.net 秒表使用底层的高分辨率计时器，但没有回调机制，因此您需要使用不同的线程和轮询来构建自己的计时器。也就是说，您可能希望以不同的方式查看动画，然后移动图片框，例如使用 bit blt 或重载低级绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T00:09:41.913

我想在表单上移动控件是一个相当慢的操作。所以并不是你的计时器不够精细，它无论如何都会闪烁。您可以在[Paint](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.paint.aspx)事件中将图片框中的任何内容绘制到表单背景上，而不是移动图片框，而是在计时器滴答时将绘制的位置更改为。通过这种方式，您可以利用[双缓冲](http://msdn.microsoft.com/en-us/library/b367a457.aspx)等功能来获得更流畅的动画。您会发现在这种情况下，即使是像 40 毫秒（25Hz 刷新）这样比较大的间隔也应该足够了。

# php - Jaxl 类基回调

> ID：12717669
> 
> 赞同：3
> 
> 时间：2012-10-03T22:16:59.863
> 
> 标签：php, xmpp, ejabberd, xmpphp

我想在我的项目中将 Jaxl 实现为类，但是所有 Jaxl 示例都是基于函数的。所有示例都使用闭包来运行回调。类中的方法无法像函数基编程那样访问。如何在类中调用 wait_for_register_form()？我的基类实现是这样的（注意粗体注释）：

```
 <?php

    class XmppsController extends AppController {

    public function test() {

        require_once 'JAXL/jaxl.php';
        global $client;

        $client = new JAXL(array(
            'jid' => 'localhost',
            'log_level' => JAXL_INFO
        ));

        $client->require_xep(array(
            '0077'    // InBand Registration   
        ));

         global $thisObj;

        $thisObj = $this;

        $client->add_cb('on_stream_features', function($stanza)  {
            global $client,$thisObj;
            $client->xeps['0077']->get_form('localhost');

            return "wait_for_register_form";  **//it calls wait_for_register_form() function, but I want call this function in class. how can I solve this problem?**
        });

        $client->start();
        echo "done\n";       

    }

    public function wait_for_register_form($event, $args) {
       // something
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T12:46:22.747

演示在基类之外扩展 FSM 状态的示例[register_user.php](https://github.com/abhinavsingh/JAXL/blob/v3.x/examples/register_user.php)最初并不是为了适应您尝试实现的特定用例而编写的。我已经在[J​​AXLFsm](https://github.com/abhinavsingh/JAXL/blob/v3.x/core/jaxl_fsm.php)中推送了一个补丁，现在可以让你做同样的事情。如果您对细节感兴趣，这里是[提交日志。](https://github.com/abhinavsingh/JAXL/commit/3e2e25e6a016897f2eaf02bfa24721b1211ff63b)

现在尝试相同的方法，它应该可以工作。

# ios6 - 如何在 iOS 6 上将多个 URL 共享到 Facebook

> ID：12717674
> 
> 赞同：2
> 
> 时间：2012-10-03T22:17:31.830
> 
> 标签：ios6, facebook-ios-sdk

嗨，我正在使用 SDK 3.1 上的 facebook 共享表，它可以正常工作，除非我尝试共享 2 个 url，但它会崩溃。

```
NSArray* urls = [NSArray arrayWithObjects:@"http://google.com", @"http://yahoo.com", nil];
BOOL displayedNativeDialog = [FBNativeDialogs presentShareDialogModallyFrom:self
                                                   initialText: @"hellooo"
                                                        images: nil
                                                          urls: urls
                                                       handler:     ^(FBNativeDialogResult result, NSError *error) {
if (error) {
    NSLog(@"handler error:%@, %@", error, [error localizedDescription]);
} else {
if (result == FBNativeDialogResultSucceeded)
{
    NSLog(@"handler success");
}
else
{
    NSLog(@"handler user cancel");
}
}
}]; 
```

结果：

-[__NSCFConstantString isMusicStoreURL]：无法识别的选择器发送到实例 0x3d23e8

***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFConstantString isMusicStoreURL]：无法识别的选择器已发送到实例 0x3d23e8”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T23:24:34.643

我相信它所采用的 NSArray 的 Urls 期望的是 NSURL，而不是 NSString。您可以使用静态 URLWithString 来获取数组的 NSURL。

# hibernate - 为什么休眠返回persistantBag而不是列表？

> ID：12717679
> 
> 赞同：1
> 
> 时间：2012-10-03T22:18:14.870
> 
> 标签：hibernate

`School`我在和`Student`实体之间有一对多的映射。

```
public class School{
   @oneToMany
   private List<Student> students;
 ...
} 
```

默认情况下，Hibernate 懒惰地获取学生是有道理的，但我不清楚为什么它加载自己的 List (PersistantBag) 实现而不是 java ArrayList？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:48:16.080

List 是一个有序的集合。另一方面，[PersistantBag](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentBag.html) （根据Hibernate API）是：

> 可以多次包含相同元素的无序、无键集合。奇怪的是，Java 集合 API 没有 Bag。大多数开发人员似乎都使用 Lists 来表示 bag 语义，因此 Hibernate 遵循这种做法。

换句话说，包只是列表中项目的随机集合。

为了让 Hibernate 将您的 List 视为有序集合，它需要一个索引列（请参阅[索引集合）](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/collections.html#collections-indexed)。但是由于您没有这样的列，Hibernate 而是使用“包语义”。最后，开发人员对您来说并没有太大的区别，因为您可能不依赖订单，但如果您确实需要它，您可以添加一个索引列来获得这些功能。

包的另一个不错的功能是，您可以获取集合中某个对象的[出现次数](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentBag.html#occurrences%28java.lang.Object%29)，而在 List 中，您需要遍历整个列表才能找到它。

**其他资源：**

[为什么 Hibernate 确实“删除所有然后重新插入” - 这并不奇怪](http://assarconsulting.blogspot.com/2009/08/why-hibernate-does-delete-all-then-re.html)

# types - OCaml 类型的推理算法是如何工作的？

> ID：12717690
> 
> 赞同：11
> 
> 时间：2012-10-03T22:18:57.270
> 
> 标签：types, functional-programming, ocaml

我目前正在学习 OCaml，我很好奇 OCaml 如何进行类型推断。我知道这是通过一个称为统一的过程完成的，我尝试在已发表的论文中阅读有关该算法的信息，但符号让我失望。谁能为我描述一步一步的过程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T07:23:44.817

实际上，可以说统一是算法的实现细节。类型系统只是一组规则。规则允许检查现有的类型推导。规则没有明确提到统一，尽管统一是一种在考虑实现自动从表达式生成类型推导的算法时自然会想到的技术。

当我和你有同样的问题时，我真的很喜欢阅读[Michel Mauny 的](http://www.cse.iitd.ernet.in/~ssen/csl101/notes/mauny.pdf)“使用 Caml Light 进行函数式编程”教程。该教程现在显示了它的年龄，但是您感兴趣的章节（第 15 章）现在仍然和以前一样好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-04T20:15:50.863

学习 ML 中的 HM 类型推断的规范参考可能是 Ben Pierce 的“类型和编程语言”。您可以在该书的第 22 章中找到该主题。

类型推断算法的第一个实例称为[算法 W。](http://en.wikipedia.org/wiki/Hindley%E2%80%93Milner#Algorithm_W)

但是，您可能会惊讶地发现——事实上——OCaml 的*实现*并不简单地生成约束并解决它们！事实上，它为类型推断提供了一种更有效的基于图的算法，该算法（虽然速度很快）会导致偶尔报告奇怪的类型错误。您可以查看有关解释 ML 中的类型错误的参考资料。

# ios - 以正确的方式加速页面转换

> ID：12717692
> 
> 赞同：4
> 
> 时间：2012-10-03T22:19:08.677
> 
> 标签：ios, cordova, jquery-mobile

我想要一些提示。
我正在测试 phonegap + JQM + HTML5BoilerPlate + IOS6 的 300 毫秒延迟。
尽管我安装并调用了 new FastClick()，但我仍然会遇到同样的延迟！有没有办法测试 FastClick 的实际性能是否最佳？我正在关注和误导另一个正常的〜300ms延迟吗？`<a>`点击和页面加载事件完成之间的预期时间转换是多少？注意：html 文件包含所有页面。

```
<body ... onload='init()' ...>
function init(){ new FastClick(document.body); }

...
$.mobile.bind('vclick', ... 
   $.mobile.changePage('#...', {transition: "none"}); 
```

稍后在讨论中添加： ![![关于观察到的事件和调用的时间线](../Images/127bc618b174f98eaf28c761836826d5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T13:12:28.887

如果要加快速度，请尝试删除过渡

```
 $(document).bind("mobileinit", function() {
     $.mobile.defaultPageTransition = 'none';
     $.mobile.defaultDialogTransition = 'none';
     } 
```

您还可以创建自定义转换 [http://jquerymobile.com/demos/1.0.1/docs/pages/page-transitions.html](http://jquerymobile.com/demos/1.0.1/docs/pages/page-transitions.html)

在这里您可以更改 .in、.out 规则以设置自定义时间

```
 .in, .out {
     -webkit-animation-timing-function: ease-in-out;
     -webkit-animation-duration: 200ms;
     } 
```

希望这可以帮助。

# jquery - Jquery 建议从 JSON 数组搜索？

> ID：12717694
> 
> 赞同：0
> 
> 时间：2012-10-03T22:19:19.990
> 
> 标签：jquery, json, jquery-ui

我有一个 JSON 数组

```
json_encode($results); 
```

和一个搜索框

```
<form method="post" action="" name="search_form">
<span class="search-text">
<input class="box" name="search" type="text" id="search_input" />
</form> 
```

我想做的是在用户在搜索框中键入并建议条目时搜索 JSON 数组。数组的一部分是：

```
[{"Device_ID":"43","Image":"Amazon-Kindle-Fire.png","Manufacturer":"Amazon","Model":"Kindle Fire","Type":"Tablet"},{"Device_ID":"44","Image":"Apple-iPad.png","Manufacturer":"Apple","Model":"iPad","Type":"Tablet"} 
```

我知道问题是自动完成需要一个标签和一个值。由于我的数组是从数据库中提取的，我该如何让 AutoComplete 认为每个项目的标签由制造商 + 型号组成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T04:27:41.060

如果您需要向`$.autocomplete`'s提供 Manufacturer 和 Model 的数组`source`，请使用：

```
$(document).ready(function(){
    var devices = <?= json_encode($results); ?>;
    var results = [];
    $.each(devices, function(k,v){
        results.push(v.Manufacturer + " " + v.Model);  
    }); 
    $("#search_input").autocomplete({source: results});
}); 
```

*就是这样。对不起我之前的复杂性，我基本上是在为你做我自己的自动完成，没有意识到你正在尝试使用内置在 jQuery UI 中的那个。我用 [jquery-ui] 标记了这个问题*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T04:41:58.513

我有类似的要求，这是工作代码（ /Member/SearchMember 是返回匹配成员的 JSON 数组的页面：

```
$("#name-list").autocomplete({

            source: function (request, response) {

                var searchBy = $('#searchBy').val();

                $.ajax({

                    url: "/Member/SearchMember", type: "POST", dataType: "json",

                    data: { searchText: request.term, searchBy: searchBy, maxResults: 10 },
                    success: function (data) {
                        response($.map(data, function (item) {

                            return { label: item.FirstName + " , "+ item.Email , value: item.MemberId }
                        }))
                    }
                })
            }, 
```

# jquery - 将 Rails 变量插入 jquery

> ID：12717696
> 
> 赞同：1
> 
> 时间：2012-10-03T22:19:27.323
> 
> 标签：jquery, ruby-on-rails, ruby

我一直在关注[这个](http://davidcaylor.com/2011/05/28/time-span-sliders-in-jquery/#comments)关于多个 jquery 时间跨度滑块的指南。我试图从我的 Rails 应用程序中获取每日起始值。我正在努力让变量正确插入到 jquery 函数中。

我为一周中的每一天都有一个字段，其中包括开始时间（每天）。例如：

```
 @location.active_monday
 @location.active_tuesday
 @location.active_wednesday 
```

显示滑块的 jquery 函数如下所示：

```
_sliderhtml: function(day){
            var displayday = day.charAt(0).toUpperCase() + day.substr(1);
            var html = ""+ 
                '<div class="fieldrow spacer">' +
                    '<div>' +
                      '<input type="text" name="location['+day+'_on_wifi]" id="'+day+'-time1" value="xxxxxxx" > - '+ 
```

在输入值中，我试图从我的模型中插入值，但我无法找出正确的语法。试过：

```
 value="<%= "@location.active_wednesday" %> 
```

哪个有效，但我需要用“+day+”替换这一天。例如：

```
 value="<%= "@location.active_'+day+'" %> 
```

有没有办法做到这一点，还是我需要重新考虑？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:35:40.860

你需要重新考虑。您不能`day`在 ruby​​ 代码上使用您的 javascript 变量（例如，在您的示例中），因为它已经运行。如果您需要 javascript 能够访问这些值，则需要在呈现的视图上。

你可以尝试这样的事情：

```
var active_values = {
  monday:    "<%= @location.active_monday %>",
  tuesday:   "<%= @location.active_tuesday %>",
  wednesday: "<%= @location.active_wednesday %>"
}; 
```

然后，在您的 JS 函数上，只需访问数据：

```
'<input value="' + active_values[day] + '" />' ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:34:34.377

您需要做的是分配一个 javascript 位置变量。

```
var location = <%= @location.to_json %>; 
```

然后在你的javascript方法中你可以使用。

```
value=location["active_" + day]; 
```

# xml - 加快将数据导入 Neo4j 图形数据库的速度

> ID：12717699
> 
> 赞同：3
> 
> 时间：2012-10-03T22:19:44.887
> 
> 标签：xml, database, graph, neo4j, nodes

我正在做一个项目，我们必须通过读取带有节点信息的 xml 文件来创建图表，我已经有了这一部分，但是创建节点和关系的过程太长了，在计算机上需要 31 分钟Core 2 Duo，6GB RAM，在 Windows 上和 Fedora 上 16 分钟，在其他计算机上 Core i5 和 4GB RAM 大约需要。3 分钟，在 Core i7 计算机中。

所以，我的问题是，怎么了？我能做些什么来加速这个过程？

我修改了配置文件`neo4j.properties`，一点效果都没有，持续时间太长，有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T04:29:07.960

您是在问我们为什么两台机器之间的速度如此之慢，还是一般而言？

也许您可以向我们提供有关您正在使用此导入进行的操作的信息？

我问是因为我自己使用过批处理插入器，并且某些操作可能比其他操作花费更长的时间，例如索引查找。然而，我的用例允许我通过利用并行编程将负载优化 1 个数量级。

你能给我们提供更多信息吗？

# scheme - 用球拍实现扩展功能

> ID：12717701
> 
> 赞同：1
> 
> 时间：2012-10-03T22:19:50.967
> 
> 标签：scheme, racket

我似乎无法弄清楚如何编写这个函数。我正在尝试编写的是一个函数`expand`，它将列表`lst`作为表单的参数`'(a (2 b) (3 c))`并被评估为`'(a b b c c c)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T23:25:53.053

这看起来像家庭作业，所以我不会给你一个直接的答案。相反，我会给你一些正确方向的指示。最有用的提示是，您应该将问题拆分为两个过程，一个用于处理“外部”列表，另一个用于生成在内部子列表中编码的重复。

请注意，这两个过程是相互递归的（例如，它们相互调用）。该`expand`过程在列表上重复，而`repeat`过程在重复次数上重复。这是建议的解决方案的一般结构，填空：

```
; input:  lst - list to be processed
; output: list in the format requested
(define (expand lst)
  (cond ((null? lst)             ; if the list is null
         '())                    ; then return null
        ((not (pair? (car lst))) ; if the first element of the list is an atom
         (cons <???> <???>))     ; cons the atom and advance the recursion
        (else                    ; if the first element of the list is a list
         <???>)))                ; call `repeat` with the right params

; input: n   - number of repetitions for the first element in the list
;        lst - list, its first element is of the form (number atom)
; output: n repetitions of the atom in the first element of lst
(define (repeat n lst)
  (if (zero? n)          ; if the number of repetitions is zero
      (expand (cdr lst)) ; continue with expand's recursion
      (cons <???>        ; else cons the atom in the first element and
            <???>)))     ; advance the recursion with one less repetition 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-24T00:20:28.217

正如三年前回答的那样，我不认为我在帮助做作业。只想指出，这两个函数真的不是`need`相互递归的。作为`replicate`一个相当常见的功能，我建议：

```
(define (replicate what n)
  (if (zero? n)
      (list)
      (cons what (replicate what (- n 1)))))

(define (my-expand xs)
  (if (empty? xs)
      (list)
      (let ((x (first xs)))
        (if (list? x)
            (let ((the-number (first x))
                  (the-symbol (cadr x)))
              (flatten (cons (replicate the-symbol the-number)
                    (my-expand (rest xs)))))
            (cons x (my-expand (rest xs))))))) 
```

当然最好使用两个列表并在最后执行展平，如下所示：

```
(define (my-expand xs)
  (define (inner-expander xs ys)
    (if (empty? xs) (flatten (reverse ys))
        (let ((x (first xs)))
        (if (list? x)
            (let ((the-number (first x))
                  (the-symbol (cadr x)))
              (inner-expander (rest xs) (cons (replicate the-symbol the-number) ys)))                    
            (inner-expander (rest xs) (cons x ys))))))
  (inner-expander xs (list))) 
```

# javascript - 用 JS 定位最后一个孩子

> ID：12717702
> 
> 赞同：-5
> 
> 时间：2012-10-03T22:19:52.970
> 
> 标签：javascript, jquery, css, css-selectors

我有一些示例帖子标记：

```
<article class="post">
    <p>Some text.</p>
    <p>
        <a href="#"><img src="#"></a>
        <a href="#"><img src="#"></a>
        <a href="#"><img src="#"></a> <!-- TARGET ME (LAST) -->
    </p>
    <p>Some text. Some more text <a href="#">with link</a></p>
    <p>
        <a href="#"><img src="#"></a> <!-- TARGET ME (LAST) -->
    </p>
    <p>Some text. Some more text <a href="#">with link</a></p>
</article> 
```

上面的小提琴可以在这里看到：http: [//jsfiddle.net/alecrust/4TCyM/](http://jsfiddle.net/alecrust/4TCyM/)

**问题：**如何在不更改此标记的情况下定位每组中的最后一个图像（显示为 HTML 注释）？

我认为 JavaScript 将是必需的，因为我想不出任何 CSS 解决方案。我不能使用`img:last-child`，因为它针对上述标记中的每个图像。我不能使用`a:last-child img`，因为这不会针对上述标记中的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:23:56.267

这将使用 jQuery 的[**find()**](http://api.jquery.com/find/)来完成：

```
​$(".post p").find("img:last")​​ 
```

或者，如果您必须检查它们是否在`a`标签内，您可以执行以下操作：

```
$(".post p").find("a img:last") 
```

此外，在仔细检查之后，您的原始作品也可以：

```
$("a:last-child img"); 
```

### [演示](http://jsfiddle.net/4TCyM/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:22:47.743

`$('a:last-child').children('img')`应该做的伎俩。找到每组中的最后一个锚点，然后使用 、 或 钻取`>`img`.children()`标签`.find()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:25:14.693

```
$( "article.post p a:last-child img" ) 
```

[http://jsfiddle.net/kboucher/fUfmY/](http://jsfiddle.net/kboucher/fUfmY/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T22:23:21.863

使用`:last-of-type`！

```
p img:last-of-type { ... } 
```

或`:last-child`在锚点而不是图像上使用：

```
p a:last-child img { ... } 
```

不需要 JS ;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T22:23:35.570

```
​$​("a:last-child").has("img").css("background", "red");​​​​​​​​​​​​​​ 
```

[http://jsfiddle.net/4TCyM/1/](http://jsfiddle.net/4TCyM/1/)

# asp.net-mvc - 果园自定义模块不保存所有项目

> ID：12717703
> 
> 赞同：4
> 
> 时间：2012-10-03T22:19:56.120
> 
> 标签：asp.net-mvc, module, orchardcms

在 Orchard 构建我的第一个模块，除了保存（在某些字段上）之外的所有内容都在工作。我在保存时没有收到错误，这些字段只显示它们的默认值，没有在数据库表中插入/更新值。

我一开始只用一个属性构建了模块，然后在我确认管理员更新的内容后将更多属性添加到记录部分。现在新字段显示在编辑器中，但只有原始属性 (SoldOut) 在更新或创建时保存。我看到另一个帖子建议删除 mappings.bin 文件，但这并没有改变任何东西。谢谢你的帮助！

以下是主要课程：

```
public class ConferencePartRecord : ContentPartRecord
{
    public virtual bool OnlyShowTeaser { get; set; }
    public virtual int TheYear { get; set; }

    public virtual DateTime StartDate { get; set; }
    public virtual DateTime EndDate { get; set; }

    public virtual DateTime EarlyReg { get; set; }
    public virtual DateTime RegularReg { get; set; }
    public virtual DateTime LateReg { get; set; }

    public virtual DateTime ConfirmDate { get; set; }

    public virtual bool SoldOut { get; set; }
    public virtual bool ConferenceSpace { get; set; }

    public virtual int EarlyBirdException { get; set; }

    public virtual string NextConf { get; set; }
}

public class ConferencePart : ContentPart<ConferencePartRecord>
{
    public bool OnlyShowTeaser
    {
        get { return Record.OnlyShowTeaser; }
        set { Record.OnlyShowTeaser = value; }

    }

    public int TheYear
    {
        get { return Record.TheYear; }
        set { Record.TheYear = value; }
    }

    public DateTime StartDate
    {
        get { return Record.StartDate; }
        set { Record.StartDate = value; }
    }

    public DateTime EndDate
    {
        get { return Record.EndDate; }
        set { Record.EndDate = value; }
    }

    public DateTime EarlyReg
    {
        get { return Record.EarlyReg; }
        set { Record.EarlyReg = value; }
    }

    public DateTime RegularReg
    {
        get { return Record.RegularReg; }
        set { Record.RegularReg = value; }
    }

    public DateTime LateReg
    {
        get { return Record.LateReg; }
        set { Record.LateReg = value; }
    }

    public DateTime ConfirmDate
    {
        get { return Record.ConfirmDate; }
        set { Record.ConfirmDate = value; }
    }

    public bool ConferenceSpace
    {
        get { return Record.ConferenceSpace; }
        set { Record.ConferenceSpace = value; }
    }

    public int EarlyBirdException
    {
        get { return Record.EarlyBirdException; }
        set { Record.EarlyBirdException = value; }
    }

    public String NextConf
    {
        get { return Record.NextConf; }
        set { Record.NextConf = value; }
    }

    public bool SoldOut
    {
        get { return Record.SoldOut; }
        set { Record.SoldOut = value; }
    }

} 
```

这是我的驱动程序类：

```
public class ConferenceDriver : ContentPartDriver<AeriesConference.Models.ConferencePart>
{
    protected override DriverResult Display(ConferencePart part, string displayType, dynamic shapeHelper)
    {
        return ContentShape("Parts_Conference", () => shapeHelper.Parts_Conference(SoldOut: part.SoldOut));
    }

    //GET
    protected override DriverResult Editor(ConferencePart part, dynamic shapeHelper)
    {
        return ContentShape("Parts_Conference_Edit",
            () => shapeHelper.EditorTemplate(
                TemplateName: "Parts/Conference",
                Model: part,
                Prefix: Prefix));
    }

    //POST
    protected override DriverResult Editor(ConferencePart part, IUpdateModel updater, dynamic shapeHelper)
    {
        updater.TryUpdateModel(part, Prefix, null, null);
        return Editor(part, shapeHelper);
    }
} 
```

... migrations.cs 类（这样你就可以看到我的更新——这些都反映在数据库中）

```
 public int Create() {
        // Creating table ConferenceRecord
        SchemaBuilder.CreateTable("ConferencePartRecord", table => table
            .ContentPartRecord()
            .Column("SoldOut", DbType.Boolean)
        );

        return 1;
    }

    public int UpdateFrom1()
    {

        // Create (or alter) a part called "ConferencePart" and configure it to be "attachable".
        ContentDefinitionManager.AlterPartDefinition("ConferencePart", part => part
            .Attachable());

        return 2;
    }

    public int UpdateFrom2()
    {
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("OnlyShowTeaser", DbType.Boolean));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("TheYear", DbType.Int16));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("StartDate", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("EndDate", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("EarlyReg", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("RegularReg", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("LateReg", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("ConfirmDate", DbType.DateTime));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("ConferenceSpace", DbType.Boolean));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("EarlyBirdException", DbType.Int16));
        SchemaBuilder.AlterTable("ConferencePartRecord", table => table.AddColumn("NextConf", DbType.String));

        return 3;
    }

} 
```

最后，我的处理程序类：

```
public class ConferencePartHandler : ContentHandler
{
    public ConferencePartHandler(IRepository<ConferencePartRecord> repository)
    {
        Filters.Add(StorageFilter.For(repository));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T05:15:11.587

当然，我在发布问题 5 分钟后发现了问题。我错过了编辑器的 cshtml 文件中的一个日期时间字段，当它保存到数据库时，它在更新时死了，因为日期列不会为空。

# facebook - 通过 cron 获取 facebook 用户的封面照片

> ID：12717704
> 
> 赞同：0
> 
> 时间：2012-10-03T22:20:05.867
> 
> 标签：facebook, api, facebook-graph-api

我有一个 Facebook 应用程序，它每天获取一次用户的封面照片。为此，我曾经能够提出这样的请求：

```
$fb->api("/{$user['fbid']}?fields=cover"); 
```

我会得到`source`用户封面照片的 URL。

现在，当我提出该请求时，我只得到用户的 ID。

如果我打开应用程序并再次返回获取封面照片的脚本，所有工作都像以前一样（我得到了封面照片的详细信息）。

我觉得特别奇怪的是，在我打开应用程序后，我不仅可以访问`/me?fields=cover`，而且还可以访问授权我的应用程序`/ANY_ID?field=cover`的`ANY_ID`任何 ID。我知道在使用我的应用程序后我设置了我的`access_token`，但我不应该只能得到 `/me?fields=?cover" 吗？

我需要的是一种通过 cron 获取应用程序用户封面照片的方法（无需将我的浏览器指向应用程序（设置 access_token））。

这曾经有效，但现在有可能吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:51:39.590

它正在发生，因为当您安排 cron fb 用户可能无法访问登录时，我只在 fb api 中与登录用户一起工作，因为当您给予用户 ID 其工作时，由于没有登录会话，它无法跟踪我的请求，您可能在您的 cron 中请求登录请求之前先请求登录请求

# javascript - 设置输入字段中最后一个字符的字母间距

> ID：12717705
> 
> 赞同：0
> 
> 时间：2012-10-03T22:20:10.420
> 
> 标签：javascript, jquery, html, css

我目前正在创建一个需要字母间距的输入字段，但是如果最后一个字母被隔开，它会使所有内容不对齐......我只是想知道是否会找到输入字段的最后一个字符，这将是使用 jquery 或 JavaScript 的第 13 个字符并将字母间距设置为 0。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:22:04.933

查看[Lettering.js](http://letteringjs.com/)。它将字符包装在 HTML 中，允许您使用 CSS 更精细地操作它们。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T22:33:04.413

如果我理解正确，您正在尝试修剪尾随空格吗？

如果是这样，您可以在每次更改时简单地修剪输入字段值。这是 JQuery 解决方案。

$.trim(MyInput.value);

# objective-c - 按键排序 NSDictionary allObjects

> ID：12717707
> 
> 赞同：0
> 
> 时间：2012-10-03T22:20:24.667
> 
> 标签：objective-c, ios, cocoa-touch, nsdictionary

> **可能重复：**
> [我可以根据 Objective-C 中的键对 NSDictionary 进行排序吗？](https://stackoverflow.com/questions/3583020/can-i-sort-the-nsdictionary-on-basis-of-key-in-objective-c)

我在一个 .plist 文件中有几个字符串，我试图将它们返回到 NSDictionary 然后返回到一个数组中，但是返回的顺序与我将其保存在播放列表中的顺序不同。到目前为止我已经尝试过

```
NSDictionary *dict = [[NSDictionary alloc] initWithContentsOfFile:path];
NSArray *strs = [NSArray arrayWithArray:[dict allKeys]];
strs = [strs sortedArrayUsingSelector:@selector(localizedCaseInsensitiveCompare:)]; 
```

但这只是返回键名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:34:00.880

实际上，我只是浏览了谷歌上的几个论坛，发现这很有效：[我可以根据 Objective-C 中的键对 NSDictionary 进行排序吗？](https://stackoverflow.com/questions/3583020/can-i-sort-the-nsdictionary-on-basis-of-key-in-objective-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:39:39.137

不，你不能。

不过，你也可以用你的键来保持一个有序的数组。

# linux - 监视或记录目录权限更改？

> ID：12717708
> 
> 赞同：0
> 
> 时间：2012-10-03T22:20:34.633
> 
> 标签：linux, permissions, centos, cpanel, directory-permissions

我在运行 CentOS 5 的 cPanel 共享服务器上遇到问题，其中 public_html 文件夹下的一些目录不断从 755 更改为 777。客户说他们没有更改它，我想知道是否有办法监控这些特定的目录来找出谁/什么在改变权限。

我已经研究过使用 auditctl 并在对其进行测试并自己更改权限后，我在日志中看不到任何内容，所以我不确定我是否做对了，或者是否有可能。

是否有人对我如何找出更改权限的内容有任何建议或想法？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:23:59.253

使用 shell 脚本创建一个每分钟或每小时的 cron 作业，该脚本只检查`ls -hal`这几个目录的输出。然后，一旦注意到差异，您就可以做出适当的响应（即在某处写一个简单的输出以记录更改；该日志文件的时间戳将在第一次发现时为您提供）。

# iphone - 如果在 iPad 上查看，iOS 6 Smart Banner for Phone 应用程序会在网站上显示吗？

> ID：12717710
> 
> 赞同：3
> 
> 时间：2012-10-03T22:20:40.737
> 
> 标签：iphone, ios, ipad, safari

我今天刚刚发布了一个 iPhone 应用程序。我还在我的网站上实施了 Apple 的[智能横幅。](http://developer.apple.com/library/ios/ipad/#Documentation/AppleApplications/Reference/SafariWebContent/PromotingAppswithAppBanners/PromotingAppswithAppBanners.html)

如果应用程序只是一个 iPhone 应用程序（虽然它会在 iPad 上以 2 倍的速度运行，但不是通用应用程序），当在 iPad 上查看网页时是否应该显示智能横幅？

根据文档（上面的链接），智能横幅将确定它是否应该显示在设备上。 ![Apple Smart Banner 检测设备并确定是否应显示横幅](../Images/e17af48fc5702e450c4bb5e7ebf1c714.png)

**问题**：是否应该仅在 iPad 上查看网页时才为 iPhone 应用显示横幅？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-22T14:54:41.247

如果要显示检测 iPhone 与 iPad 的智能横幅，请在标签前插入以下代码：

```
<script>
if (navigator.userAgent.match(/iPad/i)) {
  $('head').append("<meta name='apple-itunes-app' content='app-id=XXYYZZ, app-argument=ios-promo'>");
} else if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i)) {
  $('head').append("<meta name='apple-itunes-app' content='app-id=PPQQRR, app-argument=ios-promo'>");
}
</script> 
```

由于脚本在关闭标签之前执行，它将作为页面加载的一部分执行，iOS 6 将识别它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T01:48:57.937

我不完全明白你的问题。如果您的意思是“横幅会出现在 iPad 上吗？”那么答案是肯定的，仅 iPhone（非通用）应用程序的横幅会出现在 iPad 上（如果您的意思是“Apple 应该改变这种行为吗？” ，那么这是一个主观问题）。

# python - Python：使用另一个大字典更新一个大字典

> ID：12717716
> 
> 赞同：19
> 
> 时间：2012-10-03T22:21:11.823
> 
> 标签：python

我正在尝试使用另一个字典中的值更新大型字典的某些值，其中它们具有相似的键（相同的日期但格式不同）。我目前正在使用的过程太慢，我想减少瓶颈。

这是我当前的解决方案（它将更新的字典写入文件）：

```
from dateutil import parser
File = open(r'E:Test1.txt','w')

b = {'1946-1-1':0,..........,'2012-12-31':5}
d = {'1952-12-12':5,........,'1994-7-2':10}

for key1, val1 in b.items():
    DateK1 = parser.parse(key1)
    Value = val1
    for key2, val2 in d.items():
        DateK2 = parser.parse(key2)
        if DateK1 == DateK2:
            d[key2] = Value        

Order= sorted(d.items(), key=lambda t: t[0])

for item in Order:
    File.write('%s,%s\n' % item)
File.close() 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-03T22:25:07.363

您应该使用该[`update`](http://docs.python.org/library/stdtypes.html#dict.update)方法来合并字典：

```
b.update(d) 
```

.

目前，您正在迭代... 中`d`的每个键，`b`这很慢。您可以通过设置两个具有匹配键的字典来解决此问题（并且相等的日期将散列相同 -*也许这里要注意的很酷的事情是 datetime 对象散列*）：

```
b1 = dict( (parser.parse(k),v) for k,v for b.iteritems() )
d1 = dict( (parser.parse(k),v) for k,v for d.iteritems() )

d1.update(b1) # update d1 with the values from b1 
```

### 编辑：

我刚刚意识到您并没有*完全*进行更新，因为只有那些共享值被更新，所以相反（再次通过迭代一次）：

```
for k_d1 in d1:
    if k_d1 in b1:
        d1[k_d1] = b1[k_d1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T23:14:11.850

建议更改：

1.  使用`.iteritems()`而不是`.items()`. 你有它的方式，在内存中创建一个对列表并迭代，这是浪费的。
2.  您说`b`和之间的日期格式不同`d`。我猜是月份和日期互换了？如果是这样，您仍然可以通过计算`d`密钥是什么然后检查成员资格来节省大量资金。

有变化的代码：

```
def switch_month_day(datestr):
  fields = datestr.split("-")
  return "%s-%s-%s" % (fields[0], fields[2], fields[1])

for key, val in b.iteritems():
  DateK = switch_month_day(key)
  if DateK in d:
    d[DateK] = val 
```

# vi - 在 VI 中将 var(a,b) 转换为 var(b,a)

> ID：12717719
> 
> 赞同：1
> 
> 时间：2012-10-03T22:21:31.610
> 
> 标签：vi, vim

是否可以使用任何命令来转换它

```
flux(1,i)
flux(2,i)
flux(3,i)
flux(4,i)
flux(5,i) 
```

在VI中对此？

```
flux(i,1)
flux(i,2)
flux(i,3)
flux(i,4)
flux(i,5) 
```

一般来说，我想转换`flux(a,b)`为`flux(b,a)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:26:07.230

做一个替换正则表达式，交换逗号周围的两组：

```
:%s/flux(\([^,]*\),\([^)]*\))/flux(\2,\1)/ 
```

分解：

```
:%s/       #global replace
flux(      #find 'flux('
\([^,]*\), #match everything until a comma into group 1
\([^)]*\)) #match everything until a ')' into group 2
/          #replace with:
flux(      #text 'flux('
\2,\1      #group 2, followed by group 1
)/         #close parenthesis and end match 
```

`g`如果单行上有多个通量调用，则在末尾添加一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:25:03.907

您可以使用替换：

```
:%s/\([0-9]\),i/i,\1/g 
```

这会将 <digit>,i 的每一次出现都变成 i,<digit>。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T22:25:08.323

是的，这是可能的。这是您给定输入的一种方式，从第一个 f 上的光标开始：

`f1<c-q>4jxlphh<c-q>4jxp`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T22:34:03.493

从命令模式：

```
:%! m4 -Dflux='`flux($2,$1)'"'" 
```

这将运行当前缓冲区`m4`以进行替换。请注意，这将正确替换跨越换行符或包含嵌套括号或递归的输入。例如，

```
flux(text that contains parens
  and (spans) a newline,flux( q, r ) ) 
```

将被替换为

```
flux(flux(r ,q) ,text that contains parens
  and (spans) a newline) 
```

如果嵌套的括号不匹配，您将收到错误消息。此外，flux 的任何参数上的前导空格都将被丢弃，但这是一个更强大的解决方案，比您可能尝试使用正则表达式匹配做的任何事情。

# actionscript-3 - Red5 和 AS3 - 文件“Mystream”被删除（不记录）

> ID：12717722
> 
> 赞同：0
> 
> 时间：2012-10-03T22:21:41.610
> 
> 标签：actionscript-3, red5

这是我第一次使用 StackExchange，所以如果我遗漏了什么，我深表歉意。

我正在尝试创建一个 AS3 Flash，它将使用网络摄像头和 RED5 媒体服务器录制视频；我被卡住了（我不是程序员，更像是一个可以做所有事情的电脑杂工）。RED5 附带的示例工作正常（尽管在 AS2 中，由于某种原因，我无法完成某些我需要做的事情），但我的代码似乎没有记录流，因为没有文件，RED5 控制台只说：

[INFO] [NioProcessor-3] org.red5.server.adapter.ApplicationAdapter - 文件 Lecture.flv 被删除

这是到目前为止的代码。（2012 年 9 月 7 日更新）

```
import flash.display.Sprite;
import flash.net.NetConnection;
import flash.net.NetStream;
import flash.media.Camera;
import flash.events.MouseEvent;
import flash.media.Microphone;
import flash.events.*;
import flash.media.Video;

var _cam:Camera
var _mic:Microphone

// create basic netConnection object
var _nc:NetConnection = new NetConnection();

_nc.client = this
// connect to the local Red5 server
_nc.connect("rtmp://localhost/myapp");
_nc.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);

//Add listeners for buttons
record_btn.addEventListener( MouseEvent.CLICK, recordvid );
stop_btn.addEventListener( MouseEvent.CLICK, stopvideo );
//submit_btn.addEventListener( MouseEvent.CLICK, onSubmit );
//Listeners

function netStatusHandler(event:NetStatusEvent):void{
trace("start netstatus handler");
if (event.info.code == "NetConnection.Connect.Success"){
   attachCamera();
                                                      }
}

function attachCamera(e:Event = null):void {
    trace("attach");
        //Attach Camera to field
        _cam=Camera.getCamera();
        _mic=Microphone.getMicrophone()
        vid.attachCamera(_cam);

}

function stopvideo(e:MouseEvent):void {
    //_ns.close();
}

function recordvid(e:MouseEvent):void {
    var _ns:NetStream = new NetStream(_nc);
     trace("publish");
     _ns.attachCamera(_cam);
     _ns.attachAudio(_mic);
     _ns.publish("lecture", "record");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T07:01:53.080

在发布流之前，您必须连接并等待成功状态。

例如 ：

```
var nc:NetConnection = new NetConnection();
nc.connect("rtmp://fms.example.com/lectureseries");
nc.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);

function netStatusHandler(event:NetStatusEvent):void{
   if (event.info.code == "NetConnection.Connect.Success"){
         var ns:NetStream = new NetStream(nc);
         ns.publish("lecture", "record");
   }
} 
```

查看[Netstream 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/NetStream.html)以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T06:28:41.430

我刚刚通过极端的谷歌搜索找到了答案，我需要在函数之外声明 Netstream 变量；否则“发布”视频是“空的”，因为垃圾收集器在某个时候破坏了我的变量。

所以在我声明的函数之外

```
var _ns:NetStream; 
```

在我声明的函数内部：

```
function recordvid(e:MouseEvent):void {
     _ns = new NetStream(_nc);
     _ns.attachCamera(_cam);
     _ns.attachAudio(_mic);
     _ns.publish("lecture", "record"); 
```

太棒了，我在[stackoverflow 中找到了答案](https://stackoverflow.com/questions/5423002/netstream-publish-webcam-to-fms-working-in-standalone-player-but-not-in-browser)

# javascript - 如何实现一个基本的自定义数据处理器

> ID：12717723
> 
> 赞同：0
> 
> 时间：2012-10-03T22:21:57.957
> 
> 标签：javascript, ckeditor

网上有没有关于如何在 CKEditor 中实现基本 dataProcessor 以使用自己的语法的示例？

据我了解（[http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Data_Processor](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Data_Processor)），您基本上只需要 2 个函数：toHtml 和 toDataFormat。

您还需要实现上述接口。

进而？

我的函数可以只包含一些 RegExp，然后使用新的 dataProcessor 作为插件吗？

BBCode-Plugin 似乎做得更多。

任何示例（假设您要替换`<b>Text</b>`为`**Text**`）都会很棒！

我真的很难在互联网上找到一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:04:58.697

你可以这样玩：

```
CKEDITOR.replace( 'editor1', {
    on: {
        getData: function( event ) {
            event.data.dataValue = event.data.dataValue.replace( /<\/?b[^>]*>/g, '**' );
        }
    }
}); 
```

然而，这是一个非常幼稚和糟糕的实现。要了解更多信息，请考虑当前的[bbcode 插件实现](https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/bbcode/plugin.js)。然后你会发现问题比看起来要复杂得多。

总之祝你好运！;)

# r - 在R中的目录中获取文件号？

> ID：12717728
> 
> 赞同：0
> 
> 时间：2012-10-03T22:22:19.377
> 
> 标签：r

在 shell 中，制作一个目录：

```
mkdir  /home/test 
```

然后，在“/home/test”中创建一个名为“.test”的文件

```
a=list.files(path = "/home/test",include.dirs = FALSE)
a
character(0)
a=list.files(path = "/home/test",include.dirs = TRUE)
a
character(0)
a=list.files(path = "/home/test/",include.dirs = TRUE)
a
character(0)
list.files(path = '/home/test', all.files=TRUE,inclued.dirs=FALSE)
[1] "."     ".."    ".test"
a=list.files(path = '/home/test', all.files=TRUE)
length(a)
[1] 3 
```

我怎样才能得到`length(a)`= 1 使用正则表达式参数`pattern=`来`list.files`修剪`.`和`..`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:25:46.810

用于`all.files=TRUE`显示所有文件名，包括隐藏文件。

```
list.files(path = '/home/test', all.files=TRUE) 
```

* * *

要回答您的编辑，一种方法是使用负数`tail`

```
tail(list.files(path = '/home/test', all.files=TRUE), -2) 
```

* * *

仅使用`pattern`参数：

```
list.files(path='/home/test', all.files=TRUE, pattern="^[^\\.]|\\.[^\\.]") 
```

`pattern`说“任何以点以外的东西开头的东西，或以点开头的任何东西，然后是点以外的东西。”

* * *

尽管它打破了您使用 的`pattern`参数的要求，但在这种情况下`list.files`，我实际上可能会`grep`绕过。`list.statements`

```
grep("^\\.*\\.$", list.files(path='/home/test', all.files=TRUE), 
     invert=TRUE, value=TRUE) 
```

上面将找到任何只包含点的文件名，然后返回其他所有内容。 `invert=TRUE`意思是“找到不匹配的名字”，`value=TRUE`意思是“返回名字而不是他们的位置”。

# python - opencv+python+linux+webcam = 不能抓帧

> ID：12717743
> 
> 赞同：2
> 
> 时间：2012-10-03T22:23:08.050
> 
> 标签：python, linux, opencv, webcam

我正在尝试使用 opencv 在 python 中编写简单的人脸检测。但不幸的是，我的 opencv 拒绝检测我的网络摄像头。我不确定它在内部是如何工作的，因为文档非常有限，但是 CaptureFromCAM(-1) 返回了一些对象，但 QueryFrame 返回了一个对象。当我尝试在奶酪中使用我的两台相机中的一台时，我可以毫无问题地获得视频。

```
 capture = cv.CaptureFromCAM(-1)
    faceCascade = cv.Load("haarcascade_frontalface_alt.xml")
    while (cv.WaitKey(15)==-1):
        img = cv.QueryFrame(capture)
        if img != None: 
          image = DetectFace(img, faceCascade)
          cv.ShowImage("face detection test", image)

    cv.ReleaseCapture(capture) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T14:04:50.077

好的，我已经想通了。基本上我的 openvc 是用 v4l（linux 视频）支持编译的。

解决此问题时，您首先需要确保您的相机与其他使用 v4l 的应用程序一起使用。如果是这种情况，那么您可以尝试使用 v4l 支持重新编译 openvc。对于 gentoo（使用 portage）来说非常简单：

```
 sudo su
    USE="v4l v4l2" emerge -av opencv 
```

对于其他包管理器，要么找出一些东西，要么使用 USE_V4L=ON 从源代码编译。

# css - Intellisense 与 MVC4 样式捆绑

> ID：12717750
> 
> 赞同：11
> 
> 时间：2012-10-03T22:23:52.527
> 
> 标签：css, asp.net-mvc-4, resharper, intellisense, bundling-and-minification

到目前为止，我找不到问题或解决此问题。我敢肯定这是我想念的简单的东西。

我有一个包含一堆缩小 CSS 的样式包，我正在用里面的类装饰 HTML 元素。*一切都很好。*

然而，Intellisense 和 ReSharper 都在困扰我关于 CSS 类未知的问题。我猜这是因为他们无法窥视捆绑包的内部。

**问题：**有没有办法解决这个问题？

```
<!-- Style Bundles in HEAD tag-->
@Styles.Render("~/bundle/style/css")
@RenderSection("styles", false);

<!-- HTML elements in BODY tag: "row" is an unknown css class -->
<div class="row">
    <p>Lorem ipsum</p>
</div> 
```

**更新：** *Visual Studio 2012。LESS 转换和智能感知适用于单个直接引用的文件。我的情况是在引用 LESS 包时智能感知中断。*

**更新 2：**这是显示的代码，`BundleConfig.cs`因为不清楚

```
var customStyles = new Bundle("~/bundle/style/css")
                      .Include("~/Content/normalize.css","~/Content/*.less");
bootstrapStyles.Transforms.Add(new LessTransform());
bootstrapStyles.Transforms.Add(new CssMinify());
bundles.Add(customStyles); 
```

请注意，我们使用`Bundle`not`StyleBundle`这是必要的，因为我们想要指定 LessTransform() 类并跳过内置的 CSS 转换器。LessTransform 对象是一个自定义对象，它简单地读取所有 LESS 内容并将其连接到 StringBuilder 上，然后调用 dotless 的转换器……输出一个巨大的 CSS 字符串，该字符串被缩小并返回。问题是为什么 VS 或 ReSharper 不能查看返回的 CSS 并帮助检查类样式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T19:06:00.013

这是 jetbrains 博客上的一篇文章。这有点过时了，但 Jura 公开表示没有计划支持 LESS（目前）。

用户：

> 是否有计划支持 LESS？我不太关心完全支持，但如果它至少可以将突出显示和代码完成支持带入 .less 文件并让它处理嵌套规则，那肯定会很好。

朱拉·戈罗霍夫斯基：

> 不，还没有这样的计划。您能否指出一个广泛使用 LESS 的公开项目，以便我们查看它以确定工作范围？

[关联](http://blogs.jetbrains.com/dotnet/2011/02/css-support-in-resharper-6/)

后期编辑： Mindscape 的[Web WorkBench](http://visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a)可能会提供一些来到此线程的人正在寻找的东西。他们对错误修复非常积极，并且一直在 LESS 世界中对智能感知进行一些可靠的改进。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-10-11T21:39:03.907

您是否已将 js 扩展安装到 Visual Studio 2012？转到工具 | 如果您安装了许多扩展和更新，然后是 SDK。

![在此处输入图像描述](../Images/e9980ec7b27a0f067bb69474de68ee88.png)

不要认为捆绑对您的智能感知有任何影响，我尝试过有无智能感知，我的智能感知仍然存在。确保您的解决方案中包含您的 css 样式表，并可能使用更具体的类进行测试，例如“onebeatconsumer”而不是“row”（这可能在某处发生冲突）

如果您使用的是 LESS，这绝对是您的问题，因为它可能无法解析 LESS 语法，因为它仅在运行时生成完整样式。标准 CSS 样式表中的样式是否适合您？

# xcode - 更改未在设备上生效，但在模拟器上生效

> ID：12717751
> 
> 赞同：0
> 
> 时间：2012-10-03T22:23:53.523
> 
> 标签：xcode, ios-simulator

在这里阅读了很长时间并找到了很多对我有帮助的提示后，我实际上一直坚持开发我的应用程序。

我正在使用 Xcode 4.5 并有一个带有四个视图的选项卡式应用程序。从几天前开始一切都很顺利。

我正在更改例如一个选项卡的图标。我运行模拟器，一切正常。在 iDevice 上运行应用程序时，图像的更改不会生效。将显示旧图像甚至选项卡的名称。即使保留旧图像并仅在情节提要的选项卡控制器中更改选项卡的顺序（而不是选项卡 1、2、3、4，例如 1、2、4、3），它也不会在设备上生效。删除设备上的应用程序不起作用。清理项目也无济于事。

我还能尝试什么？

此外，例如，在我的四个视图中，我使用了四个 Web 视图。如果我在 web 视图上调整大小，例如 50x50，在模拟器上它将被调整大小，但不会在设备上。它仍然居中并处于全视图 (420x311)

我真的很期待得到一些提示。我真的不知道我还能做什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:04:43.400

你好，英子，

最后我发现了错误。一直是我的错。

故事板很简单，或者更具体地说是本地化（德语和英语）。在模拟器中（因为它设置为英语），我看到了所有的变化。当我插入一个 iDevice（设置为德语）时，它只使用了德语的情节提要，其中大部分更改都没有生效。

我现在删除了一个，只使用一个。我的错。

感谢 eiko 提出了正确的问题！

# javascript - 如何禁用浏览器后退按钮

> ID：12717755
> 
> 赞同：0
> 
> 时间：2012-10-03T22:24:09.593
> 
> 标签：javascript, jquery, browser

我有包含 iframe 的网络应用程序。在主要部分客户端通过ajax与服务器通信，另外我添加了 beforeunload = function(){ return "something";} ，所以当用户点击浏览器后退按钮时会出现警报，当用户点击离开页面时，他将失去会话和登录页面将显示。在 iframe 部分我使用 servlet，因此当用户单击浏览器后退按钮时不会出现警报，因为只有 iframe 页面会卸载。现在我想实现什么。当用户在 iframe 中进行操作时，当他单击浏览器后退按钮时，应该会出现警报，当用户单击离开页面时，我想注销整个应用程序。当他点击时不要离开 iframe 内的页面不应该重新加载。

我试图在卸载和卸载之前使用两个事件来解决这个问题。这是在 iframe 里面：

```
var confirm = false;
var clicked = true;
$(window).on('beforeunload', function(evt){
    if(confirm){
        return "Text";
    } else {
        clicked = false;
    }
});
$(window).on('unload',function(evt){
    if(clicked){
        $(this).off('beforeunload');
        window.parent.location = window.parent.location + "/error";
    }
}); 
```

现在，当用户在 iframe 中操作单击后退按钮浏览器时，会出现警报。当点击离开页面运行良好时，退出。但是当点击不离开时，iframe中的页面会回到更早的位置，我不知道为什么:(。我想阻止它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-10T03:43:27.317

不能禁用浏览器后退按钮功能，唯一可以做的就是阻止它们。

下面是需要放置在您不希望用户使用后退按钮重新访问的页面头部的 JavaScript 片段

```
<script type = "text/javascript" >

   function preventBack(){window.history.forward();}

    setTimeout("preventBack()", 0);

    window.onunload=function(){null};

</script> 
```

假设有两个页面 Page1.aspx 和 Page2.aspx 并且 Page1.aspx 重定向到 Page2.aspx

因此，为了防止用户使用返回按钮访问 Page1.aspx，您需要将上述脚本放在 Page1.aspx 的头部，如下所示。

![在此处输入图像描述](../Images/0d17c0d2c67e08a574971337f9f94751.png)

这是原始文章：[http ://www.aspsnippets.com/Articles/Disable-Browser-Back-Button-Functionality-using-JavaScript.aspx](http://www.aspsnippets.com/Articles/Disable-Browser-Back-Button-Functionality-using-JavaScript.aspx)

# java - 从 URL 读取的奇怪 byte[] 行为

> ID：12717756
> 
> 赞同：1
> 
> 时间：2012-10-03T22:24:16.503
> 
> 标签：java, http, url, bytearray, channel

**最后，我的*最终*目标是：**

*   **从 URL 读取（这个问题是关于什么的）**
*   将检索到的 [PDF] 内容保存到数据库中的 BLOB 字段（已经确定）
*   从 BLOB 字段中读取并将该内容附加到电子邮件中
*   无需进入文件系统

以下方法的目标是获得一个`byte[]`可在下游用作电子邮件附件（以避免写入磁盘）：

```
public byte[] retrievePDF() {

         HttpClient httpClient = new HttpClient();

         GetMethod httpGet = new GetMethod("http://website/document.pdf");
         httpClient.executeMethod(httpGet);
         InputStream is = httpGet.getResponseBodyAsStream();

         byte[] byteArray = new byte[(int) httpGet.getResponseContentLength()];

         is.read(byteArray, 0, byteArray.length);

        return byteArray;
} 
```

对于特定的 PDF，该`getResponseContentLength()`方法返回 101,689 作为长度。*奇怪*的是，如果我设置一个断点并询问`byteArray`变量，它有 101,689 个字节的元素，但是，在字节 #3744 之后，数组的其余字节都是零（`0`）。 *然后，PDF 阅读器客户端（如 Adob​​e Reader）无法读取生成的 PDF。*

**为什么会这样？**

通过浏览器检索相同的 PDF 并保存到磁盘，或使用类似以下的方法（我在[对这个 StackOverflow 帖子的回答](https://stackoverflow.com/a/921400/425507)之后进行了模式化），会产生可读的 PDF：

```
public void retrievePDF() {
    FileOutputStream fos = null;
    URL url;
    ReadableByteChannel rbc = null;

    url = new URL("http://website/document.pdf");

    DataSource urlDataSource = new URLDataSource(url);

    /* Open a connection, then set appropriate time-out values */
    URLConnection conn = url.openConnection();
    conn.setConnectTimeout(120000);
    conn.setReadTimeout(120000);

    rbc = Channels.newChannel(conn.getInputStream());

    String filePath = "C:\\temp\\";
    String fileName = "testing1234.pdf";
    String tempFileName = filePath + fileName;

    fos = new FileOutputStream(tempFileName);
    fos.getChannel().transferFrom(rbc, 0, 1 << 24);
    fos.flush();

    /* Clean-up everything */
    fos.close();
    rbc.close();
} 
```

*对于这两种方法，在 Windows 中执行右键单击 > 属性...*时，生成的 PDF 的大小为 101,689 字节。

**为什么字节数组会中途“停止”？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:37:29.150

`InputStream.read`最多读取`byteArray.length`字节，但可能不会读取那么多。它返回它读取的字节数。您应该反复调用它以完全读取数据，如下所示：

```
int bytesRead = 0;
while (true) {
    int n = is.read(byteArray, bytesRead, byteArray.length);
    if (n == -1) break;
    bytesRead += n;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:36:19.123

检查 的返回值`InputStream.read`。它不会一口气读完。你必须写一个循环。或者，更好的是，使用 Apache Commons IO 来复制流。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T23:29:26.370

**101689 = 2^16 + 36153**所以看起来，缓冲区大小有 16 位限制。36153 和 3744 之间的差异可能源于标头部分已在一个 1K 左右的超小缓冲区中读取，并且已经包含一些字节。

# ios - 手动使用 Segue

> ID：12717757
> 
> 赞同：7
> 
> 时间：2012-10-03T22:24:27.917
> 
> 标签：ios, xcode, segue

我需要从同一个按钮创建两个 Segue，然后我想根据设备方向以编程方式选择使用哪一个。我遇到的问题是，您似乎只能从一个按钮创建一个转场到另一个视图，所以当我添加第二个时，它只会更改第一个。

您如何添加未链接到按钮等的 segue，以便我可以以编程方式执行，或者您应该如何执行此操作。我希望有两个基于方向动态选择的视图，而不是在旋转时通过代码移动基于对象的对象，因为有很多对象和自定义的东西，这将使拥有两个视图变得更加简单。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-04T00:25:48.327

您必须手动触发 segue。将按钮连接到一个方法，然后制作两个 segue，一个从每个视图控制器到故事板中的另一个，然后在 IB 中给它一个标识符，然后在你的方法中你可以调用“performSegueWithIdentifier:”。

**附加信息**

要进行手动转场，请从 IB 中的视图控制器对象按住 Control 单击到另一个视图控制器，该框将弹出为“Manual Segue”。只要确保它有一个标识符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T23:52:19.820

我认为您可以让按钮触发 IBAction，您可以在其中根据方向做出选择，然后以编程方式触发适当的 segue。

# tridion - 在 Tridion 2011 中模拟而不使用核心服务

> ID：12717758
> 
> 赞同：3
> 
> 时间：2012-10-03T22:24:33.240
> 
> 标签：tridion, impersonation

我正在尝试在 C# TBB 中模拟用户。是否有可能知道谁在 TBB 中发起了组件的发布操作，该组件是组件模板渲染的一部分？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T06:24:29.650

如下文所述

> [http://yatb.mitza.net/2012/05/publishing-from-template-code-using.html](http://yatb.mitza.net/2012/05/publishing-from-template-code-using.html)

获得**Current Publish 事务**后，您可以使用属性**.Creator**来获取用户。

要获取当前发布事务，您可以参考

> [http://yatb.mitza.net/2012/05/publishing-from-template-code-using.html](http://yatb.mitza.net/2012/05/publishing-from-template-code-using.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-03T22:30:51.650

在您的 TBB 中，您可以访问`engine.GetSession()`，它返回一个`Session`包含`User`信息的对象，我确信您可以在您的代码中执行您想要实现的目标。

多了解一下您要归档的内容会很有趣。

# java - 比较值

> ID：12717761
> 
> 赞同：1
> 
> 时间：2012-10-03T22:24:51.480
> 
> 标签：java

我正在尝试用 Java 编写游戏程序，并且正在比较两个变量。

```
int Pierce = 20;
int Defense = 50; 
```

这是比较两者的 if 语句。

```
if (Pierce > Defense)
{
    health = health - Pierce;
} 
```

当然，健康已经在程序的早期初始化。所以你可以看到穿孔小于防御。在比赛中，无论价值如何，穿孔都应该总是击败防守。有什么方法可以使这始终正确吗？我觉得它好像非常愚蠢，但我查看了所有关系运算符，它们似乎只比较值、相等性和不等式的测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:26:52.993

完全摆脱`if()`：

```
health = health - pierce; 
```

或者，如果您使用速记：

```
health -= pierce; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-03T22:38:43.240

这是另一个答案：

```
if(health -= Pierce) {
  //Do something
} 
```

# java - 使用 jEditor.setText() 在 JEditorPane 中显示 HTML 会使其闪烁

> ID：12717773
> 
> 赞同：5
> 
> 时间：2012-10-03T22:25:43.930
> 
> 标签：java, swing, jeditorpane

我正在尝试使用 JEditorPane 来显示一些 HTML 文本。出于某种原因，我必须使用 setText() 方法。但是，这会使 JEditorPane 闪烁。原因是每次更新**editorPane.setText(msgBuffer);之后** 我必须将光标移到文档**editorPane.setCaretPosition((editorPane.getDocument()).getLength()-1)**的末尾，因为我希望最近的文本行出现在文档的底部。我为你们提供了整个代码，让你们自己看看。我已经看到了许多关于使用 document.insertString 的建议，但就此而言，我必须使用我不感兴趣的单个属性。有什么办法可以让这段代码无闪烁运行吗？

```
import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.text.Document;
import javax.swing.text.html.HTMLEditorKit;
import javax.swing.text.html.StyleSheet;

public class CMessageWindow {

    private static final String ERROR   = "ERROR"; 
    private static final String MESSAGE = "msg";
    private  JScrollPane scrollPane;
    public  JEditorPane  editorPane;
    private  HTMLEditorKit kit;
    private  String msgBuffer=new String("");
    private static CMessageWindow window=null;
    private static JFrame frameContainer=null;

    private CMessageWindow()
    {
        editorPane  = new JEditorPane ();
        editorPane.setEditable(false);
        editorPane.setContentType("text/html");
        kit = new HTMLEditorKit();
        editorPane.setEditorKit(kit);

        StyleSheet styleSheet = kit.getStyleSheet();
        styleSheet.addRule("."+MESSAGE+" {font: 10px monaco; color: black; }");
        styleSheet.addRule("."+ERROR+" {font: 10px monaco; color: #ff2222; background-color : #cccccc; }");

        Document doc = kit.createDefaultDocument();
        editorPane.setDocument(doc);
        scrollPane = new JScrollPane(editorPane);
    }
    public static CMessageWindow getInstance(){
        if (null==window)
        {window=new CMessageWindow();}
        return window;
    }
/**
 * The core
 * @param sMessage
 * @param sType
 */
    private void updateMessages(final String sMessage, final String sType)

    {
        String sMessageHTML=""; 
        String sTypeText="";
        if (!sMessage.equals("\r\n")){ 
            sTypeText = sType+": ";
        }

        sMessageHTML = sMessage.replaceAll("(\r\n|\n)", "<br/>");
        if (!sMessageHTML.equals("<br/>")) 
        {
            sMessageHTML =   "<SPAN CLASS="+sType+">"+ sTypeText+sMessageHTML + "</SPAN>";
        }

        msgBuffer=msgBuffer.concat( sMessageHTML);
        editorPane.setText(msgBuffer);
        if ((editorPane.getDocument()).getLength()>1){
            editorPane.setCaretPosition((editorPane.getDocument()).getLength()-1);
        }  
    }

    public void setContainerFrame(JFrame jFrame){
        frameContainer = jFrame;
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(frameContainer.getContentPane());
        frameContainer.getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(scrollPane)
                );
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                        .addComponent(scrollPane, javax.swing.GroupLayout.DEFAULT_SIZE, 217, Short.MAX_VALUE))
                );
    }

    public void setVisible(boolean bVisible){
        editorPane.setVisible(bVisible);
        scrollPane.setVisible(bVisible);
    }

    public void printMsg(String sMessage){
        String sType = MESSAGE;
        updateMessages(sMessage,sType);
    }

    public void printlnMsg(String sMessage){
        sMessage=sMessage.concat("\r\n");
        printMsg(sMessage);
    }

    public void printErr(String sMessage){
        String sType = ERROR;
        updateMessages(sMessage,sType);
    }

    public void printlnErr(String sMessage){
        sMessage=sMessage.concat("\r\n");
        printErr(sMessage);
    }

    public static void main(String args[]){
        CMessageWindow m_LogMgr;
        JFrame frame = new JFrame();
        m_LogMgr=CMessageWindow.getInstance();
        m_LogMgr.setContainerFrame(frame);
        frame.setVisible(true);
        frame.setSize(500, 500);

        for(int i=0;i<20;++i){
            m_LogMgr.printlnErr("MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM");
        }

        for(int i=0;i<150;++i){
            try {
                Thread.sleep(20);
            } catch (Exception e) {
            }
            m_LogMgr.printlnMsg("-----------------------");
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:37:59.603

您不应在 EDT 之外修改 UI 组件。

如果您在*updateMessages*内部添加一个调用，以便在 EDT 上进行更新，那么闪烁就会消失。

例如：

```
private void updateMessages(final String sMessage, final String sType)

{
    SwingUtilities.invokeLater( new Runnable() {
        public void run() {
            String sMessageHTML="";
            String sTypeText="";
            if (!sMessage.equals("\r\n")){
                sTypeText = sType+": ";
            }
            sMessageHTML = sMessage.replaceAll("(\r\n|\n)", "<br/>");
            if (!sMessageHTML.equals("<br/>"))
            {
                sMessageHTML =   "<SPAN CLASS="+sType+">"+ sTypeText+sMessageHTML + "</SPAN>";
            }

            msgBuffer=msgBuffer.concat( sMessageHTML);
            editorPane.setText(msgBuffer);
            if ((editorPane.getDocument()).getLength()>1){
                editorPane.setCaretPosition((editorPane.getDocument()).getLength()-1);
            }
        }
    });
} 
```

请注意，您不应在 EDT 上执行长时间运行的操作，否则您将“锁定”您的 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-23T12:47:35.950

如果您有一个长时间运行的 IO 并且之后对 GUI 进行了更新，则可以`SwingWorker`改用（请参阅[http://en.wikipedia.org/wiki/Event_dispatching_thread](http://en.wikipedia.org/wiki/Event_dispatching_thread)）

```
SwingWorker<Document, Void> worker = new SwingWorker<Document, Void>() {
    public Document doInBackground() throws IOException {
        return loadXML(); // heavy task
    }

    public void done() {
        try {
            Document doc = get();
            display(doc);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
};
worker.execute(); 
```

# javascript - jquery输入元素取消选择文本事件？

> ID：12717782
> 
> 赞同：7
> 
> 时间：2012-10-03T22:27:29.233
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [使用 .select() 取消选择在输入中选择的内容](https://stackoverflow.com/questions/5861312/unselect-what-was-selected-in-an-input-with-select)

有没有办法检测用户何时通过 jQuery 取消选择输入元素中的文本？

（注意：我*不是*在询问是否检测输入元素本身的“未选择”——即模糊——而是关于元素内的文本。）

我在做

`$('#input').select(function () {...}`

当用户选择文本时显示带有格式选项的工具栏，但我无法弄清楚如何检测用户是否清除了选择。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:42:33.587

尝试**模糊**事件

```
$('#input').on('blur',function () {
    if( this.value == ''){
         alert('Blur Event - Text box Empty');
         //Your code here
     }
}); 
```

一旦输入字段失去焦点，这将触发..即; 它被取消了..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T02:57:22.443

所以经过一些实验后，我想出了一个解决方案。这就是我所做的。我创建了一个从文档中返回所选文本的函数：

```
function getSelectedText() {
    return document.selection.createRangeCollection()[0].text;
} 
```

从这里我能够适应 CupOfTea696 的在事件绑定器上使用 jQuery 的解决方案，如下所示：

```
$("#input").on("click change keyup select", function (event) {
     if(getSelectedText().length < 1)
          hideAppBar();
     else 
          showAppBar();
 }); 
```

所以我基本上检查所选文本的长度，并在此基础上显示或隐藏上下文菜单。

我仍然有模糊问题，但这与在 AppBar 中触发的点击事件有关，而不是上述解决方案。此外，我只在 Win8 上对此进行了测试，因此不确定这是否是一个有效的基于 Web 的解决方案，但我不明白为什么它不起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T22:59:08.330

没有真正的 javascript 事件可以检测到这一点。这里最好的解决方案是检查模糊、焦点、keydown 和 mousedown 事件。这将是最完整的解决方案，即使它并非完美无缺。您可以使用 .on 方法将它同时绑定到所有事件。

```
$("#input").select(function() {
    //do something here
});

$("#input").on("blur focus keydown mousedown", function() {
    //do something else here
});​ 
```

同样，这不是一个完整的解决方案，因为模糊事件可以在不清除选择的情况下发生。但这是你能做的最好的。

# windows-authentication - Windows 身份验证角色

> ID：12717784
> 
> 赞同：2
> 
> 时间：2012-10-03T22:27:35.907
> 
> 标签：windows-authentication

我已经使用 Windows Auth 创建了一个 MVC4 Web 应用程序。是否可以定义哪些用户可以使用类似的东西访问： [Authorize(Roles="Admin")] 而不依赖于 AD 即在数据库表或应用程序本身中指定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:30:27.843

绝对地。您需要创建一个自定义角色提供程序，以根据您在后端拥有的任何内容检查角色成员资格。

自定义角色提供程序派生自`System.Web.Security.RoleProvider`，您至少需要覆盖`GetRolesForUser`和`IsUserInRole`方法。

`GetRolesForUser`方法是`Authorize`属性使用的方法。用户通过身份验证后，该属性使用用户的 SamAccountName 调用此方法，并期望该方法返回`string[]`包含用户所属角色名称的 a。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/8fw7xh74(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/8fw7xh74(v=vs.100).aspx)

# ruby-on-rails - Rails 字符串注入添加引号

> ID：12717792
> 
> 赞同：0
> 
> 时间：2012-10-03T22:28:23.727
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试将 get 请求给出的一封信输入到尾部 3 中的 Like 语句中。到目前为止，我有以下代码：

```
@entries = Entry.where("key LIKE '?%'", params[:letter]).order(:key) 
```

问题是它创建了错误类型的 sql 查询，在注入的字母周围添加了引号。它为 :letter => 'a' 创建以下 sql：

```
SELECT "entries".* FROM "entries" WHERE (key LIKE ''a'%') ORDER BY key 
```

代替：

```
SELECT "entries".* FROM "entries" WHERE (key LIKE 'a%') ORDER BY key 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:30:10.237

```
@entries = Entry.where("key LIKE ?", "#{params[:letter]}%").order(:key) 
```

# php - PHP/MySQL IP 到国家的统计页面

> ID：12717793
> 
> 赞同：0
> 
> 时间：2012-10-03T22:28:35.690
> 
> 标签：php, mysql

我目前正在为其他人转换一个脚本，在他们的旧代码中，他们有一个 CSV 文件，列出了所有 IP 和他们的国家。该文件采用以下格式：

```
16777216    17367039    AU  AUS AUSTRALIA
17367040    17432575    MY  MYS MALAYSIA
17432576    17498111    AU  AUS AUSTRALIA
17498112    17563647    KR  KOR REPUBLIC OF KOREA
17563648    17825791    CN  CHN CHINA 
```

好吧，这就是他们所做的，我将它导入到新的 MySQL 数据库中。但问题是他们这里有 111K 的记录！

要进行比较并找到国家/地区的 IP，大约需要 40 秒。目前，他们选择所有记录并与小于和大于下一个字段进行比较。

```
$datafile = file("iplist.csv");
    $countries = array();
    foreach($datafile as $data) {
        $data = explode(",", $data);
        foreach($iplist as $ipan => $ip) {
            if($ip > $data[0] && $ip < $data[1]) {
                $countries[$ip] = array($data[2], $data[4]);
            }
        }
    } 
```

当然，我知道这是一种可怕的方法，太可怕了！当我在 MySQL 中做这件事时甚至更糟，我的意思是 111K 记录就在那里。

我整天都在绞尽脑汁，想不出更好的办法来做到这一点。IP 以标准格式存储在数据库中。我以为我会从 MySQL 中进行选择，然后在 where 语句中做一个多于和少于。但是对于我的生活，我可以想到如何。考虑到这就是他们制作 IP 列表的方式：

```
foreach($log as $row) {
        $iplist[$row[2]] = $row[2];

        if($last != "") {
            $dif = $last-$row[5];
            $avgtime += $dif;
        }
        $last = $row[5];
    } 
```

我曾想过每条记录进行一次调用，但如果每个统计页面上正常显示 120 条记录，那么这将是最少的 120 次 mysql 调用。

谁能给我一个更好，更有效的方法来进行这种比较？

我正在考虑使用外部服务，但请求太多了，我认为该网站会被列入黑名单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:38:02.010

为什么不试试这个：

```
SELECT * FROM table WHERE ip_min >= $your_value and ip_max <= $your_value 
```

`ip_min`第一列数据在哪里，第二列在哪里`ip_max`。 `$your_value`显然是您已知的 ip 值。

另外关于 geoIP 位置，为什么不看看 MaxMind 等标准数据库之一。我个人喜欢使用`mod_geoip`带有 MaxMind 数据库的模块来处理 web 服务器上的国家/地区 ip geoLocation。然后，您可以每月更新此数据库，而不必担心尝试在您的应用程序中保留当前的 ​​IP 数据库。 `mod_geoip`只需将一些额外的价值暴露给`$_SERVER`你可以阅读的超全球，以获取国家代码或国家名称（甚至是城市）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:03:28.213

您应该在 mysql 查询中使用 join ：

```
SELECT s.*, g.country_code, g.country_name FROM stats s LEFT JOIN geoip g ON ( g.ip_min <= s.ip AND g.ip_max >= s.ip ) 
```

然后你会在一个查询中得到它。

将使用更快，`INNER JOIN`而不是`LEFT JOIN`但它不会选择 ip 超出范围的记录

无论如何，我认为在插入统计表之前找到该位置并使用统计记录分配国家/地区的 ID 会更好 - 你还必须加入它，但它会工作得更快

# c# - web api apicontroller 超时

> ID：12717795
> 
> 赞同：3
> 
> 时间：2012-10-03T22:28:50.310
> 
> 标签：c#, asp.net, asp.net-web-api

> **可能重复：**
> [如何在 asp.net mvc 应用程序中为一个控制器操作设置请求超时](https://stackoverflow.com/questions/579523/how-do-i-set-the-request-timeout-for-one-controller-action-in-an-asp-net-mvc-app)

我有一个 .net 的 web api (.net 4) 的 apicontroller 类

我想为控制器设置响应超时（不是全局超时）

我怎样才能做到这一点？

# mixpanel - Mixpanel：identify() 和 people.identify() 有什么区别？

> ID：12717801
> 
> 赞同：15
> 
> 时间：2012-10-03T22:29:49.187
> 
> 标签：mixpanel

Mixpanel 文档列出了两个 Javascript API：[Integration API](https://mixpanel.com/docs/integration-libraries/javascript-full-api)和[People Analytics](https://mixpanel.com/docs/people-analytics/javascript)。两者都有一种`identify()`识别用户的方法：

```
mixpanel.idenfity(...)
mixpanel.people.identify(...) 
```

它们有何不同？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-05T22:56:44.323

我知道，这是一个迟到的答案，但我也遇到了同样的问题。

据我所知：

1） mixpanel.people.identify 每次调用时都会在 mixpanel 仪表板（正在探索）中创建一个新用户，即使该特定用户已经存在，并且只是覆盖他们的活动

2) mixpanel.identify 做了更多的查找，并按预期工作，但如果以前从未见过该不同的 id，则不会创建新用户。

不用说，这两个调用应该做同样的事情，在后端使用某种 find_or_create，但它似乎是 find 或 create，这取决于您使用的是哪个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-08T10:21:53.000

[虽然它与 Android 有关，但我们仍然可以从这个文档](https://mixpanel.com/help/reference/android#identify)中了解两个版本的 identify() 之间的区别。

```
// Ensure all future events sent from
// the device will have the distinct_id 13793
mixpanel.identify("13793");

// Ensure all future people properties sent from
// the device will have the distinct_id 13793
mixpanel.getPeople().identify("13793"); 
```

# grails - 在不重启容器的情况下重新读取/重新加载 Grails 配置文件

> ID：12717803
> 
> 赞同：1
> 
> 时间：2012-10-03T22:30:10.150
> 
> 标签：grails

是否可以让 grails 基于触发器重新读取其配置文件，而无需重新启动/重新加载 Web 应用程序或容器？

触发器可以是从终止信号到文件更改或 JMX 操作的任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:32:50.123

看看这个插件：

[外部配置重新加载](http://grails.org/plugin/external-config-reload)

# c++ - 关于运算符重载和内存泄漏的 C++ 参考

> ID：12717806
> 
> 赞同：0
> 
> 时间：2012-10-03T22:30:45.400
> 
> 标签：c++, memory-leaks, reference, operator-overloading, pass-by-reference

我使用以下代码

```
Matrix operator * (const Matrix & obj)
{
    Matrix m = Matrix();

    for (int i = 0; i < 4; i++)
        for (int j = 0; j < 4; j++)
        {
            m[i][j] = 0;

            for (int k = 0; k < 4; k++)
                m[i][j] += _data[i][k] * obj._data[k][j];
        }

    return m;
} 
```

像这样

```
v1 = m_proj * m_view * m_object * v1; 
```

但我想它是非常未经优化的，因为我认为我在操作员内部创建的新矩阵正在疯狂地复制。如果我这样做

```
Matrix & operator * (const Matrix & obj)
{
    Matrix m = Matrix();

    for (int i = 0; i < 4; i++)
        for (int j = 0; j < 4; j++)
        {
            m[i][j] = 0;

            for (int k = 0; k < 4; k++)
                m[i][j] += _data[i][k] * obj._data[k][j];
        }

    return m;
} 
```

将运算符的返回类型更改为对 Matrix 的引用，整个代码完全停止工作（它编译，只是矩阵没有按应有的方式相乘）。

如果我将其更改为

```
Matrix & operator * (const Matrix & obj)
{
    Matrix & m = * new Matrix();

    for (int i = 0; i < 4; i++)
        for (int j = 0; j < 4; j++)
        {
            m[i][j] = 0;

            for (int k = 0; k < 4; k++)
                m[i][j] += _data[i][k] * obj._data[k][j];
        }

    return m;
} 
```

现在它可以工作了，但我的内存泄漏很严重。

那么我该如何解决这个问题呢？有没有优雅的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:43:10.203

您的函数正在创建一个新对象，它应该按值返回该对象。

您不能返回对局部变量的引用，并且返回对动态分配的内存的引用有多个问题：它什么也解决不了（不会减少表达式创建的对象数量，并且由于动态分配而使每个对象的创建成本更高）并增加内存泄漏。

如果没有类的定义，`Matrix`则不清楚内存是在数组中处理还是动态分配。如果它是动态分配的并且你有一个 C++11 编译器，你可以实现*移动*构造和*移动*分配，所有这些*副本*的成本都会消失。

在 C++03（以及 C++11）中，您可以实现`operator*=`并手动处理创建的对象（假设您可以有效地执行此操作）：

```
//v1 = m_proj * m_view * m_object * v1;
Matrix tmp = m_proj;
tmp *= m_view;
tmp *= m_object;
tmp *= v1;
v1 = tmp; 
```

这将创建一个临时文件并将所有乘法应用到位，从而减少副本数量。

无论如何，我不会花太多时间在这上面，因为复制 4x4 矩阵并不昂贵*。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:38:47.527

第二个版本 - 引用返回的自动存储变量 - 是未定义的行为 - 不要这样做。

第三个版本不好，您不应该这样做 - 尽可能避免动态分配。

第一个版本不应该比您预期的慢很多 - 假设所有优化都到位**并且**您的编译器支持 RVO/NRVO（它可能支持）。

另一种选择是返回一个智能指针 - 这样在类中创建的对象不会在返回时被复制，而是一个指向它的托管指针（这很容易更有效）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T22:42:23.337

你的第一个案例是正确的。它实际上可能是有效的（对于...的某些定义），因为允许编译器优化副本（即如果结果应该去，它可能会创建新对象）；这称为“返回值优化”。

您的第二个解决方案是垃圾；您正在返回对堆栈上对象的引用，该引用将在函数返回时消失。我想知道为什么它甚至没有给你警告。

正如您所观察到的，第三种解决方案会泄漏内存，因为没有任何东西可以释放“新”-ed 对象。如果启动 RVO，它并不比第一个更有效，而且实际上效率更低，因为您获得了额外的“动态内存分配”开销。

除了完全不使用 operator* 来进行乘法运算并找到更合适的 API 来将矩阵相乘之外，您对此无能为力。从您使用的名称来看，您可能可以从内部循环中提取一些乘法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T22:50:05.063

这个问题似乎更多地是关于优化而不是其他任何事情。

因此，如果您非常担心复制的潜在开销，我不明白为什么还要使用循环。

制作一个接受 16 个参数的矩阵构造函数。

然后：

```
Matrix operator * (const Matrix & obj)
{
    return Matrix(
        _data[0][0]*_obj._data[0][0] + _data[0][1]*_obj._data[1][0] + _data[0][2]*_obj._data[2][0] + _data[0][3]*_obj._data[3][0], 
        _data[1][0]*_obj._data[0][0] + _data[1][1]*_obj._data[1][0] + _data[1][2]*_obj._data[2][0] + _data[1][3]*_obj._data[3][0], 
        _data[2][0]*_obj._data[0][0] + _data[2][1]*_obj._data[1][0] + _data[2][2]*_obj._data[2][0] + _data[2][3]*_obj._data[3][0], 
        // etc...
        );
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T22:46:52.977

为了优化，您可以改用 3 参数函数：void multiply(const Matrix& a, const Matrix& b, Matrix& result)。

这样，您可以确保不会有不必要的副本。

# javascript - 如何在使用 jQuery/JavaScript 取消选中单选按钮后立即触发事件

> ID：12717807
> 
> 赞同：0
> 
> 时间：2012-10-03T22:30:45.133
> 
> 标签：javascript, jquery

我目前有一个 JS 函数，它根据选中的单选按钮的值计算分数。我希望我的函数在以后取消选中这些选中的单选按钮时更新分数字段。

HTML：

```
 <input class="calc_1" name="1" id="sec_125" type="radio" value="4">
 <input class="calc_2" name="1" id="sec_126" type="radio" value="1">
 <input class="calc_3" name="1" id="sec_127" type="radio" value="2">
 <input class="calc_4" name="1" id="sec_128" type="radio" value="3">
 <input class="calc_1" name="2" id="sec_129" type="radio" value="4">
 <input class="calc_2" name="2" id="sec_130" type="radio" value="1">
 <input class="calc_3" name="2" id="sec_131" type="radio" value="2">
 <input class="calc_4" name="2" id="sec_132" type="radio" value="3">
 <input readonly name="score_1" id="score_1" type="text" value="">
 <input readonly name="score_2" id="score_2" type="text" value=""> 
```

JS：

```
function getTotalScore(sec){
   var total = 0; 
   jQuery(".calc_"+sec+":checked").each(function() {
    total += parseInt(jQuery(this).val(),10);
    count++;
});

 jQuery("#score_"+sec).val(total);

}

jQuery(document).ready(function(){
    jQuery(".calc_1").change(function() {
      getTotalScore("1")
    });
   jQuery(".calc_2").change(function() {
    getTotalScore("2")
   });
}); 
```

目前，当分别选中“calc_1”和“calc_2”类中的单选按钮时，我的代码会更新 score_1 和 score_2 字段，但当用户从同一输入组中选择另一个单选按钮时不会更改这些值。

例如，如果用户先选择 sec_125 和 sec_130，则 score_1 应为 4， score_2 应为 1。如果用户稍后决定选择 sec_126，则 score_1 在实际应为 0 时仍保持为 4。

我如何编写一个 JS 函数，在以前选中的单选按钮现在取消选中后立即更新分数字段？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:34:14.173

每次更改后重新计算所有内容：

```
jQuery(document).ready(function(){
    jQuery(".calc_1, .calc_2").change(function() {
      calculateScore("1")
      calculateScore("2")
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:37:38.777

您应该在所有单选按钮上绑定`change`事件

```
jQuery(document).ready(function(){
   jQuery(".calc_1, .calc_2, .calc_3, .calc_4").change(function() {
     calculateScore("1");
     calculateScore("2");
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T22:39:24.113

尝试这个

```
$(document).ready(function(){
    $(".calc_1, .calc_2").on('click',function() {
      if( ! $(this).is(':checked'){ // Condition When Unchecked
          calculateScore("1");
          calculateScore("2");
      }
    });
}); 
```

# shopify - 液体错误：未定义的方法`encode_json'

> ID：12717815
> 
> 赞同：2
> 
> 时间：2012-10-03T22:31:31.733
> 
> 标签：shopify, liquid

将 json 过滤器用于集合时，我收到错误“液体错误：未定义的方法 `encode_json'”。它在我的测试店里运行良好，但在我的真实店里却不行。有任何想法吗？

这是我的“液体”（我有一个名为“Delivery”的系列）

```
{% for delivery in collections.Delivery.products %}
    {{ delivery.title }}<br />
{% endfor %}
<script>
var myproductJson={{ product | json }};
var mydeliveryJson={{ collections.Delivery.products | json}};
</script> 
```

这是生成的页面源：

```
 Ethical Addictions Delivery<br />
    Natures Roast Delivery<br />
    Round Hill Roastery Delivery<br />

<script>
var myproductJson={"id":106656988,"title":"Ethical Addictions etc...
var mydeliveryJson=Liquid error: undefined method `encode_json' for #<ProductDrop:0x000000026c8a98>;
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T22:30:02.190

我不知道可以在像这样的几个产品上使用 json 过滤器。

尝试这个：

```
<script>
var mydeliveryJson = [];
{% for delivery in collections.delivery.products %}
mydeliveryJson.push( {{ delivery | json }} );
{% endfor %}
</script> 
```

# c# - Wpf datagridrow contextmenu编译错误

> ID：12717822
> 
> 赞同：0
> 
> 时间：2012-10-03T22:33:02.790
> 
> 标签：c#, wpf

在此代码上：

```
 <DataGrid ItemsSource="{Binding Path=Category.Reports}" 
              AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
              Name="_gridReports" SelectedItem="{Binding Report}">
        <DataGrid.RowStyle>
            <Style TargetType="DataGridRow">
                <Setter Property="ContextMenu">
                    <Setter.Value>
                        <ContextMenu DataContext="{Binding Path=PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}">
                            <MenuItem Header="Удалить" Click="OnDeleteClick" 
                                    IsEnabled="{Binding Path=IsDefault, Converter={StaticResource toBoolConverter}}"/>
                            <MenuItem Header="Редактировать" Click="OnEditClick" 
                                    IsEnabled="{Binding Path=IsDefault, Converter={StaticResource toBoolConverter}}" />
                        </ContextMenu>
                    </Setter.Value>
                </Setter>
            </Style>
        </DataGrid.RowStyle>
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Name}" Header="Название" IsReadOnly="True" />
            <DataGridTextColumn Binding="{Binding Description}" Header="Описание" IsReadOnly="True" />
        </DataGrid.Columns>
    </DataGrid> 
```

编译器几乎创建了该错误消息（从俄语翻译，可能有一些错误）：

```
Invalid value "OnDeleteClick". "Click" is not event for "System.Windows.Controls.DataGridTextColumn" 
```

希望你能帮助我！请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:13:20.833

把事件变成一种风格

```
<MenuItem Header="Удалить" IsEnabled="{Binding Path=IsDefault, Converter={StaticResource toBoolConverter}}">
    <MenuItem.Style>
        <Style TargetType="MenuItem">
            <EventSetter Event="Click" Handler="OnDeleteClick" />
        </Style>
    </MenuItem.Style>
</MenuItem> 
```

或使用命令。

# c# - 未经授权使用客户端身份验证方案 NTLM

> ID：12717828
> 
> 赞同：2
> 
> 时间：2012-10-03T22:33:29.913
> 
> 标签：c#, wcf, web-services, windows-server-2008

我从调用 WCF 服务的 ASPX 页面收到以下错误。

> HTTP 请求未经客户端身份验证方案“Ntlm”授权。从服务器收到的身份验证标头是“NTLM”。

我处于负载平衡的 Web 服务器环境中，*只有当客户端 ASPX 页面在**同一*服务器上访问 WCF 服务（也在负载平衡的 Web 服务器上）时才会出现错误。

例如：
服务器 A 上的 ASPX 页面 -> 服务器 B 上的 WCF 服务 = 没有问题。
服务器 B 上的 ASPX 页面 -> 服务器 C 上的 WCF 服务 = 没有问题。
服务器 B 上的 ASPX 页面 -> 服务器 B 上的 WCF 服务 = 上面的错误。

服务器是 IIS 7.5，WCF 服务当前配置为匿名和 Windows 身份验证作为网络服务帐户运行。

这与环回保护有什么关系吗？我目前无法在应用程序和服务托管在同一台机器上的单个服务器环境中复制这些结果。

这是我对 ASPX 页面和服务的绑定：

客户：

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_Imyservice">
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Ntlm" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://loadbalancedserver/myservice/myservice.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_Imyservice"
        contract="myservice.Imyservice" name="BasicHttpBinding_Imyservice" />
    </client>
  </system.serviceModel> 
```

WCF 服务：

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpEndpointBinding">
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Ntlm" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <services>
      <service name="myservice.Service.myservice">
        <endpoint address="" bindingNamespace="http://services.company.net/myservice"
          binding="basicHttpBinding" bindingConfiguration="BasicHttpEndpointBinding"
          contract="myservice.Imyservice" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T20:05:22.483

万一有人遇到这种情况，那*是*由于 IIS 环回问题。[来自http://support.microsoft.com/kb/896861](http://support.microsoft.com/kb/896861)的注册表修复成功了。

# php - 不使用 GBK 字符集时，addslashes() 是安全的

> ID：12717829
> 
> 赞同：0
> 
> 时间：2012-10-03T22:33:37.283
> 
> 标签：php, sql, sql-injection

> **可能重复：**
> [通过 addlashes() 进行 SQL 注入的示例？](https://stackoverflow.com/questions/860954/examples-of-sql-injections-through-addslashes)

我正在使用我继承的 PHP 应用程序，它......很有趣。

保护网站安全的许多有趣方法之一是在所有内容周围使用魔术引号，据我了解，这基本上是在每个 $_GET 和 $_POST 变量周围强制转换 addlashes()。

以前的程序员坚持认为这会使网站不透风，我已经读过这只会使网站易受攻击，如果 mySQL 表使用 GBK 编码而不是，一切都使用 latin1 编码。

实用性 [以及我在这里基本上只是临时工的事实] 意味着不会发生使用 PDO 重写网站的情况，但是否值得关闭魔术引号（因此不使用 addlashes() 方法）和强制转换mysql_real_escape_string() 是否适当地围绕每个变量？

# ios - 关闭应用后 UITableView 不显示

> ID：12717830
> 
> 赞同：0
> 
> 时间：2012-10-03T22:33:44.003
> 
> 标签：ios, uitableview

我有一个`UITableView`在应用程序的持续时间内完美显示（当我测试它连接到我的机器时）。但是，如果我从机器中取出手机（我认为这会关闭应用程序的运行版本，因此下次运行它时它会从头开始运行），`UITableView`则不会显示。

我以前从来没有遇到过这种情况，所以我不知道在哪里寻找这个故障，希望我能得到一些指示。我什至不知道您可能需要查看什么代码。

# php - php mt_rand 生成 x 长度的数字，其中所述给定长度的全为零

> ID：12717833
> 
> 赞同：0
> 
> 时间：2012-10-03T22:34:02.770
> 
> 标签：php, string, random

我需要生成一串 20 位数字的数字。以 20 个零开头，以 20 个 9 结尾。`rand(0,9)`我可以通过 for 循环运行正常来轻松地做到这一点。

```
for ($i = 0; $i < 20; $i++)
{
   $rng_salt .= rand(0,9);
} 
```

但可以说，循环是一个漫长的过程。我想尝试弄清楚如何用`mt_rand(00000000000000000000, 99999999999999999999)`或类似的东西做同样的事情。如果可能的话，最好我想取消循环并将其分解为一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:38:07.357

您仍然可以将整个循环放在一行中

```
for($i = 0, $rng_salt = ""; $i < 20; $i ++, $rng_salt .= mt_rand(0, 9));
var_dump($rng_salt); 
```

你也可以到处玩

```
$rng_salt = implode("",array_map(function($var){ return mt_rand(0, 9);}, range(0,19)));
var_dump($rng_salt); 
```

做一些洗牌怎么样

```
$rng_salt = array_merge(range(0,9),range(0,9));
shuffle($rng_salt);
var_dump(implode("",$rng_salt)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T22:41:29.997

在这里跳出框框思考。生成范围的随机数到下一个小数点，然后简单地修剪第一个数字 [1]。

$rng_salt = substr(mt_rand(100000000000000000000, 199999999999999999999),1,20)

Check substr parameters. I could be off on the numbers.

# youtube - 根据标签显示所有 YouTube 视频

> ID：12717838
> 
> 赞同：0
> 
> 时间：2012-10-03T22:35:12.583
> 
> 标签：youtube, youtube-api

有没有办法可以显示来自 YouTube 的所有带有特定标签的视频？在 API 中找不到有关通过标签获取视频的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T03:37:31.480

您无法显示*所有*视频，但您可以进行搜索并返回大约 1000 个与任何给定关键字匹配的视频。这是您要用于的请求 URL `baseball`：

[http://gdata.youtube.com/feeds/api/videos?category=%7Bhttp%3A%2F%2Fgdata.youtube.com%2Fschemas%2F2007%2Fkeywords.cat%7Dbaseball](http://gdata.youtube.com/feeds/api/videos?category=%7Bhttp%3A%2F%2Fgdata.youtube.com%2Fschemas%2F2007%2Fkeywords.cat%7Dbaseball)

# active-directory - 标准域用户如何找到其 Active Directory DC 的路径？

> ID：12717840
> 
> 赞同：1
> 
> 时间：2012-10-03T22:35:24.390
> 
> 标签：active-directory

我有一个程序可以做一些很棒的事情，但需要提供一个 LDAP 路径来识别它感兴趣的用户集。我如何向相对非技术用户描述如何为他们的环境找到它？他们基本上会想要包含公司内所有用户的 DC 或 OU 的 LDAP 路径，或者至少对于他们的办公室或其他一些大组，例如`LDAP://dc=MyFirm,dc=com`或`LDAP://ou=AllFolk,dc=MyFirm,dc=com`. 我意识到在某些公司中这会很复杂，并且需要为不同的用户集提供不同的路径，但是如果我们假设有一个包含每个人的 OU 或 DC，那么普通人将如何去寻找它的 LDAP 路径？

一个相关的问题：普通用户如何找到他们应该提供的名称以使用 sysinternals AD Explorer，如下所示：

![在此处输入图像描述](../Images/cf1a8b2ff8e09db51aa5ddd357aebee6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T13:45:26.057

在您的程序中添加搜索选项或开始查询，他们可以在其中输入要搜索的域\用户名，然后从中检索您需要的信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T16:18:15.377

使用来自 Sysinternals 的 AD Explorer，可在[此处](http://technet.microsoft.com/en-us/sysinternals/bb963907.aspx)找到。

# java - 带有 Java 小程序发布本机库的 Web 浏览器

> ID：12717842
> 
> 赞同：1
> 
> 时间：2012-10-03T22:35:29.640
> 
> 标签：java, ubuntu, browser, applet, unsatisfiedlinkerror

我有一个包含多个 Java3D 小程序的网页，在 Ubuntu 上运行 Firefox 或 Chromium。我可以启动任何一个小程序，但是当我在浏览器中“返回”并尝试启动另一个 Java3D 小程序时，我得到了

```
java.lang.UnsatisfiedLinkError:Native Library /lib/libj3dcore-ogl.so already loaded in another classloader 
```

我可以关闭网络浏览器并重新启动，然后我可以启动另一个小程序，但再次尝试启动另一个小程序会导致上述错误。

与 Web 浏览器相反，我可以在 Eclipse 中运行任意数量的 Java3D 小程序。（Java 中惊人的重叠 OpenGL 窗口！）

有没有办法在另一个运行后在浏览器中运行 Java3D 小程序而不重新启动浏览器？

注意：我有一种感觉，离开页面并不意味着小程序关闭，但就浏览器而言仍在运行。也许是一个 Javascript 会在页面离开时强制小程序结束？

如果要查看错误，请从以下位置下载 zip 文件

[http://jat.sourceforge.net/node/24](http://jat.sourceforge.net/node/24)

解压，并在 deploy 中打开 index.html 以在本地运行（互联网上的小程序根本不运行 - 还没有）。然后打开一个小程序，返回并尝试运行另一个 3D 小程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:09:19.167

Ufff，这是 Java 安全性最严重的错误之一，问题很简单，当您打开页面时，您的小程序会加载本机库（我在浏览器中使用 Morena 进行扫描）然后一切正常，但是当您刷新时，您的小程序尝试重新加载 Native Library，但是浏览器将小程序保存在缓存中（这样就不需要再次下载），然后 Native 已经加载，产生安全问题，为什么不能两次加载 Native Resource （是的，你的小程序它只做一个，但每次加载小程序时都会调用它，但类加载器只在第一次创建时）。您没有解决方案... MUAJAJAJAJA！，不，真的，您可以添加您的库（使用本机资源的库）并将它们直接添加到您的 java/extensions 中，但是小程序随后将需要一些额外的步骤，而不仅仅是加载小程序。我猜你已经烧掉了你的罐子，因为它需要在小程序中运行本机代码，但直到今天我无法跳过使用本机的小程序的刷新问题，只能将它们添加到扩展文件夹

# php - 如何在 Wamp 上安装 simplesaml 作为 SP

> ID：12717843
> 
> 赞同：4
> 
> 时间：2012-10-03T22:35:31.147
> 
> 标签：php, saml, saml-2.0

我想为我的网站（Wordpress 和 ADFS）实施 SSO。为此，我在 SP 上使用 simplesamlphp（ADFS 是 idP）。

为了测试 simplesamlphp，我下载了包并安装在 wamp (D:\wamp\www\simplesamlphp) 中。我读了这个教程（http://simplesamlphp.org/docs/1.10/simplesamlphp-install），所以我创建了一个别名并配置了config.php。

但是，当我想测试此配置时，我看到此错误：“未在此服务器上找到请求的 URL /simplesaml/www/module.php/core/frontpage_welcome.php”。

这里有什么问题？

配置文件：

```
<?php
/* 
 * The configuration of simpleSAMLphp
 * 
 * $Id: config.php 3171 2012-09-25 08:54:06Z jaimepc@gmail.com $
 */

$config = array (

/**
 * Setup the following parameters to match the directory of your installation.
 * See the user manual for more details.
 *
 * Valid format for baseurlpath is:
 * [(http|https)://(hostname|fqdn)[:port]]/[path/to/simplesaml/]
 * (note that it must end with a '/')
 *
 * The full url format is useful if your simpleSAMLphp setup is hosted behind
 * a reverse proxy. In that case you can specify the external url here.
 *
 * Please note that simpleSAMLphp will then redirect all queries to the
 * external url, no matter where you come from (direct access or via the
 * reverse proxy).
 */
'baseurlpath'           => 'simplesaml/www/',
'certdir'               => 'cert/',
'loggingdir'            => 'log/',
'datadir'               => 'data/',

/*
 * A directory where simpleSAMLphp can save temporary files.
 *
 * SimpleSAMLphp will attempt to create this directory if it doesn't exist.
 */
'tempdir'               => '/tmp/simplesaml',

/*
 * If you enable this option, simpleSAMLphp will log all sent and received messages
 * to the log file.
 *
 * This option also enables logging of the messages that are encrypted and decrypted.
 *
 * Note: The messages are logged with the DEBUG log level, so you also need to set
 * the 'logging.level' option to LOG_DEBUG.
 */
'debug' => FALSE,

'showerrors'            =>  TRUE,

/**
 * Custom error show function called from SimpleSAML_Error_Error::show.
 * See docs/simplesamlphp-errorhandling.txt for function code example.
 *
 * Example:
 *   'errors.show_function' => array('sspmod_example_Error_Show', 'show'),
 */

/**
 * This option allows you to enable validation of XML data against its
 * schemas. A warning will be written to the log if validation fails.
 */
'debug.validatexml' => FALSE,

/**
 * This password must be kept secret, and modified from the default value 123.
 * This password will give access to the installation page of simpleSAMLphp with
 * metadata listing and diagnostics pages.
 * You can also put a hash here; run "bin/pwgen.php" to generate one.
 */
'auth.adminpassword'        => 'tdRWrP1y',
'admin.protectindexpage'    => false,
'admin.protectmetadata'     => false,

/**
 * This is a secret salt used by simpleSAMLphp when it needs to generate a secure hash
 * of a value. It must be changed from its default value to a secret value. The value of
 * 'secretsalt' can be any valid string of any length.
 *
 * A possible way to generate a random salt is by running the following command from a unix shell:
 * tr -c -d '0123456789abcdefghijklmnopqrstuvwxyz' </dev/urandom | dd bs=32 count=1 2>/dev/null;echo
 */
'secretsalt' => 'defaultsecretsalt',

/*
 * Some information about the technical persons running this installation.
 * The email address will be used as the recipient address for error reports, and
 * also as the technical contact in generated metadata.
 */
'technicalcontact_name'     => 'Nicolas Vergnes',
'technicalcontact_email'    => 'nvergnes@hotmail.fr',

/*
 * The timezone of the server. This option should be set to the timezone you want
 * simpleSAMLphp to report the time in. The default is to guess the timezone based
 * on your system timezone.
 *
 * See this page for a list of valid timezones: http://php.net/manual/en/timezones.php
 */
'timezone' => 'Europe/Paris',

/*
 * Logging.
 * 
 * define the minimum log level to log
 *      SimpleSAML_Logger::ERR      No statistics, only errors
 *      SimpleSAML_Logger::WARNING  No statistics, only warnings/errors
 *      SimpleSAML_Logger::NOTICE   Statistics and errors
 *      SimpleSAML_Logger::INFO     Verbose logs
 *      SimpleSAML_Logger::DEBUG    Full debug logs - not reccomended for production
 * 
 * Choose logging handler.
 * 
 * Options: [syslog,file,errorlog]
 * 
 */
'logging.level'         => SimpleSAML_Logger::NOTICE,
'logging.handler'       => 'syslog',

/*
 * Choose which facility should be used when logging with syslog.
 *
 * These can be used for filtering the syslog output from simpleSAMLphp into its
 * own file by configuring the syslog daemon.
 *
 * See the documentation for openlog (http://php.net/manual/en/function.openlog.php) for available
 * facilities. Note that only LOG_USER is valid on windows.
 *
 * The default is to use LOG_LOCAL5 if available, and fall back to LOG_USER if not.
 */
'logging.facility' => defined('LOG_LOCAL5') ? constant('LOG_LOCAL5') : LOG_USER,

/*
 * The process name that should be used when logging to syslog.
 * The value is also written out by the other logging handlers.
 */
'logging.processname' => 'simplesamlphp',

/* Logging: file - Logfilename in the loggingdir from above.
 */
'logging.logfile'       => 'simplesamlphp.log',

/* (New) statistics output configuration.
 *
 * This is an array of outputs. Each output has at least a 'class' option, which
 * selects the output.
 */
'statistics.out' => array(
    // Log statistics to the normal log.
    /*
    array(
        'class' => 'core:Log',
        'level' => 'notice',
    ),
    */
    // Log statistics to files in a directory. One file per day.
    /*
    array(
        'class' => 'core:File',
        'directory' => '/var/log/stats',
    ),
    */
),

/*
 * Enable
 * 
 * Which functionality in simpleSAMLphp do you want to enable. Normally you would enable only 
 * one of the functionalities below, but in some cases you could run multiple functionalities.
 * In example when you are setting up a federation bridge.
 */
'enable.saml20-idp'     => true,
'enable.shib13-idp'     => false,
'enable.adfs-idp'       => false,
'enable.wsfed-sp'       => false,
'enable.authmemcookie' => false,

/* 
 * This value is the duration of the session in seconds. Make sure that the time duration of
 * cookies both at the SP and the IdP exceeds this duration.
 */
'session.duration'      =>  8 * (60*60), // 8 hours.
'session.requestcache'  =>  4 * (60*60), // 4 hours

/*
 * Sets the duration, in seconds, data should be stored in the datastore. As the datastore is used for
 * login and logout requests, thid option will control the maximum time these operations can take.
 * The default is 4 hours (4*60*60) seconds, which should be more than enough for these operations.
 */
'session.datastore.timeout' => (4*60*60), // 4 hours

/*
 * Sets the duration, in seconds, auth state should be stored.
 */
'session.state.timeout' => (60*60), // 1 hour

/*
 * Option to override the default settings for the session cookie name
 */
'session.cookie.name' => 'SimpleSAMLSessionID',

/*
 * Expiration time for the session cookie, in seconds.
 *
 * Defaults to 0, which means that the cookie expires when the browser is closed.
 *
 * Example:
 *  'session.cookie.lifetime' => 30*60,
 */
'session.cookie.lifetime' => 0,

/*
 * Limit the path of the cookies.
 *
 * Can be used to limit the path of the cookies to a specific subdirectory.
 *
 * Example:
 *  'session.cookie.path' => '/simplesaml/',
 */
'session.cookie.path' => '/',

/*
 * Cookie domain.
 *
 * Can be used to make the session cookie available to several domains.
 *
 * Example:
 *  'session.cookie.domain' => '.example.org',
 */
'session.cookie.domain' => NULL,

/*
 * Set the secure flag in the cookie.
 *
 * Set this to TRUE if the user only accesses your service
 * through https. If the user can access the service through
 * both http and https, this must be set to FALSE.
 */
'session.cookie.secure' => FALSE,

/*
 * When set to FALSE fallback to transient session on session initialization
 * failure, throw exception otherwise.
 */
'session.disable_fallback' => FALSE,

/*
 * Enable secure POST from HTTPS to HTTP.
 *
 * If you have some SP's on HTTP and IdP is normally on HTTPS, this option
 * enables secure POSTing to HTTP endpoint without warning from browser.
 *
 * For this to work, module.php/core/postredirect.php must be accessible
 * also via HTTP on IdP, e.g. if your IdP is on
 * https://idp.example.org/ssp/, then
 * http://idp.example.org/ssp/module.php/core/postredirect.php must be accessible.
 */
'enable.http_post' => FALSE,

/*
 * Options to override the default settings for php sessions.
 */
'session.phpsession.cookiename'  => null,
'session.phpsession.savepath'    => null,
'session.phpsession.httponly'    => FALSE,

/*
 * Option to override the default settings for the auth token cookie
 */
'session.authtoken.cookiename' => 'SimpleSAMLAuthToken',

/*
 * Languages available, RTL languages, and what language is default
 */
'language.available'    => array('en', 'no', 'nn', 'se', 'da', 'de', 'sv', 'fi', 'es', 'fr', 'it', 'nl', 'lb', 'cs', 'sl', 'lt', 'hr', 'hu', 'pl', 'pt', 'pt-br', 'tr', 'ja', 'zh', 'zh-tw', 'ru', 'et', 'he', 'id', 'sr'),
'language.rtl'      => array('ar','dv','fa','ur','he'),
'language.default'      => 'fr',

/**
 * Custom getLanguage function called from SimpleSAML_XHTML_Template::getLanguage().
 * Function should return language code of one of the available languages or NULL.
 * See SimpleSAML_XHTML_Template::getLanguage() source code for more info.
 *
 * This option can be used to implement a custom function for determining
 * the default language for the user.
 *
 * Example:
 *   'language.get_language_function' => array('sspmod_example_Template', 'getLanguage'),
 */

/*
 * Extra dictionary for attribute names.
 * This can be used to define local attributes.
 *
 * The format of the parameter is a string with <module>:<dictionary>.
 *
 * Specifying this option will cause us to look for modules/<module>/dictionaries/<dictionary>.definition.json
 * The dictionary should look something like:
 *
 * {
 *     "firstattribute": {
 *         "en": "English name",
 *         "no": "Norwegian name"
 *     },
 *     "secondattribute": {
 *         "en": "English name",
 *         "no": "Norwegian name"
 *     }
 * }
 *
 * Note that all attribute names in the dictionary must in lowercase.
 *
 * Example: 'attributes.extradictionary' => 'ourmodule:ourattributes',
 */
'attributes.extradictionary' => NULL,

/*
 * Which theme directory should be used?
 */
'theme.use'         => 'default',

/*
 * Default IdP for WS-Fed.
 */
'default-wsfed-idp' => 'urn:federation:pingfederate:localhost',

/*
 * Whether the discovery service should allow the user to save his choice of IdP.
 */
'idpdisco.enableremember' => TRUE,
'idpdisco.rememberchecked' => TRUE,

// Disco service only accepts entities it knows.
'idpdisco.validate' => TRUE,

'idpdisco.extDiscoveryStorage' => NULL, 

/*
 * IdP Discovery service look configuration. 
 * Wether to display a list of idp or to display a dropdown box. For many IdP' a dropdown box  
 * gives the best use experience.
 * 
 * When using dropdown box a cookie is used to highlight the previously chosen IdP in the dropdown.  
 * This makes it easier for the user to choose the IdP
 * 
 * Options: [links,dropdown]
 * 
 */
'idpdisco.layout' => 'dropdown',

/*
 * Whether simpleSAMLphp should sign the response or the assertion in SAML 1.1 authentication
 * responses.
 *
 * The default is to sign the assertion element, but that can be overridden by setting this
 * option to TRUE. It can also be overridden on a pr. SP basis by adding an option with the
 * same name to the metadata of the SP.
 */
'shib13.signresponse' => TRUE,

/*
 * Authentication processing filters that will be executed for all IdPs
 * Both Shibboleth and SAML 2.0
 */
'authproc.idp' => array(
    /* Enable the authproc filter below to add URN Prefixces to all attributes
    10 => array(
        'class' => 'core:AttributeMap', 'addurnprefix'
    ), */
    /* Enable the authproc filter below to automatically generated eduPersonTargetedID. 
    20 => 'core:TargetedID',
    */

    // Adopts language from attribute to use in UI
    30 => 'core:LanguageAdaptor',

    /* Add a realm attribute from edupersonprincipalname
    40 => 'core:AttributeRealm',
     */
    45 => array(
        'class' => 'core:StatisticsWithAttribute',
        'attributename' => 'realm',
        'type' => 'saml20-idp-SSO',
    ),

    /* When called without parameters, it will fallback to filter attributes ‹the old way›
     * by checking the 'attributes' parameter in metadata on IdP hosted and SP remote.
     */
    50 => 'core:AttributeLimit', 

    /* 
     * Search attribute "distinguishedName" for pattern and replaces if found

    60 => array(
        'class'     => 'core:AttributeAlter',
        'pattern'   => '/OU=studerende/',
        'replacement'   => 'Student',
        'subject'   => 'distinguishedName',
        '%replace', 
    ),
     */

    /*
     * Consent module is enabled (with no permanent storage, using cookies).

    90 => array(
        'class'     => 'consent:Consent', 
        'store'     => 'consent:Cookie', 
        'focus'     => 'yes', 
        'checked'   => TRUE
    ),
     */
    // If language is set in Consent module it will be added as an attribute.
    99 => 'core:LanguageAdaptor',
),
/*
 * Authentication processing filters that will be executed for all SPs
 * Both Shibboleth and SAML 2.0
 */
'authproc.sp' => array(
    /*
    10 => array(
        'class' => 'core:AttributeMap', 'removeurnprefix'
    ),
    */

    /*
     * Generate the 'group' attribute populated from other variables, including eduPersonAffiliation.
     */
    60 => array('class' => 'core:GenerateGroups', 'eduPersonAffiliation'),
    // All users will be members of 'users' and 'members'   
    61 => array('class' => 'core:AttributeAdd', 'groups' => array('users', 'members')),

    // Adopts language from attribute to use in UI
    90 => 'core:LanguageAdaptor',

),

/*
 * This option configures the metadata sources. The metadata sources is given as an array with
 * different metadata sources. When searching for metadata, simpleSAMPphp will search through
 * the array from start to end.
 *
 * Each element in the array is an associative array which configures the metadata source.
 * The type of the metadata source is given by the 'type' element. For each type we have
 * different configuration options.
 *
 * Flat file metadata handler:
 * - 'type': This is always 'flatfile'.
 * - 'directory': The directory we will load the metadata files from. The default value for
 *                this option is the value of the 'metadatadir' configuration option, or
 *                'metadata/' if that option is unset.
 *
 * XML metadata handler:
 * This metadata handler parses an XML file with either an EntityDescriptor element or an
 * EntitiesDescriptor element. The XML file may be stored locally, or (for debugging) on a remote
 * web server.
 * The XML hetadata handler defines the following options:
 * - 'type': This is always 'xml'.
 * - 'file': Path to the XML file with the metadata.
 * - 'url': The url to fetch metadata from. THIS IS ONLY FOR DEBUGGING - THERE IS NO CACHING OF THE RESPONSE.
 *
 *
 * Examples:
 *
 * This example defines two flatfile sources. One is the default metadata directory, the other
 * is a metadata directory with autogenerated metadata files.
 *
 * 'metadata.sources' => array(
 *     array('type' => 'flatfile'),
 *     array('type' => 'flatfile', 'directory' => 'metadata-generated'),
 *     ),
 *
 * This example defines a flatfile source and an XML source.
 * 'metadata.sources' => array(
 *     array('type' => 'flatfile'),
 *     array('type' => 'xml', 'file' => 'idp.example.org-idpMeta.xml'),
 *     ),
 *
 *
 * Default:
 * 'metadata.sources' => array(
 *     array('type' => 'flatfile')
 *     ),
 */
'metadata.sources' => array(
    array('type' => 'flatfile'),
),

/*
 * Configure the datastore for simpleSAMLphp.
 *
 * - 'phpsession': Limited datastore, which uses the PHP session.
 * - 'memcache': Key-value datastore, based on memcache.
 * - 'sql': SQL datastore, using PDO.
 *
 * The default datastore is 'phpsession'.
 *
 * (This option replaces the old 'session.handler'-option.)
 */
'store.type' => 'phpsession',

/*
 * The DSN the sql datastore should connect to.
 *
 * See http://www.php.net/manual/en/pdo.drivers.php for the various
 * syntaxes.
 */
'store.sql.dsn' => 'sqlite:/path/to/sqlitedatabase.sq3',

/*
 * The username and password to use when connecting to the database.
 */
'store.sql.username' => NULL,
'store.sql.password' => NULL,

/*
 * The prefix we should use on our tables.
 */
'store.sql.prefix' => 'simpleSAMLphp',

/*
 * Configuration for the MemcacheStore class. This allows you to store
 * multiple redudant copies of sessions on different memcache servers.
 *
 * 'memcache_store.servers' is an array of server groups. Every data
 * item will be mirrored in every server group.
 *
 * Each server group is an array of servers. The data items will be
 * load-balanced between all servers in each server group.
 *
 * Each server is an array of parameters for the server. The following
 * options are available:
 *  - 'hostname': This is the hostname or ip address where the
 *    memcache server runs. This is the only required option.
 *  - 'port': This is the port number of the memcache server. If this
 *    option isn't set, then we will use the 'memcache.default_port'
 *    ini setting. This is 11211 by default.
 *  - 'weight': This sets the weight of this server in this server
 *    group. http://php.net/manual/en/function.Memcache-addServer.php
 *    contains more information about the weight option.
 *  - 'timeout': The timeout for this server. By default, the timeout
 *    is 3 seconds.
 *
 * Example of redudant configuration with load balancing:
 * This configuration makes it possible to lose both servers in the
 * a-group or both servers in the b-group without losing any sessions.
 * Note that sessions will be lost if one server is lost from both the
 * a-group and the b-group.
 *
 * 'memcache_store.servers' => array(
 *     array(
 *         array('hostname' => 'mc_a1'),
 *         array('hostname' => 'mc_a2'),
 *     ),
 *     array(
 *         array('hostname' => 'mc_b1'),
 *         array('hostname' => 'mc_b2'),
 *     ),
 * ),
 *
 * Example of simple configuration with only one memcache server,
 * running on the same computer as the web server:
 * Note that all sessions will be lost if the memcache server crashes.
 *
 * 'memcache_store.servers' => array(
 *     array(
 *         array('hostname' => 'localhost'),
 *     ),
 * ),
 *
 */
'memcache_store.servers' => array(
    array(
        array('hostname' => 'localhost'),
    ),
),

/*
 * This value is the duration data should be stored in memcache. Data
 * will be dropped from the memcache servers when this time expires.
 * The time will be reset every time the data is written to the
 * memcache servers.
 *
 * This value should always be larger than the 'session.duration'
 * option. Not doing this may result in the session being deleted from
 * the memcache servers while it is still in use.
 *
 * Set this value to 0 if you don't want data to expire.
 *
 * Note: The oldest data will always be deleted if the memcache server
 * runs out of storage space.
 */
'memcache_store.expires' =>  36 * (60*60), // 36 hours.

/*
 * Should signing of generated metadata be enabled by default.
 *
 * Metadata signing can also be enabled for a individual SP or IdP by setting the
 * same option in the metadata for the SP or IdP.
 */
'metadata.sign.enable' => TRUE,

/*
 * The default key & certificate which should be used to sign generated metadata. These
 * are files stored in the cert dir.
 * These values can be overridden by the options with the same names in the SP or
 * IdP metadata.
 *
 * If these aren't specified here or in the metadata for the SP or IdP, then
 * the 'certificate' and 'privatekey' option in the metadata will be used.
 * if those aren't set, signing of metadata will fail.
 */
'metadata.sign.privatekey' => NULL,
'metadata.sign.privatekey_pass' => NULL,
'metadata.sign.certificate' => NULL,

/*
 * Proxy to use for retrieving URLs.
 *
 * Example:
 *   'proxy' => 'tcp://proxy.example.com:5100'
 */
'proxy' => NULL,

); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T17:16:46.930

查看 simpleSAMLphp 文档的[配置 Apache](http://simplesamlphp.org/docs/stable/simplesamlphp-install#section_6)部分。我相信您可能只是没有别名设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-27T16:35:23.190

您应该从 config.php 中的 baseurlpath 中省略“www/”，因为您的 Apache Alias 已经指向该目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-20T10:33:22.930

If it's helpfull in any way at this point, i was getting the same error. I had wamp and in the http-vhosts.config i had :

```
<VirtualHost *:80>
    ServerName wwx.saml22.com
    DocumentRoot "C:/wamp64/www/wwx.saml22.com/www"
    <Directory  "C:/wamp64/www/wwx.saml22.com/www/">
        Options +Indexes +Includes +FollowSymLinks +MultiViews
        AllowOverride All
        Require local
    </Directory>
</VirtualHost> 
```

wwx.saml22.com is the directory that had the entire project inside, www should be visible to the word.

And for the base path in the config.php file i added

```
'baseurlpath' => '/', 
```

After this it worked.

# javascript - 正则表达式使用 javascript 和/或 jQuery 测试（或匹配）对象及其兄弟姐妹

> ID：12717846
> 
> 赞同：0
> 
> 时间：2012-10-03T22:35:39.603
> 
> 标签：javascript, jquery, regex, match, siblings

使用 javascript 和/或 jQuery，我如何测试/匹配一个对象及其所有兄弟姐妹？我不是程序员，所以请放轻松。提前致谢。:)

```
 // Make an array of the checked inputs
var aInputs = $('.listings-inputs input:checked').toArray();
// Turn that array into a new array made from each items value.
var aValues = $.map(aInputs, function(i){
    return $(i).val();
});
// Create new variable, set the value to the joined array set to lower case.
// Use this variable as the string to test
var sValues = aValues.join(' ').toLowerCase();

    $.each(sSplitTags, function(i){
        var re = new RegExp(sSplitTags[i],'i');
        // this test works, but not for the siblings
        if(re.test(sValues)){
        // This line does not work, but it is the gist of the question
        // if( (re.test(sValues)) && ($(re).siblings().test(sValues))){
            alert('match');
        }
        else{
            alert('no match');
        }
    });

    /*
    // Begin: There is a more elegant way to do this...
    // Create new Regular Expressions
    var re0 = new RegExp(sSplitTags[0],'i');
    var re1 = new RegExp(sSplitTags[1],'i');
    // if(thisInput.attr('value') == $(this).text()){
    if((re0.test(sValues)) && (re1.test(sValues))){
    // End: There is a more elegant way to do this...
        $(this).parent().show();
    }
    else{
        $(this).parent().hide();
    }
    */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T00:13:39.213

以下是您在最后将测试推广到 sSplitTags 的所有元素的方法：

```
var showIt = true;
$.each(sSplitTags, function(i, tag) {
  re = new RegExp(tag);
  if (!re.test(sValues)) {
    showIt = false;
    break;
  }
});
$(this).parent().toggle(showIt); 
```

# elmah - 网络 (unc) 路径上的 Elmah xml 日志文件

> ID：12717849
> 
> 赞同：0
> 
> 时间：2012-10-03T22:35:46.977
> 
> 标签：elmah

我正在使用 elmah 在 MVC 中记录文件。这是 web.congif 文件中 logPath 的设置，但我想将日志存储在 UNC 路径上。（网络路径）

我尝试直接使用 UNC 路径，但它不起作用。例如 \\NetworkPath\ErrorLogs\Errors

```
<elmah>
  <errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="~/App_Data/XML_Logs" />
</elmah> 
```

我究竟做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T11:38:21.677

为了使 UNC 路径正常工作，您需要确保运行 IIS 站点的帐户（在大多数情况下，这是运行您的站点应用程序池的帐户）有权访问您指定的 UNC 共享。

# css - img 嵌套在 div CSS 中

> ID：12717851
> 
> 赞同：0
> 
> 时间：2012-10-03T22:36:12.537
> 
> 标签：css

我想防止 div 内的嵌套 img 被调整大小。这是我正在使用的 CSS：

```
<div id="profile-gallery-image">
  <img src="..." />
</div

#profile-gallery-image {
border: 2px solid rgba(223,223,223,1);
width: 100px;
height: 100px;
overflow: hidden;
display: inline-block; 
```

}

我得到的结果是这样的：

![在此处输入图像描述](../Images/773cf5292e127e4a016ebefc2899f8f3.png)

真实图像大于 100x100 框。因此，无论外面是什么，都应该隐藏起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:46:20.387

尝试使用 background-size 属性来锁定图像大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:55:05.917

容器框不是这里的情况，似乎图像是通过 CSS 或通过一些 JavaScript 调整大小的。

尝试使用以下样式：

```
#profile-gallery-image img {
    width: auto;
    height: auto;
} 
```

如果此代码不起作用，则意味着它被 JS 或一些更具体的 CSS 声明覆盖。在这种情况下，请使用开发人员工具或 Firebug 检查这些图像并检查它们是否仍然适用。您也可以添加`!important`到代码中（如`width: auto !important;`），但请记住仅在绝对必须时使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T01:27:53.827

您可以尝试使用 background-image 在 div 内显示图像，而不是使用单独的图像标签。

```
<div id="profile-gallery-image" style="background-image:url('images/imagename.jpg');">
</div>

#profile-gallery-image {
border: 2px solid rgba(223,223,223,1);
width: 100px;
height: 100px;
overflow: hidden;
display: inline-block;
background-repeat:no-repeat;
background-position:left;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-03T11:39:35.733

我有类似的问题，尝试了各种没有成功的建议。我想要一个 200px 的宽度，但没有样式。这最终对我有用。由于我的图像是 .png 格式，因此我根据 src 文件类型对图像进行了样式设置。

下面的代码将针对***所有**以 .png 结尾的 src 属性的 img 标签*

```
img[src$=".png"] {
  width: 200px;
} 
```

# asp.net - 如何检查 List<> 包含与 TimeSpan 上的比较

> ID：12717855
> 
> 赞同：5
> 
> 时间：2012-10-03T22:36:35.443
> 
> 标签：asp.net, list, timespan

我有一个 TimeSpan 列表，我需要检查它们中的任何一个是否超过 5 小时。我知道我可以遍历列表，但如果可能的话，我更愿意使用 List<> 的内置函数之一来检查条件。

```
if (driverSchedules.GetAllShifts().Contains(delegate(TimeSpan ts) { return ts > new TimeSpan(5,0,0);}))
{
    return true;
} 
```

*GetAllShifts 返回一个列表。

我得到的错误说：

```
"Cannot convert anonymous method to type 'System.TimeSpan' because it is not a 
delegate type" 
```

据我所知，“代表类型”是`System.TimeSpan`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:38:58.367

1.：[`Contains()`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains.aspx)不接受委托作为参数；它需要一个特定的 TimeSpan 值。

2.：由于您想找出集合中的*任何*项目是否与特定条件匹配，请使用[`Any()`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.any.aspx); 它接受一个代表。

```
return driverSchedules.GetAllShifts().**Any**(ts => ts > new TimeSpan(5,0,0));
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T22:40:21.407

您正在使用的`Contains()`期望 TimeSpan 对象作为参数，而不是委托类型。您想使用`Any<>`接受委托自定义比较器的扩展。

```
if (driverSchedules.GetAllShifts().Any<TimeSpan>((ts) => { return ts > new TimeSpan(5, 0, 0); }))
{
    return true;
} 
```

# hash - 如何使用 AutoHotkey 将文件的 SHA1 哈希转换为字符串 var？

> ID：12717861
> 
> 赞同：2
> 
> 时间：2012-10-03T22:37:57.340
> 
> 标签：hash, firefox-addon, sha1, autohotkey

救命！如何使用 autohotkey 将文件的 SHA1 哈希转换为字符串变量？我知道如何使用 Crypt.ahk 库将字符串的 SHA1 哈希值转换为字符串 var，但是如何将它用于文件？

背景：我正在使用 autohotkey 来自动化构建 Firefox 插件的过程。我需要最终 xpi 文件的 sha1 哈希，以便将其添加到 update.rdf 文件中。

我在 autohotkey 论坛中找到了[这个](http://www.autohotkey.com/community/viewtopic.php?t=23584)帖子，但它很旧，而且他们解决方案的下载链接已经死了。

解决方案不必是纯粹的自动钩子——但它*确实*必须涉及一种方法或方法来以自动钩子作为发起者来实现结果；换句话说，如果 autohotkey 可以访问某些 dll 或命令行应用程序并将生成的字符串提取到变量中，那将非常好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T14:32:12.877

哈！知道了！

AutoHotkey 论坛终于通过了——一位好心的人向我指出了链接。我将结果与 Nir ​​Sofer 的 HashMyFiles 进行了比较，得到了相同的结果。这绝对完美。Autohotkey 可以做*任何事情*。所以我得出结论，打包firefox插件并不是一个糟糕的选择！

[http://www.autohotkey.com/community/viewtopic.php?t=64211](http://www.autohotkey.com/community/viewtopic.php?t=64211)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T10:40:20.103

您可以使用[nsiCryptoHash 接口](https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsICryptoHash)

# django - 如何在 Django 中临时存储未注册用户的输入？

> ID：12717869
> 
> 赞同：1
> 
> 时间：2012-10-03T22:38:50.760
> 
> 标签：django

我希望用户输入他们的邮政地址（或邮政编码），以便我可以向他们展示他们在网站上的本地化信息。如果他们将来采取需要新数据库条目的操作，我只想保存他们的地址。由于我只关心在他们当前访问期间保留地址，我认为这可能与在 Django 中扩展会话有关？这是最好的方法吗？会话是临时存储地址的安全方式吗？

建议的资源和建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:54:50.207

“在他们当前访问期间保留地址” - 这就是会话的目的。为此目的它足够安全，您甚至可以根据需要对其进行加密。[文档](https://docs.djangoproject.com/en/dev/topics/http/sessions/#browser-length-sessions-vs-persistent-sessions "文档")包含执行此操作所需的一切，这并不难。

# ruby - 类变量被覆盖

> ID：12717870
> 
> 赞同：0
> 
> 时间：2012-10-03T22:38:51.930
> 
> 标签：ruby, ruby-1.9.2

我遇到了一个使用哈希作为类变量的*奇怪问题。*运行以下代码后，我希望类变量`@@class_hash`应该包含`{:one => {'a' => 'one'}, :two => {'a' => 'two'}}`.

但是，在我运行此代码后，`@@class_hash`是`{:one => {'a' => 'two'}, :two => {'a' => 'two'}}`.

这是为什么？

```
class Klass
  @@class_hash = Hash.new({})

  def fun1
    @@class_hash[:one]['a'] = 'one'
  end

  def fun2
    @@class_hash[:two]['a'] = 'two'
  end

  def class_hash
    @@class_hash
  end
end

klass = Klass.new

klass.fun1
h1 = klass.class_hash
raise "h2[:one]['a'] should be 'one', not 'two'" if h1[:one]['a'] == 'two'
klass.fun2
h2 = klass.class_hash
raise "h2[:one]['a'] should be 'one', not 'two'" if h2[:one]['a'] == 'two' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:44:57.350

Hash.new 的参数用作默认值，在您的情况下为 {}。

对未知键的每次访问都使用完全相同的对象（r​​uby 不会神奇地为您复制它），因此在您的情况下，每个键的值都是完全相同的哈希值。您可以使用块状表格完成我认为您想要的

```
Hash.new {|hash, key| hash[key] ={} } 
```

在这种情况下，每个缺失的键都使用不同的空哈希。

# python - 有没有更好的方法在 python 中进行日期解析？

> ID：12717871
> 
> 赞同：1
> 
> 时间：2012-10-03T22:38:52.540
> 
> 标签：python, python-2.7

我正在尝试将自由格式的日期字符串解析为有意义的日期。到目前为止，我已经想出了这个功能：

```
"""Parse raw date string into YYYY-MM-DD"""
def __parseDate(self, rawDate):
    if len(rawDate) == 0:
        return u""
    if "{{Birth year and age|" in rawDate:
        rawDate = rawDate.replace("{{","").replace("}}","")
        year = rawDate.split("|")[1].strip()
        return year + "-01-01"
    elif "{{Birth date and age|" in rawDate:
        rawDate = rawDate.replace("{{","").replace("}}","")
        year = rawDate.split("|")[1].strip()
        month = rawDate.split("|")[2].strip()
        day = rawDate.split("|")[3].strip()
        if len(month) == 1:
            month = "0" + month
        if len(day) == 1:
            day = "0" + day
        return year + "-" + month + "-" + day
    elif "{{" in rawDate:
        self.__log(u"XXX Date parse error (unknown template): " + rawDate)
        return u"1770-01-01"
    elif re.match("([a-zA-Z]* [0-9][0-9]?, [0-9][0-9][0-9][0-9])", rawDate):
        match = re.findall("([a-zA-Z]* [0-9][0-9]?, [0-9][0-9][0-9][0-9])", rawDate)[0]
        parts = match.replace(",","").split(" ")
        year = parts[2].strip()
        month = parts[0].replace(".","").strip()
        day = parts[1].strip()
        tryAgain = False
        try:
            month = str(strptime(month,'%B').tm_mon)
        except:
            tryAgain = True
            pass
        try:
            if tryAgain:
                month = str(strptime(month,'%b').tm_mon)
        except:
            self.__log(u"XXX Date parse error: " + rawDate)
            return u"1770-01-01"
            pass

        if len(month) == 1:
            month = "0" + month
        if len(day) == 1:
            day = "0" + day
        return year + "-" + month + "-" + day
    elif re.match("[0-9][0-9][0-9][0-9]-[0-9][0-9]?-[0-9][0-9]?", rawDate):
        parts = rawDate.split("-")
        year = parts[0].strip()
        month = parts[1].strip()
        day = parts[2].strip()
        if len(month) == 1:
            month = "0" + month
        if len(day) == 1:
            day = "0" + day
        return year + "-" + month + "-" + day
    else:
        self.__log(u"XXX Date parse error: " + rawDate)
        return u"1770-01-01" 
```

我是在正确的轨道上还是有更好的方法？

**更新**通过自由格式字符串，我的意思是这来自 wiki 页面，特别是人员数据模板。此模板中的日期字段是自由格式的，因为有人在其中键入了一些内容。通常这是任何格式的日期，或者它本身就是另一个描述日期的 wiki 模板。以下是该领域可能存在的一些示例：

```
{{Birth year and age|1933}}
August 23, 1967
1990-01-29
23 August 1967
1999
a;lsdfhals;djkfh 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:41:56.753

大概是终极的[`parsedatetime`](http://code.google.com/p/parsedatetime/)。

另一种选择是[`dateutil`](http://labix.org/python-dateutil#head-a23e8ae0a661d77b89dfb3476f85b26f0b30349c)。

# java - 这个 Java 语法（看起来方法是参数化的）是什么意思？

> ID：12717881
> 
> 赞同：4
> 
> 时间：2012-10-03T22:39:46.930
> 
> 标签：java, generics

这是我正在查看的代码（使用 Google 的 ImmutableMap）

```
ImmutableMap.<String,String>of(); 
```

这是什么意思？做的意义何在

```
Class.<GenericType>methodName()? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T22:43:12.620

[`ImmutableMap`](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/ImmutableMap.html)是具有两个类型参数的泛型类，`K`并且`V`. 这个语法给出了两个参数的具体值，`String`在这种情况下都是。

所以上面返回一个`String`to的空映射`String`。

请参阅[JLS 15.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)，其中除其他外说方法调用是

```
方法调用：
     类型名称。NonWildTypeArguments 标识符 (ArgumentListopt)

```

这里的类型参数是`String`和`String`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T22:45:31.627

当类型推断不起作用时，它用于指定泛型类型，例如：

```
Map<String, String> m = ImmutableMap.of();
Map<String, String> m2 = ImmutableMap.<String, String>builder().build(); 
```

它参数化方法返回值的泛型类型。

# highcharts - HIghcharts：如何使用硬编码数据创建面积范围图？

> ID：12717883
> 
> 赞同：0
> 
> 时间：2012-10-03T22:39:48.633
> 
> 标签：highcharts

Highcharts 区域范围示例使用来自 json 的数据。我不确定如何修改此示例以包含在 JavaScript 中硬编码的数据。

这是我要修改的 Highcharts 演示图表：

[http://jsfiddle.net/highcharts/WRcj9/](http://jsfiddle.net/highcharts/WRcj9/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:11:54.797

将 json 返回存储到 var 中。
然后你可以改变它的值，第一个数字是UTC日期，第二个是最小值，第三个是最大值。

[演示](http://jsfiddle.net/WRcj9/46/)

# web-applications - i18n 和 l10n 应该在哪一步发生？在开头还是结尾？

> ID：12717884
> 
> 赞同：2
> 
> 时间：2012-10-03T22:39:49.527
> 
> 标签：web-applications, localization, internationalization

由于我不是英语，而且我的母语和我国家的正式语言不同，我必须一直处理（至少）3种不同的语言！

现在，我的问题是：
在编写 Web 应用程序时，应该在过程开始时还是在一切都完成之后（并且应用程序正常运行）执行 i18n 和 l10n 部分？

我认为应该在最后完成。这样，软件就准备好了，开发人员的大脑就不用忙于制作软件了。另一方面，UI 的许多部分必须根据方向（ltr 或 rtl）进行更改。
任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T00:18:36.377

国际化（i18n）必须成为发展的一部分。如果你等到最后，你将需要重写部分代码。考虑以下项目：

*   允许特定区域设置的数字和日期格式
*   外化所有文本资源
*   创建一个可以很好地处理文本扩展的设计
*   允许公制与英制

...（有关更多信息，请参阅此[链接](http://www.emreakkas.com/internationalization/10-internationalization-tips-for-developers-i18n-checklist)）

所有这些项目都需要在设计和开发过程中采用不同的方法。说“让我们先弄清楚英语，我们稍后再担心”是一个很大（但很常见）的错误。当本地化时间到来时，这种方法几乎肯定会导致花费更多的金钱、时间和沮丧的时间。

I18N 只是您在开发过程中需要应用的一组最佳实践。即使您不打算本地化您的应用程序，您也应该考虑使用 I18N 进行开发。

# wpf - WPF White/UIAutomation 超链接点击

> ID：12717887
> 
> 赞同：0
> 
> 时间：2012-10-03T22:40:22.580
> 
> 标签：wpf, hyperlink, white-framework

我正在尝试使用 White 框架来测试 WPF .NET4 应用程序。XAML 有一个超链接声明为

```
<Hyperlink Command="{Binding Path=CmdOpenFile}" Name="hlOpenFile" >
    <TextBlock Text="Load file.." Name="txtLoadFileLabel" />
</Hyperlink> 
```

CmdOpenFile 创建并显示 OpenFileDialog。当我手动测试应用程序时，它按预期工作。我已经使用 White 编写了一个单元测试，它得到了一个与此超链接相对应的 AutomationElement，然后它尝试单击此链接：

```
AutomationElement automationElement = someParentUIItem.GetElement(SearchCriteria.ByAutomationId("hlOpenFile"));
Hyperlink openFileLink = new Hyperlink(automationElement, window.ActionListener);
openFileLink.Click(); 
```

当我运行此测试时 - 应用程序启动，鼠标指针移动到此超链接，仅此而已 - 打开文件对话框不会出现。这可能是什么原因以及如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:09:44.353

看起来我找到了一些解决方案 - 不确定它是否是最好的，但它有效：

```
AutomationElement automationElement = someParentUIItem.GetElement(SearchCriteria.ByAutomationId("hlOpenFile"));
var invokePattern = automationElement.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;
invokePattern.Invoke(); 
```

PS：

上述解决方案只是让我更进一步，但后来我遇到了一个阻止程序，即代码执行在打开对话框时停止。即使它是在单独的线程中完成的 - 然后它会在尝试找到此对话框时停止，直到手动关闭对话框。[在这个](https://stackoverflow.com/questions/5631461/white-uiautomation-click-stops-working-on-different-platform)问题的帮助下，我终于找到了问题所在。我使用的是 Win7x64，应用程序是为 x86 构建的，但测试的是 AnyCPU。将测试目标更改为 x86 并从 x86 nunit 控制台运行它可以使测试执行按预期工作。

# macos - MAC OS X：使用 AVCaptureSession 的 sessionPreset 设置外部 USB 摄像头分辨率不起作用

> ID：12717891
> 
> 赞同：6
> 
> 时间：2012-10-03T22:40:42.970
> 
> 标签：macos, avfoundation, avcapturesession

我正在尝试使用以下方法设置捕获会话的相机分辨率：

```
[session setSessionPreset:AVCaptureSessionPresetLow];  // or any others resolutions 
```

它似乎没有任何区别。它始终使用相机可以提供的最高分辨率。这是一款符合 UVC 标准的 USB 摄像头，并非由 Apple 制造。

问题：setSessionPreset 可以应用于外接 USB 非苹果相机吗？还是我的问题是别的？

编辑：我也试过这个测试：

```
if ([session canSetSessionPreset:AVCaptureSessionPresetLow])
{
    NSLog(@"can presetlow");    // this part got called.
    [session beginConfiguration];
    session.sessionPreset = AVCaptureSessionPresetLow;
    [session commitConfiguration];
}
else
{
    NSLog(@"no, can't presetlow");
} 
```

赏金问题：在这种情况下如何设置相机分辨率？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T04:23:40.093

根据相机的不同，这可能是不可能的。兼容 UVC 并不意味着支持所有功能。

[http://www.mac-compatible-web-cam.com/?ID=McRmr2](http://www.mac-compatible-web-cam.com/?ID=McRmr2)

根据您的应用程序，解决方法可能是获取高分辨率图像并将其转换为代码中的较低分辨率。

# jquery - 主干模型和选项是通过引用还是通过值传递给视图

> ID：12717892
> 
> 赞同：1
> 
> 时间：2012-10-03T22:40:44.637
> 
> 标签：jquery, backbone.js, pass-by-reference

我主要想知道选项（第一个之后的任何模型）是否通过引用传递。

第一个通过的模型：

```
App.testModel = Backbone.Model.extend({
    defaults: {
        passBy: "value"
    }
}); 
```

作为选项传递的第二个模型：

```
App.testModelOptions = Backbone.Model.extend({
    defaults: {
        passBy: "value"
    }
}); 
```

将两个模型的 passBy 设置为“参考”的视图

```
App.TestView = Backbone.View.extend({
    initialize: function() {
        this.model1 = this.model;
        this.model2 = this.options.model2;

        this.model1.set({passBy: "reference"});
        this.model2.set({passBy: "reference"});
    }
}); 
```

主要的：

```
// Router
App.AppRouter = Backbone.Router.extend({
    routes:{
        "":"test"
    }

    test:function() {
        this.testModel = new App.testModel();
        this.testModel2 = new App.testModelOptions();
        this.testView = new App.TestView({model: this.testModel, model2: this.testModel2});
        console.log(this.testModel.get("passBy"));
        console.log(this.testModel2.get("passBy"));
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T14:31:05.817

是的。如果您创建模型的实例，将其传递给 20 个视图，并调用`set({passBy: "reference"})`其中一个视图 - 模型中所有视图的属性都将更新，因为所有这 20 个视图都引用了内存中的同一模型。对于传递给视图的任何对象也是如此。

# php - 从 php 检索 JSON 时出错 - Android

> ID：12717893
> 
> 赞同：1
> 
> 时间：2012-10-03T22:40:44.023
> 
> 标签：php, android, mysql, json

我正在为我的 android 应用程序使用一个 php 文件来与我正在使用的 mySql DB 进行通信。当我刚刚使用 INSERT 查询时，php 运行良好，但是当我添加 SELECT 查询时，它只是无法将 JSON 返回到我的应用程序。关键是，在我向数据库添加一行后，我想返回新行的 id。id 是具有自动增量的 int。

这是我的 PHP 代码：

```
<?php

/*
* Following code will create a new product row
* All product details are read from HTTP Post Request
*/

// array for JSON response
$response = array();

// check for required fields
if (isset($_POST['lat']) && isset($_POST['lon']) && isset($_POST['alt'])) {

$name = $_POST['lat'];
$price = $_POST['lon'];
$description = $_POST['alt'];

// include db connect class
require_once __DIR__ . '/db_connect.php';

// connecting to db
$db = new DB_CONNECT();

// mysql inserting a new row
$result = mysql_query("INSERT INTO sits(lat, lon, alt) VALUES($name, $price, $description)");

// check if row inserted or not
if ($result) {
    // successfully inserted into database
    $response["success"] = 1;
    $response["message"] = "sit created.";
    $result2 = mysql_query("SELECT id FROM sits ORDER BY id DESC LIMIT 1")
    while($row = mysql_fetch_array($result2))
    {
       $response["id"]=$row['id'];
    }
    // echoing JSON response
    echo json_encode($response);
} else {
    // failed to insert row
    $response["success"] = 0;
    $response["message"] = "Oops! An error occurred.";

    // echoing JSON response
    echo json_encode($response);
}
} else {
// required field is missing
$response["success"] = 0;
$response["message"] = "Required field(s) is missing";

// echoing JSON response
echo json_encode($response);
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:46:28.867

你肯定需要[mysql_insert_id](http://php.net/manual/en/function.mysql-insert-id.php) () 。SELECT 查询是不必要的。文档状态：

> 返回值
> 
> 上一个查询成功时为 AUTO_INCREMENT 列生成的 ID，如果上一个查询没有生成 AUTO_INCREMENT 值，则为 0，如果没有建立 MySQL 连接，则为 FALSE。

```
if ($result) {
    // successfully inserted into database
    $response["success"] = 1;
    $response["message"] = "sit created.";
    $response["id"] = mysql_insert_id();
    // echoing JSON response
    echo json_encode($response);
} 
```

# java - 停止或重新部署时内存泄漏 - Spring 3.1.2、Hibernate 4.1.0、Spring Data-Jpa 1.1.0、Tomcat 7.0.30

> ID：12717895
> 
> 赞同：14
> 
> 时间：2012-10-03T22:40:49.647
> 
> 标签：java, spring, hibernate, spring-mvc, tomcat7

# **编辑 1**

2013/06/07 - 虽然我仍然遇到这个问题，但它仍然只影响重新部署。自从发布了原始问题以来，我们已经升级了一些东西。这是我们的新版本（仍然存在手头的问题）：

```
<properties>
    <!-- Persistence and Validation-->
    <hibernate.version>4.1.0.Final</hibernate.version>
    <hibernate.jpa.version>1.0.1.Final</hibernate.jpa.version>
    <javax.validation.version>1.0.0.GA</javax.validation.version>
    <querydsl.version>2.2.5</querydsl.version>
    <spring.jpa.version>1.2.0.RELEASE</spring.jpa.version>
    <spring.ldap.version>1.3.1.RELEASE</spring.ldap.version>

    <!-- Spring and Logging -->
    <spring.version>3.1.3.RELEASE</spring.version>
    <spring.security.version>3.1.3.RELEASE</spring.security.version>
    <slf4j.version>1.6.4</slf4j.version>
    <jackson.version>1.9.9</jackson.version>

    <cglib.version>3.0</cglib.version>
</properties> 
```

如您所见，它基本上只是一个 Spring Framework 凹凸和 Spring (Data) Jpa 凹凸。我们还升级到了 Tomcat 7.0.39。CGLIB（之前没有提到但被包括在内）也被提升到 3.0

以下是我试图解决手头问题但没有运气的一些事情：

1.  更改了我们的 POM（使用 Maven）以将我们的数据库驱动程序设置为具有所提供的范围
2.  添加了对 SLF4J 的依赖以包含 jul-to-slf4j，因为这里提到可能存在潜在泄漏
3.  试用了 Classload Leak Protector ( [https://github.com/mjiderhamn/classloader-leak-prevention](https://github.com/mjiderhamn/classloader-leak-prevention) )。这似乎有效（因为它在取消部署/关闭期间通过列出它正在清理的大量内容向我的日志发送垃圾邮件）但是在使用 VisualVM 之后，我的 perm gen 空间没有被回收。这可能对其他人有用...
4.  尝试使用 Maven 的依赖项分析工具列出我的 POM 中的所有排除项（在 Maven 项目窗口的 IntelliJ 中，您可以右键单击依赖项并选择“显示依赖项”并 Shift-Delete 所有红色依赖项）。这没有帮助，但它使我的 WAR 文件大小减少了大约 MB 左右。
5.  根据 Spring 未解决的错误报告 ( [https://jira.springsource.org/browse/SPR-9274](https://jira.springsource.org/browse/SPR-9274) ) 重构 JPA Persistence 配置如下（注意注释）：

    ```
    @Bean
    public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) { // Important line (notice entityManagerFactory is 'provided/autowired'
        return new JpaTransactionManager(entityManagerFactory);
    }

    @Bean
    public EntityManagerFactory getEntityManagerFactory(DataSource dataSource) { // Important line (notice dataSource is 'provided/autowired'

        LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
        factoryBean.setDataSource(dataSource);
        factoryBean.setPackagesToScan("my.scanned.domain");

        AbstractJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        vendorAdapter.setGenerateDdl(true);
        vendorAdapter.setShowSql(false);
        vendorAdapter.setDatabase(Database.POSTGRESQL);
        vendorAdapter.setDatabasePlatform("org.hibernate.dialect.PostgreSQL82Dialect");

        factoryBean.setJpaVendorAdapter(vendorAdapter);

        Map<String, Object> properties = new HashMap<>();
        properties.put("hibernate.ejb.naming_strategy", "org.hibernate.cfg.ImprovedNamingStrategy");
        properties.put( "hibernate.bytecode.provider", "cglib" );   // Suppose to help java pergem space issues with hibernate

        factoryBean.setPersistenceProvider(new HibernatePersistence());
        factoryBean.setJpaPropertyMap(properties);
        factoryBean.setPersistenceUnitName("myPersistenace");
        factoryBean.afterPropertiesSet();

        return factoryBean.getObject(); // Important line
    }

    @Bean
    public PersistenceExceptionTranslator getHibernateExceptionTranslator() { // Required
        return new HibernateExceptionTranslator();
    }

    @Bean
    public DataSource getDataSource() {
        JndiDataSourceLookup lookup = new JndiDataSourceLookup();
        DataSource dataSource = lookup.getDataSource("java:comp/env/jdbc/myLookup");

        lookup = null;

        return dataSource;
    } 
    ```

6.  在以下 SO 问题中根据[https://stackoverflow.com/a/15710827/941187](https://stackoverflow.com/a/15710827/941187)创建了一个“ThreadImmolator” ：'[这很可能会在 Tomcat 中造成内存泄漏吗？](https://stackoverflow.com/questions/5292349/is-this-very-likely-to-create-a-memory-leak-in-tomcat)'。这似乎与上面的 TreadLocal 泄漏检测几乎相同——我没有 Tomcat 泄漏检测器抱怨；但是，perm gen 空间在重新部署后仍未恢复。
    *   我的第一次尝试是在我的 WebConfig（具有 @EnableWebMvc 的同一 bean）中添加一个 @PreDestory 以尝试在关闭时触发它。烫发。根留下了。
    *   我的第二次尝试是继承 ContextLoaderListener，覆盖 ContextDestoryed() 并内联函数。烫发。根留下了。
7.  由于 ThreadImmolator 没有帮助（或似乎没有帮助），我在以下 SO 问题上尝试了[https://stackoverflow.com/a/16644476中建议的解决方案：“](https://stackoverflow.com/a/16644476)[如何清理 threadlocals](https://stackoverflow.com/questions/3869026/how-to-clean-up-threadlocals) ”。这让我尝试：' [https://weblogs.java.net/blog/jjviana/archive/2010/06/09/dealing-glassfish-301-memory-leak-or-threadlocal-thread-pool-bad-ide](https://weblogs.java.net/blog/jjviana/archive/2010/06/09/dealing-glassfish-301-memory-leak-or-threadlocal-thread-pool-bad-ide) '和' [http://blog.igorminar.com/2009/03/identifying-threadlocal-memory-leaks-in.html](http://blog.igorminar.com/2009/03/identifying-threadlocal-memory-leaks-in.html) '。

在这一点上，我已经没有想法了。

我还尝试以此为起点（[http://cdivilly.wordpress.com/2012/04/23/permgen-memory-leak/](http://cdivilly.wordpress.com/2012/04/23/permgen-memory-leak/)）学习堆分析。我可以找到未清理的类加载器，并且可以看到它仍在引用与 Spring 相关的所有类。我也尝试过搜索，`org.springframework.core.NamedThreadLocal`在运行 ThreadImmolator、Thread Leak Preventor 和我在上面尝试的其他“重型解决方案”后进行转储后，我仍然可以看到它们出现在堆中。

也许上述信息可能对某人有所帮助，但如果我解决了问题，我将继续使用新信息重新访问此 SO。

# 问题

该应用程序在生产服务器上连续几天运行没有问题，但是当我执行更新部署时，Tomcat 管理器程序会抱怨泄漏（如果我单击查找泄漏）。如果我执行 6-10 次部署，最终 Tomcat 内存不足并出现 PermGen 内存错误，我需要重新启动 Tomcat 服务，一切都会恢复正常。

当我在本地运行/调试应用程序并执行一些需要通过 Jpa/Hibernate 访问的操作（即，我登录或从 JpaRepository 请求列表）然后关闭应用程序时，我在 Tomcat 的调试输出中收到以下消息：

> 2012 年 10 月 3 日下午 2:55:13 org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks 严重：Web 应用程序 [/] 创建了一个 ThreadLocal，其键类型为 [org.springframework.core.NamedThreadLocal]（值 [Transactional resources] ) 和 [java.util.HashMap] 类型的值 (值 [{public abstract java.lang.Object org.springframework.data.repository.CrudRepository.findOne(java.io.Serializable)=java.lang.Object@842e211 }]) 但在 Web 应用程序停止时未能将其删除。线程将随着时间的推移而更新，以尝试避免可能的内存泄漏。
> 
> 2012 年 10 月 3 日下午 2:55:13 org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks 严重：Web 应用程序 [/] 创建了一个 ThreadLocal，其键类型为 [org.springframework.core.NamedThreadLocal]（值 [Transactional resources] ) 和 [java.util.HashMap] 类型的值 (值 [{public abstract java.util.List org.springframework.data.jpa.repository.JpaRepository.findAll()=java.lang.Object@842e211}])但在 Web 应用程序停止时未能将其删除。线程将随着时间的推移而更新，以尝试避免可能的内存泄漏。
> 
> 2012 年 10 月 3 日下午 2:55:13 org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks 严重：Web 应用程序 [/] 创建了一个 ThreadLocal，其键类型为 [org.springframework.core.NamedThreadLocal]（值 [Transactional resources] ) 和 [java.util.HashMap] 类型的值 (值 [{public abstract java.lang.Iterable org.springframework.data.querydsl.QueryDslPredicateExecutor.findAll(com.mysema.query.types.Predicate)=java.lang .Object@842e211}]) 但在 Web 应用程序停止时未能将其删除。线程将随着时间的推移而更新，以尝试避免可能的内存泄漏。
> 
> 2012 年 10 月 3 日下午 2:55:13 org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks 严重：Web 应用程序 [/] 创建了一个 ThreadLocal，其键类型为 [org.springframework.core.NamedThreadLocal]（值 [Transactional resources] ) 和 [java.util.HashMap] 类型的值 (值 [{public abstract data.domain.UserAccount UserAccountRepository.findByUserName(java.lang.String)=java.lang.Object@842e211}]) 但未能删除它当 Web 应用程序停止时。线程将随着时间的推移而更新，以尝试避免可能的内存泄漏。

等等等等

# 配置

Spring 是通过注释配置的，我也使用 Postgres 8.4 作为数据库后端。

JPA 是通过注释配置的（jpa-repository-context.xml 只是说要查找此类）：

```
@Configuration
@EnableTransactionManagement
@ImportResource( "classpath*:*jpa-repository-context.xml" )
@ComponentScan( basePackages = { "data.repository" } )
public class PersistenceJpaConfig
{
    @Bean
        public LocalContainerEntityManagerFactoryBean entityManagerFactory()
        {
            LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();
            factoryBean.setDataSource( dataSource() );
            factoryBean.setPackagesToScan( new String[] { "data.domain" } );

            // Setup vendor specific information. This will depend on the chosen DatabaseType
            HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
            vendorAdapter.setGenerateDdl( true );
            vendorAdapter.setShowSql( false );
            vendorAdapter.setDatabasePlatform( "org.hibernate.dialect.PostgreSQL82Dialect" );

            factoryBean.setJpaVendorAdapter( vendorAdapter );

            Map<String, Object> properties = new HashMap<String, Object>();
            properties.put( "hibernate.ejb.naming_strategy", "org.hibernate.cfg.ImprovedNamingStrategy" );

            factoryBean.setJpaPropertyMap( properties );

            return  factoryBean;
        }

        @Bean
        public DataSource dataSource()
        {
            JndiDataSourceLookup lookup = new JndiDataSourceLookup();
            DataSource dataSource;

            dataSource = lookup.getDataSource( "java:comp/env/jdbc/postgres" );

            return dataSource;
        }

        @Bean
        public PlatformTransactionManager transactionManager()
        {
            JpaTransactionManager transactionManager = new JpaTransactionManager();
            transactionManager.setEntityManagerFactory( entityManagerFactory().getObject() );

            return transactionManager;
        }
} 
```

示例存储库：

```
public interface UserAccountRepository extends JpaRepository<UserAccount, Long>, QueryDslPredicateExecutor<UserAccount> {
} 
```

我所有的存储库都是通过在 Spring 中注册为 @Component 的 Service 类访问的。这样做是为了从 Spring 控制器中删除存储库访问：

```
@Component
public class UserAccountService {

    @Autowired
    private UserAccountRepository userAccountRepository;

    public List<UserAccount> getUserAccounts() {
        return userAccountRepository.findAll();
    }
    ...
} 
```

以下是 Maven 的 pom.xml 中使用的各种组件的版本：

```
<properties>
        <!-- Persistence and Validation-->
        <hibernate.version>4.1.0.Final</hibernate.version>
        <hibernate.jpa.version>1.0.1.Final</hibernate.jpa.version>
        <javax.validation.version>1.0.0.GA</javax.validation.version>
        <querydsl.version>2.2.5</querydsl.version>
        <spring.jpa.version>1.1.0.RELEASE</spring.jpa.version>

        <!-- Spring and Logging -->
        <spring.version>3.1.2.RELEASE</spring.version>
        <spring.security.version>3.1.2.RELEASE</spring.security.version>
        <slf4j.version>1.6.4</slf4j.version>
        <jackson.version>1.9.9</jackson.version>

        <!-- Testing Suites -->
        <selenium.version>2.24.1</selenium.version>
</properties> 
```

# 问题

1.  是什么导致了内存泄漏，我该如何解决？
2.  我将如何调试这个特定问题？
3.  我的配置集中有什么可以改进的吗？

我真的没有解决这个问题的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T23:23:49.400

我认为您可能同时发生两种泄漏。Spring 警告您有关正常的“堆”内存泄漏。这还没有给你带来问题，因为……你的重新部署也导致了 PermGen 的过度使用，这个问题首先打击了你。有关第二种泄漏的信息，请参阅[处理“java.lang.OutOfMemoryError: PermGen space”错误](https://stackoverflow.com/questions/88235/dealing-with-java-lang-outofmemoryerror-permgen-space-error) [感谢 duffymo]

[更新]

由于您说上述链接中的建议没有帮助，我能想到的唯一其他建议是：

*   当春天关闭时，确保你的春豆正在清理自己
*   在构造函数或 init 方法中分配资源（任何不太可能被垃圾收集）的每个 bean 都应该有一个销毁方法来释放它
*   对于引用 spring-data 模块中任何类的任何 bean 尤其如此，catalina 抱怨该模块中的一个类
*   增加你的永久空间。即使这个建议没有解决问题，添加如下内容应该可以减少这些故障的发生频率。

> 尝试 -XX:MaxPermSize=256m 如果它仍然存在，请尝试 -XX:MaxPermSize=512m

最终的超级暴力方法是逐渐从你的应用程序中删除一些东西，直到问题消失。这将帮助您将范围缩小到可以确定是代码问题还是 Spring、Hibernate 等中的错误的程度

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-15T23:26:41.353

slash3tc - 首先感谢您的精彩文章，它帮助我填补了我的应用程序中的一些漏洞。我遇到了完全相同的问题，结果证明是在*没有*活动事务的情况下调用 spring-data-jpa DAO。这很容易通过调度程序或 @PostConstruct 注释（以前称为 InitializingBean）发生。确保您已正确配置[事务管理](http://docs.spring.io/spring/docs/3.0.x/reference/transaction.html)，并且任何 JPA 调用都发生在活动事务下（即通过使用 @Transactional 注释服务方法）。

编辑：似乎（也是？）一个在 1.4.3 中修复的旧 spring-data-jpa 版本的错误

更多细节： http: [//georgovassilis.blogspot.nl/2014/01/tomcat-spring-and-memory-leaks-when.html](http://georgovassilis.blogspot.nl/2014/01/tomcat-spring-and-memory-leaks-when.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-02T20:06:32.040

我有一个类似的问题，实际上是3个问题：

1.  未发布 JDBC 驱动程序
2.  未释放连接
3.  堆未释放

他们每个人都有不同的解决方案：

1.  [将 mysql.jar 移动到 Tomcat/lib 文件夹](https://stackoverflow.com/questions/15632153/tomcat7-jdbc-datasource-this-is-very-likely-to-create-a-memory-leak)
2.  [在侦听器中手动终止线程保留连接](https://stackoverflow.com/questions/11872316/tomcat-guice-jdbc-memory-leak)
3.  使用[SPRING-JPA 1.3.4](http://docs.spring.io/spring-data/jpa/docs/1.4.3.RELEASE/changelog.txt)，因为 1.3.4 是修复错误的版本，但它不会改变 SPRING-JPA 模块的行为（下一个版本 1.4.0 引入了对查询的更新并“破坏”了现有代码)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-05T06:03:41.267

我有一个类似的问题，我刚刚解决了它。

> [org.springframework.core.NamedThreadLocal]（值[事务资源]

它可以由 TransactionSynchronizationManager 创建。

```
private static final ThreadLocal<Map<Object, Object>> resources =
        new NamedThreadLocal<Map<Object, Object>>("Transactional resources");

private static final ThreadLocal<Set<TransactionSynchronization>> synchronizations =
        new NamedThreadLocal<Set<TransactionSynchronization>>("Transaction synchronizations");

private static final ThreadLocal<String> currentTransactionName =
        new NamedThreadLocal<String>("Current transaction name");

private static final ThreadLocal<Boolean> currentTransactionReadOnly =
        new NamedThreadLocal<Boolean>("Current transaction read-only status");

private static final ThreadLocal<Integer> currentTransactionIsolationLevel =
        new NamedThreadLocal<Integer>("Current transaction isolation level");

private static final ThreadLocal<Boolean> actualTransactionActive =
        new NamedThreadLocal<Boolean>("Actual transaction active"); 
```

就我而言，除了“事务资源”之外的 NamedThreadLocals 被泄露。所以我在contextDestroyed的最后一行添加了以下代码。

```
TransactionSynchronizationManager.clear(); 
```

我认为您还可以通过添加以下内容来释放资源：

```
Map<Object, Object> ojb = TransactionSynchronizationManager.getResourceMap();
for (Object key : ojb.keySet()) {
    TransactionSynchronizationManager.unbindResource(key);
} 
```

除此之外，我还需要执行以下操作：

1.  从 tomcat/libs 中删除了 PostgreSQL 驱动程序。我已经在 build.gradle 中添加了依赖项，所以它们是重复的。
2.  将 hibernate-validator 库更新到最新版本

    ```
    compile ('org.springframework.boot:spring-boot-starter-thymeleaf:' + bootVersion + '.RELEASE') {
        exclude module: 'spring-boot-starter-tomcat'
        exclude module: 'hibernate-validator'
    }
    // https://mvnrepository.com/artifact/org.hibernate/hibernate-validator
    compile group: 'org.hibernate', name: 'hibernate-validator', version: '5.2.4.Final' 
    ```

我的应用程序中的 Spring Boot 版本是 1.2.7。

# jquery - 在 nth-child 创建 CSS 后更改它？

> ID：12717896
> 
> 赞同：0
> 
> 时间：2012-10-03T22:40:53.143
> 
> 标签：jquery, css, html

我有一个表，其中包含由 nth-class 生成的交替颜色行。我希望能够单击它们以通过更改其类来更改背景颜色。这在没有第 n 个孩子的情况下有效，但我需要让它们交替颜色。这会更改字体颜色，但不会覆盖第 n 个孩子的背景颜色。

行 CSS：

```
#messageLogTable tr:nth-child(odd):not([class=highlightNewInfoRow]):not([class=tableHeader]):not([class=clickedRow]) {
background-color:#DEDDCD;
}
#messageLogTable tr:nth-child(even):not([class=highlightNewInfoRow]):not([class=clickedRow]) {
background-color:#D0CFB9;
} 
```

我尝试用 jQuery 改变它：

```
$('#'+entryId).removeClass('highlightClickableRow');
$('#'+entryId).addClass('clickedRow'); 
```

.clickedRow CSS：

```
.clickedRow {
background-color:#446121;
color:white;
cursor:pointer;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:14:23.803

我想到了。我将添加的类的 CSS 更改为背景：-webkit-linear-gradient 不会改变颜色。它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:46:59.480

jQuery API 文档在[http://api.jquery.com/even-selector/](http://api.jquery.com/even-selector/)几乎包含了这个确切的示例。

# angularjs - 在指令中使用 ng-model

> ID：12717897
> 
> 赞同：6
> 
> 时间：2012-10-03T22:41:28.453
> 
> 标签：angularjs

我在 angularjs 中有一个自定义的指令。基本上我想要发生的是用户将从选择框中选择一个值，并将一个值附加到一个数组中。这会导致我的自定义指令被调用并在屏幕上呈现一个新元素。我希望指令生成的文本字段绑定到控制器的属性。

html

```
<device-list ng-repeat="device in devices" key="device.key" display-name="device.display_name" bind-prefix="descriptions"></device-list> 
```

指示

```
angular.module('device_list_tag', []).
  directive('deviceList', function() {
    return {
      restrict: 'E',
      require: '?ngModel',
      scope: {
        devices: '=',
        key: '=',
        displayName: '=',
        bindPrefix: '@'
      },
      link: function(scope, element, attrs) {

        var deviceListElement = $(element)
        var containerDiv = $('<div>')
          .addClass('row')

        var labelTag = $('<label>').text(scope.displayName)
          .addClass('span1')

        var bindField = attrs.bindPrefix+'.'+scope.key

        var textField = $('<input>')
          .addClass('span3')
          .attr('ng-model', bindField)

        containerDiv.append(labelTag)
        containerDiv.append(textField)

        deviceListElement.append(containerDiv)
      }
    }
  }) 
```

控制器

```
function DevicesCtrl($scope) {
  descriptions = {}
} 
```

看起来好像 ng-model 在指令的范围内是本地的，我如何使它适用于父级？如果我在页面上有一堆文本字段，例如

```
<input ng-model="descriptions.test"/> 
```

它适用于选择框生成的字段之外的工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T01:11:50.170

好的，我想通了。它涉及将我的父属性作为“=”传递（由 Tosh 建议）。我还必须调用 $compile 以使其识别 ng-model 指令。这是完整的代码，我确信有办法做到这一点，但我很高兴让它工作。

```
angular.module('device_list_tag', []).
  directive('deviceList', function($compile) {
    return {
      restrict: 'E',
      scope: {
        devices: '=',
        key: '=',
        displayName: '=',
        bindAttr: '=' // added
      },
      link: function(scope, element, attrs) {

        console.log(scope)

        var deviceListElement = $(element)
        var containerDiv = $('<div>')
          .addClass('row')

        var labelTag = $('<label>').text(scope.displayName)
          .addClass('span1')

        var bindField = 'bindAttr.'+scope.key

        var textField = $('<input>')
          .addClass('span3')
          .attr('ng-model', bindField)

        $compile(textField)(scope) // added

        containerDiv.append(labelTag)
        containerDiv.append(textField)

        deviceListElement.append(containerDiv)
      }
    }
  }) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T00:09:43.573

也许您可以添加`bindField: '='`您的范围指令定义。并使用此变量连接到父范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T05:23:33.543

你问的是，

1）保持父范围数组更新，同时我们编辑隔离范围表单元素。如果是的话，我已经在这个小提琴[http://jsfiddle.net/W7YrZ/2/](http://jsfiddle.net/W7YrZ/2/)中复制了一个类似的场景。

我试图做的总结。

`umbilical`1）在`ng-repeat`迭代的当前项中分配一个属性。

2）然后我在父作用域的上下文中评估链接函数内部的这个属性，这给出了对父作用域数组中的一个数组对象的引用（指针）`profiles`。

3）然后正如@Mark Rajcok所说“原语是按值复制的，而对象是通过引用复制的”。我将通过第 2 步得到的对象绑定到模板字符串中的文本框。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2014-01-15T14:22:13.620

出于角度和验证 javascript 中 jQuery 代码清洁的原因，只需替换选择`$`器`angular.element`

```
$('<input>').addClass('span3') 
```

必须写

```
angular.element('<input>').addClass('span3') 
```

# c - 代码解释

> ID：12717899
> 
> 赞同：0
> 
> 时间：2012-10-03T22:41:30.787
> 
> 标签：c, winapi

我很难理解这段[代码](http://ideone.com/pkhGL)：

特别是这部分：

```
 // check that the stuff we wrote has not changed
     if(n[k][0]!=(unsigned char)(n[k]+s[k]+k))
        printf("Error when checking first byte!\n");
     if(s[k]>1 && n[k][s[k]-1]!=(unsigned char)(n[k]-s[k]-k))
        printf("Error when checking last byte!\n"); 
```

整个程序试图模仿 Windows 的`malloc`功能`free`。它必须在 Windows 上运行。

任何人都可以解释这两个 ifs 是如何工作的？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T22:52:00.257

代码在更多上下文中更有意义。

```
// used to store pointers to allocated memory
unsigned char *n[NO_OF_POINTERS]; 

int s[5000]; // used to store sizes when testing

....

for(i=0;i<NO_OF_ITERATIONS;i++) {
   k=myrand()%NO_OF_POINTERS; // pick a pointer
   if(n[k]) { // if it was allocated then free it
      // check that the stuff we wrote has not changed
      if(n[k][0]!=(unsigned char)(n[k]+s[k]+k))
         printf("Error when checking first byte!\n");
      if(s[k]>1 && n[k][s[k]-1]!=(unsigned char)(n[k]-s[k]-k))
         printf("Error when checking last byte!\n");
      FREE(n[k]);
   }
   size=randomsize(); // pick a random size
             size=1;
   n[k]=(unsigned char *)MALLOC(size); // do the allocation
   s[k]=size; // remember the size
   n[k][0]=(unsigned char)(n[k]+s[k]+k);  // put some data in the first and
   if(size>1) n[k][size-1]=(unsigned char)(n[k]-s[k]-k); // last byte
} 
```

最后两行使用基于指针值 ( `n[k]`)、分配大小 ( `s[k]`) 和指针索引 ( `k`) 的公式将第一个和最后一个字节设置为值。这个公式没有任何意义，它只是计算要存储的值，对于不同的指针分配会有所不同。

您突出显示的`if`语句检查第一个 ( `n[k][0]`) 和最后一个 ( `n[k][s[k]-1]`) 字节的值在释放内存之前没有更改。该代码基本上是`VirtualAlloc`and`VirtualFree`函数的测试工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:52:40.687

`n`看起来像一个多维数组`unsigned char`。第一行：

```
if(n[k][0]!=(unsigned char)(n[k]+s[k]+k)) 
```

正在检查子数组中的第一个元素`n[k]`不等于强制转换的`(n[k]+s[k]+k)`总和`unsigned char`

第二行：

```
if(s[k]>1 && n[k][s[k]-1]!=(unsigned char)(n[k]-s[k]-k)) 
```

似乎正在检查`k`数组的第 th 个元素`s`是否大于一个 AND（逻辑与）`s[k]-1`子数组`n[k]`中的元素不等于的结果`(n[k]-s[k]-k)`

总的来说，这是一些非常糟糕的代码，可以使用一些更好的变量名！

# php - Zend Framework 将条码渲染到包含其他内容的多个 PDF 页面中

> ID：12717901
> 
> 赞同：1
> 
> 时间：2012-10-03T22:41:45.877
> 
> 标签：php, zend-framework, pdf, barcode

我正在尝试创建包含条形码的递增标签页面。我可以将条形码放入 PDF 中，并且可以将其叠加在 PDF 中的其他内容上（见下文）。但我不知道如何使用类似的东西将条形码分配给 pdf 的某个页面

```
Zend_Barcode::factory('code39', 'pdf',
$barcodeOptions, $rendererOptions)->setResource($page)->draw(); 
```

或者

```
$page = Zend_Barcode::factory('code39', 'pdf', $barcodeOptions,
$rendererOptions)->setResource($pdf)->draw(); 
```

在我的较大代码的上下文中设置上述两个片段时都会导致错误。再往下是没有错误地呈现的代码，但没有给我我需要的东西。

这个问题与[Zend Framework Render Barcodes Into PDF Pages](https://stackoverflow.com/questions/9049046/zend-framework-render-barcodes-into-pdf-pages)相同，从我所看到的情况来看，它从未得到有效的答案。

首先，为了让它工作，我将 Zend 1.11 版条形码库复制到我的 Zend 1.7.2 版库文件夹中。如代码所示，我还将免费的非等宽字体复制到我的应用程序/库中。

我可以创建一个多页的 PDF 标签。我可以将条形码放入 PDF 中。我不能做的是将条形码放在多个页面上。我会展示我在做什么，希望你能告诉我我做错了什么或需要做什么。

首先，我有一个将条形码放入 PDF 的小片段：

```
// A font path is mandatory for Barcode Pdf output.  
// This application defines ROOT_DIR in index.php.  Others may define APPLICATION_PATH.
// Monospaced fonts apparently don't work here.
$barcodeOptions = array(
    'text' => '11111',
    'font' => ROOT_DIR . '/library/Rbs/Barcode/FreeSerif.ttf'
);
$rendererOptions = array(
    'topOffset' => 50,
    'leftOffset' => 50
);
Zend_Barcode::factory('code39', 'pdf',
$barcodeOptions, $rendererOptions)->setResource($pdf)->draw(); 
```

然后我有这个（长）代码来创建标签。我在底部附近评论了我尝试放置条形码的两个主要位置，但核心问题似乎是我不知道如何在 PDF 的某个页面上放置条形码：

```
 public function labelsAction()
    {

        $request['starting_label_number'] = '100001';
        $request['label_count'] = 32;

        $this->_helper->layout->disableLayout();
        $this->_helper->viewRenderer->setNoRender();

        $filename= 'files/inventory_labels.pdf';
        $form['units_name'] = 'inches';
        $form['units_factor'] = 72;
        $form['margin_bottom'] = 0.5;
        $form['margin_left'] = 0.19;
        $form['label_width'] = 2.625;
        $form['label_height'] = 1.0;
        $form['label_spacing_column'] = 0.125;
        $form['label_margin'] = 0.1;
        $form['label_column_count'] = 3;
        $form['label_row_count'] = 10;

        try 
        {
            // create PDF
            $pdf = new Zend_Pdf();

            // define font resource
            $font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_TIMES_ROMAN);

            $total_pages = ceil($request['label_count'] / ($form['label_column_count'] * $form['label_row_count']));
            $current_label_number = $request['starting_label_number'];

            // Create each page
            for ($page_number = 1; $page_number <= $total_pages; $page_number++)
            {

                // create A4 page
                $page = new Zend_Pdf_Page(Zend_Pdf_Page::SIZE_LETTER);

                // write text to page
                // Fill up each page with labels or blanks
                for ($row = 1; $row <= $form['label_row_count']; $row++)
                {
                    for ($column = 1; $column <= $form['label_column_count']; $column++)
                    {
                        if ($current_label_number - $request['starting_label_number'] < $request['label_count'])
                        {

                            $label_center_y = 
                                (
                                    $form['margin_bottom'] 
                                    + ($form['label_row_count'] - $row + 0.5) * $form['label_height']
                                ) * $form['units_factor'];
                            $label_center_x = 
                                (
                                    $form['margin_left'] 
                                    + ($column - 0.5) * $form['label_width'] 
                                    + ($column - 1) * $form['label_spacing_column']
                                ) * $form['units_factor'];

                            // Get our bearings $xleft, $ybottom, $xright, $ytop, $filltype
                            $page->drawRectangle(
                                $label_center_x - $form['label_width'] * $form['units_factor'] / 2, 
                                $label_center_y - $form['label_height'] * $form['units_factor'] / 2,
                                $label_center_x + $form['label_width'] * $form['units_factor'] / 2, 
                                $label_center_y + $form['label_height'] * $form['units_factor'] / 2,
                                Zend_Pdf_Page::SHAPE_DRAW_STROKE
                            );

                            // define image resource
                            $image = Zend_Pdf_Image::imageWithPath('images/new/logo.jpg');

                            // write image to page $xleft, $ybottom, $xright, $ytop
                            $image_width = 125;
                            $image_height = 30;
                            $image_y_offset = 13;
                            $page->drawImage(
                                $image, 
                                $label_center_x - $image_width / 2, 
                                $label_center_y - $image_height / 2 + $image_y_offset,
                                $label_center_x + $image_width / 2, 
                                $label_center_y + $image_height / 2 + $image_y_offset
                            );
                            $text_width = 108;
                            $page->setFont($font, 10)
                               ->drawText('www.pristineauction.com', $label_center_x - $text_width / 2, $label_center_y - 10);
                            $text_width = 68;
                            $page->setFont($font, 22)
                               ->drawText($current_label_number, $label_center_x - $text_width / 2, $label_center_y - 32);
                            $current_label_number += 1;
                        }
                    }
                }

/* If I insert the barcode creator here inside the label loop, I get a barcode all by itself on the first PDF page, with labels following on subsequent pages.  Not bad, but not right. */                
                    // add page to document
                    $pdf->pages[] = $page;
                }

/* If I insert the barcode creator here outside the label loop, I get a barcode superimposed on the first PDF page.  Not bad, but not in page loop, and not repeating. */                
                // save as file
                $pdf->save($filename);
                $this->_redirect('/' . $filename);
            } catch (Zend_Pdf_Exception $e) {
                die ('PDF error: ' . $e->getMessage());  
            } catch (Exception $e) {
                die ('Application error: ' . $e->getMessage());    
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T06:22:28.527

好吧，我找到了答案，感谢 Javier Bracero 在[http://javierbracero.blogspot.com/2012/01/zend-generate-pdf-include-list-of.html](http://javierbracero.blogspot.com/2012/01/zend-generate-pdf-including-list-of.html)

您可以提供页面索引作为参数！很高兴终于知道这一点。

好的部分：

```
// Create Pdf definition
$pdf = new Zend_Pdf();
// Define font resource for Pdf library
$font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_TIMES_ROMAN);

// Must set a TTF for Barcode library
// This application defines ROOT_DIR in index.php.  Others may define APPLICATION_PATH.
Zend_Barcode::setBarcodeFont(ROOT_DIR . '/library/Rbs/Barcode/FreeSerif.ttf');

// Create the Pdf library elements for each page and add it to the document 
// before printing the Barcode elements onto that page
for ($page_index = 0; $page_index <= $last_page_index; $page_index++)
{
    // create a new Pdf page
    $page = new Zend_Pdf_Page(Zend_Pdf_Page::SIZE_LETTER);

    // write Pdf elements to the page

    // add page to document
    $pdf->pages[] = $page;
}

// Add barcodes to each page after it is added.
for ($page_index = 0; $page_index <= $last_page_index; $page_index++)
{
    $barcodeOptions = array(
        'text' => $current_label_number
    );
    $rendererOptions = array(
        'topOffset' => $label_center_y + 3,
        'leftOffset' => $label_center_x + 12
    );
    Zend_Barcode::factory('code39', 'pdf',
    $barcodeOptions, $rendererOptions)->setResource($pdf, $page_index)->draw();
    $current_label_number += 1;
}

// save as file
$pdf->save($filename); 
```

整个标签制造商：

```
// By Tom Haws 2012-10-03
// Prints labels with barcodes to pdf
public function labelsAction()
{
    $this->_helper->layout->disableLayout();
    $this->_helper->viewRenderer->setNoRender();

    $request['start_number'] = max(1, $this->_request->getParam('start-number'));
    $request['label_count'] = $this->_request->getParam('label-count');
    $inventory_number = $request['start_number'];
    $filename= 'files/inventory_labels.pdf';
    $form['units_name'] = 'inches';
    $form['units_factor'] = 72;
    $form['margin_top'] = 0.5;
    $form['margin_bottom'] = 0.5;
    $form['margin_left'] = 0.19;
    $form['label_width'] = 2.625;
    $form['label_height'] = 1.0;
    $form['label_spacing_column'] = 0.125;
    $form['label_margin'] = 0.1;
    $form['label_column_count'] = 3;
    $form['label_row_count'] = 10;

    $last_page_index = ceil($request['label_count'] / ($form['label_column_count'] * $form['label_row_count'])) - 1;
    $current_label_number = $request['start_number'];

    try 
    {
        // Create PDF
        $pdf = new Zend_Pdf();
        // Define font resource for Pdf library
        $font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_TIMES_ROMAN);

        // Must set a TTF for Barcode library
        Zend_Barcode::setBarcodeFont(ROOT_DIR . '/library/Rbs/Barcode/FreeSerif.ttf');

        // Create the Pdf library elements for each page and add it to the document 
        // before printing the Barcode elements onto that page
        for ($page_index = 0; $page_index <= $last_page_index; $page_index++)
        {
            // create the new Pdf page
            $page = new Zend_Pdf_Page(Zend_Pdf_Page::SIZE_LETTER);
            // write Pdf elements to the page
            // Fill up each page with labels or blanks
            for ($row = 1; $row <= $form['label_row_count']; $row++)
            {
                for ($column = 1; $column <= $form['label_column_count']; $column++)
                {
                    if ($current_label_number - $request['start_number'] < $request['label_count'])
                    {
                        // Note that Pdf library uses a coordinate system with origin at bottom left
                        $label_center_y = 
                            (
                                $form['margin_bottom'] 
                                + ($form['label_row_count'] - $row + 0.5) * $form['label_height']
                            ) * $form['units_factor'];
                        $label_center_x = 
                            (
                                $form['margin_left'] 
                                + ($column - 0.5) * $form['label_width'] 
                                + ($column - 1) * $form['label_spacing_column']
                            ) * $form['units_factor'];

                        // Draw a design guidance frame for each label.
                        // $xleft, $ybottom, $xright, $ytop, $filltype
                        /*
                        $page->drawRectangle(
                            $label_center_x - $form['label_width'] * $form['units_factor'] / 2, 
                            $label_center_y - $form['label_height'] * $form['units_factor'] / 2,
                            $label_center_x + $form['label_width'] * $form['units_factor'] / 2, 
                            $label_center_y + $form['label_height'] * $form['units_factor'] / 2,
                            Zend_Pdf_Page::SHAPE_DRAW_STROKE
                        ); */

                        // define image resource
                        $image = Zend_Pdf_Image::imageWithPath('images/new/logo.jpg');

                        // write image to page $xleft, $ybottom, $xright, $ytop
                        $image_width = 125;
                        $image_height = 30;
                        $image_y_offset = 20;
                        $page->drawImage(
                            $image, 
                            $label_center_x - $image_width / 2, 
                            $label_center_y - $image_height / 2 + $image_y_offset,
                            $label_center_x + $image_width / 2, 
                            $label_center_y + $image_height / 2 + $image_y_offset
                        );
                        $text_width = 108;
                        $page->setFont($font, 10)
                           ->drawText('www.pristineauction.com', $label_center_x - $text_width / 2, $label_center_y - 1);
                        $text_width = 68;
                        $page->setFont($font, 22)
                           ->drawText($current_label_number, $label_center_x - 72, $label_center_y - 25);
                        $current_label_number += 1;
                    }
                }
            }

            // add page to document
            $pdf->pages[] = $page;
        }

        // Add barcodes to pages of document.
        $current_label_number = $request['start_number'];
        for ($page_index = 0; $page_index <= $last_page_index; $page_index++)
        {
            for ($row = 1; $row <= $form['label_row_count']; $row++)
            {
                for ($column = 1; $column <= $form['label_column_count']; $column++)
                {
                    // Note that barcodes use a coordinate system with origin at top left
                    $label_center_y = 
                        (
                            $form['margin_top'] 
                            + ($row - 0.5) * $form['label_height']
                        ) * $form['units_factor'];
                    $label_center_x = 
                        (
                            $form['margin_left'] 
                            + ($column - 0.5) * $form['label_width'] 
                            + ($column - 1) * $form['label_spacing_column']
                        ) * $form['units_factor'];

                    // A font path is mandatory for Barcode Pdf output.  
                    // This application defines ROOT_DIR in index.php.  Others may define APPLICATION_PATH.
                    $barcodeOptions = array(
                        'text' => $current_label_number
                    );
                    $rendererOptions = array(
                        'topOffset' => $label_center_y + 3,
                        'leftOffset' => $label_center_x + 12
                    );
                    Zend_Barcode::factory('code39', 'pdf',
                    $barcodeOptions, $rendererOptions)->setResource($pdf, $page_index)->draw();
                    $current_label_number += 1;
                }
            }
        }

        // save as file
        $pdf->save($filename);
        $this->_redirect('/' . $filename);
    } catch (Zend_Pdf_Exception $e) {
        die ('PDF error: ' . $e->getMessage());  
    } catch (Exception $e) {
        die ('Application error: ' . $e->getMessage());    
    }
} 
```

# .net - Ansicon 和黄瓜：'Ruby 解释器 (CUI) 1.9.3p194 [1386-mingw] 已停止工作'

> ID：12717902
> 
> 赞同：3
> 
> 时间：2012-10-03T22:41:50.767
> 
> 标签：.net, ruby, cucumber

安装 ansicon v.1.3.2 并运行黄瓜功能文件时，我得到以下输出：

`Ruby interpreter (CUI) 1.9.3p194 [1386-mingw] has stopped working`

卸载 ansicon 并运行 cucumber 时，我运行的测试没有彩色输出。

有谁知道我需要做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-16T16:17:10.087

我在 ansicon 上遇到过类似的问题，在执行以下步骤后，我没有遇到任何进一步的问题。

1.  将 ansicon.exe 文件放入您的`Ruby193\bin`目录
2.  导航到那里并安装 ansicon`aniscon -i`
3.  运行黄瓜

# python - Heroku 应用程序在推送小零钱后崩溃。很迷茫

> ID：12717903
> 
> 赞同：6
> 
> 时间：2012-10-03T22:41:52.173
> 
> 标签：python, heroku, flask

我正在将 Heroku 与 python 和 Flask 一起使用。我的应用程序运行良好，直到我更新了我的 python 应用程序文件中的几行。该应用程序在本地运行良好，但是当我尝试访问我的应用程序时出现以下错误：

*“应用程序发生错误，无法提供您的页面。请稍后再试。如果您是应用程序所有者，请查看您的日志以获取详细信息。”*

我的日志看起来像这样：

```
2012-10-03T17:40:26+00:00 heroku[web.1]: Process exited with status 1
2012-10-03T17:40:26+00:00 heroku[web.1]: State changed from starting to crashed
2012-10-03T17:51:25+00:00 heroku[web.1]: State changed from crashed to starting
2012-10-03T17:51:26+00:00 heroku[web.1]: Starting process with command `python presentation.py`
2012-10-03T17:51:26+00:00 app[web.1]: ImportError: No module named site 
```

我也不再能够通过heroku运行python：

```
Cinnas-MacBook-Pro:infinite-fortress-4866 cinna$ heroku run python
Running `python` attached to terminal... up, run.1
ImportError: No module named site 
```

我尝试做的下一件事是检查我的环境变量：

```
Cinnas-MacBook-Pro:infinite-fortress-4866 cinna$ heroku config
=== infinite-fortress-4866 Config Vars
LANG:             en_US.UTF-8 
LD_LIBRARY_PATH:  /app/.heroku/vendor/lib
LIBRARY_PATH:     /app/.heroku/vendor/lib
PATH:             /app/.heroku/venv/bin:/bin:/usr/local/bin:/usr/bin
PYTHONHASHSEED:   random
PYTHONHOME:       /app/.heroku/venv/
PYTHONPATH:       /app/
PYTHONUNBUFFERED: true 
```

但是，当我尝试查看库目录时，会得到如下信息：

```
Cinnas-MacBook-Pro:infinite-fortress-4866 cinna$ heroku run ls /app/.heroku/vendor/lib
Running `ls /app/.heroku/vendor/lib` attached to terminal... up, run.1
ls: cannot access /app/.heroku/vendor/lib: No such file or directory 
```

我现在不知道从哪里开始。我想念我的应用程序，请帮助！

附加信息：

当我将以下几行添加到我的 app.py 代码中时，所有问题都开始了：

```
 @app.route('/my_fb_graph',methods=['GET','POST'])
 def my_fb_graph():
 return render_template('my_fb_graph.html') 
```

当我推送代码并且应用程序不再工作时。然后我删除了这些代码行，再次推送代码，仍然得到相同的错误。我做的下一件事是完全删除 app.py 文件并尝试一个仍然不起作用的小测试代码。

问题的根源似乎是错误：

```
 2012-10-03T17:51:26+00:00 app[web.1]: ImportError: No module named site 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T06:45:51.980

我能够解决问题，但仍然不知道为什么会首先发生！

经过大量的实验，我最终在 Heroku 上建立了一个全新的应用程序。我检查了新应用程序中的环境变量并得到以下信息：

```
 Cinnas-MacBook-Pro:thawing-temple-4323 cinna$ heroku config
 === thawing-temple-4323 Config Vars
 FACEBOOK_APP_ID:  ***
 FACEBOOK_SECRET:  ***
 PATH:             bin:/usr/local/bin:/usr/bin:/bin
 PYTHONUNBUFFERED: true 
```

检查我的原始应用程序（损坏的应用程序），我意识到在我的最后一次推送中以某种方式添加了新的环境变量，如我的日志所示：

```
 2012-10-04T04:20:04+00:00 heroku[api]: Add PYTHONUNBUFFERED, PYTHONPATH, PYTHONHOME, LANG, LD_LIBRARY_PATH, PATH, PYTHONHASHSEED, LIBRARY_PATH config by ***@*** 
```

并通过检查我的环境变量：

```
 Cinnas-MacBook-Pro:infinite-fortress-4866 cinna$ heroku config
 === infinite-fortress-4866 Config Vars
 LANG:             en_US.UTF-8 
 LD_LIBRARY_PATH:  /app/.heroku/vendor/lib
 LIBRARY_PATH:     /app/.heroku/vendor/lib
 PATH:             /app/.heroku/venv/bin:/bin:/usr/local/bin:/usr/bin   
 PYTHONHASHSEED:   random
 PYTHONHOME:       /app/.heroku/venv/
 PYTHONPATH:       /app/
 PYTHONUNBUFFERED: true 
```

我使用以下命令删除了这些新变量：

```
 heroku config:remove PYTHONPATH PYTHONHOME LANG LD_LIBRARY_PATH PYTHONHASHSEED LIBRARY_PATH 
```

我的应用程序又开始工作了。我一直在推更多的代码，这个问题没有再发生过。

我仍然很好奇为什么/如何首先添加这些变量，因为我所做的只是做一个 git push。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-06T21:34:44.963

昨天（2012 年 12 月 6 日）我遇到了一个非常相似的问题。出乎意料的是，每个 python 调用都因“ImportError: No module named site”而死。Heroku 支持今天回复了我，他们说它已经修复，因此不需要以下解决方法。我会把它留在这里，以防它帮助其他人诊断。

我检查了我的 heroku 配置变量，但没有设置 PYTHON* 变量。但是，它们在 shell 级别被设置为环境变量：

```
$ heroku run set | grep PYTHON
PYTHONHASHSEED=random
PYTHONHOME=/app/.heroku/venv/
PYTHONPATH=/app/
PYTHONUNBUFFERED=true 
```

/app/.heroku/venv 是一个不存在的目录。如果我用 config var 覆盖 PYTHONHOME，并指出我的 virtualenv 实际在哪里，它就会重新开始工作：

```
$ heroku config:set PYTHONHOME=/app 
```

/app 似乎是项目根目录的挂载点。挖掘 Python buildpack 的历史，看起来当我开始我的项目时，每个人都在项目根目录中创建了他们的 virtualenvs。现在新项目在 venv/ 子目录中创建 virtualenvs。支持人员说他们正在逐步推出 buildpack 更改，我猜对旧的做事方式的检查对我来说并没有发挥作用。

这里是查找 buildpack 内部的地方： [https ://github.com/heroku/heroku-buildpack-python/blob/master/bin/compile](https://github.com/heroku/heroku-buildpack-python/blob/master/bin/compile)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-12T16:08:40.230

这也咬到我了。我不确定它是什么时候开始的。我不相信这是对我的任何更改的回应，我今天刚刚在我的[网站](http://aspen.io/)上注意到应用程序错误，并在日志中发现了这一点：

```
2012-12-12T16:02:06+00:00 heroku[web.1]: State changed from crashed to starting
2012-12-12T16:02:09+00:00 heroku[web.1]: Starting process with command `aspen --network_address=:40856 --www_root=doc/ --project_root=doc/.aspen`
2012-12-12T16:02:10+00:00 app[web.1]: ImportError: No module named site
2012-12-12T16:02:11+00:00 heroku[web.1]: Process exited with status 1
2012-12-12T16:02:11+00:00 heroku[web.1]: State changed from starting to crashed 
```

我准备好了另一个版本，所以我像往常一样部署。之后`git push heroku`，该站点已备份。我`heroku config`没有上面列出的额外环境变量：

```
$ heroku config
=== aspen-io Config Vars
ASPEN_IO_SHOW_GA: yes
PATH:             bin:/usr/local/bin:/usr/bin:/bin
PYTHONUNBUFFERED: true 
```

**更新：** @kennethreitz向[我指出了](https://twitter.com/kennethreitz/status/278894715712192512)这[一点](https://github.com/heroku/heroku-buildpack-python/wiki/Troubleshooting)：

> **无法导入模块站点**
> 
> 当配置的环境变量与安装的 Python 的路径不匹配时，会发生这种情况。发生这种情况时，是因为有人在不了解上述含义的情况下清除了应用程序的缓存。
> 
> 要修复，要么清除缓存并更新配置，要么恢复预期的配置（首选）。

# javascript - 使用javascript从另一个页面获取参数？

> ID：12717906
> 
> 赞同：-2
> 
> 时间：2012-10-03T22:41:57.133
> 
> 标签：javascript, asp.net, wordpress

我有一个 wordpress 网站，我不是 php 开发人员，也不是很想开始，所以我像瘟疫一样避免它，但我确实有一个需要一点额外编码的要求。我需要：

1.  去不同的网站，
2.  下载那个页面，
3.  检查某个短语，
4.  如果短语存在，则从该页面中提取链接
5.  如果返回链接，我需要在我的 wordpress 网站上显示该链接。

目前，我有一个执行此操作的 asp.net 页面，并且我将该页面托管在我的 wordpress 网站上的 iframe 中。但我想在没有 iframe 的情况下做到这一点。

问题是，无论如何，javascript 是否可以转到不同的页面（我的 asp.net 页面）并从中获取参数（链接）。如果提供链接，我将在 wordpress 网站上显示某些内容。

或者javascript可以从服务器下载文本文件吗？问题是我需要一个触发器来更新文本文件。

任何建议表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:39:00.447

使用 ajax 并连接到以服务器端语言（如您所说的 asp.net）编写的不同页面（在您的服务器上），该页面连接到远程网站。

[更多关于阿贾克斯](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:43:31.600

您应该理解的是，通过“像瘟疫一样避免 [PHP]”，您会无意中避免正确的做事方式。Javascript 是一种客户端语言，而 PHP 是一种服务器端语言。通过断言您只想要客户端的负载（您想要做的事情所涉及的逻辑并不完全是轻量级的），您最终可能会得到一个非常慢的网页。

更不用说，这种情况类似于使用锤子做反铲的工作。

无论哪种方式，回答你的问题，是的。您可以将 jQuery [Load](http://api.jquery.com/load/)方法与 Javascript 的[Match](http://msdn.microsoft.com/en-us/library/7df7sf4x(v=vs.94).aspx)方法结合使用。

但是，您应该尝试使用 PHP 发出[CURL](http://php.net/manual/en/book.curl.php)请求，然后将页面缓存在您的服务器上。通过这样做，您将限制对给定页面的调用次数，并优化加载时间。

请考虑第二种选择，即使是作为一种良好实践的尝试。祝你好运。

# haskell - 阻止 GHC 警告我一个特定的缺失模式

> ID：12717909
> 
> 赞同：4
> 
> 时间：2012-10-03T22:42:22.400
> 
> 标签：haskell, warnings, ghc

假设我通常希望收到关于代码中不完整模式的警告，但有时我知道某个函数的模式不完整，我知道这很好。

GHC 的警告粒度是每个模块的，并且没有办法更改有关特定功能或定义的警告，这[仍然是真的吗？](https://stackoverflow.com/a/5774619/740235)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T22:52:35.087

是的，仍然正确，但您可以使用`error`.

```
f (Just a) = show a 
```

没有案例`Nothing`给出警告但添加

```
f Nothing = error "f: Nothing supplied as an argument. This shouldn't have happened. Oops." 
```

摆脱警告。

您的问题的按功能解决方案是给 Haskell 一些您认为永远不会运行的代码，以保持安静。

请注意：我认为您的代码应该是健壮的并且涵盖所有可能发生的情况，除非您能证明它永远不会发生。我认为解决这个限制并不是很好的做法。

（您可能认为这是一个敞开的后门，可以破解有用的编译时检查，应该停止`-Wall`，但我可以混淆我的回合您选择的任何简单限制，我认为该问题的完整解决方案将基本上解决了停机问题，所以我们不要责怪编译器。）

# ajax - 在 JSF 2.0 中验证 ajax 更新的最佳方式是什么？

> ID：12717913
> 
> 赞同：6
> 
> 时间：2012-10-03T22:42:33.553
> 
> 标签：ajax, validation, jsf, jsf-2, openfaces

自使用 Stripes 多年以来，我们的团队正在编写其第一个 JSF 2.0 应用程序，我对使用 f:ajax 标记和验证输入的最佳方式有一些疑问。

我看到回答的很多问题都有一个带有多个输入的表单，然后是一个提交按钮），但我们希望维护单个输入字段在更改后立即更新并持久保存到数据库（没有提交按钮。我们有这个工作使用 Prototype 的 Ajax.Request 在 Stripes 中很好，但如果可能的话，这是我想避免的额外步骤。

本质上，我们有一个页面，上面有一堆直接由 bean 支持的输入，例如：

```
<h:inputText id="name" value="#{personController.name}" >
    <f:ajax listener="#{personController.ajax}" />
</h:inputText> 
```

您可能知道，在调用侦听器时，bean 上的 name 值已经更改。这会很方便，但我有一些问题：

*   侦听器显然不知道 bean 的哪个值被更改
*   该值已更改，我无法对其执行任何服务器端验证
*   我不知道 name 的旧值是什么，即使我可以对其执行某种验证，我也不知道将值设置回什么

现在看起来我们必须实现某种 javascript 中间人来接收更改的属性和新值，将其发送到 Controller，并让它执行验证、更新数据库、发送回要渲染的内容等. 但就像我说的，这就是我们过去用 Stripes 做的事情，我真的很想用更原生的东西。

我确实看到，如果我们想要页面上的某种提交按钮，我们可以使用 valueChangeListener 属性之类的东西，但我也想避免大量提交。

我包含了 OpenFaces 标记，因为我们已经将它用于数据表，所以如果那里有什么好东西，我们愿意使用它。但据我所知，他们的 o:ajax 标签并不比 JSF 的 f:ajax 强大得多。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T23:38:59.663

您正在寻找错误的方向来实现验证输入字段的具体功能要求。您应该为此使用普通的 JSF 验证器，而不是在错误的时刻（`INVOKE_ACTION`阶段而不是`PROCESS_VALIDATIONS`阶段）运行并且您不直接掌握模型值的某些 ajax 侦听器方法。ajax 侦听器方法仅用于根据*当前*模型值执行一些业务逻辑。

`required`JSF 在属性和几个`<f:validateXxx>`标签后面有几个内置的验证器。您甚至可以通过实现[`Validator`](http://docs.oracle.com/javaee/6/api/javax/faces/validator/Validator.html)接口来创建自定义验证器。

例如检查需求：

```
<h:inputText ... required="true">
    <f:ajax />
</h:inputText> 
```

或者使用[各种`<f:validateXxx>`标签](http://download.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)之一检查它是否与模式匹配：

```
<h:inputText ...>
    <f:validateRegex pattern="[a-z]+" />
    <f:ajax />
</h:inputText> 
```

或使用自定义验证器：

```
<h:inputText ...>
    <f:validator validatorId="myValidator" />
    <f:ajax />
</h:inputText> 
```

和

```
@FacesValidator("myValidator")
public class MyValidator implements Validator {

    @Override
    public void validate(FacesContext context, UIComponent component, Object value) {
        if (value is not valid) {
            throw new ValidatorException(new FacesMessage(...));
        }
    }

} 
```

`<f:ajax>`仅用于在 HTML DOM 事件（或复选框/单选按钮的情况下的事件）期间提交当前输入`change`字段`click`。您不一定需要`<f:ajax listener>`方法来通过 ajax 提交当前输入字段。如果你想挂钩值更改事件，只需使用`valueChangeListener`.

```
<h:inputText ... valueChangeListener="#{bean.valueChanged}">
    <f:ajax />
</h:inputText> 
```

和

```
public void valueChanged(ValueChangeEvent event) {
    Object oldValue = event.getOldValue();
    Object newValue = event.getValue();
    UIComponent component = event.getComponent();
    // ...
} 
```

请注意，只有在特定组件上通过验证时才会调用它。

# c# - C# - 我应该一次从 FileStream 读取多少字节？

> ID：12717914
> 
> 赞同：1
> 
> 时间：2012-10-03T22:42:43.647
> 
> 标签：c#, arrays, byte, filestream, max

标题并没有使我的要求变得那么明显，但是我创建了一种算法，可以将一堆文件压缩成一个文件，然后再次解压缩它们。为了避免 OutOfMemory 异常，我使用了两个 fileStreams，首先从原始文件中读取数据段，然后另一个 fileStream 将这些段写入最终文件。

我在下面包含了我的代码摘录。在这种情况下，已经相应地声明了 rStream 和 wStream，并且 bufferSize 当前为 16 mB。fInfo 是我们正在读取的文件的文件信息。

显然bufferSize越高，操作完成的越快。我想知道我应该使用什么最大可能的 bufferSize 来最大化操作效率？

```
 int bytesRead = 0;
                long toRead = fInfo.Length - curFileSize;
                if (toRead > bufferSize) { toRead = bufferSize; }
                byte[] fileSegment = new byte[toRead];

                while (bytesRead < toRead)
                {
                    bytesRead += rStream.Read(fileSegment, bytesRead, (int)toRead - bytesRead);
                }

                wStream.Seek(finalFileSize, SeekOrigin.Begin);
                wStream.Write(fileSegment, 0, (int)toRead); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:48:01.697

数据量取决于多种因素。如果您使用较小的块，则压缩算法不必等待第一个块进入的时间，从而改进了对较小文件大小的压缩。较大的块占用更多内存，但会导致更少的读取操作，从而提高性能。如果在这种情况下您的文件小于 16MB，则您的读取`ReadToEnd()`与压缩没有什么不同，并且不会开始压缩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:01:03.807

16 MB 的缓冲区绝对听起来有点矫枉过正。通常几千字节用于这样的缓冲区。在 16 MB 时，使缓冲区变大几乎没有收益，或者根本没有。

考虑一下，如果您使用的是大缓冲区，它将不适合处理器缓存并且访问速度会更慢。如果你让它变得非常大，它的一部分甚至可能被换出到磁盘，所以在那个时候让缓冲区变大只会让它变慢。

# sql - 需要 SQL 语法

> ID：12717916
> 
> 赞同：-5
> 
> 时间：2012-10-03T22:42:59.840
> 
> 标签：sql

我在 sql 中有 3 个表，如下所示：（需要 sql 语法）

1

```
.xy8vx_users
-username
-email
-.... 
```

2

```
.xy8vx_rsform_submissions
-SubmissionId
-Username
-... 
```

3

```
.xy8vx_rsform_submissions_values
-SubmissionId
-FieldName
-FieldValue
-... 
```

我想得到： `xy8vx_users.username, and xy8vx_users.email`，满足条件

```
submission_values.FieldName = 'data2' AND submission_values.FieldValue = '10.03.2012' 
```

我已经花了 2 个小时，没有人可以帮助我吗？

我试过这个：（但不工作）

```
SELECT sub.Username
FROM `xy8vx_rsform_submission_values` AS value
JOIN `xy8vx_rsform_submissions` AS sub ON value.SubmissionId = sub.SubmissionId
JOIN xy8vx_users ` AS users ON sub.Username = users.email WHERE value.FieldName = 'data2' AND value.FieldValue = '10.03.2012'` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:52:20.390

```
select xy8vx_users.username, xy8vx_users,email
from
submission_values 
inner join
submissions on 
submission_values.SubmissionId = submissions.SubmissionId
inner join
xy8vx_users on
submissions.Username = xy8vx_users.username
where 
submission_values.FieldName = 'data2'
and 
submission_values.FieldValue = '10.03.2012' 
```

# visual-c++ - 客户端/服务器通信中的中间件

> ID：12717929
> 
> 赞同：7
> 
> 时间：2012-10-03T22:44:17.937
> 
> 标签：visual-c++, client-server, winsock, broker

我正在用 C++ 构建一个客户端/服务器对，并且我已经使用它`winsock`进行通信。但是，我无法在 C++ 中找到任何库，通过它我可以实现一些东西，而不是直接从客户端向服务器发送请求，而是存储请求，然后与服务器通信。

是否有任何方法或库可以将请求发送到诸如经纪人之类的东西，反之亦然？将存储请求，然后将与服务器通信的东西。这些是我已经在使用的库：

```
#pragma comment( linker, "/defaultlib:ws2_32.lib")
#include <WinSock2.h>
#include <winsock.h>
#include <stdio.h>
#include <iostream>
#include <string.h>
#include <windows.h>
#include <ws2tcpip.h>
#include <fstream>
using namespace std;

#define HOSTNAME_LENGTH 20
#define RESP_LENGTH 40
#define FILENAME_LENGTH 20
#define REQUEST_PORT 5001
#define BUFFER_LENGTH 1024 
#define TRACE 0
#define MSGHDRSIZE 8 //Message Header Size 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T08:30:14.990

您需要编写自己的库来实现您的目标。我认为拥有这样的“经纪人”没有任何实际用途，它只是将请求堆叠起来并一一发送，因此没有商业可用。你可以写一个，如果你真的想要这样的东西，它不会是一项艰巨的任务。这可能是您的应用程序特定需求，我会让您上面的 WinSock 代码足够智能以处理它并避免搜索/编写这样的库。

您可能还想考虑 microsoft REST HTTP library aka casablanca 并在编写这样的库之前阅读以下博客文章。

[http://blogs.msdn.com/b/vcblog/archive/2013/07/10/intercepting-http-request_2f00_response-using-c_2b002b00_-rest-http-library.aspx](http://blogs.msdn.com/b/vcblog/archive/2013/07/10/intercepting-http-request_2f00_response-using-c_2b002b00_-rest-http-library.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-23T15:44:30.790

您所描述的是消息队列。查看 MSMQ（Microsoft 消息队列）或 RabbitMQ。这将允许您的客户端应用程序向队列发送请求。然后您的服务器将从队列中读取请求并酌情处理它们。

# python - Heroku Django：找不到模块

> ID：12717930
> 
> 赞同：1
> 
> 时间：2012-10-03T22:44:19.347
> 
> 标签：python, django, heroku

我正在遵循 Django 的[Heroku 说明](https://devcenter.heroku.com/articles/django)，但遇到了麻烦：

```
2012-10-03T22:33:55+00:00 app[web.1]: Error: No module named widget_tweaks
2012-10-03T22:33:57+00:00 heroku[web.1]: Process exited with status 1
2012-10-03T22:33:57+00:00 heroku[web.1]: State changed from starting to crashed 
```

对我来说，Heroku 似乎找不到我的[django-widget-tweaks](http://pypi.python.org/pypi/django-widget-tweaks)应用程序。由于我目前没有使用它，因此我尝试将其从 INSTALLED_APPS 设置以及我的 requirements.txt 文件中删除。然后我重新提交了我的文件，将它们推送回 heroku master，然后尝试：

```
heroku restart 
```

...但问题仍然存在。还有其他地方可以删除对该模块的引用吗？关于为什么首先找不到这个模块的任何想法？当我在计算机上的 django 开发服务器上本地部署时，它工作正常。

# php - 如何在不登录或没有用户交互的情况下获取 Facebook 页面 access_token

> ID：12717932
> 
> 赞同：1
> 
> 时间：2012-10-03T22:44:21.510
> 
> 标签：php, facebook, api, facebook-authentication

我一直在阅读 Facebook 文档，但我一定遗漏了一些东西，因为我无法理解如何在没有实际登录的情况下获取页面的访问令牌。我正在尝试使用 PHP facebook API 创建一个 PHP 函数，这样当我在我的网站上添加新的故事或教程时，我的网站的应用程序可以自动在我的 facebook 页面上作为页面发布关于它们的简介。

我有这个功能，但只有当我从 Graph API Explorer 获取访问令牌时，虽然访问令牌在大约一个小时后过期。我似乎无法弄清楚如何以编程方式获取页面的 access_token 并每次从我的 PHP 脚本中查询一个新的，这样它们就不会过期并且不需要用户交互。

```
 function post_to_facebook($title, $message, $link, $picture) {

            require '../facebook/src/facebook.php';

            $page_token = 'xxx';

            $page_id = 'xx';

            $facebook = new Facebook(array(
                    'appId'  => '<app_id>',
                    'secret' => '<app_secret>',
                    'cookie' => false,
            ));

            $facebook->setAccessToken($page_token);

            try {
                    $ret_obj = $facebook->api('/'.$page_id.'/feed', 'POST', array(
                                            'caption' => $title,
                                            'link' => $link,
                                            'message' => $message,
                                            'picture' => $picture
                                     ));

            } catch(FacebookApiException $e) {
                    error_log($e->getType());
                    error_log($e->getMessage());

                    return false;
            }

            return true;
    } 
```

有人可以解释我如何在无需通过图形 api explorer 手动查找或让用户登录的情况下检索访问令牌吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:45:56.423

这是不可能的。

获得访问令牌的唯一正确（和合法）方法是通过用户交互（通过登录过程）。

# iphone - iPhone 收到 ABC 禁止发送自动释放的明确消息

> ID：12717933
> 
> 赞同：-2
> 
> 时间：2012-10-03T22:44:26.433
> 
> 标签：iphone

我正在将一些代码从一个项目复制到另一个项目以填写表格视图，我收到此错误

```
ABC Forbids explicit message sent of auto release 
```

当我尝试创建 UITableViewCell 对象时。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
       // this line produces the error
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:48:30.947

我认为您的意思是ARC（不是ABC）？当您的项目使用自动引用计数时，您不需要调用`release`、`retain`或`autorelease`. 在这种情况下，您可以摆脱自动释放调用，您的代码应该可以编译。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T23:30:32.507

如果您不使用 ARC（或 ABC :D），您应该在`release`正常情况下使用它`-(void)delloc` 并且如果您使用删除代码行（只是`autorelease`）。

# nhibernate - 如何映射到与父 ID 不同的列的连接子类？

> ID：12717935
> 
> 赞同：6
> 
> 时间：2012-10-03T22:44:54.307
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, fluent-nhibernate-mapping

我正在使用[棕地](http://en.wikipedia.org/wiki/Brownfield_%28software_development%29)数据库，并尝试配置一个子类映射，该映射使用指定 ID 以外的列连接到其子类。该`login`表有一个主键列`login_sk`，我想将其用作其 ID。它通过一列连接到两个表`login_cust_id`（为了使事情更有趣，相邻表中的相应列的名称不同）。如果我设置`login_cust_id`为 UserMap 的 id，它会按预期加入其子类。出于我希望的明显原因，我不想将`login_cust_id`其用作我的 User 对象的 id。

```
public class UserMap : ClassMap<IUser>
{
    public UserMap()
    {
        Table("login");
        Id(x => x.Id).Column("login_sk"); // want to setup map like this

        // if used instead this works for subclass joining / mapping
        // Id(x => x.Id).Column("login_cust_id");
        // would prefer to only reference login_cust_id for subclass mapping
    }
}

public class CustomerUserMap : SubclassMap<CustomerUser>
{
    public CustomerUserMap()
    {
        Table("customer");
        Map(c => c.DisplayName, "cust_mail_name");
        Map(c => c.RecordChangeName, "cust_lookup_name");
        KeyColumn("cust_id");
    }
}

public class EntityUserMap : SubclassMap<EntityUser>
{
    public EntityUserMap()
    {
        Table("entity");
        Map(c => c.DisplayName, "entity_name");
        KeyColumn("entity_id");
    }
} 
```

我想做的只是`login_cust_id`在加入子类时使用该列。是否有一个流畅的映射设置允许我指定这个？如果不是流利的映射，是否有常规的 NHibernate XML 映射可以工作？我什至宁愿不映射该列，并且仅在可能的情况下将其用于加入。如果有帮助，则有一个潜在的鉴别器列`login_holder_type`，它指示要加入哪个表。

我确实想到设置一个，`IClassConvention`但是在戳过去之后，`IClassInstance`我无法确定任何对我有帮助的设置。

```
public class UserIdConvention : IClassConvention, IClassConventionAcceptance
{

    public void Apply(IClassInstance instance)
    {
        // do something awesome with instance.Subclasses to
        // specify the use of login_cust_id for subclass joining...
    }

    public void Accept(IAcceptanceCriteria<IClassInspector> criteria)
    {
        criteria.Expect(x => typeof(User).Equals(x.EntityType));
    }
} 
```

传递的实例缺少填充的子类集合导致我寻找一个看起来更具体的检查器[`IParentInspector`](https://github.com/jagregory/fluent-nhibernate/blob/master/src/FluentNHibernate/Conventions/Inspections/IParentInspector.cs)。不幸的是， [Fluent NHibernate](http://www.fluentnhibernate.org/)似乎没有对应的实现`IParentInstance`，`IParentConvention`或者`IParentConventionAcceptance`像它一样[`IJoinedSubclassInspector`](https://github.com/jagregory/fluent-nhibernate/blob/master/src/FluentNHibernate/Conventions/Inspections/IJoinInspector.cs)。虽然我可能可以在我这样做之前实现我自己的，但我想确保我没有在错误的树上吠叫。

这种子类ID调整甚至可能吗？我是否在我的地图或[Fluent NHibernate Conventions 命名空间](https://github.com/jagregory/fluent-nhibernate/tree/master/src/FluentNHibernate/Conventions)中遗漏了一些明显的东西？如何映射到具有与父 ID 不同的列/属性的连接子类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:31:05.953

我能够想到三种可能的解决方案来解决您的问题，请在下面查看我的发现。

## 解决方案 1：使用 Join 的基于鉴别器的映射

我最初的想法是使用基于鉴别器的映射来建模继承，每个子类都包含一个带有属性 ref 的连接，即

```
<class name="IUser" abstract="true" table="login">
    <id name="Id" column="login_sk">
        <generator class="identity"/>
    </id>
    <discriminator column="login_holder_type" not-null="true" type="System.String"/>

    <subclass name="CustomerUser" discriminator-value="Customer">
        <join table="customer" >
          <key column="cust_id" property-ref="login_cust_id" />
          <property name="DisplayName" column="cust_mail_name"/>
          <property name="RecordChangeName" column="cust_lookup_name" />
        </join>
    </subclass>

    <subclass name="EntityUser" discriminator-value="Entity">
      <join table="entity" >        
        <key column="entity_id" property-ref="login_cust_id" />
        <property name="CompanyName"/>
      </join>
    </subclass>
</class> 
```

不幸的是，此时 Hibernate 支持此功能，但 NHibernate 不支持。请[在此处](https://nhibernate.jira.com/browse/NH-1452)和[此处](https://nhibernate.jira.com/browse/NH-3143)查看未完成的门票。已经进行了一些工作来添加此功能，这可以在 github上的[这个fork 上看到。](https://github.com/Nicaog/nhibernate-core/tree/NH-1681)

## 解决方案 2：基于判别器的多对一映射

另一种选择是仍然使用基于鉴别器的映射，但[`many-to-one`](http://nhforge.org/doc/nh/en/index.html#mapping-declaration-manytoone)在每个子类中使用映射，这将允许您使用 property-ref 加入外键。这样做的缺点是需要为客户表和实体表中的所有属性使用单独的类，但这是一个可行的解决方案。

```
<class name="IUser" abstract="true" table="login">
    <id name="Id" column="login_sk">
        <generator class="identity"/>
    </id>
    <discriminator column="login_holder_type" not-null="true" type="System.String"/>

    <subclass name="CustomerUser" discriminator-value="Customer">
        <many-to-one name="CustomerProps" property-ref="login_cust_id" />
    </subclass>

    <subclass name="EntityUser" discriminator-value="entity">
        <many-to-one name="EntityProps" property-ref="login_cust_id" />     
    </subclass>
</class>

<class name="CustomerProps" Table="customer" >
  <id name="Id" column="cust_id">
    <generator class="assigned"/>
  </id>
  <property name="DisplayName" column="cust_mail_name"/>
  <property name="RecordChangeName" column="cust_lookup_name" />
</class>

<class name="EntityProps" Table="entity" >
  <id name="Id" column="entity_id">
    <generator class="assigned"/>
  </id>
  <property name="CompanyName"/>
</class> 
```

## 解决方案 3：基于鉴别器的映射与可更新视图的连接

最后一个选项是在数据库中为包含 login_sk 字段的客户表和实体表创建一个可更新视图。然后，您可以`Join`在每个子类中使用，因为您不需要`property-ref`.

```
<class name="IUser" abstract="true" table="login">
    <id name="Id" column="login_sk">
        <generator class="identity"/>
    </id>
    <discriminator column="login_holder_type" not-null="true" type="System.String"/>

    <subclass name="CustomerUser" discriminator-value="Customer">
        <join table="customerView" >
          <key column="login_sk" />
          <property name="DisplayName" column="cust_mail_name"/>
          <property name="RecordChangeName" column="cust_lookup_name" />
        </join>
    </subclass>

    <subclass name="EntityUser" discriminator-value="Entity">
      <join table="entityView" >        
        <key column="login_sk" />
        <property name="CompanyName"/>
      </join>
    </subclass>
</class> 
```

# objective-c - 使用 C 库的架构 x86_64 的未定义符号

> ID：12717942
> 
> 赞同：2
> 
> 时间：2012-10-03T22:45:24.013
> 
> 标签：objective-c, c, xcode, macos

我一直有很多链接器错误。我确保通过 macports 安装了我需要的所有库。我整理了所有的包含错误，但现在我还有很多链接器错误。

HEADER_SEARCH_PATHS = /opt/local/include /usr/include /opt/local/include/json LIBRARY_SEARCH_PATHS = /opt/local/lib /usr/local/lib

```
Build target PianoLounge

Ld /Users/jordan/Library/Developer/Xcode/DerivedData/PianoLounge-ajgojrzszrergafgvyuliphwxcpg/Build/Products/Debug/PianoLounge.app/Contents/MacOS/PianoLounge normal x86_64
    cd /Users/jordan/Projects/Cocoa/PianoLounge
    setenv MACOSX_DEPLOYMENT_TARGET 10.8
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch x86_64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk -L/Users/jordan/Library/Developer/Xcode/DerivedData/PianoLounge-ajgojrzszrergafgvyuliphwxcpg/Build/Products/Debug -L/opt/local/lib -L/usr/local/lib -F/Users/jordan/Library/Developer/Xcode/DerivedData/PianoLounge-ajgojrzszrergafgvyuliphwxcpg/Build/Products/Debug -filelist /Users/jordan/Library/Developer/Xcode/DerivedData/PianoLounge-ajgojrzszrergafgvyuliphwxcpg/Build/Intermediates/PianoLounge.build/Debug/PianoLounge.build/Objects-normal/x86_64/PianoLounge.LinkFileList -mmacosx-version-min=10.8 -fobjc-arc -fobjc-link-runtime -framework Cocoa -o /Users/jordan/Library/Developer/Xcode/DerivedData/PianoLounge-ajgojrzszrergafgvyuliphwxcpg/Build/Products/Debug/PianoLounge.app/Contents/MacOS/PianoLounge

Undefined symbols for architecture x86_64:
  "_gcry_cipher_close", referenced from:
      _PianoDestroyPartner in piano.o
  "_gcry_cipher_decrypt", referenced from:
      _PianoDecryptString in crypt.o
  "_gcry_cipher_encrypt", referenced from:
      _PianoEncryptString in crypt.o
  "_gcry_cipher_open", referenced from:
      _PianoInit in piano.o
  "_gcry_cipher_setkey", referenced from:
      _PianoInit in piano.o
  "_gnutls_bye", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_certificate_allocate_credentials", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_certificate_free_credentials", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_certificate_get_peers", referenced from:
      _WaitressTlsVerify in waitress.o
  "_gnutls_certificate_type_get", referenced from:
      _WaitressTlsVerify in waitress.o
  "_gnutls_credentials_set", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_deinit", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_handshake", referenced from:
      _WaitressConnect in waitress.o
  "_gnutls_init", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_record_recv", referenced from:
      _WaitressGnutlsRead in waitress.o
  "_gnutls_record_send", referenced from:
      _WaitressGnutlsWrite in waitress.o
  "_gnutls_set_default_priority", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_transport_set_ptr", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_transport_set_pull_function", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_transport_set_push_function", referenced from:
      _WaitressFetchCall in waitress.o
  "_gnutls_x509_crt_deinit", referenced from:
      _WaitressTlsVerify in waitress.o
  "_gnutls_x509_crt_get_fingerprint", referenced from:
      _WaitressTlsVerify in waitress.o
  "_gnutls_x509_crt_import", referenced from:
      _WaitressTlsVerify in waitress.o
  "_gnutls_x509_crt_init", referenced from:
      _WaitressTlsVerify in waitress.o
  "_json_object_array_add", referenced from:
      _PianoRequest in request.o
  "_json_object_array_get_idx", referenced from:
      _PianoResponse in response.o
  "_json_object_array_length", referenced from:
      _PianoResponse in response.o
  "_json_object_get_boolean", referenced from:
      _PianoResponse in response.o
      _PianoJsonParseStation in response.o
  "_json_object_get_double", referenced from:
      _PianoResponse in response.o
  "_json_object_get_int", referenced from:
      _PianoResponse in response.o
  "_json_object_get_object", referenced from:
      _PianoResponse in response.o
  "_json_object_get_string", referenced from:
      _PianoResponse in response.o
      _PianoJsonStrdup in response.o
  "_json_object_new_array", referenced from:
      _PianoRequest in request.o
  "_json_object_new_boolean", referenced from:
      _PianoRequest in request.o
  "_json_object_new_int", referenced from:
      _PianoRequest in request.o
  "_json_object_new_object", referenced from:
      _PianoRequest in request.o
  "_json_object_new_string", referenced from:
      _PianoRequest in request.o
  "_json_object_object_add", referenced from:
      _PianoRequest in request.o
  "_json_object_object_get", referenced from:
      _PianoResponse in response.o
      _PianoJsonStrdup in response.o
      _PianoJsonParseStation in response.o
  "_json_object_put", referenced from:
      _PianoRequest in request.o
      _PianoResponse in response.o
  "_json_object_to_json_string", referenced from:
      _PianoRequest in request.o
  "_json_tokener_parse", referenced from:
      _PianoResponse in response.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T00:11:13.543

看起来您缺少链接所需的库 gnutls、gcrypt 和 json。除非您告诉 Xcode 要链接哪些库，否则不会有任何想法。它看起来像这样：

```
-lgnutls -lgcrypt -ljson 
```

（这是一个例子，我不确定具体需要哪些库）。

您需要将它们添加为额外的库以链接到您的 Xcode 项目中。

# ios - XCode 4.5 / iOS6：我的 iPad 应用程序在横向模式下的方向问题

> ID：12717951
> 
> 赞同：11
> 
> 时间：2012-10-03T22:46:20.247
> 
> 标签：ios, xcode, ipad, ios6, xcode4.5

我刚刚在 XCode 4.5 上打开了我的 iPad 项目。我的应用程序设计为在横向模式下运行。它在以前版本的 XCode 上完美运行。但是在 XCode 4.5 上，它旋转了 90°（四分之一圈），屏幕右侧有一个空白区域（我的视图具有正确的大小，但超出了屏幕）。它看起来像这样：

![视图（红色）旋转 90° 并在横向模式下离开屏幕](../Images/d4547fa873e8abe2eb60a5e9597cb1f3.png)

我检查了以下帖子但没有帮助：

[ios6中的方向问题](https://stackoverflow.com/questions/12706440/orientation-issue-in-ios6)

[ios6从横向到纵向模式的旋转问题](https://stackoverflow.com/questions/12708652/ios6-rotation-issue-from-landscape-to-portrait-mode)

[在 xcode 4.5 GM IOS 6 中将方向设置为横向模式](https://stackoverflow.com/questions/12600082/set-orientation-to-landscape-mode-in-xcode-4-5-gm)

有人有这个问题吗？

任何帮助，将不胜感激 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T23:51:32.777

谢谢大家的回复。我终于找到了解决方案。

首先，在目标摘要菜单中检查所有启动图像的方向和大小是否正确（项目的蓝色图标 => 目标 => 摘要 => 在底部滚动）；如果尺寸或方向不正确，您会在启动图像上收到一条未正确设置的警告。

到目前为止，我有一个具有这种结构的项目（旧的 XCode 时尚）：

*   `AppDelegate.h`和.m
*   `RootViewController.h`和.m
*   a`MainWindow-Iphone.xib`和`MainWindow-iPad.xib`（`RootViewController`在 Interface Builder 中链接；请参阅下面的屏幕截图，其中黄色/棕色图标（内部带有正方形）相对于`RootViewController`）

下面是它的截图：

![我的旧项目结构](../Images/5a9b300f78f1570a063dc0c7c8269ee3.png)

这是我的 AppDelegate 的 applicationDidFinishLaunching: 方法中的代码：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {  

     [window addSubview:[rootViewController view]];
     [window makeKeyAndVisible];

} 
```

我所做的是更接近您在使用 XCode 4.5 创建一个空项目时获得的结构。最后：

1.  我删除了`MainWindow.xib`and`MainWindow-iPad.xib`现在以编程方式创建了我的窗口（更清晰，更好地确保它适合任何屏幕的大小）
2.  我删除了在我的`Info.plist`（并设置为`MainWindow.xib`and `MainWindow-iPad.xib`）中定义的“Main nib file base name”和“Main nib file base name (iPad)”键
3.  我添加了空`RootViewController_iPhone.xib`和`RootViewController_iPad.xib`
4.  我改变了我的`applicationDidFinishLaunching`方法中的代码，如下所示：

    ```
    - (void)applicationDidFinishLaunching:(UIApplication *)application {    

    NSLog(@"applicationDidFinishLaunching");

     self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.rootViewController = [[RootViewController alloc] initWithNibName:@"RootViewController_iPhone" bundle:nil];
    } else {
        self.rootViewController = [[RootViewController alloc] initWithNibName:@"RootViewController_iPad" bundle:nil];
    }

    self.window.rootViewController = self.rootViewController;

    [self.window makeKeyAndVisible]; 
    ```

    }

现在，一切正常！iPad 上的方向正确！而且它比以前更清楚:) 我什至不必更改已弃用的方法，例如

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

顺便说一句，要确保您的所有视图都是全屏的（在 iPhone 5 上），请确保您的视图在 Interface Builder 中设置为“缩放以填充”模式并单击“自动调整子视图”。如果您的某些视图没有缩放到全屏，这可能是由于您创建控制器/视图的顺序（superView 仅在创建它（superView）时向其子视图发送通知）。要轻松解决此问题，只需在以下代码中添加以下代码`- (void)viewDidLoad method`：

```
CGRect screenBounds = [[UIScreen mainScreen] bounds];
    [self.view setFrame:CGRectMake(0,0,screenBounds.size.width,screenBounds.size.height)]; 
```

或使用：

```
[self presentModalViewController:myViewController animated:TRUE]; 
```

代替：

```
[self.view.superview addSubview:myViewController.view]; 
```

`presentModalViewController`确实向子视图发送调整大小通知。

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-08T21:31:33.920

确保您也设置了 window.rootViewController。我有同样的问题，但这条线为我解决了这个问题：

```
MainViewController *mainView = [[MainViewController alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
window.rootViewController = mainView; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T03:14:18.647

我在升级的应用程序上遇到了类似的问题。我还没有发现它记录在案，但似乎发生了变化。我最终发现新窗口似乎不知道旋转或大小，直到它成为关键和可见。我能够在 makeKeyAndVisible 之后立即将我的框架设置移动并且一切正常。我希望这对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-18T12:05:25.633

```
[[yourViewController view] setFrame:CGRectMake(0.0, 0.0, 1024.0, 768.0)];
[[yourViewController view] setTransform:CGAffineTransformTranslate(CGAffineTransformMakeRotation(0.5*M_PI),128.0,128.0)]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-12T18:13:58.880

如果您使用 Storyboards，一个简单的技巧是使用 loadView 方法。它在 viewDidLoad 之前调用。只需转到您的 Storyboard 并删除关联的视图，因为您将在 loadView 中以编程方式创建它。然后返回视图控制器类并复制以下代码：

```
- (void)loadView
{
    // You can adjust the view size and location here. If using full screen use the following code. If you have a tab bar for example and also want to account for the top default iPad bar, use: CGRectMake(0, 20, 1024, 699) instead.
    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 1024, 748)]; 
    view.backgroundColor = [UIColor whiteColor];
    view.autoresizesSubviews = NO;

    self.view = view;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-21T07:16:31.810

几个简单的步骤将为您解决这个问题。

首先，在 AppDelegate.m 中，检查您是否将 rootViewController 添加为子视图。也就是说，而不是这个，

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {  

 [window addSubview:[navigationController view]];
 [window makeKeyAndVisible];

 } 
```

做这样的事情

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {  

 window.rootViewController = navigationController;
 [window makeKeyAndVisible];

 } 
```

如果您将导航控制器设置为根视图控制器。

其次，如果您需要在您的 navigationController 的推送视图控制器中控制旋转方法，请为 UINavigationController 创建一个类别，如下所示：

```
#import "UINavigationController+Rotation.h"

@implementation UINavigationController (Rotation)

- (BOOL)shouldAutorotate {

    BOOL result = self.topViewController.shouldAutorotate;

    return result;
}

- (NSUInteger)supportedInterfaceOrientations {

    return self.topViewController.supportedInterfaceOrientations;
}

@end 
```

现在，这两种定位方法适用于 iOS 6 以上

***-(BOOL)shouldAutorotate***和
***-(NSUInteger)supportedInterfaceOrientations***

将在您的课程中被调用。

这是必要的，因为较旧的轮换方法，例如

***-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation***

已从 iOS 6 弃用。

所以最后，你需要在你的视图控制器中实现这些；像这样的东西：

```
-(BOOL)shouldAutorotate
    {
        return YES;
    }

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAll;
} 
```

如果你想让你的视图控制器旋转并支持所有方向。

其他方向掩码是：

1.  *UIInterfaceOrientationMaskPortrait*
2.  *UIInterfaceOrientationMaskLandscapeLeft*
3.  *UIInterfaceOrientationMaskLandscapeRight*
4.  *UIInterfaceOrientationMaskPortraitUpsideDown*
5.  *UIInterfaceOrientationMaskLandscape* 和
6.  *UIInterfaceOrientationMaskAllButUpsideDown*

# javascript - jquery ui sortable - 使用包含时拖动无法正常工作

> ID：12717952
> 
> 赞同：4
> 
> 时间：2012-10-03T22:46:26.783
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-sortable, sortables

我在无法拖动某些项目的地方遇到 jquery ui 可排序问题（我猜是因为项目元素的高度）

```
<div class="container">
<fieldset>
    <legend>handle 1 THIS CAN'T BE DRAGGED BELOW HANDLE 2</legend>
    <div>blah<br /></div>
</fieldset>
<fieldset>
    <legend>handle 2 BUT I CAN DRAG THIS ABOVE HANDLE 1</legend>
    <div style="display: none">blah<br /></div>
</fieldset> 
```

```
$(".container").sortable({
   axis: 'y',
   handle: '> legend',
   containment: 'parent',
   /*cursorAt: {top: 1},
   start: function(event, ui) {
      ui.placeholder.height(ui.item.height());
      $(this).sortable('refreshPositions');
   },*/
});​ 
```

请参阅[http://jsfiddle.net/ADyhR/10/](http://jsfiddle.net/ADyhR/10/) 编辑：它似乎在 jquery ui 1.8.9 中工作。它只是 1.8.18 中的一个错误吗？

注释掉的 javascript 行是我尝试过但没有奏效的东西，但我想我可能只是稍微偏离了我使用它们的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-01-05T07:57:15.617

您可以使用该[**`tolerance`**](http://api.jqueryui.com/sortable/#option-tolerance)选项并将其值设置为`tolerance: "pointer",`。我已经更新了您的 DEMO 并创建了一个[**NEW DEMO**](http://jsfiddle.net/phpdeveloperrahul/ADyhR/21/)。

这是**与`tolerance`添加选项**一起使用的 JS 代码：

```
$(".container").sortable({
    axis: 'y',
    tolerance: "pointer",
    handle: '> legend',
    containment: 'parent',
    /*cursorAt: {top: 1},
    start: function(event, ui) {
        ui.placeholder.height(ui.item.height());
        $(this).sortable('refreshPositions');
    },*/
}); 
```

# c# - 返回列表 来自列表 具有整数属性？

> ID：12717954
> 
> 赞同：2
> 
> 时间：2012-10-03T22:46:32.807
> 
> 标签：c#, linq, c#-4.0

最终结果是我想使用`.Where(t => someIntList.Contains(t.ID)).ToList()`. 我正在努力创造`someIntList`.

到目前为止我所拥有的：`List<Person> people = people.Where(p => p.isActive).ToList()`。我如何只归还`List<int>`房产的`p.ID`一部分？

或者有另一种方法来做包含（不写一个比较器类，因为我已经有一个用于另一个目的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T22:49:07.797

好吧，制作`List<int>`很容易，[`Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)用于执行投影：

```
List<int> activeIds = people.Where(p => p.IsActive)
                            .Select(p => p.ID)
                            .ToList(); 
```

但是，我不会这样做然后使用`Contains`，而是执行连接：

```
var activePeople = people.Where(p => p.IsActive);
var query = from person in otherList
            join activePeople on person.ID equals activePeople.ID
            select person; 
```

或者创建 a`HashSet<int>`而不是 a `List<int>`，这样`Contains`检查效率更高：

```
var activeIds = new HashSet<int>(people.Where(p => p.IsActive)
                                       .Select(p => p.ID));
var query = otherList.Where(t => activeIds.Contains(t.ID))
                     .ToList(); 
```

这两者都会给查找所有匹配项提供 O(M + N) 复杂性，而不是 O(M * N) 构造一个列表然后使用*它*进行`Contains`检查。

当然，这是假设`Contains`检查将在进程中完成。如果这*实际上*将用于 LINQ to SQL 查询，那么*可能*是传入 a`List<int>`很好 - 或者*可能*是连接允许您在数据库中完成所有操作。我们确实需要更多的上下文来给你好的建议——但*不要*仅仅停留在“这就是我可以构建一个`List<T>`，因此我完成了”。

# ruby - 如何重构 API 的 RSpec 测试

> ID：12717963
> 
> 赞同：3
> 
> 时间：2012-10-03T22:47:23.900
> 
> 标签：ruby, rspec, sinatra, rack-test

我有一系列基于 Sinatra 的 API 的 RSpec 测试，并希望重构它们以使它们更简单并减少重复。

这是一个路由测试的示例：

```
describe 'post /sections with empty data' do
    before do

        params = {
            :site_id    => site.id,
            :page_id    => page.id,
        }

        post '/sections', params, @session
    end

    specify { last_response.status.should == 200 }
    specify { json_response['id'].should_not be_nil }
    specify { json_response['type'].should == default_section_type }
end 
```

每个测试都将使用相同的基本 URL，具有相同的会话数据，唯一的区别是参数以及响应应该是什么。每条路由至少有 4 个测试（GET、POST、PUT、DELETE），通常更多。

有没有办法让这些测试更易于管理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T23:03:48.643

在不求助于元编程的情况下，您可以使用嵌套`describe`块来仅覆盖您想要的参数：

```
describe "/sessions" do
  before do
    send(http_method, "/sessions", params, @session)
  end

  describe "with POST" do
    let(:http_method) { :post }

    describe "and empty data" do
      let(:params) do
        { :site_id => site.id, :page_id => page.id }
      end

      specify { last_response.status.should == 200 }
      specify { json_response['id'].should_not be_nil }
      specify { json_response['type'].should == default_section_type }
    end

    describe "with non-empty data" do
      let(:params) do
        # relevant params
      end
    end
  end

  describe "with GET" do
    let(:http_method) { :get }

    # ...
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T23:06:44.473

不知道这是否有效，但它可以让您了解您可以做什么

```
describe ' /sections with empty data' do
    before(:all) do
      @params = {
            :site_id    => site.id,
            :page_id    => page.id,
        }
    end

    after(:each) do
      specify { last_response.status.should == 200 }
      specify { json_response['id'].should_not be_nil }
      specify { json_response['type'].should == default_section_type }
    end

    [:get, :post, :put, :delete].each do |http_method|
        it "works with #{http_method}" do
            send(http_method) '/sections', @params, @session
        end
    end
end 
```

* * *

## 更新

再次阅读你的问题让我意识到这不是你真正要求的。如果它根本没有帮助告诉我，所以我删除它。

# css - 链接 css3 转换

> ID：12717966
> 
> 赞同：1
> 
> 时间：2012-10-03T22:47:42.710
> 
> 标签：css, transition

将 css3 转换链接在一起的最佳方法是什么 - 即在一个元素完成后移动一个元素。粗略的方法是简单地使用 setTimeout()，更好的方法来监听转换结束事件？还有其他想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:54:33.573

在第二个过渡上设置一个延迟，即第一个过渡的长度。 [http://www.w3schools.com/cssref/css3_pr_transition-delay.asp](http://www.w3schools.com/cssref/css3_pr_transition-delay.asp)

或使用关键帧：[https ://stackoverflow.com/a/7294539/1431252](https://stackoverflow.com/a/7294539/1431252)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T23:05:43.310

[Jquery Transit](http://ricostacruz.com/jquery.transit/)是一个非常酷的库。它使用 CSS 制作动画，并在完成时为您提供回调，因此您可以像这样链接它们：

```
$('.box').
transition({ x: '-40px' }, 250).
transition({ x: '0px' }, 250).
transition({ y: '-40px' }, 250).
transition({ y: '0px' }, 250); 
```

# popup - JavaFX 2 自定义弹出窗格

> ID：12717969
> 
> 赞同：20
> 
> 时间：2012-10-03T22:47:51.970
> 
> 标签：popup, javafx-2, javafx

JavaFX 2 颜色选择器有一个按钮，可以弹出颜色选择器窗格，如下所示：

![JavaFX 2 颜色选择器](../Images/c8088d7eab064ac64adb7dc5d11a93d2.png)

我想做类似的事情，因为我希望在单击按钮时弹出一个自定义窗格，并在单击其他内容时消失（在我的情况下，是一些图像缩略图）。实现这一目标的最佳方法是什么？我应该使用 ContextMenu 并以某种方式将窗格添加到 MenuItem，还是我应该查看其他内容？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-04T00:42:02.553

使用当前的 JavaFX 2.2 API 很难做好。

这里有一些选项。

* * *

*使用在其 MenuItem 中设置图形的 MenuButton*

这是[Button with popup 中采用的方法，如下所示](https://stackoverflow.com/a/15560080/1155209)的可执行[示例代码](https://gist.github.com/jewelsea/5217750)。

![弹出窗口](../Images/685624780650780b685a583d9b47fe48.png)

* * *

*使用弹出控件*

看看 ColorPicker 如何在其[代码](http://hg.openjdk.java.net/openjfx/8/master/rt/file/7c436f8509c8/javafx-ui-controls/src/com/sun/javafx/scene/control/skin/ColorPickerSkin.java)中执行此操作。

ColorPicker 扩展[PopupControl](http://docs.oracle.com/javafx/2/api/javafx/scene/control/PopupControl.html)。您可以这样做，但目前并非所有构建您自己的 PopupControl 所需的 API 都是公开的。因此，对于 JavaFX 2.2，您将不得不依赖已弃用的内部 com.sun 类，这些类将被 JDK8 中的公共 javafx.scene.control 类取代。

* * *

*使用上下文菜单*

因此，我认为您“使用 ContextMenu 并向 MenuItem 添加窗格”的想法可能是目前最好的方法。您应该能够通过使用[CustomMenuItem](http://docs.oracle.com/javafx/2/api/javafx/scene/control/CustomMenuItem.html)或在 normal 上[设置图形](http://docs.oracle.com/javafx/2/api/javafx/scene/control/MenuItem.html#setGraphic%28javafx.scene.Node%29)`MenuItem`来做到这一点。`ContextMenu`有很好的相对[定位逻辑](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ContextMenu.html#show%28javafx.scene.Node,%20javafx.geometry.Side,%20double,%20double%29)。A`ContextMenu`也可以由[MenuButton](http://docs.oracle.com/javafx/2/api/javafx/scene/control/MenuButton.html)触发。

* * *

*使用自定义对话框*

为此，请在相对于节点的位置显示透明阶段。

有一些示例代码可以帮助您入门，我已[在此处](https://s3.amazonaws.com/baanthaispa/ConfirmationDialog.zip)临时链接。示例代码对主窗口的侧面进行相对定位，但您可以对其进行更新以执行相对于给定节点侧面的定位（如 ContextMenu 的 show 方法）。

* * *

*使用玻璃窗格*

为此，请创建一个 StackPane 作为主窗口的根。将主内容窗格放置为 StackPane 中的第一个节点，然后创建一个组作为 stackpane 中的第二个节点，以便它将覆盖在主要内容的顶部。通常，顶部组不包含任何内容，但是当您想要显示弹出窗口时，请将其放在顶部组中并将其转换为相对于主要内容中相应节点的位置。

您可以查看[此演示](https://gist.github.com/1441960)中的锚节点是如何使用的，以了解它如何适应您的上下文。

* * *

> JavaFX8 是否有相关更新？

Java 8 的相关性没有太大差异，一般来说，这些选项是基于 Java 2.2 功能在这篇文章中概述的。Java 8 确实添加了[Dialog](https://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/Dialog.html)和[Alert](https://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/Alert.html)功能，但它们更针对使用带有边框、标题和按钮的对话框，而不是问题中所需的那种功能。也许您可以从 Dialog 类开始并对其进行大量自定义以获得接近所需的内容，但您可能最好从空白阶段或 PopupControl 开始。

# javascript - 颜色框在 ExpressionEngine 嵌入中不起作用（youtube 弹出窗口）

> ID：12717973
> 
> 赞同：0
> 
> 时间：2012-10-03T22:48:25.957
> 
> 标签：javascript, css, embed, colorbox, expressionengine

马上，我想解释一下我是网页设计的新手。在这点上，我认为我遇到了一个超出我的概念技能水平的问题。

对于初学者，我已经使用以下代码成功实现了带有嵌入 youtube 视频的颜色框：

```
<head>
{js}
<link rel="stylesheet" type="text/css" media="all" href="{stylesheet='in-store-analytics/testStyle'}" />

<script>
$(document).ready(function(){
            $(".youtube").colorbox({iframe:true, innerWidth:435, innerHeight:344});
});
</script>
</head>

<body>
<p> <a class="youtube" href="http://www.youtube.com/embed/" title="horses">
<img src="/uploads/features/featured-block-1.jpg" /></a></p>
</body> 
```

这段代码完全按照我的意愿工作（即它会弹出视频，然后我可以通过在框外单击来关闭它。）

**但是**，当我尝试使用 ExpressionEngine 将此代码嵌入到另一个代码块中时，我遇到了新问题：当我尝试关闭弹出窗口时，背景保持不透明，因此我无法再看到原始网页。显然，背景中有一些冲突，但我只是不知道那个冲突可能是什么。

这是嵌入周围的代码（我用破折号标记嵌入）：

```
 <head>
</head>
    {favicon}
    {global_stylesheets}
    {js}

    <body class="technology">
        <div id="wrapper">
            {embed='embed/header'}
            <div id="masthead">
                {embed='embed/nav'}
                <div id="banner">

                    <div style="display:none;">

                    </div>
                </div> <!-- END div banner -->
                <br style="clear: left;" />
            </div> <!-- END div masthead -->

            <div id="content-main">
                <div id="content-col1">
                    <h3></h3>
                    <div id="lead-sentence">

                    </div>
                    <div id="main-body{if subpage_graphic != ''}-graphic{/if}">

            <h1> Hello world and welcome to my link!</h1>

        ------- {embed="in-store-analytics/testing2"} --------

                    </div> <!-- END div text-content -->

                    <br style="clear: both;" />
                </div> <!-- END div content-col1 -->
                {embed="embed/crosslinks"}
                <br style="clear: both;" />
            </div>
            {embed="embed/footer"}
        </div> <!-- END div wrapper --> 
```

同样，当我单击链接的图像时，只会出现我无法摆脱的黑色背景。关于我的代码中可能存在什么冲突以使嵌入不再起作用的任何想法或如何找出问题的想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T16:16:42.290

事实证明，我的一个嵌入程序调用了 Raphael 库，这意味着该库被调用了两次。虽然我知道这不是最佳实践，但我仍然不明白为什么这会导致如此完全不同的功能。

# php - 将分页添加到第 3 方模块 (OT-MiniNewsModule)

> ID：12717977
> 
> 赞同：2
> 
> 时间：2012-10-03T22:48:54.210
> 
> 标签：php, joomla, pagination, components

我目前正在尝试修改一个几乎可以完美满足我的要求但缺少分页的模块。我似乎无法掌握应该如何为其添加分页；大多数 JPagination 示例假设我可以访问查询，但在这个模块（使用 JFactory、JmoduleHelper 和 JModel）中，我看不到查询以添加限制等。

# mod_otmininews.php

```
//No direct access!
defined('_JEXEC') or die;

// Include the syndicate functions only once
require_once dirname(__FILE__).DS.'helper.php';

$doc = &JFactory::getDocument();
$doc->addStyleSheet(JURI::base().'/modules/mod_otmininews/css/layout.css');

$list = modOtMiniNewsHelper::getList($params);
$moduleclass_sfx = htmlspecialchars($params->get('moduleclass_sfx'));

require JModuleHelper::getLayoutPath('mod_otmininews', $params->get('layout', 'default')); 
```

# 助手.php

```
//No direct access!
defined('_JEXEC') or die;

require_once JPATH_SITE.'/components/com_content/helpers/route.php';

jimport('joomla.application.component.model');

JModel::addIncludePath(JPATH_SITE.'/components/com_content/models');

abstract class modOtMiniNewsHelper
{
public static function getList(&$params)
{
    // Get the dbo
    $db = JFactory::getDbo();

    // Get an instance of the generic articles model
    $model = JModel::getInstance('Articles', 'ContentModel', array('ignore_request' => true));

    // Set application parameters in model
    $app = JFactory::getApplication();
    $appParams = $app->getParams();
    $model->setState('params', $appParams);

    // Set the filters based on the module params
    $model->setState('list.start', 0);
    $model->setState('list.limit', (int) $params->get('count', 3));
    $model->setState('filter.published', 1);

    // Access filter
    $access = !JComponentHelper::getParams('com_content')->get('show_noauth');
    $authorised = JAccess::getAuthorisedViewLevels(JFactory::getUser()->get('id'));
    $model->setState('filter.access', $access);

    // Category filter
    $model->setState('filter.category_id', $params->get('catid', array()));

    // User filter
    $userId = JFactory::getUser()->get('id');
    switch ($params->get('user_id'))
    {
        case 'by_me':
            $model->setState('filter.author_id', (int) $userId);
            break;
        case 'not_me':
            $model->setState('filter.author_id', $userId);
            $model->setState('filter.author_id.include', false);
            break;

        case '0':
            break;

        default:
            $model->setState('filter.author_id', (int) $params->get('user_id'));
            break;
    }

    // Filter by language
    $model->setState('filter.language',$app->getLanguageFilter());

    //  Featured switch
    switch ($params->get('show_featured'))
    {
        case '1':
            $model->setState('filter.featured', 'only');
            break;
        case '0':
            $model->setState('filter.featured', 'hide');
            break;
        default:
            $model->setState('filter.featured', 'show');
            break;
    }

    // Set ordering
    $order_map = array(
        'm_dsc' => 'a.modified DESC, a.created',
        'mc_dsc' => 'CASE WHEN (a.modified = '.$db->quote($db->getNullDate()).') THEN a.created ELSE a.modified END',
        'c_dsc' => 'a.created',
        'p_dsc' => 'a.publish_up',
        'h_dsc' =>  'a.hits',
    );
    $ordering = JArrayHelper::getValue($order_map, $params->get('ordering'), 'a.publish_up');
    $dir = 'DESC';

    $model->setState('list.ordering', $ordering);
    $model->setState('list.direction', $dir);

    $items = $model->getItems();

    foreach ($items as &$item) {
        $item->slug = $item->id.':'.$item->alias;
        $item->catslug = $item->catid.':'.$item->category_alias;

        if ($access || in_array($item->access, $authorised))
        {
            // We know that user has the privilege to view the article
            $item->link = JRoute::_(ContentHelperRoute::getArticleRoute($item->slug, $item->catslug));
        }
        else {
            $item->link = JRoute::_('index.php?option=com_user&view=login');
        }
        //$item->title = htmlspecialchars( $item->title );
        $item->content= strip_tags(preg_replace('/<img([^>]+)>/i',"",$item->introtext));
        $item->content = substr($item->content, 0, $params->get('introtext_limit'));

        preg_match_all('/img.+src="([^"]+)"/i', $item->introtext, $matches);
        if(empty($matches[1][0])){
            $item->images="";
        }else{
            $item->images= $matches [1] [0];
        }

        //Show thumbnails
        if($params->get('showthumbnails')==1){
            if($item->images == ""){
                $item->thumbnail = '<img src="'.$params->get('directory_thumbdefault').'" width="'.$params->get('thumbwidth').'" height="'.$params->get('thumbheight').'" alt="'.$item->title.'" />';
            }else{
                $item->thumbnail = '<img src="' .$item->images.'" width="'.$params->get('thumbwidth').'" height="'.$params->get('thumbheight').'" alt="'.$item->title.'" />'  ;    //show images
            }
        }
        $item->created_date = $item->created; 
    }
    return $items;
}
} 
```

所有这些代码都创建了一个由

# 默认的.php

```
 defined('_JEXEC') or die;
?>

<div class="ot_news">
    <div class="ot_news_i">

        <?php 
        $count = 0;
        foreach ($list as $item) :  ?>
        <?php $count++; ?>
        <div class="ot_items <?php echo ($params->get('count') == $count)?'last-item':''; ?>">
            <!-- Show thumbnails -->
            <?php if($params->get('showthumbnails') == 1){?>
                <div class="ot_thumbs"  style="width:<?php echo $params->get('thumbwidth')?>px; height:<?php echo $params->get('thumbheight')?>px;">
                     <?php if($params->get('enablelinkthumb') == 1) {?>
                            <a href="<?php echo $item->link; ?>"><?php echo $item->thumbnail ;?></a>
                    <?php } else { ?>
                            <?php echo $item->thumbnail?>
                     <?php }?>
                </div>
            <?php } else { ?>
                <?php echo ''; ?>
            <?php } ?>
            <!-- End -->
             <!-- Show Titles -->
            <div class="ot_articles">
                <?php if($params->get('showtitle') == 1) { ?>
                    <div class="ot_title">
                     <?php if($params->get('enablelinktitle') == 1) { ?>
                         <a href="<?php echo $item->link; ?>" class="title"><?php echo $item->title; ?></a>
                    <?php }else{?>
                        <span class="title"><?php echo $item->title; ?></span>
                   <?php }?>
                   </div>
               <?php } ?>
                <!-- Show Created Date -->
               <?php
                   if ($params->get('show_date') == 1) { 
                    echo '<p class="createddate"><span class="ot_date">'; 
                    $date = $item->created_date;
                    echo JHTML::_('date', $date, $params->get( 'date_format' ));
                    echo '</span></p>'; 
                }
               ?>
               <!-- Show Content -->
                <div class="ot_content"><?php echo $item->content; ?></div>
                <!-- Show Readmore -->
                 <?php if($params->get('readmore') == 1) {?>
                <div class="ot_readmore"><a href="<?php echo $item->link; ?>" class="ot_readm"><?php echo JText::_('READMORE') ?></a></div>
                <?php }else {?>
                    <?php echo ''; ?>
                <?php } ?>
            </div>
        </div>
        <div class="spaces"></div>
        <?php endforeach; ?>

    </div>
</div>
<div class="ot-mini-news"><?php echo JText::_('ABOUT_OT_MINI_NEWS'); ?></div> 
```

仅使用 for each 来显示带有照片链接和描述的项目。

所以你可以看到我真的不知道在哪里添加分页代码，我怀疑他们甚至使用其中的一部分进行显示（我在 helper.php 文件中看到了一个 getlist 函数。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T09:19:11.133

[http://docs.joomla.org/Using_JPagination_in_your_component](http://docs.joomla.org/Using_JPagination_in_your_component)这是一个非常有用的文档——即使这是一个模块并且维基页面正在使用它作为一个组件。

```
$db =& JFactory::getDBO();
$lim    = $mainframe->getUserStateFromRequest("$option.limit", 'limit', 14, 'int'); //I guess getUserStateFromRequest is for session or different reasons
$lim0   = JRequest::getVar('limitstart', 0, '', 'int');
$db->setQuery('SELECT SQL_CALC_FOUND_ROWS x, y, z FROM jos_content WHERE x',$lim0, $lim);
$rL=&$db->loadAssocList();
if (empty($rL)) {$jAp->enqueueMessage($db->getErrorMsg(),'error'); return;}     
else {
////Here the beauty starts
$db->setQuery('SELECT FOUND_ROWS();');  //no reloading the query! Just asking for total without limit
jimport('joomla.html.pagination');
$pageNav = new JPagination( $db->loadResult(), $lim0, $lim );
foreach($rL as $r) {
//your display code here
}
echo $pageNav->getListFooter(  ); //Displays a nice footer 
```

您可以在他们的代码中看到，虽然他们确实使用了 db 结果，但分页并不“依赖”查询。只有来自它的结果。因此，`$db->loadResult()`例如，您可以使用 php count forumla 查看模块生成的数组中有多少行。在您的情况下，计算`$items`. foreach 命令仍然是你所拥有的。与`foreach($rL as $r)`刚才对应的只是现有的`foreach($items as $item)`。因此，您没有如您所见的数据库查询这一事实 - 实际上不应该成为问题！

所以你想要的代码将是这样的：

```
global $option; //If Joomla 1.5
global $mainframe; //If Joomla 2.5
$option = JRequest::getCmd('option') //If Joomla 2.5
$mainframe = JFactory::getApplication(); //If Joomla 2.5
$lim    = $mainframe->getUserStateFromRequest("$option.limit", 'limit', 14, 'int'); //I guess getUserStateFromRequest is for session or different reasons
$lim0   = JRequest::getVar('limitstart', 0, '', 'int');
if (empty($items)) {
    $app->enqueueMessage($db->getErrorMsg(),'error');
    return;
} else {
    jimport('joomla.html.pagination');
    $pageNav = new JPagination( count($list), $lim0, $lim );
    foreach($list as $item) {
     //wrap in your code here that you had in the foreach already
}
echo $pageNav->getListFooter(  ); //Displays a nice footer 
```

根据您使用的是 Joomla 1.5 还是 2.5，请确保删除前两行之一，但这*应该*可以。

# python - 使用 Flask 使用外部 XML API（带有模型等）

> ID：12717978
> 
> 赞同：3
> 
> 时间：2012-10-03T22:48:55.887
> 
> 标签：python, flask, jinja2

我将构建一个使用基于 XML 的 API 的 web 应用程序，并且我想使用 Flask 来制作它。

假设我将使用 SQLAlchemy 作为数据库并使用 FlaskWTF 之类的东西作为表单，我该如何开始以这种方式使用 Flask？我不确定从哪里开始。我听说`requests`Python 库是一个不错的选择，但我不知道如何将它与 db.model 或 Flask 的其他功能集成，因为我将构建一个类似 MVC 的应用程序。

我已经通读了这个，但它并没有真正帮助我，因为我不会使用本地数据库。[https://github.com/mitsuhiko/flask/wiki/Large-app-how-to](https://github.com/mitsuhiko/flask/wiki/Large-app-how-to)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T15:32:54.530

该`requests`库简化了发出 HTTP 请求的工作，但它并没有特别帮助您使用响应 XML。您可能更愿意使用[Suds](https://fedorahosted.org/suds/wiki/Documentation)、[PySimpleSOAP](http://code.google.com/p/pysimplesoap/)或[Flask-Enterprise](http://massive.immersedcode.org/2011/staging/projects/default/python/flask-enterprise/)来使用 SOAP 数据。同样，Flask 本身并不能帮助您专门使用 SOAP 服务，但 Flask 补充了其他用于使用 SOAP 的 Python 库。

首先编写和测试与 SOAP 数据源交互的函数。这些函数应该作为应用程序的数据模型，将 Python 对象与 SOAP 请求相互转换。我认为您不需要本地缓存或特定于应用程序的本地数据存储，因为您提到您不会使用本地数据库（尽管可以根据需要轻松添加这些数据库）。

正如 SQLAlchemy 将 SQL 的细节与应用程序的其余部分隔离开一样，您的 SOAP 支持的数据模型应该将您的应用程序的其余部分与 SOAP 细节隔离开。在这些数据模型上构建您的应用程序，依赖于大多数通用 Flask 示例中的原生 Python 对象。

# javascript - 如何在不离开页面的情况下在 Phonegap 中查看 iframe？

> ID：12717980
> 
> 赞同：1
> 
> 时间：2012-10-03T22:49:08.110
> 
> 标签：javascript, cordova, iframe

在 phonegap 中，我正在尝试将 iframe 连接到托管在域上的 webapp。该应用程序需要在运动时被禁用，因此 index.html 具有如果移动速度超过一定速度时会冻结页面的 javascript（IE，创建一个绝对 div 会阻止您触摸 iframe 内的任何内容）。但是，我似乎无法像普通浏览器那样进行 iframe。iframe 立即在浏览器窗口中打开，即使安装了 ChildBrowser，iframe 仍然与父视图分开，因此我用于冻结应用程序的 javascript 将不再适用。

有没有办法让 iframe 像我试图在 Phonegap 中那样工作？

# java - 使用 GAE 数据存储进行身份验证在实体用户上返回 null

> ID：12717984
> 
> 赞同：0
> 
> 时间：2012-10-03T22:49:54.823
> 
> 标签：java, google-app-engine, google-cloud-datastore

我正在尝试创建自己的身份验证。每次我尝试登录，并且在 GAE 数据存储中找不到用户名时，我都会遇到 INTERNAL_SERVER_ERROR。

它说：

```
java.lang.NullPointerException
at com.pawnsoftware.User.authenticate(User.java:16)
at com.pawnsoftware.UserLoginServlet.doPost(UserLoginServlet.java:24)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637) 
```

等等...

你如何避免出现这个错误？

错误在说：

```
if (user==null) {
    message = "Username not found.";
} 
```

验证用户：

```
public static String authenticate(String username, String password) {
    String message;
    Entity user = UserUtil.findUserEntity(username);
    String pass = user.getProperty("password").toString();
    if (user==null) {
        message = "Username not found.";
    } else if (user!=null && !password.equals(pass)) {
        message = "Password is incorrect.";
    } else if (user!=null && password.equals(pass)) {
        message = "Successfully logged in!";
    } else {
        message = "Sorry, cannot find the username and password.";
    } 
    return message;
} 
```

查找用户实体：

```
public static Entity findUserEntity (String username) {
    Key userKey = KeyFactory.createKey("User", username);
    try {
      return datastore.get(userKey);
    } catch (EntityNotFoundException e) {
      return null;
    }
} 
```

**认证更新：**

```
public static String authenticate(String username, String password) {
    String message;
    Entity user = UserUtil.findUserEntity(username);
    password = encrypt(password);
    String pass = "";   
        try {
            pass = user.getProperty("password").toString();
        } catch (NullPointerException e) {
            message = "Username not found.";
        }
    if (user==null) {
        message = "Username not found.";
    } else if (user!=null && !password.equals(pass)) {
        message = "Password is incorrect.";
    } else if (user!=null && password.equals(pass)) {
        message = "Successfully logged in!";
    } else {
        message = "Sorry, cannot find the username and password.";
    } 
    return message;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:52:03.840

如果 use 为 null，则此行将失败：

```
String pass = user.getProperty("password").toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:55:42.110

如果你得到 a`EntityNotFoundException`和 return ，你不会显示`null`。反过来，这可能导致`NullPointerException`变量a `user`：

```
user.getProperty("password").toString(); 
```

您可以在此处添加保护声明：

```
if (user != null) {
   pass = user.getProperty("password").toString();
} 
```

# pjax - 选择链接时pjax添加URL

> ID：12717986
> 
> 赞同：0
> 
> 时间：2012-10-03T22:50:02.093
> 
> 标签：pjax

当我单击第一个链接时，pjax 会触发正确的内容。但是，当我选择第二个链接时，pjax 会像这样“http://localhost.com/name/test1/name/test2/”添加到已经选择的链接，然后返回到索引页面。我猜是因为添加了第二个链接。我该如何解决这个问题？

```
 <li><a data-pjax='#content' href="name/test1/"> test1 </a></li>
 <li><a data-pjax='#content' href="name/test2/">  test2</a></li>
 <li><a data-pjax='#content' href="name/test3/">  test3 </a></li>

 <script type="text/javascript">
$(document).ready(function(){
     $(function(){

  $('a[data-pjax]').pjax({container:'#content',timeout:15000});
   });

  });
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T00:17:21.817

可能是因为您在链接中使用了相对路径，请尝试将其更改为：

```
 <li><a data-pjax='#content' href="/name/test1/"> test1 </a></li>
 <li><a data-pjax='#content' href="/name/test2/">  test2</a></li>
 <li><a data-pjax='#content' href="/name/test3/">  test3 </a></li> 
```

通过在属性`/`的开头添加。`href`

假设您从 开始`/`，当您单击第一个链接时，pjax 会将页面位置更改`windows.location`为`/name/test1/`. `name/test2/`页面上的链接`/name/test1/`意味着`/name/test1/`+ `name/test2/`=> `/name/test1/name/test2/`，因为它是相对路径。

# c++ - Windows 中的符号可见性

> ID：12717991
> 
> 赞同：3
> 
> 时间：2012-10-03T22:50:16.540
> 
> 标签：c++, windows, visual-c++, mingw

我在 linux 中进行了大量编程，我使用可见性属性来定义符号在共享对象中是可见还是隐藏。只是为了让事情更清楚：如果一个符号是可见的，它将可以从外部访问（有人与共享对象链接），如果它是隐藏的，它应该只在内部使用。

在 Windows 上，它似乎有点不同，它适用于导出（符号在此处在共享对象中定义，并且可以由与此链接的人访问）和导入（这里我与共享对象链接并且符号被导出那里）符号。但是我找不到告诉编译器不要导出符号的方法，因为它只能在此处使用，即如果有人与它链接，则会出现链接器错误。

我的问题是我是否可以将符号定义为“隐藏”（如在 linux 的 gcc 中）以及如何定义。此外，Windows 主题中的所有这些可见性对我来说有点模糊，我正在寻找一些进一步的阅读链接以更好地了解一切是如何工作的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T23:22:04.097

David Rodriguez 是正确的，在 MSVC 环境中，程序员通常通过特定于 MSVC 的[__declspec(dllexport)](http://msdn.microsoft.com/en-us/library/a90k134d%28v=vs.80%29.aspx)修饰符显式导出函数/类符号。未显式导出的符号不应显示在已编译 DLL 的符号表中（您可以使用/EXPORTS 选项使用 Visual Studio 命令行实用程序之一的[dumpbin](http://support.microsoft.com/kb/177429)进行验证）。导入该符号时使用 dllimport 是惯例，尽管我认为这是可选的。这通常是如何发挥作用的，定义 DLL 的公共接口的头文件将具有一些默认扩展为 __declspec(dllimport) 的宏，但在构建该库时设置为扩展为 __declspec(dllexport)。

请注意，GCC 和 MSVC 对待 dllexport 的方式可能不同；在隐藏未导出符号的意义上，也许 GCC 不“尊重” dllexport ？在尝试使用 GCC 之前，我会先尝试使用 MSVC 编译并使用 dumpbin 测试这些结果。如果您没有 Visual Studio，您仍然可以通过下载 VS Express 或（鲜为人知）通过下载命令行 MSVC 附带的某些 .NET 可再发行组件来获得 MSVC 编译器（这两个选项都是免费且合法的）。VS Express 在这里可能是更好的选择，因此您可以获得垃圾箱。

# css - 刷新网站时样式表未更新

> ID：12717993
> 
> 赞同：62
> 
> 时间：2012-10-03T22:50:28.363
> 
> 标签：css, stylesheet, browser-cache

我正在创建一个网站，但是当我对网站上的样式表进行更改并刷新网站时，没有任何更改。

我尝试使用查看源工具来检查它`stylesheet.css`并且它也没有更新。但是当我进入系统的根目录时，它就是。

我必须等待至少 20 分钟才能在我的网站上看到更新，谁能告诉我为什么我没有立即看到更改？我的浏览器、计算机或服务器有问题吗？

我还尝试删除我的 cookie、缓存和历史记录，但仍然无效。

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2012-10-04T00:00:44.513

如果您的网站还没有上线，而您只是想以您满意的时间间隔更新样式表，请使用：`Ctrl`+ `F5`。

在 Mac OS（在 Chrome 中）使用：`Cmd`+ `Shift`+ `R`。

这将强制您的浏览器重新加载并刷新与网站页面相关的所有资源。

因此，每当您更改样式表中的某些内容并想查看新结果时，请使用它。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2012-10-03T23:41:13.550

很可能该文件只是被服务器缓存。您可以禁用缓存（但记得在网站上线时启用它），或者修改`href`您的`link`标签，这样服务器就不会从缓存中加载它。

如果您的页面是由某种语言（如 php）动态创建的，您可以在值的末尾添加一些变量`href`，例如：

```
<link rel="stylesheet" type="text/css" href="css/yourStyles.css?<?php echo time(); ?>" /> 
```

这将在文件路径的末尾添加当前时间戳，因此它将始终是唯一的，并且永远不会从缓存中加载。

如果您的页面是静态的，则您必须自己管理这些变量，因此请使用以下内容：

```
<link rel="stylesheet" type="text/css" href="css/yourStyles.css?version=1" /> 
```

在对文件内容做了一些更改后，更改`version=1`为`version=2`等等。

[如果您希望从缓存 css 文件中禁用缓存，请参阅您的服务器类型文档（在 apache、IIS、nginx 等上的做法不同）或在https://serverfault.com/](https://serverfault.com/)上询问/搜索问题

假设 IIS - 在 <system.webServer> 下添加密钥并在根目录或相关文件夹中使用正确的设置就可以了。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <caching enabled="false" enableKernelCache="false" /> <!-- This one -->
    </system.webServer>
</configuration> 
```

也就是说，有时仍然需要回收应用程序池来“碰撞”CSS。因此：单独禁用 IIS 缓存并不是 100% 有保证的解决方案。

对于浏览器：有一些关于在[SuperUser上](https://superuser.com/questions/tagged/browser-cache "Superuser: browser-cache TAG")[细粒度控制 FF 上的本地缓存的](https://superuser.com/a/411826/128058 "如何在 Firefox 中强制刷新整页（不是从缓存中）")注释。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-10-03T22:54:22.113

查看文件是否被缓存的最简单方法是将查询字符串附加到`<link />`元素，以便浏览器重新加载它。

为此，您可以将样式表引用更改为类似

```
<link rel="stylesheet" type="text/css" href="/css/stylesheet.css?v=1" /> 
```

注意`v=1`部分。您可以在每次制作新版本时更新它以查看它是否确实被缓存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-27T04:58:10.873

这可能不是 OP 的问题，但我遇到了同样的问题，并通过刷新然后在我的 cpanel 上禁用 Supercache 来解决它。也许像我这样的其他新手不会知道许多托管服务提供商会缓存 CSS 和其他一些静态文件，并且这些缓存的旧版本的 CSS 文件会在您在服务器上编辑文件后在云中保留数小时。如果您的网站在您编辑旧版本的 CSS 文件后提供它们，并且您确定您已清除浏览器缓存，并且您不知道您的主机是否正在缓存内容，请在尝试其他任何内容之前先检查一下复杂的建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-03T17:27:18.737

我有一个类似的问题，只是因为更新速度很慢而变得更加令人恼火。在网站上工作以挽救我的生命时，我无法让我的更改生效（尝试各种方式清除我的浏览器缓存和 cookie），但如果我在当天晚些时候回到该网站或打开另一个浏览器，那里他们是。

我还通过在主机的 cpanel（Siteground）上禁用 Supercacher 软件解决了这个问题。您还可以在禁用之前对各个目录使用“刷新”按钮来测试是否是它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-13T18:34:30.997

如果它被缓存在服务器上，则您无法在浏览器中执行任何操作来解决此问题。您必须等待服务器重新加载文件。您甚至无法删除文件并重新上传。如果您使用像 Cloudflare 这样的缓存服务器，这可能需要更长的时间（它甚至可以在服务器重启后继续存在）。您可以重命名它并加载副本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-22T15:35:54.367

就我而言，由于我无法将缓存破坏时间戳附加到 css url，结果证明我必须手动刷新 IIS 7.5.7600 中的应用程序池。

追求所有其他途径，直到完全禁用站点和本地浏览器的缓存（就像完全禁用两者一样），仍然没有成功。“重新启动”该网站也无济于事。

和我一样的位置？ **[站点名称] > “应用程序池” > “回收”**是你最后的手段...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-24T09:51:27.777

这可能是您的服务器配置的结果，一些托管服务提供商在您的域上启用了[“Varnish” 。](https://varnish-cache.org/)这个缓存 HTTP 反向代理，用于[加速传递](https://varnish-cache.org/docs/4.0/tutorial/introduction.html)。可以尝试禁用 cpanel 上的清漆（假设你有一个）并检查是否是这样。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-11T05:28:12.747

作为参考，我正在 Windows 11 机器上开发，首先运行以下 2 个命令

$env:NODE_ENV="开发"

$env:TAILWIND_MODE="手表"

现在运行您的应用程序

供参考：[https ://github.com/tailwindlabs/tailwindcss/issues/4081](https://github.com/tailwindlabs/tailwindcss/issues/4081)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-30T19:17:44.267

我有同样的问题，我使用**000webhost**来托管我的网站，我也使用**cloudflare**。我已经从浏览器中禁用了所有缓存设置，然后尝试更改一些 css 并使用硬刷新
（shift + 单击刷新按钮、ctrl + f5 等）重新加载页面，**没有任何改变**。

事实证明，问题来自**cloudflare 缓存**。如果您使用的是 cloudflare，您可以在 cloudflare 中启用开发模式，它会暂时绕过您的缓存，让您可以实时查看源服务器的更改。

对于仍然遇到此问题的人，我希望这可以帮助您

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-01-26T16:23:40.083

![清除缓存] `Ctrl+Shift+Delete` [http://i.stack.imgur.com/QpqhJ.jpg](http://i.stack.imgur.com/QpqhJ.jpg) 有时需要硬刷新才能看到更新生效。但是一般的网络用户不太可能知道什么是硬刷新，你也不能指望他们继续刷新页面，直到事情理顺。这是一种方法：`<link rel="stylesheet" href="style.css?v=1.1">`

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-02-12T17:07:26.363

我也遇到了这个问题，很多人似乎建议强制重新加载您的页面，这在诸如您在服务器上运行它的情况下无法解决问题。**我相信这种情况下的最佳解决方案是给** **你的 css 加上时间戳**。

1.  这就是我在 Django 模板中的做法：

`<link rel="stylesheet" href="{% static 'home/radioStyles.css' %}?{% now 'U' %}" type="text/css"/>`

在哪里添加**?{% now 'U' %}**到你的 css 文件的末尾可以解决这个问题。

在哪里`?Wednesday 2nd February 2020 12PM`（当前日期）似乎可以解决问题，我也注意到只是把时间也解决了。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2019-11-12T11:03:21.397

我有同样的问题。原因之一是，我的应用程序被缓存并且我正在执行本地构建。

如果上述评论都不起作用，我宁愿删除 css 文件并重新添加它并进行更改。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2021-02-08T06:40:12.663

**首先**，尝试强制重装或*清除缓存*和*空追和硬重装*。您可以通过按**F12**然后右键单击它来执行此操作。

**第二种解决方案**：检查您的 HTML 基本标记。您可以从[这里](https://www.w3schools.com/tags/tag_base.asp)了解更多信息。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2015-02-03T08:49:27.263

不要更新 style.css 中的样式，而是创建自己的新样式表并导入 style.css

```
your-own-style.css
      .body{
           /*any updates*/
       } 
```

在 style.css 中导入 your-own-style.css

```
@import url("your-own-style.css"); 
```

# jquery - 表单验证正则表达式以摆脱小写字符

> ID：12717995
> 
> 赞同：1
> 
> 时间：2012-10-03T22:50:41.190
> 
> 标签：jquery, regex, webforms

在文本框中输入除小写字母以外的任何字符时尝试更改类。但是，我确信有一些愚蠢的小东西导致了这种情况，它没有显示“哟！”的 console.log。这是javascript：

```
$(function(){
    $("input[name='name']").keyup(function(){
        var str = $(this).val();
        var badChars = new RegExp("[^a-z]");
        if (str.indexOf(badChars)!=-1){
            console.log("yo!");
            $(this).removeClass("good");
            $(this).addClass("error");
        }
    });
}); 
```

我在搞砸什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T22:58:52.933

```
$(function() {
    // Don't need to create new RegExp object on each keyup event.
    // Just create it once:
    var badChars = new RegExp("[^a-z]");

    $("input[name='name']").keyup(function() {
        // Use RegExp.test() method to check 
        // is string matches the regular expression.
        if (badChars.test(this.value)) {
            console.log("yo!");
            $(this).removeClass("good")
                   .addClass("error");
        }
    });
}); 
```

[`RegExp.test()`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)

# scala - 在 playframework 2/scala 中上传多个大文件和其他表单数据

> ID：12717999
> 
> 赞同：3
> 
> 时间：2012-10-03T22:51:24.017
> 
> 标签：scala, file-upload, playframework, playframework-2.0, multipartform-data

我正在尝试使用 scala 在播放框架中上传多个大文件。我仍然是一个 scala 和玩菜鸟。

我[从这里得到了一些很棒的代码，](https://groups.google.com/forum/?fromgroups=#!msg/play-framework/dyolkIUU5t0/18HL2n7bdNIJ)它让我完成了 90% 的工作，但现在我又被卡住了。

我现在遇到的主要问题是我只能读取文件数据，而不能读取任何其他已上传的数据，并且在浏览播放文档之后，我不清楚如何从这里获取。任何建议表示赞赏！

```
 def directUpload(projectId: String) = Secured(parse.multipartFormData(myFilePartHandler)) { implicit request =>
    Ok("Done");
  }

def myFilePartHandler: BodyParsers.parse.Multipart.PartHandler[MultipartFormData.FilePart[Result]] = {
    parse.Multipart.handleFilePart {
      case parse.Multipart.FileInfo(partName, filename, contentType) =>
        println("Handling Streaming Upload:" + filename + "/" + partName + ", " + contentType);

        //Set up the PipedOutputStream here, give the input stream to a worker thread
        val pos: PipedOutputStream = new PipedOutputStream();
        val pis: PipedInputStream = new PipedInputStream(pos);
        val worker: UploadFileWorker = new UploadFileWorker(pis,contentType.get);
        worker.start();

        //Read content to the POS
        play.api.libs.iteratee.Iteratee.fold[Array[Byte], PipedOutputStream](pos) { (os, data) =>
          os.write(data)
          os
        }.mapDone { os =>
          os.close()
          worker.join()
          if( worker.success )
            Ok("uplaod done. Size: " + worker.size )
          else
            Status(503)("Upload Failed");
        }
    }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:49:13.250

您必须处理数据部分。正如您可以猜到（或在文档中查找）处理数据部分的函数称为：`handleFilePart`.

```
def myFilePartHandler: BodyParsers.parse.Multipart.PartHandler[MultipartFormData.FilePart[Result]] = {
   parse.Multipart.handleFilePart {
     // ...
   }
   parse.Multipart.handleFilePart {
     // ...
   }
} 
```

另一种方法是`handlePart`方法。查看文档以获取更多详细信息。