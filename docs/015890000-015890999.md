# StackOverflow 问答 15890000-15890999

# delphi - 如何让 Delphi XE2 中的 TWebBrowser 运行？

> ID：15890000
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:16:22.830
> 
> 标签：delphi, crash, delphi-xe2, twebbrowser

Delphi XE2 中的 TWebBrowser 组件似乎有严重的错误。我必须运行某种代码才能以某种特殊方式实例化它吗？

1.  创建新的 Delphi 项目
2.  将 TWebBrowser 组件拖放到窗体上。
3.  在 Form1.FormCreate() 调用 WebBrowser1.GoHome （谷歌）。

如果我编译这个 32 位并转到一些特定的网页，我会收到错误消息。谷歌（ncbi 核苷酸爆炸）并单击第一个链接。

如果我单击通常在新窗口中打开的链接，除了这些 javascript 错误之外，它还会在 IE（单独的应用程序）中打开。

64 位版本似乎更坏。通过访问同一站点（ncbi 核苷酸爆炸），由于“divide_by_zero”错误，我使整个程序崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:29:09.617

关于浮点异常，`TWebBrowser`期望在屏蔽浮点异常的情况下进行操作。看起来您正在使用 Delphi 默认浮点设置并且未屏蔽异常。我怀疑如果你掩盖异常，那么你的问题就会消失。

这样做：

```
SetExceptionMask(exAllArithmeticExceptions); 
```

正如其他人所说，您可以通过设置`Silent`来使 Javascript 弹出窗口静音`True`。

# r - 滚动连接：向前和向后滚动

> ID：15890004
> 
> 赞同：16
> 
> 时间：2013-04-08T22:16:34.253
> 
> 标签：r, data.table

`data.table`太棒了，因为我可以进行滚动连接，甚至可以*在组内*进行滚动连接！

```
library(data.table)
set.seed(42)
metrics <- data.frame(
  ID=c(rep(1, 10), rep(2,5), rep(3,5)),
  Time=c(1:10, 4:8, 8:12),
  val1=runif(20),
  val2=runif(20),
  val3=runif(20),
  val4=runif(20)
  )
metrics <- data.table(metrics[sample(1:nrow(metrics), 15),], key=c('ID', 'Time'))
calendar <- data.table(expand.grid(ID=1:3, Time=1:12), key=c('ID', 'Time'))

metrics[calendar,roll=TRUE] 
```

然而，这对我来说还不够棒。这`data.table`仍然有 NA：

```
> metrics[calendar,roll=TRUE]
    ID Time      val1      val2      val3        val4
 1:  1    1 0.9148060 0.9040314 0.3795592 0.675607275
 2:  1    2 0.9370754 0.1387102 0.4357716 0.982817198
 3:  1    3 0.9370754 0.1387102 0.4357716 0.982817198
 4:  1    4 0.8304476 0.9466682 0.9735399 0.566488424
 5:  1    5 0.8304476 0.9466682 0.9735399 0.566488424
 6:  1    6 0.5190959 0.5142118 0.9575766 0.189473935
 7:  1    7 0.7365883 0.3902035 0.8877549 0.271286615
 8:  1    8 0.7365883 0.3902035 0.8877549 0.271286615
 9:  1    9 0.6569923 0.4469696 0.9709666 0.693204820
10:  1   10 0.7050648 0.8360043 0.6188382 0.240544740
11:  1   11 0.7050648 0.8360043 0.6188382 0.240544740
12:  1   12 0.7050648 0.8360043 0.6188382 0.240544740
13:  2    1        NA        NA        NA          NA
14:  2    2        NA        NA        NA          NA
15:  2    3        NA        NA        NA          NA
16:  2    4 0.4577418 0.7375956 0.3334272 0.042988796
17:  2    5 0.7191123 0.8110551 0.3467482 0.140479094
18:  2    6 0.9346722 0.3881083 0.3984854 0.216385415
19:  2    7 0.2554288 0.6851697 0.7846928 0.479398564
20:  2    8 0.2554288 0.6851697 0.7846928 0.479398564
21:  2    9 0.2554288 0.6851697 0.7846928 0.479398564
22:  2   10 0.2554288 0.6851697 0.7846928 0.479398564
23:  2   11 0.2554288 0.6851697 0.7846928 0.479398564
24:  2   12 0.2554288 0.6851697 0.7846928 0.479398564
25:  3    1        NA        NA        NA          NA
26:  3    2        NA        NA        NA          NA
27:  3    3        NA        NA        NA          NA
28:  3    4        NA        NA        NA          NA
29:  3    5        NA        NA        NA          NA
30:  3    6        NA        NA        NA          NA
31:  3    7        NA        NA        NA          NA
32:  3    8 0.9400145 0.8329161 0.7487954 0.719355838
33:  3    9 0.9400145 0.8329161 0.7487954 0.719355838
34:  3   10 0.1174874 0.2076590 0.1712643 0.375489965
35:  3   11 0.4749971 0.9066014 0.2610880 0.514407708
36:  3   12 0.5603327 0.6117786 0.5144129 0.001570554
    ID Time      val1      val2      val3        val4 
```

`zoo:::na.locf`我可以使用,填充这些 NA `fromLast=TRUE`，但这不是很有趣。谁能想到一种优雅的方式，我可以在加入期间*向后*滚动 NA （在向前滚动之后）`data.table`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-08T22:24:29.697

这在2013 年 3 月发布的**data.table**版本 1.8.8 中是可能的：

```
metrics[calendar, roll=TRUE, rollends=c(TRUE, TRUE)] 
```

从[**data.table** NEWS 文件中](http://cran.r-project.org/web/packages/data.table/NEWS)：

> 除了 TRUE/FALSE，“roll”现在可以是正数（前滚/LOCF）或负数（后滚/NOCB）。有限的数字限制了值滚动的距离（有限的陈旧性）。roll=TRUE 和 roll=+Inf 是等价的。'rollends' 是一个新参数，包含两个逻辑。如果 rollends 的第一个值为 TRUE，则第一个观察值向后滚动。如果 rollends 的第二个值为 TRUE，则前滚最后一个观察值。如果 roll 是有限数，则同样的限制适用于两端。新值 roll='nearest' 当值落入间隙时连接到最近的值（向后或向前），并根据 'rollends' 连接到最终值。'rolltolast' 已被弃用。

与往常一样，要下载最新版本的**data.table**，请参阅[安装](https://github.com/Rdatatable/data.table/wiki/Installation)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-08T22:24:52.847

`metrics[calendar, roll = TRUE, rollends = c(TRUE, TRUE)]`

# compiler-construction - 未定义对 ruserok 错误的引用

> ID：15890007
> 
> 赞同：1
> 
> 时间：2013-04-08T22:16:46.513
> 
> 标签：compiler-construction, compiler-errors, arm, undefined-reference

我遇到了一个奇怪的“未定义引用”编译错误，我似乎找不到解决方案。我正在尝试使用 Yocto Project 生成的 ARM 编译器 (arm-poky-linux-gnueabi-gcc) 为我的 Gumstix Overo 配置/编译 PAM 1.1.6，但在编译过程中我不断收到以下错误：

```
.libs/pam_rhosts.o: In function `pam_sm_authenticate':
modules/pam_rhosts/pam_rhosts.c:117: undefined reference to `ruserok'
collect2: error: ld returned 1 exit status 
```

所以，我做了一些调查，发现在配置期间，编译并执行了以下测试代码，以确定 ruserok、ruserok_af 和 iruserok 的可用性。

```
/* end confdefs.h.  */
/* Define $2 to an innocuous variant, in case <limits.h> declares $2.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define $2 innocuous_$2

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char $2 (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef $2

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char $2 ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_$2 || defined __stub___$2
choke me
#endif

int
main ()
{
return $2 ();
  ;
  return 0;
} 
```

因此，我复制、粘贴（将所有 $2 替换为 ruserok）并使用生成的 GCC 编译器编译此代码

```
./arm-poky-linux-gnueabi-gcc -o test.o test.c 
```

查看 ruserok、ruserok_af 和 iuserok 函数是否存在，我收到以下编译错误：

```
/tmp/ccU8YszI.o: In function `main':
test.c:(.text+0x8): undefined reference to `ruserok'
collect2: error: ld returned 1 exit status 
```

其中，与上面的“未定义对 `ruserok' 的引用相同”错误。作为一个完整性检查，由于我之前通过 Ubuntu 软件中心安装了 Ubuntu/Linaro ARM GCC 编译器，所以我使用 arm-linux-gnueabi-gcc 编译器编译了相同的代码，但编译的代码没有任何错误。这是我用来参考的命令：

```
arm-linux-gnueabi-gcc -o test.o test.c 
```

## 所以，我的问题是：为什么一个编译器会产生“未定义的 ruserok 引用”错误，而另一个不会？或者换一种说法，两个编译器之间有什么区别，一个编译器会产生“未定义的 ruserok 引用”错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:01:50.610

编译器（尤其是`gcc`）不仅仅是代码生成器。他们非常熟悉**libc**或标准`C`库以及**libgcc**编译器帮助程序库。一般命令行隐式使用`-lc`（与**libc**链接）。`arm-linux-gnueabi-gcc`来自 Ubuntu 的是一个带有 eglibc 的 crosstool- ng*构建*。

我不知道[Poky gcc](http://marcin.juszkiewicz.com.pl/2008/07/17/using-poky-sdk-to-build-software/)是关于什么的。您可能会提供指向您从何处获得编译器的链接。从[Poky 配置链接](http://marcin.juszkiewicz.com.pl/2008/07/17/using-poky-sdk-to-build-software/)看来，编译器是一个多库发行版或其他东西，您可能需要执行其他步骤来配置*交叉构建*。

问题的答案，

> 为什么一个编译器会产生“未定义的 ruserok 引用”错误，而另一个不会？

因为一个`ruserok`在库中，而另一个没有（或未配置为查看它）。

# wordpress - WordPress TinyMCD 下载

> ID：15890011
> 
> 赞同：1
> 
> 时间：2013-04-08T22:17:16.310
> 
> 标签：wordpress, file-upload, tinymce

任何人都知道我可以下载 wordpress 使用的 TinyMCE 和图像上传器或至少类似的东西的地方吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T05:25:27.153

您可以使用此 url 下载插件。 [http://wordpress.org/extend/plugins/tinymce-advanced/](http://wordpress.org/extend/plugins/tinymce-advanced/)

# python - 带有模块导入的命名空间

> ID：15890014
> 
> 赞同：25
> 
> 时间：2013-04-08T22:17:28.740
> 
> 标签：python, import, module, namespaces, local

我正在学习 Python 并且仍然是初学者，尽管我已经学习了大约一年。我正在尝试编写一个在主模块中调用的函数模块。被调用模块中的每个函数都需要数学模块才能运行。我想知道是否有一种方法可以在不导入被调用模块中的数学模块的情况下做到这一点。这是我所拥有的：

`main.py`：

```
from math import *
import module1

def wow():

    print pi

wow()
module1.cool() 
```

`module1.py`：

```
def cool():

    print pi 
```

跑步时`main.py`我得到：

```
3.14159265359

Traceback (most recent call last):
  File "Z:\Python\main.py", line 10, in <module>
    module1.cool()
  File "Z:\Python\module1.py", line 3, in cool
    print pi
NameError: global name 'pi' is not defined 
```

我很难理解的是为什么我在运行时出现名称错误`main.py`。我知道该变量`pi`在导入时成为主模块的全局变量，因为`wow`可以访问它。我也知道这`cool`在导入时对主模块来说是全局的，因为我可以打印`module1.cool`和获取`<function cool at 0x02B11AF0>`. 所以既然`cool`在主模块的全局命名空间内，程序不应该先在函数内部查找`cool`变量`pi`，然后当它在那里找不到时，在`main`模块内部查找变量`pi`并在那里*找到它*？

我所知道的解决这个问题的唯一方法是在里面导入数学模块`module1.py`。我不喜欢这样的想法，因为它使事情变得更加复杂，而且我喜欢漂亮、简单的代码。我觉得我已经接近掌握命名空间了，但在这方面需要帮助。谢谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-08T22:28:55.160

正如回溯所示，问题不在于`main.py`，而在于`module1.py`：

```
Traceback (most recent call last):
  File "Z:\Python\main.py", line 10, in <module>
    module1.cool()
  File "Z:\Python\module1.py", line 3, in cool
    print pi
NameError: global name 'pi' is not defined 
```

换句话说，*in`module1`*没有全局名称`pi`，因为您还没有将它导入那里。当您执行`from math import *`in 时`main.py`，这只是将模块命名空间中的所有内容`math`导入`main`模块的命名空间，而不是导入*每个*模块的命名空间。

我认为您在这里缺少的关键是每个模块都有自己的“全局”命名空间。一开始这可能有点令人困惑，因为在像 C 这样的语言中，所有`extern`变量和函数共享一个全局命名空间。但是一旦你超越了这个假设，Python 的方式就很有意义了。

所以，如果你想使用`pi`from `module1`，你必须做`from math import *`in `module1.py`。（或者你可以找到其他方法来注入它——例如，`module1.py`can do`from main import *`或`main.py`could do`module1.pi = pi`等。或者你可以`pi`塞进魔法`builtins`/`__builtin__`模块，或者使用各种其他技巧。但显而易见的解决方案是在你需要的`import`地方做想要进口。）

* * *

`from foo import *`附带说明一下，除了交互式解释器或偶尔的顶级脚本之外，您通常不想做任何事情。也有例外（例如，一些模块被明确设计为以这种方式使用），但经验法则是要么`import foo`使用受限的`from foo import bar, baz`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-08T22:21:11.560

“显式优于隐式”是 Python 的创建者做出的设计决策（启动 python 并运行`import this`）。

因此，当你运行时`module1.cool()`，Python 不会`pi`在`main`模块中查找 undefined。

* * *

每当您想使用数学模块时，您都必须显式地导入它——这就是 Python 的工作原理。

此外，您应该避免`from X import *`-style 导入，这也是不好的做法。在这里，你可以这样做：`from math import pi`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-08T22:33:25.463

正如其他人所说，`pi`您的`module1`. 对您来说一个很好的解决方案是，它只导入`pi`一次，`math`并*明确*确保`pi`您得到的是 from `module1`：

`main.py`：

```
import module1

def wow():
    print module1.pi

wow()
module1.cool() 
```

`module1.py`：

```
from math import pi

def cool():
    print pi 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-11T07:55:07.560

`exec`@abarnert 的评论中提到的(python 3) 或(python 2)的简单方法`execfile`可能对某些工作流程有用。所需要的只是将导入行替换为：

```
exec( open("module1.py").read() )       # python 3 
```

然后你可以简单地用`cool()`而不是调用函数`module1.cool()`。在 内`cool()`，变量的`pi`行为就像 OP 最初预期的那样是全局的。

简而言之，这只是隐藏了一个函数定义，否则它会出现在主程序的顶部，并且既有优点也有缺点。对于具有多个模块和导入的大型项目，使用`exec`（而不是适当的命名空间）可能是一个错误，因为您通常不希望在单个全局命名空间中保留太多东西。

但是对于简单的情况（例如使用 Python 作为 shell 脚本）`exec`，您可以使用一种简单明了的方式来隐藏共享函数，同时让它们共享全局命名空间。请注意，在这种情况下，您可能需要额外考虑如何命名您的函数（例如，使用`v1_cool`和`v2_cool`跟踪不同的版本，因为您不能这样做`v1.cool`）`v2.cool`。

在这里使用的一个不太明显的缺点`exec`是执行代码中的错误可能不会显示错误的行号，尽管您可以解决这个问题： [how to get the line number of an error from exec or execfile in Python](https://stackoverflow.com/questions/28836078/how-to-get-the-line-number-of-an-error-from-exec-or-execfile-in-python)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-08T22:24:52.860

在模块内部，您可以简单地定义`from math import pi`，它只会从 math 中导入 pi 而不是整个 math 模块。

# email - “需要对象”发送电子邮件

> ID：15890015
> 
> 赞同：0
> 
> 时间：2013-04-08T22:17:33.840
> 
> 标签：email, ms-access, runtime-error

我正在尝试创建一个功能，以便它将电子邮件发送到我的一个查询（即将到来的生日）中的电子邮件地址。我将这段代码放在一个函数中，然后放在一个宏 autoexec 中，以便在我加载数据库时运行。

```
Public Function EmailSend()
Dim imsg As Object
Dim iconf As Object
Dim flds As Object
Dim schema As String

Set imsg = CreateObject("CDO.Message")
Set iconf = CreateObject("CDO.Configuration")
Set flds = iconf.Fields

schema = "http://schemas.microsoft.com/cdo/configuration/"
flds.Item(schema & "sendusing") = cdoSendUsingPort
flds.Item(schema & "smtpserver") = "smtp.live.com"
flds.Item(schema & "smtpserverport") = 25
flds.Item(schema & "smtpauthenticate") = cdoBasic
flds.Item(schema & "sendusername") = "MyEmail@hotmail.com"
flds.Item(schema & "sendpassword") = "MyPassword"
flds.Item(schema & "smtpusessl") = False
flds.Update

With imsg
    Call EmailSend(UpcomingBirthday.[Email], "MyEmail@hotmail.com", "Birthday Promotion!", "<html>Happy Birthday! <p> Our records indicate that you're eligible for a birthday promotion.</p></html.")
    Set .Configuration = iconf
    .Send
End With

Set iconf = Nothing
Set imsg = Nothing
Set flds = Nothing
 End Function 
```

现在，当我尝试运行此代码时，它会告诉我“**运行时错误 424 - 需要对象**”，并在我转到 Debug 时突出显示这一行：*Call EmailSend(UpcomingBirthday.[Email], "MyEmail@hotmail.com", "生日促销！”*等等。所以我需要它做的是查询“即将到来的生日”中“电子邮件”列中的值，然后向他们发送电子邮件。

如果有人可以通过告诉我需要做什么来解决此错误来帮助我，那就太好了！另外，如果您可以扫描代码并查看它是否正常（就像它应该工作一样）？谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:00:58.947

The `Call EmailSend` statement within `Public Function EmailSend` is clearly problematic. If you want to assign values to the properties of `imsg` (a `CDO.Message` object) then just do something like

```
With imsg
    .To = "recipient@example.com"
    .From = "MyEmail@hotmail.com"
    .Subject = "Birthday Promotion!"
    '' and so on
    .Send
End With 
```

Also, we don't know what `UpcomingBirthday` really is because it is defined elsewhere.

You might want to save yourself some bother and just use the `SendEmail` function available for download here:

[http://www.cpearson.com/excel/Email.aspx](http://www.cpearson.com/excel/Email.aspx)

# registry - XP中系统注册表的句柄数量是否有限制？

> ID：15890018
> 
> 赞同：0
> 
> 时间：2013-04-08T22:18:06.003
> 
> 标签：registry, windows-xp, filehandle

很少，我的应用程序实例之一将无法在注册表中找到已注册的类/dll。我怀疑这可能是由于未能读取注册表。Windows XP 是否对注册表的活动文件句柄数量施加了限制？这是绝对句柄限制之外的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:33:09.883

是的，所有句柄都有上限。但它完全超出了你应该达到的想象范围。多个运行的应用程序当然有足够的空间来同时打开多个注册表句柄。

达到这种限制的唯一方法是，如果您在使用完把手后没有正确*关闭把手，从而导致泄漏。*确保[`RegCloseKey`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724837.aspx)为打开的每个句柄调用该函数。

# google-app-engine - 谷歌应用引擎 CNAME 重定向

> ID：15890023
> 
> 赞同：2
> 
> 时间：2013-04-08T22:18:36.513
> 
> 标签：google-app-engine

我有一个在 GAE 上运行的应用程序。我想使用自定义 URL，并按照 google 上的说明配置了 cname。但是即使 cname 查找工作正常，最终也会出现 SSL 错误。我想知道是否需要在 GAE 端启用任何特殊设置？

*

```
Find the CNAME settings and enter the following as the CNAME value or alias: 
status
Set the CNAME destination to the following address: 
ghs.googlehosted.com 
```

*

我得到的具体错误是：错误 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL 协议错误。

# java - 我不知道如何从 EditText 获取输入以传递给另一个文件

> ID：15890027
> 
> 赞同：0
> 
> 时间：2013-04-08T22:18:52.430
> 
> 标签：java, android, android-intent, android-edittext

我有一个用户在 EditText 框中输入信息，例如 UPC，然后单击它旁边的按钮。当他们单击按钮时，如何从框中获取文本以传递给我的其他活动？我假设我使用 Intent 来启动活动。

编辑文本元素：

```
<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView1"
    android:cursorVisible="true"
    android:ems="10"
    android:inputType="text" /> 
```

搜索按钮代码：

```
<Button
    android:id="@+id/button2"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/editText1"
    android:layout_below="@+id/textView1"
    android:layout_toRightOf="@+id/textView1"
    android:onClick="onClickSearch"
    android:text="@string/search" /> 
```

main.java 中的代码：

```
public void onClickSearch(View view) { 

        String UPC = R.id.editText1.getText().toString();
        Intent intent = new Intent("net.example.glutefree.Networking");   
        intent.putExtra("UPCA", UPC);  //text is some key used to retrieve value in NextActivity 
        startActivity(intent);
    } 
```

如果您需要更多代码，请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:21:10.380

你假设正确。这基本上就是你如何做到这一点，具体取决于你拥有和需要什么。但你真的应该阅读[这里](http://developer.android.com/reference/android/content/Intent.html)

```
String et = editText.getText().toString();
Intent intent = new Intent(CurrentActivity.this, NextActivity.class);   
intent.putExtra("text", et);  //text is some key used to retrieve value in NextActivity 
startActivity(intent); 
```

`R.id.editText1`返回一个`int`，这是您的错误的原因。尝试这样的事情

```
@Override
public void onCreate(Bundle savedInstanceState)
{
     super.onCreate(savedInstanceState);
     setContentView(R.layout.name_of_your_layout);
     EditText editText = (EditText) findViewById(R.id.editText1);
} 
```

然后使用我最初提供的代码。您必须`inflate`使用然后`layout`创建`setContentView()`一个变量，`editText`在这里，您可能希望在类级别声明它。然后将其初始化为`id`您在 xml 中设置的值。`getText()`您拥有它的方式`int`是，您试图调用`R.id.some_id`. 一旦有了变量并将其转换为`EditText`with `(EditText) findViewById(R.id.editText1);`，您就可以调用`getText()`该变量。

另请注意，`setContentView()`在尝试访问该 xml 中的 a 之前，您必须像我所展示的那样调用，否则当您尝试使用从 xml 创建的变量时，`View`您将得到 a ，因为此处存在于`NPE``View``EditText``layout`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:45:16.190

好的，所以你有了一个良好的开端，重要的部分是：

1) 在活动代码中获取对 EditText 对象的引用：

```
private EditText mMyEditText; 
```

应该在 onCreate 期间像这样初始化：

```
mMyEditText = (EditText) findViewById(R.id.editText1); 
```

2）处理点击：

```
public void onClickSearch(View view) { 

    //String UPC = R.id.editText1.getText().toString(); 
    String UPC = mMyEditText.getText().toString();
    //Intent intent = new Intent("net.example.glutefree.Networking");   
    Intent intent = new Intent(this, YourOtherClass.class);
    intent.putExtra("UPCA", UPC);  //text is some key used to retrieve value in NextActivity 
    startActivity(intent);
} 
```

不同之处在于您调用`getText`了一个标识符：**R.id.editText1**，它是一个`int`，现在，您将访问一个 的实际实例`EditText`。

# jquery - 无法获取父跨度的 html()

> ID：15890028
> 
> 赞同：0
> 
> 时间：2013-04-08T22:18:59.270
> 
> 标签：jquery

我正在尝试做一件简单的事情，也许我错过了一些东西：

```
var span = $(document.createElement("span")); // Create a span
var img = new Image(); // Create an image and set source
img.src = config.graph_url + member.facebook_id + "/picture?width=24&height=24";
span.append($(img)); // Add the image inside the span 
```

我怎样才能得到 html `<span><img src="_SOURCE_"/></span>`？`span.html()`输出`<img src="_SOURCE_"/>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:20:56.157

它工作正常。[html()](http://api.jquery.com/html/)方法设置或返回被选元素的内容（innerHTML）

> 在 HTML 文档中，.html() 可用于获取任何元素的内容。如果选择器表达式匹配多个元素，则只有第一个匹配项才会返回其 HTML 内容。

所以你可以为此使用[.outerHTML](https://developer.mozilla.org/en-US/docs/DOM/element.outerHTML)

```
$('span')[0].outerHTML; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:24:37.537

如果你想要这个 `<span><img src="_SOURCE_"/></span>`

尝试这样的事情

```
$('span')[0].outerHTML; 
```

# delphi - Delphi在异常后获取堆栈跟踪

> ID：15890029
> 
> 赞同：11
> 
> 时间：2013-04-08T22:18:59.583
> 
> 标签：delphi, exception, stack-trace

我试图弄清楚在 Delphi 中引发异常后如何获取堆栈跟踪。但是，当我尝试使用下面的函数读取 Application.OnException 事件中的堆栈时，堆栈似乎已被刷新并被抛出过程替换。

```
function GetStackReport: AnsiString;
var
    retaddr, walker: ^pointer;
begin

    // ...

    // History of stack, ignore esp frame
    asm
        mov walker, ebp
    end;

    // assume return address is present above ebp
    while Cardinal(walker^) <> 0 do begin
        retaddr := walker;
        Inc(retaddr);
        result := result + AddressInfo(Cardinal(retaddr^));
        walker := walker^;
    end;
end; 
```

这是我得到的结果：

```
001A63E3: TApplication.HandleException (Forms)
00129072: StdWndProc (Classes)
001A60B0: TApplication.ProcessMessage (Forms) 
```

这显然不是我想要的，尽管它是正确的。我想检索堆栈，因为它就在抛出异常之前，或者换句话说，在 OnException 调用之前（之后也可以）的内容。

**有没有办法做到这一点？**

我知道我正在重新发明轮子，因为 madExcept/Eurekalog/jclDebug 的人已经这样做了，但我想知道它是如何完成的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-08T23:27:25.770

无法从`OnException`事件内部手动获取可行的堆栈跟踪。正如您已经注意到的，错误发生时的堆栈在触发事件时已经消失。您要查找的内容需要在引发异常时获取堆栈跟踪。第三方异常记录器，如 MadExcept、EurekaLog 等，通过挂钩 RTL 本身内部的关键函数和核心异常处理程序来为您处理这些细节。

在最近的 Delphi 版本中，`SysUtils.Exception`该类现在确实具有公共`StackTrace`和`StackInfo`属性，这在事件中将很有用，`OnException`除了 Embarcadero 出于未知原因选择不本地实现这些属性的事实。它需要第三方异常记录器将处理程序分配给`Exception`类公开的各种回调，以生成属性的堆栈跟踪数据。但是，例如，如果您安装了 JclDebug，那么您可以在自己的代码中提供自己的回调处理程序，使用 JCL 的堆栈跟踪函数来生成属性的堆栈数据。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-08T22:36:52.270

> 我想检索堆栈，因为它就在抛出异常之前，或者换句话说，在 OnException 调用之前（之后也可以）的内容。

实际上，您不希望 OnException 调用之前的堆栈。这就是你已经得到的。您希望堆栈位于引发异常的位置。这需要在加注后尽快进行堆栈跟踪。OnException 调用为时已晚，因为异常已经传播到顶级处理程序。

madExcept 通过挂钩所有处理异常的 RTL 函数来工作。它挂钩了最低级别的功能。这需要一些认真的努力才能实现。使用这些例程，代码可以捕获堆栈跟踪等。请注意，挂钩是特定于版本的，需要对 RTL 进行逆向工程。

更重要的是，堆栈遍历比您的基本代码高级得多。我并不是说贬义，只是在 x86 上的堆栈行走是一件棘手的事情，而且 madExcept 代码经过了很好的磨练。

这是基本的想法。如果您想了解更多信息，您可以免费获得 JclDebug 的源代码。或者购买 madExcept 并获取其来源。

# php - 在 php/mysql 中检查两个用户是否是朋友

> ID：15890035
> 
> 赞同：0
> 
> 时间：2013-04-08T22:19:31.870
> 
> 标签：php, mysql

我在问之前已经搜索过，之前的热门答案对我的项目没有帮助

表结构

**用户表**

用户名 | 用户名

```
1|user1
2|user2
3|user3
4|user4
5|user5
6|user6 
```

**朋友桌**

请求用户名 | 目标用户ID

```
1|3
1|4
1|6
3|2
3|5
2|4
2|1 
```

现在好了，我的问题是：

如果用户 ID **1与用户 ID** **2**有关系，我只存储在**用户**表中，如：

```
1|2 
```

并且不存储重复的

```
1|2
2|1 
```

现在我需要检查 user-x 是 user-y 的朋友，如果两个是朋友 php 将返回 true，否则返回 false。如果我的数据库存储了重复的 1|2 和 2|1，则很有可能，但没有:(

如何处理一个查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:23:46.120

您可以使用`OR`.

`SELECT 1 FROM friends WHERE (requestuserid = :id1 AND targetuserid = :id2) OR (requestuserid = :id2 AND targetuserid = :id1)`

此查询将在失败时返回空集，在成功时返回 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:24:13.267

如果用户是朋友，此查询将返回一行（`OR`用于忽略目标/请求用户是谁），如果他们不是朋友，则不返回任何内容：

```
SELECT * FROM users u1, users u2, friends f
WHERE u1.userid = ?u1 AND u2.userid=?u2
AND ((u1.userid=f.requestuserid AND u2.userid=f.targetuserid)
OR (u2.userid=f.requestuserid AND u1.userid=f.targetuserid)) 
```

# java - 如何使一个组成为可选的，它捕获一个模式并捕获相同的组号？

> ID：15890038
> 
> 赞同：0
> 
> 时间：2013-04-08T22:19:44.450
> 
> 标签：java, regex

```
Pattern pattern = Pattern.compile("\\d{4}\\s+[a-z|A-Z]{2}\\s+PLAIN\\sTEXT\\s+(.*?)\\(NS\\)");
Matcher matcher = pattern.matcher("2007 AL PLAIN TEXT ap2345 (NS)");
while (matcher.find()) 
{
    System.out.println(matcher.group(1));
} 
```

我希望它适用`input1 = 2007 AL PLAIN TEXT ap2345 (NS)`（上面的正则表达式确实适用于此）但它失败了`input2 = "ap2345"`. 我想在同一个组号中捕获这两个字符串，这意味着我需要将之前的捕获设为可选。我怎样才能做到这一点？

编辑::: 当字符串值为`2007 AL PLAIN TEXT ap2345 (NS)`OR时，我希望相同的组号适用于两者`ap2345`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:47:41.180

我不确定我是否正确理解了您的问题，所以在我解释任何内容之前，只需检查此正则表达式

```
(\\d{4}\\s+[a-zA-Z]{2}\\s+PLAIN\\sTEXT\\s+)?(\\w+)(\\s+\\(NS\\))? 
```

喜欢

```
Pattern pattern = Pattern
        .compile("(\\d{4}\\s+[a-zA-Z]{2}\\s+PLAIN\\sTEXT\\s+)?(\\w+)(\\s+\\(NS\\))?");
Matcher matcher = pattern.matcher("2007 AL PLAIN TEXT ap2345 (NS)");
while (matcher.find()) {
    System.out.println(matcher.group(2));
} 
```

* * *

输出示例 1 `2007 AL PLAIN TEXT ap2345 (NS)`->`ap2345`

输出示例`ap2345`2 ->`ap2345`

* * *

此正则表达式将尝试将可选部分存储`2007 AL PLAIN TEXT`在组**1**中。如果字符串不包含此部分组 1 将包含`null`. 没关系，因为我们只对将存储在组**2**中的部分感兴趣。我假设第 2 组将只包含一个单词，这就是我使用的原因`\\w+`（`\\w`匹配字母、数字和`_`）。如果您想接受更多单词，请尝试使用`(.+?)(\\s+\\(NS\\)|$)`。

# jquery - jQuery的getScript函数，等待检索到的变量

> ID：15890039
> 
> 赞同：0
> 
> 时间：2013-04-08T22:19:50.607
> 
> 标签：jquery

我有一个 jQuery getScript 函数：

```
jQuery.getScript(script,function() {
    src = an_ajax_request;
}); 
```

问题是，我需要在函数之外使用这个变量来创建一个字符串：

```
if(src == "") string = "string"+src;
//I always get an empty src value here! 
```

但是如果 getScript 函数需要更长的时间来加载（加载异步），我会在控制台中获取 src 值，但是当我尝试构建字符串时 src 仍然是空的。

**问题：如何让字符串生成等待 src 值被 getScript 函数检索？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:49:53.233

在你的 ajax 请求中，做这样的事情。

```
$.ajax({
  url: "getSrc",
  success: function(src){
   string = "string"+src;
  }
}); 
```

# javascript - 将 JSON 文档格式化为可视化所需的规范

> ID：15890042
> 
> 赞同：0
> 
> 时间：2013-04-08T22:20:00.503
> 
> 标签：javascript, jquery, ajax, json

我正在尝试根据 Elastic Search 中的数据创建 Google Chart。JSON 文档需要采用以下格式：

```
 {
    "cols": [
        {"id":"","label":"Lane","type":"string"},
        {"id":"","label":"Routes","type":"number"}
      ],
    "rows": [
        {"c":[{"v":"M01"},{"v":4657}]},
        {"c":[{"v":"M02"},{"v":4419}]},
        {"c":[{"v":"M03"},{"v":4611}]},
        {"c":[{"v":"M04"},{"v":4326}]},
        {"c":[{"v":"M05"},{"v":4337}]},
        {"c":[{"v":"M06"},{"v":5363}]}
      ]
    } 
```

我的查询（通过 ajax 命令）返回以下数据：

```
 $ curl http://localhost:9200/wcs/routes/_search?pretty=true -d '{"query_all":{}}}'
    {
      "took" : 2,
    "timed_out" : false,
    "_shards" : {
    "total" : 5,
    "successful" : 5,
    "failed" : 0
    },
    "hits" : {
    "total" : 7,
    "max_score" : 1.0,
    "hits" : [ {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "4",
      "_score" : 1.0, "_source" : {"lane":"M04","routes":"102"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "5",
      "_score" : 1.0, "_source" : {"lane":"M03","routes":"143"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "1",
      "_score" : 1.0, "_source" : {"lane":"M07","routes":"80"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "6",
      "_score" : 1.0, "_source" : {"lane":"M02","routes":"157"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "2",
      "_score" : 1.0, "_source" : {"lane":"M06","routes":"101"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "7",
      "_score" : 1.0, "_source" : {"lane":"M01","routes":"105"}
    }, {
      "_index" : "wcs",
      "_type" : "routes",
      "_id" : "3",
      "_score" : 1.0, "_source" : {"lane":"M05","routes":"160"}
    } ]
    }
    } 
```

我试图运行的 HTML/JS（目前什么都不返回）如下。有人可以提供一些关于我可能做错了什么的见解吗？这将不胜感激。

```
 <html>
    <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">

     google.load('visualization', '1', {'packages':['corechart']});

     google.setOnLoadCallback(drawChart);

    function drawChart() {
      var jsonData = $.ajax({
             url: 'http://localhost:9200/wcs/routes/_search?pretty=true'
               , type: 'POST'
               , data :
                  JSON.stringify(
                  {
                    "query" : { "match_all" : {} }
                })
               , dataType : 'json'
          async: false
          });

     var json = JSON.parse(jsonData);
     var jdata = '{ "cols": [{"id":"", "label":"lane",  "type": "string"},' + '{"id": "", "label": "routes", "type": "number"}],' + '"rows":[{"c": [{"v":' + json.hits[0].hits[0]._source.lane + '},{"v":' + json.hits[0].hits[0]._source.routes + '}]}]';

     var data = new google.visualization.DataTable(jdata);

      var chart = new google.visualization.PieChart(document.getElementById('piechart_div'));
     chart.draw(data, {is3D: true, title: 'Multi Routes per Lane', width: 600, height: 440});
    }
    </script>
</head>
<body>
    <input type="button" onclick = "drawChart()" value="test">
    <div id="piechart_div"> </div>
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T14:50:53.067

在 ajax 调用中添加成功处理程序。同样正如 Felix King 指出的那样， google.visualization.DataTable 需要一个 JavaScript 对象 - 而不是字符串

所以移动所有这些代码

```
var jdata = '{ "cols": [{"id":"", "label":"lane",  "type": "string"},' + '{"id": "", "label": "routes", "type": "number"}],' + '"rows":[{"c": [{"v":' + json.hits[0].hits[0]._source.lane + '},{"v":' + json.hits[0].hits[0]._source.routes + '}]}]';
var data = new google.visualization.DataTable(jdata);
var chart = new google.visualization.PieChart(document.getElementById('piechart_div'));
chart.draw(data, {is3D: true, title: 'Multi Routes per Lane', width: 600, height: 440}); 
```

进入成功处理程序

```
$.ajax({
     url: 'http://localhost:9200/wcs/routes/_search?pretty=true'
   , type: 'POST'
   , data :
          JSON.stringify(
              {
                "query" : { "match_all" : {} }
            })
   , dataType : 'json'
   , success : function (json){ // <-- json = javascript object since you set dataType to 'json'
       // your object to pass to DataTable
       var jdata = {
          "cols": [{
              "id": "",
              "label": "lane",
              "type": "string"
          }, {
              "id": "",
              "label": "routes",
              "type": "number"
          }],
          "rows": [{
                "c": [{
                    "v": json.hits[0].hits[0]._source.lane
                }, {
                    "v": json.hits[0].hits[0]._source.routes
                }]
          }]
      };

      var data = new google.visualization.DataTable(jdata);

      var chart = new google.visualization.PieChart(document.getElementById('piechart_div'));
      chart.draw(data, {is3D: true, title: 'Multi Routes per Lane', width: 600, height: 440});
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T16:28:16.097

能够使用以下代码执行此操作（感谢 dinjas）：

```
 var json;
    $.ajax({
            url: 'http://localhost:9200/wcs/routes/_search',
            type: 'POST',
            data :
                JSON.stringify(
                    {
                        "query" : { "match_all" : {} }
                    }),
            dataType : 'json',
            async: false,
            success: function(data){
                json = data;
            }
        })

var jdata = {};
jdata.cols = [
    {
        "id": "",
        "label": "Lane",
        "type": "string"
    },
    {
        "id": "",
        "label": "Routes",
        "type":"number"
    }
];
jdata.rows = [
    {
        "c": [
            {
                "v": json.hits.hits[0]._source.lane
            },
            {
                "v": json.hits.hits[0]._source.routes
            }
        ]
    }
]; 
```

# java - 神秘的蚂蚁脚本

> ID：15890045
> 
> 赞同：0
> 
> 时间：2013-04-08T22:20:19.150
> 
> 标签：java, ant

我的 Ant 脚本有问题。我必须在`ant run`.

我当前的脚本如下所示：

```
<property name="src" location="src"/>
<property name="build" location="build"/>
<property name="doc" location="doc"/>
<property name="dist" location="dest"/>
<property name="lib" location="lib"/>
<property name="app" value="${ant.project.name}.jar"/>

<presetdef name="javac">
    <javac includeantruntime="false"/>
</presetdef>

<target name="clean">
    <delete dir="${build}"/>
    <delete dir="${dist}"/>
</target>

<target name="compile" depends="clean" description="Compile">
    <mkdir dir="${build}"/>
    <javac srcdir="${src}"
           destdir="${build}" 
           classpath="${lib}/junit-4.10.jar:${lib}/swing-layout-1.0.4.jar:${src}">
    </javac>
    <copy todir="${build}/checkers">
        <fileset dir="${lib}">
            <include name="resources/**" />
        </fileset>
    </copy>
</target>
<target name="run" depends="compile">
    <echo>Running the junit tests...</echo>
    <junit showoutput="no" fork="no">
        <classpath>
            <pathelement location="${build}"/>   
            <pathelement path="${build}:${lib}/junit-4.10.jar"/>
        </classpath>
        <formatter type="plain" usefile="false" />
        <test name="checkers.CheckersTest"/>
    </junit>
</target> 
```

在我的 Linux 机器上，测试运行良好，一切看起来都很好。但是在我的 Windows 上，Ant 给了我很好的：

```
java.lang.NoClassDefFoundError: junit/framework/TestListener 
```

然而，处于调试模式的 Ant 告诉我他从提供的 junit-4.10.jar 文件中加载了 TestListener.class。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T04:53:45.107

试试这个答案[http://youtrack.jetbrains.com/issue/TW-4882](http://youtrack.jetbrains.com/issue/TW-4882)：

```
To fix the problem you should either use fork="true" attribute for 
junit task (in this case classpath will be created correctly), or 
to copy junit.jar to ANT_HOME/lib (to ensure correct class loading). 
```

这也是此[https://bugs.eclipse.org/bugs/show_bug.cgi?id=36198](https://bugs.eclipse.org/bugs/show_bug.cgi?id=36198)的错误。最后评论说`JUnit is available in Ant via the org.eclipse.ant.optional.junit fragment`

# git - 如何删除已删除的 git 子树文件夹的历史记录？

> ID：15890047
> 
> 赞同：4
> 
> 时间：2013-04-08T22:20:22.503
> 
> 标签：git, git-commit, git-subtree

我使用 git-subtree 添加了一个 git 存储库。问题是我在使用 git-subtree 添加存储库之前进行了硬重置。现在提交历史仍然在存储库中，但它与主服务器断开连接。

知道如何删除它吗？我试过 git rm --cached 没有运气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-09T09:05:48.557

要立即删除已经无法访问的提交，这将是您的子树提交的情况，您可以使用以下命令：

```
git reflog expire --all --expire-unreachable=0
git repack -A -d
git prune 
```

`git gc`不会立即收集无法访问的提交，因为这些（在默认配置中）需要首先过期，然后才不会与其他可访问的提交打包。这会在一段时间后自行发生，或者您可以使用上面的命令强制它。

还要考虑到对子树提交的任何引用都会阻止它们被收集，这包括分支、标签和 reflog 引用。确保您确实没有对这些提交的悬空引用。

这里还有一个关于如何处理无法访问的提交的更详细的问题：

[垃圾收集在 git 中的提交](https://stackoverflow.com/questions/14991916/garbage-collect-commits-in-git)

# javascript - 带有 JavaScript 的 CSS - 无法读取属性“未定义”错误

> ID：15890048
> 
> 赞同：1
> 
> 时间：2013-04-08T22:20:28.973
> 
> 标签：javascript

我试图更改选择列表标题、标题和文本的颜色。我添加了功能`changehead()`，`changetitle()`并`changebody()`做到了这一点。并通过唯一id绑定元素。

但我收到以下错误

> `Uncaught TypeError: Cannot read property 'undefined' of undefined`

在函数`changehead()`中，之后

```
header = document.form1.heading.options[i].value; 
```

并在之后的函数`changetitle()`中

```
header = document.form1.heading.options[i].value; 
```

我不确定我是否应该使用两种不同的功能，或者是否可以使用一种来完成。

**代码：**

```
<script>
    function changehead() {
        i = document.form1.heading.selectedIndex;
        header = document.form1.heading.options[i].value;
        document.getElementById("head1").style.color = header;
    }

    function changetitle() {
        i = document.form1.heading.selectedIndex;
        header = document.form1.heading.options[i].value;
        document.getElementById("head2").style.color = header;
    }

    function changebody() {
        i = document.form1.body.selectedIndex;
        doccolor = document.form1.body.options[i].value;
        document.getElementById("p1").style.color = doccolor;
    }
</script>
</head>
<body>
    <h1 id="head1">Controlling Styles with JavaScript</h1>
    <hr>
    <h2 id="head2">Subtitles at this screen. And cery important subtitles!</h2>

    <hr>
    <p id="p1">Select the color for paragraphs and headings using the form below. The colors you specified will be dynamically changed in this document. The change occurs as soon as you change the value of either of the drop-down lists in the form.</p>

    <form name="form1"> <b>Heading color:</b>

        <select name="heading" onChange="changehead();">
            <option value="black">Black</option>
            <option value="red">Red</option>
            <option value="blue">Blue</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
        </select>
        <br>
            <B>Body text color:</B>

        <select name="body" onChange="changebody();">
            <option value="black">Black</option>
            <option value="red">Red</option>
            <option value="blue">Blue</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
        </select>
        <br>    <b>Heading second color:</b>

        <select name="heading" onChange="changetitle();">
            <option value="black">Black</option>
            <option value="red">Red</option>
            <option value="blue">Blue</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
        </select>
    </form>
</body> 
```

**问题：**

*   如何规避出现错误的情况？
*   是否需要两种不同的功能来更改头部和标题，或者一个就足够了（如果是 - 如何）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:26:52.920

您有两个名为“标题”的选择。给他们不同的名字，你的 javascript 将停止抛出错误。

这是一个工作示例：http: [//jsbin.com/uritid/1/edit](http://jsbin.com/uritid/1/edit)

# c++ - 字节数组及其大小的良好表示

> ID：15890050
> 
> 赞同：0
> 
> 时间：2013-04-08T22:20:31.220
> 
> 标签：c++, bytearray

您将如何很好地表示字节数组及其大小？我想存储（在主内存或文件中）原始字节数组（无符号字符），其中前 2/4 个字节将代表其大小。但是对这样的数组的操作看起来并不好：

```
void func(unsigned char *bytearray)
{
  int size;
  memcpy(&size, bytearray, sizeof(int));
  //rest of operation when we know bytearray size
} 
```

我怎样才能避免这种情况？我想一个简单的结构：

```
struct bytearray
{
  int size;
  unsigned char *data;
};

bytearray *b = reinterpret_cast<bytearray*>(new unsigned char[10]);
b->data = reinterpret_cast<unsigned char*>(&(b->size) + 1); 
```

而且我可以访问字节数组的大小和数据部分。但它看起来仍然很丑。你能推荐另一种方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T22:27:18.833

除非您有一些压倒性的理由不这样做，否则只需做惯用的事情并使用 std::vector<unsigned char>。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T22:23:45.640

您实际上是在重新发明["Pascal string"](https://en.wikipedia.org/wiki/String_%28computer_science%29#Length-prefixed)。然而

```
 b->data = reinterpret_cast<unsigned char*>(&(b->size) + 1); 
```

根本不起作用，因为指针指向自身，并且指针将被覆盖。

您应该能够为结构的最后一个元素使用未指定大小的数组：

```
struct bytearray
{
  int size;
  unsigned char data[];
};

bytearray *b = reinterpret_cast<bytearray*>(::operator new(sizeof (bytearray) + 10));
b->size = 10;

//...

::operator delete(b); 
```

与 不同`std::vector`的是，这实际上将大小和数据存储在一起，因此您可以例如在一次操作中将其写入文件。并且内存局部性更好。

尽管如此，`std::vector`已经过测试并且为您实现了许多有用的算法的事实使它非常有吸引力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-08T22:34:58.787

我会用它`std::vector<unsigned char>`来管理内存，并编写一个转换函数来`iovec`在你需要这样的东西时为你创建一些类似的结构。

```
iovec make_iovec (std::vector<unsigned char> &v) {
    iovec iv = { &v[0], v.size() };
    return iv;
} 
```

使用`iovec`，如果您需要在单个系统调用中同时写入长度和数据，您可以使用该`writev`调用来完成它。

```
ssize_t write_vector(int fd, std::vector<unsigned char> &v) {
    uint32_t len = htonl(v.size());
    iovec iv[2] = { { &len, sizeof(uint32_t) }, make_iovec(v) };
    return writev(fd, iv, 2);
} 
```

# sql - DB2 的查询怪癖，无操作合并将运行时减半

> ID：15890052
> 
> 赞同：2
> 
> 时间：2013-04-08T22:20:34.873
> 
> 标签：sql, database, statistics, db2

我正在优化 DB2 数据库的一些查询。它们中的大多数都运行良好，但是一些返回数据集相当大（最多 30k 行左右）的部分给我带来了一些麻烦。这些查询没有什么特别复杂的。他们从大约十几个连接中选择了大约 15 个不同的列，其中包括一些内连接和左连接。有一些 IN 子句可以使用参数和子查询来减少数据集。这没什么特别的。

我一直在查看一些索引，但运气不佳。问题是，在尝试强制使用未使用的新索引时，我偶然发现了 DB2 中的一个绝妙技巧：谓词中的无操作 COALESCE 可以潜在地降低成本和运行时间。

基本上，它是这样工作的：

```
SELECT ...
FROM A
JOIN B
ON A.ID1 = B.ID1
AND A.ID2 = B.ID2
--More inner and left joins--
WHERE
B.TYPE_CODE IN (:parameter)
AND A.X IN (--subquery--)
AND
COALESCE(B.TYPE_CODE,B.TYPE_CODE) = B.TYPE_CODE 
```

从逻辑的角度来看，COALESCE 什么都不做，并且 B.TYPE_CODE 永远不会为空。但是，这会欺骗 DB2 优化器来估计较少的行数，此处解释：

[http://www-01.ibm.com/support/docview.wss?uid=swg21259831](http://www-01.ibm.com/support/docview.wss?uid=swg21259831)

对于 TABLE B，TYPE_CODE 列有大约 15 个不同的可能值，分布不均匀。那里大约有 270 万行，A 中大约有 900k 行。因此，B 中的 ID1/ID2 列可能重复相同的值对多达 15 次或仅出现一次。:parameter 不超过四个值。

奇怪的是 COALESCE 语句将查询时间缩短了一半。在检查解释计划时，我注意到 A 上的几个表扫描变成了索引扫描，这可能是由于返回行的估计值较低，使得索引扫描对优化器来说是可行的。我一直在挖掘并试图找到一个可能的原因。RUNSTATS 是最近在这些表上运行的，SYSCAT.COLDIST 表中有一些非常新的数据，如果我手动检查计数，至少在值的 1% 以内。我确实注意到它没有包含 TYPE_CODE 列中的所有值，但是缺少的值很少发生，并且从 IN 子句中省略稀有值对查询时间没有实际影响。我在其他列上尝试过 COALESCE，但效果不同。

我能想到的唯一解释是一些统计数据是陈旧的、糟糕的、过时的等，但如果我知道在哪里看这一点，那就太糟糕了。我可以说没有列组统计信息，但我没有足够的知识来判断这是否会有所作为。

我不想将 COALESCE 声明投入生产，因为它有点老套，而且更像是解决更深层次问题的创可贴，而不是解决方案本身。在我看来，DB2 似乎高估了将在该连接中返回的行数，但如果我知道原因，那该死的。我希望其他具有 DB2 经验的人能够对此有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T05:08:17.810

I'm wondering why you have `in (:parameter)`, would `parameter` not be a single value?

Do you get better performance from separate `OR` clauses than the `IN`?

I'm targeting the `IN` clause because it apparently can give performance issues (see: [Performance of "in" condition query in db2](https://stackoverflow.com/questions/7208684/performance-of-in-condition-query-in-db2) ).

# ios - IOS 使用 Xamarin C# 绘制一个简单的图像变得模糊

> ID：15890055
> 
> 赞同：10
> 
> 时间：2013-04-08T22:20:51.580
> 
> 标签：ios, xamarin.ios, blurry, uigraphicscontext

我在 Xamarin 中开发，想画一个简单的圆圈，里面有文本“CIRCLE”，并在 UIImageView 中显示该图像。问题是圆圈和文字显得非常模糊。我读过一些关于亚像素的文章，但我认为这不是我的问题。

这是模糊的图像和代码，希望有人有一些想法:)

```
UIGraphics.BeginImageContext (new SizeF(150,150));
var context = UIGraphics.GetCurrentContext ();

var content = "CIRCLE";
var font = UIFont.SystemFontOfSize (16);

const float width = 150;
const float height = 150;

context.SetFillColorWithColor (UIColor.Red.CGColor);
context.FillEllipseInRect (new RectangleF (0, 0, width, height));

var contentString = new NSString (content);
var contentSize = contentString.StringSize (font);

var rect = new RectangleF (0, ((height - contentSize.Height) / 2) + 0, width, contentSize.Height);

context.SetFillColorWithColor (UIColor.White.CGColor);
new NSString (content).DrawString (rect, font, UILineBreakMode.WordWrap, UITextAlignment.Center);

var image = UIGraphics.GetImageFromCurrentImageContext ();
imageView.Image = image; 
```

![模糊圈](https://i.stack.imgur.com/fnt6L.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-09T00:03:13.780

它模糊的原因是因为它被调整了大小。该位图不是 150x150（如您创建的上下文），而是 333x317 像素。

这可能是因为`imageView`正在缩放它的图像（没有源代码）或因为像素加倍（对于视网膜显示器）。在后一种情况下，您真正​​想要使用的是：

```
UIGraphics.BeginImageContextWithOptions (size, false, 0); 
```

这将（使用`0`）自动为视网膜（或不）显示使用正确的缩放因子 - 并且在所有类型的设备上看起来清晰（而不是过大）。

# php - PHP DBO - mssql - bigint 作为查询中的连接

> ID：15890062
> 
> 赞同：0
> 
> 时间：2013-04-08T22:21:12.847
> 
> 标签：php, sql-server, bigint, dbo

我有一个基于 PHP 的站点，需要从我办公室内网中托管的 mssql 服务器中提取一些数据。我已经编写了 sql 来提取这些数据，并且在逻辑上它工作得很好。在 Windows 机器上进行测试期间，我的代码返回了我需要的所有数据。

但是，当我使用 PHP DBO dblib 将相同的查询放入 php 时，我没有得到任何返回（即 false），这表明存在一些语法问题。现在要回答任何简单的问题，我可以将任何问题连接到数据库，并且我的许多其他查询都可以工作（来自同一个数据库，甚至是同一个表），但是这个特定的 slq 似乎不起作用。

经过进一步调查，我意识到与“bigint”数据类型相关的“php_mssql”可能存在限制。我在 php.net 上进行了阅读，发现[它](http://www.php.net/manual/en/mssql.constants.php) 看起来好像没有预定义的常量来处理 8bit int。

只是为了澄清，这是我试图运行的 sql：

```
SELECT dbo.Vehicle.VehicleID, dbo.Vehicle.CarNumber,
dbo.Driver.DriverID, dbo.Driver.DriverNumber, dbo.Driver.DriverName,
dbo.VehicleJobHistory.BookingID, dbo.VehicleJobHistory.PickupSuburb,
dbo.VehicleJobHistory.DestinationSuburb,
dbo.VehicleJobHistory.ReasonDispatchedToCar,
dbo.VehicleJobHistory.TimeJobRequired,
dbo.VehicleJobHistory.TimeCarAcceptedJob,
dbo.VehicleJobHistory.TimeCarPickedUp,
dbo.VehicleJobHistory.TimeCarCompletedJob,
dbo.VehicleJobHistory.KmToPickup, dbo.VehicleJobHistory.KmOfJob,
dbo.DispatchStatus.Alias 

FROM (dbo.tblDispatch  
RIGHT JOIN ((dbo.Vehicle  
LEFT JOIN dbo.VehicleJobHistory ON dbo.Vehicle.VehicleID =
dbo.VehicleJobHistory.VehicleID) LEFT JOIN dbo.Driver ON
dbo.VehicleJobHistory.DriverID = dbo.Driver.DriverID) ON
dbo.tblDispatch.BookingID = dbo.VehicleJobHistory.BookingID)  
LEFT JOIN dbo.DispatchStatus ON dbo.tblDispatch.StatusID =
dbo.DispatchStatus.DispatchStatusID

WHERE (dbo.Vehicle.VehicleID = ’$vid’) AND
(dbo.VehicleJobHistory.TimeJobRequired Between ‘$DateFrom’ AND
‘$DateTo’) 
```

问题在于使用 bookingID 进行连接，在 sql server 上将其定义为“bigint”

基本上我想知道是否有任何可用的解决方法？

# javascript - 使用注销 URL 和访问令牌的 Facebook jQuery 注销

> ID：15890064
> 
> 赞同：0
> 
> 时间：2013-04-08T22:21:20.820
> 
> 标签：javascript, jquery, facebook, facebook-javascript-sdk, logout

当用户退出我的网站时，除非他们也退出他们的 Facebook 帐户，否则他们将保持登录到我的网站。

我想遵守本政策的第 6 点，那么为了安全起见，如何让我的用户退出我的网站和他们的 Facebook 帐户[https://developers.facebook.com/policy/](https://developers.facebook.com/policy/)

我将以下代码绑定到我的登录按钮，但它不起作用 - 单击后用户仍然登录到 FB。我的控制台显示 var accessToken 未定义，但我不知道为什么。我确定我在做一些根本错误的事情，非常感谢一些帮助！

```
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript">
 $(document).ready(function(){

  $(".logout").click(function () {
   FB.init({appId : <?php echo $this->config->item('facebook_appid');?>,
     status : true,
     cookie : true,
     oauth : true,
     frictionlessRequests: true});

   FB.login(function(response) {
     if (response.authResponse) {
     console.log(response.authResponse.accessToken);
     var accessToken = response.authResponse.accessToken;
     }
     });

   window.location.replace("https://www.facebook.com/logout.php?confirm=1&next=http://www.mysite.com&access_token="+accessToken+"");

});
});
  </script>

<div id="fb-root"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:53:36.623

要退出Facebook，您需要使用该[`FB.logout()`](https://developers.facebook.com/docs/reference/javascript/FB.logout/)方法。

如果您已经调用了`FB.init()`和`FB.login()`方法，则无需在 click 函数中再次调用这些方法。

# c# - 查找所有发生的异常

> ID：15890065
> 
> 赞同：0
> 
> 时间：2013-04-08T22:21:42.757
> 
> 标签：c#, exception, exception-handling, visual-studio-2012

我有一个用 C# 编写的大型 .net 应用程序。我想检查应用程序中是否以及哪些异常可能被 try/catch 捕获并且可能不明显 - 它们是这样被走私的。

反正这么容易找到？视觉工作室中有什么设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:30:12.107

转到`Debug / Exceptions`菜单，在那里您可以注册异常（只需检查要监视的异常）。

这样，调试器会在它们被引发时中断，即使它们稍后应该被捕获。

# jquery - 向元素添加背景图像和背景颜色对

> ID：15890071
> 
> 赞同：0
> 
> 时间：2013-04-08T22:22:25.660
> 
> 标签：jquery, css, background-image, background-color

`html`我正在尝试以特定方式向标签添加一对背景样式。这是我到目前为止所拥有的。

```
$(function() {
  var images = ['bg-day.png', 'bg-sunset.png', 'bg-night'];
  var colors = ['#0066CD', '#ff0000', '#1D2951'];
  $('html').css({'background-image': 'url(img/' + images[Math.floor(Math.random() * images.length)] + ')'});
}); 
```

所以，我需要做的是对变量进行相应的配对，其中 0 位置同时是`bg-day.png`and `#0066CD`，依此类推。因此，如果提供给`html`标签的背景图像是，它也会为标签`bg-day.png`添加背景颜色。`#0066CD``html`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:25:11.283

存储随机数，并将其用作两个数组的索引：

```
$(function() {
  var images = ['bg-day.png', 'bg-sunset.png', 'bg-night'],
      colors = ['#0066CD', '#ff0000', '#1D2951'],
      index  = Math.floor(Math.random() * images.length);

  $('html').css({'background-image' : 'url(img/' + images[index] + ')',
                 'background-color' : colors[index]
               });
}); 
```

# php - php mysqli删除重复的行但具有不同的ID？

> ID：15890075
> 
> 赞同：0
> 
> 时间：2013-04-08T22:22:43.260
> 
> 标签：php, mysql, mysqli

我的数据库按以下顺序排列

```
id  date        time        user_id     visits
---------------------------------------------------------------
1   02/19/13    1361257200  xxxxxxxxx   4699
2   02/20/13    1361343600  xxxxxxxxx   7264
3   02/21/13    1361430000  xxxxxxxxx   5281
4   02/21/13    1361430000  xxxxxxxxx   5281
5   02/22/13    1361516400  xxxxxxxxx   5473 
```

正如你所看到的，我有 id 3 的行与 id 4 的第 4 行相同。我只想删除其中一个（它们都应该具有相同的日期、时间、user_id 和访问值）我也有很多我的数据库中的其他重复行（数百行）。我不知道我必须用于此类事情的查询。我尝试寻找一些解决方案，但它们涉及具有相同的 id 或将行复制到新表。注意：即使我必须多次运行此查询，我也没有任何问题。

![在此处输入图像描述](https://i.stack.imgur.com/BNpLy.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T22:29:17.087

如果不能选择 ID 方式，您可以做的是向表中添加唯一键。

如.....

```
ALTER IGNORE TABLE  `tablename` ADD UNIQUE `keyname` (`date` ,`time` , `visits`); 
```

添加键后，表将遍历行，并删除任何匹配的（重复的）。这样做的缺点是它将防止任何重复的行再次出现......这可能是也可能不是问题，具体取决于表的使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T22:31:20.363

```
DELETE t2
FROM `your_table` AS t1
INNER JOIN `your_table` AS t2
  ON t1.date = t2.date
  AND t1.time = t2.time
  AND t1.user_id = t2.user_id
  AND t1.visits = t2.visits
  AND t2.id > t1.id 
```

# node.js - 如何设置 Gruntfile 以在 heroku 上使用 compass/sass？

> ID：15890076
> 
> 赞同：13
> 
> 时间：2013-04-08T22:22:43.527
> 
> 标签：node.js, heroku, compass-sass, gruntjs

[我已经使用grunt buildpack](https://github.com/mbuchetics/heroku-buildpack-nodejs-grunt)成功设置了我的 heroku 应用程序。当我将我的 Node.js 应用程序推送到 heroku 时，它将运行适当的 grunt 任务。

我想要的是使用“grunt-contrib-compass”包来编译我的 .scss 文件。但这需要指南针可执行文件，我不知道如何获得它。

我已经检查了 heroku 文档，并看到了一个[过时的文档，描述了使用 ruby​​ 设置指南针](https://devcenter.heroku.com/articles/using-sass)......但我还没有看到任何最近使用 Node.js 设置它的文档。

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-05-06T10:15:42.987

这花了很多时间弄清楚，但我终于设法让它工作了。需要的是让 Ruby 与您的 Node.js 应用程序一起安装，这样您就可以安装适当的 gem。[这个要点](https://gist.github.com/balupton/4342818)很有帮助，或多或少地描述了我需要做的事情。

总而言之，这个过程是：

*   在项目目录中创建文件`.buildpacks`、`Gemfile`和，其内容如下：`Gemfile.lock`

**.buildpacks**

```
https://github.com/heroku/heroku-buildpack-ruby.git
https://github.com/heroku/heroku-buildpack-nodejs.git 
```

**宝石文件**

```
source "http://rubygems.org"
gem "sass" 
```

**Gemfile.lock**

```
GEM
  remote: http://rubygems.org/
  specs:
    sass (3.4.5)

PLATFORMS
  ruby

DEPENDENCIES
  sass 
```

注意。我只使用 Sass，而不是 Compass，但我猜你需要做的就是添加`gem "compass"`到 Gemfile，例如。`compass (1.0.3)`下面是 Gemfile.lock 中的 sass。

*   向您的应用添加多构建包：

    `heroku config:add BUILDPACK_URL=https://github.com/ddollar/heroku-buildpack-multi.git`

*   最后，将这些推送到 Heroku，Ruby 和 Sass 应该与您的 Node.js 应用程序一起安装，允许您使用与 sass 相关的 grunt 任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T11:23:24.277

有一个分叉，包括指南针安装。这可能会有所帮助：

[https://github.com/stephanmelzer/heroku-buildpack-nodejs-grunt-compass](https://github.com/stephanmelzer/heroku-buildpack-nodejs-grunt-compass)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-28T14:16:07.920

我让我的应用程序在 heroku 上运行，`grunt-sass` 而不是`grunt-contrib-sass`. 要将它们换掉，只需执行`npm install --save grunt-sass`然后换掉 grunt-task 使用的任何地方（例如 `grunt.loadNpmTasks('grunt-sass')`，而不是`grunt.loadNpmTasks('grunt-contrib-sass')`

# google-drive-api - 快速入门后的困惑

> ID：15890077
> 
> 赞同：1
> 
> 时间：2013-04-08T22:22:45.213
> 
> 标签：google-drive-api

我对 Google Drive SDK 很陌生。在 google drive sdk 文档和快速启动应用程序上花了几个小时后，我想我已经知道了一些关于它的基本概念。但是，我有一个简单但至关重要的问题：如何将我的代码与 Drive UI 集成。我的意思是我知道我应该启用 Google Drive API 和 Google Drive SDK 并做一些配置人员。我做到了。

我设置了我的应用程序应该能够打开和创建的 MIME 类型，但它不起作用。（我使用了最简单的一种：纯文本/文本：txt）。

其实我觉得这还不是最严重的问题。我对如何将我的代码与 Drive UI 集成感到困惑。我的意思是快速启动应用程序工作正常，但它只是简单地上传一个文件。如果我想在用户使用我的应用打开某个文件后执行一些复杂的操作怎么办？

理想情况下，我认为它应该将用户重定向到我的打开 URL，并且所有操作都应该与该站点一起进行，对吗？（我正在使用 Python，以防可能产生任何差异）

我真的很困惑。请原谅我的混乱描述。

提前致谢！

编辑：

谢谢楼下的回答！我想我需要从 google drive sdk 详细解释我的需求。

基本上，我希望安装了我的应用程序的用户能够在谷歌驱动器上打开某个文件（应该是电子表格或 txt）。然后它将用户重定向到我给定的 Open URL（我使用 google 站点创建了一个站点）。在该站点上，用户应该能够查看文件内容并将其导入某个数据库。以上操作均不需要任何技术知识。我当然可以通过编写 python 脚本并在本地运行它来导入谷歌驱动器上的文件内容来做到这一点。但是，有两个问题：首先，我需要在本地运行它。我的意思是我确实使用了 google drive api，但我没有探索 api 的真正好处；其次，它仍然是一个命令行脚本，并且必须在 linux 上运行。

我希望我已经说明了我的要求。我提前感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T14:07:31.027

安装客户端库：

```
pip install --upgrade google-api-python-client 
```

[按照Python 快速入门示例](https://developers.google.com/drive/quickstart-python#step_3_set_up_the_sample)中的说明获取访问令牌。初始化 Drive 服务，以便能够与 API 对话并使用您的凭据授权 http 传输器。您需要发出请求以获取文件元数据和文件内容。

检索文件元数据：

```
http = httplib2.Http()
http = credentials.authorize(http)

drive_service = build('drive', 'v2', http=http)
f = drive_service.files().get(fileId=file_id).execute() 
```

检索文件内容：

```
downloadUrl = f.get('downloadUrl')
f['content'] = drive_service._http.request(downloadUrl) 
```

（不要忘记内容检索请求应该经过授权和身份验证，这就是我们使用 drive_service._http 发出该请求的原因。

# ios - 剪切选择后获取剩余文本

> ID：15890079
> 
> 赞同：0
> 
> 时间：2013-04-08T22:23:11.193
> 
> 标签：ios, ios6, uitextview, uitextrange

有没有一种简单的方法可以在选择被剪切后获取剩余的文本？假设我有一个带有“Hello, Jim”的 textview 控件。如果选择了“Jim”，我想将“Hello”存储到一个变量中，“而不使用 [textview1 cut:self]。在下面的代码中，我可以得到另一部分。

```
UITextRange *selectedTextRange = textview1.selectedTextRange;
NSUInteger location = [textview1 offsetFromPosition:textview1.beginningOfDocument toPosition:selectedTextRange.start];
NSUInteger length = [textview1 offsetFromPosition:selectedTextRange.start toPosition:selectedTextRange.end];
NSRange selectedRange = NSMakeRange(location, length);
NSString *str = [textview1.text substringWithRange:selectedRange];
NSLog(@"%@",str); 
```

当然，这是另一部分。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:33:46.453

```
NSString *remaining = [textview1.text stringByReplacingCharactersInRange:textview1.selectedRange withString:@""]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:48:40.057

我认为它类似于以下内容。（修改）

```
NSMutableString *str = [NSMutableString stringWithString:@""];
if (textview1.text.length > length) {
    [str appendString:[textview1.text substringToIndex:location]];
    [str appendString:[textview1.text substringFromIndex:location + length]];
} else {
    [str appendString:@""];
}
[self setText:str]; 
```

# gps - 计算两个 GPS 点之间的 (x, y) 距离

> ID：15890081
> 
> 赞同：5
> 
> 时间：2013-04-08T22:23:19.087
> 
> 标签：gps, latitude-longitude

我正在寻找一种平滑的方法来计算两个 GPS 点之间的距离，所以我得到的结果如下：“你必须向上 x 米，向左 y 米 - 这样我就可以使用二维坐标系，我的位置为（0,0），其他位置显示（x，y）与我的位置的距离（以米为单位）。

我的想法是使用半正弦公式计算点之间的距离。（这会返回我的斜边）

除此之外，我正在计算这两点之间的方位。这是我的阿尔法。

有了这两个值，我想使用基本的三角函数来解决我的问题。

所以我试图计算：`catheti_1 = sin(alpha) * hypotenuse, catheti_2 = cos(alpha) * hypotenuse`。

也许我做错了什么，但我的结果目前没有用。

所以我的问题是：如何计算两个 GPS 点之间的 x 和 y 方向的距离？

我在以下过程中计算 alpha：

```
public static double bearingTo(GPSBean point1, GPSBean point2) {
    double lat1 = Math.toRadians(point1.latitude);
    double lat2 = Math.toRadians(point2.latitude);
    double lon1 = Math.toRadians(point1.longitude);
    double lon2 = Math.toRadians(point2.longitude);

    double deltaLong = lon2 - lon1;

    double y = Math.sin(deltaLong) * Math.cos(lat2);
    double x = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1)
            * Math.cos(lat2) * Math.cos(deltaLong);
    double bearing = Math.atan2(y, x);

    return (Math.toDegrees(bearing) + 360) % 360;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T23:08:13.833

我刚刚实现了您的代码，使用 NYC 和波士顿的近似坐标作为参考点，并实现了[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)上的 Haversine 公式（您没有显示）：

```
long1 = -71.02; lat1 = 42.33;
long2 = -73.94; lat2 = 40.66;

lat1 *=pi/180;
lat2 *=pi/180;
long1*=pi/180;
long2*=pi/180;

dlong = (long2 - long1);
dlat  = (lat2 - lat1);

// Haversine formula:
R = 6371;
a = sin(dlat/2)*sin(dlat/2) + cos(lat1)*cos(lat2)*sin(dlong/2)*sin(dlong/2)
c = 2 * atan2( sqrt(a), sqrt(1-a) );
d = R * c; 
```

当我运行此代码时，我得到`d = 306`，这与上述站点的答案一致。

对于方位，我得到 52 度 - 再次接近网站给出的值。

如果不查看您的其余代码，就很难知道您的答案为何不同。

注意：当两点靠得很近时，您可以进行各种近似，但是这段代码应该仍然有效 - 该公式具有良好的数值稳定性，因为它使用`sin`经度，纬度之间的差异（而不是罪的差异）。

附录：

使用您的 x, y 代码（在您的问题中），我得到了距离的合理值 - 同意 120 m 内的“正确”答案（这还不错，因为一个是直线近似值，另一个遵循地球曲率）。所以我认为你的代码基本上没问题，现在你修正了错字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-08T12:32:34.567

使用 Haversine 公式计算由纬度/经度（以数字度数）指定的两点之间的距离（以公里为单位）

来自：Haversine 公式 - RW Sinnott，“Haversine 的美德”

天空与望远镜，第 68 卷，第 2 期，1984 年

[http://www.census.gov/cgi-bin/geo/gisfaq?Q5.1](http://www.census.gov/cgi-bin/geo/gisfaq?Q5.1)

表单中的示例用法：

```
result.value = LatLon.distHaversine(lat1.value.parseDeg(), long1.value.parseDeg(), * lat2.value.parseDeg(), long2.value.parseDeg()); 
```

Javascript：

```
LatLon.distHaversine = function(lat1, lon1, lat2, lon2) {
   var R = 6371; // earth's mean radius in km
   var dLat = (lat2-lat1).toRad();
   var dLon = (lon2-lon1).toRad();
   lat1 = lat1.toRad(), lat2 = lat2.toRad();
   var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
   Math.cos(lat1) * Math.cos(lat2) * Math.sin(dLon/2) * Math.sin(dLon/2);
   var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
   var d = R * c;

   return d;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-15T08:13:29.257

如果有人有兴趣拥有一个任何人都能理解的更简单的公式。这是我的，它适用于瑞典，但您可以通过制定一个更通用的计算 longfactor 的公式来使其适用于任何地方。希望你能理解，即使它是用奇怪的语言写的。

```
<gpsDist lat1,long1,lat2,long2> all parameters in 1/100000 degree.
Example: <getDist 5950928,1327120,5958505,1302241> => 16303
Same at https://gps-coordinates.org/distance-between-coordinates.php => 16.35 KM.

<var $latFactor,1.112>
<function getDist,
-<var $longFactor,<calc 0.638 - ($1/100000-55)*0.0171,3>>
-<var $latDist,<calc ($3-$1)*$latFactor>>
-<var $longDist,<calc ($4-$2)*$longFactor>>
-<sqrt $latDist*$latDist + $longDist*$longDist>
-> 
```

/贝蒂尔·弗里曼

# macos - 核心数据：“-add 对象：”未调用

> ID：15890089
> 
> 赞同：1
> 
> 时间：2013-04-08T22:23:59.617
> 
> 标签：macos, core-data

假设我有一个实体`BikeRider`，其关系属性名为`helmets`.

我有一个数组控制器绑定到应用程序的托管对象上下文，实体设置为`BikeRider`. 有一个表格视图列出了所有骑自行车的人。

然后，我有第二个数组控制器，绑定到应用程序的托管对象上下文，实体设置为`Helmet`. 此外，它必然会`bikeRiderArrayController.selection`. 第二个表格视图列出了所选自行车骑手的所有头盔。

我还有两个用于添加和移除头盔的按钮。该设置显然完美无缺。

当然，除了一件小事：它看起来像`-addHelmetsObject:`, `-removeHelmetsObject:`，`-addHelmets:`并且`-removeHelmets:`永远不会被调用。这意味着一些用于设置每个头盔`color`属性观察的代码永远不会被调用。

**我错过了什么？**是否覆盖`addHelmets:`et al（带有适当的`willChangeValueForKey:`et al 通知）是获取添加通知的正确方法？

**我是否真的必须** `[self observeValueForKey:@"helmets". . .]`然后`[oldValue minusSet:newValue]`反之亦然才能确定添加或删除了哪些对象？我可以发誓这些方法在过去被正确调用。也许设置的某些关键元素现在不同了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T01:22:10.063

这从未通过 NSArrayController 正常工作。来自[Apple 的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW22)：

> ## 数组控制器不调用自定义关系集修改器方法
> 
> **问题：**您已经为“自定义对多关系访问器方法”中描述的关系实现了 set mutator 方法，并将 NSArrayController 实例的 contentSet 绑定绑定到关系，但是当您添加对象时不会调用 set mutator 方法从阵列控制器中删除对象。
> 
> **原因：**这是一个错误。
> 
> **补救措施：**您可以通过将 self 添加到 contentSet 绑定的键路径来解决此问题。例如，您将绑定到 [Department Object Controller].selection.self.employees，而不是绑定到 [Department Object Controller].selection.employees。

# javascript - 一个 iframe 中的 Bing 地图中的多个位置

> ID：15890091
> 
> 赞同：1
> 
> 时间：2013-04-08T22:24:11.833
> 
> 标签：javascript, bing-maps, referenceerror

我试图让这段代码在 iframe 中工作，但我总是得到错误：

ReferenceError：未定义 GetMap

我不是高级程序员，所以我不知道为什么它单独工作，而不是在 iframe 中（而且似乎没有人有同样的问题）！帮助将不胜感激。

PS：编程代码主要来自YoYoMyo（谁在stackoverflow上发布的），我只是将它改编为我的使用

```
 <html>
        <head>
            <script charset="UTF-8" type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
            <script type="text/javascript" language="JavaScript">

            function GetMap() {
                var longitude = new Array();
                var latitude = new Array();
                var title = new Array();
                var description = new Array();

                longitude[0] = 47.5564154        //two defined locations
                latitude[0] = 7.59245395
                title[0] = "Basler Münster"
                description[0] = "Basel"

                longitude[1] = 47.55330556     //second defined Location
                latitude[1] = 7.59001851
                title[1] = "Theater Basel"
                description[1] = "Basel"

                var total = 2                //number of locations

                var pinInfoBox;  //the pop up info box
                var infoboxLayer = new Microsoft.Maps.EntityCollection();
                var pinLayer = new Microsoft.Maps.EntityCollection();
                var apiKey = "AmpgeSj6OVb9ILPwvjyIfwM3qmqm5yccyNGR_mxmbpw2znYZoXxQAz_KVbc84XCC";

                    map = new Microsoft.Maps.Map(document.getElementById("map"), {credentials: apiKey});

                    // Create the info box for the pushpin
                    pinInfobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0, 0), { visible: false });
                    infoboxLayer.push(pinInfobox);

                    for (var i = 0 ; i < total; i++){
                        //add pushpins
                        var latLon = new Microsoft.Maps.Location(longitude[i], latitude[i]);
                        var pin = new Microsoft.Maps.Pushpin(latLon);
                        pin.Title = title[i];//usually title of the infobox
                        pin.Description = description[i]; //information you want to display in the infobox
                        pinLayer.push(pin); //add pushpin to pinLayer
                        Microsoft.Maps.Events.addHandler(pin, 'click', displayInfobox);
                    }

                    map.entities.push(pinLayer);
                    map.entities.push(infoboxLayer);
                    map.setView({zoom: 15, center: new Microsoft.Maps.Location(47.55330556, 7.59001851)});

                }

                function displayInfobox(e) 
                {
                    pinInfobox.setOptions({title: e.target.Title, description: e.target.Description, visible:true, offset: new Microsoft.Maps.Point(0,25)});
                    pinInfobox.setLocation(e.target.getLocation());
                }

                function hideInfobox(e) 
                {
                    pinInfobox.setOptions({ visible: false });
                }

            </script>

            <style>
                #map { position: relative; top: 0; left: 0; width: 100%; height: 800px; border:none;}
            </style>
        </head>
        <body onload="GetMap()">
            <div id="some stuff" style="width=100%; height:80px">
                some text
            </div>
            <div id="map" style="width=100%; height:800px">
            </div>
            <div id="some more stuff" style="width=100%; height:80px">
                some more text to read
            </div>              
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-29T22:51:22.393

代码看起来不错，我无法重现您看到的错误。

# c# - WP7 Skydrive API - 创建文件夹不起作用

> ID：15890093
> 
> 赞同：1
> 
> 时间：2013-04-08T22:24:13.570
> 
> 标签：c#, silverlight, windows-phone-7, xaml, onedrive

我尝试使用[本](http://msdn.microsoft.com/cs-cz/library/live/hh826531.aspx#creating_folders)教程从我的 WP7 应用程序在 skydrive 上创建新文件夹。

这是我的代码：

```
 private void MSAccountLoginToggleSwitch_Checked_1(object sender, RoutedEventArgs e)
    {
        try
        {
            LiveAuthClient auth = new LiveAuthClient("** my id **");
            auth.LoginAsync(new string[] { "wl.skydrive_update", "wl.calendars_update" });
            auth.LoginCompleted += auth_LoginCompleted;
        }
        catch (LiveAuthException exception)
        {
            MessageBox.Show("Error signing in: " + exception.Message);
        }
    }

    private void auth_LoginCompleted(object sender, LoginCompletedEventArgs e)
    {
        if (e.Status == LiveConnectSessionStatus.Connected)
        {
            mySession = e.Session;
        }
        else
        {
            MSAccountLoginToggleSwitch.IsChecked = false;
        }
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        try
        {
            var folderData = new Dictionary<string, object>();
            folderData.Add("some test", "A brand new folder was created");

            LiveConnectClient liveClient = new LiveConnectClient(mySession);
            liveClient.PostAsync("me/skydrive", folderData);
        }
        catch (LiveConnectException exception)
        {
            MessageBox.Show("Error creating folder: " + exception.Message);
        }
        finally
        {
            MessageBox.Show("uploded");
        }
    } 
```

它显示消息框“已上传”，但是当我查看我的 skydrive 时，该文件未创建。

它没有显示任何错误消息，我在做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:45:37.243

此行为`liveClient.PostAsync("me/skydrive", folderData);`您提供了一个任务，您无需等待，您只需`MessageBox.Show("uploded");`在最后显示。我认为 WP7 不支持`async`/ `await`，因此您需要使用 ContinueWith 方法处理 Task ：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
        var folderData = new Dictionary<string, object>();
        folderData.Add("some test", "A brand new folder was created");

        LiveConnectClient liveClient = new LiveConnectClient(mySession);
        liveClient.PostAsync("me/skydrive", folderData)
                  .ContinueWith((t) => 
                                 { 
                                    if (t.IsFauled)
                                    {
                                       MessageBox.Show("Error creating folder: " + t.Exception.Message);
                                    }
                                    else
                                    {
                                        MessageBox.Show("uploded");  
                                    }
                                 }
                                , TaskScheduler.FromCurrentSynchronizationContext());

} 
```

更新：上面的代码仅适用于 WP8，但在 WP7 上 PostAsync 不是 Task 的方法，因此要获得 PostAsync 结果，您需要订阅[PostCompleted](http://msdn.microsoft.com/en-us/library/live/microsoft.live.liveconnectclient.postcompleted.aspx)事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T09:57:58.630

我发现问题我有错误：

```
folderData.Add("some test", "A brand new folder was created"); 
```

正确的版本是：

```
folderData.Add("name", "some test"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T11:06:24.450

```
 var folderData = new Dictionary<string,object>();
   folderData.Add("myfolder ","simple folder ");    
   client.PostAsync("me/skydrive","{'name': 'myfolder' }"); 

 client.PostCompleted += new EventHandler<LiveOperationCompletedEventArgs>          (client_PostCompleted);

   void client_PostCompleted(object sender, LiveOperationCompletedEventArgs e)
    {
        var a = e.RawResult;
    } 
```

# html - Outlook 无法识别 Html 电子邮件活动中的 Mime 类型 - application/json

> ID：15890094
> 
> 赞同：0
> 
> 时间：2013-04-08T22:24:15.503
> 
> 标签：html, amazon-s3, outlook, mime-types

**Windows 具有有关此 MIME 类型的以下信息。此页面将帮助您找到打开文件所需的软件。MIME 类型：application/json 描述：未知 Windows 无法识别此 MIME 类型**

这是我的一些电子邮件在 Outlook 上打开时显示的消息。这与我存储在 Amazon S3 存储桶中的电子邮件中的图像有什么关系吗？如果是这样，我应该从哪里提取电子邮件中的图像。另请注意，图像是通过 ruby​​ 代码动态拉取的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:30:24.013

看起来您正在存储实际的 JSON 文件而不是图像作为附件。

如果您在 Outlook 中选择邮件，单击 OutlookSpy 工具栏上的 IMessage 按钮并转到 GetAttachmentTable 选项卡，您会在[OutlookSpy中看到什么？](http://www.dimastr.com/outspy/)

# java - 仅在终端中给出错误？

> ID：15890095
> 
> 赞同：0
> 
> 时间：2013-04-08T22:24:19.253
> 
> 标签：java, oop, error-handling, compiler-errors

我已经完成了一个剪刀石头布程序，当我在 Eclipse 中运行它时，它编译得很好，游戏也可以正常运行。虽然，当我在终端（使用 Ubuntu）中编译它时，我收到以下错误：

> xx@xx:~/Dropbox$ cd T* xx@xxxx:~/Dropbox/xx$ ls RPSGame.java RPSPlayer.java RPSTournament.java xx@xx:~/Dropbox/xxxx$ javac RPSTournament 错误：类名，'RPSTournament '，仅在明确请求注释处理时才被接受 1 错误 xx@choloboy:~/Dropbox/xx$

知道这可能意味着什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:26:52.003

编译时需要在命令行中包含文件扩展名“.java”。

编译使用：

> javac RPSTournament.java

要运行使用：

> java RPS锦标赛

# python - 带有 wtforms 的烧瓶如何使用可插入视图或装饰器或其他改进我的代码？

> ID：15890104
> 
> 赞同：0
> 
> 时间：2013-04-08T22:25:05.883
> 
> 标签：python, model-view-controller, flask, flask-wtforms

我是一个新手程序员，在 GAE 上使用带有 wtforms 的烧瓶通过表单获取数据并列出数据。目前一切正常，但我的大多数观点都使用非常相似的表单创建、发布和列表方法。我想要一种方法来简化混乱并减少我使用的代码量。

我已经看到了三个潜在的选择：

1.  [来自 Flask 的可插入视图](http://flask.pocoo.org/docs/views/)
2.  [只是一个简单的烧瓶装饰器](http://flask.pocoo.org/docs/patterns/viewdecorators/)
3.  可能是方法视图？（见 1）。

目前我有一些 /new/post /new/home 等。

下面的相关代码片段： **视图：**

```
@app.route('/new/post', methods = ['GET', 'POST'])
@login_required
def new_post():

    form = PostForm()
    if form.validate_on_submit():
        post = Post(title = form.title.data,
                    content = form.content.data,
                    hometest = form.hometest.data,
                    author = users.get_current_user())
        post.put()
        flash('Post saved on database.')
        return redirect(url_for('list_posts'))
    form.hometest.choices = [ (h.key.id(),h.homename)for h in Home.query()]
    return render_template('new_post.html', form=form)

@app.route('/new/home',methods = ['GET','POST'])
def home_new():
    form = HomeForm()
    if form.validate_on_submit():
        home = Home(homeid = int(form.homeid.data),
                    homename = form.homename.data)
        home.put()
        flash('Home saved on database')
        return redirect(url_for('home'))
    return render_template('new_home.html',form = form) 
```

**楷模：**

```
class Home(ndb.Model):
    homeid = ndb.IntegerProperty(required=True)
    homename = ndb.StringProperty(required=True)
    hometest = ndb.IntegerProperty(required=True)

class Post(db.Model):
    title = db.StringProperty(required = True)
    content = db.TextProperty(required = True)
    when = db.DateTimeProperty(auto_now_add = True)
    author = db.UserProperty(required = True) 
```

**形式：**

```
class PostForm(Form):
    title = wtf.TextField('Title', validators=[validators.Required()])
    content = wtf.TextAreaField('Content', validators=[validators.Required()])
    hometest = wtf.SelectField(u'Home Name List', coerce=int,validators=[validators.optional()])

class HomeForm(wtf.Form):
    homeid = TextField('ID of Home', [validators.Length(min=1, max=25)])
    homename = TextField('Name of Home', [validators.Length(min=4, max=25)]) 
```

**我在想一些更时尚的东西，比如：**

```
@app.route('/new/<whatsnew>', methods)
@mydecorator
def new_whatsnew:
     Stuff specific to <whatsnew>

@app.route('/list/<whatsnew>', methods)
@mydecorator
def list_whatsnew
     Stuff specific to <whatsnew> 
```

当然，如果有更多可接受的方式（或没有办法解决这个问题）。我不是在寻找实际的代码，虽然一个例子会很好，但这是正确的设计方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T22:37:24.310

也许你需要一个像这样的可插入视图：

```
class FormView(View):
    def __init__(self):
        self.form_class = None
        self.template = ''
        self.success_url = ''

    def on_validate(self, form):
        pass

    def on_invalidate(self, form):
        pass

    def dispatch_request(self):
        form = self.form_class()

        if form.validate_on_submit():
            self.on_validate(form)
            return redirect(self.success_url)

        self.on_invalidate(form)
        return render_template(self.template, form=form) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:54:25.003

我得到一个：

> 文件“/Volumes/320gb/Dropbox/Projects/git_projects/virtualenvs/gae/gae_take2000/flask/app.py”，第 723 行，在 make_response 中引发 ValueError('View function did not return a response') ValueError: View function did not返回响应

添加新的 SensorsView 时出错。适用于所有其他几乎相同的视图。这是两个相同的。

显然错误是关于 POST 的，但我不知道它为什么会中断。

**父类：**

```
class FormView(View):
    methods = ['GET', 'POST']

    def __init__(self):
        self.form_class     = None
        self.template       = ''
        self.success_url    = ''
        self.sfield         = False

    def on_validate(self, form):
        pass

    def on_invalidate(self, form):
        pass

    def on_sfield(self, form):
        pass

    def dispatch_request(self):
        form = self.form_class()

        if self.sfield:
            form = self.on_sfield(form)

        if request.method == 'GET':
            return render_template(self.template, form=form)

        if request.method == 'POST':
            if form.validate_on_submit():
                self.on_validate(form)
                return redirect(url_for(self.success_url)) 
```

**继承的 ZoneView（完美运行）：**

```
class ZoneView(FormView):
    def __init__(self):
        FormView.__init__(self)
        self.form_class     = ZoneForm
        self.template       = 'new_zone.html'
        self.success_url    = 'ZoneList'
        self.sfield         = True

    def on_sfield(self,form):
        form.homekey.choices = [ (h.key.id(),h.homename)for h in Home.query()]
        return form

    def on_validate(self, form):
        zone = Zone(zname    = form.zname.data,
                    zonemac     = form.zonemac.data) #,        homekey    = form.homekey.data

        zone.put()
        flash('Zone saved on database.')

app.add_url_rule('/new/zone', view_func=ZoneView.as_view('ZoneView'),  methods = ['GET', 'POST']) 
```

**SensorsView（未出现错误）：**

```
class SensorsView(FormView):
    def __init__(self):
        FormView.__init__(self)
        self.form_class     = SensorForm
        self.template       = 'new_sensors.html'
        self.success_url    = 'SensorList'
        self.sfield         = True

    def on_sfield(self,form):
        form.zonekey.choices = [ (h.key.id(),h.zname)for h in Zone.query()]
        return form

    def on_validate(self, form):
        sensor = Sensor(sensortype = form.sensortype.data,
                        pinmapping = form.pinmapping.data)
        #        zonekey = form.zonekey.data
        sensor.put()
        flash('Home saved on database.')

app.add_url_rule('/new/sensor', view_func=SensorsView.as_view('SensorsView'),    methods = ['GET', 'POST']) 
```

***模板：*** **new_zone：**

```
{% extends "base.html" %}
{% import 'macros.html' as mymacros %}

{% block content %}
<h1 id="">This is where your zone name will come into play</h1>
<form action="{{ url_for('ZoneView') }}" method="post" accept-charset="utf-8">
    {{ form.csrf_token }}

    <p>
        {{mymacros.form_fields(form)}}
    </p>

    <p><input type="submit" value="Save Zone"/></p>
</form>
{% endblock %} 
```

**new_sensors.html**

```
{% extends "base.html" %}
{% import 'macros.html' as mymacros %}

{% block content %}
<h1 id="">This is where your home name will come into play</h1>
<form action="{{ url_for('SensorsView') }}" method="post" accept-charset="utf-8">
    {{ form.csrf_token }}

    <p>
        {{mymacros.myform_field(form.sensortype)}}
    </p>

    <p><input type="submit" value="Save post"/></p>
</form>
{% endblock %} 
```

代码被剪切粘贴并更改为适合。几乎一模一样。我不知道为什么它抱怨 View 功能。有没有我看不到的错字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T18:25:36.447

感谢你的回答。我还是有点困惑。所以通过说我的帖子视图或主页视图来使用它

```
def postview(FormView):
   self.form_class = "HomeForm"
   self.template = 'homelist.html' #without html # this is the form template?
   self.success_url = url_for('homelist') #redirect goes here? 
```

[...从此处](http://flask.pocoo.org/docs/views/)的可插入视图文档中，我对以下内容的用法感到困惑：

```
def dispatch_request(self):
        context = {'objects': self.get_objects()}
        return self.render_template(context) 
```

在父类和继承的类中：

```
def get_objects(self):
        return User.query.all() 
```

上下文是一个内置的 Flask 对象，但是将表单模板链接到表单模型，将其放入我的 gae 模型，然后将您发送到另一个 url 的魔法仍然让我感到困惑。

# android - 使用 canvas.drawBitmap 时使用相对坐标应用 BitmapShader

> ID：15890106
> 
> 赞同：1
> 
> 时间：2013-04-08T22:25:13.027
> 
> 标签：android, graphics

我正在尝试使用 BitmapShader 在画布上绘制。我有 2 张相同尺寸的图像（一张用于 alfa 通道，一张用于 RGB），我想在以相同尺寸创建的画布上进行绘制。问题在于，似乎 canvas.drawBitmap 用户绘制的绝对坐标。有没有办法用相对坐标绘制。

```
public class MaskedImageDrawable extends Drawable {
    private final Bitmap mMask;

    private final Paint mPaint = new Paint();

    public MaskedImageDrawable(Bitmap mask, Bitmap image) {
        mMask = mask;

        Shader targetShader =
            new BitmapShader(image, Shader.TileMode.CLAMP, Shader.TileMode.CLAMP);
        mPaint.setShader(targetShader);
    }

    @Override
    public void draw(Canvas canvas) {
        canvas.drawBitmap(mMask, 0.0f, 0.0f, mPaint);
    }

    @Override
    public int getOpacity() {
        return PixelFormat.TRANSLUCENT;
    }

    @Override
    public void setAlpha(int alpha) {
        mPaint.setAlpha(alpha);
    }

    @Override
    public void setColorFilter(ColorFilter cf) {
        mPaint.setColorFilter(cf);
    }
} 
```

我似乎无法在屏幕上获得可绘制对象的绝对坐标。我知道我可以从包含可绘制对象的视图中使用 getLocationOnScreen/InWindow 但不考虑动画。

我尝试通过在 onBoundsChange 中的着色器上应用平移来应用相对坐标，但这里的坐标似乎也是相对的。

```
 Matrix mTranslationMatrix =  new Matrix()

  @Override
  protected void onBoundsChange(Rect bounds) {
      super.onBoundsChange(bounds);
      mTranslationMatrix.setTranslate(bounds.left, bounds.top);
      mPaint.getShader().setLocalMatrix(mTranslationMatrix);
  } 
```

作为参考 - 似乎具有相同油漆的 drawRect 将使用相对坐标。所以用下面的方法替换draw方法将正确地在drawable上渲染RGB图像（但不是掩码）

```
@Override
public void draw(Canvas canvas) {
    // getBounds returns the relative coordinates as well
    canvas.drawRect(getBounds, mPaint);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T03:42:24.003

看来这是一个硬件加速问题。在视图上禁用硬件加速会将着色器移回相对坐标。

```
if (android.os.Build.VERSION.SDK_INT >= 11) {
    myView.disableHwAcceleration();
} 
```

# .net - 空异常未处理？

> ID：15890107
> 
> 赞同：0
> 
> 时间：2013-04-08T22:25:21.413
> 
> 标签：.net, vb.net, nullreferenceexception

我正在和我的朋友一起完成一项任务。我就如何进行循环寻求帮助，他给了我那部分的代码。所以我复制并粘贴到vb中。它适用于他，但每次我尝试调试它时，我都会收到“未处理空异常”的标志。但它不仅仅是一条线。拳头它从 LstInvoice.items.clear() 开始，但如果我删除它，它会遍历所有行。到底是怎么回事？我之前在其他任务中使用过 LstInvoice.items.clear() 并且以前从未遇到过这个问题。这是我的代码：

```
Private Sub btnStraight_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnStraight.Click
        Dim Cost As Double

        Cost = txtCost.Text
        Dim Salvage_Value As Double
        Salvage_Value = 0
        Dim Life As Double
        Life = txtLife.Text
        Dim Depreciation As Double
        Depreciation = (Cost / Life)
        Dim c As Integer, i As Integer, x As Integer, y As Integer, z As Integer
        c = CInt(CDbl(txtYear.Text))
        i = CInt(txtLife.Text)
        x = CInt(txtCost.Text)
        y = CInt(CDbl(x) / i)
        z = x - y
        LstInvoice.items.clear()
        LstInvoice.Items.Add("Description: " & "" & txtDescription.Text)
        LstInvoice.Items.Add("Year of purchase: " & txtYear.Text)
        LstInvoice.Items.Add("Cost: " & FormatCurrency(txtCost.Text))
        LstInvoice.Items.Add("Estimated life:" & txtLife.Text)
        LstInvoice.Items.Add("Method of Depresciation: straight-line method")
        LstInvoice.Items.Add("")
        LstInvoice.Items.Add("Value beginning of " & c & ": " & FormatCurrency(CInt(txtCost.Text)))
        LstInvoice.Items.Add("Amount of depreciation accruing: " & c & ": " & FormatCurrency(y))
        LstInvoice.Items.Add("Total depreaciation at end of " & c & ": " & FormatCurrency(z))
        LstInvoice.Items.Add("")
        c = c + 1
        Do While (x > 0)
            y = CInt(CDbl(x) / i)
            z = x - y
            x = z
            LstInvoice.Items.Add("Value beginning of " & c & ": " & FormatCurrency(x))
            LstInvoice.Items.Add("Amount of depreciation accruing: " & c & ": " & FormatCurrency(y))
            LstInvoice.Items.Add("Total depreaciation at end of " & c & ": " & FormatCurrency(z))
            LstInvoice.Items.Add("")
            i = i - 1
            c = c + 1
        Loop 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:08:06.923

您没有正确地大写所有内容，它应该如下所示：

```
LstInvoice.Items.Clear() 
```

注意大写字母 I 和 C。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:24:38.683

我用一个项目测试了完全相同的代码。

正如 Cody Gray 已经提到的，您可能添加了错误的控件作为 lstInvoice。使用列表框。

你所做的是在粘贴代码后选择一个代码修复，并为 lstInvoice 生成一个代码存根，它在代码底部创建以下方法：

```
Private Function LstInvoice() As Object
    Throw New NotImplementedException
End Function 
```

如果您忘记了命名空间引用，这些更正提供了一些有效的修复，但通常它无法猜测代码的含义是哪个控件。

所以请删除此函数，转到表单（我想它不是控制台应用程序），打开工具箱，然后将**ListBox**拖放到您的表单中。最后将该 ListBox 名称从 ListBox1 重命名为**lstInvoice**并检查您的代码现在是否正常工作。

# php - 表单操作不使用 php，而是将 php 文件名附加到 url

> ID：15890111
> 
> 赞同：0
> 
> 时间：2013-04-08T22:25:38.290
> 
> 标签：php, forms, action

我难住了。我在其他地方使用了这个代码模式，它工作正常，但在这种情况下我得到了一个不受欢迎的行为。我已经搜索并发现没有其他关于此问题的参考。

我的表单代码：

```
<form method="post" id="quoteForm" action="process_acceptance.php">
   <table>
        <tbody>
        <tr><h1>Contract Confirmation</h1></tr>
        ...
        <tr>
            <td><input type="hidden" name="record_number"></td>
            <td><center><b><input type="submit" value="Approve" /></b></center></td>
        </tr>

        </tbody>
    </table>
</form> 
```

php 将用户重定向到感谢页面并进行一些处理（如前所述，此代码在其他地方完美运行，但我将其包含在内，因此您可以看到 ACTION 不会进入某种黑洞）：

```
<?php

// Release user
ignore_user_abort(true);
header('Connection: close');
header('Content-Length: 0');
header('Location: confirm_acceptance.php');
flush();
...
?> 
```

它不执行 ACTION= 值中的 php 代码，而是重新加载页面并将 php 文件的名称附加到 URL。

关于在哪里寻找以找出问题所在的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:29:14.053

您需要为隐藏的输入添加一个值..

```
<input type="hidden" value="myrecordnumber" name="record_number"> 
```

你没有向 PHP 发送任何数据来处理..

# ruby-on-rails - TypeError: 无法将 oracle.sql.DATE 强制转换为 oracle.sql.DATE

> ID：15890112
> 
> 赞同：2
> 
> 时间：2013-04-08T22:25:43.900
> 
> 标签：ruby-on-rails, oracle, jruby, jboss7.x, jndi

环境：Rails 3.2.11 JRuby 1.7.2 activerecord-oracle_enhanced-adapter (1.4)

服务器：jboss-as 7.1 独立版，Java 1.6.2

问题在于以有效时间戳格式 (2013-04-12 08:00:00.000000) 将日期发送到请求参数中。在 rails 中执行此操作时会引发标题中的错误，这没有多大意义。

但是，当我在本机 jruby 和 java 1.7 中运行它时，不会发生这种情况。在我在我的服务器上安装更高版本的 java 之前寻找解决方法。

我可以通过将连接设置切换到连接字符串而不是 JNDI 来解决这个问题；所以怀疑这是jboss层某处的错误。

# java - 用于检查有效 XML 的本机 Java API

> ID：15890113
> 
> 赞同：0
> 
> 时间：2013-04-08T22:25:45.180
> 
> 标签：java, xml

如何确定`Document`Java 中的对象是否包含有效的 XML。构造对象时是否检查？

我似乎找不到任何关于此的信息

```
http://docs.oracle.com/javase/1.5.0/docs/api/org/w3c/dom/Document.html 
```

`Document`在不使用外部库的情况下如何确定是否拥有有效的 XML ？

注意：我通过使用 DOM XML 解析器从输入流中解析接收到此 Document 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:03:08.577

使用 Java DOM API。它可以处理任何有效的 XML 文档。有效的文件不会有任何例外。您不需要 DOM 的外部库。

如果出现错误，异常消息如下所示：

```
[Fatal Error] MyXMLFile.xml:6:2: The end-tag for element type "lastname" must end with a '>' delimiter.
The end-tag for element type "lastname" must end with a '>' delimiter.
BUILD SUCCESSFUL (total time: 0 seconds) 
```

# ajax - jQuery .append(html) 命令附加错误

> ID：15890115
> 
> 赞同：6
> 
> 时间：2013-04-08T22:25:58.437
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-3, jquery

我正在使用 jQuery/Ajax 调用将部分视图附加到表中。页面加载时，会正确创建局部视图。但是，一旦使用尝试将另一个项目附加到表中，尽管使用了完全相同的局部视图，但格式不正确。

这是桌子。加载后，项目将正确加载到页面上，如下图所示：

```
 <table id="fixedRows">
     <thead>
        <tr>
           <th>State Code</th>
           <th>Agent ID</th>
           <th></th>
           <th></th>
        </tr>
    </thead>
    <tbody>    
    @foreach (var item in Model.BankListAgentId)
    {                    
        if (!String.IsNullOrWhiteSpace(item.AgentId) && item.FixedOrVariable.Equals("F"))
        {
            @Html.EditorFor(model => item, "FixedPartialView")                     
        }
    }
</tbody>
</table>
<br />
<a href="#" class="addFixed">Add Another</a> 
```

![在此处输入图像描述](https://i.stack.imgur.com/itoVR.png)

单击`Add another`链接后，将激活此 jQuery/Ajax 调用

```
<script type="text/javascript">
    $(document).ready(function () {

        $(".addFixed").click(function () {
            //alert('test');
            event.preventDefault();        
            $.ajax({
                url: '@Url.Action("BlankFixedRow", "BankListMaster")',
                cache: false,
                success: function (html) { $("#fixedRows").append(html); }
            });
        });

        $("#addVariable").click(function () {
            event.preventDefault();
            $.ajax({
                url: '@Url.Action("BlankFixedRow", "BankListMaster")',
                cache: false,
                success: function (html) { $("#variableRows").append(html); }
            });
        });

    });

</script> 
```

那个 jQuery 从控制器调用这个方法

```
 public ViewResult BlankFixedRow()
    {
        SelectList tmpList = new SelectList(new[] { "AL", "AK", "AS", "AZ", "AR", "CA", "CO", "CT", "DE", "DC", "FM", "FL", "GA", "GU", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MH", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NA", "NM", "NY", "NC", "ND", "MP", "OH", "OK", "OR", "PW", "PA", "PR", "RI", "SC", "SD", "TN", "TX", "UT", "US", "VT", "VI", "VA", "WA", "WV", "WI", "WY" });
        ViewBag.StateCodeList = tmpList;

        return View("FixedPartialView", new BankListAgentId());
    } 
```

这称之为部分视图编辑（几个人注意到`id`标签中缺少`<tr>`，这只是这篇文章的复制/粘贴错误，实际代码有`id`标签）

```
 @model Monet.Models.BankListAgentId

@{
    Layout = null;
}
    @using (Html.BeginCollectionItem("BankListAgentId"))
    {
        <tr id="item-@Model.AgentId">
            <td>
                @Html.DropDownListFor(model => model.StateCode,
                    (SelectList)ViewBag.StateCodeList, Model.StateCode)
            </td>
            <td>
                @Html.EditorFor(model => model.AgentId)
                @Html.ValidationMessageFor(model => model.AgentId)
            </td>
            <td>
                <a href="#" class="deleteRow">delete</a>
            </td>
            @*<td><a href="#" onclick="$('#item-@Model.AgentId').parent().remove();" style="float:right;">Delete</a></td>*@
        </tr>
    } 
```

这是页面首次加载时调用的同一个局部视图，这也是我对点击`Add another`链接后的最终结果看起来像这样感到困惑的部分原因

![在此处输入图像描述](https://i.stack.imgur.com/eAsAv.png)

编辑

如果您点击`Add another`链接两次，这就是结果

![在此处输入图像描述](https://i.stack.imgur.com/lgCRJ.png)

编辑

我尝试了以下 jQuery`sucess`命令，但没有成功

```
success: function (html) { $("#fixedRows > tbody:last").append(html); }
success: function (html) { $("#fixedRows tr:last").after(html); }
success: function (html) { $("#fixedRows  > tbody").append(html); } 
```

这是`Add another`单击链接后呈现的 HTML。我在`<form>`其下方添加了表单的开始标记，以表明无处可找到新行。

```
<form action="/BankListMaster/Edit/11" method="post">        
    <fieldset>
        <legend>Stat(s) Fixed</legend>
        <table id="fixedRows">
            <tr>
                <th>State Code</th>
                <th>Agent ID</th>
                <th></th>
                <th></th>
            </tr>

            <tr id="item-1164998320">
                <td>
                    <select id="item_StateCode" name="item.StateCode"><option value="">HI</option>
                        <option>AL</option>
                        ..
                        <option>WY</option>
                    </select>
                </td>
                <td>
                    <input class="text-box single-line" id="item_AgentId" name="item.AgentId" type="text" value="1164998320" />
                    <span class="field-validation-valid" data-valmsg-for="item.AgentId" data-valmsg-replace="true"></span>
                </td>
                <td>
                    <a href="#" class="deleteRow">delete</a>
                </td>
            </tr>    
            <tr id="item-1164998219">
                <td>
                    <select id="item_StateCode" name="item.StateCode">
                        <option value="">HI</option>
                        <option>AL</option>
                        ..
                        <option>WY</option>
                    </select>
                </td>
                <td>
                    <input class="text-box single-line" id="item_AgentId" name="item.AgentId" type="text" value="1164998219" />
                    <span class="field-validation-valid" data-valmsg-for="item.AgentId" data-valmsg-replace="true"></span>
                </td>
                <td>
                    <a href="#" class="deleteRow">delete</a>
                </td>
            </tr>    
            <tr id="item-0352926603">
                <td>
                    <select id="item_StateCode" name="item.StateCode">
                        <option value="">GA</option>
                        <option>AL</option>
                        ..
                        <option>WY</option>
                    </select>
                </td>
                <td>
                    <input class="text-box single-line" id="item_AgentId" name="item.AgentId" type="text" value="0352926603" />
                    <span class="field-validation-valid" data-valmsg-for="item.AgentId" data-valmsg-replace="true"></span>
                </td>
                <td>
                    <a href="#" class="deleteRow">delete</a>
                </td>
            </tr>            
        </table>
        <br />
        <a href="#" class="addFixed">Add Another</a>
    </fieldset>
</form>     
<a href="#" class="addFixed">Add Another</a>
<form action="/BankListMaster/Edit/11" method="post"> 
```

编辑

`Add Another`这是单击链接后 Chrome 调试器中表格的屏幕截图。如您所见，从表中提取的数据已正确加载到相应`<tr>`的标签中，但是空行（通过与其余部分相同的部分视图发送）没有任何相同的表元素。然而，下面的屏幕截图显示了响应，其中确实包含`<tr>`标签

![在此处输入图像描述](https://i.stack.imgur.com/jAvrR.png)
![在此处输入图像描述](https://i.stack.imgur.com/nhGvP.png)

编辑

我`console.log(html)`在 Ajax 函数中添加了一行，`success`所以它现在显示为

```
 success: function (html) {
                console.log(html);
                $("#fixedRows > tbody").append(html);
            } 
```

这是控制台输出（为便于阅读而编辑的状态）

```
<input type="hidden" name="BankListAgentId.index" autocomplete="off" value="3f7e0a92-8f20-4350-a188-0725919f9558" />
        <tr>
            <td>
                <select id="BankListAgentId_3f7e0a92-8f20-4350-a188-0725919f9558__StateCode" name="BankListAgentId[3f7e0a92-8f20-4350-a188-0725919f9558].StateCode">
                    <option>AL</option>
                    ..
                    <option>WY</option>
                </select>
            </td>
            <td>
                <input class="text-box single-line" id="BankListAgentId_3f7e0a92-8f20-4350-a188-0725919f9558__AgentId" name="BankListAgentId[3f7e0a92-8f20-4350-a188-0725919f9558].AgentId" type="text" value="" />                 
            </td>
            <td>
                <a href="javascript:void(0)" class="deleteRow">delete</a>
            </td>               
        </tr> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T16:26:48.760

多么彻底的噩梦……

首先，在 Chrome 的调试器中返回为可查看的 HTML 很好，但是当我单击页面的“查看源代码”时，除了最初加载的内容外，我什么也看不到。找到[这个帖子后](https://stackoverflow.com/questions/8598836/jquery-dom-changes-not-appearing-in-view-source)，我发现这是正常的。然后我使用[了这个 Chrome 插件](https://chrome.google.com/webstore/detail/current-source-code/ljcogemcngolehdjglgiaphnmggiacca/related?hl=en)，终于看到`<tr>`and`<td>`标签被删除了。通过简单地在 append 语句中添加一个开始和结束标记，我将返回的项目附加到表中。

```
 $(".addFixed").click(function () {
        $.ajax({
            url: '@Url.Action("BlankFixedRow", "BankListMaster")',
            dataType: 'html',
            cache: false,
            success: function (html) {
                $("#fixedRows > tbody").append('<tr>' + html + '</tr>');
            }
        });
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T00:00:22.197

我在这里看到了一些东西。你在你`<tbody>`的一些代码中引用，但我在页面的任何地方都看不到它。所以首先我建议使用`<thead>`and `<tbody>`。在您的部分视图中，我看到`<tr "item-@Model.AgentId">`哪个应该有一个 id。

您还应该删除 onclick 处理程序和删除按钮，并将其与 JavaScript 的其余部分一起放入。而是在您的删除链接上设置一个类。

对于不需要 url 且仅用于附加 JavaScript 处理程序的链接，我建议使用`href="javascript:void(0)"`，因为这会阻止浏览器执行任何特殊操作，`href="#"`这样您就可以删除对`preventDefault()`.

至于你的问题的根源，`$("#fixedRows tbody").append(html)`是你想要的代码，所以不需要尝试`after()`。看起来你的 html 被剥离了。尝试将调用中的`dataType`属性设置为.`$.ajax()``html`

# java - 将外部库导入 Eclipse - Android

> ID：15890118
> 
> 赞同：1
> 
> 时间：2013-04-08T22:26:18.433
> 
> 标签：java, android, eclipse

我想在我的应用程序中使用[UnifiedPreference](https://github.com/saik0/UnifiedPreference)库。我已将该库导入我的工作区，然后通过将新项目添加为属性 -> Android 下的库，将其添加到我现有的项目中。但是，当我尝试构建来自 UnifiedPreference 项目的项目时，出现以下错误：

安慰：

```
[2013-04-08 23:06:29 - unified-pref-library] ERROR: In <declare-styleable> PreferenceHeader, unable to find attribute icon
[2013-04-08 23:06:29 - unified-pref-library] ERROR: In <declare-styleable> PreferenceHeader, unable to find attribute title 
```

相关的 logcat 错误似乎是：

```
PreferenceHeader_title cannot be resolved or is not a field UnifiedPreferenceHelper.java    /unified-pref-library/src/net/saik0/android/unifiedpreference   line 435    Java Problem
PreferenceHeader_title cannot be resolved or is not a field UnifiedPreferenceHelper.java    /unified-pref-library/src/net/saik0/android/unifiedpreference   line 299    Java Problem 
```

我是否错误地导入了库？我已经尝试清理和构建这两个项目而没有任何改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T08:53:22.857

想通了，似乎 UnifiedPreference 需要 ActionBarSherlock 的依赖项。感谢 tttony 让我走上正轨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T02:01:35.673

在 Eclipse 中：

1.  在`Package Explorer`
2.  右键单击您的`Proyect`>`Properties`
3.  选择：`Java Build Path`
4.  选择并启用`Android Dependencies`
5.  放在列表的顶部
6.  点击：`OK`

# apex-code - 在 Salesforce 中使用 apex 查询数据库

> ID：15890121
> 
> 赞同：0
> 
> 时间：2013-04-08T22:26:34.423
> 
> 标签：apex-code, force.com

com 和顶点触发器

我有两个对象，即**Customer_c**和**Order_c** 我正在尝试编写一个触发器来删除属于已处于非活动状态的客户的订单条目。

基本上我想触发**customer_c**表的更新

**从customer_c**中检索一个条目，其中**Active_c**（布尔值）在更新时为假，并获取该客户的“**名称**”并在**Order_c**表中查找并删除属于该客户的所有**“名称”（订单）。**

下面是我的触发代码。当我试图将触发器保存在 salesforce 中时。我收到以下错误：

```
Error: Compile Error: unexpected token: 'res2' at line 13 column 19 
```

有人可以帮我吗？

```
trigger NewCustomerActive on Customer__c(after update) {
  List<Customer__c> res2 = 
        [SELECT Name FROM Customer__c j WHERE j.Active__c = false];
  List<Order__c> res = 
        [SELECT Name FROM Order__c WHERE Customer__c = res2];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T09:22:50.567

将其更改为

```
trigger NewCustomerActive on Customer__c(after update) {
  List<Customer__c> res2 = 
        [SELECT Name FROM Customer__c j WHERE j.Active__c = false];
  List<Order__c> res = 
        [SELECT Name FROM Order__c WHERE Customer__c in:res2];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T14:48:42.930

或者如果你想保存 soql 语句：

```
trigger NewCustomerActive on Customer__c(after update) {
  List<Order__c> res = 
        [SELECT Name FROM Order__c WHERE Customer__r.Active__c = false];
} 
```

# httpresponse - 使用 HTTP 响应从 Google Storage 读取时接收部分文件（有时）

> ID：15890125
> 
> 赞同：1
> 
> 时间：2013-04-08T22:26:45.190
> 
> 标签：httpresponse, google-api-java-client, google-cloud-storage

我正在尝试从 Google Storage 读取文件并将其写入我们的文件系统 (HDFS) 中的文件。如果我运行它一段时间（比如说 7 天），有时我会得到完整的文件，其中的行与源上的内容匹配，有时我会得到部分文件（差异很大）。我粘贴在接受响应并将其写入文件的方法下方。任何有关如何进一步解决此问题的帮助或建议将不胜感激。

## 谢谢，

在调用此方法之前，我对响应状态代码进行了简单检查 -

```
if(response.getStatusCode() == 200 &&
                    StringUtils.equals(response.getContentType(), "application/zip")) {
                    writeHdfsFile(response, path);
}

private void writeHdfsFile(HttpResponse response, String path) throws IOException {
        final GZIPInputStream inputStream = new GZIPInputStream(response.getContent());
        Path filePath = new Path(path);
        final FSDataOutputStream outputStream = fileSystem.create(filePath, true);
        final byte[] buffer = new byte[1024];
        int length;
        try {
            while((length = inputStream.read(buffer)) > 0) {
                outputStream.write(buffer, 0, length);
            }
            outputStream.flush();
        } finally {
            inputStream.close();
            outputStream.close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T00:46:57.697

我们解决它的方法是先下载文件，然后解压缩并写入。基本上，将其分为两个步骤解决了该问题。如果其他人遇到同样的问题..

# python - 从包含空值的 CSV 中绘制列 - python

> ID：15890131
> 
> 赞同：0
> 
> 时间：2013-04-08T22:27:16.957
> 
> 标签：python, csv, null

我对python比较陌生，遇到了很多问题。我正在尝试使用包含许多空值的 csv 文件中的两列来创建一个图形。有没有办法将空值转换为零或删除某些列中包含空值的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:41:53.037

您提出的问题未详细说明，但我认为如果我们选择一个具体示例，您应该能够弄清楚如何使其适应您的实际用例。

因此，假设您的值都是浮点数的字符串表示形式，或者是表示 null 的空字符串：

```
A,B
1.0,2.0
2.0,
,3.0
4.0,5.0 
```

假设您正在使用 a 阅读此内容`csv.reader`，并且您正在使用某个函数逐个显式处理行`do_stuff_with`：

```
with open('foo.csv') as f:
    next(reader) # skip header
    for row in csv.reader(f):
        a, b = map(float, row)
        do_stuff_with(a, b) 
```

现在，如果您想将 null 值视为 0.0，您只需替换为返回non-empty和empty`float`的函数：`float(x)``x``0.0``x`

```
def nullable_float(x):
    return float(x) if x else 0.0

with open('foo.csv') as f:
    next(reader) # skip header
    for row in csv.reader(f):
        a, b = map(nullable_float, row)
        do_stuff_with(a, b) 
```

如果要跳过 B 列中包含空值的任何行，只需在进行转换之前检查 B 列：

```
with open('foo.csv') as f:
    next(reader) # skip header
    for row in csv.reader(f):
        if not row[1]:
            continue
        a, b = map(nullable_float, row)
        do_stuff_with(a, b) 
```

# javascript - 如何处理异步 getJSON 以复制 json 对象？

> ID：15890136
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:27:32.420
> 
> 标签：javascript, json

如何将接收到`JSON`的对象分配/克隆到以前定义的 JavaScript 对象`booksJSON`？我需要`booksJSON`为所有功能提供可访问性和可见性。

```
var booksJSON = {};
    function getBooks(){
    $.getJSON( "bookstore.json", function( json ) {

        $.each(json.books, function(i, json){
            renderEntity(json);
        });
        booksJSON  =  json;  // CLONE OBJECTS 
   });
} 
```

更新：

新代码：

```
 var booksJSON = {};
function getBooks(){
    return $.getJSON( "bookstore.json" );
}

$(document).ready(function(){

     getBooks();
     getBooks().done(function(json) {
        $.each(json.books, function(i, json){
            renderEntity(json);
        });
        booksJSON = json;
        alert(JSON.stringify(booksJSON));
    });

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:30:14.090

跟克隆没关系！`$.getJSON`是**异步**`$.getJSON`的，一旦函数完成，您就不能在数据可用之前使用数据，这就是成功回调的用途。

```
var booksJSON = {};
function getBooks(){
    $.getJSON( "bookstore.json", function( json ) {

        /* This is an async function, it executes at a later time */

        $.each(json.books, function(i, json){
            renderEntity(json);
        });
        booksJSON  =  json;  // here json is available
   });
   console.log( booksJSON ); // this happens before the above function, 
                             // so here booksJSON is still an empty object, 
                             // as nothing has been added yet
} 
```

你唯一能做的就是：

```
function getBooks(){
    return $.getJSON( "bookstore.json" );
}

getBooks().done(function(json) {
    $.each(json.books, function(i, json){
        renderEntity(json);
    });
}); 
```

如果这有帮助吗？

# mysql - 使用 node.js，我如何写入一个 MySQL 数据库并从另一个数据库读取？

> ID：15890138
> 
> 赞同：4
> 
> 时间：2013-04-08T22:27:47.507
> 
> 标签：mysql, node.js, npm

具体来说，我在谈论`MySQL Master-Slave(s) Replication`. 据我了解，我的所有读取都应该来自一个从属设备（或多个隐藏在负载均衡器后面的从属设备），而我所有的写入都应该直接发送到主控。

我该怎么做`node.js`？我正在使用[MySQL Active Record](https://github.com/martintajur/node-mysql-activerecord)包进行数据库查询，但我认为它本身并不支持它。我想我可以破解包裹并遇到某种`if is write-query, then use db1`情况，但我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:36:54.527

您可以像这样创建两个适配器：

```
var activeRecord = require('mysql-activerecord');
var readDB = new activeRecord.Adapter({
    server: 'slave.db.com',
    username: 'user',
    password: 'pass',
    database: 'db'
});
var writeDB = new activeRecord.Adapter({
    server: 'master.db.com',
    username: 'user',
    password: 'pass',
    database: 'db'
}); 
```

当你去做一个`update`或其他写作查询时，使用`writeDB`; 当你去做一个`select`使用`readDB`。

另一种选择是切换到另一个支持此功能的 ORM。我知道这不是一个很好的解决方案。[例如， Sequelize](http://www.sequelizejs.com/documentation#usage-read-replication)被广泛使用并开箱即用地支持这一点。

# android - JsonMappingException：找不到适合类型的构造函数

> ID：15890140
> 
> 赞同：2
> 
> 时间：2013-04-08T22:27:50.947
> 
> 标签：android, google-cloud-endpoints, google-eclipse-plugin

给定 api 端点

```
@ApiMethod(name = "sendChallenge", httpMethod = HttpMethod.POST)
public ExchangeList sendChallenge(ChallengeData request) throws Exception {
  return getFromDBThenProcess(request);
} 
```

前端（android）调用端点

```
ExchangeList transfers = service.sendChallenge(request).execute(); 
```

我从 LogCat 获得以下堆栈跟踪。

注意：我正在监视我的服务器控制台 (localhost)，但没有来电。

堆栈跟踪：

```
04-08 14:58:53.261: D/dalvikvm(940): GC_CONCURRENT freed 1394K, 15% free 12495K/14599K, paused 15ms+15ms, total 75ms
… //[many of those `freed` lines]
04-08 14:58:54.742: D/dalvikvm(940): GC_CONCURRENT freed 1394K, 15% free 12506K/14599K, paused 15ms+16ms, total 85ms
04-08 14:58:55.562: W/System.err(940): com.google.api.client.googleapis.json.GoogleJsonResponseException: 400 Bad Request
04-08 14:58:55.562: W/System.err(940): {
04-08 14:58:55.562: W/System.err(940):   "code": 0,
04-08 14:58:55.562: W/System.err(940):   "message": "com.google.appengine.repackaged.org.codehaus.jackson.map.JsonMappingException: No suitable constructor found for type [simple type, class com.myapi.games.message.ChallengeData]: can not instantiate from JSON object (need to add/enable type information?)\n at [Source: N/A; line: -1, column: -1]"
04-08 14:58:55.572: W/System.err(940): }
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.json.AbstractGoogleJsonClientRequest.newExceptionOnError(AbstractGoogleJsonClientRequest.java:111)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.json.AbstractGoogleJsonClientRequest.newExceptionOnError(AbstractGoogleJsonClientRequest.java:38)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest$1.interceptResponse(AbstractGoogleClientRequest.java:314)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:1060)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:412)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:345)
04-08 14:58:55.572: W/System.err(940):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.execute(AbstractGoogleClientRequest.java:463)
04-08 14:58:55.572: W/System.err(940):  at com.myapi.games.utils.sendChallenge.doInBackground(sendChallenge.java:70)
04-08 14:58:55.582: W/System.err(940):  at com.myapi.games.utils.sendChallenge.doInBackground(sendChallenge.java:1)
04-08 14:58:55.582: W/System.err(940):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-08 14:58:55.582: W/System.err(940):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
04-08 14:58:55.582: W/System.err(940):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
04-08 14:58:55.582: W/System.err(940):  at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-08 14:58:55.592: W/System.err(940):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
04-08 14:58:55.592: W/System.err(940):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
04-08 14:58:55.592: W/System.err(940):  at java.lang.Thread.run(Thread.java:856) 
```

这是关于一个 appengine 连接的 android 项目。一切都编译没有错误，等等。 POJO`ChallengeData`由其他三个 POJO 组成，类似于：

```
public class ChallengeData{

  Credit credit;
  Coin  coin;
  Friend friend;

  //getters and setters
} 
```

那么 Credit 和 Coin 都只包含简单的字段（即 int 和 String），但 Friend 包含一些简单的字段和进一步的 POJO。

我真的认为 JSON 的深度（即 POJO 关系）并不重要。但我包括所有相同的细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T12:58:24.803

您可能会收到此错误，因为您通过端点 api 发送图像并且您忘记将它们编码为`Base64`. 您必须将所有图像编码为 base64 字符串。这是一个带有代码片段的[链接](http://javarevisited.blogspot.com/2012/02/how-to-encode-decode-string-in-java.html)，显示了如何执行此操作。请记住，您正在从 byte 编码到`String`. 我猜的原因是因为您提到您的服务器没有受到任何打击，但您却遇到`400 Bad Request`错误，这意味着谷歌正在拦截您的呼叫并且无法解析请求。所以试试看。

# android - 在 Android (root) 中获取文件权限

> ID：15890142
> 
> 赞同：3
> 
> 时间：2013-04-08T22:27:58.180
> 
> 标签：android, permissions, root, chmod

在玩了一些有根设备后，我被困在文件上。假设我们在根文件夹的某处有一个文件，我想从我的应用程序中读取/写入。到目前为止我发现的唯一方法是更改​​文件权限，例如

```
String [] cmd = { "su", "-c", "chmod", "777", path};
Process process = new ProcessBuilder(cmd).start();
process.waitFor(); 
```

这很好用，问题是我想在完成后返回原始文件权限。

任何人都可以帮助我获得文件/目录的当前权限吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:41:49.187

在文件/目录上执行`ls -l`并解析输出

**由 OP 编辑​​：**解决方案在[这个线程](https://stackoverflow.com/questions/6896618/read-command-output-inside-su-process)中。这个答案只是把我推向了正确的方向。

# c - 如何设计信号安全的 shell 解释器

> ID：15890145
> 
> 赞同：3
> 
> 时间：2013-04-08T22:28:04.713
> 
> 标签：c, shell, signals

我现在拥有的代码将提示发送到标准输出，然后从标准输入读取一行。在任何时候接收`SIGINT`都会中断执行并退出程序。我不确定我应该在哪里捕获`SIGINT`，并且我知道当我当前的代码收到信号时我无法启动新的提示。是否有适当的方法来实现这一点（最终目标是让它像大多数 shell 一样工作（SIGINT 取消当前提示并开始一个新提示））？

此代码将在 Linux 上运行，但平台独立性越低越好。

`get_line`从标准输入读取一行到缓冲区并生成一个 char[]，分配给 line。
`split_args`取一行并将其转换为 char[] 数组，在空白处拆分。
`is_command_valid`确定用户是否键入了已知的内部命令。无法执行外部程序。

```
static int run_interactive(char *user)
{
    int done = 0;

    do
    {
        char *line, **args;
        int (*fn)(char *, char **);

        fprintf(stderr, "gitorium (%s)> ", user);
        get_line(&line);

        if (line[0] == '\0')
        {
            free(line);
            break;
        }

        split_args(&args, line);

        if (!strcmp(args[0], "quit") || !strcmp(args[0], "exit") ||
            !strcmp(args[0], "logout") || !strcmp(args[0], "bye"))
            done = 1;
        else if (NULL == args[0] ||
            (!strcmp("help", args[0]) && NULL == args[1]))
            interactive_help();
        else if ((fn = is_command_valid(args)) != NULL)
            (*fn)(user, args);
        else
            error("The command does not exist.");

        free(line);
        free(args);
    }
    while (!done);

    return 0;
} 
```

这是两个最重要的辅助函数

```
static int split_args(char ***args, char *str)
{
    char **res = NULL, *p = strtok(str, " ");
    int n_spaces = 0, i = 0;

    while (p)
    {
        res = realloc(res, sizeof (char*) * ++n_spaces);

        if (res == NULL)
            return GITORIUM_MEM_ALLOC;

        res[n_spaces-1] = p;
        i++;
        p = strtok(NULL, " ");
    }

    res = realloc(res, sizeof(char*) * (n_spaces+1));
    if (res == NULL)
        return GITORIUM_MEM_ALLOC;

    res[n_spaces] = 0;
    *args = res;

    return i;
}

static int get_line(char **linep)
{
    char *line = malloc(LINE_BUFFER_SIZE);
    int len = LINE_BUFFER_SIZE, c;
    *linep = line;

    if(line == NULL)
        return GITORIUM_MEM_ALLOC;

    for(;;)
    {
        c = fgetc(stdin);
        if(c == EOF || c == '\n')
            break;

        if(--len == 0)
        {
            char *linen = realloc(*linep, sizeof *linep + LINE_BUFFER_SIZE);
            if(linen == NULL)
                return GITORIUM_MEM_ALLOC;

            len = LINE_BUFFER_SIZE;
            line = linen + (line - *linep);
            *linep = linen;
        }

        *line++ = c;
    }

    *line = 0;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:36:35.303

如果我对您的理解正确，您想知道如何处理信号以及收到信号后该怎么做。

建立信号处理程序的方式是使用[`sigaction()`](http://man7.org/linux/man-pages/man2/sigaction.2.html). 您没有说明您所在的平台，所以我假设 Linux，尽管`sigaction()`它是由 POSIX 标准定义的，并且应该可以在大多数其他平台上使用。

有多种方法可以做到这一点。一种方法是建立一个信号处理程序，它简单地将一个全局变量设置为 1，表示信号已被捕获。然后在你的`getline()`函数中建立一个检查是否`SIGINT`被捕获，如果它被返回`NULL`并允许`run_interactive()`再次运行。

以下是捕捉信号的方法：

```
#include <signal.h>

static int sigint_caught = 0;

static void sigint_handler(int sig) {
  sigint_caught = 1;
}

struct sigaction sa;
sigemptyset(&sa.sa_mask);
sa.sa_flags = 0; // or SA_RESTART if you want to automatically restart system calls interrupted by the signal
sa.sa_handler = sigint_handler;

if (sigaction(SIGINT, &sa, NULL) == -1) {
  printf("could not establish handler\n");
  exit(-1); // or something
} 
```

然后也许在`getline()`无限循环中，您将建立检查以查看是否`SIGINT`已被捕获：

```
for (;;) {
  if (sigint_caught) {
    return NULL;
  }

  // ... 
```

然后在您的`run_interactive()`通话中，您可以通过检查检查返回值*以*查看是否`SIGINT`被捕获：

```
// ...

get_line(&line);

if (line == NULL && sigint_caught) {
  sigint_caught = 0; // allow it to be caught again
  free(line);
  continue; // or something; basically go to the next iteration of this loop
} else if (line[0] == '\0') {
  free(line);
  break;
} else {
  // rest of code 
```

没有测试它，所以我不能保证它会起作用，因为你的问题非常广泛（必须查看更多的代码等），但希望它能让你对你能做什么有足够的了解你在你的情况。这可能是一个非常幼稚的解决方案，但它可能会满足您的需求。对于更强大的东西，也许可以查看流行 shell 的源代码，如 bash 或 zsh。

例如，可能发生的一件事是`fgetc()`由于标准输入中没有新数据而可能会阻塞，并且可能是在发送信号时。`fgetc()`会被打断`errno`，`EINTR`所以你可以在下面添加一个检查`getline()`：

```
c = fgetc(stdin);

// make sure to #include <errno.h>
if (errno == EINTR && sigint_caught)
  return NULL; 
```

*仅当您不*设置`sa_flags`为 时才会发生这种情况`SA_RESTART`。如果你这样做了，那么`fgetc`应该自动重新启动并继续阻塞，直到收到新的输入，这可能是也可能不是你想要的。

# c - 调试我的c程序，猜数字游戏

> ID：15890146
> 
> 赞同：0
> 
> 时间：2013-04-08T22:28:06.260
> 
> 标签：c

我需要帮助调试这个程序，但我不知道出了什么问题。我正在使用 putty 和 Vi 编辑器来运行我的程序。这是我的代码：

```
#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <malloc.h>

int main(void) { 

    int playerNumber = 0;
    int number = 0;
    int playerInput = 0;    
    int guess = 0;
    char input;
    char str[6] = {0};
    int playerA = 0;
    int playerB = 0;
    int passA = 3;
    int passB = 3;
    int i = 0;
    int playerTurn = 0;

    srand(time(NULL));
    playerNumber = 1 + rand() % 2; /* Random number is generated */

    printf("\nPlayer %d goes fist\n", playerNumber);

    printf("Player Number?\n");  

    while (playerNumber != playerInput) {
        scanf("%d", &playerInput);

        if (playerNumber != playerInput) printf("You Have to wait your turn.\nPlayer number?\n");

        playerNumber = playerA;

        if (playerA = 1) playerB = 2;
        else playerB = 1;

        srand(time(NULL));
        number = 0 + rand() % 100; /* Random number is generated */

        printf("Enter Your Guess, 0 - 100 or Pass: "); /* Input your guess */

        while(number != guess) {

        for(i = 1; i < 1000; i++) {
            if (i%2 == 1) playerTurn = playerA;
            else PlayerTurn = playerB;
            scanf("%s", str);

            if (strcmp(str, "pass") == 0) printf("Player Number?\n");
            else {
                guess = atoi(str);
                if(guess < number) /* if the guess is lower, output: the guess is to low */
                    printf("Your guess was to low.\n Player Number:\n ");

                else if(guess > number) /* if the guess is higher, output: the guess is to high */
                    printf("Your guess was to high.\n Player Number:\n ");

                else /* is the guess is equial to the random number: Success!! */
                    printf("Yes!! you got it!\n");
                return 0;
            }
        }
    }
} 
```

}

这是我得到的错误： project2total.c: In function `main': project2total.c:49: error:`PlayerTurn' undeclared (first use in this function) project2total.c:49: error: (每个未声明的标识符只报告一次 project2total.c:49: error: for它出现的每个函数。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:29:14.763

C 区分大小写。在您的函数中，没有`PlayerTurn`声明，但您似乎已经声明了`playerTurn`. 假设这实际上是您要引用的变量，只需将大写 P 更正为小写即可。:)

# javascript - 使用 FileReader、图像和

> ID：15890151
> 
> 赞同：3
> 
> 时间：2013-04-08T22:28:24.240
> 
> 标签：javascript, html5-canvas, filereader, memory-profiling

我正在处理图像多上传，这听起来不错，但是..一如既往的内存问题。

脚本目标是在上传 100 多张图片 (300Mb+) 时存活下来。因此，如果您发现（我仍然是 javascript 蹩脚）任何问题，请给我一个建议。谢谢。

我的代码：

```
CFileReader.prototype.proccessFile = function(cb) {
    // this means File
    var reader = new FileReader();
    reader.readAsDataURL(this);
    reader.onload = (function (f) { 
        return function(e) {
            var image = new Image();
            image.src = e.target.result;
            image.onload = (function(f) {
                return function() {
                    var maxWidth = 700,
                        maxHeight = 700,
                        imageWidth = this.width,
                        imageHeight = this.height;

                    if (imageWidth > imageHeight) {
                      if (imageWidth > maxWidth) {
                        imageHeight *= maxWidth / imageWidth;
                        imageWidth = maxWidth;
                      }
                    }
                    else {
                      if (imageHeight > maxHeight) {
                        imageWidth *= maxHeight / imageHeight;
                        imageHeight = maxHeight;
                      }
                    }
                    var canvas = document.createElement('canvas');
                    canvas.width = imageWidth;
                    canvas.height = imageHeight;

                    var ctx = canvas.getContext("2d");
                    ctx.drawImage(this, 0, 0, imageWidth, imageHeight);
                    if(typeof cb == 'function') {
                        cb(f,canvas.toDataURL());
                    }
                    delete canvas;
                    delete ctx;
                    return;
                }
            })(f);

        };
    })(this);    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-30T18:12:37.357

我认为 window.createObjectURL 比 FileReader 快，你应该同时使用这两种文件阅读器的后备......你也可以检查每个操作的性能，因为每个浏览器都有差异，例如[http://jsperf.com/canvas-image-调整大小](http://jsperf.com/canvas-image-resizing) 并且不要忘记出于内存原因撤销ObjectURL ...您也可以使用网络工作者 [http://www.html5rocks.com/en/tutorials/file/filesystem-sync/#toc-readingsync](http://www.html5rocks.com/en/tutorials/file/filesystem-sync/#toc-readingsync)

```
 if("createObjectURL" in window || "URL" in window && 
    "createObjectURL" in window.URL || "webkitURL" in window && 
    "createObjectURL" in window.webkitURL) { 
        if("createObjectURL" in window) { 
            // Chrome exposes create/revokeObjectURL directly on window 
            objURL = window.createObjectURL(file); 
        } else if("webkitURL" in window) { 
            // Chrome exposes create/revokeObjectURL on the new  webkitURL API 
            objURL = window.webkitURL.createObjectURL(file); 
        } else { 
            // FF4 exposes create/revokeObjectURL on the new URL API 
            objURL = window.URL.createObjectURL(file); 
        } 

        // RESIZE image 
        // STORED IN    
        // objURL
} else { 
    // fallback to FileReader for FF3.6             
    reader = new FileReader();
    reader.onload =  function(event) {                                                                  
        // RESIZE image 
        // STORED IN    
        // event.target.result                 
    }

    reader.onprogress = function (evt) {
       if (evt.lengthComputable) {
            var percentLoaded = Math.round((evt.loaded / evt.total) * 100);
            console.log(percentLoaded);
       }
    }
    reader.readAsDataURL(file);                                                                 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T00:53:15.870

好吧，几天的谷歌搜索，几个小时的寻找最佳解决方案。（不是有史以来最好的，但最好的，我能想到的）。如果有人有更好的答案，或者只是给出坏名声。

目标一：将所有内容存储在全局空间中（画布、阅读器、画布上下文、图像）

```
window.reader = new FileReader();
window.canvas = document.createElement('canvas');
window.image = new Image();
window.ctx = window.canvas.getContext("2d"); 
```

目标二：使用 canvas.toBlob 方法（目前仅在 Firefox 中实现，您需要一些 polyfill）

目标三：增加一些等待，这我不能只是确定性地解释，它只是经验性的。目标是，允许浏览器在调用之间调用垃圾收集器。

所以这是我的最后一个开发脚本：

```
window.prepareFile = function (index,cb) {
    // this means file html element
    var res = window.configuration.photo.resolution.split(":");

    //var res = [300,200];
    var reader = window.reader;
    $('#fm-up-status > tr[for="'+this.files[index].name+'"]').children('td')[3].innerHTML = 'Zpracovávám';
    reader.readAsDataURL(this.files[index]);
    reader.onload = (function (f) { 
        return function(e) {
            setTimeout(function(){
                var image = window.image;
                image.src = e.target.result;
                image.onload = (function(f) {
                    return function() {
                        var maxWidth = parseInt(res[0]),
                            maxHeight = parseInt(res[1]),
                            imageWidth = this.width,
                            imageHeight = this.height;
                        if (imageWidth > imageHeight) {
                            if (imageWidth > maxWidth) {
                              imageHeight *= maxWidth / imageWidth;
                              imageWidth = maxWidth;
                            }
                        }
                        else {
                            if (imageHeight > maxHeight) {
                              imageWidth *= maxHeight / imageHeight;
                              imageHeight = maxHeight;
                            }
                        }
                        var canvas = window.canvas;
                        canvas.width =0;
                        canvas.width = imageWidth;
                        canvas.height = imageHeight;
                        window.ctx.drawImage(this, 0, 0, imageWidth, imageHeight);
                        canvas.toBlob(
                            function (blob) {
                                var formData = new FormData();

                                formData.append('file', blob, f.name);
                                cb(f.name,formData);
                            },
                            'image/jpeg'
                        );
                        return;
                    }
                })(f);
                return;
            },500);
        };
    })(this.files[index]);

    return;
} 
```

然后你可以简单地以普通形式（multipar）上传数据，如下所示：

```
window.uploader = function(filename,formdata,cb) {

    $('#fm-up-status > tr[for="'+filename+'"]').children('td')[3].innerHTML = 'Uploaduji';
    xhr = jQuery.ajaxSettings.xhr();
    if (xhr.upload) {
        xhr.upload.addEventListener('progress', function (evt) {
            if (evt.lengthComputable) {  
                var floatComplete = evt.loaded / evt.total;
                window.uploadProgress(filename,floatComplete);

            }
        }, false);
    }  
    provider = function () {
        return xhr;
    };    
    $.ajax({
        url: window.uploadUri,
        type: "POST",
        data: formdata,
        xhr: provider,
        processData: false,
        contentType: false,
        dataType: "json",
        success: function (res,state,xhr) {
            cb(false,res,xhr);
            return;
        },
        error: function (xhr, state, err) {
            cb(err,false,xhr)
            return;
        }
    });    
}; 
```

这段代码实际上还没有准备好生产，它是一个简单的概念验证

# php - 页面刷新时在侧边栏中随机旋转 PHP 文件

> ID：15890154
> 
> 赞同：0
> 
> 时间：2013-04-08T22:28:41.117
> 
> 标签：php, jquery

我有 4 个 php 文件，里面都有一个小的 PHP 和 jQuery 游戏。

文件如下：

```
/game1.php
/game2.php
/game3.php
/game4.php 
```

每次刷新页面时，我都希望其中一款游戏显示在侧边栏中。当页面再次刷新时，不同的游戏等等。

有没有办法通过页面刷新时的某种查询将文件随机包含在侧边栏中，如果是这样，有人可以帮我写代码吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T23:04:20.073

```
$games = array('game1.php','game2.php','game3.php','game4.php');
session_start();
$used = array();
if (isset($_SESSION['used'])){
    $used = $_SESSION['used'];
}
$usable = array_diff($games,$used);
if (sizeof($usable)==0){
    $usable = $games;
    $_SESSION['used'] = array();
}

$inUse = $usable[array_rand($usable)];
$_SESSION['used'][] = $inUse;

include($inUse); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T22:31:53.120

尝试：

```
include '/game' . rand(1, 4) . '.php'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T22:32:12.760

```
$FileNames = array ('File1.php','File2.php','File3.php','File4.php'); // Can later be autodetected if file structure gets too big      
$FileNames = array_rand($FileNames); 
foreach ($FileNames AS $Links){ 
     echo $Links; 
    } 
```

如果您希望使这些可点击：

```
foreach ($FileNames AS $Links){ 
     echo "<a href=".$Links.">".$Links."</a>"; 
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-08T22:37:39.500

```
$file_array= array('game1.php','game2.php','game3.php','game4.php');
$rand = rand (0, count ($file_array)); 
include ($file_array[$rand]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-08T22:44:03.053

我认为您会在会话中找到答案，因为您不希望上次查看的游戏出现在下一页刷新中：

```
//Fill in array
$games = array('game1' => 'PONG', 'game2' => 'Donkey Kong', 'game3' => 'Patience', 'game4' => 'LoL');
//Delete the current game from the array
unset($games[$_SESSION['currentGame']]);
//Shuffle the array and pick the last one 
$game = end(shuffle($games));
include($game.'.php');
//Update session for next page refresh
$_SESSION['currentGame'] = $game; 
```

# sql - 将 ER 图转换为关系模型

> ID：15890155
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:28:47.850
> 
> 标签：sql, database, relational-database, entity-relationship

我知道如何将实体集、关系等转换为关系模型，但我想知道的是，当给出整个图表时我们应该怎么做？我们如何转换它？我们是否为每个关系和每个实体集创建一个单独的表？例如，如果我们得到以下 ER 图：

![在此处输入图像描述](https://i.stack.imgur.com/I2s9c.jpg)

我对此的解决方案如下：

```
 //this part includes the purchaser relationship and policies entity set

CREATE TABLE  Policies (
  policyid  INTEGER,
  cost  REAL,
  ssn  CHAR(11)  NOT NULL,
  PRIMARY KEY (policyid).
  FOREIGN KEY (ssn) REFERENCES Employees,
  ON DELETE CASCADE)

 //this part includes the dependents weak entity set and beneficiary relationship

 CREATE TABLE Dependents (
  pname  CHAR(20),
  age  INTEGER,
  policyid  INTEGER,
  PRIMARY KEY (pname, policyid).
  FOREIGN KEY (policyid) REFERENCES Policies,
  ON DELETE CASCADE)

 //This part includes Employees entity set

 CREATE TABLE Employees(
   ssn Char(11),
   name char (20),
   lot INTEGER,
   PRIMARY KEY (ssn) ) 
```

我的问题是：

```
1)Is my conversion true?
2)What are the steps for converting a complete diagram into relational model. 
Here are the steps that i follow, is it true?
    -I first look whether there are any weak entities or key constraints. If there
     are one of them, then i create a single table for this entity set and the related        
     relationship. (Dependents with beneficiary, and policies with purchaser in my case)
    -I create a separate table for the entity sets, which do not have any participation  
     or key constraints. (Employees in my case)
    -If there are relationships with no constraints, I create separate table for them.
    -So, in conclusion, every relationship and entity set in the diagram are included 
     in a table. 
```

如果我的步骤不正确或者我遗漏了什么，请你写下转换的步骤吗？另外，如果一个关系只有参与约束，而没有关键约束，我们该怎么办？我们是否再次为相关实体集和关系创建单个表？

我很感激任何帮助，我是数据库新手，正在尝试学习这种转换。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T23:09:41.877

嗨@bigO，我认为可以肯定地说您的转换是正确的，并且您遵循的步骤是正确的。但是，从实施的角度来看，可能还有改进的余地。您实现的更多是逻辑模型而不是物理模型

将代理实例标识符添加到物理表是常见的做法，这是大多数持久性引擎的一般要求，正如@Pieter Geerkens 指出的那样，有助于提高数据库效率。实例 ID 的值，例如 EmployeeId (INT) 将由数据库在插入时自动生成。这也有助于解决@Pieter Geerkens 指出的 SSN 问题。将 Id 添加为所有表的第一列，我遵循*tablename* Id 的约定。将您当前的主键变成辅助键（自然键）。

然后添加 Id 使得有必要实现一个 DependentPolicy 交集表

```
DependentPolicyId, (PK)
PolicyId,
DependentId 
```

然后，您可能需要考虑什么是 Dependent 表的自然键。

我注意到您有年龄作为属性，您应该考虑这是创建保单时的年龄还是受抚养人的实际年龄，在这种情况下您应该使用出生日期。

您可以考虑的其他装饰是创建日期和修改日期。

我通常也喜欢在表格中使用单数，即员工而不是员工。

欢迎来到数据建模和设计的世界。

# php - 准备好的语句更新

> ID：15890158
> 
> 赞同：0
> 
> 时间：2013-04-08T22:29:00.570
> 
> 标签：php, mysqli, prepared-statement

当我尝试使用 mysqli 准备好的语句更新查询时，出现以下错误。错误消息有什么问题，为什么它是意外的？任何帮助。

```
Parse error: syntax error, unexpected '$prob' (T_VARIABLE) 
```

这是查询

```
$mysqli = new mysqli("localhost", "root", "", "newlogin");
        if ($mysqli->connect_errno) {
        echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
        }
        $check = $mysqli->prepare("select * from `vpb_uploads` where `username` = ? and `firstname` = '' and `image_one` != ''");
        $check->bind_param('s', $username);
        $check->execute();
        $check->store_result();

        if($check->num_rows < 1)
        {
            echo '<div class="vpb_error_info" align="left">Sorry, It seems you have not added any file yet.<br>Please click on the Add Files button to first of all add at least one file before submitting your details. Thanks...</div>';
        }
        else
        {
        $firstname = trim(strip_tags($_POST["firstname"]));
        $lastname = trim(strip_tags($_POST["lastname"]));

        if( $prob = $mysqli->prepare("update `vpb_uploads` set `firstname` = ?, `lastname` = ? where `username` = ? and `firstname` = '' and `image_one` != ''")
        $prob->bind_param('sss', $firstname, $lastname, $username);
        $prob->execute();
        )

        {
                echo '<font style="font-size:0px;">success</font>';
                echo '<div class="vpb_error_info" align="left">Congrats <b>'.$firstname.' '.$lastname.'</b>, your details have been submitted successfully. Thanks...</div>';
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:30:33.503

乍一看，您的错误似乎在第 19 行：

```
if($prob = $mysqli->prepare("
  UPDATE `vpb_uploads`
  SET `firstname` = ?,
      `lastname` = ?
  WHERE `username` = ?
  AND `firstname` = ''
  AND `image_one` != ''
")

  $prob->bind_param('sss', $firstname, $lastname, $username);
  $prob->execute();

) 
```

您在语句本身中有`bind_param`and`execute`函数。`if`它需要是：

```
if($prob = $mysqli->prepare("
  UPDATE `vpb_uploads`
  SET `firstname` = ?,
      `lastname` = ?
  WHERE `username` = ?
  AND `firstname` = ''
  AND `image_one` != '';
") {
  $prob->bind_param('sss', $firstname, $lastname, $username);
  $prob->execute();
} 
```

如果您对括号感到困惑，您的结束代码应如下所示：

```
$mysqli = new mysqli("localhost", "root", "", "newlogin");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}
$check = $mysqli->prepare("select * from `vpb_uploads` where `username` = ? and `firstname` = '' and `image_one` != '';");
$check->bind_param('s', $username);
$check->execute();
$check->store_result();

if($check->num_rows < 1) {
    echo '<div class="vpb_error_info" align="left">Sorry, It seems you have not added any file yet.<br>Please click on the Add Files button to first of all add at least one file before submitting your details. Thanks...</div>';
} else {
  $firstname = trim(strip_tags($_POST["firstname"]));
  $lastname = trim(strip_tags($_POST["lastname"]));
}

if($prob = $mysqli->prepare("update `vpb_uploads` set `firstname` = ?, `lastname` = ? where `username` = ? and `firstname` = '' and `image_one` != '';")) {
  $prob->bind_param('sss', $firstname, $lastname, $username);
  $prob->execute();
  echo '<font style="font-size:0px;">success</font>';
  echo '<div class="vpb_error_info" align="left">Congrats <b>'.$firstname.' '.$lastname.'</b>, your details have been submitted successfully. Thanks...</div>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:31:33.253

试试这个代码：

```
$mysqli = new mysqli("localhost", "root", "", "newlogin");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}
$check = $mysqli->prepare("select * from `vpb_uploads` where `username` = ? and `firstname` = '' and `image_one` != ''");
$check->bind_param('s', $username);
$check->execute();
$check->store_result();

if($check->num_rows < 1){
     echo '<div class="vpb_error_info" align="left">Sorry, It seems you have not added any file yet.<br>Please click on the Add Files button to first of all add at least one file before submitting your details. Thanks...</div>';
} else {
    $firstname = trim(strip_tags($_POST["firstname"]));
    $lastname = trim(strip_tags($_POST["lastname"]));

    $prob = $mysqli->prepare("update `vpb_uploads` set `firstname` = ?, `lastname` = ? where `username` = ? and `firstname` = '' and `image_one` != ''") ;
    if ($prob){
        $prob->bind_param('sss', $firstname, $lastname, $username);
        $success = $prob->execute();
        if ($success){
            echo '<font style="font-size:0px;">success</font>';
            echo '<div class="vpb_error_info" align="left">Congrats <b>'.$firstname.' '.$lastname.'</b>, your details have been submitted successfully. Thanks...</div>';
        }
     }
} 
```

# ios - 在 ViewController 之间传递 UIImage

> ID：15890174
> 
> 赞同：0
> 
> 时间：2013-04-08T22:29:57.070
> 
> 标签：ios, objective-c, ios6, uiimage

在我的第一个视图控制器中，我有一个在实现文件中合成的 UIImage 属性。在推送的第二个视图控制器中，我在那里创建了一个 UIImage 对象，同时将它设置为来自第一个视图控制器的 UIImage 属性。最后，我解散了第二个视图控制器。但是，在关闭视图控制器后，图像似乎没有保存。我的理解是，由于 UIImage 是一个指针，因此数据传递是通过引用进行的，并且由于控制器被解除，所以 UIImage 也是如此。这是正确的，有没有更好的方法来完成这项任务？供您参考，我使用的是 ARC。

在第一个视图控制器（firstVC）中，

```
@property (strong, nonatomic) UIImage *image; 
```

在第二个视图控制器中，

```
[firstVC setImage:self.ivarUIImageView.image]; 
```

其中 ivarUIImageVIew 定义为：

```
@property (strong, nonatomic) IBOutlet UIImageView *ivarUIImageView; 
```

现在让我们在第三个视图控制器中说，我在 viewDidLoad 方法中：

```
imgView = [[UIImageView alloc] initWithImage:firstVC.image]; 
```

其中 imgView 定义为：

```
@property (strong, nonatomic) IBOutlet UIImageView *imgView; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:32:08.663

您想通过创建属性来确保`UIImage`由第一个视图控制器保留`strong`。此外，如果在 a 中显示它，`UIImageView`您必须将 UIImageView 设置`image`为新图像才能看到 UI 中反映的变化。

# php - 将消息发送到另一个 PHP 文件

> ID：15890182
> 
> 赞同：4
> 
> 时间：2013-04-08T22:30:37.340
> 
> 标签：php

是否可以让一个 PHP 文件在另一个 PHP 文件上向特定用户发送“消息”？

请注意，“消息”需要能够被已经运行的 PHP 文件接收，因此简单地调用其他文件并没有什么不同。下图演示了我想要做的事情：

![在此处输入图像描述](https://i.stack.imgur.com/JQf86.png)

在此示例中，用户 1 调用“send.php”，随后将消息发送到用户 1、2 和 4 的“receive.php”实例。这可能实现吗？

### 附加信息

我无法将消息记录在文件或数据库之类的中心位置，因为我最终会每 100 毫秒查询一次消息，这可能会使数据库/文件系统过载。我需要它是即时的。

此外，我不能使用会话或 cookie，因为如前所述，消息需要发送给多个用户。最后，接收的 PHP 文件在用户离开页面之前不会终止（它实际上是一个 HTML5`eventsource`文件）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:49:28.017

好的，可能有更轻量级的方法，但尝试使用具有发布-订阅功能的消息代理（在[JMS](https://en.wikipedia.org/wiki/Java_Message_Service)世界中称为主题）。它们专门用于将大量消息从服务器快速可靠地传输到客户端。

为此类设置创建测试系统的一种简单方法是使用支持[STOMP](https://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol)的消息代理（请参阅[此处](http://stomp.github.io/implementations.html)以获取可用解决方案的列表）并将其与 PHP STOMP 客户端（同一页面上提供的列表）结合使用。

请务必阅读[有关持久订阅的评论](http://stomp.fusesource.org/documentation/php/book.html#Durable_Subscribers)：由于您的 PHP 脚本很可能不会在发送消息的确切时间运行，因此您需要模拟持久订阅的功能。我不知道上面提到的页面上描述的所有代理，但是[ActiveMQ](https://en.wikipedia.org/wiki/Apache_ActiveMQ)知道，并且它已经存在了相当长的一段时间，并且拥有非常好的声誉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:36:18.070

您可以使用[会话](http://www.php.net/manual/en/features.sessions.php)或[数据库](http://php.net/manual/en/faq.databases.php)来跨页面保存数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T22:36:31.633

> 附加信息：我无法将消息记录在文件或数据库等中心位置，因为我最终会每 100 毫秒查询一次消息，这可能会使数据库/文件系统过载。我需要它是即时的。

这可以做到，但这不是最佳实践。您可以为每条消息创建一个单独的文件。这是非常糟糕的做法。

就集中式数据库的问题而言，您永远不会知道。这或许能应付你的要求，试一试就知道了。

没有程序员在第一次尝试时就做好了一切。他们尝试了一些新的东西，但犯了一个错误……每个人在寻找应用程序的最佳方法时都会犯错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-08T22:34:15.857

PHP 不能那样工作。它运行脚本并终止。您需要查找会话或使用数据库。如果您想花哨，请使用 jQuery 和 Ajax。

# multithreading - Qt 插槽同时断开连接并从不同的线程调用

> ID：15890191
> 
> 赞同：0
> 
> 时间：2013-04-08T22:31:38.550
> 
> 标签：multithreading, qt, qthread

我是 Qt 的新手。我在合理的时间内没有找到答案，所以决定在这里提问。

我有一个线程，让我们`Thread1`用具有连接插槽的 Qt 对象来调用它。信号从同一个线程 ( `Thread1`) 发出。我正在将此插槽与另一个`Thread2`.

这个操作线程安全吗？如果发出信号并且插槽恰好同时断开，是否有任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:46:36.883

只看文档，对我来说看起来很安全：

[http://qt-project.org/doc/qt-4.8/qobject.html](http://qt-project.org/doc/qt-4.8/qobject.html)

> 注意：该类中的所有函数都是可重入的，但 connect()、connect()、disconnect() 和 disconnect() 也是线程安全的。

[http://qt-project.org/doc/qt-4.8/qobject.html#disconnect](http://qt-project.org/doc/qt-4.8/qobject.html#disconnect)

> 注意：这个函数是线程安全的。

当您将一个线程的信号连接到另一个线程的插槽时，还要确保您使用的是队列连接。如果在连接期间两个对象碰巧在同一个线程中，则自动连接可能会出现异常（并进行直接连接）。

希望有帮助。

编辑：有关线程安全的更多信息：

[http://qt-project.org/doc/qt-4.8/threads-reentrancy.html](http://qt-project.org/doc/qt-4.8/threads-reentrancy.html)

[http://qt-project.org/doc/qt-4.8/threads-qobject.html](http://qt-project.org/doc/qt-4.8/threads-qobject.html)

# ios - 带有日期的 if 语句

> ID：15890205
> 
> 赞同：0
> 
> 时间：2013-04-08T22:32:37.157
> 
> 标签：ios, objective-c, cocoa-touch

我想要做的是使用大于小于号的日期制作一个 if 语句。出于某种原因，只有大于号才有效。这是我的代码：

```
NSDate *currDate = [NSDate date];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
[dateFormatter setDateFormat:@"HHmm"];
NSString *dateString = [dateFormatter stringFromDate:currDate];
NSLog(@"%@",dateString);

if (dateString < @"0810" && dateString > @"0800") {
    NSLog(@"Homeroom");
}
else {
    NSLog(@"no");
} 
```

如果时间是 8:03，此代码的输出将是：

```
2013-04-08 08:03:47.956 Schedule2.0[13200:c07] 0803
2013-04-08 08:03:47.957 Schedule2.0[13200:c07] no 
```

如果我要这样做，那么只有更大的地方，然后像这样签名：

```
if (dateString > @"0800") {
    NSLog(@"Homeroom"); 
}
else {
    NSLog(@"no");
} 
```

输出将是这样的：

```
2013-04-08 08:03:29.748 Schedule2.0[14994:c07] 0803
2013-04-08 08:03:29.749 Schedule2.0[14994:c07] Homeroom 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:55:40.813

创建一个时间为 8:10 的 NSDate 对象和一个 8:00 的对象。现在您可以将给定日期与这两个日期进行比较

```
if(([date0800 compare:date] == NSOrderingAscending) && [date0810 compare:date] == NSOrderingDescending) )
{
    // date is between the other
} 
```

* * *

要创建边界日期，您可以这样做

```
NSDate *date = [NSDate date]; // now
NSDateComponents *components = [[NSCalendar currentCalendar] components:( NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit ) fromDate:date];
components.hour = 8;
components.minute = 0;

NSDate *date0800 = [[NSCalendar currentCalendar] dateFromComponents: components];
components.minute = 10;
NSDate *date0810 = [[NSCalendar currentCalendar] dateFromComponents: components]; 
```

* * *

如果您坚持使用 and 之类的运算符`<`，`>`则可以使用日期对象的时间间隔。

```
if(([date0800 timeIntervalSince1970] < [date timeIntervalSince1970]) && ([date0810 timeIntervalSince1970] > [date timeIntervalSince1970]))
{
    // date lays between the other two
} 
```

但要小心检查`==`它，因为它可能由于舍入错误而出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:39:15.147

在这里，您将字符串对象与`<`and进行比较`>`，这并不符合您的期望。您可以使用`NSDateComponents`获取小时和分钟来比较这些：

```
NSDate *today = [NSDate date];

NSCalendar *gregorian = [[NSCalendar alloc]

                     initWithCalendarIdentifier:NSGregorianCalendar];

NSDateComponents *components =

                [gregorian components:(NSHourCalendarUnit | NSMinuteCalendarUnit ) fromDate:today];

NSInteger hour = [weekdayComponents hour];

NSInteger minutes = [weekdayComponents minute];

BOOL homeroom = (hour == 8) && (minute < 10); 
```

`compare:`或者，您可以使用 NSDateFormater 并使用该函数为 8:10 和 8:00 创建特定的 NSDate 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T22:39:06.897

`NSString`对象是对象，当您使用 C 比较运算符（==、>、< 等）比较对象时，您是在比较它们的地址，而不是它们的值。您需要使用`compare`，例如：

```
if ([dateString compare:@"0810"] == NSOrderedAscending &&
    [dateString compare:@"0800"] == NSOrderedDescending) { ... 
```

`NSDate`尽管如果您想比较日期和时间，我建议在大多数情况下转换为对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T22:39:22.073

您不能使用 > 或 < 来比较字符串对象。这实际上比较了指针，所以我们不会讨论为什么 > “有效”和 < “无效”。

对于这种日期比较，请使用 NSDateComponents [NSDateComponents Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateComponents_Class/Reference/Reference.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-08T23:27:57.977

这是我在 NSDate 上写的一个类别的要点。我发现它使我的代码更具可读性。

[https://gist.github.com/nall/5341477](https://gist.github.com/nall/5341477)

```
@interface NSDate(SZRelationalOperators)
-(BOOL)isLessThan:(NSDate*)theDate;
-(BOOL)isLessThanOrEqualTo:(NSDate*)theDate;
-(BOOL)isGreaterThan:(NSDate*)theDate;
-(BOOL)isGreaterThanOrEqualTo:(NSDate*)theDate;
@end 
```

# jquery - 更改 fancybox 设计 - 添加另一个 div 而不会晃动窗口

> ID：15890206
> 
> 赞同：0
> 
> 时间：2013-04-08T22:32:45.137
> 
> 标签：jquery, html, css, fancybox, fancybox-2

我在 Fancybox 窗口上有 JW 播放器。一切正常，现在我只有一个设计问题：

当播放器窗口显示时（当它触发时），它会“从下到上”移动，从下到上到窗口。这是因为我在播放器下添加了另一个 div。我怎样才能解决这个问题？这是一个演示示例：[http ://teodore.ge/test/demo/](http://teodore.ge/test/demo/)

我做了这样的：

```
<script>

      $(".fancybox").fancybox({
        fitToView: false, // to show videos in their own size
        content: '<div></div>', // create temp content
        scrolling: 'no', // don't show scrolling bars in fancybox
        afterLoad: function () {

          // get dimensions from data attributes
          var $width = $(this.element).data('width'); 
          var $height = $(this.element).data('height');

          var link=$(this.element).context.attributes.yutubelink.nodeValue;

          this.content = ' <embed type="application/x-shockwave-flash"  src="player.swf" width="640" height="383"    style="undefined"  allowfullscreen="true" allowscriptaccess="always" wmode="opaque" flashvars="file='+link+'&amp;skin=nacht.zip&amp;autostart=true">'; 
        },
        afterShow: function(){
          var toolbar = "<div id='tools'>" + $("#appendContent div").eq(this.index).html() + "</div>";
           $(".fancybox-outer").append(toolbar);
          }
      });   

</script>

<div id="appendContent" style="display: none;  width: auto; height: auto;">
    <div > 1111   That div  is the problem <br><br><br>  1111111 <br> <br> </div>
    <div> 2222:  That div  is the problem  <br><br><br> 2222222 <br> <br> </div>
</div>

    <a class="fancybox"  yutubeLink="http://www.youtube.com/watch?v=p3iYnHx8P0s" > 
    <img src=" 1.jpg"  width="360" height="240"></a><br>

    <a class="fancybox"  yutubeLink="http://www.youtube.com/watch?v=USgLNBsnRGo"> 
    <img src=" 2.jpg" width="360" height="240"></a> <br> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T21:06:48.593

我移动了在播放器旁边添加新 div 的功能。我将函数从 afterShow() 移动到 afterLoad() 函数。加载后添加 div 会导致该问题（它会更改 div 的位置）。因为玩家必须在屏幕的中心，当我添加一个新的 div 时，那个位置正在改变。

# matlab - 载波调制解调中的低通滤波器

> ID：15890216
> 
> 赞同：1
> 
> 时间：2013-04-08T22:33:16.707
> 
> 标签：matlab, signal-processing, lowpass-filter

我正在设计一个项目，其中阵列通过[正交幅度调制](http://en.wikipedia.org/wiki/Quadrature_amplitude_modulation%27)（QAM）调制器，然后进行载波调制，使其可使用[sound()](http://www.mathworks.se/help/matlab/ref/sound.html)命令播放，然后将其解调回用于 QAM 解调。

首先，我使用了标准的 QAM 调制方式：

```
M = 16;
x = randint(5000, 1, M);
y = modulate(modem.qammod(M), x); 
```

然后，我编写了自己的载波调制函数：

```
function [out] = carriermodulation(x)
fs = 16000;
T = 1.0 / 4000;
fc = 8000;
Q = real(x);
I = imag(x);
t = 0:T:(size(x))*T;
C1 = zeros(size(x), 1);
C2 = zeros(size(x), 1);
for i = 1:size(x)
    C1(i) = I(i)*sin(2*pi*(fc)*t(i));
    C2(i) = Q(i)*sin(2*pi*fc*t(i) + pi/2);
end

out = C1 + C2; 
```

到目前为止没有问题。但是当我完成解调功能时，我发现结果与原始值不同（QAM 调制器输出）。

```
function [out] = carrierdemodulation(x)
fs = 16000;
T = 1.0 / 4000;
fc = 8000;
t = 0:T:(size(x))*T;
A1 = zeros( size(x), 1);
A2 = zeros( size(x), 1);
for i = 1:size(x)
    A1(i) = x(i)*sin( 2*pi*(fc)*t(i));
    A2(i) = x(i)*cos( 2*pi*(fc)*t(i));
end
A1 = sqrt(A1);
A2 = sqrt(A2);
out = A1 + A2; 
```

我认为我的调制部分是正确的。我认为我唯一的问题是我没有用于解调的[低通滤波器](http://en.wikipedia.org/wiki/Low-pass_filter)(LPF)。而且我不应该直接计算 A1 和 A2。如何将 LPF 添加到我的解调代码中，以使输出与原始代码相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T15:41:02.997

相干解调后，您需要在接收器处使用低通滤波器，这是正确的。但是你的调制也有问题。在您的示例中，符号率`Rs`小于角载波频率`w_c`，这可能会导致接收器处的频谱重叠。因此，信息信号的重构将是不可能的。另外，在您的示例`fc * T = 2`中。这意味着正弦函数的参数是 2pi 的整数倍，因此始终为零。

你需要的是一个脉冲整形器（可以作为一个低通滤波器实现）在带宽为 的发射机上`w_g >= R/2`。它应该是所谓的[奈奎斯特](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)低通。载波频率必须满足`w_c > w_g`。

我编写了一个[MATLAB](http://en.wikipedia.org/wiki/MATLAB)脚本，它可以进行脉冲整形、调制、解调、滤波和采样，以便可以重建传输的信号。

首先，我们定义参数，创建随机位并按照您已经完成的方式进行映射。使用非常简单的脉冲响应来进行脉冲整形，即矩形脉冲。在现实世界中，我们在这里从数字域到模拟域，但由于这是一个计算机模型，我们用具有采样频率的离散信号来表示模拟信号`f_s`。脉冲整形器很简单，因为它只是重复每个采样`L`时间。

```
M = 16; % QAM order
fs = 16000; % Sampling frequency in Hz
Ts = 1/fs; % Sampling interval in s
fc = 1000; % Carrier frequency in Hz (must be < fs/2 and > fg)
Rs = 100; % Symbol rate
Ns = 20; % Number of symbols

x = randint(Ns, 1, M);
y = modulate(modem.qammod(M), x);

L = fs / Rs; % Oversampling factor

% Impulse shaping
y_a = reshape(repmat(y', L, 1), 1, length(y)*L); 
```

现在调制。我使用了满足上述条件的载波频率：它高于信号带宽，仍然可以用所使用的采样频率来表示。

```
%% Modulation
I = real(y_a);
Q = imag(y_a);
t = 0 : Ts : (length(y_a) - 1) * Ts;
C1 = I .* sin(2*pi * fc * t);
C2 = Q .* cos(2*pi * fc * t);
s = C1 + C2; 
```

解调很简单...

```
%% Demodulation
r_I = s .* sin(2*pi * fc * t);
r_Q = s .* -cos(2*pi * fc * t); 
```

为了在解调后去除频谱支路，`2f_c`需要一个低通滤波器。我使用 MATLAB [FDATool](http://www.mathworks.se/products/signal/examples.html?file=/products/demos/shipping/signal/introfdatooldemo.html)创建过滤器和以下代码的一部分。记住：信号带宽是`Rs/2`，不需要的支流从 开始`2*fc - Rs/2`。这是如何找到的`Fpass`。`Fstop`（稍微放宽这些要求可能会很有用。）

```
%% Filter

% Design filter with least-squares method
N     = 50;           % Order
Fpass = Rs/2;         % Passband Frequency
Fstop = 2*fc - Rs/2;  % Stopband Frequency
Wpass = 1;            % Passband Weight
Wstop = 1;            % Stopband Weight

% Calculate the coefficients using the FIRLS function.
b  = firls(N, [0 Fpass Fstop fs/2]/(fs/2), [1 1 0 0], [Wpass Wstop]);

% Filtering
w_I = filter(b, 1, r_I);
w_Q = filter(b, 1, r_Q); 
```

滤波后，我们仍然需要对接收到的信号进行采样。这里只是一个下采样。我使用了相位偏移`L/2`来避免滤波器转换。

```
%% Sampling
u_I = downsample(w_I, L, L/2);
u_Q = downsample(w_Q, L, L/2); 
```

最后，绘制星座图，得到一个漂亮的 16-QAM 星座：

```
plot(u_I, u_Q, '.'); 
```

[你可以在这里](http://pastebin.com/PJBb2xZN)找到完整的代码。

您的问题涉及[DSP](http://en.wikipedia.org/wiki/Digital_signal_processing)和 MATLAB 编程的许多主题。我无法在任何地方详细说明。如果您有关于 16-QAM 调制和解调的具体问题，可以去 Stack Exchange 站点*[Signal Processing](https://dsp.stackexchange.com/tour)*。

# actionscript-3 - 将 flash as3 代码保存到 jpeg 文件中

> ID：15890222
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:33:53.617
> 
> 标签：actionscript-3, flash, jpeg

如何将所有代码保存为 JPEG？它将被输入到我的报告中，我打算单手打印屏幕并进行编辑，但这将花费很长时间。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:11:15.440

在您的代码编辑器中，您可以转到每个类文件并单击`File > print`。然后打印到文件（可能是 pdf）。您需要为每个类文件执行此操作。如果您需要它们的 JPG 格式，那么您可以在 photoshop 中打开一个 pdf，然后另存为 JPG。

# hbase - 有什么命令可以让我了解 Hbase 的表格大小吗？

> ID：15890223
> 
> 赞同：11
> 
> 时间：2013-04-08T22:33:56.970
> 
> 标签：hbase

有什么命令可以让我了解 Hbase 的表格大小吗？我使用 Hbase 来保存来自 Nutch 的爬网数据。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-10T15:17:53.743

如果您在 hadoop 上运行 hbase，则可以使用以下命令

```
hadoop fs -du [path] 
```

`[path]`必须用 in 的值`hbase.rootdir`替换`hbase-site.xml`

输出将如下所示：

> $ hadoop fs -du /hbase

```
4056        hdfs://127.0.0.1:9000/hbase/-ROOT-

22307       hdfs://127.0.0.1:9000/hbase/.META.

0           hdfs://127.0.0.1:9000/hbase/.corrupt

0           hdfs://127.0.0.1:9000/hbase/.logs

0           hdfs://127.0.0.1:9000/hbase/.oldlogs

1716        hdfs://127.0.0.1:9000/hbase/Table1

1472        hdfs://127.0.0.1:9000/hbase/Table2

1498        hdfs://127.0.0.1:9000/hbase/Table3

1320        hdfs://127.0.0.1:9000/hbase/SampleTable 
```

此处显示的大小以字节为单位。

如果您在本地文件系统（OS 文件系统）上运行 hbase，那么您可以使用普通`du`命令。

这将使您大致了解 Hbase 中表的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T09:31:40.787

要计算表中的行/列，您需要运行 map/reduce 程序。HBase 附带 am/r 可以看到[这里](http://hbase.apache.org/book/ops_mgt.html#rowcounter)

# java - 检查单词是否属于语言环境

> ID：15890224
> 
> 赞同：0
> 
> 时间：2013-04-08T22:33:57.577
> 
> 标签：java, locale

我有一个文件，其中大部分单词（短语）属于特定语言（比如说西班牙语）。在同一个文件中有一些属于另一种语言的单词（比如说英语）。有没有办法使用java找到这几个词？语言环境类可能会有所帮助吗？这两种语言就是一个例子。它可能是俄语作为主要语言，而英语是我想识别为异常的语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:44:13.657

在这种情况下，语言环境类不会有任何帮助。最好的办法是将西班牙语和英语词典放入 HashSets 中，然后在遍历文件时检查集合成员资格，或者如果词典太大而无法放入内存，则将它们放入数据库中。

# c# - 在 IBM MQ 中访问编码字符集 ID

> ID：15890226
> 
> 赞同：0
> 
> 时间：2013-04-08T22:34:12.540
> 
> 标签：c#, .net, websphere, ibm-mq

当我从其编码字符集 id 为 819 的远程队列管理器中读取消息时，发送的消息有

> CodedCharSetId=1208 ，是否通过 7.x 客户端连接到 6x（远程队列）？

我如何在导出队列中获得 819 而不是 1208，我不想在消息中硬编码

`mqQMgr.CodedCharSetId =819;`

相反，我想从属性/属性访问这个编码的字符集 id（这样，它可以是动态的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T04:14:53.023

这可能会帮助您：

如果您使用 MQ .NET 客户端，则字符集将始终为 Unicode、1208，因为 .NET 应用程序始终以 Unicode 运行。

MQMessage 类的 ReadString 和 ReadLine 方法将消息中的数据转换为 Get 时指定的 CharacterSet，而 WriteString 和 WriteLine 方法将给定数据转换为 Put 时指定的 CharacterSet。

# javascript - 使用 javascript 检查 facebook 登录

> ID：15890229
> 
> 赞同：0
> 
> 时间：2013-04-08T22:34:23.360
> 
> 标签：javascript, facebook, login

我创建了这个 facebook api 脚本：

```
FB.api('/me/likes/112234512170409',function(response) {
    if( response.data ) {
        if( !isEmpty(response.data) )
            alert('You are a fan!');
        else
            alert('Not a fan!');
    } else {
        alert('ERROR!');
                 alert("Error: " + response.error.message);

    }
}); 
```

但我总是收到错误消息：错误：必须使用活动访问令牌...这是我的完整代码：[http](http://pastebin.com/zfS6rgpj) ://pastebin.com/zfS6rgpj 我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:06:43.943

由于您的脚本位于正文而不是头部，并且您只需执行所需的代码而不是在稍后调用的函数中定义它，因此您在文档加载时立即运行 API 请求（代码的第 37 行） ，这是在您登录之前（因此，没有有效的令牌）。我会用一个函数包装你的 API 调用，以便你以后可以调用它，例如

```
var callMeLater = function {
   FB.api('/me/likes/112234512170409',function(response) {
   ...
}; 
```

并`callMeLater();`在您登录后拨打电话。

如果您还没有检查过，也许第 4 步和第 5 步可能对您有所帮助[http://developers.facebook.com/docs/howtos/login/getting-started/](http://developers.facebook.com/docs/howtos/login/getting-started/)

让我知道您的问题是否解决了，或者您是否需要我澄清任何事情:)

# php - 使用 simpleXMLobject 创建 php 数组

> ID：15890231
> 
> 赞同：0
> 
> 时间：2013-04-08T22:34:23.827
> 
> 标签：php, simplexml, cakephp-1.3

我正在尝试将此数组（$resdata）与对象（SimpleXMLElement）一起放入一个php数组中：

```
$resdata = 
array(59) { 
[0]=> ...
[10]=> object(SimpleXMLElement)#294 (28) { 
["reservation_id"]=> string(7) "8210614" 
["event_id"]=> string(6) "279215"
["space_reservation"]=> array(2) { 

    [0]=> object(SimpleXMLElement)#344 (9) { 
    ["space_id"]=> string(4) "3760" 
    ["space_name"]=> string(9) "205" 
    ["formal_name"]=> string(33) "Center" } 

    [1]=> object(SimpleXMLElement)#350 (9) { 
    ["space_id"]=> string(4) "3769" 
    ["space_name"]=> string(9) "207" 
    ["formal_name"]=> string(32) "Right" } } } 
} 
```

我试过了：

```
$res = (array)$resdata;
$reservation = $res['reservation'];
$result = array();

foreach ($reservation as $key => $value){
$res = array($value);
$spid = $res[0]->space_reservation->space_id;
echo $value->event_id."<br />";
echo $spid."<br />";
} 
```

这仅输出第一个 space_id，我需要获取“space_reservation”数组中的所有 space_id。并非所有记录都有多个 space_id。任何为我指明正确方向的帮助表示赞赏。不确定我是否应该使用 xpath，但无论如何我都需要重新编写我的 foreach 语句。

我希望能够将所有对“object(SimpleXMLElement) *#_* (#)”的引用转换为“array(#)”

```
[10]=> array (28) { 
["reservation_id"]=> string(7) "8210614" 
["event_id"]=> string(6) "279215"
["space_reservation"]=> array(2) { 

    [0]=> array (9) { 
    ["space_id"]=> string(4) "3760" 
    ["space_name"]=> string(9) "205" 
    ["formal_name"]=> string(33) "Center" } 

    [1]=> array (9) { 
    ["space_id"]=> string(4) "3769" 
    ["space_name"]=> string(9) "207" 
    ["formal_name"]=> string(32) "Right" } } } 
} 
```

我的 cakephp 1.3 控制器中的功能是这样的：

```
$xml = simplexml_load_string($string);
$this->data['events']= $xml->children();
$resdata = $this->data['events'];
$this->set('resdata',$resdata); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:47:48.677

我认为这应该做你正在寻找的：

```
foreach ($resdata as $res) {
    echo $res->event_id . '<br />';
    foreach ($res->space_reservation as $reservation) {
        echo $reservation->space_id . '<br />';
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:49:27.273

谷歌搜索并找到任何 SimpleXMLElement 到数组转换的通用解决方案：

```
function xml2array($xml) {
  $arr = array();
  foreach ($xml as $element) {
    $tag = $element->getName();
    $e = get_object_vars($element);
    if (!empty($e)) {
      $arr[$tag] = $element instanceof SimpleXMLElement ? xml2array($element) : $e;
    }
    else {
      $arr[$tag] = trim($element);
    }
  }
  return $arr;
} 
```

# sql - 查询占用太多

> ID：15890232
> 
> 赞同：1
> 
> 时间：2013-04-08T22:34:28.863
> 
> 标签：sql

我试图在我的条件返回结果时执行更新，问题是当我测试查询时它永远不会完成。这是查询；

```
While(select COUNT(*) from Agreement as agr where agr.Id in (
  select toa.Id from Agreement_TemporaryOnceAgreement as toa where toa.Executed =1)
and agr.EndingDate is null) > 0
begin
DECLARE @AgreementID int;
SET @AgreementID = 
(
select top 1 agr.id from Agreement as agr where agr.Id in (
  select toa.Id from Agreement_TemporaryOnceAgreement as toa where toa.Executed =1)
and agr.EndingDate is null
)
update Agreement SET EndingDate = (
  select tado.Date from TemporaryAgreementsDateOfExecution tado
    where tado.AgreementId = CAST(@AgreementID AS INT))
where Agreement.Id = CAST(@AgreementID AS INT);
end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:54:58.190

你不需要循环。与此类似的单个更新查询应该可以完成工作。

```
update a
set EndingDate = tado.date
from Agreement a join TemporaryAgreementsDateOfExecution tado
on a.AgreementId = tado.AgreementId

join Agreement_TemporaryOnceAgreement toa
on a.Id = toa.id

where EndingDate is null
and toa.Executed = 1 
```

根据您使用的 RDBMS，可能会有细微的变化。

# java - 错误：无法找到或加载主类

> ID：15890233
> 
> 赞同：0
> 
> 时间：2013-04-08T22:34:29.550
> 
> 标签：java

我是 Java 编程新手，并将其作为学校项目。这是我写的代码

```
public static void main(String args[])
import javax.swing.*;
import java.awt.event.*;
public class SleepCounter extends JFrame {
  private JPanel panel;
  private JLabel messageLabel;
  private JTextField sleepTextField;
  private JTextField sleepAnswerField;
  private final int WINDOW_WIDTH = 310;
  private final int WINDOW_HEIGHT = 100;
  public SleepCounter() {
    setTitle("Sleep Counter");
    setSize(WINDOW_WIDTH, WINDOW_HEIGHT);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    buildPanel();
    add(panel);
    setVisible(true);
  }
  private void buildPanel() {
    dailyLabel = new JLabel("Enter Sleep " + "in hours");
    hourTextField = new JTextField(10);
    CalcButton = new JButton("Calculate");
    CalcButton.addActionListener(new CalcButtonListener());
    panel = new JPanel();
    panel.add(dailyLabel);
    panel.add(sleepTextField);
    panel.add(CalcButton);
    panel.add(sleepAnswerField);
  }
  private class CalcButtonListener implements ActionListener {
    public void actionPerformer(ActionEvent e) {
      String input;
      int total;
      input = sleepTextField.getText();
      for (int i = 0; i < 7; i++); {
        input += total;
      }
      JOptionPane.showMessageDialog(null, "The total amount of sleep for " + (i + 1) + "days is" + total);
      if (int i > 7) {
        double avg = (total / 7);
        JOptionPane.showMessageDialog(null, "The avg amount of sleep for 7 days is" + avg);
      }
    }
  }
} 
```

运行时，我收到一条错误消息：

```
Error: Could not find or laod main class Graduation Project. 
```

我已经对该网站进行了搜索，并尽我所知检查了答案。我将不胜感激您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:49:39.597

您已将 main 方法放在类之外

```
 public class  YourClass
 {
  public static void main(String args[])
   {  
   }
  } 
```

把它放在里面，记住在这些导入之前你不能放任何东西

```
import javax.swing.*;
import java.awt.event.*; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:37:20.873

从您的格式中很难分辨。但是，如果您要运行一个名为“Graduation”的课程，您的代码将必须如下所示：

```
public class Graduation{ 

  public static void main (String[] args){
  }

} 
```

您需要 Graduation 类，并且它需要有一个符合该要求的 main 方法。从您的示例中不清楚您的方法实际上是在一个类中。是在编译吗？

# c# - 带有编码问题的多语言网址

> ID：15890238
> 
> 赞同：1
> 
> 时间：2013-04-08T22:34:51.380
> 
> 标签：c#, asp.net-mvc, encoding, localization, multilingual

我有一个多语言的 asp.net mvc 4 Web 应用程序。出于 SEO 目的，网址已本地化为网站的语言。

这引起了一些问题，特别是对于西里尔文。url 在地址栏和标记中的编码很奇怪。从动作链接生成的 URL 也有这样的编码。

有什么方法可以防止这种情况并确保 url 继续使用未编码的文本并且对最终用户意味着更多？

# c# - Toolstrip.Items.AddRange(ToolStripCollection) 有奇怪的行为

> ID：15890241
> 
> 赞同：0
> 
> 时间：2013-04-08T22:35:13.200
> 
> 标签：c#, winforms, toolstrip

我正在处理的应用程序的一部分涉及动态 ToolStrip，其中根据应用程序的状态添加和删除项目。目前，我将这些项目存储在各种独立的 ToolStrips 中，并在必要时简单地添加和删除它们。我遇到的问题是这样的：

- 如果新的工具提示有一个项目并且我使用方法 AddRange，它将从新的工具条中删除，使其项目计数为 0。

- 如果新的工具条有多个项目并且我使用 AddRange，则会引发 ArgumentOutOfRange 错误。

ToolStripItemCollections 有什么我不知道是什么原因造成的，还是有更好的方法来进行编程？

编辑：快速示例代码

```
ToolStrip oldToolStrip = new ToolStrip();
ToolStrip newToolStrip = new ToolStrip();

newToolStrip.Items.Add(new ToolStripTextBox());
newToolStrip.Items.Add(new ToolStripButton());

oldToolStrip.Items.AddRange(newToolStrip.Items); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T12:35:04.207

控件存在错误： [http ://www.pcreview.co.uk/forums/possible-bug-toolstrip-items-addrange-t2900540.html](http://www.pcreview.co.uk/forums/possible-bug-toolstrip-items-addrange-t2900540.html)

# extjs - Sencha 原生应用错误 st-res/templates/stbuild_template_sim.app/ 不存在

> ID：15890242
> 
> 赞同：2
> 
> 时间：2013-04-08T22:35:16.540
> 
> 标签：extjs, sencha-touch-2, sencha-cmd

我正在尝试使用 sencha app build native 从 sencha cmd 构建本机应用程序，并且在到达这部分之前一切似乎都运行良好：

运行本机打包程序失败 [ERR] 源目录：st-res/templates/stbuild_template_sim.app/ 不存在 将 st-res/templates/stbuild_template_sim.app/ 复制到 /home/dethstar/public_html/muhapp/build/muhapp/native 时出错/muhapp.app/ 打包应用失败

但是我无法在网上或在触摸目录中找到有关这些文件的任何信息。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T15:07:14.243

我必须将 st-res 和 stbuild 链接到我的工作目录中：

```
ln -s /opt/Sencha/Cmd/4.0.0.203/stbuild/stbuild
ln -s /opt/Sencha/Cmd/4.0.0.203/stbuild/st-res 
```

“/opt/Sencha/Cmd/4.0.0.203/”需要替换为您的 Sencha CMD 安装路径。

# r - 了解 R 中 data.table 的引用属性

> ID：15890245
> 
> 赞同：6
> 
> 时间：2013-04-08T22:35:30.553
> 
> 标签：r, data.table

只是为了自己清理一些东西，我想更好地了解何时制作副本以及何时不在`data.table`. 正如这个问题所指出的，[确切地了解何时 data.table 是对另一个 data.table 的引用（相对于副本）](https://stackoverflow.com/questions/10225098/understanding-exactly-when-a-data-table-is-a-reference-to-vs-a-copy-of-another)，如果只是运行以下命令，那么您最终会修改原始数据：

```
library(data.table)

DT <- data.table(a=c(1,2), b=c(11,12))
print(DT)
#      a  b
# [1,] 1 11
# [2,] 2 12

newDT <- DT        # reference, not copy
newDT[1, a := 100] # modify new DT

print(DT)          # DT is modified too.
#        a  b
# [1,] 100 11
# [2,]   2 12 
```

但是，如果这样做（例如），那么您最终会修改新版本：

```
DT = data.table(a=1:10)
DT
     a
 1:  1
 2:  2
 3:  3
 4:  4
 5:  5
 6:  6
 7:  7
 8:  8
 9:  9
10: 10

newDT = DT[a<11]
newDT
     a
 1:  1
 2:  2
 3:  3
 4:  4
 5:  5
 6:  6
 7:  7
 8:  8
 9:  9
10: 10

newDT[1:5,a:=0L]

newDT
     a
 1:  0
 2:  0
 3:  0
 4:  0
 5:  0
 6:  6
 7:  7
 8:  8
 9:  9
10: 10

DT
     a
 1:  1
 2:  2
 3:  3
 4:  4
 5:  5
 6:  6
 7:  7
 8:  8
 9:  9
10: 10 
```

据我了解，发生这种情况的原因是，当您执行`i`语句时，会`data.table`返回一个全新的表，而不是对旧的 select 元素占用的内存的引用`data.table`。这是正确和真实的吗？

编辑：对不起，我的意思`i`不是`j`（在上面改变了这个）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-08T22:56:13.093

`newDT`在第二个示例中创建时，您正在评估`i`（不是`j`）。`:=`在`j`参数中通过引用分配。语句中没有等价物`i`，因为自引用过度分配列，但不分配行。

A`data.table`是一个列表。它的长度 == 列数，但已过度分配，因此您可以添加更多列而无需复制整个表（例如使用`:=`in `j`）

如果我们检查 data.table，那么我们可以看到`truelength`( `tl = 100`)——这是列指针槽的数量

```
 .Internal(inspect(DT))
@1427d6c8 19 VECSXP g0c7 [OBJ,NAM(2),ATT] (len=1, tl=100)
  @b249a30 13 INTSXP g0c4 [NAM(2)] (len=10, tl=0) 1,2,3,4,5,... 
```

在 data.table 每个元素都有长度`10`，和`tl=0`。目前没有方法可以增加`truelength`列的数量以允许通过引用附加额外的行。

从`?truelength`

> 目前，只是列指针的列表向量被过度分配（即 truelength(DT)），而不是列向量本身，这将在未来允许快速行 insert()

当您评估`i`时，`data.table`不会检查您是否以与原始相同的顺序返回所有行（然后仅在这种情况下不复制），它只是返回副本。

# java - java 集合中哪里需要使用 collections.sort() 以及可比较和比较器接口？

> ID：15890247
> 
> 赞同：2
> 
> 时间：2013-04-08T22:35:46.427
> 
> 标签：java, collections

我通过一些文章对收藏有了一些了解。
但是我很困惑应该在哪里实现 collections.sort() 方法以及在哪里需要使用可比较的接口（compareTo() 和比较器接口（compare()）。

用于比较此和另一个参考对象的可比较接口，但用于比较两个对象的比较器。

我想知道具体哪些情况需要使用方法？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T22:41:43.547

你不应该实施`Collections.sort()`；此方法[内置于 Java 中](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)。调用该方法而不提供 a`Comparator`以按*自然顺序排序*，如果它是`Comparable`. 否则，提供一个`Comparator`排序`Comparator`的方式。

如果该类具有*自然排序*，您应该让该类实现`Comparable`并提供一个方法，如javadocs 中所示。一个例子是 for和，它当然有一个自然的数学排序。`compareTo`*[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)`Integer``Double`*

 *您应该创建一个实现的类，[`Comparator`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)当您无法使对象的类进行排序`Comparable`时，或者当您想要呈现一个可以替代自然排序的排序时，或者当您想要在没有自然排序时强加一个顺序时。一个例子是颠倒自然顺序（例如，从最大到最小降序排序）。另一个例子是具有多个字段的数据对象，您希望在多个字段上可排序，例如带有and的`Person`对象：您可以有一个首先排序的对象，另一个首先排序的对象。`firstName``lastName``Comparator``lastName``firstName`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:40:49.960

当我无法访问要比较的类的代码时，比较器对我来说很有意义：例如，您可能需要为 String 实现自定义比较器。

当我需要对我自己的自定义对象的列表进行排序时，我编写它们来实现接口 Comparable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T22:50:19.850

让我们看看我是否可以用简单的话来解释它：

该`compareTo()`方法旨在将对象的*活动*实例与对象的另一个实例进行比较。所以，假设你有这个示例类：

```
public class Spam implements Comparable<Spam> {
    private int eggs;
    public Spam(int eggs) {
        this.eggs = eggs;
    }
    public int compareTo(Spam otherSpam) {
        return otherSpam.eggs - this.eggs;
    }
    public int getEggs() {
        return eggs;
    }
} 
```

假设您`Spam`在代码中的某处使用此类：

```
...
if(spam1.compareTo(spam2) == 0) {
    System.out.println("Both spams are equal");
} else {
    if(spam1.compareTo(spam2) > 0)
        System.out.println("'spam2' is bigger than 'spam1'");
    else
        System.out.println("'spam2' is smaller than 'spam1'");
}
.... 
```

因此，`compareTo()`用于确定一个类的两个实例是否相等，如果它们不相等，则哪个更大。

这对于排序算法的重要性现在是显而易见的。如果您不知道一个对象是否大于另一个对象，您将如何对一组对象进行排序？当`sort`调用 的实现时，它使用`compareTo()`类的方法来决定集合的正确顺序。

最后，`compare()`当您想在类*外*进行比较时，您可以使用该方法。一个实现是：

```
 public int compare(Spam s1, Spam s2) {
     return s1.getEggs() - s2.getEggs();
 } 
```

希望这可以帮助你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T18:07:04.753

我猜 Comparator 仅在您想按升序对类中的对象进行排序时使用。用于按升序对类的 ID 进行排序。它是基于一个字段的互斥排序自动排除基于另一个字段的排序*

# java - Java LinkedHashSet 从末尾删除一些元素

> ID：15890248
> 
> 赞同：1
> 
> 时间：2013-04-08T22:36:04.663
> 
> 标签：java, removeall, linkedhashset

我正在解决一个问题，我需要存储具有无重复和维护顺序要求的元素。我选择了，`LinkedHashSet`因为它满足了我的两个要求。

假设我有这个代码：

```
 LinkedHashSet hs = new LinkedHashSet();
  hs.add("B");
  hs.add("A");
  hs.add("D");
  hs.add("E");
  hs.add("C");
  hs.add("F");
  if(hs.contains("D")){
       //do something to remove elements added after"D" i-e remove "E", "C" and "F"
       //maybe hs.removeAll(Collection<?>c) ??
   } 
```

谁能指导我删除这些元素的逻辑？

我使用了错误的数据结构吗？如果是这样，那么什么是更好的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:49:41.453

如果您使用 LinkedHashSet，我认为您可能需要使用迭代器进行删除。也就是说找到元素，然后继续删除，直到找到尾部。这将是 O(n)，但是即使您编写了自己的 LinkedHashSet（带有双向链表和哈希集），您也可以访问原始链接结构，以便您可以在 O(1) 中剪切链表，但是您仍然需要从 HashSet 中删除刚刚从链表中删除的所有元素，这是 O(n) 成本再次出现的地方。

因此，总而言之，删除元素，然后为该元素保留一个迭代器，并继续向下删除元素，直到到达最后。我不确定 LinkedHashSet 是否公开了所需的调用，但您可能可以弄清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:09:47.667

这里的基本问题是您必须维护两个数据结构，一个表示键/值映射的“映射”，另一个表示插入顺序的“列表”。

有“地图”和“列表”组织可以在给定点之后快速删除元素；例如，各种有序树以及基于数组和链的列表（以定位点的成本为模。）

但是，似乎不可能从两个数据结构中删除 N 个元素`O(N)`。您必须访问所有要删除的元素才能将它们从第二个数据结构中删除。（事实上​​，我怀疑可以用数学方法证明这一点……）

简而言之，没有比您当前使用的数据结构更复杂的数据结构。

可以提高性能（使用自定义集合类！）的领域是避免显式使用迭代器。使用迭代器和标准迭代器 API，成本`O(N)`取决于数据结构中的元素总数。您可以根据`O(N)`删除的元素数量进行此操作……如果哈希条目节点也具有序列的下一个/上一个链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:40:25.840

您可以编写自己的不允许重复的 ArrayList 版本，方法是覆盖`add()`和`addAll()`。据我所知，没有这样的“常见”第 3 方版本，这一直让我感到惊讶。有人知道吗？

然后删除代码非常简单（无需使用`ListIterator`）

```
int idx = this.indexOf("D");
if (idx >= 0) {
  for (int goInReverse = this.size()-1; goInReverse > idx; goInReverse--)
    this.remove(goInReverse);
} 
```

但是，这仍然是 O(N)，因为您循环遍历列表的每个元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-25T17:46:08.823

所以，在尝试了上面提到的几件事之后，我选择了实现不同的数据结构。因为我对这个问题的 O(n) 没有任何问题（因为我的数据非常小）

我使用了 Graphs，这个库非常方便：http: [//jgrapht.org/](http://jgrapht.org/)

我正在做的是将所有元素作为顶点添加到`DirectedGraph`它们之间也创建边（边也帮助我解决了另一个不相关的问题）。当需要删除元素时，我使用带有以下伪代码的递归函数：

```
removeElements(element) {

tempEdge = graph.getOutgoingEdgeFrom(element)
if(tempEdge !=null)
   return;
tempVertex = graph.getTargetVertex(tempEdge)
removeElements(tempVertex)
graph.remove(tempVertex)

} 
```

我同意图 DS 不适合这类问题，但在我的条件下，这非常有效……干杯！

# perforce - 如何获取尚未使用 P4J API 集成的变更列表？

> ID：15890249
> 
> 赞同：2
> 
> 时间：2013-04-08T22:36:15.890
> 
> 标签：perforce

我正在转换一个调用“p4 交换”（即返回尚未集成到分支中的更改的命令）的 Python 脚本以使用 JVM 语言。哪些 P4J ( [http://www.perforce.com/perforce/doc.current/manuals/p4java-javadoc/](http://www.perforce.com/perforce/doc.current/manuals/p4java-javadoc/) ) API 可用于重现相同的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T21:17:40.797

来自 Perforce 支持：

`GetInterchangesOptions`如果需要，用于将标志传递给交换命令。

使用其中一种`server.getInterchanges()`方法。我还建议使用`IOptionsServer`界面而不是`IServer`.

对于此`p4`命令行：

```
p4 interchanges //depot/merges/main/... //depot/merges/release/... 
```

我有这个 P4Java 等价物：

```
IOptionsServer server =
    ServerFactory.getOptionsServer("p4java://perforce:1666", null, null);

List<IChangelist> changes = server.getInterchanges(
    null,
    FileSpecBuilder.makeFileSpecList(new String[] {"//depot/merges/main/..."}),
    FileSpecBuilder.makeFileSpecList(new String[] {"//depot/merges/release/..."}),
    null);

for(IChangelist change : changes) {
    System.out.println(change.getId());
} 
```

# visual-c++ - 从 msvc 调用 mingw dll 时出现访问冲突异常

> ID：15890252
> 
> 赞同：4
> 
> 时间：2013-04-08T22:36:27.807
> 
> 标签：visual-c++, mingw

所以我在将 Mingw 编译的 C++ dll 添加到我的 msvc 项目时遇到了一些麻烦。我已经解决了一些人似乎有的关于链接的问题，但是现在当我在我添加的 dll 中调用该函数时，我收到“访问冲突读取位置 0x00000014”错误，该错误在 new.cpp 中的 operator new 方法上中断（在视觉工作室 2010 中）。我已经读到内存管理方面存在差异，我想知道这是否可能是我麻烦的根源。

我正在尝试构建和运行的特定 dll 是 cvBlobs，可在此处获得 - [https://code.google.com/p/cvblob/](https://code.google.com/p/cvblob/)，由于某种我不知道的原因，使用 mingw 编译时速度要快很多倍。

我对这些东西很陌生，但我想知道是否会发生 mingw dll 正在调用 msvc new() 方法？那有意义吗？我在 mingw 网站上查看了帮助，虽然这对我来说很有用，但似乎无助于解决这个问题。请让我知道您是否希望我提供其他任何东西。

编辑：我已经从我的 Visual Studio 编译代码中包含了特定的有问题的代码，希望它可以提供一点清晰。

```
 //Grey is a greyscale image, thresh is that image thresholded
    cvThreshold(grey,thresh,0,255,CV_THRESH_OTSU);
    IplImage* outputImg = cvCreateImage(cvGetSize(thresh), IPL_DEPTH_LABEL, 1);
    //Blobs is where the found blobs are outputted too
    cvb::CvBlobs blobs;
    unsigned int result;
    //This is the problematic method, it is in the mingw compiled dll,
    //other methods from this dll seem to work. I'm tempted to say that
    //the problem comes in the cvLabel method, where a varible "CvBlob blob" is
    //first initalized. This is due to the stack trace that I am including
    //under this edit
    result = cvb::cvLabel(thresh, outputImg, blobs); 
```

这是我在上面提到的堆栈跟踪

```
cvBlobs.dll!6e313f95()  
[Frames below may be incorrect and/or missing, no symbols loaded for cvBlobs.dll]   
cvBlobs.dll!6e30135b()  
msvcr100d.dll!operator new(unsigned int size)  Line 59C++
nuon.dll!std::_Allocate<std::_Tree_nod<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >::_Node>(unsigned int _Count, std::_Tree_nod<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >::_Node * __formal)  Line 36 + 0x15 bytes C++
nuon.dll!std::allocator<std::_Tree_nod<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >::_Node>::allocate(unsigned int _Count)  Line 187 + 0xb bytes C++
nuon.dll!std::_Tree_val<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >::_Tree_val<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >(const std::less<unsigned int> & _Parg, std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> > _Al)  Line 550 + 0xc bytes  C++
nuon.dll!std::_Tree<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >::_Tree<std::_Tmap_traits<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> >,0> >(const std::less<unsigned int> & _Parg, const std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> > & _Al)  Line 699  C++
nuon.dll!std::map<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> > >::map<unsigned int,cvb::CvBlob *,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,cvb::CvBlob *> > >()  Line 107    C++
nuon.dll!nuon::MarkerDetector::detect(cv::Mat & input, std::vector<nuon::Marker,std::allocator<nuon::Marker> > & detectedMarkers, nuon::CameraParameters camParams, float markerSizeMeters, bool setYPerperdicular)  Line 201   C++ 
```

我希望此编辑可能有助于为某人澄清这一点

# performance - 为什么电梯框架这么慢？

> ID：15890256
> 
> 赞同：2
> 
> 时间：2013-04-08T22:36:34.587
> 
> 标签：performance, scala, lift

我正在学习 Lift 框架。我使用来自 git://github.com/lift/lift_25_sbt.git 的项目模板并使用*container:start* sbt 命令启动服务器。

这个模板应用程序只显示简单的菜单。如果我使用apache 的**ab**来衡量性能，那它就很糟糕。我错过了提高性能的基础知识？

```
C:\Program Files\Apache Software Foundation\httpd-2.0.64\Apache2\bin>ab -n 30 -c
 10 http://127.0.0.1:8080/
Benchmarking 127.0.0.1 (be patient).....done

Server Software:        Jetty(8.1.7.v20120910)
Server Hostname:        127.0.0.1
Server Port:            8080

Document Path:          /
Document Length:        2877 bytes

Concurrency Level:      10
Time taken for tests:   8.15625 seconds
Complete requests:      30
Failed requests:        0
Write errors:           0
Total transferred:      96275 bytes
HTML transferred:       86310 bytes
Requests per second:    3.74 [#/sec] (mean)
Time per request:       2671.875 [ms] (mean)
Time per request:       267.188 [ms] (mean, across all concurrent requests)
Transfer rate:          11.73 [Kbytes/sec] received 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T04:49:30.383

您是否在生产模式下运行它？我发现我在开发中有 30 rps，但在生产模式下超过 250。（**[https://www.assembla.com/spaces/liftweb/wiki/Run_Modes](https://www.assembla.com/spaces/liftweb/wiki/Run_Modes)**）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T16:23:09.567

*   如前所述，您应该在生产模式下运行 Lift。这是获得良好性能的主要关键。所有模板都以这种方式缓存，并应用其他优化。
*   如果你想衡量一些不是抽象和理论的东西，那么你应该给 JVM 时间“热身”，应用它的 JIT 优化。因此，您应该首先应用〜数千个请求并完全忽略它们（必须是几秒钟）。之后，测量一个已经启动的服务器的真实性能
*   有一些轻微的 JVM 优化，尽管它们对我来说更像是一种 hack，并且提升不超过 20%
*   其他小技巧包括使用 nginx 提供静态内容，在专用服务器而不是 Simple Build Tool 中启动应用程序等。

# ios - 以编程方式生成的 UILabel 原点错误地设置为 (0.0) 在第一次加载时设置

> ID：15890257
> 
> 赞同：0
> 
> 时间：2013-04-08T22:36:47.493
> 
> 标签：ios, uiimageview, uilabel, xcode4.5

我正在尝试以编程方式`UILabels`在我的应用程序中为`UIImageView`我的情节提要上的每个生成两个。代码运行并正常工作，但是，首先在主视图的 (0.0) 坐标中加载两个 UILabel 表单，而不是 UIImageView 框架 origin.x,origin.y。我不明白为什么会这样。

如果我然后单击不同的选项卡并返回到页面，则标签会在正确的位置生成。

为什么是这样？我怎样才能让它最初在正确的位置生成标签？

```
-(void) viewWillAppear:(BOOL)animated
{
    //removed unneccessary code above...
    int i = 0;
    for (UIImageView *plantScreen in self.view.subviews)
    {
        if ([plantScreen isMemberOfClass:[Plant class]])
        {
            @try
            {
                //the label which will hold the name
                UILabel *plantName = [[UILabel alloc] initWithFrame:CGRectMake((plantScreen.frame.origin.x), (plantScreen.frame.origin.y+ plantScreen.frame.size.height), 160, 30.0)];
                plantName.numberOfLines = 1;
                plantName.minimumScaleFactor = .5;
                plantName.adjustsFontSizeToFitWidth = YES;
                [plantName setTextAlignment:NSTextAlignmentCenter];
                [plantName setBackgroundColor:[UIColor clearColor]];

                [self.view addSubview:plantName];
                plantName.hidden = false; 
                [self.view bringSubviewToFront:plantName];

                //create the label which will hold the quantity
                UILabel *quantity = [[UILabel alloc] initWithFrame:CGRectMake((plantScreen.frame.origin.x), (plantScreen.frame.origin.y+ plantScreen.frame.size.height + 20), 160, 30.0)];

                [quantity setTextAlignment:NSTextAlignmentCenter];
                [quantity setBackgroundColor:[UIColor clearColor]];
                quantity.text = [NSString stringWithFormat:@"%d",plant.quantity];
                [self.view addSubview:quantity];
                quantity.hidden = false;
                [self.view bringSubviewToFront:quantity];

                i++;   

            }
            @catch (NSException *exception)
            {   
                NSLog(@"An exception occured: %@", [exception reason]);
            }
            @finally
            {

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:41:24.920

首先，您错过了对`[super viewWillAppear:animated]`. 您需要给超类（包括`UIViewController`基类）一个“施展魔法”的机会。

永远不要忘记给父类一个施展魔法的机会，除非你真的很清楚自己在做什么。

其次，UI 创建应该在 中完成`-loadView`，而不是在`viewWillAppear:`.

先试试这两件事。

* * *

好吧。现在我很好奇你是*如何*把东西搬到`-loadView`. 你加了`[super loadView];`吗？

事实上，现在我想，`-loadView`在这种情况下，移动到是错误的；您显然通过笔尖实例化了一些视图。`UIViewController`的实现`-loadView`通常只加载 nib 文件。完成后，`UIViewController`'s `-loadView`call `-viewDidLoad`。

因此，当您不是以编程方式创建所有 UI 而是允许`UIViewController`从 nib 加载它时，您实际上可能希望将代码移动到`-viewDidLoad`. （当你告诉它创建一个新的`UIViewController`子类时，请参阅 Xcode 生成的模板。）

继续，让我们考虑框架依赖于什么。这取决于您调用的某些视图类`Plant`。

请不要这样称呼它；这令人困惑。调用它`PlantView`，以便您的代码的普通读者知道该类应该做什么。同样，您可能希望调用变量`plantView`而不是`plantScreen`, 而`plantNameLabel`不是`plantName`。`plantScreen`暗示一个包含 的变量`UIScreen`，并且`plantName`暗示一个`NSString`多于它暗示一个`UILabel`。同样适用于`quantity`; 调用这个变量`quantityLabel`。

接下来，让我们考虑变量依赖于什么——它们的起源`x`并且`y`不根据计数器变量 variable 改变`i`。也许你的意思是写：

```
UILabel *plantName = [[UILabel alloc] initWithFrame:CGRectMake((plantScreen.frame.origin.x), (plantScreen.frame.origin.y+ plantScreen.frame.size.height * i), 160, 30.0)]; 
```

后来：

```
UILabel *quantity = [[UILabel alloc] initWithFrame:CGRectMake((plantScreen.frame.origin.x), (plantScreen.frame.origin.y+ plantScreen.frame.size.height*i + 20), 160, 30.0)]; 
```

其次，*避免异常和异常处理*。通过其他形式的检查确保不发生异常；Apple[强烈建议](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Exceptions/Exceptions.html)您在编写应用程序时修复异常，而不是在它们运行时处理它们：

> **重要提示：**您应该将异常用于编程或意外的运行时错误，例如越界集合访问、尝试改变不可变对象、发送无效消息以及失去与窗口服务器的连接。您通常在创建应用程序时而不是在运行时处理这些类型的异常错误。

接下来，一个小的文体评论（不是很重要）：您正在通过属性混合调用设置器并直接调用设置器。没有错（他们最终做的完全一样），但风格上不是很好。

接下来，除非您使用 ARC（自动引用计数），否则不要忘记在将视图添加为子视图后释放它们。

接下来，`plantScreen`（我在下面命名）可以在循环内声明时`plantView`将类型设置为`Plant`（我在下面命名）。`PlantView`

最后但非常重要且**极易**错过：您调用函数`isMemberOfClass:`而不是`isKindOfClass:`.

重新编写的代码版本（未经测试）：

```
-(void)viewDidLoad
{
    [super viewDidLoad];

    int i = 0;
    for (PlantView *plantView in self.view.subviews)
    {
        if ([plantView isKindOfClass:[PlantView class]])
        {
            //the label which will hold the name
            CGRect plantNameLabelFrame = CGRectMake((plantScreenView.frame.origin.x),
                                                   (plantScreenView.frame.origin.y + plantScreen.frame.size.height*i), 
                                                  160, 
                                                  30.0);
            UILabel *plantNameLabel = [[UILabel alloc] initWithFrame: plantNameLabelFrame];
            plantNameLabel.numberOfLines = 1;
            plantNameLabel.minimumScaleFactor = .5;
            plantNameLabel.adjustsFontSizeToFitWidth = YES;
            plantNameLabel.textAlignment = NSTextAlignmentCenter;
            plantNameLabel.backgroundColor:[UIColor clearColor];

            [self.view addSubview:plantNameLabel];
            [plantNameLabel release];

            //create the label which will hold the quantity
            CGRect quantityLabelFrame = CGRectMake((plantScreenView.frame.origin.x),
                                                      (plantScreenView.frame.origin.y + plantScreen.frame.size.height*i + 20), 
                                                      160, 
                                                      30.0);
            UILabel *quantityLabel = [[UILabel alloc] initWithFrame: quantityLabelFrame];
            quantityLabel.textAlignment = NSTextAlignmentCenter;
            quantityLabel.backgroundColor = [UIColor clearColor];
            quantityLabel.text = [NSString stringWithFormat:@"%d", plant.quantity]; // NB: what's "plant"?
            [self.view addSubview:quantityLabel];

            i++;
       }
    }
} 
```

我还删除了`.hidden = false`（实际上应该是`.hidden = NO`；这是 Objective-C，而不是 C++），并且`bringSubviewToFront:`（它已经在前面，刚刚被添加`addSubview:`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:52:19.337

的框架`UIImageView`取决于正在绘制的图像及其`contentMode`属性。您可以尝试将其设置`contentMode`为`UIViewContentModeScaleAspectFill`以查看它是否强制保留其分配的框架。

# java - 在 Android 中测试模型类

> ID：15890259
> 
> 赞同：0
> 
> 时间：2013-04-08T22:36:54.497
> 
> 标签：java, android, unit-testing

我需要测试我项目的所有模型类。这是其中一堂课

```
public class TMyData{
    private mVar1;
    private mVar2;
    ...

    private TMyData(){
    }

    public static TMyData fromString(String str){
        ...
    }

    public String toString(){
        ...
    }

} 
```

简单地说，测试应该是：

1) 创建一个随机的 TMyData

2) 调用 toString

3) 从字符串调用

4）检查它们是否相同

问题是创建随机的 TMyData。由于测试类是一个单独的类（TMyDataTest），我不能执行以下操作：

```
TMyData p = new TMyData();  //I can't, because its private
p.mVar1 = ...; // I can't because is also private 
```

我不想仅仅因为测试而改变我所有的变量/方法的可见性......而且我也不希望用户可以访问私有变量（没有 getter 或 setter）

很多人一定有类似的问题，因为所有项目都有自己的模型。哪个是测试它的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:41:58.197

我只能通过反思来找到解决方案。

```
Field f = tmydata.getClass().getDeclaredField("mVar1"); //NoSuchFieldException
f.setAccessible(true);
f.set(tmydata,dataToSet); 
```

# visual-studio-2010 - 命令行参数不起作用（char，TCHAR）VS2010

> ID：15890265
> 
> 赞同：1
> 
> 时间：2013-04-08T22:37:15.607
> 
> 标签：visual-studio-2010, visual-c++, char, main, tchar

我有以下代码：

```
int _tmain(int argc, char** argv) {
  bool g_graphics = true;
  palPhysics * pp = 0;
  #ifndef PAL_STATIC
  PF -> LoadPALfromDLL();
  #endif
  char a[] = "Bullet";
  std::string aa;
  aa = std::string(argv[1]);
  //PF->SelectEngine("Bullet");
  DebugBreak();
  PF -> SelectEngine(argv[1]);
  //PF->SelectEngine(aa);
  //debug
  //    assert(false);
  pp = PF -> CreatePhysics();
} 
```

我正在尝试读取命令行参数号。1 在这一行：

```
PF->SelectEngine(argv[1]); 
```

但是，我只得到论点的第一个字母。我也试过改变

```
int _tmain(int argc, char** argv) 
```

至

```
int _tmain(int argc, TCHAR** argv), but then I get 
```

错误：

```
error C2664: 'palFactory::SelectEngine' : cannot convert parameter 1 from 'TCHAR *' to 'const PAL_STRING &' 
```

PAL_STRING 只是一个 std::string。

这可能很简单，但我不确定如何将 TCHAR 转换为 std::string，尤其是因为 TCHAR 取决于编译器/环境设置。有没有人知道让命令行参数工作的简单方法，这样我就不需要自己转换任何东西，即可能通过更改 tmain 函数？

谢谢！

C

***更新：在命令行上调用的示例：***

是的。所以我在命令行上调用它的方式是：

progname.exe arg1 arg2,

其中 arg1 是我要加载的物理引擎，而 arg2 是 dae（带有物理信息的物理文件），所以我去，具体来说：

progname.exe 项目符号 E:/a.dae

进入“PF->SelectEngine(argv[1]);”行 给出以下代码：

```
 ``bool palFactory::SelectEngine(const PAL_STRING& name) {
#ifdef INTERNAL_DEBUG
    printf("palFactory::SelectEngine: this = %p\n", this);
#endif
    SetActiveGroup(name); // also calls RebuildRegistry
    return isClassRegistered("palPhysics");
}``  ，在这种情况下，在调试时，我可以看到 const PAL_STRING& 名称，即字符串，只是“B”，而不是我所期望的，即“Bullet”，我传入的命令行参数命令行。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2013-05-02T18:08:26.397

多年来，我一直被这个问题困扰。我能找到的唯一解决方案是不使用 Visual Studio。当我必须能够处理命令行参数时，我不得不回退到使用其他编译器。具体来说，我一直在成功使用 Digital Mars 编译器。它正确处理命令行参数。我使用VS环境进行智能感知和调试，然后用DMC编译部署。

---在下面编辑---

事实证明，我只是没有问正确的问题。我终于问对了问题，得到了正确的答案！请参阅下面的链接。

[C++ 中的 _tmain() 和 main() 有什么区别？](https://stackoverflow.com/questions/895827/what-is-the-difference-between-tmain-and-main-in-c) 
```

# javascript - 让多个文本段落占用相同的空间？

> ID：15890275
> 
> 赞同：1
> 
> 时间：2013-04-08T22:37:53.227
> 
> 标签：javascript, html, css

我正在制作一个页面，上面有一堆不同标题和文本的项目。我希望标题和文本都排在同一高度。有些标题是 2 行，有些只有 1 行。它还需要响应，所以我不能只设置最小高度。

[![截屏](https://i.stack.imgur.com/Lgc1W.jpg)](https://i.stack.imgur.com/Lgc1W.jpg)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/cw1tl2gq.vhr.jpg)）]

是否可以让 h2 和 p 始终保持相同的高度？我想的 hacky 方式是用 javascript 填充较短的，但这是最后的手段。

HTML 是：

```
<div class="itemContainer" style="width:25.0%;">
<div class="catItemView groupPrimary">
    <div class="catItemHeader">
        <h3 class="catItemTitle">
            <a href="/index.php/projects/item/46-wairamarama-onewhero-seal-extension">Wairamarama-Onewhero Seal Extension</a>
        </h3>
    </div>
    <div class="catItemBody">
        <div class="catItemImageBlock">
            <span class="catItemImage">
                <a href="/index.php/projects/item/46-wairamarama-onewhero-seal-extension" title="Wairamarama-Onewhero Seal Extension">
                    <img src="/media/k2/items/cache/64d93d666355a43c4a86679a030d35b6_M.jpg" alt="Wairamarama-Onewhero Seal Extension" style="width:359px; height:auto;" />
                </a>
            </span>
            <div class="clr"></div>
        </div>
        <div class="catItemIntroText">
            <p>Evergreen Landcare have been involved in the Wairamarama-Onewhero Seal Extension as a sub-contractor for Heb Construction.</p>
        </div>
        <div class="clr"></div>
    </div>
    <div class="clr"></div>
    <div class="catItemReadMore">
        <a class="k2ReadMore" href="/index.php/projects/item/46-wairamarama-onewhero-seal-extension">Read more...</a>
    </div>
    <div class="clr"></div>
</div> 
```

这是由 K2/Joomla! 生成的！所以它没有太大的灵活性。 如果您想查看，[这是页面。](https://web.archive.org/web/20130625004243/http://test.evergreenlandcare.co.nz:80/index.php/projects)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:53:14.920

您可以通过将具有可变内容的元素的高度设置为某个保持最大值的值来“修复”外观。以下 CSS 为您链接到的页面执行此操作：

```
div.catItemIntroText {
  height: 180px;
}
div.catItemHeader h3.catItemTitle {
  height: 45px;
} 
```

这只有效，因为您事先知道看起来最好的高度。

如果您能够更改 HTML，您可以采用全新的方法并使用网格系统。这是一种使用 Twitter Bootstrap 的方法（[演示](http://jsfiddle.net/y2vCj/)）

```
<div class="container">
    <div class="row">
        <div class="span3">
             <h2>Wairamarama-Onewhero Seal Extension</h2>

        </div>
        <div class="span3">
             <h2>Te Rapa Pass</h2>

        </div>
        <div class="span3">
             <h2>Stockton Mine</h2>

        </div>
        <div class="span3">
             <h2>State Highway 88 Dunedin Realignment</h2>

        </div>
    </div>
    <div class="row">
        <div class="span3">
            <img src="http://placekitten.com/200/300" />
        </div>
        <div class="span3">
            <img src="http://placekitten.com/200/300" />
        </div>
        <div class="span3">
            <img src="http://placekitten.com/200/300" />
        </div>
        <div class="span3 ReadMore">
            <img src="http://placekitten.com/200/300" />
        </div>
    </div>
    <div class="row">
        <div class="span3 ReadMore"> <a href='#' class='btn btn-primary'>read more</a>

        </div>
        <div class="span3 ReadMore"> <a href='#' class='btn btn-primary'>read more</a>

        </div>
        <div class="span3 ReadMore"> <a href='#' class='btn btn-primary'>read more</a>

        </div>
        <div class="span3 ReadMore"> <a href='#' class='btn btn-primary'>read more</a>

        </div>
    </div>
</div> 
```

通过将每一行（文本、图像和按钮）放在它自己`<div.row>`的位置上，溢出会自动处理。

# php - 设置一个 php if 语句只执行一次函数？

> ID：15890278
> 
> 赞同：0
> 
> 时间：2013-04-08T22:38:23.730
> 
> 标签：php, mysql

我的网站上有一个名为 profile_views 的表，用于计算一个人查看用户个人资料的次数。我想要做的是让用户看到他们在那一周有多少访问者访问他们的个人资料，并且每周一我都希望清空表格，以便计数可以从 0 重新开始。

我正在尝试创建一个 php if 语句，表示每周一在星期一执行删除 mysql 查询。我只有在星期一才能执行它，但是我试图找到一种只执行一次的方法，最好是在星期一早上 00:00 AM，因为我不希望它在整个过程中不断删除表中的结果周一。

```
<?php
$today=date(l); // Find what today is? using date function

// If today is Monday displays message "Today is Monday" and displays image1.gif
if($today==Tuesday) { // Compare $today with name of the day. 

$result = mysql_query("DELETE FROM ptb_profile_views;") 
or die(mysql_error());

}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:40:15.260

您要查找的内容已命名`cron`- 使用它在所需的工作日在所需的时间调用您的 PHP 脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:51:28.100

您*可以*设置一个 cron 作业来自动执行脚本，但更好的方法（我这样做的方式）是将条目留在数据库中，并在显示上周的访问者数量时，将查询更改为返回仅上周内的条目。这可能会容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T22:41:28.000

设置 Cron - 基于我们的要求

[http://www.sophos.com/en-us/support/knowledgebase/12176.aspx](http://www.sophos.com/en-us/support/knowledgebase/12176.aspx)

[http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/](http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T22:40:58.613

**没有 cron 作业的方法**：

您可以设置一个变量`$ran`并将其存储在某个地方（也许在一个文件中？）。然后每周一，运行并`$ran`以`true`.

如果是其他任何一天，请设置`$ran`回 false。这将确保脚本只在星期一运行，并且只运行一次。

# facebook - 在哪里可以找到 Facebook（Facebook 上的应用）画布页面应用的 URL？

> ID：15890281
> 
> 赞同：1
> 
> 时间：2013-04-08T22:38:43.320
> 
> 标签：facebook, facebook-apps, facebook-canvas

在 Facebook 上创建“应用程序”后，如何找到 URL 以在 Facebook chrome 中实际查看它？

在下图中（来自[Facebook 的文档](https://developers.facebook.com/docs/appsonfacebook/tutorial/)），第一行显示了带有 facebook 的 Canvas Page 的 url。但是，我的“编辑应用程序”页面没有此字段，但在其他方面是相同的。

![在此处输入图像描述](https://i.stack.imgur.com/nHdeW.png)

该 URL 似乎没有在[https://developers.facebook.com/apps/](https://developers.facebook.com/apps/)中的任何地方列出，我只是不知道该去哪里找。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:41:32.147

在更仔细地阅读了文档后，我想通了 ;-)

要显示 URL，您需要在设置中设置应用程序“命名空间”。

# c# - RestSharp 以 DateTime 元素作为子元素反序列化列表

> ID：15890288
> 
> 赞同：2
> 
> 时间：2013-04-08T22:39:34.957
> 
> 标签：c#, rest, serialization, xml-serialization, restsharp

我在使用 RestSharp 反序列化以下 xml 时遇到问题：

```
<dates>
<date>2013-04-30</date>
<date>2013-04-16</date>
<date>2013-04-05</date>
<date>2013-04-20</date>
<date>2013-04-06</date>
<date>2013-04-13</date>
<date>2013-04-04</date>
</dates> 
```

显然，我需要将其反序列化为 DateTime 对象列表之类的东西。所以我尝试过类似的东西

```
public class Dates : List<DateTime>
{
} 
```

但这是不可能的，因为 DateTime 类名称与元素“日期”名称不匹配。当然，我已将日期格式设置如下：

```
request.XmlSerializer.DateFormat = "yyyy-MM-dd"; 
```

所以我的下一步是

```
public class Dates
{
  [SerializeAs(Name="date")]
  List<DateTime> dates;
} 
```

但这也不起作用，集合仍然是空的。我理解将 dateTime 解析和列表与单个元素混合起来作为一个孩子是......不方便。这甚至可以用默认的 RestSharp XmlParser 解析这种 xml 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-12-06T11:36:17.313

您正在制作自己的列表课程吗？您似乎误解了如何制作 XML 可序列化对象。

试试这个：

```
public class MyXmlObject
{
    [XmlArray(ElementName = "dates")]
    [XmlArrayItem(ElementName = "date")]
    List<DateTime> Dates;
} 
```

# jquery-plugins - slicebox 不显示任何动画

> ID：15890290
> 
> 赞同：1
> 
> 时间：2013-04-08T22:39:47.293
> 
> 标签：jquery-plugins

我在使用 slicebox 时遇到了困难。我检查了每一个想法，按照教程进行操作，但我错过了动画。我认为它只是没有启动，因为幻灯片中的第一张图片出现了，但没有任何反应。

包括 CSS

```
<link rel="stylesheet" type="text/css" href="css/slicebox.css" />
<link rel="stylesheet" type="text/css" href="css/custom.css" /> 
```

jQuery是最新版本

```
<script type="text/javascript" src="js/modernizr.custom.46884.js"></script> 
```

html似乎是正确的

```
<div class="wrapper">
<ul id="sb-slider" class="sb-slider">

<li>
   <a href="#" target="_blank">
   <img src="slider/image1.jpg" alt="image1"/> 
   </a>
</li>
<li>
  <a href="#" target="_blank">
  <img src="slider/image2.jpg" alt="image1"/> 
  </a>
</li>

</ul>
</div> 
```

就在最后的 /body 标签之前

```
<script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/jquery.slicebox.js"></script>
        <script type="text/javascript">

            $('#sb-slider').slicebox({
            orientation : 'v',
            autoplay : true,
            });

</script> 
```

怎么了？我对 jquery 不太了解，但我尝试了很多变量，可能有一些我看不到的东西。我很感激任何帮助。

# java - 让我的方法返回一个字符串

> ID：15890291
> 
> 赞同：0
> 
> 时间：2013-04-08T22:39:59.863
> 
> 标签：java, string, methods, return

我正在尝试编写一个程序来处理我随机生成的一手牌。出于某种原因，我无法让它从我在主程序中的方法中打印字符串。我不确定我是否遗漏了某些东西，或者这一切都是错的，我对 Java 场景还是很陌生。这就是我得到的。

```
public class Deck {
  public static void main (String args[]) {
    Builder();
    out.println("Your hand is:" card )
  }
  // This will build the deck
  public static String Builder() {
    // I need this to pick from the random array
    Random r = new Random();

    // This is an array, to make one you need [] before string
    //This is how you get your ending
    String[] SuitsA = { "Hearts ",  "Diamonds ", "Spades ", "Clubs" };
    // The number array
    String[] FaceA = {"1","2","3","4","5","6","7","8","9","10","King ", "Queen ", "Jack ", "Ace ",};

    // Picks a random set from the arrays 
    String suit = SuitsA[r.nextInt(4)]; 
    String face = FaceA[r.nextInt(14)];

    //Tryng to make 1 string to return
    String card = ( suit + " of " + face ); 
    // This might give me a value to use in the method below
    out.println( card );
    return;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T22:43:00.357

您没有从您的方法返回您的计算卡值（字符串）。所以像这样返回那个字符串

```
 String card = ( suit + " of " + face ); 
    // This might give me a value to use in the method below
 return card; 
```

`main`并在方法中使用它

```
public static void main (String args[]) {
String value=Builder();
out.println("Your hand is:"+ value )
} 
```

# vb.net - 如何在 VB.NET 中生成用户定义的警告消息

> ID：15890293
> 
> 赞同：0
> 
> 时间：2013-04-08T22:40:08.147
> 
> 标签：vb.net, pragma, preprocessor-directive

我想在 VB.NET 中生成一条用户定义的警告消息，就像在 C# 中所做的那样（见下文）：

[如何在 Visual C++ 中使用 #pragma 消息生成用户定义的警告消息](http://support.microsoft.com/kb/155196)

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:09:08.617

不，

不幸的是，使用 VB.NET 是不可能的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T00:02:54.100

它不是在 C# 中完成的，您指的是 C++ 中的某些内容

但是，您可以将属性`<Obsolete("some comment")>`用于类、函数和子类；这确实会产生警告。

这里是代码版本，所以使用过时的。由于您可以添加任何文本，因此您应该能够细化警告的目的。

# c# - 模态不确定进度条

> ID：15890297
> 
> 赞同：0
> 
> 时间：2013-04-08T22:40:18.847
> 
> 标签：c#, progress

我有一个 Windows 应用程序，它基本上调用其他类并在这个存储过程中，并最终创建一个包含大量信息的 csv 文件。我需要一个一直运行到完成的进度条，以便用户可以看到正在发生的事情。我已经搜索了互联网，但似乎无法让它发挥作用。我只希望栏在单击按钮时开始运行。为什么这看起来如此困难？我得到的最接近的是刚刚在选框中启动栏，但直到填充对象之后它才会“开始”，这对我没有好处，我需要在填充对象时启动它。这是在 C# 中完成的。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:48:40.970

您需要在单独的线程中运行长时间运行的任务，以便 UI 可以在任务运行时更新。

请参阅[Windows 窗体 ProgressBar：启动/停止选取框的最简单方法？](https://stackoverflow.com/questions/312936/windows-forms-progressbar-easiest-way-to-start-stop-marquee)有关设置的示例。

# machine-learning - 在多个维度上搜索二进制范围重合

> ID：15890303
> 
> 赞同：0
> 
> 时间：2013-04-08T22:40:29.547
> 
> 标签：machine-learning, pattern-matching, cluster-analysis

我已经澄清并简化了这个问题：

我的数据如下所示：

```
011100111110100111
111111111111110010
111100001111000011 
```

数据流的一维通道。每一行都表示存在 1 或 0 的类型。类型往往以块的形式存在于流中。行的垂直顺序无关紧要。

我正在寻找维度在两个或多个索引处重合的模式，无论是在**'1' group's 的开头**，还是**任何 '1' groups**在所有行/维度上重叠的地方。

如果保持其比例，则图案可以与附近的相邻索引偏移。

D = 维度/行 N = 流中的索引

((D1(N), D25(N+4), D900(N-1)), (3, 67, 90, 3000))

可能在多个位置发生的模式匹配示例。N 处的 Dimension01，索引 N + 4 处的 Dimension25，索引 N -1 处的 Dimension900 出现在索引 3、67、90 和 3000 处。

### 返回的模式：

*   按匹配索引的数量或模式中的维数排序。
*   在至少两个点上匹配至少两个维度

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-23T15:18:43.223

据我了解，[频繁项集挖掘](http://en.wikipedia.org/wiki/Association_rule_learning)的方法可能是您正在寻找的。作为起点，我将研究著名的[Apriori](http://en.wikipedia.org/wiki/Apriori_algorithm)算法，这是在您的示例中检测常见的“1”元素块的最基本技术之一（假设我们可以将每一列解释为一个独立的维度，并且没有维度之间的特定语义/关系，这将修改问题，因为维度的顺序变得有意义）。

# assembly - 在程序集中转换十六进制字符

> ID：15890304
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:40:30.177
> 
> 标签：assembly, x86, x86-16, hex

我目前正在为 8086 编写程序集。

我正在做的当前任务是将 4 个十六进制数字转换为十进制表示。我试过遵循我的导师方法，但我在必须将十六进制数字乘以临时值的部分感到困惑，特别是当我被告知将其设为 0 时，每次乘以临时值总是会是0对吗？

我到目前为止的代码如下，非常感谢任何帮助！

```
; ------------------------------------
; Name    : Gethex
; Function: converts a word (4 hex digits) into a numerical value
; Inputs  : Upto a word hex values input into the console
; Outputs : Return within DX the numerical conversion
; ------------------------------------

Gethex:
MOV BX,0H ;Temp value to 0
MOV CX,0H ;Counter set to 0
Gethexloop:
call Getch
push DX ; Putch requires DL, need to save current reg
MOV DL,AL
call Putch
pop DX ; restore DL reg
MOV BH,AH ;Use BH as temp storage as AH will be corrupted
cmp AL,30H ; ASCII 0
JL Gethexloop ; If less than 0 jump to the start as not an Alphabetical char
cmp AL,39H ; ASCII 9
JLE Nums ; If less or equal to 9 then it will be a number
cmp AL,46H
JLE Case ; Start the conversion procedure
Case:
SUB AL,10
jmp Convert
Nums:
SUB AL,30 ; Convert to normal number
Convert:
push AX ; Prepare to multiply
MOV AX,BX
mul BX
POP AX
ADD AX,BX
ADD DX,AX ; final value
ADD CX,1 ; Increase counter
cmp CX,3 ; if greater than 4 (0 being included so 3)
JG EndLoop
jmp Gethexloop
EndLoop:
ret ; return to calling statement 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T07:20:31.650

只是一些观察......首先，一个数字是一个数字是一个数字。“十六进制”和“十进制”（以及“二进制”和“八进制”）是表示数字的方式 - 它是相同的数字。一步将“十六进制表示”转换为“十进制表示”会很困难（但可能......我猜）。您想要做的是将十六进制表示转换为数字......然后可能将数字转换为其十进制表示，以便我们可以打印它。

你的“temp”变量，我喜欢称之为“result so far”，一开始就设置为零，但它不会为每个字符/数字重置为零！一般程序是将“到目前为止的结果”设置为零，然后对于遇到的每个有效数字，将“迄今为止的结果”乘以基数 - 十进制为 10，十六进制为 16 - 然后添加新数字......当然，从字符转换为数字。重复直到你的字符用完

`mul`是一个非常好的指令，但它有“隐藏”的操作数（`ax`和`dx`，在我们的例子中）。乘以 10，我们没有太多选择，但是乘以 16 可以通过`shl reg, 4`更少的“副作用”来完成。如果你真的在 8086 上，只有`1`和`cl`是有效的操作数。仅在 80186 中引入了除一个之外的“立即数”（80286 出于实用目的 - 80186 很少见）。您几乎可以肯定使用它，但也许您不是“应该”。我怀疑您“应该”使用`mul`它-无论如何都可以更轻松地检查溢出（如果您希望这样做-将输入限制为4个字符应该避免溢出）。

我看不出你的`mov bh, ah`台词的目的—— `ah`在这一点上是否包含任何“有趣”的东西？

几乎所有的汇编程序都会接受与或`cmp al, '0'`相同的代码。我发现前者使指令的目的更清晰，但这并不重要。`cmp al, 48``cmp al, 30h`

`jl`并且`jg`用于有符号数 -`0FFh`将被解释为 -1，并将比较为“小于”零。在此代码中，您不会遇到任何“大到足以为负”的数字，所以这无关紧要，但`jb`and`ja`用于无符号数字（`0FFh`被解释为 255）并且可能“更正确”。这只是一个挑剔的选择，但您不妨了解其中的区别 - 有时它确实很重要。

 `````
 cmp AL,46H
    JLE Case ; Start the conversion procedure
Case:
    SUB AL,10 
````  `同样，我`cmp al, 'F'`更喜欢 - 但它产生相同的代码。如果`al`不小于或等于（`jbe`对于无符号也是正确的），`Case:`无论如何你都会失败。我怀疑这是否是你想要的！而且我不明白你为什么要减去 10。如果你要减去“0”，我会认为是 37h，或者只是 7。

讨厌的用户很可能输入 'a'..'f' 和 'A'..'F'。为了做一个合适的“toupper”，我们要确保角色有一个“case”。在这里，无论如何，我们将拒绝除 'A'..'F' 之外的任何内容，所以如果我们通过强制没有“大写”的字符来产生一些垃圾也没关系。确保您首先处理了十进制数字！`and al, 0DFh ; force to uppercase`. 您可能想要也可能不想这样做 - 可能只是强制用户使用 shift 键。:)

用户输入以回车结束 - 13 或 0Dh - （我记得...... Linux 使用换行 - 10 或 0Ah - 但我认为 dos 是 13）。您可能想先检查一下 - 在十进制或十六进制数字之前。我认为您当前的设置将等待用户输入 4 个字符，即使他们点击了“输入”。可能不是预期的行为......

是的，得到一个调试器并学习如何使用它。一步一步地看到正在发生的事情会对你有很大帮助。我曾经喜欢David Lindauer的GRDB...（喜欢DEBUG只是更亮）...``

# ios - UITableView 滑动手势需要近乎完美的准确度

> ID：15890305
> 
> 赞同：2
> 
> 时间：2013-04-08T22:40:38.023
> 
> 标签：ios, cocoa, tableview, uigesturerecognizer, swipe

我正在为使用自定义 UITableViewCell 子类的 UITableView 处理自定义滑动事件。我`UIGestureRecognizerDelegate`在我的标题中包含了`viewDidLoad:`

```
UISwipeGestureRecognizer *swipeLeft = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(didSwipe:)];
swipeLeft.direction = UISwipeGestureRecognizerDirectionLeft;
swipeLeft.numberOfTouchesRequired = 1;
[self.tableView addGestureRecognizer:swipeLeft]; 
```

我的 swipeLeft 方法如下所示：

```
-(void)didSwipe:(UISwipeGestureRecognizer *)recognizer {

    if (recognizer.state == UIGestureRecognizerStateEnded)
    {
        CGPoint swipeLocation = [recognizer locationInView:self.tableView];
        NSIndexPath *swipedIndexPath = [self.tableView indexPathForRowAtPoint:swipeLocation];
        NSDictionary *clip = [self.clips objectAtIndex:swipedIndexPath.row];
        NSLog(@"Swiped!");

    }
} 
```

这是*一种*工作，但滑动必须非常精确。几乎不可能精确。

我几乎通过使用 UIPanGestureRecognizer 来让它工作，但不幸的是，它与使用全局平移手势识别器的全局侧抽屉组件（感兴趣的人为 ECSlidingViewController）并没有很好地配合。

有没有办法解决？任何帮助将不胜感激，因为我一直在谷歌搜索和浏览 SO 几个小时以寻找解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-09T01:53:43.063

[正如Kolin Krewinkel](https://twitter.com/kkrewink)在 Twitter 上指出的那样，实现这 2 个委托方法就可以了：

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer
{
    return YES;
}

- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer
{
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T05:49:15.340

我在 UITableView 上使用 ECSlidingViewController 和滑动删除时遇到了类似的问题（在我的案例中，顶视图控制器向左滑动以显示菜单）。

`panGesture`我通过向我的默认属性添加一个委托来解决问题，`ECSlidingViewController`如果滑动从屏幕的最右侧边缘开始，则仅拉入菜单：

```
-(BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer
{
  if ([gestureRecognizer locationInView:gestureRecognizer.view].x > ([UIScreen mainScreen].bounds.size.width - 60.0))
  {
    return YES;
  }
return NO;
} 
```

# sublimetext2 - .tmLanguage -- 如何包含/排除变量

> ID：15890308
> 
> 赞同：0
> 
> 时间：2013-04-08T22:40:51.097
> 
> 标签：sublimetext2, tmlanguage

我正在寻找包含/排除`.tmLanguage`文件中定义的几个变量的示例。

**示例 1 - 突出显示整个辣酱玉米饼馅，包括两个变量：**

```
{\code_one*[variable_one]{variable_two}} 
```

**示例 2 - 突出显示整个辣酱玉米饼馅，少一个或两个变量：**

```
{\code_two*[variable_three]{variable_four}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T07:17:02.360

**include_variable_text** -- 例如，`\hspace*{3.45in}`; `\begin{singlespace*}`; `\end{document}`.

.tmLanguage

```
<!-- BEGIN include_variable_text -->
<dict>
    <key>begin</key>
    <string>\\makebox\[|\\hspace\*\{|\\begin\{|\\end\{</string>
    <key>beginCaptures</key>
    <dict>
        <key>0</key>
        <dict>
            <key>name</key>
            <string>lawlist.include_variable_text.begin.latex</string>
        </dict>
    </dict>
    <key>end</key>
    <string>\}|\]</string>
    <key>endCaptures</key>
    <dict>
        <key>0</key>
        <dict>
            <key>name</key>
            <string>lawlist.include_variable_text.end.latex</string>
        </dict>
    </dict>
    <key>name</key>
    <string>lawlist.include_variable_text.latex</string>
    <key>patterns</key>
    <array>
        <dict>
            <key>include</key>
            <string>$base</string>
        </dict>
    </array>
</dict>
<!-- END --> 
```

tm.主题

```
<!-- BEGIN lawlist.include_variable_text -->
<dict>
<key>name</key>
<string>Grayed-Out</string>
<key>scope</key>
<string>lawlist.include_variable_text.latex</string>
<key>settings</key>
    <dict>
    <key>fontStyle</key>
    <string>italic</string>
    <key>foreground</key>
    <string>#E3E3E3</string>
    <key>background</key>
    <string>#FFFFFF</string>
    </dict>
</dict>
<!-- END --> 
```

* * *

**exclude_variable_text**

```
{\bf\uline{excluded_variable_text}} 
```

.tmLanguage - 此代码包含额外的三 (3) 个键以供将来使用 - 例如，`[anything]`

```
<!-- BEGIN exclude_text -->
<dict>
    <key>match</key>
    <string>(?=\s)(?&lt;=\\[\w@]|\\[\w@]{2}|\\[\w@]{3}|\\[\w@]{4}|\\[\w@]{5}|\\[\w@]{6})\s</string>
    <key>name</key>
    <string>meta.space-after-command.latex</string>
</dict>
<dict>
    <key>begin</key>
    <string>((\{\\bf)(?:\\uline|code_two|code_three))(?:(\[)([^\]]*)(\]))?(\{)</string>
    <key>beginCaptures</key>
    <dict>
        <key>1</key>
        <dict>
            <key>name</key>
            <string>lawlist.base.latex</string>
        </dict>
        <key>2</key>
        <dict>
            <key>name</key>
            <string>lawlist.prefix.latex</string>
        </dict>
        <key>3</key>
        <dict>
            <key>name</key>
            <string>lawlist.open_square_bracket.latex</string>
        </dict>
        <key>4</key>
        <dict>
            <key>name</key>
            <string>lawlist.first_variable.latex</string>
        </dict>
        <key>5</key>
        <dict>
            <key>name</key>
            <string>lawlist.close_square_bracket.latex</string>
        </dict>
        <key>6</key>
        <dict>
            <key>name</key>
            <string>lawlist.open_wavy_bracket.latex</string>
        </dict>
    </dict>
    <key>contentName</key>
    <string>lawlist.second_variable.latex</string>
    <key>end</key>
    <string>\}\}</string>
    <key>endCaptures</key>
    <dict>
        <key>0</key>
        <dict>
            <key>name</key>
            <string>lawlist_close_wavy_bracket.latex</string>
        </dict>
    </dict>
    <key>name</key>
    <string>lawlist.whole_enchilada.latex</string>
    <key>patterns</key>
    <array>
        <dict>
            <key>include</key>
            <string>$self</string>
        </dict>
    </array>
</dict>
<!-- END exclude_text --> 
```

*.tm主题

```
<!-- BEGIN strong blue #0000FF -- uline exclude_text -->
<dict>
    <key>name</key>
    <string>Bold / Underline</string>
    <key>scope</key>
    <string>lawlist.base.latex|lawlist.open_square_bracket.latex|lawlist.first_variable.latex|lawlist.close_square_bracket.latex|lawlist.pen_wavy_bracket.latex|lawlist_close_wavy_bracket.latex</string>
    <key>settings</key>
    <dict>
        <key>fontStyle</key>
        <string></string>
        <key>foreground</key>
        <string>#E3E3E3</string>
    </dict>
</dict>
<!-- END --> 
```

# c++ - 引用返回后从内存中删除

> ID：15890310
> 
> 赞同：1
> 
> 时间：2013-04-08T22:41:03.363
> 
> 标签：c++

我有一个关于在 C++ 中从内存中删除内容的问题，以及将不再存在和不再存在的问题。如果我在 C++（标准库）中创建一个队列，向其中添加两个元素，然后调用 front()，将其存储在常规变量中（无指针）。然后我在队列中调用 pop()。我存储的变量仍然存在吗？如果某些东西编辑了队列中的指针曾经存在的内存地址，会发生什么？这是否意味着我之前存储的局部变量不再有效，因为它是从引用创建的？

感谢您的任何澄清。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T22:44:01.307

假设您不在队列中存储指针，而是在实际值或对象中存储，那么当您将 front() 存储到常规变量时，您真正要做的是一个副本（如果它是一个对象，则实际的复制构造函数将是称为）。当您 pop() 队列的元素时，副本不会受到影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T22:52:44.700

我将尝试用代码回答：

```
#include <queue>
#include <iostream>

int main()
{
    // "Q: If I create a queue in C++..."
    std::queue<int> q;

    // "...add two elements to it..."
    q.push(42);
    q.push(1729);

    // "...then call front(), store it in a regular variable (no pointer)..."
    int i = q.front();

    // "...Then I call pop() on the queue..."
    q.pop();

    // ...The variable i stored will still exist right?"

    // A: "Yes, of course! And it retained its value:"
    std::cout << i << std::endl;
} 
```

而且：

> “如果某些东西编辑了队列中的指针曾经存在的内存地址，会发生什么？”

我们没有在队列中存储指针（见上文）！无论如何，如果您的意思是“*如果队列存储其弹出元素的内存区域被释放或覆盖会发生什么*”，答案是我们将该对象的**副本**`i`存储在 中，并且`i`位于完全不同的内存区域中。

> “这是否意味着`i`之前存储的局部变量不再有效，因为它是从引用创建的？”

不，它仍然有效，因为即使它是从通过 的返回值引用的对象分配的`front()`，我们也**复制**了该对象！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-08T22:44:43.790

如果你用 front() 存储它并在之后弹出它，你的对象不再存在（假设你使用的是 STL 中的队列）

发生这种情况是因为 front() 通过引用而不是副本返回包含的对象。

# python - 6x6 数组上的骑士之旅算法仅适用于索引 [0, 0]

> ID：15890311
> 
> 赞同：2
> 
> 时间：2013-04-08T22:41:04.283
> 
> 标签：python, recursion, knights-tour

我必须提到这是我第一次在这个网站上发帖，如果我不遵守这个网站的发球指南，请原谅我。

我的问题可能很简单，但我无法理解。我的骑士之旅算法递归地找到骑士的路径。它适用于索引 [0,0]，它完美地遍历数组的空间......但是，除了索引 [0,0] 之外的任何东西，程序都会挂起看起来像是永恒的东西。这是我的代码：

```
# knightstour.py
#
# created by: M. Peele
# section: 01
# 
# This program implements a brute-force solution for the Knight's tour problem 
# using a recursive backtracking algorithm. The Knight's tour is a chessboard 
# puzzle in which the objective is to find a sequence of moves by the knight in 
# which it visits every square on the board exactly one. It uses a 6x6 array for 
# the chessboard where each square is identified by a row and column index, the 
# range of which both start at 0\. Let the upper-left square of the board be the 
# row 0 and column 0 square.
#
# Imports the necessary modules.
from arrays import *

# Initializes the chessboard as a 6x6 array. 
chessBoard = Array2D(6, 6)

# Gets the input start position for the knight from the user.
row = int(input("Enter the row: "))
col = int(input("Enter the column: "))

# Main driver function which starts the recursion.
def main():
    knightsTour(row, col, 1)

# Recursive function that solves the Knight's Tour problem.    
def knightsTour(row, col, move):
    # Checks if the given index is in range of the array and is legal.
    if _inRange(row, col) and _isLegal(row, col): 
        chessBoard[row, col] = move # Sets a knight-marker at the given index.
        # If the chessBoard is full, returns True and the solved board.
        if _isFull(chessBoard):
            return True, _draw(chessBoard)    

        # Checks to see if the knight can make another move. If so, makes that 
        # move by calling the function again. 
        possibleOffsets = ((-2, -1), (-2, 1), (-1, 2), (1, 2), \
                           (2, 1), (2, -1), (1, -2), (-1, -2))
        for offset in possibleOffsets:
            if knightsTour(row + offset[0], col + offset[1], move + 1):
                return True 
        # If the loop terminates, no possible move can be made. Removes the 
        # knight-marker at the given index. 
        chessBoard[row, col] = None
        return False 
    else:
        return False

# Determines if the given row, col index is a legal move.
def _isLegal(row, col):
    if _inRange(row, col) and chessBoard[row, col] == None:
        return True
    else:
        return False

# Determines if the given row, col index is in range.
def _inRange(row, col):
    try:
        chessBoard[row, col]
        return True
    except AssertionError:
        return False

# A solution was found if the array is full, meaning that every element in the 
# array is filled with a number saying the knight has visited there.
def _isFull(chessBoard):
    for row in range(chessBoard.numRows()):
        for col in range(chessBoard.numCols()):
            if chessBoard[row, col] == None:
                return False
    return True

# Draws a pictoral representation of the array.
def _draw(chessBoard):
    for row in range(chessBoard.numRows()):
        for col in range(chessBoard.numCols()):
            print("%4s" % chessBoard[row, col], end = " ")
        print()

# Calls the main function.
main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:54:30.957

您的代码没有明显的问题。而且，事实上，用`chessBoard`a `list`of替换`list`并适当地更改代码的其余部分，它适用于所有合法输入。

请参阅[此 pastebin](http://pastebin.com/m3q2zJaQ)以获取修改后的代码。有关仅循环所有有效输入的修改版本，请参[见此版本。](http://pastebin.com/avyGDLP1)如果你运行它，它会打印出 36 个完整的电路板。

因此，如果出现问题，或者您没有运行您在此处发布的相同代码，或者您的`Array2D`实现中存在错误。

* * *

您的代码有一些奇怪的地方。

首先，您几乎从不想检查`== None`. 如果您确实需要检查某物是否为`None`，请使用`is`运算符，而不是`==`。如果您所有的“真实”值都是真实的，只需将值本身用作布尔值（因为`None`是虚假的）。有关详细信息，请参阅PEP 8 中的[编程建议](http://www.python.org/dev/peps/pep-0008/#programming-recommendations)。

接下来，您将全局设置拆分为`main`函数和全局模块范围。通常你想在同一个地方做这一切。

最后，拥有一个改变全局变量的递归函数是一件奇怪的事情。并不是说它在您的情况下不起作用（只是因为您在退出之前只能运行一个测试），但通常在递归函数中，您希望将值作为“累加器”参数向下传递，或者做所有事情一成不变（通过向下传递和备份副本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T16:40:06.770

abarnert 的代码起作用的原因是他的函数在重写时使用负索引访问数组。因此，如果您查看结果，它们是不正确的（骑士从棋盘的顶部跳到底部）。

# windows - 在注册表中添加多行

> ID：15890325
> 
> 赞同：2
> 
> 时间：2013-04-08T22:42:05.433
> 
> 标签：windows, string, registry

我有一个经常在多台机器上使用的应用程序。我想导出我通常必须在每台机器上配置的注册表设置，以便我可以编写脚本以在启动时导入它们。该应用程序允许我将多行文本放入文本框中，该文本框将在所有打印输出上覆盖该文本。它将该文本保存在注册表中的字符串中。当我导出注册表时，字符串看起来像这样：

```
"sEndorsement"="Line 1 of text
Line 2 of Text" 
```

由于字符串中的中断，这不能正确导入。有什么想法可以很好地进行导入吗？我真的没有选择在设置中只使用一行文本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T02:04:18.357

而不是使用从导出设置中获得的标准 .reg 文件，您必须通过 VBScript 执行此操作，`vbCrLf`用于在字符串中引入换行符。

```
set ShellObj = CreateObject("WScript.Shell")
ShellObj.RegWrite "HKCU\Software\Key\sEndorsement", "Line1" & vbCrLf & "Line2", "REG_SZ" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T03:38:39.243

假设应用程序及其代码是您的另一种方法是使用 .ini 文件或其他文本文件从标准位置（如 %user-folder%\your-app-name\settings.txt）保存和加载设置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:30:34.280

**如果key=value**的第一行（或唯一一行）总是以双引号开头，那么您的导入代码可以检测到这一点。伪代码：

```
firstLine   = TRUE
keyAndValue = NULL
for each line to import
    line = get line
    if line[0] == '"' then
        if have previous line
            import keyAndValue
        keyAndValue = line
    else
        keyAndValue = concat(keyAndValue, CRLF, line)
end for
if keyAndValue is not NULL
    import keyAndValue 
```

如前所述，这可以在 VBScript 或 Perl 中实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T07:00:54.057

您可以使用[_winreg](http://docs.python.org/2/library/_winreg.html)模块执行一个 Python 脚本。一些片段：

```
from _winreg import *

#read Data:
key = OpenKey(HKEY_LOCAL_MACHINE, r'Software\MyCompany\MyApp', 0, KEY_ALL_ACCESS)
value_data = QueryValueEx(key, "MyValueName")[0]

#write data:
key = OpenKey(HKEY_LOCAL_MACHINE, r'Software\MyCompany\MyApp', 0, KEY_WRITE)
SetValueEx(key, "MyValueName", 0, REG_SZ, "MyValueData") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:26:01.290

`vbCrLf`正如其他人所提到的，您可以通过使用[RegWrite 函数](http://ss64.com/vb/regwrite.html)来使用 VBScript 。

或者，我不确定这是否可能在您的问题的上下文中，将注册表项类型更改为`REG_MULTI_SZ`而不是`REG_SZ`.

`REG_MULTI_SZ`字符串以 null 结尾，如下所示：

```
String 1\0String2\0String3\0 
```

您可以在阅读注册表后浏览它们，然后在您的应用程序中使用换行符加入它们。

[MSDN 对](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724884%28v=vs.85%29.aspx)这些工作原理和代码示例有很好的描述。

# javascript - 使用 Javascript 和表单将表单信息用作变量

> ID：15890329
> 
> 赞同：1
> 
> 时间：2013-04-08T22:42:23.377
> 
> 标签：javascript, forms, alert, var

好的，Stack Overflow 的人，我有一个问题要问你：我在高中的网页设计课上学习，因为我已经知道了课堂的前半部分。我的老师问我是否可以教我学到的关于 Javascript 的知识，我同意了。然而，当我自己尝试时，她想让我教的一件事对我不起作用。我正在尝试对变量进行简单检查，当您在框中输入姓名时，如果是我的姓名或老师的姓名，它会弹出一个显示“欢迎”或类似内容的弹出窗口，如果是任何人否则它会说“走开”，唯一的问题是，无论我尝试什么，代码中的某些东西都不起作用。这是我目前拥有的测试功能；它旨在打印出

```
<!doctype html>
<html>

<head>

<script type="text/javascript">
    var name = document.KageForm.User.value;

      function validator(){
        alert(name);

    }
    </script>

    </head>
    <body>

    <form name="KageForm">
        Username:<input type="text" name="User">
    <br/>
        Password: <input type="password" name="pass">
    <br/>
    <input type="button"value="Submit" onclick="validator()" />
    </form>

    <script type="text/javascript">
    </script>
</body>
</html> 
```

这是我试图开始工作的代码的完整版本：

```
<!doctype html>
<html>

<head>

<script type="text/javascript">
    var name = document.KageForm.User.value;

      function validator(){
if(name=="Kage Kaldaka"){
            alert("Eeyup")};
        else
            alert("Nnope");
    }
    </script>

    </head>
    <body>

    <form name="KageForm">
        Username:<input type="text" name="User">
    <br/>
        Password: <input type="password" name="pass">
    <br/>
    <input type="button"value="Submit" onclick="validator()" />
    </form>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T22:47:05.770

您在这里有几个问题：

*   `if`语句后有一个分号
*   您正在读取页面加载时的名称值，此时输入字段甚至还没有添加到页面中，并且用户肯定还没有填写。您需要在用户提交表单时阅读它，即您需要`name`在方法内移动赋值`validator`：

JS：

```
function validator(){
    var name = document.KageForm.User.value;
    if(name=="Kage Kaldaka"){
        alert("Eeyup");
    } else {
        alert("Nnope");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:54:07.803

除了所有先前的答案之外，在 JavaScript 中使用 === 而不是 == 是一种很好的方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T22:45:28.357

后面不应该有分号`if`。您还必须将变量放入函数中以使其更新：

```
function validator(){
    var name = document.KageForm.User.value;
    if(name=="Kage Kaldaka"){
        alert("Eeyup")
    } else {
        alert("Nnope");
    }
} 
```

JSFiddle：http: [//jsfiddle.net/FhCTc/1/](http://jsfiddle.net/FhCTc/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T22:48:45.077

您在函数之外设置变量：

```
<script type="text/javascript">
var name = document.KageForm.User.value;

function validator(){
  if(name=="Kage Kaldaka"){
        alert("Eeyup")};
    else
        alert("Nnope");
}
</script> 
```

这意味着`var name`在页面加载时设置，但没有其他时间。将其移入`validator()`.

您还以`if`分号结尾，这会导致该`else`部分出错。

# mongodb - Mongodb - 使用特定于用户的定价对产品目录进行建模

> ID：15890337
> 
> 赞同：0
> 
> 时间：2013-04-08T22:42:42.793
> 
> 标签：mongodb

查看 mongoDB 产品目录示例（用于数据缓存查找），我将如何最好地实现特定于登录用户的定价和可用数量。我正在描绘这样的布局：

```
[{"_id":"skuA",
  "details":{ "msrp": "$15", "short_desc": "my short description"}
, "PriceQty" : [{"custid": 1, "price":10 , "qty":25 },{"custid": 2, "price":9 , "qty":20 }]
}] 
```

（但我需要在用户登录时推送更新的（或在首次登录时添加）定价（例如：从所有文档中删除 where custid = 1 并推送）。或者保留项目信息是否有意义一个地方并创建一个单独的集合来保存 sku、价格、客户和数量？不确定我将如何使用参考 ID 来使用第二种方法从项目集合到定价集合的有效 SQL 左连接。

项目集合将容纳 100k+（用于报价目的），但价格和数量将容纳 2k 以用于可以当场订购的东西。不幸的是，我的思想仍然在关系世界中。

# python - 在剧本中处理变量

> ID：15890344
> 
> 赞同：0
> 
> 时间：2013-04-08T22:44:20.433
> 
> 标签：python, ansible

我想制作一个脚本来在计算机实例之间快速设置一个 TINC vpn。我需要的是一种通过“/tmp/setup_tinc.py”命令行传递以下参数的方法：

```
--connect-to %{{ ' '.join( groups['do'] }}% 
```

在哪里`%{{ part }}%`将在 python 中解释。但我似乎找不到一个好方法来做到这一点。**你能帮我修复这段代码吗？**

我制作了[以下剧本](https://gist.github.com/fclairamb/5340949#file-setup_tinc-yml)：

```
- name: tinc install & setup
  hosts: do
  user: root
  vars:
    tincnet: cloudnet
  tasks:
  - name: Install tinc package
    action: command apt-get install tinc python-argparse -y
  - name: Copy tinc setup script
    action: copy src=setup_tinc.py dest=/tmp/setup_tinc.py mode=755
  - name: Run tinc setup script
    action: command /tmp/setup_tinc.py --network $tincnet --tinc-ip $tinc_ip --hostname     $hostname
  - name: Fetch back the tinc file
    action: fetch src=/etc/tinc/$tincnet/hosts/$hostname dst=hosts
  - name: Adding firewall rule
    action: command ufw allow 514 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T19:55:28.547

在 Ansible 1.1 和更早的版本中，这有点棘手。您不能像在模板中那样在剧本中内嵌 Python 代码。但好消息是，GitHub 上最新代码库（将作为 1.2 版发布）中的一些功能也允许在剧本中使用 Jinja2 风格的模板！检查这个线程：

[https://groups.google.com/forum/#!topic/ansible-project/Gb3ABiEtGtA](https://groups.google.com/forum/#!topic/ansible-project/Gb3ABiEtGtA)

因此，这意味着您将能够：

--connect-to {{''.join(groups['do'] }}

...如果您使用的是最新的 GitHub 代码，就在剧本中。

希望这可以帮助！

# ios - 带有 UITextField 的自动布局导致异常

> ID：15890347
> 
> 赞同：0
> 
> 时间：2013-04-08T22:44:43.900
> 
> 标签：ios, objective-c, uiviewcontroller, autolayout

我想使用自动布局（动态调整大小和文本字段与其父视图之间的 5 pt 边距）将**UITextField**放置在**UIViewController视图中。****我使用loadView**方法以编程方式创建视图。

UIViewController 的头部

`@property (weak, nonatomic) UITextField *textField;`

执行

```
-(void)loadView{

    //Frame
    UIView *frame = [[UIView alloc]initWithFrame:CGRectMake(0, 0, 100, 40)];
    [self setView:frame];
    [self.view setBackgroundColor:[UIColor redColor]];

    //TextField
    [self.textField setDelegate:self];
    [self.textField setTranslatesAutoresizingMaskIntoConstraints:NO];
    [self.textField setBackgroundColor:[UIColor blueColor]];
    [frame addSubview:self.textField];

    [frame addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-(5@50)-[textField(==10@10)]-(5@50)-|"
                                                                  options:0
                                                                  metrics:nil
                                                                    views:@{@"textField" : self.textField}]];

    [frame addConstraints:[NSLayoutConstraint constraintsWithVisualFormat: @"V:|-(5@50)-[textField(==10@10)]-(5@50)-|"
                                                                  options:0
                                                                  metrics:nil
                                                                    views:@{@"textField" : self.textField}]];

//    //Test with UIView instead
//    UIView *sub = [[UIView alloc]init];
//    [sub setTranslatesAutoresizingMaskIntoConstraints:NO];
//    [sub setBackgroundColor:[UIColor greenColor]];
//    [frame addSubview:sub];
//    
//    [frame addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-(5@50)-[sub(==10@10)]-(5@50)-|"
//                                                                  options:0
//                                                                  metrics:nil
//                                                                    views:@{@"sub" : sub}]];
//    
//    [frame addConstraints:[NSLayoutConstraint constraintsWithVisualFormat: @"V:|-(5@50)-[sub(==10@10)]-(5@50)-|"
//                                                                  options:0
//                                                                  metrics:nil
//                                                                    views:@{@"sub" : sub}]]; 
```

运行它会引发异常。奇怪地使用 UIView （“sub”）作为子视图（注释掉的部分）确实按预期工作。

输出：

![使用 UIView 自动布局](https://i.stack.imgur.com/LiD8M.png)

文本字段不应该像这个 UIView 一样吗？为什么 textField 会导致异常？

* * *

新发现：仅当我在**self.textField上使用****addConstraints**时，应用程序才会崩溃。如果我删除这两个调用，我可以避免崩溃，但是文本字段也不会显示。

 *** * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-08T22:54:32.787

**NSLayoutConstraint 只是 IOS 6 的一部分。如果您尝试使用 IOS6 以外的代码（例如 IOS 5、IOS 4.3），您很可能会遇到此运行时错误。****

# python - 打印返回意外结果的参数值，Python

> ID：15890352
> 
> 赞同：0
> 
> 时间：2013-04-08T22:44:48.187
> 
> 标签：python, python-2.7, namespaces

我有以下 python 脚本 snidbit：

```
inLines = sys.argv[0]

arcpy.AddMessage(inLines) 
```

输入参数是一个多值输入，用户可以导航到一个文件位置并选择多个文件作为输入。

当我打印出变量时，我得到以下信息：

> Y:\2012_data\INFRASTRUCTURE.gdb\Buildings;'Z:\DATA FOR 2009\Base.gdb\CREEKS_UTM';'Z:\DATA FOR 2009\Base.gdb\LAKES_UTM'

注意 Z:drive，它返回带有单引号的路径，而 Y:drive 没有。我相信这是由 Z:drive 路径中的空格引起的。有没有办法强制 Z:drive 路径在没有引号的情况下返回？

谢谢，迈克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:59:56.543

我设法解决了这个问题。由于路径名称，Python 以不同方式处理参数。在第一个参数中，文件路径中没有空格。在其他 2 个参数中，有空格。Python 不喜欢空格，因此它将文件路径强制为字符串值。我刚刚写了一些代码来覆盖它。

# google-chrome - 为什么 Chrome 不显示来自 S3 存储桶的图片？

> ID：15890354
> 
> 赞同：2
> 
> 时间：2013-04-08T22:45:07.917
> 
> 标签：google-chrome, firefox, amazon-s3

在我的网站中，使用 Firefox 时，我可以看到这张图片`http://live.user.data.s3.amazonaws.com/user/photo/7583/thumb_profile_JZ_Blue_shirt_cropped_3_Jan_2013_color_adj.jpg`

但是，当尝试在 Chrome 中打开该 URL 时，什么也没有发生 - 为什么会这样？

# c++ - c ++在同一方法内调用类方法

> ID：15890356
> 
> 赞同：-1
> 
> 时间：2013-04-08T22:45:21.917
> 
> 标签：c++, visual-studio-2010

我正在编写 clsLog 类：

```
// This is the main DLL file.

#include "stdafx.h"

#include <time.h>

#include <fstream>
#include <iostream>
#include <string>

#include "clsLog.h"

std::string     m_strCurLogUser; 
int         m_iCurLogAction;        
int         m_iCurLogLevel;     
std::ofstream           m_oCurLogFile;

// 
// LogInit
// Initilize the log parameters of the system.
// The FileName will be the file name that the system will log the messages (LOG.TXT is the default if no names are given).
// The DatabaseName and TableName specifies the database and table name to be used for log. The default is "LOG_DATABASE" and "LOG_TABLE"
// will be done.
// The Action shall be an OR with all the options. Att: If an option is giver (ex: Database) and an invalid name is given, then an error will occur.
//
// The default log level is zero (0). So every log with a level upper than that will be logged. A change to the level must be done 
// using the SetLogLevel method.
//
// return = 0: Success
//      1: Failure
//
int LogInit (std::string FileName,      // Initialize the log file/connection.
             std::string DatabaseName,  // Database name to connect to.
             std::string TableName,     // Table name to connect to.
             std::string UserName,      // User name to log into
             int Action)                // Action to be done.
{
    //
    // If the file is already open, someone is calling that function before closing the previous one. Error.
    //
    if (m_oCurLogFile.is_open ())
    {
        std::string msg;

        msg = "LogInit called for " + FileName + " witout closing previous session. Error";
        this->clsLog::Log (msg);
    }

        // Do some stuff

    return 0;
}

// 
// Log
// Logs the Message according to its Level.
//
// return = 0: Success
//          1: Failure
//
int Log (std::string Message, int Level) // Register a log according to the log state.
{
    time_t now;
    struct tm ptm;
    char buffer [32];

    //
    // If the sent message level is below the current level, abort.
    //
    if (Level < m_iCurLogLevel)
        return 1;

    // Get the current date and time and convert it to the time structure (ptm)
    now = time (NULL);
    localtime_s (&ptm, &now);

    //
    // Format the time structure: DD/MM/AAAA HH:MM:SS)
    strftime (buffer, 32, "%D/%M/%Y %H:%M:%S", &ptm);

    // Check if needs to be logged on stdio
    //
    if ((m_iCurLogLevel & LOGACTION_STDOUT) == LOGACTION_STDOUT)
    {
        cout << buffer + " " + Message; 
    }

    return 0;
} 
```

我无法编译。我收到以下错误

```
this->clsLog::Log (msg); 
```

“->Log”左侧的 C2227 错误必须指向类/结构/联合/泛型类型。使用VS2010，Win32应用。

帮助表示赞赏。

路数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:48:02.910

该`this`指针仅在作为类或结构的（非静态）成员的方法内有效。没有`this`简单的功能，例如`LogInit`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T22:50:24.420

我没有看到任何证据表明您的函数在类定义中；因此，正如错误消息所说，没有可用的“this”指针。“This”仅在类的实例成员中可用。

# javascript - 页面滚动 jQuery 导航

> ID：15890360
> 
> 赞同：2
> 
> 时间：2013-04-08T22:45:39.333
> 
> 标签：javascript, jquery, html, css

我正在建立一个可以在这里查看的网站：[argit.bounde.co.uk](http://www.argit.bounde.co.uk)

我已经完成了大部分内容，现在我正在尝试进行导航。我有三个导航栏（只有一个是可见的）并且无论显示哪个都需要这种方法。如果您调整浏览器的大小以使窗口变窄将显示第二个，然后当您滚动时出现的导航是第三个。

我已经让它以一种时尚的方式工作，但问题是当我单击一个链接时，它会立即跳转到它想要去的地方，然后返回，然后按预期滚动。这是因为我在导航中留下了“href="#target"。我尝试过包含“return false”，但是如果浏览器不支持 JS，那么导航根本不起作用。

下一个问题是我想要一种使目标“结束”的方法。当前，当您单击链接时，它会滚动到选定的链接，并且导航会在通过它们时更新哪个链接“结束”。当用户向上和向下滚动页面时，我想要这个，但是如果他们单击一个链接，我希望该链接“结束”（以及来自其他导航的相应链接）并且不受通常会滚动检查的影响覆盖它。

我用于 onClick 导航的解决方案如下，我知道有插件可以做这种事情，但我想自己写，这样我可以更好地理解 jQuery。我不确定我目前使用的解决方案是否是一个好的解决方案，如果不是，请告诉我：

```
function navigation() { 
    $('html, body').stop().animate({
        scrollTop: $($(this).attr('href')).offset().top
    }, 1500);
} 
```

我用于滚动检查的解决方案是我偶然发现的，它在下面，它通过覆盖它上面的方程来工作，实际上非常简单。还有一个动作可以在滚动时修复导航。

```
function navCheck() {

var documentHeight = $(document).height();
var windowHeight = $(window).height();
var windowTop = $(window).scrollTop() + 100;

var navTop = $("#scrollanchor").offset().top;
var mobileTop = $("#mobileanchor").offset().top;
var mobileHeight = $("#mobileanchor").height();

var overviewTop = $("#slider").offset().top;
var bioTop = $("#bio").offset().top;
var solutionsTop = $("#solutions").offset().top;
var experianceTop = $("#experiance").offset().top;
var contactTop = $("#contact").offset().top;

if($(window).scrollTop() > navTop) {
   $("#leftfixer").addClass("leftfix");
    } else {
       $("#leftfixer").removeClass("leftfix");
}

if($(window).width() < 1200){
    if(windowTop - 90 > mobileTop + mobileHeight) {
        $("#mobilefix").slideDown();
        } else {
            if(windowTop - 96 <= mobileTop) {
                $("#mobilefix").hide();
            }
        } 
    } else {
        $("#mobilefix").slideUp();
}

$("li").removeClass("over");
$("li.navoverview").addClass("over");

if(windowTop > bioTop) {
    $("li").removeClass("over");
    $("li.navbio").addClass("over");
}

if(windowTop > solutionsTop) {
    $("li").removeClass("over");
    $("li.navsolutions").addClass("over");
}

if(windowTop > experianceTop) {
    $("li").removeClass("over");
    $("li.navexperiance").addClass("over");
}

if(windowTop > contactTop || windowTop > documentHeight - windowHeight) {
    $("li").removeClass("over");
    $("li.navcontact").addClass("over");
}
} 
```

这是我在这里的第一篇文章，所以如果我错过了任何信息，我很抱歉！我也寻找过类似的帖子，但似乎大多数人在做这种事情时都会选择插件。谢谢

**更新：**页面跳转到锚点已修复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:02:50.163

通常，如果你使用 JavaScript 滚动页面，你会`return false;`在调用函数之后放置。这可以防止页面暂时滚动到锚点。

就像是

```
function navigation() { 
    $('html, body').stop().animate({
        scrollTop: $($(this).attr('href')).offset().top
    }, 1500);
    return false;
} 
```

# mysql - 从表 B 中不存在的表 A 中选择

> ID：15890367
> 
> 赞同：10
> 
> 时间：2013-04-08T22:46:17.843
> 
> 标签：mysql, select

我正在尝试为 MySQL 编写一个 SELECT 语句，该语句从表 A 中选择表 B 中不存在的内容。例如：

表 A：

```
+------+
| BAND |
+------+
| 1    |
| 2    |
| 3    |
| 4    |
| 5    |
+------+ 
```

表 B：

```
+------+
| HATE |
+------+
| 1    |
| 5    |
+------+ 
```

因此，如果表 A 是所有乐队，而表 B 是我讨厌的乐队，那么我只想要我不讨厌的乐队。所以选择的结果应该是：

```
+------+
| BAND |
+------+
| 2    |
| 3    |
| 4    |
+------+ 
```

我将如何为此编写一个选择？这是我最后一次尝试：

```
SELECT * FROM A LEFT JOIN B ON A.BAND = B.HATE WHERE B.HATE IS NULL; 
```

编辑：上面的行已修复！请参阅下面的评论...“= NULL”与“IS NULL”。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-08T22:54:16.463

我会使用连接

```
select A.*
from A left join B on A.BAND = B.HATE
where B.HATE IS NULL; 
```

请记住：为您的表创建适当的索引

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-08T22:47:44.813

您可以使用`IN`，但它的效率非常低：

```
SELECT * FROM tableA WHERE id NOT IN (SELECT id FROM tableB) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-14T15:47:00.160

```
SELECT * FROM tableA WHERE id NOT EXISTS (SELECT DISTINCT id FROM tableB) 
```

或者

```
SELECT * FROM tableA WHERE id NOT EXISTS (SELECT id FROM tableB GROUP BY id) 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2014-12-17T11:26:29.787

```
SELECT BAND FROM A WHERE BAND NOT EXISTS(SELECT DISTINCT HATE FROM B) 
```

或者

```
SELECT BAND FROM A WHERE NOT EXISTS ( SELECT HATE FROM B WHERE A.BAND = B.HATE); 
```

# mysql - 如何根据某些条件插入或更新？

> ID：15890370
> 
> 赞同：2
> 
> 时间：2013-04-08T22:46:59.057
> 
> 标签：mysql, insert-update

有人可以帮我解决这个问题吗！我有 2 张桌子：

1.具有自定义日期相关定价窗口的现有定价表：

```
 id | prod id |   start    |    stop    |   price  
-----+---------+------------+------------+-----------
   1 |   65210 | 2012-01-01 | 2013-01-01 |  5.00     
   2 |   54841 | 2012-02-05 | 2013-03-01 | 15.00     
   3 |   51518 | 2012-01-01 | 2013-01-01 |  5.00     
   4 |    8402 | 2012-01-01 | 2017-01-01 |  5.00     
   5 |    1520 | 2012-01-01 | 2050-01-01 | 12.00     
   6 |     959 | 2013-10-01 | 2018-01-01 |  5.00 
```

2.“新”定价数据表（用于按每个唯一更新上表`prod id`）：

```
 prod id |   start    |    stop    |   price   
  -------+------------+------------+-----------
   65210 | 2013-01-01 | 2025-01-01 |  5.00     
   54841 | 2013-02-05 | 2017-03-01 | 15.00     
     959 | 2013-01-01 | 2017-01-01 |  5.00 
```

假设它仍然“在窗口中”，用表 2 中的日期更新`stop`表 1 中的日期的最佳方法是什么？`stop`如果现有`stop`日期早于“新”`start`日期，则将使用新日期`start`和`stop`日期创建新定价记录。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-30T05:52:31.597

*...用表 2`stop`中的日期更新表 1 中的`stop`日期，假设它仍然“在窗口中”...*

```
UPDATE price p JOIN new_price n
    ON p.prod_id = n.prod_id
   AND n.start BETWEEN p.start AND p.stop
   SET p.stop = n.stop 
```

插入新记录*“...如果现有`stop`日期早于新`start`日期...”*

```
INSERT INTO price (`prod_id`, `start`, `stop`, `price`)
SELECT n.prod_id, n.start, n.stop, n.price
  FROM new_price n JOIN price p
    ON n.prod_id = p.prod_id
   AND n.start > p.stop 
```

这是**[SQLFiddle](http://sqlfiddle.com/#!2/bf8c4/1)**演示

# python - 打开具有命名范围的 Excel 文件时出现 xlrd 错误

> ID：15890373
> 
> 赞同：1
> 
> 时间：2013-04-08T22:47:17.083
> 
> 标签：python, excel, xlrd

尝试在 Python 3.2.4 上使用 xlrd 0.9.1 打开工作簿时，我收到以下错误消息。我测试了可能导致问题的原因，并已将其排除在具有命名范围的电子表格中。

```
Traceback (most recent call last):
  File "C:\Users\mandroid\Desktop\xltest.py", line 5, in <module>
    book = open_workbook(pth)
  File "C:\Python32\lib\site-packages\xlrd\__init__.py", line 416, in open_workbook
    ragged_rows=ragged_rows,
  File "C:\Python32\lib\site-packages\xlrd\xlsx.py", line 725, in open_workbook_2007_xml
    x12book.process_stream(zflo, 'Workbook')
  File "C:\Python32\lib\site-packages\xlrd\xlsx.py", line 251, in process_stream
    meth(self, elem)
  File "C:\Python32\lib\site-packages\xlrd\xlsx.py", line 346, in do_defined_names
    self.do_defined_name(child)
  File "C:\Python32\lib\site-packages\xlrd\xlsx.py", line 335, in do_defined_name
    nobj.formula_text = cooked_text(self, elem)
  File "C:\Python32\lib\site-packages\xlrd\xlsx.py", line 130, in cooked_text
    return unicode(unescape(t))
TypeError: <lambda>() takes exactly 2 arguments (1 given) 
```

从我读过的内容来看，xlrd 似乎具有命名范围功能，所以我不确定是什么原因造成的。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T11:54:08.280

这是 xlrd 0.9.1 中的一个错误：[https ://github.com/python-excel/xlrd/issues/47](https://github.com/python-excel/xlrd/issues/47)

您可以尝试 0.9.0，等待 0.9.2，或应用 John Machin 在报告中建议的修复。

# zend-framework - 当我在 Zend Framework 2 中创建自定义表单元素时，为什么不能使用短名称？

> ID：15890374
> 
> 赞同：3
> 
> 时间：2013-04-08T22:47:22.070
> 
> 标签：zend-framework, zend-framework2

我在这里创建自定义元素：[ZF2Docs: Advanced use of Forms](http://framework.zend.com/manual/2.1/en/modules/zend.form.advanced-use-of-forms.html)

1.在Application/Form/Element/CustomElement.php中创建CustomElement类

2.添加到我的Module.php函数

```
public function getFormElementConfig()
{
    return array(
        'invokables' => array(
            'custom' => 'Application\Form\Element\CustomElement',
        ),
    );
} 
```

如果我使用 FQCN 它工作正常：

```
$form->add(array(
    'type' => 'Application\Form\Element\CustomElement',
    'name' => 'myCustomElement'
)); 
```

但如果我使用短名称：

```
$form->add(array(
    'type' => 'Custom',
    'name' => 'myCustomElement'
)); 
```

抛出异常：

```
Zend\ServiceManager\ServiceManager::get was unable to fetch or create 
an instance for Custom 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T06:48:20.840

# 问题

该错误可能是由于您实例化`$form`对象的方式。如果您只使用`new Zend\Form\Form`表达式或类似的东西，则不会使用正确的服务定位器设置表单。

```
$form = new \Zend\Form\Form;
$form->add(array(
    'type' => 'custom',
    'name' => 'foobar',
)); 
```

# 解决方案

这里的技巧是使用`FormElementManager`服务定位器来实例化表单。

```
// inside a controller action
$form = $this->getServiceLocator()->get('FormElementManager')->get('Form');
$form->add(array(
    'type' => 'custom',
    'name' => 'foobar',
)); 
```

更好的是，`form()`在您的控制器中定义一个方法作为为您执行此操作的快捷方式：

```
class MyController extends AbstractActionController
{
    public function form($name, $options = array())
    {
        $forms = $this->getServiceLocator()->get('FormElementManager');
        return $forms->get($name, $options);
    }

    public function createAction()
    {
        $form = $this->form('SomeForm');
        // ...
    }
} 
```

# 解释

每个表单对象都附加到表单工厂，该表单工厂又附加到服务定位器。该服务定位器负责获取所有用于实例化新表单/元素/字段集对象的类。

如果您实例化一个新的表单对象（全部单独），则会实例化一个空白服务定位器并用于获取该表单中的后续类。但是随后的每个对象都附加到同一个服务定位器。

这里的问题是`getFormElementConfig`配置了这个服务定位器的一个非常具体的实例。这是`FormElementManager`服务定位器。配置完成后，从此服务定位器中提取的所有表单都将附加到此服务定位器，并将用于获取其他元素/字段集等。

希望这可以解决您的问题。

# android - Android设备，内部磁盘空间很快耗尽

> ID：15890376
> 
> 赞同：0
> 
> 时间：2013-04-08T22:47:23.630
> 
> 标签：android, debugging, memory-leaks

我正在开发的一个应用程序有问题。

到目前为止，我正在使用 USB 调试模式在我的 Android 设备中安装/更新应用程序，即华为 MediaPad 7 Lite (Android ICS 4.0.3)。

该应用程序正在使用（根据应用程序菜单中的内部存储）4.91 MB。

我们一直在对其进行测试，磁盘空间以每周 1GB 的速度被消耗……Waaay 空间太大了。

我检查了我的应用程序，乍一看找不到内存泄漏。我进行了很多搜索，在极少数地方，我发现关闭 USB 调试会有所帮助。

我的问题是...

这可能是由“USB 调试模式”中我不知道的日志记录或其他功能引起的，还是肯定是我这边的编码问题？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:57:55.920

问题出在操作系统本身。

Android 可以选择记录所有 GPS 信息，显然，这仅在某些设备上启用。

解决方案是禁用此 GPS 日志，设备需要 root 并且您需要编辑位于 /system/etc/gps/glconfig.xml 中的文件

找到块

```
<hal
acPortName="/dev/ttyS3"
IBaudRate="115200"
cLogEnableInitState="true"
cLogEnabled="true"
acLogDirectory="/data/gps/log/"
acNmeaOutName="/data/gpspipe"
ctrlPipe="/data/gps/glgpsctrl"
acNvStoDir="/data/gps/"
ItoFileName="Ito2.dat"
/> 
```

我们需要更改的只是cLogEnabled="true" 行，将其设为false，仅此而已。

# javascript - 根据下拉选择显示文本（代码适用于 jsfiddle 但不适用于网站？）

> ID：15890378
> 
> 赞同：0
> 
> 时间：2013-04-08T22:47:39.480
> 
> 标签：javascript, jsfiddle

我在某处遇到此代码的问题，但无法弄清楚。[这是jsfiddle链接](http://jsfiddle.net/2ukyA/39/)

```
document.getElementById('email-list').onchange = function() {
    var i = 1;
    var myDiv = document.getElementById(i);
    while(myDiv) {
        myDiv.style.display = 'none';
        myDiv = document.getElementById(++i);
    }
    document.getElementById(this.value).style.display = 'block';
}; 
```

在那里工作正常，但我可以让它在本地的 wamp 或 live 上的两个不同网站中的任何一个上工作。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:57:14.173

您的 JS Fiddle 示例有效，因为您`onload`在 JsFiddle 中选择了选项。所以请确保你已经用`window.onload`

```
window.onload = function(){
document.getElementById('email-list').onchange = function() {
    var i = 1;
    var myDiv = document.getElementById(i);
    while(myDiv) {
        myDiv.style.display = 'none';
        myDiv = document.getElementById(++i);
    }
    document.getElementById(this.value).style.display = 'block';
}}; 
```

[JS 小提琴示例](http://jsfiddle.net/2ukyA/41/)

# c++ - 如何部署可移植的 C++ 应用程序？

> ID：15890384
> 
> 赞同：0
> 
> 时间：2013-04-08T22:47:51.130
> 
> 标签：c++, deployment

我使用 Qt 库编写了一个可移植的 C++ 应用程序。这意味着我不能在不冒内存问题的情况下使用 MT 标志进行编译。

这给我留下了两个选择：

1) 使用安装程序部署可移植应用程序。

2) 将 C++ 依赖项打包在同一文件夹中或使用私有程序集。

1 和 2 都否定了便携式软件的想法，所以我在考虑第三种选择：

3) 在启动应用程序之前使用 IExpress 删除 C++ 依赖项。退出时，删除 C++ 依赖项。

不幸的是，选项 3 受到了一些 stackoverflow 成员的抨击。他们甚至不喜欢选项 2，这让我只有选项 1。如果我使用便携式安装程序，我可以看到选项 1 是可行的。

是否有便携式安装程序之类的东西？本质上，我希望安装程序在运行我的应用程序之前检查是否安装了所需的依赖项（就像常规安装程序一样），如果是，则继续运行我的应用程序。否则，向用户提供一个消息框，让他们可以下载它，并提供指向 URL 的链接。我知道我可以编写自己的安装程序，可以在 C++ 中执行此操作，但我想知道是否有任何安装程序已经提供此特定功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:55:43.507

[http://qt-project.org/doc/qt-4.8/deployment.html](http://qt-project.org/doc/qt-4.8/deployment.html)

Windows 中 Qt 的 dll 非常小，在我看来，将它们与应用程序一起部署不是问题。

我知道没有任何程序可以将 Qt dll 放置在 Windows 上的某个位置，以便稍后另一个程序会找到（例如 c:/Windows/system32）。

我认为唯一可以期望重用库的地方是 Linux 或具有大量 Qt 应用程序的移动设备。但即便如此，您也必须确保库的版本足够高以支持您正在使用的所有功能。

希望有帮助。

# java - java.lang.NumberFormatException：无效的长：“”

> ID：15890395
> 
> 赞同：0
> 
> 时间：2013-04-08T22:48:58.030
> 
> 标签：java, android

我正在以这种格式获取 DOB 字符串`"\/Date(588657600000-0400)\/"`，我正在解析如下。

```
String target = custom.getDOB();
if (target == null || target == "") {
    holder.item3.setText("-");
} else {
    long millis = Long.parseLong(target.substring(
                 target.indexOf("(") + 1, target.indexOf("-")));
    java.text.DateFormat df = new SimpleDateFormat("MM-dd-yyyy", Locale.ENGLISH);
    holder.item3.setText(df.format(new Date(millis)));
} 
```

我收到此错误 "04-08 22:44:09.864: E/AndroidRuntime(3837): `java.lang.NumberFormatException`: Invalid long: "" 。我之前正在检查我的 String 对象是否包含`null or ""`并将其设置为“-”，但我仍然我得到了这个例外。

**更新：**

> 04-08 22:59:17.423: E/AndroidRuntime(4175): java.lang.NumberFormatException: Invalid long: "" 04-08 22:59:17.423: E/AndroidRuntime(4175): 在 java.lang.Long。 invalidLong(Long.java:125) 04-08 22:59:17.423: E/AndroidRuntime(4175): at java.lang.Long.parseLong(Long.java:346) 04-08 22:59:17.423: E/ AndroidRuntime(4175)：在 java.lang.Long.parseLong(Long.java:319)

我将我的 null 和空字符串文字检查更改为此，但我仍然收到此错误。

```
if(target == null || target.equals("")) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T22:50:40.973

用于[`String#equals`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals%28java.lang.Object%29)比较字符串值；运算符`==`比较对象引用是否相等。

```
if (target == null || target.equals("")) { 
```

测试时您使用`==`正确`null`，因为您确保您的`target`参考不是`null`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:56:38.017

作为检查字符串是否为空或“”的快捷方式，您还可以使用

`StringUtils.isEmpty(target)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-09T05:33:04.943

```
 Use Try and catch 

      String  values=Util.getStringFromSP(getActivity(),"time");
        try {
        PERIOD_MS = Long.parseLong(values);
    } catch (Exception e) {

        Log.d("time", "" + values);
        if (PERIOD_MS == 0) {
            PERIOD_MS = 1000;
        } 
```

# sql-server-2008 - 在存储过程中加入两个 sql 语句 - （没有相同的列）

> ID：15890404
> 
> 赞同：0
> 
> 时间：2013-04-08T22:49:58.580
> 
> 标签：sql-server-2008, select, stored-procedures

我有一种情况，它处理具有不同列的两组数据。我知道我可以使用 UNION 但 UNION 要求两个表中的表达式数量相等。我试图在我的存储过程中加入这两个语句。第一条语句有一个额外的列“位置”

```
Select 
  TableA.Name,
  TableB.Occupation,
  TableA.Location,
  'Group1' AS [groupBy]
From
 TableA,
 TableB
Where
 TableA.ID = 1

Select 
  TableA.Name,
  TableB.Occupation,
  'Group2' AS [groupBy]
From
 TableA,
 TableB
Where
 TableB.ID = 10 
```

我的结果应该是这样的

```
Name    Occupation      GroupBy   Location
David   Doctor          Group1    USA
John    Pilot           Group1    Asia
Dwayne  Wrestler        Group2    NULL
Axel    RockStar        Group2    NULL 
```

我的表结构

```
Table A

ID Name  Occupation Location 
1  David Doctor     USA
1  John  Pilot      Asia
2  Mike  Clerk      Europe

Table B 

ID  Name   Occupation
3   Wayne  Writer
4   Shane  Publisher
10  Dwayne Wrestler
10  Axel   Rockstar 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T21:22:34.317

这称为UNION；只需在第二个查询中手动将“，NULL”添加到选择列表中

根据需要添加任意数量的它们，无论您在哪里需要它们。如果您需要两个表中的其他列，则第一个表中的 NULL 实例必须使用适当的列名作为别名。

# c# - 使用 LDAP/AD 查找用户订阅的邮件列表

> ID：15890409
> 
> 赞同：4
> 
> 时间：2013-04-08T22:50:20.803
> 
> 标签：c#, .net, active-directory

我目前正在研究获取用户订阅的邮件分发列表列表。我以前从未使用过 Active Directory，在这里和 MSDN 上阅读了各种答案后，我很困惑。

我的查询设置如下：

```
DirectorySearcher search = new DirectorySearcher();
search.Filter = String.Format("LDAP://CN={0},OU=<value here>,DC=<value>...", userName);
search.SearchScope = SearchScope.Subtree;
search.PropertiesToLoad.Add("memberOf");
SearchResult result = search.FindOne();
if(result != null)
{
    // Do stuff here
} 
```

以下是我的问题：

1.  DirectorySearcher 中的 SearchRoot 属性有什么作用？我是否需要进行设置才能让此查询返回一个值？
2.  我是否需要将 SearchScope 值设置为子树是我只列出 1 个 OU 作为基本 OU 并让它搜索所有子 OU？
3.  发送到 PropertiesToLoad.Add() 的字符串是通用的，还是需要是我公司定义的字符串？

感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T06:00:00.090

> (1) DirectorySearcher 中的 SearchRoot 属性有什么作用？我是否需要进行设置才能让此查询返回一个值？

它定义了搜索的起点；将其与文件系统进行比较 - 它定义了您开始搜索的**起始目录。**您将在内部查看，`SearchRoot`并且可能会查看其所有子容器。它只是用来减少可能的容器数量来搜索东西

> (2) 我是否需要将 SearchScope 值设置为子树是我只列出 1 个 OU 作为基本 OU 并让它搜索所有子 OU？

如果您想搜索您的 OU 或其他容器`SearchRoot`- 那么是的，您必须搜索`SearchScope.Subtree`- 否则搜索将只查看您的`SearchRoot`容器本身（在该容器内的所有对象，如用户、计算机、组 - 但不是在子- 容器）。

> (3) 发送到 PropertiesToLoad.Add() 的字符串是通用的，还是需要是我公司定义的字符串？

这些是 LDAP 属性名称——既可以是[标准](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675090%28v=vs.85%29.aspx)名称，也可以是贵公司可能已经定义和安装的自定义扩展。[这是一个非常好的 Excel 表格形式的所有 AD 属性列表](http://www.rlmueller.net/UserAttributes.htm)（实际上是几个）。

# ios - 如何判断 MagicalRecord 操作是否成功？

> ID：15890417
> 
> 赞同：1
> 
> 时间：2013-04-08T22:51:19.560
> 
> 标签：ios, magicalrecord

我大量使用 MagicalRecord 来获取、删除、更新和保存数据。我在测试中注意到我没有得到预期的结果，因为我尝试的操作出现问题，例如错误的谓词导致没有记录被更新或删除等。

我查看了可用的文档（例如它们）并且找不到任何提供检查任何返回码等的方法。

任何人都知道列出*所有*可用 MR 方法*并附有解释*的地方（MR 类别和核心除外）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:19:51.980

我不确定您在文档中要查找的内容。该项目文档稀疏的主要原因是核心数据文档涵盖了绝大多数功能。神奇的记录只是一组方便的方法，使核心数据中的标准操作更易于管理。

“非标准”核心数据功能的部分可能需要对事情如何工作进行一些额外的解释，但它们的来源也可供阅读和理解。如果您有具体问题，请提出。

# c# - 以任意顺序匹配所有单词

> ID：15890419
> 
> 赞同：1
> 
> 时间：2013-04-08T22:51:33.497
> 
> 标签：c#, linq

如何使用 linq 匹配每个单词的搜索字符串？即“apple orange”应该匹配“orange apple”而不是“apple orange fred”。

此处的此查询可用于查找是否有任何单个单词匹配，但我无法使其适用于 All() 单词匹配。

```
var match = "apple orange pear".Split()
        .Intersect("orange pear fred".Split())
        .Any(); 
```

这个想法与这个线程非常相似。[给定字符串的逐字超级字符串搜索](https://stackoverflow.com/questions/15715429/word-wise-super-string-search-for-given-string)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:58:02.267

检查检查列表中是否存在每个单词：

```
var words = "orange pear fred".Split();
var wordsToCheck = "apple orange".Split();
var match = words.All(w => wordsToCheck.Contains(w)); 
```

或者产生两个序列的差异。如果没有不同的元素，则所有单词都在检查列表中：

```
var match = !words.Except(wordsToCheck).Any(); 
```

# com - 使用 Arduino 编程器模式在虚拟 COM 端口上上传代码

> ID：15890420
> 
> 赞同：1
> 
> 时间：2013-04-08T22:51:51.367
> 
> 标签：com, arduino, virtual, bootloader

这个问题与[Upload Arduino code on virtual serial port through Arduino IDE 有关](https://stackoverflow.com/questions/15785087/upload-arduino-code-on-virtual-serial-port-through-arduino-ide)。主要问题是能够将代码上传到虚拟 COM 端口而不是使用 Arduino，因此我可以获取二进制代码输出并在其他应用程序中使用它。问题在于上传过程也与 Arduino 上的引导加载程序有关，这就是上传过程永远不会达到 100% 的原因。建议的解决方案是在我的应用程序中实现引导加载程序，或者使用已经存在的东西。

我现在的问题是我是否可以利用 Arduino IDE 中的不同编程模式来绕过引导加载程序，以便上传过程可以达到 100% 并且代码实际上会到达虚拟 COM 端口？

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T03:18:13.290

听起来您的虚拟串行端口驱动程序卡在某些超时或缓冲区上。IDE 使用特定协议调用 avrdude，以匹配 Arduino 引导加载程序中内置的内容，加载在 AVR 上。还有其他的bootloader（其实很多，不胜枚举），其中一些可能有不同的时序等，但使用它们基本上不再是Arduino。查看可能性。\avrdude.exe -c。

如果您只是想转储串行端口上的内容。我用过[Virtual Serial Ports Emulator](http://www.eterlogic.com/Products.VSPE.html)。它非常通用，因为它的模块化，让您可以构建您想要的东西。

此外，正如其他线程中提到的那样，请注意串行端口上的数据是在[STK500 协议](http://www.atmel.com/Images/doc2591.pdf)之上格式化的。您还在其他线程中提到您不想使用其他工具来获取数据。而为了使用另一个协议，您需要更改源 compiler.java 并重建项目以使用新协议调用 avrdude。因此，您不妨使用其他工具来获取它。见下文，这将重新绑定。

您可以从输入到 avrdude 的内容中获取原始二进制文件。因为它最初可能并不明显。由于 avrdude 得到 ELF 而不是 BIN。Arduino IDE 包含所有 avr-gcc 及其工具。位于 .\Arduino\hardware\tools\avr\bin 中的 avr-objcopy 可以将汇集到 avrdude 的 IDE 输出转换为您可能需要的二进制文件。无需确定串行端口流的范围。

要手动执行此操作，您需要通过启用 IDE 的详细编译打印来找到 IDE 的临时工作目录。并且还可能将 avr-objcopy 放在您的路径中。然后像下面的例子一样简单地调用它，用你的草图的文件名代替我的。

```
C:\Users\mflaga\AppData\Local\Temp\build6135656488044319492.tmp>avr-objcopy -I ihex FilePlayer.cpp.hex -O binary FilePlayer.cpp.bin 
```

你可以用一个批处理文件替换 avrdude.exe，它调用 avrdude 和 avr-objcopy 来自动化

# sql - SQL AVG 函数：

> ID：15890422
> 
> 赞同：-2
> 
> 时间：2013-04-08T22:52:17.187
> 
> 标签：sql, sqlplus

如果我们在该列上计算 AVG，AVG 会对具有 NULL 值的列做什么？它是通过将 NULL 视为零来计算平均值，还是通过排除空值来计算平均值？我可以通过创建一个演示表来做到这一点，但我很着急，需要一些快速的答案。整个任务都围绕着这一点展开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T22:55:17.303

请参见此处：“忽略空值” [http://msdn.microsoft.com/en-us/library/ms177677.aspx](http://msdn.microsoft.com/en-us/library/ms177677.aspx)

如果你想确保你没有平均`NULL`并且不想研究，你可以随时添加`WHERE myColumn IS NOT NULL`

# linq-to-sql - “无法为标识列插入显式值......”即使我不是

> ID：15890426
> 
> 赞同：0
> 
> 时间：2013-04-08T22:52:39.150
> 
> 标签：linq-to-sql

我有这个功能：

```
private static void SaveResource(StrategicPlanningDbDataContext ctx, ResourceModel resource, int impliedID)
    {
        var existing = ctx.Resources.FirstOrDefault(r => r.ID == resource.ID) ??
                       new Resource();

        existing.ImpliedID = impliedID;
        existing.HasAccepted = resource.HasAccepted;
        existing.IsPrimary = existing.IsPrimary;
        existing.UserID = resource.UserID;

        if (existing.ID == default(int))
        {
            ctx.Resources.InsertOnSubmit(existing);
            ctx.SubmitChanges();
            resource.ID = existing.ID;
        }
    } 
```

当我`Cannot insert explicit value for identity column in table 'Resource' when IDENTITY_INSERT is set to OFF.`点击 ctx.SubmitChanges() 获取新的`Resource`. `Resource.ID`是一个身份（显然）。当我们进入函数时它是0（因为我刚刚创建了它，而`int`s显然必须有一个默认值。

我已经尝试从我的 dbml 中删除该表并重新添加了几次，但我一直收到此错误。我已经检查了设计器，并且设计器具有`[global::System.Data.Linq.Mapping.ColumnAttribute(Storage="_ID", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]`上面的 ID 属性。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:59:29.423

好吧，我关闭并重新启动了 Visual Studio，一切都变得更好了。（顺便说一句，如果我从 .dbml 中完全删除表，它也可以很好地编译，呃，这没有任何意义）。

# c++ - 通过引用传递向量

> ID：15890427
> 
> 赞同：24
> 
> 时间：2013-04-08T22:52:42.657
> 
> 标签：c++

使用普通的 C 数组我会做这样的事情：

```
void do_something(int el, int **arr)
{
   *arr[0] = el;
   // do something else
} 
```

现在，我想用向量替换标准数组，并在这里获得相同的结果：

```
void do_something(int el, std::vector<int> **arr)
{
   *arr.push_front(el); // this is what the function above does
} 
```

但它显示“表达式必须具有类类型”。如何正确执行此操作？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-08T23:24:55.013

您可以通过引用传递容器，以便在函数中对其进行修改。其他答案没有解决的是`std::vector`没有`push_front`成员函数。您可以使用`insert()`成员函数 on`vector`进行 O(n) 插入：

```
void do_something(int el, std::vector<int> &arr){
    arr.insert(arr.begin(), el);
} 
```

或者使用`std::deque`分期 O(1) 插入代替：

```
void do_something(int el, std::deque<int> &arr){
    arr.push_front(el);
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-08T22:55:10.943

如果您将函数定义为采用参数 `std::vector<int>& arr`和整数值，则可以 `push_back`在该函数内部使用：

```
void do_something(int el, std::vector<int>& arr)
{
    arr.push_back(el);
    //....
} 
```

用法：

```
std::vector<int> arr;
do_something(1, arr); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-08T22:53:38.313

```
void do_something(int el, std::vector<int> **arr) 
```

应该

```
void do_something(int el, std::vector<int>& arr)
{
    arr.push_back(el);
} 
```

通过引用传递已被简化为`&`在 C++ 中使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-08T23:15:54.383

您可以像这样**通过引用传递向量：**

```
void do_something(int el, std::vector<int> &arr){
    arr.push_back(el);
} 
```

但是，请注意，此函数将始终在向量**的后面添加一个新元素**，而您的*数组函数*实际上**修改了第一个元素（或初始化它的值）**。

为了达到完全相同的结果，您应该编写：

```
void do_something(int el, std::vector<int> &arr){
    if (arr.size() == 0) { // can't modify value of non-existent element
        arr.push_back(el);
    } else {
        arr[0] = el;
    }
} 
```

通过这种方式，您可以添加第一个元素（如果向量为空）或修改其值（如果第一个元素已经存在）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-08T22:55:28.567

您不需要使用 **arr，您可以使用：

```
void do_something(int el, std::vector<int> *arr){
    arr->push_back(el);
} 
```

或者：

```
 void do_something(int el, std::vector<int> &arr){
    arr.push_back(el);
} 
```

**arr 没有意义，但如果您坚持使用它，请这样做：

```
void do_something(int el, std::vector<int> **arr){
    (*arr)->push_back(el);
} 
```

但同样没有理由这样做......

# javascript - 使两个脚本一起工作以形成下拉菜单

> ID：15890430
> 
> 赞同：1
> 
> 时间：2013-04-08T22:52:52.920
> 
> 标签：javascript, css

我有这个 HTML 代码

```
<html>
<head>
<script type="text/javascript">
    window.onload = function(){
    document.getElementById("shipping-method").onchange = function(){
        window.scrollTo(0, 0);
    };
};
</script>
<script>
function calc() {
var subtotal = parseFloat(document.getElementById("subtotal").innerHTML.substring(1));
var shipping = parseInt(document.getElementById("shipping-method").value);
if(shipping == 1) {
    var total = subtotal+6.95;
    document.getElementById("shipping").innerHTML = "$"+6.95;
} else {
    var total = subtotal+17.95;
    document.getElementById("shipping").innerHTML = "$"+17.95;
}
document.getElementById("total").innerHTML = "$"+total;
}
</script>
</head>
<body>
<select  onchange="calc()" class="shipping-method" id="shipping-method">
<option value="">-Choose a shipping method-</option>
<option selected="selected" value="1">normal shipping - $6.95</option>
<option value="2">Priority Shipping - $17.95</option>

</select>
<div class="calculations">
<table>

<tbody><tr>
    <td>Subtotal:</td>
    <td id="subtotal">$97.00</td>
</tr>

<tr>
    <td>Shipping:</td>
    <td id="shipping">$6.95</td>
</tr>

<tr class="total">
    <td>Total:</td>
    <td id="total">$103.95</td>
</tr>
</tbody></table>
</div>
</body>
</html> 
```

下拉菜单位于网页的底部，所以我使用第一个脚本在选择一个选项并获得总数后让用户到达页面顶部，但是两个脚本不能一起工作，我有删除其中一个以使另一个工作，如何使两个脚本一起工作而没有任何冲突，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:00:21.257

试着坚持这个：

```
function calc() {
var subtotal = parseFloat(document.getElementById("subtotal").innerHTML.substring(1));
var shipping = parseInt(document.getElementById("shipping-method").value);
if(shipping == 1) {
    var total = subtotal+6.95;
    document.getElementById("shipping").innerHTML = "$"+6.95;
} else {
    var total = subtotal+17.95;
    document.getElementById("shipping").innerHTML = "$"+17.95;
}
document.getElementById("total").innerHTML = "$"+total;
} 
```

就在顶部的函数之前：

```
window.onload = function(){
document.getElementById("shipping-method").onchange = function(){
    window.scrollTo(0, 0);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:01:11.630

您正在覆盖 onchange 函数。如果你想做两件事，那就把它们都放在onchange函数中，不要分配两次。

这是一些示例代码（为简洁起见）。

```
<html>
<head><title>Example</title></head>
<body>
<select id="shipping-method"></select>
<table></table>
<script type="text/javascript">
    function calc() {
        // do calculations here
    }
    document.getElementById("shipping-method").onchange = function(){
        window.scrollTo(0, 0); // scroll to top
        calc(); // call function
    };
</script>
</body>
</html> 
```

请注意，我将 javascript 放在底部以避免访问不存在的元素。

# javascript - Javascript 日期对象的 getUTC 和 setUTC

> ID：15890431
> 
> 赞同：0
> 
> 时间：2013-04-08T22:53:03.097
> 
> 标签：javascript, jquery, utc

我在理解 javascript 对象的 getUTC 和 setUTC 方法时遇到了一些麻烦。

我正在使用 jQuery 插件 TinyTimer 为下一个发货截止时间开发一个前端倒计时时钟。我无法在我正在使用的平台上使用任何后端脚本。计时器运行良好，但我不知道如何调整时区

```
var d = new Date();
/* Get Month & Time & Day of the week*/
var monthOfTheYear = d.getMonth();
var dayOfTheMonth = d.getDate();
var dayOfTheWeek = d.getDay();
/*New Years Day */
if( monthOfTheYear == 0 && dayOfTheMonth == 1){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for New Year's Day</p>");
}
/*Memorial Day */
if( monthOfTheYear == 4 && dayOfTheMonth >= 25 &&  dayOfTheWeek == 1){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for Memorial Day</p>");
}
/*Independence Day */ 
if( monthOfTheYear == 6 && dayOfTheMonth == 4 ){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for Independence Day</p>");
}
/*Labor Day */
if( monthOfTheYear == 8 && dayOfTheMonth <= 7 && dayOfTheWeek == 1){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for Labor Day</p>");
}
/*Thanksgiving */
if( monthOfTheYear == 10 && dayOfTheMonth <= 28 && dayOfTheMonth >= 22 && dayOfTheWeek == 4){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for Thanksgiving.</p>");
}
 /*Day after Thanksgiving */
if( monthOfTheYear == 10 && dayOfTheMonth <= 29 && dayOfTheMonth >= 23 && dayOfTheWeek == 5){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Courier closed today for day after Thanksgiving.</p>");
}
/*Christmas */
if( monthOfTheYear == 11 && dayOfTheMonth == 25){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for Christmas's Day!</p>");
}   
/*New Year's Eve */
if( monthOfTheYear == 11 && dayOfTheMonth == 31){
d.setDate(d.getDate() + 1);
$('#timer').prepend("<p>Closed today for New Year's Eve!</p>");
}   
/* Check that it is not a saturday or sunday*/
if( dayOfTheWeek == 0){
d.setDate(d.getDate() + 1);
}else if( dayOfTheWeek === 6 ){
    d.setDate(d.getDate() + 2);
}
/* Set the time to 4:30pm */
d.setHours(16);
d.setMinutes(30);
d.setSeconds(0);
/* Initialize TinyTimer */
$('#timer').tinyTimer({ to: d }); 
```

# eclipse-plugin - 如何在 Eclipse 中使用 TestNG 运行导出的 selenium 测试用例

> ID：15890435
> 
> 赞同：0
> 
> 时间：2013-04-08T22:53:27.233
> 
> 标签：eclipse-plugin, testng, selenium-ide

我使用 Selenium IDE 1.10.0 记录了一个测试用例。我将案例导出为 Java/TestNG/Remote Control。

我的 Eclipse 版本是 4.2.0，我安装了 TestNG 插件版本 6.8

我想知道如何在 Eclipse 中创建一个项目来运行这个导出的测试用例？

请给我一些指示或与我分享一些在线教程/文档。谢谢！

下面是Eclipse生成的java代码：

```
package com.example.tests;

import com.thoughtworks.selenium.*;
import org.testng.annotations.*;
import static org.testng.Assert.*;
import java.util.regex.Pattern;

public class SearchDonor extends SeleneseTestNgHelper {
    @Test public void testSearchDonor() throws Exception {
        // set overall speed of the test case
        selenium.setSpeed("4000");
        selenium.open("/?html=openid");
        selenium.click("css=input[type=\"submit\"]");
        selenium.waitForPageToLoad("30000");
        Thread.sleep(4000);
        selenium.click("id=cmp_admin");
        selenium.waitForPageToLoad("30000");
        selenium.click("id=quicksearch_anchor");
        selenium.click("css=img[alt=\"Member\"]");
        selenium.waitForPageToLoad("30000");
        selenium.type("id=search_name", "suzy");
        selenium.click("css=input[type=\"image\"]");
        selenium.click("link=Balagia, Suzy");
        selenium.waitForPageToLoad("30000");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T22:51:06.183

经过一些试验和错误。我设法在 Eclipse 中执行导出的代码作为 TestNG 测试。这是我为使其编译而采取的步骤。

1.在Eclipse中创建一个Java项目

2.在Java项目中添加一个类

```
2a. I copied and pasted the code into the newly created the class 
```

3.右键项目>构建路径>配置构建路径

3a。在 Java Build Path 窗口中选择 library>Add External JARS，然后添加 Selenium Java Driver 文件夹中的所有 JAR 文件（例如，本例中的文件夹名称为 libs），加上 selenium-java-2.31.0.jar 和 selenium-java- 2.31-src.jar

4.单击顶部菜单栏上调试图标旁边的运行图标，运行 AS TestNG 测试

我的代码正在编译，但出现了一些异常错误。我正在盯着一个 TestNG 测试用例！

# javascript - Java 脚本打印出一个空白页

> ID：15890448
> 
> 赞同：3
> 
> 时间：2013-04-08T22:54:29.867
> 
> 标签：javascript

我有以下java脚本代码

```
 $("#btn_Print").click(function (e) {
            e.preventDefault();
            var printWindow = window.open("../private/analysisPrint.htm");
            printWindow.print();
            printWindow.close();
            return false;
        }); 
```

和 analysisPrint.htm 页面包含。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html

     xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
    </head>
    <body>
        <div>
            <h4>
                Print</h4>
                First print page
        </div>
    </body>
    </html> 
```

我遇到的问题是我总是打印空白页。当我直接打开页面并打印它时。

有任何想法吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T23:09:27.240

您可以（并且可能应该）等待页面完全加载（包括图像）：

```
var printWindow = window.open("../private/analysisPrint.htm");
$(printWindow).on('load', function() {
    printWindow.print();
    printWindow.close();
}); 
```

# c# - 调用 GetResponse() 后 HttpWebRequest 中止

> ID：15890452
> 
> 赞同：1
> 
> 时间：2013-04-08T22:54:38.817
> 
> 标签：c#

我有一种情况让我发疯，网上没有任何真正有用的信息。

我正在自动执行上传文件的手动过程。我实际上像 3 年前一样编写了这段代码，它运行了一年顺利，现在它间歇性地失败了。在查看我的请求和刚刚从浏览器发出的请求的 Fiddler 流量时，我看到的唯一区别是，在我的自动呼叫期间，在 Fiddler 中，我得到了这个红色圆圈，其中有一条线穿过它两次。

我的研究表明这个图标意味着客户中止了会话——我没有这样做。我为每个请求传递相同的 CookieContainer 对象。我不知道为什么会这样，但是如果我在 Fiddler 中查看记录行的属性，它会为我的自动请求说明：

```
SESSION STATE: Aborted.
...
X-ABORTED-WHEN: SendingResponse
...
== TIMING INFO ============
ClientConnected:    16:25:58.563
ClientBeginRequest: 16:25:58.566
GotRequestHeaders:  16:25:58.567
ClientDoneRequest:  16:25:58.567
Determine Gateway:  0ms
DNS Lookup:         0ms
TCP/IP Connect: 0ms
HTTPS Handshake:    0ms
ServerConnected:    16:25:58.207
FiddlerBeginRequest:    16:25:58.567
ServerGotRequest:   16:25:58.567
ServerBeginResponse:    16:25:58.922
GotResponseHeaders: 16:25:58.922
ServerDoneResponse: 16:25:59.268
ClientBeginResponse:    16:25:59.268
ClientDoneResponse: 16:25:59.268 
```

我使用浏览器获得的日志中的同一行如下所示：

```
SESSION STATE: Done.
...
ClientConnected:    10:33:09.347
ClientBeginRequest: 10:33:11.982
GotRequestHeaders:  10:33:11.982
ClientDoneRequest:  10:33:11.982
Determine Gateway:  0ms
DNS Lookup:         0ms
TCP/IP Connect: 0ms
HTTPS Handshake:    0ms
ServerConnected:    10:33:08.050
FiddlerBeginRequest:    10:33:11.982
ServerGotRequest:   10:33:11.982
ServerBeginResponse:    10:33:12.337
GotResponseHeaders: 10:33:12.337
ServerDoneResponse: 10:33:12.511
ClientBeginResponse:    10:33:12.511
ClientDoneResponse: 10:33:12.514 
```

所以“完成”与“中止”。我从来没有在请求中调用过 Abort，我也没有收到任何异常。这是我发生中止的代码：

```
using (WebResponse httpResponse = httpRequest.GetResponse())
{
    if (!httpResponse.ResponseUri.AbsoluteUri.Equals(string.Format("{0}main.htm", url), StringComparison.CurrentCultureIgnoreCase))
    {
        throw new Exception("Log in failed. Check the Username and Password information in the Setting table.");
    }

    httpResponse.Close();
} 
```

我试过去掉“使用”（即使是推荐的）和“关闭”（也推荐），但它仍然被中止。

我很感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T20:55:33.637

我遇到了这个问题，我意识到如果没有读取（或访问）响应流，Fiddler 中的请求会报告它被中止。对于我的用例，我不一定需要读取响应流，但我添加了一些代码来读取响应流（我没有缓冲或保存），然后 Fiddler 将请求报告为已完成。您上面的代码不会读取响应流，所以我会尝试。

```
 using (WebResponse httpResponse = httpRequest.GetResponse())
        {
            if (!httpResponse.ResponseUri.AbsoluteUri.Equals(string.Format("{0}main.htm", url), StringComparison.CurrentCultureIgnoreCase))
            {
                throw new Exception("Log in failed. Check the Username and Password information in the Setting table.");
            }

            var responseStream = httpResponse.GetResponseStream();
            if (null != responseStream)
            {
                var buffer = new byte[8192];
                while (responseStream.Read(buffer, 0, buffer.Length) > 0)
                {
                    // Do nothing here.
                }   
            }

            httpResponse.Close();
        } 
```

# jquery - 与 sinon.js 一起使用时，jstree 未正确初始化

> ID：15890454
> 
> 赞同：0
> 
> 时间：2013-04-08T22:54:43.023
> 
> 标签：jquery, jstree, qunit, sinon

我正在使用[sinon.js](http://sinonjs.org/) / [qunit](http://api.qunitjs.com/)编写函数测试。我编写测试的页面工作正常，但是在测试中使用 sinon 伪造服务器响应时，我无法让 jstree 对象加载其初始数据。

为了确保我正在测试的页面和我正在编写的测试使用相同的响应数据，我创建了一个名为`change_dialog_fixture`我加载的 JavaScript 对象夹具，以代替从服务器返回的数据。您可以在下面的调用中看到这一点[`getJSON`](http://api.jquery.com/jQuery.getJSON/)：

```
 $.getJSON(axes_url, function(data) {
        //ANALYSIS_PAPER.change_data = data;
        ANALYSIS_PAPER.change_data = change_dialog_fixture;
        hide_throbber(); // sinon confirms this is called
        create_change_dialog();
        console.log(ANALYSIS_PAPER.change_data); // prints
    }); 
```

通过单步执行代码，我可以看到对于两个页面（工作页面和测试页面），被操作到 jstree 对象（由函数）中的 DOM 元素*在*`create_change_dialog`返回之前不会加载其数据。 *`getJSON`*

 *返回后`getJSON`，工作页面“聚焦”创建的树并加载给定的 JSON 数据`ANALYSIS_PAPER.change_data`以创建 jstree 结构。在 qunit 测试页面上，这不会发生。DOM 元素仍然是一个 jstree 对象，但该元素是完全空的。

正如包含代码中的注释所示，`hide_throbber`被调用（我正在使用[sinon spies](http://sinonjs.org/docs/#spies-api)测试它）并`console.log`打印该语句。不会引发异常，也不会指示错误。失败是完全沉默的。

我认为这可能与时间有关，所以我做了我的 qunit 测试 a[`asyncTest`](http://api.qunitjs.com/asyncTest/)并添加`start();`到传递给的回调函数中，`getJSON`但这并没有改变任何东西。我也采取了不同的方法并编辑了[`fakeServer`](http://sinonjs.org/docs/#server)with `server.autoRespond = true`，但这也没有解决问题。

任何关于进一步测试运行的建议或关于可能导致此问题的想法的任何建议都非常受欢迎。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:32:23.340

问题是，由于 jstree 是动画的，所以树实际上是异步加载的。因为动画`window.setTimeout`的核心是使用，而 sinon 可以使用它的来伪造这个函数[`fake timers`](http://sinonjs.org/docs/#clock)，添加一些`click.tick`语句解决了这个问题。例如：

```
$loadTreeButton.trigger("click");
this.clock.tick(1000);
equal(partOfTheTree.length, 1, "Component 1 loaded"); 
```

[jstree 的核心文档页面](http://www.jstree.com/documentation/core)上列出的`loaded.jstree`函数通过暗示 jstree 正在异步加载，让我朝着正确的方向前进。*

# seo - 从 Google 索引中删除垃圾邮件子域

> ID：15890456
> 
> 赞同：0
> 
> 时间：2013-04-08T22:54:52.800
> 
> 标签：seo, google-search, google-search-console

如果我使用“site:mydomain.com”进行谷歌搜索（mydomain 显然不是我的！）我会得到很多包含虚假子域的第一页和第二页结果。

首先，WTF？为什么有人会设置链接来为我的网站创建带有虚假子域的 Google 索引？这里的骗局是什么？在过去的 3 个月里，我的谷歌排名显着下降，我不知道为什么。

这些子域的一个示例：w。w3ww。www.lawsuitsettlementamounts.com2960。www.lawsuitsettlementamounts.com4519。www.lawsuitsettlementamounts.com3754。beft.ru5258。wa-go2ui.com10992。wa-go2ui.com10993。

我已经为域更新了 apache2 的 siteavailable 文件以禁止通配符子域。所以现在除了域或 www 之外的任何东西。被允许。（根据我通过网站管理员告诉谷歌的内容）。这些虚假链接现在返回 403

这够了吗？我应该做更多吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T13:23:25.560

在做了更多研究之后，我认为最好的响应是 404“找不到页面”。所以我更新了我的站点启用/000-default 的 apache 配置以包含以下内容：

编辑 - 我已将其从 404 更改为 400。我认为 404 对搜索引擎来说不是一个足够强的信息，即子域是虚假的。“语法不正确”（400）可能比“找不到页面”（404）更准确

```
<VirtualHost *:80>
ServerName bogus
Redirect 400 /
</VirtualHost> 
```

# android - 在 Android ViewPager 中清除 OffscreenPage

> ID：15890459
> 
> 赞同：0
> 
> 时间：2013-04-08T22:55:04.073
> 
> 标签：android, android-tabs, viewpage

我有一个 ViewPager 和多个标签。这些选项卡之一控制设置，这会影响所有其他选项卡。当我更改设置时，一切都会自动更新，除了保存在内存中的页面。为了让这些更新，我必须选择一个离它足够远的标签，然后再回来。

有没有办法强制这些标签重新创建自己？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:02:06.617

根据关于 SO 的[这个问题](https://stackoverflow.com/questions/7369978/how-to-force-viewpager-to-re-instantiate-its-items)，您可以重置将重新加载所有页面的适配器：

```
viewPage.setAdapter( adapter ); 
```

[该问题所链接的副本](https://stackoverflow.com/questions/7263291/viewpager-pageradapter-not-updating-the-view)也提供了一些有用的信息，例如调用`.notifyDataSetChanged()`您的`ViewPager`适配器。

# c# - 删除使用 makecert 创建的自签名证书

> ID：15890463
> 
> 赞同：1
> 
> 时间：2013-04-08T22:55:15.910
> 
> 标签：c#, iis-7, x509certificate

我使用以下命令创建了一个自签名证书：

```
makecert -r -pe -n "CN=aaa" -sky exchange -ss my -sr localmachine aaa.cer 
```

该证书在我的 IIS 管理器中显示为服务器证书，这正是我想要的。

现在我想以编程方式删除它（`C#`），我可以通过什么命令行来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:02:25.303

You can delete it just like you delete any other file in C#:

```
 string path = @"C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\aaa.cer";
        FileInfo myfileinf = new FileInfo(path);
        myfileinf.Delete(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T16:08:40.093

我想出了解决方案是什么，

```
certmgr -del -c -n "aaa" -s -r localMachine My 
```

# android - 如何在android中自动添加图像并将其命名为xml文件？

> ID：15890468
> 
> 赞同：0
> 
> 时间：2013-04-08T22:55:34.007
> 
> 标签：android, xml, events, handler

我想知道如果您要从 sd 卡上传图像，假设您正在空白 xml 文件中创建一个空间来存储衬衫等属性，您将如何为此编写事件处理程序？

# javascript - 在给定 id 的元素中选择一个类的所有元素

> ID：15890474
> 
> 赞同：0
> 
> 时间：2013-04-08T22:56:09.680
> 
> 标签：javascript, jquery, elements

我的 HTML 代码看起来像

```
<div id="partA">
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeB"> blabla </div>
</div>

<div id="partB">
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeA"> blabla </div>
    <div class="myClass typeB"> blabla </div>
</div> 
```

我想使用 javascript 来计算类的元素数量`myClass`，但只计算其中的一个`#partA`。
当我使用时，
`$(".myClass").size()`
我得到`8`了结果（它计算了`partA`和中的所有元素`partB`）。
当我使用时，我
`$(".myClass.typeA").size()`
得到`6`（它从两个部分获取所有元素） 但是当我使用时， 我得到. 显然，该 javascript 命令仅查找同时具有和的元素。是否可以重新制定该命令以计算包含在元素中的类的数量？`myClass``typeA`

`$("#partA.myClass").size()`
`0`
`id=partA``class=myClass``myClass``id=partA`

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T22:57:08.610

您的一个选择器中缺少一个空格。尝试：

```
$("#partA .myClass").size() 
```

或者你可以这样做：

```
$('#partA').find('.myClass').length; 
```

或者

```
var partA = $('#partA');
$('.myClass', partA).length; 
```

# magento - Magento - 产品扩展的数据库错误

> ID：15890475
> 
> 赞同：0
> 
> 时间：2013-04-08T22:56:10.200
> 
> 标签：magento

我已经安装了这个扩展： http: [//www.magentocommerce.com/magento-connect/catalog/product/view/id/16917/](http://www.magentocommerce.com/magento-connect/catalog/product/view/id/16917/)

```
SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`mysite_testsite2`.`cataloginventory_stock_item`, CONSTRAINT `FK_CATINV_STOCK_ITEM_PRD_ID_CAT_PRD_ENTT_ENTT_ID` FOREIGN KEY (`product_id`) REFERENCES `catalog_product_entity` (`entity_id`) O) 
```

任何想法我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T02:06:59.397

尝试在文件夹 app/code/[local or community]/[companyname]/[modulename]/sql/[modulename]_setup/mysql4-install-xxxphp 下查找文件

你所做的只是修复创建表 sql ......

祝你好运：D

# winapi - 从现代应用程序激活桌面应用程序的 Windows 8 协议

> ID：15890480
> 
> 赞同：2
> 
> 时间：2013-04-08T22:56:58.813
> 
> 标签：winapi, windows-8, microsoft-metro

我有两个版本的自定义软件。Modern/Metro 应用程序 (AppM) 和我的旧版桌面应用程序 (AppD)。我使用易于理解的清单为 AppM 创建了一个自定义协议。我已经编辑了注册表，为 AppD 创建了一个自定义协议处理程序，并测试了我确实可以通过提供协议并在“运行”对话框 (WIN+R) 中使用协议激活来启动 AppD，然后按回车键“AppD://”这个案例。我希望能够从 AppD 启动 AppM 和从 AppM 启动 AppD。我为每个添加了处理程序。在 AppD 中我使用 Process.Start(uri)，在 AppM 中我使用 Launcher.LaunchUriAsync(uri)。我可以让 AppM 从 AppD 启动，但我从来没有让 AppD 从 AppM 启动。我用谷歌搜索，找不到任何对此的参考。我假设它 这是不可能的，并且可能与权限有很大关系。由于该项目的任务已落在我身上，我需要证明这是不可能的或找到解决方案。

我已经使用 C#/XAml 以及 HTML/JS 对此进行了测试，有趣的是发现调用了 Launcher.LaunchUriAsync(uri).when() 成功函数，但成功标志为 false。没有错误（或者至少永远不会命中 err 函数）。我想获得更好的错误消息，我目前正在尝试以这种方式进行挖掘。

因此，对于实际问题的帮助或有关如何调试的帮助将不胜感激。

更新：为了消除我自己的代码，我下载并安装了[关联启动示例](http://code.msdn.microsoft.com/windowsapps/Association-Launching-535d2cec)，只需将*var uriToLaunch=“ [http://bing.com](http://bing.com) ”*更改为*var uriToLaunch=“AppD:”*，每次都失败。该协议在注册表中关联，我用来验证这一点的方法是使用桌面上的 WIN+R 运行它，并且应用程序可以正常启动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T20:30:38.057

[BatRT](http://isys-labs.com/batrt/)是一个应用程序，它允许您使用 URI 调用从 Metro 应用程序运行批处理文件。这应该可以解决您的问题。只需在 Metro 应用程序中创建一个批处理文件，然后利用 BatRT 执行批处理文件。代码片段可在上面的链接中找到。

# centos - Selinux - 文件上下文看起来不错，但 Selinux 不允许写入

> ID：15890481
> 
> 赞同：3
> 
> 时间：2013-04-08T22:57:05.870
> 
> 标签：centos, rhel, selinux, security-context

我正在尝试学习 Selinux。使用沙箱并使用 VSFTPD 进行试验，我有一个在 Centos 中运行的 vsfptd 服务器。我有匿名用户将文件放在 /var/ftp/incoming 中。在远程机器上，我可以让用户成功登录，但无法将文件放在删除 vsftpd 服务器上：

```
$ftp mysql_server
Connected to mysql_server (192.168.1.31).
220 Welcome to blah FTP service.
Name (mysql_server:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer ftp> put atd 
local: atd remote: atd
227 Entering Passive Mode (192,168,1,31,19,161).
553 Could not create file.
ftp> 
```

在 VSFTPD 服务器上，aureport -a 报告显示：

```
[root@mysql_server ftp]# aureport -a

AVC Report
========================================================
# date time comm subj syscall class permission obj event
========================================================
4\. 04/08/2013 13:30:36 vsftpd unconfined_u:system_r:ftpd_t:s0-s0:c0.c1023 21 dir write system_u:object_r:public_content_t:s0 denied 28
5\. 04/08/2013 13:34:57 vsftpd unconfined_u:system_r:ftpd_t:s0-s0:c0.c1023 2 dir write system_u:object_r:public_content_t:s0 denied 47 
```

我检查了目录，文件上下文看起来不错，所以我不明白为什么 Selinux 不允许 vsftpd 写入传入目录：

```
[root@mysql_server ftp]# ls -Z
drwx-wx---. root ftp  system_u:object_r:public_content_t:s0 incoming
drwxr-xr-x. root root system_u:object_r:public_content_t:s0 pub
[root@mysql_server ftp]# 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-10T04:38:58.160

您需要运行以下命令以允许在 SELinux 中上传和编辑文件：

```
setsebool -P allow_ftpd_full_access on
setsebool -P ftp_home_dir on 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-16T11:58:47.480

您的 SELinux 类型不正确。使用“public_content_rw_t”而不是“public_content_t”。阅读更多[http://beginlinux.com/blog/2008/11/vsftpd-and-selinux-on-centos/](http://beginlinux.com/blog/2008/11/vsftpd-and-selinux-on-centos/)

# ios - 如何使用 translationInView: 和 UIPanGestureRecognizer 来获得不可见的滑块效果？

> ID：15890488
> 
> 赞同：3
> 
> 时间：2013-04-08T22:57:44.903
> 
> 标签：ios, objective-c, uigesturerecognizer, uipangesturerecognizer

作为一种快捷方式（绝对没有必要），我的视图上有一个 UIPanGestureRecognizer ，允许用户上下滑动手指以快速设置一个值，但我无法完全实现这一点。

我想让它向上或向下平移一定距离按比例增加或减少值。

我尝试使用`translationInView:`，但它似乎只更新了几次，除非我非常缓慢地平移，除非我使用错误。

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
    CGPoint velocity = [recognizer velocityInView:recognizer.view];

    NSNumber *WPM = [[NSUserDefaults standardUserDefaults] objectForKey:@"WPM"];

    // If user is panning upward
    if (velocity.y < 0) {
        CGPoint translation = [recognizer translationInView:recognizer.view];

        if (fmodf(translation.y, 10) == 0) {
            WPM = @([WPM intValue] + 5);
            [[NSUserDefaults standardUserDefaults] setObject:WPM forKey:@"WPM"];
            NSLog(@"%@", WPM);
        }
    }
    // If user is panning downward
    else if (velocity.y > 0) {
        CGPoint translation = [recognizer translationInView:recognizer.view];
        if (fmodf(translation.y, 10) == 0) {
            WPM = @([WPM intValue] - 5);
            [[NSUserDefaults standardUserDefaults] setObject:WPM forKey:@"WPM"];
            NSLog(@"%@", WPM);
        }
    }
} 
```

如果我缓慢拖动，变量的值会相对快速地攀升，但如果我将手指快速向上滑动屏幕，它几乎不会调整值。我想要与此完全相反的；慢速运动可以进行精细控制，而快速运动可以更快地改变。

我将如何执行此操作？它工作得不是很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T01:56:40.213

您的算法的问题在于，它仅在恰好是十的倍数时才记录更改。随着平移速度的加快，每个注册的 translation.y 可能会更改 >1，因此并非所有精确的倍数都注册，导致增量更少，而不是更多。

您想在*超过*十时注册更改，然后重置为零。

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
    NSNumber *WPM = [[NSUserDefaults standardUserDefaults] objectForKey:@"WPM"];
    CGPoint translation = [recognizer translationInView:recognizer.view];
    if (translation.y<-10 || translation.y>10) {
        int sign = (translation.y>0)?-1:1;
            [recognizer setTranslation:CGPointMake(0, 0) inView:self.view];
            WPM = @([WPM intValue] + sign*5);
            [[NSUserDefaults standardUserDefaults] setObject:WPM forKey:@"WPM"];
            NSLog(@"%@", WPM);
        }
} 
```

# ios - XIB 弹出框显示

> ID：15890490
> 
> 赞同：0
> 
> 时间：2013-04-08T22:57:54.710
> 
> 标签：ios, objective-c, xcode, uipopovercontroller, popover

加载应用程序时，我似乎无法制作弹出式 xib 显示。这是我在 ViewDidLoad 中的内容。对不起，我是新手，正在研究教程并遇到应用程序崩溃的问题。错误日志是“由于未捕获的异常'NSException'而终止应用程序，原因：'无法在包中加载NIB：”“（已加载）'名称为'search''

```
 ViewController* viewController2 = [[ViewController alloc] initWithNibName:@"search" bundle:nil];
self.popOverController = [[UIPopoverController alloc] initWithContentViewController:viewController2];

_popOverController.popoverContentSize = CGSizeMake(350,100); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:11:33.113

你需要以某种方式呈现它。您显示的代码只是创建弹出框。您需要使用 presentPopoverFromRect:inView:permittedArrowDirections:animated: 或 presentPopoverFromBarButtonItem:permittedArrowDirections:animated: 来实际显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:18:56.470

看看[这个](https://stackoverflow.com/questions/7765213/ios5-could-not-load-nib-in-bundle)。

它说您的笔尖“搜索”在构建的应用程序中不存在。您的 xib 未命名为“search.xib”，或者您的 xib 未包含在您的项目中。您可以通过查看手机或模拟器上的 .app 目录来检查这一点。

# java - 无重复洗牌 Gridview 项目尝试了许多方法

> ID：15890493
> 
> 赞同：0
> 
> 时间：2013-04-08T22:58:00.660
> 
> 标签：java, android, arrays, shuffle

我可能会失去生存的意愿。我一直在尝试编写一种方法来在使用 ImageAdapter 的 Gridview 上随机播放图像。我对Android没有经验。我已经访问了该站点上与无重复的洗牌数组有关的所有问题。我已经在普通的 Java 环境中测试了它们。有些工作没有重复。我尝试将数组更改为 Arraylist 并使用 Collections.shuffle。我仍然得到重复或模拟器已经崩溃。我真的很感激对此的一些见解-这可能很简单，但我无法理解。这是我的一些方法（使用我找到的代码）。

```
 public Integer[] myShuffleS(Integer []ji){

    ArrayList<Integer> numbers = new ArrayList<Integer>();   
    Random randomGenerator = new Random();
    while (numbers.size() < 36) {

        int random = randomGenerator.nextInt(35);
        if (!numbers.contains(random)) {
            numbers.add(random);

        }

    }  
    for (int i=0; i<ji.length;i++) {

        ji[i] =ji[numbers.get(i)] ;
    //  i++;
   }
    return ji;
} 
```

其他

```
 static int[] shuffleArray(int[] ar)
{
  Random rnd = new Random();
 int randomNo = rnd.nextInt()*3;
//  int randomNo = (int)Math.floor(Math.random() * 3);
  for (int i = ar.length - 1; i >= 0; i--)
  {
  //  int index = rnd.nextInt(i + 1);
      int index = randomNo - 1;
    // Simple swap
    int a = ar[index];
    ar[index] = ar[i];
    ar[i] = a;
  }

  return ar;
}

 public static void shuffleAArray(int[] a) {
   int n = a.length;
   int random = randomInt(0,35);
//  random.nextInt();
    for (int i = 0; i < n; i++) {
        int change = i + random;
       swap(a, i, change);
   }
} 
```

其他

```
 public Integer[] myShuffle( Integer[]jigX){
      boolean found = false;

for (int i = 0; i < jigX.length; i++) {
      do {

        found = false;
      int  temp = randomInt(0,35);
      jigX[i] = temp;
        for (int j = 0; j < i && !found; j++) { 
         if (jigX[j] == temp) 
             found = true;
        } 
      } 
      while (found);

      }

    return jigX;
    } 
```

还尝试了 Collections.shuffle 并放入下一块以获取图像

```
 myShuffleS(jigX);//or whatever method
 imageView.setImageResource(jigX [position]); 
```

如果有人可以帮助解决这个问题，那就太好了！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:23:49.413

好的，经过一番来回之后，看起来你的问题不在于洗牌本身。我猜你洗牌不止一次，这就是你得到重复条目的原因。制作一个可以随机播放其项目的自定义 ListAdapter。

```
public class MyImageAdapter extends BaseAdapter {
    private Context mCtx;
    private List<Integer> mImages;

    public MyImageAdapter(final Context ctx, final List<Integer> images) {
        mCtx = ctx;
        mImages = images;
    }

    public void shuffle() {
        Collections.shuffle(mImages, new Random(System.currentTimeMillis()));
    }

    @Override
    public int getCount() {
        return mImages.size();
    }

    @Override
    public Object getItem(final int position) {
        return mImages.get(position);
    }

    @Override
    public long getItemId(final int position) {
        return 0;
    }

    @Override
    public View getView(final int position, final View convertView, final ViewGroup parent) {
        ImageView iv = (ImageView) convertView;
        if (iv == null) {
            iv = new ImageView(mCtx);
        }

        iv.setImageResource(mImages.get(position));

        return iv;
    }
} 
```

在您的活动中按如下方式使用它：

```
@Override
protected void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_layout);

    List<Integer> images = new ArrayList<Integer>();
    images.add(R.drawable.image1);
    images.add(R.drawable.image2);
    images.add(R.drawable.image3);
    ...
    GridView gv = (GridView) findViewById(R.id.grid_view);
    mAdapter = new MyImageAdapter(this, images);
    gv.setAdapter(mAdapter);
    ...    
    mAdapter.shuffle();
    mAdapter.notifyDataSetChanged();
} 
```

那是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:32:04.230

如果 Collections.shufle 以某种方式失败了：

1.  把你的整数放在集合中，

2.  使用 random.nextInt(set.size()-1) 将它们一一获取。

3.  将取出的内容添加到新的 Arraylist。

4.  继续直到集合为空。

保证没有双打。

# ruby - 在花栗鼠中设置简单的矩形碰撞时遇到问题

> ID：15890494
> 
> 赞同：0
> 
> 时间：2013-04-08T22:58:02.063
> 
> 标签：ruby, collision-detection, chipmunk, libgosu

最近我一直在尝试创造一些我一直想要的东西，但从来没有技术和时间去做——电脑游戏。更准确地说，是我最喜欢的游戏之一的致敬/克隆。首先，我决定创建一个基于恶魔城系列的经典 2D 平台。

作为一名 Ruby 程序员，我决定使用[Gosu](http://www.libgosu.org/%20Gosu)。然后我决定我不想重新发明轮子，所以我要使用[Chipmunk](http://chipmunk-physics.net/)。

几天后，我最终遇到了莫名其妙的碰撞检测问题。我添加了边界框绘图功能，只是为了看看到底发生了什么。

![在此处输入图像描述](https://i.stack.imgur.com/VPEYV.png)

正如你所看到的，贝尔蒙特撞到了他无法触及的墙块。由于 gosu gem 附带的演示游戏运行良好，我一定是做错了什么，我可能真的不明白如何`Shape`定义多边形并将其添加到空间中。我很确定这不是我画它的地方。

该游戏有一个公共 repo，因此您可以看到墙壁 ( `Brush < Entity`) 和玩家 ( `Player < Entity`) 是如何定义的，并且它们确实具有简单的矩形多边形形状。墙不会添加到空间中（它们是*流氓*），只有玩家是。我试过调试游戏，看看`body`位置在哪里，但一切看起来都很好。

[https://github.com/ellmo/castellvania](https://github.com/ellmo/castellvania)

玩家慢慢跌倒，但你可以用上/左/右箭头控制他。波浪号按钮 ( `~`) 显示边界框，并且碰撞框应该始终可见。

我需要一些帮助来了解我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T19:43:51.353

> 我可能真的不了解如何定义多边形形状并将其添加到空间中。我很确定这不是我画它的地方。

而已。形状坐标被添加到身体位置，而不是从中减去。在你的`Entity.boundaries`替换行

```
verts << CP::Vec2.new(@shape.body.p.x - @shape[vert].x, @shape.body.p.y - @shape[vert].y) 
```

和

```
verts << CP::Vec2.new(@shape.body.p.x + @shape[vert].x, @shape.body.p.y + @shape[vert].y) 
```

你会得到正确的图片。（绘图仍会损坏，但边界框将是正确的。

# html - 内联图像和堆叠

> ID：15890496
> 
> 赞同：0
> 
> 时间：2013-04-08T22:58:03.360
> 
> 标签：html, css, image, block

我不确定这个持有人页面的代码有什么问题。有些东西破坏了格式，我确信它与内联块和清除框有关。

谁能引导我朝着正确的方向前进？我以前没有完全根据图像制作页面。

这条线表示渲染时它的高度为 127 像素 - 但是图像只有 121 像素。

```
<a class="imageleft" href="#"><img src="images/4.jpg" width="76" height="121"></a> 
```

谁能看到我在这里错过了什么？

网站： http: [//michaelbirchall.com/etc/dvd-page/](http://michaelbirchall.com/etc/dvd-page/)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:38:40.257

问题是有一个继承的`font-size`. 它也会影响你的底行图像，但它并不明显，因为它下面没有任何其他图像。由于您的页面都是图像，因此将其设置为 0 应该没问题。

[http://jsfiddle.net/2ZVVX/6/](http://jsfiddle.net/2ZVVX/6/)

**CSS**

```
* {
  margin: 0;
  padding: 0;
  font-size: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:12:36.180

`.imageleft`是一个`inline-block`元素，这意味着行高会影响它。只需设置`line-height: 0`即可：

[http://jsfiddle.net/2ZVVX/5/](http://jsfiddle.net/2ZVVX/5/)

# python - 为什么同一个对象在一个实例中抛出“NoneType”对象属性错误而不在其他实例中抛出？

> ID：15890497
> 
> 赞同：0
> 
> 时间：2013-04-08T22:58:15.990
> 
> 标签：python, mysql, django, attributeerror, nonetype

我正在使用 django 在我的电子商务网站上设置购物车功能。`cart_item`在 MySQL 表中，所有项目都以 s 形式输入。

在问题之前，相关代码：

```
charm = False
if postdata.get('charm_sku'):
    charm_sku = postdata.get('charm_sku','')
    ch = get_object_or_404(Charm, sku=charm_sku)

#get products in cart
cart_products = get_cart_items(request)
product_in_cart = False
# check to see if item is already in cart
for cart_item in cart_products:
    if cart_item.product.id == p.id:
         if charm == True:
              if cart_item.charm.id == ch.id:
                 # update the quantity if found
                 cart_item.augment_quantity(quantity)
                 product_in_cart = True
         else:
             if cart_item.charm.id == "":
                # update the quantity if found
                cart_item.augment_quantity(quantity)
                product_in_cart = True 
```

编辑：我修改了上面显示的代码，导致 BOTH`if cart_item.charm.id`抛出 attirbuteerror: `'NoneType' object has no attribute 'id'`。在某种程度上，我认为这改善了这种情况，因为我怀疑第一个看起来“成功”的实际上是第一个`if charm == True`失败的，因此从未测试过第一个`if cart_item.charm.id == ch.id`。问题仍然存在：当 For 循环清楚地声明 cart_item 并且 cart_items 显然有一个魅力列和 id 分配给所述列时，为什么这会引发 AttributeError？

编辑 2：我不能从嵌套的 if 中引用 cart_item 吗？这是我唯一能想到的，但同时我觉得我应该能够，所以也许这是错误的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:07:01.187

`NoneType`意味着您实际上拥有的不是类的实例，而是`None`. 这可能意味着赋值失败或函数调用返回了意外结果。在. `cart_item`_ `charm == False`检查设置这两个变量的任何代码（赋值或函数调用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:08:40.817

不知何故，你的`charm == False`情况也暗示着`cart_item.charm is None`。`None`由于您在访问属性之前不进行检查，`id`因此会引发异常。

我对这些变量和对象类型知之甚少，无法理解原因，但正是这种`if`条件掩盖了你的问题。

# wcf - 客户端计算机上的 Silverlight 未发送 WCF 请求

> ID：15890502
> 
> 赞同：7
> 
> 时间：2013-04-08T22:58:45.597
> 
> 标签：wcf, silverlight, silverlight-4.0

我的 SL 应用程序是商业应用程序，可以在数百台机器上正常运行。

SL 正在使用 WCF 服务，它按预期工作，但今天我观察到客户端机器上的行为，实际上没有调用服务器。

单击发送调用的按钮后，出现一些错误，并且在 Fiddler 中没有创建有关 WCF 调用的记录。

错误是：

```
[HttpWebRequest_WebException_RemoteServer]
Arguments: NotFound
Debugging resource strings are unavailable... 
```

我读到了人们推荐使用 Fiddler 的这个错误，但正如我所说，Fiddler 中没有显示调用

所以问题比我最初想象的还要糟糕。

它来来去去。目前，我们已经找到了一个可行的解决方案，可以在问题出现后解决问题，尽管它对我来说没有任何意义。

> 例如，如果我在 chrome & mozilla & OOB 版本中收到此错误，则在 IE 中启动程序可以工作，然后 chrome、mozilla 和 OOB 也开始工作。

问题是用这种变通方法解决了这个问题的人在几天内再次体验它，比如一周，没有明显的原因，然后从不同位置组合启动会有所帮助（通常 IE 帮助最大）。

任何帮助表示赞赏，我开始赏金作为它非常恶心的错误，我需要以某种方式修复它。

**更新**

奇怪的 IE 修复场景：

在某些时候，OOB 版本进入不向服务器发送任何 WCF 请求的状态。（提琴手没有看到它，服务器没有得到它）​​。在 IE 中启动网页版并点击发送 WCF 请求的相同按钮后，我们会在 IE 网页版中获得所需的结果。

无需更改任何其他内容，只需重新启动之前处于此错误状态的 OOB 版本，即可使 OOB 版本正常工作。它没有重新安装，没有改变 - 什么都没有。

这就是我所说的“IE 治愈”这个问题。所以问题是 IE 可以为 OOB 版本推出哪些潜在变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T12:14:10.200

根据[这个线程](http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/56e670f4-9fa2-4a2e-b75a-18524e7cb210/)`Debugging resources are unavailable`，当客户端不使用 Silverlight Developer Runtime 时会出现该消息。

这意味着实际的异常对您（和我们）是隐藏的，因此下一步是在具有 Silverlight Developer Runtime 的系统上重现错误。

我找到[了这篇文章](http://www.lditsolutions.com/blog/posts/2013/04/accessing-wcf-services-using-a-self-signed-certificate-from-oob-%28out-of-browser%29-silverlight-or-in-browser-without-getting-any-security-warnings-and-without-storing-a-security-exception)。检查您正在使用的证书可能是值得的（您是否在使用证书）这是与 OOB 应用程序和浏览器不同的事情之一。

# python - ValueError：数学域错误

> ID：15890503
> 
> 赞同：120
> 
> 时间：2013-04-08T22:58:46.383
> 
> 标签：python, runtime-error, logarithm

我只是*在用 Python 测试工程中的数值方法中*的一个例子。

```
from numpy import zeros, array
from math import sin, log
from newtonRaphson2 import *

def f(x):
    f = zeros(len(x))
    f[0] = sin(x[0]) + x[1]**2 + log(x[2]) - 7.0
    f[1] = 3.0*x[0] + 2.0**x[1] - x[2]**3 + 1.0
    f[2] = x[0] + x[1] + x[2] -5.0
    return f

x = array([1.0, 1.0, 1.0])
print newtonRaphson2(f,x) 
```

当我运行它时，它显示以下错误：

```
File "example NR2method.py", line 8, in f
    f[0] = sin(x[0]) + x[1]**2 + log(x[2]) - 7.0
ValueError: math domain error 
```

我已将其范围缩小到日志，因为当我删除日志并添加不同的功能时，它可以工作。我认为这是因为对基地的某种干扰，我不知道是怎么回事。任何人都可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2013-04-08T23:06:46.630

您的代码正在执行一个`log`小于或等于零的数字。这在数学上是未定义的，因此 Python 的`log`函数会引发异常。这是一个例子：

```
>>> from math import log
>>> log(-1)
Traceback (most recent call last):
  File "<pyshell#59>", line 1, in <module>
    log(-1)
ValueError: math domain error 
```

在不知道你的`newtonRaphson2`函数做了什么的情况下，我不确定我能猜出无效`x[2]`值的来源，但希望这会引导你走上正确的道路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-10T08:55:56.923

您也可以使用`math.log1p`.

根据[官方文档](https://docs.python.org/3.8/library/math.html)：

> 数学.log1p(x)
> 
> 返回 1+x（以 e 为底）的自然对数。结果的计算方式对于接近零的 x 是准确的。

`math.expm1`您可以使用返回`e`的 x 次幂减去 1将其转换回原始值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-06-23T16:37:20.093

由于以下任一原因，您会遇到数学域错误：您尝试在 log 函数中使用负数或零值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-01T21:54:38.300

您正在尝试对不是正数的事物进行对数。

对数在给出一个数字和它的幂后计算出底数。`log(0)`表示某物的幂次`2`是`0`。指数永远不会导致`0`*，这意味着`log(0)`没有答案，因此抛出`math domain error`

*注：`0^0`可以导致`0`，但也可以同时导致`1`。这个问题引起了激烈的争论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-17T17:48:49.733

# asp.net-mvc - MVC 更新删除数据

> ID：15890504
> 
> 赞同：0
> 
> 时间：2013-04-08T22:59:07.517
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework

我在表中添加了两个字段（A，B）。我在进行新注册时填充了这些字段。但是，当我对不包含这些字段的表单进行更新时，它似乎会删除字段（A，B）中的值。当我没有传递值来更新它时，有没有办法在控制器或模型中设置验证以防止它们被更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:04:53.710

Entity framework updates all fields that have changed. EF sees a null value as a change if your field has data.

You should instead be retrieving the record, updating only the fields you want to change, then re-saving.

# client-server - 为什么我不能信任客户端生成的 GUID？将 PK 视为客户端 GUID 和服务器 GUID 的组合是否可以解决任何问题？

> ID：15890505
> 
> 赞同：9
> 
> 时间：2013-04-08T22:59:10.737
> 
> 标签：client-server, primary-key, client-side, guid, composite-key

我正在建立[之前与 Jon Skeet 的讨论](https://stackoverflow.com/questions/14613584/can-a-client-ever-reliably-generate-a-pk-for-an-object-being-written-to-a-db)。

我的方案的要点如下：

*   客户端应用程序能够创建新的“PlaylistItem”对象，这些对象需要保存在数据库中。
*   用例要求以这样一种方式创建 PlaylistItem，即客户端在显示 PlaylistItem 之前不必等待来自服务器的响应。
*   客户端为 PlaylistItem 生成一个 UUID，在客户端显示 PlaylistItem，然后向服务器发出保存命令。

在这一点上，我明白在我的数据库中使用客户端生成的 UUID 作为对象的 PK 是不好的做法。原因是恶意用户可以修改生成的 UUID 并在我的数据库上强制 PK 冲突。

为了减轻因在 PlaylistItem 上强制发生 PK 冲突而造成的任何损害，我选择将 PK 定义为两个 ID 的组合 - 客户端生成的 UUID 和服务器生成的 GUID。服务器生成的 GUID 是 PlaylistItem 的播放列表的 ID。

现在，我已经使用这个解决方案一段时间了，但我不明白为什么/相信我的解决方案比简单地信任客户端 ID 更好。如果用户能够强制与另一个用户的 PlaylistItem 对象发生 PK 冲突，那么我认为我应该假设他们也可以提供该用户的 PlaylistId。他们仍然可以强制碰撞。

是的。做这样的事情的正确方法是什么？允许客户端创建一个 UUID，成功保存后服务器会竖起大拇指。如果发现冲突，恢复客户端更改并通知检测到冲突？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-28T02:57:57.050

您*可以*信任客户端生成的 UUID 或服务器上类似的全局唯一标识符。明智地去做。

您的大多数表/集合还将保存一个用户 ID，或者能够通过 FK 将自己与用户 ID 关联。

如果您正在执行插入并且恶意用户使用现有密钥，则插入将失败，因为记录/文档已经存在。

如果您正在进行更新，那么您应该验证登录用户是否拥有该记录或被授权（例如管理员用户）来更新它。如果强制执行纯所有权（即没有管理员用户场景），那么您`where`查找记录/文档的条款将包括 Id 和 userId。现在从技术上讲，userId 在 where 子句中是多余的，因为 Id 将唯一地找到一个记录/文档。但是，添加 userId 可以确保记录属于进行更新的用户而不是恶意用户。

我假设服务器正在解密某种加密令牌或会话以确定 userId，并且这不是由客户端提供的，否则显然不安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-27T11:43:22.160

一个不错的解决方案如下：引用 Sam Newman 的[“构建微服务”](https://rads.stackoverflow.com/amzn/click/com/1491950358)：

> 调用系统会发布一个 BatchRequest，可能会传入一个可以放置所有数据的文件的位置。客户服务将返回 HTTP 202 响应代码，指示请求已被接受，但尚未处理。然后调用系统可以轮询资源，等待它检索到 201 Created 指示请求已完成

因此，在您的情况下，您可以 POST 到服务器，但会立即收到类似“我将保存 PlaylistItem 并且我保证它的 Id 将是这个”的响应。然后，客户端（和用户）可以继续，而服务器（甚至可能不是 API，而是一些从 API 获取消息的后台处理器）需要时间来处理、验证和执行其他可能很繁重的逻辑，直到它保存实体。如前所述，API 可以为该请求的状态提供一个 GET 端点，客户端可以轮询它并在出现错误时采取相应的行动。

# java - 减去多头出错

> ID：15890512
> 
> 赞同：7
> 
> 时间：2013-04-08T23:00:09.223
> 
> 标签：java, long-integer

```
long freeSize = ((Main.maxSPace-Main.usedSpace)*1000*1000);

maxSpace = 20000
usedSpace = 8 
```

-->`freeSize = -1482836480`

为什么这个结果是否定的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T23:38:57.997

将类型`maxSpace`和`usedSpace`从更改`int`为`long`。如果你不能这样做，那么只需将你的代码更改为类似

```
long freeSize = 1000L*1000*(Main.maxSPace - Main.usedSpace); 
```

所以结果将被计算为`long`，而不是`int`。

现在是这样计算的

```
Main.maxSPace-Main.usedSpace              -> 19992
(Main.maxSPace-Main.usedSpace)*1000       -> 19992000
(Main.maxSPace-Main.usedSpace)*1000*1000L -> 19992000000 
```

这里的问题是我们对整数进行操作，所以结果也必须是整数，但整数的最大值是

```
2147483647 so
19992000000 is out of range 
```

所以 Java 将只取最后 32 位结果并将其更改为整数

```
10010100111100111011011011000000000 -> 19992000000
   10100111100111011011011000000000 -> -1482836480 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T23:08:50.927

`maxSpace`和`usedSpace`被声明为整数，所以所有的算术都是用整数执行的。仅当您将结果分配给时，`freeSize`它才会转换为 long，但在此之前发生了溢出。

尝试将数字替换为`1000`以`1000L`使强制更早发生：

```
long freeSize = ((Main.maxSPace-Main.usedSpace)*1000L*1000L); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T23:09:54.203

你可能得到一个负数，因为`maxSpace`和`usedSpace`是整数。`20000 - 8 = 19992`，`19992 * 1000000 = 19992000000`小于`Long.MAX_VALUE`(2 ^(63) - 1) 但大于`Integer.MAX_VALUE`(2 ^(31) - 1)。`19992000000 - Integer.MAX_VALUE = 17844516353`这仍然超出了 int 值的范围。你应该`maxSpace`放任自流`usedSpace`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-08T23:08:53.710

当 maxSpace 和 usedSpace 是 int 类型时，由于类型溢出，您将得到一个负值。对变量 maxSpace 和 usedSpace 都使用 long。或者，如果您无法更改 Main 的属性类型，您可以将代码更改为：

```
long freeSize = ((Main.maxSPace-Main.usedSpace)*1000L*1000L); 
```

# jquery - 如何使用 AngularJS 将 jQuery 事件绑定到动态内容

> ID：15890517
> 
> 赞同：0
> 
> 时间：2013-04-08T23:00:34.337
> 
> 标签：jquery, angularjs

基本上在我的控制器中，我正在`$http.get()`加载一些 html 来设置“当前视图”。我的问题是我不知道如何用这个新的动态内容重新绑定 jQuery 事件。

现在，我已经采取了这样的措施：

```
$http.get('/someurl', {}).success(function(data){
  $scope.detailedView = data;
  // Now here comes the rebinding
  setTimeout(function(){
    // Use jquery to bind the new content
  }, 1500);
}); 
```

我一直在寻找解决方案，我发现的任何相关内容都指向使用指令。我已经研究过了，但我不知道指令将如何用于这样的事情。

**请注意**，如果没有超时，绑定会在动态内容实际位于 DOM 之前运行。我也尝试过在 $apply 运行后找到类似于挂钩的东西，但没有找到类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:31:33.243

首先应该看看你用 jQuery 做的事情是否不能用 angular 来完成。

这是可以使用的最简单的指令版本：

```
<div ng-repeat="item in items" my-directive>Item {{$index+1}}</div> 
```

```
app.directive('myDirective', function ($timeout) {
    return function (scope, element, attrs) {
        $timeout(function () {
            /* element is a jQuery object when jQuery loaded in page before angular,*/
            /* otherwise is a jQlite object that has many of same methods as jQuery*/
            element.css({ 'border': '1px solid green', 'margin': '10px 30px','padding':'5px'});
        }, 0);
    }
 }); 
```

这是一个使用长超时为使用该指令的重复项生成数据的演示：

[http://jsfiddle.net/AXYGL/](http://jsfiddle.net/AXYGL/)

# javascript - MustacheJS：JS 不能用于 mustache 的产品？

> ID：15890518
> 
> 赞同：0
> 
> 时间：2013-04-08T23:00:43.603
> 
> 标签：javascript, jquery, templating, mustache

我将 MustacheJS 模板（按钮元素）注入 HTML。如果单击，然后使用 JS 切换按钮的 CSS。此 JS 适用于所有按钮，但不适用于 mustachejs 创建的按钮：

```
function clickToggleCSS() {
    $(this).toggleClass('status0').toggleClass('status1');
}
$('button').on("click", clickToggleCSS); 
```

请参阅[this fiddle](http://jsfiddle.net/hugolpz/RXe2t/8/)，其中上部按钮是真正的 HTML，底部按钮是使用 MustacheJS 注入的。

**如何使它工作？**（小提琴欣赏！）

* * *

**解决方案（[小提琴](http://jsfiddle.net/hugolpz/RXe2t/9/)）：**

```
$('body').on('click', 'button', clickToggleCSS); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:01:43.220

尝试：

```
$('body').on('click', 'button', clickToggleCSS); 
```

当您将处理程序直接添加到元素（如在您的代码中）时，它仅适用于在该代码运行时找到的元素。在该点之后添加的元素不受影响。通过使用委托处理程序（在这种情况下，在`<body>`元素上），任何未来按钮上的任何“单击”事件也将被处理。

# css - 如何在特定纸张上打印

> ID：15890519
> 
> 赞同：5
> 
> 时间：2013-04-08T23:00:48.190
> 
> 标签：css, printing

我在有**24 个**标签的**A4**纸上打印一些文本时遇到问题。

 **基本上，每一行都有 3 个标签，其中包含一个人的姓名、姓氏和地址，该标签将用于邮件（它是贴在邮件上的粘性标签）。

![70*36mm电池](https://i.stack.imgur.com/YODjQ.jpg)

这就是论文。其特点：

1.  有**10 行**。
2.  第一**行**和**最后**一行是*最小*的并且有.***`height:0.5mm;`***
****   在**第一**行和**最后**一行**没有**单元格。*   其余所有行都有`height:36mm;`.*   所有单元格都有`width:70mm;`和`height:36mm;`。*   在每个单元格中都有一个文本，即`text-align:center;`和`vertical-align:middle;`。***

 ***我将[normalize.css](http://necolas.github.io/normalize.css/)用于*css reset*。

**CSS**

```
html,body,table{
  width: 100%;
  height: 100%;
}

.first, .last{
  width: 100%;
  height: 5mm;
}

.row{
  width: 100%;
  height: 36mm;
}

.cell{
  width: 70mm;
  height: 36mm;
  text-align: center;
  vertical-align: middle;
} 
```

我正在使用**Chrome**并关闭了打印**边距**。

但是，最后两行仍然打印在**下一页上**。我需要同一页面上的所有 10 行，并且如果有多个页面，它们的位置是固定的（不会移动）。

如何解决/实现？还是有更简单的解决方案？

这是[代码](http://jsfiddle.net/cBX6g/)示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:12:17.780

我已经使用`FPDF`类为我的标签创建了一个 pdf。

```
require_once ABSPATH . '/path/to/fpdf.php';

class PDF_MC_Table extends FPDF{
    var $widths;
    var $aligns;

    function SetWidths($w){
        //Set the array of column widths
        $this->widths=$w;
    }   
    function SetAligns($a){
        //Set the array of column alignments
        $this->aligns=$a;
    }   
    function Row($data){
        //Calculate the height of the row
        $nb=0;
        for($i=0;$i<count($data);$i++)
            $nb=max($nb,$this->NbLines($this->widths[$i],$data[$i]));
        $h = 36;// again trial and error until you fnd the desired height of your label
        //Issue a page break first if needed
        $this->CheckPageBreak($h);
        //Draw the cells of the row
        for($i=0;$i<count($data);$i++){
            $w=$this->widths[$i];
            $a=isset($this->aligns[$i]) ? $this->aligns[$i] : 'L';
            //Save the current position
            $x=$this->GetX();
            $y=$this->GetY();
            //Draw the border. reset the parameters of the function below as you desire.
            $this->Rect($x,$y,$w,$h);
            //Print the text. reset the parameters of the function below as you desire. changing the values will resize the boxs.
            $this->MultiCell($w,3,$data[$i],0,$a);
            //Put the position to the right of the cell. reset the parameters of the function below as you desire. changing the $x and $y will shift the cells.
            $this->SetXY($x+$w,$y);
        }
        //Go to the next line
        $this->Ln($h+3);
    }

    function CheckPageBreak($h){
        //If the height h would cause an overflow, add a new page immediately
        if($this->GetY()+$h>$this->PageBreakTrigger)
            $this->AddPage($this->CurOrientation);
    }

    function NbLines($w,$txt){  
        //Computes the number of lines a MultiCell of width w will take
        $cw=&$this->CurrentFont['cw'];
        if($w==0)
            $w=$this->w-$this->rMargin-$this->x;
        $wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
        $s=str_replace("\r",'',$txt);
        $nb=strlen($s);
        if($nb>0 and $s[$nb-1]=="\n")
            $nb--;
        $sep=-1;
        $i=0;
        $j=0;
        $l=0;
        $nl=1;
        while($i<$nb){
            $c=$s[$i];
            if($c=="\n"){
                $i++;
                $sep=-1;
                $j=$i;
                $l=0;
                $nl++;
                continue;
            }
            if($c==' ')
                $sep=$i;
            $l+=$cw[$c];
            if($l>$wmax){
                if($sep==-1){
                    if($i==$j)
                        $i++;
                }
                else
                    $i=$sep+1;
                $sep=-1;
                $j=$i;
                $l=0;
                $nl++;
            }
            else
                $i++;
        }
        return $nl;
    }
}

$pdf=new PDF_MC_Table();
$pdf->SetMargins(4, 2);
$pdf->AddPage();
$pdf->SetFont('Arial','',8);
// displays the empty row in the top
$pdf->SetRightMargin(2);
$pdf->SetLeftMargin(4);
$pdf->Cell(0,10,'',1);
$pdf->Ln(10);

$pdf->SetWidths(array(50,50,50));// these are the widths of your cells. this is a trial and error process. increase the values until you find the suitable ones.

$count = 0;

$lables = array(); // your labels array

$l = array();
$j = 0;

// i used this foreach for breaking my plain array into a 2dimentional array- an array of arrays consisting 3 labels in each.

foreach($lables as $i=>$lbl  ){
    $l[$j][] = $lbl;

    if($i%3==2){$j++;} // $i=0,1,2 > $j=0; $i=3,4,5 > $j=2 etc this will break the main labels array as 2D array.
}
// displays the empty row in the bottom.
$pdf->Ln(1);
    $pdf->Cell(0,10,'',1);

$pdf->Output(); 
```

有关类和方法的更多信息，请参阅[http://www.fpdf.org/](http://www.fpdf.org/)充其量您需要了解三种方法 - Multicell()、Cell() 和 Rect() 方法。网站中的示例对这些方法进行了很好的解释。

在这里，我发布了我的解决方案，并根据您的问题更改了一些代码。大多数事情都是不言自明的。如果您需要进一步的帮助，请随时发表评论。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T07:43:08.800

如果您不使用特定的尺寸，请减小单元格和行高的尺寸，即使在关闭边距后会发生什么，打印数据超出纸张长度并且打印机会自动将其移动到另一页。

那是我认为您可以尝试的最佳解决方案。

ps：这些类型的不干胶标签通常附带他们的设计软件光盘，您通常使用它来设置边距和预览。如果你没有它，你唯一能做的就是按照我上面所说的调整高度，在普通 A4 普通纸上打印，然后用粘性标签纸进行远程打印。我曾经也这样做过……虽然对我有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T08:10:33.060

如果您的打印机支持此功能，请尝试无边距打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T21:40:55.173

尝试添加下面的样式并使用 @page 属性。@page 中的更多信息可以在这里找到：[https ://developer.mozilla.org/en-US/docs/CSS/@page](https://developer.mozilla.org/en-US/docs/CSS/@page)

我很幸运使用下面定义的样式在 8.5x11 文档上完美打印，我可以设置自己的边距并在浏览器中获得一致的结果。

```
<style type="text/css" media="print">
  @page {
    size: auto;   /* auto is the initial value */
    margin: 0mm;  /* this affects the margin in the printer settings */
  }
  body {
    background-color: #fff;
    border: solid 1px #000 ;
    margin: 0px;  /* this affects the margin on the content before sending to printer */
    padding: 0.25in 0.5in;
  }
</style> 
```*****

# sharepoint - Team separation in TFS but share projects?

> ID：15890525
> 
> 赞同：0
> 
> 时间：2013-04-08T23:01:00.667
> 
> 标签：sharepoint, version-control, tfs, agile

I'm new to TFS and we're loving it! I'm having a difficult time figuring out how best to organize TFS from version control and agile/scrum/sharepoint sites, keeping isolation of teams yet sharing of code and projects.

For this scenario let's say I have three teams. Team 1, 2, 3\. I want each team to have access to only projects they work on, and each team to have isolation for alerts and notifications, sharepoint, agile, etc. So let's say there are 5 total projects.

```
Team 1:
--Project 1
--Project 2

Team 2:
--Project 1
--Project 4
--Project 5

Team: 3:
--Project 1
--Project 2
--Project 3
--Project 4 
```

We have one collection setup, DefaultCollection. Right now I only have one team but this doesn't give us good isolation and separation of the features. How can I best configure TFS to keep separation of teams but not have separate code projects? Some projects are shared and this is the point of contention - I don't know how to handle this part.

Acme Widget has X projects and then we have a "Company Shared" with X projects. We may be working on different products such as Acme Widget 1, 2, 3 but all share and work on the Company Shared projects, i.e. Company.Utilities, Company.Windows, Company.Security.

Can someone please shed some light on how to properly configure TFS while we're early into the stages of use. We want to go beyond just version control as mentioned above. We want to use the Task, Bug, Alerts, Build, etc.

P.S. If anyone is a TFS sub-contractor that helps organizations configure their TFS setup I would entertain a professional consultation and configuration.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T06:12:49.097

由于 TFS 和 SharePoint 实际上并不持有用户帐户（它们位于 Active Directory 中）。为每个团队创建一个 Active Directory 组并将您的用户放在该组中可能是最简单的。然后，您仍然可以保留一个项目集合（无需过度架构），然后每次在该集合中创建一个新项目时，您都可以使用 Active Directory 组为该项目（TFS、Sql Reports 和 SharePoint）分配权限。您应该下载免费的 TFS 管理工具来管理权限，当用户加入/离开团队时，您可以直接在 Active Directory 中进行管理，而无需更改 TFS、Sql Reporting 或 SharePoint。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-17T11:23:35.797

我建议你看看这个：

[http://blogs.ripple-rock.com/colinbird/2012/11/19/MultipleTeamsWithMicrosoftTeamFoundationServer2012VisualStudioScrumV2xUpdated1452013.aspx](http://blogs.ripple-rock.com/colinbird/2012/11/19/MultipleTeamsWithMicrosoftTeamFoundationServer2012VisualStudioScrumV2xUpdated1452013.aspx)

这向您展示了如何拥有多个团队，每个团队的董事会，任务等。

我们在我们公司使用它，因为它是同一个项目，但有两个不同的团队。然后它完美地工作，因为我们有团队的层次结构：

-- 项目（0级）

---- A队（1级）

---- B组（1级）

通过这种方式，我们可以将故事或任务分配给其中一个，如果它们被分配到项目级别（级别 0），那么它将出现在所有团队中。

# php - 使用 IF 语句根据帖子大小显示最近的帖子

> ID：15890528
> 
> 赞同：0
> 
> 时间：2013-04-08T23:01:13.893
> 
> 标签：php, wordpress, if-statement, sidebar

我在 wordpress 中有一个侧边栏，显示我最近的帖子。执行此操作的 php 代码很简单：

```
$recent_posts = wp_get_recent_posts(array("numberposts"=>5)); 
```

我想包括一个 IF 声明说：

“如果 wordpress 帖子超过 100 字，则显示 10 个最近的帖子，否则显示 5 个”

一旦我知道这是如何实现的，我会计算出相关的数字等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T03:10:30.727

您可以使用全局`$post`来检查的长度，`post_content`然后`$numberposts`相应地设置。

```
global $post;
$numberposts = 1; // default number of posts
if ( !empty($post) ){
    $len = strlen( $post->post_content );
    // change $numberposts based on length of $post->post_content
    if ( $len < 300 ){
      $numberposts = 8;
    } elseif ( $len < 500 ){
      $numberposts = 5;
    } elseif ( $len < 800 ){
      $numberposts = 3;
    } else {
      $numberposts = 1;
    }
}
$recent_posts = wp_get_recent_posts(array("numberposts"=>$numberposts)); 
```

# python - Lists of tuples paired with dictionary keys, is this a good method of data classification?

> ID：15890534
> 
> 赞同：0
> 
> 时间：2013-04-08T23:02:14.993
> 
> 标签：python, numpy, dictionary, dataset, list-comprehension

I am new to python, and am setting up a large dataset to work on, and wanted to check and make sure that I am doing this in the most optimized manner possible, which right now I am pretty sure I am not. I have a python dictionary that is currently set up as so.

```
list1 = [1,2],[3,4],[4,5]
list2 = [10,20],[30,40],[50,60]
list3 = [100,200],[300,400],[400,500] 
```

These list are created programmatically (and much larger in reality), and are then sorted into a dictionary as follows:

```
l_dict = {"l1":list1,"l2":list2,"l3":list3} 
print l_dict  
    `{'l2': ([10, 20], [30, 40], [50, 60]), 'l3': ([100, 200], [300, 400], [400, 500]), 'l1': ([1, 2], [3, 4], [4, 5])}` 
```

I have another dicitonary set up exactly the same, except with different numbers and object name (call it k_dict). Here are my questions: What is the simplest way to get an array/list of the first object in each tupple? My code now is as follows:

```
#Gets first tuple value from each list 
listnames = ["l1","l2","l3"]
i=10
while(i < len(listdict)):
 for x,a in l_dict[listnames[i]]:
  return a[0]
 i+=1 
```

Which was working

Should return something like `(1,3,4,10,30,50,100,300,400)` except spaced with newlines

I have also tried dict comprehension

```
print {x[0] for x in ldict[listnames]} 
```

Which never worked for me, and I have tried many similar variations that wouldn't work either.

Also, is this dictionary a good way to set this data up? I couldn't find any other examples of list of tuples inside dictionaries, which leads me to believe there might be some dataframe/other manner of storing data like this that is easier to use. I am using python 2.7.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:07:03.303

Use this list comprehension:

```
In [16]: [y[0]  for x in listnames for y in l_dict[x]]
Out[16]: [1, 3, 4, 10, 30, 50, 100, 300, 400] 
```

Above list comprehension is equivalent to:

```
In [26]: lis=[]

In [27]: for x in listnames:
   ....:     for y in l_dict[x]:
   ....:         lis.append(y[0])
   ....:         

In [28]: lis
Out[28]: [1, 3, 4, 10, 30, 50, 100, 300, 400] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:09:32.790

听起来您正在寻找经常想要的`zip`。看这个：

```
list1 = [1,2],[3,4],[4,5]
print zip(*list1)
# [(1, 3, 4), (2, 4, 5)] 
```

如果您真的只想使用第一对

```
from itertools import izip
generator = izip(*list1)
first = next(generator) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:21:05.107

假设 k_dict 和 l_dict 具有相同的结构，您可以通过迭代它们来比较它们的值，如下所示：

```
for listname in listnames:
   for i, lv in enumerate(l_dict[listname]):
      kv = k_dict[listname][i]
      #lv and kv will contain a pair of values, e.g [1,2] or [200,300]
      if lv[0] == kv[0]:
          #do something
          pass 
```

但是，因为您的字典值是元组，所以它们是不可变的。您可能希望将它们改为列表，以便您可以更改它们的值，例如：

```
l_dict = {k:list(v) for k,v in l_dict.iteritems()} 
```

# c# - 我可以在 Windows 8 RT 上运行 Windows Phone 8，反之亦然吗？

> ID：15890535
> 
> 赞同：0
> 
> 时间：2013-04-08T23:02:21.843
> 
> 标签：c#, xaml, windows-8, windows-runtime, windows-phone-8

我可以在 windows phone 上运行 RT 应用程序，或在 windows 8 RT 或 PRO 上运行 windows 8 phone 应用程序吗？

如果我需要开发一个可以在 RT 平板电脑和 Windows 8 手机上运行的应用程序，我应该怎么做？

**编辑**

微软什么时候会提供统一的方式来开发应用？？？？

我是否被要求开发大量应用程序以在所有 Microsoft 平台上运行，我根本不是 Apple 粉丝，但 Microsoft 应该从他们身上学到越来越多的东西，我把所有时间都花在追逐 Microsoft 技术上，这是非常非常讨厌！！！:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T23:03:30.203

不，

但是您可以通过使用可移植类库或链接文件来共享代码。

我最近写了两篇关于如何实现这一点的文章：

第一个是关于是否选择 PCL 或链接文件： [http ://www.kenneth-truyers.net/2013/03/27/portable-class-libraries-or-source-code-sharing/](http://www.kenneth-truyers.net/2013/03/27/portable-class-libraries-or-source-code-sharing/)

第二个是关于如何解决 PCL 的限制：http: [//www.kenneth-truyers.net/2013/02/24/patterns-for-sharing-code-in-windows-phone-and-windows- 8-应用程序/](http://www.kenneth-truyers.net/2013/02/24/patterns-for-sharing-code-in-windows-phone-and-windows-8-applications/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-08T23:03:31.420

不，这两个运行时不兼容。

> 如果我需要开发一个可以在 RT 平板电脑和 Windows 8 手机上运行的应用程序，我应该怎么做？

您可以使用[可移植类库](http://msdn.microsoft.com/en-us/library/gg597391.aspx)来保存*逻辑*，但不能保存表示代码。

然后，您将使用适合该平台的工具在每个平台上构建您的 UI。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T23:05:05.647

您不能只在平板电脑上运行 xap。但是，您可以获取几乎所有未编译的 XAML 和 C# 代码并为平板电脑重新编译。您只需要修复语法中的一些特质。Windows 8 Pro 也是如此。

# php - 具有许多连接的 Mysql 查询需要很长时间才能加载

> ID：15890543
> 
> 赞同：1
> 
> 时间：2013-04-08T23:02:55.733
> 
> 标签：php, mysql, codeigniter

我正在使用此查询来获取记录

```
SELECT *
FROM (`content` as c)
LEFT JOIN `content_assets` AS ca ON `ca`.`contentid` = `c`.`id`
LEFT JOIN `assets` AS a ON `a`.`act_id` = `ca`.`actorid`
INNER JOIN `content_gens` AS cg ON `cg`.`contentid` = `c`.`id`
INNER JOIN `gens` AS g ON `cg`.`genid` = `g`.`gen_id`
LEFT JOIN `live_data` AS l ON `l`.`contentid` = `c`.`id`
LEFT JOIN `live_type` AS lt ON `lt`.`lt_id` = `l`.`live_type`
LEFT JOIN `returned` AS r ON `r`.`content_id` = `c`.`id`
WHERE `c`.`id` =  '14175' 
```

我的 live_data 表是导致此加载时间的主要问题，它包含大约 200k 条记录，并且需要 20-40 秒来加载页面。如果我不加入那张桌子，一切都很好。我目前正在使用基于文件的缓存来缓存上述查询的结果，但我想知道是否可以进一步优化上述查询。

编辑：我的表索引可以在这里看到。

```
-- phpMyAdmin SQL Dump
-- version 3.4.5
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Apr 08, 2013 at 11:07 PM
-- Server version: 5.5.16
-- PHP Version: 5.3.8

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

--
-- Database: `database`
--

-- --------------------------------------------------------

--
-- Table structure for table `assets`
--

CREATE TABLE IF NOT EXISTS `assets` (
  `act_id` int(11) NOT NULL AUTO_INCREMENT,
......
  PRIMARY KEY (`act_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=8726 ;

-- --------------------------------------------------------

--
-- Table structure for table `content`
--

CREATE TABLE IF NOT EXISTS `content` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
.........
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=14267 ;

-- --------------------------------------------------------

--
-- Table structure for table `content_asset`
--

CREATE TABLE IF NOT EXISTS `content_asset` (
  `contentid` int(11) NOT NULL,
  `actorid` int(11) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

-- --------------------------------------------------------

--
-- Table structure for table `content_gener`
--

CREATE TABLE IF NOT EXISTS `content_gener` (
  `contentid` int(11) NOT NULL,
  `genid` int(11) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

-- --------------------------------------------------------

--
-- Table structure for table `gens`
--

CREATE TABLE IF NOT EXISTS `gens` (
  `gen_id` int(11) NOT NULL AUTO_INCREMENT,
......
  PRIMARY KEY (`gen_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=65 ;

-- --------------------------------------------------------

--
-- Table structure for table `live_data`
--

CREATE TABLE IF NOT EXISTS `live_data` (
  `link_id` int(11) NOT NULL AUTO_INCREMENT,
.....
  PRIMARY KEY (`link_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=214014 ;

-- --------------------------------------------------------

--
-- Table structure for table `live_type`
--

CREATE TABLE IF NOT EXISTS `live_type` (
  `lt_id` int(11) NOT NULL AUTO_INCREMENT,
....
  PRIMARY KEY (`lt_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;

-- --------------------------------------------------------

--
-- Table structure for table `returned`
--

CREATE TABLE IF NOT EXISTS `returned` (
  `r_id` int(11) NOT NULL AUTO_INCREMENT,
....
  PRIMARY KEY (`r_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

并解释查询结果： ![在此处输入图像描述](https://i.stack.imgur.com/q7TRN.png)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:11:33.177

您应该在以下列上添加索引：

*   `live_data.contentid`
*   `content_asset.contentid`
*   `content_gener.contentid`

并使用 . 将您的大表转换为 InnoDB `ALTER TABLE table_name ENGINE = InnoDB`。

[此外，使用外键](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)通常是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:08:37.350

如果您`explain [your full query]`在 MySQL 控制台中运行，您将看到使用了哪些索引。根据连接中每个表的大小，您希望在用于连接连接中的表的列上具有索引。

# deployment - Capistrano deploy from local machine

> ID：15890547
> 
> 赞同：0
> 
> 时间：2013-04-08T23:03:17.450
> 
> 标签：deployment, github, ssh, capistrano, ssh-keys

Im trying to create a new user to deploy my application from my local machine to my external server.

I've got it working using root but understand it's not secure to use root, therefore I want to create a user called 'deployer'. I've added this user to my external server and copied my local is_rsa.pub key to /.ssh/authorized_keys on the server, however when I run `cap development deploy` I keep getting the following error:

```
failed: "sh -c 'if [ -d /var/www/vhosts/xyz.co.uk/shared/cached-copy ]; then cd
  /var/www/vhosts/xyz.co.uk/shared/cached-copy && git fetch -q origin && git fetch --
tags -q origin && git reset -q --hard 2b738f4ca8008dcf9e84c4be5d63d906a7bfd760 && git clean 
-q -d -x -f; else git clone -q git@github.com:xyz/xyz.co.uk.git 
/var/www/vhosts/xyz.co.uk/shared/cached-copy && cd /var/www/vhosts/xyz.co.uk/shared/cached-
copy && git checkout -q -b deploy 2b738f4ca8008dcf9e84c4be5d63d906a7bfd760; fi'" on 
x.xx.xx.xxx 
```

If I run ssh -T git@github.com on the external server it says:

```
Hi username! You've successfully authenticated, but GitHub does not provide shell access. 
```

This username is not deployer though, I assume its the username of the github account.

Any ideas what I need to do? Do I need to create the deployer user on my local machine too?

Here is my deploy.rb file:

```
set :stage_dir, 'app/config/deploy' # needed for Symfony2 only
set :stages, %w(production staging development)
require 'capistrano/ext/multistage'

set :application,           "xyz.co.uk"
set :user,                  "deployer"  # The server's user for deploys

set :normalize_asset_timestamps, false

set :repository,            "git@github.xyz/xyz.co.uk.git"
set :scm,                   :git
set :keep_releases,         3
after "deploy:update",      "deploy:cleanup"
set :use_sudo,              false
set :web_path,              "web"
set :shared_files,          ["app/config/parameters.yml"]
set :shared_children,       [app_path + "/logs", web_path + "/uploads"]
set :use_composer,          true
set :update_vendors,        true
set :dump_assetic_assets,   true
set :deploy_via,            :remote_cache

#logger.level = Logger::MAX_LEVEL

after "deploy:update_code" do
  capifony_pretty_print "--> Ensuring cache directory permissions"
  run "setfacl -R -m u:www-data:rwX -m u:`whoami`:rwX #{latest_release}/#{cache_path}"
  run "setfacl -dR -m u:www-data:rwX -m u:`whoami`:rwX #{latest_release}/#{cache_path}"
  capifony_puts_ok
end 
```

deveopment.rb file:

```
server 'x.xx.xx.xxx', :app, :web, :db, :primary => true
ssh_options[:port] = 1234
ssh_options[:forward_agent] = true
default_run_options[:pty] = true
set :deploy_to, "/var/www/vhosts/xyz.co.uk"
set :symfony_env_prod, "dev"
set :branch, "develop"

# Need to clear *_dev controllers
set :clear_controllers,     false 
```

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T05:46:09.180

您希望目标机器使用您的本地 SSH 凭据向 Github 进行身份验证。通过将以下两个条目放入您的 deploy.rb 来做到这一点

```
ssh_options[:forward_agent] = true
default_run_options[:pty] = true 
```

或者，另一种方法是转到您的 Github 存储库并将目标服务器的公共 SSH 密钥添加为*部署密钥*

```
https://github.com/your_github/your_repo/settings/keys 
```

这使目标服务器可以仅访问指定的存储库，而无需使用您的个人 SSH 密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T07:56:08.620

问题是因为“部署者”用户在服务器上没有写权限。

# java - 如何从毫秒 X 在 java 中播放声音

> ID：15890548
> 
> 赞同：1
> 
> 时间：2013-04-08T23:03:19.047
> 
> 标签：java, audio, milliseconds

我有一个问题，我想播放一个声音（或音乐文件），例如从第二个 10 到 12，可以制作一个类似 soundObject.play(10000,12000); 的函数；? 实际上我正在测试声音类，但我只能播放、停止和循环

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T17:17:50.557

终于找到答案了，这是我用来玩3-5秒的代码

```
import java.io.IOException;
import java.net.URL;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.UnsupportedAudioFileException;

public class SoundClipTest{

   public static void main(String[] args) throws UnsupportedAudioFileException, IOException, LineUnavailableException {
       URL myURL= ClassLoader.getSystemResource("abesti.wav");
       AudioInputStream audio = AudioSystem.getAudioInputStream(myURL);
       Clip clip = AudioSystem.getClip();
       clip.open(audio);
       clip.setMicrosecondPosition(3000000);
       clip.start();
       try {
        Thread.sleep(2000); //in milliseconds
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
       clip.stop();
   }
} 
```

# java - Java annotation processing basics

> ID：15890553
> 
> 赞同：2
> 
> 时间：2013-04-08T23:03:37.347
> 
> 标签：java, annotations

I have used the simple annotations given to us in the JDK and by other libraries such as hibernate, but I've never written my own. Can someone help me decide if an annotation is the proper way to do this?

I want to annotate a method like this:

```
@MyAnnotation(5)
public void foo() {
     methodThatMightTakeLongerThan5();
} 
```

When foo takes longer than 5 seconds, print a message to my log file. Is this possible with Annotations? Is that the preferred implementation?

Going a bit further...I'd like to be able to modify the value passed to the annotation via JMX bean so that I can modify it at runtime if I want to. Is that possible/preferred?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:48:09.030

您可以放入`methodThatMightTakeLongerThan5();`Thread 中，在 中运行线程`foo()`，使用 等待 5 秒`Thread.sleep(5000);`，然后检查线程是否已完成。如果没有，请打印您需要的任何内容。我假设有一种方法可以检查线程是否正在运行，但我不确定。

# asp.net-mvc-4 - How to manage sub-domains on winhost with URL Rewrite and ASP.NET Optimization's bundles

> ID：15890554
> 
> 赞同：3
> 
> 时间：2013-04-08T23:03:37.563
> 
> 标签：asp.net-mvc-4, iis-7, url-rewriting, bundling-and-minification, asp.net-optimization

I am using ASP.NET MVC4 with WinHost.

Just like the question asked [here](https://stackoverflow.com/questions/2678528/how-to-manage-sub-domains-on-winhost-with-iis7-url-rewrite-2-0), I ran into the same issue:

> I'm trying out WinHost and I'm running into some issues with sub-domains. On WinHost, you can have multiple sub-domains per hosting account, but each sub-domain points to the root website. E.g. you can have www.example.com, sub1.example.com, and sub2.example.com but all of them display the content at [http://www.example.com/](http://www.example.com/).
> 
> Other Hosts allow you to point sub-domains to a sub folder in your website. This would allow you to point sub1.example.com to /sub1, sub2.example.com to /sub2 and www.example.com to /.
> 
> WinHost recommends using an asp/aspx page to redirect [http://sub1.example.com](http://sub1.example.com) to [http://sub1.example.com/sub1](http://sub1.example.com/sub1), which points to /sub1\. While that would work, I'd like to not have the subdomain in the url twice.
> 
> So I tried using IIS7 URL Rewrite to point [http://sub1.example.com](http://sub1.example.com) to /sub1\. Ben Powell describes this in detail on [his blog](http://blog.benpowell.co.uk/2010/02/winhostcom-how-to-really-run-multiple.html).

I've managed to get this portion to work so that [http://sub1.example.com](http://sub1.example.com) actually points to my virtual application "/sub1" in IIS.

If I use Url.Content, it works flawlessly.

Now, I am using ASP.NET Optimization and I bundle scripts and css. Issue is that it absolutely require a relative url ie:

```
 bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                    "~/Scripts/jquery.unobtrusive*",
                    "~/Scripts/jquery.validate*")); 
```

However, because it's a relative url here is what I will get in the markup:

```
<script src="/sub1/bundles/jqueryval?v=UgyEMAYOuSB9Bb6HcOEVHpd6fIIp54yF086SRNVcdIY1"></script> 
```

Of course, because of the "sub1" it doesn't find the file. I thought about URL Redirect that I never actually got to work. Maybe a route in MVC? Unsure how to do this as well. I could also drop the bundling alltogether to use "Url.Content" which I think is sad.

What would be the best way to handle this issue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:40:23.430

我知道您可以使用 IBundleTransform 根据独特的情况修改包中的内容。您可能能够修改捆绑上下文本身。这是一个链接[MVC4 StyleBundle not resolve images](https://stackoverflow.com/questions/11355935/mvc4-stylebundle-not-resolving-images)

# c - output of a function which has passByName parameter passing paradigm

> ID：15890555
> 
> 赞同：-2
> 
> 时间：2013-04-08T23:03:43.437
> 
> 标签：c, pass-by-name

I've tried to figure out what is the output of a code like this .By the way ,It is not a real question, kind of therical question, i mean it is not an original c code, it is kind of a PL having c-code syntax and passed by name parameter paradigm.

```
int x=12,y=10;
void tswap(int pa, int pb) {
int tmp;
tmp=pa;
pa=pb;
pb=tmp;
x=x+pa;
x=x-pb;
y++;
printf("%d %d %d %d\n",pa,pb,x,y);
}

int main() {
int a=4;
tswap(x,a);
printf("%d %d %d\n",x,y,a);
tswap(++x,++y);
printf("%d %d %d\n",x,y,a);
return 0;
} 
```

I think the output of first part should be :

```
-4 12 -4 11
-4 11 12 
```

But i could find a logical solution for the part tswap (++x, ++y) Is there anyone who can know how can I handle with this part ?

Thanks in advance !

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:06:37.783

```
tswap(++x,++y) 
```

is the same as:

```
++x;
++y;
tswap(x,y); 
```

making your output:

```
4 12 4 11
4 11 4
12 5 12 13
12 13 4 
```

# objective-c - 需要参考帮助 - ARC + Cocos 2d

> ID：15890558
> 
> 赞同：0
> 
> 时间：2013-04-08T23:03:59.330
> 
> 标签：objective-c, cocos2d-iphone

ARC正在踢我的ARC

我安装了 cocos 2d 并且看到我想使用 ARC 时很不高兴。我有一个我似乎无法弄清楚的问题。

Instruments 说我有 5 个对我的 GraphicsManager 对象的引用，但我只能得出其中的 4 个。我需要创建和发布其中的许多。

类“RowManager”（CCLayer）调用类“GraphicsManager”（CCNode）来制作这些对象。RowManager 调用其方法通过选择器移动对象：[self schedule:@selector(row:) interval:.01]

最后，当对象到达一个点时，方法“row1Finished”被调用，然后在调用对象（死）删除它自己的孩子之前创建一个对该对象的引用。

我可以让所有三个动画停止，让对象从 RowManager 中分离并消失，但 dealloc 方法仍然不会调用自身。我究竟做错了什么？

要转换我的非弧 cocos2d 模板，我按照此处的说明进行操作：

[http://www.learn-cocos2d.com/2012/04/enabling-arc-cocos2d-project-howto-stepbystep-tutorialguide/](http://www.learn-cocos2d.com/2012/04/enabling-arc-cocos2d-project-howto-stepbystep-tutorialguide/)

```
/////////////////

@interface RowManager : CCLayer {
    GraphicsManager *graphicsObject;
}

@implementation RowManager
-(id) init
{
    if( (self=[super init]) ) {

        graphicsObject = [[GraphicsManager alloc] initWithBoatType:@"flatboat" withWord:@"life" usingCharacter:@"Puchai" orientation:@"up" visible:YES];
        graphicsObject.tag = 21;
        graphicsObject.position = ccp(offset,size.height/4.1);
        [self addChild: graphicsObject];
        [self schedule:@selector(row1:) interval:.01];
        [self schedule:@selector(rotate:) interval:6];

// etc…

-(void)row1:(ccTime)dt{
    // scroll the object across the screen
    graphicsObject = (GraphicsManager *)[self getChildByTag:21]; // reference: for the row method
    graphicsObject.position = ccp(graphicsObject.position.x-1, graphicsObject.position.y);
    if (graphicsObject.position.x < 0 - graphicsObject.boatWidth){
        [self row1Finished];

    }
}

-(void)rotate:(ccTime)dt {
    //waggle the object a bit
   graphicsObject = (GraphicsManager *)[self getChildByTag:21]; // reference 2: for the rotate method
    [graphicsObject runAction:[CCSequence actions:
                               [CCRotateBy actionWithDuration:1 angle:.8],
                               [CCRotateBy actionWithDuration:2 angle:-.8],
                               [CCRotateBy actionWithDuration:1 angle:-.8],
                               [CCRotateBy actionWithDuration:2 angle:.8],
                               nil]];
}
-(void) row1Finished {

    graphicsObject = (GraphicsManager *)[self getChildByTag:21]; // reference 3: to reference the referenced

    [self unschedule:@selector (row1:)];
    [self unschedule:@selector(rotateBoat:)];
    [graphicsObject die];  // call within object class to remove references
    [self removeChild:graphicsObject cleanup:YES];
    graphicsObject = nil;
}

/////////////////////

in Graphics Manager Class:

///////////////////

@interface GraphicsManager : CCNode {...}
@property CGFloat boatWidth;
…etc

@implementation GraphicsManager
@synthesize boatWidth;
- (void) die {

    [self unschedule:@selector(puchaiRow:)]; // reference 4 animation 
    [self stopAllActions];
    [self removeAllChildrenWithCleanup:YES]; // removes sub objects created in class

    NSLog(@"Died");
}
- (void)dealloc
{
    CCLOG(@"Graphics Manager dealloc: %@", self);
}

-(id)initWithBoatType:(NSString *)boatType orientation:(NSString *)orientation
{

    self = [super init];
    if (self){

        if ([orientation isEqual: @"upstream"]){

            flatBoat = [CCSprite spriteWithFile:@"flatBoat.png"];
            flatBoat.anchorPoint = ccp(0,0);
            self.boatWidth = [flatBoat boundingBox].size.width;
            [self addChild:flatBoat];

            [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"puchai.plist"];
            puchai = [CCSprite spriteWithSpriteFrameName:@"puchai1.png"];
            puchai.anchorPoint = ccp(0,0);
            puchai.position = ccp(20,30);
            puchai.tag = 4;
            [self addChild:puchai];

            [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"cube.plist"];

            cube = [CCSprite spriteWithSpriteFrameName:@"cube1.png"];
            cube.scale = .80;
            cube.tag = 56;
            cube.visible = NO;
            cube.position = ccp(150,45);
            [self addChild:cube];

            cube = [CCSprite spriteWithSpriteFrameName:@"cube2.png"];
            cube.scale = .80;
            cube.position = ccp(-1 +150,[cube boundingBox].size.height +45);
            cube.tag = 57;
            cube.visible = NO;
            [self addChild:cube];

           [self schedule:@selector(puchaiRow:) interval:3]; // reference 4 animation

            flatBoatWing = [CCSprite spriteWithFile:@"flatBoatWing.png"];
            flatBoatWing.anchorPoint = ccp(0,0);
            flatBoatWing.position = ccp(25,17);
            [self addChild:flatBoatWing];

        }
///etc

-(void)puchaiRow:(ccTime)dt{

    puchai = (CCSprite *)[self getChildByTag:4];
    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"puchai.plist"];
    NSMutableArray *frames = [[NSMutableArray alloc]init];
    for (int i = 1; i<=8; i++) {

        NSString *frameName = [NSString stringWithFormat:@"puchai%i.png",i ];
        [frames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache]
                           spriteFrameByName:frameName]];
    }
    CCAnimation *a = [CCAnimation animationWithSpriteFrames:frames delay:1.0f/5.0f];
    [puchai runAction:[CCAnimate actionWithAnimation:a]]; 
```

////////// 这里是zombies:history 输出。

```
#   Address Category    Event Type  RefCt   Timestamp   Size    Responsible Caller
0   0x13ea95e0  GraphicsManager Malloc  1   00:02.748.439   208 -[RowManager init]
1   0x13ea95e0  GraphicsManager Retain  2   00:02.748.447   0   -[GraphicsManager initWithBoatType:withWord:usingCharacter:orientation:visible:]
2   0x13ea95e0  GraphicsManager Release 1   00:02.748.449   0   -[GraphicsManager initWithBoatType:withWord:usingCharacter:orientation:visible:]
3   0x13ea95e0  GraphicsManager Retain  2   00:02.841.543   0   -[CCScheduler scheduleSelector:forTarget:interval:paused:repeat:delay:]
4   0x13ea95e0  GraphicsManager Retain  3   00:02.841.572   0   ccArrayAppendObjectWithResize
5   0x13ea95e0  GraphicsManager Retain  4   00:03.477.669   0   -[RowManager row1:]  <--- AHA!!!! 
6   0x13ea95e0  GraphicsManager Retain  5   00:03.482.438   0   -[RowManager row1Finished]
7   0x13ea95e0  GraphicsManager Release 4   00:03.482.439   0   -[RowManager row1Finished]
8   0x13ea95e0  GraphicsManager Release 3   00:03.482.480   0   -[CCScheduler removeHashElement:]
9   0x13ea95e0  GraphicsManager Release 2   00:03.483.435   0   ccArrayRemoveObjectAtIndex
10  0x13ea95e0  GraphicsManager Release 1   00:03.483.436   0   -[RowManager row1Finished] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T09:03:14.570

您可以使用`(__bridge id)`从 ARC 中排除，您需要排除什么并使用手动保留释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T12:00:42.620

应该`[self unschedule:@selector (row1:)];`是`[self unschedule:@selector (row:)];`？这将使额外的参考保持活力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T14:58:11.003

通过再次查看僵尸历史来解决问题。在 row1 中，我在调用 row1finished 后没有将对象设置为 nil，这违反了法律：对于同一类中的每个引用，您必须将所有引用“nillify”为零......

故事的寓意：很难找到 bug 的原因是因为我安排了 row1 例程并让它运行了大约 50 次，导致僵尸历史中出现了一堆保留版本，因此无法通过消除来减少。我注释掉了周围的代码，摆脱了所有这些，并且能够获得我可以解析的僵尸输出。

感谢大家的意见！我想我现在知道如何更好地使用乐器了！

```
-(void)row1:(ccTime)dt{

    graphicsObjectRow1 = (GraphicsManager *)[self getChildByTag:11];
    graphicsObjectRow1.position = ccp(graphicsObjectRow1.position.x + 1,graphicsObjectRow1.position.y);

   // if (graphicsObjectRow1.position.x > screenX/4){
        [self row1Finished];
    graphicsObjectRow1 = nil;
        // graphicsObjectRow1.position = ccp(offset,size.height/4.1);
   // }

} 
```

# java - Java/Hibernate: How to detect, if field is lazy-loaded proxy and not actual data?

> ID：15890559
> 
> 赞同：6
> 
> 时间：2013-04-08T23:04:10.350
> 
> 标签：java, hibernate, lazy-loading, dto

I'm converting my entity to DTO and I want to set NULL as DTO value for all fields, which are lazy-loaded and not initialized (because I do not want to transfer all the data all the time).

I've tried:

```
if (!(entity.getNationality() instanceof HibernateProxy))
    this.setNationalityFromEntity(entity.getNationality()); 
```

But it did not seemed to help. Any suggestions are welcome!

Thank you!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-05-14T04:30:09.367

我们在实体中这样做的方式是我们有布尔方法，这些方法以不会触发延迟加载的方式进行检查。例如，如果我们的 Entity 有一个名为“associatedSomething”的关联实体，那么检查该关联实体是否已延迟加载的方法将是：

```
 public boolean isAssociatedSomethingLoaded() {
        if (associatedSomething instanceof HibernateProxy) {
            if (((HibernateProxy)associatedSomething).getHibernateLazyInitializer().isUninitialized()) {
                return false;
            }
        }
        return (getAssociatedSomething() != null);
    } 
```

注意：重要的是不要`getAssociatedSomething()`在检查中使用，因为这样可以确保关联的实体在检查期间不会被延迟加载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T23:22:04.630

该类始终是一个代理，无论它是否已初始化，因此如果您只检查代理实例，您每次都将排除它。延迟加载不会导致实体上的代理引用被替换为对新对象的引用，它只是填充字段。

要确定它是否实际初始化，您需要询问它！

```
if (HibernateProxy.class.isInstance(entity.getNationality())) {
  HibernateProxy proxy = HibernateProxy.class.cast(entity.getNationality());
  if (!proxy.getHibernateLazyInitializer().isUninitialized()) {
    this.setNationalityFromEntity(entity.getNationality());
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-19T18:25:17.617

在我看来，仅仅能够为某些不应该用于用例的状态调用 getter 的可能性是有问题的，但这是另一回事。我建议您实施适当的 DTO 方法以避免意外错误。

我为该用例创建了[Blaze-Persistence 实体视图](https://github.com/Blazebit/blaze-persistence#entity-view-usage)。您基本上将 JPA 实体的 DTO 定义为接口并将它们应用于查询。它支持映射嵌套的 DTO、集合等，基本上是您所期望的一切，最重要的是，它将提高您的查询性能，因为它会生成仅获取 DTO 实际需要的数据的查询。

您的示例的实体视图可能如下所示

```
@EntityView(Person.class)
interface PersonDto {
  String getNationality();
} 
```

查询可能看起来像这样

```
List<PersonDto> dtos = entityViewManager.applySetting(
  EntityViewSetting.create(PersonDto.class),
  criteriaBuilderFactory.create(em, Person.class)
).getResultList(); 
```

# javascript - 在 Internet Explorer 中调试 JavaScript 时，“Invalid Argument”是什么意思以及导致此错误的原因是什么？

> ID：15890561
> 
> 赞同：1
> 
> 时间：2013-04-08T23:04:14.647
> 
> 标签：javascript, debugging, arguments

使用时出现错误`getElementById()`。我不会发布整个程序，因为它是家庭作业，但是当我注释掉这行代码时，我不会再收到任何语法错误。我应该在可能导致问题的其余代码中寻找什么？

```
document.getElementById("bugOne").style.left = xPos + "px"; 
```

另外-通常是由什么引起的“无效参数”错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T23:15:34.647

`"Invalid Argument"`将是运行时错误，而不是语法错误。不要跳到`getElementById()`罪魁祸首——你在一行代码中有很多事情要做。对于调试，分解复杂的语句很有用：

```
var bugOne = document.getElementById("bugOne");
var left = xPos + "px";
bugOne.style.left = left; 
```

在 IE8 中，如果您在样式属性上设置了错误的值，则会`"Invalid argument"`出现错误。我猜`xPos`包含`undefined`或`NaN`。在调试器中设置断点并检查`xPos`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:12:32.217

请从定义到使用发布 xPos 变量和 bugOne 的代码（HTML 和 JS），因为这可能会使您的问题更容易回答。

另外，你在使用 jQuery 吗？如果不是，为什么不呢？

[此页面](http://www.overset.com/2008/03/05/javascript-invalid-argument-errors/)（链接）没有解释“无效参数”的含义，但它显示了最有可能发生的区域。

# sql-server - 对同一张表的多个查询进行分组，TQSL

> ID：15890567
> 
> 赞同：0
> 
> 时间：2013-04-08T23:04:38.047
> 
> 标签：sql-server, tsql, group-by, union

我有一个相当大的信息表，需要针对几个不同的工作部门进行不同的过滤。我创建了以下查询，它返回相同数量的列，以便它们应该能够被 UNION 起来。我想确保没有返回重复的行，这就是我使用 UNION 的原因，但是我不断收到错误消息“Msg 8120, Level 16, State 1, Line 53 Column 'ACT_DW.dbo.INV-ACT.DNUM' is invalid在选择列表中，因为它不包含在聚合函数或 GROUP BY 子句中。”
有人在这里看到这个问题吗？如果可能的话，我希望得到的只是一个按每个工作组的 Deskname 字段分组的所有记录的大表。

```
 declare @InventoryAsOfEOD date,
        @Start date,
        @End date   

SET @Start = CAST(DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()),0) AS DATE)
SET @End = CAST(DATEADD(DAY, -(DAY(DATEADD(MONTH, 1, GETDATE()))), DATEADD(MONTH, 1, GETDATE())) as DATE)

IF
    DATENAME(DW, GETDATE()) = 'Monday'
BEGIN
    Set @InventoryAsOfEOD = CAST(DATEADD(D, -3, GETDATE())AS DATE) 
END
ELSE
    Set @InventoryAsOfEOD = CAST(DATEADD(D, -1, GETDATE()) AS DATE)

print @inventoryasofeod
print @start
print @end

SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    DueDate,
    PnI,
    PIBALATSETUP,
    Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    Ttl_Starts

FROM

(SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    PROGSTARTDT as DueDate,
    sum([Prinbal]+[INTBAL]) as PnI,
    PIBALATSETUP,
    BALANCE as Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    COUNT(SSN) as Ttl_Starts

FROM 
    [ACT_DW].[dbo].[INV-ACT] with(INDEX([IX_INV-ACT_InventoryAsOfEOD]),nolock)
WHERE 
    InventoryAsOfEOD = @InventoryAsOfEOD AND
    BC ='GSL' AND
    PROGTYPE not in('PMT PLAN', 'Fallout', 'PIF', 'SIF') AND
    PROGTYPE is not null and
    PYMTDT1 BETWEEN @Start AND @End

UNION 
--Get Oregon Starts

SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    PROGSTARTDT as DueDate,
    sum([Prinbal]+[INTBAL]) as PnI,
    PIBALATSETUP,
    BALANCE as Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    COUNT(SSN) as Ttl_Starts

FROM 
    [ACT_DW].[dbo].[INV-ACT] with(INDEX([IX_INV-ACT_InventoryAsOfEOD]),nolock)
WHERE
    InventoryAsOfEOD = @InventoryAsOfEOD and
    CLIENT like 'ORDOR%' and    
    PROGTYPE not in ('Null', 'Fallout') AND
    PYMTDT1 BETWEEN @Start AND @End

UNION 
--Get Perkins Starts

SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    PROGSTARTDT as DueDate,
    sum([Prinbal]+[INTBAL]) as PnI,
    PIBALATSETUP,
    BALANCE as Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    COUNT(SSN) as Ttl_Starts
FROM
    [ACT_DW].[dbo].[INV-ACT] with(INDEX([IX_INV-ACT_InventoryAsOfEOD]),nolock)
WHERE
    InventoryAsOfEOD = @InventoryAsOfEOD and
    BC in ('PE1', 'PE2', 'PE3', 'NU1', 'NU2', 'NDS') and
    PROGTYPE not in ('Null', 'Fallout') AND
    PYMTDT1 BETWEEN @Start AND @End

UNION 

--Get starts for Tuition

SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    PROGSTARTDT as DueDate,
    sum([Prinbal]+[INTBAL]) as PnI,
    PIBALATSETUP,
    BALANCE as Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    COUNT(SSN) as Ttl_Starts
FROM
    [ACT_DW].[dbo].[INV-ACT] with(INDEX([IX_INV-ACT_InventoryAsOfEOD]),nolock)
WHERE
    InventoryAsOfEOD = @InventoryAsOfEOD and
    BC in ('AR1', 'AR2', 'IN1', 'IN2', 'IN3', 'TU1', 'TU2', 'TU3') and
    PROGTYPE not in ('Null', 'Fallout') AND
    PYMTDT1 BETWEEN @Start AND @End

UNION 

--Get Starts for Chase

SELECT 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    [DESK],
    Deskname,
    PYMTAMT1,
    PROGSTARTDT as DueDate,
    sum([Prinbal]+[INTBAL]) as PnI,
    PIBALATSETUP,
    BALANCE as Ttl_Balance,
    pmgroup,
    PROGTYPE,
    office,
    client,
    batch,
    placetype,
    pymtdt1,
    COUNT(SSN) as Ttl_Starts
FROM
    [ACT_DW].[dbo].[INV-ACT] with(INDEX([IX_INV-ACT_InventoryAsOfEOD]),nolock)
WHERE
    InventoryAsOfEOD = @InventoryAsOfEOD and
    CLIENT like 'AG%' and
    PROGTYPE not in ('Null', 'Fallout') AND
    PYMTDT1 BETWEEN @Start AND @End) 
    as StartsTable

GROUP BY 
    DNUM,
    SSN,
    DTRFIRSTNAME,
    DTRLASTNAME,
    ASSIGNDATE,
    PYMTAMT1,
    DueDate,
    PIBALATSETUP,
    Ttl_Balance,
    PROGTYPE,
    DESK,
    deskname,
    PMGROUP,
    OFFICE,
    CLIENT,
    BATCH,
    PLACETYPE,
    PYMTDT1
ORDER BY 
    PMGROUP,
    DESK 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:15:10.317

您需要`GROUP BY`为每个包含聚合的子查询包含您的子句。您可以改为联合行*然后*聚合，但这将是一个不同的查询。

# c# - Asp.Net Mvc Method OutputCache属性集基于HttpContext.Current.IsDebuggingEnabled

> ID：15890575
> 
> 赞同：0
> 
> 时间：2013-04-08T23:05:18.607
> 
> 标签：c#, asp.net-mvc

我正在尝试根据调试标志设置方法属性。我预计会有编译时间问题。也许有人可以想到一种解决方法，它类似于如果它有效的话。

```
[OutputCache(
    NoStore = HttpContext.Current.IsDebuggingEnabled, 
    Duration=(HttpContext.Current.IsDebuggingEnabled)?0:15
)]///TODO: REMOVE THIS Attribute AFTER TESTING!
public ActionResult RenderSomething(int somethingID)
{
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:35:11.087

你不能使用预处理条件吗？

```
#if DEBUG
    [OutputCache(
        NoStore = HttpContext.Current.IsDebuggingEnabled, 
        Duration = 0)]
#else
    [OutputCache(
        NoStore = HttpContext.Current.IsDebuggingEnabled, 
        Duration = 15)]    
#endif 
```

..？

编辑：我已经确认这将适用于我使用该`Serializable`属性的测试。应该为你想要达到的目标工作（虽然不确定它是否是最好的解决方案..但它有效！）。

# image - 在 CSS 中使用 8 个单独的边框图像而不是边框 图像

> ID：15890578
> 
> 赞同：1
> 
> 时间：2013-04-08T23:05:42.020
> 
> 标签：image, css, border

我已经为主要（固定宽度）内容框周围的边框提供了 8 个单独的图像（左上、上、右上等）。如果给我一张图片，我会使用[border-image](http://www.w3schools.com/cssref/css3_pr_border-image.asp)。

使用 8 张图片的最佳方式是什么？绝对定位的div？还是我应该将它们组合成一个这样的痛苦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:09:24.347

将图像合二为一有什么难的？它还有许多其他优点，例如减少客户端需要发出的 HTTP 请求的数量。

另一种方法是使用 CSS3 的多背景图像功能，您可以将每个图像设置为框中的一个图层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:10:14.900

Eric Myer 使用了一种技术（只是为了解释技术）图像是一个小圆圈。然后，这是四个独立 div 中的背景图形，每个 abs 都位于包含 div 的角上，具有相对位置。每一个的背景位置都发生了变化，直线使用了一个规则的边框，实际上得到了圆角。圆圈必须填充白色或您使用的任何 bckgrnd 颜色。

这样一来，就可以展开了。如果发生变化，您仍然需要扩展高度，对吗？

我会为顶部和底部制作一个，第三个在 Y 上重复作为中间，这样如果添加内容，你的盒子就会扩大。高度也就是。

# java - 通过删除重复代码有效地插入数据库

> ID：15890581
> 
> 赞同：0
> 
> 时间：2013-04-08T23:06:10.807
> 
> 标签：java, cassandra, performance

我`Cassandra database`最近开始工作了。我试图将一些数据插入到`Column Family`我创建的一个中。

下面是我试图插入 Cassandra 数据库的代码。

在我的情况下，我`20 columns`在我的列族中，所以这意味着我需要在下面添加

`mutator.newColumn("Column Name", "Column Value");`

**在我下面的代码中出现了20 次**，这对我来说很丑陋。有什么办法，我可以通过使用反射或其他方式来简化下面的方法，这样如果我有超过 20 列，我不应该继续在下面的代码中添加额外的行。

```
for (int userId = id; userId < id + noOfTasks; userId++) {

    Mutator mutator = Pelops.createMutator(thrift_connection_pool);

    mutator.writeColumns(column_family, String.valueOf(userId),
            mutator.newColumnList(
            mutator.newColumn("a_account", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_advertising", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_avg_selling_price_main_cats", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_cat_and_keyword_rules", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_csa_categories_purchased", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_customer_service", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_demographic", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_favorite_searches", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_favorite_sellers", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}"), 
            mutator.newColumn("a_financial", "{\"lv\":[{\"v\":{\"regSiteId\":null,\"userState\":null,\"userId\":" + userId + "},\"cn\":1}],\"lmd\":20130206211109}")
            mutator.newColumn(some othe column, its value)
            .....
            .....
            .....
            ));

    mutator.execute(ConsistencyLevel.ONE);
} 
```

简化上述方法的任何帮助将对我有很大帮助。我可以在这里使用反射吗？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T04:18:45.387

您可以预定义您的 ColumnList。假设您在名为“map”的变量中传入名称的映射和值的字符串版本。您的代码可能如下所示：

```
Mutator mutator = Pelops.createMutator(thrift_connection_pool);
ArrayList<Column> columnList = new ArrayList<Column>();
for (Map.Entry<String, String> entry : map.entrySet()) {
    columnList.add(mutator.newColumn(entry.getKey(), entry.getValue()));
}
mutator.writeColumns(column_family, String.valueOf(userId), columnList); 
```

# python - trying to get return info from one function to another

> ID：15890585
> 
> 赞同：0
> 
> 时间：2013-04-08T23:06:23.347
> 
> 标签：python, function, return

I'm trying to use functions (something that I am inherently bad at apparentlyXD) and am trying to get the return statement info from the first and then use it in the second. Both are for rolling dice, so the first function is to have the first set returned, which is to be then used in the second function to give the user the option to reroll. What am I doing wrong in this implementation that it's not recognizing the original dieset list?

```
def rollDie():
   die1 = 2
   die2 = 2
   die3 = 2
   die4 = 4
   die5 = 5

   dieset = [die1,die2,die3,die4,die5]
   print(dieset)

   return dieset

def reRoll1():

rollDie() 
reroll1 = input("Would you like to reroll? Yes or No: ")
if reroll1 == "no":
    dieset = [die1,die2,die3,die4,die5]
else:
    count = 0
    times = int(input("How many die would you like to reroll? "))
    while count < times:
        whichreroll = input("Reroll die: ")
        if whichreroll == "1":
            die1 = random.randint(1,6)
        else:
            die1 
        if whichreroll == "2":
            die2 = random.randint(1,6)
        else:
            die2
        if whichreroll == "3":
            die3 = random.randint(1,6)
        else:
            die3
        if whichreroll == "4":
            die4 = random.randint(1,6)
        else:
            die4
        if whichreroll == "5":
            die5 = random.randint(1,6)
        else:
            die5
        dieset = [die1,die2,die3,die4,die5]
        count += 1
        print(dieset)   

        return dieset   
reRoll1() 
```

It's telling me "local variable 'die1' referenced before assignment" but rollDie() comes first. If anyone could explain this to me it would be greatly appreciated:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T01:08:51.543

您没有获得所需的行为，因为,`die1`不是全局变量，但您将它们视为全局变量。`die2``...`

换句话说， inside与`die1`within`reRoll1()`不同。`die1``rollDie()`

为了得到你想要的，你应该使用返回值，或者通过在与你调用的地方相同的缩进级别上编写定义来全局初始化变量`reRoll1()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:18:06.863

为了能够引用从 rollDie() 返回的数据，您需要将其分配给一个变量，即：

```
dieset = rollDie() 
```

但是，您也有一个问题：

```
if reroll1 == 'no':
    dieset = [die1, die2, die3, die4, die5] 
```

在这里，您引用了变量 die1、die2... 但尚未为它们分配任何值。

作为一种解决方法，您可以为这些变量分配一个任意值，例如 0：

```
dieset = [0, 0, 0, 0, 0] 
```

但是...然后在您的条件中，您引用变量 die1, die2 ...; 实际上还没有分配。所以你可以忘记所有关于变量 dieset 的事情，并直接分配 die1, die2...：

```
die1, die2, die3, die4, die5 = rollDie() if reroll1 == 'yes' else [0, 0, 0, 0, 0] 
```

这样，您就可以`die1`在以下条件中简单地引用值等。

希望这可以帮助

# c# - 一个解决方案中的多个 exe 文件，都引用一个公共类

> ID：15890588
> 
> 赞同：4
> 
> 时间：2013-04-08T23:06:28.653
> 
> 标签：c#, .net, visual-studio, dll

我有越来越大的 ac# 控制台项目（vs2012）。目前我一个接一个地调用多个“方法”。当我添加更多方法时，我希望能够将它们分解为多个可执行文件，作为计划的应用程序运行，但仍然能够引用（并使用 tortoise SVN 更改）一个公共类的规则，它们都将参考。我是否必须创建一个 dll 来完成此操作，还是有更简单的方法？对不起，我对这一切都很陌生。我发现了类似的问题，但我要么不理解它们，要么它们不是我想要的。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-08T23:08:55.867

是的，您需要构建一个 DLL 并从需要存储在那里的代码的任何项目中引用它。
只需将一个新的库项目添加到您的解决方案，创建一个公共类并插入应该从其他项目调用的方法

单击菜单文件并选择添加项目 ![在此处输入图像描述](https://i.stack.imgur.com/0busA.png)

然后转到您的解决方案资源管理器窗口，单击控制台应用程序并右键单击引用
![在此处输入图像描述](https://i.stack.imgur.com/F86tQ.png)

并从解决方案文件夹中选择您的类库的项目 ![在此处输入图像描述](https://i.stack.imgur.com/rdR6H.png)

现在转到预定义的 Class1 并添加以下代码

```
namespace ConsoleApplication1
{
    // Class that contains methods and data to be used/shared by various applications
    public class Class1
    {
        public Class1()
        { }

        public void Show(string message)
        {
            Console.WriteLine(message);
        }
    }
} 
```

并在您的 ConsoleApplication1 中添加以下代码

```
namespace ConsoleApplication1
{
    class Program
    {
        // A sample console application that uses the library project....
        static void Main(string[] args)
        {
            Class1 c=new Class1();
            c.Show("Hello World");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:19:30.047

> 我是否必须创建一个 dll 来完成此操作，还是有更简单的方法？

如果你想实现*共享逻辑*和模块化，那么答案是否定的，没有更简单的方法，你应该使用 VS 中的类库项目模板创建程序集 (DLL)，编写你的`public`类，构建它并从你的 EXE 项目中引用它。

我建议您同时使用 Executables 和 Class Library 项目的解决方案，这样您就可以*通过 Project*而不是*Assembly*引用它来享受与 Class Library 的可维护性和良好同步。

# c - Linux kernel module copy_to_user not working

> ID：15890589
> 
> 赞同：0
> 
> 时间：2013-04-08T23:06:34.840
> 
> 标签：c, linux, kernel

I am attepting to write a Linux Kernel Module for the Raspberry Pi. All is good, except that when I try to use either copy_to_user, or put_user, it always returns a value of "34336" if I print it as an llu, and if I print it as a character, it is nothing.

The interesting thing is that it was working, I made some changes, it stopped working, I reverted back to the working version, and it no longer works.

Code from module:

```
 ssize_t st_read(struct file *filp, char *buf, size_t count, loff_t *f_pos)
    {
            char memory_buffer = 'b';
            /* Transferring data to user space */
            copy_to_user(buf,memory_buffer,1);

            /* Changing reading position as best suits */
            if (*f_pos == 0) {
                    *f_pos+=1;
                    return 1;
            } else {
                    return 0;
            }
    } 
```

Code reading value:

```
 fd = open("/dev/systimer", O_RDONLY);

    // check for errors
    if(fd < 0) {
            perror("open(O_RDONLY)");
            return errno;
    } else
            close(fd);

    read(fd, &buf, 1);
    printf("Buffer: %llu\n", buf);
    printf("Buffer2: %c\n", buf); 
```

Output is:

```
 Buffer: 34336
    Buffer2: 
```

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-30T10:43:38.257

您在阅读之前已关闭。您应该始终检查的返回值`read()`

```
// check for errors
if(fd < 0) {
        perror("open(O_RDONLY)");
        return errno; 
} else
        close(fd);   // <-- you are closing the fd here

read(fd, &buf, 1);   // <-- fd is closed 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-08T23:40:04.227

你有没有尝试过？

```
copy_to_user(buf, &memory_buffer, 1); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-10-30T10:31:33.433

您可以尝试以下代码而不是 copy_to_user

```
 sprintf(buf, "%u\n", memory_buffer); 
```

-帕尼

# jquery-mobile - Jquery Mobile 中的导航菜单

> ID：15890599
> 
> 赞同：0
> 
> 时间：2013-04-08T23:07:16.247
> 
> 标签：jquery-mobile

我是 jquery mobile 的新手，但我想构建一个带有特定动画（无页面更改）的垂直导航面板。

一个很好的例子是这里（我不想要 sencha touch，我需要用 jquery mobile 来做这个）：[http ://dev.sencha.com/deploy/touch/examples/production/kitchensink/index.html](http://dev.sencha.com/deploy/touch/examples/production/kitchensink/index.html)

例如，如果您选择“用户界面”，则只有菜单正在更新（并且会出现一个返回按钮......）另一个很好的例子是 IO，作为保管箱 Ipad 应用程序（参见[http://www.youtube.com/watch ?v=qeqw5OroHzY](http://www.youtube.com/watch?v=qeqw5OroHzY) )

我怎么能用 jquery mobile 做到这一点？我看到了面板，1.3 的新功能，但它并不是一回事......

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:14:49.063

试试这个：[jQueryUI 的 .menu](http://jqueryui.com/menu/)

除此之外，这只是一种幻想`<aside>`

# c# - 按日期搜索 Gridview，但日历控件选择器（即 DateTime）包括日期和时间，例如：2013-01-01 00:00:00.000

> ID：15890605
> 
> 赞同：0
> 
> 时间：2013-04-08T23:07:52.913
> 
> 标签：c#, asp.net, sql, vb.net, datetime

我有一个应该根据选定日期填充的 GridView，所以我使用了**`Calendar control`**.

**问题**

*   **由于日历控件的选定日期是 DateTime，不幸的是，选定的日期`Calendar`似乎是格式**：`dd-MM-yyy`
    *例如*2013-02-15
*   **而`date field`数据库中的 具有类型`datetime`含义**：`dd-MM-yyyy HH:mm:SS.ms`
    *示例*2013-02-15 09:02:03.253

因此不会有任何结果，因为 Calendar 控件和 Database 字段属于不同的类型。

**我试过的**

```
SqlDataSource1.SelectCommand = "Select * from table1 where start_date Like '% " & calendar1.SelectedDate.Date & " %' " 
```

正如你所看到的，我在后面的代码中使用了 sqldatasource，并且我使用了`Like`但是即使没有使用`Like`任何结果显示**，因为数据库不仅有日期，还有时间**。

我也在考虑更改 sql 查询本身，准确地说是字段`start_date`，以省略时间 (HH:mm:SS.ms) 但可以这样做吗？

## 编辑：

即使日历控件的选定日期和数据库中的字段都是 DateTime，搜索也不会起作用，因为使用日历控件搜索时，它的查询将是日期和时间示例`2013-01-01 00:00:00.000`，而在数据库中时间并不总是 00:00 :00 因此需要Between作为下面的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:14:47.523

`Calendar.SelectedDate`是`DateTime`。所以只需更改`calendar1.SelectedDate.Date`为`calendar1.SelectedDate`.

证明：http: [//msdn.microsoft.com/ru-ru/library/system.web.ui.webcontrols.calendar.selecteddate.aspx](http://msdn.microsoft.com/ru-ru/library/system.web.ui.webcontrols.calendar.selecteddate.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:26:21.427

您可以使用 Date 字段从数据库中提取记录。我不认为在日期上使用 LIKE 是一个好主意。指定 From 和 To 日期范围以获得一天的数据：

```
SqlDataSource1.SelectCommand = "Select * from table1 where start_date >" & calendar1.SelectedDate.Date & " AND start_date < " & calendar1.SelectedDate.Date.AddDays(1) 
```

或使用 BETWEEN 运算符：

```
SqlDataSource1.SelectCommand = "Select * from table1 where start_date between " & calendar1.SelectedDate.Date & " AND " & calendar1.SelectedDate.Date.AddDays(1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T23:57:25.263

格式化仅在您显示数据时才重要。基本上，日期是整数，日期时间是浮点数。

从您的日期选择器中选择的任何内容创建一个 .net DateTime 对象。然后将其转换为您在查询中使用的查询参数。

# python - Python - 继承

> ID：15890606
> 
> 赞同：0
> 
> 时间：2013-04-08T23:08:01.180
> 
> 标签：python, inheritance

我不了解任何有关如何使继承工作的在线文档。

我这里有这个：

```
import maya.cmds as cmds

class RigLegs():
    def __init__(self, *args):
        self.rigLegs()

    def rigLegs(self):
        self.items["side"] = "left"
        self.lIK = cmds.duplicate(self.lJoints["hip"], n = self.getName("hip_IK"))
        for i in self.lIK:
            newName = i[0].replace("_JNT", "_IK")
            cmds.rename(i, newName) 
```

但它抱怨没有 self.items - 我必须从另一个太大而无法在此处发布的类继承它。谁能帮我弄清楚该怎么做？我在网上研究过，没有任何意义。

另一个类完全在不同的文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:11:37.213

要从另一个类继承：

```
class RigLegs(base_class_name): 
```

一个例子：

```
class base_class():
    items = [1,2,3]

class pie(base_class):
    def __init__(self):
        print (self.items)

instance = pie() 
```

您可以在[Python 文档中阅读更多内容](http://docs.python.org/2/tutorial/classes.html#inheritance)

* * *

进口：

文件（apples.py）

```
class base():
    items = [1,3,4] 
```

文件（main_file.py）

```
import apples

class pie(apples.base):
    def __init__(self):
        self.pies()

    def pies(self):
        print(self.items)

instance =  pie() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:11:29.530

在类声明:`class RigLegs()`中，您应该包含所有要继承的类，例如：

```
class RigLegs(Ancestor1, Ancestor2):
    # Your code chere. 
```

不要忘记，您仍然需要调用祖先的初始化逻辑。

```
 def __init__(self):
        super(RigLegs, self).__init__() 
```

# c - C：Roguelike 地图很诡异

> ID：15890607
> 
> 赞同：1
> 
> 时间：2013-04-08T23:08:03.167
> 
> 标签：c, arrays, roguelike

我正在用 C 语言制作 Roguelike 游戏，但我无法让我的角色按照我想要的方式移动。我在点 (x, y) 处创建了一个带有字符的 2D 字符数组，绘制了数组，并更改了 x 和 y 值，并在输入要前进的方向时重新绘制了数组（有点像 Zork，但有图形）。但这不符合我的计划。该代码将解释更多：

```
/* game.h (header file for globals) */

#define GAME_H

char character = '@';
//char monster = '&';

int x = 2;
int y = 2;

/* my beginning floor
(will not be implemented, just for testing movement) */
char floor[10][6] = { /* 219 = filled block, 32 = space */
        219, 219, 219, 219, 219, 219, 219, 219, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219, 219, 219, 219, 219, 219, 219, 219, 219, '\n'};

/* game.c (main file) */
#include <stdio.h>
#include "game.h"

int main(void){
        system("cls");
        floor[x][y] = character;
        printf("%s", floor);
        char move;

        redo:

        printf("\nTravel which way?\n");
        printf("a = left\ns = down\nd = up\nf = right\n\n>");
        scanf("%s", &move);

        /*
        array oftentimes gets desroyed because the newlines are
        being overwritten by the assignments.
        the if statements should have prevented this.
        why didn't they?
        */

        if (move == 'a'){ /* LEFT */
                if (x < 1){
                        x = 1;}
                x--;
                floor[x][y] = character;
                floor[x+1][y] = ' ';
                system("cls");
                printf("%s", floor);
                goto redo;

        } else if (move == 's'){ /* DOWN (works, but goes right. Sometimes clones itself) */
                if (y > 3){
                        y = 3;} /*bounds may be wrong*/
                y++;
                floor[x][y] = character;
                floor[x][y-1] = ' ';
                system("cls");
                printf("%s", floor);
                goto redo;

        } else if (move == 'd'){ /* UP */
                if (y < 1){
                        y = 1;}
                y--;
                floor[x][y] = character;
                floor[x][y+1] = ' ';
                system("cls");
                printf("%s", floor);
                goto redo;

        } else if (move == 'f'){ /* RIGHT */
                if (x > 7){
                        x = 7;}
                x++;
                floor[x][y] = character;
                floor[x-1][y] = ' ';
                system("cls");
                printf("%s", floor);
                goto redo;}
        else {
                goto done;
        }

        done:
        return 0;
} 
```

谁能告诉我我做错了什么？

**注意：**此地图设置只是一个草稿。一旦机制完成，我将完全不同地做这件事，但我将计划以几乎相同的方式沿阵列移动角色，所以我宁愿在这个特定设置方面获得帮助，而不是关于如何获得建议做得更好/不同。但是，显示更好实现的相关答案和源代码仍然有用和赞赏，因为我自己可能一开始就完全错误，因为这是我的第一个 Roguelike 游戏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T00:06:52.343

你的地板声明对我来说看起来有点奇怪尝试做这样的事情：

```
//c arrays are generally array[rows][columns]
int rows = 6, cols = 10;
char floor[rows][cols] = {
    {219, 219, 219, 219, 219, 219, 219, 219, 219, '\n'},
    {219,  32,  32,  32,  32,  32,  32,  32, 219, '\n'},
    {219,  32,  32,  32,  32,  32,  32,  32, 219, '\n'},
    {219,  32,  32,  32,  32,  32,  32,  32, 219, '\n'},
    {219, 219, 219, 219, 219, 219, 219, 219, 219, '\n'}}; 
```

[此处为 http://ideone.com/O7UG8g](http://ideone.com/O7UG8g)示例。我在该示例中更改了 219->35，因为我认为在该站点上打印扩展 ascii 不起作用。

另外我认为绑定检查应该是这样的：

```
//move left (go one column left)
//if current position is array[curRow][curCol]
//assuming array[0][0] is top left of map
//check if left is a wall
if((curCol - 1) == charForAWall)
   return;
else
   curCol--; 
```

右边是 +1 列，向上 -1 行，向下 +1 行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T00:18:44.423

鉴于此代码：

```
char character = '@'; 
int x = 2;
int y = 2;

char floor[10][6] = { /* 219 = filled block, 32 = space */
        219, 219, 219, 219, 219, 219, 219, 219, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219,  32,  32,  32,  32,  32,  32,  32, 219, '\n',
        219, 219, 219, 219, 219, 219, 219, 219, 219, '\n'};

/* game.c (main file) */
#include <stdio.h>
#include "game.h"

int main(void){
        system("cls");
        floor[x][y] = character;
        printf("%s", floor); /* print the map and character */ 
```

有几个问题。 ~~首先，您的数组不是空终止的；那样打印是不安全的。~~ 该数组中只有 5 * 10 = 50 个字符，所以它毕竟是空终止的。直到后来我才注意到计算错误。如果您有第六行数据，则必须使用：

```
 printf("%.*s", (int)sizeof(floor), floor); 
```

另一个问题是您误解了数组。它是 10 行 6 个字符，而不是 6 行 10 个字符。

```
char floor[10][6] =
{ /* 219 = filled block, 32 = space */
        { 219,  219, 219,  219, 219,  219, },
        { 219,  219, 219, '\n', 219,   32, },
        {  32,   32,  32,   32,  32,   32, },
        { 219, '\n', 219,   32,  32,   32, },
        {  32,   32,  32,   32, 219, '\n', },
        { 219,   32,  32,   32,  32,   32, },
        {  32,   32, 219, '\n', 219,  219, },
        { 219,  219, 219,  219, 219,  219, },
        { 219, '\n' },
}; 
```

而且，实际上，您的数据也很短几个字符。但是，由于您打印它的方式，它看起来不错，但是如果您进行了完全括号初始化，您会发现如果您将括号放在原始布局中的每一行周围，就会出现问题。

我很想在初始化中使用名称而不是数字来表示字符：

```
enum { WALL = 219, OPEN = 32, ENDL = '\n' }; 
```

这些都是统一的 4 个字母，在初始化程序中进行更系统的布局。

请注意，当您将字符放置在 2,2 时，您正在修改数组，如下所示：

```
char floor[10][6] =
{ /* 219 = filled block, 32 = space */
        { 219,  219, 219,  219, 219,  219, },
        { 219,  219, 219, '\n', 219,   32, },
        {  32,   32, '@',   32,  32,   32, },  // Change here!
        { 219, '\n', 219,   32,  32,   32, },
        {  32,   32,  32,   32, 219, '\n', },
        { 219,   32,  32,   32,  32,   32, },
        {  32,   32, 219, '\n', 219,  219, },
        { 219,  219, 219,  219, 219,  219, },
        { 219, '\n' },
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T00:22:10.937

处理移动的代码没有任何问题，看起来问题与您分配数组的方式有关。对于初学者，您只有 5 列，而不是 6 列。我将元素分组如下：

```
char floor[10][5] = {
    {219,219,219,219,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,32,32,32,219},
    {219,219,219,219,219},
    {'\n','\n','\n','\n','\n'}
}; 
```

然后我写了另一个函数来打印数组（替换 printf 语句，它将不再像这样工作），如下所示：

```
int printArray() {
    int i, j;

    for(i=0; i<5; i++) {
        for(j=0; j<10; j++) {
            printf("%c", floor[j][i]);
        }
    }
} 
```

然后其余的代码可以正常工作。

# php - 图像上的预匹配

> ID：15890608
> 
> 赞同：1
> 
> 时间：2013-04-08T23:08:06.163
> 
> 标签：php, preg-match

我想知道，我有一个项目，其中一个人将链接复制到表单中。现在这个链接必须是一个图像，大多数用户说的是永远不要相信用户输入。

我将其缩小到 preg_match() 可以检查链接上是否有可以显示在我的网站上的图像。

我的问题基本上是你如何确保在检查表单时，它是一个图像，而不是像扩展名末尾带有 .jpg 的病毒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T10:45:27.490

使用[finfo_file](http://www.php.net/manual/en/function.finfo-file.php)获取文件的 mime 类型。

如果 mime 类型类似于`image/gif`or `image/png`...，则该文件是图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:20:17.193

```
$url = 'http://foo.bar.com/path.jpg?arg=value#anchor';
if (preg_match("/\.(jpg|png)$/",parse_url($url, PHP_URL_PATH)){
    // YOUR CODE HERE
} 
```

这匹配以 .jpg 或 .png.... 结尾的文件名。只需在括号中添加您想要允许的扩展名（由 | 符号分隔）

# html - 丰富的片段重复 - 有害吗？

> ID：15890615
> 
> 赞同：-1
> 
> 时间：2013-04-08T23:08:35.003
> 
> 标签：html, css, seo, rich-snippets, web-traffic

使用丰富的片段重复是否会影响 Google 等搜索引擎的 SEO？我为客户网站实施它，他们有 2 个电话号码。使用电话片段两次会造成任何伤害吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:18:31.820

最好坚持[http://schema.org](http://schema.org)上的模式。[组织架构](http://schema.org/Organization)只需要一个电话号码，但您可以添加多个ContactPoint[类型](http://schema.org/ContactPoint)来容纳额外的电话号码，尤其是在每个号码都有特定用途的情况下

# javascript - 将字段中的数据存储为服务器上的 txt 文件（javascript）

> ID：15890617
> 
> 赞同：-1
> 
> 时间：2013-04-08T23:08:39.113
> 
> 标签：javascript, ajax, jquery, unix

我试图从我的 javascript 表单将纯文本文件上传到服务器。当您点击提交时，我需要在我的服务器上存储一个文本文件，以便我的翻译程序可以读取该文件。请查看我的项目，这将是有意义的 [链接到我的项目](http://lknbt.net/melt/project_77571/ "我的项目融化")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T03:07:14.393

您不能只提交包含文本值的表单并在服务器上生成文本文件吗？

# android - 为什么我不能在 TextView 上放“x⁵”，但可以放“x⁴”？

> ID：15890618
> 
> 赞同：1
> 
> 时间：2013-04-08T23:07:30.030
> 
> 标签：android, textview

为什么我不能在 TextView 上放“x⁵”，但可以放“x⁴”？

```
<string name="secante_instru">Enter the following polynomial coefficients \n Ax⁵ + Bx⁴ + Cx³ + Dx² + Ex + F</string> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T06:14:13.593

这有帮助吗？

[http://en.wikipedia.org/wiki/Unicode_subscripts_and_superscripts](http://en.wikipedia.org/wiki/Unicode_subscripts_and_superscripts)

你可以直接使用unicode。

例子：

```
\u2075 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T06:17:37.923

5 - 存在，但不可见。它只是占用空间。可能是字体的错误。尝试使用另一个。[如何设置自定义字体](http://mobile.tutsplus.com/tutorials/android/customize-android-fonts/)希望对您有所帮助。

**更新**

试试这个：

```
yourTextView.setText(Html.fromHtml("x<sup>5</sup>")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T06:39:37.720

您是否尝试过用双引号括起来。

# css - 元素在孩子时失去“悬停”状态的选项悬停在我的（目前是私人的）网站上有一个大型菜单。在其中一个下拉列表中是一个 <select> 元素，其中包含足够的选项，当它们展开时，列表会位于大型下拉列表的底部下方。在 FF 和 Chrome 中，下拉菜单保持展开状态。在 IE 中，虽然下拉列表不再认为它被悬停在上面，并隐藏在这里查看效果：http://jsfiddle.net/EHSF8/。菜单用 CSS 显示和隐藏（所以我认为没有事件处理）。我必须支持到IE8。如果绝对必要，我可以使用

> ID：15890619
> 
> 赞同：1
> 
> 时间：2013-04-08T23:08:40.257
> 
> 标签：css, internet-explorer, megamenu

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:12:35.377

是浏览器的`<select>`一种控制类型，这意味着它的组件不一定遵循 DOM 结构。即使从技术上讲，您在 上`#tohover`，扩展后`<select>`也不会将其传达给浏览器。

这不仅仅是 Internet Explorer 的情况。我正在检查 Chrome，它是一样的，当我单击`<select>`并继续悬停选项时，`hover`状态被删除。

### 解决方案

`UL`您可以考虑用and替换整个内容，`LI`然后将鼠标悬停在 CSS 菜单上，效果很好。

### HTML

```
<ul class="nav">
    <li>
        <a href="#">Menu 1</a>
        <ul>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Menu 2</a>
        <ul>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
        </ul>
    </li>
    <li>
        <a href="#">Menu 3</a>
        <ul>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
            <li><a href="#">Sub Menu Item</a></li>
        </ul>
    </li>
</ul> 
```

### CSS

```
* {font-family: "Segoe UI", Tahoma;}
ul.nav {border-bottom: 1px solid #999;}
ul.nav li a {display: block; text-decoration: none; color: #333; padding: 5px; border: 1px solid #fff;}
ul.nav > li:hover {border: 1px solid #666; border-bottom: 1px solid #fff;}
ul.nav li a:hover {background: #ccc; border: 1px solid #999;}
ul.nav > li {display: inline-block; position: relative; border: 1px solid #fff;}
ul.nav > li ul {display: none; position: absolute; left: -1px; width: 150px; border: 1px solid #666; border-top-color: #fff; margin-top: 1px;}
ul.nav > li:hover ul {display: block;}
ul.nav > li ul li {display: block;} /* Vertical Menu */
ul.nav > li ul li {display: inline-block;} /* Horizontal Menu */ 
```

### 小提琴： http:
[//jsfiddle.net/vMuxA/](http://jsfiddle.net/vMuxA/)（垂直菜单）
[http://jsfiddle.net/vMuxA/1/](http://jsfiddle.net/vMuxA/1/)（水平菜单）

# php - 带有变量的phpmailer正文

> ID：15890627
> 
> 赞同：3
> 
> 时间：2013-04-08T23:08:56.100
> 
> 标签：php

我正在尝试实现“忘记密码” php 脚本，它生成新密码并简单地向用户发送电子邮件。在我尝试将新密码发送给用户之前，一切都很好。我不能在电子邮件正文中包含此变量。我收到一条错误消息：

```
$mail->body = "The new password is "$newpass"." 
```

在我的浏览器中我得到

```
Parse error: syntax error, unexpected '$newpass' (T_VARIABLE) 
```

我知道我错过了一些东西，但真的不知道是什么......任何建议都会受到欢迎

问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-08T23:10:42.780

像这样格式化它：

```
$mail->body = "The new password is " . $newpass . "."; 
```

您还可以使用：

```
$mail->body = "The new password is {$newpass}."; 
```

PHP 在[这里](http://php.net/manual/en/language.types.string.php)的手册中有大量方便的字符串技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:10:40.947

您需要将变量连接到字符串，例如：

```
$mail->body = "The new password is " . $newpass . "."; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T23:10:47.687

那应该是：

```
$mail->body = "The new password is " . $newpass . "."; 
```

或者

```
$mail->body = "The new password is $newpass."; 
```

# windows - 在 MFC 应用程序中捕获 Windows 8 平板电脑上的 shift 键状态

> ID：15890630
> 
> 赞同：2
> 
> 时间：2013-04-08T23:09:13.483
> 
> 标签：windows, windows-8, mfc

我们基于 MFC 的 Windows 应用程序具有取决于 shift 键状态的功能。Shift 公开了高级用户菜单命令，并且 Shift 拖动具有与正常拖动不同的行为。我正在探索我们支持 Windows 8 平板电脑的选项，似乎没有直接的方法来检测 Windows 8 软键盘 shift 键的状态。

使用`GetAsyncKeyState(VK_SHIFT)`（我们当前的方法）不会检测到这个键。

尝试检查所有传入的键盘消息，我发现：

*   Shift 键的单次隔离敲击不会产生键盘事件
*   双击 shift 键会产生大写锁定键事件，与正常的大写锁定键事件无法区分
*   Shift 键的单次轻击，然后是另一个击键（例如，'q' 键）会产生一个 shift 键事件、击键和一个 shift 键（向上？）事件。

还有其他方法可以尝试检测软键盘 shift 键的状态吗？有没有其他人在 Windows 8 平板电脑软键盘上成功检测到此键盘的状态。

您插入这些设备的外接键盘都有正常的 shift 键。该问题是特定于软键盘的。

# treeset - Java：使用带有类类型的 TreeSet

> ID：15890636
> 
> 赞同：0
> 
> 时间：2013-04-08T23:09:47.513
> 
> 标签：treeset

我在使用 TreeSet 对我的 HashMap 进行排序时遇到问题。以下是我拥有的代码：

```
private static HashMap<OddMove, Integer> sortHashMap(
        HashMap<OddMove, Integer> hm) {
    Map<OddMove, Integer> tempMap = new HashMap<OddMove, Integer>();
    for (OddMove wsState : hm.keySet()) {
        tempMap.put(wsState, hm.get(wsState));
    }

    List<OddMove> mapKeys = new ArrayList<OddMove>(tempMap.keySet());
    List<Integer> mapValues = new ArrayList<Integer>(tempMap.values());
    HashMap<OddMove, Integer> sortedMap = new LinkedHashMap<OddMove, Integer>();
    TreeSet<OddMove> sortedSet = new TreeSet<OddMove>(mapKeys);
    Object[] sortedArray = sortedSet.toArray();
    int size = sortedArray.length;
    for (int i = 0; i < size; i++) {
        sortedMap.put(mapKeys.get(mapValues.indexOf(sortedArray[i])),
                (Integer) sortedArray[i]);
    }
    return sortedMap;
} 
```

以下是我得到的错误：

```
ABORTING: Exception in odd.UEPlayer3.choseMove()
java.lang.ClassCastException: odd.OddMove cannot be cast to java.lang.Comparable
at java.util.TreeMap.compare(TreeMap.java:1188)
at java.util.TreeMap.put(TreeMap.java:531)
at java.util.TreeSet.add(TreeSet.java:255)
at java.util.AbstractCollection.addAll(AbstractCollection.java:334)
at java.util.TreeSet.addAll(TreeSet.java:312)
at java.util.TreeSet.<init>(TreeSet.java:160)
at odd.UEPlayer3.sortHashMap(UEPlayer3.java:196)
at odd.UEPlayer3.chooseMove(UEPlayer3.java:101)
at boardgame.Client.playMove(Client.java:109)
at boardgame.Client.processMessage(Client.java:86)
at boardgame.Client.clientLoop(Client.java:177)
at boardgame.Client.run(Client.java:73)
at java.lang.Thread.run(Thread.java:722) 
```

非常感谢一些帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:15:08.400

我猜 OddMove 是您编写的自定义类。如果是这种情况，您需要更新它以实现`Comparable`接口。

# c++ - 如何从 swf 或 abc 文件生成 swc

> ID：15890644
> 
> 赞同：0
> 
> 时间：2013-04-08T23:10:37.980
> 
> 标签：c++, c, cygwin, alchemy

我如何从 swf 或 abs 生成 swc 文件，这些文件是使用 avm2 程序集 adobe alchemy 编译器制作的。

此代码生成 swf 和 abc 文件：

```
java -Xms16M -Xmx4096M -jar D:/alchemy/bin/asc.jar -AS3 -strict \
-导入 D:/alchemy/flashlibs/global.abc \
-import D:/alchemy/flashlibs/playerglobal.abc \
-config炼金术::调试器=假\
-config Alchemy::NoDebugger=true -config Alchemy::Shell=false \
-config Alchemy::NoShell=true -config Alchemy::LogLevel=0 \
-config Alchemy::Vector=true -config Alchemy::NoVector=false \
-config Alchemy::SetjmpAbuse=false \
-swf cmodule.openttd.ConSprite,800,600,60 xxx.as

```

有人知道如何使用此代码中的任何选项来制作 swc。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T15:00:49.067

您可以通过`-swc`而不是`-swf`. 顺便说一句，你真的应该从 Alchemy 转到[FlasCC](http://gaming.adobe.com/technologies/flascc/)。

# python - 之间的区别 . 和自我。在 python 类中

> ID：15890651
> 
> 赞同：2
> 
> 时间：2013-04-08T23:11:01.597
> 
> 标签：python, class

我想知道 Foo.var= 用户输入和 self.var= 用户输入在 2 个类中有什么区别。

```
class foo():
    var=None

    def __init__(self,userinput):
        foo.var=userinput

class bar():
    var=None

    def __init__(self,userinput):
        self.var=userinput 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:20:23.690

`foo`指*类*，`self`指*对象*。

类成员是类的属性（因此在该类的所有对象之间共享），而实例成员是特定对象的属性，因此对实例成员的更改仅影响给定对象。

当您对一个对象进行操作时，它拥有的成员是*类*成员和*实例*成员的合并。当定义了两个同名成员时，实例成员具有优先权。

因此：

*   `bar`设置实例变量；该更改仅对当前实例有效，因此如果您这样做：

    ```
    b=bar(10)
    c=bar(20) 
    ```

    你会看到那个`c.var`is`20`和`b.var`is `10`; 这里没有什么奇怪的；

*   `foo`设置一个类变量，它对所有实例都是通用的；所以，如果你这样做：

    ```
    f=foo(10)
    g=foo(20) 
    ```

    你会看到`f.var`和`g.var`will be `20`，因为它们实际上都引用了`foo.var`，最后`20`在`g`的构造函数中设置为 ；

*   另一方面，实例变量隐藏类变量；所以，如果你这样做

    ```
    f=foo(10)
    g=foo(20)
    f.var=30 
    ```

    你会有`g.var==foo.var==20`, 但是`f.var==30`, 因为 now`f.var`指的是*实例变量*f.var; *但是*，如果你这样做

    ```
    del f.var 
    ```

    现在实例（`f`'s）属性`var`不再存在，因此`f.var`再次引用*类属性* `var`（因此`f.var==g.var==foo.var==20`）。

* * *

长话短说：通常你会想要使用`self.var`（即实例成员）；`classname.var`仅用于在给定类的所有实例之间共享内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:15:45.820

我想指出一个现有的帖子，它完美地解释了我认为的差异。

[Python：类和实例属性之间的区别](https://stackoverflow.com/questions/207000/python-difference-between-class-and-instance-attributes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:15:49.353

是的，

在第一个实例中，您正在为所有实例设置变量`foo`this 是因为它是一个`class`变量。

在第二种情况下，您只是为该实例设置变量`foo`。

例如：

```
class pie():
    def __init__(self, j):
        pie.var = "pies" + str(j)
        print (self.var)

    def __str__(self):
        return self.var

a = pie(1)
b = pie(2)

print (a)
print (b) 
```

# javascript - 如何在 javascript 中计算 ARM 上的 APR

> ID：15890652
> 
> 赞同：1
> 
> 时间：2013-04-08T23:11:08.717
> 
> 标签：javascript, math, finance

我正在尝试计算 ARM 的 APR（在 javascript 中）并且已经卡住并且正在跳出可能能够引导我朝着正确方向前进的人。这是我到目前为止所尝试的：

我得到了在贷款期限内支付的平均利率。例如：如果贷款前 24 笔付款的利率为 4%，那么最后 336 笔付款的利率提高到 6%。

```
AverageOverallRate = ( (4/12 * 24 ) +  ( 6/12 * 336 ) / 360 ) * 12 
```

这将使我的平均利率为 5.866%

然后我尝试使用这个“平均利率”并使用这个公式找到有效的 APR（考虑到复利）。

```
Math.pow( 1 + ( averageOverallRate / 12 ), 12) – 1 
```

或者我尝试通过首先解决以 AverageOverallRate 借入本金 + 发起费用所产生的付款来计算有效 APR（考虑发起费用）。然后，一旦我知道该付款将是多少，我就会使用猜测检查方法来评估相同付款金额但原始本金金额（不含费用）的费率。（我使用这里解释的方法[http://www.efunda.com/formulae/finance/apr_calculator.cfm](http://www.efunda.com/formulae/finance/apr_calculator.cfm)）

我有上述两个公式都适用于固定利率贷款，所以我相信我正确地实施了它们（即我的计算对应于许多在线计算器）。但是，乳清我尝试用 ARM 的平均利率计算，我的计算不等于其他在线 ARM APR 计算器显示的结果（如：[http ://www.bankrate.com/calculators/mortgages/annual-percentage -rate-apr-calculator.aspx](http://www.bankrate.com/calculators/mortgages/annual-percentage-rate-apr-calculator.aspx)）。

您应该如何计算 APR 的 ARP？您是否能够通过简单地平均贷款期限内的利率来做到这一点，或者这是错误的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T19:23:19.893

由于还款金额不是恒定的，因此需要使用数值方法来求解年百分比率。任何数值方法都可以。您共享的链接有另一个页面应该会有所帮助：

[http://www.efunda.com/math/num_rootfinding/num_rootfinding.cfm#Newton_Raphson](http://www.efunda.com/math/num_rootfinding/num_rootfinding.cfm#Newton_Raphson)

我建议先尝试二分法，然后转向更有效的方法，例如 Newton-Raphson。

# android - 视图：用不同的枢轴链接两次旋转

> ID：15890658
> 
> 赞同：1
> 
> 时间：2013-04-08T23:11:39.810
> 
> 标签：android, view

我正在尝试对视图应用两种不同的旋转，例如：
1：20° pivotX = width/2 pivotY= height/2
2：90° pivotX = 0 pivotY= 0

然而`View.setPivotX()`&`View.setPivotY()`似乎都只改变了一个唯一矩阵中的值，所以当我改变枢轴时，它会用那个新的枢轴重新应用第一次旋转，这不是我想要做的。

有没有办法以完全独立的方式处理这两个旋转？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-16T16:06:39.470

您可以使用两种不同的方法来设置两个旋转。首先是：

```
RotateAnimation rotateAnimation = new RotateAnimation(0f, 20f,  width/2, height/2);
rotateAnimation.setDuration(0);
rotateAnimation.setFillAfter(true);
View.setAnimation(rotateAnimation); 
```

第二个：

```
View.setPivotX(0);
View.setPivotY(0);
View.animate().rotation(90f).setDuration(0); 
```

# php - if (isset($var)) { } 使用 isset 的难度

> ID：15890664
> 
> 赞同：-2
> 
> 时间：2013-04-08T23:12:27.703
> 
> 标签：php, sql, isset

在下面的代码中使用 if (isset('prescription')) {'prescription'} 有困难：

```
$query = " 
    SELECT 
        id, 
        full_name,
        address,
        email,
        telephone,
        prescription
    FROM patients 
    WHERE id 
    LIKE '%" . $patient_id . "%'"; 
```

问题是，每当 php 从表字段中获取结果时，处方有时为空，有时带有信息。因此显示此通知：注意：未定义索引：

我发现的解决方案仅在表单输入上使用 isset 而不是来自表的数据。因此找到的示例包含 $_POST 或 $_GET ，它们对我不起作用。

干杯，伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T00:06:43.417

我将在这里冒险并猜测您正在尝试从空结果集中读取一个值。你应该首先检查一个有效的结果。这是一个使用 PDO 的示例

```
$pdo = new PDO('mysql:host=localhost;dbname=yourdb;charset=utf8', 'username', 'password');
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

// I've changed your query to remove the LIKE comparison
// Seemed incorrect for an ID lookup
$stmt = $pdo->prepare('SELECT
    id, full_name, address, email, telephone, prescription
    FROM patients WHERE id = ?');

$stmt->bindParam(1, $patient_id);
$stmt->execute();

$results = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Check for any results
if (0 === count($results)) {
    throw new Exception('No results found');
}

foreach ($results as $result) : ?>

<dl>
    <dt>ID</dt>
    <dd><?= htmlspecialchars($result['id']) ?></dd>

    <dt>Full name</dt>
    <dd><?= htmlspecialchars($result['full_name']) ?></dd>

    <!-- and so on -->
</dl>

<?php endforeach ?> 
```

# ios - 在 Restkit 0.2 中加载具有相同实体和不同谓词的两个不同表时遇到问题

> ID：15890674
> 
> 赞同：2
> 
> 时间：2013-04-08T23:12:50.173
> 
> 标签：ios, restkit, restkit-0.20

这是我正在尝试做的简化版本：

我有一个使用 UITabBarController 作为根控制器的应用程序。在两个选项卡中，我有一个 UINavigationController，其中包含一个自定义 UITableViewController。

其中一个 Tableview 用于显示“特色”项目，另一个用于显示“用户”项目。

第一个 API 端点是：/api/items/featured，另一个端点是：/api/items/user

我经历了在我的 AppDelegate.m 中设置所有内容的整个过程：

```
// Configure the object manager
RKObjectManager *objectManager = [RKObjectManager managerWithBaseURL:[NSURL URLWithString:API_SERVER]];
objectManager.managedObjectStore = managedObjectStore;
[RKObjectManager setSharedManager:objectManager];

RKEntityMapping *entityMapping = [RKEntityMapping mappingForEntityForName:@"Item" inManagedObjectStore:managedObjectStore];
[entityMapping addAttributeMappingsFromDictionary:@{
 @"id":                     @"itemID",
 @"type":                   @"type",
 @"created_at":             @"created_at":
 @"field1":                 @"field1"}];

// User Descriptor
RKResponseDescriptor *userDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:entityMapping pathPattern:@"/api/items/user" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:userDescriptor];

// Featured Listing Decriptor
RKResponseDescriptor *featuredDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:entityMapping pathPattern:@"/api/items/featured" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:responseDescriptor]; 
```

然后在 TableViewControls 我有以下内容（在第二个 tableview 控制器中用 'user' 代替 'featured'）

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self loadItems];
}

- (void)loadItems {    
    [[RKObjectManager sharedManager] getObjectsAtPath:@"/api/items/featured" parameters:nil 
        success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    self.lastupdate = [[NSDate alloc] init];
    } 
        failure:^(RKObjectRequestOperation *operation, NSError *error) {
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"An Error Has Occurred" message:[error localizedDescription] delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alertView show];
    }];
}

- (NSFetchedResultsController *)fetchedResultsController {
    if (_fetchedResultsController != nil) {
        return _fetchedResultsController;
    }
    RKManagedObjectStore *managedObjectStore = [RKManagedObjectStore defaultStore];
    self.managedObjectContext = managedObjectStore.mainQueueManagedObjectContext;

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Item" inManagedObjectContext:self.managedObjectContext];

    [fetchRequest setEntity:entity];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

    // Edit the sort key as appropriate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"created_at" ascending:NO];
    NSArray *sortDescriptors = @[sortDescriptor];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Set predicate to only get Featured Listings
    NSPredicate *predicate = [NSPredicate predicateWithFormat: @"type like 'featured'"];
    [fetchRequest setPredicate:predicate];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:@"Master"];
    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;

    NSError *error = nil;

    if (![self.fetchedResultsController performFetch:&error]) {
        // Replace this implementation with code to handle the error appropriately.
        // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development.
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return _fetchedResultsController;
} 
```

现在这一切都适用于第一个选项卡（目前它返回 8 个项目，type = 'featured'，显示在表中）。

当我切换到第二个选项卡时，问题就来了。它目前只返回 1 个 type='user' 的项目，并崩溃：

> CoreData：错误：严重的应用程序错误。在核心数据更改处理期间捕获到异常。这通常是 NSManagedObjectContextObjectsDidChangeNotification 观察者中的一个错误。 *** -[__NSArrayM objectAtIndex:]：索引 3 超出了带有 userInfo 的空数组的界限（null）

如果我省略了“用户”选项卡上的谓词，那么“特色”选项卡可以正常工作，“用户”选项卡会在其表中获取“特色”项目，而“用户”项目在顶部。

由于两个 tableview 控件的代码是相同的，除了“用户”和“功能”之外，我不知道问题出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T16:10:42.350

您是否在 UITableViewController 上实现了 NSFetchedResultsControllerDelegate 更改方法？我在使用 RestKit/RKGist 作为模板时发现了一个类似的错误，在删除了这些更改方法并删除了控制器作为它们的委托后，这个错误就消失了。这对我有用，因为我不想以这种方式收到有关更改的通知：我将 fetchedResultsController 的 getter 从结果的重新获取中分离出来，并在相应的 RKObjectRequestOperation 的成功块中调用重新获取。希望有帮助！

编辑

在我的情况下，我实际上在一个 UITableViewController 中使用了两个 NSFetchedResultsController：

在我的 .h 界面中

```
@property (strong, nonatomic) NSFetchedResultsController *fetchedResultsOneController;
@property (strong, nonatomic) NSFetchedResultsController *fetchedResultsTwoController; 
```

在 .m 实现中：

每个都有一个相应的 getter，它调用雕刻出来的 refetch

```
- (NSFetchedResultsController *)fetchedResultsOneController
{
    if (_fetchedResultsOneController != nil) {
        return _fetchedResultsOneController;
    }

    [self refetchResultsOneController];

    return _fetchedResultsOneController;
} 
```

refetch 只包含构建 fetch 请求、实体描述、排序和 fetch 控制器的其余逻辑，例如：

```
- (void) refetchResultsOneController
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = ...;
    [fetchRequest setEntity:entity];

    // set predicate for venue name
    NSPredicate *predicate = [NSPredicate predicateWithFormat: ....];
    [fetchRequest setPredicate:predicate];

    [fetchRequest setFetchBatchSize:200];

    NSSortDescriptor *distanceDescriptor = [[NSSortDescriptor alloc] initWithKey:...];
    NSArray *sortDescriptors = @[distanceDescriptor];

    [fetchRequest setSortDescriptors:sortDescriptors];

    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:@"SomeUniqueName"];
    self.fetchedResultsOneController = aFetchedResultsController;

    NSError *error = nil;
    if (![self.fetchedResultsOneController performFetch:&error]) {
        .. error handle...;
    }
} 
```

请注意，refetchers 是不同的；不同的实体和不同的 nspredicates，但相同的 ManagedObjectContext。

并在 objectmanager 操作的成功块中调用 refetch，对于 resultsOne，它很简单：

```
 [objectManager getObjectsAtPath:[NSString stringWithFormat:@"...the path for results one...", venueId] parameters:queryParams
                        success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
                            [self refetchResultsOneController];
                            [self.tableView reloadData];
                        }
                        failure:^(RKObjectRequestOperation *operation, NSError *error) {
                            NSLog(@"Error: %@", [error localizedDescription]);
                        }]; 
```

这对我来说适用于一个 UITableViewController 中的两个 NSFetchResultsController。注意我不允许用户操作来编辑/删除 fetchController 中的对象（没有双向通信） - 但我只对读取那里的数据感兴趣，并且它总是只有通过成功刷新才能启动远程服务器。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-20T19:15:43.327

创建和配置获取的结果控制器时，不要使用缓存。目前他们都在使用缓存，`@"Master"`这将导致他们尝试共享不合适的信息，因为获取请求不同。

# java - JFrame 的序列化移除了 JButton 的 ActionListener - Java

> ID：15890678
> 
> 赞同：0
> 
> 时间：2013-04-08T23:13:13.123
> 
> 标签：java, serialization, user-interface, deserialization, actionlistener

我对序列化比较陌生，所以我创建了一个测试应用程序来处理它。我对 a 进行了序列化，`JFrame`其中添加了 3 个`JComponents`：a`JTextArea`和两个`JButtons`。一个按钮保存了`JFrame`的状态（即序列化），另一个按钮加载了序列化的 JFrame（即反序列化）。

当我在 中键入消息`JTextArea`，单击按钮以保存状态，然后`JFrame`从 SER 文件中加载时，我得到了完全相同的对象（键入的消息和所有），只是按钮不再起作用。

有人介意解释为什么会这样吗？

PS 我知道序列化 GUI 组件通常不是一个好习惯，但这仅用于学习目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:28:48.913

我让正在实现的类`ActionListener`也实现`Serializable`了，这就解决了问题。

# c++ - C++ 使用字符串

> ID：15890680
> 
> 赞同：0
> 
> 时间：2013-04-08T23:13:40.447
> 
> 标签：c++, string, function

我是 C++ 编程的新手，我有一个任务是获取 txt 文件的内容并使用字典 txt 文件检查内容。当我将 string[] 发送到我的函数时，我总是收到一个错误，指出 std::basic 字符串无法转换为 std::strin

```
 ifstream d_file("dictionary.txt");
    string l;
    vector<string> user_vec;

    while( getline( d_file, l ) ) {
        user_vec.push_back( l);
    }

    size_t line_count = user_vec.size();

    for( size_t i = 0; i < line_count; ++i )
    {
        // cout << i << "    " << user_vec[i] << endl;
        bool result =  inDictionary(word, user_vec[i]);

    }

}

bool inDictionary(string word,string dictionary[])
{
    cout<<word<< dictionary<<endl;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:16:19.083

您正在传递一个字符串，该函数需要一个字符串数组。

更改`inDictionary`为以下，因为`user_vec[i]`是一个字符串。

```
bool inDictionary(string& word,string& dictionary)
{
    cout<<word<< dictionary<<endl;
} 
```

或者，如果您想将所有行传递给`inDictionary`函数，则将向量传递给函数。

```
bool inDictionary(string& word, std::vector<string>& dictionary)
{
   //...
} 
```

然后你会像传递向量`bool result = inDictionary(word, user_vec);`。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:17:07.840

`user_vec[i]`是一个字符串； `string dictionary[]`是字符串数组，类型不匹配。

您必须更改`inDictionary`函数的原型。

# java - 异步任务致命异常 - 线程正在退出，但未捕获异常

> ID：15890681
> 
> 赞同：0
> 
> 时间：2013-04-08T23:13:39.573
> 
> 标签：java, android, android-asynctask

所以我对此很陌生，我的应用程序不断崩溃。我在这里找到了这段代码，但无法让它为我的一生工作。我要做的只是下载选定的文件，当我不在工作文件夹的子目录中时它可以工作。我从 MySQL 数据库下载作业文件夹名称，效果很好。每个工作都有用于照片、文档、杂项等的子文件夹......假设我有工作 4131.. 并且在 4131 里面有以下......

4131/cdgjkg.png 4131/杂项 4131/照片

在photots里面还有另一个png。（4131/照片/dioghg.png）。问题是，如果我使用基本 4131 方法下载 png ，它就可以工作。没有错误。如果我进入 Photots 目录并尝试下载该文件，我会收到大量异步错误。下面是代码。如果您需要查看更多内容，请告诉我。

```
new LoadAllJobs().execute();

    ListView lv = getListView();

    lv.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            String file = ((TextView)view).getText().toString();
            String current_dir = dir + "/" +  file;
            if(file.contains(".")){
                //download the file or view it
                try {
                    Log.d("Downloading ", file);
                    new FTPDownload().execute(file);  // <-----This is where I start the task to enter the FTPDownload, never to be seen again :(
                    Log.d("Success ", current_dir);
                }
                catch (Exception e) {
                    e.printStackTrace();
                } 
```

这是一个块，我已经检索了列表并仅在文件包含“。”时才下载文件。（服务器上的文件夹名称中不允许使用“.”字符，因此这是一种快速作弊）。

**FTP下载类**

```
class FTPDownload extends AsyncTask<String, Integer, String> {
//public FTPClient client;

@Override
protected String doInBackground(String... filename) {
    try {
        System.out.println("Filename->: " + filename[0]);
        GetFileFTP("/" + filename[0], Environment.getExternalStorageDirectory() + "/Download/", filename[0]);
    }
    finally
    {
        //e.printStackTrace();
        Log.v("DONE: ", "All done!");
    }
    System.out.println("I HATE YOU.");  // <----- NEVER REACHES THIS LINE WHEN TRYING TO DOWNLOAD IN A SUBFOLDER
    return null;
}

    public void GetFileFTP(String srcFileSpec, String destpath, String destname) {
    FTPClient client = new FTPClient();
    Log.v("pathSpec: ", destpath);

    try {
        client.connect("xxxxxx");
        client.login("xxxxxx", "xxxxxx");

        client.enterLocalPassiveMode();
        client.setFileType(org.apache.commons.net.ftp.FTP.BINARY_FILE_TYPE);

        InputStream input = client.retrieveFileStream(srcFileSpec);
        if(input != null) Log.v("GetFileFTP: ", "INPUT STREAM OPENED SUCCESSFULLY!");
        Log.v("File InputStream: ", srcFileSpec);

        File output_file = new File(destpath + destname);
        Log.v("OUTPUTFILE: ", destpath + destname);

        inputstreamcopy(input, output_file);

        /*try {
            //Log.e("Closing connection: ", client.toString());
            client.logout();
            client.disconnect();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }*/
    }
    catch (IOException e) {
        Log.e("FTP", "Error Getting File");
        e.printStackTrace();
    }
}

    public static void inputstreamcopy(InputStream source, File destination){
        try {
            org.apache.commons.io.FileUtils.copyInputStreamToFile(source, destination);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

**控制台输出**

```
04-08 15:10:05.010: D/Downloading(29309): login.php
04-08 15:10:05.010: D/Success(29309): 4131/Miscellaneous/login.php
04-08 15:10:05.010: I/System.out(29309): Filename->: login.php
04-08 15:10:05.020: V/pathSpec:(29309): /storage/emulated/0/Download/
04-08 15:10:06.010: V/File InputStream:(29309): /login.php
04-08 15:10:06.020: V/OUTPUTFILE:(29309): /storage/emulated/0/Download/login.php
04-08 15:10:06.030: V/DONE:(29309): All done!
04-08 15:10:06.030: W/dalvikvm(29309): threadid=11: thread exiting with uncaught exception (group=0x418f5930)
04-08 15:10:06.040: E/AndroidRuntime(29309): FATAL EXCEPTION: AsyncTask #1
04-08 15:10:06.040: E/AndroidRuntime(29309): java.lang.RuntimeException: An error occured while executing doInBackground()
04-08 15:10:06.040: E/AndroidRuntime(29309):    at android.os.AsyncTask$3.done(AsyncTask.java:299)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.FutureTask.run(FutureTask.java:239)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.lang.Thread.run(Thread.java:856)
04-08 15:10:06.040: E/AndroidRuntime(29309): Caused by: java.lang.NullPointerException
04-08 15:10:06.040: E/AndroidRuntime(29309):    at org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1792)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1769)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at org.apache.commons.io.IOUtils.copy(IOUtils.java:1744)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at org.apache.commons.io.FileUtils.copyInputStreamToFile(FileUtils.java:1512)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at com.example.tdsi.FTPDownload.inputstreamcopy(FTPDownload.java:70)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at com.example.tdsi.FTPDownload.GetFileFTP(FTPDownload.java:51)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at com.example.tdsi.FTPDownload.doInBackground(FTPDownload.java:21)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at com.example.tdsi.FTPDownload.doInBackground(FTPDownload.java:1)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-08 15:10:06.040: E/AndroidRuntime(29309):    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
04-08 15:10:06.040: E/AndroidRuntime(29309):    ... 4 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:24:11.197

这是你的罪魁祸首：

```
04-08 15:10:06.040: E/AndroidRuntime(29309): Caused by: java.lang.NullPointerException
[...]
org.apache.commons.io.FileUtils.copyInputStreamToFile(FileUtils.java:1512) 
```

你正在传递`null`，`inputstreamcopy()`这会导致 NPE。

# jquery - Jquery幻灯片和边距

> ID：15890683
> 
> 赞同：3
> 
> 时间：2013-04-08T23:13:47.313
> 
> 标签：jquery

我目前有一个 Jquery 幻灯片来滑动错误消息。

```
$('form').submit(function(){
   var $emptyFields = $();
    $('form').find('input').each(function(){if($(this).val() == ""){$emptyFields.push(this)}});
    if($emptyFields.length != 0){
        $('form').find('input').css("border","");
        $("#error").show("slide", { direction: "down" }, 1000);
        return false;
    }else{
        return true;
    }
}); 
```

我通过以下 css 将错误消息居中。

```
 #error {
    display: none;
    font-size: 14px;
    margin-left: auto;
    margin-right: auto;
    width: 24%;
  } 
```

但是会发生什么是将其滑入然后应用css。有没有办法解决 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T12:35:06.353

您实际上可以使用 slideDown() 或 slideToggle()，我之前在 show 上遇到过 css 问题，它的行为略有不同。

# html - 如何获得 height: 100% 以说明同一 div 中现有的像素高度元素？

> ID：15890686
> 
> 赞同：0
> 
> 时间：2013-04-08T23:14:16.753
> 
> 标签：html, css, height

我有一个具有定义高度的容器，其中包含两个 div，第一个具有像素定义的高度，第二个我想填充其容器的剩余空间，即 100% 减去第一个 div 的像素定义的高度。

这个问题有没有不涉及 JavaScript 的解决方案？我可以使用 JavaScript 解决方案（事实上 JavaScript 改变容器的高度是我来到这里的原因），但这似乎应该有较低级别的支持，这看起来可能会成为一个级联问题。

### 例子

[http://jsfiddle.net/h3gsz/1/](http://jsfiddle.net/h3gsz/1/)

### HTML

```
<div id="container">
    <div id="top_content"></div>
    <div id="remaining_content"></div>
</div> 
```

### CSS

```
#container {
    width: 400px;
    height: 400px;
    border: 5px solid black;
}
#top_content {
    background-color: blue;
    width: 100%;
    height: 50px;
}
#remaining_content {
    background-color: red;
    width: 100%;
    height: 100%;
} 
```

### 编辑

已经为原始小提琴提供了答案，但在简化问题时，我允许答案引入新问题：http: [//jsfiddle.net/h3gsz/6/](http://jsfiddle.net/h3gsz/6/)

我删除了 inline-block 样式和 max-width 值。鉴于剩余内容的绝对定位，容器的宽度不再由所述内容定义（来自 inline-block），因此在不应该有水平滚动条的地方引入了水平滚动条。

我不确定我是否应该简单地提出一个新问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:25:14.303

怎么用`overflow:hidden;`？

```
#container {
    width: 400px;
    height: 400px;
    border: 5px solid black;
    overflow:hidden;
} 
```

[JSF](http://jsfiddle.net/h3gsz/2/)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:31:04.063

```
#container {
    width: 400px;
    height: 400px;
    border: 5px solid black;
    position: relative;
}
#top_content {
    background-color: blue;
    width: 100%;
    height: 50px;
}
#remaining_content {
    background-color: red;
    width: 100%;
    top: 50px;
    bottom: 0;
    position: absolute;
} 
```

[http://jsfiddle.net/h3gsz/4/](http://jsfiddle.net/h3gsz/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:25:51.830

为什么不直接使用汽车？

[http://jsfiddle.net/h3gsz/3/](http://jsfiddle.net/h3gsz/3/)

CSS：

```
#container {
  width: 400px;
  height: auto;
  border: 5px solid black;
}
#top_content {
  background-color: blue;
  width: 100%;
  height: 50px;
}
#remaining_content {
  background-color: red;
  width: 100%;
  height: auto;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T23:35:42.963

更有经验的人可能有更好的选择，但你可以试试这个：

```
#container { 
width: 400px; 
height: 400px; 
border: 5px solid black;
overflow: hidden ;
}  
#top_content { 
background-color: blue;
width: 100%;
height: 50px; 
} 
#remaining_content { 
background-color: red; 
width: 100%; 
height: 100%; 
margin-bottom: 0;
} 
```

根据您要使用它的目的，您可以删除`#remaining_content <div>`

HTML：

```
<div id="container">
  <div id="top_content"></div>
</div> 
```

CSS：

```
#container {
  background-color: green;
  width: 400px;
  height: relative;
  min-height:400px;
  border: 5px solid black;
  overflow:none;
  word-wrap:break-word;
}
#top_content {
  background-color: blue;
  width: 100%;
  height: 50px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-09T00:07:29.320

你也可以使用 display:table; [在这里摆弄](http://jsfiddle.net/cardeo/239EA/)

```
.main, .sidebar {
float: none;
padding: 20px;
vertical-align: top;
}

.container {
display: table;
}

.main {
width: 400px;
background-color: LightSlateGrey;
display: table-cell;
}

.sidebar {
width: 200px;
display: table-cell;
background-color: Tomato;
} 
```

# mapkit - iOS6 MapKit（MKLocalSearch）：如何获取地图项的地址？

> ID：15890687
> 
> 赞同：0
> 
> 时间：2013-04-08T23:14:17.990
> 
> 标签：mapkit, ios6-maps, google-local-search

iOS6 苹果 MapKit

所以我大部分理解下面链接中的代码。 [http://phpadvocate.com/blog/2013/01/ios-6-1-simple-example-using-mklocalsearch/](http://phpadvocate.com/blog/2013/01/ios-6-1-simple-example-using-mklocalsearch/)

但是，如何获取 mapItem 的地址？似乎其他属性包括：placemark、isCurrentLocation、name、phoneNumber 和 url。

[http://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapItem_class/MKMapItem_class.pdf](http://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapItem_class/MKMapItem_class.pdf)

基本上，一旦获取数据，我想将零售位置的名称显示为 cell.text，将地址显示为 cell.detailText。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T04:07:32.057

mapItem.placemark.thoroughfare.copy, // 将返回第一行地址

mapItem.placemark.locality, // 将返回城市

mapItem.placemark.administrativeArea //会返回State。

下面还有一些：

CLP 地标 | 属性含义

大马路 | 街道地址。如果多行，则为第一行。

次通道 | 街道地址，第二行（例如，公寓或单元号，箱号）

地点 | 城市

次区域 | 这可能包含一个社区或地标名称，尽管它通常是 nil

行政区 | 州、省、地区或其他类似单位

行政区 | 县

邮政编码 | 邮政编码

国家 | 国家

国家代码 | 两位数 ISO 国家代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-09T00:35:13.407

要更正“正确答案”，subThoroughfare 不包含公寓号或单元号，它是门牌号。

公寓号码在 subPremise 中，我还不知道如何检索。

# r - 为生存定义分布::survreg()

> ID：15890688
> 
> 赞同：4
> 
> 时间：2013-04-08T23:14:19.640
> 
> 标签：r, survival-analysis

我尝试使用伽玛分布拟合一个 survreg 模型。

下面`?survreg.distributions`我定义了我的自定义分布，如下所示：

```
gamma <- list(name = 'gamma',
          parms = c(2,2),
          init = function(x, weights, ...){
            c(median(x), mad(x))
          },
          density = function(x, parms){
            shape <- parms[1]
            scale <- parms[2]
            cbind(pgamma(x, shape=shape, scale=scale),
                  1-pgamma(x, shape=shape, scale=scale),
                  dgamma(x, shape=shape, scale=scale),
                  (shape-1)/x - 1/scale,
                  (shape-1)*(shape-2)/x^2 - 2*(shape-1)/(x*scale) + 1/scale^2)
          },
          quantile = function(p, parms) {
            qgamma(p, shape=parms[1], scale=parms[2])
          },
          deviance = function(...) stop('deviance residuals not defined')
) 
```

但是我无法让它运行：

```
require(survival)
survreg(Surv(log(time), status) ~ ph.ecog + sex, lung, dist=gamma)
#Error in coxph.wtest(t(x) %*% (wt * x), c((wt * eta + weights * deriv$dg) %*%  : 
#  NA/NaN/Inf in foreign function call (arg 3) 
```

该错误来自一些 C 代码，但我认为它是更早生成的......

survreg 的任何提示/建议/替代方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-09T15:37:50.000

我找到了`flexsurv`实现广义伽玛分布的包。

对于 Weibull 分布，来自`survreg`和的估计值`flexsurvreg`相似（但请注意不同的参数化：

```
require(survival)
summary(survreg(Surv(log(time), status) ~ ph.ecog + sex, data = lung, dist='weibull'))

Call:
survreg(formula = Surv(log(time), status) ~ ph.ecog + sex, data = lung, 
    dist = "weibull")
              Value Std. Error      z         p
(Intercept)  1.7504     0.0364  48.13  0.00e+00
ph.ecog     -0.0660     0.0158  -4.17  3.10e-05
sex          0.0763     0.0237   3.22  1.27e-03
Log(scale)  -1.9670     0.0639 -30.77 6.36e-208

Scale= 0.14 

Weibull distribution
Loglik(model)= -270.5   Loglik(intercept only)= -284.3
    Chisq= 27.62 on 2 degrees of freedom, p= 1e-06 
Number of Newton-Raphson Iterations: 6 
n=227 (1 observation deleted due to missingness)

require(flexsurv)
flexsurvreg(Surv(log(time), status) ~ ph.ecog + sex, data = lung, dist='weibull')

Call:
flexsurvreg(formula = Surv(log(time), status) ~ ph.ecog + sex,     data = lung, dist = "weibull")

Maximum likelihood estimates: 
            est    L95%    U95%
shape    7.1500  6.3100  8.1000
scale    5.7600  5.3600  6.1800
ph.ecog -0.0660 -0.0970 -0.0349
sex      0.0763  0.0299  0.1230

N = 227,  Events: 164,  Censored: 63
Total time at risk: 1232.1
Log-likelihood = -270.5, df = 4
AIC = 549 
```

使用 flexsurvreg，我们可以将广义 gamma 分布拟合到该数据：

```
flexsurvreg(Surv(log(time), status) ~ ph.ecog + sex, data = lung, dist='gengamma')

Call:
flexsurvreg(formula = Surv(log(time), status) ~ ph.ecog + sex,     data = lung, dist = "gengamma")

Maximum likelihood estimates: 
            est    L95%    U95%
mu       1.7800  1.7100  1.8600
sigma    0.1180  0.0971  0.1440
Q        1.4600  1.0200  1.9100
ph.ecog -0.0559 -0.0853 -0.0266
sex      0.0621  0.0178  0.1060

N = 227,  Events: 164,  Censored: 63
Total time at risk: 1232.1
Log-likelihood = -267.57, df = 5
AIC = 545.15 
```

对数逻辑分布（与 相比`survreg`）不是内置的，但可以很容易地自定义（参见 的示例`flexsurvreg`）。

我没有对其进行过多测试，但`flexsurv`似乎是`survival`.

# business-objects - Business Objects XI Web Intelligence 中的“稀疏”排名？

> ID：15890690
> 
> 赞同：2
> 
> 时间：2013-04-08T23:14:29.247
> 
> 标签：business-objects

在 Business Objects XI Web Intelligence 中，Rank 函数返回密集的结果。例如，当按“金额”排名时，我只想返回前十名记录。然而，三项记录在“金额”上并列第五。结果一共12条记录：1至4位和6至10位各1条，第5位各3条。

期望的结果是“稀疏”的前十名，其中两个排名最低的记录（第 9 位和第 10 位）下降。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T07:35:01.423

我试图这样做并按数量对客户进行排名。

我有 2 个对象：[Amount] 和 [Customernumber]。[客户编号] 是数字。

我创建了一个新变量：

[varForSorting]=[Amount]*10000000+ToNumber([Customernumber])

然后我按新变量 [varForSorting] 进行排名。

相同金额的客户将按客户编号按字母顺序排序。我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T18:13:06.720

这是一个示例，说明我如何解决帐户数量随时间变化的问题。这种方法允许您使用数据提供者中的其他度量来打破密集的排名关系。基本上，您在一个等级中使用多个度量，并决定按第一、第二等排列哪个度量：

第一步：确定变化量
v_Account_Count_Delta_Amount
=([v_Account_Count_After] - [v_Account_Count_Before])

第 2 步：对变化量进行排名（这就是关系和密集排名导致返回多行的地方）
v_Account_Count_Delta_Amount_Rank
=NoFilter(Rank([v_Account_Count_Delta_Amount]))

第 3 步：使用其他度量计算平局排名
v_MonthToDateMeasuresRank
=NoFilter(Rank([Month To Date Sva]+ [Bank Share Balance] + [Total Commitment]))

第 4 步：计算现在没有平局的组合排名并加权您的排名，但您选择
v_Account_Count_Combined_Rank
=Rank([v_Account_Count_Delta_Amount_Rank]* 1000000 + [v_MonthToDateMeasuresRank];Bottom)

第 5 步：过滤 v_Account_Count_Combined_Rank <= 10 的数据块

最终，根据您的数据，它仍然可能导致平局，除非您采取额外的步骤，通过其他可以转换为数字的独特属性进行排名（请参阅 Maria Ruchko 的回答，了解使用客户编号的那一点魔法）。我尝试使用 RowIndex() 和 LineNumber() 来做到这一点，但无法获得可用的结果。当我的度量加在一起时，碰巧永远不会绑定，所以这适用于我的特定数据块。

# .htaccess - mod_rewrite 问题或者我的服务器可能是问题？

> ID：15890695
> 
> 赞同：-1
> 
> 时间：2013-04-08T23:14:59.950
> 
> 标签：.htaccess

我在这里有点适应。我正在涉足庞大的 .htaccess 池，以便重写我的 URL 以使其对 SEO 友好。

我整天都在研究这个。我从各种教程和 SO 帖子中获取代码片段，但我没有得到任何结果，而且大多数时候没有错误。

我有一个运行 Apache 2.0 的 cPanel 专用服务器。我打电话给我的主机 LunarPages，并确认 mod_rewrite 已安装，并且显然工作正常。

我想开始的地方是将名称更改`index.php`为`/home/`使`http://www,website.com/home/`尾部斜杠可选以及 home 不区分大小写。

从字面上看，我尝试的一切都无济于事，就好像请求被完全忽略了一样。

我正在 PC 上的记事本中编写 .htaccess 文件，并使用 FileZilla 将其上传，传输类型设置为 ASCII。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:22:49.573

> 我想开始的地方是将名称更改`index.php`为`/home/`使`http://www,website.com/home/`尾部斜杠可选以及 home 不区分大小写。

尝试：

```
RewriteRule ^/?home/?$ /index.php [L,NC] 
```

请注意，如果您有任何相对链接（如脚本或 CSS）`index.php`并且您转到`http://www,website.com/home/`，则相对链接将`/home`作为基础（而不是`/`）。您要么需要将这些链接设为绝对链接，要么将 URI 基础添加到页眉：

```
<base href="/"> 
```

# ios - 选择段后我们如何回忆 PickView 的 didSelectRow 呢？

> ID：15890698
> 
> 赞同：1
> 
> 时间：2013-04-08T23:15:17.070
> 
> 标签：ios, objective-c, xcode, cocoa-touch, uipickerview

我使用分段控件供用户在选择器视图中选择一行后在两种类型的结果之间进行选择。但是，当我在选择器视图中选择一行时，它会显示所选段的结果，但我选择另一个段时它不会做任何事情，直到我再次重新选择该行。

这是我的代码：

```
- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {

i=row;
switch (i) {
    case 0:

case 1
if(_segment.selectedSegmentIndex == 1){

        [self Fquarter];
        [self Tquarter];
        [self Ten];
        [self Twenty];
        [self Fourty];
        [self Fifty];

        NSLog(@"AUDIO 10 MINS");
        }

        if(_segment.selectedSegmentIndex == 0){

            [self SFquarter];
            [self STquarter];
            [self STen];
            [self STwenty];
            [self SFourty];
            [self SFifty];

             NSLog(@"Visual 10 MINS");
        } 
```

每个案例都是这样，我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:52:22.530

我认为您需要从选取器委托方法和分段控件的操作方法中调用一个包含所有 [self Fquarter] 等语句的方法。像这样的东西（pickerSelectedRow 是一个类型为 NSInteger 的属性）：

```
@interface ViewController ()
@property (weak,nonatomic) IBOutlet UISegmentedControl *segment;
@property (nonatomic) NSInteger pickerSelectedRow;
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
    self.pickerSelectedRow = row;
    [self doStuff];

}

-(IBAction)segmentChosen:(UISegmentedControl *)sender {
    [self doStuff];
}

-(void)doStuff {
    switch (self.pickerSelectedRow) {
        case 0:

        case 1:
            if(_segment.selectedSegmentIndex == 1){

                [self Fquarter];
                [self Tquarter];
                [self Ten];
                [self Twenty];
                [self Fourty];
                [self Fifty];

                NSLog(@"AUDIO 10 MINS");
            }

            if(_segment.selectedSegmentIndex == 0){

                [self SFquarter];
                [self STquarter];
                [self STen];
                [self STwenty];
                [self SFourty];
                [self SFifty];

                NSLog(@"Visual 10 MINS");
            }

    }
} 
```

With this type of arrangement, the method where you set your values is called either when the picker view value changes or the segmented control's value changes.

# php - 用动态参数初始化一个类实例？

> ID：15890703
> 
> 赞同：0
> 
> 时间：2013-04-08T23:15:36.320
> 
> 标签：php

我正在尝试使用动态参数创建一个新的类实例，例如：

```
$controller = 'className';
$parameters = array('hello', 'world');
new $controller($parameters); 
```

除了我希望将参数自然地传递给类，就像我通过调用方法一样`call_user_func_array();`，我想避免必须在数组中传递参数。

有没有办法在有效调用`call_user_func_array();`构造函数的同时启动一个类？或者甚至阻止构造函数的自动运行，以便我可以通过`call_user_func_array();`将属性作为数组运行它？

我现在的实际代码是：

```
if(!class_exists($controller)) require('controllers/' . $controller . '.php');
return new $controller(); 
```

我可以将一组参数传递给构造函数`$controller($parameters)`，但它们都将位于一个数组中，而不是作为单独的参数。

完整的文件源可以在这里的上下文中查看：[https ://github.com/pyrokinetic/mfw/blob/master/libraries/load.lib.php](https://github.com/pyrokinetic/mfw/blob/master/libraries/load.lib.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:27:38.477

试试这个：

```
// Get your stuff from Router

$class = "Home";
$method = "Welcome";
$params = array(
    'id' => 2,
    'name' => 'John'
);

// Dispatch

$app = new $class();
call_user_func_array(array($app, $method), $params); 
```

这样，当您将 $params 交给 call_user_func_array() 时，它就是数组，但是在您的实例化控制器/方法中，您不会将 $params 作为一个数组变量，但是 $params 数组中的每个键都是单独的变量。这是你需要的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:59:29.033

```
$reflect  = new ReflectionClass($class);
$instance = $reflect->newInstanceArgs($args); 
```

[来源](https://stackoverflow.com/questions/2409237/how-to-call-the-constructor-with-call-user-func-array-in-php)

# java - 多次调用paintComponent()

> ID：15890704
> 
> 赞同：0
> 
> 时间：2013-04-08T23:15:40.857
> 
> 标签：java, swing, awt, java-2d

我有这两个类：

```
public class Pencil extends JComponent implements MouseListener, MouseMotionListener{
Plansa plansa;
Graphics g;
public Pencil(Plansa newCanvas){
    this.plansa = newCanvas;
    this.plansa.setFlagShape(false);
}
@Override
public void mouseDragged(MouseEvent arg0) {
    plansa.setMouseDragged(arg0);
    this.plansa.setFlagShape(false);
    plansa.paintComponent(plansa.getGraphics());
}

@Override
public void mouseClicked(MouseEvent e) {
}

@Override
public void mousePressed(MouseEvent arg0) {
    plansa.setMousePressed(arg0);
}

@Override
public void mouseReleased(MouseEvent arg0) {
    // TODO Auto-generated method stub
    plansa.setMouseReleased(arg0);
    this.plansa.setFlagShape(true);
    plansa.paintComponent(plansa.getGraphics());

}

@Override
public void mouseEntered(MouseEvent e) {
}

@Override
public void mouseExited(MouseEvent e) {
}

@Override
public void mouseMoved(MouseEvent e) {
}

} 
```

和这个：

```
public class Plansa extends JPanel{
Image image;
Pencil pencil;
 //...
 void init(){
    this.setShape("freeLine");
    this.setColor(Color.BLACK);
    this.size=1;
    this.type="round";
    this.fill=false;
    this.setBackground(Color.WHITE);
    pencil = new Pencil(this);
    addMouseListener(pencil);
    addMouseMotionListener(pencil);
    flagPaint = true;
    flagShape = false;
}
public Plansa(){
    this.setSize(800, 600);
    init();
}

//...

       @Override
    public void paintComponent(Graphics g) {
    g.setColor(currentColor);
    Graphics2D g2d = (Graphics2D) g;
    g2d.setStroke(setBrush(size,type));
    super.paintComponent(g);
    switch(shape){
        default: break;
        case "freeLine":{ 
            g.drawLine(xDragged, yDragged, xCurrent, yCurrent); 
            break;
        }
            case "rectangle":{
                if(flagShape == true){
            g.drawRect(xPressed, yPressed, Math.max(xCurrent-xPressed,xPressed-xCurrent), Math.max(yCurrent-yPressed,yPressed-yCurrent));
            if(fill == true) g.fillRect(xPressed, yPressed, Math.max(xCurrent-xPressed,xPressed-xCurrent), Math.max(yCurrent-yPressed,yPressed-yCurrent));
                }
            break;
        }
        case "circle":{
            if(flagShape == true){
            int radius = (int)Math.sqrt(Math.max(xCurrent-xPressed,xPressed-xCurrent)*Math.max(xCurrent-xPressed,xPressed-xCurrent)+Math.max(yCurrent-yPressed,yPressed-yCurrent)*Math.max(yCurrent-yPressed,yPressed-yCurrent));
            g.drawOval(xPressed, yPressed, radius, radius);
            if(fill == true) g.fillOval(xPressed, yPressed, radius, radius);
            }
            break;
        }
        case "oval":{
            if(flagShape == true){
            g.drawOval(xPressed, yPressed, Math.max(xCurrent-xPressed,xPressed-xCurrent), Math.max(yCurrent-yPressed,yPressed-yCurrent));
            if(fill == true) g.fillOval(xPressed, yPressed, Math.max(xCurrent-xPressed,xPressed-xCurrent), Math.max(yCurrent-yPressed,yPressed-yCurrent));
            }
            break;
        }
        case "line":{
            if(flagShape == true){
            g.drawLine(xPressed, yPressed, xCurrent, yCurrent);
            }
            break;
        }
    }

}

 //...
} 
```

我的问题是，每次我调用paintComponent() 方法时，JPanel 都会清除，剩下的唯一项目就是我刚刚绘制的项目。有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T00:31:59.853

仔细检查代码后，您似乎正在尝试将`Component`s 用作“画家”，这有点像将跑车用作卡丁车，很多额外的东西却收效甚微。

相反，您应该为自己定义一些 kine 的接口，该接口提供您想要绘制/绘制的基本要求，然后定义实现该功能的具体类实现。

然后，您将维护`List`某种可以绘制的所有图纸。

虽然简单，但下面的示例提供了一个可以增强的起点，允许选择图纸、重新排序和删除（如果您想要的话）。

这本质上与 Doorknob (+1) 提出的概念相同

![在此处输入图像描述](https://i.stack.imgur.com/OSdNq.png)

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.awt.geom.Line2D;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestDraw {

    public static void main(String[] args) {
        new TestDraw();
    }

    public TestDraw() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new Pencil());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class Pencil extends JPanel implements MouseListener, MouseMotionListener {

        private List<Drawable> drawables;
        private Drawable activeDrawable;

        private Point clickPoint;

        public Pencil() {
            drawables = new ArrayList<>(5);
            addMouseListener(this);
            addMouseMotionListener(this);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            for (Drawable drawable : drawables) {
                drawable.paint(g2d);
            }
            g2d.dispose();
        }

        @Override
        public void mouseDragged(MouseEvent e) {
            if (activeDrawable != null) {
                Point p = e.getPoint();
                Rectangle bounds = activeDrawable.getBounds();

                int x = bounds.x;
                int y = bounds.y;
                int width = p.x - clickPoint.x;
                int height = p.y - clickPoint.y;
                if (width < 0) {
                    width *= -1;
                    x = p.x;
                }
                if (height < 0) {
                    height *= -1;
                    y = p.y;
                }
                bounds = new Rectangle(x, y, width, height);
                System.out.println(bounds);
                activeDrawable.setBounds(bounds);
                repaint();
            }
        }

        @Override
        public void mouseClicked(MouseEvent e) {
        }

        protected Drawable createActiveShape(MouseEvent e) {

            System.out.println("Anchor = " + e.getPoint());
            Drawable drawable = new FreeLine(e.getPoint());
            drawable.setLocation(e.getPoint());
            return drawable;

        }

        @Override
        public void mousePressed(MouseEvent e) {
            // You could also check to see if the clicked on a drawable...
            clickPoint = e.getPoint();
            activeDrawable = createActiveShape(e);
            drawables.add(activeDrawable);
            repaint();
        }

        @Override
        public void mouseReleased(MouseEvent e) {
            if (activeDrawable != null) {
                Rectangle bounds = activeDrawable.getBounds();
                if (bounds.width == 0 || bounds.height == 0) {
                    drawables.remove(activeDrawable);
                }
            }
            clickPoint = null;
            activeDrawable = null;
        }

        @Override
        public void mouseEntered(MouseEvent e) {
        }

        @Override
        public void mouseExited(MouseEvent e) {
        }

        @Override
        public void mouseMoved(MouseEvent e) {
        }
    }

    public interface Drawable {

        public void setLocation(Point p);

        public void setSize(Dimension dim);

        public void setBounds(Rectangle bounds);

        public Rectangle getBounds();

        public void paint(Graphics2D g2d);
    }

    public abstract class AbstractDrawable implements Drawable {

        private Rectangle bounds;

        public AbstractDrawable() {
            bounds = new Rectangle();
        }

        @Override
        public void setLocation(Point p) {
            bounds.setLocation(p);
        }

        @Override
        public void setBounds(Rectangle bounds) {
            this.bounds = bounds;
        }

        @Override
        public void setSize(Dimension dim) {
            bounds.setSize(dim);
        }

        @Override
        public Rectangle getBounds() {
            return bounds;
        }
    }

    public class FreeLine extends AbstractDrawable {

        private Point anchor;

        public FreeLine(Point anchor) {
            this.anchor = anchor;
        }

        @Override
        public void paint(Graphics2D g2d) {
            Rectangle bounds = getBounds();
            Point p1 = new Point(anchor);
            Point p2 = new Point(bounds.getLocation());
            if (p1.x > p2.x) {
                p2.x = p1.x - bounds.width;
            } else {
                p2.x = p1.x + bounds.width;
            }
            if (p1.y > p2.y) {
                p2.y = p1.y - bounds.height;
            } else {
                p2.y = p1.y + bounds.height;
            }
            g2d.draw(new Line2D.Float(p1, p2));
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T01:10:05.290

渐进式绘图的一个更好的主意是使用 a`BufferedImage`作为画布，如此[处所示](https://stackoverflow.com/a/10628553/418556)。

![](https://i.stack.imgur.com/eAgUn.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T23:20:15.647

将所有对象存储在一个中`ArrayList`，并在绘制时对其进行迭代。

例如，您可以让它们都实现一个自定义接口`Drawable`，然后存储在一个`ArrayList<Drawable>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T23:17:14.973

不要使用/注释掉：

```
super.paintComponent(g); 
```

那条线正在清理。

# tinymce - 果园上传文件 w/TinyMCE

> ID：15890710
> 
> 赞同：1
> 
> 时间：2013-04-08T23:16:00.447
> 
> 标签：tinymce, orchardcms

我知道 Orchard 包含一组用于 TinyMCE 的内置选项，用于上传媒体，但是否有类似的仅上传标准文档的等效选项，以便用户可以在编辑器中链接到它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T20:05:11.307

你试过 TinyMCE 豪华版吗？

[http://gallery.orchardproject.net/List/Modules/Orchard.Module.TinyMceDeluxe](http://gallery.orchardproject.net/List/Modules/Orchard.Module.TinyMceDeluxe)

您可以使用任何官方插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T15:34:14.553

You can use [TinyMceDeluxe](http://gallery.orchardproject.net/List/Modules/Orchard.Module.TinyMceDeluxe), as mentioned, which lets you use TinyMCE plugins. Then, you can use a TinyMCE plugin to get the functionality you need. Here are some of the options that I'm aware of:

*   [MCFileManager](http://www.tinymce.com/wiki.php/MCFileManager)
*   [TinyBrowser](http://www.lunarvis.com/products/tinymcefilebrowserwithupload.php)
*   [Ajax file/image manager](http://www.phpletter.com/Demo/Tinymce-Ajax-File-Manager/)
*   [PDW File Browser](http://sourceforge.net/projects/pdwfilebrowser/)

# php - 一个 for 循环没有按预期执行

> ID：15890711
> 
> 赞同：0
> 
> 时间：2013-04-08T23:16:03.737
> 
> 标签：php

我正在运行一个 for 循环并尝试将数据输入到数组中。

当我运行数组的 print_r 时，就好像 for 循环只运行一次，而它应该运行多次！

```
for($i=0; $i<count($count); $i++){
        $currentField = $array[$i];
        $test = "".$field."[".$i."]";
        $this->_postData[$test] = $currentField;
        $this->_currentItems[$i] = $test;
    }

    print_r($this->_currentItems);
    die(); 
```

如果我之前回显 $count，它会显示 3（例如），但是当我打印数组时，它只有 1 个值！有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:17:30.230

尝试

```
for($i=0; $i<$count; $i++) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:17:37.573

我认为不需要计数。

尝试

```
for($i=0; $i<$count; $i++){ 
```

# google-maps - 叠加层中较大的地图标记

> ID：15890714
> 
> 赞同：0
> 
> 时间：2013-04-08T23:16:24.910
> 
> 标签：google-maps, google-maps-api-3

如何将较大的地图标记图像添加到叠加层？我正在使用 KMLLayer，图标 url 在我的 KML 文件中。当我链接到较大的图标时，谷歌地图似乎缩小了它。

我尝试了 KML 的内部，但这对图像的大小没有任何影响，或者其他东西会覆盖它。

我相信它会强制它为 32x32，但对于触摸屏/信息亭应用程序，我需要至少两倍。我的图标是 64x64。

谢谢，唐

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T03:37:00.440

使用[geoxml3](https://code.google.com/p/geoxml3/)，kmz 分支，您的图标将显示为全尺寸（如果您`<scale>0</scale>`将`<scale>1</scale>`.

[http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmztest_linktoB.html?filename=http://www.geocodezip.com/geoxml3_test/doubletaketech_net_RigsB.kml](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmztest_linktoB.html?filename=http://www.geocodezip.com/geoxml3_test/doubletaketech_net_RigsB.kml)

geoxml3 在客户端解析 KML 并将标记呈现为本机 Google Maps API v3 标记。对于大数字，KmlLayer 是一个更好的选择，因为它被渲染为瓦片，但它似乎不以它们的原始大小渲染标记，并且它不[支持比例标签](https://developers.google.com/kml/documentation/kmlelementsinmaps)

看起来您的`<hotspot>`定义不正确： [http ://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmztest_linktoB.html?filename=http://www.geocodezip.com/geoxml3_test/doubletaketech_net_RigsC.kml](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmztest_linktoB.html?filename=http://www.geocodezip.com/geoxml3_test/doubletaketech_net_RigsC.kml)

# php - PHP/MySQL 下载文件

> ID：15890717
> 
> 赞同：0
> 
> 时间：2013-04-08T23:17:01.070
> 
> 标签：php, mysql

我在我的表中使用 php/mysql 我有一个名为“PDF”的列。

每行在我的网络服务器上都有一个 PDF 文件的路径，我正在使用这个 PHP 代码：

```
$sql="SELECT * from table1 where customer_sequence = '53' and invoice_number = '1234' and sequence = '7839' ";
$rs=mysql_query($sql,$conn) or die(mysql_error());
$result=mysql_fetch_Array($rs);

header('Content-disposition: attachment; filename=/path/to/file/'.$result["pdf"].'');
header('Content-type: application/pdf');
readfile('/path/to/file/'.$result["pdf"].''); 
```

SQL 工作正常，但是一旦它尝试下载它就什么也不做。

我也试过：

```
header("Location: /path/to/file/".$result["pdf"].""); 
```

但仍然没有运气 - 任何想法我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:24:05.820

好吧，让我们整理一下。首先，您不应该在标题中输出文件的完整路径。只需使用这个：

```
header('Content-disposition: attachment; filename='.$result["pdf"]); 
```

`filename`在那个标题中只是告诉浏览器一个文件名，它应该用来保存文件。

其次，`readfile()`粘贴 URL 时不遵循浏览器使用的路径。`readfile()`使用`DOCUMENT_ROOT`. 有关更多信息，您可以阅读此答案，例如：[Document Root PHP](https://stackoverflow.com/questions/11927968/document-root-php)

**编辑** 您的代码应如下所示：

```
$sql="SELECT * from table1 where customer_sequence = '53' and invoice_number = '1234'     and sequence = '7839' ";
$rs=mysql_query($sql,$conn) or die(mysql_error());
$result=mysql_fetch_Array($rs);

header('Content-disposition: attachment; filename='.$result["pdf"]);
header('Content-type: application/pdf');
readfile($_SERVER['DOCUMENT_ROOT'] . '/path/to/file/'.$result["pdf"]); 
```

# spring - Hibernate Mysql映射关系

> ID：15890722
> 
> 赞同：0
> 
> 时间：2013-04-08T23:17:29.040
> 
> 标签：spring, hibernate, spring-mvc

我不确定这是否可以在 Spring 3 框架中使用 hibernate 和 mysql 完成，但我将不胜感激。我有两个班级——员工和考官。考官是员工，员工也是考官。同时每位考官可以考查一名或多名员工，一名员工只能有一名考官。

基本上我想知道的是是否可以显示 Employee 和 Examiner 之间的继承，同时将一个单向的一对多从 Examiner 映射到 Employee？

到目前为止我所拥有的 - 具有继承约束的 Examiner 表：

```
CREATE TABLE `examiner` (
`employee_id` varchar(255) NOT NULL,
`employee_name` varchar(255) NOT NULL,
 PRIMARY KEY (`enployee_id`),
 FOREIGN KEY (`employee_id`) REFERENCES `employee` (`employee_id`)): 
```

员工表：

```
 CREATE TABLE `employee` (
`employee_id` varchar(255) NOT NULL,
`employee_name` varchar(255) DEFAULT NULL,
PRIMARY KEY (`employee_id`)): 
```

我正在考虑使用连接表来显示一对多行为，但是由于我有一个 primarykeyjoin 列，因此无法为该表获取一个复合键。

我将不胜感激任何帮助，因为我已经被难住了好几天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T14:33:07.407

Java 不允许多重继承，因此除非您使用接口，否则我不确定您打算如何使两个描述的类相互实例化。

您可以只创建一个名为 EmployeeExaminer 的类，并使其引用自身。使用注释它可能看起来像：

```
@Entity
public class EmployeeExaminer {
  @ManyToOne
  private EmployeeExaminer getExaminer() {/*...*/}

  @OneToMany
  private List<EmployeeExaminer> getEmployees() { /*...*/}
} 
```

可以在[此处](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/)找到有关注释的文档。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T13:58:28.573

感谢@CodeChimp 的回复。我最终遵循了第一个建议，并使用 @onetomany 和 @manytoone 注释创建了一个自我引用类。它的助手类有效。我只是在实现控制器和jsp页面以添加父/子时遇到一些问题。但我会为此提出一个新问题。再次感谢。

# ruby-on-rails - 用 Mongoid 建模的理想方法是什么？多个模型的问题

> ID：15890727
> 
> 赞同：2
> 
> 时间：2013-04-08T23:17:44.840
> 
> 标签：ruby-on-rails, mongoid

我注意到我可能已经创建了一个关系问题。

我从一个照片模型开始。管理员可以上传照片，它们将存在于网站上。

在后来的迭代中，相册被添加到代码库中，以便可以在自己的页面上组织一组照片。

```
Album
  has_many :photos, inverse_of: :album
Photo
  belongs_to :album, inverse_of: :photo 
```

在玩了上面的之后，我注意到一张照片只能属于一个相册。没关系。

现在出现了一个新问题。我想添加工作人员的照片，他们也是他们自己的模特。

我的照片模型中还有一些特殊的逻辑来处理使用特定的上传服务（文件选择器）。

```
Staff
  field :name, type: String 
```

我怎样才能让员工拥有自己的照片？我应该为非规范化创建一个新模型 StaffPhoto 吗？我正在考虑将照片嵌入或属于员工，但我不确定同时属于专辑和员工是否有意义。现在对我来说最有意义的事情是创建一个单独的模型并将上传服务逻辑抽象到一个模块中并将其包含在两者中。但是我可能是错的。重要的部分是 Photo 的整体将单独存在，或者是相册的一部分，或者是工作人员的一部分（多张照片）。

关于如何建模的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:21:00.240

您正在寻找的内容在指南中得到了完美的描述：http: [//guides.rubyonrails.org/association_basics.html#polymorphic-associations](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)

您可以创建一个多态关联：

```
class Photo < ActiveRecord::Base
  belongs_to :photoable, :polymorphic => true
end

class Album < ActiveRecord::Base
  has_many :photos, :as => :photoable
end

class Staff < ActiveRecord::Base
  has_many :photos, :as => :photoable
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T00:41:00.363

当您拥有属于不同所有者类别的事物时，多态关联是很好的；例如，当您有可能来自电影或电视节目的照片，并且您的数据库中已经建模了电影和电视节目时——那么您将使用多态关联来引用“所有者”对象一张照片。

通常，您不希望使用单独的模型对 Admins、Staff 和 Users 进行建模。一种更简洁的方法是将它们全部建模为用户，然后分别建模角色和权限，例如，每个人都可能是管理员。

如果您选择了这种类型的用户建模，那么您在照片模型中所需要的只是一个 user_id 来模拟所有者是谁——您不在乎那是管理员、员工还是普通用户。

如果您还想对照片的使用方式进行建模，例如，管理员照片与员工照片完全不同（例如，管理员照片是背景，员工照片是头像），那么您可能还需要指定“照片类型”归因于照片。

我不认为在你的场景中多态关联是最好的解决方案。

请查看关于角色/授权的 Railscast，这样您就可以在一个模型中对管理员/员工进行建模。

[http://railscasts.com/episodes?search=authorization](http://railscasts.com/episodes?search=authorization)

* * *

关于嵌入式文档：

使用嵌入式文档的注意事项很少：

*   嵌入文档是否增加/丰富了父文档？
*   不超过 16MB 的 MongoDB 记录大小
*   如果您需要搜索所有嵌入式文档

如果是照片，您可能希望嵌入对照片的引用，而不是照片本身，因为照片可能具有较大的尺寸。

对于您的应用程序，用户有多少张照片？随着时间的推移，它们的数量会增长到可观的数量吗？如果是，那么您可能不想嵌入它们。

照片是否增加了用户记录？例如，它是头像照片吗？如果没有，那么您可能不想嵌入它。

您是否需要搜索照片？可能不是。其他类型的嵌入文档可能需要从顶层搜索，然后您无法嵌入它们。

# c++ - 模板类问题；正确的模板签名？

> ID：15890728
> 
> 赞同：0
> 
> 时间：2013-04-08T23:17:55.927
> 
> 标签：c++, templates

我正在实现一个模板类，但我不确定我的签名是否正确。下面我包含了我的代码示例，显示了我担心的几种情况：

我的地图.h：

* * *

```
#ifndef MAP_H
#define MAP_H
#include <iostream>
#include <string>

using namespace std;

template <typename KEY, typename T>
class Map{
private:
    struct Elem {

    };

public:

    Map();
    // constructs empty Map

    Map(const Map &rhs);

    ~Map();

    Map& operator=(const Map &rhs);

    bool insert(KEY, T);

    T& operator[](KEY);

};

template<typename KEY, typename T>
ostream& operator<< (ostream&, const Map<KEY, T>&);

#include "mymap.cpp"

#endif 
```

* * *

现在是 .cpp 文件：

* * *

```
#include mymap.h
#include <iostream>
#include <string>

using namespace std;

//Assingment Operator
template < typename KEY , typename T >
Map< KEY , T >& Map< KEY , T >::operator=(const Map &rhs){

    //Avoid self assignment
    if( this != &rhs ){

         //Snip
    }

    return *this;
}

//Insert, return true if successful.
template < typename KEY , typename T >
bool Map< KEY , T >::insert(KEY, T){

    //Snip
} 
```

* * *

正如你所看到的，我相信你们都很清楚，模板签名可能会从我所读到的内容中变得非常混乱。这看起来是否正确，或者我是否有一些更熟练的眼睛很容易注意到的致盲错误？

我知道有一百万篇关于模板的帖子，我已经阅读了一些关于它们的指南，但在这个特定问题上我仍然找不到太多。

**此外，在不可避免的“摆脱使用命名空间标准”注释出现之前，我将其包括在内以进行调试，它*最终*会消失，我保证:)**

谢谢！

* * *

编辑：很抱歉造成混乱，我似乎错过了我帖子的一个非常重要的部分......错误！

我有大约 5 个，所有这些都有不同的行号：

```
mymap.cpp:41:1: error: ‘Map’ does not name a type 
```

和相同数量的：

```
expected initializer before ‘&lt;’ token 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:54:17.143

`#include mymap.h`从_`mymap.cpp`

然后

```
#include "mymap.h" 
```

在`test.cpp`

并编译它

```
g++ -g test.cpp 
```

对于模板类，所有内容都必须在标题中。

# ruby - 为什么在 Ruby 中捕获命名组会导致“未定义的局部变量或方法”错误？

> ID：15890729
> 
> 赞同：4
> 
> 时间：2013-04-08T23:18:01.720
> 
> 标签：ruby, regex, exception, capture

我在 Ruby 2.0 中的正则表达式中遇到命名捕获问题。我有一个字符串变量和一个插值的正则表达式：

```
str = "hello world"
re = /\w+/
/(?<greeting>#{re})/ =~ str
greeting 
```

它引发以下异常：

> prova.rb:4:in `<main>': undefined local variable or method`greeting' for main:Object (NameError)
> shell 返回 1

但是，插值表达式在没有命名捕获的情况下工作。例如：

```
/(#{re})/ =~ str
$1
# => "hello" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T23:32:14.967

## 命名捕获必须使用文字

您遇到了 Ruby 正则表达式库的一些限制。Regexp [#=~](http://ruby-doc.org/core-2.1.5/Regexp.html#method-i-3D-7E)方法限制命名捕获如下：

*   如果正则表达式不是文字，则不会发生赋值。
*   正则表达式插值 ,`#{}`也会禁用赋值。
*   如果将正则表达式放在右侧，则不会发生赋值。

您需要决定是否要在正则表达式中命名捕获或插值。您目前不能同时拥有两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T23:23:02.723

分配结果`#match`；这将作为哈希访问，允许您查找命名的捕获组：

```
> matches = "hello world".match(/(?<greeting>\w+)/)
=> #<MatchData "hello" greeting:"hello">
> matches[:greeting]
=> "hello" 
```

或者，给出`#match`一个块，它将接收匹配结果：

```
> "hello world".match(/(?<greeting>\w+)/) {|matches| matches[:greeting] }
=> "hello" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-06T17:43:32.053

作为两个答案的附录，以使其一目了然：

```
str = "hello world"
# => "hello world"
re = /\w+/
# => /\w+/
re2 = /(?<greeting>#{re})/
# => /(?<greeting>(?-mix:\w+))/
md = re2.match str
# => #<MatchData "hello" greeting:"hello">
md[:greeting]
# => "hello" 
```

插值适用于命名捕获，只需使用 MatchData 对象，最容易通过`match`.

# java - jar 文件中的属性文件（用户设置）

> ID：15890730
> 
> 赞同：0
> 
> 时间：2013-04-08T23:18:03.623
> 
> 标签：java, properties, jar, embedded-resource, executable-jar

我有一个想要打包为 jar 文件的 Swing 应用程序。我还有一个存储用户设置属性的属性文件。

我可以将此文件存储在 jar 文件中，并且应用程序会自动写入 jar 文件吗？

我想避免有两个文件，jar 和它的外部属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:19:22.997

你*可以*，但这并不意味着你*应该*。

相反，捆绑一个默认属性文件，但检查一组用户特定的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:23:41.727

您当然可以将属性文件捆绑`jar`在`read-only`. 因此，您将无法在其中写入任何内容。

# eclipse - EGit 克隆对话框：从内容辅助建议中清除旧 URI

> ID：15890733
> 
> 赞同：1
> 
> 时间：2013-04-08T23:18:22.263
> 
> 标签：eclipse, egit

如何在 Eclipse Juno 的“克隆 Git 存储库”对话框中删除旧的 URI？

如果您按住 CTRL 和按空格键，您将获得您曾经使用过的所有 URI 的列表。我想删除除其中一个之外的所有内容。如果这只能通过在某处编辑文件来实现，我想知道该文件的名称和位置。

我已经尝试卸载然后重新安装 EGit，但它们仍然存在。这些信息存储在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T20:53:58.783

通过 URI 字段中的内容辅助可用的 URI 存储在工作区文件夹中的以下文件中：

`.metadata/.plugins/org.eclipse.egit.ui/dialog_settings.xml`

您可以在 Eclipse 未运行时手动编辑它，下次启动 Eclipse 时将被拾取。

# vb.net - 从文本文件导入数据

> ID：15890735
> 
> 赞同：1
> 
> 时间：2013-04-08T23:18:50.260
> 
> 标签：vb.net

好的，所以我正在进行全面检修。多亏了你，我才能正常工作几个月！但正如你所说，我应该修改它以更好地理解。所以我尝试添加另外 2 个列表框来测试。该计划现在正在测试里程碑（年龄 - 10 岁到 100 岁）。我编辑了代码，但我不知道要检查哪一行才能从测试月份更改为年份？所以我添加的新列表框显示了与月份测试相同的信息，而不是我想要完成的内容。例如：John Doe 4/9/2003 将出现在“10”里程碑中。

```
 Private Sub lbMonth_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles lbMonth.SelectedIndexChanged
    If lbMonth.SelectedIndex < 0 Then Return
    lbPerson.Items.Clear()
    Dim index As Integer = lbMonth.SelectedIndex
    For Each ele In Birthdays(index + 1)
        lbPerson.Items.Add(ele)
    Next
End Sub

Private Sub lbMilestone_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles lbMilestone.SelectedIndexChanged
    If lbMilestone.SelectedIndex < 0 Then Return
    lbPerson2.Items.Clear()
    Dim index As Integer = lbMilestone.SelectedIndex
    For Each ele2 In Birthdays2(index)
        lbPerson2.Items.Add(ele2)
    Next
End Sub

Private Birthdays(12) As List(Of String)
Private Birthdays2(10) As List(Of String)

Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load
    'initialize the Month list
    lbMonth.Items.Clear()
    lbMonth.Items.Add("January")
    lbMonth.Items.Add("February")
    lbMonth.Items.Add("March")
    lbMonth.Items.Add("April")
    lbMonth.Items.Add("May")
    lbMonth.Items.Add("June")
    lbMonth.Items.Add("July")
    lbMonth.Items.Add("August")
    lbMonth.Items.Add("September")
    lbMonth.Items.Add("October")
    lbMonth.Items.Add("November")
    lbMonth.Items.Add("December")

    lbMilestone.Items.Clear()
    lbMilestone.Items.Add("10")
    lbMilestone.Items.Add("20")
    lbMilestone.Items.Add("30")
    lbMilestone.Items.Add("40")
    lbMilestone.Items.Add("50")
    lbMilestone.Items.Add("60")
    lbMilestone.Items.Add("70")
    lbMilestone.Items.Add("80")
    lbMilestone.Items.Add("90")
    lbMilestone.Items.Add("100")
    'initialize the Lists (Instance required in order to access each list-object)
    For i As Integer = 0 To 12
        Birthdays(i) = New List(Of String)
    Next

    For j As Integer = 0 To 10
        Birthdays2(j) = New List(Of String)
    Next

    'load some birthdays
    Dim filename As String = Application.StartupPath + "\Birthday.txt"
    If Not My.Computer.FileSystem.FileExists(filename) Then Throw New Exception("Filename """ + filename + """ does not exist!")

    Dim fileContent As String = My.Computer.FileSystem.ReadAllText(filename)
    Dim lines() As String = Split(fileContent, vbCrLf)
    For Each ele As String In lines
        Dim line As String = ele.Trim
        Dim datePos As Integer = line.LastIndexOf(vbTab) 'find last space between name and date
        If datePos < 5 Then Continue For 'if full name is less than 5 chars, then it probably not a line with an entry
        Dim dateString As String = Mid(line, datePos + 2) 'all after that last space is date
        Dim name As String = Mid(line, 1, datePos).Trim ' all before that last space is name
        'Dim birthday As Date = Convert.ToDateTime(parts(1).Trim) ' used this conversion before, but lets try the other way
        Dim birthday As Date
        Try
            birthday = DateTime.ParseExact(dateString, "M/d/yyyy", System.Globalization.CultureInfo.GetCultureInfo("en-US"))
        Catch ex As Exception
            Continue For
        End Try

        Dim month As Integer = birthday.Month
        Dim year As Integer = CInt(Date.Now.Subtract(birthday).TotalDays / 365 / 10)
        Birthdays(month).Add(name)
        Birthdays2(year).Add(name)
    Next

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T01:12:51.403

创建一个新项目并添加 2 个列表框。命名一个列表框**lbMonth**，另一个**lbPerson**

然后插入以下代码：

```
Private Sub lbMonth_SelectedIndexChanged(sender As Object, e As EventArgs) Handles lbMonth.SelectedIndexChanged
    If lbMonth.SelectedIndex < 0 Then Return
    lbPerson.Items.Clear()
    Dim index As Integer = lbMonth.SelectedIndex
    For Each ele In Birthdays(index + 1)
        lbPerson.Items.Add(ele)
    Next
End Sub

Private Birthdays(12) As List(Of String)

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles Me.Load
    'initialize the Month list
    lbMonth.Items.Clear()
    lbMonth.Items.Add("January")
    lbMonth.Items.Add("February")
    lbMonth.Items.Add("March")
    lbMonth.Items.Add("April")
    lbMonth.Items.Add("May")
    lbMonth.Items.Add("June")
    lbMonth.Items.Add("July")
    lbMonth.Items.Add("August")
    lbMonth.Items.Add("September")
    lbMonth.Items.Add("October")
    lbMonth.Items.Add("November")
    lbMonth.Items.Add("December")

    'initialize the Lists (Instance required in order to access each list-object)
    For i As Integer = 0 To 12
        Birthdays(i) = New List(Of String)
    Next

    'load some birthdays
    Dim filename As String = Application.StartupPath + "\names.txt"
    If Not My.Computer.FileSystem.FileExists(filename) Then Throw New Exception("Filename """ + filename + """ does not exist!")

    Dim fileContent As String = My.Computer.FileSystem.ReadAllText(filename)
    Dim lines() As String = Split(fileContent, vbCrLf)
    For Each ele As String In lines
        Dim line As String = ele.Trim
        Dim datePos As Integer = line.LastIndexOf(" ") 'find last space between name and date
        If datePos < 5 Then Continue For 'if full name is less than 5 chars, then it probably not a line with an entry
        Dim dateString As String = Mid(line, datePos + 2) 'all after that last space is date
        Dim name As String = Mid(line, 1, datePos).Trim ' all before that last space is name
        'Dim birthday As Date = Convert.ToDateTime(parts(1).Trim) ' used this conversion before, but lets try the other way
        Dim birthday As Date
        Try
            birthday = DateTime.ParseExact(dateString, "M/d/yyyy", System.Globalization.CultureInfo.GetCultureInfo("en-US"))
        Catch ex As Exception
            Continue For
        End Try
        Dim month As Integer = birthday.Month
        Birthdays(month).Add(name)
    Next

End Sub 
```

您需要将生日文件名重命名为“names.txt”，并可能将其放置到 project/bin/Debug 或您运行程序可执行文件的任何其他位置。

异常应该可以帮助您找到正确的路径。

**更新**

并确保两个列表框都相对较大（可以显示全部 12 个月）。

测试程序。当您选择第 7 个月或第 8 个月时，您应该会看到一些情况（如果您使用列出的 3 个条目）

**更新2**

如果文件包含包含无效数据的空行/行，我已经通过添加 Try..Catch 块来修复异常来修改代码。

只需替换项目中的代码。

还请确保在文本文件中使用的是 " " 空格，而不是制表符。如果使用制表符，则替换

```
Dim datePos As Integer = line.LastIndexOf(" ") 
```

和

```
Dim datePos As Integer = line.LastIndexOf(vbTab) 
```

这次祝你好运 :) 如果它仍然失败，那么我们可以将字符串转换为函数并进行更多测试，或者甚至通过获取所有 3 个数字来手动进行更多操作，然后创建一个新的日期日期, 月, 年 (每个都是整数)

**更新3**

将生日数组更改为具有 13 个字段（0 到 12，0 不再使用）

更改为也初始化所有 13 个字段

更改为从 index+1 读取，因为 1 月为 index 0，2 月为 index 1 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T01:50:55.037

因此，让我们更改以下内容（顺便说一句。使用 days/365 的好主意）：

```
 Dim month As Integer = birthday.Month
    Dim year As Integer = CInt(Date.Now.Subtract(birthday).TotalDays / 365)
    Birthdays(month).Add(name) 
```

你想有 10 年的步数，所以将年份除以 10

```
 Dim month As Integer = birthday.Month
    Dim year As Integer = CInt(Date.Now.Subtract(birthday).TotalDays / 365 / 10)
    Birthdays(month).Add(name) 
```

而且您还需要将计算出的年份信息用于某事..让我们填写另一个字段:)

```
 Dim month As Integer = birthday.Month
    Dim year As Integer = CInt(Date.Now.Subtract(birthday).TotalDays / 365 / 10)
    Birthdays(month).Add(name)
    Birthdays2(year).Add(name) 
```

现在检查另一部分..

```
Private Sub lbMilestone_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles lbMilestone.SelectedIndexChanged
    If lbMilestone.SelectedIndex < 0 Then Return
    lbPerson2.Items.Clear()
    Dim index As Integer = lbMilestone.SelectedIndex
    For Each ele2 In Birthdays(index + 1)
        lbPerson2.Items.Add(ele2)
    Next
End Sub 
```

大部分是正确的，但是您从“旧”月份列表中读取

```
 For Each ele2 In Birthdays(index + 1) 
```

所以将行更改为

```
 For Each ele2 In Birthdays2(index + 1) 
```

而且我认为 10 应该代表年龄 0-9 岁，因此如果单击第一个元素（索引 = 0），则应返回来自 Birthdays2(0) 的人员。（= 删除**+ 1**）

```
 For Each ele2 In Birthdays(index) 
```

因此该方法应如下所示：

```
Private Sub lbMilestone_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles lbMilestone.SelectedIndexChanged
    If lbMilestone.SelectedIndex < 0 Then Return
    lbPerson2.Items.Clear()
    Dim index As Integer = lbMilestone.SelectedIndex
    For Each ele2 In Birthdays(index)
        lbPerson2.Items.Add(ele2)
    Next
End Sub 
```

**更新**

更改方法以使用另一个子：

```
 [...]
        Dim dateString As String = Mid(line, datePos + 2) 'all after that last space is date
        Dim name As String = Mid(line, 1, datePos).Trim ' all before that last space is name
        'Dim birthday As Date = Convert.ToDateTime(parts(1).Trim) ' used this conversion before, but lets try the other way
        AddUser(name, dateString)
    Next

End Sub 
```

这里是子：（您看到它几乎是 1:1，除了**Exit 子**，因为没有 for 循环可以退出，但由于该方法包含执行到循环结束的所有代码，因此是一个**退出子**这里的作用与以前版本中的**continue**相同。

```
Private Sub AddUser(Name As String, dateString As String)
    Dim birthday As Date
    Try
        birthday = DateTime.ParseExact(dateString, "M/d/yyyy", System.Globalization.CultureInfo.GetCultureInfo("en-US"))
    Catch ex As Exception
        Exit Sub
    End Try

    Dim month As Integer = birthday.Month
    Birthdays(month).Add(Name)

    Dim year As Integer = CInt(Date.Now.Subtract(birthday).TotalDays / 356 / 10)
    Birthdays2(year).Add(Name)
End Sub 
```

现在当用户输入新数据时，您只需要调用该方法

```
AddUser("new name", "1/2/1934") 
```

或带变量

```
AddUser(tbYour_name_textbox, tbYour_birthday_date_textbox) 
```

# ruby-on-rails - Rails：向 ActiveRecord 模型添加方法

> ID：15890736
> 
> 赞同：2
> 
> 时间：2013-04-08T23:18:50.830
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在编写我的第一个相当简单的 Ruby on Rails (3.2) 应用程序。这个想法是管理电子邮件帐户。架构相当简单：

```
t.string   "email"
t.string   "password" 
```

ActiveRecord 模型定义为：

```
class Mailuser < ActiveRecord::Base
  attr_accessible :email, :password 
```

我一直在使用带有所有魔法`form_for(@mailuser)`的脚手架。`@mailuser.update_attributes(params[:mailuser])`效果很好。

现在的怪癖是应该只允许用户编辑电子邮件的*用户部分（例如“foo”），而**域*（例如“example.org”）必须保持不变。然而，*电子邮件*字段包含完整的电子邮件地址（例如“foo@example.org”）。所以在编辑表单中我不显示字段

*   电子邮件
*   密码

反而

*   用户部分
*   密码

其中`userpart`显示为`@mailuser.userpart`（可编辑）+*域*（不可编辑）。

所以我想我可以通过为用户部分添加一个getter和setter来解决这个问题：

```
class Mailuser < ActiveRecord::Base
   attr_accessible :email, :password

   # Getter for the user part (left of '@')
   def userpart
      email.split('@')[0]
   end

   # Setter for the user part (left of '@')
   def userpart=(new_userpart)
      email = email.sub(/(.+)@/, new_userpart+"@")
   end 
```

事实上，得到`@mailuser.userpart`很好的作品。它甚至可以正确显示在`form_for(@mailuser)`. `@mailuser.update_attributes(params[:mailuser])`但是使用控制器的`update`方法保存表单时会出现问题。Rails 显然试图`@mailuser`从通过`attr_accessible`. 但该`userpart`属性并不反映实际的数据库字段。

所以我想知道将这些方法添加到 ActiveRecord 模型以添加功能的正确方法是什么？我习惯了 Pylons（一个 Python MVC 框架），我可以一直使用这样的附加方法。

（事实上​​你想知道：我不能通过更改数据库模式来拆分用户和域部分。数据库被其他应用程序使用，所以我坚持它的外观。）

*提前致谢。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:28:59.863

您要添加`attr_accessible :userpart`以便可以通过 update_attributes 批量分配更新 userpart。

补充：userpart是一个*虚拟属性*的例子，如果你想问谷歌先生更详细的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T11:42:59.537

解决方案的关键是*虚拟属性*。在我的示例中，实际的解决方案是：

*   分配`self.email`而不是`email`更改实例变量的值。使用刚刚`email`创建的局部变量。（我不知道离开`self`只是 Ruby 的一个便利功能，在这种情况下可能会导致混淆。）
*   `attr_accessible :userpart`在模型中使用

这在（非免费）[http://railscasts.com/episodes/16-virtual-attributes-revised?autoplay=true](http://railscasts.com/episodes/16-virtual-attributes-revised?autoplay=true)截屏视频中有很好的解释。我想知道Rails 官方文档在哪里解释了*虚拟属性。*

# core-data - 在有数据之前显示一个 tableviewcell

> ID：15890742
> 
> 赞同：-1
> 
> 时间：2013-04-08T23:19:35.137
> 
> 标签：core-data, uitableview

对不起，但我是新手，我正在尝试理解一些事情，据我所知，表格视图加载数据，然后由单元格（动态）以开发人员想要并保持的方式/设计分发记住模型对象。

我知道这是一个奇怪的问题，但我一直在努力尝试做相反的事情：

1 - 表格视图加载带有一些文本字段的单元格。

2 - 用户填写文本字段。

3 - 用户按下保存，一切都保存在核心数据中。

4 - 表格视图具有编辑模式，因此用户可以插入更多单元格，并且该过程会重复。

所以我想要的是一种表格，表格视图首先加载单元格（所以还没有数据，用户想看到要填充的东西:)）然后填充文本字段，这将产生数据。因此，鉴于确实加载了，我将有一个没有任何内容的数组启动...我这么说是因为我看到了很多示例，并且它们总是以某种数据开头，例如 A、B、C 等...或颜色...我知道这只是一个例子，但我不想从数据开始。

我的问题是，这可能吗？我错过了什么？

谢谢，问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:33:41.367

一点也不奇怪，你当然可以这样做。毕竟，通讯录应用程序不就是这样吗？如果你没有联系人，你可以做一个。你看到了什么？一堆可以填写的空白字段。

您可以在没有 Core Data 的情况下实现它，也可以使用 Core Data 来实现。

您看过 Apple 的基本核心食谱示例吗？这不就是它的意思吗？它从没有食谱开始。你加一些。

> 我错过了什么？

我不知道。什么是你不知道的？你了解如何自定义表格的 UITableViewCells 吗？你了解什么是 UITextField 以及它是如何工作的吗？然后制作一个表格视图，其单元格包含 UITextFields 并使用文本字段委托来了解用户在做什么。

一个令人难以置信的巧合，我有一些你可以下载的代码，它几乎完全符合你的描述（“PeopleLister”）。它开始完全是空的。这是用户添加了一些组和人员后的界面：

![在此处输入图像描述](https://i.stack.imgur.com/hdBTy.png)

了解用户如何单击**+**按钮来创建新的空白人员（两个空白文本字段），然后可以填写名字和姓氏。你描述的不是这个吗？

这是没有核心数据的版本：

[https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch36​​p901peopleGroups](https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch36p901peopleGroups)

这是带有核心数据的版本：

[https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch36​​p901peopleGroups2](https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch36p901peopleGroups2)

这是我书中的部分，我介绍了如何使用表格视图单元格中的文本字段：

[http://www.aeth.com/iOSBook/ch21.html#_editable_content_in_table_items](http://www.apeth.com/iOSBook/ch21.html#_editable_content_in_table_items)

以下是 PeopleLister 示例的讨论：

[http://www.aeth.com/iOSBook/ch36​​.html#_the_document_architecture](http://www.apeth.com/iOSBook/ch36.html#_the_document_architecture)

# python - 如何将每个 x 个元素拆分一个列表并将这些 x 个元素添加到一个新列表中？

> ID：15890743
> 
> 赞同：24
> 
> 时间：2013-04-08T23:19:40.170
> 
> 标签：python, list, loops, indexing, split

我有多个整数和字符串的列表

`['-200', ' 0', ' 200', ' 400', ' green', '0', '0', '200', '400', ' yellow', '200', '0', '200', '400', ' red']`

我很难将每个列表分开`5 elements`并创建一个只有 5 个元素的新列表。

但是，我不想要 3 个不同的列表，我只想要一个在每次有新列表时都会更改的列表`5 elements`。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-08T23:29:39.437

你想要这样的东西：

```
composite_list = [my_list[x:x+5] for x in range(0, len(my_list),5)]

print (composite_list) 
```

输出：

```
[['-200', ' 0', ' 200', ' 400', ' green'], ['0', '0', '200', '400', ' yellow'], ['200', '0', '200', '400', ' red']] 
```

“新”5 个元素是什么意思？

如果要附加到此列表，可以执行以下操作：

```
composite_list.append(['200', '200', '200', '400', 'bluellow']) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-08T23:30:02.750

你可以用一句话来做到这一点

```
>>> import math
>>> s = ['-200', ' 0', ' 200', ' 400', ' green', '0', '0', '200', '400', ' yellow', '200', '0', '200', '400', ' red']
>>> [s[5*i:5*i+5] for i in range(0,math.ceil(len(s)/5))] 
```

那么输出应该是：

```
[['-200', ' 0', ' 200', ' 400', ' green'], ['0', '0', '200', '400', ' yellow'], ['200', '0', '200', '400', ' red']] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-08T23:30:45.747

我觉得您必须创建 1 个新列表，但如果我理解正确，您需要一个嵌套列表，每个子列表中有 5 个元素。

您可以尝试以下方法：

```
l = ['-200', ' 0', ' 200', ' 400', ' green', '0', '0', '200', '400', ' yellow', '200', '0', '200', '400', ' red']

new = []
for i in range(0, len(l), 5):
    new.append(l[i : i+5]) 
```

这将逐步遍历您的第一个列表“l”，并将 5 个元素组合到 new 中的子列表中。输出：

```
[['-200', ' 0', ' 200', ' 400', ' green'], ['0', '0', '200', '400', ' yellow'], ['200', '0', '200', '400', ' red']] 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-04T19:24:12.553

我在之前的[回答](https://stackoverflow.com/a/44104805/2750492)中详细介绍了一种稍微不同的方法，使用`zip`. 先前的答案已作为此答案的副本关闭，因此我在此处添加我的答案以供参考。

您可以使用`iter`和将列表分块`zip`。

```
def chunk(lst, n):
    return zip(*[iter(lst)]*n) 
```

例子：

```
In []:
data = ['-200', ' 0', ' 200', ' 400', ' green', '0', '0', '200', '400',
        ' yellow', '200', '0', '200', '400', ' red']

for l in chunk(data, 5):
    print(l)

Out[]:
('-200', ' 0', ' 200', ' 400', ' green')
('0', '0', '200', '400', ' yellow')
('200', '0', '200', '400', ' red') 
```

如果您希望它们在列表中，则：

```
In []:
list(chunk(data, 5))

Out[]:
[('-200', ' 0', ' 200', ' 400', ' green'), ('0', '0', '200', '400', ' yellow'),  
 ('200', '0', '200', '400', ' red')] 
```

解释：

```
def chunk(lst, n):
    it = iter(lst)       # creates an iterator
    its = [it]*n         # creates a list of n it's (the same object)
    return zip(*its)     # unpack the list as args to zip(), e.g. when `n=3` - zip(it, it, it) 
```

因为它`zip()`在相同的迭代器`n`时间上运行，所以它会将原始数据`lst`分块成`n`.

在 Py3 中，这是惰性的（`zip()`返回一个迭代器），所以只会`n`根据需要创建块，如果你有一个很大的原始列表，这可能很重要。

# python - 操作数之间的多个运算符

> ID：15890745
> 
> 赞同：5
> 
> 时间：2013-04-08T23:19:44.163
> 
> 标签：python

有人可以解释为什么 Python 解释器（2.7.3）给出以下内容：

```
>>> 5 -+-+-+ 2

3 
```

这有用吗，有什么目的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-08T23:23:59.400

您可以`dis`在此处查看表达式的实际评估方式：

```
In [29]: def func():
   ....:     return 5 -+-+-+ 2
   ....: 

In [30]: import dis

In [31]: dis.dis(func)
  2           0 LOAD_CONST               1 (5)
              3 LOAD_CONST               2 (2)
              6 UNARY_POSITIVE      
              7 UNARY_NEGATIVE      
              8 UNARY_POSITIVE      
              9 UNARY_NEGATIVE      
             10 UNARY_POSITIVE      
             11 BINARY_SUBTRACT     
             12 RETURN_VALUE 
```

所以这个表达式等价于：

```
In [32]: 5 - (+(-(+(-(+(2))))))
Out[32]: 3 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-08T23:23:31.427

这等于

```
5 - (+(-(+(-(+2))))) 
```

其中除第一个之外的所有 + 和 - 都是一元运算符。对于数字，`+`返回未更改的操作数。`__pos__`但是，可以使用您自己的类上的特殊方法来覆盖它的含义。

用数字来做这件事是没有用的，但如果你使用带有自定义`__neg__`和/或`__pos__`操作的类实例，它可能很有用（如果令人难以置信的混乱）。

* * *

您可以滥用它来获得类似 C 的预增量`--`和`++`运算符。永远不要真的这样做。

```
class IncrementableInteger(object):
    def __init__(self, val=0):
        self.val = val
    def __pos__(self):
        class PlusOne:
            def __pos__(_self):
                self.val += 1
        return PlusOne()
    def __neg__(self):
        class MinusOne:
            def __neg__(_self):
                self.val -= 1
        return MinusOne()
    def __str__(self):
        return str(self.val)
    def __repr__(self):
        return repr(self.val) 
```

例子：

```
>>> IncrementableInteger(4)
4
>>> v=_
>>> ++v
>>> v
5 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T23:26:03.793

除了混淆代码之外，我没有看到任何实用程序。

对此的评价是：

```
5 -+-+-+ 2 = 5 -(+(-(+(-(+ 2)))))
           = 5 -(+(-(+(- 2))))
           = 5 -(+(-(- 2)))
           = 5 -(+(+ 2))
           = 5 -(+ 2)
           = 5 - 2
           = 3 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-08T23:26:28.677

它是这样解释的：

```
5 - (+(-(+(-(+2))))) 
```

你可以写`-a`得到否定的`a`。为了对称和“为什么不呢？” 您还可以使用加号前缀，例如`+a`.

添加多个符号并不是很有用，但它是允许的，可能是因为它恰好在语法中是合法的，没有人认为需要明确禁止它。

# vector - 使用矢量类中的基础数组进行 fwrite 时出现 EXC_BAD_ACCESS 错误

> ID：15890753
> 
> 赞同：0
> 
> 时间：2013-04-08T23:20:28.413
> 
> 标签：vector, exc-bad-access, zlib, fwrite

我被这个 EXC_BAD_ACCESS 错误难住了。我正在使用 zlib 将数组 ch 中的一些数据压缩并保存在函数 deflateReadOut 中，该函数从函数 generate 中调用。程序在标记行的 fwrite 处失败。

```
class WSUMap {
public:

vector<vector <unsigned char> > chunk;
int xComp[4];
int yComp[4];
vector<int> priority;
Hash hashChunk;

WSUMap()
{
    chunk.resize(4);
    chunk[0] = vector<unsigned char>(CHUNK);
    chunk[1] = vector<unsigned char>(CHUNK);
    chunk[2] = vector<unsigned char>(CHUNK);
    chunk[3] = vector<unsigned char>(CHUNK);
    priority.push_back(0);
    priority.push_back(1);
    priority.push_back(2);
    priority.push_back(3);
    xComp[0] = -1;
    xComp[1] = -1;
    xComp[2] = -1;
    xComp[3] = -1;
    yComp[0] = -1;
    yComp[1] = -1;
    yComp[2] = -1;
    yComp[3] = -1;
}

void generate() {
    for (int i = 0; i<CHUNK; i++) {
        chunk[0][i]=100;
    }
    for (int i = 0; i < 16; i++) {
        for (int j = 0; j < 16; j++) {
            cout << chunk[0][0] << endl;
            unsigned char* ch = &chunk[0][0];
            cout << ch[0] << endl;
            deflateReadOut(i, j, &chunk[0][0]);
        }
    }
}

void deflateReadOut(int x, int y, unsigned char* ch) {
    int ret, flush;
    unsigned have;
    z_stream strm;
    vector<unsigned char> out = vector<unsigned char>(CHUNK);
    out.resize(CHUNK);

    /* allocate deflate state */
    strm.zalloc = Z_NULL;
    strm.zfree = Z_NULL;
    strm.opaque = Z_NULL;
    ret = deflateInit(&strm, Z_DEFAULT_COMPRESSION);
    if (ret != Z_OK) assert(true);
    //return ret;

    ostringstream oss;
    oss << "map/" << x << "x" << y;
    string str = oss.str();
    cout << str << endl;
    FILE* dest = fopen(str.c_str(), "w");

    /* run deflate() on input until output buffer not full, finish
       compression if all of source has been read in */
    do {
        strm.avail_out = CHUNK;
        strm.avail_in = CHUNK;
        strm.next_in = ch;
        strm.next_out = &out[0];

        ret = deflate(&strm, Z_FINISH); /* no bad return value */
        assert(ret != Z_STREAM_ERROR); /* state not clobbered */

        have = CHUNK - strm.avail_out;
        if (fwrite(&out[0], 1, have, dest) != have || ferror(dest)) {//ERROR HERE
            (void) deflateEnd(&strm);
            //return Z_ERRNO;
        }

    } while (strm.avail_out == 0);
    assert(strm.avail_in == 0); /* all input will be used */

    /* clean up and return */
    (void) deflateEnd(&strm);
} 
```

感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T23:38:39.167

我想到了。我试图写入一个不存在的目录，我认为如果它不存在它会自动创建它。

# java - 大型、昂贵数据集的 Swing 自动完成

> ID：15890757
> 
> 赞同：0
> 
> 时间：2013-04-08T23:20:53.343
> 
> 标签：java, swing, autocomplete

我正在尝试为 Swing 实现自动完成，`JTextField`其中可能的自动完成条目集可能很大（10-100K 项）并且检索起来很昂贵，但搜索条目集相当便宜。谁能指出一个好的解决方案，最好是图书馆的形式？我查看了[SwingX autocomplete](http://www.jdocs.com/swingx/1.0/org/jdesktop/swingx/autocomplete/)，但它不是为您没有索引访问的情况而设计的。

* * *

**更新：**由于显然不清楚，问题不在于搜索大量条目是昂贵的（不是），而是在这种特殊情况下**获取**完整的条目集是昂贵且不切实际的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T18:57:29.553

我对[Glazed Lists](http://www.glazedlists.com/)很幸运。这是假设您可以将整个数据集加载到内存中并将其保存在那里。我已经完成了 20K 左右的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T17:43:54.490

我最终在[这个答案中找到了 Samuel Sjöberg 的“](https://stackoverflow.com/a/13447247/27358) [Autocompletion in Swing](http://samuelsjoberg.com/archive/2009/10/autocompletion-in-swing) ”，并在此基础上实现了以下解决方案。

```
public class MyAutocompleteDocument extends DefaultStyledDocument {

  @Override
  public void insertString ( int offs, String str, AttributeSet a ) throws BadLocationException
  {
    if ( !StringUtils.isBlank( str ) )
    {
        String text = getText( 0, offs ); // Current text up to insert point
        String completion = complete( text + str ); // Full completed string

        if (!StringUtils.isBlank( completion )) { // not "" or null
            String textToInsert = completion.substring( offs );

            // Always overwrite on complete
            int oldLength = getLength();
            remove( offs, oldLength - offs );
            super.insertString( offs, textToInsert, a );

            // Select the auto-completed portion so it's easy to keep typing
            owner.select( offs + str.length(), getLength() );
        } else {
            super.insertString( offs, str, a );
        }
    }
  }

  private String complete(String startsWith) {
      // access service to search for completion
  }
} 
```

不确定它是否适用于所有情况，但它似乎涵盖了我的。

# c# - XAML - 简单自定义控件的简单动画

> ID：15890762
> 
> 赞同：5
> 
> 时间：2013-04-08T23:21:05.667
> 
> 标签：c#, xaml, windows-store-apps

我正在使用 C# 开发 Windows 应用商店应用程序，遇到了一些我无法想象的困难，但我不知道该怎么做。

在我的`MainPage.xaml`我创建了一个用户控件：一个`StackPanel`水平方向，只有一个`Image`和一个`TextBlock`内部。像这样：

```
<!-- language: lang-xml -->
<StackPanel Width="300" Height="100" Orientation="Horizontal" Margin="0,0,0,20" Tapped="LoremIpsum_Tapped">
    <Image Source="/Assets/pic.jpg" Margin="20"/>
    <TextBlock FontFamily="Segoe UI" FontSize="30" VerticalAlignment="Center">
        Lorem Ipsum
    </TextBlock>
</StackPanel> 
```

看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/sGQLI.png)

我将它用作一种自定义类型的按钮来访问某些子页面。现在的问题是，**没有动画**。我想拥有`ListItem`SplitView 中的典型动画：按下时收缩，释放时或指针退出控件的虚拟边框时恢复正常。我找不到与那些 ListItems (Common. `StandardStyles.xaml` `Standard130ItemTemplate`) 关联的动画声明/定义。但我发现（[在这里](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh452701.aspx#pointer)）有预定义的动画：`PointerDownThemeAnimation`和`PointerUpThemeAnimation`。但是后来我花了很长时间才弄清楚如何将它们应用于控件。[您可能认为本网站上特别提到的关于那些指针主题动画](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/jj649432.aspx)（关于 C#）的示例应该有所帮助，但它会导致[HTML/Javascript 动画示例](http://code.msdn.microsoft.com/windowsapps/using-the-animation-787f3720/)。但我在[这里](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/ab9e46ff-4a49-4edc-bf55-7504ed56350d)、[这里](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh452703.aspx)和[这里](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.animation.pointerdownthemeanimation.aspx)找到了解决方案。

所以我需要`Storyboard`控件资源中的 s，一个名称，以便控件可以成为目标，并在代码隐藏中使用事件处理程序。

应用在我的 XAML 上，它变成了这样：

```
<!-- language: lang-xml -->
<StackPanel x:Name="LoremIpsum" Width="300" Height="100" Orientation="Horizontal" Margin="0,0,0,20" Tapped="LoremIpsum_Tapped" PointerPressed="LoremIpsum_AnimDown" PointerReleased="LoremIpsum_AnimUp" PointerExited="LoremIpsum_AnimUp">
    <Image Source="/Assets/pic.jpg" Margin="20"/>
    <TextBlock FontFamily="Segoe UI" FontSize="30" VerticalAlignment="Center">
        Lorem Ipsum
    </TextBlock>
    <StackPanel.Resources>
        <Storyboard x:Name="pointerDownStoryboard">
            <PointerDownThemeAnimation TargetName="LoremIpsum" />
        </Storyboard>
        <Storyboard x:Name="pointerUpStoryboard">
            <PointerUpThemeAnimation TargetName="LoremIpsum" />
        </Storyboard>
    </StackPanel.Resources>
</StackPanel> 
```

加上代码隐藏中的其他事件处理程序：

```
<!-- language: lang-cs -->
private void Latest_AnimDown(object sender, PointerRoutedEventArgs e)
{
    pointerDownStoryboard.Begin();
}
private void Latest_AnimUp(object sender, PointerRoutedEventArgs e)
{
    pointerUpStoryboard.Begin();
} 
```

这行得通。但是......由于我有很多这样的用户控件，我当然不想为每个控件添加所有这些。如前所述，`Standard130ItemTemplate`没有帮助。所以我想到了自定义控件。我希望我可以定义一个`MyStackPanel`只不过是 a `StackPanel`+ `StoryBoard`s 的 a，并且定位到 x:Name 会起作用，也许我可以将事件处理程序放在 LayoutAwarePage 代码隐藏中，以便所有其他人都继承它。

我开始寻找如何做到这一点，并找到了如何创建自定义控件的示例：[XAML 用户和自定义控件示例](http://code.msdn.microsoft.com/windowsapps/XAML-user-and-custom-a8a9505e)。

Generic.xml 中有自定义控件：

```
<!-- language: lang-xml -->
xmlns:local="using:UserAndCustomControls">
<Style TargetType="local:BasicCustomControl">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:BasicCustomControl">
                <Border
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

还有一个代码文件，但不是代码隐藏：

```
<!-- language: lang-cs -->
namespace UserAndCustomControls
{
    public sealed class BasicCustomControl : Control
    {
        public BasicCustomControl()
        {
            this.DefaultStyleKey = typeof(BasicCustomControl);
        }
    }
} 
```

但该样本不包含任何关于动画的内容。所以我尝试了这个示例，尝试将`StoryBoard`s 添加到 Border 或 ControlTemplate，将事件处理程序添加到自行创建的 Generic.xaml.cs 代码隐藏。没有任何效果。

然后我找到[了这个](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/89e96adc-f49c-4f99-8d6d-e9d15ea40b98)，但不确定如何以及为什么将事件处理程序放入`BasicCustomControl`类中。反正我试过了：

在`Generic.xaml`：

```
<!-- language: lang-xml -->
xmlns:local="using:UserAndCustomControls">
<Style TargetType="local:BasicCustomControl">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:BasicCustomControl">
                <Border x:Name="Border"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                    <Border.Resources>
                        <Storyboard x:Name="pointerDownStoryboard">
                            <PointerDownThemeAnimation TargetName="Border" />
                        </Storyboard>
                        <Storyboard x:Name="pointerUpStoryboard">
                            <PointerUpThemeAnimation TargetName="Border" />
                        </Storyboard>
                    </Border.Resources>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

并在`BasicCustomControl.cs`：

```
<!-- language: lang-cs -->
protected override void OnPointerPressed(PointerRoutedEventArgs e)
{
    ((Storyboard)this.Resources["PointerDownThemeAnimation"]).Begin(this);
} 
```

那没有用。该`Begin()`方法不带参数并且没有参数构建成功，但是单击控件时出现 System.Runtime.InteropServices.COMException。

然后我在 SO 上找到了这个：[如何在 XBAP 中将 XAML 故事板动画添加到完整的 WPF 自定义控件中？](https://stackoverflow.com/questions/205751/how-to-add-xaml-storyboard-animation-to-a-full-blown-wpf-custom-control-in-an-xb)

这似乎是一个有趣的解决方案，但我不明白。这里还有一些自定义控件的 VisualState 内容的描述，但我不知道如何将其应用于我的需求：[快速入门：控件模板](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465374.aspx)

现在在这一点上我花了相当多的时间，我只是在想，对于这个**简单的东西**——一个简单的，甚至是自定义控件的预定义动画——**必须有一个简单的解决方案**。我希望我只是忽略了一些东西，它并没有那么复杂。

总结一下问题：

1.  `Standard130ItemTemplate`定义和“附加”到模板的动画在哪里？
2.  是否有一个我可以“继承”的控件以我想要的方式运行（只是三个事件的上/下动画）？
3.  有没有一种方法可以使用 XAML + 代码创建我可以继承的那种控件？
4.  有没有办法只用 XAML 做到这一点？这比前一种方式更可取吗？
5.  有没有一个简单的例子或教程？
6.  是否有任何我可以下载和使用的自定义控件集合？我找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T19:01:17.060

创建自定义样式。在此示例中，我将图像源绑定到内容字段。所以我只需要将我的图像路径放在该字段中（例如“Assets/Image.png”）。如果第一次添加这样的自定义动画更容易弄清楚，那就太好了。

```
 <Style x:Key="ImageButtonStyle" TargetType="ButtonBase">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ButtonBase">
                <Grid x:Name="RootGrid" Background="Transparent">
                    <Image x:Name="ImageLabel" Source="{TemplateBinding Content}"/>
                    <Rectangle
                            x:Name="FocusVisualWhite"
                            IsHitTestVisible="False"
                            Stroke="{StaticResource FocusVisualWhiteStrokeThemeBrush}"
                            StrokeEndLineCap="Square"
                            StrokeDashArray="1,1"
                            Opacity="0"
                            StrokeDashOffset="1.5"/>
                    <Rectangle
                            x:Name="FocusVisualBlack"
                            IsHitTestVisible="False"
                            Stroke="{StaticResource FocusVisualBlackStrokeThemeBrush}"
                            StrokeEndLineCap="Square"
                            StrokeDashArray="1,1"
                            Opacity="0"
                            StrokeDashOffset="0.5"/>

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal"/>
                            <VisualState x:Name="PointerOver">
                            </VisualState>
                            <VisualState x:Name="Pressed">
                                <Storyboard>
                                    <PointerDownThemeAnimation TargetName="ImageLabel" />
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Disabled">
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="FocusStates">
                            <VisualState x:Name="Focused">
                                <Storyboard>
                                    <DoubleAnimation
                                            Storyboard.TargetName="FocusVisualWhite"
                                            Storyboard.TargetProperty="Opacity"
                                            To="1"
                                            Duration="0"/>
                                    <DoubleAnimation
                                            Storyboard.TargetName="FocusVisualBlack"
                                            Storyboard.TargetProperty="Opacity"
                                            To="1"
                                            Duration="0"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Unfocused" />
                            <VisualState x:Name="PointerFocused" />
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="CheckStates">
                            <VisualState x:Name="Checked">
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="0" Storyboard.TargetName="OutlineGlyph" Storyboard.TargetProperty="Opacity"/>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BackgroundGlyph" Storyboard.TargetProperty="Foreground">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource AppBarItemForegroundThemeBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BackgroundCheckedGlyph" Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="Content" Storyboard.TargetProperty="Foreground">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource AppBarItemPressedForegroundThemeBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Unchecked"/>
                            <VisualState x:Name="Indeterminate"/>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# python - Python - 主成分分析 (PCA) 错误

> ID：15890765
> 
> 赞同：3
> 
> 时间：2013-04-08T23:21:49.360
> 
> 标签：python, arrays, numpy, matplotlib, pca

我正在尝试使用 python 进行主成分分析（PCA）。这是我的代码：

```
import os
from PIL import Image
import numpy as np
import glob
from matplotlib.mlab import PCA

#Step1: put database images into a 3D array
filenames = glob.glob('C:\\Users\\Karim\\Downloads\\att_faces\\New folder/*.pgm')
filenames.sort()
img = [Image.open(fn).convert('L') for fn in filenames]
images = np.dstack([np.array(im) for im in img])    

# Step2: create 2D flattened version of 3D input array
d1,d2,d3 = images.shape
b = np.zeros([d1,d2*d3])
for i in range(len(images)):
  b[i] = images[i].flatten()

#Step 3: PCA
results = PCA(b)
results.Wt 
```

但我收到一个错误`RuntimeError: we assume data in a is organized with numrows>numcols`

我试着用`b = np.zeros([d1,d2*d3])`我`b = np.zeros([d2*d3, d1])`得到了`ValueError: could not broadcast input array from shape (2760) into shape (112)`

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T07:49:00.037

~~如果您更改为，`b = np.zeros([d2*d3, d1])`您还应该在之后更改循环，否则您尝试将一个`d1`维度数组放入`d2*d3`一个。~~

~~你应该摆脱这样做的第二个错误~~

您可以简单地转置`b`

```
# Step2: create 2D flattened version of 3D input array
d1,d2,d3 = images.shape
b = np.empty([d1,d2*d3])  #if you know that you are filling the whole array it's faster that using np.zeros or np.ones
for i, im in enumerate(images): 
    b[i,:] = im.flatten()

#Step 3: PCA
results = PCA(b.T) 
```

我还用我认为更好的版本替换了您的 for 循环：在您的实现中，您首先找到 的维度`images`，在其上创建一个整数列表循环，然后重新访问`images`. `enumerate`返回带有一对（索引，值）的迭代器。优点是它只返回您需要的元素，然后您不必`images`直接在循环中访问。

可能您也不需要创建`images`，但我不知道`PIL`，所以我无法帮助您。在这种情况下，您可以简单地使用类似

```
d1,d2,d3 = len(img), img[0].shape 
```

* * *

**编辑**

如果你愿意，你也可以在阅读文件时将文件的内容转换为 numpy。

对于记录，这是[`numpy.asarray`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.asarray.html).

# web-audio-api - 从 HTML5 音频麦克风流中获取音频电平

> ID：15890767
> 
> 赞同：3
> 
> 时间：2013-04-08T23:22:12.533
> 
> 标签：web-audio-api, webkitaudiocontext

在上一个堆栈溢出问题中，我发现了以下代码：

```
<script>
// this is to store a reference to the input so we can kill it later 
var liveSource;
// creates an audiocontext and hooks up the audio input
function connectAudioInToSpeakers(){
  var context = new webkitAudioContext();  
  navigator.webkitGetUserMedia({audio: true}, function(stream) {
    console.log("Connected live audio input");
    liveSource = context.createMediaStreamSource(stream);
    liveSource.connect(context.destination);
    console.log(liveSource);
  });
 }
// disconnects the audio input
function makeItStop(){
   console.log("killing audio!");
   liveSource.disconnect();
 }
// run this when the page loads
connectAudioInToSpeakers();
</script> 
```

它从用户的麦克风中获取音频并通过扬声器播放。我想要的是输入的电平（幅度）（例如，如果发生剪辑，我可以显示红色警告，或者告诉用户他们需要说出来）。在上面的代码中，我如何真正掌握原始数据？

例如，如何将实际数字记录到控制台？我猜它都存储在liveSoure中？

我不需要任何巧妙的画布动画等，只需要一个数字就可以告诉我输入的声音有多大。这相对简单吗？如果是这样，它是如何完成的？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-09T06:53:28.010

我是这样做的——你可以在[http://labs.dinahmoe.com/dynamicmusicengine/](http://labs.dinahmoe.com/dynamicmusicengine/)上看到它，只需将 liveSource 连接到这个 JavaScriptNode（还有 context.createScriptProcessor(4096, 1, 1) 这是新语法，尽管两者都将根据[http://www.w3.org/2011/audio/wiki/F2F_Mar_2013](http://www.w3.org/2011/audio/wiki/F2F_Mar_2013)得到支持）

```
var levelChecker = context.createJavaScriptNode(4096, 1 ,1);
liveSource.connect(levelChecker);
levelChecker.connect(context.destination);

levelChecker.onaudioprocess = function(e) {
        var buffer = e.inputBuffer.getChannelData(0);

        // Iterate through buffer to check if any of the values exceeds 1.
        for (var i = 0; i < buffer.length; i++) {
            if (1 =< buffer[i]) {
                console.log("Oh noes! We got a peak.", buffer[i]);
            }
        } 
```

# ajax - 通过 ajax 从视图将数据传递给控制器

> ID：15890768
> 
> 赞同：0
> 
> 时间：2013-04-08T23:22:14.570
> 
> 标签：ajax, controller, pagination, cakephp-2.0

我有一个页面

[http://www.mysite.com/discusssion/name_of_topic/page:1](http://www.mysite.com/discusssion/name_of_topic/page:1)

单击此视图中的按钮时，我想将参数（即 url）重定向到控制器并获取数据。网址是： [http ://www.mysite.com/discusssion/name_of_topic/page:2](http://www.mysite.com/discusssion/name_of_topic/page:2)

我正在编写一个 ajax 函数来调用控制器并获取数据，但这对我不起作用。这是我的ajax函数

```
$("#loadbut").click(function() {
    $.ajax({
        type: "POST",
        url : "/discussion/"+$topic+"/page:2",
        data: data,
        dataType: "json",
        success: function (response) {
            if (response.success) {
                pr(data);
                exit();
            } else {
                console.log(response.data, response.code);
            }
        }
    });

});' 
```

我怎样才能使这项工作，任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T07:51:14.097

我会尝试的几件事

1.  假设您拥有的代码是 1:1，请添加
2.  安装或使用类似 firebug 的东西来查看发出的请求。检查地址是否正确。
3.  确保您的控制器操作按预期工作。它真的返回一个有效的 json 响应吗？

在没有更多信息的情况下，这就是我所能提供的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T15:12:03.777

您需要澄清/做的几件事：

1.  这个`$topic`变量，你在哪里定义的？是php吗？如果是这样，你把它和js混在一起，它应该是`url : "/discussion/<?=$topic?>/page:2"`
2.  响应中有一个`pr(data);exit;`，又是那个 php 吗？
3.  检查 ajax 发出请求的 url，无论是使用 firebug（或类似的东西）还是使用 a`console.log(url)`来查看它的去向。
4.  如果您在浏览器中执行 ajax url（将**::your_url::/discusion/::name_of_topic::/page:2**放在地址栏中），您收到的答案就是您对 ajax 请求的期望

如果您不告诉我们您收到什么样的错误，就很难知道问题所在。没有任何显示器就不能工作吗？萤火虫说什么？

# paypal - 贝宝高级付款简单捐赠表格

> ID：15890771
> 
> 赞同：0
> 
> 时间：2013-04-08T23:22:32.203
> 
> 标签：paypal

我正在尝试整理一个 PayPal php 表单，该表单将与高级付款一起使用，用户可以在其中输入他们想要捐赠的金额。这需要使用 PayPal Advanced Payments，因此所有这些都将在网站上进行处理。我已经搜索了所有内容，但所有内容都涉及使用购物车和购买商品。

我不需要那个。我只需要用户能够输入他们想要捐赠的金额。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T03:01:24.387

您看到的包含购物车的指南仍将遵循您需要执行的相同程序。只是不用从购物车中计算总金额，您只需使用用户在表单中输入的金额即可。但是，同样，您只需按照您找到的指南使用的相同程序，除了您将传递该金额而不是购物车金额。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:38:48.700

第 5 页的以下链接对我很有帮助。我希望这有帮助。

[https://www.paypalobjects.com/webstatic/en_US/developer/docs/pdf/payflowgateway_guide.pdf](https://www.paypalobjects.com/webstatic/en_US/developer/docs/pdf/payflowgateway_guide.pdf)

# postgresql - 我可以将 ubuntu 默认 postgres 与 heroku 一起使用吗？

> ID：15890773
> 
> 赞同：0
> 
> 时间：2013-04-08T23:22:45.490
> 
> 标签：postgresql, web-applications, ubuntu, heroku, debian

我正在编写一个使用 postgresql 在heroku 上运行的网络应用程序。在他们的服务器上，提供了一个环境变量，例如：

```
export DATABASE_URL=postgresql://localhost:5432/iqtest 
```

他们建议在本地运行您的应用程序时，您应该禁用在 debian/ubuntu 中使用的常用 postgres 设置，并在本地运行服务器“以避免权限问题”。

您可以创建一个数据库，如：

```
/usr/lib/postgresql/9.1/bin/initdb pg 
```

然后像这样运行服务器：

```
/usr/lib/postgresql/9.1/bin/postgres -D pg 
```

这实际上工作正常，但我想知道是否可以使用系统设置来代替。

我找不到关于 debian/ubuntu 标准设置应该如何工作或你应该如何使用它的简单解释，而且我的实验都以要求我密码的东西结束，并且通常警告我它正在运行以明文形式将其写入磁盘。

有没有人设法让标准设置与 Heroku 风格的应用程序一起工作而无需做任何令人震惊的事情？

作为第二个问题，是否有用于 postgres 表的图形（或文本 ui）浏览器/编辑器？显然我可以使用 psql 和 sql 命令，但是点击会更好。如果我在本地运行 pgadmin3 甚至不会连接到数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T01:15:36.397

是的，使用系统 Ubuntu 版本应该没问题。我真的不知道他们对权限问题的含义，但我的猜测是 pg_hba.conf 文件让人感到困惑，并且建议默认的不安全 initdb 配置（没有设置密码）被认为比记录它更容易。

在执行此操作之前，您需要查看此文件中的文档。阅读文件注释会有所帮助，但它不能替代文档。假设您使用的是 PostgreSQL 9.1，文档位于[http://www.postgresql.org/docs/9.1/static/auth-pg-hba-conf.html](http://www.postgresql.org/docs/9.1/static/auth-pg-hba-conf.html)。9.1 中的文件有一些更改，因此如果您使用的是早期版本，您应该查看文档以了解您的版本。

# entity-framework - 加载新断开实体的预先存在的导航属性

> ID：15890782
> 
> 赞同：0
> 
> 时间：2013-04-08T23:23:30.350
> 
> 标签：entity-framework, ef-code-first, entity-framework-5, dbcontext, navigation-properties

我有一个新的断开连接的 POCO（在我的情况下来自 aspnet mvc modelbinder）。

```
public class OfflineEntry
{
    public virtual int Id { get; set; }
    public virtual Category Category { get; set; }
    public virtual int CategoryId { get; set; }
} 
```

外键属性 ( `CategoryId`) 设置为现有数据库值，但导航引用 ( `Category`) 起初为空。加载导航参考的正确方法是什么？我希望第一步是将新对象添加到上下文中。那么之前`SaveChanges`，我可以使用延迟加载，还是`LoadProperty`，或者我必须手动设置它？

```
public ContentResult Save(OfflineEntry o)
{
    db.OfflineEntries.Add(o);
    var categoryName = o.Category.Name; //?
    db.SaveChanges();
    return Content("ok");
}

public class Category
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    //optional 2-way nav property
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T20:56:12.230

我希望其他人会跳上这个专家，但我看到你会遇到的一个问题是你的实例`OfflineEntry`不是从你的 DbContext 创建的，因此 LazyLoading 不起作用。

通常，最好不要将实体模型用作视图模型，这是原因之一。

所以我的建议是创建一个`NewOfflineEntryViewModel`如下所示的：

```
public class NewOfflineEntryViewModel
{
    public int CategoryId { get; set; }
} 
```

然后手动从 DbContext 检索类别

```
public ContentResult Save(NewOfflineEntryViewModel model)
{
    var category = db.Categories.Find(model.CategoryId);

    var newEntry = db.OfflineEntries.Create();
    db.OfflineEntries.Add(newEntry);
    newEntry.Category = category;

    db.SaveChanges();

    var categoryName = category.Name; //for whatever you needed with this

    return Content("ok");
} 
```

# c++ - Sublime Text 2（或/和Xcode）：连续方法/函数的交替背景颜色？

> ID：15890785
> 
> 赞同：2
> 
> 时间：2013-04-08T23:23:43.477
> 
> 标签：c++, xcode, macos, coding-style, sublimetext2

我想知道是否有一种方法可以显示具有交替背景颜色的 .cpp 文件的方法/函数，以便在浏览代码时轻松发现这些方法的开始和结束位置。与 XCode 相同的问题？

例如：

```
// Here starts light grey bg
void method1(){
...
}

// Now starts dark grey bg
void method2(){
...
}

// Again light grey bg
void method3(){
...
}

// etc... 
```

谢谢！

# javascript - 在 Highcharts 中更改图表类型并使用多个系列重绘

> ID：15890789
> 
> 赞同：3
> 
> 时间：2013-04-08T23:24:09.160
> 
> 标签：javascript, jquery, highcharts

我有一个带有各种图表的仪表板，每个图表都有一个相邻的下拉菜单来更改图表的类型。我希望通过重新绘制图表而不是破坏它并创建一个新图表来实现这一点。

我首先偶然发现了一个似乎来自 Highcharts 团队的解决方案，但在调查中，它似乎实际上被破坏了。从选择中选择“列”后，图表将在没有第一个系列数据的情况下重新呈现。我发现这是一个一致的问题...... highcharts 只想按照他们使用“addSeries”方法的方式呈现最后一个系列：

```
for(var i=0;i<series.length;i++)
{
    serie = series[0];
    serie.chart.addSeries({
        type: newType,
        name: serie.name,
        color: serie.color,
        data: serie.options.data
    }, false);

    serie.remove();
}

var chart = new Highcharts.Chart(options, function(chart){

    $('#chartType').change(function(){
        changeType(chart.series, this.value);
    });

}); 
```

尝试在此处选择“列”：http: [//jsfiddle.net/2hLr5/](http://jsfiddle.net/2hLr5/)

我还发现有人使用旧版本的 highcharts 和 jQuery 1.7.1 完成了这项工作。你可以在这里看到他的工作示例：http: [//highcharts.com/jsbin/etulob/edit#javascript,live](http://highcharts.com/jsbin/etulob/edit#javascript,live)

在复制他的代码供我使用时，我发现 jQuery 1.9.1 会将图表从其原始列复制到折线图中，但在尝试从折线图切换回列时它会阻塞。你可以在这里看到：http: [//highcharts.com/jsbin/etulob/9/edit#javascript,live](http://highcharts.com/jsbin/etulob/9/edit#javascript,live)

我最好的猜测是柱形图的数据自以前版本的 Highcharts 以来发生了变化，但那是在黑暗中的总刺。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-06T18:02:44.197

[在这里](https://stackoverflow.com/questions/25139234/highcharts-how-to-change-type-of-graph/25146270#25146270)查看我之前的答案。它解释了如何使用 series.update() 函数来改变图形的类型。

# java - 音频播放器工作了，现在不行了

> ID：15890797
> 
> 赞同：0
> 
> 时间：2013-04-08T23:25:20.017
> 
> 标签：java, audio, audio-player

**我修改了音频播放器并在这里发布了一个新的（而不是重复的）问题：[BigClip Won't Play .wav File](https://stackoverflow.com/q/15911925/2255301)**

我写了一个音频播放器，它可以工作，但现在不行。这是代码：

```
package me.pogostick29.audiorpg.audio;

import java.applet.Applet;
import java.applet.AudioClip;
import java.io.File;
import java.net.MalformedURLException;

public class AudioPlayer {

    private AudioPlayer() { }

    private static AudioPlayer instance = new AudioPlayer();

    public static AudioPlayer getInstance() {
        return instance;
    }

    public void play(String name) {
        AudioClip clip = null;
        try { clip = Applet.newAudioClip(new File("audio/" + name + ".wav").toURI().toURL()); }
        catch (MalformedURLException e) { e.printStackTrace(); }
        clip.play();
    }

    public void playDialogue(String character, String name) {
        play("people/" + character + "/" + name);
    }
} 
```

但是，当我尝试播放位于此处的音频文件时（[http://icap.me/i/rNIXeCfScy.png](http://icap.me/i/rNIXeCfScy.png)）

使用

```
AudioPlayer.getInstance().playDialogue("blacksmith", "blacksmith1"); 
```

从另一个类，它什么都不做。

在此先感谢您的帮助！

# android - 显示顶级列表的最佳方式

> ID：15890802
> 
> 赞同：0
> 
> 时间：2013-04-08T23:26:13.950
> 
> 标签：android, list, listview, expandablelistview

我正在开发我的第一个 Android 应用程序。现在它使用片段来分隔应用程序的主要部分（错误代码查找和本周交易是我的片段），我现在想为我们的一些常见编程信息创建第三个片段。在编程信息中，我将有几个品牌（我们使用的设备），然后会显示很多详细信息（我们将使用哪个电话号码、端口、SSL 选项等）。

我在看 ExpandableListview 认为这可能是最好的方法，但想知道是否还有其他选择。主要是因为我不喜欢 ExpandableListView 的外观。与我使用 Holo 和 ActionBar 的其他 UI 相比，它感觉非常过时。

有什么建议么？如果它存在，我会喜欢几乎像“子片段”布局。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T13:13:07.037

您可能想在 github 中查找库。

有很多不同的显示方式......比如：

StiskyListHeaders 来自 emilsjolander [https://github.com/emilsjolander/StickyListHeaders](https://github.com/emilsjolander/StickyListHeaders)

……

您可以在应用程序中看到大多数当前使用且稳定的库：“开发人员库”它在商店中

# php - 无法使用外部 smtp 服务器在 php 中发送邮件

> ID：15890806
> 
> 赞同：0
> 
> 时间：2013-04-08T23:26:29.673
> 
> 标签：php, windows, smtp

我正在尝试使用下面的 php 脚本从外部 smtp 服务器发送邮件，

```
<?php
$recipient="john_doe@gmail.com"; 
$subject="Website to customer";
$message="Customer Name: ".$_POST['name']."\r\n";
$message.="Customer Email: ".$_POST['email']."\r\n";
$message.="Customer Message: ".$_POST['msg']."\r\n"; 
$mailheader="From: <maria@comcast.net> \r\n";
$mailheader.="Reply to ".$_POST['email'];
ini_set("SMTP","comcast.net");
mail($recipient, $subject, $message, $mailheader);
?>
<!DOCTYPE html>
<html>
<head>
<title>Sending mail from website to Customer</title>
</head>
<body>
<p>Thanks, <strong><?php echo $_POST['name']; ?></strong>, for your message.</p>
<p>Your email address: <strong><?php echo $_POST['email']; ?></strong></p>
<p>Your message: <br/><?php echo $_POST['msg']; ?></p>
</body>
<html> 
```

我收到一条错误消息：

```
Warning: mail() [function.mail]: Failed to connect to mailserver at "comcast.net" port 25, verify your "SMTP" and "smtp_port" setting in php.ini or use ini_set() in C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs\sendmail.php on line 10 
```

那是因为我没有本地电子邮件服务器吗？phpmailer会解决我的问题吗？任何人都可以指导我正确的方向吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:41:28.150

是的。谷歌上的 5 秒发现了这个，[http://customer.comcast.com/help-and-support/internet/list-of-blocked-ports/](http://customer.comcast.com/help-and-support/internet/list-of-blocked-ports/)

使用端口 465。您可能需要设置帐户信息才能在他们的服务器上发送传出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T06:26:27.790

使用`smtp.comcast.net`而不是`comcast.net`作为`SMTP`参数。将`smtp_port`参数设置为`587`。
**但是**页面 [2] 建议您需要不受 php-mail 支持的 SMTP AUTHentication。有关可用的替代方案，请参见第 [3] 页。

**网址：**
1\. [http://www.php.net/manual/en/mail.configuration.php](http://www.php.net/manual/en/mail.configuration.php)
2\. [http://customer.comcast.com/help-and-support/internet/email-client- programs-with-xfinity-email/](http://customer.comcast.com/help-and-support/internet/email-client-programs-with-xfinity-email/)
3\. [php.ini & SMTP= - 你如何传递用户名和密码](https://stackoverflow.com/questions/112190/php-ini-smtp-how-do-you-pass-username-password)

# objective-c - UIToolbar 上的 UILabel（以编程方式）不显示标签

> ID：15890808
> 
> 赞同：1
> 
> 时间：2013-04-08T23:26:45.413
> 
> 标签：objective-c, text, uinavigationcontroller, uilabel, uitoolbar

我在 -viewDidLoad: 中有以下代码：

```
self.navigationController.toolbarHidden = NO;

UIBarButtonItem *shareButton = [[UIBarButtonItem alloc]    initWithBarButtonSystemItem:UIBarButtonSystemItemAction target:self action:@selector(sendEmail:)];

    UIBarButtonItem *spacer1 = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];

    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0.0 , 25, self.view.frame.size.width, 21.0f)];
    label.backgroundColor = [UIColor clearColor];
    label.textColor = [UIColor whiteColor];
    label.text = @"text-here";
    label.userInteractionEnabled = NO;
    label.font = [UIFont systemFontOfSize:18.0];
    label.textAlignment = NSTextAlignmentCenter;

    UIBarButtonItem *labelItem = [[UIBarButtonItem alloc] initWithCustomView:label];

    self.navigationController.toolbarItems = [NSArray arrayWithObjects:shareButton, spacer1, labelItem, nil]; 
```

但是，当我加载应用程序时，工具栏只显示 shareButton，它链接到通过电子邮件共享应用程序的内容。标签没有出现（我希望它出现）。我基本上已经从stackoverflow上提出的其他问题中复制了这个确切的代码，而且我所看到的任何地方都是相同的答案......这有什么不同吗？

我假设由于共享按钮有效，因此工具栏可以正常工作。像我这样的问题的其他答案产生了 [self.navigationController.view addSubview:toolbarObj];，但我只是使用了与导航控制器集成的工具栏。

垫片……嗯，我现在还不知道垫片对我有多大作用。现在，如果我理解正确，垫片会将我的标签项目推到最右边，对吗？它不会均匀地隔开物体吗？我希望将标签放在工具栏的中心。

帮助和解释将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:34:57.913

当我运行您的代码时，它既不显示标签也不显示按钮。如果我在下面进行更改，它们都会出现：

改变：

```
self.navigationController.toolbarItems = [NSArray arrayWithObjects:shareButton, spacer1, labelItem, nil]; 
```

到：

```
self.toolbarItems = [NSArray arrayWithObjects:shareButton, spacer1, labelItem, nil]; 
```

如果您希望标签在中间，请将其缩小（我只是将视图宽度除以 2）并在其另一侧添加第二个垫片：

```
self.toolbarItems = [NSArray arrayWithObjects:shareButton, spacer1, labelItem, spacer2, nil]; 
```

# ruby - 耙迁移错误 - 数据库不存在

> ID：15890809
> 
> 赞同：2
> 
> 时间：2013-04-08T23:26:49.337
> 
> 标签：ruby, rake, datamapper, padrino, rails-postgresql

我有一个使用数据映射器和 postgres 的 padrino 项目。当我运行 padrino rake dm:create 时，它​​说数据库已创建。但是，当我运行 padrino rake dm:auto:migrate 时，我收到错误 - 致命：数据库“dbname_development”不存在。

我在一个新环境中工作，但我尝试了一个使用活动记录的项目并且没有问题。

我在 OSX 和 rbenv 上使用 postgres 应用程序。虽然，我确实尝试了 rvm 而不是 rbenv，因为我的另一台计算机使用 rvm（该项目在那台计算机上运行良好） - 结果相同。我还尝试使用 Induction 连接到创建的数据库并得到相同的错误。如果我进入 psql 并获取数据库列表，则会显示数据库。

自从 ActiveRecord 工作以来，我有点难过，当我在另一台计算机上运行项目时没有问题。有没有人见过这个？谢谢！

# svg - 缩短 SVG 图形生成的执行时间和文件大小

> ID：15890810
> 
> 赞同：2
> 
> 时间：2013-04-08T23:26:49.430
> 
> 标签：svg, graphviz, dot

我的程序生成了一个点文件`a.dot`，然后我使用`dot -Tsvg a.dot > a.svg` 了但是使用转换脚本有两个问题：

*   有没有办法**缩短**命令的执行时间？目前，详细模式打印出：

> ```
> dot - graphviz version 2.30.1 (20130218.1601)
> libdir = "/usr/local/Cellar/graphviz/2.30.1/lib/graphviz"
> Activated plugin library: libgvplugin_quartz.6.dylib
> Using textlayout: textlayout:quartz
> Activated plugin library: libgvplugin_core.6.dylib
> Using render: svg:core
> Using device: svg:svg:core
> Activated plugin library: libgvplugin_dot_layout.6.dylib
> Using layout: dot:dot_layout
> The plugin configuration file:
>   /usr/local/Cellar/graphviz/2.30.1/lib/graphviz/config6
>       was successfully loaded.
>     render    :  dot fig map pic pov ps quartz svg tk vml xdot
>     layout    :  circo dot fdp neato nop nop1 nop2 osage patchwork sfdp twopi
>     textlayout    :  textlayout
>     device    :  bmp canon cgimage cmap cmapx cmapx_np dot eps exr fig gif gv imap imap_np ismap jp2 jpe jpeg jpg pct pdf pic pict plain plain-ext png pov ps ps2 psd sgi svg svgz tga tif tiff tk vml vmlz
> xdot
>     loadimage :  (lib) bmp eps gif jpe jpeg jpg pdf png ps svg
> 
> fontname: unable to resolve "Times-Roman"
> 
> network simplex:  1096 nodes 1155 edges maxiter=2147483647 balance=1
> 
> network simplex: 1096 nodes 1155 edges 1 iter 0.00 sec
> 
> Maxrank = 416, minrank = 0
> 
> mincross: pass 0 iter 0 trying 0 cur_cross 0 best_cross 0
> 
> mincross BST: 0 crossings, 0.10 secs.
> 
> network simplex:  48344 nodes 72433 edges maxiter=2147483647 balance=2
> 
> network simplex: 100 200 300 400 500 600 700 800 900 1000
> 
> network simplex: 1100 1200 1300 1400 1500 1600 1700 1800 1900 2000
> 
> network simplex: 2100 2200 2300 2400 2500 2600 2700 2800 2900 3000
> 
> network simplex: 3100 3200 3300 3400 3500 3600 3700 3800 3900 4000
> 
> network simplex: 4100 4200 4300 4400 4500 4600 4700 4800 4900 5000
> 
> network simplex: 5100 5200 5300 5400 5500 5600 5700 5800 5900 6000
> 
> network simplex: 6100 6200 6300 6400 6500 6600 6700 6800 6900 7000
> 
> network simplex: 7100 7200 7300 7400 7500 7600 7700 7800 7900 8000
> 
> network simplex: 8100 8200 8300 8400 8500 8600 8700 8800 8900 9000
> 
> network simplex: 9100 9200 9300 9400 9500 9600 9700 9800 9900 10000
> 
> network simplex: 10100 10200 10300 10400 10500 10600 10700 10800 10900 11000
> 
> network simplex: 11100 11200 11300 11400 11500 11600 11700 11800 11900 12000
> 
> network simplex: 12100 12200 12300 12400 12500 12600 12700 12800 12900 13000
> 
> network simplex: 13100 13200 13300 13400 13500 13600 13700 13800 13900 14000 
> ```

它只是继续打印出`network simplex:...`

*   有没有办法**减少**生成的 svg 文件的大小？因为客户端需要将svg加载到浏览器中，所以最好是小...

任何建议表示赞赏！

# php - 仅当不仅在该子目录中时才重定向到子目录

> ID：15890813
> 
> 赞同：1
> 
> 时间：2013-04-08T23:27:18.870
> 
> 标签：php, apache, .htaccess

我的普通旧 php 应用程序面临一个（可能）非常简单的问题。我有一个目录结构简单的网站：

```
www.domain.com
  /blog
  /some_subdirectory
  /some_other_subdirectory 
```

每次他访问我的应用程序中的任何文件夹/任何文件时，我都想将用户重定向到 /blog 目录，除非他已经在该 /blog 目录中。

我在 .htaccess 文件中提出了以下代码段：

```
Redirect 302 / http://www.domain.com/blog 
```

但是当然，如​​果在 /blog 目录内，这也会重定向，从而导致无限循环重定向到不存在的更深的 /blog 目录。

如何从该重定向语句中排除 /blog 目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:35:56.847

要排除文件夹，您应该使用 mod_rewrite。你可以试试这个：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI}  !/blog     [NC]
RewriteRule  ^(.*) /blog/$  [L,NC] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:35:52.910

请改用 mod_rewrite，因为您可以创建否定条件：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/blog
RewriteRule ^(.*)$ /blog/$1 [L,R] 
```

当然，这会改变浏览器 URL 地址栏中的内容。如果您不希望栏更改，则只需`,R`从方括号中删除标志。

# xamarin - 如何将现有的 Xamarin Studio iTouch 项目复制到不同的文件夹？

> ID：15890814
> 
> 赞同：0
> 
> 时间：2013-04-08T23:27:20.020
> 
> 标签：xamarin

我有一个名为 DoctorRegistration2012 的现有 Xamarin Studio iTouch iOS 项目。我想复制这个项目并将其命名为 DoctorRegistration2013。然后我想在 Xamarin Studio 中打开复制的项目并继续开发。如何快速完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T14:26:30.847

您可以复制您的原始项目所在的目录，将新目录命名为您想要的任何名称，然后如果您在 Xamarin Studio 的新目录中打开 .sln 解决方案文件，您应该没问题。

然后，您可以通过在解决方案资源管理器中右键单击解决方案并选择“重命名”来重命名解决方案。

如果我误解了什么，请告诉我！

# java - 将 JScience Measure 导入 NetBeans

> ID：15890821
> 
> 赞同：0
> 
> 时间：2013-04-08T23:28:16.730
> 
> 标签：java, netbeans, import

我有一个基本问题。我正在尝试使用 JScience 中的测量功能。我下载了 .jar 文件 ( [http://java.net/projects/jscience/downloads](http://java.net/projects/jscience/downloads) ) 我创建了一个加载了所有 .jar 文件的新库。

我的“树”是： ![在此处输入图像描述](https://i.stack.imgur.com/MmqFR.jpg)

我的进口声明是：

```
import javax.measure; 
```

编译器抱怨包 javax.measure 不存在。我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T01:23:17.070

在 Java 中导入的语法是：

**对于单个班级：**

```
import com.mypackage.ClassName; 
```

**对于整个包裹：**

```
import com.mypackage.*; 
```

要导入整个`measure`包，您可以使用：

```
import javax.measure.*; 
```

*   [使用包成员](http://docs.oracle.com/javase/tutorial/java/package/usepkgs.html)

# .net - 未找到连接 URI 的 IConnectionFactory 实现：activemq:tcp:

> ID：15890822
> 
> 赞同：0
> 
> 时间：2013-04-08T23:28:31.860
> 
> 标签：.net, connection, activemq

我仍然收到“No IConnectionFactory implementation found for connection URI: activemq:tcp://localhost:61616”错误。我已将存档“nmsprovider-activemq.config”粘贴并包含在编译项目中，我正在使用 .NET 4.0，引用为 Apache.NMS-1.5.1-bin.zip\net-4.0\release

代码非常简单，但我无法抛出连接错误

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Apache.NMS;
using Apache.NMS.Util;
using System.Collections;
using System.Reflection;
using System.IO;

namespace ConexionActiveMQ
{
    class Program
    {
        private static string[] GetConfigSearchPaths()
        {
            ArrayList pathList = new ArrayList();

            // Check the current folder first.
            pathList.Add("");
            AppDomain currentDomain = AppDomain.CurrentDomain;

            // Check the folder the assembly is located in.

            pathList.Add(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location));
            if (null != currentDomain.BaseDirectory)
            {
                pathList.Add(currentDomain.BaseDirectory);
            }

            if (null != currentDomain.RelativeSearchPath)
            {
                pathList.Add(currentDomain.RelativeSearchPath);
            }

            return (string[])pathList.ToArray(typeof(string));
        }

        static void Main(string[] args)
        {
            string[] direcciones;
            direcciones = GetConfigSearchPaths();
            // Example connection strings:
            //    activemq:tcp://localhost:61616
            //    stomp:tcp://activemqhost:61613
            //    ems:tcp://tibcohost:7222
            //    msmq://localhost

            Uri connecturi = new Uri("activemq:tcp://localhost:61616");

            Console.WriteLine("About to connect to " + connecturi);

            // NOTE: ensure the nmsprovider-activemq.config file exists in the executable folder.
            IConnectionFactory factory = new NMSConnectionFactory(connecturi);

            using (IConnection connection = factory.CreateConnection())
            using (ISession session = connection.CreateSession())
            {
                // Examples for getting a destination:
                //
                // Hard coded destinations:
                //    IDestination destination = session.GetQueue("FOO.BAR");
                //    Debug.Assert(destination is IQueue);
                //    IDestination destination = session.GetTopic("FOO.BAR");
                //    Debug.Assert(destination is ITopic);
                //
                // Embedded destination type in the name:
                //    IDestination destination = SessionUtil.GetDestination(session, "queue://FOO.BAR");
                //    Debug.Assert(destination is IQueue);
                //    IDestination destination = SessionUtil.GetDestination(session, "topic://FOO.BAR");
                //    Debug.Assert(destination is ITopic);
                //
                // Defaults to queue if type is not specified:
                //    IDestination destination = SessionUtil.GetDestination(session, "FOO.BAR");
                //    Debug.Assert(destination is IQueue);
                //
                // .NET 3.5 Supports Extension methods for a simplified syntax:
                //    IDestination destination = session.GetDestination("queue://FOO.BAR");
                //    Debug.Assert(destination is IQueue);
                //    IDestination destination = session.GetDestination("topic://FOO.BAR");
                //    Debug.Assert(destination is ITopic);

                IDestination destination = SessionUtil.GetDestination(session, "queue://FOO.BAR");
                Console.WriteLine("Using destination: " + destination);

                // Create a consumer and producer
                using (IMessageConsumer consumer = session.CreateConsumer(destination))
                using (IMessageProducer producer = session.CreateProducer(destination))
                {
                    // Start the connection so that messages will be processed.
                    connection.Start();
                    //producer.Persisten = true;

                    // Send a message
                    ITextMessage request = session.CreateTextMessage("Hello World!");
                    request.NMSCorrelationID = "abc";
                    request.Properties["NMSXGroupID"] = "cheese";
                    request.Properties["myHeader"] = "Cheddar";

                    producer.Send(request);

                    // Consume a message
                    ITextMessage message = consumer.Receive() as ITextMessage;
                    if (message == null)
                    {
                        Console.WriteLine("No message received!");
                    }
                    else
                    {
                        Console.WriteLine("Received message with ID:   " + message.NMSMessageId);
                        Console.WriteLine("Received message with text: " + message.Text);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T05:13:33.007

您需要 NMS 库的 ActiveMQ 版本。

[http://activemq.apache.org/nms/activemq-downloads.html](http://activemq.apache.org/nms/activemq-downloads.html)

# objective-c - 如何在Objective-C中将NSString与字符一一转换为NSArray

> ID：15890823
> 
> 赞同：4
> 
> 时间：2013-04-08T23:28:32.730
> 
> 标签：objective-c

我想转换`NSString(ex. @"HELLO")`为`NSArray(ex. [@"H", @"E", @"L", @"L", @"O", nil])`.

首先，我尝试使用`componentsSeparatedByString`. 但它需要指示分隔符，所以我不能。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-09T00:38:55.773

将字符串拆分为数组的正确方法是执行以下操作（作为`NSString`类别方法）：

```
@interface NSString (ConvertToArray)
-(NSArray *)convertToArray;
@end

@implementation NSString (ConvertToArray)

- (NSArray *)convertToArray {
    NSMutableArray *arr = [[NSMutableArray alloc] init];
    NSUInteger i = 0;
    while (i < self.length) {
        NSRange range = [self rangeOfComposedCharacterSequenceAtIndex:i];
        NSString *chStr = [self substringWithRange:range];
        [arr addObject:chStr];
        i += range.length;
    }

    return arr;
}

@end

NSArray *array = [@"Hello " convertToArray];
NSLog(@"array = %@", array); 
```

`\U10000`如果字符串包含 Unicode 字符或更高版本，硬编码范围长度为 1 的解决方案将失败。这包括表情符号字符以及许多其他字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-08T23:40:00.733

这是我的代码：

```
@interface NSString (ConvertToArray)
-(NSArray *)convertToArray;
@end

@implementation NSString (ConvertToArray)

-(NSArray *)convertToArray
{
    NSMutableArray *arr = [[NSMutableArray alloc]init];
    for (int i=0; i < self.length; i++) {
        NSString *tmp_str = [self substringWithRange:NSMakeRange(i, 1)];
        [arr addObject:[tmp_str stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
    }
    return arr;
}
@end 
```

：

```
- (void)foo
{
    NSString *exString = @"HELLO";
    NSArray *arr = [exString convertToArray];
    for (NSString *str  in arr) {
        NSLog(@"%@\n",str);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-08T23:35:34.237

```
NSString *string = @"HELLO";
NSMutableArray *array = [[NSMutableArray alloc] init];
for (int i = 0; i < string.length; i ++) {
    [array addObject:[NSString stringWithFormat:@"%c", [string characterAtIndex:i]]];
} 
```

# php - 创建一个切换关闭按钮

> ID：15890827
> 
> 赞同：0
> 
> 时间：2013-04-08T23:29:03.857
> 
> 标签：php, javascript, toggle

我可以从下面的脚本中删除花哨并创建一个带有关闭按钮的切换事件。这是我在我的网站列表中使用的脚本，所以想为多个 id 创建一个切换

```
$("a.fmailto").click(function(event){

var nr = jQuery(this).attr("id").substr(6);
var arr = nr.split("_");
var user_id = arr[0];
var listing_id = arr[1];
$.fancybox({
    'width' : 630,
    'height' : 600,
    'transitionIn' : 'none',
    'transitionOut' : 'none',
    'margin' : '0',
    'padding' : '0',
    'titleShow' : false,
    'type' : 'iframe',
    'href' : '{/literal}{$live_site}{literal}/mailto.php?id='+user_id+'&amp;ad_id='+listing_id
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:31:31.463

```
<div>toggle me</div>
<a onclick="$('div').toggle();"></a> 
```

或字面意思：

```
$(function(){
$('a').on('click',function(){
$('div').toggle();

});

}); 
```

# jquery - JQuery Ajax 设置：超时

> ID：15890831
> 
> 赞同：1
> 
> 时间：2013-04-08T23:29:58.503
> 
> 标签：jquery, ajax, rest, timeout

我正在使用 JQuery ajax 方法通过 rest api 调用服务。我在服务调用中添加了 5 秒的超时值。

```
$.ajax({
    timeout:5000,
    type:"POST",
    url:"serviceurl",
    data: fooandstuff,
    error:function(){},
    success:function(data){ console.log(data); }
   }); 
```

这是我的函数调用。当我的服务关闭时，我正在测试这个，我认为它实际上在 5 秒后没有超时。因为它花了一段时间，然后当服务启动时，它实际上返回了响应。

所以，我试图了解 jquery 是如何实际实现这个超时的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:35:31.280

如果您遇到这样的情况，请在您的`error`回调函数中尝试调试-`timeout`

```
error: function(x, t, m) {
        if(t==="timeout") {
            alert("got timeout");
        } else {
            alert(t);
        }
    } 
```

*发生超时时，错误事件处理程序采用三个参数（xmlhttprequest、textstatus 和消息），状态参数将为“超时”*

一个工作超时演示：

[**小提琴**](http://jsfiddle.net/PsjJV/)

# macos - OS X/Cocoa：重新提示用户使用位置服务的权限？

> ID：15890833
> 
> 赞同：3
> 
> 时间：2013-04-08T23:30:21.000
> 
> 标签：macos, cocoa, core-location

（我看到这个问题已经在 iOS 的上下文中得到了回答，但我正在使用 Cocoa/OS X。）

我正在编写一个利用位置服务的应用程序。

当 CLLocationManager 首次启动时，用户可以选择启用或禁用位置服务。在我的应用程序中，如果用户之前拒绝，我想让用户选择激活位置服务。但是，查看类参考，我看不到重新提示用户许可的方法。似乎用户最初的决定永远存在：

> **重要提示**：除了硬件不可用之外，用户还可以选择拒绝应用程序访问位置服务数据。在应用程序的初始使用期间，Core Location 框架会提示用户确认使用位置服务是可以接受的。如果用户拒绝该请求，则 CLLocationManager 对象在以后的请求中向其委托报告一个适当的错误。

有没有办法以编程方式重置授权状态？

# css - 悬停时使用 css 变换的水平菜单

> ID：15890836
> 
> 赞同：0
> 
> 时间：2013-04-08T23:30:28.563
> 
> 标签：css, html

我正在尝试制作一个拉出式导航，用户将鼠标悬停在“菜单”手柄上并拉出。我从顶部成功地这样做了，但我希望盒子水平堆叠并从左侧来，向右移动。

这是我的代码：

```
<!DOCTYPE html>
<html>
    <head>
        <style>

            nav {
                position:absolute;
                top:-190px;
            }

            .menu:hover {
                -webkit-transform:translate(0px,190px);
                -moz-transform:translate(0px,190px);
                -o-transform:translate(0px,190px);
                -ms-transform:translate(0px,190px);
                transform:translate(0px,190px);
                -webkit-transition:ease-in-out;
                -moz-transition:ease-in-out;
                -o-transition:ease-in-out;
                -ms-transition:ease-in-out;
                transition:ease-in-out;
                -webkit-transition-duration: .5s;
                -moz-transition-duration: .5s;
                -o-transition-duration: .5s;
                -ms-transition-duration: .5s;
                transition-duration: .5s;
            }

            div {
                width:40px;
                height:40px;
                background-color:#999999;
                border:black solid 2px;
                padding:2px;
                font-family:Helvetica;
                font-size:.8em;
                color:white;
                text-align:center;
                margin:1px;
            }

            .handle {
                border-radius:0px 0px 10px 10px;
            }

            div:hover {
                background-color:#009999;
                border:black solid 2px;
                -webkit-transform: translateX(10px);
                -moz-transform: translateX(10px);
                -o-transform: translateX(10px);
                -ms-transform: translateX(10px);
                tranform: translateX(10px);
            }

            div:active {
                background-color:#006699;
                border:black solid 2px;
                -webkit-transform: translateX(-10px);
                -moz-transform: translateX(-10px);
                -o-transform: translateX(-10px);
                -ms-transform: translateX(-10px);
                tranform: translateX(-10px);
            }

        </style>
    </head>

    <body>
        <nav class="menu">
            <a href"http://www.lvc.edu/" target="_new"><div> <p>Link 1</p></div></a>
            <a href"http://www.lvc.edu/" target="_new"><div> <p>Link 2</p></div></a>
            <a href"http://www.lvc.edu/" target="_new"><div> <p>Link 3</p></div></a>
            <a href"http://www.lvc.edu/" target="_new"><div> <p>Link 4</p></div></a>
            <div class="handle"><p>Menu</p></div>
        </nav>
    </body>
</html> 
```

我的主要问题不是实际的动画（我很确定我知道如何弄清楚），而更多的是盒子的位置以及我希望它们是水平的而不是堆叠的。

很抱歉，如果这很混乱，希望你们能理解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:55:36.187

要获得水平菜单，请遵循网络上的无数教程之一，例如这个：

[http://jamesowers.co.uk/css-tutorials/50/horizo​​ntal-css-list-menu/](http://jamesowers.co.uk/css-tutorials/50/horizontal-css-list-menu/)

（习惯上使用无序列表来替代菜单）

要使其从左侧滑入，您必须将起始位置偏移更改为左侧：

```
nav { position:absolute; left: [negative number corresponding to the width of the menu];} 
```

对于滑动：

```
.menu:hover {
    ...
    transform:translate([width of menu],0);
    ...
} 
```

***请注意：Internet Explorer 8 及更早版本不支持 css 转换，这意味着菜单将无法访问（不包括在 Windows XP 下仍在使用 IE 的所有人）。也许您可以考虑改用 JavaScript/jQuery？***

# html - IE9 CSS 问题与 li 中的两个项目的排列

> ID：15890841
> 
> 赞同：0
> 
> 时间：2013-04-08T23:31:12.133
> 
> 标签：html, css, internet-explorer, list

请看一下： Firefox、chrome、opera 中的[JSFiddle](http://jsfiddle.net/dspJ5/1/embedded/result/)
代码正常，但在 ie9 中移动数字，请参见图片。左边一切正常，右边是ie9。 [http://imageshack.us/photo/my-images/707/asdlj.png/](http://imageshack.us/photo/my-images/707/asdlj.png/)

我无法解决问题，需要帮助:(

HTML

```
<ul id="category">
    <li>
        <p>
            35
        </p>
        Spiele
    </li>
    <li>
        <p>
            352
        </p>
        Puppen
    </li>
</ul> 
```

CSS

```
ul {
    list-style: none;
    margin: 0;
    padding: 0;
}
#category {
    float:left;
    background:#e8e8e8;
}
#category li {
    line-height: 20px;
    padding: 10px 30px;
    cursor:pointer;
}
#category p {
    margin:0 0 0 20px;
    padding:0;
    float:right;
    font-size:18px;
} 
```

我已经大大简化了代码。

斯坦茨格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:40:54.487

我相信这将有资格作为使用`<table>`. 这是处理此特定问题的更清洁和兼容的方式。您不会遇到任何浏览器问题。尝试这个：

```
<table>
  <tr>
    <td>Spiele</td>
    <td>35</td>
  </tr>

  <tr>
    <td>Puppen</td>
    <td>352</td>
  </tr>
</table> 
```

还有一些基本的 CSS ：

```
table {
  background-color: #e8e8e8;
}

table td {
  padding: 10px;
} 
```

[jsfiddle](http://jsfiddle.net/nFcrW/)

如果您不熟悉使用它们，请查看 MDN 表[教程。](https://developer.mozilla.org/en-US/docs/HTML/Element/table)

# android - Android：动画更改 GridView 内容

> ID：15890847
> 
> 赞同：39
> 
> 时间：2013-04-08T23:31:50.823
> 
> 标签：android

我有一个布局的 GridView，可以动态添加或删除到网格中。

在 iOS 中，GridView 项目的本机行为是让网格中的其他项目滑动到已删除项目的位置，或者在添加新项目时滑动以腾出空间。

然而，在 Android 上，这种行为只是为了让更改立即出现在屏幕上。我尝试使用 GridView 适配器中的一些技巧向每个 getView() 调用添加自定义动画，但这最终导致了一些问题：

[当数据集更改时，Android GridView 在稍后索引的插槽中加载 0 索引项](https://stackoverflow.com/questions/15845527/android-gridview-loading-the-0-indexed-item-in-a-later-indexs-slot-when-data-se)

我尝试让单个视图控制动画而不是适配器的 getView() 方法，但最终结果是相同的。

我还尝试使用 GridLayoutAnimationController，如下所示：

```
Animation animation = AnimationUtils.loadAnimation(mActivity, R.anim.grid_item_fadein);
GridLayoutAnimationController controller = new GridLayoutAnimationController(animation, .2f, .2f);
mGrid.setLayoutAnimation(controller); 
```

这适用于所有 GridView 内容的初始加载，但对该内容的任何更改都会像默认情况下一样立即弹出。

我觉得这是一个非常简单的功能，应该有更简单的方法来做到这一点。我从在线搜索中看到的最好的是[一个库](https://github.com/mrKlar/PagedDragDropGrid)，它为 GridView 项目设置动画，这些项目在网格中交换位置，但这不是我想要的（在同一个库中，当你通过删除从网格中删除一个项目时我试图避免的相同即时效果发生）。

我还看到的关于 SO 的常见答案是“看看 APIDemos，有很多例子”。但据我所知，实际上没有动画 GridView 内容更改的示例。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-26T16:57:01.960

Chet Haase 发布了一个关于如何正确处理 ListView 动画的精彩视频。基本概念可以应用于 GridViews。[你可以在这里](http://graphics-geek.blogspot.com/2013/02/devbytes-listview-animations.html)找到视频。

如果您正在为 API 1.0+ 进行开发，您将无法使用视频中提到的引用动画功能（例如[ViewPropertyAnimator](http://developer.android.com/reference/android/view/ViewPropertyAnimator.html)），除非您使用[NineOldAndroids](http://nineoldandroids.com/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-12T11:21:49.933

在对 GridView 进行任何更改后，如 .remove() 您必须调用**mGrid.startLayoutAnimation();**

GridView 不会自动为您执行此操作。你必须手动触发它;-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-26T19:25:04.410

我认为对于 AdapterViews，ViewGroup 的 LayoutTransition 不起作用。查看源代码，ViewGroup 确保其他子级的过渡动画发生在调用`addView`and`removeView`时，但派生的 AdapterView 不使用这些方法，因为它依赖于提供视图的适配器。

上面提到的 Chet Haase 的视频是关于动画正在消失的 ListView 的单个子视图，而不是动画所有其他周围的子视图移动以填补空白。

而且，如果我理解正确的话，GridLayoutAnimationController 是关于孩子们填写时的交错动画（即第一次或整个列表的完整重新布局，从空开始），而不是动画就地布局更改添加或删除后周围的孩子。所以，孩子们是通过淡入或滑入或旋转出现的 - 总是一次一个，从第一个到最后一个。

最后，一个建议的解决方案：如果您不需要基于适配器的视图，您可以切换到 GridLayout 或 LinearLayout。这就是`animateLayoutChanges="true"`工作的地方，以及“布局动画”演示始终使用的内容。注意 LayoutTransition 需要最低 api 级别 11。而 GridLayout 需要 api14。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-09T22:20:01.187

我发现此资源链接对于处理其他布局视图（如 LinearLayout 等）的动画非常有帮助：http: [//developer.android.com/training/animation/layout.html](http://developer.android.com/training/animation/layout.html) 希望这可以提供帮助。您还可以查看[https://github.com/nhaarman/ListViewAnimations](https://github.com/nhaarman/ListViewAnimations)以获得灵感

# ios - iOS mapView 动画Drop

> ID：15890854
> 
> 赞同：0
> 
> 时间：2013-04-08T23:32:31.823
> 
> 标签：ios, xcode, animation, annotations, mkmapview

在我的地图视图中，我目前将注释的 bool animatesDrop 设置为 NO。这是因为在 viewWillAppear 期间绘制 mapView 注释时，我不会在它们动画时。但是，我还有一个刷新按钮，用于重新绘制注释，并希望它们在按下时动画（删除）。有没有办法做到这一点？谢谢。

```
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation {

    if ([annotation isKindOfClass:[MKUserLocation class]]) {

        return nil;
    }

    MyPin = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];

    UIButton *calloutButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];

    UIButton *directionsButton = [UIButton buttonWithType:UIButtonTypeCustom];
    directionsButton.frame = CGRectMake(0, 0, 23, 23);
    [directionsButton setBackgroundImage:[UIImage imageNamed:@"directions.png"] forState:UIControlStateNormal];

    MyPin.leftCalloutAccessoryView = directionsButton;
    MyPin.rightCalloutAccessoryView = calloutButton;
    MyPin.draggable = NO;
    MyPin.highlighted = NO;
    MyPin.animatesDrop= YES;
    MyPin.canShowCallout = YES;

    return MyPin;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:17:12.373

“硬球”方法是建立一个布尔属性，在 viewWillAppear 中设置为 false，但在按钮的操作中设置为 true。将 MyPin.animatesDrop 设置为 viewForAnnotation 中的属性。不知道任何“优雅”的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T04:36:46.760

使用代码删除所有注释

```
[self.mapView removeAnnotations:self.usersAnnotationArray]; 
```

并再次注释到 mapview ，使用`BOOL` 变量检查按钮单击并设置

```
MyPin.animatesDrop= YES; 
```

代表法

```
 -(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation 
{
......
......
......
if(_IsButtonClikced)
{
    MyPin.animatesDrop= YES;

}
else
{
    MyPin.animatesDrop= NO;

}

................
.......
.....
} 
```

# windows - “%~dp0”和“.\”之间的区别？

> ID：15890856
> 
> 赞同：7
> 
> 时间：2013-04-08T23:32:41.290
> 
> 标签：windows, batch-file, cmd

假设我正在使用一个批处理文件，并希望它指向位于批处理同一目录中的文件夹。如果我没记错的话，你会写“%~dp0\whateverfoldername”。但是仅仅写“.\whateverfoldername”就不能做到这一点吗？如果是这样，相应命令的区别和/或优势是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-09T00:04:09.260

```
pushd %~dp0 
```

通常用于更改到启动批处理的原始目录。当用户可以“以管理员身份运行”为您更改当前目录时，这在较新的操作系统中非常有用！有时间试试。做一个简单的蝙蝠

```
@echo off
echo.CD=%CD%
pushd %~dp0
echo.CD=%CD%
pause 
```

现在运行它。现在在 Vista、Win 7、Win 8、2008 Server 或 2012 Server 上再次“以管理员身份”运行它。走着瞧吧？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T23:59:17.557

`".\`将相对于`CURRENT`目录进行定位，因此如果您使用`CD`命令更改了目录，那么您将查看`THAT`目录，而不是批处理所在的目录。

事实上，创建一个单独的目录是很正常的，通常被称为`\batch`或可能`\belfry`保存批处理文件。如果有`,bat`问题位于 上`path`，它将被定位。`%dp0`将产生`.bat`.

# ios - 访问 HTML 5 播放器 - iOS SDK

> ID：15890857
> 
> 赞同：0
> 
> 时间：2013-04-08T23:32:49.830
> 
> 标签：ios, html, sdk, hpple

我正在使用 Hpple 从网页获取链接并遇到问题。因为 iOS 不支持 flash，所以我必须使用 HTML 5 播放器。我想要做的是访问播放器。如果网站加载，而用户没有 Flash，则可以选择使用 HTML 5 播放器观看视频。这就是 HTML 的样子。

```
<a href="http://www.example.com/viewvid.php?viewcode=VIEW_CODE" class="useHTML5"></a> 
```

我想知道的是如何使用 iOS SDK 访问 HTML 播放器？我一直在努力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T04:43:19.723

您链接应该加载播放器，您可以使用`<video>`标签播放视频。

```
<video src="http://example.com/path/mymovie.mov"
         controls
         height=340 width=640
         poster="http://example.com/path/poster.jpg">[enter link description here][1]
  </video> 
```

有关更多详细信息，您可以查看[https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/AudioandVideoTagBasics/AudioandVideoTagBasics.html](https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/AudioandVideoTagBasics/AudioandVideoTagBasics.html)

# autocomplete - 数字字段上的剑道自动完成

> ID：15890859
> 
> 赞同：1
> 
> 时间：2013-04-08T23:32:56.437
> 
> 标签：autocomplete, kendo-ui, numeric

尝试使用自动完成，但我的 dataTextField 是一个整数。所以我不断收到“tolower”或“indexof”错误。找不到一个人试图用数字自动完成的例子。

PS：适用于文本字段

[http://jsfiddle.net/NSLp8/](http://jsfiddle.net/NSLp8/)

```
$("#autocomplete").kendoAutoComplete({
    dataTextField: "value",
    select: function(e) {
        var dataItem = this.dataItem(e.item.index());

        //output selected dataItem
        $("#result").html(kendo.dataItem);       
    },
    dataSource: {
        data: [
            { id : 1, value: 1 },
            { id : 2, value: 2 },
            { id : 3, value: 3 },
            { id : 4, value: 4 }
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-03T19:42:00.560

作为一种解决方法，您可以尝试将`toLowerCase()`原型添加到`Number`

```
$(document).ready(function() {
  if (!Number.prototype.toLowerCase) {
    Number.prototype.toLowerCase = function() {
      return this.toString();
    }
  }
}); 
```

```
$(document).ready(function() {
  if (!Number.prototype.toLowerCase) {
    Number.prototype.toLowerCase = function() {
      return this.toString();
    }
  }
});

$("#autocomplete").kendoAutoComplete({
  dataTextField: "value",
  select: function(e) {
    var dataItem = this.dataItem(e.item.index());

    //output selected dataItem
    $("#result").html(kendo.dataItem);
  },
  dataSource: {
    data: [{
      id: 1,
      value: 1
    }, {
      id: 2,
      value: 2
    }, {
      id: 3,
      value: 3
    }, {
      id: 4,
      value: 4
    }]
  }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<link href="http://cdn.kendostatic.com/2013.2.716/styles/kendo.common.min.css" rel="stylesheet" />
<script src="http://cdn.kendostatic.com/2013.2.716/js/kendo.all.min.js"></script>
<input id="autocomplete" />
<div id="result"></div>
```

# c# - .NET 中安全身份的本地化

> ID：15890860
> 
> 赞同：10
> 
> 时间：2013-04-08T23:32:58.920
> 
> 标签：c#, .net, windows, security, sid

我正在寻找在 .NET 中实现服务/客户端通信的命名管道，并遇到了[这段代码](http://code.msdn.microsoft.com/windowsdesktop/CSNamedPipeCommunication-33b2485c/view/SourceCode)，在初始化管道的服务器端时，必须为管道设置一个安全描述符。他们是这样做的：

```
PipeSecurity pipeSecurity = new PipeSecurity();

// Allow Everyone read and write access to the pipe.
pipeSecurity.SetAccessRule(new PipeAccessRule("Authenticated Users",
    PipeAccessRights.ReadWrite, AccessControlType.Allow));

// Allow the Administrators group full access to the pipe.
pipeSecurity.SetAccessRule(new PipeAccessRule("Administrators",
    PipeAccessRights.FullControl, AccessControlType.Allow)); 
```

但我正在查看它，我担心将 SID 指定为字符串或`Authenticated Users`部分`Administrators`。有什么保证他们会被称为中文或其他语言？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-29T13:45:17.127

您可以使用 WellKnownSidType 枚举来获取 sid 并转换为 IdentityReference：

```
 var sid = new SecurityIdentifier(WellKnownSidType.AuthenticatedUserSid, null);
        var everyone = sid.Translate(typeof(NTAccount));
        security.AddAccessRule(new PipeAccessRule(everyone, PipeAccessRights.ReadWrite, AccessControlType.Allow)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-20T02:26:19.687

（摘自OP的原始问题）

我想出了这个替代方案：

```
PipeSecurity pipeSecurity = new PipeSecurity();

// Allow Everyone read and write access to the pipe.
pipeSecurity.SetAccessRule(new PipeAccessRule(
    "Authenticated Users",
    new SecurityIdentifier(WellKnownSidType.AuthenticatedUserSid, null),   
    PipeAccessRights.ReadWrite, AccessControlType.Allow));

// Allow the Administrators group full access to the pipe.
pipeSecurity.SetAccessRule(new PipeAccessRule(
    "Administrators",
    new SecurityIdentifier(WellKnownSidType.BuiltinAdministratorsSid, null),   
    PipeAccessRights.FullControl, AccessControlType.Allow)); 
```

# python - 在python中终止while循环的函数？

> ID：15890861
> 
> 赞同：2
> 
> 时间：2013-04-08T23:33:04.990
> 
> 标签：python, while-loop

我想创建一个`keep_running`可以根据输入定义的函数，以对其运行时间或迭代次数敏感。我似乎无法想出一种 Pythonic 方式来进行迭代而不减少函数外部的计数器，例如：

```
def keep_running(ttl):
    return ttl > 0

ttl = 1
while keep_running(ttl):
    do_stuff()
    ttl -= 1 
```

有没有更好的方法来做到这一点，最好是完全在功能范围内`keep_running`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:37:25.620

管理状态的最好方法可能是在一个类中。`loop_context`您可以使用一个值初始化一个对象`ttl`，然后您的循环条件将是`loop_context.keep_running()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T23:43:42.500

我不太确定你的要求。但迭代器可能对你有用。使用迭代器，它可能是：

```
>>> def keep_running(ttl):
    while ttl>0:
        yield ttl
        ttl -= 1
>>> for one_round in keep_running(3):
    print(time.time()) 
```

结果是：

```
1365464545.465
1365464545.495
1365464545.505 
```

# sql - sql server ExecuteReader 需要一个打开且可用的连接。连接的当前状态为关闭

> ID：15890865
> 
> 赞同：0
> 
> 时间：2013-04-08T23:33:26.143
> 
> 标签：sql, sql-server, timeout

我正在使用多线程应用程序从数据库中提取数据，运行几分钟后，我开始收到此异常或 sql 超时异常。我的代码如下：

```
 public static List<FlightInfo> FlightInfoAllPricesPerDayForRoute(string From, string To)
    { // Create the object array from the datareader
        List<FlightInfo> arr = new List<FlightInfo>();
        using (var conn = new SqlConnection(sConnectionString))
        {
            using (var command = new SqlCommand("FlightInfoAllPricesPerDayForRoute", conn)
            {
                CommandType = CommandType.StoredProcedure
            })
            {
                conn.Open(); command.CommandTimeout = 150;
                command.Parameters.AddWithValue("AirportFrom", From);
                command.Parameters.AddWithValue("AirportTo", To);
                // command.Parameters.AddWithValue("Date",  dt);

                //execute the stored procedure
                using (IDataReader dr = command.ExecuteReader())
                {

                    FlightInfo obj;

                    while (dr.Read())
                    {
                        obj = new FlightInfo();
                        obj.flightInfoID = (int)dr["FlightInfoID"];
                        obj.airportFrom = (string)dr["AirportFrom"];
                        obj.airportTo = (string)dr["AirportTo"];
                        obj.timeDeparture = DateTime.Parse(dr["TimeDeparture"].ToString());
                        obj.timeArrival = (DateTime)dr["TimeArrival"];
                        obj.price = (short)Int16.Parse(dr["Price"].ToString());
                        obj.dateAdded = (DateTime)dr["DateAdded"];
                        obj.carrier = (string)dr["Carrier"];

                        arr.Add(obj);
                    }

                    dr.Close(); dr.Dispose(); conn.Close(); conn.Dispose(); command.Dispose();

                }
            }
        } return arr;
    } 
```

我在连接字符串中添加了以下内容以改善超时问题，但仍然出现错误：

```
 Min Pool Size=200;Max Pool Size=32767;Asynchronous Processing=true;   Connect Timeout=150; 
```

存储过程非常简单，所以我认为那里没有问题：

```
select *,  DATEADD(dd, 0, DATEDIFF(dd, 0, TimeDeparture)) as FlightDate
from FlightInfo  
where AirportFrom = @AirportFrom and AirportTo = @AirportTo
AND TimeDeparture > GETDATE() -- Only get future flights
Order by FlightDate ASC, Price asc 
```

我也尝试运行它来检查 sql 连接，但我得到一个“用户没有执行此操作的权限。” 错误

```
 SELECT * FROM sys.dm_exec_connections 
```

任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:48:29.017

您的代码看起来不错 - 我建议您在数据库服务器上查看您的问题。如果存储过程需要很长时间才能运行和/或导致表中的大量锁定，您可能会遇到这些问题（特别是如果它被频繁调用）。一些查询优化可能是有序的。

仅供参考 - 您不需要围绕 SqlCommand 对象的“使用”块。此外，无需在您的阅读器和连接对象上调用“关闭”和“处置”——“使用”将为您处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T01:58:03.020

使用某些参数运行 SP 时出现问题，因为插入数据库的代码存在问题，这意味着在某些情况下添加了许多重复条目。当我尝试使用具有许多重复数据库条目的参数从数据库中提取数据时，SP 运行速度非常慢。删除这些重复项改善了问题。

# c++ - 提升正则表达式。命名组分为两部分

> ID：15890866
> 
> 赞同：5
> 
> 时间：2013-04-08T23:33:30.487
> 
> 标签：c++, regex, boost, regex-group, boost-regex

我有问题`boost::regex::regex_match`。我使用打开的`BOOST_REGEX_MATCH_EXTRA`.

* * *

**我有的：**

*（这是我的问题的一个简单示例，不是真正的任务）*

```
string input1= "3 4 5";
string input2= "3 4 7"; 
```

**我想得到什么：**

```
list output1= [3 4 5];
list output2= []; //not matched 
```

* * *

**正则表达式：**

*（这工作正常）*

```
((?<group>[0-6])[ ]?)* 
```

输出1：`what["group"]=5`和`what["group"].captures()= [3, 4, 5]`

输出2：`not matched`

**问题是：**

我需要从一组**以上**的正则表达式中收集数据。

**我试过了：**

```
((?<group>[0-6])[ ])*(?<group>[0-6]) 
```

输出1：`what["group"]=4`和`what["group"].captures()=[3, 4]`

输出2：`not matched`

*好的，我明白了。它没有看到第二次组声明。*

**我试过了：**

```
((?<group>[0-6])[ ])*(?&group) 
```

输出1：`what["group"]=4`和`what["group"].captures()= [3, 4, 4]`

输出2：`not matched`

*   **但是这是什么？第二个4来自哪里？**它检查“组”模式，因为第一个示例匹配，但第二个不匹配。但它使最后发现的价值翻了一番，而不是保存新的。为什么？也许我忘了打开一些标志？
*   还有另一种方法可以从正则表达式的不同部分获取一组数据吗？

* * *

我有不止一组，所以 token_iterator 帮不了我。

并且表达式应该在配置文件中配置。不能使用静态 Xpressive。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T00:20:15.167

这就是我解释你的问题的方式：

细绳： `Total price: $1,234`

并且您想将成本捕获为`1234`（不带逗号）

仅使用正则表达式是不可能的，因为无法捕获组并排除中间的部分。话虽如此，您可以使用 2 个匹配组和前瞻，然后在内部代码将这些组缝合在一起。使用上面的示例，如果您不知道是否会有逗号（即价格范围为 1-5000），您可以执行类似的操作

`Total price: \$(?P<price>\d{1,3})(?:(?=\,),(?P<price2>\d{3})|)`

其中匹配 1-3 个数字，然后查找逗号，如果存在，则使用不同的名称组并匹配第二个块。

这是一个非常好的正则表达式测试资源：[www.regex101.com](http://www.regex101.com)

# firebase - 在 Firebase 中管理排序列表的策略

> ID：15890869
> 
> 赞同：1
> 
> 时间：2013-04-08T23:33:42.917
> 
> 标签：firebase

如果我有一个包含一百万个项目的主列表，另一个包含一百万个用户的列表，并且每个用户都有一个包含 50 个项目的自定义排序子集，那么建模的直接方法是：

```
items
    [itemID] : { name : 'aaa', description : 'bbb', ... }
    ...

users
    [userID1] : {  
        name : 'john', 
        token : 'xyz',
        sortedItems : {
            itemID1 : xx,
            itemID2 : xx,
            ...
        } 
    } 
```

每个用户都会以任何需要的顺序获得他们自己的 sortedItems 集合。这样做的问题是您必须对每个项目有多个请求才能获取完整的项目数据。处理排序列表的更新后，您需要查询主列表以获取项目数据。没什么大不了的，但这是推荐的吗？

另一种策略是在主列表和子列表中复制项目数据（或删除主列表）。这样，当您需要时，所有数据就在那里。明显的问题是同步。如果项目的属性发生变化会发生什么？您必须遍历每个用户的 sortedItems 列表并更新每个实例——这是导致严重数据不一致的原因。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:43:04.953

这是推荐的方法。反规范化在可扩展系统中非常常见，应该适用于您的用例。

我建议只复制密钥，而不是数据。这样你就没有同步问题，每个人都将共享一个主状态。加载每个项目时会产生额外的往返，但请注意 Firebase 在处理大量回调和缓存更新方面非常聪明，所以我怀疑你会发现它仍然相当快。

# javascript - 无法将 QQuickText 分配给 QString

> ID：15890871
> 
> 赞同：3
> 
> 时间：2013-04-08T23:34:27.343
> 
> 标签：javascript, qml, qstring

我正在尝试在 qml-javascript 中动态创建对象。创建对象的函数是：

```
function createSpriteObjects(xPos,yPos,cnt,imgsrc,jsonObject) {
    var title;
    title = jsonObject.matches[cnt].recipeName;
    var component = Qt.createComponent("FlickItem.qml");
    component.createObject(wall.contentItem, {"color":"white", "x":xPos,"y":yPos,"src":imgsrc,"opacity":1,"title":title});
} 
```

接收文件 (FlickItem.qml) 有一个属性字符串标题，稍后将其分配给文本项的文本字段：

```
import QtQuick 2.0

Rectangle {
id: name
opacity: 0
property string title: ""
width:100
height:100
color:"white"

property string src: ""

Image {
   id:recipeimages
   source: src
   width:240
   height:160
}
Text {
   id: title
   anchors.bottom: recipeimages.bottom
   anchors.horizontalCenter: recipeimages.horizontalCenter
   anchors.bottomMargin: 5
   color: "white"
   font.pixelSize: 24
   text:title
} 
```

返回以下错误：

> 无法将 QQuickText 分配给 QString

有什么办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-09T02:55:28.347

```
Rectangle {
id: name
//...
property string title: ""  <------ title
//...
}

Text {
   //...
   id: title   <----- title
   //...
   text:title    <---- which title ?!?!?!
} 
```

问题是您`property`绑定了*标题*标识符，并且`id`绑定了*标题*标识符。根据您的输出，您可能会尝试从`id`（而不是`property`）分配文本。

更改`id`您的`Text`组件应该可以解决您的问题。

# c# - 我可以隐藏此消息吗？>> 一个或多个应用程序正在使用 iTunes 脚本接口

> ID：15890873
> 
> 赞同：2
> 
> 时间：2013-04-08T23:34:55.523
> 
> 标签：c#, windows, api, com, itunes

我正在编写一个小的 C Sharp 程序来使用 iTunes Windows COM api 与 iTunes 交互。我的程序必须在 iTunes 启动之前和 iTunes 关闭之后运行。我希望它使用 OnQuittingEvent 检测 iTunes 何时关闭。

```
 private void itunes_OnQuittingEvent()
    {
        // Remove any handlers from the iTunes COM object.
        app.OnPlayerPlayEvent -= itunes_OnPlayerPlayEvent;
        app.OnQuittingEvent -= itunes_OnQuittingEvent;
        bniTunesRunning = false;
        // Release the COM object.
        app = null;
        Console.WriteLine("iTunes Closing!");
    } 
```

但是，随着我的 c sharp 程序运行，当我关闭 iTunes 时，我收到一条警告消息：“一个或多个应用程序正在使用 iTunes 脚本界面”，然后在 iTunes 关闭前倒计时 20 秒。

我的问题：我可以使用 iTunes Windows COM OnQuittingEvent 事件处理程序在我关闭 iTunes 应用程序时在我的 C 语言代码中取消实例化 iTunesApp 对象引用，因此屏幕上不会出现该警告消息吗？有没有办法完全抑制该警告信息？

这里提出了一个类似的问题：[关闭应用程序时如何抑制“此应用程序中仍有活动的 COM 对象”错误？](https://stackoverflow.com/questions/7601204/how-to-suppress-there-are-still-active-com-objects-in-this-application-error-w)但代码是 C++ 而不是 C Sharp。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T03:50:53.267

为了防止出现对话框，您需要减少运行时可调用包装器引用计数，然后强制收集 iTunesAppClass 引用。有关更多详细信息，请参见用户 Bonj 的[帖子](http://bytes.com/topic/c-sharp/answers/244472-how-release-close-com-object)。与他们的示例不同，我发现没有必要在收集之前将 iTunesAppClass 引用设置为 null。但是，可能取决于您的实施。我还发现我不必在循环中减少 RCW，因为我只引用了一个 COM 对象。这是一个适用于我的应用程序的示例：

```
var app = new iTunesLib.iTunesAppClass();

// do stuff

System.Runtime.InteropServices.Marshal.ReleaseComObject(app);
System.GC.Collect(); 
```

# r - 如何找到不同几何和美学的列表

> ID：15890877
> 
> 赞同：12
> 
> 时间：2013-04-08T23:35:10.857
> 
> 标签：r, ggplot2

我试图在`ggplot2`R 的包中找到美学和几何学的列表以及`help(qplot`) 没有产生任何结果的问题。我找不到仅针对美学或几何学调用帮助的方法。

在 R 中调用美学帮助的正确方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-08T23:44:50.923

我能想到的最好方法是查看`help(aes)`哪个链接

```
help(aes_colour_fill_alpha)
help(aes_group_order)
help(aes_linetype_size_shape)
help(aes_position) 
```

其中总结了各个`aes`子组。

如果您正在搜索特定的`aes`主题（例如`help(alpha)`或`help(group)`

有关 geom 的列表，请查看索引以获取帮助，位于`G`. 也许当文档`layer`完成（或开始）时，它会激发类似的列表/子分组。

您还可以使用 ggplot2 命名空间中提取相关的导出对象

```
ls(pattern = '^geom_', env = as.environment('package:ggplot2'))

 ## [1] "geom_abline"     "geom_area"       "geom_bar"        "geom_bin2d"      "geom_blank"      "geom_boxplot"    "geom_contour"   
 ## [8] "geom_crossbar"   "geom_density"    "geom_density2d"  "geom_dotplot"    "geom_errorbar"   "geom_errorbarh"  "geom_freqpoly"  
## [15] "geom_hex"        "geom_histogram"  "geom_hline"      "geom_jitter"     "geom_line"       "geom_linerange"  "geom_map"       
## [22] "geom_path"       "geom_point"      "geom_pointrange" "geom_polygon"    "geom_quantile"   "geom_raster"     "geom_rect"      
## [29] "geom_ribbon"     "geom_rug"        "geom_segment"    "geom_smooth"     "geom_step"       "geom_text"       "geom_tile"      
## [36] "geom_violin"     "geom_vline" 
```

`ggplot2`有一个未导出的字符向量`.all_aesthetics`，其中包含所有可能的美学

```
ggplot2:::.all_aesthetics 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-09T00:40:28.183

[实际文档](http://docs.ggplot2.org/current/)也有一个详细且非常方便的列表

```
 http://docs.ggplot2.org/current/ 
```

# asp.net-mvc - 使用 ViewModel 或 JSON 对象渲染视图

> ID：15890880
> 
> 赞同：1
> 
> 时间：2013-04-08T23:35:21.703
> 
> 标签：asp.net-mvc, json, asp.net-mvc-3, viewmodel

我的搜索未能找到我认为是一个很好的旅行主题。我在底部列出的选项反映了我发现的一些东西。

我需要从服务器端将视图呈现为 ViewModel 或通过 JSON 对象。JSON 对象将来自服务器。

在客户端，我使用 ajax，有时我会根据页面上的其他 id/属性来确定插入，以确定我是追加/前置/替换还是忽略放置到目标元素。

**对于 ViewModel 或 JSON 对象，我必须使用哪些选项？**

我曾考虑在编译时渲染视图的 File.Js 版本。将其作为资源包含在页面上并在`var ViewHtmlTemplate = "<div>@Model.Message</div>`. 在将所有格式化/if 语句逻辑移动到也将被 JSON 序列化的视图模型时，我必须非常自律。

或者，视图有一个脚本标签来将序列化的 ViewModel 绑定到一个 js var，然后在准备好的文档上运行一个函数。

第三个选项不是返回 JSON 对象，而是返回服务器端已经 html 渲染的视图数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:41:31.220

我所做的是在我的视图模型内部，我将有一个字段，它是一个字符串，它是一个序列化的 json 结构。

```
public class SomeVM
{
 /* other properties */
 public string jsonString { get; set; }
} 
```

在控制器中，我会将一些数据序列化到 jsonString 中。然后在视图中，我将字符串分配给一个变量

```
@model SomeVM
<script>
 var jsonVM = @( Html.Raw(Model.jsonString) );
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T00:59:41.187

我正在使用在 json 对象中返回 Html 的解决方案。如果这样做有任何问题，请告诉我。这是我的做法。

**用于渲染部分视图的控制器扩展**（包含但未在此解决方案中使用的是 RenderViewToString）。这可以在不同的答案中以各种形式找到，这些答案似乎与我不认为的我的定制版本不匹配。

```
namespace System.Web.Mvc
{
    using System.IO;

    public static class MvcControllerExtension
    {
        public static string RenderPartialViewToString(this Controller controller, string viewName = null, object model = null)
        {
            if (string.IsNullOrEmpty(viewName))
            {
                viewName = controller.ControllerContext.RouteData.GetRequiredString("action");
            }

            controller.ViewData.Model = model;

            using (StringWriter sw = new StringWriter())
            {
                ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(controller.ControllerContext, viewName);
                ViewContext viewContext = new ViewContext(controller.ControllerContext, viewResult.View, controller.ViewData, controller.TempData, sw);
                viewResult.View.Render(viewContext, sw);
                return sw.GetStringBuilder().ToString();
            }
        }

        public static string RenderViewToString(this Controller controller, string viewName = null, object model = null, string masterName = null)
        {
            if (string.IsNullOrEmpty(viewName))
            {
                viewName = controller.ControllerContext.RouteData.GetRequiredString("action");
            }

            controller.ViewData.Model = model;

            using (StringWriter sw = new StringWriter())
            {
                ViewEngineResult viewResult = ViewEngines.Engines.FindView(controller.ControllerContext, viewName, masterName);
                ViewContext viewContext = new ViewContext(controller.ControllerContext, viewResult.View, controller.ViewData, controller.TempData, sw);
                viewResult.View.Render(viewContext, sw);
                return sw.GetStringBuilder().ToString();
            }
        }
    }
} 
```

**在返回 JsonResult 的控制器动作中**

```
public JsonResult _DisplayByFoo(int catId)
{
    var myRealModel = new MyRealModel(catId);
    // .... omitted the construction of MyRealModel
    var jsonModel = new JsonModel(myRealModel);
    jsonModel.Html = this.RenderPartialViewToString("_Display", myRealModel);
    return Json(jsonModel);
} 
```

*我还在 json 对象上包含其他属性，这些属性可以帮助我确定我的插入模式。*

**在 Js 中；**在我的 AjaxCall 到 Json 操作之后。运行 OnSuccess 方法，除其他逻辑外，该方法执行以下操作。

```
$("#" + targetId).append(MyJson.Html); 
```

# java - Java XML 转换 - 奇怪的问题

> ID：15890884
> 
> 赞同：0
> 
> 时间：2013-04-08T23:35:53.083
> 
> 标签：java, xml, xslt, transform

我遇到了这个我似乎无法弄清楚的奇怪问题。到目前为止，我的转换方法似乎几乎完美无缺，但我目前正在构建的工具让我有些头疼。

这是我的方法：

这个可以正常工作并生成正确的 XML

```
 public static void transform(String filename, String filePath, String stylesheetPath, String outputTo, boolean prettyPrint, boolean excludeDeclaration) throws TransformerException, IOException {
        if (!new File(outputTo).exists()) new File(outputTo).mkdir();

        TransformerFactory factory = TransformerFactory.newInstance();
        Source xsl = new StreamSource(new File(stylesheetPath));
        Templates template = factory.newTemplates(xsl);
        Transformer transformer = template.newTransformer();
        if (!prettyPrint) {
            transformer.setOutputProperty(OutputKeys.INDENT, "no");
        } else {
            transformer.setOutputProperty(OutputKeys.INDENT, "yes");
            transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "4");
        }
        if (excludeDeclaration) transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");

        Source xml = new StreamSource(new File(filePath + filename));
        OutputStream outputStream = new FileOutputStream(outputTo + filename);
        transformer.transform(xml, new StreamResult(outputStream));
        outputStream.close();
    } 
```

使用相同的 XSLT，以下生成的 XML（或来自 XML 的内容）仅包含 Text 节点（无元素、属性等）

```
 public static Document transformInMemory(Document xmlDoc, String stylesheetPath) throws TransformerException, ParserConfigurationException, SAXException, IOException {
        TransformerFactory factory = TransformerFactory.newInstance();
        Source xsl = new StreamSource(new File(stylesheetPath));
        Templates template = factory.newTemplates(xsl);
        Transformer transformer = template.newTransformer();
        transformer.setOutputProperty(OutputKeys.INDENT, "no");
        transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "0");

        DOMSource source = new DOMSource(xmlDoc);
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        transformer.transform(source, new StreamResult(baos));

        System.out.println(baos.toString());

        // load into DocumentBuilder
        DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = domFactory.newDocumentBuilder();
        InputSource is = new InputSource(new ByteArrayInputStream(baos.toByteArray()));
        return builder.parse(is);
    } 
```

从我一直在做的所有搜索来看，我在第二种方法中似乎没有做错任何事情，但它肯定会产生一些奇怪的结果。

示例结果（不幸的是，我无法发布实际数据，所以我只是将文本替换为其他数据）

```
 <?xml version="1.0" encoding="UTF-8"?>

                     Some Text Here

                                                        A.

                                                   Some other text here

                                                        B.

                                                   Some more text here

                                                        C.

                                                   And more text here

                                                        D.

                                                   Even more text here

                     A

                1 
```

我故意将结果格式化，以便您可以准确地看到我所看到的。上面的结果就是`System.out.println(baos.toString());`. 如果我在控制台（Eclipse）中突出显示文本，缩进都在那里，但所有元素等都没有显示出来。

所以，我的问题是：谁能告诉我可能发生了什么？为什么第一个工作没有任何问题，但第二个导致上述结果？

# **编辑：**

在玩弄了我的方法之后，我想出了一个似乎可行的解决方法。我没有使用`DOMSource`，而是将 xmlDoc 转换为`InputStream`，但这似乎有点笨拙。`DOMSource`关于为什么会导致这个问题的任何想法？

```
 public static Document transformInMemory(Document xmlDoc, String stylesheetPath) throws TransformerException, ParserConfigurationException, SAXException, IOException {
        TransformerFactory factory = TransformerFactory.newInstance();
        Source xsl = new StreamSource(new File(stylesheetPath));
        Templates template = factory.newTemplates(xsl);
        Transformer transformer = template.newTransformer();
        transformer.setOutputProperty(OutputKeys.INDENT, "no");
        transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "0");

        // convert the xmlDoc to an inputstream
        ByteArrayOutputStream xmlOutStream = new ByteArrayOutputStream();
        Source domSource = new DOMSource(xmlDoc);
        Result result = new StreamResult(xmlOutStream);
        TransformerFactory.newInstance().newTransformer().transform(domSource, result);
        InputStream in = new ByteArrayInputStream(xmlOutStream.toByteArray());

        //DOMSource source = new DOMSource(xmlDoc);
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        Source source = new StreamSource(in);
        transformer.transform(source, new StreamResult(baos));

        System.out.println("baos -> " + baos.toString());

        // load into DocumentBuilder
        DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = domFactory.newDocumentBuilder();
        InputSource is = new InputSource(new ByteArrayInputStream(baos.toByteArray()));
        return builder.parse(is);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T07:57:58.827

DocumentBuilder 默认情况下不支持命名空间。您需要 setNamespaceAware(true)。如果没有命名空间意识，样式表中的模板规则将不匹配，因此默认模板规则会启动，这些只是输出文本节点。

请注意，仅创建一个 DOM 来为 XSLT 提供输入是一个非常糟糕的主意。使用 XSLT 处理器的本机树表示几乎肯定会更好。

# html - 使用“if IE”条件注释来控制显示什么内容有错吗？

> ID：15890889
> 
> 赞同：0
> 
> 时间：2013-04-08T23:36:03.480
> 
> 标签：html, internet-explorer, cross-browser

我有一个简单的 HTML 登录表单，我只想将它显示给使用 Internet Explorer 的用户（根据现有设计，显然不是选择），并在任何其他浏览器访问时显示错误消息。

我的问题是，`<!--[if IE]>`如果有的话，使用正文中的标签来确定要显示的内容有多大的错误？使用这个有什么缺点吗？

**登录.html**

```
<html>
<head>
  ...
</head>
<body>

  <!--[if IE]>
    <form>
      ...
    </form>
  <![endif]-->

  <![if !IE]>
    This site can only be accessed via Internet Explorer
  <![endif]-->

</body>
</html> 
```

我很清楚我可以使用 JavaScript、CSS 或服务器端的东西来执行此操作，但我想尽可能少地更改代码和设计，并且实际上对上述方法的缺点非常好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:51:10.680

根据 MSDN，从 IE 10 开始，标准模式不支持条件注释。

[http://msdn.microsoft.com/en-us/library/ms537512(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms537512(v=vs.85).aspx)

也就是说，如果您通过使用它们来支持您需要的浏览器，那就去吧。但是，如果它们在未来被逐步淘汰，请不要感到惊讶。

此外，您的非 IE 注释语法错误。应该是两条评论，以便其他浏览器正确处理它。

```
<!--[if !IE]-->
    This site can only be accessed via Internet Explorer
<!--[endif]--> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T03:22:15.107

每当您尝试进行浏览器检测时，您的应用程序中都会存在误报的风险。浏览器检测可以有多种形式：

*   有条件的评论
*   用户代理嗅探
*   非标准 API 测试

您最好使用**特征检测**来识别您的浏览器支持/不支持什么并提供替代方案。[这是两个主题的好文章](http://msdn.microsoft.com/en-us/magazine/hh475813.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:45:38.837

在我看来，只要：

1.  您正在使用有效的 html (css & js)
2.  它适用于您选择支持的所有浏览器

那么没有理由不这样做。

很多关于 html 和 css 的内容都归结为个人喜好，只要你实现了上述目标，那就去做吧。

# javascript - 检查元素的自动模糊功能的原始值？

> ID：15890890
> 
> 赞同：0
> 
> 时间：2013-04-08T23:36:04.997
> 
> 标签：javascript, jquery, html, css

使用 javascript/jquery，我想自动将颜色值更改为与文本输入焦点相反的颜色值，然后在模糊时将它们恢复为原始颜色。到目前为止，我想出的最好的方法是将值存储在一个关联数组中，以 ID 作为键，然后以这种方式访问​​它，但我不想走那条路。有没有更好的选择？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:06:57.327

`.data()`在有问题的元素上使用 jQuery 。它专为您想要做的事情而构建。

```
$(whatever).focus(function() {
    var item = $(this);
    item.data("origVal", xxx);
}).blur(function() {
    var item = $(this);
    var originalValue = item.data("origVal");
    // do whatever you want with the original value
}); 
```

仅供参考，最好只创建一个“活动”类并使用 CSS 来控制颜色：

```
$(whatever).focus(function() {
    $(this).addClass("active");
}).blur(function() {
    $(this).removeClass("active");
}); 
```

然后，您在 CSS 中定义正常颜色，并在`active`类存在时定义特殊颜色。您可以添加/删除“活动”类并让 CSS 控制颜色。

# c++ - C ++返回字符串不断变得垃圾

> ID：15890891
> 
> 赞同：0
> 
> 时间：2013-04-08T23:36:06.490
> 
> 标签：c++, file, buffer

为什么这里的返回字符串上有各种垃圾？

```
string getChunk(ifstream &in){
char buffer[5];
for(int x = 0; x < 5; x++){
    buffer[x] = in.get();
    cout << x << " " << buffer[x] << endl;
}
cout << buffer << endl;
return buffer;
}

ifstream openFile;
openFile.open ("Bacon.txt");
chunk = getChunk(openFile);
cout << chunk; 
```

即使我的调试表明我的缓冲区正在填充正确的字符，我在字符串的末尾也有一堆垃圾。

谢谢，c++ 比 Java 难多了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T23:40:11.977

您需要 NULL 终止缓冲区。使缓冲区大小为 6 个字符并将其初始化为零。像现在一样只填写前 5 个位置，不理会最后一个。

```
char buffer[6] = {0};  // <-- Zero initializes the array
for(int x = 0; x < 5; x++){
    buffer[x] = in.get();
    cout << x << " " << buffer[x] << endl;
}
cout << buffer << endl;
return buffer; 
```

或者，使数组大小保持不变，但使用[字符串构造函数](http://en.cppreference.com/w/cpp/string/basic_string/basic_string)，该构造函数接受 a`char *`和字符数从源字符串中读取。

```
char buffer[5];
for(int x = 0; x < 5; x++){
    buffer[x] = in.get();
    cout << x << " " << buffer[x] << endl;
}
cout << buffer << endl; // This will still print out junk in this case
return string( buffer, 5 ); 
```

# python - 如何使用 Python 解析一个巨大的 xml 文件（在旅途中）

> ID：15890892
> 
> 赞同：0
> 
> 时间：2013-04-08T23:36:12.503
> 
> 标签：python, parsing, xml-parsing, wikimedia-dumps

我有一个巨大的 xml 文件（当前的[维基百科转储](http://dumps.wikimedia.org/)）。这个大小约为 45 GB 的 xml 代表当前维基百科的全部数据。该文件的前几行是（更多的输出）：

```
 <mediawiki xmlns="http://www.mediawiki.org/xml/export-0.8/" xmlns:xsi="http://ww
    w.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/x
    ml/export-0.8/ http://www.mediawiki.org/xml/export-0.8.xsd" version="0.8" xml:la
    ng="en">
      <siteinfo>
        <sitename>Wikipedia</sitename>
        <base>http://en.wikipedia.org/wiki/Main_Page</base>
        <generator>MediaWiki 1.21wmf6</generator>
        <case>first-letter</case>
        <namespaces>
          <namespace key="-2" case="first-letter">Media</namespace>
          <namespace key="-1" case="first-letter">Special</namespace>
          <namespace key="0" case="first-letter" />
          <namespace key="1" case="first-letter">Talk</namespace>
          <namespace key="2" case="first-letter">User</namespace>
          <namespace key="3" case="first-letter">User talk</namespace>
          <namespace key="4" case="first-letter">Wikipedia</namespace>
          <namespace key="5" case="first-letter">Wikipedia talk</namespace>
          <namespace key="6" case="first-letter">File</namespace>
          <namespace key="7" case="first-letter">File talk</namespace>
          <namespace key="8" case="first-letter">MediaWiki</namespace>
          <namespace key="9" case="first-letter">MediaWiki talk</namespace>
          <namespace key="10" case="first-letter">Template</namespace>
          <namespace key="11" case="first-letter">Template talk</namespace>
          <namespace key="12" case="first-letter">Help</namespace>
          <namespace key="13" case="first-letter">Help talk</namespace>
          <namespace key="14" case="first-letter">Category</namespace>
          <namespace key="15" case="first-letter">Category talk</namespace>
          <namespace key="100" case="first-letter">Portal</namespace>
          <namespace key="101" case="first-letter">Portal talk</namespace>
          <namespace key="108" case="first-letter">Book</namespace>
          <namespace key="109" case="first-letter">Book talk</namespace>
          <namespace key="446" case="first-letter">Education Program</namespace>
          <namespace key="447" case="first-letter">Education Program talk</namespace
    >
          <namespace key="710" case="first-letter">TimedText</namespace>
          <namespace key="711" case="first-letter">TimedText talk</namespace>
        </namespaces>
      </siteinfo>
      <page>
        <title>AccessibleComputing</title>
        <ns>0</ns>
        <id>10</id>
        <redirect title="Computer accessibility" />
        <revision>
          <id>381202555</id>
          <parentid>381200179</parentid>
          <timestamp>2010-08-26T22:38:36Z</timestamp>
          <contributor>
            <username>OlEnglish</username>
            <id>7181920</id>
          </contributor>
          <minor />
          <comment>[[Help:Reverting|Reverted]] edits by [[Special:Contributions/76.2
    8.186.133|76.28.186.133]] ([[User talk:76.28.186.133|talk]]) to last version by 
    Gurch</comment>
          <text xml:space="preserve">#REDIRECT [[Computer accessibility]] {{R from C
    amelCase}}</text>
          <sha1>lo15ponaybcg2sf49sstw9gdjmdetnk</sha1>
          <model>wikitext</model> 
```

...等等

注意树中的**页面**元素。它对应于 Wikipedia 中的唯一页面。给定的 XML 以页面元素的形式包含 Wikipedia 的所有页面。我需要编写一个解析器，在其中我需要从页面中提取所有维基百科页面的标题条目的值，并假设（为简单起见）打印它们。

我正在尝试使用 Python 构建相同的内容（尽管如果提供解决方案，我愿意切换语言）。我知道的唯一方法是使用[ElementTree](http://docs.python.org/2/library/xml.etree.elementtree.html)。

但是，使用函数 parse('file.xml') 需要首先完全解析整个文档，然后输出任何结果。很明显，我*知道*整个 xml 由页面元素组成。我希望程序在解析 xml 的其余部分时开始打印标题。这还可能吗。如果是这样，怎么做？

编辑注意：我在这里引用了一个提取标题的示例，以使问题保持​​简单。但是，我确实需要 xml 解析功能，因为我需要在将来提取相同的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:58:24.330

您需要的是一个基于事件的 XML 库，它会在增量解析时向您发送片段，而不是为整个文档创建树。典型的答案是[xml.sax 标准库模块](http://docs.python.org/2/library/xml.sax.html)，尽管我确信还有很多其他模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T01:59:19.830

我没有尝试使用这么大的数据集，但我发现[lxml 模块](http://lxml.de/index.html#download)既快速又有用。

[此处](http://lxml.de/tutorial.html)的 lxml.etree 教程提供了一个可能具有指导意义的示例。

关键段落是：

> iterparse() 的一个非常重要的用例是解析生成的大型 XML 文件，例如数据库转储。大多数情况下，这些 XML 格式只有一个主要数据项元素直接挂在根节点下方，并且重复了数千次。在这种情况下，最好的做法是让 lxml.etree 进行树构建，并且只在这个元素上截取，使用正常的树 API 进行数据提取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:49:46.460

当然，这是可能的。以一种丑陋的方式，您可以在文本模式下逐行读取文件。然后使用正则表达式或仅使用简单的字符串搜索方法（关键字 as 和 ）作为​​过滤器以获取以下形式的行

```
<title>AccessibleComputing</title> 
```

然后，您可以获得头衔，并做您想做的事。

# jquery - 从jquery客户端表单获取数据到python服务器

> ID：15890895
> 
> 赞同：-2
> 
> 时间：2013-04-08T23:36:43.510
> 
> 标签：jquery, python, browser

我想做一个网络浏览器 XML 生成器。输入将是 jQuery 动态形式，对于服务器端（生成 XML），我将使用 Python。如何将 jQuery 表单数据发送到 Python？我应该使用哪个框架？我尝试使用 web.py，但无法完成。我想让事情变得小而简单。请帮忙 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:43:01.730

您可以使用[Python CGI](http://docs.python.org/3.3/library/cgi.html)。这个问题也可能有帮助 - [How to run a python cgi web server in windows](https://stackoverflow.com/questions/14160709/how-to-run-a-python-cgi-web-server-in-windows?rq=1)。

# c - 如何手动引起中断？

> ID：15890897
> 
> 赞同：3
> 
> 时间：2013-04-08T23:36:47.030
> 
> 标签：c, linux, linux-kernel

我正在为 Linux 内核中的虚拟设备编写设备驱动程序。因为它是虚拟的，请问是否有任何命令或技术可以手动触发中断只是为了测试我的中断处理程序？

目前我的中断处理程序就像这样简单：

```
static irqreturn_t interrupt_handler(int irq, void *dev_id){
    printk(KERN_ALERT "Interrupt handler executed!\n");
    return IRQ_HANDLED;
} 
```

它由探针函数调用：

```
static int probe (struct platform_device *pdev) {
    printk("-----------------------------------------PROBE CALLED \n");
    ret = misc_register(&mydevice);
    printk("-----------------------------------------GOT MINOR:%i\n",mydevice.minor);
    struct resource *r = platform_get_resource(pdev, IORESOURCE_MEM, 0);
    if(r == NULL) {
        printk("platform_get_resource failed\n");
        return -ENODEV;
    }
    irq = platform_get_irq(pdev,0);
    if (irq < 0) {
        printk("platform_get_irq failed\n");
        return -ENODEV;
    }
    printk("Got irq =%d\n",irq);
    ret = request_irq(irq, interrupt_handler, IRQF_DISABLED, pdev->name, NULL);
    printk("Got irq, function returns %d\n.", ret);
    return ret;
} 
```

虚拟设备在板中定义为：

```
static struct resource mydevice_resources[] ={
    [0]             = {
        .start      =   20,
        .end        =   20,
        .flags      =   IORESOURCE_IRQ
    },
    [2]             = {
        .start      =   0xC0100000,
        .end        =   0xC0200000,
        .flags      =   IORESOURCE_MEM
    }
};

static struct platform_device mydevice = {
    .name           = "mydevice",
    .id             = 0,
    .num_resources          = ARRAY_SIZE(mydevice_resources),
    .resource       = mydevice_resources
}; 
```

而且，不知何故，预定义的中断`mydevice`是 20，但探测函数总是说它接收到中断 17。

我很感激任何提示。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:01:35.353

这是结束我的问题。无法手动发出中断。如果使用 android 的虚拟机，则可以使用控制台命令虚拟调用一组有限的中断和信号。该控制台可以由`telnet localhost 5554`虚拟机打开。

# c - 如何在 Linux 上正确设置串行通信

> ID：15890903
> 
> 赞同：5
> 
> 时间：2013-04-08T23:38:26.613
> 
> 标签：c, linux, embedded, serial-port, termios

我正在尝试从 FPGA 板读写数据。该板本身带有一个驱动程序，该驱动程序在插入该板时创建一个名为 ttyUSB0 的终端设备。在 FPGA 上，实现了异步接收器和发送器，它们似乎可以工作。

但是，C 方面似乎存在问题。我一直在使用一些测试向量来测试 FPGA 是否输出了正确的信息。我注意到了一些事情：

1.  设备有时无法正确打开
2.  有时无法检索或设置终端属性。
3.  读取有时是非阻塞的，并且不会检索到正确的值。

下面是我如何设置终端和文件描述符选项。大部分内容来自这里：[http ://slackware.osuosl.org/slackware-3.3/docs/mini/Serial-Port-Programming](http://slackware.osuosl.org/slackware-3.3/docs/mini/Serial-Port-Programming)

任何关于程序为什么会失败的建议或评论都会非常有帮助。

```
#include <stdio.h>   // Standard input/output definitions
#include <string.h>  // String function definitions
#include <unistd.h>  // UNIX standard function definitions
#include <fcntl.h>   // File control definitions
#include <errno.h>   // Error number definitions
#include <termios.h> // POSIX terminal control definitions

int open_port(void){

    int fd;    // File descriptor for the port
    fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY);

    if (fd == -1){
        fprintf(stderr, "open_port: Unable to open /dev/ttyUSB0 %s\n",strerror(errno));
        exit(EXIT_FAILURE);
    }

    return (fd);
}

int main(void){

    int fd = 0;              // File descriptor
    struct termios options;  // Terminal options

    fd = open_port();    // Open tty device for RD and WR

    fcntl(fd, F_SETFL);            // Configure port reading
    tcgetattr(fd, &options);       // Get the current options for the port
    cfsetispeed(&options, B230400);    // Set the baud rates to 230400
    cfsetospeed(&options, B230400);

    options.c_cflag |= (CLOCAL | CREAD);    // Enable the receiver and set local mode
    options.c_cflag &= ~PARENB;             // No parity bit
    options.c_cflag &= ~CSTOPB;             // 1 stop bit
    options.c_cflag &= ~CSIZE;              // Mask data size
    options.c_cflag |=  CS8;                // Select 8 data bits
    options.c_cflag &= ~CRTSCTS;            // Disable hardware flow control  

    // Enable data to be processed as raw input
    options.c_lflag &= ~(ICANON | ECHO | ISIG);

    // Set the new attributes
    tcsetattr(fd, TCSANOW, &options);

    ////////////////////////////////////
    // Simple read and write code here//
    ////////////////////////////////////

    // Close file descriptor & exit
    close(fd)
    return EXIT_SUCCESS
} 
```

**更新** 我已经根据第一个答案修改了我的代码。这就是我现在所拥有的：

```
#include <errno.h>      // Error number definitions
#include <stdint.h>     // C99 fixed data types
#include <stdio.h>      // Standard input/output definitions
#include <stdlib.h>     // C standard library
#include <string.h>     // String function definitions
#include <unistd.h>     // UNIX standard function definitions
#include <fcntl.h>      // File control definitions
#include <termios.h>    // POSIX terminal control definitions

// Open usb-serial port for reading & writing
int open_port(void){

    int fd;    // File descriptor for the port
    fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY);

    if (fd == -1){
        fprintf(stderr, "open_port: Unable to open /dev/ttyUSB0 %s\n",strerror(errno));
        exit(EXIT_FAILURE);
    }

    return fd;
}

int main(void){

    int              fd = 0;     // File descriptor
    struct termios   options;    // Terminal options
    int              rc;         // Return value

    fd = open_port();            // Open tty device for RD and WR

    // Get the current options for the port
    if((rc = tcgetattr(fd, &options)) < 0){
        fprintf(stderr, "failed to get attr: %d, %s\n", fd, strerror(errno));
        exit(EXIT_FAILURE);
    }

    // Set the baud rates to 230400
    cfsetispeed(&options, B230400);

    // Set the baud rates to 230400
    cfsetospeed(&options, B230400);

    cfmakeraw(&options);
    options.c_cflag |= (CLOCAL | CREAD);   // Enable the receiver and set local mode
    options.c_cflag &= ~CSTOPB;            // 1 stop bit
    options.c_cflag &= ~CRTSCTS;           // Disable hardware flow control
    options.c_cc[VMIN]  = 1;
    options.c_cc[VTIME] = 2;

    // Set the new attributes
    if((rc = tcsetattr(fd, TCSANOW, &options)) < 0){
        fprintf(stderr, "failed to set attr: %d, %s\n", fd, strerror(errno));
        exit(EXIT_FAILURE);
    }

    ////////////////////////////////
        // Simple Read/Write Code Here//
        ////////////////////////////////

    // Close file descriptor & exit
    close(fd);
    return EXIT_SUCCESS;
} 
```

澄清一下，接收器和发送器使用 8 个数据位、1 个停止位和无奇偶校验位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-09T01:13:15.787

我更喜欢[POSIX 操作系统的串行编程指南](http://www.cmrr.umn.edu/~strupp/serial.html)。

您应该删除该`fcntl(mainfd, F_SETFL)`语句，因为它不是必需的并且执行不正确（F_GETFL 之前没有完成并且缺少第三个参数）。

尝试使用[cfmakeraw](http://linux.die.net/man/3/cfmakeraw)设置非规范模式，因为您的初始化代码不完整：

```
options->c_iflag &= ~(IGNBRK | BRKINT | PARMRK | ISTRIP
        | INLCR | IGNCR | ICRNL | IXON);
options->c_oflag &= ~OPOST; 
```

对于非规范模式，还需要定义

```
options.c_cc[VMIN]  = 1;
options.c_cc[VTIME] = 2; 
```

1 和 2 只是建议值。

*在所有*系统调用 之后添加返回状态测试。

```
rc = tcgetattr(mainfd, &options);
if (rc < 0) {
    printf("failed to get attr: %d, %s\n", mainfd, strerror(errno));
    exit (-3);
} 
```

尝试使用较慢的波特率进行测试（例如 115200 甚至 9600）。

# asp.net - 没有为此对象定义无参数构造函数。MVC4 Razor，已经消除了构造函数中的任何参数

> ID：15890910
> 
> 赞同：1
> 
> 时间：2013-04-08T23:39:26.003
> 
> 标签：asp.net, asp.net-mvc-3, razor

更新：我为选择列表项添加了绑定排除。

现在，我知道没有 IEnumerable 类型的 ViewDataItem 有它们的键等等。

如果我不能将 viewModel 用于选择列表，那有什么意义呢？

在 POST 操作中出现此错误。我知道以前有人问过这个问题，但是我按照说明无济于事。有什么想法可能是错的吗？不确定我是否应该包含视图...

这是模型：

公共课外展{

```
 [DisplayName("Number of Mailings")]
    [Range(1, 100000,ErrorMessage="Please a positive number for Number of Mailings")]
    public int mailings { get; set; }
    [DisplayName("Number of Calls")]
    public int pcalls { get; set; }
    [DisplayName("Number of Emails")]
    public int emails { get; set; }
    [DisplayName("Number of Walkins")]
    public int walkins { get; set; }
    [DisplayName("Number of Faxes")]
    public int faxes { get; set; }
    public int osid { get; set; }
    public int month { get; set; }
    public int year { get; set; }

    public Outreach()
    {
    }
}
} 
```

这是视图模型：

```
public class OutreachViewModel
  {
    [DisplayName("Outreach Specialist")]
    public SelectList OutreachSpecialist{ get; set; }
    public SelectList Year { get; set; }
    public SelectList Month { get; set; }

    public Outreach Out {get; set;}   
} 
```

这是控制器：

```
public ActionResult Create()
        {
            List<tblOutreachSpecialist> spec = repo.getAllSpecialists();
            List<pYear> years=repo.getAllYears();
            List<pMonth> months=repo.getAllMonths();

            OutreachViewModel vw = new OutreachViewModel();

            vw.Year = new SelectList(years, "id", "pYear1");
            vw.Month = new SelectList(months, "id", "pMonth1");
            vw.OutreachSpecialist = new SelectList(spec, "OSID", "LastName");

            return View(vw);
        }

        [HttpPost]
        public ActionResult Create(OutreachViewModel vm)
        {
            if (ModelState.IsValid)
            {
                repo.Add(vm.Out);
                repo.Save();

            }
            return View(vm);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T01:06:54.980

考虑为 post 方法使用不同的视图模型。

```
 public class OutreachViewModelForCreate
            {
                public Outreach Out { get; set; }
            } 
```

然后，让您的发布操作采用更简单的视图模型。如果模型状态无效并且您需要重新显示视图以获取新的用户输入，则可以调用方法将创建视图模型转换为显示视图模型的实例：

```
 [HttpPost]
            public ActionResult Create(OutreachViewModelForCreate result)
            {
                if (ModelState.IsValid)
                {
                    //write to repo
                }
                var displayVm = getCreateDisplayViewModel();

                displayVm.Out = result.Out;

                return View(displayVm);
            } 
```

您也可以使用自定义模型绑定器，但我个人更喜欢这种模式。

更新：我看到你使用了绑定排除。我会把这个留在这里以防万一。

# ruby-on-rails - HTTP 错误 (406)：Ruby on Rails 和 Savon

> ID：15890911
> 
> 赞同：0
> 
> 时间：2013-04-08T23:39:29.520
> 
> 标签：ruby-on-rails, http, savon, http-status-code-406

好吧，我正在使用 Savon 来使用wash_out SOAP 服务器。

一切似乎都很好，因为我可以发送我的 SOAP 消息并且服务器可以将它们保存到 mysql 数据库中。

我的问题出现在我的客户端发送请求之后，因为我收到了 HTTP 错误 (406)：来自如下所示的请求：

```
response = client.call(:crear_articulo) do
  message texto: ":3", titulo: ":'("
end 
```

在服务器中，我有以下代码：soap_action "crear_articulo", :args => { :texto => :string, :titulo => :string }, :return => :string

处理请求的方法是这样的：

```
def crear_articulo
  @ar = Articulo.new
  @ar.titulo = params[:titulo]
  @ar.texto = params[:texto]
  if @ar.save
    render :soap => "Correcto"
  else
    render :soap => "Error"
  end
end 
```

我猜错误在服务器中，但是我看不到它在哪里。非常感谢。

# haskell - 如何终止 ghci 中的套接字服务器？

> ID：15890912
> 
> 赞同：4
> 
> 时间：2013-04-08T23:39:39.230
> 
> 标签：haskell, ghci

我用 webserver 包编写了一个网络服务器，并且可以在 ghci 中启动它：

```
:main localhost 8000 
```

如果我`Ctrl-C`再次运行它，我会得到

```
*** Exception: bind: resource busy (Address already in use) 
```

所以套接字似乎绑定到我的 ghci 会话。

如何释放该端口绑定，以便在`:reload`不退出 ghci 的情况下重新启动它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T02:13:14.360

如果底层服务器实现未[`REUSE_ADDR`](http://hackage.haskell.org/packages/archive/network/2.4.0.1/doc/html/Network-Socket.html#v%3aReuseAddr)在套接字上设置选项，通常会发生这种情况。

通常，如果您突然终止服务器，操作系统会将该服务器的旧端口保持在 2MSL 状态几分钟，以防止该端口上的新服务器意外接收到用于先前连接的旧消息。如果您`REUSE_ADDR`在尝试绑定端口时设置，则指定您希望在 2MSL 周期结束之前强制重用它。

解决此问题的唯一方法是`REUSE_ADDR`在绑定侦听套接字之前修改用于设置选项的底层 Web 服务器的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T01:38:59.150

你在 Linux 上吗？如果是，我认为您必须使用`lsof`来找出哪个进程正在使用给定端口，然后只需终止 PID。我在 Python 中使用 Flask 时已经遇到过这样的问题，所以我认为这里是一样的。你让 ghci 保持打开状态，终止进程，然后重新加载 ghci。这不是一个优雅的方法，但如果它有效，那就太好了！

# javascript - 通过nodejs中的url获取哈希

> ID：15890914
> 
> 赞同：1
> 
> 时间：2013-04-08T23:39:55.707
> 
> 标签：javascript, node.js, express

我必须从 bcrypt 生成的哈希中重置密码...

```
hash = $2a$11$Ro/Y5GnkI6v1DkewwZAcBeZY7Q2a9872NUGDuXXes4J5SWfEQGHvG 
```

问题是哈希有一个斜线......所以在我的路由器中

```
app.get('/getHash/:hash',routes.getResetHash); 
```

我收到 404 错误！我认为问题是哈希中 $Ro 和 Y5G 之间的斜线，因为哈希尝试搜索这样的 url

```
app.get('/getHash/$2a$11$Ro/Y5GnkI6v1DkewwZAcBeZY7Q2a9872NUGDuXXes4J5SWfEQGHvG'..... 
```

我怎样才能对哈希进行字符串化... ???

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T23:42:37.247

您想要 URL 转义哈希。Javascript 有两个函数，`encodeURI`并且`encodeURIComponent`......你想要后者，因为你只想编码它的一个部分，包括斜杠：

```
uri_safe_hash = encodeURIComponent(hash) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:46:08.387

用于`encodeURIComponent`URI 转义特殊字符，如`/`,`&`和`?`. 在这种情况下，您的哈希将像这样包装：

```
var hash = encodeURIComponent('$2a$11$Ro/Y...872NUGDuXXes4J5SWfEQGHvG'); 
```

在服务器端，它应该自动重新转换转义参数，但您需要检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T00:07:26.327

你可以这样做：

```
app.get('/getHash/:hash1/:hash2', routes.getResetHash); 
```

然后在 routes.getResetHash 你可以加入 hash1 和 hash2 参数：

```
routes.getResetHash = function(req, res){
  var hash = req.params.hash1 + '/' + req.params.hash2;
}); 
```

# c# - 在 C# 中是否可以在没有管理员权限的情况下以只读方式打开另一台计算机的注册表？

> ID：15890915
> 
> 赞同：0
> 
> 时间：2013-04-08T23:39:58.327
> 
> 标签：c#, registry

在 C# 中是否可以在没有管理员权限的情况下以只读方式打开另一台计算机的注册表？具体来说，我想阅读 LocalMachine/Software/...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:44:17.930

不可以。您必须是`Local Administrators`远程计算机上组的成员，并在尝试访问注册表时为该帐户提供适当的凭据。远程机器也必须配置为允许该访问。

# xml - 如何在 xslt 中用分号和空格分隔多个条目并删除重复项

> ID：15890922
> 
> 赞同：1
> 
> 时间：2013-04-08T23:40:36.517
> 
> 标签：xml, xslt-1.0

我有如下的xml

```
 <?xml version="1.0" standalone="yes"?>
  <epdata dbname="psyh">
<record plink="http://search.ebscohost.com/login.aspx?direct=true&amp;db=psyh&amp;AN=2009-00375-006&amp;site=ehost-live&amp;EPSource=esi">
    <item name="SubjectKeyword">life-threatening food refusal</item> 
    <item name="SubjectKeyword">life-threatening food refusal</item> 
            <item name="SubjectKeyword">nine-year-old girls</item> 
            <item name="SubjectKeyword">Maudsley model</item> 
    <item name="SubjectKeyword">family-based treatment</item> 
            <item name="SubjectKeyword">anorexia nervosa</item> 
            <item name="SubjectKeyword">eating disorders</item>
            <subitem name="ClassDescrip">Eating Disorders</subitem>
            <subitem name="ClassDescrip">Group & Family Therapy</subitem> 
            <subitem name="SubjMajDescrip">Anorexia Nervosa</subitem>
            <subitem name="SubjMajDescrip">Eating Behavior</subitem>
    <subitem name="SubjMajDescrip">Eating Disorders</subitem>
    <subitem name="SubjMajDescrip">Family Therapy</subitem>
    <subitem name="SubjMajDescrip">Food</subitem>
    <subitem name="SubjMinorDescrip">Threat</subitem> 
    <subitem name="SubjMinorDescrip">Food Refusal</subitem>

            </record>
            </epdata> 
```

使用 xslt 1.0 我想要一个如下所示的输出

“威胁生命的拒食；九岁女孩；莫兹利模型；家庭治疗；神经性厌食症；饮食失调；团体和家庭治疗；饮食行为；家庭治疗；食物；威胁；拒绝食物”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T05:24:46.183

**这个 XSLT 1.0 转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kElemByVal" match="record/*"
  use="translate(.,
                 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                 'abcdefghijklmnopqrstuvwxyz')"/>

 <xsl:template match=
 "record/*
   [generate-id()
   =
    generate-id(key('kElemByVal',
               translate(.,
                 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                 'abcdefghijklmnopqrstuvwxyz'))[1])]">
   <xsl:if test="not(position()=1)">; </xsl:if>
   <xsl:value-of select="."/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时**（纠正了一个错误）：

```
<epdata dbname="psyh">
    <record plink="http://search.ebscohost.com/login.aspx?direct=true&amp;db=psyh&amp;AN=2009-00375-006&amp;site=ehost-live&amp;EPSource=esi">
        <item name="SubjectKeyword">life-threatening food refusal</item>
        <item name="SubjectKeyword">life-threatening food refusal</item>
        <item name="SubjectKeyword">nine-year-old girls</item>
        <item name="SubjectKeyword">Maudsley model</item>
        <item name="SubjectKeyword">family-based treatment</item>
        <item name="SubjectKeyword">anorexia nervosa</item>
        <item name="SubjectKeyword">eating disorders</item>
        <subitem name="ClassDescrip">Eating Disorders</subitem>
        <subitem name="ClassDescrip">Group &amp; Family Therapy</subitem>
        <subitem name="SubjMajDescrip">Anorexia Nervosa</subitem>
        <subitem name="SubjMajDescrip">Eating Behavior</subitem>
        <subitem name="SubjMajDescrip">Eating Disorders</subitem>
        <subitem name="SubjMajDescrip">Family Therapy</subitem>
        <subitem name="SubjMajDescrip">Food</subitem>
        <subitem name="SubjMinorDescrip">Threat</subitem>
        <subitem name="SubjMinorDescrip">Food Refusal</subitem>
    </record>
</epdata> 
```

**产生想要的正确结果：**

危及生命的拒食；九岁的女孩；莫兹利模型；以家庭为基础的治疗；神经性厌食症; 饮食失调; 团体和家庭治疗；饮食行为；家庭治疗；食物; 威胁; 拒绝食物

# c - 结构和链表 (C)

> ID：15890924
> 
> 赞同：-2
> 
> 时间：2013-04-08T23:41:01.060
> 
> 标签：c, linked-list

我正在尝试实现一个链接列表来保存历史信息。

我的节点结构的定义如下：

```
struct HistoryNode {
    int Value;
    struct HistoryNode *Last, *Next;
}; 
```

我还创建了另一个结构来包含指向列表中头/尾/当前节点的指针：

```
struct _History {
    struct HistoryNode *Head, *Tail, *Current;
} History = {
    NULL, NULL, NULL,
}; 
```

最后，我创建了一个将节点添加到列表的函数：

```
void AddHistory(void) {
    struct HistoryNode *NewNode;

    //Allocate new node memory
    NewNode = malloc(sizeof(NewNode));
    if(NewNode == NULL) {
        Die("malloc(%d) failed", sizeof(NewNode));
    }

    //Re-arrange pointers in new node and head/tail/current
    if(History.Current == NULL) {
        NewNode->Next = NULL;
        NewNode->Last = NULL;

        History.Current = NewNode;
        History.Head = NewNode;
        History.Tail = NewNode;
    } else {
        NewNode->Next = NULL;
        NewNode->Last = History.Current;

        History.Current = NewNode;
        History.Tail = NewNode;
    }
} 
```

GCC 将其与几个错误一起吐出：

```
Scribe.c: In function 'AddHistory':
Scribe.c:509:15: error: request for member 'Current' in something not a structure or union
Scribe.c:513:16: error: request for member 'Current' in something not a structure or union
Scribe.c:514:16: error: request for member 'Head' in something not a structure or union
Scribe.c:515:16: error: request for member 'Tail' in something not a structure or union
Scribe.c:518:32: error: request for member 'Current' in something not a structure or union
Scribe.c:520:16: error: request for member 'Current' in something not a structure or union
Scribe.c:521:16: error: request for member 'Tail' in something not a structure or union 
```

我不确定为什么会发生这种情况，有什么帮助吗？

谢谢， - 亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:56:01.060

如果`History`声明为全局变量，则编译成功，如[http://cfiddle.net/LwucyB](http://cfiddle.net/LwucyB)所示。关于该问题的另一项说明与分配有关`NewNode`，应如下所示

```
NewNode = malloc(sizeof(struct HistoryNode)); 
```

您需要为结构分配空间，而不仅仅是指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:44:24.000

您想要 malloc sizeof(HistoryNode)，而不是 NewNode（它是指向 HistoryNode 的指针）。

# prestashop - prestashop 标志翻转问题

> ID：15890926
> 
> 赞同：0
> 
> 时间：2013-04-08T23:41:07.607
> 
> 标签：prestashop, rollover, graphical-logo

这是我第一次与 prestashop 合作，只是为了把它放在那里。我已经玩了几天，为我的主题改变了某些东西，但还有一件事让我无法理解，那就是如何使徽标成为翻转图像。我已经尝试在 header.tpl 文件和 global.css 文件中工作，如果有人可以帮助我弄清楚如何进行翻转工作，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T09:52:43.127

只需添加 global.css：

```
#header_logo:hover{

} 
```

# jquery - jQuery：加载时打开/请求全屏浏览器？

> ID：15890928
> 
> 赞同：1
> 
> 时间：2013-04-08T23:41:14.183
> 
> 标签：jquery, html, fullscreen, window-load

我有一个带有 div 的页面`#container`，我希望在支持的浏览器上进入全屏模式（或至少请求进入全屏模式）。

我下载[了这个插件](https://github.com/martinaglv/jQuery-FullScreen)

虽然示例都显示使用按钮进入全屏，但我想在加载时进行。我试过了：

```
$(window).load(function() {
        if($.support.fullscreen){
            $('#container').fullScreen();
        }
    }); 
```

它通过了支持测试（Chrome 28），但没有任何反应。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:51:19.813

经过进一步研究，出于安全原因，似乎**只能**通过**用户交互激活全屏 API。**如果有人知道其他情况，请随时发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-15T21:39:28.507

我用了一个技巧……
        我听着身体上的任何点击来激活。
例如：

```
$('body').on('click', '*', function() {
        screenfull.request();
    }); 
```

注意：它不跟踪已经有事件处理程序的按钮（等）......

# multithreading - 递归（可重入）互斥锁是如何工作的？

> ID：15890935
> 
> 赞同：1
> 
> 时间：2013-04-08T23:42:18.190
> 
> 标签：multithreading, thread-safety, mutex, recursive-mutex

[我在http://preshing.com/20120305/implementing-a-recursive-mutex](http://preshing.com/20120305/implementing-a-recursive-mutex)和[http://en.wikipedia.org/wiki/Reentrant_mutex](http://en.wikipedia.org/wiki/Reentrant_mutex)上阅读了两篇关于递归（可重入）互斥锁的文章，但这两篇文章都没有感觉。

有人可以解释递归（可重入）互斥锁的工作原理吗？

（我发现解释递归互斥锁如何工作的材料很少。如果有人有很好的解释链接，我会关闭这个问题。）

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:53:04.717

一种简单的方法是将标准互斥锁与以下辅助信息配对：

*   指向拥有互斥锁的线程的指针（或者`NULL`如果它没有被获取），以及
*   一个计数器，最初为 0。

然后，您可以通过以下方式获取互斥锁：

*   如果您是当前互斥锁所有者，请增加计数器并立即返回。
*   如果不是，则获取互斥体并将计数器设置为 0。

换句话说，如果您已经拥有互斥锁，您只需增加一个计数器，表明您现在拥有它更多。如果没有，您照常获取互斥锁。

然后，您可以通过以下方式释放互斥锁：

*   如果计数器非零，则递减计数器并立即返回。
*   否则，释放互斥锁。

为了使其工作，您需要能够以线程安全的方式读取计数器和互斥体所有者。您可以通过使用辅助互斥锁来保护它，或者通过标记 counter / owner 来做到这一点`volatile`。

希望这可以帮助！

# c++ - 为什么 atomic_flag.clear() 有一个次优的默认 memory_order 参数？

> ID：15890938
> 
> 赞同：4
> 
> 时间：2013-04-08T23:42:38.230
> 
> 标签：c++, multithreading, c++11, atomic

`std::atomic_flag`具有这些默认`std::memory_order`s 的 2 个函数：

```
void clear(std::memory_order order = std::memory_order_seq_cst);
bool test_and_set(std::memory_order order = std::memory_order_seq_cst); 
```

也许我错了，但不应该`clear` *总是*`memory_order_release`而且`test_and_set` *总是*如此`memory_order_acquire`？也许我误解了这些是做什么的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T00:10:25.360

对于 c++11 中的所有原子操作，默认的内存顺序是顺序一致性 ( `std::memory_order_seq_cst`)。如果需要，您可以指定更宽松的内存顺序，尽管这通常更复杂。

保证是无锁的`std::atomic_flag`，可用于构建其他同步方法。而`std::atomic<T>`如果编译器/库编写者选择并且仍然符合规范，则可以使用锁来实现类型。所以这就是为什么`std::atomic_flag`存在这些默认值的原因。根据您尝试执行的操作，指定不同的内存顺序可能是有意义的，但默认值设置为保守正确且具有顺序一致性。

# c++ - 直接从数组中读取时地址越界

> ID：15890942
> 
> 赞同：3
> 
> 时间：2013-04-08T23:43:14.137
> 
> 标签：c++, memory, memory-management, cuda

我正在开发一个 CUDA 应用程序，它有一些用于在共享内存中分配和释放数组的例程。

在这个应用程序中（很抱歉，我无法提供），我有一个类将一块内存封装为一个数组。这个类有一个`count`方法来计算匹配某个值的元素的数量。

所以，想象一下（这是整个班级的实际部分）

```
template <class Type>
struct Array {
    // ...

    Type &operator[](int i) { return data_[i]; }
    Type operator[](int i) const { return data_[i]; }

    size_t count(const Type &val) const {
        size_t c = 0;
        for (size_t i = 0; i < len_; ++i)
            if (data_[i] == val)
                ++c;
        return c;
    }

    void print(const char *fmt, const char *sep, const char *end) const {
        for (size_t i = 0; i < len_ - 1; ++i) {
            printf(fmt, data_[i]);
            printf(sep);
        }
        printf(fmt, _data[len_ - 1]);
        printf(end);
    }
private:
    Type *data_;
    size_t len_;
}; 
```

假设我正在访问的内存是正确分配的（在运行时分配的共享内存，将维度传递给内核），它足够大以包含数据并且`data_`指向共享内存*内*`Type`的对齐（wrt ）区域。我多次检查了这一点，这些假设应该是有效的（但请随时提出更多检查）。

 *现在，在测试代码时，我发现了一些非常奇怪的东西：

*   当使用 显式分配值`operator[]`并使用 读取它们`operator[] const`时，不会出现任何问题。
*   使用 读取数据时`print`，不会出现任何问题。
*   调用时`count()`，程序崩溃`Address ADDR is out of bounds`并被cuda-memcheck报告，由`Invalid __global__ read of size x`(x = sizeof(Type))引起。ADDR 在共享内存缓冲区内，因此它应该是有效的。
*   如果在里面`count`，我替换`data_[i]`为`(*this)[i]`，程序运行良好并且不会发生崩溃。

现在，我完全不知道会发生这种情况，也不知道要检查什么以查看幕后发生的事情……为什么直接阅读会崩溃？为什么使用`operator[]`不？为什么阅读（直接？）里面`print`不会崩溃？

我知道这个问题很难，很抱歉提供有关代码的这个小信息......但请随时询问详细信息，我会尽可能多地回答。欢迎任何想法或建议，因为这是我试图解决的日子，这是我所能得到的。

我正在使用两种不同的 GPU 来测试此代码，一个具有 2.1 的能力，一个具有 3.5 的能力（后者提供了有关此崩溃的详细信息，而第一个没有）。CUDA 5.0

编辑：我找到了一个发生此错误的最小示例。奇怪的是，使用 sm_20 和 sm_35 编译时会出现错误，但在 sm_30 上不会出现。我使用的 GPU 的上限为 3.5

```
/* Compile and run with:
  nvcc -g -G bug.cu -o bug -arch=sm_20 # bug!
  nvcc -g -G bug.cu -o bug -arch=sm_30 # no bug :|
  nvcc -g -G bug.cu -o bug -arch=sm_35 # bug!
  cuda-memcheck bug

Here's the output (skipping the initial rows) I get
Ctor for 0x3fffc10 w/o alloc, data 0x10000c8
Calling NON CONST []
Calling NON CONST []
Fill with [] ok
Fill with raw ok
Kernel launch failed with error:
        unspecified launch failure
========= Invalid __global__ write of size 8
=========     at 0x00000188 in /home/bio/are/AlgoCUDA/bug.cu:26:array<double>::fill(double const &)
=========     by thread (0,0,0) in block (0,0,0)
=========     Address 0x010000c8 is out of bounds
=========     Device Frame:/home/bio/are/AlgoCUDA/bug.cu:49:kernel_bug(unsigned long) (kernel_bug(unsigned long) : 0x8c0)
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame:/usr/lib/libcuda.so (cuLaunchKernel + 0x3dc) [0xc9edc]
=========     Host Frame:/opt/cuda-5.0/lib64/libcudart.so.5.0 [0x13324]
=========     Host Frame:/opt/cuda-5.0/lib64/libcudart.so.5.0 (cudaLaunch + 0x182) [0x3ac62]
=========     Host Frame:bug [0xbb8]
=========     Host Frame:bug [0xaa7]
=========     Host Frame:bug [0xac4]
=========     Host Frame:bug [0xa07]
=========     Host Frame:/lib/libc.so.6 (__libc_start_main + 0xfd) [0x1ec4d]
=========     Host Frame:bug [0x8c9]
=========
========= Program hit error 4 on CUDA API call to cudaDeviceSynchronize 
=========     Saved host backtrace up to driver entry point at error
=========     Host Frame:/usr/lib/libcuda.so [0x26a180]
=========     Host Frame:/opt/cuda-5.0/lib64/libcudart.so.5.0 (cudaDeviceSynchronize + 0x1dd) [0x441fd]
=========     Host Frame:bug [0xa0c]
=========     Host Frame:/lib/libc.so.6 (__libc_start_main + 0xfd) [0x1ec4d]
=========     Host Frame:bug [0x8c9]
=========
========= ERROR SUMMARY: 2 errors

(cuda-gdb) set cuda memcheck on
(cuda-gdb) run
Starting program: /home/bio/are/AlgoCUDA/bug 
[Thread debugging using libthread_db enabled]
[New Thread 0x7ffff5c25700 (LWP 23793)]
[Context Create of context 0x625870 on Device 0]
[Launch of CUDA Kernel 0 (kernel_bug<<<(1,1,1),(1,1,1)>>>) on Device 0]
Memcheck detected an illegal access to address (@global)0x10000c8

Program received signal CUDA_EXCEPTION_1, Lane Illegal Address.
[Switching focus to CUDA kernel 0, grid 1, block (0,0,0), thread (0,0,0), device 0, sm 12, warp 0, lane 0]
0x0000000000881928 in array<double>::fill (this=0x3fffc10, v=0x3fffc08) at bug.cu:26
26                              data[i] = v;
*/

#include <stdio.h>

extern __shared__ char totalSharedMemory[];

template <class Type>
struct array {
    // Create an array using a specific buffer
    __device__ __host__ array(size_t len, Type *buffer):
        len(len),
        data(buffer) {
        printf("Ctor for %p w/o alloc, data %p\n", this, data);
    }
    __device__ __host__ Type operator[](int i) const {
        printf("Calling CONST []\n");
        return data[i];
    }
    __device__ __host__ Type &operator[](int i) {
        printf("Calling NON CONST []\n");
        return data[i];
    }
    __device__ __host__ void fill(const Type &v) {
        for (size_t i = 0; i < len; ++i) data[i] = v;
    }
    size_t len;
    Type *data;
};

__global__ void kernel_bug(size_t bytesPerBlock) {
    // This is a test writing to show that filling the memory
    // does not produce any error
    for (size_t i = 0; i < bytesPerBlock; ++i) {
        totalSharedMemory[i] = i % ('z' - 'a' + 1) + 'a';
        printf("[%p] %c\n", totalSharedMemory + i, totalSharedMemory[i]);
    }

    // 200 / 8 = 25 so should be aligned
    array<double> X(2, (double *)(totalSharedMemory + 200));
    X[0] = 2;
    X[1] = 4;
    printf("Fill with [] ok\n");
    X.data[0] = 1;
    X.data[1] = 0;
    printf("Fill with raw ok\n");
    X.fill(0); // Crash here
    printf("Fill with method ok\n");
}

int main(int argc, char **argv) {
    // Total memory required
    size_t bytesPerBlock = 686; // Big enough for 85 doubles
    kernel_bug<<<1, 1, bytesPerBlock>>>(bytesPerBlock);
    cudaError_t err = cudaDeviceSynchronize();
    if (err != cudaSuccess) {
        fprintf(stderr, "Kernel launch failed with error:\n\t%s\n", cudaGetErrorString(err));
        return 1;
    }
    return 0;
} 
```

编辑：也用 CUDA 4.2 测试过，问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-09T04:22:46.310

我能够通过以下方式重现您的问题：

RHEL 5.5、驱动程序 304.54、CUDA 5.0、Quadro 5000 GPU。

我无法通过以下方式重现该问题：

RHEL 5.5、驱动程序 319.72、CUDA 5.5、Quadro 5000 GPU。

请将您的 CUDA 安装更新到 CUDA 5.5，并将您的驱动程序更新到 319.72 或更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T15:36:58.013

当您试图查明崩溃时，最好在`X.fill(0);`调用中删除从 0 到 0.0 的隐式转换。它是有效的 C++，但 CUDA 在函数调用运算符中分配临时对象时可能会遇到麻烦。确实，浏览他们的文档时，我找不到关于这些临时人员将被分配到哪里的答案——全球？设备？不过，这可能不是问题，但是……可以肯定的是。*

# c - 通过蓝牙将字符串从 Raspberry Pi 发送到 Arduino C

> ID：15890943
> 
> 赞同：2
> 
> 时间：2013-04-08T23:43:19.513
> 
> 标签：c, bluetooth, raspberry-pi

我正在尝试通过蓝牙将字符串从 Raspberry Pi 发送到通过 C 代码连接到 HC-05 蓝牙芯片的 Arduino。

我已经使用 rfcomm 套接字在 PI 上成功接收了来自 Arduino 的数据，该套接字在 Arduino 通过蓝牙加密狗写入的 PI 上进行了初始化，然后由 PI 读取。

有没有类似的方法，我可以初始化并将数据写入蓝牙加密狗以发送到 Arduino。

# vb.net - vb.net sendkeys 到特定的活动应用程序

> ID：15890944
> 
> 赞同：0
> 
> 时间：2013-04-08T23:43:40.407
> 
> 标签：vb.net, sendkeys

我已经完成了一些 sendkeys 应用程序来帮助我让我的生活更轻松，但是当我切换窗口并且我忘记关闭 sendkeys 时我很恼火，例如，我的应用程序会将“123123”发送到记事本（当前活动应用程序）直到我停止它，所以当我切换到 msword 它将无法工作，然后如果我再次切换回记事本它将再次发送键，这可能吗？如果有一些争论，比如

```
If activeWindows = notepad.exe then
    do this
Else
    do nothing
End If 
```

这只是一个想法，但我不知道如何在 vb.net 中制作类似的东西，我想使用 .exe 而不是应用程序的标题，因为我认为它非常适合我正在做的事情。

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T02:15:53.633

您可以使用`GetForegroundWindow`和`GetWindowThreadProcessId`API 为您执行此操作。这是一个简单的例子：

```
''' <summary>The GetForegroundWindow function returns a handle to the foreground window.</summary>
''' <returns>The return value is a handle to the foreground window. The foreground window can be NULL in certain circumstances, such as when a window is losing activation. </returns>
<DllImport("user32.dll", SetLastError:=True)> _
Private Shared Function GetForegroundWindow() As IntPtr
End Function

<DllImport("user32.dll", SetLastError:=True)> _
Private Shared Function GetWindowThreadProcessId(ByVal hwnd As IntPtr, _
                      ByRef lpdwProcessId As Integer) As Integer
End Function

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

    Task.Run(AddressOf KeySender)

End Sub

Private Sub KeySender()
    While (True)

        Dim fgWin = GetForegroundWindow()
        Dim fgPid As New Integer()
        GetWindowThreadProcessId(fgWin, fgPid)

        Dim proc = System.Diagnostics.Process.GetProcessById(fgPid)
        Console.WriteLine(proc.ProcessName)

        If (proc.ProcessName = "notepad") Then
            SendKeys.SendWait("A")
        End If

        System.Threading.Thread.Sleep(1000)

    End While
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T01:25:39.213

是的，它应该工作，好主意。到目前为止，我所做的是阅读 numLock 键。只要它打开，带有 sendkeys 的计时器就会触发。一旦关闭，计时器也将停止。但是添加对当前焦点的检查将是一个很好的补充。

使用什么方法，请查看这个，我认为它适合[我如何找到当前焦点的程序？](https://stackoverflow.com/questions/8402237/how-do-i-find-the-program-with-the-current-focus)

# asp.net - ASP.NET 错误：“System.Data.DataRowView”不包含名为“ID”的属性

> ID：15890948
> 
> 赞同：0
> 
> 时间：2013-04-08T23:43:57.687
> 
> 标签：asp.net, sql, gridview

在我完成了以下网站中列出的一些步骤并解决了以前的问题后，我现在收到了这个奇怪的错误。

`'System.Data.DataRowView' does not contain a property with the name 'ID'`

这个错误在我输入后与gridview相关联`DataKeyNames="ID"`

上一个问题： [DataBinding: 'System.Data.DataRowView' 不包含同名的属性](https://stackoverflow.com/questions/6736052/databinding-system-data-datarowview-does-not-contain-a-property-with-the-name)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T00:33:45.567

错误消息告诉您，分配给 GridView 的 SqlDataSource 中的选择查询返回的结果集中不存在名为“ID”的列。

您将需要将“ID”列添加到您的选择查询（如果存在）...

```
SELECT ID, <column name>, ..., <column name> FROM <table> etc 
```

或者将 DataKeyNames 分配为分配给 GridView 的 SqlDataSource 返回的结果集中的主键列的名称。

# sql - SQL 表达式缺失错误

> ID：15890949
> 
> 赞同：0
> 
> 时间：2013-04-08T23:44:01.997
> 
> 标签：sql, oracle, sqlplus

我正在尝试从其他表中其他表中列的平均值的表中进行选择；架构如下。

**学生**( `sid`, `firstname`, l `astname`, `status`, `gpa`, `email`)

**注册**( `sid`, `classid`, `lgrade`)

**成绩**( `lgrade`, `ngrade`)

错误的查询是，

```
select sid, lastname, 
avg( select g.ngrade from grades g, enrollments e 
    where e.sid = sid and g.lgrade = e.lgrade and e.lgrade is not null 
    and g.ngrade is not null) as cgpa
from students
order by cgpa asc; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T23:45:46.893

从子查询中取出分号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T00:34:26.473

有几个问题：

*   从子查询中删除分号。
*   您正在尝试使用相关子查询作为值表达式。这很好，但你必须把它放在括号中才能这样做。我只看到一组括号，即`avg()`函数的括号。
*   您还缺少列上的别名。为了清楚地表达您的意图，您应该始终保持一致并使用别名。
*   最后，`GROUP BY`某处需要一个子句。

总而言之，我认为聚合应该在括号内。

尝试：

```
select
   sid,
   lastname, 
   (
      select avg(g.ngrade)
      from grades g, enrollments e 
      where e.sid = sid and g.lgrade = e.lgrade
      and g.ngrade is not null
   ) as cgpa
from students
order by cgpa asc; 
```

其他注意事项：`e.lgrade is not null`不需要，因为条件`g.lgrade = e.lgrade`已经确保它不会为空。

最后，我鼓励您学习 ANSI 连接语法。你以后会感谢我的。说真的，使用旧式连接是很糟糕的。

```
select
   s.sid,
   s.lastname, 
   (
      select avg(g.ngrade)
      from
         grades g
         inner join enrollments e
            on g.lgrade = e.lgrade
      where
         g.ngrade is not null
         and s.sid = g.sid
   ) as cgpa
from students s
order by cgpa asc; 
```

事实上，我怀疑以这种方式简单地重写查询将有助于揭示它的问题——在我看来，`grades`and`enrollments`表可能需要另一个连接条件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T00:43:56.913

两个`INNER JOIN`没有`sub-queries`- 请尝试。

```
SELECT s.sid, s.lastname, avg(g.ngrade) cgpa
FROM Students s
JOIN Enrollments e ON s.sid = e.sid
JOIN Grades g ON e.lgrade=g.lgrade
GROUP BY s.sid, s.lastname
ORDER BY 3; 
```

# c# - 使用 .Net 框架扫描磁盘未分配空间

> ID：15890951
> 
> 赞同：1
> 
> 时间：2013-04-08T23:44:18.057
> 
> 标签：c#, hard-drive, diagnostics

我想在 dotNet (C#) 中进行文件恢复编程。问题是我不知道从哪里开始。似乎 dotNet 中的所有内容都假定某种文件系统、目录和/或文件已经存在，并且我对根据操作系统不存在的文件感兴趣。

我想我必须了解更多关于文件格式、开始和结束标记以及扫描磁盘空间的字节码等（例如 jpeg 中的 0xFF、0xD8）但在我开始之前我想知道如何扫描磁盘扇区扇区，包括 dotNet 中此类字节码的未分配空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T00:13:24.033

我有一个浮动的小程序，它将按块读取磁盘，这将对您有所帮助，但它是使用 Windows API 而不是 .net 的 C++。

存储内部硬盘信息：

```
typedef struct DRIVE {
    HANDLE hDrive;
    int sector;
    int *sector_data;
    DWORD dwRead;
    int sector_size;
} drive; 
```

开放阅读：

```
/*-- Create Structure to store drive data --*/
DRIVE CDRIVE;
/*-- Open the C drive as a file --*/
CDRIVE.hDrive = CreateFile("\\\\.\\C:", GENERIC_READ, (FILE_SHARE_READ | FILE_SHARE_WRITE), NULL, OPEN_EXISTING, NULL, NULL);
/*-- Set Initial Data in Drive Structure --*/
CDRIVE.sector = 0;
CDRIVE.sector_size = WHATEVER_YOU_CHOOSE;
CDRIVE.sector_data = new int[WHATEVER_YOU_CHOOSE];

if(CDRIVE.hDrive == INVALID_HANDLE_VALUE) {
    return false;
} 
```

阅读：

```
/*-- Set the position of the reading pointer --*/
SetFilePointer(CDRIVE.hDrive, CDRIVE.sector*CDRIVE.sector_size, 0, FILE_BEGIN);
/*-- empty the previous sector data (to be honest this is only a precaution) --*/
memset(CDRIVE.sector_data, 0, sizeof(CDRIVE.sector_data));
/*-- Read the new data --*/
ReadFile(CDRIVE.hDrive, CDRIVE.sector_data, CDRIVE.sector_size, &CDRIVE.dwRead, 0); 
```

希望这对你有用！

# ios - 核心数据过滤

> ID：15890956
> 
> 赞同：0
> 
> 时间：2013-04-08T23:44:34.933
> 
> 标签：ios, objective-c, core-data

我有一个核心数据结构如下：

`Business <-------->> Employee <-------->> Address`

每个企业有多个员工，每个员工可以有多个地址。

从业务对象中，我希望能够获得指定特定条件的一个`NSArray`或`NSSet`所有对象。`Address`例如，所有街道名称都必须是唯一的。

我知道我可以覆盖，`isEqual:`但我猜这会产生意想不到的结果。否则，我一直在考虑使用`valueForKeyPath:@"@distinctUnionOfObjects"`，但我认为我不能通过条件。

这是我到目前为止的一些代码：

```
 NSMutableArray *addressArray = [NSMutableArray array];
    NSArray *employees = [Employee sortedArray];

    //loop through employees
    for (Employee *employee in employees) {
        for (Address *address in employee.addresses) {
            [addressArray addObject:address];
        }
    }

    //filter out duplicates
    addressArray = [addressArray valueForKeyPath:@"@distinctUnionOfObjects.city"]; 
```

这段代码给了我一个独特城市的列表，但是，我想要一个包含`Address`具有唯一`city`值（或其他条件）的对象的集合。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:55:45.813

我找到了一种使用[LinqToObjectiveC 库](https://github.com/ColinEberhardt/LinqToObjectiveC#distinct)的方法：

```
NSArray* addressesWithUniqueCities = [input distinct:^id(id address) {
    return [address city];
}]; 
```

看源码，底层实现如下：

```
typedef id (^Selector)(id item);

-(NSArray *)distinct:(Selector)keySelector
{
    NSMutableSet* keyValues = [[NSMutableSet alloc] init];
    NSMutableArray* distinctSet = [[NSMutableArray alloc] init];
    for (id item in self) {
        id keyForItem = keySelector(item);
        if (![keyValues containsObject:keyForItem]) {
            [distinctSet addObject:item];
            [keyValues addObject:keyForItem];
        }
    }
    return distinctSet;
 } 
```

我的最终代码最终是：

```
 NSMutableArray *addressArray = [NSMutableArray array];
    NSArray *employees = [Employee sortedEmployees];

    //loop through employees
    for (Employee *employee in employees) {
        for (Address *address in employee.addresses) {
            [addressArray addObject:address];
        }
    }

    //filter out duplicates
    NSArray *distinctAddressArray = [addressArray distinct:^id(id address) {
        return [address addressLine];
    }];

    return distinctAddressArray; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T18:51:34.453

我不确定这是你的意思，但你可以尝试类似：（未经测试）

```
+ (NSMutableArray*) addressesForBusiness:(Business*)business
                         sectionProperty:(NSString*)sectionProperty
{

    NSFetchRequest* request = [[NSFetchRequest alloc] initWithEntityName:@"Address"];
    request.predicate = [NSPredicate predicateWithFormat:@"employee.business == %@",business.objectID];
    request.sortDescriptors = @[[NSSortDescriptor sortDescriptorWithKey:sectionProperty ascending:YES]];

    NSArray* addresses = [business.managedObjectContext executeFetchRequest:request error:NULL];
    NSMutableArray* sections = [NSMutableArray new];
    NSMutableArray* currentSection = [NSMutableArray new];
    NSManagedObject* prevAddress = nil;
    for (NSManagedObject* address in addresses) {
        if (prevAddress && ([[address valueForKey:sectionProperty] isEqual:[prevAddress valueForKey:sectionProperty]])) {
            currentSection = [NSMutableArray new];
            [sections addObject:currentSection];
        }
        prevAddress = address;
        [currentSection addObject:address];
    }

    return sections;
} 
```

这将返回一个数组数组，其中每个内部数组都保存具有相同属性值的对象。在您的示例中，您可以调用：

```
[[self class] addressesForBusiness:someBusiness sectionProperty:addressLine]; 
```

# node.js - 如何安装以前精确版本的 NPM 包？

> ID：15890958
> 
> 赞同：1085
> 
> 时间：2013-04-08T23:44:51.723
> 
> 标签：node.js, npm

我使用 nvm 下载节点 v0.4.10 并安装 npm 以使用该版本的节点。

我正在尝试使用安装快递

```
npm install express -g 
```

我得到一个错误，表示需要节点版本> = 0.5.0。

好吧，这很奇怪，因为我在[这里](http://howtonode.org/e84d3e8548d86d90eb82878e4d71dc21f4d63b93/express-mongodb)遵循使用节点 v0.4.10 的 node+express+mongodb 教程的说明，所以我假设 express 对节点 v0.4.10 可用。如果我的假设是正确的，我如何告诉 npm 获取适用于我的设置的版本？

* * *

## 回答 #1

> 赞同：1821
> 
> 时间：2013-04-09T02:01:25.773

如果您必须安装旧版本的软件包，只需指定它

```
npm install <package>@<version> 
```

例如：`npm install express@3.0.0`

您还可以将`--save`标志添加到该命令以将其添加到您的 package.json 依赖项中，或者`--save --save-exact`如果您希望在 package.json 依赖项中指定确切的版本，则可以添加标志。

该`install`命令记录在这里：[https ://docs.npmjs.com/cli/install](https://docs.npmjs.com/cli/install)

如果您不确定可用的软件包版本，您可以使用：

```
npm view <package> versions 
```

也`npm view`可用于查看有关包裹的其他内容。[https://docs.npmjs.com/cli/view](https://docs.npmjs.com/cli/view)

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2017-07-03T07:47:32.640

这很容易。只需写这个，例如：

```
npm install -g npm@4.6.1 
```

或者：

```
npm install -g npm@latest    // For the last stable version
npm install -g npm@next      // For the most recent release 
```

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2015-06-08T04:20:19.987

首先删除旧版本，然后按**字面意思**运行以下命令：

```
npm install express@3.X 
```

或者

```
npm install express@4.X 
```

对于稳定的或最近的

```
npm install -g npm@latest    // For the last stable version
npm install -g npm@next      // For the most recent release 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2017-04-27T08:29:32.970

在我看来，这是最简单和最快的方法：

`$ npm -v`

4.2.0

`$ npm install -g npm@latest-3`

...

`$ npm -v`

3.10.10

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-07-25T05:32:00.250

`npm install -g npm@version`

您要降级的地方

`npm install -g npm@3.10.10`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-08-16T12:23:43.313

您可以使用以下命令更新您的 npm 包：

`npm install <package_name>@<version_number>`

例子： `npm install yargs@12.02`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-05T19:25:21.610

您可以使用以下命令安装以前版本的 npm 包：

```
npm install packagename@version 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-24T14:27:01.487

我有一种解决此类问题的通用方法，这也可能会有所帮助，尤其是在克隆存储库以在本地运行它们时，但需要对版本进行更多分析。

使用包`npm-check-updates`我验证未在其最新可用版本中声明的包的版本（根据 package.json 文件），如图所示（[https://www.npmjs.com/package/npm-check -更新](https://www.npmjs.com/package/npm-check-updates)）：

[![在此处输入图像描述](https://i.stack.imgur.com/rHXdc.png)](https://i.stack.imgur.com/rHXdc.png)

有了这些信息，我们可以验证不同包的更新状态，并决定哪些包升级/降级，哪些不升级。

假设我们决定更新所有列出的包，我们可以使用`ncu -u`仅修改您的 package.json 文件的命令。运行`npm install`以更新已安装的包和 package-lock.json。

然后，根据存储库的要求，我们可以细化所需的内容，使用 `npm view <package> versions`和 安装特定版本`npm install <package>@<version>`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-26T20:07:02.893

对于纱线用户：

```
yarn add package_name@version_number 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-26T01:32:56.150

如果您使用的是 mac，则始终可以使用 nvm，如果是 windows，则可以使用 nodist

对于窗口：[https ://changelog.com/posts/nodist-node-version-manager-for-windows](https://changelog.com/posts/nodist-node-version-manager-for-windows)

对于 Mac：[https ://github.com/nvm-sh/nvm](https://github.com/nvm-sh/nvm)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2018-07-22T06:47:05.437

在 Ubuntu 上，您可以尝试此命令。

```
sudo npm cache clean -f
sudo npm install -g n
sudo n stable 
```

具体版本：sudo n 8.11.3 而不是 sudo n stable

# twitter-bootstrap - Datepicker 日历不以模式显示

> ID：15890964
> 
> 赞同：0
> 
> 时间：2013-04-08T23:45:54.970
> 
> 标签：twitter-bootstrap, ruby-on-rails-3.2, datepicker

我对编码相当陌生，并且无法正确打开bootstrap-datepicker ( [https://github.com/Nerian/bootstrap-datepicker-rails )。](https://github.com/Nerian/bootstrap-datepicker-rails)虽然模态有效，但日期选择器不起作用 - 如果有人能帮助我指出正确的方向，我将不胜感激。

我不确定问题是否是由以下原因引起的：
A) Javascript 在错误的位置？我在标签之前有几个`<script>`under`<head>`和 datepicker 脚本`</body>`。
B) 在资产/javascripts 中缺少一些文件？我已经在这里添加了 bootstrap.js 和 bootstrap-datepicker.js。
C) 别的？

这是中的 HTML `application.html.erb`：

```
<head>
    <%= stylesheet_link_tag    "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="assets/javascripts/bootstrap.js"></script>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>
</head>

<body>

    <div id="container">
        <a id="link" href="#myModal" class="btn btn-large btn-primary" data-toggle="modal">Get started now</a>
        <div class="modal hide fade" id="myModal" aria-hidden="true">
            <div class="well">
                <input type="text" data-behaviour='datepicker' >
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            $('[data-behaviour~=datepicker]').datepicker({
                "format": "yyyy-mm-dd",
                "weekStart": 1,
                "autoclose": true
            })
        });
    </script> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T23:42:24.773

解决了我自己的问题。问题是我加载 javascript 文件的次数过多：
A）安装 gems 并`//= require`在`application.js`文件中使用
B）还将文件放在 assets/javascripts 文件夹中（这些文件在文件中第二次`//= require_tree .`加载`application.js`）
C ) 还通过`<script>`HTML 中的标签链接到文件

仅通过执行 A) 解决了该问题。希望这对其他人有帮助！

# javascript - jQuery 标题闪烁

> ID：15890967
> 
> 赞同：1
> 
> 时间：2013-04-08T23:46:32.040
> 
> 标签：javascript, jquery

我正在编写一个基本的聊天脚本，只是对以下代码有一点小插曲。基本上，我试图让页面标题“闪烁”类似于 facebook 的做法。

```
<script>
    $(function(){
        var title = $("title");

        var flash = setInterval(function(){
            $("#chatbox_2").toggleClass('notify');
            (title.text == 'blah') ? title.text("New message...") : title.text('blah');
        }, 900);
    });
</script> 
```

如果我`console.log(title.text());`返回`blah`

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T23:48:17.963

更改`title.text == 'blah'`为`title.text() == 'blah'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T23:48:25.093

`.text`在三元的条件中调用后，您缺少括号。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-08T23:52:12.110

更改文档标题的正确方法是`document.title = "New title";`

考虑到这一点，合适的 JavaScript 将是：

```
(function() {
    var toggle = false,
        chatbox = document.getElementById('chatbox_2'),
        flash = window.setInterval(function() {
            toggle = !toggle;
            chatbox.className = chatbox.className.replace(/(?:\bnotify\b\s?)?/,toggle ? 'notify ' : '');
            document.title = toggle ? "New message..." : "blah";
        },900);
})(); 
```

# html - 如何让元素填充其包含 div 的剩余垂直区域？

> ID：15890971
> 
> 赞同：1
> 
> 时间：2013-04-08T23:46:45.103
> 
> 标签：html, css, dart

我想要“走！” 按钮填充每个部分中剩余的垂直区域。其中一个部分被定义为从蓝色文本到每个部分底部的浅灰色边框的区域。

现在，它挂在右上角。

如您所见，每个部分的大小都是可变的，所以我不能只使用“静态”解决方案。此外，将来我可能会动态更改每个部分的内容，这会导致进一步的回流。

我正在使用 twitter bootstrap 和 Dart，下面的代码是我用于渲染每个部分的 Dart html。

![我的问题， go 没有填充其父级的垂直区域](https://i.stack.imgur.com/652JT.png)

```
<!DOCTYPE html>

<html>
  <head>
    <title>x-search-result</title>
    <link rel="components" href="packages/widget/components/collapse.html">
  </head>

  <body>
    <element name="x-search-result" constructor="SearchResultComponent" extends="div">
      <template>
        <div class="row-fluid" style="border-bottom: 1px solid #eee;">
          <span class="span10">
            <div class="accordion-heading" >
              <a class="accordion-toggle" data-toggle="collapse">{{name}}</a>
            </div>
            <p>{{description}}</p>
          </span>
          <button class="btn span2" style="height:100%;" on-click="switchToCardView()">Go!</button>  
        </div>
        <script type="application/dart" src="xsearchresult.dart"></script>
        <script src="packages/browser/dart.js"></script>
      </template>
    </element>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T23:59:07.383

如果你做`div` `position: relative`和`button`绝对，你可以设置高度来填充：

[http://jsfiddle.net/hyXYJ/](http://jsfiddle.net/hyXYJ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T23:59:30.497

那里没有足够的信息，但这里有一个例子。

如果您的容器 div 具有相对定位，那么您可以绝对定位按钮。例如

```
div
{
position:relative;
}
button
{
position:absolute;
top:0;//it reach parent top
bottom:0;//it reach parent bottom
width:some width;
} 
```

如果您使用这种方法，请记住容器 div 中其他元素的位置。

我设法创建了一个包含引导程序的[小提琴。](http://jsfiddle.net/trajce/T95wp/)看一看

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T00:09:58.453

我发帖是为了展示我从 Alfred 的变化中得到了什么。

![不会赢得任何设计奖项，但更接近](https://i.stack.imgur.com/rTWFj.png)

修改后的代码如下：

```
<!DOCTYPE html>

<html>
  <head>
    <title>x-search-result</title>
    <link rel="components" href="packages/widget/components/collapse.html">
  </head>

  <body>
    <element name="x-search-result" constructor="SearchResultComponent" extends="div">
      <template>
        <div class="row-fluid" style="position:relative; border-bottom: 1px solid #eee;">
          <span class="span10">
            <div class="accordion-heading" >
              <a class="accordion-toggle" data-toggle="collapse">{{name}}</a>
            </div>
            <p>{{description}}</p>
          </span>
          <button class="btn offset10 span2" style="position:absolute; top:0; bottom:0;" on-click="switchToCardView()">Go!</button>  
        </div>
        <script type="application/dart" src="xsearchresult.dart"></script>
        <script src="packages/browser/dart.js"></script>
      </template>
    </element>
  </body>
</html> 
```

# c - 通过“extern”变量访问.text 段会导致未定义的行为吗？

> ID：15890980
> 
> 赞同：1
> 
> 时间：2013-04-08T23:48:12.563
> 
> 标签：c, undefined, undefined-behavior

这是文件“1.c”

```
 #include <stdio.h>
    char foo;
    int bar(){
    }
    int main(){
        printf("%d",foo);
        return 0;
    }
    //-------------------------- 
```

这是文件'2.c'

```
 void foo(){
    } 
```

编译器调用为`gcc 1.c 2.c`

以上是否给出了未定义的行为？我的猜测是，**是**的。否则几乎不可能进行优化。

> > 同一实体的多个不同定义（类、模板、枚举、内联函数、静态成员函数等） [C++ 程序员应该了解哪些常见的未定义行为？

但据我所知，`char foo`只产生一个**弱符号**，可以在链接时被*void foo(){}*覆盖。此外，如果我`char foo`变成`extern char foo`，那仍然是一个**定义**吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:10:53.787

它会导致未定义的行为，是的。标准中可能有很多明确引用各种类型的声明等等，但总结一下：

> 在构成整个程序的一组翻译单元和库中，具有外部链接的特定标识符的每个声明都表示相同的对象或函数。(6.2.2)
> 
> 所有引用相同对象或函数的声明都应具有兼容的类型；否则，行为是未定义的。(6.2.7)

`char foo;`在您的示例中是一个暂定定义。如果你使用`extern`，它不会是一个定义，但它仍然是一个声明，上面仍然适用。

# php - 如何在 Zend Framework 1 中执行另一个模块的引导程序中存在的模块引导程序资源？

> ID：15890985
> 
> 赞同：1
> 
> 时间：2013-04-08T23:48:28.717
> 
> 标签：php, zend-framework, module, bootstrapping

我`Zend_Application_Module_Bootstrap`在各种模块目录中引导我的应用程序。如何要求首先执行另一个模块引导程序中的资源？

```
// app/modules/user/Bootstrap.php
class User_Bootstrap extends Zend_Application_Module_Bootstrap
{
    protected function _initUser()
    {
    }
}

// app/modules/author/Bootstrap.php
class Author_Bootstrap extends Zend_Application_Module_Bootstrap
{
    protected function _initAuthor()
    {
        $this->bootstrap('user'); // Fatal:  Resource matching 'user' not found
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T00:31:38.837

我决定使用插件来实现这种细粒度的功能，因为无法正确管理执行顺序，因此使模块引导程序成为放置具有依赖关系的代码的糟糕选择。

使用下面的参考答案来确定我的决定：

[以特定顺序从每个模块加载/执行基于模块的引导程序](https://stackoverflow.com/a/11133234/712558)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T03:01:20.933

根据ZF1 邮件列表中的[这个线程](http://zend-framework-community.634137.n4.nabble.com/Where-are-the-module-bootstraps-objets-saved-td3070011.html)，您可以通过应用程序引导程序的模块资源访问模块引导程序。

伙计，多嘴啊。这就是我的意思：

```
// app/modules/user/Bootstrap.php
class User_Bootstrap extends Zend_Application_Module_Bootstrap
{
    protected function _initUser()
    {
    }
}

// app/modules/author/Bootstrap.php
class Author_Bootstrap extends Zend_Application_Module_Bootstrap
{
    protected function _initAuthor()
    {
        $app = $this->getApplication(); // it's actually the application *bootstrap*
        $app->bootstrap('modules');
        $modulesResource = $app->getResource('modules'); 
        $userBootstrap = $modulesResource->user;
        $userBootstrap->bootstrap('user'); // should be cool
    }
} 
```

根据我自己的经验，只要我的一个模块级资源需要在多个模块中引用——尤其是在引导期间——我只是将该资源的引导推到应用程序级引导中。

# c# - 服务层 - 返回验证和功能结果

> ID：15890989
> 
> 赞同：4
> 
> 时间：2013-04-08T23:48:33.393
> 
> 标签：c#, asp.net-mvc, service-layer

我想知道从将在 ASP.NET MVC 中使用的服务层返回验证结果的最佳实践或任何建议。

# 选项1

```
public IEnumberable<ValidationResult> Foo(int userId, out videoId)
{
    var validationResults = new List<ValidationResult>();

    // Validation logic goes here...

    videoId = _videoService.AddVideo();

    return validationResults;
} 
```

# 选项 2

```
public ServiceResult Foo(int userId)
{
    var validationResults = new List<ValidationResult>();
    var serviceResult = new ServiceResult();

    // Validation logic goes here...

    serviceResult.ReturnObject = _videoService.AddVideo();
    serviceResult.ValidationResults = validationResults;
    return serviceResult;
}

public class ServiceResult 
{
    public IEnumberable<ValidationResult> ValidationResults { get; set; }
    public object ReturnObject { get; set; }
} 
```

我目前正在做选项 1，因为我认为选项 2 中的装箱和拆箱可能是一个痛点。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T00:21:13.553

如果`object`从您的服务层返回，您必须`returnobject`在客户端代码中转换适当的类型/值。因此，类型检查延迟到运行时，如果您不小心，则会导致无效转换异常。更重要的是，这是一个不优雅的解决方案，会污染您的代码，从而降低代码的可理解性。

如果您只想拥有一种类型，则可以使用泛型：

```
public class ServiceResult<T>
{
    public IEnumberable<ValidationResult> ValidationResults { get; set; }
    public T ResultObject
    {
      get;set;
    }
} 
```

如果您不喜欢此解决方案，您可以为每个服务方法定义一个结果类型类型。

```
public class ResultBase
{
    public IEnumerable<ValidationResult> ValidationResults { get; set; }

}
public class RegisterResult : ResultBase
{
    public Video Video{get;set;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:54:59.447

我会选择选项 2。它看起来更干净。使用选项 2，您的服务就像调用代码的黑匣子一样。它将使您能够在不影响服务层的情况下更改 UI 层。

ServiceResult 类中的属性 'ReturnObject' 不应该称为 'Result' 吗？或者在方法 Foo 中，它应该是`serviceResult.ReturnObject = _videoService.AddVideo();`

# objective-c - 缩放时CALayer知道我不知道什么

> ID：15890990
> 
> 赞同：0
> 
> 时间：2013-04-08T23:48:33.623
> 
> 标签：objective-c, uiview, calayer, zooming

如何在缩放时像 CALayer 一样流畅地绘制？

如第三张（最高）图像所示，白色边框是通过准确的`anti-aliased`渲染绘制的。

然而，我的标签（即使我设置了`contentScaleFactor`）和我的手绘圆圈（即使我打开`anti aliasing`）都不是。

我怎样才能为 UIKit 组件或手绘图形进行抗锯齿渲染，这些图形可以像 CALayer 一样平滑地缩放比例？

有什么魔力？

![小的](https://i.stack.imgur.com/4Ih7Z.png) ![中等的](https://i.stack.imgur.com/uNKQh.png) ![大的](https://i.stack.imgur.com/sd132.png)

白色边框是使用视图的 CALayer 绘制的：

```
 self.layer.cornerRadius = frame.size.width / 2.0f ;
    self.layer.borderColor = [UIColor whiteColor].CGColor ;
    self.layer.borderWidth = 3.0f ; 
```

这些数字是 UILabel 的

```
 CGFloat contentScale = self.zoomScale * [UIScreen mainScreen].scale; // Handle retina
    label.contentScaleFactor = contentScale; 
```

并给出：

```
 typedef struct {
        CGRect      rect ;
        CGColorRef  color ;
    } EventColor ; 
```

4 个圆圈是使用 CoreGraphics 绘制的

```
 ::CGContextSetAllowsAntialiasing(context, true) ;
    ::CGContextSetShouldAntialias(context, true) ;
    // ...
    EventColor ec = ...
    // ...
    ::CGContextSetFillColorWithColor(context, ec.color) ;
    ::CGContextFillEllipseInRect(context, ec.rect) ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:16:14.840

原来我误解了`contentScaleFactor`它的意思，发现我真正追求的是 CALayer 的`contentScale`.

结果是，`drawRect`任何 UIView 子类中的方法都可以继续并假装缩放比例始终设置为 1.0，前提是视图层的 contentScale 设置为反映滚动视图的当前缩放级别。

```
- (void) scrollViewDidEndZooming: (UIScrollView *) scrollView
                        withView: (UIView *) view
                         atScale: (float) scale {

    scale *= [UIScreen mainScreen].scale ;
    for (UIView * v in view.subviews) {
        v.layer.contentsScale = scale ;
        [v setNeedsDisplay] ;
    }
} 
```

上面的例子假设滚动视图包含一个不透明的容器视图，该容器视图又包含`layer.contentScale`需要调整的每个实际视图。

# delphi - 有没有办法在不实现自己的异常处理程序的情况下暂时关闭 Delphi 5 IDE 中的异常对话框？

> ID：15890991
> 
> 赞同：-1
> 
> 时间：2013-04-08T23:48:37.997
> 
> 标签：delphi, delphi-5

我有一个非常古老的 Delphi 5 项目，需要修复一个错误。

它可以正常加载到 Delphi 5 IDE 中，但是在执行时，我得到了很多由程序正确处理的 Indy 异常，*例如*“连接正常关闭”。这些不是我要修复的错误的一部分，但是由于我一次又一次地显示异常对话框，因此调试应用程序是一种令人难以置信的痛苦。

*有没有办法在不实现自己的异常处理程序的情况下*暂时关闭 Delphi 5 IDE 中的异常对话框？当只有一些特定的异常对话框（如“连接正常关闭”）不显示时，这将特别有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T05:20:10.977

在调试器设置中有一个选项“中断语言异常”。**将其关闭（取消选中）。**您可以随时执行此操作，即使是在调试会话中。

如果打开该选项，调试器将在引发异常时立即中断，即使代码随后处理它们也是如此。这在调试中有时很重要。但是，如果您对查看所有这些异常（例如您的情况）不感兴趣，也可能会很烦人。

您还可以选中“中断语言异常”，但将您不想中断的异常类型添加到该对话框中排除的异常类型列表中。我很少使用该选项，但有时它也会有所帮助。

# mercurial - hg：默认服务器名称几个本地存储库

> ID：15890993
> 
> 赞同：0
> 
> 时间：2013-04-08T23:48:53.450
> 
> 标签：mercurial

我有很多由 hgwebdir 服务的小项目，我想配置本地存储库，这样我就不需要为每个项目创建几乎相似的 hgrc 文件：

```
[paths]
default = http:/ /myserver.com/projectN
default-push = http:/ /myserver.com/projectN 
```

我可以使用这样的默认值吗？

```
[paths]
default = projectN 
```

环境变量不起作用（win7）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T20:43:49.353

您可以使用[方案扩展名](http://mercurial.selenic.com/wiki/SchemesExtension)。在你的 ~/.hgrc 中加入这样的东西：

```
[extensions]
schemes =

[schemes]
my = http://myserver.com 
```

然后您的存储库 hgrc 可以包含：

```
[paths]
default = my://projectN 
```

# android - android urlconnection强制ssl

> ID：15890996
> 
> 赞同：0
> 
> 时间：2013-04-08T23:49:27.087
> 
> 标签：android, android-networking

我正在尝试连接到端口 8080 上的服务器，但 AndroidHttpClient 强制所有不在 8080 上的东西使用 SSL。违规代码

```
 URL url = new URL("http", "google.com", 8080, "");
    HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
    urlConnection.setRequestMethod("GET");

    urlConnection.setRequestProperty("Accept", "*/*");

    urlConnection.connect(); 
```

这来自查尔斯日志。

![在此处输入图像描述](https://i.stack.imgur.com/JP1sL.png)

请注意 URL 字段使用“https://”

现在当我将端口更改为 80 时：

```
URL url = new URL("http", "google.com", 80, "");
HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
urlConnection.setRequestMethod("GET");

urlConnection.setRequestProperty("Accept", "*/*");

urlConnection.connect(); 
```

一切正常： ![在此处输入图像描述](https://i.stack.imgur.com/UJXMA.png)

我不知道为什么它在不在端口 80 上时强制它使用 SSL。AndroidHttClient 和 DefaultHttpClient 也有类似的问题。好像是安卓的问题。

# ruby-on-rails - 使用后台任务软删除大型用户帐户

> ID：15890998
> 
> 赞同：4
> 
> 时间：2013-04-08T23:49:40.847
> 
> 标签：ruby-on-rails, devise, delayed-job

我正在使用 Rails 并设计一个存储大量用户数据的应用程序。我想让用户能够像 Facebook 那样停用他的帐户，这样如果您重新登录，您的帐户就会重新激活。到目前为止，我已经使用软删除解决了这个问题。问题是，当人们删除他们的帐户时，需要软删除的数据太多，需要一段时间才能运行。自然地，我的直觉是为此使用delayed_job。但问题是，这仅适用于帐户删除，不适用于重新激活。我不希望我的用户在他们的所有数据恢复时必须坐 10 秒钟，但我也不能在后台执行此操作，因为那样他们将在他们的任何数据被恢复之前重新登录恢复。

关于如何解决这个问题的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T03:56:04.073

您需要将 soft_delete 设置为在所有相关记录上作为布尔标志进行跟踪。将默认范围设置为仅返回未设置标志的记录。当需要激活或停用时，请收集所有相关记录并使用`update_all`. 这是一个针对 13,000 条用户记录运行的示例，让您了解时间和性能：

```
1.9.2p320 :001 > User.update_all(soft_deleted: false)
  SQL (1016.3ms)  UPDATE "users" SET "soft_deleted" = 'f'
 => 13350 
```

如您所见，它在大约一秒钟内使用该标志切换击中了所有 13,000 条记录。所以，如果你想点击一个用户，一个用户的所有帖子，以及一个用户的所有 PrivateMessages，

```
User.update_attributes(soft_deleted: true)
User.posts.update_all(soft_deleted: true)
User.private_messages.update_all(soft_deleted: true) 
```

你应该很高兴。如果您要处理如此多的记录，甚至这种技术也不能很好地执行，我认为您将没有太多选择，除了告诉用户可能需要几分钟才能获得所有数据如您最初计划的那样，重新激活并将整个过程投入后台作业。

# linux - 列不完整的 Linux 文件排序

> ID：15890999
> 
> 赞同：1
> 
> 时间：2013-04-08T23:49:41.657
> 
> 标签：linux, file, sorting, multiple-columns

如果有数字条目，我需要按第一列对文件进行排序，如果第一列没有，则按第二列排序。它看起来基本上是这样的：

```
3 - foo bar
1 1 foo bar
- 5 foo bar
2 2 foo bar
- 4 foo bar 
```

然后我需要输出

```
1 1 foo bar
2 2 foo bar
3 - foo bar
- 4 foo bar
- 5 foo bar 
```

有没有什么好方法可以在 linux 中使用单个命令来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:53:57.003

在遵循该格式的输出中，您可以使用基本的排序命令：

```
sort -k 1,2 foo.txt 
```