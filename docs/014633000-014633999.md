# StackOverflow 问答 14633000-14633999

# coronasdk - 相机捕捉不能正确缩放？

> ID：14633000
> 
> 赞同：0
> 
> 时间：2013-01-31T18:51:41.947
> 
> 标签：coronasdk

在我的应用程序中，我必须通过媒体 .show() 拍摄图像。但图像无法正确缩放。请帮助我，我没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T02:29:28.550

在屏幕上显示图像后，您可以使用：

```
image:scale(xscale, yscale) 
```

或者

```
image.xScale = scale
image.yScale = scale 
```

调整图像大小以适合您需要的区域。什么“比例”取决于你想要做什么，但假设你想在屏幕上显示整个图像：

```
 scale = display.contentWidth  / image.width
 image.xScale = scale
 image.yScale = scale 
```

或类似的东西。

# php - 用透明颜色旋转图像

> ID：14633001
> 
> 赞同：3
> 
> 时间：2013-01-31T18:51:46.573
> 
> 标签：php, image-processing, transparency, image-rotation, php-gd

我打算使用 php gd 旋转具有透明颜色的图像。但是，旋转后，图像中的透明颜色不再透明，背景也不透明。这是我的代码。

```
$im = imagecreatefromgif('/images/80-2.gif');
$rotate = imagerotate($im,30,imagecolorallocatealpha($im, 0, 0, 0, 127));
imagegif($rotate,'/images/rotate.gif');
imagedestroy($im);
imagedestroy($rotate); 
```

有人可以帮我让它工作吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T18:59:03.373

为了保持图像的透明度，您需要使用两个设置，可以通过在创建 gd 资源后立即调用这些函数来完成

```
imagealphablending( $im, false );
imagesavealpha( $im, true ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T03:58:51.280

alex.michel 提出的解决方法不适用于我的 gif：背景是透明的，但不是我原始 gif 的 alpha。它是蓝色的，看起来像图形纸。关于 mishu 的解决方案，它不适用于 gif（引用自 php.net 手册）：

> **imagesavealpha()设置标志以在保存****PNG** 图像时尝试保存完整的 alpha 通道信息（与单色透明度相反） 。

对于 png 我使用它，它工作得很好：

```
 $source = imagecreatefrompng($image);
    imagealphablending($source, false);
    imagesavealpha($source, true);
    $rotated = imagerotate($source, $angle, imageColorAllocateAlpha($source, 0, 0, 0, 127));
    imagealphablending($rotated, false);
    imagesavealpha($rotated, true);
    imagepng($rotated, $image); 
```

我仍在寻找适合 gif 的东西...

# android - 精灵的RGB565？

> ID：14633003
> 
> 赞同：3
> 
> 时间：2013-01-31T18:51:53.093
> 
> 标签：android, colors, bitmap, transparency, sprite

我是否正确假设如果我有一个不规则形状的精灵（除正方形/矩形以外的任何东西）需要在背景图像上绘制，我不能使用 RGB565，因为这种格式没有用于透明度的 alpha 通道?

这是否会使 RGB565 格式对绝大多数游戏精灵有效地无用，还是我弄错了？

还有其他选择吗？哪种格式最适合我使用以获得最佳性能？

我问这个是因为我将原始位图转换为 RGB565 使用

```
options.inPreferredConfig = Bitmap.Config.RGB_565; 
```

而且它们似乎还可以——即仍然具有它们的透明度。

但是当我尝试使用 RGB565 为精灵重新着色时，它周围会出现一个黑色方块，所以我有点困惑！！！！h

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:25:54.633

您加载的 RGB565 位图似乎工作的原因是因为如果您的位图具有 alpha，它们将被加载为 ARGB444 或 ARGB8888。这`inPreferredConfig`只是一个提示，如果可能的话，您希望您的位图采用该格式。不进行任何转换。您可以通过调用`getConfig()`加载的位图来查看这一点。

您始终可以使用 RGB565 加载位图，将另一个位图加载为 A8，并将它们一起使用，但这样做的成本可能比仅使用其中一种 ARGB 格式要高。

因此，总而言之，只需使用 ARGB8888，或者如果内存有问题，则使用 ARGB4444（[尽管已弃用](http://developer.android.com/reference/android/graphics/Bitmap.Config.html)）

# jsf - 没有dataModel的JSF 2 dataTable行索引

> ID：14633008
> 
> 赞同：12
> 
> 时间：2013-01-31T18:52:18.090
> 
> 标签：jsf, jsf-2, datatable, uirepeat

我一直在使用 ui:repeat 来生成表格。使用 ui:repeat 可以很容易地使用`varStatus`. 在调用支持 bean 来处理列表导航时，我依赖于 varStatus 中的行 ID，例如在列表中向上或向下移动项目。

现在我想创建一个复合组件，该组件构建一个可定制的表格，其中包含标记行、向上/向下移动等所需的所有功能。为此，ui:repeat 不起作用，因为我看不到方法处理不同数量的列；我需要在一个地方指定标题，在另一个地方指定正文（而且我还没有达到可以创建自定义组件的知识点）。因此，我继续使用数据表，因为使用这意味着将标题指定为与正文内容相同的位置。

效果很好，直到我注意到由于某种原因`varStatus`不再存在。我已经在不需要 a 的情况下处理列表演示文稿方面做了很多工作，`datamodel`而且我不想开始使用它。有什么方法可以在不使用的情况下获取当前行号，因为它显示在表格中`datamodel`？

此外，我正在使用 viewScope，如果我理解正确，这意味着我无法将 dataTable 绑定到 bean。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-31T19:14:17.040

只需将表绑定到视图本身而不是 bean。

```
<h:dataTable binding="#{table}" ...> 
```

然后你可以`#{table.rowIndex}`在需要的地方使用。例如

```
<h:column>#{table.rowIndex + 1}</h:column> 
```

请注意，代码是原样的，EL 变量名称`table`完全由您选择。

### 也可以看看：

*   [JSF 中的“绑定”属性如何工作？何时以及如何使用它？](https://stackoverflow.com/questions/14911158/how-does-the-binding-attribute-work-in-jsf-when-and-how-should-it-be-used)

# mysql - 在 SQL 中查找员工人数超过 10 人的商店

> ID：14633010
> 
> 赞同：-2
> 
> 时间：2013-01-31T18:52:22.770
> 
> 标签：mysql, sql

鉴于我有 Table`stores_employees`有两列：

```
store_id, employee_id 
```

如何找到员工人数超过 10 人的商店？最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T18:53:56.083

`HAVING`您将在子句中使用聚合函数，并且`GROUP BY store_id`

```
select store_id
from stores_employees 
group by store_id
having count(employee_id) > 10 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/641f2/1)

如果要包括员工总数，则可以使用：

```
select store_id, count(employee_id) TotalEmployees
from stores_employees 
group by store_id
having count(employee_id) > 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T18:55:37.383

```
SELECT store_id, count(employee_id) FROM stores_employees GROUP BY store_id
HAVING COUNT(employee_id) > 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:03:08.117

从逻辑上考虑这个问题，您需要从stores_emloyees 表中计算store_id 和employee_id 的实例，其中count > 10。

只需使用命令来查看哪个显示了所需的结果。我发现这是学习 mysql 的最有效方法，而不是从网站上复制。

您可能使用的关键字：

```
SELECT
FROM
ORDER BY
BETWEEN 
```

# google-apps-script - 将值传递给从 If 语句调用的函数？

> ID：14633015
> 
> 赞同：0
> 
> 时间：2013-01-31T18:52:42.157
> 
> 标签：google-apps-script

我正在 UiApp 中创建一个表单来收集用户数据。根据他们在页面上的答案，我需要转到基于页面的答案。假设我有三页。用户完成第一页。我使用一个按钮和服务器处理程序来调用一个运行的函数和 if 语句，例如：

```
if(value1 == s1 && value2 == s2){
app.getElementById('page1').setVisible(false);
app.getElementById('page2').setVisible(true);
} 
```

这工作正常。我在第二页。从那里单击下一个按钮并调用一个syncText'函数，该函数将使用此方法加载用户数据：[如何允许用户在提交表单之前查看答案？](https://stackoverflow.com/questions/12041841/how-to-allow-users-to-review-answers-before-submiting-form)

都好。当我在第一页并且我需要转到第三页和 syncText 时，问题就出现了。

```
if( value1 != s1){
app.getElementById('page1').setVisible(false);
app.getElementById('page3').setVisible(true);
syncText()
} 
```

这不起作用。如何在 Google 的 UiApp 的 If 语句中调用函数？

我知道我可以简单地将函数重写为 if 语句，但我的真实形式要复杂得多，我想避免重复自己。有什么帮助吗？

* * *

更新：所以看起来函数正在被调用，但它无法从表单中找到值。如何将表单值输入此函数？

这是一个完整的示例代码：

```
function doGet(e){
var app = UiApp.createApplication();
var appPanel = app.createVerticalPanel();
var form = app.createFormPanel();
var panel1 = app.createGrid(4,5).setId('panel1');

 var firstNameLabel = app.createLabel("First Name:");
var firstName = app.createTextBox().setName('firstName').setId('firstName');
var lastNameLabel = app.createLabel("Last Name:");
var lastName = app.createTextBox().setName('lastName').setId('lastName');
var emailLabel = app.createLabel('Your Email');
var email = app.createTextBox().setName('email').setId('email');
 var testing = app.createServerHandler('testing').addCallbackElement(form);

var button1 = app.createButton('Go to Review');
 var info1 = app.createLabel("Please Enter First Name")
.setVisible(false)
.setStyleAttribute('color', 'red');
 var info2 = app.createLabel("Please Enter Last Name")
 .setVisible(false)
 .setStyleAttribute('color', 'red');
var info3 = app.createLabel("Please Enter Email")
.setVisible(false)
 .setStyleAttribute('color', 'red');

panel1.setWidget(0,0, firstNameLabel);
panel1.setWidget(0,1, firstName);
panel1.setWidget(0,2, lastNameLabel);
panel1.setWidget(0,3, lastName);
panel1.setWidget(1,1, info1);
panel1.setWidget(1,3, info2);
panel1.setWidget(2,0, emailLabel);
panel1.setWidget(2,1, email);
panel1.setWidget(2,3, button1);
panel1.setWidget(3,1, info3);

app.add(form);
appPanel.add(panel1);
form.add(appPanel);

var panel2 = app.createGrid(4,5).setId('panel2').setVisible(false);
var reviewFirstNameLabel = app.createLabel("First Name:");
var reviewFirstName = app.createLabel().setId('reviewFirstName');
var reviewLastNameLabel = app.createLabel("Last Name:");
var reviewLastName = app.createLabel().setId('reviewLastName');
var reviewEmailLabel = app.createLabel('Your Email:');
var reviewEmail = app.createLabel().setId('reviewEmail');
var submitButton = app.createSubmitButton('Submit');
var button2 = app.createButton('Edit Response');

panel2.setWidget(0,0, reviewFirstNameLabel); 
panel2.setWidget(0,1, reviewFirstName); 
panel2.setWidget(0,2, reviewLastNameLabel);
panel2.setWidget(0,3, reviewLastName);
panel2.setWidget(1,0, reviewEmailLabel);
panel2.setWidget(1,1, reviewEmail);
panel2.setWidget(2,0, button2);
panel2.setWidget(3,0, submitButton);
appPanel.add(panel2);

//
var editResponse = app.createClientHandler()
.forTargets(panel1).setVisible(true)
.forTargets(panel2).setVisible(false);

button1.addClickHandler(testing);
button2.addClickHandler(editResponse);

return app;
}

function syncText(e){
  var app = UiApp.getActiveApplication(); 

  app.getElementById('reviewFirstName').setText(e.parameter.firstName));
  app.getElementById('reviewLastName').setText(e.parameter.lastName);
  app.getElementById('reviewEmail').setText(e.parameter.email);
  app.getElementById('panel1').setVisible(false);
  app.getElementById('panel2').setVisible(true);
  return app;
}

function testing(e){
var app = UiApp.getActiveApplication();
var firstName = e.parameter.firstName;
var lastName = e.parameter.lastName;
var email = e.parameter.email;

if(firstName != ""){
syncText();
 } 
```

错误现在说参数未定义？所有值都形成了测试函数检查，但我似乎无法从 syncText() 中获取值。对获得此功能有任何帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T18:57:47.730

更好的方法是向每个页面添加类“页面”。

并有一些功能，如
**功能 enablePage(page_num)**

在其中隐藏每个 .page 对象，然后通过 id 启用必要的一个。

# python - IP 地址作为 AppHarbor / App Engine urlfetch 的主机名以缓存 DNS 查找

> ID：14633021
> 
> 赞同：0
> 
> 时间：2013-01-31T18:52:52.550
> 
> 标签：python, google-app-engine, dns, urllib2, appharbor

我有一个 AppHarbor 应用程序，我将其用作外部服务，我的其他使用 Google App Engine (python) 的服务器将请求该应用程序。appharbor 应用程序基本上被 ping 了很多，以处理我发送的一些数据。

因为我会不断地 ping 服务，而且时间很重要，所以是否可以通过其 IP 地址而不是主机名来引用我的 appharbor 应用程序？基本上我想消除必须进行 DNS 查找并加快响应速度。

我正在使用 Google App Engine 的 urlfetch ( [https://developers.google.com/appengine/docs/python/urlfetch/overview](https://developers.google.com/appengine/docs/python/urlfetch/overview) ) 来执行请求。是否缓存了 urlfetch 已经在幕后做的事情？如果没有，是否可以这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:28:12.473

我怀疑 DNS 查找将成为您的瓶颈，但无论如何我可以看到 DNS 查找被系统缓存（至少对于 TTL）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T20:27:32.307

理论上，您可以将请求直接发送到 IP 地址，但您还必须[传递主机标头](http://drewish.com/content/2010/03/using_curl_and_the_host_header_to_bypass_a_load_balancer)，以便 AppHarbor 路由层可以确定哪个应用程序收到了请求。

正如 Shay 所提到的，您不应该这样做 - DNS 查询被缓存并且不太可能成为瓶颈，并且您正在为自己设置损坏，因为 IP 地址可能会随着指向新 IP 的域而改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:04:08.647

注册 AppEngine Sockets Trusted Tester（[在这里](https://docs.google.com/a/postmaster.io/spreadsheet/viewform?formkey=dF9QR3pnQ2pNa0dqalViSTZoenVkcHc6MQ#gid=0)）并使用普通的 python：

```
socket.gethostbyname(...) 
```

# python - 如何在 Gtk 中显示手册？

> ID：14633027
> 
> 赞同：1
> 
> 时间：2013-01-31T18:53:11.243
> 
> 标签：python, gtk

我正在使用 Python 构建一个 Gtk3 应用程序。我想知道是否有一种标准的方式来构建和显示内联帮助（手册）。进一步来说：

1.  我应该使用什么文本格式来存储它（html？XML？其他？）
2.  我应该如何显示它？当用户请求有关用户界面特定部分的在线帮助时，我需要能够浏览内容、搜索特定术语、显示带图像的格式化文本以及在特定位置打开帮助窗口。

最后，在理想情况下，它应该是跨平台的（例如我打算将它移植到 Windows 上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T13:21:31.893

不知道您的应用程序需要是多平台的。小心，因为 Windows 上的 GTK3 暂时很难使用（AFAIK 没有官方安装程序，无论是 GTK3 还是 Windows 上的 PyGObject，只有社区的东西）。

在 Linux 上，GNOME 使用[Yelp](https://live.gnome.org/Yelp)来处理文档，但我不知道它是否已经移植到 Windows。

# javascript - 在它之外定义的对话框中的变量返回未定义的 jQuery

> ID：14633029
> 
> 赞同：1
> 
> 时间：2013-01-31T18:53:16.897
> 
> 标签：javascript, jquery

我正在使用`.load`函数打开一个对话框，然后我想从对话框中定义对话框函数外部变量的字段中获取值，但它返回未定义，所以我的问题是，如何定义对话框外部的变量在其中使用它的功能，

我想做的一个例子。

首先我请求对话框：

```
$( '#dialog-form' ).load('table_models/add_to_table.php',function(){
     $( '#dialog-form' ).dialog('open');
}); 
```

现在我定义变量和弹出对话框：

```
$(function() {
    var sku = $( "#sku" ),
    fba_sku = $( "#fba_sku" ),
    asin = $( "#asin" ), 

    $( "#dialog-form" ).dialog({
         title: 'New Product',
         autoOpen: false,
         height: 'auto',
         width: 'auto',
         modal: true,
         buttons: {
                "Done": function() {
                             // I want to get the var sku, fba_sku, asin here
                 }
         },
     }
} 
```

我希望你明白我想要做什么，如果没有，我会尝试更好地解释它，

谢谢

**编辑**

从页面上的按钮请求的`.load`功能，然后对话框功能在外部 JS 文件上，我想首先从对话框表单中定义字段的 var 并将其重用于此页面上的所有功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:57:34.513

尝试在对象之外定义函数，如下所示：

```
var cb = function() { /* stuff with sku, fba_sku, asin */ };
$("#dialog-form").dialog({
    ...
    buttons:{"Done":cb}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T18:59:11.243

您对“'现在'我定义 [...]”的理解可能存在缺陷——不清楚`ready`函数的定义位置。`.load`是异步的，将在未来的任意时间完成。

获取`"Done"`函数中的元素值，以便用最新的值填充它们。

# zend-framework2 - 在初始化程序闭包中不会调用控制器

> ID：14633031
> 
> 赞同：3
> 
> 时间：2013-01-31T18:53:24.950
> 
> 标签：zend-framework2

我想在我的 ZF2 项目中将学说实体管理器放入许多不同的类中。因此。我在我的中设置了以下**初始化程序**`Module.php`：

```
'initializers' => array(
      function ($instance, $services) {
            if (is_object($instance)) { // just for debugging
                var_dump(get_class($instance));
            }
            if (!$instance instanceof EntityManagerAwareInterface) {
                return;
            }

            $entityManager = $services->get('doctrine.entitymanager.orm_default');
            $instance->setEntityManager($entityManager);
        },
    ),
) 
```

`AuthController`然而，即使我正在访问该控制器的站点（并获得空指针异常，因为未设置实体管理器），它也永远不会被调用。当然，控制器确实实现了所需的接口：

```
class AuthController extends AbstractActionController implements EntityManagerAwareInterface 
```

还有什么我必须配置的，以便`AuthController`根据初始化程序闭包检查我的吗？

目前我把它放在**invokables**下`module.config.php`。

```
'controllers' => array(
    'invokables' => array(
        'Auth\Controller\Auth' => 'Auth\Controller\AuthController',
    ),
), 
```

当我从那里删除它时，应用程序无法再找到该类。

我的调试输出列出了根据初始化程序、许多管理器和服务检查的其他类。一小段摘录：

```
string(37) "Zend\\Mvc\\Controller\\ControllerManager"
string(33) "Zend\\Mvc\\Controller\\PluginManager"
string(29) "Zend\\View\\HelperPluginManager"
[...]
string(24) "Doctrine\\DBAL\\Connection"
string(26) "Doctrine\\ORM\\EntityManager"
string(41) "Zend\\Authentication\\AuthenticationService" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T08:54:38.750

尝试为控制器管理器添加一个初始化程序，根据您的调试输出判断，您发布的那个似乎是用于服务管理器的。您以相同的方式配置其他管理器，用于控制器管理器的方法是`getControllerConfig`

```
 public function getControllerConfig()
 {
      return array(
          'initializers' => array(
              // controller initializers here...
          ),
      );
 } 
```

# javascript - 传单如何将 latlng 转换为 html 变量

> ID：14633042
> 
> 赞同：0
> 
> 时间：2013-01-31T18:54:03.190
> 
> 标签：javascript, leaflet

我不知道如何将鼠标单击提取到 latlng 中，然后提取到 html 变量中。这是我所做的（来自[如何使用传单 Api 获取点击位置的经纬度和经度](https://stackoverflow.com/questions/13175101/how-to-get-the-lat-long-of-a-clicked-location-using-leaflet-api)）：

```
var lat = map.on('click', function(e) {
    alert(e.latlng[0]); }); 
```

简而言之，我不知道如何使用传单写入变量。然后在 html 中使用该变量：

```
<div> <script type="text/javascript"> document.write('<"'+lat+'">')</script></div> 
```

html 的东西有效，但传单的东西无效。谢谢，道格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T08:38:47.237

您应该使用`console.log(e);`来检查您的参考是否有效。

尝试

```
map.on('click', function(e) {
    alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng)
} 
```

或者在你的情况下

```
map.on('click', function(e) {
    var lat = e.latlng.lat;
} 
```

# android - 设置屏幕停留时间

> ID：14633047
> 
> 赞同：0
> 
> 时间：2013-01-31T18:54:16.000
> 
> 标签：android, power-management, wakelock

我已经知道从哪里开始，至少通过 WakeLock 类，但我只能在屏幕上和屏幕外调用方法......我不知道终止屏幕开始启动的最简单方法......（亮度降低在完全关闭之前稍稍）。

谢谢！我希望我已经正确地表达了自己。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:11:29.027

知道了！

我对系统类使用了 SCREEN_OF_TIMEOUT 方法。这是代码：

```
android.provider.Settings.System.putInt(getContentResolver(),
            Settings.System.SCREEN_OFF_TIMEOUT, 60000); 
```

数字 60000 指的是屏幕超时时间（以毫秒为单位）。谢谢！

# jquery - 根据下拉选择显示/隐藏表格行

> ID：14633054
> 
> 赞同：1
> 
> 时间：2013-01-31T18:55:05.017
> 
> 标签：jquery, html-table, hide, rows, show

我有一个 2012 年和 2013 年的日期选择器。根据选择，我只想显示某些类的行。有人可以告诉我哪里出错了吗？

**jQuery**

```
<script>
$(document).ready(function() {
$(".yr12 td").hide();

$('#selectYr').change(function () {
    var val = $(this).val();
    if (val == yr12) {
         $('.yr12 td').show();
         $('.yr13 td').hide();
    } else {
        $('.yr12 td').hide();
         $('.yr13 td').show();
    }
    });
}); 
```

**html**

```
<select id="selectYr">
    <option value="yr13">2013</option>
     <option value="yr12">2012</option>
   </select>
<br><br>

<table>
<tr>
<th>Date</th>
<th>Description</th>
</tr>
<tr class="yr13">
<td>February 2013 </td>
<td>Description 1</td>
</tr>
<tr>
<td class="yr13">January 2013</td>
<td>Description 2</td>
</tr>
<tr class="yr12">
<td>November 2012</td>
<td>Description 3</td>
</tr>
<tr class="yr12">
<td>December 2012</td>
<td>Description 4</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T18:56:14.937

您缺少字符串周围的引号：

```
if (val == 'yr12') { }
//         ^    ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T18:59:33.803

您正在尝试将 val 与另一个名为 yr12 的变量进行比较，而不是与值 'yr 12' 进行比较

这是正确的代码：

```
$(document).ready(function() {
                $(".yr12 td").hide();

                $('#selectYr').change(function () {
                    var val = $(this).val();
                    if (val == 'yr12') {
                         $('.yr12 td').show();
                         $('.yr13 td').hide();
                    } else {
                        $('.yr12 td').hide();
                         $('.yr13 td').show();
                    }
                    });
                }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:03:07.043

两件事情..

1 ->

```
 <tr>
<td class="yr13">January 2013</td> 
```

应该

```
<tr class="yr13">
<td>January 2013</td> 
```

2-->

```
if (val == "yr12") { 
```

# regex - 如何使用 Schematron 测试来测试特殊字符？

> ID：14633058
> 
> 赞同：0
> 
> 时间：2013-01-31T18:55:11.940
> 
> 标签：regex, schematron

我正在尝试设置一个 schematron 测试来验证 XML 中的特殊字符...

更具体地说，我想在出现版权符号 (Unicode U+00A9) 的地方发出警告。

当对规则使用以下任何符号时，似乎无法解析 schematron xml 文件...

```
<iso:rule context="myelement>
   <iso:report test="matches(., '\u00A9')">{ES1037} Copyright Symbol Detected</iso:report>
</iso:rule> 

<iso:rule context="myelement>
   <iso:report test="matches(., '\u{00A9}')">{ES1037} Copyright Symbol Detected</iso:report>
</iso:rule> 

<iso:rule context="myelement>
   <iso:report test="matches(., '\u{A9}')">{ES1037} Copyright Symbol Detected</iso:report>
</iso:rule> 

<iso:rule context="myelement>
   <iso:report test="matches(., '\x{00A9}')">{ES1037} Copyright Symbol Detected</iso:report>
</iso:rule> 
```

那里有任何 schematron 专家知道如何将 unicode 字符嵌入到正则表达式中吗？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T14:10:18.107

您需要将代码编写为字符实体，就像用于 XML Schema 标准一样：

```
<?xml version="1.0" encoding="UTF-8"?>
<iso:schema xmlns:iso="http://purl.oclc.org/dsdl/schematron">
    <iso:pattern id="unicode in regex">
        <iso:rule context="a">
            <iso:report test="matches(., '&#xa9;')">
                Copyright found
            </iso:report>
        </iso:rule>
    </iso:pattern>
</iso:schema> 
```

![XML ValidatorBuddy 中的输出](../Images/c04ea8b410980734a659112f4362fbc2.png)

# eclipse - 配置 Eclipse 以对 Cygwin 工具链使用 bash 登录 shell

> ID：14633060
> 
> 赞同：2
> 
> 时间：2013-01-31T18:55:18.267
> 
> 标签：eclipse, bash, cygwin

我在 Eclipse 中有一个自定义 Makefile 项目，虽然构建确实在 Cygwin shell 中运行......它似乎不是登录 shell（`bash --login`），因为它没有像运行`cygwin.bat`那样设置我的环境变量。

在 Eclipse 中，我可以在哪里更改 shell 命令，使其成为登录 shell？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-19T07:41:42.797

您使用*bash --login的实际目标是**/etc/profile*中的设置。

在 UNIX 下，您通常只有一个登录 shell，因此所有其他 shell 都会继承这些设置。*在 Windows 下，任何 Bash 窗口都是一个孤立的登录 shell，当从仅将bash*作为命令处理器运行的工具运行 Bash 时，这会导致缺少环境设置。

我对 Emacs 编译功能有类似的问题。Windows 下最好的解决方案是将环境变量设置`BASH_ENV`为脚本。Bash 将在没有*-i*或*--login*的情况下执行此脚本，因此*/etc/profile*不会运行。因此，该脚本将为非交互式、非登录 shell 设置 Bash。

例子：

```
BASH_ENV=%USERPROFILE%\.bash_env 
```

作为用户环境变量。在此脚本中要做的最少的事情是将*PATH*设置为*/etc/profile*：

```
PATH="/usr/local/bin:/usr/bin:${PATH}" 
```

检查路径设置，`/etc/profile`因为它是由 Cygwin 的*setup.exe*创建的。您还可以从该脚本复制设置`~/.bashrc`或获取该脚本的来源。

希望这可以帮助。

# python - RabbitMQ：消费和发布可以在一个线程中完成吗？

> ID：14633062
> 
> 赞同：3
> 
> 时间：2013-01-31T18:55:28.367
> 
> 标签：python, rabbitmq, python-multithreading

可以使用 RabbitMQ 通道在一个 Python 线程中完成消费和发布吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T18:57:14.197

我认为你不应该想要。MQ 表示异步处理。在我看来，在同一个线程中进行消费和生产违背了目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:13:53.980

我建议看看 Celery ( [http://celery.readthedocs.org/en/latest/](http://celery.readthedocs.org/en/latest/) ) 来管理工作任务。这样，您就不需要直接与 RMQ 集成，因为它会为您处理生产和消费。

但是，如果您确实希望直接与 RMQ 集成并管理自己的工作人员，请查看 Kombu ( [http://kombu.readthedocs.org/en/latest/](http://kombu.readthedocs.org/en/latest/) ) 以了解集成。有非阻塞的消费者和生产者允许你在同一个事件循环中拥有两者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T07:47:47.757

我认为你的问题的简单答案是肯定的。但这取决于你想做什么。我的猜测是你有一个循环在一个通道上从你的线程中消耗，经过一些（小或大）处理后，它决定将它发送到另一个通道上的另一个队列（或交换）然后我看不出有任何问题一点也不。尽管最好将其分派到不同的线程，但这不是必需的。

如果您提供有关您的流程的更多详细信息，那么它可能有助于给出更具体的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T18:06:37.420

实际上这根本不是问题，你可以很容易地做到这一点，例如[`pika`](https://github.com/pika/pika/)问题是你必须停止消费，因为它是一个阻塞循环，或者在消费消息期间进行生产。

消费和生产是一个正常的用例，尤其是在 pika 中，因为它不是[线程安全](https://pika.readthedocs.org/en/latest/faq.html)的，例如，当您想要对消息实施某种形式的过滤器时，或者可能是一个智能路由器，它反过来会传递消息到另一个队列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-07T16:24:55.000

[Kombu](https://docs.celeryproject.org/projects/kombu/en/stable/index.html)是一个用于处理 RabbitMQ 的常用 python 库（Celery 在后台使用它）。在这里值得指出的是，我尝试过的最简单使用 Kombu 的问题的答案是“**不 - 你不能在同一个消费者回调线程上接收和发布。** ”

具体来说，如果队列中有几条消息，消费者已经为该主题注册了回调，并且该回调进行了一些处理并发布了结果，那么结果的发布将导致队列中的第二条消息在它之前点击回调已从第一条消息的发布返回 - 因此您最终会递归调用回调。如果队列中有 n 条消息，则调用堆栈在展开之前将结束 n 条消息。显然，它很快就会爆发。

一种解决方案（不一定是最好的）是让回调只是将消息发布到消费者内部的一个简单队列中，该队列可以在主进程线程上处理（即在回调线程之外）

```
def process_message(self, body: str, message: Message):
    # Queue the message for processing off this thread:
    print("Start process_message ----------------")
    self.do_process_message(body, message) if self.publish_on_callback else self.queue.put((body, message))#
    print("End process_message ------------------")

def do_process_message(self, body: str, message: Message):
    # Deserialize and "Process" the message:
    print(f"Process message: {body}")
    # ... msg processing code...

    # Publish a processing output:
    processing_output = self.get_processing_output()
    print(f"Publishing processing output: {processing_output}")
    self.rabbit_msg_transport.publish(Topics.ProcessingOutputs, processing_output)

    # Acknowledge the message:
    message.ack()

def run_message_loop(self):
    while True:
        print("Waiting for incoming message")
        self.rabbit_connection.drain_events()
        while not self.queue.empty():
            body, message = self.queue.get(block=False)
            self.do_process_message(body, message) 
```

在上面的这个片段中， process_message 是回调。如果 publish_on_callback 是 True 你会在回调中看到递归 n deep for n message on rabbit queue。如果 publish_on_callback 是 False 它可以正确运行而无需在回调中递归。

另一种方法是为生产者交换使用第二个连接 - 与用于消费者的连接分开。这也有效，以便在再次为队列中的下一条消息触发回调之前完成使用消息和发布结果的回调。

# java - JPanel displaying weird error when drawing image

> ID：14633066
> 
> 赞同：1
> 
> 时间：2013-01-31T18:55:45.177
> 
> 标签：java, swing, jpanel, paintcomponent, grid-layout

I'm having a weird error with my board game. The board consists of a 2D array with GameTiles, which is a subclass of JPanel. It all works perfectly fine when I have the size (600,500) but whenever I change it I get a weird error in the upper left corner.

Picture of the error (see the upper left corner) ![Board error](../Images/bba71dddfa00f66f4b0da4dd1d2a93f2.png)

What makes it even weirder is that when I created a new project, just to try it out, it worked perfectly. The code is exactly the same for the painting and I'm not experiencing any error with it. Can it be something else that's causing this problem?

**PROBLEM FIXED**

Anser: I accidentally overrided the getX and getY methods of JPanel. I changed the name on them and now it works perfectly.

Reversi.java

```
package org.reversi;

import javax.swing.JFrame;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

import org.reversi.gui.GameFrame;

public class Reversi {
public static void main(String[] args) {
    try {
                 UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } catch (InstantiationException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } catch (UnsupportedLookAndFeelException e) {
        e.printStackTrace();
    }

    java.awt.EventQueue.invokeLater(new Runnable() {
        @Override
        public void run() {
            GameFrame frame = new GameFrame("Reversi");
            frame.setSize(600,500);
            frame.setLocationRelativeTo(null);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setVisible(true);
        }
    });
}
} 
```

GameBoard.java

```
package org.reversi.gui;

import java.awt.Graphics;
import java.awt.GridLayout;

import javax.swing.JPanel;

public class GameBoard extends JPanel{
private GameTile[][] gameBoard = new GameTile[8][8];

public GameBoard() {
    initiateLayout();
}

private void initiateLayout() {
    setLayout(new GridLayout(8, 8));

    for(int row = 0 ; row < 8 ; row++) {
        for(int col = 0 ; col < 8 ; col++) {
            gameBoard[row][col] = new GameTile(col,row);
            add(gameBoard[row][col]);
        }
    }
}

@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    for(int row = 0 ; row < 8 ; row++) 
        for(int col = 0 ; col < 8 ; col++)              
            gameBoard[row][col].repaint();
}
} 
```

GameFrame.java

```
package org.reversi.gui;

import javax.swing.JFrame;

public class GameFrame extends JFrame {
private GameBoard gameBoard;

/**
 * Creates a new frame.
 * @param gameTitle the title of the frame
 */
public GameFrame(String gameTitle) {
    setTitle(gameTitle);
    gameBoard = new GameBoard();
    add(gameBoard);
}
} 
```

GameTile.java

```
package org.reversi.gui;

import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.JPanel;

public class GameTile extends JPanel {
private BufferedImage image;
private int x;
private int y;

public GameTile(int x, int y) {
    this.x = x;
    this.y = y;
    try {
        this.image = ImageIO.read(new File("tile.png"));
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.drawImage(image, 0, 0, getWidth(), getHeight(), this);
}

public int getX() {
    return x;
}

public int getY() {
    return y;
}
} 
```

Link to image (which should be named tile.png): [http://i.imgur.com/ejmCtui.png](https://i.imgur.com/ejmCtui.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:58:01.053

As per your comment:

> This was the problem, thank you so much for pointing that out. I'm using the coordinates when making a move on the board. If there's some way to make this an answer it would be great

In `GameTile.java` you have done:

```
public int getX() {
    return x;
}

public int getY() {
    return y;
} 
```

With this you are actually overriding `JPanel`s [`getX`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#getX%28%29) and [`getY`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#getY%28%29) and returning co-ordinates which will affect the `Layout`. This can be seen by adding [`@Override` annotation](https://stackoverflow.com/questions/94361/when-do-you-use-javas-override-annotation-and-why) (NOTE not compiler error is thrown thus we are correctly overriding a method from the extending class):

```
@Override
public int getX() {
    return x;
}

@Override
public int getY() {
    return y;
} 
```

As @Xeon said you should not set the co-ordinates the `LayoutManager` will do that.

**Solution: (plus extras)**

*   Remove those *getters* or rename them appropriately.

*   Dont call `setSize` on `JFrame` rather override `getPreferredSize` of `JPanel which is drawn to via`Graphic`s object and return the correct`Dimension`s (in your case the image dimensions) and than call [`pack()`][4] on`JFrame` before setting it visible but after adding components.

*   You will need to relocate call to `setLocationRelativeTo(...)` to after `pack()`.

*   Better to use `JFrame.DISPOSE_ON_CLOSE` so `main(String[] args)` method may carry on its execution even after GUI termination.

*   Also dont extend `JFrame` unnecessarily.

*   Dont repeatedly load the same image in your `GameTile` class rather load the image once and add parameter for `GameTile` to accept an `BufferedImage` ( I figured this out while testing using the internet URL it took forever because it read a new image for each `GameTile` created)

Here are the classes with necessary changes made:

**Reversi.java:**

```
public class Reversi {

    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (UnsupportedLookAndFeelException e) {
            e.printStackTrace();
        }

        java.awt.EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                new GameFrame("Reversi");
            }
        });
    }
} 
```

**GameBoard.java**:

```
public class GameBoard extends JPanel {

    private GameTile[][] gameBoard = new GameTile[8][8];

    public GameBoard() {
        initiateLayout();
    }

    private void initiateLayout() {
        setLayout(new GridLayout(8, 8));

        BufferedImage image = null;
        try {
            image = ImageIO.read(new URL("http://i.imgur.com/ejmCtui.png"));
        } catch (IOException e) {
            e.printStackTrace();
        }
        for (int row = 0; row < 8; row++) {
            for (int col = 0; col < 8; col++) {
                gameBoard[row][col] = new GameTile(image, col, row);
                add(gameBoard[row][col]);
            }
        }
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        for (int row = 0; row < 8; row++) {
            for (int col = 0; col < 8; col++) {
                gameBoard[row][col].repaint();
            }
        }
    }
} 
```

**GameTile.java:**

```
public class GameTile extends JPanel {

    private BufferedImage image;
    private int x;
    private int y;

    public GameTile(BufferedImage image, int x, int y) {
        this.image = image;
        this.x = x;
        this.y = y;
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(image.getWidth(), image.getHeight());
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(image, 0, 0, getWidth(), getHeight(), this);
    }
} 
```

**GameFrame.java:**

```
public class GameFrame {

   private GameBoard gameBoard;

    /**
     * Creates a new frame.
     *
     * @param gameTitle the title of the frame
     */
    public GameFrame(String gameTitle) {
        JFrame frame = new JFrame(gameTitle);
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        gameBoard = new GameBoard();
        frame.add(gameBoard);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

which would produce:

![enter image description here](../Images/16b7ac827a80cbbf91dc4556b4d5848b.png)

# mysql - 检索具有持续时间条件的对象

> ID：14633068
> 
> 赞同：0
> 
> 时间：2013-01-31T18:55:46.907
> 
> 标签：mysql, ruby-on-rails

我有一个具有 start_at 和 end_at 属性的模型“竞争”，两者都是 datetime 类型。我只想检索持续时间短于给定数量的比赛，例如 3 天。我希望很容易做到这一点：

```
Competition.where('end_at - start_at < ?', X) 
```

问题：我对 X 使用什么？

在我的数据库中，我有一个持续时间略小于 1 天的竞赛对象（start_at = 2011-04-27 00:00:00，end_at = 2011-04-27 23:59:59）和一个略小于 3天（start_at = 2013-02-05 00:00:00，end_at 2013-02-07 23:59:59），所有其他的都更长。

为了检索两者中较短的一个，我预计使用 X = 60*60*24（24 小时内的秒数）。不工作。所以我尝试乘以一个增加的因子，发现将 X 乘以 2.7 不会检索到它，但 2.8 会！所以好吧，我需要使用这个奇怪的因子 2.8...但这不适用于检索短于 3 天的对象。这里我需要乘以 8.7。有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:16:20.973

可用的功能取决于您使用的数据库。例如，使用 SQLite，您可以使用：

```
Competition.where('julianday(end_at) - julianday(start_at) < ?', 3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:39:16.230

尝试这个：

```
Competition.where('DATEDIFF(end_at, start_at) < ?', x) 
```

为了更准确

```
Competition.where('TIMESTAMPDIFF(SECOND, start_at, end_at) < ?', x*86400)  #where 86400 is the seconds in a day and x is no. of days 
```

# c++ - C++ - Qt Creator 中的 Poco 库

> ID：14633070
> 
> 赞同：5
> 
> 时间：2013-01-31T18:55:53.110
> 
> 标签：c++, qt, poco-libraries

我正在尝试将 Qt Creator 中的 poco 库与 poco 附带的示例之一一起使用，我已经让它在 Visual Studio 2012 中工作，但我一直在 Qt Creator 中遇到构建错误。我的 lib 路径中有 .dll 和 .lib。

这是我的 .pro 文件

```
TEMPLATE = app
CONFIG += console
CONFIG -= qt

SOURCES += main.cpp
INCLUDEPATH += C:\Users\justin\Downloads\poco-1.4.6\Net\include
INCLUDEPATH += C:\Users\justin\Downloads\poco-1.4.6\Foundation\include

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/lib/ -lPocoFoundation
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/lib/ -lPocoFoundationd

INCLUDEPATH += $$PWD/
DEPENDPATH += $$PWD/

win32:CONFIG(release, debug|release): PRE_TARGETDEPS += $$PWD/lib/PocoFoundation.lib
else:win32:CONFIG(debug, debug|release): PRE_TARGETDEPS += $$PWD/lib/PocoFoundationd.lib

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/lib/ -lPocoNet
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/lib/ -lPocoNetd

INCLUDEPATH += $$PWD/
DEPENDPATH += $$PWD/

win32:CONFIG(release, debug|release): PRE_TARGETDEPS += $$PWD/lib/PocoNet.lib
else:win32:CONFIG(debug, debug|release): PRE_TARGETDEPS += $$PWD/lib/PocoNetd.lib 
```

这是.cpp文件

```
#include "Poco/URIStreamOpener.h"
#include "Poco/StreamCopier.h"
#include "Poco/Path.h"
#include "Poco/URI.h"
#include "Poco/Exception.h"
#include "Poco/Net/HTTPStreamFactory.h"
#include "Poco/Net/FTPStreamFactory.h"
#include <memory>
#include <iostream>

using Poco::URIStreamOpener;
using Poco::StreamCopier;
using Poco::Path;
using Poco::URI;
using Poco::Exception;
using Poco::Net::HTTPStreamFactory;
using Poco::Net::FTPStreamFactory;

int main(int argc, char** argv)
{
    HTTPStreamFactory::registerFactory();
    FTPStreamFactory::registerFactory();

    try
    {
        URI uri("http://example.com");
        std::auto_ptr<std::istream> pStr(URIStreamOpener::defaultOpener().open(uri));
        StreamCopier::copyStream(*pStr.get(), std::cout);
    }
    catch (Exception& exc)
    {
        std::cerr << exc.displayText() << std::endl;
        return 1;
    }

    return 0;
} 
```

这些是构建错误：

```
undefined reference to `Poco::Net::HTTPStreamFactory::registerFactory()'
undefined reference to `Poco::Net::FTPStreamFactory::registerFactory()'
undefined reference to `Poco::URI::URI(char const*)'
undefined reference to `Poco::URIStreamOpener::defaultOpener()'
undefined reference to `Poco::URIStreamOpener::open(Poco::URI const&) const'
undefined reference to `Poco::StreamCopier::copyStream(std::istream&, std::ostream&, unsigned int)'
undefined reference to `Poco::URI::~URI()'
undefined reference to `Poco::URI::~URI()' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T19:05:55.997

必须使用相同的编译器来编译以下所有三个：

1.  波科图书馆

2.  Qt 库

3.  你的申请

我的预感是您将 MSVC2012 用于 #3，您正确下载了 #2 用于 MSVC2012，但您没有使用 MSVC2012 编译 #1。

# python - 在源代码中查找派生类

> ID：14633071
> 
> 赞同：0
> 
> 时间：2013-01-31T18:55:54.770
> 
> 标签：python, abstract-syntax-tree

我有一个包含 python 代码的文件。我需要检查它（*无需*导入或运行它，尽管编译它是可以的）。

我想获取文件中声明的类，看看它们是否派生自某个基类。

例如，

比如说在我的“foo”模块中，我定义了一个名为“Bar”的类，它派生自“Foo”类：

```
class Foo(object):
    pass

class Bar(Foo)
    pass 
```

然后我有一个外部python源文件，例如：

```
from foo import Bar

class Baz(Bar):
    pass 
```

我想检查源以了解该文件是否包含从我的“Foo”派生的任何类定义。

我需要解析 AST 吗？这是静态分析子类定义的正确方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:00:15.760

不编译代码的答案是使用[pysmell](https://code.google.com/p/pysmell/)或类似的。

鉴于：

```
# base.py
class Base(object):
    def __init__(self, name):
        self.name = name

class First(Base):
    def __init__(self, name="first"):
        super(First, self).__init__(name)

class Second(First):
    def __init__(self, name="second"):
        super(Second, self).__init__(name)

class Third(Second):
    def __init__(self, name="third"):
        super(Third, self).__init__(name)

t = Third() 
```

运行`pysmell base.py`生成一个 PYSMELLTAGS 文件，如下所示：

```
{'CLASSES': {'base.Base': {'bases': ['object'],
                           'constructor': ['name'],
                           'docstring': '',
                           'methods': [],
                           'properties': ['name']},
             'base.First': {'bases': ['base.Base'],
                            'constructor': ["name='first'"],
                            'docstring': '',
                            'methods': [],
                            'properties': []},
             'base.Second': {'bases': ['base.First'],
                             'constructor': ["name='second'"],
                             'docstring': '',
                             'methods': [],
                             'properties': []},
             'base.Third': {'bases': ['base.Second'],
                            'constructor': ["name='third'"],
                            'docstring': '',
                            'methods': [],
                            'properties': []}},
 'CONSTANTS': ['base.t'],
 'FUNCTIONS': [],
 'HIERARCHY': ['base'],
 'POINTERS': {}} 
```

我相信这将有助于 OP 实现识别从其他类派生的类的目标。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-31T19:30:10.573

我认为这样的事情就可以了，因为它只会污染`x`。

```
import inspect
from tester import Test

x = __import__("something", globals={}, locals={})

for (n,v) in inspect.getmembers(x):
    if inspect.isclass(v):
        print "CLASS:", n, inspect.getmro(v)
        if Test != v and Test in inspect.getmro(v):
            print "FOUND:", n, v

 #something.py
 from tester import Test
 class SomeClass(Test): pass

 #tester.py
 class Test(object): pass 
```

输出：

```
CLASS: SomeClass (<class 'something.SomeClass'>, <class 'tester.Test'>, <type 'object'>)
FOUND: SomeClass <class 'something.SomeClass'>
CLASS: Test (<class 'tester.Test'>, <type 'object'>) 
```

# perl - Perl - 计算 csv 文件中每行的列数

> ID：14633074
> 
> 赞同：0
> 
> 时间：2013-01-31T18:56:07.873
> 
> 标签：perl, csv

我想计算 CSV 文件的一行中的列数。

第 1 行 10 列
第 2 行 11 列 以此类推

我可以打印出最后一列的值，但我真的只想要每行的计数。

```
perl -F, -lane "{print @keys[$_].$F[$_] foreach(-1)}" < testing.csv 
```

我在 Windows 机器上

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:20:04.903

如果您有一个正确的 csv 文件，它可以包含嵌入的分隔符（例如`1,"foo,bar",2`），在这种情况下，简单的拆分是不够的。你可以很容易地使用 Text::CSV 模块，使用这样的单行代码：

复制/粘贴版本：

```
perl -MText::CSV -lwe"my $c=Text::CSV->new({sep_char=>','}); while($r=$c->getline(*STDIN)) { print scalar @$r }" < sorted.csv 
```

可读版本：

```
perl -MText::CSV            # use Text::CSV module
     -lwe                   # add newline to print, use warnings
         "my $c = Text::CSV->new();             # set up csv object 
          while( $r = $c->getline(*STDIN) ) {   # get lines from stdin
              print scalar @$r                  # print row size
          }" < sorted.csv                       # input file to stdin 
```

如果您的输入可能不稳定，Text::CSV->getline 可能会在损坏的行上阻塞（`while`循环结束），在这种情况下使用普通解析可能更安全：

```
perl -MText::CSV -nlwe"
    BEGIN { $r = Text::CSV->new() }; 
    $r->parse($_); 
    print scalar $r->fields
" comma.csv 
```

请注意，在这种情况下，我们使用不同的输入法。这是因为虽然`getline()`需要文件句柄，`parse()`但不需要。由于菱形运算符根据您的论点使用 ARGV 或 STDIN，我发现最好是明确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:02:17.487

如果您没有逗号作为字段的一部分，则可以`split`行并计算字段数

```
#! /usr/bin/perl

use strict;
use warnings;

my @cols = split(',', $_);
my $n = @cols;
print "row $. $n columns\n"; 
```

你可以这样称呼

```
perl -n script.pl testing.csv 
```

# simperium - simperium 框架也可用于 OSX 吗？

> ID：14633077
> 
> 赞同：0
> 
> 时间：2013-01-31T18:56:16.120
> 
> 标签：simperium

在 OSX 中使用 simperium.framework 构建时，我收到警告。

> ld：警告：忽略文件 /Volumes/Jose/Desktop/simperium/Simperium.framework/Simperium，文件 /Volumes/Jose/Desktop/simperium/Simperium.framework/Simperium 中缺少所需的架构 x86_64（3 片）

是我下载了错误的框架，还是 OSX 还没有 simperium？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:54:49.133

这就是 iOS 的框架。您是正确的，当前未链接 OSX 框架的二进制下载。您可以[从 source 构建框架](https://github.com/Simperium/simperium-ios)，或者我也将在本周末上传二进制 OSX 框架，然后更新此答案。

# translation - 我可以用自己的翻译覆盖谷歌翻译的翻译吗？

> ID：14633081
> 
> 赞同：3
> 
> 时间：2013-01-31T18:56:54.480
> 
> 标签：translation, google-translate

我有一个 .NET Web 应用程序，并且有兴趣使用该小部件进行站点范围的翻译。我意识到我可以阻止谷歌翻译不翻译某些文本，但我也可以在我自己的文本翻译中卡住吗？

# javascript - 从 HTML 表单字段调用 JavaScript 函数

> ID：14633084
> 
> 赞同：1
> 
> 时间：2013-01-31T18:57:09.603
> 
> 标签：javascript, html, dom

调用 JavaScript 函数时，返回值对输入表单字段有什么作用？例如：

```
<script type="text/javascript">
 function foo()
 {
  return true;
 }
</script>
<input type="text" id="txt1" onkeyup="return foo()" /> 
```

和变化，IIRC`onkeyup="foo(); return false"`
我真的不需要返回时间，最简单的方法是什么？

现在我正试图从一个事件中调用多个函数，但不确定合适的方法是什么： `<input type="text" id="txt1" onkeyup="return foo1(); return foo2();"`或
`<input type="text" id="txt1" onkeyup="return foo1()" onkeyup="return foo2();"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:00:22.410

`return false;`用于阻止事件具有其默认效果（在这种情况下，输入的字母不会被添加）。`return foo()`用于`foo`判断是否发生`return true`或`return false`因此是否应发生默认操作。

如果您只是调用一个不会影响事件是否实际发生的函数，只需使用`onkeyup="foo1(); foo2();"`. 但是，如果其中一个影响了结果，则应该*最后*调用它并在它之前有一个`return`。

不过，一般来说，在其中拥有一个函数会更容易，比如`onkeyup="return foo()"`，然后拥有

```
function foo() {
    foo1();
    foo2();
    return true; // or whatever
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:03:46.843

最合适的方法是将多个函数绑定到一个事件，如下所示：

```
ELEMENT.addEventListener('onkeyup', function(event) {
    foo();
    bar();
    fooBar();
}, false); 
```

或者为了进一步简化它，你可以使用 jQuery：

```
$(element).on({
    keyup: function() {
        foo();
        bar();
        fooBar();
    }
}); 
```

*提示：使用`this`（在 jquery 中）或`event.target`（非 jquery）来处理事件源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T18:59:12.437

理想情况下，您根本不应该将它们内联......您应该使用附加到 dom 元素的事件处理程序。

例如：

```
document.getElementById('txt1').addEventListener('onkeyup', function() {
   foo1();
   foo2();
}); 
```

现在需要注意的是，事件分配不一定是标准化的，因此您需要在不同的浏览器中以不同的方式附加侦听器。这是人们使用像 jQuery 这样的库的原因之一——它规范了这一切。

# java - javax swing - 创建窗口

> ID：14633086
> 
> 赞同：1
> 
> 时间：2013-01-31T18:57:17.800
> 
> 标签：java, swing, console

我是 Java 初学者，我正在学习 swing api。我的代码有问题，我不知道如何修复它。请帮忙。

**下面是我正在使用的代码示例：**

```
import javax.swing.JFrame;
import javax.swing.JLabel;

public class HelloWorldApp extends JFrame {

  public static void main(String args[]) {

    CustomWindow w = new CustomWindow();
    w.setVisible(true);

  }

  public CustomWindow() {

    setSize(500, 500);
    setTitle("Jacob Perkins");
    JLabel lbl = new JLabel("Hello World!");
    add(lbl);

  }

} 
```

我的问题是我收到以下错误：

```
invalid method declaration; return type required 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:00:11.077

```
public CustomWindow() {
    setSize(500, 500);
    setTitle("Jacob Perkins");
    JLabel lbl = new JLabel("Hello World!");
    add(lbl);
} 
```

应该：

```
public void CustomWindow() {
    setSize(500, 500);
    setTitle("Jacob Perkins");
    JLabel lbl = new JLabel("Hello World!");
    add(lbl);
} 
```

或者代替`void`（不返回任何内容）我们将放置我们想要返回的数据类型。该方法现在必须包含一个`return`返回适当数据类型以匹配方法签名的语句，否则您将收到以下错误：

> 无效的方法声明；需要返回类型

请参阅[从方法返回值](http://docs.oracle.com/javase/tutorial/java/javaOO/returnvalue.html)。

除非您尝试为`HelloWorldApp`该类创建构造函数，否则必须为该方法指定类名（阅读[为您的类提供构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)）：

```
public HelloWorldApp() {
    setSize(500, 500);
    setTitle("Jacob Perkins");
    JLabel lbl = new JLabel("Hello World!");
    add(lbl);
 } 
```

**其他建议**

*   `JFrame`不要不必要地扩展。

*   不要调用`setSize`而是使用正确`LayoutManager`和/或覆盖`getPreferredSize`并返回`Dimension`适合其内容的 s。在将其设置为可见之前但在添加组件之后`pack()`调用。`JFrame`

*   通过块在[Event Dispatch Thread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)上创建和操作 Swing 组件`SwingUtilities.invokeLater(Runnable r)`：

    ```
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            //create and show ui here
            CustomWindow w = new CustomWindow();
            w.setVisible(true);
        }
    }); 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T19:01:00.663

这条线

```
public CustomWindow() { 
```

正如所写的那样，需要一个返回类型（`void`如果您不返回任何内容，则适用）。然而，这显然是一个构造函数；如果是这种情况，则需要将其命名为与其所在的类相同。您需要将其重命名为`HelloWorldApp`或将类重命名为`CustomWindow`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:03:32.333

在 Java 中，文件名必须与它们正在实现的类匹配。因此，您需要将类和文件名更改为 CustomWindow 或将构造函数的名称更改为 HelloWorldApp()：

```
import javax.swing.JFrame;
import javax.swing.JLabel;

 public class HelloWorldApp extends JFrame {

public static void main(String args[]) {

  HelloWorldApp w = new HelloWorldApp();
  w.setVisible(true);

 }
 public HelloWorldApp() {

   setSize(500, 500);
   setTitle("Jacob Perkins");
   JLabel lbl = new JLabel("Hello World!");
   add(lbl);

 }

 } 
```

# authentication - Sonar 3.4 LDAP 身份验证与 Active Directory - NullPointer 异常

> ID：14633087
> 
> 赞同：2
> 
> 时间：2013-01-31T18:57:18.240
> 
> 标签：authentication, active-directory, sonarqube

我正在尝试让 Sonar 对 Active Directory 使用 LDAP 身份验证

我有以下设置

```
# LDAP Authentication
sonar.security.realm: LDAP
sonar.authenticator.class: org.sonar.plugins.ldap.LdapAuthenticator  
sonar.authenticator.createUsers: true
ldap.url: ldap://172.20.16.15:389
ldap.baseDn: DC=mycompany,DC=com  
ldap.bindDn: CN=myuser,OU=serviceaccounts,OU=My Group,DC=mycompany,DC=com  
ldap.bindPassword: password
ldap.loginAttribute: sAMAccountName
ldap.userObjectClass: user
# ldap.user.request: sAMAccountName={0} 
```

但是，我不断得到

```
ERROR rails  Error from external users provider: java.lang.NullPointerException: null 
```

我尝试用 ldap.user.request 更改 ldap.loginAttribute/ldap.userObjectClass 但这仍然不起作用。

我拥有的声纳 ldap 插件是 1.2.1。请帮助我确定配置有什么问题

我在 ADExplorer 中使用了相同的条目，以确保我可以浏览 AD，并且相同/相似的设置适用于 Artifactory

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:38:28.253

好的，看起来我正在使用一些已弃用的属性。一旦我在插件上启用调试，我就能获得有用的信息

这是对我有用的 LDAP 插件 1.2.1 和声纳 3.4

```
sonar.security.realm: LDAP 
#sonar.authenticator.class: org.sonar.plugins.ldap.LdapAuthenticator  -- use above
sonar.authenticator.createUsers: true
ldap.url: ldap://server:389
ldap.user.baseDn: DC=mycompany,DC=com  
ldap.bindDn: CN=myuser,OU=serviceaccounts,OU=MyGroup,DC=mycompany,DC=com  
ldap.bindPassword: password
#ldap.user.objectClass: user -- use the ones below
#ldap.group.objectClass: group -- use the ones below
#ldap.group.memberAttribute: member --use the ones below
#ldap.user.loginAttribute: sAMAccountName -- use the ones below
ldap.group.request: (&(objectClass=group)(member={dn}))
ldap.user.request: (&(objectClass=user)(sAMAccountName={login})) 
```

# symfony - 向 Symfony 2 上生成的文本框添加值

> ID：14633096
> 
> 赞同：0
> 
> 时间：2013-01-31T18:57:46.840
> 
> 标签：symfony

有这个：

```
echo $view['form'] -> row($form["codelist"], array(
    //widget
    "widgetArgs" => array(
        "attr" => array(
            'class' => 'input-xlarge tooltipRight', 
            'id' => "gift_codelist"
            ),
            "tooltip"=>"gift.tooltip.codelist",
            "translation_domain" =>"brand"

         ),
   "labelArgs" => array(
        "label_attr" => array(
            'class' => 'control-label', 
        )) ,"rowType"=>2
      )
  ); 
```

您如何向该文本框添加初始值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:04:25.543

如果要向字段添加实际值，可以使用`value`属性：

```
"attr" => array(
        'class' => 'input-xlarge tooltipRight', 
        'id' => "gift_codelist",
        'value' => "Your initial value"
        ) 
```

但是如果你使用 HTML5 并且只是想给你的用户一个提示，你最好使用`placeholder`：

```
"attr" => array(
        'class' => 'input-xlarge tooltipRight', 
        'id' => "gift_codelist",
        'placeholder' => "Your initial value"
        ) 
```

[http://www.w3.org/html/wg/drafts/html/master/forms.html#the-placeholder-attribute](http://www.w3.org/html/wg/drafts/html/master/forms.html#the-placeholder-attribute)

# css - css 内容超出 div

> ID：14633100
> 
> 赞同：-1
> 
> 时间：2013-01-31T18:58:01.857
> 
> 标签：css

嗨，我有页面[http://rygol.cz/qlife/](http://rygol.cz/qlife/)，当我缩小内容时，内容会超出他的 div。如果我你身高：自动；或高度：100% 可以，但左列比右列小，清除对我没有帮助。有人知道如何解决吗？

```
#leftcolumn { 
 color: #333;
 background: #fff;
 background-image:url("./images/corner.png");
 background-repeat:no-repeat;
 padding: 10px;
 height: 800px;
 width: 244px;
 float: left;
}
#rightcolumn { 
 float: right;
 color: #333;
 background: #fff;  
 padding: 10px;
 height: 800px;
 width: 638px;
 display: inline;
 margin-bottom: 10px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:07:42.330

如果您需要标题和内容之间的额外空间，您应该继续将*#leftcolumn*和*#rightcolumn*放置在设置了背景颜色的附加包装容器中，并设置不设置背景颜色的*#container*。

**HTML**结构：

```
<div id="container">
  <div id="header"></div>
  <div id="content-wrapper">
      <div id="leftcolumn"></div>
      <div id="rightcolumn"></div>
  </div>
</div> 
```

和**CSS**：

```
#container {
margin: 0 auto;
width: 922px;
}

#header {
color: #333;
background: #fff;
width: 902px;
padding: 10px;
margin-bottom: 10px;
height: 200px;
}

#content-wrapper {
background-color: #fff;
min-height: 1px;
overflow: hidden; /* clear hack :) */
}

#leftcolumn {
color: #333;
background: #fff;
background-image: url("./images/corner.png");
background-repeat: no-repeat;
padding: 10px;
width: 244px;
float: left;
}

#rightcolumn {
float: right;
color: #333;
background: #fff;
padding: 10px;
width: 638px;
margin-bottom: 10px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:18:31.463

删除列中的高度声明。`overflow-y: scroll`尽管我会坚持去除高度，但您也可以使用。要考虑的另一件事是，人们通常不会缩小那么远：文本在它中断的缩放级别（chrome v24）变得无法阅读。

如果您想要等高的列将较短的列浮动到一侧，然后设置`position: relative`，`top: 0; bottom: 0;`然后将另一列设置为必须`overflow: hidden;`“清除”浮动。注意：浮动列应该首先出现在标记中才能起作用。

# tcl - .tbc 到 .tcl 文件

> ID：14633101
> 
> 赞同：6
> 
> 时间：2013-01-31T18:58:09.247
> 
> 标签：tcl

这是一个奇怪的问题，我搜索但找不到任何令人满意的答案。

我有一个编译`tcl`文件，即一个`.tbc`文件。那么有没有办法将此`.tbc`文件转换回`.tcl`文件。

[我在这里](http://objectmix.com/tcl/15823-tbc-decompiler.html)读到有人提到`::tcl_traceCompile`并说这可以用来反汇编`.tbc`文件。但是作为一个新手 tcl 用户，我不确定这是否可能，或者说更多，如何准确地使用它。

虽然我知道 tcl 编译器不会编译所有语句，因此这些语句可以很容易地在文件中看到，但我们可以从文件`.tbc`中获取整个语句。`tcl``.tbc`

任何评论都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:34:26.507

不，或者至少不是没有大量工作；您正在做一些努力来防止的事情（TBC 格式旨在保护商业代码不被窥探）。

* * *

TBC文件格式是Tcl的字节码的一种编码，一般情况下根本不保存；**TBC**代表**T** cl字节**代码**。TBC 格式数据仅由一种工具生成，即商业“Tcl 编译器”（最初由 Sun 或 Scriptics 编写；该工具的日期大约是过渡时期），它实际上是利用内置编译器，每个 Tcl 系统都有一些序列化代码。它还尽可能多地剥离原始源代码。使用的编码令人不快；如果可以的话，你想避免编写自己的加载器，而是使用扩展来完成工作。****`tbcload`****

 ****然后，您需要将它与 Tcl 的自定义构建一起使用，该构建禁用一些防御性检查，以便您可以使用[`tcl::unsupported::disassemble`](http://wiki.tcl.tk/21445)命令反汇编加载的代码（通常拒绝分解来自 的任何内容`tbcload`）；该命令从 Tcl 8.5 开始存在。之后，您必须从字节码中拼凑出代码在做什么；我根本不知道有任何工具可以做到这一点，但字节码大多是相当高级的，所以对于小段代码来说并不*太难。*

没有手册页`disassemble`；毕竟它是正式不受支持的！但是，我链接到的那个 wiki 页面应该涵盖了您入门所需的大部分内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-19T09:14:53.083

我可以部分地说“是”，也可以有条件地说。该条件是如果原始 tcl 代码是在命名空间中编写的，并且过程是在命名空间花括号中定义的。然后您在 tkcon/wish 中获取 tbc 文件并使用 info procs 和命名空间命令查看代码。当然，您需要知道命名空间名称。不过也能找到。****

# java - 在字节码中确定 super() 方法调用在哪里，所有构造函数都必须在 JVM 上执行

> ID：14633109
> 
> 赞同：8
> 
> 时间：2013-01-31T18:58:29.717
> 
> 标签：java, bytecode

我想知道在分析构造函数的字节码时是否有一种明显而快速的方法来确定`super()`代码的结束位置。

更具体地说，与 Java 形成鲜明对比的是，在构造函数中对任何`super()`构造函数方法的调用都是可选的（或者更确切地说，当不存在时——隐式），在字节码世界中它总是需要的。

出于黑魔法的目的，我需要仅通过字节码分析和可用的最简单方法`INVOKESPECIAL`来了解与 Java 世界调用相对应的调用是什么`super()`。

我会给你一个困难的例子：

```
public static class A {
    public A(Object o, Object b) {
    }
}

public static class B extends A {
    public B() {
        //the below super is in bold just to signal that's the one
        //I'm looking for
        SUPER(new A(new Object(), new Integer(2)), new Integer(1));
        System.out.println(new A(new Object(), new Integer(2)));
    }
} 
```

使用相应的字节码： ![在此处输入图像描述](../Images/91a069e4fa47ab5edf0039e37c91b6c5.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:02:41.643

实际上，字节码构造函数的规则比 Java 的规则要宽松得多。

唯一的规则是在任何正常返回的路径上都必须调用一个构造函数，如果构造函数调用抛出异常，那么您也必须抛出异常。

除此之外，这意味着一个构造函数可能包含对其他构造函数的多个调用，或者根本不包含任何调用。

无论如何，确定给定`invokespecial`调用是否正在初始化当前对象的唯一有保证的方法是进行数据流分析，因为可以初始化同一类的其他对象，这会使天真的检测器感到困惑。

编辑：这是一个完全有效的类的示例（使用 Krakatau 汇编器语法），显示了您可能遇到的一些问题。除其他外，它调用同一类中的其他构造函数，递归调用构造函数，以及在构造函数中构造同一类的其他对象。

```
.class public ctors
.super java/lang/Object

; A normal constructor
.method public <init> : ()V
    .limit locals 1
    .limit stack 1

    aload_0
    invokespecial java/lang/Object <init> ()V
    return
.end method

; A weird constructor
.method public <init> : (I)V
    .limit locals 2
    .limit stack 5

    iload_1
    ifne LREST
        aload_0
        invokespecial ctors <init> ()V
        return

LREST:
    aload_0
    new ctors
    iinc 1 -1
    iload_1
LFAKE_START:
    invokespecial ctors <init> (I)V
LFAKE_END:
    iconst_0
    invokespecial ctors <init> (I)V
    return

.catch [0] from LFAKE_START to LFAKE_END using LCATCH
LCATCH:
    aload_0
    invokespecial java/lang/Object <init> ()V
    return
.end method

.method public static main : ([Ljava/lang/String;)V
    .limit locals 1
    .limit stack 2

    new ctors
    iconst_5
    invokespecial ctors <init> (I)V
    return
.end method 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:22:59.893

一个简单的解决方案是计算`new A`对象的数量和`A.<init>` 当有多个时`init`调用`new`超级构造函数。你必须做同样的检查`new B`，`B.<init>`以防万一`this(...)`被调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:22:56.337

您必须找出操作数堆栈在哪个调用操作码处包含`this`将用作第一个参数的引用。为此，您只需要了解不同操作码对操作数堆栈的影响。在您的示例中，您从`aload_0`（这是`this`引用）开始，然后在该引用之上做很多魔术（一直更新操作数堆栈）。过了一会儿，您正在寻找的调用操作码就在那里，它消耗了`this`引用（以及一些参数的引用）。这就是`super`电话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T20:07:45.733

super() 调用的答案是行号。31.

我发现通过 Eclipse 的类文件编辑器很容易。看看下面附上的快照。

这里要记住的一件事是，前缀“a”表示操作码正在操作对象引用。前缀“i”表示操作码正在操作一个整数。

所以，逐行解释如下，

```
12  new java.lang.Integer //Create a new java.lang.Integer 
15  dup //Make a extra reference to the same Integer
16  iconst_2 // this means opcode is manipulating Integer as Integer(2)
17  invokespecial java.lang.Integer(int) //Integer(2) is invoked
20  invokespecial A(java.lang.Object, java.lang.Object) //new A(new Object(), new Integer(2) is invoked
23  new java.lang.Integer //Create a new java.lang.Integer
26  dup //Make a extra reference to the same Integer
27  iconst_1 // this means opcode is manipulating Integer as Integer(1)
28  invokespecial java.lang.Integer(int) //Integer(1) is invoked
31  invokespecial A(java.lang.Object, java.lang.Object) **//super(new A(new Object(), new Integer(2)), new Integer(1)) is invoked** 
```

我希望后面的内容容易理解。:)

```
56 - this invoke is for the sysout related A(object,object) invocation. 
```

![在此处输入图像描述](../Images/67ed45f823ed497de79ae3f4adc2ea9a.png)

# bash - Bash：在文件末尾添加一个随机字母数字字符串

> ID：14633112
> 
> 赞同：0
> 
> 时间：2013-01-31T18:58:41.323
> 
> 标签：bash, unix

我想提出一个 bash 脚本，它会在所有文件的末尾添加一个随机的字母数字字符串。我希望字符串的长度为 10。

所以如果我有文件名：hello.jpg 它会变成：hello_v41e6ebadx_.jpg

有没有人对如何做到这一点有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:09:51.423

```
for file in *.*
do
    name=${file%.*}
    ext=${file##*.}
    random=$(LC_CTYPE=C tr -cd 'a-zA-Z0-9' < /dev/urandom | head -c 10)
    mv "$file" "${name}_${random}_.${ext}"
done 
```

您还可以考虑`mktemp`，如果您的文件扩展名中没有“X”可能会出错。

# playframework-1.x - 在播放 1.2.5 时遇到路由问题

> ID：14633116
> 
> 赞同：0
> 
> 时间：2013-01-31T18:58:57.313
> 
> 标签：playframework-1.x

我可能错误地将我的路由文件配置为 play-1.2.5 - 下面是相关的路由文件部分和正在使用的 URL：

**网址**：

```
GET /application/autoComplete?term=mac 
```

**路线：**

```
GET     /autoComplete/{term}     controllers.Application.AutoCompleteTerm 
```

我还定义了以下路线，但没有被拾起：

```
GET     /autoComplete/     controllers.Application.AutoCompleteTerm 
```

路线没有被击中 - 相反，我得到了一个找不到模板的异常：

```
play.exceptions.TemplateNotFoundException: Template not found 
```

任何有助于解决此问题的建议都将受到欢迎。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:07:21.647

路线：

```
GET     /autoComplete/{term}     controllers.Application.AutoCompleteTerm 
```

...是错的。它应该是这样的：

```
GET     /autoComplete/{term}     Application.autoCompleteTerm 
```

这将对应于以下 URL：

```
GET http://127.0.0.1:9000/autoComplete/mac 
```

Application 中的相应方法如下所示：

```
public static void autoCompleteTerm(String term) {
    ...
} 
```

网址：

```
GET http://127.0.0.1:9000/autoComplete?term=mac 
```

...需要以下路线：

```
GET     /autoComplete     Application.autoCompleteTerm 
```

...以及与上述相同的方法：

```
public static void autoCompleteTerm(String term) {
    ...
} 
```

# ios - 设置 loader 类的 z-index

> ID：14633124
> 
> 赞同：0
> 
> 时间：2013-01-31T18:59:24.427
> 
> 标签：ios, actionscript-3, flash, air, loader

我正在使用适用于 iOS SDK 的 Flash AS3、AIR 3.2。我正在加载图像，然后在其上应用形状和文本字段。但似乎 z-index 在加载器类中变得很奇怪。目前，当它运行时，首先应用文本和形状，然后将图像应用在这些之上，即使这些方法的顺序不同。如何将形状和文本设置在从加载器类加载的图像上方？

main方法中的方法：

```
displayImage();
overlayBox();
textAnimation(); 
```

这些是方法：

```
public function displayImage():void {

        var imageurl:String = "image.jpg";

        myLoader = new Loader();

        var fileRequest:URLRequest = new URLRequest(imageurl);

        myLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onLoaderProgress);
        myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaderComplete);

        myLoader.load(fileRequest);
    }

public function onLoaderProgress(e:ProgressEvent) {
        trace(e.bytesLoaded, e.bytesTotal); // this is where progress will be monitored
    }

public function onLoaderComplete(e:Event) {

        image = new Bitmap(e.target.content.bitmapData);

        var imageWidth:Number = image.width;
        var imageHeight:Number = image.height;
        var resizeWidthVar:Number;
        var resizeHeightVar:Number;

        trace("Image width: " + image.width);
        trace("Image height: " + image.height);

        if(imageWidth >= imageHeight) {
            resizeHeightVar = imageHeight/displayRes;
            trace("resizeHeightVar = " + resizeHeightVar);

            imageWidth = imageWidth/resizeHeightVar;
            imageHeight = imageHeight/resizeHeightVar;
        }
        else {
            resizeWidthVar = imageWidth/displayRes;
            trace("resizeWidthVar = " + resizeWidthVar);

            imageWidth = imageWidth/resizeWidthVar;
            imageHeight = imageHeight/resizeWidthVar;
         }

        image.width = imageWidth;
        image.height = imageHeight;

        trace("Image width: " + image.width);
        trace("Image height: " + image.height);

        image.x = xScreenPos;
        image.y = yScreenPos;

        addChild(image); // the image is now loaded, so let's add it to the display tree!
    }

public function overlayBox():void {

        var overlaySquare:Sprite = new Sprite();

        addChild(overlaySquare);

        overlaySquare.graphics.beginFill(0x00000, 0.7);
        overlaySquare.graphics.drawRect(0, 0, displayRes, displayRes);
        overlaySquare.graphics.endFill();
        overlaySquare.x = xScreenPos;
        overlaySquare.y = yScreenPos;
    }

public function textAnimation():void {

        //set text format
        textFormat.font = "Helvetica Neue Light";
        textFormat.size = 12;
        textFormat.bold = false;
        textFormat.color = 0x000000;

        // pass text format
        textOne.defaultTextFormat = textFormat;

        textOne.text = "Blah blah blah blah";
        textOne.autoSize = TextFieldAutoSize.LEFT;
        textOne.x = xScreenPos;
        textOne.y = yScreenPos;

        //add to stage
        addChild(textOne);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:23:11.317

一种解决方案是替换`addChild(image);`为`addChildAt(image, 0);`另一种是添加加载程序`addChild(loader);`，而不是在完整的处理程序中添加图像。

# zend-framework - Zend_Paginator 分类

> ID：14633126
> 
> 赞同：0
> 
> 时间：2013-01-31T18:59:29.553
> 
> 标签：zend-framework, zend-paginator

我在我的索引操作中使用了 Zend_Paginator，这显示了我所有的目录：

```
public function indexAction()
{
   Zend_View_Helper_PaginationControl::setDefaultViewPartial('/pagination.phtml');
    $pages = new Application_Model_DbTable_Catalog();

    $num = 10;
    $page = $this->_getParam('page');

    $select = $pages->select();
    $result = $this->view->table = $pages->fetchAll($select)->toArray();
    $paginator = new Zend_Paginator(new Zend_Paginator_Adapter_Array($result));
    $paginator->setItemCountPerPage($num);
    $paginator->setCurrentPageNumber($page);
    $paginator->setView($this->view);
    $this->view->paginator = $paginator;
} 
```

它工作得很好，现在我有了 CategoryAction，它按类别对​​我的目录进行排序

```
public function categoryAction()
{
    $id = intval($this->_getParam('id', 0));
    if ($id > 0) {
        $catalog = new Application_Model_DbTable_Catalog();
        $this->view->catalog = $catalog->getByCategoryId($id);
        и
        $category = new Application_Model_DbTable_Categories();
        $this->view->category = $category->getById($id);

    } 
```

所以我不明白如何在这个动作中添加分页，帮帮我，Pleaaasssseeeeeeee :-(，抱歉我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T09:06:24.880

好的，有更好/更简单的方法来做到这一点。

分页从您的数据库查询开始。您正在使用 DbTable 模型，因此在 ZF1 中设置适配器非常容易。

```
<?php 

class Application_Model_DbTable_Catalog extends Zend_Db_Table_Abstract
{
    protected $_name = 'catalog'
    /*
     * This method returns a paginator adapter with a fetchAll($where = null, $order = null, $count = null, $offset = null)
     * paginator adapter will supply the values for $offset and $limit
     */
    public function getPagedCatalog() 
    {
        $select = $this->select(); //put anything you need into $select
        $adapter = new Zend_Paginator_Adapter_DbTableSelect($select);//the paginator adapter in place of the fetchAll().

        return $adapter;
    {
}

<?php 

class Application_Model_DbTable_Categories extends Zend_Db_Table_Abstract
{
    protected $_name = 'categories'

    /*
     * This method returns a paginator adapter with a fetchAll($where = $id, $order = null, $count = null, $offset = null)
     * paginator adapter will supply the values for $offset and $limit
     */
    public function getPagedCatagories($id) 
    {
        $select = $this->select(); //put anything you need into $select
        $select->where('catagory_id = ?', $id);//you may need to build a join for this to work how you want it to, depends on your table structure.
        $adapter = new Zend_Paginator_Adapter_DbTableSelect($select);//the paginator adapter in place of the fetchAll().

        return $adapter;
    {
} 
```

现在您的模型将返回包含这些表内容的分页器适配器。`Zend_Paginator`将自动为查询提供`$limit`and`$offset`参数，以便每个页面执行一次查询。使用此适配器，整个表将不会存储在内存中。

现在你`indexAction()`可能看起来像：

```
public function indexAction()
{
   Zend_View_Helper_PaginationControl::setDefaultViewPartial('/pagination.phtml');
    $pages = new Application_Model_DbTable_Catalog();
    $adapter = $pages->getPagedCatalog(); //get adapter from model

    $page = $this->_getParam('page', 1);//a default of page 1 prevents possible unusual behavior when no page number is set.

    $paginator = new Zend_Paginator($adapter);
    $paginator->setItemCountPerPage('10');
    $paginator->setCurrentPageNumber($page);
    //$paginator->setView($this->view); This line is likely not needed
    $this->view->paginator = $paginator;
} 
```

你`categoryAction()`可能会像这样工作：

```
public function categoryAction()
{
    $page = $this->_getParam('page', 1);
    $id = intval($this->_getParam('id', 0));
    if ($id > 0) {
        $category = new Application_Model_DbTable_Categories();
        $adapter = $category->getPagedCatagories($id);
        //same as above
        $paginator = new Zend_Paginator($adapter);
        $paginator->setItemCountPerPage('10');
        $paginator->setCurrentPageNumber($page);
        //$paginator->setView($this->view); This line is likely not needed, unless you have multiple view objects.
        $this->view->paginator = $paginator;
    } else {
        //do some other stuff...
    }
} 
```

如果你发疯了并且想使用自己的映射器类来建立分页器适配器，你可以通过覆盖来扩展适配器类`getItems()`，例如：

```
<?php

class Music_Model_Paginator_Track extends Zend_Paginator_Adapter_DbTableSelect
{
    //override getItems()
    public function getItems($offset, $itemCountPerPage)
    {
        $rows = parent::getItems($offset, $itemCountPerPage);

        $albums = array();
        foreach ($rows as $row) {
            $album = new Music_Model_Mapper_Track();//use this class to turn each $row into an object                
            $albums[] = $album->createEntity($row); //build the new entity objects
        }
        //returns an array of entity objects to the paginator
        return $albums;
    }
} 
```

希望这可以帮助。

# java - XStream 使用 toXML(Object, StreamWriter) 缺少换行符

> ID：14633133
> 
> 赞同：1
> 
> 时间：2013-01-31T18:59:52.283
> 
> 标签：java, newline, xstream

我尝试使用 Xstream 序列化 Java 中的对象列表，我的核心代码是：

```
//register alias
xstream.alias("category", ServerCategory.class);

//register converter
xstream.registerConverter(new ServerCategoryConverter());

// get all categories
List<ServerCategory> categoryList = categoryDao.getAllEager();

// serialize all categories
for(ServerCategory category : categoryList) {
    xstream.toXML(category, streamWriter);
} 
```

这很好用，但是我在`</category>`-tag 之后没有换行，这似乎与 xml 规范冲突，导致每个读者都在这一行中断。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:32:12.743

您当前的代码将生成如下内容：

```
<category>
    <id>1</id>
    <name>One</name>
    <description>One</description>
    <syncversion>V1</syncversion>
    <parents/>
  </category>
  <category>
    <id>2</id>
    <name>Two</name>
    <description>Two</description>
    <syncversion>V1</syncversion>
    <parents>
      <parent>1</parent>
    </parents>
  </category> 
```

这是无效的 xml，因为它应该有一个根元素（这个 xml 有多个根元素类别） 理想情况下，您应该像这样生成。您将能够在浏览器中打开下面的内容。

```
<list> <!-- one root element required!!-->
  <category>
    <id>1</id>
    <name>One</name>
    <description>One</description>
    <syncversion>V1</syncversion>
    <parents/>
  </category>
  <category>
    <id>2</id>
    <name>Two</name>
    <description>Two</description>
    <syncversion>V1</syncversion>
    <parents>
      <parent>1</parent>
    </parents>
  </category>
<list> 
```

需要做的是，而不是

```
for(ServerCategory category : categoryList) {
    xstream.toXML(category, streamWriter);
} 
```

你应该序列化整个列表

```
xstream.toXML(categoryList, streamWriter); 
```

并且您的 ServerCategoryConverter canCovert() 应该被覆盖

```
public boolean canConvert(Class foo) {
            //dont use this converter for the Arraylist. Arraylist will be handeld by the default converter
            if (foo.getName().equals("java.util.ArrayList")) {
                return false;
            }
            return true;
        } 
```

我附上了我的完整代码以供参考。它适用于上述修复：

```
import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.converters.Converter;
import com.thoughtworks.xstream.converters.MarshallingContext;
import com.thoughtworks.xstream.io.HierarchicalStreamWriter;

import java.io.*;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.List;

public class XSTReamTest {
    /*
 * ExpertService.class
 */
    public static void main(String args[]) throws Exception {
        XSTReamTest tst = new XSTReamTest();
        tst.createXmlExport();
    }

    public File createXmlExport() throws Exception {
        XStream xstream = new XStream();
        File xmlExportFile = null;
        BufferedOutputStream outputStream = null;
        OutputStreamWriter streamWriter = null;

        try {
            xmlExportFile = new File("easylearncards1_exportRequest_.xml");
            System.out.println("Path = " + xmlExportFile.getAbsolutePath());

            outputStream = new BufferedOutputStream(new FileOutputStream(xmlExportFile));
            streamWriter = new OutputStreamWriter(outputStream, Charset.forName("UTF-8"));
            exportCategories(xstream, streamWriter);
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                streamWriter.close();
                outputStream.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return xmlExportFile;
    }

    private void exportCategories(XStream xstream, OutputStreamWriter streamWriter) {
        // register alias
        xstream.alias("category", ServerCategory.class);

        // register converter
        xstream.registerConverter(new ServerCategoryConverter());

        // get all categories
        List<ServerCategory> categoryList = new ArrayList<ServerCategory>();

        ServerCategory root = new ServerCategory("1", "One", "One", "V1", null);
        ServerCategory child1 = new ServerCategory("2", "Two", "Two", "V1", new ServerCategory[]{root});
        ServerCategory child2 = new ServerCategory("3", "Three", "Three", "V1", new ServerCategory[]{root});
        ServerCategory child3 = new ServerCategory("4", "Four", "Four", "V1", new ServerCategory[]{child1, child2});

        categoryList.add(root);
        categoryList.add(child1);
        categoryList.add(child2);
        categoryList.add(child3);

        // convert all categories
//        for (ServerCategory category : categoryList) {
//            xstream.toXML(category, streamWriter);
//        }
        xstream.toXML(categoryList, streamWriter);
    }

    static class ServerCategory {
        String id;
        String name;
        String description;
        String syncVersion;
        ServerCategory parents[];

        ServerCategory(String id, String name, String description, String syncVersion, ServerCategory[] parents) {
            this.id = id;
            this.name = name;
            this.description = description;
            this.syncVersion = syncVersion;
            this.parents = parents;
        }

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public String getDescription() {
            return description;
        }

        public void setDescription(String description) {
            this.description = description;
        }

        public String getSyncVersion() {
            return syncVersion;
        }

        public void setSyncVersion(String syncVersion) {
            this.syncVersion = syncVersion;
        }

        public ServerCategory[] getParents() {
            return parents;
        }

        public void setParents(ServerCategory[] parents) {
            this.parents = parents;
        }
    }
/*
 * ServerCategoryConverter.class
 */

    static class ServerCategoryConverter implements Converter {

        public void marshal(Object value, HierarchicalStreamWriter writer, MarshallingContext context) {

            ServerCategory category = (ServerCategory) value;

            writer.startNode("id");
            writer.setValue(category.getId().toString());
            writer.endNode();

            writer.startNode("name");
            writer.setValue(category.getName());
            writer.endNode();

            writer.startNode("description");
            writer.setValue(category.getDescription());
            writer.endNode();

            writer.startNode("syncversion");
            writer.setValue(category.getSyncVersion().toString());
            writer.endNode();

            writer.startNode("parents");
            if (category.getParents() != null) {
                for (ServerCategory parent : category.getParents()) {
                    writer.startNode("parent");
                    writer.setValue(parent.getId().toString());
                    writer.endNode();

                }
            }
            writer.endNode();

        }

        public java.lang.Object unmarshal(com.thoughtworks.xstream.io.HierarchicalStreamReader hierarchicalStreamReader, com.thoughtworks.xstream.converters.UnmarshallingContext unmarshallingContext) {
            return null;
        }

        public boolean canConvert(Class foo) {
            if (foo.getName().equals("java.util.ArrayList")) {
                return false;
            }
            return true;
        }

    }
} 
```

# css - 在透明背景上的标题后面画线

> ID：14633134
> 
> 赞同：0
> 
> 时间：2013-01-31T19:00:03.423
> 
> 标签：css, border, transparent, margin

我想在标题的左侧和右侧画一条线，如下所示：

![标题装饰示例](../Images/09065a36ed03aefc58a8b00c64aef9c0.png)

通常我会通过为周围元素添加一个边框顶部和标题的以下样式来做到这一点。

```
h2
{
   margin-top:-10px;
   padding: 0 5px;
   background:white;
} 
```

但在这种情况下，我不能这样做，因为周围元素的背景是透明的，正如你在这个小提琴中看到的：http: [//jsfiddle.net/tUmZY/2/](http://jsfiddle.net/tUmZY/2/)

我现在正在玩这个，但我不知道如何实现这一点。只要效果是理想的，我将不胜感激任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:32:11.727

您是否正在寻找这样的东西：

**CSS：**

```
h2:before, h1:after {
    content: '';
    position: absolute;
    border-top: 1px solid white;
    width: 100%;
    top: 50%;
}
h2:before {
    right: 100%;
}
h2:after {
    left: 100%;
} 
```

# visual-studio - Visual Studio 2012 设计器错误

> ID：14633148
> 
> 赞同：1
> 
> 时间：2013-01-31T19:01:00.213
> 
> 标签：visual-studio, visual-studio-2012, windows-8

我正在开发 Windows 应用商店应用程序。打开 XAML 文件时突然出现异常
“ **System.Runtime.InteropServices.COMException。**
无法启动应用程序。尝试重新安装应用程序以解决问题。（HRESULT 异常：0x80073CFC）”

到目前为止我尝试过的：

1.重新启动PC
2.重新安装Visual Studio 2012
Ultimate 3.卸载VS 2012 Ultimate并为Windows 8安装VS2012 Express。

但错误仍然相同。

错误的详细信息是： 请帮助我。 `Microsoft.Expression.HostUtility.AppPackage.AppPackageNativeMethods.IApplicationActivationManager.ActivateApplication(String appUserModelId, String activationContext, ActivateOptions options, Int32& processId) at Microsoft.Expression.HostUtility.AppPackage.WrtUtility.ActivateApplication(String appUserModelId, String activationContext, Object site) at Microsoft.Expression.HostUtility.Platform.AppContainerProcessDomainFactory.ActivateApplicationInternal(String appUserModelId, String activationContext, Object site) at Microsoft.Expression.HostUtility.Platform.AppContainerProcessDomainFactory.CreateDesignerProcess(String applicationPath, String clientPort, Uri hostUri, IDictionary environmentVariables, Int32& processId, Object& processData) at Microsoft.Expression.DesignHost.Isolation.Primitives.ProcessDomainFactory.ProcessIsolationDomain..ctor(ProcessDomainFactory factory, IIsolationBoundary boundary, AppDomainSetup appDomainInfo, FrameworkName targetFramework, String identifier, String baseDirectory) at Microsoft.Expression.DesignHost.Isolation.Primitives.ProcessDomainFactory.CreateIsolationDomain(IIsolationBoundary boundary) at Microsoft.Expression.HostUtility.Platform.AppContainerProcessDomainFactory.CreateIsolationDomain(IIsolationBoundary boundary) at Microsoft.Expression.DesignHost.Isolation.Primitives.IsolationBoundary.Initialize() at Microsoft.Expression.DesignHost.Isolation.Primitives.IsolationBoundary.CreateInstance[T](Type type) at Microsoft.Expression.DesignHost.Isolation.IsolatedExportProvider.Initialize() at Microsoft.VisualStudio.ExpressionHost.Services.VSIsolationService.CreateExportProvider(IIsolationTarget isolationTarget, ICatalogFactory catalogFactory, IExportFilter filter) at Microsoft.Expression.DesignHost.Isolation.IsolationService.CreateLease(IIsolationTarget isolationTarget) at Microsoft.Expression.DesignHost.IsolatedDesignerService.CreateLease(IIsolationTarget isolationTarget, CancellationToken cancelToken, DesignerServiceEntry& entry) at Microsoft.Expression.DesignHost.IsolatedDesignerService.IsolatedDesignerView.CreateDesignerViewInfo(CancellationToken cancelToken) at Microsoft.Expression.DesignHost.Isolation.IsolatedTaskScheduler.InvokeWithCulture[T](CultureInfo culture, Func`2 func, CancellationToken cancelToken) at Microsoft.Expression.DesignHost.Isolation.IsolatedTaskScheduler.<>c__DisplayClassa`1.b__6() at System.Threading.Tasks.Task`1.InnerInvoke() at System.Threading.Tasks.Task.Execute()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-27T13:33:56.810

你不需要重新安装你的窗户，你可以恢复它，它会解决你的问题。我曾经有同样的问题，我通过系统还原解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T09:04:34.360

我的系统上发生了同样的错误。
即使我
1\. 多次重启机器
2\. 卸载并重新安装 VS 2012

但即使在新项目中我仍然遇到同样的错误。

由于没有其他选择，我在格式化系统后重新安装了 Windows 8。
不确定这是否是最好的做法，但它对我有用。

希望能帮助到你 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-30T11:13:40.023

**解决方案**

你好，

我遇到了由开发人员许可证续订过程引起的相同问题。 **你不需要重新安装你的 windows 甚至 Visual Studio**。这就是解决我的问题的原因。

1.  只需转到 PC 设置
2.  创建一个新用户（windows用户）
3.  登录到您创建的新用户帐户。
4.  启动 Visual Studio 并打开您正在处理的解决方案。

在重新安装 Windows 之前尝试一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:07:41.290

尽管问题出在较旧的视觉工作室上，但以下网站可能会帮助您解决问题，但我怀疑它会解决问题： [这里](http://lionsden.co.il/codeden/?p=488)

或者，尝试将其放入 xaml 文件中：

```
<ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <!-- 
                Styles that define common aspects of the platform look and feel
                Required by Visual Studio project and item templates
             -->
            <ResourceDictionary Source="Common/StandardStyles.xaml"/>
        </ResourceDictionary.MergedDictionaries>
        <Style x:Key="BigGreenTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Green"/>
            <Setter Property="FontSize" Value="36"/>
            <Setter Property="FontFamily" Value="{StaticResource ContentControlThemeFontFamily}"/>
            <Setter Property="TextTrimming" Value="WordEllipsis"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Typography.StylisticSet20" Value="True"/>
            <Setter Property="Typography.DiscretionaryLigatures" Value="True"/>
            <Setter Property="Typography.CaseSensitiveForms" Value="True"/>
        </Style>
        <x:String x:Key="AppName">HelloWorld</x:String>
    </ResourceDictionary> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-02T20:17:50.603

***如何解决设计师错误的问题..***

**1st ... 将 temp tmp 值的路径设置为**

“C:\Windows.old\Users\Default\AppData\Local\Temp”

**第二个转到窗口功能..**

并执行图像中的此步骤 ==.. [此处的第 2 步](https://i.stack.imgur.com/VlHho.png)

**第三次转到视觉工作室位置并左键单击图标。**

并让执行此步骤==。 [第 3 步在这里](https://i.stack.imgur.com/XlrIA.png**)

# android - Jquery Mobile 自定义选择和对话框在 android 上冻结/崩溃

> ID：14633150
> 
> 赞同：0
> 
> 时间：2013-01-31T19:01:11.217
> 
> 标签：android, jquery, jquery-mobile

我是 jquery 和 jquery mobile 的新手，并且遇到了自定义选择问题（data-native-menu="false"）。当我点击打开一个，只有 4 个选项时，有时它会正常打开，但会在一秒钟后自行关闭，在我有机会选择一个选项之前。

另一个可能相关的问题是，有时当我打开一个对话框（data-rel='dialog'）时，当我点击它提供的“X”按钮时它不会关闭。

我的代码验证为 HTML 5，我所做的唯一自定义配置是 defaultDialogTransition 和 defaultPageTransition 关闭。

我有它，所以每个表单元素都有一个唯一的 ID，每个页面也是如此。

这两个问题都发生在 2.3 姜饼的 opera 和 android 浏览器上。

谢谢，凯文

```
<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<title>title</title>
<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;' />
<script src='//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
<script src='/js/jquery_mobile_global_defaults.js'></script>
<script src='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js'></script>
<link rel='stylesheet' href='/design/mobile_style.css'>
<link rel='stylesheet' href='http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css' />
</head>

<body>
<div data-role='page' id='homepage'>

    <div class='header'>

        <div class='logo'><a href='/' ><img src='/design/logo.png'></a></div>
        <div class='login'><a href='/php/mobile_login.php' data-overlay-theme='b' data-transition='none' data-rel='dialog' data-role='button' data-inline='true' data-icon='arrow-r' data-iconpos='right' data-theme='a' data-mini='false'>Login</a></div>
    </div>

    <div class='mobile_content'>
    <form data-ajax='true'  method='GET' id='btipdgnkrb_form' action='/php/mobile_search.php'>
<div>
<select data-native-menu='false' onchange='ajaxcreateSubCatSelect("btipdgnkrb");' name='main_catetory_type' id='btipdgnkrb_maincat'>
<option>Career path / role</option>
<option value='CONSTRUCTION'>Construction roles</option>
<option value='DESIGN'>Design roles</option>
<option value='ENERGY'>Energy roles</option>
<option value='GENERIC'>General roles</option>
</select>
</div>
<div id='btipdgnkrb_subcatloaddiv' style='text-align:center;'></div>
<div>
<select data-overlay-theme='b'  disabled data-native-menu='false' name='profession_id' id='btipdgnkrb_subcat'><option data-placeholder='true'>
Select role / category</option></select>
</div>
<div><select name='location_id' id='btipdgnkrb_location' data-overlay-theme='b' data-native-menu='false' data-icon='arrow-d'><option data-placeholder='true' value='0'>Location (optional)
</option>
<option></option>
<option value=37>Ireland</option>
<option value=61>Ulster</option>
</select></div>
<label for='btipdgnkrb_keywords' class='ui-hidden-accessible'>Keywords:</label>
<div><input type='text' name='keywords' id='btipdgnkrb_keywords' value='' placeholder='Keywords (optional)'></div>
<div><input type='submit' data-theme='b' data-icon='search' data-iconpos='right' value='Search'></div>
<div><input type='button' onclick='reset_search_form("btipdgnkrb");' data-theme='c' data-iconpos='right' value='Clear form'></div>
</form>
<p>&nbsp;<p>

    <script src='/js/main.js'></script> 

    </div>

    <div data-role='footer' data-theme='a' > 
    <div data-role='navbar' data-iconpos='right'>
        <ul>
            <li><a data-icon='home' href='/'>Home / Search</a></li>
            <li><a data-icon='plus'   href='#'>Menu</a></li>
        </ul>
    </div><!-- /navbar -->
    </div> 

</div>

</body>
</html> 
```

# c++ - 错误地使用 SetPrecision

> ID：14633153
> 
> 赞同：-1
> 
> 时间：2013-01-31T19:01:19.183
> 
> 标签：c++, precision, double-precision

使用以下 2 个函数关注带有 * 注释的行。当 cout<< 语句执行时，不显示小数位。3021680380 /10000000 变成 302\. 而不是 302.1680。

```
void convert(){
    setprecision(4);   //************************
    newFileTime = new double[numRec];   //***********
    newOffset = new int[numRec];
    newSize = new int[numRec];
    newNum = new int[numRec];
    newType = new int[numRec];
    newTime = new int[numRec];

    for(int i = 0; i<numRec; i++){
        newFileTime[i] = fileTime[i] / 10000000; //**********
        newOffset[i] = offset[i] / 512;
        newSize[i] = fileSize[i] / 512;
        newNum[i] = 0;
        if(type[i] == "Write"){
            newType[i] = 0;
        }else{
            newType[i] = 1;
        }
        newTime[i] = responseTime[i] / 10000000;
    }
}

void exports(){
    setprecision(4);  //**************
    ofstream fout;
    fout.open("prxy_0.ascii");
    {
    if(!fout){
            cout <<"File opening failed. \n";
        }
    }
    fout<< numRec <<endl;

    for(int i = 0; i < numRec; i++){
        fout<< newFileTime[i] << " " << newNum[i] << " " << newOffset[i] << " " << newSize[i] << " " << newType[i] << " " << newTime[i];
        cout<< fileTime[i] << " " << newFileTime[i] <<endl; //**********
        if(i != numRec - 1){
            fout<<endl;
        }
    }
    fout.close();
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:03:21.223

每当您将两个整数相除时，此表达式的结果也是一个整数。整数除法总是向下舍入。

```
 newFileTime[i] = fileTime[i] / 10000000;
    //               ^^^^^^^^^^^   ^^^^^^^^
    //                   int          int 
```

要修复您的表达式，请将其中一个操作数转换为 a`double`以使除法成为浮点除法（使用以下可能性**之一）：**

```
 newFileTime[i] = static_cast<double>(fileTime[i]) / 10000000;
    // or
    newFileTime[i] = fileTime[i] / 10000000.0; 
```

请注意，设置精度要求您将调用`std::setprecision(...)`放入要设置精度的流中。此外，这仅设置**输出**精度（写入流时），而不是如何执行计算：

```
 std::cout << std::setprecision(4) << [some double values] 
```

另请注意，`std::setprecision`设置大数字的数量而不是小数点后的小数。所以你`302.1680`会被打印为`302.2`（四个伟大的数字）。*要在小数点后*设置固定位数，还`std::fixed`可以在之前或之后写入流`std::setprecision`：

```
 std::cout << std::fixed << std::setprecision(4) << [some double values] 
```

请注意，此类配置将在程序运行期间保留，直到您再次更改它们。要将它们保留在函数中，请确保在完成后恢复配置。

当然，`std::cout`这只是一个示例流。这同样适用于写入文件（任何`std::ostream`对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:11:03.217

不是你要求的（已经回答），但是这个：

```
newFileTime = new double[numRec];   //***********
newOffset = new int[numRec];
newSize = new int[numRec];
newNum = new int[numRec];
newType = new int[numRec];
newTime = new int[numRec]; 
```

请求成为：

```
struct FileData
{
    double fileTime;
    int offset;
    int size;
    int num;
    int type;
    int time;
};

FileData *newData = new FileData[numRec];

newData[i].fileTime = ... 
```

使整个事情更易于管理。

# ruby-on-rails - 在注册表中填充电子邮件有任何漏洞吗？

> ID：14633154
> 
> 赞同：1
> 
> 时间：2013-01-31T19:01:19.697
> 
> 标签：ruby-on-rails, security

我的应用程序允许用户通过电子邮件邀请他们认识的人。如果受邀者尚未注册，我们会发送一封电子邮件，要求受邀者进行注册。

我希望能够发送包含电子邮件 GET 参数的唯一注册链接，并在应用程序端使用此 GET 参数来填充注册表单的电子邮件字段。

我这样做会引入任何额外的安全漏洞吗？

一个例子...

电子邮件地址：[https ://www.domain.com/signup?email=me@email.com](https://www.domain.com/signup?email=me@email.com)

然后应用程序将使用 params[:email] 从 URL 中检索电子邮件并将其设置为注册表单的电子邮件字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T15:09:50.093

不; 只要您将该字符串视为不受信任的数据并进行适当处理，就不会引入任何漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:06:18.523

您可能会泄露一些数据。如果你做了序列号，我得到了 999，我会知道尝试 999 及以下的数字，我就能得到电子邮件地址。

以下是关于如何生成随机、唯一参数的一些想法：[PHP：如何生成随机、唯一、字母数字字符串？](https://stackoverflow.com/questions/1846202/php-how-to-generate-a-random-unique-alphanumeric-string)

不过，您需要输入电子邮件地址而不是 ID。

# c++ - 如何从 C:\Windows\System32 文件夹执行 Windows System() 命令？

> ID：14633155
> 
> 赞同：1
> 
> 时间：2013-01-31T19:01:27.797
> 
> 标签：c++, c, visual-c++, command

我有一个批处理文件“install.bat”存储在位置“

> c:\用户\abc\xyz

“。我想在管理模式下执行这个批处理文件

> C:\Windows\System32

使用 System() API 的文件夹。任何人都可以让我知道如何以编程方式实现这个 VC++。

我的代码片段::

```
int ret = System("c:\Users\abc\xyz\install.bat"); 
```

如果我给出这个命令，批处理文件当然是从“c:\Users\abc\xyz”文件夹执行的。但我想从 System32 文件夹运行这个批处理文件？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:05:51.317

一种选择是将`cd`命令作为 .bat 文件的第一行。您可以更改调用进程的工作目录，但这是用锤子敲碎的。

如果您远离该`system`功能，您可以调用`CreateProcess`. 这允许您在创建新流程时指定所需的所有细节。您需要运行命令解释器（通过读取`COMSPEC`环境变量来查找）。您可以将新进程的工作目录指定为`CreateProcess`.

`CreateProcess`虽然很难打电话。它不会帮助您请求提升管理员权限。相反，您可以使用`ShellExecute`. 将动词称为传递`"runas"`，这将导致提升。

```
ShellExecute(0, "runas", "c:\\Users\\abc\\xyz\\install.bat", NULL, 
    "C:\\Windows\\System32", SW_SHOW); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:07:14.097

您需要使用[ShellExecute](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb762153%28v=vs.85%29.aspx)。

类似于以下内容

```
ShellExecute(hwnd, "runas", "c:\\Users\\abc\\xyz\\install.bat", NULL, "c:\\windows\\system", SW_SHOWNORMAL ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:11:41.283

不使用 System()，您可以只`cd`到包含**.bat**文件的位置并调用批处理文件

# javascript - 使用 setInterval 但实际上没有做任何事情会导致内存泄漏吗？

> ID：14633161
> 
> 赞同：0
> 
> 时间：2013-01-31T19:01:47.660
> 
> 标签：javascript, memory-leaks, setinterval

我有一个脚本来检查屏幕上是否有一些元素，然后如果这些元素中有一定数量的元素，如果没有，它将“重绘”它们。这用于更改我无法使用 ajaxEVENT 的搜索结果的显示选项。

无论如何，如果条件不满足，并且没有任何反应，这会导致任何内存问题吗？我将间隔设置为每 1 秒运行一次，使用此脚本的人可能不会在同一页面上停留超过 5 分钟，所以..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:06:55.730

它确实会导致内存问题，因为您一直在运行脚本。尝试将一些事件处理程序绑定到任何你能做的事情上。imo 最好的方法是创建自己的事件并触发它们。

# c++ - 我很难调试长编译时间和多用户输入要求

> ID：14633164
> 
> 赞同：1
> 
> 时间：2013-01-31T19:02:04.457
> 
> 标签：c++

我需要绝望的帮助，因为我不知道为什么以及我做错了什么。我试图向用户询问有关长度转换的多个问题。我遇到一个问题，只问第一个问题，而下一个问题将没有机会被问到。我尝试了两个版本，但它们都有缺陷。

[样本输出：](http://imgur.com/zKqeU08)

```
Sisestage pikkus meetrides:
500
Sisestage uue uhiku kood (alj, ver, kyn, toll, jalg, jard, lii):
Sisestasite  vale vaartuse:500 void vale uhiku: 
```

我的代码：

```
#include <iostream> 
#include <iomanip> 
#include <string> 
#include <string.h>

using namespace std;

int main()
{

    float P;              /* Pikkus meetrites  */ /*Length P in metres*/
    string U;             /* M66du:hik*/ /* Unit of measure*/

    float ALJ;  
    float VER; 
    float KYN; 
    float TOLL; 
    float JALG; 
    float JARD; 
    float LII; 

    do
    { 
        cout<<"Sisestage pikkus meetrides: \n";  /*Ku:sin kasutajalt pikkust P*/ /* Asking       user for the length P in metres*/
        cin>>P; 
        if (P > 0)  
            cout<<"Sisestage uue uhiku kood (alj, ver, kyn, toll, jalg, jard, lii): \n"; /* Ku:sin         kasutajalt u:hiku koodi U*/ /* Asking user for the length U in metres*/
        getline(cin, U);
    } while (P > 0);     
    cout << "Sisestasite  vale vaartuse:"<<P<< endl; /*Veateade*/   
    ALJ = P / 5572;  
    VER = P / 1066.781; 
    KYN = P / 0.53; 
    TOLL = P / 0.0254; 
    JALG = P / 0.3048; 
    JARD = P / 0.9144; 
    LII = P / 500;

    if( U == "alj")
    { 
        cout<< setprecision(2)<<fixed<< P <<"m = "<< ALJ << U <<"." ;
    } 
    else if( U == "ver")
    {
        cout<< setprecision(2) << fixed << P <<" m ="<< VER << U <<".";
    }
    else if( U == "kyn") 
    {
        cout<< setprecision(2) << fixed << P <<" m ="<< KYN << U <<".";
    } 
    else if( U == "toll") 
    {
        cout<< setprecision(2) << fixed << P <<" m ="<< TOLL << U <<"."; 
    } 
    else if( U == "jalg")
    {
        cout<< setprecision(2) << fixed << P<<" m ="<< JALG << U <<".";
    } 
    else if( U == "jard")
    {
        cout<< setprecision(2) << fixed << P <<" m ="<< JARD << U <<".";
    } 
    else if( U == "lii")
    {
        cout<< setprecision(2) << fixed << P <<" m ="<< LII << U <<".";
    }

    getchar(); 
    getchar();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:18:28.290

1.验证线上没有任何开`{`闭：`}`

```
if (P > 0)  
 cout<<"Sisestage uue uhiku kood (alj, ver, kyn, toll, jalg, jard, lii): \n"; /* Ku:sin         kasutajalt u:hiku koodi U*/ /* Asking user for the length U in metres*/
 getline(cin, U); 
```

2.修正你的缩进，因为它使这样的错误更容易被发现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:19:52.297

很难`operator<<`与之混合`std::getline`。前者将行尾字符留在输入流中，这使后者感到困惑。

在您调用 之后`operator<<`，您必须使用该行的剩余部分。这里有两种方法：

```
// throw away rest of line
 std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); 
```

或者

```
 std::string temp;
 std::getline(cin, temp); // throw away rest of line 
```

尝试这个：

```
do
{ 
    cout<<"Sisestage pikkus meetrides: \n";  /*Ku:sin kasutajalt pikkust P*/ /* Asking       user for the length P in metres*/
    cin>>P;
    std::getline(cin, U); // throw away rest of line
    if (P > 0)  
        cout<<"Sisestage uue uhiku kood (alj, ver, kyn, toll, jalg, jard, lii): \n"; /* Ku:sin         kasutajalt u:hiku koodi U*/ /* Asking user for the length U in metres*/
    getline(cin, U); // Start on fresh line
} while (P > 0); 
```

正如其他人指出的那样，您的`if(P>0)`代码可能存在逻辑缺陷，但这与您的问题无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:09:11.240

很难说这个缩进是怎么回事，但你的意思是在 if() 块中包含 getline 吗？也许你错过了{}

```
 if (P > 0)  
 cout<<"Sisestage uue uhiku kood (alj, ver, kyn, toll, jalg, jard, lii): \n"; /* Ku:sin         kasutajalt u:hiku koodi U*/ /* Asking user for the length U in metres*/
 getline(cin, U); 
```

# protobuf-net - 如何使用 protobuf-net 预编译工具处理外部类型？

> ID：14633169
> 
> 赞同：1
> 
> 时间：2013-01-31T19:02:19.827
> 
> 标签：protobuf-net

我正在尝试使用最新版本（r622）中的 protobuf-net 预编译工具，我想知道如何处理我无法用 ProtoContract 属性装饰的类型。

更具体地说，当预编译工具处理聚合 XNA 成员（Vector3、Matrix 等）的自定义类型时，我收到以下预期错误：

`No serializer defined for type: Microsoft.Xna.Framework.Vector3`

由于我无法为这些类型添加属性，因此推荐的处理方法是什么？我应该恢复使用我自己的预编译工具创建和编译自定义 TypeModel 的旧方式吗？

# android - 适用于盲人的无障碍 Android Air 应用程序。使用 Android 的 TalkBack

> ID：14633170
> 
> 赞同：2
> 
> 时间：2013-01-31T19:02:20.263
> 
> 标签：android, actionscript, air, accessibility, blind

我正在寻找有关如何使盲人可以访问 Air 应用程序的帮助。它要求我使用 Android 内置的屏幕阅读器功能，称为 TalkBack。

经过研究，我没有找到任何有用的东西。我确实发现您可以使用“Capabilities.hasAccessibility()”检查设备是否具有辅助功能，但是即使设备确实具有辅助功能并且它们已打开，它也会返回 False（当 TalkBack 启用时，Accessibility.active 也设置为 False积极的）。我还发现您可以提供一个 Display 对象 AccessibilityProperties，例如我假设屏幕阅读器会使用的名称和描述。但是，它不起作用。添加属性后，我还使用了 Accessibility.updateProperties() ，但仍然没有运气。我还尝试将权限添加到 READ_PHONE_STATE 的清单中（尽管我不确定这是否是它的意思），但同样没有乐趣。

我只使用 Actionscript 3。不弯曲。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T22:37:15.497

据我所知，当涉及到使用 Air 构建的移动应用程序时，Adobe 决定忽略残疾人社区。似乎没有任何方法可以实现此类应用程序的可访问性。

我很想在这件事上犯错，但就目前而言，我很确定情况就是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-10T18:31:43.627

从过去几天的搜索和大量测试来看，您可以构建到 AIR 应用程序中的辅助功能似乎只能在基于浏览器的应用程序中工作。任何一种独立风格的应用程序 (.app/.dmg/.exe/.air) 形式的分发似乎都不适用于我们测试过的任何辅助工具。我们在 Windows 7 中测试了 Window-Eyes 和内置的讲述人。我无法找到任何 Adob​​e 文档来确认这一点，但对于他们来说似乎是一个巨大的疏忽，更不用说在任何文档中提及它了。

# php - PHP sf.1.4 Propel 1.6：循环结果时内存泄漏

> ID：14633179
> 
> 赞同：3
> 
> 时间：2013-01-31T19:03:01.650
> 
> 标签：php, memory-leaks, symfony-1.4, propel, elastica

我正在使用 symfony 1.4 + propel 1.6，我想将我的所有用户数据库导出（索引）到 ElasticSearch。

我已经编写了所有脚本并且一切正常，除了一个问题。我做了一个循环，重复大约 20.000~ 次，每次 memory_usage 增加。

问题是：它不应该，因为我正在销毁所有引用。

我认为 Propel 在某处留下了对我创建的每个对象的静态引用。但是找不到它，因为我已经禁用了实例池。

有人遇到过类似的问题吗？也许有人知道如何调试 PHP 内存限制？（webgrind 没有）我在这段代码调试上花费了最后几个小时，但仍然无法修复它。

```
// optimizations
    gc_enable();
    Propel::getConnection()->useDebug(false);
    Propel::disableInstancePooling();
// the while
    $offset = 0;
    $perpage = 10;
    $c = SearchUserQuery::create()->limit($perpage);
    do {
        $rs = SearchUserPeer::doSelectStmt($c);
        while ($row = $rs->fetch(PDO::FETCH_NUM))
        {
            $instance = new SearchUser();
            $instance->hydrate($row);
            $data = $instance->toElastic(); // this line makes a lot of memory leak
            $_document = new Elastica\Document($instance->getPrimaryKey(), $data);
            $_type->addDocument($_document);
            unset($_document, $instance);
        }
        $c->offset($offset += $perpage);
    } while( $rs->rowCount() ); 
```

函数 $instance->toElastic 是这样的：

```
public function toElastic()
{
    return Array(
        'profile' => $this->toArray(BasePeer::TYPE_COLNAME, false),
        'info' => $this->getUserInfo()->toArray(BasePeer::TYPE_COLNAME, false),
        'branches' => $this->getElasticBranches(),
    );
}

/**
 * @return array(id,name)
 */
public function getElasticBranches()
{
    $branches = Array();
    foreach ($this->getsfGuardUser()->getUserBranchs() as $branch)
        $branches[] = Array(
            'id' => $branch->getBranchId(),
            'name' => $branch->getName()
        );
    return $branches;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T20:38:58.137

您在取消设置之前是否尝试过此操作？

```
// garbage collector problem in PHP 5.3
$instance->clearAllReferences(true);

// remove the variable content before removing the address (with unset)
$instance = null;
$_document = null;
$_type = null; 
```

[您可以从此答案](https://stackoverflow.com/a/11339539/569101)中获取更多提示。看看这 3 个链接，真的很有趣，即使其中一个是法语的。

# regex - R代码检查单词是否匹配模式

> ID：14633196
> 
> 赞同：2
> 
> 时间：2013-01-31T19:03:50.003
> 
> 标签：regex, r, pattern-matching

我需要根据字符向量模式验证字符串。我目前的代码是：

```
trim <- function (x) gsub("^\\s+|\\s+$", "", x)

# valid pattern is lowercase alphabet, '.', '!', and '?' AND
# the string length should be >= than 2
my.pattern = c(letters, '!', '.', '?')

check.pattern = function(word, min.size = 2)
{
    word = trim(word)
    chars = strsplit(word, NULL)[[1]]
    all(chars %in% my.pattern) && (length(chars) >= min.size)
} 
```

例子：

```
w.valid = 'special!'
w.invalid = 'test-me'

check.pattern(w.valid) #TRUE
check.pattern(w.invalid) #FALSE 
```

我想这非常慢......有没有更快的方法来做到这一点？也许正则表达式？谢谢！

PS：感谢大家的精彩回答。我的目标是构建一个 29 x 29 矩阵，其中行名和列名是允许的字符。然后我遍历一个巨大的文本文件的每个单词并构建一个“字母优先级”矩阵。例如，考虑从第一个字符开始的单词“special”：

```
row s, col p -> increment 1
row p, col e -> increment 1
row e, col c -> increment 1
... and so on. 
```

我的代码的瓶颈是**向量分配**，我是在“追加”而不是预先分配最终的向量，所以代码需要 30 分钟来执行，而不是 20 秒！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:11:40.423

有一些内置函数可以清理您的代码。而且我认为您没有充分利用正则表达式的全部功能。

这里最突出的问题是`strsplit`。当你有正则表达式时，逐个字符比较事物的相等性是低效的。这里的模式使用方括号表示法来过滤你想要的字符。`*`用于任意数量的重复（包括零），而`^`and`$`符号表示行的开头和结尾，因此没有其他内容。`nchar(word)`是一样的`length(chars)`。更改`&&`为`&`使函数向量化，以便您可以输入字符串向量并获得逻辑向量作为输出。

```
check.pattern.2 = function(word, min.size = 2)
{
    word = trim(word)
    grepl(paste0("^[a-z!.?]*$"),word) & nchar(word) >= min.size
}
check.pattern.2(c(" d ","!hello  ","nA!","  asdf.!"," d d "))
#[1] FALSE  TRUE FALSE  TRUE FALSE 
```

接下来，使用花括号表示重复次数和 some `paste0`，该模式可以使用您的 min.size：

```
check.pattern.3 = function(word, min.size = 2)
{
    word = trim(word)
    grepl(paste0("^[a-z!.?]{",min.size,",}$"),word)
}
check.pattern.3(c(" d ","!hello  ","nA!","  asdf.!"," d d "))
#[1] FALSE  TRUE FALSE  TRUE FALSE 
```

最后，您可以从以下位置内化正则表达式`trim`：

```
check.pattern.4 = function(word, min.size = 2)
{
    grepl(paste0("^\\s*[a-z!.?]{",min.size,",}\\s*$"),word)
}
check.pattern.4(c(" d ","!hello  ","nA!","  asdf.!"," d d "))
#[1] FALSE  TRUE FALSE  TRUE FALSE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:45:44.123

如果我正确理解你想要的模式，你会想要一个类似于格式的正则表达式：

```
^\\s*[a-z!\\.\\?]{MIN,MAX}\\s*$ 
```

其中 MIN 替换为字符串的最小长度，MAX 替换为字符串的最大长度。如果没有最大长度，则可以省略 MAX 和逗号。同样，如果 {} 中的所有内容（包括大括号本身）既没有最大值也没有最小值，则可以用 * 替换，这表示前面的项目将匹配零次或多次；这相当于 {0}。

这确保正则表达式仅匹配任何前导和尾随空格之后的每个字符都来自以下集合的字符串 * 小写字母 * 砰（感叹号） * 问号

请注意，这是用 Perl 风格的正则表达式编写的，因为它是我更熟悉的；我的大部分研究都是在[这个 wiki for R text processing](http://en.wikibooks.org/wiki/R_Programming/Text_Processing#Regular_Expressions)上进行的。

函数运行缓慢的原因是将字符串拆分为多个较小字符串的额外开销。与正则表达式（甚至是对字符串的手动迭代，比较每个字符直到到达末尾或找到无效字符）相比，这是很多开销。还要记住，该算法确保了 O(n) 的性能率，因为拆分会生成 n 个字符串。这意味着即使是 FAILING 字符串也必须至少执行 n 次操作来拒绝该字符串。

希望这可以阐明您遇到性能问题的原因。

# javascript - 无法在插件中使用 jQuery 选择特定的 HTML5 视频

> ID：14633202
> 
> 赞同：0
> 
> 时间：2013-01-31T19:04:04.750
> 
> 标签：javascript, jquery, html, dom, video

我有一个用于 html5 视频的插件，我目前正在开发它，并希望在网页上单独选择每个视频。它以您通常开始的方式开始：

（函数（$）{

```
$.fn.videoPlayer = function(options) {

    var settings = {  
        playerWidth : '0.95', // Default is 95%
        videoClass : 'video'  // Video Class
    }

    // Extend the options so they work with the plugin
    if(options) {
        $.extend(settings, options);
    }

    // For each so that we keep chainability.
    return this.each(function() {       

        // Basic Variables 
        $this = $(this);
        $settings = settings; 
```

因此，由于我在插件中为每个视频都做，我希望每个视频都会被单独且具体地选择，但事实并非如此。所以如果我想做这样的事情：

```
$this.play(); 
```

这没用。相反，我必须这样做，否则我会收到关于该元素没有该方法的错误：

```
$this[0].play(); 
```

这不适用于插件，因为我需要将其应用于所有视频，而这只会选择页面上的第一个视频。那么我该如何解决这个问题呢？我在等待加载的元数据时也遇到了一些麻烦，这似乎以某种方式弄乱了页面上的所有视频（我假设是因为我必须等待或者是因为我上面提到的相关错误？）

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:05:40.320

`.play()`是原生 DOM 方法，所以`this`直接使用：

```
this.play(); 
```

由于您是第一次使用 jQuery 进行包装-`this`并且只调用- 您会收到错误，因为 jQuery 没有方法。`play``$this``play`

* * *

**PS**使用`$this[0].play()`也可以。它不会选择第一个视频，因为它使用回调的`this`值，`each`它的集合中只有一个元素......

# c# - 如何编译 32 位（我的操作系统是 64 位） - 错误 exe 不是有效的 Win32 应用程序

> ID：14633205
> 
> 赞同：5
> 
> 时间：2013-01-31T19:04:08.680
> 
> 标签：c#, visual-studio, visual-studio-2012, x86, 32-bit

正如标题所示，我正在 64 位机器上使用 VS 2012 编译 C# 应用程序。我希望正在构建的程序可以在 32 位机器上运行。

现在我在网上找到的唯一帮助是：菜单>构建>配置>活动解决方案平台默认为任何CPU，我试过了，但在32位机器上不起作用（除非我做错了什么）

尝试在 x86 平台的调试配置中添加一个新配置，并检查构建

在 32 位机器上编译并运行应用程序，出现错误 A.exe 不是有效的 Win32 应用程序。

我的上述内容与此处所做的类似：[Link to Stack Overflow Similar Question](https://stackoverflow.com/questions/4104228/change-target-cpu-settings-in-visual-studio-2010-express)

**更新 1：** 目标操作系统是 WinXP SP3，但我们不相信它上面有 .NET 4.5。我将测试以查看在 .NET 4.0 中编译应用程序的早期版本是否可以解决问题并解决问题。问题可能不是错误消息显示的内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T19:10:18.383

将您的项目设置为目标`AnyCPU`应该允许它在 32 位机器上运行，前提是您没有使用加载 64 位本机代码的库。如果您有任何依赖项，您还需要确保使用`AnyCPU`这些依赖项的 32 位版本。此外，请确保您在 32 位计算机上安装了正确的 .NET Framework（如果您在新项目中使用 VS 2012，则默认为 .NET 4.5）。

请注意，新项目在 VS 2012 中的默认值为 AnyCPU，`Prefer 32 Bit`选中该选项。这将导致它始终作为 32 位应用程序运行，即使在您的 64 位操作系统上也是如此。

* * *

请注意，由于您的朋友运行的是 XP sp3，因此您不能使用 .NET 4.5。Windows XP 不支持 .NET 4.5。您需要将您的应用程序更改为以 .NET 4.0 为目标，然后它将在 XP 机器上运行（如果他安装了 4.0 框架）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T19:10:07.680

该错误是 Win32 错误[`ERROR_BAD_EXE_FORMAT`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms681382.aspx#ERROR_BAD_EXE_FORMAT)。它由加载程序生成，当您尝试在 32 位操作系统上运行 64 位进程时会发生这种情况。还有其他方法可以查看该错误，但这是迄今为止在 .exe 文件上发生该错误的最常见原因。

要编译 32 位进程，您需要在项目配置中以 x86 为目标。另一种选择是针对 AnyCPU。这将导致在 32 位操作系统上执行时是 32 位进程，而在 64 位操作系统上执行时会导致 64 位进程。您的构建目标似乎是 x64。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:30:37.300

平台名称（显示在属性顶部，“构建”页面）只是一个名称。配置编辑器中的“Active Solution Platform”也是如此。这有点令人困惑。

您必须确保“目标平台”设置确实设置为“AnyCPU”或“x86”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T07:50:40.643

我有同样的问题。我与之斗争。并且我找到了解决方案。解决方案是：

首先选择平台目标“ **x86** ”。之后将您的项目构建为“**发布模式**”而不是“**调试模式**”。最后，您可以在任何平台（32 位或 64 位）上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-17T13:39:15.707

如果上面提供的解决方案都没有帮助您，请尝试以下操作： 打开项目属性并单击左侧栏中的常规。将平台工具集更改为其中包含 Windows XP 的工具集。

例如，在 Visual Studio 2015 中，它将默认设置为“Visual Studio 2015 (v140)”。为了能够在 Windows XP 上运行，您必须将其更改为“Visual Studio 2015 - Windows XP (v140_xp)”。

现在进行完全重建，exe 应该可以在 Windows XP 上运行。

# iphone - 从横向视图控制器推送时强制纵向

> ID：14633213
> 
> 赞同：30
> 
> 时间：2013-01-31T19:04:30.867
> 
> 标签：iphone, objective-c, orientation, landscape, portrait

应用支持：iOS6+

我的应用程序适用于纵向和横向。但是 1 个控制器只能在肖像中使用。

问题是，当我处于横向并推动视图控制器时，新的视图控制器也处于横向状态，直到我将其旋转为纵向。然后它被卡在肖像中，因为它应该是。

是否有可能总是让它出现在肖像中？即使它的父母在横向推动它？

以下所有代码都无济于事

```
[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait]; 
```

并且此代码一直有效，除非我不从横向推动[如何在 iOS 6 中强制 UIViewController 为纵向方向](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-01T18:33:13.527

我通过在 ViewDidLoad 中添加以下行解决了这个问题

```
UIViewController *c = [[UIViewController alloc]init];
[self presentViewController:c animated:NO completion:nil];
[self dismissViewControllerAnimated:NO completion:nil]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T19:14:49.473

首先，您需要创建一个类别：

UINavigationController+Rotation_IOS6.h

```
#import <UIKit/UIKit.h>

@interface UINavigationController (Rotation_IOS6)

@end 
```

UINavigationController+Rotation_IOS6.m：

```
#import "UINavigationController+Rotation_IOS6.h"

@implementation UINavigationController (Rotation_IOS6)

-(BOOL)shouldAutorotate
{
    return [[self.viewControllers lastObject] shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
}

@end 
```

然后，你在你的类中实现这些方法，你只想成为风景：

```
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

如果您使用的是 UITabBarController，只需将 UINavigationController 替换为 UITabBarController。经过长时间的搜索，这个解决方案对我很有效！我和你现在的情况一样！

**编辑**

所以，我看到了你的样本。你需要做一些改变。1 - 为 UINavigationController 类别创建一个新类。将类命名为 UINavigationController+Rotation_IOS6（.h 和 .m） 2 - 您不需要实现该方法`preferredInterfaceOrientationForPresentation`。您的类别应如下所示：

```
#import "UINavigationController+Rotation_IOS6.h"

@implementation UINavigationController (Rotation_IOS6)

-(BOOL)shouldAutorotate
{
    return [[self.viewControllers lastObject] shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
}

@end 
```

3 - 在您只想横向旋转的类中，将其包含在实现中，就像这样：

```
// Rotation methods for iOS 6
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

4 - 我建议在你想要的横向类中也包括 iOS 5 的自动旋转方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return UIInterfaceOrientationLandscapeLeft | UIInterfaceOrientationLandscapeRight;
} 
```

# xml - 如何连接到在纯 xml 中使用 Windows 身份验证的 WCF SOAP Web 服务？

> ID：14633218
> 
> 赞同：0
> 
> 时间：2013-01-31T19:04:56.263
> 
> 标签：xml, wcf, soap, windows-authentication

我正在尝试连接到使用 wsHttpBinding 和 Windows 身份验证的 Web 服务。如果我配置了用户名、密码和域，我可以使用 WCFStorm 进行连接。

我需要在 SOAP 信封上进行身份验证，因为我无法访问诸如 c# 之类的编程语言。

基本上，我能做的就是发出一个包含 SOAP 信封的 POST 请求。如何构造 SOAP 信封以便 Windows 身份验证起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T16:15:34.177

如果您确实需要使用 SOAP POST 进行身份验证，则完全有可能。但是您需要在 WCF 中实现 ServiceAuthorizationManager 类并将其与用于承载端点的给定 ServiceHostFactory 相关联。

但是，我将假设 WCF 服务对您来说是一个黑盒子，因为您说您“无法访问诸如 c# [原文如此] 之类的编程语言”。我会假设 .net 框架方面是你无法控制的。

我将假设您可以完全访问客户端，但不能使用 .net 进行远程调用。

您要做的是将 Kerberos 或 NTLM 身份验证标头放入您的 HTTP 请求中。通常被称为 Windows 身份验证的东西实际上是这两种协议之一。现在 NTLM 在配置方面是一个更简单的协议，如果您的编程环境支持它，它将是我建议的协议。然而，Kerberos 得到了更广泛的支持。

至于如何在您正在使用的框架中使用带有 HTTP 的 NTLM/Kerberos。没有更多信息，我帮不了你。

您可能会发现以下有趣的内容：http: [//docs.oracle.com/javase/6/docs/technotes/guides/net/http-auth.html](http://docs.oracle.com/javase/6/docs/technotes/guides/net/http-auth.html)

# makefile - autotools：makefile 之间的共享数据

> ID：14633219
> 
> 赞同：0
> 
> 时间：2013-01-31T19:04:55.477
> 
> 标签：makefile, autotools

这是我的项目树结构：

srcdir/Makefile_parent.make
srcdir/src/Makefile_src.make
srcdir/data/Makefile_data.make
srcdir/other/Makefile_other.make

我的问题是如何从我的“Makefile_parent.make”传递一个在子 makefile 中可读的值。我有：

# Makefile_parent.make

```
ParentData = foo
SUBDIRS = src data other 
```

后来，我想从其他 makefile 中读取它，例如：

# Makefile_src.make

```
GetParentData = $(ParentData) 
```

但是不工作总是空的..有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:32:09.050

在您的 Makefile_src.make 中，您需要在文件顶部添加这一行：

```
include Makefile_parent.make 
```

那么就会出现多次包含同一个makefile的问题。一个解决方案（类似于头文件中的#ifndef ;)）

```
ifndef MAKEFILE_PARENT_MAKE
MAKEFILE_PARENT_MAKE := 1

...
...
...
...

endif 
```

您需要为您认为可能包含的每个 makefile 执行此操作，并为每个文件使用不同的变量名。

# windows - Windows + Cygwin + Single Line If Else + Puppet

> ID：14633221
> 
> 赞同：2
> 
> 时间：2013-01-31T19:05:14.250
> 
> 标签：windows, git, bash, cygwin, puppet

所以我有一个单行 bash 命令来检查目录是否存在。如果是，它会 git pull，如果不是，它会克隆存储库。我在我的 Windows 机器上运行 Cygwin，当我在 Cygwin 中运行此命令时，它运行良好：

```
if [ -d C:/repo ]; then cd C:/repo && "C:/Program Files (x86)/Git/bin/git.exe" pull; else "C:/Program Files (x86)/Git/bin/git.exe" clone -b develop https://repo.git C:/repo; fi 
```

当我像这样从 Puppet 运行相同的命令时：

```
exec {'checkout repository':
    command => "if [ -d C:/repo ]; then cd C:/repo && "C:/Program Files (x86)/Git/bin/git.exe" pull; else "C:/Program Files (x86)/Git/bin/git.exe" clone -b develop https://repo.git C:/repo; fi"
} 
```

我得到错误：

> 错误：'如果 [ -d C:/repo ]; 然后 cd C:/repo && "C:/Program Files (x86)/Git/bin/git.exe" pull; else "C:/Program Files (x86)/Git/bin/git.exe" clone -b develop [https://repo.git](https://repo.git) C:/repo; fi' 不合格且未指定路径。请限定命令或指定路径。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:12:59.760

Puppet 是一个原生的 Windows 程序（它可以在没有 cygwin 的情况下工作）。您在 command -parameter 中编写的内容基本上是一个简短的 sh(1) 脚本。Windows 默认没有 sh(1)，尽管它是由 cygwin 提供的。所以 windows 上的 puppet 不会尝试通过 sh(1) 执行命令的内容。它应该是 Windows 可执行文件的（绝对）名称，带有可选参数。如果您希望调用 cmd.exe 内置，您需要执行类似`command => 'cmd /c dir'`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-05T06:40:21.053

转义引号或使用单引号并使用 cygdrive，因此您的代码应如下所示：

```
exec {'checkout repository':
    command => "if [ -d C:/repo ]; then cd C:/repo && 'C:/Program Files (x86)/Git/bin/git.exe' pull; else 'C:/Program Files (x86)/Git/bin/git.exe' clone -b develop https://repo.git C:/repo; fi"
} 
```

和这个：

```
exec {'checkout repository':
    command => "if [ -d /cygdrive/c/repo ]; then cd /cygdrive/c/repo && '/cygdrive/c/Program Files (x86)/Git/bin/git.exe' pull; else '/cygdrive/c/Program Files (x86)/Git/bin/git.exe' clone -b develop https://repo.git /cygdrive/c/repo; fi"
} 
```

如果你甚至在 cygwin 中安装 git，你可以让它变得更简单：

```
exec {'checkout repository':
    command => "if [ -d /cygdrive/c/repo ]; then cd /cygdrive/c/repo && git pull; else git clone -b develop https://repo.git /cygdrive/c/repo; fi"
} 
```

# css - 带有浮动元素的 CSS 自动换行

> ID：14633224
> 
> 赞同：6
> 
> 时间：2013-01-31T19:05:19.933
> 
> 标签：css, twitter-bootstrap

我有一个固定宽度的侧边栏，由一个引导程序组成，`nav-list`其中一些列表元素具有右对齐的标签。

例如：

```
<li>
  <a href="#">abc_test_randomrandom</a>
  <span class="pull-right label">0000</span>
</li> 
```

但是，如果链接很长，这将不起作用。它扩展以填充整行，并将标签推送到下一行。

我已经建立了一个[jsFiddle 演示](http://jsfiddle.net/rouge8/gw54T/)来演示这种行为。**编辑：**现在也是一个[要点](https://gist.github.com/4685571)。

所需的行为是`abc_test_randomrandom`和`0000`在同一行上，如果需要，长字符串会换行到下一行。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:09:36.893

是的。使用固定宽度并`overflow: hidden;`用`text-ellipsis`.

```
li a {width: 60%; overflow: hidden; display: inline-block; text-overflow: ellipsis; white-space: nowrap;}
li span {width: 40%; display: inline-block;} 
```

我无法打开 jsFiddle。所以无法看到确切的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:12:23.777

在 Bootstrap 中，右拉实际上只是 CSS 浮动的包装器。您需要将 0000 跨度放在标记中的 abc_test_randomrandom 之前，它应该根据需要将锚点包裹到两行，因此您的浮动元素位于它浮动的元素之前。您可能需要将锚的右边距设置为浮动元素的宽度。我现在无法加载 jsFiddle，否则我会给你一个更好的例子。我会尝试回来检查。

编辑：我能够让你的 jsFiddle 加载。

如果您将跨度移动到 HTML 中的锚点之前并添加此 CSS，则此方法有效。如果您的文本实际上将有下划线而不是空格，那么您将需要您在自己的答案中提到的自动换行 CSS。

这样做的好处是它不需要 CSS hack（即用于显示：inline-block）在旧版本的 IE 中工作，如果这对您的项目来说是一个问题的话。

```
.nav-list a { display: block; margin-right: 30px; } 
```

![更新的 jsFiddle 的屏幕截图](../Images/74c2091788368db24842ecc163fb01e6.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T19:42:51.977

我认为[Praveen 的解决方案](https://stackoverflow.com/a/14633282/609144)实际上是一个更好的实现，但要获得最初请求的行为`display: inline-block`，`word-wrap: break-word`并对其进行`width`修复。

```
li a {width: 70%; display: inline-block; word-wrap: break-word;} 
```

![自动换行](../Images/4f99fe1c2e37c38762cd604a0b4681e3.png)

# scala - Scala自类型注释与'with'混合

> ID：14633231
> 
> 赞同：2
> 
> 时间：2013-01-31T19:05:47.760
> 
> 标签：scala, traits, self-type

> **可能重复：**
> [scala 自类型和特征子类之间有什么区别？](https://stackoverflow.com/questions/1990948/what-is-the-difference-between-scala-self-types-and-trait-subclasses)

我无法区分以下两个代码块：

```
 // Trait B is mixed in and creates a dependency on it
    trait A extends C with B { 
       ...
    }

    // Trait B is put in scope and also creates a dependency on it
    trait A extends C {
       self: B =>
    ...
    } 
```

我是从设计的角度来问的。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:21:34.183

当您使用 self 类型时，您将 限制为`trait`仅在指定的 self 类型满足与它混合的其他类型时使用。您没有得到`trait`被定义和声明的自我类型之间的继承关系。这意味着 trait 本身作为一个孤立的静态类型，不能单独公开替代 self 类型。（它被比作 C++ 私有继承，但这是一个弱的类比）。

# wpf - 使用 RX 降低鼠标移动事件的频率

> ID：14633233
> 
> 赞同：2
> 
> 时间：2013-01-31T19:05:54.327
> 
> 标签：wpf, events, mouse, system.reactive

我是 RX 的新手，但我觉得它应该能够为我希望解决的任务提供一个很好的解决方案。经过相当多的搜索，我仍然没有找到解决方案。

我有一个 WPF 应用程序，其中一个控件执行一些工作以响应某些鼠标移动事件。我想降低事件的频率，以便处理程序的调用频率低于当前情况（因为用户在控件上移动鼠标）。理想情况下，我想要的是设置并订阅观察者。观察者应该观察鼠标移动事件，并在特定时间窗口过去后使用最近的事件和参数调用客户端代码，比如 0.2 秒。作为 RX 的新手，我首先用观察者替换了我原来的标准事件连接，如下所示：

```
var mouseMove = Observable.FromEventPattern<MouseEventArgs>(myControl, "MouseMove");

mouseMove.Subscribe(args => myControl_MouseMove(args.Sender, args.EventArgs)); 
```

这似乎工作正常。

然后我尝试修改观察者以获得我上面描述的行为。我尝试使用 Throttle() 调用和 Sample() 调用。这些并没有产生我预期（或渴望）的结果。事实上，在某些情况下，使用 Throttle/TimeSpan 调用的特定重载会导致我的应用程序死机，我仍然不明白。

这是我尝试过的一个例子：

```
var mouseMove = Observable.FromEventPattern<MouseEventArgs>(myControl, "MouseMove").Throttle(TimeSpan.FromSeconds(0.2));

mouseMove.Subscribe(args => myControl_MouseMove(args.Sender, args.EventArgs)); 
```

从阅读中，Throttle 似乎会吞下事件，直到频率降至特定阈值以下（与我预期的不太一样），而我相信 Sample 会定期对观察到的事件进行采样？我希望在给定的时间间隔内为客户端代码提供最新的事件。如果在该时间间隔内没有记录任何事件，则不应调用客户端。

希望有人可以帮助 RX 新手。

哦，我还想在控件的生命周期内随时了解（降低的频率）鼠标移动。

最大限度

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T20:03:54.600

我认为你在正确的轨道上`Sample`- 具体来说，这对你没有什么作用？

示例 LINQPad 片段：

```
void Main()
{
    var window = new Window();
    window.Content = ctrl;
    window.Show();
    var mouseMove = Observable
        .FromEventPattern<MouseEventArgs>(window, "MouseMove")
        .Sample(TimeSpan.FromSeconds(0.2));
    var disp = mouseMove.Subscribe(args => myControl_MouseMove(args.Sender, args.EventArgs));     
    window.Closed += (o,e) => disp.Dispose();
}

ItemsControl ctrl = new ItemsControl();

// Define other methods and classes here
private void myControl_MouseMove(object sender, MouseEventArgs args)
{
    ctrl.Dispatcher.BeginInvoke((Action)(() => {ctrl.Items.Add(args.GetPosition(ctrl));}));
} 
```

# playframework-2.0 - Play 2.0 框架：仅根据当前视图加载某些 javascript 文件

> ID：14633234
> 
> 赞同：2
> 
> 时间：2013-01-31T19:06:01.893
> 
> 标签：playframework-2.0

假设我有以下视图文件：dashboard.scala.html、index.scala.html、main.scala.html 和 user.scala.html。以及以下 javascript 文件：dashboard.js、user.js 和 main.js

有没有办法在加载 user.scala.html 视图时只加载 user.js 文件，dashboard.js 文件只加载到 dashboard.scala.html 视图上，而不加载到其他视图页面上？目前，我所有的视图文件都通过 main.scala.html 文件运行，该文件包含我所有的 css 和 javascript。

我在想我需要一种方法将当前视图名称传递给 main.scala.html 文件，然后在脚本 src 属性中附加视图名称，或者有没有办法通过路由文件来做到这一点？我也在为这个应用程序使用 Java API。

```
<script src="@routes.Assets.at("javascripts/vendor/jquery.min.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/main.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/" + viewName + ".js")" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:32:59.653

在 Play 1.x 中，有两个[特殊标签](https://stackoverflow.com/a/5392833/1066240)用于包含从视图到包装布局的附加脚本和样式：`moreScripts`并且`moreStyles`，无论如何它们不再存在......

幸运的是，您可以在 Play 2 中手动执行相同的操作，最好它们不再固定，您可以根据需要创建尽可能多的此类块。

检查[模板的文档](http://www.playframework.org/documentation/2.0.4/JavaTemplateUseCases)，搜索**“moreScripts and moreStyles equivalents”**部分。

另一方面，有时更容易为给定视图按所需顺序准备带有脚本和样式的单独“布局”。

# c# - 安装 .net 框架 v4.30319

> ID：14633238
> 
> 赞同：2
> 
> 时间：2013-01-31T19:06:27.477
> 
> 标签：c#, asp.net

我想为 Web 服务安装 .net framework v4.30319。在 cmd 中运行此命令时：

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet.reggis.exe -i 
```

它产生了行政权利问题。但我已经使用管理员帐户登录。如何解决行政问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:08:12.170

右键单击cmd，然后单击“以管理员身份运行”

通常情况下，Windows 默认不会以管理员身份打开程序，即使您的帐户具有管理员类型也是如此。在 a 的属性中`.exe`，您可以设置为始终以管理员身份运行。

# .net - WebDispatchFormatter 忽略“接受”HTTP 标头

> ID：14633240
> 
> 赞同：0
> 
> 时间：2013-01-31T19:06:29.033
> 
> 标签：.net, wcf, rest, .net-4.0

我在 VS2010，.NET 4 中有一个 WCF 项目。我正在使用 WcfRestContrib 来支持我的服务调用的多个无缝格式化程序。这是行不通的。我能够提交带有 JSON 有效负载的查询，但我无法让它在响应中自动返回 JSON 数据。我正在使用“Accepts”HTTP 标头并将其设置为“application/json”——就像我在下面的配置中映射了 mime 类型一样。

我可以让 JSON 在响应中返回的唯一方法是将`system.serviceModel/behaviors/serviceeBehaviors/behavior[@name='REST']/webFormatter/formatters/@defaultMimeType`属性设置为“application/json”。这证明 WebDispatchFormatter 肯定参与了输出，它只是没有使用 Accept HTTP 标头来确定使用哪个格式化程序。

**如何让 WebDispatchFormatter 查看 Accept HTTP 标头？**我的印象是这是默认行为。

我已将服务配置为在我的 Web.config 文件中使用 WcfRestContrib 的 WebDispatchFormatter，如下所示：

```
<system.serviceModel>
    <extensions>
        <behaviorExtensions>
            <add name="webFormatter" type="WcfRestContrib.ServiceModel.Configuration.WebDispatchFormatter.ConfigurationBehaviorElement, WcfRestContrib" />
        </behaviorExtensions>
    </extensions>

    <bindings>
        <webHttpBinding>
            <binding name="REST"/>
        </webHttpBinding>
    </bindings>

    <behaviors>
        <endpointBehaviors>
            <behavior name="REST">
                <webHttp automaticFormatSelectionEnabled="true" defaultOutgoingResponseFormat="Xml"/> <!-- Note: I also tried it with automaticFormatSelectionEnabled set to "false". -->
            </behavior>
        </endpointBehaviors>

        <serviceBehaviors>
            <behavior name="REST">
                <webFormatter>
                    <formatters defaultMimeType="application/xml">
                        <formatter mimeTypes="application/xml,text/xml" type="WcfRestContrib.ServiceModel.Dispatcher.Formatters.PoxDataContract, WcfRestContrib" />
                        <formatter mimeTypes="application/json" type="WcfRestContrib.ServiceModel.Dispatcher.Formatters.DataContractJson, WcfRestContrib" />
                        <formatter mimeTypes="application/x-www-form-urlencoded" type="WcfRestContrib.ServiceModel.Dispatcher.Formatters.FormUrlEncoded, WcfRestContrib" />
                    </formatters>
                </webFormatter>
                <serviceDebug includeExceptionDetailInFaults="True"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>

    <services>
        <service name="MyService.REST" behaviorConfiguration="REST">
            <endpoint name="REST" contract="MyService.IREST" bindingConfiguration="REST" behaviorConfiguration="REST" binding="webHttpBinding" />
        </service>
    </services>

    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

我的服务接口/合同看起来像这样。

```
namespace MyService
{
    [ServiceContract]
    public partial interface IREST
    {
        [OperationContract]
        [WebInvoke(Method="POST")]
        [WebDispatchFormatter(WcfRestContrib.ServiceModel.Dispatcher.WebDispatchFormatter.FormatterDirection.Outgoing)]
        List<MyData> GetData(SearchQuery searchQuery);
    }
} 
```

我的服务实现如下所示：

```
namespace MyService
{
    [AspNetCompatibilityRequirements(RequirementsMode=AspNetCompatibilityRequirementsMode.Allowed)]
    public partial class REST : IREST
    {
        public List<MyData> GetData(SearchQuery searchQuery)
        {
            return GetTheData(searchQuery);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T18:46:13.940

原来我使用`Accepts`而不是`Accept`作为 HTTP 标头键！哎呀！

# c# - 如何使确认链接激活 MVC4 中的帐户？

> ID：14633241
> 
> 赞同：4
> 
> 时间：2013-01-31T19:06:33.010
> 
> 标签：c#, asp.net-mvc-4, ef-code-first, security, email-confirmation

我正在构建一个从默认 Internet 应用程序开始的 MVC 4 应用程序。我的目标是在用户注册网站时向他们发送一封确认电子邮件，我已经成功发送了确认电子邮件，但是当我点击它时，帐户没有得到确认。

**注意：我知道注册操作很拥挤，当我让它工作时，我会将其分成不同的文件。**

****这就是我所做的：* ***

**注册动作**

```
[HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            try //CreateUserAndAccount
            {
                var token = WebSecurity.CreateUserAndAccount(model.UserName, model.Password, null, true);
                if (token != null)
                {
                    var hosturl =
                        System.Web.HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority) +
                        "/Account/ConfirmAccount?token=" + token;

                    var confirmationLink = string.Format("<a href=\"{0}\">Clink to confirm your registration</a>",
                                                         hosturl);

                    var message = new MailMessage("komengem@gmail.com", model.UserName)
                    {
                        Subject = "Please confirm your email",
                        Body = confirmationLink
                    };

                    var client = new SmtpClient();
                    client.EnableSsl = true;
                    client.Send(message);
                }

                TempData["message"] = string.Format(
                    "Thank you for registering. An email has been sent to {0}. " +
                    "Please check your email and use the enclosed link to finish registration.", model.UserName);
                return RedirectToAction("Index", "Home");
            }
            catch (MembershipCreateUserException e)
            {
                ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
            }
        } 
```

**ConfirmAcount 操作**

```
public ActionResult ConfirmAccount(string ID)
    {
        //return View("ConfirmAccount");
        var confirmationToken = Request["token"];
        if (!String.IsNullOrEmpty(confirmationToken))
        {
            var user = WebSecurity.CurrentUserName;
            WebSecurity.ConfirmAccount(confirmationToken);
            WebSecurity.Login(user, null);
            return View("Welcome");
        }

        TempData["message"] = string.Format(
                    "Your account was not confirmed, please try again or contact the website adminstrator.");
        return RedirectToAction("Index", "Home");            
    } 
```

**也试过**

```
public ActionResult ConfirmAccount(string ID)
    {
        if (string.IsNullOrEmpty(ID) || (!Regex.IsMatch(ID,
                        @"[0-9a-f]{8}\-([0-9a-f]{4}\-){3}[0-9a-f]{12}")))
        {
            TempData["tempMessage"] =
                "The user account is not valid. Please try clicking the link in your email again.";
            return View();
        }
        MembershipUser user = Membership.GetUser(new Guid(ID));

        if (!user.IsApproved)
        {
            user.IsApproved = true;
            Membership.UpdateUser(user);
            FormsAuthentication.SetAuthCookie(user.UserName, false);
            return RedirectToAction("Login");
        }
        WebSecurity.Logout();
        TempData["tempMessage"] = "You have already confirmed your email address... please log in.";
        return RedirectToAction("Login");
    } 
```

谁能告诉我如何使这项工作，或者也许建议一种不同的方式来使这项工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T08:13:20.880

我鼓励您使用 Postal，这是一个简单易用的电子邮件创建包。它以 nuget 包的形式提供。

还可以看看 Kevin Junghans 关于这个主题的博文！[邮件确认](http://kevin-junghans.blogspot.se/2013/02/adding-email-confirmation-to.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T13:07:18.247

我已经完成了以下操作并且正在运行：

在寄存器中创建令牌：

```
string confirmationToken =
                        WebSecurity.CreateUserAndAccount(model.UserName, model.Password, new { Email = model.Email }, true); 
```

然后在确认中使用了以下内容：

```
public ActionResult RegisterConfirmation(string Id)
        {
            if (WebSecurity.ConfirmAccount(Id))
            {
                return RedirectToAction("ConfirmationSuccess");
            }
            return RedirectToAction("ConfirmationFailure");
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T00:20:15.400

来自您的编辑的错误消息听起来像您的本地计算机既没有在端口上`25`也没有在`587`. 我认为您应该在对代码执行任何操作之前检查 SMTP 服务器是否已配置并运行。

您只需在此本地服务器上创建 2 个帐户并在任何电子邮件客户端中设置它们，然后检查您是否能够在它们之间发送电子邮件。第二种选择是使用 telnet 检查连接，但我没有尝试过 - [http://www.petri.co.il/test_smtp_service.htm](http://www.petri.co.il/test_smtp_service.htm)

如果在您的应用程序之外使用邮件服务器成功并且您仍然有错误，请确保您的`WebMail.UserName`和`WebMail.Password`是正确的。如果是，请尝试设置`WebMail.From`为您在`WebMail`配置中使用的本地测试电子邮件地址之一，例如`test@localhost`或`test@127.0.0.1`（有时我不得不使用 IP 来通过电子邮件验证）。

# ios - 在雪豹上运行 iOS 模拟器

> ID：14633246
> 
> 赞同：2
> 
> 时间：2013-01-31T19:06:55.920
> 
> 标签：ios, xcode

我目前正在运行 Snow Leopard，并且安装了 Xcode 3.2.6。我希望能够运行 iOS 模拟器，最好是 5.x 系列，但我真的会满足于任何东西。我怎么做？我发现了这个问题：[Is it possible to get the iOS 5.1 SDK for Xcode 4.2 on Snow Leopard?](https://stackoverflow.com/questions/9613565/is-it-possible-to-get-the-ios-5-1-sdk-for-xcode-4-2-on-snow-leopard) 但这需要 Xcode 4.2，我似乎无法为 Snow Leopard 找到它。

我什至不打算在 Xcode 上进行任何应用程序开发——这主要是为了测试浏览器的东西——所以如果有一种方法可以在没有 Xcode 的情况下运行模拟器，那也很好。我还有一个物理 iPad，以防万一。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T01:34:40.040

这是 Snow Leopard 的整个捆绑包的链接，包括模拟器（不是 5 个）： http: [//developer.apple.com/downloads/index.action ?name=Xcode%203.2.6](http://developer.apple.com/downloads/index.action?name=Xcode%203.2.6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T20:36:04.747

您必须更新操作系统才能安装最新的模拟器。它不适用于雪豹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:11:27.107

更新到 OS/X Mountain Lion，您就可以安装 XCode 4.X 并运行 iOS 5 和 6 模拟器

# facebook - Facebook 应用用户信息

> ID：14633248
> 
> 赞同：0
> 
> 时间：2013-01-31T19:06:58.767
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-fql

我有一个 Facebook 画布应用程序。用户授权应用程序后，我将存储 facebook 用户名。

我想收集有关用户的更多信息。我阅读了以下帖子。

[使用 FQL 获取使用特定应用程序的 facebook 用户列表](https://stackoverflow.com/questions/9081147/get-list-of-facebook-users-who-are-using-specific-application-using-fql)

[Facebook Canvas 应用程序 - 查找所有已安装该应用程序的用户](https://stackoverflow.com/questions/5965763/facebook-canvas-app-finding-all-users-who-have-installed-the-app)

[如何获取使用 Facebook 应用程序的用户的所有用户 ID](https://stackoverflow.com/questions/4776881/how-to-get-all-the-user-ids-of-people-who-are-using-your-facebook-application/4777544#4777544)

一旦我存储了用户名，如果我想要更多信息，我该如何获取它。像电子邮件、位置等（假设应用程序具有扩展权限）。拥有用户名和应用程序访问令牌后，我可以随时获得这些吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:18:54.987

只要您拥有该用户的`username`或`id`有效`access_token`的对该用户具有所需权限，您就可以随时查询此信息。

您应该同时存储 the`username`和 the`access_token`以使其工作。

请记住，其中一些信息无需`access_token`. 另一方面，用户可以限制他们的隐私设置，以便您的应用程序看不到其中一些项目。

# c# - 输入字符串的格式不正确 - GUID 错误？

> ID：14633250
> 
> 赞同：0
> 
> 时间：2013-01-31T19:07:18.257
> 
> 标签：c#, asp.net, guid

我正在使用 ASP.NET (C#)，并且我有将新行插入数据库的代码。当我运行它时，我收到错误“输入字符串的格式不正确”。

我想我已经将这个错误缩小到用户 GUID 唯一标识符，它需要传递到插入语句中。（从 asp:login 创建）

我知道我可以通过 using 调用此 UserID，`Membership.GetUser(User.Identity.Name).ProviderUserKey.ToString()` 但随后我需要使用转换回 Guid`new Guid(string)`

这似乎对我不起作用。这是我的代码隐藏：你能发现任何错误吗？

```
public partial class LoggedIn_CreateDoc : System.Web.UI.Page
{
    SqlConnection sqlConn;
    SqlDataAdapter sqlDA;
    DataSet ds;
    String strConn = ConfigurationManager.ConnectionStrings["1722555Connection"].ConnectionString;

    protected void createDoc_Click(object sender, EventArgs e)
    {
        SqlConnection connection = new SqlConnection();

        connection.ConnectionString = ConfigurationManager.ConnectionStrings["1722555Connection"].ConnectionString;
        connection.Open();

        SqlCommand cmd = new SqlCommand();
        cmd.Connection = connection;
        cmd.CommandTimeout = 0;

        string commandText = "INSERT INTO Documents (Name, Description, RcdID, Location, AccessLevel, DateCreated, AuthorID, DocStatus, EngStatus, QaStatus, DesignStatus) VALUES(@Name, @Description, @RCD, @Location 1, @Date, @AuthorID, 1, 1, 4, 4)";
        cmd.CommandText = commandText;
        cmd.CommandType = CommandType.Text;

        cmd.Parameters.Add("@Name", SqlDbType.VarChar, 50);
        cmd.Parameters.Add("@Description", SqlDbType.VarChar, 300);
        cmd.Parameters.Add("@RCD", SqlDbType.Int);
        cmd.Parameters.Add("@Location", SqlDbType.Int);
        cmd.Parameters.Add("@Date", SqlDbType.DateTime);
        cmd.Parameters.Add("@AuthorID", SqlDbType.UniqueIdentifier);

        cmd.Parameters["@Name"].Value = TextBoxDocTitle.Text;
        cmd.Parameters["@Description"].Value = TextBoxDocDescription.Text;
        cmd.Parameters["@RCD"].Value = ListBoxSeries.DataValueField;
        cmd.Parameters["@Location"].Value = ListBoxLocation.DataValueField;
        cmd.Parameters["@Date"].Value = DateTime.Now;
        cmd.Parameters["@AuthorID"].Value = new Guid(Membership.GetUser(User.Identity.Name).ProviderUserKey.ToString());

        cmd.ExecuteNonQuery();

        connection.Close();

        Response.Write(@"<script language='javascript'>alert('Your new document has been created. \n You can now find it in your Task Panel!');</script>");

        Response.Redirect("TaskPanel.aspx");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:28:01.210

我不认为问题出在你的`ProviderUserKey`. 演员表不会失败 - 插入会失败。

您需要将`RCD`and转换`Location`为 int 值吗？您当前正在尝试将字符串传递给 int 字段。

您应该使用`ListBox.SelectedValue`从这些字段中检索选定的值，之后您可以使用`Int32.TryParse`将它们转换为整数（或者`Int32.Parse`如果您希望在转换失败时抛出异常）。

`ListBox.DataValueField`不用于从 中检索所选值`ListBox`，而是告诉它应该将绑定数据源中的哪个字段视为其值，并且 - 因此 - 它是字段的*名称*，而不是其中的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:14:49.783

您应该检查为所有 cmd.Parameters 分配了哪些值，并确保这些值与数据库中列的数据类型和限制一致。

# android - 在 GP 上替换您的应用程序的最佳方法（丢失的密钥文件）

> ID：14633251
> 
> 赞同：0
> 
> 时间：2013-01-31T19:07:20.730
> 
> 标签：android, apk, google-play

一年前，我制作了一个 Android 应用程序并在 Google Play 上发布了它。现在我想更新它，但遗憾的是丢失了用于签署 apk 的密钥文件。

我知道我需要先从 GP 取消发布我的应用程序，更改包名称，然后上传使用新生成的密钥文件签名的更新后的 apk。这样我也会失去所有用户和评分。

我可以让这个过程不那么*痛苦*（意味着不会失去评级和/或用户）吗？

我也想知道这样我是否可以拥有相同的应用程序名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:11:17.633

你可以尝试用这个来恢复你的密钥。

[Android 密钥库密码恢复](http://code.google.com/p/android-keystore-password-recover/)

我希望你能恢复它。如果你不能，那么恐怕你将不得不忍受创建新包并在 Play 商店中上传婴儿应用程序的痛苦过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:12:15.930

删除旧应用并添加新应用。您无法以任何方式将旧应用程序连接到新应用程序。

不要立即删除旧的。更改要求用户移动到新应用程序的描述。

# mysql - 如何使用相同的复合键连接两个表，如果不在 T1 中，如何使用 MySQL 中的值

> ID：14633253
> 
> 赞同：1
> 
> 时间：2013-01-31T19:07:22.640
> 
> 标签：mysql, sql, join

我有两个具有相同列名和相同复合主键的表。两个表的复合主键是 id + year。我想始终使用表 T1 中的数据，如果表 T2 中存在 id + year，那不在表 T1 中，我希望它也被返回。

这是我的桌子

T1

```
id  |  year  |  cost
----+--------+-------
1   |  2012  |  1.01
2   |  2012  |  1.02
2   |  2013  |  1.03 
```

T2

```
id  |  year  |  cost
----+--------+-------
1   |  2012  |  2.01
2   |  2013  |  2.02
3   |  2013  |  2.03 
```

我想得到：

```
id  |  year  |  cost
----+--------+-------
1   |  2012  |  1.01
2   |  2013  |  1.02
2   |  2013  |  1.03
3   |  2013  |  2.03 
```

这显然是错误的，但我试过：

```
SELECT
  T1.id,
  T1.year,
  T1.cost
FROM employee_cost AS T1
  INNER JOIN (select
        employee_cost_historic.id,
        employee_cost_historic.year,
        employee_cost_historic.cost
          from employee_cost_historic) AS T2
    ON T1.id = T2.id
      AND T1.year = T2.year 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:28:14.953

或者使用 LEFT JOIN 和 IS NULL 的另一个选项：

```
SELECT T1.Id, T1.Year, T1.Code
FROM T1 
UNION
SELECT T2.Id, T2.Year, T2.Code
FROM T2
  LEFT JOIN T1 ON T1.Id = T2.Id AND T1.Year = T2.Year
WHERE T1.Id IS NULL 
```

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:23:24.223

您可以使用以下命令执行此操作`union all`：

```
select id, YEAR, cost
from t2
union all
select id, YEAR, cost
from t2
where not exists (select 1 from t1 where t1.id = t2.id and t1.year = t2.year) 
```

# gcc - 使 gcc -MM 输出对象文件名的相对路径

> ID：14633255
> 
> 赞同：4
> 
> 时间：2013-01-31T19:07:37.390
> 
> 标签：gcc, makefile

我正在使用**gcc**来生成我的 Makefile 的依赖项。但它不使用相对路径。例如，

```
gcc -MM util/test.c ui/resource.c 
```

生成

```
test.o: util/test.h
resource.o: ui/resource.h 
```

同时，为了让**make**找到依赖项，它会生成如下内容：

```
util/test.o: util/test.h
ui/resource.o: ui/resource.h 
```

有没有办法让 gcc 表现得像第二个例子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:15:30.610

从[`man gcc`](http://linux.die.net/man/1/gcc)

> **-MT** target
> 更改依赖生成发出的规则的目标。默认情况下，CPP 采用主输入文件的名称，删除任何目录组件和任何文件后缀，例如 .c，并附加平台的常用对象后缀。结果就是目标。
> 
> -MT 选项会将目标设置为您指定的字符串。如果需要多个目标，可以将它们指定为 -MT 的单个参数，或使用多个 -MT 选项。
> 
> 例如， -MT '$(objpfx)foo.o' 可能会给出
> 
> $(objpfx)foo.o: foo.c
> 
> **-MQ**目标
> 与 -MT 相同，但它引用任何对 Make 特殊的字符。-MQ '$(objpfx)foo.o' 给出
> 
> $$(objpfx)foo.o: foo.c
> 
> 默认目标是自动引用的，就好像它是用 -MQ 给出的。

因此，您可以使用例如

```
gcc -MM -MT util/test.o util/test.c
gcc -MM -MT ui/resource.o ui/resource.c 
```

*更新*：

如果您希望将所有依赖项放在一个文件中，则有多种可能性。

您可以`gcc -MM`按顺序执行并重定向输出

```
( gcc -MM -MT util/test.o util/test.c; gcc -MM -MT ui/resource.o ui/resource.c ) >file.deps 
```

您可以使用 sed 或 perl 对输出进行后处理

```
gcc -MM util/test.c ui/resource.c | perl -p -e 's,^(.+?)\.o: (.+?)/\1\.c.*,$2/$&,;' >file.deps 
```

您可以重定向第一个输出并将以下内容附加到某个文件

```
gcc -MM -MT util/test.o util/test.c >file.deps
gcc -MM -MT ui/resource.o ui/resource.c >>file.deps 
```

# javascript - Javascript - 图像数据处理和 div 渲染

> ID：14633256
> 
> 赞同：6
> 
> 时间：2013-01-31T19:07:41.177
> 
> 标签：javascript, jquery, canvas

所以我为自己创造的挑战就是这样。

我有一张源照片：

[![来源照片](../Images/2018c0216da7762ef1ee05f506260890.png)](https://i.stack.imgur.com/epPLw.jpg)

我正在映射颜色值并使用 div 创建它的像素化表示

结果如下：

[![结果照片](../Images/e38527eb683de812525d403d081647c2.png)](https://i.stack.imgur.com/Gs9aO.png)

我正在完成此操作的代码是：

```
'use strict';

var imageSource = 'images/unicorn.jpg';

var img = new Image();
img.src = imageSource;
var canvas = $('<canvas/>')[0];
canvas.width = img.width;
canvas.height = img.height;
canvas.getContext('2d').drawImage(img, 0, 0, img.width, img.height);
var context = canvas.getContext('2d');

console.log('img height: ' + img.height);
console.log('img width: ' + img.width);

var pixelDensity = 70;

var timerStart = new Date();

for (var i = pixelDensity/2; i < img.height; i += (img.height/pixelDensity) ) {
    $('.container').append($('<div class="row">'));
    for(var j = pixelDensity/2; j < img.width; j += img.height/pixelDensity) {
        var value = context.getImageData(j, i, 1, 1).data;
        var colorValue = 'rgb(' + value[0] + ', ' + value[1] + ', ' + value[2] + ')';
        $('.row:last').append($('<div class="block">').css({'background-color' : colorValue}));
    }
}

var timerStop = new Date();

console.log(timerStop - timerStart + ' ms'); 
```

pixelDensity 变量控制颜色样本的接近程度。数字越小，样本越少，产生结果所需的时间就越少。随着数量的增加，样本会增加，并且功能会大大减慢。

我很想知道是什么让这件事花费了这么长时间。我看过稍微相似的项目——最著名的是[Jscii——](https://github.com/EnotionZ/jscii)它们处理图像数据的速度要快得多，但我无法弄清楚提供额外性能的区别是什么。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:12:03.847

为什么不考虑在画布上绘制结果而不是创建这么多 div？理论上它应该更快...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:22:18.240

主要问题是您在循环中将 DOM 元素附加到页面。如果您在实际将其添加到页面之前使用所有数据创建包装器元素，这将运行得更快。

**编辑：** 我也注意到你要求`context.getImageData`每个像素，这是大部分时间。相反，您应该将图像数据缓存在变量中并从中获取颜色值。您还需要像@Travis J 提到的那样缓存循环条件并将它们四舍五入：

```
var wrapper = $('<div class="container">');
var imgData = context.getImageData(0, 0, img.width, img.height).data;
var getRGB = function(i) { return [imgData[i], imgData[i+1], imgData[i+2]]; };
var start = Math.round(pixelDensity/2),
    inc = Math.round(img.height/pixelDensity);

for (var i = start; i < img.height; i += inc) {
    var row = $('<div class="row">');
    for(var j = start; j < img.width; j += inc) {
        var colorValue = getRGB((i * (img.width*4)) + (j*4));
        row.append($('<div class="block">').css({'background-color' : 'rgb('+(colorValue.join(','))+')'}));
    }
    wrapper.append(row);
}

$('body').append(wrapper); 
```

这会将时间从 6-9 秒减少到 600-1000 毫秒。您还可以使用纯 javascript 来操作 DOM 元素而不是 jquery 以使其更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:15:41.250

我之前也遇到过类似的速度问题 - 之所以需要这么长时间是因为您通过以文本形式提供 HTML 来添加元素，这意味着它必须每次都解析该文本。如果您使用 JavaScript DOM 添加新元素，您会发现速度显着提高。

**编辑：**如果您不熟悉以这种方式创建新元素，语法如下所示：

```
var newPixel = document.createElement('div');
newPixel.style.height = 3;
newPixel.style.backgroundColor = 'black';
// etc...
parentElement.appendChild(newPixel); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:17:13.810

您可以通过减少 jquery 查找的数量来加快速度。例如，在您的第一个循环开始之前，请执行以下操作：

```
var $container = $('.container'); 
```

现在您不必每次都查找容器。

此外，当您创建一行时，使用相同的技巧来避免 'row:last' 查找：

```
var $row = $('<div class="row">');
$container.append($row);
...
$row.append($('<div class="block">')... 
```

# classloader - JBoss 7 - 从模块类加载器以编程方式加载 jars

> ID：14633260
> 
> 赞同：0
> 
> 时间：2013-01-31T19:07:56.230
> 
> 标签：classloader, jboss7.x, dynamic-class-loaders

我有一个已部署到 JBoss 7 的 WAR，它使用其上下文类加载器动态加载 jar 资源。

```
final ClassLoader cl = Thread.currentThread().getContextClassLoader();
propertiesUrls = cl.getResources(TRANSLATION_PROPERTIES); 
```

但是上下文类加载器只在 WEB-INF/lib 文件夹中查找资源

来自服务模块加载器的模块“deployment..war:main”的 ModuleClassLoader

如何在 jboss 中获取我拥有资源的特定模块的类加载器。我有需要在 JBOSS_HOME/modules/org/custom/... 中的自定义模块中加载的 jars

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-14T02:24:05.053

您需要使用当前的类加载器而不是 Thread 上下文类加载器。即 this.getClass().getClassLoader() 而不是 Thread.currentThread().getContextClassLoader()

# r - rcs 在 lm() 模型中生成错误的预测

> ID：14633262
> 
> 赞同：4
> 
> 时间：2013-01-31T19:08:03.297
> 
> 标签：r, linear-regression

我正在尝试复制[这篇关于过度拟合的博客文章](http://www.portfolioprobe.com/2011/03/28/the-devil-of-overfitting/)。我想探索样条与测试多项式的比较。

**我的问题：**使用来自 rms 包的 rcs() - 受限三次样条曲线 - 在常规 lm() 中应用时，我得到非常奇怪的预测。ols() 工作正常，但我对这种奇怪的行为有点惊讶。有人可以向我解释发生了什么吗？

```
library(rms)
p4 <- poly(1:100, degree=4)
true4 <- p4 %*% c(1,2,-6,9)
days <- 1:70

noise4 <- true4 + rnorm(100, sd=.5)
reg.n4.4 <- lm(noise4[1:70] ~ poly(days, 4))
reg.n4.4ns <- lm(noise4[1:70] ~ ns(days,5))
reg.n4.4rcs <- lm(noise4[1:70] ~ rcs(days,5))
dd <- datadist(noise4[1:70], days)
options("datadist" = "dd")
reg.n4.4rcs_ols <- ols(noise4[1:70] ~ rcs(days,5))

plot(1:100, noise4)
nd <- data.frame(days=1:100)
lines(1:100, predict(reg.n4.4, newdata=nd), col="orange", lwd=3)
lines(1:100, predict(reg.n4.4ns, newdata=nd), col="red", lwd=3)
lines(1:100, predict(reg.n4.4rcs, newdata=nd), col="darkblue", lwd=3)
lines(1:100, predict(reg.n4.4rcs_ols, newdata=nd), col="grey", lwd=3)

legend("top", fill=c("orange", "red", "darkblue", "grey"), 
       legend=c("Poly", "Natural splines", "RCS - lm", "RCS - ols")) 
```

如您所见，深蓝色到处都是……

![剧情](../Images/dd02bc9cafbe73a3293f2497d9a677f2.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-10-17T14:46:44.747

只要您指定结点，就可以将 rcs() 与非 rms 装配工一起使用。对于 ols 对象，predict 默认为 predict.ols，这很好，因为它“记住”了它在适合模型时放置结的位置。predict.lm 没有该功能，因此它使用新数据集的分布来确定节点的位置，而不是训练数据的分布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-19T07:21:09.187

使用`lm`with`rcs`是个坏主意，即使您在`rcs`. 这是一个例子：

假数据。

```
library(tidyverse)
library(rms)

set.seed(100)

xx <- rnorm(1000)
yy <- 10 + 5*xx - 0.5*xx^2 - 2*xx^3 + rnorm(1000, 0, 4)
df <- data.frame(x=xx, y=yy) 
```

设置要使用的环境`ols`。

```
ddist <- datadist(df)
options("datadist" = "ddist") 
```

适合`lm`模型和`ols`模型。

```
mod_ols <- ols(y ~ rcs(x, parms=c(min(x), -2, 0, 2, max(x))), data=df)

mod_lm <- lm(y ~ rcs(x, parms=c(min(x),-2, 0, 2, max(x))), data=df) 
```

创建一个测试数据集。

```
newdf <- data.frame(x=seq(-10, 10, 0.1)) 
```

比较评分后的模型预测`newdf`。

```
preds_ols <- predict(mod_ols, newdata=newdf)
preds_lm <- predict(mod_lm, newdata=newdf)

mean((preds_ols - preds_lm)^2)

as.numeric(coef(mod_ols))
as.numeric(coef(mod_lm))

compare_df <- newdf
compare_df$ols <- preds_ols
compare_df$lm <- preds_lm

compare_df <- compare_df %>% 
  gather(key="model", value="prediction", -x)

ggplot(compare_df, aes(x=x, y=prediction, group=model, linetype=model)) +
  geom_line() 
```

即使两个模型之间的系数相同，模型预测在新数据上也可能不同。

[![在此处输入图像描述](../Images/f537323e0146cd9d62b05e5ab02c69d4.png)](https://i.stack.imgur.com/cM0Uy.png)

**编辑：**

`max()`删除参数中对and`min()`的函数调用可以`parms`解决问题。

```
kKnots <- with(df, c(min(x), -2, 0, 2, max(x))) ## hard-code

mod_ols <- ols(y ~ rcs(x, parms=kKnots), data=df)

mod_lm <- lm(y ~ rcs(x, parms=kKnots), data=df) 
```

# jquery - Ajax 工具包的 AsyncFileUpload 控件正在触发 dom 就绪

> ID：14633264
> 
> 赞同：3
> 
> 时间：2013-01-31T19:08:08.213
> 
> 标签：jquery, asp.net, asyncfileupload

我在我的页面上使用asp.net ajax 工具包的异步文件上传控件来上传图片。它工作正常，但在上传时会触发 jquery dom 就绪功能，这是完全多余的，因为它在页面加载时触发一次，并且还会导致我的其他 jquery 插件中断。

任何想法为什么会发生这种情况？我很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T20:12:38.337

在没有提供 HTML/ASP 代码的情况下理解您的问题有点困难。但就我而言，Asnc 文件上传与 FileUpload 放在更新面板中一样好（虽然它不支持，这就是微软创建 asnc-file-upload 控件的原因）所以当它异步回发时，在 DOM 就绪时触发的事件将不适用于它。这里需要一个页面加载事件。我建议您尝试为 pageLoad 函数中的损坏元素编写 jquery 代码，如下所示

```
function pageLoad(sender,args){
   //write your code for broken elements here or simply copy paste everything from  $(document).ready in this function
} 
```

如果上述方法不起作用，您还可以像这样告诉浏览器在 ajax 调用完成后执行操作

```
$( document ).ajaxStop( function() {
    //Do the needful here
}); 
```

希望能帮助到你...

# sql-server - SQL Server Nvarchar（最大值）

> ID：14633265
> 
> 赞同：0
> 
> 时间：2013-01-31T19:08:12.003
> 
> 标签：sql-server

我有一个插入语句，其中一列的列类型为 nvarchar(max) desc。我注意到，当我查看数据库中的某些记录时，desc 列有时是空白的。由于通过我的 GUI 进行了验证，我知道这是不可能的。经过进一步测试，我发现如果该列的文本太大，它就不会插入该数据。我发现这种奇怪的 b/c 我认为它会给我一些错误或不完全插入记录，但它只是将该列留空。nvarchar(max) 是否有限制，如果有的话，我可以使用其他数据类型来代替它。我做了一个测试，我尝试插入的字符超过 20,000 个，但它因最终用户输入而异。

' ***** ** *** ** *** ** *** ** *** ****编辑****** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *****

感谢大家的快速回复，通过研究我发现你们是正确的，它会保存（保存）这么多信息。我发现，当使用 Microsoft Management Studio 时，如果当您的结果返回时，如果您查询的列的大小有很多字符，它就会显示为空白。为了验证这一点，我使用了 len(COLUMN_NAME) 函数并看到字符长度符合我的预期。有谁知道我可以更改 Microsoft Management Studio 中的设置以实际看到结果的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:13:19.050

NVARCHAR(MAX) 有一个限制 - 它是 2^31-1 字节 (2GB)。您可以[在 Books Online](http://msdn.microsoft.com/en-us/library/ms186939.aspx)上阅读更多相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:12:43.953

请参考此[链接](https://stackoverflow.com/questions/12097670/how-to-store-a-string-var-greater-than-varcharmax)

引用：

> 说真的 - VARCHAR(MAX) 最多可以存储 2 GB 的数据 - 而不仅仅是 8000 个字符.....
> 
> 关键是：如果您使用 varchar(max)，则需要确保始终将所有 >strings 显式转换为 varchar(max) - 就像我在本示例中所做的那样。否则，SQL Server 将 > 回退到“常规”varchar 处理，并且确实限制为 8000 个字符......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:12:10.540

检查以下可能有很大帮助的链接。

默认大小为 4000，最大大小为 2GB：

[http://social.msdn.microsoft.com/Forums/en-US/databasedesign/thread/d5e0c6e5-8e44-4ad5-9591-20dc0ac7a870/](http://social.msdn.microsoft.com/Forums/en-US/databasedesign/thread/d5e0c6e5-8e44-4ad5-9591-20dc0ac7a870/)

[nvarchar(MAX) 可以容纳的最大字符数是多少？](https://stackoverflow.com/questions/4270049/what-is-the-maximum-number-of-characters-that-nvarcharmax-will-hold)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:14:05.870

`varchar(max)`持有 20,000 个字符应该没有问题，所以我认为这可能与其他事情有关。

我不确定您的 GUI 使用的是什么技术，但这个线程似乎在讨论类似的问题，您使用的提供程序不支持`varchar(max)`并且可能需要更新。

[nvarchar(max) 字段和经典 ASP 的奇怪问题](https://stackoverflow.com/questions/3112093/strange-problem-with-nvarcharmax-fields-and-classic-asp)

这可能不是 SQL Server 的问题，而是您用来与 SQL Server 通信的技术。

您能否指定您使用什么技术与 SQL Server 通信（ASP、ASP.NET、版本？）以及您使用的 SQL Server 版本。

# python - 有没有一种安全的方法可以从 python 中的线程创建子进程？

> ID：14633269
> 
> 赞同：1
> 
> 时间：2013-01-31T19:08:20.780
> 
> 标签：python, multithreading

我正在处理一些现有的代码，这些代码创建了许多不同的工作线程，然后这些工作线程又用子进程/多处理调用一些 shell 脚本。从我所见，这是一个禁忌，因为互斥锁可能会在 exec() 发生之前嵌入子进程的解释器中。这是一个有效的担忧吗？如果是这样，是否有某种 python 原语“做正确的事情”并执行一个 fork/exec 而不会在中间玩任何不安全的东西？

谢谢

# php - 来自 CodeIgniter 的 SQLite INSERT 中的重复条目

> ID：14633272
> 
> 赞同：0
> 
> 时间：2013-01-31T19:08:32.543
> 
> 标签：php, sqlite, codeigniter, duplicates

当我在 sqlite 数据库上从 codeigniter (PHP) 运行此查询时，我得到重复的插入：

```
INSERT INTO `users` 
SELECT 'test@email.com' AS `email`,
'12345' AS `password` 
```

当我从 SQLite Manager 运行它时，它只添加一个条目。但是，当我在 PHP 代码中用这个替换上面的查询时：

```
INSERT INTO `users`
(`email`,`password`) 
VALUES ('test@email.com', '12345') 
```

它只添加一次条目（其他一切都相同）。我也检查过，脚本只被调用一次。

有人知道为什么会这样吗？我知道可以通过将电子邮件字段设置为主键来修复它，然后不会插入重复项，但这不是一个选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:01:19.887

正确的 SQL 语法是最后一个！

为什么不使用 CodeIgniter 的 Active Record 功能？

```
$data = array('email' => $email, 'password' => $password);
$this->db->insert('users', $data); 
```

# objective-c - 在使用 MagicalRecord CocoaPod 初始化 +initialize 时，Objective-C 无法识别的选择器

> ID：14633274
> 
> 赞同：3
> 
> 时间：2013-01-31T19:08:48.033
> 
> 标签：objective-c, cocoa, magicalrecord, cocoapods

~~**注意：**请参阅问题底部的更新，我已经设法在调试方面做得更进一步。~~

我认为这是我的项目设置的一个问题，但我不确定要查看什么，因为没有编译错误。

我在项目中包含了 MagicalRecord 2.1（当前稳定），并由 CocoaPods 管理它。我没有更改 CocoaPods 的任何构建设置，它完美地管理了我的其他依赖项，到目前为止我还没有遇到任何问题。

我已添加`#import <MagicalRecord/CoreData+MagicalRecord.h>`到我的`App-Prefix.pch`文件中，Xcode 为我提供了正确设置所期望的所有符号建议。我没有收到任何编译器错误，所以我只能假设 CocoaPods 已成功将 MR 构建到库中，并且我已成功将其导入到我的代码中。

当我在我的应用程序委托中初始化 MagicalRecord 时出现问题：

```
- (void)applicationDidFinishLaunching:(NSNotification *)notification {
  [MagicalRecord setupCoreDataStack];

  //... other code
} 
```

初始化几乎是要运行的第一个代码，并且没有任何其他已运行的代码会与此冲突。

该行挂起，执行该行后没有任何内容。我设法找到了挂起发生的位置。将消息传递给`MagicalRecord`会导致类`+initialize`调用它，但这是行不通的。更具体地说，`self`在初始化方法中调用的任何方法都会导致`unrecognized selector`抛出异常。

据我所知，这有两件奇怪的事情：

1.  为什么找不到方法实现？
2.  为什么会导致它挂起？

我对Objective-C如何使用initialize方法知之甚少，当抛出异常时它是否会挂起？

这是发生异常时的堆栈跟踪：

```
frame #0: 0x00007fff93a2e3c5 libobjc.A.dylib`objc_exception_throw
frame #1: 0x00007fff996dc31a CoreFoundation`+[NSObject(NSObject) doesNotRecognizeSelector:] + 186
frame #2: 0x00007fff996341ee CoreFoundation`___forwarding___ + 414
frame #3: 0x00007fff99633fd8 CoreFoundation`_CF_forwarding_prep_0 + 232
frame #4: 0x000000010004e32c River`+[MagicalRecord initialize] + 92 at MagicalRecord.m:89
frame #5: 0x00007fff93a25236 libobjc.A.dylib`_class_initialize + 310
frame #6: 0x00007fff93a250f3 libobjc.A.dylib`prepareForMethodLookup + 164
frame #7: 0x00007fff93a24eef libobjc.A.dylib`lookUpMethod + 71
frame #8: 0x00007fff93a232fc libobjc.A.dylib`objc_msgSend + 188
frame #9: 0x0000000100001d36 MyApp`-[AppDelegate applicationDidFinishLaunching:] + 86 at AppDelegate.m:46 
```

对此的任何帮助，包括我可以尝试进一步调试的技巧，都非常感谢。

~~**更新：**~~

删除我的派生数据目录后，程序无法链接到 Pod。我相信 Xcode 在我添加 MagicalRecord 并链接到它的旧版本后未能构建 Pod（这可能是错误的，我不确定）。

~~这似乎是 Xcode 和/或 CocoaPods 问题。我正在尝试弄清楚如何让它正确构建 Pod，但我不是 CocoaPods 或 Xcode 构建设置方面的专家，所以我不确定我能走多远。~~

**更新 2：**

Xcode 和项目设置存在*问题*，它与旧的 Pod 库链接，并且仅在删除派生数据后才导致问题。现在我回到第 1 格，遇到无法识别的选择器问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T01:42:39.237

解决方案是使用Pod 库的产品设置中`-all_load`的**Other Linker Flags**设置中的链接器标志。

当您链接到 pod 库时，除非您这样做，否则 clang 会删除未使用的符号，并且由于您的应用程序不会在任何地方调用 +swizzleShorthandMethods，它会被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T14:59:32.707

对不起，我从来没有解决过这个问题，而且看起来没有人知道它为什么不起作用。我尝试与 Magical Record 的开发人员一起解决，但最终的答案是不使用 CocoaPods 并手动添加代码。我希望我能对此给出更好的解决方案，但我没有时间花几天时间调试这个问题，而且我认为我对 CocoaPods、Xcode 编译过程和 Objective-C 运行时了解不够调试它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-21T22:32:43.123

我手动添加了`MagicalRecord`库，遇到了这个错误。我的问题出在 .pch 文件中，因为 .pch 的导入`MagicalRecord/CoreData+MagicalRecord.h`高于定义：`#define MR_SHORTHAND`。

**将定义放在导入上面解决了我的问题。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T09:36:27.433

在您的`Podfile`更新 MagicalRecord 参考如下：

```
pod 'MagicalRecord/Shorthand', '~> 2.2' 
```

它将包含`#define MR_SHORTHAND`在您的`Pods/Pods-MagicalRecord-prefix.pch`文件中。

# javascript - 我的脚本中的循环迭代不正确

> ID：14633277
> 
> 赞同：1
> 
> 时间：2013-01-31T19:09:09.813
> 
> 标签：javascript, loops, for-loop, iteration

我用 JavaScript 为一个大学项目编写了一个循环，用于设置多个元素的样式值：

```
for (var i=1; i<6; i++) {
    document.getElementById("profile_details").childNodes[i].style.display =
    "block";
} 
```

我的问题是循环只迭代两次，通过提醒“i”的值来证明；而不是想要的五次。

但是，随着循环中的语句被注释掉，循环确实迭代了正确的次数，所以我假设语句存在问题，导致循环表现得如此奇怪......

任何回复/建议将不胜感激

**编辑：**

感谢所有快速回复，这里是 profile_details 元素，显示有超过 3 个子元素：

```
 <ul id="profile_details">
        <li>Artist</li>
        <li style="display:none;">Address: </li>
        <li style="display:none;">City: </li>
        <li style="display:none;">Postcode: </li>
        <li style="display:none;">Telephone: </li>
        <li style="display:none;">Website: </li>
    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:12:53.200

您确定该`profile_details`元素至少有 5 个孩子吗？为了性能和正常工作，您可能应该这样做：

```
var profileDetailsChildren = document.getElementById("profile_details").childNodes;
for (var i=0; i<profileDetailsChildren.length; i++) {
    profileDetailsChildren[i].style.display = "block";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:13:59.990

元素有多少个子节点？（`document.getElementById("profile_details").childNodes.length`会告诉你）。很可能只有 3 个。尝试访问不存在的数组元素会出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:23:21.170

如果你不知道你的元素有多少个子节点，你可以这样迭代：

```
var elems = document.getElementById("profile_details").childNodes;
for (var i=1; i<elems.length; i++) {
    elems[i].style.display = "block";
} 
```

只是为了确保，还要注意，第一个元素`elems`是`elems[0]`, （或者您可能需要将第一个元素排除在迭代之外）。

* * *

**编辑**

较新的浏览器还将标签之间的所有字符（包括空白字符和换行符）`childNodes`作为`textNode`. 但是，这些`textNode`s 没有`style`属性，因此浏览器会引发错误并且您的循环会失败。您需要检查当前节点的类型是否对样式有效：

```
var elems = document.getElementById("profile_details").childNodes;
for (var i=1; i<elems.length; i++) {
    if (elems[i].nodeType === 1) {
        elems[i].style.display = "block";
    }
} 
```

另一种选择是使用`children`不包含`textNode`s 的集合：

```
var elems = document.getElementById("profile_details").children; 
```

**[jsFiddle](http://jsfiddle.net/uuGC9/)的现场演示**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:10:49.303

似乎您只有 3 个`childNodes`in ，`#profile_details`因此在尝试访问`style`.`undefined`

您应该在控制台中看到这一点：

> TypeError：无法读取未定义的属性“样式”

* * *

您应该首先检查它有多少个孩子，然后将您的循环设置为该数量：

```
var children = document.getElementById("profile_details").childNodes;

for (var i = 1, l = children.length; i < l; i++) {
    children [i].style.display = "block";
} 
```

这将影响所有孩子，除了第一个孩子。如果您还希望第一个受此影响，则应从 0: 开始您的计数器`var i = 0`。

# java - 在包含 1 亿个字符串的大型文本文件中进行高效的子字符串搜索（无重复字符串）

> ID：14633286
> 
> 赞同：5
> 
> 时间：2013-01-31T19:09:43.867
> 
> 标签：java, mysql, file, search, lucene

我有一个包含 1 亿个字符串（无重复字符串）的大型文本文件（1.5 Gb），所有字符串在文件中逐行排列。我想在java中制作一个wepapplication，以便当用户给出关键字（子字符串）时，他可以获得包含该关键字的文件中存在的所有字符串的计数。我已经知道一种技术 LUCENE..还有其他方法可以做到这一点吗？？我希望在 3-4 秒内得到结果。我的系统有 4GB 内存和双核配置....需要在“仅限 JAVA”中执行此操作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T05:16:14.013

尝试使用哈希表。可以做的另一件事是任何类似于 MAP-REDUCE 的方法。我想说的是，你可以尝试使用倒排索引。谷歌使用相同的技术。您可以创建一个停用词文件，您可以在其中放置可以忽略的单词，例如 I、am、the、a、an、in、on 等。

这是我认为唯一可能的事情。我在某处读到用于搜索的内容，您可以使用数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:13:55.220

由于您的 RAM 大于文件的大小，因此您可以将整个数据作为结构存储在 RAM 中并非常快速地搜索它。[trie](http://en.wikipedia.org/wiki/Trie)可能是一个很好的数据结构。它确实具有快速的前缀查找功能，但不确定它对子字符串的执行情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T06:31:45.477

您可以根据每个单词的前几个字母构建目录结构。例如：

```
/A
/A/AA
/A/AB
/A/AC
...
/Z/ZU 
```

在该结构下，您可以保留一个包含所有字符串的文件，其中第一个字符与文件夹名称匹配。搜索词中的第一个字符会将选择范围缩小到仅占整个列表一小部分的文件夹。从那里，您可以完全搜索该文件。如果速度太慢，请增加目录树的深度以覆盖更多字母。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T05:42:36.077

您的关键字是否预计会有很多重叠？如果是这样，您也许可以存储从关键字 ( `String`) 到文件位置 ( `ArrayList`) 的哈希映射。尽管有对象开销，但您不能将所有行存储在内存中。

获得文件位置后，您可以在文本文件中查找该位置，然后查看附近以获取包含的换行符，并返回该行。那肯定会少于4秒。[这](http://docs.oracle.com/javase/tutorial/essential/io/rafs.html)是有关此的一些信息。如果这只是一个小练习，那会很好用。

更好的解决方案是两层索引，一个将关键字映射到行号，另一个将行号映射到行文本。这不适合您机器上的内存。有很棒[的基于磁盘的键值存储](http://redis.io/)，虽然这会很好用。如果这超出了玩具问题的范围，请使用 Reddis 路线。

# search - 如何在 Sitecore 内容编辑器中搜索归档项目？

> ID：14633288
> 
> 赞同：1
> 
> 时间：2013-01-31T19:09:53.047
> 
> 标签：search, sitecore, sitecore6

Sitecore 内容编辑器界面提供了多个搜索界面——从 Sitecore 按钮搜索应用程序、在内容树上方搜索输入字段以及通过数据库选择器向下搜索。据我所知，没有一个允许在存档项目中搜索。我知道存档应用程序有自己的搜索，但用户不想启动存档应用程序以便在那里搜索项目。

问题是如何将归档的搜索结果包含到一般的 Sitecore 搜索中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T11:28:19.503

在 buckets 模块（或 sitecore7）中，索引/搜索管道更易于修改。这将有可能实现您想要的东西，可能通过连接到搜索器并在存档索引中执行搜索（您必须这样做）。

亲切的问候，remco

# python - Flask WTF 表单未使用 sqlite3 数据库更新

> ID：14633290
> 
> 赞同：2
> 
> 时间：2013-01-31T19:10:04.290
> 
> 标签：python, python-2.7, flask, flask-sqlalchemy, flask-wtforms

我有一个 RadioField 表单项，它使用数据库中的字段值。

如果未创建数据库，我将无法启动 Flask Webserver，即使它只应在我转到该页面并加载该表单时访问数据库。

如果我在 Web 服务器运行时更​​新数据库，我看不到包含新数据库信息的表单。

直到我重新启动 Flask 网络服务器。

我怎样才能得到它，以便它在您访问页面时强制表单从数据库中重新加载其值。

我也很确定它将 RadioField 的值存储在内存中，因为我可以删除数据库并且 Flask Webserver 将继续运行并且 RadioField 仍将显示。

我正在使用 sqlite3 数据库并使用 APSW（另一个 python sqlite3 包装器）对其进行读写

这是我的表格

```
class DatabaseForm(Form):
    listOfRows = db.getDatabase()
    rows = [(str(x[0]), x) for x in listOfRows]
    images = RadioField('images', validators = [Required()], choices = rows) 
```

这是我的看法

```
@app.route('/database', methods = ['GET', 'POST'])
def database():
    ''' displays the database and allows the user to select an entry '''
    form = DatabaseForm()
    if form.validate_on_submit():

        primaryKey = form.images.data
        primaryKey = int(primaryKey)

        myProgram.start(primaryKey)
        return render_template('simple.html', word = "SUCCESS")
    else:
        print form.errors

    return render_template('database.html', form=form) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T09:09:47.180

您应该在视图中设置字段选项：

```
 form = DatabaseForm()
    form.images.choices = [(str(x[0]), x) for x in listOfRows]
    if form.validate_on_submit(): 
```

通过在类上设置一次，选项仅在类被实例化时设置，因此它们不会反映在该特定进程的生命周期内所做的任何更改。

# c# - 当我尝试使用 NHibernate Session 保存到包含复合键的桥表时，为什么会出现外键冲突？

> ID：14633295
> 
> 赞同：0
> 
> 时间：2013-01-31T19:10:10.887
> 
> 标签：c#, nhibernate, session, composite-key, hbmxml

我们的办公室团队正在工作和使用 .NET Framework 4 和 NHibernate 3.3.1 的 ASP.NET 项目

我有一个名为 AllResourcesInfo 的 POCO 域类（它最终映射到数据库中的 Resource 表，该表内部连接到其他一些表，但为了简单起见，假设 AllResourcesInfo 映射到 Resource 表）。

我还有一个名为 Section 的 POCO 域类（最终映射到数据库中的 Section 表）

我还有一个名为 ResourcesInSectionBridge 的 POCO 域类（它最终映射到数据库中名为 ResourcesInSectionBridge 的桥表）

正如命名约定所暗示的，ResourcesInSectionBridge 是 Resource 和 Section 之间的桥接表。

由于 ResourcesInSectionBridge 包含一个复合键，我创建了一个名为 ResourcesInSectionIdentifier 的 POCO 复合键标识符，并且还定义了一个 Equals(object obj) 方法和一个 GetHashCode 方法。

当我使用 NHibernate Session 为 ResourcesInSectionBridge 表保存一个新条目时，我收到一个错误：

异常详细信息：System.Data.SqlClient.SqlException：INSERT 语句与 FOREIGN KEY 约束“FK_ *Resources* _Resou__22CA2527”冲突。冲突发生在数据库“perls”、表“dbo.Resources”、列“ResourceDatabaseID”中。该语句已终止。

AllResourcesInfo.hbm.xml 的映射如下：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
               assembly="PivotServer"
               namespace="PivotServer.Domain"
               auto-import="false">
  <class name="AllResourcesInfo" table="Resources">
    <id name="ResourceDatabaseID">
      <generator class="guid" />
    </id>
    <property name="ResourceName" />
    <property name="DescriptionOfResource" />
    <property name="UserId" />
    <property name="DepartmentDatabaseID" />
    <property name="ResourceStatus" />
    <property name="isRemoved" />
    <property name="isSubmitted" />
    <property name="ResourcePlacement" />
    <property name="ResourceType" />
    <property name="ParentResourceID" />
    <joined-subclass     name="Imageitems">
      <key column="ResourceDatabaseID"/>
      <property column="DirectoryPathToFile" name="location"/>
      <property column="ImageIconPath" name="link"/>
      <property column="YearOfResource" name="YearOfResource"/>
      <property column="ArtistAuthor" name="ArtistAuthor"/>
      <property column="UploadDate" name="UploadDate"/>
      <property column="ImageitemDatabaseID" name="NativeItemDatabaseID"/>
    </joined-subclass>
    <joined-subclass     name="UriItems">
      <key column="ResourceDatabaseID"/>
      <property column="uriIconPath" name="location"/>
      <property column="UriLink" name="link"/>
      <property column="YearOfResource" name="YearOfResource"/>
      <property column="ArtistAuthor" name="ArtistAuthor"/>
      <property column="UploadDate" name="UploadDate"/>
      <property column="UriItemDatabaseID" name="NativeItemDatabaseID"/>
    </joined-subclass>
  </class>
</hibernate-mapping> 
```

Section.hbm.xml 的映射如下：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
               assembly="PivotServer"
               namespace="PivotServer.Domain"
               auto-import="false">
   <class name="Section"  table="Section">
     <id name="SectionDatabaseID">
       <generator class="guid" />
     </id>

    <many-to-one name="Courses"
   column="CourseDatabaseID" class="Courses"
  fetch="select"/>

     <many-to-one name="instructorUser" column="UserId" class="Users"
     fetch="select"/>

    <many-to-one name="term"
   column="TermDatabaseID" class="Term"
   fetch="select"/>

     <property  column="SectionCode" name="SectionCode" />

    <set name="setOfTutorials" inverse="false" lazy="true" fetch="select" >
      <key column="TutorialDatabaseID"/>
      <one-to-many class="Tutorial"/>
    </set>
  </class>
 </hibernate-mapping> 
```

最后，我们的 ResourcesInSectionBridge.hbm.xml 映射文件如下：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
               assembly="PivotServer"
               namespace="PivotServer.Domain"
               auto-import="false">
  <class name="ResourcesInSectionBridge" table="ResourcesInSectionBridge"  lazy="true" >
     <composite-id name="ResourcesInSectionIdentifier" class="ResourcesInSectionIdentifier">
        <key-property name="ResourceDatabaseID" column="ResourceDatabaseID" type="Guid"  />
       <key-property name="SectionDatabaseID" column="SectionDatabaseID" type="Guid"   />
      </composite-id>

     <many-to-one name="AllResourcesInfo" class="AllResourcesInfo" cascade="none" insert="false" update="false">
       <column name="ResourceDatabaseID"></column>
       <column name="ResourceDatabaseID"></column>
     </many-to-one>
    <many-to-one name="Section" class="Section" cascade="none" insert="false" update="false">
       <column name="SectionDatabaseID"></column>
       <column name="SectionDatabaseID"></column>
     </many-to-one>
  </class>

 </hibernate-mapping> 
```

最后，我们尝试在 ResourcesInSectionBridge 表中创建条目的 C# 代码如下：

```
ResourcesInSectionBridge resInSectionBridgeEntity = new ResourcesInSectionBridge();
ResourcesInSectionIdentifier resInSectionIdentifier = new ResourcesInSectionIdentifier();
resInSectionIdentifier.ResourceDatabaseID = aSpecificResource.ResourceDatabaseID;
resInSectionIdentifier.SectionDatabaseID = sectionOfInterest.SectionDatabaseID;
resInSectionBridgeEntity.ResourcesInSectionIdentifier = resInSectionIdentifier;

resInSectionBridgeEntity.Section = sectionOfInterest;
resInSectionBridgeEntity.AllResourcesInfo = aSpecificResource;

using (ISession session = NHibernateHelper.OpenSession())
{
        session.Evict(aSpecificResource);
        session.Evict(sectionOfInterest);
        session.Clear();
        using (ITransaction transaction = session.BeginTransaction())
        {
                session.Save(resInSectionBridgeEntity);

                transaction.Commit();
        }

} // end of using (ISession session = NHibernateHelper.OpenSession()) 
```

当我使用 NHibernate Session 为 ResourcesInSectionBridge 表保存一个新条目时，我收到一个错误：

异常详细信息：System.Data.SqlClient.SqlException：INSERT 语句与 FOREIGN KEY 约束“FK_ *Resources* _Resou__22CA2527”冲突。冲突发生在数据库“perls”、表“dbo.Resources”、列“ResourceDatabaseID”中。该语句已终止。

你能解释一下为什么会抛出这个错误吗？另外，你能否建议我如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:54:42.857

您看到的错误来自数据库，它表示表`ResourceDatabaseID`中不存在 key的值`Resources`。如果它们不存在，则对桥接表所做的任何条目都必须*在两个源表插入其项目之后。*

您需要正确填充`Resource`和`Section`实体才能插入到桥表中才能正常工作。查看[这些示例中多对多映射的示例代码，](http://www.devart.com/entitydeveloper/nhibernate-mapping-samples.html)以了解与您要实现的目标相似的内容。您可以下载示例而不需要他们的产品。

# python - Python 循环 vs 理解列表 vs 映射的副作用（即不使用返回值）

> ID：14633298
> 
> 赞同：2
> 
> 时间：2013-01-31T19:10:17.963
> 
> 标签：python, map, coding-style, list-comprehension, maintainability

TL; DR 哪个是最好的？

```
1.- [r.update(r.pop('some_key')) for r in res if r.get('some_key')]

2.- map(lambda r: r.update(r.pop('some_key') if r.get('some_key') else []), res)

3.- map(lambda r: r.update(r.pop('some_key')), filter(lambda r: r.get('some_key'), res))

4.- for r in res:
        if r.get('some_key'):
            for element in r['some_key']:
                r[element] = r['some_key'][element]
            del r['some_key']

5.- Insert your own approach here 
```

**注意**：这不是生产代码。它是在测试套件中运行的代码，所以我更关心易读性/可维护性而不是性能。尽管如此，我也想知道如果这是生产代码，关于哪个更好（考虑权衡性能/易读性）的决定是否会改变。如果这会产生影响，那么元素“some_key”的数量会非常少。

**上下文**：我读过[Python List Comprehension Vs。](https://stackoverflow.com/questions/1247486/python-list-comprehension-vs-map)接受答案的[地图：](https://stackoverflow.com/questions/1247486/python-list-comprehension-vs-map)

> [...] 在其他情况下，列表理解可能更快，并且大多数（不是全部）**pythonistas 认为它​​们更直接和更清晰**[...]。

尽管如此，接受的答案[是 Pythonic to use list comprehensions for just side effects？](https://stackoverflow.com/questions/5753597/is-it-pythonic-to-use-list-comprehensions-for-just-side-effects)说：

> 这样**做是非常反 Python 的**[仅对副作用使用理解列表，忽略返回值]，任何经验丰富的 Pythonista 都会让你大吃一惊。中间列表在创建后被丢弃，它可能非常非常大，因此创建成本很高。

PS：我已经对哪个最好有意见，但我的一位同事不同意。这就是我询问的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:15:08.193

```
1.- [r.update(r.pop('some_key')) for r in res if r.get('some_key')] 
```

不建议对副作用进行列表理解。它创建一个列表，该列表在操作结束时被丢弃

```
2.- map(lambda r: r.update(r.pop('some_key') if r.get('some_key') else []), res) 
```

与此没有太大区别`1`，这将在 Py 3.X 中中断。

```
3.- map(lambda r: r.update(r.pop('some_key')), filter(lambda r: r.get('some_key'), res)) 
```

更糟糕的是`3`。除了使用`map`和依赖副作用之外，您还增加了函数调用的开销

```
4.- for r in res:
        if r.get('some_key'):
            for element in r['some_key']:
                r[element] = r['some_key'][element]
            del r['some_key'] 
```

这比其他的好

1.  没有生成将被丢弃的不必要列表
2.  将在 Py 3.x 中工作
3.  没有显式的函数调用开销

5.- 在此处插入您自己的方法

```
 for r in res:
        if 'some_key' in r:
            r.update(r['some_key'])
            del r['some_key'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T19:10:34.223

我认为 Abhijit 答案的这种变体，同时也是我的第 4 点的变体是最好的。

```
for r in res:
    r.update(r.pop('some_key', {})) 
```

*   具有使用常规`for`循环的所有优点
*   很容易理解
*   只需 2 行代码
*   不需要`if`子句

# javascript - 如何循环和比较 json 对象中的元素并仅显示 div 中的更改？

> ID：14633302
> 
> 赞同：1
> 
> 时间：2013-01-31T19:10:32.727
> 
> 标签：javascript, jquery, json

基本上我正在尝试在 div 内的购物车中显示产品。购物车托管在其他地方，为了检索产品，我发出了一个 getJSON 请求，该请求返回一个 json 对象，如下所示：

```
{
"products":[
    {
        "id": "3045365",
        "name": "Test Product",
        "code": "foo123",
        "image": "",
        "url": "",
        "length": "0",
        "width": "0",
        "height": "0",
        "options": {"color":"red"},
        "quantity": 1,
        "price_each": 10,
        "price": 10,
        "weight_each": 1,
        "weight": 1,
        "shipto": "",
        "category": "DEFAULT",
        "sub_frequency": "",
        "sub_startdate": "0000-00-00",
        "sub_nextdate": "0000-00-00",
        "sub_enddate": "0000-00-00"
    },
    {
        "id": "3045366",
        "name": "Second Product",
        "code": "bar456",
        "image": "",
        "url": "",
        "length": "0",
        "width": "0",
        "height": "0",
        "options": {},
        "quantity": 1,
        "price_each": 100,
        "price": 100,
        "weight_each": 1,
        "weight": 1,
        "shipto": "",
        "category": "DEFAULT",
        "sub_frequency": "",
        "sub_startdate": "0000-00-00",
        "sub_nextdate": "0000-00-00",
        "sub_enddate": "0000-00-00"
    },
    {
        "id": "3045367",
        "name": "Example Subscription",
        "code": "xyz456",
        "image": "",
        "url": "",
        "length": "0",
        "width": "0",
        "height": "0",
        "options": {"color":"red"},
        "quantity": 1,
        "price_each": 6,
        "price": 6,
        "weight_each": 4,
        "weight": 4,
        "shipto": "",
        "category": "DEFAULT",
        "sub_frequency": "1m",
        "sub_startdate": "2010-10-15",
        "sub_nextdate": "2010-11-15",
        "sub_enddate": "2013-01-01"
    }
],
"product_count": 3,
"total_item_price": 116,
"total_discount": -5,
"total_price": 111,
"total_weight": 6,
"session_id": "9bpdjvm2ju0bulm6d7kkcf6d31",
"coupons":{
    "test2":{
        "id":"201",
        "name":"test for line item coupon discount",
        "discount":-5}
},
"custom_fields":{
    "my_hidden_value":"I'm hidden!",
    "example_hidden":"value_1"
},
"messages":{
    "errors":[],
    "warnings":[],
    "info":[]
}
} 
```

我当前的代码，当用户点击添加到购物车时，检查 div 是否为空。如果是，它会从 json 对象中添加第一个产品。

如果 div 不为空，则它将 div 中的第一个产品的名称与 json 对象中的第一个元素的名称进行比较。如果结果为真，则只更新价格而不更新名称。如果结果为假，则检查 json 对象中的下一个元素。这是我的代码：

```
$(document).ready(function()
{

var x=0;
var y=0;

$("#addCart").click(function()
{

    if($('#cartContent').is(':empty'))
    {
        $.getJSON('https://'+storedomain+'/cart?'+fcc.session_get()+'&output=json&callback=?', function(data) 
        {
            $('#cartContent').append('<p class="name">' + data.products[x].name + '</p>' + '<p class="price">' + data.products[x].price + '</p>');      
        });
    }
    else 
    {
    $.getJSON('https://'+storedomain+'/cart?'+fcc.session_get()+'&output=json&callback=?', function(data) 
    {
            $('.name').each(function()
            {   
                while (y < data.products.length-1)
                {   
                    if($(this).text() === data.products[x].name)
                    {   
                        $('.price').eq(x).text(data.products[x].price);     
                    }   
                    x++;
                    y++;
                }
                x=0;
                y=0;
            });
            });
    }               
});
});

<a id="addCart" href="http://mydomain.foxycart.com/cart?name=test-clothes&price=10.00">Add to Cart</a>
<div id="cartContent" style="display: inline; clear: both;"></div> 
```

这一切都很好。我的问题是我已经测试了好几天，但我想不出一种方法可以：

1.  如果用户将产品 1 添加到购物车，则附加名称 + 价格
2.  如果用户将相同的产品 1 添加到购物车，只更新价格
3.  如果用户将产品 2 添加到购物车，则附加名称 + 价格
4.  如果用户将相同的产品 2 添加到购物车，只更新价格

到目前为止，我的代码只设法附加和比较一个产品。不是连续的。我还是 javascript 的新手，如果我的方法很荒谬，请帮我提出一个更好的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:33:53.237

您可以使用一个对象（类似于其他编程语言中的 HashMap 或关联数组）来存储当前购物车状态并在检查此对象后对未来的点击采取行动。您还需要跟踪当前的产品数量，因为这不是 JavaScript 对象提供的。这取决于您将存储的值

//初始为空，或者你可以将其初始化为已保存的购物车状态。var cartProducts = {}, numProducts = 0;

$("#addCart").click(function () {

```
if (numProducts === 0) {
    //Here, create the DOM fragment representing your product.
    cartProducts["product-id"] = $("<div"); 

    numProducts += 1;

} else if(cartProducts["product-id"]) {
    //Update the product price since it has already been added to the DOM.

//When refactoring, combine this else statement with the first if condition.
} else {
    //At this point you know that the product has not been previously add it,
    //and can go ahead and add it to the DOM.

    //...
    numProducts += 1;        
} 
```

});

只是对您的代码结构的**一般评论：**

1.  评论您的代码将有助于其他人和您将来理解您的代码。
2.  尝试将您的代码模块化为负责一小块代码的单独函数。这将有助于代码的可管理性、可重用性和可测试性。
3.  如果要迭代 [i->n; 则使用 for 循环而不是 while 循环 我++]。
4.  [JSLint](http://www.jslint.com/)您的代码以帮助您设置样式和正确的语法。

希望这可以帮助你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:29:44.527

也许您需要映射您添加到购物车的产品及其价格。

前任：

```
<div class="product">
    Prod 1 
    <div class="product-price">100</div>
</div>

<script>
    var productNames = [];

    function checkExisting(name) {
        return !(productNames.indexOf(name) < 0);
    }

    function appendProduct(name, price) {
        var p = $('<div>' + name + '<div>' + price + '</div></div>');
        p.data('name', name);
    }

    $(addToCart).click(function() {
        var products = $('.product');

        products.each(function() {
            if( checkExisting($(this).data('name')) ) {
                productNames.push($(this).data('name'));
            }
        });

        $.getJSON(bla, function(data) {
            for(var i = 0; i < data.products.length; i++) {
                 if(checkExisting(data.products[i].name)) {
                     appendProduct();
                 }
                 else {
                     updatePrice();
                 }
            }
        });
    });
</script> 
```

或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:41:38.850

下面的代码是我的做法：

```
 //occurs when the element with id addCart is clicked
$("#addCart").click(function()
{
    //gets json of products
    $.getJSON('https://'+storedomain+'/cart?'+fcc.session_get()+'&output=json&callback=?', function(data) 
    {
        //creates arrays to hold values
        var items = new Array();
        var names = new Array();
        var price = new Array();

        //foreach product in data name it item and do the following
        data.products.each(function(item){
            //See if the item id is in the items array
            var index = $.inArray(item.id, items);
            //If it isn't
            if(index == -1)
            {
                //Add the item to the arrays
                items.push(item.id);
                names.push(item.name);
                price.push(item.price);
            }
            //it already is in the array one time so just add to price
            else
            {
                //add to the price by the amount of the item price
                price[index] += item.price;
            }
        });

        //empty the html from the element with id cartContent 
        $('#cartContent').empty();
        //loop through all items in item array
        for (var i = 0; i < items.length ; i++) {
            //Add html for each item since we only added each once this happens once per item
            $('#cartContent').append('<p class="name">' + names[i] + '</p>' + '<p class="price">' + price[i] + '</p>');
        }
    });
}); 
```

# azure - 更改 Azure 角色配置设置不会重新启动应用程序域？

> ID：14633304
> 
> 赞同：4
> 
> 时间：2013-01-31T19:10:42.513
> 
> 标签：azure

我使用 SquishIt 来捆绑我的脚本等，因此有一些代码在应用程序启动时运行，这些代码使用 web.config 的 appSettings 中指定的基本 URL 来配置包。我更改了要使用的代码，`CloudConfigurationManager.GetSetting("CdnBaseHref")`因为我希望能够在通过 Azure 门户部署应用程序后更新 URL。

但是，更新 URL 不会导致应用程序启动代码再次运行，所以我有一段代码使用更新的设置，而启动代码仍然使用旧设置，这当然会破坏一切。

更新此设置后，如何使每个角色实例重新运行启动代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-13T11:02:43.680

你是对的。更改角色配置设置不会重新启动应用程序域，这使您能够在不妨碍应用程序域的情况下即时更改应用程序行为（取决于配置的代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-19T09:37:59.227

您可以注册以侦听`RoleEnvironment.Changing Event`当配置更改发生时触发的事件。当您检测到此事件时，您可以使用新值“刷新”您的静态变量。[您可以在msdn 页面](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.changing.aspx#Anchor_1)上阅读更多详细信息。更改后也会`RoleEnvironment.Changed Event`触发。这些事件可以在`OnStart()`worker角色的方法中注册。

# c# - 使用 GUID 和聚集索引时，Entity Framework 5 中的关系生成失败

> ID：14633307
> 
> 赞同：1
> 
> 时间：2013-01-31T19:10:51.447
> 
> 标签：c#, .net, entity-framework-5

re 已经开始在 VS2012 的 ASP.NET MVC4 项目中使用 Entity Framework 5。由于数据库是通过工具设计的，因此我们正在基于数据库创建模型。数据库使用 GUID 作为主键。

当我们生成模型时，类之间没有创建任何关系。经过多次反复试验，我们发现问题是由建立在外键 GUID 列上的聚集索引引起的。一旦我们从数据库中删除这些并重新创建模型，所有关系都会按应有的方式生成。

有没有其他人遇到过同样的问题，或者我们做错了什么？

# jquery - 使用 jQueryMobile 构建本地化的移动应用程序 - 需要输入

> ID：14633314
> 
> 赞同：2
> 
> 时间：2013-01-31T19:11:12.530
> 
> 标签：jquery, html, css, jquery-mobile

全部，

我正在构建一个本地化的移动应用程序，其中我使用 unicode 字体（我的语言）并创建了许多 json 文件，粗略估计我的“JSON”文件大约 25 MB。

我只是想知道，当我们使用本地化的 unicode 字体时，有什么办法可以优化文件的大小？

有人可以在这里分享您的想法吗？

谢谢，戴夫

# php - 在 foreach() 迭代期间修改数组

> ID：14633321
> 
> 赞同：10
> 
> 时间：2013-01-31T19:11:32.413
> 
> 标签：php, arrays, foreach

我有几个关于在 foreach() 循环期间修改数组的查询。在下面的代码中，我遍历三个包含闭包/回调的数组并调用每个数组。在迭代过程中，我在每个数组的末尾附加了一个闭包，但是有时 foreach() 似乎没有识别出数组已经改变了大小，因此附加的闭包不会被调用。

```
class Foo
{
    private $a1 = array();
    private $a2 = array();

    public function f()
    {
        echo '<pre style="font-size: 20px;">';
        echo 'PHP: ' . phpversion() . '<br><br>';

        $this->a1[] = function() { echo 'a1 '; };
        $this->a1[] = array($this, 'g');
        foreach ($this->a1 as &$v)
        {
            // The callback added in g() never gets called.
            call_user_func($v);
            //echo 'count(v) = ' . count($v) . ' ';
        }

        echo '<br>';

        // The same thing works fine with a for() loop.
        $this->a2[] = function() { echo 'a2 '; };
        $this->a2[] = array($this, 'h');
        for ($i = 0; $i < count($this->a2); ++$i)
            call_user_func($this->a2[$i]);

        echo '<br>';

        // It also works fine using a local array as long as it
        // starts off with more than one element.
        $a3[] = function() { echo 'a3 '; };
        //$a3[] = function() { echo 'a3 '; };
        $i = 0;
        foreach ($a3 as &$x)
        {
            call_user_func($x);
            if ($i++ > 1) // prevent infinite loop
                break;

            // Why does this get called only if $a3 originally starts
            // with more than one element?
            $a3[] = function() { echo 'callback '; };
        }

        echo '</pre>';
    }

    private function g()
    {
        echo 'g() ';
        $this->a1[] = function() { echo 'callback '; };
    }

    private function h()
    {
        echo 'h() ';
        $this->a2[] = function() { echo 'callback '; };
    }
}

$foo = new Foo;
$foo->f(); 
```

输出：

```
PHP: 5.3.14-1~dotdeb.0

a1 g() 
a2 h() callback 
a3 
```

预期输出：

```
a1 g() callback
a2 h() callback 
a3 callback 
```

`$a3`如果我在循环之前取消注释第二个元素，则输出：

```
a3 a3 callback 
```

1.  为什么第一个循环没有`foreach ($this->a1 as &$v)`意识到`$v`有另一个元素要迭代？
2.  为什么`$a3`在第三个循环期间修改有效`foreach ($a3 as &$x)`，但仅当数组以多个元素开始时才有效？

我意识到在迭代期间修改数组可能不是一个好主意，但由于 PHP 似乎允许这样做，我很好奇为什么上面的工作方式如此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T23:54:59.627

有趣的观察：

```
echo "foreach:  ";
$a = array(1,2,3);
foreach($a as $v) {
  echo $v, " ";
  if ($v===1) $a[] = 4;
  if ($v===4) $a[] = 5;
}

echo "\nforeach&: ";
$a = array(1,2,3);
foreach($a as &$v) {
  echo $v, " ";
  if ($v===1) $a[] = 4;
  if ($v===4) $a[] = 5;
}

echo "\nwhile:    ";
$a = array(1,2,3);
while(list(,$v) = each($a)) {
  echo $v, " ";
  if ($v===1) $a[] = 4;
  if ($v===4) $a[] = 5;
}

echo "\nfor:      ";
$a = array(1,2,3);
for($v=reset($a); key($a)!==null; $v=next($a)) {
  echo $v, " ";
  if ($v===1) $a[] = 4;
  if ($v===4) $a[] = 5;
} 
```

结果是

```
foreach:  1 2 3 
foreach&: 1 2 3 4 
while:    1 2 3 4 5 
for:      1 2 3 4 5 
```

这表示：

*   正常`foreach`循环对数组的副本进行操作，循环内数组的任何修改都不会影响循环
*   带有`foreach`引用值的 a 被强制使用原始数组，但在分配键和值变量后，在每次迭代*之前推进数组指针。*还有一些优化正在进行，一旦指针到达末尾，就可以防止再次检查。因此，在最后一次迭代开始时，循环被告知再次运行然后完成 - 不再可能发生干扰。
*   一个`while`循环与`each()`前进数组指针一样`foreach`，但在最后一次迭代后再次显式检查它
*   *每次迭代后*`for`数组指针前进的循环显然在任何时候更改数组都没有问题。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:11:18.253

> 1.为什么第一个循环 foreach ($this->a1 as &$v) 没有意识到 $v 有另一个元素要迭代？

该行为看起来是由于在每次 foreach 迭代中在数组上前进的内部指针。*在数组的最后*一次迭代时，即内部指针已经为空时，在数组末尾添加一个数组元素，意味着该元素将不会被迭代。通过对您的代码进行一些修改，可以看出这一点。

```
class Foo
{
    private $a1 = array();
    private $a2 = array();

    public function f()
    {
        echo '<pre style="font-size: 20px;">';
        echo 'PHP: ' . phpversion() . '<br><br>';

        $this->a1[] = function() { echo 'a1 <br/>'; };
        $this->a1[] = array($this, 'g');
        foreach ($this->a1 as $key => &$v)
        {
           //lets get the key that the internal pointer is pointing to 
           // before the call.
                  $intPtr = (key($this->a1) === null) ? 'null' : key($this->a1);
                echo 'array ptr before key ', $key, ' func call is ',    
                       $intPtr, '<br/>' ;
            call_user_func($v);
            //echo 'count(v) = ' . count($v) . ' ';
        }

        echo '<br><br>';

        // The same thing works fine with a for() loop.
        $this->a2[] = function() { echo 'a2 '; };
        $this->a2[] = array($this, 'h');
        for ($i = 0; $i < count($this->a2); ++$i)
            call_user_func($this->a2[$i]);

        echo '<br><br>';

        // It also works fine using a local array as long as it
        // starts off with more than one element.
        $a3[] = function() { echo 'a3 '; };
        //$a3[] = function() { echo 'a3 '; };
        $i = 0;
        foreach ($a3 as &$x)
        {
            call_user_func($x);
            if ($i++ > 1) // prevent infinite loop
                break;

            // Why does this get called only if $a3 originally starts
            // with more than one element?
            $a3[] = function() { echo 'callback '; };
        }

        echo '</pre>';
    }

    private function g()
    {
        echo 'g() <br>';
        $this->a1[] = function() { echo 'callback '; };
    }

    private function h()
    {
        echo 'h() <br>';
        $this->a2[] = function() { echo 'callback '; };
    }
}

$foo = new Foo;
$foo->f(); 
```

输出：

```
array ptr before key 0 func call is 1
a1 
array ptr before key 1 func call is null <-will not iterate over any added elements!
g() 

a2 h() 
callback 

a3 
```

> 2.为什么在foreach的第三个循环（$a3 as &$x）期间修改$a3有效，但仅当数组以多个元素开始时才有效？

当然，如果您在内部指针返回 null 之前向数组添加一个元素，那么该元素将被迭代。在您的情况下，如果数组有一个元素，那么在第一次迭代中，内部指针已经返回 null。但是，如果最初有多个元素，则可以在第一次迭代时添加附加元素，因为此时内部指针将指向第二个初始元素。*

# css-float - 在没有 CSS 的情况下将文本环绕在图像周围以发送电子邮件？

> ID：14633326
> 
> 赞同：1
> 
> 时间：2013-01-31T19:11:39.707
> 
> 标签：css-float, newsletter

我有一个带有缩略图的文本。此图像显示在左上方。文本在图像的右侧和底部可见。

在电子邮件中，我不能使用 css-float left 属性。我尝试使用没有成功的表。如何在电子邮件中显示没有css的缩略图左上角？

非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:51:35.780

您可以使用 align 属性：

```
<img src="" align="left" /> The content that you are trying to wrap the image around 
```

这将使您的图像向左浮动，与 css 浮动相同。

# macos - 关注 NSTableview 的每一行以更改单击时的图像-

> ID：14633328
> 
> 赞同：1
> 
> 时间：2013-01-31T19:11:41.847
> 
> 标签：macos, nsmutablearray, nstableview, nstableviewcell

我正在尝试[将此](http://juliuspaintings.co.uk/cgi-bin/paint_css/animatedPaint/070-NSTableView-ImageAndTextCell.pl)示例的 ImageAndTextCell.h 类添加到我的项目中。我已经添加成功了。它看起来像下面

![这个](../Images/743b36822d3ffa1c5cb92ae205e00230.png)

在行上单击我得到选定的索引，在 IBAction 上我需要将其更改为绿色。这也很好。但是当我点击另一行时，前面的行绿色变成红色。我确定问题出在检查行的逻辑上。我已经实现了以下失败的代码

```
 - (NSCell *)tableView:(NSTableView *)tv dataCellForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {

NSTextFieldCell  *cell = [tableColumn dataCell];
if(tv== [self tableView]){
    if([[tableColumn identifier] isEqualToString:COLUMN_TITLE]){
        if(![tickTracker count]){
            ImageAndTextCell *imageAndTextCell = (ImageAndTextCell *)cell;
            // Set the image here since the value returned from outlineView:objectValueForTableColumn:... didn't specify the image part...
            NSString *fileName = [[NSBundle mainBundle] pathForResource:@"Cross" ofType:@"png"];
            NSImage *markerImage = [[NSImage alloc] initWithContentsOfFile:fileName];
            [imageAndTextCell setImage:markerImage];

        }else{
             for (int i= 0;i < [tickTracker count];i++){ 
              NSLog(@" 123 number %@",[tickTracker objectAtIndex:i]);
              NSInteger myInteger = [[tickTracker objectAtIndex:i] integerValue];
              [changedRows addObject:[tickTracker objectAtIndex:i]];

            if(row == myInteger){
                NSLog(@" %li value ",row);
                ImageAndTextCell *imageAndTextCell = (ImageAndTextCell *)cell;
                // Set the image here since the value returned from outlineView:objectValueForTableColumn:... didn't specify the image part...
                NSString *fileName = [[NSBundle mainBundle] pathForResource:@"Tick" ofType:@"png"];
                NSImage *markerImage = [[NSImage alloc] initWithContentsOfFile:fileName];
                [imageAndTextCell setImage:markerImage];

            }else{
                 ImageAndTextCell *imageAndTextCell = (ImageAndTextCell *)cell;
                 // Set the image here since the value returned from outlineView:objectValueForTableColumn:... didn't specify the image part...
                NSString *fileName = [[NSBundle mainBundle] pathForResource:@"Cross" ofType:@"png"];
                NSImage *markerImage = [[NSImage alloc] initWithContentsOfFile:fileName];
                [imageAndTextCell setImage:markerImage];
                }
            }
         }
   return cell;
  } 
```

有人可以帮我吗？当它检查索引 1 处的对象时，tickTracker 中索引 0 处的对象未设置为绿色。

**编辑 1**。在ticktracker内部：

-（IBAction）方法：（id）发件人{

```
 NSUInteger idx = [[tableView selectedRowIndexes] firstIndex];

 while (idx != NSNotFound) {
    int rowKey = (int)idx;
    NSNumber* rowNumber = [NSNumber numberWithInt:rowKey];
    [tickTracker addObject:rowNumber];

    idx =[[tableView selectedRowIndexes] indexGreaterThanIndex:idx];

} 
```

}

输出：

```
 NSLog(@" 123 number %@",[tickTracker objectAtIndex:i]);
  Output: 123 number 2
  NSLog(@" %li value ",row);
  2 value 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:54:56.187

1) 声明一个`selectedCars`NSMutableDictionary 类型的属性。初始化它。这将替换您的“tickTracker”。

2）您不需要IBAction。只需覆盖`tableViewSelectionDidChange`：

```
- (void)tableViewSelectionDidChange:(NSNotification *)aNotification {
    [selectedCars addObject:@"yes" forKey:[[self tableView] selectedRow];
} 
```

3) 在`dataCellForTableColumn`替换

```
}else{
             for (int i= 0;i < [tickTracker count];i++){ 
              NSLog(@" 123 number %@",[tickTracker objectAtIndex:i]);
              NSInteger myInteger = [[tickTracker objectAtIndex:i] integerValue];
              [changedRows addObject:[tickTracker objectAtIndex:i]];

            if(row == myInteger){ 
```

和

```
}else{
   if ([self.selectedCars objectForKey:row]) {
      ... set the tick image ...
   } else {
      ... set the cross image ...
} 
```

4) 如果要取消选择行，则检查 ...DidChange 委托方法，如果`selectedCars`已设置并删除该条目，如果为真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T02:38:52.523

```
 if([tickTracker containsObject:row]) { 

    } 
```

这是已解决的问题。只要对象行值在 tickTracker 内，就可以更改图像。

# python - 重新格式化人口普查标题

> ID：14633329
> 
> 赞同：2
> 
> 时间：2013-01-31T19:11:44.590
> 
> 标签：python, gis, census

我的任务是在区块级别挖掘人口普查数据。在学习了如何导航并找到我要找的东西后，我遇到了障碍。tabblock 多边形（块级多边形）的 id 由 15 个长度的字符串组成，

例如：'471570001022022'

但人口普查数据的格式标记为：

“田纳西州谢尔比县人口普查区 2022 区块组 2”

块 ID 的格式为：state-county-tract-group-block，带有一些前导零以构成 15 个字符。sscccttttggbbbb

有谁知道将其转换为可用格式的快速方法？在我花时间尝试编写 python 脚本之前，我想我会问一下。

谢谢，gm

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:54:19.303

假设[此数据](http://www.census.gov/econ/cbp/download/georef02.txt)是正确的，并且您已将其解析为两个字典，`state_ids`并且`county_ids`，其中键是实体的字符串表示形式，值是字符串形式的数字表示形式：

```
def get_tabblock_id(tabblock_string):
    block, block_group, tract, county, state = re.match('Block (\\d+), Block Group (\\d+), Census Tract (\\d+), (.+), (.+)', tabblock_string).groups()
    return state_ids[state].zfill(2) + county_ids[county].zfill(3) + tract.zfill(4) + block_group.zfill(2) + block.zfill(4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:37:30.210

好吧，我明白了。

ex = '田纳西州谢尔比县人口普查区 2022 街区组 2'

new_id = '47157' + ex[40:len(ex)-26].zfill(4) + '0' + ex[24] + ex[6:10]

州和县的值是恒定的；块组仅达到一位数（afaik）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:40:29.087

使用 struct 可能更整洁

```
>>> import struct
>>> r = '471570001022022'
>>> f = '2s3s4s2s4s'
>>> struct.unpack(f, r)
('47', '157', '0001', '02', '2022')
>>> s, c, t, g, b = unpack(f, r)
>>> print s
47 
```

# javascript - 带有 html 表格标签的无限滚动（滚动加载）

> ID：14633330
> 
> 赞同：3
> 
> 时间：2013-01-31T19:11:52.660
> 
> 标签：javascript, jquery, asp.net, html-table, infinite-scroll

我尝试在 html 表上实现无限滚动，或者如果需要，可以实现“滚动加载”。数据存储在数据库中，我使用后面的代码访问它。

我从 msdn 上的一个示例中实现了它，如下所示：

**JS**

```
 $(document).ready(function () { 

        function lastRowFunc() { 
            $('#divDataLoader').html('<img src="images/ajax-Loader.gif">'); 

            //send a query to server side to present new content 
            $.ajax({ 
                type: "POST", 
                url: "updates.aspx/GetRows", 
                data: "{}", 
                contentType: "application/json; charset=utf-8", 
                dataType: "json", 
                success: function (data) { 

                    if (data != "") { 
                        $('.divLoadedData:last').before(data.d);
                    } 
                    $('#divDataLoader').empty(); 
                } 

            }) 
        }; 

        //When scroll down, the scroller is at the bottom with the function below and fire the lastRowFunc function 
        $(window).scroll(function () { 
            if ($(window).scrollTop() == $(document).height() - $(window).height()) { 
                lastRowFunc(); 
            } 
        });

        // Call to fill the first items
        lastRowFunc();
    }); 
```

**后面**的代码并不那么有趣，它只是以这种格式（每行一个）从数据库返回数据（每次 20 行）：

```
<tr><td>Cell 1 data</td><td>Cell 2 data</td><td>Cell 3 data</td></tr> 
```

**ASPX**

```
<table>
<thead>
    <tr><th>Header 1</th><th>Header 2</th><th>Header 3</th></tr>
</thead>
    <tbody>
        <div class="divLoadedData"> 
        </div>
    </tbody>
</table>
<div id="divDataLoader"> 
</div> 
```

**问题是**，当数据被加载并插入页面时（即使在第一次加载时），表头会在数据之后。我确实看到了我加载的所有行，但表格标题位于页面底部（在我加载的 20 行之后）。我尝试了一些变化来插入加载的数据：

```
$('.divLoadedData:last').before(data.d); 
```

或者

```
$('.divLoadedData:last').append(data.d); 
```

或者

```
$('.divLoadedData:last').after(data.d); 
```

但他们都没有工作。很高兴听到有关如何使用 html 表正确实现它并使其工作的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:23:30.313

这可能是因为 HTML 无效：[`tbody`应该只包含`tr`.](https://developer.mozilla.org/en-US/docs/HTML/Element/tbody#Usage_context) 为什么不直接将行附加到`tr`，像这样？

**HTML**

```
<table>
 <thead>
  <tr><th>Header 1</th><th>Header 2</th><th>Header 3</th></tr>
 </thead>
 <tbody class="tbodyLoadedData">
 </tbody>
</table>
<div id="divDataLoader"> 
</div> 
```

**JS**

```
$('.tbodyLoadedData').append(data.d); 
```

[此 JSBin 将这种方式与您当前尝试的方式进行比较](http://jsbin.com/odixon/2/edit)。在 Chrome 的 DOM 检查器中查看您的方式，Chrome 似乎正在`div`将`table`.

我在 JSBin 中的表格中添加了一个边框，以表明它`div`正在移出它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:24:06.060

IMO ，`div`内部`table`并不真正需要。试试这是否可行：

**ASPX：**

```
<table>
  <thead>
    <tr><th>Header 1</th><th>Header 2</th><th>Header 3</th></tr>
  </thead>
  <tbody class="divLoadedData">
  </tbody>
</table>
<div id="divDataLoader"> 
</div> 
```

**成功回调：**

```
function (data) { 
    if (data != "") { 
        $('.divLoadedData').append(data.d);
    } 
    $('#divDataLoader').empty();
} 
```

# wordpress - Wordpress：为特定模板添加小部件侧边栏

> ID：14633332
> 
> 赞同：1
> 
> 时间：2013-01-31T19:11:54.703
> 
> 标签：wordpress, templates, dynamic, sidebar

问题：我添加的第三个侧边栏没有出现在目标页面上。

描述：我想看看是否有人可以看到我在特定模板中创建和显示小部件侧边栏的步骤中缺少的任何内容。使用下面描述的情况，侧边栏出现在小部件管理页面上，但是当模板呈现时，侧边栏是默认侧边栏，这表明模板没有找到动态侧边栏。这是我添加的第二个侧边栏。如果我将模板标记中的侧边栏名称替换为第一个附加模板的名称，则页面将使用第一个自定义侧边栏呈现。

创建其他小部件侧边栏并使用选定模板显示它们的步骤

1）在functions.php中注册子主题中的侧边栏
2）在注册过程中为新的侧边栏分配名称和ID
3）在现有模板的基础上创建一个额外的侧边栏模板。复制现有模板并更改动态模板的名称以匹配新注册的侧边栏
4) 转到要显示侧边栏的模板并将侧边栏的名称插入到 get_sidebar() 模板标签中。
5）转到管理面板并将小部件拖到新的侧边栏书帖上

具体来说，这可能看起来像：

1.  注册侧边栏：

    ```
    if ( function_exists ('register_sidebar'))
        register_sidebar( array(
        'name'          => __('bookpost'),
        'id'            => 'sidebar-bookpost',
        'description'   => 'Sidebar for showing ad and section list on the template single-book.php',
        'before_widget' => '<div id="%1$s" class="widget %2$s">',
        'after_widget'  => '</div>',
        'before_title'  => '<h2 class="widgettitle">',
        'after_title'   => '</h2>' )); 
    ```

2.  指定名称 bookpost 和 sidebar-bookpost
3.  创建一个名为 sidebar-bookpost.php 的附加侧边栏模板。编辑行

    所以它现在读取

    ```
    get_sidebar('bookpost'); 
    ```

最后使用小部件管理页面分配小部件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T12:45:18.927

你想获得动态侧边栏吗？如果是这样，那么使用

```
<?php if ( is_active_sidebar( 'sidebar-bookpost' ) ) : ?>

        <?php dynamic_sidebar( 'sidebar-bookpost' ); ?>

<?php endif; ?> 
```

而不是 get_sidebar('bookpost');

…………

# python - 相当于金字塔的django-tables2？

> ID：14633333
> 
> 赞同：3
> 
> 时间：2013-01-31T19:12:00.423
> 
> 标签：python, django, pyramid, django-tables2

[django-tables2](https://github.com/bradleyayers/django-tables2)是否有金字塔等价物？我发现这个库真的很棒......我会说几乎完美，现在我正在尝试找到一个等效的库，因为我切换到了 Pyramid。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T20:04:03.127

大约 3 年前，我提交了这个网格插件，它适用于各种数据类型——它支持排序，并且非常可配置。

[http://slugo.scrapping.cc/python/WebHelpers/modules/html/grid.html](http://sluggo.scrapping.cc/python/WebHelpers/modules/html/grid.html)

我不知道除我之外的任何其他软件包。

# c# - 如何将字节数组从 C++ 返回到 C#

> ID：14633338
> 
> 赞同：5
> 
> 时间：2013-01-31T19:12:10.910
> 
> 标签：c#, c++, pointers, marshalling

所以我一直在努力解决这个问题。我正在尝试制作自己的 AES 128 库以与我的一个程序一起使用。该库测试并在 C++ 中工作（对于 encrypt 函数很好。我还没有实现其他函数）“Encrypt”函数是这样的：

**新代码**

```
void Aes128Class::EncryptBlock(BYTE* outBlock, const BYTE* inBlock, const BYTE* cipherBlock)
{
    BYTE temp[16] = {0x00};
    Galois::XorBlock(temp, inBlock);
    Galois::XorBlock(temp, cipherBlock);

    BYTE expandedKey[176] = {0x00};
    memcpy(expandedKey, Key, 16);
    Galois::expand_key(expandedKey);

    Galois::XorBlock(temp, expandedKey);
    for(int i=16; i<160; i+=16)
    {
        Galois::DoRound(temp, &expandedKey[i]);
    }
    Galois::SubBytes(temp);
    Galois::ShiftRows(temp);
    Galois::XorBlock(temp, &expandedKey[160]);

    memcpy(outBlock, temp, 16);
}
void Aes128Class::EncryptData(BYTE* outBlock, size_t& outlen, const BYTE* inBlock, size_t length)
{
    float blockSize = (float)(length/16);
    blockSize = ceilf(blockSize);
    int newLength = (int)(blockSize*16);
    BYTE* temp = (BYTE*)malloc(newLength);
    BYTE* padd = (BYTE*)malloc(newLength);
    memset(temp, 0, newLength);
    memcpy(padd, inBlock, length);
    EncryptBlock(temp, padd, IV);
    for (int i=1; i<blockSize; i++)
    {
        EncryptBlock(&temp[i*16], &padd[i*16], &temp[(i-1)*16]);
    }
    outlen = newLength;
    memcpy(outBlock, temp, newLength);
} 
```

这个想法是，如果`plainText`不是 16 字节块增量，那么我强制它是。所以这形成了一个可变大小的字节数组。它在我的`C++`测试中有效，但是当我调用它时，`C#`我得到了一些不同的错误......这需要一分钟来描述。

```
 [DllImport("CppAes128.dll", CallingConvention = CallingConvention.ThisCall,
        EntryPoint = "?EncryptData@Aes128Class@@QAEXPAEAAIPBEI@Z")]
    static extern void EncryptData(IntPtr pClass, ref IntPtr outblock, [Out]int OutLength, byte[] inBlock, int length); 
```

当我调用它时，我得到了指向`array`和 outlength 的有效指针。它现在看起来的方式会导致访问冲突，但如果我更改`[Out]int OutLength`为`ref IntPtr`. 有趣的是，如果我这样做`ref int`或者`ref uint`它仍然“有效”。因此，如果我这样做，我会尝试阅读`intptr`，然后我会遇到访问冲突。我正在将其编译为`x86 project`in `.NET 4.0`（因为我在某处读到 3.5 有一些访问错误......）

这是我尝试过的`C#`。因为我玩了几个小时，所以有点乱码（抱歉）：

```
 public byte[] EncryptData(byte[] plainText, int length)
    {
        byte[] enc = null;
        int len = 0;
        IntPtr pArray = IntPtr.Zero;
        EncryptData(theClass, ref pArray, len, plainText, length);

        Console.WriteLine(len);
        //enc = new byte[len];
        //Marshal.Copy(pArray, enc, 0, len);
        //Marshal.Release(pArray);
        //try
        //{
        //    int elementSize = Marshal.SizeOf(typeof(IntPtr));
        //    //IntPtr unmanagedArray = Marshal.AllocHGlobal(10 * elementSize);
        //    Console.WriteLine("Reading unmanaged memory:");
        //    // Print the 10 elements of the C-style unmanagedArray 
        //    for (int i = 0; i < 10; i++)
        //    {
        //        Console.WriteLine("{0:X2}:", Marshal.ReadByte(pArray, i));
        //    }

        //    Marshal.FreeHGlobal(pArray);

        //}
        //catch (Exception ex)
        //{
        //    Console.WriteLine("{0}\n{1}", ex.Source, ex.Message);
        //    Console.WriteLine("Win32({0})", Marshal.GetLastWin32Error());
        //}
        //Marshal.Release(pArray);
        return enc;
    } 
```

唯一有效的时候是我刚刚制作了一个静态大小的数组并且没有使用`ref`或`marshal`复制或任何东西..我认为我的签名是这样的

```
static extern void EncryptData(IntPtr pClass, byte[] outBlock, byte[] inBlock, int length); 
```

这几乎奏效了，但问题是，当我对其进行`foreach`循环时，`array`它始终是我放置的大小.. 至少可以说令人沮丧。

那么我做错了什么？我怎样才能让它工作？我对此感到非常沮丧。谢谢

哦，仅供参考，这样我就不能再依赖`cryptlib`了。我正在尝试重新编译一个不同的项目，该项目使用`cryptlib`, 作为静态库而不是共享的，这会导致我的编译选项出现一些问题并且太麻烦而无法改回来。

**编辑显示更多代码**

这是我使用的测试。我找到了一个显示一堆测试的网页，所以这是我实现的。

```
void VerifyEncrypt16(const BYTE* expected, const BYTE* key, const BYTE* iv, const BYTE* plainText)
{
    BYTE actual[16] = {0x00};
    Aes128Class aes;
    aes.SetKey(key, 16);
    aes.SetIV(iv, 16);
    size_t len = 0;
    aes.EncryptData(actual, len, plainText, 16);
    _ASSERT(CompareTwoArrays(expected, actual));
}
void VerifyEncrypt16String(const char* expected, const char* key, const char* iv, const char* plainText)
{
    BYTE e[16];
    BYTE k[16];
    BYTE i[16];
    BYTE p[16];

    ByteUtil::StringToHex(expected, e);
    ByteUtil::StringToHex(key, k);
    ByteUtil::StringToHex(iv, i);
    ByteUtil::StringToHex(plainText, p);

    VerifyEncrypt16(e, k, i, p);
}
void CheckEncrypt16(void)
{
    _RPT0(_CRT_WARN, "Checking Encryption of a 16 byte number IV set to 0\n");
    //AESVS GFSbox test data for CBC
    VerifyEncrypt16String("0336763e966d92595a567cc9ce537f5e","00000000000000000000000000000000","00000000000000000000000000000000","f34481ec3cc627bacd5dc3fb08f273e6");
    VerifyEncrypt16String("a9a1631bf4996954ebc093957b234589","00000000000000000000000000000000","00000000000000000000000000000000","9798c4640bad75c7c3227db910174e72");
    VerifyEncrypt16String("ff4f8391a6a40ca5b25d23bedd44a597","00000000000000000000000000000000","00000000000000000000000000000000","96ab5c2ff612d9dfaae8c31f30c42168");
    VerifyEncrypt16String("dc43be40be0e53712f7e2bf5ca707209","00000000000000000000000000000000","00000000000000000000000000000000","6a118a874519e64e9963798a503f1d35");
    VerifyEncrypt16String("92beedab1895a94faa69b632e5cc47ce","00000000000000000000000000000000","00000000000000000000000000000000","cb9fceec81286ca3e989bd979b0cb284");
    VerifyEncrypt16String("459264f4798f6a78bacb89c15ed3d601","00000000000000000000000000000000","00000000000000000000000000000000","b26aeb1874e47ca8358ff22378f09144");
    VerifyEncrypt16String("08a4e2efec8a8e3312ca7460b9040bbf","00000000000000000000000000000000","00000000000000000000000000000000","58c8e00b2631686d54eab84b91f0aca1");

    //AESVS KeySbox test data for CBC
    VerifyEncrypt16String("6d251e6944b051e04eaa6fb4dbf78465","10a58869d74be5a374cf867cfb473859","00000000000000000000000000000000","00000000000000000000000000000000");
    //A TON OF MORE TESTS! etc etc etc        VerifyEncrypt16String("5c005e72c1418c44f569f2ea33ba54f3","00000000000000000000000000000000","00000000000000000000000000000000","fffffffffffffffffffffffffffffffe");
    VerifyEncrypt16String("3f5b8cc9ea855a0afa7347d23e8d664e","00000000000000000000000000000000","00000000000000000000000000000000","ffffffffffffffffffffffffffffffff");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T03:51:46.287

如果您仍在寻找答案，此示例提供了一个起点。

基本上，从在本机函数调用中分配内存块开始，而不是调用回调 - 在您传递（通过 ref ）数组的托管位置及其从输入参数的原始列表中保存的大小。

这样，您可以在托管代码中为托管代码分配内存块，并使用本机内容对其进行编辑。

[http://msdn.microsoft.com/en-us/library/ektebyzx.aspx](http://msdn.microsoft.com/en-us/library/ektebyzx.aspx)

另一种方法会很高兴找到，性能比较将是一个奖励:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:21:28.847

坦率地说，我发现最简单的方法是用托管 C++ 调用包装非托管 C++ 调用。在托管 C++ 中，您可以直接以 C++ 方式复制数据（通过固定数据结构）并将其传递回 C#

# jquery - \n 在 IE 文本区域中不起作用

> ID：14633339
> 
> 赞同：2
> 
> 时间：2013-01-31T19:12:11.693
> 
> 标签：jquery, internet-explorer, split, textarea

我正在使用这个 jquery 添加页面的一些元素并将它们添加到文本区域

```
$('#chk_editor').append($('#greeting').text()).append('\n \nI want it to be known that').show(); 
```

Internet Explorer 忽略 /n，我发现这个问题解决了 split() [Javascript split() 在 IE 中不起作用的问题](https://stackoverflow.com/questions/8511741/javascript-split-not-working-in-ie)

我不确定如何在我的代码中实现它，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:13:52.753

尝试使用`\r\n`.

这是 Windows 风格的行尾。`\n`是 UNIX 样式的行尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:37:16.983

尝试以下操作：

```
 var text = $("#chk_editor").val();
    text = text + $("#greeting").html();
    text = text + "\n \n I want to be known.";
    $("#chk_editor").val(text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:49:13.553

尝试这两个选项之一：

1）对于包含**\n**的任何字符串，您可以执行以下操作：

```
 function adjustText(messageString)
 {
   return messageString.replace('\n', '\r\n');
 }
 ....
 $('#chk_editor').append($('#greeting').text()).append(adjustText(message)); 
```

另请参阅[https://stackoverflow.com/a/5899275/1219182](https://stackoverflow.com/a/5899275/1219182)

2) 尝试使用`val()`jquery- 属性（设置 textArea 时）而不是 text()

```
$('#chk_editor').val("some text....\n ...bla bla \n...) 
```

另请参阅[https://stackoverflow.com/a/5583094/1219182](https://stackoverflow.com/a/5583094/1219182)

# javafx-2 - 我如何获得 EventDispatcherChain

> ID：14633341
> 
> 赞同：1
> 
> 时间：2013-01-31T19:12:16.213
> 
> 标签：javafx-2

我正在尝试创建一个自定义`ActionEvent`. 当我尝试分派事件时，`scene.dipatchEvent`它要求我提供一个`EventDispatcherChain`对象。我没有做任何复杂的事情来实际创建一个新的`EventDispatcherChain`. 我将如何获得默认的 EventDispatcherChain 以便将其传递给`scene.dispatchEvent`？

**事件类型**

```
public class SquirrelEventType extends EventType<SquirrelActionEvent> {

    public SquirrelEventType() {
        super("Squirrel.NotifyPreloader");
    }

} 
```

**事件**

```
public class SquirrelActionEvent extends ActionEvent {

private Preloader.PreloaderNotification preloaderNotification;
private String details;
private double progress;

/**
 *
 */
public SquirrelActionEvent(double progress){
    preloaderNotification = new Preloader.ProgressNotification(progress);
}

public PreloaderNotification getPreloaderNotification() {
    return preloaderNotification;
}

public void setPreloaderNotification(PreloaderNotification preloaderNotification) {
    this.preloaderNotification = preloaderNotification;
} 
```

这是调用`dispatchEvent`

```
SquirrelActionEvent event = new SquirrelActionEvent(0.1d);
mainScene.getEventDispatcher().dispatchEvent(event, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:55:45.813

事件只是通过 Event.fireEvent() 这是一个静态方法发送。

# java - 仅使用 catalina-ws.jar 在 Tomcat7 中拥有 REST Web 服务就足够了吗？

> ID：14633343
> 
> 赞同：2
> 
> 时间：2013-01-31T19:12:24.263
> 
> 标签：java, web-services, rest, tomcat

我遇到了许多使用 Jersey 和 Tomcat7 来实现 REST Web 服务的教程。但我也看到，如果您下载 catalina-ws.jar（看[这里](http://tomcat.apache.org/tomcat-7.0-doc/extras.html)），tomcat 会提供 Web 服务支持。所以想问一下，我们项目中能不能只用这个jar，调用rest web services？以前有人用过这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:34:43.550

Jersey 是 JAX-RS ( [JSR-311](http://jcp.org/en/jsr/detail?id=311) )，它与 ​​WebServices 1.2 ( [JSR-109](http://jcp.org/en/jsr/detail?id=109) ) 完全不同，后者是[Java EE 5](http://en.wikipedia.org/wiki/Java_EE_version_history#Java_EE_5_.28May_11.2C_2006.29)的一部分。要么单独安装[Jersey ，要么用](http://jersey.java.net/)[TomEE](http://tomee.apache.org/)替换 Tomcat 。你只会得到[Apache CXF](http://cxf.apache.org/)而不是 Jersey。

# ios - 如何正确继承 UITableViewController

> ID：14633345
> 
> 赞同：4
> 
> 时间：2013-01-31T19:12:33.700
> 
> 标签：ios, objective-c, cocoa-touch

我有一个`UITableViewController`我在方法中定义了一些特定的单元格属性`cellForRowAtIndexPath`。我真正定义任何特定的唯一方法是`cellForRowAtIndexPath`方法。我没有包括任何其他方法。（所以基本上 UITableViewController 除了 cellForRowAtIndexPath 是空的）

现在，我正在尝试基于此 UITableViewController 进行子类化，但我的问题是如何为 sublcas 设置 cellForRowAtIndexPath？如果我将其留空，应用程序会崩溃，因为它需要定义一个单元格。但是，它不应该使用基类中定义的单元格吗？

我必须在我的子类的 cellForRowAtIndexPath 方法中添加什么才能使用我在基类中创建的单元格设置？

*编辑*我被告知解决方案，对于任何想知道的人，您可以在子类中调用超级类，例如

```
UITableViewCell *cell = (UITableViewCell *)[super tableView:tableView cellForRowAtIndexPath:indexPath];
return cell; 
```

这会将超级单元格返回给您的子单元格，然后您返回该单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:54:24.327

如果我理解正确，您有一个`UITableViewCell`要在`tableview:cellFowRowAtIndexPath:`.

您需要调用`registerClass:forCellReuseIdentifier:`自定义类和定义的重用标识符`tableview:cellFowRowAtIndexPath:`以使其返回此类的实例。

例如：

```
- (void)viewDidLoad
{
   [super viewDidLoad];
   [self.tableView registerClass:[CustomTableViewCell class] forCellReuseIdentifier:@"CustomCell"];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"CustomCell";
    CustomTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // Configure the cell...

    return cell;
} 
```

别忘了打电话`#import "CustomTableViewCell.h"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:26:43.377

该方法是表格视图数据源协议的必需部分，需要您指定。如果您查看 UITableViewController 的开发人员文档，您会发现 cellForRowAtIndexPAth 不是它的函数；它位于 UITableViewDataSource 下[，您可以在此处找到](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)。这意味着，基类中没有实现；这些功能在协议中是抽象的，您应该扩展它们并实现它们。

如果您打算创建一个空表，则可以返回空单元格。只需分配它们并在函数中返回它们；不需要对表格视图单元进行子类化。一旦您的应用停止崩溃，您就可以指定所需的文本。使用 indexPath 使不同节或不同行的单元格指定不同的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:18:23.887

您混淆了继承和委托。请记住， a`UITableView`需要一个类才能成为它`UITableViewDelegate`和`UITableViewDataSource`。这个类不需要继承自`UITableView`. 我认为通过继承一个`UITableViewCell`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:43:39.380

我想你会发现你的 UITableViewController - 包含 cellForRowAtIndexPath 实际上*已经*是 UITableViewController 的子类。它的标题将如下所示：

```
#import <UIKit/UIKit.h>

@interface MyTableViewController : UITableViewController

@end 
```

UITableViewController 的区别在于

*   它有一个 self.tableView 属性，其中包含对其 tableView 的引用。
*   它向通常的 UIViewController 超类添加了另外两个属性和一个方法，但更重要的是......
*   它（通常）充当 tableView 的委托和数据源

后者意味着它必须实现至少两个数据源方法。作为委托方法，这些*没有*在 UITableViewController 超类中实现，因此必须包含两者：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
    return 0;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // Configure the cell...

    return cell;
} 
```

您已经实现`cellForRowAtIndexPath`了，但您还需要实现 numberOfRowsInSection: 以便表知道它需要多大。

# macos - 实体模式下的 NSArrayController 在编辑了带有内容绑定的 NSTableView 后未更新

> ID：14633347
> 
> 赞同：1
> 
> 时间：2013-01-31T19:12:36.437
> 
> 标签：macos, core-data, nstableview, cocoa-bindings, nsarraycontroller

我有一个 NSArrayController 配置了模式“实体”，其中包含选择的“人员”和“准备内容”类型的核心数据实体。所有其他属性都是默认属性。正如预期的那样，当我创建新的人员实体（通过单击按钮）时，这个数组控制器会更新它的排列对象：

```
-(IBAction)addEntity:(id)sender{
  Person* new = [NSEntityDescription insertNewObjectForEntityForName:@"Person"
                           inManagedObjectContext:[self managedObjectContext]];
  new.text = @"text";
  new.date = [NSDate date];
} 
```

我已将基于视图的 NSTableView 的内容绑定到此 arrayController 的“arrangedObjects”属性，以显示人员。在一个列中，我有一个可编辑的（但默认情况下）NSTextField 绑定到 TableCellView 的“objectValue.text”属性。

如果我在表格中编辑“文本”属性并添加另一个人（当表格单元仍处于编辑模式时）表格失去焦点，编辑将结束并且新人显示在表格中。一切看起来都很好。

但是，如果我想添加另一个人，arrayController 不会更新排列对象属性（我发现不再调用 arrayController 的 setContent：）。

这是预期的行为吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T09:52:51.847

我自己找到了答案。我注意到在我编辑表格后没有发送 NSManagedObjectContextObjectsDidChangeNotifications（就像他们之前所做的那样）。

该[链接](https://stackoverflow.com/questions/7742308/nsmanagedobjectcontextobjectsdidchangenotification-not-always-called-instantly)为我指明了正确的方向。在我以下列方式修改我的 addEntity 方法后，一切都按预期工作：

```
-(IBAction)addEintrag:(id)sender {
 Person* new = [NSEntityDescription insertNewObjectForEntityForName:@"Person" 
                          inManagedObjectContext:[self managedObjectContext]];
 new.name = @"test";
 new.datum = [NSDate date];
 [self.managedObjectContext processPendingChanges];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:31:02.373

如果您希望您的 arrayController 自动重新排列对象，请在 Interface Builder 中选中您的 arrayController 上的“自动重新排列内容”复选框或以`setAutomaticallyRearrangesObjects:`编程方式使用。

# qt - Qt QRegExp 用锚定 URL替换字符串中的所有URL

> ID：14633350
> 
> 赞同：0
> 
> 时间：2013-01-31T19:12:44.593
> 
> 标签：qt, qregexp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:33:38.507

好的。知道了。

```
QRegExp regExp("((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-]*)?\\??(?:[\\-\\+=&;%@\\.\\w]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)");

QString result = myOriginalString.replace(regExp, "<a href='\\1'>\\1</a>" ); 
```

为了谁可能对此感兴趣，我将把问题/答案留在这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:27:58.307

我不会为你写你的正则表达式。但是，Qt 4 附带了[一个工具，它可以帮助很多人编写一个](http://qt-project.org/doc/qt-4.8/tools-regexp.html)，您也可以自己编译它。

或者，您的 Qt 安装中应该包含一组示例和演示（在 Windows 上，转到开始 -> Qt 示例和演示）。启动示例应用程序并导航到工具（第二页）-> 正则表达式。单击启动并按照说明进行操作。

使用该演示来帮助您编写一个，遵循[文档中的](http://doc-snapshot.qt-project.org/4.8/qregexp.html)指南。特别是，查看捕获文本、通配符匹配和字符集部分。

# android - Android PreferenceScreen - 我可以在不将首选项保存到 SharedPreferences 的情况下使用它吗？

> ID：14633351
> 
> 赞同：16
> 
> 时间：2013-01-31T19:12:48.973
> 
> 标签：android, android-layout, android-widget

我正在尝试使用 Android`PreferenceScreen`作为一种方便的方式来布局我的用户设置，但我不想将首选项保存到设备共享首选项中。这是可能的，还是我应该使用不同的机制，例如`ListView`？

使用该`PreferenceScreen`类型似乎真的很方便，因为我需要不同的小部件（即开关、编辑文本）。但是我已经遇到了持久性问题，即。即使在我不希望的会话中，我输入的任何内容也会持续存在。

设置.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Preference
        android:key="settings_type"
        android:title="@string/label_type" />

    <EditTextPreference
        android:key="settings_edit_name"
        android:title="@string/label_name"
        android:dialogTitle="Enter a name"
        android:singleLine="true" />

    <SwitchPreference
        android:key="settings_edit_state"
        android:title="@string/label_state"
        android:summary="Enable or disable the state" />

</PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-09-23T08:36:55.467

我知道这是一个老问题，但我觉得它很有趣。只需将此属性设置为您的偏好，它将不会被保存：

```
android:persistent="false" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T20:11:36.740

我重新阅读了相应的[文档](http://developer.android.com/reference/android/preference/Preference.OnPreferenceChangeListener.html)并确定了如何通过实现`Preference.OnPreferenceChangeListener`接口来防止保存首选项。

> 公共静态接口 Preference.OnPreferenceChangeListener
> 
> 当此 Preference 的值已被用户更改并且即将设置和/或持久化时要调用的回调的接口定义。这使客户端有机会阻止设置和/或保留该值。

例子：

```
public class SettingsFragment extends PreferenceFragment {

    public static SettingsFragment newInstance(int index) {
        SettingsFragment f = new SettingsFragment();

        Bundle args = new Bundle();
        args.putInt("index", index);
        f.setArguments(args);

        return f;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        addPreferencesFromResource(R.layout.settings);

        // getArguments().getInt("index");

        EditTextPreference namePreference = (EditTextPreference) findPreference("settings_edit_name");
        namePreference.setOnPreferenceChangeListener(new NamePreferenceChangeListener());

    }

    private class NamePreferenceChangeListener implements Preference.OnPreferenceChangeListener {

    @Override
    public boolean onPreferenceChange(Preference preference, Object newValue) {
        // Do something else presumably and then return false to avoid saving the pref.
        return false;
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:22:26.383

您可以只使用线性布局并在其中放置所需组件的非首选版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:41:03.290

由于首选项必然会被存储，因此您始终可以在 onCreate 中清除它们

在 PreferenceFragment 的 onCreate 中试试这个

```
super.onCreate();
getPreferenceManager().setSharedPreferencesName("custom");
SharedPreferences sp = getPreferenceManager().getSharedPreferences();
SharedPreferences.Editor editor = sp.edit();
editor.clear();
editor.apply(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-24T03:00:41.803

我建议创建一个子类`PreferenceDataStore`并将其分配给您的`PreferenceManager`.

## 偏好数据存储

> 要实现并提供给 Preference 框架的数据存储接口。如果需要，这可用于替换默认的 android.content.SharedPreferences。
> 
> *   [https://developer.android.com/reference/kotlin/androidx/preference/PreferenceDataStore](https://developer.android.com/reference/kotlin/androidx/preference/PreferenceDataStore)

## 偏好管理器

> `public void setPreferenceDataStore (PreferenceDataStore dataStore)`
> 
> 设置一个 PreferenceDataStore 供与此管理器关联的所有首选项使用，这些首选项没有通过 分配的自定义 PreferenceDataStore `Preference.setPreferenceDataStore(PreferenceDataStore)`。此外，如果设置了数据存储，则只要将子首选项分配给此管理器，它们就不会使用 SharedPreferences。
> 
> *   [https://developer.android.com/reference/androidx/preference/PreferenceManager#setPreferenceDataStore(androidx.preference.PreferenceDataStore)](https://developer.android.com/reference/androidx/preference/PreferenceManager#setPreferenceDataStore(androidx.preference.PreferenceDataStore))

## 例子

### 自定义数据存储

```
 class CustomDataStore: PreferenceDataStore() {
    override fun putBoolean(key: String?, value: Boolean) {
        when (key) {
            knownKey -> // Do something
            anotherKnownKey -> // Do somthing else
        }
    }

    override fun putString(key: String?, value: String?) {
        when (key) {
            knownKey -> // Do something
            anotherKnownKey -> // Do something else
        }
    }

    // You can ignore unused types but make sure to still override to avoid UnsupportedOperationException
    override fun putFloat(key: String?, value: Float) {}
    override fun putInt(key: String?, value: Int) {}
    override fun putLong(key: String?, value: Long) {}
    override fun putStringSet(key: String?, values: MutableSet<String>?) {}

    override fun getBoolean(key: String?, defValue: Boolean): Boolean {
        return when (key) {
            knownKey -> // Do something
            anotherKnownKey -> // Do something else
            else -> defValue
        }
    }

    override fun getString(key: String?, defValue: String?): String? {
        return when (key) {
            knownKey -> // Do something
            anotherKnownKey -> // Do something else
            else -> defValue
        }
    }
} 
```

**注意：**子类化时要小心，因为所有抽象`put()`方法都会抛出`UnsupportedOperationException`.

### PreferenceFragment 或 PreferenceFragmentCompat

```
override fun onCreatePreferences(savedInstanceState: Bundle?, rootKey: String?) {
    // Prevent saving to SharedPreferences, use a custom data store
    preferenceManager.preferenceDataStore = CustomDataStore()
} 
```

# facebook-graph-api - 有没有办法找回上传到 Facebook 的原始照片？

> ID：14633352
> 
> 赞同：1
> 
> 时间：2013-01-31T19:12:50.003
> 
> 标签：facebook-graph-api, metadata

我正在开发一个需要将原始照片上传到 Facebook 的应用程序，所以我可以使用“日期”元数据吗？有没有办法得到这些数据？

# java - 将文件数据存储在数组列表中时出现数组列表问题

> ID：14633357
> 
> 赞同：-1
> 
> 时间：2013-01-31T19:13:00.423
> 
> 标签：java, java-io

我正在尝试找出两个文本文件之间的差异，并尝试在第三个文件中写入差异！！！我这样做非常成功，但是我的文件太大了，它有将近 200000 行，当我将它存储到 arrylist 时，它只存储数据直到第 6482 行。我不明白为什么会这样。有人可以帮我吗？这是我的代码

```
 import java.io.*;

    import java.io.*;
    import java.util.ArrayList;
    import java.util.List;
    import java.util.Scanner;

    public class SearchThe {
    public static void main(String args[]) {
        try {
            // Open the file c:\test.txt as a buffered reader

                      Scanner s = new Scanner(new File("D://abc.txt"));
                      Scanner s2 = new Scanner(new File("D://xyz.txt"));
//                       Scanner s = new Scanner(new File("D://file1.txt"));
//                      Scanner s2 = new Scanner(new File("D://file2.txt"));
                    ArrayList<String> file1_list = new ArrayList() ;
                    ArrayList<String> file2_list = new ArrayList();
//                    file1_list.ensureCapacity(193225);
//                     file2_list.ensureCapacity(193225);
                    while (s.hasNext()) {
                        file1_list.add(s.next());

                    }
                    s.close();
                    while (s2.hasNext()) {
                        file2_list.add(s2.next());
                    }
                    s2.close();
                     FileWriter stream = new FileWriter("D://file1_copy.csv");
                          BufferedWriter abc = new BufferedWriter(stream);
                    for(int i=0;i<file1_list.size();i++)
                    {
                        System.out.println("File 1 data" +file1_list.get(i));
                         abc.write(file1_list.get(i));abc.newLine();

                    }
                    abc.close();
//                   

            // Start a line count and declare a string to hold our current 
            int linecount = 0;
                String line;

            // Let the user know what we are searching for

//                      for(int i=0;i<file1_list.size();i++)
//                      {   // Loop through each line, stashing the line into our line     
                         FileWriter fstream = new FileWriter("D://result.txt");
                          BufferedWriter out = new BufferedWriter(fstream);
                          for(int j =0;j<file1_list.size();j++)
                          {

                          System.out.println("\n\nSearching for  " + file1_list.get(j) + "  in file 1...");

                           if(file2_list.contains(file1_list.get(j)))
                           {
                               System.out.println(file1_list.get(j) +"   found in a file 2");

                           }
                           else
                           {
                               System.out.println(file1_list.get(j) +"  not found in a file 1 ");
                               out.write(file1_list.get(j));out.newLine();

                           }

                      }
                          out.close();

        }
        catch (IOException e) {
            System.out.println("IO Error Occurred: " + e.toString());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:33:01.370

默认情况下，扫描仪使用空格分隔符；你确定在第 6482 行之后有空格吗？请检查最后一个标记是否在第 6482 行之后没有返回整个文件。

如果空格分隔符没有问题，请检查 java 运行时的可用内存。

运行时 rt = Runtime.getRuntime(); long freeMem = rt.freeMemory();

我希望内存应该不是问题，对于 32 位进程模型，进程的最大虚拟地址大小约为 4 GB；但最好检查一下。希望，它会给你一个指向你的问题的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:48:13.423

我检查了空闲内存，它说

可用内存 69476304

所以这不是问题，你是对的。在 6482 行之后也有一个空格。我不知道是什么问题:(

# kohana-3 - Kohana 3 - 文件大小验证

> ID：14633361
> 
> 赞同：0
> 
> 时间：2013-01-31T19:13:09.393
> 
> 标签：kohana-3

我正在使用下面的代码进行文件验证。奇怪的是，如果我尝试上传超过大小限制的文件，我得到的不是空错误，而是与大小限制相关的错误。谁能解释问题出在哪里？

```
$validate = Validate::factory($_FILES);
             $validate->rules('image',
                     array(
                     'Upload::valid' => array(),
                     'Upload::not_empty' => array(), 
                     'Upload::type' =>array('Upload::type' => array('jpg','png','gif')), 
                     'Upload::size' => array('1M'))
                     );

             if ($validate->check())
            {           
             //ok
             $directory = DOCROOT.'uploads/';
             $filepath = Upload::save($_FILES['image'], '123zxhahaxdfdgsdfsdha.jpg', $directory);   
             Request::instance()->redirect($redirect);                  
            }
             else
             {
             //error    
                 $this->errors = $validate->errors('errors');
                 $errors = $this->errors;
             //echo $errors;
             } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T22:33:43.583

您可以通过更改验证数组中元素的顺序来解决此问题，即更改

```
$validate->rules(
    'image',
    array(
        'Upload::valid' => array(),
        'Upload::not_empty' => array(), 
        'Upload::type' =>array('Upload::type' => array('jpg','png','gif')), 
        'Upload::size' => array('1M'),
    )
); 
```

到

```
$validate->rules(
    'image',
    array(
        'Upload::valid' => array(),
        'Upload::size' => array('1M'),
        'Upload::not_empty' => array(), 
        'Upload::type' =>array('Upload::type' => array('jpg','png','gif')), 
    )
); 
```

“Wut‽”，你可能已经想到了。好吧，在 Kohana 中处理验证规则的方式，检查器停止检查更多规则。如果您想亲自查看，请在以下位置查找这些行`system/classes/kohana/validate.php`：

```
 //This field has an error, stop executing rules.
    break; 
```

您会在您似乎正在使用的 Kohana 3.0 中找到它们，但在当前的 3.3 中也可以找到它们。

并且您大概是通过上传一个大小足以被 PHP 甚至您的 Web 服务器阻止的文件来测试您的应用程序。最可能的罪魁祸首是 PHP 的`upload_max_filesize`值，在默认的 PHP 安装中只有 2M，参见。[这个页面来自 PHP 手册](http://www.php.net/manual/en/features.file-upload.common-pitfalls.php)。这意味着文件上传是空的（如，没有文件），因为被 PHP 阻止太大。

这可以解释为什么您的代码给出了您报告的行为。但是 Kohana 的`Upload::size`函数（当然！）足够聪明，可以检测到文件太大——你会在以下代码中找到这些行`system/classes/kohana/upload.php`：

```
 if ($file['error'] === UPLOAD_ERR_INI_SIZE)
    {
        // Upload is larger than PHP allowed size
        return FALSE;
    } 
```

因此，如果它*首先*检查，它将在该规则上失败，这就是为什么我对您的代码的重新洗牌应该摆脱您报告的不需要的行为。

另外两个相切的评论：

首先，`system/classes/kohana/upload.php`你会注意到这个评论：

```
If you _do_ require a file to be uploaded, add
the [Upload::not_empty] rule before this rule. 
```

但是在重新排序验证规则时我没有考虑到这一点*，*`before`因为 TBH 我认为它具有误导性/不正确：在对这些字段的值。

 *其次，注意`Upload::not_empty`不检查文件大小**是否**大于零；为此，您可以`application/classes/upload.php`使用以下内容创建：

```
class Upload extends Kohana_Upload {

    public static function not_empty(array $file)
    {
        return (parent::not_empty($file)
            AND $file['size']);
    }

} 
```*

# svg - 我可以沿 SVG 路径应用渐变吗？

> ID：14633363
> 
> 赞同：78
> 
> 时间：2013-01-31T19:13:13.270
> 
> 标签：svg, path, gradient

我想在我的网站上放置一个由脚本触发的简单加载指示器。它应该是一个简单的圆弧，它有一个渐变并且在用户等待时正在旋转。我还没有尝试过动画部分，但现在停留在静态样式上。这是我到目前为止所得到的：

```
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"
        width="100" height="100">
        <defs>
            <linearGradient id="grad1">
                <stop offset="0%" stop-color="red"/>
                <stop offset="100%" stop-color="red" stop-opacity="0" />
            </linearGradient>
        </defs>
        <path d="M50 10  A40 40 0 1 0 90 50"
            stroke="url(#grad1)" stroke-width="10" fill="transparent"/>
    </svg>
```

它绘制弧线，从上边缘逆时针到右边缘（270°），但渐变是错误的。不是按照路径使开始（上边缘，0°）不透明而结束（右边缘，270°）透明，而是在屏幕空间中从左到右对弧形笔划的结果图像进行着色。

如何使渐变遵循我的弧形路径？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2016-03-02T05:30:15.233

Mike Bostock 想出了一个办法，虽然这并不容易： [https ://bl.ocks.org/mbostock/4163057](https://bl.ocks.org/mbostock/4163057)

基本上，这种技术用于[`getPointAtLength`](http://www.w3.org/TR/SVG/paths.html#__svg__SVGPathElement__getPointAtLength)将笔画分割成许多短笔画，为每个短笔画指定内插色标，然后对这些色标之间的每个短笔画应用渐变。

如果你能接受挑战，祝你好运；）

**编辑（2019 年 7 月 3 日）：**

[现在有一个库可以帮助你做你正在寻找的东西。](https://github.com/mnsht/gradient-path)不需要使用 D3，但如果您愿意，可以使用。[这是关于 Medium 的教程](https://medium.com/@cereallarceny/getting-gradients-to-follow-along-svg-paths-in-javascript-45357b60bed7)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-31T23:19:05.300

这种渐变在 SVG 中不容易实现，请参阅[SVG angular gradient](https://stackoverflow.com/questions/2465405/svg-angular-gradient)。

此外，`transparent`它不是 SVG 中的有效颜色。你应该`stop-opacity`在这个例子中声明：http: [//jsfiddle.net/WF2CS/](http://jsfiddle.net/WF2CS/)

恐怕最简单的解决方案可能是一系列具有不同不透明度的小弧形路径。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-07-13T04:55:25.400

```
path{
 fill : url(#gradient)
}
```

```
<svg width="660" height="220">
  <defs>
    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%"   stop-color="#05a"/>
      <stop offset="100%" stop-color="#0a5"/>
    </linearGradient>
  </defs>
 <path d="M150 0 L75 200 L225 200 Z" />
</svg>
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-07-03T18:17:37.820

我也遇到了这个问题，所以[我创建了一个库来帮助](https://github.com/mnsht/gradient-path)创建遵循`path`. 如果您愿意，您可以在 Javascript 中单独使用它或与 D3.js 一起使用它。该库 100% 基于 Mike Bostock 在第一个答案中引用的工作，但我已将 D3 作为必需的依赖项删除。

[我还写了一个关于 Medium 的简短教程，描述了背景故事和用法。](https://medium.com/@cereallarceny/getting-gradients-to-follow-along-svg-paths-in-javascript-45357b60bed7).

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2021-09-15T22:47:28.277

CSS 图像模块 - 第 4 级引入了[conic-gradient](https://drafts.csswg.org/css-images-4/#conic-gradients)。根据 MDN，除 IE 外，所有主流浏览器都[支持它。](https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/conic-gradient()#browser_compatibility)

尽管从技术上讲，它不是沿路径的渐变，但由于您的路径是圆形，因此可以通过以下方式实现所需的结果：

```
.loader {
  --size: 7.5rem;
  --stroke-size: .5rem;
  --diff: calc(calc(var(--size)/2) - var(--stroke-size));
  background-image: conic-gradient(transparent 25%, red);
  width: var(--size);
  height: var(--size);
  border-radius: 50%;
  -webkit-mask:radial-gradient(circle var(--diff),transparent 98%,#fff 100%);
          mask:radial-gradient(circle var(--diff),transparent 98%,#fff 100%);
  animation: rotate 1.2s linear infinite;
  margin: 0 auto;
}
@keyframes rotate {
  from {
    transform: rotate(0);
  }
  to {
    transform: rotate(1turn);
  }
}
body {
  background: #f9fcfc url(https://picsum.photos/id/22/1323/880) 100% /cover;
  margin: 0;
  min-height: 100vh;
  padding-top: 2.5rem;
}
 * { box-sizing: border-box; }
```

```
<div class="loader"></div>
```

相关位是

```
background-image: conic-gradient(transparent 25%, red); 
```

**注意：**如果不是很明显，CSS 变量不是必需的，我只是想要一种方法来测试它的多种尺寸，而不必在多个地方修改值。
**注意：**屏蔽内圈也可以使用`<svg />`. 我怀疑它可能比[mask](https://developer.mozilla.org/en-US/docs/Web/CSS/mask)有更好的浏览器支持。但这超出了这个问题的范围。

在发布时，我的示例似乎在最新版本中按预期工作：Chrome、Firefox 和 Edge。没有测试过 Safari。没想到它可以在任何版本的 IE 中工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-03T19:06:22.453

另一种方法是制作两个半圆并对每个笔划应用相反的线性渐变，并确保它们都包含在 ag 元素中。（在我的示例中，组合渐变不是 270 度而是 360。两个半圆垂直堆叠。第一个渐变（应用于顶部半圆的笔划）将是 100-50% 的不透明度，然后下一个将具有 0 % 到 50%。两个梯度都将单位向量设置为 x1,y1,y2=0 和 x2=1，使它们从左到右运行。）然后将 transform=rotate(deg,ctrX,ctrY) 应用于 g。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-10T10:51:27.813

[我设法在https://www.w3schools.com/graphics/svg_grad_radial.asp](https://www.w3schools.com/graphics/svg_grad_radial.asp)之后应用了某种渐变。

例如： [Codepen svg 多路径](https://codepen.io/lucasdibz/pen/abyKgrX)

```
<!DOCTYPE html>
<html>
<body>

<svg height="378" width="378" >
  <defs>
    <radialGradient id="grad1" cx="50%" cy="55%" r="50%">
    <stop offset="90%" style="stop-color:rgb(31, 175, 198); stop-opacity: .5" />
    <stop offset="100%" style="stop-color:rgb(161, 211, 60); stop-opacity: .5" />
    </radialGradient>
  </defs>
  <path d="M92.2871 10.1699C90.3999 25.8964 84.8432 45.0828 82.1173 45.0828C81.3834 45.0828 76.3509 42.986 71.0038 40.4697C62.4067 36.4856 49.3012 32.5016 44.4784 32.5016C43.2202 32.5016 43.8493 34.3888 46.8898 40.5746C51.5029 49.9057 55.6966 64.4789 55.1724 69.5114L54.8579 72.8664L45.422 73.6004C17.9529 75.6972 5.05709 76.9554 5.05709 77.4796C5.05709 77.899 9.67022 82.8266 15.3318 88.593C25.921 99.2871 33.6795 110.715 33.1552 114.699C32.9455 116.167 27.5985 120.57 16.5899 128.224C7.67819 134.41 0.234278 139.966 0.0245907 140.491C-0.185097 141.015 0.968185 141.749 2.64569 142.168C13.864 144.58 18.6868 146.152 22.6709 148.459C28.1227 151.709 33.7843 156.532 36.6151 160.516L38.712 163.451L26.9694 175.089C17.1141 184.944 15.4366 186.937 16.6948 188.09C17.5335 188.824 23.8241 191.235 30.7438 193.332C37.6635 195.429 43.7445 197.631 44.2687 198.155C44.7929 198.679 43.9541 204.026 41.9621 211.365C40.1798 218.18 39.0265 224.156 39.341 224.68C39.8652 225.624 57.1645 224.785 59.9952 223.737C62.6163 222.793 63.6648 225.309 64.3987 233.592C64.8181 238.415 65.4471 242.504 65.8665 242.713C66.7052 243.238 78.4478 238.205 78.4478 237.366C78.4478 237.052 77.0848 234.85 75.4073 232.439C70.5845 225.414 67.3343 218.18 64.2938 208.115C62.826 202.873 60.6243 195.848 59.5759 192.388C58.4226 188.929 57.2693 184.211 57.0596 181.904C55.5918 170.791 55.3821 166.702 56.4306 166.702C56.9548 166.702 57.479 168.484 57.479 170.581C57.5838 175.299 59.8904 187.88 61.4631 192.388C62.0921 194.066 64.0842 200.252 65.8665 206.018C70.1651 219.543 76.3509 231.705 81.6979 237.052C84.2142 239.568 89.666 243.133 94.9082 245.544L103.715 249.633L103.401 253.512L103.086 257.392L79.7059 265.15L56.3257 273.013L53.2852 282.973C51.6077 288.53 46.8898 304.991 42.696 319.669C38.5023 334.242 34.5182 346.823 33.8891 347.452C33.2601 348.081 31.3729 353.743 29.8002 360.138C28.2276 366.429 26.7598 372.51 26.4452 373.454C25.921 375.236 30.1148 375.341 104.554 375.341C179.098 375.341 183.292 375.236 183.292 373.454C183.292 372.51 178.364 367.058 172.283 361.397C166.202 355.735 161.274 350.493 161.274 349.654C161.274 348.92 165.049 345.041 169.557 341.057C181.09 331.202 181.195 330.573 176.477 318.515C168.509 298.281 151.419 267.037 145.128 261.166C143.136 259.279 142.402 257.496 142.402 254.666C142.402 250.367 143.346 249.319 148.693 247.536C154.145 245.754 159.492 241.665 163.162 236.528C166.097 232.439 167.355 231.705 175.428 229.189C180.356 227.616 184.34 225.938 184.34 225.519C184.34 224.995 182.453 222.269 180.146 219.543C175.638 214.091 174.799 210.212 177.84 209.268C178.783 208.954 182.453 208.429 185.913 208.01C189.372 207.696 192.518 207.171 192.937 206.857C193.881 206.437 188.534 191.55 187.276 191.025C186.856 190.816 186.437 189.872 186.437 188.824C186.437 187.566 187.905 186.622 191.679 185.678C198.179 184.001 213.696 176.557 213.696 175.194C213.696 174.565 211.704 173.097 209.293 171.839C195.873 165.024 184.969 157.161 187.171 155.903C187.59 155.693 191.469 154.435 195.663 153.177C199.857 151.919 206.672 149.298 210.865 147.41C218.1 144.16 232.988 135.353 232.358 134.724C231.939 134.41 203.526 122.248 200.8 121.304C199.542 120.78 199.228 120.151 199.752 119.207C200.171 118.369 207.091 111.659 215.059 104.32C222.923 96.8757 229.423 90.4802 229.423 90.0608C229.423 89.2221 222.922 88.0688 203.736 85.3429C196.816 84.2944 190.735 83.246 190.316 82.8266C189.792 82.4072 194.615 73.181 201.01 62.3821C211.39 44.6635 213.382 40.8891 212.333 40.8891C212.124 40.8891 203.526 43.9296 193.252 47.7039C178.259 53.1558 174.17 54.2043 173.122 53.1558C170.815 50.8493 168.613 33.55 168.613 18.0331V3.04048L160.121 7.54876C150.161 12.8958 136.846 23.2753 130.66 30.5096C128.353 33.3403 125.942 35.6469 125.523 35.6469C124.998 35.6469 121.014 30.8241 116.506 24.848C108.748 14.5733 95.6421 6.4671e-06 94.1743 6.4671e-06C93.7549 6.4671e-06 92.9162 4.61313 92.2871 10.1699ZM95.2228 272.908C91.3435 275.949 71.5281 328.266 73.1007 330.992C73.6249 331.935 78.1332 336.234 83.1657 340.638C88.3031 345.041 92.6017 349.13 92.8114 349.759C93.021 350.388 91.7629 352.695 89.9806 354.896C88.3031 357.098 86.8353 358.251 86.8353 357.517C86.8353 356.888 87.7788 355.001 89.037 353.533L91.2387 350.703L81.1737 341.267C74.1492 334.661 71.1087 331.097 71.1087 329.419C71.1087 326.064 83.0609 293.982 90.3999 277.522C92.1823 273.537 93.6501 271.545 94.9082 271.545C96.5857 271.65 96.5857 271.755 95.2228 272.908Z" fill="url(#grad1)"></path>
<path d="M270.733 147.306C241.272 152.653 225.021 164.29 203.948 195.429C199.335 202.139 199.02 202.978 199.02 209.478C199.02 214.51 197.972 219.438 195.246 227.93C190.633 242.294 190.842 245.649 197.447 256.867C200.068 261.271 202.165 265.465 202.165 265.989C202.165 266.618 200.802 268.61 199.02 270.497C193.463 276.473 193.568 285.699 199.335 291.885C202.69 295.345 210.553 298.595 212.65 297.232C213.174 296.918 212.44 294.506 211.077 291.78C209.609 289.159 208.456 286.224 208.561 285.28C208.561 284.232 209.085 284.546 209.714 286.224C211.496 290.103 219.779 302.894 223.868 307.926C231.941 317.991 249.345 328.161 265.596 332.46C270.524 333.718 279.226 334.871 286.565 335.186C293.484 335.5 298.202 336.129 297.049 336.549C290.758 338.75 261.821 334.661 248.506 329.629L241.587 327.008L239.804 329.419C233.199 338.121 225.65 357.937 223.763 371.357L223.239 375.341H288.242C349.681 375.341 353.245 375.236 352.721 373.454C352.407 372.51 350.729 366.219 349.052 359.509C345.382 345.041 342.446 337.807 337.728 331.621C335.841 329.105 334.269 326.484 334.269 325.75C334.373 325.121 336.994 322.604 340.245 320.298C346.116 316.104 354.189 307.612 358.592 300.902C360.06 298.7 362.367 296.918 364.464 296.289C366.246 295.764 369.601 293.563 371.907 291.466C379.142 284.546 379.876 275.11 373.48 269.553C371.278 267.666 370.964 266.723 371.593 263.368C372.012 261.271 372.641 259.279 373.061 258.964C373.48 258.65 374.424 255.609 375.158 252.149C376.206 247.117 376.206 243.238 375.158 232.439C374.424 225.1 373.375 219.124 372.851 219.124C372.327 219.124 372.012 216.188 372.117 212.518C372.327 206.752 371.803 204.97 368.028 197.631C362.996 187.67 355.552 176.767 348.003 168.589C343.39 163.556 340.349 161.564 328.502 155.693C320.115 151.604 311.517 148.144 307.324 147.306C298.622 145.418 280.798 145.418 270.733 147.306Z" fill="url(#grad1)"></path>
<path d="M147.646 261.69C147.646 262.005 149.638 264.94 152.154 268.19C154.67 271.441 158.13 276.578 160.017 279.409C164.945 287.272 176.373 311.805 179.728 321.556C183.397 331.935 183.083 332.669 172.074 342C167.88 345.565 164.421 349.34 164.421 350.178C164.421 351.122 169.138 356.154 174.905 361.606C181.196 367.373 185.389 372.091 185.389 373.349C185.389 375.236 186.228 375.341 200.067 375.341C211.076 375.341 214.746 375.026 214.746 373.978C214.746 369.574 189.059 277.207 186.647 272.804C186.228 271.965 179.518 269.763 171.76 267.771C164.001 265.884 155.928 263.577 153.726 262.634C149.428 260.956 147.646 260.642 147.646 261.69Z" fill="url(#grad1)"></path>
</svg>

</body>
</html>
```

# jquery - 使引导弹出窗口重叠

> ID：14633364
> 
> 赞同：8
> 
> 时间：2013-01-31T19:13:15.013
> 
> 标签：jquery, css, twitter-bootstrap

我的问题是我使用引导程序的弹出窗口作为图像，使用悬停作为触发器，同时我使用的是 Smoothdivscroll ( [http://www.smoothdivscroll.com/#quickdemo](http://www.smoothdivscroll.com/#quickdemo) ) 但问题是，部分弹出框被隐藏。

示例[https://dzwonsemrish7.cloudfront.net/items/2a3e0g0J1K0O3l3m0u2C/Screen%20Shot%202013-01-31%20at%2020.01.06.png?v=cf069cc3](https://dzwonsemrish7.cloudfront.net/items/2a3e0g0J1K0O3l3m0u2C/Screen%20Shot%202013-01-31%20at%2020.01.06.png?v=cf069cc3) 如您所见，弹出框（右侧）的一部分是隐藏在 div 下。屏幕截图中的问题很小，但是当我将其放在最后一张图像上时，您根本看不到它。

我尝试更改 z-index，但没有奏效。

Popover 的默认代码：

```
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1010;
  display: none;
  width: 236px;
  padding: 1px;
  text-align: left;
  white-space: normal;
  background-color: #ffffff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  -webkit-border-radius: 6px;
     -moz-border-radius: 6px;
          border-radius: 6px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
     -moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
          box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  -webkit-background-clip: padding-box;
     -moz-background-clip: padding;
          background-clip: padding-box;
} 
```

SmoothDivScroll 默认代码：

```
div.scrollWrapper {
 position: relative;
 overflow: hidden;
 width: 100%;
 height: 100%;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-01T10:30:48.543

由于对工具提示和弹出框的包含方式进行了一些更改（请参阅[此提交](https://github.com/twitter/bootstrap/commit/88b1e44dd61afd8f08761346555521bd216ed73a#L2L124)），因此存在有关溢出元素的错误。

我们可以调整您的标记以使其正常工作，其中一些`overflow: visible`但修复将在下一个版本（2.3.0）中可用，如[本次提交](https://github.com/twitter/bootstrap/commit/d594d6377a7e9cda399c25a450b0d27df704d939#L0L129)所示。

简而言之，您可以下载下一个版本或将提交的更改应用于您的文件，以允许您的弹出框像这样使用：

```
$('.popover').popover({
    container: 'body'
}); 
```

或者使用数据属性：`data-container="body"`。

# android - 如何强制 webview 应用程序打开其中的链接，而不是根据域在默认的 android 浏览器中打开它们？

> ID：14633367
> 
> 赞同：2
> 
> 时间：2013-01-31T19:13:20.280
> 
> 标签：android, webview

我刚刚开始开发 android 应用程序，所以我需要一些易于理解的 webview 应用程序帮助。所以，这是我的具体问题：

如何强制 webview 应用程序在其中打开链接，而不是根据域在默认浏览器中打开它们？

请附上此代码的编辑/扩展版本，并附上您的答案：

```
public class WebViewActivity extends Activity {

private WebView webView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.webview);

    webView = (WebView) findViewById(R.id.webView1);
    webView.getSettings().setJavaScriptEnabled(true);
    webView.loadUrl("www.example.com"); 
```

我想在 webview 中打开其内容的域是：www.qwerty.com 所有其他链接都应该由默认浏览器打开。

提前谢谢了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:21:23.327

您必须创建一个`WebViewClient`：

```
public class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        view.loadUrl(url);
        return true;
    }
} 
```

然后`WebView`像这样设置它：

```
webview.setWebViewClient(new MyWebViewClient()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-17T13:35:24.407

您必须评估在 custom 中传递的 url `WebViewClient`。*布尔值* 有一个真值和`shouldOverrideUrlLoading`一个假值。当为**true**时，您将 url 发送到浏览器，当为**false**时，您将留在`WebView`.

```
public class MyWebViewClient extends WebViewClient {
@Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
    if (Uri.parse(url).getHost().equals("www.qwerty.com")) {
        /* 
         This is my web site, so do not override; 
         let my WebView load the page
        */
        return false;
    }
       /* 
         Otherwise, the link is not for a page on my site, 
         so launch another Activity that handles URLs
       */
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
        startActivity(intent);
        return true;    
    }
} 
```

然后从你的活动中你确实调用了新的`WebClient`

```
webview.setWebViewClient(new MyWebViewClient()); 
```

# c# - 从 XSD 创建一个类

> ID：14633372
> 
> 赞同：2
> 
> 时间：2013-01-31T19:13:27.757
> 
> 标签：c#, xml, web-services, xsd

这是我目前的情况。我不得不打破如何进行 Web 服务调用的标准。我们有 60 多个 WSDL 可以连接，并且名称会根据参数进行更改。我使用 WebClient 动态创建了 Web 服务调用并手动构建了信封（决定这样做而不是由上层管理人员添加每个 Web 服务）。我得到一个字符串响应，其中包含与 XSD 匹配的有效 XML。我试图弄清楚如何创建一个类来动态引用字段而不是每个 WSDL 的类（基于所使用的 XSD 构建一个类）。这是我正在做的事情：

```
public string results;

using (WebClient client = new WebClient())
{
    string soapENV = @"http://schemas.xmlsoap.org/soap/envelope/";
    var payload = @"<?xml version=""1.0"" encoding=""utf-8""?>" +
                   "<SOAP-ENV:Envelope xmlns:SOAP-ENV='" + soapENV + "'>" +
                     "<SOAP-ENV:Header/>" + 
                       "<SOAP-ENV:Body>" + 
                         "<" + myParams.requestName + " xmlns='" +    
                             myParams.requestNamespace + "'>" +
                           "<MtvnSvcVer>1.0</MtvnSvcVer>" + 
                           "<MsgUUID>" + UUID + "</MsgUUID>" + 
                           "<PrcsParms>" + 
                           "<SrcID>" + currentVendorID + "</SrcID>" + 
                           "</PrcsParms>"
                           ................
                       "</SOAP-ENV:Body>" + 
                     "</SOAP-ENV:Envelope>";
   this.results = client.UploadString  (URL, payload);
} 
```

为了节省时间和空间，我取出了一些 XML 标签。XSD 响应具有与上述相同的 XML 标记值。然后我调用它来执行如下：

```
string results = connectwareService.InvokeConnectWare(); 
```

返回的结果如下所示：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Body>        
    <DPNmeAddrInqMtvnSvcRes  xmlns="mtvnCWDPNmeAddrInqSvcRes"> 
     <MtvnSvcVer>1.0</MtvnSvcVer>
     <MsgUUID>DATA HERE</MsgUUID>           
      <Svc>
       <SvcParms>
         <ApplID>DATA HERE</ApplID>
         <SvcID>DATA HERE</SvcID>
         <SvcVer>1.0</SvcVer>
         <RqstUUID>DATA HERE</RqstUUID>
       </SvcParms>
       <MsgData>
       <DPNmeAddrInqResData xmlns="mtvnCWDPNmeAddrInqResData">
         <E20007>DATA HERE</E20007>
        ........    
   </soapenv:Body> 
</soapenv:Envelope> 
```

代码中有没有办法做到这一点？我一直看到人们提到使用 xsd.exe。可以在后面的代码中执行吗？我在想我可以通读并填充一个通用类，其中标签名称作为名称，数据作为值作为最后的手段，但必须有一种方法可以在代码中动态生成它。我想我可以做的另一种方法是读取所有 60 多个 wsdls 并运行 xsd.exe 来构建所需的类？

另外，仅供参考 - 我正在将旧的 Cold Fusion 代码转换为 C#，并且我正在尝试找出如何替换其“ConvertXmlToStruct”方法。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:21:29.367

xsd.exe 仅运行一次以构建代表 XSD 中定义的对象的类文件。然后，您使用 XmlSerializer 类将 XML 实际转换（也称为反序列化）到 c# 类。

那里有很多关于在 C# 中反序列化 XML 的链接：

[如何在 C# 中使用 xsd？](https://stackoverflow.com/questions/9003952/how-to-use-xsd-in-c)

[http://msdn.microsoft.com/en-us/library/ms950721.aspx](http://msdn.microsoft.com/en-us/library/ms950721.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-13T12:53:51.260

XSD.exe 工作得很好。请查看我在下面使用的代码以使其工作：

```
Process process = new Process();
        string arguments = @" " + row["OutputFileDirectory"].ToString() + row["XSDMainBuildName"].ToString() + " " + row["OutputFileDirectory"].ToString() + row["ImportNames"].ToString() + " /c /language:CS /out:" + row["OutputClassDirectory"].ToString() + " /namespace:" + row["Namespace"].ToString();
        string fileNameXSD = "";
        if (Directory.Exists(@"C:\Program Files (x86)\Microsoft SDKs\Windows\v6.0A\bin"))
        {
            fileNameXSD = @"C:\Program Files (x86)\Microsoft SDKs\Windows\v6.0A\bin\xsd.exe";
        }
        else
        {
            fileNameXSD = @"C:\Program Files\Microsoft.NET\SDK\v2.0\Bin\xsd.exe";
        }
        process.StartInfo.Arguments = arguments;
        process.StartInfo.FileName = fileNameXSD;
        process.StartInfo.UseShellExecute = false;
        process.StartInfo.RedirectStandardError = true;
        process.StartInfo.RedirectStandardOutput = true;
        process.Start();
        string output = process.StandardOutput.ReadToEnd();
        string error = process.StandardError.ReadToEnd();
        if (!DataValidator.ValidateFieldIsBlank(error))
        {
            lblOutputResults.Text = error;
        }
        process.WaitForExit();
        process.Close(); 
```

这是放在我的网络表单后面的代码中的。这样做是为我选择构建的每个项目启动 xsd.exe 进程。这帮助我们公司解决了很多问题。感谢所有帮助并提供更多信息的人。

# go - 当没有准备好读取的频道时，如何什么都不做？

> ID：14633373
> 
> 赞同：5
> 
> 时间：2013-01-31T19:13:34.747
> 
> 标签：go, channel

让我们以 GoTour 中的这个示例为例，因为它说明了我仅在有事件时才处理 SDL 事件的问题。

```
package main

import (
"fmt"
"time"
)

func main() {
tick := time.Tick(1e8)
boom := time.After(5e8)
for {
    select {
    case <-tick:
        fmt.Println("tick.")
    case <-boom:
        fmt.Println("BOOM!")
        return
    default:
        fmt.Println("    .")
        time.Sleep(5e7)
    }
}
} 
```

这行得通。但是如果我不想在默认情况下打印或睡眠，而只想继续循环呢？我试过这个：

```
 case <-boom:
        fmt.Println("BOOM!")
        return
    default: // Nothing here.
    }
}
} 
```

但它会阻塞。

我在这里和那里看到过关于goroutines调度的一句话，但我没有理解它们。所以我想我有两个问题：

1）为什么会阻塞？

2）如何让它不做任何阻塞？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T20:29:44.530

[您的原始示例](http://play.golang.org/p/RvBjlVDT1h)产生了这个

```
 .
    .
tick.
    .
    .
tick.
    .
    .
tick.
    .
    .
tick.
    .
    .
tick.
BOOM! 
```

而[你的第二个例子](http://play.golang.org/p/TAt6g5OugH)产生了这个

```
[process took too long] 
```

不同之处在于您在`default`案件中所做的事情。案例`default`始终准备好运行，因此`select`其中包含默认语句的案例永远不会阻塞。第二个示例围绕循环运行，不断选择准备运行的分支之一（案例或默认）。您现在想知道为什么计时器从不触发。那是因为 goroutines 不是预先安排好的。所以因为下面的循环从不做任何 IO，所以时间滴答永远不会触发。

```
for {
    select {
        // whatever
        default:
    }
} 
```

有很多方法可以解决这个问题。首先，您可以像在第一个示例中那样放入一些 IO。或者你可以放一个[runtime.Gosched()](http://golang.org/pkg/runtime/#Gosched)。或者你可以允许 go 运行时使用多个线程和[runtime.GOMAXPROCS(2)](http://golang.org/pkg/runtime/#GOMAXPROCS)所有这些都可以工作。

恕我直言，最好的方法是完全[像这样](http://play.golang.org/p/VRGc9lXy1L)省略默认语句。没有默认语句的 select 将阻塞，直到其中一个 case 语句准备好。如果你想做一些后台处理（你在默认语句中做的）然后启动一个 goroutine - 这就是 go 方式！

事实上，我已经在 select 语句中看到了很多关于 default 的问题，以至于我很想说永远不要使用它们。

# python - 如何将我的原始数据与集群数据关联起来

> ID：14633376
> 
> 赞同：1
> 
> 时间：2013-01-31T19:13:47.383
> 
> 标签：python, numpy, scipy, cluster-analysis, hierarchical-clustering

我有一个距离矩阵表示成对元素的距离矩阵，例如

```
 A B C D .....
A   n1 n2 n3
B n1    
C n2 n4
D n3 n5 ....... 
E......... 
```

我输入数组，如聚类

```
 arry=  [ 0 n1, n2, n3..
   n1.......
   n2 n4
   n3 n5 ]

Y=sch.linkage(arry,'single')
cutoff=1e-6
T=sch.fcluster(Y, cutoff,'distance')
print T

Z=sch.dendrogram(Y, color_threshold=cutoff) 
```

[我的fcluster](https://stackoverflow.com/questions/7724635/clustering-with-scipy-clusters-via-distance-matrix-how-to-get-back-the-origin)输出类似于 [ 4 10 12 1 5 13 2 11 1 7 8 3 14 6 10 16 9 15 1 7] 来自其他人的先前海报

我了解输出 T[i] 仅显示集群中元素的数量......我如何将原始元素 A、B、C、D、E..... 元素与集群结果和树状图联系起来？并将它们正确地放入我的数字中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:12:37.750

“*我理解输出 T[i] 只表示集群中元素的数量*......”

`T[j]`是第 j 个数据点的“簇号”。也就是说，`fcluster`将数据点分配给集群。因此，例如，如果有五个数据点，`fcluster`并将第一个、第二个和最后一个放在集群 1 中，而将其他数据点放在集群 2 中，则返回值`fcluster`将是`array([1, 1, 2, 2, 1])`。

这是一个演示，展示了如何将这些数据分开。为方便起见，我使用了和`fclusterdata`的组合来代替。 返回与.`linkage``fcluster``fclusterdata``fcluster`

```
import numpy as np

def cluster_indices(cluster_assignments):
    n = cluster_assignments.max()
    indices = []
    for cluster_number in range(1, n + 1):
        indices.append(np.where(cluster_assignments == cluster_number)[0])
    return indices

if __name__ == "__main__":
    from scipy.cluster.hierarchy import fclusterdata

    # Make some test data.
    data = np.random.rand(15,2)

    # Compute the clusters.
    cutoff = 1.0
    cluster_assignments = fclusterdata(data, cutoff)

    # Print the indices of the data points in each cluster.
    num_clusters = cluster_assignments.max()
    print "%d clusters" % num_clusters
    indices = cluster_indices(cluster_assignments)
    for k, ind in enumerate(indices):
        print "cluster", k + 1, "is", ind 
```

典型输出：

```
4 clusters
cluster 1 is [ 0  1  6  8 10 13 14]
cluster 2 is [ 3  4  5  7 11 12]
cluster 3 is [9]
cluster 4 is [2] 
```

# jquery - jQuery.stop(1,1) 启动下一个动画，但不停止(1,0)

> ID：14633382
> 
> 赞同：1
> 
> 时间：2013-01-31T19:14:08.057
> 
> 标签：jquery

让我们看这个脚本：

```
$('a').hover(function() {
    $('div').stop(c,j).fadeIn();
}, function() {
    $('div').stop(c,j).fadeOut();
}); 
```

随着`c=0,j=0`，如果我`a`重复几次，我的 div 淡入淡出，然后...... yerk。
有了`c=1,j=1`，它几乎可以满足我的要求，但是由于`jumpToEnd`参数的原因，我们得到了这种闪烁效果，而且看起来有问题。
所以最后，我想要的是`c=0,j=1`，但是如果我进入，然后快速退出并重新进入，动画就会停止，下一个淡入淡出功能将不会启动，我的 div 是半透明的。为什么 ？

[另一个视觉示例。](http://jsfiddle.net/Didjo/4v8Uk/)

我经常遇到这个问题，想知道为什么我在上面找不到任何东西。（最后我记得是对 jQuery`stop()`页面的评论，但现在已删除评论。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:23:39.923

这是所有不同用法之间的更好比较：http `.stop()`: [//jsfiddle.net/4v8Uk/13/](http://jsfiddle.net/4v8Uk/13/)

```
<div data-one="0" data-two="0" id="a">a</div>
<div data-one="1" data-two="0" id="b">b</div>
<div data-one="1" data-two="1" id="c">c</div>
<div data-one="0" data-two="1" id="d">d</div> 
```

* * *

```
$("div").hover(function(){
    var d = $(this).data();
    $(this).stop(d.one,d.two).toggle("slow");
}); 
```

选项 a 和 b 似乎更接近您正在寻找的内容。（0,0 和 1,0）

更新：我仍然没有一个明确的答案来解释它为什么会发生，尽管我相信它发生是因为 jQuery 看到了已经显示的元素，因此它没有显示它。为什么这不会影响 .toggle() 我不知道。

但是，您可以通过使用 .animate 重新创建动画来修复它。

[http://jsfiddle.net/4v8Uk/17/](http://jsfiddle.net/4v8Uk/17/)

```
$("div").hover(function(){
    var d = $(this).data();
    $(this).stop(d.one,d.two).animate({"opacity":"0", "height":"0px", "width":"0px"},"slow");
}, function(){
    var d = $(this).data();
    $(this).stop(d.one,d.two).animate({"opacity":"1", "height":"100px", "width":"100px"},"slow");
}); 
```

# c# - 序列化 JSON 随机名称

> ID：14633385
> 
> 赞同：2
> 
> 时间：2013-01-31T19:14:31.567
> 
> 标签：c#, json, serialization

```
{
    "123353054": "value here",
    "username": "value here"
} 
```

有没有办法在 C# 中序列化它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:19:54.807

您可以将其序列化为动态类或创建静态类，并使用 JavaScriptSerializer 将其反序列化为 C# 并将其用于序列化。

如果您想在 C# 中找到所需的结构，以便 Serializer 将其序列化为 JavaScript，请创建一个动态变量，然后序列化到该变量并在调试中检查它，它将显示静态结构。

如果您需要，我可以举例说明所需的代码。

```
using System;
using System.Web.Script.Serialization;

namespace JSON_Serialization_Demo
{
    class Program
    {
        static void Main(string[] args)
        {
            const string json = "{'123353054': 'value here','username': 'value here'}";
            var jss = new JavaScriptSerializer();

            var csobj = jss.Deserialize<dynamic>(json);
            Console.WriteLine(csobj.GetType());
            Console.Read();
        }
    }
} 
```

测试这表明您的项目是 C# 中的字典，以便正确序列化回 JSON。

# php - 将数据库中的所有记录迭代到一个表中

> ID：14633388
> 
> 赞同：1
> 
> 时间：2013-01-31T19:14:50.387
> 
> 标签：php, html, mysql

所以，我在数据库中有 3 个表：

在**医生**表中：

```
id (PK)
doctor_name 
```

在**患者**表中：

```
id (PK)
patient_name
patient_unit
patient_doctor_id (FK) 
```

在**报告**表中：

```
id (PK)
report_issue
report_result
report_patient_id (FK) 
```

如您所见，**患者**以**医生**的身份作为外键，而**报告**以**患者**的身份作为外键。

所以，一个医生有很多病人，一个病人有很多报告。

我想做的是通过使用外键作为对各自名称和报告的引用，将所有这些表显示到 HTML 表中。

如何迭代数据库中的这些记录以将其显示在表中？在这种情况下我使用什么 MySQL 查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:26:15.953

尝试这样的事情：

```
SELECT * FROM DOCTOR

LEFT JOIN PATIENT
ON (DOCTOR.ID = PATIENT.PATIENT_DOCTOR_ID)

LEFT JOIN REPORT
ON (PATIENT.ID = REPORT.REPORT_PATIENT_ID) 
```

如果您想要特定报告，请在末尾添加此条件：

```
WHERE REPORT.ID = REPORT_NUMBER 
```

萨卢多斯。

# scala - 有没有一种方便的方法来初始化 Scala 中的字符串列表？

> ID：14633390
> 
> 赞同：3
> 
> 时间：2013-01-31T19:15:01.783
> 
> 标签：scala

在 Perl 我可以做

```
my @l = qw( str1 str2 str3 str4 ) 
```

在红宝石中

```
l = %w{ str1 str2 str3 str4 } 
```

但在 Scala 中，我似乎陷入了困境

```
val l = List( "str1", "str2", "str3", "str4" ) 
```

我真的需要所有这些`"`s 和`,`s 吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-31T19:33:45.373

你可以做

```
implicit class StringList(val sc: StringContext) extends AnyVal {
  def qw(): List[String] = 
    sc.parts.flatMap(_.split(' '))(collection.breakOut)
}

qw"str1 str2 str3" 
```

或通过隐式类：

```
implicit class StringList(val s: String) extends AnyVal {
  def qw: List[String] = s.split(' ').toList
}

"str1 str2 str3".qw 
```

（两者都需要 Scala 2.10，尽管第二个可以适应 Scala 2.9）

# wcf - 在 azure 中重新发布服务

> ID：14633397
> 
> 赞同：3
> 
> 时间：2013-01-31T19:15:36.867
> 
> 标签：wcf, service, azure, cloud, endpoint

我已经向天蓝色云发布了一项服务。我想知道我是否添加了新的端点和更新服务以使其成为 RESTful，我是否必须再次发布它或者它会自动在云中更新？通常，何时必须重新发布服务？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:44:56.743

是的，当您要向 Windows Azure 云服务添加新端点时，您的服务配置和服务定义将更改以包含此修改。基于此更改，您将重新打包您的应用程序并使用“升级”方法进行部署。当您的更新包将被部署时，您的实例将关闭，然后使用更新的端点设置重新配置端点在配置时可用。

如果有任何仅限于服务配置的更改，可以通过更新服务配置直接在门户网站上进行更新。

每当您进行代码更改或任何修改服务定义的应用程序更改时，您都需要重新打包应用程序并重新部署它。还有一些警告，但总的来说，上面确实涵盖了您的问题。

# c# - 基于 XSD 架构的 Wpf XmlDataProvider 验证

> ID：14633408
> 
> 赞同：3
> 
> 时间：2013-01-31T19:16:18.413
> 
> 标签：c#, wpf, xaml, validation, xamlreader

我正在编写 ac#（如果我找到原因，则为 3.5 或 4）WPF 应用程序，它使用 XamlReader 动态加载 XAML 片段以显示可自定义的 UI。此 UI 在显示之前已绑定到 XmlDataProvider，并且似乎工作得很好。

我一直在尝试找出是否可以让数据源（指向 XML 文档的 XmlDataProvider）自动验证文档的 XSD 架构？

澄清一下 - 由于应用程序的多变性质，我试图避免编写任何自定义验证规则。XSD 架构具有指定的限制（例如正则表达式或最大长度约束），我希望我的 UI 以与 Winforms 错误提供程序类似的方式响应这些限制。

任何帮助，将不胜感激！

（顺便说一句 - 将使用 XmlDataProvider 进行标记，但由于信誉请求而无法创建新标记）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T09:10:02.190

我遇到了类似的问题：动态加载 XAML 并验证用户输入。但在我的情况下，我有一个全局`DataContext`并且所有加载控件都绑定到该上下文。当执行验证操作时，例如用户放置按钮“验证”数据，`DataContext`序列化为 XML，然后我使用 XSLT 从这个 XML 获取错误标签，但我认为如果你可以序列化`DataContext`该 XSD，你可以使用 XSD。

我的步骤：

1.  加载 Xaml 并将我的对象设置为容器`DataContext`

    ```
    String xaml="some xaml";
    MyData myData=new MyData();
    TextReader textReader = new StringReader(CardContext.Xaml);
    XmlReader xmlReader = XmlReader.Create(textReader);
    //setting DataContext for panel named 'content'
    this.content.DataContext = myData;
    FrameworkElement myContent = (FrameworkElement) XamlReader.Load(xmlReader);
    this.content.Children.Clear();
    this.content.Children.Add(myContent);
    InitMyComponents(this.content); 
    ```

2.  xaml 中的控件绑定到 DataContext。DataContext 是类 MyData 像这样：

    ```
    public class MyData
    {
        IDictionary<String, MyControl> MyControls{get;set;}
        ....
    } 
    ```

    在哪里

    ```
    class MyControl
    {
       String Id{get;set;}
       String Name{get;set;}
       String Value{get;set;}
    } 
    ```

    获取控件的绑定

    ```
    public static  Binding GetValueBinding(MyControl control)
    {
       Binding valueBinding = new Binding();
       valueBinding.Mode = BindingMode.TwoWay;
       valueBinding.Path = new PropertyPath("MyControls["+control.Id+"].Value");
       return valueBinding;
    } 
    ```

3.  用户使用控件并更改某些值。

4.  当用户需要验证时，我将数据放入名为 MyMetaData 的 XSD 模式中（在该模式中，我有表 MyControls）。

    ```
    MyMetaData _myMetaData;

    public void PushData(MyData myData)
        {

            foreach (MyControl control in myData.MyControls)
            {
             //fill table from xsd schema
       this._myMetaData.MyControls.AddMyControlsRow(control.Id,control.Name,control.Value);

            }

            this._myMetaData.AcceptChanges();
        } 
    ```

5.  从 DataTable 获取 XML

    ```
    this._myMetaData.MyControls.GetXml() 
    ```

6.  使用 xslt 验证 XML

    ```
    XslCompiledTransform xslCompiledTransform = new XslCompiledTransform(); 
    String xml = "some xml";
    TextReader textReader = new StringReader(xml );
    XmlReader xmlReader = XmlReader.Create(textReader);
    StringBuilder validationResult = new StringBuilder();
    XmlWriter xmlWriter = XmlWriter.Create(validationResult);
    //aply xslt (xslt return tags with error description and control Id)
    xslCompiledTransform.Transform(xmlReader, xmlWriter);
    //parsing result tags
    IList<ValidationError> parsedResult = ParseValidationResult(validationResult.ToString()); 
    ```

7.  查找显示错误信息的控件和执行方法

    ```
    DependencyObject errorSource = LogicalTreeHelper.FindLogicalNode(this.content, error.Identifier);
    if (errorSource == null)
        return;
    if (errorSource is MyControl)
       (errorSource as MyControl).ShowErrorInfo(error.ErrorText); 
    ```

这是我的算法，但如果您对 XSD 架构有一些限制，当您将数据放入`DataTable`.

# php - 如何计算PHP中两个日期时间之间的月数

> ID：14633409
> 
> 赞同：0
> 
> 时间：2013-01-31T19:16:18.117
> 
> 标签：php, date, datetime

> **可能重复：**
> [在 php 中查找月份差异？](https://stackoverflow.com/questions/2681548/find-month-difference-in-php)

说，我有 2012-03-01 和 2013-02-01 保存在数据库中。在计算两者之间的月数时，我想得到 12 个月而不是确切的天数或确切的月数（例如 11.92 个月） 如何在 php 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:18:12.493

[DateTime](http://www.php.net/manual/en/book.datetime.php)让这一切变得简单（需要 PHP 5.3 或更高版本）

```
$datetime1 = new DateTime('2012-03-01');
$datetime2 = new DateTime('2013-02-01');
$interval = $datetime2->diff($datetime1);
echo (($interval->format('%y') * 12) + $interval->format('%m')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:19:45.623

试试这个：

```
<?php
$d1 = date_create('2013-01-31');
$d2= date_create('2013-05-12');
$interval= date_diff($d1, $d2);
echo $interval->format('%m months');
?> 
```

# blackberry - 粗体 9900 的工具栏

> ID：14633418
> 
> 赞同：1
> 
> 时间：2013-01-31T19:17:08.283
> 
> 标签：blackberry, toolbar, blackberry-eclipse-plugin, blackberry-jde

我们可以在黑莓粗体 9900 屏幕上添加自定义工具栏吗？

我已经尝试过了，但是如何访问这些按钮（因为它不是触摸屏）？

如果工具栏不兼容，您能建议任何替代选项吗？

# java - 如何读取 java 属性文件并获取其值？

> ID：14633421
> 
> 赞同：0
> 
> 时间：2013-01-31T19:17:22.363
> 
> 标签：java, properties

在 Ruby 中，我有一个**sample.yml**文件，如下所示，

```
1_Group1:
   path:asdf
   filename:zxcv

2_Group2:
  path:qwer
  filename:poiu
etc etc............ 
```

现在我需要有**Example.properties**文件 Java，它应该包含上面的数据。

使用 Java，我想阅读**Example.properties**文件。

然后需要根据组数对内容进行迭代，得到对应的“路径”和“文件名”值。

例如：如果有 5 个组.. Group1,Group2....Group5 那么我需要迭代

```
 for(int i=0; i< noofgroups(5);i++){
            ........................
           String slave =  aaa.getString("path");
            aaa.getString("filename");
        } 
```

像这样我需要获取每个路径和文件名。

现在我有**Example.properties**如下，

```
 path:asdf
   filename:zxcv 
```

它正在工作（我可以读取并获取值）

但我需要有可能作为“路径”和“文件名称”的键。所以我需要将它们分组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:29:41.443

如果你想使用`yaml`格式，你可以找到一个[yamlbeans](http://code.google.com/p/yamlbeans/)

你可以像这样使用它：

```
YamlReader reader = new YamlReader(new FileReader("sample.yml"));
Map map = (Map)reader.read();
System.out.println(map.get("1_Group1")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:39:59.817

有很多方法可以解决这个问题；最自然的可能是使用自然分层的格式，如 YAML、JSON 或 XML。

另一种选择是使用[Commons Configuration 分层配置](http://commons.apache.org/configuration/userguide/howto_xml.html#Hierarchical_properties)技术之一，例如[分层 INI 样式](http://commons.apache.org/configuration/apidocs/org/apache/commons/configuration/HierarchicalINIConfiguration.html)。

如果您想使用“纯”属性文件，我建议您只读取您的属性，将属性名称拆分为句点，然后存储到地图或类中，这样您就可以：

```
1_Group1.path=asdf
1_Group1.filename:zxcv

2_Group2.path=qwer
2_Group2.filename=poiu 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T20:00:11.823

您可以通过`java.utils.Properties`以下方式使用：

```
public static void loadPropertiesAndParse() {
    Properties props = new Properties();
    String propsFilename = "path_to_props_file";
    FileInputStream in = new FileInputStream(propsFilename);
    props.load(in);
    Enumeration en = props.keys();
    while (en.hasMoreElements()) {
        String tmpValue = (String) en.nextElement();
        String path = tmpValue.substring(0, tmpValue.lastIndexOf(File.separator)); // Get the path
        String filename = tmpValue.substring(tmpValue.lastIndexOf(File.separator) + 1, tmpValue.length()); // Get the filename
    }
} 
```

您的`properties`文件将如下所示：

```
key_1=path_with_file_1
key_2=path_with_file_2 
```

# distributed-system - 分布式系统 (DDD) 中的领域事件和命令

> ID：14633424
> 
> 赞同：2
> 
> 时间：2013-01-31T19:17:25.380
> 
> 标签：distributed-system, domain-events

可以说我有分布式架构（客户端-服务器）。在客户端有**ServerEntity**类，在客户端有它的**ClientEntity**类。我希望**ClientEntity**只是从**ServerEntity**请求一些数据。我最近开始学习 DDD 方法，实际上我喜欢领域事件，所以我选择了它。这是我对未来实施的简化期望：

1.  ClientEntity 创建命令 RequestDataCommand 并发布它（例如通过 MessageBus）
2.  客户端的 ApplicationLayer 获取此命令，将其连接起来并发送到服务器
3.  Server 的 ApplicationLayer 接收命令并将命令推送到 MessageBus
4.  ServerEntity 接收命令并发布带有一些数据的域事件
5.  服务器的 ApplicationLayer 获取此事件，连接它并发送到客户端
6.  客户端的 ApplicationLayer 接收事件并将命令推送到 DomainEventManager
7.  ClientEntity 订阅了该事件，当接收到它时，它会更改一些内部状态。

上述方法的缺点是我们最终会得到几十个命令类。

另一方面，还有另一种选择：我们创建一些域服务接口，如 IRequestDataService，并将其作为 ClientEntity 的依赖项。因此我们不需要创建命令类并将其传递给消息总线，我们只需从 IRequestDataService 调用适当的方法。来自服务器的响应作为域事件被接收，就像前面的例子一样。

第二种方法的缺点是我们使用服务只是发送命令，在我看来应该只执行同步操作。

哪种方法更好，我认为客户端-服务器通信的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-11T12:40:52.490

您的 RequestDataCommand 在我看来不像是命令。

命令是使用 UL 的命令式指令，它会更改系统的状态。请求数据不会改变状态，所以它不应该是一个命令。

您的第二种方法遇到了类似的问题。对 IRequestDataService 的调用不应更改服务器上的状态。没有状态变化意味着不应该触发任何事件，至少在“正常” DDD 中是这样。

我的印象是，您正在尝试使用您拥有的基础设施（事件、消息总线，...）来做一些您不应该做的事情。

在我看来，对于读取数据，更好的选择是绕过大部分领域逻辑，以最简单直接的方式读取数据。看看 CQRS（[http://martinfowler.com/bliki/CQRS.html](http://martinfowler.com/bliki/CQRS.html)是一个好的开始）

# protocols - 信号R。为什么要向客户发送组？

> ID：14633426
> 
> 赞同：0
> 
> 时间：2013-01-31T19:17:31.567
> 
> 标签：protocols, signalr

我正在查看客户端和服务器之间的 SignalR 流量。

为什么将加入群组的信息发送给客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:41:46.470

SignalR 将组发送到客户端有两个原因。

1.  当客户端重新连接时，它可能不再是它曾经所在的组的一部分，因此它需要重新加入它们。
2.  在横向扩展的情况下，当前连接到服务器需要知道客户端所在的组。

希望这可以帮助！

# record - 在 Navicat 中复制记录的简单方法

> ID：14633428
> 
> 赞同：2
> 
> 时间：2013-01-31T19:17:43.937
> 
> 标签：record, navicat

自然的本能是复制/粘贴整行，就像在 MS Excel 或其他电子表格应用程序中所做的那样。

但：

1.  唯一主键/唯一索引字段不能重复。
2.  如果其中一个字段中有换行符（例如一段 HTML 代码），它会尝试创建多个新记录。

第一个问题可以通过暂时关闭索引来相对快速地解决。然而，#2 是颈部疼痛。有什么想法吗？

当然我可以[使用查询](https://stackoverflow.com/questions/9670731/quickest-way-to-duplicate-a-mysql-record)。但问题是关于 Navicat 的 GUI。

另外，如果它很重要，我使用 Navicat for MySQL v9.0.8 Enterprise。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-16T13:04:59.170

我正在使用 Navicat 11，感觉在某些早期版本中这可能不是那么容易（甚至不可能）。要在 Navicat 11 中执行此操作，请访问要在其中复制记录的表，以便您可以看到数据行。右键单击要复制的行首的小阴影矩形，在弹出菜单中左键单击“复制”。单击您在窗口底部看到的“+”。右键单击新的空行的最左侧字段，然后左键单击“粘贴”。如果您的新记录违反了唯一键规则（通常会这样），只需修改新创建的记录，例如单击自动递增键的字段并对其进行编辑以获得下一个可用值。

编辑：这在 Navicat 7 和更高版本中显然是可能的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-05T05:40:38.077

坦率地说，我更喜欢 Heidisql 而不是 Heidisql 中的 Navicat，您可以仅使用插入键复制许多行，但在 Navicate 中没有简单的方法可以做到这一点 [https://stackoverflow.com/a/18828794/3562771](https://stackoverflow.com/a/18828794/3562771)

# javascript - js，如何从元素中获取选择器

> ID：14633431
> 
> 赞同：0
> 
> 时间：2013-01-31T19:17:57.460
> 
> 标签：javascript, jquery

我不确定我的问题标题是否正确，但我想在下面问一个问题

```
<div title="A"></div>

var a = $([title=A]);

//if I only know a, how can I get what is referring here made a, 
//or command I use can get out put of the referring. 
//This case the out put will be '[title=A]' 
```

我不是要求`a.attr('title');`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:22:36.040

您可以使用`selector`jQuery 对象中的属性来获取使用的选择器。

```
var a = $('[title=A]');
alert(a.selector);  //will alert [title=A] 
```

**演示：http:** [//jsfiddle.net/Zz4MW/](http://jsfiddle.net/Zz4MW/)

**注意：**`selector`请谨慎使用属性，因为它是供内部使用的。请参阅[为什么 jQuery 中的 .selector 属性不存储有效的选择器值？](https://stackoverflow.com/questions/12426622/why-does-the-selector-property-in-jquery-not-store-a-valid-selector-value)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:32:40.850

```
var a = $('[title=A]');
console.log(a.get()[0]); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Zz4MW/1/)**

有关.get() 的更多信息，请参阅[http://api.jquery.com/get/](http://api.jquery.com/get/)

# ruby-on-rails - 具有嵌入式 ID 和侧载的 Ember-Data 和 Active Model Serializers 的 has_many 配置

> ID：14633432
> 
> 赞同：6
> 
> 时间：2013-01-31T19:18:04.060
> 
> 标签：ruby-on-rails, ember.js, ember-data, active-model-serializers

我知道 Ember-Data 在设计上应该与 Active Model Serializers 兼容，但它们似乎在序列化`has_many`与嵌入式 ID 的关系方面不同步。

例如，序列化器

```
class PostSerializer < ActiveModel::Serializer
  embed :ids
  has_many :comments
end 
```

生成 JSON

```
{
    "post": {
        "comment_ids": [...]
    }
} 
```

但是 Ember Data 中的默认配置，

```
App.Post = DS.Model.extend({
  DS.hasMany('App.Comment'),
});

App.Comment = DS.Model.extend(); 
```

期望注释关联在`comments: [...]`没有`_ids`后缀的情况下被序列化（请参阅[Ember.js 指南的 REST 适配器部分的关系子部分](http://emberjs.com/guides/models/the-rest-adapter/)）。

我尝试了以下解决方法：

```
class PostSerializer < ActiveModel::Serializer
  attribute :comments
  def comments
    object.comment_ids
  end
end 
```

它可以工作，但是`embed :ids, :include => true`现在添加以启用侧面加载什么都不做，因为 AMS 不知道它是一个关联。

编辑：我正在使用`active_model_serializers (0.6.0)`gem 和 Ember-Data 修订版 11

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-07T20:16:31.803

对于 ember-data 1.0.0-beta.3，我最终使用了这个：

```
App.ApplicationSerializer = DS.ActiveModelSerializer.extend({}); 
```

如此处所述：[过渡指南](https://github.com/emberjs/data/blob/master/TRANSITION.md#underscored-keys-_id-and-_ids)

效果很好！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T02:01:52.280

您可以尝试在客户端的适配器中配置正确的映射

```
DS.RESTAdapter.map('App.Post', { comments: { keyName: 'comment_ids' } }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-01T02:50:25.417

我正在使用 active_model_serializers 0.6.0 和 ember_data 11。我没有看到您报告的行为。

我的序列化器：

```
class CentreSerializer < ActiveModel::Serializer
  embed :ids

  attributes :id, :name
  has_many :rooms
end 
```

localhost:3000/centres/1.json 的输出

```
{
  centre: {
    id: 1,
    name: "Centre0",
    rooms: [
      1,
      2,
      3,
      4,
      5
    ]
  }
} 
```

在我的情况下，rails 应用程序甚至在它到达 ember 之前就生成了正确格式的 json。您不必求助于客户端的映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T04:42:18.937

看来[这个提交](https://github.com/rails-api/active_model_serializers/commit/7f87c9b3f2bb26372d75a5c10025e5dd881d6688)是造成这种情况的原因。当 AMS 更新为将`has_one`关联序列化为`association_id`（使 AMS 符合 ember-data）时，它也被修改为将`belongs_to`关联序列化为`association_ids`.

# sql - 返回由 plpgsql 函数插入的记录

> ID：14633433
> 
> 赞同：2
> 
> 时间：2013-01-31T19:18:04.850
> 
> 标签：sql, postgresql, plpgsql, postgresql-9.1, sql-insert

我有一个在 postgres 中执行 plpgsql 函数的 cron 作业。此函数将零到多条记录插入表中。将函数创建的记录作为结果返回的最佳方法是什么？

我正在使用 PostgreSQL 9.1

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T04:04:14.460

幸运的是，这可以很容易地完成。说，你正在插入表格`insert_tbl`......

```
CREATE OR REPLACE FUNCTION f_ins_return()
  RETURNS SETOF insert_tbl AS
$func$
BEGIN

RETURN QUERY
INSERT INTO insert_tbl
SELECT * FROM othertable LIMIT 3 -- or where ever your rows come from ...
RETURNING *;

END
$func$ LANGUAGE plpgsql; 
```

称呼：

```
SELECT * FROM f_ins_return(); 
```

关键要素：

[`RETURNS SETOF insert_tbl`](http://www.postgresql.org/docs/current/interactive/sql-createfunction.html)
[`RETURN QUERY`](http://www.postgresql.org/docs/current/interactive/plpgsql-control-structures.html#PLPGSQL-STATEMENTS-RETURNING)
[`RETURNING *`](http://www.postgresql.org/docs/current/interactive/sql-insert.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:11:17.967

您可以创建一个在其中放置值的列。该值是一小组受限值之一。在这种情况下，这些值是创建记录的方式的来源。一个值是 cron 作业，另一个值是人工插入或在该表中创建记录的其他方式。之后，您可以使用 SQL 找出在何时创建了哪条记录。

# javascript - jQuery删除几乎相同的表行

> ID：14633435
> 
> 赞同：-1
> 
> 时间：2013-01-31T19:18:07.560
> 
> 标签：javascript, jquery, tablesorter

我有 html 表格.... 我需要：如果我有两个或多个几乎相同的行（首先检查大写，没有空格和其他符号......只有数字和字母），我必须全部删除，并保留一个，但只有这样，我在 td 中有一些价值......看一下例子：

```
Bosch | 1234s | details
BOSCH | 1234S | 
ATE | 1215 | details 
```

我必须只保留这样的表格：

```
Bosch | 1234s | details
ATE | 1215 | details 
```

只要有相同的（大写，没有空格和其他符号......只有数字和字母）然后删除所有相同的行，并保留这些，在第三行我有细节......

我不擅长 javascript....请帮帮我（只是不要减去或关闭）...我用谷歌搜索了一些排序...但是如何删除**几乎**重复的内容不知道....

现在我也有tablesorter：

```
$(document).ready(function() { 
        $(".sortable") 
        .tablesorter({sortList: [[4,0]], widgets: ['zebra']});
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:22:51.223

从[这个答案](https://stackoverflow.com/questions/8234107/remove-duplicate-trs-through-jquery/8234194#8234194)开始并使用你的桌子。

```
<table cellpadding="0" cellspasing="0" class="sortable zebra tablesorter tablesorter-default" id="articles-table">
              <thead>
                <tr class="tablesorter-headerRow">
                  <th data-column="0" class="tablesorter-header"><div class="tablesorter-header-inner">Производитель<i class="tablesorter-icon"></i></div></th>
                  <th data-column="1" class="tablesorter-header"><div class="tablesorter-header-inner">Артикул<i class="tablesorter-icon"></i></div></th>
                  <th data-column="2" class="tablesorter-header"><div class="tablesorter-header-inner">Описание<i class="tablesorter-icon"></i></div></th>
                  <th data-column="3" class="tablesorter-header"><div class="tablesorter-header-inner"><i class="tablesorter-icon"></i></div></th>
                  <th class="prcol  tablesorter-header tablesorter-headerSortDown" data-column="4"><div class="tablesorter-header-inner">Цена<i class="tablesorter-icon"></i></div></th>
                  <th data-column="5" class="tablesorter-header"><div class="tablesorter-header-inner">Наличие<i class="tablesorter-icon"></i></div></th>
                  <th data-column="6" class="tablesorter-header"><div class="tablesorter-header-inner">Сроки поставки<i class="tablesorter-icon"></i></div></th>
                  <th data-column="7" class="tablesorter-header"><div class="tablesorter-header-inner"><i class="tablesorter-icon"></i></div></th>
                </tr>
              </thead>
              <tbody class="analogs_art">

             <tr class="zebra-stripe zebra-grey zebra2 even">
                  <td>
                    <h5>
                      Knecht
                    </h5>
                  </td>
                  <td>
                    <h4>
                      OC90
                    </h4>
                  </td>
                  <td style="max-width: 300px;">
                    (07786171)Фильтр масл OPEL
                    (07786171)Фильтр масл OPEL
                  </td>
                  <td>
                  </td>
                  <td>
                    6124
                  </td>
                  <td>
                    20
                  </td>
                  <td>
                    0-1
                  </td>
                  <td id="to_cart_and_qnt_td">

                      <form accept-charset="UTF-8" action="/line_items" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="0jlRLSkDKi6eM5SSL+3uRB0w2G141KUcJKuy4Bg2YNo="/></div>
                          <input id="ART" name="ART" type="hidden" value="y1M1ZtdXgnMe6pOjjuXWPqhYR41SmQRKzlDOQ1uPwuru+AamPGpcOwOFFylbRDu5M1XUawCnukqNDQCuIr0JPA==--vNGx6/lYKRrpD5NGTJALcQ=="/>

                          <input id="price" name="price" type="hidden" value="TodzvfOZCbK5T9+RLE1IQg==--qq8o30c5rTX91F8W42wdsQ=="/>
                          <input id="distributor_id" name="distributor_id" type="hidden" value="6"/>
                          <input id="waittime" name="waittime" type="hidden" value="1"/>
                          <input class="qnt_to_cart2" id="OC90" name="cart_quantity" pattern="0|[1-9]\d{0,2}" required="required" type="text" value="1"/>
                          <input class="orange-button to-cart_no" id="OC90" name="commit" type="submit" value="В корзину"/>
                    </form>
                  </td>
                </tr><tr class="zebra-stripe zebra-grey zebra2 odd">
                  <td>
                    <h5>
                      KNECHT

                    </h5>
                  </td>
                  <td>
                    <h4>
                      OC 90
                    </h4>
                  </td>
                  <td style="max-width: 300px;">
                    Масляный фильтр
                  </td>
                  <td>
                    <a href="/articles/1248525/details" class="details-link">подробнее</a>
                    <a href="/articles/1248525" class="analogs-link">аналоги</a>
                  </td>
                  <td>
                    6124
                  </td>
                  <td>
                    20
                  </td>
                  <td>
                    0-1
                  </td>
                  <td id="to_cart_and_qnt_td">
                    <form accept-charset="UTF-8" action="/line_items" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="0jlRLSkDKi6eM5SSL+3uRB0w2G141KUcJKuy4Bg2YNo="></div>
                            <input id="ART" name="ART" type="hidden" value="9x6mdLbW2aMaHqFK32kZwHWnWA7n0GBp/jXS8KeECsTS+78ytG0SQzFpVODplws5iHm6B6SkZzi3ej2+zpW8iQ==--RNoUUgcZu7MLU8BHJ4ynSQ==">
                            <input id="price" name="price" type="hidden" value="VqatEYzkPEf3P9Y/jNY9Zg==--Iw5nQDqjK9vvZX/RecD1eA==">
                            <input id="distributor_id" name="distributor_id" type="hidden" value="6">
                            <input id="waittime" name="waittime" type="hidden" value="1">
                            <input class="qnt_to_cart" id="cart_quantity" name="cart_quantity" pattern="0|[1-9]\d{0,2}" required="required" type="text" value="1">
                            <input class="orange-button to-cart" name="commit" type="submit" value="В корзину">
                    </form>
                  </td>
                </tr><tr class="zebra-stripe zebra-grey zebra1 even">
                  <td>
                    <h5>
                      Knecht
                    </h5>
                  </td>
                  <td>
                    <h4>
                      OC90
                    </h4>
                  </td>
                  <td style="max-width: 300px;">
                    Фильтр масляный OPEL/GM/DAEWOO
                    Фильтр масляный OPEL/GM/DAEWOO
                  </td>
                  <td>
                  </td>
                  <td>
                    6142
                  </td>
                  <td>
                    1000
                  </td>
                  <td>
                    3
                  </td>
                  <td id="to_cart_and_qnt_td">

                    <form accept-charset="UTF-8" action="/line_items" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="0jlRLSkDKi6eM5SSL+3uRB0w2G141KUcJKuy4Bg2YNo="></div>
                            <input id="ART" name="ART" type="hidden" value="NqgWSvcdv0FEQkjcJZp98gIYe20Fjol8Bn31tB/CjWnTFVsa3J3hmldO1RSqS/pNUcVZ5dh0wcP7YeZxPAkQc4DEPKy7EVuTpMw3oQw58T0=--/XCn0hP3w0mglJ1vTXSjHw==">

                            <input id="price" name="price" type="hidden" value="mFPLSHh7AdEMpQJiZHFKNg==--hfJQGWhjBoD6mNAetXZ3Xw==">
                            <input id="distributor_id" name="distributor_id" type="hidden" value="6">
                            <input id="waittime" name="waittime" type="hidden" value="3">
                            <input class="qnt_to_cart2" id="OC90" name="cart_quantity" pattern="0|[1-9]\d{0,2}" required="required" type="text" value="1">
                            <input class="orange-button to-cart_no" id="OC90" name="commit" type="submit" value="В корзину">
                    </form>
                  </td>
                </tr></tbody>
            </table> 
```

jQuery代码是

```
var seen = {};
    $('table tr').each(function() {
        var tr = $(this).clone();
        if(tr.not(':input')){
            if(tr.not('a.details-link')){
                tr.find("td:eq(7)").remove();
                tr.find("td:eq(3)").remove(); 
               // tr.find("td:eq(2)").remove();
                var txt = tr.text().toLowerCase().replace(/\s+/g, '');;        
                if (seen[txt])
                    $(this).remove();
                else
                    seen[txt] = true;
            }
        }
    }); 
```

一个功能示例在[这里](http://jsfiddle.net/jefferson/VD32d/)

# ios - UIButton 无法在第一代 iPad 上激活“内部修饰”，可在第二代上使用

> ID：14633437
> 
> 赞同：2
> 
> 时间：2013-01-31T19:18:11.083
> 
> 标签：ios, objective-c, cocoa-touch, uibutton, interface-builder

## 问题

我有一个 .xib 和一个`UIButton`. 这与文件所有者中 的方法`UIButton`有连接。`Touch Up Inside``- (IBAction)play:(id)sender`

当我在第一代 iPad 上运行`UIButton`时，点击时会显示它处于突出显示状态，但不会调用 connected 方法。我在方法的第一行设置了一个断点，它从来没有命中。

当我在第二代 iPad 上运行该应用程序时，一切正常。

我在这个问题上有点盲目，但我希望其他人对可能发生的事情有所了解。知道我忽略了什么吗？

## 更新，部分解决

感谢 Stavash 的帮助，我看到问题的根源是附加到包含按钮的视图的手势识别器。

当我删除手势识别器时，一切正常。

我看到一个[相关的问题](https://stackoverflow.com/questions/4825199/gesture-recognizer-and-button-actions)，该问题指示使用`UIGestureRecognizerDelegate`防止手势识别器在点击按钮时响应的解决方案。

但是，即使`NO`在点击按钮时委托方法正在返回，该`Touch Up Inside`事件似乎仍然没有被触发。

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    if ((touch.view == self.playButton)) {
        return NO;
    }
    return YES;
} 
```

*代码取自相关问题，上面链接*

明天我会再做一些实验，如果我发现哪里出错了再发帖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:47:30.763

有可能（看起来很奇怪）您在该视图控制器中有一个活动的 UITapGestureRecognizer，它在每个 iOS 版本中的反应都不同。尝试取消手势识别器的任何活动实例，看看它是否有效。

# jqgrid - 标题列未与 jqgrid 中的 body 列同步加载/调整大小与 shrinkToFit 和 forceFit

> ID：14633440
> 
> 赞同：1
> 
> 时间：2013-01-31T19:18:15.590
> 
> 标签：jqgrid, resize

当网格不显示垂直滚动条时，即当网格中没有多少行时，网格加载得很好，并且调整列的大小也可以正常工作（使用 shrinkToFit:true 和 forceFit:true）。

但是当网格的对象有更多行时，网格中会出现垂直滚动条。网格的标题列与正文列不同步，并且调整大小在标题和正文列之间也继续不同步，即使使用 shrinkToFit:true 和 forceFit:true。

据我了解，当滚动条显示时，我认为滚动条的宽度也被考虑为 btable 的宽度，这会导致不同步问题。

[截屏](http://i.stack.imgur.com/9H5IS.png)

有任何想法吗 ？

# sql-server-ce - 更新客户端上的 SQL Compact 数据库的最佳实践

> ID：14633441
> 
> 赞同：0
> 
> 时间：2013-01-31T19:18:17.110
> 
> 标签：sql-server-ce, windows-phone-8, windows-store-apps

因此，大多数应用程序在某些时候都会发生变化。如果您使用 SQL Compact 数据库开发客户端应用程序，并且需要进行结构更改（添加表、添加列等），有哪些提示或做法。

我正在考虑移动应用程序、Windows Phone、Windows RT/Store 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:46:59.820

对于 Windows Phone，您应该使用[DatabaseSchemaUpdater - MS](http://msdn.microsoft.com/en-us/library/microsoft.phone.data.linq.databaseschemaupdater%28VS.95%29.aspx)[在此处](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh394022%28v=vs.105%29.aspx)也有更新架构的演练。

不幸的是，对于 Windows Store 应用程序，[似乎不会有 SQL CE 可用。](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/f71c518c-c288-459e-917f-52b9cf8442d7)虽然有[SQLite](http://timheuer.com/blog/archive/2012/05/20/using-sqlite-in-metro-style-app.aspx)。

# c++ - 返回字符串的静态方法

> ID：14633446
> 
> 赞同：1
> 
> 时间：2013-01-31T19:18:38.647
> 
> 标签：c++, string, valgrind

当我编写这样的代码时，我遇到了一些 valgrind 问题：

```
static std::string function(std::string test)
{
        size_t pos = test.find(',');
        if (pos == test.npos)
        {
            // no comma
            //
            pos = test.length();
        }

        return test.substr(0, pos); //Valgrind is reporting possibly lost bytes here

} 
```

现在我的问题是我应该这样做吗？

```
static std::string function(std::string test)
{
        size_t pos = test.find(',');
        if (pos == test.npos)
        {
            // no comma
            //
            pos = test.length();
        }
        static std::string temp = test.substr(0, pos);
        return temp;

} 
```

我认为拥有字符串`temp`static 有点重要，因为`function`它是静态的，因此返回的任何内容都`function`应该与封装的对象具有相同的生命周期`function`。还是我的分析有问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:22:03.247

> 我有一些 valgrind 问题

确切地！那是 Valgrind 的问题，而不是您的代码问题。Valgrind 并不总是正确的，在这种情况下，它会给你带来错误的警报。忽略它。

> 现在我的问题是我应该这样做吗？

不，静态函数和静态变量是两个不同的东西。此外，第二版代码在多线程环境中引入了可能的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:27:37.503

不要那样做，你会失去线程安全。第一个功能很好，没有内存泄漏。你创建了一个`std::string`临时的，但没关系，不用担心，它完美地处理分配的内存。您必须仔细阅读 valgrind 警告： I's a *warning*，并且*valgrind*认为它*可能*丢失了字节。现在*你*可以去向自己保证没有任何损失。IIRC 有可能告诉 valgrind 这次一切正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T19:27:47.417

> 现在我的问题是我应该这样做吗？

不，绝对不是。无需创建这样一个临时的（尤其不是`static`一个，使该功能不可重入，或者最终仅在您的情况下第一次工作）。*我猜Valgrind*在这里报告垃圾。您的代码看起来不错。

> 还是我的分析有问题？

是的。类`static`方法没有与之关联的对象，无论如何，它可能具有不同的生命周期（它就像一个普通的非类函数，只是你需要在调用时使用类名来限定它的范围）。除此之外，`string`无论如何您都不会返回对任何临时对象的引用，而是从 复制的新对象`temp`，因此这里没有要考虑的生命周期问题。

除此之外，您可能需要考虑`test`通过 const-reference 获取对象，因为您不修改也不复制它（这可能与对对象身份和对象值的一般误解有关吗？）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-31T19:35:08.560

第一个片段很好；第二个片段绝对不行（它只保证在你第一次使用它时能正常工作）。

其他人似乎都在告诉你忽略 Valgrind。**不要那样做**。您还没有向我们展示您的其余代码，很可能其他地方存在仅在此处表现出来的问题。

第二种选择是您的 C++ 库正在做一些古怪的事情，这会不必要地触发 Valgrind。如果是这样，那么解决方案是使用[*抑制文件*](http://valgrind.org/docs/manual/manual-core.html#manual-core.suppress)。但是只有当你**100%**确定这是图书馆的问题时，你才应该这样做；否则，您将来会为误报做好准备。

# ruby-on-rails - 组 Rails 属性错误

> ID：14633447
> 
> 赞同：0
> 
> 时间：2013-01-31T19:18:41.897
> 
> 标签：ruby-on-rails, validation

我正在尝试实施一项设计更改，该更改要求在页面上的多个选项卡中显示错误。

我一直在验证我的模型：（还有更多验证；这只是一个例子。）

```
validate :has_comment? if: lambda { |r| r.last_step? && r.request_type == :snf_request }

def has_comment?
  errors[:base] << "Request must have at least one comment." if self.comments.blank?
end 
```

这可行，但显然所有这些错误消息都附加到该`errors[:base]`数组中。

我试着做这样的事情：

```
def has_comment?
  errors[:comments_page] << "Request must have at least one comment." if self.comments.blank?
end 
```

想到我可以为错误消息调用一个部分，然后将 a 传递`symbol`给它，指定它应该输出哪一页错误。

当我在 中对此进行测试时`rails console`，我创建了一个新的空白`Request`对象并检索了它的错误。键入`r.errors[:base]`给了我像第一个示例一样添加的验证消息，并`r.errors[:comments_page]`给了我在第二个示例中添加的消息。

但是，当我转到我的应用程序并实际创建一个空白请求时，这不起作用。错误消息部分呈现，但它是空白的。这是我的部分内容以及我如何渲染它以供参考。

```
<%= form_for @request, html: { id: "new_request_form", autocomplete: :off } do |f| %>
  <%= render 'snf/shared/error_messages', target: f.object %> 
```

和部分：

```
<% if target.errors.any? %>
  <div id="error_explanation">
    <div class="alert alert-error">
      The form contains <%= pluralize(target.errors.count, "error") %>.
    </div>
    <ul>
      <% target.errors[:base].each do |msg| %>
        <li>* <%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %> 
```

**这是控制器动作**

```
def update
  @request = Snf::Request.find(params[:id])
  @request.update_attributes(params[:snf_request])

  if params[:save] == "draft"
    @request.current_step = "draft"
  else
    @request.current_step = @request.steps.last
  end

  respond_to do |format|
    if @request.save
        if params[:save] == "draft"
          notice = 'snf.requests.message.draft'
        elsif is_new || is_forwarded
          notice = 'snf.requests.message.sent'
        else
          notice = 'snf.requests.message.updated'
        end

    format.html {
      flash[:notice] = I18n.t(notice)
      redirect_to snf_physician_path(current_user)
    }
    format.json {
    flash[:notice] = I18n.t(notice)
      redirect_to snf_physician_path(current_user)
    }
  else
    if params[:forwarded_consult_request]
      format.html {
        @request_types = Snf::RequestType.all
        @physicians = User.physicians_by_specialty
        render action: "forward"
      }
    else
      format.html{
        @request_types = Snf::RequestType.all
        @physicians = User.physicians_by_specialty
        render action: "edit_new"
      }
    end
  end
end 
```

我只是`target.errors[:base]`在那里添加了测试。它通常读取`target.errors.full_messages`.

我在这里错过了什么吗？为什么这似乎有效，`irb/rails console`但应用于实际应用时却无效？还有另一种更理智的方法吗？

# php - 将 javascript 数组传递给同一 PHP 文件上的 php 变量

> ID：14633450
> 
> 赞同：0
> 
> 时间：2013-01-31T19:18:45.367
> 
> 标签：php, javascript, jquery, ajax

我有这个 PHP 文件，其中我需要这个可用的 javascript 变量（在同一个文件中）来传递我的 PHP 变量，就像这样。

**myfile.php 包含：**

```
 var testing  = ["EWMLMc3ES3I", "RSdKmX2BH7o", "SIXwlxhjaKY", "acp8TbBPVos", "6GpKR4-TLoI", "XLKLkTnKRwg", "6WPELkw5kD0"]; 
```

我想让它像这样

```
 testing = <?php $new_testing ?> 
```

* * *

我需要一个建议，可能是一个 jquery 片段，但类似于我的场景，它是一个 php 文件中的 javascript。

* * *

编辑：附加信息，原因是，因为还有另一个需要特定 PHP 变量的 javascript 代码（不在同一个文件上，而是通过外部 JS 包含它）。所以说这里的逻辑：

1.  javascript_variable ---> php_variable（将 javascript 变量传递给 php）然后，
2.  php_variable --> another_javascript_variable（将 php 传递给另一个 javascript 文件）
3.  another_javascript_variable 将由该外部 javascript 文件执行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:21:59.783

它仅适用于“页面加载事件”。换句话说，JavaScript（客户端代码）总是在 PHP（服务器端代码）之后呈现。

解决此问题的一种方法也是使用 AJAX POST onload，其中客户端已完成渲染并将响应返回给服务器。（你的阵列）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:27:23.853

从我理解你的问题的方式来看，我相信你正在寻找的是 php 函数`json_encode`

然后，您基本上可以做您正在尝试的事情。

```
<?php $new_testing = array('one', 'two', 'three', 'four'); ?>

<script>
    var testing = <?php echo json_encode($new_testing); ?>;
</script> 
```

如果你问“我的 JavaScript 如何将变量传递给我的 PHP”，答案是 AJAX——你必须提出一个全新的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T10:40:46.650

在您的 PHP 端，使用[json_encode()](http://php.net/manual/en/function.json-encode.php)将您的 php 数组转换为合适的格式以将其传递给 javascript。

PHP：

```
$var = array( 'lorem', 'ipsum', 'dolor');
$json_var = json_encode($var);
$parameter = array( 'js_var' => $json_var );
wp_enqueue_script('my_script');
wp_localize_script('my_script', 'object_name', $parameter); 
```

Javascript：

```
<script>
my_var = jQuery.parseJSON(object_name.js_var);
alert(my_var); 
</script> 
```

# c++ - 如何将 Qt 资源嵌入到 .dll 文件中？

> ID：14633454
> 
> 赞同：5
> 
> 时间：2013-01-31T19:18:58.663
> 
> 标签：c++, qt

我的项目中有数百个 HTML 文件，我不想将所有这些 HTML 文件编译成 .exe。因此，我想将我的 HTML 文件构建为 .dll 文件。

如何将这样的 Qt 资源嵌入到 .dll 文件或其他类型的编译库中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T20:03:55.843

你打算只为 html 文件使用 dll 还是它也包含代码？如果 dll 仅适用于 html 文件，请改为创建[外部外部资源文件。](http://qt-project.org/doc/qt-4.8/resources.html#external-binary-resources)

将 qrc 文件编译为外部资源文件：

```
rcc -binary myresource.qrc -o myresource.rcc 
```

在您的 exe 中注册资源文件：

```
QResource::registerResource("/path/to/myresource.rcc"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-10T18:05:12.123

如果你很好奇（或者其他人需要这个解决方案），我有同样的问题，除了 RCC 文件不是我的选项（我需要在 DLL 文件中）。

[这是我开始并解决的主题](http://qt-project.org/forums/viewthread/27538/#124678)

基本上，在我的库 (DLL) 项目中，我必须：

1.  在库（**DLL**）项目（在**.pro**文件中）包含**qrc_RESOURCE_NAME.cpp**文件- 这是在编译时生成的，因此您很可能需要编译两次（第一次（仅 qmake 就足够了）以生成该**qrc_RESOURCE_NAME.cpp**文件，第二个用项目编译）
*******   将**qrc_RESOURCE_NAME.cpp**（直接或间接）包含在您的应用程序 ( **EXE** ) 项目中*   通常使用协议**qrc:///**（或更短的**:/**）来加载文件******

 ****有关更多详细信息，请访问我发布的链接。****

# shell - shell echo 不遵循顺序

> ID：14633455
> 
> 赞同：0
> 
> 时间：2013-01-31T19:18:59.777
> 
> 标签：shell, unix

我有一个功能

```
foo_bar()
{
  echo "foo_bar"
  read -p "enter option" option
  echo $option
}

option=$(foo_bar)
echo $option 
```

它返回

```
enter option
and then in one line
foo_bar [option] 
```

我所期待的是执行遵循我写它的顺序.. 即喜欢

```
foo_bar
enter option

[option] 
```

我如何在 shell 脚本中执行此操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:25:28.533

在之前添加回声：

```
option=$(foo_bar) 
```

所以它变成：

```
foo_bar()
{
  echo "foo_bar"
  read -p "enter option" option
  echo $option
}

echo
option=$(foo_bar)
echo $option 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:28:17.667

您正在捕获`foo_bar`变量中的输出`option`。该输出包括 foo_bar 回显的文本。（也就是说，您将字符串分配给`foo_bar\n$option`变量`option`，并且 echo 将换行符替换为空格）但是，`read -p`将其提示打印到 stderr。如果您希望 "foo_bar" 打印到 read 打印其提示的同一位置，请明确执行：

```
foo_bar()
{
  echo "foo_bar" >&2
  read -p "enter option" option
  echo $option
}

option=$(foo_bar)
echo $option 
```

# css - 自动完成搜索建议下推其他内容

> ID：14633461
> 
> 赞同：0
> 
> 时间：2013-01-31T19:19:43.783
> 
> 标签：css

这是我的网站，搜索[http://clients.onebricktech.com/whenisit/search.php?keywords=1Trades1%20Plumbing](http://clients.onebricktech.com/whenisit/search.php?keywords=1Trades1%20Plumbing) 如果我搜索任何内容，搜索建议关键字会向下推。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:24:07.300

您应该`position: absolute`在包含搜索词文本框的表中使用。然后您将需要调整表格边距左侧属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:24:45.973

`position: absolute`尽管我实际上喜欢该功能，因为它是 TBH ，但您需要将建议框从流程中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:24:56.100

添加：

```
position: absolute 
```

在 ajaxresults 标签中，这应该有效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T19:38:21.627

像这样修改你的代码

```
<div style="float:left; position: relative">
    <form id="cityForm" method="post">
        <input type="hidden" value="true" name="cityChanged">
        <input type="hidden" value="" name="keywords">
        <input type="text" data-default="146" onblur="this.style.color='#318d00'" value="Trivandrum, 13" style="width: 150px; color: rgb(49, 141, 0); display: inline-block;" onkeyup="city_completer()" onclick="javacript:this.select();this.style.color='#000'" class="city_state" id="city_stater" name="city_state" autocomplete="off">
    </form>
    <div style="position: absolute; margin-left: 35px; width: 120px; border: 1px solid rgb(153, 153, 153); display: block;" id="ajaxcity"><div><div class="citySuggest"><a onclick="copyToCityBox('Caledon Village, ON');document.getElementById('citySelect').submit()" href="javascript:void()">Caledon Village, ON</a></div><div class="citySuggest"><a onclick="copyToCityBox('Caledon, ON');document.getElementById('citySelect').submit()" href="javascript:void()">Caledon, ON</a></div><div class="citySuggest"><a onclick="copyToCityBox('Courtice, ON');document.getElementById('citySelect').submit()" href="javascript:void()">Courtice, ON</a></div></div></div>
</div> 
```

# ios - 我应该在执行后将块引用设置为 nil 吗？

> ID：14633466
> 
> 赞同：4
> 
> 时间：2013-01-31T19:19:52.897
> 
> 标签：ios, objective-c, objective-c-blocks

`[block copy]`执行后`block();`，我应该设置`block=nil`吗？或者 ARC 是否已经为我管理了这个，所以我不需要做任何事情？我对 ARC 如何在这里管理块引用有点困惑，我不确定将块设置为 nil 是否会破坏任何东西？

我有这样的东西。有什么想法吗？

```
typedef void (^C3Block)(void);    // declare block, no return, no args

// set flag to get _previewImage, then call the block
- (void)takePreviewImageFromBufferWithBlock:(C3Block)block {
    _takePreviewImageBlock = [block copy]; // save block ref for calling later
    _shouldTakePreviewImageFromBuffer = YES;
}

- (void)gotPreviewImageFromBuffer {
    _takePreviewImageBlock(); // calls the block
    _takePreviewImageBlock = nil; // <---- should I do this???
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T10:11:50.127

我认为将其设置为 是个好主意，`nil`原因如下：

让我们调用这些方法所在的类`ImageLoader`。假设我有一个`MyViewController`对此有强引用的类`ImageLoader`（例如，它是一个实例变量），并将一个保留的块传递给它`self`（即`MyViewController`）。为什么保留`self`？好吧，你`ImageLoader`大概是异步工作的，所以，比如说，我希望我`MyViewController`能有足够长的时间来处理响应。

好的，所以我们有一个保留周期。`MyViewController`保留，`ImageLoader`保留块，保留`MyViewController`。但是，如果您只是`nil`在操作结束时将块变量放在 中`ImageLoader`，它将打破这个循环。否则这些对象将永远不会被释放。`ImageLoader`将块变量设置为操作完成时是有意义的，`nil`因为它不再“需要”它。

（您也可以争辩说，可以通过以不同方式安排保留来避免上述场景中的问题——不*应该*`MyViewController`保留。然后，在异步操作期间，仍然必须由正在进行的操作中的*某些东西*保留。仍然保留块保留。操作完成后，释放操作将释放所有内容，每个人都很高兴，无需将块变量设置为。）*`ImageLoader``ImageLoader`*`ImageLoader``MyViewController``ImageLoader``nil`**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:28:59.477

通常，将块 iVar 设置为 nil 是没有意义的，因为您很可能会通过连续`-takePreviewImageFromBufferWithBlock:`调用将其重置。从内存管理的角度来看，`_takePreviewBlock`它是一个 iVar，ARC 对它的管理将与任何其他 iVar 相同 - 当所有者类被释放时，它会在没有您交互的情况下正确释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T19:33:37.620

如果`_takePreviewImageBlock`是具有**强**属性的属性，则只要包含该属性的对象存在，ARC 就会保留它。
正如@Eugene 所提到的，它会在调用后重置`takePreviewImageFromBufferWithBlock:`。

在了解了这种行为之后，您应该决定它是否适合您的设计。如果所有者将在之后立即解除分配，则无需自己将其属性为零。否则，如果此块不再与您的逻辑相关并且它将无缘无故地留在内存中，则您应该将其设为 nil。**

# c# - MEF 4.5 中缺少 CompositionInitializer。我可以用什么代替？

> ID：14633470
> 
> 赞同：3
> 
> 时间：2013-01-31T19:19:58.963
> 
> 标签：c#, .net, mvvm, dependency-injection, mef

我在 .NET 4.5 中找不到 System.ComponentModel.Composition.Initialization.dll（其中包含 CompositionInitializer 类的声明）。此程序集是否已从 .NET 4.5 中的 MEF 中删除？我现在如何编写标有 [Export] 和 [Import] 属性的应用程序的各个部分？

假设我有这个观点：

```
 internal partial class StartWindow : Window
    {
        public StartWindow()
        {
            InitializeComponent();
            DataContext = ViewModel;
        }

        [Import]
        public IStartWindowViewModel ViewModel { get; set; }
    } 
```

和适当的 ViewModel：

```
 [Export]
    internal class StartWindowViewModel : IStartWindowViewModel
    {
        public IEnumerable<Customer> Customers { get; set; }
    } 
```

我应该在我的外壳（或其他地方）中添加什么来组成这些部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:21:40.467

Silverlight 中存在这些`CompositionInitializer`和类似的类，但不存在完整的 .NET Framework。MEF 团队故意决定将他们排除在外，因为他们认为他们不合适。

逻辑是应该使用构造注入。

话虽如此，在 Silverlight 中应用类以使用该类的逻辑在 WPF 中应用完全相同。我[在 .NET 4 中对此进行了博文](http://reedcopsey.com/2010/03/26/mef-compositioninitializer-for-wpf/)，并包含了一个适用于整个框架的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:28:51.800

你失去了初始化组合，fe

```
 _container = new CompositionContainer(catalog);

    //Fill the imports of this object
    try
    {
        this._container.ComposeParts(this);
    }
    catch (CompositionException compositionException)
    {
        Console.WriteLine(compositionException.ToString());
    } 
```

[微软](http://msdn.microsoft.com/en-us/library/dd460648.aspx)

# sql-server - 如何找出数据库中未使用的列（SQL Server 2008）。

> ID：14633474
> 
> 赞同：6
> 
> 时间：2013-01-31T19:20:20.477
> 
> 标签：sql-server, schema

保留为空白/空/空格或零的列（给定表列表）。

假设我可以从中央系统表中提取表和列定义，我应该如何检查上述情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T19:47:49.750

SQL Server 内部没有特殊的过程来进行此确定。您需要查询每个表。这是一个蛮力解决方案：

```
If object_id('tempdb..#Results') is not null
    Drop Table #Results;
GO
Create Table #Results
    (
    TableSchema sysname not null
    , TableName sysname not null
    , ColumnName sysname not null
    );
GO

Declare @TableSchema sysname;
Declare @TableName sysname;
Declare @ColumnName sysname;
Declare @DataType sysname;
Declare @Columns Cursor;
Declare @BaseSql nvarchar(max);
Declare @Sql nvarchar(max);
Declare @AdditionalFilter nvarchar(max);

Set @BaseSql = 'Insert #Results( TableSchema, TableName, ColumnName )
                Select ''TABLE_SCHEMA'', ''TABLE_NAME'', ''COLUMN_NAME''
                From ( Select 1 As V ) As Z
                Where Not Exists    (
                                    Select 1
                                    From [TABLE_SCHEMA].[TABLE_NAME]
                                    Where [COLUMN_NAME] Is Not Null
                                        ADDITIONAL_FILTER
                                    )';

Set @Columns = Cursor Fast_Forward For
    Select C.TABLE_SCHEMA, C.TABLE_NAME, C.COLUMN_NAME, C.DATA_TYPE
    From INFORMATION_SCHEMA.COLUMNS As C
        Left Join INFORMATION_SCHEMA.VIEWS As V
            On V.TABLE_SCHEMA = C.TABLE_SCHEMA
                And V.TABLE_NAME = C.TABLE_NAME
    Where V.TABLE_NAME Is Null;

Open @Columns;
Fetch Next From @Columns Into @TableSchema, @TableName, @ColumnName, @DataType;

While @@Fetch_Status = 0
Begin
    If @DataType In('int','smallint','tinyint','bigint','numeric','bit','decimal','money','smallmoney','float','real')
        Set @AdditionalFilter = 'And [COLUMN_NAME] <> 0';
    Else If @DataType In('char','nchar','varchar','nvarchar','text','ntext')
        Set @AdditionalFilter = 'And Len([COLUMN_NAME]) > 0';
    Else
        Set @AdditionalFilter = '';

    Set @Sql = Replace(@BaseSql, 'ADDITIONAL_FILTER', @AdditionalFilter);
    Set @Sql = Replace(@Sql, 'TABLE_SCHEMA', @TableSchema);
    Set @Sql = Replace(@Sql, 'TABLE_NAME', @TableName);
    Set @Sql = Replace(@Sql, 'COLUMN_NAME', @ColumnName);

    --Print @Sql
    Exec(@Sql)
    Fetch Next From @Columns Into @TableSchema, @TableName, @ColumnName, @DataType;
End

Close @Columns;
Deallocate @Columns;

Select *
From #Results 
```

上述解决方案中的一个怪癖是，将返回表中为空的任何列。如果要排除空表，只需将查询调整为以下内容：

```
Set @BaseSql = 'Insert #Results( TableSchema, TableName, ColumnName )
                Select ''TABLE_SCHEMA'', ''TABLE_NAME'', ''COLUMN_NAME''
                From ( Select 1 As V ) As Z
                Where Exists    (
                                Select 1
                                From [TABLE_SCHEMA].[TABLE_NAME]
                                )
                And Not Exists  (
                                Select 1
                                From [TABLE_SCHEMA].[TABLE_NAME]
                                Where [COLUMN_NAME] Is Not Null
                                    ADDITIONAL_FILTER
                                )'; 
```

# c++ - 异构类型列的 C++ 表（集合）

> ID：14633478
> 
> 赞同：1
> 
> 时间：2013-01-31T19:20:29.677
> 
> 标签：c++, types, polymorphism

我正在尝试在 C++ 中为表或关系（具有唯一行的无序表）构建数据结构。我以前用过很多次，但从来没有自己建造过。

所以表应该是任意类型的任意数量的列的集合。我可以使用`std::vector<some_type>`或一些派生类来表示一列。

我的问题是我可以使用什么语言结构来定义总体表数据结构？我意识到我可以以某种方式包装`std::vector<some_type>`到某个类中，该类本身可以派生出某个基类，然后将表表示为指向基类的指针向量，但我很想知道是否有替代方法来进行表示，也许使用一些模板签名？在使用表格的列时，我宁愿不要投太多。

给一些背景。我很乐意使用我所描述的那种现有数据结构。我已经看到这种结构在软件行业中非常积极地与关系代数算法一起使用，但我还没有在 boost 中找到这种结构。我对在其上实现基本的关系运算符特别感兴趣，例如联接、产品等...

编辑：更多细节。我不想创建具有基于行的内存连续性的数据结构。连续性是基于列的，这一点很重要，因此拥有一组向量似乎是正确的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:31:25.690

您使用的数据结构可能取决于您最常执行的关系操作。

例如，如果您要在两个表上执行连接，有多种方法可以做到这一点。您可以使用[嵌套循环连接](http://en.wikipedia.org/wiki/Nested_loop_join)，在这种情况下，无需通过特定键快速访问表中的特定行。另一方面，如果使用[散列连接](http://en.wikipedia.org/wiki/Hash_join)，则可以通过给定键快速获取特定行。

但是选择使用什么类型的连接是查询优化中的一个相关问题，它有几个因素（数据库中数据的基数估计等）。

但总的来说，我会做以下事情：

1.  创建一个对象来表示数据中的一行。此对象可以包含您拥有的不同列的列表。如果您有一个通常对其执行操作的键，请将其存储在其自己的变量中。否则，您可以存储列值的哈希集以进行快速查找（仅当您有很多列时才值得这样做）。
2.  在您拥有此对象来表示数据“行”之后，请确定您最常执行的操作类型。**例如，如果您需要需要排序的操作，您可以使用 stl map**按特定键存储这些行，它实现了红黑树，并且可以有效地取回键。如果您需要在给定时间快速访问特定行（例如，由于查询中的过滤器），那么您可以使用**hashmap**。

tl/dr：以最佳方式存储行取决于您最常期望的操作类型和数据分布。无论如何，我认为创建一个类来存储“行”的概念是合乎逻辑的，然后您可以根据您的用例使用各种数据结构排列这些行。

# java - 获取导致 com.microsoft.sqlserver.jdbc.SQLServerException 的列的任何方法：字符串或二进制数据将被截断

> ID：14633479
> 
> 赞同：6
> 
> 时间：2013-01-31T19:20:33.440
> 
> 标签：java, sql, hibernate, sql-server-2005, jdbc

我们有一个使用休眠将数据持久化到 sql server 2005 实例的 webapp。

偶尔我们会得到一个`com.microsoft.sqlserver.jdbc.SQLServerException: String or binary data would be truncated.`

虽然我们可以得到插入查询，然后手动比较数据库中的列定义，看看哪一列太小，这样很慢而且容易出错。有没有办法从这个异常中自动获取有问题的表/列？

我已经在 Google 和 SO 中寻找解决方案，所以如果答案是“不，你无法获得该信息”，我会理解，但我认为问这个问题并没有什么坏处。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-07-10T18:58:47.503

当您尝试将更大的数据放入表列时，可能会发生此错误，例如：

您的列设置是 varchar(10) 并且您尝试输入“一些数据长度超过 10”

然后你会得到如下错误：`com.microsoft.sqlserver.jdbc.SQLServerException: String or binary data would be truncated.`

检查输入数据和您的设置。

# facebook - 显示 Facebook 专辑封面图片

> ID：14633480
> 
> 赞同：1
> 
> 时间：2013-01-31T19:20:34.783
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在尝试显示 Facebook 用户相册的封面照片，但我没有任何运气。

我到目前为止是这样的：

```
 FB.api('/me/albums', function(response) {
            for(var i = 0; i < response.data.length; i++)
            {
                if(response.data[i].cover_photo != undefined)
                {
                    var alb = $('<div class="album" id="album-' + response.data[i].cover_photo + '"></div>').appendTo(view_scroll);
                    alb.css('background', 'url(https://graph.facebook.com/' + response.data[i].cover_photo + '/picture)');
                }
            }
        }); 
```

我得到的只是一个问号图像。关于如何将实际封面图像放入 div 的背景的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T05:45:13.917

嗨，我遇到了同样的问题，我已经从用户的每个相册中获得了 cover_photo。我使用 javascript sdk。检查登录状态后，只需调用函数 albumes()：

```
function albumes() {

   FB.api('/me/albums?fields=name,link,cover_photo,id',
      function(response) {
         for(var c = 0 ; c < response.data.length ; c++) {
            coverPhoto(response.data[c].cover_photo, response.data[c].name);
         }
      }
   );
}

function coverPhoto(id, nombre){

   FB.api('/'+id+'?fields=picture',
      function(responseIn) {
         $('#javascriptData').append(
              "<br>"+ nombre +"<img src='"+ responseIn['picture'] +"'>");
        }
   );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T16:27:56.670

找到了... 需要将访问令牌添加到 url 的末尾：

```
background-image: url(https://graph.facebook.com/' + response.data[i].cover_photo + '/picture?access_token=' + [ACCESSTOKEN] 
```

# intellij-idea - 如何使用 IntelliJ 按名称获取方法？

> ID：14633483
> 
> 赞同：2
> 
> 时间：2013-01-31T19:20:51.953
> 
> 标签：intellij-idea

在 中`Eclipse`，编辑文件时，可以通过名称快速找到方法。是否`IntelliJ`通过一些快捷方式提供相同的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:29:08.097

`Ctrl`+`F12`将显示一个弹出窗口，允许您在当前类中查找方法。`Ctrl`+`F12`再次包括从父类继承的方法。对于那些在 Mac 上的人，`fn` `Apple``F12`会成功的。

顺便说一句，如果您想在知道其部分名称的*任何*文件中查找方法，请尝试`Ctrl`+ `Alt`+ `Shift`+ `N`- 也适用于字段。

# c - 如何从电机控制板下载代码？

> ID：14633485
> 
> 赞同：0
> 
> 时间：2013-01-31T19:20:55.873
> 
> 标签：c, embedded, arm, microcontroller, texas-instruments

我有一个步进电机控制板，我想知道是否可以将代码从板上下载回 PC。该板是带有 ARM 微控制器的 Luminary Micro Stepper Motor Control RDK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:55:50.787

当然，只要电路板的制造商没有启用专门内置的芯片功能以不允许这种行为:-)（你知道，窃取或修改他们的产品）。从 MCU 的数据表和用户指南开始，它应该会告诉您您想知道的一切。他们很可能烧断了 JTAG 保险丝，启用了代码读取保护，或者使用了其他一些机制来防止这种情况发生。您也可以检查引导加载程序 (BSL) 功能。

# wpf - 获取已设置为自动的 WPF GridView 列的宽度

> ID：14633486
> 
> 赞同：0
> 
> 时间：2013-01-31T19:20:57.583
> 
> 标签：wpf

我有一个包含 GridView 的窗口，其中一列设置为“自动”。一旦数据已绑定到 ListView 并且列的宽度已确定，我想调整窗口大小以适应。但是，当我检查该列的宽度时（使用 ActualWidth，在构造函数的末尾，在分配集合之后），它的值为 0。

在我看到的与 ASP 相关的其他问题之一中，有一个带有 DataBound 事件的 GridView，该事件在数据绑定完成时触发。但是，对于 WPF GridView，没有事件，也没有与其列关联的任何事件。

在绑定数据并计算列宽后，我可以使用一个事件吗？还是有其他方法可以根据列的宽度调整窗口的大小？我希望自动调整大小只发生一次，而不是每次更改列宽时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T16:27:18.157

我遇到过这样的情况，答案几乎总是为**事件****添加一个事件处理程序`Loaded`**（您在构造函数中注册此处理程序）并检查`ActualWidth` **该处理程序中的内容，而不是构造函数**。这似乎允许控件实际被渲染，因此这些类型的属性然后设置了运行时值。

# r - 调用 table() 后访问空字符串

> ID：14633489
> 
> 赞同：0
> 
> 时间：2013-01-31T19:21:19.493
> 
> 标签：r

这是重现代码：

```
> example <- c("", "", "a", "b", "c")
> t <- table(example)
> t
example
  a b c 
2 1 1 1 
> t[""]
<NA> 
  NA 
```

我正在尝试访问数组中为空的字符串数。

我知道有一些 hacky 解决方法（比如替换原始数组中的空字符串），但我在这里遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:56:31.013

正如评论中所说，您可以访问一个空字符串

```
d[['']]
Error in d[[""]] : subscript out of bounds
> d[['a']]
[1] 1 
```

作为一种解决方法，您可以自己使用 names(d) 或者您可以将结果强制转换为 data.frame

```
dat <- data.frame(d)
> dat[1,]
  example Freq
1            2 
```

# tomcat - Tomcat 7 lib 目录中的 jar 文件

> ID：14633493
> 
> 赞同：3
> 
> 时间：2013-01-31T19:21:25.853
> 
> 标签：tomcat, shared-libraries

我想知道以下几点：我有一个专用于单个 web 应用程序的 Tomcat 7。将任何 jar 放在 $TOMCAT_HOME/lib 目录中是否有意义？在[文档](http://tomcat.apache.org/tomcat-7.0-doc/class-loader-howto.html)中它说：

> 因此，从 Web 应用程序的角度来看，类或资源加载按以下顺序查看以下存储库：
> 
> *   JVM 的引导类
> *   系统类加载器类（如上所述）
> *   /WEB-INF/Web 应用程序的类
> *   /WEB-INF/lib/*.jar 您的 Web 应用程序
> *   通用类加载器类（如上所述）

所以，如果我没看错的话，我没有理由放 avtivemq 或 commons-dbcp。我可以将它们放在我的 webapps lib 文件夹中，并绝对确定它们会首先被拾取。如果是这样，是否有任何其他情况对我使用 $TOMCAT_HOME/lib 目录有意义？如果不是，您能否解释一下上述缺陷在哪里？

谢谢，

G。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T09:02:33.343

如果您的 webapps（或大多数）必须共享相同版本的相同库（即数据库驱动程序或 SPI ObjectFactories），您应该在 $TOMCAT_HOME/lib 中共享它们。如果没有充分的理由共享库，请将它们保留在其 web 应用程序的类加载器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-17T19:11:51.487

是的。如果您重新启动您的网络应用程序（例如，通过实时上传新版本或按下 tomcat 管理器控制台上的“重新启动”按钮），您的 webapp 文件夹中的任何 jar 文件都将被刷新并重新加载，但共享 lib 文件夹中的那些文件不会重新加载。这意味着存储在 jar 中的类中的任何静态值都不会重置，并且 jar 在初始化时启动的任何线程都不会重新启动。我不知道问题中的 jar 文件，但这对于其他 jar 文件可能很重要（特别是那些假设他们能够启动守护线程而不终止它的文件——如果你离开，这将导致上下文泄漏它们在您的 Web 应用程序文件夹中，如果频繁重新加载，随着时间的推移，这可能会导致大量额外的内存使用）。

# sql-server - SQL72043 和其他 SSDT 错误：如何找到不正确的代码？

> ID：14633502
> 
> 赞同：12
> 
> 时间：2013-01-31T19:21:55.873
> 
> 标签：sql-server, visual-studio-2012, sql-server-data-tools

所以，我在 Visual Studio 2012 的 SSDT（SQL Server Data Tools）中有一个项目。当我构建这个项目时，没有错误 - 它构建得很好（甚至没有警告或消息）。

但是，如果我尝试发布，我会得到：

`The script file could not be found`（没有更多信息）。

如果我将项目与现有数据库进行架构比较，我得到的只是：

`Cannot generate deployment plan`（同样，没有更多信息）。

只有当我执行“运行代码分析”时，我才会收到一个可能意味着任何错误的错误：

`SQL72043: 7 elements are in an error state`

我知道这个错误可能是由于表定义中缺少逗号或类似的微不足道的错误造成的，但我已经花了好几个小时查看项目中的每一行 SQL 代码来查找问题。有什么办法可以让我更清楚地了解我的代码的哪些行导致了错误？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T16:02:18.863

删除数据库项目中的 dbmdl 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-10-03T12:59:15.440

您可以转到 IDE 菜单“**项目**”->“**重新分析项目**”，然后重建您的数据库项目以消除发布命令上的此错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-11T12:58:31.623

删除 dbml 文件对我不起作用，但为了让架构比较工作并且不收到 C 不**生成部署计划**错误，我切换了源和目标并再次比较了架构。

# php - MongoDB查询以获取键出现的次数

> ID：14633506
> 
> 赞同：0
> 
> 时间：2013-01-31T19:22:00.630
> 
> 标签：php, mongodb, grouping

所以我有一个 MongoDB 文档来跟踪登录到我们的应用程序。基本结构是这样出现的：

```
 [_id] => MongoId Object
        (
            [$id] => 50f6da28686ba94b49000003
        )

    [userId] => 50ef542a686ba95971000004
    [action] => login
    [time] => 1358354984 
```

现在 - 挑战是这样的：这些条目大约有 20,000 个。我一直面临着查看每个用户登录的次数（由 userId 定义）的挑战......所以我正在寻找一种好方法来做到这一点。我见过几种可能的方法（例如，在 SQL 中，我可能会通过按 UserID 分组并对其进行计数来降低登录次数 - 例如 SELECT userID, count(*) from... .group by UserId ...然后对其进行子选择（CASE WHEN或顶部选择中的某些内容）。无论如何 - 想知道是否有人对最好的方法有任何建议。最坏的情况我可以限制结果集并在内存中进行分组 - 但理想情况下希望直接从 Mongo 获得完整答案。另一个限制（即使在我通过第一组之后）是我希望按日期进行唯一计数......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:29:44.950

> 现在 - 挑战是这样的：这些条目大约有 20,000 个。

[在 20,000 时，使用聚合框架（ http://docs.mongodb.org/manual/applications/aggregation/](http://docs.mongodb.org/manual/applications/aggregation/) ）可能会更好：

```
$db->user->aggregate(array(
    array( '$group' => array( '_id' => '$userId', 'num_logins' => array( '$sum' => 1 ) ) )
)); 
```

这将分组（[http://docs.mongodb.org/manual/reference/aggregation/#_S_group](http://docs.mongodb.org/manual/reference/aggregation/#_S_group)）`userId`并计数（总和：[http](http://docs.mongodb.org/manual/reference/aggregation/sum/#_S_sum) ://docs.mongodb.org/manual/reference/aggregation/sum/#_S_sum ）分组登录的数量。

注意：如评论中所述，聚合帮助程序位于 PHP 驱动程序的 1.3+ 版本中。在 1.3 版本之前，您必须`command`直接使用该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:35:00.170

[http://docs.mongodb.org/manual/reference/command/group/](http://docs.mongodb.org/manual/reference/command/group/)

```
db.user.group({key: {userId: 1}, $reduce: function ( curr, result ) { result.total++ }, initial: {total: 0}}); 
```

我只用了几秒钟就在 191000 行上运行了这个，但组被限制为 20,000 个唯一条目，所以它真的不是你的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:25:23.403

您可以使用 MapReduce 按用户 ID 对结果进行分组

[http://docs.mongodb.org/manual/applications/map-reduce/#map-reduce-examples](http://docs.mongodb.org/manual/applications/map-reduce/#map-reduce-examples)

或者您可以使用 Group 方法：

```
db.logins.aggregate(
    { $group : {
        _id : "$userId",
        loginsPerUser : { $sum : 1 }
    }}
); 
```

对于 MongoDB 20K 甚至更多，走路和组合它们都不是问题，所以不用担心性能。

# csv - 删除某些数据并添加新数据后将批处理结果输出为 CSV 文本

> ID：14633507
> 
> 赞同：2
> 
> 时间：2013-01-31T19:22:01.063
> 
> 标签：csv, batch-file

我以前从未做过任何批处理脚本，所以我需要帮助来构建其中一个。我们有一个文件说“GetHistory.bat”，它接受一个参数 ID。脚本的输出如下所示：

```
Activity Name      Status      Date
----------------------------------------
Act1              Created    1-Jan-2013
Act2              Submitted  2-Jan-2013 
Act3              Approved   2-Jan-2013 
```

现在的问题是我需要将 txt 中的输出导出为 CSV，而无需将标题和参数 ID 添加到每一行，如下所示：

```
1001,Act1,Created,1-Jan-2013
1001,Act2,Submitted,2-Jan-2013 
1001,Act3,Approved,2-Jan-2013 
```

任何帮助开始脚本将不胜感激。谢谢...！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T16:42:56.163

假设 的输出`GetHistory.bat`已被重定向到名为 的文件`history.txt`中，我们可以将其输入到新的批处理文件 中`ParamCSV.bat`，如下所示：

```
C:\stackoverflow>ParamCSV.bat 1001 < history.txt
1001,Act1,Created,1-Jan-2013
1001,Act2,Submitted,2-Jan-2013
1001,Act3,Approved,2-Jan-2013 
```

为了为此编写一个快速脚本，我参考了以下信息：

*   [在批处理文件中读取标准输入流](https://stackoverflow.com/questions/6979747/read-stdin-stream-in-a-batch-file)
*   [在批处理文件中执行子字符串的最佳方法是什么？](https://stackoverflow.com/questions/636381/what-is-the-best-way-to-do-a-substring-in-a-batch-file)
*   [如何删除批处理文件中用户提供的输入的尾随和前导空格？](https://stackoverflow.com/questions/3001999/how-to-remove-trailing-and-leading-whitespace-for-user-provided-input-in-a-batc)
*   [DOS Batch - 函数教程](http://www.dostips.com/DtTutoFunctions.php)提供了函数参数传递的全面概述。

我想出了这个批处理脚本`ParamCSV.bat`：

```
@echo off
:: ParamCSV.bat
::
:: Usage: ParamCSV.bat <Parameter_ID> < history.txt
::
:: Thanks to:
:: https://stackoverflow.com/questions/6979747/read-stdin-stream-in-a-batch-file/6980605#6980605
:: https://stackoverflow.com/questions/636381/what-is-the-best-way-to-do-a-substring-in-a-batch-file
:: https://stackoverflow.com/questions/3001999/how-to-remove-trailing-and-leading-whitespace-for-user-provided-input-in-a-batch

:: Copy input parameter to 'id'
set id=%1

setlocal DisableDelayedExpansion

for /F "skip=2 tokens=*" %%a in ('findstr /n $') do (
  set "line=%%a"
  setlocal EnableDelayedExpansion
  set "line=!line:*:=!"
  set "activity=!line:~0,17!"
  call:trim !activity! activity
  set "status=!line:~17,11!"
  call:trim !status! status
  set "date=!line:~28,11!"
  call:trim !date! date
  echo(!id!,!activity!,!status!,!date!
  endlocal
)
goto:EOF

::function: trim
::synopsis: Removes leading and trailing whitespace from a sting. Two
::          parameters are expected. The first is the text string that
::          is to be trimmed. The second is the name of a variable in
::          the caller's space that will receive the result of the
::          trim operation.
::
::usage:    call:trim string_to_trim var_to_update
::             e.g.   call:trim %myvar1% myvar2

::trim left whitespace
setlocal
set input=%~1
for /f "tokens=* delims= " %%a in ("%input%") do set input=%%a
::trim right whitespace (up to 100 spaces at the end)
for /l %%a in (1,1,100) do if "!input:~-1!"==" " set input=!input:~0,-1! 
::return trimmed string in place
endlocal&set "%~2=%input%" 
```

这里做了许多假设，如果其中任何一个发生变化或无效，脚本就会中断：

*   的输出`GetHistory.bat`具有固定宽度的列，宽度分别为 17、11 和 11。您没有提供两位数日期的示例，因此我假设日期是右对齐的。
*   有两个标题行，我们在`for`语句中跳过。
*   所有输出行的 ID 相同，因此只需要一个输入参数，它是所有 CSV 输出行中的第一个元素。

# ruby - 有没有办法将资源的属性解析延迟到“执行”阶段？

> ID：14633509
> 
> 赞同：11
> 
> 时间：2013-01-31T19:22:04.727
> 
> 标签：ruby, attributes, chef-infra

我有两个 LWRP。第一个处理创建磁盘卷、对其进行格式化并将其挂载到虚拟机上，我们将其称为资源`cloud_volume`。第二个资源（它的作用并不重要）需要一个新格式化卷的 UUID，这是一个必需的属性，我们称之为资源`foobar`。

资源`cloud_volume`和`foobar`用于配方中，如下所示。

```
volumes.each do |mount_point, volume|
  cloud_volume "#{mount_point}" do
    size volume['size']
    label volume['label']
    action [:create, :initialize]
  end
  foobar "#{mount_point}" do
    disk_uuid node[:volumes][mount_point][:uuid]   # This is set by cloud_volume
    action [:do_stuff]
  end
end 
```

所以，当我做厨师跑步时，我得到了一个`Required argument disk_identifier is missing!`例外。

在做了一些挖掘之后，我发现配方分两个阶段处理，一个编译阶段和一个执行阶段。看起来问题出在编译时，因为那`node[:volumes][mount_point][:uuid]`是未设置的时间点。

不幸的是，我不能使用 OpsCode 在[这里](http://web.archive.org/web/20120226074250/http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time)的技巧，因为在 cloud_volume LWRP 中使用了通知（因此它会落入文档中显示的反模式）

所以，毕竟，我的问题是，有没有办法绕过`disk_uuid`在编译时知道值的要求？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-11-20T00:17:35.060

一种更清洁的方法是使用[Lazy Attribute Evaluation](http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation)。`node[:volumes][mount_point][:uuid]`这将在执行期间评估而不是编译

```
foobar "#{mount_point}" do
  disk_uuid lazy { node[:volumes][mount_point][:uuid] }
  action [:do_stuff]
end 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-31T20:41:31.157

**免责声明**：这是老厨师（<11.6.0）在添加[惰性属性评估](http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation)之前的方式。

将您的 foobar 资源包装到 ruby​​_block 并动态定义 foobar。这样，在编译阶段之后，您将在资源集合中拥有一个 ruby​​ 代码，并将在运行阶段对其进行评估。

```
ruby_block "mount #{mount_point} using foobar" do
  block do
    res = Chef::Resource::Foobar.new( mount_point, run_context )
    res.disk_uuid node[:volumes][mount_point][:uuid]
    res.run_action :do_stuff
  end
end 
```

这种方式`node[:volumes][mount_point][:uuid]`在编译时不为人所知，但在编译时也不会被访问。它只会在运行阶段访问，当它应该已经设置时。

# javascript - 收到数据后处理 extjs 存储代理数据

> ID：14633510
> 
> 赞同：2
> 
> 时间：2013-01-31T19:22:07.470
> 
> 标签：javascript, extjs

我正在使用 extjs sencha store 来存储数据。我对 Web 服务进行代理调用以获取数据。我使用 store.load() 函数刷新数据。

我正在寻找在将其提供给网格之前编辑接收到的数据。

我知道加载事件，但是这个函数是在加载完成并用当前数据填充数据后执行的。

```
listeners : {
        'load' : function(store,records, options) {
    } 
}, 
```

我正在寻找如何在将 Web 服务返回的数据分配给商店之前对其进行编辑。基本上，从我的 web 服务返回的数据格式与我们提供给 extjs 数据网格的格式不同。所以，在我们给网格之前要做一个数据操作。希望我们能做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T20:03:23.940

模型映射可以帮助您做到这一点。也可以提供一个转换功能。这是[文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Field)中的示例：

```
Ext.define('User', {
    extend: 'Ext.data.Model',
    fields: [
        {
            name: 'firstName',
            convert: function(value, record) {
                var fullName  = record.get('name'),
                    splits    = fullName.split(" "),
                    firstName = splits[0];

                return firstName;
            }
        },
        'name', 'email',
        {name: 'age', type: 'int'},
        {name: 'gender', type: 'string', defaultValue: 'Unknown'}
    ]
}); 
```

# node.js - 从 nodeJS 模块调用时，libspotify 注销崩溃

> ID：14633511
> 
> 赞同：2
> 
> 时间：2013-01-31T19:22:12.207
> 
> 标签：node.js, libspotify

我正在尝试为包装 libspotify 的 nodeJS 编写一个模块。目标是编写一个 web 应用程序，允许远程控制从 spotify 播放音乐的设备。

我决定继续使用 spshell 示例来确保线程安全，并用纯 C 语言编写一个“Spotify 服务”，它启动一个调用所有 API 函数的单独线程。

nodeJS 模块然后只调用一些提供的函数来与 spotify 交互。该服务的代码可以在这里找到：http: [//pastebin.com/KB6uwSC8](http://pastebin.com/KB6uwSC8)新线程从底部开始。

现在，如果我在这样的简单程序中调用它（fget 只是为了有一个简单的方法来完成登录）。我使用 c++ 来尽可能接近 node-gyp 编译代码。

```
#include <stdio.h>

extern "C" {
        #include "objects/SpotifyService.h"
}

int  main(int argc, char** argv) {
    login();
    char string[100];
    fgets(string, 100, stdin);
    fprintf(stdout, "Got: %s", string);
    logout();
    fgets(string, 100, stdin);
    fprintf(stdout, "Got: %s", string);
    return 0;
} 
```

它工作正常。我不能让这个崩溃。

如果我在 nodeJS 中使用相同的“服务”（意味着我只是调用`login()`并且`logout()`什么都不做），它**有时会**在注销时崩溃，比如 7-8/10 次。我尝试了很多东西，包括：

*   将编译器标志从 node-gyp 复制到我的小示例
*   摆弄 spotify 线程的线程属性
*   在 OSX 和 Debian 上编译
*   使用 libuv 而不是普通的 pthread
*   将我的“服务”编译到共享库并从节点调用它

无济于事。它只是崩溃。从 gdb 中调用时，它似乎更少崩溃，但这可能是随机的。

来自 gdb 的堆栈跟踪显示以下内容：

```
Thread 3 (Thread 0x7ffff65fd700 (LWP 21838)):
#0  0x00007ffff678f746 in ?? () from /usr/local/lib/libspotify.so.12
#1  0x00007ffff6702289 in ?? () from /usr/local/lib/libspotify.so.12
#2  0x00007ffff6702535 in ?? () from /usr/local/lib/libspotify.so.12
#3  0x00007ffff6703b5a in ?? () from /usr/local/lib/libspotify.so.12
#4  0x00007ffff6703c86 in ?? () from /usr/local/lib/libspotify.so.12
#5  0x00007ffff66c5c8b in ?? () from /usr/local/lib/libspotify.so.12
#6  0x00007ffff679a5b3 in sp_session_process_events () from /usr/local/lib/libspotify.so.12
#7  0x00007ffff6aa7839 in spotifyLoop (nervNicht=<value optimized out>) at    ../src/SpotifyService.c:103
#8  0x00007ffff70118ca in start_thread () from /lib/libpthread.so.0
#9  0x00007ffff6d78b6d in clone () from /lib/libc.so.6
#10 0x0000000000000000 in ?? () 
```

（在 OSX gdb 中显示 libspotify 中调用的函数称为“process_title”。）

由于到目前为止没有任何帮助，我只是不知道我是否可以让它工作，或者它是否是 libspotify 中与 nodeJS 不兼容的东西。我不明白 node-gyp 如何链接 .o 文件，也许有问题？

我在 github 上发现了另外两个尝试这样做的项目，但其中一个将 spotify 主循环实际放在 Javascript 中，另一个使用节点 0.1.100 和 libspotify 0.0.4，并且在 2 年内没有更新。我无法从他们两个身上学到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T14:29:24.453

好的，我又玩了一些。我只是忽略了注销错误并继续实现其他功能。

我在 logged_in 回调中添加了一个新的 sp_playlist_container 创建，显然这有所帮助。之后，节点模块不再崩溃（或尚未崩溃）。

```
static sp_playlistcontainer_callbacks pc_callbacks = {
     .container_loaded = &rootPlaylistContainerLoaded,
};

static void rootPlaylistContainerLoaded(sp_playlistcontainer* pc, void* userdata) {
    int numPlaylists = sp_playlistcontainer_num_playlists(pc);
    fprintf(stdout, "Root playlist synchronized, number of Playlists: %d\n", numPlaylists);
}

static void loggedIn(sp_session* session, sp_error error) {
    if(SP_ERROR_OK != error) {
            fprintf(stderr, "Error logging in: %s\n", sp_error_message(error));
    } else {
            fprintf(stdout, "Service is logged in!\n");
    } 

    //This is absolutely necessary here, otherwise following callbacks can crash.
    sp_playlistcontainer *pc = sp_session_playlistcontainer(spotifySession);
    sp_playlistcontainer_add_callbacks(pc, &pc_callbacks, NULL);
} 
```

但是 sp_playlist_container 创建**必须**在logged_in 回调中，如果我在另一个函数中调用它（比如“getPlaylistNames”），程序也会崩溃。

我会看看它是否继续有效，并希望这个答案可以帮助其他人。

# c++ - 在语句末尾转换为小写？

> ID：14633521
> 
> 赞同：0
> 
> 时间：2013-01-31T19:22:51.323
> 
> 标签：c++, character, uppercase, lowercase

小问题。（不使用 toupper() 和 tolower() 函数）我了解使用数值转换为大写和小写是什么，但是按照我的 C++ 书，为什么转换在此语句的末尾而不是之前？：

```
if (letter >= 'A')  //test for 'A' or larger
    if (letter <= 'Z')  //test for 'Z' or smaller
    {
        cout << endl
             << "You entered a capital letter."
             << endl;
        letter += 'a' - 'A'; //Convert to lowercase
        return 0;
    }

if (letter >= 'a') //test for 'a' or larger
{
    if (letter <= 'z') //test for 'z' or smaller
    {
    cout << endl
         << "You entered a small letter."
         << endl;

    return 0;
    }
} 
```

既然第二个 if 语句处理小写输入，为什么它会在代码执行时将大写转换为小写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:43:20.443

给定的片段可以是函数的主体：

```
int convert(char& letter)
{
    if (letter >= 'A' && letter <= 'Z')
    {
        letter += 'a' - 'A';
        return 0; // go out of this function...
    }
    else if (letter >= 'a' && letter <= 'z')
    {
        letter += 'A' - 'a';
        return 0; // go out of this function...
    }
    return -1; // it wasn't a letter as we expected
} 
```

请注意，有一条可能的路径与这两种情况都不匹配。假设`letter`是`'?'`，因为您正在返回`int`值，所以应该有迹象表明有问题（这取决于您如何处理错误处理）。

您的 this 函数的可能用法如下所示：

```
char letter = '!';
if (convert(letter) == 0)
    // success ...
else
    // error ... 
```

如果问题真的是关于离开函数的范围，那么这个问题也可能会有所帮助：
[How to break out of a function](https://stackoverflow.com/questions/6302227/how-to-break-out-of-a-function)

* * *

具体例子：

```
void convertLetterAndPrintResult(char& letter)
{
    if (convert(letter) == 0)
        std::cout << letter << std::endl;
    else
        std::cout << "ERROR: '" << letter << "' is not valid character!" << std::endl;
}

int main()
{
    char letter = '!';
    convertLetterAndPrintResult(letter);
    letter = 'g';
    convertLetterAndPrintResult(letter);
    letter = 'L';
    convertLetterAndPrintResult(letter);
} 
```

输出：

```
ERROR: '!' is not valid character!
G
l 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:25:48.557

因为`return 0;`第一部分有一个声明。如果原始字符是大写的，则控制流甚至不会到达第二个嵌套`if () { if () { } }`部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:30:22.123

> 既然第二个 if 语句处理小写输入，为什么它会在代码执行时将大写转换为小写？

那是因为

```
return 0 
```

表示该功能已完成。线条

```
if (letter >= 'a') //test for 'a' or larger
{
    if (letter <= 'z') //test for 'z' or smaller
    {
    cout << endl
         << "You entered a small letter."
         << endl;

    return 0;
    }
} 
```

如果 letter 最初是大写字母，则不会执行。它会打印出“您输入了一个大写字母。”，然后将其转换为小写，然后退出。

> 为什么转换在此语句的末尾而不是之前？

如果转换是在 cout 语句之前进行的，那将没有什么区别。

# java - 松耦合 - 封装之间的区别

> ID：14633524
> 
> 赞同：2
> 
> 时间：2013-01-31T19:22:57.370
> 
> 标签：java, oop, encapsulation, coupling

到目前为止，据我所知，我认为耦合与两个或多个类“互连”的程度有关。换句话说，一个类在多大程度上使用了其他类的方法或变量。我们在设计良好的软件系统中的目标当然是保持低耦合（松散）。

我目前正在阅读一本书，其中明确指出，松散耦合的目标是通过设计系统来实现的，因此每个类只使用其他类的 API（公共方法），而不是直接使用它们的实例变量。因此，实例变量必须是私有的。如果这就是重点，那么松耦合和强封装有什么区别？就我而言，后者指的是封装。关于 OO 软件开发的上述概念，实际上是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:29:07.660

松散耦合不仅仅是使用公共 API，它也是一种*仅*理解该 API 的能力，而不依赖于特定的实现。它还包括限制跨实现差异的依赖代码所需的更改量。

封装不仅仅是禁止直接访问属性。它还包括确保内部数据不会以可能导致无意行为的方式暴露（例如，返回内部结构的防御性副本），并确保*行为*（而不仅仅是数据）被适当隔离，并且责任在适当的地方实施.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T20:07:22.560

通过明智地应用强封装可以适当地实现松散耦合。弱封装可能提供松散耦合，但也可能引入允许在抽象范围之外的方法和变量的可见性的漏洞（无意的紧密耦合）。然而，强封装并不意味着任何关于耦合的事情，因为这种性质的类可以设计为与外部实体松散、紧密或根本不耦合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T09:26:44.863

您可以通过强封装实现松散耦合，但封装本身并不能保证良好的代码和松散耦合。尽管进行了封装，您仍然可以编写紧密耦合的代码。

无需正式封装（访问器/设置器和受限可见性）就可以实现松散耦合（不引入对象/模块之间不必要的依赖关系的规则）。

但是......如果您为自己或一小部分熟练的合作开发人员编写代码，那么直接引用类成员（从而破坏封装）可能有助于保持代码更小，更易于阅读和理解。C# 部分地通过[属性](http://msdn.microsoft.com/en-us/library/x9fsa0sw%28v=vs.80%29.aspx)完成了它——它们看起来像普通的类成员，但实际上是访问器和设置器。

对于更大的团队或可重用的代码，我会说强封装是必须的。但是，您应该始终牢记灵活性——如果您过多地限制您的 API，它将变得无法使用。如果您的代码还不够成熟，无法使用“官方”API 处理所有用例，这一点尤其重要。

# jquery - jQuery ValidationEngine 空验证虽然未设置为必需

> ID：14633526
> 
> 赞同：0
> 
> 时间：2013-01-31T19:22:57.930
> 
> 标签：jquery, validation, jquery-validation-engine

我有一个领域：

```
<input type="text" id="AlternateEmailaddress" name="AlternateEmailaddress" 
       value="" class="validate[custom[email],maxSize[50]] input25" 
       parent_tab="tab2"> 
```

这是自定义电子邮件验证规则：

```
"email": {
    // Shamelessly lifted from Scott Gonzalez via the Bassistance Validation plugin http://projects.scottsplayground.com/email_address_validation/
    "regex": /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
    "alertText": "* Invalid email address"
}, 
```

这不是必需的，但是会触发电子邮件规则。

我在同一页面上也有密码和确认密码字段，它们不是必需的，它们的规则也会触发。

如果不需要此字段，我如何防止它这样做？

jsFiddle 问题演示：http: [//jsfiddle.net/3Pge2/8/](http://jsfiddle.net/3Pge2/8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:17:43.003

我有一个解决方法。我即时分配验证规则，如果值为空白，则将其删除。测试和工作。

```
$("#AlternateEmailaddress").change(function () {
if($("#AlternateEmailaddress").val().trim() != "") {
    $("#AlternateEmailaddress").addClass("validate[custom[email],maxSize[50]]")
    $("#my_info").validationEngine('validate');
} else {
    $("#AlternateEmailaddress").removeClass("validate[custom[email],maxSize[50]]")
}
}); 
```

更新小提琴：http: [//jsfiddle.net/3Pge2/10/](http://jsfiddle.net/3Pge2/10/)

# javascript - 随机图像要更改 src

> ID：14633528
> 
> 赞同：0
> 
> 时间：2013-01-31T19:22:59.783
> 
> 标签：javascript, random, image, src

我想从包含所有图像名称的数组中加载 3 个随机图像。我这样做了，但`src`不起作用。我不知道为什么！这是我的代码：

```
var images = ['image1.jpg', 'image2.jpg', 'image3.jpg'];
var longitut = images.length;
var num =1+ Math.floor(Math.random()*longitut);
var foto="\"image"+num+".jpg\"";
foto=foto.toString();

alert(foto);
document.getElementById("imatge1").src=foto; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:30:14.777

尝试从字符串值中删除引号：

代替

```
var foto="\"image"+num+".jpg\""; 
```

和

```
var foto="image"+num+".jpg"; 
```

此外，请确保您的图像元素具有正确的 id 属性值。在您的情况下，它应该是：

```
<img id="imatge1"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:30:17.200

javascript 代码是正确的，所以一定是您在最后一行输入错误“image1”，或者您的页面中没有元素。

只需将其添加到您的 HTML 页面：

```
<img src="" id="imatge1" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:26:58.210

你这里有一个拼写错误，应该是 image1 而不是 image1 应该是：

```
 document.getElementById("image1").src=foto; 
```

链接时您是否还查看了相对路径和绝对路径？，因为它可能是路径错误。

# ant - 如何将 AntPerformanceListener 添加到 Hudson 作业？

> ID：14633531
> 
> 赞同：2
> 
> 时间：2013-01-31T19:23:11.950
> 
> 标签：ant, build, hudson

我有兴趣能够审核每个 ant 任务运行在 Hudson v1.295 中配置的作业所需的时间。[这个页面](http://neopatel.blogspot.com/2009/09/timestamp-your-ant-build.html)显示了它是如何通过命令行实现的。

> ant -listener net.sf.antcontrib.perf.AntPerformanceListener deploy

我试图通过将以下内容添加到 Hudson job->configure->Invoke Ant 然后在 Targets 顶部添加该行来将其添加到作业中，但它不起作用。

> -listener net.sf.antcontrib.perf.AntPerformanceListener

有人知道如何使用 Hudson 实现这一目标吗？

# iis - 当服务器返回 401 时，Blackberry phonegap 应用程序提示输入凭据

> ID：14633534
> 
> 赞同：1
> 
> 时间：2013-01-31T19:23:22.340
> 
> 标签：iis, cordova, blackberry, asp.net-mvc-4

我正在使用 PhoneGap 开发黑莓应用程序。在登录页面中，如果用户提供了无效凭据并且服务器返回 401 错误，黑莓将显示一个窗口，要求输入用户名和密码。这在 iOS 和 android 中不会发生。有人可以建议如何抑制这个提示吗？我使用 IIS 作为服务器并使用 MVC web api 来开发服务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T12:46:00.527

看起来 BB 存在未经授权的 401 问题。尝试发送不同的代码，例如 HttpStatusCode.BadRequest。应该管用。

# c - 在远程计算机上自动生成客户端的服务器

> ID：14633536
> 
> 赞同：-1
> 
> 时间：2013-01-31T19:23:24.893
> 
> 标签：c, linux, windows, tcp

我正在开发用于自动化测试的代码。自动化是基于client_server。客户端和服务器代码都是用C语言编写的。我有一台服务器和 3 个客户端（这些客户端执行相同的工作）都在不同的电脑上运行。我需要手动运行第一台服务器，然后是所有三个客户端。这三个客户端与服务器建立连接，然后自动化开始。现在我想自动启动这些客户端。我真正想要完成的是运行服务器，服务器自己自动启动这三个客户端（这些客户端将运行的计算机的名称/ip.address是固定的）。我所拥有的只是我知道 pc 的 ip.addresses、这些 pc 上的用户和密码（登录身份验证详细信息）。如何做到这一点。非常感谢任何建议。提前致谢.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:26:16.870

如果您只有身份验证信息，那么您需要考虑使用 ssh for linux 和 rcmd for windows。这两者都将允许您访问远程机器并启动客户端。

尽管您可能应该考虑使用 Windows 服务和 linux 守护程序，因为它们是运行这些项目的标准方式。

# perl - 我可以在 perlpod 文档中嵌入自定义标题吗？

> ID：14633537
> 
> 赞同：4
> 
> 时间：2013-01-31T19:23:26.727
> 
> 标签：perl, perl-pod

在编写将导出为 HTML 的*perlpod文档时，我可以在 POD 指令中嵌入生成的 HTML 文件的标题吗？*

我希望能够使用命令将多个 POD 文本文件转换为 HTML `pod2html`，并且不想`--title="My Title"`在命令行上提供参数。

例如，这是一个带有 perlpod 格式的文本文件：

```
=pod

=head1 This is a heading

This is some text. I'd like to set the title of this document in the resulting HTML file.

=cut 
```

当我将其转换为 HTML 时， pod2html 会发出关于没有标题的警告：

```
$ pod2html test.txt > test.html
/usr/bin/pod2html: no title for test.txt 
```

在生成的 HTML 文件中，标题设置为文件名 (test.txt)：

```
<?xml version="1.0" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>test.txt</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

        <li><a href="#this_is_a_heading_">This is a heading.</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<hr />
<h1><a name="this_is_a_heading_">This is a heading.</a></h1>
<p>This is some text. I'd like to set the title of this document.</p>

</body>

</html> 
```

我想找到一种在 perpod 文档中给出标题的方法，也许有这样的指令：

```
=title This is my custom title 
```

在 Perl 文档中，我看到文档标题设置得很好。这一切都是在 pod 文档本身没有文档标题的情况下完成的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T20:52:21.510

Pod 文档中没有任何内容可以控制文档的标题。这取决于将 Pod 文档转换为您想要的格式的程序。大多数用于生成文档的*pod2doc*程序都有一个类似`Pod::Text`或`Pod::Html`. 这些在转换中完成了大部分繁重的工作。

`pod2html`接受一个`--title`参数。但是，您想要的是 pod2html 无需您指定即可执行此操作。你可以做的是*推出你自己*的 pod2html 版本。让我们看看`pod2html`脚本本身，也许你可以弄清楚你可以做些什么来得到你想要的。

删除所有 POD 文档，我看到::

```
use Pod::Html
pod2html @ARGV 
```

这就是整个程序。

看起来你可以制作一个`pod2steve`程序来做你想做的事。您想要获取最后一个参数（我假设这是您想要的标题），然后简单地将其传递给`pod2html`子例程。你`pod2steve`会看起来像这样：

```
use strict;
use warnings;

use Pod::Html
my $program_name = $ARGV[$#ARGV];
pod2html --title=$program_name @ARGV 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T20:54:00.293

不。

POD 的存在主要是为了编写 Perl 模块文档²，因此没有很多花哨的功能。此外，POD 的主要输出媒介是终端，在概念上不存在标题之类的东西³。毕竟，它只是普通的和旧的文档。 [1\. 令人惊讶的是，许多 Perl 书籍都是用 POD 编写的。
    2\. POD 文件的位置与文中讨论的内容一致。
    3.`ps`名称/`$0`变量接近，但在这里没用。]

这也是一个技术问题：`pod2html`uses ，它解析命令行，并在不做或干扰实际解析的情况下[`Pod::Html`](https://metacpan.org/source/RJBS/perl-5.16.2/ext/Pod-Html/lib/Pod/Html.pm)将自身包裹起来或其他东西。[`Pod::Simple::XHTML`](https://metacpan.org/source/DWHEELER/Pod-Simple-3.23/lib/Pod/Simple/XHTML.pm)但是，它已经提供了一个页眉和一个页脚，它们明智地覆盖了任何可能发出的默认页眉。

有两个有趣的选项可以解决您的问题：

1.  您编写一个后处理器，将 first 的值`h1`放入`title`. 在支持 XPath 的解析器中，这应该少于 10 行。然后你编写一个小脚本将它们联系在一起，并且可以被调用而不是`pod2html`.

2.  您利用现有的丰富的 POD 解析器（和源代码），并从 POD 生成器中生成您自己的 HTML。如果您实际上所做的只是一个小叉子，您可以尝试提供对原始模块的修改。

# ruby - 在分块 Ruby 数组时获取块的开始索引作为结果的一部分

> ID：14633543
> 
> 赞同：2
> 
> 时间：2013-01-31T19:23:55.120
> 
> 标签：ruby, arrays, chunking

我有一种情况，我想将初始化的数组`nils`分成空段和包含连续数字运行的段。

我发现高阶`chunk`函数 为`Array`这个问题提供了一个优雅的解决方案：

```
<< [nil,nil,1,2,nil,3].chunk { |e| !e.nil? }.each { |e| p e }

>> [false, [nil, nil]]
>> [true, [1, 2]]
>> [false, [nil]]
>> [true, [3]] 
```

但是，假设我希望输出还包含每个块中原始数组的起始索引，即将上面的输出增加为：

```
>> [false, 0, [nil, nil]]
>> [true, 2, [1, 2]]
>> [false, 4, [nil]]
>> [true, 5, [3]] 
```

是否有一种解决方案可以保留上述块片段的表现力？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:36:15.893

一种功能模块化方法：索引输入数组块，并将其映射到所需的输出 O(n)：

```
data = xs.each_with_index.chunk { |x, i| !x.nil? }.map do |match, pairs| 
  [match, pairs.first[1], pairs.map(&:first)] 
end
#=> [[false, 0, [nil, nil]], [true, 2, [1, 2]], [false, 4, [nil]], [true, 5, [3]]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:35:31.463

您可以`chunk`自己浏览并跟踪起始索引的输出。只需按每个块的长度递增它。这是我的快速尝试。

```
chunked = [nil,nil,1,2,nil,3].chunk { |e| !e.nil? }

_, chunks_with_embedded_index = chunked.each_with_object([0, []]) do |(k, chunk), memo|
  memo[1] << [k, memo[0], chunk]
  memo[0] += chunk.length
end

chunks_with_embedded_index.each {|c| p c }
# >> [false, 0, [nil, nil]]
# >> [true, 2, [1, 2]]
# >> [false, 4, [nil]]
# >> [true, 5, [3]] 
```

您可以将最后一个索引的临时变量提取到一个完整的局部变量中，并且实现更简洁：

```
chunked = [nil,nil,1,2,nil,3].chunk { |e| !e.nil? }

last_index = 0
chunks_with_embedded_index = chunked.reduce([]) do |memo, (k, chunk)|
  memo << [k, last_index, chunk]
  last_index += chunk.length
  memo
end

chunks_with_embedded_index.each {|c| p c }
# >> [false, 0, [nil, nil]]
# >> [true, 2, [1, 2]]
# >> [false, 4, [nil]]
# >> [true, 5, [3]] 
```

# asp.net-mvc-4 - 为什么 _Layout.cshtml 默认放在 ~/Views/Shared 文件夹中？

> ID：14633544
> 
> 赞同：2
> 
> 时间：2013-01-31T19:23:55.633
> 
> 标签：asp.net-mvc-4

为什么默认`_Layout.cshtml`放在文件夹中？`~/Views/Shared`

我问这个问题是因为我把这个文件放在`~/Views`文件夹中并更改`Layout`了`_ViewStart.cshtml`

```
@{
    Layout = "~/views/_Layout.cshtml";
} 
```

它仍然有效。

是否出于特殊目的默认`_Layout.cshtml`放置在文件夹中？`~/Views/Shared`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:03:53.180

按照惯例，该`/views/shared`文件夹用于由不同控制器*共享*的视图，例如布局和可重用的局部视图。如您所见，没有理由不能将布局放在您想要的任何位置，只要您正确引用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T20:05:15.077

当布局页面由其完整路径引用时，您是对的，它在哪里没有区别，只要它位于 ~/Views 文件夹下的某个位置。

一种重要的情况（但通常不重要）是，当您在控制器操作中调用“View()”的重载时，它允许您指定备用布局（主）页面。如果是这种情况，并且指定的名称是“简单”名称，例如“MobileLayout”，则默认搜索路径将首先是当前控制器的视图文件夹，然后是共享视图文件夹。

另一个更简单的原因是它在约定方面“有意义”，而不管任何技术要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-24T10:15:54.643

*   如果将`_Layout.cshtml`in`Views`文件夹放入，则必须在`Layout="_Layout.cshtml"`.

*   如果您将`_Layout.cshtml`in`Views/Shared`或`Views/XXX`文件夹放入，则**不得**在`Layout="_Layout"`.

# sql - 具有 5 个表的复杂 SQL 连接

> ID：14633547
> 
> 赞同：6
> 
> 时间：2013-01-31T19:24:02.983
> 
> 标签：sql, join, create-table

我正在开发一个相对庞大的应用程序，其中包含很多表。我必须编写一个 SQL 查询，简化后涉及 5 个表（请参阅连接的 jpg）。

这个想法如下：人有地址，地址有一个类型（私人，专业等）和一个国家。人们也可以有选择。这些选项（在选项表中以 name_id 说明）可以链接到地址类型。

这个想法是提取所有拥有一个或多个地址的人，这些地址由一个国家指定，并且他们也出现在 [option address] 表中。

例如，假设我们想要地址为 country_id=1 的人。结果集必须排除那些没有与其选项相关联的相同地址类型的人。

嗯......我不确定我是否了解自己:)

但无论如何，这里是创建所有东西的 SQL。

```
CREATE TABLE `address` (
  `person_id` int(11) NOT NULL,
  `type_id` int(11) NOT NULL,
  `country_id` int(11) NOT NULL,
  UNIQUE KEY `apt` (`person_id`,`type_id`),
  KEY `apid` (`person_id`),
  KEY `atid` (`type_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `address` (`person_id`, `type_id`, `country_id`) VALUES
(1, 1, 1),
(2, 2, 1),
(3, 1, 1),
(3, 2, 2),
(5, 1, 2),
(6, 2, 1),
(7, 1, 1),
(7, 2, 2),
(8, 1, 1),
(9, 2, 1);

CREATE TABLE `address_type` (
  `id` int(11) NOT NULL,
  UNIQUE KEY `tid` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `address_type` (`id`) VALUES
(1),
(2);

CREATE TABLE `option` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name_id` int(11) NOT NULL,
  `person_id` int(11) NOT NULL,
  UNIQUE KEY `oid` (`id`),
  UNIQUE KEY `onp` (`name_id`,`person_id`),
  KEY `opid` (`person_id`),
  KEY `on` (`name_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=9 ;

INSERT INTO `option` (`id`, `name_id`, `person_id`) VALUES
(1, 1, 1),
(2, 1, 2),
(3, 1, 3),
(4, 1, 5),
(5, 1, 6),
(6, 1, 7),
(7, 1, 8),
(8, 1, 9);

CREATE TABLE `option_address_type` (
  `option_id` int(11) NOT NULL,
  `type_id` int(11) NOT NULL,
  UNIQUE KEY `ot` (`option_id`,`type_id`),
  KEY `ooid` (`option_id`),
  KEY `otid` (`type_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `option_address_type` (`option_id`, `type_id`) VALUES
(1, 1),
(2, 2),
(3, 1),
(3, 2),
(4, 2),
(5, 1),
(6, 1),
(7, 1),
(7, 2),
(8, 1),
(8, 2);

CREATE TABLE `person` (
  `id` int(11) NOT NULL,
  UNIQUE KEY `pid` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `person` (`id`) VALUES
(1),
(2),
(3),
(4),
(5),
(6),
(7),
(8),
(9);

ALTER TABLE `address`
  ADD CONSTRAINT `address_ibfk_1` FOREIGN KEY (`person_id`) REFERENCES `person` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `address_ibfk_2` FOREIGN KEY (`type_id`) REFERENCES `address_type` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE `option`
  ADD CONSTRAINT `option_ibfk_1` FOREIGN KEY (`person_id`) REFERENCES `person` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE `option_address_type`
  ADD CONSTRAINT `option_address_type_ibfk_1` FOREIGN KEY (`option_id`) REFERENCES `option` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `option_address_type_ibfk_2` FOREIGN KEY (`type_id`) REFERENCES `address_type` (`id`) ON DELETE CASCADE ON UPDATE CASCADE; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:40:04.447

那这个呢：

```
select person_id
from   address adr
,      `option` opt
,      option_address_type opt_adt
where  adr.country_id = 1
and    opt.person_id = adr.person_id
and    opt_adt.option_id = opt.option_id
and    opt_adt.type_id = adr.type_id 
```

或者

```
select person_id
from   address adr
inner join   `option` opt
  on     opt.person_id = adr.person_id
  and    adr.country_id = 1
inner join    option_address_type opt_adt
  on      opt_adt.option_id = opt.option_id
  and    opt_adt.type_id = adr.type_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T20:03:22.817

我不确定我是否完全理解您想要的结果。当国家为1时，排除地址类型不等于选项地址类型的人？

像这样的东西？

```
SELECT p.id
FROM Person p
    JOIN address a ON p.Id = a.Person_ID
    JOIN address_type at ON a.Type_ID = at.Id
    JOIN `option` o ON p.Id = o.person_Id
    JOIN option_address_type oat ON o.id = oat.option_id
WHERE a.country_id = 1 AND at.id <> oat.type_id; 
```

还有[SQL 小提琴](http://sqlfiddle.com/#!2/3e8ad/13)。

祝你好运。

# php - HTML 表单和会话

> ID：14633554
> 
> 赞同：0
> 
> 时间：2013-01-31T19:24:20.477
> 
> 标签：php, html, web

我想在没有 JavaScript、AJAX 或数据库的情况下执行以下操作。只有 HTML 和 PHP。

这是场景：

我在一个表单中有两个 HTML 输入。此表单通过 POST 方法发送两个值（姓名和年龄）。我从这些值创建一个用户对象，将这些值存储在 SESSION 中，然后在表单下方打印用户信息。我创建用户对象没有问题。

我怎样才能打印出所有用户的信息。例如第一个用户输入他的信息并点击提交，我们有：

```
 - John
 - 18 years 
```

第二个用户输入他的信息并点击提交，我们有：

```
- John
- 18 years

- Kevin
- 20 years 
```

第三个用户输入他的信息并点击提交，我们有：

```
- John
- 18 years

- Kevin
- 20 years

- Bryan
- 19 years 
```

等等？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:29:22.067

您可以继续将这些内容存储在会话中，以便以后在同一会话中使用。但另一种方法可能是将它们存储在 cookie 中，这两种方法只有在您在一台计算机上输入所有信息时才有效。

如果您想让您的网站将其输出给所有其他用户，您需要一个数据库或其他类似的东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:41:59.573

您应该将数据存储在数组中，并在每次提交时附加到数组中。

```
<?php

    session_start();
    $data = array();
    if(isset($_SESSION['data'])) {
        $data = $_SESSION['data'];
    }
    if(isset($_POST['name']) && isset($_POST['age'])) {
        // -- append to the array
        $data[] = array('name'=>$_POST['name'],'age'=>$_POST['age'],);

        // -- update the session
        $_SESSION['data'] = $data;
    }
?>
<!DOCTYPE html>
<html>
 <head>
 </head>
 <body>
    <form action="" method="post">
      Name:<br />
      <input type="text" name="name" size="10" /><br />
      Age:<br />
      <input type="text" name="age" size="2" /><br />
      <br />
        <input type="submit" />
    </form>
    <?php foreach($data as $d) { ?>
        - <?php echo $d['name']; ?><br />
        - <?php echo $d['age']; ?><br /><br />
    <?php } ?>
 </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:30:34.667

说，您的代码类似于

```
$name = $_Post['name'];
$age = $_Post['age']; 
```

进而

`$name`对和使用 sessiona 变量数组`$age`

另外，请参阅Kaleb Brasee 的这个惊人的[回答，在同一个链接上，Sarfraz 已经详细解释了它......会对你有很大帮助](https://stackoverflow.com/questions/2306159/array-as-session-variable)

# javascript - 防止 ArrayController 添加验证失败的模型

> ID：14633564
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:15.727
> 
> 标签：javascript, ember.js

工作流程是：

1.  用户在新页面上。
2.  点击保存，导致模型验证失败。显示了绑定到模型的错误。仍然在同一页面上。
3.  用户现在导航到索引页面并看到添加到列表中的无效记录。

ArrayController 似乎正在添加验证失败的记录。

```
App.CompaniesNewRoute = Ember.Route.extend({

    model: function(){
      var company = App.Company.createRecord();
      this.wireObservers(company, this);
      return company;
    },

    events: {
      save: function(){
        var controller = this.controllerFor(this.routeName);
        controller.get('transaction').commit();
      }
    },

   wireObservers: function(company, router) {
     company.on('becameInvalid', function(record){
      // do something to remove it from the arraycontroller
      // record.rollback();
     });

     company.on('didCreate', function(){
       router.transitionTo('companies.index')
     });
   })
}) 
```

该`becameInvalid`事件确实被调用。执行 a`record.rollback()`会引发异常：

```
Uncaught Error: Attempted to handle event `becameClean` on     <App.Company:ember612:null> while in state rootState.loaded.created.invalid. Called with undefined ember-data.js:3495
DS.StateManager.Ember.StateManager.extend.unhandledEvent ember-data.js:3495 
```

有没有办法防止 ArrayController 添加验证失败的记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T01:52:04.187

尝试通过存储回滚事务。

```
 wireObservers: function(company, router) {
     var _self = this;
     company.on('becameInvalid', function(record){
      // do something to remove it from the arraycontroller
       _self.store.rollback();
     });

     company.on('didCreate', function(){
       router.transitionTo('companies.index')
     });
   }) 
```

您应该考虑为此目的创建一个特定的事务，而不是使用默认事务。要在路由中创建新事务，您可以执行以下操作

```
App.MyRoute = Ember.Route.extend({
    transaction: this.store.transaction();
}) 
```

然后创建您的记录并将其添加到交易中

```
var company = this.transaction.createRecord(App.Company); 
```

最后提交或回滚事务

```
this.transaction.commit();
this.transaction.rollback(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T22:02:39.763

在您的情况下，我认为 rollback() 不是解决方案，因为事务已经提交；即使服务器验证失败，记录也已添加到 ArrayController 内容中。

我可以看到的解决方案是使用 deleteRecord 函数，如下所示：

```
wireObservers: function(company, router) {
 company.on('becameInvalid', function(record){
   record.deleteRecord();
 });

 company.on('didCreate', function(){
   router.transitionTo('companies.index');
 }); 
```

})

我只是对您的工作流程有疑问。当您收到验证错误并离开页面时，这意味着用户取消了记录创建

# c# - AppFrabric 缓存已清除，但表现得好像没有

> ID：14633565
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:17.183
> 
> 标签：c#, caching, azure, cloud, appfabric

所以，我有一个有趣的问题。我们正在使用 AppFabric 并将大量数据缓存到其中。具有将存储到缓存中的某些方面以及在调用时清除特定键的缓存的方法。但是，我遇到了一个奇怪的问题，我有一个“幻像”缓存。

所以这里是创建场景。

2个浏览器（firefox和chrome），1个有管理员，第二个是普通用户。

1.  等到缓存过期（5 分钟）然后检查缓存以确保其清除。这是。
2.  接下来刷新普通用户以插入缓存，用管理员验证它的存在。这是。
3.  使用管理员更新用户（更新期间清除缓存）验证其已被清除。这是。
4.  刷新普通用户浏览器，看看它是否改变了。它没有

这是最后一个问题。我已经清除了缓存，验证了它的清除，但其他浏览器的行为就像它没有清除它一样。这并不总是发生，但经常发生，以至于我正在努力解决它。

有人对这可能是什么有任何想法吗？

更新一般缓存模式。对不起，我不能分享细节。

1.  PostSharp 属性来拦截方法调用并执行缓存。
    1.  检查 httpContext 缓存
    2.  检查 Azure 缓存
        *   如果有，则放入 httpContext 缓存
    3.  运行方法
        *   发送到 httpContext 缓存
        *   使用 httpcontext 缓存将请求结束的队列推送到 azure 缓存
2.  全局操作过滤器在请求结束时将排队的缓存值传输到天蓝色。
    1.  如果子动作返回
    2.  遍历队列并将新项目放入 Azure 缓存
    3.  清除队列中项目的 httpcontext 缓存

这提供了一种现成的访问方式，每次请求仅获取一次缓存项，并让任何 azure put 在请求结束时发生，在整个请求处理过程中收集它们之后。

# jquery - 带数组的动态 json

> ID：14633570
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:31.887
> 
> 标签：jquery, json, yii

我使用 YII 并将数据作为“table[attr1]=1&table[attr2]=2&table[attr3]=3”发送，因此使用 jquery 发出请求我使用：

```
 $.ajax({  
        url:"url",
        data:{
             'table[attr1]':1,
             'table[attr2]':2,
             'table[attr3]':3,
        },
        success:function(resp){
            //ok
        }
    }); 
```

但我需要动态地制作这个数据 json，我尝试了这个，但工作量不大：

```
$("input").each(function(){ //build the data json       
    form.table[this.name]=this.value;  //the name is 'attr1' , the value is 1
});  

     $.ajax({  
        url:"url",
        data:form, //send the JSON here
        success:function(resp){
            //ok
        }
    }); 
```

这会将数据发送为空

任何想法如何构建这个json？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:32:38.057

你可以这样做

```
var form = {}; // create object
$('input').each(function(){
    form[this.name] = this.value; // add name/value
}); 
```

然后表单将根据名称/值保存一个对象，并假设您的元素名称是`table[attr1]`等

```
{
  'table[attr1]': 1,
  'table[attr2]': 2,
  'table[attr3]': 3,
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:34:11.190

您发送的内容不涉及 JSON，要使`x-www-form-urlencoded`您的代码正常工作，您必须首先创建表单对象的 table 属性。

```
var form = {table:{}};
$("input").each(function(){  
    form.table[this.name] = this.value;  //the name is 'attr1' , the value is 1
});
$.ajax({  
    url:"url",
    data:form, 
    success:function(resp){
        //ok
    }
}); 
```

# android - 当我有 2 个场景时如何完成我的活动

> ID：14633572
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:43.370
> 
> 标签：android, android-activity

我有一项活动，可以制作一些东西，然后开始另一项活动。第一个活动必须在创建第二个活动后完成。在这种情况下，我希望它只以默认的 onDestroy() 结束。但是，如果用户在第一个活动未完成时按下返回键（硬件一个），我希望它在完成之前调用一个函数。有什么温和的方法可以实现吗？我考虑覆盖返回键的默认操作，但它是唯一且最优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:31:03.353

您可以在第一个活动中声明一个标志，指示它是否已完成。

```
public class Activity1 extends Activity {
    private boolean workDone = false;

    . . .

    @Override
    protected void onDestroy() {
        if (!workDone) {
            specialFunction();
        }
        super.onDestroy();
    }
} 
```

然后在某个地方`Activity1`，当它完成了必要的工作后，就设置了`workDone = true`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:37:13.620

覆盖`onBackPressed`方法没问题。

> **公共无效 onBackPressed ()**
> 
> 当活动检测到用户按下返回键时调用。默认实现只是完成当前活动，但您可以覆盖它来做任何您想做的事情。

[http://developer.android.com/reference/android/app/Activity.html#onBackPressed()](http://developer.android.com/reference/android/app/Activity.html#onBackPressed())

* * *

```
public void onBackPressed() {
    // do something.
    super.onBackPressed();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:30:28.570

好吧，您可以覆盖 onBackButtonPressed()，然后调用 super.onBackButtonPressed，这样您就不会错过超类所做的任何事情，但是您可以在调用中添加内容。onDestroy() 也是如此

在这个例子中，utask 是我想要杀死的异步任务。

```
 @Override
    protected void onStop() {
        utask.cancel(true);
        super.onStop();

    }

    @Override
    public void onBackPressed() {
        // TODO Auto-generated method stub
        utask.cancel(true);
        super.onBackPressed();

    }

    @Override
    protected void onDestroy() {
        // TODO Auto-generated method stub
        utask.cancel(true);
        super.onDestroy();

    } 
```

# javascript - 仅在单击时加载 Fancybox

> ID：14633577
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:50.023
> 
> 标签：javascript, jquery, html, charts, fancybox

我是劳德代尔堡的一名设计师，我在我的一个项目中使用了 fancybox.js。我有一个主登录页面，其中有一个巨大的名称图表，当您单击名称时，fancybox 会弹出更多信息、照片等。但是，当我加载此主页时，它会尝试加载所有整个网站的内容，它需要永远。有没有一种方法可以将fancybox.js 设置为仅在fancybox 被点击/可见时加载？

我已经阅读了有关如何在页面加载时启动 Fancybox 的教程，而我基本上想做相反的事情。我只希望在单击时加载fancybox，以便主登录页面运行得更快。[如何在页面加载时启动 jQuery Fancybox？](https://stackoverflow.com/questions/807271/how-to-launch-jquery-fancybox-on-page-load/3728591#3728591)

我会很感激你能给的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:12:27.380

只需在您的 html 中执行：

```
<a class="fancybox" href="{target}">the link I want to open on click only</a> 
```

..然后使用这个脚本

```
$(document).ready(function(){
  $(".fancybox").fancybox({
    // API options
  });
}); 
```

检查您可能需要或想要添加的 API 选项的文档：fancybox v1.3.4 [http://fancybox.net](http://fancybox.net)和 fancybox v2.x [http://www.fancyapps.com/fancybox/](http://www.fancyapps.com/fancybox/)

# javascript - javascript数组 - 访问json类型的对象

> ID：14633579
> 
> 赞同：0
> 
> 时间：2013-01-31T19:25:54.657
> 
> 标签：javascript

编码：

* * *

```
function getDummyDetails(){
 var userDetailsMap = [];
 userDetailsMap.push({key:'APPCODE', value:'41'});
 userDetailsMap.push({key:'WORKERNUMBER', value:'1234567'});
 userDetailsMap.push({key:'ACCOUNTID', value:'DEVELOP'});
 userDetailsMap.push({key:'NAMEFIRST', value:'John'});
 userDetailsMap.push({key:'NAMELAST', value:'Developer'});

return userDetailsMap; 
```

}

```
 function someOtherFunction () {

var userDetails = getDummyDetails();  
document.getElementById("userName").innerHTML = "User Name: " + userDetails[3].value + ", " + userDetails[4].value; 
```

}

* * *

在这里，它工作正常，但我不能在这里使用数组索引，如 userDetails[3].value。我试图做这样的事情

```
 userDetails["APPCODE"].value; // just a pseudo code 
```

如何使用该字符串值而不是整数索引该数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:27:16.833

您应该创建一个对象而不是数组。这样你就可以通过它的密钥访问它：

```
function getDummyDetails() {
    return {
        'APPCODE':'41',
        'WORKERNUMBER':'1234567',
        'ACCOUNTID':'DEVELOP',
        'NAMEFIRST':'John',
        'NAMELAST':'Developer'
    };
}

function someOtherFunction () {
    var userDetails = getDummyDetails();  
    userDetails["APPCODE"] // 41 - use it however you want...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:28:11.903

您需要创建一个对象，而不是数组：

```
var userDetailsMap = {
  APPCODE:41
}

var value = userDetailsMap["APPCODE"];//value now = 41 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:29:23.127

如果你不想改变你的结构，你可以遍历你的数组：

```
for (var i = 0, len = userDetailsMap.length; i < len; i++) {
  if (userDetailsMap[i].key == 'APPCODE') {
    var val = userDetailsMap[i].value;
    // do something with the value here
  } 
} 
```

# php - 即使在有效输入后，recaptcha 验证也返回无效

> ID：14633581
> 
> 赞同：0
> 
> 时间：2013-01-31T19:26:02.870
> 
> 标签：php, joomla, recaptcha

我已经激活了我的 recaptcha 的密钥，然后使用以下代码实现了它：

形式：

```
<?php
JPluginHelper::importPlugin('captcha');
$dispatcher = JDispatcher::getInstance();
$dispatcher->trigger('onInit','dynamic_recaptcha_1');
?>

<form ............>
.............
<div id="dynamic_recaptcha_1"></div>
<input type="hidden" name="recaptcha_response_field">
</form> 
```

然后在控制器中，我正在验证验证码，如下所示：

```
 $capatcha = JRequest::getVar('recaptcha_response_field', 'POST');

 JPluginHelper::importPlugin('captcha');
 $dispatcher = JDispatcher::getInstance();
 $res = $dispatcher->trigger('onCheckAnswer',$capatcha);

 if(!$res[0]){
    $errors['captcha'] = "Invalid Captcha";
 } 
```

问题是即使我提供正确的验证码值，我也会收到无效验证码通知。

另外我必须说我不相信在我的组件中集成recaptcha的方法，因为我不能在这里修改/自定义任何东西`<div id="dynamic_recaptcha_1"></div>`。所以，如果有人能给我一个更好的主意，将 recaptcha 集成到 joomla 组件中，我会很高兴。我发现如果我没有连接到互联网，我的验证码集成方法就不起作用。所以，我想使用 libcaptcha.php 以便即使我离线也能显示至少验证码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:44:36.520

现在它工作正常。问题出在`<input type="hidden" name="recaptcha_response_field">`. 我不知道我为什么使用它。我删除了该字段的行，现在它工作正常。

但我还不相信recaptcha 集成，因为我无法控制它。如果有人能给我一个更好的想法来在组件中实现验证码，我将不胜感激。请注意，我没有使用 jform。

# java - 单线程程序与多线程程序（测量时间）

> ID：14633587
> 
> 赞同：3
> 
> 时间：2013-01-31T19:26:23.720
> 
> 标签：java, multithreading, single-threaded

我想知道我是否需要测量经过的时间，那么这是一个好`Single Threaded Program`方法还是`Multithreading Program`一个好的方法。

下面是我的单线程程序，它正在测量我们的服务时间-

```
private static void serviceCall() {

    histogram = new HashMap<Long, Long>();
    keys = histogram.keySet();
    long total = 5;
    long runs = total;

    while (runs > 0) {

        long start_time = System.currentTimeMillis();
        result = restTemplate.getForObject("SOME URL",String.class);
        long difference = (System.currentTimeMillis() - start_time);

        Long count = histogram.get(difference);
        if (count != null) {
            count++;
            histogram.put(Long.valueOf(difference), count);
        } else {
            histogram.put(Long.valueOf(difference), Long.valueOf(1L));
        }
        runs--;
    }

    for (Long key : keys) {
        Long value = histogram.get(key);
        System.out.println("MEASUREMENT " + key + ":" + value);
    }
} 
```

我从这个单线程程序得到的输出是 - 总调用是`5`

```
MEASUREMENT 163:1
MEASUREMENT 42:3
MEASUREMENT 47:1 
```

这意味着`1`电话回来了`163 ms`。`3`电话回来了`42 ms`等等。

而且我也尝试过使用`Multithreaded program`来测量经过的时间。意思是用少量线程并行访问服务，然后测量每个线程占用了多少。

下面也是该代码 -

```
//create thread pool with given size 
    ExecutorService service = Executors.newFixedThreadPool(10);

// queue some tasks 
for (int i = 0; i < 1 * 5; i++) {
    service.submit(new ThreadTask(i, histogram));
}

public ThreadTask(int id, HashMap<Long, Long> histogram) {
    this.id = id;
    this.hg = histogram;
}

@Override
public void run() {

    long start_time = System.currentTimeMillis();

    result = restTemplate.getForObject("",  String.class);
    long difference = (System.currentTimeMillis() - start_time);

    Long count = hg.get(difference);
    if (count != null) {
        count++;
        hg.put(Long.valueOf(difference), count);
    } else {
        hg.put(Long.valueOf(difference), Long.valueOf(1L));
    }

} 
```

以下是我从上述程序中得到的结果-

```
{176=1, 213=1, 182=1, 136=1, 155=1} 
```

**一个电话在 176 毫秒内返回，依此类推**

**所以我的问题是为什么多线程程序比上面的单线程程序要花费更多的时间？**如果我的多线程程序中有一些漏洞，谁能帮我改进它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:31:03.730

您的多线程程序可能会同时发出所有请求，这会给服务器带来更大的压力，这将导致它对所有请求的响应速度变慢。

顺便说一句，您进行更新的方式不是线程安全的，因此在多线程场景中，如果有足够的试验，您的计数可能会关闭。

例如，线程 A 和 B 都在 100 毫秒内同时返回。100 的直方图中的计数为 3。A 得到 3。B 得到 3。A 将 3 更新为 4。B 将 3 更新为 4。A 将值 4 放入直方图中。B 将值 4 放入直方图中。您现在有 2 个线程认为它们增加了计数，但直方图中的计数仅反映增加了一次。

# django - 我应该如何暂存我的 bitbucket + heroku django 应用程序以进行开发和部署？

> ID：14633588
> 
> 赞同：2
> 
> 时间：2013-01-31T19:26:39.460
> 
> 标签：django, git, heroku, bitbucket, heroku-toolbelt

我应该如何暂存我的 bitbucket + heroku django 应用程序以进行开发和部署？

我正在开发一个 Django 应用程序。我不想使用 github，因为我想托管一个私人仓库。所以现在我知道如何在 heroku 上部署应用程序，但我如何通过 bitbucket 来部署？

这个部署关键的东西是什么？我是否必须重置我的 git 远程来源或其他什么？我是否使用不同的文件夹进行部署？并将我的源代码提交到不同的文件夹？

当我想将我的开发环境扩展到多台计算机时会发生什么？我知道我将使用 git 来监控对 repo 的更改，我应该如何让它们全部部署到 heroku？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T20:39:28.723

将您的遥控器更改`git`为指向您的`bitbucket`URL，然后照常进行。

您的遥控器`origin`将是您在设置中找到的 bitbucket 的 URL。您的遥控器`heroku`将指向 Heroku。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-08T11:15:51.177

@dan-hoerst 的回答仍然正确，但我想提请注意 heroku 的新管道功能，它可以让您以更好的方式处理暂存和生产环境。

> 管道是一组共享相同代码库的 Heroku 应用程序。管道中的应用程序分为“审查”、“开发”、“暂存”和“生产”阶段，代表持续交付工作流程中的不同部署步骤。

你可以在这里找到更多关于它的信息[https://devcenter.heroku.com/articles/pipelines](https://devcenter.heroku.com/articles/pipelines)

# rally - API：查询与特定测试用例关联的测试集

> ID：14633596
> 
> 赞同：0
> 
> 时间：2013-01-31T19:27:05.687
> 
> 标签：rally

是否可以使用 WSAPI 找到与特定 TestCase 关联的 TestSet 列表？

当您在 Rally 中查看 TestCase 时，您可以简单地单击 TestSet 选项卡，因此这似乎应该是可能的。但是，根据 WSAPI Doc，我看不到如何执行此操作，因为 TestCase 上没有 TestSet 字段。

而且，你似乎不能走另一条路，因为虽然 TestSets 有一个 TestCase 字段，但文档说你不能查询它。那么这是怎么做到的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:14:00.030

I wish I had a better answer for you, but unfortunately this is a somewhat annoying quirk of the WSAPI data model when it comes to Test Cases. As you've observed, unfortunately there's not a Test Set attribute on Test Cases.

The only way to really handle this is client side, and it's somewhat painful. You have to obtain the TestCases collection off of each TestSet, and then loop through that collection (an array of TestCase ref's) to see if there's a match with your particular TestCase of interest.

# c# - 在两个大括号结束之前将文本写入 .CS 文件

> ID：14633597
> 
> 赞同：1
> 
> 时间：2013-01-31T19:27:14.993
> 
> 标签：c#, .net, winforms, file-io

我有一个要求，我必须做以下事情：

1.  动态生成代码
2.  将代码写入现有的 .cs 文件
3.  我必须在类文件的最后两个大括号之前添加代码。

例如，类文件是：

```
namespace Stackoverflow
{
    public class AskQuestion
    {
        public void Ask()
        {
        }

    //Add the generated code here.
    }
} 
```

我尝试了以下代码：创建了一个类 FindBraceLocation

```
namespace DBInfo.Class
{
    public class FindBraceLocation
    {
        private int _bracePositionInLine;
        private int _noOfBraceFound;
        private int _lineNoIndex;
        private readonly string[] _fs;

        public int LineNoIndex
        {
            get { return _lineNoIndex; }
            set { _lineNoIndex = value; }
        }

        public int BracePositionInLine
        {
            get { return _bracePositionInLine; }
            set { _bracePositionInLine = value; }
        }

        public int NoOfBraceFound
        {
            get { return _noOfBraceFound; }
            set { _noOfBraceFound = value; }
        }

        public FindBraceLocation(string[] allLines)
        {
            _bracePositionInLine = -1;
            _noOfBraceFound = 0;
            _lineNoIndex = 0;
            _fs = allLines;
        }

        public void SearchFileStringIndex()
        {
            int noOfLines = _fs.Length;
            string line;
            int lineCounter;
            int pos2 = -1;

            for (lineCounter = noOfLines - 1; lineCounter >= 0; lineCounter--)
            {
                line = _fs[lineCounter];
                if (line.Trim().Length == 0)
                {
                    continue;
                }
                pos2 = FindIndexOfBrace(line);
                if (pos2 != -1)
                    break;
            }

            _lineNoIndex = lineCounter;
            _bracePositionInLine = pos2;
        }

        public int FindIndexOfBrace(string line)
        {
            //int braceNo = _noOfBraceFound;

            for (int counter = line.Length - 1; counter >= 0; counter--)
            {
                if (line[counter] == '}' && (++_noOfBraceFound == 2))
                {
                    return counter;
                }
            }
            return -1;
        }
    }

} 
```

并使用以下方法将其写入文件：

```
 protected void WriteToExistingGeneratedFile(string strInfo, string strPath)
        {
            string[] allLines = File.ReadAllLines(strPath);
            FindBraceLocation fp = new FindBraceLocation(allLines);
            fp.SearchFileStringIndex();
            string lineForInsertion = allLines[fp.LineNoIndex];
            string tempLine = lineForInsertion.Substring(0, fp.BracePositionInLine) + "\n" + strInfo + "\n" + lineForInsertion.Substring(fp.BracePositionInLine);
            allLines[fp.LineNoIndex] = tempLine;
            File.WriteAllLines(strPath, allLines);

        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T19:36:46.327

无需修改现有文件，而是动态生成第二个文件并[使用`partial`关键字](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)向类添加新成员。

*静态文件：*

```
namespace Stackoverflow
{
    public partial class AskQuestion
    {
        public void Ask()
        {
        }
    }
} 
```

*生成的文件：*

```
namespace Stackoverflow
{
    partial class AskQuestion
    {
        // Dynamically generated methods and properties
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:07:32.003

如果您使用流阅读器，则可以在其上使用普通的字符串函数。像这样的东西会起作用：

```
System.IO.StreamReader myFile =
new System.IO.StreamReader("c:\\test.cs");
string myString = myFile.ReadToEnd();

// This will error if there are not at least 2 parentheses.
string UpToLastParan = myString.Text.Substring(0, myString.LastIndexOf("}"));
int SecondToLast = UpToLastParan.LastIndexOf("}");
string UpToSecondToLastParan = myString.Substring(0, SecondToLast);
string CorrectedString = UpToSecondToLastParan + "Your Code Here" + myString.Substring(SecondToLast, myString.Length - SecondToLast);

// Write back to file. 
```

# javascript - 如何在Javascript中比较两个包含数字的字符串？

> ID：14633602
> 
> 赞同：1
> 
> 时间：2013-01-31T19:27:26.577
> 
> 标签：javascript

例如，我想比较 0-91 和 0-93 ，在我使用的逻辑中，0-93 比 0-91 大，因为我只查看 0- 之后的数字，即 91和 93 。基本上我正在构建一个表格，它检查数字范围，但在表格中，数字可以输入例如 91 和 93 ，但它们通常输入为 0-91 和 0-93 ，我怎么能编写javascript逻辑，以便在比较两个数字时忽略0-？

基本上将 0-91 和 0-93 转换为整数 91 和 93 ，然后比较它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:31:28.783

一种方法是：

```
var a = '0-91',
    b = '0-93',
    max = Math.max(a.slice(2), b.slice(2)), // for example
    max2 = Math.max(a.substr(-2), b.substr(-2)); // will work if a = "91" and b = "93" 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:05:19.210

如果您想要支持：

*   范围或无范围（“0-93”或“93”）
*   更多或更少的数字（“0-999”或“9”）

这是解决它的一种方法：

```
function numberFromInput(value) {
  return Number(value.match(/[-]?(\d*)$/).pop());
}

Math.max(numberFromInput("91"), numberFromInput("0-93")); 
```

# squeryl - Squeryl 部分更新无法编译

> ID：14633604
> 
> 赞同：2
> 
> 时间：2013-01-31T19:27:35.220
> 
> 标签：squeryl

我不确定 squeryl 在这里试图告诉我什么：

错误：**无法证明 org.squeryl.dsl.fsm.Unconditioned =:= org.squeryl.dsl.fsm.Conditioned。**

在：

```
inTransaction {
  update(AppDB.postTable) { p =>
    where(p.id === postId)
    set(p.upVotes := p.upVotes.~ + 1) 
} 
```

错误在 set 子句上

架构：

```
object AppDB extends Schema {
   val postTable = table[Post]("post")
   val replyTable = table[Reply]("reply")

   val postToReplies = oneToManyRelation(postTable, replyTable)
          .via((p,r) => p.id === r.postId)
    }

    case class Post(body: String, image:Option[String]) extends KeyedEntity[Long] {
      val id: Long = 0
      val posted: Date = new Date()
      var upVotes: Long = 0
      var downVotes: Long = 0
    }

    case class Reply(postId: Long, body: String, image:Option[String]) extends KeyedEntity[Long] {
        val id: Long = 0
        val posted: Date = new Date()
    } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T19:42:58.373

尝试在你的and子句周围使用`()`而不是，例如：`{}``where``set`

```
inTransaction {
  update(AppDB.postTable) ( p =>
    where(p.id === postId)
    set(p.upVotes := p.upVotes.~ + 1) 
  )
} 
```

我不知道为什么，但我过去遇到过问题`{}`。当我针对您的代码测试更改时，问题似乎得到了解决。

# php - CodeIgniter 检查查询是否成功

> ID：14633607
> 
> 赞同：1
> 
> 时间：2013-01-31T19:27:43.353
> 
> 标签：php, codeigniter

我在网上搜索了大部分都建议使用`num_rows`或类似的函数来检查在CodeIgniter中查询是否成功，但是我正在使用一个`update`函数

```
$data = array(
  'title' => $title,
  'name' => $name,
  'date' => $date
);

$this->db->where('id', $id);
$this->db->update('mytable', $data); 

// Produces:
// UPDATE mytable 
// SET title = '{$title}', name = '{$name}', date = '{$date}'
// WHERE id = $id 
```

我将如何检查此查询是否成功。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T19:33:54.160

采用[`$this->db->affected_rows()`](http://ellislab.com/codeigniter/user-guide/database/helpers.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-21T07:44:06.993

`affected_rows()`由于其工作方式的本质，使用此方法不会为您提供正确的结果。相反，`update_batch()`返回受影响的行数。

*其他尝试使用：*

```
$result = $this->db->update('mytable', $data);
if ($result) {
    return 1;
} 
```

# c++ - 将游戏手柄摇杆值转换为范围

> ID：14633608
> 
> 赞同：0
> 
> 时间：2013-01-31T19:27:45.307
> 
> 标签：c++, input, directx, xinput, gamepad

我正在尝试使用 XInput 从指尖获取值，但是这些值很奇怪，我不知道如何正确处理它们。

如何计算以便我可以读取 -1（拇指杆向左/向上）+1（拇指杆向右/向下）之间的值

类似于 XNA 的 Gamepad.GetState().ThumbSticks.Left.X（-1 = 左侧，+1 = 右侧）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:34:11.417

根据[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.reference.xinput_gamepad%28v=vs.85%29.aspx)，`_XINPUT_GAMEPAD.sThumbLX`它`SHORT`的值介于 -32768 和 32767 之间。如果要将其转换为 [-1, 1) 的范围，请将值除以 32768.0。

# browser - HTML 自定义属性与移动设备的兼容性？

> ID：14633612
> 
> 赞同：1
> 
> 时间：2013-01-31T19:28:09.993
> 
> 标签：browser, custom-attributes, smartphone, html

有谁知道我是否可以在网页中使用自定义 HTML 属性，大多数移动设备都可以读取它？或者某些设备会默认忽略属性？换句话说：安装在移动设备中的大多数默认网络浏览器都能够处理自定义属性？

我有一些这样的代码：

```
<input type="text" id="txt1" value="0" percent="50" idColor="12"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:30:03.190

您正在谈论的项目是属性。如果网络浏览器不理解某个特定属性，它*应该*忽略它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:28:29.843

现代浏览器通常将未知属性视为分配给元素的属性，没有任何默认影响，但在 CSS 和 JavaScript 中被识别为属性。例如，在您的情况下，CSS 选择器`input[idColor]`将匹配那些`input`具有属性的元素`idColor`，即使 HTML 规范中没有定义这样的属性。

然而，在 JavaScript 中，它们通常不能直接作为属性使用，因此例如`document.getElementById('txt1').percent`会 yield `undefined`，尽管存在浏览器差异。但`document.getElementById('txt1').getAttribute('percent')`会屈服`50`。

我希望这也适用于移动浏览器，尽管我只在 Android 上进行了测试。

然而，在 HTML 中组成自己的属性名称是不安全的。如果未来的某个 HTML 规范，或者只是某个浏览器，为一个名为 的属性赋予了意义，会发生`percent`什么？对于我们现在所能做的一切，其含义可能非常令人惊讶。

因此，在客户端脚本中使用携带任意数据的属性的推荐方法是使用以 .[开头的名称`data-`](http://www.w3.org/TR/html5/dom.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)。这为您提供了自己的命名空间。任何合理的浏览器或搜索引擎都不会将此类属性视为页面作者的私人游乐场，不要搞砸。所以最好使用 eg `data-percent="50" data-color="12"`。

# php - SQL多选同一表和列进行数据过滤

> ID：14633618
> 
> 赞同：2
> 
> 时间：2013-01-31T19:28:34.300
> 
> 标签：php, mysql

我知道我以前做过这个，但是有一段时间没有做太多的 SQL 了。

我有一个名为lead_detail 的表，它有以下列：`id`, `lead_id`, `form_id`, `field_number`, `value`。

我试图得到结果，然后过滤它们。

因此，最初，我得到了对特定问题有特定答案的所有潜在客户 ID。

假设第一个过滤器是我想要对“你喜欢鸡肉”的问题（field_number 为 4）回答“是”的所有结果。

```
$leadIds = query(SELECT lead_id FROM lead_detail WHERE field_number = '4' AND value = 'yes' AND form_id = '1')
$leadIds = implode(', ', $leadIds); 
```

然后，我可以通过

`SELECT * FROM lead_detail WHERE form_id = '1' and lead_id IN ($leadIds)`

这完美地工作。

如果我想添加一个 SECOND 过滤器，我需要对同一查询中的同一列进行两次查询。我在想我需要对表别名或一些子选择进行某种连接，但不记得该怎么做。

因此，如果我需要知道谁对“你喜欢鸡肉”的问题回答“是”以及谁对“你的年龄”回答“18-24”，我将如何获得适当的 $leadIds？

这将是类似的组合

```
SELECT lead_id FROM lead_detail WHERE field_number = '4' AND value = 'yes' AND form_id = '1'
AND
SELECT lead_id FROM lead_detail WHERE field_number = '5' AND value = '18-24' AND form_id = '1' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:38:26.213

内部连接将为此工作：

```
SELECT DISTINCT(ld1.lead_id)
FROM lead_detail ld1
INNER JOIN lead_detail ld2 ON (ld1.lead_id = ld2.lead_id)
WHERE ld1.field_number = '4' AND ld1.value = 'yes' AND ld1.form_id = '1' 
AND ld2.field_number = '5' AND ld2.value = '18-24' AND ld2.form_id = '1' 
```

然而，可能有一个更整洁的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:51:31.833

你不能用

```
SELECT lead_id 
FROM lead_detail 
WHERE ((field_number = '4' AND value = 'yes') OR (field_number = '5' AND value = '18-24')) AND form_id = '1' 
```

# opengl - 如何让东西显示在我的窗口中？

> ID：14633619
> 
> 赞同：0
> 
> 时间：2013-01-31T19:28:42.893
> 
> 标签：opengl, opentk

我一直在玩OpenGL。我很困惑，因为大多数命令似乎调用的是静态方法而不是我创建的窗口对象——编译器通过什么神秘的方法来判断我的目标窗口，我无法理解。

我假设我在此过程中误解了一些东西，因为我无法让我的代码工作。下面的代码片段生成了一个具有透明背景的窗口，而不是黑色背景；尝试其他一些绘图命令也没有给我任何帮助。我究竟做错了什么？

```
public static void Main()
    {
        using (OpenTK.GameWindow a = new OpenTK.GameWindow(800, 600, GraphicsMode.Default, "Sandboxy")) 
        {
            a.Run(30);

            OpenTK.Graphics.OpenGL.GL.ClearColor(0, 0, 0, 0);
            OpenTK.Graphics.OpenGL.GL.ClearDepth(1.0);
            OpenTK.Graphics.OpenGL.GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:40:57.730

是的，你肯定做错了什么，但首先是静态方法。

即使您使用静态方法，它知道将内容绘制到何处的方式是因为 OpenTK`OpenTK.Graphics.OpenGL.GL`在创建`GameWindow`OpenGL (这通过 Win32 函数`wglCreateContext(HDC)`和`wglMakeCurrent(HDC, HGLRC)`，如果您想了解更多信息，请查看这些函数）。

它不起作用的原因是因为您在启动渲染循环后尝试清除所有内容：

```
a.Run(30); 
```

不只是打开窗口，它还进入渲染循环，这意味着它只会在窗口关闭时返回。这显然不是你想要的。你想**在**循环中渲染，而不是之后。

绘制它的首选方法（对于 OpenTK）是创建一个派生自 的类`GameWindow`，并覆盖与循环有关的函数：

```
class MyGameWindow : GameWindow
{
    public MyGameWindow() : base(800, 600, GraphicsMode.Default, "Sandboxy")
    {
    }

    protected override void OnRenderFrame(FrameEventArgs e)
    {
        GL.ClearColor(0, 0, 0, 0);
        GL.ClearDepth(1.0);
        GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);

        this.SwapBuffers();
    }

    public static void Main(string[] args)
    {
        using (GameWindow a = new MyGameWindow())
        {
            a.Run(30);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:36:25.437

OpenGL 命令对*当前的* [GL 上下文](http://www.opengl.org/wiki/OpenGL_Context)进行操作。您从操作系统获取 GL 上下文，并通过特定于操作系统的 ( , 等) 调用使它们在给定线程中成为`wgl`当前`glx`的`*MakeCurrent()`。

# iphone - 将对象从一个 NSMutableArray 放到另一个 NSMutableArray

> ID：14633622
> 
> 赞同：0
> 
> 时间：2013-01-31T19:28:55.773
> 
> 标签：iphone, objective-c, nsmutablearray

我有 2 个 NSMutableArrays，我想将某些对象从 1 数组放入另一个数组，我已经编写了代码，但它不起作用，它给了我这个错误： *** 由于未捕获的异常 'NSRangeException' 而终止应用程序，原因：'*** - [__NSArrayM objectAtIndex:]: index 296 beyond bounds [0 .. 295]' *** First throw call stack: (0x1c9a012 0x10d7e7e 0x1c3c0b4 0x2f04 0xb20b90 0x1c59376 0x1c58e06 0x1c40a82 0x1c3ff44 0x1c3fe1b 0x1bf47e3 0x1bf4668 0x1f65c 0x252d 0x2455) libc++abi.dylib: terminate called throwing一个例外

在 viewdidload 中初始化：

```
arrayLine1 =[[NSMutableArray alloc] initWithCapacity:80000];
    arrayLine1a =[[NSMutableArray alloc] initWithCapacity:70000];
    line1tagzahl=0;
    line1tagzahl2=0; 
```

传递代码：

```
for (int a=0; a<10; ) {

            [arrayLine1a insertObject:[arrayLine1 objectAtIndex:line1tagzahl2] atIndex:line1tagzahl2];

            line1tagzahl2=line1tagzahl2+1;
            a=a+1;
        } 
```

在数组中创建对象的函数（此函数调用非常快速且频繁）：

```
for (float a=0; a<0.8; ) {
            UIImageView *line1 =[[UIImageView alloc] initWithFrame:CGRectMake(Startpoint1.center.x-(w/2),Startpoint1.center.y-kurve1yf+a,w,h)];
            line1.image=[UIImage imageNamed:@"Unbenannt"];
            line1.tag=line1tagzahl;
            [self.view addSubview:line1];
            [arrayLine1 insertObject:line1 atIndex:line1tagzahl];
            line1tagzahl=line1tagzahl+1;
            a=a+0.1;
        } 
```

现在你应该有更多的信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:33:20.463

`-addObjectsFromArray:`使用NSMutableArray 类的默认方法有什么问题吗？

```
- (void)serverGotResponse:(NSArray *)objects {
  [_myMutableArray addObjectsFromArray:objects];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:31:08.243

> 如果你问我在 array2 中有超过 10 个对象

似乎您还没有阅读您发布的错误消息。数组中有 296 个对象。但是，如果您只想复制数组，为什么不……呃……复制它？

```
NSMutableArray *secondArray = [firstArray mutableCopy]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T19:44:25.747

为了防止越界异常，您应该使用`count`属性：

```
while (i < array.count) {
   // do something ..
   i++;
} 
```

如果要复制所有对象，则只需复制整个数组：
array2 =`[array1 copy]`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-31T19:34:22.487

您正在尝试添加前 10 个对象，但在索引 296 上引发了异常，这是第一个超出范围的索引。

由于某种原因，您的`while`状况无法正常工作，所以我建议您开始寻找那里

我还建议您使用 a `for`，它实际上比潜在的无限循环更简单明了

```
for (int a = 0; a < 10; a++) {
    [array1 insertObject:[array2 objectAtIndex:a] atIndex:a];
} 
```

# cassandra - Cassandra 批量插入操作，内部

> ID：14633624
> 
> 赞同：3
> 
> 时间：2013-01-31T19:29:03.987
> 
> 标签：cassandra, cql

我正在寻找 Cassandra/CQL 的常见 SQL 习语的表亲，但`INSERT INTO ... SELECT ... FROM ...`一直无法找到任何东西来以编程方式或在 CQL 中执行此类操作。只是不支持吗？

我的用例是从一个表到另一个表进行相当大的复制。我不需要任何特定的并发保证，但它有很多数据，所以我想避免编写客户端从一个表中检索数据，然后将批量插入到另一个表中的额外网络开销。我知道根据复制设置，仍需要在 Cassandra 集群的节点之间传输更改，但似乎有一个“内部”选项可以从一个表到另一个表进行批量操作是合理的。在 CQL 或其他地方有这样的事情吗？我目前正在使用 Hector 与 Cassandra 交谈。

编辑：它看起来`sstableloader`可能是相关的，但对于我希望是一个相当常见的用例的东西来说，它是非常低级的。在该框架中，仅将行的子集从一个表转移到另一个似乎也不是微不足道的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T00:02:11.353

正确，本机不支持此功能。（另一种选择是 map/reduce 作业。） Cassandra 的 API 专注于大规模应用程序的短请求，而不是批处理或分析查询。

# javascript - 在javascript中从数组构建对象

> ID：14633630
> 
> 赞同：0
> 
> 时间：2013-01-31T19:29:10.550
> 
> 标签：javascript

我有一个像这样的数组：`['foo','bar']`我想把它变成一个看起来像这样的对象：

```
{
     富：{
          酒吧：{
               ETC：{}
          }
     }
}

```

我尝试了两个循环，但如果数组中有三个值，我可以让它工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:30:53.323

```
var obj = {};
var pointer = obj;

array.forEach(function (item) {
    pointer = pointer[item] = {};
}); 
```

这是小提琴：http: [//jsfiddle.net/h67ts/](http://jsfiddle.net/h67ts/)

* * *

如果你必须支持 IE < 9，你可以使用常规循环，或者使用[这个 polyfill](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach#Compatibility)：

```
if ( !Array.prototype.forEach ) {
  Array.prototype.forEach = function(fn, scope) {
    for(var i = 0, len = this.length; i < len; ++i) {
      fn.call(scope, this[i], i, this);
    }
  }
} 
```

# java - 快速点击时将先前的活动置于前台

> ID：14633632
> 
> 赞同：1
> 
> 时间：2013-01-31T19:29:17.753
> 
> 标签：java, android, android-intent, android-activity

我有一种情况，活动 A 已启动活动 B，然后 B 启动活动 C 并自行完成，如下所示：

```
Intent intent = new Intent(getBaseContext(), Main.class);
intent.putExtra("GAME_TYPE", Game.MULTIPLAYER);
intent.putExtra("GAME_DATA", data.toString());
intent.putExtra("GAME_ID", gameId);
startActivity(intent);
finish(); 
```

这通常工作正常，C 被带到前面。当用户关闭 C 时，会显示 A。

如果用户在 B 完成并且 C 正在启动时重复点击屏幕，就会出现问题。这似乎导致 A 来到前台，C 在后台成功启动（LogCat 输出表明 C 正在运行）。

我的猜测是，在 C 有机会启动之前，B 完成并显示了 A，通过点击使 A 成为焦点。这可能是问题的原因吗？如果不是，那是什么？我怎样才能防止这种情况发生并确保即使用户疯狂地敲击也将 C 带到前面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:36:31.270

我不确定您的代码和 xml 的结构究竟如何，但一个简单的解决方法是使活动 A 正在运行的布局在调用 onStop 后不可点击。

我建议的另一件事是检查活动 B 如何完成和 C 如何开始。您是否在 C 开始之前在 B 上调用完成？C 是否需要加载大量导致延迟的数据？如果是这样，请考虑等待部分或全部大量数据加载，然后启动 C。

没有任何源代码就不能说别的了。

# reporting-services - SSRS 2005 有趣的分页问题

> ID：14633633
> 
> 赞同：0
> 
> 时间：2013-01-31T19:29:18.493
> 
> 标签：reporting-services, report

我有一个 SSRS 报告，其中包含一些数据驱动的部分。

在其中一个部分中，代码生成了一个包含六个选项的表。前五个一起出现在一个页面上，然后有一个分页符，我认为第六个选项会出现在页面的顶部，然后是报告的其余部分。

相反，我得到一个空白页，页面底部的第六个选项，报告的其余部分，最后是一个空白页。

我检查了报告的宽度和长度，设置似乎没问题。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:48:02.443

您需要检查页面宽度+边距是否等于或小于打印页面宽度，A4或A3等。

如果不是，这将导致显示的页面超过打印的页面宽度，从而创建一个空白页面，然后是 tablix 的最后一行。

# python - 添加代码前查看pyqt4导出

> ID：14633642
> 
> 赞同：0
> 
> 时间：2013-01-31T19:29:52.243
> 
> 标签：python, user-interface, pyqt4, python-3.3

我是 python 3.3 的新手，在处理随机简单任务时遇到了一些麻烦。我在 qt 设计器中制作了一个 gui 并导出了 py 代码。我添加了

```
def show(self):
    self.QtGui.show()
    sys.exit(self.exec_()) 
```

和

```
MainWindow = Ui_MainWindow(sys.argv)
MainWindow.show() 
```

最后在我添加所有代码之前尝试查看 GUI。我确定这是可能的，我只是想不通。我的整个代码是：

```
from PyQt4 import QtCore, QtGui
import sys

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    def _fromUtf8(s):
        return s

try:
    _encoding = QtGui.QApplication.UnicodeUTF8
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig, _encoding)
except AttributeError:
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig)

class Ui_MainWindow(object):

    def setupUi(self, MainWindow):
        MainWindow.setObjectName(_fromUtf8("MainWindow"))
        MainWindow.resize(390, 355)
        self.centralwidget = QtGui.QWidget(MainWindow)
        self.centralwidget.setObjectName(_fromUtf8("centralwidget"))
        self.tabWidget = QtGui.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(10, 10, 371, 301))
        self.tabWidget.setObjectName(_fromUtf8("tabWidget"))
        self.TS2 = QtGui.QWidget()
        self.TS2.setObjectName(_fromUtf8("TS2"))
        self.lineEdit = QtGui.QLineEdit(self.TS2)
        self.lineEdit.setGeometry(QtCore.QRect(120, 30, 91, 20))
        self.lineEdit.setText(_fromUtf8(""))
        self.lineEdit.setObjectName(_fromUtf8("lineEdit"))
        self.spinBox = QtGui.QSpinBox(self.TS2)
        self.spinBox.setGeometry(QtCore.QRect(120, 70, 42, 22))
        self.spinBox.setObjectName(_fromUtf8("spinBox"))
        self.pushButton = QtGui.QPushButton(self.TS2)
        self.pushButton.setGeometry(QtCore.QRect(140, 230, 91, 23))
        self.pushButton.setObjectName(_fromUtf8("pushButton"))
        self.label = QtGui.QLabel(self.TS2)
        self.label.setGeometry(QtCore.QRect(20, 30, 91, 16))
        self.label.setObjectName(_fromUtf8("label"))
        self.label_2 = QtGui.QLabel(self.TS2)
        self.label_2.setGeometry(QtCore.QRect(20, 70, 91, 20))
        self.label_2.setObjectName(_fromUtf8("label_2"))
        self.label_11 = QtGui.QLabel(self.TS2)
        self.label_11.setGeometry(QtCore.QRect(20, 170, 91, 21))
        self.label_11.setObjectName(_fromUtf8("label_11"))
        self.lineEdit_6 = QtGui.QLineEdit(self.TS2)
        self.lineEdit_6.setGeometry(QtCore.QRect(120, 170, 131, 20))
        self.lineEdit_6.setObjectName(_fromUtf8("lineEdit_6"))
        self.pushButton_6 = QtGui.QPushButton(self.TS2)
        self.pushButton_6.setGeometry(QtCore.QRect(260, 170, 75, 23))
        self.pushButton_6.setObjectName(_fromUtf8("pushButton_6"))
        self.line_2 = QtGui.QFrame(self.TS2)
        self.line_2.setGeometry(QtCore.QRect(0, 200, 371, 20))
        self.line_2.setFrameShape(QtGui.QFrame.HLine)
        self.line_2.setFrameShadow(QtGui.QFrame.Sunken)
        self.line_2.setObjectName(_fromUtf8("line_2"))
        self.tabWidget.addTab(self.TS2, _fromUtf8(""))
        self.AGS = QtGui.QWidget()
        self.AGS.setObjectName(_fromUtf8("AGS"))
        self.lineEdit_2 = QtGui.QLineEdit(self.AGS)
        self.lineEdit_2.setGeometry(QtCore.QRect(120, 30, 91, 20))
        self.lineEdit_2.setText(_fromUtf8(""))
        self.lineEdit_2.setObjectName(_fromUtf8("lineEdit_2"))
        self.label_3 = QtGui.QLabel(self.AGS)
        self.label_3.setGeometry(QtCore.QRect(20, 30, 91, 16))
        self.label_3.setObjectName(_fromUtf8("label_3"))
        self.spinBox_2 = QtGui.QSpinBox(self.AGS)
        self.spinBox_2.setGeometry(QtCore.QRect(120, 70, 42, 22))
        self.spinBox_2.setObjectName(_fromUtf8("spinBox_2"))
        self.label_4 = QtGui.QLabel(self.AGS)
        self.label_4.setGeometry(QtCore.QRect(20, 70, 91, 20))
        self.label_4.setObjectName(_fromUtf8("label_4"))
        self.pushButton_2 = QtGui.QPushButton(self.AGS)
        self.pushButton_2.setGeometry(QtCore.QRect(140, 230, 91, 23))
        self.pushButton_2.setObjectName(_fromUtf8("pushButton_2"))
        self.label_8 = QtGui.QLabel(self.AGS)
        self.label_8.setGeometry(QtCore.QRect(20, 110, 91, 21))
        self.label_8.setObjectName(_fromUtf8("label_8"))
        self.label_10 = QtGui.QLabel(self.AGS)
        self.label_10.setGeometry(QtCore.QRect(20, 170, 91, 21))
        self.label_10.setObjectName(_fromUtf8("label_10"))
        self.lineEdit_5 = QtGui.QLineEdit(self.AGS)
        self.lineEdit_5.setGeometry(QtCore.QRect(120, 170, 131, 20))
        self.lineEdit_5.setObjectName(_fromUtf8("lineEdit_5"))
        self.pushButton_5 = QtGui.QPushButton(self.AGS)
        self.pushButton_5.setGeometry(QtCore.QRect(260, 170, 75, 23))
        self.pushButton_5.setObjectName(_fromUtf8("pushButton_5"))
        self.lineEdit_7 = QtGui.QLineEdit(self.AGS)
        self.lineEdit_7.setGeometry(QtCore.QRect(120, 110, 31, 20))
        self.lineEdit_7.setObjectName(_fromUtf8("lineEdit_7"))
        self.label_12 = QtGui.QLabel(self.AGS)
        self.label_12.setGeometry(QtCore.QRect(160, 110, 61, 21))
        self.label_12.setObjectName(_fromUtf8("label_12"))
        self.line = QtGui.QFrame(self.AGS)
        self.line.setGeometry(QtCore.QRect(0, 200, 371, 20))
        self.line.setFrameShape(QtGui.QFrame.HLine)
        self.line.setFrameShadow(QtGui.QFrame.Sunken)
        self.line.setObjectName(_fromUtf8("line"))
        self.tabWidget.addTab(self.AGS, _fromUtf8(""))
        self.AQT = QtGui.QWidget()
        self.AQT.setObjectName(_fromUtf8("AQT"))
        self.label_5 = QtGui.QLabel(self.AQT)
        self.label_5.setGeometry(QtCore.QRect(20, 30, 91, 16))
        self.label_5.setObjectName(_fromUtf8("label_5"))
        self.lineEdit_3 = QtGui.QLineEdit(self.AQT)
        self.lineEdit_3.setGeometry(QtCore.QRect(120, 30, 91, 20))
        self.lineEdit_3.setText(_fromUtf8(""))
        self.lineEdit_3.setObjectName(_fromUtf8("lineEdit_3"))
        self.spinBox_3 = QtGui.QSpinBox(self.AQT)
        self.spinBox_3.setGeometry(QtCore.QRect(120, 70, 42, 22))
        self.spinBox_3.setObjectName(_fromUtf8("spinBox_3"))
        self.label_6 = QtGui.QLabel(self.AQT)
        self.label_6.setGeometry(QtCore.QRect(20, 70, 91, 20))
        self.label_6.setObjectName(_fromUtf8("label_6"))
        self.pushButton_3 = QtGui.QPushButton(self.AQT)
        self.pushButton_3.setGeometry(QtCore.QRect(140, 230, 91, 23))
        self.pushButton_3.setObjectName(_fromUtf8("pushButton_3"))
        self.dateEdit = QtGui.QDateEdit(self.AQT)
        self.dateEdit.setGeometry(QtCore.QRect(120, 110, 110, 22))
        self.dateEdit.setObjectName(_fromUtf8("dateEdit"))
        self.label_7 = QtGui.QLabel(self.AQT)
        self.label_7.setGeometry(QtCore.QRect(20, 110, 91, 21))
        self.label_7.setObjectName(_fromUtf8("label_7"))
        self.pushButton_4 = QtGui.QPushButton(self.AQT)
        self.pushButton_4.setGeometry(QtCore.QRect(260, 170, 75, 23))
        self.pushButton_4.setFlat(False)
        self.pushButton_4.setObjectName(_fromUtf8("pushButton_4"))
        self.lineEdit_4 = QtGui.QLineEdit(self.AQT)
        self.lineEdit_4.setGeometry(QtCore.QRect(120, 170, 131, 20))
        self.lineEdit_4.setObjectName(_fromUtf8("lineEdit_4"))
        self.label_9 = QtGui.QLabel(self.AQT)
        self.label_9.setGeometry(QtCore.QRect(20, 170, 91, 21))
        self.label_9.setObjectName(_fromUtf8("label_9"))
        self.line_3 = QtGui.QFrame(self.AQT)
        self.line_3.setGeometry(QtCore.QRect(0, 200, 371, 20))
        self.line_3.setFrameShape(QtGui.QFrame.HLine)
        self.line_3.setFrameShadow(QtGui.QFrame.Sunken)
        self.line_3.setObjectName(_fromUtf8("line_3"))
        self.tabWidget.addTab(self.AQT, _fromUtf8(""))
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtGui.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 390, 21))
        self.menubar.setObjectName(_fromUtf8("menubar"))
        self.menuFile = QtGui.QMenu(self.menubar)
        self.menuFile.setObjectName(_fromUtf8("menuFile"))
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtGui.QStatusBar(MainWindow)
        self.statusbar.setObjectName(_fromUtf8("statusbar"))
        MainWindow.setStatusBar(self.statusbar)
        self.actionExit = QtGui.QAction(MainWindow)
        self.actionExit.setObjectName(_fromUtf8("actionExit"))
        self.menuFile.addAction(self.actionExit)
        self.menubar.addAction(self.menuFile.menuAction())

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(2)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

def retranslateUi(self, MainWindow):
    MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow", None))
    self.pushButton.setText(_translate("MainWindow", "Execute", None))
    self.label.setText(_translate("MainWindow", "XXXXXXXXX:", None))
    self.label_2.setText(_translate("MainWindow", "xXXXXXXXXXXX:", None))
    self.label_11.setText(_translate("MainWindow", "XXXXXXXXXX:", None))
    self.pushButton_6.setText(_translate("MainWindow", "Browse", None))
    self.tabWidget.setTabText(self.tabWidget.indexOf(self.TS2), _translate("MainWindow", "XXXXXX", None))
    self.label_3.setText(_translate("MainWindow", "XXXXXXXX:", None))
    self.label_4.setText(_translate("MainWindow", "XXXXXXXXXXX:", None))
    self.pushButton_2.setText(_translate("MainWindow", "Execute", None))
    self.label_8.setText(_translate("MainWindow", "xXXXXXXXX:", None))
    self.label_10.setText(_translate("MainWindow", "XXXXXXXX:", None))
    self.pushButton_5.setText(_translate("MainWindow", "Browse", None))
    self.label_12.setText(_translate("MainWindow", "XXXXXX", None))
    self.tabWidget.setTabText(self.tabWidget.indexOf(self.AGS), _translate("MainWindow", "XXXXXX", None))
    self.label_5.setText(_translate("MainWindow", "XXXX:", None))
    self.label_6.setText(_translate("MainWindow", "XXXXX:", None))
    self.pushButton_3.setText(_translate("MainWindow", "Execute", None))
    self.dateEdit.setDisplayFormat(_translate("MainWindow", "yyyy-MM-dd", None))
    self.label_7.setText(_translate("MainWindow", "XXXXX:", None))
    self.pushButton_4.setText(_translate("MainWindow", "Browse", None))
    self.label_9.setText(_translate("MainWindow", "xXXXXXX:", None))
    self.tabWidget.setTabText(self.tabWidget.indexOf(self.AQT),         _translate("MainWindow", "XXXXX", None))
    self.menuFile.setTitle(_translate("MainWindow", "File", None))
    self.actionExit.setText(_translate("MainWindow", "Exit", None))

    def show(self):
        self.QtGui.show()
        sys.exit(self.exec_())

MainWindow = Ui_MainWindow(sys.argv)
MainWindow.show() 
```

我得到的错误是：

```
TypeError: object.__new__() takes no parameters 
```

现在我什至不确定这个错误是否与我的问题有关，但我已经走到尽头，试图简单地看到这个 UI。还不需要功能。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T05:11:56.483

您无需手动执行此操作。`pyuic4`可以选择添加：[`-x`](http://pyqt.sourceforge.net/Docs/PyQt4/designer.html#pyuic4). 然后你可以运行`pyuic4`生成的代码，你会看到小部件。例如：

```
pyuic4 -x -o output.py input.ui 
```

# sql-server-2008 - 触发器从所有行而不是一行返回结果

> ID：14633648
> 
> 赞同：0
> 
> 时间：2013-01-31T19:30:22.197
> 
> 标签：sql-server-2008

我正在尝试在`employeepayhistory`桌子上创建一个触发器。每当我更新`RATE`表中的列时，它对月薪的影响应该显示出来，但是如果我更新一条记录，它会给我整条记录的月薪。请帮忙。

```
CREATE TRIGGER MONTHTRG
ON HumanResources.EmployeePayHistory
FOR UPDATE
AS
BEGIN
   DECLARE @Rate MONEY
   SELECT @Rate=Rate FROM INSERTED
   SELECT 'MONTHSAL'=Rate*PayFrequency*30 FROM HumanResources.EmployeePayHistory
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:37:03.710

你还需要给出 where 条件，通常你会

```
DECLARE @Id bigint
SET @Id = (SELECT Id from Inserted)
SELECT 'MONTHSAL' = Rate * PayFrequency*30 From HumanResources.EmployeePayHistory where Humanresources.EmployeeID=@Id 
```

如果主键被称为“Id”并且当然是唯一的，这将起作用。您也可以使用唯一键（应该是非 NULL）来执行此操作

# asp.net-mvc - 从 htmlhelper 中访问视图

> ID：14633650
> 
> 赞同：0
> 
> 时间：2013-01-31T19:30:29.190
> 
> 标签：asp.net-mvc, html-helper

我正在使用 mvc 4 并创建了一个自定义 HtmlHelper。

是否可以从该助手内部访问正在调用该助手的视图？我想在我的辅助方法中使用基础视图上的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:36:04.657

是的你可以 ：）

```
public static void MyExtension(this HtmlHelper html)
{
    var view = html.ViewDataContainer;

    // accessing view properties
    var viewModel = view.Model;
    var viewAjax = view.Ajax;
    // etc
} 
```

# mysql - MySQL修改前序树遍历——基于节点获取子树

> ID：14633653
> 
> 赞同：0
> 
> 时间：2013-01-31T19:30:30.530
> 
> 标签：mysql, sql, tree, binary-tree, tree-traversal

[根据 sitepont上的图片，](http://www.sitepoint.com/hierarchical-data-database-2/)我有一个标准的 mptt 树表。不过，我一辈子都找不到基于所选节点获取整个子树的好方法。

示例（来自该链接页面）：假设树是一个菜单，如果有人选择“Cherry” - 我想从“Fruit”节点向下获取所有项目。

所以，我可以使用得到最终的父行（不包括我不想要的根）

```
SELECT lft, rgt FROM menu_items
WHERE lft < (SELECT lft FROM menu_items WHERE id = 'Cherry') 
AND rgt > (SELECT rgt FROM menu_items WHERE id = 'Cherry') 
AND lft > 1
ORDER BY lft ASC LIMIT 1 
```

我认为这 3 个 SELECT 是非常糟糕的 SQL - 但它确实让我 lft & rgt 我可以在进一步的查询中使用它来获取 lft 和 rgt 之间的所有节点 - 从而获得“Cherry”所在的子树。

我用它作为在一个查询中完成所有操作的基础 - 这导致了这种可憎：

```
SELECT * FROM menu_items 
WHERE lft BETWEEN 
    (SELECT lft FROM  menu_items
    WHERE lft < (SELECT lft FROM menu_items WHERE id = 'Cherry') 
    AND rgt > (SELECT rgt FROM menu_items WHERE id = 'Cherry') 
    AND lft > 1
    ORDER BY lft ASC LIMIT 1)
AND 
    (SELECT rgt FROM  menu_items
    WHERE lft < (SELECT lft FROM menu_items WHERE id = 'Cherry') 
    AND rgt > (SELECT rgt FROM menu_items WHERE id = 'Cherry') 
    AND lft > 1
    ORDER BY lft ASC LIMIT 1)
ORDER BY lft ASC; 
```

这对我来说似乎很讨厌 - 七个 SELECTs ！

这可以优雅地完成（最好在一个查询中，但没那么重要 - 可读性>单个查询）？

顺便说一句 - lft 和 rgt 是我的 MPTT 编号字段名称

编辑 ::: 实验后我意识到我笨拙的 SQL 并没有做我想要的。它仅适用于比根深 > 2 层的节点。

我的问题是：参考帖子顶部链接的图表 - 如果用户“选择”任何叶子或子树的父节点，我需要获取整个子树，不包括根。

因此，如果用户选择“樱桃”、“香蕉”、“红色”、“黄色”或“水果”，我需要整个“水果”子树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T04:18:04.360

试试下面的查询：

```
SELECT menu_items.* FROM menu_items ,
(SELECT lft as lft_inner,rgt as rgt_inner FROM menu_items WHERE id = 'Cherry')  
as menu_innner 
WHERE lft < lft_inner  
AND rgt > rgt_inner
AND lft > 1
ORDER BY lft ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T12:16:18.237

```
------------------------------------------------------------------
SELECT yourtable.* FROM yourtable ,
(SELECT lft as lft_inner,rgt as rgt_inner FROM yourtable WHERE id=178)  
as menu_innner 
WHERE lft > lft_inner  
AND rgt < rgt_inner
AND lft > 1
ORDER BY lft ASC
----------------------------------------------------------------------- 
```

# sql - 用于显示过去 24 小时内未处理的 SSAS 数据库的 Powershell 脚本

> ID：14633657
> 
> 赞同：1
> 
> 时间：2013-01-31T19:30:45.770
> 
> 标签：sql, powershell, ssas

我一直在尝试创建一个脚本来创建过去 24 小时内未处理的 SSAS 多维数据集列表，但我运气不佳。我有一个查询，它将为我提供特定多维数据集的处理时间，但它仅适用于选择查询的特定数据库。我需要它来列出 SSAS 服务器上所有数据库的这些信息。

我正在使用的查询是：

```
WITH MEMBER [Measures].[LastProcessed] AS ASSP.GetCubeLastProcessedDate()
SELECT      [Measures].[LastProcessed] ON 0 FROM $Database" 
```

任何想法将不胜感激。如果仅使用 T-SQL 或 MDX 而不是 Powershell 可以做到这一点，那也可以，但我无法在 SQL 中找到命令来提取所有多维数据集名称。

此外，如果有帮助，它正在 Microsoft SQL Server 2012 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:54:31.137

试试这个你的脚本：

```
USE $Database;
GO

WITH MEMBER [Measures].[LastProcessed] AS ASSP.GetCubeLastProcessedDate()
SELECT      [Measures].[LastProcessed] ON 0 FROM $Database" 
```

如果您使用 -Database 选项运行[Invoke-SqlCmd](http://technet.microsoft.com/en-us/library/cc281720.aspx) cmdlet，则查询将连接到指定的数据库。该`USE $Database`语句应在执行前强制连接切换到适当的数据库上下文。

# android - 如果我没有在 Android 中实现覆盖方法会发生什么？

> ID：14633661
> 
> 赞同：0
> 
> 时间：2013-01-31T19:31:03.617
> 
> 标签：android, android-lifecycle, android-memory

我正在开发一个 Android 应用程序，并且**我已经阅读了有关活动生命周期的信息**。我不知道，如果我不实现生命周期**onCreate()、onDestroy()**等方法会发生什么。JVM 会自动调用这些方法吗？我习惯于使用 iOS，而对 Java 的更改对我来说有些特殊。我想调用方法来管理内存。我认为这些方法有助于管理我的应用程序中的内存，并且不会在运行时崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:32:26.410

Android 框架总是调用这些方法。如果您不实现它们，则将运行基类方法。通常他们什么都不做（重要的）。但是，您肯定需要重写某些方法（至少`onCreate`）以使您的活动有用。

就内存管理而言，您通常根本不应该担心这一点。Java 具有运行良好的自动垃圾收集功能。与 Objective C 不同，在 Java 中实际上没有手动内存管理的机制；它总是由 JVM 完成。就内存管理而言，您唯一需要注意的是确保您不会维护对不再需要的大型数据结构的硬引用。请参阅 Android 博客中的文章[避免内存泄漏](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:32:07.550

如果一个方法没有被覆盖，它的基类实现将被使用。

# android - 无法通过将字符串转换为类来触发意图

> ID：14633662
> 
> 赞同：0
> 
> 时间：2013-01-31T19:31:05.677
> 
> 标签：android, class, android-intent

我创建了一个 Listview 表单，我想为特定类触发意图。这里**var:position**是我单击的 ListView 行的位置。无论同一个包中的所有活动和正确名称如何，我都会收到 ClassNotFoundException。

```
String[] slideMenuOptions = {"CarGallery.class","connectus.class","BookService.class"};
String str = slideMenuOptions[position];
Class <?> c = Class.forName(str);
Intent intent = new Intent(context,c);
context.startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:48:48.117

使用不带 .class 的类的全名来获取类名并启动下一个活动：

```
String[] slideMenuOptions = {"xx.xxx.CarGallery",
                             "xx.xxx.connectus",
                             "xx.xxx.BookService"};
String str = slideMenuOptions[position];
Class <?> c = Class.forName(str);
Intent intent = new Intent(context,c);
context.startActivity(intent); 
```

广告确保您已在`androidmanifest.xml`文件中声明所有活动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:31:51.637

```
您需要提供完整的合格班级名称。
例如，如果您的 CarGallery.class 具有包
，那么您应该提供 CarGaller 类以及包名称。
com.tech.CarGaller。
我使用了以下代码。它对我来说很好。如果您有任何问题，请告诉我。
```

```

/*String[] slideMenuOptions = {"com.tech.CarGallery","com.tech.connectus","com.tech.BookService"};*/ 
String[] slideMenuOptions = {"xx.xxx.CarGallery"," xx.xxx.connectus","xx.xxx.BookService"}; 
字符串 str = slideMenuOptions[1]; 
类 c = Class.forName(str); 
System.out.println("获取类名"+c.getName()); 
意图意图=新意图（上下文，c）；
context.startActivity(intent);

```

# php - 使用 system() 执行 whois unix 命令

> ID：14633670
> 
> 赞同：0
> 
> 时间：2013-01-31T19:31:44.243
> 
> 标签：php, unix, system, whois

有没有办法/是否可以使用 php 执行 unix whois 查询，可能使用 system()。？

我在尝试

```
echo '<pre>';
$last_line = system('whois ryansmurphy.com', $retval);
echo '
</pre>
<hr />Last line of the output: ' . $last_line . '
<hr />Return value: ' . $retval; 
```

但它不起作用。我究竟做错了什么？

我什么也没看到，没有错误，没有输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:55:51.903

利用

```
exec($command, $output, $exit_code); 
```

在哪里：

$command - 你的命令（“whois ...”）

$output - 命令输出。

$exit_code - 命令退出代码

[执行命令 PHP](http://php.net/manual/en/function.exec.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:57:11.290

如果该命令没有返回任何内容，那么它很可能会将错误返回到标准错误，而该错误没有被捕获。尝试添加`2>&1`以将错误发送到标准输出。

`$last_line = system('whois ryansmurphy.com 2>&1', $retval);`

[这在system()](http://www.php.net/manual/en/function.system.php#21427)和[exec()](http://php.net/manual/en/function.exec.php#100269)的 PHP 手册中有介绍

# javascript - 如何在本地浏览器上存储用户会话？

> ID：14633678
> 
> 赞同：2
> 
> 时间：2013-01-31T19:32:27.640
> 
> 标签：javascript, web

我有一个需要用户身份验证的网络应用程序，我想将用户信息存储在用户机器上，这样用户就不需要重新登录。

我想过使用 Cookie，但我不确定这有多安全，因为可以简单地使用 JS 控制台自己加载和写入 cookie。

这样做的常见/流行方式是什么？我在后面使用 JS 和 servlet。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:36:14.063

任何涉及在用户计算机上保存实际用户名/密码的事情都是“安全的”；如果您认真关心安全，您就不会这样做。

再说一次，如果您正在制作体育比分网站或其他安全性不是最重要的网站，cookie 可能只是“足够安全”。它只是归结为（如您所述）：“如果恶意用户访问您用户的 cookie，会发生什么？” 如果“发生的事情”不是太糟糕，那将是非常罕见的（它要求攻击者具有物理访问权限），那么我认为 cookie 是“足够安全的”。

但最终，这类事情更流行的方法是设置一个相当长的会话超时。会话 ID 将存储在 cookie 中，但不存储敏感密码信息。

# java - 分配 - 创建一个泛型类并实现 Comparable(Java)

> ID：14633679
> 
> 赞同：1
> 
> 时间：2013-01-31T19:32:31.230
> 
> 标签：java, generics, comparable

我必须使用 Java 泛型制作一个 prog，并实现 Comparable。代码应该基本上比较 3 个人的年龄，并告诉你真假。

我们必须在我们的类中包含“int age”变量。

这就是我所做的：

```
@SuppressWarnings("rawtypes")
public class Person implements Comparable<Person>{ 

    int age; 

    //He said you should have ("int age"), but I dont know how to do this without using generics?

    public Person(int age) 
    {
        this.age = age; 
    }

    public int compareTo(Person o) {
            return compareTo(o); 

    }

} 
```

还有我的比较课：

```
public class OrderedTrio<T> {

    @SuppressWarnings("unused")
    public static void main(String[] args) 
    {
        //Create Person object
        Person personA = new Person(10); 
        Person personB = new Person(20);
        Person personC = new Person(30); 

        System.out.println(allEqual(personA, personB, personC)); 

        //Create Employee object 
    }

    //All Equal Method: Returns true if all 3 items are equal according to their equals method
    public static boolean allEqual(Person personA, Person personB, Person personC)
    {
        if(personA.compareTo(personB) ==0 && personB.compareTo(personC)==0)     //If A=B, B=C then A=C
            return true; 
        else
            return false; 
    }
    //Sort Method: Orders items

    //ToString Method: Output format: Item1, 2, 3

} 
```

当我运行这些我得到这个错误：线程“主”java.lang.StackOverflowError中的异常

我认为错误是**返回 compareTo(o)**，但我不明白如何将我的 CURRENT 对象与传入的对象进行比较。

我也不知道如何使用“int age”变量，它不会让我将 int 与 Person 对象进行比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:39:30.053

是的，这将导致堆栈溢出。你的 compareTo 函数有无限递归，一遍又一遍地调用自己。

compareTo 函数应该返回一个 int 值，它代表你想要给这个对象的“值”，与传入的对象相比。所以你说你想根据年龄比较一个人， compareTo 应该简单地根据年龄变量返回一个 int ，如下所示

```
compareTo(Person o){
    //i'm younger
    if (this.age < o.age)
         return -1;
    //i'm older
    if (this.age > o.age)
         return 1;
 //same age   
 return 0;
} 
```

现在，当您通过 PersonA.compareTo(PersonB) 比较两个人时，它应该返回一个值，表明 PersonA 小于 (-1) 等于 (0) 或大于 (1) PersonB

此解决方案旨在显示您尝试做什么的一般概念，更有效的解决方案是从彼此中减去值并返回，例如

```
return age - o.age; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:35:21.277

您使您的方法`compareTo`递归，但没有任何可能停止此递归。在您的`compareTo`方法中，您必须添加一些将返回的条件`int`，例如：

```
public int compareTo(Person o) {
    return (age - o.age);
} 
```

这样，您将`Person`根据它们的`age`字段比较两个实例。您不能像整个实例那样与类的实例进行比较 - 这不是`compareTo`. 您必须对比较这两个实例的条件做出一些假设，在这里，由于您只有一个字段`age`，因此好的假设是`Person`根据他们的年龄进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:38:10.783

好吧，这是您的堆栈溢出错误的原因：

```
public int compareTo(Person o) {
        return compareTo(o); 

} 
```

compareTo，调用 compareTo，调用 compareTo，调用.... 你明白了，它永远不会完成并返回。

整数值的简单比较类似于

```
 public int compareTo(Person o) {
            return age - o.age; //or to be java-y :
//Integer.valueOf(age).compareTo(Integer.valueOf(o.age)); 
//or Integer.signum(age - o.age);
//I personally don't trust people to use compareTo properly and not look for 1 or -1 :)

    } 
```

编辑：此外，抑制 rawtype 警告非常顽皮。原始类型与泛型完全相反。如果您收到原始类型警告，则说明您正在编写明确的非泛型代码！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T19:36:21.353

```
public int compareTo(Person o) {
        return age-o.age; // youngest first
        // return o.age-age; // oldest first   
} 
```

另外，请阅读有关[compareTo](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)的文档。你似乎没有做。

# linux - 可以将文件符号链接到网址吗？

> ID：14633686
> 
> 赞同：8
> 
> 时间：2013-01-31T19:33:05.967
> 
> 标签：linux

我们目前面临一个挑战，理想的解决方案是将文件符号链接到 Web URL...

image.jpg -> [http://www.host.com/images/image.jpg](http://www.host.com/images/image.jpg)

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:42:21.597

也许是您使用 wget 为文件提供的命名管道？

编辑 - 不是 wget。您可以使用 linx -dump。所以 -

```
mkfifo reddit
links -dump reddit.com > reddit
cat reddit 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T20:10:52.310

这里有几个不错且有趣的解决方案。我特别喜欢@ArjunShankar 的保险丝解决方案。`/etc/cron.daily`本着保持简单的精神，也许是一个文件

```
#!/bin/sh
cd /your/dir && wget -N http://www.host.com/images/image.jpg 
```

会更简单和足够好（TM）吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-02T15:00:43.723

在 Mac 上，我成功使用了 maxogden 这个很棒的工具，它也使用了 FUSE：
[https ://github.com/maxogden/mount-url](https://github.com/maxogden/mount-url)

```
brew install osxfuse
npm install -g mount-url 
```

然后

```
mount-url "https://url-to-10-gb-video-file-on-some-external-cloud-storage/video.mp4?xxx=yyy" 
```

This would create a symlink for the file named `video.mp4` in the current directory.
Not too fast access speed, but works.

# php - Jquery Multiselect 下拉菜单默认保持打开状态

> ID：14633687
> 
> 赞同：2
> 
> 时间：2013-01-31T19:33:06.893
> 
> 标签：php, html, css

是一种让 Jquery 多选下拉菜单默认打开并始终保持打开状态的方法，无法弄清楚在哪里更改设置，将不胜感激。我正在使用这个插件[http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/)。

提前致谢。

范

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-07T10:51:38.980

这更容易并且始终开放！

```
$("#multiselect-demo").multiselect({
    selectedText: "# of # selected"
  , autoOpen: true
  , beforeclose: function (event, ui){ return false; }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:35:06.157

该插件有一个“自动打开”选项。

> 一个布尔值，表示在小部件初始化时是否自动打开菜单。

```
$("#multiselect-demo").multiselect({
    selectedText: "# of # selected",
    autoOpen: true,
    close: function(event, ui) {
        $("#multiselect-demo").multiselect("open");
    }
}); 
```

# javascript - 需要使用 javascript 检查页面上的所有单选框

> ID：14633690
> 
> 赞同：0
> 
> 时间：2013-01-31T19:33:18.140
> 
> 标签：javascript, jquery

我需要使用 javascript 来检查页面上具有特定 ID 的所有单选框。单选按钮都有不同的名称，并按 3 分组，一个代表批准，一个代表拒绝，一个代表审查......

```
<input type=radio name='21' value='approved' id='approved' title='Approve'>
<input type=radio name='21' value='denied' id='denied' title='Deny'>
<input type=radio name='21' value='review' id='review' checked title='Do nothing right now'> 
```

...等等。我在这个网站和所有的谷歌上搜索过，并没有真正找到适合我的解决方案。我在页面顶部有另一组单选按钮，我想用它来控制其他单选按钮，所以如果我点击顶部的“批准”单选，所有批准单选都被选中，拒绝所有被拒绝的单选框页面等

我正在使用顶部单选按钮集上的 onclick 来触发 javascript 函数，但我不知道该告诉该函数做什么。我认为 jquery 能够很好地做到这一点，但似乎无法提出这样做​​的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:37:58.397

在所有收音机上尝试单击功能并根据其值更新选择。见下文，

```
//   v--- Refined the selector as you want this to happen only when clicking on the 
//        controller radio options.
$('.controller:radio').click(function () {
    $(':radio[value=' + this.value + ']')).prop('checked', true);
}); 
```

**演示：http:** [//jsfiddle.net/KvdNq/](http://jsfiddle.net/KvdNq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:40:20.977

我要做的实际上是在单独的 DIVS 中创建组。然后，您可以遍历该特定 div 中的所有单选，而无需关心相应单选按钮的 IDS 是什么。

```
<div id="group1">
    <input type="checkbox" value="group1"/> Check all in this group
    <input type = "radio" value="xx" />
    <input type="radio" value="yy" />
</div> 
```

现在您可以简单地创建一个获取复选框值的函数，然后遍历匹配的 div，检查其中的所有 RADIO BUTTONS。有道理？

# excel - 将 csv 文件导入 excel 非活动工作表的宏

> ID：14633691
> 
> 赞同：8
> 
> 时间：2013-01-31T19:33:19.297
> 
> 标签：excel, vba, csv, import

我有一个启用宏的 Excel 工作簿，其中包含多个命名工作表。其中一个工作表名为“面板”，第二个工作表名为“数据”。名为“面板”的工作表有一个分配了宏的按钮。我想选择工作表上名为“面板”的按钮，然后出现浏览文件窗口。一旦用户在他们的硬盘驱动器上选择了 csv 文件，我希望将 csv 文件的内容导入到从单元格 A1 开始的名为“data”的工作表中。

问题 1：我分配给按钮的 vba 导致 csv 文件的内容与按钮（“面板”工作表）放在同一个工作表上。我希望将 csv 文件的内容放在“数据”表上。

问题 2：此外，还有一串代码引用了我的硬盘驱动器和一个名为“capture.csv”的文件。因此，当启用宏的 excel 文件在另一台计算机上时，文件会崩溃。有什么方法可以删除路径字符串，以便任何计算机都可以使用该文件？

任何解决此问题的帮助将不胜感激。分配给按钮的宏如下：

```
Sub load_csv()
Dim fStr As String
With Application.FileDialog(msoFileDialogFilePicker)
.Show
If .SelectedItems.Count = 0 Then
MsgBox "Cancel Selected"
End
End If
'fStr is the file path and name of the file you selected.
fStr = .SelectedItems(1)
End With
Range("A1").Select
With ActiveSheet.QueryTables.Add(Connection:= _
"TEXT;C:\Users\laptop\Desktop\CAPTURE.csv", Destination:=Range("$A$1"))
.Name = "CAPTURE"
.FieldNames = True
.RowNumbers = False
.FillAdjacentFormulas = False
.PreserveFormatting = True
.RefreshOnFileOpen = False
.RefreshStyle = xlInsertDeleteCells
.SavePassword = False
.SaveData = True
.AdjustColumnWidth = True
.RefreshPeriod = 0
.TextFilePromptOnRefresh = False
.TextFilePlatform = 437
.TextFileStartRow = 1
.TextFileParseType = xlDelimited
.TextFileTextQualifier = xlTextQualifierDoubleQuote
.TextFileConsecutiveDelimiter = False
.TextFileTabDelimiter = True
.TextFileSemicolonDelimiter = False
.TextFileCommaDelimiter = True
.TextFileSpaceDelimiter = False
.TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
.TextFileTrailingMinusNumbers = True
.Refresh BackgroundQuery:=False
MsgBox fStr
End With
End Sub 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-31T19:48:39.407

这是你正在尝试的吗？

```
Sub load_csv()
    Dim fStr As String

    With Application.FileDialog(msoFileDialogFilePicker)
        .Show
        If .SelectedItems.Count = 0 Then
            MsgBox "Cancel Selected"
            Exit Sub
        End If
        'fStr is the file path and name of the file you selected.
        fStr = .SelectedItems(1)
    End With

    With ThisWorkbook.Sheets("Data").QueryTables.Add(Connection:= _
    "TEXT;" & fStr, Destination:=Range("$A$1"))
        .Name = "CAPTURE"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 437
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = True
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False

    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-16T07:11:06.353

对于 Mac 上的 Excel，QueryTable 对象似乎不支持属性“PreserveFormatting”和“RefreshPeriod”，如果您尝试设置它们，则会出现运行时错误。

此外，Application.FileDialog 也不适用于 Mac，但这在其他帖子中有所介绍。

对于 Mac：

```
Sub load_csv()
Dim fStr As String

fStr = "Macintosh HD:Users:anthony:Documents:example.csv" 'Keeping file String simple for example.

With ThisWorkbook.Sheets("Data").QueryTables.Add(Connection:= _
"TEXT;" & fStr, Destination:=Range("$A$1"))
    .Name = "CAPTURE"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    '.PreserveFormatting = True  **commented out for Mac
    .RefreshOnFileOpen = False
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    '.RefreshPeriod = 0  **commented out for Mac
    .TextFilePromptOnRefresh = False
    .TextFilePlatform = 437
    .TextFileStartRow = 1
    .TextFileParseType = xlDelimited
    .TextFileTextQualifier = xlTextQualifierDoubleQuote
    .TextFileConsecutiveDelimiter = False
    .TextFileTabDelimiter = True
    .TextFileSemicolonDelimiter = False
    .TextFileCommaDelimiter = True
    .TextFileSpaceDelimiter = False
    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
    .TextFileTrailingMinusNumbers = True
    .Refresh BackgroundQuery:=False

End With
End Sub 
```

# regex - 将字符串与许多 RegEx 模式之一匹配

> ID：14633693
> 
> 赞同：0
> 
> 时间：2013-01-31T19:33:26.233
> 
> 标签：regex, vb.net, dataset

我有一个名为 ds_SortPlan 的全局数据集，用于将匹配某个正则表达式模式的字符串映射到整数。

```
Private Function MatchDestination(ByVal code As String) As Integer
    Dim m As Match
    For Each tempRow As Data.DataRow In ds_SortPlan.Tables("MatchCode_Lookup").Rows
        m = Regex.Match(code, tempRow.Item("Match_String"))
        If m.Success Then
            Return tempRow.Item("ID")
            Exit Function
        End If
    Next tempRow
    Return 0
End Function 
```

这似乎是一种非常缓慢和笨拙的方式。:( 有没有更好的方法来设置一个正则表达式，它将接受一个字符串代码并尝试将它与返回关联 ID 号的多个模式匹配。

如果可能的话，我想保留 DataSet，因为它有很多依赖项。

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:41:41.863

如果不重新考虑你的对象模型，你不能真正让这个方法更快，但你可以把它写得更短（在我看来更具可读性）：

```
Private Function MatchDestination(ByVal code As String) As Integer
    For Each row In ds_SortPlan.Tables("MatchCode_Lookup").Rows
        If Regex.Match(code, row.Item("Match_String")).Success Then
            Return row.Item("ID")
        End If
    Next row
    Return 0
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:59:57.783

如果你经常调用这个函数，你可以存储模式并重用它们，而不是每次都从数据库中读取它们

```
Private Function MatchDestination(ByVal input As String) As Integer
    Static patterns As List(Of KeyValuePair(Of Integer, String))

    If patterns Is Nothing Then
        patterns = New List(Of KeyValuePair(Of Integer, String))
        For Each row As DataRow In ds_SortPlan.Tables("MatchCode_Lookup").Rows
            Dim entry = New KeyValuePair(Of Integer, String)( _
                DirectCast(row.Item("ID"), Integer), _
                DirectCast(row.Item("Match_String"), String) _
            )
            patterns.Add(entry)
        Next
    End If

    For Each pattern As KeyValuePair(Of Integer, String) In patterns
        If Regex.IsMatch(input, pattern.Value) Then
            Return pattern.Key
        End If
    Next
    Return 0
End Function 
```

注意：你不需要`Exit Function`after `Return`。从 VB6`Return`替换旧的。`Exit Function`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T20:02:34.753

您可以在那里添加缓存。为正则表达式创建一个静态数组并从那里使用旧的正则表达式对象，而不是每次都重新创建它们。如果您要经常使用它们，也不要忘记编译正则表达式。当您使用第二次或更长时间时，这将为您提供更多性能。所以缓存+编译正则表达式会给你性能提升；但它会使第一次运行变慢。只需在创建新的正则表达式时将 RegexOptions.Compiled 添加到参数中。

# c# - 如何在 Windows 上安装 Python for .NET

> ID：14633695
> 
> 赞同：17
> 
> 时间：2013-01-31T19:33:28.023
> 
> 标签：c#, python, .net, python.net, pythonnet

我为 .NET 下载[*了 Python*](http://pythonnet.github.io/)。
zip 中包含`clr.pyd`、`nPython.exe`和`Python.Runtime.dll`2 个调试数据库文件。
我将 clr.pyd 和 Python.Runtime.dll 放在我的 python DLL 目录 C:\Python27\DLLs 中，认为这就是安装所需的全部内容。然后我打开 Python GUI 并输入 import clr ，我得到：

```
Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    import clr
SystemError: dynamic module not initialized properly 
```

python 新手，但不是 .NET，想要使用 CPython 而不是 IronPython。我在这个安装中缺少什么？*Python for .NET*的自述文件说有一个 Windows 包的安装，但我发现的只是 zip 文件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-02T04:44:49.577

在 Python 中加载 CLR 的正确方法是这样的：

1.  确保 Python 安装文件夹（例如 C:\Python27）中的 Python.NET 没有遗留任何旧东西。就我而言，我`clr.pyd`在其中一个文件夹中有遗产。请注意，某些旧版本的 pip 并未删除 Python.NET 的所有部分。
2.  将包含 Python.NET 文件 (`clr.pyd`和`Python.Runtime.dll`) 的目录附加到`sys.path`

现在您可以以最灵活的方式加载 CLR，甚至无需安装到 Python 目录！

您可以从 github 上的源代码编译：

```
pip install git+https://github.com/pythonnet/pythonnet 
```

或使用 Christoph Gohlke 的 Windows 轮子/安装程序：

[http://www.lfd.uci.edu/~gohlke/pythonlibs/#pythonnet](http://www.lfd.uci.edu/~gohlke/pythonlibs/#pythonnet)

PyPI 包可用于从 pip 安装：

[https://pypi.python.org/pypi/pythonnet](https://pypi.python.org/pypi/pythonnet)

docker、WinPython、conda、nuget、choco等更多安装选项在这里列出：

[https://github.com/pythonnet/pythonnet/wiki/Installation](https://github.com/pythonnet/pythonnet/wiki/Installation)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T13:21:37.497

为 .NET 安装 Python 的正确方法是将.zip 中的**所有文件**复制到包含 .py 文件的目录中。

然后如果你执行

```
python yourfilename.py 
```

您应该会发现您的“import clr”语句有效。我已经使用 python 2.7 x86 和 pythonnet-2.0-Beta0-clr4.0_140_py27_UCS2_x86.zip 对此进行了测试

通过仅将 clr.pyd 文件复制到我的工作目录中，我能够复制您的错误。

请注意，我无法在 Python 3.3 x86 或 Python 3.3 x64 中完成这项工作

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-13T17:44:31.290

实际上，我在这里亲自处理并创建了一个 Python.Net Chocolatey 包。安装，只需运行

> cinst pythonnet

在命令行。也许这将帮助遇到问题的用户运行它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-13T15:15:57.477

我还不知道为什么，但我可以让它工作的唯一方法是将这 3 个文件直接复制到 C:\Python27\ 目录中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-06T00:34:29.717

如果您打算使用 py2exe 或 pyinstall 冻结，请务必安装开发版本。与 py2exe、pyinstaller 和其他冷冻机打包时，2.0.0 版本有问题。但是 2.1.0.dev1 运行良好。所以...

`pip install --pre pythonnet`

而且您必须将 pythone.runtime.dll 添加到捆绑包中（请参阅文档以了解您首选的捆绑器）。在使用 bundle_files: 1（单个 exe）时，py2exe 加载 dll 的方式也存在问题。

# python - 在Python中如何将数字转换为混合列表中的浮点数

> ID：14633703
> 
> 赞同：7
> 
> 时间：2013-01-31T19:33:48.197
> 
> 标签：python, string, list

我有一个字符串列表，格式如下

```
a = ['str','5','','4.1'] 
```

我想将列表中的所有数字转换为浮动，但保持其余不变，就像这样

```
a = ['str',5,'',4.1] 
```

我试过

```
map(float,a) 
```

但显然它给了我一个错误，因为某些字符串无法转换为浮点数。我也试过

```
a[:] = [float(x) for x in a if x.isdigit()] 
```

但它只给了我

```
[5] 
```

所以浮点数和所有其他字符串都丢失了。我应该怎么做才能同时保留字符串和数字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T19:37:43.310

```
>>> a = ['str','5','','4.1']
>>> a2 = []
>>> for s in a:
...     try:
...         a2.append(float(s))
...     except ValueError:
...         a2.append(s)
>>> a2
['str', 5.0, '', 4.0999999999999996] 
```

如果你正在做十进制数学，你可能想看看十进制模块：

```
>>> import decimal
>>> for s in a:
...     try:
...         a2.append(decimal.Decimal(s))
...     except decimal.InvalidOperation:
...         a2.append(s)
>>> a2
['str', Decimal('5'), '', Decimal('4.1')] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T19:36:45.420

```
for i, x in enumerate(a):
    try:
        a[i] = float(x)
    except ValueError:
        pass 
```

这假设您要更改`a`原地，要创建新列表，您可以使用以下内容：

```
new_a = []
for x in a:
    try:
        new_a.append(float(x))
    except ValueError:
        new_a.append(x) 
```

这种 try/except 方法是标准的[EAFP](http://docs.python.org/2/glossary.html#term-eafp)，并且比检查每个字符串是否为有效浮点数更有效且更不容易出错。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T19:43:20.127

这是一种无需*异常处理*并使用一些*正则表达式*的方法：-

```
>>> a = ['str','5','','4.1']
>>> import re
>>> [float(x) if re.match("[+-]?(?:\d+(?:\.\d+)?|\.\d+)$", x) else x for x in a]
4: ['str', 5.0, '', 4.1] 
```

请注意，此正则表达式仅涵盖适用于您的情况的基本数字范围。有关更精细的正则表达式以匹配更广泛的浮点数，例如，包括指数，您可以看一下这个问题：-

*   [提取浮点/双精度值](https://stackoverflow.com/questions/385558/python-and-regex-question-extract-float-double-value)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-31T19:49:27.900

我的版本：

```
def convert(value):
    try:
        return float(value)
    except ValueError:
        return value

map(convert, a) 
```

# c++ - NVCC 警告级别

> ID：14633705
> 
> 赞同：7
> 
> 时间：2013-01-31T19:33:51.823
> 
> 标签：c++, cuda, nvcc

我希望 NVCC 将以下警告视为错误：

```
warning : calling a __host__ function("foo") from a __host__ __device__ function("bar") 
```

NVCC 文档“NVIDIA CUDA Compiler Driver NVCC”甚至不包含“警告”一词。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-19T21:45:12.320

引用 CUDA COMPILER DRIVER NVCC 参考指南，[第 3.2.8 节。“通用工具选项”](https://docs.nvidia.com/cuda/archive/9.1/pdf/CUDA_Compiler_Driver_NVCC.pdf#%5B%7B%22num%22%3A176%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C108%2C710.807%2Cnull%5D)：

> `--Werror kind`将指定种类的警告变成错误。以下是此选项接受的警告种类列表：
> 
> `cross-execution-space-call`对不受支持的跨执行空间调用更加严格。`__host__ __device__`对于从 a到`__host__`函数的调用，编译器将生成错误而不是警告。

因此，请执行以下操作：

项目 -> 属性 -> 配置属性 -> CUDA C/C++ -> 命令行 -> 附加光学 -> 添加 --Werror cross-execution-space-call

这个测试程序

```
#include <cuda.h>
#include <cuda_runtime.h>

void foo() { int a = 2;}

__host__ __device__ void test() {
    int tId = 1;
    foo();
}

int main(int argc, char **argv) { } 
```

返回以下警告

```
warning : calling a __host__ function("foo") from a __host__ __device__ function("test") is not allowed 
```

没有上面提到的附加编译选项并返回以下错误

```
Error   3   error : calling a __host__ function("foo") from a __host__ __device__ function("test") is not allowed 
```

使用上面提到的附加编译选项。

# php - websocket的服务器端需要什么？

> ID：14633708
> 
> 赞同：1
> 
> 时间：2013-01-31T19:33:58.033
> 
> 标签：php, html, sockets, cordova, websocket

我正在使用以下 js 插件，它允许我在 android 和 iOS 上使用 WebSockets 以及用 html5 编写的应用程序（在我的情况下通过 phonegap）。

[https://github.com/FreakDev/PhoneGap-Android-HTML5-WebSocket](https://github.com/FreakDev/PhoneGap-Android-HTML5-WebSocket)

为了使用 websocket，我还需要什么？

我有一个安装了 PHP 和 MySQL 的 bluehost 基本服务器。我需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:52:02.390

首先，您可以使用这样的库： [http ://code.google.com/p/phpwebsocket/](http://code.google.com/p/phpwebsocket/)

其次，您的主机必须允许您创建套接字。这意味着 PHP 必须启用 php_sockets.dll (Win) 或 sockets.so (Linux) 扩展并从您的服务器转发端口。您还需要从命令行运行您的 php 或以某种方式使其永远保持活力。

这就像在 PHP 中创建一个普通的套接字一样。

*编辑：

1.  WebSockets 只是某种普通的套接字。在 websocket 中，您可以连接到正在侦听连接的端点，然后与之通信。就像普通的套接字一样，但在协议上有简单的区别和更多的限制。为此，您需要一个脚本或应用程序来永久运行并处理来自网页的所有连接。但是一个 php 文件将在请求结束后结束。为了让 php 文件永远运行，您需要从命令行运行它，这意味着您需要具有 shell 访问权限，或者您可以使用此代码永远运行您的 php 脚本：（但您必须考虑一种调用它的机制只有一次）

    忽略用户中止（真）；

    ini_set('max_execution_time', 0);

    设置时间限制（0）；

2.  你可以测试一下。如果您的应用程序失败并显示有关不知道诸如 socket_connect 或 socket_bind 之类的函数的错误消息，那么您没有 php 的套接字扩展。

3.  这是供下载的 phpwebsocket 文件：http://phpwebsocket.googlecode.com/svn/trunk/%20phpwebsocket/ [那里](http://phpwebsocket.googlecode.com/svn/trunk/%20phpwebsocket/) 也有一个示例。

4.  正如“Tom van der Woerdt”所说，PHP 不是为进行套接字编程而设计的。选择非脚本语言并使用专用服务器或至少一个 vps 来打开和管理套接字。

# android-arrayadapter - 我的父 ViewGroup 的子视图保持不变，并显示在底部的新膨胀布局中

> ID：14633716
> 
> 赞同：1
> 
> 时间：2013-01-31T19:34:27.737
> 
> 标签：android-arrayadapter, layout-inflater, custom-lists

## 使用 Array Adapter 进行膨胀 - 膨胀的布局没有填满我的全屏。

父视图组中的视图显示在我新膨胀的布局的底部。充气不适合全屏并导致图像中的显示问题。代码工作正常，但我的显示器有问题。请提出可能的解决方案。父 XML 也是一个膨胀的布局列表（数组适配器）。

## 笔记

*   布局通过设置 attachRoot=false (Inflater.inflate(R.layout.chapterlayout, parent, false)) 正确膨胀。
*   无法从 ArrayAdapter 处理 ViewGroup，因此无法删除父视图。

膨胀的 XML 布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/my_background"
android:orientation="vertical" 
>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:weightSum="100" >

    <TextView
        android:id="@+id/ENo"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="90"
        android:text="1."
        android:textColor="#0000FF"
        android:textSize="15sp"
        android:textStyle="bold" >
    </TextView>

    <TextView
        android:id="@+id/EA"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="10"
        android:paddingBottom="5sp"
        android:text="My Text"
        android:textColor="#0000FF"
        android:textSize="15sp"
        android:textStyle="bold" >
    </TextView>
</LinearLayout>

<TextView
    android:id="@+id/EE"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="My Text"
    android:textColor="#0000FF"
    android:textSize="15sp"
    android:textStyle="bold" >
</TextView>

</LinearLayout> 
```

父 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
android:background="@drawable/my_background">

<TextView
    android:id="@+id/txt"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="15sp"
    android:textColor="#0000FF"
    android:textStyle="bold"
    android:background="@drawable/my_background">
</TextView>

</LinearLayout> 
```

JAVA代码

```
public class MyChapterAdapter extends ArrayAdapter<String> {
private final Context context;
private final String[] values;

public MyChapterAdapter(Context context, String[] values) {
    super (context, R.layout.main, values);
    this.context = context;
    this.values = values;
}

static class ViewHolder { 
    TextView ENo; 
    TextView EA; 
    TextView EE;    
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder; 
    if (convertView == null) { 
        LayoutInflater li = (LayoutInflater)   
getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = li.inflate(R.layout.chapterlayout, parent, false);
        holder = new ViewHolder(); 
        holder.ENo = (TextView) convertView.findViewById(R.id.ENo); 
        holder.EA = (TextView) convertView.findViewById(R.id.EA); 
        holder.EE = (TextView) convertView.findViewById(R.id.EE); 
        convertView.setTag(holder); 
   } else { 
       holder = (ViewHolder) convertView.getTag(); 
   } 

   reDesignLayout(position,  holder);
   return convertView; 

}

private void reDesignLayout(int position, ViewHolder h) {
    // TODO Auto-generated method stub

    String chapSplit[] =values[position].split("##");

       h.ENo.setText(chapSplit[0]+". "); 
       h.EA.setText(chapSplit[1]); 
       h.EE.setText(chapSplit[2]); 
    }
} 
```

# jquery - jQuery replaceWith 和切换冲突

> ID：14633717
> 
> 赞同：0
> 
> 时间：2013-01-31T19:34:29.280
> 
> 标签：jquery, toggle, conflict, replacewith

我有html

```
<div id=1>
  <span id=2></span>
</div>
<div id=3>
</div> 
```

我正在尝试替换`span`并`a`使用锚点`.toggle()` `<div id=3>`

```
$('#2').replaceWith(function(){
  return $("<a id=\"2\" href=\"#\" />").append($(this).contents());
}); 
```

这适用于将跨度转换为锚点，但是当我尝试链接点击功能`.toggle()`时，它拒绝切换。

```
$('#2').replaceWith(function() {
  return $("<a id=\"2\" href=\"#\" />").append($(this).contents());
}).click(function() {
  $('#3').toggle();
  return false;
}); 
```

`.toggle()`如果我删除，点击功能有效`.replaceWith()`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:01:44.990

我的最终解决方案

```
$('#2').replaceWith(function(){
  return $('<a id="' + $(this).attr('id') + '" href="#" />').append($(this).contents());
});

$('#2').click(function() {
  $('#3').toggle();
  scrollToDiv($(this),0);
  return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:02:21.557

您正在绑定到刚刚删除的元素。

```
$('#2') // <-- here you already selected the span
// now you replaced it with a new element
.replaceWith(function() {
  return $("<a id=\"2\" href=\"#\" />").append($(this).contents());
})
// the selector is still on the span so you bound the click event to the span
.click(function() {
  $('#3').toggle();
  return false;
}); 
```

您可以做的是使用委托，因此您对元素所做的更改并不重要。将其绑定到父元素

```
$('#1').on('click','#2',function(){
      //your code here
}); 
```

现在你的父元素将监听冒泡的点击事件并处理它们。所以你改变#2元素多少次都没关系 - 只要它是 id=2 那么它就会触发处理程序

# mysql - 根据先进先出定价计算利润

> ID：14633720
> 
> 赞同：13
> 
> 时间：2013-01-31T19:34:50.130
> 
> 标签：mysql, sql, sql-server

假设我有一些 SKU 的采购和销售数据：

```
po_id | sku | purchase_date    | price | qty
----------------------------------------------
    1 | 123 | 2013-01-01 12:25 | 20.15 |   5
    2 | 123 | 2013-05-01 15:45 | 17.50 |   3
    3 | 123 | 2013-05-02 12:00 | 15.00 |   1
    4 | 456 | 2013-06-10 16:00 | 60.00 |   7

sale_id | sku | sale_date        | price | qty
------------------------------------------------
      1 | 123 | 2013-01-15 11:00 | 30.00 |   1
      2 | 123 | 2013-01-20 14:00 | 28.00 |   3
      3 | 123 | 2013-05-10 15:00 | 25.00 |   2
      4 | 456 | 2013-06-11 12:00 | 80.00 |   1 
```

假设它们按照购买顺序出售，我如何通过 SQL 找到销售利润？例如，sku 123 的边距是

```
30*1 + 28*3 + 25*2 - 20.15*5 - 17.50*1 
```

17.50 购买了 2 个，15.00 购买了 1 个未售出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T19:53:04.553

好问题。我采用的方法是计算总销售额。然后计算累积购买量，并将它们与特殊逻辑结合起来，得到组合的正确算法：

```
select s.sku,
       (MarginPos - SUM(case when s.totalqty < p.cumeqty - p.qty then p.price * p.qty
                             when s.totalqty between p.cumeqty - p.qty and p.qty
                             then s.price * (s.totalqty - (p.cumeqty - p.qty))
                             else 0
                        end)
       ) as Margin
from (select s.sku, SUM(price*qty) as MarginPos, SUM(qty) as totalqty
      from sales s
     ) s left outer join
     (select p.*,
             (select SUM(p.qty) from purchase p2 where p2.sku = p.sku and p2.sale_id <= p.sale_id
             ) as cumeqty
      from purchase s
     )
     on s.sku = p.sku
group by s.sku, MarginPos 
```

注意：我没有测试过这个查询，所以它可能有语法错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T19:45:45.357

设置环境

```
 declare @purchased table (id int,sku int,dt date,price money,qty int)
    declare @sold table (id int,sku int,dt date,price money,qty int)

    insert into @purchased
    values( 1 , 123 , '2013-01-01 12:25' , 20.15 ,   5)
        ,(2 , 123 , '2013-05-01 15:45' , 17.50 ,   3)
        ,(3 , 123 , '2013-05-02 12:00' , 15.00 ,   1)
        ,(4 , 456 , '2013-06-10 16:00' , 60.00 ,   7)

    insert into @sold
    values(1 , 123 , '2013-01-15 11:00' , 30.00 ,   1)
          ,(2 , 123 , '2013-01-20 14:00' , 28.00 ,   3)
          ,(3 , 123 , '2013-05-10 15:00' , 25.00 ,   2)
          ,(4 , 456 , '2013-06-11 12:00' , 80.00 ,   1) 
```

一个sqlserver解决方案应该是......

```
 with cte_sold as (select sku,sum(qty) as qty, SUM(qty*price) as total_value
                      from @sold
                      group by sku
                      )
    ,cte_purchased as (select id,sku,price,qty 
                       from @purchased
                       union all select id,sku,price,qty-1 as qty 
                       from cte_purchased
                       where qty>1
                    )
    ,cte_purchased_ordened as(select ROW_NUMBER() over (partition by sku order by id,qty) as buy_order
                                    ,sku
                                    ,price
                                    ,1 as qty
                              from cte_purchased 
    )

    select P.sku
          ,S.total_value - SUM(case when P.buy_order <= S.qty then P.price else 0 end) as margin
    from cte_purchased_ordened P
    left outer join cte_sold S
    on S.sku = P.sku
    group by P.sku,S.total_value,S.qty 
```

取得的成果

```
 sku margin
    123 45,75
    456 20,00 
```

问题描述中 sku 123 示例的相同结果...

30*1 + 28*3 + 25*2 - 20.15*5 - 17.50*1 = 45.75

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:27:04.873

这真的很可怕，因为它会更改查询中的 MySQL 变量，但它确实有效（并且需要 3 个语句）：

```
select
  @income := sum(price*qty) as income,
  @num_bought := cast(sum(qty) as unsigned) as units
from sale
where sku = 123
;

select
  @expense := sum(expense) as expense,
  sum(units) as units
from (select
  price * least(@num_bought, qty) as expense,
  least(@num_bought, qty) as units,
  @num_bought := @num_bought - least(@num_bought, qty)
from purchase
where sku = 123 and @num_bought > 0
order by po_id
) as a
;

select round(@income - @expense, 2) as profit_margin; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-31T21:36:48.073

这是 Oracle 查询，但应该适用于任何 SQL。它是简化的，不包括所有必要的计算。您可以自己添加它们。您会看到总数略有不同，为 17.50*3 而不是 17.50*1：

```
SELECT po_sku AS sku, po_total, sale_total, (po_total-sale_total) Margin
  FROM
 (
  SELECT SUM(price*qty) po_total, sku po_sku
    FROM stack_test
  GROUP BY sku
 ) a,
 (
  SELECT SUM(price*qty) sale_total, sku sale_sku
    FROM stack_test_sale
   GROUP BY sku
 ) b
 WHERE po_sku = sale_sku
 /

SKU     PO_TOTAL    SALE_TOTAL  MARGIN
---------------------------------------------------
123     168.25      164         4.25
456     420         80          340 
```

如果需要，您还可以按 SKU 添加分区：

```
SUM(price*qty) OVER (PARTITION BY sku ORDER BY sku) 
```

# php - 使用php从数据库中检索图像

> ID：14633722
> 
> 赞同：-1
> 
> 时间：2013-01-31T19:34:54.717
> 
> 标签：php, file-upload, mysqli

```
<?php
$file= $_FILES["file"]["name"];//file selected in form 
echo "Upload: " . $_FILES["file"]["name"] . "<br>";
    echo "Type: " . $_FILES["file"]["type"] . "<br>";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

      move_uploaded_file($_FILES["file"]["tmp_name"],
      "c:/EasyPHP-12.1/www/new website/upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "c:/EasyPHP-12.1/www/new website/upload/" . $_FILES["file"]["name"];
      if(($_FILES['file']['size'] >0))
        {echo 'imagetrue';$con=mysql_connect('localhost','abc','YES') or die ("con");;
                    $db=mysql_select_db("website",$con) or die ("db");
                    $query=mysql_query("insert into website.picture (imagew) values ('$file')") or die('query'); //storing in db}
      //echo $_FILES['file']['error'] ;

      $query2= mysql_query("select * from website.picture");
$res=mysql_fetch_array($query2);
foreach($res as $row){ 
$str = "c:/EasyPHP-12.1/www/new website/upload/ ".$row['imagew'];
echo '<img src="'.$str.'" alt="no">' ;}

?> 
```

我正在使用此脚本存储图像，然后将其显示在网页上，但它不工作它只显示空缩略图...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:47:56.383

我非常怀疑使用像 c:/EasyPHP-12.1/www/new website/upload/ 这样的绝对路径

如果您然后访问该页面`http://127.0.0.1/new-website`（我假设您是 - 或类似的东西），那么拥有 Windows 系统路径名可能是一个问题 - 浏览器是否甚至像这样读取本地文件系统？

此外，当您将其移动到另一台服务器时，它非常不便携。

我建议 $str = 'upload/'.$row['imagew']; 因此，它与托管在（我认为）中的文档`127.0.0.1/new website/image-viewer.php`（或您所称的任何内容）相关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:08:38.327

检查 move_uploaded_file() 的返回值 - 如果它是假的，那么它就失败了。如果失败，请尝试使用相对路径：

`move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]);`

这再次假设您的脚本位于`127.0.0.1/new-website`

编辑 - 注意 ::: 您的表单是否使用 enctype="multipart/form-data" ？如果不是，那么图像永远不会到达服务器！

# c# - 如何为未知类型的对象创建引用参数对象？

> ID：14633725
> 
> 赞同：0
> 
> 时间：2013-01-31T19:35:08.077
> 
> 标签：c#, .net, wcf, pointers, types

假设我正在使用以下代码：

```
Type type = info.ParameterType;
object activatedTypeToReference = Activator.CreateInstance(type.GetElementType()); 
```

如何`activatedTypeToReference`在 C# 中为上述对象创建引用参数对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:07:57.807

当您调用该方法时，您传入一个参数数组。对于`out`参数，您无需为数组元素指定任何内容 - 值可以为 null。当方法返回时，数组将包含方法设置的值。这是一个例子：

```
using System;

public class Test
{
    static void Main()
    {        
        var method = typeof(Test).GetMethod("DummyMethod");
        object[] args = new object[1];
        method.Invoke(null, args);
        Console.WriteLine(args[0]); // Prints 10
    }

    public static void DummyMethod(out int x)
    {
        x = 10;
    }
} 
```

# javascript - OpenLayers + Rails 3 + CoffeeScript = a.draw 不是函数

> ID：14633728
> 
> 赞同：0
> 
> 时间：2013-01-31T19:35:21.453
> 
> 标签：javascript, ruby-on-rails, coffeescript, openlayers

我不明白为什么这不适用于 Coffeescript。我试图简化这个例子： http: [//openlayers.org/dev/examples/click-handler.html](http://openlayers.org/dev/examples/click-handler.html)

在视图中，我有一个带有 ID 映射的 div 并调用 initMap()。

我得到的错误是：

```
 TypeError: a.draw is not a function 
```

在 openlayers lib 中间

我在 .js.coffeescript 文件中得到以下代码：

```
@MarkOnce = OpenLayers.Class OpenLayers.Control,
defaultHandlerOptions:
  'single': true
  'double': false
  'pixelTolerance': 0
  'stopSingle': false
  'stopDouble': false

initialize: ->
  this.handlerOptions = OpenLayers.Util.extend({}, this.defaultHandlerOptions)
  OpenLayers.Control.prototype.initialize.apply(this, arguments)
  this.handler = new OpenLayers.Handler.Click(this, {'click': this.mark},     this.handlerOptions)

mark: (evt) ->
  console.log 'mark'
  alert('pan')

 default_marker = (lonlat) ->
   size = new OpenLayers.Size(21,25)
   offset = new OpenLayers.Pixel(-(size.w/2), -size.h)
   icon = new OpenLayers.Icon('http://www.openlayers.org/dev/img/marker.png',size,offset)
   marker = new OpenLayers.Marker(lonlat,icon)
return marker

  @initMap = (lon,lat,marker) ->
    @map = load_map(lon,lat)
    render_marker(@map,lon,lat) if marker
    set_projection(@map,lon,lat)
    set_callbacks(@map)

 load_map = (lon,lat) ->
   map = new OpenLayers.Map 'map'
   layer = new OpenLayers.Layer.OSM()
   map.addLayer(layer)
   map

 set_projection = (map, lon, lat) ->
   projection = new OpenLayers.Projection("EPSG:4326")
   point = new OpenLayers.LonLat(lon,lat)
   console.log(point)
   center = point.transform(projection, map.getProjectionObject())
   map.setCenter(point, 5)

 render_marker = (map,lon,lat) ->
   layer_once = new OpenLayers.Layer.Markers("mark_once")
   map.addLayer(layer_once)

   lonlat = new OpenLayers.LonLat(lon,lat)
   layer_once.addMarker(@default_marker(lonlat))
   @numMarkers++

 set_callbacks = (map) ->
   click = new MarkOnce()
   map.addControl(click)
   click.activate() 
```

编辑：看来，如果您更改 this.defaultHandlerOptions 为 {draw: -> alert 'pan'} 它可以工作。现在的问题是：在这个范围内发生了什么？这是什么”？

EDIT2：这个abordage的一个可能问题是，每当我缩小或缩小地图时，标记都会放置在地图的中心。如何避免这种情况发生？

EDIT3：如果您到了这一点，请炸毁您正在做的任何事情并使用传单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-31T00:30:20.730

我在使用 OpenLayers.Class 从 OpenLayers.Control 和 OpenLayers.Handle.Click 创建点击处理程序时遇到了同样的问题，就像您尝试过的一样 - 但似乎不需要。

请参阅[我在这里有 OpenLayers / jQuery 冲突吗？](https://stackoverflow.com/questions/12312398/do-i-have-a-openlayers-jquery-conflict-here) 关于如何在地图构造函数的 options 参数中很容易地建立一个事件监听器。这对我来说很好。

# linux - 从 Linux / Windows 为 Mac 编译

> ID：14633729
> 
> 赞同：0
> 
> 时间：2013-01-31T17:13:50.250
> 
> 标签：linux, macos

有没有办法从 linux / windows 的 mac 的 c++ 代码生成二进制文件？

目前我们想提供参考实现，我们没有 mac，但参与者有。因此出现了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:05:14.710

不可靠——而且，即使你可以，你也没有办法测试它们。要么找一个友好的人使用 Mac 来构建和测试你的应用程序，要么不要分发 Mac 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:57:22.930

如果你有 C++ 代码，你几乎可以从任何机器[交叉编译](https://www.google.es/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC0QFjAA&url=http://en.wikipedia.org/wiki/Cross_compiler&ei=MswKUbC1LtSWhQeDwYHwDQ&usg=AFQjCNEr47oVnsOKgrBrObczlSy2BPGuFw&sig2=cxOG5GmSWlTPY1PP7GyBSA&bvm=bv.41642243,d.ZG4)到另一台机器。我想你可以从 mac 机器生成二进制文件到 linux/windows 机器。

# php - 在目录中搜索文件并从数据库中删除实体

> ID：14633730
> 
> 赞同：-5
> 
> 时间：2013-01-31T19:35:29.933
> 
> 标签：php, database, file, directory

好的我有一个数据库，游戏表充满了游戏和嵌入字段是一个目录路径。我需要一个 php 脚本来搜索我的 3000 db 检查目录或文件是否存在于我的 /games/ 目录中。如果该文件所在的文件或目录不存在，则从我的数据库中删除该实体或 ID 或游戏。

我很抱歉没有很好的描述。我很难用语言表达我想要的东西。我使用mysql数据库的任何方式。我的问题是我使用一个插件将 3000 个奇怪的游戏导入我的街机网站，该插件下载 game.zip 文件，提取 zip 并在 /games/game-name 中创建一个新目录，并将我的数据库中的嵌入字段更改为游戏文件的新位置。问题在于插件没有下载game.zip的错误，现在我的数据库中有没有游戏目录或文件的游戏。但是嵌入在数据库中说 /games/game-name 但没有这样的目录。

我希望这能解决问题。我希望得到一些指导，因为我目前无法学习足够的 php 来自己制作它，但是如果我看到它，我会理解的。对我来说，写代码比读代码困难得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:52:04.580

你可以使用

*   用于访问数据库中游戏表[的 PHP 数据对象 (PDO)扩展。](http://php.net/manual/es/book.pdo.php)
*   [PHP 目录函数](http://www.php.net/manual/en/ref.dir.php)和[PHP 文件系统函数](http://www.php.net/manual/en/ref.filesystem.php)列出您的 /games/ 目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:10:47.613

你用什么数据库？MySQL？PostgreSQL？SQL 服务器？部分代码将根据您使用的数据库而改变

# android - 打开 AnySoftKeyboard 时出错

> ID：14633732
> 
> 赞同：2
> 
> 时间：2013-01-31T19:35:32.577
> 
> 标签：android, open-source

我导入项目 [https://github.com/AnySoftKeyboard/AnySoftKeyboard](https://github.com/AnySoftKeyboard/AnySoftKeyboard)

我面临一些错误，比如

```
import com.anysoftkeyboard.api.KeyCodes;
import com.menny.android.anysoftkeyboard.R; 
```

导入 com.anysoftkeyboard.api 无法解析

和错误错误：错误：找不到与给定名称匹配的资源：attr 'iconKeySpace'。

```
 <!-- should support normal, android:state_pressed, feedback, android:state_pressed+feedback, android:state_checked, state_checked+feedback -->
        <item name="iconKeyShift">@drawable/dark_key_shift_set</item>
        <!-- should support normal, android:state_pressed, feedback, android:state_pressed+feedback, android:state_checked, state_checked+feedback -->
        <item name="iconKeyControl">@drawable/dark_key_control_set</item>
        <!-- should support normal, feedback -->
        <item name="iconKeyBackspace">@drawable/dark_key_delete_set</item>
        <!-- should support normal, feedback -->
        <item name="iconKeySpace">@drawable/dark_key_space_set</item>
        <!-- should support normal, feedback -->
        <item name="iconKeyTab">@drawable/dark_key_tab_set</item> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:32:54.210

您需要将 AnySoftKeyBoard-API 项目添加为库。您可以从此链接下载。

> [https://github.com/AnySoftKeyboard/AnySoftKeyboard-API](https://github.com/AnySoftKeyboard/AnySoftKeyboard-API)

# asp.net - GridView 中 TemplateField 上的标题

> ID：14633735
> 
> 赞同：8
> 
> 时间：2013-01-31T19:35:50.490
> 
> 标签：asp.net, templates, gridview, header

当我使用超链接创建“TemplateField”时，如何在 GridView 中创建标题“全名”？例如，我希望 TemplateField 中的这些行具有标题“全名”。

```
<asp:GridView ID="CustomersGridView" runat="server" AutoGenerateColumns="False" >
        <Columns>

            <asp:TemplateField>
                <ItemTemplate>
                <asp:HyperLink ID="HyperLink1" runat="server" Text='<%# Eval("FirstName") + " " + Eval("LastName")  %>'
                     NavigateUrl="CarTest.aspx" > </asp:HyperLink>        
                </ItemTemplate>
            </asp:TemplateField>

        </Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-31T19:40:29.123

使用标题模板：

```
 <Columns>
    <asp:TemplateField>
          <ItemTemplate>
               ....................
          </ItemTemplate>
          <HeaderTemplate>
                Full Name
         </HeaderTemplate>
     </asp:TemplateField>
  </Columns> 
```

有关更多信息，[请阅读](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.templatefield.headertemplate%28v=vs.80%29.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-31T19:45:21.627

```
<asp:GridView ID="CustomersGridView" runat="server" AutoGenerateColumns="False" >
    <Columns>

        <asp:TemplateField HeaderText="Full Name">
            <ItemTemplate>
            <asp:HyperLink ID="HyperLink1" runat="server" Text='<%# Eval("FirstName") + " " + Eval("LastName")  %>'
                 NavigateUrl="CarTest.aspx" > </asp:HyperLink>        
            </ItemTemplate>
        </asp:TemplateField>

    </Columns>
</asp:GridView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-15T05:14:23.907

```
<div class="table-responsive">
                                                                        <asp:GridView ID="grdDisCategry" runat="server" CssClass="table table-small-font table-bordered table-striped" Font-Size="Small"
                                                                            EmptyDataRowStyle-ForeColor="#cc0000" HeaderStyle-Font-Size="10" HeaderStyle-Font-Names="Arial"
                                                                            AutoGenerateColumns="False" EmptyDataText="No Record Found" HeaderStyle-ForeColor="#990000">
                                                                            <Columns>
<asp:TemplateField HeaderStyle-HorizontalAlign="Center" ItemStyle-HorizontalAlign="Center">
                                                                                    <HeaderTemplate>

                                                                                        <asp:TextBox ID="txtMonthsDays" runat="server" class="form-control input-sm m-bot15"
                                                                                            Font-Bold="true" Text='<%#Bind("MonthsDays") %>'></asp:TextBox>
                                                                                    </HeaderTemplate>
                                                                                    <ItemTemplate>

                                                                                        <asp:TextBox ID="txtMonthDays" runat="server" class="form-control input-sm m-bot15"
                                                                                            Font-Bold="true" Text='<%#Bind("MonthDays") %>'></asp:TextBox>

                                                                                    </ItemTemplate>
                                                                                    <HeaderStyle HorizontalAlign="Center"></HeaderStyle>
                                                                                    <ItemStyle HorizontalAlign="Center" Width="80px" />
                                                                                </asp:TemplateField>
 </Columns>
                                                                            <HeaderStyle HorizontalAlign="Justify" VerticalAlign="Top"
                                                                                Font-Bold="true" />
                                                                            <RowStyle Font-Size="Small" Height="1" ForeColor="#000000" Font-Italic="true" />
                                                                        </asp:GridView> 
```

# c++ - C++ 传递 QDomDocument 指针递归

> ID：14633738
> 
> 赞同：0
> 
> 时间：2013-01-31T19:36:04.357
> 
> 标签：c++, qt, pointers, recursion

我在递归传递 QDomDocument 指针时遇到了一点问题。

也许你可以告诉我我忽略了什么。

```
QString Node::asXML()
{
QDomDocument *doc = new QDomDocument();

QDomElement ele = doc->createElement(typeInfo());
doc->appendChild(ele);

foreach (Node *child, children)
{
    qDebug() << "Node: " << child->name;
    child->recurseXML(doc, ele);    
}

return doc->toString();
}

void Node::recurseXML(QDomDocument *doc, QDomElement parent)
{
QDomElement node = doc->createElement(typeInfo());
parent.appendChild(node);

QMapIterator<QString, QVariant> i(attributes);
qDebug() << attributes.size();

while(i.hasNext())
{
    i.next();
    node.setAttribute(i.key(), i.value().toString());
    qDebug() << "KEY: " << i.key() << " | VALUE: " << i.value().toString();
}

} 
```

我丢失了从递归中获得的数据，但我不确定为什么。可能我犯了一个指针错误，但我没有看到。也许有人可以帮助我

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:19:56.347

在 recurseXML 函数中，参数*parent*是一个局部变量。它与您在 asXML 函数中创建的 QDomElement 不同，而是它的副本。*将parent*更改为引用或指针：

```
void Node::recurseXML(QDomDocument *doc, QDomElement parent) 
```

-->

```
void Node::recurseXML(QDomDocument *doc, QDomElement& parent) 
```

# jquery - 根据页面更改css下拉菜单的顶部项目

> ID：14633747
> 
> 赞同：1
> 
> 时间：2013-01-31T19:36:27.833
> 
> 标签：jquery, css, drop-down-menu

我有一个相当简单的所有 css/html 下拉菜单，显示链接到语言版本页面的国家标志。现在它是静态的。我想更改它，以便您所在页面的标志出现在菜单顶部。我似乎无法弄清楚如何实现这一目标。我假设我需要一些 JS 或 jquery？

的CSS：

```
#l_drop{background: #4D8986;height: 24px;width: 52px;border: 1px #62b7b4 solid; float:left; margin: 6px 0 0 7px;}
#l_drop ul{background: #4D8986;list-style: none;margin: 0;padding: 0;}
#l_drop li{float: left;position:relative;}
#l_drop a{display: block;float: left;height: 24px;line-height: 24px;padding: 0;text-decoration: none;}
#l_drop ul ul{display:none;position: absolute;top: 24px;left: -1px;width: auto;margin-top: -1px;border: 1px #62b7b4 solid;border-top: 0;}
#l_drop ul ul li{width:52px;}
#l_drop ul li:hover > ul {display: block;} 
```

的HTML：

```
<div id="l_drop">
<ul>
<li><a href="#"><img src="english.gif" width="52" height="24" alt="English" border="0" /></a>
<ul>
<li><a href="#"><img src="spanish.png" width="24" height="24" alt="Español" border="0" /></a></li>
<li><a href="#"><img src="french.png" width="24" height="24" alt="Français" border="0" /></a></li>
<li><a href="#"><img src="german.png" width="24" height="24" alt="Deutsch" border="0" /></a></li>
<li><a href="#"><img src="korean.png" width="24" height="24" alt="한국의" border="0" /></a></li>
<li><a href="#"><img src="chinese.png" width="24" height="24" alt="中国的" border="0" /></a></li>
<li><a href="#"><img src="japanese.png" width="24" height="24" alt="日本人" border="0" /></a></li>
</ul>
</li>
</ul>
</div> 
```

关于如何使用此代码交换基于页面的顶部图像的任何建议？或者你会建议我从头开始重建吗？任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:10:43.737

理想情况下，这将在服务器端而不是在客户端完成。如果您提供静态文件，您应该考虑更改代码库以反映您对每个单独文件的更改。如果您使用的是模板，我会以这种方式处理页面检测和重新排序。现在话虽如此，如果您想在客户端进行操作，则需要 JS

您可以使用 window.location.href 来检测您所在的页面。从那里，您将获得“l_drop”DIV，然后为该特定页面重新编写 UL。无需实际编码。

您可以有一个表示标志属性集合的 ARRAY 或 JSON。您可以根据需要将正确的项目移动到数组的开头，然后调用一个函数，通过循环遍历数组来重写 UL，并在第一个元素之后创建二级列表，然后替换 l_drop DIV id 中的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:30:27.773

我最终在语言页面中添加了一个小脚本，刚刚换掉了 img SRC 并删除了 USA 标志：

```
$(function () {
    $("img.USA").attr('src', '/german.png');    $(".lang_flagDE").attr('class', 'hideFlag'); }); 
```

每个图像都有一个类，例如 .USA - 此脚本将美国国旗的 SRC 更改为德语，然后隐藏德国国旗的第二个实例。

# php - 如何修复未找到 Class 'Album\Controller\AlbumController' 错误？

> ID：14633750
> 
> 赞同：3
> 
> 时间：2013-01-31T19:36:32.173
> 
> 标签：php, zend-framework2

我是 Zend Framework 2 的新手。我创建了文件夹结构并粘贴了此页面[http://framework.zend.com/manual/2.0/en/user-guide/routing-and-controllers.html](http://framework.zend.com/manual/2.0/en/user-guide/routing-and-controllers.html)中的代码片段Zend Framework 2 中的路由。

我收到以下错误：

```
( ! ) Fatal error: Class 'Album\Controller\AlbumController' not found in C:\wamp\www\zend\vendor\zendframework\zendframework\library\Zend\ServiceManager\AbstractPluginManager.php on line 178 
```

下面是我的classmap_autoload.php

```
<?php 
return array(); 
```

下面是 Module.php

```
namespace Album;

class Module {
    public function getAutoloaderConfig(){
        return array(
            'Zend\Loader\ClassMapAutoloader' => array(
                __DIR__.'/autoload_classmap.php',
            ),
            'Zend\Loader\StandardAutoloader' => array(
                'namespace' => array(
                    __NAMESPACE__ => __DIR__.'/src/'.__NAMESPACE__,
                ),
            ),
        );
    }

    public function getConfig(){
        return include __DIR__.'/config/module.config.php';
    }

} 
```

我的`AlbumController`班级已经在`module/Album/` ![在此处输入图像描述](../Images/2110e1234442be10602b5701b2311343.png)

这是我`module.config.php`的专辑模块：

```
<?php 

return array(
    'controllers' => array(
        'invokables' => array(
            'Album\Controller\Album' => 'Album\Controller\AlbumController',
        ),
    ),

     // The following section is new and should be added to your file
    'router' => array(
        'routes' => array(
            'album' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '/album[/:action][/:id]',
                    'constraints' => array(
                        'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'id'     => '[0-9]+',
                    ),
                    'defaults' => array(
                        'controller' => 'Album\Controller\Album',
                        'action'     => 'index',
                    ),
                ),
            ),
        ),
    ),

    'view_manager' => array(
        'template_path_stack' => array(
            'album' => __DIR__ . '/../view',
        ),
    ),
); 
```

专辑控制器.php

```
<?php

namespace Album\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;

class AlbumController extends AbstractActionController
{
    public function indexAction()
    {
    }

    public function addAction()
    {
    }

    public function editAction()
    {
    }

    public function deleteAction()
    {
    }
} 
```

我不知道为什么会出现这样的错误。我想在渲染页面之前了解 Zend 内部发生了什么，但在我打算解决这个问题之前。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T14:54:28.193

在 Module.php 中`'namespace' => array`必须是`namespaces`（复数形式）

您也可以将您的代码与[https://github.com/zendframework/zf2-tutorial进行比较](https://github.com/zendframework/zf2-tutorial)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T18:53:26.217

我目前正在玩教程和综合学说使用。上述问题可能会出现在“命名空间”中，可能是在调用 composer 进行更新之后，因为 ActionController 的名称似乎神奇地更改为`AbstractActionController`.

没有警告。

**编辑** 我在检查后意识到学说代码已过时，因此通过粘贴替换，控制器名称已过时。

# javascript - Javascript 计数器工作但没有正确隐藏 div

> ID：14633751
> 
> 赞同：0
> 
> 时间：2013-01-31T19:36:33.390
> 
> 标签：javascript

我正在一个网站上工作并使用 javascript 滚动文本。我正在使用计数器及其工作，但是当它通过条件语句时，它并没有隐藏 div 或保持一致。关于为什么会发生这种情况的任何想法？

谢谢！

html:

```
 <div id="arrow2">
        <a id="arrowRight" href="javascript:ltoggle('box');"><img alt="Arrow Right" height="auto" src="images/rightarrow.png"></a>
    </div>

    <div id="content">
        <div class="boxPosition" id="box1">
            <p>This is a destination wedding.  Come early, and stay late!</p>
        </div>

        <div class="boxPosition" id="box2">
            <p>Festivities will start on Friday, August 16th.</p>
        </div>

        <div class="boxPosition" id="box3">
            <p>The wedding will be on Sunday, August 18th late in the day, so you should plan to take Monday off!</p>
        </div>

        <div class="boxPosition" id="box4">
            <p>a</p>
        </div>

        <div class="boxPosition" id="box5">
            <p>b</p>
        </div>

        <div class="boxPosition" id="box6">
            <p>c</p>
        </div>

        <div class="boxPosition" id="box7">
            <p>d</p>
        </div>

        <div class="boxPosition" id="box8">
            <p>e</p>
        </div> 
```

js：

```
 var counter = 1;
    var numBoxes = 8;

    function toggle(divName){
counter++
var ele = document.getElementById(divName + counter);
console.log(divName + counter);

if(ele.style.display == "block"){
    ele.style.display = "none";
}
else{
    ele.style.display = "block";
}
if(counter==numBoxes){
    counter = 0;
}

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:51:34.890

首先，在图片链接“javascript:ltoggle('box');”中找到大门“ltoggle” 未定义。看起来它应该只是“切换”。

建议将标签更改为：

```
 <a id="arrowRight" href="" onClick="toggle('box');return false;"> 
```

其次，JavaScript 不容易识别由 HTML 本身设置的样式。所以这条线在第一次通过时总是错误的。这是您的“不一致”问题：

```
 if(ele.style.display == "block") 
```

为了解决这个问题，我相信有一个调用 js 可以用来查找已经设置的 css 样式，否则，用 js 设置它。查看此帖子： [使用 JavaScript 获取 CSS 值](https://stackoverflow.com/questions/6338217/get-a-css-value-with-javascript)。

回答这两个，这件事可能会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:44:20.227

我立即看到两件事：您在后面缺少一个分号，`counter++`并且您正在引用`javascript:ltoggle('box')`而不是`javascript:toggle('box')`在您的锚点 href 中。

改变那些可以解决它吗？如果不是，您是否介意设置一个 JSFiddle 来复制问题，以便我们仔细查看？

# c# - 格式化和替换并在 ArrayList 中获取格式化的 ArrayList

> ID：14633752
> 
> 赞同：-2
> 
> 时间：2013-01-31T19:36:35.317
> 
> 标签：c#, asp.net, arraylist, html-parsing

由于我无法格式化 TD 和 TR 的 HTML 格式（因为 StackOverflow.com 有一个自动 HTML 格式化程序，这会导致编写确切代码的问题，例如 TD 和 TR），所以请考虑建议文本的以下格式:-

```
<tr>
   <td>FO Special Added (Comments, Part #, RFQ #) - 13, 13, 13</td>
</tr>
<tr>
   <td>FO Special Added (Comments, Part #, RFQ #) - 14, 14, 14</td>
</tr> 
```

我有一个从 Session 变量填充的 ArrayList：-
ArrayList ar3 = (ArrayList)Session["arr3"];

```
Session["arr3"] = "<tr> <td>FO Special Added (Comments, Part #, RFQ #) - 13, 13, 13</td> </tr><tr> <td>FO Special Added (Comments, Part #, RFQ #) - 14, 14, 14</td> </tr><tr> <td>FO Special Added (Comments, Part #, RFQ #) - 15, 15, 15</td> </tr> <td>FO Special Added (Comments, Part #, RFQ #) - 16, 16, 16</td> </tr> 
```

我要做的就是以这样一种方式格式化这个 ArrayList(ar3)，以便我可以在另一个 ArrayList（例如 ResultArList）中拥有从开始 TR 和 TD 到结束 TR 和 TD 的各个记录。
然后，此 ResultArList 将用于电子邮件中继和一些纯文本日志（在 DB 中创建的自定义表）。

ResultArList 应具有以下记录：-
ResultArList[0]=FO Special added (Comments, Part #, RFQ #) - 13, 13, 13
ResultArList[1]=FO Special added (Comments, Part #, RFQ #) - 14, 14, 14
ResultArList[2]=FO 特别添加（评论，部件号，RFQ #） - 15, 15, 15
ResultArList[3]=FO 特别添加（评论，部件号，RFQ #） - 16, 16, 16

ArrayList ar3 中这些值的数量是无限的，但上述 HTML 的格式是不变的。

请帮助我如何自定义格式化我的 ArrayList 并创建一个新的格式化 ArrayList。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:27:59.513

如果我正确理解您的问题，您可以使用正则表达式来提取标签之间的任何内容；例如：

```
var regex = new System.Text.RegularExpressions.Regex(@"(?<=<td>).+?(?=</td>)", RegexOptions.Compiled | RegexOptions.IgnoreCase);
var text = "<tr> <td>FO Special Added (Comments, Part #, RFQ #) - 13, 13, 13</td> </tr><tr> <td>FO Special Added (Comments, Part #, RFQ #) - 14, 14, 14</td> </tr><tr> <td>FO Special Added (Comments, Part #, RFQ #) - 15, 15, 15</td> </tr> <td>FO Special Added (Comments, Part #, RFQ #) - 16, 16, 16</td> </tr>";
var matches = regex.Matches(text);

var results = matches.Cast<Match>()
    .Select(match => match.Value)
    .ToList(); 
```

# tfs - 项目中的多个构建模板（xaml 文件）的问题

> ID：14633759
> 
> 赞同：7
> 
> 时间：2013-01-31T19:37:02.530
> 
> 标签：tfs, build-process

我的 TFS Build 项目有问题。就在 VS 中设置项目而言，我正在按照[这里的示例进行操作。](http://www.ewaldhofman.nl/post/2010/04/29/Customize-Team-Build-2010-e28093-Part-4-Create-your-own-activity.aspx)

我有一个仅用于自定义活动的项目和一个仅用于模板的单独项目。我遇到的问题是模板项目只能包含一个 xaml 文件。如果我将其复制并粘贴到同一个项目中，它将无法构建。我收到以下错误：

错误 102 在“Resources”参数中多次指定了“obj\Debug\TfsBuild_Process_BeforeInitializeComponentHelper.txt”项。“资源”参数不支持重复项。

但如果我删除它，它会构建得很好。一切正常，这意味着如果我排队构建它就会构建。

我也尝试过[这里](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/df3bee5f-8081-4425-aca7-70bfbc15fb30)建议的解决方案，但似乎无法解决我的问题。

> 解决方案：
> 
> 在解决方案资源管理器中重命名表单名称。
> 
> 更改 .cs 和 Designer.cs 文件中的类名。
> 
> 更改构造函数和析构函数名称（与类名相同）
> 
> 更改名称空间名称（如果需要）。

[**这**](http://dl.dropbox.com/u/31708469/Templates.zip)是下载项目的链接。

我似乎无法弄清楚为什么。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-08T10:10:11.730

我不知道你是否还有这个问题，但我今天也有这个问题。我找到了一个解决方案（如果您仍然面临问题）可以帮助您或其他人。

当您复制构建过程模板时，它会自动将 x:Class 属性设置为**TfsBuild.Process**。当您有多个具有相同值的流程模板时，您将在构建项目时收到此错误。

```
<Activity mc:Ignorable="sads sap sap2010" x:Class="TfsBuild.Process" this:Process.BuildNumberFormat="$(BuildDefinitionName)_$(Date:yyyyMMdd)$(Rev:.r)" this:Process.AgentSettings="[New Microsoft.TeamFoundation.Build.Workflow.Activities.AgentSettings() With {.MaxWaitTime = New System.TimeSpan(4, 0, 0), .MaxExecutionTime = New System.TimeSpan(0, 0, 0), .TagComparison = Microsoft.TeamFoundation.Build.Workflow.Activities.TagComparison.MatchExactly}]" this:Process.Verbosity="[Microsoft.TeamFoundation.Build.Workflow.BuildVerbosity.Normal]" this:Process.OutputFullHistory="True" this:Process.OutputBranchOrigin="True" this:Process.OnlyOutputChangedFiles="True" this:Process.StartChangeset="0"...... 
```

我通过将**TfsBuild.Process**替换为每个模板的另一个名称（例如**TfsBuild.ProcessLabDefault**）解决了这个问题。**请注意，您还应该更改this:Process**的所有实例，因为这两者是链接在一起的（例如**this:ProcessLabDefault**）。

```
<Activity mc:Ignorable="sads sap sap2010" x:Class="TfsBuild.MyProcess" this:MyProcess.BuildNumberFormat="$(BuildDefinitionName)_$(Date:yyyyMMdd)$(Rev:.r)" this:MyProcess.AgentSettings="[New Microsoft.TeamFoundation.Build.Workflow.Activities.AgentSettings() With {.MaxWaitTime = New System.TimeSpan(4, 0, 0), .MaxExecutionTime = New System.TimeSpan(0, 0, 0), .TagComparison = Microsoft.TeamFoundation.Build.Workflow.Activities.TagComparison.MatchExactly}]" this:MyProcess.Verbosity="[Microsoft.TeamFoundation.Build.Workflow.BuildVerbosity.Normal]" this:MyProcess.OutputFullHistory="True" this:MyProcess.OutputBranchOrigin="True" this:MyProcess.OnlyOutputChangedFiles="True" this:MyProcess.StartChangeset="0"...... 
```

我没有找到通过使用界面、查看代码和查找和替换作品来改变这一点的方法。希望能帮助到你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-18T21:40:16.873

我使用了以下方法，效果很好。需要替换的只是原始 xaml 第一行两个位置的 TfsBuild。

[http://social.msdn.microsoft.com/Forums/vstudio/en-US/d3fb6b89-b711-4a02-a10a-a88a0cb4f714/unable-to-add-more-than-one-templatexaml-into-activity-library-工作流项目？论坛=tfsprocess](http://social.msdn.microsoft.com/Forums/vstudio/en-US/d3fb6b89-b711-4a02-a10a-a88a0cb4f714/unable-to-add-more-than-one-templatexaml-into-activity-library-workflow-project?forum=tfsprocess)

从链接：

1 在源代码管理中右键单击您的 DefaultTemplate.xaml 副本并选择查看方式...以在记事本中打开它（您也可以在 VS 中右键单击模板并选择“查看代码”）。

2 然后在第一行更改：

1.  `**x:Class="TfsBuild.Process"**` 至 `**x:Class="YourProcessTemplateName.Process"**`
2.  `**xmlns:this="clr-namespace:TfsBuild"**` 至 `**xmlns:this="clr-namespace:YourProcessTemplateName"**`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T15:31:35.143

我遇到了这个问题，想添加我找到的解决方案。如果您检查 XAML 文件的属性，当您将它们链接到您的项目时，它们会被分配 XamlAppDef 的 BuildAction。将此更改为“内容”将解决该错误。

要查找需要编辑的属性屏幕，只需在解决方案资源管理器中突出显示 XAML 文件，然后按 F4 或右键单击该文件，然后从上下文菜单中选择“属性”。

希望这可以帮助。

# macos - 来自 CA_DEBUG_TRANSACTIONS 的更长回溯

> ID：14633763
> 
> 赞同：3
> 
> 时间：2013-01-31T19:37:07.103
> 
> 标签：macos, debugging, core-animation, backtrace

我正在追踪一个问题，CoreAnimation 发现我正在删除一个带有未提交 CATransaction 的线程。这可能是一个带有完成块的视图动画组。正如 NSLog 消息所建议的那样，我已经设置了 CA_DEBUG_TRANSACTIONS 并且在发生这种情况时确实收到了错误消息和回溯。

> CoreAnimation：警告，删除了未提交 CATransaction 的线程

不幸的是，回溯可以追溯到 15 个级别，而这些级别都不是特别有用。而且几乎所有这些调用似乎都是非常常见的调用——比如`CALayer needsDisplayInRect:`——所以设置断点并不会立即提示自己。

有没有一种方便的方法告诉系统，“活下去！给我一个更深的回溯！” ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-14T04:14:49.313

从 iOS 10.0/macOS Sierra 开始，该限制已增加到 512 个堆栈帧。

# android - Android UI 设计工具

> ID：14633767
> 
> 赞同：2
> 
> 时间：2013-01-31T19:37:25.450
> 
> 标签：android

是否有任何程序可以用来设计我的 Android 用户界面？我需要为演示做一个设计，我需要像 Paint 这样的拖放 Android 视图和小部件。

PS 不提供 Eclipse 布局设计视图，这不是我想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T20:03:13.277

Cacoo 支持为 Android 和 iOS 做模型。我在 30 多岁时在下面制作的图像。它具有免费模式，但在保存和导出方面存在一些限制，您始终可以只截屏并保存它们。

![设计模型](../Images/1c6d739ea9adf5d128963d28d1213cd0.png)

[https://cacoo.com/](https://cacoo.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T19:44:50.513

你可以试试这个： [http ://www.droiddraw.org/](http://www.droiddraw.org/)

只需双击添加小部件，然后拖放即可替换。

请注意，它`AbsoluteLayout`默认使用已弃用。

# java - 停止 Tomcat 应用程序中的线程 - 哪种方法？

> ID：14633772
> 
> 赞同：2
> 
> 时间：2013-01-31T19:37:35.927
> 
> 标签：java, multithreading, apache, tomcat

我正在使用以下实现来停止 Tomcat 中的线程。该代码有效，但我想知道两件事：

1.  MyConsumer.java的try语句中是否需要有Thread.sleep()？
2.  而不是检查我的布尔标志，`running`我应该删除标志的概念并只检查`while(!Thread.currentThread().isInterrupted)`吗？

**ServletContextListener：**

```
public final class ApplicationListener implements ServletContextListener {

    private Thread thread = null;
    private MyConsumer k = null;

    public ApplicationListener() {
    }

    @Override
    public void contextInitialized(ServletContextEvent event) {

        k = new MyConsumer();
        thread = new Thread(k);

        thread.start();

    }

    @Override
    public void contextDestroyed(ServletContextEvent event) {
        if (thread != null) {
            k.terminate();
            try {
                thread.join();
            } catch (InterruptedException ex) {
                Logger.getLogger(ApplicationListener.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }
} 
```

**MyConsumer.java：**

```
public class MyConsumer implements Runnable {

    private volatile boolean running = true;

    public MyConsumer() {
    }

    public void terminate() {
        running = false;
    }

    @Override
    public void run() {

            while (running) {

                try {

                    doStuff();
                    Thread.sleep((long) 1000);

                } catch (InterruptedException ex) {
                    Logger.getLogger(MyConsumer.class.getName()).log(Level.SEVERE, null, ex);
                    running = false;
                }
            }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:53:31.043

> MyConsumer.java的try语句中是否需要有Thread.sleep()

不，我认为 sleep 调用是为了确保`doStuff()`在每次调用之间以 1 秒的间隔执行，而不是连续执行。如果你想要这个 1 秒的间隔，你需要把睡眠电话留在那里。如果要`doStuff()`连续执行，则需要解除休眠。

> 我应该删除标志的概念并只检查while（！Thread.currentThread（）.isInterrupted），而不是检查我的布尔标志，运行吗？

是的，我确实会这样做。它将消除对标志的需要，并允许尽快停止线程，而不必等待睡眠调用在 1 秒后返回。另一个优点是您可以检查线程是否在`doStuff()`方法内部被中断，以防它是您想要尽快停止的长时间运行的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:16:08.150

您的线程没有理由只是为了检查中断而休眠。您可以在那里调用 Thread.interupted() 。

关于布尔`running`标志，它提供了与中断类似的功能，只是它不是由抛出 InterruptedException 的方法触发。根据在这些方法中停止正常操作流程是否有意义，您应该使用一种或另一种机制，但不能同时使用两者。

请参阅[http://docs.oracle.com/javase/tutorial/essential/concurrency/interrupt.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/interrupt.html)了解如何使用中断的一个很好的概述。

# modx - ModX 无法查看新上下文

> ID：14633792
> 
> 赞同：1
> 
> 时间：2013-01-31T19:38:56.483
> 
> 标签：modx, modx-revolution

我是modx的菜鸟。今天，我在本地主机 modx 安装上使用 MyComponent 准备了一个传输包，并将其传输到同一服务器上虚拟主机的包文件夹。现在我的 vh 管理器中有两个上下文，原始的“web”上下文和一个名为“foo”的新上下文。如何删除或禁用 web 并使 foo 成为主要上下文，以便我可以在我的虚拟主机上查看它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:53:48.380

没关系，想通了。我只需要编辑根文件夹中的 index.php 文件来初始化正确的上下文：

```
 $modx->initialize('foo'); 
```

快速修复但不明显。

# xml - XSLT 输出谷歌图表

> ID：14633794
> 
> 赞同：0
> 
> 时间：2013-01-31T19:39:10.220
> 
> 标签：xml, xslt, charts, google-visualization

我已经学会了如何使用 XSLT 输出图像、链接和文本。

但是，当我尝试输出 Google 图表时，出现错误。

我搜索了几个小时的答案。我想输出这个图表，例如：

[http://chart.apis.google.com/chart?cht=p3&chs=450x200&chd=t:2,4,3,1&chl=电话|计算机|服务|其他&chtt=Company%20Sales&chco=ff0000](http://chart.apis.google.com/chart?cht=p3&chs=450x200&chd=t:2,4,3,1&chl=Phones|Computers|Services|Other&chtt=Company%20Sales&chco=ff0000)

![在此处输入图像描述](../Images/61911ea67dbab3bf7d1dfd1e0f676263.png)

（我什至不能将它作为链接输出。）另外，如何使用 XML 数据创建图表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:10:20.363

[查看此地址](https://github.com/hpcc-systems/ecl-samples/pull/1/files)列出的文件- 它们可能会帮助您解决这个特殊的困境。有几个文件，每种类型的图表都有一个文件，因此请选择适合您的文件。

希望它有效！

# sql - 与 JPA 的朋友关系

> ID：14633798
> 
> 赞同：3
> 
> 时间：2013-01-31T19:39:20.370
> 
> 标签：sql, hibernate, jpa

我很难创建关系的最佳 JPA 表示。似乎有很多方法可以做到这一点，我不确定哪个是最优化的。如果没有 JPA，我可能会将结构表示为 PERSON 表和 FRIEND 表。假设 PERSON 表只有一个 ID 和 NAME。FRIEND 表有一个 OWNER_ID、一个 PERSON_ID 和一个可设置的布尔 IS_ACTIVE 字段。OWNER_ID 和 PERSON_ID 都引用 PERSON 表。一个人可以有很多朋友，因此唯一的主键将位于 OWNER_ID 和 PERSON_ID 上。在我的代码中，我希望 PersonEntity 来控制关系。Java 中的操作可能如下所示：

```
person1.getFriends().add( new Friend( person2, isActive ) );
Friend friend = person1.findFriend( person2ID ); 
```

类似的东西。请注意，我希望*JPA*隐式分配朋友关系的 OWNER。在上面的代码中，我没有在 Friend 构造函数中传递它，我只传递了复合键的 PERSON 部分。

这是我对此的第一个猜测：

```
@Entity
public class Person {
   @Id
   @GeneratedValue
   private Long id;

    @OneToMany( mappedBy="key.owner", cascade=CascadeType.ALL, orphanRemoval = true)
    private Set<Friend> friends = new HashSet<>();

    // getter and setter for Friends
    ...
}

@Entity
public class Friend {
   @EmbeddedId
   private Key key = new Key();

   private boolean isActive;

   ...

   @Embeddable
   public static class Key implements Serializable {
      @ManyToOne
      private Person owner;

      @OneToOne
      private Person person;

      ...
   }
} 
```

但是当我使用这段代码时，我得到了堆栈溢出错误。我假设它对 OneToOne 关系感到困惑。

在 JPA 2.0 中建模这种关系的最佳方法是什么？我想最简单的方法是在 Friend 中引入生成的长密钥。但这似乎会使“为约翰找朋友”的查询更加复杂，因为我将介绍第三个映射表，基本上在 SQL 中映射关系两次。另一种方法是使其成为单向 OneToMany 关系，甚至不在 Friend 中明确指定 OWNER。这将为映射引入另一个表并使查询有点复杂。使用 ElementCollection 而不是 OneToMany 似乎很简单，但我的理解是我无法将 Friend 作为一个实体进行管理？

让我知道你们是否需要更多细节或要求。顺便说一句，我尝试将 MapsId 放入 PKEY 的 Owner 部分的 Friend 中，但这给了我运行时错误。

任何帮助表示赞赏。

注意：即使我向 Friend 添加生成的密钥，我也想强制 Friend 实体中 {owner,person} 组合的唯一性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T20:06:14.090

我确实会向 Friend 实体添加一个自动生成的 ID。它会使事情变得更简单（没有包含关联的复合键）。我看不出添加这样一个 ID（以及因此在 Friend 表中添加这样一个附加列）会使任何查询变得更加复杂，或者引入一个新表。它不会。您只需添加一个列，作为朋友表的主键。

一旦你有了它，你需要修复你的映射：

1.  Friend 和 Person 之间的关联不是 OneToOne，而是 ManyToOne，因为几个人可以成为另一个人的朋友。
2.  `mappedBy`应该在另一个实体中保存字段的名称，它代表关联的另一端。在您的情况下，它是“key.owner”。如果您停止使用复合键，它将只是“所有者”。

最后，在双向 OneToMany 关联中，所有者始终是多方（在这种情况下，即朋友）。因此，您必须初始化friend.owner 字段以保持关联。但是，如果您封装朋友列表而不是让它从外部访问，那将很简单。而不是做

```
person1.getFriends().add( new Friend( person2, isActive ) ); 
```

简单地做

```
person1.addFriend( new Friend( person2, isActive ) ); 
```

并确保 addFriend() 方法包含以下指令：

```
friendToAdd.setOwner(this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T16:55:24.127

好吧，所以如果你想要一个解决这个问题的方法，它可以在纯 SQL 中创建那种表——这不是人工代理键​​和应用程序数据作为复合键——你绝对可以做到。但是，使用 JPA 会使这比您希望的要复杂一些。

感谢@JB Niznet 的出色投入，您当然也可以按照他的建议通过引入代理键来做到这一点。下面的解决方案只是消除了这种需求，据我所知没有缺点。

```
@Entity
public class Person {
   @Id
   @GeneratedValue
   private Long id;

   @OneToMany( mappedBy="owner", cascade=CascadeType.ALL, orphanRemoval = true)
   private Set<Friend> friends = new HashSet<>();

   // getter and setter for Friends
   ...
}

@Entity
public class Friend {
   @EmbeddedId
   private Key key = new Key();

   @ManyToOne
   @Maps("ownerId")
   private Person owner;

   @ManyToOne
   @MapsId("personId")
   private Person person;

   private boolean isActive;

   ...

   @Embeddable
   public static class Key implements Serializable {
      private Long ownerId;
      private Long personId;

      ...
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T20:32:12.420

您必须考虑设计：实体将是类并具有表。关系将只有表，因为关系只是连接 2 个实体！（除非关系具有属性，例如在这种情况下为“朋友评级”等。）

While`Person`显然是一个实体，`friend`是一个关系。不仅如此，`friend`还是双向关系。（A 是 B 的朋友 => B 是 A 的朋友）

因此，您只需通过人员列表（称为朋友）扩展您的人员对象：

```
@Entity
public class Person {
   @Id
   @GeneratedValue
  private Long id;

  @OneToMany
  @JoinTable(name="friends")
  @JoinColumn(name="person_A_id", referencedColumnName="id"), @JoinColumn(name="person_B_id", referencedColumnName="id")) 
  private Set<Person> friends = new HashSet<>(); 
```

}

这是 untestet，但应该给你一个像这样的表：

```
person_a_id | person_b_id
1             2
1             6
2             7 
```

那么你可以简单地与你的实体一起工作

```
Person A = new Person();
Person B = new Person();
A.friends.add(B); 
```

但是，请记住，JPA 将无法实现双向线程：因此，如果您将 B 添加到 A 的朋友中，您将不会在 B 的朋友列表中找到 A。您必须注意这一点！

# ios - 隐藏以编程方式添加的贝宝按钮

> ID：14633799
> 
> 赞同：0
> 
> 时间：2013-01-31T19:39:21.103
> 
> 标签：ios, paypal, uibutton, uilabel

我使用以下方法在我的代码中添加了一个贝宝按钮：

```
[self addLabelWithText:@"" andButtonWithType:BUTTON_294x43 withAction:@selector(simplePayment)]; 
```

我有一个视图会在某一时刻弹出。此按钮位于视图顶部。我希望它在后面或隐藏。我将如何隐藏或删除此按钮并在视图完成后将其添加回来？我只是不确定如何引用这个。我知道有一些方法可以标记它等等......谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:03:28.107

好的，我明白了...我创建了一个 uibutton 并将其分配给方法中的 paypal 按钮。

```
- (void)addLabelWithText:(NSString *)text andButtonWithType:(PayPalButtonType)type withAction:(SEL)action 
```

然后我根据需要隐藏按钮。

# jquery - jHTMLArea iframe 在使用 jQuery Sortable 删除时被禁用

> ID：14633801
> 
> 赞同：0
> 
> 时间：2013-01-31T19:39:28.587
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jhtmlarea

我将 jQuery Sortable 与 jHTMLArea 一起使用。我基本上有可排序的 DIV，并且 DIV 是可排序的。但是，当您将 DIV 放在任何位置时，jHTMLArea 的内容将变为空并且 jHTMLArea 将变为禁用状态。iFrame 和 textarea 都被禁用。你不能在里面写任何东西。

我不确定是什么问题，所以我想知道这是否与库本身有关。

我正在使用的代码是这样的：

```
// Enable Sortables
$("div.nnUtil").sortable({
    cancel: ".nnSettings",
    connectWith: 'div.nnUtil',
    distance: 5,
    forcePlaceholderSize: true,
    items: '> div.nnItems',
    placeholder: 'ui-state-highlight',
    revert: 250
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T04:16:45.703

我找到了解决方案。

基本上，当您对列表进行排序时，div 的内容会被隐藏。这会阻止 htmlarea 内容。jHTMLArea 论坛中记录了许多关于此的问题。

我所做的是当你删除我重新呈现 HTMLArea 的 div 时。

这是工作[演示](http://jsfiddle.net/h2KAa/1/)。

```
$('textarea').htmlarea();

var fixHelperModified = function (e, tr) {
    var $originals = tr.children();
    var $helper = tr.clone(true, true);
    $helper.children().each(function (index) {
        $(this).width($originals.eq(index).width())
    });
    return $helper;
},
updateIndex = function (e, ui) {
    $('td.index', ui.item.parent()).each(function (i) {
        $(this).html(i + 1);
    });
    ui.item.find('textarea').htmlarea('dispose');
    ui.item.find('textarea').htmlarea();
};

$("#sort TBODY").sortable({
    helper: fixHelperModified,
    stop: updateIndex
}).disableSelection(); 
```

示例问题

[http://jhtmlarea.codeplex.com/workitem/16028](http://jhtmlarea.codeplex.com/workitem/16028)

[http://jhtmlarea.codeplex.com/workitem/10907](http://jhtmlarea.codeplex.com/workitem/10907)

# macos - 在虚拟机中访问 SQL Server 实例

> ID：14633803
> 
> 赞同：4
> 
> 时间：2013-01-31T19:39:34.230
> 
> 标签：macos, sql-server-2008, windows-7, pymssql, vmware-fusion

首先，我的设置：

*   Mac OSX 10.8
*   在 VM 中运行的 Windows 7 (VMWare Fusion)
*   在 VM 中运行的 SQL Server 2008 R2
*   大量 Python 脚本 + 我在 Mac 端高度定制的 Python 安装。

我希望能够在我的笔记本电脑上针对我们的开发数据库的快照在本地运行脚本，该数据库愉快地存在于我的 VM 中。我也不想让 PITA 在 Windows VM 中重建我的 Python 安装。

那么问题来了：如何从 Mac 端访问在我的 VM 中运行的 SQL Server 实例？为了访问生产数据，我使用了基于 FreeTDS 的 pymssql。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-13T16:47:00.423

我正在使用此配置运行，如下所示：

*   为 VM 创建一个额外的网络适配器并将其设置为“我的 Mac 专用”。Windows 将使用在 VM 设置期间创建的默认网络适配器连接到 Mac 所连接的网络（Internet 等），而您创建的这个新网络适配器将用于 Mac 和 VM 主机之间的通信.
*   可以使用 ifconfig 识别虚拟网络上的 Mac IP。在我的例子中，它被命名为 vmnet1，IP 为 192.168.23.1
*   默认情况下，Windows VM IP 将被动态分配。您应该进入 Windows 中的网络设置并设置一个与 Mac IP 在同一网络上的静态 IP。在我的例子中，Fusion 创建的 Windows 网络适配器被命名为 Ethernet1。我将其设置为 192.168.23.100/255.255.255.0。不要设置网关地址，因为您不希望沿此路径路由
*   在 Mac /etc/hosts 文件中为 Windows IP 创建一个条目，例如“192.168.23.100 mywinsys.local”
*   在 Windows /windows/system32/drivers/etc/hosts 文件中为 mac IP 创建一个条目，例如“192.168.23.1 mymacsys.local”
*   请务必关闭 Windows 防火墙或以其他方式打开必要的端口
*   确保 SQL Server 配置为接受 IP 连接 [https://technet.microsoft.com/en-us/library/hh231672(v=sql.110).aspx](https://technet.microsoft.com/en-us/library/hh231672(v=sql.110).aspx)

在 mac 上运行的进程可以使用 mywinsys.local 连接到 Windows 进程。在 Windows 上运行的进程可以使用 mymacsys.local 连接到 Mac 进程

# php - Laravel 框架 - 工作台

> ID：14633804
> 
> 赞同：0
> 
> 时间：2013-01-31T19:39:35.200
> 
> 标签：php, laravel, laravel-4

laravel 框架中的工作台是什么？（我使用的是版本 4 - 测试版）

工作台是如何使用的，它有什么作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:50:14.550

它是一个创建php包的工具；具有特殊功能来帮助创建可以在 Laravel 4 项目中轻松使用的包。

# java - 如何让选项菜单在 Nexus 7 上工作？

> ID：14633805
> 
> 赞同：1
> 
> 时间：2013-01-31T19:39:41.497
> 
> 标签：java, android, eclipse, menu

我正在主活动中使用选项菜单编写应用程序。此选项菜单在我的 HTC Android Incredible 设备上运行良好。但是，当我使用 Nexus 7 模拟器对其进行测试时，程序崩溃了。如何让选项菜单在 Nexus 7 上运行？对此有什么想法吗？先感谢您。这是我正在使用的代码。

```
package com.carouseldemo.main;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.Menu;

import android.view.MenuInflater;
import android.view.View;
import android.widget.TextView;
import android.widget.Toast;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselAdapter.AdapterContextMenuInfo;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;
import com.carouseldemo.controls.CarouselItem;

public class MainActivity extends Activity {

@Override
public boolean onPrepareOptionsMenu(Menu menu) {
super.onPrepareOptionsMenu(menu);
MenuInflater inflater = getMenuInflater();
inflater.inflate(R.menu.testmenu1, menu);
// your code...
return true;} // true if you want the menu to be displayed; false otherwise
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {
    // Just prepare ourself for unexpected arguments...

    if (menuInfo == null) {
        return;
    }
    if (!(menuInfo instanceof AdapterContextMenuInfo)) {
        return;
    }

    AdapterContextMenuInfo mi = (AdapterContextMenuInfo) menuInfo;

    switch (mi.position) {
    case 0:

        menu.add("Product 1");

        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    case 1:
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    case 2:
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    case 3:
        menu.add("mouse menu");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    case 4:
        menu.add("panda menu");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    case 5:
        menu.add("rabbit menu");
        menu.add("Product 1");
        menu.add("Product 1");
        menu.add("Product 1");
        break;
    default:
        break;
    }
    super.onCreateContextMenu(menu, v, menuInfo);
}

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final Carousel carousel = (Carousel) findViewById(R.id.carousel);
    carousel.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {
            CarouselItem item = (CarouselItem) parent.getChildAt(position);

            // HERE: Force context menu
            carousel.showContextMenuForChild(item);
            Toast.makeText(
                    MainActivity.this,
                    String.format("%s has been clicked",
                            ((CarouselItem) parent.getChildAt(position))
                                    .getName()), Toast.LENGTH_SHORT).show();

        }

        @Override
        public void onCreateContextMenu(ContextMenu menu, View v,
                ContextMenuInfo menuInfo) {

            // TODO Auto-generated method stub

        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // TODO Auto-generated method stub
            return false;
        }});

    carousel.setOnItemSelectedListener(new OnItemSelectedListener() {

        public void onItemSelected(CarouselAdapter<?> parent, View view,
                int position, long id) {

            final TextView txt = (TextView) (findViewById(R.id.selected_item));

            switch (position) {
            case 0:
                txt.setText("The cat (Felis catus), also known as the domestic cat or housecat to distinguish it from other felids and felines, is a small, usually furry, domesticated, carnivorous mammal that is valued by humans for its companionship and for its ability to hunt vermin and household pests. Cats have been associated with humans for at least 9,500 years, and are currently the most popular pet in the world. Owing to their close association with humans, cats are now found almost everywhere in the world.");
                break;
            case 1:
                txt.setText("The hippopotamus (Hippopotamus amphibius), or hippo, from the ancient Greek for \"river horse\" (), is a large, mostly herbivorous mammal in sub-Saharan Africa, and one of only two extant species in the family Hippopotamidae (the other is the Pygmy Hippopotamus.) After the elephant, the hippopotamus is the third largest land mammal and the heaviest extant artiodactyl.");
                break;
            case 2:
                txt.setText("A monkey is a primate, either an Old World monkey or a New World monkey. There are about 260 known living species of monkey. Many are arboreal, although there are species that live primarily on the ground, such as baboons. Monkeys are generally considered to be intelligent. Unlike apes, monkeys usually have tails. Tailless monkeys may be called \"apes\", incorrectly according to modern usage; thus the tailless Barbary macaque is called the \"Barbary ape\".");
                break;
            case 3:
                txt.setText("A mouse (plural: mice) is a small mammal belonging to the order of rodents. The best known mouse species is the common house mouse (Mus musculus). It is also a popular pet. In some places, certain kinds of field mice are also common. This rodent is eaten by large birds such as hawks and eagles. They are known to invade homes for food and occasionally shelter.");
                break;
            case 4:
                txt.setText("The giant panda, or panda (Ailuropoda melanoleuca, literally meaning \"black and white cat-foot\") is a bear native to central-western and south western China.[4] It is easily recognized by its large, distinctive black patches around the eyes, over the ears, and across its round body. Though it belongs to the order Carnivora, the panda's diet is 99% bamboo.");
                break;
            case 5:
                txt.setText("Rabbits (or, colloquially, bunnies) are small mammals in the family Leporidae of the order Lagomorpha, found in several parts of the world. There are eight different genera in the family classified as rabbits, including the European rabbit (Oryctolagus cuniculus), cottontail rabbits (genus Sylvilagus; 13 species), and the Amami rabbit (Pentalagus furnessi, an endangered species on Amami, Japan)");
                break;
            }

        }

        public void onNothingSelected(CarouselAdapter<?> parent) {
        }

    });

    registerForContextMenu(carousel);
}

} 
```

LogCat 错误：

```
01-31 19:55:42.221: E/AndroidRuntime(1758): FATAL EXCEPTION: main
01-31 19:55:42.221: E/AndroidRuntime(1758): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.carouseldemo.main/com.carouseldemo.main.MainActivity}: android.view.InflateException: Binary XML file line #34: Error inflating class com.carouseldemo.controls.Carousel
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.os.Looper.loop(Looper.java:137)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at java.lang.reflect.Method.invokeNative(Native Method)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at     java.lang.reflect.Method.invoke(Method.java:511)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at dalvik.system.NativeStart.main(Native Method)
01-31 19:55:42.221: E/AndroidRuntime(1758): Caused by: android.view.InflateException: Binary XML file line #34: Error inflating class com.carouseldemo.controls.Carousel
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.createView(LayoutInflater.java:613)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:687)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.Activity.setContentView(Activity.java:1881)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at   com.carouseldemo.main.MainActivity.onCreate(MainActivity.java:108)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.Activity.performCreate(Activity.java:5104)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-31 19:55:42.221: E/AndroidRuntime(1758):     ... 11 more
01-31 19:55:42.221: E/AndroidRuntime(1758): Caused by: java.lang.reflect.InvocationTargetException
01-31 19:55:42.221: E/AndroidRuntime(1758):     at java.lang.reflect.Constructor.constructNative(Native Method)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.view.LayoutInflater.createView(LayoutInflater.java:587)
01-31 19:55:42.221: E/AndroidRuntime(1758):     ... 22 more
01-31 19:55:42.221: E/AndroidRuntime(1758): Caused by: java.lang.OutOfMemoryError
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:502)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:355)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:785)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.content.res.Resources.loadDrawable(Resources.java:1965)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.carouseldemo.controls.Carousel$ImageAdapter.SetImages(Carousel.java:778)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.carouseldemo.controls.Carousel.<init>  (Carousel.java:253)
01-31 19:55:42.221: E/AndroidRuntime(1758):     at com.carouseldemo.controls.Carousel.<init>     (Carousel.java:204)
01-31 19:55:42.221: E/AndroidRuntime(1758):     ... 25 more 
```

# ajax - 如何确保ajax在绑定之前填充淘汰赛可观察数组

> ID：14633806
> 
> 赞同：0
> 
> 时间：2013-01-31T19:39:42.753
> 
> 标签：ajax, mvvm, knockout.js

我正在使用 jqwidgets 网格和他们网站上的示例来使用 ko observableArray 进行绑定。但是我认为网格不显示数据的原因是因为它试图在 ajax 请求完成之前进行绑定。这是我的代码的[小提琴](http://jsfiddle.net/delebash/KUhRG/6/)。还有关于如何使用 firebug 调试 ajax 的任何资源，我知道如何调试 js 代码，但是在使用 ajax 时，如果我放了一个调试器；在里面

```
.done(function (data) {
debugger;
                    var jsonData = $.parseJSON(data);
                    me.items(jsonData);
                }); 
```

如果我有其他调试器，它不会触发；该函数之外的语句，我不明白为什么。我想我并不完全理解 javascript 代码中异步请求的流程。再次感谢

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:45:53.303

这里有这样的示例：[gridwithjson.htm](http://www.jqwidgets.com/jquery-widgets-demo/demos/jqxknockout/gridwithjson.htm?classic)

# c++ - 观察者模式 - 进一步考虑和通用 C++ 实现

> ID：14633808
> 
> 赞同：13
> 
> 时间：2013-01-31T19:40:03.180
> 
> 标签：c++, oop, design-patterns, observer-pattern

我正在编写的 C++ MVC 框架大量使用了观察者模式。我已经彻底阅读了设计模式（GoF，1995）中的相关章节，并查看了文章和现有库（包括 Boost）中的大量实现。

但是当我在实现该模式时，我不禁觉得必须有更好的方法——我的客户端代码包含我认为应该重构为模式本身的行和片段，只要我能找到一种方法来克服一些 C++ 限制。此外，我的语法从未像 ExtJs 库中使用的那样优雅：

```
// Subscribing
myGridPanel.on( 'render', this.onRender );

// Firing
this.fireEvent( 'render', null, node ); 
```

所以我决定进行进一步的研究，试图实现一个通用的实现，同时优先考虑代码的优雅、可读性和性能。我相信我在第 5 次尝试中中了大奖。

[实际实现](https://github.com/Izhaki/gxObserver)，称为，`gxObserver`可在 GitHub 上找到；它的文档很好，自述文件说明了优点和缺点。它的语法是：

```
// Subscribing
mSubject->gxSubscribe( evAge, OnAgeChanged );

// Firing
Fire( evAge, 69 ); 
```

完成了一项过度工作后，我觉得这只是与 SO 社区分享我的发现。那么下面我来回答这个问题：

> 程序员在实现观察者模式时应该考虑哪些额外的考虑因素（在设计模式中提出的这些考虑因素）？

虽然专注于 C++，但下面的许多内容都适用于任何语言。

**请注意：**由于 SO 将答案限制为 30000 字，因此我的答案必须分两部分提供，但有时会首先出现第二个答案（以“主题”开头的答案）。答案的第 1 部分是从设计模式中的类图开始的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-31T19:42:33.957

![在此处输入图像描述](../Images/3a8828bdd09021447b4c8bbb61d4700a.png)

（第一部分开始）

# 先决条件

## 这不仅仅是关于状态

设计模式将观察者模式与对象“状态”联系起来。如上面的类图所示（来自设计模式），可以使用该`SetState()`方法设置主题的状态；在状态发生变化时，主体将通知其所有观察者；`GetState()`然后观察者可以使用该方法查询新状态。

但是，`GetState()`它不是主题基类中的实际方法。相反，每个具体的主体都提供了自己专门的状态方法。实际代码可能如下所示：

```
SomeObserver::onUpdate( aScrollManager )
{
    // GetScrollPosition() is a specialised GetState();
    aScrollPosition = aScrollManager->GetScrollPosition();
} 
```

什么是对象状态？我们将其定义为*状态变量的集合——需要持久化的成员变量*（以便以后恢复）。例如，两者`BorderWidth`和`FillColour`都可以是 Figure 类的状态变量。

我们可以拥有多个状态变量（因此对象的状态可以以多种方式改变）的想法很重要。这意味着主体可能会触发不止一种类型的状态更改事件。它还解释了为什么`GetState()`在主题基类中拥有一个方法毫无意义。

但是只能处理状态变化的观察者模式是不完整的——观察者观察无状态通知是很常见的，即与状态无关的通知。例如，`KeyPress`或`MouseMove`操作系统事件；或类似的事件`BeforeChildRemove`，这显然并不表示实际的状态变化。这些无状态事件足以证明推送机制的合理性——如果观察者无法从主题中检索更改信息，则所有信息都必须与通知一起提供（稍后将详细介绍）。

## 会有很多活动

很容易看出在“现实生活”中一个主题如何引发多种类型的事件；快速浏览一下 ExtJs 库会发现有些类提供了 30 个以上的事件。因此，一个通用的主体-观察者协议必须集成设计模式所称的“兴趣”——允许观察者订阅特定事件，并且主体只向感兴趣的观察者触发该事件。

```
// A subscription with no interest.
aScrollManager->Subscribe( this );

// A subscription with an interest.
aScrollManager->Subscribe( this, "ScrollPositionChange" ); 
```

## 它可能是多对多的

单个观察者可以从多个对象观察同一事件（使观察者-对象关系多对多）。例如，属性检查器可能会监听许多选定对象的同一属性的变化。如果观察者对哪个主题发送了通知感兴趣，则通知必须包含发送者：

```
SomeSubject::AdjustBounds( aNewBounds )
{
    ...
    // The subject also sends a pointer to itself.
    Fire( "BoundsChanged", this, aNewBounds );
}

// And the observer receives it.
SomeObserver::OnBoundsChanged( aSender, aNewBounds )
{
} 
```

然而值得注意的是，在许多情况下，观察者并不关心发送者的身份。例如，当主题是单例或观察者对事件的处理不依赖于主题时。因此，与其*强迫*发送者成为协议的一部分，我们应该*允许*它成为协议的一部分，而让程序员决定是否拼写发送者。

# 观察员

## 事件处理程序

处理事件的观察者方法（即*事件处理程序*）可以有两种形式：覆盖或任意。在观察者的实现中提供了一个关键而复杂的部分，这两个部分将在本节中讨论。

### 被覆盖的处理程序

重写处理程序是设计模式提供的解决方案。基 Subject 类定义了一个虚`OnEvent()`方法，子类覆盖它：

```
class Observer
{
public:
    virtual void OnEvent( EventType aEventType, Subject* aSubject ) = 0;
};

class ConcreteObserver
{
    virtual void OnEvent( EventType aEventType, Subject* aSubject )
    {
    }
}; 
```

请注意，我们已经考虑了主题通常会触发不止一种类型的事件的想法。但是在方法中处理所有事件（特别是如果有几十个）`OnEvent`是笨拙的 - 如果每个事件都在自己的处理程序中处理，我们可以编写更好的代码；实际上，这使`OnEvent`事件路由器成为其他处理程序：

```
void ConcreteObserver::OnEvent( EventType aEventType, Subject* aSubject )
{
    switch( aEventType )
    {
        case evSizeChanged:
            OnSizeChanged( aSubject );
            break;
        case evPositionChanged:
            OnPositionChanged( aSubject );
            break;
    }
}

void ConcreteObserver::OnSizeChanged( Subject* aSubject )
{
}

void ConcreteObserver::OnPositionChanged( Subject* aSubject )
{
} 
```

具有重写（基类）处理程序的优点是它很容易实现。订阅主题的观察者可以通过提供对自身的引用来做到这一点：

```
void ConcreteObserver::Hook()
{
    aSubject->Subscribe( evSizeChanged, this );
} 
```

然后主题只保留一个`Observer`对象列表，触发代码可能如下所示：

```
void Subject::Fire( aEventType )
{
    for ( /* each observer as aObserver */)
    {
        aObserver->OnEvent( aEventType, this );
    }
} 
```

重写处理程序的缺点是它的签名是固定的，这使得额外参数的传递（在推送模型中）变得棘手。此外，对于每个事件，程序员必须维护两段代码：路由器（`OnEvent`）和实际处理程序（`OnSizeChanged`）。

### 任意处理程序

克服重载处理程序缺陷的第一步`OnEvent`是……不拥有一切！如果我们能告诉主题使用哪种方法来处理每个事件，那就太好了。像这样：

```
void SomeClass::Hook()
{
    // A readable Subscribe( evSizeChanged, OnSizeChanged ) has to be written like this:
    aSubject->Subscribe( evSizeChanged, this, &ConcreteObserver::OnSizeChanged );
}

void SomeClass::OnSizeChanged( Subject* aSubject )
{
} 
```

请注意，有了这个实现，我们不再需要我们的类从`Observer`类继承；事实上，我们根本不需要 Observer 类。这个想法并不是一个新想法，它在[Herb Sutter 2003 年 Dobbs 博士的一篇名为“Generalizing Observer”的文章中进行了详细描述</a>。但是，在 C++ 中实现任意回调并不是一件简单的事情。Herb`function`在他的文章中使用了该工具，但不幸的是，他的提案中的一个关键问题没有完全解决。该问题及其解决方案如下所述。](http://www.drdobbs.com/cpp/generalizing-observer/184403873?pgno=1)

 [由于 C++ 不提供本地委托，我们需要使用成员函数指针 (MFP)。C++ 中的 MFP 是类函数指针而不是对象函数指针，因此我们必须为`Subscribe`方法提供`&ConcreteObserver::OnSizeChanged`（MFP）和`this`（对象实例）。我们将这种组合称为*委托*。

> 成员函数指针 + 对象实例 = 委托](http://www.drdobbs.com/cpp/generalizing-observer/184403873?pgno=1) 

[`Subject`类的实现*可能*依赖于比较委托的能力。例如，如果我们希望向特定委托触发事件，或者当我们想要取消订阅特定委托时。如果处理程序不是虚拟的并且属于订阅类（与在基类中声明的处理程序相反），则委托可能是可比较的。但在大多数其他情况下，编译器或继承树的复杂性（虚拟或多重继承）将使它们无法比拟。](http://www.drdobbs.com/cpp/generalizing-observer/184403873?pgno=1)[Don Clugston 就这个问题写了一篇精彩的深入文章](http://www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible)，其中他还提供了一个 C++ 库来解决这个问题；虽然不符合标准，但该库几乎可以与所有编译器一起使用。

值得一问的是，虚拟事件处理程序是否是我们真正需要的东西；也就是说，我们是否可能有一个观察者子类想要覆盖（或扩展）其（具体观察者）基类的事件处理行为的场景。可悲的是，答案是这很有可能。所以一个通用的观察者实现应该允许虚拟处理程序，我们很快就会看到一个例子。

## 更新协议

设计模式的实施点 7 描述了拉式与推式模型。本节扩展了讨论。

### 拉

使用拉模型，主题发送最少的通知数据，然后观察者需要从主题中检索更多信息。

我们已经确定拉模型不适用于无状态事件，例如`BeforeChildRemove`. 或许还值得一提的是，对于 pull 模型，程序员需要向每个事件处理程序添加代码行，而 push 模型不存在这些代码行：

```
// Pull model
void SomeClass::OnSizeChanged( Subject* aSubject )
{
    // Annoying - I wish I didn't had to write this line.
    Size iSize = aSubject->GetSize();
}

// Push model
void SomeClass::OnSizeChanged( Subject* aSubject, Size aSize )
{
    // Nice! We already have the size.
} 
```

另一件值得记住的事情是，我们可以使用推模型来实现拉模型，但反之则不行。尽管推送模型为观察者提供所需的所有信息，但程序员可能希望不发送特定事件的信息，并让观察者向主题询问更多信息。

### 固定数量推送

使用固定数量的推送模型，通知携带的信息通过商定数量和类型的参数传递给处理程序。这很容易实现，但是由于不同的事件将具有不同数量的参数，因此必须找到一些解决方法。在这种情况下，唯一的解决方法是将事件信息打包到一个结构（或一个类）中，然后将其传递给处理程序：

```
// The event base class
struct evEvent
{
};

// A concrete event
struct evSizeChanged : public evEvent
{
    // A constructor with all parameters specified.
    evSizeChanged( Figure *aSender, Size &aSize )
      : mSender( aSender ), mSize( aSize ) {}

    // A shorter constructor with only sender specified.
    evSizeChanged( Figure *aSender )
      : mSender( aSender )
    {
        mSize = aSender->GetSize();
    }

    Figure *mSender;
    Size    mSize;
};

// The observer's event handler, it uses the event base class.
void SomeObserver::OnSizeChanged( evEvent *aEvent )
{
    // We need to cast the event parameter to our derived event type.
    evSizeChanged *iEvent = static_cast<evSizeChanged*>(aEvent);

    // Now we can get the size.
    Size iSize  = iEvent->mSize;
} 
```

现在虽然主体和观察者之间的协议很简单，但实际的实现却相当冗长。有几个缺点需要考虑：

`evSizeChanged`首先，我们需要为每个事件编写大量代码（参见 参考资料）。很多代码都很糟糕。

其次，其中涉及一些不容易回答的设计问题：我们应该`evSizeChanged`与`Size`类一起声明，还是与触发它的主题一起声明？如果您考虑一下，两者都不是理想的。那么，尺寸更改通知是否总是带有相同的参数，还是取决于主题？（答案：后者是可能的。）

第三，有人需要在触发之前创建事件的实例，然后将其删除。因此，主题代码将如下所示：

```
// Argh! 3 lines of code to fire an event.
evSizeChanged *iEvent = new evSizeChanged( this );
Fire( iEvent );
delete iEvent; 
```

或者我们这样做：

```
// If you are a programmer looking at this line than just relax!
// Although you can't see it, the Fire method will delete this 
// event when it exits, so no memory leak!
// Yes, yes... I know, it's a bad programming practice, but it works.
// Oh.. and I'm not going to put such comment on every call to Fire(),
// I just hope this is the first Fire() you'll look at and just 
// remember.
Fire( new evSizeChanged( this ) ); 
```

第四，正在进行铸造业务。我们已经在处理程序中完成了转换，但也可以在主题的`Fire()`方法中进行。但这要么涉及动态转换（性能成本高昂），要么我们执行静态转换，如果触发的事件与处理程序期望的事件不匹配，则可能导致灾难。

第五，处理程序的可读性很差：

```
// What's in aEvent? A programmer will have to look at the event class 
// itself to work this one out.
void SomeObserver::OnSizeChanged( evSizeChanged *aEvent )
{
} 
```

与此相反：

```
void SomeObserver::OnSizeChanged( ZoomManager* aManager, Size aSize )
{
} 
```

这将我们引向下一部分。

### 多样性推送

就看代码而言，许多程序员希望看到这个主题代码：

```
void Figure::AdjustBounds( Size &aSize )
{
     // Do something here.

     // Now fire
     Fire( evSizeChanged, this, aSize );
}

void Figure::Hide()
{
     // Do something here.

     // Now fire
     Fire( evVisibilityChanged, false );
} 
```

而这个观察者代码：

```
void SomeObserver::OnSizeChanged( Figure* aFigure, Size aSize )
{
}

void SomeObserver::OnVisibilityChanged( aIsVisible )
{
} 
```

主题的`Fire()`方法和观察者处理程序在每个事件中都有不同的数量。该代码是可读的，并且与我们希望的一样短。

此实现涉及非常干净的客户端代码，但会带来相当复杂的`Subject`代码（具有大量功能模板和可能的其他好东西）。这是大多数程序员都会采取的权衡取舍——在一个地方（主题类）拥有复杂的代码，而不是在许多地方（客户端代码）；并且鉴于主题类完美无缺，程序员可能只是将其视为一个黑盒，很少关心它是如何实现的。

值得考虑的是如何以及何时确保`Fire`arity 和 handler arity 匹配。我们可以在运行时进行，如果两者不匹配，我们会提出一个断言。但是，如果我们在编译时遇到错误，那就太好了，为此我们必须明确声明每个事件的 arity，如下所示：

```
class Figure : public Composite, 
               public virtual Subject
{
public:
    // The DeclareEvent macro will store the arity somehow, which will
    // then be used by Subscribe() and Fire() to ensure arity match 
    // during compile time.
    DeclareEvent( evSizeChanged, Figure*, Size )
    DeclareEvent( evVisibilityChanged, bool )
}; 
```

稍后我们将看到这些事件声明如何发挥另一个重要作用。

（第一部分结束）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-31T19:43:04.797

（第二部分开始）

# 科目

## 订阅过程

### 存储的是什么？

根据具体实现，在观察者订阅时，主体可能会存储以下数据：

*   **事件 ID** – 兴趣或观察者订阅的事件。
*   **观察者实例**——最常见的是对象指针的形式。
*   **成员函数指针**——如果使用任意处理程序。

这些数据将形成 subscribe 方法的参数：

```
// Subscription with an overridden handler (where the observer class has a base class handler method).
aSubject->Subscribe( "SizeChanged", this );

// Subscription with an arbitrary handler.
aSubject->Subscribe( "SizeChanged", this, &ThisObserverClass::OnSizeChanged ); 
```

值得注意的是，如果使用任意处理程序，成员函数指针很可能与类或结构中的观察者实例一起打包，形成委托。因此该`Subscribe()`方法可能具有以下签名：

```
// Delegate = object pointer + member function pointer.
void Subject::Subscribe( EventId aEventId, Delegate aDelegate )
{
   //...
} 
```

实际存储（可能在 a 中`std::map`）将涉及事件 id 作为键和委托作为值。

### 实现事件 ID

在触发它们的主题类之外定义事件 ID 可以简化对这些 ID 的访问。但一般来说，主体触发的事件是该主体独有的。因此，在大多数情况下，在主题类中声明事件 ID 是合乎逻辑的。

虽然声明事件 ID 的方法不止几种，但这里只讨论最感兴趣的 3 种：

**从表面上看，枚举**似乎是最合乎逻辑的选择：

```
class FigureSubject : public Subject
{
public:
    enum {
        evSizeChanged,
        evPositionChanged
    };
}; 
```

枚举的比较（将在订阅和触发时发生）很快。也许这种策略唯一的不便是观察者需要在订阅时指定类：

```
// 'FigureSubject::' is the annoying bit.
aSubject->Subscribe( FigureSubject::evSizeChanged, this ); 
```

**字符串**为枚举提供了一个“更宽松”的选项，因为通常主题类不会像枚举一样声明它们；相反，客户将只使用：

```
// Observer code
aFigure->Subscribe( "evSizeChanged", this ); 
```

字符串的好处是大多数编译器对它们进行颜色编码与其他参数不同，这以某种方式提高了代码的可读性：

```
// Within a concrete subject
Fire( "evSizeChanged", mSize, iOldSize ); 
```

但是字符串的问题是我们无法在运行时判断我们是否拼错了事件名称。此外，字符串比较比枚举比较花费更长的时间，因为字符串必须逐个字符进行比较。

**类型**是这里讨论的最后一个选项：

```
class FigureSubject : public Subject
{
public:
    // Declaring the events this subject supports.
    class SizeChangedEventType     : public Event {} SizeChangedEvent;
    class PositionChangedEventType : public Event {} PositionChangedEvent;
}; 
```

使用类型的好处是它们允许重载方法，例如`Subscribe()`（我们很快就会看到它可以解决观察者的常见问题）：

```
// This particular method will be called only if the event type is SizeChangedType
FigureSubject::Subscribe( SizeChangedType aEvent, void *aObserver )
{
    Subject::Subscribe( aEvent, aObserver );

    Fire( aEvent, GetSize(), aObserver );
} 
```

但同样，观察者需要一些额外的代码来订阅：

```
// Observer code
aFigure->Subscribe( aFigure->SizeChangedEvent, this ); 
```

### 在哪里存储观察者？

设计模式中的实现点 1 处理每个主题的观察者应该存储在哪里。本节补充了该讨论，提供了 3 个选项：

*   全局哈希
*   每个主题
*   每个事件

正如设计模式中所建议的，存储主体-观察者映射的一个地方是全局哈希表。该表将包括主题、事件和观察者（或代表）。在所有方法中，这是最节省内存的方法，因为主体不使用成员变量来存储观察者列表——只有一个全局列表。如果由于浏览器提供的内存有限，该模式在 javascript 框架中实现，这可能很有用。这种方法的主要缺点是它也是最慢的——对于每个被触发的事件，我们首先必须从全局哈希中过滤请求的主题，然后过滤请求的事件，然后才遍历所有观察者。

设计模式中还建议每个主题都有一个观察者列表。这将消耗稍多的内存（以`std::map`每个主题的成员变量的形式），但它提供比全局哈希更好的性能，因为主题只需要过滤请求的事件，然后遍历该事件的所有观察者。代码可能如下所示：

```
class Subject
{
protected:    
    // A callback is represented by the event id and the delegate.
    typedef std::pair< EventId, Delegate > Callback;

    // A map type to store callbacks
    typedef std::multimap< EventId, Delegate > Callbacks;

    // A callbacks iterator
    typedef Callbacks::iterator CallbackIterator;

    // A range of iterators for use when retrieving the range of callbacks
    // of a specific event.
    typedef std::pair< CallbackIterator, CallbackIterator> CallbacksRange;

    // The actual callback list
    Callbacks mCallbacks;
public:
    void Fire( EventId aEventId )
    {
        CallbacksRange   iEventCallbacks;
        CallbackIterator iIterator;

        // Get the callbacks for the request event.
        iEventCallbacks = mCallbacks.equal_range( aEventId );

        for ( iIterator = iEventCallbacks.first; iIterator != iEventCallbacks.second; ++iIterator  )
        {
            // Do the firing.
        }
    }
}; 
```

设计模式中不建议将每个事件作为成员变量，然后将观察者存储在事件本身中。这是最消耗内存的策略，因为不仅每个事件消耗一个成员变量，而且每个事件还有一个`std::vector`存储观察者。然而，这种策略提供了最好的性能，因为没有过滤要做，我们可以遍历附加的观察者。与其他两个相比，此策略还将涉及最简单的代码。要实现它，事件必须提供订阅和触发方法：

```
class Event
{
public:
    void Subscribe( void *aDelegate );
    void Unsubscribe( void *aDelegate );

    void Fire();
}; 
```

主题可能看起来像这样：

```
class ConcreteSubject : public Subject
{
public:
    // Declaring the events this subject supports.
    class SizeChangedEventType     : public Event {} SizeChangedEvent;
    class PositionChangedEventType : public Event {} PositionChangedEvent;
}; 
```

尽管观察者理论上可以直接订阅事件，但我们会看到通过主题是值得的：

```
// Subscribing to the event directly - possible but will limit features.
aSubject->SizeChangedEvent.Subscribe( this );

// Subscribing via the subject.
aSubject->Subscribe( aSubject->SizeChangedEvent, this ); 
```

这 3 种策略提供了存储与计算权衡的明确案例。并且可以使用下表进行比较：

![在此处输入图像描述](../Images/f36fd27759ee089cf0fa6bffe838aa31.png)

所采取的方法应考虑以下因素：

*   **受试者/观察者比率**——在观察者少而受试者多的系统中，记忆损失会更高，尤其是在典型的受试者没有观察者或只有一个观察者的情况下。
*   **通知的频率——通知**越频繁，性能损失就越高。

当使用观察者模式来通知`MouseMove`事件时，可能需要更多地考虑实现的性能。就内存损失而言，以下计算可能会有所帮助。鉴于：

*   使用按事件策略
*   典型的 64 位系统
*   每个科目平均有 8 个事件

800 万个主题实例将消耗略低于 1GB 的 RAM（仅限事件内存）。

### 同一个观察者，同一个事件？

观察者模式实现中的一个关键问题是我们是否允许同一个观察者多次订阅同一个事件（同一个主题）。

首先，如果我们允许它，我们可能会使用`std::multimap`而不是`std::map`. 此外，以下行将有问题：

```
aSubject->Unsubscribe( evSizeChanged, this ); 
```

由于主题无法知道要取消订阅之前的哪个订阅（可能不止一个！）。因此`Subscribe()`必须返回一个`Unsubscribe()`将使用的令牌，整个实现变得更加复杂。

从表面上看，这似乎很愚蠢——为什么同一个对象要多次订阅同一个事件？但请考虑以下代码：

```
class Figure
{
public:
    Figure( Subject *aSubject )
    {
        // We subscribe to the subject on size events
        aSubject->Subscribe( evSizeChanged, this, &Figure::OnSizeChanged );
    }

    void OnSizeChanged( Size aSize )
    {
    }
};

class Circle : public Figure
{
public:
    Circle( Subject *aSubject )
      : Figure( aSubject) 
    {
        // We subscribe to the subject on size events
        aSubject->Subscribe( evSizeChanged, this, &Circle::OnSizeChanged );
    }

    void OnSizeChanged( Size aSize )
    {
    }
}; 
```

此特定代码将导致同一对象订阅同一事件两次。还值得注意的是，由于该`OnSizeChanged()`方法不是虚拟的，因此两次订阅调用之间的成员函数指针会有所不同。因此，在这种特殊情况下，主题还可以比较成员函数指针，取消订阅签名将是：

```
aSubject->Unsubscribe( evSizeChanged, this, &Circle::OnSizeChanged ); 
```

但是如果`OnSizeChanged()`是虚拟的，那么没有令牌就无法区分两个订阅调用。

说实话，如果`OnSizeChanged()`是虚拟的，则该类没有理由`Circle`再次订阅该事件，因为它将被调用的是它自己的处理程序，而不是基类的处理程序：

```
class Figure
{
public:
    // Constructor
    Figure( Subject *aSubject )
    {
        // We subscribe to the subject on size events
        aSubject->Subscribe( evSizeChanged, this, &Figure::OnSizeChanged );
    }

    virtual void OnSizeChanged( Size aSize )
    {
    }
};

class Circle : public Figure
{
public:
    // Constructor
    Circle( Subject *aSubject )
      : Figure( aSubject) { }

    // This handler will be called first when evSizeChanged is fired.
    virtual void OnSizeChanged( Size aSize )
    {
        // And we can call the base class handler if we want.
        Figure::OnSizeChanged( aSize );
    }
}; 
```

当基类及其子类都必须响应同一事件时，此代码可能代表了最佳折衷方案。但它要求处理程序是虚拟的，并且程序员需要知道基类订阅了哪些事件。

不允许同一个观察者多次订阅同一个事件可以极大地简化模式的实现。它省去了比较成员函数指针的需要（一项棘手的工作），并且它允许`Unsubscribe()`像这样短（即使 MFP 提供了`Subscribe()`）：

```
aSubject->Unsubscribe( evSizeChanged, this ); 
```

### 订阅后一致性

观察者模式的主要目标之一是让观察者与其主体状态保持一致——我们已经看到状态变化事件正是这样做的。

有点令人惊讶的是，设计模式的作者断言当观察者订阅一个主题时，前者的状态与后者的状态不一致。考虑这段代码：

```
class Figure
{
public:
    // Constructor
    Figure( FigureSubject *aSubject )
    {
        // We subscribe to the subject on size events
        aSubject->Subscribe( evSizeChanged, this, &Figure::OnSizeChanged );
    }

    virtual void OnSizeChanged( Size aSize )
    {
        mSize = aSize;

        // Refresh the view.
        Refresh();
    }
private:
    Size mSize;
}; 
```

创建时，`Figure`该类确实订阅了它的主题，但它的大小与主题的大小不一致，它也不会刷新视图以显示其正确大小。

当使用观察者模式触发状态改变事件时，经常会发现订阅后需要手动更新观察者。实现这一点的一种方法是在观察者内部：

```
class Figure
{
public:
    Figure( FigureSubject *aSubject )
    {
        // We subscribe to the subject on size events
        aSubject->Subscribe( evSizeChanged, this, &Figure::OnSizeChanged );

        // Now make sure we're consistent with the subject.
        OnSizeChanged( aSubject->GetSize() );
    }

    // ...
}; 
```

但是想象一个有 12 个状态变化事件的主题。如果整个事情会自动发生，那就太好了，在订阅时，主题将向观察者发送正确的事件。

实现这一点的一种方法需要`Subscribe()`在具体主题中使用重载方法：

```
// This method assumes that each event has its own unique class, so the method
// can be overloaded.
FigureSubject::Subscribe( evSizeChanged aEvent, Delegate aDelegate )
{
    Subject::Subscribe( aEvent, aDelegate );

    // Notice the last argument in this call.
    Fire( aEvent, GetSize(), aDelegate );
} 
```

然后是观察者代码：

```
class Figure
{
public:
    Figure( FigureSubject *aSubject )
    {
        // We subscribe to the subject on size events.
        // The subject will fire the event upon subscription
        aSubject->Subscribe( evSizeChanged, MAKEDELEGATE( this, &Figure::OnSizeChanged ) );
    }

    // ...
}; 
```

请注意，该`Fire`调用现在需要一个额外的参数 ( `aDelegate`)，因此它只能更新特定的观察者，而不是已经订阅的观察者。

[gxObserver](https://github.com/Izhaki/gxObserver)通过定义绑定事件来处理这种情况。这些事件的唯一参数（除了可选的发送者）绑定到 getter 或成员变量：

```
class Subject : virtual public gxSubject
{
public:
    gxDefineBoundEvent( evAge, int, GetAge() )

    int GetAge() { return mAge; }
private:
    int mAge;    
} 
```

这也允许主体触发仅提供事件类型的事件：

```
// Same as Fire( evAge, GetAge() );
Fire( evAge ); 
```

无论使用何种机制，都值得记住：

*   需要有一种方法来确保观察者在状态事件订阅后与他们的主题一致。
*   最好在主题类中实现，而不是在观察者代码中实现。
*   该`Fire()`方法可能需要一个额外的可选参数，以便它可以触发单个观察者（刚刚订阅的那个）。

## 烧制过程

### 来自基类的火灾

以下代码片段显示了[JUCE](http://rawmaterialsoftware.com/juce.php)中事件触发的实现：

```
void Button::sendClickMessage (const ModifierKeys& modifiers)
{
    for (int i = buttonListeners.size(); --i >= 0;)
    {
        ButtonListener* const bl = (ButtonListener*) buttonListeners[i];
        bl->buttonClicked (this);
    }
} 
```

这种方法有几个问题：

*   从代码中可以明显看出，该类维护自己的 列表`buttonListeners`，这意味着它也有自己的`AddListener`和`RemoveListener`方法。
*   具体主题是遍历观察者列表的主题。
*   主体与其观察者高度耦合，因为它知道自己的类（`ButtonListener`）和其中的实际回调方法（`buttonClicked`）。

所有这些都意味着没有基础学科类。如果采用这种方法，则必须针对每个具体主题重新实现任何触发/订阅机制。这是反面向对象的编程。

在主题基类中完成观察者的管理、遍历和实际通知是明智的；这样，对下划线机制的任何更改（例如引入线程安全）都不需要更改每个具体主题。这将为我们的具体主题留下一个封装良好且简单的界面，并将触发简化为一行：

```
// In a concreate subject
Fire( evSize, GetSize() ); 
```

### 活动暂停和恢复

许多应用程序和框架会发现需要暂停特定主题的事件触发。有时我们希望暂停的事件排队并在我们恢复触发时被触发，有时我们只想忽略它们。就主题界面而言：

```
class Subject
{
public:
    void SuspendEvents( bool aQueueSuspended );
    void ResumeEvents();
}; 
```

事件暂停有用的一个示例是在复合对象的销毁期间。当一个复合对象被销毁时，它首先销毁它的所有子对象，这些子对象首先销毁它们的所有子对象，依此类推。现在，如果这些复合对象驻留在模型层中，它们将需要通知视图层中的相应对象（例如使用`evBeforeDestroy`事件）：

![在此处输入图像描述](../Images/f9f86c1385da6ed765798a92130d190e.png)

现在在这种特定情况下，不需要每个对象触发一个`evBeforeDestroy`事件——只要顶层模型对象会触发它就会这样做（删除顶层视图对象也会删除它的所有子对象）。因此，每当这样的组合被销毁时，它都希望暂停其子项的事件（而不对它们进行排队）。

另一个例子是加载涉及许多对象的文档，一些对象观察其他对象。虽然主题可能首先加载并根据文件数据设置其大小，但其观察者可能尚未加载，因此不会收到大小更改通知。在这种情况下，我们希望在加载之前暂停事件，但将它们排队直到文档完全加载。然后触发所有排队的事件将确保所有观察者与其主题一致。

最后，优化的队列不会对同一主题的同一事件进行多次排队。当通知恢复时，如果稍后排队的事件将通知 (20,20)，则通知观察者大小更改为 (10,10) 是没有意义的。因此，每个事件的最新版本是队列应该保留的版本。

## 如何为课程添加学科能力？

一个典型的主题界面看起来像这样：

```
class Subject
{
public:
    virtual void Subscribe( aEventId, aDelegate );
    virtual void Unsubscribe( aEventId, aDelegate );
    virtual void Fire( aEventId );
} 
```

问题是我们如何将这个接口添加到各种类中。有三个选项需要考虑：

*   遗产
*   作品
*   多重继承

### 遗产

在设计模式中，一个`ConcreteSubject`类继承自一个`Subject`类。

```
class ScrollManager: public Subject
{
} 
```

设计模式中的类图和示例代码很容易让人认为这是如何去做的。但是同一本书警告不要继承，并建议优先组合而不是它。这是明智的：考虑一个具有许多复合材料的应用程序，其中只有一些是主题；类应该从`Composite`类继承`Subject`吗？如果是这样，许多组合将具有他们不需要的主题功能，并且可能会以始终为空的观察者列表变量的形式存在内存损失。

### 作品

大多数应用程序和框架会发现只需要将主题功能“插入”到选定的类中，这些类不一定是基类。组合正是允许这样做的。在实践中，一个类将有一个成员`mSubject`为所有主题方法提供接口，如下所示：

```
class ScrollManager: public SomeObject
{
public:
    Subject mSubject;
} 
```

这种策略的一个问题是它会为每个主题支持的类带来内存损失（一个成员变量）。另一个是它使访问主题协议有些麻烦：

```
// Notification within a class composed with the subject protocol.
mSubject.Fire( ... );

// Or the registration from an observer.
aScrollManager.mSubject.Subscribe( ... ); 
```

### 多重继承

多重继承允许我们随意将主题协议组合成一个类，但没有成员组合的陷阱：

```
class ScrollManager: public SomeObject,
                     public virtual Subject
{
} 
```

这样，我们就摆脱`mSubject`了前面的例子，所以我们剩下：

```
// Notification within a subject class.
Fire( ... );

// Or the registration from an observer.
aScrollManager.Subscribe( ... ); 
```

请注意，我们`public virtual`用于主题继承，因此如果子类`ScrollManager`决定重新继承协议，我们不会获得两次接口。但是可以公平地假设程序员会注意到基类已经是一个主题，因此没有理由重新继承它。

虽然通常不鼓励多重继承，并且并非所有语言都支持它，但为此目的值得考虑。基于 Javascript 的 ExtJs 不支持多重继承，使用 mixins 来实现同样的功能：

```
Ext.define('Employee', {
    mixins: {
        observable: 'Ext.util.Observable'
    },

    constructor: function (config) {
        this.mixins.observable.constructor.call(this, config);
    }
}); 
```

# 结论

总结本文，观察者模式的通用实现应考虑以下关键点：

*   主体会触发有状态和**无状态事件**——后者只能通过推送模型来实现。
*   对象通常会触发**不止一种类型的事件**。
*   观察者可以订阅具有多个主题的同一事件。这意味着主题观察者协议应该允许**发送者被拼写**。
*   **任意事件处理程序**极大地简化了客户端代码并促进了首选的可变性推送模型；但它们的实现并不直接，并且会导致更复杂的主题代码。
*   事件处理程序可能需要是**虚拟**的。
*   观察者可以存储在全局散列中、每个主题或**每个事件中**。该选择形成了内存、性能和代码简单性之间的权衡。
*   理想情况下，观察者只**订阅一次**相同主题的相同事件。
*   **在订阅后立即让观察者**与其主题的状态保持一致是需要牢记的。
*   事件的触发可能需要使用排队选项**暂停**，然后再**恢复**。
*   **向类添加主题功能时，值得考虑**多重继承。****

 **（第二部分结束）**

# javascript - 如何从对象数组中删除重复项？

> ID：14633810
> 
> 赞同：1
> 
> 时间：2013-01-31T19:40:04.397
> 
> 标签：javascript

从对象数组中删除重复项的最佳方法是什么？

```
var array = [
  {a: 0, b: 0, c: 0},
  {a: 0, b: 0, c: 0},

  {a: 1, b: 1, c: 1},
  {a: 1, b: 1, c: 1},

   //..... etc
]; 
```

而且，我想得到：

```
[
  {a: 0, b: 0, c: 0},
  {a: 1, b: 1, c: 1}
]; 
```

PS：键（a，b，c）只有原始数据类型（String，Number）

请不要使用 underscore.js 和其他库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:04:39.097

我确信有更好的方法可以做到这一点，但你可以使用这个原型函数。

```
Array.prototype.removeDuplicates = function () {
    var r = new Array();
    o:for(var i = 0, n = this.length; i < n; i++)
    {
        for(var x = 0, y = r.length; x < y; x++)
            if(r[x].a==this[i].a && r[x].b==this[i].b && r[x].c==this[i].c)
                continue o;
        r.push(this[i]);
    }
    return r;
} 
```

### 如何使用它

```
var arr = [
  {a: 0, b: 0, c: 0},
  {a: 0, b: 0, c: 0},
  {a: 1, b: 1, c: 1},
  {a: 1, b: 1, c: 1},

   //..... etc
];
var uniques = arr.removeDuplicates();
console.log(uniques); 
```

### 笔记：

对于大型阵列，您应该避免这种情况，有更好的解决方案

# php - 是否可以使用 PHPExcel 编辑现有的模板文件，并维护现有的格式/电子表格对象

> ID：14633818
> 
> 赞同：2
> 
> 时间：2013-01-31T19:40:40.230
> 
> 标签：php, phpexcel

我正在寻找一种从 MySQL 数据中操作/生成 xls/xlsx 文件的服务器端 (PHP) 方式。

我有一个现有的模板 xls 文件，其中包含各种相对复杂的单元格相关公式和图表等，我希望我可以将此模板文件上传到我的服务器并使用 PHPExcel 编辑该文件并保存它：允许它是下载。

所以我的公式被保留了，图表被保留了，我只需要根据数据库中的值编辑某些单元格的数据 --> 基于这些值绘制的图表。

PHPExcels 范围内的那种事情吗？

在此处阅读相关问题： [PHPExcel modify existing .xlsx file with multiple worksheet](https://stackoverflow.com/questions/7594444/phpexcel-modify-existing-xlsx-file-with-multiple-worksheet)

有人说：

> PHPExcel 不支持宏和用户定义的函数；并且该库在加载工作簿时会丢弃任何不受支持的功能，因此它们根本不存在于 PHPExcel 对象中……保存时，PHPExcel 仅保存工作簿中存在于 PHPExcel 对象中的那些元素。

用户定义的函数会包含简单的单元格公式吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:44:34.057

**没有**。简单的单元格公式仍然存在。只是没有任何 VBA 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T20:54:23.427

PHPExcel 可以处理相当复杂的单元格公式，尽管它确实有一些限制：

*   当前仅支持 Excel 2007 的 356 个函数中的 316 个，而那些不一定实现函数的所有功能
*   不支持 Excel 2010 和 Excel 2013 的任何附加功能
*   Excel BIFF 文件不支持分析工具包函数
*   不支持 VBA 脚本，这包括任何用户定义的函数
*   不支持数组公式
*   不支持 3D 单元参考

# vb.net - 如果不能一起工作，内联的可空类型？

> ID：14633824
> 
> 赞同：7
> 
> 时间：2013-01-31T19:41:01.827
> 
> 标签：vb.net, if-statement, nullable

给定以下代码：

```
Dim widthStr As String = Nothing 
```

这有效 -`width`分配`Nothing`：

```
Dim width As Nullable(Of Double)
If widthStr Is Nothing Then
  width = Nothing
Else
  width = CDbl(widthStr)
End If 
```

但这不会 -`width`变成`0.0`（尽管它在逻辑上似乎是相同的代码）：

```
Dim width As Nullable(Of Double) = If(widthStr Is Nothing, Nothing, CDbl(widthStr)) 
```

为什么？我能做些什么让它发挥作用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T16:14:52.327

继达米安的回答之后，这样做的干净方法是*不*使用`Nothing`，`New Double?`而是：

```
Dim width As Double? = If(widthStr Is Nothing, New Double?, CDbl(widthStr)) 
```

现在`If`表达式的类型是正确的，这可以简化为：

```
Dim width = If(widthStr Is Nothing, New Double?, CDbl(widthStr)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T19:47:31.217

这一切都归结为表达式的类型分析。

`Nothing`是VB.Net中的一个魔兽。它与 C# 中的大致相同`default(T)`。

因此，在尝试确定以下内容的最佳类型时：

```
If(widthStr Is Nothing, Nothing, CDbl(widthStr)) 
```

第三个参数是 type `Double`。第二个参数可转换为`Double`（因为`Nothing`可以返回值类型的默认值）。因此， 的返回值的类型`If`被确定为`Double`。

只有*在*该类型分析结束后，才需要注意分配此表达式的变量的类型。并且`Double`可以分配给`Double?`没有任何警告。

* * *

没有*干净*的方法可以让你的`If()`表达方式达到你的预期。`null`因为在 VB.Net 中没有等价物。您需要（至少）在`DirectCast`的潜在结果的一侧或另一侧插入（或等效）`If`以强制类型分析查看`Double?`而不是`Double`.

# cuda - CUDA 对 OpenMP 的 CPU 不是那么快吗？

> ID：14633828
> 
> 赞同：1
> 
> 时间：2013-01-31T19:41:19.163
> 
> 标签：cuda, gpgpu, gpu

我正在尝试计算 450 个向量之间的互相关，每个向量的大小为 20000。在 CPU 上执行此操作时，我将数据存储在 2D 矩阵中，行数 = 20000，列数 = 450。

计算的串行代码看起来像

```
 void computeFF_cpu( float * nSamples, float * nFeatures, float ** data, float ** corr
        #pragma omp parallel for shared(corr, data)
        for( int i=0 ; i<nFeatures ; i++ )
        {
            for( int j=0 ; j<nFeatures ; j++ )
                corr[i][j] = pearsonCorr( data[i], data[j], nSamples );
        }

int main()
{
.
.
**for( int z=0 ; z<1000 ; z++ )**
computeFF_cpu( 20000, 450, data, corr );
.
.
} 
```

这完美地工作。现在我尝试用 GPU 解决这个问题。我已将 2D 数据矩阵转换为 GPU 内存中的行主要格式，并且我已验证复制是否正确。

这些向量以行主要格式存储为大小为 900000（即 450*20000）的矩阵。组织如下
<---f1的nSamples---><---f2的nSamples ---><---f3的nSamples--->......

我计算互相关的 cuda 代码如下

```
 // kernel for computation of ff
    __global__ void computeFFCorr(int nSamples, int nFeatures, float * dev_data, float * dev_ff)
    {
        int tid = blockIdx.x + blockIdx.y*gridDim.x;
        if( blockIdx.x == blockIdx.y )
        dev_ff[tid] = 1.0;
        else if( tid < nFeatures*nFeatures )
        dev_ff[tid] = pearsonCorrelationScore_gpu( dev_data+(blockIdx.x*nSamples), dev_data+(blockIdx.y*nSamples), nSamples );
    }

    main()
    {
    .
    .
        // Call kernel for computation of ff
**for( int z=0 ; z<1000 ; z++ )**
        computeFFCorr<<<dim3(nFeatures,nFeatures),1>>>(nSamples, nFeatures, dev_data, corr);
        //nSamples = 20000
        // nFeatures = 450
        // dev_data -> data matrix in row major form
        // corr -> result matrix also stored in row major
    .
    .
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T13:07:00.813

好像我已经找到了自己问题的答案。我有以下实验。我已经更改了 z 的值（即函数执行的次数）。这种方法在之前的几篇关于 cuda 标签下的 stackoverflow 的文章中被提出。

这是表——

*   Z=100 ; CPU=11s ; GPU=14s
*   Z=200 ; CPU=18s ; GPU=23s
*   Z=300 ; CPU=26s ; GPU=34s
*   Z=500 ; CPU=41s ; GPU=53s
*   Z=1000；CPU=99s ; GPU=101s
*   Z=1500；CPU=279s；GPU=150s
*   Z=2000；CPU=401s；GPU=203s

很明显，随着计算量的增加，GPU 的扩展能力比 CPU 好得多。

# android - 带有 ViewPager 的 SupportMapFragment：无法移动相机或更改地图设置

> ID：14633829
> 
> 赞同：4
> 
> 时间：2013-01-31T19:41:18.797
> 
> 标签：android, map, android-viewpager, google-maps-android-api-2, supportmapfragment

我在`SupportMapFragment`将相机移动到地图上的某个位置时遇到问题。

```
public class MapPositionFragment extends SupportMapFragment implements LocationListener{

private GoogleMap map = null;
private Button lockButton = null;
private Location currentLocation = null;
private LocationManager locationManager = null;
private View mapView = null;

@Override
  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    mapView = super.onCreateView(inflater, container, savedInstanceState);
    View v = inflater.inflate(R.layout.fragment_route_map, container, false);

    SetUpMap(v);
    return v;
  }

@Override
public void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
}

@Override
public void setUserVisibleHint(boolean isVisibleToUser) {

    if (isVisibleToUser){
        SetUpLocationService();
    }
}   

private void SetUpLockButton(){
    lockButton = (Button)getActivity().findViewById(R.id.lock_screen_button);
    lockButton.setOnClickListener(new OnClickListener() {           
        public void onClick(View v) {
            ToggleLockButton();
        }
    });     
}

private void ToggleLockButton(){
    BaseSwipeActivity baseActivity = (BaseSwipeActivity)getActivity();
    boolean swipeEnabled = baseActivity.TogglePaging();

    if (swipeEnabled){
        lockButton.setBackgroundResource(R.drawable.stock_lock_open);
    }
    else{
        lockButton.setBackgroundResource(R.drawable.stock_lock);
    }
}

private void SetUpLocationService(){
    boolean gpsIsEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
    boolean networkIsEnabled = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);

    if (networkIsEnabled){
        // Register the listener with the Location Manager to receive location updates
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, this);
    } else if (gpsIsEnabled){
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
    }

}

private void SetCurrentLocation(final Location location){

    if (map != null){
        getActivity().runOnUiThread(new Runnable() {
              public void run() {
                LatLng latLng = new LatLng(location.getLatitude(), location.getLongitude());
                CameraUpdate cameraUpdate = CameraUpdateFactory.newLatLngZoom(latLng, 10);
                map.moveCamera(cameraUpdate);
              }
        });

    }
}

private void SetUpMap(View view) {
    if (map == null){
        getActivity().runOnUiThread(new Runnable() {
              public void run() {
                map = getMap();
                map.getUiSettings().setMyLocationButtonEnabled(true);
                map.setIndoorEnabled(true);
                map.getUiSettings().setZoomControlsEnabled(false);
                locationManager = (LocationManager)getActivity().getSystemService(Context.LOCATION_SERVICE);
              }
        });
    }
}

@Override
  public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    SetUpLockButton();
  }

public void onLocationChanged(Location location) {
      // Called when a new location is found by the network location provider.
      SetCurrentLocation(location);
}

public void onProviderDisabled(String arg0) {
    // TODO Auto-generated method stub

}

public void onProviderEnabled(String arg0) {
    // TODO Auto-generated method stub

}

public void onStatusChanged(String arg0, int arg1, Bundle arg2) {
    // TODO Auto-generated method stub

} 
```

}

它 `SupportMapFragment`位于`ViewPager`. 地图已显示，但我无法更改地图设置，也无法更改相机位置。我想可能是因为它在另一个线程中我必须使用 UI 线程，但这并没有改变任何东西。

所以也许有人有一个想法，那会很棒！

谢谢曼努埃尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T14:09:32.170

我今天遇到了同样的问题。这是我的解决方案。

正如你所拥有的：

```
// @ SetUpMap()
map = getMap(); 
```

将其替换为：

```
// Remeber to change the map id (R.id.map) to what you have in the layout .xml
map = ((SupportMapFragment) getActivity().getSupportFragmentManager().findFragmentById(R.id.map))
        .getMap(); 
```

**似乎此解决方案不适用于 Android 支持库 21.0.x（我已经测试了 .2 和 .3）。由于此方法适用于较旧的 Android 支持库，因此可能存在错误等。**

# python - 将 coverage.py 中的 .coverage 文件加载到 IntelliJ IDEA/PyCharm 的覆盖视图中

> ID：14633836
> 
> 赞同：8
> 
> 时间：2013-01-31T19:41:38.727
> 
> 标签：python, intellij-idea, pycharm

我有`.coverage`文件指示由 coverage.py 生成的 Django 项目的代码[覆盖率](http://nedbatchelder.com/code/coverage/)：

```
coverage run --branch --source='.' manage.py test style 
```

我可以使用 生成漂亮的 HTML 报告`coverage html`，但我真的更喜欢利用 IDEA 的覆盖率视图来指示我的项目中的覆盖率，而我正在处理它。

我不能使用 IntelliJ 的“Run with Coverage”命令以标准方式生成覆盖数据。*（请认为这是理所当然的；稍后我可能会问第二个问题关于我的原因。）*

有什么方法可以将`.coverage`coverage.py生成的文件导入IntelliJ IDEA？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-31T20:25:55.253

这是可能的，至少只要您`coverage`在项目的根目录中运行。

首先，您需要通过运行将`.coverage`文件转换为. 然后只需转到“*分析*”菜单，选择“显示代码覆盖率数据”并添加 XML 文件。`coverage.xml``coverage xml`

 *> ![](../Images/9a2d073aa998e6ce55afac93f3982fbd.png)
> 
>                       ![](../Images/4f260421a29f915cbbdc619b2d865961.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T12:37:42.903

谢谢，现在使用 pycharm 2.7，您应该转到 Tools -> Show Code Coverage Data 并添加新文件*

# python - 脚本头过早结束：在基本 python 脚本中

> ID：14633846
> 
> 赞同：0
> 
> 时间：2013-01-31T19:42:21.760
> 
> 标签：python, apache, xampp

大家好，我正在尝试按照[http://elvenware.com/charlie/development/web/Python/Xampp.html](http://elvenware.com/charlie/development/web/Python/Xampp.html)使用 xampp 设置 python。我正在运行 xammp usb lite 1.77

按照此处和 Windows 上的[Python 和 XAMPP 上的说明进行操作：如何？](https://stackoverflow.com/questions/8363247/python-xampp-on-windows-how-to),

我创造了

```
#!F:/Python27/python

print "Content-type: text/html\n\n"
print "<html><head><title>Hello World from Python</title></head><body>Hello World from a Python CGI Script</body></html> 
```

当我将它放在 cgi-bin 文件夹中并像 htp://localhost/cgi-bin/test.py 一样运行它后尝试运行它时，我得到：

```
Premature end of script headers: test.py 
```

顺便说一句，包含的 htp://localhost/cgi-bin/cgi.cgi 脚本有效！

知道我能做些什么来解决这个问题吗？

先感谢您，

账单

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:44:51.293

第 2 行没有结尾`"`- 除非是复制/粘贴错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-20T11:31:56.897

我对xampp有同样的问题。

问题出在`httpd.conf`. 使用 xampp apache 将与另一个`httpd.conf`安装，如 apache 的独立安装。

检查您的设置`httpd.conf`并更改它。

# java - Android phonegap 在横向上崩溃

> ID：14633847
> 
> 赞同：1
> 
> 时间：2013-01-31T19:42:23.910
> 
> 标签：java, android, cordova

我的应用程序有一个嵌入式cordovaWebview，它在纵向上正常运行。但是，当变成横向时，应用程序崩溃并报告以下错误。在发布之前，我已经阅读了很多关于这个问题的条目，这些条目在清单上的所有活动中添加了方向。完成但不是解决方案！如果需要更多代码，请询问。谢谢你。

```
01-31 20:34:57.797: E/AndroidRuntime(17868): FATAL EXCEPTION: main
01-31 20:34:57.797: E/AndroidRuntime(17868): java.lang.NullPointerException
01-31 20:34:57.797: E/AndroidRuntime(17868):    at java.lang.String.indexOf(String.java:1145)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at org.apache.cordova.CordovaWebView.loadUrlNow(CordovaWebView.java:499)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at org.apache.cordova.CordovaWebView.loadUrl(CordovaWebView.java:384)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at com.nimbosolutions.projecte1.webPush.onConfigurationChanged(webPush.java:138)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at android.app.ActivityThread.performConfigurationChanged(ActivityThread.java:2962)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at android.app.ActivityThread.handleConfigurationChanged(ActivityThread.java:3052)
01-31 20:34:57.797: E/AndroidRuntime(17868):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1016) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T14:53:16.847

我在自己的应用程序上遇到了同样的问题，我在 AndroidManifest.xml 中的 android:configChanges 中添加了“screenSize”。现在，它看起来像这样：

```
android:configChanges="orientation|keyboardHidden|screenSize" 
```

希望能帮助到你...

# php - 如何在 PHP 中从 REST API 加载多个页面

> ID：14633850
> 
> 赞同：1
> 
> 时间：2013-01-31T19:42:38.093
> 
> 标签：php, api, rest, simplexml

下面是从 REST XML API 获取结果的简单代码示例。

这只是我为这个问题从我的真实 PHP 类中提取的一小部分。

在返回 XML 文档的 API URL 中，我很好奇如何从 1 页获取所有结果，然后继续从下一页获取。

`$this->api_page`设置 API 从哪个页面返回数据。

查看下面的基本代码`SimpleXMLElement`，例如我如何从 API 中的 10 个页面或所有页面返回数据，从页码开始，加载该页面的结果，然后获取下一页继续前进。

现在，我正在使用 JavaScript 和 PHP 通过将`Page number`URL 中的 a 传递给我的脚本来`$_GET['page']`执行此操作，问题是它需要用户加载页面，而且有点草率。

我真正的 API 脚本将从服务器上的 Cron 作业运行，因此考虑到这一点，我如何获取所有页面？

我根据下面的示例代码提出这个问题，但也是因为这是我在其他项目中经常要做的任务，而且我不知道这样做的好方法？

```
<?php

$this->api_url = 'http://api.rescuegroups.org/rest/?key=' .$this->api_key.
'&type=animals&limit=' .$this->api_limit.
'&startPage='. $this->api_page;

$xmlObj = new SimpleXMLElement($this->api_url, NULL, TRUE); 

foreach($xmlObj->pet as $pet){

    echo $pet->animalID;
    echo $pet->orgID;
    echo $pet->status;

    // more fields from the  Pet object that is returned from the API call

    // Save results to my own Database

}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T20:35:24.777

基于您在相当稳定的环境中运行的假设，您可以像这样循环浏览页面：

```
<?php
$this->base_url = 'http://api.rescuegroups.org/rest/?key=' .$this->api_key.
'&type=animals&limit=' .$this->api_limit.
'&startPage=';
$start_page = $this->api_page;
$end_page = 10; //If you have a value for max pages.
// sometimes you might get the number of pages from the first returned XML and then you could update the $end_page inside the loop.

for ($counter = $start_page; $counter <= $end_page; $counter++) {
    try {
        $xmlObj = new SimpleXMLElement($this->base_url . $counter, NULL, TRUE); 

        foreach($xmlObj->pet as $pet){

            echo $pet->animalID;
            echo $pet->orgID;
            echo $pet->status;

            // more fields from the  Pet object that is returned from the API call

            // Save results to my own Database

        }

    } catch (Exception $e) {
        // Something went wrong, possibly no more pages?
        // Please Note! You wil also get an Exception if there is an error in the XML
        // If so you should do some extra error handling
        break;
    }
}

?> 
```

# c# - 有没有办法解决 Awesomium 1.7 WebCore Shutdown Bug

> ID：14633851
> 
> 赞同：2
> 
> 时间：2013-01-31T19:42:43.267
> 
> 标签：c#, browser, awesomium

我正在使用 Awesomium 开发一个网络浏览器，并且我正在使用它的最新版本。但是，当我处理 WebControls 和关闭 WebCore（它也处理 WebControls）时，它会出现一些问题。

有谁知道解决这个问题的方法？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T06:20:05.913

我已经对此进行了一些测试。我试图使用 WebControl 的 WPF 版本，发现它可能会严重泄漏，尤其是当您随着时间的推移创建和销毁大量 WebControl 时。所以，我在玩 WindowsFormsHost 并使用 WebControl 的 WinForms 版本，即使它没有泄漏，我也遇到了你描述的同样问题。事实证明，您想在清理窗口的句柄后显式调用 Dispose。

在 WPF 中，我继承了 WindowsFormsHost 并指定了对 DestroyWindowCore 的覆盖，如下所示：

```
 protected override void DestroyWindowCore(System.Runtime.InteropServices.HandleRef hwnd) {
        base.DestroyWindowCore(hwnd);// clean up handles

        // Disposing here prevents access violation from crashing non-debug instances
        // Confirmed to prevent access violation on WebCore shutdown as well

        webControl1.Dispose();
        webControl1 = null;
    }

    // This code seems to work in WinForms, I placed this in Form1.cs:
    protected override void DestroyHandle() {

        base.DestroyHandle();
        webControl1.Dispose();
    } 
```

我建议您在处置控件的不同位置进行调整。通常在主机释放它的句柄之后。我可以确认我不再有这个问题，并且 Awesomium.Windows.Forms.WebControl 在 Dispose 上运行正常

编辑，我已将我的测试项目上传到 DropBox [here](https://dl.dropbox.com/u/72849414/AwesomiumTest.zip "AwesomiumTest.zip")。该解决方案适用于 Visual Studio 2012 并针对 .net 4.5。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:22:42.453

我通过在主窗体中的 FormClosing 事件中添加一些代码来解决它：

```
private void frmMain_FormClosing(object sender, FormClosingEventArgs e)
{
  foreach(WebControl awWebControl in WebCore.Views)
  {
     //Dispose all active views in WebCore
     awWebControl.Dispose();

  }
  //then you can Shutdown the WebCore
  WebCore.Shutdown();
} 
```

希望这可以帮助

# sql - 使用 RIGHT JOIN 的 sql 查询的意外结果

> ID：14633852
> 
> 赞同：0
> 
> 时间：2013-01-31T19:42:43.547
> 
> 标签：sql, join

我有一个似乎返回意外空白行的 sql 查询。此查询与另一个表有一个右连接，但是当返回行时它返回一个空值..

```
 SELECT e.error_id, e.user_id, e.error_title, e.error_content, e.error_answers, 
         e.error_votes, e.error_views, e.error_added_date, u.user_name
  FROM errors e
  JOIN users u
    ON u.user_id=e.user_id
  RIGHT JOIN answers a
    ON a.error_id=e.error_id AND a.answer_accepted='1'
  GROUP BY e.error_id
  ORDER BY e.error_added_date DESC 
```

此查询应该返回我一行，但它返回我预期的行和一个空白值的行.. 为什么会这样？

**参赛作品**

```
+----------------------------------------------------------------------------------------------------+
answer_id | error_id | user_id | answer_content | answer_accepted | answer_votes | answer_added_date |
1         | 3        | 1       | text           | 0               | 0            | 2013-01-31 12:49:12
2         | 3        | 1       | text           | 1               | 1            | 2013-01-31 12:52:29
3         | 3        | 1       | text           | 0               |-1            | 2013-01-31 12:53:45
4         | 2        | 1       | text           | 0               |-1            | 2013-01-31 12:53:45
+----------------------------------------------------------------------------------------------------+ 
```

结果：

```
+-------------------------------------------------------------------------------+
|   1 | 1    | text |  3   | 0    |  2   |  2013-01-29 16:56:20  |  Mihai Matei |
|NULL | NULL | NULL | NULL | NULL | NULL |       NULL            |  NULL        |
+-------------------------------------------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:08:03.977

发生这种情况是因为您正在执行 Right Join。我想你想要一个左连接或一个内连接。

右连接意味着返回右侧的所有表行和左侧的匹配行。因为您的结果集不包含 answers 表（右表）中的任何列，所以您可以获得一组全空值。换句话说，answers 表中有一行，而 error 和 users 表中没有相应的行。

鉴于对此答案的评论中的其他标准，这是我将尝试的查询：

```
 SELECT e.error_id, e.user_id, e.error_title, e.error_content, e.error_answers, 
         e.error_votes, e.error_views, e.error_added_date, u.user_name
  FROM errors e
  JOIN users u
    ON u.user_id=e.user_id
  LEFT JOIN answers a
    ON a.error_id = e.error_id and a.answer_accepted = '1'
  WHERE a.answer_id is null
  GROUP BY e.error_id
  ORDER BY e.error_added_date DESC 
```

# php - Symfony2 - 在渲染模板之前注入代码

> ID：14633853
> 
> 赞同：0
> 
> 时间：2013-01-31T19:42:49.333
> 
> 标签：php, symfony, smarty

我将[SmartyBundle](https://github.com/noiselabs/SmartyBundle)添加到我的 Symfony2 应用程序中。它工作得很好，但我想将左（默认：）`{`和右（默认`}`：）分隔符更改为`[`and `]`。为此，我需要执行以下代码：

```
$smarty = $container->get('templating.engine.smarty')->getSmarty();
$smarty->left_delimiter = '[';
$smarty->right_delimiter = ']'; 
```

在控制器中渲染模板之前如何做到这一点？我想我需要使用 EventListener 但我不确定如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T06:48:15.150

Your can usage request listener in Kernel.

If smarty engine have method setLeftDelimiter and setRightDelimiter, your can create a CompilerPass for your bundle, get definition and add call methods.

# xcode - XCode“验证应用程序”步骤需要很长时间

> ID：14633856
> 
> 赞同：4
> 
> 时间：2013-01-31T19:43:01.087
> 
> 标签：xcode, xcode4.5

在我的机器上，完全更新的 XCode 4.6（和以前的 4.5）中构建过程的“验证应用程序”步骤通常需要两分钟以上。在类似计算机上构建相同应用程序的同事只需几秒钟即可完成此步骤。在过去的几个月里，我的机器也曾经使用过，但现在不再使用了。

有谁知道这可能是什么原因以及我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T04:55:09.123

将您的设备更新到最新版本的 iOS 6.1。

有同样的问题，更新我的 iPad3 后修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T04:00:07.960

尝试重新启动您的设备。

我在使用 XCode 4.5.1 和 iPad 6.0.1 时遇到了同样的问题，但当时不想更新。除了很长的“验证应用程序”步骤之外，我注意到复制资源也比较慢。之后，我断开了 iPad 的连接并试图删除我的 App，但发现即使是设备的 delete alertview 也需要花费一些时间。所以，显然，对我来说，这是一个设备问题，在执行设备关闭/重启后，xcode 的运行速度达到了以前的正常速度。

# r - 如何将数据框中的向量值与 R 中的常量进行比较？

> ID：14633863
> 
> 赞同：2
> 
> 时间：2013-01-31T19:43:32.287
> 
> 标签：r, if-statement, constants, dataframe, scalar

背景：我正在使用一些人口普查公众使用的微数据样本（特别是美国社区调查）来检查已完成不同学位（例如，高中文凭、学士学位、硕士学位）的人的行为。该公共使用文件的变量称为“Schooling”。问题是变量“Schooling”中包含的代码每年都在变化。例如，对于截至 2007 年的文件，值“13”反映完成学士学位，但从 2008 年开始，当某人完成学士学位时，值变为“21”。

目标：创建一个新的“Degree Competed”变量，翻译“Schooling”代码以反映完成的学位级别，同时考虑到文件的年份。后勤：所有年份的文件都已连接起来，出于审查目的，我必须按原样处理文件，而不是在它到达这一点之前对其进行更正。

现有代码：这是我尝试过的。

```
if      (original.file$year %in% c(2000,2001)) {
    if      (original.file$Schooling <= 08) {original.file$degree.completed <- 0}
    else if (original.file$Schooling <= 10) {original.file$degree.completed <- 1}
    else if (original.file$Schooling <= 12) {original.file$degree.completed <- 2}
    else if (original.file$Schooling == 13) {original.file$degree.completed <- 3}
    else if (original.file$Schooling == 14) {original.file$degree.completed <- 4}
    else if (original.file$Schooling == 15) {original.file$degree.completed <- 5}
    else if (original.file$Schooling == 16) {original.file$degree.completed <- 6}
    }
else if (original.file$year %in% c(2002,2003,2004,2005,2006,2007)) {
    if      (original.file$Schooling <= 08) {original.file$degree.completed <- 0}
    else if (original.file$Schooling <= 11) {original.file$degree.completed <- 1}
    else if (original.file$Schooling == 12) {original.file$degree.completed <- 2}
    else if (original.file$Schooling == 13) {original.file$degree.completed <- 3}
    else if (original.file$Schooling == 14) {original.file$degree.completed <- 4}
    else if (original.file$Schooling == 15) {original.file$degree.completed <- 5}
    else if (original.file$Schooling == 16) {original.file$degree.completed <- 6}
    }
else if (original.file$year %in% c(2008,2009,2010,2011)) {
    if      (original.file$Schooling <= 15) {original.file$degree.completed <- 0}
    else if (original.file$Schooling <= 19) {original.file$degree.completed <- 1}
    else if (original.file$Schooling == 20) {original.file$degree.completed <- 2}
    else if (original.file$Schooling == 21) {original.file$degree.completed <- 3}
    else if (original.file$Schooling == 22) {original.file$degree.completed <- 4}
    else if (original.file$Schooling == 23) {original.file$degree.completed <- 5}
    else if (original.file$Schooling == 24) {original.file$degree.completed <- 6}
    } 
```

问题：我收到以下此类警告消息。

> 警告信息：
> 
> 1: 在 if (original.file$year %in% c(2000, 2001)) { : 条件长度 > 1 并且只使用第一个元素
> 
> 2: 在 if (original.file$Schooling <= 8) { : 条件长度 > 1 并且只使用第一个元素
> 
> 3: 在 if (original.file$Schooling <= 10) { : 条件长度 > 1 并且只使用第一个元素

问题：我知道这里的“if”存在向量与标量问题，正如我从 StackOverflow 上的其他问题中看到的那样，但答案似乎不适用于这种情况。这里的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:57:35.040

首先，使用`cut`or a`table`代替所有那些`if`'s 和`else`'s：

```
CutOffs1 <- c(0,8,10,12,13,14,15,16)
CutOffs2 <- c(0,8,11,12,13,14,15,16)
CutOffs3 <- c(0,15,19,20,21,22,23,24)
CutOffs <- cbind(CutOffs1, CutOffs2, CutOffs3)
MyTable <- apply(CutOffs, 2, function(X) cut(1:24, X, FALSE)-1)

      CutOffs1 CutOffs2 CutOffs3
 [1,]        0        0        0
 [2,]        0        0        0
 [3,]        0        0        0
 [4,]        0        0        0
 [5,]        0        0        0
 [6,]        0        0        0
 [7,]        0        0        0
 [8,]        0        0        0
 [9,]        1        1        0
[10,]        1        1        0
[11,]        2        1        0
[12,]        2        2        0
[13,]        3        3        0
[14,]        4        4        0
[15,]        5        5        0
[16,]        6        6        1
[17,]       NA       NA        1
[18,]       NA       NA        1
[19,]       NA       NA        1
[20,]       NA       NA        2
[21,]       NA       NA        3
[22,]       NA       NA        4
[23,]       NA       NA        5
[24,]       NA       NA        6 
```

你也会想把`cut`岁月变成因素。

```
original.file$Period <- cut(original.file$year, c(2000,2001, 2007, 2011), FALSE,   
                            include.lowest=TRUE) 
## To demonstrate:
    > cbind(2000:2011, cut(2000:2011, c(2000,2001, 2007, 2011), FALSE,   
+     include.lowest=TRUE))
      [,1] [,2]
 [1,] 2000    1
 [2,] 2001    1
 [3,] 2002    2
 [4,] 2003    2
 [5,] 2004    2
 [6,] 2005    2
 [7,] 2006    2
 [8,] 2007    2
 [9,] 2008    3
[10,] 2009    3
[11,] 2010    3
[12,] 2011    3 
```

然后你应该能够做到：

```
Degrees <- apply(original.file, 1, function(X) MyTable[X['Schooling'], X['Period']]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:31:28.417

感谢贾斯汀的解决方案：

> if 作用于单个布尔值。相反，您可以使用 ifelse 作用于向量但不太适合此操作。您还可以使用布尔条件和子集。类似 dat$degree[dat$year %in% 2000:2001 & dat$schooling <= 8] <- 0\. – Justin

最终解决方案需要进行一次调整：因为这不是 if-then-else 语句并且有多个语句，“<=8”类型的结构将不起作用，因为后续语句将取代这个。例如，如果下一行具有“...<= 10] <- 1，那么一旦调用此行，所有零都将更改为一个，依此类推。相反，“<=8”必须是转换为 %in% c(1:8) 语句，并且必须注意使所有类似 if 的语句互斥，以避免覆盖先前的分配。

# opengl - FreeGLUT 或 Mesa，我应该使用哪一个？

> ID：14633865
> 
> 赞同：4
> 
> 时间：2013-01-31T19:43:48.567
> 
> 标签：opengl, 3d, glut, freeglut, mesa

所以正如标题所说，你会选择哪一个？如果有人也能解释背后的原因，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T19:50:39.357

FreeGLUT 是一个用于创建小型 OpenGL 演示的简单框架。FreeGLUT 的替代品是 SDL、GLFW 或 Qt 等成熟的框架。

Mesa 是 OpenGL API 的开源实现，与 DRI/DRM 项目驱动程序一起形成了完整的硬件加速 OpenGL 实现。如果您使用 Linux 并将 GPU 与开源驱动程序一起使用，则 Mesa**是**您使用的 OpenGL 实现。这不是选择，这是事实。

它们是完全不同的东西，两者都不能替代另一个。

# sql - SQL 服务器版本 655

> ID：14633867
> 
> 赞同：1
> 
> 时间：2013-01-31T19:43:51.623
> 
> 标签：sql, sql-server-2008

我需要为 sql server 的 vs studio 2010 中的 655 版安装什么更新。谁能告诉我在 vs studio 2010 上使用 sql 创建数据库时我的计算机需要什么？我需要使用 655 版本，因为这是 Uni Computers 上使用的版本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T21:38:14.067

SQL Server 2008 (655) 和 SQL Server 2008 R2 (661) 不是一回事（尽管这是一个常见的误解 - 很多人认为它们是相同的，因为[微软做出了一个糟糕、糟糕、糟糕的命名决定，使2008 R2 听起来像一个服务包](https://sqlblog.org/2011/02/09/is-sql-server-2008-r2-a-full-release-of-sql-server)）。

您不能将 2008 R2 数据库附加/恢复到 2008 实例，期间。虽然有几种解决方法（也适用于附加 2012 -> 2008、2008 -> 2005、2008 R2 -> 2005 等）。您可以将尝试连接的引擎升级到最高 2008 R2，也可以使用生成脚本向导、导入/导出数据向导、SSIS 或 Red Gate SQL 等第 3 方工具从数据库中提取模式/数据比较（有关替代方案的完整列表，[请参阅此博客文章](http://bertrandaaron.wordpress.com/2012/04/20/re-blog-the-cost-of-reinventing-the-wheel/)）。

这种情况经常出现，您是否搜索过“sql server version 661 655”？我想出了一大堆使用这个搜索词和一些细微的变化，都在这个网站和 dba.SE 上：

[将 SQL Server 2008 数据库附加到 SQL Server 2005 失败](https://stackoverflow.com/questions/11778220/failure-attaching-sql-server-2008-database-to-sql-server-2005/11778274#11778274)

[无法将 2008 R2 数据库附加到 2008 实例](https://stackoverflow.com/questions/11143612/cannot-attach-2008-r2-database-to-2008-instance/11143677#11143677)

[数据库还原错误](https://stackoverflow.com/questions/10506397/database-restore-error/10506489#10506489)

[在 SQL Server 2012 中创建数据库，在 2008 年编写和使用？](https://stackoverflow.com/questions/10303791/create-database-in-sql-server-2012-script-and-use-in-2008/10304829#10304829)

[无法在 SQL Server Express 上还原备份](https://stackoverflow.com/questions/12498098/cannot-restore-backup-on-sql-server-express/12498142#12498142)

[如何自动恢复 SQL Server 2008 R2 备份文件](https://stackoverflow.com/questions/14503533/how-to-automatically-restore-a-sql-server-2008-r2-backup-file/14503602#14503602)

[附加 .mdf 文件时，数据库“无法打开，因为它是 661 版”](https://stackoverflow.com/questions/12151705/cannot-be-opened-because-it-is-version-661)

[在 SQL Server 2008 中使用数据库 661 版本](https://stackoverflow.com/questions/12277316/use-database-661-version-with-sql-server-2008)

[SQL Server：附加不正确的版本 661](https://stackoverflow.com/questions/4257684/sql-server-attach-incorrect-version-661)

[https://dba.stackexchange.com/questions/21525/restoreing-an-sql-server-2012-mdf-to-sql-server-2008](https://dba.stackexchange.com/questions/21525/restoring-an-sql-server-2012-mdf-to-sql-server-2008)

[https://dba.stackexchange.com/questions/20588/restore-sql-server-2012-backup-to-a-sql-server-2008-database](https://dba.stackexchange.com/questions/20588/restore-sql-server-2012-backup-to-a-sql-server-2008-database)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:51:38.840

如果您在 Visual Studio 2010 中开发基于 .NET 的应用程序，那么它们通常会支持所有版本的 Microsoft SQL Server。这并不意味着您在 Visual Studio 的内部安装 SQL Server，只是您可以连接到在某处运行的 SQL Server 实例。

如果您问“我在哪里可以获得我的大学正在使用的 SQL Server 的副本？”，这取决于。对于开发，您可以在本地计算机上使用与 SQL 的主要版本（2005、2008、2008R2、2012）匹配的[SQL Express](http://www.microsoft.com/en-us/sqlserver/editions/2012-editions/express.aspx)安装，或者您可以请求大学（或其他人）授予您对现有 SQL 实例的访问权限.

# ruby-on-rails - 如何在 Ruby 中将数组转换为嵌套数组以填充选择框？

> ID：14633870
> 
> 赞同：0
> 
> 时间：2013-01-31T19:44:12.270
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我怎样才能转换这个数组

```
['h', 'b'] 
```

进入这个数组

```
[['Home', 'h'], ['Business', 'b']] 
```

在红宝石？

我需要这个来填充一个选择框，其中包含保存在数据库中的值。

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:55:30.393

你的问题不清楚。假设你有两个数组。你可以像下面这样

```
 x=[1,2]  => [1, 2] 
    y=["a","b"]  => ["a", "b"] 

    x.zip y   => [[1, "a"], [2, "b"]] 
```

# asp.net-mvc-3 - 创建新输入元素时，动态添加的输入元素不会保留输入的数据

> ID：14633873
> 
> 赞同：1
> 
> 时间：2013-01-31T19:44:19.447
> 
> 标签：asp.net-mvc-3, jquery, partial-views

我创建了一个测试应用程序来了解有关 asp.net mvc 的更多信息。该应用程序应该允许用户使用部分视图和编辑器模板通过 jQuery 添加“无限”数量的输入。我已经设法添加了新的输入元素，但是在添加较新的输入元素时，我在保留用户输入的数据时遇到了问题。

**我的强类型视图**

```
@model TestApp.Models.ItemViewModel
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <div class="editor-label">
        @Html.LabelFor(model => model.ItemName)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.ItemName)
        @Html.ValidationMessageFor(model => model.ItemName)

    </div>
    <div class="editor-label">
        Click to add rates
    </div>
    <div class="editor-field">
        <a href="#" id="NewRate">Add Rate</a>
        <input type="hidden" value="0" id="rateCounter" />
    </div>
    <br />
    <span id="itemRates"></span>
    <p>
        <input type="submit" value="Save" />
    </p>
} 
```

**我的 javascript** 当用户点击上面的`NewRate`元素时，我会触发这个 jQuery 来获取局部视图。我还通过一个隐藏元素跟踪用户创建的行数，`rateCounter`每次`click`事件触发时我都会增加该元素。

```
$("#NewRate").click(function () {
    var count = parseInt($("#rateCounter").val());
    $("#rateCounter").val(count + 1);
    $.ajax({
        type: 'GET',
        url: '/Item/AddRate',
        data: {
            rateCount: $("#rateCounter").val()
        },
        success: function (data) {
            $('#itemRates').html(data);
        }
    });
}); 
```

**我的控制器** 这接受要创建的行数并传递给局部视图。

```
public PartialViewResult AddRate(int rateCount)
{
    var itemVM = new ItemViewModel { Rates = new List<ItemRatesViewModel>() };
    for (int i = 0; i < RateCount; i++)
    {
        itemVM.Rates.Add(new ItemRatesViewModel());
    }            

    return PartialView("_ItemRates", itemVM);
} 
```

**我的强类型部分视图** 部分视图只使用了一个编辑器模板

```
@model TestApp.Models.ItemViewModel
@Html.EditorFor(model => model.Rates) 
```

**我** 的编辑器模板编辑器模板基本上显示每个速率

```
@model TestApp.Models.ItemRatesViewModel
<tr>
    <td>
        @Html.EditorFor(model => model.Rate)
        @Html.ValidationMessageFor(model => model.Rate)
    </td>
    <td>
        @Html.EditorFor(model => model.StartDate)
        @Html.ValidationMessageFor(model => model.StartDate)
    </td>
    <td>
        @Html.EditorFor(model => model.EndDate)
        @Html.ValidationMessageFor(model => model.EndDate)
    </td>
</tr> 
```

**在第一次点击** 使用谷歌浏览器的开发者工具时，我看到响应是这样的。这应该是正确的。当我提交表单时，模型绑定器会拾取输入的数据。

```
<tr>
    <td>
        <input class="text-box single-line" data-val="true" data-val-number="The field Rate must be a number." data-val-required="*" id="Rates_0__Rate" name="Rates[0].Rate" type="text" value="0.00" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].Rate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__StartDate" name="Rates[0].StartDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].StartDate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__EndDate" name="Rates[0].EndDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].EndDate" data-valmsg-replace="true"></span>
    </td>
</tr> 
```

**在第二次单击** 时，第一组输入元素（索引`[0]`）上输入的数据被丢弃并替换为新初始化的数据，因为我`$('#itemRates').html(data);`在我的 javascript 中使用而不是`$('#itemRates').append(data);`. 下面是我得到的。当我提交表单时，模型绑定器`Rates`会在视图模型的集合中正确获取输入的数据。

```
<tr>
    <td>
        <input class="text-box single-line" data-val="true" data-val-number="The field Rate must be a number." data-val-required="*" id="Rates_0__Rate" name="Rates[0].Rate" type="text" value="0.00" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].Rate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__StartDate" name="Rates[0].StartDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].StartDate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__EndDate" name="Rates[0].EndDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[0].EndDate" data-valmsg-replace="true"></span>
    </td>
</tr>

<tr>
    <td>
        <input class="text-box single-line" data-val="true" data-val-number="The field Rate must be a number." data-val-required="*" id="Rates_1__Rate" name="Rates[1].Rate" type="text" value="0.00" />
        <span class="field-validation-valid" data-valmsg-for="Rates[1].Rate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__StartDate" name="Rates[1].StartDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[1].StartDate" data-valmsg-replace="true"></span>
    </td>
    <td>
        <input data-datepicker-future="True" data-val="true" data-val-required="*" id="Rates_0__EndDate" name="Rates[1].EndDate" type="text" value="01/01/0001" />
        <span class="field-validation-valid" data-valmsg-for="Rates[1].EndDate" data-valmsg-replace="true"></span>
    </td>
</tr> 
```

**最后，我的问题** 有没有办法`[1]`在生成的响应中只获取第二行（索引）然后使用 jQuery`append`而不是用新行替换整个`html`行？这样做的正确方法是什么？我知道我很接近，但一点指导会大有帮助。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T04:02:53.013

我可能不会回到服务器并以这种方式获取所有行的整个视图。

一旦发布表单，MVC 解析发送的数据的方式是返回的元素数组（由元素的 name 属性中 [] 括号中的数字指定。

我过去的做法是通过 jquery 克隆行并使用正则表达式函数将 [0] 替换为 [1] 并清除值。然后只需附加它。

这也将使您不必在每次单击添加时都调用服务器。

# android - 在 CouchDB 上实施访问控制

> ID：14633879
> 
> 赞同：0
> 
> 时间：2013-01-31T19:44:34.560
> 
> 标签：android, mobile, couchdb, replication, touchdb

我一直在研究 CouchDB 和 TouchDB 一段时间，并认真考虑它们是否适合我心目中的移动应用程序。我有几个问题，如果有人能指出我正确的方向，我将不胜感激。场景是我有 2 个在 TouchDB 上运行的移动客户端。我希望移动客户端 A 能够将特定文档复制到移动客户端 B。然后我希望移动客户端 B 能够进行更改并将这些更改同步回移动客户端 A。从架构的角度来看，我认为我需要一个集中的 couchdb 数据库，两个客户端都可以拉/推。我遇到的问题是如何确保客户 B 只能复制他被授权复制的文档。我知道我可以使用复制过滤器来限制复制的文档，但是如何在移动客户端 B 上强制执行它？此外，上述场景的理想架构是什么？任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:01:29.650

我在 EC2（集中式数据库）中使用 TouchDB 和 BigCouch 进​​行了类似的设置。让推动和拉动正常工作可能是一次冒险。=)

我认为您在使用带有拉取功能的复制过滤器方面走在了正确的轨道上。如果您使用复制过滤器限制客户端 B 的拉取，您的生活很可能会更轻松，因为客户端 B 可以修改其本地 TouchDB 上的任何内容，并且不会造成任何伤害。

换句话说，不要复制您不希望客户端 B 修改的文档。

为此，您必须在文档中引入一个指定访问级别的字段 - 或者某个数组可能包含客户端 B 的用户 ID。这样他只能看到他有权看到的东西。

在我忘记之前有两个注意事项：a）Android 上的 TouchDB 目前还很粗略。他们正在努力让它变得更好，但它落后于 iOS 版本。b) 我强烈建议考虑用 Erlang 编写你的复制过滤器。这样做我的速度提高了 50%。

# c# - MetadataException：连接字符串

> ID：14633883
> 
> 赞同：0
> 
> 时间：2013-01-31T19:44:51.420
> 
> 标签：c#, .net, connection-string, edmx

我意识到这个问题在此之前已经被问过并解决了很多次，并且有很多有用的帖子，比如这个...... [http://blogs.teamb.com/craigstuntz/2010/08/13/38628/](http://blogs.teamb.com/craigstuntz/2010/08/13/38628/) 但不幸的是没有任何建议对我有用，所以我发帖是希望有人能发现我没见过的东西。

我有一个数据库项目 Sp_CodeGenerator - 我已连接到数据库。我的连接字符串是

`<add name="AdWorksLTEntities" connectionString="metadata=res://*/Sp_CodeGenerator.Model1.csdl|res://*/Sp_CodeGenerator.Model1.ssdl|res://*/Sp_CodeGenerator.Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=EIRCOM;Initial Catalog=AdventureWorksLT2008R2;Integrated Security=True;MultipleActiveResultSets=True;Application Name=EntityFramework&quot;" providerName="System.Data.EntityClient"/>`

我试过`//*/Sp_CodeGenerator.Model...`用 dll`//Sp_CodeGenerator/Sp_CodeGenerator.Model.csdl`等的名称替换，但它不起作用。

我还删除了 .config 文件中的所有引用，删除了 .edmx 文件和实体框架生成的模板文件并多次启动，但它不起作用。

我可以在我的目录结构中看到 edmx 文件：Model1.csdl、Model1.msl、Model1.ssdl 位于名为 edmxResourcesToEmbed 的文件夹中，它们可以在 C:\Sp_CodeGenerator\Sp_CodeGenerator\obj\x86 中找到

所以完整路径是 C:\Sp_CodeGenerator\Sp_CodeGenerator\obj\x86\Debug\edmxResourcesToEmbed

我不确定这是否是巧合，但是一旦出现问题，我还注意到，一旦我打开 .config 文件，我就会收到几条关于元素 'entityFramework' 'defaultconnectionFactory' 'type' 等缺少架构的消息。

任何关于下一步看哪里的建议，非常感谢。

MetadataException 上的完整堆栈跟踪是

```
 at System.Data.Metadata.Edm.MetadataArtifactLoaderResource.LoadResource()
  at System.Data.Metadata.Edm.MetadataArtifactLoaderResource.CreateReader()
  at System.Data.Metadata.Edm.MetadataArtifactLoaderResource.CreateReaders(DataSpace        spaceToGet)
   at System.Data.Metadata.Edm.MetadataArtifactLoaderComposite.CreateReaders(DataSpace  spaceToGet)
   at System.Data.Metadata.Edm.MetadataCache.EdmMetadataEntry.LoadEdmItemCollection(MetadataArtifactLoader loader)
   at System.Data.Metadata.Edm.MetadataCache.EdmItemCollectionLoader.LoadItemCollection(EdmMetadataEntry entry)
  at System.Data.Metadata.Edm.MetadataCache.LoadItemCollection[T](IItemCollectionLoader`1 itemCollectionLoader, T entry)
  at System.Data.Metadata.Edm.MetadataCache.GetOrCreateEdmItemCollection(String cacheKey, MetadataArtifactLoader loader, Object& entryToken)
  at System.Data.EntityClient.EntityConnection.LoadEdmItemCollection(MetadataWorkspace workspace, MetadataArtifactLoader artifactLoader)
  at System.Data.EntityClient.EntityConnection.GetMetadataWorkspace(Boolean initializeAllCollections)
  at System.Data.Objects.ObjectContext.RetrieveMetadataWorkspaceFromConnection()
  at System.Data.Objects.ObjectContext..ctor(EntityConnection connection, Boolean isConnectionConstructor)
  at System.Data.Objects.ObjectContext..ctor(EntityConnection connection)
  at System.Data.Entity.Internal.InternalConnection.CreateObjectContextFromConnectionModel()
  at System.Data.Entity.Internal.LazyInternalConnection.CreateObjectContextFromConnectionModel()
  at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
  at System.Data.Entity.Internal.InternalContext.Initialize()
  at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)
  at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()
  at System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext()
  at System.Data.Entity.Infrastructure.DbQuery`1.System.Linq.IQueryable.get_Provider()
  at System.Linq.Queryable.OrderBy[TSource,TKey](IQueryable`1 source, Expression`1 keySelector)
  at Sp_CodeGenerator.SelectAll.SelectAll_Method() in    C:\Sp_CodeGenerator\Sp_CodeGenerator\Templates\dbo.SelectAll.StoredProcedure.sql.xml.cs:line 14
  at Sp_CodeGenerator.Program.Main(String[] args) in C:\Sp_CodeGenerator\Sp_CodeGenerator\Program.cs:line 15
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
  at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
  at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
  at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
  at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
  at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
  at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
  at System.Threading.ThreadHelper.ThreadStart() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:06:51.290

我找到了解决方案 - 我只需要删除 Sp_CodeGenerator。从连接字符串中的每个 Model1 开始。不太确定为什么首先会生成这样的连接字符串？也许与我的目录结构有关？

# c# - 如何获取颁发者证书的指纹或公钥？

> ID：14633889
> 
> 赞同：10
> 
> 时间：2013-01-31T19:45:12.620
> 
> 标签：c#, .net, ssl, ssl-certificate

我们创建了一个自签名 CA 证书，我们用它来签署其他证书以用于 SSL 目的。这些证书将安装在我们无法访问的其他服务器中，并且将严格与移动应用程序等其他客户端进行通信。

当这些客户端（用 .NET 编写）使用 HTTPS 向服务器发出请求时，我们会收到“从服务器收到的无效证书”错误，因为 CA 证书不是该客户端上的受信任 CA。

我们想使用 绕过这种安全性`ServicePointManager.ServerCertificateValidationCallback`，但前提是所使用的证书是由我们的 CA 证书签名的。

我可以检查`certificate.Issuer`，但这很容易被任何人欺骗。如何获取无效证书的颁发者证书的指纹或公钥？如果我可以访问它，我可以轻松地将它与我知道的有效的进行比较，并忽略证书错误并继续请求。

**更新**

我想我越来越近了。看起来我们想要做的事情是不可行的，所以方向略有不同。

使用`X509Chain`下面的代码，我们可以验证证书是否是 CA 的子证书：

```
var caCert = new X509Certificate2(@"[path]\MyCA.cer");

var newChain = new X509Chain();
newChain.ChainPolicy.RevocationMode = X509RevocationMode.NoCheck;
newChain.ChainPolicy.ExtraStore.Add(caCert);

var res = newChain.Build(certInQuestion); 
```

`Build()`仍然返回 false （正如预期的那样，因为 CA 在客户端上不受信任），但现在`newChain.ChainStatus[0].Status`正在返回`UntrustedRoot`. 根据我的测试，这意味着链经过验证，因为如果我提供不同的 CA 证书，它会以`InvalidChain`.

总之，这告诉我，如果 Status 是`UntrustedRoot`，则证书*是*使用我们的 CA 证书创建的，因此它是有效的，否则它是假的！

我的假设正确吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:16:27.300

我不完全确定这就是您正在寻找的东西，但它可能会将您推向正确的方向。这是我用来查找刚刚使用 MAKECERT.EXE 和 CERTMGR.EXE 创建和提取的证书的 PowerShell 脚本：

```
# get certificate thumbprint
$appCertificate = Get-PfxCertificate -FilePath $certificateFullPath

Write-Host "  .. adding certificate to local machine root" -ForegroundColor Gray 
& $ExeCertManager /add $certificateFullPath /s /r localMachine root
Write-Host "  Certificate installed on local machine" -ForegroundColor Gray 

Write-Host "  .. exporting private key for certificate" -ForegroundColor Gray 
Get-ChildItem cert:\\localmachine\my | Where-Object {$_.Thumbprint -eq $appCertificate.Thumbprint} | ForEach-Object {
    $CertPfxName = (Get-Item -Path $certificateFullPath).BaseName
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:42:56.050

那是错误的解决方案。您应该在所有客户端中将您的自签名证书安装为受信任的 CA 证书，或者最好还是让已受信任的 CA 对其进行签名。不要为此编写代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T20:00:15.020

以下是一些信息链接和一些生成免费公钥和私钥的工具：

[https://www.igolder.com/pgp/](https://www.igolder.com/pgp/)

[https://www.igolder.com/pgp/generate-key/](https://www.igolder.com/pgp/generate-key/)

我认为 EJP 的解决方案是最能接受的。@EJP，您能否给我们一些可以帮助我们成为“微型 CA”的应用程序示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T23:07:58.387

根据以下答案，似乎一个可能的解决方案是您可以通过电子邮件发送证书：[https](https://stackoverflow.com/a/4473799/674700) ://stackoverflow.com/a/4473799/674700 。

# php - 运行脚本时谷歌地图未加载（显示“地图 div”）

> ID：14633890
> 
> 赞同：0
> 
> 时间：2013-01-31T19:45:17.523
> 
> 标签：php, javascript, mysql, google-maps-api-3

我正在尝试将标记放置在 mySQL 数据库中的城市所在的位置。页面加载，但它显示地图应加载的“地图 div”。我不确定出了什么问题。感谢您查看并提供帮助！

```
<script type="text/javascript">

var directionDisplay;
var directionsService = new google.maps.DirectionsService();
var map;

function initialize() {
    directionsDisplay = new google.maps.DirectionsRenderer();

    var mapOptions = {
    zoom: 5,
    mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map_canvas'),
                              mapOptions);
    directionsDisplay.setMap(map);

    //create an array of latitudes, longitudes, and city names
    var markers = [

    <?php

    //orgnize fans by city
    $query = "SELECT city, state, COUNT(*) fans FROM users GROUP BY city ORDER BY fans DESC";
    $result = mysql_query($query) or die(mysql_error());
    while($row = mysql_fetch_array($result)){

    //pulls the city, state code from the database and stores it as a string in $address
    $address = urlencode('"' . $row['city'] . ", " . $row['state'] . '"');
    $googleApi = 'http://maps.googleapis.com/maps/api/geocode/json?address=%s&sensor=false';     

    $json = file_get_contents(sprintf($googleApi, $address));   
    $resultObject = json_decode($json);

    $location = $resultObject->results[0]->geometry->location;

    $lat = $location->lat;
    $lng = $location->lng;

        echo "{ lat: ".$lat.", lng: ".$lng.", name: ".'"'.$row['city'].", ".$row['state'].'"'."},";
    }

    ?>

    ];

    // Create the markers ad infowindows.
    for (index in markers) addMarker(markers[index]);
    function addMarker(data) {
        // Create the marker
        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(data.lat, data.lng),
            map: map,
            title: data.name
        });

        // Create the infowindow with two DIV placeholders
        // One for a text string, the other for the StreetView panorama.
        var content = document.createElement("DIV");
        var title = document.createElement("DIV");
        title.innerHTML = data.name;
        content.appendChild(title);
        var streetview = document.createElement("DIV");
        streetview.style.width = "200px";
        streetview.style.height = "200px";
        content.appendChild(streetview);
        var infowindow = new google.maps.InfoWindow({
            content: content
        });

        // Open the infowindow on marker click
        google.maps.event.addListener(marker, "click", function() {
            infowindow.open(map, marker);
        });

        // Handle the DOM ready event to create the StreetView panorama
        // as it can only be created once the DIV inside the infowindow is loaded in the DOM.
        google.maps.event.addListenerOnce(infowindow, "domready", function() {
            var panorama = new google.maps.StreetViewPanorama(streetview, {
            navigationControl: false,
            enableCloseButton: false,
            addressControl: false,
            linksControl: false,
            visible: true,
            position: marker.getPosition()
            });
       });

    }

    // Try HTML5 geolocation
    if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var pos = new google.maps.LatLng(position.coords.latitude,
            position.coords.longitude);

            var infowindow = new google.maps.InfoWindow({
            map: map,
            position: pos,
            content: 'Your Current City'
        });

            map.setCenter(pos);
        }, function() {
        handleNoGeolocation(true);
        });

    } else {
        // Browser doesn't support Geolocation
        handleNoGeolocation(false);
    }

}

function handleNoGeolocation(errorFlag) {
    if (errorFlag) {
        var content = 'Error: The Geolocation service failed.';
    } else {
        var content = 'Error: Your browser doesn\'t support geolocation.';
    }

    var options = {
    map: map,
    position: new google.maps.LatLng(60, 105),
    content: content
    };

    var infowindow = new google.maps.InfoWindow(options);
    map.setCenter(options.position);
}

function calcRoute() {
    var start = document.getElementById('start').value;
    var end = document.getElementById('end').value;
    var waypts = [];
    var checkboxArray = document.getElementById('waypoints');
    for (var i = 0; i < checkboxArray.length; i++) {
        if (checkboxArray.options[i].selected == true) {
            waypts.push({
                        location:checkboxArray[i].value,
                        stopover:true});
        }
    }

    var request = {
    origin: start,
    destination: end,
    waypoints: waypts,
    optimizeWaypoints: true,
    travelMode: google.maps.DirectionsTravelMode.DRIVING
    };
    directionsService.route(request, function(response, status) {
                            if (status == google.maps.DirectionsStatus.OK) {
                            directionsDisplay.setDirections(response);
                            var route = response.routes[0];
                            var summaryPanel = document.getElementById('directions_panel');
                            summaryPanel.innerHTML = '';
                            // For each route, display summary information.
                            for (var i = 0; i < route.legs.length; i++) {
                            var routeSegment = i + 1;
                            summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment + '</b><br>';
                            summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                            summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
                            summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';
                            }
                            }
                            });
}

google.maps.event.addDomListener(window, 'load', initialize);

</script> 
```

当我打开 html 时，我调用初始化并制作画布：

```
<body onload="initialize()">

<div id="map_canvas" style="width: 1100px; height: 450px;">map div</div> 
```

# objective-c - 使用框架语法引用非框架标头

> ID：14633891
> 
> 赞同：2
> 
> 时间：2013-01-31T19:45:18.820
> 
> 标签：objective-c

我有构建到框架中的代码。在调试依赖于框架的其他项目代码时，将源代码直接构建到其他项目中有时很有用。唯一的问题是引用标题的方式：

```
// Framework
#import <my_framework/my_widget.h>

// Source
#import "my_widget.h" 
```

我可以进行大量编辑并继续前进，但我觉得必须有一个聪明的解决方案，也许与为框架​​搜索路径设置一些东西有关。

我很好奇在 Xcode 中这样做，尽管原始命令也很有用。

**更新**

尽管有一些明智的建议，但我无法让它发挥作用，所以更明确的帮助会很棒（希望对其他人有帮助）。

```
// My framework source directory
/work/my_framework_project/source/widgets/my_widget.h
/work/my_framework_project/source/widgets/my_widget.m

// The framework that creates
/work/my_framework.framework/my_framework
/work/my_framework.framework/Headers/my_widget.h

// The project I'm debugging
/work/some_project/source/my_source.m 
```

如果我将框架放到 some_project 中，我会这样引用我的标题：

```
#import <my_framework/my_widget.h> 
```

如果我删除对框架的引用并将源添加到项目中，我需要这样做，但不想：

```
#import "my_widget.h" 
```

请注意，我不导入`"my_framework/my_widget.h"`- 如果这很重要。

如果我遵循第一个建议的答案，那么我在编译它们时将其作为标志添加到源文件中（目前通过将其添加到“编译源”区域中。

```
-I/work/my_framework.framework/Headers 
```

这并没有解决想要使用框架表示法引用导入的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:56:35.240

> 尽管原始命令也很有用

这里是：

```
<COMPILER> -Imy_framework_dir <other options...> 
```

因此，您`-I`为此使用（大写“i”）标志（GCC 或 Clang 样式）。

Xcode 使用项目的“构建阶段 -> 编译”选项卡上的“用户搜索标题路径”部分支持此功能。

# ruby-on-rails - Rails Spree 内部结构

> ID：14633892
> 
> 赞同：1
> 
> 时间：2013-01-31T19:45:19.303
> 
> 标签：ruby-on-rails, spree

我正在尝试将 Spree 与我的 RoR 应用程序一起使用。好的，当我想定制一些东西时，我确实会遵循官方网站上的所有这些指南和常见问题解答。没关系，没有问题。一个问题，我找不到线索——这怎么可能，在应用程序/视图、应用程序/模型文件夹中没有任何内容，但它仍然有效？我的意思是，是的，我可以在这些文件夹中创建一些东西并重新定义我的视图的行为（实际上，这是自定义的方式之一），但我真的很想了解内部结构。我对 Rails 很陌生，习惯了经典的`app`文件夹结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:54:28.117

您想知道的是 Rails 引擎的魔力。

Ruby on Rails 允许您定义引擎（您的应用程序也是其中之一），当它查找视图/控制器/等时，所有已安装的引擎都是搜索路径的一部分。

因此，该视图位于 Spree 宝石内部，您看不到 - 但它仍然看起来在那里。如果您在视图文件夹中放置同名的内容，它将优先于您在 Gem 中的 Rails 引擎中的视图。

这是关于引擎如何在 Rails 中工作的一个很好的指南：

[http://edgeguides.rubyonrails.org/engines.html](http://edgeguides.rubyonrails.org/engines.html)

这些引擎的一个很好的例子是您可能在应用程序中使用的 jQuery-rails Gem。它根本没有代码（除了一些没有资产管道的 Rails 3.0 及以下版本的后备），而是 app/assets/javascripts 文件夹中的 jQuery.js 文件。而且由于引擎位于加载路径中，您可以要求其中的资产。引擎本身具有与您的应用程序相同的文件夹结构（`app/views`，`app/controllers`...）

您可以在这里查看 Spree 的内部结构：[https ://github.com/spree/spree/tree/master/core/app](https://github.com/spree/spree/tree/master/core/app)

# jquery - 什么是另一个页面上默认选项卡的更清洁方法？

> ID：14633896
> 
> 赞同：1
> 
> 时间：2013-01-31T19:45:33.063
> 
> 标签：jquery, asp.net-mvc-3

使用 MVC 3：我有一个摘要页面，其中列出了没有问题的部分以及每个部分回答了多少。我想为每个部分添加超链接，以便用户返回到任何不完整的部分？示例（页面：问题/摘要）：

```
<div><a href="question/quiz#1">Section 1</a></div><div>Total Questions: 10</div><div>Answered questions: 8</div>
<div><a href="question/quiz#2">Section 2</a></div><div>Total Questions: 10</div><div>Answered questions: 9</div> 
```

**使用 Request.Querystring(x)、anchor 或其他方法从 url 中获取 section id 是个好主意吗？**

上一页的 jquery 片段（和伪代码）是这样的：

```
 i = @Request.QueryString("id");
 selectStep(i);

 function selectStep(i) {
                // menu nav
                $("#steps a").removeClass("current");
                $("#stepDesc" + i).addClass("current");
                $("#currentstep").val("#step" + (i));

                // display prev and next button
                if (i == 0) {
                    $("#Next").show();
                    $("#Previous").hide();
                }
                else if (i == count - 1) {
                    $("#Next").hide();
                    $("#Previous").show();
                }
                else {
                    $("#Next").show();
                    $("#Previous").show();
                }
            } 
```

**选择 Step 函数将显示或隐藏特定部分的 div。解决这个问题的最佳方法是什么？**

# facebook - 使用 Facebook 验证 chrome 扩展

> ID：14633899
> 
> 赞同：5
> 
> 时间：2013-01-31T19:45:44.353
> 
> 标签：facebook, google-chrome-extension

我的扩展需要定期向服务器发送一些数据（在后台），其中包含来自 FB 的用户的身份验证信息。所以我显然需要发送带有数据的 FB 令牌。

现在我`https://www.facebook.com/dialog/oauth?client_id=<APP_ID>&response_type=token&redirect_uri=http://www.facebook.com/connect/login_success.html`在一个新选项卡中打开，然后从哈希中检索一个令牌（使用背景页面），然后将它存储在 localStorage 中。

但是假设用户关闭他的浏览器并在令牌过期后打开它。我应该如何在没有用户进行大量额外点击的情况下检索新的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:24:40.203

我建议您应该通过您的服务器[请求长期令牌](https://developers.facebook.com/docs/howtos/login/extending-tokens/)并将其与计算的到期时间一起存储，您可以从本地存储中的[令牌调试 API获得。](http://developers.facebook.com/docs/howtos/login/debugging-access-tokens/)然后在令牌过期之前刷新令牌以避免重新身份验证。

# chm - CHM 编译正常，但无法打开

> ID：14633901
> 
> 赞同：2
> 
> 时间：2013-01-31T19:45:46.837
> 
> 标签：chm, html-help-workshop

我使用的程序可以从我的数据库中生成包含数据的 HTML 和 hhp 项目。然后，我使用 Microsoft HTML Help Compiler (hhc.exe) 编译该 hhp。

它运行良好，但不幸的是，对于少数项目，hhc 编译良好，但 chm 文件无法使用。它报告“无法打开文件：mk:@MSITStore‎: FileName”

我系统上的其他 chm 文件没有问题。我编译的其他 chm 没有问题。如果我从我的项目中删除几个主题，生成的文件会再次工作。我删除什么主题并不重要。不工作的文件几乎是工作文件大小的两倍，即使 html 和项目文件几乎相同（更改很少），这让我认为如果某些文件的大小或结构不存在，压缩会静默失败对。

有没有人有这样的经历，可能是什么原因？对于那些想要查看示例的人，这个项目将编译并正常工作：

[工作 chm 项目](http://depositfiles.com/files/8thcqeiz7)

而这个编译但无法打开：

[失败的 Chm](http://depositfiles.com/files/vfrqki2gh)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-07-08T21:38:16.427

我遇到了同样的问题。CHM 是通常大小的两倍，无法打开。CHM 编译器没有报告任何错误。删除任何随机 HTML 文件启用打开 CHM。我在同一天生成了许多其他的 CHM，其他的都没有问题。

我通过以下方式解决了这个问题：

1.  我在项目中添加了一个非常小的 HTML 文件。它是项目中其他文件之一的副本，因此如果用户在搜索中找到它，它不会造成任何伤害。
2.  我在 HHP 中输​​入了文件名。
3.  我在 CHM 编译器中重新编译了项目。

CHM 缩小到正常大小，正常打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T12:15:16.550

我遇到了完全相同的问题，可以说这完全是大小问题，很可能是**hhc 的压缩模块中的错误**。

当我添加几行文档时，CHM 文件的大小从 1.6 MB 增加到 3.1 MB，并且无法再打开。

**这个问题不仅可以通过删除文件来解决，也可以通过添加文件来解决。**

所以我写了一些额外的文档，将它添加到项目中，一切都很好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:34:04.633

我在输入中看到 0 字节文件？也许编译器无法处理？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T16:49:33.140

MS HH 编译器崩溃的原因有很多。

(1) 无效的文件名文件和文件 HTML 帮助编译器不喜欢某些文件名，例如文件名中的空格仍然会导致 HTML 帮助出现一些小问题。最好用下划线替换空格。避免在文件和文件夹名称中使用“#”。尝试并坚持使用这些字符 _、a..z、A..Z、0..9。

请勿在正常文件扩展名中使用句点。示例：诸如 xxx.h001.gif 之类的文件名被错误地识别为 HTML 文件。然后编译器尝试解析二进制文件并崩溃。不要使用包含“.chm”的文件或文件夹名称。

(2) 避免在网络驱动器上编译，尽量在本地驱动器上编译。

(3) 使用 MJ 的 Help Diagnostics 确保所有帮助查看器组件均已正确安装和注册。

[http://helpware.net/downloads/#MJs](http://helpware.net/downloads/#MJs)

(4) 删除文件“hh.dat”，您应该在此子目录中找到该文件：

\Documents and Settings\%username%\Application Data\Microsoft\HTML 帮助

此文件存储有关系统上所有 HTML 帮助文件的信息（收藏夹、窗口大小和位置等），如果文件以某种方式损坏，可能会导致文件行为异常。

(5) 你需要调试你的帮助系统。您需要识别导致编译器崩溃的文件。

我通常通过重命名或移动文件夹和文件来删除 Web 的某些部分，然后重新编译。继续添加和删除部分，直到编译器不崩溃。最终，您会发现一两个导致问题的文件。您可能还需要通过临时删除 HTML 文件的部分来调试这些文件。

# regex - EditPad：使用 RegEx 反向引用查找和替换

> ID：14633902
> 
> 赞同：1
> 
> 时间：2013-01-31T19:45:47.637
> 
> 标签：regex, replace, backreference, editpad

我再次尝试使用正则表达式。特别是，在 EditPad 文本编辑器的替换字符串中使用反向引用找到的文本。

**学科：**

> Product1 描述,12 PIN,A 级数量价格
> Product2 描述,28 PIN,A 级数量价格

**目标：**
由于文本当前是空格分隔的，我需要`12 PIN`用`12||PIN`和`28 PIN`替换`28||PIN`。

**我正在尝试什么：**
`[(0-9)]+[(\s)]PIN`似乎找到了我想要的东西就好了。
但是，当我尝试用反向引用替换时，我唯一可以开始工作的是`\0`.
例如，使用`\0||PIN`as my replace 给了我`12 PIN||PIN`.
但是，当我尝试用 替换时`\1||PIN`，它给出了`||PIN`.

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:40:56.910

我可以发誓我看到以前的海报回答了这个......

使用它作为你的查找字符串：

```
([0-9]+)[\s]*PIN 
```

这作为您的替换字符串：

```
\1||PIN 
```

应该这样做。

# ruby - 如何使用 Ruby Savon 正确调用 Magento SOAP API 以获取类别产品链接？

> ID：14633904
> 
> 赞同：3
> 
> 时间：2013-01-31T19:45:55.723
> 
> 标签：ruby, magento, soap, savon

我正在尝试使用[Savon](https://github.com/savonrb/savon)`catalog_product_link.list`调用API 方法。但是，我一直收到错误消息。`Error cannot find parameter`

这是我正在使用的，尽管我已经尝试了几种调用变体，但仍然无法正确通过：

```
client = Savon.client(wsdl: 'http://localhost/index.php/api/soap/?wsdl')
response = client.call(:login){message(username: 'user', apiKey: 'key')}
session = response.body[:login_response][:login_return]

#These all do not work
client.call(:call){message(:session => session, :method => 'catalog_product_link.list', :type => 'up_sell', :productId => '166')}
client.call(:call){message(:session => session, :method => 'catalog_product_link.list', :type => 'up_sell', :product => '166')}
client.call(:call){message(:sessionId => session, :resourcePath => 'catalog_product_link.list', :args => {:type => 'up_sell', :product => '166'})}
client.call(:call){message(:sessionId => session, :resourcePath => 'catalog_product_link.list', :args => {:type => 'up_sell', :productId => '166'})}
client.call(:call){message(:sessionId => session, :resourcePath => 'catalog_product_link.list', :arguments => {:type => 'up_sell', :product => '166'})} 
```

有没有不同的格式来让它工作？

**更新**：如果我尝试删除类型参数，它会给出错误`Given invalid link type`，所以看起来它不喜欢关于多个参数的东西。

```
response = client.call(:call){message(:session => session, :method => 'catalog_product_link.list', :product => '166')} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T16:56:15.803

我能够使用 Builder 让它工作：

```
class ServiceRequest
  def initialize(session, type, product)
    @session = session
    @type = type
    @product = product
  end

  def to_s
    builder = Builder::XmlMarkup.new()
    builder.instruct!(:xml, encoding: "UTF-8")

    builder.tag!(
      "env:Envelope",
      "xmlns:env" => "http://schemas.xmlsoap.org/soap/envelope/",
      "xmlns:ns1" => "urn:Magento",
      "xmlns:ns2" => "http://xml.apache.org/xml-soap",
      "xmlns:xsd" => "http://www.w3.org/2001/XMLSchema", 
      "xmlns:xsi" => "http://www.w3.org/2001/XMLSchema-instance"
    ) do |envelope|
      envelope.tag!("env:Body") do |body|
        body.tag!("ns1:call") do |call|
          builder.sessionId(@session, "xsi:type" => "xsd:string")
          builder.resourcePath("catalog_product_link.list", "xsi:type" => "xsd:string")
          builder.args("xsi:type" => "ns2:Map") do |args|
            args.item do |item|
              item.key("type", "xsi:type" => "xsd:string")
              item.value(@type, "xsi:type" => "xsd:string")
            end
            args.item do |item|
              item.key("product", "xsi:type" => "xsd:string")
              item.value(@product, "xsi:type" => "xsd:string")
            end
          end
        end
      end
    end

    builder.target!
  end
end

client.call(:call, xml: ServiceRequest.new(session, 'up_sell', '166').to_s) 
```

感谢@rubiii 的[指导](https://groups.google.com/forum/#!topic/savonrb/Io4b01O5P-c)。

# java - 在JTable上选择一行会自动选择另一个表上的对应行，但它不起作用

> ID：14633909
> 
> 赞同：0
> 
> 时间：2013-01-31T19:46:00.053
> 
> 标签：java, swing, jtable, listselectionlistener

我在选择 JTable 实例上的行时遇到问题。

**这就是我想要的：**
我想要两个相等的表，行中的数据相同。当您在第一个表上选择一行时，例如第三行，我还希望自动选择第二个表上的第三行。我已经通过向 JTable 添加一个`ListSelectionListener`来解决这个问题，该 JTable 更新了一个只保存所选值的类。然后该类使用第一个选定的值触发另一个 JTable。

**我的问题是：**
当用户对其中一张表上的行进行排序时，就会出现我的问题。然后视图会发生变化，但模型中的底层对象不会发生变化，它们的顺序与以前相同。

假设我启动应用程序时表格如下所示：

```
Column_1_header_in_table_1            Column_1_header_in_table_2
   Peter                                    Peter  
   John                                     John
   Steve                                    Steve 
```

在选择第一行时`table 1`（即Peter），则应选择包含Peter的行，该行`table 2`也是第一行。
但是，如果我按下列标题`table 1`以便对列进行排序，那么该表的视图将变为：

```
Column_1_header_in_table_1            Column_1_header_in_table_2
   John                                     Peter  
   Steve                                    John
   Peter                                    Steve 
```

现在，如果我选择**第一**行`table 1`（即 John），`table 2`则将选择第一行（即 Peter）。`table 1`但我希望在上选择与 in 同名的行`table 2`，即第 2 行`table 2`。

有什么方法可以用来解决这个问题吗？

**编辑**

好的，我将尝试用我在没有编辑器的情况下编写的以下代码来描述我的解决方案，所以我可能包含一些错误。但我只想从概念上展示它现在是如何工作的。首先，我完成了 MyTable 实现的这个接口：

```
public interface TableUpdater {
    public void updateTable(int age);
} 
```

PersonH​​older 类只保存最后选择的值，并在从第一个选择新值时触发另一个表。

```
public class PersonHolder {
    private static int age;
    private List<TableUpdater> tables = new ArrayList<>();

    public static void subscribe(TableUpdater table){
         tables.add(table);
    }

    public static void setValue(int value){
        age = value;
        for(TableUpdater table : tables) {
            table.updateTable(age);
        } 
    }
    public static int getValue(){
        return age;
    }
} 
```

然后我们有表本身：

```
public class MyTable extends JTable implements TableUpdater {
    public MyTable {
        table.getSelectionModel().addListSelectionListener(new MySelectionListener());
        PersonHolder.subscribe(this);
    }
...
     @Override
     public void updateTable(int age) {
           this.getSelectionModel().setSelectionInterval(age, age);
     }
     private class MySelectionListener implements ListSelectionListener {
           public void valueChanged(ListSelectionEvent e) {
               Person p = (Person)getValueAt(e.getLastIndex(), 0);
               PersonHolder.setValue(p.getAge());
           }
     }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T19:50:17.163

您应该使用：`javax.swing.JTable.convertRowIndexToModel(int)`将当前选择索引转换为模型索引值，然后在另一个表中，将模型索引转换回视图索引，`javax.swing.JTable.convertRowIndexToView(int)`并将该索引设置为选定行（假设两个表中的模型相同或等效，否则您将不得不根据值进行查找）。

这是我想到的一个例子（我什至改组了两个 JTable 的 baseModel 并在另一个中执行索引查找）：

```
import java.awt.BorderLayout;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.table.AbstractTableModel;

public class TestSortedTable {

    class MyTableModel extends AbstractTableModel {

        private List<Person> baseModel;

        public MyTableModel(List<Person> baseModel) {
            super();
            this.baseModel = new ArrayList<Person>(baseModel);
        }

        @Override
        public int getRowCount() {
            return baseModel.size();
        }

        @Override
        public String getColumnName(int column) {
            switch (column) {
            case 0:
                return "First Name";
            case 1:
                return "Last Name";
            }
            return null;
        }

        @Override
        public int getColumnCount() {
            return 2;
        }

        @Override
        public Object getValueAt(int rowIndex, int columnIndex) {
            switch (columnIndex) {
            case 0:
                return getPersonAtIndex(rowIndex).getFirstName();
            case 1:
                return getPersonAtIndex(rowIndex).getLastName();
            }
            return null;
        }

        public Person getPersonAtIndex(int rowIndex) {
            return baseModel.get(rowIndex);
        }

        public int getIndexOfPerson(Person person) {
            return baseModel.indexOf(person);
        }

    }

    protected void initUI() {
        List<Person> personModel = new ArrayList<TestSortedTable.Person>();
        personModel.add(new Person("John", "Smith"));
        personModel.add(new Person("Peter", "Donoghan"));
        personModel.add(new Person("Amy", "Peterson"));
        personModel.add(new Person("David", "Anderson"));
        JFrame frame = new JFrame(TestSortedTable.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Collections.shuffle(personModel);
        final MyTableModel table1Model = new MyTableModel(personModel);
        final JTable table1 = new JTable(table1Model);
        table1.setAutoCreateRowSorter(true);
        Collections.shuffle(personModel);
        final MyTableModel table2Model = new MyTableModel(personModel);
        final JTable table2 = new JTable(table2Model);
        table2.setAutoCreateRowSorter(true);
        table1.getSelectionModel().addListSelectionListener(new ListSelectionListener() {

            @Override
            public void valueChanged(ListSelectionEvent e) {
                if (e.getValueIsAdjusting()) {
                    return;
                }
                int index = table1.getSelectedRow();
                if (index > -1) {
                    int table1ModelIndex = table1.convertRowIndexToModel(table1.getSelectedRow());
                    Person p = table1Model.getPersonAtIndex(table1ModelIndex);
                    int table2ModelIndex = table2Model.getIndexOfPerson(p);
                    int indexInTable2 = table2.convertRowIndexToView(table2ModelIndex);
                    table2.getSelectionModel().setSelectionInterval(indexInTable2, indexInTable2);
                }
            }
        });
        table2.getSelectionModel().addListSelectionListener(new ListSelectionListener() {

            @Override
            public void valueChanged(ListSelectionEvent e) {
                if (e.getValueIsAdjusting()) {
                    return;
                }
                int index = table2.getSelectedRow();
                if (index > -1) {
                    int table2ModelIndex = table2.convertRowIndexToModel(table2.getSelectedRow());
                    Person p = table2Model.getPersonAtIndex(table2ModelIndex);
                    int table1ModelIndex = table1Model.getIndexOfPerson(p);
                    int indexInTable1 = table1.convertRowIndexToView(table1ModelIndex);
                    table1.getSelectionModel().setSelectionInterval(indexInTable1, indexInTable1);
                }
            }
        });
        frame.add(new JScrollPane(table1), BorderLayout.WEST);
        frame.add(new JScrollPane(table2), BorderLayout.EAST);
        frame.pack();
        frame.setVisible(true);
    }

    public class Person {
        private final String firstName;
        private final String lastName;

        public Person(String firstName, String lastName) {
            this.firstName = firstName;
            this.lastName = lastName;
        }

        public String getFirstName() {
            return firstName;
        }

        public String getLastName() {
            return lastName;
        }
    }

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException,
            UnsupportedLookAndFeelException {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestSortedTable().initUI();
            }
        });
    }

} 
```

# javascript - 点赞按钮，在我的个人资料中发布时，描述被链接链接链接链接替换

> ID：14633911
> 
> 赞同：1
> 
> 时间：2013-01-31T19:46:06.257
> 
> 标签：javascript, facebook, button, share, facebook-like

我有一个网站，并且添加了带有`javascript sdk`.

这是代码

```
<div id="fb-root"></div>
    <script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/it_IT/all.js#xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script> 
```

这是html代码

```
<div class="fb-like" data-href="WEBSITE URL" data-send="true"  data-width="450"data-show-faces="false" data-action="like"> </div> 
```

我还在`og: meta`头部添加了

```
<meta property="og:description" content=" the description of my website" />
<meta property="og:title" content="title" />
<meta property="og:url" content="url"/>
<meta property="og:image" content="pic" />
<meta property="og:type" content="website"/>
<meta property="fb:admins" content="facebook id"/> 
```

问题是这样的：

当我点击我网站上的点赞按钮时，我可以看到所有信息（姓名、图片、描述），但是当我转到 facebook 个人资料时，描述被替换为：

```
Link
Link
Link
Link 
```

我不明白问题出在哪里。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-31T21:22:50.600

我有同样的问题！

我有评论插件和喜欢框。

如果用户没有写任何评论，请在类似框中将其发布到用户活动提要上。但是如果用户写了一些内容，它会在时间轴上加上 4 行“喜欢”：

LinkLinkLinkLink

但是在将鼠标悬停在标题上时，它会显示一个带有正确预览的弹出窗口。

```
<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="it-it" lang="it-it">
<meta property="og:title" content="Il menù dei cuscini"/>
<meta property="og:url" content="http://www.cibbuzz.com/comunicati-stampa/fashion-e-intrattenimento/il-menu-dei-cuscini"/>
<meta property="og:description" content="Dopo i vini e gli oli, negli alberghi arriva la carta dei cuscini Si diffonde negli alberghi di qualità il “menù dei cuscini”, una lista dove..."/>
<meta property="og:type" content="article" />
<meta property="og:image" content="http://www.cibbuzz.com/images/loghi/logo-cibbuzz-portfolio.jpg" />
<meta property="og:site_name" content="Cibbuzz" />
<meta property="fb:app_id" content="130008293680636" />
<meta property="fb:admins" content="1051936195" />

<div id="fb-root"></div>

<div class="fb-like" data-send="false" data-width="100" data-layout="button_count" data-show-faces="true" data-href="http://www.cibbuzz.com/comunicati-stampa/fashion-e-intrattenimento/il-menu-dei-cuscini" data-force_wall="true"></div>

<script type="text/javascript">
(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) {return;}
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/it_IT/all.js#xfbml=1&appId=130008293680636";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script> 
```

这来自 Lint Tool ：

```
Scrape Information

Response Code:  200
Fetched URL:    http://www.cibbuzz.com/comunicati-stampa/fashion-e-intrattenimento/il-menu-dei-cuscini
URL canonico:   http://www.cibbuzz.com/comunicati-stampa/fashion-e-intrattenimento/il-menu-dei-cuscini
Proprietà Oggetto

fb:admins:  Array of length 1
⍾ 1051936195
fb:app_id:  130008293680636
og:url: http://www.cibbuzz.com/comunicati-stampa/fashion-e-intrattenimento/il-menu-dei-cuscini
og:type:    article
og:title:   Il menù dei cuscini
og:image:   
og:description: Dopo i vini e gli oli, negli alberghi arriva la carta dei cuscini Si diffonde negli alberghi di qualità il “menù dei cuscini”, una lista dove...
og:site_name:   Cibbuzz
og:updated_time:    1359667404 
```

# c - 早期查询：将频道列表保存到内存僵尸网络 - 响应

> ID：14633912
> 
> 赞同：0
> 
> 时间：2013-01-31T19:46:11.047
> 
> 标签：c, string, irc

早些时候有人发布了一个关于他们正在为 IRC 开发的机器人的问题。

他们提到，在向服务器发送列出频道的命令时，服务器将回复所有频道的原始数据，并且在该列表的末尾将是`ENDOFLIST`. 他们还表示，他们不知道正在发送的数据的实际长度，也不能完全依赖于这样的函数，`strstr`因为如果用户命名了一个通道`ENDOFLIST`，则字符串将在那里终止。然后他们询问是否有可能确定真实数据何时`ENDOFLIST`出现在他们拥有的原始数据缓冲区中。

我的想法只是遍历数据，直到`ENDOFLIST`找到最后一个实例，然后离开最后一个实例的位置。在我发布答案之前，提出问题的人将其删除，但我仍然想知道我的解决方案是否可行。

这就是我想出的：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/*function I wrote for myself a while back to find substrings*/
int strsbstr(const char *str, const char *sbstr)
{
    char *sbstrlc;

    if(!(strcmp(str, sbstr))) return 0;
    if(!(sbstrlc = strstr(str, sbstr))) return -1;
    return (int) (sbstrlc - str);
}

int main(int argc, char *argv[])
{
    int index = 0, location = 0;
    char *string;

    if(!(string = malloc(37))) return 0x00;
    strcpy(string, "FOOBARENDOFLISTENDOFLISTENDOFLISTFOO");  //string contains "ENDOFLIST" three times
    index = strsbstr(string, "ENDOFLIST");                   //index holds position of first occurence of "ENDOFLIST" within the string
    while(index != -1)                                       //loop through the rest of the string until the final "ENDOFLIST" is found
    {
        location = index + location + strlen("ENDOFLIST");
        index = strsbstr(string + location, "ENDOFLIST");
    }
    /*
    the variable 'location' now holds the position of the final char of the last occurence of "ENDOFLIST" within the string
    and 'location - strlen("ENDOFLIST")' would yield the position of the first char of the last occurence of "ENDOFLIST" 
    within the string
    */
    free(string);
    return 0;
} 
```

我敢肯定，许多经常访问`C`本网站部分的人今天早些时候都看过这篇文章。我只是想获得一些意见，如果这可以解决提问者遇到的问题，并且它是否可行。

即使实际上考虑它，我几乎 100% 肯定 IRC 通道无论如何不能具有相同的名称，因此甚至可能不需要循环。它应该只需要在第一次之后再次检查字符串中是否出现“ENDOFLIST”吗？

# sql - 授予 SQL 作业权限，以便能够访问/修改不同服务器上的文件夹和文件

> ID：14633916
> 
> 赞同：3
> 
> 时间：2013-01-31T19:47:10.690
> 
> 标签：sql, tsql, permissions

我在 SERVER01 上有一个 sql 作业。

部分工作是访问位于不同服务器上的文件夹：

\\SERVER02\文件

我需要能够在其下创建文件夹和文件以及修改/删除文件。

\\SERVER02\Files 文件夹与几个不同的帐户共享。

如果我去 SERVER02 并尝试 UNC 路径到 \\SERVER02\Files，它会要求输入密码。

由于服务器位于两个不同的域中，因此我需要为帐户指定域：

域\帐户名

密码

问题：

我设置它的正确方法是什么，以便作业可以访问另一台服务器，以便它可以操作 \\SERVER02\Files 中的文件？

这很令人困惑，所以我试图把它弄好。任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:57:55.307

我们在自己的环境中也有同样的问题，因为我们有两个必须共享资源的域。技术上正确的解决方案是在两个域之间建立信任，以便跨域映射用户登录。如果您像我们一样无法设置域信任，您可以尝试以下一些解决方案：

1.  以运行 SQL 作业的帐户登录`SERVER01`，并使用[凭据管理器](http://msdn.microsoft.com/en-us/library/ms918995.aspx)`SERVER02`使用其他域的用户/密码创建登录。
2.  在 SQL 作业运行的帐户下，使用嵌入的凭据创建到 UNC 路径的网络共享：`NET USE M: \\SERVER02\Files [password] /user:[domain\user]`. 您必须确保在作业运行之前始终映射此路径，并`M:`用于您的路径。
3.  如果您需要运行访问网络路径的特定进程/命令，则可以启动该特定进程以使用`runas`第二个域的凭据进行身份验证：`runas /netonly /user:[domain\user] "/path/to/mytask.exe"`. 这会提示输入密码，但可以通过管道输入`echo [password]|runas ...`

# javascript - 程序化非尾递归消除

> ID：14633919
> 
> 赞同：7
> 
> 时间：2013-01-31T19:47:23.743
> 
> 标签：javascript, recursion, lisp, scheme

我正在用 JavaScript 制作一个玩具 Lisp 解释器。JS 没有尾递归消除（TRE），所以我在 JS（伪代码）中使用 while 循环实现了 TRE：

```
function eval (exp, env)
  while true
    if exp is self evaluating
      return exp
    else if ...
      ...
    else if exp is a function call
      procedure = eval(car(exp), env)
      arguments = eval_operands(cdr(exp), env)
      exp = procedure.body
      env = extend_env(procedure.env, env)
      continue # tail call 
```

所以我很高兴，像下面这样的尾递归函数不会用完堆栈：

```
(define +
  (lambda (n m)
    (cond ((zero? n) m)
          (else (+ (sub1 n) (add1 m))))))

(+ 10000 1) ;=> 10001 
```

但是，不是尾递归的函数会耗尽 JS 堆栈（因为 JS 代码在 上重复太多`eval_operands`）：

```
(define +
  (lambda (n m)
    (cond ((zero? n) m)
          (else (add1 (+ (sub1 n) m)))))  ; not proper tail-recursive

(+ 10000 1) ;=> JS: Maximum call stack size exceeded 
```

如何处理非尾递归函数？有什么选择？什么是好的资源？我读过一些关于蹦床、堆栈外部化和延续传递风格的文章，但我能找到的只是如何以这些风格编写代码，而不是如何使用这些技术来编写解释器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T02:52:05.500

如果您能够在其他地方保存呼叫帧信息，您总是可以将呼叫转换为跳转*。*这就是“堆栈外部化”所指的。

对于您的解释器，您的调用帧数据需要保存非尾调用的延续（它本身可能保存进一步的引用，例如它需要访问的任何变量）。每个活动的非尾调用都需要一个调用帧。

当然，所有这些都是用堆栈空间交换堆空间。最后，您并没有以这种方式真正节省任何内存。:-)

# ruby - 检查加载的 Gemfile 是否存在

> ID：14633926
> 
> 赞同：2
> 
> 时间：2013-01-31T19:47:51.087
> 
> 标签：ruby, rubygems, bundler

如何检查 Bundler 和 Gemfile 是否存在？

我最初的猜测是`defined?(Bundler) && File.exist?('Gemfile')`，但由于您可以拥有一个不同名称的 Gemfile，因此这不会涵盖所有情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:10:30.243

`ENV`打包程序加载后，您可以使用密钥从全局检索 Gemfile 路径`'BUNDLE_GEMFILE'`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T20:17:42.443

这：

`Bundler::SharedHelpers.in_bundle?`

# mongodb - 运行查询并在 Java GUI 上查看结果

> ID：14633939
> 
> 赞同：0
> 
> 时间：2013-01-31T19:48:33.070
> 
> 标签：mongodb

我正在做一个学校项目。我想创建一个用户能够在 GUI 上输入查询的程序。

例如，如果输入以下命令，程序应该验证查询并返回结果。

```
db.bios.find( { name: { first: 'John', last: 'McCarthy' } } ) 
```

我想要一些关于如何验证查询以及如何将查询传递到数据库的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:59:18.493

Java MongoDB 驱动程序提供了[`JSON.parse`](http://api.mongodb.org/java/2.4/com/mongodb/util/JSON.html)将 JSON 字符串解析为`DBObject`.

```
import com.mongodb.util.JSON;
String json = "{ name: { first: 'John', last: 'McCarthy' } }";
DBObject query = (DBObject) JSON.parse(json);
DBObject result = db.bios.find(query); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:32:39.003

我建议你使用 Jongo 驱动程序：http: [//jongo.org/](http://jongo.org/)

我们这样使用它：

```
Mongo mongo = new Mongo(/*host, port*/);
DB db = mongo.getDB(dbname);
Jongo jongo = new Jongo(db);

User user = jongo.getCollection("users").findOne(" { name: { first: 'John', last: 'McCarthy' }).as(User.class); 
```

但如您所见，它不会验证完整的请求：仅验证 findOne() 方法的参数。Jongo 被称为**最接近**外壳的驱动程序。

换句话说，我怀疑你的练习在 Java 中很容易完成。也许你可以在python中找到一个“shell驱动程序”，然后java与python对话......

# popup - 单击即可弹出每个标记

> ID：14633940
> 
> 赞同：1
> 
> 时间：2013-01-31T19:48:35.233
> 
> 标签：popup, openlayers, google-maps-markers

我有一系列标记，它们根据存储在 *.js 中的坐标放置在地图上

我能够为每个标记添加一个弹出窗口（如图所示），但这并不是我想要的。

[https://dl.dropbox.com/u/108179246/Cattura.JPG](https://dl.dropbox.com/u/108179246/Cattura.JPG)

我正在尝试为每个标记插入一个仅在我单击相应标记时才打开的弹出窗口。这是我到目前为止使用的代码。

```
function showConsideredSamplingPoints() {
        var consideredMarkers = new OpenLayers.Layer.Markers( "Considered  samplings (" + consideredPoints.length + ")");

        var lonLat = null;
        for (var i = 0, len = consideredPoints.length; i < len; i++) {
            lonLat = new OpenLayers.LonLat(consideredPoints[i].lon, consideredPoints[i].lat)
                .transform(
                    new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
                    osmmap.getProjectionObject() // to Spherical Mercator Projection
                  );
            var marker= new OpenLayers.Marker(lonLat);
            consideredMarkers.addMarker(marker, iconRed.clone());   
            popup = new OpenLayers.Popup.FramedCloud(i,
                         lonLat,
                         new OpenLayers.Size(200, 200),
                         "example popup"+osmmap.popups.length,
                         null, true);
            popup.autoSize = true;

            marker.events.register("click", marker, function(e){    
            osmmap.popups[i].show();
            });

            osmmap.addPopup(popup);               
        }

        osmmap.addLayer(consideredMarkers);} 
```

如您所见，我尝试为每个标记插入一个事件，但不起作用。为什么？错误是什么？

解决方案：感谢我的朋友，我找到了解决方案。事件声明中存在错误。正确、完整地携带代码。

```
var consideredMarkers = new OpenLayers.Layer.Markers("Considered samplings (" +  consideredPoints.length + ")")
    , marker = []
    , lonLat = null
    , len
    , i
    , num
    , osmid
    , popup;

  for (i = 0, len = consideredPoints.length; i < len; i++) {
    lonLat = new OpenLayers.LonLat(consideredPoints[i].lon, consideredPoints[i].lat).transform(
      new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
      osmmap.getProjectionObject() // to Spherical Mercator Projection
    );

    num = consideredPoints[i].num;
    osmid = consideredPoints[i].osmid;
    marker[i] = new OpenLayers.Marker(lonLat);

    consideredMarkers.addMarker(marker[i], iconRed.clone());

    popup = new OpenLayers.Popup.FramedCloud(
      i, //id
      lonLat, // lonlat
      new OpenLayers.Size(200, 200), // size
      "Point:" + num + " OsmId:" + osmid + "<---", // content
      null, // anchor
      true  // close
    );

    popup.autoSize = true;  // initial setting
    popup.hide();  // hide this popup!

    osmmap.addPopup(popup);  // add to the osmmap popup list

    marker[i].events.register("click", popup, function () {  // add click event
      this.toggle();  // show or hide
    });
  }

  osmmap.addLayer(consideredMarkers);

    } 
```

# actionscript-3 - 替代 bitmapdata.draw 错误

> ID：14633942
> 
> 赞同：2
> 
> 时间：2013-01-31T19:48:45.770
> 
> 标签：actionscript-3, flash

我得到一个

> SecurityError：错误 #2123：违反安全沙箱：BitmapData.draw：file:///Users/.../project/bin-debug/Project.swf 无法访问 rtmp://flash.project.com/project/。没有策略文件被授予访问权限。

这发生在这一行：

```
temporaryBitmap = new BitmapData(FlexGlobals.topLevelApplication.stage.width, FlexGlobals.topLevelApplication.stage.height, false);
temporaryBitmap.draw(DisplayObject(FlexGlobals.topLevelApplication.stage)); // this line 
```

有没有办法解决这个错误？根据我所做的研究，它似乎与 RTMP 流权限有关。如果是这种情况，那么不显示流是可以的，因为我只是想找到容器的尺寸。因此，如果有一种方法可以获取应用程序的快照，并在视频流所在的位置显示一个黑框，那也很好。

我正在为开发人员创建一个通用工具，因此我不会提前知道哪些内容将可用或不可用。我必须处理这两种情况。我可以想象在从不同域加载图像时我将不得不处理这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T16:09:20.657

我找不到任何其他解决方案来判断它是否会出错，所以我将调用包装在一个 try catch 块中，如下所示：

```
try {
    drawBitmapData(temporaryBitmap, DisplayObject(FlexGlobals.topLevelApplication));
}
catch (e:Error) {
    // could not draw so don't draw
}

// continue 
```

我不得不把调用 draw 放到一个单独的调用中，这样它就不会抛出错误，而是跳到下一段代码：

```
public function drawBitmapData(bitmapData:BitmapData, displayObject:DisplayObject, matrix:Matrix = null):void {
    bitmapData.draw(displayObject, matrix);
} 
```

# html - 不同浏览器的替代 CSS 字体设置？

> ID：14633947
> 
> 赞同：1
> 
> 时间：2013-01-31T19:48:57.320
> 
> 标签：html, css, cross-browser, font-size

只是好奇是否有办法根据浏览器更改网站上的字体大小。我有一个可以在 Chrome 和 Safari 中使用的 @font-face，然后我的替代字体选择正在 Internet Explorer 和 Firefox 中使用。我的替代字体选择比我的首选字体大。有没有办法只更改 IE 和 Firefox 的字体大小？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:51:52.220

您可以使用 JS 检测浏览器并将类添加到 HTML 标记。您可以为此使用以下库：[http ://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

如果你为 Firefox 和 IE 添加一个类，那么你可以在 CSS 中使用

```
.MSIE #mydiv
{
     // Something only for IE
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:56:29.420

您可以使用 CSS hack 或条件来为特定浏览器或 css 浏览器选择器加载 css 文件...

对于 css hack，请查看此.. [https://github.com/ginader/CSS-Hacks](https://github.com/ginader/CSS-Hacks) 对于 css 浏览器选择器，[http://rafael.adm.br/css_browser_selector/](http://rafael.adm.br/css_browser_selector/)

# nosql - 在 Elastic Search 上查询多级嵌套字段

> ID：14633952
> 
> 赞同：9
> 
> 时间：2013-01-31T19:49:37.237
> 
> 标签：nosql, nested, elasticsearch, pyes

我是弹性搜索和非 SQL 范式的新手。我一直在关注 ES 教程，但有一件事我无法投入使用。

在下面的代码中（我使用[PyES](http://packages.python.org/pyes/)与 ES 交互）我创建了一个带有嵌套字段（主题）的单个文档，其中包含另一个嵌套字段（概念）。

```
from pyes import *

conn = ES('127.0.0.1:9200')  # Use HTTP

# Delete and Create a new index.
conn.indices.delete_index("documents-index")
conn.create_index("documents-index")

# Create a single document.
document = {
    "docid": 123456789,
    "title": "This is the doc title.",
    "description": "This is the doc description.",
    "datepublished": 2005,
    "author": ["Joe", "John", "Charles"],
    "subjects": [{
                    "subjectname": 'subject1',
                    "subjectid": [210, 311, 1012, 784, 568],
                    "subjectkey": 2,
                    "concepts": [
                                    {"name": "concept1", "score": 75},
                                    {"name": "concept2", "score": 55}
                                  ]
                },
                {
                    "subjectname": 'subject2',
                    "subjectid": [111, 300, 141, 457, 748],
                    "subjectkey": 0,
                    "concepts": [
                                    {"name": "concept3", "score": 88},
                                    {"name": "concept4", "score": 55},
                                    {"name": "concept5", "score": 66}
                                  ]
                }],
    }

# Define the nested elements.
mapping1 = {
            'subjects': {
                'type': 'nested'
            }
        }
mapping2 = {
            'concepts': {
                'type': 'nested'
            }
        }
conn.put_mapping("document", {'properties': mapping1}, ["documents-index"])
conn.put_mapping("subjects", {'properties': mapping2}, ["documents-index"])

# Insert document in 'documents-index' index.
conn.index(document, "documents-index", "document", 1)

# Refresh connection to make queries.
conn.refresh() 
```

我能够查询*主题*嵌套字段：

```
query1 = {
    "nested": {
        "path": "subjects",
        "score_mode": "avg",
        "query": {
            "bool": {
                "must": [
                    {
                        "text": {"subjects.subjectname": "subject1"}
                    },
                    {
                        "range": {"subjects.subjectkey": {"gt": 1}}
                    }
                ]
            }
        }
    }
}

results = conn.search(query=query1)
for r in results:
    print r  # as expected, it returns the entire document. 
```

但我不知道如何根据*概念*嵌套字段进行查询。

ES[文档](http://www.elasticsearch.org/guide/reference/query-dsl/nested-query.html)提到

> 自动支持和检测多级嵌套，如果内部嵌套查询存在于另一个嵌套查询中，则会自动匹配相关嵌套级别（而不是根）。

因此，我尝试使用以下格式构建查询：

```
query2 = {
        "nested": {
            "path": "concepts",
            "score_mode": "avg",
            "query": {
                "bool": {
                    "must": [
                        {
                            "text": {"concepts.name": "concept1"}
                        },
                        {
                           "range": {"concepts.score": {"gt": 0}}
                        }
                    ]
                }
            }
        }
} 
```

返回 0 个结果。

我无法弄清楚缺少什么，也没有找到任何基于两级嵌套的查询示例。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-01T14:41:32.187

好的，在尝试了多种组合之后，我终于使用以下查询得到了它：

```
query3 = {
    "nested": {
        "path": "subjects",
        "score_mode": "avg",
        "query": {
            "bool": {
                "must": [
                    {
                        "text": {"subjects.concepts.name": "concept1"}
                    }
                ]
            }
        }
    }
} 
```

因此，无论嵌套属性级别如何，嵌套**路径**属性 ( *subjects ) 始终相同，并且在查询定义中我使用了属性的完整路径 (* *subject.concepts.name* )。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T14:26:07.877

由于我没有亲自尝试过，所以在黑暗中拍摄，但是您是否尝试过完全合格的概念之路？

```
query2 = {
       "nested": {
           "path": "subjects.concepts",
           "score_mode": "avg",
           "query": {
               "bool": {
                   "must": [
                       {
                           "text": {"subjects.concepts.name": "concept1"}
                       },
                       {
                          "range": {"subjects.concepts.score": {"gt": 0}}
                       }
                   ]
               }
           }
       }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-09T06:10:57.667

我对 JCJS 的回答有一些疑问。为什么你的映射不应该这样？

```
mapping = {
    "subjects": {
        "type": "nested",
        "properties": {
            "concepts": {
                "type": "nested"
            }
        }
    }
} 
```

我尝试定义两个类型映射可能行不通，但是是一个扁平化的数据；我认为我们应该嵌套在嵌套属性中..

最后......如果我们使用这个映射嵌套查询应该是这样的......

```
{
    "query": {
        "nested": {
            "path": "subjects.concepts",
            "query": {
                "term": {
                    "name": {
                        "value": "concept1"
                    }
                }
            }
        }
    }
} 
```

对于使用`full path`路径属性至关重要......但不是术语键可以是完整路径或相对路径。

# jquery - jquery 从 iframe 更改 elemnets 值

> ID：14633953
> 
> 赞同：1
> 
> 时间：2013-01-31T19:49:38.473
> 
> 标签：jquery, iframe

这是我的页面：

```
<iframe src="/index/player/0-4" id="iframe" scrolling="no"></iframe> 
```

我的 iframe 内容

```
<div id='outerdiv'>
<iframe src="" id="frameID" span="" scrolling="no" height=""></iframe>
</div> 
```

现在我想通过按一个按钮在 jquery scr="" span="" 和高度的帮助下进行更改

我有这个代码：

```
<script>$("#button").click(function () { 
      $("#frameID").attr("src", "http://site.info");
});</script>
<script>$("#button").click(function(){
  $("#frameID").animate({
    height: "72px"
  }, 1500 ); 
});

</script> 
```

但它仅在 iframe 与代码在同一页面上时才有效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:21:18.780

您必须在 iFrame 中找到控件

```
($("#iframe").contents().find("#frameID")).attr("src", "http://site.info"); 
```

# sql - 在plpgsql中获取光标

> ID：14633954
> 
> 赞同：0
> 
> 时间：2013-01-31T19:49:40.510
> 
> 标签：sql, postgresql, cursor, plpgsql

阅读此链接[http://microjet.ath.cx/WebWiki/ResultPaginationWithPostgresql.html](http://microjet.ath.cx/WebWiki/ResultPaginationWithPostgresql.html)后，我决定使用光标进行分页。但似乎我不知道如何在 plpgsql 中获取结果。

这是我的功能

```
CREATE OR REPLACE FUNCTION get_pagination_custom_word_moderation(_moderation_id bigint, _is_black boolean, _index integer, _max_result integer)
    RETURNS TABLE(word_id bigint,
        word character varying,
        is_num_rlpcm boolean,
        is_word_bund boolean,
        note text,
        create_time timestamp without time zone,
        last_update timestamp without time zone) AS
$BODY$
DECLARE custom_word_moderation_cursor CURSOR FOR
    SELECT
        word_id,
        word,
        is_num_rlpcm,
        is_word_bund,
        note,
        create_time,
        last_update
    FROM
        custom_word_moderation
    WHERE
        moderation_id=_moderation_id
    AND is_black=_is_black;
BEGIN

MOVE ABSOLUTE _index FROM custom_word_moderation_cursor;
RETURN QUERY FETCH _max_result FROM custom_word_moderation_cursor;

END;
$BODY$
  LANGUAGE plpgsql VOLATILE; 
```

错误是：

```
ERROR:  syntax error at or near "$1"
LINE 1:  FETCH  $1  FROM  $2 
                ^
QUERY:   FETCH  $1  FROM  $2 
CONTEXT:  SQL statement in PL/PgSQL function "get_pagination_custom_word_moderation" near line 18

********** Error **********

ERROR: syntax error at or near "$1"
SQL state: 42601
Context: SQL statement in PL/PgSQL function "get_pagination_custom_word_moderation" near line 18 
```

我认为问题在于如何返回获取结果表单游标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:13:12.597

您正在尝试做的事情没有实施。游标旨在这样返回，以便*客户端*可以随心所欲地获取行。特别是对于大的结果。您将为此定义一个函数[**`RETURNS refcursor`**](http://www.postgresql.org/docs/current/interactive/plpgsql-cursors.html#AEN57060)。

您*可以*使其与变量的[`FOR LOOP`](http://www.postgresql.org/docs/current/interactive/plpgsql-cursors.html#PLPGSQL-CURSOR-FOR-LOOP)显式分配一起使用`OUT`，但这与...结合起来很棘手`RETURNS TABLE`。您还必须[`OPEN`使用 cursor](http://www.postgresql.org/docs/current/interactive/plpgsql-cursors.html#PLPGSQL-CURSOR-OPENING)，因为在 plpgsql 的上下文中与与[SQL](http://www.postgresql.org/docs/current/interactive/sql-declare.html) [for cursors](http://www.postgresql.org/docs/current/interactive/sql-declare.html)[`DECLARE`](http://www.postgresql.org/docs/current/interactive/plpgsql-cursors.html#PLPGSQL-CURSOR-DECLARATIONS)相同的关键字具有不同的含义。你必须[`DECLARE`](http://www.postgresql.org/docs/current/interactive/sql-declare.html)[`FETCH .. INTO ..`](http://www.postgresql.org/docs/current/interactive/plpgsql-cursors.html#PLPGSQL-CURSOR-USING)

**相反，**使用没有游标的简单等价物：

```
CREATE OR REPLACE FUNCTION get_pagination_custom_word_moderation(
                         _moderation_id bigint, _is_black boolean
                       , _index integer, _max_result integer)
    RETURNS TABLE(word_id bigint,
        word varchar,
        is_num_rlpcm boolean,
        is_word_bund boolean,
        note text,
        create_time timestamp,
        last_update timestamp) AS
$func$
BEGIN
   RETURN QUERY
   SELECT word_id
         ,word
         ,is_num_rlpcm
         ,is_word_bund
         ,note
         ,create_time
         ,last_update
   FROM   custom_word_moderation
   WHERE  moderation_id = _moderation_id
   AND    is_black = _is_black
   OFFSET _index
   LIMIT  _max_result;
END
$func$ LANGUAGE plpgsql; 
```

或者使用 SQL 函数更简单：

```
CREATE OR REPLACE FUNCTION get_pagination_custom_word_moderation(
                         _moderation_id bigint, _is_black boolean
                       , _index integer, _max_result integer)
    RETURNS TABLE(word_id bigint,
        word varchar,
        is_num_rlpcm boolean,
        is_word_bund boolean,
        note text,
        create_time timestamp,
        last_update timestamp) AS
$func$
   SELECT word_id
         ,word
         ,is_num_rlpcm
         ,is_word_bund
         ,note
         ,create_time
         ,last_update
   FROM   custom_word_moderation
   WHERE  moderation_id = $1
   AND    is_black = $2
   OFFSET $3
   LIMIT  $4;
$func$ LANGUAGE sql; 
```

我`$n`在函数体中使用符号，因为在 9.2 版之前的 SQL 函数中不能通过名称引用参数。

如果你真的想返回*一个 table 的所有列*，你可以进一步简化：

```
CREATE OR REPLACE FUNCTION get_pagination_custom_word_moderation(
                         _moderation_id bigint, _is_black boolean
                       , _index integer, _max_result integer)
    RETURNS SETOF custom_word_moderation AS
$func$
   SELECT *
   FROM   custom_word_moderation
   WHERE  moderation_id = $1
   AND    is_black = $2
   OFFSET $3
   LIMIT  $4;
$func$ LANGUAGE sql; 
```

# azure - 在 Windows Azure 的何处部署 WebApi：作为网站还是作为云服务？

> ID：14633957
> 
> 赞同：16
> 
> 时间：2013-01-31T19:49:48.100
> 
> 标签：azure, asp.net-web-api, azure-web-app-service, azure-deployment

我正在开发一个 Web API，并将其托管在 Windows Azure 上。我应该考虑什么来决定在哪里部署它？据我所知，它可以部署为网站或云服务。很想知道你们看到的利弊。

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-31T20:20:53.077

云服务和 Windows Azure 网站都是 ASP.NET Web API 的良好宿主。

我同意@SLaks - 取决于你想要多少控制。

使用云服务进行最大程度的控制（包括控制性能特征和（对于需要此功能的 API）向外扩展的能力）。网站的部署速度（秒而不是分钟）和成本（可能是免费的，取决于您的扩展需求）。

*   对于网站，您最大的 VM 大小是大型的。借助云服务，它可以达到 XL（是大型规格的两倍）。
*   使用网站，您最多可以拥有三个处于保留模式的 VM 实例。对于云服务，没有硬性限制（尽管您可能需要致电支持部门才能在标准帐户中超过 20 个核心）。
*   使用网站，您无法控制 IIS。使用云服务，您可以这样做，因此您可以执行诸如使用[IIS 中的预热模块](http://fabriccontroller.net/blog/posts/iis-8-0-application-initialization-module-in-a-windows-azure-web-role/)和调整回收设置（这些都有助于改善某些情况下的延迟）之类的事情。

有关扩展网站的更多信息：http: [//www.windowsazure.com/en-us/manage/services/web-sites/how-to-scale-websites/](http://www.windowsazure.com/en-us/manage/services/web-sites/how-to-scale-websites/)

总之，从最少到最多的控制，您确实拥有： 网站共享实例（高密度模式，很少控制，有限规模，免费）=> 保留模式（很少控制，更好的规模，更可预测（b/c no您不了解的租户），花钱，知识少）=> 云服务（对 IIS 的最大控制，花钱，需要更多关于云服务的知识）。

# mongodb - Mongo 管理员数据库凭据在服务器上的其他数据库中不起作用

> ID：14633958
> 
> 赞同：0
> 
> 时间：2013-01-31T19:49:48.880
> 
> 标签：mongodb, mongodb-.net-driver

Mongo 的文档指出，启用身份验证后，对于添加到 admin 数据库的用户，这些用户应该能够访问 Mongo 中的其他数据库，并在 admin 数据库级别授予权限。

“admin 数据库是唯一的。对 admin 数据库具有正常访问权限的用户对所有数据库具有读写访问权限。对 admin 数据库具有只读访问权限的用户对所有数据库具有只读访问权限。” [http://docs.mongodb.org/manual/administration/security/](http://docs.mongodb.org/manual/administration/security/)

但在使用 C# 库版本 1.7.0.4714 进行测试时，情况并非如此。只有在特定数据库中创建的帐户才能访问该数据库。

我已经在连接字符串上使用凭据进行了测试，并通过在 C# 中的数据库级别显式设置凭据进行了测试

```
server.GetDatabase(...
new MongoClient(a connectionString ... 
```

有谁知道这是否是预期的行为？或者可以提出解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:24:16.423

这不是 mongodb 问题。我相信您可以像这样从 mongodb shell 进行身份验证：

```
use admin
db.auth(user, pass) 
```

这是一个 mongodb c# 驱动程序技巧。很久以前，为了理解这一点，我花了一些时间阅读 c# 驱动程序代码。

所以连接字符串应该是这样的：

```
mongodb://admin(admin):1@localhost:27020/myDb 
```

`(admin)`为了告诉驱动程序您将通过管理员用户进行身份验证的技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T21:51:58.160

还有另一种方法可以连接针对 admin 数据库的身份验证。

缺点是您必须设置整个连接对象，而不是仅将所有信息打包在连接字符串上。

而不是使用像这样的连接字符串来实例化 MongoClient

```
var connectionString = "mongodb://localhost";
var client = new MongoClient(connectionString); 
```

您可以创建一个 MongoClientSettings 对象，设置凭据（以及任何其他连接设置）并实例化传递该对象的客户端

```
string authenticationDB = "admin"
string authenticationUsername = "user"
string authenticationPassword = "pass"
MongoClientSettings settings = new MongoClientSettings();
settings.Credentials = new[] { MongoCredential.CreateMongoCRCredential(authenticationDB, authenticationUsername, authenticationPassword) };

settings.Servers = new[] { new MongoServerAddress("host_1"), new MongoServerAddress("host_2"), new MongoServerAddress("host_3") };
settings.ConnectionMode = ConnectionMode.ReplicaSet;

var client = new MongoClient(settings);
var db = client.GetServer().GetDatabase(database); 
```

[http://docs.mongodb.org/ecosystem/tutorial/authenticate-with-csharp-driver/](http://docs.mongodb.org/ecosystem/tutorial/authenticate-with-csharp-driver/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T20:22:58.157

答案已经在stackoverflow上发布了:)

[Mongodb C# 驱动程序 - 无法使用管理员身份验证访问其他数据库](https://stackoverflow.com/questions/6764078/mongodb-c-sharp-driver-cant-use-admin-authentication-to-access-other-database?rq=1)

使用的用户名后面应该有 (admin) 以使用该帐户。

# javascript - 如何使用 css 使表单居中？

> ID：14633963
> 
> 赞同：0
> 
> 时间：2013-01-31T19:50:17.247
> 
> 标签：javascript, css, centering

从字面上看，集中在所有四个方面。我看到很多教程只是使用

```
element.style.margin = "0 auto"; 
```

这仅以 X 轴为中心，而不是 Y 轴。

我如何让它也通过 Y 轴居中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T19:51:39.330

我用过：

```
#myItem {
   position: fixed;
   top: 50%;
   left: 50%;
   width: 100px;
   height: 100px;
   margin-top: -50px;
   margin-left: -50px;
} 
```

....之前，希望它有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T19:52:38.947

在您想要垂直居中的元素上设置`display: table-cell`和设置，并在您希望它在其中居中的父容器元素上设置。`vertical-align: middle``display: table`

# javascript - 为什么我不能将 jquery 对象作为函数中的参数传递？

> ID：14633965
> 
> 赞同：2
> 
> 时间：2013-01-31T19:50:26.593
> 
> 标签：javascript, jquery

我正在尝试将一个 jQuery 选定对象传递给一个函数，该函数将对`.html()`它执行一个操作。

html:

```
<div id="box">this is a box</div> 
```

JS：

```
var fillBox = function(box, text) {
  box.html(text);
}

(function() {
  var box = $("#box");
  fillBox(box, "new text");
}); 
```

`"this is a box"`即使调用了该函数，该框仍保持不变并且永远不会更新。我什至在函数内部尝试过`$(box).html(text)`，但这并不能解决问题。这是可行的吗？

[http://jsbin.com/iqixoj/5/edit](http://jsbin.com/iqixoj/5/edit)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T19:52:06.357

你忘了一个`$`.

```
$(function() {
  var box = $("#box");
  fillBox(box, "new text");
}); 
```

# javascript - Chrome/Firefox console.log 总是附加一行“未定义”

> ID：14633968
> 
> 赞同：86
> 
> 时间：2013-01-31T19:50:43.683
> 
> 标签：javascript, debugging, logging, console

每次执行时，都会在输出日志中附加`console.log`一行语句。`undefined`

它发生在 Windows 和 Linux 上的 Firefox 和 Chrome 中。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-01-31T19:57:01.773

如果您`console.log()`从 JS 文件运行，则`undefined`不应附加此行。

如果您`console.log()`从控制台本身运行，这是有道理的。这就是原因：在控制台中，您可以键入变量的名称（例如尝试键入`window`）并打印有关它的信息。当您从控制台运行任何 void 函数（如 console.log）时，它还会打印出有关返回值的信息，`undefined`在这种情况下。

`undefined`我在我的 Chrome（Mac 版本 23.0.1271.101）上测试了这两种情况，当我在控制台中运行它时，我确实看到了这条线。当我在控制台中写下这一`undefined`行时，也会出现这种情况：`var bla = "sdfdfs"`

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-02-11T20:19:26.277

虽然talkol的回答还可以，但我试着更直截了当地说：

JavaScript 被设计为一种动态语言，这意味着函数返回值的类型（字符串、void、布尔值……）不是预先定义的。如果函数不使用 return 语句或没有值的空 return 语句，JavaScript 会自动返回 undefined。这意味着在 JavaScript 中，每个函数都会返回一些东西，至少是未定义的。

所以`console.log()`Chrome 控制台中的函数要么使用 no 要么使用空的 return 语句，因此该函数的返回值是未定义的。此函数返回值也会显示在 Chrome 控制台中。

[如果有人知道在哪里可以找到`console.log()`谷歌浏览器源代码中的函数定义，请在链接中发表评论，然后我们甚至可以进一步查看真实代码，会很好。]

资料来源：

*   [https://stackoverflow.com/a/20915524/1744768](https://stackoverflow.com/a/20915524/1744768)
*   [https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-03-30T16:10:22.110

按照图片解决这个问题：

```
Ctrl + Shift + J 
```

![](../Images/f658cc96e4ff1d8898f5dde7c5c8d67f.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-10-20T05:40:50.823

浏览器中的控制台环境旨在获取程序中的最后一个语句表达式并评估它的值，然后向您显示该值。

赋值表达式的结果是被赋值的值。所以 JavaScript 引擎只是做了一个赋值，但控制台做了一个额外的步骤，即设置我的最后一个语句，把那个值返回给你。这就是它打印 2 的原因：

![这里。](../Images/e050a42468004b1232784213b553daba.png)

在没有返回值的语句中，你会得到类似 undefined 的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-11T19:13:22.613

您可以做的只是创建您自己的类似 console.log 的函数，并在开发人员控制台中进行大量编码时返回以更改此行为。以下是开发人员控制台中的示例：

```
console.log('I hate seeing the next line stating the obvious.')
I hate seeing the next line stating the obvious.
undefined
log = function(l){return l}
function log()
if(1 === 2){console.log('1 is not equal to 2.')}else{log('No Shit Sherlock.')}
"No Shit Sherlock." 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-11T00:29:18.763

`undefined`是 Chrome 开发者工具中 console.log() 的返回值。如果您在 Chrome 开发人员工具中执行以下操作，您将得到 undefined，即使 x 的值为 3，您也会看到您得到 undefined。

```
> let x = 3
> undefined 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2016-03-29T03:14:35.597

如果您使用`console.log`在一行中发出多个值，这里有一个 hacky 替代方案：

```
var1 + ' ' + var2 + ' ' + var... 
```

（欢迎更好的想法，这可能会在某些情况下爆炸）

# c# - 将 DropDownList 值从一页转移到下一页

> ID：14633971
> 
> 赞同：0
> 
> 时间：2013-01-31T19:51:04.577
> 
> 标签：c#, asp.net, visual-studio

我有 2 页，都有 3 个类似的 DropDownLists。第一个 DropDownList 需要在选择第二个之前填充，第二个在第三个之前填充（然后填充一个 gridview）。

通常，用户将在一个页面上查看数据，单击一个按钮，然后在下一页上查看数据（通常使用相同的 DropDownList 选择）。有没有办法让下拉列表预先填充他们的旧选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T20:16:37.570

`PreviousPage`您可以使用asp.net 为您提供的参数将值从一个页面传递到另一个页面。一个小例子：

您将提交按钮上的第二页设置为：

```
PostBackUrl="SecondPage.aspx" 
```

在 SecondPage.aspx 上，您声明可以获取信息的位置

```
<%@ PreviousPageType VirtualPath="~/FirstPage.aspx" %> 
```

你得到他们...

```
if (Page.PreviousPage != null)
{
    if(Page.PreviousPage.IsCrossPagePostBack == true)
    {
        // and get the controls of the previous page as
        var SomeVariable = PreviousPage.DropDownlListId.SelectedValue;
    }
} 
```

一些参考。
[ASP.NET 网页中的跨页发布](http://msdn.microsoft.com/en-us/library/ms178139.aspx)
[ASP.NET 如何访问公共属性？](https://stackoverflow.com/questions/3036422/asp-net-how-to-access-public-properties/3036710#3036710)
[跨页面回发并再次保留来自源页面的数据](https://stackoverflow.com/questions/3736445/cross-page-postbacks-and-back-again-retaining-data-from-source-page/3736506#3736506)
[跨页面发布。在 Asp.net 中使用 PreviousPage 是一个好习惯吗？](https://stackoverflow.com/questions/10124030/cross-page-posting-is-it-a-good-pratice-to-use-previouspage-in-asp-net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:01:51.360

如果您有用户单击的按钮发布到第二页的表单，则第二页可以查找 DDL 的值并在页面加载时设置它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T20:23:56.447

有一种方法：

1.  通过 Session 或 Query String 将选择传递到第二页
2.  填充第一个下拉列表
3.  选择合适的项目
4.  对其余的下拉菜单重复 2-3

如果您正在寻找一种“可以做到”的神奇解决方案，我认为这是不可能的。

p.s. You might rethink your design (if this is an option) and have the grid on the first page; bind the grid when user selects a value from the last dropdown (make sure you have `AutoPostback` set to `True` on your last dropdown in order to trigger the final postback)

# regex - 没有双字符且在字符串长度内的单词的正则表达式

> ID：14633972
> 
> 赞同：2
> 
> 时间：2013-01-31T19:51:07.913
> 
> 标签：regex

每次我需要使用正则表达式时，我意识到我已经忘记了关于它们的一切。

我正在尝试匹配所有只有小写字母数字字符且没有双倍字母数字字符且长度也在 {10,12} 个字符内的单词。

现在，要弄清楚一个字符后面是否跟着同一个字符，我会做`(.)\1`. 要查看一个单词是否在 10 到 12 个字符之内，我会这样做`{10,12}`。要只抓取小写字母和数字，我会使用`[0-9a-z]`.

但是我如何将它们链接在一起呢？

干杯!

PS：这将在相当大的 NLP xml (100mb+) 上运行，所以如果正则表达式不是最慢的替代方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T19:58:43.457

我认为这会做你想要的： -

```
/\b(?:([a-z0-9])(?!\1)){10,12}\b/ 
```

**解释： -**

```
\b   // Word boundary
(?:
    ([a-z0-9])  // Match lowercase letters or digit
    (?!\1)      // Not followed by the same digit as before
){10,12}        // 10 to 12 times.
\b   // Word boundary 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T20:00:12.327

这是一个，虽然我不确定不会有更好的方法......

```
/\b(?:([a-z0-9])(?!\1)){10,12}\b/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T20:01:48.837

这是我的尝试：

```
 (\b(?![0-9a-z]*([0-9a-z])\2)[0-9a-z]{10,12}\b) 
```

（我们必须使用前瞻，并且某种边界通常对其正常运行非常重要。因此`\b`）。

*在撰写本文时，另一个答案*有误报，与`eoeuaoarounn`

# php - php foreach 遇到困难并通过引用传递

> ID：14633978
> 
> 赞同：1
> 
> 时间：2013-01-31T19:51:36.357
> 
> 标签：php, mysql, sql

我正在从数据库中提取一些数据（使用我称为查询的函数），并且我想为每个结果添加另一个键/值对，即：

```
$items = query("SELECT * FROM items");

foreach($items as &$item) {
    $item['fixedname'] = str_replace(' ','_',$item['name']);
} 
```

现在我想把这些放在一个 html 视图上，即：

```
<?php foreach($items as $item): ?>
<div id="<?= $item['fixedname'] ?>" ><?= $item['name'] ?></div>
<?php endforeach; ?> 
```

但是，这不能正确输出。例如，当查询返回两个项目时，php 中的循环会输出两次相同的内容。如果有三个：它输出第一个，然后输出第二个中的两个。这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T20:02:45.000

使用 foreach() 进行修改时，我有时会遇到奇怪的结果。我用

```
foreach ($items as $key=>$value) {
    $items[$key] = modified($value);
} 
```

或者，为什么不在 SQL 中做呢？`SELECT your, fields, here, REPLACE(name, ' ', '-') AS fixedname`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:07:15.873

你可以做一个正常的for循环

```
<?php 
    for($i=0; $i < count($items); $i++){
        $items[$i]['fixedname'] = str_replace(' ','_',$items[$i]['name']);
    }
?> 
```

然后，当您进行下一次 foreach 时，一切都会准备就绪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T20:21:54.693

foreach右侧返回的数据是数据的副本，不能直接修改。相反，您需要同时获取 $key（数组中项目的 ID）和 $item。通过让 PHP 告诉您 $key，您无需担心数组是否正常（例如，索引为 0、1、2、...）和关联。

```
This example would walk the $items array and add 'fixedname' into it.

foreach($items as $key => $item) {
    $items[$key]['fixedname'] = str_replace(' ','_',$item['name']);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T20:21:56.853

你有一堆错误的东西

**1** - 不要使用 mysql ，使用`PDO`or`mysqli`代替

**2** ---- `$items = query("SELECT * ....`>调用未定义的函数查询（）

将其更改为

```
$items = mysql_query("SELECT *  .... 
```

**3** - `Invalid argument supplied for foreach()`,

您错过了获取您的查询

试试这整个代码

```
 $items = mysql_query("SELECT * FROM items");

 ?>
<?php while ($row = mysql_fetch_array($items) ) {?>
 <div id="<?php echo $row['fixedname'] ;?>" ><?php echo $row['name']; ?></div>
<?php } ?> 
```

# c++ - 如何在 C++ 中强制编译错误？

> ID：14633987
> 
> 赞同：20
> 
> 时间：2013-01-31T19:51:56.340
> 
> 标签：c++, debugging, compilation, compiler-errors, output

我想在我的 C++ 代码中创建一个带有自定义错误消息的编译时错误。我想这样做有几个原因：

*   在我处理尚未实现的新功能时强制编译失败。（编译时间！TODO提醒）
*   在尝试实现不受支持的模板特化时创建更易读的错误。

我确信这样做有一个技巧，但我找不到解释该方法的资源。我会将代码包装在 COMPILE_FAIL("error message"); 形式的#define 中。

感谢：D

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-31T19:53:47.213

使用`#error`：

```
#error "YOUR MESSAGE" 
```

这会从预处理器中产生错误。如果您想在稍后阶段（例如在模板处理期间）检测错误，请使用`static_assert`（C++11 功能）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-31T20:01:44.297

调查[`static_assert`](http://en.cppreference.com/w/cpp/language/static_assert)。

例子：

```
#include <iostream>
#include <type_traits>

template<typename T>
class matrix {
    static_assert(std::is_integral<T>::value, "Can only be integral type");
};

int main() {
    matrix<int*> v; //error: static assertion failed: Can only be integral type
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T19:53:56.477

强制编译器错误（GCC，Clang 风格）：

```
#error "You ain't finished this yet!" 
```

# android - Android HTML 应用程序状态的 FATAL EXCEPTION 保存/恢复实例

> ID：14633988
> 
> 赞同：0
> 
> 时间：2013-01-31T19:52:00.380
> 
> 标签：android, cordova, instance, savestate

我试图掌握保存 Android 应用程序并在恢复时恢复它的简单方面。我已经到处寻找答案，但没有任何效果。由于我正在开发的应用程序遇到问题，我将其归结为下面的测试应用程序。我在某处得到一个空指针。我有一个要加载的基本 HTML 页面。当我旋转手机时，它会尝试保存但无法正确恢复。我在这里想念什么？

**这是我的活动：**

```
package com.example.saverestore;

import org.apache.cordova.DroidGap;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;

public class MainActivity extends DroidGap {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.init();

    if(savedInstanceState == null || savedInstanceState.isEmpty())
    {
        Log.d("RGiTest", "super.loadUrl");
        super.loadUrl("file:///android_asset/www/index.html");
    }
    else
    {
        Log.d("RGiTest", "Restoring the state");
        this.appView.restoreState(savedInstanceState);
    }

}

@Override
protected void onSaveInstanceState(Bundle outState)
{
   super.onSaveInstanceState(outState);
   this.appView.saveState(outState);
}

} 
```

**这是我的 index.html：**

```
 <!DOCTYPE HTML>
    <html>
    <head>
    <title>Save Restore</title>
    </head>
    <body style="background-color: #000000">
    <h1 style="margin-left: 40px; color: #FF0000;">Test Save/Restore</h1>
    </body>
    </html> 
```

**旋转手机时出现此错误：**

```
01-31 14:18:31.707: D/DroidGap(3129): onMessage(onPageStarted,file:///android_asset/www/index.html)
01-31 14:18:31.726: D/Cordova(3129): onPageFinished(file:///android_asset/www/index.html)
01-31 14:20:15.183: D/AndroidRuntime(3129): Shutting down VM
01-31 14:20:15.183: W/dalvikvm(3129): threadid=1: thread exiting with uncaught exception (group=0x40015578)
01-31 14:20:15.246: E/AndroidRuntime(3129): FATAL EXCEPTION: main
01-31 14:20:15.246: E/AndroidRuntime(3129): java.lang.NullPointerException
01-31 14:20:15.246: E/AndroidRuntime(3129):     at java.lang.String.indexOf(String.java:1145)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at org.apache.cordova.CordovaWebView.loadUrlNow(CordovaWebView.java:517)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at org.apache.cordova.CordovaWebView.loadUrl(CordovaWebView.java:402)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at org.apache.cordova.CordovaWebViewClient.onPageFinished(CordovaWebViewClient.java:298)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at android.webkit.CallbackProxy.handleMessage(CallbackProxy.java:282)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at android.os.Looper.loop(Looper.java:130)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at android.app.ActivityThread.main(ActivityThread.java:3687)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at java.lang.reflect.Method.invokeNative(Native Method)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at java.lang.reflect.Method.invoke(Method.java:507)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
01-31 14:20:15.246: E/AndroidRuntime(3129):     at dalvik.system.NativeStart.main(Native Method) 
```

有人可以就此提供建议或指导吗？

谢谢

# c++ - 在 VS 2010 中打开 VS 2005 C++ 项目后出现 IntelliSense 错误

> ID：14633995
> 
> 赞同：0
> 
> 时间：2013-01-31T19:52:33.123
> 
> 标签：c++, visual-studio-2010, visual-studio

我继承了一个在 VS2005 中编译良好的 C++ 项目，但是当我在 VS2010 中打开它时，我得到了很多这样的 IntelliSense 错误：

> IntelliSense：表达式必须具有整数或枚举类型

实际上在项目中打开其中一个 cpp 文件似乎会导致出现错误。

这是导致错误的行类型的示例。

```
if (pInfoset->Fields->Item["Contact"]->Size <= 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:19:45.633

我认识代码，那是 ADO 语法。您正在与一种非标准语言扩展作斗争，这种扩展在过去十年中使 COM 编程变得更容易。它允许使用声明符在 C++ 类上[声明属性](http://msdn.microsoft.com/en-us/library/yhfk0thd%28v=vs.110%29.aspx)`__declspec(property)`。一个例子：

```
class Example {
public:
    int GetX(const char* indexer) { return 42;}
    void PutX(const char* indexer, int value) {}
    __declspec(property(get=GetX,put=PutX)) int x[];
};

int main()
{
    Example e;
    int value = e.x["foo"];   // Barf
    return 0;
} 
```

IntelliSense 解析器在 VS2010 中彻底检修，并使用 Edison Design Group 前端重新实现。它只是与语言扩展不够兼容，并且会超出索引运算符的使用。我会说，他们可以原谅。

您可以在 connect.microsoft.com 上对此进行投诉，但我不希望出现奇迹。这个问题在 VS2012 中仍然存在。`get_Item("Contact")`在您的情况下，一种解决方法是停止使用虚拟属性并改用 getter 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:42:08.320

根据您在评论中所说的内容（关于 IntelliSense 找不到 .tli 文件），一旦您构建了解决方案，错误应该会消失。.tli（和 .tlh）文件是由 #import 指令创建的自动生成的文件，但显然您需要编译具有 #import 指令的文件才能生成这些文件（仅 IntelliSense 不会生成他们）。

# java - 无法通过 .bat 文件设置 jvm 参数/参数（Xmx 和 Xms）

> ID：14633998
> 
> 赞同：4
> 
> 时间：2013-01-31T19:52:42.797
> 
> 标签：java, batch-file, jvm, comma

通过将VM参数设置为-Xmx1024m -Xms256M，我可以通过eclipse运行java程序。现在我想通过 Windows 中的 .bat 文件运行相同的 java 程序（jar）。我在文件中设置 JVM 值如下

```
@echo off
set JAVA_OPTS="-Xmx1024m -Xms256m -XX:+HeapDumpOnOutOfMemoryError"
java -cp TA.jar com.myClass 
```

但是当我通过批处理（Windows xp 中的 .bat）运行相同的程序时，它会抛出内存不足错误，我怀疑通过 .bat 文件进行的 JVM 设置不起作用。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T20:09:40.693

它应该是 _JAVA_OPTIONS 而不是 JAVA_OPTS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T20:14:15.293

直接使用参数

```
java -Xmx1024m -Xms256m -XX:+HeapDumpOnOutOfMemoryError -cp TA.jar com.myClass 
```

您无需将它们设置为`JAVA_OPTIONS`. 确保您的应用程序正在使用您想要的参数：

*   java自带的open `jvisualvm`。如果您在路径中正确设置了 java，只需在命令行中键入“jvisualvm”。
*   打开虚拟机启动到您的应用程序。
*   [检查“概述](http://visualvm.java.net/overview_tab.html)”选项卡中的“JVM 参数”下。

应该设置你的 jvm 选项。

# c# - 洪水填充实施

> ID：14633999
> 
> 赞同：6
> 
> 时间：2013-01-31T19:52:42.453
> 
> 标签：c#, flood-fill

这是我基于堆栈的洪水填充算法的 C# 实现（我基于维基百科的定义）。早些时候在编码时，我只想看到它工作。它确实做到了。然后，我想知道实际**填充**的像素数。所以在我的代码中，我将返回类型更改为 int 并返回**“ctr”**变量。但是后来**ctr**大约是实际填充像素数的两倍（我制作了一个单独的函数，其唯一目的是计算这些像素 - 只是为了确定）。

**任何人都可以了解变量“ctr”**如何以及为什么会增加两倍吗？

* **Pixel**类仅用作位图中像素的 x、y 和颜色值的容器。

```
public Bitmap floodfill(Bitmap image, int x, int y, Color newColor)
{
    Bitmap result = new Bitmap(image.Width, image.Height);
    Stack<Pixel> pixels = new Stack<Pixel>();
    Color oldColor = image.GetPixel(x, y);
    int ctr = 0;

    pixels.Push(new Pixel(x, y, oldColor));

    while (pixels.Count > 0)
    {
        Pixel popped = pixels.Pop();

        if (popped.color == oldColor)
        {
            ctr++;
            result.SetPixel(popped.x, popped.y, newColor);

            pixels.Push(new Pixel(popped.x - 1, popped.y, image.GetPixel(x - 1, y));
            pixels.Push(new Pixel(popped.x + 1, popped.y, image.GetPixel(x + 1, y));
            pixels.Push(new Pixel(popped.x, popped.y - 1, image.GetPixel(x, y - 1));
            pixels.Push(new Pixel(popped.x, popped.y + 1, image.GetPixel(x, y + 1));
        }
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T20:05:12.313

您确实在此处检查像素的颜色：

```
if (popped.color == oldColor) 
```

但是 popped.color 可能（并且显然在 50% 的情况下）已经过时了。因为在将像素插入堆栈时不检查重复项，所以会有重复项。弹出这些重复项后，颜色属性早就被保存了。

也许用一张图会更清楚：

![图解说明](../Images/501051a458e35c404a0706130c3cd162.png)

作为一个例子，我拍摄了一张 9 像素的位图。在第一个窗格中，您有像素的编号，在右侧有您的堆栈。

您从第 5 号像素开始，然后将第 2、4、6 和 8 号像素压入堆栈。然后你取下像素 2 并按下 1 和 3。在下一步中你弹出 1 并按下 2 和 4（再次！）。然后你可能会拿 2 并意识到它在推送时已经获得了新的颜色。（有点晚了，但迟到总比没有好）但是：像素号。4 出现了两次，又想起了旧颜色**两次**。所以你拿 4 号像素并给它上色。

一些步骤之后，您已经填充了图像，并且您的堆栈中仍然有一些项目。因为旧的颜色值仍然存储在这些项目中，所以它们会再次计数。

虽然我可能在堆栈中有错误的排序，但这一点仍然有效。

解决您的问题：快速而肮脏（因为它仍然效率低下）

```
if (image.GetPixel(popped.x, popped.y) == oldColor) 
```

它仅在当前颜色错误时才计算像素，而不是记住的颜色。

推荐：在将它们推入堆栈之前检查您的像素是否需要着色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T20:08:51.880

如果 Pixel 所做的只是保存传递给其构造函数的颜色，则在填充像素后它不会更新颜色，因此每个像素可以增加 ctr 多次。

如果您更改 Pixel 以在其构造函数中获取指向图像的指针，您可以重新读取颜色（即，将颜色设置为读取当前颜色的 get 属性），或者跟踪已经填充的坐标并且不要再推动那些时间。

[编辑]

如果从接受的答案中看不出来，GetPixel 会返回一个 Color - 一种值类型。可以把它想象成一个 int，它对当时像素的 RGB 值进行编码。

如果您想快速执行填充，请查看 Graphics.FloodFill 示例。

如果您的目标是学习，我建议您将图像数据复制到一个数组中进行处理并再次返回 - 大多数经典图像算法使用 GetPixel() 并没有多大乐趣。