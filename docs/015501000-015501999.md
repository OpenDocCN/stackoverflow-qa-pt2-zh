# StackOverflow 问答 15501000-15501999

# css - 使用 CSS 设置 GWT 根面板的样式

> ID：15501000
> 
> 赞同：0
> 
> 时间：2013-03-19T13:34:46.053
> 
> 标签：css, gwt

我为我的基本根面板声明了以下 CSS 类。

```
#rootPanel
{
width: 100%;
height: 100%;
background-image:url("../images/green013.jpg");
} 
```

我的小部件都使用 %ages 定位，因此无论屏幕宽度如何，它们都会出现在视图面板的中心。问题出在我的背景图片上。如果我将根面板尺寸设置为 800 像素和 800 像素，它不会重复填充背景。如果我出于某种原因使用 %ages 似乎它不会重复？有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:26:33.530

是的，你是对的。图像不以 % 重复。对于重复图像，您必须在 Pixel 中指定高度和宽度。当我设置为像素时，我面临同样的问题，它会工作！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:48:00.577

如果你想摆脱 %`height`并不管%`width`设置它们，然后使用`Pixel``browser size`

```
RootPanel.get().setHeight(Window.getClientHeight()+"px"); 

RootPanel.get().setWidth(Window.getClientWidth()+"px"); 
```

然后应用你的风格。

# jquery - Jquery - 带有异步脚本标签的 Facebook 按钮动态加载未初始化两次

> ID：15501001
> 
> 赞同：0
> 
> 时间：2013-03-19T13:34:48.857
> 
> 标签：jquery, facebook, asynchronous, initialization

我正在使用来自 Facebook 的异步脚本加载技术，将动态上的点赞按钮显示到容器加载的 ajax 页面中。我第一次加载该网站，按钮将正确显示..

..但是如果我使用 html('') 从父容器中卸载页面并以相同的方式再次加载，则不再初始化like按钮。Firebug 向我显示脚本已加载到正确的 div 但未执行。

我像这样加载带有like按钮的子页面（在ini和站点导航上相同）：

```
$.ajax({
    url: url+'holdslikebutton.php?rnd='+Math.random()+'&ajax=yes',
    //cache: false,
    success: function(data) {
        showFBButton();
    }
}); 
```

类似按钮的脚本如下所示：

```
function showFBButton() {
    var html =
        '<div id="fb-button">'
        + '<div class="fb-like" data-href="https://www.facebook.com/xxx" data-send="false" data-layout="button_count" data-width="70" data-show-faces="false" data-action="like"></div>'
        + '<div id="fb-root"></div>'
        + '</div>';
    $('#fb-viewport').html(html);
    window.setTimeout( function () {
        var e = document.createElement( 'script' );
        e.async = true;
        e.src = document.location.protocol + '//connect.facebook.net/'+fblang+'/all.js#'+Math.random()+'&xfbml=1&appId=xxx';
        document.getElementById( 'fb-root' ).appendChild( e );
        document.getElementById( 'fb-button' ).removeAttribute( 'class' );
    }, 2000 );
return true;
}; 
```

当我从每个导航的站点之间加载holdslikebutton.php 时，为什么脚本不会初始化。我需要做些什么来触发 all.js 的执行吗？但是为什么它会使用 browser-url 或浏览器重新加载从外部加载站点。

这并不复杂。也许我监督一些事情？我被困住了，我很高兴知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:06:38.020

FB 插件的渲染仅发生在 SDK 初始化时 DOM 中的元素。

要重新解析新插件标签的 DOM（或其部分），需要使用[FB.XFBML.parse](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)完成。

（之前在这里讨论过多次……）

# php - 注销后必须刷新页面才能获得正确的代码

> ID：15501003
> 
> 赞同：0
> 
> 时间：2013-03-19T13:35:00.440
> 
> 标签：php, login, logout, page-refresh

```
$loggedin = false; 
if ($_SESSION) { //user loggedin
    $loggedin = true;
    ...//get token
}
...
if($loggedin){
echo 'Hi '.$user['name'];
}
else{
echo 'Please log in';
}
... 
```

我想当我退出时网页会显示“请登录”。但它说“/src/myproject/index 第 80 行未定义的 $user 变量”。在我刷新页面后，它说“请登录”。

这里有什么问题？感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:22:00.037

根据我从您的伪代码中可以看出，您在 $_SESSION 变量中有某种键，表示用户已登录。

为了演示，假设您执行类似... 用户登录后，您分配 $_SESSION['user'] = 用户信息数组。这些键之一是“名称”。

所以，你的代码应该是这样的

```
$loggedin = false;
if (isset($_SESSION['user'])) {
    $loggedin = true;
}

if ($loggedin) {
    echo "Hi " . $_SESSION['user']['name'];
}
else {
    echo "You are not logged in."
} 
```

请记住，这只是您发布的代码示例的解决方案。要正确执行此操作，我建议进行以下更改：

*   创建一个处理身份验证的类
*   在该类中创建方法以确定用户是否已登录
*   创建返回当前登录用户的方法。

这将使您的代码在未来更具可扩展性、可重用性和更容易遵循。

祝你好运。

# function - 如何在由多个接口实现的序列图中显示一个功能？

> ID：15501010
> 
> 赞同：1
> 
> 时间：2013-03-19T13:35:11.700
> 
> 标签：function, interface, uml, sequence-diagram

我想画一个序列图。一个类为 B 类的一个实例调用一个函数 f。B 类由两个接口 X 和 Y 实现。

X 和 Y 都实现了 f。我应该如何表示 f 函数来自接口 X 或 Y？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:43:40.707

使用`X::f`或`Y::f`（即两个冒号而不是点）

UML 规范说

> CallEvent 由触发操作的名称表示 (...)
> 
> ```
> <call-event> ::= <name> [‘(‘ [<assignment-specification>] ‘)’] 
> ```

接口是命名空间的一种特殊化（通过分类器），那么以下适用：

> 如果名称为 N 的命名空间的成员是名称为 x 的 NamedElement，则该成员可以由格式为 N::x 的限定名称引用。

# ios - 如何从应用程序中识别企业（企业）iOS 设备？

> ID：15501011
> 
> 赞同：4
> 
> 时间：2013-03-19T13:35:14.660
> 
> 标签：ios, objective-c, enterprise

我正在开发一些应用程序，以便通过企业计划分发到公司 iPad 上（因此我/公司可以完全控制它们）。在公司拥有的设备的上下文中，如果有一种方法来识别运行应用程序的设备，那么“正确”是什么？

此处推荐的 CFUUIDCreate [UIDevice uniqueIdentifier Deprecated - What To Do Now？](https://stackoverflow.com/questions/6993325/uidevice-uniqueidentifier-deprecated-what-to-do-now)不起作用，因为多个应用程序的 id 必须相同。

现在[如何以编程方式获取 iphone 的 MAC 地址](https://stackoverflow.com/questions/677530/how-can-i-programmatically-get-the-mac-address-of-an-iphone)看起来是最好的方法，但我对 Apple 的东西很陌生，想知道是否有更好的方法。

iPad 是供仓库使用的，标识设备是为了标识 iPad 分配到哪个仓库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:51:11.603

我也运行一个企业程序，你是对的，Apple 提供的新 UUID 部分没有用。它们不仅在应用程序之间不一样，而且如果用户删除并重新下载您的企业应用程序，它们也不相同。

由于您不是通过 App Store 分发的，因此您不会因为使用 [UIDevice uniqueIdentifier] 而被关闭，而且它今天仍然可以在 iOS 中使用。我亲自发送了那个和 MAC 地址，并祈祷这将在未来的版本中继续工作。Apple 将来可能会开始为 UUID 返回 @"" 或其他一些空字符串，因此请做好准备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:56:57.400

我们在我们的项目中使用[OpenUDID](https://github.com/ylechelle/OpenUDID)作为持久性跨应用标识符作为已弃用 UDID 的替代品。

**用法：**

```
#include "OpenUDID.h"
NSString* openUDID = [OpenUDID value]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T22:21:54.483

在 iOS7（测试版）中，UIDevice uniqueIdentifier 现在的行为类似于 identifierForVendor。即每个应用程序的 ID 会有所不同，并且在重新安装应用程序时也会重置。

# ios - restkit - 映射关系有问题......或其他东西

> ID：15501016
> 
> 赞同：1
> 
> 时间：2013-03-19T13:35:22.427
> 
> 标签：ios, core-data, restkit

设置 - 使用 RestKit，以及它在 CoreData 存储中存储数据的能力。

我正在尝试执行两个单独的 GET 操作：

**issue/:issueId** ==> 这将返回一个问题对象，假设存在具有该 ID 的对象。 **issue/:issueId/comment** ==> 这将返回 Comment 对象，属于与 issueId 匹配的问题。

所以，对于第一个电话，这只是一个问题。如果我在 URL 上传递一个额外的参数，它只会返回评论。否则，它不会。当然，如果我确实要求它，那么对象就会很好地创建，并且所有对象都在我的核心数据存储中正确连接。

我正在映射的对象如下所示：

```
@interface Issue : NSManagedObject
@property (nonatomic) int32_t issueId;
@property (nonatomic, retain) NSSet* comments;
// many other fields not shown.
@end

@interface Comment: NSManagedObject 
@property (nonatomic) int32_t commentId;
// many other fields not shown.
@end 
```

问题有一组评论。评论不知道他们拥有的问题。

所以，我要做的就是让这两个调用都存在。

例如，在我们的 URL 中，说“issueId”是 12345。所以，如果我调用[http://example.com/issue/12345](http://example.com/issue/12345)，我希望将数据写入我的 CoreData 存储。（这很好用，顺便说一句）。接下来我想调用“ [http://example.com/issue/12345/comments](http://example.com/issue/12345/comments) ”，然后将这些评论写入CoreData 存储，并连接到已经存在的issue-12345。这就是我遇到麻烦的部分。

如果有人可以就此提供指导，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T06:24:35.357

在官方 repo 上阅读[此问题](https://github.com/RestKit/RestKit/issues/1225)后，我将按如下方式进行。

在您的核心数据模型中添加反向关系`Comment -> Issue`，以便您的`Comment`界面看起来像

```
@interface Comment: NSManagedObject 
@property (nonatomic, retain) Issue * issue;
@property (nonatomic) int32_t commentId;
// many other fields not shown.
@end 
```

并使这种关系成为强制性的。

现在您必须设置映射添加该关系，例如

```
[issueMapping addRelationshipMappingWithSourceKeyPath:@"comments"
                                              mapping:[self commentMapping]]; 
```

如果我的理解是正确的，`RestKit`应该为你填充两种关系（一对多`Issue -> Comment`和它的逆）。

# wordpress - Wordpress the_loop 和 the_post 管理端 - 下载 html

> ID：15501026
> 
> 赞同：0
> 
> 时间：2013-03-19T13:35:40.103
> 
> 标签：wordpress, download, admin

我正在尝试在 wordpress 中强制下载 html 管理端。

我有以下代码在作为 admin_menu_page() 的一部分执行管理端时可以正常工作。

```
$wp_querya = new WP_Query( $args );
if ( $wp_querya->have_posts() ) {
 while ( $wp_querya->have_posts() ) : $wp_querya->the_post(); ?>
  <div class="section" id="post_<?php the_ID(); ?>">
  <h2><?php the_title(); ?></h2>
  <div><?php the_post_thumbnail('thumbnail'); ?></div>
  <div><?php the_content(); ?></div>
  </div>
 <?php endwhile;
} 
```

然而，为了强制下载，我需要在此之前挂钩，所以当执行相同的代码但从操作 plugins_loaded() 中时，它会在 the_post() 处停止执行。因此不会生成循环内的所有内容。

我只想强制下载循环中的内容，而不是通常围绕页面的所有管理菜单栏。

我该怎么做呢？我正在创建它作为我正在开发的插件的一部分。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:18:27.123

希望这会阻止某人发疯，我不确定为什么会这样，而上述方法不起作用，但它解决了问题。如果有人知道为什么，请随时添加原因。

```
query_posts( $args );
if (have_posts() ) {
 while ( have_posts() ) : the_post(); ?>
  <div class="section" id="post_<?php the_ID(); ?>">
  <h2><?php the_title(); ?></h2>
  <div><?php the_post_thumbnail('thumbnail'); ?></div>
  <div><?php the_content(); ?></div>
  </div>
 <?php endwhile;
} 
```

# java - 等于 Cursor.getstring() 的字符串数组给了我 NullPointer 异常

> ID：15501027
> 
> 赞同：0
> 
> 时间：2013-03-19T13:35:42.707
> 
> 标签：java, android

这是我的android项目中的代码，我想将光标中的每个字符串元素存储到字符串数组中，但我不断收到`NullPointer`异常。

代码在下面，`series2Strings[]`是我定义的字符串数组，

```
int k=0;
        if(cur.moveToFirst()){
            while(!cur.isAfterLast()){

                Log.i("String", " "+ k + " " + cur.getString(1));
                series2Strings[k]=cur.getString(1);
                k++;
                cur.moveToNext();
            }
        }

        cur.close(); 
```

数据在光标处可用，因为我已经使用 log 语句在 logcat 中检查了它。谁能指出出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:39:17.560

你需要先初始化你的字符串数组..

```
series2Strings = new String[cur.getCount()];
int k=0;
if(cur.moveToFirst()){
    while(!cur.isAfterLast()){

      Log.i("String", " "+ k + " " + cur.getString(1));
       series2Strings[k]=cur.getString(1);
        k++;
         cur.moveToNext();
       }
 }
 cur.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:45:23.963

```
final int length = cur.getCount();
series2Strings = new series2Strings[length]; 
```

# javascript - 触发事件

> ID：15501029
> 
> 赞同：0
> 
> 时间：2013-03-19T13:35:52.367
> 
> 标签：javascript, jquery, html

```
$(this.element).live('mouseleave', function(evt){
$(this.element).trigger("mouseup");
}); 
```

我正在尝试在其 mouseleave 上触发相同元素的 mouseup 事件，但它无法正常工作，任何人都可以建议我进行需要更改

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:40:27.267

当您处理事件时，您正在更改上下文。

尝试：

```
$(this.element).live('mouseleave', function(evt){
 $(this).trigger("mouseup");
}); 
```

但是，这可能不是执行您要实现的任何目标的正确方法-如果没有更广泛的代码示例，就很难说。

您可以声明您是自己的处理程序，然后调用包装每个事件的处理程序 - 这可能是一个更好的解决方案！

# 编辑

回应评论：

你可以这样做：

```
var myOnMouseUp = function(event){
  console.log('Do something on mouse up')
}

$(this.element).live('mouseleave', myOnMouseUp);

$(this.element).live('mouseup', myOnMouseUp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:42:22.023

这应该可以正常工作：

```
$("#test").on("mouseup",function(){
alert("Mouse up triggered!");
});
$("#test").on('mouseleave', function(evt){
$("#test").trigger("mouseup");
}); 
```

其中“测试”只是一个链接。

[http://jsfiddle.net/8D26W/](http://jsfiddle.net/8D26W/)

# php - div里面的php echo

> ID：15501030
> 
> 赞同：8
> 
> 时间：2013-03-19T13:35:52.693
> 
> 标签：php

我有这个：

```
<?php  
       if ( ($cart->count_product) > 0) { 
           print $cart->count_product; 
       } else { 
           print ''; 
       }  
?> 
```

我需要把`print $cart->count_product`里面`<div class="my_class"></div>`

我尝试了不同的方法，但我在语法上遗漏了一些东西。如果有人可以提供帮助，我会很高兴。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-19T13:37:17.887

您可以执行以下操作：

```
echo '<div class="my_class">';
echo ($cart->count_product > 0) ? $cart->count_product : '';
echo '</div>'; 
```

如果您想将其包含在您的语句中，请执行以下操作：

```
if($cart->count_product > 0) 
{
    echo '<div class="my_class">'.$cart->count_product.'</div>';
} 
```

您不需要该`else`声明，因为无论如何您只会在上面的内容为真时才输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T13:37:09.117

试试这个，

```
<?php  if ( ($cart->count_product) > 0) { ?>
         <div class="my_class"><?php print $cart->count_product; ?></div>
<?php } else { 
          print ''; 
}  ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T13:37:30.480

那就把它包起来吧。

```
<?php        
    if ( ($cart->count_product) > 0) 
    { 
        echo "<div class='my_class'>";
        print $cart->count_product; 
        echo "</div>";
    }

?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T13:37:57.213

你可以这样做：

```
<div class"my_class">
<?php if ($cart->count_product > 0) {
          print $cart->count_product; 
      } else { 
          print ''; 
      } 
?>
</div> 
```

在点击之前`div`，我们不在 PHP 标签中

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-19T13:38:34.437

你也可以这样做，

```
<?php 
if ( ($cart->count_product) > 0) { 
  $print .= "<div class='my_class'>"
  $print .= $cart->count_product; 
  $print .= "</div>"
} else { 
   $print = ''; 
} 
echo  $print;
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T13:39:07.877

您可以使用下面的示例，也不需要 else 子句来打印任何内容！

```
 <?php if ( ($cart->count_product) > 0) { ?>
           <div class="my_class">
               <?php print $cart->count_product; ?> 
           </div>
 <?php } ?> 
```

# java - 为什么可以克隆没有类型转换的数组？

> ID：15501032
> 
> 赞同：4
> 
> 时间：2013-03-19T13:35:57.793
> 
> 标签：java, arrays, clone

发现我可以做到以下几点：

```
package test.java.lang;
import java.util.Arrays;

    public class Tester_ArrayCloning_01 {

        public static void main(String[] args) {
            double[] vals1 = {1.2, 2.3, 3.4, 4.5};
            double[] vals2;

            // vals2 = (double[])vals1.clone(); // was thinking should do so
            vals2 = vals1.clone(); // but happened can do so

            System.out.println(Arrays.toString(vals2));
        }

    } 
```

为什么？什么时候介绍的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T13:38:18.353

从[JLS 的第 10.7 节，数组成员](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7)：

> 数组类型的成员全部如下：
> 
> ...
> 
> *   公共方法`clone`，它覆盖了 Object 类中的同名方法，并且不抛出任何已检查的异常。数组类型 T[] 的克隆方法的返回类型是 T[]。

[第三版](http://docs.oracle.com/javase/specs/jls/se5.0/html/arrays.html#10.7)中的相同部分具有相同的内容。

第二[版](http://titanium.cs.berkeley.edu/doc/java-langspec-2.0.pdf)说数组类型会覆盖`clone()`，但那时没有返回类型协变，所以他们不可能这样做返回`T[]`。

所以基本上它是在 1.5 中引入的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T13:39:43.607

`clone`类型数组的方法的返回类型`T[]`是`T[]`。由于`Object.clone()`return`Object`这样的定义需要协变返回类型，这是在 Java 5 中引入的。

[以前](http://csclub.uwaterloo.ca/~mmmulani/langspec-2.0/arrays.doc.html)，`clone`被定义为返回`Object`。这尤其是协变返回类型适合的问题，

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-19T13:39:47.267

Java 5 引入了**协变返回类型**，它允许任何代码（包括您自己的代码）利用它们。一般特性允许重写方法声明一个返回类型，它是原始返回类型的子类型。请注意，变量的声明类型必须正确才能使其正常工作。例如，以下内容无法编译：

```
Object vals1 = {1.2, 2.3, 3.4, 4.5};
double[] vals2;
vals2 = vals1.clone(); 
```

# php - 如何在 iframe 中加载 codeigniter 视图

> ID：15501034
> 
> 赞同：0
> 
> 时间：2013-03-19T13:36:00.930
> 
> 标签：php, codeigniter, iframe, view

我尝试在 iframe 中加载 codeigniter 视图， `<iframe src="<?php $this->load->view('lists');?/>"></iframe>` 但页面无法加载。没有我框架它的工作。如何在 iframe 中加载此视图？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T16:14:08.483

在你的控制器中创建一个函数

```
//project.php

function view_list()
{
$this->load->view('lists');
} 
```

并像这样在视图页面中调用

```
<iframe src="<?php echo site_url('project/view_list');?>">>    </iframe> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:43:53.863

您不能将纯 html 分配给 iframe 元素的 src 属性。您应该有一个控制器来呈现您的 html，然后将 src 属性设置为该控制器。

```
<iframe src="<?php echo base_url( 'controller_that_render_list_html' ) ?>"></iframe> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-28T14:48:18.767

I wanted to tile a site with several views, each in their own iframe, this is what I did:

The controller, **book.php**

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Book extends CI_Controller {

    public function index(){
        $this->shell();
    }

    public function shell(){

        $data['title'] = "Home";
        $data['frames'] = array(
            "book/events"
            ,"book/sales"
            ,"book/purchases"
            ,"book/cashflows"
        );

        $this->load->view("shell", $data);

    }

    public function events(){
        $this->load->view("events");
    }

    public function sales(){
        $this->load->view("sales");
    }

    public function purchases(){
        $this->load->view("purchases");
    }

    public function cashflows(){
        $this->load->view("cashflows");
    }

} 
```

The view **shell.php** contains a foreach statement letting me pass in tiles dynamically. Note how the url's to each site are written in the controller above ^^ (eg. "book/events").

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title><?php echo $title ?></title>     
    </head>
    <body>

        <?php foreach ($frames as $frame):?>
            <iframe src="<?php echo $frame?>"></iframe>
        <?php endforeach;?>

        <div class="footer">
            Page rendered in <strong>{elapsed_time}</strong> seconds</p>
        </div>
    </body>
</html> 
```

Then each tile is simply it's own site, like so:

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Events</title>       
    </head>
    <body>
        <div class="header">Events</div>
        <div class="content"> Bla bla bla you have no money</div>
        <div class="footer">
            Page rendered in <strong>{elapsed_time}</strong> seconds</p>
        </div>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T13:42:32.343

这是因为 iframe 在另一个页面上？您尚未在该页面上指定控制器功能，因此它无法识别视图。我认为您必须将视图中的控制器日期放入您拥有 iframe 的视图的函数中，就像这样。

```
function list_view()
{
//functions for your listview
}

function viewforiframe()
{
//function for you view where the iframe is located
+
//functions for your listview
} 
```

注意：Deon 给出的答案也是值得一看的。如果没有良好的链接，您将永远看不到视图。

# opencv - 使用 openCV 进行 OCR 检测

> ID：15501036
> 
> 赞同：0
> 
> 时间：2013-03-19T13:36:02.307
> 
> 标签：opencv, surf, matchtemplate

我正在尝试通过使用 openCV 创建一个更简单的 OCR 引擎。我有这张图片：[https ://dl.dropbox.com/u/63179/opencv/test-image.png](https://dl.dropbox.com/u/63179/opencv/test-image.png)

我已将所有可能的字符保存为图像并尝试在输入图像中检测这些图像。

从这里我需要识别代码。我一直在尝试 matchTemplate 和 FAST 检测。两者似乎都失败了（或者更有可能：我做错了什么）。

当我使用 matchTemplate 方法时，我使用 Sobel 找到了输入图像和参考图像的边缘。这提供了一个工作结果，但准确性不够好。

使用 FAST 方法时，我似乎无法从 cvExtractSURF 方法中获得任何有趣的描述。

关于能够阅读此类代码的最佳方式的任何建议？

**更新 1 (2012-03-20)**

我已经取得了一些进展。我试图找到字符的边界矩形，但矩阵字体正在杀死我。请参阅以下示例：

我的字体：[https ://dl.dropbox.com/u/63179/opencv/IMG_0873.PNG](https://dl.dropbox.com/u/63179/opencv/IMG_0873.PNG)

我的字体填写：[https ://dl.dropbox.com/u/63179/opencv/IMG_0875.PNG](https://dl.dropbox.com/u/63179/opencv/IMG_0875.PNG)

其他字体：[https ://dl.dropbox.com/u/63179/opencv/IMG_0874.PNG](https://dl.dropbox.com/u/63179/opencv/IMG_0874.PNG)

正如在示例中看到的，我发现了一种不太复杂的字体的边界矩形，如果我可以填充字体中点之间的空间，它也可以工作。有没有办法用opencv实现这一点？如果我能找到每个字符的边界框，那么识别字符会容易得多。

有任何想法吗？

**更新 2 (2013-03-21)**

好的，我很幸运找到了边界框。见图片： [https ://dl.dropbox.com/u/63179/opencv/IMG_0891.PNG](https://dl.dropbox.com/u/63179/opencv/IMG_0891.PNG)

我不知道从这里去哪里。我尝试使用 matchTemplate 模板，但我想在这种情况下这不是一个好的选择？我想在更大的图片中搜索完全匹配时会更好？

我尝试使用 surf 但是当我尝试使用 cvExtractSURF 为每个边界框提取描述符时，我得到 0 个描述符......有什么想法吗？

哪种方法最适合用于将边界框与参考图像进行匹配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T13:44:06.493

使用 FASt+SURF 会很辛苦，因为它们不是为这项任务而设计的。特别是，FAST 检测到在运动结构中普遍存在的角状特征，但在 OCR 中则少得多。

两个建议：

1.  也许从 FAST 关键点的数量和位置构建一个特征向量，我认为 oyu 可以快速检查这些特征是否足够精确，如果是，则从中训练分类器
2.  （我自己会选择的那个）将您的图像样本划分为较小的正方形。仅计算每个正方形的 SURF 描述符，并将它们全部连接起来以形成给定样本的特征向量。然后用这些特征向量训练一个分类器。

请注意，选项 2 适用于您可以在 OpenCV 中找到的任何描述符（SIFT、SURF、FREAK...）。

**回答更新 1**

这是我开始时前辈教我的一个小技巧。在带有点的图像上，您可以将二值化数据投影到水平轴和垂直轴。通过在投影模式中搜索漏洞（断开），您可能会恢复示例中的几乎所有 boudnig 框。

**回答更新2**

在这一点上，你又回到了我最初的答案：SURF 在这里没有用。相反，一种标准的方法是对每个边界框进行二值化（根据背景/字母将边界框归一化为 0 - 1），将边界框标准化为标准大小，然后从这里训练分类器。

网上有几篇关于如何使用神经网络或 SVM 进行数字识别的教程和博客文章，您只需用字母替换数字即可。

你的工作快完成了！训练和使用分类器很乏味但很简单。

# php - How send a message using SIP/SDP protocol in php

> ID：15501037
> 
> 赞同：1
> 
> 时间：2013-03-19T13:36:10.520
> 
> 标签：php, udp, sip, sdp

What i'm trying to do is implement a SIP client which listens for SIP messages.Ok so i have run the SIP client on a server `192.168.0.246` and the SIP server is running on `192.168.2.40`.Now have a look at the below screen shot.

![enter image description here](../Images/36b782ab374cae2c47e8ea484995a9ac.png)

Its a trace file of the server running the client code on `192.168.0.246`. As u can see the server receives messages from `192.168.2.40` using SIP/SDP protocol but when the client program running on 192.168.0.246 sends back message to 192.168.2.40 using UDP protocol its shown as UDP protocol, which is correct.But no response from 192.168.2.40 after this. So i'm assuming it has something to do with the protocol shown as `UDP`.So if i'm rite i should get that to SIP/SDP.

So my question is how to make this UDP change to SIP/SDP.

And here is my php code:

```
<?php

//Reduce errors
error_reporting(~E_WARNING);

//Create a UDP socket
if(!($sock = socket_create(AF_INET, SOCK_DGRAM, 0)))
{
    $errorcode = socket_last_error();
    $errormsg = socket_strerror($errorcode);

    die("Couldn't create socket: [$errorcode] $errormsg \n");
}

echo "Socket created \n";

// Bind the source address
if( !socket_bind($sock, "192.168.0.246" , 5060) )
{
    $errorcode = socket_last_error();
    $errormsg = socket_strerror($errorcode);

    die("Could not bind socket : [$errorcode] $errormsg \n");
}

echo "Socket bind OK \n";

//Do some communication, this loop can handle multiple clients

function GetBranchValue($message)
{
    $data = "";
    if(preg_match('/branch=.*/i', $message, $output))
        $data = explode("=",$output[0]);
    if(sizeOf($data)>1)
        return $data[1];
    else
        return "None";
}

function GetTag($message)
{
    $data = "";
    if(preg_match('/tag=.*/i',$message, $output))
        $data = explode("=", $output[0]);
    if(sizeOf($data)>1)
        return $data[1];
    else
        return "None";
}

function GetCallId($message)
{
    $data = "";
    if(preg_match('/Call-ID:.*/i', $message, $output))
        $data = explode(":",$output[0]);
    if(sizeOf($data)>1)
        return $data[1];
    else
        return "None";
}

function GetCSeq($message)
{ 
    $data = "";
    if(preg_match('/CSeq:.*/i', $message, $output))
    {
        $data = explode(":", $output[0]);
        $data = explode(" ",$data[1]);
    }
    if(sizeOf($data[1])>0)
        return $data[1];
    else
        return "None";
}

function CreateResponse($message)
{
    $msg = "SIP/2.0 302 Moved temporarily
Via:SIP/2.0/UDP 192.168.2.40:5060;branch=".GetBranchValue($message)."
From: <sip:+12012030008@192.168.2.40:5060>;tag=".GetTag($message)."
To:<sip:+17066458407@192.168.0.246:5060;user=phone>;tag=883069368-1363286882583
Call-ID:".GetCallId($message)."
CSeq:".GetCSeq($message)." INVITE
Contact:<sip:+17066458407@192.168.0.246:5060;user=phone>;q=0.5,<sip:+17066458407@192.168.0.246:5060;user=phone>;q=0.25
Content-Length:0";
    return $msg;
}

function Create300Response($message)
{
    $msg = "SIP/2.0 300 Multiple Choices
Via: SIP/2.0/UDP 192.168.2.40:5060;branch=".GetBranchValue($message)."
From: <sip:+12012030008@192.168.2.40:5060>;tag=".GetTag($message).";isup-oli;isup-oli=00
To:<sip:+17066458407@192.168.0.246:5060;user=phone>;tag=123
Contact: <sip: +17066458407@192.168.0.246:5060;dtg=16>
Contact: <sip: +17066458407@192.168.0.246:5060;dtg=16>
Contact: <sip: +17066458407@192.168.0.246:5060;dtg=16>
Contact: <sip: +17066458407@192.168.0.246:5060;dtg=16>";
    return $msg;
}

while(1)
{
    echo "Waiting for data ... \n";

    //Receive some data
    $r = socket_recvfrom($sock, $buf, 512, 0, $remote_ip, $remote_port);
    echo "$remote_ip : $remote_port -- " . $buf;
    file_put_contents("Log.txt","\n",FILE_APPEND);
    file_put_contents("Log.txt","Received Response------\n",FILE_APPEND);
    file_put_contents("Log.txt",$buf,FILE_APPEND);
    $respMessage = Create300Response($buf);
    //Send back the data to the client
    socket_sendto($sock, "OK " . $respMessage , 100 , 0 , $remote_ip , $remote_port);
    file_put_contents("Log.txt","\n",FILE_APPEND);
    file_put_contents("Log.txt","\n",FILE_APPEND);
    file_put_contents("Log.txt",$respMessage,FILE_APPEND);
}

socket_close($sock); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T13:43:29.683

```
socket_sendto($sock, "OK " . $respMessage , 100 , 0 , $remote_ip , $remote_port);
//                    ^^ remove this 
```

The `OK` you are sending is not valid, it is a SIP protocol violation, and as a result the in-built SIP decoder in Wireshark does not recognise the message as a valid SIP packet.

You should just be responding with `$respMessage`

Also I highly recommend you use a proper parser for incoming messages and a proper object-oriented writer for constructing outgoing messages. SIP is a (some might say needlessly) complex protocol, you will need more than the small nuggets of information you are extracting to build an endpoint that can do anything even remotely useful.

[This small library](https://github.com/DaveRandom/lib822) of mine might make a good base for your parser, and indeed [this one](https://github.com/DaveRandom/lib2616) almost does exactly what you want if you replace `HTTP` with `SIP`.

# sql - ASP C# 查询删除内部连接表

> ID：15501038
> 
> 赞同：1
> 
> 时间：2013-03-19T13:36:14.150
> 
> 标签：sql

我有此代码用于更新，但如何将其更改为 DELETE 不更新。这可能吗？

```
update r set r.Status = 'Checked-in' from Reservation r 
inner join GuestInfo g on g.GuestID = r.GuestID 
where g.GuestFName = 'firstname' 
and g.GuestLName = 'lastname' 
and r.RoomNo = '103' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:38:25.167

像这样的东西应该工作：

```
delete r from Reservation r 
inner join GuestInfo g on g.GuestID = r.GuestID 
where g.GuestFName = 'firstname' 
and g.GuestLName = 'lastname' 
and r.RoomNo = '103' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T13:39:06.020

```
Delete from Reservation
where id in 
(select r.id from Reservation r 
inner join GuestInfo g on g.GuestID = r.GuestID 
where g.GuestFName = 'firstname' 
and g.GuestLName = 'lastname' 
and r.RoomNo = '103') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T13:38:45.797

绝对地！您可以简单地摆脱这些`UPDATE`部分并将关键字更改为`DELETE`：

```
delete Reservation
from Reservation r 
    inner join GuestInfo g on g.GuestID = r.GuestID 
where g.GuestFName = 'firstname' 
and g.GuestLName = 'lastname' 
and r.RoomNo = '103' 
```

事实上，这很常见。有很多时候你需要`DELETE`根据条件做一个更复杂的，而且*很多时候* `SELECT`和`UPDATE`语句可以**很容易**地变成一个`DELETE`. 事实上，我曾经工作过的一个地方，他们的规则是这样的：

> 编写`SELECT`语句，然后如果它为您获取数据，请摆脱`SELECT`并将其更改为`DELETE`-**但只有这样。**

# php - php5.4中未知错误的多维关联数组

> ID：15501040
> 
> 赞同：1
> 
> 时间：2013-03-19T13:36:20.607
> 
> 标签：php, multidimensional-array

我正在尝试输出多维数组中的所有数据，但是当我在浏览器中运行它时，我不断收到未知错误。据我所知，我所做的一切都是正确的。我也玩过单引号和双引号，仍然没有运气。希望一双新的眼睛可以做出一些事情。

```
$goods = array( 
    'foods'  => array(
            "desert"    => "chocolate cake",
            "fruit"     => "fuji apples",
            "veggies"   => "baby carrots",
            "poultry"   => "grilled chicken"),
    'drinks' => array(
            "soda"      => "coca cola",
            "juice"     => "florida orange",
            "coffee"    => "black",
            "beer"      => "heineken"););

echo "<pre>";
foreach ($goods as $section => $items)
    foreach ($items as $key => $description)
        echo "$section:\t$key\t($description)<br>";
echo "</pre>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:39:04.980

```
$goods = array( 
    'foods'  => array(
            "desert"    => "chocolate cake",
            "fruit"     => "fuji apples",
            "veggies"   => "baby carrots",
            "poultry"   => "grilled chicken"),
    'drinks' => array(
            "soda"      => "coca cola",
            "juice"     => "florida orange",
            "coffee"    => "black",
            "beer"      => "heineken"););
//REMOVE THAT SEMICOLON -->           ^ 
```

它会工作......

# eclipse-rcp - 我的更新站点上缺少我的 RCP 应用程序的依赖项

> ID：15501042
> 
> 赞同：2
> 
> 时间：2013-03-19T13:36:23.367
> 
> 标签：eclipse-rcp, eclipse-pde, p2, update-site

我正在创建一个 RCP 应用程序。我计划提供 p2 更新功能。

例如有 4 个插件：A,B,C,D

插件 A 和 B 代表我的 RCP 应用程序的核心功能。我创建了一个名为 com.myorg.feature.core 的功能。在 feature.xml 内部，在插件选项卡中，我添加了插件 A 和 B。

我在我的 RCP 应用程序的产品文件中添加功能 com.myorg.feature.core 作为依赖项。之后，我使用产品文件导出 RCP 应用程序（这里的产品是基于功能的产品）。

现在我又创建了两个功能。

```
com.myorg.feature.featureC
com.myorg.feature.featureD 
```

由于这些是我的 RCP 应用程序的可选功能，我希望用户选择是否安装它们。因此，用户将选择安装新软件选项，其中将列出此功能。

我面临的问题是，这些插件 C 和 D 正在使用某些 3rd 方库，例如 BIRT、NATTABLE。所以每次，我构建 featureC 或 featureD，把它放在更新站点上，然后我尝试将它们安装在我的应用程序中，它们显示依赖失败，比如`bundle missing: org.eclipse.birt.core`

我回到 featureC 的 feature.xml -> 插件选项卡 -> 添加 org.eclipse.birt.core 并再次构建功能。但是有几次我的 RCP 应用程序安装失败，错误包丢失。

是否有任何机制可以让我从一开始就确定所有必需的捆绑包？是否是为我的 RCP 应用程序启动更新或新的可安装单元的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T07:26:49.450

@Priank 最好在 feature.xml 的插件选项卡中添加所有依赖项，这只是一次努力。您可以从 feature.xml 的依赖项选项卡中计算所需的插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T15:53:27.767

对我来说，第一个问题应该是您是否真的想使用 Eclipse PDE 导出向导来提供更新。

相反，您应该为您的项目设置一个无头构建。如果您熟悉 PDE（并且碰巧不讨厌 Maven ;-)，那么[Tycho](http://www.eclipse.org/tycho/)可能是您的正确选择。（免责声明：我是 Tycho 项目的提交者，可能不知道所有潜在的替代方案。）

[您可以轻松地让 Tycho 在p2 存储库](http://wiki.eclipse.org/Tycho/Packaging_Types#eclipse-repository)中包含所有传递依赖项：只需将选项设置为`includeAllDependencies`tycho [-p2-repository-plugin](http://www.eclipse.org/tycho/sitedocs/tycho-p2/tycho-p2-repository-plugin/assemble-repository-mojo.html)。`true`

# sql - 在 SQL 中创建登录表

> ID：15501053
> 
> 赞同：1
> 
> 时间：2013-03-19T13:37:15.670
> 
> 标签：sql, database, database-design

我的目标是创建一个存储用户信息及其密码的表。另外，我想跟踪登录失败的次数。但是，以下是有关这些表的简要说明：

**第一：用户表**

UserNo：用户的ID

名称：用户名

电子邮件

**二：登录表**

UserNo: 和上一个一样

密码

**三：跟踪表**

用户编号

DateTime：登录的日期和时间

count：每次用户错误登录时都会增加的计数器。

从最后三张表来看，我不认为我所做的是一种专业的方式。有没有更好的想法？尤其是跟踪表。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:41:39.767

你为什么要把它们分开？为什么不只拥有一个包含 id、用户名、密码哈希、上次登录日期和失败尝试计数器的 users 表？

否则，您可以将登录尝试分开到它自己的表中并记录状态，例如成功或失败，这样您就可以按程序计算自上次成功尝试以来失败的尝试次数，并且它还提供对登录的完整审核，无论是否失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T13:42:06.640

您可能希望将前两个表合并在一起，因为每个用户只有一个密码，因此将用户的所有数据放在一个表的一行中是有意义的。

第三个表记录每次登录的时间戳，如果您添加额外的列，也可以记录每次失败登录的时间戳，然后查询将为您提供每个用户的失败登录总数。

或者，如果您正在计算自上次登录以来失败的登录次数，那么您可以再次将计数器放在第一个表中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T13:41:19.900

几点：

1.  除非您要保留密码历史记录，否则没有理由使用第二张表（在这种情况下，您需要一个额外的字段来跟踪密码的创建日期）

2.  在第三个表中，不要对错误登录次数使用计数器；相反，为每次登录尝试（成功或其他）写入记录，并在需要时使用查询来检索计数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T13:41:27.343

您可以将所有字段放在一个表中

```
UserID, UserName, UserEmail, Password, Login_Timestamp, Counter 
```

然后您可以将所有值保存在一个表中

# iphone - Objective-C 《星球大战》开场爬行

> ID：15501055
> 
> 赞同：-13
> 
> 时间：2013-03-19T13:37:19.180
> 
> 标签：iphone, ios, objective-c, ipad

如何为 iOS 做《星球大战》开场抓取？我尝试在 CSS3（3D 变换）上做，但速度很慢。是否可以在 Objective-C 上做到这一点？

请展示如何用 Objective-C 编写代码！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-19T13:41:46.057

在 Objective-C 中是可能的。

**只因为我好**

我们将从一个简单的旋转开始，看看会发生什么。如果你构建，你会看到我们有一个很好的旋转，但它看起来并不现实。我们也需要倾斜视角才能获得真正的效果。

```
UITextView *textView = [[UITextView alloc] initWithFrame:self.view.bounds];
[textView setAutoresizingMask:UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth];
[textView setBackgroundColor:[UIColor blueColor]];

[textView setText:@"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."];

[textView setFont:[UIFont boldSystemFontOfSize:32.0]];
[textView setTextAlignment:NSTextAlignmentCenter];

// Rotate the text
[textView.layer setTransform:CATransform3DMakeRotation(M_PI_4, 1.0, 0.0, 0.0)];

// Now we need to skew the box so the bottom is wider than the top.

[self.view addSubview:textView]; 
```

**到达那里！**

好吧，经过一番谷歌搜索，我们已经弄清楚了如何调整 m34 的值`CATransform3D`来调整我们正在寻找的视角。颜色也选对了！建造它，你会清楚地看到我们要去哪里。但是我们需要调整框架以确保它填满屏幕。然后我们可以添加一些自动滚动动画，这样我们就不必用手指滚动了。

```
// Learn the basics of matrix transforms: http://markpospesel.wordpress.com/tag/catransform3d/

UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(self.view.bounds, 32.0, 32.0)];
[textView setAutoresizingMask:UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth];
[textView setBackgroundColor:[UIColor blackColor]];
[textView setTextColor:[UIColor yellowColor]];
[textView setEditable:NO];

[textView setText:@"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum."];

[textView setFont:[UIFont boldSystemFontOfSize:36.0]];
[textView setTextAlignment:NSTextAlignmentCenter];

// Start with a blank transform
CATransform3D blankTransform = CATransform3DIdentity;

// Skew the text
blankTransform.m34 = -1.0 / 500.0;

// Rotate the text
blankTransform = CATransform3DRotate(blankTransform, 45.0f * M_PI / 180.0f, 1.0f, 0.0f, 0.0f);

// Set the transform
[textView.layer setTransform:blankTransform];

[self.view addSubview:textView]; 
```

# javascript - 为什么 jQuery UI 手风琴打开/关闭动画如此不稳定？

> ID：15501060
> 
> 赞同：8
> 
> 时间：2013-03-19T13:37:28.310
> 
> 标签：javascript, jquery, html, css, jquery-ui

我一直在尝试解决这个问题，但我看不到任何问题 - 同样，相同的手风琴（相同的 jqueryui 版本 1.9.2）在另一个站点上也没有问题，我什至将主题切换为使用与另一个站点相同的站点，但我仍然对这个站点感到不安。

它也不应该是 jquery ui 主题，因为它在**[这里工作正常](http://jqueryui.com/themeroller/#!zThemeParams=5d00000100f705000000000000003d8888d844329a8dfe02723de3e5701cc8cb8a0f4166c8f002bb384a9a94d46b66930ecd1d30314057ff273da42b98eb00a54151bb216e0852916c6debcbbde01cde4fee04d7414e88e86bab86f94d13524c78394d3779bca5e9cee5a9bd6e72704df51ca22463203df3ca722b1906974e05293a537a3298274dffb7ed4370965f74b3eb8ecdbca1bb94eafa5cacaf6b1909205bbda63315b42abd5a3baa7dd38fcfe88e407bf4dad81ebaab4062cfa3bb9047c193997a7a8423fef33848172f851f1d5879cd96271eea4a97741465e8f05e807411a5cd62cd5707eab7318631326e5c09c2ab866ab12ca601ac94790ca293d862591a380847ed26174ad04e428da9801bc2ad46e7a4eb82aeee1a620e87fbefb6bb273558b67eba8a693aec04af16afdeb224bce654d8104d2e764f2a609e35845ccb7a901b11f0d5feff36fe440cc6ea3e5b524f56c379ce20c26ec330697d691eca9049f984fb2111ce0aa9f5107cfc8d996fc211bb5d7239020c768d0b05969ac87f879f002a5255f34f1394916c1eb635809f50cf5246d9109376810f902676c0f751ca86c6e62185c5779f9c8330d086084137ae1705d25483e4d5869006ad6988c7889a61d3ee9f45bcbc3d7f94d60305213e2680b17e02da0fbde14eab712d91f29355fec97200)**

任何想法可能是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-09T14:52:14.720

对于未来的读者，当我没有将手风琴行的内容包装在 div 标签中时，我也遇到了这个问题：

**坏的：**

```
 <div class="accordion">
            <h3>Delivery Address</h3>
            <table class="address">
                <tr><td>...</td></tr>
            </table>
        </div> 
```

**好的：**

```
 <div class="accordion">
            <h3>Delivery Address</h3>
            <div>
                <table class="address">
                    <tr><td>...</td></tr>
                </table>
            </div>
        </div> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-19T13:46:46.280

```
.ui-accordion .ui-accordion-content {
    padding: 1em 2.2em;
} 
```

问题在于这个css。如果将其更改为 px 而不是 em，则它可以正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-16T20:55:43.160

我遇到了类似的问题。在寻找了一些不同的解决方案之后。我发现这是一个保证金问题。

这对我有用：

```
#accordion .ui-accordion-header {
    margin:0;
} 
```

顺便说一句，我已经`hightstyle`设置了内容。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-28T22:50:37.343

就我而言，这是由手风琴标题的边距和手风琴内容中元素的边距引起的。您需要将这些元素的边距设置为 0。如果要在这些元素之间添加空间，可以使用填充，它不会导致问题。

```
#accordion h3 {
margin: 0;
padding: 10px 0;
}
#accordion p {
    margin: 0;
    padding: 10px 0;
} 
```

我在手风琴内容的 div 中使用了段落标签。如果您使用其他东西，请确保该元素的边距设置为 0。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-12T11:12:17.670

动作流畅的关键是“heightStyle”EG

```
$( "#accordion" ).accordion({
    heightStyle: "content"
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T13:50:28.160

我认为您忘记在标签中添加所有文件依赖项

```
<script type='text/javascript' src='http://www.georgiancollege.ca/programs/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.georgiancollege.ca/programs/wp-includes/js/jquery/ui/jquery.ui.core.min.js?ver=1.9.2'></script>
<script type='text/javascript' src='http://www.georgiancollege.ca/programs/wp-includes/js/jquery/ui/jquery.ui.widget.min.js?ver=1.9.2'></script>
<script type='text/javascript' src='http://www.georgiancollege.ca/programs/wp-includes/js/jquery/ui/jquery.ui.accordion.min.js?ver=1.9.2'></script>
<script type='text/javascript' src='http://www.georgiancollege.ca/programs/wp-includes/js/jquery/ui/jquery.ui.button.min.js?ver=1.9.2'></script> 
```

包括所有依赖项，那么它应该可以正常工作..

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-13T15:03:06.767

我在 Drupal 中使用 Views Nested Accordion 构建的嵌套手风琴也遇到了类似的问题。我删除了 views-nested-accordion.css 的第 38 行`.ui-accordion .ui-accordion-content {height: auto !important;}`，它解决了我的问题。

# regex - 负数的正则表达式 (123.456,789-)

> ID：15501064
> 
> 赞同：1
> 
> 时间：2013-03-19T13:37:31.293
> 
> 标签：regex

我正在寻找一种模式来匹配末尾带有连字符的数字，如下所示：

```
125,000-
1.234,567-
60,000- 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T13:39:03.127

只需尝试以下正则表达式：

```
/\d[.,\d]*-/ 
```

甚至：

```
/\d([.,]?\d+)*-/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T15:06:25.617

***注意 Aleš Krajník 的答案与我最终*得到的答案基本相同，除了他使用非捕获分组（因为不需要捕获）......他应该像第一次一样获得投票恕我直言**

请注意，在下面的答案中，我假设`,`逗号是小数点分隔符，而`.`点是千位分隔符（例如，对于欧洲编号）。

我相信以下是“正确的”：

`^\d{1,3}(.\d{3})*(,\d+)?-$`

这匹配例如：

*   1-
*   12-
*   123-
*   123.456-
*   123.456.789-
*   1,0-
*   1,01-
*   1,001-
*   1,0001-
*   123.456,01-
*   123.456.789,0001-
*   ETC

但不会匹配，例如

*   1234-
*   123，-
*   123.4-
*   123.1,001-
*   123.45-
*   1..1..1-
*   1.1.1-
*   1,1,1-
*   .,-
*   等等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T13:41:29.640

确切的正则表达式应为：`\d{1,3}(?:\.\d{3})*(?:,\d+)?-`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T13:38:48.480

尝试这样的事情：

```
[0-9.,]+- 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-19T13:39:37.937

`\d{1,3}(?:[,]\d{3})*-`考虑到国际化。下面的一个允许字符串`1..9`匹配，这确实不应该。

# javascript - HTML 选项卡未预加载

> ID：15501067
> 
> 赞同：-1
> 
> 时间：2013-03-19T13:37:40.653
> 
> 标签：javascript, html, tabs

我对选项卡式内容有疑问。我下载了一个非常漂亮的 HTML/CSS/Javascript 内容标签。

问题是，当页面加载时，它会同时显示所有内容。只有完成加载后，它才会将其放入选项卡中。

有谁知道它为什么会这样做？我正在考虑与JS有关的事情，不幸的是我对JS一无所知。

如果需要，我可以发布 JS 代码。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T13:40:23.480

这样做的原因是您的 HTML（文档）在应用 JS 之前首先加载。因此，您将首先看到所有 HTML 内容。

解决此问题的一种解决方案是最初通过 CSS 隐藏内容，然后在 JS 将内容转换为选项卡式内容后显示它。

一个基本的例子可以在这里找到[http://jsfiddle.net/86pzN/](http://jsfiddle.net/86pzN/)

```
$(function(){
    setTimeout(function(){
        $( "#tabs" ).tabs();  
        $('#tabs-2,#tabs-3').show();
    }, 3000);
}); 
```

一些选项卡可以通过 css 隐藏，然后在应用选项卡功能后显示。

**ps**我在`setTimeout`这里添加了代码来模拟在运行 JS 代码之前缓慢加载 HTML 的页面。

# c++ - 打印一个结构指针和一个引用的结构成员

> ID：15501069
> 
> 赞同：0
> 
> 时间：2013-03-19T13:37:51.000
> 
> 标签：c++, pointers, struct, printf

大家好，我是编程新手，我有一个范例，我需要打印一个 struct 类型的指针，该指针在每次迭代中动态获取值，并在每次迭代时打印一个 defrended struct 成员。

```
struct my_struct
{
int x;
int y;
}
void function(){

my_struct* a=value.get() // some values will be assigned dynamically to this pointer from other part of function.

my_struct* data = new thread_data;
data->x=1 //which will get updated according the iterations and conditions
data->y=2 //which will get updated according the iterations and conditions

} 
```

现在我需要在调用者函数中打印 a,x,y 的值，如何打印这些值。一些喜欢的东西

```
printf("a=%lx x=%i y=%i\n", a,x,y); 
```

有人可以给我一些想法或如何进行吗？多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:40:43.863

在 C++ 中，您可以使用`std::cout`：

```
std::cout << "a=" << a << " x=" << a->x << " y=" << a->y << "\n"; 
```

否则，您的`printf`版本可以像这样修复：

```
printf("a=%p x=%i y=%i\n",  a, a->x, a->y); 
```

# c# - WMI：尝试检索 SQL Server 的“ServerNetworkProtocol”范围时“找不到文件”

> ID：15501074
> 
> 赞同：0
> 
> 时间：2013-03-19T13:38:10.953
> 
> 标签：c#, sql-server, wmi

我正在尝试使用 WMI 获取服务器网络协议 (SQL Server)。

我写了一个小应用程序：

```
---------------------------C# code--------------------------
ManagementScope scope = new ManagementScope(@"\\computerName\root\Microsoft\SqlServer\ComputerManagement");
scope.Options.Username = "Administrator";
scope.Options.Password = "Password";
scope.Connect();

var query = new ObjectQuery(@"SELECT * FROM ServerNetworkProtocol");
var searcher = new ManagementObjectSearcher(scope, query);
var managementObjectCollection = searcher.Get();
var result = managementObjectCollection.Cast<ManagementObject>().ToList(); //<---- FileNotFoundException
var s = result.First()["ProtocolName"].ToString();
MessageBox.Show(String.Format("Protocol name:  {0}", s)); 
```

当我运行应用程序时，我会收到 System.IO.FileNotFoundException。我使用 WBEMTest Utility 测试了查询，一切正常（使用管理员凭据）。后来我写了测试服务并放了相同的代码，服务正常工作，没有任何异常。我想这个问题与凭据有关。

任何人都可以更详细地解释什么是错的。运行此查询需要哪些权限（如果凭据有问题）以及如何解决该问题。

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:12:35.697

只需检查凭据并[更改](http://msdn.microsoft.com/en-in/library/ms182491%28v=sql.105%29.aspx)一行：

```
 ManagementScope scope = new ManagementScope(@"\\computerName\root\Microsoft\SqlServer\ComputerManagement10"); 
```

# java - 原子地执行多个操作

> ID：15501076
> 
> 赞同：2
> 
> 时间：2013-03-19T13:38:16.827
> 
> 标签：java, multithreading, concurrency

我试图找到一种以`ConcurrentHashMap`原子方式对 a 执行多个操作的方法。

我的逻辑是这样的：

```
if (!map.contains(key)) {
    map.put(key, value);

    doSomethingElse();
} 
```

我知道有`putIfAbsent`方法。但是如果我使用它，我仍然无法`doSomethingElse`原子地调用它。

除了诉诸同步/客户端锁定之外，还有什么方法可以做这些事情吗？

如果它有帮助，`doSomethingElse`在我的情况下将非常复杂，涉及创建和启动一个线程来查找我们刚刚添加到映射中的键。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T13:41:29.090

> 如果有帮助，在我的例子中 doSomethingElse 将非常复杂，涉及创建和启动一个线程来查找我们刚刚添加到映射中的键。

如果是这种情况，您通常必须在外部进行同步。

在某些情况下（取决于`doSomethingElse()`预期映射的状态是什么，以及其他线程可能会执行映射什么），以下操作也可能起作用：

```
if (map.putIfAbsent(key, value) == null) {
    doSomethingElse();
} 
```

这将确保对于任何给定的键只有一个线程进入`doSomethingElse()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T13:58:49.763

除非您希望所有放置线程都等到第一个成功的线程放入映射中，否则这将起作用。

```
if(map.get(key) == null){

  Object ret = map.putIfAbsent(key,value);
  if(ret == null){ // I won the put
     doSomethingElse();
  }
} 
```

现在，如果许多线程都使用相同的线程，则`key`只有一个会获胜，并且只有一个会获胜`doSomethingElse()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T13:41:30.477

如果您的设计要求在没有其他人访问地图的情况下将地图访问和其他操作分组，那么您别无选择，只能锁定它们。也许可以重新设计设计以避免这种需要？

这也意味着对映射的所有其他访问必须在同一个锁后面进行序列化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-19T13:52:27.220

您可能会为每个条目保留一个锁。这将允许并发的非锁定更新，除非两个线程尝试访问同一个元素。

```
class LockedReference<T> {
  Lock lock = new ReentrantLock();;
  T value;
  LockedReference(T value) {this.value=value;}      
}

LockedReference<T> ref = new LockedReference(value);
ref.lock.lock(); //lock on the new reference, there is no contention here
try {
  if (map.putIfAbsent(key, ref)==null) {
    //we have locked on the key before inserting the element
    doSomethingElse();
   }
} finally {ref.lock.unlock();} 
```

之后

```
Object value;
while (true) {
   LockedReference<T> ref = map.get(key)
   if (ref!=null) {
      ref.lock.lock(); 
      //there is no contention, unless a thread is already working on this entry
      try {
         if (map.containsKey(key)) {
          value=ref.value;
          break;      
         } else {
          /*key was removed between get and lock*/
         }
      } finally {ref.lock.unlock();} 
   } else value=null;
} 
```

一种更好的方法是重写`ConcurrentHashMap`并有一个`putIfAbsent`接受 a的版本`Runnable`（如果放置了元素则执行）。但这会复杂得多。

基本上，`ConcurrentHashMap`实现锁定段，它位于每个条目一个锁和整个地图的一个全局锁之间。

# c# - 自定义对象可序列化但不可反序列化

> ID：15501079
> 
> 赞同：1
> 
> 时间：2013-03-19T13:38:19.983
> 
> 标签：c#, xml-serialization

我通过为实例调用自己的静态函数来获得具有某些属性的类的对象。如果存在 XML 文件，则对象会尝试加载它并将其值添加到实例本身。然后它将再次保存 XML，以防 XML 文件中缺少选项。

我创建了一个小型控制台应用程序：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;
using System.IO;
using System.Reflection;
using System.Xml.Serialization;
using System.Xml;

namespace Test
{
    public class Program
    {
        static void Main(string[] args)
        {
            TaskServerSettings s = TaskServerSettings.LoadNew();
        }
    }

    public class TaskServerSettings : IEqualityComparer
    {
        #region SETTINGS PROPERTIES

        public bool Enabled { get; set; }
        public int CheckInterval { get; set; }

        #endregion

        #region CONSTRUCTORS AND METHODS

        public TaskServerSettings()
        {
            this.init();
        }

        public TaskServerSettings(string settingsFile)
        {
            this.init();
            if (settingsFile != null)
            {
                if (File.Exists(settingsFile))
                {
                    this.Load(settingsFile);
                }
                this.Save(settingsFile);
                }
        }

        private void init()
        {
            this.Enabled = true;
            this.CheckInterval = 5000;
        }

        public void Absorb(TaskServerSettings newSettings)
        {
            this.Enabled = newSettings.Enabled;
            this.CheckInterval = newSettings.CheckInterval;
        }

        public static TaskServerSettings LoadNew(string settingsFile = null)
        {
            if (settingsFile == null)
            {
                settingsFile = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location.TrimEnd('\\')) + @"\TaskServerSettings.xml";
            }

            return new TaskServerSettings(settingsFile);
        }

        public bool Load(string settingsFile = null)
        {
            if (settingsFile == null)
            {
                settingsFile = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location.TrimEnd('\\')) + @"\TaskServerSettings.xml";
            }

            if (!File.Exists(settingsFile))
            {
                throw new FileNotFoundException("Could not find \"" + settingsFile + "\" to load settings.");
            }

            bool result = false;
            using (FileStream fs = new FileStream(settingsFile, FileMode.Open))
            {
                XmlSerializer xs = new XmlSerializer(this.GetType());
                if (!xs.CanDeserialize(XmlReader.Create(fs)))
                {
                    throw new XmlException("\"" + settingsFile + "\" does not have a valid TaskServerSettings XML structure.");
                }
                //try
                //{            // +- InvalidOperationException - Error in XML document (0,0).
                               // v  The root element is missing.
                    this.Absorb(xs.Deserialize(fs) as TaskServerSettings);
                    result = true;
                //}
                //catch { }
            }

            return result;
        }

        public bool Save(string settingsFile = null)
        {
            if (settingsFile == null)
            {
                settingsFile = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location.TrimEnd('\\')) + @"\TaskServerSettings.xml";
            }

            bool result = false;
            using (FileStream fs = new FileStream(settingsFile, FileMode.Create))
            {
                XmlSerializer xs = new XmlSerializer(this.GetType());
                try
                {
                    xs.Serialize(fs, this);
                    result = true;
                }
                catch { }
            }

            return result;
        }

        #endregion

        public bool Equals(TaskServerSettings settingsToCompare)
        {
            if (this.Enabled != settingsToCompare.Enabled ||
                this.CheckInterval != settingsToCompare.CheckInterval)
            {
                return false;
            }
            return true;
        }
        bool IEqualityComparer.Equals(object x, object y)
        {
            return x.Equals(y);
        }
        int IEqualityComparer.GetHashCode(object obj)
        {
            throw new NotSupportedException();
        }
    }
} 
```

在第一次运行时使用其默认属性值编写对象效果很好。XML 文件如下所示：

```
<?xml version="1.0"?>
<TaskServerSettings xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Enabled>true</Enabled>
  <CheckInterval>5000</CheckInterval>
</TaskServerSettings> 
```

但是，在第二次运行时反序列化同一文件会在尝试将文件加载到 `xs.Deserialize(fs) as TaskServerSettings`.

```
InvalidOperationException - Error in XML document (0,0).
The root element is missing. 
```

我已经尝试避免使用静态方法并尝试过`new`，并且我已经尝试过删除`IEqualityComparer`父级+最后三个方法。没有成功。

我想知道，这个错误的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:42:41.813

当您执行此语句时：

```
if (!xs.CanDeserialize(XmlReader.Create(fs))) 
```

它开始读取流。所以当你`Deserialize`稍后调用时，流不在开始，所以反序列化失败。您需要通过设置倒带流`fs.Position = 0`

# powerbuilder - PowerBuilder：在空闲时断开数据库

> ID：15501089
> 
> 赞同：0
> 
> 时间：2013-03-19T13:38:43.023
> 
> 标签：powerbuilder

我在 PowerBuilder 中有一个应用程序，许多用户将其打开几个小时未使用。有时，操作忘记提交；因此，某些表会无限期地锁定，从而阻止每个人工作。我试图将所有提交都放在适当的位置，但在如此大的应用程序中调试它真的很困难。我想在应用程序空闲时断开数据库连接。这并不难，但我的问题是，当鼠标或键盘被触摸时，应用程序需要重新打开连接。我怎么做？每次空闲时都关闭应用程序是不可接受的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T17:06:10.153

首先，我建议您**不要**采取简单的方式，并着手完成所有这些交易。如果你有一些未提交的东西，除了锁定问题，你不知道下一个*恰好*执行的语句是 COMMIT 还是 ROLLBACK，现在也不需要。我的经验是，这种调查总是会引发围绕交易的其他问题。这个问题可能比锁更大。

至于重新连接，如果您要走这条路线（显然不是我的首选），我会推荐另一种设计：当您接下来*需要*连接时连接。基本上（如果您要将代码封装在事务对象的函数中）：

```
IF DBHandle() = 0 THEN CONNECT using THIS; 
```

如果你有一个像 PFC 这样的框架，那么你可能只有几个地方可以编写这个代码。如果您没有一个框架来封装诸如检索和更新之类的工作，那么您将希望自己做到了。仍然可能比通过在每次击键和鼠标移动时检查数据库连接来降低性能要好。

祝你好运，

特里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T12:37:56.750

捕获 mousemove 和 key 事件。当其中一种火灾发生时，发出 CONNECT；陈述。

看：

[http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.dc37781_1150/html/psref/BFCCFFGH.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.dc37781_1150/html/psref/BFCCFFGH.htm)

# r - 使用“POSIXct”对象转换 ISO 8601 日期/时间时出现问题

> ID：15501097
> 
> 赞同：3
> 
> 时间：2013-03-19T13:39:01.510
> 
> 标签：r

有一点我不明白。我只是尝试将日期转换为其他时区。日期采用 8601-ISO 格式。我跟着[这个](https://stackoverflow.com/questions/1395117/how-do-you-convert-dates-times-from-one-time-zone-to-another-in-r)。

```
pb.txt <- "2012-09-11T21:23:20Z"
pb.date <- as.POSIXct(pb.txt, tz="UTC")
format(pb.date, tz="WEST",usetz=TRUE)
[1] "2012-09-11 WEST" 
```

为什么只出现日期而不出现时间戳？我也试过：

```
pb.date <- as.POSIXct(pb.txt, origin=ISOdatetime(2012,09,11,21,23,20))
format(pb.date, tz="WEST",usetz=TRUE)
[1] "2012-09-10 22:00:00 WEST 
```

更好，但时间戳是四舍五入的。如何完美转换 8601-ISO 日期时间？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T13:43:19.997

使用正确的格式：

```
as.POSIXct(pb.txt, "%Y-%m-%dT%H:%M:%S", tz="UTC")
[1] "2012-09-11 21:23:20 UTC" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:54:42.100

除了@JoshuaUlrich 的回答，不要使用夏令时时区：使用常规时区，如果所选日期在夏季时，系统将自动转换。

根据`pb.date <- as.POSIXct(pb.txt, "%Y-%m-%dT%H:%M:%S", tz="UTC")`约书亚的回答，这失败了：

```
format(pb.date, tz="WEST",usetz=TRUE)
[1] "2012-09-11 21:23:20 UTC" 
```

但这不是：

```
format(pb.date, tz="WET", usetz=TRUE)
[1] "2012-09-11 22:23:20 WEST" 
```

# excel - 是否可以在 excel 2007 中动态控制文本框的位置

> ID：15501106
> 
> 赞同：5
> 
> 时间：2013-03-19T13:39:09.460
> 
> 标签：excel, excel-2007, vba

我在一个仪表板项目中工作，我将拥有三个值：最小值、最大值和当前值。最小值和最大值将是条的端点，我想在条的适当位置放置一个包含当前值的文本框。见下文：

是否可以在 Excel 中执行此操作，如果可以，我将如何实现这一目标。我有一些使用 Visual Basic 的经验，但我以前没有遇到过这个。

![在此处输入图像描述](../Images/56a667cf86f7039ec55d0c47c41731a3.png)

最终，我尝试在以下链接中制作仪表板的 excel 版本：

[链接到仪表板](http://www.russell.com/helping-advisors/markets/EconomicIndicatorsDashboard.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:58:45.920

未选择 Shape-object 时打开宏录制。现在选择它并改变它的位置。停止录制并使用生成的代码。

当我尝试它时，它看起来对我很有用。我得到了一些 IncrementTop 和 IncrementLeft 代码。您也可以直接使用 Top 和 Left 属性。

将 Shape 对象的名称更改为有意义的名称（在公式框左侧的地址框中）可能是一个想法，以便您的代码更具可读性。

所以对于我的名为 PositionIndicator 的形状：

```
ActiveSheet.Shapes("PositionIndicator").Left = 250 
```

或者

```
ActiveSheet.Shapes("PositionIndicator").Left = _ 
    ActiveSheet.Shapes("PositionIndicator").Left + 5 
```

要将其链接到单元格值，只需使用`Range("CELLADDRESS").Value2`

要在每次更改单元格值时应用它，请使用：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    'Here your script to check if the change concerns one of your input cells and then run the code to change the location of the Shape-object
End Sub 
```

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:11:38.430

我喜欢你的想法，因此我检查了完整代码的样子。结果如下：

```
Sub SolutionShape(currentVal)

Dim shpBar As Shape, shpCurrent As Shape

'let's assume we have only two shapes on the Activesheet
Set shpBar = ActiveSheet.Shapes(1)
Set shpCurrent = ActiveSheet.Shapes(2)

Dim barMin As Double, barMax As Double
    barMin = 0.51              'both values could be taken from sheet
    barMax = 6.75

'let's do it visualy complicated this time :)
With shpCurrent
    .Left = (-.Width / 2 + shpBar.Left) + _
        (((currentVal - barMin) / (barMax - barMin)) * shpBar.Width)

    **'EDITED- adding information about current value:**
    .TextFrame.Characters.Text = currentVal
End With

End Sub 
```

从即时窗口的事件调用过程进行测试，例如：

```
SolutionShape 0.51      'go to beginning
SolutionShape 6.75      'go to end 
```

无论您放置形状以及设置的任何新尺寸，此解决方案都适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T14:13:59.070

假设进度条是工作表上的形状（索引 1），文本框是形状索引 2；以下内容根据完成百分比沿进度条移动文本框。

注意：必须调整它以偏移箭头左侧的文本框形状部分。

```
Option Explicit
Public Sub movebox()

    Dim textbox As Shape, progbar As Shape
    Dim ws As Worksheet
    Dim stp As Integer, endp As Integer
    Dim tbdyn As Integer
    Dim mn As Double, mx As Double, actper As Double, cur As Double
    Dim admn As Double, admx As Double

    Set ws = Sheets("sheet1")
    Set progbar = ws.Shapes(1)
    Set textbox = ws.Shapes(2)

'// Far left of progress bar position
    stp = progbar.Left
'// Far right of progress bar position
    endp = (progbar.Width + stp)

'// Adjust for starting at 0.51
'// You could adjust mn,mx and cur to take the values
'// from the appropriate cells on the spreadsheet
    mn = 0.51
    mx = 6.07
    admn = 0
    admx = 6.07 - mn
    cur = 4
'// Calculate percentage complete
    actper = cur / admx
'// Apply percentage to progress bar
    tbdyn = actper * endp
'// Move the textox appropriately
    textbox.Left = tbdyn

End Sub 
```

# sql - 在每个产品翻译表中搜索产品名称？

> ID：15501107
> 
> 赞同：0
> 
> 时间：2013-03-19T13:39:12.307
> 
> 标签：sql, sql-server, sql-server-2008

假设我有 Product Table(ID,Name)、Language(ID, Code) 和 ProductTranslation table(ID, ProductID, LanguageID, Name) 现在假设我有 10-20 种语言。我需要在每个语言翻译表中搜索产品名称并仅选择与名称匹配的名称，

```
 SELECT Name, 
        L.ID 
  FROM  Product P, 
        ProductTranslation PT, 
        Language L
  WHERE P.ID = PT.ProductID  
        AND PT.LanguageID = L.ID
        AND P.Name LIKE '%A%'+' ????? 
```

编辑：如果没有可用的语言，请注意 P.Name 包括默认值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:49:12.687

我认为您只需要查看产品翻译表中的名称字段即可。但是，您应该使用标准连接语法，并且不需要语言表：

```
select pt.name as NameInLanguage, pt.id, p.name as ProductName
from ProductTransalation pt join
     Product p
     on pt.productId = p.productId
where pt.name like '%A%' 
```

# asp.net - asp.net中的实体框架和业务层

> ID：15501112
> 
> 赞同：0
> 
> 时间：2013-03-19T13:39:22.597
> 
> 标签：asp.net, .net, entity-framework, design-patterns

我正在尝试将业务层添加到我的简单 Web 应用程序中。
EF 为我生成的类，例如`User`，`Lang`

我现在的 BL 是这样的：

```
public class BLuser
    {
        public static List<User> allUsers()
        {
            using (MyEntities ctx = new MyEntities())
            {
                var users = from us in ctx.Users select us;
                return users.ToList<User>();
            }
        }

        public static int getUsersLangId(int id)
        {
            using (MyEntities ctx = new MyEntities())
            {
                var langid = (from us in ctx.Users where us.Id == id select us.Lang.Id).FirstOrDefault();
                return langid;
            }
        }

        public static void changeUsersLangId(int userId, int langId)
        {
            using (MyEntities ctx = new MyEntities())
            {
                var user = (from us in ctx.Users where us.Id == userId select us).FirstOrDefault();
                user.LangId = langId;
                ctx.SaveChanges();
            }
        }

        public static void addNewUser(int userId)
        {
            User newUser = new User();
            newUser.Id = userId;
            newUser.LangId = 0;

            using (MyEntities ctx = new MyEntities())
            {
                ctx.Users.Add(newUser);
                ctx.SaveChanges();
            }
        }

    } 
```

然后在我后面的代码中，我可以这样称呼它：
`BLuser.changeUsersLangId(1,1);`

这是好方法（尤其是静态方法）吗？我觉得我可能会错过一些东西，但在那种情况下，我不必因为静态方法而关心 BL 对象的持久性。

是否有一些有用的教程，我发现的是相当复杂的文章，新手不容易理解。
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:46:26.797

我会将您的数据访问代码注入业务逻辑层。这样，对您的业务逻辑进行单元测试会容易得多。

看看[依赖注入](http://martinfowler.com/articles/injection.html)模式。

您的数据访问代码应该返回对象，请查看[存储库模式](http://martinfowler.com/eaaCatalog/repository.html)。

如果您对这些文章有具体问题，我相信 SO 用户可以提供帮助。

一般来说，静态方法从来都不是一个好主意，因为它们会导致难以进行单元测试的不灵活代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:42:47.673

对于这种情况，我建议您使用`Repository Pattern`，此模式包含您的业务服务的外观。

此模式用于基于 ORM 的解决方案

链接： http: [//www.codeproject.com/Articles/363501/Repository-pattern-with-Entity-Framework-Code-Firs](http://www.codeproject.com/Articles/363501/Repository-pattern-with-Entity-Framework-Code-Firs)

# .net - 如何通过 API 从 .NET 创建 Office 365 Outlook 别名

> ID：15501113
> 
> 赞同：1
> 
> 时间：2013-03-19T13:39:26.607
> 
> 标签：.net, api, email, alias, office365

有没有办法从 .net 应用程序/网页为 Office 365 中的电子邮件地址创建新别名？我一直在寻找 API，但找不到任何 API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:04:02.730

好的，所以我发现您可以使用 PowerShell 为电子邮件地址添加别名。PowerShell 可以与 c# 一起使用以连接到 Office 365。

**使用 .NET 和 PowerShell 连接到 Office 365**

[http://gsexdev.blogspot.se/2011/07/running-exchange-online-and-office-365.html](http://gsexdev.blogspot.se/2011/07/running-exchange-online-and-office-365.html)

**使用 PowerShell 为电子邮件地址添加别名**

[http://wdmsb.wordpress.com/2013/02/04/powershell-for-office-365/](http://wdmsb.wordpress.com/2013/02/04/powershell-for-office-365/)

# json - Coldfusion 10 returnformat="JSON" 添加字符

> ID：15501123
> 
> 赞同：7
> 
> 时间：2013-03-19T13:39:55.280
> 
> 标签：json, coldfusion, coldfusion-10

我有一个应用程序，我正在将其从 CF8 转换为 CF10，而我的一些远程 CFC（其中返回的数据应该是 JSON）现在失败了，因为返回的数据前似乎有一个“//”。例如，这是一个返回结构的输出：

```
//{"SUCCESS":true,"ERRORS":[],"DATA":{"COLUMNS":["AUTHRESULT","SPID","EMAIL","RID"],"DATA":[[true,361541,"user@domain.com",""]]}} 
```

通过 CF8 服务器上的相同 CFC 运行的相同功能给出：

```
{"ERRORS":[],"SUCCESS":true,"DATA":{"COLUMNS":["AUTHRESULT","SPID","EMAIL","RID"],"DATA":[[true,361541,"user@domain.com",""]]}} 
```

代理所有请求的 CFC 确实有 returnFormat="JSON" - 但是在 proxyCFC 或从 proxyCFC 扩展的 CFC 中都没有调用 SerializeJSON()。

我不确定处理这个问题的最佳方法是什么。修剪响应中的“//”是可能的，但它似乎并不“正确”。我需要在 CF10 端解决它，因为这些功能不仅在我们的应用程序中使用，而且在一些远程应用程序中也使用（有些是通过 http:// 帖子，有些是通过 jQuery Ajax 调用）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-19T13:42:27.963

这是[ColdFusion 管理员中的服务器端设置，位于 settings 下](http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7ffc.html)。 *序列化 JSON 的前缀为*. 出于安全考虑，它默认启用。*保护 Web 服务，通过在序列化的 JSON 字符串前加上自定义前缀，返回 JSON 数据免受跨站点脚本攻击。*. 也许您已经在 ColdFusion 8 服务器上关闭了此功能。我不建议将其关闭。

请参阅 Raymond Camden 的这篇文章 -[在 jQuery 和 jQueryUI 中处理带有前缀的 JSON](http://web.archive.org/web/20130117041105/http://www.raymondcamden.com/index.cfm/2011/11/8/Handling-JSON-with-prefixes-in-jQuery-and-jQueryUI)

注意：此设置也可以通过设置`secureJSON`和`secureJSONPrefix`在您的 Application.cfc 文件中为每个应用程序设置。请参阅此处的文档 -[应用程序变量](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-750b.html)。

`secureJSON`-*一个布尔值，指定是否在 ColdFusion 函数以 JSON 格式返回以响应远程调用的值之前添加安全前缀。*

*默认值是管理员服务器设置 > 设置页面中前缀序列化 JSON 设置的值（默认为 false）。您可以在 cffunction 标记中覆盖此值。*

`secureJSONPrefix`-*如果 secureJSON 设置为 true，则放置在 ColdFusion 函数以 JSON 格式返回以响应远程调用的值前面的安全前缀。*

*默认值是管理员服务器设置 > 设置页面中前缀序列化 JSON 设置的值（默认为 //，JavaScript 注释字符）。*

# azure - Web 服务器似乎没有安装 FrontPage 服务器扩展：visual studio 2012 iis express

> ID：15501126
> 
> 赞同：0
> 
> 时间：2013-03-19T13:39:58.087
> 
> 标签：azure, visual-studio-2012, clickonce, frontpage-extensions

我正在使用 Visual Studio 2012，并且我有一个 Windows 窗体应用程序。iis express 服务器默认配置为 Visual Studio 2012。

我必须发布我的 Windows 窗体应用程序。为此，我在天蓝色平台上创建了一个存储对象。

但是当我尝试使用 clickonce 发布项目时，我遇到了这个问题：

错误 83 Web 服务器似乎没有安装 FrontPage 服务器扩展。如果安装了 FrontPage 服务器扩展，则可能会出现此错误，因为 _vti_bin 虚拟目录未标记为可执行文件。若要更正此问题，请运行 Internet 信息服务管理器，选择有问题的 Web 服务器，然后使用“检查服务器扩展”命令。

截屏 ：

[https://docs.google.com/file/d/0B-aV0dsLT4CaemZuQV93Ymt4UVE/edit?usp=sharing](https://docs.google.com/file/d/0B-aV0dsLT4CaemZuQV93Ymt4UVE/edit?usp=sharing)

在 azure 上创建存储对象时我没有遇到任何问题，而且 URL 很好！

我已经多次安装了 de FrontPage Server Extension，通常都很好。

我真的需要发布我的项目，如果有人可以帮助我......

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:13:06.043

您正在尝试将 HTTP 发布到未安装 FPSE 的服务器。FPSE 在 Server 2008 之后不再可用（我猜这里，我只知道它不适用于较新版本的 Windows Server）。

不要使用 HTTP，而是使用 FTP。因此，您将文件 FTP 到 Web 服务器，并使用 HTTP 链接让客户访问它们。

例如，您的发布文件位置可能是

```
ftp://myserver.com/myfolder/ 
```

并且您的安装 URL 类似于

```
http://myserver/thefolder/ 
```

# python - Python pip 错误：“无法获取索引基础 URL https://pypi.python.org/simple/”

> ID：15501133
> 
> 赞同：19
> 
> 时间：2013-03-19T13:40:21.803
> 
> 标签：python, proxy, pip

我正在尝试使用 pip 安装几个软件包。当我使用 sudo 执行此操作时，会发生此错误：“无法获取索引基础 URL [https://pypi.python.org/simple/](https://pypi.python.org/simple/) ”。当我在没有 sudo 的情况下执行命令时，包下载成功，但我没有足够的权限。这种不同行为的原因可能是什么？我坐在代理后面。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-19T13:42:24.007

也许尝试`sudo -E`：

```
 -E          The -E (preserve environment) option indicates to the secu‐
             rity policy that the user wishes to preserve their existing
             environment variables.  The security policy may return an
             error if the -E option is specified and the user does not
             have permission to preserve the environment. 
```

假设您的代理设置是在您的正常用户环境中设置的，而不是您在运行时获得的设置`sudo`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-17T03:00:57.403

我在尝试使用时遇到了这个问题`pip==1.5.4`

这是与 PIP 和 Python 的 PYPI 信任 SSL 证书相关的问题。如果您查看 Mac OS X 中的 PIP 日志：**/Users/username/.pip/pip.log**，它将为您提供更多详细信息。

经过数小时尝试不同的东西后，我让 PIP 恢复并运行的解决方法是在 Python 中进入我的**site-packages**，无论它是在**virtualenv**中还是在您的普通**site-packages**中，并摆脱当前的 PIP 版本。对我来说，我有`pip==1.5.4`

我删除了 PIP 目录和 PIP egg 文件。然后我跑了

```
easy_install pip==1.2.1 
```

这个版本的 PIP 没有 SSL 问题，然后我能够`pip install -r requirements.txt`在我的 virtualenv 中运行我的正常程序来设置我想要的所有在我的`requirements.txt`文件中列出的包。

这也是我发现的这个 Google 群组中的几个人推荐的解决问题的方法：

[https://groups.google.com/forum/#!topic/beagleboard/aSlPCNYcVjw](https://groups.google.com/forum/#!topic/beagleboard/aSlPCNYcVjw)

[编辑]

如果您全局安装了不同版本的 PIP，则每次创建新的 virtualenv 时都会安装该版本的 PIP，因此您每次都必须为每个新 PIP 执行此操作，除非您更改全局安装的版本。我在开始一个新项目时遇到了这个问题，不得不再次修复并恢复到`pip==1.2.1`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-13T15:31:20.597

从[pip docs](http://pip.readthedocs.org/en/latest/installing.html)，如果您在代理后面安装：

python get-pip.py --proxy="[user:passwd@]proxy.server:port"

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-04T11:24:40.750

如果您想使用 pip 安装任何软件包，那么最好遵循以下语法：

```
sudo pip --proxy=http://username:password@proxyURL:portNumber install yolk 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-05T00:23:38.383

我遇到了这个问题，发现答案终于解决了。

您可以尝试添加一个新文件`/root/.pip/pip.conf`，然后编写：

```
[global]
index-url=http://pypi.douban.com/simple/ 
```

在文件中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-20T11:58:59.493

对于这个问题，我的解决方案有所不同。

我系统的日期和时间没有同步。

如果出现问题，请检查您的系统数据/时间，如果不是问题，请继续执行其他建议。

# android - Facebook 的 iOS SDK logConversionPixel 在 Android 上等效

> ID：15501139
> 
> 赞同：3
> 
> 时间：2013-03-19T13:40:33.930
> 
> 标签：android, facebook

我们有一个 Android 应用程序需要跟踪 Facebook 广告中的安装。

在 iOS 上，我们通过调用Facebook SDK的[logConversionPixel:valueOfPixel方法来实现这一点。](https://developers.facebook.com/docs/reference/ios/3.2/class/FBInsights#logConversionPixel%3AvalueOfPixel%3A)但我一直无法在 Android 中找到等效的方法。

# git - 如何在提交中包含版本文件？

> ID：15501149
> 
> 赞同：2
> 
> 时间：2013-03-19T13:41:01.337
> 
> 标签：git, versioning

警告：我不是 git 向导，所以我可能没有正确的术语......

在我将发布推送到 github 之前，我创建了一个反映当前提交标记的版本文件，有点像这样：

```
git commit -m <insert pithy comment here>
MAJOR=1
MINOR=2
BUILD=`git describe --all --tags`
echo VERSION = [${MAJOR}, ${MINOR}, #{BUILD}] > version.rb
git push origin master 
```

这可行，但是对于 version.rb 在提交发生后被修改的明显缺陷。我可以将 verion.rb 添加到 .gitignore，但是有没有办法在提交后将 verion.rb 潜入配置而不创建新标签？还是有另一种我没有想到的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T15:25:45.987

### 更新

这是一个 Ruby 特定的答案，但您可能可以在您选择的环境中实现等效的东西......

### 原始答案

在查看评论并深入研究 git 文档之后，尝试使用 git 标签作为版本号的一部分似乎是不谨慎的，如果只是因为 git 标签在提交之后才可用。

所以我写了一个简单的 rake 任务来直接在我的 config/version.rb 文件中增加内部版本号。我在进行提交和部署之前运行此脚本：

```
# Read config/version.rb file containing
#   VERSION = [a, b, c]
# Overwrite config/version.rb file to contain:
#   VERSION = [a, b, c+1]
task :bump_version do
  desc "increment build number in config/version.rb"
  file = "config/version.rb"
  unless (File.exist?(file))
    $stderr.puts("cannot locate version file #{file}")
  else
    s = File.open(file) {|f| f.read}
    if (s =~ /(\d+)\D+(\d+)\D+(\d+)/)
      s1 = "VERSION = [#{$1}, #{$2}, #{$3.to_i + 1}]"
      $stderr.puts(s1)
      File.open(file, "w") {|f| f.puts(s1) }
    else
      $stderr.puts("cannot parse version file")
    end
  end
end 
```

对我来说很好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-19T13:47:56.820

用于`git commit --ammend -m <pithy comment>`将更改添加到最后一次提交。这将在上面示例中的 push 命令之前进行。

# c# - 创建要应用于 IQueryable 的动态搜索的最简单方法

> ID：15501151
> 
> 赞同：2
> 
> 时间：2013-03-19T13:41:02.497
> 
> 标签：c#, linq, entity-framework, lambda, linq-to-entities

考虑具有以下列和相应实体的单个表（称为 Car）的情况

```
string Make
string Model
string Owner 
```

现在我想创建一个搜索，用户可以在其中选择（通过使用复选框）搜索应该定位到哪些属性。如果选择了多个，那么如果在其中至少一个中找到搜索字符串就足够了。

此外，如果给出了多个搜索字符串（由空格分隔），则搜索应该仅在找到每个单词时匹配（例如，给定搜索字符串“ter mist”，拥有“先生”的汽车将匹配）。

在做了一些研究之后，我想我会`Expression<Func<Car, bool>>`为每个选择的属性创建一个列表，为搜索字符串中的每个单词添加一个，然后将所有这些一起创建一个`Expression<Func<Car, bool>>`. 一旦我为所有选择的特性获得了这些，我会将它们组合在一起，以创建最终过滤器。然而，这正是我苦苦挣扎的地方。

最后，我得到的最远的是 NotSupportedException 说`The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.`

这是我用于组合的辅助函数（来自[http://social.msdn.microsoft.com/Forums/en-US/linqprojectgeneral/thread/60a1f4c0-d4d9-4143-91aa-79d29dde7a7c/](http://social.msdn.microsoft.com/Forums/en-US/linqprojectgeneral/thread/60a1f4c0-d4d9-4143-91aa-79d29dde7a7c/)）：

```
public static Expression<Func<T, bool>> Or<T>(params Expression<Func<T, bool>>[] predicates)
    {
        if (predicates.Length == 1)
            return predicates[0];

        Expression<Func<T, bool>> result = predicates[0];
        for (int i = 1; i < predicates.Length; i++)
        {
            result = OrTwo(result, predicates[i]);
        }

        return result;
    }
private static Expression<Func<T, bool>> OrTwo<T>(Expression<Func<T, Boolean>> expr1, Expression<Func<T, bool>> expr2)
    {
        var invokedExpr = Expression.Invoke(expr2, expr1.Parameters.Cast<Expression>());
        return (Expression.Lambda<Func<T, Boolean>>(Expression.OrElse(expr1.Body, invokedExpr), expr1.Parameters));
    } 
```

这一切也变得令人惊讶地令人困惑，所以我开始认为必须有一种更简单的方法来解决这个问题。那么，解决这个问题的最简单方法是什么？

* * *

# 解决方案

在尝试了几件事（LINQKit、[Albahari 的 PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)、自己摆弄表达式树）之后，我终于来到了[这里](http://petemontgomery.wordpress.com/2011/02/10/a-universal-predicatebuilder/)。PredicateBuilder 的这个通用版本在没有任何其他外部依赖项的情况下工作，并且与 EF 完全兼容。它使解决问题变得非常简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:47:23.977

几周前我决定自己解决这个问题。

看看我的博文：

[http://jnye.co/Posts/5/generic-repository-search-function-with-expression-trees](http://jnye.co/Posts/5/generic-repository-search-function-with-expression-trees)

**链接更新：**我现在创建了一个新帖子，将搜索功能作为扩展方法添加到 IQueryable：

[http://jnye.co/Posts/6/c%23-generic-search-extension-method-for-iqueryable](http://jnye.co/Posts/6/c%23-generic-search-extension-method-for-iqueryable)

您应该能够使其适应您的需求。

**更新**

下面是我创建的搜索功能的摘录。

```
/// <summary>  
/// Performs a search on the supplied string property  
/// </summary>  
/// <param name="stringProperty">Property to search upon</param>  
/// <param name="searchTerm">Search term</param>  
public virtual IQueryable<T> Search(Expression<Func<T, string>> stringProperty, string searchTerm)  
{  
    var source = this.RetrieveAll();  

    if (String.IsNullOrEmpty(searchTerm))  
    {  
        return source;  
    }  

    //Create expression to represent T.[property] != null  
    var isNotNullExpression = Expression.NotEqual(stringProperty.Body, Expression.Constant(null));  

    //Create expression to represent T.[property].Contains(searchTerm)  
    var searchTermExpression = Expression.Constant(searchTerm);  
    var checkContainsExpression = Expression.Call(stringProperty.Body, typeof(string).GetMethod("Contains"), searchTermExpression);  

    //Join not null and contains expressions  
    var notNullAndContainsExpression = Expression.AndAlso(isNotNullExpression, checkContainsExpression);  

    //Build final expression  
    var methodCallExpression = Expression.Call(typeof (Queryable),   
                                               "Where",   
                                               new Type[] {source.ElementType},   
                                               source.Expression,   
                                               Expression.Lambda<Func<Club, bool>>(notNullAndContainsExpression, stringProperty.Parameters));  

    return source.Provider.CreateQuery<T>(methodCallExpression);  
} 
```

您应该能够重构生成 的代码`methodCallExpression`以创建多个搜索表达式，然后您可以使用`Expression.OrElse()`.

# css - 让 div 从内联移动到与媒体查询堆叠

> ID：15501152
> 
> 赞同：0
> 
> 时间：2013-03-19T13:41:08.337
> 
> 标签：css, html, media

我有 3 个 div 想要做出响应。对于最大宽度 990px​​，我想让它们成为 3 列布局。对于超过 650 像素的最大宽度，我希望前两个 div 跨度为 30%-70% 以填充整个长度，第三列位于下方并跨越整个长度。

到目前为止，我所拥有的在 Chrome 中有效，但在 Firefox 中存在问题。

关键是我根本不能在 div 之间有任何空白。

```
 <div class="columns">
    <div class="left-nav-menu">Left Column</div>
    <div class="center-content-area">Center Column</div>
    <div class="right-column">Right Column</div>
    </div>

    @media screen and (max-width: 990px) {
    div.columns {background-color:#360; display:table; width: 100%; padding: 0em;}

    div.left-nav-menu {width: 30%; margin: 0; padding: 2em; background-color: #CCC; 
    display:table-cell;}

    div.center-content-area {width: 40%; margin: 0; padding: 2em;
    background-color: #C9F; display: table-cell;}

    div.right-column {width: 30%; margin: 0; padding: 2em; background-color: #CCC;
    display: table-cell;}

    }

    @media screen and (max-width: 650px) {
    div.columns {background-color:#360; display:table; width: 100%; padding: 0em;}

    div.left-nav-menu {width: 30%;margin: 0; padding: 2em; background-color: #CCC;       
    display: inline-table; }

    div.center-content-area {width: 70%; margin: 0; padding: 2em;
    background-color: #C9F; display: inline-table;}

    div.right-column {width: auto; margin: 0; padding: 2em; background-color: #CCC;
    display: block;}

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:30:08.390

我用你的代码整理了一个小提琴。我已经对您的 HTML 和 CSS 进行了一些编辑，但它应该可以在 Firefox 和 Chrome 中使用。

```
<div class="columns">
  <div class="box left">Left Column</div>
  <div class="box center">Center Column</div>
  <div class="box right">Right Column</div>
</div> 
```

[http://jsfiddle.net/j4LYS/1/](http://jsfiddle.net/j4LYS/1/)

希望能帮助到你！

# android - Android：从 PureData 更改图像

> ID：15501171
> 
> 赞同：1
> 
> 时间：2013-03-19T13:41:52.133
> 
> 标签：android, image, puredata

所以基本上我们几乎完成了我们的吉他调音器，只需要让 UI 看起来不错。我们使用 Pure Data 进行所有音频处理，我们希望根据图像来表示调整是对还是错。因此，如果您需要调音，则会显示向上图像，当您调音时，橙色方块会亮起。现在我们有一些根据声音移动的线条，效果很好，但看起来不太好。

我想这样做的方式是将“关闭”图像放在 XML 文件中，因此屏幕上的向下箭头、向上箭头和中心调正方块都设置为关闭（它们是灰色的），并且随着调音被拾取，图像变为橙色。

但是，当我尝试让它更改图像时，我的程序崩溃了，我不太确定我需要做什么才能使图像正确更改。

一个正确方向的观点将不胜感激。

链接到 pitchview 课程：[http ://pastebin.com/xJPU9su1](http://pastebin.com/xJPU9su1)

如您所见，我正在尝试更改 onCanvas 方法中的图像，该方法当前在屏幕上绘制线条以表示调整。我是在正确的轨道上还是我必须完全改变我正在做的事情？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-03T17:40:24.143

我可能会被指责在这里回避这个问题（好吧，我**在**回避这个问题，但这可能还是有用的），但是使用 Pure Data 的 GEM 库渲染图像可能更容易吗？也许你可以这样做：

```
|loadbang| ---- |create\ ---- |gemwin|

|noteTooSharp|-\ 
                \
|gemhead| ---- |spigot| ---- |pix_image foo/down_arrow.jpg| ---- |pix_draw| 
```

这只会在“noteTooSharp”产生 1 时显示您的图像，这可以通过您的调谐器链接到结果（假设您可以访问频率。

```
|moses $freq|          <--------------  where $freq is the frequency
  |        \
  |         \
(too flat)  |moses $freq-1|
               |         |
            (nice!)    (too sharp) 
```

如果这不是您要找的东西，我很抱歉。我不确定 GEM 是否适用于 Android（在 libpd 下）。但是，如果您可以使用 GEM，我也可能会建议[http://puredata.info/downloads/gem/documentation/tutorial/primer](http://puredata.info/downloads/gem/documentation/tutorial/primer)，这是一个非常有用的 GEM 教程。

# python - python urllib.request.urlopen 不遵循重定向

> ID：15501186
> 
> 赞同：0
> 
> 时间：2013-03-19T13:42:37.610
> 
> 标签：python, redirect, urllib

我正在使用 python 3.2.2。如果我尝试这样做：

```
urllib.request.urlopen('https://pypi.python.org/simple/babel') 
```

我收到以下错误消息：

```
 Traceback (most recent call last):
    File "solver.py", line 93, in <module>
      generateMetadata('babel')
    File "solver.py", line 76, in generateMetadata
      linklist = parseURL(name)
    File "solver.py", line 20, in parseURL
      resp = opener.open(REP_URL+name+'/')
    File "/usr/lib/python3.2/urllib/request.py", line 375, in open
      response = meth(req, response)
    File "/usr/lib/python3.2/urllib/request.py", line 487, in http_response
      'http', request, response, code, msg, hdrs)
    File "/usr/lib/python3.2/urllib/request.py", line 407, in error
      result = self._call_chain(*args)
    File "/usr/lib/python3.2/urllib/request.py", line 347, in _call_chain
      result = func(*args)
    File "/usr/lib/python3.2/urllib/request.py", line 560, in http_error_302
      headers, fp)
  urllib.error.HTTPError: HTTP Error 301: Moved Permanently - Redirection to url '/simple/Babel' is not allowed 
```

搜索后我发现它应该自动处理重定向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:46:31.420

看来，Python 版本 3.2.0 到 3.2.2 中存在一个错误。

如果你知道你的程序的用户会使用这个版本，你可以尝试猴子补丁。（如果他们使用的是故障版本之一，则使用 3.2.3 中的修补模块覆盖模块）

有相应的错误报告：[http ://bugs.python.org/issue13696](http://bugs.python.org/issue13696)

# solr - Solr 4.x 和复制集合

> ID：15501188
> 
> 赞同：1
> 
> 时间：2013-03-19T13:42:41.983
> 
> 标签：solr, solr4

我有 3 个与在 Solr4 中复制集合有关的问题

1.  每个集合都有自己的 solrconfig.xml，它有自己的复制设置，并且必须指向主服务器上的特定集合。是否可以只有一个全局设置来处理多个集合？

2.  如果我将有 100 个集合，他们将每分钟（或任何间隔）向主服务器发出 100 个请求。是否有可能让它更聪明地工作并且只做 1 个请求？

3.  我需要动态创建核心。可以通过管理面板（或脚本）添加集合，但它需要集合目录和配置已经到位。有没有办法“即时”创建集合并将其复制到从服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:14:29.533

恐怕（1）和（2）的答案是否定的，你不能。集合是一个逻辑配置边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T01:49:51.463

我找到了解决方案。[使用 SolrCloud http://wiki.apache.org/solr/SolrCloud](http://wiki.apache.org/solr/SolrCloud)很容易实现所有这些

# php - WordPress RSS Feed 不是 PHP 文件中的函数

> ID：15501191
> 
> 赞同：0
> 
> 时间：2013-03-19T13:42:51.733
> 
> 标签：php, wordpress

我正在使用一个名为 WP-RSS 提要的插件。碰巧的是，根据他们的网站，您可以直接在 PHP 模板中使用 RSS 提要。当我将以下代码放入模板时，它不会触发，但我收到一条错误消息：“警告：strpos() 期望参数 1 为字符串，数组在 /nas/wp/www/staging/sfhr/ 中给出wp-includes/SimplePie/Content/Type/Sniffer.php 第 97 行"

```
<?php echo do_shortcode(RSSImport(5,"http://www.indystar.com/apps/pbcs.dll/section?Category=SPORTS0107&template=rss"));
 ?> 
```

第 97 行的代码如下：

```
if (($pos = strpos($this->file->headers['content-type'], ';')) !== false)
        {
            $official = substr($this->file->headers['content-type'], 0, $pos);
        }
        else
        {
            $official = $this->file->headers['content-type'];
        } 
```

任何想法为什么我会得到这些错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:09:49.060

如果您使用插件**RSS-Import**

[http://wordpress.org/extend/plugins/rss-import/](http://wordpress.org/extend/plugins/rss-import/)

然后根据文档，您可以将其添加到您的模板文件中：

```
<?php RSSImport(10, 'http://bueltge.de/feed/'); ?> 
```

如果你想使用，`do_shortcode()`那么你可以试试这个：

```
<?php 
  echo do_shortcode('[RSSImport display="5" feedurl="http://bueltge.de/feed/"]');
?> 
```

您还可以使用 Wordpress 功能在没有插件的情况下获取 RSS 提要`fetch_feed()`：

```
<?php $feed = fetch_feed( $uri ); ?> 
```

此功能使用 SimplePie 包并自动缓存提要。您可以在 Codex 中阅读更多相关信息：

[http://codex.wordpress.org/Function_Reference/fetch_feed](http://codex.wordpress.org/Function_Reference/fetch_feed)

# php - Twitter API 应用程序身份验证仅返回禁止

> ID：15501192
> 
> 赞同：1
> 
> 时间：2013-03-19T13:42:52.140
> 
> 标签：php, twitter, twitter-oauth

我正在尝试了解如何将 oAuth2 与仅 twitter 应用程序一起使用身份验证，以便我可以在我的网站上显示提要，但我被困在令牌获取步骤中。我可能做得不对，我根本无法理解 oAuth 所以这是我的代码，你们能告诉我我做错了什么吗？

```
//Expired, request a bearer access token
define('TWITTER_CONSUMER_KEY', 'xyz');
define('TWITTER_CONSUMER_SECRET', 'abc');
$encodedAccessToken = base64_encode(TWITTER_CONSUMER_KEY.':'.TWITTER_CONSUMER_SECRET);

$options = array(
    'http' => array(
        'method' => 'POST',
        'header' => 'Authorization: Basic '.$encodedAccessToken."\nContent-Type: application/x-www-form-urlencoded;charset=UTF-8",
        'content' => 'grant_type=client_credentials',
        'protocol_version' => 1.1,
    ),
);
$context  = stream_context_create($opts);
$result = file_get_contents('https://api.twitter.com/oauth2/token', false, $context);
var_dump($result); 
```

然后我不断收到403错误：

> 警告：file_get_contents（[https://api.twitter.com/oauth2/token](https://api.twitter.com/oauth2/token)）[function.file-get-contents]：未能打开流：HTTP 请求失败！HTTP/1.0 403 禁止在...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:54:01.263

好的，作为答案:)

您需要传递`$options`，而不是未定义`$opts`的 to `stream_context_create`。

# c# - C# 嵌套字典

> ID：15501202
> 
> 赞同：15
> 
> 时间：2013-03-19T13:43:21.523
> 
> 标签：c#, dictionary, nested

我的语法有什么问题？我希望能够以此获得价值“创世纪”`info["Gen"]["name"]`

```
 public var info = new Dictionary<string, Dictionary<string, string>> {
    {"Gen", new Dictionary<string, string> {
    {"name", "Genesis"},
    {"chapters", "50"},
    {"before", ""},
    {"after", "Exod"}
    }},
    {"Exod", new Dictionary<string, string> {
    {"name", "Exodus"},
    {"chapters", "40"},
    {"before", "Gen"},
    {"after", "Lev"}
    }}}; 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-19T13:45:01.080

您不能使用 定义类字段`var`。

更改`var`为`Dictionary<string, Dictionary<string, string>>`：

```
public Dictionary<string, Dictionary<string, string>> info =
    new Dictionary<string, Dictionary<string, string>>
    {
        {
            "Gen",
            new Dictionary<string, string>
            {
                {"name", "Genesis"},
                {"chapters", "50"},
                {"before", ""},
                {"after", "Exod"}
            }
        },
        {
            "Exod",
            new Dictionary<string, string>
            {
                {"name", "Exodus"},
                {"chapters", "40"},
                {"before", "Gen"},
                {"after", "Lev"}
            }
        }
    }; 
```

有关关键字及其用法的更多信息，请参见[此处。](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/implicitly-typed-local-variables)`var`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T13:50:01.113

从*[`MSDN`](http://msdn.microsoft.com/en-us/library/bb384061.aspx)*;

> *   var 只能在同一语句中声明和初始化局部变量时使用；变量不能初始化为 null，也不能初始化为方法组或匿名函数。
>     
>     
> *   **var 不能用于类范围内的字段。**
>     
>     
> *   使用 var 声明的变量不能在初始化表达式中使用。

只需将您更改`var`为`Dictionary<string, Dictionary<string, string>>`. 像;

```
public Dictionary<string, Dictionary<string, string>> info =
    new Dictionary<string, Dictionary<string, string>>{} 
```

# java - 如何将我的 android 应用程序链接到另一个内置应用程序，如谷歌地图？

> ID：15501204
> 
> 赞同：0
> 
> 时间：2013-03-19T13:43:24.367
> 
> 标签：java, android, eclipse, onclick

我想知道我是否可以将我的应用程序与谷歌地图等应用程序链接？例如，如果我创建一个按钮并`onClick`转到 Google 地图应用程序。那么有没有办法可以`onClick`将按钮的事件直接指向地图？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:50:46.507

你可以用意图来做，如果你想从你的应用程序中打开谷歌地图，你可以用这个代码来做：

```
String uri = "geo:"+ latitude + "," + longitude;
Intent myMapIntent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse(uri));
startActivity(myMapIntent); 
```

[您可以在相关的 Android 文档](http://developer.android.com/guide/appendix/g-app-intents.html)中找到一些有用的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:47:27.357

您可以使用

```
geo:latitude,longitude
geo:latitude,longitude?z=zoom
geo:0,0?q=my+street+address
geo:0,0?q=business+near+city 
```

来自[Android 开发者指南](http://developer.android.com/guide/appendix/g-app-intents.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T13:47:39.953

```
Intent intent = new Intent(android.content.Intent.ACTION_VIEW, 
Uri.parse("http://maps.google.com/maps?saddr="+mylocation));
startActivity(intent); 
```

# ios - iOS画屏视频采集不流畅

> ID：15501206
> 
> 赞同：2
> 
> 时间：2013-03-19T13:43:31.160
> 
> 标签：ios, objective-c, xcode, video-capture

我正在创建一个应用程序，我们可以在其中使用手指在 imageView 中进行绘制，同时我们也可以记录屏幕。到目前为止我已经完成了这些功能，但是问题是一旦视频录制完成，如果我们播放录制的视频，手指在视频中绘制不流畅。

我没有使用 opengl，绘图在 UIImageView 上，每 0.01 秒我们从 UIImageView 捕获图像并将像素缓冲区附加到 AVAssetWriterInputPixelBufferAdaptor 对象。

这是我用于将 UIImage 转换为缓冲区的代码

```
- (CVPixelBufferRef) pixelBufferFromCGImage:(CGImageRef) image {

  CGSize frameSize = CGSizeMake(976, 667);
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES], kCVPixelBufferCGImageCompatibilityKey,
                         [NSNumber numberWithBool:YES], kCVPixelBufferCGBitmapContextCompatibilityKey,
                         nil];
CVPixelBufferRef pxbuffer = NULL;
CVPixelBufferCreate(kCFAllocatorDefault, frameSize.width,
                                      frameSize.height,  kCVPixelFormatType_32ARGB, (__bridge CFDictionaryRef) options,
                                      &pxbuffer);
CVPixelBufferLockBaseAddress(pxbuffer, 0);
void *pxdata = CVPixelBufferGetBaseAddress(pxbuffer);

CGColorSpaceRef rgbColorSpace = CGImageGetColorSpace(image);

CGContextRef context = CGBitmapContextCreate(pxdata, frameSize.width,
                                             frameSize.height, 8, 4*frameSize.width, rgbColorSpace,
                                             kCGImageAlphaPremultipliedFirst);

CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image),
                                       CGImageGetHeight(image)), image);

CGContextRelease(context);

CVPixelBufferUnlockBaseAddress(pxbuffer, 0);
return pxbuffer; 
```

}

下面的方法调用 0.01 秒时间间隔

```
CVPixelBufferRef pixelBufferX  = (CVPixelBufferRef)[self pixelBufferFromCGImage:theIM];
bValue = [self.avAdaptor appendPixelBuffer:pixelBufferX withPresentationTime:presentTime]; 
```

任何人都可以指导改进视频捕获吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:41:35.333

您不应该通过每 0.01 秒调用一次来显示内容。如果您想与视频保持同步，请参阅`AVSynchronizedLayer`，这是明确的。或者，请参阅`CADisplayLink`，它用于与屏幕刷新保持同步。0.01 秒与任何特别的东西都不相符，并且您可能会在与视频和显示器不同步的地方获得节拍。在任何情况下，您都应该在播放器的回调中进行绘图，而不是使用计时器。

您还会在每个循环中泄漏像素缓冲区。由于您调用了`CVPixelBufferCreate()`，因此您有责任最终调用`CFRelease()`生成的像素缓冲区。如果运行一段时间，我希望您的程序最终会因内存不足而崩溃。

确保您已经学习了[AV Foundation 编程指南](https://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/00_Introduction.html)，以便了解所有部分如何在媒体播放中组合在一起。

# android - 如何绘制具有可变笔画宽度的路径

> ID：15501207
> 
> 赞同：7
> 
> 时间：2013-03-19T13:43:32.493
> 
> 标签：android, drawing, width, paint, stroke

我的代码基本上来自这个例子（[http://corner.squareup.com/2010/07/smooth-signatures.html](http://corner.squareup.com/2010/07/smooth-signatures.html)）和谷歌API（FingerPaint），但现在我想使用这个类`VelocityTracker`来改变笔画宽度取决于以我手指的速度。

我以为我可以将路径分成更小的部分，但我没有找到任何示例。还有第二篇文章（[http://corner.squareup.com/2012/07/smoother-signatures.html](http://corner.squareup.com/2012/07/smoother-signatures.html)），但我既没有特定的贝塞尔曲线类，也没有收集所有点，`ArrayList`所以他们的例子是调整笔画宽度不是很有帮助。

有谁知道如何处理这个问题？我两周前开始学习代码，所以我对所有这些东西都很陌生。

编辑：我尝试实现 MotionEvents 的速度，并在运行应用程序时使用 LogCat 跟踪当前速度。它确实奏效了，但是当我尝试将速度用作 mPaint.setStrokeWidth 参数的一部分时，我没有得到我真正想要的。我在画布上绘制的路径的宽度从我开始画线到我向上移动手指的那一刻一直在变化。所以这就是为什么我想将路径分成更小的部分，因为就像现在一样，只有最后跟踪的速度会影响 strokeWidth。

```
public class SignatureView extends View {

    private static final String TAG = SignatureView.class.getSimpleName();
    private static final float STROKE_WIDTH = 10;
    private static final float HALF_STROKE_WIDTH = STROKE_WIDTH / 2;
    private final double TOUCH_TOLERANCE = 5;
    private int h = getResources().getDisplayMetrics().heightPixels;
    private int w = getResources().getDisplayMetrics().widthPixels;

    private Path mPath = new Path();
    private Paint mPaint = new Paint();
    private Paint mBitmapPaint = new Paint(Paint.DITHER_FLAG);
    private Bitmap mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
    private Canvas mCanvas = new Canvas(mBitmap);

    private float mX, mY;
    private float lastTouchX, lastTouchY;
    private final RectF dirtyRect = new RectF();

public SignatureView(Context context, AttributeSet attrs) {
    super(context, attrs);

    mPaint.setAntiAlias(true);
    mPaint.setColor(Color.BLACK);
    mPaint.setStyle(Paint.Style.STROKE);
    mPaint.setStrokeJoin(Paint.Join.ROUND);
    mPaint.setStrokeWidth(INITIAL_STROKE_WIDTH);

    Log.d(TAG, "TOUCH_TOLERANCE = " +TOUCH_TOLERANCE);
}

@Override
protected void onDraw(Canvas canvas) {
    canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);            
    canvas.drawPath(mPath, mPaint);
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    float eventX = event.getX();
    float eventY = event.getY();
    int historySize = event.getHistorySize();

    switch (event.getAction()) {

        case MotionEvent.ACTION_DOWN:

            resetDirtyRect(eventX, eventY);
            mPath.reset();
            mPath.moveTo(eventX, eventY);
            mX = eventX;
            mY = eventY;
            break;

        case MotionEvent.ACTION_MOVE:

            float dx = Math.abs(eventX - mX);
            float dy = Math.abs(eventY - mY);

            if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {

                mPath.quadTo(mX, mY, (eventX + mX)/2, (eventY + mY)/2);
                mX = eventX;
                mY = eventY;
            }

            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                expandDirtyRect(historicalX, historicalY);
            }
            break;

        case MotionEvent.ACTION_UP:

            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                expandDirtyRect(historicalX, historicalY);
            }

            mPath.lineTo(mX, mY);
            mCanvas.drawPath(mPath, mPaint);
            mPath.reset();
            break;

        default:
            Log.d(TAG, "Ignored touch event: " + event.toString());
        return false;
    }

    // Include half the stroke width to avoid clipping.
        invalidate(     (int) (dirtyRect.left - HALF_STROKE_WIDTH),
                        (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                        (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                        (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

    lastTouchX = eventX;
    lastTouchY = eventY;
    return true;
}

private void expandDirtyRect(float historicalX, float historicalY) {
    if (historicalX < dirtyRect.left) {
        dirtyRect.left = historicalX;
    } else if (historicalX > dirtyRect.right) {
        dirtyRect.right = historicalX;
    }
    if (historicalY < dirtyRect.top) {
        dirtyRect.top = historicalY;
    } else if (historicalY > dirtyRect.bottom) {
        dirtyRect.bottom = historicalY;
    }
}

private void resetDirtyRect(float eventX, float eventY) {

    dirtyRect.left = Math.min(lastTouchX, eventX);
    dirtyRect.right = Math.max(lastTouchX, eventX);
    dirtyRect.top = Math.min(lastTouchY, eventY);
    dirtyRect.bottom = Math.max(lastTouchY, eventY);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:06:00.037

每次笔划值根据速度变化时，您都可以使用拆分路径对象。在你`SignatureView`的课堂上添加

```
private Path mPath = new Path();
ArrayList<Path> mPaths = new ArrayList<Path>(); 
```

并取另一个 ArrayList 来保持每个路径的笔画值

```
ArrayList<int> strokes = new ArrayList<int>(); 
```

`lastStroke`与`lastTouchX`和一起添加一个变量`lastTouchY`。我会推荐你​​ make `lastStroke`of type `int`。

```
private int lastStroke = -1; //give an initial value 
```

现在你的`onTouchEvent`方法应该是这样的

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    float eventX = event.getX();
    float eventY = event.getY();
    int historySize = event.getHistorySize();
    int eventStroke= //calculate stroke size with velocity and make it between 1-10 or any range you seem fit

    switch (event.getAction()) {

        case MotionEvent.ACTION_DOWN:

            resetDirtyRect(eventX, eventY);
            mPath.reset();
            mPath.moveTo(eventX, eventY);
            mX = eventX;
            mY = eventY;
            break;

        case MotionEvent.ACTION_MOVE:

            float dx = Math.abs(eventX - mX);
            float dy = Math.abs(eventY - mY);

            if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
                if(lastStroke != evetnStroke){
                    mPath = new Path();
                    mPath.moveTo(mX,mY);
                    mPaths.Add(mPath);
                    mStrokes.Add(eventStroke);
                }
                mPath.quadTo(mX, mY, (eventX + mX)/2, (eventY + mY)/2);
                mX = eventX;
                mY = eventY;
            }

            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                expandDirtyRect(historicalX, historicalY);
            }
            break;

        case MotionEvent.ACTION_UP:

            for (int i = 0; i < historySize; i++) {
                float historicalX = event.getHistoricalX(i);
                float historicalY = event.getHistoricalY(i);
                expandDirtyRect(historicalX, historicalY);
            }

           mPath.lineTo(mX, mY);
           break;

        default:
            Log.d(TAG, "Ignored touch event: " + event.toString());
        return false;
    }
    // Include half the stroke width to avoid clipping.
    invalidate(     (int) (dirtyRect.left - HALF_STROKE_WIDTH),
                    (int) (dirtyRect.top - HALF_STROKE_WIDTH),
                    (int) (dirtyRect.right + HALF_STROKE_WIDTH),
                    (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

    lastTouchX = eventX;
    lastTouchY = eventY;
    lastStroke = eventStroke;
    return true;
} 
```

你的 ondraw 方法是

```
@Override
protected void onDraw(Canvas canvas) {
    for(int i=0; i<mPaths.size();i++){
        mPaint.setStrokeWidth(strokes.get(i));
        canvas.drawPath(mPaths.get(i), mPaint);
    }
} 
```

这是基本思想。您需要对其进行修改以使其正常工作。

# asp.net - 关闭asp.net中的复制过程

> ID：15501209
> 
> 赞同：0
> 
> 时间：2013-03-19T13:43:39.160
> 
> 标签：asp.net, file, process, copy

我在 asp.net 中复制一个 500MB 的文件。每当用户在复制过程中关闭 Web 应用程序时，下次我尝试再次复制它时，它会向我抛出一个错误“访问路径被拒绝”。每当用户将网页留在副本中间时，我都想关闭该过程。一种可能的方法是在 global.asx 页面的 Session_End 事件中关闭该进程。但我不知道如何实现它。任何想法将不胜感激。

```
File.Copy(SrcPath,DestPath,true); 
```

# ios - 有没有办法区分哪个 UIPopOver 被解雇了？

> ID：15501210
> 
> 赞同：0
> 
> 时间：2013-03-19T13:43:45.940
> 
> 标签：ios, objective-c, uipopovercontroller, uipopover

我的应用程序中有几个弹出框，我很难确定哪个弹出框被忽略了。UIPopOvers 是否有等效的“标签”功能？

我可以`NSLog`在 popoverContorllerDidDismissPopover 方法中使用 popoverController 并查看每个的内存引用，但这无济于事。

```
#pragma mark - Popover controller delegates
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
    NSLog(@"Popover dismised %@", popoverController);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:49:56.383

[从这里](http://www.cocoabuilder.com/archive/cocoa/305826-dismissing-popover-internally.html)摘录：

> 如果我理解了这个问题，那么基本上，不——这很让人抓狂。一方面，您被告知在任何时候都应该只显示一个弹出框。另一方面，您不会自动获得对该弹出框的引用。因此，您可以在当前弹出框控制器显示其弹出框时手动存储对当前弹出框控制器的引用，以便稍后与它交谈以将其关闭。Popover 控制器管理因此变得非常复杂和笨拙；你正在做系统应该为你做的各种工作。
> 
> iOS 的这种方式很有趣。我想起了 iOS 4 中没有告诉你当前第一响应者的电话。显然系统知道第一响应者是什么，那它为什么不告诉你呢？这有点愚蠢。这是相似的；系统清楚地知道它不会与您分享的有用内容。米。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:09:28.803

有很多方法可以区分弹出框。我将列出其中的几个：

1.  你在问关于`tag`. 请注意，每个弹出框都有一个内容视图控制器，并且此控制器有一个可以标记的视图。然而，使用魔术整数标签来区分视图通常是有争议的。

2.  将弹出框的类型存储到控制器中的变量/属性中，例如作为`enum`. 这是最简单的方法。

3.  将必要的信息添加到弹出窗口中，但要聪明，例如

```
@interface MyPopoverController : UIPopoverController 

@property (nonatomic, copy, readwrite) void (^dissmissHandler)(void);

@end

@implementation MyPopoverController 

- (id)initWithContentViewController:(UIViewController*)contentView {
   self = [super initWithContentViewController:contentView];

   if (!self) {
      return nil;
   }

   self.delegate = self;

   return self;
}

- (void)popoverControllerDidDismissPopover:(UIPopoverController*)popover {
    assert(popover == self);

    if (self.dissmissHandler) {
       self.dissmissHandler();
    }
}

@end 
```

```
`MyPopoverController* popover = [MyPopoverController alloc] initWithContentViewController:...];
popover.dissmissHandler = ^{
   ...
};` 
```

* * *

 `## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T13:56:43.897

正如@Anoop 所说，您通常一次只能显示一个弹出窗口。

一种可能的解决方案是检查`contentViewController`弹出窗口上的属性。如果您要存储每个视图控制器的引用，您可以执行以下操作：

```
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
    if ( popoverController.contentViewController == self.someUIViewController ) {
        // do stuff
    }
    else if ( popoverController.contentViewController == someoTherViewController ) {
       //
    }
    NSLog(@"Popover dismised %@", popoverController);
} 
```

如果无法存储对每个内容视图控制器的引用（或者可能不是一个好主意），您可以随时检查其类型：

```
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
    if ( [popoverController.contentViewController isKindOfClass:[MyAwesomeViewController class]] ) {
        // do stuff
    }
    else if ( [popoverController.contentViewController isKindOfClass:[MyOtherViewController class]] ) {
        //
    }
    NSLog(@"Popover dismised %@", popoverController);
} 
```

另一种可能的解决方案（从设计的角度来看可能更好）是将委托传递给包含在弹出窗口中的视图控制器。[更多在这里](https://stackoverflow.com/a/1218098/620197)。这样，显示的视图控制器可以将数据发送回您的主视图控制器。`

# ios - AS3 iOS：加载外部 swf

> ID：15501213
> 
> 赞同：0
> 
> 时间：2013-03-19T13:44:03.747
> 
> 标签：ios, actionscript-3, air

我正在尝试使用 AIR3.6 在另一个中加载 swf。我复制了在这里找到的代码[http://blogs.adobe.com/airodynamics/2012/11/09/packaging-and-loading-multiple-swfs-in-air-apps-on-ios/](http://blogs.adobe.com/airodynamics/2012/11/09/packaging-and-loading-multiple-swfs-in-air-apps-on-ios/)但徒劳无功。它不起作用。所以我想我不明白程序的一部分。

那就是我所做的：

• 我有一个可以正确发布到iOS 的第一个fla。

• 在这个 fla 我有这个代码：

```
 var mLoader:Loader = new Loader();
        var mRequest:URLRequest = new URLRequest("test.swf");
        var _lc:LoaderContext = new LoaderContext(false, ApplicationDomain.currentDomain, null);
        mLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onCompleteHandler);

        mLoader.load(mRequest);
        function onCompleteHandler(loadEvent:Event)
        {
            addChild(loadEvent.currentTarget.content);
        } 
```

• 在发布设置中，我进入了常规选项卡，并包含了我的第二个 swf：test.swf

• 第二个swf (test.swf)。我使用 AIR 3.6 for iOS 发布了它。它根本没有动作脚本。里面只有一个绿色的形状。

• 当我测试我的第一个fla 时，第二个被正确加载。

• 当我在 iPad 上发布它时，第二个 swf 没有加载。

有人可以告诉我哪里错了吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:50:58.583

好的，在发布我的问题 10 秒后，我找到了解决方案。我只是忘了把 _lc:LoaderContext 放在 mLoader.load() 中。所以这里是：

```
 var mLoader:Loader = new Loader();
    var mRequest:URLRequest = new URLRequest("test.swf");
    var _lc:LoaderContext = new LoaderContext(false, ApplicationDomain.currentDomain, null);
    mLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onCompleteHandler);

    mLoader.load(mRequest, _lc);
    function onCompleteHandler(loadEvent:Event)
    {
        addChild(loadEvent.currentTarget.content);
    } 
```

版主注意：不确定这对任何人都有帮助，但我不知道如何删除帖子。

# android - Android普通按钮变为透明

> ID：15501214
> 
> 赞同：1
> 
> 时间：2013-03-19T13:44:03.610
> 
> 标签：android, android-layout

我有`RelativeLayout`一个背景设置为`android:background="@drawable/background"`.

在我的 RelativeLayout` 中，我有一个标准按钮，但是当我在运行 3.1 或更高版本的设备中运行应用程序时，按钮显示为透明的。

我试过设置`android:alpha`为 1 没有运气。

我知道我可以使用选择器和形状制作自定义背景，但必须有另一种方式。

还有其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:58:07.217

您需要将类似的内容添加到您的 style.xml

**应用主题**

```
<style name="ApplicationStyle" parent="android:Theme">
  <item name="android:buttonStyle">@style/MyButtons</item>
</style> 
```

**按钮样式**

```
<style name="MyButtons" parent="@android:style/Widget.Button">
    <item name="android:textSize">16sp</item>
    <item name="android:background">#000000</item>
</style> 
```

确保您也在清单中正确设置主题

```
<application
    android:allowBackup="true"
    android:icon="@drawable/app_icon"
    android:label="@string/app_name"
    android:theme="@style/Theme.ApplicationStyle" > 
```

# android - 每当显示软键盘时，自定义 AlertDialog 就会变形

> ID：15501225
> 
> 赞同：2
> 
> 时间：2013-03-19T13:44:42.367
> 
> 标签：android, layout, android-softkeyboard

我的应用程序显示了一个自定义的 AlertDialog，其中包含 4 个登录屏幕点。

它在 Galaxy S3（Android 4.1.2）上工作正常，但在 Galaxy Xcover（Android 2.3.6 和 3,65 英寸屏幕）上，只要显示软键盘，对话框就会变形：

![在此处输入图像描述](../Images/8fffc6137ed826fb0498c08ad0f6b664.png)

当我再次隐藏软键盘时，对话框正确显示

不确定它是否取决于 Android 版本或屏幕尺寸。

关于如何解决这个问题的任何想法？自定义 AlertDialog 有什么特别之处吗？

```
<LinearLayout 
              android:id="@+id/llPin"
              android:orientation="horizontal"
              android:gravity="center_horizontal|center_vertical"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"

              android:paddingBottom="10dp">

            <EditText
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/editTextPin1"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:background="@drawable/rounded_corners"
                    android:inputType="number"
                    android:password="true"
                    android:maxLength="1"
                    android:padding="5dp"
                    android:layout_margin="5dp"
                    android:nextFocusDown="@+id/editTextPin2"
                    android:nextFocusForward="@+id/editTextPin2"
                    android:nextFocusLeft="@+id/editTextPin2"
                    android:nextFocusRight="@+id/editTextPin2"
                    android:nextFocusUp="@+id/editTextPin2"
                    android:minWidth="30dp"/>

            <EditText
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/editTextPin2"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:background="@drawable/rounded_corners"
                    android:inputType="number"
                    android:password="true"
                    android:maxLength="1"
                    android:padding="5dp"
                    android:layout_margin="5dp"
                    android:nextFocusDown="@+id/editTextPin3"
                    android:nextFocusForward="@+id/editTextPin3"
                    android:nextFocusLeft="@+id/editTextPin3"
                    android:nextFocusRight="@+id/editTextPin3"
                    android:nextFocusUp="@+id/editTextPin3"
                    android:minWidth="30dp"/>

            <EditText
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/editTextPin3"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:background="@drawable/rounded_corners"
                    android:inputType="number"
                    android:password="true"
                    android:maxLength="1"
                    android:padding="5dp"
                    android:layout_margin="5dp"
                    android:nextFocusDown="@+id/editTextPin4"
                    android:nextFocusForward="@+id/editTextPin4"
                    android:nextFocusLeft="@+id/editTextPin4"
                    android:nextFocusRight="@+id/editTextPin4"
                    android:nextFocusUp="@+id/editTextPin4"
                    android:minWidth="30dp"/>

            <EditText
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:id="@+id/editTextPin4"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:background="@drawable/rounded_corners"
                    android:inputType="number"
                    android:password="true"
                    android:maxLength="1"
                    android:padding="5dp"
                    android:layout_margin="5dp"
                    android:nextFocusDown="@+id/editTextPin1"
                    android:nextFocusForward="@+id/editTextPin1"
                    android:nextFocusLeft="@+id/editTextPin1"
                    android:nextFocusRight="@+id/editTextPin1"
                    android:nextFocusUp="@+id/editTextPin1"
                    android:minWidth="30dp"/>
</LinearLayout> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T03:29:27.270

试试这个：

```
dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN); 
```

# android - X 和 Y 标签不与片段内的 GraphView 一起显示

> ID：15501227
> 
> 赞同：3
> 
> 时间：2013-03-19T13:44:56.240
> 
> 标签：android, android-graphview

问题很清楚：关于 X/Y 的信息显示在活动中，而不是在片段中......

在活动中，绘制图形并显示有关 X 和 Y 的信息以及图形的标题。

在片段中，只显示了图形，没有关于 X 和 Y 轴的信息，也没有标题......

活动：

```
public class Chart extends Activity {

@Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.chart);

    //UNDER CONSTRUCTION
    GraphViewSeries exampleSeries = new GraphViewSeries(new GraphViewData[] {  
          new GraphViewData(1, 2.0d)  
          , new GraphViewData(2, 1.5d)  
          , new GraphViewData(3, 2.5d)  
          , new GraphViewData(4, 1.0d)  
    });  

    GraphView graphView = new BarGraphView(  
          this // context  
          , "GraphViewDemo" // heading  
    );  
    graphView.addSeries(exampleSeries); // data  
    graphView.setBackgroundColor(Color.BLACK);

   LinearLayout layout = (LinearLayout) findViewById(R.id.chart);  
   layout.addView(graphView);  
  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
  }

} 
```

分段：

```
public class ChartFragment extends Fragment {

GraphView graphView;
LinearLayout layout;

// Parameterless constructor is needed by framework
public ChartFragment() {
    super();
}

/**
 * Sets up the UI. It consists if a single WebView.
 */
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    layout = new LinearLayout(getActivity());
    return layout;
}

public void displayChart(int mCatIndex, int mPeriodIndex) {

    int num = 150;  
    GraphViewData[] data = new GraphViewData[num];  
    double v=0;  
    for (int i=0; i<num; i++) {  
       v += 0.2;  
       data[i] = new GraphViewData(i, Math.sin(v));  
    }  
    graphView = new LineGraphView(  
          null 
          , "GraphViewDemo"  
    );  
    // add data  
    graphView.addSeries(new GraphViewSeries(data));  
    // set view port, start=2, size=40  
    graphView.setViewPort(2, 40);  
    graphView.setScrollable(true);  
    // optional - activate scaling / zooming  
    graphView.setScalable(true);  
    layout.addView(graphView);  
}

} 
```

可能是什么问题？

**编辑和解决方案：**

愚蠢的错误：X 和 Y 标签都是白色的......在第一个布局中，我的背景是黑色 ==> 好的

在我的片段中，背景是白色 ==> 看不到 X 和 Y 标签

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:33:25.910

在第一个示例中，您的 LinearLayout 是在布局中定义的（可能带有固定的 with/height 参数）。尝试使用固定的宽度/高度值在片段中定义您的 LL。

# php - 更新没有主键的表

> ID：15501237
> 
> 赞同：0
> 
> 时间：2013-03-19T13:45:28.847
> 
> 标签：php, mysql

我正在建立一家商店，每种产品都有一组独特的属性。

产品数据库如下所示：

```
products_id, relation_id, product_name, description, 
price, glass, shipping, img, cat, subcat, model 
```

由于每个产品都有几个（约 40 个）该产品独有的不同属性，因此我只创建了第二个表来存储它们。

```
products_id, att_name, att_val, att_head, att_standard, att_order 
```

这很好用，因为永远不会有两个唯一的行。然而，问题是当我需要修改属性内容时。

使用 MySQL Workbench 我可以使用类似的东西修改一行

```
UPDATE product_attributes SET att_val='1500' WHERE products_id='112' AND att_head='threshold' 
```

但是，当我从我的 php 脚本更新时，这似乎不起作用。

有没有一种简单的方法来修改表以支持更新？

我很清楚没有一个独特的专栏是愚蠢的。但我不知道如何使这两个表相关。我应该在哪里存储属性的唯一 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:50:39.030

一种选择，

将**主键**“auto_incremented”添加到`product_attributes`表中...

```
ALTER TABLE `product_attributes` ADD  `id` INT( 10 ) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST 
```

此**ID**仅用于 CRUD *（创建读取更新删除）*任务。

您可以在两张桌子之间建立的唯一关系是允许您有`products_id`几张桌子`product_attributes``product`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:48:58.100

由于 1 个产品具有超过 1 个您存储在第二个表中的唯一属性，因此您应该使用表产品的 ID 并将其与属性一起存储在第二个表中。

希望这是你需要的？

# c - 打印 uint16_t 类型

> ID：15501238
> 
> 赞同：4
> 
> 时间：2013-03-19T13:45:28.980
> 
> 标签：c, printf, uint16

我正在以这种方式以二进制模式读取文件：

```
fread(&pcap_header      ,sizeof(pcap_hdr_t      ),  1 , pFile);
fread(&pcaprec_header   ,sizeof(pcaprec_hdr_t   ),  1 , pFile);
fread(&ether_header     ,sizeof(ethernet_hdr_t  ),  1 , pFile);
fread(&ip_header        ,sizeof(ip_hdr_t        ),  1 , pFile);
fread(&tcp_header       ,sizeof(tcp_header_t    ),  1 , pFile);
fread(&modbus_header    ,sizeof(modbus_header_t ),  1 , pFile); 
```

而上面的所有变量都被定义为它旁边的“sizeof()”函数中的类型。我正在尝试提取文件的特定部分并打印它。这部分的大小为 16 位，定义如下：

```
uint16_t     ip_len; 
```

在类型“ip_hdr_t”内。我查看了 WireShark，看到这 16​​ 位的实际值是 0x0034。

我尝试了两件事：

1.  `printf("size of ip header: %hu\n", ip_header.ip_len);`打印 13312 （好像位的值是 0x3400）
2.  将结构划分为两个 8 位变量： `uint8_t ip_len; uint8_t ip_len2;` 并分别打印： `printf("size of ip header: %hu\n", ip_header.ip_len); printf("size of ip header: %hu\n", ip_header.ip_len2);`

这次我收到了输出：ip header 的大小：0 (0x00) ip header 的大小：52 (0x34)，这是正确的答案。

我的问题是：第一次打印出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T13:46:54.977

你有一个[字节顺序](http://en.wikipedia.org/wiki/Endianness)问题；您的平台与您使用的协议不具有相同的字节顺序。您需要交换字节的顺序。

如果您使用的是 POSIX 兼容系统，则可以使用[`ntoh`函数族](http://linux.die.net/man/3/ntohl)。

我不确定是否有适用于 Windows 的等价物。

# validation - 地图的自定义验证 使用 Play 框架 1.2.5

> ID：15501239
> 
> 赞同：1
> 
> 时间：2013-03-19T13:45:34.883
> 
> 标签：validation, playframework-1.x

我使用 Play Framework 1.2.5 并在一定程度上使用自定义验证。我不太清楚如何验证地图并报告每个字段的错误。

我的实体有一个描述属性，允许用户将描述翻译成任意数量的语言。

```
public class MyEntity extends Model {
    ...

    @Valid
    public Map<Locale, String> description;

    ...
} 
```

基本上我的表单包含每个语言环境的文本区域。

```
<textarea rows="3" name="entity.description[en]" id="entity_description_en"></textarea>
<textarea rows="3" name="entity.description[da]" id="entity_description_da"></textarea> 
```

我可以绑定它，但是如何验证各个翻译，并报告字段级别的任何错误，而不仅仅是 entity.description？

**更新**：我知道它可以作为控制器的一部分来完成，如下所示，但如果所有验证仅在模型上进行，我更愿意。

```
public static void create(@Valid MyEntity entity) {
    validateMapKey("entity.description", entity.description, Locale.ENGLISH);
    validateMapKey("entity.description", entity.description, new Locale("da"));

    if(validation.hasErrors()) {
        params.flash(); // add http parameters to the flash scope
        validation.keep(); // keep the errors for the next request
        index();
    }

    ...     
}

private static void validateMapKey(String f, Map<Locale, ? extends Object> v, Locale l) {
    validation.required(String.format("%s[%s]", f, l), v.get(l));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:10:24.093

[@CheckWith](http://www.playframework.com/documentation/1.2.3/validation#anamecustomCustomvalidationusingCheckWitha)注释可以帮助你..

```
@CheckWith(MyMapCheck.class)
public Map<Locale, String> description;

static class MyMapCheck extends Check {

    public boolean isSatisfied(Object myEntityInstance, Object descriptionValue) {
        return checkMyDescriptionAndReturnBoolean(description);
    }
} 
```

# windows - 在 PowerShell 中如何将文件从远程 PSsession 复制到另一台 Windows 服务器

> ID：15501241
> 
> 赞同：3
> 
> 时间：2013-03-19T13:45:36.417
> 
> 标签：windows, powershell, powershell-remoting

我正在尝试将一个文件夹从一个远程服务器复制到 PSSession 中的另一个服务器，它给出了访问被拒绝之类的错误。我对两台服务器都有管理员权限。如果我在没有 PSSession 的情况下尝试它，它会起作用。

在远程服务器A

```
PS C:\Users\Automation\Documents> [System.Net.Dns]::GetHostName()
sql
PS C:\Users\Automation\Documents> Copy-Item -Path .\abc.csv -Destination "\\jump\c$"
PS C:\Users\Automation\Documents> 
```

在远程服务器 B

```
 PS C:\Users\Automation\Documents\sample\SQL Final Scripts> Copy-Item -Path ".\SQL_queries.csv" -Destination "\\sql\c$\"
    PS C:\Users\Automation\Documents\sample\SQL Final Scripts> Enter-PSSession -ComputerName sql  -Credential "automation@lab"

    [sql]: PS C:\Users\Automation\Documents> Copy-Item -Path ".\SQL_queries.csv" -Destination "\\jump\c$\"

Copy-Item : Access to the path '\\jump\c$\' is denied.
        + CategoryInfo          : PermissionDenied: (C:\Users\Automa...SQL_queries.csv:FileInfo) [Copy-Item], Unauthorized
       AccessException
        + FullyQualifiedErrorId : CopyFileInfoItemUnauthorizedAccessError,Microsoft.PowerShell.Commands.CopyItemCommand

    [sql]: PS C:\Users\Automation\Documents> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T05:05:48.017

您正面临“双跳”问题。在 SQL 计算机上运行它

```
Enable-WSManCredSSP -Role Server 
```

并在服务器 B 上运行它

```
Enable-WSManCred -Role Client -DelegateComputer * 
```

然后当你进入远程会话时

```
Enter-PSSession -ComputerName sql -Authentication Credssp -Credential (Get-Credential) 
```

希望这可以帮助。

如果您在阅读此答案时打了喷嚏，请保佑您的脸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:07:56.960

如果您想了解有关“双跳”问题的更多信息，请参阅本文： [WinRM 中的多跳支持](http://msdn.microsoft.com/en-us/library/windows/desktop/ee309365%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T13:50:58.290

我相信您正面临“双跳”问题，使用[CredSSP解决了这个问题](http://blogs.msdn.com/b/powershell/archive/2008/06/05/credssp-for-second-hop-remoting-part-i-domain-account.aspx)

# tabs - 如何使 awk gsub 返回制表符分隔的行？

> ID：15501242
> 
> 赞同：4
> 
> 时间：2013-03-19T13:45:40.807
> 
> 标签：tabs, awk, spaces, separator, gsub

我使用 awk gsub 替换我的制表符分隔文件的特定列中的字符串：

```
cat test.txt 
1   1   2032    1
2   1   2032    2
3   1   999 3
4   1   2032    4
5   1   9999    5 
```

但是，即使指定了 -F "\t"，修改后的行也用空格分隔：

```
awk -F "\t" '{gsub(/^999$/,"XXX",$3);print}' test.txt
1   1   2032    1
2   1   2032    2
3 1 XXX 3
4   1   2032    4
5   1   9999    5 
```

我怎样才能让修改后的行也用制表符分隔？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T13:48:54.493

你应该设置

```
OFS="\t" 
```

所以 ：

```
awk -F "\t" '{gsub(/^999$/, "XXX", $3); print}' OFS="\t" test.txt 
```

或者

```
awk -F "\t" -v OFS="\t" '{gsub(/^999$/, "XXX", $3); print}' test.txt 
```

或者

```
awk 'BEGIN{OFS=FS="\t"}{gsub(/^999$/, "XXX", $3); print}' OFS="\t" test.txt 
```

见[man awk](http://www.manpagez.com/man/1/awk/)

# ios - 判断当前屏幕是否有可见的导航栏

> ID：15501244
> 
> 赞同：0
> 
> 时间：2013-03-19T13:45:47.607
> 
> 标签：ios, cocoa, singleton, uinavigationbar

我有一个单例对象。是否有任何简单的方法可以确定当前屏幕是否包含单例方法中的导航栏？

单例是 UIView 子类。它是为显示进度活动而设计的，例如网络交换。它看起来像黑色矩形从顶部下降并在工作完成后隐藏。为什么是单例？从任何代码位置都可以轻松调用它

以下片段显示了活动单例的初始化，并在此处发布只是为了更好地理解我的想法。

```
-(void) showUpdatingView:(NSString *) msg {
    [self initWithFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 44)];
    activity = [[[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite] autorelease];
    activity.frame = CGRectMake(5, 10, 22, 22);
    labelView = [[[UILabel alloc] initWithFrame:CGRectMake(35, 10, [UIScreen mainScreen].bounds.size.width - 10, 22)] autorelease];
    labelView.font = [UIFont boldSystemFontOfSize:12];
    labelView.backgroundColor = [UIColor clearColor];
    labelView.textColor = [UIColor whiteColor];
    labelView.text = msg;
    [self addSubview:activity];
    [self addSubview:labelView];
    self.backgroundColor = [UIColor blackColor];
    self.alpha = 0.7;
} 
```

活动可以通过

```
[[ActivitySingleton getInstance] showUpdatingView:@"Getting data."]; 
```

这还不是全部。正在 AppDelegate 对象中创建单例，并将视图添加到

```
 inlineActivity = [[CHInlineActivityView alloc] initView];
    [self.window.rootViewController.view addSubview:inlineActivity]; 
```

我知道这可能看起来很疯狂。但在我设计的时候，我觉得这很合理

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:27:59.430

如果您拥有一个导航控制器：

`BOOL navHidden = self.window.rootViewController.navigationController.navigatonBarHidden;`

* * *

如果你不这样做有点难..你可以检查窗口的子视图，看看你是否能找到`UINavigationBar`

```
id navbar = [self.window firstSubviewOfKind:[UINavigationBar class] withTag:NSNotFound];
BOOL navHidden = navbar == nil;

@implementation NSView (findSubview)

- (NSArray *)findSubviewsOfKind:(Class)kind withTag:(NSInteger)tag inView:(NSView*)v {
    NSMutableArray *array = [NSMutableArray array];

    if(kind==nil || [v isKindOfClass:kind]) {
        if(tag==NSNotFound || v.tag==tag) {
            [array addObject:v];
        }
    }

    for (id subview in v.subviews) {
        NSArray *vChild = [self findSubviewsOfKind:kind withTag:tag inView:subview];
        [array addObjectsFromArray:vChild];
    }

    return array;
}

#pragma mark - 

- (NSView *)firstSubviewOfKind:(Class)kind withTag:(NSInteger)tag {
    NSArray *subviews = [self findSubviewsOfKind:kind withTag:tag inView:self];
    return subviews.count ? subviews[0] : nil;
}

@end 
```

# python - GAE：Urllib2 不适用于本地环境

> ID：15501245
> 
> 赞同：1
> 
> 时间：2013-03-19T13:45:51.763
> 
> 标签：python, google-app-engine, urllib2

我正在使用 GAE 构建一个 Web 应用程序，该应用程序使用 urllib2 库获取 URL。

有人可以向我解释为什么这段代码：

```
import webapp2
import urllib2

class BaseHandler(webapp2.RequestHandler):      
    def write(self, *a, **kw):
        self.response.out.write(*a, **kw)

class MainPage(BaseHandler):
    def get(self):
        self.write(urllib2.urlopen("http://www.google.com").read())

app = webapp2.WSGIApplication([("/", MainPage)], debug = True) 
```

在本地环境中访问时抛出以下异常，但在部署时按预期工作？

```
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 1535, in __call__
    rv = self.handle_exception(request, response, e)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 1529, in __call__
    rv = self.router.dispatch(request, response)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2-2.5.2\webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "C:\Users\Developer\Desktop\test\main.py", line 15, in get
    self.write(urllib2.urlopen("http://www.google.com").read())
  File "C:\Python27\lib\urllib2.py", line 126, in urlopen
    return _opener.open(url, data, timeout)
  File "C:\Python27\lib\urllib2.py", line 400, in open
    response = self._open(req, data)
  File "C:\Python27\lib\urllib2.py", line 418, in _open
    '_open', req)
  File "C:\Python27\lib\urllib2.py", line 378, in _call_chain
    result = func(*args)
  File "C:\Python27\lib\urllib2.py", line 1207, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File "C:\Python27\lib\urllib2.py", line 1180, in do_open
    r = h.getresponse(buffering=True)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\dist27\httplib.py", line 507, in getresponse
    'An error occured while connecting to the server: %s' % e)
error: An error occured while connecting to the server: Unable to fetch URL: http://www.google.com Error: [Errno 10106] getaddrinfo failed 
```

请注意，当从解释器中使用 urllib2 时，它会按预期工作。

此外，如果使用 IP 地址完成获取，则应用程序将按预期工作。例如

```
self.write(urllib2.urlopen("http://173.194.42.34").read()) 
```

注意：我确实已经用另一个帐户问过[这个](https://stackoverflow.com/questions/15492961/cannot-fetch-urls-from-gae-local-environment)问题，我没有注意到我正在用另一封邮件访问 SO，而不是我打算发送垃圾邮件。相反，这个问题更直接，代码+堆栈跟踪更能说明我的问题

# c# - Windows 8 应用程序，obserablecollection 视图模型给出 xaml 错误：没有这样的表

> ID：15501246
> 
> 赞同：1
> 
> 时间：2013-03-19T13:45:52.817
> 
> 标签：c#, xaml, windows-8, viewmodel, observablecollection

嗨，我在从 xaml 中的集合视图模型绑定数据时遇到问题。

但是数据绑定失败，VisualStudio 报告错误“没有这样的表：配方”有人可以帮我解决这个问题吗？

XAML：

```
<Page.DataContext>
    <vm:RecipeListViewModel />
</Page.DataContext>

<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <ListView Header="Recipes" x:Name="RecipeList" HorizontalAlignment="Left" Height="512" Margin="156,118,0,0" VerticalAlignment="Top" Width="430" DataContext="{Binding Recipes[0].Recipe_Name}" ItemsSource="{Binding RecipeCollection.Recipe}"  />

    <Image x:Name="Img" HorizontalAlignment="Left" Height="260" Margin="698,116,0,0" VerticalAlignment="Top" Width="462"/>
    <Button Content="Button" HorizontalAlignment="Left" Margin="698,420,0,0" VerticalAlignment="Top" Click="Button_Click_1"/>

</Grid> 
```

RecipeListViewModel

```
 class RecipeListViewModel : INotifyPropertyChanged
{
    ObservableCollection<Recipe> _Recipes;
    public ObservableCollection<Recipe> Recipes
    {
        get { return _Recipes; }
        set 
        {
            if (_Recipes != value)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("Recipes"));
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged = delegate { };

    public RecipeListViewModel()
    {

        _Recipes = new ObservableCollection<Recipe>();

        var dbPath = Path.Combine(Windows.Storage.ApplicationData.Current.LocalFolder.Path, "LCHFData.db");
        using (var db = new SQLite.SQLiteConnection(dbPath))
        {
            var tb = db.Table<Recipe>().ToList<Recipe>();
            foreach (Recipe recipe in tb)
            {
                _Recipes.Add(recipe);
            }
        }

    }
} 
```

食谱视图模型：

```
 class RecipeViewModel : INotifyPropertyChanged{

    /*
     *   Class to Display whole recipe object
     */
    Recipe _Recipe;
    public Recipe Recipe 
    { 
        set 
        {
            if (_Recipe != value)
            {
                _Recipe = value;
                PropertyChanged(this, new PropertyChangedEventArgs("Recipe"));
            }
        }
        get { return new Recipe() { Recipe_Name = "boo "}; } 
    }

    public event PropertyChangedEventHandler PropertyChanged = delegate { };
} 
```

# c - 位掩码 + 类型转换未按预期返回

> ID：15501247
> 
> 赞同：1
> 
> 时间：2013-03-19T13:45:53.500
> 
> 标签：c, type-conversion, bit-manipulation

我有一种情况，位掩码和/或类型转换无法按预期工作。我正在使用一个非常大的分布式系统，其中一些部分是用 C 编写的。

让我困惑的几行代码是：

```
uint16_t
mask(uint32_t nr)
{
  return (uint16_t)(nr & 0x1ff);
}

...

  int nr = 65536;
  int index;
  index = mask(nr);

... 
```

在这种情况下，掩码的返回是 65536 而不是预期的 0。这个例子中有一些不一致的类型转换，但我不明白结果怎么可能是错误的。我们基本上屏蔽了 32 位整数的低 9 位，并将结果转换为 16 位整数。我最好的猜测是，有一些编译器优化会改变前 16 位，但对高 16 位没有任何作用，因为我们只想返回 16 位。由于在这种情况下“索引”是一个 32 位整数，这还包括“nr”的第 17 位，它没有在位掩码中修改，因此第 17 位仍然设置为 1 并将 65536 分配给索引.

有没有人对这种行为有解释？

编辑：我忘记了一些重要的参数。正确包含掩码函数的原型。该系统是为 Linux x86 构建的，带有 gcc 4.3.2。

编辑2：汇编代码：

```
0805b640 <mask>:
 805b640:       55                      push   %ebp
 805b641:       89 e5                   mov    %esp,%ebp
 805b643:       83 ec 18                sub    $0x18,%esp
 805b646:       65 a1 14 00 00 00       mov    %gs:0x14,%eax
 805b64c:       89 45 fc                mov    %eax,0xfffffffc(%ebp)
 805b64f:       31 c0                   xor    %eax,%eax
 805b651:       8b 45 08                mov    0x8(%ebp),%eax
 805b654:       66 25 ff 01             and    $0x1ff,%ax
 805b658:       8b 55 fc                mov    0xfffffffc(%ebp),%edx
 805b65b:       65 33 15 14 00 00 00    xor    %gs:0x14,%edx
 805b662:       75 02                   jne    805b666 <maks+0x26>
 805b664:       c9                      leave  
 805b665:       c3                      ret    
 805b666:       e8 a5 ac 04 00          call   80a6310 <__stack_chk_fail_local>
 805b66b:       90                      nop    
 805b66c:       8d 74 26 00             lea    0x0(%esi),%esi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T16:06:39.067

这是我的 gcc (4.6.2) 产生的`mask`结果（经过优化；没有，它周围有一些绒毛）：

```
.LFB0:
    .cfi_startproc
    movl    4(%esp), %eax
    andw    $511, %ax
    ret
    .cfi_endproc 
```

所以它确实只修改了低阶 16 位，调用者有责任实际将高阶 16 位清零

```
movzwl  %ax, %eax 
```

如果在调用站点知道正确的原型，它会这样做。我非常怀疑

> 正确包含掩码函数的原型。

事实并非如此，检查并重新检查。如果确实如此，那么您已经发现了一个重大错误（如此重大以至于我们可能已经听说过）。

> `uint16_t`并`uint32_t`通过包含 linux/types.h 提供

嗯，这里没有。它们由`stdint.h`. 无论如何，您都应该`#include <stdint.h>`得到它们，即使它们也由`linux/types.h`您的系统提供，因为这是便携式解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T15:44:21.800

我在这里看到的唯一可能的解释是没有调用预期的掩码函数。请仅在一个文件中尝试您的示例代码，和/或重命名掩码函数。您的值 (0x10000) 的位和 (nr & 0x1ff) 应始终为零。

# vb.net - Crystal Report 在 VB.NET 中不显示数据

> ID：15501248
> 
> 赞同：0
> 
> 时间：2013-03-19T13:45:56.863
> 
> 标签：vb.net, crystal-reports, reportviewer

在我的项目中，水晶报表查看器在我第一次单击显示按钮时不显示数据。

当我关闭水晶报表查看器并再次按下显示按钮时，它将显示数据。为什么它会这样工作？

# javascript - 处理函数的高效 javascript 等价物

> ID：15501251
> 
> 赞同：1
> 
> 时间：2013-03-19T13:46:07.550
> 
> 标签：javascript, processing

我调整了一个处理草图，以产生一个我需要的网络应用程序的电视静态效果的变体。现在我想把这个效果转换成 JS/canvas。*下面的*处理代码中给出的纯 javascript/canvas 等价物是`loadPixels()`什么？`copyArray()``updatedPixels()``draw()`

 *```
int[] ppx;
Random generator = new Random();

void setup() {
  size(640,480);
  loadPixels();  
  ppx = new int[pixels.length];
  for (int y = 0; y < ppx.length;y++) {
      int spread = generator.nextInt(5);
      switch(spread) {
        case(1):
            if(y-480 > 0) {
                ppx[y] = ppx[y-480];
            }
            break;
        case(2):
            if(y-1 > 0) {
                ppx[y] = ppx[y-1];
            }
            break;
        case(3):
            ppx[y] = color(0,generator.nextInt(2)*255,0);
            if(y+480 < ppx.length) {
                ppx[y+480] = ppx[y];
            }
            break;
        case(4):
            ppx[y] = color(0,generator.nextInt(2)*255,0);
            if(y+1 < ppx.length) {
                ppx[y+1] = ppx[y];
            }
            break;
        case(0):
            break;
      };
  }
  frameRate(100000000000L);

}
void draw() {
  for (int y = 0; y < height;)
     arrayCopy(ppx, generator.nextInt(height/2), pixels, y++*width,width);
  updatePixels();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:51:48.870

您可以使用 John Resig 的 Processing.js 进行一次性转换： http: [//processingjs.org/](http://processingjs.org/)

Canvas 和 JS 的工作水平要低一些，可能从这里开始：http: [//net.tutsplus.com/tutorials/javascript-ajax/canvas-from-scratch-pixel-manipulation/](http://net.tutsplus.com/tutorials/javascript-ajax/canvas-from-scratch-pixel-manipulation/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:05:06.100

到目前为止，我已经使用指向 HTMLCanvasElement 的 s 实现了这些函数。是否[可以在](https://stackoverflow.com/q/15501573/907415)不[展开循环](https://stackoverflow.com/questions/1448943/javascript-fastest-way-of-copying-an-array-portion-into-another)的情况下改进 arrayCopy 尚无定论：

```
 var x = s.getContext('2d');
    var pixels;
    function arrayCopy(src,sstart,dst,dstart,length) {
            length += sstart;
            dstart += length;
            while(--length > sstart) {
                    dst[--dstart] = src[length];    
            }       
    }
    function loadPixels() {
            pixels = x.getImageData(0,0,s.width,s.height);
    }
    function updatePixels() {
            x.putImageData(0,0,pixels);
    } 
```

我仍然不确定如何使 JS 等效于一个`draw()`函数。*

# java - java 1.4的json库

> ID：15501258
> 
> 赞同：4
> 
> 时间：2013-03-19T13:46:28.153
> 
> 标签：java, json, java1.4

我正在使用 JCAPS 5.1.3，只有 Java 1.4，需要处理 Json 数据。不幸的是，我发现的所有库都使用 Java 1.5 及更高版本。 [我刚刚在这个线程中发现了很多新的实现，但是哪一个适用于 1.4。](https://stackoverflow.com/q/338586/2186724)

**Java 1.4 是否有稳定且简单的版本？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-24T20:44:59.140

[Xstream](http://x-stream.github.io/) 1.2.2 支持 Java 1.4。这是我发现的唯一支持 Java 1.4 的库。它肯定有它的疣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T15:09:16.390

另一种方法是使用 Retroweaver 使 jar 与 Java 1.4 兼容：

[http://retroweaver.sourceforge.net](http://retroweaver.sourceforge.net)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-23T21:07:23.423

你可以使用[我的 json 库](https://gitlab.com/MarianoLEANCE/json-legacy-tools)。它支持编组和解组到类（有一些限制）和解析。

编组：

```
Knight knight = new Knight();

knight.name = "Lancelot";
knight.weapon = new Weapon();
knight.weapon.metal = "true silver";
knight.weapon.name = "piercer";
knight.rank = 2;
knight.titles = new String[] { "noble", "round table member" };

Land goldshire = new Land();
goldshire.name = "GoldShire";
goldshire.surface = 45532.3;
Land direwood = new Land();
direwood.name = "Direwood";
direwood.surface = 472;
knight.lands = new Land[] { goldshire, direwood };

System.out.println("Test 1 : marshall simple class:");
String generated = JsonFactory.marshal(knight).toString(); 
```

解组：

```
Knight knight = (Knight) JsonFactory.unmarshal(new FileTools().readFile("UnmarshallingTest1.json"), Knight.class); 
```

# android - 保护 Android Intent 中的额外数据

> ID：15501260
> 
> 赞同：7
> 
> 时间：2013-03-19T13:46:30.780
> 
> 标签：android, android-intent, android-4.2-jelly-bean

我正在使用 Intent 在新任务中启动新活动。此 Intent 在其附加内容中包含该 Activity 所需的一些私有数据。此数据不应被其他应用程序读取。我们已经调查了这些数据是否确实没有泄露。我们发现，通过使用 getRecentTasks() 中的 RecentTaskInfo，任何具有 GET_TASK 权限的任意应用程序都可以读取这些额外的数据。这不是很安全。一旦我们发现这个泄漏，我们就停止了搜索。是否有更多方式泄露这些数据？而且，如何确保额外的数据不被其他应用程序读取？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T14:14:35.023

从 Android 4.1.1 开始，添加了一个额外的权限，以防止第三方应用程序使用`RecentTaskInfo`. 此权限 ( `android.Manifest.permission.GET_DETAILED_TASKS`) 只能由系统获取。如果没有此权限，多余的将在`baseIntent`通过`RecentTaskInfo`.

从提交[http://androidxref.com/4.2.2_r1/history/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java#8238e717df4bc5eebf15f97172d68af3599a95bb](http://androidxref.com/4.2.2_r1/history/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java#8238e717df4bc5eebf15f97172d68af3599a95bb)的评论：

> 添加新的签名级权限以获取任务的详细信息。
> 
> 第三方应用程序现在无法访问与任务相关的额外意图，以防止其中的私人数据泄露。
> 
> 更改 ID：I95af9e181ac42557bc8b981807e7ddd266a88d0e

因此，似乎正在努力使 Intent extra 更安全地传输敏感信息。我不知道是否还有其他方式可以泄漏这些额外内容，但至少从 JB 开始，这些额外内容似乎还可以。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-19T13:55:17.997

> 此 Intent 在其附加内容中包含该 Activity 所需的一些私有数据

为什么？将标识符传递给额外的私有数据，其中将这些标识符解析为该私有数据（例如，数据库查询）只能由活动完成。

> 我们发现，通过使用 getRecentTasks() 中的 RecentTaskInfo，任何具有 GET_TASK 权限的任意应用程序都可以读取这些额外的数据

是的，我在近两年前[写过关于这个的博客，其他人可能在此之前就写过。](http://commonsware.com/blog/2011/06/30/warning-activity-intent-extras-public.html)

> 是否有更多方式泄露这些数据？

所有启动其他组件的请求都通过操作系统进程进行，因此数据一直“泄露”给操作系统。

而且，根据您对 的处理`Intent`方式，您可能会以其他方式泄漏它（例如，将 an`Intent`本身作为传递`Parcelable`给其他应用程序）。

> 而且，如何确保额外的数据不被其他应用程序读取？

你不能。同样，不要将私有数据放在活动附加内容中，而是使用可用于获取该私有数据的标识符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T13:57:54.147

You have private storage space, which is readable only by your application. On non-rooted devices, the information you store there will only be accessible to your app.

You could use a [SharedPreference](http://developer.android.com/reference/android/content/SharedPreferences.html) to store your data - the data is stored in your app's designated private storage.

Alternatively, you can use the private storage directly and wire arbitrary files there like this:

```
FileOutputStream fos;
try {
    fos = openFileOutput (FILENAME, Context.MODE_PRIVATE);
    fos.write (string.getBytes ());
    fos.close ();
} catch (FileNotFoundException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

# javascript - 重新使用选项变量作为 jquery 扩展的输出

> ID：15501263
> 
> 赞同：2
> 
> 时间：2013-03-19T13:46:37.410
> 
> 标签：javascript, jquery

通常，当您使用 defaultOptions 扩展选项时，您会创建一个新对象，但我想重新使用选项对象。请参见下面的代码。

我基本上想做以下事情：

```
var defaultOptions = {'width': '10px', 'size': '10px'};

var options = {'width': '300px', 'name': 'sam'};

// I want to re-use the same options variable as target for extend
var optionsAfterExtend = $.extend(options, defaultOptions, options);

// should return true
alert(options.width == '300px');
alert(optionsAfterExtend == '300px');
alert(options.size == '10px');
alert(optionsAfterExtend == options);

// Because I may add extra info to the options object which the client using my plugin can use / re-use
optionsAfterExtend.data = 'sam';

// So now optionsAfterExtend.data and options.data should both equal 'sam' 
```

尝试搜索了很长时间并阅读了 jquery 扩展文档，但找不到合适的方法。我想要这个只是愚蠢吗？即使是这样，我仍然很好奇如何以一种好的方式做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:53:39.287

该`extend`方法将所有属性复制到您作为第一个参数发送的对象中。要创建一个组合其他对象的新对象，请提供一个空对象作为第一个参数：

```
var optionsAfterExtend = $.extend({}, defaultOptions, options); 
```

如果您还希望`options`对象更改，并且对象相同，请创建一个新对象，然后将其扩展回`options`：

```
var o = $.extend({}, defaultOptions, options);
var optionsAfterExtend = $.extend(options, o); 
```

# asp.net - 大附件未在 .NET 中通过邮件发送

> ID：15501264
> 
> 赞同：-1
> 
> 时间：2013-03-19T13:46:41.153
> 
> 标签：asp.net

我正在使用 VS2010 并尝试发送超过 2MB 的大文件。但是文件没有被发送。小文件很容易被发送。

我的机器操作系统是indow server 2008。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:50:20.327

检查您的 web.config 文件中的**maxRequestLength**参数。

在这种情况下，2048 = 2 BMB

```
<configuration>
  <system.web>
    <httpRuntime maxRequestLength="2048" />
  </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:52:13.590

您可以压缩附件

链接： http: [//www.chilkatsoft.com/refdoc/csZipEntryRef.html](http://www.chilkatsoft.com/refdoc/csZipEntryRef.html)

样本

```
ZipEntry newEntry = new ZipEntry(fileName);
newEntry.DateTime = DateTime.Now;
newEntry.Size = fileData.Length; 
```

# c# - 使用 Export To CSV 方法后没有控制回发

> ID：15501268
> 
> 赞同：0
> 
> 时间：2013-03-19T13:46:51.973
> 
> 标签：c#, asp.net, http, sharepoint

取得了一些成功，我正在使用[这个建议的代码](https://stackoverflow.com/a/6674589/914773)将网格视图导出到 CSV（或者在我的情况下是 TSV）。

我单击我的按钮，页面帖子返回，TSV 已交付。伟大的。

但是，在回发之后，没有其他控件（自动回发设置为 true 和按钮的下拉列表 - 一个提交另一个 javascript 触发的回发按钮）将回发到服务器。

可能的线索：查看 Google Chrome 网络选项卡，CSV 的 POST 被视为“已取消”。

如果他们提供任何帮助，这里是 CSV 的 REQUEST 和 RESPONSE 标头 - 我已经删除了一些与安全性相关的内容：

要求：

```
POST /Perspective/SitePages/User_Email_List.aspx HTTP/1.1
Host: as-sharepoint
Connection: keep-alive
Content-Length: 8740
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Origin: http://as-sharepoint
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22
Content-Type: application/x-www-form-urlencoded
DNT: 1
Referer: http://as-sharepoint/Perspective/SitePages/User_Email_List.aspx
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: WSS_KeepSessionAuthenticated={xxx} 
```

回复：

```
HTTP/1.1 200 OK
Cache-Control: private
Transfer-Encoding: chunked
Content-Type: application/text
Server: Microsoft-IIS/7.5
SPRequestGuid: xxx
Set-Cookie: WSS_KeepSessionAuthenticated={xxx}; path=/
X-SharePointHealthScore: 1
Set-Cookie: WSS_KeepSessionAuthenticated={xxx}; path=/
Content-Disposition: attachment;filename=EmailList.tsv
X-AspNet-Version: 2.0.50727
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 14.0.0.4762
Date: Tue, 19 Mar 2013 13:40:18 GMT 
```

其他可能的相关信息：

*   我调用的方法位于页面上的标签中（这是一个 Sharepoint 网站，它使代码隐藏变得困难）
*   我感觉这与未正确关闭分块下载有关，但我不能确定。

如果需要更多信息，我可以免费提供！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T16:10:55.730

我最近遇到了这个问题，这是一个已知问题。有关 SharePoint 不允许多次回发的问题。请查看以下链接，了解此人如何解决此问题。

[http://blogs.msdn.com/b/bspann/archive/2009/06/29/exporting-binary-files-inside-sharepoint-webpart.aspx](http://blogs.msdn.com/b/bspann/archive/2009/06/29/exporting-binary-files-inside-sharepoint-webpart.aspx)

至于我如何解决我的问题，我使用了 DexExpress 控件和一个 ASPxButton 来启动服务器端代码以导出网格。我还在客户端的 onClick 事件中附加了一些 javascript 代码来设置以下变量**_spFormOnSubmitCalled=false;_spSuppressFormOnSubmitWrapper=true;**

```
<dx:ASPxButton runat="server" ID="btnExportGrid" Text="Export Data" AutoPostBack="False" OnClick="btnExportGrid_Click"   >
    <ClientSideEvents Click="function(s, e) {_spFormOnSubmitCalled=false;_spSuppressFormOnSubmitWrapper=true;}" />
</dx:ASPxButton> 
```

我希望这有帮助。

# php - Linux 上的 PHP 随机无法连接到 Microsoft SQL Server 2005

> ID：15501273
> 
> 赞同：1
> 
> 时间：2013-03-19T13:47:04.550
> 
> 标签：php, sql, linux

（不是 Linux 专家！）在过去一个月的工作中，我们遇到了一个我们无法解决的严重问题。从运行 Ubuntu-Linux 的服务器，我们使用 PHP 连接到运行 Microsoft SQL Server 2005 的服务器。这已经运行了很长时间没有问题。在 2013 年 2 月开始时，我们将 SQL Server 机器移动到与 Linux 机器相同的核心网络中，这涉及更改运行 SQL Server 2005 的 Windows 服务器上的 IP 地址。

在此操作之后，我们遇到了从这台特定的 Linux 机器连接到 SQL Server 的问题。也许 1000 个连接中有一个失败并显示以下错误消息：

> PHP 警告：mssql_connect()：无法连接到服务器

我不知道这两个服务器中的任何一个有任何其他更改。我们试图审视“一切”。

*   免费TDS
*   php.ini 调整
*   SQL Server 配置管理器中的 IP 地址
*   SQL Server 中无限数量的并发连接
*   网络和防火墙问题（24 小时内没有丢包）

关于我们如何寻求错误搜索这个问题的任何建议？任何人都想了解有关此设置的更多信息吗？这对我们来说有点严重，因为我们的许多 cronjobs 由于这个随机连接问题而无法正常执行。

Rgds，斯文大卫，挪威

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:56:08.370

从外部角度很难诊断，但是感觉像是网络问题而不是 php/sql 配置。据推测，因为它是间歇性的，它不是 mssql 函数/扩展。**很少是真正随机的！**

也许可以通过编写一个脚本来监控服务器（两个主机）的重要统计信息——比如心跳：IP、DNS、DHCP？、请求等，并将其设置为记录异常/在任一主机或连接请求上发生任何元素更改时向您发出警报失败...

可能也值得在其他 SE 网站上发布——不仅仅是 Stackoverflow。

# ruby - 创建/编辑 Vagrant 基本框以预安装说明书

> ID：15501279
> 
> 赞同：3
> 
> 时间：2013-03-19T13:47:17.923
> 
> 标签：ruby, chef-infra, virtual-machine, vagrant

我的 VM 需要大约 10 分钟才能启动，因为它需要安装所有说明书。

我正在寻找一种方法来编辑现有的（或创建新的）基本框，我可以在其中安装所有必需的食谱。所以每次我启动我的虚拟机时，食谱已经安装好了，我不必等待太久。

这可能吗？

如果是这样，有人可以指出我正确的方向吗？

我目前正在使用 Lucid32 基础盒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T09:55:00.417

听起来你需要调整你的基础盒子，所以将你需要的所有东西安装在一个流浪盒子中，并将这个盒子导出为你的新基础盒子：

```
vagrant halt; vagrant package; vagrant box add new_basebox package.box 
```

有关包装的更多详细信息，请参见[此处，尤其是。](http://docs.vagrantup.com/v1/docs/base_boxes.html)最后一节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T10:44:41.043

在 Vagrant v2 中，可以使用以下命令打包 VM

```
vagrant package 
```

# c++ - Boost Program_options 配置文件注释

> ID：15501282
> 
> 赞同：7
> 
> 时间：2013-03-19T13:47:27.060
> 
> 标签：c++, boost-program-options

我有一个程序，它使用 boost::program_options 从配置文件中读取大量变量。配置文件正在工作并读取值，但是由于文件中有很多选项，我想将它们记录在适当的位置。例如，我希望配置文件看起来像：

```
# Here is a description of flag1
#    flag1 = true means blah blah blah
#    flag1 = false means ...
flag1=true
# Here is a description of flag 2
.
.
. 
```

问题是我在任何地方都找不到描述这样做的方法的文档。我相当确定我可以使用诸如`a=`注释分隔符之类的东西，并简单地将所有注释分配给 a`std::vector<string>`以在解析后丢弃，但是我想知道是否有更合适的方法来处理 a 中的注释行配置文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-19T14:34:50.793

的文档`program_options`真的很糟糕。

事实上，它已经支持以“#”开头的注释行。它抛出了这些行。你不需要做任何事情来完成这项工作，它是隐含地完成的。它不适用于'//'等。

# java - 在 lucene 索引中存储和检索 Json 对象

> ID：15501285
> 
> 赞同：7
> 
> 时间：2013-03-19T13:47:29.470
> 
> 标签：java, elasticsearch, lucene

我已经将一组 json 对象存储到 lucene 索引中，并且还想从索引中检索它。我正在使用 lucene-3.4。

那么是否有任何库或简单的机制可以在 lucene 中实现这一点。

示例：Json 对象

```
{
    BOOKNAME1: {
        id:1,
        name:"bname1",
        price:"p1"
    },
    BOOKNAME2: {
        id:2,
        name:"bname2",
        price:"p2"
    },
    BOOKNAME3: {
        id:3,
        name:"bname3",
        price:"p3"
    }
} 
```

任何形式的帮助将不胜感激。提前致谢，

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-07-24T08:48:56.313

我建议您通过以下方式索引您的 json 对象：

1）解析你的json文件。我通常使用[json simple](http://code.google.com/p/json-simple/)。

2) 使用 IndexWriterConfig 打开一个索引

3) 将文档添加到索引中。

4) 提交更改并关闭索引

5）运行您的查询

如果您想使用 Lucene Core 而不是 elasticsearch，我创建了一个示例项目，该项目将包含 JSON 对象的文件作为输入并创建一个索引。另外，我添加了一个测试来查询索引。

我使用的是最新的 Lucene 版本（4.8），请看这里：

[http://ignaciosuay.com/getting-started-with-lucene-and-json-indexing/](http://ignaciosuay.com/getting-started-with-lucene-and-json-indexing/)

如果有时间，我觉得值得一读《Lucene in Action》。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T09:33:38.333

如果您不想在 json 中搜索而只存储它，您只需要提取 id，希望它是唯一的。那么你的 lucene 文档将有两个字段：

*   id（索引，不一定存储）
*   json本身，原样（仅存储）

一旦您将 json 存储在 lucene 中，您就可以通过 id 过滤来检索它。

另一方面，这几乎就是[elasticsearch](http://www.elasticsearch.org/)对您的文档所做的事情。您只需通过 REST api 向它发送一些 json。elasticsearch 将保持 json 原样，并使其默认可搜索。这意味着您可以通过 id 检索 json 或对其进行搜索，开箱即用，无需编写任何代码。

此外，使用 lucene 在您提交文档或重新打开索引阅读器之前，您的文档将不可用，而 elasticsearch 为其添加了一个方便的事务日志，因此[GET](http://www.elasticsearch.org/guide/reference/api/get.html)始终是实时的。

此外，elasticsearch 还提供了更多：一个不错的分布式基础架构、分面、脚本等等。看看这个！

# android - 通过 Python 从 Android 获取设备/型号信息

> ID：15501286
> 
> 赞同：4
> 
> 时间：2013-03-19T13:47:32.777
> 
> 标签：android, python

美好的一天！

希望你们中的一位大师可以帮助我解决这个问题。

我目前正在用 Python 编写一个应用程序，它从他们的网站上提取设备手册并创建一个用户手册快捷方式以供启动。

到目前为止一切顺利，但从长远来看，我想将其设置为从 Android 操作系统中提取制造商/型号并根据具体型号进行搜索。

问题？我一辈子都找不到任何可以从系统中提取此类信息的 Pythonic？通过搜索谷歌，我发现在本地语言中，他们可以访问 android.os.Build 以获取此类信息，但我不知道如何通过 Python 访问它？

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T01:47:00.790

如果这还不能通过 SL4A Facade API 获得，您可以使用 shell 命令`getprop`检索实际存储在文件中的设备/型号信息`/system/build.prop`，您对**ro.product.manufacturer**和**ro.product.model**属性感兴趣：

```
[ro.product.manufacturer]: [samsung]
[ro.product.model]: [GT-I9100] 
```

有关如何从 Python 运行 shell 命令，请查看此问答：

[从 python 运行 shell 命令并捕获输出](https://stackoverflow.com/questions/4760215/running-shell-command-from-python-and-capturing-the-output)

希望这可以帮助。

# java - 带有枚举的 switch case 导致重复

> ID：15501287
> 
> 赞同：0
> 
> 时间：2013-03-19T13:47:32.950
> 
> 标签：java, switch-statement

当我使用 for-each 循环和 switch 语句迭代一个简单的 Enum 测试器以输出枚举值时，我看到的行为对我来说似乎很奇怪。

代码：

```
public class EnumTest {

    private Number number;

    public EnumTest(Number number) {
        this.number = number;
    }
    public enum Number {
        ONE,
        TWO,
        THREE,
        FOUR,
        FIVE;
    }
    private void tellItLikeItIs() { 
        switch (number) {   
            case ONE:
                System.out.println("ONE");
            case TWO:
                System.out.println("TWO");
            case THREE:
                System.out.println("THREE");
            case FOUR:
                System.out.println("FOUR");
            case FIVE:
                System.out.println("FIVE"); 
        }
    }
    public static void main(String[] args) {    
        for (Number n : Number.values()) {
            EnumTest et = new EnumTest(n);
            et.tellItLikeItIs();
            System.out.println();
        }
    }
} 
```

输出：

```
 ONE
    TWO
    THREE
    FOUR
    FIVE

    TWO
    THREE
    FOUR
    FIVE

    THREE
    FOUR
    FIVE

    FOUR
    FIVE

    FIVE 
```

为什么每个调用都返回自身和所有后续值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T13:48:45.897

那是因为你忘记了`break;`陈述...

```
private void tellItLikeItIs() { 
        switch (number) {   
            case ONE:
                System.out.println("ONE");
                break;
            case TWO:
                System.out.println("TWO");
                break;
            case THREE:
                System.out.println("THREE");
                break;
            case FOUR:
                System.out.println("FOUR");
                break;
            case FIVE:
                System.out.println("FIVE"); 
                break;
        }
    } 
```

[在此处](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)阅读有关 switch 语句的更多信息：

> 没有它们，switch 块中的语句就会落空：匹配的 case 标签之后的所有语句都按顺序执行，而不管后续 case 标签的表达式，直到遇到 break 语句

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:55:02.927

为什么不直接使用 Enum.name() 或 Enum.toString() 方法，如下所示：

```
 private void tellItLikeItIs() {
     System.out.println(number.name());
    } 
```

或者

```
 private void tellItLikeItIs() {
    System.out.println(number);
    } 
```

# android - 如何拍摄带有 .png 图像的照片

> ID：15501291
> 
> 赞同：1
> 
> 时间：2013-03-19T13:47:44.590
> 
> 标签：android, camera, png, surfaceview

我创建了一个相机应用程序，它在相机预览中具有图像。例如，这是一顶帽子的图像，我想拍摄一个人的照片，帽子图像在他的头上。这就是我所做的：

```
 mFrameLayout = new FrameLayout(this);

        mPreview = new Preview(this);
        mFrameLayout.addView(mPreview);

        mImage = new ImageView(this);

        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(100, 100);
        layoutParams.leftMargin = 200;
        layoutParams.topMargin = 100;
        mImage.setLayoutParams(layoutParams);
        mImage.setImageResource(R.drawable.gorro);
        mFrameLayout.addView(mImage);

        mFrameLayout.setOnClickListener(this);

        setContentView(mFrameLayout); 
```

预习班：

```
class Preview extends ViewGroup implements SurfaceHolder.Callback {
    private final String TAG = "Preview";

    SurfaceView mSurfaceView;
    SurfaceHolder mHolder;
    Size mPreviewSize;
    List<Size> mSupportedPreviewSizes;
    Camera mCamera;

    Preview(Context context) {
        super(context);

        mSurfaceView = new SurfaceView(context);
        addView(mSurfaceView);
    } 
```

并且这个类实现了所有的表面方法。当我触摸相机上的任何地方时，就会拍摄照片。这是代码：

```
public void onClick(View arg0) {
        Toast.makeText(this, "Taken!", Toast.LENGTH_LONG).show();
        mCamera.takePicture(null, mPictureCallback, mPictureCallback);
    }

    Camera.PictureCallback mPictureCallback = new Camera.PictureCallback() {
        public void onPictureTaken(byte[] imageData, Camera c) {
            if (imageData != null) {
                String root = Environment.getExternalStorageDirectory()
                        .toString();
                File myDir = new File(root + "/saved_images2");
                myDir.mkdirs();
                Random generator = new Random();
                int n = 10000;
                n = generator.nextInt(n);
                String fname = "Image-" + n + ".jpg";
                File file = new File(myDir, fname);
                if (file.exists())
                    file.delete();
                try {
                    FileOutputStream out = new FileOutputStream(file);
                    out.write(imageData);
                    out.flush();
                    out.close();
                    Log.d("teste", "onPictureTaken - wrote bytes: "
                            + imageData.length);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }; 
```

问题是当我用 .png 图像拍照时，没有它就保存了照片。

拍照时如何保存 .png 图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:50:44.637

您必须在 PictureCallBack 中将您的 imageData 转换为位图，然后使用带有方法 drawBitmap 的 Canvas 将您的帽子位图绘制到从相机捕获的图像上。最后，您可以将结果位图保存到文件中。所以：

```
Bitmap cameraBitmap = BitmapFactory.decodeByteArray(imageData, 0, imageData.length);
Canvas canv = new Canvas(cameraBitmap );
canv.drawBitmap(.... your hat image); 
```

# mysql - 按 `updated_at` 和 `created_at` 排序，即使它们为 NULL

> ID：15501293
> 
> 赞同：2
> 
> 时间：2013-03-19T13:47:55.507
> 
> 标签：mysql, sql, sql-order-by

我有下表：

```
CREATE TABLE `entries` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL,
  `created_at` datetime DEFAULT NULL,
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; 
```

我想按`updated_at`和对条目进行排序`created_at`。

但它们中的任何一个都可能是`NULL`。

我的查询：

```
SELECT *
FROM `entries`
ORDER BY `updated_at` DESC, `created_at` DESC, `id` DESC 
```

但这会将每个尚未更新的条目放在结果的底部。

基本上我需要它们按可用的最后日期排序。如果没有可用于排序的`id`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T14:02:07.597

我相信你想要的是：

```
ORDER BY coalesce(updated_at, created_at) DESC, id DESC 
```

这按更新日期（如果可用）或创建日期（如果不可用）排序。然后它按 id 降序排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:51:34.277

您可以使用 CASE 语句。

```
SELECT *
FROM `entries`
ORDER BY CASE WHEN `updated_at` IS NOT NULL then `updated_at` WHEN `created_at` IS NOT NULL then `created_at` ELSE `id` END DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T13:51:23.693

也许尝试`COALESCE`：

```
SELECT *
FROM `entries`
ORDER BY COALESCE(updated_at, created_at, id) DESC 
```

这不一定*完全*符合您的要求，但它可能会朝着您想要的方向发展。如果不正确，您可以发布您想要的示例吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T13:54:20.243

我不完全明白你想要什么，但你可以试试这个：

```
SELECT *
FROM `entries`
ORDER BY IFNULL(`updated_at`,`created_at`) DESC, `id` DESC 
```

如果这些日期之一可用，则结果将按日期排序。如果没有可用的日期，则结果将按 id 排序。

注意： IFNULL 在您的 DBMS 上不一定可用，但您可以找到等效的。

# sql - SQL 反透视和插入

> ID：15501296
> 
> 赞同：2
> 
> 时间：2013-03-19T13:48:14.833
> 
> 标签：sql, sql-server

抱歉缺少信息——SQL Server 2008。

我正在努力将表 A 中的几个列值放入表 B 中的新行中，以获取 A 中列不为空的每一行。

表A的结构如下：

```
UserID | ClientUserID | ClientSessionID | [and a load of other irrelevant columns) 
```

表 B：

```
UserID | Name | Value 
```

我想在表 B 中为 A 中的每个非空 ClientUserID 或 ClientSessionID 创建行 - 使用列名作为 B 的“名称”，列值作为“B 的值”。

我正在努力编写我的“unpivot”语句 - 只是让语法正确！我正在尝试跟随一些样本，但不能

到目前为止，这是我的 SQL 查询 - 任何进一步的帮助将不胜感激（只是得到这个 SELECT 让我感到沮丧，更不用说插入了！）

```
SELECT UserID, ClientUserID, ClientSessionID FROM websiteuser WHERE ClientSessionID IS NOT null 
```

这为我提供了我需要对其执行操作的行——但我只是无法获得正确的语法来对这些数据进行 UNPIVOTing 并将其转换为我的插入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:01:05.417

您可以通过使用 UNION 获取每个新行来以这种方式取消透视记录：

```
INSERT INTO TableB (UserID, Name, Value)
SELECT UserID, 'ClientUserID' AS Name, ClientUserID AS Value
FROM TableA
WHERE ClientUserID IS NOT NULL
UNION ALL
SELECT UserID, 'ClientSessionID' AS Name, ClientSessionID AS Value
FROM TableA
WHERE ClientSessionID IS NOT NULL 
```

`UNION ALL`在这种情况下，我使用的是对整个集合`UNION`的操作，这在旋转唯一记录时通常是不必要的。`DISTINCT`

如果您的 ClientUserID 和 ClientSessionID 列不是相同的数据类型，您可能必须将一个或两个强制转换为相同的。

# c# - C#：工作簿另存为，其中包含宏

> ID：15501297
> 
> 赞同：0
> 
> 时间：2013-03-19T13:48:21.960
> 
> 标签：c#, excel, windows-server-2008-r2

下面是我复制工作表并将其保存为新文件的代码，它实际上在我的本地没有宏保存，我们的环境为 Office 2003，Windows Server 2003

但是在服务器中它用宏保存，我不想要环境是 Office 2003，Windows Server 2008

C＃：

```
try
            {
                wBook = xCel.Workbooks.Open(ExcelPath);                
                wSheet = (Excel.Worksheet)wBook.Worksheets.get_Item(1);                    
                wSheet.Copy(Type.Missing, Type.Missing);                    
                wSheet = (Excel.Worksheet)wBook.Sheets[1];
                wSheet.SaveAs(ExcelCopyPath);
             }

            catch {}
            finally
            {                
                if (wBook != null)
                {                    
                    wBook.Close();
                    wSheet = null;
                    wBook = null;
                    Thread.Sleep(500);
                }
                if (Excel.ProcessID > 0)
                 {

                    Process pxCel = Process.GetProcessById(Excel.ProcessID);
                    pxCel.Kill();
                 }

                GC.Collect();
                GC.WaitForPendingFinalizers();
                GC.Collect();
                GC.WaitForPendingFinalizers();                
                try { Marshal.FinalReleaseComObject(wSheet);}
                catch {}                                        
                try { Marshal.FinalReleaseComObject(wBook);}
                catch {}                
            } 
```

请检查我的问题...并提出一些答案。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:26:18.613

像这样记录您的异常：

```
try
{
    wBook = xCel.Workbooks.Open(ExcelPath);                
    wSheet = (Excel.Worksheet)wBook.Worksheets.get_Item(1);                    
    wSheet.Copy(Type.Missing, Type.Missing);                    
    wSheet = (Excel.Worksheet)wBook.Sheets[1];
    wSheet.SaveAs(ExcelCopyPath);
 }

catch(Exception ex) 
{
    using(var sw = new StreamWriter(@"C:\temp\mylog.txt", true))
    {
        sw.WriteLine("First catch block");
        sw.WriteLine(ex.Message);
    }
}
finally
{                
    if (wBook != null)
    {                    
        wBook.Close();
        wSheet = null;
        wBook = null;
        Thread.Sleep(500);
    }
    if (Excel.ProcessID > 0)
     {

        Process pxCel = Process.GetProcessById(Excel.ProcessID);
        pxCel.Kill();
     }

    GC.Collect();
    GC.WaitForPendingFinalizers();
    GC.Collect();
    GC.WaitForPendingFinalizers();                
    try { Marshal.FinalReleaseComObject(wSheet);}
catch(Exception ex) 
{
    using(var sw = new StreamWriter(@"C:\temp\mylog.txt", true))
    {
        sw.WriteLine("Second catch block");
        sw.WriteLine(ex.Message);
    }
}                                     
    try { Marshal.FinalReleaseComObject(wBook);}
catch(Exception ex) 
{
    using(var sw = new StreamWriter(@"C:\temp\mylog.txt", true))
    {
        sw.WriteLine("Third catch block");
        sw.WriteLine(ex.Message);
    }
}              
} 
```

你真的应该使用像 NLog 这样的日志框架，但这应该在短期内帮助你。这不会解决您的问题，但至少现在您将能够打开`C:\temp\mylog.txt`并查看问题所在，这将帮助您诊断问题。使用空的 catch 块，您将永远无法解决问题，因为您永远无法弄清楚出了什么问题。

# perl - 使用 Perl Imager 库缩放字体

> ID：15501299
> 
> 赞同：3
> 
> 时间：2013-03-19T13:48:24.150
> 
> 标签：perl, fonts, scaling

我正在编写一个脚本，将 Imager 和 Imager::Font 与 ft2 库一起使用。该脚本尝试确定以给定字体呈现的字符串是否会超过图像的宽度，如果是，则缩小字体以使其适合图像。然而，它并没有像我预期的那样工作。测试脚本显示在下面，以便您可以尝试自己复制结果。最终发生的情况是，按比例缩小字体中的字符串似乎占据了与原始字体大致相同的宽度，并且从左侧大致相同的点开始。这意味着随着它变小，字符串会从图像的左侧进一步移动，直到它完全不可见。

关于如何解决这个问题的任何建议？

谢谢，

彼得

下面的脚本：

```
#!/usr/local/bin/perl

# imager_scaling_test
#
# This is a script designed to test whether we can
# dynamically scale a font down so that it fits within
# the width of an image. This is designed to be run
# under mod_perl and viewed in a web browser.
#
# Test examples:
#
# This works fine:
# imager_scaling_test?string=TEST
#
# This produces output that goes partially outside of the box
# imager_scaling_test?string=TESTTTTTTTTTTTTT
#
# This produces output that is completely outside of the box
# imager_scaling_test?string=TESTTTTTTTTTTTTTTTTTTTTTTTTTTT

use strict;
use Apache;
use CGI;
use Imager;
use Imager::Font;

my $r = Apache->request;
my $q = CGI->new();

# Some variables to control our test
my $string       = $q->param( 'string' ) || 'TEST';
my $image_width  = 400;
my $image_height = 400;
my $font_size    = 70;
my $font_file    = 'your_font.ttf';

# Create a basic imager object to work in
my $image = Imager->new( xsize => $image_width, ysize => $image_height );

# Create a box on the image
$image->box(
    xmin   => 0,
    xmin   => 0,
    xmax   => $image_width - 1,
    ymax   => $image_height - 1,
    filled => 1,
    color  => 'blue'
);

# Set up the font
my $font = Imager::Font->new( file => $font_file, size => $font_size );

# Find out how wide our test string would be in this font
my $bbox1 = $font->bounding_box( string => $string );
my $initial_width = $bbox1->display_width();
$r->log_error( "Initial width:$initial_width" );

# Find out whether the test string is wider than the image
if ( $initial_width > $image_width ) {

    # Find the difference between the string width and the image width
    my $difference = $initial_width - $image_width;

    # Find the percentage the image width is of the initial width
    my $percentage = $image_width / $initial_width;

    # Set up a scaling matrix to scale the font
    my $scaling_matrix = [ $percentage, 0, 0, 0, $percentage, 0 ];
    $font->transform( matrix => $scaling_matrix );
    my $bbox2 = $font->bounding_box( string => $string );
    my $scaled_width = $bbox2->display_width();
    $r->log_error( "Scaled width:$scaled_width" );
}

# Place the string on the image
$image->align_string(
    valign => 'center',
    halign => 'center',
    font   => $font,
    x      => $image->getwidth / 2,
    y      => $image->getheight / 2,
    text   => $string,
);

# Print the image out to the browser.
my $output;
$image->write( type => 'jpeg', data => \$output );
binmode STDOUT;
$r->content_type( "image/jpeg" );
$r->send_http_header;
$r->print( $output ); 
```

# c++ - 在 C++11 中绑定函数参数

> ID：15501301
> 
> 赞同：7
> 
> 时间：2013-03-19T13:48:40.290
> 
> 标签：c++, templates, c++11, variadic-templates

我想一般地“腌制”函数调用，以便以后执行它们。这些函数的返回类型将始终是`void`（目前）。像这样的东西：

```
template<typename F, typename... Args>
std::function<void()> 
pickle(F function, Args&&... args) {
    return std::bind(F, args...);
} 
```

问题是，如果`args`包含 const 引用，`std::bind`则尝试复制构造该值，如果该类型缺少复制构造函数，这并不总是理想的，甚至是无效的。如何以`std::ref`用于左值引用和正常`std::forward`用于左值引用的方式转发参数？

### 例子

```
#include <functional>

class NonCopyable {
public:

    NonCopyable() {}

    NonCopyable(const NonCopyable&) = delete;
};

template<typename F, typename... Args>
std::function<void()>
pickle(F function, Args&&... args)
{
    return std::bind(function, std::forward<Args>(args)...);
}

int main()
{
    NonCopyable obj;
    auto f = pickle(
        [](const NonCopyable&) {},
        obj
    );
    return 0;
} 
```

上面的代码片段不会编译，抱怨删除的复制构造函数。（我在这里使用 forward 是因为有人建议它，但似乎已经删除了他们的答案）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T14:04:55.830

超载，呵呵。

```
// also does the correct thing for `T const`
template<class T>
std::reference_wrapper<T> maybe_ref(T& v, int){ return std::ref(v); }

// just forward rvalues along
template<class T>
T&& maybe_ref(T&& v, long){ return std::forward<T>(v); }

template<typename F, typename... Args>
std::function<void()> 
pickle(F function, Args&&... args) {
    return std::bind(function, maybe_ref(std::forward<Args>(args), 0)...);
} 
```

`int`/`long`参数和参数消除了编译器发现重载不明确的左值大小写的`0`歧义，否则不会造成任何伤害。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:10:07.367

这有点难看（过度使用`enable_if`），但它有效：

```
template<typename T> typename std::enable_if<
  !std::is_lvalue_reference<T>::value, T &&>::type
  forward_as_ref(typename std::remove_reference<T>::type &t) {
    return static_cast<T &&>(t);
  }
template<typename T> typename std::enable_if<
  !std::is_lvalue_reference<T>::value, T &&>::type
  forward_as_ref(typename std::remove_reference<T>::type &&t) {
    return t;
  }
template<typename T> typename std::enable_if<
  std::is_lvalue_reference<T>::value,
  std::reference_wrapper<typename std::remove_reference<T>::type>>::type
  forward_as_ref(T t) {
    return t;
  } 
```

这是一个使用类模板专业化的版本：

```
template<typename T> struct forward_as_ref_type {
   typedef T &&type;
};
template<typename T> struct forward_as_ref_type<T &> {
   typedef std::reference_wrapper<T> type;
};

template<typename T> typename forward_as_ref_type<T>::type forward_as_ref(
   typename std::remove_reference<T>::type &t) {
      return static_cast<typename forward_as_ref_type<T>::type>(t);
   }
template<typename T> T &&forward_as_ref(
   typename std::remove_reference<T>::type &&t) {
      return t;
   } 
```

# jquery - jQuery.ScrollTo onAfter 设置无法正常工作

> ID：15501304
> 
> 赞同：2
> 
> 时间：2013-03-19T13:48:46.317
> 
> 标签：jquery, scroll

我使用`jQuery.ScrollTo`脚本能够垂直滚动到所选图像（如果容器类“演示文稿”不在这里）或到下一张图片并将其显示在屏幕中间。

注意：我创建了两个状态。当用户单击任何图片时，我将“演示文稿”类添加到`container div`关闭所有图片中。所以我会知道是否必须显示所选图像或下一个图像。

当用户在页面内滚动时，此模式将停止。为此，我正在使用该`$(window).scroll`事件。

这是我的问题：在图片上单击事件后，有时，我的`$(window).scroll`事件删除了我的班级“演示文稿”，但我不知道如何修复它。

这是演示：http: [//jsfiddle.net/qnQSP/8/](http://jsfiddle.net/qnQSP/8/)

我在做什么：如您所见，我想创建两种状态：“演示模式”和“无演示模式”。当我们通过将全局类添加到我的容器“#galleries”来单击项目时，我将激活演示模式。

使用此类“打开”，我可以确定是否必须显示当前图像或滚动到下一个图像。

为了演示模式，我编写了“$(window).scroll”函数。当我们在页面内滚动时，此功能会退出演示模式。

但是，当我在演示模式下使用 .scrollTo 函数时，我总是因为“$(window).scroll”函数而退出此模式。所以，我有全局变量“presentation_mode_stop_scrolling”来阻止它。

有时在我的 scrollTo 函数之后调用一次“$(window).scroll”函数，无法解决它。

这是我的代码：

HTML：

```
<div id="galleries">

<div id="pictures-content" class="1"><img src="http://www.sb-designs.co.uk/ckfinder/userfiles/images/free%20web%20hosting.jpg"></div>

<div id="pictures-content" class="2"><img src="http://www.mastercreations.net/wp-content/uploads/2012/10/5.jpg"></div>

<div id="pictures-content" class="3"><img src="http://www.sb-designs.co.uk/ckfinder/userfiles/images/free%20web%20hosting.jpg"></div>

<div id="pictures-content" class="4"><img src="http://www.webdesign4essex.co.uk/images/essex_website_design.jpg"></div>

<div id="pictures-content" class="5"><img src="http://www.mastercreations.net/wp-content/uploads/2012/10/5.jpg"></div> 
```

jQuery

```
$(window).scroll(function () {

  if(presentation_mode_stop_scrolling=="off")
  {
      $("#galleries").removeClass("picture_presentation");
  }

});

    var picture_to_center_class = "";   
    var picture_to_center="";

    $("#galleries #pictures-content").unbind("click");
    $("#galleries #pictures-content").bind("click", function(event) {
        // Check if we are in the presentation mode
        var class_galleries = $("#galleries").attr('class');
        if(class_galleries == "picture_presentation")
        {
            console.log("Presenation mode");
            var new_picture = parseInt(picture_to_center_class)+1;

            // Stopping the scroll event to cancelled the presentation mode
            presentation_mode_stop_scrolling="on";

            //scrolling to the next one
            var picture_to_center = $("#galleries ."+new_picture);      
            $("body").scrollTo(picture_to_center, 800, {onAfter:function(){ presentation_mode_stop_scrolling="off";      console.log("galleries class: "+$("#galleries").attr('class'));} });
        }
        else
        {
            console.log("Not presenation mode");
            // We are adding the presentation mode to the DOM 
            $("#galleries").addClass("picture_presentation");

            // Get the binding element class number 
            picture_to_center_class = $(this).attr('class');
            console.log("picture_to_center: "+picture_to_center_class);

            picture_to_center = $("#galleries ."+picture_to_center_class);

             // Stoping the (windows).scroll to removed the galleries class 
            presentation_mode_stop_scrolling="on";
            $("body").scrollTo(picture_to_center, 800, {onAfter:function(){ presentation_mode_stop_scrolling="off";      console.log("galleries class: "+$("#galleries").attr('class'));} });
         }
    }); 
```

# mysql - 如何查找所有没有自动增量的主键

> ID：15501307
> 
> 赞同：3
> 
> 时间：2013-03-19T13:48:54.747
> 
> 标签：mysql

如何在数据库中的所有表中查找所有主键，这些表没有自动增量标识符。我们有大量的表，并且想识别所有在主键上没有自动增量标识符的表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T13:56:07.740

`information_schema.columns`您可以从表中提取此信息

```
select distinct table_name
from information_schema.columns
where table_schema = 'DATABASENAME'
      and table_name not in (select table_name
                             from information_schema.columns
                             where table_schema = 'DATABASENAME'
                                   and column_key = 'PRI'
                                   and data_type = 'int'
                                   and extra = 'auto_increment') 
```

这将查找一个数据库中具有一`auto_increment`列的所有表，然后返回剩余的表。这也可以正确检测具有复合键的表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T13:59:44.277

您可以在表格中找到此类信息`information_schema.columns`。如果自动递增，该列`column_key`将是`PRI`并且该列`extra`将包含。`auto_increment`

```
SELECT
    table_schema,
    table_name,
    column_name
FROM
    information_schema.columns
WHERE
    column_key = 'PRI'
    AND extra <> 'auto_increment'
    AND data_type = 'int' 
```

在[此 SQL Fiddle](http://sqlfiddle.com/#!2/32f6d/1/0)中，您可以看到示例表在各自的列中具有“PRI”和“auto_increment”。

# java - 为什么 WebLogic 无法识别第三方 jar

> ID：15501313
> 
> 赞同：1
> 
> 时间：2013-03-19T13:49:11.353
> 
> 标签：java, weblogic

我正在 WebLogic 中部署一个战争文件。在 Tomcat 中部署并成功运行了相同的 war 文件。但是当我尝试在 WebLogic 服务器中运行这个 war 文件时，第三方 jar API 没有被识别。我已经在网上搜索并得到了以下解决方案，但它仍然没有用。

我在 weblogic.xml 文件中添加了以下代码

```
 <container-descriptor>
<prefer-web-inf-classes>true</prefer-web-inf-classes>
 </container-descriptor> 
```

# qt - 未启用 qtcreator 示例

> ID：15501318
> 
> 赞同：3
> 
> 时间：2013-03-19T13:49:20.030
> 
> 标签：qt, qt-creator

我在 Ubuntu 11.10 上安装了 qtcreator

```
sudo apt-get install qtcreator 
```

安装的版本是：QT Creator 2.2.1、QT 4.7.3

当我启动 qtcreator 以探索 QT C++ 示例时，该按钮显示为灰色/禁用，并且显示未安装示例。

qtdemo 也不显示任何演示/文档吗？

我必须单独安装示例，文档吗？如果是，如何？

如何启用 qtcreator 中的示例和 qtdemo 中的文档？

**编辑：针对@Murtuza Kabul 下面的一个答案，我尝试了很多方法来指出 qtcreator 来纠正 qt 但不能。所以我确实卸载了qtcreator和qt-sdk并重新安装了qt-sdk。所以现在 qtcreator 是 qt-sdk 附带的。它仍然说未安装示例。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-18T16:09:21.487

我`Qt 5.1`直接从[qt-project.org](https://qt-project.org/downloads)下载并在 Linux Mint 12（基于 Ubuntu）上以管理员身份（使用 sudo）安装。

如果我`qtcreator`以普通用户身份开始，我没有示例，但如果`qtcreator`以管理员身份（使用 sudo）开始，我有所有示例。

我的问题是`examples`文件夹特权。它是`read/execute`所有用户唯一没有特权的文件夹 ( `/opt/Qt5.1.0/5.1.0/gcc/examples`)。内部（和外部）的所有其他文件夹`examples`对所有用户都有特权。

**编辑：**

我忘了说——正如[HostileFork](https://stackoverflow.com/users/211160/hostilefork)在评论中提到的——`sudo chown -R +rx /opt/Qt/5.1.0/gcc/examples`是解决这个问题的方法。

**编辑：**

正如 Climax 所指出的 - 它应该`chmod`代替`chown`

`sudo chmod -R +rx /opt/Qt/5.1.0/gcc/examples`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-06T12:49:30.887

Install the qt4-demos package.

```
sudo apt-get install qt4-demos 
```

I found the sample code installed in `/usr/lib/qt4/demos/`. Also the qtdemo program was installed at `/usr/lib/x86_64-linux-gnu/qt4/bin/qtdemo`.

It seems only a limited set of examples are installed by this package.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T13:53:45.947

![在此处输入图像描述](../Images/2b0919e46ff5419c24ce1f8addfc2ce7.png)您还需要安装 qtsdk。它带有运行 qt 项目所需的示例和二进制文件。如果您安装 sdk，它将为您提供更新 sdk 和安装/卸载 sdk 不同部分的界面，您可以选择是否要安装示例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-01T02:34:40.527

我在 Windows 7 上遇到了同样的问题。我是如何解决这个问题的：

*   我打开 QT Creator。
*   我选择菜单选项[工具]
*   从那里我选择[选项...]
*   从那里我选择左侧的 [Kits] 选项
*   我选择标签 [QT 版本]
*   我单击 [添加...] 按钮：添加我正在使用的 QT 版本... ...我看到一个 windows-explorer 屏幕以选择某些内容... ...我转到主目录安装了 QT（在我的情况下：C:\Qt）... ...在资源管理器“搜索”中，我输入**qmake**（不带引号）... ...显示了一个**qmake** EXECUTABLE 文件 -我双击它！... ...我按[应用]，然后按[确定]。

瓦拉 - 它有效！我现在有例子！

# css - 如何将 Google 网络字体转换为组合 CSS

> ID：15501319
> 
> 赞同：2
> 
> 时间：2013-03-19T13:49:25.320
> 
> 标签：css, font-face, webfonts, google-webfonts

我想下载所有格式的谷歌网络字体并创建一个组合 CSS 以在任何地方使用它们，而无需从谷歌服务器加载它们。

我已经有一个下载字体文件的 php 脚本。现在只需要 CSS。

您可能知道 Google web-font API 根据浏览器用户代理提供特殊的 CSS。

我有几个问题。

1.  谷歌网络字体是否真的只为操作系统设备提供一种字体作为 svg，我在测试一些字体时注意到了这一点（使用伪造的用户代理）。而对于其他人来说，有多个`@font-face`声明，但有`font-weight`和`font-style`不同。我是否正确假设 Google 只为“常规”版本的字体而不是“斜体、粗体、书...”提供 SVG
2.  将它们组合成一个 CSS 的最佳方式是什么，尤其是在这种组合的 SVG 字体方面。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-30T16:06:47.333

你是对的，谷歌只为你的特定用户代理提供字体。把它们全部搞定是很棘手的。

您提到您有一个用于获取不同字体格式的 PHP 脚本，因此您可能不需要这两个选项，但无论如何我都会列出它们：

**选项1**

本文介绍了如何下载所有不同格式的过程：

[http://ijotted.blogspot.com/2012/05/download-eot-ttf-woff-formats-of-font.html](http://ijotted.blogspot.com/2012/05/download-eot-ttf-woff-formats-of-font.html)

简而言之，您需要使用用户代理欺骗来获取所有不同的格式。

**选项 2**

另一种选择是获取 TTF 版本（因为这很容易），然后前往[http://www.fontsquirrel.com/tools/webfont-generator](http://www.fontsquirrel.com/tools/webfont-generator)让它们转换/生成所有其他版本。

如果您最终使用此选项，那么知道[Joe Maller 已将完整的下载包放在一起以](http://joemaller.com/1856/download-google-fonts/)一次获取所有 TTF 字体文件可能会很有用（尽管它可能有点过时）。

**使用 CSS 服务**

一旦你有了所有不同的版本，就为你的 CSS 使用类似这样的语法。这是来自[FontSpring 的 Bulletproof Font-Face Syntax](http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax)。

```
@font-face {
font-family: 'MyFontFamily';
src: url('myfont-webfont.eot?#iefix') format('embedded-opentype'), 
     url('myfont-webfont.woff') format('woff'), 
     url('myfont-webfont.ttf')  format('truetype'),
     url('myfont-webfont.svg#svgFontName') format('svg');
} 
```

最后一行当然取决于您是否有 SVG 字体文件。这让我们...

**SVG**

第[一个链接](http://ijotted.blogspot.com/2012/05/download-eot-ttf-woff-formats-of-font.html)声称：

***虽然 Google 确实在运行 4.2 或更低版本的 iOS 设备上提供 SVG 字体格式，但我可以确认 SVG 是空的或损坏的。因此，Google 确实不再支持运行 iOS 4.2 及更低版本的设备。意味着，不再有 SVG 字体格式。***

我无法在其他任何地方验证这一点，但是我看到很多用户抱怨 SVG 问题、字体无法加载……我倾向于忽略 SVG 作为一种选择，并专注于提供 EOT/ WOFF/TTF。这似乎是覆盖你的基地的最可靠的方法。

更新：似乎 fontsquirrel.com 可以生成 SVG 版本。因此，即使 Google 不提供 SVG 作为下载选项，您仍然可以根据需要生成它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T14:03:45.223

可以使用base64编码，但是比普通文件大30%左右（而且不知道每次写东西会不会解析这个url，所以请大家在使用前检查一下）。或者您可以下载一次并将其保存在本地浏览器内存中并使用它而无需下载新版本（但您仍然需要至少下载一次这些文件）。

用IE我帮不了你。但是当您创建新的@font-face 规则时，您可以指定字体粗细。

```
/** #1 **/
@font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: 600;
    src: local('Open Sans Extrabold'),
         local('OpenSans-Extrabold'),
         url(http://themes.googleusercontent.com/static/fonts/opensans/v6/EInbV5DfGHOiMmvb1Xr-hnhCUOGz7vYGh680lGh-uXM.woff)
             format('woff');
}
/** #2 **/
@font-face {
    font-family: 'Open Sans';
    font-style: italic;
    font-weight: 300;
    src: local('Open Sans Light Italic'),
         local('OpenSansLight-Italic'),
         url(http://themes.googleusercontent.com/static/fonts/opensans/v6/PRmiXeptR36kaC0GEAetxh_xHqYgAV9Bl_ZQbYUxnQU.woff)
             format('woff');
}

.a {
    font-family: 'Open Sans';
    font-weight: 300; /** #2 used for <= 500 cos font-weights are 300 and 600 **/
}

.b {
    font-family: 'Open Sans';
    font-weight: 800; /** #1 used for >= 600 **/
} 
```

希望它会帮助你。

# android - Android - 如何在 WebView 中叠加图像？

> ID：15501320
> 
> 赞同：0
> 
> 时间：2013-03-19T13:49:28.723
> 
> 标签：android, webview, overlay, zooming, android-image

我正在尝试叠加几个图像[以形成可能缩放的建筑计划]。关键是根据选定的过滤器[员工，设备...]选择每次要平均的图像。

经过研究，我使用 WebView 实现了缩放，但我没有找到一种方法让这个 webview 一次拍摄不同的图像[这可以通过使用 LayerDrawable 的 ImageView 实现]。

有没有办法做到这一点？还是我应该坚持 ImageViews 并找到一种方法来实现 Zoom ？我希望我的问题很清楚而且不要太愚蠢，因为我只是一个初学者:)。

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:39:25.343

虽然您可以将多个 ImageView 堆叠在一起，但如果您想使其高效且功能丰富（pinch zoom、panning），您需要基于 View 或基于[SurfaceView](https://developer.android.com/reference/android/view/SurfaceView.html)创建自己的组件。

我个人认为 SurfaceView 在这里有点过分，子类化简单视图就足够了。您需要在视图的 onDraw() 方法上从画布上的位图手动绘制图层。

然后，您可以使用 GestureDetector 或 ScaleGestureDetector 通过仿射变换缩放画布来添加缩放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:53:15.317

使用 a`RelativeLayout`作为初学者。

您可以将`ViewGroup.addView(View child, int index, ViewGroup.LayoutParams params)`or 变体与`ViewGroup.removeView(View view)`or一起使用`ViewGroup.removeViewAt(int index)`。

这显然需要您手动使用膨胀视图，`LayoutInflater`但您可以在膨胀后保留对每个视图的全局引用，并在两者之间翻转

# php - 如何检查 WordPress 中是否启用了 XML-RPC

> ID：15501321
> 
> 赞同：8
> 
> 时间：2013-03-19T13:49:31.110
> 
> 标签：php, wordpress, xml-rpc

是否可以检查（通过 php）在 WordPress 中是否启用了 XML-RPC？比如，写一个函数来测试它。

```
if(is_xmlrpc_enabled()) {
   //action
}
else {
   //another action
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T21:27:09.570

默认情况下，对于 WP 版本 > 3.5 启用 XML-RPC（带有允许禁用它的 'xmlrpc_enabled' 挂钩）对于旧版本，数据库中有一个字段（选项表），指示它是否启用。（对于 wp > 3.5，此选项已删除）

```
function is_xmlrpc_enabled() {
    $returnBool = false; 
    $enabled = get_option('enable_xmlrpc'); //for ver<3.5

    if($enabled) {
        $returnBool = true;
    }
    else {
        global $wp_version;
        if (version_compare($wp_version, '3.5', '>=')) {
            $returnBool = true; //its on by default for versions above 3.5
        }
        else {
            $returnBool = false;
        }  
    }
    return $returnBool;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T14:14:28.207

WordPress 在其 XML-RPC 服务器中有两种测试方法：

```
demo.sayHello – Returns a standard “Hello!” message.
demo.addTwoNumbers – Accepts an array containing two numbers and returns the sum.

function sayHello()  
{  
    $params = array();  
    return $this->send_request('demo.sayHello',$params);  
} 

$objXMLRPClientWordPress = new XMLRPClientWordPress("http://localhost/wordpress31/xmlrpc.php" , "username" , "passowrd"); 

function send_request($requestname, $params)  
{  
            $request = xmlrpc_encode_request($requestname, $params);  
            $ch = curl_init();  
            curl_setopt($ch, CURLOPT_POSTFIELDS, $request);  
            curl_setopt($ch, CURLOPT_URL, $this->XMLRPCURL);  
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);  
            curl_setopt($ch, CURLOPT_TIMEOUT, 1);  
            $results = curl_exec($ch);  
            curl_close($ch);  
            return $results;  
} 
```

如果您得到相同的结果，则意味着您能够正确地将请求发送到您的 WordPress XML-RPC 服务器并正确接收请求。

# c++ - 迭代可变参数模板的类型参数

> ID：15501322
> 
> 赞同：20
> 
> 时间：2013-03-19T13:49:35.240
> 
> 标签：c++, templates, variadic-templates

我有一个这样的函数模板：

```
template <class ...A>
do_something()
{
  // i'd like to do something to each A::var, where var has static storage
} 
```

我不能用`Boost.MPL`。你能告诉我如何在没有递归的情况下做到这一点吗？

编辑：这些天（c ++ 17），我会这样做：

```
template <class ...A>
do_something()
{
  ((std::cout << A::var << std::endl), ...);
}; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-19T14:18:50.790

谢[欧说](https://stackoverflow.com/questions/15501322/iterating-over-variadic-templates-type-parameters#comment21948641_15501322)的。为了创建包扩展的上下文，我使用了一个什么都不做的函数的参数列表 ( `dummy`)：

```
#include <iostream>
#include <initializer_list>

template<class...A>
void dummy(A&&...)
{
}

template <class ...A>
void do_something()
{
    dummy( (A::var = 1)... ); // set each var to 1

    // alternatively, we can use a lambda:

    [](...){ }((A::var = 1)...);

    // or std::initializer list, with guaranteed left-to-right
    // order of evaluation and associated side effects

    auto list = {(A::var = 1)...};
}

struct S1 { static int var; }; int S1::var = 0;
struct S2 { static int var; }; int S2::var = 0;
struct S3 { static int var; }; int S3::var = 0;

int main()
{
    do_something<S1,S2,S3>();
    std::cout << S1::var << S2::var << S3::var;
} 
```

该程序打印`111`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-19T14:52:15.277

例如，假设您要显示每个 A::var。正如下面的代码所示，我看到了三种方法来实现这一点。

关于选项 2，请注意标准未指定处理元素的顺序。

```
#include <iostream>
#include <initializer_list>

template <int i>
struct Int {
    static const int var = i;
};

template <typename T>
void do_something(std::initializer_list<T> list) {
    for (auto i : list)
        std::cout << i << std::endl;
}

template <class... A>
void expand(A&&...) {
}

template <class... A>
void do_something() {

    // 1st option:
    do_something({ A::var... });

    // 2nd option:
    expand((std::cout << A::var << std::endl)...);

    // 3rd option:
    {
        int x[] = { (std::cout << A::var << std::endl, 0)... };
        (void) x;
    }
}

int main() {
    do_something<Int<1>, Int<2>, Int<3>>();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-25T18:34:30.007

上面的答案是可行的——在这里，我将更多地探讨如何将 lambda 用于复杂的用例。

Lambda 101: **[** `capture` **](** `params` **){** `code` **}(** `args to call "in-place"` **);**

如果您想使用可变参数模板扩展 lambda，那么当参数是非平凡类型时，它不会像上面提到的那样工作：
`error: cannot pass object of non-trivial type 'Foo' through variadic method; call will abort at runtime`.

要走的路是将代码从 lambda 移动`args`到`code`：

```
template <class ...A>
do_something() {
  Foo foo;
  [&](auto&& ...var){
    (foo.DoSomething(var), ...);
  }(A::var...);
} 
```

# backbone.js - Backbone.js 新手 - 无法触发模型错误事件

> ID：15501324
> 
> 赞同：1
> 
> 时间：2013-03-19T13:49:41.577
> 
> 标签：backbone.js

我第一次看backbone.js。我目前正在查看模型验证，但是我直接从教学文本中获取的这个测试脚本没有按预期触发错误事件。

```
Person = Backbone.Model.extend({
    // If you return a string from the validate function,
    // Backbone will throw an error
    validate: function(attributes) {
        if (attributes.age < 0 && attributes.name != "Dr Manhatten") {
            return "You can't be negative years old";
        }
    },
    initialize: function() {
        alert("Welcome to this world");
        this.bind("error", function(model, error) {
            // We have received an error, log it, alert it or forget it :)
            alert(error);
        });
    }
});

var person = new Person;
person.set({ name: "Mary Poppins", age: -1 });
// Will trigger an alert outputting the error

var person = new Person;
person.set({ name: "Dr Manhatten", age: -1 });
// God have mercy on our souls 
```

我的测试页面非常简单，如下所示：

```
<html>
<body>
    <script type="text/javascript" src="Scripts/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="Scripts/underscore-min.js"></script>
    <script type="text/javascript" src="Scripts/backbone-min.js"></script>
    <script type="text/javascript" src="Scripts/test4.js"></script>
</body>
</html> 
```

我所看到的只是两个“欢迎来到这个世界”警报。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:02:06.153

您的源代码可能基于旧版本的 Backbone，[Model.validate](http://backbonejs.org/#Model-validate)随着时间的推移发生了相当大的变化。

从[更新日志](http://backbonejs.org/#changelog)

> 0.9.10：模型验证现在仅在 Model#save 中默认强制执行，并且在构造或 Model#set 中不再默认强制执行，除非`{validate:true}`通过了该选项。

和

> **validate** *model.validate(attributes, options)*
> 此方法未定义，如果您有任何可以在 JavaScript 中执行的验证逻辑，我们鼓励您使用自定义验证逻辑覆盖它。默认情况下 validate 在保存之前调用，但**如果 {validate:true} 被传递，也可以在设置之前调用**。[...]**验证失败会触发“无效”事件**。

所以 ：

*   要在设置属性时验证您的模型，请使用`validate:true`选项
*   绑定到`invalid`事件
*   并使用[Events.on](http://backbonejs.org/#Events-on)而不是弃用的绑定

您的代码可能如下所示

```
Person = Backbone.Model.extend({
    // If you return a string from the validate function,
    // Backbone will throw an error
    validate: function(attributes) {
        if (attributes.age < 0 && attributes.name != "Dr Manhatten") {
            return "You can't be negative years old";
        }
    },
    initialize: function() {
        console.log("Welcome to this world");
        this.on("invalid", function(model, error) {
            // We have received an error, log it, alert it or forget it :)
            console.log(error);
        });
    }
});

var person = new Person;
person.set({ name: "Mary Poppins", age: -1 }, {validate:true});
// Will trigger an alert outputting the error

var person = new Person;
person.set({ name: "Dr Manhatten", age: -1 }, {validate:true}); 
```

还有一个 Fiddle [http://jsfiddle.net/nikoshr/udm8A/](http://jsfiddle.net/nikoshr/udm8A/)（一定要打开一个控制台，我将`alert`调用转换为`console.log`）

# scala - Scala：如何使用从函数返回的不可变值

> ID：15501332
> 
> 赞同：0
> 
> 时间：2013-03-19T13:50:11.603
> 
> 标签：scala, immutability

我是 Scala 的新手，并尝试以实用的方式使用它。以下是我的问题：

1.  为什么我不能使用“<-”运算符为具有函数返回值的“cnt”变量创建新绑定？

2.  如何以函数方式增加不可变变量（类似于 Haskell <-）？为了实验，我不想使用可变变量。

    ```
    import scala.io.Source
    object MyProgram {

      def main(args: Array[String]): Unit = {
        if (args.length > 0) {
          val lines = Source.fromFile(args(0)).getLines()
          val cnt = 0
          for (line <- lines) {
            cnt <- readLines(line, cnt)
          }
          Console.err.println("cnt = "+cnt)
        }
      }

      def readLines(line: String, cnt:Int):Int = {
        println(line.length + " " + line)
        val newCnt = cnt + 1
        return (newCnt)
      }
    } 
    ```

至于副作用，我没想到 (line <-lines) 会如此具有破坏性！它完全展开线迭代器。因此，运行以下代码段将使 size = 0 ：

```
val lines = Source.fromFile(args(0)).getLines()
var cnt = 0
for (line <- lines) {
  cnt = readLines(line, cnt)
}
val size = lines.size 
```

像这样隐藏的副作用是正常的 Scala 实践吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:04:07.887

你可以这样弃牌`lines`：

```
val lines = Source.fromFile(args(0)).getLines()
val cnt = lines.foldLeft(0) { case (count, line) => readLines(line, count) }
Console.err.println("cnt = "+cnt) 
```

您的`readLines`方法对调用有副作用`println`，但使用`foldLeft`保证从左到右处理列表，因此输出应该是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:03:25.177

*为什么我不能使用“<-”运算符重新分配具有函数返回值的不可变“cnt”变量？*

你为什么要？如果您有 java 经验，<- 的含义`:`与`for(Item x: someCollection)`. [它只是](https://stackoverflow.com/a/3754568/298389)从集合中获取当前项目并为其命名的语法糖，它通常不是*绑定*运算符。

此外，不是*重新分配不可变的* [矛盾修饰](https://en.wikipedia.org/wiki/Oxymoron)法吗？

*如何以函数方式增加不可变变量（类似于 Haskell <-）？*

人们通常使用 Scala `.zipWithIndex`，但这仅在您要在内部使用 counter 进行理解时才有效：

```
for((x, i) <- lines.zipWithIndex) { println("the counter value is" + i) } 
```

所以我认为你需要坚持`lines.count`或使用折叠/减少或`=`为`var`iable 分配新值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:03:31.370

`<-`不是运算符，只是用于表达式的语法。你必须使用`=`. 如果要使用`<-`它必须在 for-iteration-expression 内。而且你不能增加 a `val`。如果要修改该变量，请将其设为`var`.

# database - 在 Azure 数据库上执行操作

> ID：15501341
> 
> 赞同：0
> 
> 时间：2013-03-19T13:50:41.513
> 
> 标签：database, azure

我有一个托管在 Azure 上的数据库。我有一个 MVC 4 网站，用户登录并与数据库交互。我需要一些可以用来遍历数据库中的表、检查某些条件然后对我的数据库进行所需更改的东西。我可以使用什么框架或编码语言来实现这一点？我希望我可以让这个脚本连续运行或以特定的时间间隔运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:54:25.387

有多种方法可以实现这一点，它们都取决于您对该脚本的规模/资源/等的需求。

您可以使用任何语言对作业进行编码（如果您使用[sqlcmd](http://msdn.microsoft.com/en-us/library/ms170572.aspx)或类似语言，则包括批处理）

您可以安排作业在您想要的任何地方运行，包括办公室中的机器、数据中心等。

您可以使用 Aditi 新发布的作业调度程序（它是免费的，称为调度程序，可在 Azure 应用商店中获得）

# xslt - jaxb transformerfactory xml 通过 xslt 使用 generate-id 获取唯一值

> ID：15501343
> 
> 赞同：1
> 
> 时间：2013-03-19T13:50:42.597
> 
> 标签：xslt, jaxb

我有以下代码通过 xslt 将一个 xml 文档转换为另一个

```
 TransformerFactory tFactory = TransformerFactory.newInstance();
        Transformer transformer = tFactory.newTransformer(new javax.xml.transform.stream.StreamSource(
                this.getClass().getClassLoader().getResourceAsStream(ie.getXslFileName())));
        transformer.transform(
                new javax.xml.transform.stream.StreamSource(reader),
                new javax.xml.transform.stream.StreamResult(stream));
        output.put(fileName, stream.toByteArray()); 
```

如果我不尝试选择不同的值，它会完美运行。但是，只要我输入 generate-id 行并键入它就会失败。在我使用的所有其他测试工具中，转换是完美的，所以我认为这是 jaxb 转换器的限制？有没有人对我如何选择可以在这里工作并启用 jaxb 转换的唯一值有任何建议？或者，是否有另一个我可以使用的变压器来解决问题？

XSLT 无处不在，但在这里：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" version="1.0" encoding="UTF-8" />

  <xsl:key name="groupKey"
           match="//questionGroup/externalCodes/externalCode/externalCode/text()" 
           use="." />

  <xsl:template match="/">
    <xsl:apply-templates select="submissionReport"/>
  </xsl:template>

  <xsl:template match="submissionReport" >
    <component>
      <structuredBody>
        <xsl:for-each select="//questionResponse/question/questionGroup
                               /externalCodes/externalCode[governingBody
                                [internalCode='GVB-AHRQ-1']]
                               /externalCode/text()[generate-id() = 
                                  generate-id(key('groupKey',.)[1])]">
          <component>
            <section>
              <entry>
                <templateId>
                  <xsl:attribute name="root">
                    <xsl:value-of select="."/>
                  </xsl:attribute>
                </templateId>
                <organizer classCode="CLUSTER" moodCode="EVN">
                  <id nullFlavor="NA"/>
                  <statusCode code="completed"/>
                  <xsl:call-template name="groupedResponses">
                    <xsl:with-param name="groupInternalCode" select="."/>
                  </xsl:call-template>
                </organizer>
              </entry>
            </section>
          </component>
        </xsl:for-each>
      </structuredBody>
    </component>
  </xsl:template>

  <xsl:template name="groupedResponses">
    <xsl:param name="groupInternalCode"/>
    <xsl:for-each select="//questionResponse[question[externalCodes
                            [externalCode[governingBody[internalCode='GVB-AHRQ-1'] and 
                               not(externalCode='DE42') and not(externaCode='DE3') and 
                               not(externalCode='DE46') and not(externalCode='DE49') and 
                               not(externalCode='DE30')]] and 
                               questionGroup[externalCodes[externalCode[governingBody[internalCode='GVB-AHRQ-1'] and 
                               externalCode=$groupInternalCode]]]]]">
      <component>
        <observation>
          <xsl:attribute name="classCode">OBS</xsl:attribute>
          <xsl:attribute name="moodCode">EVN</xsl:attribute>
          <templateId>
            <xsl:attribute name="root">2.16.840.1.113883.3.263.1.11.3.100</xsl:attribute>
          </templateId>
          <xsl:for-each select="question/externalCodes/externalCode
                                   [governingBody[internalCode='GVB-AHRQ-1'] or 
                                   governingBody[internalCode='GVB-CDCRACE-1'] or 
                                   governingBody[internalCode='GVB-HL7NULL-1'] or 
                                   governingBody[internalCode='GVB-HL7GENDER-1']]">
            <!-- Question information -->
            <code>
              <xsl:attribute name="code">
                <xsl:value-of select="externalCode"/>
              </xsl:attribute>
              <xsl:attribute name="displayName">
                <xsl:value-of select="../../text"/>
              </xsl:attribute>
              <xsl:attribute name="codeSystem">
                <xsl:value-of select="governingBody/externalCode"/>
              </xsl:attribute>
              <xsl:attribute name="codeSystemName">
                <xsl:value-of select="governingBody/name"/>
              </xsl:attribute>
            </code>

            <!-- Response information.  Can be more than one -->
            <xsl:for-each select="../../../response">
              <value>
                <xsl:choose>
                  <xsl:when test="responseOption">
                    <xsl:for-each select="responseOption/externalCodes/externalCode">
                      <value>
                        <xsl:attribute name="type">CD</xsl:attribute>
                        <xsl:attribute name="code">
                          <xsl:value-of select="externalCode"/>
                        </xsl:attribute>
                        <xsl:attribute name="displayName">
                          <xsl:value-of select="../../response"/>
                        </xsl:attribute>
                        <xsl:attribute name="codeSystem">
                          <xsl:value-of select="governingBody/externalCode"/>
                        </xsl:attribute>
                        <xsl:attribute name="codeSystemName">
                          <xsl:value-of select="governingBody/name"/>
                        </xsl:attribute>
                      </value>
                    </xsl:for-each>
                  </xsl:when>

                  <xsl:otherwise>
                    <value>
                      <xsl:attribute name="type">ED</xsl:attribute>
                      <xsl:attribute name="mediaType">text/plain</xsl:attribute>
                      <xsl:value-of select="response"/>
                    </value>
                  </xsl:otherwise>
                </xsl:choose>
              </value>
            </xsl:for-each>
          </xsl:for-each>
        </observation>
      </component>
    </xsl:for-each>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-09T00:31:35.463

> 我决定导入 Saxon 以启用 XSLT 2.0。几秒钟后的分组是完美的并且很容易工作。

# c# - 打开导出的 excel 文件时出现错误消息

> ID：15501349
> 
> 赞同：0
> 
> 时间：2013-03-19T13:50:52.917
> 
> 标签：c#, asp.net

我正在使用 JS 中的普通 onRequestStart 函数将我的网格导出到 excel（这里是函数）

```
 <script type="text/javascript">
            function onRequestStart(sender, args) {
                if (args.get_eventTarget().indexOf("ExportToExcelButton") >= 0 ||
                 args.get_eventTarget().indexOf("ExportToWordButton") >= 0 ||
                 args.get_eventTarget().indexOf("ExportToCsvButton") >= 0) {
                    args.set_enableAjax(false);
                }
            }
</script> 
```

然后我调用 Grid_ItemCommand 检查它是 excel 导出字还是 csv 然后我调用我的方法 doExport()

```
 private void doExport()
        {
            this.UserGrid.ExportSettings.ExportOnlyData = true;
            this.UserGrid.ExportSettings.IgnorePaging = true;
            this.UserGrid.ExportSettings.OpenInNewWindow = true;
            this.UserGrid.ExportSettings.FileName = String.Format("YearReport_{0}_{1}", this.selectedYear, this.rcbDepartments.SelectedValue);
        } 
```

到目前为止一切正常，但是在完成下载文件并在 excel 中打开一个奇怪的>“Warring Message”之后，是否有解决方案如何禁用此消息？ ![在此处输入图像描述](../Images/03b4c78ad297e39a22a2df66a4160726.png)

感谢您的帮助和快速答复

PS：如果您需要更多内容，请随时询问

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:54:42.830

问题是实际文件类型和扩展名之间的不匹配，因为您将数据导出为 CSV，但您告诉 Excel 它是一个 XLS 文件。这是一个正常的 Excel 警告。

如果要禁用此功能，只需确保导出的文件具有“csv”扩展名即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T13:57:08.490

将导出文件另存为“.xlsx”文件。当您将 Office 2003 样式保存为 .xlsx 或以其他方式保存时，这种情况总是会发生。

**编辑**

或如另一个答案“.csv”中所述。同样的概念也适用。

Excel 检测到文件内容与给定的扩展名不匹配，因此出现错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T13:58:20.490

发生此错误是因为使用`Mime Type`not by创建 Excel 文件`Microsoft.Office.Interop.Excel`，

**此错误的原因：**

```
 The alert is a new security feature in Excel 2007 called Extension Hardening, which 
ensures that the file content being opened matches the extension type specified in the 
shell command that is attempting to open the file. Because the MIME types listed above are 
associated with the .XLS extension, the file must be in XLS (BIFF8) file format to open 
without this warning prompt.  If the file type is a different format (such as HTML, XML, 
CSV, etc.) the prompt is expected since the file content is different that the extension 
or MIME type. The alert is first seen when opening the file from a URL site directly.  If 
you cancel the alert, the open will fail, but then IE will attempt to download the file 
and open again using a different shell command. Depending on what the file contents is and 
what extension IE gives the file it downloads, you may see the second open attempt 
succeed, or you may see the prompt again but with a different filename in the alert dialog.

    The alert prompt is "by design", but the interaction of the cancel action and IE's 
attempt to open the file again is a known problem under investigation for a future fix. 
```

**解释来源：http:** [//blogs.msdn.com/b/vsofficedeveloper/archive/2008/03/11/excel-2007-extension-warning.aspx](http://blogs.msdn.com/b/vsofficedeveloper/archive/2008/03/11/excel-2007-extension-warning.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T10:18:22.553

我认为问题在于这个网格组件正在将其导出到 html 并且只需添加一个 xlsx 标记或 2010 年的任何 excel 都有这种新机制可以保护 excel 打开未知文件我认为对于我自己来说没有解决方案问题 ..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-07T23:32:50.320

我目前正在研究一种使用 c# 执行此操作的编程方式。在 c# 之外，如果您只是想从 Windows 上的文件系统打开文件，您可以修改注册表以忽略它。

[https://support.microsoft.com/en-us/help/948615/error-opening-file-the-file-format-differs-from-the-format-that-the-fi](https://support.microsoft.com/en-us/help/948615/error-opening-file-the-file-format-differs-from-the-format-that-the-fi)

如果我得到它，我会跟进我的程序化解决方案。

# ruby-on-rails - 从 rails 3.2.12 更改为 3.2.13 时导致极度缓慢的原因是什么

> ID：15501354
> 
> 赞同：20
> 
> 时间：2013-03-19T13:51:01.460
> 
> 标签：ruby-on-rails, ruby, view, ruby-on-rails-3.2, performance

今天早上，我将 rails 从 3.2.12 更新到 3.2.13，这导致加载我的视图时出现严重延迟。这是从加载我的主页：

```
Rails 3.2.12:
Completed 200 OK in 387ms (Views: 339.0ms | ActiveRecord: 27.1ms)

Rails 3.2.13:
Completed 200 OK in 4416ms (Views: 4361.2ms | ActiveRecord: 28.7ms) 
```

两者之间的唯一区别是提交 Rails 版本，这当然也导致许多其他 gem 被更新......这是 Gemfile.lock 中的区别：

```
GEM
   remote: https://rubygems.org/
   specs:
-    actionmailer (3.2.12)
-      actionpack (= 3.2.12)
-      mail (~> 2.4.4)
-    actionpack (3.2.12)
-      activemodel (= 3.2.12)
-      activesupport (= 3.2.12)
+    actionmailer (3.2.13)
+      actionpack (= 3.2.13)
+      mail (~> 2.5.3)
+    actionpack (3.2.13)
+      activemodel (= 3.2.13)
+      activesupport (= 3.2.13)
       builder (~> 3.0.0)
       erubis (~> 2.7.0)
       journey (~> 1.0.4)
@@ -14,19 +14,19 @@ GEM
       rack-cache (~> 1.2)
       rack-test (~> 0.6.1)
       sprockets (~> 2.2.1)
-    activemodel (3.2.12)
-      activesupport (= 3.2.12)
+    activemodel (3.2.13)
+      activesupport (= 3.2.13)
       builder (~> 3.0.0)
-    activerecord (3.2.12)
-      activemodel (= 3.2.12)
-      activesupport (= 3.2.12)
+    activerecord (3.2.13)
+      activemodel (= 3.2.13)
+      activesupport (= 3.2.13)
       arel (~> 3.0.2)
       tzinfo (~> 0.3.29)
-    activeresource (3.2.12)
-      activemodel (= 3.2.12)
-      activesupport (= 3.2.12)
-    activesupport (3.2.12)
-      i18n (~> 0.6)
+    activeresource (3.2.13)
+      activemodel (= 3.2.13)
+      activesupport (= 3.2.13)
+    activesupport (3.2.13)
+      i18n (= 0.6.1)
       multi_json (~> 1.0)
     airbrake (3.1.7)
       activesupport
@@ -129,7 +129,7 @@ GEM
     hashr (0.0.22)
     hike (1.2.1)
     honeypot-captcha (0.0.2)
-    i18n (0.6.4)
+    i18n (0.6.1)
     journey (1.0.4)
     jquery-rails (2.2.0)
       railties (>= 3.0, < 5.0)
@@ -146,7 +146,7 @@ GEM
     kgio (2.8.0)
     listen (0.7.2)
     lumberjack (1.0.2)
-    mail (2.4.4)
+    mail (2.5.3)
       i18n (>= 0.4.0)
       mime-types (~> 1.16)
       treetop (~> 1.4.8)
@@ -155,7 +155,7 @@ GEM
     mime-types (1.21)
     mocha (0.10.5)
       metaclass (~> 0.0.1)
-    multi_json (1.6.1)
+    multi_json (1.7.1)
     mysql2 (0.3.11)
     nested_form (0.3.1)
     net-scp (1.0.4)
@@ -180,14 +180,14 @@ GEM
       rack
     rack-test (0.6.2)
       rack (>= 1.0)
-    rails (3.2.12)
-      actionmailer (= 3.2.12)
-      actionpack (= 3.2.12)
-      activerecord (= 3.2.12)
-      activeresource (= 3.2.12)
-      activesupport (= 3.2.12)
+    rails (3.2.13)
+      actionmailer (= 3.2.13)
+      actionpack (= 3.2.13)
+      activerecord (= 3.2.13)
+      activeresource (= 3.2.13)
+      activesupport (= 3.2.13)
       bundler (~> 1.0)
-      railties (= 3.2.12)
+      railties (= 3.2.13)
     rails_admin (0.4.3)
       bootstrap-sass (~> 2.2)
       builder (~> 3.0)
@@ -202,9 +202,9 @@ GEM
       rails (~> 3.1)
       remotipart (~> 1.0)
       sass-rails (~> 3.1)
-    railties (3.2.12)
-      actionpack (= 3.2.12)
-      activesupport (= 3.2.12)
+    railties (3.2.13)
+      actionpack (= 3.2.13)
+      activesupport (= 3.2.13)
       rack-ssl (~> 1.3.2)
       rake (>= 0.8.7)
       rdoc (~> 3.4)
@@ -212,7 +212,7 @@ GEM
     raindrops (0.10.0)
     rake (10.0.3)
     rb-fsevent (0.9.1)
-    rdoc (3.12.1)
+    rdoc (3.12.2)
       json (~> 1.4)
     remotipart (1.0.2)
     rest-client (1.6.7)
@@ -266,7 +266,7 @@ GEM
       eventmachine (>= 0.12.6)
       rack (>= 1.0.0)
     thor (0.17.0)
-    tilt (1.3.4)
+    tilt (1.3.6)
     tire (0.5.4)
       activemodel (>= 3.0)
       hashr (~> 0.0.19)
@@ -280,7 +280,7 @@ GEM
       actionpack (>= 3.1)
       execjs
       railties (>= 3.1)
-    tzinfo (0.3.35)
+    tzinfo (0.3.37)
     uglifier (1.3.0)
       execjs (>= 0.3.0)
       multi_json (~> 1.0, >= 1.0.2)
@@ -325,7 +325,7 @@ DEPENDENCIES
   nested_form
   newrelic_rpm (~> 3.5.5.38)
   pry
-  rails (= 3.2.12)
+  rails (= 3.2.13)
   rails_admin
   rb-fsevent (= 0.9.1)
   rmagick 
```

除此之外，这两个文件没有任何改变。

通过阅读[诊断视图渲染缓慢的原因，](https://stackoverflow.com/questions/15317048/diagnosing-the-cause-of-slow-view-rendering)我了解到资产管道中的内容可能会减慢它的速度，但是当我更改 development.rb 中“config.assets.debug = false”的值时，我看不到有什么不同。

我想我的资产管道中确实有很多资产需要清理，我会在部署到生产之前清理，但我想知道为什么这会在更新 Rails 后突然造成延迟。问题是：是什么原因造成的，我可以做些什么吗？

如果您需要更多信息，请告诉我。任何帮助是极大的赞赏。

编辑：我还在 github.com/rails/rails 上创建了一个问题，这似乎被认为是一种回归：[https](https://github.com/rails/rails/issues/9803) ://github.com/rails/rails/issues/9803 。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T21:07:20.163

[我们对Discourse](http://discourse.org)也有同样的问题。我将相关的安全修复提取到一个可以应用于 Rails 3.2 应用程序的猴子补丁中：

```
module HTML
  class WhiteListSanitizer
      # Sanitizes a block of css code. Used by #sanitize when it comes across a style attribute
    def sanitize_css(style)
      # disallow urls
      style = style.to_s.gsub(/url\s*\(\s*[^\s)]+?\s*\)\s*/, ' ')

      # gauntlet
      if style !~ /\A([:,;#%.\sa-zA-Z0-9!]|\w-\w|\'[\s\w]+\'|\"[\s\w]+\"|\([\d,\s]+\))*\z/ ||
          style !~ /\A(\s*[-\w]+\s*:\s*[^:;]*(;|$)\s*)*\z/
        return ''
      end

      clean = []
      style.scan(/([-\w]+)\s*:\s*([^:;]*)/) do |prop,val|
        if allowed_css_properties.include?(prop.downcase)
          clean <<  prop + ': ' + val + ';'
        elsif shorthand_css_properties.include?(prop.split('-')[0].downcase)
          unless val.split().any? do |keyword|
            !allowed_css_keywords.include?(keyword) &&
              keyword !~ /\A(#[0-9a-f]+|rgb\(\d+%?,\d*%?,?\d*%?\)?|\d{0,2}\.?\d{0,2}(cm|em|ex|in|mm|pc|pt|px|%|,|\))?)\z/
          end
            clean << prop + ': ' + val + ';'
          end
        end
      end
      clean.join(' ')
    end
  end
end

module HTML
  class WhiteListSanitizer
    self.protocol_separator = /:|(&#0*58)|(&#x70)|(&#x0*3a)|(%|&#37;)3A/i

    def contains_bad_protocols?(attr_name, value)
      uri_attributes.include?(attr_name) &&
      (value =~ /(^[^\/:]*):|(&#0*58)|(&#x70)|(&#x0*3a)|(%|&#37;)3A/i && !allowed_protocols.include?(value.split(protocol_separator).first.downcase.strip))
    end
  end
end

module ActiveRecord
  class Relation

    def where_values_hash
      equalities = with_default_scope.where_values.grep(Arel::Nodes::Equality).find_all { |node|
        node.left.relation.name == table_name
      }

      Hash[equalities.map { |where| [where.left.name, where.right] }].with_indifferent_access
    end

  end
end

module ActiveRecord
  class PredicateBuilder # :nodoc:
    def self.build_from_hash(engine, attributes, default_table, allow_table_name = true)
      predicates = attributes.map do |column, value|
        table = default_table

        if allow_table_name && value.is_a?(Hash)
          table = Arel::Table.new(column, engine)

          if value.empty?
            '1 = 2'
          else
            build_from_hash(engine, value, table, false)
          end
        else
          column = column.to_s

          if allow_table_name && column.include?('.')
            table_name, column = column.split('.', 2)
            table = Arel::Table.new(table_name, engine)
          end

          attribute = table[column]

          case value
          when ActiveRecord::Relation
            value = value.select(value.klass.arel_table[value.klass.primary_key]) if value.select_values.empty?
            attribute.in(value.arel.ast)
          when Array, ActiveRecord::Associations::CollectionProxy
            values = value.to_a.map {|x| x.is_a?(ActiveRecord::Base) ? x.id : x}
            ranges, values = values.partition {|v| v.is_a?(Range) || v.is_a?(Arel::Relation)}

            array_predicates = ranges.map {|range| attribute.in(range)}

            if values.include?(nil)
              values = values.compact
              if values.empty?
                array_predicates << attribute.eq(nil)
              else
                array_predicates << attribute.in(values.compact).or(attribute.eq(nil))
              end
            else
              array_predicates << attribute.in(values)
            end

            array_predicates.inject {|composite, predicate| composite.or(predicate)}
          when Range, Arel::Relation
            attribute.in(value)
          when ActiveRecord::Base
            attribute.eq(value.id)
          when Class
            # FIXME: I think we need to deprecate this behavior
            attribute.eq(value.name)
          when Integer, ActiveSupport::Duration
            # Arel treats integers as literals, but they should be quoted when compared with strings
            column = engine.connection.schema_cache.columns_hash[table.name][attribute.name.to_s]
            attribute.eq(Arel::Nodes::SqlLiteral.new(engine.connection.quote(value, column)))
          else
            attribute.eq(value)
          end
        end
      end

      predicates.flatten
    end
  end
end 
```

随着安全补丁的应用和 Rails 3.2.13 的恢复，性能恢复正常。在预编译我们的资产时，我们也遇到了 UTF-8 错误，并且这种情况不再发生。似乎 3.2.13 补丁中有一堆与安全无关的东西正在破坏东西:(

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-20T10:25:48.913

@fredwu 在拉取请求中解决了这个问题：[https ://github.com/rails/rails/pull/9820](https://github.com/rails/rails/pull/9820)

要立即使用此修复程序（并且不必等待新的 Rails 版本），您可以使用以下代码在您自己的应用程序中修改 AssetsPaths 类：

```
module Sprockets
  module Helpers
    module RailsHelper
      class AssetPaths < ::ActionView::AssetPaths
        private
        def rewrite_extension(source, dir, ext)
          source_ext = File.extname(source)[1..-1]
          if !ext || ext == source_ext
            source
          elsif source_ext.blank?
            "#{source}.#{ext}"
          elsif File.exists?(source) || exact_match_present?(source)
            source
          else
            "#{source}.#{ext}"
          end
        end
      end
    end
  end
end 
```

# java - 获取外部存储目录不起作用

> ID：15501355
> 
> 赞同：47
> 
> 时间：2013-03-19T13:51:02.123
> 
> 标签：java, android, sd-card

我正在尝试将文件保存到运行 4.2.2 的三星 Galaxy Nexus 上的 SD 卡。从我正在使用的应用程序

```
Environment.getExternalStorageDirectory() 
```

但它返回

```
/storage/emulated/0/ 
```

这不是我的 SD 卡信息所在的位置。有什么工作方法可以用来获取 SD 卡的正确路径吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-19T13:53:48.417

实际上，这是正确的位置。

从 android 4,2 开始，Google 引入了多个用户帐户。每个用户都有他/她自己的外部存储，它在路径中具有用户 ID 以保持唯一性。

主要（默认）用户的 ID 为 0。因此，您将获得`/storage/emulated/0/`外部存储的路径。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-09-29T18:20:15.103

I just learned this is the Jelly Bean's way of dealing with the lack of `android.permission.WRITE_EXTERNAL_STORAGE` permission. I haven't seen such a behavior with older versions of Android.

Just add this line to your AndroidManifest.xml:

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-19T13:53:40.407

`Environment.getExternalStorageDirectory()`指的是设备制造商认为是“外部存储”的任何东西。我可以是 SD 卡以外的其他东西。

您可以在此处获得更多信息：[查找外部 SD 卡位置](https://stackoverflow.com/questions/5694933/find-an-external-sd-card-location)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-10T07:40:53.180

我认为这是因为使用了 genymotion 模拟器，路径是真实的，并且在 Eclipse 中它位于

```
File Explorer - > mnt - > shell - > emulated -> 0 
```

希望能帮助到你 ;）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-09T23:46:48.300

我不知何故在 /storage/emulated/0 处丢失了我的符号链接，导致了类似的故障。我所做的是使用相机应用程序拍照。我观察到图片详细信息说它在 /storage/emulated/0 中，尽管文件资源管理器中不存在该目录。然后我重新启动了手机。重新启动后，链接存在。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-19T13:54:05.477

当然？你认为你的sdcard安装在哪里？尝试`ls -l`在该目录上进行操作——它可能是指向`/storage/emulated/0/`.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-19T13:54:25.893

尝试使用`getExternalFilesDir()`或`getExternalStoragePublicDirectory()`。

来自[Android 4.2 文档](http://developer.android.com/about/versions/android-4.2.html)

# regex - 删除标点符号 Perl

> ID：15501358
> 
> 赞同：0
> 
> 时间：2013-03-19T13:51:10.373
> 
> 标签：regex, perl, punctuation

Hye..如何删除标点符号？..实际上我已经尝试使用`[:punct:]`但它不适用于所有标点符号。它只是仅删除点`.`...但其他标点符号仍然存在。我的任务是删除段落，删除标点符号并将所有文本更改为小写..

这是我的文本文件，即 snuker.txt

```
snuker berjaya menarik perhatian kbs.
19981230

Sam Chong"" kiri dan ooi Chin Kay memberi sumbangan besar kepada pembangunan snuker tanah air 
dengan merangkul pingat' emas sukan asia ti'ga belas tahun sembi'lan belas sembilan puluh lapan membuka 
lembaran baru snuker dan biliard tanah air apabila mereka kian disegani dan berjaya menukar tanggapan. 
negatif masyarakat tempatan terhadap sukan itu 
```

这是我的 perl 脚本

```
#!/usr/bin/perl

use utf8;

if(! open(INPUT, '< snuker.txt'))
{
die "cannot opent input file: $!";
}

if(! open(OUTPUT, '> output.txt'))
{
    die "cannot open output file: $!";
}

select OUTPUT;

while($lines = <INPUT>)
{

    if($lines =~ s/[\s[:punct:]]+$/ /g)
    {
        print "$lines";
    }
}

close INPUT;
close OUTPUT;
close STDOUT; 
```

输出是这样的......其他标点符号仍然有......`.`只是消失了......

```
snuker berjaya menarik perhatian kbs 19981230  Sam Chong"" kiri dan ooi Chin Kay memberi sumbangan besar kepada pembangunan snuker tanah air dengan merangkul pingat' emas sukan asia ti'ga belas tahun sembi'lan belas sembilan puluh lapan membuka lembaran baru snuker dan biliard tanah air apabila mereka kian disegani dan berjaya menukar tanggapan negatif masyarakat tempatan terhadap sukan itu 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T14:01:08.853

从正则表达式中删除美元符号。它使您的模式仅在行尾匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:01:18.300

尝试这样做：

```
#!/usr/bin/perl

use strict; use warnings;

$/ = ""; # read file per paragraphs

while (<>) {
    s/\p{Punct}//g;
    s/(?:\n|\s+)/ /g;
    print lc($_);
} 
```

## 用法

```
perl script.pl < test_file >  output.txt 
```

## 输出

> snuker成功集团menarik perhatian KBS 19981230 SAM创基里丹OOI下巴凯memberi sumbangan大臣kepada pembangunan snuker丹那空气dengan merangkul pingat EMAS sukan亚洲迪迦贝拉斯tahun森美兰贝拉斯森美兰puluh LAPAN membuka lembaran巴鲁snuker丹biliard丹那空气apabila mereka KIAN disegani丹成功集团menukar tanggapan negatif masyarakat tempatan terhadap sukan itu

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:01:57.887

```
#!/usr/bin/perl

use utf8;

if(! open(INPUT, '< test_file'))
{
    die "cannot opent input file: $!";
}

if(! open(OUTPUT, '> output.txt'))
{
    die "cannot open output file: $!";
}

select OUTPUT;

while($lines = <INPUT>)
{
    $lines =~ s/\n/ /g;
    $lines =~ s/[[:punct:]]//g;
    print lc("$lines");
}

close INPUT;
close OUTPUT;
close STDOUT; 
```

# c# - Automapper 继承和自定义类型转换器

> ID：15501360
> 
> 赞同：0
> 
> 时间：2013-03-19T13:51:12.027
> 
> 标签：c#, asp.net-mvc, dependency-injection, automapper

首先，我已经在网上搜索了一个解决方案，找不到任何东西。

我正在研究一个高度解耦的解决方案，所有类都是为 DI 方法设计的（当然要求接口作为依赖项）。我们在 MVC 层中使用 Automapper 来转换扁平化 ViewModel 中的服务器端 POCO。到目前为止没有什么奇怪的。

复杂性在于 ViewModel 的某些属性必须使用在 IoC 容器 (ninject) 中注册的某些服务来创建，并且在配置自动映射器的应用程序启动期间不可用。告诉 automapper 使用什么方法来解析类型很容易，只需按照文档进行一行配置。

对于单个属性需要此行为的简单情况，我们为该属性创建一个自定义 ValueResolver，在构造函数中公开依赖项并使用它们返回所需的值。

当我们有 20 个属性需要相同的行为，但输出值不同，而所有其他 ViewModel 属性都可以使用默认的“自动映射”时，就会出现问题。

我找不到一种方法来告诉 automapper“解决这些属性，使用这个类，因为所有其他人只使用你的约定”。

我尝试了几种方法，包括将所需的属性放在接口上，然后使用 wiki 上描述的继承映射。只要我不使用 TypeConverter，它就可以工作，这是没有意义的，因为我需要它（或类似的东西）来通过 DI/IoC 获得所需的服务。

一个例子：

```
public interface IMyInterface
{
    string MyUrl1 {get;set;}
    //snip with many other urls
}

public class MyViewModel : IMyInterface
{
    public string MyUrl1 {get;set;}
    //snip with many other urls
    public string MyAutomapperProperty1 {get;set;}
    //snip with many other properties where I want to use the conventions
} 
```

我需要的是这样的

```
public class MyTypeConverter : TypeConverter<MyPoco, IMyInterface>
{
    // here in the overridden method return an instance of MyViewModel 
    // with just the properties exposed by the interface
} 
```

然后在自动映射器配置中：

```
Automapper.CreateMap<MyPoco, IMyInterface>()
    .Include<MyPoco, MyViewModel>()
    .ConvertUsing<MyTypeConverter>();

Automapper.CreateMap<MyPoco, MyViewModel>(); 
```

这行不通。如果我删除对 ConvertUsing 的调用并使用 ForMember 方法添加内联映射，一切正常，并且 ForMember 声明被第二个映射正确继承，但不是 ConvertUsing。但是我不能使用 ForMember 方法进行 DI（因为我在应用程序启动中，它是静态的，另外这意味着在应用程序级别实例化这些对象并使它们在所有应用程序中保持活动状态，而不是创建和处置它们需要的时候）。

我知道一个解决方案是将相关属性放在一个单独的对象中，并直接为该对象创建一个 TypeConverter 并使用它，但是现在重构这些 POCO 不是一种选择，此外，似乎很奇怪没有办法使继承和DI一起工作。

希望有人能帮帮我，谢谢阅读。

**更新** 根据要求，我将尝试更清楚地说明我想要实现的目标。

我们有一些“服务”，仅通过它们的接口在应用程序级别知道。就像是：

```
public interface IUrlResolver { } 
```

它公开了一堆方法来获取与我们的应用程序相关的 URL，基于我们传递的一些参数和其他东西。该实现也可能会暴露对其他服务（接口）等的依赖关系。因此我们使用 DI 并让 IoC 容器解析依赖链。

现在假设我的 ViewModel 有 50 个属性，其中 30 个可以使用基于约定的 automapper 映射，而其他 20 个需要通过我的*IUrlResolver*接口的不同方法来解决。为了弄清楚事实：

*   我不能在配置 automapper 的地方使用 DI，因为它发生在 Application_Start （或应用程序启动调用的某些静态方法）
*   即使可能，我也不会在应用程序级别解析我的*IUrlResolver ，因为它在所有应用程序生命周期中都是陈旧的*
*   如果我对单个属性使用 ValueResolver，一切都很好。ValueResolver 构造函数请求*IUrlResolver*，它会在发生自动映射器转换时在运行时注入。
*   我可以为我的 20 个属性创建 20 个不同的 ValueResolver 类，但它会使代码变得混乱，产生大量的代码重复，没有可重用性等。一堆糟糕的做法。
*   我想要的是能够使用自定义类（如 TypeConverter）**部分映射**对象，同时使用默认约定引擎映射所有其他属性

我没有要发布的“示例语法”，因为我尝试过的最接近的方法是我之前发布的方法。如果存在，我愿意接受完全不同的方法，只要它允许我保持事物解耦并且不涉及在单独的类中重构这些属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:51:27.807

> 我不能在配置 automapper 的地方使用 DI，因为它发生在 Application_Start （或应用程序启动调用的某些静态方法）

这听起来像是一个相当人为的约束。DI 容器连接和 AutoMapper 配置都可能发生在应用程序启动阶段的早期。在配置 DI 容器后运行 AutoMapper 配置至少在理论上应该是可行的。如果有实际原因导致情况并非如此，您能否详细说明？

*附录：* 如果核心问题是您希望在映射时启用 IoC 容器的依赖关系解析，AutoMapper 确实为此提供了挂钩。有关您可以使用的两种候选方法，请参阅[https://github.com/AutoMapper/AutoMapper/wiki/Custom-value-resolvers#custom-constructor-methods](https://github.com/AutoMapper/AutoMapper/wiki/Custom-value-resolvers#custom-constructor-methods)和[https://github.com/AutoMapper/AutoMapper/wiki/Containers](https://github.com/AutoMapper/AutoMapper/wiki/Containers) .

# android - 在 android 上捕获视频并在 iPhone 上播放

> ID：15501365
> 
> 赞同：2
> 
> 时间：2013-03-19T13:51:26.217
> 
> 标签：android, iphone

**我正在我的 android 设备上捕捉视频，视频格式为`.mp4`. 当我尝试在 iPhone 设备上播放视频时，视频无法播放，但在 iPhone 设备上捕获的任何其他视频都可以正常播放。**

是否有任何类型的视频和音频`encoding`都适用于 android 和 iPhone？

这是我设置音频/视频编码器的 Java 代码：

```
recorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
recorder.setVideoSource(MediaRecorder.VideoSource.DEFAULT);
recorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
recorder.setVideoEncoder(MediaRecorder.VideoEncoder.MPEG_4_SP);
recorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:06:33.893

尝试就像：

```
 recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    recorder.setVideoSource(MediaRecorder.VideoSource.DEFAULT);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
    recorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264); 
```

# wcf - 在 Silverlight 中从 CRM 2011 获取有用的错误消息

> ID：15501370
> 
> 赞同：2
> 
> 时间：2013-03-19T13:51:44.233
> 
> 标签：wcf, dynamics-crm-2011, silverlight-5.0, dynamics-crm-online

*免责声明：这**不是**[此线程](https://stackoverflow.com/questions/10013162/getting-useful-error-messages-from-ms-dynamics-crm-plugins-through-wcf)的副本。首先，就我而言，没有中间层服务。其次，我正在使用 SL 5 和 CRM 2011。*

我正在开发 Silverlight 应用程序以与 MS CRM 2011 一起使用。这些应用程序是 CRM 解决方案的一部分，旨在用于 CRM Online。

这很重要：我不能编写额外的 Web 服务或修改`web.config`属于 CRM 的文件，因为我无法使用 CRM Online 来做这些事情。

通常我的应用程序只需要 OData 服务，在这些情况下没有问题。但是一个应用程序需要使用 SOAP 组织服务，问题就从这里开始了。

除了让它工作的一些问题（因为我需要`OrganizationRequests`从头开始创建），从该服务获取有意义的异常消息是一个大问题。SL 总是会很高兴地返回 404，这对用户毫无帮助。

我试过使用

```
WebRequest.RegisterPrefix("http://", System.Net.Browser.WebRequestCreator.ClientHttp);
WebRequest.RegisterPrefix("https://", System.Net.Browser.WebRequestCreator.ClientHttp); 
```

如[本文](http://msdn.microsoft.com/en-us/library/ee844556%28VS.95%29.aspx)所述，但结果证明在 IFD 和 ADFS 的一种情况下会导致问题（即使此解决方案在其他方面是完美的）。

如果出现错误，我确实需要能够为用户提供一些有意义的信息（“未找到”并不理想）。

我应该怎么做才能从 CRM 中获取一些有用的错误消息？

* * *

编辑：

请注意，我说的是组织服务，而不是 OData 服务！我可以从后者那里获得一些有用的信息来为用户显示。

我想指出这一点，因为[这个线程](http://social.microsoft.com/Forums/en-US/crmdevelopment/thread/853c3454-5d3c-4b48-8315-9824c9f28d6a)乍一看似乎很完美，但事实证明（鉴于已接受的答案）它一直是为 OData 服务的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:57:51.667

试试看微软的这篇[文章](http://msdn.microsoft.com/en-us/library/ee844556%28VS.95%29.aspx)，我没用过，不知道能不能用在CRM中。这是一篇非常有趣的文章，所以请看一看。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-19T15:18:44.037

在将 Silverlight 5 XAP 上传到 CRM 2011 Online 时，我遇到了类似的问题/错误。

为了获得有用的消息，在 IE 中打开 CRM 导航到您的 Silverlight 资源，按 F12 进入 IE 调试器，然后转到“网络”选项卡（见屏幕截图）。

希望这可以帮助！

![CRM 2011 在线 Silverlight 错误捕获](../Images/4c4633814b139851995a80c26d0c9f9b.png)

# php - cakephp 从控制器向库发送加密数据

> ID：15501374
> 
> 赞同：0
> 
> 时间：2013-03-19T13:51:50.807
> 
> 标签：php, cakephp

在使用 cakephp 时，我发现了下面提到的一个问题。

1.  从 DB 获取加密字段信息（使用 Security::rijndael 加密）
2.  将整个数据作为数组格式传递给自定义库（自己创建的库）。

当我在 lib 以及控制器中回显数据时，我惊讶地看到结果。该值（加密的）在库中显示为空白。我在编码中错过了什么吗？我在谷歌上搜索但没有得到满意的答案，请帮助我。您的帮助将不胜感激。

这是我分别进入控制器和库的结果

```
Array
(
    [0] => Array
        (
            [value] => s�i�(�RTf���cBЉF� | �r�n@ô�
        )
)

Array
(
    [0] => Array
        (
            [value] =>
        )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:54:51.320

检查您的字符编码；我工作的一个地方遇到了类似的问题，这是由于我们的数据库试图编码它不支持的字符。`UTF-8 generic`是一种通用的编码类型。

# android - 如何使用 iframe 在 webview android 中播放直播 url

> ID：15501377
> 
> 赞同：1
> 
> 时间：2013-03-19T13:51:58.450
> 
> 标签：android, iframe, webview, streaming, live

如何使用 iframe 在 webview 中加载 URL 流视频。这是我尝试过的

```
private WebView webview;

@SuppressWarnings("deprecation")
@SuppressLint("SetJavaScriptEnabled")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    webview=(WebView)findViewById(R.id.webView1);
    WebSettings webViewSettings = webview.getSettings();
    webViewSettings.setBuiltInZoomControls(true);
    webViewSettings.setPluginState(PluginState.ON);
    webview.loadUrl("file:///android_asset/frame.html");
} 
```

清单文件权限：

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/> 
```

使用启用的硬件加速

```
android:hardwareAccelerated="true" 
```

使用 IFRAME 的 HTML 代码

```
<html><body><iframe src="http://puthiyathalaimurai.tv/"></iframe></body</html> 
```

视频在 html 页面中播放，但没有在 android 应用程序中播放，谁能告诉我错误是什么。或者是什么问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:12:39.170

Android 缺乏对 HLS 的支持，如果这是您正在寻找的。有关不同设备中 HLS 流支持的详细信息，请查看[http://www.longtailvideo.com/html5/hls/](http://www.longtailvideo.com/html5/hls/)

**我不确定您的源 URL 正在使用什么协议进行流式传输，如果您能提供更清晰的信息，那就更好了。**

如果您正在查看 android 中的流式 HLS，您可以搜索一些替代的 3rd 方库或播放器来为您做同样的事情，或者您可以使用 FFMPEG 构建自己的播放器。

# forms - 在 iframe 中提交表单奇怪的结果

> ID：15501379
> 
> 赞同：1
> 
> 时间：2013-03-19T13:52:07.067
> 
> 标签：forms, iframe

我有这个测试页面，里面有一个 iframe。如果我在父页面表单上搜索某些内容（即 PR、IT），它会在 iframe 中触发结果，但有一个小问题，我们在左栏中没有正确的选项，即过滤选项（产生的工作数量，城市选择等）。如果我在 iframe 本身上搜索相同的东西，结果是正确的，我们可以过滤结果。我不明白我做错了什么。

这是在 iframe 中触发结果的父页面表单：

```
<form id="SearchForm" action="http://mysite.com/search-results-jobs/" target="my-iframe"   method="post">
    <input type="hidden" name="action" value="search" />
    <input type="hidden" name="listing_type[equal]" value="Job" />
            <label><strong>What?</strong>
<em>
<input type="text" value="job title, keywords or company name" 
onblur="if(this.value=='') this.value='job title, keywords or company name'" 
onFocus="if(this.value =='job title, keywords or company name' ) this.value=''" name="keywords   [all_words]" />

</em></label>

            <label><strong class="color">Where?</strong><b><input      type="text" value="city, state or zip code"  
onblur="if(this.value=='') this.value='city, state or zip code'" onFocus="if(this.value =='city, state or zip code' ) this.value=''" name="City[all_words]" /></b></label>

            <a href="#" class="SearchForm-link" onclick="one(); two();   three(); four();">Search</a>
        <input type="submit" id="btn-search" class="button"  value="Cauta"/></form> 
```

# kendo-ui - Kendo Grid - 如何停止或阻止数据绑定事件

> ID：15501380
> 
> 赞同：3
> 
> 时间：2013-03-19T13:52:08.803
> 
> 标签：kendo-ui, grid, datasource, databound

我的剑道网格是空的。然后我添加一行，输入值和调用`saveRow()`方法。这将根据我要清除添加（新）记录的消息调用控制器并返回消息。我用过的代码是： `grid.dataSource.data([]);`这段代码调用了两次数据绑定事件。我希望它只被调用一次，或者我不想调用数据绑定事件..但我必须清空网格。

请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T19:24:36.150

您好，您可以尝试使用 dataSource 的**requestEnd**事件 - 检查您返回的消息，防止 Grid 的下一个**dataBinding**并将数据再次设置为空数组。例如

```
function onRequestEnd(e){
     if()//some condition basedo on the e.response
     {
         $('#grid').data().kendoGrid.one('dataBinding',function(e){
                 e.preventDefault();
                 this.dataSource.data([]);
         })
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:44:56.733

您可以向数据源添加过滤器。使其过滤掉服务器发送的所有内容，并且您应该能够获得您正在寻找的行为。然后，您不必过多地处理事件或手动删除行。

此页面包含有关过滤数据源的一些信息：[kendo 数据源](http://docs.kendoui.com/api/framework/datasource)

希望这可以帮助！

# nosql - 如何定义一个可以过滤不同类型文档属性的 couchdb 视图？

> ID：15501390
> 
> 赞同：1
> 
> 时间：2013-03-19T13:52:42.470
> 
> 标签：nosql, couchdb

我在沙发数据库中有两种类型的文档。有事件和事件。一个事件有很多次发生。

**事件：**

```
{
  "_id": "49bb92b8896515a2994e524b38a041d3",
  "type": "Event",
  "eventID": 1234,
  "area": "m1"
} 
```

**发生：**

```
{
  "_id": "49bb92b8896515a2994e524b38a041d4",
  "type": "Occurence",
  "occurenceID": 7890,
  "eventID": 1234,
  "date": "2013-01-01"
} 
```

我需要找到按区域名称和日期范围过滤的每个日期的出现次数。在 SQL 中，我会使用这个查询：

```
SELECT Date, count(*)
FROM Event INNER JOIN Occurence ON Occurence.EventID = Event.EventID
WHERE Event.Area = "m1"
AND Occurence.Date BETWEEN '2013-01-01' AND '2013-02-01'
GROUP BY Date 
```

我不介意执行一个以上的查询，但我的数据库有超过 300,000 个出现文档（并且会增长 10 倍），所以我需要通过尽可能少的文档转移来获得结果。查询这个 couchdb 的应用程序是用 node.js 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:59:04.330

是的，我认为这需要两个查询才能正确。您应该考虑通过将事件区域复制到发生文档中来进行非规范化，这样会更容易。

# clearcase - 未注册视图列表

> ID：15501392
> 
> 赞同：1
> 
> 时间：2013-03-19T13:52:49.623
> 
> 标签：clearcase

我们有大量仍然有标签的未注册视图。我们希望删除这些标签和视图。有谁知道创建未使用标签注册的视图列表的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:59:13.020

One way is to compare the [view_tag](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_admin.doc/topics/c_rgy_data_tags_access_views.htm) and the [view_object](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_admin.doc/topics/c_rgy_data_objs.htm) files present in the [ClearCase registry](http://publib.boulder.ibm.com/infocenter/cchelp/v7r1m2/index.jsp?topic=/com.ibm.rational.clearcase.cc_admin.doc/topics/c_intro_hostadmin_data_rgy.htm).

Any view uuid found in view_object which isn't in view_tag is an unregistered view.

# java - 使用 minSdkVersion 管理 Android 项目中的“已弃用”警告

> ID：15501393
> 
> 赞同：11
> 
> 时间：2013-03-19T13:52:50.927
> 
> 标签：java, android, eclipse, adt, lint

我讨厌警告。我们的 Android 项目现在有 151 个，我敢肯定，在列表的某个地方，确实有一个可以警告我们注意潜在的麻烦。

其中一种警告是关于不推荐使用的字段和方法。这可能很有用，除了 Manifest 包含`<uses-sdk android:minSdkVersion="10" />`，并且这些警告仅考虑`target`SDK 是`android-17`.

将这些警告静音很容易——`@SuppressWarnings("deprecation")`在有问题的行或整个方法之前添加注释。但这忽略了它的全部要点 - 如果/当我们决定更改时`minSdkVersion="11"`，在第 10 级已弃用的 API 仍然不会出现，并且有人将不得不检查我们所有项目中的所有注释，以找到哪些代码必须被重写。

是否有一些解决方案可以根据我的**minSdkVersion**管理这些警告？

* * *

似乎在下面发布了一个有趣的答案，甚至根据我的问题[提出了一个功能请求的](https://code.google.com/p/android/issues/detail?id=53389)[Mark](https://stackoverflow.com/users/115145/commonsware)并不同意我关于**minSdkVersion**的重要性。他希望看到基于目标 API 级别的弃用警告（很可能来自 Lint，类似于注释）。但我不能同意这种做法。**`@TargetApi(NN)`**

 **考虑一个打开相机的简单应用程序。它可能要检查[预览帧速率](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#getPreviewFrameRate())。但这种方法在 API 9 中已被弃用，现在我们必须检查[预览 FPS 范围](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#getPreviewFpsRange())。如果我们使用`platforms/android-8/android.jar`，Java 编译器将不会显示弃用警告。

但它不会让我们找到[首选的视频分辨率](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#getPreferredPreviewSizeForVideo())，即使应用程序运行在支持此类查询的设备上也是如此。我们可能会在`@TargetApi(11)`那里添加注释，以确保应用程序是使用`platforms/android-11/android.jar`或更高版本构建的。

现在我们有了目标**Honeycomb**和更高版本，将显示~~getPreviewFrameRate()~~的弃用警告，这正是困扰我的地方。有一段时间，我想象的应用程序必须支持一些**Froyo**设备，因此我别无选择，只能设置`minSdkVersion=8`和使用不推荐使用的方法。自然，我会在条件块中使用任何高级 API，并准备`@TargetApi(NN)`好。*幸运的是，对于**Donut**及更高版本，当检测到对不存在的方法或成员的调用时，类加载器不会崩溃，并且仅将有问题的调用包装在**if()**中就足够了。*

那我该怎么办？添加对~~getPreviewFrameRate()~~`@SuppressWarnings("deprecation")`的调用以使警告静音？改为添加？~~`@SuppressDeprecation(8)`~~

 ~~但在某些时候，我会决定与 Froyo 的向后兼容性不再重要。我在我的 Manifest 中设置了，但是~~getPreviewFrameRate()~~`<uses-sdk android:minSdkVersion="9" />`的弃用警告仍然被抑制......嗯，新方法肯定比现有的注释更好，因为在 Manifest 中进行更改后，整个项目更容易。~~`grep -R "@SuppressDeprecation(8)"`~~

 ~~但我更喜欢这里更紧密的集成：让 Lint 为我解析 Manifest 文件。

现在这是否更有意义？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T13:57:53.937

> 是否有一些解决方案可以根据我的 minSdkVersion 管理这些警告？

不，因为弃用与`android:minSdkVersion`.

如果您真的担心这一点，请将已弃用的内容隔离到它们自己的方法中，以最大程度地减少您的注释掩盖您不知道的未来弃用的可能性。

不完全不可能的是`@SuppressDeprecation(NN)`注释，它将抑制对给定构建目标的弃用。这类似于如何`@TargetApi(NN)`抑制给定的 Lint 投诉`android:minSdkVersion`。我已经[为此提交了功能请求](https://code.google.com/p/android/issues/detail?id=53389)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T12:15:16.780

实际上有一个功能请求：[https](https://code.google.com/p/android/issues/detail?id=41318) ://code.google.com/p/android/issues/detail?id= 41318 于 2012 年 12 月 12 日提交。~~~~**

# java - 在 Java EE 系统中编写静态实用程序类

> ID：15501396
> 
> 赞同：3
> 
> 时间：2013-03-19T13:52:59.603
> 
> 标签：java, jsp, jakarta-ee, servlets, ejb

我想为企业 Java 系统（JSP、Servlet、EJB）开发一个可以以静态方式（静态方法）使用的实用程序类。它包含一些能够访问`HttpSession`用户对象并检索一些已经存储为属性的有用信息（例如当前用户ID）的方法。

你们中的一些人可能想知道为什么我需要这样的东西，而我可以简单地将`HttpSession`对象传递到任何地方。实际上，我正在开发一个遗留的 Java EE 5.0 系统，并且一些实用程序类（不是 Servlet、JSP 或 EJB）无法访问该`HttpSession`对象。

是否可以实现这样的实用程序类？我/你应该在这里考虑一些限制：

*   servlet/JSP 托管在与托管 EJB 不同的机器上。
*   系统在 Weblogic 10.3.0 上运行。
*   在 weblogic 上，有许多服务器（托管 servlet/JSP）并且它们在同一个集群下。EJB 服务器也是如此。
*   如果我在实用程序类中声明一些静态`Collection`，它会起作用吗？或者由于多个类加载器和多个 JVM 可能会有不止一个副本？
*   也许我应该使用共享文件或共享数据库来实现它？我什至怎么能跟踪哪个用户调用了实用程序类？也许跟踪线程？或者可能与交易有关的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T14:11:53.300

利用[`ThreadLocal`](http://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html). 您不应该`HttpSession`直接将其存储在那里。`javax.servlet`服务层不应该对API有任何依赖。相反，从直接提取所需信息`HttpSession`并将其存储在那里。

例如，当您想将`User`的属性公开`HttpSession`为线程局部变量时：

```
public class SomeContext {

    private static ThreadLocal<SomeContext> instance = new ThreadLocal<SomeContext>();
    private User user;

    private SomeContext(User user) {
        this.user = user;
    }

    public static SomeContext getCurrentInstance() {
        return instance.get();
    }

    public static SomeContext newInstance(User user) {
        SomeContext someContext = new SomeContext(user);
        instance.set(someContext);
        return someContext;
    }

    public void release() {
        instance.remove();
    }

    public User getUser() {
        return user;
    }

} 
```

这在`doFilter()`一个[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)中：

```
User user = (User) request.getSession().getAttribute("user");
SomeContext someContext = SomeContext.newInstance(user);

try {
    chain.doFilter(request, response);
} finally {
    // It's very important to do this in finally!
    // Threads are namely pooled by the container.
    someContext.release();
} 
```

在特定过滤器之后在同一线程中运行的任何代码中，包括 EJB，您可以获得`User`如下内容：

```
User user = SomeContext.getCurrentInstance().getUser();
// ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:58:47.383

HttpSession 是线程本地的。

你真的需要一个 HttpSession 还是你可以用一个静态的 ThreadLocal 属性做你想做的事？

请参阅：[http ://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)

顺便说一句，Apache Shiro 使用这个类来存储一些“会话”信息。

# sql - 调用一个存储过程，进入另一个存储过程

> ID：15501397
> 
> 赞同：0
> 
> 时间：2013-03-19T13:53:04.833
> 
> 标签：sql, oracle, stored-procedures, oracle-sqldeveloper

我有一个程序，在我的一个表中插入一行。

在过程中插入之后，我想将所有行都找到另一个表，然后，调用第二个表的插入过程。

所以我有所有第一个工作正常的程序

```
P_INSERT_TABLE1

INSERT INTO TABLE1

...
COMMIT;

FOR record_po IN (SELECT C3, ...
                    FROM T_TABLE2
                    WHERE id = v_id)
LOOP
      P_INSERT_TABLE2(record_po.C3, ...);
END LOOP; 
```

P_INSERT_TABLE2 的所有“in 参数”都是 VARCHAR2，所以我为每列创建一个“to_char”不是 varchar2：

```
P_INSERT_TABLE2(pi_id,
                      record_po.C3,
                      record_po.C4,
                      record_po.C5,
                      record_po.C6,
                      record_po.C7,
                      to_char(record_po.C8, 'DD/MM/YYYY'); 
```

这里，pi_id 是 VARCHAR2 中 P_INSERT_TABLE1 的 in 参数之一。

所以现在，我有这个错误信息：

```
Erreur(357,1): PLS-00306: number or args types wrong in the call of P_INSERT_TABLE2 
```

我不明白，为什么 P_INSERT_TABLE2 不接受参数，而所有好的类型都按好顺序？

如果我将程序称为“ `call P_INSERT_TABLE2(...)`”，则会出现以下错误：

```
Erreur(357,9): PLS-00103: Symbol "P_INSERT_TABLE2" instead one of this symbols :     := . ( @ % ; immediate Symbole ":=" 

create or replace
PROCEDURE P_INSERT_TABLE2 (
  pi_id          IN VARCHAR2
  ,pi_C3         IN VARCHAR2
  ,pi_C4         IN VARCHAR2
  ,pi_C5         IN VARCHAR2
  ,pi_C6         IN VARCHAR2
  ,pi_C7         IN VARCHAR2
  ,pi_C8         IN VARCHAR2
  ,pmessage      OUT NOCOPY VARCHAR2  
) 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:24:04.533

的声明`P_INSERT_TABLE2`无效。您不能将 5 个输入参数全部命名为`pi_C4`. 由于您在创建该过程时没有遇到编译错误，我猜这是一个在此处发布问题时引入的错误，而不是代码中实际存在的问题。

根据 的声明`P_INSERT_TABLE2`，该过程有 7 个输入参数和 1 个输出参数。在您发布的代码中，您似乎传递了 7 个输入参数，但您没有传递输出参数的变量。看来您需要类似的东西

```
P_INSERT_TABLE2(pi_id,
                record_po.C3,
                record_po.C4,
                record_po.C5,
                record_po.C6,
                record_po.C7,
                to_char(record_po.C8, 'DD/MM/YYYY'),
                <<some local variable for the output parameter>> ); 
```

`DATE`除了语法错误之外，当我看到有人把一个非常好的. 转换成一个字符串，然后将它传递给一个过程时，我非常怀疑。这意味着要么`P_INSERT_TABLE2`将转身并将字符串转换回日期，这意味着您正在做额外的工作并引入了转换可能失败的额外点，或者您将编写一个字符串表示日期到一张桌子。这些影响都不好。

我也非常怀疑任何具有`OUT`名为`pMessage`. 这往往意味着您没有正确使用异常，并且如果您的代码遇到错误，您将返回错误消息而不是抛出异常。与使用适当的异常相比，这实际上总是会导致更脆弱的代码更难调试。

# c# - 在 C# 中将列表控件添加到面板

> ID：15501398
> 
> 赞同：0
> 
> 时间：2013-03-19T13:53:07.037
> 
> 标签：c#, asp.net

我有一个面板。在我的数据库中，我有一个人员列表。对于运行时的每个人，我在他们下面添加不同的属性。我希望所有的人都被列为一个列表（每个人的单独列表）。我稍后会添加值。

这是我的 .aspx 代码

```
 <asp:Panel ID="DR_list" runat="server" Direction="LeftToRight" Height="227px" 
        HorizontalAlign="Center" ScrollBars="Horizontal" Wrap="False">
        <asp:ListView >
        </asp:ListView>
    </asp:Panel> 
```

我的 C# 代码是

```
 SqlDataReader myReader = null;
         SqlCommand myCommand = new SqlCommand("select drname from --- ",
                                                  myConnection);
         myReader = myCommand.ExecuteReader();
         while (myReader.Read())
         {
             //Response.Write(myReader["DrName"].ToString());
             int tRows;  
               int tCells;
             List<string> DrNames = new List<string>();

             for (tCells = 0; tCells < 4; tCells++)
              {
                  string a = myReader["DrName"].ToString();
                  Response.Write(a);
                    DrNames.Add(a);

              }

             DR_list.Controls.Add(DrNames);

         }
     } 
```

请帮助我..提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:09:08.587

我建议您将 runat="server" 添加到面板中，以便添加此数据，但将数据添加到循环结构的末尾

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:19:00.680

您是否按照人们的建议尝试过？

```
 SqlDataReader myReader = null;
         SqlCommand myCommand = new SqlCommand("select drname from --- ",
                                                  myConnection);
         myReader = myCommand.ExecuteReader();
         while (myReader.Read())
         {
             //Response.Write(myReader["DrName"].ToString());
             int tRows;  
               int tCells;
             List<string> DrNames = new List<string>();

             for (tCells = 0; tCells < 4; tCells++)
              {
                  string a = myReader["DrName"].ToString();
                  Response.Write(a);
                    DrNames.Add(a);
              }
             //adding list box to the panel
             yourPanel.Controls.Add(new ListBox(){/*set id to the list here*/});

             DR_list.Controls.Add(DrNames);

         }
     } 
```

# sql-server - 报告服务 URL HTTP 500 错误

> ID：15501401
> 
> 赞同：2
> 
> 时间：2013-03-19T13:53:13.850
> 
> 标签：sql-server, sql-server-2008, reporting-services

我在连接到 URL 时遇到问题`http://<server name>/reports`。我收到 HTTP 500 内部服务器错误。但以下 URL 有效。 `http://<server name>/reportServer`. 你能告诉我可能是什么问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T16:01:56.810

从评论转向答案 - 问题是[此处描述的 FIPS 政策](http://andysal.wordpress.com/2012/02/20/sql-reporting-services-srs-rp-http-500-error-when-browsing-reports-site/)

此外，对于一般情况，包括指向[SSRS 跟踪的链接](http://msdn.microsoft.com/en-us/library/ms156500%28v=sql.100%29.aspx)

# asp.net - ASP.NET：使用自定义 SEO 重定向 HttpModule 重定向循环

> ID：15501407
> 
> 赞同：1
> 
> 时间：2013-03-19T13:53:31.630
> 
> 标签：asp.net, redirect, http-status-code-301, infinite-loop, httpmodule

我编写了附加在 BeginRequest 上的 httpModule 来处理 SEO URL 转换和 301 重定向。大多数事情都可以通过 URL 重写来完成，但我想要一个更灵活的选项，并且 URL 重写会为每个转换发出多个重定向（添加“www”是重定向，切换到小写 URL 是另一个，添加尾随“ /” 另一个等等...），而我的 httpModule 检查所有条件（包括 http/https，如果页面必须是安全的），转换 URL，然后执行单个 301 重定向。

我面临的问题是……似乎 IIS 7.5 在请求[http://www.example.com/mydir/](http://www.example.com/mydir/)时会在 http://www.example.com/mydir/default 内部进行转换[。 aspx](http://www.example.com/mydir/default.aspx)并且这会触发我的模块的无限循环，该模块试图删除“default.aspx”部分并永久重定向到[http://www.example.com/mydir/](http://www.example.com/mydir/)

在我的模块中 BeginRequest 发生的事情非常简单。对于每个请求，我调用一个函数 CheckRedirects() 来检查所有规则，如果不需要重定向，则返回一个空字符串，如果需要执行重定向，则返回经过清理的 url。

我不知道哪个默认模块执行此“内部”重定向，这实际上不是真正的重定向，因为如果您在访问[http://www.example.com/mydir/](http://www.example.com/mydir/)时检查网络上发生的情况，则没有重定向到[http://www.example.com/mydir/default.aspx](http://www.example.com/mydir/default.aspx)，所以只是一种“内部”重定向，但是它弄乱了我的模块，创建了一个无限循环

我访问当前的请求 URL

```
Dim request As HttpRequest = HttpContext.Current.Request
Dim url As System.Uri = request.Url 
```

编辑：作为旁注，如果我使用 URL Rewrite 2.0 模块进行相同的重定向，则不会触发无限循环。这让我认为 URL Rewrite 2.0 模块在 IIS 模块链中，在执行内部“default.aspx”模块之前。URL 重写的规则是：

```
<system.webServer>
    <rewrite>
      <rules>
        <rule name="Default Document" stopProcessing="true">
          <match url="(.*)default.aspx" />
          <action type="Redirect" url="{R:1}" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
</system.webServer> 
```

问题是，如果我将 URL Rewrite 和我的自定义 HttpModule 混合在一起，我最终会得到多个相同的重定向......只需考虑一个简单的场景[http://example.com/defaultp.aspx](http://example.com/defaultp.aspx) 这将最终得到 2 个重定向，一个从 URL 重写模块中删除“default.aspx”，然后从我的自定义 HttpModule 中删除另一个将添加“www”的模块。

# c# - 如何在 dot net 下获得可靠/一致的最大内存使用结果

> ID：15501408
> 
> 赞同：1
> 
> 时间：2013-03-19T13:53:34.237
> 
> 标签：c#, .net, memory, performance-testing

我们有各种测试来监控我们的应用程序（或子组件）在各种场景下的内存使用情况，以检查回归。问题是我们的测量值（使用`Process.Refresh(); Process.PrivateMemorySize64`）在不同的运行中波动很大。

我们目前正在做的是每`X`毫秒通过后台线程轮询一次。我们将达到的最大值与基准进行比较，并相应地通过/失败。

有趣的是，减少轮询之间的时间会显着降低记录的最大内存值。在一个示例中，每 100 毫秒读取一次内存最大为 360MB，每 10 毫秒为 147MB，每 1 毫秒为 35 毫秒。据推测，观察次数的增加以某种方式使 GC 行为更具攻击性。

我想主要问题是我们试图测量的“最大内存使用量”并没有特别明确的定义。如果有足够的可用内存，GC 可能不会启动，因此内存使用率会显得更高。

是否有一种标准的方法来测量 dot net 下的内存使用情况以防止性能下降？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:15:55.313

> 我想主要问题是我们试图测量的“最大内存使用量”并没有特别明确的定义。如果有足够的可用内存，GC 可能不会启动，因此内存使用率会显得更高。

这是你的问题。垃圾收集运行时在可用时会使用更多内存并不是任意的。当这些算法有*更大*的内存空间可以“玩耍”时，它们的性能要好得多。为了客观分析，您*必须*使用工具仅分析不受垃圾收集行为影响的可达集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:05:44.187

您可以使用`PerformanceCounter class`来衡量您的内存使用情况

链接：http: [//msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)

手动你可以`Memory Profiler tool`用来检查你的记忆

链接： http: [//memprofiler.com/](http://memprofiler.com/)

# cocoa - 主窗口在 Snow Leopard 上无法正常运行

> ID：15501409
> 
> 赞同：0
> 
> 时间：2013-03-19T13:53:35.683
> 
> 标签：cocoa, debugging, osx-snow-leopard, orsserialport

我在 Mountain Lion 上使用 Xcode 4.5 开发的应用程序可以在 Lion 和 ML 上完美运行。

我的雪豹测试仪报告说，当应用程序启动时，它被禁用。他的意思是没有任何控件处于活动状态，红色、黄色、绿色的“交通灯”变灰。如果打开了覆盖我的应用程序的另一个应用程序，则在移动覆盖应用程序时，它所覆盖的任何控件或控件的一部分都不存在。

菜单栏是响应式的，我的首选项面板有效。该应用程序可以从菜单关闭，我不知道它是否可以从键盘关闭。

另一个使用相同序列号的应用程序可以正常工作。

我需要帮助制定解决方案。我不知道如何追踪这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:34:45.553

从根本上说，问题在于您希望数据位于 NSUserDefaults 中。在第一次启动时，NSUserDefaults 为您访问的键返回 nil，并且通过后面的代码传递这个 nil 结果会导致抛出异常。解决方案是在应用程序启动时使用 NSUserDefaults 注册默认值：

```
@implementation AppController
+ (void)initialize
{
    NSDictionary *defaultValues = @{@"SomeKey" : @"DefaultValue"};
    [[NSUserDefaults standardUserDefaults] registerDefaults:defaultValues];
}
@end 
```

# android - 更改 ExpandableListView 中的可扩展指示器

> ID：15501413
> 
> 赞同：48
> 
> 时间：2013-03-19T13:53:41.150
> 
> 标签：android, listview, expandablelistview

试图创建一个 ExpandableListView。组的初始视图显示良好。但是，当我单击列表项时，我的箭头不会改变。请参阅下面的图片。

![在此处输入图像描述](../Images/789ba84274999c694689d651e2763eb0.png)

如何更改箭头的方向？

布局 XML：

```
 <ExpandableListView
        android:id="@+id/expandable_list"
        android:layout_width="fill_parent"
        android:layout_height="match_parent"            
        android:divider="@null"
        android:background="#ffffff"
        android:groupIndicator="@drawable/settings_selector"
        android:transcriptMode="alwaysScroll" /> 
```

**settings_selector.xml**：

```
 <?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" >

<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:drawable="@drawable/arrow_down"
        android:state_empty="true"/>
    <item
        android:drawable="@drawable/arrow_right"
        android:state_expanded="true"/>
</selector>

</animation-list> 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-20T08:37:38.173

可展开的列表视图

```
 <ExpandableListView
    android:id="@+id/expandable_list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:groupIndicator="@drawable/group_indicator"
    android:transcriptMode="alwaysScroll" /> 
```

`setindicator`这里我正在使用这样的 setindicator 代码，这很好用

```
 DisplayMetrics metrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(metrics);
    int width = metrics.widthPixels; 

 mExpandableList = (ExpandableListView)findViewById(R.id.expandable_list);
 mExpandableList.setIndicatorBounds(width - GetPixelFromDips(50), width - GetPixelFromDips(10));  

   public int GetPixelFromDips(float pixels) {
    // Get the screen's density scale 
    final float scale = getResources().getDisplayMetrics().density;
    // Convert the dps to pixels, based on density scale
    return (int) (pixels * scale + 0.5f);
} 
```

res/drawable/group_indicator

```
 <?xml version="1.0" encoding="utf-8"?>

     <selector xmlns:android="http://schemas.android.com/apk/res/android">            
           <item android:drawable="@drawable/arrow_right" android:state_empty="true">  </item>            
           <item android:drawable="@drawable/arrow_down" android:state_expanded="true"></item>                
           <item android:drawable="@drawable/arrow_right"></item>
     </selector> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-03-20T08:02:21.673

试试你的`settings_selector.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:drawable="@drawable/arrow_right"
        android:state_expanded="true" />

    <item
        android:drawable="@drawable/arrow_down" />

</selector> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-05-12T08:13:57.377

我采取了以下方式：根据 isExpanded 标志为您的 groupView 决定左/右可绘制对象。
通过这种方式，我们可以更轻松地自定义可绘制指标的填充/背景和其他内容。

希望能帮助到你。

```
 public View getGroupView(int groupPosition, boolean isExpanded, View convertView,
            ViewGroup parent) {
        TextView textView = (TextView) mLayoutInflater.inflate(R.layout.menu_group, null);
        textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, isExpanded ? 0 : android.R.drawable.ic_menu_more, 0);
        textView.setText(getGroup(groupPosition).toString());
        return textView;
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-20T06:17:01.517

```
import java.util.ArrayList;

import android.app.Activity;
import android.content.Context;
import android.database.DataSetObserver;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.ExpandableListView;
import android.widget.TextView;

public class MyActivity extends Activity {

    private ExpandableListView mExpandableList;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_my);

        mExpandableList = (ExpandableListView)findViewById(R.id.expandable_list);
        mExpandableList.setGroupIndicator(null);
        ArrayList<Parent> arrayParents = new ArrayList<Parent>();
        ArrayList<String> arrayChildren = new ArrayList<String>();

        //here we set the parents and the children
        for (int i = 0; i < 10; i++){
            //for each "i" create a new Parent object to set the title and the children
            Parent parent = new Parent();
            parent.setTitle("Parent " + i);

            arrayChildren = new ArrayList<String>();
            for (int j = 0; j < 10; j++) {
                arrayChildren.add("Child " + j);
            }
            parent.setArrayChildren(arrayChildren);

            //in this array we add the Parent object. We will use the arrayParents at the setAdapter
            arrayParents.add(parent);
        }

        //sets the adapter that provides data to the list.
        mExpandableList.setAdapter(new MyCustomAdapter(MyActivity.this,arrayParents));

    }

    public class Parent {
        private String mTitle;
        private ArrayList<String> mArrayChildren;

        public String getTitle() {
            return mTitle;
        }

        public void setTitle(String mTitle) {
            this.mTitle = mTitle;
        }

        public ArrayList<String> getArrayChildren() {
            return mArrayChildren;
        }

        public void setArrayChildren(ArrayList<String> mArrayChildren) {
            this.mArrayChildren = mArrayChildren;
        }
    }

    public class MyCustomAdapter extends BaseExpandableListAdapter implements OnClickListener{

        private LayoutInflater inflater;
        private ArrayList<Parent> mParent;

        public MyCustomAdapter(Context context, ArrayList<Parent> parent){
            mParent = parent;
            inflater = LayoutInflater.from(context);
        }

        @Override
        //counts the number of group/parent items so the list knows how many times calls getGroupView() method
        public int getGroupCount() {
            return mParent.size();
        }

        @Override
        //counts the number of children items so the list knows how many times calls getChildView() method
        public int getChildrenCount(int i) {
            return mParent.get(i).getArrayChildren().size();
        }

        @Override
        //gets the title of each parent/group
        public Object getGroup(int i) {
            return mParent.get(i).getTitle();
        }

        @Override
        //gets the name of each item
        public Object getChild(int i, int i1) {
            return mParent.get(i).getArrayChildren().get(i1);
        }

        @Override
        public long getGroupId(int i) {
            return i;
        }

        @Override
        public long getChildId(int i, int i1) {
            return i1;
        }

        @Override
        public boolean hasStableIds() {
            return true;
        }

        @Override
        //in this method you must set the text to see the parent/group on the list
        public View getGroupView(int i, boolean b, View view, ViewGroup viewGroup) {

            if (view == null) {
                view = inflater.inflate(R.layout.list_item_parent, viewGroup,false);
            }
            view.findViewById(R.id.button).setTag(i);
            view.findViewById(R.id.button).setOnClickListener(this);
            TextView textView = (TextView) view.findViewById(R.id.list_item_text_view);
            //"i" is the position of the parent/group in the list
            textView.setText(getGroup(i).toString());

            //return the entire view
            return view;
        }

        @Override
        //in this method you must set the text to see the children on the list
        public View getChildView(int i, int i1, boolean b, View view, ViewGroup viewGroup) {
            if (view == null) {
                view = inflater.inflate(R.layout.list_item_child, viewGroup,false);
            }

            TextView textView = (TextView) view.findViewById(R.id.list_item_text_child);
            //"i" is the position of the parent/group in the list and
            //"i1" is the position of the child
            textView.setText(mParent.get(i).getArrayChildren().get(i1));

            //return the entire view
            return view;
        }

        @Override
        public boolean isChildSelectable(int i, int i1) {
            return true;
        }

        @Override
        public void registerDataSetObserver(DataSetObserver observer) {
            /* used to make the notifyDataSetChanged() method work */
            super.registerDataSetObserver(observer);
        }

        /* (non-Javadoc)
         * @see android.view.View.OnClickListener#onClick(android.view.View)
         * @since Mar 20, 2013
         * @author rajeshcp 
         */
        @Override
        public void onClick(View v) {
            if(mExpandableList.isGroupExpanded((Integer)v.getTag()))
        {
            mExpandableList.collapseGroup((Integer)v.getTag());
        }else
        {
            mExpandableList.expandGroup((Integer)v.getTag());
        }
        }
    }

} 
```

像这样改变你的`MyActivity`，让我知道你还想要什么？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-31T16:05:13.063

学科：

```
 int width = getResources().getDisplayMetrics().widthPixels;
    if (android.os.Build.VERSION.SDK_INT < android.os.Build.VERSION_CODES.JELLY_BEAN_MR2) {
        listView.setIndicatorBounds(width - getPixelValue(40), width - getPixelValue(10));
    } else {
        listView.setIndicatorBoundsRelative(width - getPixelValue(40), width - getPixelValue(10));
    } 
```

和辅助方法：

```
public static int getPixelValue(int dp) {

    final float scale = getResources().getDisplayMetrics().density;
    return (int) (dp * scale + 0.5f);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-03T06:10:39.990

只需在组项示例的 xml 中您想要的任何位置创建一个视图/图像视图：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/parent_group"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:padding="10dp">

<ImageView
    android:id="@+id/expandable_icon"
    android:layout_width="25dp"
    android:layout_height="25dp"
    android:layout_marginTop="6dp"
    android:src="@drawable/group_icon_not_expanded" />

<TextView
    android:id="@+id/group_name"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginLeft="10dp"
    android:fontFamily="@font/roboto_thin"
    android:textColor="@android:color/black"
    android:textSize="17sp" /> 
```

然后为您的 ExpandableListView 使用 GroupClickListener 以编程方式更改 ImageView 的图像，例如：

```
listView.setOnGroupClickListener(new ExpandableListView.OnGroupClickListener() {
        @Override
        public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) {
            parent.smoothScrollToPosition(groupPosition);

            if (parent.isGroupExpanded(groupPosition)) {
                ImageView imageView = v.findViewById(R.id.expandable_icon);
                imageView.setImageDrawable(getResources().getDrawable(R.drawable.group_icon_not_expanded));
            } else {
                ImageView imageView = v.findViewById(R.id.expandable_icon);
                imageView.setImageDrawable(getResources().getDrawable(R.drawable.group_icon_expanded));
            }
            return false    ;
        }
    }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-08-19T08:24:25.230

我参加聚会有点晚了，但我的要求与此类似，但有所不同。

[![在此处输入图像描述](../Images/27583987152992497015b56c9881603f.png)](https://i.stack.imgur.com/nBa3k.png)

我有 3 个要求：

1.  如果一个组有孩子，则显示 down_arrow (V)
2.  如果一个组没有孩子，则没有箭头/图像
3.  如果一个有孩子的组展开然后显示 up_arrow (^)

要实现与此类似的目标：

1.  您`ExpandableListView`将看起来与此类似，但为`android:groupIndicator`null

    ```
     <ExpandableListView
     android:id="@+id/expandableListView"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:divider="@android:color/darker_gray"
     android:dividerHeight="0.5dp"
     android:groupIndicator="@null" /> 
    ```

2.  您的组/标题布局将如下所示，最后带有文本和图像：

```
<androidx.appcompat.widget.AppCompatImageView
    android:id="@+id/ivDrawerHeaderItemIcon"
    android:layout_width="@dimen/dp_30"
    android:layout_height="@dimen/dp_30"
    android:layout_gravity="center_vertical"
    android:layout_marginStart="@dimen/dp_10"
    android:layout_marginEnd="@dimen/dp_10"
    android:src="@drawable/switch" />

<androidx.appcompat.widget.AppCompatTextView
    android:id="@+id/lblListHeader"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_margin="@dimen/dp_5"
    android:layout_weight="1"
    android:fontFamily="@font/roboto_condensed_regular"
    android:gravity="center_vertical"
    android:padding="@dimen/dp_10"
    android:textAllCaps="true"
    android:textColor="@android:color/white"
    android:textSize="@dimen/sp_16" />

<androidx.appcompat.widget.AppCompatImageView
    android:id="@+id/ivIcon"
    android:layout_width="@dimen/dp_15"
    android:layout_height="@dimen/dp_15"
    android:layout_gravity="center_vertical"
    android:layout_marginStart="@dimen/dp_10"
    android:layout_marginEnd="@dimen/dp_10" /> 
```

3.  在你`BaseExpandableListAdapter`的`getGroupView()`方法中，使用

    ```
     if (Objects.requireNonNull(expandableListDetail.get(expandableListTitle.get(listPosition))).size() > 0) {
         if (isExpanded) {
             ivIcon.setImageResource(R.drawable.arrow_up);
         } else {
             ivIcon.setImageResource(R.drawable.arrow_down);
         }
     } 
    ```

哪里，`expandableListTitle`是组，`expandableListDetail`是它的孩子

# mysql - 基于客户的待处理金额总和，每行显示

> ID：15501415
> 
> 赞同：0
> 
> 时间：2013-03-19T13:53:46.593
> 
> 标签：mysql

我希望显示所有待处理发票的详细信息以及一个显示特定客户的待处理发票总数的列，但我无法找到一种方法来做同样的事情。这是我正在尝试做的事情：

```
+----------+------------+---------------+---------------+
| Customer | Invoice No | Peding Amount | Total Pending |
+----------+------------+---------------+---------------+
| A        |          1 |            10 |          1110 |
| B        |          2 |           100 |           110 |
| C        |          3 |          1000 |          3020 |
| A        |          4 |          1000 |          1110 |
| A        |          5 |           100 |          1110 |
| B        |          6 |            10 |           110 |
| C        |          7 |          2000 |          3020 |
| C        |          8 |            20 |          3020 |
+----------+------------+---------------+---------------+ 
```

现在我想通知该表只有前 3 列，但我需要添加第 4 列，但我无法找到根据客户求和的方法。

这是我尝试使用的代码，但我得到了某种语法。

```
select 
 `tabSales Invoice`.`posting_date` as "Invoice Date:Date:80",
 `tabSales Invoice`.`due_date` as "Due Date:Date:80",
 `tabSales Invoice`.`name` as "Invoice No:Link/Sales Invoice:120",
 `tabSales Invoice`.`customer` as "Customer:Link/Customer:180",
 `tabSales Invoice`.`grand_total` as "Total:Currency:140",
 `tabSales Invoice`.`outstanding_amount` as "Pending:Currency:140",
 datediff(curdate(),`tabSales Invoice`.`posting_date`) as "Over By Invoice Date:Float:80",
 datediff(curdate(),`tabSales Invoice`.`due_date`) as "Over By Due Date:Float:80",
 `tabSales Invoice`.`debit_to` as "Customer Account:Link/Account:200"
from
 `tabSales Invoice`
where
 `tabSales Invoice`.`docstatus` = 1
 and `tabSales Invoice`.`outstanding_amount` > 0.005

Inner join(
    Select 
    `tabSales Invoice`.`customer`,
    SUM(`tabSales Invoice`.`outstanding_amount`) AS "Total Pending::180"
    from
     `tabSales Invoice`
     Group By
      `tabSales Invoice`.`customer`) 
     `tabSales Invoice` ON `tabSales Invoice`.`customer` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:46:10.817

考虑这个例子......

```
 DROP TABLE IF EXISTS my_table;

 CREATE TABLE my_table
 (Customer CHAR(1) NOT NULL
 ,Invoice_No INT NOT NULL
 ,Pending_Amount INT NOT NULL
 ,PRIMARY KEY(Customer,Invoice_No)
 );

 INSERT INTO my_table VALUES
 ('A',1,10),
 ('B',2,100),
 ('C',3,1000,
 ('A',4,1000),
 ('A',5,100),
 ('B',6,10),
 ('C',7,2000),
 ('C',8,20);

 SELECT x.*
      , SUM(y.Pending_Amount) Total_Pending 
   FROM my_table x 
   JOIN my_table y 
     ON y.customer = x.customer 
  GROUP 
     BY x.customer
      , x.invoice_no;
 +----------+------------+----------------+---------------+
 | Customer | Invoice_No | Pending_Amount | Total_Pending |
 +----------+------------+----------------+---------------+
 | A        |          1 |             10 |          1110 |
 | A        |          4 |           1000 |          1110 |
 | A        |          5 |            100 |          1110 |
 | B        |          2 |            100 |           110 |
 | B        |          6 |             10 |           110 |
 | C        |          3 |           1000 |          3020 |
 | C        |          7 |           2000 |          3020 |
 | C        |          8 |             20 |          3020 |
 +----------+------------+----------------+---------------+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:59:03.207

您可以使用子查询

```
SELECT customer, invoiceno, pendingamount, pending
FROM mytable 
    INNER JOIN (
    SELECT customer, SUM(pendingamount) AS pending
    FROM mytable
    GROUP BY customer) a on mytable.customer ON a.customer 
```

# c# - 使用 DataTable/DataSet 进行 ListView 分页/排序

> ID：15501417
> 
> 赞同：0
> 
> 时间：2013-03-19T13:53:52.510
> 
> 标签：c#, asp.net, listview, sorting, paging

我正在将 ListView 与数据表绑定。**最初**我在

ListView1_PreRender(object sender, EventArgs e) 带有一些默认值。

```
protected void loadListView(int pageSize, int pageNumber, string sortExp)
    {
       ...After the necessary logic
        ListView1.DataSource = ds.Tables[0];
        ListView1.DataBind();
    } 
```

我已将 DataPager 放在 ListView 控件中。

```
<asp:DataPager ID="dataPagerNumeric" runat="server" PageSize="5" PagedControlID="ListView1">
                        <Fields>
                            <asp:NumericPagerField ButtonCount="5" NumericButtonCssClass="numeric_button" CurrentPageLabelCssClass="current_page"
                                NextPreviousButtonCssClass="next_button" />
                        </Fields>
                    </asp:DataPager> 
```

我如何使用这种方法实现排序/分页。

我编写了一个存储过程，在其中传递了 3 个参数。PageSize 、 PageNumber 和排序表达式。从那里我得到 DataTable 并将其绑定到 ListView。我如何在页面排序事件和 Datapager PageChange 事件中调用它

# jquery - 循环遍历 json 结果

> ID：15501419
> 
> 赞同：0
> 
> 时间：2013-03-19T13:54:00.550
> 
> 标签：jquery

我从服务器中提取了一些 JSON 结果。我想做的是遍历前三个，创建一些 HTML，然后为接下来的三个创建相同的内容。

我所拥有的是：

```
$.getJSON(url, function(data){                               

           var sliderHTML = "";

           $.each(data.collection.products, function(index, product){  

             sliderHTML += '<div class="rsContent">';
             sliderHTML += '<a class="rsLink" href="'+product.url+'">'+product.title+'</a>';  
             sliderHTML += '<img class="rsImg" src="'+image+'" />';   
             sliderHTML += '</div>';

       }); 
```

所以每个循环都必须创建一个包含三个图像和链接的 DIV rsContent。之后，它必须创建一个包含 3 个新图像和链接的新 DIV rsContent。等等。它应该如下所示：

```
<div class="rsContent">
  <a class="rsLink" href="">product</a>  // product 1
  <img class="rsImg" src="" />

  <a class="rsLink" href="">product</a>  // product 2
  <img class="rsImg" src="" />

  <a class="rsLink" href="">product</a>  // product 3
  <img class="rsImg" src="" />
</div>

<div class="rsContent">
  <a class="rsLink" href="">product</a>  // product 1
  <img class="rsImg" src="" />

  <a class="rsLink" href="">product</a>  // product 2
  <img class="rsImg" src="" />

  <a class="rsLink" href="">product</a>  // product 3
  <img class="rsImg" src="" />
</div> 
```

ETC....

我很新，我无法让它工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:00:55.890

你可以这样做：

```
$.getJSON(url, function (data) {

    var sliderHTML = "";
    var i = 1;
    $.each(data.collection.products, function (index, product) {

        if (i == 1) {
            sliderHTML += '<div class="rsContent">';
        }

        sliderHTML += '<a class="rsLink" href="' + product.url + '">' + product.title + '</a>';
        sliderHTML += '<img class="rsImg" src="' + image + '" />';

        if (i == 3) {
            sliderHTML += '</div>';
            i = 1;
        }
        i++;
    });
    if(i != 1) sliderHTML += '</div>';

}); 
```

如果您的最后一个组没有恰好 3 个元素，则必须`if(i != 1) sliderHTML += '</div>';`在循环（或其他验证）之后关闭最后一个 DIV 元素。

# asp.net-mvc-4 - MVC4 中视图引擎的选择？

> ID：15501428
> 
> 赞同：3
> 
> 时间：2013-03-19T13:54:14.773
> 
> 标签：asp.net-mvc-4, spark-view-engine, viewengine, razor-2, webforms-view-engine

我正在使用 ASP.Net MVC4.0、JQuery Mobile、HTML5 开发移动应用程序。由于我是 ASP.Net MVC 的新手，我不确定是使用 Razor(.cshtml) 还是 webForm(.aspx) 视图引擎。

谁能建议我可以使用哪个视图引擎来开发移动应用程序？性能方面哪个更好，剃刀视图引擎还是 webform 视图引擎？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T13:57:43.447

我不认为有性能方面。

但是，我发现 Razor 语法非常简洁。使用 Razor 时 HTML 更加突出，这是您在开发 HTML 视图时想要的。

> 在各种 MVC 框架中，视图开发鼓励并要求直接与标记一起编写代码。由于 ASPX 视图引擎的设计并未考虑到这一目标，因此 ASP.NET 团队决定使用以代码为中心的模板方法构建一个全新的视图引擎。结果是一个更智能的解析引擎能够非常容易地找出代码停止的位置和标记的开始位置，而无需开发人员非常明确。

甚至还有开源视图引擎，您可能想看看。例如，[火花视图引擎](http://sparkviewengine.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:59:22.187

Razor 是 MVC 的首选视图引擎，ASPX 视图引擎是旧版视图引擎，此选项用于向后兼容。[在这里](http://www.codeproject.com/Articles/470107/ASP-NET-MVC-4-Part-1-Introduction)，您会找到一篇很棒的文章，解释了两者之间的区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-17T05:49:28.413

首先列出了 ASPX 引擎。我们正在扩展的站点仅使用 Razor 视图。在尝试扩大数量请求时，仅在剃刀引擎之前使用 ASPX 引擎会导致发生大量争用。这样做：

```
ViewEngines.Engines.Clear();
//Add Razor Engine
ViewEngines.Engines.Add(new RazorViewEngine()); 
```

鉴于每个页面访问不再寻找 aspx、ascx 文件的存在，在启动时产生了巨大的差异。虽然它似乎不会影响单个请求的性能，但当您扩大规模并看到争用和 CPU 百分比上升时，这是应该检查的。

# c++ - 从 C 到 Neon 的双线性插值

> ID：15501429
> 
> 赞同：0
> 
> 时间：2013-03-19T13:54:17.530
> 
> 标签：c++, optimization, arm, neon

我正在尝试使用 Neon 对图像进行下采样。所以我尝试通过编写一个使用霓虹灯减去两个图像的函数来锻炼霓虹灯，我已经成功了。现在我回来使用霓虹内在函数编写双线性插值。现在我有两个问题，从一行和一列中获取 4 个像素，并且还从 4 个像素中计算插值（灰色），或者是否可以从一行和一列中的 8 个像素中计算。我试着考虑了一下，但我认为算法应该重写吗？

```
void resizeBilinearNeon( uint8_t *src, uint8_t *dest,  float srcWidth,  float srcHeight,  float destWidth,  float destHeight)
{

    int A, B, C, D, x, y, index;

       float x_ratio = ((float)(srcWidth-1))/destWidth ;
       float y_ratio = ((float)(srcHeight-1))/destHeight ;
       float x_diff, y_diff;

       for (int i=0;i<destHeight;i++) {
          for (int j=0;j<destWidth;j++) {
               x = (int)(x_ratio * j) ;
               y = (int)(y_ratio * i) ;
               x_diff = (x_ratio * j) - x ;
               y_diff = (y_ratio * i) - y ;
               index = y*srcWidth+x ;

               uint8x8_t pixels_r = vld1_u8 (src[index]);
               uint8x8_t pixels_c = vld1_u8 (src[index+srcWidth]);

               // Y = A(1-w)(1-h) + B(w)(1-h) + C(h)(1-w) + Dwh
               gray = (int)(
                           pixels_r[0]*(1-x_diff)*(1-y_diff) +  pixels_r[1]*(x_diff)*(1-y_diff) +
                           pixels_c[0]*(y_diff)*(1-x_diff)   +  pixels_c[1]*(x_diff*y_diff)
                           ) ;

               dest[i*w2 + j] = gray ;
           }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T16:10:05.987

Neon 肯定会帮助使用双线性过滤以任意比率进行下采样。关键是巧妙地使用 vtbl.8 指令，它能够为预加载数组中的 8 个连续目标像素执行并行查找表：

```
 d0 = a [b] c [d] e [f]  g  h, d1 =  i  j  k  l  m  n  o  p 
 d2 = q  r  s  t  u  v  [w] x, d3 = [y] z [A] B [C][D] E  F ...
 d4 = G  H  I  J  K  L   M  N, d5 =  O  P  Q  R  S  T  U  V ... 
```

可以很容易地计算括号中像素的小数位置：

```
 [b] [d] [f] [w] [y] [A] [C] [D],  accessed with vtbl.8 d6, {d0,d1,d2,d3}
 The row below would be accessed with            vtbl.8 d7, {d2,d3,d4,d5} 
```

递增 vadd.8 d6, d30 ；d30 = [1 1 1 1 1 ... 1] 为原点右侧的像素等提供查找索引。

除了说明它是可能的之外，没有理由从两行获取像素，并且如果需要，该方法也可用于实现轻微失真。

在实时应用程序中使用例如 lanzcos 可能有点矫枉过正，但使用 NEON 仍然可行。较大因子的下采样当然需要（重）滤波，但可以通过迭代平均和 2:1 抽取来轻松实现，并且仅在最后使用分数采样。

对于任意8个连续像素写入，可以计算向量

```
 x_positions = (X + [0 1 2 3 4 5 6 7]) * source_width / target_width;
  y_positions = (Y + [0 0 0 0 0 0 0 0]) * source_height / target_height;

  ptr = to_int(x_positions) + y_positions * stride;
  x_position += (ptr & 7); // this pointer arithmetic goes only for 8-bit planar
  ptr &= ~7;               // this is to adjust read pointer to qword alignment

  vld1.8 {d0,d1}, [r0]
  vld1.8 {d2,d3], [r0], r2 // wasn't this possible? (use r2==stride)

  d4 = int_part_of (x_positions);
  d5 = d4 + 1;
  d6 = fract_part_of (x_positions);
  d7 = fract_part_of (y_positions);

  vtbl.8 d8,d4,{d0,d1}  // read top row
  vtbl.8 d9,d5,{d0,d1}  // read top row +1
  MIX(d8,d9,d6)             // horizontal mix of ptr[] & ptr[1]
  vtbl.8 d10,d4,{d2,d3} // read bottom row
  vtbl.8 d11,d5,{d2,d3} // read bottom row
  MIX(d10,d11,d6)           // horizontal mix of ptr[1024] & ptr[1025]
  MIX(d8,d10,d7)

  // MIX (dst, src, fract) is a macro that somehow does linear blending
  // should be doable with ~3-4 instructions 
```

要计算整数部分，使用 8.8 位分辨率就足够了（实际上不必计算 666+[0 1 2 3 .. 7]）并将所有中间结果保存在 simd 寄存器中。

免责声明——这是概念性的伪 c / 矢量代码。在 SIMD 中，有两个并行任务需要优化：最少需要多少算术运算以及如何最小化不必要的数据混洗/复制。在这方面，具有三个寄存器方法的 NEON 也比 SSE 更适合严重的 DSP。第二个方面是乘法指令的数量，第三个优点是交错指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:46:34.107

@MarkRansom 对最近邻与 2x2 双线性插值不正确；使用 4 个像素的双线性将产生比最近邻更好的输出。他是正确的，平均适当数量的像素（如果按 > 2:1 缩放，则超过 4 个）仍然会产生更好的输出。但是，除非按整数比例进行缩放，否则 NEON 对图像下采样没有帮助。

NEON 和其他 SIMD 指令集的最大好处是能够使用相同的操作一次处理 8 或 16 个像素。通过以您的方式访问单个元素，您将失去所有 SIMD 优势。另一个问题是将数据从 NEON 移动到 ARM 寄存器是一个缓慢的操作。最好通过 GPU 或优化的 ARM 指令对图像进行下采样。

# php - 访问对象值

> ID：15501430
> 
> 赞同：0
> 
> 时间：2013-03-19T13:54:19.457
> 
> 标签：php, xml, object, simplexml

我试图从一个更大的对象中提取一个值。通过 SimpleXML 来自 xml 文件的主要对象。

当我`var_dump($data->extensions->runTime);`得到对象的这一部分时：

```
object(SimpleXMLElement)#21 (1) {
  [0]=>
  string(8) "2852.462"
} 
```

我怎样才能访问那个 2852.462？

我已经尝试了所有我能想到的东西，通过数组 [0]，甚至使用 foreach 语句。我不知道如何仅访问该值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:55:48.193

将其转换为字符串：

```
$value = (string)$data->extensions->runTime[0]; 
```

或者更好地浮动：

```
$value = (float)$data->extensions->runTime[0]; 
```

# javascript - Meteor：重用具有不同数据的模板

> ID：15501433
> 
> 赞同：2
> 
> 时间：2013-03-19T13:54:23.190
> 
> 标签：javascript, coffeescript, meteor, handlebars.js

我有一些模板列出项目（日志行、用户）并在表格中相应地设置它们的样式。现在我添加了一个“搜索”页面，它搜索不同项目类型的字符串并将它们显示在一个页面上。在布局方面，我想重用原始模板，但显然是使用搜索返回的数据。

**如何在不复制 HTML 文件中的模板本身的情况下做到这一点？**

换句话说：如何在子模板中使用来自顶级模板的实际数据。

小例子：

```
<template name="user_list">
{{#each user_list}}
</template>

<template name="users">
{{> user_list}}
</template>

<template name="search">
{{> user_list}}
{{> group_list}}
</template> 
```

在 .coffee 中：

```
 Template.users.user_list = ->
     [a,b,c,d]

 Template.search.user_list = ->
     [b,c] 
```

也许这很简单，这表明我对 Meteor 的了解有多么少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T02:25:47.887

只需将要使用的模板放在`{{#each}}`语句中即可。然后数组中的每个项目将是该内部模板的上下文。

## HTML 文件

```
<template name="users">
    <ul>
    {{#each UserArr}}
        {{> userItem}}
    {{/each}}
    </ul>
</template>

<template name="userItem">
    <li><a href="/edituser/{{_id}}">{{username}}</a> {{profile.name}}</li>
</template> 
```

## JS文件

```
Template.users.UserArr = function()
{
    return Meteor.users.find({});
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-24T21:00:13.343

另一种解决方案是将您的请求放入 Session 属性中，并在查询用户时检查其是否存在。默认情况下`Session.get("userQuery")`会返回`undefined`，但是一旦您在搜索字段中输入某些内容，您就可以使用`Session.set("userQuery", {type: "something"})`

现在在咖啡脚本中你可以说：

```
Template.users.user_list = ->
   if(Session.get("userQuery"))
     [a,b,c,d]
   else
     [b,c] 
```

或者使用 MiniMongo 查询，因为它更好:-)

好消息是您的 HTML 将重新呈现，因为它对 Session 的内容是反应性的。

# java - 单元测试环境中的 Log4j

> ID：15501436
> 
> 赞同：0
> 
> 时间：2013-03-19T13:54:37.717
> 
> 标签：java, junit, log4j

我正在执行 JUnit 测试并接收 log4j:WARN No appenders could be found for logger (class .. ) error 当我运行测试类时。

Log4j 属性文件存在于我的文件夹根目录中。这段代码似乎可以工作，但为什么 log4j 不能自动拾取。

```
package com.folio3.automation;
import org.apache.log4j.BasicConfigurator;
import org.apache.log4j.Logger;
import org.junit.Test;
import junit.framework.Assert;

public class TestClass {

    static {
        BasicConfigurator.configure();
    }

    private static final Logger LOG = Logger.getLogger(TestClass.class);

    @Test
    public void test1(){
        LOG.info("test 1 called ");
        Assert.assertEquals(true, false);

    }

} 
```

我是否必须调用 BasicConfigurator.configure(); 在每个类或基类中？有什么方法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T05:55:31.013

尝试将您的应用程序根目录添加到您的 VM 启动命令中，您的问题就会消失。

# .htaccess - .htaccess 命令应该区分大小写吗？

> ID：15501437
> 
> 赞同：1
> 
> 时间：2013-03-19T13:54:38.183
> 
> 标签：.htaccess, .htaccess, .htaccess

我看过很多关于[.htaccess](/questions/tagged/.htaccess "显示标记为“.htaccess”的问题")的教程。不同的人写的不一样。您可以找到不同的套管：

```
rewriteengine on
RewriteEntgine on
Rewritengine On 
```

似乎所有这些都工作正常。

1.  是否有理由使用[.htaccess](/questions/tagged/.htaccess "显示标记为“.htaccess”的问题")命令？
2.  是否有可能由于错误的大小写而导致命令失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:59:34.573

Apache 文档建议指令不区分大小写，但参数可能是。我建议您坚持官方文档中声明的格式，以避免可能的混淆和/或失败。

[http://httpd.apache.org/docs/current/configuring.html#syntax](http://httpd.apache.org/docs/current/configuring.html#syntax) [http://httpd.apache.org/docs/current/mod/mod_rewrite.html#RewriteEngine](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#RewriteEngine)

# asp.net - Web API 控制器参数化构造函数仅调用一次，后续请求无参数构造函数

> ID：15501439
> 
> 赞同：1
> 
> 时间：2013-03-19T13:54:39.433
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我正在尝试使用 Unity 根据本文注入依赖项：

[http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver](http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver)

这是我的 global.asax 中的内容

```
void ConfigureApi(HttpConfiguration config)
    {
        var unity = new UnityContainer();
        unity.RegisterType<CustomerController>();
        unity.RegisterType<TPS.Data.Can.IUnitOfWork, TPS.Data.Can.EFRepository.UnitOfWork>(new HierarchicalLifetimeManager());
        config.DependencyResolver = new IoCContainer(unity);
    }

    protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);

        ConfigureApi(GlobalConfiguration.Configuration);
    } 
```

这是我的 API 控制器：

```
public class CustomerController : ApiController
{
    private TPS.Data.Can.IRepository<tblCustomer> _repo;
    private TPS.Data.Can.IUnitOfWork _uow;
    public CustomerController() { }

    public CustomerController(TPS.Data.Can.IUnitOfWork uow) {
        _uow = uow;
        _repo = uow.CustomerRepository;
    }

    // GET api/customer/5
    public IEnumerable<Customer> Get()
    {
        string identity = HttpContext.Current.User.Identity.Name;
        //REFACTOR THIS
        if (String.IsNullOrWhiteSpace(identity))
            identity = "chardie";

        var customers = from c in _repo.Get()
                       where c.SalesRep == identity
                       select new Customer
                       {
                           IDCUST = null,
                           CustCode = c.CustCode,
                           CustName = c.CustName
                       };

        return customers.ToList();
    } 
```

这在我第一次开始调试我的应用程序时有效。如果我在参数化构造函数中设置断点，那么当我第一次点击 Web API 时，就会触发断点。当我在浏览器中点击刷新时，*不会*调用构造函数，不会注入依赖项，并且 Get() 操作会引发异常，因为预期的存储库为空。

谁能告诉我为什么在第一次请求后没有调用我的构造函数？

谢谢！

克里斯

**编辑**

FWIW，我完全从 Web API 控制器中删除了无参数构造函数，在我第二次请求它时，我得到了异常：

```
Type 'TPS.Website.Api.CustomerController' does not have a default constructor 
```

所以看起来我在第一个请求上注入了我的 repo 依赖项，但之后 Web API 控制器的每个实例化都是通过无参数构造函数完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-06T12:16:45.403

我有这个，因为我正在使用这个返回我的依赖范围的解析器，然后在 dispose 中处理容器。因此，在第一次请求之后，容器被处理掉了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:30:51.680

您没有为控制器指定生命周期。[MSDN 状态](http://msdn.microsoft.com/en-gb/library/ff648211.aspx)

> 如果您未指定生命周期值，则实例将具有默认的容器控制生命周期。它将在每次调用 Resolve 时返回对原始对象的引用。

如果`IUnitOfWork`依赖是瞬态的，那么控制器也应该是瞬态的。所以试试

```
unity.RegisterType<CustomerController>(new TransientLifetimeManager()); 
```

这可能无法解决整个问题，但听起来像是其中的一部分。您当然不需要无参数构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-04T18:15:30.693

看起来这是因为您没有为 Unity 容器使用单例模式。

有一个私有静态变量而不是 var container = new UnityContainer();

```
internal static Lazy<IUnityContainer> container = new Lazy<IUnityContainer>(() => new UnityContainer()); 
```

然后使用 .Value 属性在代码中访问。

# javascript - 通过 Google 电子表格 API 导入 JSON

> ID：15501440
> 
> 赞同：2
> 
> 时间：2013-03-19T13:54:40.947
> 
> 标签：javascript, oauth-2.0, google-spreadsheet-api, google-oauth

我只想将我的电子表格拉入应用程序/网站。理想情况下，我希望它是私有的，但首先我试图通过“对公众可用”和“发布到网络”的电子表格引入数据。

```
$.ajax({
   type: 'GET',
   url: 'http://spreadsheets.google.com/feeds/cells/' + spreadsheetKey + '/od6/public/full?alt=json',
   success: function(data){
     alert("success");
   } 
 }); 
```

这总是导致：

“您没有查看电子表格的权限。请确保您已通过适当的身份验证。”

我试过不带 ?alt=json，用“list”代替“cells”，用“values”代替“full”。没有任何效果。

另外，有没有办法将访问令牌传递给这个调用？我正在通过 Google 登录进行身份验证并允许电子表格 API 范围。我试过 &accessToken=xxx 和 &access_token=xxx。该文档没有任何关于 Javascript 的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T10:20:16.613

For Javascript access to a private spreadsheet, you'll need the Javascript library here: [https://code.google.com/p/google-api-javascript-client/wiki/Authentication](https://code.google.com/p/google-api-javascript-client/wiki/Authentication) That allows you to use OAuth2.0 which allows you to access a private Google Spreadsheet. See the answer under [Google Spreadsheets API with OAuth 2.0 using Javascript](https://stackoverflow.com/questions/14238935/google-spreadsheets-api-with-oauth2-0-using-javascript) for a full description.

For the access token, the syntax is: `&access_token=xxx` The relevant details for Javascript is under the Protocol heading in the [Google Spreadsheet API](https://developers.google.com/google-apps/spreadsheets/), but it isn't that helpful I've found.

To get JSON do the following:

```
var url = 'https://spreadsheets.google.com/feeds/list/' + urlLocation + '/od6/private/full?alt=json-in-script&access_token=' + token + '&callback=?';
$.getJSON(url, function(data) {
    //do stuff with data here
}); 
```

# c++ - 向量的下标有时超出范围

> ID：15501447
> 
> 赞同：0
> 
> 时间：2013-03-19T13:54:56.940
> 
> 标签：c++, vector, subscript

我有一个遗传算法程序，一切都是使用向量动态分配的。在编译时没有设置每代的代数或个体数。

我尝试了 500、1000、2000 代，运行完美。然后我尝试了10,000代。它给了我调试断言失败，第 4966 代向量下标超出范围。

我用相同的参数再次尝试了两次，10,000 代，它运行良好。

我又试了一次，我在第 7565 代得到了错误。

奇怪的是，有时它工作得很好，有时我得到错误。特别是考虑到一切都是使用向量完成的。

关于问题可能来自哪里的任何想法？也许由于某种原因调试模式有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:01:38.847

问题来自堆栈损坏或很可能来自索引越界访问。在某些情况下您的代码崩溃表明存在问题。如果您的代码是多线程的，则问题可能是因为如果以给定的顺序执行操作，您的代码将尝试访问超出向量范围的内容。

我的建议是使用[valgrind](http://valgrind.org/)运行您的代码，看看它会说什么。通常它有助于解决类似的问题。

另请注意，在某些情况下您的代码不会崩溃，这并不意味着它可以完美运行。您可能仍然有堆栈损坏或类似情况。

# javascript - JavaScript - 如何在函数中用某些字符替换字符串

> ID：15501451
> 
> 赞同：0
> 
> 时间：2013-03-19T13:55:07.153
> 
> 标签：javascript, regex, replace

如何使用正则表达式执行此操作，将每个字符串替换为`!`包含在函数中的函数：

例子：

*   `3!`=>`fact(3)`

*   `2.321!`=>`fact(2.321)`

*   `(3.2+1)!`=>`fact(3.2+1)`

*   `(sqrt(2)+2/2^2)!`=>`fact(sqrt(2)+2/2^2)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:59:09.893

Given your examples, you don't need a regex at all:

```
var s = "3!"; //for example

if (s[s.length-1] === "!")
    s = "fact(" + s.substr(0, s.length-1) + ")"; 
```

Not doubling the parentheses for the last case just requires another test:

```
var s = "(sqrt(2)+2/2^2)!"; //for example

if (s[s.length-1] === "!") {
    if(s.length > 1 && s[0] === "(" && s[s.length-2] === ")") 
        s = "fact" + s.substr(0, s.length-1);
    else
        s = "fact(" + s.substr(0, s.length-1) + ")";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:59:20.393

```
var testArr =  [];
testArr.push("3!");
testArr.push("2.321!");
testArr.push("(3.2+1)!");
testArr.push("(sqrt(2)+2/2^2)!");

//Have some fun with the name. Why not?
function ohIsThatAFact(str) {
    if (str.slice(-1)==="!") {
         str = str.replace("!","");
         if(str[0]==="(" && str.slice(-1)===")") 
             str = "fact"+str;
         else 
             str = "fact("+str+")";
    }
    return str;
}

for (var i = 0; i < testArr.length; i++) {
    var testCase = ohIsThatAFact(testArr[i]);
    document.write(testCase + "<br />");
} 
```

[Fiddle example](http://jsfiddle.net/kaTwp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:10:39.793

这是按照操作要求的；使用正则表达式：

```
"3*(2+1)!".replace(/([1-9\.\(\)\*\+\^\-]+)/igm,"fact($1)"); 
```

你可能会得到双括号：

```
"(2+1)!".replace(/([1-9\.\(\)\*\+\^\-]+)/igm,"fact($1)"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:02:11.307

我刚刚发现的我自己的答案是：

```
Number.prototype.fact = function(n) {return fact(this,2)}
str = str.replace(/[\d|\d.\d]+/g, function(n) {return "(" + n + ")"}).replace(/\!/g, ".fact()") 
```

但我会看看其他答案是否会更好，认为他们是

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T14:00:00.207

```
"(sqrt(2)+2/2^2)!".replace(/(.*)!/g, "fact($1)"); 
```

[摆弄它！](http://jsfiddle.net/tB3F9/)

`(.*)!`

*   匹配下面的正则表达式并将其匹配捕获到反向引用编号 1`(.*)`

    *   匹配任何不是换行符的单个字符`.`
    *   在零次和无限次之间，尽可能多次，根据需要回馈（贪婪）`*`
*   匹配字符“！” 字面上地`!`

# matlab - MATLAB 中多元正态性的 Box Cox 变换

> ID：15501455
> 
> 赞同：1
> 
> 时间：2013-03-19T13:55:19.090
> 
> 标签：matlab, normalization, transformation

有没有人在 MATLAB 中实现了 Box Cox 方法来转换多元数据？我找到了一个可以做到这一点的**R** [包](http://rss.acs.unt.edu/Rdoc/library/car/html/box.cox.powers.html)，但对于 MATLAB 没有。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-18T15:18:27.750

MATLAB 没有内置函数来实现多元 box-cox 变换。

我自己写了一个，它有效。

这是代码。

输入 x 是观测矩阵，其中行表示观测，列表示变量。

**参考**：Applied Multivariate Statistical Analysis 6th- Johnson R. & Wichern D. Chapter 4.8 Transformations to Near Normality

```
function lambda=boxcoxn(x)
[m,n]=size(x);
lambda_ini=zeros(n,1);
for ii=1:n
    [temp,lambda_ini(ii,1)]=boxcox(x(:,ii));
end
fun=@(lambda)(log(det((cov(((x.^repmat(lambda',m,1)-1)./repmat(lambda',m,1))))))*m/2-(lambda-1)'*(sum(log(x)))');
lambda=fminsearch(fun,lambda_ini);
end 
```

随意使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T12:41:28.043

谷歌搜索“MATLAB Box Cox”告诉我：

1.  Box-Cox 转换在[Financial Toolbox中可用](http://www.mathworks.com/help/finance/boxcox.html)
2.  MATLAB Central File Exchange 上有一个免费提供的[实现。](http://www.mathworks.com/matlabcentral/fileexchange/10419-box-cox-power)

# jquery - jqGrid getRowData 不起作用

> ID：15501457
> 
> 赞同：0
> 
> 时间：2013-03-19T13:55:25.480
> 
> 标签：jquery, html, jqgrid

当我双击但没有成功时，我一直试图从 jqGrid 检索数据。我能够获得行 ID。请任何人都可以帮我检查此代码并让我知道出了什么问题。

```
$(function(){
              $("#itemlist").jqGrid({
                    url:urld,
                    datatype: 'json',
                    mtype: 'POST',
                    colNames:['Subscriber Id','Subscriber Name','Contact Person','Contact Email','Telephone'],
                    colModel :[ 
                      {name:'id', index:'id', width:100,sortable:true}, 
                      {name:'subscribername', index:'subscribername', width:300,sortable:true},
                      {name:'contactperson', index:'contactperson', width:200,sortable:true},
                      {name:'contactemail', index:'contactemail', width:200,sortable:true},
                      {name:'telephone', index:'telephone', width:100,sortable:true}
                    ],
                    pager: '#pager',
                    pgbuttons:true,
                    rowList:[10,20,30],
                    sortorder: 'desc',
                    viewrecords: true,
                    gridview: true,
                    loadonce: true,
                    height: 'auto',
                    altRows:true,
                    altclass: 'oddRow',
                    caption: 'Subscriber',
                    ondblClickRow: function(id,iRow,icCol,e)
                    {
                        alert(iRow);
                         var rowData = jQuery("#itemlist").jqGrid('getRowData',iRow);
                        var subName = rowData['subscribername');
alert(subName);

                     }
                  }); 
            }); 
```

警报显示 iRow 但不显示 subName。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:02:03.887

尝试：

```
ondblClickRow: function(id,iRow,icCol,e)
                    {
                        alert(iRow);
                         var rowData = $(this).jqGrid('getRowData',id);
... 
```

您正在使用`iRow`而不是“id”的rowID。为清楚起见（尽管这并不重要），我建议您将 ondblClickRow 标记为：

```
ondblClickRow: function (rowid, iRow, iCol, e) { 
```

# android - 谷歌广告显示错误

> ID：15501462
> 
> 赞同：4
> 
> 时间：2013-03-19T13:55:50.443
> 
> 标签：android

我已将 xml 中的谷歌广告声明为

```
<RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <com.google.ads.AdView
             xmlns:ads="http://schemas.android.com/apk/lib/com.admobdemo"
        android:id="@+id/adView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        ads:adSize="BANNER"
        ads:adUnitId="a150cb2e31846cf" 
        ads:loadAdOnCreate="true"
        ads:testDevices="AVD_for_4in_WVGA_Nexus_S,5554" />

    </RelativeLayout> 
```

我已经在 XML 和清单文件中声明了命名空间。

我在我的活动中声明为

```
AdView adView = (AdView) findViewById(R.id.adView);
        AdRequest adRequest = new AdRequest();
        adRequest.setTesting(true);

        adView.loadAd(adRequest); 
```

但是当我运行我的应用程序时，我得到的响应为

```
adRequestUrlHtml: <html><head><script src="http://www.gstatic.com/afma/sdk-core-v40.js"></script><script>AFMA_buildAdURL({"preqs":0,"u_sd":1.5,"u_w":480,"simulator":1,"msid":"com.netserv.Pungry","cap":"m,a","js":"afma-sdk-a-v4.0.2","isu":"B3EEABB8EE11C2BE770B684D95219ECB","format":"320x50_mb","net":"ed","app_name":"4.0.2.android.com.netserv.Pungry","hl":"en","u_h":800,"testing":1,"u_so":"p","u_audio":4});</script></head><body></body></html> 
```

但它没有显示在输出中，我收到错误

```
03-19 13:43:46.190: E/Ads(4983): AdView missing required XML attribute adUnitId. 
```

我能知道我的代码中的错误是什么吗？

谢谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:02:46.297

当您想展示广告时，在主布局中采用一种布局

```
 <LinearLayout
            android:id="@+id/addlay"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >
        </LinearLayout> 
```

并在java文件中

```
 AdView adView = new AdView(this, AdSize.BANNER, "xxxxxxxxxxxxxxx");
        LinearLayout addLay = (LinearLayout) findViewById(R.id.addlay);

        AdRequest adRequest = new AdRequest();
        // adRequest.addTestDevice(AdRequest.TEST_EMULATOR);
        addLay.addView(adView);
        adView.loadAd(adRequest); 
```

你检查过这个吗 ![在此处输入图像描述](../Images/55359f9ccd820990d3dedaa704d8535d.png)

有时项目清洁也有效..

你能看到这个吗

![在此处输入图像描述](../Images/ab618cbdd11c2ecddf1cccd37b774761.png)

# php - 用php创建csv文件

> ID：15501463
> 
> 赞同：75
> 
> 时间：2013-03-19T13:55:51.007
> 
> 标签：php, csv

我想创建一个 csv 文件，但是当我运行代码时，它返回一个空白页并且没有 csv 文件。我使用 PHP 5。我使用以下代码：

```
<?php
    $data = array ('aaa,bbb,ccc,dddd',
                   '123,456,789',
                   '"aaa","bbb"');

    $fp = fopen('data.csv', 'w');
    foreach($data as $line){
             $val = explode(",",$line);
             fputcsv($fp, $val);
    }
    fclose($fp);
?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-03-19T14:02:55.507

它是空白的，因为您正在写信给`file`. 您应该改为`output`使用`php://output`并发送标头信息以指示它是 csv。

例子

```
header('Content-Type: text/csv');
header('Content-Disposition: attachment; filename="sample.csv"');
$data = array(
        'aaa,bbb,ccc,dddd',
        '123,456,789',
        '"aaa","bbb"'
);

$fp = fopen('php://output', 'wb');
foreach ( $data as $line ) {
    $val = explode(",", $line);
    fputcsv($fp, $val);
}
fclose($fp); 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2015-10-22T16:36:11.990

@Baba 的回答很棒。但是您不需要使用`explode`，因为[`fputcsv`](http://php.net/manual/en/function.fputcsv.php)将数组作为参数

例如，如果您有一个三列四行的文档，这里有一个更直接的版本：

```
header('Content-Type: text/csv');
header('Content-Disposition: attachment; filename="sample.csv"');

$user_CSV[0] = array('first_name', 'last_name', 'age');

// very simple to increment with i++ if looping through a database result 
$user_CSV[1] = array('Quentin', 'Del Viento', 34);
$user_CSV[2] = array('Antoine', 'Del Torro', 55);
$user_CSV[3] = array('Arthur', 'Vincente', 15);

$fp = fopen('php://output', 'wb');
foreach ($user_CSV as $line) {
    // though CSV stands for "comma separated value"
    // in many countries (including France) separator is ";"
    fputcsv($fp, $line, ',');
}
fclose($fp); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-09T10:36:48.193

以防万一有人想将 CSV 文件保存到电子邮件附件的特定路径。然后可以如下进行

> 我知道我已经为新手添加了很多评论:)

我添加了一个示例，以便您可以很好地总结。

```
$activeUsers = /** Query to get the active users */

/** Following is the Variable to store the Users data as 
    CSV string with newline character delimiter, 

    its good idea of check the delimiter based on operating system */

$userCSVData = "Name,Email,CreatedAt\n";

/** Looping the users and appending to my earlier csv data variable */
foreach ( $activeUsers as $user ) {
    $userCSVData .= $user->name. "," . $user->email. "," . $user->created_at."\n";
}
/** Here you can use with H:i:s too. But I really dont care of my old file  */
$todayDate  = date('Y-m-d');
/** Create Filname and Path to Store */
$fileName   = 'Active Users '.$todayDate.'.csv';
$filePath   = public_path('uploads/'.$fileName); //I am using laravel helper, in case if your not using laravel then just add absolute or relative path as per your requirements and path to store the file

/** Just in case if I run the script multiple time 
    I want to remove the old file and add new file.

    And before deleting the file from the location I am making sure it exists */
if(file_exists($filePath)){
    unlink($filePath);
}
$fp = fopen($filePath, 'w+');
fwrite($fp, $userCSVData); /** Once the data is written it will be saved in the path given */
fclose($fp);

/** Now you can send email with attachments from the $filePath */ 
```

> 注意：以下是增加 **memory_limit**和**time limit**的一个非常糟糕的主意，但我只是添加以确保是否有人面临连接超时或任何其他问题。确保在坚持之前找到一些替代方案。

您必须在上述脚本的开头添加以下内容。

```
ini_set("memory_limit", "10056M");
set_time_limit(0);
ini_set('mysql.connect_timeout', '0');
ini_set('max_execution_time', '0'); 
```

# linux - 用 Linux/Unix 命令替换文件中的行块

> ID：15501467
> 
> 赞同：0
> 
> 时间：2013-03-19T13:56:06.540
> 
> 标签：linux, unix, command

您能否帮助一个可以对文件执行的命令：

输入-1：

```
/*
* Copyright (c) 1992-2013 Some comp, Inc and/or its affiliates. All rights reserved.
* Some comp PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
* Author: aaaa
* DateCreated:   aaaa
* Last Modified By: aaaa
* Modified Time:  aaaa
* File Version: aaaa
* File Path: aaaa
*/ 
```

以上所有行应删除并替换为

```
/*
* Copyright (c) 1992-2013 some comp, and/or its affiliates. All rights reserved.
* some comp PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
* Author: bbbb
* DateCreated:   bbbb
* Last Modified By:  bbbb
* Modified Time:  bbbb
* File Version:  bbbb
* File Path:  bbbb
*/ 
```

我的意见是，首先从'/ *'删除到'* /'第一次出现或从文件开始删除直到*/。之后，用文件顶部的第二行替换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:11:09.967

假设文件名为`filename`. 将没有第一行和最后一行的新文本（即从“* Copyright...”到“* File Path...”）保存在`newcopyright`. 然后：

```
sed -e '/Path/ r newcopyright' -e '/Copyright/,/Path/d' filename 
```

这会将新文件发送到标准输出（即您的屏幕）。您可以将其重定向到一个新文件，或者如果您想就地修改文件，您可以这样做：

```
sed -i '.save' -e '/Path/ r newcopyright' -e '/Copyright/,/Path/d' filename 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:04:04.633

对 sed 和 awk 使用正则表达式。Gawk 有一个叫做 gsub 的函数来替换文本。

# c++ - 模板中的字符串文字 - 编译器的不同行为

> ID：15501470
> 
> 赞同：12
> 
> 时间：2013-03-19T13:56:12.457
> 
> 标签：c++, templates, language-lawyer

假设我们有以下代码：

```
template <typename T>
void foo(const T&);

int main()
{
   foo("str");
} 
```

[示范](http://liveworkspace.org/code/4Gagz0%240)

**gcc 4.7.2、clang 3.2、icc 13.0.1**

> **对 `void foo< char** [4]>(char const (&) [4])' 的未定义引用

**MSVC-11.0**

> 未解析的外部符号 "void __cdecl foo< **char const** [4]>(char const (&)[4])" (??$foo@$$BY03$$CBD@@YAXAAY03$$CBD@Z)

注意`char[4]`第一个输出和`char const[4]`第二个输出。

为什么？谁是对的？可以引用一下标准吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T16:15:37.907

**海合会是对的。**

让我们从一个稍微简单的例子开始，稍后证明原来的例子也遵循同样的模式：

```
template<typename T>
void bar(T const&)
{
    // Shall not fire
    static_assert(std::is_same<T, int>::value, "Error!");
}

int main()
{
    int x = 0;
    bar(x); // 1 - Assertion won't fire

    int const y = 0;
    bar(y); // 2 - Assertion won't fire
} 
```

这里发生了什么事？首先，根据第 14.8.2.1/3 节：

> [...] 如果 P 是引用类型，则 P 引用的类型用于类型推导。[...]

这意味着类型推导将尝试匹配`T const`（`int`在情况 1 中）和反对`int const`（在情况 2 中）。在第二种情况下，替换`int`将`T`产生一个完美的匹配，所以这很容易；在第一种情况下，我们`const`正在努力实现完美匹配。但这就是第 14.8.2.1/4 节发挥作用的地方：

> [...]**如果原始 P 是引用类型**，则推导的 A（即引用所引用的类型）**可以**比转换后的 A 更具 cv 限定。 [...]

在这里，替换`int`for`T`给了我们一个 deduced `int const`，它比`int`（参数的类型`x`）更具 cv 限定性。但这是可以接受的，因为上面的第 14.8.2.1/4 节，所以即使在这种情况下`T`也被推断为`int`。

现在让我们处理您的原始示例（稍作调整，但我们最终会使用原始版本）：

```
template<typename T>
void bar(T const&)
{
    // Does not fire in GCC, fires in VC11\. Who's right?
    static_assert(std::is_same<T, char[4]>::value, "Error!");
}

int main()
{
    char x[] = "foo";
    bar(x);

    char const y[] = "foo";
    bar(y);
} 
```

除了我替换`int`为之外`char []`，这是示例和我的第一个示例在结构上是相同的。要了解为什么这种等价性成立，请考虑下面的断言（正如预期的那样，它不会在*任何*编译器上触发）：

```
// Does not fire
static_assert(
    std::is_same<
        std::add_const<char [4]>::type,
        char const[4]
    >::value, "Error"); 
```

C++11 标准在第 3.9.3/2 段中规定了这种行为：

> 应用于数组类型的任何 cv 限定符都会影响数组元素类型，而不是数组类型 (8.3.4)。

第 8.3.4/1 段还规定：

> [...] 任何形式的“cv-qualifier-seq array of NT”都被调整为“array of N cv-qualifier-seq T”，同样适用于“array of unknown bound of T”。可选的属性说明符序列属于数组。[ 例子：

```
typedef int A[5], AA[2][3];
typedef const A CA; // type is “array of 5 const int”
typedef const AA CAA; // type is “array of 2 array of 3 const int” 
```

> —结束示例] [注意：“N cv-qualifier-seq T 的数组”具有 cv 限定类型；见 3.9.3。——尾注]

由于现在很清楚这两个示例展示了相同的模式，因此应用相同的逻辑是有意义的。这将引导我们走同样的推理路径。

在执行类型推导时，在第一种情况下`T const`匹配，在第二种情况下匹配。`char[4]``char const[4]`

在第二种情况下，`T = char[4]`产生完美匹配，因为在替换之后`T const`变为。`char const[4]`在第一种情况下， deduced`A`再次比原始 cv 更合格`A`，因为它代替`char[4]`了`T`yield `char const[4]`。但话又说回来，这是 14.8.2.1/4 允许的，所以`T`应该推导出为`char[4]`.

最后，回到你原来的例子。由于字符串字面`"str"`量也有 type `char const[4]`,`T`应该推导出为 be `char [4]`, 这意味着**GCC 是对的**:

```
template<typename T>
void foo(T const&)
{
    // Shall not fire
    static_assert(std::is_same<T, char[4]>::value, "Error!");
}

int main()
{
    foo("str"); // Shall not trigger the assertion
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:35:37.773

# php - 使用php提取url和参数

> ID：15501471
> 
> 赞同：0
> 
> 时间：2013-03-19T13:56:13.830
> 
> 标签：php, url

我没有完全遵循我遇到的错误......我得到一个空白输出。我的目标是`mywebsite.com/test.php?location=1234&arg=5678`用这些（K/V 关系甚至 2 个数组）设置某种哈希映射并遍历它们。

谢谢。

代码：

```
 <?php
        function curPageURL() {
            $pageURL = 'http://';
            if ($_SERVER["SERVER_PORT"] != "80") {
                $pageURL.$_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
            } else {
                $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
            }
            return $pageURL;
        }

        $query = parse_url(curPageURL(), PHP_URL_QUERY);
        parse_str($query, $params);
        $test = $params['test'];
        echo test;
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:06:01.320

您在这里有两个问题：

首先，如果您在共享主机上运行此程序，则主机可能已关闭错误。在发生致命（或 500）错误的情况下，这会导致空白页。将此添加到文件顶部以查看您的错误：

```
ini_set('display_errors', '1');
error_reporting(E_ALL); 
```

其次，如果您的目标是从 URL 中检索参数，PHP 为您提供了一种简单的方法。使用 $_GET 超全局，即：

```
foreach ($_GET as $param => $value) {
    echo $param . " : " . $value . "<br/>";
} 
```

简单得多，不是吗？

# python - 在 shell/python 中按某个字段对文本文件进行排序

> ID：15501472
> 
> 赞同：0
> 
> 时间：2013-03-19T13:56:14.330
> 
> 标签：python, linux, bash

我有一个看起来像这样的数据日志文件（比如，log.dat）（一个玩具示例）：

> s('2','3') 102.3993 2992 0.22 0.33
> s('4','6') 105.44 2993 0.43 0.93
> s('19','33') 99.93 28992 0.99 0.29
> ....（类似模式）

我想使用 bash shell 或 python 按第二个字段对数据日志文件进行排序。这意味着输出文件如下所示：

> s('19','33') 99.93 28992 0.99 0.29
> s('2','3') 102.3993 2992 0.22 0.33
> s('4','6') 105.44 2993 0.43 0.93

如何使用 shell 脚本或 python 来做到这一点？也许最好附加一个尾字段来指示每行的排名（1,2,3，...）最终目标是通过第二个字段在 gnuplot 中绘制日志文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:03:49.860

在 bash 命令行中，尝试[sort(1)](http://linux.die.net/man/1/sort)命令：

```
$ sort -k2,2 -n -o log.dat log.dat 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:06:04.850

试试这个：

```
$ sort -k2 -n inputFile > outputFile 
```

在哪里：

*   -n, --numeric-sort 根据字符串数值进行比较
*   -k, --key=POS1[,POS2] 在 POS1（原点 1）开始一个键，在 POS2 结束它（默认行尾）

NB -t, --field-separator=SEP 使用 SEP 而不是非空白到空白的过渡，因此我们使用默认字段分隔符

# azure - 是否必须重新部署 Azure Web 角色才能启用 IIS 日志记录？

> ID：15501473
> 
> 赞同：0
> 
> 时间：2013-03-19T13:56:16.900
> 
> 标签：azure, azure-diagnostics

我有一个运行 MVC Web API 站点的 Azure Web 角色。我正在使用 diagnostics.wadcfg 文件来配置日志记录。到目前为止，我只是在使用跟踪，并使用 Cerebrata/Redgate 的 Azure Diagnostics Monitor 2 查看它。一切都很好。

我想开始注销 IIS 请求。我知道我可以去 wad-control-container 通过更新那里的内容来对日志记录进行一些调整，如下所示：

```
<?xml version="1.0"?>
<ConfigRequest xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <DataSources>
    <OverallQuotaInMB>4096</OverallQuotaInMB>
    <Logs>
      <BufferQuotaInMB>1024</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>1</ScheduledTransferPeriodInMinutes>
      <ScheduledTransferLogLevelFilter>Verbose</ScheduledTransferLogLevelFilter>
    </Logs>
    <DiagnosticInfrastructureLogs>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <ScheduledTransferLogLevelFilter>Undefined</ScheduledTransferLogLevelFilter>
    </DiagnosticInfrastructureLogs>
    <PerformanceCounters>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <Subscriptions />
    </PerformanceCounters>
    <WindowsEventLog>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <Subscriptions />
      <ScheduledTransferLogLevelFilter>Undefined</ScheduledTransferLogLevelFilter>
    </WindowsEventLog>
    <Directories>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <Subscriptions />
    </Directories>
  </DataSources>
  <IsDefault>true</IsDefault>
</ConfigRequest> 
```

例如，我可以从 Verbose 切换到 Information log tracking。

我可以从这里打开 IIS 日志记录吗？还是我必须更新我的 diagnostics.wadcfg 并重新部署？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:29:50.363

您可以使用 Cerebrata 的诊断管理器来更改配置。它是逐个实例完成的。一旦您重新部署应用程序或您的实例被 Azure 重新映像，该更改将丢失。

# windows-phone-7 - Windows Phone 是否支持 Java

> ID：15501477
> 
> 赞同：3
> 
> 时间：2013-03-19T13:56:30.460
> 
> 标签：windows-phone-7

我是 Windows Phone 开发人员，我有一个关于 Windows Phone 是否支持 Java 的基本查询。如果支持 - 如何在 wp7 设备中安装 jar 文件？

因为我在此链接 [http://www.makeuseof.com/tag/install-java-windows-mobile/](http://www.makeuseof.com/tag/install-java-windows-mobile/)上阅读了有关在 Windows Mobile 中安装 jar 文件的文章。

所以出于好奇，我只想提出一个关于 WP7 与 Java 兼容性的问题。我只是希望我能得到你们的答复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T13:58:55.120

Windows Phone 不以任何方式支持 Java。Windows Phone 仅“执行”任何版本（7.0 或更高版本）的 xap 文件和 XNA 文件。

无法在 Windows Phone 中运行 Java。也没什么用。;)

# mvvm - kendo.bind 在哪里？剑道 ui 2013 测试版

> ID：15501482
> 
> 赞同：1
> 
> 时间：2013-03-19T13:56:43.420
> 
> 标签：mvvm, user-interface, kendo-ui, bind, beta

我在 kendo.bind 剑道类下找不到函数。我使用的是测试版 2013.q1。这是许可证要求吗？

*   使用 require.js 的库。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:36:51.200

`kendo.bind`是 KendoUI 的一部分，可能会根据您的 KendoUI 分布/策略在不同的文件中找到（包括所有，包括缩小文件，包括源，...）。您可以找到它的两个最典型的文件是：

1.  `js/kendo.all.min.js`.
2.  `js/kendo.web.min.js`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:33:52.050

`kendo.bind`如果您使用独立文件，该方法在 kendo.binder.min.js 中可用。

# ruby-on-rails - What is the correct way to run Rails tests without invoking the development environment?

> ID：15501486
> 
> 赞同：0
> 
> 时间：2013-03-19T13:56:51.380
> 
> 标签：ruby-on-rails, testing, environment

I have an Rails app, with some initializer code which must be executed when the app is running in development mode. However, this initializer code must not be executed when running tests.

I have established that

```
$ rake test 
```

causes the app to be run in development mode, which invokes the initializer code and therefore breaks my tests. This is expected behaviour apparently (see: [https://github.com/rails/rails/issues/9801](https://github.com/rails/rails/issues/9801)).

What is the correct command to run my Rails app tests without starting the app in development mode?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:08:44.070

你的 test_helper.rb 文件看起来像[默认](https://gist.github.com/dimroc/1653316)的吗？它应该从以下开始：

```
ENV["RAILS_ENV"] = "test" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T03:57:06.500

你需要在 test_helper.rb 文件的开头有一行说

```
Rails.env = "test" 
```

你不能使用

```
ENV["RAILS_ENV"] = "test" 
```

因为它将无法清除从 Rails.env 调用返回的缓存值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:02:35.273

尝试使用显式环境运行 rake 任务：

```
rake test:units RAILS_ENV=test 
```

根据我的经验，如果您不指定环境，则假定为开发。尽管测试数据库仍将夹具数据插入其中，但出于某种原因仍会引用开发环境中的内容。

# unix - nagis cache remote website

> ID：15501488
> 
> 赞同：1
> 
> 时间：2013-03-19T13:56:56.743
> 
> 标签：unix, caching, nginx

i had installe nginx on my local machine, my problem is i would like to do a cache for my website . help to configure nginx

this my configuration

server { server_name .mywebsite.com;

```
access_log /var/log/nginx/example.com.access.log;

    error_log /var/log/nginx/example.com.error.log;

root /var/www/example.com/html;

index index.php index.html index.htm;

# use fastcgi for all php files
location ~ \.php$
{
    fastcgi_pass 127.0.0.1:9000;
    fastcgi_index index.php;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include fastcgi_params;
}

# deny access to apache .htaccess files
location ~ /\.ht
{
    deny all;
} 
```

}

but i dosen't had any static content on my local machine

help please best regards

# c# - 委托类的用例

> ID：15501491
> 
> 赞同：1
> 
> 时间：2013-03-19T13:57:02.720
> 
> 标签：c#, delegates

作为`MulticastDelegate`.NET的主要代表类，我想问一下，有没有使用`Delegate`类的用例？

我的意思是，如果我有一个 type 变量`Delegate`和另一个type 变量，将调用`MulticastDelegate`不同的方法覆盖（例如），但是如果每个单程序员定义的委托都继承自使用类的要点？`GetInvocationList``MulticastDelegate``Delegate`

如果我假设没有，不应该`ObsoleteAttribute`用注释标记来`MulticastDelegate`代替使用吗？

或者编译器不应该默默地将“ `Delegate variable1;`”更改为“ `MulticastDelegate variable1;`”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T14:00:06.367

它并没有过时，我认为没有理由将其标记为过时。

如果您需要的唯一成员由提供`Delegate`，您为什么要使用`MulticastDelegate`？

根据我的经验`Delegate`，在 .NET API 中作为“任何委托”出现的频率比实际出现的要多得多`MulticastDelegate`。例如：

*   [`LambdaExpression.Compile`](http://msdn.microsoft.com/en-us/library/bb356928.aspx)
*   [`Control.Invoke`](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)

这两个类都存在绝对只是由于历史偶然性，但这没有理由不赞成使用 just `Delegate`。

此外，您写道：

> 我的意思是，如果我有一个 Delegate 类型的变量和另一个 MulticastDelegate 类型的变量，将调用不同的方法重载（例如 GetInvocationList）

不，[`GetInvocationList`](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx)没有超载。它在中[*被覆盖*](http://msdn.microsoft.com/en-us/library/system.multicastdelegate.getinvocationlist.aspx)，`MulticastDelegate`但没有重载。哦，请注意该方法的返回类型 - 它是`Delegate[]`，不是`MulticastDelegate[]`。

# asp.net-mvc - SignalR - 使用 Windows 和匿名身份验证时，连接 ID 的格式不正确

> ID：15501493
> 
> 赞同：6
> 
> 时间：2013-03-19T13:57:10.970
> 
> 标签：asp.net-mvc, authentication, connection, signalr

我使用 SignalR 1.0.1 作为 ASP.NET MVC3 应用程序的聊天核心。使用 IIS 7.5

在 MVC 控制器中有两种方法提供对聊天视图的访问：
1\. 第一种方法是公共的，允许匿名用户聊天 - 没有授权。2.对于域用户 - 聊天代理，
使用属性限制对第二种方法的访问。 Hub 中没有明确指定的授权。 对于这种情况，我在 IIS 上涉及 Windows 和匿名身份验证。 我还实现了自定义角色提供程序，它仅在内存中运行 - 不会将任何内容持久化到数据库中。`[Authorize]`

发生的情况是，在控制器方法中使用“[Authorize]”属性会导致从 Hub 响应 500，无论是来自授权视图的调用还是匿名视图：

请求（`send`是发送消息的 Hub 方法）：

`http://localhost:8101/signalr/send?transport=serverSentEvents&connectionToken=VIXEZzWQSn5SNlA8RUy4iaOPDFdvuPBjMvFBiG2FLfvfxF347XHwtapsEV5ndU4OEI0Xb64W2ZRXTqwBiL2CXg2_JlTaTJ2RnVOj4bjvx6tQaYhAqTaXs9k2853GYqzd0`

回复：

`The connection id is in the incorrect format.`

```
Server stack trace:
   at Microsoft.AspNet.SignalR.PersistentConnection.GetConnectionId(HostContext context, String connectionToken)
   at Microsoft.AspNet.SignalR.PersistentConnection.ProcessRequest(HostContext context)
   at Microsoft.AspNet.SignalR.Owin.CallHandler.Invoke(IDictionary2 environment)
   at Microsoft.AspNet.SignalR.Owin.Handlers.HubDispatcherHandler.Invoke(IDictionary2 environment)
   at Microsoft.Owin.Host.SystemWeb.OwinCallContext.Execute()
   at Microsoft.Owin.Host.SystemWeb.OwinHttpHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object extraData)<br/><br/> 
```

但请注意，连接到 Hub 工作正常，返回 200 OK：
`http://localhost:8101/signalr/connect?transport=serverSentEvents&connectionToken=dYOwFxa1mkgdpzw-jitRpWq9oxRlrTet8U_dAzWjFQEdGNJfVXeG7Op0NZZwvznxeNdJCuPT75CKzQqI9HRPThV3uEDt-Z2qtIl9E02gF481&connectionData=%5B%7B%22name%22%3A%22chathub%22%7D%5D&tid=9`

我在stackoverflow上发现了一个类似的线程：
[signalr The connection id is in wrong format](https://stackoverflow.com/questions/15349043/signalr-the-connection-id-is-in-the-incorrect-format)

据我了解，在调用我的`Send`方法时，集线器正在处理的请求与`Identity`用于连接集线器的请求不同，或者集线器`GetConnectionId`发现，该用户实际上没有被授权 - 但是当没有授权时它如何检查该假设在集线器本身上指定？

有人可以对此有所了解吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T18:40:44.967

SignalR 对您的连接 ID 和您的连接进行签名`Identity`，以便在`connectionToken`您每次启动新连接时创建一个新连接。然后`connectionToken`将其作为响应的一部分发送到 SignalR 客户端`negotiate`。

每次您向 SignalR 发出请求时，无论是`connect`、`reconnect`还是`send`请求，SignalR 都会验证您是否`connectionToken`与客户端的连接 ID 和 匹配`Identity`。

这`connectionToken`本质上是一个 CSRF 令牌，用于防止运行第三方网站的攻击者代表共享客户端秘密发出 SignalR 请求。显然，如果您启用了 SignalR 的跨域支持，这将无济于事，但`connectionToken`在这种情况下仍然可以正常工作。

[泰勒的回答](https://stackoverflow.com/questions/15349043/signalr-the-connection-id-is-in-the-incorrect-format)是正确的。当您的客户发生变化时，您应该`stop`然后您的 SignalR 连接。这将强制执行一个新请求，该请求将为您的客户端提供一个新的连接 id，并使用您的客户端的 updated 签名。`start``Identity``negotiate``connectionToken``Identity`

PS 服务器发送的事件`connect`请求没有失败，因为它是在您的客户端`Identity`更改之前建立的。`connectionToken`仅在收到请求时检查，但服务器发送的事件会无限期地保持响应打开。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T20:41:04.643

你说的都是真的，它实际上发生在我的问题中。

但我也找到了根本原因：
设计期间的主要假设之一是允许匿名用户无需登录即可使用聊天，而后端用户（代理）则可以使用登录到聊天的受限区域他们的 Windows 凭据。

因此，在 IIS 管理器上，我启用了匿名身份验证（允许匿名用户使用聊天）和 Windows 身份验证（允许代理使用其 Windows 凭据进行访问）。
MVC 应用程序配置为使用 Windows 身份验证 -`[Authorize]`问题中提到的属性，但仅用于限制代理查看聊天的访问权限。

上述配置实际发生的情况是：
1.当客户端（代理）请求受限视图（假设它是`/Chat/Agent`）时，该`[Authorize]`属性初始化身份验证（Windows）
2.客户端 Javascript 请求`Negotiate`，生成`connectionId`它并将其与客户端的 Windows 绑定`Identity`
3.这是棘手的部分：因为 Hub 不使用任何显式身份验证，调用`send`方法不会导致任何身份验证请求 - IIS 匿名身份验证在 Windows 身份验证之前优先，并且`send`请求以匿名方式发送`Identity`- 但在 Hub 中实际`connectionId`与`Identity`第 2 点传入有关。

这种情况导致您描述的情况 -`connect`以不同的方式调用，`Identity`集线器`send`返回`The connection id is in the incorrect format.`

# wpf - Access XBAP function

> ID：15501496
> 
> 赞同：1
> 
> 时间：2013-03-19T13:57:35.187
> 
> 标签：wpf, save, mdi, xbap

I have written a XBAP application which runs on iis at the moment. Now I have a requirement to create a new MDI application which can host multiple xbap applications. I have created this by including a web browser control in each mdi child and it works.

I now have a new reuirement (The challenge) which is to save the configuration configuration i.e selected items in dropdowns and text entered in each xbap (shown in web browser which is a part of mdi child which is a child of mdi parent). to a single xml file. The save button will be present in MDI parent. Hope I have explained it well.

Any help greatly appreciated.

Thanks

# objective-c - 如何获取要写入文本文件的数据？

> ID：15501498
> 
> 赞同：0
> 
> 时间：2013-03-19T13:57:36.123
> 
> 标签：objective-c, append

![在此处输入图像描述](../Images/e76f31183db465a06c3d4168be7a43fe.png)这是我用于控制台输出的方法。如何输出到文本文件？

```
@implementation GetMoves
   - (id)initWithDevice:(Device *)device{
    if(self = [super init]){
          _device = device;
    }

    return self;
    }

- (void)Render{
    [super ClearConsole];

    printf("MOVES INFO\n");
    printf("==================================\n");

    NSArray* data = [_device GetData:NULL];

    NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"];

    if(data != nil){
        for(int i = 0; i < data.count; i++){
            DataPoint*          current = [data objectAtIndex:i];
            NSMutableString*    output  = [[NSMutableString alloc] init];

            [output appendFormat:@"%d",(i+1)];
            [output appendString:@" - "];
            [output appendString:[dateFormatter stringFromDate:current.RecordedAt]];
            [output appendString:@" - "];
            [output appendFormat:@"%d",current.StepCount];

            printf("%s\n", [output UTF8String]);
        }
    }
    else
        printf("No new data found on device.\n");

    printf("\n");
    printf("==================================\n");
    printf("\n");

    printf("Press ENTER to continue.");
    fgetc(stdin);
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:03:59.510

你可以简单地写成：

```
 NSString *path = [@"~" stringByExpandingTildeInPath] ;
    //change your path here
    path=[path stringByAppendingString:@"/Documents/*REPORTS/"];

    //make a file name to write the data to using the documents directory:
    NSString *fileName = [NSString stringWithFormat:@"%@/TWCodeFile.txt",path];
    //create content - four lines of text
    NSString *content = @"The content of file, can be more by appending string.";
    //save content to the documents directory
    [content writeToFile:fileName
              atomically:NO
                encoding:NSStringEncodingConversionAllowLossy
                   error:nil]; 
```

# ios - Open Specific View when Opening App from Notification

> ID：15501500
> 
> 赞同：21
> 
> 时间：2013-03-19T13:57:42.007
> 
> 标签：ios, push-notification, viewcontroller

I have just added push notifications to my app. I'm wanting to have so that when a user opens the app from a notification, it will open a specific view controller and not my rootViewController. Here is my AppDelegate:

```
#import "KFBAppDelegate.h"
#import "KFBViewController.h"
#import "AboutUs.h"
#import "ContactUs.h"
#import "KYFB.h"
#import "KFBNavControllerViewController.h"
#import "KFBTabBarViewController.h"
#import "RSFM.h"
#import "LegislatorInfo.h"
#import "Events.h"
#import "ActionAlertsViewController.h"
#import "UAirship.h"
#import "UAPush.h"
#import "UAAnalytics.h"

@implementation KFBAppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // This prevents the UA Library from registering with UIApplcation by default when
    // registerForRemoteNotifications is called. This will allow you to prompt your
    // users at a later time. This gives your app the opportunity to explain the benefits
    // of push or allows users to turn it on explicitly in a settings screen.
    // If you just want everyone to immediately be prompted for push, you can
    // leave this line out.
    // [UAPush setDefaultPushEnabledValue:NO];

    //Create Airship options dictionary and add the required UIApplication launchOptions
    NSMutableDictionary *takeOffOptions = [NSMutableDictionary dictionary];
    [takeOffOptions setValue:launchOptions forKey:UAirshipTakeOffOptionsLaunchOptionsKey];

    // Call takeOff (which creates the UAirship singleton), passing in the launch options so the
    // library can properly record when the app is launched from a push notification. This call is
    // required.
    //
    // Populate AirshipConfig.plist with your app's info from https://go.urbanairship.com
    [UAirship takeOff:takeOffOptions];

    // Set the icon badge to zero on startup (optional)
    [[UAPush shared] resetBadge];

    // Register for remote notfications with the UA Library. This call is required.
    [[UAPush shared] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeBadge |
                                                         UIRemoteNotificationTypeSound |
                                                         UIRemoteNotificationTypeAlert)];

    // Handle any incoming incoming push notifications.
    // This will invoke `handleBackgroundNotification` on your UAPushNotificationDelegate.
    [[UAPush shared] handleNotification:[launchOptions valueForKey:UIApplicationLaunchOptionsRemoteNotificationKey]
                       applicationState:application.applicationState];

    // self.tabBarController = [[UITabBarController alloc] initWithNibName:@"KFBViewController" bundle:nil];
    KFBViewController *rootView = [[KFBViewController alloc] initWithNibName:@"KFBViewController" bundle:nil];
    KFBNavControllerViewController *navController = [[KFBNavControllerViewController alloc] initWithRootViewController:rootView];
    navController.delegate = rootView;
    UIViewController *aboutUs = [[AboutUs alloc] initWithNibName:@"AboutUs" bundle:nil];

    KFBNavControllerViewController *navController1 = [[KFBNavControllerViewController alloc] initWithRootViewController:aboutUs];

    UIViewController *contactUs = [[ContactUs alloc] initWithNibName:@"ContactUs" bundle:nil];
    KFBNavControllerViewController *navController2 = [[KFBNavControllerViewController alloc] initWithRootViewController:contactUs];
    UIViewController *kyfb = [[KYFB alloc] initWithNibName:@"KYFB" bundle:nil];

    KFBNavControllerViewController *navController3 = [[KFBNavControllerViewController alloc] initWithRootViewController:kyfb];

    // UIViewController *rsfm = [[RSFM alloc] initWithNibName:@"RSFM" bundle:nil];
    // KFBNavControllerViewController *navController4 = [[KFBNavControllerViewController alloc] initWithRootViewController:rsfm];

    // UIViewController *li = [[LegislatorInfo alloc] initWithNibName:@"LegislatorInfo" bundle:nil];
    // KFBNavControllerViewController *navController5 = [[KFBNavControllerViewController alloc] initWithRootViewController:li];

    // UIViewController *events = [[Events alloc] initWithNibName:@"Events" bundle:nil];
    // KFBNavControllerViewController *navController6 = [[KFBNavControllerViewController alloc] initWithRootViewController:events];
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    //self.viewController = [[KFBViewController alloc] initWithNibName:@"KFBViewController" bundle:nil];
    //self.window.rootViewController = self.viewController;
    self.tabBarController = [[KFBTabBarViewController alloc] init];
    self.tabBarController.viewControllers = @[navController, navController1, navController2, navController3];
    // self.tabBarController.customizableViewControllers = nil;

    self.window.rootViewController = self.tabBarController;
    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];

    return YES;
}

- (void)applicationWillResignActive:(UIApplication *)application
{
    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
    UA_LDEBUG(@"Application did become active.");

    // Set the icon badge to zero on resume (optional)
    [[UAPush shared] resetBadge];
}

- (void)applicationWillTerminate:(UIApplication *)application
{
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
    [UAirship land];
}

- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken {
    // Updates the device token and registers the token with UA.
    [[UAPush shared] registerDeviceToken:deviceToken];
}

- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *) error
{
    UA_LERR(@"Failed To Register For Remote Notifications With Error: %@", error);
}

- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo
{

    UA_LINFO(@"Received remote notification: %@", userInfo);

    // Send the alert to UA so that it can be handled and tracked as a direct response. This call
    // is required.
    [[UAPush shared] handleNotification:userInfo applicationState:application.applicationState];

    // Optionally provide a delegate that will be used to handle notifications received while the app is running
    // [UAPush shared].delegate = your custom push delegate class conforming to the UAPushNotificationDelegate protocol

    // Reset the badge after a push received (optional)
    [[UAPush shared] resetBadge];
}

-(NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window
{
    return UIInterfaceOrientationMaskAllButUpsideDown;
}

@end 
```

**And here is the view controller I want to open when opening a notification:**

```
#import "ActionAlertsViewController.h"
#import "RSSChannel.h"
#import "RSSItem.h"
#import "WebViewController.h"
#import "CustomCellBackground.h"

@implementation ActionAlertsViewController
{
    UIActivityIndicatorView *loadingIndicator;
}
@synthesize webViewController;

- (void)viewDidLoad
{
    self.tableView = [[UITableView alloc] initWithFrame:CGRectZero style:UITableViewStyleGrouped];
    self.title = @"Action Alerts";
    loadingIndicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    loadingIndicator.center = CGPointMake(160, 160);
    loadingIndicator.hidesWhenStopped = YES;
    [self.view addSubview:loadingIndicator];
    [loadingIndicator startAnimating];
    // UIRefreshControl *refresh = [[UIRefreshControl alloc] init];
    // refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Pull to Refresh"];
    // [refresh addTarget:self action:@selector(refreshView:)forControlEvents:UIControlEventValueChanged];
    // self.refreshControl = refresh;
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    NSLog(@"%@ found a %@ element", self, elementName);
    if ([elementName isEqual:@"channel"])
    {
        // If the parser saw a channel, create new instance, store in our ivar
        channel = [[RSSChannel alloc]init];

        // Give the channel object a pointer back to ourselves for later
        [channel setParentParserDelegate:self];

        // Set the parser's delegate to the channel object
        [parser setDelegate:channel];
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // return 0;
    NSLog(@"channel items %d", [[channel items]count]);
    return [[channel items]count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // return nil;

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"UITableViewCell"];
    if (cell == nil)
    {
        cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"UITableViewCell"];
        cell.textLabel.font=[UIFont systemFontOfSize:16.0];
    }
    RSSItem *item = [[channel items]objectAtIndex:[indexPath row]];
    [[cell textLabel]setText:[item title]];
    cell.backgroundView = [[CustomCellBackground alloc] init];
    cell.selectedBackgroundView = [[CustomCellBackground alloc] init];
    cell.textLabel.backgroundColor = [UIColor clearColor];
    cell.textLabel.highlightedTextColor = [UIColor darkGrayColor];

    return cell;
}

- (void)fetchEntries
{
    // Create a new data container for the stuff that comes back from the service
    xmlData = [[NSMutableData alloc]init];

    // Construct a URL that will ask the service for what you want -
    // note we can concatenate literal strings together on multiple lines in this way - this results in a single NSString instance
    NSURL *url = [NSURL URLWithString:@"http://kyfbnewsroom.com/category/public-affairs/notifications/feed/"];

    // Put that URL into an NSURLRequest
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Create a connection that will exchange this request for data from the URL
    connection = [[NSURLConnection alloc]initWithRequest:req delegate:self startImmediately:YES];
}

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];

    if (self)
    {
        [self fetchEntries];
    }

    return self;
}

// This method will be called several times as the data arrives
- (void)connection:(NSURLConnection *)conn didReceiveData:(NSData *)data
{
    // Add the incoming chunk of data to the container we are keeping
    // The data always comes in the correct order
    [xmlData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)conn
{
    /* We are just checking to make sure we are getting the XML
     NSString *xmlCheck = [[NSString alloc]initWithData:xmlData encoding:NSUTF8StringEncoding];
     NSLog(@"xmlCheck = %@", xmlCheck);*/

    [loadingIndicator stopAnimating];

    // Create the parser object with the data received from the web service
    NSXMLParser *parser = [[NSXMLParser alloc]initWithData:xmlData];

    // Give it a delegate - ignore the warning here for now
    [parser setDelegate:self];

    //Tell it to start parsing - the document will be parsed and the delegate of NSXMLParser will get all of its delegate messages sent to it before this line finishes execution - it is blocking
    [parser parse];

    // Get rid of the XML data as we no longer need it
    xmlData = nil;

    // Reload the table.. for now, the table will be empty
    NSMutableArray *notActionAlerts = [NSMutableArray array];
    for (RSSItem *object in channel.items) {
        if (!object.isActionAlert) {
            [notActionAlerts addObject:object];
        }
    }

    for (RSSItem *object in notActionAlerts) {
        [channel.items removeObject:object];
    }

    [[self tableView]reloadData];

    NSLog(@"%@\n %@\n %@\n", channel, [channel title], [channel infoString]);
}

- (void)connection:(NSURLConnection *)conn didFailWithError:(NSError *)error
{
    // Release the connection object, we're done with it
    connection = nil;

    // Release the xmlData object, we're done with it
    xmlData = nil;

    // Grab the description of the error object passed to us
    NSString *errorString = [NSString stringWithFormat:@"Fetch failed: %@", [error localizedDescription]];

    // Create and show an alert view with this error displayed
    UIAlertView *av = [[UIAlertView alloc]initWithTitle:@"Error" message:errorString delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [av show];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Push the web view controller onto the navigation stack - this implicitly creates the web view controller's view the first time through
    // [[self navigationController]pushViewController:webViewController animated:YES];
    [self.navigationController pushViewController:webViewController animated:NO];

    // Grab the selected item
    RSSItem *entry = [[channel items]objectAtIndex:[indexPath row]];

    // Construct a URL with the link string of the item
    NSURL *url = [NSURL URLWithString:[entry link]];

    // Construct a request object with that URL
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Load the request into the web view
    [[webViewController webView]loadRequest:req];
    webViewController.hackyURL = url;
    // Set the title of the web view controller's navigation item
    // [[webViewController navigationItem]setTitle:[entry title]];
}

/*
 -(void)refreshView:(UIRefreshControl *)refresh
{
    refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Refreshing data..."];

    // custom refresh logic would be placed here...

    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"MMM d, h:mm a"];
    NSString *lastUpdated = [NSString stringWithFormat:@"Last updated on %@",[formatter stringFromDate:[NSDate date]]];
    refresh.attributedTitle = [[NSAttributedString alloc] initWithString:lastUpdated];
    [refresh endRefreshing];
}
*/

@end 
```

**Here is the chunk of code I've added to my didFinishLaunchingWithOptions method. I've gotten almost everything working. The web views work now when selecting a row and the navigation bar is there and seemingly works as it should. The only trouble I'm having now is getting the tab bar to show up. Here is the chunk of code I'm currently using.**

```
UILocalNotification *notification = [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];

    if (notification)
    {
        ActionAlertsViewController *actionAlerts = [[ActionAlertsViewController alloc] initWithStyle:UITableViewStylePlain];
        WebViewController *wvc = [[WebViewController alloc]init];
        [actionAlerts setWebViewController:wvc];
        KFBNavControllerViewController *navController7 = [[KFBNavControllerViewController alloc] initWithRootViewController:actionAlerts];
        [self.window.rootViewController presentViewController:navController7 animated:NO completion:nil];
    } 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-19T14:14:22.727

您可以在收到远程通知时自己发布通知，并通过将视图控制器注册到此通知，您可以在收到通知后打开特定的视图控制器。

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo{

   [[NSNotificationCenter defaultCenter] postNotificationName:@"pushNotification" object:nil userInfo:userInfo];

} 
```

在您`FirstViewController.m`收听此通知的注册中。

```
-(void)viewDidLoad{  

      [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pushNotificationReceived) name:@"pushNotification" object:nil];

} 
```

在该方法中，您可以打开特定的 viewController

```
-(void)pushNotificationReceived{

 [self presentViewController:self.secondViewController animated:YES completion:nil];
} 
```

最后从 dealloc 方法中的通知中取消注册当前 viewController

```
-(void)dealloc{
[[NSNotificationCenter defaultCenter] removeObserver:self];

} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-19T14:15:08.977

如果应用程序是从通知中打开的，则应用程序委托的两种方法中的任何一种都会被调用

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo 
```

或者

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

如果是后者，launchOptions 将让您知道应用程序是否由于远程通知或其他原因而启动（请参阅[此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)的启动选项键）

检查这些方法，以便在从通知启动应用程序时打开特定的视图控制器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T14:30:11.460

你可以做这样的事情

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

self.window.rootViewController = self.tabBarController;
[self.window makeKeyAndVisible];

   // If application is launched due to  notification,present another view controller.
UILocalNotification *notification = [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];

if (notification)
{
    NotificationViewController *viewController = [[NotificationViewController alloc]initWithNibName:NSStringFromClass([NotificationViewController class]) bundle:nil];
    [self.window.rootViewController presentModalViewController:viewController animated:NO];
    [viewController release];
}

return YES;
}

 -(void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo
 {

NotificationViewController *viewController = [[NotificationViewController alloc]initWithNibName:NSStringFromClass([NotificationViewController class]) bundle:nil];

[self.window.rootViewController presentModalViewController:viewController animated:NO];
[viewController release];
} 
```

# c# - C#中的淡入淡出控制

> ID：15501501
> 
> 赞同：6
> 
> 时间：2013-03-19T13:57:43.137
> 
> 标签：c#, controls, opacity, fading

我正在尝试构建一个支持属性的`Control`派生类。 这个控件可以同时承载文本和图像，并且能够淡出和淡入它们。 这是我的代码： `Opcacity`

```
internal class FadeControl : Control
{
    private int opacity = 100;

    public FadeControl()
    {
        SetStyle(ControlStyles.SupportsTransparentBackColor, true);
    }

    public int Opacity
    {
        get
        {
            return opacity;
        }
        set
        {
            if (value > 100) opacity = 100;
            else if (value < 1) opacity = 1;
            else opacity = value;

            if (Parent != null)
                Parent.Invalidate(Bounds, true);
        }
    }

    protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;
            cp.ExStyle = cp.ExStyle | 0x20;
            return cp;
        }
    }

    protected override void OnPaintBackground(PaintEventArgs e)
    {
        //do nothing
    }

    protected override void OnMove(EventArgs e)
    {
        RecreateHandle();
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        using (Graphics g = e.Graphics)
        {
            Rectangle bounds = new Rectangle(0, 0, Width - 1, Height - 1);
            int alpha = (opacity * 255) / 100;

            using (Brush bckColor = new SolidBrush(Color.FromArgb(alpha, BackColor)))
            {
                if (BackColor != Color.Transparent)
                    g.FillRectangle(bckColor, bounds);
            }

            ColorMatrix colorMatrix = new ColorMatrix();
            colorMatrix.Matrix33 = (float)alpha / 255;
            ImageAttributes imageAttr = new ImageAttributes();
            imageAttr.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap);

            if (BackgroundImage != null)
                g.DrawImage(BackgroundImage, bounds, 0, 0, Width, Height, GraphicsUnit.Pixel, imageAttr);

            if (Text != string.Empty)
            {
                using (Brush txtBrush = new SolidBrush(Color.FromArgb(alpha, ForeColor)))
                {
                    g.DrawString(Text, Font, txtBrush, 5, 5);
                }
            }
        }
    }

    protected override void OnBackColorChanged(EventArgs e)
    {
        if (Parent != null)
            Parent.Invalidate(Bounds, true);

        base.OnBackColorChanged(e);
    }

    protected override void OnParentBackColorChanged(EventArgs e)
    {
        Invalidate();

        base.OnParentBackColorChanged(e);
    }
} 
```

我已经将控件放在一个上面有计时器的表单上。
计时器将控件的不透明度设置为从 0 到 100 并返回，并且运行良好。
我要解决的问题是控件在更改其不透明度时会闪烁。
将控件设置为`ControlStyles.DoubleBuffer`将使控件在窗体上不可见。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T09:26:46.517

我无法同时使用双缓冲区和`WS_EX_TRANSPARENT`(0x20) 作为透明背景。所以我决定通过复制父控件的内容来实现透明背景，并使用双缓冲来防止闪烁。

以下是经过测试和工作的最终源代码：

```
using System;
using System.Drawing;
using System.Drawing.Imaging;
using System.Windows.Forms;

internal class FadeControl : Control
{
    private int opacity = 100;
    private Bitmap backgroundBuffer;
    private bool skipPaint;

    public FadeControl()
    {
        SetStyle(ControlStyles.SupportsTransparentBackColor, true);
        SetStyle(ControlStyles.ResizeRedraw, true);
        SetStyle(ControlStyles.DoubleBuffer |
                 ControlStyles.AllPaintingInWmPaint |
                 ControlStyles.UserPaint, true);
    }

    public int Opacity
    {
        get
        {
            return opacity;
        }
        set
        {
            if (value > 100) opacity = 100;
            else if (value < 1) opacity = 1;
            else opacity = value;

            if (Parent != null)
                Parent.Invalidate(Bounds, true);
        }
    }

    protected override void OnPaintBackground(PaintEventArgs e)
    {
        //do nothig
    }

    protected override void OnMove(EventArgs e)
    {
        RecreateHandle();
    }

    private void CreateBackgroundBuffer(Control parent)
    {
        int offsetX;
        int offsetY;
        GetOffsets(out offsetX, out offsetY, parent);
        backgroundBuffer = new Bitmap(Width + offsetX, Height + offsetY);
    }

    protected override void OnResize(EventArgs e)
    {
        var parent = Parent;
        if (parent != null)
        {
            CreateBackgroundBuffer(parent);
        }
        base.OnResize(e);
    }

    private void GetOffsets(out int offsetX, out int offsetY, Control parent)
    {
        var parentPosition = parent.PointToScreen(Point.Empty);
        offsetY = Top + parentPosition.Y - parent.Top;
        offsetX = Left + parentPosition.X - parent.Left;
    }

    private void UpdateBackgroundBuffer(int offsetX, int offsetY, Control parent)
    {
        if (backgroundBuffer == null)
        {
            CreateBackgroundBuffer(parent);
        }
        Rectangle parentBounds = new Rectangle(0, 0, Width + offsetX, Height + offsetY);
        skipPaint = true;
        parent.DrawToBitmap(backgroundBuffer, parentBounds);
        skipPaint = false;
    }

    private void DrawBackground(Graphics graphics, Rectangle bounds)
    {
        int offsetX;
        int offsetY;
        var parent = Parent;
        GetOffsets(out offsetX, out offsetY, parent);
        UpdateBackgroundBuffer(offsetX, offsetY, parent);
        graphics.DrawImage(backgroundBuffer, bounds, offsetX, offsetY, Width, Height, GraphicsUnit.Pixel);
    }

    private void Draw(Graphics graphics)
    {
        Rectangle bounds = new Rectangle(0, 0, Width, Height);
        DrawBackground(graphics, bounds);

        int alpha = (opacity * 255) / 100;

        using (Brush bckColor = new SolidBrush(Color.FromArgb(alpha, BackColor)))
        {
            if (BackColor != Color.Transparent)
            {
                graphics.FillRectangle(bckColor, bounds);
            }
        }

        ColorMatrix colorMatrix = new ColorMatrix();
        colorMatrix.Matrix33 = (float)alpha / 255;
        ImageAttributes imageAttr = new ImageAttributes();
        imageAttr.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap);

        if (BackgroundImage != null)
        {
            graphics.DrawImage(BackgroundImage, bounds, 0, 0, Width, Height, GraphicsUnit.Pixel, imageAttr);
        }

        if (Text != string.Empty)
        {
            using (Brush txtBrush = new SolidBrush(Color.FromArgb(alpha, ForeColor)))
            {
                graphics.DrawString(Text, Font, txtBrush, 5, 5);
            }
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        if (!skipPaint)
        {
            Graphics graphics = e.Graphics;
            Draw(graphics);
        }
    }

    protected override void OnBackColorChanged(EventArgs e)
    {
        if (Parent != null)
        {
            Parent.Invalidate(Bounds, true);
        }
        base.OnBackColorChanged(e);
    }

    protected override void OnParentBackColorChanged(EventArgs e)
    {
        Invalidate();
        base.OnParentBackColorChanged(e);
    }
} 
```

请注意，该方法`CreateParams`不再存在，我也更改了构造函数。

该字段`skipPaint`是要知道什么时候不绘制，以便能够告诉父级在`OnPaint`没有无限递归的情况下将自己绘制到位图上。

`backgroundBuffer`不是实现双缓冲，而是在不渲染控件的情况下保留父级内容的副本。每次绘制都会更新，我知道有更有效的解决方案...*但是这种方法保持简单并且不应该成为瓶颈，除非您在同一个容器上拥有太多这些控件。

*：更好的解决方案是每次父级无效时更新它。此外，它在同一父级中的所有 FadeControl 之间共享。

# c - GDB 中的一个奇怪的崩溃错误

> ID：15501503
> 
> 赞同：0
> 
> 时间：2013-03-19T13:57:43.890
> 
> 标签：c, linked-list, stack, sigabrt

我尝试在 GDB 中调试这个程序，但我得到一个非常奇怪的崩溃错误（SIGABRT）。它发生在我的 pop 函数中，但我不知道为什么。有人能帮我吗？非常感谢！

我逐步浏览了 GDB，我相信崩溃发生在 i = 9 和 pop 函数中的 free(tmp) 处。

```
#include <stdio.h>
#include <stdlib.h>

#define SIZE 10
#define FALSE 0
#define TRUE  1

struct linkedStruct
{
    int elem;
    struct linkedStruct*  next;
};

typedef struct linkedStruct linked;
typedef linked* linkedPtr;

void push (linkedPtr* hd, int val)
{
    linkedPtr ptr = (linkedPtr) malloc (sizeof(linked));
    ptr->elem = val;
    ptr->next = *hd;
    *hd = ptr;
}

int isEmpty (linkedPtr hd)
{
    if (hd == NULL)
        return TRUE;
    else
        return FALSE;
}

int top (linkedPtr hd)
{
    return (hd->elem);
}

void pop (linkedPtr hd)
{
    linkedPtr tmp = hd;
    hd = hd->next;
    free (tmp);
}

void show (linkedPtr hd)
{
    while (hd != NULL)
    {
        printf ("%d, ", hd->elem);
        hd = hd->next;
    }
    printf ("\n");
}

int main (int argc, char**argv)
{
    linkedPtr head = NULL;
    int i;
    int temp;

  /* push 10 random values onto the stack showing the stack growing */
    for (i = 0 ; i < SIZE; ++i)
    {
        temp = rand() % 100;
        printf ("In main(): temp: %6d\n", temp);
        push (&head, temp);
        show (head);
    }

    printf ("\n");

  /* remove the value from the stack */
    while (!isEmpty(head))
    {
        printf ("Top of stack value is: %d\n", top(head));
        pop (head);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:01:57.320

这里的实际问题是对调用者的更改`hd`是不可见的，这导致`free()`在已经释放的内存上被调用，从而产生**未定义的行为**。

你`pop()`应该是这样的：

```
void pop (linkedPtr* hd)
{
    linkedPtr tmp = *hd;
    *hd = (*hd)->next;
    free (tmp);
} 
```

并像这样调用：

```
pop(&head); 
```

# c# - Show contents of Window in ContentControl

> ID：15501505
> 
> 赞同：0
> 
> 时间：2013-03-19T13:57:46.140
> 
> 标签：c#, .net, wpf, silverlight, contentcontrol

I have a window named `InstallerView` and wish to display its contents within another window via `ContentControl`. What is the correct syntax as currently this doesnt work?

```
<ContentControl Content="{StaticResource ResourceKey=InstallerView}" Grid.Column="0" Grid.Row="1" Height="430" /> 
```

The window is defined as such

```
<Window x:Class="MyBootstrapper.InstallerView" .... > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:03:49.660

那么`InstallerView`不是你的窗口的名字，而是你的班级的名字。因此，您可以执行以下操作，尽管我不建议这样做。

```
<Grid> <!-- I need a layout control -->
    <Grid.Resources>
        <someNs:InstallerView x:Key="IView" /> 
        <!-- someNs = the namespace of your InstallerView class -->
    </Grid.Resources>
    <!-- Now you can use the resource -->
    <ContentControl Content="{StaticResource IView}" />
</Grid> 
```

# php - 试图在 div 中获取 MySQL 数据

> ID：15501511
> 
> 赞同：0
> 
> 时间：2013-03-19T13:58:01.753
> 
> 标签：php, mysql

我正在尝试从 div 中的 MySQL 数据库中的每一行获取特定内容，但是它只显示具有最高 id 值的行中的内容。

```
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$query = "SELECT * FROM articles ORDER BY id";
$result = mysql_query($query) or die(mysql_error());

$count = mysql_num_rows($result);

while($row = mysql_fetch_array($result))
{
    $title = $row['title'];
    $summary = $row['summary'];
}
?>

<div class="content">
    <h2 class="titlecss"><?php echo ($title)?></h2>
    <p class="customfont"><?php echo ($summary)?></p>
</div> 
```

谁能解释我在这里做错了什么？我已经浏览了 2 个小时的互联网，但似乎找不到任何东西...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:01:11.173

您需要在 while 循环中输出每个 div：

```
while($row = mysql_fetch_array($result))
{
    $title = $row['title'];
    $summary = $row['summary'];
    ?>
    <div class="content">
    <h2 class="titlecss"><?php echo ($title)?></h2>
    <p class="customfont"><?php echo ($summary)?></p>
    </div>
    <?php
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:02:52.460

你应该这样做：

```
while($row = mysql_fetch_array($result)) {
   echo "<div class=\"content\">";
   echo "<h2 class=\"titlecss\">" . $row['title'] . "</h2>";
   echo "<p class=\"customfont\">" . $row['summary'] .  "</p>";
   echo "</div>";
} 
```

您这样做的方式是将每个值存储在同一个变量中。所以你把第一个值，然后是第二个，放在第一个上，然后是下一个，放在前一个上，最后你写一次（最后一个值）。

# php - Facebook Open Graph PHP 提取用户名

> ID：15501516
> 
> 赞同：0
> 
> 时间：2013-03-19T13:58:12.263
> 
> 标签：php, api, sdk, facebook-opengraph

我一直在这个网站和其他网站上搜索高低，似乎无法得到答案。

我正在使用开放图和 facebook.php，我可以从 api 中提取除用户名之外的所有内容。

这个网站上的建议并不是我所追求的，他们通常最终只是提取用户 ID。我需要用户名。

所以使用简单的方法：

```
$user_username = $facebook->api('/me?fields=username');
print_r($user_username); 
```

在我的网站上显示：

```
Array
(
[username] => MyUsername
[id] => MyID
) 
```

但是我无法获得任何代码来仅从数组中提取用户名值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:00:16.930

访问数组，我认为你需要一些更基本的 php 知识：

```
$user_username = $user_username["username"] 
```

# elasticsearch - Elasticsearch char_filter 用空格替换任何字符？

> ID：15501517
> 
> 赞同：14
> 
> 时间：2013-03-19T13:58:12.720
> 
> 标签：elasticsearch, tire

我正在为我的 Ruby on Rails 应用程序使用 elasticsearch。我想使用[char_filter](http://www.elasticsearch.org/guide/reference/index-modules/analysis/mapping-charfilter.html)用空白替换一些字符。

在 elasticsearch 教程中，它说的是：

```
"mappings" : ["ph=>f", "qu=>q"] 
```

我尝试了以下方法：

```
"mappings" : ["ph=>\s", "qu=>\s"] 
```

但是，它似乎不起作用。有什么想法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-19T20:48:44.537

您可以对空格使用 \uXXXX 表示法：

```
"mappings" : ["ph=>\s", "qu=>\\u0020"] 
```

# python - Dynamic navigation in Flask

> ID：15501518
> 
> 赞同：5
> 
> 时间：2013-03-19T13:58:15.953
> 
> 标签：python, flask

I have a pretty simple site working in Flask that's all powered from an sqlite db. Each page is stored as a row in the page table, which holds stuff like the path, title, content.

The structure is hierarchical where a page can have a parent. So while for example, 'about' may be a page, there could also be 'about/something' and 'about/cakes'. So I want to create a navigation bar with links to all links that have a parent of '/' (/ is the root page). In addition, I'd like it to also show the page that is open and all parents of that page.

So for example if we were at 'about/cakes/muffins', in addition to the links that always show, we'd also see the link to 'about/cakes', in some manner like so:

```
- About/
  - Cakes/
    - Muffins
    - Genoise
  - Pies/
- Stuff/
- Contact
- Legal
- Etc.[/] 
```

with trailing slashes for those pages with children, and without for those that don't.

Code:

```
@app.route('/')
def index():
    page = query_db('select * from page where path = "/"', one=True)
    return render_template('page.html', page=page, bread=[''])

@app.route('/<path>')
def page(path=None):
    page = query_db('select * from page where path = "%s"' % path, one=True)
    bread = Bread(path)
    return render_template('page.html', page=page, crumbs=bread.links) 
```

I already feel like I'm violating DRY for having two functions there. But doing navigation will violate it further, since I also want the navigation on things like error pages.

But I can't seem to find a particularly Flasky way to do this. Any ideas?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T13:41:07.687

“flasky”和 pythonic 方式将是使用基于类的视图和模板层次结构

首先阅读两者的文档，然后您可以根据这种方法重构您的代码：

```
class MainPage(MethodView):
    navigation=False
    context={}

    def prepare(self,*args,**kwargs):
        if self.navigation:
            self.context['navigation']={
                #building navigation
                #in your case based on request.args.get('page')
            }
        else:
            self.context['navigation']=None

    def dispatch_request(self, *args, **kwargs):
        self.context=dict() #should nullify context on request, since Views classes objects are shared between requests
        self.prepare(self,*args,**kwargs)
        return super(MainPage,self).dispatch_request(*args,**kwargs)

class PageWithNavigation(MainPage):
    navigation = True

class ContentPage(PageWithNavigation):
    def get(self):
        page={} #here you do your magic to get page data
        self.context['page']=page
        #self.context['bread']=bread
        #self.context['something_Else']=something_Else
        return render_template('page.html',**self.context) 
```

然后您可以执行以下操作：为 main_page.html 和 page_with_navigation.html 创建单独的页面然后您的每个页面“error.html, page.html, somethingelse.html”基于其中一个。关键是动态地做到这一点：

将修改prepare方法：

```
def prepare(self):
        if self.navigation:
            self.context['navigation']={
                #building navigation
                #in your case based on request.args.get('page')
            }
        else:
            self.context['navigation']=None
        #added another if to point on changes, but you can combine with previous one
        if self.navigation:
            self.context['extends_with']="templates/page_with_navigation.html"
        else:
            self.context['extends_with']="templates/main_page.html" 
```

还有你的模板： **main_page.html**

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
    {% block navigation %}
    {% endblock %}
    {% block main_content %}
    {% endblock %}
</body>
</html> 
```

**page_with_navigation.html**

```
{% extends "/templates/main_page.html" %}

{% block navigation %}
        here you build your navigation based on navigation context variable, which already passed in here
{% endblock %} 
```

**page.html 或任何其他 some_page.html。把事情简单化！**
注意第一行。您的视图设置应该进入哪个页面，您可以通过设置视图类的导航 = 轻松调整它。

```
{% extends extends_with %}

{% block main_content %}
        So this is your end-game page.
        Yo do not worry here about navigation, all this things must be set in view class and template should not worry about them
        But in case you need them they still available in navigation context variable
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T14:04:49.117

您只需拥有多个装饰器就可以在一个功能中完成它:)

```
@app.route('/', defaults={'path': '/'})
@app.route('/<path>')
def page(path):
    page = query_db('select * from page where path = "%s"' % path, one=True)
    if path == '/':
        bread = Bread(path)
        crumbs = bread.links
    else:
        bread = ['']
        crumbs = None
    return render_template('page.html', page=page, bread=bread, crumbs=crumbs) 
```

就个人而言，我会修改面包功能以使其也适用于路径`/`。

如果只是将变量添加到您的上下文中，那么我建议您查看上下文处理器： http: [//flask.pocoo.org/docs/templating/#context-processors](http://flask.pocoo.org/docs/templating/#context-processors)

# c - Can you cast a void pointer to a struct to a specific struct type at runtime?

> ID：15501522
> 
> 赞同：2
> 
> 时间：2013-03-19T13:58:27.507
> 
> 标签：c, pointers, struct, void

I have a struct defined like this:

```
struct GameState {
    int score;
    int moves;
    bool won;

    void *metadata;
};
typedef struct GameState GameState; 
```

The metadata pointer will point to another struct of a type decided at runtime. For example it might be:

```
struct KlondikeMetadata{
    bool draw3;
    int drawcount;
};
typedef struct KlondikeMetadata KlondikeMetadata; 
```

Or maybe:

```
struct FreeCellMetadata{
    int reserveCells;
};
typedef struct FreeCellMetadata FreeCellMetadata; 
```

The actual metadata struct used depends on the game the user is playing. 99% of the time this isn't a problem because I know what game the user is playing. However, there are cases where I don't (and can't) know this.

My question is, is there a way to determine or specify the correct metadata type at runtime?

For example if I could add a property to the GameState struct indicating that the metadata value is of type KlondikeMetadata and use that to cast the metadata to that type, I think I'd be golden. Is there a way to do this? Is there a way to specify a type and cast a variable at runtime in C?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T14:01:04.737

您将不得不自己对其进行编码。

最简单的解决方案是声明一个枚举：

```
typedef enum {
 GameType_Klondike,
 GameType_FreeCell,
} GameType; 
```

然后在指针之前添加该类型的字段：

```
GameType game_type;
void     *metadata; 
```

当然，这意味着您必须在初始化时*设置*字段，以记住类型。`game_type``metadata`

您还可以稍微面向对象，并`GameType`成为元数据的一部分：

```
struct Metadata {
 GameType gametype;
};

struct FreeCellMetadata {
 struct Metadata meta;
 /* rest of fields here */
};

struct KlondikeMetadata {
 struct Metadata meta;
 /* rest of fields here */
}; 
```

然后您可以将您的`void *`to 转换为，并在将指针转换为正确类型之前`struct Metadata *`检查该字段。`gametype`

对于奖励积分，请使用工会：

```
struct Metadata {
 GameType type;
 union {
 struct KlondikeMetadata klondike;
 struct FreecellMetadata freecellL;
 } game;
}; 
```

同样，这当然需要您维护数据，即当您初始化 a 时，`struct KlondikeMetadata`您必须记住设置它的`gametype`字段，依此类推。

# razor - Persisting data in Webmatrix

> ID：15501527
> 
> 赞同：2
> 
> 时间：2013-03-19T13:58:42.077
> 
> 标签：razor, persistence, webmatrix

i need some advice on what method i should use when persisting data on my site.

Each member of the site as a property with information about that property spread across multiple tabs (separate pages). I need to know how i can persist the property ID when browsing between these pages, so that they can navigate to a separate tab and still see information about the same property.

I know how to do this using cookies, but am worried that if a user uses a PC where cookies are disabled, this will screw up how things work.

Maybe session variables?

Thanks, Gavin

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:15:35.573

在 ASP.NET 网页中的请求之间持久化数据有很多选项，我在这篇文章中有详细介绍：[在 ASP.NET 网页之间传输数据](http://www.mikesdotnetting.com/Article/192/Transferring-Data-Between-ASP.NET-Web-Pages)

# php - CMS page ordering solution for custom designed CMS

> ID：15501529
> 
> 赞同：0
> 
> 时间：2013-03-19T13:58:45.743
> 
> 标签：php

I wrote my own CMS solution and I have always had problems with changing the order of pages. On my database I have a column named order which takes the automatic id of the page. For example if pageid = 16 then order = 16.

```
function shift_page_up($pageid, $pageorder, $db, $database_db){

    mysql_select_db($database_db, $db);
    $sql_previouspage = "SELECT order from pages WHERE `order` < $pageorder ORDER by `order` DESC LIMIT 1  ";
    $previouspage_result = mysql_query($sql_previouspage) or display_error(mysql_error());
    $previouspage_row = mysql_fetch_assoc($previouspage_result);

    $newpreviouspage_pageorder = $pageorder;

    $newpageorder = $previouspage_row['order'];

    $sql_update_currentpageorder = "UPDATE pages SET `order` = $newpageorder WHERE `pageid` = $pageid";

    $update_currentpageorder = mysql_query($sql_update_currentpageorder) or display_error(mysql_error());

    $sql_update_previouspageorder = "UPDATE pages SET `order` = $newpreviouspage_pageorder WHERE `pageid` = ".$previouspage_row['pageid']."";
    $update_previouspageorder = mysql_query($sql_update_previouspageorder) or display_error(mysql_error());
    }

function shift_page_down($pageid, $pageorder, $db, $database_db){
    mysql_select_db($database_db, $db);
    $sql_nextpage = "SELECT * from pages WHERE `pageid` = $pageid AND `order` > $pageorder ORDER by `order` ASC LIMIT 1 ";
    $nextpage_result = mysql_query($sql_nextpage) or display_error(mysql_error());
    $nextpage_row = mysql_fetch_assoc($nextpage_result);

    $newnextpage_pageorder = $pageorder;

    $newpageorder = $nextpage_row['order'];

    $sql_update_currentpageorder = "UPDATE pages SET `order` = $newpageorder WHERE `pageid` = $subpageid";

    $update_currentpageorder = mysql_query($sql_update_currentpageorder) or display_error(mysql_error());

    $sql_update_nexpageorder = "UPDATE pages SET `order` = $newnextpage_pageorder WHERE `pageid` = ".$nextpage_row['pageid']."";
    $update_nexpageorder = mysql_query($sql_update_nexpageorder) or display_error(mysql_error());
} 
```

So the main idea is to swap the order of the pages on the ORDER column duplicated from their page id's which are automatically generated. I have already coded mechanisms to avoid swapping pages with the highest and lowest order using `SELECT MIN(order)` and `SELECT MAX(order)` respectively.

To shift the order up the anchor link `<a href="order_up.php?pageid=<?php echo $row_get_pages['pageid']; ?>&pageorder=<? echo $row_get_pages['order']; ?>&swapped=<?php echo str_replace( " ", "-", $row_get_pages['pagename']); ?>"> <img onclick="bounce_page('<?php echo $row_get_pages['pagename']; ?>');" src="images/ico/arrow-090.png" width="16" height="16" align="right" style="cursor:pointer;" /></a>` is clicked

To shift the order down the anchor link `<a href="order_down.php?pageid=<?php echo $row_get_pages['pageid']; ?>&amp;pageorder=<? echo $row_get_pages['order']; ?>&swapped=<?php echo str_replace( " ", "-", $row_get_pages['pagename']); ?>"><img onclick="bounce_page('<?php echo $row_get_pages['pagename']; ?>');" src="images/ico/arrow-270.png" width="16" height="16" style="cursor:pointer;" /> </a>` is clicked

**This beautifully works at times especially when the pages table is truncated and the page id's start at 0**. *But an emptied table or a page deleted somewhere always bring issues. When I click on any up or down link no values are swapped*

# javascript - Search and replace unicode character

> ID：15501534
> 
> 赞同：1
> 
> 时间：2013-03-19T13:58:53.153
> 
> 标签：javascript, jquery, regex, unicode

I'm using this [search and replace](https://github.com/cowboy/jquery-replacetext/tree/master/docs) jQuery script . I'm trying to put every character in a span but it doesn't work with unicode characters.

```
$("body").children().andSelf().contents().each(function(){
    if (this.nodeType == 3) {
        var $this = $(this);
        $this.replaceWith($this.text().replace(/(\w)/g, "<span>$&</span>"));
    }
}); 
```

Should I change the node type ? by what ?

thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:01:56.990

用“。”替换 \w （仅单词字符）（所有字符）

```
$("body").children().andSelf().contents().each(function(){
    if (this.nodeType == 3) {
        var $this = $(this);
        $this.replaceWith($this.text().replace(/(.)/g, "<span>$&</span>"));
    }
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:03:01.420

匹配“任何字符”的 RegEx 模式`.`不是`\w`（只匹配“单词字符”——在大多数 JS 中，字母数字字符和下划线`[a-zA-Z0-9_]`）。注意`.`也匹配空格字符。要仅匹配和替换非空格字符，您可以使用`\S`.

有关 JS RegEx 语法的完整列表，请参阅[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions#Using_Special_Characters)。

要替换任何和所有字符，请制作您的正则表达式`/./g`

```
$("body").children().andSelf().contents().each(function(){
    if (this.nodeType == 3) {
        var $this = $(this);
        $this.replaceWith($this.text().replace(/(.)/g, "<span>$&</span>"));
    }
}); 
```

# javascript - 快速路由中的自定义事件侦听器

> ID：15501539
> 
> 赞同：0
> 
> 时间：2013-03-19T13:59:02.857
> 
> 标签：javascript, node.js, express, events, dom-events

在快速路由中处理自定义事件侦听器的最佳方法是什么？

我可能做错了，但这是我目前所拥有的：

```
module.exports = {
    get: function(req, res, next) { 

        MyModel.on('error', function(err) {
          res.send(501)
        })

        MyModel.on('found', function() {
          res.send(200)
        })

        MyModel.on('notFound', function() {
          res.send(404)
        })

        MyModel.findByName(req.params.name);
      }
} 
```

我可以看到这是完全错误的，因为每个事件侦听器都会被添加到每个请求中。

在触发事件时开始传递响应对象以促进响应也是错误的。

我可以在`findByName`方法上使用回调，但我真的很喜欢绑定到事件系统，但我只是想知道如何更好地处理这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:10:13.017

不要为此使用事件绑定，使用回调函数：

```
module.exports = {
    get: function(req, res, next) {
        MyModel.findByName(req.params.name, function (error, model) {
            if (error) {
                return res.status(501).send(error);
            }
            if (!model) {
                return res.status(404).send('Not found');
            }
            res.send(model.toJSON());
        });
      }
} 
```

为了根据评论添加一些说明，您的示例使用的是 express 和 mongoose，两者均由同一原作者编写，并且都主要面向函数式编程和回调。虽然可以设计框架以使用事件、回调或两者/两者（可选），但在这两种特定情况下，库会强制您使用回调，因为它不为这些特定操作提供事件。这就是为什么对于这些​​特定调用的 express 和 mongoose，回调是惯用的东西。

现在看看您的示例，猫鼬确实在模型类级别发出了一些事件，但这些事件与快速请求/响应无关，因此更适合错误记录和异常处理以及基本 Web 应用程序之外的其他一些特殊用例响应渲染。

因此，当我说“不要*为此*用户事件绑定”时，我并不是说事件绑定永远不合适，只是考虑到您的特定代码片段，您正在使用的库既不支持它们，也不是此示例的惯用语一个基本的 make-a-db-query-and-send-back-a-web-page 场景。

# jquery - jquery ui 手风琴 - 如何仅使标题标签的文本充当触发器

> ID：15501549
> 
> 赞同：1
> 
> 时间：2013-03-19T13:59:27.373
> 
> 标签：jquery, user-interface, accordion

我有一个动态填充的手风琴。在用作触发器的 h2 中，有几个字段是隐藏的，只有在单击“编辑”图标时才会显示。

这是我的问题：当我单击 h2 （任何地方）时，它不仅会打开面板（这是适当的），还会使编辑字段可见。

我怎么只让 h2 的文本成为触发器？

代码（修改）：

```
<h2><span class="heading_span"><?=$oResource->section_order?>.&nbsp;</span>
 <?=$oResource->name?> <span class="note">(Section)</span>
 <a onclick="$resources.deleteResource(<?=$oResource->id?>)" href="Javascript:;" title="Delete this section" class="delete-resource" style="display: inline">
     <img src="/public/images/icons/delete.gif"">
 </a>
 <a onclick="$compass.resources.showEdit(<?=$oResource->id?>)" href="Javascript:;" title="Edit this section" class="edit-resource" style="display: inline">
     <img src="/public/images/icons/pencil.gif"">
 </a>
 <span id="edit-resource-<?=$oResource->id?>" style="display: none;">
     <span class="note">Order:</span>
     <select name="section-order-id-<?=$oResource->id?>" id="section-order-id-<?=$oResource->id?>" >
          <?= printOptions(Models\Core\resource::optionArrayList('section',''), array('selected'=>$oResource->section_order) ); ?>
     </select>
     <input type="text" placeholder="New Section Name"/>
     <button type="button" onclick="$resources.edit(<?=$oResource->id?>,<?=$oResource->section_order?>,'<?=$oResource->name?>','<?=$oResource->type?>',''); return false;">Save</button>
     <img src="<?=$oTheme->getUrl ()?>/ajax_loading_small.gif" alt="" id="loading-<?=$oResource?>" style="display: none;"/>
 </span> 
```

然后所有的部分项目都在下面......

# asp.net-mvc-3 - “输入验证错误”类不会添加到该文本框中

> ID：15501551
> 
> 赞同：2
> 
> 时间：2013-03-19T13:59:42.780
> 
> 标签：asp.net-mvc-3

在我的 mvc3 应用程序视图中，我已经在 javascript 下注册。

```
jquery.validate.js
jquery.validate.unobtrusive.js 
```

我还在我的 web.config 中添加了以下键。

```
<add key="ClientValidationEnabled" value="true" />
<add key="UnobtrusiveJavaScriptEnabled" value="true" /> 
```

我还在文本框上方添加了带有错误消息的必需属性，但是当我在文本框中提交带有空白值的表单时，“input-validation-error”类将不会添加到该文本框中。

请告诉我提交表单时不会添加“input-validation-error”类的原因。？？？

提前致谢。

杰伊什·吉诺亚

# java - 将字符串解析为地图的最有效方法是什么？

> ID：15501555
> 
> 赞同：0
> 
> 时间：2013-03-19T14:00:00.517
> 
> 标签：java, parsing, csv, map

我正在查看的代码是一个 URL 调用，它返回一个由用于绘制图表的点组成的字符串。[14.1(point),1363649400(UTC 时间戳将稍后转换)]

```
String = [14.1,1363649400],[14.4,1363650300],[14.6,1363651200],[15.1,1363652100],[14.3,1363653000],[14.2,1363653900],[14.8,1363654800]................ 
```

最好的方法似乎是删除方括号，然后使用 String.split()。

所以想知道是否有人对如何将此字符串转换为地图有更好的想法，比如说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:06:11.793

像这样：

```
points[] = string.substring(1, string.length()-1).split("],["); 
```

这将导致一个数组

```
"1,3", "3,4" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:12:11.337

这将负责解析和构建地图。地图也将按时间戳排序。

```
final Matcher m = Pattern.compile("\\[(.*?),(.*?)\\]").matcher(input);
final Map<Long, Double> points = new TreeMap<>();
while (m.find()) 
  points.put(Long.parseLong(m.group(2), Double.parseDouble(m.group(1))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T14:13:37.010

创建一个类来保存您的数据对象：

```
private static final class Data {

    private final BigDecimal point;
    private final Date date;

    public Data(final String point, final String date) {
        this.point = new BigDecimal(point);
        this.date = new Date(Long.parseLong(date));
    }

    @Override
    public String toString() {
        return "Data{" + "point=" + point + ", date=" + date + '}';
    }
} 
```

现在使用正则表达式模式解析字符串，随时构建`Data`对象。我使用了所有格匹配器，因为`String`它可能很长，并且您不希望快速引擎沿着它反复回溯以尝试匹配。

就像这里`Data`一样，甚至可以将单个`String`s 解析为真实的数据类型。

```
public static void main(String[] args) {
    final String s = "[14.1,1363649400],[14.4,1363650300],[14.6,1363651200],[15.1,1363652100],[14.3,1363653000],[14.2,1363653900],[14.8,1363654800]";
    final Pattern p = Pattern.compile("\\[([^,]++),(\\d++)\\]");
    final Matcher matcher = p.matcher(s);
    final Collection<Data> datas = new LinkedList<Data>();
    while (matcher.find()) {
        datas.add(new Data(matcher.group(1), matcher.group(2)));
    }
    for (final Data data : datas) {
        System.out.println(data);
    }
} 
```

输出：

```
Data{point=14.1, date=Fri Jan 16 19:47:29 GMT 1970}
Data{point=14.4, date=Fri Jan 16 19:47:30 GMT 1970}
Data{point=14.6, date=Fri Jan 16 19:47:31 GMT 1970}
Data{point=15.1, date=Fri Jan 16 19:47:32 GMT 1970}
Data{point=14.3, date=Fri Jan 16 19:47:33 GMT 1970}
Data{point=14.2, date=Fri Jan 16 19:47:33 GMT 1970}
Data{point=14.8, date=Fri Jan 16 19:47:34 GMT 1970} 
```

显然，您可以将它们`Data`放入`Map`或`Set`或任何适合您的东西中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:22:16.417

至少对我来说，使用正则表达式似乎不是最好的方法。说实话，java中正则表达式的性能真的很差。我会自己编写一个解析器，它只需要`O(n)`n 作为字符串的长度。

我会怎么做：

```
public void splitSequence(String str) {
                List<Double> lstPoint = new ArrayList<>();
    List<Long> lstTime = new ArrayList<>();
    char[] buf = new char[128];
    int i=0;
    boolean isPoint = true;
    for(Character c : str.toCharArray()) {
        if(c == ',') {
            if(isPoint) {
                lstPoint.add(new Double(new String(buf,0,i)));
                isPoint = false;
            }
            else {
                lstTime.add(Long.parseLong(new String(buf,0,i)));
                isPoint = true;
            }
            buf = new char[128];
            i=0;
        } else if(!(c == '[' || c == ']')) {
            buf [i++] = c;
        }
    }
    }
//usage
splitSequence("[14.1,1363649400],[14.4,1363650300],[14.6,1363651200],[15.1,1363652100],[14.3,1363653000],[14.2,1363653900],[14.8,1363654800]"); 
```

# android - java.lang.IllegalStateException：resourceIdToResName 一定有一些重叠

> ID：15501556
> 
> 赞同：5
> 
> 时间：2013-03-19T14:00:01.967
> 
> 标签：android, robolectric

我正在尝试为我的 android 应用程序设置 robolectric。我的主要代码有一个子模块和一个外部库，我不使用 Maven。

按照[步骤](http://pivotal.github.com/robolectric/eclipse-quick-start.html)设置 robolectric 项目后，当我尝试运行测试时出现以下错误

```
java.lang.IllegalStateException: there must have been some overlap for resourceIdToResName! expected 3014 but got 3013
    at org.robolectric.res.MergedResourceIndex.merge(MergedResourceIndex.java:20)
    at org.robolectric.res.MergedResourceIndex.<init>(MergedResourceIndex.java:12)
    at org.robolectric.res.RoutingResourceLoader.<init>(RoutingResourceLoader.java:22)
    at org.robolectric.RobolectricTestRunner.createAppResourceLoader(RobolectricTestRunner.java:631)
    at org.robolectric.RobolectricTestRunner.getAppResourceLoader(RobolectricTestRunner.java:614)
    at org.robolectric.internal.ParallelUniverse.setupApplicationState(ParallelUniverse.java:35)
    at org.robolectric.RobolectricTestRunner.setupApplicationState(RobolectricTestRunner.java:414)
    at org.robolectric.RobolectricTestRunner$2.evaluate(RobolectricTestRunner.java:297)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.robolectric.RobolectricTestRunner$1.evaluate(RobolectricTestRunner.java:241)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

任何人都可以帮我解决它！它尝试合并来自两个来源的 resourceIdToResName 映射，这些来源是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T15:20:42.447

此问题可能是由您的主项目 res 文件夹中的某些内容引起的，可能是布局 xml 文件。

要分析此从您的 res 文件夹中删除文件，直到测试项目运行。在实验性地删除 res 文件以查找错误文件时在主项目中编译错误不会停止您的测试项目运行，但必须没有阻止生成 R.java 的资源错误。

我的问题是布局文件中的错误，如下所示：

```
 <TextView android:id="@+android:id/actualValue" 
```

改成之后

```
 <TextView android:id="@+id/actualValue" 
```

一切正常。

# python - 背包问题，但允许过度填充

> ID：15501558
> 
> 赞同：2
> 
> 时间：2013-03-19T14:00:08.860
> 
> 标签：python, knapsack-problem

假设我有 5 个项目（名称、大小、值），如下所示：

```
("ITEM01", 100, 10000)
("ITEM02", 24, 576)
("ITEM03", 24, 576)
("ITEM04", 51, 2500)
("ITEM05", 155, 25) 
```

我必须得到最接近的匹配，总大小为 150（每个项目只能添加一次）。

这与背包问题非常相似，但不完全相似，因为在这种情况下，我的首选解决方案是`ITEM01`，`ITEM04`总大小为 151（背包问题将阻止我超过 size = 150 并因此给出，`ITEM01`总大小为148)。`ITEM02``ITEM03`

这个问题有名字吗？（还是`combinatorial optimisation`）？我正在寻找一个 python 解决方案，但如果我知道我正在寻找的东西的名称会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T11:52:10.157

您可以尝试使用动态编程来做到这一点。

让`dp[k]`等于一个项目列表，大小之和等于`k`。最初`d[0] = []`和`dp[k] = None`为`k > 0`. 列表的大小可能受所有元素大小之和的限制，我们称之为`S`。

该算法所做的是对每个`item`从`i = S`下降到的项目`i = 0`进行检查`dp[i] != None`，这意味着我们知道我们能够选择大小总和等于 的项目`i`。这些项目都在清单上`dp[i]`。让我们观察一下，我们可以将当前添加`item`到该列表中，并拥有一组总和等于 的项目`i + item.size`。所以我们分配`dp[i + item.size] = dp[i] + [item]`. 处理完所有项目后，我们只需从所需的尺寸总和开始，然后双向寻找最接近的匹配项。

代码：

```
items = [("ITEM01", 100, 10000), ("ITEM02", 24, 576), \
    ("ITEM03", 24, 576), ("ITEM04", 51, 2500), ("ITEM05", 155, 25)]
S = sum([item[1] for item in items])
dp = [None for i in xrange(S + 1)]
dp[0] = []

for item in items:
    for i in xrange(S, -1, -1):
        if dp[i] is not None and i + item[1] <= S:
            dp[i + item[1]] = dp[i] + [item]

desired_sum = 150
i = j = desired_sum

while i >= 0 and j <= S:
    if dp[i] is not None:
        print dp[i]
        break
    elif dp[j] is not None:
        print dp[j]
        break
    else:
        i -= 1
        j += 1 
```

输出：

```
[('ITEM01', 100, 10000), ('ITEM04', 51, 2500)] 
```

然而，这个解决方案的复杂性在于`O(n*S)`项目`n`的数量和`S`大小的总和，所以对于某些目的来说它可能太慢了。在这个解决方案中可以改进的是`S`常数。例如，您可以设置`S`为，`2 * desired_sum`因为我们保证我们可以获取一组大小总和为的项目`[0, 2 * desired_sum]`（可能是一个带有 sum 的空集`0`）。如果您想至少取一件物品，您可以取所有物品`S = max(min_item_size, 2 * desired_sum - min_item_size)`的`min_item_size`最小尺寸。

**编辑**：

哦，当两个组合同样接近时，您还希望获得最大价值`desired_size`。然后您必须稍微更改代码以保持每个大小总和的最佳组合。

即：

```
if dp[i] is not None and i + item[1] <= S: 
```

应该：

```
if dp[i] is not None and i + item[1] <= S and \
    (
        dp[i + item[1]] is None
        or
        sum(set_item[2] for set_item in dp[i]) + item[2]
            > sum(set_item[2] for set_item in dp[i + item[1]])
    ): 
```

（有点难看，但是不知道怎么打断线让它看起来更好看）

当然，您可以保留这些总和以避免每次都计算它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T16:23:52.780

假设你有一个工作的背包求解器并且有很多时间：

将每个项目的值设置为每个项目的重量并解决容量为 150 的背包问题。这将使您的最大尺寸小于目标（在您的示例中为 148）。所以要考虑的最大尺寸是 150 + (150 - 148) = 152

现在对 150 到 152 之间的每个整数再次求解。如果您发现较小的差异（在您的示例中为 151）停止，请使用该差异并使用原始项目值求解值。如果范围很大，您也可以尝试二进制搜索。

否则求解容量为 148 和 152 的原始背包问题，并选择最大的解决方案。

# javascript - JavaScript regex parts of file in specific format

> ID：15501562
> 
> 赞同：1
> 
> 时间：2013-03-19T14:00:16.060
> 
> 标签：javascript, regex, node.js

Okay, I'm playing with some JavaScript regular expressions as a bit of practice and I've set myself the task of turning this text file into a json object:

**Text file**:

```
title: #HEY
image: http://localhost:4089/assets/images/backgrounds/bg.jpg
date: 2013-03-19 13:48:30
excerpt: The path of the righteous man is beset on all sides by the iniquities of the selfish and the tyranny of evil men.
body: 
The path of the righteous man is beset on all sides by the iniquities of the selfish and the tyranny of evil men. Blessed is he who, in the name of charity and good will, shepherds the weak through the valley of darkness, for he is truly his brother\'s keeper and the finder of lost children. And I will strike down upon thee with great vengeance and furious anger those who would attempt to poison and destroy My brothers. And you will know My name is the Lord when I lay My vengeance upon thee.

Normally, both your ***** would be dead as ****** fried chicken, but you happen to pull this **** while I'm in a transitional period so I don\'t wanna kill you, I wanna help you. But I can\'t give you this case, it don\'t belong to me. Besides, I\'ve already been through too much **** this morning over this case to hand it over to your dumb ***.

The path of the righteous man is beset on all sides by the iniquities of the selfish and the tyranny of evil men. Blessed is he who, in the name of charity and good will, shepherds the weak through the valley of darkness, for he is truly his brother\'s keeper and the finder of lost children. And I will strike down upon thee with great vengeance and furious anger those who would attempt to poison and destroy My brothers. And you will know My name is the Lord when I lay My vengeance upon thee. 
```

**into** this:

```
{
    title: '#HEY',
    image: 'http://localhost:4089/assets/images/backgrounds/bg.jpg',
    date: '2013-03-19 13:48:30',
    excerpt: 'The path of the righteous man is beset on all sides by the iniquities of the selfish and the tyranny of evil men. Blessed is he who, in the name of charity and good will, shepherds the weak through the valley of darkness, for he is truly his brother\'s keeper and the finder of lost children. And I will strike down upon thee with great vengeance and furious anger those who would attempt to poison and destroy My brothers. And you will know My name is the Lord when I lay My vengeance upon thee.

Normally, both your ***** would be dead as ****** fried chicken, but you happen to pull this **** while I'm in a transitional period so I don\'t wanna kill you, I wanna help you. But I can\'t give you this case, it don\'t belong to me. Besides, I\'ve already been through too much **** this morning over this case to hand it over to your dumb ***.

The path of the righteous man is beset on all sides by the iniquities of the selfish and the tyranny of evil men. Blessed is he who, in the name of charity and good will, shepherds the weak through the valley of darkness, for he is truly his brother\'s keeper and the finder of lost children. And I will strike down upon thee with great vengeance and furious anger those who would attempt to poison and destroy My brothers. And you will know My name is the Lord when I lay My vengeance upon thee. '
} 
```

I figured regular expressions would be best for this (since it's a Node experiment) and currently I have this expression (which I'm sure can be greatly improved) but it has an issue with the body containing line breaks between paragraphs.

```
/^(.*)\: ?\n?(.*)/gim 
```

How can I get it to select the whole body text instead of skipping the middle paragraph?

[edit]

To clarify, I'm not interested in the making json part, this isn't my question and not a problem, it's the regular expression that is the question.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T09:59:46.383

So I worked long and hard on this, doesn't appear it can actually be done nicely so I've gone with loading a json file instead and using

```
JSON.parse() 
```

Does what I wanted it to.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-19T14:39:44.363

The only way that I found to do it is:

```
var matches = content.match(/^(\w+)\: ?\n?(.*)\n/gim);
var json = {};
for(var line in matches) {
    line = matches[line];
    var match = line.match(/^(\w+)\: ?\n?(.*)/im);
    json[match[1]] = match[2];
} 
```

But it isn't perfect.

example: [http://jsfiddle.net/23UnR/](http://jsfiddle.net/23UnR/)

# php - 通过ajax的PHP成功响应问题 - jquery

> ID：15501567
> 
> 赞同：1
> 
> 时间：2013-03-19T14:00:17.920
> 
> 标签：php, ajax, jquery

我在让搜索功能使用 ajax 在用户输入名称时显示结果时遇到了一些麻烦。这是有问题的网站（您可以单击查看全部以查看可搜索的内容） [http://ra-yon.com/beta/Test_sites/HFE/admin/contact.php](http://ra-yon.com/beta/Test_sites/HFE/admin/contact.php)正在 执行的查询 [http://ra-yon .com/beta/Test_sites/HFE/include/queryc.php?query=ra-yon&clause=email](http://ra-yon.com/beta/Test_sites/HFE/include/queryc.php?query=ra-yon&clause=email)

有问题的代码

```
<html>
    <head>

<style type="text/css">
body
{
background:black;
color:black;
width:100%;

}
#center
{
width:90%;
height:110%;
background:white;
margin:0 auto;
text-align:center;
color:black;
}
#insert{
background:navy; color:white; font-family:impact; font-size:18px;width:170px; height:170px; border-radius:50%;
margin:0 auto;
float: left; margin-left: 100px;
top:200px;
position: relative;
}
#insert:hover

{
background:white;
color:navy;
}
label
{width:150px;}
td
{
    border:solid 2px black;
    max-width: 250px;
    text-align: center;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script language="javascript" type="text/javascript">

function sendPHP(){

$('#table,#table2').css('display','none');
var query     = $('#searchname').attr('value');
var clause     = $('#searchclause').attr('value');
$.ajax({
    url: '../include/queryc.php?,
    type: 'POST',
  data: "query="+query+"&clause="+clause,
    dataType: 'html',
    success:
    function(data) {
        $(data).appendTo('#table');
    }
});
return false;
}

</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script></head>

<body>
   <a href="index.php"> <h4 style="float:right; color:blue; position: relative; left:-100px;" id="goback"> Go back? </h4></a>
    <div id="center">
<div id="queryform1" >
    <a href="#" onclick="$('#table2').css('display','block');">View All?</a>
    <span style="color:black;">search</span> <input type='text' onKeyUp="sendPHP();" name='searchname' id="searchname" />

<span style="color:black;">search by</span> <select name="searchclause" id="searchclause">
    <option value="name">Name</option>
    <option value="email">Email Address</option>
    <option value="subject">Subject</option>
    <option value="date">Date</option>

</select>
<a href="../include/downloadcontact.php">Download file?</a>

<div id="table2" style="display: none; margin: 0 auto; position: relative; top:40px; max-width:700px;">
    <div id="viewall">
        <?php
        include '../include/include.php';
        $sql = 'select * from contactus' ;

//print_r($sql);
$result=mysql_query($sql);

        ?>
        <table>
<tbody>
<th>Name</th><th>Email</th><th>Subject</th><th style="width:200px;">Message</th><th>Date</th>
<tr>
<?php
while ($client = mysql_fetch_array($result, MYSQL_ASSOC)){
echo "
<tr>

<td >".$client[name]."</td>
<td >".$client[email]."</td>
<td >".$client[subject]."</td>
<td >".$client[message]."</td>
<td >".$client[date]."</td>

</tr>";
} ?>
</tbody></table>
</div></div><div id="table">TestTestTest</div>

</div></div>

</body>
</html> 
```

现在有点乱，我打算等我用完后清理一下。非常感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:05:59.427

在控制台中检查了您的代码。你的功能失败了。您在这里缺少单引号：

```
 url: '../include/queryc.php?', 
```

我使用 Google Chrome 的控制台以及在 Mozilla Firefox 的 Firbug 扩展中找到的控制台。他们在帮助解决小问题方面都非常宝贵

# forms - 表单验证 - 我收到两次标签

> ID：15501569
> 
> 赞同：7
> 
> 时间：2013-03-19T14:00:19.493
> 
> 标签：forms, validation, symfony, twig

我有一个注册表单 - 来自 FOSUserBundle，它在模板中：

```
{% form_theme form 'AcmeMyBundle:Form:errors.html.twig' %}

   <form class="big-spacer" action="{{ path('fos_user_registration_register') }}" {{ form_enctype(form) }} method="POST" class="fos_user_registration_register">
        {{ form_widget(form) }}
        <div>
            <input class="btn little-spacer" type="submit" value="{{ 'registration.submit'|trans({}, 'FOSUserBundle') }}" />
        </div>
    </form> 
```

这里是`errors.html.twig`：

```
{% block field_errors %}
    {% spaceless %}

        {% if errors|length > 0 %}

            <ul class="little-spacer nav text-error">
                {% for error in errors %}
                    <li>{{loop.index}}. {{ error.messageTemplate|trans(error.messageParameters, 'validators') }}</li>
                {% endfor %}
            </ul>

        {% endif %}
    {% endspaceless %}
{% endblock field_errors %} 
```

我刚刚从 TwitterBootstrap 添加了一些 css 类。

问题是我两次收到一些验证消息。

我的表单有 4 个字段 -**用户名、电子邮件、密码、确认密码**

我试图打破尽可能多的验证规则，这是输出：

对于`Username`：

1.  此用户名已被使用。请选择另一个。
2.  用户名太短 - 请输入至少 2 个符号。
3.  用户名太短 - 请输入至少 2 个符号。

对于`email`：

1.  请输入有效电子邮件。
2.  请输入有效电子邮件。

如果我输入已使用的电子邮件，则错误仅显示一次：

1.  此邮箱已被占用。

对于`passwords`：

如果它们很短：

1.  密码太短 - 请输入至少 6 个符号。
2.  密码太短 - 请输入至少 6 个符号。

如果它们不匹配：

1.  输入的密码不匹配。

另一个奇怪的是，当我重新提交表单时，仍然无效，密码长度的通知只有一个：

1.  密码太短 - 请输入至少 6 个符号。

在重新提交之前，他们是两个。

您是否知道为什么某些错误会显示两次以及如何解决此问题？非常感谢您！:)

* * *

**更新**

这是`C:\xampp\htdocs\Project\src\Acme\MyBundle\Entity\User.php`

```
namespace Acme\MyBundle\Entity;

use FOS\UserBundle\Entity\User as BaseUser;
use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="fos_user")
 */
class User extends BaseUser
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    public function __construct()
    {
        parent::__construct();
        // your own logic
    }
} 
```

在`C:\xampp\htdocs\Project\app\Resources\FOSUserBundle\translations\`我复制了文件`validators.en.yml`并在其中删除了`[-Inf, Inf]`部分并稍微更改了消息。

我还覆盖了验证文件 - 我在这里复制了它：

`C:\xampp\htdocs\Project\src\Acme\MyBundle\Resources\config\validation.xml`

我只更改了密码的最小长度。其他一切都与原始文件中的相同。

我的包扩展了 FOSUserBundle：

`C:\xampp\htdocs\Project\src\Acme\MyBundle\AcmeMyBundle.php`该文件包含以下内容：

```
<?php

namespace Acme\BudgetTrackerBundle;

use Symfony\Component\HttpKernel\Bundle\Bundle;

class AcmeBudgetTrackerBundle extends Bundle
{
    public function getParent() 
    {
        return 'FOSUserBundle';
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-20T11:23:23.050

好的，这是一个已知问题。

让我们看看这里：[https ://github.com/symfony/symfony/issues/2605](https://github.com/symfony/symfony/issues/2605)

解决方案是：为要覆盖的属性验证规则创建自己的验证组。在你的validation.xml 中，只放置你想要一些不同规则的属性，并在一个新的验证组上定义验证。

因此，对于validation.xml，仅修改实体的plainPassword 验证规则 (Acme\MyBundle\Entity\User) ：

```
<?xml version="1.0" ?>
<constraint-mapping xmlns="http://symfony.com/schema/dic/constraint-mapping"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://symfony.com/schema/dic/constraint-mapping
http://symfony.com/schema/dic/constraint-mapping/constraint-mapping-1.0.xsd">

    <class name="Acme\MyBundle\Entity\User"> 

        <property name="plainPassword">
            <constraint name="NotBlank">
                <option name="message">fos_user.password.blank</option>
                <option name="groups">Registration</option>
            </constraint>
            <constraint name="Length">
                <option name="min">6</option>
                <option name="minMessage">fos_user.password.short</option>
                <option name="groups">
                    <value>RegistrationAcme</value>
                    <value>ProfileAcme</value>
                </option>
            </constraint>
        </property>
    </class> 

</constraint-mapping> 
```

现在您必须声明您对受影响的表单（注册表和个人资料）使用不同的验证组。幸运的是，FOSUserBundle 是一个很好的实践示例，它允许您在 config.yml 中覆盖它们：

```
fos_user:
    registration:
        form:
            validation_groups: [Default, RegistrationAcme]
    profile:
        form:
            validation_groups: [Default, ProfileAcme] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T08:30:12.707

```
# config.yml
# ...
fos_user:
    db_driver:     orm
    firewall_name: main
    user_class:    Acme\YourBundle\Entity\User
    registration:
        form:
            type: acme_user_registration
            validation_groups: [Registration]
# ... 
```

添加最后一行 ("validation_groups: [Registration]") 只会导致一个错误。只有 FOSUserBundle 验证：“注册”。

# junit - 如何使用 PowerMock 和 Mockito 模拟默认构造函数？

> ID：15501572
> 
> 赞同：0
> 
> 时间：2013-03-19T14:00:24.560
> 
> 标签：junit, mockito, powermock

我应该如何使用 PowerMock-Mockito(No EasyMock) 模拟默认构造函数？

我想通过这样做来访问对象的值。

例如 ：

```
Class A {

public A()
{
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:09:46.517

`PowerMockito.whenNew`应该使用 API 来执行此操作。有关更多信息，请参阅此链接：[如何模拟新对象的构造](https://github.com/jayway/powermock)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T13:24:07.903

来自[文档](https://code.google.com/p/powermock/wiki/MockitoUsage13#How_to_mock_construction_of_new_objects)

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(X.class)
public class XTest {
        @Test
        public void test() {
                whenNew(MyClass.class).withNoArguments().thenThrow(new IOException("error message"));

                X x = new X();
                x.y(); // y is the method doing "new MyClass()"

                ..
        }
} 
```

# javascript - 这是否与 JS 数组复制在没有循环展开的情况下一样快？

> ID：15501573
> 
> 赞同：0
> 
> 时间：2013-03-19T14:00:24.527
> 
> 标签：javascript, optimization

这与[这个问题有关](https://stackoverflow.com/q/15501251/907415)。

我听说带有递减和大于测试的 while 模式比任何其他循环模式都快。鉴于此，这是 js 中最快的数组复制吗？

```
 function arrayCopy(src,sstart,dst,dstart,length) {
            length += sstart;
            dstart += length;
            while(--length >= sstart) {
                    dst[--dstart] = src[length];    
            }       
    } 
```

其他测试功能

```
 function slowCopy(src,sstart,dst,dstart,length) {
               for(var i = sstart; i < sstart+length;i+=1 ) {
                      dst[dstart++] = src[i];
               }
       }

       function aCopy(src,sstart,dst,dstart,length) {
              Array.prototype.splice.apply(dst,[dstart, length].concat(src.slice(sstart,sstart+length)));
       } 
```

**测试结果** [http://jsperf.com/fastest-js-arraycopy](http://jsperf.com/fastest-js-arraycopy)

数组复制 -

```
2,899
±5.27%
fastest 
```

慢复制 - 获胜**者**

```
2,977
±4.86%
fastest 
```

复印件 -

```
2,810
±4.61%
fastest 
```

我想在 jsPerf 测试中添加更多以下建议的函数，但它们都没有包含源起始偏移量、目标起始偏移量或复制长度。无论如何，我对这些似乎与我预期相反的结果感到有些惊讶

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:07:09.630

谁说你需要一个循环？

```
var myArrayCopy = JSON.parse(JSON.stringify(myArray)); 
```

此方法对数组进行深度克隆。这是一个函数：

```
function arrayCopy(src,sstart,dst,dstart,length) {
        dst = JSON.parse(JSON.stringify(src));   
} 
```

请记住，其他变量（除了`src`和`dst`）只是为了维护您的原始代码结构，以防您对该函数进行预先存在的调用。它们不会被使用并且可以被移除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T10:17:55.010

令人惊讶的是，慢速复制是赢家。以微弱优势：

```
 function slowCopy(src,sstart,dst,dstart,length) {
           for(var i = sstart; i < sstart+length;i+=1 ) {
                  dst[dstart++] = src[i];
           }
   } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-19T14:24:00.603

我认为这是最快的方法：

```
var original = [1, 2, 3];
var copy = original.slice(0); 
```

# c# - asp.net 替换特殊字符 '\'

> ID：15501575
> 
> 赞同：0
> 
> 时间：2013-03-19T14:00:25.170
> 
> 标签：c#, asp.net, string, replace

我有一个字符串，它提供了来自 png 图像前的源路径：

```
C:\pictures\picture1.png 
```

但我会用这一行将 '\' 字符替换为 '\ \' （两个 \ 字符）：

我的数据是`C:\pictures\picture1.png`

```
 public string rep(string data) 
        {
            data.Replace('\','\\');
            return data;
        } 
```

当我 rite data.Replace('\','\') '\' 之后的下一个字符出现在描述行时，我该怎么办我必须使用文件源，所以：

```
C:\\pictures\\picture1.png 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:03:35.953

你需要这个：

```
data = data.Replace("\\", "\\\\"); 
```

反斜杠在字符串中必须加倍。

（或使用“原始字符串”：

```
data = data.Replace(@"\", @"\\"); 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T14:04:39.177

您的：

```
data.Replace("\","\\\\"); 
```

Line 没有做任何事情，因为 Replace 返回一个带有结果的**新**字符串。也许你打算做的是`data=data.Replace()...`？

# awk - 基于标志的总和列

> ID：15501578
> 
> 赞同：1
> 
> 时间：2013-03-19T14:00:43.167
> 
> 标签：awk

我有一个格式类似于的文件（实际上有更多的列和行）

```
ID flag
1   a
2   n
3   n
4   a
5   n
6   n
7   a
8   a
9   n
10  n
11  n
12  n 
```

我想知道有多少行`n`有`$2`.

我试过了`awk '{if ($2 == 'n') SUM += 1} END {print SUM}' filename`

这不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:02:26.367

单程：

```
awk '$2=="n"{x++}END{print x}' file 
```

# ruby-on-rails - 在崇高的文本中突出显示 rspec 2

> ID：15501579
> 
> 赞同：7
> 
> 时间：2013-03-19T14:00:44.230
> 
> 标签：ruby-on-rails, ruby, rspec, sublimetext2

我的测试文件中 DO END 的数量越来越令人困惑。

有没有办法在崇高文本 2 中突出显示 DO 或 END 的匹配对？

Bracket Highlighter 没有此功能（尽管开发人员正在研究它）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T11:35:05.923

编辑

`~/Library/Application Support/Sublime Text 2/Packages/BracketHighlighter/bh_core.sublime-settings`

将“RSpec”添加到语言列表。

```
// Ruby conditional statements
    {
        "name": "ruby",
        "open": "(^\\s*\\b(?:if|case|until|unless|while|begin|class|module|def\\b\\s*[a-zA-Z_\\d]+)|do)\\b",
        "close": "\\b(end)\\b",
        "style": "default",
        "scope_exclude": ["string", "comment"],
        "plugin_library": "bh_modules.rubykeywords",
        "language_filter": "whitelist",
        "language_list": ["RSpec", "Ruby", "Ruby on Rails", "HTML (Rails)"],
        "enabled": true
    }, 
```

结果

![结果](../Images/beab07cd63d7bbe3ee3e044fb3cb8f3c.png)

编辑

通过包控制安装 Bracket Highliter "BH2" 分支：

打开

`~/Library/Application Support/Sublime Text 2/Packages/User/Package Control.sublime-settings`

并添加

```
"repositories":
[
    "https://github.com/facelessuser/BracketHighlighter/tree/BH2"
] 
```

然后从 package control 下拉菜单中`Package Control: Upgrade Package`选择 Bracket Highlighter。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-24T12:06:48.567

我只需要安装 BracketHighlighter 包（使用包控制中的默认存储库）并**重新启动 Sublime**（重要！）。AGS 的答案已经过时了。

# .htaccess - Joomla .htaccess

> ID：15501581
> 
> 赞同：0
> 
> 时间：2013-03-19T14:00:47.673
> 
> 标签：.htaccess, joomla, url-rewriting

我需要一个有效的 RewriteRule 来摆脱`/index.php/category/`我的 url(s) 部分。

```
bruteforce.tv/index.php/streams/shinigamily
bruteforce.tv/index.php/streams/cash
bruteforce.tv/index.php/streams/blacktigrex
bruteforce.tv/index.php/streams/viktorwwe 
```

至

```
bruteforce.tv/shinigamily
bruteforce.tv/cash
bruteforce.tv/blacktigrex
bruteforce.tv/viktorwwe 
```

我不习惯使用 htaccess 文件，所以我为完全没有资源而道歉。

这是我当前的 htaccess 文件，但无法正常工作`RewriteRule ^streams/(.*)/?$ /$1 [L,NC,R]`

```
Options +FollowSymLinks

## Mod_rewrite in use.

RewriteEngine On

RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})

RewriteBase /

RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteRule ^streams/(.*)/?$ /$1 [L,NC,R]
RewriteCond %{REQUEST_URI} !^/index\.php
RewriteCond %{REQUEST_URI} /component/|(/[^.]*|\.(php|html?|feed|pdf|vcf|raw))$ [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:10:02.363

1.  使用 Joomla 的内置功能删除 /index.php（在全局配置 > 站点下）

2.  `RewriteRule ^streams/(.*)$ http://bruteforce.tv/$1 [R=301,L]`

# javascript - 如何使 DIV 振动或嗡嗡声？（类似于 iOS 移动/删除应用功能）

> ID：15501585
> 
> 赞同：11
> 
> 时间：2013-03-19T14:00:58.473
> 
> 标签：javascript, jquery, dom, html

我正在开发一个用户可以自定义的网站，我想让“振动/嗡嗡声”成为 DOM 的一个元素（在我的具体情况下它是一个`DIV`）。当您长按任何应用程序图标（所有图标都会摇晃）时，我想获得类似于 iOS 上发生的效果。

在网上搜索我刚刚找到了这个 jQuery 库： http: [//www.dev4web.eu/projects/jquery.vibrate/](http://www.dev4web.eu/projects/jquery.vibrate/)

但是我不确定使用它是否能够获得良好的效果。

关于如何实现这一点的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T14:27:11.567

您还可以像这样实现自己的动画：

```
function shake(){
    $('#div').animate({
        'margin-left': '-=5px',
        'margin-right': '+=5px'
    }, 200, function() {
        $('#div').animate({
            'margin-left': '+=5px',
            'margin-right': '-=5px'
        }, 200, function() {
            //and so on...
        });
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-22T19:22:09.010

使用 jquery 的插件：

```
$('#loginL').effect('shake'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-18T08:59:13.210

我最近构建了一些旨在模仿 iOS 摆动效果的东西，以便在 jQuery 可排序之上使用。你可以在tastemakerx.com 上看到它，我用它来增强收藏分类功能。

这是我开始的小提琴：http: [//jsfiddle.net/jozecuervo/fv8vR/](http://jsfiddle.net/jozecuervo/fv8vR/)

这是CSS：

```
@-webkit-keyframes shake {
    0%, 100% {-webkit-transform: translateX(0) rotate(0deg) translateY(0);}
    15%, 35%, 55%, 75%, 95% {-webkit-transform: translateX(-1px) rotate(-2deg) ;}
    25%, 45%, 65%, 85% {-webkit-transform: translateX(1px) rotate(2deg); }
    10%, 30%, 50%, 70%, 90% {-webkit-transform: translateY(1px);}    
    20%, 40%, 60%, 80% {-webkit-transform: translateY(-1px); }
}
@-moz-keyframes shake {
    0%, 100% {-moz-transform: translateX(0) rotate(0deg) translateY(0);}
    15%, 35%, 55%, 75%, 95% {-moz-transform: translateX(-1px) rotate(-2deg) ;}
    25%, 45%, 65%, 85% {-moz-transform: translateX(1px) rotate(2deg); }
    10%, 30%, 50%, 70%, 90% {-moz-transform: translateY(1px);}    
    20%, 40%, 60%, 80% {-moz-transform: translateY(-1px); }  
}

@-o-keyframes shake {
     0%, 100% {-o-transform: translateX(0) rotate(0deg) translateY(0);}
    15%, 35%, 55%, 75%, 95% {-o-transform: translateX(-1px) rotate(-2deg) ;}
    25%, 45%, 65%, 85% {-o-transform: translateX(1px) rotate(2deg); }
    10%, 30%, 50%, 70%, 90% {-o-transform: translateY(1px);}    
    20%, 40%, 60%, 80% {-o-transform: translateY(-1px); }  
}

@keyframes shake {
    0%, 100% {transform: translateX(0) rotate(0deg) translateY(0);}
    15%, 35%, 55%, 75%, 95% {transform: translateX(-1px) rotate(-2deg) ;}
    25%, 45%, 65%, 85% {transform: translateX(1px) rotate(2deg); }
    10%, 30%, 50%, 70%, 90% {transform: translateY(1px);}    
    20%, 40%, 60%, 80% {transform: translateY(-1px); }  
}
.shake {
    -webkit-animation-name: shake;
    -moz-animation-name: shake;
    -o-animation-name: shake;
    animation-name: shake;
    -webkit-animation-duration: 2s;
    -moz-animation-duration: 2s;
    -o-animation-duration: 2s;
    animation-duration: 2s;
    -webkit-animation-fill-mode: both;
    -moz-animation-fill-mode: both;
    -o-animation-fill-mode: both;
    animation-fill-mode: both;
    -webkit-animation-iteration-count: infinite;
    -moz-animation-iteration-count: infinite;    
    -o-animation-iteration-count: infinite;
    animation-iteration-count: infinite;
    -webkit-transition-timing-function:linear;    
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-22T15:27:02.590

这是一些 Javascript，可以满足您的需求。

```
var times = 10;
var duration = 200;
for (var i = 0; i < times; i++)
    $('div#shake-it').animate({
        left: (i % 2 === 0 ? "-" : "+") + "=50"
    }, duration); 
```

与许多其他解决方案一样，它需要 jQuery 库。但是它不需要任何其他插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-19T14:24:07.930

您可以使用`jQuery`Rumble 之类的插件：http: [//jackrugile.com/jrumble/](http://jackrugile.com/jrumble/)

您可以使用`animate`. 举个例子（演示如何摇动 div）：

```
<div id="div">
</div>

<input type="button" id="buzz" />

$("#buzz").click(function() {
   $("#div").animate({
    left: "20px",
   }, 50);

   $("#div").animate({
    left: "-20px",
   }, 50);

   $("#div").animate({
    left: "20px",
   },50);
}); 
```

[http://jsfiddle.net/VRzc9/1/](http://jsfiddle.net/VRzc9/1/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-19T14:04:30.830

“jQuery ClassyWiggle 允许您模拟 iPhone 上的图标在您按住它们时的摆动效果。”

查看[Marius Stanciu的](https://vox.space/?section=5)[Classy Wiggle](https://vox.space/files/jquery/classywiggle/) JQuery 插件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-11T01:11:51.083

```
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
$('#shakediv').effect('shake'); 
```

jquery ui内置抖音效果，导入使用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-19T14:05:29.290

按照下面的例子

```
<div class="buzz">
    <!-- Your Div Content Here -->
</div>

<script>

$(docuement).ready(function(){
   buzzMe();
   //or
   buzzMeFor(0)
})
function buzzMe()
{
   $('buzz').css('margin-left','-2');
   delay(500);
   $('buzz').css('margin-left','2');
   delay(500);
   buzzMe()
}

//Or use this function for Specific times
//Call & Pass Arguments 0
function buzzMeFor(count)
{
  count++;
  $('buzz').css('margin-left','-2');
  delay(500);
  $('buzz').css('margin-left','2');
  delay(500);
  if(count!=20)    
    buzzMe(count)    
}
</script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-10-03T10:22:28.680

仅使用 jQuery 的 animate 函数，以下方法可以解决问题：

```
function recursiveShake(jQelement, pixel, counter) {
  if (counter > 0) {
    jQelement.animate({
      'margin-left': '+='.concat(pixel, 'px')}, 
      30, 
      recursiveShake(jQelement, -pixel, counter - 1)
    );
  }
}
// (counter must be even to avoid any shift)
```

# android - 外包RSA加密和解密的问题

> ID：15501592
> 
> 赞同：4
> 
> 时间：2013-03-19T14:01:08.213
> 
> 标签：android, encryption, rsa

我对 RSA 加密和解密有疑问。我正在用 android 开发，想外包 RSA 加密和解密。在我尝试外包之前，我的源代码运行良好。

我创建了一个私钥和公钥并将其保存为 private.key 和 public.key。错误是由此方法引起的 ClassNotFoundException：

```
public Key getPrivateKey(){
  try {
    InputStream fis = activity.getResources().openRawResource(R.raw.private);
    ObjectInputStream ois = new ObjectInputStream(fis);
    Key RSAprivateKey = (Key)ois.readObject();
    return RSAprivateKey;
  }
  catch (FileNotFoundException e) {
    Log.e("FileNotFound","FileNotFound");
    e.printStackTrace();
  } catch (IOException e) {
    Log.e("IOEXception","IOEXception");
    e.printStackTrace();
  } catch (ClassNotFoundException e) {
    Log.e("ClassNotFound","ClassNotFound");
    Log.e("Errro", "Error: "+ e.getMessage());
    Log.e("error", e.toString());
    e.printStackTrace();
  }
  return null;
} 
```

我查看了 logcat 并收到了以下错误消息：

```
E/ClassNotFound(1205): ClassNotFound
03-19 13:54:52.176: E/Errro(1205): Error: 
com.android.org.bouncycastle.jce.provider.JCERSAPrivateCrtKey
03-19 13:54:52.176: E/error(1205): java.lang.ClassNotFoundException: 
com.android.org.bouncycastle.jce.provider.JCERSAPrivateCrtKey 
```

我希望你能理解我的问题，因为英语不是我的母语。

编辑：我发现问题不是由外包代码引起的。所以我想这个话题可以标记为已解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-01T08:59:27.770

`RSAPublicKey`并且`RSAPrivateKey`是接口。当您获得 a 时，`Key`您实际上会收到此接口的加密提供者的实现。这些提供程序因不同的 Java 平台而异（尽管至少在官方上，Android/Dalvik 甚至不是 Java 平台）。因此，除非您在同一个平台上工作，否则您永远不应该期望序列化能够工作。

然而，有一些方法可以在 Java 中序列化公钥和私钥；该`Key`接口包含`getEncoded()`返回密钥最常见二进制编码的方法。在这种情况下，`RSAPublicKey`是 X5.09 SubjectKeyIdentifier 中的 PKCS#1 编码。在这种情况下，`RSAPrivateKey`内部*PKCS* #8 编码包裹在 PKCS#1 定义的结构周围。这些可以使用`X509EncodedKeySpec`和表示，`PKCS8EncodedKeySpec`并使用 RSA 转换回密钥`KeyFactory`。

请注意，如果*您*调用`getEncoded`. *通常你根本*不想传输私钥，如果你这样做了，你应该真正加密它们。您可以使用`Cipher.wrap`and`Cipher.unwrap`方法执行此操作。

# java - ImageView，为什么大小不同？

> ID：15501596
> 
> 赞同：6
> 
> 时间：2013-03-19T14:01:15.227
> 
> 标签：java, android

首先，我知道很多人都问过同样的问题，但这个问题几乎相同，但我还有几个问题。

我有一个 48px x 48px 的图像，所以如果我在 ImageView 中设置这个图像

```
layout_width="wrap_content"
layout_height="wrap_content" 
```

然后图像看起来更大，但如果我使用以下固定尺寸，它会变小

```
layout_width="48dp"
layout_height="48dp" 
```

我认为它现在以 48dp 正确显示（不是像素化？），但是如果我使用 wrap_content 为什么它会变大？如果通过 wrap_content 的图像大小是正确的，那么使用 dp 有什么意义（如果它使图像更小）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T14:08:15.873

`48dp`（或`48dip`）代表“密度无关像素”。这意味着无论屏幕密度和尺寸如何，Android 屏幕上显示的图像的物理尺寸都应该相同。为了支持这一点，Android 会根据屏幕密度调整显示的实际像素大小。您对不同尺寸的发现会因设备而异。

dp 单位到屏幕像素的转换是：`pixels = dps * (density / 160)`. 例如，在 240 dpi 屏幕上，`1dp`将等于 1.5 个物理像素。强烈建议使用 dp 单位来定义应用程序的 UI，以确保在不同屏幕上正确显示 UI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T14:04:28.530

这可能是因为您没有明确设置[scaleType](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)。在 XML 中设置 scaleType 如下，你应该没问题：

```
android:scaleType="center" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T14:05:38.290

试试这个

```
<ImageView
    android:id="@+id/seprator2"
    layout_width="48dp"
    layout_height="48dp"
    android:scaleType="fitXY"
    android:src="@drawable/your_image" /> 
```

如果它仍然显示很小，那么你的图像必须包含它周围的 alpha。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:09:45.873

如果图像大于视图，则可以使用以下方法对其进行缩放：

```
android:scaleType="center" 
```

# ipad - setDetailItem:(id)newDetailItem 未触发

> ID：15501598
> 
> 赞同：0
> 
> 时间：2013-03-19T14:01:20.033
> 
> 标签：ipad, ios6, uisplitviewcontroller

我正在更新我的 iPad 应用程序，我在拆分视图控制器的表中有一个选项列表，但它没有触发 setDetalItem 没有触发。由于外形尺寸（屏幕太小），这不会移植到 iPhone 上。

从 appDelegate 类：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UISplitViewController *splitViewController = (UISplitViewController *)self.window.rootViewController;
    UINavigationController *navigationController = [splitViewController.viewControllers lastObject];
    splitViewController.delegate = (id)navigationController.topViewController;

    UINavigationController *masterNavigationController = splitViewController.viewControllers[0];
    JSLMasterViewController *controller = (JSLMasterViewController *)masterNavigationController.topViewController;
    controller.managedObjectContext = self.managedObjectContext;
    return YES;   
} 
```

从主视图控制器：

```
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    JSLDetailViewController *detailView = self.detailViewController;
    detailView.telegram = indexPath.row;

    NSLog(@"Did Fire 1");

} 
```

从我的 detailViewController 中：

```
- (void)setDetailItem:(id)newDetailItem
{
    NSLog(@"Did Fire 2");

    if (_detailItem != newDetailItem) {
        _detailItem = newDetailItem;

    // Update the view.
        [self configureView];
    }

    if (self.masterPopoverController != nil) {
        [self.masterPopoverController dismissPopoverAnimated:YES];

    }

}

- (void)configureView
{
    // Update the user interface for the detail item.

    if (self.detailItem) {
        //self.detailDescriptionLabel.text = [[self.detailItem valueForKey:@"timeStamp"] description];

        NSArray *mainQuestion = [self mainQuestionArray];
        NSArray *subQuestion = [self subQuestionArray];
        questionTitle.text = mainQuestion[telegram];
        subQuestionOne.text = subQuestion[telegram][0];
        subQuestionTwo.text = subQuestion[telegram][1];
    }

} 
```

我知道我可能需要在 appDelegate 中创建 detailViewController 的实例，但我不确定如何执行此操作。我发现的大多数教程都是从头开始构建拆分视图，或者似乎使用的是旧版本的机制。您能给我的任何提示将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:09:10.973

事实证明，在 iOS6 中，需要直接调用“setDetailItem”。你可以在这里传递对象，尽管它不一定是你想的那样。我将以下代码添加到 didSelectItemAtIndexPath：

```
[detailView setDetailItem:indexPath]; 
```

这触发了对 MasterViewController 的更新，生活很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T16:32:10.353

您需要设置 detailView.detailItem 才能`- (void)setDetailItem:(id)newDetailItem`触发。

在 MasterViewController.m detailViewController 通常是这样的：

```
self.detailViewController = (DetailViewController *)[[self.splitViewController.viewControllers lastObject] topViewController]; 
```

然后在 didSelectRowAtIndexPath 中：

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
        NSYourCoolObject *object = _YourObjectArray[indexPath.row];
        self.detailViewController.detailItem = object;
} 
```

# java - 比较所有出现的单词的两个文档

> ID：15501599
> 
> 赞同：0
> 
> 时间：2013-03-19T14:01:24.693
> 
> 标签：java

我目前正在做一个项目，我需要比较两个文本文档，对于文档 1 中所有出现的单词，无论单词的位置如何，都将在文档 2 中重复。例如，如果文档 1 包含出现 10 次“in”一词的段落，则文档 2 也必须包含 10 次“in”。如果单词放置在不同的位置没有问题。我该怎么做？？......提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:03:00.730

建立一个`Map<String,Integer>`计算每个单词出现次数的地方。如果两个文档的映射相等，则您有“匹配文档”。

```
 Map<String,Integer> docToMap(String[] document) {
   Map<String,Integer> map = new HashMap<>();
   for (String s:document) {
      Integer n=map.get(s);
      n= n==null?1:(n+1);
      map.put(s,n)
   }
 } 
```

# sql - 在一行中连接重复项

> ID：15501601
> 
> 赞同：1
> 
> 时间：2013-03-19T14:01:27.693
> 
> 标签：sql, ms-access, ms-access-2007

我有一个包含以下字段（列）的表

```
First Name   |  Last Name | Email | ContactID | AccountID 
```

我有相同的名称、电子邮件和 AccountID 但不同的 ContactID 的重复行。有没有一种方法可以构建一个查询，该查询可以返回与一个帐户匹配的相互附加的 ContactID 列表？

可以说我有

```
First Name   |  Last Name | Email | ContactID | AccountID
----------------------------------------------------------
fname        |  lanem     | e@m.ca| 123       | 1
fname        |  lanem     | e@m.ca| 124       | 1 
```

返回

```
ContactID | AccountID
----------------------
123 , 124 | 1 
```

我正在使用访问权限（不是选择）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:20:20.400

您可以将以下代码粘贴到“常规”VBA 模块（不是与表单关联的类模块）中，根据需要编辑表名，然后将该函数用作查询中的列，如下所示：`listContactIDs([AccountID])`

```
Public Function listContactIDs(AccountID As Long) As String
Dim cdb As DAO.Database, rst As DAO.Recordset, s As String
Dim Separator As String

Separator = ", "

Set cdb = CurrentDb
Set rst = cdb.OpenRecordset( _
        "SELECT ContactID FROM [TableName] WHERE AccountID=" & _
            AccountID & " ORDER BY ContactID", _
        dbOpenSnapshot)
s = ""
Do While Not rst.EOF
    s = s & rst!ContactID & Separator
    rst.MoveNext
Loop
rst.Close
Set rst = Nothing
Set cdb = Nothing
If Len(s) > 0 Then
    ' remove trailing separator
    s = Left(s, Len(s) - Len(Separator))
End If
listContactIDs = s
End Function 
```

# php - Proc_open 和 Capifony 问题

> ID：15501606
> 
> 赞同：0
> 
> 时间：2013-03-19T14:01:47.563
> 
> 标签：php, symfony, capistrano, capifony, proc-open

我正在尝试在 Symfony2.1 中将 Capifony 与我的 Web 应用程序一起使用以加速部署过程。

这是我的 deploy.rb 文件：

```
default_run_options[:pty] = true
set :application, "mywebsite"
set :domain,      "mywebsite.com"
set :deploy_to,   "~/git/mywebsite.git"
set :app_path,    "app"

set :repository,  "git@github.com:myname/mywebsite.git"
set :scm,         :git
# Or: `accurev`, `bzr`, `cvs`, `darcs`, `subversion`, `mercurial`, `perforce`, or `none`
set :user, "myserveruser"  # The server's user for deploys

set :model_manager, "doctrine"
# Or: `propel`

role :web,        domain                         # Your HTTP server, Apache/etc
role :app,        domain                         # This may be the same as your `Web` server
role :db,         domain, :primary => true       # This is where Symfony2 migrations will run

set :use_composer, true
set :update_vendors, true

set :use_sudo,      false
set :keep_releases,  3
set :shared_files,      ["app/config/parameters.yml"]
set :shared_children,   [app_path + "/logs", web_path + "/uploads"]

set :deploy_via, :rsync_with_remote_cache
set :ssh_options, { :forward_agent => true }
ssh_options[:keys] = %w(/.ssh/id_rsa)
ssh_options[:port] = xxxx

# Be more verbose by uncommenting the following line
logger.level = Logger::MAX_LEVEL 
```

这是我的错误：

```
 The Process class relies on proc_open, which is not available on your PHP installation. 
```

当脚本运行时`php composer.phar update`

更多细节在这里： http: [//pastebin.com/hNJaMvwf](http://pastebin.com/hNJaMvwf)

但是我在一个共享主机中，我的主机告诉我我不能启用 proc_open，有没有办法让它工作？

非常感谢你的帮助 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:02:33.433

Composer 需要能够运行命令行进程（它使用 symfony/process 组件来做到这一点）。如果您的主机不支持 proc_open，则无法运行 Composer。

作为替代部署策略，您可以`vendor/`手动将目录上传到生产机器（您可以使用 Capistrano 配方中的[上传功能](http://www.simonecarletti.com/blog/2009/09/capistrano-file-transfer-actions/#upload)）。话虽如此，虚拟服务器现在价格实惠，我不建议将 Symfony2 应用程序部署到共享主机。也许您应该寻找不同的托管解决方案？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-19T11:15:03.237

在使用 Composer 为我的 Mediawiki 安装安装 Sematic 扩展时，我的网络主机也遇到了类似（但不同）的问题。我没有使用 Cafinony，而是使用 Putty 和 SSH 在“远程”命令行上运行 Composer。Composer 失败并出现同样的错误；

Process 类依赖于 proc_open，它在您的 PHP 安装中不可用。

但是，我能够以另一种方式修复它。

proc_open 是一个 PHP 函数，通常被大多数 Web 主机“禁用”。通过将该函数包含在使用 PHP 配置设置 disable_functions 设置的禁用函数列表中来禁用它。换句话说，如果它包含在列出它被禁用；如果它从列表中删除，它被启用。

因此，您可以通过使用 php 命令行 -d 选项删除禁用的功能（包括 proc_open）来有效地“即时”启用 proc_open。换句话说，通过删除 disable_functions 列表，您可以有效地“启用所有”功能，包括 proc _pen。

要使用 -d 启用 proc_open，您必须将 disable_functions 设置设置为空字符串。这将删除所有禁用函数列表（包括 proc_open）

When installing at the command line using an SSH client such as Putty, use a command similar to this:

php -f composer.phar -d detect_unicode=Off -d disable_functions= require mediawiki/semantic-media-wiki "1.9.*,>=1.9.0.1"

So, if you can figure out a way to pass "-d settings" with your ruby file, you may be able to solve your problem.

I know this does not fully address your problem, but it may help others with overcoming annoying default php settings on shared servers, that get in the way of Composer!

I hope this helps someone.

# mysql - 每个事件的每个候选人的 SUM 分数列

> ID：15501614
> 
> 赞同：0
> 
> 时间：2013-03-19T14:02:05.787
> 
> 标签：mysql, sum

到目前为止我的查询是

```
SELECT callSign,event,rubric,score 
  FROM scores LEFT JOIN candidates 
    ON scores.candidateID=candidates.id 
  WHERE candidateID IN 
    (SELECT id 
      FROM candidates 
    WHERE assessmentID='1321') 
  ORDER BY candidateID,event 
```

它返回一个数据集，如：

```
callSign    event                 score
V021    Amazing Race Planning       5
V021    Amazing Race Planning       3
V021    Amazing Race Planning       5
V021    Individual Analyst Exam     3
V021    PSA                         5
V021    Team Analyst Exam           5
V021    Team Analyst Exam           5
V021    Team Analyst Exam           3
V021    Team Analyst Exam           5
V022    PSA                         1
V022    Team Tech Exam              5
V022    Team Tech Exam              3 
```

我正在寻找的是每个候选人将每个事件的分数相加，所以它看起来像：

```
callSign        event              score
V021    Amazing Race Planning       13
V021    Individual Analyst Exam     3
V021    PSA                         5
V021    Team Analyst Exam           18
V022    PSA                         1
V022    Team Tech Exam              8 
```

我确定我需要某种和的组合，`SUM()`但`GROUP BY`我似乎无法弄清楚。然后我需要`ORDER BY`所有类别中得分最高的候选人

**注意：**有多个候选人

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:10:40.050

其他答案也是正确的，但我会删除 IN .. subselect 语句。这是不必要的。

按您要分组的字段分组，并对您要总计的字段求和。

```
SELECT callSign, event, SUM(score) score

FROM scores 

     JOIN candidates 
     ON scores.candidateID = candidates.id 

WHERE candidates.assessmentID = '1321'

GROUP BY callSign, event

ORDER BY candidateID, event 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:04:56.663

```
SELECT callSign,event, SUM(score) 
  FROM scores LEFT JOIN candidates 
    ON scores.candidateID=candidates.id 
  WHERE candidateID IN 
    (SELECT id 
      FROM candidates 
    WHERE assessmentID='1321') 
  GROUP BY event, callSign
  ORDER BY candidateID,event 
```

通常，主要分组（在您的情况下`event`）是第一列。但是由于您想要的结果集具有相同的多行`callSign`，因此它必须是次要分组列而不是主要分组列。

如果您希望主要分组用于候选人，请在查询中包含候选人字段，并将其包含在这样的分组中`GROUP BY candidateID, event, callSign`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:03:36.960

```
SELECT callSign,event,rubric,SUM(score) 
  FROM scores LEFT JOIN candidates 
    ON scores.candidateID=candidates.id 
  WHERE candidateID IN 
    (SELECT id 
      FROM candidates 
    WHERE assessmentID='1321') 
GROUP BY callSign,event,rubric
ORDER BY candidateID,event 
```

你基本上只需要添加你没有总结到分组依据的所有其他列。

编辑。对不起，把小组放在错误的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:08:14.500

只是猜测...

```
 SELECT callSign
      , event
      , SUM(score) total
   FROM scores s
   LEFT 
   JOIN candidates c
     ON c.id = s.candidateID
    AND c.assessmentID=1321
  GROUP
     BY callsign
      , event; 
```

# mysql - Hibernate：不在 Hypersonic 上时对 MySQL 的附加查询

> ID：15501618
> 
> 赞同：0
> 
> 时间：2013-03-19T14:02:10.923
> 
> 标签：mysql, hibernate, hsqldb

有没有人知道为什么 Hibernate 会在我使用 MySQL 时进行额外的查询，而在我使用 Hypersonic 时没有进行查询？

我有这样的结构：

```
A has set of B and link to C
B has link to C 
```

在映射中的任何地方我都在使用 fetch="join"。当我在 Hypersonic 上询问 A 时，这是一个大查询，但是当我使用 MySQL 时，它是来自解析 B 的 C 的附加查询。

Hibernate 调试日志的不同之处在于，对于 MySQL，我没有来自第一个查询的“结果行：EntityKey [C#101]”。对于 Hypersonic，有：“结果行：EntityKey[A#101]，EntityKey[B#101]，EntityKey[C#101]。对于 MySQL，C 没有 EntityKey。

# php - CakePHP 自动创建 $belongsTo 相关模型

> ID：15501621
> 
> 赞同：0
> 
> 时间：2013-03-19T14:02:13.280
> 
> 标签：php, cakephp

我有两个相关的模型，*Foo*和*Bar*，其中*Bar* `$belongsTo` *Foo*。现在每个*Foo*都必须有一个*Bar*，即两者必须同时创建。使用 CakePHP 的建模系统，有没有办法在创建*Foo*时自动创建*Bar*（可能通过 a ），或者我应该将该功能写入Foo吗？*`saveAll()``Foo::afterSave()`*

 *谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:16:35.907

是的 - 只需为 Foo 和 Bar 构建您的数据，然后`saveAll()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:24:38.943

添加到[Dave](https://stackoverflow.com/users/673664/dave)的答案。

如果您的数据库表支持事务，通常`InnoDB storage engine`在 MySql 中。您还可以告诉 Cake 尝试一次性保存两条记录。如果一个失败，另一个将被还原。您需要`array('atomic' => true)`作为第二个参数传递给`saveAll()`

```
$this->ModelName->saveAll($this->request->data, array("atomic" => true)); 
```

来自[食谱](http://book.cakephp.org/2.0/en/models/saving-your-data.html)

```
atomic: If true (default), will attempt to save all records in a single transaction. 
Should be set to false if database/table does not support transactions. 
```*

# r - 让 knitr 运行 ar 脚本：我使用 read_chunk 还是 source？

> ID：15501622
> 
> 赞同：23
> 
> 时间：2013-03-19T14:02:16.317
> 
> 标签：r, knitr, rstudio

我正在运行 R 版本 2.15.3 和 RStudio 版本 0.97.312。我有一个脚本可以从各种来源读取我的数据并创建多个 data.tables。然后我有另一个 r 脚本，它使用在第一个脚本中创建的 data.tables。我想把第二个脚本变成一个 R markdown 脚本，这样分析的结果就可以作为报告输出。

不知道目的`read_chunk`，反对`source`。我`read_chunk`的不工作，但`source`正在工作。无论哪种情况，我都看不到 RStudio 工作区面板中的对象。

`read_chunk`请解释和之间的区别`source`？我为什么要使用其中一个？为什么我的 .Rmd 脚本不起作用

## 这是可笑的简化示例

这没用。我收到以下消息

> 错误：找不到对象“z”

两个简单的文件...

rmd.R 的源测试

```
x <- 1:10
y <- 3:4
z <- x*y 
```

测试源码.Rmd

```
Can I run another script from Rmd
========================================================

Testing if I can run "test of source to rmd.R"

```{r first part}
require(knitr)
read_chunk("test of source to rmd.R")
a <- z-1000
a
```

The above worked only if I replaced "read_chunk" with "source". I 
can use the vectors outside of the code chunk as in inline usage. 
So here I will tell you that the first number is `r a[1]`. The most 
interesting thing is that I cannot see the variables in RStudio 
workspace but it must be there somewhere. 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-19T17:50:03.510

`read_chunk()`只读取源代码（供以后参考）；它不会*像*`source()`. [本页](http://yihui.name/knitr/demo/externalization/)和[手册](http://yihui.name/knitr/demo/manual/)`read_chunk()`中解释了的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-26T14:03:16.373

没有选项可以从`knitr`AFAIK 中以交互方式运行块。但是，这可以通过以下方式轻松完成：

```
#' Run a previously loaded chunk interactively
#'
#' Takes labeled code loaded with load_chunk and runs it in the /global/ envir (unless otherwise specified)
#'
#' @param chunkName The name of the chunk as a character string
#' @param envir The environment in which the chunk is to be evaluated 
run_chunk <- function(chunkName,envir=.GlobalEnv) {
    chunkName <- unlist(lapply(as.list(substitute(.(chunkName)))[-1], as.character))    
    eval(parse(text=knitr:::knit_code$get(chunkName)),envir=envir) 
} 
NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-05T06:42:45.823

万一它对其他人有帮助，我发现使用`read_chunk()`在不评估的情况下阅读脚本可以在两个方面有用。首先，您可能有一个包含许多块的脚本，并希望控制哪些块在何处运行（例如，特定位置的绘图或表格）。我`source`想在脚本中运行所有内容时使用（例如，在文档开头加载一组标准包或自定义函数）。我已经开始`read_chunk`在文档的早期使用来加载脚本，然后在需要它们的地方有选择地运行我想要的块。

其次，如果您直接或交互地使用 R 脚本，您可能需要很长的代码前导码来加载包、数据等。但是，如果之前的代码块在主文档已加载数据。

# vbscript - 在 .hta 文件中使用 vbscript 编辑注册表

> ID：15501630
> 
> 赞同：0
> 
> 时间：2013-03-19T14:02:35.373
> 
> 标签：vbscript, hta

我正在寻找使用 .hta 文件编辑 reg 密钥，但遇到了几个问题。我一直在使用 VBScript，因为我对此最为熟悉，但问题在于无法在 .hta 文件中使用 WScript.CreateObject。我一直在使用这是其他 .wsf 文件：

```
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.RegWrite "HKCU\Software\MyProgram\MyKey", "Value", "REG_SZ" 
```

以前有没有人解决过这个问题，或者可能知道与注册表交互的另一种方式？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:17:51.927

VBScript 中有一个“普通”的 CreateObject() 函数 ( [docs](http://msdn.microsoft.com/en-us/library/dcw63t7z%28v=vs.84%29.aspx) )，因此在 WScript 对象（由 c|wscript.exe 提供）不可用的 .HTA 中使用它。

另见：[更好](https://stackoverflow.com/a/6874014/603855)，[甚至更好地](https://stackoverflow.com/a/8915571/603855)回答类似的问题

# java - 对 GSSContext.initSecContext 的调用间歇性失败：接收超时

> ID：15501633
> 
> 赞同：1
> 
> 时间：2013-03-19T14:02:43.233
> 
> 标签：java, authentication, configuration, windows-authentication, kerberos

我正在使用服务编写用于 Windows Kerberos 身份验证的客户端代码（省略了日志记录代码）：

```
System.setProperty("javax.security.auth.useSubjectCredsOnly", "false");
// System.setProperty("sun.security.krb5.debug", "true");
Package thisPkg = AuthHelper.class.getPackage();
String configPath = Util.getConfigPath(thisPkg, "jaas.conf");
System.setProperty("java.security.auth.login.config", "=" + configPath);
GSSManager manager = GSSManager.getInstance();
GSSName peerName = manager.createName(spn, GSSName.NT_HOSTBASED_SERVICE);
GSSContext context = manager.createContext(peerName, null, null,
    GSSContext.DEFAULT_LIFETIME);
context.requestMutualAuth(true); // required
context.requestCredDeleg(true); // required for publish
byte[] serverTokenBytes = new byte[0];
while (!context.isEstablished()) {
  byte[] clientTokenBytes = context.initSecContext(serverTokenBytes, 0,
      serverTokenBytes.length);
  if (clientTokenBytes != null)
    socket.send(createClientMessage(clientTokenBytes));
  if (context.isEstablished()) break;
  Message message = socket.receive();
  String serverToken = message.getFirst("SERVERTOKEN").toString();
  serverTokenBytes = Base64.decodeBase64(serverToken);
} 
```

其中`jaas.conf`仅包含：

```
sp {
  com.sun.security.auth.module.Krb5LoginModule required debug=true;
}; 
```

我还`allowtgtsessionkey`根据需要设置了注册表项，并安装了[JCE Unlimited Strength Jurisdiction Policy Files 7](http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html)。

该代码有时有效（即建立了相互身份验证）；但是，有时它在第一次调用时会卡住一段时间，`GSSContext.initSecContext`大约一分钟后抛出异常：

```
Exception in thread "main" GSSException: No valid credentials provided (Mechanism level: Receive timed out)
  ...
Caused by: java.net.SocketTimeoutException: Receive timed out
  ... 
```

当我启用 Kerberos 调试输出时（通过取消上面第二行的注释），我可以看到协议有时会卡在以下行：

```
getKDCFromDNS using UDP 
```

[Java Kerberos 故障排除网站](http://www.informatik.hs-furtwangen.de/doku/java/j2sdk-1_4_1-doc/guide/security/jgss/tutorials/Troubleshooting.html)表明这是 Kerberos 身份验证服务器的问题，但我知道服务器已启动并正在运行，因为我们有类似的用 C#（使用 .NET 库）编写的代码，永远不会卡住。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:02:43.233

似乎 Kerberos 身份验证服务器的 DNS 解析正在通过某种间接方式，这是不可靠的。如果您明确指定服务器（在代码开头的某处），它将绕过该重定向：

```
System.setProperty("java.security.krb5.realm", "<YOUR_KRB_REALM>");
System.setProperty("java.security.krb5.kdc", "<YOUR_KRB_SERVER_ADDR_OR_IP>"); 
```

**编辑**：事实证明，由于使用 UDP 的协议，与 Kerberos 服务器的通信本质上是不可靠的，因此对于相对较远的服务器来说，它很有可能失败。Windows 8 默认使用 TCP；在以前的版本上强制**TCP ：**

*   **XP/2000**：在`HKLM\System\CurrentControlSet\Control\Lsa\Kerberos`中，将**DWORD** `MaxPacketSize`设置为`1`.
*   **2003/Vista/7**：在`HKLM\System\CurrentControlSet\Control\Lsa\Kerberos\Parameters`中，将**DWORD** `MaxPacketSize`设置为`1`。

*（请注意，同样的注册表目录也需要**DWORD** `AllowTGTSessionKey`设置`1`为 Kerberos 才能正常工作。）*

# sql-server-2008 - 从字符串转换日期和/或时间时转换失败

> ID：15501651
> 
> 赞同：-3
> 
> 时间：2013-03-19T14:03:15.877
> 
> 标签：sql-server-2008

在执行我的查询时，我收到以下错误消息“从字符串转换日期和/或时间时转换失败”是我的查询。

```
select OrderLog_Initiated, OrderLog_SessionDateTime 
into #FullMemberOrderLog
from tbl_orderlog   
where CONVERT(date,OrderLog_Initiated) between '2013-03-03' and '2013-03-08' -- order     by OrderLog_Initiated     

insert into #FullMemberOrderLog 
select OrderLog_Initiated, OrderLog_SessionDateTime 
from tbl_orderlog 
where CONVERT(date,OrderLog_Initiated) between '2013-03-03' and '2013-03-08'
select #result = (cast(DATEDIFF(HOUR,CONVERT(date,'OrderLog_Initiated'),CONVERT(date,'OrderLog_SessionDateTime' )) as float) ) from  #FullMemberOrderLog 
```

请有人在这个问题上帮助我，真的我在煎炸......我的预期结果是将“OrderLog_Initiated”表与“OrderLog_SessionDateTime”表进行比较，并提供以小时为单位的时差，但我无法得到我的预期。请有人帮助我，非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:12:38.363

你是说：

```
CONVERT(date,'OrderLog_Initiated') 
```

尝试：

```
CONVERT(date,OrderLog_Initiated) 
```

（列名周围没有单引号，否则它只会被视为字符串。）

另外，您为什么要使用完全相同的查询同时执行 a`SELECT INTO`和 an ？`INSERT INTO`选一个。

最后，你为什么说：

```
SELECT #result = 
```

代替：

```
SELECT result = 
```

?

# unix - 如何在unix命令行中拆分文件？

> ID：15501652
> 
> 赞同：28
> 
> 时间：2013-03-19T14:03:18.787
> 
> 标签：unix, command-line, awk, tokenize

我正在对一个简单的布尔信息检索系统进行更快的测试，我想使用 awk、grep、egrep、sed 或类似的东西和管道将文本文件拆分为单词并将它们保存到其他文件中，每行一个单词. 示例我的文件包含：

```
Hola mundo, hablo español y no sé si escribí bien la
pregunta, ojalá me puedan entender y ayudar
Adiós. 
```

输出文件应包含：

```
Hola
mundo
hablo
español
... 
```

谢谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-03-19T14:13:10.230

使用 tr：

```
tr -s '[[:punct:][:space:]]' '\n' < file 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-02-01T11:44:10.047

最简单的工具是 fmt：

```
fmt -1 <your-file 
```

fmt 旨在换行以适应指定的宽度，如果您提供`-1`它，则在单词之后立即换行。请参阅`man fmt`文档。灵感来自[http://everythingsysadmin.com/2012/09/unorthodoxunix.html](http://everythingsysadmin.com/2012/09/unorthodoxunix.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-19T14:06:56.007

使用`sed`：

```
$ sed -e 's/[[:punct:]]*//g;s/[[:space:]]\+/\n/g' < inputfile 
```

基本上这会删除所有标点符号并用换行符替换任何空格。这也假设你`sed`理解的味道`\n`。有些没有——在这种情况下，您可以只使用文字换行符（即通过将其嵌入引号中）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-19T14:19:26.467

`grep -o`仅打印与模式匹配的匹配行的部分

```
grep -o '[[:alpha:]]*' file 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-19T14:07:38.897

使用`perl`：

`perl -ne 'print join("\n", split)' < file`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T14:12:07.260

```
cat input.txt | tr -d ",." | tr " \t" "\n" | grep -e "^$" -v 
```

`tr -d ",."`删除`,`和`.`

`tr " \t" "\n"`将空格和制表符更改为换行符

`grep -e "^$" -v`删除空行（如果有两个或更多空格）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-19T14:16:23.343

这条 awk 线也可以工作吗？

```
awk 'BEGIN{FS="[[:punct:] ]*";OFS="\n"}{$1=$1}1'  inputfile 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-19T16:56:05.633

根据您迄今为止的回答，我认为您可能正在寻找的是将单词视为由空格、逗号、句尾字符（即英语中的“.”“！”或“？”）和其他字符分隔的字符序列。您通常不会与字母数字字符组合找到的字符（例如“<”和“;”但不是`'` `-` `#` `$` `%`）。现在， ”。” 是一个句子结尾字符，但您说它`$27.00`应该被视为一个“单词”，因此`.`需要根据上下文进行不同的处理。我认为“-”和其他一些字符可能也是如此。

因此，您需要一个可以将其转换的解决方案：

```
I have $27.00\. We're 20% under-budget, right? This is #2 - mail me at "foo@bar.com". 
```

进入这个：

```
I
have
$27.00
We're
20%
under-budget
right
This
is
#2
mail
me
at 
foo@bar.com 
```

那是对的吗？

使用 GNU awk 试试这个，这样我们就可以将 RS 设置为多个字符：

```
$ cat file
I have $27.00\. We're 20% under-budget, right? This is #2 - mail me at "foo@bar.com".

$ gawk -v RS="[[:space:]?!]+" '{gsub(/^[^[:alnum:]$#]+|[^[:alnum:]%]+$/,"")} $0!=""' file
I
have
$27.00
We're
20%
under-budget
right
This
is
#2
mail
me
at
foo@bar.com 
```

尝试提出其他一些测试用例，看看这是否总是符合您的要求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-19T14:07:07.517

首先是一个非常简单的选择，

```
sed 's,\(\w*\),\1\n,g' file 
```

注意它既不处理撇号也不处理标点符号

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-19T14:13:40.500

使用[perl](/questions/tagged/perl "显示标记为“perl”的问题")：

```
perl -pe 's/(?:\p{Punct}|\s+)+/\n/g' file 
```

## 输出

```
Hola
mundo
hablo
español
y
no
sé
si
escribí
bien
la
pregunta
ojal�
me
puedan
entender
y
ayudar
Adiós 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-17T12:05:30.453

> perl -ne '打印连接（“\n”，拆分）'

对不起@jsageryd

那个衬线没有给出正确的答案，因为它将最后一个单词与下一个单词连接在一起。

这样更好，但会为 src 中的每个空行生成一个空行。管道通过 | sed '/^$/d' 来解决这个问题

> perl -ne '{ print join("\n",split(/[[:^word:]]+/)),"\n"; }'

# java - java.sql.SQLException：无法在全局事务中使用本地事务提交

> ID：15501655
> 
> 赞同：1
> 
> 时间：2013-03-19T14:03:20.650
> 
> 标签：java, transactions, sqlexception, distributed-transactions, xa

我们有两个 oracle 实例*（两台物理机器）*和一个用于我们的应用程序的模式。我们正在使用 weblogic 应用程序服务器。应用程序使用启用了 XA 事务的数据源。

我有一个 bean 管理的 EJB，我在哪里 -

1.  更新表中的一些数据然后提交
2.  提交oracle作业
3.  再次更新表中的一些数据然后提交

在这里我收到错误 - java.sql.SQLException：无法在全局事务中使用本地事务提交。

奇怪的是，这个错误并不是每次执行都会出现，而是在 7-8 次执行中出现 1 次。

现在我的问题是

1.  如果我使用启用 XA 的事务，bean 管理的事务有什么意义？
2.  为什么每次执行都没有遇到？

谢谢。

下面是代码 -

```
DataObject.updateDataAndReturnCount(" UPDATE EOD_Trn_BatchProcess SET iJobNo = ?, szParameters = ?  WHERE iProcessSeqNo = ? ", conn, new String[]{null, strParameters, (String)mapParameters.get("__PROCESS_SEQ_NO")});
conn.commit();

String strStatement = "{? = call submitProcAsJob(?, ?)}";
//String strStatement = "begin ? := submitProcAsJob(?, ?); end;";
CallableStatement pStmt = conn.prepareCall(strStatement);
pStmt.registerOutParameter(1, OracleTypes.NUMBER);
pStmt.setObject(2, strJobName);
pStmt.setObject(3, strInstanceNo);
pStmt.execute();
vString strJobNo = pStmt.getString(1);
vpStmt.close();

DataObject.updateData(" UPDATE EOD_Trn_BatchProcess SET iJobNo = ?, szParameters = ?  WHERE iProcessSeqNo = ? ", conn, new String[]{strJobNo, strParameters, (String)mapParameters.get("__PROCESS_SEQ_NO")});
conn.commit(); 
```

这里需要第一次提交，因为我想保存调用期间使用的参数，即使作业提交失败。（或前面的任何事情。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T02:05:58.740

异常的原因是你不能在全局事务下手动调用commit()/rollback，你只能将它标记为rollback。你有三个选项：

1.  抛出异常，这取决于ejb-jar.xml/weblogic-ejb-jar.xml，默认是针对任何RuntimeException事务标记为回滚；

2.  在发生 CheckedException 或需要时调用 EJBContext.setRollbackOnly() 方法；

3.  如果同一事务下的所有资源都没有发生上述情况，事务管理器迟早会提交。

事务管理器负责为您提交（）/回滚（）事务，以便它有机会与不同的资源（例如两个 oralce db）合作。您可以通过谷歌关键字查看详细信息“两阶段交易”或“全球交易”，这是我发现的： [全球交易](http://docs.oracle.com/cd/A91202_01/901_doc/java.901/a90211/jdbctran.htm#1005396)

至于你的问题

1.  如果我使用启用 XA 的事务，bean 管理的事务有什么意义？

    如果 ejb-jar.xml 中的事务属性启用事务传播，则 bean 管理的事务是“全局事务”。全局事务需要数据源启用XA，即jdbc驱动本身是XA类驱动，如oracle.jdbc.xa.client.OracleXADataSource，或者启用XA的瘦驱动oracle.jdbc.OracleDriver（模拟两个分阶段交易，但不是真正的交易）

2.  为什么每次执行都没有遇到？

    我不知道为什么，我猜驱动程序有一些机制来检查规则是否被打破。或者事务属性配置为***支持***，所以如果调用者有事务上下文，那么你的 ejb 是在全局事务下，否则不是。

希望我的回答对您有所帮助，祝您好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:31:53.003

我遇到了同样的问题，当我将本地事务设置为自动提交 false 时解决了这个问题。

```
Connection.setAutoCommit(false) 
```

我猜您正在使用两阶段事务，如果您在第一步中不提交怎么办？

# c# - 如何理解 JITed 代码以在 C# 中“使用”异常处理

> ID：15501660
> 
> 赞同：4
> 
> 时间：2013-03-19T14:03:39.697
> 
> 标签：c#, .net, exception, native, jit

我用 C# 编写了一个非常简单的类：

```
class DisposableClass : IDisposable {
    public void Dispose() { }
}

static void UsingClass() {                    // line 31
    using (var dc = new DisposableClass()) {  // line 32
        DoSomething(dc);                      // line 33
    }                                         // line 34
}                                             // line 35 
```

在使用 WinDBG 进行 JIT 之后，我已经为它转储了本机代码：

```
0:000> !u 000007fe87d30120 
Normal JIT generated code
SimpleConsole.Program.UsingClass()
Begin 000007fe87d30120, size 80

c:\projects\SimpleConsole\SimpleConsole\Program.cs @ 32:
>>> 000007fe`87d30120 55              push    rbp
000007fe`87d30121 4883ec30        sub     rsp,30h
000007fe`87d30125 488d6c2420      lea     rbp,[rsp+20h]
000007fe`87d3012a 48896500        mov     qword ptr [rbp],rsp
000007fe`87d3012e 48c7450800000000 mov     qword ptr [rbp+8],0
000007fe`87d30136 488d0d6b47eeff  lea     rcx,[000007fe`87c148a8]
000007fe`87d3013d e8fe24665f      call    clr+0x2640 (000007fe`e7392640) (JitHelp: CORINFO_HELP_NEWSFAST) // new DisposableClass()
000007fe`87d30142 48894508        mov     qword ptr [rbp+8],rax

c:\projects\SimpleConsole\SimpleConsole\Program.cs @ 33:
000007fe`87d30146 488b4d08        mov     rcx,qword ptr [rbp+8]
000007fe`87d3014a e8d1beeeff      call    000007fe`87c1c020 (SimpleConsole.Program.DoSomething(System.Object), mdToken: 0000000006000012)
000007fe`87d3014f 90              nop
000007fe`87d30150 90              nop

c:\projects\SimpleConsole\SimpleConsole\Program.cs @ 35:
000007fe`87d30151 488b4d08        mov     rcx,qword ptr [rbp+8]
000007fe`87d30155 4c8d1dc4feeeff  lea     r11,[000007fe`87c20020]
000007fe`87d3015c ff15befeeeff    call    qword ptr [000007fe`87c20020] // Call Dispose()
000007fe`87d30162 90              nop
000007fe`87d30163 488d6510        lea     rsp,[rbp+10h]
000007fe`87d30167 5d              pop     rbp
000007fe`87d30168 c3              ret

// I could understand the code above (without exception thrown).

c:\projects\SimpleConsole\SimpleConsole\Program.cs @ 32:
000007fe`87d30169 55              push    rbp
000007fe`87d3016a 4883ec30        sub     rsp,30h
000007fe`87d3016e 488b6920        mov     rbp,qword ptr [rcx+20h]
000007fe`87d30172 48896c2420      mov     qword ptr [rsp+20h],rbp
000007fe`87d30177 488d6d20        lea     rbp,[rbp+20h]

c:\projects\SimpleConsole\SimpleConsole\Program.cs @ 35:
000007fe`87d3017b 48837d0800      cmp     qword ptr [rbp+8],0
000007fe`87d30180 7417            je      000007fe`87d30199
000007fe`87d30182 488d1597feeeff  lea     rdx,[000007fe`87c20020]
000007fe`87d30189 488b4508        mov     rax,qword ptr [rbp+8]
000007fe`87d3018d 803800          cmp     byte ptr [rax],0
000007fe`87d30190 488b4d08        mov     rcx,qword ptr [rbp+8]
000007fe`87d30194 4c8bda          mov     r11,rdx
000007fe`87d30197 ff12            call    qword ptr [rdx]
000007fe`87d30199 90              nop
000007fe`87d3019a 4883c430        add     rsp,30h
000007fe`87d3019e 5d              pop     rbp
000007fe`87d3019f c3              ret 
```

我可以毫无例外地理解代码（上面评论过），但是当抛出异常时代码是如何工作的？代码如何进入注释下方的代码中？

**更新：**

有些人认为我们应该从 IL 开始，所以我粘贴了下面的代码：

```
.method private hidebysig static 
    void UsingClass () cil managed noinlining 
{
    // Method begins at RVA 0x23bc
    // Code size 25 (0x19)
    .maxstack 1
    .locals init (
        [0] class SimpleConsole.DisposableClass dc
    )

    IL_0000: newobj instance void SimpleConsole.DisposableClass::.ctor()
    IL_0005: stloc.0
    .try
    {
        IL_0006: ldloc.0
        IL_0007: call void SimpleConsole.Program::DoSomething(object)
        IL_000c: leave.s IL_0018
    } // end .try
    finally
    {
        IL_000e: ldloc.0
        IL_000f: brfalse.s IL_0017

        IL_0011: ldloc.0
        IL_0012: callvirt instance void [mscorlib]System.IDisposable::Dispose()

        IL_0017: endfinally
    } // end handler

    IL_0018: ret
} // end of method Program::UsingClass 
```

但我认为它没有帮助，因为 IL 几乎将所有内容都保存在 C# 中，就像完整的`try...finally`语句一样。我想了解的是本机代码如何处理这里的异常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T14:33:33.720

抖动比“反汇编”窗口中可见的要多得多。一方面，它生成一个描述局部变量的生命周期和存储的表。对于垃圾收集器来说非常重要，它需要该表来查找对象引用。

它会为异常生成一个展开表。它有一个*非常*理想的属性，它可以免费使用**try**语句。编写具有异常处理的代码的成本为零，无需代码即可进入 try 块。所以你在反汇编中看不到任何东西。没有简单的方法可以从调试器中找到该表。对它们的一个相当不错的描述[是here](http://www.osronline.com/article.cfm?article=469)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-19T14:27:10.603

您实际上是在查看在 .NET 中没有引发异常时异常处理开销如此之小的原因。在发生异常时，框架使用正常代码流路径之外的各种算法（具体取决于抛出的异常类型），这些算法将调用或显式设置指向方法的异常处理块的指令指针.

# iphone - 键盘未从 UITextField 显示

> ID：15501665
> 
> 赞同：2
> 
> 时间：2013-03-19T14:03:49.647
> 
> 标签：iphone, ios, objective-c, uitextfield

我遇到了一个间歇性问题，即键盘不会显示在 UITextField 上。

它发生的次数最多，但不是每次都发生。

我真的无法确定导致它的动作。

我已订阅，`UIKeyboardDidShowNotification`其中的通知用户数据是：

```
 0x15581730 {name = UIKeyboardDidShowNotification; userInfo = {
    UIKeyboardAnimationCurveUserInfoKey = 0;
    UIKeyboardAnimationDurationUserInfoKey = "0.25";
    UIKeyboardBoundsUserInfoKey = "NSRect: {{0, 0}, {320, 0}}";
    UIKeyboardCenterBeginUserInfoKey = "NSPoint: {160, 568}";
    UIKeyboardCenterEndUserInfoKey = "NSPoint: {160, 568}";
    UIKeyboardFrameBeginUserInfoKey = "NSRect: {{inf, inf}, {0, 0}}";
    UIKeyboardFrameChangedByUserInteraction = 0;
    UIKeyboardFrameEndUserInfoKey = "NSRect: {{inf, inf}, {0, 0}}";
    }} 
```

这`NSRect: {{inf, inf}, {0, 0}}`似乎是问题所在，因为当键盘显示时这两个值是有效的。

该应用程序非常标准。这是一个导航堆栈，这发生在堆栈中大约 4 级的视图控制器上。所有文本字段委托都已设置，我看不到视图或控制器的任何其他奇怪之处。

有没有人见过这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T16:57:19.033

你能记住关于你的应用程序的任何细节吗？我认为这可能与 iOS 6 的方向 API 更改有关。我遇到了同样的问题，并且遭受了一些不直观的定向行为。

具体来说，我的应用程序`UIInterfaceOrientationMaskPortraitUp`在 Info.plist 和根 UIViewController 的`supportedInterfaceOrientations:`实现中都指定为唯一允许的方向。我也`NO`一直`shouldAutorotate`从我的根 UIViewController 返回。我正在使用 UIDevice 的方向来确定如何呈现我的子 UIViewController 并使用正在呈现的 UIViewController 类型和 UIDeviceOrientation 的函数设置状态栏方向。

这导致了一个相当简单的问题，但在 iPad（这是一个 iPhone 应用程序）上，当从面向横向的启动板启动时，呈现的 UIViewController（和状态栏）将垂直于窗口框架定向，并且不会向后旋转。

它还在 iPhone 3GS 上引起了一些非常奇怪的间歇性方向/窗口框架错误，其中 RootViewController 的框架被赋予了一些比设备大得多的愚蠢尺寸。

我改变了什么（在我的根 UIViewController 中）：

```
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
}

- (BOOL)shouldAutomaticallyForwardRotationMethods
{
    return NO;
} 
```

我也不再使用设备方向来确定正确的方向，仅依赖于呈现的 UIViewController 类（由导航决定）。这具有解决简单的 iPad 方向错误的预期效果，但我没有看到奇怪的间歇性错误或您也遇到的键盘错误的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T08:38:36.903

你在 iOS 5.x 模拟器上使用[DCIntrospect吗？](https://github.com/domesticcatsoftware/DCIntrospect)我遇到了同样的问题，发现错误的`UIKeyboardFrameBeginUserInfoKey`值是由 DCIntrospect 引起的。`UIKeyboardWillHideNotification`DCIntrospect 可能会在收到通知时尝试更改第一响应者。见代码：

```
- (void)takeFirstResponder
{
    if (![self.inputTextView becomeFirstResponder])
        NSLog(@"DCIntrospect: Couldn't reclaim keyboard input.  Is the keyboard used elsewhere?");
} 
```

通常，我们永远不应该在发布版本上启用 DCIntrospect。所以最终用户不应该遇到这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-19T14:14:31.553

放

```
@interface UIController : UIViewController<UITextFieldDelegate> 
```

并从 Xib 将数据委托分配给您的 UITextfield ..

# mvvmcross - MVVMCross Vee 三解

> ID：15501666
> 
> 赞同：0
> 
> 时间：2013-03-19T14:03:49.620
> 
> 标签：mvvmcross

这可能是一个非常愚蠢的问题，但我似乎无法打开 v3 解决方案文件。

我在 vNext 上遇到了类似的情况，但大约一个小时后它自行解决了，并且似乎可以自行设置以供将来访问。这个 v3 已经运行了一夜，仍然没有加载。

有什么建议么？

谢谢

李

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:15:50.887

您真的需要提供更多信息 - 您使用的是什么操作系统？哪些开发环境？您安装了哪些 SDK？

V3 目前正在 Mac for iOS 上的 Xamarin Studio (v4.0.2) 中开发，以及在 PC 上插入 VS2012 Ultimate 的 Xamarin iOS 和 Droid 的自定义构建 - 安装了 WP7.1 和 WP8 SDK，并使用 resharper (以及一些其他代码）

在过去的 24 小时内，我检查了很多代码 - 所以值得再次从源代码管理中获取最新的代码，看看是否有帮助。

如果没有，那么是否有更多信息发布到输出窗口，说明出了什么问题？我个人在 VS2012 中的 Xamarin 插件上遇到了很多问题并且浪费了很多时间 - 激活模块是一场噩梦（这就是我当前安装自定义构建的原因）

# asp.net - 使用 Asp.net 的 Paypal Mass Payment API（不接收来自 paypal 的响应）

> ID：15501669
> 
> 赞同：0
> 
> 时间：2013-03-19T14:03:54.623
> 
> 标签：asp.net, paypal, httpwebresponse

![在此处输入图像描述](../Images/0855dc5095b491c07b8f4e43b5215762.png)我使用 MassPaymentAPI 创建了 MassPayment 但此方法出现错误

输入方法 :::

```
url="https://api.sandbox.paypal.com/nvp"
postdata="METHOD=MassPay&EMAILSUBJECT=You+have+money!&RECEIVERTYPE=EmailAddress&CURRENCYCODE=USD&L_EMAIL0=bhaumik50%40gmail.com&L_Amt0=1.00&L_UNIQUEID0=&L_NOTE0=&USER=rserasiya_api1.gmail.com&PWD=OneIsTheLonliestNumber&VERSION=1&SOURCE=1" ;
timeout= "3600" ;
X509certificate = "Certifcate Description"

public static string HttpPost(string url, string postData, int timeout, X509Certificate x509)

{

    HttpWebRequest objRequest = (HttpWebRequest) WebRequest.Create(url);

    objRequest.Timeout = timeout;

    objRequest.Method = "POST";

    objRequest.ContentLength = postData.Length;

    if (null != x509)

    {

        objRequest.ClientCertificates.Add(x509);

    }

    using (StreamWriter myWriter = new StreamWriter(objRequest.GetRequestStream()))

    {
        myWriter.Write(postData);

    }

    using (WebResponse response = objRequest.GetResponse())

    {

        using (StreamReader sr = new StreamReader(response.GetResponseStream()))

        {
            return sr.ReadToEnd();
        }
    }
} 
```

在这种方法中，我使用 StreamWriter 对象成功发送了请求，但我没有从贝宝网站得到响应，我该怎么办？请回复..

我的错误是：底层连接已关闭：连接意外关闭。

我放置了引发错误和浏览器错误的方法的图像。

请给我你的建议 ![在此处输入图像描述](../Images/622c1a3b57e02a6c3d691d6ccd337a5a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T09:18:51.023

您的代码中的问题在于您正在使用的 Api url

```
url="https://api.sandbox.paypal.com/nvp" 
```

而你应该使用

```
url="https://api-3t.sandbox.paypal.com/nvp" 
```

# mysql - 如何在 MySQL 中临时禁用外键约束？

> ID：15501673
> 
> 赞同：748
> 
> 时间：2013-03-19T14:03:58.643
> 
> 标签：mysql, sql, django, django-models

是否可以暂时禁用 MySQL 中的约束？

我有两个 Django 模型，每个模型都有一个指向另一个模型的外键。由于外键约束，删除模型实例会返回错误：

```
cursor.execute("DELETE FROM myapp_item WHERE n = %s", n)
transaction.commit_unless_managed()  #a foreign key constraint fails here

cursor.execute("DELETE FROM myapp_style WHERE n = %s", n)
transaction.commit_unless_managed() 
```

是否可以暂时禁用约束并删除？

* * *

## 回答 #1

> 赞同：1625
> 
> 时间：2013-03-19T14:07:45.653

尝试`DISABLE KEYS`或

```
SET FOREIGN_KEY_CHECKS=0; 
```

确保

```
SET FOREIGN_KEY_CHECKS=1; 
```

后。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2014-07-07T02:05:19.477

要全局关闭外键约束，请执行以下操作：

```
SET GLOBAL FOREIGN_KEY_CHECKS=0; 
```

完成后记得把它放回去

```
SET GLOBAL FOREIGN_KEY_CHECKS=1; 
```

警告：只有在进行单用户模式维护时才应该这样做。因为它可能导致数据不一致。例如，当您使用 mysqldump 输出上传大量数据时，它将非常有用。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2015-03-25T16:48:42.223

我通常只在我想截断表时禁用外键约束，并且由于我不断回到这个答案，这是为了将来的我：

```
SET FOREIGN_KEY_CHECKS=0;
TRUNCATE TABLE table;
SET FOREIGN_KEY_CHECKS=1; 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-03-19T14:33:29.117

与其禁用约束，不如将其永久修改为 ON DELETE SET NULL。这将完成类似的事情，您不必打开和关闭密钥检查。像这样：

```
ALTER TABLE tablename1 DROP FOREIGN KEY fk_name1; //get rid of current constraints
ALTER TABLE tablename2 DROP FOREIGN KEY fk_name2;

ALTER TABLE tablename1 
  ADD FOREIGN KEY (table2_id) 
        REFERENCES table2(id)
        ON DELETE SET NULL  //add back constraint

ALTER TABLE tablename2 
  ADD FOREIGN KEY (table1_id) 
        REFERENCES table1(id)
        ON DELETE SET NULL //add back other constraint 
```

阅读这个（[http://dev.mysql.com/doc/refman/5.5/en/alter-table.html](http://dev.mysql.com/doc/refman/5.5/en/alter-table.html)）和这个（[http://dev.mysql.com/doc/refman/5.5/en /create-table-foreign-keys.html](http://dev.mysql.com/doc/refman/5.5/en/create-table-foreign-keys.html)）。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2018-01-11T09:49:24.543

全局关闭外键约束：

```
SET GLOBAL FOREIGN_KEY_CHECKS = 0; 
```

对于活动外键约束：

```
SET GLOBAL FOREIGN_KEY_CHECKS = 1; 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-04-19T04:26:09.267

[使用phpMyAdmin](https://en.wikipedia.org/wiki/PhpMyAdmin)的一个非常简单的解决方案：

*   在您的表格中，转到`SQL`选项卡
*   编辑要运行的 SQL 命令后，旁边有一个`GO`名为“*启用外键检查”*的复选框。
*   **取消选中此复选框并运行您的 SQL**。执行后会自动复查。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-10-12T10:16:36.407

对我来说`SET FOREIGN_KEY_CHECKS=0;`还不够。我还在吃`com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException`。

我不得不添加`ALTER TABLE myTable DISABLE KEYS;`.

所以：

```
SET FOREIGN_KEY_CHECKS=0;
ALTER TABLE myTable DISABLE KEYS;
DELETE FROM myTable;
ALTER TABLE myTable ENABLE KEYS;
SET FOREIGN_KEY_CHECKS=1; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-04-30T21:18:22.603

如果键字段可以为空，那么您还可以在尝试删除它之前将值设置为空：

```
cursor.execute("UPDATE myapp_item SET myapp_style_id = NULL WHERE n = %s", n)
transaction.commit_unless_managed() 

cursor.execute("UPDATE myapp_style SET myapp_item_id = NULL WHERE n = %s", n)
transaction.commit_unless_managed()

cursor.execute("DELETE FROM myapp_item WHERE n = %s", n)
transaction.commit_unless_managed()

cursor.execute("DELETE FROM myapp_style WHERE n = %s", n)
transaction.commit_unless_managed() 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-12-31T10:57:47.703

在[phpMyAdmin](https://en.wikipedia.org/wiki/PhpMyAdmin)中，您可以选择多行，然后单击删除操作。您将进入一个列出删除查询的屏幕。它看起来像这样：

[![在此处输入图像描述](../Images/30dd97b83dac1958dcb56131e9457988.png)](https://i.stack.imgur.com/Y8Xgv.png)

请取消选中“启用外键检查”复选框，然后单击`Yes`以执行它们。

即使存在 ON DELETE 限制约束，这也将使您能够删除行。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2015-01-14T10:21:37.303

将外键约束设置为 0 不是一个好主意，因为如果这样做，您的数据库将无法确保它不违反参照完整性。这可能导致数据不准确、误导或不完整。

您创建外键是有原因的：因为子列中的所有值都应与父列中的值相同。如果没有外键约束，子行的值可能不在父行中，这会导致数据不准确。

例如，假设您有一个供学生登录的网站，并且每个学生都必须以用户身份注册一个帐户。您有一个用户 ID 表，用户 ID 作为主键；和另一个学生帐户表，以学生 ID 作为列。由于每个学生都必须有一个用户 ID，因此将学生帐户表中的学生 ID 设为引用用户 ID 表中主键用户 ID 的外键是有意义的。如果没有外键检查，一个学生最终可能有一个学生 ID 和没有用户 ID，这意味着一个学生可以在没有成为用户的情况下获得一个帐户，这是错误的。

想象一下，如果它发生在大量数据上。这就是您需要外键检查的原因。

最好找出导致错误的原因。最有可能的是，您尝试从父行中删除而不从子行中删除。在从父行删除之前尝试从子行中删除。

# graphite - 已删除/空的 Graphite Whisper 文件自动重新生成

> ID：15501677
> 
> 赞同：8
> 
> 时间：2013-03-19T14:04:11.687
> 
> 标签：graphite, statsd

我正在尝试删除一些旧的石墨测试耳语指标，但没有任何成功。我可以通过删除文件来删除指标。（请参阅：[如何清理石墨耳语的数据？](https://stackoverflow.com/questions/9587161/how-to-cleanup-the-graphite-whispers-data)）但是，在吹走它们重新生成的文件的几秒钟内（它们没有指标并保持这种状态，因为没有在这些文件中创建新指标）。我尝试在删除文件之前停止 carbon (carbon-cache.py stop)，但是当我重新启动 carbon (carbon-cache.py --debug start &) 时，它们又回来了。

如何永久删除这些文件/metics，使它们永远不会回来？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-11-15T22:44:57.220

默认情况下，Statsd 将继续为在上一个刷新周期内未收到的计数器发送 0。这会导致 carbon 重新创建文件。

假设我们要从 Statsd 中删除一个名为“bad_metrics.sent”的计数器。您可以使用默认在端口 8126 上运行的 Statsd 管理界面：

```
$ telnet <server-ip> 8126
Trying <server-ip>...
Connected to <server-name>.
Escape character is '^]'. 
```

使用“帮助”获取命令列表：

```
help
Commands: stats, counters, timers, gauges, delcounters, deltimers, delgauges, quit 
```

您可以使用“计数器”查看所有计数器的列表：

```
counters
{ 'statsd.bad_lines_seen': 0,
  'statsd.packets_received': 0,
  'bad_metrics.sent': 0 }
END 
```

它的“delcounters”、“deltimers”和“delgauges”命令从 statsd 中删除指标：

```
delcounters bad_metrics.sent
deleted: bad_metrics.sent
END 
```

从 Statsd 中删除指标后，您可以删除与其关联的耳语文件。在本例中，这将是：

```
/opt/graphite/storage/whisper/bad_metrics/sent.wsp 
```

或（在 Ubuntu 中）：

```
/var/lib/graphite/whisper/bad_metrics/sent.wsp 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-12T22:54:47.103

你在运行 statsd 还是类似的东西？

我遇到了同样的问题，这是因为在我删除耳语文件后，statsd 正在刷新它在内存中的计数器。我回收了 statsd 并且文件现在仍然被删除。

希望这可以帮助

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-11T19:19:11.513

最新的 StatsD 版本可以选择在刷新后不再发送零，而只发送实际发送给它的内容。如果您打开它，则不应重新创建耳语文件：[https ://github.com/etsy/statsd/blob/master/exampleConfig.js#L39](https://github.com/etsy/statsd/blob/master/exampleConfig.js#L39)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-14T18:33:39.993

我们没有运行`statsd`，但我们运行`carbon-aggregator`了类似的目的。重新启动它解决了类似的问题。

# c++ - 在另一个 C++ 线程中挂起和恢复一个 C++ 线程

> ID：15501681
> 
> 赞同：9
> 
> 时间：2013-03-19T14:04:26.517
> 
> 标签：c++, multithreading, winapi

我有一个 C++ 代码，里面有两个线程。在线程 2 中的事件“A”之后，线程 1 应该暂停（挂起），线程 2 中将执行更多任务（例如事件“B”），最后线程 1 应该恢复。有没有办法做到这一点？

我的代码看起来像这样：

```
HANDLE C;
DWORD WINAPI A (LPVOID in)
{
    while(1){
        // some operation
    }
    return 0;
}

DWORD WINAPI B (LPVOID in)
{
    while(1){

        //Event A occurs here

        SuspendThread (C);

        //Event B occurs here

        ResumeThread (C);
        }
    return 0;
}

int main()
{
    C = CreateThread (NULL, 0, A, NULL, 0, NULL);
    CreateThread (NULL, 0, B, NULL, 0, NULL);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-13T20:15:49.777

嗨，我有一个例子，我从 cpp 参考中得到启发。该示例使用 C++ 11，因此鉴于此问题未标记为 win32，但 c++ 和多线程我发布了一些内容。

首先这里是原始链接。

[http://en.cppreference.com/w/cpp/thread/sleep_for](http://en.cppreference.com/w/cpp/thread/sleep_for)

现在这是我得到的解决问题的代码。

```
#include <iostream>
#include <string>
#include <thread>
#include <mutex>
#include <condition_variable>

std::mutex m;
std::condition_variable cv;
std::string data;
bool ready = false;
bool processed = false;

void ThreadB_Activity()
{
    // Wait until ThreadA() sends data
    {
        std::unique_lock<std::mutex> lk(m);
        cv.wait(lk, []{return ready;});
    }

    std::cout << "Thread B is processing data\n";
    data += " after processing";
    // Send data back to ThreadA through the condition variable
    {
        std::lock_guard<std::mutex> lk(m);
        processed = true;
        std::cout << "Thread B signals data processing completed\n";
    }
    cv.notify_one();
}

void ThreadA_Activity()
{
    std::cout<<"Thread A started "<<std::endl;
    data = "Example data";
    // send data to the worker thread
    {
        std::lock_guard<std::mutex> lk(m);
        ready = true;
        std::cout << "Thread A signals data are ready to be processed\n";
    }
    cv.notify_one();//notify to ThreadB that he can start doing his job

    // wait for the Thread B
    {
        std::unique_lock<std::mutex> lk(m);
        cv.wait(lk, []{return processed;});
    }
    std::cout << "Back in Thread A , data = " << data << '\n';

    std::this_thread::sleep_for( std::chrono::milliseconds( 1000 ));
    std::cout<<"end of Thread A"<<std::endl;
}

int main()
{
    std::thread ThreadB(ThreadB_Activity);
    std::thread ThreadA(ThreadA_Activity);

    ThreadB.join();
    ThreadA.join();

    std::cout << "Back in main , data = " << data << '\n';
    return 0;
} 
```

希望对您有所帮助，欢迎任何意见:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:36:16.583

由于您似乎使用的是 win32，因此您可以使用[事件](http://www.codeproject.com/Articles/8211/How-to-use-WIN32-Event-Kernel-Object)

如果你想在 pthreads 中做类似的事情，[这里有一个例子](https://stackoverflow.com/questions/2085511/wait-and-notify-in-c-c-shared-object)。

在这两种情况下，线程 A 将测试条件/事件（如果设置则等待，否则继续），线程 B 将设置并清除条件/事件。请注意，您可能还需要线程 A 和 B 之间的互斥锁，具体取决于它们在做什么，它们会相互破坏吗？

# sql - 不能在动态 SQL 中使用 CASE 表达式

> ID：15501683
> 
> 赞同：-3
> 
> 时间：2013-03-19T14:04:30.150
> 
> 标签：sql, sql-server-2008

在以下查询中，`t2.stock`它有两个值 (`1`和`0`)。我想要 1 值输出 as`IN`和`0`value as `OUT`。问题是我不能`CASE`在这种类型的查询中使用表达式。有没有办法做到这一点？

```
use DB1  
go

declare @SQL varchar(500),

Set @SQL=' select t1.ID,t1.Name,t2.stock 
    from table1 t1 
        inner join table2 t2 on t1.ID = t2.ID'

exec (@SQL) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T14:35:33.360

如果*这种类型的查询*是指动态查询，那么您可能对`CASE`和/或动态查询有一些误解。通常，`CASE`在动态查询中使用表达式不会有问题，可以在[@Gordon Linoff 的回答](https://stackoverflow.com/a/15501739/297408)中看到一个示例。

但是，如果您绝对坚持，您的情况还有*另*一种选择：

```
use DB1  
go

declare @SQL varchar(500);

Set @SQL=' select t1.ID, t1.Name, **v.description as stock**
    from table1 t1 
        inner join table2 t2 on t1.ID = t2.ID
        **inner join (
           values (1, ''IN''),
                  (0, ''OUT'')
        ) t2 (stock, description) on t2.stock = v.stock**
';
exec (@SQL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:07:01.393

但是您*可以*在动态 SQL 中使用`case`语句：

```
use DB1  
go

declare @SQL varchar(500),

Set @SQL='
select t1.ID, t1.Name, (case when t2.stock = 1 then ''IN'' else ''OUT'' end) as stock
from table1 t1 
     inner join table2 t2 on t1.ID = t2.ID
'

exec (@SQL) 
```

# paypal - 加拿大支付专业沙盒账户

> ID：15501688
> 
> 赞同：0
> 
> 时间：2013-03-19T14:04:39.533
> 
> 标签：paypal, paypal-sandbox

由于新的开发者网站已经上线，在沙箱上创建支付 Pro Account 是不可能的，因为加拿大用户也不能使用 REST 选项，我们可以做些什么来测试我们的 Pro 解决方案？导入我的测试账户时，pro 会自动切换到基本业务，并清除我的凭据信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:09:18.050

我们目前正在努力解决这个问题。截至目前，这取决于你击中的盒子。您可以尝试多次创建 US PRO 帐户。您可能会点击当前未遇到帐户创建问题的框之一。如果您确实点击了其中一个工作框，您应该获得一个使用 API 凭据创建的专业帐户。

# jquery - 仅显示日期为 mvc3 的 jquery 日期时间选择器

> ID：15501694
> 
> 赞同：0
> 
> 时间：2013-03-19T14:05:02.753
> 
> 标签：jquery, asp.net-mvc-3, datepicker

我如何仅在 jquery 日期时间选择器中默认为日期。页面第一次加载文本框时默认为日期和时间，但在我选择日期后它只显示日期部分。日期绑定到模型。

查看代码

```
 @Html.EditorFor(m=>m.EndDate)

@*java script*@

 $(function () {
$("#EndDate").datepicker(
    {
        dateFormat: 'yy/mm/dd',
        changeMonth: true,
        changeYear: true,
        minDate: new Date()
    });
}); 
```

所以我想要的是日期时间文本框总是只显示没有时间的日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T04:39:54.957

You better create a custom function to convert DateTime object to date and use this in he view.

Server side:

```
 public static string ShowDate(this DateTime dateTime)
        {          
            string dateFormat = String.Empty;
            dateFormat ="yy/mm/dd";// or the format you need

            return dateTime.ToString(dateFormat);
        } 
```

In the view:

```
@Html.TextBoxFor(model => model.EndDate, new {  @Value =Model.EndDate.DisplayDate() }) 
```

# clojure - Clojure ":import" 用法

> ID：15501695
> 
> 赞同：0
> 
> 时间：2013-03-19T14:05:04.977
> 
> 标签：clojure

和有什么区别

```
(:import (java.io ByteArrayInputStream) (java.net URL))) 
```

和

```
(:import (java.io.ByteArrayInputStream) (java.net.URL))) //Doesn't work 
```

(URL. " [http://google.com](http://google.com) ") // URL 类名未找到错误

尽管我知道第二个声明不起作用，但我对 2 个导入声明之间的用法感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:24:05.440

如果你有完整的符号（第二种情况），你不需要在它周围加上括号。

```
(:import java.io.ByteArrayInputStream java.net.URL) 
```

看看[http://clojuredocs.org/clojure_core/clojure.core/import](http://clojuredocs.org/clojure_core/clojure.core/import)

# ruby-on-rails - 在活动管理员中更改默认日期格式化程序

> ID：15501696
> 
> 赞同：15
> 
> 时间：2013-03-19T14:05:05.507
> 
> 标签：ruby-on-rails, localization, activeadmin

在[ActiveAdmin](http://activeadmin.info/documentation.html)中，日期以所谓的美国格式打印`%B %d, %Y %H:%M`。例如`March 19, 2013 13:25`

但是，我的“默认”前端使用默认的 Rails (ISO) 格式打印它`2013-03-07 14:12:31 UTC`，就像`<%= Date.new %>`在视图中放置 a 时看到的那样。

1.  什么是定义 ActiveAdmin 日期的格式？
2.  如果可能，只需遵循全局 Rails 范围的 i18n 设置，在哪里或如何更改它。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-19T16:01:50.667

请确保您的 config/locales/en.yml 中有下一行

```
en:
  date:
    formats:
      long: "%Y-%m-%d"
  time:
    formats:
      long: "%Y-%m-%d %H:%M:%S" 
```

此外，如果您想更改过滤器默认日期格式，请尝试此[Active Admin 日期过滤器日期格式自定义](https://stackoverflow.com/questions/12405230/active-admin-date-filter-date-format-customisation/13266522#13266522)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-01-06T18:24:20.380

> 什么是定义 ActiveAdmin 日期的格式？

从配置文档的*日期和时间的本地化格式部分：*

> Active Admin 设置`:long`为日期和时间的默认本地化格式。

来源：[常规配置 - 日期和时间的本地化格式](https://github.com/activeadmin/activeadmin/blob/v1.0.0.pre2/docs/1-general-configuration.md#localize-format-for-dates-and-times)。

> 如果可能，只需遵循全局 Rails 范围的 i18n 设置，在哪里或如何更改它。

从 ActiveAdmin [v1.0.0.pre2 开始](https://github.com/activeadmin/activeadmin/pull/4026)，您可以覆盖默认`localize_format`配置以使用不同的格式：

```
ActiveAdmin.setup do |config|
  config.localize_format = :short
end 
```

或者，您可以按照[Fivell](https://stackoverflow.com/users/246544/fivell)`:long`的建议更新您的语言环境配置中的格式：

```
en:
  date:
    formats:
      long: "%Y-%m-%d"
  time:
    formats:
      long: "%Y-%m-%d %H:%M:%S" 
```

# stream - cudaStreamWaitEvent 似乎没有等待

> ID：15501699
> 
> 赞同：5
> 
> 时间：2013-03-19T14:05:11.127
> 
> 标签：stream, synchronization, nvidia, cuda-events

我正在尝试编写一个小型演示程序，该程序有两个 cuda 流正在进行，并且受事件控制，相互等待。到目前为止，这个程序看起来像这样：

```
// event.cu
#include <iostream>
#include <cstdio>
#include <cuda_runtime.h>
#include <cuda.h>

using namespace std;

__global__ void k_A1() { printf("\tHi! I am Kernel A1.\n"); }
__global__ void k_B1() { printf("\tHi! I am Kernel B1.\n"); }
__global__ void k_A2() { printf("\tHi! I am Kernel A2.\n"); }
__global__ void k_B2() { printf("\tHi! I am Kernel B2.\n"); }

int main()
{
  cudaStream_t streamA, streamB;
  cudaEvent_t halfA, halfB;
  cudaStreamCreate(&streamA);
  cudaStreamCreate(&streamB);
  cudaEventCreate(&halfA);
  cudaEventCreate(&halfB);

  cout << "Here is the plan:" << endl <<
    "Stream A: A1, launch 'HalfA', wait for 'HalfB', A2." << endl <<
    "Stream B: Wait for 'HalfA', B1, launch 'HalfB', B2." << endl <<
    "I would expect: A1,B1, (A2 and B2 running concurrently)." << endl;

  k_A1<<<1,1,0,streamA>>>(); // A1!
  cudaEventRecord(halfA,streamA); // StreamA triggers halfA!
  cudaStreamWaitEvent(streamA,halfB,0); // StreamA waits for halfB.
  k_A2<<<1,1,0,streamA>>>(); // A2!

  cudaStreamWaitEvent(streamB,halfA,0); // StreamB waits, for halfA.
  k_B1<<<1,1,0,streamB>>>(); // B1!
  cudaEventRecord(halfB,streamB); // StreamB triggers halfB!
  k_B2<<<1,1,0,streamB>>>(); // B2!

  cudaEventDestroy(halfB);
  cudaEventDestroy(halfA);
  cudaStreamDestroy(streamB);
  cudaStreamDestroy(streamA);

  cout << "All has been started. Synchronize!" << endl;
  cudaDeviceSynchronize();
  return 0;
} 
```

我对 CUDA 流的掌握如下： 流是一种可以添加任务的列表。这些任务是按顺序处理的。所以在我的程序中，我可以放心 streamA 会按顺序

1.  调用内核 k_A1
2.  触发半A
3.  等待有人触发halfB
4.  调用内核 k_A2

和streamB会

1.  等待有人触发halfA
2.  调用内核 k_B1
3.  触发半B
4.  调用内核 k_B2

通常，两个流可能彼此异步运行。但是，我想阻止 streamB 直到 A1 完成，然后阻止 streamA 直到 B1 完成。

这似乎没有那么简单。在我的带有 Tesla M2090 (CC 2.0) 的 Ubuntu 上，输出

```
nvcc -arch=sm_20 event.cu && ./a.out 
```

是

```
Here is the plan:
Stream A: A1, launch 'HalfA', wait for 'HalfB', A2.
Stream B: Wait for 'HalfA', B1, launch 'HalfB', B2.
I would expect: A1,B1, (A2 and B2 running concurrently).
All has been started. Synchronize!
        Hi! I am Kernel A1.
        Hi! I am Kernel A2.
        Hi! I am Kernel B1.
        Hi! I am Kernel B2. 
```

我真的希望 B1 在 cudaEventRecord(halfB,streamB) 之前完成。尽管如此，流 A 显然不会等待 B1 的完成，因此也不会等待 halfB 的记录。

更重要的是：如果我完全删除 cudaEventRecord 命令，我希望程序锁定 cudaStreamWait 命令。但它不会产生相同的输出。我在这里俯瞰什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T22:17:49.280

我认为这是因为在记录“halfB”之前调用了“cudaStreamWaitEvent(streamA,halfB,0);”(cudaEventRecord(halfB,streamB);)。cudaStreamWaitEvent 调用很可能正在搜索之前的封闭“halfB **”**；既然没有被发现，它就静静地往前走。请参阅以下文档：

> 该流将仅等待对on`stream`的最新主机调用完成。一旦此调用返回，任何函数（包括和）都可能再次被调用，并且后续调用不会对 产生任何影响。`cudaEventRecord()``event``cudaEventRecord()``cudaEventDestroy()``event``stream`

如果您必须进行深度优先编码，我找不到解决方案；但是，以下代码可能会导致您想要的结果：

```
 k_A1<<<1,1,0,streamA>>>(d); // A1!
  cudaEventRecord(halfA,streamA); // StreamA triggers halfA!
  cudaStreamWaitEvent(streamB,halfA,0); // StreamB waits, for halfA.
  k_B1<<<1,1,0,streamB>>>(d); // B1!
  cudaEventRecord(halfB,streamB); // StreamB triggers halfB!
  cudaStreamWaitEvent(streamA,halfB,0); // StreamA waits for halfB.
  k_A2<<<1,1,0,streamA>>>(d); // A2!
  k_B2<<<1,1,0,streamB>>>(d); // B2! 
```

分析证实了这一点：

![在此处输入图像描述](../Images/d263dd6d8baab41b780f02a0fae299d0.png)

请注意，我更改了内核接口。

# java - Aspectj 围绕字段和类初始化的建议

> ID：15501701
> 
> 赞同：1
> 
> 时间：2013-03-19T14:05:13.087
> 
> 标签：java, aspectj

我为我的应用程序实现了一种监控框架。基本思想是使用 Aspectj 编织一段代码，通过 JMX 公开带有特定注释的变量。所以我使用切入点

```
@Around("get (@mypackage.Gauge * *) && @annotation(annotation)") 
```

但是，为了让我的变量通过 JMX 公开，我需要一次获取它的值（以便发生 JMX 绑定）。我使用编译时编织。加载带有@Gauge注释的类后，有什么方法可以执行某段代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T10:13:56.033

> `@Gauge`加载带有注释的类后，有什么方法可以执行某段代码？

是的。试试这个：

```
after() : staticinitialization(@Gauge *) {
    // Do something here
} 
```

# grails - grails或html中的多行标签

> ID：15501702
> 
> 赞同：0
> 
> 时间：2013-03-19T14:05:21.847
> 
> 标签：grails, input, textarea, indentation

使用 grails 应用程序和本地数据库，我以 xml 格式返回一些文本。

`<textarea></textarea>`我可以用正确的缩进（制表、换行等）在标签中格式良好地返回它

我想更进一步。在我返回的文本中，有一些`<img/>`标签，我想用真实图像本身替换这些标签。

我四处寻找，目前没有找到解决方案。我知道您不能将图像添加到文本区域（除了在背景中），如果我选择 div 标签，我将不再有缩进（因此，更难阅读）

我想知道使用`<g:textField/>`grails 库中的一个或其他标签是否可以解决问题。如果是这样，我如何使用 jquery 将它们附加到页面。

例如，如何`<g:textField/>`在 jquery 中追加 a。它不解释它，我得到这个错误

```
SyntaxError: missing ) after argument list [Break On This Error]...+doc).append("<input type="text" id="FTMAP_&quot;+nb_sec+&quot;" ... 
```

在我的 javascript 文件中，我有

```
$("#FTM_"+doc).append("<g:textField id='FTMAP_"+nb_sec+"' ... /> 
```

任何可能的解决方案？

编辑

我确实忘记提到我的最终意图是能够修改文本（包括标签）并有一个漂亮而整洁的缩进，以便最终用户最容易做到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:51:47.247

你问了几个不同的问题：

*1\. 我可以使用单个 HTML 标记将图像包含在预先格式化的文本中吗？*

不可以。您必须自己解析文本并将其转换为样式文本。

*2\. grails 标准标签中是否有一个标签可以为我完成此操作？*

不。

*3\. 如何从我的 javascript 代码中添加 grails 标签。*

Grails 标签在服务器端处理，javascript 在客户端处理。这意味着您不能直接通过 javascript 添加 grails 标签。

但是，有几种方法可以实现相同的结果：

*   您可以将 javascript 变量设置为 grails 标记的呈现内容。此解决方案适用于初始请求时已知的数据。

    `var tagOutput = "${g.textField(/* etc */)}";`

*   您可以为要添加的内容发出 ajax 请求。然后您的服务器端 grails 代码可以呈现您需要的标签。这对于实时数据或将在单个渲染页面上多次更新的数据更好。

# android - 如何使用返回键在 LibGDX 中暂停和恢复？

> ID：15501703
> 
> 赞同：4
> 
> 时间：2013-03-19T14:05:24.593
> 
> 标签：android, libgdx

我正在使用 LibGDX 创建游戏。现在我有两个问题。

首先，我试图找回关键，以便游戏暂停。我已经在课堂上调用了该`Gdx.input.setCatchBackKey(true)`方法。`Game`这是代码：

```
public class CvSGame extends Game {
    public Preferences prefs;

    @Override
    public void create() {  
        Gdx.input.setCatchBackKey(true);
        prefs = Gdx.app.getPreferences("game_pref");
        //setScreen(new SplashScreen(this));
        //setScreen(new HomeScreen(this));
        //setScreen(new GameScreen(this));
        GamePlay.initialized(this);
    }
} 
```

`GamePlay.initialized`是一种设置 的方法，`Game`它`GameScreen`实现了`Screen`和`InputProcessor`。

在中`GameScreen`，我已经打电话了`setInputProcessor`。的代码`GameScreen`是：

```
public class GameScreen implements Screen, InputProcessor{
    CvSGame parent;

    public GameScreen(CvSGame pParent){
        parent = pParent;

        Gdx.input.setInputProcessor(this);

    }

    @Override
    public void show() {

    }

    @Override
    public void resize(int width, int height) {

    }

    @Override
    public void render(float delta) {

    }

    @Override
    public void hide() {

    }

    @Override
    public void pause() {

    }

    @Override
    public void resume() {

    }

    @Override
    public void dispose() {

    }

    @Override
    public boolean keyDown(int keycode) {
        if(keycode == Keys.BACK) {
            pauseGame();
        }
        return false;
    }

    @Override
    public boolean keyUp(int keycode) {
        return false;
    }

    @Override
    public boolean keyTyped(char character) {
        return false;
    }

    @Override
    public boolean touchDown(int screenX, int screenY, int pointer, int button) {

        return false;
    }

    @Override
    public boolean touchUp(int screenX, int screenY, int pointer, int button) {

        return false;
    }

    @Override
    public boolean touchDragged(int screenX, int screenY, int pointer) {

        return false;
    }

    @Override
    public boolean mouseMoved(int screenX, int screenY) {
        return false;
    }

    @Override
    public boolean scrolled(int amount) {
        return false;
    }

    private void pauseGame(){
        GamePlay.gameState = GamePlay.PAUSED;
    }
} 
```

我认为，如果我的 Android 设备上的后退按钮被按下，它会调用该`keyDown`方法并且该方法`pauseGame`将被调用。

但是，这并没有发生。我的游戏正在退出并且`keyDown`没有调用该方法（如果调用了 keyDown 方法，我已经尝试记录一条消息，但该消息从未出现）。

我遇到的第二个问题是使用该方法暂停游戏引起的`pause()`。我认为如果主页按钮或设备收到呼叫，则会调用其中的`pause`方法`GameScreen`。所以，我想如果我想在按下主页按钮时暂停我的游戏，我会调用 method`pauseGame`中的方法`pause`。而且效果很好。但是问题出现在我按下后退按钮后，游戏就会退出。游戏退出后我尝试重新启动它，我的纹理没有加载。

顺便说一句，目前我没有使用`AssetManager`而是调用一个方法来在构造函数中加载资产。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:16:44.187

据我了解，您需要`InputProcessor`在调用之前设置您的`setCatchBackKey`。您可以通过将`GameScreen`构造函数更改为：

```
public GameScreen(CvSGame pParent) {
    parent = pParent;
    Gdx.input.setInputProcessor(this);
    Gdx.input.setCatchBackKey(true);
} 
```

相关问题：[在 libgdx 中，如何从后退按钮获取输入？](https://stackoverflow.com/questions/7223723/in-libgdx-how-do-i-get-input-from-the-back-button)

至于纹理未加载。确保当您的游戏被销毁（`dispose`函数）时，您正在卸载所有纹理并处理它们。重新创建游戏后，请务必再次加载它们。

[此处](http://code.google.com/p/libgdx/wiki/MemoryManagment)列出的所有类都需要手动处理，否则会导致泄漏。关于纹理，您可能会在加载纹理时遇到问题，而无需先处理旧副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T16:28:15.137

对于您的用例（在按下后调用`pause`方法），您不需要做任何特殊的事情来捕捉 Back 键。Libgdx 将`pause`在您注册的`ApplicationListener`. 请参阅[`ApplicationListener.pause()`javadoc](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/ApplicationListener.html#pause%28%29)，它说：

> 当应用程序暂停时调用。当用户按下 Android 上的 Home 按钮或发生来电时，应用程序在销毁之前暂停。在桌面上，这只会在调用 dispose() 之前立即调用。

将`Game` `ApplicationListener`自动转发`pause`到当前`Screen`，甚至。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-14T06:45:28.153

您`InputProcessor`在课堂上实施对吗？而且，正如@MCeley 所说，您应该按顺序排列此代码：

```
Gdx.input.setInputProcessor(this);
Gdx.input.setCatchBackKey(true); 
```

此外，在该`pauseMenu()`方法中，添加一个布尔参数，一个像这样的旧标志：

```
private void pauseGame(boolean isPaused){
    if(isPaused) {
        GamePlay.gameState = GamePlay.PAUSED;
    } else {
        GamePlay.gameState = GamePlay.UNPAUSED;
    }
} 
```

将布尔值添加为`GameScreen`类中的标志和字段。请记住，标记就像一个标记，它是一种更好的反击或反转它的方法。在接受我的答案之前，您必须研究序列如何工作的流程，从结尾而不是开头开始。您必须通过重新跟踪这些步骤来了解它是如何到达那里的。请注意，在某种程度上，这是一个伪代码。

# html - 响应式设计的字体大小

> ID：15501706
> 
> 赞同：2
> 
> 时间：2013-03-19T14:05:33.813
> 
> 标签：html, css, responsive-design, font-size

跨不同视口大小调整字体大小的明智策略是什么？我看到三种不同的可能选项：

1.  随着视口大小减小，字体大小减小。
2.  所有视口大小的字体大小相同。
3.  随着视口大小的减小，增加字体大小。

什么是最好的选择，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:15:05.190

这是一个开放式问题 - 因为实际上，它归结为：您的内容需要什么？

您的页面是否有很长的文本段落？或者您正在查看有很多标题的主页？

*一般来说，在处理正文时*，我倾向于通过为移动/小屏幕尺寸设置基本字体大小来处理事情。然后，在更大的视口尺寸下，增加字体大小。什么视口大小/断点？这又取决于内容。您想密切关注每行文本的字符数。当它变得太长时，您将需要增加字体大小。这种方法不是*特定于设备的*，而是*特定于内容的*。

另外，[请留意 vw 字体大小单位](http://css-tricks.com/viewport-sized-typography/)。希望我们能够尽快开始使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:09:27.203

我喜欢使用`em`或`rem`用作内容文本的字体大小。让设备决定如何呈现此文本。

如果它的设计关键文本（如标题或导航项）我使用`px`值，但仍然使用 ( `r`) `em`s 可能很好。

如果文本需要缩放以适应其容器，我很幸运使用了一个名为[fittextJS的插件](http://fittextjs.com/)

# c# - 如何从基于 OnMethodBoundaryAspect 的日志记录中排除？

> ID：15501707
> 
> 赞同：3
> 
> 时间：2013-03-19T14:05:33.963
> 
> 标签：c#, c#-4.0, postsharp, aop

我有这个记录器：

```
[Serializable]
[AttributeUsage(AttributeTargets.All)]
public class MethodsInterceptAspect : OnMethodBoundaryAspect {
    public override void OnEntry(MethodExecutionArgs args) { Logger.LogMethodEntry(args.Method, DateTime.Now); }
    public override void OnExit(MethodExecutionArgs args) { Logger.LogMethodExit(args.Method, DateTime.Now); }
} 
```

但是有一个密集的函数（许多嵌套循环，对性能至关重要）也会使日志膨胀。如何排除它及其所有子程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T09:53:03.620

您可以使用`AttributeExclude=true`方面的属性来执行此操作。排除可以在装配级别应用

```
[assembly: Trace("Business", AttributeTargetTypes="BusinessLayer.*", AttributePriority = 1)]
[assembly: Trace(AttributeTargetMembers="Dispose", AttributeExclude = true, AttributePriority = 2)] 
```

或按方法

```
[assembly: Trace("Business", AttributeTargetTypes="BusinessLayer.*")]
namespace BusinessLayer
{
  public class Process : IDisposable
  {
   public Customer Create(string value) { ... }
   public void Delete(long id) { ... }

   [Trace(AttributeExclude=true)]
   public void Dispose() { ... }
  }
} 
```

[可以在这里找到更完整的答案](http://www.postsharp.net/blog/post/multicasting-of-custom-attributes.aspx)

# ios - cellForRowAtIndexPath 在加载时将单元格视为不同的高度，然后重新加载？

> ID：15501712
> 
> 赞同：2
> 
> 时间：2013-03-19T14:05:54.073
> 
> 标签：ios, objective-c, uitableview, heightforrowatindexpath

前言：这是一个相当抽象的问题。

我有一些单元格`UITableView`使用不同的图像，具体取决于单元格的高度（以 50px 为增量，从 50px 到 1000px 高）。我遇到了一个奇怪的问题，当应用程序首次加载时，`cellForRowAtIndexPath`报告前三个单元格（无论三个单元格是否都在屏幕上）的高度为 100px，然后当我向下滚动并再次向上滚动时，它们的高度会恢复到正确的值。屏幕上没有高度变化，只有使用的图像发生变化，以及`cell.frame.size.height`我的`NSLog`陈述中的值。

我一直在登录，`heightForRowAtIndexPath`并且`cellForRowAtIndexPath`我可以在他们离开时验证高度是否正确`heightForRowAtIndexPath`。但是，当输入 时`cellForRowAtIndexPath`，前三个高度都统一设置为 100。然后我向下滚动直到这三个单元格离开屏幕，然后向上滚动，`.height`值已更改为正确的值。

总结一下，我的问题是：

**`heightForRowAtIndexPath`在最后和最开始之间是否有任何代码`cellForRowAtIndexPath`可以改变`cell.frame.size.height`这些前几个单元格的值？**

**为什么这个问题只发生在前三个单元格上？而且，为什么他们会在稍后重新加载时恢复？我认为重用标识符可能是原因，但它们在首次加载时仍被分配了该标识符，所以这不重要，不是吗？**

**编辑：**我认为 100px 高度来自故事板中原型单元格的行高，就好像我将其更改为 101px 一样，前三个单元格最初为 101px。

**编辑：**这是我用来设置图像的代码，虽然这部分正在工作，但它只是使用了错误的值：

```
UIImage *cappedBG;
float cellHeight = cell.contentView.frame.size.height;

if (cellHeight <= 51) {
    cappedBG = [[UIImage imageNamed: @"bg50.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
} else if (cellHeight <= 101) {
    cappedBG = [[UIImage imageNamed: @"bg100.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
} else if (cellHeight <= 151) {
    cappedBG = [[UIImage imageNamed: @"bg150.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
} else if (cellHeight <= 201) {
    cappedBG = [[UIImage imageNamed: @"bg200.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
} else {
    cappedBG = [[UIImage imageNamed: @"bg250.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T10:32:51.687

您只是不能依赖`tableView:cellForRowAtIndexPath:`. 您在该方法中配置的单元格的框架将在代码从此方法返回后设置。

您获得的值不是该特定行的实际高度。您从刚刚出列的单元格中获得高度。如果没有单元格出列，则使用刚刚创建的单元格的高度。100 可能是故事板/笔尖中单元格的高度。
这个高度与将要显示的单元格的高度无关。

由于您已经计算了行高，因此请`tableView:heightForRowAtIndexPath:`使用此值。

```
float cellHeight = [self tableView:tableView heightForRowAtIndexPath:indexPath];

if (cellHeight <= 51) {
    cappedBG = [[UIImage imageNamed: @"bg50.png"] resizableImageWithCapInsets: UIEdgeInsetsMake(25, 25, 25, 25) resizingMode: UIImageResizingModeStretch];
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:09:18.510

您不应该真正在 cellForRowAtIndexPath 中进行单元格的布局。

最好的方法是创建一个 UITableViewCell 子类，其中包含您需要的所有 UI 元素。

然后在子类中你可以覆盖`- (void)layoutSubviews`.

这样您就可以将所有内容分开，而不是将所有内容都放在视图控制器中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T14:38:16.270

目前，在查看您的问题后，我认为您在使用不同的单元格高度时遇到了问题（滚动时）。我相信您没有在 heightForRowAtIndexPath 中给出正确的值。

以下是我编写的简单代码。这段代码在表格中显示了 20 行，交替行有不同的大小。（我用不同的颜色来区分）

```
#pragma mark - TableView DataSource Methods

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(indexPath.row %2 == 0) return 50;
    else return 100;
}

// Customize the number of sections in the table view.
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 20;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *stringCellIdentifier = @"BookOutVehicleCell";

    UITableViewCell *tableViewCell = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:stringCellIdentifier];

    if (tableViewCell == nil)
        tableViewCell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:stringCellIdentifier] autorelease];

    if(indexPath.row %2 == 0) tableViewCell.contentView.backgroundColor = [UIColor redColor];
    else  tableViewCell.contentView.backgroundColor = [UIColor greenColor];

       return tableViewCell;

}

#pragma mark - TableView Delegate Methods
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

} 
```

这是输出。

![在此处输入图像描述](../Images/e1c6795b774ae7223a1872fa89f941e4.png)

在这种情况下，即使我们上下滚动 tableview，行高也不会改变。

希望这可以帮助。对不起，如果我误解了你的问题。如果您提供代码片段会很好。它会让我们更好地了解这个问题。

**编辑：** 根据我对问题的理解，您正在为每行/单元格获得正确的高度，但是您在单元格中使用了一个图像视图，它将根据单元格的高度显示不同的图像。检查以下是否适合您：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *stringCellIdentifier = @"BookOutVehicleCell";

        UITableViewCell *tableViewCell = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:stringCellIdentifier];

        if (tableViewCell == nil)
            tableViewCell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:stringCellIdentifier] autorelease];

       //Check your height here and use appropriate image 
       if(cell.contentView.frame.size.height <100)
       {
            image = "xxx.png";
       }
       else
       if(cell.contentView.frame.size.height >=100 && cell.contentView.frame.size.height <200)
       {
           image = "yyy.png";
       }

    } 
```

谢谢。

# c++ - boost::program_options 是否支持需要一系列替代方案中的一个？

> ID：15501714
> 
> 赞同：7
> 
> 时间：2013-03-19T14:05:57.837
> 
> 标签：c++, boost, boost-program-options

我正在使用 boost::program_options 为我的 C++ 应用程序指定参数。有没有办法指定一组备选方案中需要一个参数？

```
<application> [--one int-value1 | --two string-value2 | --three] 
```

在上述情况下，用户必须准确地传递以下选项之一：`--one`、`--two`或`--three`。

我可以手动执行此操作，但希望有一个内置机制来代替：

```
#include <boost/program_options.hpp>

namespace po = boost::program_options;

int main(int argc, char *argv[]) {
  po::options_description options;
  int band;
  std::string titles_path;

  options.add_options()
    ("one", po::value<int>(&band)->default_value(1))
    ("two", po::value<std::string>(&titles_path))
    ("three");

  po::variables_map vm;
  po::store(po::parse_command_line(argc, argv, options), vm);

  if (1 != (vm.count("one") + vm.count("two") + vm.count("three"))) {
    std::cerr << options << std::endl;

    return -11;
  }
  return 0;
} 
```

有没有更好的方法来使用增强选项来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T14:28:38.217

program_options 验证器不支持参数相互依赖（包括负依赖）。

也许你现在做的实际上是最好的选择。

# java - Java ScreenManager，setVisible 不工作，bufferstrategy 在全屏时丢失

> ID：15501716
> 
> 赞同：1
> 
> 时间：2013-03-19T14:05:59.460
> 
> 标签：java, swing, jframe, fullscreen

我正在为我的游戏设置屏幕管理器，但它没有按我的意愿工作。我开发了在传递给此屏幕管理器的 JFrame 上在全屏和窗口之间切换的方法，但它给了我不应该存在的错误。为了获得独家全屏，我想通过移除框架上的装饰`setUndecorated`，这需要框架不可见。所以我`setVisible(false)`在任何之前申请，`setUndecorated`但它没有任何效果。当打印输出清楚地显示框架不可见时，SetUndecorated 仍然抱怨可见性。

编辑：在与下面有用的评论者讨论时，我发现我的 bufferstrategys 内容在切换出全屏时完全丢失了，你如何避免这种情况？

```
Called from fullscreen before toggle, visible? false
Called from fullscreen after toogle, visible? false
Called from windowed before toggle, visible? true
Exception in thread "main" java.awt.IllegalComponentStateException: 
The frame is  displayable.
at java.awt.Frame.setUndecorated(Unknown Source)
at gfx.ScreenManager.setWindowed(ScreenManager.java:100)
at gfx.ScreenManager.main(ScreenManager.java:145)
Called from windowed after toggle before decorated, visible? false 
```

我的屏幕管理器的当前迭代：

```
package gfx;

import java.awt.DisplayMode;
import java.awt.Graphics2D;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Toolkit;
import java.awt.Window;
import java.awt.image.BufferStrategy;

import javax.swing.JFrame;

public class ScreenManager {

private JFrame frame;
private GraphicsDevice gd;
private DisplayMode defaultMode;
private DisplayMode[] supportedModes;

// Use with frame from elsewhere
public ScreenManager(JFrame frame) {
    this();
    this.frame = frame;

}

// Used with a frame that is tied to instance
public ScreenManager() {
    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    this.gd = ge.getDefaultScreenDevice();
    this.defaultMode = new DisplayMode(800, 600, 16, 60);
    this.setSupportedModes();
    this.frame = new JFrame();
}

// Get the supported displayrates from current graphicsdevice
private void setSupportedModes() {
    this.supportedModes = gd.getDisplayModes();
}

// Check if the supplied displaymode is supported by current device
public boolean isSupportedDisplayMode(DisplayMode odm) {
    for (DisplayMode dm : this.supportedModes) {
        if (dm.getHeight() == odm.getHeight()
                && dm.getWidth() == odm.getWidth()
                && dm.getBitDepth() == odm.getBitDepth()
                || odm.getBitDepth() == DisplayMode.BIT_DEPTH_MULTI
                && dm.getRefreshRate() == odm.getBitDepth()
                || odm.getRefreshRate() == DisplayMode.REFRESH_RATE_UNKNOWN)
            return true;

    }
    return false;
}

public void setFullScreen(DisplayMode displayMode) {
    this.setFullScreen(displayMode, frame);
}

// Set fullscreen if supported displaymode, else default displaymode
public void setFullScreen(DisplayMode displayMode, JFrame frame) {
    if (gd.isFullScreenSupported()) {
        // Fullscreen on visible frame not allowed
        System.out
                .println("Called from fullscreen before toggle, visible? "
                        + frame.isVisible());
        frame.setVisible(false);
        System.out.println("Called from fullscreen after toogle, visible? "
                + frame.isVisible());
        // Remove decoration and unresiable
        frame.setUndecorated(true);
        frame.setResizable(false);
        frame.setIgnoreRepaint(true);
        // Set frame as fullscreenwindow
        gd.setFullScreenWindow(frame);
        // Set default if requested not supported or null
        if (displayMode == null || !isSupportedDisplayMode(displayMode))
            gd.setDisplayMode(defaultMode);

        else
            gd.setDisplayMode(displayMode);
        // Create bufferstrategy
        frame.createBufferStrategy(2);
    }
}

// Make windowed
public void setWindowed() {
    // Windowed from fullscreen if fullscreen, otherwise we are probably
    // windowed already
    if (gd.getFullScreenWindow() != null) {
        System.out.println("Called from windowed before toggle, visible? "
                + frame.isVisible());
        frame.setVisible(false);
        System.out
                .println("Called from windowed after toggle before decorated, visible? "
                + frame.isVisible());
        frame.setUndecorated(false);
        frame.setVisible(true);
        frame.setIgnoreRepaint(false);
        gd.setFullScreenWindow(null);
        // gd.getFullScreenWindow().dispose(); < Clears frame, you lose all
        // info, da fuck is the point of this except on gamexit from
        // fullscreen?
    }
}

// Get the drawing graphics of this ScreenManagers bufferstrategy
public Graphics2D getGraphics() {
    Window frame = gd.getFullScreenWindow();
    if (frame != null) {
        BufferStrategy bufferStrategy = frame.getBufferStrategy();
        return (Graphics2D) bufferStrategy.getDrawGraphics();
    }

    return null;
}

public void update() {
    Window frame = gd.getFullScreenWindow();
    if (frame != null) {
        BufferStrategy bufferStrategy = frame.getBufferStrategy();
        if (!bufferStrategy.contentsLost()) 
            bufferStrategy.show();
    }

    Toolkit.getDefaultToolkit().sync();
}

// Display in readable format, eg 800x600x32@60
public String displayModeToString(DisplayMode dm) {
    return dm.getWidth() + "x" + dm.getHeight() + "x" + dm.getBitDepth()
            + "@" + dm.getRefreshRate();
}

public static void main(String[] args) throws InterruptedException {
    JFrame frame = new JFrame();
    frame.setSize(800, 600);
    ScreenManager sm = new ScreenManager(frame);
    sm.setFullScreen(new DisplayMode(1680, 1050, 32, 60));
    Thread.sleep(3000);
    sm.setWindowed();

} 
```

有趣的方法是 setWindowed 和 setFullScreen。

编辑：对于下面的评论，这个新的 main 在全屏缓冲区上绘制一个字符串，显示它，然后在退出全屏时它完全消失了，这不需要处理，也不需要担心装饰。考虑到我首先进入全屏模式并且全屏方法创建了一个附加到 JFrame 的缓冲区，所以这很奇怪，因此即使我离开全屏模式，JFrame 现在也附加了一个缓冲区策略。所以缓冲区内容在转换之间由于某种原因丢失了..

```
// Make windowed
public void setWindowed() {
    // Windowed from fullscreen if fullscreen, otherwise we are probably
    // windowed already
    if (gd.getFullScreenWindow() != null) {
        // gd.getFullScreenWindow().dispose();
        gd.setFullScreenWindow(null);
        // frame.setUndecorated(false);
        frame.setVisible(true);
    }
}

public static void main(String[] args) throws InterruptedException {
    JFrame frame = new JFrame();
    frame.setSize(800, 600);
    ScreenManager sm = new ScreenManager(frame);
    sm.setFullScreen(new DisplayMode(1680, 1050, 32, 60));
    Graphics2D g2d = sm.getGraphics();
    g2d.setColor(Color.red);
    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
    Font font = new Font("Serif", Font.PLAIN, 96);
    g2d.setFont(font);
    g2d.drawString("jade", 40, 120);
    g2d.dispose();
    sm.update();
    Thread.sleep(3000);
    sm.setWindowed();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T16:09:45.463

我创建了一些东西，在这个空间中，constalations 可以触发各种异常:-)，很抱歉，setUndecorated(false) 也是如此，但需要停止 ImageGnerator，然后等待所有事件在 EDT 上完成，然后更改装饰类型， .........

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GradientPaint;
import java.awt.Graphics2D;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.ByteArrayOutputStream;
import java.util.Random;
import javax.imageio.ImageIO;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.KeyStroke;
import javax.swing.SwingUtilities;

public class FullScreen {

    private static final long serialVersionUID = 1L;
    private GraphicsDevice device;
    private JButton button = new JButton("Close Meeee");
    private JPanel myPanel = new JPanel();
    private JFrame frame = new JFrame();
    private JLabel imageLabel;
    private Dimension halfScreenSize;
    private Random random;
    private JProgressBar memory;
    private Dimension d;
    private Font bigFont = new Font("Arial", Font.BOLD, 30);
    private int count = 0;
    private int startMem = 0;
    private int maxMem = 0;
    private int peakMem = 0;
    private int useMem = 0;
    private javax.swing.Timer timer = null;

    public FullScreen() {
        startMem = ((int) Runtime.getRuntime().freeMemory());
        maxMem = ((int) Runtime.getRuntime().freeMemory());
        peakMem = ((int) Runtime.getRuntime().freeMemory());
        d = Toolkit.getDefaultToolkit().getScreenSize();
        halfScreenSize = new Dimension(d.width, d.height);
        //halfScreenSize = new Dimension(d.width - 11, d.height - 51);
        random = new Random();
        imageLabel = new JLabel(new ImageIcon(convertToFromBytes(getImage())));
        memory = new JProgressBar(0, (int) Runtime.getRuntime().maxMemory());
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                System.exit(0);
            }
        });
        myPanel.setLayout(new BorderLayout(10, 10));
        myPanel.add(imageLabel, BorderLayout.CENTER);
        myPanel.setFocusable(true);
        myPanel.add(button, BorderLayout.NORTH);
        myPanel.add(memory, BorderLayout.SOUTH);
        frame.add(myPanel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setUndecorated(true);
        frame.getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(
                KeyStroke.getKeyStroke("ENTER"), "clickENTER");
        frame.getRootPane().getActionMap().put("clickENTER", new AbstractAction() {
            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                exitFullScreen();
            }
        });
        enterFullScreen();
        frame.setVisible(true);
        Runnable doRun = new Runnable() {
            @Override
            public void run() {
                System.out.println(frame.getBounds());
            }
        };
        SwingUtilities.invokeLater(doRun);
        Runnable r = new Runnable() {
            @Override
            public void run() {
                while (true) {
                    try {
                        d = Toolkit.getDefaultToolkit().getScreenSize();
                        halfScreenSize = new Dimension(d.width, d.height);
                        imageLabel.setIcon(new ImageIcon(convertToFromBytes(getImage())));
                        memory.setValue((int) Runtime.getRuntime().freeMemory());
                        memory.setStringPainted(true);
                        useMem = ((int) Runtime.getRuntime().freeMemory());
                        Thread.sleep(500);
                    } catch (InterruptedException ex) {
                        //something with exception
                    } finally {
                        //alive that if required
                    }
                }
            }
        };
        Thread t = new Thread(r);
        t.start();
    }

    private void enterFullScreen() {
        GraphicsEnvironment graphicsEnvironment = GraphicsEnvironment.getLocalGraphicsEnvironment();
        device = graphicsEnvironment.getDefaultScreenDevice();
        if (device.isFullScreenSupported()) {
            device.setFullScreenWindow(frame);
            frame.validate();
        }
    }

    private void exitFullScreen() {
        startOne();
    }

    private void startOne() {
        timer = new javax.swing.Timer(70, setFullScreenWindowFalse());
        timer.start();
        timer.setRepeats(false);
    }

    public Action setFullScreenWindowFalse() {
        return new AbstractAction("setFullScreenWindowFalse") {
            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                device.setFullScreenWindow(null);
                startTwo();
            }
        };
    }

    private void startTwo() {
        timer = new javax.swing.Timer(70, hideJFrame());
        timer.start();
        timer.setRepeats(false);
    }

    public Action hideJFrame() {
        return new AbstractAction("hideJFrame") {
            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                frame.setVisible(false);
                startThree();
            }
        };
    }

    private void startThree() {
        timer = new javax.swing.Timer(250, showJFrame());
        timer.start();
        timer.setRepeats(false);
    }

    public Action showJFrame() {
        return new AbstractAction("showJFrame") {
            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                myPanel.setPreferredSize(new Dimension(400, 300));
                frame.pack();
                frame.setVisible(true);
            }
        };
    }

    private BufferedImage getImage() {
        GradientPaint gp = new GradientPaint(0f, 0f, new Color(127 + random.nextInt(128), 127 + random.nextInt(128), 127 + random.nextInt(128)),
                (float) halfScreenSize.width, (float) halfScreenSize.width, new Color(random.nextInt(128), random.nextInt(128), random.nextInt(128)));
        BufferedImage bi = new BufferedImage(halfScreenSize.width, halfScreenSize.height, BufferedImage.TYPE_INT_RGB);
        Graphics2D g2d = bi.createGraphics();
        g2d.setPaint(gp);
        g2d.fillRect(0, 0, halfScreenSize.width, halfScreenSize.height);
        g2d.setFont(bigFont);
        g2d.setColor(Color.BLACK);
        if (maxMem < ((int) Runtime.getRuntime().freeMemory())) {
            maxMem = ((int) Runtime.getRuntime().freeMemory());
        }
        if (peakMem > ((int) Runtime.getRuntime().freeMemory())) {
            peakMem = ((int) Runtime.getRuntime().freeMemory());
        }
        useMem = ((int) Runtime.getRuntime().freeMemory()) - useMem;
        g2d.drawString("" + ++count, 20, 100);
        g2d.drawString("JVM memory status --->  ", 20, 195);
        g2d.drawString("tot. memory --->  " + ((int) Runtime.getRuntime().totalMemory()), 20, 240);
        g2d.drawString("max. memory --->  " + ((int) Runtime.getRuntime().maxMemory()), 20, 270);
        g2d.drawString("free on startUp --->  " + startMem, 20, 300);
        g2d.drawString("max free memory --->  " + maxMem, 20, 350);
        g2d.drawString("min free memory --->  " + peakMem, 20, 380);
        g2d.drawString("act free memory --->  " + ((int) Runtime.getRuntime().freeMemory()), 20, 410);
        g2d.drawString("usage of memory --->  " + useMem, 20, 450);
        return bi;
    }

    private Image convertToFromBytes(BufferedImage image) {
        try {
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            ImageIO.write(image, "png", baos);
            return Toolkit.getDefaultToolkit().createImage(baos.toByteArray());
        } catch (Exception e) {
            return null;
        }
    }

    public static void main(String[] args) {
        Runnable doRun = new Runnable() {
            @Override
            public void run() {
                FullScreen fullScreen = new FullScreen();
            }
        };
        SwingUtilities.invokeLater(doRun);
    }
} 
```

# sql-server - 将数据从一个 SQL Server 表传输到另一个

> ID：15501727
> 
> 赞同：0
> 
> 时间：2013-03-19T14:06:34.897
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, transfer, ssms

例如，我有一个包含表的 SQL Server 数据库

```
Id          Address
1  England,London,someaddress
2  Germany,Berlin,someaddress2 
```

我有另一个 SQL Server 数据库，其中包含下表和方案

```
 Id  Country City Address 
```

我需要将数据从第一个数据库传输到第二个数据库。像这样。

```
id  Country    City    Address
 1  England   London   someaddress
 2  Germany   Berlin   someaddress2 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:12:56.580

您可以通过创建一个`User Define Function`检测`Country`, `City`,`Address`通过拆分然后插入到第二个表中来做到这一点。

拆分功能：

```
CREATE FUNCTION [dbo].[Split](@String varchar(8000), @Delimiter char(1))       
returns @temptable TABLE (id int , items varchar(8000))       
as       
begin       
    declare @idx int
    declare @id int       
    declare @slice varchar(8000)       

    set @id = 1
    select @idx = 1       
        if len(@String)<1 or @String is null  return       

    while @idx!= 0       
    begin       
        set @idx = charindex(@Delimiter,@String)       
        if @idx!=0       
            set @slice = left(@String,@idx - 1)       
        else       
            set @slice = @String       

        if(len(@slice)>0)  
        begin
            insert into @temptable(id, Items) values( @id , @slice)       
            set @id = @id + 1
        end

        set @String = right(@String,len(@String) - @idx)       
        if len(@String) = 0 break       
    end   
return       
end 
```

然后像这样在插入查询中使用：

```
INSERT INTO NewTbl
SELECT .... , 
     (SELECT ITEMS FROM dbo.Split(Address) where id = 1) as Country,
     (SELECT ITEMS FROM dbo.Split(Address) where id = 2) as City,
     (SELECT ITEMS FROM dbo.Split(Address) where id = 3) as Address,
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T15:54:24.397

有几种方法可以实际移动数据。

1.) 链接服务器[http://msdn.microsoft.com/en-us/library/ms188279.aspx](http://msdn.microsoft.com/en-us/library/ms188279.aspx)

2.) OpenRowSet [http://msdn.microsoft.com/en-us/library/ms190312.aspx](http://msdn.microsoft.com/en-us/library/ms190312.aspx)

3.) 复制[http://msdn.microsoft.com/en-us/library/ms151198.aspx](http://msdn.microsoft.com/en-us/library/ms151198.aspx)

根据您的需要，您需要选择最适合您的一种。

如果您希望您的第二个数据库中的数据可以在您的原始数据库中访问，就像它自己的数据一样，对于查询、存储过程......等等，请查看链接服务器。

如果您想要一次性访问数据，请查看 OpenRowSet。

如果您在两个数据库上都有相同的表并希望自动保持该数据同步，我会查看 Replication。您可以设置自己的复制存储过程来执行自定义逻辑，例如拆分。

然后，您可以按照其他答案中的说明实施拆分以拆分数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T19:49:31.050

如果要将数据从一台服务器复制到另一台数据库服务器，则必须在它们之间建立链接服务器。

并像下面的查询一样执行。

```
insert into [127.234.11.50].[cgwssitws].dbo.tbl_ws_hotelier(paramid,hotelid,paramname,paramvalue)
select paramid,hotelid,paramname,paramvalue from [126.32.22.30].[CGWS_Hotel].dbo.tbl_param where hotelid='22' 
```

# asp.net - 用户无法访问我的网站

> ID：15501729
> 
> 赞同：0
> 
> 时间：2013-03-19T14:06:36.340
> 
> 标签：asp.net, iis-7

我有一个在公司网络中创建的新网站。我所有的用户都在同一个 AD 域 (WINNTDOM) 和同一个 LAN 中。我是服务器（MTVFA-FINANCE MS Server 2008 IIS 7.0）的管理员，我使用 VS2010 web deploy 部署了网站。从我的客户那里，我可以毫无问题地访问网站（http://mtvfac-finance/Timesheets），一切正常。我的 web.config 允许所有非匿名用户。站点的 IIS 设置为允许 Windows 身份验证（仅）。我所有的用户都是 AD 用户。

当我的用户尝试访问同一个链接时，他们都会收到 HTTP:400 错误。我在哪里寻找问题？有没有可以给我更多信息的日志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T15:38:51.190

我的客户的技术支持小组对此做了一些工作，发现：

> 当我尝试使用 IE 使用我的常规用户帐户时，我收到了 HTTP 400 错误。如果我尝试使用 IE 使用我的域管理员帐户，它会起作用——我得到了你的“你没有被授权……”rejected.aspx 页面出现。有趣的是，Firefox 没有问题……如果我在 url 中使用 IP 地址而不是主机名“xxxxxx-yyyyyyy”，IE 似乎也没有。所以起初我认为这与主机名中的“-”有关。但在研究 HTTP 400 错误时，它表明用户在使用 Windows 身份验证时属于太多组。解决此问题的建议解决方案是增加服务器注册表中两个 HTTP 设置的值。我这样做了，重新启动了 HTTP，现在我之前因 HTTP 400 错误而失败的帐户现在从您的拒绝中收到相同的“您未获得授权……”消息。
> 因此，并不是您的管理员帐户和我的帐户都在工作……只是这两个帐户不是太多组的成员，而您的测试用户显然是，而我的常规帐户也是如此。所以不是您的管理员帐户和我的帐户都在工作……只是这两个帐户不是太多组的成员，而您的测试用户显然是，而我的常规帐户也是。

似乎奏效了......

# postgresql - 如何在 PostgreSQL 中将日期转换为日期时间？

> ID：15501734
> 
> 赞同：7
> 
> 时间：2013-03-19T14:06:46.153
> 
> 标签：postgresql

我正在尝试在 PostgreSQL 中进行以下工作：

```
SELECT * FROM purchases WHERE CONVERT(expiration_date) < '2013-03-21 13:14:00' 
```

在哪里`CONVERT`可以转换`Date`为`DateTime`. 知道怎么做吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-19T14:11:19.077

`DateTime`PostgreSQL中没有类型，只有`timestamp`.

简单地转换，`expiration_date::timestamp`但我认为它应该在没有转换的情况下工作。`WHERE expiration_date < '2013-03-21 13:14:00'`应该是有效的。

# jenkins - 基于构建输出和电子邮件失败日志部分的 Jenkins 构建失败

> ID：15501735
> 
> 赞同：1
> 
> 时间：2013-03-19T14:06:54.307
> 
> 标签：jenkins, continuous-integration, jenkins-plugins, email-ext

对于我正在构建的 mac 项目，我想通过分析控制台日志的结果来使构建失败。它构建每个模块并给出如下结果：

```
###################################
XX XXX XXX
########################## 
```

然后它返回`BUILD FAILED`

我想在控制台输出结束时显示构建失败，同时我想知道哪个模块失败了。它应该通过电子邮件发送，因为我已经在使用该`email-ext`插件。

我不确定需要做什么；我知道`text-finder`，日志解析器和设置运行条件 - 但不知道要遵循哪些步骤。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T16:50:27.077

您需要同时使用[text-finder 插件](https://wiki.jenkins-ci.org/display/JENKINS/Text-finder+Plugin)和 email-ext 插件才能实现这两个目标。

首先设置 text-finder 插件并提供适当的正则表达式。像：`.*(?i)failed.*|.*(?i)error.*`会以不区分大小写的方式找到“失败”或“错误”这些词。您需要指定日志文件的路径，并且可能需要选中“也搜索控制台输出”复选框。

这将导致任何输出“失败”或“错误”的构建在 Jenkins 中失败。

您向失败的模块发送电子邮件的要求有点复杂，但可以使用 email-ext 插件。此插件允许您指定一个正则表达式，用于使用接受参数的特殊令牌收集电子邮件内容。完整的参数列表和令牌名称是：`${BUILD_LOG_REGEX, regex, linesBefore, linesAfter, maxMatches, showTruncatedLines, substText, escapeHtml, matchedLineHtmlStyle}`

这些参数中的大多数都是可选的，这样的事情应该可以为您解决问题：`${BUILD_LOG_REGEX, regex=".*(?i)failed.*|.*(?i)error.*", linesBefore=10, linesAfter=10}`. 把它放在 email-ext 配置的“默认内容”部分。您也可以指定多个令牌，有关获取完整列表的说明，请参阅此答案：[Jenkins Email-ext plugin - tokens](https://stackoverflow.com/questions/10832486/jenkins-email-ext-plugin-tokens)

您当然可以编辑 LinesBefore 和 LinesAfter 参数以满足您的需要。

# java - 对包含对象数组的地图进行排序

> ID：15501744
> 
> 赞同：1
> 
> 时间：2013-03-19T14:07:15.537
> 
> 标签：java

如果我制作这样的地图：

```
Map<Object, ArrayList<Object>> multiMap = new HashMap<Object, ArrayList<Object>>(); 
```

有没有办法让我对`ArrayList<Object>?`

我正在考虑像这样循环遍历多图：

```
for (Entry<Object, ArrayList<Object>> entry : multiMap.entrySet()) {
    for (int i = 0; i < entry.size(); i++) {
           //retrieve all array items and place in new array to sort
    } 
```

所以我们有对象--->arrayList（包含2个元素）对象--->arrayList（包含2个元素）对象--->arrayList（包含2个元素）对象--->arrayList（包含2个元素）

我想获取上面所有 arrayLists 中的所有元素并按这些元素排序。它不需要留在多地图中..我只是想看看是否有更好的方法来做到这一点..

**编辑：** 这里的重点是将每个arrayList中的所有数组元素与每个其他arrayList中的所有其他数组元素进行排序......所以它不像调用排序那么简单，但我想知道是否有更好/更清洁的这样做的方式？我对地图不是很熟悉...任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:27:14.897

根据您的编辑，您似乎想要获取地图中的所有对象并对它们进行排序。没有直接的方法将映射中的值排序在一起，因此要对所有项目进行排序，最简单的方法是将它们合并到一个列表中，然后 Collections.sort() 整个事情。

```
public ArrayList<Object> sortAllValues() {
    ArrayList<Object> allEntries = new ArrayList<Object>();
    for (Entry<Object, ArrayList<Object>> entry : multiMap.entrySet())
        allEntries.addAll(entry.getValue());
    }
return Collections.sort(allEntries);
} 
```

如果没有它，您仍然需要实现与您的 Object 的 Comparable。这是关于如何实现[Comparable的一个很好的指南](http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:11:28.573

实际上，您不应该关心 ArrayList 是 Map 中的值，这无关紧要。您将按照`ArrayList<Object>`对任何此类列表进行排序的方式对其进行排序。这里的问题是您必须实现某种将 Object 转换为所需类型的 Comparator。一般来说，我个人会制作比 Object 更具体类型的 ArrayList 以使排序更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:13:16.100

查看 Apache Commons 和 Google Collections 的 MultiMap 实现。他们可能有一个已经支持排序/排序的。

# sql - SQL子查询的多个返回值

> ID：15501748
> 
> 赞同：0
> 
> 时间：2013-03-19T14:07:21.573
> 
> 标签：sql, postgresql, subquery

我使用的是 PostgreSQL 9.1，我编写了以下 SQL 语句：

```
INSERT INTO "Tracking" VALUES 
((SELECT "studentID" FROM "Student" WHERE "studentClass"='2'),false,4,false); 
```

问题是子查询：

```
SELECT "studentID" FROM "Student" WHERE "studentClass"='2' 
```

返回了多个值，并且应该这样做（我想根据子查询的每个返回值执行主查询），但是这样查询将不会被执行。任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:08:28.190

试试这个：

```
INSERT INTO "Tracking" 
SELECT "studentID",false,4,false
FROM "Student" WHERE "studentClass"='2' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:08:38.057

然后使用`INSERT INTO... SELECT`语句

```
INSERT INTO "Tracking" 
SELECT "studentID" , false , 4 , false
FROM   "Student" 
WHERE  "studentClass" = '2' 
```

确保该语句的一件事是确保该表`Tracking`仅包含 4 列，否则您将获得与提供的值不匹配的列数。`INSERT`例如，如果您有 4 个以上的列，请在要保存这些值的子句上定义列名。

# javascript - Nightly (22) 和 Chrome (25) 中的 WebRTC 问题

> ID：15501753
> 
> 赞同：0
> 
> 时间：2013-03-19T14:07:41.970
> 
> 标签：javascript, html, webrtc

我正在使用 RTCPeerConnection 和我自己的长轮询实现在两个浏览器之间试验 WebRTC。我已经创建了演示应用程序，它成功地与 Mozilla Nightly (22) 一起使用，但是在 Chrome (25) 中，我无法获得远程视频，并且只出现“空黑色视频”。我的 JS 代码有问题吗？

函数*sendMessage(message)*通过长轮询向服务器发送消息，另一方面，使用*onMessage()接受*

```
var peerConnection;
var peerConnection_config = {"iceServers": [{"url": "stun:23.21.150.121"}]};

// when message from server is received
function onMessage(evt) {

    if (!peerConnection)
        call(false);

    var signal = JSON.parse(evt);
    if (signal.sdp) {
        peerConnection.setRemoteDescription(new RTCSessionDescription(signal.sdp));
    } else {
        peerConnection.addIceCandidate(new RTCIceCandidate(signal.candidate));
    }
}

function call(isCaller) {

    peerConnection = new RTCPeerConnection(peerConnection_config);

    // send any ice candidates to the other peer
    peerConnection.onicecandidate = function(evt) {
        sendMessage(JSON.stringify({"candidate": evt.candidate}));
    };

    // once remote stream arrives, show it in the remote video element
    peerConnection.onaddstream = function(evt) {
        // attach media stream to local video - WebRTC Wrapper
        attachMediaStream($("#remote-video").get("0"), evt.stream);
    };

    // get the local stream, show it in the local video element and send it
    getUserMedia({"audio": true, "video": true}, function(stream) {
        // attach media stream to local video - WebRTC Wrapper
        attachMediaStream($("#local-video").get("0"), stream);
        $("#local-video").get(0).muted = true;
        peerConnection.addStream(stream);

        if (isCaller)
            peerConnection.createOffer(gotDescription);
        else {
            peerConnection.createAnswer(gotDescription);
        }

        function gotDescription(desc) {
            sendMessage(JSON.stringify({"sdp": desc}));
            peerConnection.setLocalDescription(desc);

        }
    }, function() {
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-30T14:18:15.277

确保您的视频标签属性自动播放设置为“自动播放”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:03:23.833

我最好的猜测是你的 STUN 服务器配置有问题。要确定这是否是问题所在，请尝试使用 google 的公共 stun 服务器`stun:stun.l.google.com:19302`（在 Firefox 中无法使用，但在 Chrome 中肯定可以使用）或在未配置 STUN 服务器的本地网络上进行测试。

此外，请验证您的候选冰是否正确交付。Firefox 实际上并没有生成“icecandidate”事件（它包括报价/答案中的候选人），因此传递候选人消息的问题也可以解释这种差异。

# oracle11g - TNSPING 消息 3511 错误的有趣变化

> ID：15501755
> 
> 赞同：4
> 
> 时间：2013-03-19T14:07:47.260
> 
> 标签：oracle11g

Oracle 11g TNSPING 实用程序存在以下问题：全新的 11g 客户端安装，ORACLE_HOME 设置正确，TNS_ADMIN 也设置，msb 文件在所需位置可用，调用 TNSPING 的用户可以读取。连接数据库工作正常，可以使用sqlplus进行连接。然而，TNSPING 失败了。见附件日志：

```
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\USERNAME>set ORACLE_HOME=C:\Work\Software\Oracle\product\11.2.0\client_1

C:\Users\USERNAME>set TNS_ADMIN=%ORACLE_HOME%\network\admin

C:\Users\USERNAME>set NLS_LANG=ENGLISH_POLAND.EE8MSWIN1250

C:\Users\USERNAME>dir %TNS_ADMIN%\tnsnames.ora
 Volume in drive C is XXX
 Volume Serial Number is YYY

 Directory of C:\Work\Software\Oracle\product\11.2.0\client_1\network\admin

2013-03-19  12:26               358 tnsnames.ora
               1 File(s)            358 bytes
               0 Dir(s)  59 082 616 832 bytes free

C:\Users\USERNAME>dir %ORACLE_HOME%\network\mesg\tns*.msb
 Volume in drive C is XXX
 Volume Serial Number is YYY

 Directory of C:\Work\Software\Oracle\product\11.2.0\client_1\network\mesg

2010-03-31  07:01            53 248 tnspl.msb
2010-03-31  07:01            47 104 tnsus.msb
               2 File(s)        100 352 bytes
               0 Dir(s)  59 082 616 832 bytes free

C:\Users\USERNAME>sqlplus <USER>/<PASSWORD>@<DATABASE>

SQL*Plus: Release 11.2.0.1.0 Production on Tue Mar 19 14:36:34 2013

Copyright (c) 1982, 2010, Oracle.  All rights reserved.

Connected to:
Oracle Database 11g Release 11.2.0.2.0 - 64bit Production

SQL> exit
Disconnected from Oracle Database 11g Release 11.2.0.2.0 - 64bit Production

C:\Users\USERNAME>tnsping <DATABASE>

TNS Ping Utility for 32-bit Windows: Version 11.2.0.1.0 - Production on 19-MAR-2013 14:37:52

Copyright (c) 1997, 2010, Oracle.  All rights reserved.

Message 3511 not found; No message file for product=NETWORK, facility=TNSMessage 3512 not found; No message file for product=NETWORK, facility=TNSMessage 3513 not found; No message file for product=NETWORK, facility=TNSMessage 3509 not found; No message file for product=NETWORK, facility=TNS 
```

请注意：出于安全考虑，我不得不替换所有用户凭据、数据库名称等。

你能帮我解决问题吗？我已经阅读了与 TNSPING 故障相关的所有其他 StackExchange 主题，但是每个解决方案（设置 ORACLE_HOME、重新安装、确保注册表指向正确的主目录、检查 msb 文件）都让我失望了……

提前致谢！

# browser - 强制 URL 将 4 部分 unicode 字符串转换为中文字符

> ID：15501757
> 
> 赞同：0
> 
> 时间：2013-03-19T14:08:02.860
> 
> 标签：browser, unicode, character-encoding, cjk

我的 URL（我`twitter/share`在查询字符串中传递给它）包含`%C2%BC%C3%BE`, 的编码，但浏览器将其解码为两个字符 ¼þ。如何让浏览器知道它应该将其解码为单个字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:33:03.963

您的编码错误。浏览器将其正确解码为这两个字符。U+4EF6 的正确 UTF-8 字节是 E4、BB 和 B6。

# php - ZFTool 生成错误的类文件路径

> ID：15501759
> 
> 赞同：0
> 
> 时间：2013-03-19T14:08:06.827
> 
> 标签：php, code-generation, zend-framework2

我安装了 ZFTool（`/usr/bin/zf2`参考资料`/lib/ZendFramework/ZFTool/zf.php`）

```
user@machine:/var/www/.../projectroot/module/Catalo# zf2 version
ZFTool - Zend Framework 2 command line Tool ver. 0.1
The ZFTool is using Zend Framework 2.1.3 
```

它工作正常。但是当我尝试生成类图时

```
user@machine:/var/www/.../projectroot/module/Catalo# zf2 classmap generate . -w 
```

它创建了一个路径错误的类图：

```
<?php
// Generated by Zend Framework 2
return array(
    'Catalog\Module'                       => __DIR__ . '/../../../../../../.././Module.php',
    'Catalog\Controller\CatalogController' => __DIR__ . '/../../../../../../.././src/Catalog/Controller/CatalogController.php',
); 
```

为什么？如何修复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:55:05.837

这确实是 ZFTool 中的一个错误。我部署了一个修复程序，您可以在[https://github.com/zendframework/ZFTool/pull/28](https://github.com/zendframework/ZFTool/pull/28)看到它。

基本上，ZFTool 无法比较要爬取的目录和目标类映射文件目录。事实证明，这会产生您所体验的精美输出。

***编辑***：合并 - 修复已经在 ZFTool

# c# - 可以将此方法设为静态吗？

> ID：15501764
> 
> 赞同：0
> 
> 时间：2013-03-19T14:08:17.210
> 
> 标签：c#, asp.net, system.drawing

我可以在 asp.net 页面（请求排队和线程安全）中使此方法静态且没有问题吗？

```
public Image MakeImage()
{
    Image objImage = new Bitmap(100, 100);

    Bitmap bitmapimage = new Bitmap(objImage, 100, 100);
    Graphics g = Graphics.FromImage(bitmapimage);
    g.DrawImage(new Bitmap(50, 50), new PointF(1, 1));

    return bitmapimage;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:09:08.583

是的，只需将其标记为：

```
public static Image MakeImage() {
  ... 
```

如果它使用一些页面属性，一些实例成员，那么不，但它是自包含的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T14:09:37.633

答案是肯定的，这没有问题。方法内部的变量都是局部的，所以没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:10:20.963

是的，任何在其定义的类上不使用任何其他实例成员的类成员都可以设为静态。

# .net - .NET 中的数组是否自然对齐？

> ID：15501766
> 
> 赞同：6
> 
> 时间：2013-03-19T14:08:25.260
> 
> 标签：.net, clr

.NET 是否保证 .NET 字节数组始终正确对齐？我确实需要这个来将不安全上下文中的字节数组视为 x64 中的 long 来修改具有本机寄存器大小的数据块。

但到目前为止，我还没有找到任何 CLR 确实可以保证我的内存访问正确对齐的文档。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T14:42:10.483

不会。事实上，阵列可能会因 x86 抖动而错位。特别是 double[] 和 long[] 的问题，垃圾收集器只提供保证它们将在 4 对齐。这就解释了 double[] 的特殊规则，这样的数组将在大对象堆中分配有 1000 个或更多元素。大大少于 LOH 分配的正常规则，85000 或更多字节。LOH 取决于 Windows 堆对齐保证，对齐为 8。否则这在 x64 抖动中不是问题。

对您的问题更具体一点：字节数组永远不会成为问题。无论数组从哪里开始，一个字节总是对齐的。使用 Microsoft 编译器编译的非托管代码中的“long”也不是问题，它是 4 个字节，因此总是与默认的 GC 对齐规则对齐。在 x64 模式下它仍然是 4 个字节，所以也没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-06T15:31:10.513

在 .NET 中，对象（数组是一种）总是根据指针大小对齐（例如 4 字节或 8 字节对齐）。因此，对象指针和对象数组在 .NET 中总是对齐的。

我还应该指出，取消引用 .NET 中的指针不需要对齐。但是，它会更慢。例如，如果您有一个有效的 byte* 指针并且指向长度至少为 8 个字节的数据，您可以将其转换为 long* 并获取值：

```
unsafe
{
    var data = new byte[ 16 ];
    fixed ( byte* dataP = data )
    {
        var misalignedlongP = ( long* ) ( dataP + 3 );
        long value = *misalignedlongP;
    }
} 
```

阅读 .NET 的源代码，您可以看到 Microsoft 有时会考虑对齐，而通常不会。一个示例是内部`System.Buffer.Memmove`方法（请参阅[https://referencesource.microsoft.com/#mscorlib/system/buffer.cs,c2ca91c0d34a8f86](https://referencesource.microsoft.com/#mscorlib/system/buffer.cs,c2ca91c0d34a8f86)）。该方法具有将 byte* 转换为 long 的代码路径，而在某些地方没有任何对齐检查，并且调用方法也不检查对齐方式。

# java - 如何从动态报告中删除动态报告徽标

> ID：15501767
> 
> 赞同：-2
> 
> 时间：2013-03-19T14:08:25.670
> 
> 标签：java, jasper-reports, dynamic-reports

生成的报告看起来像 - [http://www.dynamicreports.org/examples/examples-overview#miscellaneous](http://www.dynamicreports.org/examples/examples-overview#miscellaneous)

报告很好，但它会生成我不想要的动态报告徽标，我在谷歌上搜索但找不到任何东西。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T12:53:32.183

查看您的代码，看看是否可以找到“images/dynamicreports.png”。

它应该在一段看起来像..的代码中

```
 cmp.image(TestReport.class.getResourceAsStream("images/dynamicreports.png"))
     .setFixedDimension(80,80) 
```

基本上你可以从那里更改图像 URL。请务必查看入门指南。您应该在“步骤 9：标题”部分看到与此相关的内容。

[http://www.dynamicreports.org/getting-started](http://www.dynamicreports.org/getting-started)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T11:23:59.837

```
/**
 * DynamicReports - Free Java reporting library for creating reports dynamically
 *
 * Copyright (C) 2010 - 2013 Ricardo Mariaca
 * http://www.dynamicreports.org
 *
 * This file is part of DynamicReports.
 *
 * DynamicReports is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * DynamicReports is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with DynamicReports. If not, see <http://www.gnu.org/licenses/>.
 */

package net.sf.dynamicreports.examples.chart;

import static net.sf.dynamicreports.report.builder.DynamicReports.cht;
import static net.sf.dynamicreports.report.builder.DynamicReports.col;
import static net.sf.dynamicreports.report.builder.DynamicReports.report;
import static net.sf.dynamicreports.report.builder.DynamicReports.stl;
import static net.sf.dynamicreports.report.builder.DynamicReports.type;

import java.math.BigDecimal;
import java.util.Calendar;
import java.util.Date;

import net.sf.dynamicreports.report.builder.column.TextColumnBuilder;
import net.sf.dynamicreports.report.builder.style.FontBuilder;
import net.sf.dynamicreports.report.constant.TimePeriod;
import net.sf.dynamicreports.report.datasource.DRDataSource;
import net.sf.dynamicreports.report.exception.DRException;
import net.sf.jasperreports.engine.JRDataSource;

/**
 * @author Ricardo Mariaca (r.mariaca@dynamicreports.org)
 */
public class TimeSeriesChartReport {

    public TimeSeriesChartReport() {
        build();
    }

private void build() {
        FontBuilder boldFont = stl.fontArialBold().setFontSize(12);

        TextColumnBuilder<Date> orderDateColumn = col.column("Order date", "orderdate", type.dateYearToMonthType());
        TextColumnBuilder<Integer> quantityColumn = col.column("Quantity", "quantity", type.integerType());
        TextColumnBuilder<BigDecimal> priceColumn = col.column("Price", "price", type.bigDecimalType());

        try {
    report()
                .columns(orderDateColumn, quantityColumn, priceColumn)
                .summary(
                    cht.timeSeriesChart()
                        .setTitle("Time series chart")
                        .setTitleFont(boldFont)
                        .setTimePeriod(orderDateColumn)
                        .setTimePeriodType(TimePeriod.MONTH)
                        .series(
                            cht.serie(quantityColumn), cht.serie(priceColumn))
                        .setTimeAxisFormat(
                            cht.axisFormat().setLabel("Date")))
                .setDataSource(createDataSource())
                .show();
        } catch (DRException e) {
            e.printStackTrace();
        }
    }

    private JRDataSource createDataSource() {
        DRDataSource dataSource = new DRDataSource("orderdate", "quantity", "price");
        dataSource.add(toDate(2010, 1), 50, new BigDecimal(200));
        dataSource.add(toDate(2010, 2), 110, new BigDecimal(450));
        dataSource.add(toDate(2010, 3), 70, new BigDecimal(280));
        dataSource.add(toDate(2010, 4), 250, new BigDecimal(620));
        dataSource.add(toDate(2010, 5), 100, new BigDecimal(400));
        dataSource.add(toDate(2010, 6), 80, new BigDecimal(320));
        dataSource.add(toDate(2010, 7), 180, new BigDecimal(490));
        return dataSource;
    }

    private Date toDate(int year, int month) {
        Calendar c = Calendar.getInstance();
        c.clear();
        c.set(Calendar.YEAR, year);
        c.set(Calendar.MONTH, month - 1);
        return c.getTime();
    }

    public static void main(String[] args) {
        new TimeSeriesChartReport();
    }
}
I am running this code still i am unable to  remove the image logo 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T09:24:44.113

在 net.sf.dynamicreports.examples 包里面访问 Templates.java 文件。在那里你会发现这些代码行： -

```
dynamicReportsComponent =
      cmp.horizontalList(
        cmp.image(Templates.class.getResource("images/dynamicreports.png")).setFixedDimension(60, 60),
        cmp.verticalList(
            cmp.text("DynamicReports").setStyle(bold22CenteredStyle).setHorizontalAlignment(HorizontalAlignment.LEFT),
            cmp.text("http://www.dynamicreports.org").setStyle(italicStyle).setHyperLink(link))).setFixedWidth(300); 
```

删除 cmp.image() & cmp.text() 元素。它将停止显示图像和动态生成器的标题。

# scrollbar - 使用垂直分隔符在窗口中集中 QTableView

> ID：15501768
> 
> 赞同：1
> 
> 时间：2013-03-19T14:08:26.847
> 
> 标签：scrollbar, qtableview, qscrollarea, qsizepolicy

我正在尝试创建一个包含 QTableView 的主窗口（固定大小），上面和下面都有 QSpacerItems，以便（垂直）集中表格。

（抱歉，显然无法发布图片）。

我有一个 QVBoxLayout，其中有一个垂直垫片、QTableView 和另一个垂直垫片。我已经为所有三个小部件使用了 QSizePolicy 的所有组合，但我无法在没有滚动条的情况下显示表格。（我不能使用 Qt.ScrollBarAlwaysOff ，因为如果项目数超过主窗口的大小，则需要它们）。因此，QTableView 上的垂直滚动条会显示出来，即使垂直间隔在视图和主窗口之间吸收了大量空间。

我希望垂直垫片占据表格小部件上方和下方所需的最小空间，以便集中行，并且表格小部件可以显示尽可能多的行，而无需滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T02:55:51.617

您可以继承 QTableView，在垂直方向使用 QSizePolicy::Fixed 并覆盖 sizeHint() 以返回您喜欢的垂直高度。

这是一个工作示例（您没有指定语言，所以我假设它是 Python :-)：

```
import sys
from PySide import QtCore, QtGui

class MyTableView(QtGui.QTableView):
    def __init__(self, parent=None):
        super().__init__(parent)
        #assume expanding in horizontal direction and fixed in vertica direction
        self.setSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Fixed)

    def sizeHint(self):
        return QtCore.QSize(400, 500) #I allow you to edit that!

class MyApplication(QtGui.QWidget):
    def __init__(self, parent=None):
        super().__init__(parent)
        layout = QtGui.QVBoxLayout()
        table_view = MyTableView()
        layout.addWidget(table_view)
        self.model = QtGui.QStringListModel() #use a string list model for simplicity
        table_view.setModel(self.model)
        self.strings = ['1', '2', '3']
        self.model.setStringList(self.strings) #initialize the model
        self.counter = 4
        button = QtGui.QPushButton('Add Cell') #this button updates the model and adds cells
        button.clicked.connect(self.addCell)
        layout.addWidget(button)
        self.setLayout(layout)

    def addCell(self):
        self.strings.append(str(self.counter))
        self.counter += 1
        self.model.setStringList(self.strings)

app = QtGui.QApplication(sys.argv)
main = MyApplication()
main.show()
sys.exit(app.exec_()) 
```

# php - 在路由上定义多个可选参数

> ID：15501769
> 
> 赞同：0
> 
> 时间：2013-03-19T14:08:27.423
> 
> 标签：php, routing

目前我在我的项目中使用 AltoRouter，我需要一个可以匹配不同可选参数和**random order**的路由。我重写了 AltoRouter 类以使用 XML + 添加的功能来重用参数，例如：

```
<parameter name="page" match="[i:page]"/>

<route match="/blog" ...>
    <use param="page"/>
</route> 
```

这将匹配`/blog`和`/blog/2`。

现在我需要一个`/blog/[i:page]/[desc|asc:order]/[new|popular:sort]` 可以匹配 URI 之类的路由`/blog/2/new`or `/blog/desc/2`，或者只是`/blog/2 , /blog/new`.

是否可以为此类 URI 定义单个路由（即使使用不同的路由器，如 Symfony）？如果不是，应该如何设置多个规则来匹配这样的 URI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T16:36:30.593

找到了解决方案：所有可选参数都应该传递给Controller的action。这样的路由可以像这样使用 AltoRouter 定义：`/blog/[**:params]`。该路由将匹配 /blog/ 和 URL 的其余部分作为*$params*。例如 URL 是 /blog/2/desc/new，Controller 的操作将得到 '2/desc/new' 作为 $params，这些可以用 explode('/', $params) 解析并根据需要进行处理

# jenkins - ant/Jenkins：move 不支持“quiet”属性

> ID：15501777
> 
> 赞同：0
> 
> 时间：2013-03-13T18:56:18.547
> 
> 标签：jenkins, ant

我的构建脚本执行：

```
<move todir="gen" overwrite="true" quiet="true">
    <fileset dir="gen">
        <include name="**/BuildConfig.java.new"/>
    </fileset>
    <globmapper from="*.java.new" to="*.java"/>
</move> 
```

我得到错误：

```
move doesn't support the "quiet" attribute 
```

我的 iMac 上安装了 ant 1.8.4。我在 Jenkins 中的 ant 插件是 1.2。詹金斯版 1.505。我在启动 Jenkins 时尝试更改 PATH，因此它包括我的命令行 ant。但是 Jenkins 似乎不支持 ant 1.8.3？ant 1.8.3 是添加了“move quiet”的版本。

有什么想法可以解决这个问题吗？它与命令行 ant 或插件 ant 或我的构建脚本有关吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:15:05.487

我认为您想使用 verbose="false" 而不是“安静”。

请参阅[移动 Ant 任务](http://ant.apache.org/manual/Tasks/move.html)。

# sql - SQLITE 批量更新语句

> ID：15501779
> 
> 赞同：9
> 
> 时间：2013-03-19T14:08:57.553
> 
> 标签：sql, sqlite

我想执行许多这样的 SQL UPDATE 语句：

```
UPDATE cityd SET time_zone='-7.000000' WHERE locId = 173567;
UPDATE cityd SET time_zone='-8.000000' WHERE locId = 173568;
UPDATE cityd SET time_zone='-6.000000' WHERE locId = 173569;
UPDATE cityd SET time_zone='-5.000000' WHERE locId = 173570;
UPDATE cityd SET time_zone='-6.000000' WHERE locId = 173571; 
```

我想优化事务时间，所以我需要使用 BEGIN TRANSACTION/COMMIT 对。如何在 SQLtite 管理器的 SQL 语法中编写这个？

编辑：当我在 SQLite Manager 中使用标准语法时，我收到此错误消息：“SQLiteManager: BEGIN TRANSACTION; [无法在事务中启动事务”

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-19T14:25:05.220

根据[SQL Documention](http://www.sqlite.org/lang_expr.html)，有两种支持的语法`CASE`

```
CASE x WHEN w1 THEN r1 WHEN w2 THEN r2 ELSE r3 END

CASE WHEN x = w1 THEN r1 WHEN x = w2 THEN r2 ELSE r3 END 
```

所以你的多个`UPDATE`语句可以进一步简化为

```
UPDATE  cityd
SET     time_zone = CASE locId
                        WHEN 173567 THEN '-7.000000'
                        WHEN 173568 THEN '-8.000000'
                        WHEN 173569 THEN '-6.000000'
                        WHEN 173570 THEN '-5.000000'
                        WHEN 173571 THEN '-6.000000'
                    END
WHERE   locId IN (173567, 173568, 173569, 173570, 173571) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:14:16.647

```
BEGIN TRANSACTION;
.....YOUR SQL Statements here

COMMIT; 
```

# jquery - JQuery Datepicker：如何在 3 个字段中分解日期？

> ID：15501784
> 
> 赞同：0
> 
> 时间：2013-03-19T14:09:09.467
> 
> 标签：jquery, datepicker

我在表单中使用 jQuery Datepicker。问题是我需要将值作为 3 个不同的字段（例如：?day=19&month=3&year=2013）而不是作为唯一日期传递。有人知道我该怎么做吗？

另外，您知道设置日历尺寸的热点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:34:50.040

你可以使用日期选择器的事件

```
onClose: function(dateText, inst) { 
        month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
        year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
    } 
```

或者您可以使用默认日期格式的“-”来分解 dateText

# apache - 如何使访问点将所有请求重定向到一个页面？

> ID：15501785
> 
> 赞同：0
> 
> 时间：2013-03-19T14:09:17.550
> 
> 标签：apache, redirect, webserver, raspberry-pi

我的想法是我基本上想买一个 Raspberry-Pi，在上面放一个网络服务器（Pi-Point 或 apache 或 cherokee，我真的不知道什么是最好的）并让人们连接到它，但将他们重定向到无论他们的要求是什么。

或多或少像（至少在意大利）酒店的 WIFI：您可以自由连接，但无论您在酒吧输入什么地址，您都会被重定向到登录页面。

有没有人类的方法可以做到这一点？如果是这样，什么 Web 服务器是最好的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T12:05:53.560

您可以搜索有关如何在 GNU/Linux 上构建[强制门户的信息](http://en.wikipedia.org/wiki/Captive_portal)

例如：[http ://www.andybev.com/index.php/Setting_up_a_captive_portal_from_scratch_using_Debian](http://www.andybev.com/index.php/Setting_up_a_captive_portal_from_scratch_using_Debian)

# knockout.js - 淘汰赛js foreach不适用于子集合

> ID：15501788
> 
> 赞同：0
> 
> 时间：2013-03-19T14:09:22.670
> 
> 标签：knockout.js

我有一个模型，我从 json 数据映射，该数据基本上包含一个类别列表，并且在每个类别中，是一个控件列表......所以，在我的 UI 中，我有一个包含类别列表的面板，当用户单击它，我将整个类别推送到（在加载时）空的可观察对象以在另一个面板中呈现...单击功能似乎正在工作，但使用 foreach 语句在我的第二列中没有呈现任何内容。任何帮助，将不胜感激。我的 json 数据有点长，所以最好在这里参考我的小提琴：

[http://jsfiddle.net/TU3ps/4/](http://jsfiddle.net/TU3ps/4/)

但这是我试图教育孩子的方式，我的语法在这里不好吗？

```
 <div class="left">Click any of the below categories to see its controls...
            <ul data-bind="foreach:  Categories">
                <li data-bind="click:  $parent.catClick"> 
                    <span data-bind="text:  Text"></span>
                </li>
            </ul>
        </div>
        <div class="right">Controls within the category clicked...
            <ul data-bind="foreach:  Curr.Ranges">
                <li>
                    <span data-bind="text:  FieldName" />
                </li>
            </ul>
        </div> 
```

我应该这样做有更好的方法吗？基本上，我希望我的右侧面板一次只显示一个集合。我现在要做的就是显示字段名，但没有显示任何内容。任何帮助将不胜感激....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:20:57.883

看起来好像您希望 Curr 是可观察的，而不是可观察的数组，并且您没有正确分配它：

```
viewModel.Curr = ko.observable();
// Inside your click method
viewModel.Curr(category); 
```

您还需要添加 Ranges 的虚拟属性，否则会在初始 applyBindings 上出现淘汰赛：

```
viewModel.Curr = ko.observable({ Ranges: [] }); 
```

# jquery - 无法识别的表达式：[name=name[first][]]

> ID：15501789
> 
> 赞同：0
> 
> 时间：2013-03-19T14:09:24.643
> 
> 标签：jquery, validation

我有一个 jquery 表单验证代码。如果元素名称是单一的，但如果它是如下所示的数组，则该脚本工作正常：

```
<form name="test" id="test">
<input type="text" name="name[first][]" />
<input type="text" name="name[first][]" />
<input type="text" name="name[first][]" />
<input type="button" name="Submit" value="submit" class="submit" /> 
```

验证脚本不工作，它总是返回这个错误：

```
Error: Syntax error, unrecognized expression: [name=name[first][]] 
```

你可以在这个 jsfiddle 链接上看到我的代码： [jsfiddle 链接](http://jsfiddle.net/wdr9b/8/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:10:56.167

引用属性值：

```
$('[name="name[first][]"]') 
```

当名称很简单时，您只能省略引号，例如`foo`，如果名称是，`foo $[][½½{}] ]`那么您必须引用它，原因我希望很明显..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:28:02.797

`Putting Quotes on the name will solve your issue`并且 `To validate the all Textbox value`，您也可以尝试如下：

小提琴示例：http: [//jsfiddle.net/wdr9b/12/](http://jsfiddle.net/wdr9b/12/)

```
$(document).ready(function () {
    $('.submit').click(function () {        
      $('input[type="text"]').each(function(){ 
            if($(this).attr("name") == "name[first][]"){
                if($(this).val().length <= 0) {
                    alert('field is required.');
                    return false;
                }
            }
      });    
    });    
}); 
```

# css - 将子 div 的高度设置为父母身高 - 兄弟姐妹身高

> ID：15501793
> 
> 赞同：0
> 
> 时间：2013-03-19T14:09:36.443
> 
> 标签：css, html, height

我在父 div 中有 2 个子 div。Child1 是标题，Child2 是正文。我希望将 Child 2 的高度设置为 Parent - Child1 的高度。Child2 有内容，所以它应该是可滚动的

我知道我可以通过 JS 设置 Child2 的高度，但是可以通过 CSS 来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:17:10.260

如果高度是固定的，您可以简单地给标题负值`margin-bottom`等于标题的高度，然后给内容分隔线`padding-top`也等于该高度：

HTML：

```
<div id="wrapper">
    <div id="header"></div>
    <div id="content"></div>
</div> 
```

CSS：

```
html, body { height:100%; margin:0; }
#wrapper {
    height:100%;
    background:#000;
}
#header {
    height:100px; /* Fixed height header */
    margin-bottom:-100px; /* Negative height of header */
    z-index:2;
    position:relative;
}
#content {
    min-height:100%;
    padding-top:100px; /* Height of header */
    box-sizing:border-box;
    z-index:1;
    position:relative;
} 
```

[JSFiddle 示例](http://jsfiddle.net/6N7yD/3/)。

# php - 多个准备好的语句 (SELECT)

> ID：15501809
> 
> 赞同：0
> 
> 时间：2013-03-19T14:10:04.000
> 
> 标签：php, sql, mysqli, statements

我正在尝试使用准备好的语句更改我的 SQL 查询。想法：我通过while循环从数据库中获取多条记录，然后在循环中从数据库中获取一些附加数据。

这是我的旧 SQL 代码（简化）：

```
$qry = "SELECT postId,title,userid from post WHERE id='$id'"; 
$rst01 = mysqli_query($mysqli, $qry01);
// loop trough mutiple results/records
while (list($postId,$title,$userid) = mysqli_fetch_array($rst01)) {
// second query to select additional data
$query05 = "SELECT name FROM users WHERE id='$userid";
$result05 = mysqli_query($mysqli, $query05);
$row05 = mysqli_fetch_array($result05);
$name = $row05[name ];

echo "Name: ".$name;

// do more stuff

// end of while loop
} 
```

现在我想用准备好的语句重写它。我的问题：是否可以在获取另一个准备好的语句时运行准备好的语句？我仍然需要像在旧 SQL 代码中为 $name 所做的那样的名称。

这是到目前为止所写的。

```
$stmt0 = $mysqli->stmt_init();
$stmt0->prepare("SELECT postId,title,userid from post WHERE id=?"); 
$stmt0->bind_param('i', $id);
$stmt0->execute();
$stmt0->bind_result($postId,$title,$userid);
// prepare second statement
$stmt1 = $mysqli->stmt_init();
$stmt1->prepare("SELECT name FROM users WHERE id= ?");
while($stmt0->fetch()) {

$stmt1->bind_param('i', $userid);
$stmt1->execute();
$res1 = $stmt1->get_result();
$row1 = $res1->fetch_assoc();

echo "Name: ".$row1['name'] ;

} 
```

它为循环中的第二个语句返回错误：

```
 Warning: mysqli_stmt::bind_param(): invalid object or resource mysqli_stmt in ... 
```

如果我对循环使用旧方法，并且只使用准备好的语句来获取 $name 它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:15:20.710

您实际上可以使用单个`JOIN`ed 查询来执行此操作：

```
SELECT p.postId, p.title, p.userid, u.name AS username
FROM post p
JOIN users u ON u.id = p.userid
WHERE p.id = ? 
```

一般来说，如果您在循环中运行查询，则可能有更好的方法。

# c# - 使用 html 敏捷包解析 html

> ID：15501810
> 
> 赞同：0
> 
> 时间：2013-03-19T14:10:06.500
> 
> 标签：c#, html, html-agility-pack

我想从此 div 中收集所有标签，但不知道如何使用 xpath 方法以最佳方式执行此操作

```
<div class="biz_info">
    <h3><a href="/profil/78122/s%C3%B8rby-rehab/">Sørby Rehab</a></h3>
    <table class="string_14">
        <tbody>
            <tr>
               <td>Postadr.:</td> 
               <td class="tab_space">Rognerudveien 8 B, 0681 Oslo</td> 
            </tr>

            <tr>
                <td>Telefon:</td> 
                <td class="tab_space">928 70 700</td>
            </tr>

            <tr>
                <td>Nettside:</td> 
                <td class="tab_space"><a href="http://www.sorby-rehab.no" target="_blank">www.sorby-rehab.no</a></td>
            </tr>
        </tbody>
    </table>
</div> 
```

今天我的代码看起来像这样（但非常糟糕）：

```
 HtmlDocument doc = new HtmlDocument();
doc.Load(new StringReader(result));
HtmlNode root = doc.DocumentNode;

List<string> anchorTags = new List<string>();

foreach (HtmlNode link in root.SelectNodes("//@class=biz_info"))
{
    string att = link.OuterHtml;
    anchorTags.Add(att);
} 
```

xpath专业的人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:17:41.347

```
HtmlDocument html = new HtmlDocument();
html.Load(new StringReader(result));
var anchorTags = html.DocumentNode.SelectNodes("//div[@class='biz_info']//a")
                     .Select(a => a.OuterHtml)
                     .ToList(); 
```

这将为您提供锚标签 html 的列表。如果您只需要网址：

```
urls = html.DocumentNode.SelectNodes("//div[@class='biz_info']//a[@href!='']")
           .Select(a => a.Attributes["href"].Value)
           .ToList(); 
```

# c# - 如何在 C# 中为集成测试播种数据库数据？

> ID：15501811
> 
> 赞同：5
> 
> 时间：2013-03-19T14:10:06.510
> 
> 标签：c#, asp.net-mvc, nunit, integration-testing, fluent-migrator

我最近一直在针对 ASP.Net MVC 控制器操作编写一些集成测试，并且对设置运行测试所需的测试数据的困难感到沮丧。

例如，我想测试控制器的“添加”、“编辑”和“删除”操作。我可以很好地编写“添加”测试，但后来发现要编写“编辑”测试我要么必须调用“添加”测试的代码来创建记录，以便我可以编辑它，或者在测试课上做了很多设置，但都不是特别吸引人。

理想情况下，我想使用或开发一个集成测试框架，以便更容易以可重用的方式为集成测试添加种子数据，以便安排/动作/断言测试的安排方面可以专注于安排我特别需要安排的内容我的测试，而不是考虑安排大量与被测代码间接相关的参考数据。

我碰巧在使用 NHibernate，但我相信任何数据播种功能都应该忽略这一点，并且能够直接操作数据库；ORM 可能会改变，但我将始终使用 SQL 数据库。

我正在使用 NUnit，因此设想挂钩到 test/testfixture setup/teardown（但我认为一个好的解决方案可能会转移到其他测试框架）。

我在我的主要项目中使用[FluentMigrator](https://github.com/schambers/fluentmigrator/wiki)来管理模式和参考数据的播种，因此能够使用 FluentMigrator 框架在整个解决方案中实现一致的方法会很好，但不是必需的。

所以我的问题是，“如何为 C# 中的集成测试播种数据库数据？” 你直接执行SQL吗？你使用框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:01:53.223

您可以在 Sql Server Compact 上进行集成测试，您将拥有一个 .sdf 文件，并且您可以连接到它，将文件的路径作为连接字符串。这将更快、更容易设置和使用。

您的集成测试可能不需要数百万行数据。您可以将测试数据插入数据库并将其另存为`TestDbOriginal.sdf`.

当您运行测试时，只需制作此“ `TestDbOriginal.sdf`”的副本并处理该副本，该副本已经播种了数据。如果你想测试一个特定的场景，你需要通过调用一些方法来准备你的数据，比如 add、remove、edit 。

当您进行生产或性能测试时，切换回您的原始服务器版本，无论是 Sql Server 2008 还是其他版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:51:40.750

我不知道这是否一定是“正确”的事情，但我总是使用我的添加/创建方法播种。

# excel - 如何使用偏移量将单列中的单元格值“重新定位”到单行？

> ID：15501816
> 
> 赞同：0
> 
> 时间：2013-03-19T14:10:17.903
> 
> 标签：excel, vba, offset

我是一个糟糕的 VBA 人。请帮我。

我想将三个值重新定位在一个列中，并使用 Offset 将它们放在一行中。我需要将 3 行数据展平为单行数据。

这是代码 - 它非常粗糙：

```
Sub Macro1()
'
' Macro1 Macro
'
    'turn off display update
    Application.ScreenUpdating = False

Dim CVFESUMMARY2(2000, 2000)
Dim MAXROW As Integer
Dim i As Integer
Dim r As Range
Dim x As Range
Dim y As Range
Dim z As Range

Set r = Range("BJ13:BJ512")
Set x = Range("BK13:BK512")
Set y = Range("BL13:BL512")
Set z = Range("BM13:BM512")

MAXROW = 300

'format "new" columns

Range("BK11").Select
ActiveCell.FormulaR1C1 = "NORM"

Range("BL11").Select
ActiveCell.FormulaR1C1 = "MIN"

Range("BM11").Select
ActiveCell.FormulaR1C1 = "MAX"

Columns("BJ:BM").Select
Selection.ColumnWidth = 12

'define the "COPY DATA FROM" starting cell location

Sheets("CVFESUMMARY2").Select
Range("BJ13").Select

'cycle through all of the rows in range r
For i = 1 To MAXROW

        'copy "BJ13"
        r.Select
        Selection.Copy

        'paste "value only" in column "BK13"
        x.Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

        'copy "BJ13+1"
        Set r = r.Offset(1, 0)
        r.Select
        Selection.Copy

        'paste "value only" in column "BL13"
        y.Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

        'copy "BJ13+2"
        Set r = r.Offset(1, 0)
        r.Select
        Selection.Copy

        'paste "value only" in column "BM13"
        z.Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

        'move active cell to "BJ13+4"
        Set r = r.Offset(2, 0)

        Set x = x.Offset(4, 0)
        Set y = y.Offset(4, 0)
        Set z = z.Offset(4, 0)
Next i

'turn on display update
Application.ScreenUpdating = True

End Sub 
```

这有点工作，但它在 +2 和 +3 行中添加了我不想要的值；我认为循环是错误的。提前致谢！

**前**

![转换前的数据示例](../Images/380a6065621ee855be44e9155131ef7b.png)

**后**

![转换后的数据示例](../Images/cde5942a260bcd54abf461eb81880557.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:07:20.717

你想要的输出，结果可以压缩吗？（删除所有空行，留下一块数据）或者在其链接之前的列中是否有信息？

删除多余的行不会有太多额外的工作。

使用以下代码（我认为它可以满足您的需求），该`MaxRows`值不正确。它的工作方式应该是一个`MaxRecords`ie：你的数据组数。

```
Sub Transpose()
Dim Position As Range
Dim Source As Range
Dim MaxRow As Integer
Dim Index As Integer

' set column titles
Range("BK11").Value2 = "NORM"
Range("BL11").Value2 = "MIN"
Range("BM11").Value2 = "MAX"

' set the width
Range("BJ:BM").ColumnWidth = 12

MaxRow = 512 ' see note below

Set Position = Range("BJ13") ' define the start position

Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

'For Index = 1 To MaxRow
Do

    ' create a range that contains your first 3 values    
    Set Source = Range(Position, Position.Offset(RowOffset:=2))
    ' copy it
    Source.Copy
    ' paste and transpose the values into the offset position
    Position.Offset(ColumnOffset:=1).PasteSpecial xlPasteValues, SkipBlanks:=False, Transpose:=True
    ' OPTIONAL - Clear the contents of your source range
    Source.ClearContents 
    ' re-set the position ready for the next iteration
    Set Position = Position.Offset(RowOffset:=4)

'Next
Loop While Position.Row < RowMax

Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

End Sub 
```

注意：我没有使用过`Select`，`Selection`因为它们让我感到困惑！使用`Range()`可以更轻松地了解您在 imo 的位置。

**更新**我已经包含了一个也可以压缩输出的更新

```
Sub TransposeCompact()
Dim Position As Range
Dim Source As Range
Dim Destination As Range
Dim MaxRow As Integer
Dim Index As Integer

' set column titles
Range("BK11").Value2 = "NORM"
Range("BL11").Value2 = "MIN"
Range("BM11").Value2 = "MAX"

' set the width
Range("BJ:BM").ColumnWidth = 12

MaxRow = 512 ' see note below

' define the start position
Set Position = Range("BJ13")
' define the first output position
Set Destination = Position.Offset(ColumnOffset:=1)

Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

'For Index = 1 To MaxRow
Do

    ' create a range that contains your first 3 values
    Set Source = Range(Position, Position.Offset(RowOffset:=2))
    ' copy it
    Source.Copy
    ' paste and transpose the values into the offset position
    Destination.PasteSpecial xlPasteValues, SkipBlanks:=False, Transpose:=True
    ' OPTIONAL - Clear the contents of your source range
    Source.ClearContents
    ' re-set the position ready for the next iteration
    Set Position = Position.Offset(RowOffset:=4)
    ' increment the row on the output for the next iteration
    Set Destination = Destination.Offset(RowOffset:=1)

'Next
Loop While Position.Row < RowMax

Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

End Sub 
```

**更新 2** 您`i`在 中使用的变量`For Loop`实际上并没有使用，如果您的数据在第 13 到 512 行，那么我对上面代码所做的编辑应该会有所帮助。

变量现在将在超出`RowMax`宏时停止宏。`Position.Row`

# android - 谷歌地图 V2 空白屏幕

> ID：15501822
> 
> 赞同：0
> 
> 时间：2013-03-19T14:10:42.097
> 
> 标签：android, google-maps, android-fragmentactivity, android-maps-v2

我目前正在使用带有 Android 4.0 版 Ice Cream Sandwich 的 Galaxy S3 开发应用程序。我按照[Vogella 的教程](http://www.vogella.com/articles/AndroidGoogleMaps/article.html)介绍了如何使用适用于 Android 的 Google Map v2 创建示例地图，它适用于 Ice Cream Sandwich。在地图上显示所有内容。但是，当我尝试在我的朋友 Android 设备上使用版本 2.3 Gingerbread 访问应用程序的地图活动时，我得到一个只有 GPS 按钮和放大和缩小按钮可见的空白屏幕，但在我的手机上它运行得非常好。

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.barcodelibrary"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<permission
    android:name="com.example.mapApp.permission.MAPS_RECEIVE"
    android:protectionLevel="signature" />

<uses-permission android:name="com.example.mapApp.permission.MAPS_RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.SET_DEBUG_APP" >
</uses-permission>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.mapApp.HomeActivity"
        android:label="@string/title_activity_home" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="com.example.mapApp.MyMap" />

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="MY API KEY" />
</application> 
```

布局：

```
 <fragment
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.SupportMapFragment" /> 
```

活动：

```
public class MyMap extends FragmentActivity{
private GoogleMap map;
@SuppressLint("NewApi")
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_map);
    SupportMapFragment FMap = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
    map = FMap
}} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T11:36:17.153

```
<meta-data
    android:name="com.google.android.maps.v2.API_KEY"
    android:value="my api key" /> 
```

needs to be inside application tag.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:51:56.037

您的清单必须如下所示：

```
<?xml version="1.0" encoding="utf-8"?>  
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"  
   package="com.djandroid.mapsv2"  
   android:versionCode="1"  
   android:versionName="1.0" >  
   <uses-sdk  
     android:minSdkVersion="8"  
     android:targetSdkVersion="16" />  
   <uses-permission android:name="android.permission.INTERNET" />  
   <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />  
   <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />  
   <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />  
   <uses-permission android:name="com.djandroid.mapsv2.permission.MAPS_RECEIVE" />  
   <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />  
   <uses-feature  
     android:glEsVersion="0x00020000"  
     android:required="true" />  
   <application  
     android:allowBackup="true"  
     android:icon="@drawable/ic_launcher"  
     android:label="@string/app_name"  
     android:theme="@style/AppTheme" >  
     <activity  
       android:name="com.djandroid.mapsv2.MainActivity"  
       android:label="@string/app_name" >  
       <intent-filter>  
         <action android:name="android.intent.action.MAIN" />  
         <category android:name="android.intent.category.LAUNCHER" />  
       </intent-filter>  
     </activity>  
     <meta-data  
       android:name="com.google.android.maps.v2.API_KEY"  
       android:value="API_KEY" />  
     <uses-library  
       android:name="com.google.android.maps"  
       android:required="true" />  
   </application>  
 </manifest> 
```

你在你的清单文件中伪造了这个：

```
<uses-feature  
     android:glEsVersion="0x00020000"  
     android:required="true" /> 
```

这就是为什么您可能会在日志中收到以下错误：

```
Then error is : java.lang.RuntimeException: Google Maps Android API only supports OpenGL ES 2.0 andabove. Please add <uses-feature android:glEsVersion="0x00020000" android:required="true" /> into AndroidManifest.xml 
```

完整代码[点击这里](http://dj-android.blogspot.in/2013/02/android-google-map-v2-part-1.html)

# activemq - 从 ActiveMQ 虚拟主题中出列消息

> ID：15501823
> 
> 赞同：4
> 
> 时间：2013-03-19T14:10:44.637
> 
> 标签：activemq, apache-camel, fuseesb

我将 FuseESB 与 ActiveMQ v5.7.0.fuse-71-047（又名 v5.7）一起使用

我有一个虚拟主题“VirtualTopic.xxx”和一个订阅者（使用 Camel）它设置如下：

```
from(activemq:Consumer.A.VirtualTopic.xxx?brokerURL="something")
  .doSomething() 
```

Eveything 似乎运行良好，我可以看到消息从队列“Consumer.A.VirtualTopic.xxx”中入队和出队

我的问题：消息是否应该从 VirtualTopic.xxx 中出列，然后发送到 Consumer.A.VirtualTopic.xxx？消费者 A 是唯一的订阅者。使用 JConsole，我可以看到消息已入队，但出队和分派计数为 0。这里有问题吗？

# java - 带数组的模数因子

> ID：15501828
> 
> 赞同：-1
> 
> 时间：2013-03-19T14:10:54.607
> 
> 标签：java, arrays

所以我有一个包含各种数字的数组，其中包括 3 和 5。我传递了数字 45，所以这个方法的结果应该是打印 3 和 5 但是这不起作用，有人知道为什么吗？

```
 public void primeFactors(int n)
{
    //header
    System.out.println("\nprime factors of " +n+ " are:");

    for (int i = 1; i<n;i++)
    {
        if(n%this.numbersinset[i] ==0)
        {
            System.out.println(i);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:13:11.757

也许尝试使循环从0开始？此外，您似乎需要致电：

```
System.out.println(numbersinset[i]); 
```

而不是简单地打印`i`.

# android - 以编程方式添加带有参数的布局 Android

> ID：15501831
> 
> 赞同：15
> 
> 时间：2013-03-19T14:11:07.527
> 
> 标签：android, android-layout, android-activity, layoutparams

您好，我有一个主屏幕。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >
<fragment
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.SupportMapFragment"/>
<ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="55dp"
    android:layout_height="50dp"
    android:layout_alignParentTop="true"
    android:layout_marginTop="10dp"
    android:layout_toLeftOf="@+id/toggleButton1"
    android:background="@android:drawable/btn_default"
    android:contentDescription="@string/app_name"
    android:scaleType="centerCrop"
    android:src="@drawable/plus_grey" />

<LinearLayout
    android:id="@+id/lay"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_marginEnd="0dp"
    android:background="#A0FFFFFF"
    android:orientation="horizontal"
    android:visibility="invisible" >

    <TextView
        android:id="@+id/locinfo"
        android:layout_width="match_parent"
        android:layout_height="60dp"
        android:textColor="@color/cherniy"
        android:textSize="20sp"
        android:visibility="visible" />
</LinearLayout>
</RelativeLayout> 
```

还有一个imageButton

```
 button = (ImageButton) findViewById(R.id.imageButton1);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v)  {
                if (bIcon == false) {
                    button.setImageResource(R.drawable.plus_yellow);                                                                   
                    m = myMap.addMarker(new MarkerOptions().position(myMap.getCameraPosition().target).draggable(true));                     
                    LinearLayout linLayout = (LinearLayout)findViewById(R.id.lay);
                    t = (TextView)findViewById(R.id.locinfo);                      
                    linLayout.setVisibility(View.VISIBLE);
                    t.setVisibility(View.VISIBLE);                      
                                bIcon = true;
                }
                else {
                    button.setImageResource(R.drawable.plus_grey);                                             
                    m.remove();
                    LinearLayout linLayout = (LinearLayout)findViewById(R.id.lay);
                    t.setVisibility(View.INVISIBLE);
                    linLayout.setVisibility(View.INVISIBLE);                        
                    bIcon = false;                
                }                             
            }
        }); 
```

我想以编程方式添加

```
LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams((w*2)/3, LayoutParams.WRAP_CONTENT); 
```

w

```
display = getWindowManager().getDefaultDisplay(); 
@SuppressWarnings("deprecation")
w = display.getWidth(); 
```

但是当我这样做时

```
 button.setImageResource(R.drawable.plus_yellow);                                                                   
                m = myMap.addMarker(new MarkerOptions().position(myMap.getCameraPosition().target).draggable(true));                     
                LinearLayout linLayout = (LinearLayout)findViewById(R.id.lay);
                LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams((w*2)/3, LayoutParams.WRAP_CONTENT);
                linLayout.setLayoutParams(lp);
                t = (TextView)findViewById(R.id.locinfo);                      
                linLayout.setVisibility(View.VISIBLE);
                t.setVisibility(View.VISIBLE);                      
                bIcon = true; 
```

我的应用程序崩溃。您能告诉我如何使用我的参数以编程方式创建（与设备屏幕的宽度和高度相关）吗？我会接受任何建议。谢谢你。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-19T14:17:15.717

> ```
> LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(
>     (w*2)/3, 
>     LayoutParams.WRAP_CONTENT
> );
> linLayout.setLayoutParams(lp); 
> ```

这将引发错误，因为它`LinearLayout`是相对布局的子布局，因此您必须为此进行设置`RelativeLayoutParams`。

而是使用这个

```
RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
    (w*2)/3, 
    RelativeLayout.LayoutParams.WRAP_CONTENT
);
linLayout.setLayoutParams(lp); 
```

`LayoutParams`或者您可以重用现有视图，而不是创建新`LayoutParams`视图，如下所示。

```
RelativeLayout.LayoutParams lp = linLayout.getLayoutParams();
lp.width  = (w*2)/3;
lp.height = RelativeLayout.LayoutParams.WRAP_CONTENT;
linLayout.setLayoutParams(lp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:41:06.143

您应该修改现有的，而不是制作新的 LayoutParams。

将您的代码更改为：

```
button.setImageResource(R.drawable.plus_yellow);                                                                   
m = myMap.addMarker(new MarkerOptions().position(myMap.getCameraPosition().target).draggable(true));                     
LinearLayout linLayout = (LinearLayout)findViewById(R.id.lay);
LinearLayout.LayoutParams lp = linLayout.getLayoutParams();
final int left_margin = whatever;
final int top_margin = 0;
final int right_margin = whatevermore;
final int bottom_margin = 0;
lp.setMargins(left_margin, top_margin, right_margin, bottom_margin);
lp.width  = (w*2)/3;
linLayout.setLayoutParams(lp);
t = (TextView)findViewById(R.id.locinfo);                      
linLayout.setVisibility(View.VISIBLE);
t.setVisibility(View.VISIBLE);              
bIcon = true; 
```

# oracle11g - Oracle XE 停止工作。TNS 监听器拒绝连接

> ID：15501832
> 
> 赞同：9
> 
> 时间：2013-03-19T14:11:07.993
> 
> 标签：oracle11g, database-connection

我正在开发一个使用 Oracle XE 11g 作为其 RDBMS 的应用程序。它工作了几个星期，但现在我开始收到有关连接被拒绝的错误消息。

我重新启动了我的系统，但它没有帮助。我卸载了 XE，删除了所有剩余的文件（甚至从注册表中）并重新安装了它。现在我收到另一条错误消息：

> 侦听器拒绝连接并出现以下错误：ORA-12505，TNS：侦听器当前不知道连接描述符中给出的 SID

我已阅读有关此错误的信息，其他人建议将新 SID 添加到 listener.ora 文件中：

```
(SID_DESC =
  (SID_NAME = XE)
  (ORACLE_HOME = C:\oraclexe\app\oracle\product\11.2.0\server)
) 
```

如果我这样做，我会收到另一条错误消息：

> ORA-01034: ORACLE 不可用 ORA-27101: 共享内存领域不存在

我的配置文件是： **listener.ora**

```
 SID_LIST_LISTENER =   (SID_LIST =
    (SID_DESC =
      (SID_NAME = XE)
      (ORACLE_HOME = C:\oraclexe\app\oracle\product\11.2.0\server)
    )
    (SID_DESC =
      (SID_NAME = PLSExtProc)
      (ORACLE_HOME = C:\oraclexe\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )
    (SID_DESC =
      (SID_NAME = CLRExtProc)
      (ORACLE_HOME = C:\oraclexe\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )   )

LISTENER =   (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
      (ADDRESS = (PROTOCOL = TCP)(HOST = AAROLD.in.mycompany.com)(PORT = 1521))
    )   )

DEFAULT_SERVICE_LISTENER = (XE) 
```

**tnsnames.ora**

```
XE =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = AAROLD.in.mycompany.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = XE)
    )
  )

EXTPROC_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
    )
    (CONNECT_DATA =
      (SID = PLSExtProc)
      (PRESENTATION = RO)
    )
  )

ORACLR_CONNECTION_DATA = 
  (DESCRIPTION = 
    (ADDRESS_LIST = 
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1)) 
    ) 
    (CONNECT_DATA = 
      (SID = CLRExtProc) 
      (PRESENTATION = RO) 
    ) 
  ) 
```

**lsnrctl status**返回：

```
LSNRCTL for 32-bit Windows: Version 11.2.0.2.0 - Production on 19-M┴RC. -2013 15:12:24

Copyright (c) 1991, 2010, Oracle.  All rights reserved.

Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC1)))
STATUS of the LISTENER
------------------------
Alias                     LISTENER
Version                   TNSLSNR for 32-bit Windows: Version 11.2.0.2.0 - Production
Start Date                19-M┴RC. -2013 15:01:12
Uptime                    0 days 0 hr. 11 min. 11 sec
Trace Level               off
Security                  ON: Local OS Authentication
SNMP                      OFF
Default Service           XE
Listener Parameter File   C:\oraclexe\app\oracle\product\11.2.0\server\network\admin\listener.ora
Listener Log File         C:\oraclexe\app\oracle\diag\tnslsnr\AAROLD\listener\alert\log.xml
Listening Endpoints Summary...
  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(PIPENAME=\\.\pipe\EXTPROC1ipc)))
  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=AAROLD.in.mycompany.com)(PORT=1521)))
Services Summary...
Service "CLRExtProc" has 1 instance(s).
  Instance "CLRExtProc", status UNKNOWN, has 1 handler(s) for this service...
Service "PLSExtProc" has 1 instance(s).
  Instance "PLSExtProc", status UNKNOWN, has 1 handler(s) for this service...
The command completed successfully 
```

你知道可能是什么问题吗？我不是甲骨文专家，所以我在这里完全一无所知。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-01T21:07:15.900

我遇到了完全相同的问题，花了将近 4 个小时试图找到并回答后，最后添加

```
(SID_DESC =
  (SID_NAME = XE)
  (ORACLE_HOME = C:\oraclexe\app\oracle\product\11.2.0\server)
) 
```

到我的 listener.ora 并重新启动两个 XE 服务解决了这个问题。我在 Windows 7 x64 上使用 11.2.0 (XE) 直到昨天都没有任何问题。今天早上我的电脑重新启动导致侦听器找不到 SID。

现在我正在备份listener.ora 和tnsnames.ora。

顺便说一句，忘了提及我将两个文件中的主机名从 bob.mycompany.com 更改为 localhost。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-09-30T03:48:53.510

在 Windows 7 64 位上，Orcale XE 11 我的 OracleXXETNSListener 服务没有运行，并且在我尝试启动它时立即终止。

1.  添加

> (SID_DESC = (SID_NAME = XE) (ORACLE_HOME = C:\oracle\app\oracle\product\11.2.0\server) )

对我

```
C:\oraclexe\app\oracle\product\11.2.0\server\network\ADMIN\listener.ora 
```

2.  将主机名更改为**localhost**

3.  **在 System - Services 下**重新启动 OracleServiceXE 服务解决了这个问题。****

 **所以完整的**listener.ora**部分如下所示：

```
SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = PLSExtProc)
      (ORACLE_HOME = C:\servers\oraclexe\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )
    (SID_DESC =
      (SID_NAME = CLRExtProc)
      (ORACLE_HOME = C:\servers\oraclexe\app\oracle\product\11.2.0\server)
      (PROGRAM = extproc)
    )
    (SID_DESC =
      (SID_NAME = XE)
      (ORACLE_HOME = C:\servers\oraclexe\app\oracle\product\11.2.0\server)
    )
  )

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))
    )
  )

DEFAULT_SERVICE_LISTENER = (XE) 
```

更新：现在是 5 年后，我在 Win10 上遇到了与 OracleXE 18c 相同的问题。TNS 侦听器在安装成功后不会立即启动，因为*oracleXE\dbhomeXE\NETWORK\ADMIN\listener.ora* 指向的是 localhost.docker.internal 而不是 localhost。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-28T14:41:55.900

我遇到了类似的问题，我通过从 listener.ora 和 tnsnames.ora 中删除“IPC”行来修复它。

在 上`listener.ora`，我删除了：

```
(ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1)) 
```

在 上`tnsnames.ora`，我删除了：

```
EXTPROC_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
    )
    (CONNECT_DATA =
      (SID = PLSExtProc)
      (PRESENTATION = RO)
    )
  ) 
```

这可能是一个矫枉过正，但它终于修复了，几个小时后！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T05:07:26.217

您的 Oracle 数据库已关闭。启动可能会有些问题。

转到命令提示符并键入：

SQL> **sqlplus / as sysdba**

如果您收到“已连接到空闲实例”的消息，请输入

SQL>**启动**

让我知道你收到的信息。如果在 SqlPlus 启动时没有收到“已连接到空闲实例”消息，请键入：

SQL>**设置行 80 页 50**

SQL>**从 v$database 中选择 *；**

并在此处发布输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-27T10:54:12.923

我遇到了同样的问题，错误是我更改了机器的名称。这已通过编辑 listener.ora 并重命名 HOST 解决：

```
LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
      (ADDRESS = (PROTOCOL = TCP)(HOST = hostname_of_my_machine)(PORT = 1521))
    )
  ) 
```**

# objective-c - tableView numberOfRowsInSection 在 iOS4 上调用 tableView viewForHeaderInSection

> ID：15501837
> 
> 赞同：0
> 
> 时间：2013-03-19T14:11:13.357
> 
> 标签：objective-c, ios4

我有一个包含很多依赖项的大应用程序。对于这种情况，我实现了一个类`RootTableViewController`来处理每次需要表视图控制器时必须完成的所有事情。

现在我发现了一个无限循环，我不知道如何解决它。我得到以下代码`RootTableViewController`：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    NSString *sectionTitle = [self tableView:tableView titleForHeaderInSection:section];
    int numbersOfRowInSection = [self.tableView numberOfRowsInSection:section];

    if (numbersOfRowInSection > 0)
    {
         // ...
    }
    else
    {
        UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 320.0f, 28.0f)];
        return view;
    }
} 
```

这在 iOS 5 和 iOS 6 上完美运行，但在 iOS4 上它会导致无限循环，因为`[tableView numberOfRowsInSection]`正在调用`[tableView viewForHeaderInSection]`. 如何使用 table view api 解决这个问题？使用内部数据数组对我来说不是解决方案，`[ count]`因为我有很多表视图控制器`RootTableViewController`使用不同的数据源扩展它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:07:07.783

这根本不是好风格。你应该继承或实现相关的委托方法，但你不应该调用`UITableView.numberofRowsInSection:`

但是，您肯定已经实现了`tableView:numberOfRowsInSection`. 将其所有功能移至新方法`myNumberOfRowsInSection:`在那里做同样的事情。它主要是您当前的`numberOfRowsInSection`. 然后在您的代码片段调用中`[self myNumberOfRowsInSection:...];`

在里面`tableView:numberOfRowsInSection:section`做：

```
return [self myNumberOfRowsInSection:section]; 
```

将相同的模式应用于您可能想要自己调用的所有委托方法。将其所有业务逻辑移动到您自己的方法中，然后仅从委托方法和您自己的代码中调用您自己的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T15:17:44.077

如果您想在不访问内部数据数组的情况下获取数据源部分中的行数，您可以查询`dataSource`委托，例如

```
int numbersOfRowInSection = [self.tableView.dataSource tableView:self.tableView numberOfRowsInSection:section]; 
```

（未经编译器检查）

# json - highchart车速表的json格式

> ID：15501838
> 
> 赞同：0
> 
> 时间：2013-03-19T14:11:15.863
> 
> 标签：json, getjson

`JSON`高图表车速表接受的格式是什么？请帮助我，因为我对高图表非常陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:40:54.100

速度计的数据序列只需要一个值。例如 data: [80] 将速度设置为 80。

这是一个显示速度为 80 的基本示例：

```
 var chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container',
        type: 'gauge',
    },     
    title: {
        text: 'Speedometer'
    },

    pane: {
        startAngle: -150,
        endAngle: 150
    },
    yAxis: {
        min: 0,
        max: 200,
        title: {
            text: 'km/h'
        }  
    },
    series: [{
        name: 'Speed',
        data: [80],
        tooltip: {
            valueSuffix: ' km/h'
        }
    }]  
}, 
```

这是它的一个示例，其中一个函数使用 point.update 对其进行更新：http: [//jsfiddle.net/JYjP7/](http://jsfiddle.net/JYjP7/)

# android - Android平均内存限制

> ID：15501844
> 
> 赞同：2
> 
> 时间：2013-03-19T14:11:46.280
> 
> 标签：android, memory, memory-management

我想知道智能手机的平均内存限制是多少。我正在创建一个包含许多位图的相当繁重的游戏，并且我在加载屏幕（菜单 > 游戏）之间加载和卸载。但是我们的一款测试手机有 32mb 的内存限制，这是正常的还是罕见的？

在我的加载屏幕上，我正在计算要加载的图像有多大，只有在有足够内存时才加载它，否则等待垃圾收集器。但是如果没有更多的东西可以收集，我会重新开始加载并以较低的质量加载它们（16b）。

但是，如果现在智能手机的内存限制为 32mb 的情况很少见，我不介意加载质量较低的图像，但如果有 20-30% 的图像数量如此之低，我宁愿优化以使用更少和更小的图像。

所以问题是，今天的智能手机只有 32mb 内存限制只是罕见的情况，还是智能手机内存限制的某种统计数据？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-03-19T14:16:10.037

我认为应用程序可以使用的内存量是有限制的。以前是 32MB... 可能有一个权限，您可以更改以请求更多内存，就像您可以请求硬件加速一样。从快速谷歌 android:largeHeap="true" 可能是你的答案......还有 Runtime.getRuntime().maxMemory();

# python - Boto 在 ec2 实例上执行 shell 命令

> ID：15501845
> 
> 赞同：12
> 
> 时间：2013-03-19T14:11:51.473
> 
> 标签：python, amazon-ec2, boto

我是 EC2 和 boto 的新手。我有一个 EC2 运行实例，我想执行一个 shell 命令，例如`apt-get update`通过 boto。

我搜索了很多并找到了使用[run_instances](http://boto.s3.amazonaws.com/ref/ec2.html#boto.ec2.connection.EC2Connection.run_instances)`user_data`命令的解决方案，但是如果实例已经启动了怎么办？

我什至不知道这是否可能。本参考资料中的任何线索都会有很大帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-19T15:42:15.137

boto.manage.cmdshell 模块可用于执行此操作。要使用它，您必须安装 paramiko 包。一个简单的使用示例：

```
import boto.ec2
from boto.manage.cmdshell import sshclient_from_instance

# Connect to your region of choice
conn = boto.ec2.connect_to_region('us-west-2')

# Find the instance object related to my instanceId
instance = conn.get_all_instances(['i-12345678'])[0].instances[0]

# Create an SSH client for our instance
#    key_path is the path to the SSH private key associated with instance
#    user_name is the user to login as on the instance (e.g. ubuntu, ec2-user, etc.)
ssh_client = sshclient_from_instance(instance,
                                     '<path to SSH keyfile>',
                                     user_name='ec2-user')
# Run the command. Returns a tuple consisting of:
#    The integer status of the command
#    A string containing the output of the command
#    A string containing the stderr output of the command
status, stdout, stderr = ssh_client.run('ls -al') 
```

这是从记忆中输入的，但我认为它是正确的。

您还可以查看 Fabric（[http://docs.fabfile.org/](http://docs.fabfile.org/)），它具有类似的功能，但也具有更复杂的特性和功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T18:31:56.443

我认为您可以根据自己的要求使用面料。只需检查一次织物包装。您可以通过结构库在远程服务器外壳上执行命令。

它非常易于使用，您可以集成 boto 和 fabric 。他们一起工作出色。

加上相同的命令可以执行到 n 个节点。我相信这可能是您的要求

只是检查一下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-04-12T12:02:45.627

最简单的方法是使用 [kitten](https://github.com/hoffa/kitten)  python 实用程序，它只是 boto3 的包装器。

例如

```
kitten run "apt-get update" ubuntu 18.105.107.20 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-28T08:26:19.823

是的，您可以使用 AWS 系统管理器执行此操作。AWS Systems Manager Run Command 允许您在 EC2 以及本地服务器上远程安全地运行命令集。以下是实现此目的的高级步骤。

附加实例 IAM 角色：ec2 实例必须具有具有策略 AmazonSSMFullAccess 的 IAM 角色。此角色使实例能够与 Systems Manager API 进行通信。

安装 SSM 代理：EC2 实例上必须安装 SSM 代理。SSM 代理处理运行命令请求并根据命令配置实例。

执行命令：通过 AWS CLI 的示例用法：

执行以下命令以检索实例上运行的服务。将 Instance-ID 替换为 ec2 实例 ID。

```
aws ssm send-command --document-name "AWS-RunShellScript" --comment "listing services" --instance-ids "Instance-ID" --parameters commands="service --status-all" --region us-west-2 --output text 
```

更多详细信息：[https ://www.justdocloud.com/2018/04/01/run-commands-remotely-ec2-instances/](https://www.justdocloud.com/2018/04/01/run-commands-remotely-ec2-instances/)

# objective-c - 使用 UITableView 滚动很慢

> ID：15501847
> 
> 赞同：0
> 
> 时间：2013-03-19T14:11:53.830
> 
> 标签：objective-c, uitableview, uiimageview

我有一个 UITableView 动态显示获取的 RSS，我现在已经自定义了 RSS 以返回图像名称，以便稍后我可以将 UIImageView 添加到表格中的每个单元格，在每个单元格旁边显示图像，这里是代码添加图像

```
UIImageView *imageView = [[UIImageView alloc] init];
imageView.frame = CGRectMake(0, 0, 40, 40);

NSString *path = [NSString stringWithFormat:@"URL/%@",object.imageName]; //"object" is the returned Object from the RSS, so basically what i am doing is appending the image name to the path url.
NSURL *url = [NSURL URLWithString:path];
NSData *data = [NSData dataWithContentsOfURL:url];
imageView.image = [UIImage imageWithData:data];

[cell addSubview:imageView];
[cell bringSubviewToFront:imageView]; 
```

所以当我运行我的应用程序时，应用程序运行缓慢，甚至停止一小段时间，原因是我正在加载直接在这一行中成像的所有 RSS`NSData *data = [NSData dataWithContentsOfURL:url];`

这个问题的任何解决方案？

先感谢您

* * *

我实际上想过在一个单独的线程中获取图像，

```
dispatch_queue_t fetchImage = dispatch_queue_create("Fetching Image", NULL);
dispatch_async(fetchImage, ^{
    NSData *data = [NSData dataWithContentsOfURL:url];
});
dispatch_release(fetchImage); 
```

但这样做不会让我在队列外使用变量“数据”。任何的想法 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:28:16.370

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSString *path = [NSString stringWithFormat:@"URL/%@",object.imageName]; 
        NSURL *url = [NSURL URLWithString:path];
        NSData *data = [NSData dataWithContentsOfURL:url];
        dispatch_async(dispatch_get_main_queue(), ^{
            imageView.image = [UIImage imageWithData:data];
        }); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:22:57.880

您应该异步检索数据！可能是使用开源库会帮助你：

*   [AF网络](http://www.afnetworking.com)
*   [ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/) - 不推荐

或者您也可以使用`NSURLConnection`具有异步模式的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:23:35.313

该方法`[NSData dataWithContentsOfURL:]`是同步的：无论何时调用它，它都会阻塞当前线程（几乎可以肯定是您的应用程序的主线程），直到它完成为止。这*很糟糕*。除了让 UI 感觉卡顿之外，还有一个看门狗进程会杀死无响应的应用程序。

您真的非常想使用异步网络调用。继续阅读`NSURLConnection`，但也知道有很多关于这个主题的文章、库和示例：异步加载图像以在表格视图中显示。从 AFNetworking 上的类别开始`UIImageView`，或者像 SDWebImage 这样的库。

# android - Google Map API V3 - LG7 Android 4.0 上显示的两个标记

> ID：15501850
> 
> 赞同：0
> 
> 时间：2013-03-19T14:11:56.247
> 
> 标签：android, google-maps, hybrid-mobile-app

标记是双重的，标记被拖在一起。该错误仅在可拖动属性设置为 TRUE 时出现。

```
var marker = new google.maps.Marker({
            position : new google.maps.LatLng({{lat}}, {{lg}}),
            map : map,
            draggable: true
        }); 
```

任何想法 ？Gmap 错误、设备错误、技术错误……？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T17:44:19.097

我有类似的东西。当我更改覆盖的位置时，我遇到了这个错误或失败。因此，如果我有一个标记并且我改变了它的位置，那么我在旧位置上就有一个标记。和一个标记在新位置。当我通过放大或缩小强制地图重新加载时，“旧”标记消失。

但我真的帮不了你。因此，您可能会尝试通过更改覆盖坐标等来强制 gmap 重新加载。

我只有三星 Galaxy S3 Android 4.0 才有这个。其他 2 个具有不同 Android 2.X 版本的 Galaxy S1 工作正常。桌面浏览器工作正常。

在此处查找：[PhoneGap 中的 Google Maps API v3：移动后标记未正确绘制](https://stackoverflow.com/questions/13505692/google-maps-api-v3-in-phonegap-markers-not-drawing-properly-after-move)

我想这会对你有所帮助。但这无济于事，因为我正在使用叠加层并且没有优化属性。

# java - 无法在 xml 文件中获取具有 name="debitRequest" 的父节点的子节点名称

> ID：15501853
> 
> 赞同：0
> 
> 时间：2013-03-19T14:12:09.530
> 
> 标签：java, xml, xml-parsing

我正在使用 xml 文件“SavedWSDL.txt”，其中的一些部分在下面给出......

```
 ...
<wsdl:message name="LookUpTransactionResponse">
<wsdl:part name="LookUpTransactionReturn" type="impl:ArrayOf_xsd_anyType"/>
</wsdl:message>
<wsdl:message name="LookUpTransactionRequest"></wsdl:message>
<wsdl:message name="creditResponse">
<wsdl:part name="creditReturn" type="xsd:int"/>
</wsdl:message>
<wsdl:message name="creditRequest">
<wsdl:part name="amount" type="xsd:float"/>
<wsdl:part name="password" type="xsd:string"/>
</wsdl:message>
<wsdl:message name="debitRequest">
<wsdl:part name="amount" type="xsd:float"/>
<wsdl:part name="password" type="xsd:string"/>
</wsdl:message>
<wsdl:message name="debitResponse">
<wsdl:part name="debitReturn" type="xsd:int"/>
</wsdl:message>
    ... 
```

我已经编写了下面给出的java代码，应该使用什么来获取wsdl的子节点名称：名为“debitRequest”的消息标记

```
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Ex2 {

    public static void main(String[] args) {
        try {
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse("D:/SavedWSDL.txt");
            doc.getDocumentElement().normalize();

            NodeList nodelist = doc.getElementsByTagName("wsdl:message");
            //System.out.println("No. of Nodes: "+nodelist.getLength());

            for(int i=0;i<nodelist.getLength();i++){
                Node node=nodelist.item(i);
                String valueOfTag=node.getAttributes().getNamedItem("name").getNodeValue();
                if(valueOfTag.equalsIgnoreCase("debitrequest")){
                    if(node.hasChildNodes()){
                        NodeList childNList=node.getChildNodes();
                        //System.out.println("No. of Childs: "+node.getChildNodes().getLength());
                        //System.out.println(node.getAttributes().getNamedItem("name").getNodeValue());
                    }
                    else{
                        System.out.println("NO CHILD FOUND for: "+valueOfTag);
                    }
                }   
            }
        } catch(Exception io) {
            io.printStackTrace();
        } 
    }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T15:11:33.527

在您给定的 XML 中，节点之间有文本（不可见）：

```
<wsdl:message name="debitRequest"> <-- Text
<wsdl:part name="amount" type="xsd:float"/> <-- Text
<wsdl:part name="password" type="xsd:string"/> <-- Text
</wsdl:message> 
```

这就是为什么你的节点`debitRequest`有 5 个子节点（文本、节点、文本、节点、文本）

新的 ChildNode 的 NodeType 为 1，Text 的 NodeType 为 3：

`node.getNodeType() //1 is ChildNode, 3 is Text`

因此，在您拥有节点并且想要获取其所有子节点之后，您应该循环它并检查类型。然后你可以检查属性。

```
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Ex2 {

    public static void main(String[] args) {
        try {
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse("testxml.xml");
            doc.getDocumentElement().normalize();

            NodeList nodelist = doc.getElementsByTagName("wsdl:message");
            //System.out.println("No. of Nodes: "+nodelist.getLength());

            for(int i=0;i<nodelist.getLength();i++){
                Node node=nodelist.item(i);
                String valueOfTag=node.getAttributes().getNamedItem("name").getNodeValue();
                if(valueOfTag.equalsIgnoreCase("debitrequest")){
                    if(node.hasChildNodes()){
                        NodeList childNList=node.getChildNodes();
                        for(int j = 0; j < childNList.getLength();j++)
                        {
                            Node n = childNList.item(j);
                            if(n.getNodeType() == 1) //NodeType 1 = Next XML Node
                            {
                                String nvalue = n.getAttributes().getNamedItem("name").getNodeValue();
                                System.out.println(nvalue);
                            }
                            /*if(n.getAttributes() != null){
                                String s = n.getAttributes().getNamedItem("name").getNodeValue();
                                System.out.println(s);
                            }*/
                        }
                        System.out.println(childNList.getLength());

                    }
                    else{
                        System.out.println("NO CHILD FOUND for: "+valueOfTag);
                    }
                }   
            }
        } catch(Exception io) {
            io.printStackTrace();
        } 
    }
    } 
```

您还可以循环您的孩子并检查每个`Node.getAttributes()`是否为空。如果不是，您可以搜索`"name"`in 属性并继续。第二种方式也显示在我的代码中，但被注释掉了。它的：`if(n.getAttributes() != null){`评论。

# android - 获得发布许可后，facebook发布提要卡在黑屏上

> ID：15501858
> 
> 赞同：0
> 
> 时间：2013-03-19T14:12:24.797
> 
> 标签：android, facebook, facebook-android-sdk

好的，所以我想在我的用户墙上发布一个新帖子。我已经按照developers.facebook在此链接上提供的代码[https://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/)

在发布故事方法中，我添加了一个日志以查看程序是否通过了代码行：

```
private void publishStory() {
Session session = Session.getActiveSession();

if (session != null){

    Log.d("INFO","session is not NULL");

    // Check for publish permissions    
    List<String> permissions = session.getPermissions();
    if (!isSubsetOf(PERMISSIONS, permissions)) {

         Log.d("INFO","setting permission");

        pendingPublishReauthorization = true;
        Session.NewPermissionsRequest newPermissionsRequest = new Session
                .NewPermissionsRequest(this, PERMISSIONS);
    session.requestNewPublishPermissions(newPermissionsRequest);
        return;
    }

    Bundle postParams = new Bundle();
    postParams.putString("name", "Facebook SDK for Android");
    postParams.putString("caption", "Build great social apps and get more installs.");
    postParams.putString("description", "The Facebook SDK for Android makes it easier and faster to develop Facebook integrated Android apps.");
    postParams.putString("link", "https://developers.facebook.com/android");
    postParams.putString("picture", "https://raw.github.com/fbsamples/ios-3.x-howtos/master/Images/iossdk_logo.png");

    Log.d("INFO","finish construct message");

    Request.Callback callback= new Request.Callback() {
        public void onCompleted(Response response) {

            Log.d("INFO","on request complete!");

            JSONObject graphResponse = response
                                       .getGraphObject()
                                       .getInnerJSONObject();
            String postId = null;
            try {
                postId = graphResponse.getString("id");
            } catch (JSONException e) {
                Log.i(TAG,
                    "JSON error "+ e.getMessage());
            }
            FacebookRequestError error = response.getError();
            if (error != null) {
                Toast.makeText(getActivity()
                     .getApplicationContext(),
                     error.getErrorMessage(),
                     Toast.LENGTH_SHORT).show();
                } else {
                    Toast.makeText(getActivity()
                         .getApplicationContext(), 
                         postId,
                         Toast.LENGTH_LONG).show();
            }
        }
    };

    Request request = new Request(session, "me/feed", postParams, 
                          HttpMethod.POST, callback);

    RequestAsyncTask task = new RequestAsyncTask(request);
    task.execute();
} 
```

}

问题是当我执行上面的方法时，程序运行良好，直到它弹出一个身份验证发布权限窗口并且我允许它，屏幕再次继续黑屏，上面有不确定的进度条，然后窗口自行关闭.

事实上，从 logcat 我可以得出结论，它没有通过“on request complete”行。

为什么会这样？任何线索？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:53:33.317

哦，是的，我目前遵循此解决方案已[更新 - Android Facebook api 3.0 错误：无法使用空调用包调用 LoginActivity](https://stackoverflow.com/questions/14123580/updated-android-facebook-api-3-0-error-cannot-call-loginactivity-with-a-null)

就像你说的，我已经像这样添加了 onActivityResult

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
} 
```

它有效！虽然我在对话框类上安排了线条

```
public void createFacebookConnection() {
        Session session = new Session(MapScreen.this);
        Session.setActiveSession(session);

        Settings.addLoggingBehavior(LoggingBehavior.INCLUDE_ACCESS_TOKENS);

        Session.StatusCallback statusCallback = new Session.StatusCallback() {
            @Override
            public void call(Session session, SessionState state, Exception exception) {
                String message = "Facebook session status changed - " + session.getState() + " - Exception: " + exception;
                Log.w("Facebook test", message);

                if (session.isOpened() || session.getPermissions().contains("publish_actions")) {
                    publishToWall();
                } else if (session.isOpened()) {
                    OpenRequest open = new OpenRequest(MapScreen.this).setCallback(this);
                    List<String> permission = new ArrayList<String>();
                    permission.add("publish_actions");
                    open.setPermissions(permission);
                    Log.w("Facebook test", "Open for publish");
                    session.openForPublish(open);
                }
            }
        };

        if (!session.isOpened() && !session.isClosed() && session.getState() != SessionState.OPENING) {
            session.openForRead(new Session.OpenRequest(MapScreen.this).setCallback(statusCallback));
        } else {
            Log.w("Facebook test", "Open active session");
            Session.openActiveSession(MapScreen.this, true, statusCallback);
        }
    }

    void publishToWall() {
        Session session = Session.getActiveSession();

        Bundle postParams = new Bundle();
        postParams.putString("name", "Merauke Android");
        postParams.putString("caption", hotelName);
        postParams.putString("description", hotelName+" is a luxury hotel which is located in the city of Bandung.");
        postParams.putString("link", "https://developers.facebook.com/android");
        postParams.putString("picture", "http://www.jejaringhotel.com/android/hotelimages/hotel-3.jpg");
        Log.i("DIALOG","feed set");

        Request.Callback callback = new Request.Callback() {
            public void onCompleted(Response response) {
                FacebookRequestError error = response.getError();
                if (error != null) {
                    Toast.makeText(MapScreen.this, error.getErrorMessage(), Toast.LENGTH_SHORT).show();
                } else {
                    JSONObject graphResponse = response.getGraphObject().getInnerJSONObject();
                    String postId = null;
                    try {
                        postId = graphResponse.getString("id");
                    } catch (JSONException e) {
                        Log.i("Facebook error", "JSON error " + e.getMessage());
                    }
                    //TODO Toast.makeText(context, postId, Toast.LENGTH_LONG).show();
                    Toast.makeText(MapScreen.this, "Posted on wall success!", Toast.LENGTH_SHORT).show();
                }
            }
        };

        Request request = new Request(Session.getActiveSession(), "me/feed", postParams, HttpMethod.POST, callback);

        RequestAsyncTask task = new RequestAsyncTask(request);
        task.execute();
    } 
```

非常感谢李明的建议！谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T13:39:49.763

这是一个完整的指南： [https ://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/)

或使用我的新库：

[https://github.com/m3n0R/EasyFacebookConnect](https://github.com/m3n0R/EasyFacebookConnect)

# asp.net - 重用 ASP.NET 表单中的字段

> ID：15501859
> 
> 赞同：2
> 
> 时间：2013-03-19T14:12:26.170
> 
> 标签：asp.net

我有一个收集用户联系信息的在线表格。典型的东西——名字和姓氏、地址、城市、州、邮编等。

在此过程中的某一时刻，他们也可以为**另一个**人输入信息。那时，我会显示一个模式弹出窗口，其中包含与此人完全相同的字段。

我讨厌我的 ASCX 文件中字段的重复。我想定义一个字段块并在不同的上下文中显示它们。

情节的一个转折是站点的管理员可以配置两个上下文中的每一个都可以看到哪些字段。

例如，他们可能会为主要用户说，我们想询问电话号码，但我们不想为其他人显示该字段。在这种情况下，电话号码字段对主表单可见，但隐藏在模式弹出窗口中。

所以问题是：在 ASP.NET 表单的不同位置重用相同字段的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:14:08.697

您可以向用户控件添加另一个标志

注意：此标志必须声明为公共财产

```
public bool Flag 
{
  get;
  set;
} 
```

您的用户控制

第一个例子 ：`<UCTagPrefix:UCTagName runat="server" id="" Flag="true"/>`

二审：`<UCTagPrefix:UCTagName runat="server" id="" Flag="false"/>`

如果需要，您可以使用其他类型，此示例基于布尔值

在您的代码中使用您的标志值调整您的用户控件的行为

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:21:11.253

如果管理员想要配置每个字段的可见性，我认为最好将字段列表添加到数据库表中`fieldName, userType1 (bit), userType2 (bit),...`，然后添加值`0 or 1`（管理员可以通过界面执行此操作）。

当您加载控件时，通过将 userType 传递给数据库（存储过程或查询）并相应地设置每个字段的可见性来获取相应的值。

# wso2 - 事件列表中的 wso2 CEP 错误

> ID：15501862
> 
> 赞同：0
> 
> 时间：2013-03-19T14:12:33.047
> 
> 标签：wso2, complex-event-processing

这篇文章似乎很长，但这仅仅是因为数据（样本和错误）。

我正在尝试制作一个桶来模拟 cep 2.1.0 中的 buildFailed 示例。（此示例有效）。

我创建了自己的流和自己的示例数据。

然而，cep 的输入处理程序似乎对我的事件有问题。

到目前为止，我还没有发现问题。

流定义：

```
 {
    "name":"eu.ima.event.stream",
    "version": "1.2.0",
    "nickName": "poc sample",
    "description": "poc sample stream",
    "metaData":[
    {
        "name":"host",
        "type":"string"
    }
    ], 
   "correlationData":[
    {
        "name":"processus",
        "type":"string"
    },
    {
        "name":"flux",
        "type":"string"
    },
    {   
        "name":"reference",
        "type":"string"
    }
    ],   
 "payloadData":[
        {
                "name":"timestamp",
                "type":"string"
        },
        {       "name":"code",
                "type":"string"
        },
        {
                "name":"category",
                "type":"string"
        },
        {
                "name":"msg",
                "type":"string"
        }
    ]
} 
```

事件数据：

```
[
{
 "metaData" : ["192.168.1.2"] , 
 "correlationData" : ["PSOR", "Appli2", "Ref-1"] , 
 "payloadData" : ["1363700128138496600", "6", "BIZ", "6"] 
 }
 ,
{
 "metaData" : ["192.168.1.2"] , 
 "correlationData" : ["PSOR", "Appli2", "Ref-0"] , 
 "payloadData" : ["1363700126353394500", "6", "BIZ", "6"] 
 }
 ,
{
 "metaData" : ["192.168.1.2"] , 
 "correlationData" : ["PSOR", "Appli2", "Ref-3"] , 
 "payloadData" : ["1363700131731702100", "6", "BIZ", "6"] 
 }
 ,
{
 "metaData" : ["192.168.1.2"] , 
 "correlationData" : ["PSOR", "Appli2", "Ref-2"] , 
 "payloadData" : ["1363700129894597000", "6", "BIZ", "6"] 
 }
 ,
{
 "metaData" : ["192.168.1.2"] , 
 "correlationData" : ["PSOR", "Appli2", "Ref-4"] , 
 "payloadData" : ["1363700133472801700", "6", "BIZ", "6"] 
 }
] 
```

当我发送 streamdef 时，没有错误，也没有日志，除了管理员连接我们可能需要更多反馈。我使用 curl post 命令。

当我发送事件时出现错误：

```
[2013-03-19 14:58:00,586] ERROR {org.wso2.carbon.databridge.core.internal.queue.QueueWorker} -  Error in passing event eventList [
Event{
  streamId='eu.ima.event.stream:1.2.0',
  timeStamp=0,
  metaData=[192.168.1.2],
  correlationData=[PSOR, Appli2, Ref-1],
  payloadData=[1363700128138496600, 6, BIZ, 6],
  arbitraryDataMap=null,
}
,
Event{
  streamId='eu.ima.event.stream:1.2.0',
  timeStamp=0,
  metaData=[192.168.1.2],
  correlationData=[PSOR, Appli2, Ref-0],
  payloadData=[1363700126353394500, 6, BIZ, 6],
  arbitraryDataMap=null,
}
,
Event{
  streamId='eu.ima.event.stream:1.2.0',
  timeStamp=0,
  metaData=[192.168.1.2],
  correlationData=[PSOR, Appli2, Ref-3],
  payloadData=[1363700131731702100, 6, BIZ, 6],
  arbitraryDataMap=null,
}
,
Event{
  streamId='eu.ima.event.stream:1.2.0',
  timeStamp=0,
  metaData=[192.168.1.2],
  correlationData=[PSOR, Appli2, Ref-2],
  payloadData=[1363700129894597000, 6, BIZ, 6],
  arbitraryDataMap=null,
}
,
Event{
  streamId='eu.ima.event.stream:1.2.0',
  timeStamp=0,
  metaData=[192.168.1.2],
  correlationData=[PSOR, Appli2, Ref-4],
  payloadData=[1363700133472801700, 6, BIZ, 6],
  arbitraryDataMap=null,
}
] to subscriber org.wso2.carbon.broker.core.internal.brokers.agent.AgentBrokerType$AgentBrokerCallback@2d7fbbd6
java.lang.NullPointerException
        at org.wso2.carbon.cep.core.mapping.input.mapping.TupleInputMapping.getValue(TupleInputMapping.java:126)
        at org.wso2.carbon.cep.core.mapping.input.mapping.TupleInputMapping.convertToEventTuple(TupleInputMapping.java:97)
        at org.wso2.carbon.cep.core.mapping.input.mapping.InputMapping.convert(InputMapping.java:42)
        at org.wso2.carbon.cep.core.listener.TopicEventListener.onEvent(TopicEventListener.java:50)
        at org.wso2.carbon.cep.core.listener.BrokerEventListener.onEvent(BrokerEventListener.java:58)
        at org.wso2.carbon.broker.core.internal.brokers.agent.AgentBrokerType$AgentBrokerCallback.receive(AgentBrokerType.java:176)
        at org.wso2.carbon.databridge.core.internal.queue.QueueWorker.run(QueueWorker.java:80)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662) 
```

请任何人，你有什么提示吗？我真的需要这个来继续我的概念证明 CEP 项目。

最好的问候，西里尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T19:13:15.070

我已经查看了您上面提供的详细信息...但是如果没有存储桶配置和完整的错误日志，很难说出了什么问题...但是我已经检查了您上面给出的流定义和事件...它运行良好，没有任何问题...我希望您在创建存储桶时可能会犯一个简单的错误...这里我分享我创建的存储桶 xml（注意：更改输出主题中的电子邮件地址）

事件 json：链接 [1]

流 json：链接 [2]

存储桶 xml：链接 [3]

流的 curl 命令：

```
curl -k --user admin:admin https://localhost:9443/datareceiver/1.0.0/streams/ --data @streamdefn2.json -H "Accept: application/json" -H "Content-type: application/json" -X POST 
```

事件的 curl 命令：

```
curl -k --user admin:admin https://localhost:9443/datareceiver/1.0.0/stream/eu.ima.event.stream/1.2.0/ --data @events2.json -H "Accept: application/json" -H "Content-type: application/json" -X POST 
```

（请彻底按照文档 [4] 了解更多详细信息]

```
[1] https://docs.google.com/file/d/0B056dKd2JQGJa0pFaU1BTDlEbFk/edit?usp=sharing

[2] https://docs.google.com/file/d/0B056dKd2JQGJUFdUN21GRGpzY0k/edit?usp=sharing

[3] https://docs.google.com/file/d/0B056dKd2JQGJa0pFaU1BTDlEbFk/edit?usp=sharing

[4] http://docs.wso2.org/wiki/display/CEP210/Build+Analyzer 
```

希望这会帮助你...问候，莫汉

# opencv - 用opencv估计灰度图片的平均亮度

> ID：15501865
> 
> 赞同：1
> 
> 时间：2013-03-19T14:12:46.377
> 
> 标签：opencv

我有一张灰度图片，我只想将其转换为黑白。但为此，我需要计算正确的阈值，并且我希望该阈值等于图片的平均亮度。

所以，我想知道如何使用 OpenCV 计算该阈值。框架中是否存在一种方法可以轻松做到这一点？

我想为每个像素添加每个亮度值（0 到 255 之间），然后将总和除以像素本身的数量，但是我发现访问这些数据的方法非常慢（.at(i,j)[ k] 用于 RGB 图片）。但是我的图片是灰度的，我希望它很快，所以它可以在 iPhone 上运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T14:24:00.993

要计算这些统计数据，请使用`cv::sum()`，甚至更好，`cv::mean()`。

然而，OpenCV 已经有一个阈值函数，可以为你做所有你想做的事情： [cv::adaptiveThreshold()](http://docs.opencv.org/modules/imgproc/doc/miscellaneous_transformations.html?highlight=threshold#void%20adaptiveThreshold%28InputArray%20src,%20OutputArray%20dst,%20double%20maxValue,%20int%20adaptiveMethod,%20int%20thresholdType,%20int%20blockSize,%20double%20C%29)

此外，您应该查看 Otsu 的方法，请参阅`cv::threshold()`选项`THRESH_OTSU`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:24:01.367

您可以使用 Monte Carlo 算法，对随机点而不是所有图像点进行采样，直到覆盖了 1% 的图像。结果应该与实际值非常相似。

# wcf - 具有流式服务的 JAX-WS MTOM 的 WCF 客户端

> ID：15501867
> 
> 赞同：0
> 
> 时间：2013-03-19T14:12:53.757
> 
> 标签：wcf, jax-ws

我们有这样的 JAX-WS Web 服务：

```
public class NamedDataHandlerContainer {
    public String options; // format is option1_name=option1_value;option2_name=option2_value
    @XmlMimeType("application/octet-stream") public DataHandler dataHandler;
}

@WebService
public interface mtomserver {
    @WebMethod public int saveFile(String name,
    @XmlMimeType("application/octet-stream") List<NamedDataHandlerContainer> contents,
    @XmlMimeType("application/octet-stream") @WebParam(mode = WebParam.Mode.OUT) Holder<List<NamedDataHandlerContainer>> results);
} 
```

当使用 .NET 4.0 的 SvcUtil 处理该 Web 服务的 WSDL 时，它会为 NamedDataHandlerContainer.dataHandler 生成 byte[] 类型：

```
public partial class namedDataHandlerContainer;
{
    [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, Order = 0)]
    public string options;

    [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, DataType = "base64Binary", Order = 1)]
    public byte[] dataHandler;
} 
```

但是，在 App.config 中，它会生成 Mtom 工件：

```
<basicHttpBinding>
    <binding name="mtomserverImplPortBinding" messageEncoding="Mtom" maxReceivedMessageSize="1000000000" />
</basicHttpBinding> 
```

（我们添加了 maxReceivedMessageSize 以允许大型附件）。事实上，WCF 客户端向服务发送 MTOM 附件 - 我们正在转储 HTTP 有效负载并确认：

```
--uuid:394d798b-e43e-47cc-82dd-64e32ef51edd+id=1
Content-ID: <http://tempuri.org/0>
Content-Transfer-Encoding: 8bit
Content-Type: application/xop+xml;charset=utf-8;type="text/xml"

<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><saveFile xmlns="http://wsserver.mtomtest/"><arg0 xmlns="">myfile.bin</arg0><arg1 xmlns=""><options>my options from .NET</options><dataHandler><xop:Include href="cid:http://tempuri.org/1/634993057692269386" xmlns:xop="http://www.w3.org/2004/08/xop/include"/></dataHandler></arg1></saveFile></s:Body></s:Envelope>
--uuid:394d798b-e43e-47cc-82dd-64e32ef51edd+id=1
Content-ID: <http://tempuri.org/1/634993057692269386>
Content-Transfer-Encoding: binary
Content-Type: application/octet-stream

<binary content goes here> 
```

JAX-WS 可以成功地将流应用到此类有效负载。但是，有没有办法在 .NET 端实现流式传输？我已阅读 MSDN，其中明确表示可能只存在一个启用流式传输的参数。但是，有没有办法让自定义消息序列化程序（或自定义的东西，我不是 WCF 专家）并且仍然避免将整个有效负载加载到内存中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T18:01:15.377

WCF 具有启用流式传输的配置。您不需要编写任何额外的代码来实现这一点。

```
<basicHttpBinding>
    <binding name="mtomserverImplPortBinding" messageEncoding="Mtom" maxReceivedMessageSize="1000000000" transferMode="Streamed"/>
</basicHttpBinding> 
```

来源：http: [//msdn.microsoft.com/en-us/library/ms789010.aspx](http://msdn.microsoft.com/en-us/library/ms789010.aspx)

# git - 每次作业运行时，如何避免 cloudbees 克隆我的 github 存储库？

> ID：15501868
> 
> 赞同：0
> 
> 时间：2013-03-19T14:12:56.143
> 
> 标签：git, github, cloudbees

似乎每次我在 cloudbees 上的工作运行时，它们都会获得一个“新鲜”的工作空间。此时，它需要从 github 克隆 git 存储库。仓库很大，每次克隆都要几十分钟。

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:46:14.840

如果与上次使用的相同的云从站可用于运行您的构建，那么您的旧工作区将可用，并且 Jenkins 将仅更新您的源（类似于`git pull`）。但有时奴隶会因各种原因被回收或停止使用，工作空间被丢弃，在这种情况下将执行新的结账。

您无法具体控制这一点，尽管更频繁运行的作业不太可能需要新的结帐。

（我假设在构建日志的开头有一个简单的通知，即没有现有的检出，并且没有与 Git 相关的错误消息给出无法重用检出的具体原因。）

# wcf - 如何在一项服务或 DAL 中使用多个数据库 (MSSQL)？

> ID：15501871
> 
> 赞同：3
> 
> 时间：2013-03-19T14:13:04.503
> 
> 标签：wcf, sql-server-2008, entity-framework, architecture

我一直在浏览整个互联网上的几个不同的线程，要么我看不出所提出的解决方案对我有用，要么他们的特殊情况与我所处的情况不同。

目前有大约 8 个不同的自包含数据库，每个数据库都位于另一个自包含网站 (asp.net webforms) 后面。所有的数据库都非常小，并且服务于一个非常特殊的目的。也就是说，没有一个模式和设计以合理的方式真正匹配。有各种 GUID 标识了一个用户，这些用户最终都将映射到该用户的单个 guid，但它们之间的映射是不同的，有时您必须在几个数据库之间跳转才能从第三个数据库中获取您需要的内容。只是有点乱。

我想完全重构以将它们全部放在一个数据库中，以减少混淆和重复数据，但由于推回，解决方案必须使用我们现有的。

我想做的是创建一个层，所有这些数据库都可以在一个应用程序中访问（也许启动一个新站点并将其放在那里）。关于这个的几个问题：

1.  是否有一个简单的解决方案，我可以在每个数据库上利用实体框架并将它们都放在同一个应用程序中？

2.  像 WCF 服务这样我映射每个数据库需要完成的每个 CRUD 操作的东西会是一个有效的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:11:52.577

Entity Framework 中的每个 DBContext 都使用一个数据库，因此您的解决方案必须为每个数据库使用一个。我通常做的是`IContext`围绕`DBContext`实现 CRUD 操作创建一个，然后构建一个`Repository`执行“业务逻辑”（如`RegisterUser`）我操纵多个上下文的。IContext 应该表示一组相关的“数据库对象”（例如产品数据库的 IProductContext）。目前，每个数据库可能只有一个上下文。随着数据库的整合，只需将受影响上下文的连接字符串更改为新数据库，您就可以恢复并运行而无需太多（如果有的话）代码更改。

这是我在谈论的内容中找到的一个很好的介绍，尽管我认为这称为我的“上下文”存储库”和我的“存储库”“工作单元” [。http://www.asp.net/mvc/tutorials/开始使用 ef 使用 mvc/实现存储库和工作模式单元在一个 asp-net-mvc 应用程序中](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

也就是说，您可以编写一个抽象出多个 EF DBContext 的 WCF 服务，然后您可以在后端更改内容，同时继续使用相同的 Web 服务。

# wordpress - WordPress - 自定义帖子类型永久链接冲突

> ID：15501872
> 
> 赞同：1
> 
> 时间：2013-03-19T14:13:08.330
> 
> 标签：wordpress

我使用带有自定义帖子类型和自定义分类法的 WordPress。

**问题**

我尝试使用路径创建一个帖子，`/nyheter/bolag/post/`但它被重定向到`/bolag/post/`. 这是因为我有一个带有 slug 的自定义帖子类型，`bolag`而 WP 可能会尝试更正路径。

这是如何解决的？代码，插件？

**代码放在functions.php中**

```
<?php
add_action( 'init', 'create_post_type' );
add_action( 'init', 'register_taxonomies' );

function create_post_type() {
$args_bolag = array(
    'labels' => array(
        'name' => 'Bolag',
        'singular_name' => 'Bolag'
    ),
    'public' => true,
    'has_archive' => true,
    'rewrite' => array('slug' => 'bolag'),
);

$args_nyheter = array(
    'labels' => array(
        'name' => 'Nyheter',
        'singular_name' => 'Nyheter'
    ),
    'public' => true,
    'has_archive' => true,
    'rewrite' => array('slug' => 'nyheter'),
);

register_post_type( 'bolag', $args_bolag );
register_post_type( 'nyheter', $args_nyheter );
}

function register_taxonomies()
{
$args_firma = array(
    'label' => __( 'Firma' ),
    'rewrite' => array( 'slug' => 'nyheter/bolag' ),
    'hierarchical' => true,
);
register_taxonomy( 'firma', 'nyheter', $args_firma );
} 
```

# javascript - 如何在不刷新的情况下将新内容加载到 DIV

> ID：15501883
> 
> 赞同：1
> 
> 时间：2013-03-19T14:13:45.313
> 
> 标签：javascript, jquery, html, ajax, web-deployment

我想在不刷新整个页面的情况下将新内容从服务器加载到 DIV。我尝试了以下

```
$.ajax({
    type: "GET",
    url: "http://127.0.0.1:8000/result/?age="+ ageData +"&occasion="+ 
       occasionData     +"&relationship="+ forData +"#",
    success: function (response) {
        $("#testDIV").html(response);
    }
}); 
```

但问题是整个页面正在加载`<DIV id="testDIV">`。我想用从服务器返回的新 DIV 内容而不是整个页面替换旧 DIV。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:20:16.780

您可以保持对直接使用 AJAX 感兴趣并希望管理完成功能（而不是成功，因为[.done() 将替换它](http://api.jquery.com/jQuery.ajax/)）的相同过程感。这是如何...

```
 .done(function(data) {
    ...
    } 
```

在该 done 函数中，您可以将页面内容过滤为您想要的内容。只需像这样请求您要使用 jquery 过滤的内容...

```
var $response = $(data);
var response_title = $response.filter(".title").html(); //I'm assuming you are trying to pull just the title (perhaps an < h1 > tag, in this little example, from the entire external page! 
```

然后！...

```
$("#testDIV").html(response_title); 
```

使用 done 函数，基于[jQuery 的 API](http://api.jquery.com/jQuery.ajax/)，您可以使用这种格式...

```
$.ajax({
type: "POST",
url: "some.php",
data: { name: "John", location: "Boston" }
}).done(function( msg ) {
alert( "Data Saved: " + msg );
}); 
```

所以你的最终代码可能看起来像这样......

```
$.ajax({
    type: "GET",
    url: "ht.tp://127.0.0.1:8000/result/?age="+ ageData +"&occasion="+  occasionData     +"&relationship="+ forData +"#"})
    .done(function(response) {
    var $response = $(response);
    var response_title = $response.filter(".title").html(); 
    $("#testDIV").html(response_title);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:25:05.140

```
$(function(){
    $('.classloader.').on('click', function(e){

        $.ajax({
            type: "GET",
            url: "http://127.0.0.1:8000/result/?age="+ ageData +"&occasion="+ 
   occasionData +"&relationship="+ forData +"#",
            beforeSend:  function() {
                $("#testDIV").hide();
                $('div#loading').show();
            },
            success: function(html){
                $("#testDIV").html($(html).filter("#mainContent").html()).show();
                $('div#loading').hide();
            }
        });     
        return false;
    });
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:27:30.127

[我喜欢黑鹰](https://stackoverflow.com/users/957186/blachawk)的回答。它使用现有代码稍作修改。

我会把它浓缩成这样的一行更改：

```
$.ajax({
     type: "GET",
     url: "http://127.0.0.1:8000/result/?age="+ ageData +"&occasion="+ 
     occasionData+"&relationship="+ forData +"#",
     success: function (response) {
         $("testDIV").html($(data).filter(".title").html());
     }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:32:45.967

您显示的代码实际上是正确的。问题来自您的服务器提供的内容。

您在这里所做的是通过 AJAX 调用获取**整个页面，并将****One div**的内容替换为整个页面。

您的服务器不应为该调用呈现整个页面，而应仅呈现您希望替换的 div 的内容。如果您使用的是 rails 或 symfony 之类的框架，它们通常会提供一种简单的方法来检测查询是普通的 GET 请求还是 AJAX 调用。

基本上，您有 4 种策略可供您使用：

1.  向仅用于 ajax 调用并返回您希望替换的 div 内容的特定端点发出请求。而不是整个页面。
2.  向同一页面发出请求，并检测该请求是正常的 HTTP 请求还是 AJAX 调用。基于此，返回整个页面或仅返回 div 的内容。您可能必须在您的框架/工具箱文档中寻找帮助程序。
3.  发出 AJAX 请求，但请求一个 JSON 对象。在客户端将您的 JSON 转换为 HTML 以替换 div 的内容。这是“我的应用程序只是一个 API”的方法。这是我个人最喜欢的，因为这个 JSON 端点可以用于其他目的（例如：移动应用程序），因为它只承载内容，而不是演示。就性能而言，这也往往是最快的方式，因为很大一部分计算是在客户端完成的。另一方面，这需要你编写更多的 JS。
4.  始终呈现整个页面，并仅在客户端过滤您需要的内容。这是balchawk方法。好处是您不必修改您的服务器，但是当您只需要一个子集时，您会返回整个页面来浪费处理时间和带宽。

# java - java.util.Collections 上的 Java 泛型警告

> ID：15501884
> 
> 赞同：13
> 
> 时间：2013-03-19T14:13:47.893
> 
> 标签：java, generics, collections

我有一个方法：

```
public List<Stuff> sortStuff(List<Stuff> toSort) {
    java.util.Collections.sort(toSort);

    return toSort;
} 
```

这会产生一个警告：

```
Type safety: Unchecked invocation sort(List<Stuff>) of the generic method sort(List<T>) of type Collections. 
```

Eclipse 说修复警告的唯一方法是添加`@SuppressWarnings("unchecked")`到我的`sortStuff`方法中。对于 Java 本身内置的东西，这似乎是一种糟糕的方式。

这真的是我唯一的选择吗？为什么或者为什么不？提前致谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-03-19T14:16:23.663

[`Collections.sort(List<T>)`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)期望`T`必须实施`Comparable<? super T>`。似乎`Stuff`确实实现`Comparable`但不提供泛型类型参数。

确保声明这一点：

```
public class Stuff implements Comparable<Stuff> 
```

而不是这个：

```
public class Stuff implements Comparable 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-19T14:36:48.207

Do tou use this:

```
// Bad Code
public class Stuff implements Comparable{

    @Override
    public int compareTo(Object o) {
        // TODO
        return ...
    }

} 
```

or this?

```
// GoodCode
public class Stuff implements Comparable<Stuff>{

    @Override
    public int compareTo(Stuff o) {
        // TODO
        return ...
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:28:23.803

您将需要更改方法的返回类型

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:31:57.763

[对通用集合进行排序](http://encodo.com/en/blogs.php?entry_id=21)

该类中定义了两个排序函数，如下所示：

```
public static <T extends Comparable<? super T>> void sort(List<T> list);

public static <T> void sort(List<T> list, Comparator<? super T> c); 
```

Neither one of these is exactly easy on the eyes and both include the wildcard (?) operator in their definitions. The first version accepts a List only if T extends Comparable directly or a generic instantiation of Comparable which takes T or a superclass as a generic parameter. The second version takes a List and a Comparator instantiated with T or a supertype.

# vb.net - 未处理格式异常

> ID：15501885
> 
> 赞同：0
> 
> 时间：2013-03-19T14:13:54.133
> 
> 标签：vb.net, visual-studio-2010

```
 Dim labor, material, partstotal, labortotal, subtotal, tax, total As Decimal
    material = Decimal.Parse(AmountTextBox.Text)
    labor = Decimal.Parse(LaborTextBox.Text)

    partstotal = material
    labortotal = labor * 50
    subtotal = labortotal + partstotal
    tax = subtotal * 0.08
    total = subtotal + tax

    partstotal = Decimal.Parse(PartsTextBox.Text)
    labortotal = Decimal.Parse(LaborTextBox.Text)
    subtotal = Decimal.Parse(SubTotalTextBox.Text)
    tax = Decimal.Parse(SalesTaxTextBox.Text)
    total = Decimal.Parse(TotalTextBox.Text) 
```

material = Decimal.Parse(AmountTextBox.Text) 不会运行。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:42:04.647

我认为 GregC 的意思是你需要使用这样的代码：

```
Dim material As Decimal
If Not Decimal.TryParse(AmountTextBox.Text, material) Then
    ' the text in AmountTextBox could not be parsed as
    ' a Decimal.
    'TODO: do something about it.
End If 
```

尽管要验证的项目很多，但您可以通过使用[ErrorProvider 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)来提供更好的用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:16:06.523

文本框中的字符串值是什么？

[TryParse()](http://msdn.microsoft.com/en-us/library/ew0seb73.aspx)将返回错误而不是抛出。试试那个。

# java - 为什么我的 onPrepareOptionsMenu 没有被调用？

> ID：15501890
> 
> 赞同：5
> 
> 时间：2013-03-19T14:14:14.180
> 
> 标签：java, android

```
public class BFragmentTab extends Fragment {

    @Override
     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
            // Inflate the layout for this fragment
            return inflater.inflate(R.layout.recents, container, false);
     }

    @Override
    public void onPrepareOptionsMenu(Menu menu) {
        menu.clear();
        MenuItem filter = menu.findItem(R.id.filter);
        MenuItem refresh = menu.findItem(R.id.refresh);
        //depending on you conditions, either enable/disable
        filter.setEnabled(false);
        refresh.setEnabled(false);
        super.onPrepareOptionsMenu(menu);
    }
} 
```

我试图`onPrepareOptionsMenu`在我的 Fragment 类中调用我，但它没有被调用。`action tab`当我单击`action bar`.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-19T14:16:45.290

调用方法`setHasOptionsMenu(true)`_`onAttach`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-18T07:19:38.707

我遇到了同样的错误，在我的情况下，我的 xml 布局文件中有一个子活动的错误。

令人惊讶的是 Eclipse 没有显示错误，但是在删除它之后，程序运行了。

# cloudbees - 在 Cloudbees 上运行 Web 应用程序时出现问题

> ID：15501893
> 
> 赞同：0
> 
> 时间：2013-03-19T14:14:24.007
> 
> 标签：cloudbees

我正在尝试从部署在 cloudbees 上的应用程序访问一项服务，但收到 500 错误和一个大堆栈跟踪。它失败是因为它无法打开 JPA EntityManager 由于 CommunicationsException: Communications link failure due to basic exception: ... java.net.SocketException: java.net.ConnectException: Connection denied 。

数据库配置似乎很好，因为 Jenkins 上的测试成功地从 cloudbees 连接到数据库并插入数据。

如果我在 localhost 上进行部署（并使用本地 mysql），所有服务都可以正常工作。

谁能建议可能是什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:09:38.100

无需额外配置即可修复 - 只需新部署。

# c# - 为什么 `Trace.Writeline()` 缺少 `WriteLine(string format, params Object[] args)` 重载？

> ID：15501897
> 
> 赞同：1
> 
> 时间：2013-03-19T14:14:35.070
> 
> 标签：c#, .net

[Debug.WriteLine()](http://msdn.microsoft.com/en-gb/library/cc190153.aspx)具有以下签名的重载：

`public static void WriteLine(string format, params Object[] args)`

[Trace.WriteLine()](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.writeline%28v=vs.100%29.aspx)没有该重载（尽管它具有所有其他重载`Debug.WriteLine()`）。

有谁知道这个遗漏的原因？

我想我没有理由自己避免它？（我之所以这么问，是因为我正在实现一个日志接口，而默认实现只会使用`Debug.WriteLine()`并且`Trace.WriteLine()`我想知道任何奇怪的后果。我无法想象。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:26:02.297

*好吧*，我不确定我说什么，但我有机会。

当我反编译这些方法时，它们都使用相同的`TraceInternal.WriteLine(string)`方法。

当我反编译时`Debug.WriteLine Method (String, Object[])`；

```
public static void WriteLine(string format, params object[] args)
{
   TraceInternal.WriteLine(string.Format((IFormatProvider) CultureInfo.InvariantCulture, format, args));
} 
```

当我反编译时`Trace.WriteLine(string)`；

```
public static void WriteLine(string message)
{
   TraceInternal.WriteLine(message);
} 
```

如您所见，唯一不同的是，第一个使用`string.format()`方法。看来对我来说没什么大不了的。。

但是*为什么会遗漏*呢？我不知道。正如 ken2k[*提到*](https://stackoverflow.com/questions/15501897/why-does-trace-writeline-lack-the-writelinestring-format-params-object#comment21949412_15502160)的，我相信只有基类库开发人员才能完全回答这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T14:44:41.737

我发现了一个不应该在自己的代码中添加这样一个接口的原因：因为它具有误导性。

乍一看，我以为

`Debug.WriteLine("Value = {0}", "Test");`

会打印：

`Value = Test`

但实际上它打印：

`Test: Value = {0}`

之所以如此具有误导性，是因为有很多类似的方法可以进行这样的格式化，例如`string.Format()`,`Console.WriteLine()`等等。

所以真的，应该避免这种误导性的功能，恕我直言。

这并不能真正直接回答我原来的问题——但它解释了为什么该方法最初不在.Net 中。它没有解释为什么他们在以后的版本中添加了它。我现在认为他们不应该这样做。

（我现在通过复制 NLog 所做的事情来规避代码中的问题 - 我需要将类名（通过工厂方法）传递给我的日志记录类的构造函数，以便类名永远不会传递给任何消息格式化程序。）

# html - Firefox 和 Chrome 中的相对 URL

> ID：15501903
> 
> 赞同：1
> 
> 时间：2013-03-19T14:14:50.577
> 
> 标签：html, url, cross-browser

我有一个 Web 应用程序，我在其中显示一些媒体。我最初有一段 HTML 像

```
 <video id="video" class="video-player">
        <source src="media/foo.mp4"/>
    </video> 
```

显示在“/shows/”页面上。

这个绝对 URL 在 Chrome 中被翻译为“/media/foo.mp4”，但 Firefox 将其翻译为“/shows/media/foo.mp4”。我知道我可以通过将 / 放在相对 URL 的开头来简单地解决这个问题，但问题是：

使用相对 URL 时我应该注意什么？还有其他关于跨浏览器兼容性的问题吗？

# jquery - 获取具有特定 .data() 值的行数

> ID：15501904
> 
> 赞同：2
> 
> 时间：2013-03-19T14:14:51.993
> 
> 标签：jquery, asp.net

我有一张桌子，几行有 class `SomeClass`。对于其中几行（具有类），我`.data("MyKey")`为每一行存储不同的值。我需要类 as`SomeClass`和`.data("MyKey")`as的行数`MyValue`。

我试过这样的事情：

```
$("#tbl tr.SomeClass").data('MyKey') == "MyValue" //.length 
```

但我知道这是错误的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:18:17.410

您可以使用`filter`方法：

```
var count = $('#tbl tr.SomeClass').filter(function(){
      return $(this).data('MyKey') === 'MyValue';
}).length; 
```

或`Attribute Equals`选择器：

```
$("#tbl tr.SomeClass").filter('[data-MyKey="MyValue"]').length; 
```

# php - 将查询结果存储在变量中

> ID：15501913
> 
> 赞同：0
> 
> 时间：2013-03-19T14:15:09.540
> 
> 标签：php, variables

我有一个表格，人们可以订阅或取消订阅时事通讯（这有效）。问题是，当我想将数据插入数据库时​​，我遇到了问题。表格本身是这样的：

```
<form action="subscriptionsedit2.php?CusID=&lt;?=$_GET[">
    " name="frmEdit" method="post"&gt; <?php  
    $objConnect = mysql_connect("localhost","root","root") or  die(mysql_error());  
    $objDB = mysql_select_db("NAW");  
    $strSQL1 = "SELECT ID, Titel FROM Mail";
    $strSQL = "SELECT * FROM Klant WHERE ID =  '".$_GET["ID"]."' "; 
    $objQuery = mysql_query($strSQL);  
    $objQuery1 = mysql_query($strSQL1); 
    $objResult = mysql_fetch_array($objQuery);
    if(!$objResult)  
    {  
    echo "Not found ID=".$_GET["ID"];  
    }  
    else  
    {  
    ?>

    <fieldset>
        <legend>Wijzig</legend>

        <table width="600" border="1">
            <tr>
                <th width="91">
                    <div align="center">
                        ID
                    </div>
                </th>
            </tr>

            <tr>
                <td>
                    <div align="center">
                        <?=$objResult["ID"];?>
                        </div>
                </td>
            </tr>
        </table><br>

        <table width="600" border="1">
            <tr>
                <th width="91">
                    <div align="center">
                        ID
                    </div>
                </th>

                <th width="91">
                    <div align="center">
                        Subscribe
                    </div>
                </th>

                <th width="91">
                    <div align="center">
                        Unsubscribe
                    </div>
                </th>
            </tr><?php 
            $i = 0;  
            while($objResult1 = mysql_fetch_array($objQuery1))  
            {  
            $i++;  
            ?>

            <tr>
                <td>
                    <div align="center">
                        <?=$objResult1["ID"];?>
                        </div>
                </td>

                <td>
                    <div align="center">
                        <input type="checkbox" name="sub" value="10">
                    </div>
                </td>

                <td>
                    <div align="center">
                        <input type="checkbox" name="sub" value="90">
                    </div>
                </td>
            </tr><?php  
            }  
            ?>
        </table>
    </fieldset><!-- content --><input type="submit" name="submit" value="Submit"> <input type="button" name="cancel" value="Cancel" onclick="window.location='klanten.php'"> <?php  
    }  
    mysql_close($objConnect); 
    ?>
</form> 
```

在 subscriptionsedit2.php 上，数据会像这样插入到数据库中：

```
mysql_connect('localhost','root','root');
mysql_select_db('NAW') or die (mysql_error());

$Klant_ID = $objResult["ID"];
$Mail_ID = $objResult1["ID"];
$Status = $_POST['sub'];
$Datum = date("d-m-y");

$sql = mysql_query("INSERT INTO Subscriptions (Klant_ID, Mail_ID, Status, Datum) VALUES ('".$Klant_ID."', '".$Mail_ID."', '".$Status."', '".$Datum."')") or die (mysql_error()); 
```

这是我得到的错误： 注意：未定义变量：第 16 行 /var/www/Mail/subscriptionsedit2.php 中的 objResult 注意：第 17 行 /var/www/Mail/subscriptionsedit2.php 中的未定义变量：objResult1

如您所见，变量 $Klant_ID 和 $Mail_ID 没有任何值。所以我的问题是如何正确地将 Klant_ID ( `<?=$objResult["ID"];?>`) 和 Mail_ID ( `<?=$objResult1["ID"];?>`) 存储到变量中？我希望这个问题足够清楚，但是如果您对此有任何疑问，请发表评论^^。如果有人知道如何做到这一点，那就太好了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:40:39.990

BTW mysql、mysqli 或 PDO，`$objResult["ID"]`提交表单时不存在！

它必须通过您的表单与 post var 一起传输。

在提交表单时，您必须执行以下操作来传输您的变量：

```
<input type"text" name="objResult" value="<?php echo $objResult["ID"]; ?>" /> 
```

然后你可以在你的`subscriptionsedit2.php`with中访问它`$_POST['objResult']`

**编辑**

如果您不想显示它，请隐藏此输入：

```
<input type"hidden" name="objResult" value="<?php echo $objResult["ID"]; ?>" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:25:15.653

您的应用程序非常容易受到注入攻击。

首先，从不，从不，永远不要在你的 SQL 语句中使用原始值`$GET_`和值。`$POST_`

其次：使用`mysqli_`而不是`mysql_` -`mysql_`已被弃用并被删除。

第三：如果*必须*使用`mysql_`，请确保使用[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)

第四：如果您要插入数据库中的整数字段，请不要在值周围使用引号。

第五：我不确定您的各种代码片段在哪里相互关联，但请尝试将`$Klant_ID`和的值转储`$Mail_ID`到日志文件中，这样您就可以确保它们实际上具有其中的值。问题可能出在代码的早期，而不是 SQL 语句区域本身。

# ios - iOS上基于时间的UUID（版本1）？

> ID：15501914
> 
> 赞同：2
> 
> 时间：2013-03-19T14:15:11.870
> 
> 标签：ios, uuid

我们如何使用 iOS 创建 RFC 4122 投诉 UUID（版本 1，基于时间）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:25:17.870

这是and使用的底层库的[手册页](https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/uuid_generate_time.3.html)。它包含基于时间的创建功能：`CFUUID``NSUUID`

```
#include <uuid/uuid.h>

uuid_generate_time(uuid_t); 
```

它也包含在 iOS 中。

# asp.net - HTTP 响应根据请求是本地的还是远程的而有所不同

> ID：15501915
> 
> 赞同：2
> 
> 时间：2013-03-19T14:15:14.313
> 
> 标签：asp.net, http, iis

如果我在本地发出请求（POST [http://localhost:8790/blah/]），我会得到以下响应标头：

```
Cache-Control   private
Content-Length  32
Content-Type    application/json
Date    Tue, 19 Mar 2013 13:59:34 GMT
Server  Microsoft-IIS/7.5
X-AspNet-Version    4.0.30319
X-AspNetMvc-Version 4.0
X-Powered-By    ASP.NET 
```

如果我远程发出请求（POST [http://123.456.1789:8790/blah/]），我会得到以下响应标头：

```
Cache-Control   private
Content-Length  11
Content-Type    text/html
Date    Tue, 19 Mar 2013 14:08:40 GMT
Server  Microsoft-IIS/7.5
X-AspNet-Version    4.0.30319
X-AspNetMvc-Version 4.0
X-Powered-By    ASP.NET 
```

POST参数比较肤浅：name=value1&name2=value2

如您所见，内容类型不同，因此返回的数据也不同。

有谁知道发生了什么？

编辑本地请求

```
Accept  application/json
Accept-Encoding gzip, deflate
Accept-Language en-US,en;q=0.5
Cache-Control   no-cache
Connection  keep-alive
Content-Length  36
Content-Type    application/x-www-form-urlencoded; charset=UTF-8
Cookie  blah=blah;
Host    localhost:8790
Pragma  no-cache
Referer [http://localhost:8790/blah/]
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
X-Requested-With    XMLHttpRequest 
```

远程请求

```
Accept  application/json
Accept-Encoding gzip, deflate
Accept-Language en-US,en;q=0.5
Cache-Control   no-cache
Connection  keep-alive
Content-Length  36
Content-Type    application/x-www-form-urlencoded; charset=UTF-8
Cookie  blah=blah;
Host    123.456.1789:8790
Pragma  no-cache
Referer [http://123.456.1789:8790/blah/]
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
X-Requested-With    XMLHttpRequest 
```

# visual-c++ - 捕获 USB 中文件的 fwrite 和 fread 异常，并在进程进行时删除 USB

> ID：15501916
> 
> 赞同：0
> 
> 时间：2013-03-19T14:15:16.730
> 
> 标签：visual-c++, windows-ce

我正在写入 USB 中的文件，并且在进行过程中我删除了 USB。在代码中，我使用 fwrite 写入文件。我放了一个 try{} catch(...){} 块来处理异常。异常没有被抓住。

我需要从 USB 升级固件。所以我使用 fread 从文件中读取一大块数据并将命令发送到模块。在阅读过程中，我移除了 USB。相同的 try{} catch(...){} 块来处理异常。但异常没有被gettign捕获

谢谢阿杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:06:27.293

请参阅以下链接以了解 WinCE 中的异常以及如何跟踪异常。

[Windows CE：查找数据中止的原因](http://geekswithblogs.net/BruceEitman/archive/2008/05/19/windows-ce--finding-the-cause-of-a-data-abort.aspx)

# sql - 基于计算字段的所有值的总和

> ID：15501919
> 
> 赞同：1
> 
> 时间：2013-03-19T14:15:22.413
> 
> 标签：sql, ms-access, select, sum

我正在尝试根据每月的股票销售额来选择单个员工赚取的佣金总额。，我有三个表（tbl_carForSale、tbl_Commision 和 tbl_employee）。

我可以得到员工已售出的所有汽车的总价值，但我想做的是能够计算出员工本应获得的佣金总额（这是一个可变佣金，基于关于产品的价格）例如，如果产品是 1000 英镑，则佣金金额为 1%（计算这是通过从产品表中获取产品价格，然后计算它是否介于最小值和最大值并返回佣金）。

```
SELECT tbl_carForSale.name as 'employee Name', SUM(tbl_carForSale.carPrice) AS    
value of cars sold'   
INNER JOIN tbl_carForSale ON tbl_employee.employeeNo = tbl_carForSale.employeeNo
WHERE tbl_carForSale.soldDate BETWEEN  DATEADD("m", -1 ,Date()) AND Date() AND
tbl_carForSale.bolSold = true 
GROUP BY tbl_employee.name 
```

**bolSold - 是一个真/假字段，指示汽车是否已被标记为“已售出”。

我知道我需要使用嵌套的 select 语句，但我真的不知道如何总结佣金和汽车价格？我猜我可以用两个语句来做到这一点 - 但我根本不确定..

编辑： Com 表：

```
ComNo   minValue    maxValue    comAvliable
0            0           5000          2
1            5001       10000          3
2            10001      15000          4
3            15001   99999999          5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:33:27.410

我认为您可以加入 Com 表并获得您的价值观。通过使用条件连接连接 Com 表，返回所需的 comAvailable 百分比。然后对 * carPrice 求和：

```
SELECT tbl_carForSale.name as 'employee Name', 
    SUM(tbl_carForSale.carPrice) AS    'value of cars sold'   
    SUM(tbl_carForSale.carPrice * tc.comAvailable) AS    'commission on cars sold'   
INNER JOIN tbl_carForSale ON 
    tbl_employee.employeeNo = tbl_carForSale.employeeNo
INNER JOIN tbl_Com tc ON 
    tbl_carForSale.carPrice >= tc.minValue 
    and
    tbl_carForSale.carPrice <= tc.maxValue    
WHERE tbl_carForSale.soldDate BETWEEN  DATEADD("m", -1 ,Date()) AND Date() AND
tbl_carForSale.bolSold = true 
GROUP BY tbl_employee.name 
```

您需要注意的是 Com 表中的数据。如果 INNER JOIN tbl_Com tc 为 carPrice/comAvailable 映射返回多于一行，那么它将产生错误

# c# - 切换飞行模式 monotouch xamarin

> ID：15501923
> 
> 赞同：3
> 
> 时间：2013-03-19T14:15:31.840
> 
> 标签：c#, objective-c, xamarin.ios, xamarin

注意：这不是 App Store 的应用程序，所以使用私有 API 对我来说不是问题。

我一直在尝试根据这个 SO 问题使用 Xamarin/Monotouch 关闭和重新打开飞行模式：[如何使用私有 API 在 IOS 5.1 中打开/关闭飞行模式](https://stackoverflow.com/questions/10452640/how-to-turn-on-off-airplane-mode-in-ios-5-1-using-private-api)

我很难让这段代码在单点触控中运行——我尝试的第一件事是使用单点触控绑定项目创建一个本机目标 C 库。

使用了 AppSupport 框架，所以我的链接文件如下：

```
[assembly: LinkWith ("libAirplaneModeLib.a", LinkTarget.ArmV7, ForceLoad = true, Frameworks = "AppSupport")] 
```

当我这样做时，它会编译，但我无法从我的主项目中引用命名空间。如果我不包括以下框架：

```
[assembly: LinkWith ("libAirplaneModeLib.a", LinkTarget.ArmV7, ForceLoad = true)] 
```

在这种情况下，我可以引用命名空间，但主项目在链接时编译：

```
 "_OBJC_CLASS_$_RadiosPreferences", referenced from:
      objc-class-ref in libAirplaneModeLib.a(AirplaneModeLib.o)
ld: symbol(s) not found for architecture armv7
collect2: ld returned 1 exit status

error MT5202: Native linking failed. Please review the build log. 
```

我的 ApiDefinition 文件如下：

```
[BaseType(typeof(NSObject))]
public interface AirplaneModeLib
{
    [Export("toggleAirplane")]
    void ToggleAirplane ();
} 
```

原生库如下：

```
#import "AirplaneModeLib.h"
#import "RadiosPreferences.h"

@implementation AirplaneModeLib

- (void) toggleAirplane {
    RadiosPreferences* preferences = [[RadiosPreferences alloc] init];
    preferences.airplaneMode = NO;
    [preferences synchronize];

    preferences.airplaneMode = YES; 
    [preferences synchronize];
    [preferences release];        
}

@end 
```

有没有更好或更简单的方法来做到这一点？如果没有，谁能建议我目前的方法做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:55:54.223

看来我已经解决了。由于某种原因，绑定项目无法引用 AppSupport 框架（或者可以，通过某种我不知道的方法）

在我的主项目中，我手动添加了额外的构建参数

```
-gcc_flags "-F /path/to/framework -framework AppSupport" 
```

它现在编译得很好。仍然没有切换飞行模式，但我猜这是一个单独的问题......

似乎即使此代码将运行，它也不会切换飞行模式。据我所知，在 iOS 5+ 中没有越狱设备无法做到这一点。

# python - 解析推文时无法读取所有 json 格式的文本？

> ID：15501927
> 
> 赞同：-1
> 
> 时间：2013-03-19T14:15:41.107
> 
> 标签：python

我尝试使用python编写python程序以json文件格式（不包括转发）在推文中提取文本。以下是python中的snippcode（文件很大20MB，所以这里不包括在内）。

```
import sys
import difflib
import twitter
import json
from pprint import pprint

# Input argument is the filename of the JSON ascii file from the Twitter API

filename = sys.argv[1]
tweets_text = [] # We will store the text of every tweet in this list
tweets_location = [] # Location of every tweet (free text field - not always `enter code here`accurate or given)
tweets_timezone = [] # Timezone name of every tweet

# Loop over all lines
f = file(filename, "r")
lines = f.readlines()
for line in lines:
    try: 
        tweet = json.loads(line)

        # Ignore retweets!
        if (tweet[1].has_key('retweeted_status') or not ( tweet[1].has_key('text'))): 
            continue

            # Fetch text from tweet
            text = tweet[1]['text'].encode('utf-8','ignore').lower()

            # Ignore 'manual' retweets, i.e. messages starting with RT      
            if text.find("RT ") > -1:
                continue

        tweets_text.append( text )
        tweets_location.append( tweet[1]['user']['location'].encode('utf-8','ignore') )
        tweets_timezone.append( tweet[1]['user']['time_zone'].encode('utf-8','ignore') )

    except ValueError:
        pass

# Show result
print tweets_text 
```

问题是我只收到一条推文。任何人都可以指出错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:06:52.837

您正在逐行读取 json 文件，并且正在加载每一行，就好像它是有效的 JSON 一样，但它可能不是。尝试类似：

```
 lines = f.readlines()
    tweet = json.loads(lines) 
```

从那里您应该能够通过推文访问所有 J​​SON 元素

[编辑：假设您的 JSON 具有与https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline](https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline)返回的相同结构

您可以执行以下操作：

```
 f = file(filename,"r")
    lines = f.readlines()
    tweets_json = json.loads(lines[0])
    for tweet in tweets_json:
        if tweet['retweeted'] == False:
            tweets_text.append(tweet['text'])

    print tweets_text 
```

# javascript - Angular.js - 当前在 ng-repeat 中选择的选项的值

> ID：15501930
> 
> 赞同：2
> 
> 时间：2013-03-19T14:15:49.430
> 
> 标签：javascript, angularjs, ng-repeat

我有条目，他们的 json 对象看起来有点像这样

```
{ 
    'id': 5,
    'activityId': 1
} 
```

然后我有活动，他们的 json 对象看起来像这样

```
{
    'id': 1,
    'name': 'Activity name',
    'rate': 1200
} 
```

现在我正在渲染这样的条目

```
<tr ng-repeat="entry in entries">
    <td>
        <activities></activities>
    </td>
    <td>
        // here's supposed to be the rate
    </td>
</tr> 
```

其中活动是一个看起来像这样的指令

```
app.directive("activities", function() {
    return {
        restrict: 'E',
        template: '<select ng-model="entry.activityId" ng-options="a.id as a.name for a in activities"></select>'
    }
}); 
```

现在我需要做什么才能在我的 ng-repeat 中打印速率？因为它是指令内部某些东西的属性，但我需要将它打印在指令之外。

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:37:21.827

你可以使用：

```
{{(activities | filter:{id: entry.activityId})[0].rate}} 
```

虽然我觉得这有点难看。更好的方法是将活动直接添加为实体的属性，可能在加载两个数据集之后。另一种方法是自制过滤器，它也检查错误（例如，未找到活动 ID 等）。

[http://plnkr.co/edit/4ljEdDFPBpOzueFuI6FT](http://plnkr.co/edit/4ljEdDFPBpOzueFuI6FT)

# jquery - jquery ui：无法在初始化之前调用对话框上的方法；试图调用方法“关闭”

> ID：15501932
> 
> 赞同：21
> 
> 时间：2013-03-19T14:15:54.127
> 
> 标签：jquery, jquery-ui

我正在使用 jquery ui 对话框，我从 jquery ui 网站下载它，版本是 jquery-ui-1.10.2.custom.min.js，jquery 是 jquery-1.9.1.js，它与 jquery ui js 捆绑在一起，但是现在我遇到一个问题：当打开对话框并单击保存按钮时，我希望关闭对话框，这是我的代码：

```
$(function(){
 $("#dialog-form").dialog({
     autoOpen: false,
     height: 350,
     width: 450,
     modal: true,
     buttons: {
       "save": function() {
           if(!checkDept()){
               return ;
           }
           $.post('dept_save.do', 
                 {'dept.deptId':$("#dialog_dept_deptId").val(), 
                  'dept.deptName':$("#dialog_dept_deptName").val(),
                  'dept.manager':$("#dialog_dept_manager").val(),
                 },function(data, status, xhr){
                     if(status == 'success'){
                         alert('save success');
                         $(this).dialog("close");
                     }else{
                         alert('error:'+data);
                     }
                  }
                 ,"json");
       }
     },
     close: function() {
         $(this).dialog("close");
     }
   });

     /* to open dialog*/
    $("#add").click(function(){
        $("#dialog-form").dialog("open");
    }); 
```

现在当我关闭“保存成功”弹出对话框时，`dialog-form`对话框没有关闭，并且发生错误：

> 未捕获的错误：无法在初始化之前调用对话框上的方法；试图调用方法“关闭”jquery-1.9.1.js:507。

还有另一个错误：

> Uncaught SyntaxError: Unexpected token o jquery-1.9.1.js:541

谢谢。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-19T14:18:58.887

`this`一旦你在里面，你就会失去上下文`$.post()`。在 $.post 之前，将上下文保存在该*保存*按钮函数`this`内的变量中。

 *```
$('#dialog-form').dialog({
     // .....
     buttons: {
        'save': function() { 

            var $this = $(this); 
                      // -this- is still the original context 
                      // of $("#dialog-form")

            $.post({
               /// ...
               $this.dialog('close'); // <-- used here
            });
        }       
    }
}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-19T13:50:19.360

当您通过调用该`.dialog(options)`方法初始化对话框时，会创建一个新对话框，但它与您要转换为对话框的原始 div 无关（示例代码中的“#dialog-form”）。该`dialog(options)`函数返回包含对话数据的元素。所以，如果你这样做：

```
var myDialog = $("#dialog-form").dialog(options); 
```

然后，您可以像这样调用 open 方法：

```
myDialog.dialog('open'); 
```

如果你想找到包含对话框的元素，它是最接近“ui-dialog-content”类的 div：

```
var myDialog = $('#dialog-form').closest('div.ui-dialog-content'); 
```

对话框数据是`uiDialog`您查看此元素数据时将看到的数据：

```
myDialog.data(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-19T14:18:38.250

`$(this)`不是针对 内部的对话框`$.post`，您需要存储对它的引用。

```
var self = this; // add this
$.post(..., function(){
    $(self).dialog("close"); // modify this to use self 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-14T04:43:45.527

我必须执行以下操作才能关闭我的对话框。

```
 $("#Note").dialog({
        autoOpen: true,            
        modal: true,
        create: function (e, ui) {
          //
        },
        open: function () {
            //
        },            
        buttons: {
                //
                $(".ui-dialog-titlebar-close").trigger('click');
            }
        }
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-03T01:50:08.700

可能导致此错误的另一件事是，如果出于任何原因您在对话框上调用 removeData()。显然 jquery data() 函数用于初始化对话框，因此如果出于任何原因删除了数据，对话框将不会认为它已被初始化。

当我使用 data() 函数将表单数据存储在对话框对象中，然后在关闭对话框之前在对话框上调用 removeData() 时，我发现了这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-23T17:12:03.257

您可能使用了弹出窗口而不是对话框。我认为关闭两者的方法是不同的。尝试使用`$("#popid").popup('close');`*

# vb.net - 无法解压缩我使用 BZip2 压缩的文件

> ID：15501934
> 
> 赞同：0
> 
> 时间：2013-03-19T14:15:57.097
> 
> 标签：vb.net, compression, bytearray, sharpziplib

我有一个使用 BZip2 压缩文件然后将其保存到新文件的程序。

```
Public Sub Create(ByVal outPathname As String, ByVal filePath As String)
    Dim msCompressed As New MemoryStream()
    Dim zosCompressed As New BZip2OutputStream(msCompressed)
    Dim fileInput As New FileStream(filePath, FileMode.Open)
    Dim buffer As Byte() = GetStreamAsByteArray(fileInput)
    zosCompressed.Write(buffer, 0, buffer.Length)
    zosCompressed.Flush()
    zosCompressed.Close()
    buffer = msCompressed.ToArray()
    Dim FileOutput As New FileStream(outPathname, FileMode.Create, FileAccess.Write)
    FileOutput.Write(buffer, 0, buffer.LongLength)
    FileOutput.Flush()
    FileOutput.Close()
End Sub 
```

但我似乎无法弄清楚为什么我无法解压缩它创建的文件。有人能告诉我这里的减压器有什么问题吗？（它与压缩器在一个单独的程序中。）

```
Public Sub Extract(ByVal archiveFilenameIn As String, ByVal outFolder As String)
    Dim fileInput As New FileStream(archiveFilenameIn, FileMode.Open)
    Dim msUncompressed As New MemoryStream(GetStreamAsByteArray(fileInput))
    Dim zosDecompressed As New BZip2InputStream(msUncompressed)
    Dim buffer As Byte() = GetStreamAsByteArray(fileInput)
    zosDecompressed.Read(buffer, 0, buffer.Length())
    buffer = msUncompressed.ToArray()
    Dim FileOutput As New FileStream(outFolder & "\temporary.bmp", FileMode.Create, FileAccess.Write)
    FileOutput.Write(buffer, 0, buffer.LongLength)
    FileOutput.Flush()
    FileOutput.Close()
    zosDecompressed.Close()
    msUncompressed.Close()
    fileInput.Close()
End Sub 
```

编辑：我还在这里使用了一个将流转换为字节数组的函数：

```
Private Function GetStreamAsByteArray(ByVal stream As System.IO.Stream) As Byte()
    Dim streamLength As Integer = Convert.ToInt32(stream.Length)
    Dim fileData As Byte() = New Byte(streamLength) {}

    ' Read the file into a byte array
    stream.Read(fileData, 0, streamLength)
    stream.Close()

    Return fileData
End Function 
```

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T10:15:13.530

在使用写入数据之前尝试完成 BZip2OutputStream。这对我很有帮助。

```
zosCompressed.Finalize();
buffer = msCompressed.ToArray(); 
```

[BZip2OutputStream 使用示例](http://www.codeproject.com/Articles/6834/MemoryStream-Compression)。

# events - powershell 多运行空间事件传递

> ID：15501938
> 
> 赞同：5
> 
> 时间：2013-03-19T14:16:06.137
> 
> 标签：events, powershell, inter-process-communicat, runspace

我一直在寻找一种在不同运行空间之间传递事件的方法，但还没有找到。下面的片段创建了一个后台运行空间，它显示了一个只有一个按钮的小窗口。OnClick 它应该发布一个主运行空间应该接收的事件：

```
$Global:x = [Hashtable]::Synchronized(@{})
$x.Host = $Host
$Global:rs = [RunspaceFactory]::CreateRunspace()
$rs.ApartmentState,$rs.ThreadOptions = "STA","ReUseThread"
$rs.Open()
$rs.SessionStateProxy.SetVariable("x",$x)
$Global:cmd = [PowerShell]::Create().AddScript(@'
Add-Type -AssemblyName PresentationFramework,PresentationCore,WindowsBase
$x.w = [Windows.Markup.XamlReader]::Parse(@"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
MaxWidth="800" WindowStartupLocation="CenterScreen" WindowStyle="None" SizeToContent="WidthAndHeight">
<Button Name="test" Content="Starte Installation"/>
</Window>
"@)
$x.test = $x.w.Content.FindName('test')
$x.test.Add_Click( {New-Event -SourceIdentifier "TestClicked" -MessageData "test event"} )
$x.w.ShowDialog()
'@)
$cmd.Runspace = $rs
$null = $cmd.BeginInvoke()
while(!($x.ContainsKey("test"))) {Sleep -Milliseconds 500}
Register-EngineEvent -SourceIdentifier "TestClicked" -Action {$event} 
```

但这不起作用。我将最后几行更改为：

```
$x.test.Add_Click( {$x.Host.Runspace.Events.GenerateEvent( "TestClicked", $x.test, $null, "test event") } )
$x.w.ShowDialog()
'@)
$cmd.Runspace = $rs
$null = $cmd.BeginInvoke()
Wait-Event -SourceIdentifier "TestClicked" 
```

......这也没有奏效。我猜是因为我无法从 Child-RS 中的 parent-RS 调用函数。奇怪的是，在某些情况下，Get-Event 返回了一些“TestClicked”-Events，但我无法回忆或重现......

编辑：显然上面的工作方式 - 我又遇到了我的问题，它与一些功能结合使用。大多数人都知道 Scripting Guy 在 Powershell-BLog 上发布的 Show-Control 功能。由于我宁愿显示整个 GUI 而不是单个控件，因此我将其修改如下：

```
Add-Type –assemblyName PresentationFramework,PresentationCore,WindowsBase,"System.Windows.Forms"

<#  Die folgende Funktion zeigt eine GUI an.  Die Informationen über die GUI
    müssen in XAML formuliert sein.  Sie können als String oder als Dateiname
    übergeben werden.
    Die Funktion erlaubt die Übergabe von WindowProperties als Hashtable
    (-> siehe [System.Windows.Window]), von gemeinsamen Objekten in einer syn-
    chronized HashTable und von Ereignissen, die mit den entsprechenden im xaml
    definierten Objekten verbunden werden.
    Der Switch "backgroundrunspace" macht, was sein Name sagt: er öffnet die GUI
    im Hintergrund, sodass das Hauptprogramm weiterlaufen kann.
#>
function Show-Control {
    param(
        [Parameter(Mandatory=$true,ParameterSetName="XamlString",ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)]
        [string] $xaml,

        [Parameter(Mandatory=$true,ParameterSetName="XamlFile",ValueFromPipeline=$false,ValueFromPipelineByPropertyName=$true)]
        [string] $xamlFile,

        [Parameter(ValueFromPipelineByPropertyName=$true)]
        [Hashtable] $event,

        [Parameter(ValueFromPipelineByPropertyName=$true)]
        [Hashtable] $windowProperties,

        # If this switch is set, Show-Control will run the control in the background runspace
        [switch] $backgroundRunspace,

        # To share Variables with the background runspace
        [Parameter(ValueFromPipelineByPropertyName=$true)]
        [Hashtable] $sharedVariables
    )
    Begin
    {   # If it's in a background runspace, create a runspace and populate the runspace with Show-Control.
        if ($backgroundRunspace) {
            $newRunspace =[RunspaceFactory]::CreateRunspace()
            $newRunspace.ApartmentState,$newRunspace.ThreadOptions = "STA","ReuseThread"
            $newRunspace.Open()
            $newRunspace.SessionStateProxy.SetVariable("ParentHost",$Host)
            if ($sharedVariables) {
                $newRunspace.SessionStateProxy.SetVariable("sharedVariables",$sharedVariables)
            }
            $selfDefinition = "function Show-Control { $((Get-Command Show-Control).Definition) }"
            $psCmd = [PowerShell]::Create().AddScript($selfDefinition, $false)
            $psCmd.Runspace = $newRunspace
            $null = $psCmd.Invoke()
        } else {
            $window = New-Object Windows.Window
            $window.SizeToContent = "WidthAndHeight"
            # das Fenster in die sharedVariables aufnehmen
            if ($sharedVariables) {
                $sharedVariables.window=$window
            }
            if ($windowProperties) {
                foreach ($kv in $windowProperties.GetEnumerator()) {
                    $window."$($kv.Key)" = $kv.Value
                }
            }
            $visibleElements = @()
            $windowEvents = @()
        }
    }
    Process
    {   
        if ($backgroundRunspace) { # Invoke the command, using each parameter from commandlineparameters 
            $psCmd  = [Powershell]::Create().AddCommand("Show-Control",$false)
            $null = $psBoundParameters.Remove("BackgroundRunspace")
            $null = $psCmd.AddParameters($psBoundParameters)
<#            foreach ($namedArg in $psBoundParameters.GetEnumerator()) {
                $null = $psCmd.AddParameter($namedArg.Key, $namedArg.Value)                                                    
            }#>
            $psCmd.Runspace = $newRunspace
            $null = $psCmd.BeginInvoke()
        } else {
            # falls eine xaml-datei, dann diese in den xaml-string laden
            if($PSCmdlet.ParameterSetName -eq "xamlFile") {
                $xaml = [string](Get-Content -Encoding UTF8 -ReadCount 0 -Path $xamlFile)
            }
            # XAML parsen und so zu Objekten machen
            $window.Content=([system.windows.markup.xamlreader]::parse($xaml))
            # wir merken uns, ob wir ein Loaded-Event verknüpft haben
            $guiloaded_notadded = $true
            # event-hashtable parsen
            if($event) {
                foreach ($singleEvent in $event.GetEnumerator()) {
                    if ($singleEvent.Key.Contains(".")) {
                        # auseinander nehmen von Objektname und Eventname
                        $targetName = $singleEvent.Key.Split(".")[0].Trim()
                        $eventName = $singleEvent.Key.Split(".")[1].Trim()
                        if ($singleEvent.Key -like "Window.*") {
                            $target = $window
                        } else {
                            $target = $window.Content.FindName($targetName)                   
                        }                       
                    } else {    # kein Objektname -> das Fenster selbst ist das Objekt...
                        $target = $window
                        $eventName = $singleEvent.Key
                    }
                    # Prüfe, ob dieses Objekt auch dieses Event unterstützt, wenn ja: Skriptblock mit dem Event verheiraten
                    if( Get-Member -InputObject $target -MemberType Event -Name $eventName ) {
                        $eventMethod = $target."add_$eventName"
                        if( ($targetName -eq "Window") -and ($eventName -eq "Loaded") -and ($ParentHost)) {
                            $eventScript = [ScriptBlock]::Create( $singleEvent.Value.ToString() + "`n`$null = `$ParentHost.Runspace.Events.GenerateEvent('GUIloaded',$null,$null,$null)" )
                            $eventMethod.Invoke( $ExecutionContext.InvokeCommand.NewScriptBlock($eventScript) )
                            $guiloaded_notadded = $false
                        } else {
                            $eventMethod.Invoke( $ExecutionContext.InvokeCommand.NewScriptBlock($singleEvent.Value) )
                        }
                    }
                }
            }
            # wenn background (können wir hier nur durch Abfragen von "ParentHost" prüfen) und kein "Loaded" event,
            # dann das GUIloaded-event mit dem window.loaded event senden.
            if(($guiloaded_notadded) -and ($ParentHost)) {
                $window.add_Loaded( { 
                    $null = $ParentHost.Runspace.Events.GenerateEvent('GUIloaded',$null,$null,$null)
                } )
            }
            # benannte xaml-Objekte in die sharedVariables bringen...
            if($sharedVariables) {
                $match = [regex]::Matches($xaml,' [x]?[:]?Name="(\w+)"')
                foreach ($m in $match)
                {
                    $name = [string]($m.Groups[1].Value)
                    $sharedVariables.Add($name,$window.Content.FindName($name))
                }
            }
        }
    }
    End
    {
        if ($backgroundRunspace) {
            $newRunspace
        } else {
            $null = $window.ShowDialog()
            $window.Tag
            if($ParentHost) {
                $null = $ParentHost.Runspace.Events.GenerateEvent('WindowClosed',$null,$null,$window.Tag)
            }
        }
    }
} 
```

很抱歉用德语发表评论。

现在在函数调用中使用带有“GuI-events”的这个函数（它也使用发送“GUIloaded”和“WindowClosed”事件的技术），似乎不可能从gui-events中发送事件。像这样：

```
Show-Control -xamlfile ($PSScriptRoot+"\WimMounter.xaml") -backgroundRunspace -sharedVariables $ui -event @{
    "Loaded" = {
        $Global:fdlg = New-Object System.Windows.Forms.OpenFileDialog
        $fdlg.CheckFileExists = $true
        $fdlg.Filter = "WIM-Image Files|*.wim"
        $fdlg.Title = "Bitte WIM-Datei auswählen"

        $Global:ddlg = New-Object System.Windows.Forms.FolderBrowserDialog
        $ddlg.Description = "Bitte Verzeichnis zum Mounten des Images auswählen"
        $ui.fn = ""
        $ui.in = ""
        $ui.md = ""
    }
    "selectFile.Click" = {
        if($Global:fdlg.ShowDialog() -eq "OK") {
            $sharedVariables.ImageFile.Text = $fdlg.FileName.Trim()
            $sharedVariables.pl.Content = ("Ausgewählt: `""+$fdlg.FileName.Trim()+"`" - wird untersucht...")
            $sharedVariables.pb.IsIndeterminate = $true
            $sharedVariables.ImageName.Items.Clear()
            $ParentHost.UI.WriteLine("gleich gibbs 'ImageSelected'")
            $ParentHost.Runspace.Events.GenerateEvent("ImageSelected",$null,$null,($fdlg.FileName.Trim()))
        }
    }
} 
```

需要注意的是，$ui 是一个全局的 SyncHasTable。奇怪的是，那些“$ParentHost.UI.WriteLine()”调用在父控制台上工作并产生输出。“GenerateEvent”调用似乎根本不起作用。Get-Event 既不显示任何事件，也不会触发通过 Register-EngineEvent 设置的操作。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T00:52:44.170

我能够使用以下代码在父运行空间上接收事件：

```
$Global:x = [Hashtable]::Synchronized(@{})
$x.Host = $Host
$rs = [RunspaceFactory]::CreateRunspace()
$rs.ApartmentState,$rs.ThreadOptions = "STA","ReUseThread"
$rs.Open()
$rs.SessionStateProxy.SetVariable("x",$x)
$cmd = [PowerShell]::Create().AddScript({
Add-Type -AssemblyName PresentationFramework,PresentationCore,WindowsBase
$x.w = [Windows.Markup.XamlReader]::Parse(@"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
MaxWidth="800" WindowStartupLocation="CenterScreen" WindowStyle="None" SizeToContent="WidthAndHeight">
<Button Name="test" Content="Starte Installation"/>
</Window>
"@)
$x.test = $x.w.FindName('test')

$x.test.Add_Click({
    $x.Host.Runspace.Events.GenerateEvent( "TestClicked", $x.test, $null, "test event") 
} )  

$x.w.ShowDialog()
})
$cmd.Runspace = $rs
$handle = $cmd.BeginInvoke()
Register-EngineEvent -SourceIdentifier "TestClicked" -Action {$Global:x.host.UI.Write("Event Happened!")} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T14:31:26.140

这是一篇关于使用同步哈希表在运行空间之间传递数据的文章，如果有帮助的话：

[http://learn-powershell.net/2012/10/14/powershell-and-wpf-writing-data-to-a-ui-from-a-different-runspace/](http://learn-powershell.net/2012/10/14/powershell-and-wpf-writing-data-to-a-ui-from-a-different-runspace/)

# asp.net-mvc-4 - IIS7.5 - 在 MVC ASP.NET 中处理静态文件请求

> ID：15501939
> 
> 赞同：2
> 
> 时间：2013-03-19T14:16:06.183
> 
> 标签：asp.net-mvc-4, iis-7.5, asp.net-mvc-routing

我想用 MVC ASP.NET 处理所有的 web 请求，但是我不能处理任何图像请求。

当我创建 MVC 项目时，Visual Studio 在 web.config 中为经典/集成模式添加了三个 ExtensionlessUrlHandler，然后我在 IIS 中添加了一个通配符映射，路径等于“*”，使用 IsapiModule。

尽管如此，每当我请求图像文件（例如[http://mydomain.com/customer/test.png](http://mydomain.com/customer/test.png)）时，Web 请求都会命中 StaticFileModule，而不是 IsapiModule。

我还尝试在模块部分添加设置为 true 的“runAllManagedModulesForAllRequests”标志，但它不起作用！

提前感谢您的任何回复，

法比奥

# c++ - 将输入 CEdit 控件的文本限制为 ISO8859-1 字符

> ID：15501942
> 
> 赞同：1
> 
> 时间：2013-03-19T14:16:09.333
> 
> 标签：c++, visual-studio-2010, mfc

我有一个在中国和印度使用的应用程序。在一组 Cedit 控件中，我希望用户只能输入属于经典拉丁字母的字符（ISO8859-1 很好）。这些控件用于输入注册数据，因此汉字对我们没有用，因为我们无法阅读它们。

该应用程序是基于 MFC 的，使用 UNICODE 构建。
如何将这些 CEdit 限制为拉丁字符。可用字符是否取决于 CEdits 或该字体的 CharacterSet 中使用的字体？
目前，我很困惑，任何帮助、提示、提示、方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:22:11.390

这是我在我的程序中所做的：

```
void CRequestForm::OnEnChangeEditDetail()
{
  // Filter out the clinical note of any invalid characters as the user types.
  CString strNotes;

  m_edit.GetWindowText(strNotes);
  BOOL bValid = TRUE;
  int nStartChar, nEndChar;
  CString strTyped;
  m_edit.GetSel(nStartChar, nEndChar);
  if(strNotes.GetLength() - m_strOldNote.GetLength() == 1)
  {
    // this is normal user typing
    CString strInvalidChars;

    if(nStartChar == nEndChar && nStartChar > 0)
      strTyped = strNotes.Mid(nStartChar-1, 1);
    if(!CheckInvalidCharacters(strTyped))
    {
      m_edit.SetWindowText(m_strOldNote);
      if(nStartChar > 0 && nEndChar > 0)
        m_edit.SetSel(nStartChar-1, nEndChar-1);
      else
        m_edit.SetSel(nStartChar, nEndChar);
      bValid = FALSE;
    }
  }
  else if(strNotes.GetLength() - m_strOldNote.GetLength() == 2 &&
    nStartChar == nEndChar && nStartChar > 0 && 
    strNotes.Mid(nStartChar-2, 2) == _T("\r\n"))
  {
    // Allow CrLf
    bValid = TRUE;
  }
  else
  {
    // this is most likely the case of "Pasted" text. need just to remove invalid characters
    RemoveInvalidChars(strNotes);
  }

  if(bValid)
  {
    m_strOldNote = strNotes;
    m_edit.SetWindowText(strNotes);
    m_edit.SetSel(nStartChar, nEndChar);
  }
} 
```

如您所见，您需要有一个`m_strOldNote`使用初始文本（在 OnInitDialog 中）启动的实例变量。在您的 m_edit 中，您需要处理 EN_CHANGE 事件。

您将需要两个功能：这可能很简单`CheckInvalidCharacters()`：`RemoveInvalidChars()`

```
BOOL CRequestForm::CheckInvalidCharacters(const CString& strText)
{
  BOOL bResult = TRUE;

  int nPos, nLenght;
  nLenght = strText.GetLength();
  for(nPos = 0; nPos < nLenght; ++nPos)
  {
    TCHAR ch = strText.GetAt(nPos);

    if(!(ch >= '0' && ch <= '9') &&
       !(ch >= 'A' && ch <= 'Z') &&
       !(ch >= 'a' && ch <= 'z') &&
       !(ch >=  32 && ch <=  64 && ch != '&') && // Space thru @, excluding |^~\&
       !(ch == '[' || ch == ']' || ch == '{' || ch == '}' || ch == '_' || ch == '\r' || ch == '\n'))
    {
      bResult = FALSE;
    }
  }

  return bResult;
}

void CRequestForm::RemoveInvalidChars(CString &str)
{
  // remove non-ASCII characters
  int nPos, nLenght;
  nLenght = str.GetLength();
  for(nPos = 0; nPos < nLenght; ++nPos)
  {
    TCHAR ch = str.GetAt(nPos);

    if(!((ch >= _T('0') && ch <= _T('9')) ||
         (ch >= _T('A') && ch <= _T('Z')) ||
         (ch >= _T('a') && ch <= _T('z')) ||
         (ch >=  32 && ch <=  64 && ch != _T('&')) || // Space thru @, excluding |^~\&
          ch == _T('[') || ch == _T(']') || ch == _T('{') || ch == _T('}') || ch == _T('_')))
    {
      str.SetAt(nPos, _T(' '));
    }
  }
} 
```

# variables - 拆分文本变量，然后使用一个值并将其输入到 Selenium IDE 的文本框中

> ID：15501946
> 
> 赞同：0
> 
> 时间：2013-03-19T14:16:15.113
> 
> 标签：variables, selenium-ide, split, identify

我希望从弹出框中存储一个值，将其分成两部分，然后使用其中一个输入文本框中。我想要的内容是文档 ID。

```
<div id="approval-dialog" class="modal hide fade in" style="display: block;" aria-hidden="false">
<div>
<div class="modal-header">
<div class="modal-body">
<div id="DialogError" class="hide"> </div>
<form id="ApprovalForm" class="form-horizontal" method="post" action="/Practice/Approve">
<div class="approved">
<div class="well well-small"> The following approval certificate has been applied to - EMED.pdf </div>
<div class="well well-small certificate">
<ul>
<li>Name: Client 001</li>
<li>
TimeStamp: 18/03/2013 11:49  
<span>(UTC)</span>
</li>
<li>Document ID: 11330922E6258</li>
</ul>
</div>
</div>
</div>
<div class="modal-footer">
</div>
</div> 
```

到目前为止，我有： StoreText | //div[@id='approval-dialog']/div/div[2]/div[2]/div[2]/ul/li[5] | DocumentID (不知道如何拆分) 类型 | id=跟踪ID | ${文档ID}

注意：回显将文档 ID 变量显示为：文档 ID：11330922E6258

我希望 11330922E6258 能够在 Tracking ID 框中进行搜索

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:37:06.343

对于句子的拆分，请使用此代码并让我知道它是否有效

```
store   | Document ID: 11330922E6258 | string
store   | 1 | delimiter
store   | javascript{storedVars['string'].split('ID:')[storedVars['delimiter']]} | name
echo    | ${name}

[info] Executing: |store | Document ID: 11330922E6258 | string |
[info] Executing: |store | 1 | string1 |
[info] Executing: |store | javascript{storedVars['string'].split('ID: ')[storedVars['string1']]} | name |
[info] Executing: |echo | ${name} | |
[info] echo: 11330922E6258 
```

# php - mysql 版本 mysql 计数

> ID：15501947
> 
> 赞同：-1
> 
> 时间：2013-03-19T14:16:22.547
> 
> 标签：php, mysql, count, mysqli

我只是慢慢地从 mysql 迁移到 mysqli，并尝试使用 mysqli 编写一个新网站。我正在尝试计算行数，并尝试将以下 mysql 查询转换为 mysqli，但我有点摸不着头脑，因为 mysqli 的处理方式似乎完全不同。

```
 $result = $db->query("SELECT COUNT(*) FROM `table`");
  $row = $result->fetch_row();
    echo '#: ', $row[0]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:18:55.547

我可能会以冗长的方式执行此操作，但我倾向于针对一般查询执行以下操作

```
$query = $mysqli->prepare("SELECT COUNT(*) FROM `table`");
$query->execute();
$query->bind_result($count);
$query->fetch();
$query->close(); 
```

$count 现在持有你想要的值。

# php - IE8以下版本的浏览器版本检查器故障

> ID：15501948
> 
> 赞同：0
> 
> 时间：2013-03-19T14:16:23.143
> 
> 标签：php, user-agent

此代码不适用于 IE8 和其他旧版本的 IE。

我重写了代码，现在我有两种方法，但仍然失败......

为什么？什么找不到？

我调用函数的方式：

```
 if (BrowserVersionChecker::is_old_browser()==1) {
//popup here
} 
```

班上：

```
<?php

class BrowserVersionChecker {

    /**
      Figure out what browser is used, its version and the platform it is
      running on.

      The following code was ported in part from JQuery v1.3.1
     */
    public static function is_old_browser() {

        $old = 0;

        $userAgent = strtolower($_SERVER['HTTP_USER_AGENT']);

        // Identify the browser. Check Opera and Safari first in case of spoof. Let Google Chrome be identified as Safari. 
        if (preg_match('/opera/', $userAgent)) {
            $name = 'opera';
        } elseif (preg_match('/webkit/', $userAgent)) {
            $name = 'safari';
        } elseif (preg_match('/msie/', $userAgent)) {
            $name = 'msie';
        } elseif (preg_match('/mozilla/', $userAgent) && !preg_match('/compatible/', $userAgent)) {
            $name = 'mozilla';
        } else {
            $name = 'unrecognized';
        }

        // What version? 
        if (preg_match('/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/', $userAgent, $matches)) {
            $version = $matches[1];
        } else {
            $version = 'unknown';
        }

        // Running on what platform? 
        if (preg_match('/linux/', $userAgent)) {
            $platform = 'linux';
        } elseif (preg_match('/macintosh|mac os x/', $userAgent)) {
            $platform = 'mac';
        } elseif (preg_match('/windows|win32/', $userAgent)) {
            $platform = 'windows';
        } else {
            $platform = 'unrecognized';
        }

        $version = intval($version);

        if (($name == 'opera') && ($version <= 11)) {
            $old = 1;
        }

        if (($name == 'safari') && ($version <= 5)) {
            $old = 1;
        }

        if (($name == 'msie') && ($version <= 8)) {
            $old = 1;
        }

        if (($name == 'mozilla') && ($version <= 7)) {
            $old = 1;
        }

//        $arr = array(
//            'name' => $name,
//            'version' => $version,
//            'platform' => $platform,
//            'userAgent' => $userAgent
//        );
//
//        echo '<pre>';
//        print_r($arr);

        return $old;

//        return array(
//            'name' => $name,
//            'version' => $version,
//            'platform' => $platform,
//            'userAgent' => $userAgent
//        );
    }

    //not used any more - deprecated
    public static function is_old_browser2() {
        $old = 0;

        $browser = get_browser(null, true);
        print_r($browser);

        if (!empty($_SERVER['HTTP_USER_AGENT'])) {
            // IE <= 7
            // User Agent: Opera/9.80 (Windows NT 6.1; U; en) Presto/2.10.229 Version/11.61
            if (preg_match('#msie\s+(\d+)\.(\d+)#si', $_SERVER['HTTP_USER_AGENT'], $matches)) {
                if ($matches[1] <= 8) {
                    $old = 1;
                }
            }
            // Firefox <= 7
            // User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0.2) Gecko/20100101 Firefox/10.0.2
            elseif (preg_match('#Firefox/(\d+)\.(\d+)[\.\d]+#si', $_SERVER['HTTP_USER_AGENT'], $matches)) {
                if ($matches[1] <= 7) {
                    $old = 1;
                }
            }
            // Safari < 5
            // User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7
            elseif (preg_match('#Version/(\d+)[\.\d]+ Safari/[\.\d]+#si', $_SERVER['HTTP_USER_AGENT'], $matches)) {
                if ($matches[1] < 5) {
                    $old = 1;
                }
            }
            // opera < 11
            // User Agent: Opera/9.80 (Windows NT 6.1; U; en) Presto/2.10.229 Version/11.61
            elseif (preg_match('#Opera/[\.\d]+.*?Version/(\d+)[\.\d]+#si', $_SERVER['HTTP_USER_AGENT'], $matches)) {
                if ($matches[1] < 11) {
                    $old = 1;
                }
            }
        }

        return $old;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:59:20.743

我强烈建议不要使用 PHP 进行浏览器检查，特别是如果目的是为不同的浏览器提供不同的输出。

事实上，现在浏览器检查通常被认为是不好的做法。你的代码说它是从 jQuery 抄来的；值得知道的是，jQuery 中的这个特性已经被弃用了一段时间，并且从最近的版本中完全删除了。

因此，您的 PHP 代码基于已从 jQuery 中删除的代码，因为他们认为这是不好的做法。这听起来不太好。

**那么为什么它被认为是不好的做法呢？**

首先，用户代理字符串不应该被认为是可靠的——不仅它很容易被欺骗（大多数浏览器都可以选择更改它），而且一些代理、防火墙和匿名工具可能会改变它或将其完全删除。你不能依赖它是正确的或存在的。

其次，它可能并不总是有用的。例如，您的代码检查 Opera。Opera 目前使用自己的渲染引擎，但很快将切换到 Webkit。这将完全改变他们的浏览器，但无论哪种方式，您的测试都会给出相同的结果。真的不是很有用。您的代码还假定所有 Webkit 浏览器都是 Safari，这显然是错误的。

您的代码无法适应新的浏览器、现有浏览器的未来版本或新的渲染引擎。浏览器世界正在迅速变化；您的代码将难以跟上它。

最后，您的代码将各种浏览器版本描述为“旧”版本，但它们之间没有任何区别。Opera 10、IE7 和 Firefox 2 的功能大相径庭。您还没有告诉我们，如果您使用的是“旧”浏览器，您打算做什么，但至少对于您使用的某些浏览器来说，这可能是不合适的。

**因此，如果不建议这样做，还有什么替代方法？**

另一种方法是*功能测试*。这通常使用 Javascript 在浏览器本身中完成。最好的例子是一个名为[Modernizr](http://modernizr.com/)的工具。这是您插入页面的 Javascript 库。它分析用户浏览器的功能，并在网站上设置一堆标志，然后您可以在 CSS 或 Javascript 中使用这些标志。这使得在浏览器缺少特定功能时很容易发现，并且很容易处理它。Modernizr 站点有很好的文档，所以我不会在这里过多解释；只是建议你看看。

还有大量称为“Polyfills”的 javascript 工具，它们旨在使旧版浏览器与您可能想要使用的一些新功能一起工作。您可能需要的几乎所有功能都有 polyfill，因此如果您的问题是浏览器不支持特定功能，那么您很有可能可以处理它。

最后，无论如何，一些浏览器功能只是吸引眼球。如果问题在于圆角或渐变等功能，如果页面不存在，页面仍然可用，请考虑让旧浏览器在没有它们的情况下呈现页面。

上述技术的组合可以使一些非常高级的站点在非常旧的浏览器上运行。

**但我必须使用服务器端浏览器检测，这是唯一的方法！**

如果您拒绝了我的论点，并且仍然想在 PHP 中进行浏览器测试，我仍然建议您丢弃您的代码，因为 PHP 确实提供了您需要的内置功能。查找[`get_browser()`功能](http://php.net/manual/en/function.get-browser.php)。

此函数使用一个名为browsecap.ini 的浏览器信息文件（您需要单独下载）来帮助它确定正在使用的浏览器以及它的功能。这些browsecap.ini 文件可以很容易地下载，更重要的是，随着新浏览器版本的发布，它们很容易保持最新。（嗯，比每隔几个月重写一次代码更容易）。

您可以从这里下载最新的 browsecap.ini 文件：http: [//tempdownloads.browserscap.com/](http://tempdownloads.browserscap.com/)

（注意：这是一个临时 URL，将来可能会更改；如果它不起作用，快速访问您最喜欢的搜索引擎将为您提供 browsecap.ini 文件的其他来源）

如果你走这条路，请记住我在这个答案开头所说的话——你不能依赖用户代理字符串的内容。请注意这一点，并准备好处理 UA 字符串无效、不正确或纯空白的情况。

最后，另外一点，如果您计划根据用户代理字符串提供不同的输出，您还应该注意它可能会影响您的搜索引擎排名。与普通浏览器相比，谷歌特别关注那些为其爬虫提供不同输出的网站。它认为这是“掩饰”，并积极惩罚这样做的网站。这不是您想要的（您只是想处理不同的浏览器功能），但如果您需要小心如何操作，以及输出如何不同，因为 Google 可能会误解它。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:32:11.347

与其在处理单个正则表达式案例时费尽心思，不如使用[UA-Parser-js](http://faisalman.github.com/ua-parser-js/)之类的东西——一个基于 JavaScript 的用户代理字符串解析器（也可作为 jQuery 插件使用），它试图提供：

*   浏览器/版本
*   引擎
*   操作系统
*   设备

它可以工作（有一些缺陷），但涵盖了许多常用的浏览器版本。

# sockets - 在 ubuntu 的 openssl 套接字编程中未定义对 err_exit 、berr_exit..etc 的引用

> ID：15501952
> 
> 赞同：2
> 
> 时间：2013-03-19T14:16:30.807
> 
> 标签：sockets, ubuntu, openssl, header-files

这是我的第一个**openssl** **套接字**程序

参考这个[链接](http://www.rtfm.com/openssl-examples/)

首先我用 **gcc -g server.c -o server编译**

但得到这个错误

> /usr/lib/i386-linux-gnu/gcc/i686-linux-gnu/4.5.2/../../../crt1.o: 在函数`_start': (.text+0x18): undefined reference to`main' /tmp/ccxiY18C.o: 在函数`tcp_listen': /home/usr/Desktop/c-examples/server.c:11: undefined reference to`err_exit ' /home/usr/Desktop/c-examples/server.c:20: 未定义对`berr_exit' /tmp/ccxiY18C.o: In function`load_dh_params 的引用': /home/usr/Desktop/c-examples/server.c:33: 未定义对`BIO_new_file' /home/usr/Desktop/c-examples/server.c:34: undefined reference to`berr_exit 的引用' /home/usr /Desktop/c-examples/server.c:36：未定义对`PEM_read_bio_DHparams' /home/usr/Desktop/c-examples/server.c:37: undefined reference to`BIO_free 的引用' /home/usr/Desktop/c-examples/server.c:38：未定义对`SSL_CTX_ctrl' /home/usr/Desktop/c-examples/server.c:39: undefined reference to`berr_exit 的引用' /tmp/ccxiY18C.o：在函数`generate_eph_rsa_key': /home/usr/Desktop/c-examples/server.c:47: undefined reference to`RSA_generate_key ' /home/usr/Desktop/c-examples/server.c:49: 未定义对`SSL_CTX_ctrl' /home/usr/Desktop/c-examples/server.c:50: undefined reference to`berr_exit 的引用' /home/usr/Desktop/c-examples/server.c:52: 未定义对 `RSA_free' 的引用

然后我用 **gcc -g server.c -o server -lssl -lcrypt编译它**

它给

> /usr/lib/i386-linux-gnu/gcc/i686-linux-gnu/4.5.2/../../../crt1.o: 在函数`_start': (.text+0x18): undefined reference to`main' /tmp/ccPlisKL.o: 在函数`tcp_listen': /home/usr/Desktop/c-examples/server.c:11: undefined reference to`err_exit ' /home/usr/Desktop/c-examples/server.c:20: 未定义对`berr_exit' /tmp/ccPlisKL.o: In function`load_dh_params 的引用': /home/usr/Desktop/c-examples/server.c:34: 未定义对`berr_exit' /home/usr/Desktop/c-examples/server.c:39: undefined reference to`berr_exit 的引用' /tmp/ccPlisKL .o：在函数`generate_eph_rsa_key': /home/usr/Desktop/c-examples/server.c:50: undefined reference to`berr_exit'collect2：ld返回1退出状态

我该如何克服这个问题..请给我一个解决方案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T20:53:08.320

是`-lcrypto`，不是`-lcrypt`。只需添加`o`

# css - 渐变在 IE9 中不四舍五入

> ID：15501954
> 
> 赞同：7
> 
> 时间：2013-03-19T14:16:34.263
> 
> 标签：css, internet-explorer-9, rounded-corners

我创建了一个圆角按钮，在 IE9 中渐变背景不是圆角的：

![方形而不是圆形](../Images/502d7df3fbe82aa96781ae9b39bfe234.png)

这是CSS：

```
.search button {
    padding: 10px;
    font-family: "OpenSansSemibold", "Helvetica", Arial, sans-serif;
    font-size: 16px;
    display: inline-block;
    outline: none;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    padding: .5em 2em .55em;
    text-shadow: 0 1px 1px rgba(0,0,0,.3);
    -webkit-border-radius: .5em; 
    -moz-border-radius: .5em;
    border-radius: .5em;
    -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.2);
    -moz-box-shadow: 0 1px 2px rgba(0,0,0,.2);
    box-shadow: 0 1px 2px rgba(0,0,0,.2);
    color: #fef4e9;
    border: solid 1px #da7c0c;
    background: #f78d1d;
    background: -webkit-gradient(linear, left top, left bottom, from(#faa51a), to(#f47a20));
    background: -moz-linear-gradient(top,  #faa51a,  #f47a20);
    filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#faa51a', endColorstr='#f47a20');
} 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T18:31:15.163

从您的 css 类中删除**过滤器样式。**

[JS 小提琴示例](http://jsfiddle.net/AvX2u/1/)

如果你想要 IE8 及以下版本的渐变，那么你需要创建一个单独的 CSS 文件并将其包装在这个文件中：

```
<!--[if lte IE 8]>
[css path here]
<![endif]--> 
```

在 IE9 中不能同时拥有渐变和圆角按钮。事实上，Twitter 的 Bootstrap 框架将 IE9 按钮降级为带有圆角的纯色背景色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:21:48.227

IE9 是一个完美的浏览器；问题是使用旧`filter`样式。

它们从来都不是什么好东西，它们只是出于遗留支持的原因才真正留在 IE9 中。他们有很多怪癖，包括这个众所周知的。

您的问题是 IE9 不支持标准 CSS 渐变，所以问题是`filter`如果您想使用它们，该怎么做？

有各种各样的答案，但最好的一个是[CSS3Pie](http://css3pie.com)。

这是一个小的 javascript 库，允许您在 IE9（以及从 IE6 开始的所有其他 IE 版本）中使用标准 CSS 渐变。它还为不支持它们的 IE 版本添加`border-radius`和。`box-shadow`

它不引人注目，并且不会在其他浏览器中造成任何额外的开销。

CSS3Pie 使用 IE 的矢量图形语言 VML 来渲染其渐变，因此它不受该`filter`bug 的影响。

如果您真的想避免使用 Javascript，可以使用渐变为自己创建 VML 或 SVG 元素。这可以在您的 CSS 中使用 URI 编码的图像来完成（[此处](http://blog.philipbrown.id.au/2012/09/base64-encoded-svg-gradient-backgrounds-in-less/)的示例）。但是让 CSS3Pie 为你做这件事要容易得多。

您唯一可用的其他解决方案是加载老式背景图形，或者仅提供纯色背景颜色作为后备选项。

无论如何，您可能应该提供备用纯色，但对于这个问题，我的钱是 CSS3pie 是最好的解决方案。

希望有帮助。

# c# - 旋转后保存pdf文件

> ID：15501956
> 
> 赞同：0
> 
> 时间：2013-03-19T14:16:43.347
> 
> 标签：c#, asp.net-mvc, pdf

以下代码打开 PDF 文件，找到 QR 码所在的位置，然后旋转 PDF 文件，使 QR 码位于左上角。

代码读取和旋转很好，但它使用原始布局保存文件，我希望它保存旋转的文件。

```
for (int pg = 0; pg < inputDocument.PageCount; pg++)
{
    QRCodeDecoder decoder = new QRCodeDecoder();
    string workGif = workingFilename.Replace(".pdf", string.Format(".{0}.gif", pg + 1));
    GhostscriptWrapper.GeneratePageThumb(workingFilename, workGif, pg + 1, 300, 300); // size (last two params) does not seem to have any effect

    using (var fullImg = new Bitmap(workGif))
    {
        var bandImg = fullImg.Clone(new System.Drawing.Rectangle(0, 0, 375, 375), fullImg.PixelFormat);

        //AA THIS SECTION NEEDS TO BE CLEANED UP FOR ACTUAL USE
        Bitmap result = fullImg;
        //top-left
        var bandImg1 = result.Clone(new System.Drawing.Rectangle(0, 0, result.Width/2, result.Height/2), fullImg.PixelFormat);

        //top-right
        var bandImg2 = result.Clone(new System.Drawing.Rectangle(result.Width / 2, 0, result.Width / 2, result.Height / 2), fullImg.PixelFormat);

        //bottom-left
        var bandImg3 = result.Clone(new System.Drawing.Rectangle(0, result.Height / 2, result.Width / 2, result.Height / 2), fullImg.PixelFormat);

        //bottom-right
        var bandImg4 = result.Clone(new System.Drawing.Rectangle(result.Width / 2, result.Height / 2, result.Width / 2, result.Height / 2), fullImg.PixelFormat);

        Bitmap[] corners = new Bitmap[] { bandImg1, bandImg2, bandImg3, bandImg4 };
        string QRinfo = "";

        for (int i = 0; i < corners.Length; ++i)
        {
            string tempQRinfo = Process(corners[i]);
            if (tempQRinfo != null)
            {
                QRinfo = tempQRinfo;
                switch (i)
                {
                    case 0: break; //already upper left
                    case 1: fullImg.RotateFlip(RotateFlipType.Rotate270FlipNone); break;//upper right: rotate -90
                    case 2: fullImg.RotateFlip(RotateFlipType.Rotate90FlipNone);  break;//lower left: rotate 90
                    case 3: fullImg.RotateFlip(RotateFlipType.Rotate180FlipNone); break;//lower right: rotate 180
                }
                break;
            }
        }
        if (QRinfo == null)
        {
            Console.WriteLine("QRCode was not found");
        }
        else
        {
            MessageBox.Show(QRinfo);
            Console.WriteLine(QRinfo);
        }

        string[] qcode = QRinfo.Split('/');
        string gid = qcode[qcode.Count() - 1];
        Guid pgGuid = new Guid(gid);
        var ar = dc.Assessments.FirstOrDefault(c => c.ID == pgGuid);
        if (ar != null)
        {
            var p = inputDocument.Pages[pg];
            string opdName = FILESTORELOCATION + pgGuid.ToString() + ".pdf";
            PdfDocument opd = new PdfDocument(opdName);
            opd.Pages.Add(p);
            opd.Close();

            ar.StoragePath = opdName;
            ar.LastUploadedDT = DateTime.UtcNow;
            ar.UploadedByUserID = uploadingUser;
            dc.SubmitChanges();
        }
    }

    File.Delete(workGif);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:55:29.740

使用 PDFSharp 你可以做到这一点。这个例子向你展示了如何。

```
 var souce = // your rotated image here
 PdfDocument doc = new PdfDocument();
 doc.Pages.Add(new PdfPage());
 XGraphics xgr = XGraphics.FromPdfPage(doc.Pages[0]);
 XImage img = XImage.FromFile(source);

 xgr.DrawImage(img, 0, 0);
 doc.Save(destinaton);
 doc.Close(); 
```

[从这里](http://forums.asp.net/t/1348035.aspx/1)找到这个。

# php - php 1 和 '1' 的区别

> ID：15501960
> 
> 赞同：0
> 
> 时间：2013-03-19T14:16:49.790
> 
> 标签：php, codeigniter

我已经为这个问题挣扎了好几个小时。我有这个方法我的模型（codeigniter）：

```
public function get_umat($kelas1 = 0, $kelas2 = 0) {
    $this->db->select('*');
    $this->db->from('msumat');
    $this->db->join('mskelas', 'msumat.kelas_id = mskelas.kelas_id');

    if($kelas1 != 0)
    {
        echo $kelas1;
        var_dump($kelas1);
        $this->db->where('mskelas.kelas_id', $kelas1);
    }
    else if($kelas2 !=0)
    {
        echo '2';
        $this->db->where('mskelas.kelas_id', $kelas2);
    }
    else if($kelas1 != 0 && $kelas2 !=0)
    {
        echo '3';
        $this->db->where('mskelas.kelas_id BETWEEN $kelas1 AND $kelas2');
    }

    return $this->db->get();
} 
```

**编辑：****不**工作的 是这行代码（取自上面）：

```
$this->db->where('mskelas.kelas_id', $kelas1); 
```

当我在控制器中调用此方法时它**不起作用，如下所示：**

```
$this->backend_m->get_umat($_POST['ddl_kelas1'], $_POST['ddl_kelas1']); 
```

当我 vardump 时，我得到 '1'( **String )**`($_POST['ddl_kelas1']`

然后我尝试**更改控制器中的参数**，但它仍然**无法**正常工作：

```
 $this->backend_m->get_umat(1, $_POST['ddl_kelas1']); 
```

绝望地，**我试图直接在模型中更改参数，并且它的工作原理**：

```
public function get_umat($kelas1 = 1, $kelas2 = 0) 
```

这是怎么回事？我认为这与1（int）和'1'（String）的区别有关。感谢：D

编辑2：经过一些实验，我认为变量类型不是这里的问题。那是因为：我试图在我的**控制器**中这样做：

```
 if(isset($_POST['btnSearch'])) 
    {
        $test = (int)$_POST['ddl_kelas1'];
        $this->backend_m->get_umat($_POST['ddl_kelas1'] , $_POST['ddl_kelas1']);
    } 
```

这在我的模型中：

```
if((int)$kelas1 != 0)
    {
        echo $kelas1;
        var_dump($kelas1);
        $this->db->where('mskelas.kelas_id', $kelas1);
    } 
```

我得到的是，`$kelas1`现在已经是一个 int，但代码仍然**无法**正常工作。我认为这与`$_POST`我`select`的 in html 或其他内容有关：D

但是，这段代码仍然可以正常工作（就像上面一样，我手动将参数更改为 1（整数））：

```
public function get_umat($kelas1 = 1, $kelas2 = 0) 
```

这是我的完整控制器代码：

```
public function index() {
    //table     
    $data_umat = $this->backend_m->get_umat()->result();

    $this->table->set_heading(
        'No',
        'Nama',
        'Kelas',
        'Alamat',
        'Sekolah',
        'Nomor Telepon',
        'Keterangan'        
    );

    $table_template = array('table_open' => '<table border="1" id="custom_table">');
    $this->table->set_template($table_template);

    $no = 1;
    foreach($data_umat as $list_temp) 
    {
        $this->table->add_row(
            $no++,
            $list_temp->nama,
            $list_temp->kelas,
            $list_temp->alamat,
            $list_temp->sekolah,
            $list_temp->no_tlpn,
            $list_temp->keterangan
        );
    }

    $data_kelas = $this->backend_m->get_kelas()->result();

    $data['list_kelas'][0] = 'Pilih Kelas';

    foreach($data_kelas as $row)
    {
        $data['list_kelas'][$row->kelas_id] = $row->kelas;
    }

    $data['table'] = $this->table->generate();

    $this->load->view('backend/home_v', $data);

        if(isset($_POST['btnSearch'])) 
    {
        //$test = (int)$_POST['ddl_kelas1'];
        $test = (int)$this->input->post('ddl_kelas1');
        $this->backend_m->get_umat($test , $_POST['ddl_kelas1'], $_POST['txtNama']);
    }

} 
```

很混乱，嗯？

**为有同样问题的人提供简单的答案** 使用`$_POST`或`$this->input->post()`在模型中，**而不是**在控制器中。所以我们**不必**调用模型的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:14:43.853

仔细检查 if 语句中的表达式：

```
if((int)$kelas1 != 0)
{...}
else if((int)$kelas2 !=0)
{...}
else if((int)$kelas1 != 0 && (int)$kelas2 !=0)
{...} 
```

添加`(int)`以确保将整数与整数（或字符串与字符串）进行比较。同样的想法也适用于构建 SQL 语句。

**调试策略** 尝试以下一种或多种想法：

(1) 确保将整数传递到您的`get_mat`函数中：

```
public function get_umat((int)$kelas1 = 0, (int)$kelas2 = 0) {...) 
```

(2) 确保`get_umat`在传入硬编码值时有效：

```
get_umat(0,0);
get_umat(1,0);
get_umat(0,1);
get_umat(1,1); 
```

在每种情况下，检查以确保`WHERE`选择了正确的子句。

另外：回显您的 SQL 语句并仔细检查它的语法。尝试类似：

```
$the_sql_query_string = $this->db->last_query(); 
```

和回声/看`$the_sql_query_string`

**--------------- 代码建议 --------------------------------- -----------------------------------------------------------**

我对代码提出了一些建议。`$kelas1`为and输入一些实际值，`$kelas2`并确保您的输出看起来正确。

```
public function index() {
    // Select all or filtered set of records     
    if(isset($this->input->post('btnSearch')) 
    {
        //$test = (int)$_POST['ddl_kelas1'];
        //$test = (int)$this->input->post('ddl_kelas1');

        $kelas1 = 101; // put in a relevant id
        $kelas2 = 201; // put in a second relevant id

        // In term, try the following: 
        $this->backend_m->get_umat($kelas1,$kelas2);
    }

    $data_umat = $this->backend_m->get_umat()->result();

    $this->table->set_heading(
        'No',
        'Nama',
        'Kelas',
        'Alamat',
        'Sekolah',
        'Nomor Telepon',
        'Keterangan'        
    );

    $table_template = array('table_open' => '<table border="1" id="custom_table">');
    $this->table->set_template($table_template);

    $no = 1;
    foreach($data_umat as $list_temp) 
    {
        $this->table->add_row(
            $no++,
            $list_temp->nama,
            $list_temp->kelas,
            $list_temp->alamat,
            $list_temp->sekolah,
            $list_temp->no_tlpn,
            $list_temp->keterangan
        );
    }

    $data_kelas = $this->backend_m->get_kelas()->result();

    $data['list_kelas'][0] = 'Pilih Kelas';

    foreach($data_kelas as $row)
    {
        $data['list_kelas'][$row->kelas_id] = $row->kelas;
    }

    $data['table'] = $this->table->generate();

    $this->load->view('backend/home_v', $data);

    // This will not do anything since you have already rendered the page
    // This should be at the top of the code
    /*
    if(isset($_POST['btnSearch'])) 
    {
        //$test = (int)$_POST['ddl_kelas1'];
        $test = (int)$this->input->post('ddl_kelas1');
        $this->backend_m->get_umat($test , $_POST['ddl_kelas1'], $_POST['txtNama']);
    }
    */

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:19:20.097

将变量转换为整数。

```
$this->backend_m->get_umat((int)$_POST['ddl_kelas1'], (int)$_POST['ddl_kelas1']); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T14:19:40.050

您将选择与字符串匹配的键的数据，尝试转换值以获得正确的数据：

```
public function get_umat($kelas1 = 0, $kelas2 = 0) {
    $kelas1 = (int)$kelas1;
    $kelas2 = (int)$kelas2;
    $this->db->select('*');
    $this->db->from('msumat');
    $this->db->join('mskelas', 'msumat.kelas_id = mskelas.kelas_id');

    if($kelas1 != 0)
    {
        echo $kelas1;
        var_dump($kelas1);
        $this->db->where('mskelas.kelas_id', $kelas1);
    }
    else if($kelas2 !=0)
    {
        echo '2';
        $this->db->where('mskelas.kelas_id', $kelas2);
    }
    else if($kelas1 != 0 && $kelas2 !=0)
    {
        echo '3';
        $this->db->where('mskelas.kelas_id BETWEEN $kelas1 AND $kelas2');
    }

    return $this->db->get();
} 
```

# android - 为什么矩形相交永远不会为真？

> ID：15501966
> 
> 赞同：0
> 
> 时间：2013-03-19T14:17:07.000
> 
> 标签：android, sprite, intersect

我有以下功能，它将告诉我 2 个精灵何时在 x 轴上重叠：

```
public int getSecondObjectX(int secObjWidth)
    {
        int rndX = random.nextInt(AndroidApplication.getInstance().device_width - secObjWidth);

        Rect sObj = new Rect(rndX, 20, rndX + secObjWidth, 10);
        Rect droid = new Rect(myAnimation.getXcord(), 20, myAnimation.getXcord() + myAnimation.getCurrentImage().getWidth(), 10);

        Log.d("Compare Rect", "["+sObj.left+", "+sObj.right+"] ["+droid.left+", "+droid.right+"]");

        if(Rect.intersects(sObj, droid))
        {
            Log.d("INTERSECT", "INTERSECT");

            return getSecondObjectX(secObjWidth);
        }
        else
            return rndX;
    } 
```

但我从来没有得到相交，这是 Logcat：

```
03-19 15:08:12.617: D/Compare Rect(631): [183, 231] [141, 189] <-- should be true
03-19 15:08:22.186: D/Compare Rect(631): [158, 206] [172, 220] <-- should be true
03-19 15:08:26.346: D/Compare Rect(631): [123, 171] [178, 226]
03-19 15:08:30.146: D/Compare Rect(631): [156, 204] [155, 203] <-- should be supertrue
03-19 15:08:32.617: D/Compare Rect(631): [84, 132] [172, 220] 
```

有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:24:16.240

你构造`Rect`s 的方式是错误的。构造[`public Rect (int left, int top, int right, int bottom)`](http://developer.android.com/reference/android/graphics/Rect.html#Rect%28int,%20int,%20int,%20int%29)函数不执行范围检查。您可以在文档中找到以下内容：

> 注意：不执行范围检查，因此调用者必须确保 left <= right 和 top <= bottom。

在您的情况下，顶部>底部。

# mysql - MySQL 不等于不工作

> ID：15501969
> 
> 赞同：2
> 
> 时间：2013-03-19T14:17:12.007
> 
> 标签：mysql

这是我的代码：

```
$query = mysql_query("SELECT P_Id, Thing,Something Date
    FROM priv
    WHERE Something = '$thing' AND thing2 <> 'This'
    LIMIT 1"
) or die(mysql_error()); 
```

`"thing2 <> 'this'"`代码在没有语句的情况下正常工作，但是当我实现时`"thing2 <> 'this'"`，它返回 0 结果。好像表中没有空行，但表`NULL`的 thing2 行中有空 ( ) 行。

问题是，这个“不等于”语句不起作用，我已经尝试了一切，但它不会返回任何值。

编辑（解释词）：列看起来像这样 - P_Id | 东西| 日期 | 东西1 | 事物 2 和我需要从某行接收 P_Id，其中Something = Something AND Thing1 NOT EQLAS 到“this”（上例）并且 Thing2 也不等于“this”。我知道这听起来很疯狂。抱歉

好的，所以我尝试了一些实验，发现“thing2 <>”thingy 不适用于 things1/thing2 列，但其他列（如“Something”表）也是“this”条目，它可以正常工作（找到最近的行没有'this'条目）。但是为什么这不适用于things1和2???我已经尝试重命名things列，但没有结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T14:21:09.580

[`something <> NULL`将评估为`NULL`](https://dev.mysql.com/doc/refman/5.1/en/working-with-null.html)。`0`如果在查询中使用与（或）几乎相同的查询`false`。

请记住，SQL 使用[三值逻辑](https://en.wikipedia.org/wiki/Three-valued_logic#SQL)而不是简单的二进制逻辑。

您可能需要使用以下命令显式检查 NULL `IS NULL`：

```
... OR THING IS NULL 
```

或者，您可以使用带有否定的[NULL 安全等于运算符（这是 MySQL 特定`<=>`](https://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#operator_equal-to)[的，但是，它不是标准 SQL](https://stackoverflow.com/questions/802612/how-to-write-a-null-safe-compare-in-pure-sql)）：

```
... AND NOT (THING <=> 'This') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-28T10:14:44.707

我接受@JoachimSauer 的方式。另外，我也更喜欢尝试以下一种。

```
... WHERE Something = '$thing' AND NOT (IFNULL(thing2,'') = 'This')
LIMIT 1``` 
```

# r - knitr 2 wordpress（发送标题无内容）

> ID：15501972
> 
> 赞同：3
> 
> 时间：2013-03-19T14:17:17.563
> 
> 标签：r, knitr

我正在尝试将 knitr 用于 WordPress 只是为了演示它，如此[处所示](http://yihui.name/knitr/demo/wordpress/)。这是我尝试使用的脚本。

[https://dl.dropbox.com/u/61803503/Errors/post.txt](https://dl.dropbox.com/u/61803503/Errors/post.txt)

我遇到了发送帖子标题但没有发送内容的问题。 [Yihui 建议我使用 debug 来逐步解决问题](http://yihui.name/knitr/demo/wordpress/#comment-831885314)。我这样做了，发现内容（正文）可能是帖子内容没有发送的原因。我正在制作的词云似乎被编码为文本。我认为这将通过设置来解决：

```
opts_chunk$set(cache=TRUE, warning = FALSE,
    base.url = "https://dl.dropbox.com/u/61803503/wordpress/",
    base.dir = "C:/Users/trinker/Dropbox/Public/wordpress/") 
```

...正如 Yihui 在[wordpress 演示](http://yihui.name/knitr/demo/wordpress/)中所建议的那样。情况似乎并非如此。我如何发送此博客文章并使其保持自动化（即不手动保存图形并上传）？

这是我在制作 weodpress 脚本后使用的脚本：

```
options(WordpressLogin = c(tylerrinker = "PASS"),
        WordpressURL = "http://trinkerrstuff.wordpress.com/xmlrpc.php")
library(knitr)
knit2wp(file.path("C:/Users/trinker/Desktop/gradient_clouds_revisited/PRESENTATION", 
        "gradient_clouds_revisited.Rmd"), 
        title = 'knitr2wordpress and gradient_cloud Revisited', shortcode = TRUE) 
```

另请注意，wordpress 脚本的内容可以在此 txt 文件的底部看到：

[https://dl.dropbox.com/u/61803503/Errors/post.txt](https://dl.dropbox.com/u/61803503/Errors/post.txt)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T17:42:27.110

`base.url`并且`base.dir`是`opts_knit$set()`代替的选项`opts_chunk`（我知道这很令人困惑）；请仔细查看[演示页面](http://yihui.name/knitr/demo/wordpress/)和[选项页面](http://yihui.name/knitr/options)。

```
opts_chunk$set(cache = TRUE, warning = FALSE)

opts_knit$set(base.url = "https://dl.dropbox.com/u/61803503/wordpress/",
    base.dir = "C:/Users/trinker/Dropbox/Public/wordpress/") 
```

# c - 有限素数域中代数的 C 代码段

> ID：15501975
> 
> 赞同：0
> 
> 时间：2013-03-19T14:17:25.887
> 
> 标签：c, embedded, linear-algebra, finite-field

我需要在 16 位 CPU 上求解有限素数域中的多项式。我见过人们使用这些字段`GF((2^16)+1), GF((2^16)-15)`，并且`GF((2^32)-5)`. 我猜这些选择源于有几个优化的事实。但是，除了使用“mod”之外，我不知道任何进一步的优化。如果有人向我指出一个好的资源，给我代码片段，或者解释为什么人们使用那些奇怪的素数而不是 say ，我将非常感激`GF((2^16)-1)`。

编辑：GF（（2 ^ 16）+ 1）中的%-free模：

```
uint32_t mod_0x10001(uint32_t divident)
{
  uint16_t least;
  uint16_t most;

  least = divident & 0xFFFF;
  most = divident >> 16;

  if (least >= most) {
    return least - most;
  } else {
    return 0x10001 + least - most;
  }
} 
```

编辑： GF(2^16-15) 中的 %-free 模数：

```
uint32_t mod_0xFFF1(uint32_t divident)
{
  uint16_t least;
  uint16_t most;
  uint32_t remainder;

  least = divident & 0xFFFF;
  most = divident >> 16;

  /**
   * divident mod 2^16-15
   * = (most * 2^N + least) mod 2^16-15
   * = [(most * 2^N mod 2^16-15) + (least mod 2^16-15)] mod 2^16-15
   * = [ 15 * most               + least              ] mod 2^16-15
   */
  remainder = 15 * most         + least;

  while (remainder >= 0xFFF1) {
      remainder -= 0xFFF1;
  }

  return remainder;
} 
```

更新：我在 MSP430 上测量了一次性能：高版本比低版本快 4 倍。较低的版本与使用 % :/ 一样快。有什么进一步的建议可以加快较低版本的速度吗？

干杯康拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:46:18.760

之所以使用幂 2^N - m，其中很小，是因为计算格式字的模数 (HI * 2^N + LO) mod 2^Nm 可以拆分为两个（或更多件）减少到

```
 (HI*2^N+LO) mod (2^N-m) ==
    ((HI*2^N) mod (2^N-m) + LO mod (2^N-m)) mod (2^N-m)
    (m * HI  + LO ) mod (2^N-m). 
```

m*HI + LO 的值最多有 log2(m) 位，比适合计算机字的多 - log2(m) 位的值可以通过反复与 m 相乘并累加再次折回总和。通常一次迭代就足够了。

如果 m 很小，m^2 或 m^3 也可以相当小——然后可以应用该技术来计算大数的模数：

```
 [AAAAA | BBBBB | CCCCC | DDDDD | EEEEE ] mod (2^N-m) ==
     EEEEE * 1 mod (2^N-m) +
     DDDDD * m mod (2^N-m) +
     CCCCC * (m^2) mod (2^N-m) + ... etc. 
```

在 base 10 中也是一样的，其中

```
 1234 5678 9812 mod 9997 ==
              9812 mod 9997 +
            3*5678 mod 9997 +
            9*1234 mod 9997 ==
            3 7952 mod 9997 == ( 7952 + 3*3 ) mod 9997 = 7961

    Here 9997 doesn't have to prime, we are using 10^4 instead of 2^N and m = 3 
```

对于 GF(2^n) 计算，典型的加速是 root^n 和 log(n) 的查找表；然后乘法简化为加法。如果目标系统不是某个 16 位系统，我建议使用 SSE4.2（或 Neon）多项式（无进位）乘法。如果我没有大错特错，GF中的多项式计算应该可以通过卷积实现：

```
for (i=0;i<N*2-1;i++) temp[i]=popcount(A & (bit_reverse(B)<<N)>>i);
//  A = 11010, B=01101, reverse B = 10110
//
//  11010     11010     11010    11010   11010  11010   11010    11010     11010
//      10110    10110    10110   10110  10110 10110  10110   10110    10110
// 0000000000 00010000  0000000  010100  10010 001000 0011000 00010000 000000000
//      0        1         0      0       0      1      0        1        0
// 010001010 to be divided by the generator polynomial using typical CRC approach 
```

[进一步阅读](http://rd.springer.com/article/10.1007%2Fs10440-006-9047-0?LI=true)以比较 GF(2^n) 乘法：

（Serdar S. Erdem、Tuğrul Yanık、Çetin K. Koç 的论文，
Acta Applicandae Mathematica 2006 年 9 月，第 93 卷，第 1-3 期，第 33-55 页）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:33:13.220

添加到丹尼尔的答案：有限域只能具有许多元素的素数。但是，您希望拥有许多素数 p 元素，因为这些元素与计算 mod p 同构（这很快！）。而具有 p^r (r > 1) 的有限域，许多元素从不与 Z/p^r Z 同构（即计算 mod p^r）。

编辑：如果你想在 GF(p^r) 中实现计算，你可以在 GF(p)[x] 中选择一个 r 度的不可约多项式 p(x) 并在 GF(p)[x] / (p (x)) 即你计算 mod p(x) （所以你必须实现多项式除法）。您可以在计算机代数系统（例如 Singular 或 Macaulay 2）中使用这些东西

# scala - 优化 csv 文件的非规范化

> ID：15501978
> 
> 赞同：1
> 
> 时间：2013-03-19T14:17:35.667
> 
> 标签：scala

我正在读取一个 csv 文件以存储在不可变的数据结构中。每一行都是一个入口。每个入口都有一个车站。每个车站可以有多个入口。有没有一种方法可以一次通过而不是您在下面看到的两次通过？

```
object NYCSubwayEntrances {
  def main(args: Array[String]) = {
    import com.github.tototoshi.csv.CSVReader
    //http://www.mta.info/developers/data/nyct/subway/StationEntrances.csv
    val file = new java.io.File("StationEntrances.csv")
    val reader = CSVReader.open(file)
    reader.readNext //consume headers
    val entranceMap = list2multimap(
      reader.all map {
        case fields: List[String] => 
          // println(fields)
          (
            fields(2), 
            Entrance(
              fields(14).toBoolean,
              Option(fields(15)),
              fields(16).toBoolean,
              fields(17),
              fields(18) match {case "YES" => true case _ => false},
              fields(19) match {case "YES" => true case _ => false},
              fields(20),
              fields(21),
              fields(22),
              fields(23),
              fields(24).toInt,
              fields(25).toInt
            )
          )
        }
      )
    reader.close
    val reader2 = CSVReader.open(file)
    reader2.readNext //consume headers
    val stations = reader2.all map { case fields: List[String] =>
      Station(
        fields(2),
        fields(0),
        fields(1),
        colate(scala.collection.immutable.ListSet[String](
          fields(3),
          fields(4),
          fields(5),
          fields(6),
          fields(7),
          fields(8),
          fields(9),
          fields(10),
          fields(11),
          fields(12),
          fields(13)
        )),
        entranceMap(fields(2)).toList
      )
    }
    reader2.close

    import net.liftweb.json._
    import net.liftweb.json.Serialization.write
    implicit val formats = Serialization.formats(NoTypeHints)
    println(pretty(render(parse(write(stations.toSet)))))
  }

  import scala.collection.mutable.{HashMap, Set, MultiMap}

  def list2multimap[A, B](list: List[(A, B)]) = 
    list.foldLeft(new HashMap[A, Set[B]] with MultiMap[A, B]){(acc, pair) => acc.addBinding(pair._1, pair._2)}

  def colate(set: scala.collection.immutable.ListSet[String]): List[String] =
    ((List[String]() ++ set) diff List("")).reverse
}

case class Station(name: String, division: String, line: String, routes: List[String], entrances: List[Entrance]) {}
case class Entrance(ada: Boolean, adaNotes: Option[String], freeCrossover: Boolean, entranceType: String, entry: Boolean, exitOnly: Boolean, entranceStaffing: String, northSouthStreet: String, eastWestStreet: String, corner: String, latitude: Integer, longitude: Integer) {} 
```

可以在 [https://github.com/AEtherSurfer/NYCSubwayEntrances找到具有所有正确依赖项的 sbt 项目](https://github.com/AEtherSurfer/NYCSubwayEntrances)

StationEntrances.csv 来自[http://www.mta.info/developers/sbwy_entrance.html](http://www.mta.info/developers/sbwy_entrance.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T05:47:36.257

我有以下片段。第一个解决方案用于`groupBy`对与同一车站相关的入口进行分组。它不假定行已排序。虽然它只读取一次文件，但它确实执行了 3 次传递（一次读取内存中的所有内容，一次用于创建工作站，另`groupBy`一次用于创建工作站）。提取器的代码见最后`Row`。

```
val stations = {
  val file = new java.io.File("StationEntrances.csv")
  val reader = com.github.tototoshi.csv.CSVReader.open(file)
  val byStation = reader
    .all     // read all in memory
    .drop(1) // drop header
    .groupBy {
      case List(division, line, station, _*) => (division, line, station)
    }
  reader.close
  byStation.values.toList map { rows =>
    val entrances = rows map { case Row(_, _, _, _, entrance) => entrance }
    rows.head match {
      case Row(division, line, station, routes, _) =>
        Station(
          division, line, station,
          routes.toList.filter(_ != ""),
          entrances)
    }
  }
} 
```

此解决方案假定行已排序并且应该更快，因为它只执行一次并在读取文件时构建结果列表。

```
val stations2  = {
  import collection.mutable.ListBuffer
  def processByChunk(iter: Iterator[Seq[String]], acc: ListBuffer[Station])
           : List[Station] = {
    if (!iter.hasNext) acc.toList
    else {
      val head = iter.next
      val marker = head.take(3)
      val (rows, rest) = iter.span(_ startsWith marker)
      val entrances = (head :: rows.toList) map {
        case Row(_, _, _, _, entrance) => entrance
      }
      val station = head match {
        case Row(division, line, station, routes, _) =>
          Station(
            division, line, station,
            routes.toList.filter(_ != ""),
            entrances)
      }
      processByChunk(rest, acc += station)
    }
  }
  val file = new java.io.File("StationEntrances.csv")
  val reader = com.github.tototoshi.csv.CSVReader.open(file)
  val stations = processByChunk(reader.iterator.drop(1), ListBuffer())
  reader.close
  stations
} 
```

我创建了一个专用提取器来获取给定线路的路线/入口。我认为它使代码更具可读性，但如果您正在处理列表，调用`fields(0)`to`fields(25)`并不是最佳的，因为每个调用都必须遍历列表。提取器避免了这种情况。对于大多数 Java csv 解析器，您通常会得到`Array[String]`，所以这通常不是问题。最后，csv 解析通常不会返回空字符串，因此您可能希望`if (adaNotes == "") None else Some(adaNotes)`使用`Option(adaNotes)`.

```
object Row {
  def unapply(s: Seq[String]) = s match {
    case List(division, line, station, rest @ _*) =>
      val (routes,
        List(ada, adaNotes, freeCrossover, entranceType,
          entry, exitOnly, entranceStaffing, northSouthStreet, eastWestStreet,
          corner, latitude, longitude)) = rest splitAt 11 // 11 routes
      Some((
        division, line, station,
        routes,
        Entrance(
          ada.toBoolean, Option(adaNotes),
          freeCrossover.toBoolean, entranceType,
          entry == "YES", exitOnly == "YES",
          entranceStaffing, northSouthStreet, eastWestStreet, corner,
          latitude.toInt, longitude.toInt)))
    case _ => None
  }
} 
```

# iphone - iOS Safari 图像渲染问题

> ID：15501980
> 
> 赞同：4
> 
> 时间：2013-03-19T14:17:40.440
> 
> 标签：iphone, image, ipad, ios6, mobile-safari

我在 iPad 上的 Safari 中遇到了一些非常奇怪的行为。

有一个大图像会在方向改变时重新缩放和定位。这可能是题外话，但它在纵向和横向“破碎”很好。以下是它的破坏方式：

有一条大条纹水平穿过它。应用一些 CSS，我可以看到我实际上是通过条纹查看容器元素（通常大约 40 像素高，并在图像上水平运行）。

更令人费解的是，当我尝试通过将代码连接到桌面并使用桌面 Safari 的网络检查器来检查代码时会发生以下情况：我检查元素甚至附近的元素，并且图像正确呈现，就好像某些事件一样已经在 iPad 上被解雇了。诡异的。

此外，在我简单地触摸页面后，图像通常会正确呈现，而不会（据我所知）触发我的 JS 正在侦听的事件。

哦，这开始发生在我将 iOS 从 6.0 更新到 6.1 之后。

我在带有 Safari 8536.25 的 iOS 6.1.2 上。

我完全不知所措。谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T15:08:51.973

从这个问题和答案中找到答案：

[iPad Safari 滚动会导致 HTML 元素消失并延迟重新出现](https://stackoverflow.com/questions/9807620/ipad-safari-scrolling-causes-html-elements-to-disappear-and-reappear-with-a-dela)

```
*:not(html) {
    -webkit-transform: translate3d(0, 0, 0);
} 
```

我不明白，但它有效。

# javascript - HTML提交表单不刷新页面并显示警告框

> ID：15501988
> 
> 赞同：1
> 
> 时间：2013-03-19T14:18:08.600
> 
> 标签：javascript, php, html, forms, alert

我想将表单提交到 php，然后数据将更新到数据库并显示警报框。现在，数据已经更新了数据库，但警告框没有出现。我的代码有什么问题？？谢谢。

测试.html

```
<!DOCTYPE html>
<html>
<head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        function SubmitForm() {
        var category_id = $("#category_id").val();
        var category_name = $("#category_name").val();
        $.post("test.php", { category_id: category_id, category_name: category_name },
           function(data) {
             alert("Finish!");
           });
        }
    </script>
</head>
<body>

    <form action="test.php" method="post">
        category_id: <input type="text" name="category_id" id="category_id"/>
        category_name: <input type="text" name="category_name" id="category_name"/>
        <input type="button" id="searchForm" onclick="SubmitForm();" value="Send" />
    </form> 
</body>
</html> 
```

测试.php

```
<?php

$a = $_POST['category_id'];
$b = $_POST['category_name'];

$link = mysql_connect('localhost','root',''); 
mysql_select_db("fyp", $link);
$sql = "INSERT INTO category (CID, Category) VALUES (".
         PrepSQL($a) . ", " .
         PrepSQL($b) . ")";

mysql_query($sql);

function PrepSQL($value)
{
    // Stripslashes
    if(get_magic_quotes_gpc())
    {
        $value = stripslashes($value);
    }

    // Quote
    $value = "'" . mysql_real_escape_string($value) . "'";

    return($value);
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:25:04.037

尝试这个：

```
 $.post("test.php", { category_id: category_id, category_name: category_name })
      .done(
           function(data) {
               alert("Finish!");
           }
      ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T14:28:11.987

你在那里放了三个参数，它应该是两个。你可以试试这个：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
    function SubmitForm() {
    var category_id = $("#category_id").val();
    var category_name = $("#category_name").val();
    $.post("test.php", { category_id: category_id, category_name: category_name })
    .done(function() {
      alert("Finish!");
    });
    }
</script> 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T14:19:48.710

尝试这个

```
function SubmitForm() {
    var category_id = $("#category_id").val();
    var category_name = $("#category_name").val();
    $.post("test.php", { category_id: category_id, category_name: category_name })
    .done(function(data) {
           alert("Finish!");
    });
} 
```

文档[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T14:36:08.143

试试这个解决方案

```
 function SubmitForm() {
        var category_id = $("#category_id").val();
        var category_name = $("#category_name").val();
        $.ajax({
               type: "POST",
               url: "test.php", 
               data: { category_id: category_id, category_name: category_name }
        }).done (function() {
             alert("Finish");
        }).fail (function(status) {
            console.log(status);          
        }); 
```

现在检查数据，看看出了什么问题。

# c# - 将其结构化为一个语句？

> ID：15501989
> 
> 赞同：2
> 
> 时间：2013-03-19T14:18:09.397
> 
> 标签：c#, entity-framework

我有一个数据库，其中包括一对多外键，例如

```
Table {shop
[Id]
...}

Table {user
[Id]
[Shop_id]
[Archived]
} 
```

我也有如下方法

```
public IEnumerable<shop> GetShopDetails(int shopId)
{
    var foo = (from s in context.Shops
    where s.Id = shopId
    select s).ToList();

    return foo;
} 
```

因此，它将返回该商店的所有用户。大多数时候，我只真正想要未存档的用户。

有没有办法将它写入一个语句，所以我可以传入，比如 includeArchived 的第二个参数，并使用它来确定我是返回所有用户，还是只返回那些活跃的用户。

目前，我可以通过向我的商店对象添加一个返回用户子集的方法来使其工作，或者我可以加载商店，获取其 id，然后创建包含适当 fk 的单独用户集合，但是这两种方法对我来说都显得有些笨拙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T14:22:46.593

只需有条件地添加另一个`Where`条件：

```
public IQueryable<user> GetShopUsers(int shopId, bool includeArchived = false)
{
    var foo = from u in context.Users
              where u.Shop_id = shopId
              select u;

    if(!includeArchived)
        foo = foo.Where(u => !u.Archived);  

    return foo;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T14:22:51.973

我想这就是你想要的？您可以将另一个布尔参数集成到您的查询中，就像您已经对`shopId`.

```
public IQueryable<user> GetUsers(int shopId, bool includeArchived)
{
    return from user in context.Users
           where user.Shop_id = shopId
           where includeArchived || !user.Archived
           select user;
} 
```

更新：不确定您是否可以过滤商店实体自己的用户集合。您可以尝试构造匿名对象的查询：

```
var foo = from s in context.Shops
          where s.Id = shopId
          select new {
              Shop = s,
              Users = s.Users.Where(u => includeArchived || !u.Archived)
          }; 
```

# android - Android url覆盖不适用于重定向

> ID：15501990
> 
> 赞同：9
> 
> 时间：2013-03-19T14:18:10.473
> 
> 标签：android, android-intent, intentfilter, url-scheme

我有一个要在我的 Android 应用程序中覆盖的 url。单击电子邮件中指向该链接的链接会弹出`Intent Chooser`对话框（“使用完成”）。但是，从 Chrome（在 Android 4 上）中单击相同的链接（在`<a>`标签中）会将我重定向到该 url，并且不提供`Intent Chooser`.

如果我将`<a>`标签中的链接替换为指向 Google Play 商店 ( `https://play.google.com`) 的链接，则单击该链接会再次弹出`Intent Chooser`。

Google Play 商店和 Chrome 有什么特别之处，还是我在配置我的 url 时做错了什么？我可以在 html 中做些什么来完成这项工作吗？

这是`<intent-filter>`

```
<activity
    android:label="@string/app_name"
    android:name="..."
    >
    <intent-filter>
        <action android:name="android.intent.action.MAIN"/>
        <category android:name="android.intent.category.LAUNCHER"/>
    </intent-filter>
    <intent-filter>
        <action android:name="android.intent.action.VIEW"/>

        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>

        <data android:scheme="https"
              android:host="www.example.com"
            />
        <data android:scheme="http"
              android:host="www.example.com"
            />
    </intent-filter>
</activity> 
```

（重定向到 url 也不会弹出`Intent Chooser`对话框，但我认为我上面的情况更明确地表达了我的问题。）

另外值得注意的是，我相当肯定这一切都在我的域关闭时工作。一旦我的域上线，它就停止了工作。这可能是我的想象，因为当时我并没有 100% 专注于这个问题。

Chrome 是否有可能将 Google Play 商店 url 视为特殊的，否则它会在打开之前等待来自 url 的非 200 响应`Intent Chooser`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T20:36:28.480

我对此进行了相当多的修改，向您展示一种有效的方法可能会更容易。这适用于具有 2.3.4 的设备和具有 4.2.2 的设备，所以我认为它适用于大多数设备。

这是清单文件中的意图过滤器：

```
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:scheme="http" android:host="realsimpleapps.com" android:pathPrefix="/acv/" />
</intent-filter> 
```

这是我的html文件：

```
<a href="http://realsimpleapps.com/acv/aThing">Click Me!</a> 
```

在我的主要活动中，我使用它来获取我将“aThing”（上图）设置为的任何内容：

```
Uri data = getIntent().getData();
if (data != null) {
    List<String> params = data.getPathSegments();
    if (params != null) {
        Log.d(tag, "Param 0: " + params.get(0));
    }
} 
```

让它工作，然后将第二个数据元素添加到意图过滤器。如果在那之后它仍然有效，你应该被设置。

让我们知道怎么回事。

D b

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T19:03:58.097

很可能是一个真实/已知的错误。

我建议的那个（但现在已关闭，因此它似乎会针对您正在尝试的版本进行修复）： [https ://code.google.com/p/chromium/issues/detail?id=113140](https://code.google.com/p/chromium/issues/detail?id=113140)

由@xbakesk 发现/打开： [https ://code.google.com/p/chromium/issues/detail?id=170925](https://code.google.com/p/chromium/issues/detail?id=170925) [https://code.google.com/p/chromium/issues/detail?id=230104](https://code.google.com/p/chromium/issues/detail?id=230104)

如果发现任何其他错误，请在评论中告诉我，我将直接添加或编辑我的答案。如果错误被关闭，我也会尝试更新答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T15:54:42.647

我不确定您是否可以向意图过滤器添加多个数据元素。我会为不同的方案使用两个不同的意图过滤器。

如果您可以控制网页上的 url，您可以将 http 更改为您自己的自定义协议，以便您的应用程序将打开而不是沿着网络浏览器提示。

# android - 如何使用具有可变数量的 Imagebuttons 的 Gridview？

> ID：15501994
> 
> 赞同：0
> 
> 时间：2013-03-19T14:18:20.970
> 
> 标签：android

我的应用程序需要一些帮助。我需要一个基于变量包含未定义数量的 ImageButtons 的视图。也就是说，假设变量设置为 3，那么屏幕上应该会显示 3 个 Imagebutton。有什么办法可以构建这个吗？我正在尝试使用 GridView，但似乎您必须提供固定数量的图像来填充`Integer[] mThumbIds`。此外，我需要在单击事件时更改图像，而这似乎无法使用 GridView 完成。

与该主题相关的另一个问题，有什么办法可以使用具有两个以上状态的 Imagebutton？我希望图像显示当用户点击它时正在建立连接的效果，就像从图标表面到外面的那些红色条纹，好像在发送无线信号，我不知道如果你明白我的意思...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:29:00.323

GridView 将完美地满足您的需求，只需像使用 ListView 一样使用自定义适配器，覆盖 getView() 方法并在那里设置您的 onClickListener。

# node.js - Node.js Multi Server Clustering

> ID：15501997
> 
> 赞同：19
> 
> 时间：2013-03-19T14:18:36.937
> 
> 标签：node.js, distributed-computing, multiserver

I'm working on a project with Node.js that involves a server (for the sake of simplicity let's imagine this server as a chat server which have to forward messages from certain clients to other clients). I need for QoS reasons that this server is always reachable, so I thought to use clustering to divide the balance load between different servers (different physical machines) and to be sure that if a server goes down, another will be ready to serve the requests.

My question is: is this kind of distributed approach possible in Node.js?

I already read about the "cluster" module, but, from what I understood, it seems to scale only on multiprocessors on the same machine.

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-19T14:45:06.083

Yes it is possible.

It is not a property of NodeJS but rather the architecture you design for your application which will determine whether you can do it or not.

Your main problem will always be to share state across your instances, so say you have 4 chat servers A B C D, and you have a LoadBalancer L which spreads connections across the 4 servers, then when A goes down, and you reconnect all A's connections to the remaining instances, how do you ensure that the state of the chatroom is the same on B C and D?

One way is to have the application code be completely stateless, and push all data to a distributed in memory database, like mongoDb or Redis. You want the database to be distributed in case one of the database instances go down.

Now you last problem is the LoadBalancer. If that goes down, your entire system is down.

So to make a long story short; Yes you can do it, but you need to make some hard decisions on where your potential points of failure are going to be. If you want no single point of failure, you are going to need a complex and expensive setup.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-05T00:48:44.747

My recommendations is that you leverage independent clusters to share state. In other words, have an API cluster where servers dont' talk with each other, but instead share a common Redis instance/cluster, and share a common MongoDB cluster. This allows you to share sessions, variables, and you can leverage pub/sub capabilities of Redis to avoid needing any gossiping within your API cluster.

For Chat specifically, if you use Redis with Socket.IO as your client, then whenever you broadcast to a lobby, it'll use redis behind the scenes to broadcast that message to that lobby, despite lobby members existing on multiple servers. Additionally, this creates another level of fault tolerance as any server can manage socket reconnections, and socket.io will automatically reconnect to the API cluster if it's connection is broken, all while maintaining state via Redis.