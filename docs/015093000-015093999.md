# StackOverflow 问答 15093000-15093999

# python - 如何将我的 python 代码分享给其他人？

> ID：15093000
> 
> 赞同：0
> 
> 时间：2013-02-26T15:31:26.220
> 
> 标签：python

我想知道有什么方法可以将我的 python 代码作为库共享，人们可以使用它但不能更改它。

在 ios 中，我可以生成一个静态库和所有 .h 文件给其他人。程序员可以通过查看.h文件来获取他可以使用的所有方法，但是我不知道如何在Python中实现它？如何告诉一个人他可以使用哪些方法，比如 .h 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T17:52:14.763

Python 约定（在[PEP 8](http://www.python.org/dev/peps/pep-0008/)中规定）是使用前导下划线命名属性：

```
def _foo():
    """You can call this function from your own code, but you
    really shouldn't because I might change or remove it at
    any time without warning"""
    modify_guts_of_module()

def __bar():
    """Hands off. This is for the module implementation, not for
    public consumption. You can't even see this unless you go out
    of your way, and why would you do that?"""
    release_the_hounds() 
```

这是隐藏属性并告诉其他人不应使用它们的 Pythonic 方式。

# c - 即使我在 c 编程中正确输入代码，if 条件也会出错

> ID：15093004
> 
> 赞同：0
> 
> 时间：2013-02-26T15:31:34.773
> 
> 标签：c, arrays, if-statement, for-loop

```
#include <stdio.h>
#include <process.h>

int main()
{
     int check;
     int enter[7];
     int i,j;

     printf("enter any 7 number to be stored");
     for(i = 0; i < 7; i++)
           scanf("%d" ,&enter[i]);
     printf("\nenter any number to check:");
     scanf("%d" ,&check);
     for (i = 0; i < 7; i++)
     {
           if (enter[i]=check)
           {
                printf("your entry is valid");
                exit(0);
           }
           else if(enter[6]!=check)
           {
                 printf("your entry is not valid");
                 exit(0);
           }
           else
                 continue;
     }
     return 0;
} 
```

这执行没有错误但不能正常工作..总是打印出输入是有效的..即使我输入了不在数组中的数字:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:32:50.647

这是赋值，而不是相等：

```
if (enter[i]=check) 
```

改成：

```
if (enter[i] == check) 
```

此外，请始终检查输入操作的结果：

```
if (1 != scanf("%d" ,&enter[i]))
{
    /* Handle invalid value. */
} 
```

以确保后续代码对已分配值的变量进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:32:43.823

这条线

```
if (enter[i]=check) 
```

不符合您的预期。你可能是说

```
if (enter[i]==check) 
```

赋值是有效的 C，但不是检查相等性，而是设置`enter[i]`equal `check`，*然后*检查值`check`是否为零。如果它不为零，则条件成功，而不管 的初始值如何`enter[i]`。如果`check`为零，则条件失败， - 再次，无论 的初始值如何`enter[i]`。这是一个非常常见的错误；许多编译器会发出警告以提醒您注意这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:33:02.017

`=`是赋值运算符，根本不是相等。正在做：

```
if (enter[i]=check) 
```

`enter[i]`将取值`check`，然后检查是否`enter[i]`为非零。

```
if (enter[i] == check) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T15:38:18.340

```
enter[i]==check)// 2 for compare 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T16:07:06.147

= 的正确用法是赋值运算符，而 == 是测试相等性

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T00:49:33.187

```
#include<stdio.h>
#include<process.h>
int main()

{
int check;
int enter[7];
int i,j;
printf("enter any 7 number to be stored");
for(i=0;i<7;i++)
{
    scanf("%d" ,&enter[i]);

}
printf("\nenter any number to check:");
scanf("%d" ,&check);
for (i=0;i<7;i++)
{
   // printf("\nvalue of i is %d\n" ,i);
    if (check==enter[i])
    {
        printf("your entry is valid");
        exit(0);
    }
    else if(enter[i]!=check && i==6)
    {

        printf("your entry is not valid");
        exit(0);
    }
    else
    continue;
}
return 0;
}

 now i got it all right . thanks :) 
```

# express - express.js + passport.js 会话

> ID：15093018
> 
> 赞同：6
> 
> 时间：2013-02-26T15:32:18.913
> 
> 标签：express, socket.io, passport.js

**目标**

我想做的事：

*   为用户创建会话
*   为套接字创建会话 ( `socket.io`)
*   用于`passport.js`验证登录和`socket`会话。

**笔记**

我已经安装`MongoStore`和`passport.socket.io npm's`. 我可以登录并设置登录`cookie`用户的（`connect.sid`）

* * *

**问题**

如何设置系统来存储`socket`会话并将它们与用户耦合`session`？

* * *

**代码**

应用程序.js

```
 /* The usual express setup */
  passport = require('passport'),
  LocalStrategy = require('passport-local').Strategy,
  User = require('./models/user.js'),
  MongoStore = require('connect-mongo')(express);

app.use(express.cookieParser());
  app.use(express.bodyParser());
  app.use(express.session({
    secret: 'chuck norris', 
    store: new MongoStore({db: User.name}, // the db's name
        function(err) {
          console.log(err || 'connect ok!');
        })
  }));
  app.use(express.methodOverride());
  app.use(passport.initialize());
  app.use(passport.session());
  app.use(app.router); 
```

* * *

app.js（护照部分）

```
passport.use(new LocalStrategy({
    usernameField: 'username',
    passwordField: 'password'
  },
  function(username, password, done) {
    User.findOne({username: username}, function(err, user) {
      if(!user) {
        return done(null, false, {message: 'Incorrect Username!'});
      }
      if(!user.validPassword(password)) {
        return done(null, false, {message: 'Incorrect Password!'});
      }
      return done(null, user);
    });
  }
));

passport.serializeUser(function(user, done) {
  done(null, user.id);
});

passport.deserializeUser(function(id, done) {
  User.findById(id, function(err, user) {
    done(err, user);
  });
});

app.post('/',
  passport.authenticate('local'),
    function(req, res) {
      res.redirect('/home/'+req.user.username);
    }); 
```

* * *

app.js（socket.io 部分）

```
io.set('authorization', passportSocket.authorize({
  key: 'connect.sid',
  secret: 'chuck norris',
  store: /* Not entirely sure what goes here */
  fail : function(data, accept) { accept(null, false); },
  success: function(data, accept) { accept(null, true); }
}));

io.sockets.on('connection', function(socket) {
  console.log('User Connected: ' + socket.handshake.user.username);
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T00:31:08.133

您将新的内存故事对象实例存储到一个变量中，然后像这样将它传递给 express 和 socket io。（请注意，我们使用的是不同的商店，但从理论上讲，只要您以正确的方式传递控制权，您使用哪家商店并不重要）...

```
var ...
,MemoryStore = express.session.MemoryStore
,sessionStore = new MemoryStore(); 
```

然后在 app.configure 你...

```
app.use(express.session({store:sessionStore,secret:'secret',key:'express.sid'})); 
```

最后在 socket.io 中配置

```
io.configure(function (){
io.set("authorization", passportSocketIo.authorize({
    key:    'express.sid',       //the cookie where express (or connect) stores its session id.
    secret: 'secret', //the session secret to parse the cookie
    store:   sessionStore,     //the session store that express uses
    fail: function(data, accept) {
        // console.log("failed");
        // console.log(data);// *optional* callbacks on success or fail
        accept(null, false);             // second param takes boolean on whether or not to allow handshake
    },
    success: function(data, accept) {
      //  console.log("success socket.io auth");
     //   console.log(data);
        accept(null, true);
    }
})); 
```

如果您已正确执行此操作并且您的用户成功通过身份验证，那么您应该能够访问握手对象上的会话数据。

```
console.log(socket.handshake.user.username);
//or sometimes it might be...
console.log(socket.handshake.user[0].username); 
```

希望有帮助。

# php - Facebook 登录适用于桌面，但不适用于移动设备

> ID：15093020
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:24.007
> 
> 标签：php, facebook, codeigniter, mobile, facebook-php-sdk

当我尝试在我的网站上使用 Facebook 登录时（*这是我们注册用户的方式*），它在桌面上完美运行，但是当我在移动设备上尝试时，誓言对话框显示“ `An error occurred. Please try again later.`”

**我尝试过/检查过的事情：**

*   `appId`与[https://developers.facebook.com/](https://developers.facebook.com/)中的`secret`内容都是正确的
*   我正在使用 PHP SDK 登录。
*   我`$this->facebook->getLoginUrl(array('scope'=>'email,user_birthday,user_about_me','redirect_uri' => $loginURL));`用来生成登录 URL。

有谁知道我还能如何调试这个问题？或者知道是什么原因造成的吗？

# .net - IE 10 RSS 提要阅读器不会在框架中呈现。在自己的窗口中工作正常

> ID：15093021
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:27.327
> 
> 标签：.net, asp-classic, rss, frame, internet-explorer-10

好的，我正在维护一个已部署的 Web 应用程序，但使用 IE10 中的内置阅读器进行 RSS 提要渲染时遇到问题。RSS 提要在一个框架内呈现。

应用程序的操作就是这样工作的。生成 RSS XML 的页面的链接显示在框架内。单击该链接会导致将 XML 呈现给浏览器。

在除 IE10 之外的所有浏览器中使用其内置的提要阅读器，这都有效。在 IE10 中，取而代之的是靠近框架左上角的一个小方块。如果复制链接地址，然后在其自己的选项卡中导航到它，则它呈现正常。如果在 IE10 中关闭了提要阅读器，则会显示正确的 XML。

它只是在框架中的 IE10 中不起作用。我还没有在 Google 上找到任何涵盖 IE10 的内容。我已经尝试从注册表中禁用缩放，并且可以验证这不能解决任何问题。

有没有人有任何其他建议可以尝试？我不能做的事情包括强制用户进入兼容模式、强制用户下载外部 rss 阅读器、强制 RSS 提要到自己的选项卡。

谢谢，

马特

# drupal - Drupal 在 Vagrant 环境中非常慢

> ID：15093023
> 
> 赞同：12
> 
> 时间：2013-02-26T15:32:32.713
> 
> 标签：drupal, drupal-7, vagrant

我已经开始将我们的很多开发环境迁移到 Vagrant。到目前为止，这对几乎所有事情都很好，但是我们的第一个 Drupal 迁移无法使用。它慢得令人难以置信。我们的 Wordpress、CakePHP 和 Node.js 站点的性能都非常好或更好，但 Drupal 则不然。这种想法简直*太可怕*了。

盒子是 Veewee 创建的 Ubuntu 12.04 64 位机器。它与我们用于所有基于 Web 的项目的基本盒子相同，因此没有什么独特之处。在我的站点目录中，我有一个`sites/my-site/`包含所有站点资源的规范目录`sites/dev.mysite.com -> /vagrant/www/sites/my-site`（

这是一个混合的 Windows/OSX 开发团队，在两个平台上都很慢。我唯一的半非常规片段`Vagrantfile`是这样的：

```
config.vm.forward_port 80, 8080

config.vm.share_folder( "v-root", "/vagrant", ".", :extra => 'dmode=777,fmode=777' )

# Allows symlinks to the host directory.
config.vm.customize ["setextradata", :id, "VBoxInternal2/SharedFoldersEnableSymlinksCreate/v-root", "1"]

Vagrant::Config.run do |config|
  config.vm.provision :shell, :path => "provision.vm.sh"
end 
```

我的 shell 配置器只做几件事：

*   安装 drush
*   创建上述到规范站点目录的符号链接
*   写出一个 Nginx 服务器块
*   如有必要，创建一个`settings.php`文件。

我能做些什么来提高性能吗？喜欢，很多？

**更新**

我已将其范围缩小到看起来问题出在远程数据库的程度。为了比较苹果和没有项目包袱的苹果，我下载了 Drupal 7.21 的新副本，并从 Vagrant Web 服务器对 3 个不同的数据库执行了标准安装：

*   在与网络服务器 (localhost) 相同的 Vagrant VM 上创建的新数据库
*   在原始问题 (dev) 中使用的共享开发服务器上创建的新数据库
*   在 EC2 实例上创建的新数据库 (tmp)

完成后，我登录到新的 Drupal 安装并加载主页 (localhost:8080) 5 次。然后我连接到每个数据库并以相同的方式加载相同的页面。我发现当 Drupal 连接到远程数据库时，页面加载速度慢了 4-6 倍。

请记住，这是一个全新的（标准）安装。没有项目包袱。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-11T09:29:30.933

我也遇到了类似的问题。对于具有 +1000 个文件的项目树，VirtualBox 共享文件夹似乎[非常慢](http://groups.drupal.org/node/270828)。

[切换到 NFS](http://docs.vagrantup.com/v2/synced-folders/nfs.html)可能是解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-17T14:17:47.693

几乎可以肯定，这个问题要么是`skip_name_resolve`（在 中需要`my.cnf`）要么是 VirtualBox 对包含大量文件的共享目录的糟糕处理。两者都很容易追踪`strace -c`，但您可能会发现一次更正一个并查看哪一个解决了您的性能问题会更容易。

如果在这两项更改之后您仍然看到速度缓慢，请告诉我，我们可以进一步调试它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-25T14:45:30.867

我是通过谷歌来到这里的，所以我正在回复，希望其他人觉得这很有用。

如果您使用精确32 vagrant box 作为您的起点，值得注意的是该盒子默认只有360MB 的RAM。

像这样向上运行（至少在带有 VirtualBox 的 Vagrant V2 中）

```
config.vm.provider :virtualbox do |vb|
    vb.customize ["modifyvm", :id, "--memory", "1024"]
end 
```

这使 Drupal 对我的响应更加灵敏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-26T16:17:55.907

它只是一个 PHP/MySQL 应用程序，因此 Drupal 除了如何定制之外并没有什么特别之处。您可能已经完成了其中的一些操作，但这里有一些隔离问题的建议。

*   检查 Drupal dblog 是否有错误。
*   检查您的 nginx 和 php 日志是否有错误。
*   考虑您正在运行多少个活动模块（超过 100 个？那将是一个非常繁重的安装）
*   安装一个新的 Drupal 实例并进行比较。这可能会将问题隔离到您的实例，而不是一般的 Drupal。

如果你发现它是你的 Drupal 实例

*   安装 devel 模块并启用内存报告，这样您就知道每次页面加载使用了多少内存，并有一个改进的基线。
*   确保您安装了 APC 或其他 PHP opcache，并确保命中率良好。如果您之前没有运行过它，请注意 devel 报告的内存使用差异。
*   运行 xhprof 之类的东西或禁用可疑模块，直到找到主要违规者。
*   启用 mysql slow & index log 以发现潜在问题，然后适当添加索引或采取其他措施

如果您的其他应用程序运行良好，我怀疑某个特定模块存在问题，或者您安装的 Drupal 通常需要一些优化或更多内存。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-07T19:04:44.490

我尝试了几乎所有方法来让我缓慢的 Vagrant 加速，最后在项目的问题跟踪器中偶然发现了这一点。

```
config.vm.provider "virtualbox" do |v|
    v.memory = 1024
    v.customize ["modifyvm", :id, "--natdnshostresolver1", "on"]
    v.customize ["modifyvm", :id, "--natdnsproxy1", "on"]
end 
```

我之前尝试过 NFS 无济于事；这恰好是银弹。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-01T01:41:18.663

从 Vagrant 1.5 开始，您可以使用 rsync 作为将文件夹同步到客户机的机制。因为 rsync 将文件直接复制到远程文件系统上，所以性能明显优于 NFS 和 VM 共享文件夹。

您可以在此处阅读更多相关信息：[http](http://www.vagrantup.com/blog/feature-preview-vagrant-1-5-rsync.html) ://www.vagrantup.com/blog/feature-preview-vagrant-1-5-rsync.html 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-21T23:27:24.627

我只是想自己解决这个问题。我在这里和 Rails Windows Vagrant 尝试了这些建议，[响应时间非常慢](https://stackoverflow.com/questions/27476394/rails-windows-vagrant-very-slow-response-time#29305489)。没有真正的运气，在没有呈现真实数据的情况下，我将 1800 毫秒的响应时间缩短了 200 毫秒。这使用 Ruby on Rails，而不是 Drupal。不过，问题是一样的。

将共享文件夹切换到 Rsync 后，我对同一请求的响应时间约为 280 毫秒。

流浪文件：

```
 config.vm.synced_folder '.', '/vagrant', type: 'rsync',
                                       rsync__exclude: '.git/' 
```

用法：

```
$ vagrant up
$ vagrant rsync-auto 
```

后一个命令将监视您的工作目录并自动更改同步。

请参阅[https://www.vagrantup.com/docs/synced-folders/rsync.html](https://www.vagrantup.com/docs/synced-folders/rsync.html)和[https://www.vagrantup.com/docs/cli/rsync-auto.html](https://www.vagrantup.com/docs/cli/rsync-auto.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-05T14:23:27.837

延迟是任何服务器环境中数据库连接的一个大问题。即使只是在数据库连接上运行加密也将是一个重大的性能问题，尽管在这些条件下可能需要它。

您对数据库的 ping 时间是多少？如果您运行的每个查询至少有一次往返，那么这将加起来。再加上一点加密时间。又更糟了。如果您不使用持久数据库连接。

我会考虑你在哪里做缓存。例如，缓存在 VM 上的 memcached 中，而不是在数据库中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-07T09:52:36.447

我遇到了同样的问题。这些建议对那些使用 Windows 主机的人特别有帮助。如果没有 NFS 支持，您将无法获得不错的性能（对于 Windows，这是一个大问题），因此：

1.  根本不要使用同步文件夹。

    ```
    config.vm.synced_folder "../data", "/vagrant", disabled: true 
    ```

2.  在 Windows 主机上的来宾 VM + 网络驱动器中设置 samba 服务器。有很多文章如何做到这一点，例如：[https ://www.liberiangeek.net/2014/07/ubuntu-tips-create-samba-file-server-ubuntu-14-04/](https://www.liberiangeek.net/2014/07/ubuntu-tips-create-samba-file-server-ubuntu-14-04/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-01-24T17:00:12.400

如果与 Vagrant 共享的 NFS 对您来说仍然太慢，您可以执行相反的操作：

*   您可以将其安装在 VM 来宾上，而不是在主机上安装 NFS 服务器：http: [//guillaumeduveau.com/en/drupal-lightning-fast-synced-folders-in-vagrant-virtualbox/](http://guillaumeduveau.com/en/drupal-lightning-fast-synced-folders-in-vagrant-virtualbox/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-19T15:54:56.867

安装 nodejs 和 gulp 后，我开始在 drupal 站点上获得缓慢的性能。我必须这样做，因为 drupal bootstrap 4 barrio sass 子主题需要 nodejs/gulp。然后我在 Windows 和 npm install 命令中遇到了 vagrant 的问题。所有 npm install 命令都会失败，因为它们会创建符号链接并且 Windows 操作系统无法识别这些链接。我必须创建一个指向站点 node_modules 文件夹的符号链接到我的 vagrant 主目录。npm install 命令在执行此操作后起作用。但后来我开始注意到这个网站上的响应非常缓慢。我的其他网站运行速度很快。

# markdown - Markdown 不适用于 django-rest-framework

> ID：15093025
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:34.563
> 
> 标签：markdown, django-rest-framework

我目前正在使用 django-rest-framework 构建一个 API。

示例（例如[http://restframework.herokuapp.com/](http://restframework.herokuapp.com/)）具有对文档的 Markdown 支持。

如何在我自己的项目中激活它？它不是开箱即用的，我似乎无法在网站上找到这方面的帮助（在教程文档中）。我已经安装`markdown`了 pip (v2.1.1)。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T17:34:55.900

您需要做的就是安装`markdown`，然后编写降价格式的文档字符串。

如果它不起作用，您可能需要仔细检查您是否已将 markdown 安装到项目 virtualenv 中，而不是全局安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-16T14:27:55.813

1.  安装`markdown`：

    ```
    pip install markdown 
    ```

2.  `Ctrl + c`通过按下正在运行的终端来停止 Django 服务器

3.  再次启动 Django 服务器：`python manage.py runserver`

Django 会注意到 django 项目目录中文件的变化，但在安装新包时不会。因此，安装 markdown 后需要手动重启 Django。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T18:09:37.233

嗯，感觉有点傻。

我的代码是：

```
class UserList(ListCreateAPIView):
    """
    Display all `users`.
    """ 
```

工作代码应该是：

```
class UserList(ListCreateAPIView):
    """
Display all `users`.
    """ 
```

（markdown 字符串不应该缩进）

# mysql - 通过 csv 将大量数据上传到 mysql Wordpress 数据库中？

> ID：15093026
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:38.747
> 
> 标签：mysql, wordpress

我在 Excel 中有一个大型数据集，我想将其导入我的 mysql 数据库以供 Wordpress 使用。

Wordpress 中的当前数据由两个重要部分组成 - 用户和帖子（带有自定义数据）。每个人都在网站上注册（通过前端）并且必须填写一些关于他们公司的自定义数据 - 然后创建一个帖子并将所有自定义数据放入自定义字段。

我使用插件[高级自](http://www.advancedcustomfields.com)定义字段在帖子中输入自定义字段。

如何将此列表直接上传到 mysql 数据库中？似乎 Wordpress 中的当前数据涉及将用户 mysql 表与 usermeta 表和帖子与 post 元表链接......但所有这些似乎都在行而不是列中，这需要大量的工作重新排序。

没有更简单的方法吗？

如果我必须分 3 个阶段进行（1\. 用户。2\. 帖子。3\. 帖子元数据），那么我将不得不这样做。但肯定有更快更可靠的解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:39:24.580

有一些插件可以为您做到这一点，例如：

[http://wordpress.org/extend/plugins/csv-importer/](http://wordpress.org/extend/plugins/csv-importer/)

[http://wordpress.org/extend/plugins/wp-ultimate-csv-importer/](http://wordpress.org/extend/plugins/wp-ultimate-csv-importer/)

您需要设置 WordPress 的空白副本，安装插件，然后从那里开始。

# ios - 处理 PDF 文件和应用内购买

> ID：15093031
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:46.877
> 
> 标签：ios, in-app-purchase

我已经搜索了很多，我不确定最好的做法是什么，所以我在这里问。

我有一个应用程序，可以在其中进行应用内购买以购买一些 PDF 书籍。这些书只是复制到我项目的资源文件夹中。

据我了解，可以解压缩 IPA，然后访问 PDF 文件（如果它们位于我的资源文件夹中） - 那么我应该将它们存储在哪里？

我阅读了有关文档文件夹的多篇文章，但有人说它仅适用于用户生成的文档，如果文件太大，苹果会拒绝。（我知道可以设置 donotbackup）

因此，我希望能够保存给定 PDF 书籍的路径，并确保只有在购买时才能看到它（通过核心数据中实体的属性）:)。

有人有什么想法吗？:)

# java - 摆脱 Tomcat 中的 Spring 日志

> ID：15093032
> 
> 赞同：0
> 
> 时间：2013-02-26T15:32:47.390
> 
> 标签：java, spring, tomcat, spring-mvc, spring-security

我正在为在 Tomcat 7 上运行的 Java Web 应用程序使用 spring-mvc 和安全性。我通过扩展 AbstractAuthenticationProcessingFilter 来自定义 spring 安全性并捕获自定义异常，我有一个扩展 ExceptionHandlerExceptionResolver 的类。

现在，当我遇到异常时，无论是否运行时，我都无法在我的 tomcat 日志中看到异常的原因。Tomcat 会生成一个日志，该日志是关于 spring 安全链中的类和 ExceptionHandlerExceptionResolver 类的。

如何取回我的默认日志？

示例日志：

> org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:927) org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:811) javax.servlet.http.HttpServlet.service(HttpServlet.java: 621) org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:796) javax.servlet.http.HttpServlet.service(HttpServlet.java:728) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter( FilterChainProxy.java:330) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.session.SessionManagementFilter。 doFilter(SessionManagementFilter.java:103) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113) org. springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:150) org.springframework.security.web。FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java: 342) com.cagatay.deneme.server.security.AuthFilter.doFilter(AuthFilter.java:65) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web。 authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter。 doFilterInternal(WebAsyncManagerIntegrationFilter.java:50) org.springframework。web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter. java:125) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87) org.springframework.security。 web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192) org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160) org.springframework.web.filter。DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
> 
> **根本原因**java.lang.NullPointerException com.cagatay.deneme.server.controller.errorhandler.ErrorController.doResolveHandlerMethodException(ErrorController.java:40) org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:60) org.springframework .web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136) org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1148) org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java :985) org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:939) org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856) org.springframework.web。servlet.FrameworkServlet.processRequest(FrameworkServlet.java:915) org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:811) javax.servlet.http.HttpServlet.service(HttpServlet.java:621) org.springframework。 web.servlet.FrameworkServlet.service(FrameworkServlet.java:796) javax.servlet.http.HttpServlet.service(HttpServlet.java:728) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118) org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84) org.springframework.security。 web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web。access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java: 103) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113) org.springframework.security.web。 FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:150) org.springframework.security.web.FilterChainProxy$VirtualFilterChain。doFilter(FilterChainProxy.java:342) org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) com。 cagatay.deneme.server.security.AuthFilter.doFilter(AuthFilter.java:65) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.authentication.logout。 LogoutFilter.doFilter(LogoutFilter.java:105) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter. java:50) org.springframework.web.filter.OncePerRequestFilter。doFilter(OncePerRequestFilter.java:107) org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:125) org. springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342) org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87) org.springframework.security.web.FilterChainProxy$VirtualFilterChain。 doFilter(FilterChainProxy.java:342) org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192) org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160) org.springframework.web。 filter.DelegatingFilterProxy。invokeDelegate(DelegatingFilterProxy.java:346) org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:35:45.923

根据堆栈跟踪，看起来您`NullPointerException`在`com.cagatay.deneme.server.controller.errorhandler.ErrorController`. 您需要找出导致此问题的原因并进行修复。

编辑：

根据[AbstractHandlerMethodExceptionResolver 的文档](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/servlet/handler/AbstractHandlerMethodExceptionResolver.html#doResolveException%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse,%20java.lang.Object,%20java.lang.Exception%29)，异常处理程序应该返回一个`ModelAndView`. 在您的代码中，`NullPointerException`抛出了 a 。现在不看你的代码，我不知道你是否重新抛出异常，但堆栈跟踪让我相信 NPE 起源于第 40 行。恕我直言，异常处理程序本身不应该抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-06T01:42:09.793

在最高级别，您可以捕获任何预期的和意外的异常，并在您希望它们出现时自己手动记录它们，而不是让它们传播到 Spring 并让它自己做事。

一种方法是使用 ExceptionHandler。示例：[http ://www.mkyong.com/spring-mvc/spring-mvc-exceptionhandler-example/](http://www.mkyong.com/spring-mvc/spring-mvc-exceptionhandler-example/)

# jquery - 有没有办法在主干中调用 model.destroy 时覆盖 url

> ID：15093037
> 
> 赞同：5
> 
> 时间：2013-02-26T15:32:52.010
> 
> 标签：jquery, backbone.js

Rigt 现在我正在调用 model.destroy()，一个对服务器端的 DELETE 请求

我想在进行销毁时覆盖 url 调用，我将无法更改 urlRoot。

有什么办法吗？

谢谢，普拉茨

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-26T15:40:59.727

```
var MyModel = Backbone.Model.extend({
    destroy: function (options) {
        var opts = _.extend({url: '/destroy/' + this.id}, options || {});
        return Backbone.Model.prototype.destroy.call(this, opts);
    }
)}; 
```

所有基于 AJAX 的交互最终都由`Backbone.sync`选项对象处理，如果骨干的默认 URL 方案不适用于您的服务器，则可以在其中提供 URL。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-26T16:27:00.537

调用时可以通过`destroy`。

`this.model.destroy( { url: "your-custom-url/" } );`

# caching - Grails 在客户端存储和获取数据

> ID：15093039
> 
> 赞同：1
> 
> 时间：2013-02-26T15:32:58.237
> 
> 标签：caching, grails, cookies, local-storage

背景：我们正在使用 grails 2.1.1。到目前为止，我们没有使用任何数据库。我们为另一台服务器上的每个响应进行 Web 服务调用。

现在的问题是，有一个 Web 服务调用以 XML 形式返回一些静态数据，并且这些数据在整个应用程序中都是可用的。xml 的大小约为 40kb。此 xml 包含静态数据，如 project_list、status_type_list 等，我们必须在不同 gsp 页面的各种下拉菜单和菜单项中使用它。

因此，请向我们建议处理这些数据的最佳方式。这样它就不会影响我们的页面加载时间和浏览体验。我们也可以轻松地使用客户端的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:02:54.473

使用[缓存插件](http://grails.org/plugin/cache)缓存静态 xml 数据。然后添加一些关于何时更新缓存的策略......（即使用作业检查xml是否每小时更改一次）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T06:24:33.237

回复您对该问题的评论。如果要求像您所说的那样简单，我更喜欢在插件上使用基于注释的缓存。

如果调用是从服务器端进行的，并且您想要缓存解析的 XML 的结果，那么您可以执行以下操作：

```
@Cacheable("staticDataCache")
def getStaticDataFromXML() {} 
```

然后，您可以使用上述方法拉取地图，列出您用于存储结果的任何数据结构，并将其从缓存中拉取。

然后是另一个刷新缓存的服务方法，您可以从作业中频繁调用它。

```
@CacheFlush("staticDataCache")
def flushStaticDataCache() {} 
```

# ajax - 阿贾克斯帖子标题

> ID：15093046
> 
> 赞同：1
> 
> 时间：2013-02-26T15:33:16.673
> 
> 标签：ajax, rest, post, jersey

我有 Post 方法的 Ajax 调用，它使用 XML 并生成 PDF。如何在 AJAX 中设置我的标题？任何有关异常的输入都会有很大帮助。我确实浏览过，但没有找到太多关于此的内容。

```
Ext.Ajax.request({
        url : "/rest/sample/" + sampleId + "/sam",
        params : params,
        form : downloadForm,
        isUpload : true,
        method : 'POST',
        headers: {'Content-Type': 'text/xml'},
        scope : this,
        xmlData: XMLSampleData
    }); 
```

XMLSampleData 具有 Xml 数据。

休息 ：

```
 @Path("/sam")
    @Produces("application/pdf")
    @Consumes({"application/xml", "text/xml"}) 
```

我不断收到此异常：

```
Uncaught REST Server Error: null
javax.ws.rs.WebApplicationException
    at com.sun.jersey.server.impl.uri.rules.TerminatingRule.accept(TerminatingRule.java:66)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:86)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:136)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:74)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1357)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1289)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1239)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1229)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:420)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:497)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:684)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)
    at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:324)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T19:40:23.637

该异常可能有不同的原因，但是当我为 RuntimeException 实现自己的映射器时遇到了它。虽然我的映射器在技术上是正确的，但它似乎使 Jersey 内置的错误处理短路了。删除我的映射器清除了异常，我从 Jersey 得到了预期的错误代码（405、415 等）。

此外，请确保您为每个 REST 资源都包含一个方法。使用您的示例，那将是：

```
@Path("/sam")
@POST                             <---- Include a Method (POST, GET, PUT, etc)
@Produces("application/pdf")
@Consumes({"application/xml", "text/xml"}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T06:49:45.240

请尝试指定“接受”标题，例如。

```
headers: {'Content-Type': 'text/xml', 'Accept': 'application/pdf'}, 
```

# sql - SQL Server 2005 未在日志文件中收集登录信息

> ID：15093048
> 
> 赞同：0
> 
> 时间：2013-02-26T15:33:19.247
> 
> 标签：sql, sql-server-2005, error-log

我目前在 Windows 2003 服务器计算机上运行 SQL Server 2005 标准版。

我已经转到服务器的属性并确认`Login Auditing`设置为失败和成功登录。出于某种原因，当我知道两者都有登录时，SQL Server 日志中的失败或成功登录中没有任何内容。

我已经搜索到了这个原因，并没有想出任何有用的东西，所以我希望这里有人能给我一点方向。这适用于我的其他 SQL Server，所以我知道在哪里查找结果，但那里没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-24T17:01:57.577

在与 Microsoft 讨论此问题并进行大量研究后，确定这是在特定版本的 Windows 版本上运行的特定 SQL 版本（SQL Server 2005 Service Pack 2 9.00.3042）的问题。我们重新安装了 SQL，然后对 Windows 和 SQL 进行了所有更新和补丁，这似乎已经解决了这个问题。SQL 日志现在跟踪成功和失败的登录。

# java - Spring Security 同一个ip地址多次登录

> ID：15093050
> 
> 赞同：3
> 
> 时间：2013-02-26T15:33:20.087
> 
> 标签：java, spring, spring-security, ip-address

我的问候。

我有这样一个问题。spring security 中是否有任何方法可以检查来自同一 IP 地址的登录数量？我的意思是，如果有人从这个当前 IP 登录，我想通知他他无法使用不同的凭据（例如从不同的浏览器）登录并拒绝登录尝试。

我试图用谷歌搜索它并找到以下内容，但这不是我要找的东西：

[使用 Spring Security 的 IP 过滤器](https://stackoverflow.com/questions/12786123/ip-filter-using-spring-security)

[在 Spring 3.1 中通过 IP 地址进行身份验证：最聪明的方法是什么？](https://stackoverflow.com/questions/10147161/authenticating-by-ip-address-in-spring-3-1-smartest-way-to-do-that)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T13:16:19.847

一种可能的解决方案是实现一对自定义`AuthenticationSuccessHandler`，`LogoutSuccessHandler`并且（都可以访问 http 请求）可以维护一个并发映射，该映射保存由其 ip 地址键入的登录用户数量。然后添加一个自定义过滤器，该过滤器拦截登录请求，检查该映射，并在用户 IP 地址超出限制时重定向用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T17:42:44.717

我认为没有办法开箱即用。您实际上可以做的是限制来自一个浏览器实例的最大连接数（请参阅[并发会话章节](http://static.springsource.org/spring-security/site/docs/3.2.x/reference/springsecurity-single.html#ns-concurrent-sessions)）。

如果这对您来说还不够，那么您可以手动完成（感谢 Spring Security 中精心设计的扩展点）。[按照此处](http://static.springsource.org/spring-security/site/docs/3.2.x/reference/springsecurity-single.html#ns-custom-filters)的说明定义您的自定义过滤器。为会话注册表声明一个别名并[加载所有主体](http://static.springsource.org/spring-security/site/docs/3.2.x/reference/springsecurity-single.html#list-authenticated-principals)。在正常情况下，每个主体将由 Authentication 对象表示。Authentication.getDetails() 可能包含一个 IP 地址。查找重复项并将用户重定向到某个错误页面。希望这可以帮助。

**编辑。**它不起作用，因为会话注册表中的主体实际上是 org.springframework.security.core.userdetails.User 的一个实例，而不是身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T16:51:39.940

***SessionAuthenticationStrategy***是监视和控制登录尝试的点。已经有***ConcurrentSessionControlStrategy***用于限制由相同用户名登录的会话。您可以扩展它或从中学习。并重定向或转发到***SimpleUrlAuthenticationFailureHandler***中的错误页面。

```
/**
 * Strategy which handles concurrent session-control, in addition to the functionality provided by the base class.
 *
 * When invoked following an authentication, it will check whether the user in question should be allowed to proceed,
 * by comparing the number of sessions they already have active with the configured <tt>maximumSessions</tt> value.
 * The {@link SessionRegistry} is used as the source of data on authenticated users and session data.
 * <p>
 * If a user has reached the maximum number of permitted sessions, the behaviour depends on the
 * <tt>exceptionIfMaxExceeded</tt> property. The default behaviour is to expired the least recently used session, which
 * will be invalidated by the {@link ConcurrentSessionFilter} if accessed again. If <tt>exceptionIfMaxExceeded</tt> is
 * set to <tt>true</tt>, however, the user will be prevented from starting a new authenticated session.
 * <p>
 * This strategy can be injected into both the {@link SessionManagementFilter} and instances of
 * {@link AbstractAuthenticationProcessingFilter} (typically {@link UsernamePasswordAuthenticationFilter}).
 *
 * @author Luke Taylor
 * @since 3.0
 */
public class ConcurrentSessionControlStrategy extends SessionFixationProtectionStrategy 
```

# iphone - 在动态 UITableView 中关闭 iPhone 键盘

> ID：15093052
> 
> 赞同：0
> 
> 时间：2013-02-26T15:33:24.733
> 
> 标签：iphone, ios, objective-c

我有`UITableView`两个部分。第一部分是带有步进器的静态行，可创建第二部分的单元格。第二部分的每个单元格都包含`UITextField`带键盘。我可以使用键盘或键盘中的附加完成按钮关闭键盘`UITapGestureRecognizer`，但它仅适用于最后一个单元格。我尝试了以下方法：

1.  `UITapGestureRecognizer`在表格视图中

在我的`ViewDidLoad`我放：

```
 UITapGestureRecognizer *gestureRecognizer = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(hideKeyboard)];
    [self.tableView addGestureRecognizer:gestureRecognizer]; 
```

进而

```
-(void)hideKeyboard{
    [self.tableView resignFirstResponder];
} 
```

或者

```
-(void)hideKeyboard:(UITapGestureRecognizer*)sender{
    [self.cellText endEditing:YES];
} 
```

1.  使用标签来识别我正在编辑的文本字段。

在

```
 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath I added
    [cellText addTarget:self action:@selector(myNumberValueBeginEditing:) forControlEvents:UIControlEventEditingDidBegin]; 
```

并且在

```
-(void)myNumberValueBeginEditing:(UITextField *)sender
{
    int row = [sender.superview.superview tag];
    UITextField *cellTemp = (UITextField*)[(UITableViewCell *)sender.superview viewWithTag:200+row];
    cellTemp.delegate = self;
    [cellTemp becomeFirstResponder];
} 
```

然后我试图在 DONE 按钮中 resignFirstResponder

```
-(IBAction)doneButton:(UITextField *)sender {
NSLog(@"doneButton");
    int row = [sender.superview.superview tag];
    [(UITextField*)[(UITableViewCell *)sender.superview viewWithTag:200+row] resignFirstResponder];
} 
```

我没有更多的想法如何从所有人中退出键盘`UITextFields`。如果有人有一些补救措施，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:42:13.067

您对`endEditing:`. 不要发送`endEditing:`到您的文本字段的实例，而是尝试将其发送到您的主视图。前任：

```
[self.view endEditing:YES]; 
```

`endEditing:`可以直接发送到文本字段实例或视图，在后者的情况下，任何正在编辑的文本字段是您指定的视图的子视图，都将退出第一响应者。

从文档：

> 导致视图（或其嵌入的文本字段之一）放弃第一响应者状态

# ruby - 使用 awesome_print 将 Ruby 对象转换为 HTML 字符串

> ID：15093053
> 
> 赞同：1
> 
> 时间：2013-02-26T15:33:24.607
> 
> 标签：ruby

我正在尝试使用 awesome_print 美化一个 Ruby 对象，以便我可以将此字符串放在电子邮件中并将其发送出去。所以就代码而言，（我知道这是错误的），但这是我想要实现的目标：

```
my_str = (ap error.object).to_str
# Do something with my_str, like stick it in a <pre> tag inside an html email. 
```

如何将输出从 ap 转换为字符串？我问的原因是我注意到，ap 似乎只返回对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-29T14:45:13.560

它似乎没有记录在 README.md 中，但是如果您查看该库在此处所做的内核修改：[https ://github.com/michaeldv/awesome_print/blob/master/lib/awesome_print/core_ext/kernel .rb](https://github.com/michaeldv/awesome_print/blob/master/lib/awesome_print/core_ext/kernel.rb)

可以看到，除了`ap`方法之外，*awesome_print* gem 还`ai`为所有对象添加了方法。

```
1.9.3p392 :001 > require 'awesome_print'
 => true 
1.9.3p392 :002 > test = {a: "b"}
 => {:a=>"b"}
1.9.3p392 :003 > ap test
{
    :a => "b"
}
1.9.3p392 :006 > test.ai
 => "{\n    :a\e[0;37m => \e[0m\e[0;33m\"b\"\e[0m\n}" 
1.9.3p392 :007 > test.ai(html:true)
 => "<pre>{\n    <pre>:a</pre><kbd style=\"color:slategray\"> =&gt; </kbd><pre><kbd style=\"color:brown\">&quot;b&quot;</kbd></pre>\n}</pre>" 
```

也就是说，输出格式可能没那么有用（html 版本添加了大量空白，非 html 版本具有奇怪的终端着色字符），并且作为一个未记录的功能，它很可能在没有警告的情况下中断未成年人版本更新。

`kernel.rb`上面值得注意的另一件事是`ap`and`ai`有别名：`awesome_print`和`awesome_inspect`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:54:50.203

awesomeprint 用于打印 ASCII 颜色和东西，而不是 HTML。我使用的是 pygments gem：

```
# gem install pygments.rb
require 'pygments'

str = <<EOT
# This is an awesome comment on my rb script
a = 2
puts a
hsh = {asdf: 1, qwer: 2, uiop: 3}
EOT

Pygments.highlight str 
```

[https://github.com/tmm1/pygments.rb](https://github.com/tmm1/pygments.rb)

# c# - C#每隔几秒执行一个后台线程（预定）

> ID：15093061
> 
> 赞同：0
> 
> 时间：2013-02-26T15:33:46.980
> 
> 标签：c#, multithreading, threadpool

我刚开始学习 C#，我是一名 Java 程序员。在 Java 中，我可以执行以下操作：

```
 int corePoolSize = 1;
    long initialDelay = 0;//0 seconds
    long delay = 60;//60 seconds
    ScheduledThreadPoolExecutor stpe = new ScheduledThreadPoolExecutor(corePoolSize);
    stpe.scheduleWithFixedDelay(new MyDemoClass(), initialDelay, delay, TimeUnit.SECONDS); 
```

它将每 60 秒在后台线程中执行 Runnable“MyDemoClass”。

我将如何在 C# 中执行此操作？我查看了它的 ThreadPool [http://msdn.microsoft.com/en-us/library/3dasc8as(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/3dasc8as%28v=vs.80%29.aspx)，但它似乎不是我想要的。

非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:38:50.187

将[System.Timers.Timer](http://msdn.microsoft.com/en-us/library/0tcs6ww8.aspx)与`Interval`连接到`Elapsed`执行所需周期性逻辑的事件处理程序一起使用。

> Timer 组件是一个基于服务器的计时器，它允许您指定在应用程序中引发 Elapsed 事件的重复间隔。然后，您可以处理此事件以提供常规处理。例如，假设您有一台关键服务器必须每周 7 天、每天 24 小时保持运行。您可以创建一个使用 Timer 定期检查服务器并确保系统正常运行的服务。如果系统没有响应，该服务可能会尝试重新启动服务器或通知管理员。

您不应该需要线程池来完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:44:55.143

我认为您正在寻找 System.Threading.Timer
[http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)

> "使用 TimerCallback 委托来指定您希望 Timer 执行的方法。计时器委托在构造计时器时指定，并且不能更改。该方法不在创建计时器的线程上执行；它在 ThreadPool 上执行系统提供的线程。”

# ruby - 在中间人模板中迭代 yaml 数据

> ID：15093062
> 
> 赞同：0
> 
> 时间：2013-02-26T15:33:47.323
> 
> 标签：ruby, sinatra, yaml, padrino, middleman

我有一个 yaml 文件中的项目列表，我想动态循环通过中间人应用程序中的模板，但我不确定如何或是否可以/应该更动态地执行它。

我有：

```
data.projects.each do |f|
  proxy "/work/#{f[:name].parameterize}.html", "/work/template.html", 
    :locals => { name: f[:name], client: f[:client], ... } #would like to dynamically pull in keys as locals.
end

ignore "/work/template.html" 
```

yaml：

```
-  name: Acme Website
   client: Acme Inc
   overview: "Cupcake ipsum dolor sit amet wafer gummi bears pudding applicake. Jujubes brownie powder. Sweet roll powder gingerbread gummies. Cupcake ice cream sweet roll pie lollipop. Jelly-o jelly-o apple pie chupa chups jelly jujubes gingerbread. Icing carrot cake powder chupa chups. Pudding sweet roll jelly-o muffin faworki biscuit. Marzipan marshmallow cake tiramisu caramels bear claw carrot cake cotton candy. Toffee danish sweet roll. Cookie topping powder toffee ice cream muffin dragée. Soufflé caramels apple pie chocolate cake cookie cake. Macaroon tiramisu halvah soufflé. Dessert toffee halvah chocolate cake bear claw."
   skills:
   - design
   - development
   - branding
   - ecommerce
   stack:
   - middleman
   - branding
   - design 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T06:57:06.190

也许您可以`project`在模板中使用完整的对象？

```
data.projects.each do |p|
  proxy "/work/#{p[:name].parameterize}.html", "work/template.html",
    :locals => { :p => p }
end 
```

...应该让您在以下范围内访问您的项目*`http://0.0.0.0:4567/work/acme-website.html`*：

```
<ul>
 <li><%= p.name %></li>
 <li><%= p.client %></li>
</ul> 
```

**结果：**

*   Acme 网站
*   Acme 公司

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:43:27.387

首先，您需要将 YAML 解析回 Ruby 对象，然后从那里开始：

```
require 'yaml'

doc = YAML.load(<<EOT)
---
-  name: Acme Website
  client: Acme Inc
  overview: "Cupcake ipsum dolor sit amet wafer gummi bears pudding applicake. Jujubes brownie powder. Sweet roll powder gingerbread gummies. Cupcake ice cream sweet roll pie lollipop. Jelly-o jelly-o apple pie chupa chups jelly jujubes gingerbread. Icing carrot cake powder chupa chups. Pudding sweet roll jelly-o muffin faworki biscuit. Marzipan marshmallow cake tiramisu caramels bear claw carrot cake cotton candy. Toffee danish sweet roll. Cookie topping powder toffee ice cream muffin dragée. Soufflé caramels apple pie chocolate cake cookie cake. Macaroon tiramisu halvah soufflé. Dessert toffee halvah chocolate cake bear claw."
  skills:
  - design
  - development
  - branding
  - ecommerce
  stack:
  - middleman
  - branding
  - design
EOT

require 'pp'
pp doc 
```

哪个输出：

```
[{"name"=>"Acme Website",
  "client"=>"Acme Inc",
  "overview"=>
  "Cupcake ipsum dolor sit amet wafer gummi bears pudding applicake. Jujubes brownie powder. Sweet roll powder gingerbread gummies. Cupcake ice cream sweet roll pie lollipop. Jelly-o jelly-o apple pie chupa chups jelly jujubes gingerbread. Icing carrot cake powder chupa chups. Pudding sweet roll jelly-o muffin faworki biscuit. Marzipan marshmallow cake tiramisu caramels bear claw carrot cake cotton candy. Toffee danish sweet roll. Cookie topping powder toffee ice cream muffin dragée. Soufflé caramels apple pie chocolate cake cookie cake. Macaroon tiramisu halvah soufflé. Dessert toffee halvah chocolate cake bear claw.",
  "skills"=>["design", "development", "branding", "ecommerce"],
  "stack"=>["middleman", "branding", "design"]}] 
```

这是一个哈希数组。您可以遍历返回的数组，并提取嵌入的哈希值并正常处理它们：

```
doc.each { |h|
  puts h['name']
  puts h['client']
} 
```

# c# - 我应该把这个方法放在我的业务对象或服务中还是做一个扩展方法

> ID：15093065
> 
> 赞同：1
> 
> 时间：2013-02-26T15:34:02.400
> 
> 标签：c#, oop

在我的 PeriodService 我有这个方法：

```
private IEnumerable<DateTime> GetAllWeekStartingDays(DateTime start, DateTime end, DayOfWeek firstDayOfWeek)
        {
             return Enumerable
                    .Range(0, end.Subtract(start).Days + 1).Select(offset => start.AddDays(offset))
                    .Where(d => d.DayOfWeek == firstDayOfWeek);             
        } 
```

firstDayOfWeek 是来自业务对象 XXX 的参数。上述方法让我整天都在一个时间跨度内可能是星期一/星期日。

我应该将此方法作为私有实例方法放入我的 Period Service（它是 atm）中，还是作为公共静态方法放入我的业务对象 Period.cs 中，或者从中制作一个我真正不喜欢的扩展方法（难以跟踪/找到他们...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:41:33.383

如果你是[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)的粉丝，那么你**不会**把它放在你的 Period Service 中。这是因为它会给定期服务另一个改变的理由。例如，如果此方法将来有某种时区问题。

如果您认为扩展方法过于隐藏，您可以将其重构为一个`DateService`可以注入您的 Period Service 的类。

**更新**：根据我的评论，如果选项是打开的，我会选择为此使用扩展方法：

```
public static IEnumerable<DateTime> GetAllWeekStartingDays(this DateTime start, DateTime end, DayOfWeek firstDayOfWeek)
        {
             return Enumerable
                    .Range(0, end.Subtract(start).Days + 1).Select(offset => start.AddDays(offset))
                    .Where(d => d.DayOfWeek == firstDayOfWeek);             
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T20:11:55.277

该类`Period`不是此方法的正确位置，句号:)。这不是`Period`行为，因为它不依赖于`Period`状态。简而言之，这就是 OO：结合状态和行为。`Period` *可以*有类似的方法

```
IEnumerable<DateTime> GetWeekStartingDays(DayOfWeek firstDayOfWeek) 
```

并使用它自己的开始和结束日期（假设它们在那里）返回结果。

它可能属于`PeriodService`. 服务通常是具有一些依赖项的类，例如存储库或 Web 服务，并且基本上充当这些依赖项的包装器。不使用这些依赖项的方法只会使服务过于“忙碌”，并且通常属于其他地方，但支持服务的公共方法的*私有实用程序方法除外。*因此，如果您的方法仅用作`PeriodService`它所属的私有方法，因为它的范围（私有）尽可能小。否则，我会将其设为 Eli Gassert 建议的内部（？）静态实用程序方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:05:23.653

我们可以看看你是怎么称呼它的吗？

我的意思是，我有一种感觉，你已经知道`IEnumerable<DateTime>`你打电话的地方，每次你打电话时，你都会做重复的工作来确定开始和结束日期。在这种情况下，有一个扩展方法`IEnumerable<DateTime>`可以避免你重复自己。

```
public static IEnumerable<DateTime> GetDays(this IEnumerable dates, DayOfWeek day)
{
     var start = dates.Min();
     var end = dates.Max();
     return Enumerable
            .Range(0, end.Subtract(start).Days + 1).Select(offset => start.AddDays(offset))
            .Where(d => d.DayOfWeek == day);             
} 
```

然后你可以简单地这样称呼它：

```
var mondays = mydates.GetDays(DayOfWeek.Monday); 
```

如果您仍然坚持使用前一个，则可以简单地覆盖：

```
private IEnumerable<DateTime> GetDays(DateTime start, DateTime end, DayOfWeek day)
{
    return new List<DateTime>(){ start, end }.GetDays(day);
} 
```

请注意，我重命名了您的方法，因为它推断出的目的比方法的功能更窄。换句话说，您可以使用相同的方法来获取范围内的任何工作日，而不仅仅是一周的开始日期。例如，这会阻止其他编码人员创建一种新方法来获得星期三。

# c# - 为什么在 C# 中没有 Directory.Copy

> ID：15093066
> 
> 赞同：13
> 
> 时间：2013-02-26T15:34:10.093
> 
> 标签：c#, .net, directory

我正在用 C# 编写一个包含大量 IO 操作的程序。其中一些操作是复制目录。

当我发现你在 C# 中没有像 Directory.copy(SourceDir, DestinationDir) 这样的东西时，我真的很震惊。

我用谷歌搜索了一下，在 msdn 上他们提供了一个代码示例来复制目录。（[http://msdn.microsoft.com/en-us/library/bb762914.aspx](http://msdn.microsoft.com/en-us/library/bb762914.aspx)）。但是，当您进一步搜索时，Microsoft.VisualBasic.FileIO 命名空间中有一个 Directory.Copy 方法。( [http://msdn.microsoft.com/en-us/library/ms127957.aspx](http://msdn.microsoft.com/en-us/library/ms127957.aspx) )

我可以参考这个命名空间并使用这个方法，但一定有微软在 C# 中不支持这个以及为什么他们没有在 msdn 上提及它的原因。

希望有人能告诉我原因。

我可以编写扩展方法来解决这个问题并且我可以很容易地解决它，但我的问题是为什么？为什么C#中没有这样的方法，我只想知道:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T15:36:02.743

`foreach`因为在 a上做 a 很容易`DirectoryInfo.GetFiles()`，同时也让你有机会过滤正在复制的文件列表，或者做一些除了复制之外的其他操作。

`DirectoryInfo`如果它真的困扰您，请为该类或`FileInfo[]`集合编写一个扩展方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:40:17.790

我的猜测是 VB 更多地面向初学者，并且`Microsoft.VisualBasic.FileIO`旨在吸引他们进入 .NET 世界。

# ruby-on-rails - 无法使用 bootstrap_forms gem 访问验证错误

> ID：15093067
> 
> 赞同：0
> 
> 时间：2013-02-26T15:34:09.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, form-for, bootstrap-sass

无法使用 gem 'bootstrap_forms'、'~> 2.0.0' ( [http://github.com/potenza/bootstrap_form](http://github.com/potenza/bootstrap_form) ) 显示验证错误。

**模型/client.rb**

```
class Client < ActiveRecord::Base
  attr_accessible :name
  validates :name, :presence => true
end 
```

**意见/客户/new.html.haml**

```
= bootstrap_form_for @client do |f|
  = f.object.errors.messages
  %h1 Create New Client
  .row-fluid
    .span3= f.text_field :name, :class => 'span50'
  = f.submit 
```

提交上述表单代码时，f.object.class 为 'Client'，f.object.messages 为空哈希。

将此代码切换为使用表单构建器中内置的 rails 可以让我看到验证错误：

**意见/客户/new.html.haml**

```
= form_for @client do |f|
  = f.object.errors.messages
  %h1 Create New Client
  .row-fluid
    .span3= f.text_field :name, :class => 'span50'
  = f.submit 
```

使用这个，f.object.messages 是 {:name=>["can't be blank"]}。

这有道理吗？我不明白为什么 f.object.errors.messages 是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:37:52.460

试试这个：

```
 f.errors.full_messages 
```

# symfony - Twig 检查对象内的对象

> ID：15093068
> 
> 赞同：1
> 
> 时间：2013-02-26T15:34:17.163
> 
> 标签：symfony, twig

我在 Symfony 应用程序中有一个投票系统，我正在使用 Twig 引擎。我希望能够在我的模板中做这样的事情来向用户展示他们已经投票（想想 StackOverflow 橙色箭头）。

```
<div class="vote {% if entry.votes.user == loggedinuser %}already-voted{% endif %}">Vote</a> 
```

问题在于，每个条目都可以有多个投票（`votes`实际上是一个`PersistentCollection`。我知道我可以用 PHP 甚至通过循环每个条目来做到这一点`votes.user`，但这很混乱）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T20:37:46.327

您可以向您的实体添加一个方法，以便您的模板保持干净，并将业务逻辑隐藏在实体中，类似于：

```
<div class="vote {% if entry.hasVoted(loggedinuser) %}already-voted{% endif %}">Vote</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:42:41.560

~~您可以使用[in](http://twig.sensiolabs.org/doc/templates.html#containment-operator)运算符，而不是遍历每个投票实例。~~根据 Twig 文档，*in*过滤器将对实现 Traversable 接口的字符串、数组或对象执行包含测试。

尝试以下操作：

```
<div class="vote {% if loggedinuser in entry.votes.user %}already-voted{% endif %}">Vote</a> 
```

**编辑：**

似乎*in*运算符不适用于集合内的实例。恐怕您需要遍历每个投票以检查两个用户是否匹配。

为了防止事情变得混乱，您可以使用[宏](http://twig.sensiolabs.org/doc/tags/macro.html)。

希望能帮助到你。

# scala - 为什么 Scala 不能从隐含的证据中推断出类型

> ID：15093071
> 
> 赞同：3
> 
> 时间：2013-02-26T15:34:20.287
> 
> 标签：scala, type-inference

我已经尝试过了，但失败并*出现错误：缺少扩展函数的参数类型 ((x$29) => x$29.sum)*。

有人可以解释为什么会这样吗？这仅仅是Scala的类型推断不够强大吗？

```
object HelloStackOverflow {
    implicit class Repro[T](val iterable: Iterable[T]) extends AnyVal {
        def foo[A, B, Z](bar: Iterable[B] => Z)(implicit evidence: T <:< (A, B)) =
            bar(iterable.map(_._2))
    }

    List(("a", 1), ("b", 2)).foo(_.sum)
} 
```

（使用 Scala 2.10）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T16:53:15.827

这是因为“必须完全知道匿名函数的参数类型”（Scala 语言规范 8.5）。

当一个方法接受一个匿名函数时，scala 使用它知道参数类型的事实来让调用者省略匿名函数参数的类型（让你写类似的东西`x => x+1`代替`x: Int => x+1`，或`_.sum`代替`x: Iterable[Int] => x.sum`。这是其中之一在 scala 中很好的推理应用。但显然，这首先需要知道匿名函数的确切预期类型，这不是这里的情况：匿名函数的参数`bar` 是类型`Iterable[B]`.`B`是一个自由类型变量，不能以任何方式从早期的参数列表中推断出来（方法中**没有**先前的参数列表`foo`）。所以根本不可能知道`B` 匿名函数中的类型`(_.sum)`可以推断，这会触发错误，因为知道规范要求的确切类型。

这是很合乎逻辑的。在 Scala 中，匿名函数只是（像任何函数一样）一个对象。创建一个匿名函数意味着实例化一个泛型类（即 extends `Function*`），其中函数参数的类型被编码为类的类型参数`Function*`（再读一遍，我保证这句话是有道理的）。如果不完全指定类型参数，就不可能实例化任何泛型类。函数也不例外。

正如在评论中显示的那样，显式指定匿名函数参数的类型修复了编译错误：

```
List(("a", 1), ("b", 2)).foo((a : Iterable[Int]) => a.sum) 
```

甚至：

```
List(("a", 1), ("b", 2)).foo((_.sum):Iterable[Int] => Int) 
```

但是在您的情况下，无需显式指定匿名函数的类型即可解决问题似乎很简单：

```
object HelloStackOverflow {
    implicit class Repro[A,B](val iterable: Iterable[(A,B)]) extends AnyVal {
        def foo[Z](bar: Iterable[B] => Z) =
            bar(iterable.map(_._2))
    }

    List(("a", 1), ("b", 2)).foo(_.sum) // works like a charm
} 
```

也许您使用单个类型参数`T`（而不是参数`A`，`B`如上面的示例）的原因`T <: (A, B)`是，在您的真实代码中，您在类`Repro`中有其他不需要`T`成对的方法。`Repro2`在这种情况下，只需创建另一个带有类型参数的隐式类`T`，然后将这些其他方法迁移到那里。您**不需要**将所有丰富内容放在同一个隐式类中。

# assembly - 64位操作系统上的Turbo Assembler的任何替代品？

> ID：15093072
> 
> 赞同：2
> 
> 时间：2013-02-26T15:34:23.843
> 
> 标签：assembly, tasm

我对 80x86 汇编语言有点陌生，我们被教导使用 TASM，因为它是安装在我们实验室 PC​​ 上的汇编程序。然后，我想在家练习汇编语言编程，所以我搜索并下载了 TASM5 和 TASMeditor，因为它们是互联网上可用的。但是，我发现它不适用于我的 64 位 Windows 8 操作系统。搜索“TASM 64 bit”显示了如何使用 DOSBOX 进行模拟，但这太乏味并且可能会产生问题。搜索术语“TASM 替代品”产生了 NASM 和 YASM。YASM使用起来有点复杂，所以我没有理会它，NASM和TASM有不同的语法。所以，我的问题是，我可以用什么来替代 TASM？没有语法变化？还有其他建议吗？

进阶谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:01:18.657

有 MASM32 包（AFAIU，MASM 的非官方版本，从各种 Windows SDK 和 DDK 中免费提取），其语法类似于 TASM。

Open Watcom 的 WASM 及其分支 JWasm 也类似。

我个人更喜欢 NASM，它比 TASM 和 MASM 可以在更多平台上使用，它支持多种格式，而且我觉得可以更好地控制它们。此外，它不像 TASM/MASM/WASM 那样冗长。

# r - 使用 ggplot 绘制整体数据集和子集

> ID：15093077
> 
> 赞同：2
> 
> 时间：2013-02-26T15:34:30.223
> 
> 标签：r, ggplot2

我有一个数据集，按照嵌套的要点组织成子类别和子子类别：

```
-1
 -1a
  -1ai
  -1aii
 -1b
  -1bi 
```

...等等。

我想使用 ggplot2 制作一个点图，其中显示**1**的所有数据，然后仅显示**1a**的数据，然后仅显示**1ai**的数据，依此类推。

示例数据集：

```
x <- data.frame(cat=1, subA=letters[rep(1:5,each=10)], 
subB=as.character(as.roman(rep(1:5,5,each=2))),value=rnorm(50,20,7))

> head(x)
  cat subA subB    value
1   1    a    I 26.75573
2   1    a    I 12.52218
3   1    a   II 24.53499
4   1    a   II 23.21012
5   1    a  III 11.18173
6   1    a  III 25.01914 
```

我想最终得到一个看起来像这样的图表：

![子集和整体数据点图](../Images/22c1bbe5b5c334f605d9c9f316eaf5e0.png)

我能够通过做大量子集和 rbinding 来制作这个图，以制作大量冗余的衍生数据框，但这似乎是做错事的一个明显例子。

```
x2 <- with(x,rbind(cbind(key="1",x), 
cbind(key="1 a",x[paste(cat,subA) == "1 a",]), 
cbind(key="1 a I",x[paste(cat,subA,subB) == "1 a I",]), 
cbind(key="1 a II",x[paste(cat,subA,subB) == "1 a II",])))

library(ggplot2)
library(plyr)
ggplot(x2,aes(x=reorder(key,desc(key)),y=value)) 
+ geom_point(position=position_jitter(width=0.1,height=0)) 
+ coord_flip() + scale_x_discrete("Category") 
```

有没有更好的方法来做到这一点？一个相关的问题是，如果每个值总是添加相同数量的抖动，无论它是针对“1”还是“1 a”或“1 a II”绘制的，那会很好，但我什至没有确定从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:56:45.010

除了用单独的组重建数据之外，我想不出其他方法，如下所示：

```
x.m1 <- x[c("cat", "value")]
x.m2 <- do.call(rbind, lapply(split(x, interaction(x[, 1:2])), function(y) {
    y$cat <- do.call(paste0, y[, 1:2])
    y[c("cat", "value")]
}))
x.m3 <- do.call(rbind, lapply(split(x, interaction(x[, 1:3])), function(y) {
    y$cat <- do.call(paste0, y[, 1:3])
    y[c("cat", "value")]
}))

y <- rbind(x.m1, x.m2, x.m3)

ggplot(data = y, aes(x = value, y = cat)) + geom_point() 
```

![ggplot2_multiple_levels](../Images/b7bcd8eb3a2f92d8a9639674b131dfb8.png)

**注意：**您应该重新排序`cat`列的级别`y`以按照您想要的方式对 y 轴进行排序。我会把它留给你。

**编辑：**按照@Justin 的建议，您可以执行以下操作：

```
x.m1 <- x
x.m1$grp <- x$cat
x.m2 <- do.call(rbind, lapply(split(x, interaction(x[, 1:2])), function(y) {
    y$grp <- do.call(paste0, y[, 1:2])
    y
}))
x.m3 <- do.call(rbind, lapply(split(x, interaction(x[, 1:3])), function(y) {
    y$grp <- do.call(paste0, y[, 1:3])
    y
}))

y <- rbind(x.m1, x.m2, x.m3)

ggplot(data = y, aes(x = value, y = grp)) + geom_point(aes(colour=subA, shape=subB)) 
```

![ggplot2_multiple_levels_color_shape](../Images/e323f341bcf7bac18637da160db9a26b.png)

# intuit-partner-platform - 在我的开发人员中心测试 asp.net 应用程序时出现 OpenID 错误

> ID：15093081
> 
> 赞同：0
> 
> 时间：2013-02-26T15:34:35.380
> 
> 标签：intuit-partner-platform, intuit

我正在测试使用 .NET Devkit 2.0 开发的应用程序。在我的开发人员中心，我正在尝试在页面的“测试您的应用程序”部分中运行连接测试。OAuth 测试工作正常，但是当我尝试测试 OpenID 时出现错误。

当我单击“从 Intuit App Center (OpenID) 测试订阅应用程序”时，它会将我带到公司连接页面，然后我选择公司，然后它会将我带到我的应用程序的免费试用页面。当我单击“授权”时，我收到 404 错误。

URL 指向：
`https://myserver.com/Error.aspx?aspxerrorpath=/myapp/OpenIdHandler.aspx`
其中 myserver 是我的开发服务器的名称，myapp 是我的应用程序的名称。

我能够顺利地从 Visual Studio 运行该应用程序。它按预期连接并运行，但是当我在开发中心尝试它时，它无法正常工作。

我的应用程序设置是否正确？在这种情况下，我应该指向 OpenIdHandler.aspx 吗？

开发中心的应用设置：
应用 URL：`https://myserver/myapp/Default.aspx`
断开连接 登陆 URL：`https://myserver/myapp/Disconnect.aspx`
管理用户 URL：`https://myserver/myapp/Default.aspx`
OpenID URL：`https://myserver/myapp/OpenIdHandler.aspx`

这是我第一次发布到 Intuit App Center，所以任何建议都会有很大帮助。我什至不确定开发中心的设置是否有问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:55:35.660

我的防火墙设置不正确，因此它不允许任何流量访问该站点的所需页面。我似乎很好奇我能够进入默认页面但没有其他页面。无论如何，它现在有效。

# eclipse - 在 Eclipse ide 上为 java ee 开发人员安装市场

> ID：15093084
> 
> 赞同：0
> 
> 时间：2013-02-26T15:34:40.853
> 
> 标签：eclipse, eclipse-marketplace

如何在 Eclipse ide 上为 java ee 开发人员安装市场？我正在使用 Eclipse 平台 v3.3.2。我想在市场上安装 Glassfish、Subversion 和其他工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:27:03.577

如果您查看[Marketplace 下载页面](http://www.eclipse.org/mpc/archive.php)，您会看到第一个支持的版本是 Helios，Eclipse 3.6。所以我不认为 Marketplace 可以与您的安装 Europe, Eclipse 3.3.2 一起使用。你必须在旧版本中寻找所有你需要的东西，至少对于 Subversion 你应该找到它。

更好的选择是至少更新到 Eclipse 3.7。

# perl - 如何像这样在awk中找到最小元素的索引？

> ID：15093087
> 
> 赞同：0
> 
> 时间：2013-02-26T15:34:48.273
> 
> 标签：perl, shell, sed, awk

输入文件

```
Cat|Dog|Dragon   -40|1000|-20
K|B|L|D|E        -9|1|-100|-8|9 
```

输出文件：

```
Dragon 20
B      1 
```

工作流程是这样的：在 column2 中，找到绝对值最小的索引，然后使用该索引获取 column1 中的元素。有人对此有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:06:21.830

使用我难以置信的感知能力，我发现了一个暗示，这并不完全是一个操作问题。可以`Homework`吗？

```
{
  split($1, catdog, "|")
  split($2, numbers, "|")
  smallest = -1
  for(i in numbers) {
    a = numbers[i]
    if(a < 0)
      a = -a
    if(smallest == -1 || a < smallest) {
      smallest = a
      j = i
    }
  }
  printf("%-9s %2d\n",  catdog[j], smallest)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:09:07.603

```
perl -lnwe '($k,$v) = map [split /\|/], split;
             my %a; 
             @a{@$k} = map abs, @$v; 
             print "$_\t$a{$_}" for 
                 (sort { $a{$a} <=> $a{$b} } keys %a)[0];
            ' input.txt 
```

**输出：**

```
Dragon  20
B       1 
```

**解释：**

命令行开关：

*   `-l`处理行尾，为方便起见
*   `-n`从参数文件名或标准输入读取输入

编码：

最右边`split`在空白处分割每一行。我们在管道上再次拆分这些字段`|`并将结果放入数组 ref 中`[ ... ]`，以便它们适合标量变量 ( `$k`and `$v`)。然后我们声明一个词法哈希`%a`来保存每个新输入行的数据。我们需要这个声明来避免一行中的值泄漏到下一行。然后，我们通过散列切片将键从 分配`$k`给 中的绝对值`$v`。这与以下原理相同：

```
@foo{'a', 'b', 'c'} = (1, 2, 3);  # %foo = ( a => 1, b => 2, c => 3); 
```

然后我们对值进行哈希排序，取第一个带有下标的值，`[0]`并打印出相应的键和值，并用制表符分隔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:58:42.633

以下`awk`命令应该可以工作：

```
awk '
function abs(value)
{
  return (value<0?-value:value)
}
{
   len=split($2,arr,"|")
   min=abs(arr[1])
   minI=1
   for(i=1;i<=len;i++){
       if(abs(arr[i])<min){
           min=abs(arr[i])
           minI=i
       }
   }
   split($1,arr2,"|")
   print(arr2[minI],min)   
}' file 
```

输出：

```
Dragon 20
B 1 
```

# grails - 无法保持一对多关系

> ID：15093091
> 
> 赞同：2
> 
> 时间：2013-02-26T15:35:02.657
> 
> 标签：grails, grails-orm

在我目前的项目中，我无法保持一对多的关系。关系的双方都将被保存 - 只是缺少他们之间的链接。

我的两个域之间的一对多关系如下所示：

```
class Parent {
    String name
    ...

    static hasMany = [childs: Child]

    Parent() {}

    Parent(SomeOtherClass obj) {
        this.properties = obj.properties  
    }
}

class Child {
    int code
    String description     
} 
```

我正在创建我的`Parent`实例`ParentService`：

```
public Boolean createParents(List parentIds) {
    boolean savedSuccessfully = true
    Parent.withTransaction {status ->
        parentIds.each { parentIdString ->
            if (parentIdString && parentIdString.isInteger()) {
                int parentId = parentIdString.toInteger()

                def parentInstance = new Parent(someOtherService.getExternalParentObj(parentId))

                someOtherService.getExternalChilds(parentId).each { entry ->
                    parentInstance.addToChilds(Child.findOrSaveWhere(code: entry.key, description: entry.value))
                }

                if(!parentInstance.save()) {
                    status.setRollbackOnly()
                    savedSuccessfully = false
                }
            }
        }
    }

    return savedSuccessfully
} 
```

实例`Parent`和`Child`实例均已成功创建和保存。只是缺少父母和孩子之间的联系。`childs`每个实例的属性`Parent`是一个空列表。

我不知道这里有什么问题。为什么关系不会持久？有任何想法吗？

**更新**

我添加了一个集成测试，以在创建所有实例后`ParentService`测试列表的存在：`childs``Parent`

```
...
assert parentService.createParents(["123","234","356"]) == true
def parent = Parent.get(1)
assert parent.childs.size() > 0
... 
```

出乎意料 - 测试通过了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T17:42:29.290

我找到了错误的根源。

我完全错过了`entry.value`一些`null`。不知道为什么我在调试时没有看到它。

现在我只使用`Child.findOrSaveWhere()`if `entry.value`is not `null`。

我原以为整体`parentInstance.save()`会完全通过或失败。仍然不明白为什么连接表不会被填充而不给出任何错误。

# image - 如何复制 Facebook 图像手势的代码？

> ID：15093093
> 
> 赞同：0
> 
> 时间：2013-02-26T15:35:07.880
> 
> 标签：image, uiscrollview, zooming, gesture

我正在开发一个由多个图像组成的教育应用程序。我也是编码和 XCode 的新手。我想知道如何获取我的图像，以便它们响应类似于 facebook 上的照片的手势（滑动、最小/最大缩放、在一张图像上滚动全部）。我`UIImage`有`UIScrollview`。

我可以添加所有手势`UIScrollView`还是必须单独添加每个手势？因为该应用程序由多个 png 图像组成，我必须单独连接每个图像还是有一种方法可以为整个程序实现一个代码？

我正在使用 Storyboard 并且编码最少。

如果这些信息已经存在，我将不胜感激。我曾尝试使用 iOS 库中的“使用捏合手势进行基本缩放”，但收效甚微。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T03:31:08.563

看看这个教程。 [http://www.raywenderlich.com/6567/uigesturerecognizer-tutorial-in-ios-5-pinches-pans-and-more](http://www.raywenderlich.com/6567/uigesturerecognizer-tutorial-in-ios-5-pinches-pans-and-more)

在这个过程中，他们会准确地检查您想要的内容，放大和缩小图像并滑动。几乎你使用 UIGestureRecognizers。:)

# jquery - 在 twitter bootstrap 模态表单中未触发 keyup 事件

> ID：15093112
> 
> 赞同：1
> 
> 时间：2013-02-26T15:35:53.710
> 
> 标签：jquery, twitter-bootstrap

我正在使用 Twitter 引导程序。

我创建了一个模态窗口，它按预期被调用。

在这个模态中，有一个表格：

```
<div id="initialSurveyInfo" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modalId" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="modalId">Initial Survey Information</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal">
            <div class="control-group">
                <label class="control-label" for="surveyTitle">Survey Title :</label>
                <div class="controls">
                    <input type="text" id="surveyTitle">
                    <span class="help-inline muted"><span class="char-limit">36</span> character(s) left</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="surveyDesc">Description:</label>
                <div class="controls">
                    <textarea rows="5"></textarea>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal" aria-hidden="true">Cancel</a>
        <a href="/createSurvey" class="btn btn-primary continue">Continue</a>
    </div>
</div> 
```

对于输入，用户仅限于 36 个字符。超过 36 个字符，我想禁用“继续”按钮。
我在输入旁边有当前字符数。

我处理这个问题的 jQuery 代码是：

```
$(document).ready(function() {

    var calculate = function() {
        var chararcters = $("#surveyTitle").val().length;

        var remaining = 36 - characters;

        if (remaining >= 0) {
            $(".char-limit").val(remaining);
            if ($(".continue").hasClass("disabled") === true) {
                $(".continue").removeClass("disabled");
            }
        } else {
            $(".continue").addClass("disabled");
        }
    };

    $("#surveyTitle").keyup(calculate);
    $("#surveyTitle").change(calculate);
}); 
```

不幸的是，keyup() 和 change() 事件/方法没有被触发。因此，剩余字符数不会减少，当字符数超过时，“继续”按钮也不会被禁用。
我替换`keyup`为`on('keyup', function)`- 这也不起作用。

关于如何响应 keyup 事件的任何想法 - 主要问题是在这种情况下如何更改“剩余字符数”？

我也在使用 AngularJS，但我认为它无论如何都不会影响（模态窗口位于 AngularJS 根据之前的操作加载的视图模板中）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T14:50:24.317

终于找到了解决办法。@sasi 的解决方案部分正确。

基本上，这里讨论了这个问题：[https ://github.com/twitter/bootstrap/issues/2380](https://github.com/twitter/bootstrap/issues/2380)

解决方法如下：
更换

```
$("#surveyTitle").keyup(calculate); 
```

和

```
$("body").on('keyup', "#surveyTitle", calculate); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:38:04.670

```
on('keyup','#surveyTitle', function) {

}

$("body").on('keyup', "#surveyTitle", calculate); 
```

你试过这样吗..？

# pandas - 分组和聚合的问题

> ID：15093115
> 
> 赞同：0
> 
> 时间：2013-02-26T15:35:58.857
> 
> 标签：pandas

我正在尝试使用 pandas 从一组结果中选择一个结果，其中某些列具有最小值。代表我的数据框的示例表是：

```
ID q ABCD
---------------
1 10 1 2 3 4
1 5 5 6 7 8
2 1 9 1 2 3
2 2 8 7 6 5

```

我想按 ID 分组，然后为每个组选择具有最小 q 的行。因此，ID=1 对应的第二行和 ID=2 对应的第一行将被选中。

我只能选择每列的最低值，这不是我需要的。非常感谢任何可以提供一些指导的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:43:04.230

这应该可以满足您的要求：

```
In [10]: df.groupby('ID').apply(lambda x: x.ix[x['q'].idxmin()])
Out[10]:
    ID  q  A  B  C  D
ID
1    1  5  5  6  7  8
2    2  1  9  1  2  3 
```

应用一个函数，该函数返回具有最小 'q' 值索引的组行。

# c - C - 通过 TCP 发送缓冲区的适当大小

> ID：15093116
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:00.243
> 
> 标签：c, sockets, tcp, buffer

我正在编写一个 C 客户端-服务器应用程序。

双方交换char缓冲区以进行通信。

这些缓冲区的合适大小是多少？在面向流的套接字上
是否存在 a `read()`（或 a ）可读（或可写）的字节数限制？`write()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:44:27.520

只要您正确编写代码，只要保持连接就没有限制。这就是流连接的含义。

请记住这一点，`write()`并且`read()`在他们写入/读取您提供/要求的所有数据之前都可以返回。在这种情况下，返回值会告诉您写入/读取了多少，您有责任再次调用该函数以继续写入/读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:44:53.797

这取决于您的目标是高吞吐量还是低延迟。大缓冲区用于高吞吐量，小缓冲区用于低延迟。另请注意，当发送带有 x 字节的缓冲区时，读取和写入函数不保证发送所有 x 字节。确保检查返回值以查看发送/接收的字节数继续发送/接收其余的（这通常通过 while 循环完成，直到您发送/接收整个缓冲区大小 x）。

# ios - GHUnit 和 AFNetWorking 之间的兼容性

> ID：15093118
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:02.677
> 
> 标签：ios, objective-c-blocks, afnetworking, gh-unit

> 嗨，我尝试使用 GHUnit 创建单元测试，但我有一个异常，我认为这是 AFNetWorking 和 GHUnit
> 异常 'GHTestFailureException' 之间的兼容性问题，原因：'失败' ***第一次抛出调用堆栈：（0x1de4012 0x163fe7e 0x1e6cfb1 0x2a4c1 0x2f20 0x137a4 0x191553f 0x1927014 0x19177d5 0x1d8aaf5 0x1d89f44 0x1d89e1b 0x21777e3 0x2177668 0x7b065c 0x1f3c 0x1e95）的libc ++ abi.dylib：终止叫做抛出一个异常

```
 NSURL *url = [NSURL @"https://www.myWebsite.com"];
        NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:60.0];

        AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc]initWithRequest:theRequest];

        [operation setAuthenticationChallengeBlock:^(NSURLConnection *connection, NSURLAuthenticationChallenge *challenge) {
            NSURLCredential *newCredential = [NSURLCredential credentialWithUser:@"login" password:@"password" persistence:NSURLCredentialPersistenceForSession];
            [challenge.sender useCredential:newCredential forAuthenticationChallenge:challenge];
        }];

            NSLog(@"Response from %@",response);

        } failure:^(AFHTTPRequestOperation *operation, NSError *error) {

            GHFail(@"failed"); }];

        [operation start];
        [operation waitUntilFinished]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:30:10.310

您可能会想四处寻找 GHUnit 异步测试。

例子：

[https://gist.github.com/levigroker/1643797](https://gist.github.com/levigroker/1643797)

[http://vladimir.zardina.org/2010/11/testing-asynchronous-code-with-ghunit/](http://vladimir.zardina.org/2010/11/testing-asynchronous-code-with-ghunit/) [http://samwize.com/2012/11/25/create-async-test-with-ghunit/](http://samwize.com/2012/11/25/create-async-test-with-ghunit/) [http: //samwize.com/2012/10/03/sentestingkit-does-not-support-wait-for-blocks/](http://samwize.com/2012/10/03/sentestingkit-does-not-support-wait-for-blocks/)

`AFNetworking`在's 问题上也有一个关于这个的巨大线程

[https://github.com/AFNetworking/AFNetworking/issues/466](https://github.com/AFNetworking/AFNetworking/issues/466)

# shell - 用于创建目录的 Shell 脚本

> ID：15093120
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:05.447
> 
> 标签：shell

我有一个分区`/dev/sda3`，它被称为`/share`.

```
$ df
/dev/sda3  /share 
```

现在我需要编写脚本来在 /dev/sda3 中创建名为 codedumps 的目录，但是当我使用命令时

```
path "/share/"
mkdir $path"codedumps" 
```

在 shell 脚本中，它在`/share`名为的分区内创建另一个目录`share`，然后在其中创建一个目录`codedumps`。但我希望它`codedumps`在`/share`分区本身中创建它应该是分区中的最顶层目录`/dev/sda3`（即`/share`partiiton）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:56:25.300

不要使用路径变量，它是一个 unix 变量。光盘

# 或导航到目录，然后创建目录

cd $share
mkdir 编码转储

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:46:15.323

怎么样

```
share="share"
mkdir /$share/"codedumps" 
```

# javascript - 通过 jQuery 对图像替换褪色等的思考

> ID：15093125
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:23.693
> 
> 标签：javascript, jquery, ajax, asp.net-mvc

对这种方法有什么想法吗？非常感谢任何反馈。tryFindUserName 是一个 AJAX 调用，它返回一个简单的真或假。我担心的是它不够整洁，也没有很好地扩展。另外，我是否应该检查状态更改，因为下面的代码总是隐藏并显示 img。

还有对图像路径的硬编码有什么想法吗？

```
// Change handlers for registration form
//
$('#login_register_username').keyup(function () {
    var length = $('#login_register_username').val().length;
    if (length < 4) {
        return;
    }

    var source = null;
    var result = tryFindUserName($('#login_register_username').val());
    if (result == false) {
        source = "tick.png";
    }
    else {
        source = "cross.png";
    }

    $("#login_register_username_confirmation_img").hide().attr('src', '../../Images/Ajax/' + source);
    $("#login_register_username_confirmation_img").fadeIn(1000);

    updateRegisterButtonState();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:48:43.697

使用 CSS 进行样式设置，而不是 javascript。

使用javascript，您可以淡入/淡出元素，或在某些用户操作上切换类等等。但是褪色也可以通过 CSS 过渡来完成。（[示例](http://jsfiddle.net/kEh8L/)）。

在你的情况下，我会创建一个具有两种状态的图像，并制作动画`background-position`

# sql - 为什么在我的 CTE 查询中说 RowId 是无效列？

> ID：15093126
> 
> 赞同：1
> 
> 时间：2013-02-26T15:36:28.707
> 
> 标签：sql, sql-server, tsql, common-table-expression

我有一个基于一些在线示例编写的 CTE 查询，不知道为什么我收到有关 RowId 的错误：

```
DECLARE @StartRow INT
DECLARE @EndRow INT
SET @StartRow = 120
SET @EndRow = 140

;WITH MyCTE AS
(
    SELECT 
        c1, c2, c3,
        ROW_NUMBER() OVER(ORDER BY gav.c1) AS RowId
    FROM 
        MyTable1 gav
)
SELECT *
FROM MyTable1 
WHERE RowId > @StartRow
  AND RowId < @EndRow
ORDER BY c1 
```

我收到此错误：

> *消息 207，级别 16，状态 1，第 15 行
> 无效的列名称“RowId”。
> 消息 207，级别 16，状态 1，第 16 行
> 无效的列名称“行 ID”。*

在我看到的每个示例中，它们都引用了`RowId`查询中 CTE 的值，但由于某种原因它似乎不在范围内？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T15:38:59.083

问题是您使用的是表名的名称，而它**应该是`CTE`**

```
DECLARE @StartRow INT
DECLARE @EndRow INT
SET @StartRow = 120
SET @EndRow = 140

;WITH MyCTE AS
(
    SELECT c1, c2, c3,
    ROW_NUMBER() OVER(ORDER BY gav.c1) AS RowId
    FROM MyTable1 gav
)
SELECT *
FROM MyCTE     --------------- <<=== HERE
WHERE   RowId > @StartRow
        AND RowId < @EndRow
ORDER BY c1 
```

# java - 单击按钮后，我可以在脚本中获取所选单选按钮的值吗

> ID：15093139
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:55.707
> 
> 标签：java, javascript

我有一个 jsp 页面，我在其中放置了几个单选按钮。

选择单选按钮并单击提交按钮后，它将调用一个javascript函数，该函数需要单选按钮的选定值才能对脚本执行一些操作。

谁能解决这个问题？

```
<td align="center"><input type="radio" name="radio" id="radio" value="value1"></td>
<td align="center"><input type="radio" name="radio" id="radio" value="value2"></td>
<td align="center"><input type="radio" name="radio" id="radio" value="value3"></td>

<td ><a onclick="Javascript:delete();"><span>Delete</span></a></td>

<script language="javascript" type="text/javascript">
function delete()
{
    <% String str= here i want that selected radio buttons value%>
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T13:36:09.347

```
<script language="javascript" type="text/javascript">
        function deleteme() {
            var values = document.getElementsByName('radio');

            for ( var i = 0, length = values.length; i < length; i++) {
                if (values[i].checked) {
                    // do whatever you want with the checked radio
                    alert(values[i].value);
                    // only one radio can be logically checked, don't check the rest
                    break;
                }
            }
        }
    </script>

    <td align="center"><input type="radio" name="radio" id="radio" value="value1">value1</td>
    <td align="center"><input type="radio" name="radio" id="radio" value="value2">value2</td>
    <td align="center"><input type="radio" name="radio" id="radio" value="value3">value3</td>

    <td><a onclick="deleteme();">Delete</a></td> 
```

# jquery - 在两个 CSS 表之间切换 - Google Chrome 扩展

> ID：15093140
> 
> 赞同：1
> 
> 时间：2013-02-26T15:36:56.313
> 
> 标签：jquery, css, google-chrome-extension

问题是：我正在构建一个 Google Chrome 扩展程序，我希望用户在 2 个内容脚本设计（2 个 css 文件）之间进行选择。到目前为止，我找到了两个解决方案：

1）使用[https://developer.chrome.com/extensions/tabs.html#method-insertCSS](https://developer.chrome.com/extensions/tabs.html#method-insertCSS)

```
chrome.tabs.insertCSS(integer tabId, InjectDetails details, function callback) 
```

2) 仅使用 javascript 更改 css 样式。

我想知道哪个是最佳实践。尽管在 javascript 中修改所有内容似乎有点疯狂：p。当然，如果您有 3d 和更好的解决方案，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:55:49.157

你能用这个做点什么吗：

```
<link class='mystyle' href="style1.css" rel="stylesheet" type="text/css"> 
```

给链接标签一个类名可以使用 jQuery 更改 href 属性。

```
$(".mystyle").prop("href", "style2.css"); 
```

我对单个 div 元素进行了快速测试，它似乎工作正常。

把它写成一个语句：

```
if ( choosestyle1 == true) {
       $(".mystyle").prop("href", "style1.css");
} else {
       $(".mystyle").prop("href", "style2.css");
} 
```

预加载样式表：

```
var stylesheets = Array("style1.css", "style2.css");
stylesheets.forEach(function(arg){
    $("<div />").load(arg);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T12:17:24.067

Paul 我对开发 Chrome 扩展了解不多，但`HTML` 基本想法是告诉浏览器当前的 CSS。

您必须`coockie`通过 javascript 设置一个告诉页面`CSS`要使用的页面，并且每当您切换到另一个`CSS`时，修改 cookie。

请参考这个链接，这里有一个[demo下载](http://languagelassi.blogspot.in/2013/03/how-to-switch-between-two-css-files-on-a-page.html)

# jquery - gvChart (Google Chart) jquery 插件。如何在事件中调用函数

> ID：15093141
> 
> 赞同：0
> 
> 时间：2013-02-26T15:36:56.983
> 
> 标签：jquery, jquery-plugins, google-visualization

我正在使用[这个](http://www.ivellios.toron.pl/technikalia/2010/06/22/gvchart-plugin-jquery-with-google-charts/)插件（[Github](https://github.com/ivellios/gvChart)），它使用谷歌图表（绘制饼图）。我想使用 Google api 中的 select 事件和 getSelection() 方法。例如，当用户单击元素时提醒元素的 id。如何让它发生？

[谷歌关于插件的文档。](https://google-developers.appspot.com/chart/interactive/docs/gallery/piechart)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:51:28.137

对不起，伙计们）我不再需要这个插件了。使用 Google 的代码而不是使用那个 jQuery 插件要容易得多。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Task', 'Hours per Day'],
          ['Work',     11],
          ['Eat',      2],
          ['Commute',  2],
          ['Watch TV', 2],
          ['Sleep',    7]
        ]);

        var options = {
          title: 'My Daily Activities'
        };

        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

# javascript - jquery deferred - 等到两个调用完成

> ID：15093145
> 
> 赞同：10
> 
> 时间：2013-02-26T15:37:01.843
> 
> 标签：javascript, jquery, jquery-deferred

我正在寻找一种在两个 ajax 调用完成后进行回调的方法：

```
$.when(
    call1(),
    call2()
).always(function() {
    // Here I want to be sure the two calls are done and to get their responses 
); 
```

问题是其中一个调用可能会失败。所以，在我的代码中，总是会在不等待另一个调用的情况下调用。

如何等待两个调用都完成（成功或失败）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-26T16:29:29.430

这是应该做的事情：

```
$.whenAllDone = function() {
    var deferreds = [];
    var result = $.Deferred();

    $.each(arguments, function(i, current) {
        var currentDeferred = $.Deferred();
        current.then(function() {
            currentDeferred.resolve(false, arguments);
        }, function() {
            currentDeferred.resolve(true, arguments);
        });
        deferreds.push(currentDeferred);
    });

    $.when.apply($, deferreds).then(function() {
        var failures = [];
        var successes = [];

        $.each(arguments, function(i, args) {
            // If we resolved with `true` as the first parameter
            // we have a failure, a success otherwise
            var target = args[0] ? failures : successes;
            var data = args[1];
            // Push either all arguments or the only one
            target.push(data.length === 1 ? data[0] : args);
        });

        if(failures.length) {
            return result.reject.apply(result, failures);
        }

        return result.resolve.apply(result, successes);
    });

    return result;
} 
```

看看[这个 Fiddle](http://jsfiddle.net/HDnsv/1)看看它是如何工作的。

基本上它会等待所有 Deferreds 完成，无论它们是否失败并收集所有结果。如果我们有失败，则返回的 Deferred 将失败并列出所有失败，否则会以所有成功解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:39:44.720

它并不漂亮，但是您可以为每个 ajax 调用设置一个全局“已完成”变量，以便在完成时设置。每次调用还将检查是否设置了两个变量，如果是，则调用您的 always 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-18T20:53:41.380

您还可以嵌套调用：

```
$.when(call1()).always(function(){
    $.when(call2()).always(function(){
        // Here I want to be sure the two calls are done and to get their responses
    });
}); 
```

但是当然这两个调用会变得彼此同步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-15T23:18:27.247

达夫的回答很好。只有一个问题。当只有一个延迟时，事情就行不通了。

问题出在jquery的`when`方法中。

`jquery.when: function( subordinate /* , ..., subordinateN */ ) { ...`

它有这样一行：

```
// If resolveValues consist of only a single Deferred, just use that.
deferred = remaining === 1 ? subordinate : jQuery.Deferred(), 
```

这改变了参数的形状，所以我不得不把它放回我的代码期望的通用形状（即当多个延迟传递给时相同的形状`whenAllDone`）

```
const jqueryWhenUsesSubordinate = deferreds.length == 1;

const deferredArgs = jqueryWhenUsesSubordinate
    ? [[ arguments[ 0 ], arguments[ 1 ] ]]
    : arguments

$.each(deferredArgs, function (i, resolvedArgs) {
    var target = !resolvedArgs[0] ? failures : successes;
    var data = resolvedArgs[1];
    target.push(data.length === 1 ? data[0] : data);
}); 
```

此外，我更改了函数签名以更紧密地匹配`Promise.allSettled`，因为它应该采用延迟对象的数组参数，然后不是循环`arguments`设置`deferreds`数组，而是循环传入的参数。

这允许您以编程方式将可变长度的延迟创建到数组中并将其传递到`whenAllDone`.

# java - 如何将 MS Access 数据库连接到 Java Applet

> ID：15093146
> 
> 赞同：0
> 
> 时间：2013-02-26T15:37:05.363
> 
> 标签：java, database, ms-access, applet, bluej

我们必须在 ATM Mechanism 上创建一个 Java 项目。我们还计划将其连接到数据库。您能否帮助我了解如何将 MS Access 数据库连接到我们使用 BlueJ 创建的 Java 小程序？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:53:34.787

由于小程序的安全限制，将小程序与 MSAccess 连接起来会非常复杂。小程序不应该访问本地资源（文件），因此您必须向小程序添加各种签名以使浏览器允许这样做（大约 12 年前我做过类似的事情，据我所知，小程序安全限制仍然存在，甚至更糟）。

但是，如果您确实设法访问本地文件系统，则可以使用[Jackcess](http://jackcess.sourceforge.net/)`mdb`之类的库或直接使用 jdbc/odbc 驱动程序访问文件，[如下所示](http://www.codeproject.com/Articles/35018/Access-MS-Access-Databases-from-Java)。

# ruby-on-rails - 带有accept_nested_attributes_for 的Rails 嵌套表单，带有一个不幸的模型名称

> ID：15093148
> 
> 赞同：0
> 
> 时间：2013-02-26T15:37:17.140
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-forms, fields-for

我有一个名为“Controller”的父模型*（成熟的应用程序，而不是我的决定）*

```
belongs_to :controller
accepts_nested_attributes_for :controller 
```

形式：

```
= f.fields_for :controller do |c|
    = c.hidden_field :id, :value => @controller.id
    = c.text_field :slw_type 
```

不会显示。

```
= f.fields_for :literally_anything_else do |c|
    = c.hidden_field :id, :value => @controller.id
    = c.text_field :slw_type 
```

如果将变量名称更改为其他任何名称，则表单将构建。我有一种预感，它是特定于 Rails 的保留名称。

问题：

有什么问题？我怎样才能做到这一点？

# **解决了：**

问题是父模型尚未与子模型关联。我的错误是没有提供所有必要的信息。

这行得通。

```
def new
    @controller = Controller.find(params[:controller_id])
    @inspection = Inspection.new(:controller => @controller) 
```

因此我的 fields_for 表单构建器也可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:44:24.017

选择一些无害的变量名。 `not_really_a_controller`管他呢。将其用于您的变量和表单。然后，在您的实际控制器（例如 ActionController::Base 后代）中，重命名传入参数，以便模型不知道任何不同，如下所示：

```
before_filter :filter_params

private
 def filter_params
   if params[:not_really_a_controller]
     params[:controller] = params.delete(:not_really_a_controller)
   end
 end 
```

我过去曾出于类似原因使用此策略，但并非专门针对`controller`. 不过值得一试！

# sql - 如何找到一个具有负值而另一个具有相同正值的记录

> ID：15093151
> 
> 赞同：-2
> 
> 时间：2013-02-26T15:37:33.990
> 
> 标签：sql, tsql

如何找到一个具有负值而另一个具有相同正值的记录。我已经尝试过这个和类似的东西，但它们不起作用。

```
 where [Check_Number]=[Check_Number] and Payment_Amount = ([payment_amount]/-1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:38:46.690

这个怎么样：

```
where a.check_Number + b.check_number = 0 and a.check_number < 0 
```

或者，这两个字段是 payment_amount 和 check_number 吗？

```
where payment_amount = - check_number and check_number < 0 
```

也许是这样的？

```
select r1.check_number, r1.payment_amount, r2.check_number, r2.payment_amount
from records r1 join
     records r2
     on r1.check_number = r2.check_number and
        r1.payment_amount = - r2.payment_amount 
```

# c# - 休眠子集合

> ID：15093154
> 
> 赞同：2
> 
> 时间：2013-02-26T15:37:45.863
> 
> 标签：c#, asp.net, .net, database, nhibernate

所以让我们从代码本身开始：

```
public class Site
{
    private Int32 id;        
    private string name;
    private IList<SiteDomain> sitedomains;

    public Site()
    {
    }

    public virtual Int32 Id
    {
        get { return id; }
        set { id = value; }
    }

    public virtual IList<SiteDomain> Domains
    {
        get { return sitedomains; }
        set { sitedomains = value; }
    }

    public virtual string Name
    {
        get { return name; }
        set { name = value; }
    }
}

public class SiteDomain
{
    private Int32 id;
    private string domain;

    public SiteDomain()
    {
    }

    public virtual Int32 Id
    {
        get { return id; }
        set { id = value; }
    }

    public virtual string Domain
    {
        get { return domain; }
        set { domain = value; }
    }
} 
```

如您所见，我不需要从 SiteDomain 到站点的任何链接。但我想在站点实体中有一个站点域列表。

这是DDL：

```
CREATE TABLE `site` (
    `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
    `name` VARCHAR(500) NOT NULL,
    PRIMARY KEY (`id`)
)
ENGINE=InnoDB;

CREATE TABLE `sitedomains` (
    `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
    `siteid` BIGINT(20) UNSIGNED NOT NULL,
    `domain` VARCHAR(500) NOT NULL,
    PRIMARY KEY (`id`),
    INDEX `sitedomains_siteid` (`siteid`),
    CONSTRAINT `FK_sitedomains_siteid` FOREIGN KEY (`siteid`) REFERENCES `site` (`id`) ON UPDATE CASCADE ON DELETE CASCADE
)
ENGINE=InnoDB; 
```

我目前得到的映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="PhoneTracking.Core" assembly="PhoneTracking.Core">
  <class name="Site" table="site">
    <id name="Id" type="Int32">
      <column name="ID" not-null="true" />
    </id>
    <property name="Name" type="AnsiString" />
    <list name="Domains" cascade="all">
      <key column="SiteId" />
      <index />
      <one-to-many class="SiteDomain" />
    </list>
  </class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="PhoneTracking.Core" assembly="PhoneTracking.Core">
  <class name="SiteDomain" table="sitedomains">
    <id name="Id" type="Int32">
      <column name="ID" not-null="true" />
    </id>
    <property name="Domain" type="AnsiString" />
  </class>
</hibernate-mapping> 
```

当我得到一个站点时，它检索得很好。它带有所有相关站点的域。但是后来我将新站点保存回数据库，它只保存站点本身，而不插入站点的域。

我应该如何做对？

我知道 NHibernate 的 ISet。我只是想让它成为 IList，因为它对我来说更舒服。

* * *

编辑：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="PhoneTracking.Core" assembly="PhoneTracking.Core">
  <class name="SiteDomain" table="sitedomains">
    <id name="Id" type="Int32">
      <column name="ID" not-null="true" />
    </id>
    <property name="Domain" type="AnsiString" />
    <many-to-one name="Site" column="siteid" />
  </class>
</hibernate-mapping>

<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="PhoneTracking.Core" assembly="PhoneTracking.Core">
  <class name="Site" table="site">
    <id name="Id" type="Int32">
      <column name="ID" not-null="true" />
    </id>
    <property name="Name" type="AnsiString" />
    <bag name="Domains" inverse="true" cascade="all">
      <key column="SiteId" />
      <one-to-many class="SiteDomain" />
    </bag>
  </class>
</hibernate-mapping> 
```

更新了 SiteDomain 类：

```
public class SiteDomain
{
    private Int32 id;
    private string domain;
    private Site site;

    public SiteDomain()
    {
    }

    public virtual Int32 Id
    {
        get { return id; }
        set { id = value; }
    }

    public virtual Site Site
    {
        get { return site; }
        set { site = value; }
    }

    public virtual string Domain
    {
        get { return domain; }
        set { domain = value; }
    }
} 
```

这是我尝试保存新动态创建的条目的方法：

```
ITransaction tx = session.BeginTransaction();

Site s = new Site();
s.Name = StringGenerator.RandomString(20) + " site";
s.Domains = new List<SiteDomain>();
s.Domains.Add(new SiteDomain { Site = s, Domain = StringGenerator.RandomString(20) + ".com" });   

session.SaveOrUpdate(s);                
tx.Commit(); 
```

现在我得到一个例外：

> {"无法插入：[Project.Core.SiteDomain#0][SQL: INSERT INTO sitedomains (Domain, siteid, ID) VALUES (?, ?, ?)]"} : {"无法添加或更新子行：外键约束失败 ( `project`. `sitedomains`, CONSTRAINT `FK_sitedomains_siteid`FOREIGN KEY ( `siteid`) REFERENCES `site`( `id`) ON DELETE CASCADE ON UPDATE CASCADE)"}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:18:56.433

当`IList<>`通过映射时`<list>`，您应该为索引列提供映射：参见[6.3。值集合和多对多关联](http://nhforge.org/doc/nh/en/index.html#collections-ofvalues)。提炼：

> 对于像地图和列表这样的索引集合，我们需要一个元素。对于列表，此列包含从零开始编号的连续整数。如果您必须处理遗留数据，请确保您的索引确实从零开始

因此，“sitedomains”表中还必须有索引列。如果现在有索引列，您仍然可以使用`IList<>`但通过包映射：

```
<bag name="Domains" cascade="all">
      <key column="SiteId" />    
      <one-to-many class="SiteDomain" />
</bag> 
```

注意：还要确保您的集合已实例化，例如：

```
public Site()
{
   sitedomains = new List<SiteDomain>();
} 
```

编辑：不能使用`siteid` **NOT NULL**

您使用的映射不包含`inverse`映射。`SiteDomain`不引用`Site`. 这意味着 NHibernate 必须将`SiteDomain`实体插入到其表中，并且在第二步中，它`siteid`使用对`Site`.

因为该`siteid`列不是 NULL，所以您会遇到异常。

解决方案，1）将列标记为 NULL 或 2）更改映射以引用`Site`来自 SiteDomain 的映射并将映射更改为反向，如下所示：

```
 <bag name="Domains" cascade="all" inverse="true">
    <key column="SiteId" />    
    <one-to-many class="SiteDomain" />
  </bag> 
```

并在站点映射中使用多对一

```
<many-to-one name="Site" column="siteid" /> 
```

最后，在添加`SiteDomain`到`Domains`集合时，您还必须设置 SiteDomain.Site = site

```
site.Domains.Add(siteDomain);
siteDomain.Site = site; 
```

这将指示 NHibernate 什么是 siteid 值，并且只会应用一个插入。并且仍然可以应用 NOT NULl 约束

# gcc - 使用 cygwin 在 Windows 上构建 Eleveldb 时出错

> ID：15093160
> 
> 赞同：1
> 
> 时间：2013-02-26T15:37:58.070
> 
> 标签：gcc, erlang, cygwin, riak, erlang-otp

你能帮我在 Cygwin 上构建 eleveldb 吗？我的 gcc 是 4.5.3，我在 64 位 W7 操作系统上安装了 32 位 cygwin。我能够使用 Microsoft SDK 和 msbuild 程序构建 leveldb。这是我的 cygwin bash cli 的输出：

```
user1@mycomputer ~/eleveldb
$ ./rebar compile
==> Entering directory `c:/cygwin/home/user1/eleveldb'
==> eleveldb (compile)
'c_src' is not recognized as an internal or external command,
operable program or batch file.
ERROR: Command [compile] failed! <br/> 
```

的输出`./rebar -vvv compile`如下：

```
$ ./rebar -vvv compile
DEBUG: Rebar location: "c:/cygwin/home/user1/eleveldb/rebar"
DEBUG: Consult config file "c:/cygwin/home/user1/eleveldb/rebar.config"
==> Entering directory `c:/cygwin/home/user1/eleveldb'
DEBUG: Consult config file "c:/cygwin/home/user1/eleveldb/rebar.config"
DEBUG: Available deps: []
DEBUG: Missing deps  : []
DEBUG: Predirs: []
==> eleveldb (compile)
INFO:  sh info:
        cwd: "C:/cygwin/home/user1/eleveldb"
        cmd: c_src/build_deps.sh
DEBUG:  opts: [{env,[{"REBAR_DEPS_DIR","c:/cygwin/home/user1/eleveldb/deps"},
                     {"ERL_LIBS","c:/cygwin/home/user1/eleveldb/deps"},
                     {"ALLUSERSPROFILE","C:\\ProgramData"},
                     {"ANT_HOME","C:\\Tools\\apache-ant-1.7.1"},
                     {"APPDATA","C:\\Users\\user1\\AppData\\Roaming"},
                     {"AR","ar.sh"},
                     {"CC","cc.sh"},
                     {"CFLAGS","-mno-cygwin -Wall -O3 -fPIC"},
                     {"CLASSPATH",
                      ".;F:\\SERVERS\\TimesTen\\tt70_64\\lib\\ttjdbc5.jar;C:\\TOOLS\\Win32\\JAVA\\jre6\\lib\\ext\\QTJava.zip"},
                     {"COMMONPROGRAMFILES",
                      "C:\\Program Files (x86)\\Common Files"},
                     {"COMPUTERNAME","mycomputer"},
                     {"COMSPEC","C:\\Windows\\system32\\cmd.exe"},
                     {"CVS_RSH","/bin/ssh"},
                     {"CXX","cc.sh"},
                     {"CXXFLAGS"," -Wall -O3 -fPIC"},
                     {"CommonProgramFiles(x86)",
                      "C:\\Program Files (x86)\\Common Files"},
                     {"CommonProgramW6432","C:\\Program Files\\Common Files"},
                     {"DISPLAY",":0.0"},
                     {"DRV_CC_TEMPLATE",
                      "cc.sh -c -mno-cygwin -Wall -O3 -fPIC -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   -O3 -Wall -I c_src/leveldb/include $PORT_IN_FILES -o $PORT_OUT_FILE"},
                     {"DRV_CFLAGS",
                      "-g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   -O3 -Wall -I c_src/leveldb/include"},
                     {"DRV_CXX_TEMPLATE",
                      "cc.sh -c  -Wall -O3 -fPIC -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   -O3 -Wall -I c_src/leveldb/include $PORT_IN_FILES -o $PORT_OUT_FILE"},
                     {"DRV_LDFLAGS",
                      "-shared  -Lf:/Tools/erl5.9/lib/erl_interface-3.7.6/lib -lerl_interface -lei c_src/leveldb/libleveldb.a c_src/system/lib/libsnappy.a -lstdc++"},
                     {"DRV_LINK_TEMPLATE",
                      "cc.sh $PORT_IN_FILES $LDFLAGS -shared  -Lf:/Tools/erl5.9/lib/erl_interface-3.7.6/lib -lerl_interface -lei c_src/leveldb/libleveldb.a c_src/system/lib/libsnappy.a -lstdc++ -o $PORT_OUT_FILE"},
                     {"ERLANG_ARCH","32"},
                     {"ERLANG_TARGET","R15B-win32-32"},
                     {"ERL_CFLAGS",
                      " -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include  "},
                     {"ERL_CONSOLE_MODE","tty:ccc"},
                     {"ERL_EI_LIBDIR",
                      "f:/Tools/erl5.9/lib/erl_interface-3.7.6/lib"},
                     {"ERL_LDFLAGS",
                      " -Lf:/Tools/erl5.9/lib/erl_interface-3.7.6/lib -lerl_interface -lei"},
                     {"ERL_TOP","/home/user1/otp_src_R13B04"},
                     {"EXE4J_JAVA_HOME","C:\\Tools\\x64\\Java\\jdk1.6.0_17"},
                     {"EXE_CC_TEMPLATE",
                      "cc.sh -c -mno-cygwin -Wall -O3 -fPIC -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   $PORT_IN_FILES -o $PORT_OUT_FILE"},
                     {"EXE_CFLAGS",
                      "-g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include  "},
                     {"EXE_CXX_TEMPLATE",
                      "cc.sh -c  -Wall -O3 -fPIC -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   $PORT_IN_FILES -o $PORT_OUT_FILE"},
                     {"EXE_LDFLAGS",
                      " -Lf:/Tools/erl5.9/lib/erl_interface-3.7.6/lib -lerl_interface -lei"},
                     {"EXE_LINK_TEMPLATE",
                      "cc.sh $PORT_IN_FILES $LDFLAGS  -Lf:/Tools/erl5.9/lib/erl_interface-3.7.6/lib -lerl_interface -lei -o $PORT_OUT_FILE"},
                     {"FP_NO_HOST_CHECK","NO"},
                     {"GRADLE_HOME","C:\\FRAMEWORKS\\gradle-1.3"},
                     {"HISTCONTROL","ignoredups"},
                     {"HISTIGNORE","[   ]*:&:bg:fg:exit"},
                     {"HOME","C:\\cygwin\\home\\user1"},
                     {"HOMEDRIVE","C:"},
                     {"HOMEPATH","\\Users\\user1"},
                     {"HOSTNAME","mycomputer"},
                     {"INCLUDE",
                      "f:\\Program Files (x86)\\Microsoft Visual Studio .NET 2003\\SDK\\v1.1\\include\\"},
                     {"INFOPATH","/usr/local/info:/usr/share/info:/usr/info:"},
                     {"JAVA_HOME","C:\\Tools\\x64\\Java\\jdk1.6.0_17"},
                     {"JAVA_HOME1","C:\\Tools\\Win32\\Java\\jdk1.5.0_17"},
                     {"JDK5","C:\\Tools\\Win32\\Java\\jdk1.5.0_17"},
                     {"JDK6_x64","C:\\Tools\\x64\\Java\\jdk1.6.0_17"},
                     {"LANG","en_US.UTF-8"},
                     {"LIB",
                      "f:\\Program Files (x86)\\Microsoft Visual Studio .NET 2003\\SDK\\v1.1\\Lib\\"},
                     {"LOCALAPPDATA","C:\\Users\\user1\\AppData\\Local"},
                     {"LOGONSERVER","\\\\mycomputer"},
                     {"M2_HOME","C:\\Tools\\apache-maven-3.0.4"},
                     {"MAKE_MODE","unix"},
                     {"MANPATH",
                      "/usr/local/man:/usr/share/man:/usr/man::/usr/ssl/man"},
                     {"MEDIAMALL","C:\\Program Files (x86)\\MediaMall\\"},
                     {"MEMBASE_NUM_VBUCKETS","256"},
                     {"NUMBER_OF_PROCESSORS","2"},
                     {"NVM_DIR","/home/user1/.nvm"},
                     {"OLDPWD","/home/user1/eleveldb/c_src"},
                     {"OPENRDA_INI",
                      "F:\\tools\\CA\\ERwin Data Modeler r7.3\\OpenAccess\\bin\\iwinnt\\openrda.ini"},
                     {"OS","Windows_NT"},
                     {"OVERRIDE_CONFIG_CACHE",
                      "/home/user1/otp_src_R13B04/erts/autoconf/win32.config.cache"},
                     {"OVERRIDE_TARGET","win32"},
                     {"PATH",
                      "F:\\Tools\\erl5.9\\erts-5.9\\bin;C:\\cygwin\\home\\user1\\otp_src_R13B04\\erts\\etc\\win32\\cygwin_tools\\vc;C:\\cygwin\\home\\user1\\otp_src_R13B04\\erts\\etc\\win32\\cygwin_tools;C:\\cygwin\\usr\\local\\bin;C:\\cygwin\\bin;C:\\cygwin\\bin;C:\\cygwin\\usr\\X11R6\\bin;C:\\Tools\\x64\\Java\\JDK16~1.0_1\\bin;C:\\cygwin\\bin;F:\\SERVERS\\TimesTen\\tt70_64\\bin;C:\\tools\\win32\\IMAGEM~1.1-Q;C:\\PHP\\PHP-52~1.9-1;C:\\SERVERS\\ORACLE\\oraclexe\\app\\oracle\\product\\102~1.0\\server\\bin;C:\\ruby\\bin;C:\\Perl\\bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\PROGRA~2\\COMMON~1\\DIVXSH~1;C:\\PROGRA~2\\MI3EDC~1\\90\\Tools\\binn;C:\\Windows\\System32\\WINDOW~1\\v1.0;C:\\Tools\\COLLAB~1;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;F:\\temp\\tools\\MKVTOO~1;C:\\PROGRA~2\\COMMON~1\\Acronis\\SnapAPI;C:\\PROGRA~2\\Toshiba\\BLUETO~1\\sys;C:\\PROGRA~2\\Toshiba\\BLUETO~1\\sys\\x64;C:\\PROGRA~1\\TORTOI~1\\bin;C:\\PROGRA~2\\QUICKT~1\\QTSystem;C:\\PROGRA~2\\Autodesk\\BACKBU~1;F:\\TOOLS\\scala\\bin;F:\\Tools\\sbt;C:\\PROGRA~2\\giter8;C:\\PROGRA~1\\MI3EDC~1\\110\\Tools\\Binn;C:\\FRAMEW~1\\gradle-1.3\\bin;C:\\Tools\\APACHE~1.4\\bin;C:\\Tools\\APACHE~1.1\\bin;C:\\SERVERS\\Sun\\APPSER~1\\bin;C:\\SERVERS\\MySQL5\\bin;C:\\SERVERS\\MAESTR~1.2\\maven\\bin;C:\\SERVERS\\MAESTR~1.2\\PROJEC~1\\bin;C:\\SERVERS\\MAESTR~1.2\\PROJEC~1\\bin\\WINDOW~1;C:\\Tools\\MERCUR~1;D:\\GNUstep\\GNUstep\\System\\Tools;D:\\GNUstep\\bin;F:\\Tools\\erl5.9\\bin;C:\\cygwin\\lib\\lapack"},
                     {"PATHEXT",
                      ".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.RB;.RBW"},
                     {"PHPRC","C:\\PHP\\php-5.2.9-1-Win32\\"},
                     {"PRINTER","Canon MG3100 series Printer (Copy 2)"},
                     {"PROCESSOR_ARCHITECTURE","x86"},
                     {"PROCESSOR_ARCHITEW6432","AMD64"},
                     {"PROCESSOR_IDENTIFIER",
                      "Intel64 Family 6 Model 23 Stepping 6, GenuineIntel"},
                     {"PROCESSOR_LEVEL","6"},
                     {"PROCESSOR_REVISION","1706"},
                     {"PROGRAMFILES","C:\\Program Files (x86)"},
                     {"PS1",
                      "\\[\\e]0;\\w\\a\\]\\n\\[\\e[32m\\]\\u@\\h \\[\\e[33m\\]\\w\\[\\e[0m\\]\\n\\$ "},
                     {"PSModulePath",
                      "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\"},
                     {"PUBLIC","C:\\Users\\Public"},
                     {"PWD","/home/user1/eleveldb"},
                     {"ProgramData","C:\\ProgramData"},
                     {"ProgramFiles(x86)","C:\\Program Files (x86)"},
                     {"ProgramW6432","C:\\Program Files"},
                     {"QMAKESPEC","cygwin-g++"},
                     {"QTJAVA",
                      "C:\\TOOLS\\Win32\\JAVA\\jre6\\lib\\ext\\QTJava.zip"},
                     {"RANLIB","true"},
                     {"RUBYOPT","-rubygems"},
                     {"SBT_HOME","F:\\Tools\\sbt\\"},
                     {"SHLVL","1"},
                     {"SYSTEMDRIVE","C:"},
                     {"SYSTEMROOT","C:\\Windows"},
                     {"TEMP","C:\\cygwin\\home\\user1\\tmp"},
                     {"TERM","xterm"},
                     {"TMP","C:\\cygwin\\home\\user1\\tmp"},
                     {"TZ","America/Chicago"},
                     {"USER","user1"},
                     {"USERDOMAIN","mycomputer"},
                     {"USERNAME","user1"},
                     {"USERPROFILE","C:\\Users\\user1"},
                     {"VBOX_INSTALL_PATH","C:\\Tools\\Oracle\\VirtualBox\\"},
                     {"VS110COMNTOOLS",
                      "C:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\Common7\\Tools\\"},
                     {"VS71COMNTOOLS",
                      "f:\\Program Files (x86)\\Microsoft Visual Studio .NET 2003\\Common7\\Tools\\"},
                     {"VS80COMNTOOLS",
                      "f:\\Program Files (x86)\\Microsoft Visual Studio 8\\Common7\\Tools\\"},
                     {"WINDIR","C:\\Windows"},
                     {"_","./rebar"},
                     {"_M2_HOME","c:\\tools\\apache-maven-2.0.10"},
                     {"asl.log","Destination=file"}]},
               {abort_on_error,"Command [compile] failed!\n"}]
'c_src' is not recognized as an internal or external command,
operable program or batch file.
ERROR: Command [compile] failed!

user1@mycomputer ~/eleveldb 
```

在使用“编译”pre_hook 编辑`rebar.config`文件后`sh -x`，我看到的是：

```
$ ./rebar compile
==> Entering directory 'c:/cygwin/home/user1/eleveldb'
==> eleveldb (compile)
++ uname -s
+ '[' CYGWIN_NT-6.1-WOW64 = SunOS -a '' '!=' true ']'
+ unset POSIX_SHELL
+ LEVELDB_VSN=1.3.0
+ SNAPPY_VSN=1.0.5
+ set -e
++ basename /home/user1/eleveldb
+ '[' eleveldb '!=' c_src ']'
+ cd c_src
+ BASEDIR=/home/user1/eleveldb/c_src
+ which gmake
+ MAKE=make
+ case "$1" in
+ '[' '!' -d snappy-1.0.5 ']'
+ cd snappy-1.0.5
+ make
make: *** No targets specified and no makefile found.  Stop.
ERROR: Command [compile] failed! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:56:21.627

eleveldb`rebar.config`告诉 Rebar 执行命令`c_src/build_deps.sh`。Rebar 使用`open_port`（请参阅参考资料`rebar_utils:sh/2`）执行此操作，它使用与 Cygwin 不同的本机命令运行工具。

但是，在 DOS 中，以及在 Windows 中的扩展，意思是“使用开关`c_src/build_deps.sh`运行命令”，通常在斜杠前加上一个空格。（请参阅[此答案](https://superuser.com/a/176392/4542)。）由于是目录，因此它不是“内部或外部命令、可运行程序或批处理文件”。`c_src``/build_deps.sh``c_src`

我没有 Windows 机器来测试这个，~~所以我不会试图猜测如何解决这个问题~~. 其实，为什么不呢？

我将此答案标记为社区 wiki，因此任何人都应该随意进行更多猜测：

*   尝试更改`"c_src/build_deps.sh"`为`"sh c_src/build_deps.sh"`in `rebar.config`。看起来你的 PATH 中有 Cygwin 程序，所以系统应该找到正确的`sh`.

    *   失败：

        ```
        make: *** No targets specified and no makefile found. 
        ```

*   该脚本试图[下载和构建依赖](https://github.com/basho/eleveldb/blob/79c06e4c471851f237f227605600710457af87de/c_src/build_deps.sh#L56)项，所以我猜“make”对于其中一个失败了，但还不清楚它到底哪里出错了。尝试将钩子更改为`"sh -x c_src/build_deps.sh"`，这将显示正在执行的命令。

    *   失败：

        ```
        $ ./rebar compile
        ==> Entering directory c:/cygwin/home/user1/eleveldb'
        ==> eleveldb (compile)
        ++ uname -s
        + '[' CYGWIN_NT-6.1-WOW64 = SunOS -a '' '!=' true ']'
        + unset POSIX_SHELL
        + LEVELDB_VSN=1.3.0
        + SNAPPY_VSN=1.0.5
        + set -e
        ++ basename /home/user1/eleveldb
        + '[' eleveldb '!=' c_src ']'
        + cd c_src
        + BASEDIR=/home/user1/eleveldb/c_src
        + which gmake
        + MAKE=make
        + case "$1" in
        + '[' '!' -d snappy-1.0.5 ']'
        + cd snappy-1.0.5
        + make
        make: *** No targets specified and no makefile found. Stop.
        ERROR: Command [compile] failed! 
        ```

# python - maildir 消息的文件名 - maildir.Maildir

> ID：15093161
> 
> 赞同：2
> 
> 时间：2013-02-26T15:38:02.177
> 
> 标签：python, maildir

我怎样才能安全地并希望使用 Maildir 的标准 python 工具找到 Maildir 消息的完整文件名和路径。我想在删除之前将邮件消息文件写入 tar 文件。

我正在导入邮箱和 tarfile (++)

语境：

Maildirs 列表（从文本文件创建）

循环遍历 Maildirs（简化），创建一个要删除的邮件列表，一个函数将获取邮件列表，并一个接一个地将电子邮件附加到一个 tar 文件，然后删除该电子邮件。

```
import mailbox
# Creating the list
for maildir in maildir_list
    inbox = mailbox.Maildir(maildir, factory=None, create=False)
      # Looping over folders, if (folder = Trash)
    for key,msg in inbox.iteritems():
        my_list.append(maildir, inbox, key, foldername 
```

然后遍历列表以将邮件附加到 tar 文件并删除（丢弃）它们。

```
 import tarfile,mailbox
    # _box is allready initialized in the previous function
    for _maildir, _box, _key, _foldername in __my_list:
        __msg = _box[_key]
        __subdir = __msg.get_subdir()
        __suffix   = mailbox.Maildir.colon + __msg.get_info()
        if __suffix == mailbox.Maildir.colon:
            __suffix = ''
        __file_name = "%s/.%s/%s/%s%s" % ( _maildir, _foldername, __subdir, _key, __suffix )

        try:
            tar.add(__file_name)
            _box.discard(_key)
        except Exception as inst:
            error_type = type(inst)
            log_text = "%s\: ERROR %s - %s" % (error_type, __file_name, inst)
            log_this( logKeySub, log_text )
            e.write(log_text + "\n") 
```

我已经查看了邮箱和电子邮件的 python 文档，搜索了 google、stackoverflow 等。现在我正在使用 _maildir、_foldername、_key 和 get_info() 构建路径和文件名。

编辑：根据 t-8ch 的评论，我做了以下调整：

```
for _maildir, _box, _key, _foldername in __my_list:
    try:
        __file = _box._toc[_key]
        __file_name = "%s/.%s/%s" % ( _maildir, _foldername, __file )
    except Exception as inst:
            error_type = type(inst) # Type Exception, inst.args, inst
            log_text = "%s\: ERROR with %s/.%s - %s - %s" % (error_type, _maildir, _foldername, _key, inst)
            log_this( logKeySub, log_text )
            e.write(log_text + "\n")
            continue 
```

试运行证明它工作得非常好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T22:41:17.430

您可以使用`Maildir._toc`. 这是一个字典，将邮件的键映射到相应文件的路径。这本词典是在`Maildir._refresh()`. 这允许仅按需延迟读取邮件文件，从而减少刷新所有邮件列表的时间（这种情况经常发生）。

（我确实在源代码中找到了这个）

# c# - 如何在 C# 或 ASP.NET 中为分组目的创建不存在的文件夹？

> ID：15093163
> 
> 赞同：0
> 
> 时间：2013-02-26T15:38:07.063
> 
> 标签：c#, asp.net, vb.net, visual-studio

更清楚主题：在`Solution Explorer`里面`Visual Studio`我有很多代码和类文件。
我们正在寻找一种安排它们的方法。这样我就可以将相关的添加到一个文件夹中。不管我是否可以通过内置功能或扩展来实现这一点。
但是，该文件夹不应该真正存在或在运行时创建。
类似于`namespaces`代码中的东西只是一个***概念***；它们实际上不存在。

**我在项目层次结构空间中需要这个**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:43:37.870

有什么理由不能使用“添加文件夹”吗？虽然它们存在于项目中并创建了一个物理文件夹，但当您编译应用程序时，只要文件夹中仅存在代码文件，它们就不会被添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:44:23.393

唯一的方法是在项目目录下创建文件夹。您放入这些文件夹的类不必遵循文件夹层次结构及其名称空间，但它们应该遵循。我不确定为什么这应该是您上面提到的限制。

如果这是一个 Visual C++ 项目，您可以创建假文件夹和过滤器来分隔文件，就像它们对头文件和源文件所做的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:44:17.187

右键单击您的解决方案并转到添加 -> 新解决方案文件夹。您应该能够根据需要在这些解决方案文件夹中添加任何文件（创建新文件或添加现有文件）（它们用于解决方案，但可以添加各种类型的文件。）

这不会创建一个“真正的”文件夹，但它确实为组织创建了一种符号链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T15:51:42.043

项目和解决方案是固定的，因为项目始终是解决方案的一部分。当您将任何代码文件添加到文件夹时，该文件夹名称将成为该代码文件的命名空间的一部分。我不明白这应该如何造成问题。继续使用设计好的工具，而不是试图对抗它们。

[http://mikehadlow.blogspot.com/2007/07/how-to-structure-visual-studio.html](http://mikehadlow.blogspot.com/2007/07/how-to-structure-visual-studio.html)

# binding - 在 Hot Towel App 中使用 Knockout 绑定 observable

> ID：15093164
> 
> 赞同：2
> 
> 时间：2013-02-26T15:38:09.080
> 
> 标签：binding, knockout.js, hottowel, durandal

我刚刚开始了一个新的[Hot Towel SPA](http://www.johnpapa.net/hottowel/)项目，但在使用 ViewModel 敲除进行绑定时遇到了麻烦。

我的视图模型如下所示：

```
define([
    "services/logger",
    "knockout"
],
function (logger, ko) {
    var title = ko.observable("Partners");

    return {
        title: title,
        activate: function () {
            var that = this;
            logger.log("Partners view activated", null, "admin.partners", false);

            return true;
        }
    };
}); 
```

视图如下所示：

```
<section class="row-fluid">
    <div class="span10" id="admin-content">
        <h2 class="page-title" data-bind="text: title"></h2>
    </div>
</section> 
```

但是标题总是以垃圾结尾（即函数的代码，例如使用调试器时：FUNCTION D(){IF(0<ARGUMENTS.LENGTH) [...]）

如果我将绑定更改为“data-bind="text:title()”，它会起作用，但我意识到这不会绑定可观察对象，只会绑定值。因此，当使用此类绑定进行表单时，它不会t 更新 observable，我无法保存该值。

我找到了似乎使用与我完全相同的代码的示例，但我不明白为什么它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:45:59.090

克里斯蒂安——你自己想出来的。我会详细说明。

查看 App_Start/bundleconfig.cs 中定义的供应商包，然后查看 index.cshtml 底部附近的脚本加载（~第 29 行）。

您会看到所有 3rd 方脚本 - 包括淘汰脚本 - 都被一起加载......在 Require 之前。这意味着没有一个第 3 方脚本可以检测到 require 的即将使用。因此，它们将自己加载到全局命名空间（窗口）中。

当 RequireJS 出现时，它也不知道任何这些服务。因此，当您要求将“ko”作为依赖项时，它会返回`null`......如果您在函数开始的位置放置断点，您可以自己看到。

**所有这一切都是设计使然**。

您可以将这些服务填充到 require 的等效 IoC 容器中。如果你这样做了，require 会找到 'ko' 并且你的函数会起作用。[您可以从这里](http://requirejs.org/docs/api.html#config)开始了解这一点。我已经做到了。这还不错。

但是我们中的一些人已经在这些水域游泳了一段时间，他们认为这太 PITA 了。所以我们遵循 Durandal 的简化建议：“*在 Require 之外加载一些 3rd 方库，让它们散布在全局命名空间中；更多的应用程序文件应该存在于 Require 中。* ”

选择其他方式并不难。只要学会在你的*main.js*中填充 require 就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T17:50:16.660

在 Durandal 开发人员的帮助下发现了这个问题：[https ://groups.google.com/forum/#!topic/durandaljs/Ku1gwuvqPQQ](https://groups.google.com/forum/#!topic/durandaljs/Ku1gwuvqPQQ)

似乎使用 AMD 包括淘汰赛是问题所在。我不知道具体细节，但这可能与 Durandal 使用全局 ko 变量这一事实有关，而我的视图模型使用 ko 变量，这是不同的，因为 RequireJS 创建了自己的实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:08:00.233

你可以尝试这样的事情：

```
define([
    "services/logger",
    "knockout"
],
function (logger, ko) {
    var title = "Partners";

    return {
        title: ko.observable(title),
        activate: function () {
            var that = this;
            logger.log("Partners view activated", null, "admin.partners", false);

            return true;
        }
    };
}); 
```

# java - 反转二进制数

> ID：15093165
> 
> 赞同：1
> 
> 时间：2013-02-26T15:38:09.800
> 
> 标签：java, binary

我正在尝试一个我在[这里找到的小谜题](https://www.spotify.com/int/jobs/tech/reversed-binary/)

我想知道我的答案为什么不正确，您会看到原始规范是

> 你的任务是编写一个程序来反转二进制数。例如，13 的二进制表示是 1101，将其反转得到 1011，它对应于数字 11。

所以这是我的代码..

```
import java.util.Scanner;

public class ReverseBinary {

    public  String reversedIntToBinary(int val) {
        int value = val;
        StringBuilder bldr = new StringBuilder();

        while (value != 0) {
            int remainder = value % 2;
            value = value / 2;
            bldr.append(remainder);
        }
        return bldr.toString();
    }

    public  int toDecimal(String bin) {
        char[] binString = bin.toCharArray();

        int starting = 0;

        for (int i = 0; i < binString.length; i++) {
            int tempoVal = starting * 2
                    + Character.getNumericValue(binString[i]);
            starting = tempoVal;
        }
        return starting;
    }

    public  int reversedBinary(int val){
        String bin =reversedIntToBinary(val);
        int result = toDecimal(bin);
        return result;
    }

    public static void main(String[] args) {
        ReverseBinary rvb = new ReverseBinary();

        Scanner input = new Scanner( System.in);
        System.out.println("Enter A Number: ");
        int num = input.nextInt();
        System.out.println(rvb.reversedBinary(num));
    }
} 
```

它正在执行上述任务，但在我提交时它是错误的。我想知道为什么它被认为是错误的？我错过了一些重要的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:45:03.977

> 用一个整数输出**一行，**我们通过反转 N 的二进制表示得到的数字。（强调添加）

您正在输出*两*行`Enter A Number:`和整数。文字`Enter A Number:\n11\n`不等于文字`11\n`。如果他们使用自动化系统来检查程序，那么您的提交可能会因此而失败。

（除此之外，我没有检查过你的代码，所以可能还有其他问题——但那个问题会立即突出。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:46:35.453

如果您知道二进制数的最大大小（在您的示例中为 4 位）并且它是 8 位或更少，那么执行反转的最快方法是使用使用当前二进制值作为索引的查找表。例如，

```
// indices 0 - 3 of the lookup table.
byte[] lookUpTable =
{
  0b0000, 0b1000, 0b0100, 0b1100
}

// assuming a valid index.
byte reversed = lookUpTable[valueToReverse]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:47:50.367

```
int result = Integer.reverse( value );
while((result & 1) == 0 && result != 0)
    result >>= 1; 
```

**编辑**使用 AND 和 SHIFT 添加了位定位校正

> 公共静态int反向（int i）
> 
> ```
> Returns the value obtained by reversing the order of the bits in the two's complement binary representation of the specified int value.
> 
> Returns:
>     the value obtained by reversing order of the bits in the specified int value.
> Since:
>     1.5 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T21:16:49.427

查看我的解决方案：[https ://github.com/nzpetter/reversebinary](https://github.com/nzpetter/reversebinary)

在解决 Spotify 难题时，我学到了一件事。不要试图发明轮子。有人可能已经创建了您需要的方法。

```
public static int reversebinary(int s) {
    return Integer.parseInt(new StringBuilder(Integer.toBinaryString(s)).reverse().toString(), 2);
} 
```

# python - 简单地运行 python 脚本而不向 bashrc 添加目录？

> ID：15093175
> 
> 赞同：0
> 
> 时间：2013-02-26T15:38:50.417
> 
> 标签：python, indentation, pep8

我要从制表符改为空格，并希望将我当前的 *.py 文件转换为这个约定。看来[reindent.py](https://stackoverflow.com/a/1024489/943773)是这样做的推荐方式。

在使用 Ubuntu 安装它后`sudo apt-get install python-examples`，它最终以`/usr/share/doc/pythonx.x/examples/Tools/scripts/reindent.py`.

是否有首选/推荐的方式在不引用目录的情况下运行此类脚本，并且可能不将该目录添加到我的 Path 变量中？

我希望在单个文件和批处理上运行它，例如[这里](https://stackoverflow.com/questions/2625294/how-do-i-autoformat-some-python-code-to-be-correctly-formatted#comment2638395_2625361)描述的：

```
find . -type f -name "*.py" | xargs python reindent.py --nobackup 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:42:02.760

只需复制文件，或符号链接它。

它是一个独立的脚本，它不依赖于`scripts`目录中的任何其他内容，因此它可以存在于*任何地方*。将其符号链接或复制到您的目录中`$PATH`将使您能够在没有任何路径前缀的情况下运行它（前提是设置了可执行位，`chmod +x reindent.py`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:04:39.153

您可以`easy_install reindent`或`pip install reindent`，然后它将作为命令出现在您的路径上`reindent`

# c# - 将映射的业务对象返回到 EF 实体部分类时出错

> ID：15093181
> 
> 赞同：0
> 
> 时间：2013-02-26T15:39:11.560
> 
> 标签：c#, entity-framework

我正在尝试将业务对象映射到数据优先的自动生成实体。但是，我在我返回的映射器类中遇到错误`new Lab`。

错误是`"Cannot Convert expression type 'LabManager.DataAcces.Lab' to return type LabManager.BusinessObjects.BusinessObjects.Lab"`

我的问题是：当我在映射器类中返回它所期望的内容时，为什么会出现这个错误？

我的业务对象如下所示：

```
namespace LabManager.BusinessObjects.BusinessObjects
{
    public class Lab
    {
        public Lab()
        {

        }
        public int Id { get; set; }
        public string Name { get; set; }
        public IList<Cylinder> Cylinders { get; set; }
    }
} 
```

我将业务对象映射到的实体是：

```
public partial class Lab
{
    public Lab()
    {
        this.Cylinders = new HashSet<Cylinder>();
    }

    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Cylinder> Cylinders { get; set; }
} 
```

而且我只是使用手动映射器类（没有 AutoMapper）：

```
namespace EmitLabManager.DataAccess.ModelMapper
public class Mapper
{
   internal static BusinessObjects.BusinessObjects.Lab GetLabs(Lab entity)
   {
        return new Lab
        {
             Id = entity.Id,
             Name = entity.Name,
             Cylinders = entity.Cylinders
        };
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:45:27.273

您很可能有命名空间冲突。您需要完全限定 GetLabs 函数中的构造函数：

```
return new BusinessObjects.BusinessObjects.Lab
    {
         Id = entity.Id,
         Name = entity.Name,
         Cylinders = entity.Cylinders
    }; 
```

这应该够了吧。

# c++ - 如何在 c++ 中分配在 python 中创建的对象？

> ID：15093184
> 
> 赞同：2
> 
> 时间：2013-02-26T15:39:14.713
> 
> 标签：c++, python, boost, boost-python, make-shared

我基本上有一个非常简单的节点测试用例，我正在尝试修复。

我有一个带有 getChild 和 getParent 的简单 Node 类

可以通过 addChild 函数分配孩子

然后这个函数**自动在相关类上设置父级（所以从c ++方面）**

不幸的是，当我这样做时，我**失去了 python 参考。**

我想代码应该更好理解：

基本主**类 MyNode**：

```
class MyNode
{
public:
    MyNode(): m_name("unknown") {}
    MyNode(std::string name): m_name(name) {}
    MyNode(MyNode * const o) : m_name(o->m_name) {}
    virtual ~MyNode() {}

    std::string getName() const { return m_name; }
    void setName(std::string name) { m_name = name; }
    boost::shared_ptr<MyNode> getChild() const { return m_child; }
    const boost::shared_ptr<MyNode> & getParent() const { return m_parent; }

    void addChild(boost::shared_ptr<MyNode> node) {
        m_child = node;
        node->m_parent = boost::make_shared<MyNode>(this);
    }

private:
    std::string m_name;
    boost::shared_ptr<MyNode> m_parent;
    boost::shared_ptr<MyNode> m_child;
}; 
```

然后是**boost python 绑定代码**：

```
class_< MyNode, boost::shared_ptr<MyNode>/*, MyNodeWrapper*/ >("MyNode", init<std::string>())
    .add_property( "Name", &MyNode::getName, &MyNode::setName )
    .add_property( "Child", &MyNode::getChild )
    .add_property( "Parent", make_function(&MyNode::getParent, return_internal_reference<>()))
    .def( "addChild", &MyNode::addChild )
    ; 
```

完成**我的 python 测试代码**：

```
>>> p=MyNode("p")
>>> o=MyNode("o")
>>> p.addChild(o)
>>> o.Parent
<hello_ext.MyNode object at 0x01C055A8>   << this is not equal to p
>>> p
<hello_ext.MyNode object at 0x01C06510>   << as you can see p here
>>> o.Parent
<hello_ext.MyNode object at 0x01C055A8>   << but at least the pointer doesn't change each time the Parent is called !
>>> p.Child == o                          << so for the child it works
True
>>> o.Parent == p                         << but it doeesn't work for Parent
False 
```

问题肯定在于 addFunction 以及我如何使用 boost::make_shared 来设置父级。不幸的是，我不知道发生了什么.. 我尝试使用 boost 包装器：

```
struct MyNodeWrapper : public MyNode, public boost::python::wrapper<MyNode>
{
    MyNodeWrapper( PyObject * a_PyObj ) : m_Self( a_PyObj ) {}
    MyNodeWrapper( PyObject * a_PyObj, const MyNode & a_Vec ) : MyNode( a_Vec ), m_Self( a_PyObj ) {}
    MyNodeWrapper( PyObject * a_PyObj, std::string name ) : MyNode( name ) , m_Self( a_PyObj ) {}

    PyObject * m_Self;
}; 
```

但我仍然不确定应该如何修改 addChild 函数

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:14:51.553

你不能这样做：

```
 node->m_parent = boost::make_shared<MyNode>(this); 
```

没有`boost::enable_shared_from_this`. 请参阅[`enable_shared_from_this` 有什么用处？](https://stackoverflow.com/questions/712279/what-is-the-usefulness-of-enable-shared-from-this)

# c#-4.0 - Linq to Entity Group Sum 计算属性

> ID：15093189
> 
> 赞同：1
> 
> 时间：2013-02-26T15:39:22.570
> 
> 标签：c#-4.0, linq-to-entities, entity-framework-5

使用 C# 4 和 EF5。

尝试对计算的属性求和时遇到问题：

```
The specified type member 'QtyAvailable' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported. 
```

这是属性定义：

```
public decimal QtyAvailable
    {
        get
        { return this.QtyInContainer - this.QtyAllocated; }
    } 
```

这是Linq：

```
var viewModel =
                companyItems
                        .GroupJoin(
                            inventory,
                            items => items.Id,
                            inven => inven.ItemId, (im, icd) => new { im, icd }
                            )
                        .SelectMany(
                            itemInven => itemInven.icd.DefaultIfEmpty(),
                            (im, icd) => new { im, icd }
                        )
                        .GroupBy(g => new
                            {
                                g.im.im.Id
                            }
                        )
                        .Select(group =>
                                new ItemAvailabilityViewModel()
                                {
                                    Id = group.Key.Id,
                                    QtyAvailable = group.Sum(jt => jt.icd == null ? 0 : jt.icd.QtyAvailable),
                                    UnitCashPrice = group.Max(jt => jt.im.im.UnitSellPrice),
                                    UnitCreditPrice = group.Max(jt => jt.im.im.UnitSellPrice * (1 + company.CashDiscountPct)),
                                    CustomerUnitPrice = group.Max(jt => jt.im.im.UnitSellPrice * (1 + decCreditPriceMarkup))
                                }
                        )
                        ; 
```

不知道如何达到这个结果。我是否需要以某种方式将其分解为 2 个查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:49:07.147

看起来像把它分成 2 个查询是票。从我猜发生的情况来看，首先，当您调用 .ToList() 时，它会解析计算的属性，使其本质上不再为第二个查询计算然后对其求和。这是生成的代码：

```
//join of Recpt Header and Detail
            var unGroupedJoin =
                companyItems
                        .GroupJoin(
                            inventory,
                            items => items.Id,
                            inven => inven.ItemId, (im, icd) => new { im, icd }
                            )
                        .SelectMany(
                            itemInven => itemInven.icd.DefaultIfEmpty(),
                            (im, icd) => new { im, icd }
                        ).ToList();

            var viewModel =
                unGroupedJoin
                        .GroupBy(g => new
                            {
                                g.im.im.Id
                            }
                        )
                        .Select(group =>
                                new ItemAvailabilityViewModel()
                                {
                                    Id = group.Key.Id,
                                    QtyAvailable = group.Sum(jt => jt.icd == null ? 0 : jt.icd.QtyAvailable),
                                    UnitCashPrice = group.Max(jt => jt.im.im.UnitSellPrice),
                                    UnitCreditPrice = group.Max(jt => jt.im.im.UnitSellPrice * (1 + company.CashDiscountPct)),
                                    CustomerUnitPrice = group.Max(jt => jt.im.im.UnitSellPrice * (1 + decCreditPriceMarkup))
                                }
                        ).ToList()
                        ; 
```

# javascript - 提交时清除输入字段

> ID：15093190
> 
> 赞同：1
> 
> 时间：2013-02-26T15:39:23.097
> 
> 标签：javascript

您能否仔细查看此来源，因为提交后我没有得到任何结果。谢谢你。

```
<script type="text/JavaScript">
    function reset() {
        document.city.citysearch.value = "";
        return true; 
    }
</script>

<form name='city' action='airport.php' method='post' 
    target='result' onsubmit='return reset()'
>

    <input name="citysearch" type="text" 
        placeholder="Name of the city" size="18">
    <input type="hidden" name="submit" value="search"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:44:30.490

拥有一个名为“提交”的隐藏字段似乎是非常糟糕的做法。如果您要重置表单字段，请尝试重置按钮（[http://www.w3schools.com/tags/att_button_type.asp](http://www.w3schools.com/tags/att_button_type.asp)），无需 JS：

```
<form name='city' action='airport.php' method='post' target='result' onsubmit='return reset()'>

  <input name="citysearch" type="text" placeholder="Name of the city" size="18">
  <input type="hidden" name="search" value="search">
  <button type="reset">Reset</button>
  <button type="submit">Submit</button>
</form> 
```

**更新**：听起来你想在提交后重置你的字段。在服务器端执行此操作。尝试使用属性 value="" 返回需要重置的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:52:35.217

您的问题措辞不佳，但根据标题，我认为您在清除 Javascript 中的 citysearch 输入时遇到问题？如果是这种情况，请在 JS 中尝试类似于：

```
var x = document.getElementsByName("citysearch")
x[0].value = '' 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2018-05-15T10:32:56.713

而是这样做：

```
 var button = document.getElementById('clear');
  button.addEventListener('click', empty);
  function empty(){
  var input = document.getElementById('text');
  input.value='';
  } 
```

# ios - 自定义文件属性ios sdk

> ID：15093193
> 
> 赞同：0
> 
> 时间：2013-02-26T15:39:30.077
> 
> 标签：ios, ipad, nsfilemanager

我想知道是否可以为 ios 文件创建自定义文件属性。就像 NSFileCreationDate 我想要一个新属性“压缩”。

我找不到任何这样做的例子。可能吗？？。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T19:59:21.667

是的，你可以做到。HFS+ 文件系统支持“扩展属性”（ala 元数据标签），您可以将其添加到文件中，然后再读取。这类似于 MacOS 9 文件系统中的旧“资源分叉”。

查看'getxattr(2)' 和'setxattr(2)' - 这些是iOS/OSX 提供的C 接口。您可以[通过 Cocoanetics](http://www.cocoanetics.com/2012/03/reading-and-writing-extended-file-attributes/)了解更多信息。还有其他 ObjectiveC 包装器，但我现在找不到。你将不得不谷歌周围。

# vb.net - 无法覆盖结构中的 .Equals

> ID：15093199
> 
> 赞同：2
> 
> 时间：2013-02-26T15:39:41.907
> 
> 标签：vb.net

我一直在我的代码上运行 FxCop，它报告了许多 CA2224 和 CA1815 错误，因为结构拥有`Operator =`功能但没有覆盖`.Equals`. 作为一个尽职尽责的人，我正在努力纠正这些，但遇到了问题。我因此创建了一个结构：-

```
Public Structure MyStruct

    Public my_innards As Integer

    Public Shared Operator =(ByVal fs As MyStruct, ByVal ss As MyStruct) As Boolean
        Return fs.my_innards = ss.my_innards
    End Operator

    Public Shared Operator <>(ByVal fs As MyStruct, ByVal ss As MyStruct) As Boolean
        Return fs.my_innards <> ss.my_innards
    End Operator

End Structure 
```

我尝试`.Equals`像这样覆盖运算符：-

```
Public Overrides Function Equals(ByVal ss As MyStruct) As Boolean
    Return Me.my_innards = ss.my_innards
End Function 
```

这会产生编译错误`function 'Equals' cannot be declared 'Overrides' because it does not override a function in a base structure`

但是当我尝试时： -

```
Public Function Equals (ByVal ss As MyStruct) As Boolean
    Return Me.my_innards = ss.my_innards
End Function 
```

这会产生警告`function 'Equals' shadows an overridable method in the base class 'ValueType'. To override the base method, this method must be declared 'Overrides'`。

换句话说，我必须并且可能不会将方法声明为`overrides`. 谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:51:30.530

您必须将函数参数指定为`Object`：

```
Public Structure MyStruct

    Public Property Test As Integer

    Public Overrides Function Equals(obj As Object) As Boolean
        If obj Is GetType(MyStruct) Then
            Return Test = CType(obj, MyStruct).Test
        End If
        Return False
    End Function

End Structure 
```

但是，我不确定它是否会改变标准`Structure`比较行为 - 默认情况下比较结构中的每个值。

# android - html web 仅在移动视图中显示标题

> ID：15093203
> 
> 赞同：0
> 
> 时间：2013-02-26T15:39:49.840
> 
> 标签：android, css, html

我正在使用 WebView 向我的 Android 应用程序添加功能。问题是，我删除了标题，它成功地消失了，但是当我从智能手机（WebView）看到它时，它仍然存在......

网站是[这样](http://moma-soft.es/avalanche/forecast/)的（我没有在这里发布 html/css，因为它太长了）

这是我手机上的样子：S

![从手机上网](../Images/f89dcd00e9b027cf9b8ebd15feb92a56.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:42:43.900

在第 17 行的 fixed-navigation.css 中，您有：

```
#content {
    padding: 60px 0 0;
} 
```

顶部填充是您所看到的。

将来要调试此类问题，我建议使用[Chrome 的内置用户代理切换器。](http://techdows.com/2011/12/google-chrome-now-has-built-in-user-agent-switcher.html)

# delphi - 如何为 Delphi 创建模块化插件

> ID：15093212
> 
> 赞同：6
> 
> 时间：2013-02-26T15:40:16.217
> 
> 标签：delphi, plugins, architecture, modular-design

使用 Delphi 2010，我需要编写一个程序来支持模块或插件。虽然有点做作，但假设我有一个转换数据文件/文本文件的应用程序。它将支持 30 种输入格式和与输出相同的 30 种格式。第一个版本可能只会实现其中一些格式。我的挑战是我想要一个数据驱动的流程。

例如，假设我有一个 PARSE_FILE 例程。如果我的输入数据文件格式是“Format_A”，那么当我调用 PARSE_FILE 时，它应该知道使用 PARSE_FILE_Format_A，而不是其他 29 个不同版本的 PARSE_FILE 例程。

PARSE_FILE 只是一个例子。我可能会有 60 种不同*的常用*函数，LOAD_FILE、GET_DELIMITER、PARSE_FILE 等，但是对于 30 种不同格式中的每一种，这些函数中的每一种都会略有不同。如果我使用 FORMAT_A 加载文件，我可以使用什么技术，这 60 个不同的常用例程中的每一个都使用这 60 个例程的正确“版本”？

请记住，我从 5 种输入格式开始，稍后会添加其他格式，因此我需要一种*集中*定义此“映射”的方法，因此在我的代码中使用这些例程的任何地方，例程的正确版本都会即使我称其为通用版本，也可以使用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T18:36:46.383

1.  定义您需要每个插件模块以接口类型实现的一组标准例程。比如说，`IFileFormatHandler`它包含一个 PARSE_FILE 函数等。
2.  遵循接口设计和职责分离的原则，避免将某些实现不会感兴趣或无法实现的功能放在接口中。在实现类可以选择实现或不实现的单独接口中定义可选函数。例如，如果您预计您的应用会读取某些文件格式，但由于各种原因无法写入，那么您应该将读取操作放在一个接口中，将写入操作放在另一个接口中。
3.  如果您将在 Delphi 中编写所有插件，您应该使用 BPL 包来共享通用类型。将您的`IFileFormatHandler`接口类型放在一个 BPL 包（即 Common.bpl）中，以便所有模块都可以引用通用接口类型。每个插件模块本身也在其自己的 BPL 包中。（多个文件格式处理程序可以存在于同一个 BPL 包中，但基线示例是每个 BPL 一个）
4.  如果这是您构建插件架构的第一次尝试，请不要尝试同时涵盖多语言支持。现在坚持使用 Delphi。在 Delphi 中编写应用程序和模块。在 Delphi 中构建一个模块化项目以完成，然后退后一步，花一些时间了解 COM 或二进制接口要求，以支持用 Delphi 以外的语言编写的模块。
5.  在您的通用 BPL 包中，还定义一个全局函数，模块可以调用该函数以使主机应用程序知道它们自己 -`RegisterPlugin(name: string; instance: IFileFormatHandler)`例如。这会在内部列表中注册插件名称和实例，主机应用程序可以使用该列表来找出可用的插件并调用它们。
6.  对于每个文件处理插件模块，定义一个实现共享 BPL 包中定义的公共接口的类。在类的单元初始化中，调用RegisterPlugion()函数将类注册到宿主应用程序中。
7.  宿主应用程序使用通用包，模块包各自使用通用包。
8.  宿主应用程序仅通过公共接口中定义的功能与模块实现进行交互。
9.  宿主应用程序可以使用 IS 来测试特定模块对象实例是否实现了可选接口，并使用 AS 来获取该可选接口。
10.  在 Delphi 中，接口是引用计数的，因此只要宿主应用程序持有对模块对象实例的引用（例如，通过 RegisterPlugin），模块实例就会保持活动并在内存中。当最后一个引用被释放时，模块实例将被释放。
11.  宿主应用程序需要在运行时使用 LoadPackage 或类似的 fn 查找并加载模块包 bpls。
12.  在应用程序中共享一个插件模块实例列表将适用于大多数单线程应用程序。如果您预计在多个线程中同时使用这些插件模块，请考虑将此设计转换为工厂模式，而不是在内存中保存模块的单例实例。通过使用工厂在使用的线程中按需构造实例来管理多线程，这比创建一个必须安全地从多个线程调用的实例要容易得多，而且通常性能更高。

# python - Django 编辑配置文件

> ID：15093216
> 
> 赞同：0
> 
> 时间：2013-02-26T15:40:36.050
> 
> 标签：python, django

我想做以下事情： - 允许站点用户在表单中编辑他们的电子邮件地址。- 如果他们的电子邮件已经存在于数据库中，只要他们输入的电子邮件属于自己以外的其他人，他们就会看到错误。因此，如果 A 人发送电子邮件 test@yahoo.com 而 B 人已经拥有该电子邮件 - 就会出现错误。如果 A 人发送电子邮件 test@yahoo.com 并且这与她一直使用的电子邮件相同，则没有错误。

如何使用 Django 做到这一点？

我有以下代码：

```
class UserEditForm(forms.ModelForm):

    class Meta:
        model = User
        fields = ('first_name', 'email', 'last_name', )

    def clean_email(self):
        email = self.cleaned_data['email']

        if email == self.email:
            return email

        try:
            DjangoUser.objects.get(email=email)
            raise ValidationError('Email is already taken.')
        except DjangoUser.DoesNotExist:
            pass

        return email

    email = forms.EmailField(required=True) 
```

问题是 self.email 没有给我这个人当前的电子邮件。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:03:32.860

您想要的是当前用户（存储在 中`request`），更准确地说是他/她的电子邮件。

所以我建议的解决方法是在表单中传递或设置`request`// 。`e-mail``user`

创建表单后通过以下方式设置`user`的示例：`form``view`

```
# views.py
def someview(request):
    if request.method == 'POST':
        user_edit_form = UserEditForm(request.POST)
        user_edit_form.actual_user = request.user
        if user_edit_form.is_valid():
            do_some_stuff() 
```

如果您使用基于类的视图，该方法几乎相同。这样，在您的表格中，您可以检查：

```
self.actual_user.email == self.cleaned_data['email'] 
```

当然，如果您不需要整个用户，您可以只设置用户的电子邮件。

# javascript - Javascript 导航在 IE8 中不起作用

> ID：15093219
> 
> 赞同：1
> 
> 时间：2013-02-26T15:40:36.687
> 
> 标签：javascript, jquery, internet-explorer-8, anythingslider

我正在使用anythingslider 和colorbox 来创建一个水平滑动页面，它是一种电子书。我已经在anythingslider 中实现了'nav(to)' 功能来构建导航，它在Firefox 和Safari 中运行良好，但在IE8 中却不行。令人沮丧的是，滑块部分仍然有效——它会左右移动，只是不能与导航一起直接跳转到“页面”（实际上是一个列表项）。我怀疑一些挑剔的语法被 IE8 拒绝了，但我找不到它来挽救我的生命。

为了全面披露，此页面的代码最初是使用 in5 创建的，它将 InDesign 文档转换为 HTML。这有点草率，并没有做我想要的一切，所以我已经手动编码了大约两周来调整它（而且花了两周的时间应该解释为什么我无法弄清楚出了什么问题。如果不清楚，我是个菜鸟）。

我到处寻找答案，包括 stackoverflow、github 和 csstricks。我找不到任何有我的具体问题的人，为类似问题提供的答案是我已经做过的事情，或者没有高兴地实施。我修改了元标记来解释 IE8。我已经美化了 javascript 文件，所以我可以准确地找到在外部 .js 文件中定义导航的位置（我找到了它，但我没有足够的 javascript 程序员来完全理解我在看什么）。

所以这里是代码：

```
<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title>BestBrands2013</title>
<meta http-equiv="X-UA-Compatible" content="IE=8">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery.min.js"><\/script>')</script>
<script type="text/javascript" src="assets/js/jquery.touchSwipe.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.anythingslider.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.colorbox-min.js"></script>
<link rel="stylesheet" href="assets/css/theme-minimalist-square.css">
<link rel="stylesheet" href="assets/css/pages.css">

<script type="text/javascript" >
var touchEnabled = 'ontouchstart' in document.documentElement;
var useSwipe = 1;
var pageMode = 'h';
var nav;

$(function(){

    if($.colorbox) {
        $('.lightbox').colorbox({iframe:true, width:"80%", height:"80%"});
        $('.thumb').colorbox({maxWidth:"85%", maxHeight:"85%"});
    }
    $('img').bind('dragstart', function(event) { event.preventDefault(); });
    $('.pageItem').each(function(){
        if($(this).is('[onclick]')){
            if(touchEnabled) {
                //this.setAttribute('touchstart', this.getAttribute('onclick'));
                //this.removeAttribute('onclick');
            } else this.style.cursor = 'pointer';
        }
    });
    if($.hasOwnProperty('scrollTo')){
    nav = { numPages:$('.pages .page').length,
        back:function(ref){var targ=$(ref).parent('.page').prev()[0]; if(targ!=undefined); $.scrollTo(targ, 500);},
        next:function(ref){var targ=$(ref).parent('.page').next()[0]; if(targ!=undefined); $.scrollTo(targ, 500);},
        first:function(){$.scrollTo($('.page')[0], 500)},
        last:function(){$.scrollTo($('.page')[nav.numPages-1], 500)},
        to:function(n){$.scrollTo($('.page')[n-1], 500)} };
    }
    var playvid = function(slider) {
var vid = slider.$currentPage.find('video');
if (vid.length) {
    // autoplay
    vid[0].play();
}
};
            var sliderSettings = {
        mode: pageMode,
        theme: 'minimalist-square',
        buildArrows: (!touchEnabled && 1),
        buildNavigation: false,
        buildStartStop: false,
        hashTags: false,
        infiniteSlides: false,
        stopAtEnd: true,
        onInitialized: function(e, slider) {
            playvid(slider);
            nav = {
                numPages:slider.pages,
                current:slider.currentPage,
                next:function(){slider.goForward();},
                back:function(){slider.goBack();},
                first:function(){this.to(1);},
                last:function(){this.to(this.numPages)},
                to:function(n){slider.gotoPage(n);}
            };
            if(useSwipe) {
            var container = $('#container');
            var vertMode = (pageMode.substr(0,1) == "v");
            container.swipe({
                swipe:function(event, direction, distance, duration, fingerCount) {
                    switch(direction) {
                        case "left":
                            if(!vertMode) nav.next();
                            break;
                        case "right":
                            if(!vertMode) nav.back();
                            break;
                        case "up":
                            if(vertMode) nav.next();
                            break;
                        case "down":
                            if(vertMode) nav.back();
                            break;      
                    }
                }
            });
            }
        },

    }

    $('#slider').anythingSlider(sliderSettings);
});
</script>

</head>

<body>    
<div id="container">
<ul class="pages" id="slider">

<li class="page">
  <img class="pageItem" src="assets/images/item_16.png" alt="page item"/>
  <a href = "javascript:void(0)" onclick = "document.getElementById('popclinique').style.display='block';document.getElementById('fade').style.display='block'">
    <img class="pageItem" src="assets/images/item_17.png" style="left:165px; top:116px; " alt="page item"/>
  </a>
  <a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8520&cm_sp=ebook-_-30513-_-bb_p2_clinique_sun" target="_blank"><img class="pageItem" src="assets/images/item_18.png" style="left:85px; top:381px; " alt="Clinique Sun"/></a>
  <a href = "javascript:void(0)" onclick = "document.getElementById('popmilstar').style.display='block';document.getElementById('fade').style.display='block'">
  <img class="pageItem" src="assets/images/item_19.png" style="left:38px; top:567px; " alt="page item"/>
</a>
<a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8517&cm_sp=ebook-_-30513-_-bb_p2_clinique_fragrance" target="_blank"><img class="pageItem" src="assets/images/item_20.png" style="left:271px; top:210px; " alt="Clinique Fragrance"/></a>
<a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8523&cm_sp=ebook-_-30513-_-bb_p2_clinique_mens" target="_blank"><img class="pageItem" src="assets/images/item_21.png" style="left:436px; top:207px; " alt="Clinique Mens"/></a>
<a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8501&cm_sp=ebook-_-30513-_-bb_p2_clinique_3step" target="_blank"><img class="pageItem" src="assets/images/item_22.png" style="left:591px; top:318px; " alt="Clinique 3 Step"/></a>
<a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8512&cm_sp=ebook-_-30513-_-bb_p2_clinique_makeup" target="_blank"><img class="pageItem" src="assets/images/item_23.png" style="left:864px; top:350px; " alt="Clinique Makeup"/></a>
<a href="https://shop.aafes.com/shop/default.aspx?loc=department.aspx%7Edept_id%3D8505&cm_sp=ebook-_-30513-_-bb_p2_clinique_skincare" target="_blank"><img class="pageItem" src="assets/images/item_24.png" style="left:696px; top:47px; " alt="Clinique Skin Care"/></a>
<button class="pageItem" style="left:217px; top:641px; " alt="clinique 11" id="item26" onclick="nav.to(2);">&nbsp;</button>
 <button class="pageItem" style="left:271px; top:641px; " alt="nikebutton 11" id="item27" onclick="nav.to(3);">&nbsp;</button>
 <button class="pageItem" style="left:325px; top:641px; " alt="underarmourbuttpn 11" id="item28" onclick="nav.to(4);">&nbsp;</button>
 <button class="pageItem" style="left:379px; top:641px; " alt="coachbutton 11" id="item29" onclick="nav.to(5);">&nbsp;</button>
 <button class="pageItem" style="left:433px; top:641px; " alt="fossilbutton 11" id="item30" onclick="nav.to(6);">&nbsp;</button>
 <button class="pageItem" style="left:487px; top:641px; " alt="keurigbutton 11" id="item31" onclick="nav.to(7);">&nbsp;</button>
 <button class="pageItem" style="left:541px; top:641px; " alt="dellbutton 11" id="item32" onclick="nav.to(8);">&nbsp;</button>
 <button class="pageItem" style="left:595px; top:641px; " alt="applebutton 11" id="item33" onclick="nav.to(9);">&nbsp;</button>
 <button class="pageItem" style="left:649px; top:641px; " alt="dysonbutton 11" id="item34" onclick="nav.to(10);">&nbsp;</button>
 <button class="pageItem" style="left:703px; top:641px; " alt="samsungbutton 11" id="item35" onclick="nav.to(11);">&nbsp;</button>
 <button class="pageItem" style="left:757px; top:641px; " alt="knmorebutton 11" id="item36" onclick="nav.to(12);">&nbsp;</button>
 <img class="pageItem" src="assets/images/item_25.png" style="left:16px; top:12px; " alt="page item"/>
 </li>
</body> 
```

I've abbreviated it a lot - the whole thing is ginormous - but that is the whole head section. I only included one 'page' (actually a list item). The relevant bits are the onclick="nav.to(n);" at the buttons at the end, and the navigation definitions in the slidersettings block of script near the end of the head.

I know everyone probably has actual programming issues to answer, and my feeble programming efforts are low on your list of priorities, but I am trying desperately to learn this stuff as fast as I can, and would thoroughly appreciate any help anyone can offer.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:03:54.093

Towards the end of the script block you have an extra comma. IE8 is notorious for breaking due to these.

```
 }
            }
        });
        }
    }, <-- here

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-06T17:48:40.517

Comments:
In case you are looking for alternative solution, following link gives a general implementation of scrolling to html element. And It works it in my project (IE8).

Resource:
[http://css-tricks.com/snippets/jquery/smooth-scrolling/](http://css-tricks.com/snippets/jquery/smooth-scrolling/)

# html - 设置背景时z索引不起作用？

> ID：15093220
> 
> 赞同：-1
> 
> 时间：2013-02-26T15:40:38.390
> 
> 标签：html, css, z-index

我有一个图片广告，它的位置是固定的，z 指数是 40

```
#subHead{
   position: fixed;           
   height: 80px;    
   background: #c00;
   z-index: 40;
   margin-top: 140px;
} 
```

我有一个“post”容​​器，它的位置是相对的，z 索引是 34343443。它的蓝色图像背景高度为 500 px

```
.post {
    background: url("http://.../Blue.png") top no-repeat;
    z-index:34343443;
    postion:relative;
} 
```

由于“post”容​​器的 z 索引较高，如果它们在一个地方发生冲突，它应该在广告上方。但是 z 索引为 40 的图像广告仍然在蓝色背景之上

[演示](http://ilovetrollstestbeta.blogspot.in/2012/12/top-14-funniest-pictures-of-day.html)

经过几个小时的故障排除后，我真的快疯了。请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:57:55.727

问题是它`#subHead`在**里面**，`.post`所以它总是显示在它的前面......为了把它放在它后面，你必须把它放在同一层（例如 in `.post-outer`）。

# ruby-on-rails - Windows下的Rails 3 readline问题

> ID：15093224
> 
> 赞同：2
> 
> 时间：2013-02-26T15:40:53.883
> 
> 标签：ruby-on-rails, readline

当我尝试运行 rails 控制台时，出现错误：

```
C:/ruby/Ruby193/lib/ruby/1.9.1/irb/completion.rb:9:in `require': cannot load suc
h file -- readline (LoadError)
        from C:/ruby/Ruby193/lib/ruby/1.9.1/irb/completion.rb:9:in `<top (requir
ed)>'
        from C:/ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/c
ommands/console.rb:3:in `require'
        from C:/ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/c
ommands/console.rb:3:in `<top (required)>'
        from C:/ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/c
ommands.rb:38:in `require'
        from C:/ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/c
ommands.rb:38:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

我已经从[http://gnuwin32.sourceforge.net/packages/readline.htm](http://gnuwin32.sourceforge.net/packages/readline.htm)安装了 readline，但它对我没有帮助。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T20:38:24.647

`readline`是依赖的外部依赖项之一`ruby stdlib`。RubyInstaller[发行](http://rubyinstaller.org/)版使用 readline 的[纯 ruby​​ 实现](https://github.com/luislavena/rb-readline)代替[GNU-readline](http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html)。

如果您最初没有使用 RubyInstaller 安装，我建议您使用它重新安装。它为您处理所有类似的外部依赖项。

# ruby-on-rails - 为什么 Rails 在不单击链接的情况下执行刷新操作

> ID：15093225
> 
> 赞同：0
> 
> 时间：2013-02-26T15:40:54.990
> 
> 标签：ruby-on-rails, ruby, action, link-to

我一直试图在没有运气的情况下在网上到处找到这个答案，也许这会对其他人有所帮助。

我安装了一个名为 socialization 的 ruby​​ gem，它运行良好。它允许用户关注/取消关注/喜欢/不喜欢/提及任何内容。

我遇到的问题是我已经创建了两个链接（一个跟随和一个取消跟随）链接有效，当单击时，记录会完美地从数据库中添加和删除但是当我点击刷新时，无论如何都会发生操作，而无需我单击链接.

尽可能明确的问题是：

如果当前已关注用户并且我刷新页面，则将取消关注（无需单击按钮）..然后当他们取消关注并刷新页面时，他们现在将再次被关注（再次无需单击按钮）

这是代码：

```
<% if current_user.follows?(@user)%>
   <%= link_to "Unfollow", user_path, :action => current_user.unfollow!(@user), :class => "btn btn-primary"%>
<% else %>
   <%= link_to "Follow", user_path, :action => current_user.follow!(@user), :class => "btn btn-primary"%>
<% end %> 
```

我认为这与以下任何一个有关：浏览器缓存链接或生成的链接是

```
<a href="/users/1" action="#&lt;Follow:0x103ce81d8&gt;" class="btn btn-primary" rel="nofollow">Follow</a> 
```

并且该操作以任何一种方式执行

编辑：

```
Rake routes: 

  users_index GET    /users/index(.:format)            users#index
         dashboard_index GET    /dashboard/index(.:format)        dashboard#index
    dashboard_my_rentals GET    /dashboard/my_rentals(.:format)   dashboard#my_rentals
    dashboard_my_credits GET    /dashboard/my_credits(.:format)   dashboard#my_credits
    dashboard_my_invites GET    /dashboard/my_invites(.:format)   dashboard#my_invites
      dashboard_my_faves GET    /dashboard/my_faves(.:format)     dashboard#my_faves
  dashboard_edit_profile GET    /dashboard/edit_profile(.:format) dashboard#edit_profile
           tsmhome_index GET    /tsmhome/index(.:format)          tsmhome#index
        new_user_session GET    /users/sign_in(.:format)          devise/sessions#new
            user_session POST   /users/sign_in(.:format)          devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)         devise/sessions#destroy
           user_password POST   /users/password(.:format)         devise/passwords#create
       new_user_password GET    /users/password/new(.:format)     devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format)    devise/passwords#edit
                         PUT    /users/password(.:format)         devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)           devise/registrations#cancel
       user_registration POST   /users(.:format)                  devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)          devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)             devise/registrations#edit
                         PUT    /users(.:format)                  devise/registrations#update
                         DELETE /users(.:format)                  devise/registrations#destroy
              home_index GET    /home/index(.:format)             home#index
                   users GET    /users(.:format)                  users#index
                         POST   /users(.:format)                  users#create
                new_user GET    /users/new(.:format)              users#new
               edit_user GET    /users/:id/edit(.:format)         users#edit
                    user GET    /users/:id(.:format)              users#show
                         PUT    /users/:id(.:format)              users#update
                         DELETE /users/:id(.:format)              users#destroy
                                /show/:id(.:format)               user#show
                    root        /                                 home#index

user controller

  def index
@users = User.all

respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :json => @users }
end

end
  def show
    @user = User.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :json => @user }
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:52:30.217

在您的链接`action`中被认为`attribute`是`link_to tag`. 因为`action`应该作为第二个参数给出。检查[文档](http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to)。获取控制器特定操作的路径 do `rake routes`。它将列出`routes`并使用相同的内容，`_path`并在您的`link_to tag`.

我认为它可能如下所示：

```
<% if current_user.follows?(@user)%>
   <%= link_to "Unfollow", unfollow_user_path(:user => @user), :class => "btn btn-primary"%>
<% else %>
   <%= link_to "Follow", follow_user_path(:user => @user), :class => "btn btn-primary"%>
<% end %> 
```

在控制器中：

```
def follow
  #do something like
  user = User.find(params[:user])
  current_user.follow!(user)
  flash[:success] = "Follwed user #{user.name}"
  redirect_to :back
end

def unfollow
  #do something like
  user = User.find(params[:user])
  current_user.unfollow!(user)
  flash[:success] = "Unfollwed user #{user.name}"
  redirect_to :back
end 
```

在路线：

```
resources :users do
  collection do
    get 'follow'
    get 'unfollow'
  end
end 
```

# ssl - asp 连接 HTTPS 和 Fiddler 在 WebForms 和 TexView 中显示密码

> ID：15093226
> 
> 赞同：0
> 
> 时间：2013-02-26T15:40:57.177
> 
> 标签：ssl, asp.net-mvc-4, https, fiddler

我有个问题。我在 ASP.NET MVC 4 中配置了一个带有 SSL(https) 连接的网络。但是当我用简单的形式发送我的凭证时，Fiddler 2 会以纯文本形式显示我的凭证......

我的网络配置文件：

```
 <authentication mode ="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="20"  protection="All" requireSSL="true"  />
  <!--  <forms loginUrl="~/Account/LogOn" timeout="20"  protection="All"   requireSSL="true" /> -->
</authentication>

<httpCookies httpOnlyCookies="true" requireSSL="true" lockItem="true"/> 
```

和全局文件：

```
filters.Add(new HandleErrorAttribute());
        filters.Add(new System.Web.Mvc.AuthorizeAttribute());
        filters.Add(new RequireHttpsAttribute()); 
```

有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:32:54.083

这是完全正常的。Fiddler 注册为您的网络浏览器的代理，这意味着它将看到未加密的流量。没什么好担心的。如果有中间人在网络上监听，他将无法看到这一点。

# javascript - Zurb Orbit 中的按钮未隐藏在 IE8 中

> ID：15093230
> 
> 赞同：1
> 
> 时间：2013-02-26T15:41:05.503
> 
> 标签：javascript, jquery, css, html

我正在组建一个站点，并从主页的 Foundation Framework 中获取了 Zurb 的 Orbit rotator。该站点在所有当前浏览器中都可以正常呈现，但客户端需要 IE8。我在 IE8 上留下的唯一问题是旋转器上的按钮没有采用 Orbit 的不透明度设置，因此当您访问主页时，所有幻灯片的按钮都会显示。有趣的是，当幻灯片旋转时，它会带上按钮，并且旋转器开始按预期运行。

[这是有问题的网站。](http://bapco.bluefishdesignstudio.com)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:13:26.523

尝试将此添加到您的CSS：

```
.orbit-slide {display:none} 
```

这应该隐藏幻灯片，直到它们被初始化

并删除这个：

```
.orbit .orbit-slide {right:0;} 
```

这应该可以防止它们堆叠在一起

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:45:57.723

IE8 中 Orbit 中的子元素不会采用这些设置。所以 Orbit 将包含文本的 div 元素设置为 Opacity:0; 但子元素不尊重该设置。最终我们切换到另一个使用不透明度和显示混合的库来控制显示哪张幻灯片。

不过感谢您的帮助。非常感激！

# python - SQLAlchemy：数据库中的每个表都必须与应用程序中的类相关吗？

> ID：15093234
> 
> 赞同：1
> 
> 时间：2013-02-26T15:41:18.557
> 
> 标签：python, oop, orm, sqlalchemy

我有一个要在 Python 3.2 和 SqlAlchemy 0.8 中实现的应用程序。完成了 ERD，到目前为止它有大约 30 个表。问题是，现在我有 30 个 Postgresql 表，这是否意味着在我的 SQLAlchemy ORM 实现中我必须创建 30 个类？这是因为到目前为止，在我的应用程序中，我已经创建了大约 8 个表，并且我必须为每个表创建类。

在我的 ERD 中，许多表是“数据透视”表，例如一个名为**organizaton_type**的表，它只有 2 列（ID 和名称列）。此表中最多只能有 3 个条目，即“公共、私人、合作伙伴”。此**组织**类型表与**组织**表相关。

虽然在我的规范化数据库知识中我认为这是一个不错的设计，但我对创建一个名为 Organization Type 的类感到有点犹豫。有没有办法我仍然可以访问那些“数据透视”表而无需创建它们的等效类并且不必编写我自己的原始 SQL 查询？

也许是为了让我感到困惑，是不是在 OO 开发中以及在使用 ORM 时我别无选择，只能实现这些类以访问表？

# r - 使用 R 计算显示当前预约之前的预约次数的过去访问次数列

> ID：15093240
> 
> 赞同：1
> 
> 时间：2013-02-26T15:41:27.050
> 
> 标签：r, count, data.table

我有大量的历史客人约会记录（> 1 百万条目）。每行记录客人的ID，约会的日期，约会的状态（1表示出现，0表示未出现）示例如下（测试）。

我需要计算每位客人在当前约会之前进行的约会次数。我按日期升序对数据进行了排序。

我尝试使用 data.table() 进行计算。计算结果的示例如下所示为 testWithVisit。我使用的方法适用于小型数据表。但是对于超过 10000 个结果的数据表来说速度很慢。我无法完成所有 1 百万行的计算。我可以知道是否有人对此有一个优雅的解决方案？提前致谢。

我用来生成测试数据和计算 testWithVisit 的代码在底部。

```
> test
      ID                Date Status Index
 1: 1002 2012-01-11 03:46:27      1     1
 2: 1001 2012-02-17 10:15:59      1     2
 3: 1002 2012-02-26 13:18:42      1     3
 4: 1001 2012-02-27 18:48:00      1     4
 5: 1004 2012-03-11 05:40:36      1     5
 6: 1004 2012-03-17 06:06:05      0     6
 7: 1008 2012-03-17 14:41:53      0     7
 8: 1008 2012-03-21 13:55:51      1     8
 9: 1008 2012-03-22 22:30:42      0     9
10: 1005 2012-03-29 09:00:39      1    10
11: 1005 2012-04-04 02:46:54      1    11
12: 1004 2012-04-05 22:53:05      1    12
13: 1006 2012-04-11 19:53:10      0    13
14: 1007 2012-04-14 17:19:07      1    14
15: 1003 2012-04-16 08:28:26      1    15
16: 1007 2012-04-16 19:26:57      1    16
17: 1001 2012-04-17 15:43:26      1    17
18: 1008 2012-04-21 07:12:20      0    18
19: 1004 2012-04-26 06:44:01      0    19
20: 1001 2012-05-10 13:17:56      1    20
21: 1005 2012-05-10 18:56:17      1    21
22: 1008 2012-05-11 08:58:28      1    22
23: 1001 2012-05-16 08:20:22      1    23
24: 1003 2012-06-06 04:15:58      1    24
25: 1006 2012-06-11 12:01:15      1    25
26: 1008 2012-06-20 14:06:22      1    26
27: 1002 2012-06-21 05:18:20      1    27
28: 1008 2012-06-29 16:07:28      0    28
29: 1002 2012-07-02 09:42:15      1    29
30: 1005 2012-07-06 22:45:24      1    30
31: 1007 2012-07-08 01:51:51      1    31
32: 1001 2012-08-12 07:04:49      1    32
33: 1006 2012-08-29 04:09:09      1    33
34: 1006 2012-09-25 19:37:58      0    34
35: 1003 2012-10-07 06:20:29      0    35
36: 1002 2012-10-08 19:16:35      0    36
37: 1001 2012-10-11 07:38:40      0    37
38: 1001 2012-10-24 10:58:16      0    38
39: 1005 2012-10-28 16:28:39      0    39
40: 1008 2012-10-30 01:57:52      1    40
41: 1006 2012-11-04 09:14:35      1    41
42: 1007 2012-11-11 10:56:59      0    42
43: 1008 2012-11-13 17:05:58      0    43
44: 1001 2012-11-17 08:38:36      1    44
45: 1005 2012-11-26 02:49:51      1    45
46: 1008 2012-11-26 06:12:53      0    46
47: 1005 2012-11-29 17:34:43      1    47
48: 1001 2012-11-29 23:25:36      0    48
49: 1006 2012-12-14 17:35:57      0    49
50: 1002 2012-12-19 08:36:07      1    50
      ID                Date Status Index
> testWithVisit
    Index   ID                Date Status Num_Visit Num_Show
 1:     1 1002 2012-01-11 03:46:27      1         0        0
 2:     2 1001 2012-02-17 10:15:59      1         0        0
 3:     3 1002 2012-02-26 13:18:42      1         1        1
 4:     4 1001 2012-02-27 18:48:00      1         1        1
 5:     5 1004 2012-03-11 05:40:36      1         0        0
 6:     6 1004 2012-03-17 06:06:05      0         1        1
 7:     7 1008 2012-03-17 14:41:53      0         0        0
 8:     8 1008 2012-03-21 13:55:51      1         1        0
 9:     9 1008 2012-03-22 22:30:42      0         2        1
10:    10 1005 2012-03-29 09:00:39      1         0        0
11:    11 1005 2012-04-04 02:46:54      1         1        1
12:    12 1004 2012-04-05 22:53:05      1         2        1
13:    13 1006 2012-04-11 19:53:10      0         0        0
14:    14 1007 2012-04-14 17:19:07      1         0        0
15:    15 1003 2012-04-16 08:28:26      1         0        0
16:    16 1007 2012-04-16 19:26:57      1         1        1
17:    17 1001 2012-04-17 15:43:26      1         2        2
18:    18 1008 2012-04-21 07:12:20      0         3        1
19:    19 1004 2012-04-26 06:44:01      0         3        2
20:    20 1001 2012-05-10 13:17:56      1         3        3
21:    21 1005 2012-05-10 18:56:17      1         2        2
22:    22 1008 2012-05-11 08:58:28      1         4        1
23:    23 1001 2012-05-16 08:20:22      1         4        4
24:    24 1003 2012-06-06 04:15:58      1         1        1
25:    25 1006 2012-06-11 12:01:15      1         1        0
26:    26 1008 2012-06-20 14:06:22      1         5        2
27:    27 1002 2012-06-21 05:18:20      1         2        2
28:    28 1008 2012-06-29 16:07:28      0         6        3
29:    29 1002 2012-07-02 09:42:15      1         3        3
30:    30 1005 2012-07-06 22:45:24      1         3        3
31:    31 1007 2012-07-08 01:51:51      1         2        2
32:    32 1001 2012-08-12 07:04:49      1         5        5
33:    33 1006 2012-08-29 04:09:09      1         2        1
34:    34 1006 2012-09-25 19:37:58      0         3        2
35:    35 1003 2012-10-07 06:20:29      0         2        2
36:    36 1002 2012-10-08 19:16:35      0         4        4
37:    37 1001 2012-10-11 07:38:40      0         6        6
38:    38 1001 2012-10-24 10:58:16      0         7        6
39:    39 1005 2012-10-28 16:28:39      0         4        4
40:    40 1008 2012-10-30 01:57:52      1         7        3
41:    41 1006 2012-11-04 09:14:35      1         4        2
42:    42 1007 2012-11-11 10:56:59      0         3        3
43:    43 1008 2012-11-13 17:05:58      0         8        4
44:    44 1001 2012-11-17 08:38:36      1         8        6
45:    45 1005 2012-11-26 02:49:51      1         5        4
46:    46 1008 2012-11-26 06:12:53      0         9        4
47:    47 1005 2012-11-29 17:34:43      1         6        5
48:    48 1001 2012-11-29 23:25:36      0         9        7
49:    49 1006 2012-12-14 17:35:57      0         5        3
50:    50 1002 2012-12-19 08:36:07      1         5        4
    Index   ID                Date Status Num_Visit Num_Show

#Generate test data.
test = data.frame(list(ID = sample(1001:1008, size = 50, replace = TRUE)))
test$Date = as.POSIXct(sample(as.POSIXct("2012-01-01"):as.POSIXct("2012-12-31"), size = 50, replace = FALSE), origin = as.POSIXct("1970-01-01"))
test$Status = sample(0:1, size = nrow(test), replace = TRUE, prob = c(0.4, 0.6))
test = test[order(test$Date), ]
test$Index = c(1:nrow(test))

#Compute Num_Visit and Num_Show
test = data.table(test)
setkey(test, "Index")
counts = test[, list(Num_Visit = length(Index[test$Index < Index & test$ID == ID]),
                       Num_Show = length(Index[test$Index < Index & test$ID == ID 
                                               & test$Status == 1])), 
           by = key(dt)]

testWithVisit = test[counts, ] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:01:20.937

由于`data.frame`您在`counts`定义中执行的常规子集化，这很慢。例如

```
Num_Visit = length(Index[test$Index < Index & test$ID == ID]) 
```

这也（我认为......）需要一个数据副本，随着数据变大，这对内存使用很困难。相反，您应该使用`data.table`操作和`cumsum`.

```
test[, list(Date = Date,
            Status = Status,
            Num_Visit = seq_along(.I) - 1,
            Num_Show  = cumsum(Status) -1),
     by=ID] 
```

您还可以使用键对数据进行排序，以便日期按正确的顺序排列。

```
setkey(test, ID, Date) 
```

# java - 在 jsp 字符串变量中存储一个 java 脚本值

> ID：15093245
> 
> 赞同：2
> 
> 时间：2013-02-26T15:41:34.117
> 
> 标签：java, javascript, jquery, ajax, jsp

谁能帮我解决我的jsp代码的简单问题？这是我的带有 JavaScript 的 jsp 页面

```
function fid()
{
    var id=document.getElementById("id").value;
    alert(id);
    <%
             String demo=id;             // store id value of java script but not working
             or find(id);                // or call a function with parameter of java script var value
                                       // both are not working
     %>
} 
```

这是我的html页面——

```
Enter Student Id<input type='text' id='id'><button type='button' onclick='fid()'>Find</button> 
```

如何在 jsp 函数中传递 js 值。
我知道我可以用 ajax 或 jquery 做到这一点，但我不知道这些语言。欢迎任何建议或代码片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-04T22:14:21.890

## 服务器端与客户端

为了让您的服务器响应用户输入，必须发送一个请求。您可以要求您的服务器可以通过以下两种方式之一发送响应：

1.  一个全新的页面 - 例如单击链接并加载新的 HTML 页面时
2.  AJAX 响应 - 异步运行并根据需要格式化，以便客户端 JavaScript 可以使用它。

但是服务器不能自己操作现有页面的 DOM。即使使用 AJAX，它也必须在客户端有一些代码（通常是 JavaScript）来操作页面。

通常，如果您进行搜索，我会推荐选项 1。这具有更简单的好处，它允许您的用户向后/向前导航或为他们的搜索添加书签（假设您进行 GET 调用而不是 POST）。查看[何时使用 AJAX 何时不使用](http://webdesign.about.com/od/ajax/a/aa092506.htm)

## 使用 AJAX

如果您想使用 AJAX，请调用您的服务器创建您的 xmlhttp 对象，然后您可以将变量作为仅使用 AJAX 提到的 @A4L 传递。它看起来像这样：

```
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    // Do what you want with the results from your server
    document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
    }
  }
var xmlhttp = new XMLHttpRequest();

xmlhttp.open("GET",'myJSP.jsp/?id=' + id,true);
xmlhttp.send(); 
```

然后你的服务器可以拉入像@A4L 提到的参数。您可能希望您的响应只是纯文本或 javascript 可以放置在 DIV 中的 HTML 块，但这完全取决于您。

*免责声明：我不是 AJAX 专家。其中大部分是您可以从[W3 Schools 网站学到的东西](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-11T23:39:59.340

本方案不涉及js。正如你所说，你的 js 和 jsp scriplet 在同一个 jsp 上。试试这个：

```
<%
//find form was submit, if cmd is not null
if(null != request.getParameter("cmd")) {
   String id = request.getParameter("id");
   //your logic to find
}
%>

<form action='same.jsp'>
   Enter Student Id: <input type='text' id='id' value='${param.id}'/><!-- ${param.id} to restore the previously entered value by user -->
   <button name='cmd'>Find</button><!-- removed onclick, added name -->
</form> 
```

**PS**避免使用 jsp 脚本，而是使用 JSTL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:49:52.027

您的 javascript 值是客户端的，您的 scriptlet 是在服务器端运行的。因此，如果您想在 scriptlet 中使用您的 javascript 变量，您需要提交它们。

为此，可以将它们存储在输入字段中并提交表单，或者执行 ajax 请求。我建议您为此研究 JQuery。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T16:05:02.423

`Java script`是`Client side`并 `JSP`在服务器端运行。

所以使用一些隐藏变量，比如[这里](https://stackoverflow.com/questions/8268356/assign-javascript-variable-to-java-variable-in-jsp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T15:48:26.240

Java 脚本运行在客户端，JSP 运行在服务器上。如果您希望您的 JS 变量到达服务器并因此可以从 JSP 访问，那么您必须使用类似的东西将其作为请求参数发送到 JSP，`var url = 'myJSP.jsp/?id=' + id`并且在您的 jsp 中您可以使用`request.getParameter("id")`

# excel - 在另一个子例程中删除 Excel 列？

> ID：15093247
> 
> 赞同：0
> 
> 时间：2013-02-26T15:41:37.667
> 
> 标签：excel, vba, function, call

我有一个连接两个相邻列中的值的宏。它完美地工作。我想添加一个命令，然后在连接完成后删除第二列。我可以从现有的子路由/宏内部执行此操作，还是需要调用单独的函数？这是我所拥有的：

```
Option Explicit
Sub Doc1_Doc2_Merge()

Dim CurrCol As Integer
Dim NewValue As String

CurrCol = 1

While Cells(1, CurrCol).Address <> "$JL$1"

    'MsgBox Cells(1, CurrCol).Address & " " & Cells(1, CurrCol).Value
    If InStr(Cells(1, CurrCol).Value, "Doc1") > 0 Then
        ' look at next cell
        If InStr(Cells(1, CurrCol + 1).Value, "Doc2") > 0 Then
            If Trim(Cells(2, CurrCol + 1).Value) <> "" Then
                NewValue = Cells(2, CurrCol).Value & ", " & Cells(2, CurrCol + 1)
                'MsgBox "New Value is " & NewValue
                Cells(2, CurrCol).Value = NewValue
            End If
        End If

    End If
    'now delte currCol+1

    'This is the deletion part that isn't working
    Column(CurrCol + 1).Select
    Selection.Delete Shift:=xlToLeft

    'Advance the counter
    CurrCol = CurrCol + 1
Wend

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:29:38.333

代替

```
Column(CurrCol + 1).Select 
```

和

```
Range(Columns(CurrCol + 1), Columns(CurrCol + 1)).Select 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:35:02.380

试试这个代替 Select/Delete 行：

```
 Columns(CurrCol + 1).EntireColumn.Delete 
```

# php - 如何将更新查询从 mysql 更改为 pdo？

> ID：15093251
> 
> 赞同：0
> 
> 时间：2013-02-26T15:41:43.773
> 
> 标签：php, mysql, pdo

我正在使用波纹管查询进行更新，但现在我尝试将其更改为 pdo 并且它无法正常工作请任何帮助将不胜感激

```
 function updateonlinesession(){            
    if(isset($_SESSION['username']['id'])){
    $uid = $_SESSION['username']['id'];
    $page = $_SERVER['REQUEST_URI'];
    $ip = $_SERVER['REMOTE_ADDR'];
    $username = $_SESSION['logged'];

    mysql_query("UPDATE site_user SET dateupdated  = now(),ip = '$ip' WHERE 
    username = '".mysql_real_escape_string($_SESSION['username'])."'"); 
    }

    } 
```

这是我用 pdo 尝试过的

```
function updateonlinesession(){         
if(isset($_SESSION['username']['id'])){
$uid = $_SESSION['username']['id'];
$page = $_SERVER['REQUEST_URI'];
$ip = $_SERVER['REMOTE_ADDR'];
$username = $_SESSION['logged'];

$update = ("UPDATE site_user SET dateupdated  = now(),ip = '$ip' WHERE 
username = '".($_SESSION['username'])."'");
$sth_update= $con->prepare($update);
$sth_update->execute();
}

}

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T15:45:46.173

```
// connetion
$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

// query
$sql = "UPDATE site_user SET dateupdated = NOW(), ip = ?
        WHERE username = ?";
$q = $conn->prepare($sql);
$q->execute(array($ip, $_SESSION['username']); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T15:46:39.383

首先，连接到 bootstrap/config 文件中的某处：

```
$dsn = 'mysql:dbname=test;host=localhost;charset=utf8';
$opt = array(
    PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
);
$pdo = new PDO($dsn, $user, $pass, $opt); 
```

然后，运行您的查询

```
function updateonlinesession(){
    global $pdo;
    if(isset($_SESSION['username']['id'])){
        $sql = "UPDATE site_user SET dateupdated=now(),ip=? WHERE username=?"; 
        $pdo->prepare($sql);
        $pdo->execute(array($_SERVER['REMOTE_ADDR'], $_SESSION['logged']));
    }
} 
```

确保您使用的所有变量都具有正确的值（`var_dump($_SESSION)`就足够了）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-26T15:47:33.840

```
$stmt = $db->prepare("UPDATE site_user SET dateupdated=now(), ip=? WHERE username=?");
$stmt->execute(array($ip, $_SESSION['username']));
$affected_rows = $stmt->rowCount(); 
```

`$db`你的连接在哪里

再次：[一个很棒的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-26T15:46:48.910

```
function updateonlinesession(){
    if(isset($_SESSION['username']['id'])){
        $uid = $_SESSION['username']['id'];
        $page = $_SERVER['REQUEST_URI'];
        $ip = $_SERVER['REMOTE_ADDR'];
        $username = $_SESSION['logged'];

        //Establish your PDO object.
        $pdo = new PDO("mysql:host=localhost;dbname=mydb", "username", "password");

        //Prepare your statement.
        $stmt = $pdo->prepare("UPDATE site_user SET dateupdate = now(), ip = ? WHERE username = ?");
        $stmt->execute(array(
            $ip,
            $_SESSION['username']
        ));
        $stmt->closeCursor();
    }
} 
```

# c# - 检查每个控制器方法中的登录状态

> ID：15093253
> 
> 赞同：1
> 
> 时间：2013-02-26T15:41:47.393
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我用 C# 在 ASP.NET MVC4 中编写了一个 webApp。我使用 FormsAuthentication.SetAuthCookie(username, true); 登录用户 方法。

现在我想检查每个控制器的登录状态。如果没有人登录，用户应该被重定向到登录控制器视图。我不想手动将这段代码添加到每个控制器中。

任何人的想法，如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:48:51.257

使用 [AuthorizeAttribute] 来实现您所需要的。例如：

```
public class AccountController : Controller
{

     [Authorize]
     ActionResult ActionRequiringAuthorization()...
     ....

     [AllowAnonymous] //Will allow both, authenticated and non-authenticated requests
     ActionResult PublicAction() ...
} 
```

如果用户不再通过身份验证，则在尝试执行任何带有 Authorize 属性的操作时，他将被重定向到登录页面。

您可以装饰整个控制器以将相同的属性应用于所有操作，如下所示：

```
 [Authorize]
 public class AccountController : Controller 
```

# c# - 如何从字符串中删除 \n\r？

> ID：15093261
> 
> 赞同：-5
> 
> 时间：2013-02-26T15:42:13.610
> 
> 标签：c#

我有这个代码：

```
if (t == obj)
{
    LocalyKeyWords.Remove(tokens[0]);
} 
```

变量`t`是`string`并且`obj`也是`string`。在某些情况下，我使用断点并看到最后包含的 obj`\n\r`所以我想检查字符串 obj 是否包含`\n\r`删除`\n\r`然后进行比较`t == obj`

我该怎么做 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T15:43:56.410

```
myString = myString.Replace("\n", string.Empty).Replace("\r", string.Empty); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T15:44:35.847

`Trim`从字符串的开头和结尾删除空格，所以如果你只想从结尾删除空格，我建议使用它：

```
if (t.Trim() == obj.Trim()) 
```

如果您必须从整个字符串中删除所有换行符，那么您可以使用这个：

```
public static string RemoveNewlines(string input)
{
    return input.Replace("\r", "").Replace("\n", "");
} 
```

因为该函数将能够处理任何类型的换行符，无论是`\n`、`\r\n`、`\r`，甚至是几个的组合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T15:44:15.623

摆脱不需要的字符的常用方法是用空字符串[替换它们](http://msdn.microsoft.com/en-us/library/system.string.replace.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T15:44:32.643

就用这个

```
t = t.Replace("\r\n", string.Empty); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T15:46:00.613

如果此变量位于字符串的开头或结尾，则应使用 [`string.Trim`](http://msdn.microsoft.com/en-us/library/system.string.trim.aspx)simple [`string.Replace`](http://msdn.microsoft.com/en-us/library/system.string.replace.aspx)。

# iis - 在 Ajax 驱动的网站中重写 url

> ID：15093265
> 
> 赞同：0
> 
> 时间：2013-02-26T15:42:26.383
> 
> 标签：iis, url-rewriting

我正在建设 ajax 驱动的网站。所以基本上，我只有一页“ [http://www.mysite.com/default.aspx](http://www.mysite.com/default.aspx) ”我想摆脱这个“default.aspx”，只留下“ [http://www.mysite.com](http://www.mysite.com) ”。

我怎样才能做到这一点？我必须重写网址吗？或者也许可以将 IIS 配置为隐藏默认站点名称和扩展名？

# php - 为什么当我将 PHP 代码添加到 using jQuery?

I have a problem with setting phtml in my jwysiwyg textarea. When I set up my HTML with code like this:

```
$("#txtarea").wysiwyg('setContent',

ID：15093274

赞同：0

时间：2013-02-26T15:43:04.220

标签：php, javascript, jquery, wysiwyg 
```

# c# - 从 ajax 调用本地 C# web 服务，401 错误未经授权

> ID：15093275
> 
> 赞同：0
> 
> 时间：2013-02-26T15:43:06.387
> 
> 标签：c#, jquery, ajax, web-services, unauthorized

我对 ajax 调用的登录函数有疑问，这是该函数的代码，它是一个可见的 Web 服务

```
[WebMethod]
    [System.Web.Script.Services.ScriptMethod]
    public string CheckData(string login, string Pass)
    {
        global gb = new global();

        if (gb.CheckUserExist(login, Pass))
        {
            System.Web.Security.FormsAuthentication.RedirectFromLoginPage(login, true);
            HttpCookie cookie = new HttpCookie("userData",login);
            cookie.Expires = DateTime.Now.AddMonths(2);
            Mosab2aModel.Mosab2aEntities context = new Mosab2aModel.Mosab2aEntities();

            var User = context.Users.Where(x => x.UserName == login && x.Password == Pass)
                .Select(x => new { x.UserName, x.Password, x.Admin, x.DisplayName, x.FBID }).First();

            cookie["UserName"] = User.UserName;
            cookie["Password"] = User.Password;
            cookie["isAdmin"] = User.Admin.ToString();
            cookie["Name"] = User.DisplayName;
            cookie["FBID"] = User.FBID;
            Context.Response.Cookies.Add(cookie);
            //Context.Response.Redirect("/Default.aspx");
            return "1";
        }
        else
        {
            return "0";
        }
    } 
```

我在这里用 ajax 来称呼它

```
$.ajax({
                    type: "POST",
                    url: 'LoginService.asmx/CheckData',
                    data: "{'login':'"+ login +"','Pass':'"+pass +"'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                        success: function(msg)
                        {

                            if (msg.d == "1")
                            {
                                //document.location.href = '/Default.aspx';
                            }
                            else
                            {
                                formWrapper.clearMessages();
                                displayError('Username or password is incorrect');
                            }
                        },
                        error: function()
                        {
                            formWrapper.clearMessages();
                            displayError('Error in contacting server , try again later.');
                        }
                  }); 
```

如果用户不存在，我有一个奇怪的问题，该函数运行良好，它返回值 0 并显示错误，但如果该函数找到用户，则会收到 401 错误未授权。

编辑：经过几次搜索，问题出在这一行！

```
System.Web.Security.FormsAuthentication.RedirectFromLoginPage(login, true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:14:53.573

乍一看，经过身份验证的用户似乎对 ReturnURL（或默认 URL）指定的页面没有适当的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T09:06:47.057

通过允许公共访问 webservice 解决了问题，通过 web.config 运行安全模型时，默认情况下它被拒绝 谢谢大家。

# extjs - 更改 CFWindow 的背景颜色

> ID：15093276
> 
> 赞同：1
> 
> 时间：2013-02-26T15:43:10.747
> 
> 标签：extjs, coldfusion, coldfusion-9

ColdFusion默认CFWindows为暗灰色背景，我相信十六进制值#dddddd。我想改变这一点，这似乎最好使用 bodyStyle 属性来完成。但是，我正在使用 javaScript 方法创建窗口：

```
 ColdFusion.Window.create('#attributes.name#','#attributes.title#',windowURL#caller.windowID#,dFeatures); 
```

将 bodyStyle 添加到 dFeatures 变量没有任何效果，并且 CF 文档表明无法在使用此方法时传递样式。

当不使用标签创建 CFWindow 时，是否可以（轻松）更改 CFWindow 的背景颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T17:32:45.957

试试这个 CSS 代码。我通过 CSS 代码而不是调用来设计我的窗口。

```
.x-window-mc { background-color: #dddddd; } 
```

# jquery - 多个对话框之间的 JQueryUI 可排序连接/浮动问题

> ID：15093279
> 
> 赞同：1
> 
> 时间：2013-02-26T15:43:18.710
> 
> 标签：jquery, css, jquery-ui

**问题：http:** [//jsfiddle.net/Drath/Y9k3P/](http://jsfiddle.net/Drath/Y9k3P/)

我在两个对话框之间连接两个 jQueryUI 可排序列表时遇到了这个问题。问题归结为浮动。如果您在它自己的对话框中移动可排序，它会完美运行。如果您尝试将其移动到另一个对话框，它将无法注册为“接受”可排序的元素没有高度，因为它的所有元素都是浮动的。

**我试过的：**

尝试使用`display:inline-block`而不是浮动。这确实有效，但会使拖放运动真正出现故障/零星，并对布局产生奇怪的影响。

尝试使用所有不同的 clearfix/float 方法（强制容器大小）。这些也可以工作，但拖放运动再次出现故障/零星。

尝试使用与 clearfix 方法相同的效果设置特定的容器高度。

尝试了可排序选项的一百万种不同组合。

我愿意接受建议和可能的替代解决方案来模拟这种效果/功能。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-04T14:07:34.960

在玩了你的代码之后，我终于让它工作了。

我认为这里的重点是选择器中的`float: left;`语句`#sortable1, #sortable2`。

我还将您的 div 转换为 ul 和 li 组合。我还没有尝试过使用 div 的解决方案。

这是我的 jsJiddle 解决方案：http: [//jsfiddle.net/AramCH3K/5xKuh/3/](http://jsfiddle.net/AramCH3K/5xKuh/3/)

拖动在文本前面显示一个点的项目时，我没有对故障进行太多工作。它与克隆列表项有关，但我不知道如何设置克隆项的样式。必须有一种方法可以为其添加`list-style-type: none;`样式。

**编辑：**

我已经使用[此处](https://stackoverflow.com/a/5552393/362935)的答案更新了我的代码，以克服拖动故障。

这是我更新的 jsFiddle 解决方案：http: [//jsfiddle.net/AramCH3K/U6LVa/](http://jsfiddle.net/AramCH3K/U6LVa/)

**最终编辑：**

在我[更新的解决方案中](http://jsfiddle.net/AramCH3K/U6LVa/1/)，我使用了克隆，我认为它提供了一个更清洁的解决方案。

# jquery - Safari Ajax cors 请求未遵循重定向

> ID：15093281
> 
> 赞同：6
> 
> 时间：2013-02-26T15:43:24.150
> 
> 标签：jquery, ajax, safari, cors

基本上，我有一个登录表单，一旦通过身份验证，它就会启动一个 Oauth2 进程。它可以完美地工作，直到它必须进行最终的重定向以获得访问令牌。登录流程如下 POST`/user/login`重定向到`/user/oauth/auth`然后重定向到 Oauth redirect_uri `/user/oauth/redirect`。redirect_uri 永远不会发生，请求永远不会到达服务器。

如果我使用 Ajax 请求点击该重定向，则 cors 工作正常，并且我得到预期的响应，它似乎只有在我重定向两次时才会发生。

服务器显示这些响应

```
[I 130226 10:16:38 web:1462] 302 POST /user/login (192.168.1.5) 156.01ms  (Session cookies set fine)
[I 130226 10:16:38 web:1462] 200 OPTIONS /user/oauth/auth?scope=&client_id=DemoApp&response_type=code&redirect_uri=http://192.168.1.5:8443/user/oauth/redirect/code (192.168.1.5) 1.86ms
302 GET /user/oauth/auth?scope=&client_id=DemoApp&response_type=code&redirect_uri=http://192.168.1.5:8443/user/oauth/redirect/code (192.168.1.5) 8.58ms 
```

最后一个 URL 永远不会被点击。在 Chrome、IE、FF 中，除了服务器看到请求外，流程是相同的

```
[I 130226 10:16:38 web:1462] 302 POST /user/login (192.168.1.5) 156.01ms  
[I 130226 10:16:38 web:1462] 200 OPTIONS /user/oauth/auth?scope=&client_id=DemoApp&response_type=code&redirect_uri=http://192.168.1.5:8443/user/oauth/redirect/code (192.168.1.5) 1.86ms
302 GET /user/oauth/auth?scope=&client_id=DemoApp&response_type=code&redirect_uri=http://192.168.1.5:8443/user/oauth/redirect/code (192.168.1.5) 8.58ms
[I 130226 10:27:12 web:1462] 200 GET /user/oauth/redirect/code?code=57497058fbbf6003310ea22d3902ac67 (192.168.1.5) 0.54ms 
```

在 Web Inspector 中，我看到了请求，但像死了一样

![在此处输入图像描述](../Images/32de6e48072dac7e04a1576913bfce04.png)

我正在使用 Jquery 1.9，这里是 ajax 请求（当然，我在这里有阳光下的所有选项来尝试让它工作。）

```
$.ajax({
    type: "POST",
    url: reqUrl,
    data: data,
    dataType: "json",
    success: function(data, textStatus) {
            console.log(data);
            alert('logged in');

    },
    error: function(e){
        console.log(e);
    },
    complete: function(request, status) {
        console.log("headers=" + request.getAllResponseHeaders());
    },
    statusCode: {
    200: function(data) {
        console.log('yup we got it.')
    }
  },
  xhrFields: {
    withCredentials: true
  },
  crossDomain: true,
  async:true
}); 
```

JSONP 不是一个选项，因为初始帖子是通过 https 发送的，并且必须是 POST 请求。同样，包括 IE 在内的所有其他浏览器都可以正常工作，它会触发成功响应。

Safari 会触发 Statuscode 0 和错误，这是经典的 Origin 策略错误，但重定向 uri 在绕过登录的标准 ajax 请求中工作。我怀疑这是一个访问控制问题，因为如果 Safari 只是触发它，该调用将起作用。

我很确定它与重定向上的请求标头有关，并且 Safari 正在停止请求。在第一个成功的 302 上，它们看起来像这样

```
Access-Control-Request-Method: GET
Origin: http://192.168.1.5:9090
Access-Control-Request-Headers: origin, accept-encoding, accept-language 
```

但是在重定向 uri 上，它们看起来像这样（这对于为什么它失败是有道理的，因为没有发送访问控制标头，但是为什么？？）

```
Origin: http://192.168.1.5:9090
Accept-Encoding: gzip, deflate
Accept-Language: en-us
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/536.26.17 (KHTML, like Gecko) Version/6.0.2 Safari/536.26.17
Accept: */*
Referer: http://192.168.1.5:9090/login 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T16:49:11.750

好吧，看起来这是一个 Safari 的东西，它只会跟随第一个重定向。Apple 声称这是编写 HTML 规范的方式。所以.... 不得不重新设计我的流程以不重定向`/user/login`并立即启动 oauth 过程。

# gwt - GWT：动态图片的高效加载

> ID：15093297
> 
> 赞同：1
> 
> 时间：2013-02-26T15:44:12.183
> 
> 标签：gwt

*   我正在创建一个显示信息表的 GWT 应用程序。
    *   表格的每一行对应一个数据对象。
    *   在表格的每一行中，都有一个必须**动态**生成的图像（图像是与行关联的对象的一个​​相当简单的函数。）
    *   重申一下，预先生成涵盖桌子所需所有内容的静态图像世界是不可接受的**。**所需的图像集是**无限**的。

在 Canvas 小部件中生成任何一张图像都很容易，**但是**：

*   我更喜欢使用 CellTable，因为可能要显示数百行。
*   CellTable 不允许在单元格中使用像 Canvas 这样的小部件。
*   无论如何，在客户端绘制 100 个 Canvas 似乎很昂贵。

我想知道这种情况是否有既定的有效模式？我正在考虑以下内容（但我不确定它是否可行——见下文）：

*   每当 CellTable 更新时，客户端都会进行 RPC 调用——例如“ **getDynamicImageBundle(List<MyDataObject> objects)** ”，
*   getDynamicImageBundle() 的返回值应该是单个合成图像，从中可以轻松提取每个组件图像。
*   提取的图像用于填充 CellTable 的动态图像列。

我的问题如下：

*   第一个问题是“这根本不可能吗”：即，如果 CellTable 中的 Cell 的工作是生成 HTML，而动态生成的图像是一大块与任何 URL 无关的二进制数据，确实如此这意味着我根本不能在这里使用 CellTable 吗？
*   更一般地说，我是否必须“破解” GWT 以将这些动态图像与一些虚构的 URL 相关联，以便让任何东西在这里工作？还是使用画布？
*   如果我上面的高级行动计划（涉及 RPC 调用）实际上是可行的，那么是否有人有指向 GWT 类的指针可以在这里提供帮助？看起来像 ImageResource 这样的组件是围绕静态图像集构建的。

# http - Spring MVC HTTP 断开连接通知

> ID：15093310
> 
> 赞同：0
> 
> 时间：2013-02-26T15:44:29.417
> 
> 标签：http, spring-mvc

我们在 Tomcat 7 上使用 Spring MVC 的 REST 基础架构。我们的请求可能会持续几秒钟。当 HTTP 请求的客户端断开连接并且不再监听响应时，我们是否有办法获得通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:07:09.097

您是否使用任何 javascript 组件来发出 REST 请求？网格还是下拉？

可能您需要检查呼叫的响应代码。如果您收到响应代码，则表示客户端已断开连接。

# java - 在JAVA中解析XML，拉出特定的数据

> ID：15093315
> 
> 赞同：1
> 
> 时间：2013-02-26T15:44:40.050
> 
> 标签：java, xml, parsing

我不确定问我的问题有多准确。我相信两个问题可能会有所帮助：

我一直在玩解析文件——尤其是 xml。

我发现了许多教程和许多不同的技术。

大多数教程都有一个简单的 xml 文件，开头包含姓名、电话号码等。

我的2个问题：

1）我怎样才能提取/显示特定之间的数据。例如，如果我只想显示`<FirstNames>`如何（在 Java 中）执行以下操作：

```
loop

If <tag> = “FirstName” then name_variable = data in between tags);

or

If <tag> = “FirstName” then System.out.printf(“ the first name is %s\n”,name_variable);

end loop 
```

2）假设我只寻找名字的第二个实例，在一些教程/示例中，我已经看到了如何在循环中显示所有数据。我试图将数据设置为等于“阵列”字符串，然后在循环外显示数据，但已删除。最重要的是，您如何存储已解析的 XML 数据的索引（数组）片段以供使用或传入以后的代码？

```
<company>
<Name>My Company</Name>
<Executive type = "CEO">
    <LastName>Smith</LastName>
    <FirstName>Jim</FirstName>
    <street>123 Main Street</street>
    <city>Mytown</city>
    <state>TN</state>
    <zip>11234</zip>
</Executive>
<Executive type = "OEC">
    <LastName>Jones</LastName>
    <FirstName>John</FirstName>
    <street>456 Main Street</street>
    <city>Gotham</city>
    <state>TN</state>
    <zip>11234</zip>
</Executive>
</company> 
```

这是我拼凑的一些代码，我从我的 XML 中获取了一些数据，但我还没有弄清楚如何存储在索引的解析数据中。

```
package dom_parsing_in_java;
import  org.w3c.dom.*;
import javax.xml.parsers.*;
import java.io.*;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.NamedNodeMap;
//import com.sun.org.apache.xerces.internal.parsers.DOMParser;

public class DOM_Parsing_In_JAVA {

   public static void main(String[] args) {
    // TODO code application logic here
    String file = "test2.xml";

if(args.length >0){
    file = args[0];

}// end If

try{
    //DOMParser parser= new DOMParser();
    DocumentBuilderFactory factory= DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document document = builder.parse(new File(file));

    //Document document = parser.getDocument();

    Element root = document.getDocumentElement();
    System.out.println(root.getTagName());

    NodeList node_list = root.getElementsByTagName("Executive");

   //Node comp = getNode("Company",root);

    int i;

    for(i = 0; i<node_list.getLength();i++){
        Element department = (Element)node_list.item(i);

        System.out.println(department.getTagName());
        System.out.println("name "+document.getElementsByTagName("Name").item(0).getTextContent());
        System.out.println("name "+document.getElementsByTagName("FirstName").item(i).getTextContent());
        System.out.printf(" Lastname: %s%n ", document.getElementsByTagName("LastName").item(i));
        System.out.printf(" Lastname: %s%n ", department.getAttribute("LastName"));
        System.out.printf(" FirstName: %s%n",department.getAttribute("FirstName"));
        //System.out.printf(" elements by Tag %s%n",department.getElementsByTagName("testTag"));
        //System.out.printf(" staff: %s%n",countStaff(department));
    }

}
catch(Exception e){
    e.printStackTrace();

}//end catch
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:53:06.680

看看 StAX API：[http ://docs.oracle.com/javase/tutorial/jaxp/stax/why.html](http://docs.oracle.com/javase/tutorial/jaxp/stax/why.html)

（您可能想使用它的“迭代器/事件 API”：[http](http://docs.oracle.com/javase/tutorial/jaxp/stax/api.html) ://docs.oracle.com/javase/tutorial/jaxp/stax/api.html ）

这是一个示例：[http ://docs.oracle.com/javase/tutorial/jaxp/stax/example.html#bnbfz](http://docs.oracle.com/javase/tutorial/jaxp/stax/example.html#bnbfz)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-29T00:51:25.417

我会沿着 XPath-route 将 XML 文件解析为 Document。

XPath 可用于导航 XML 文档。请参阅 [http://www.w3schools.com/xpath/default.asp](http://www.w3schools.com/xpath/default.asp)以获取有关您可以使用 XPaths 实现什么的更多信息。

假设一切都在 main 中完成：

```
public static void main(String[] args) {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document doc = builder.parse(new File("file.xml"));
    XPathFactory xPathfactory = XPathFactory.newInstance();
    XPath xpath = xPathfactory.newXPath();
    XPathExpression firstnameExpr = xpath.compile("//FirstName");

    NodeList nl = (NodeList) firstnameExpr.evaluate(doc, XPathConstants.NODESET);

    for (int i=0; i<nl.getLength(); i++) {
        Node node = nl.item(i);

        // this is assuming the first child of Firstname is the characters (contents)
        // of the Firstname tag, you may need to do some checking whether or not
        // node.getNodeType() == Node.Text;
        System.out.println("Firstname["+i+"] = " 
                                + node.getChildNodes()[0].getTextContent());
    }

} 
```

除了将名字内容打印到 System.out 之外，您还可以将值添加到 ArrayList 来维护顺序，即：

```
List<String> firstnameList = new ArrayList<String>();

for (int i=0; i<nl.getLength(); i++) {
    Node node = nl.item(i);

    // again, you might want to check that .getChildNodes() doesn't return null
    // and that it is of type Node.Text
    firstnameList.add(node.getChildNodes()[0].getTextContent());
} 
```

# iphone - AVAudioPlayer：MP3 文件不在设备上播放，但在模拟器中工作（iOS 6）

> ID：15093316
> 
> 赞同：4
> 
> 时间：2013-02-26T15:44:44.347
> 
> 标签：iphone, ios, objective-c, avaudioplayer

我正在使用下面的代码在 iOS 6 上使用 AVAudioPlayer 播放 MP3 文件。该文件似乎正在播放，但设备上没有声音输出。不过，它在 iOS 模拟器中运行良好。

**文件.h：**

```
#import "UIKit/UIKit.h"
#import "AVFoundation/AVFoundation.h"

@interface ViewController : UIViewController <AVAudioPlayerDelegate>

@property (strong, nonatomic) AVAudioPlayer *player;

@end 
```

**文件.m：**

```
#import "ViewController.h"

@implementation ViewController

@synthesize player;

- (void)viewDidLoad {
    [super viewDidLoad];

    NSString *soundFilePath = [[NSBundle mainBundle] pathForResource:@"beep_7" ofType:@"mp3"];
    NSLog(@"Audio path: %@", soundFilePath);

    NSError *error;
    player =[[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:soundFilePath] error:&error];

    if (error) {
        NSLog(@"Error in audioPlayer: %@",[error localizedDescription]);
    } 
    else {
        [player setDelegate:self];
        [player setNumberOfLoops:3]; //just to make sure it is playing my file several times
        player.volume = 1.0f;

        if([player prepareToPlay]) //It is always ready to play
            NSLog(@"It is ready to play");
        else
            NSLog(@"It is NOT ready to play ");

        if([player play]) //It is always playing
            NSLog(@"It should be playing");
        else
            NSLog(@"An error happened");
    }
}
@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T15:54:12.167

您发布的代码对我来说很好。

*   您确定要在目标中包含 beep_7.mp3 吗？
*   你确定文件名是正确的吗？iOS 设备使用区分大小写的文件系统！
*   你确定你的设备没有静音吗？
*   您确定该文件是有效的、可工作的 MP3 文件吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-03T02:49:19.900

检查您的设备的静音模式是打开还是关闭？我曾经遇到过和你一样的问题，关掉静音模式后，一切都解决了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T03:29:46.733

你设置了 AudioSessionCategory 吗？

```
{
    NSError *setCategoryError = nil;
    BOOL success = [[AVAudioSession sharedInstance] setCategory: 
    avaudiosessioncategoryplayandrecorderror: &setCategoryError];
} 
```

# c++ - 这些关于 GCC 优化的评论是否有效？

> ID：15093324
> 
> 赞同：22
> 
> 时间：2013-02-26T15:44:59.193
> 
> 标签：c++, c, optimization, gcc

在[Demystifying the Restrict Keyword](http://cellperformance.beyond3d.com/articles/2006/05/demystifying-the-restrict-keyword.html)的底部是这个奇怪的建议：

> 由于 GCC 中调度的顺序，简化表达式总是更好。**不要将内存访问与计算混为一谈。**代码可以重写如下：

然后有一个例子本质上改变了这个

```
velocity_x[i] += acceleration_x[i] * time_step; 
```

进入这个

```
const float ax  = acceleration_x[i];       // Then the same follows for y, z
const float vx  = velocity_x[i];           // etc for y, z
const float nvx = vx + ( ax * time_step ); // etc
velocity_x[i]   = nvx;                     // ... 
```

真的吗？与优化编译器必须做的其他事情（例如 lambda 参数等）相比，我会认为这种转换是*微不足道*`std::foreach`的。

这只是陈旧、愚蠢的建议吗？或者 GCC 不能或不会这样做有充分的理由吗？（这让我担心`velocity += acceleration * time_step`用我的`Vector3f`课写上面的内容！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-26T16:03:28.173

**编辑：（** *我正在删除有关的详细信息，`restrict`因为它偏离了所提出的实际问题并引起了混乱。假设`restict`使用了 OP。）*

对于优化编译器而言，您问题中的转换确实微不足道，但这不是阿克顿的论文所建议的。

***这是[论文](http://cellperformance.beyond3d.com/articles/2006/05/demystifying-the-restrict-keyword.html)中所做的转换：***

这段代码...

```
 for (size_t i=0;i<count*stride;i+=stride)
  {
    velocity_x[i] += acceleration_x[i] * time_step;
    velocity_y[i] += acceleration_y[i] * time_step;
    velocity_z[i] += acceleration_z[i] * time_step;
    position_x[i] += velocity_x[i]     * time_step;
    position_y[i] += velocity_y[i]     * time_step;
    position_z[i] += velocity_z[i]     * time_step;
  } 
```

...被转换成这段代码：

```
 for (size_t i=0;i<count*stride;i+=stride)
  {
    const float ax  = acceleration_x[i];
    const float ay  = acceleration_y[i];
    const float az  = acceleration_z[i];
    const float vx  = velocity_x[i];
    const float vy  = velocity_y[i];
    const float vz  = velocity_z[i];
    const float px  = position_x[i];
    const float py  = position_y[i];
    const float pz  = position_z[i];

    const float nvx = vx + ( ax * time_step );
    const float nvy = vy + ( ay * time_step );
    const float nvz = vz + ( az * time_step );
    const float npx = px + ( vx * time_step );
    const float npy = py + ( vy * time_step );
    const float npz = pz + ( vz * time_step );

    velocity_x[i]   = nvx;
    velocity_y[i]   = nvy;
    velocity_z[i]   = nvz;
    position_x[i]   = npx;
    position_y[i]   = npy;
    position_z[i]   = npz;
  } 
```

**优化是什么？**

优化**不是**- 正如建议的那样 - 将 1 个表达式分离为 3 个表达式。

优化是在对任何特定数据块进行操作的指令*之间*插入有用的指令。

如果您跟踪数据从`velocity_x[i]`到移动到`vx`，则 CPU 在每个步骤之间执行其他工作。`nvx``velocity_x[i]`

**为什么这是优化？**

现代 CPU 通常具有[流水线架构](http://en.wikipedia.org/wiki/Instruction_pipeline)。

由于指令是分阶段执行的，CPU 允许同时处理多条指令。但是，当一条指令需要另一条尚未完全执行的指令的结果时，这条流水线就会停止。在停止的指令可以运行之前，不会执行进一步的指令。

**为什么我的优化编译器不自动执行此操作？**

有些人会。

GCC 在这种优化方面相对较差。

我使用 gcc 4.7（x86-64 架构，在 -O3 优化）反汇编了上面的两个循环。产生了类似的程序集，但指令的顺序不同，第一个版本产生了严重的停顿，其中单个浮点数将在几条指令的范围内加载、更改和存储。

[你可以在这里](http://gcc.gnu.org/wiki/InstructionScheduling)阅读一些关于 gcc 指令调度的信息，或者只是在网上搜索*gcc 指令调度*来查看很多关于这个问题的令人沮丧的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:40:45.427

在我看来，陈旧/愚蠢的建议。我的意思是详细程度特定于编译器、编译器版本、处理器、处理器版本等。我会坚持可读性并让编译器完成它的工作。如果有人担心某个目标中可能存在一个或两个时钟周期，请为该目标编写一些#def 程序集，并将更高级别的代码留给其他目标和参考。

# c# - C# 中的 3d 开发可能的选项？

> ID：15093326
> 
> 赞同：-1
> 
> 时间：2013-02-26T15:45:02.173
> 
> 标签：c#, opengl, 3d, opentk

我需要构建一个交互式 3D 图形工具，用户可以在其中移动网格并从不同角度可视化它们、放大、缩小，即通常的渲染器交互性。语言的选择是 C# .NET。目标是使其商业化。我查看了一些选项，但由于我是 C# 新手，我无法决定：

1）OpenTK：[http ://www.opentk.com/](http://www.opentk.com/)

2）TrueVision：[http](http://www.truevision3d.com/) ://www.truevision3d.com/ （但不是免费提供）

对于初学者来说，C# 中最常用的 3D 图形包装器或库是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:57:08.247

如果您需要一些简单且免费的东西来开始，请查看**[Helix Toolkit](http://helixtoolkit.codeplex.com/)**。

它是一个开源库，使 WPF 中的 3D 开发成为一种乐趣。

因为它使用 WPF，所以它可以与普通的 Windows 应用程序、WinForms 或 WPF 顺利集成。它专为使用 3D 的简单应用程序而设计。

您可以在演示中看到它包含预构建组件，以帮助用户在场景中移动相机，并直接在模型中移动和旋转图元。

# linq - 如何进行 Linq 外部联接

> ID：15093328
> 
> 赞同：1
> 
> 时间：2013-02-26T15:45:10.490
> 
> 标签：linq, left-join

我有一个包含我想要的所有值的存储库

我们将其称为然后`fieldsRepo` 我有一个包含字段值的实体。我们称之为`entity.FieldValues`

我需要编写一个查询来获取所有字段`fieldsRepo`，以及它们的值（`entity.FieldValues`如果存在）。

如何将其编写为带有左连接的 LINQ，这将过滤掉实体不包含字段的位置。我希望他们仍然被包括在内。

```
var query = from field in fieldsRepo
            join entityField in entity.FieldValues
                on field.Id equals entityField.FieldId
            select new { ... }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:53:02.743

你必须使用 DefaultIfEmpty

[http://msdn.microsoft.com/en-us/library/vstudio/bb397895.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb397895.aspx)

```
var query = from person in people
                    join pet in pets on person equals pet.Owner into gj
                    from subpet in gj.DefaultIfEmpty()
                    select new { person.FirstName, PetName = (subpet == null ?       String.Empty : subpet.Name) }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:47:38.230

使用`join .. into`（即 GroupJoin）。每个加入的组将包含相关的字段值（如果有）

```
var query = from field in fieldsRepo
            join entityField in entity.FieldValues
                on field.Id equals entityField.FieldId into g
            select new { 
                field.Id,
                ValuesCount = g.Count()
            }; 
```

# javascript - CSS、HTML 和 Javascript：“正在加载...”微调器不适用于链接 onClick

> ID：15093329
> 
> 赞同：0
> 
> 时间：2013-02-26T15:45:12.253
> 
> 标签：javascript, html, css, animated-gif

我希望我的网站在我的网站中的按钮（链接和提交按钮）被点击时覆盖整个网页和一个 GIF 动画“加载...”微调器。该网站应该作为 iPhone 网络应用程序工作（“保存到主屏幕”） - 因此，我需要“window.location”（参见[Oskars](https://stackoverflow.com/users/27938/oskar-austegard) [评论](https://stackoverflow.com/a/2899099/1598477)）。我不会也不会使用任何第三方库（没有 jquery 等）。

有什么作用：

*   覆盖适用于所有按钮
*   表单提交按钮的叠加和 GIF 动画工作
*   当我点击一个链接时，GIF 确实出现了，但是......

什么**不起作用**：

*   单击链接时，GIF**不动画。**我在各自的最新版本中使用 Firefox、Internet Explorer 和 Chrome。我通过谷歌找到的只是对“旧”邪恶 ie 版本的引用——但这里并非如此。

我问你的问题：

*   我怎样才能让 GIF 变成动画？

暂时，我会相信[这个评论](https://stackoverflow.com/a/780617)并闭嘴......

这是我在 HTML 和 javascript 中的内容：

```
<div id="overlay"></div>
<div id="page">
  <a onclick="document.getElementById('overlay').style.display = 'block';
              window.location='/';
              return false;" 
     href="/" 
     title="home" 
     alt="home">
     home
  </a>
</div> 
```

这是我在 CSS 中的内容：

```
div#page {
    position:absolute;
    top: 0px;
    left: 0px;
    width:100%;
}
div#overlay {
    display: none;
    z-index: 10000;
    background: #000;
    position: fixed;
    width: 100%;
    opacity: .6;
    height: 100%;
    top: 0px;
    left: 0px;
    background-image:url("spinner.gif");
    background-repeat:no-repeat;
    background-position:center;
} 
```

（例如，“spinner.gif”可以是[http://www.melabev.org/images/spinner.gif](http://www.melabev.org/images/spinner.gif)）

这是一个 jsfiddle 版本：http: [//jsfiddle.net/87paH/2/](http://jsfiddle.net/87paH/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:53:10.340

加载下一页的过程可能会中断动画。我创建了一个带有链接和微调器动画的测试页面。当我单击链接时，动画在浏览器加载新页面时停止。您确定不只是像这样的浏览器行为会停止动画吗？如果您从 onclick 中取出“window.location = '/'”，动画是否有效？

如果您想无缝导航到新页面，您可以使用 AJAX 通过 Javascript 检索 HTML，并用您获取的内容替换页面内容。在 AJAX 运行时，您的叠加微调器应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:55:06.977

你可以试试这个：

```
 <a href="javascript:overlayFunc()" onclick="overlayFunc()" title="home" alt="home">
     home
  </a>

function overlayFunc(){
    document.getElementById('overlay').style.display = 'block';
    window.setTimeout('window.location="/"', 1500);

    return false;
} 
```

# git - Mac和Windows之间的行尾问题

> ID：15093330
> 
> 赞同：6
> 
> 时间：2013-02-26T15:45:12.767
> 
> 标签：git

我有一台 MacBook，并且在 Parallels VM 中运行 Windows。我的开发主要是在 Visual Studio 中，但我喜欢将 Git 与 Mac shell 一起使用（就像它比 Windows 更好）。

当我做一个 git diff 来确定提交之间发生了什么变化时，我得到了众所周知的以“变化”结尾的行，这使得 git 认为变化比实际变化大得多。

我知道这是一个古老的问题，我已经根据很多人的不同建议进行了大量研究，但我无法解决这个问题。在这个[SO Post](https://stackoverflow.com/questions/1510798/trying-to-fix-line-endings-with-git-filter-branch-but-having-no-luck/1511273#1511273)中找到了最有希望的信息，但它并没有解决我的问题。

以下是我的 .gitconfig 中的一些相关行...

```
[core]
    autocrlf = false
    safecrlf = false 
```

另外，我的仓库的根目录中有一个 .gitattributes ，它只包含......

```
* text eol=crlf 
```

我可以做些什么来让 Git 在执行差异时停止认为行尾更改是真正的更改？同样，我使用 Mac shell 来查看 Windows 文件，所以这可能是我的问题的一部分。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-10T16:56:42.640

我别名`gdiff`为：

```
git diff -w origin/`git branch | sed --quiet "s/* \(.*\)/\1/p"` 
```

但你可以这样做：

```
git diff -w 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:50:30.687

使用转换实用程序，例如 Perl、`perl -i -pne "s/\n/\r\n/g"`文件名

或`unix2dos`和`dos2unix`。

另请参阅[http://en.wikipedia.org/wiki/Newline#Conversion_utilities](http://en.wikipedia.org/wiki/Newline#Conversion_utilities)

有关 GIT 的配置，请参阅另一个答案：[Force LF eol in git repo and working copy](https://stackoverflow.com/questions/9976986/force-lf-eol-in-git-repo-and-working-copy)

# delphi - 锚点 [akLeft, akRight, akBottom] 无法正常工作

> ID：15093331
> 
> 赞同：2
> 
> 时间：2013-02-26T15:45:18.023
> 
> 标签：delphi, alignment, anchor

我对锚有一个小问题。

我有一个带有 2 个面板的表单，`Panel1`左对齐并`Panel2`位于第一个面板上，未对齐但固定在顶部和底部。在第二个面板上有两个编辑，它们仅锚定在左侧、右侧和底部。这种设计会产生一种“最小化”的滑动效果，当窗体调整大小时，编辑会在顶部消失。这是有意的。

在应用程序启动时，第二个面板的初始状态应该是不可见的，因此我使用`Panel2.Height := 0`.

但是在调整表单大小或手动设置`Panel2.Height := 104`之后，编辑不会被拖到它们的锚定位置，但它们在面板之外仍然不可见。

这是可以帮助可视化它的示例代码：

```
// unit 1
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls;

type
  TMoveEvent = procedure (Sender: TObject; X, Y: Integer) of object;

  TLabeledEdit = class(ExtCtrls.TLabeledEdit)
  private
    FOnMove: TMoveEvent;
    procedure WMMove(var Message: TWMMove); message WM_MOVE;
  public
    property OnMove: TMoveEvent read FOnMove write FOnMove;
  end;

  TForm1 = class(TForm)
    Panel1: TPanel;
    Panel2: TPanel;
    LabeledEdit1: TLabeledEdit;
    LabeledEdit2: TLabeledEdit;
    Button1: TButton;
    Button2: TButton;
    Label1: TLabel;
    Label2: TLabel;
    Button3: TButton;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
  private
    procedure LE1Move(Sender: TObject; X, Y: Integer);
    procedure LE2Move(Sender: TObject; X, Y: Integer);
  public
    procedure AfterConstruction; override;
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

uses
  TypInfo;

const
  MaxSet = 255; // Largest ordinal value in a Delphi set.

type
  TSet = set of 0..MaxSet;

function SetToString(Info: PTypeInfo; const Value; const Separator, Prefix, Suffix: string): String; overload;
var
  CompInfo: PTypeInfo;
  CompData: PTypeData;
  SetValue: TSet absolute Value;
  Element: 0..MaxSet;
begin
  CompInfo:=GetTypeData(Info)^.CompType^;
  CompData:=GetTypeData(CompInfo);
  Result:='';
  for Element:=CompData.MinValue to CompData.MaxValue do begin
    if Element in SetValue then
      if Result = '' then
        Result := Prefix + GetEnumName(CompInfo, Element)
      else
        Result := Result + Separator + GetEnumName(CompInfo, Element);
  end;
  if Result = '' then
    Result := Prefix + Suffix
  else
    Result := Result + Suffix;
end;

function SetToString(Info: PTypeInfo; const Value; const Separator: string): String; overload;
begin
  Result:=SetToString(Info, Value, Separator, '[', ']');
end;

function SetToString(Info: PTypeInfo; const Value): String; overload;
begin
  Result:=SetToString(Info, Value, ', ');
end;

{ TLabeledEdit }

procedure TLabeledEdit.WMMove(var Message: TWMMove);
begin
  inherited;
  if Assigned(FOnMove) then
    FOnMove(Self, Message.XPos, Message.YPos);
end;

{ TForm1 }

procedure TForm1.FormCreate(Sender: TObject);
begin
  LabeledEdit1.OnMove:=LE1Move;
  LabeledEdit2.OnMove:=LE2Move;
end;

procedure TForm1.AfterConstruction;
begin
  inherited;
  Panel2.Height:=0;
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  Panel2.Height:=0;
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  Panel2.Height:=104;
end;

procedure TForm1.Button3Click(Sender: TObject);
begin
  ShowMessage('LE1 Anchors = ' + SetToString(TypeInfo(TAnchors), LabeledEdit1.Anchors));
  ShowMessage('LE2 Anchors = ' + SetToString(TypeInfo(TAnchors), LabeledEdit2.Anchors));
end;

procedure TForm1.LE1Move(Sender: TObject; X, Y: Integer);
begin
  Label1.Caption:=Format('LE1 pos: %d : %d', [X, Y]);
end;

procedure TForm1.LE2Move(Sender: TObject; X, Y: Integer);
begin
  Label2.Caption:=Format('LE2 pos: %d : %d', [X, Y]);
end;

end.

// dfm
object Form1: TForm1
  Left = 0
  Top = 0
  Caption = 'Form1'
  ClientHeight = 304
  ClientWidth = 643
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  object Label1: TLabel
    Left = 200
    Top = 56
    Width = 31
    Height = 13
    Caption = 'Label1'
  end
  object Label2: TLabel
    Left = 200
    Top = 96
    Width = 31
    Height = 13
    Caption = 'Label2'
  end
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 185
    Height = 304
    Align = alLeft
    TabOrder = 0
    ExplicitLeft = 152
    ExplicitTop = 96
    ExplicitHeight = 41
    DesignSize = (
      185
      304)
    object Panel2: TPanel
      Left = 1
      Top = 81
      Width = 183
      Height = 104
      Anchors = [akLeft, akTop, akRight, akBottom]
      Constraints.MaxHeight = 104
      TabOrder = 0
      DesignSize = (
        183
        104)
      object LabeledEdit1: TLabeledEdit
        Left = 8
        Top = 24
        Width = 121
        Height = 21
        Anchors = [akLeft, akRight, akBottom]
        EditLabel.Width = 61
        EditLabel.Height = 13
        EditLabel.Caption = 'LabeledEdit1'
        TabOrder = 0
      end
      object LabeledEdit2: TLabeledEdit
        Left = 48
        Top = 72
        Width = 121
        Height = 21
        Anchors = [akLeft, akRight, akBottom]
        EditLabel.Width = 61
        EditLabel.Height = 13
        EditLabel.Caption = 'LabeledEdit2'
        TabOrder = 1
      end
    end
  end
  object Button1: TButton
    Left = 200
    Top = 8
    Width = 75
    Height = 25
    Caption = 'Hide'
    TabOrder = 1
    OnClick = Button1Click
  end
  object Button2: TButton
    Left = 281
    Top = 8
    Width = 75
    Height = 25
    Caption = 'Show'
    TabOrder = 2
    OnClick = Button2Click
  end
  object Button3: TButton
    Left = 200
    Top = 140
    Width = 75
    Height = 25
    Caption = 'Anchors'
    TabOrder = 3
    OnClick = Button3Click
  end
end 
```

如果`Panel2.Height`在创建表单后未设置为 0，则在调整表单大小时编辑会上下移动。如果`Panel2.Height`在表单创建时设置为 0，则编辑在 中保持不可见`Panel2`，如果`Panel2`显示，则它们保持不可见，因此`Top`位置为负。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:41:06.420

锚定控件更喜欢将其锚定位置放在实际存在的位置。Delphi 无法在不完全适合的空间中安排控件。锚点可能会“卡”在错误的位置，相邻对齐的控件可能会意外地相互交换位置。

当控件所在的面板变为正尺寸时，请调整控件的位置，使它们位于您想要的位置。只要它们保持可见（即，只要面板没有折叠到零高度），它们的锚点就会继续将它们保持在正确的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:10:35.863

两种可能的解决方案：

1.  在表单的事件`Panel2`中将 ' 的高度设置为零，而不是在 中，或`OnShow``AfterConstruction`
2.  `Panel2`用放置另一个面板`Align=alBottom`。

我不知道为什么第一个解决方案*确实*`OnCreate`有效，但它肯定有优点，因为在（或`AfterConstruction`在您使用时），窗口控制句柄尚未分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T06:38:04.153

我找到了解决这个问题的方法，但它与锚无关，它更多地与`Align = alCustom`......

但是如果有人对我如何解决它感兴趣，这里有一些代码来解释它。

```
// modified form create procedure
procedure TForm1.FormCreate(Sender: TObject);
begin
  LabeledEdit1.Align:=alCustom; // go to hell with automation
  LabeledEdit1.Anchors:=[akLeft, akRight, akBottom]; // this can be ommited
  LabeledEdit2.Align:=alCustom; // go to hell with automation
  LabeledEdit2.Anchors:=[akLeft, akRight, akBottom]; // this can be ommited
  LabeledEdit1.OnMove:=LE1Move;
  LabeledEdit2.OnMove:=LE2Move;
end; 
```

我们需要`OnAlignPosition`处理`Panel2`.

```
type
  TUnProtectedWinControl = class(TWinControl);

procedure TForm1.Panel2AlignPosition(Sender: TWinControl; Control: TControl; var NewLeft, NewTop, NewWidth, NewHeight: Integer; var AlignRect: TRect; AlignInfo: TAlignInfo);
begin
  if (Sender <> Nil) and (Sender is TWinControl) then begin
    if Control.Parent <> Nil then begin
      if Control.ExplicitTop > 0 then
        NewTop:=Control.Parent.Height - (TUnProtectedWinControl(Sender).FDesignSize.Y - Control.ExplicitTop)
      else
        NewTop:=Control.Parent.Height + Control.ExplicitTop;
    end;
  end;
end; 
```

就是这样。

# iphone - xcode iOS 获取所有本地化列表

> ID：15093334
> 
> 赞同：8
> 
> 时间：2013-02-26T15:45:28.700
> 
> 标签：iphone, xcode, localization

如何获取所有可用本地化的列表？

我有一个有五个本地化的应用程序。我需要知道当前语言环境是否在该列表中，如果没有，则创建一个后备。但是如何确定当前语言环境是否在该列表中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-08T16:11:33.503

对我来说，接受的解决方案不起作用，如果不支持语言 - 应用程序只是回退到英语，并且由于英语字符串文件包含“IsSupported”字符串 - 它返回“是”。

我不得不使用这个解决方案

```
NSString* currentLanguage = [NSLocale preferredLanguages][0];
NSArray* supportedLocalizations = [[NSBundle mainBundle] localizations];

if ([supportedLocalizations containsObject:currentLanguage]) {
    isLocalizedToCurrentLanguage = YES;
}
else {
    isLocalizedToCurrentLanguage = NO;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:56:52.710

确定当前语言环境是否受支持的最简单方法是在`@"IsSupported" = @"Yes"`您支持的所有五种本地化中添加一个特殊的“测试”字符串（例如 ）。然后一个简单的检查将起作用：

```
BOOL supported = [NSLocalizedString(@"IsSupported", nil) isEqualToString:@"Yes"]; 
```

# .net - IIS AppFabric 与经典 Windows 服务

> ID：15093335
> 
> 赞同：0
> 
> 时间：2013-02-26T15:45:38.807
> 
> 标签：.net, wcf, iis, windows-services, appfabric

我们有一个企业 CMS，其中包含许多不同类型的服务，其中一些是 Windows 服务。我知道 IIS AppFabric 扩展，并且让所有服务在一个盒子中运行的想法看起来非常令人兴奋。举几个 IIS AppFabric 的优点：

*   单一主机环境
*   改进的部署
*   服务自动化（自动启动）
*   AppFabric 监控工具

我认为这些是经典 Win 服务中不可用的最通用功能。有一篇关于[这个](http://weblogs.asp.net/britchie/archive/2010/09/08/death-to-windows-services-long-live-appfabric.aspx)的好文章。同时，我意识到 IIS 是一个 Web 服务器，它的一般（如果不是唯一的话）目的是为 Web 请求和任何相关的东西提供服务。因此，即使考虑到上面提到的所有很酷的优势，我也不确定是否应该选择 IIS AppFabric 而不是经典的 Windows 服务。

问题是，我们应该为什么样的服务使用 IIS AppFabric？小伙伴们有没有像将windows服务迁移到AppFabric这样的经历？如果是，那是怎么回事？您在使用 AppFabric 托管时遇到过任何问题吗？换句话说，IIS AppFabric 有哪些选项，经典 Windows 服务有哪些选项（可能是性能、可靠性）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:22:49.963

您可能还想看看这个页面。

[http://weblogs.asp.net/britchie/archive/2010/09/08/death-to-windows-services-long-live-appfabric.aspx](http://weblogs.asp.net/britchie/archive/2010/09/08/death-to-windows-services-long-live-appfabric.aspx)

# ruby - capybara 在 for 循环中使用访问

> ID：15093336
> 
> 赞同：0
> 
> 时间：2013-02-26T15:45:44.653
> 
> 标签：ruby, loops, xpath, capybara

我有一个代码试图访问几个网页并将它们添加到收藏夹。正如我所想，一旦你使用访问，水豚无法继续执行其余命令，请检查下面的代码；

```
sub_menus = all('li a')
for i in 0..(sub_menus.length-1)
  if (sub_menus[i]['href'] == "http://intranet/Intranet/#") || (sub_menus[i]['href'] !~ /http:\/\/intranet(.*)/)
    next
  else
    visit sub_menus[i]['href']
    $links.push(sub_menus[i]['href'])
    find(:xpath , '//*[@id="AddFavorites_UC1_AddFavoriteButton"]').click
  end
  puts "hgfhf"
end
  p $links
  p $links.length 
```

当我执行此代码时，仅访问并单击一次工作，但 for 循环不会第二次运行。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T08:40:15.343

一旦你转到另一个页面元素定位器变得无效，你不能再使用它了。所以你不能`sub_menus`在另一个页面上使用。

因此你应该使用类似的东西：

```
links = all('li a').map { |el| el[:href] }
$links = []
links.each do |link|
  unless link !~ /http:\/\/intranet(.*)/
    visit link
    $links << link
  end
end 
```

# android - 如何为 setCanceledOnTouchOutside(true) 制作监听器

> ID：15093343
> 
> 赞同：0
> 
> 时间：2013-02-26T15:46:11.860
> 
> 标签：android, android-dialog, android-dialogfragment

我正在一个项目中工作，当用户选择图像时，它会打开一个带有图像的对话框。现在由于要求我必须在对话框外部触摸时关闭对话框，所以我设置了`dialog.setCanceledOnTouchOutside(true)`. 但是另一个要求是，一旦用户触摸到对话框的一侧，我就应该更改页面，所以我试图找出如何做到这一点。但我都试过了`onCancelListener`和`onDismissListener`。当我们使用它们时，它们都不会被调用`dialog.setCanceledOnTouchOutside(true)`。取消对话框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T08:41:39.433

如果您使用的是`DialogFragment`类，只需覆盖其`onCancel()`方法：

```
@Override public void onCancel(DialogInterface dialog) {
    super.onCancel(dialog);

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:56:42.480

据我了解，您无法使用 setCanceledOnTouchOutside 添加额外的处理作为替代方案，您可以使用 MotionEvent.ACTION_OUTSIDE 覆盖您的 onTouchEvent 以在他们触摸框外时执行操作，就像这样

```
public boolean onTouchEvent(MotionEvent event)  
{  

   if(event.getAction() == MotionEvent.ACTION_OUTSIDE){  
           doStuff(); 
           this.dismiss();  
   }  
   return false;  
} 
```

# matlab - 在matlab中找到两个特定时间之间的范围

> ID：15093346
> 
> 赞同：0
> 
> 时间：2013-02-26T15:46:18.507
> 
> 标签：matlab

我有一个年度数据集：

```
Jday = datenum('2009-01-01 00:00','yyyy-mm-dd HH:MM'):1/24:...
    datenum('2009-12-31 23:00','yyyy-mm-dd HH:MM');
DateV = datevec(Jday);
dat = 1+(10-1).*rand(length(Jday),10);
noise = 10*sin(2*pi*Jday/32)+20;
for i = 1:size(dat,2);
    dat2(:,i) = dat(:,i)+noise';
end 
```

它表示通过水柱记录的温度测量值。我想计算每天 06:00 到 18:00 之间的温度范围，以便最终得到每个深度的 365 个值，因此最终矩阵为 365x10。

我可以通过以下方式指定个别日期：

```
[~,~,b] = unique(DateV(:,2:3),'rows'); 
```

但我不知道如何只考虑上午 06:00 到下午 18:00 之间记录的值。任何人都可以提供一些关于这样做的最佳方法的信息吗？

修改：略长的答案

```
Jday = datenum('2009-01-01 00:00','yyyy-mm-dd HH:MM'):1/24:...
    datenum('2009-12-31 23:00','yyyy-mm-dd HH:MM');
DateV = datevec(Jday);
dat = 1+(10-1).*rand(length(Jday),10);
noise = 10*sin(2*pi*Jday/32)+20;
for i = 1:size(dat,2);
    dat2(:,i) = dat(:,i)+noise';
end

for i = 1:size(dat2,2);
    data = [DateV(:,4),dat2(:,i)]; % obtain all hours from DateV array

    dd = find(data(:,1) == 6); % find 06:00
    dd(:,2) = find(data(:,1) == 18); % find 18:00

    for ii = 1:size(dd,1);
        result(ii,i) = range(data(dd(ii,1):dd(ii,2),2)); % calculate range
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T18:11:21.983

如果[`range`](http://www.mathworks.com/help/stats/range.html)输入一个矩阵，它会独立地对每一列进行操作。我们可以使用它来准备一个矩阵，其中每列包含时间间隔 06:00 到 18:00 的值，然后应用`range`.

1.  棘手的部分是操纵您的 365x24×10 矩阵以使列正确：

    ```
    A = permute(reshape(dat2', [10, 24, 365]), [2, 1, 3]); 
    ```

    这应该会产生 3-D 24x10x365 矩阵，从中可以提取第 7 到 18 行。

2.  下一步是应用`range`并将结果转换回二维 365x10 矩阵：

    ```
    result = permute(range(A(7:18, :, :)), [3, 2, 1]); 
    ```

因此，完整的解决方案是：

```
A = permute(reshape(dat2', [10, 24, 365]), [2, 1, 3]);
result = permute(range(A(7:18, :, :)), [3, 2, 1]); 
```

**编辑**：
为了使解决方案更加通用，您可以使用`DateV`获取所需行的索引：

```
idx = DateV(1:24, 4) >= 6 & DateV(1:24, 4) < 18; 
```

然后在解决方案中使用它，如下所示：

```
A = permute(reshape(dat2', [10, 24, 365]), [2, 1, 3]);
result = permute(range(A(idx, :, :)), [3, 2, 1]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-13T11:10:01.610

1987 年 1 月 1 日至 1987 年 12 月 31 日之间的每小时日期范围：

```
start_date = datenum(1987,01,01,00,00,00)
end_date = datenum(1987,12,31,23,00,00)
interval = datenum(1987,0,0,1,0,0)-datenum(1987,0,0,0,0,0) % 1 hour interval

date_range = [start_date:interval:end_date] 
```

非常简单，也适用于闰年。

# windows - powershell 脚本和 subst 命令

> ID：15093347
> 
> 赞同：4
> 
> 时间：2013-02-26T15:46:19.517
> 
> 标签：windows, powershell

我有以下 powershell 2.0 脚本：

```
function getFreeDrive
{
    [char[]]$driveLetters = @([char]'E'..[char]'Z')
    foreach ($d in $driveLetters) {
        if(!(Test-Path -Path "$d`:" -IsValid)) {
            return $d
        }
    }
}

$drive = getFreeDrive

subst "$drive`:" T:\temp 
ls "$drive`:\"  # just a dummy command 
subst "$drive`:" /D 
```

我希望脚本

*   找到第一个未使用的驱动器号
*   使用 subst 创建一个新驱动器
*   在这个驱动器上做点什么
*   用 subst 卸下驱动器

该脚本运行良好，当我第一次运行它时。如果我在同一个 shell 中第二次运行该脚本，我会从**ls**命令中得到一个错误，提示找不到驱动器。如果我打开一个新的 shell 并运行脚本，它会再次运行良好。

我的脚本有什么问题，如何让它在同一个 powershell 实例中运行多次？

或者也许有替代**subst**命令的方法？我尝试使用 powershell 驱动器，但它不适用于其他 Windows 程序（例如 devenv.exe）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T20:21:45.643

另一种方法是使用 PSProviders 和更准确的 PSDrives （看看[get-help about_providers](http://technet.microsoft.com/en-us/library/hh847791.aspx)）：

```
PS > New-PSDrive -Name "tr" -PSProvider filesystem -Root "c:\temp"

Name           Used (GB)     Free (GB) Provider      Root
----           ---------     --------- --------      ----
tr                               28,15 FileSystem    C:\temp

PS > ls tr:*.c

    Répertoire : C:\temp

Mode                LastWriteTime     Length Name
----                -------------     ------ ----
-a---        01/08/2012     05:28        994 test.c

PS > Remove-PSDrive -Name "tr" 
```

问题是这些驱动器不能与 shell explorer.exe 一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T16:07:29.960

我遇到了完全相同的问题，我的解决方法——注意我使用的是版本 3——是`Get-PSDrive`在进入新映射的驱动器之前调用：

```
$drive = getFreeDrive

subst "$drive`:" T:\temp 
Get-PSDrive | Out-Null
ls "$drive`:\"  # just a dummy command 
subst "$drive`:" /D 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T22:09:11.803

我可以复制与您完全相同的行为，甚至在一个 Powershell 窗口中我什至无法 cd 到它创建的驱动器，但如果我打开一个全新的窗口，我可以 cd 到它就好了。

行为看起来像这里概述的那样：

[http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/2e414f3c-98dd-4d8b-a3a3-88cfa0e7594c/](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/2e414f3c-98dd-4d8b-a3a3-88cfa0e7594c/)

解决方法可能是使用上面提到的 PSDrives，或者只是不映射，然后取消映射，然后尝试在同一个会话中重新映射同一个驱动器。

# python - 我怎样才能使它动态

> ID：15093350
> 
> 赞同：0
> 
> 时间：2013-02-26T15:46:34.110
> 
> 标签：python, loops, for-loop, python-2.7, urllib2

我有我想要优化的代码，因为它开始增加音量:(。我想创建一个数组并从他那里调用值，而不是像现在这样为每个对象创建代码：

```
post_data_groups = {'profile': '46', 'clear': 'Remove+Avatar'}
post_data_documents = {'folder1': '30', 'remove': 'Delete+Documents'}

urlAdmin_groups = 'http://site.com/management.php?Category=6&uid=196'
urlModerator_groups = 'http://site.com/management.php?Category=6&uid=197'
.......... 
```

然后对于文档：

```
urlAdmin_documents = 'http://site.com/management.php?Category=3&uid=196'
urlModerator_documents = 'http://site.com/management.php?Category=3&suid=197'
.... and so on
data_groups= urllib.urlencode(post_data_groups)
data_documents= urllib.urlencode(post_data_documents) 
```

然后我这样称呼他们：

```
response = opener.open(urlAdmin_groups, data_groups)
response = opener.open(urlAdmin_documents, data_documents)
........... and so on
the_page = response.read() 
```

由于只有类别和 uid 更改，我如何在调用它们时进行循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:55:32.483

基本上这是[map](http://docs.python.org/2/library/functions.html#map)内置函数的一个很好的用例：

```
url = 'http://site.com/management.php?Category={cat}&uid={uid}'
cat_uids = [ (3,196), (3,197), ... ] # read thos from config file or...
urls = [ url%cat_uid for cat_uid in cat_uids ]
responses = map(opener.open, urls)
pages = map(response_class.read,responses) # where response_class is the class returned by open() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:49:19.923

使用字符串作为模板：

```
url = 'http://site.com/management.php?Category={cat}&uid={uid}' 
```

那么你可以使用`.format()`字符串的方法来填充槽：

```
response = opener.open(url.format(cat=3, uid=196), data))
the_page = response.read() 
```

您必须将其扩展为使用循环，在循环中迭代提供类别和 UID 的*内容*，但您明白了。也许映射会起作用：

```
groups = {
    Admin: {'cat': 3, 'uid': 196},
    ...
}

for groupname, urlvalues in groups.iteritems():
    response = opener.open(url.format(**urlvalues), data_groups)) 
```

其中`**`格式将字典应用为一组关键字参数；using`.format(**urlvalues)`本质上转换为`.format(cat=urlvalues['cat'], uid=urlvalues['uid'])`.

# dotnetopenauth - 使用 Fiddler 找出 DotNetOpenAuth 中传递的内容

> ID：15093353
> 
> 赞同：2
> 
> 时间：2013-02-26T15:46:37.743
> 
> 标签：dotnetopenauth, fiddler

我正在使用 Fiddler 来查看在 DotNetOpenAuth 中的“握手”过程中传递了什么。我正在测试 Twitter 的 API（尽管我认为这无关紧要）。我试图查看当我的应用程序对 Twitter 的 API 进行服务器到服务器调用时发送的内容。

当我在 Fiddler 中运行跟踪时，我看到有一个“通往”“api.twitter.com”的“隧道”——但是当我查看检查员时，根本不清楚正在发送什么以及正在接收什么。

我知道我得到了一些令牌，但我应该能够通过 Fiddler 看到我的 Twitter 请求和响应吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-28T21:15:03.883

*（关闭 - 使用正确的文档链接添加问题的答案）*

最好的方法是打开日志记录并使用日志来跟踪您的代码和 twitter 之间发生的事情。

[https://github.com/DotNetOpenAuth/DotNetOpenAuth/wiki/Logging-and-debugging](https://github.com/DotNetOpenAuth/DotNetOpenAuth/wiki/Logging-and-debugging)

# php - 如何 - 轻松过滤 cakephp 表

> ID：15093360
> 
> 赞同：-1
> 
> 时间：2013-02-26T15:46:48.310
> 
> 标签：php, cakephp, find, action, cakephp-2.3

我正在尝试在 cakephp 应用程序中的表格上开发一个非常简单的过滤器。我想通过 find 或其他方式过滤列。该字段填充有文本。我想我设置了一个复选框，过滤器是按条件找到的。

如何设置一个单选按钮，我可以在其中处理查找功能的条件？

马库斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:58:01.043

您是指分页索引视图上的“过滤器”吗？

您可能正在寻找类似搜索插件的东西：[https ://github.com/cakedc/search](https://github.com/cakedc/search)

它可以非常轻松地处理这类事情，无需太多配置或编码。

# image - windows phone 在转换后获取图像大小

> ID：15093365
> 
> 赞同：1
> 
> 时间：2013-02-26T15:47:01.283
> 
> 标签：image, transform, windows-phone, drag, pinchzoom

我快疯了，我整天都在搜索试图解决这个问题，我从数据库中绑定了一个图像并捏合缩放作品：

```
 <Grid x:Name="LayoutRoot">

    <ProgressBar x:Name="progressBar" Width="480" Margin="0,125,0,0" Height="10" VerticalAlignment="Top" IsIndeterminate="{Binding ShowProgressBar}" Visibility="{Binding ShowProgressBar, Converter={StaticResource BooleanToVisibilityConverter}}"></ProgressBar>

    <Image x:Name="image" CacheMode="BitmapCache" Width="480" Stretch="Uniform" VerticalAlignment="Center">
        <Image.RenderTransform>
            <CompositeTransform x:Name="transform" />
        </Image.RenderTransform>
        <toolkit:GestureService.GestureListener>
            <toolkit:GestureListener PinchStarted="OnPinchStarted" PinchDelta="OnPinchDelta" PinchCompleted="OnPinchCompleted" DragDelta="OnDragDelta" DragStarted="OnDragStarted" DragCompleted="OnDragCompleted" />
        </toolkit:GestureService.GestureListener>
    </Image>

</Grid>

    private void OnPinchStarted(object sender, PinchStartedGestureEventArgs e)
    {
        image = sender as Image;
        transform = image.RenderTransform as CompositeTransform;
        initialScale = transform.ScaleX;
    }

    private void OnPinchDelta(object sender, PinchGestureEventArgs e)
    {
        if (initialScale >= 1)
        {
            transform.ScaleX = initialScale * e.DistanceRatio;
            transform.ScaleY = initialScale * e.DistanceRatio;
        }
    }

    private void OnPinchCompleted(object sender, PinchGestureEventArgs e)
    {
        if ((transform.ScaleX < 1) || (transform.ScaleY < 1))
        {
            transform.ScaleX = 1;
            transform.ScaleY = 1;
            transform.TranslateX = 0;
            transform.TranslateY = -240;
        }
    }

    private void OnDragStarted(object sender, DragStartedGestureEventArgs e)
    {
        PANEL_DRAG_HORIZONTAL = 0;
    }

    private void OnDragDelta(object sender, DragDeltaGestureEventArgs e)
    {
        if ((transform.ScaleX <= 1) || (transform.ScaleY <= 1))
        {
            if (e.Direction == System.Windows.Controls.Orientation.Horizontal)
            {
                PANEL_DRAG_HORIZONTAL += e.HorizontalChange;
            }
        }
        else
        {
            transform.TranslateX += e.HorizontalChange;
            transform.TranslateY += e.VerticalChange;
        }
    }

    private void OnDragCompleted(object sender, DragCompletedGestureEventArgs e)
    {
        if (transform.TranslateX > 0)
            transform.TranslateX = 0;
        if (transform.TranslateY > -240)
            transform.TranslateY = -240;

        if ((transform.ScaleX <= 1) || (transform.ScaleY <= 1))
        {
            if (e.Direction == System.Windows.Controls.Orientation.Horizontal)
            {
                var abs = Math.Abs(PANEL_DRAG_HORIZONTAL);
                if (abs > 75)
                {
                    if (PANEL_DRAG_HORIZONTAL > 0) // MovePrevious;
                    { MessageBox.Show("prev"); }
                    else //MoveNext();
                    { MessageBox.Show("next"); }
                    e.Handled = true;
                }
            }
        }
    } 
```

但我无法在转换后获得正确大小的图像，因为我想避免在左侧/底部拖动后丢失它......我在这里轻松处理了顶部/左侧的这个问题

```
 private void OnDragCompleted(object sender, DragCompletedGestureEventArgs e)
    {
        if (transform.TranslateX > 0)
            transform.TranslateX = 0;
        if (transform.TranslateY > -240)
            transform.TranslateY = -240; 
```

如果有什么不清楚的地方我很抱歉，但我真的很沮丧......希望你能帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T19:07:21.710

如果您有图像的原始边界（x、y、宽度、高度），您可以自己通过变换运行这些边界并检查结果。

```
Rect newBounds = transform.TransformBounds(new Rect(imgX,imgY,imgWidth,imgHeight)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T13:33:59.050

以这种方式解决，还有代码可以在交换时导航图片

```
 // these two fields fully define the zoom state:
    private double TotalImageScale = 1d;
    private Point ImagePosition = new Point(0, 0);

    private const double MAX_IMAGE_ZOOM = 5;
    private Point _oldFinger1;
    private Point _oldFinger2;
    private double _oldScaleFactor;

    double PANEL_DRAG_HORIZONTAL = 0;

    #region Event handlers

    /// <summary>
    /// Initializes the zooming operation
    /// </summary>
    private void OnPinchStarted(object sender, PinchStartedGestureEventArgs e)
    {
        _oldFinger1 = e.GetPosition(ImgZoom, 0);
        _oldFinger2 = e.GetPosition(ImgZoom, 1);
        _oldScaleFactor = 1;
    }

    /// <summary>
    /// Computes the scaling and translation to correctly zoom around your fingers.
    /// </summary>
    private void OnPinchDelta(object sender, PinchGestureEventArgs e)
    {
        var scaleFactor = e.DistanceRatio / _oldScaleFactor;
        if (!IsScaleValid(scaleFactor))
            return;

        var currentFinger1 = e.GetPosition(ImgZoom, 0);
        var currentFinger2 = e.GetPosition(ImgZoom, 1);

        var translationDelta = GetTranslationDelta(
            currentFinger1,
            currentFinger2,
            _oldFinger1,
            _oldFinger2,
            ImagePosition,
            scaleFactor);

        _oldFinger1 = currentFinger1;
        _oldFinger2 = currentFinger2;
        _oldScaleFactor = e.DistanceRatio;

        UpdateImageScale(scaleFactor);
        UpdateImagePosition(translationDelta);
    }

    /// <summary>
    /// Resets the image scaling and position
    /// </summary>
    private void OnDoubleTap(object sender, Microsoft.Phone.Controls.GestureEventArgs e)
    {
        ResetImagePosition();
    }

    private void OnDragStarted(object sender, DragStartedGestureEventArgs e)
    {
        PANEL_DRAG_HORIZONTAL = 0;
    }

    /// <summary>
    /// Moves the image around following your finger.
    /// </summary>
    private void OnDragDelta(object sender, DragDeltaGestureEventArgs e)
    {
        if (e.Direction == System.Windows.Controls.Orientation.Horizontal)
            PANEL_DRAG_HORIZONTAL += e.HorizontalChange;

        var translationDelta = new Point(e.HorizontalChange, e.VerticalChange);

        if (IsDragValid(1, translationDelta))
            UpdateImagePosition(translationDelta);
    }

    private void OnDragCompleted(object sender, DragCompletedGestureEventArgs e)
    {
        if ((e.Direction == System.Windows.Controls.Orientation.Horizontal) && (TotalImageScale <= 1.1))
        {
            var abs = Math.Abs(PANEL_DRAG_HORIZONTAL);
            if (abs > 75)
            {
                if (PANEL_DRAG_HORIZONTAL > 0) // MovePrevious;
                {
                    if (pictureId > 0)
                    {
                        _MyProgressBar.ShowProgressBar = true;
                        pictureId--;
                        LoadPictures(AllPictures[pictureId]);
                    }
                    else
                        MessageBox.Show("first");
                }
                else //MoveNext();
                {
                    if (pictureId < count)
                    {
                        _MyProgressBar.ShowProgressBar = true;
                        pictureId++;
                        LoadPictures(AllPictures[pictureId]);
                    }
                    else
                        MessageBox.Show("last");
                }
                e.Handled = true;
            }
        }
    }

    #endregion

    #region Utils

    /// <summary>
    /// Computes the translation needed to keep the image centered between your fingers.
    /// </summary>
    private Point GetTranslationDelta(
        Point currentFinger1, Point currentFinger2,
        Point oldFinger1, Point oldFinger2,
        Point currentPosition, double scaleFactor)
    {
        var newPos1 = new Point(
         currentFinger1.X + (currentPosition.X - oldFinger1.X) * scaleFactor,
         currentFinger1.Y + (currentPosition.Y - oldFinger1.Y) * scaleFactor);

        var newPos2 = new Point(
         currentFinger2.X + (currentPosition.X - oldFinger2.X) * scaleFactor,
         currentFinger2.Y + (currentPosition.Y - oldFinger2.Y) * scaleFactor);

        var newPos = new Point(
            (newPos1.X + newPos2.X) / 2,
            (newPos1.Y + newPos2.Y) / 2);

        return new Point(
            newPos.X - currentPosition.X,
            newPos.Y - currentPosition.Y);
    }

    /// <summary>
    /// Updates the scaling factor by multiplying the delta.
    /// </summary>
    private void UpdateImageScale(double scaleFactor)
    {
        TotalImageScale *= scaleFactor;
        ApplyScale();
    }

    /// <summary>
    /// Applies the computed scale to the image control.
    /// </summary>
    private void ApplyScale()
    {
        ((CompositeTransform)ImgZoom.RenderTransform).ScaleX = TotalImageScale;
        ((CompositeTransform)ImgZoom.RenderTransform).ScaleY = TotalImageScale;
    }

    /// <summary>
    /// Updates the image position by applying the delta.
    /// Checks that the image does not leave empty space around its edges.
    /// </summary>
    private void UpdateImagePosition(Point delta)
    {
        var newPosition = new Point(ImagePosition.X + delta.X, ImagePosition.Y + delta.Y);

        if (newPosition.X > 0) newPosition.X = 0;
        if (newPosition.Y > 0) newPosition.Y = 0;

        if ((ImgZoom.ActualWidth * TotalImageScale) + newPosition.X < ImgZoom.ActualWidth)
            newPosition.X = ImgZoom.ActualWidth - (ImgZoom.ActualWidth * TotalImageScale);

        if ((ImgZoom.ActualHeight * TotalImageScale) + newPosition.Y < ImgZoom.ActualHeight)
            newPosition.Y = ImgZoom.ActualHeight - (ImgZoom.ActualHeight * TotalImageScale);

        ImagePosition = newPosition;

        ApplyPosition();
    }

    /// <summary>
    /// Applies the computed position to the image control.
    /// </summary>
    private void ApplyPosition()
    {
        ((CompositeTransform)ImgZoom.RenderTransform).TranslateX = ImagePosition.X;
        ((CompositeTransform)ImgZoom.RenderTransform).TranslateY = ImagePosition.Y;
    }

    /// <summary>
    /// Resets the zoom to its original scale and position
    /// </summary>
    private void ResetImagePosition()
    {
        TotalImageScale = 1;
        ImagePosition = new Point(0, 0);
        ApplyScale();
        ApplyPosition();
    }

    /// <summary>
    /// Checks that dragging by the given amount won't result in empty space around the image
    /// </summary>
    private bool IsDragValid(double scaleDelta, Point translateDelta)
    {
        if (ImagePosition.X + translateDelta.X > 0 || ImagePosition.Y + translateDelta.Y > 0)
            return false;

        if ((ImgZoom.ActualWidth * TotalImageScale * scaleDelta) + (ImagePosition.X + translateDelta.X) < ImgZoom.ActualWidth)
            return false;

        if ((ImgZoom.ActualHeight * TotalImageScale * scaleDelta) + (ImagePosition.Y + translateDelta.Y) < ImgZoom.ActualHeight)
            return false;

        return true;
    }

    /// <summary>
    /// Tells if the scaling is inside the desired range
    /// </summary>
    private bool IsScaleValid(double scaleDelta)
    {
        return (TotalImageScale * scaleDelta >= 1) && (TotalImageScale * scaleDelta <= MAX_IMAGE_ZOOM);
    }

    #endregion 
```

# c# - jQuery Accordion 阻止路由链接在 ListView 中工作

> ID：15093367
> 
> 赞同：0
> 
> 时间：2013-02-26T15:47:19.307
> 
> 标签：c#, jquery, asp.net, css

我有一个`ListView`用作网站上的导航菜单。我想添加一些 Jquery 效果让它看起来不错。我添加了这个脚本并且 Jquery 工作但是当我点击链接或者例如如果我点击

```
<a class="head" href="<%#: GetRouteUrl("ProductsByCategoryRoute", new {categoryName = Item.CategoryName}) %>">
                        <%#: Item.CategoryName %>
                    </a> 
```

我的子菜单下拉并变得可见，但它不执行`href`. 与显示的子链接相同。当我单击它时，它会空回发。因为此菜单会根据您单击的内容进行查询并显示结果。我应该在服务器端做这些手风琴效果吗？

为什么让这个 Jquery 阻止我的路由链接工作。

jquery脚本：

```
<script>
 var $open = $();
        $('.head').click(function (e) {
            e.preventDefault();
            $open.slideUp();
            $open = $(this).closest('li').find('.content');
            $open.not(':animated').slideToggle();
        });
    </script> 
```

标记：

```
 <asp:ListView ID="categoryList" runat="server"
    OnItemDataBound="brandList_ItemDataBound" ItemType="E_Store_Template.Models.Category" SelectMethod="GetCategories">
    <LayoutTemplate>
        <ul style="list-style-type: none;">
            <asp:PlaceHolder runat="server" ID="itemPlaceholder" />
        </ul>
    </LayoutTemplate>
    <ItemTemplate>
        <li style="text-align: left;">
            <b style="font-size: large; font-style: normal">
                <a class="head" href="<%#: GetRouteUrl("ProductsByCategoryRoute", new {categoryName = Item.CategoryName}) %>">
                    <%#: Item.CategoryName %>
                </a>
            </b>
            <asp:ListView ID="brandList" runat="server" ItemType="E_Store_Template.Models.Brand">
                <LayoutTemplate>
                    <ul style="list-style-type: none; text-align: left;">
                        <asp:PlaceHolder runat="server" ID="itemPlaceholder" />
                    </ul>
                </LayoutTemplate>
                <ItemTemplate>
                    <li>
                        <a class="content" href="<%#: GetRouteUrl("ProductsByCatBrandRoute",  new { brandName = Item.BrandName })%>">
                            <%#: Item.BrandName %>
                        </a>
                    </li>
                </ItemTemplate>
            </asp:ListView>
        </li>
    </ItemTemplate>
</asp:ListView> 
```

来源

所有产品

```
<ul style="list-style-type: none;">

<li style="text-align: left;">
    <b style="font-size: large; font-style: normal">
        <a class="head"  href="/ProductList/Rods">
            Rods
        </a>
    </b>

            <ul style="list-style-type: none; text-align: left;">

            <li>
                <a class="content" href="">
                    Brand1
                </a>
            </li>

            <li>
                <a class="content" href="">
                    Brand2
                </a>
            </li>

            </ul>

</li>

<li style="text-align: left;">
    <b style="font-size: large; font-style: normal">
        <a class="head"  href="/ProductList/Reels">
            Reels
        </a>
    </b>

            <ul style="list-style-type: none; text-align: left;">

            <li>
                <a class="content" href="">
                    Brand1
                </a>
            </li>

            <li>
                <a class="content" href="">
                    Brand2
                </a>
            </li>

            <li>
                <a class="content" href="">
                    Brand3
                </a>
            </li>

            </ul>

</li>

<li style="text-align: left;">
    <b style="font-size: large; font-style: normal">
        <a class="head"  href="/ProductList/Tackle">
            Tackle
        </a>
    </b>

            <ul style="list-style-type: none; text-align: left;">

            <li>
                <a class="content" href="">
                    Brand1
                </a>
            </li>

            <li>
                <a class="content" href="">
                    Brand2
                </a>
            </li>

            <li>
                <a class="content" href="">
                    Brand3
                </a>
            </li>

            </ul>

</li>

<li style="text-align: left;">
    <b style="font-size: large; font-style: normal">
        <a class="head"  href="/ProductList/Apparel">
            Apparel
        </a>
    </b>

            <ul style="list-style-type: none; text-align: left;">

            <li>
                <a class="content" href="">
                    Brand1
                </a>
            </li>

            </ul>

</li>

</ul>

    </section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T01:45:35.263

```
<script>
 var $open = $();
        $('.head').click(function (e) {
           // e.preventDefault();
            $open.slideUp();
            $open = $(this).closest('li').find('.content');
            $open.not(':animated').slideToggle();
        });
    </script> 
```

这解决了它！

# python - 用于单元测试的 Python 模拟过程

> ID：15093370
> 
> 赞同：8
> 
> 时间：2013-02-26T15:47:34.390
> 
> 标签：python, unit-testing, process, mocking

**背景：**
我目前正在用 Python 编写一个进程监控工具（Windows 和 Linux）并实现单元测试覆盖。进程监视器挂钩到 Windows 上的 Windows API 函数[EnumProcesses](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682629(v=vs.85).aspx)并监视 Linux 上的 /proc 目录以查找当前进程。然后将进程名称和进程 ID 写入单元测试可访问的日志中。

**问题：**
当我对监控行为进行单元测试时，我需要一个进程来启动和终止。如果有一种（跨平台？）方法来启动和终止我可以唯一命名的假系统进程（并在单元测试中跟踪它的创建），我会很高兴。

**初步想法：**

*   我可以使用[subprocess.Popen()](http://docs.python.org/2/library/subprocess.html#popen-objects)打开任何系统进程，但这会遇到一些问题。如果我用来测试的进程也由系统运行，则单元测试可能会错误地通过。此外，单元测试是从命令行运行的，我能想到的任何 Linux 进程都会挂起终端（纳米等）。
*   我可以启动一个进程并通过其进程 ID 跟踪它，但我不确定如何在不暂停终端的情况下执行此操作。

这些只是初步测试的想法和观察结果，如果有人能证明我在这些点上的任何一个错误，我会很高兴。

我正在使用 Python 2.6.6。

**编辑：**
获取所有 Linux 进程 ID：

```
try:
    processDirectories = os.listdir(self.PROCESS_DIRECTORY)
except IOError:
    return []
return [pid for pid in processDirectories if pid.isdigit()] 
```

获取所有 Windows 进程 ID：

```
import ctypes, ctypes.wintypes

Psapi = ctypes.WinDLL('Psapi.dll')
EnumProcesses = self.Psapi.EnumProcesses
EnumProcesses.restype = ctypes.wintypes.BOOL

count = 50
while True:
    # Build arguments to EnumProcesses
    processIds = (ctypes.wintypes.DWORD*count)()
    size = ctypes.sizeof(processIds)
    bytes_returned = ctypes.wintypes.DWORD()
    # Call enum processes to find all processes
    if self.EnumProcesses(ctypes.byref(processIds), size, ctypes.byref(bytes_returned)):
        if bytes_returned.value &lt size:
            return processIds
       else:
            # We weren't able to get all the processes so double our size and try again
            count *= 2
    else:
        print "EnumProcesses failed"
        sys.exit() 
```

[Windows 代码来自这里](https://stackoverflow.com/questions/6980246/how-can-i-find-a-process-by-name-and-kill-using-ctypes)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T21:36:18.327

**编辑：这个答案越来越长:)，但我原来的一些答案仍然适用，所以我把它留在:)**

您的代码与我的原始答案没有太大区别。我的一些想法仍然适用。

当您编写单元测试时，您只想测试*您的*逻辑。当您使用与操作系统交互的代码时，您通常希望模拟该部分。正如您所发现的，原因是您对这些库的输出没有太多控制权。所以更容易模拟这些调用。

在这种情况下，有两个库与系统交互：`os.listdir`和`EnumProcesses`. 由于不是你写的，我们可以很容易地伪造它们来返回我们需要的东西。在这种情况下是一个列表。

但是等等，在你的评论中你提到：

> “然而，我遇到的问题是，它实际上并没有测试我的代码是否在系统上看到新进程，而是测试代码是否正确监控列表中的新项目。”

问题是，我们*不需要*测试实际**监控系统进程**的代码，因为它是第三方代码。我们*需要*测试的是你的**代码逻辑是否处理了返回的进程**。因为那是你写的代码。我们测试列表的原因是因为这就是您的逻辑正在做的事情。`os.listir`并`EniumProcesses`返回一个 pid 列表（分别为数字字符串和整数），您的代码将作用于该列表。

我假设您的代码在一个类中（您`self`在代码中使用）。我还假设它们在自己的方法中被隔离（您正在使用`return`）。所以这将是我最初建议的，除了实际代码:) Idk 如果它们在同一个类或不同的类中，但这并不重要。

## Linux方法

现在，测试你的 Linux 进程功能并不难。您可以修补`os.listdir`以返回 pid 列表。

```
def getLinuxProcess(self):
    try:
        processDirectories = os.listdir(self.PROCESS_DIRECTORY)
    except IOError:
        return []
    return [pid for pid in processDirectories if pid.isdigit()] 
```

现在进行测试。

```
import unittest
from fudge import patched_context
import os
import LinuxProcessClass # class that contains getLinuxProcess method

def test_LinuxProcess(self):
    """Test the logic of our getLinuxProcess.

       We patch os.listdir and return our own list, because os.listdir
       returns a list. We do this so that we can control the output 
       (we test *our* logic, not a built-in library's functionality).
    """

    # Test we can parse our pdis
    fakeProcessIds = ['1', '2', '3']
    with patched_context(os, 'listdir', lamba x: fakeProcessIds):
        myClass = LinuxProcessClass()
        ....
        result = myClass.getLinuxProcess()

        expected = [1, 2, 3]
        self.assertEqual(result, expected)

    # Test we can handle IOERROR
    with patched_context(os, 'listdir', lamba x: raise IOError):
        myClass = LinuxProcessClass()
        ....
        result = myClass.getLinuxProcess()

        expected = []
        self.assertEqual(result, expected)

    # Test we only get pids
    fakeProcessIds = ['1', '2', '3', 'do', 'not', 'parse']
    ..... 
```

## 窗口方法

测试 Window 的方法有点棘手。我会做的是以下几点：

```
def prepareWindowsObjects(self):
    """Create and set up objects needed to get the windows process"
    ...
    Psapi = ctypes.WinDLL('Psapi.dll')
    EnumProcesses = self.Psapi.EnumProcesses
    EnumProcesses.restype = ctypes.wintypes.BOOL

    self.EnumProcessses = EnumProcess
    ...

def getWindowsProcess(self):

    count = 50
    while True:
       .... # Build arguments to EnumProcesses and call enun process
       if self.EnumProcesses(ctypes.byref(processIds),...
       ..
       else:
           return [] 
```

我将代码分成两种方法以使其更易于阅读（我相信您已经这样做了）。这是棘手的部分，`EnumProcesses`是使用指针，它们不容易玩。另一件事是，我不知道如何在 Python 中使用指针，所以我无法告诉你一个简单的方法来模拟它 =P

我*可以*告诉你的是根本不测试它。你的逻辑非常少。除了增加 的大小之外`count`，该函数中的其他所有内容都在创建`EnumProcesses`将使用的空间指针。也许您可以为计数大小添加一个限制，但除此之外，这种方法既短又甜。它返回 Windows 进程，仅此而已。正是我在原始评论中所要求的:)

所以别管那个方法了。不要测试它。不过，请确保根据我最初的建议，任何使用`getWindowsProcess`和获取的东西都被嘲笑了。`getLinuxProcess`

希望这更有意义:) 如果它没有让我知道，也许我们可以进行聊天或进行视频通话之类的。

**原始答案**

我不完全确定如何执行您的要求，但是每当我需要测试依赖于某些外部力量（外部库、popen 或在这种情况下为进程）的代码时，我都会模拟这些部分。

现在，我不知道您的代码是如何构造的，但也许您可以执行以下操作：

```
def getWindowsProcesses(self, ...):
   '''Call Windows API function EnumProcesses and
      return the list of processes
   '''
   # ... call EnumProcesses ...
   return listOfProcesses

def getLinuxProcesses(self, ...):
   '''Look in /proc dir and return list of processes'''
   # ... look in /proc ...
   return listOfProcessses 
```

这两种方法**只做一件事**，获取进程列表。对于 Windows，它可能只是对该​​ API 的调用，而对于 Linux，它可能只是读取 /proc 目录。仅此而已，仅此而已。处理流程的逻辑将转到其他地方。这使得这些方法非常容易模拟出来，因为它们的实现只是返回列表的 API 调用。

然后您的代码可以轻松调用它们：

```
def getProcesses(...):
   '''Get the processes running.'''
   isLinux = # ... logic for determining OS ...
   if isLinux:
      processes = getLinuxProcesses(...)
   else:
      processes = getWindowsProcesses(...)
   # ... do something with processes, write to log file, etc ... 
```

在您的测试中，您可以使用模拟库，例如[Fudge](http://farmdev.com/projects/fudge/api/fudge.html)。您模拟出这两种方法以返回您**期望**它们返回的内容。

这样，您将测试*您的*逻辑，因为您可以控制结果。

```
from fudge import patched_context
...

def test_getProcesses(self, ...):

     monitor = MonitorTool(..)

     # Patch the method that gets the processes. Whenever it gets called, return
     # our predetermined list.
     originalProcesses = [....pids...]
     with patched_context(monitor, "getLinuxProcesses", lamba x: originalProcesses):
         monitor.getProcesses()
         # ... assert logic is right ...

     # Let's "add" some new processes and test that our logic realizes new 
     # processes were added.
     newProcesses = [...]
     updatedProcesses = originalProcessses + (newProcesses) 
     with patched_context(monitor, "getLinuxProcesses", lamba x: updatedProcesses):
         monitor.getProcesses()
         # ... assert logic caught new processes ...

     # Let's "kill" our new processes and test that our logic can handle it
     with patched_context(monitor, "getLinuxProcesses", lamba x: originalProcesses):
         monitor.getProcesses()
         # ... assert logic caught processes were 'killed' ... 
```

请记住，如果您以这种方式测试代码，您将不会获得 100% 的代码覆盖率（因为您的模拟方法不会运行），但这很好。您正在测试您的代码而不是第三方的代码，这很重要。

希望这可能对您有所帮助。我知道它不能回答您的问题，但也许您可以使用它来找出测试代码的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T14:45:58.960

您最初使用 subprocess 的想法是一个很好的想法。只需创建您自己的可执行文件并将其命名为将其标识为测试的东西。也许让它做一些像睡眠一样的事情。

或者，您实际上可以使用多处理模块。我在 windows 中使用的 python 不多，但是你应该能够从你创建的 Process 对象中获取进程识别数据：

```
p = multiprocessing.Process(target=time.sleep, args=(30,))
p.start()
pid = p.getpid() 
```

# java - JConsole 通过 ssh 本地端口转发

> ID：15093376
> 
> 赞同：68
> 
> 时间：2013-02-26T15:47:44.153
> 
> 标签：java, ssh, jmx

我希望能够远程连接到暴露了 JMX 的 Java 服务，但是它被防火墙阻止了。我尝试使用 ssh 本地端口转发，但是连接失败。查看wireshark，似乎当您尝试与jconsole连接时，它希望在连接到端口9999后通过一些临时端口进行连接，这些端口被防火墙阻止。

有没有办法让 jconsole 只通过 9999 连接或使用代理？[这篇文章仍然是最好的解决方案](https://web.archive.org/web/20150202095729/https://blogs.oracle.com/jmxetc/entry/connecting_through_firewall_using_jmx)吗？或者，我错过了什么？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-10-31T12:13:33.117

由于 JConsole 支持 SOCKS，因此使用 SSH socks 隧道有更好的方法：

1.  在某个空闲端口（例如 7777）上本地创建 SSH socks 代理：

    > ssh -fN -D 7777 用户@防火墙主机

2.  通过指定 SOCKS 代理（例如 localhost:7777）和 JMX 服务器的地址（例如 localhost:2147）来运行 JConsole

    > jconsole -J-DsocksProxyHost=localhost -J-DsocksProxyPort=7777 服务：jmx:rmi:///jndi/rmi://localhost:2147/jmxrmi -J-DsocksNonProxyHosts=

如以下答案之一所述，从 JDK 8u60+ 开始，您还需要`-J-DsocksNonProxyHosts=`选择才能使其正常工作。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2015-09-06T00:11:35.277

对于几乎所有当前的 JDK 版本（7u25 或更高版本），现在可以很容易地通过 SSH 使用 JConsole 和 Visual JVM（[因为现在您可以将 JMX 绑定到单端口](https://stackoverflow.com/a/21552812/241986)）。

我使用以下 JVM 参数

```
-Dcom.sun.management.jmxremote.port=8090
-Dcom.sun.management.jmxremote.rmi.port=8090
-Djava.rmi.server.hostname=127.0.0.1
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false 
```

然后我启动 SSH 连接

```
ssh my.javaserver.domain -L 8090:127.0.0.1:8090 
```

在我可以从 JConsole 连接之后

> 远程进程：-> localhost:8090

和 Java Visual VM

> 右键单击本地 -> 添加 JMX 连接 -> localhost:8090

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2013-02-26T16:11:51.190

> 有没有办法让 jconsole 只通过 9999 连接或使用代理？[这篇文章](https://web.archive.org/web/20150202095729/https://blogs.oracle.com/jmxetc/entry/connecting_through_firewall_using_jmx)仍然是最好的解决方案吗？或者，我错过了什么？

是的，那篇文章是对的。

当您在服务器上指定 JMX 端口 ( `-Dcom.sun.management.jmxremote.port=####`) 时，实际上您*只是*指定了应用程序的注册表端口。当你连接它时，它会提供一个额外的服务器端口，jconsole 实际上会使用它来完成所有工作。要转发工作，您需要知道注册表*和*服务器端口。

在注册表和服务器端口都设置为 8000 的情况下，类似以下内容应该可以运行您的应用程序。有关[详细信息，请参见此处](http://docs.oracle.com/javase/6/docs/technotes/guides/management/agent.html)。

```
-Dcom.sun.management.jmxremote.port=8000
-Dcom.sun.management.jmxremote.rmi.port=8000
-Djava.rmi.server.hostname=127.0.0.1 
```

顺便说一句，我的[SimpleJMX 库](http://256stuff.com/sources/simplejmx/)允许您轻松设置两个端口，并且您可以将它们都设置为同一个端口。

因此，一旦您知道需要转发的两个端口，您就可以设置您的`ssh`命令。例如，如果您将注册表和服务器端口配置为 8000，您将执行以下操作：

```
ssh -L 8000:localhost:8000 remote-host 
```

这将创建一个本地端口 8000，该端口转发到远程主机上的 localhost:8000。`-L`如果需要转发多个端口，可以指定多个参数。然后你可以将你的 jconsole 连接到 localhost:8000 ，它将适当地连接到远程主机。

此外，如果您的服务器有多个接口，您可能需要将`java.rmi.server.hostname`变量设置为绑定到正确的接口。

```
-Djava.rmi.server.hostname=10.1.2.3 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-08-26T15:22:58.613

继续使用 SSH socks 方法，使用较新的 java 版本（大约 8u66），您还需要将 socksNonProxyHosts 设置为空，从而导致：

```
jconsole -J-DsocksProxyHost=localhost -J-DsocksProxyPort=7777 -J-DsocksNonProxyHosts= 
```

# ruby-on-rails - Rails 3 + Omniauth：将额外的参数传递给 api 服务器（DoorKeeper）

> ID：15093378
> 
> 赞同：1
> 
> 时间：2013-02-26T15:47:52.347
> 
> 标签：ruby-on-rails, api, oauth

我正在为我的应用程序创建一个 API。一方面是 API 服务器（和主应用程序），另一方面是客户端。服务器使用 DoorKeeper 来保护使用 OAuth 2.0 的 API（基本上将主应用程序转变为 OAuth 2.0 提供程序），并且客户端使用 OmniAuth 和我的应用程序的自定义策略。

主应用程序使用子域使用多租户；所以每个客户端都有自己的子域。还有一个`oauth`子域被路由到 DoorKeeper 接口。

当用户单击“使用我的应用程序登录”链接时，他会被重定向到 oauth 子域。如果他没有登录到主应用程序，他需要被重定向到**正确子域下**的登录页面。所以我需要将客户端的帐户名传递给服务器，以便 DoorKeeper 知道要重定向到哪个子域。

请问我怎样才能做到这一点？

我对该主题进行了研究，并发现了如何传递给将传递给回调操作的 OmniAuth 参数。服务器可以使用这些参数吗？

**编辑**：我没有使用设计！

**编辑 2**：这是一些代码。

客户端应用会话控制器创建操作（使用我的应用登录）

```
def set_client
  self.current_client = Client.find(params[:client][:name])
  redirect_to "/auth/catapult?client=#{self.current_client.account_name}"
end 
```

如您所见，我将客户端参数附加到 OmniAuth 路由，但此参数未传递给服务器应用程序（DoorKeeper），因此我不知道在服务器应用程序上重定向到何处。

门卫配置

```
resource_owner_authenticator do
  p params
  User.find_by_id(session[:user_id]) || redirect_to(log_in_path)
end 
```

在上面的重定向中，我需要将客户的帐户名称指定为子域，但我没有此信息（客户的帐户名称），因为 params 哈希不包含我传递的客户帐户名称（客户端参数）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T11:41:24.843

我发现了如何解决我的问题。我不得不深入挖掘 OmniAuth 源代码。我必须做的是覆盖`request_phase`我的自定义策略中的方法，如下所示：

```
def request_phase
  redirect client.auth_code.authorize_url({:redirect_uri => callback_url, :catapult_client => request.params["client"]}.merge(authorize_params))
end 
```

在哪里`:catapult_client`，添加您想要传递的任何额外参数，它就可以工作！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T09:57:06.893

最简单的方法是在重定向到登录页面时将 place-to-redirect-to-after-authenticating-successfully 作为查询参数传递，因此它作为 GET 请求的查询字符串的一部分存在。存储它，并在成功的身份验证后将它们重定向到那里。您根本不需要在 OAuth 过程中涉及这些数据。

当然，我假设它们也都*从*它们的子域开始。

* * *

编辑：

> 当用户单击“使用我的应用程序登录”链接时，他会被重定向到 oauth 子域。

*   *假设*用户从 开始`mysubdomain.yourapp.com`，他们单击“使用我的应用程序登录”链接。

*   该链接还包含一个带有子域的查询参数，因此`oauth.yourapp.com?redirect=mysubdomain.yourapp.com`（或只是`oauth.yourapp.com?redirect=mysubdomain`）

*   用户到达 oauth.yourapp.com。应用程序存储查询参数。用户输入他们的详细信息或被重定向到服务……</p>

*   OAuth 过程完成，用户已通过身份验证。

*   将用户重定向回`redirect`之前存储的参数。

我就是这样做的，只是没有使用 Rails，但我不明白为什么你不能在*任何*框架中使用这个过程。正如我所提到的，这取决于用户从正确的子域开始。

# android - 如何在活动中使用 InputMethodService？

> ID：15093380
> 
> 赞同：0
> 
> 时间：2013-02-26T15:47:54.787
> 
> 标签：android

我有活动课

```
public class Login extends Activity 
```

我在 Login 类中创建类

```
public  class Keyclass extends InputMethodService
    {
        void addtext()
        {
            InputConnection ic =  getCurrentInputConnection();
             ic.commitText("1", 1);
        }
    } 
```

并尝试在 onClick 事件中使用它：

```
Button but1=(Button) findViewById(R.id.button1);
         but1.setOnClickListener(new OnClickListener() 
            {
                @Override
                public void onClick(View arg0) 
                {
                    Keyclass kk= new Keyclass();
                    kk.onkey();
                }
            }); 
```

但得到错误：

> 02-26 21:28:18.903: E/AndroidRuntime(747): 致命异常: main 02-26 21:28:18.903: E/AndroidRuntime(747): java.lang.NullPointerException

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-08-19T11:55:53.523

```
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (event.getKeyCode() == KeyEvent.KEYCODE_POWER) {

        // do what you want with the power button           
        Log.i(TAG,"PowerButton got clicked!");

        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

# ruby-on-rails - 在黄瓜运行它的测试之前运行一次代码

> ID：15093381
> 
> 赞同：1
> 
> 时间：2013-02-26T15:47:56.070
> 
> 标签：ruby-on-rails, testing, cucumber, koala, before-filter

我正在为我的 rails 应用程序测试 facebook 集成。我想使用 Koala 的 API 创建一个测试用户，然后运行我的集成测试。

我写了这个方法（在特性/支持中的 koala.rb 中）：

```
def facebook_user
    test_user ||= Koala::Facebook::TestUsers.new(app_id: ENV['FACEBOOK_APP_ID'], secret: ENV['FACEBOOK_SECRET'])
@facebook_user ||= test_user.create(true, 'email')
end 
```

我希望它只运行一次。现在，每次我在测试中的任何地方调用 facebook_user 方法时，它都会再次运行代码，而不是保留之前检索到的值。

如何运行此代码一次并保留所有场景的值？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:54:58.837

使用全局变量：在支持文件夹中的任何文件上：

```
Before do
    if !$dunit
        $facebook_user = Koala::Facebook::TestUsers.new(app_id: ENV['FACEBOOK_APP_ID'], secret: ENV['FACEBOOK_SECRET']).create(true, 'email')
    $dunit = true  
end 
```

结尾

然后随意调用$facebook_user

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:23:03.603

`test_user`是一个局部变量，从不缓存。使用`||=`there 没有任何作用。

您需要将结果缓存在另一个实例变量中`@test_user ||= ...`，或者执行以下操作：

```
def facebook_user
  @facebook_user ||= begin
    test_user = Koala::Facebook::TestUsers.new(app_id: ENV['FACEBOOK_APP_ID'], secret: ENV['FACEBOOK_SECRET'])
    test_user.create(true, 'email')
  end
end 
```

# javascript - 如何将 Raphael JS 生成的输出放入我页面上的特定 div 中？

> ID：15093384
> 
> 赞同：0
> 
> 时间：2013-02-26T15:48:07.700
> 
> 标签：javascript, jquery, raphael

我是 Raphael 的新手，正在尝试将“Tiger”的结果放入 div。请参阅下面的示例：

```
<script src="js/raphael.js"></script>
<script src="js/tiger.js"></script>

    <script>
        window.onload = function () {
            Raphael("holder", "100%", "100%");
            var paper = Raphael(tiger);
            var tfm = 'S0.5,0.5,200,200';

            paper.forEach(function (obj) {
                obj.transform(tfm);
            });
            // now place the tiger into the div below...
        };
    </script>

<div id="holder"></div> 
```

我该如何做到这一点？老虎渲染得很好，但似乎是其他一切之上的一个大层，所以我在页面上的其他按钮不起作用——即使老虎图像本身不在按钮之上。我希望老虎在 div 中，并且我的其他控件不被覆盖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:12:56.903

这是一个例子：http: [//jsbin.com/ecedeg/3/edit](http://jsbin.com/ecedeg/3/edit)

```
 var paper = Raphael("holder", "300", "300");
  var tfm = 'S0.5, 0.5, 200, 200';
  paper.add(tiger);

  paper.forEach(function (obj) {
    obj.transform(tfm);
  }); 
```

# jsf-2 - 为什么 Omnifaces postInvokeAction 侦听器方法被调用两次

> ID：15093385
> 
> 赞同：1
> 
> 时间：2013-02-26T15:48:10.540
> 
> 标签：jsf-2, facelets, omnifaces

我不熟悉使用omnifaces。从我收集到的一点点来看，在处理 flashscope 中的对象时使用 postInvokeAction 比 jsf preRenderView 事件更好。但我注意到的是 listener 方法被调用了两次！我觉得 preInvokeAction 类似于前阶段侦听器，而 postInvokeAction 类似于 PhaseID.INVOKE_APPLICATION 的后阶段侦听器，因此应该只为相应的事件调用一次。这个对吗？请向我解释。

我目前在 Mojarra 2.1.17 和 Omnifaces 1.3 上运行。

感谢您期待您的回复！

**布局1.html**

```
 <h:body>
    <p style="color: blue; font-size: 12pt;">1\. This is the main content of the file.</p>
    <ui:insert name="body_contents"/>
    <p style="color: blue; font-size: 12pt;">This is the the remaining part of the document...   in layout1</p>
    </h:body> 
```

**示例页面2.html**

```
<h:body>
    <f:view>
        <f:metadata>
            <f:viewParam name="dummy_var" value="#{sampletest.val_test}"/>
            <f:event type="postInvokeAction" listener="#{sampletest.frompostinvokeaction}" />
            <f:event type="preRenderView" listener="#{sampletest.fromprerenderview}" />
        </f:metadata>
    </f:view>
    <ui:composition template='/layout1.html'>
        <ui:define name="title_on_head">
            <style type="text/css">
                .pkssd{
                    min-width: 340px; min-height: 30px; background: appworkspace; color: blue; font-size: 11pt; font-style: italic;
                }
            </style>
        </ui:define>
        <ui:define name="body_contents">
            <p class="pkssd">This is the active content...</p>
        </ui:define>
    </ui:composition>
</h:body> 
```

**SampleTest.java**

```
@ManagedBean(name="sampletest")
@ViewScoped
public class SampleTest {
private String val_test;    public void frompostinvokeaction(){
    System.out.println("frompostinvokeaction: val_test: " + val_test);    }
public void fromprerenderview(ComponentSystemEvent cse){
    System.out.println("fromprerenderview : val_test: " + val_test);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T13:59:39.373

您使用主/客户端模板的方式并不完全正确。它完全不符合规范，可能导致了未指定的行为。

正确的方法是这样的：

`/WEB-INF/layout1.html`

```
<!DOCTYPE html>
<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
>
    <f:view>
        <ui:insert name="metadata" />
        <h:head>
            ...
            <ui:insert name="title_on_head" />
            ...
        </h:head>
        <h:body>
            ...
            <ui:insert name="body_contents" />
            ...
        </h:body>
    </f:view>
</html> 
```

`/samplepage2.html`

```
<ui:composition template="/WEB-INF/layout1.html">
    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="dummy_var" value="#{sampletest.val_test}"/>
            <f:event type="postInvokeAction" listener="#{sampletest.frompostinvokeaction}" />
            <f:event type="preRenderView" listener="#{sampletest.fromprerenderview}" />
        </f:metadata>
    </ui:define>

    <ui:define name="title_on_head">
        <style type="text/css">
            .pkssd{
                min-width: 340px; min-height: 30px; background: appworkspace; color: blue; font-size: 11pt; font-style: italic;
            }
        </style>
    </ui:define>

    <ui:define name="body_contents">
        <p class="pkssd">This is the active content...</p>
    </ui:define>
</ui:composition> 
```

*（是的，这是完整的文件，外面**什么都没有**`<ui:composition>`）*

### 也可以看看：

*   [如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets/4793959#4793959)
*   [我需要将哪些 XHTML 文件放入 /WEB-INF 而哪些不需要？](https://stackoverflow.com/questions/9031811/which-xhtml-files-do-i-need-to-put-in-web-inf-and-which-not/9033567#9033567)
*   [使用 <ui:composition> 模板时，我应该在哪里声明 <f:metadata>？](https://stackoverflow.com/questions/9856847/where-is-the-best-place-for-the-fmetadata-element/9857186#9857186)

# android - 如何自定义适用于 Android 的 Facebook SDK 3.0？

> ID：15093392
> 
> 赞同：2
> 
> 时间：2013-02-26T15:48:30.663
> 
> 标签：android, facebook

最近我一直在为 Android 开发 Facebook SDK 3.0。在一切顺利进行的同时，我发现了以下问题。

*   当用户在未安装本机 Facebook 应用程序的设备上按下 facebook 登录按钮时，会出现 webview 登录活动。登录后，即使应用程序请求用户权限，登录页面也会再次出现。（根据 Facebook [http://developers.facebook.com/bugs/333926600053215](http://developers.facebook.com/bugs/333926600053215) ，这是一个已知问题）

所以，在 Facebook 解决这个问题之前，我想做的是检测用户是否在他的设备上安装了 FB 应用程序，如果没有，我想显示处理登录过程的自定义 web 视图。

由于我拥有 Facebook 库项目中的所有源代码，我想我可以自定义它，但问题是，这应该怎么做？

如果我对库项目中的这些文件之一进行更改，它会自动应用于使用该库项目的主项目吗？自定义 facebook 库项目的有效方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T08:37:29.533

我遇到了同样的问题并部分解决了它：粗略地说，我尝试使用发布权限获取登录名，如果它被拒绝，则安装了 fb 应用程序，然后我请求只读然后发布，如果没有被拒绝，那么你使用发布获得登录名权限紧随其后，您就可以开始了。

此解决方案的问题：

1) 如果安装了 fb 应用程序，则 3 次用户交互而不是 2 次。

2）如果用webview取消登录（出现第二个），虽然我认为这是可以解决的，但我没有时间尝试。

抱歉快速/简短的回复。

# html - 使用 HTML/CSS 将可变大小的数据/文本列表与相应的标签/文本对齐

> ID：15093394
> 
> 赞同：0
> 
> 时间：2013-02-26T15:48:34.433
> 
> 标签：html, css

使用 CSS 将可变大小数据与相应标签（常规标签，而不是表单标签）对齐的最佳方法是什么，以实现如下所示：

```
 Name: James Bob
Description: Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
             sed diam nonummy nibh euismod tincidunt ut laoreet dolore...
         ID: 007 
```

一个列表？嵌套div？这将是一个表格的快照，但表格总是不赞成表格数据以外的任何内容。我尝试使用浮动 div，但在中心加入它们是一场噩梦，尤其是当标签或数据长度发生变化时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:51:10.707

尝试将标签浮动到左侧，而不是使用`width`或`min-width`作为标签

```
<label>Blahblah : </label><input type="text" /><br />
<label>Blahblah : </label><input type="text" /><br />
<label>Blahblah : </label><input type="text" /><br />

label {
   float: left;
   width: 300px; /* You can change this accordingly */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:05:01.113

像这个**[jsFiddle 示例](http://jsfiddle.net/j08691/SpsAy/)**这样的布局怎么样？

HTML

```
<div class="l">Name:</div>
<div class="r">James Bob</div>
<div class="l">Description:</div>
<div class="r">Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy
    nibh euismod tincidunt ut laoreet dolore...</div>
<div class="l">ID:</div>
<div class="r">007<div> 
```

CSS

```
.l {
    clear:left;
    float:left;
    width:100px;
    text-align:right;
    padding-right:10px;
}

.r {
    overflow:auto;
} 
```

# batch-file - 使用 powercfg 复制和编辑电源设置

> ID：15093396
> 
> 赞同：1
> 
> 时间：2013-02-26T15:48:38.230
> 
> 标签：batch-file, console, powercfg

我想使用 Windows 中的 powercfg 工具复制我当前的电源方案，然后使用批处理文件更改新方案（如果我搞砸了，我可以恢复到旧方案）。

我知道这`powercfg -getactivescheme`会返回当前方案的 GUID

`powercfg -setactive [GUID]`会为当前方案设置一个 GUID，但我怎么知道要使用什么 GUID？也就是说，我怎么知道重复方案的新 GUID 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:06:31.897

在我的机器上执行`powercfg -l`返回以下内容：

```
Existing Power Schemes (* Active)
-----------------------------------
Power Scheme GUID: 381b4222-f694-41f0-9685-ff5bb260df2e  (Balanced)
Power Scheme GUID: 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c  (High performance) *
Power Scheme GUID: a1841308-3541-4fab-bc81-f71556f20b4a  (Power saver) 
```

然后当您复制当前活动方案时`powercfg -duplicatescheme 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c`，输出如下：

```
Power Scheme GUID: d0b7e1f3-c9ed-49d1-93d4-6ed688244dea  (High performance) 
```

在我看来，`tokens=4`从`powercfg -duplicatescheme`命令中捕获可以获得备份方案的 GUID。

```
@echo off
setlocal
rem get current scheme
for /f "tokens=4" %%I in ('powercfg -getactivescheme') do set current=%%I

rem create backup
for /f "tokens=4" %%I in ('powercfg -duplicatescheme %current%') do set backup=%%I

rem switch to backup
powercfg -setactive %backup%
echo Switched from %current% to %backup% 
```

# php - 在哪里可以找到关于扩展 Opencart 的好文档

> ID：15093402
> 
> 赞同：2
> 
> 时间：2013-02-26T15:48:57.103
> 
> 标签：php, opencart

我是 Opencart 的初学者。我正在研究 opencart 开源解决方案的功能和特性。我已经在我的电脑上成功安装了 opencart。现在我正在尝试编写自己的控制器，以更好地了解如何扩展 opencart。我的下一步是为 opencart 编写一个完整的扩展。有人可以指定一些关于扩展 opencart 的好的文档或教程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:51:08.283

官方文档 [http://docs.opencart.com/developer/module/](http://docs.opencart.com/developer/module/)

非官方帮助 [http://opencart.hostjars.com/blog/3](http://opencart.hostjars.com/blog/3)和[http://opencart.hostjars.com/blog/34](http://opencart.hostjars.com/blog/34)

# java - Java Integer.ParseInt 错误

> ID：15093412
> 
> 赞同：0
> 
> 时间：2013-02-26T15:49:22.050
> 
> 标签：java, arrays, string, int, parseint

初始字符串 =`61440 <CARRE> 150 381 188 419 </CARRE>`

我已将此字符串拆分为一个数组，该数组现在包含坐标

```
String[] coord = t.group(2).split(" "); 
```

结果输出是：

```
les coord est :150 381 188 419
i = 0 et sa valeur est :150
i = 1 et sa valeur est :381
i = 2 et sa valeur est :188
i = 3 et sa valeur est :419 
```

为此我做了一个 for 循环：

```
formeCoord = new int[coord.length];
formeCoord[i] = Integer.parseInt(coord[i]); 
```

现在我期望一个带有所有坐标的 int 数组的输出。但相反的输出是：

```
Voici la valeur de i =0 et sa valeur int: 0
Voici la valeur de i =1 et sa valeur int: 0
Voici la valeur de i =2 et sa valeur int: 0
Voici la valeur de i =3 et sa valeur int: 419 
```

这是for循环：

```
for (int i = 0; i<formeCoord.length; i++){
    System.out.println("Voici la valeur de i ="
        + i
        + "et sa valeur int: "
        + formeCoord[i]);
} 
```

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T15:51:57.900

似乎您每次迭代都在创建一个新数组，而不是添加到它。

大概您的代码如下所示：

```
for (int i = 0; i < coord.length; i++)
{
  formeCoord = new int[coord.length];
  formeCoord[i] = Integer.parseInt(coord[i]);
} 
```

您需要将其更改为：

```
formeCoord = new int[coord.length];
for (int i = 0; i < coord.length; i++)
  formeCoord[i] = Integer.parseInt(coord[i]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:52:27.523

如果您正在循环以下代码...

```
formeCoord = new int[coord.length];
formeCoord[i] = Integer.parseInt(coord[i]); 
```

除了上次运行之外，您每次都在重置 formCoord

# ios - 从 Keynote 内的 phonegap 应用程序打开一个主题文件

> ID：15093414
> 
> 赞同：1
> 
> 时间：2013-02-26T15:49:31.120
> 
> 标签：ios, cordova, phonegap-plugins, childbrowser, keynote

想知道是否有一种方法可以使用 phonegap 应用程序打开一个 keynote 文件，如果用户安装了它，它将在 iPad 上启动 Keynote。我已经使用 ChildBrowser 插件进行了尝试，但它只显示了主题演讲的简单预览，而不是实际的演示文稿。

如果我直接链接到 safari 网站上托管的主题演讲文件，它会起作用，因为它很快会在右上角显示“在主题演讲中打开”按钮。如果我可以让它在 childbrowser 插件中工作，这将是完美的功能。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:32:34.620

您可以编写自己的插件（[http://docs.phonegap.com/en/2.4.0/guide_plugin-development_index.md.html#Plugin%20Development%20Guide](http://docs.phonegap.com/en/2.4.0/guide_plugin-development_index.md.html#Plugin%20Development%20Guide)）并使用 UIDocumentInteractionController （[http://developer.apple.com /library/ios/documentation/uikit/reference/UIDocumentInteractionController_class/Reference/Reference.html](http://developer.apple.com/library/ios/documentation/uikit/reference/UIDocumentInteractionController_class/Reference/Reference.html)）打开文件。

# jquery - 你如何在 jQuery 1.9.1 中使用 $.parseJSON？

> ID：15093419
> 
> 赞同：1
> 
> 时间：2013-02-26T15:49:35.070
> 
> 标签：jquery, json

我正在使用这个函数来测试 JSON 对象的有效性：

```
function is_JSON( test ) {
    try { var c = $.parseJSON( test );
    } catch (e) { return false; }
    return true;
} 
```

你可以看到它在这里工作得很好，使用 jQuery 1.8.3 ...

[http://jsfiddle.net/xZYVY/](http://jsfiddle.net/xZYVY/)

...但是如果您切换到 jQuery 1.9.1，这将不起作用！

[http://jsfiddle.net/xZYVY/1/](http://jsfiddle.net/xZYVY/1/)

我错过了什么？有没有更好的方法来测试有效的 JSON？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T15:56:47.117

这部分代码：

```
var test = ['thing1','thing2','thing3']; 
```

创建一个数组而不是包含有效 JSON 表达式的字符串。*它似乎与 1.8.3 一起工作*的原因是因为当时[`parseJSON`](https://github.com/jquery/jquery/blob/1.8-stable/src/core.js#L490)看起来像这样：

```
function( data ) {
if ( !data || typeof data !== "string") {
        return null;
    }
    // ...
} 
```

如您所见，如果您将数组作为第一个参数传递，它将返回`null`; 它不会抛出异常。

然后您的函数返回`true`：

```
parseJSON: function is_JSON( test ) {
    try { var c = $.parseJSON( test );
    } catch (e) { return false; }
    // c === null
    return true;
} 
```

从 1.9 开始，[`parseJSON`](https://github.com/jquery/jquery/blob/1.8-stable/src/core.js#L490)如下所示：

```
parseJSON: function( data ) {
    // Attempt to parse using the native JSON parser first
    if ( window.JSON && window.JSON.parse ) {
        return window.JSON.parse( data );
    }

    if ( data === null ) {
        return data;
    }
    if ( data === null ) {
        return data;
    }
    // etc. 
```

如果`window.JSON.parse()`传递的参数不是有效的 JSON 表达式，则会抛出异常。

一个有效的表达式是这样的：

```
'["thing1","thing2","thing3"]' 
```

去测试：

```
> JSON.parse('["thing1","thing2","thing3"]')
["thing1", "thing2", "thing3"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:58:12.323

我认为这与您所说的相反：在 jQuery/1.8 中，它没有按您的预期工作，因为无效的 JSON 字符串会生成`$.parseJSON()`return `null`。然而，在 jQuery/1.9 中它确实会抛出异常。

根据[API 文档](http://api.jquery.com/jQuery.parseJSON/)：

> 传入格式错误的 JSON 字符串*可能会*导致抛出异常

所以你不能依赖这种行为。您还需要测试返回值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T15:51:58.347

您的“测试”变量根本不是有效的 JSON 字符串；它是一个 JavaScript 数组。

[这是一个固定版本，其中值是 JSON 字符串。](http://jsfiddle.net/KD2pq/)

```
 var test = '["thing1","thing2","thing3"]'; 
```

现在，有趣的是 1.8.3 并没有那样做，我承认。研究时间...

好的，在 1.9 之前，`$.parseJSON()`代码将快速返回`null`非字符串参数值。现在，`JSON.parse()`如果可用，它会很快地推迟到本机，并且由于这会在非字符串、非空参数上引发错误，因此您现在会得到异常。

# android - 如何在 ./build_native.sh 文件中将 -fpermissive 参数传递给编译器？

> ID：15093426
> 
> 赞同：2
> 
> 时间：2013-02-26T15:49:53.153
> 
> 标签：android, cocos2d-x

好吧，请不要杀我。

我知道这是一种不好的编码习惯，但我只是想掌握 API 的基础知识，而且只有过时的教程，所以它在这个文件中的什么位置？

```
APPNAME="samplecocos2dxandroid"
NDK_ROOT="/Users/n/Documents/android-ndk-r8d"

# options

buildexternalsfromsource=

usage(){
cat << EOF
usage: $0 [options]

Build C/C++ code for $APPNAME using Android NDK

OPTIONS:
-s  Build externals from source
-h  this help
EOF
}

while getopts "sh" OPTION; do
case "$OPTION" in
s)
buildexternalsfromsource=1
;;
h)
usage
exit 0
;;
esac
done

# paths

if [ -z "${NDK_ROOT+aaa}" ];then
echo "please define NDK_ROOT"
exit 1
fi

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
# ... use paths relative to current directory
COCOS2DX_ROOT="$DIR/../.."
APP_ROOT="$DIR/.."
APP_ANDROID_ROOT="$DIR"

echo "NDK_ROOT = $NDK_ROOT"
echo "COCOS2DX_ROOT = $COCOS2DX_ROOT"
echo "APP_ROOT = $APP_ROOT"
echo "APP_ANDROID_ROOT = $APP_ANDROID_ROOT"

# make sure assets is exist
if [ -d "$APP_ANDROID_ROOT"/assets ]; then
    rm -rf "$APP_ANDROID_ROOT"/assets
fi

mkdir "$APP_ANDROID_ROOT"/assets

# copy resources
for file in "$APP_ROOT"/Resources/*
do
if [ -d "$file" ]; then
    cp -rf "$file" "$APP_ANDROID_ROOT"/assets
fi

if [ -f "$file" ]; then
    cp "$file" "$APP_ANDROID_ROOT"/assets
fi
done

# copy icons (if they exist)
file="$APP_ANDROID_ROOT"/assets/Icon-72.png
if [ -f "$file" ]; then
    cp "$file" "$APP_ANDROID_ROOT"/res/drawable-hdpi/icon.png
fi
file="$APP_ANDROID_ROOT"/assets/Icon-48.png
if [ -f "$file" ]; then
    cp "$file" "$APP_ANDROID_ROOT"/res/drawable-mdpi/icon.png
fi
file="$APP_ANDROID_ROOT"/assets/Icon-32.png
if [ -f "$file" ]; then
    cp "$file" "$APP_ANDROID_ROOT"/res/drawable-ldpi/icon.png
fi

if [[ "$buildexternalsfromsource" ]]; then
    echo "Building external dependencies from source"
    "$NDK_ROOT"/ndk-build -C "$APP_ANDROID_ROOT" $* \
        "NDK_MODULE_PATH=${COCOS2DX_ROOT}:${COCOS2DX_ROOT}/cocos2dx/platform/third_party/android/source"
else
    echo "Using prebuilt externals"
    "$NDK_ROOT"/ndk-build -C "$APP_ANDROID_ROOT" $* \
        "NDK_MODULE_PATH=${COCOS2DX_ROOT}:${COCOS2DX_ROOT}/cocos2dx/platform/third_party/android/prebuilt"
fi 
```

测试了这个解决方案但失败了，这是应该如何完成的吗？

在 android-ndk-r8b/build/core/default-build-commands.mk 中：

```
TARGET_CC       = $(TOOLCHAIN_PREFIX)gcc
TARGET_CFLAGS   = 

TARGET_CXX      = $(TOOLCHAIN_PREFIX)g++
TARGET_CXXFLAGS = $(TARGET_CFLAGS) -fno-exceptions -fno-rtti -fpermissive

TARGET_LD       = $(TOOLCHAIN_PREFIX)ld
TARGET_LDFLAGS :=

TARGET_AR       = $(TOOLCHAIN_PREFIX)ar
TARGET_ARFLAGS := crs

TARGET_STRIP    = $(TOOLCHAIN_PREFIX)strip 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:52:40.660

-fpermissive 将作为编译器标志之一，此脚本（本身）不这样做。它只打包资产等。

它会进入这里：android-ndk-r8b/build/core/default-build-commands.mk

请记住，此更改将影响所有构建。不过，听起来这就是你想要的。

# flash - 如何通过 POST as2 发送多个变量

> ID：15093430
> 
> 赞同：0
> 
> 时间：2013-02-26T15:49:58.253
> 
> 标签：flash, post, combobox, actionscript-2

我希望这里还有老派 Flash 开发人员 呵呵

所以我有一个简单的 Flash 电影，有 2 个下拉菜单，第一个用于学校项目，第二个用于州。

**我想将程序和状态连接到如下网址：http:** [//operationmilitaryed.com/search.php ?state=AL&interest=Bachelor%27s](http://operationmilitaryed.com/search.php?state=AL&interest=Bachelor%27s)

**我的问题是我得到一个这样的 URL：**

[http://operationmilitaryed.com/search.php?changeListener=%5Bobject+Object%5D&the_path=http%3A%2F%2Foperationmilitaryed%2Ecom%2Fsearch%2Ephp&program=Criminal+Justice&us_state=&onLoad=%5Btype+Function%5D](http://operationmilitaryed.com/search.php?changeListener=%5Bobject+Object%5D&the_path=http%3A%2F%2Foperationmilitaryed%2Ecom%2Fsearch%2Ephp&program=Criminal+Justice&us_state=&onLoad=%5Btype+Function%5D)

URL 中添加了太多额外信息。

**这是我的 Flash 文件的路径**（我会链接到测试页面，但由于某种原因，下拉菜单在我的浏览器中无法正常工作，可能是不同的错误） [http://leongaban.com/_stack/flash/as2/组合框/source.zip](http://leongaban.com/_stack/flash/as2/combobox/source.zip)

* * *

**以下是我当前的 Flash AS2 代码：**

```
import com.mosesSupposes.fuse.*;
ZigoEngine.simpleSetup(Shortcuts,PennerEasing);

Stage.scaleMode = "noScale";
Stage.align = "TL";

var changeListener:Object = new Object;
var changeListener2:Object = new Object; 

var program:String = "";
var us_state:String = "";

attachMovie("comboBox", "combo1", 1);
combo1._x = 6;
combo1._y = 6;

attachMovie("comboBox", "combo3", 3);
combo3._x = 150;
combo3._y = 6;

onLoad = function()
{
combo1.initComboBox("xml/combo2.xml");
combo1.addEventListener("changed",changeListener);

combo3.initComboBox("xml/combo3.xml");
combo3.addEventListener("changed",changeListener2);

changeListener.changed = function(evtObj) 
{
    dataText1.text = evtObj.data;
    program = evtObj.data;
    trace("evtObj.data = "+evtObj.data);
}

changeListener2.changed = function(evtObj) 
{
    dataText2.text = evtObj.data;
    us_state = evtObj.data;
    trace("evtObj.data = "+evtObj.data);
}
}

btn_submit.onRelease = function() {
    var A = program;
    var B = us_state;
    getURL("http://operationmilitaryed.com/search.php", "_blank", "POST");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:02:06.097

我可能是错的，但似乎您为顶部路径、程序、状态和更改侦听器定义的四个变量导致了大部分额外的发布信息？似乎您使用这些变量的方式可以在它们使用的函数中定义，我相信这会消除问题。让我知道

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:54:35.703

如果您需要将数据发送到脚本：

```
myVars = new LoadVars();
myVars.interest = program;
myVars.state = us_state;
myVars.send("http://operationmilitaryed.com/search.php", "POST"); 
```

您也可以使用 .send、.load、.sendAndLoad

参考：[http ://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00001161.html](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00001161.html)

如果您只想在最后使用 php 打开 URL，请使用连接：

```
myUrl = "http://operationmilitaryed.com/search.php?interest=" + program + "&state=" + us_state;
getURL(myUrl, "_blank"); 
```

你也可以做那个疯狂的事情：

```
this.createEmptyMovieClip("dataMC", this.getNextHighestDepth());
dataMC.interest = program;
dataMC.state = us_state;
dataMC.getURL("http://operationmilitaryed.com/search.php", "_blank", "POST"); 
```

# ios - UIImageView 图像旋转

> ID：15093431
> 
> 赞同：0
> 
> 时间：2013-02-26T15:49:59.287
> 
> 标签：ios, uiimageview

我有以下代码

```
UIImageView *r = [[UIImageView alloc] initWithFrame:CGRectMake(10, 80, 300, 300)];
r.image = [UIImage imageNamed:@"testbg"];

[UIImageView beginAnimations:nil context:NULL];
[UIImageView setAnimationDuration:0.1];
r.transform = CGAffineTransformMakeRotation(deg(30));
[UIImageView commitAnimations];

r.image = [UIImage imageNamed:@"rotbg"]; 
```

o 旋转后，我想更改视图中的图像，但它会被旋转，如何在不旋转的情况下绘制图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:15:11.613

不确定我是否正确理解了您的问题，但我认为您可以执行以下操作：

```
UIImageView *r = [[UIImageView alloc] initWithFrame:CGRectMake(10, 80, 300, 300)];
r.image = [UIImage imageNamed:@"testbg"];

[UIView animateWithDuration:0.1
                 animations:^(){
                     r.transform = CGAffineTransformMakeRotation(deg(30));
}
                 completion:^(BOOL finished){
                     r.transform = CGAffineTransformMakeRotation(0);
                     r.image = [UIImage imageNamed:@"rotbg"];
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:19:21.363

好吧，我想这就是你想要的......

```
UIImageView *r = [[UIImageView alloc] initWithFrame:CGRectMake(10, 80, 300, 300)];
r.image = [UIImage imageNamed:@"testbg"];

[UIView animateWithDuration:0.1
 delay:0.0 options:UIViewAnimationOptionCurveEaseIn
 animations:^{
     r.transform = CGAffineTransformMakeRotation(deg(30));
 }

 completion:^(BOOL finished){
           if(finished){
             r.transform = CGAffineTransformMakeRotation(0);
             r.image = [UIImage imageNamed:@"rotbg"];
           }

}]; 
```

# ios - 在 mergeChangesFromContextDidSaveNotification 中同步上下文时核心数据崩溃 (EXC_BAD_ACCESS)

> ID：15093436
> 
> 赞同：2
> 
> 时间：2013-02-26T15:50:17.337
> 
> 标签：ios, core-data, exc-bad-access, nsmanagedobjectcontext, magicalrecord

我正在编写一个很大程度上基于 CoreData 的 iPad 烹饪应用程序。在我的应用程序中，我有一个用于编辑配方的屏幕，其中包含 2 种类型的信息：

1.  带有配方类别\子类别和国家/地区的列表
2.  所有其他配方相关信息

这个列表中的每一个都可以在弹出框中进行编辑。此列表的更改应立即保留（即，如果用户将某些配方类别添加到可能的类别列表中，但取消了配方创建，则该类别应可用于所有配方）。决定实现**2 个单独的 NSManagedObjectContexts**来处理每种类型的信息：配方管理的**主要上下文和列表的****支持上下文**。

**通过MagicalRecord**框架执行的所有核心数据操作。两个上下文都将 MagicalRecord 的默认上下文作为父上下文。每个上下文都会观察另一个上下文的变化。所有上下文都在**主线程**上创建和使用，所以这个问题似乎与多线程问题无关。

当我尝试在支持上下文中创建对象并在对象创建后立即在支持上下文中保持更改时，一切正常。当新创建的对象在创建后立即被删除时出现问题 - 收到 EXC_BAD_ACCES。但是，该实体正在正确持久化，并且在下次启动时可以使用和删除它而不会出现同步问题。

1 注意：当通过 existingObjectWithID: NSManagedObjectContext 的方法从**主上下文**访问对象时，可以删除该对象。然而，崩溃发生在主上下文（主上下文和支持上下文的父上下文）保存时。

这是我的代码：

实体创建：

```
RecipeCategory* category = [RecipeCategory MR_createInContext:_supportingContext];
category.name = itemName;
[_supportingContext MR_saveToPersistentStoreAndWait]; 
```

实体删除：

```
[(RecipeCategory*)itemToRemove MR_deleteEntity];
[_supportingContext MR_saveToPersistentStoreAndWait]; 
```

上下文创建和观察设置：

```
[_mainContext MR_stopObservingContext:_supportingContext];
[_supportingContext MR_stopObservingContext:_mainContext];
_mainContext = [NSManagedObjectContext MR_contextWithParent:[NSManagedObjectContext MR_defaultContext]];
_supportingContext = [NSManagedObjectContext MR_contextWithParent:[NSManagedObjectContext MR_defaultContext]];
[_mainContext MR_observeContextOnMainThread:_supportingContext];
[_supportingContext MR_observeContextOnMainThread:_mainContext]; 
```

请告知可能导致此问题的原因，因为现在我很困惑，即使我应该以哪种方式解决这个问题。Core Data 文档中的变更管理部分没有给出任何内容。同样的结果给了谷歌。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:48:46.393

不要那样做。一个上下文在观察另一个也在观察观察者......这很糟糕。您首先需要了解嵌套上下文的规则以及数据在保存时如何从一个上下文流向另一个。

在你的情况下，你可能想在 NSMOC 上查找 MR_confinementContext 方法。这将创建一个使用旧线程限制模型的上下文。这可以帮助您避免线程崩溃。但首先，不要进行循环观察……数据流入

# java - 将密钥库密码从无密码更改为非空密码

> ID：15093440
> 
> 赞同：48
> 
> 时间：2013-02-26T15:50:34.630
> 
> 标签：java, ssl, openssl, keytool

我有一个没有密码的 jks 密钥库。当我运行命令时

```
keytool -list -keystore mykeystore.jks 
```

它提示我输入密钥库密码，我只需点击“输入”即可。

请注意，密钥库密码不是“changeit”的默认 java 密码。它是空白的

当我尝试跑步时

```
keytool -storepasswd -keystore mykeystore.jks 
```

将密码更改为非空白字符串。它首先提示我输入当前密码。只需点击输入，因为它是空白的说

```
keytool -storepasswd -keystore mykeystore.jks
Enter keystore password:
Keystore password is too short - must be at least 6 characters 
```

只是为了与大家确认密码不是“changeit”

```
keytool -storepasswd -keystore mykeystore.jks
Enter keystore password:  changeit
keytool error: java.io.IOException: Keystore was tampered with, or password was incorrect 
```

如果现有密码为空，我知道如何更改密钥库密码吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2015-09-03T08:54:50.943

如果您尝试使用 Java 默认系统密钥库 ( `cacerts`) 进行操作，则默认密码为`changeit`.

您可以在不需要密码的情况下列出密钥（即使它会提示您），因此不要认为它是空白的。

（顺便说一句，Java 历史上谁曾更改过默认密钥库密码？他们应该把它留空。）

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-02-26T16:14:06.263

将 -storepass 添加到 keytool 参数。

```
keytool -storepasswd -storepass '' -keystore mykeystore.jks 
```

但也要注意 -list 命令并不总是需要密码。我可以在两种情况下执行以下命令：没有密码或有有效密码

```
$JAVA_HOME/bin/keytool -list -keystore $JAVA_HOME/jre/lib/security/cacerts 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-29T16:51:19.477

在我的系统上，密码是“changeit”。如果我按回车键，则在空白处，它会抱怨密码短。希望这可以帮助

[![在此处输入图像描述](../Images/768dd43d9124acfe99ef5bd7afa38374.png)](https://i.stack.imgur.com/a77kq.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-10T17:37:24.817

这种方式对我来说效果更好：

```
echo y | keytool -storepasswd -storepass 123456 -keystore /tmp/IT-Root-CA.keystore -import -alias IT-Root-CA -file /etc/pki/ca-trust/source/anchors/IT-Root-CA.crt 
```

机器运行：

```
[root@rhel80-68]# cat /etc/redhat-release 
Red Hat Enterprise Linux release 8.1 (Ootpa) 
```

# vba - 循环遍历子目录并将路径存储在数组中

> ID：15093443
> 
> 赞同：0
> 
> 时间：2013-02-26T15:50:44.790
> 
> 标签：vba, excel

我有以下代码：

```
Function GetSubDir(ByVal sDir)

Dim oFS As New FileSystemObject
Dim oDir

Set oDir = oFS.GetFolder(sDir)
For Each oSub In oDir.SubFolders
    MsgBox oSub.Path
    GetSubDir oSub.Path
Next oSub
End Function 
```

我想修改它，以便将每个子目录路径存储到一个数组中，但是我不知道如何实现它，或者是否有可能。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:58:59.547

试试这个，在您的代码中创建一个基本数组，并为每个子目录使其更大，如下所示...

```
dim myArray()
dim iCount as integer

iCount=1

Set oDir = oFS.GetFolder(sDir)

' in your loop through the sub-directories...
For Each oSub In oDir.SubFolders
    Redim Preserve myArray(iCount)
    myArray(iCount) = oSub.path
    iCount=iCount+1
Next 
```

hth

菲利普

PS。我也推荐其他人推荐的文章...

如果您可以自己钓到鱼而不是向您扔鱼，那总是会更好:)

# python - ImportError：没有名为 argparse 的模块

> ID：15093444
> 
> 赞同：26
> 
> 时间：2013-02-26T15:50:46.507
> 
> 标签：python, pip, installation, argparse, python-install

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-12-26T15:42:17.757

尝试安装`argparse`：

```
easy_install argparse 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-04-27T23:27:40.903

在 CentOS 上，我用`yum install python-argparse`. HT 到 LVA 以获得正确的包名称。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-03T15:45:51.807

在 Debian 系统上，您可以使用以下命令安装 argparse 包：

```
sudo apt-get install python-argparse 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-12-26T23:50:52.327

您的脚本可能与您在命令行中执行的 Python**版本不同。**确保脚本正在使用此解释器：`/usr/lib/python2.7`. `argparse`正如您在第一篇文章中的导入所证明的那样，此安装是肯定的。

*为什么您的脚本可以使用不同的 Python 安装？*它可能是脚本第一行的 Shebang 行的结果，该行可能指向未安装该`argparse`模块的不同 Python 解释器。

编辑：另一个问题可能是您的脚本清理了`sys.path`列表，这将非常糟糕，因为每个预安装的模块都无法访问......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-03T04:47:58.663

您没有将模块安装到正确版本的 python。有两种方法之一可以解决此问题

1.  重新安装python和模块
2.  更改 python 路径在这些链接之一（[osx](https://stackoverflow.com/questions/5846167/how-to-change-default-python-version)， [windows](https://stackoverflow.com/questions/4664646/how-to-change-default-python-version-on-windows-xp)（你不应该在我选择 xp 的 windows 上执行此操作，因为这是我运行的），[linux](https://stackoverflow.com/questions/2393054/setting-up-linux-to-use-a-certain-version-of-python-for-compile)

其中之一应该可以工作，但如果它不尝试重新启动。祝你好运！！:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-03T04:52:13.430

如果您的源文件与 argparse 同名，并且您将其与脚本一起放在当前目录中，您可能会遇到问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-29T09:15:11.307

运行这个命令：`yum install -y python-argparse`. 当你是 CentOS 时它可以修复它。

# php - Box.net API V2 PHP curl 401 未授权响应

> ID：15093445
> 
> 赞同：1
> 
> 时间：2013-02-26T15:50:49.813
> 
> 标签：php, curl, box-api

我目前正在将 Box.net 集成到一个网站中，并且在身份验证后尝试访问操作时遇到了问题。

我正在验证并检索我的令牌，但是无论令牌处于活动状态，我收到的每个响应都是未经授权的 401。

我的测试代码：

```
$header = array('Authorization: BoxAuth api_key='.$apikey.'&auth_token='.$auth);

$curl = curl_init();

curl_setopt( $curl, CURLOPT_URL, 'https://api.box.com/2.0/folders/0');
curl_setopt( $curl, CURLOPT_HTTPHEADER, $header);
curl_setopt( $curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt( $curl, CURLOPT_HTTP_VERSION, "CURL_HTTP_VERSION_1_1");
curl_setopt( $curl, CURLOPT_VERBOSE, true );
//curl_setopt( $curl, CURLINFO_HEADER, true);
curl_setopt( $curl, CURLINFO_HEADER_OUT, true);
curl_setopt( $curl, CURLOPT_SSL_VERIFYPEER, false);
//curl_setopt( $curl, CURLOPT_SSL_VERIFYHOST, 2);

$res = curl_exec( $curl );

if ($res === false)
{
    print_r('Curl error: ' . curl_error($curl));
}

var_dump( curl_getinfo($curl) );
curl_close($curl);

var_dump($res); 
```

请求转储：

```
array(22) {
  ["url"]=>
  string(33) "https://api.box.com/2.0/folders/0"
  ["content_type"]=>
  string(16) "application/json"
  ["http_code"]=>
  int(401)
  ["header_size"]=>
  int(203)
  ["request_size"]=>
  int(172)
  ["filetime"]=>
  int(-1)
  ["ssl_verify_result"]=>
  int(0)
  ["redirect_count"]=>
  int(0)
  ["total_time"]=>
  float(0.783732)
  ["namelookup_time"]=>
  float(0.005711)
  ["connect_time"]=>
  float(0.15543)
  ["pretransfer_time"]=>
  float(0.479779)
  ["size_upload"]=>
  float(0)
  ["size_download"]=>
  float(171)
  ["speed_download"]=>
  float(218)
  ["speed_upload"]=>
  float(0)
  ["download_content_length"]=>
  float(171)
  ["upload_content_length"]=>
  float(0)
  ["starttransfer_time"]=>
  float(0.783576)
  ["redirect_time"]=>
  float(0)
  ["certinfo"]=>
  array(0) {
  }
  ["request_header"]=>
  string(172) "GET /2.0/folders/0 HTTP/1.1
Host: api.box.com
Accept: */*
Authorization: BoxAuth api_key=xxxxxxxxxxxxxx&auth_token=xxxxxxxxxxxxxxx

"
} 
```

回复：

```
string(171) "{"type":"error","status":401,"code":"unauthorized","help_url":"http:\/\/developers.box.com\/docs\/#errors","message":"Unauthorized","request_id":"xxxxxxxxxxxxxx"}" 
```

作为参考，我已经通过 Sean Rose 编写的 Box_Rest_Client 尝试了 v1 api（只是看看我是否有任何乐趣），并且对于基本操作来说效果很好。

任何帮助/指针将不胜感激。

谢谢

弗兰基

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:24:28.850

Frankie，`BoxAuth`授权机制为 V2 API 提供了与 V1 令牌的向后兼容性。

`Authorization: BoxAuth api_key=API_KEY&auth_token=V1_TOKEN`

`Authorization: Bearer V2_TOKEN`

`BoxAuth`尝试在 V2 API 请求中使用带有标头的 V1 颁发的令牌，它应该可以工作。

# macos - GLFW 打开 OpenGL 3.2 上下文但 Freeglut 不能 - 为什么？

> ID：15093447
> 
> 赞同：8
> 
> 时间：2013-02-26T15:50:59.283
> 
> 标签：macos, opengl, glut, freeglut, glfw

我在 Mac 上工作，我已经编译并安装了 FreeGlut，但我似乎无法获得 OpenGL 3.2 上下文。但是，我可以在使用 GLFW 时毫无问题地获得它。所以在 GLFW 中，这段代码工作得很好：

```
 glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
    glfwOpenWindow(500, 500, 8, 8, 8, 8, 24, 8, GLFW_WINDOW) 
```

但是使用 FreeGlut，此代码失败（上`glutCreateWindow`）：

```
glutInitContextVersion (3, 2);
glutInitContextProfile(GLUT_CORE_PROFILE);  
glutInitWindowSize (width, height); 
glutInitWindowPosition (300, 200);
int window = glutCreateWindow (argv[0]); 
```

它失败的错误是：

```
X Error of failed request:  BadRequest (invalid request code or no such operation)
  Major opcode of failed request:  34 (X_UngrabKey)
  Serial number of failed request:  29
  Current serial number in output stream:  29 
```

我在 MacOS X 10.8 Mountain Lion 上运行，使用 Intel HD4000 显卡，安装了 XQuartz 作为我的 X11 服务器，并从源代码编译和安装了 FreeGlut 2.8。

有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T19:11:18.247

在 10.8 和 10.7 中，如果您在设置 GL 上下文时显式调用它，则可以使用 GL 3.2。Apple 将此称为“核心配置文件”，以区别于 GL 2.1 的“传统配置文件”。

我在 OSX 上遇到了 Wine 的这个问题，它不支持 OpenGL 3.2。我的理解是 X11 服务器（Apple X11 或 XQuartz）目前没有实现 3.2 支持，也没有切换到某个地方来启用它的开关。这可能是出于兼容性问题，因为 3.2 配置文件会破坏一些[现有的 GL 应用程序](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/OpenGL-MacProgGuide/UpdatinganApplicationtoSupportOpenGL3/UpdatinganApplicationtoSupportOpenGL3.html#//apple_ref/doc/uid/TP40001987-CH3-SW1)

[这篇文章建议](https://stackoverflow.com/questions/11259328/glut-on-os-x-with-opengl-3-2-core-profile)使用 GLFW（或者如果还有这样的东西，可能是 Apple 的 GLUT.framework）

[本页](http://www.geeks3d.com/20121109/overview-of-opengl-support-on-os-x/)解释了 OSX 上的 GL 堆栈，并确认了 GLX 的 2.1 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-23T23:16:22.493

Freeglut 是 SGI GLUT Toolkit 的扩展实现，并且（除了一些过时的硬件例外）实现了相同的功能。

不幸的是，这包括许多会破坏严格的 CORE/FORWARD 兼容实现的功能。

通常，如果您请求上下文而不指定版本或配置文件，您将获得驱动程序和 GL 工具包的组合所能提供的最佳效果，这通常是兼容性配置文件，而不是核心配置文件。

请注意，使用兼容性配置文件唯一会丢失的是对已弃用功能的假定检查。所有新的核心功能都应该毫无问题地工作。

freeglut 的这个问题不仅限于苹果公司，它也在使用一些镓驱动程序的 Linux 下表现出来。目前尚不清楚是否有任何短期意图来纠正此问题，因此如果您需要使用 CORE/FORWARD COMPATIBLE，您可能应该切换到 GLFW 或 SDL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-14T15:01:08.663

您需要包含标志。通常在版本下。它应该看起来像这样：

```
glutInitContextFlag(GLUT_FOWARD_COMPATIBLE); 
```

# c# - asp.net 中的身份验证

> ID：15093463
> 
> 赞同：2
> 
> 时间：2013-02-26T15:51:33.250
> 
> 标签：c#, asp.net

asp.net 的新手，目前使用 Session 进行登录/注销

在登录页面上，我创建了一个新会话

```
 Session["login"]= anyvalue 
```

在安全页面上

```
 if(session["login"]!=null)
 {
   dostuff();
 }
 else
 Response.Redirect("login.aspx"); 
```

这是在 asp.net 中进行身份验证的好方法吗？我应该做些不同的事情吗？

**编辑：为什么投反对票？？？** 好吧，伙计们明白了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:55:46.030

您应该使用 ASP.NET 成员资格框架。请参见[此处](http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.100%29.aspx)和[此处](http://www.asp.net/web-forms)（第 7 节安全性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:55:36.413

这种方法应该可以正常工作，高级开发人员也建议我编写自己的逻辑来授权访问，而不是使用内置的安全机制（包括登录控制）

您可能还想在会话中添加角色

为了应用更高的安全性，您可以将会话存储在 SQL Server 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T15:57:58.627

因此，执行此操作的基本“Asp.Net”方式是使用内置的 MembershipProvider。

[http://msdn.microsoft.com/en-us/library/sx3h274z(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/sx3h274z(v=vs.100).aspx)

有一个“烘焙”的 MembershipProvider，称为：SqlMembershipProvider

或者

如果您已经有一个包含用户名和密码的数据存储，您将实现一个“自定义成员资格提供程序”。

* * *

多分享一点信息，你可以获得更多帮助。

1.  您将在哪里保存您的用户名和密码？
2.  如果你还没有这个，那么请说出来。
3.  这是一个学习练习，你正在为你的孩子足球俱乐部写一个网页，或者你是一个专业的网站（不一定是 asp.net）开发人员？

# ruby - AWS 开发工具包 Ruby DynamoDB session_token 无效

> ID：15093466
> 
> 赞同：0
> 
> 时间：2013-02-26T15:51:35.350
> 
> 标签：ruby, session, amazon-web-services, amazon-dynamodb

我得到：请求中包含的安全令牌无效

我在哪里获得会话令牌？当前的文档令人困惑。一方面它说：

*如果您使用具有长期凭证的 AWS::DynamoDB 发出请求，则会向 Amazon STS 发出临时会话凭证请求。这些将被缓存在进程中并重新使用。*

接下来它说：

*Amazon DynamoDB 要求所有请求都使用短期凭证（例如，需要会话令牌）。*

那么如果我不提供 session_token 到底来自哪里？如果调用提供了它，为什么它会无效？

```
requires 'aws-sdk'

cred = {:access_key_id => 'xxxx', 
:secret_access_key => 'yyyy'}

#:session_token => ''}

ddb = AWS::DynamoDB.new(cred)
items = {...}
ddb.batch_write do |batch|
  batch.put('my_mappings', items)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T04:39:55.053

经过一些试验和错误，我发现以下工作。

```
cred = {:access_key_id => 'xxxx', 
:secret_access_key => 'yyyy', :session_token => nil}

ddb = AWS::DynamoDB.new(cred) 
```

在我最初的示例中，ddb 句柄适用于某些操作，但不适用于 batch_write。通过'nil'作品。文档不清楚，API在当前版本中不一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:51:58.250

文档不正确/旧（已在 GitHub 的主分支上更改）。您不再需要会话凭证来使用 DynamoDB。您应该能够只配置您的`:access_key_id`和`:secret_access_key`.

如果您确实需要会话凭据，可以从`AWS::STS`.

# actionscript-3 - AS2 到 AS3 中的评分测验

> ID：15093468
> 
> 赞同：-3
> 
> 时间：2013-02-26T15:51:39.267
> 
> 标签：actionscript-3, actionscript-2, scoring

我在 as3 中进行测验时遇到问题，这是 AS2 中用于评分的代码，我想知道 AS3 中的代码如何，谁能帮助我，非常感谢.. :)

```
{
  salah += 1;
  if (jumlah_frame>=0) {
    jumlah_frame--;
    gotoAndStop(array_frame[jumlah_frame]);
  }
  if (jumlah_frame<0) {
    gotoAndStop(12);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:42:48.790

那是AS3的翻译。

我的猜测是你甚至没有尝试在 AS3 中编译它。周围可能还有其他代码位会破坏整个文件或某些东西，并且由周围代码建立的更大上下文甚至可能会破坏这些行；但是这些行，在不知道如何声明变量或定义函数的情况下，是完全有效的语法。

当您尝试将某些内容从一种语言移植到另一种语言时，您确实需要付出更多努力才能自己完成。如果您不知道要移植到的语言，那么这是一个非常好的学习时间，并且尝试翻译代码将是帮助您学习新语言的非常好的编程练习。但是你真的不想在这样的论坛上要求人们将代码从一种语言翻译成另一种语言，除非你付出了一些真正的努力并且遇到了比这些行中的任何事情都复杂得多的技术问题代码。

我并不是要刻薄，但您确实需要总体上了解这类事情，而不仅仅是关于移植和翻译的问题。

# java - 文件解析 XML 过早结束

> ID：15093472
> 
> 赞同：1
> 
> 时间：2013-02-26T15:51:48.140
> 
> 标签：java, xml, saxparser

我使用这种方法来验证存储一些配置信息的 xml 文件：

```
public static boolean isXmlFileWellFormed(File xmlFile) {
    logger.log(Level.INFO, "isXmlFileWellFormed({0})", xmlFile);
    DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder;
    try {
        builder = builderFactory.newDocumentBuilder();
        builder.parse(xmlFile);
        return true; // document well formed
    } catch (Throwable ex) {
        logger.log(Level.WARNING, "Xml file is not well-formed: {0}", ex);
        try {
            FileUtils.streamToFile(new FileInputStream(xmlFile), "c:\\backup.xml");
        } catch (IOException ex1) {
            logger.log(Level.WARNING, "backup not created");
        }
    }
    return false;
} 
```

它很好地验证了 xml 文件，它看起来像

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<mountedFolders>

<folder path="C:\tmp\prezentacka\" recursively="false">
        <document key="1636_0001_pdf_1.png;539777;1338204039646">
            <state>NEW</state>
        </document>
    <document key="faktura.pdf;1102305;1336552599405">
            <state>NEW</state>
        </document>
    <document key="prva strana_1361268270589.JPEG;276888;1361269977428">
            <state>NEW</state>
        </document>
    </folder>
<folder path="C:\tmp\one2\" recursively="false">
        <document key="1636_0001.pdf;280700;1336569165030">
            <state>NEW</state>
        </document>
    <document key="1636_0001_pdf_1.png;539777;1338204039646">
            <state>NEW</state>
        </document>
    <document key="1636_0001_pdf_2.png;565609;1338204041562">
            <state>NEW</state>
        </document>
    <document key="1637_0001.pdf;121031;1336569168739">
            <state>NEW</state>
        </document>
    <document key="faktura.pdf;1102305;1336552599405">
            <state>NEW</state>
        </document>
    </folder>
<folder path="C:\tmp\" recursively="false">
        <document key="faktura1.pdf;637590;1340007249059">
            <state>NEW</state>
        </document>
    <document key="LicZmluva.pdf;41164;1340016186796">
            <state>NEW</state>
        </document>
    </folder>
</mountedFolders> 
```

也许它的格式不完全，但它应该是有效的。实际上，这个xml是在catch代码块中解析方法崩溃并出错后保存的backup.xml

```
[INFO] stderr.run: [Fatal Error] .mounted:1:1: Premature end of file.
[WARNING] XmlUtils.isXmlFileWellFormed: Xml file is not well-formed: 
```

它可以以某种方式与线程有关吗？谢谢大家

**更新** 我为文档生成器创建了错误处理程序，但它又说

> 致命错误：文件过早结束

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T08:21:17.440

我的错，对文件的访问没有[同步](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)，这看起来像是异常的原因。谢谢大家的帮助

# linux-kernel - 如何使用 VMK API (native) 2.2.0 获取 PCI 设备？

> ID：15093476
> 
> 赞同：0
> 
> 时间：2013-02-26T15:51:55.633
> 
> 标签：linux-kernel, vmware, pci, esxi

试图访问所有 PCI 设备的列表。

在 VMK API（本机）中寻找替代功能：

```
//VMK Linux API
struct pci_dev * pci_get_device_all(unsigned int vendor, unsigned int device, struct pci_dev *from)
{
   return pci_get_subsys_all(vendor, device, PCI_ANY_ID, PCI_ANY_ID, from);
} 
```

谢谢，

亚历克斯

# jquery - 谷歌地图，基于缩放比例圈

> ID：15093484
> 
> 赞同：1
> 
> 时间：2013-02-26T15:52:14.163
> 
> 标签：jquery, google-maps, zooming

我有一个显示圆圈的谷歌地图，使用的半径使用数据集的索引（1、2、3、4..）按比例缩小：

```
 var radiusTest = 1 - (mapDataTrending[i].index) * .1;

 var populationOptions = {
  strokeColor: "#fdb913",
  strokeOpacity: 0.35,
  strokeWeight: 1,
  fillColor: "#fdb913",
  fillOpacity: 0.35,
  map: map,
  center: new google.maps.LatLng(mapDataTrending[i].lat, mapDataTrending[i].lng),
  radius: radiusTest * 800
};

cityCircle = new google.maps.Circle(populationOptions); 
```

我想如果用户放大时圆圈没有变大。圆圈随着用户缩放而缩放，如果用户放大到像 20 这样的整数，我希望它们不会变大。

这是我制作地图的方式：

```
var mapOptions = {
    center: new google.maps.LatLng(30.26826, -97.743044),
    zoom: 14,
    panControl: false,
    zoomControl: false,
    scaleControl: false,
    disableDefaultUI: true,
    mapTypeControlOptions: {
        mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']
    }
};

map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions); 
```

有没有办法可以根据地图缩放控制圆半径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T17:00:13.933

谷歌地图有一个[`zoom_changed`事件](https://developers.google.com/maps/documentation/javascript/events?hl=en)，你可以订阅这个并在你的[Circle](https://developers.google.com/maps/documentation/javascript/reference?hl=en#Circle)`setRadius`上调用该方法。当然，您必须根据圆圈的大小自己定义函数`getCustomRadiusForZoom`

```
 google.maps.event.addListener(map, 'zoom_changed', function() {
    var zoomLevel = map.getZoom();
    cityCircle.setRadius(getCustomRadiusForZoom(zoomLevel));
  }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-05-11T03:53:09.690

如果您想要一个在不同缩放级别下保持相同大小的圆圈，最好使用[符号](https://developers.google.com/maps/documentation/javascript/symbols)。

如本[例](https://developers.google.com/maps/documentation/javascript/examples/marker-symbol-predefined)所示，默认情况下，它们使用缩放级别缩放大小。您还可以选择设置普通圆具有的[属性](https://developers.google.com/maps/documentation/javascript/symbols#properties)，例如`fillColor`和`strokeOpacity`。

从我链接的示例中：

```
var marker = new google.maps.Marker({
  position: map.getCenter(),
  icon: {
    path: google.maps.SymbolPath.CIRCLE,
    scale: 10
  },
  draggable: true,
  map: map
}); 
```

[![在此处输入图像描述](../Images/1e5c39ec5ae84dc0229c707568a6ef35.png)](https://i.stack.imgur.com/pAkJm.png)

[![在此处输入图像描述](../Images/755f5868d1c768e4b91ae4df1e924c07.png)](https://i.stack.imgur.com/B1cd6.png)

# iphone - 为自定义 UIButton 编写 Popover segue

> ID：15093485
> 
> 赞同：3
> 
> 时间：2013-02-26T15:52:16.527
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我有一个`UIButton`像这样以编程方式定义的自定义：

```
self.hard1 = [UIButton buttonWithType:UIButtonTypeCustom];
[self.hard1 setFrame:CGRectMake(884, 524, 105, 60)]; // set the x,y,width and height
UIImage *buttonImage = [UIImage imageNamed:@"green.jpg"];
self.hard1.layer.cornerRadius = 10;
self.hard1.clipsToBounds = YES;
[self.hard1 addTarget: self
          action: @selector(buttonTapped:)
forControlEvents: UIControlEventTouchUpInside];
[self.hard1 setImage:buttonImage forState:UIControlStateNormal];
[self.view addSubview:self.hard1]; 
```

因此，它不会显示在 Interface Builder 中，它仅在我运行应用程序时出现在屏幕上。这意味着我不能 ctrl + 从`UIButton`to a拖动`ViewController`来选择一个弹出框。我可以在我的代码中调用 segue 吗？如果没有，我还有其他选择吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T16:36:18.547

Blub 和 tkanzakic 的答案不太适用，因为当您创建 segue 时，popover segue 坚持在情节提要中有一个锚点视图。而且由于您的按钮尚不存在，因此很难做到这一点。您可以锚定到现有的故事板视图，但弹出箭头在弹出时不会指向正确的对象。您可以在代码中移动现有视图以匹配代码创建按钮的矩形。但是您不妨完全放弃 segue 并在代码中执行 popover。

您需要声明一个 popoverController 属性：

```
@property (nonatomic, strong) UIPopoverController* buttonPopoverController; 
```

然后您的按钮操作可能如下所示：

```
- (void) buttonTapped:(UIButton*) sender
{
    ContentViewController* contentVC = [[ContentViewController alloc] init];
    self.buttonPopoverController = [[UIPopoverController alloc]
                                     initWithContentViewController:contentVC];
    self.buttonPopoverController.delegate = self;  
           //only required if using delegate methods

    [self.buttonPopoverController presentPopoverFromRect:sender.frame
                           inView:self.view
         permittedArrowDirections:UIPopoverArrowDirectionAny
                         animated:YES];
} 
```

ContentViewController 是您打算使用的任何视图控制器。如果它是使用情节提要场景配置的，您可能希望在创建它时执行以下操作：

```
 UIStoryboard *storyboard = self.storyboard;
 ContentViewController* contentVC = 
    [storyboard instantiateViewControllerWithIdentifier:@"ContentViewController"]; 
```

当您在情节提要中选择了相关的视图控制器时，您可以使用身份检查器设置情节提要标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:02:45.870

1.  *CTRL + 从包含您的 Button*的 ViewController 中拖动一个 segue -->*您想要继续的 ViewController*

2.  为该 segue 指定一个标识符（只是一些唯一的字符串）（选择 segue，打开右侧的“*实用程序*”侧边栏并打开它的“*属性检查*器”选项卡

3.  `[self performSegueWithIdentifier:@"identifierStringYouSecifiedInStep2" sender:sender];` 在您的方法中添加`- (void)buttonTapped:(id)sender`！)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:04:59.537

在创建按钮的过程中，您为其分配了一个与名为 的方法相关联的操作`buttonTapped:`，您可以从那里执行 segue，如下所示：

```
- (void)buttonTapped:(id)sender
{
    [self performSegueWithIdentifier:@"theSegueIdentifier" sender:sender];
} 
```

# jquery - jquery粘贴向上和向下滚动箭头

> ID：15093486
> 
> 赞同：0
> 
> 时间：2013-02-26T15:52:19.113
> 
> 标签：jquery, html, css, uiscrollview

我正在尝试在页面中间添加两个粘贴（向上和向下），可以滚动分为某些部分的网页。所以箭头总是在中间出现在第二节到最后一节，让页面向上或向下滚动。

![在此处输入图像描述](../Images/2bd1b493389a36a34dc58668bf963587.png)

目前我有一个按钮可以将我带到网页顶部

```
.content-wrap section .back-to-top {
    display: block;
    position: absolute;
    bottom: -65px;
    right: 10px;
    height: 36px;
    width: 36px;
    background: url(http://www.caddet-re.org/assets/images/Arrow_Circle_Up.gif);
    text-indent: -9999px;
    z-index: 2;
}
<a class="back-to-top" href="#main">Back to Top</a> 
```

给我 ：

![在此处输入图像描述](../Images/92574ada356264e9ef46ffe51b1fe36c.png)

[jsfiddle是这个](http://jsfiddle.net/9c58k/)

这些部分的结构是：

```
<div class="content-wrap">
     <section id="main">
      <!--content-->
      </section>

      <section id="portfolio">
      <!--content-->
     </section>
      ...
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:10:03.373

我稍微更改了您的代码：

[http://jsfiddle.net/BorisDutkin1982/ZapgY/1/](http://jsfiddle.net/BorisDutkin1982/ZapgY/1/)

我希望这就是你的意思。您也可以添加“向下”按钮：只要确保它在“箭头容器”内，并且 css 参数与“向上”按钮相同`top:45%`，但将其更改为`bottom:45%`.

如果您只想在第二部分之后显示箭头，您需要为“滚动”添加一个事件侦听器并检查用户滚动页面的位置。你可以用`scrollTop()`方法来做到这一点......例如代码：

```
$(document).ready(
   function(){
      $("body").live(
         "scroll",
          function(){
             if($("body").scrollTop == NUMBER_OF_PIXELS_FROM_TOP_OF_THE_PAGE){
                $("arrow").show();
             }
          }
      );
   }
); 
```

说明：我在“body”中添加了滚动动作的监听器。如果到页面顶部的距离是第二部分的位置，则每次用户滚动正文/页面时 - 显示箭头

# python - Tornado 中的异步是如何工作的？

> ID：15093487
> 
> 赞同：1
> 
> 时间：2013-02-26T15:52:19.830
> 
> 标签：python, asynchronous, tornado, couchbase

Tornado 文档中的所有示例都展示了我们如何使用 Tornado 异步发出进一步的 HTTP 请求。

```
http_client = httpclient.AsyncHTTPClient()
http_client.fetch("http://www.google.com/", handle_request) 
```

虽然我想确保我的龙卷风不会等待来自数据库的响应（获取 couchbase 的命令）来发送下一个。

检查[我的另一个错误](https://stackoverflow.com/questions/15089986/)以了解为什么我想要对 couchbase 进行异步调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T17:43:04.683

据我所知，Couchbase 驱动程序[不是异步驱动程序](https://stackoverflow.com/questions/9338532/does-anyone-know-of-an-asynchronous-couchbase-client-for-the-tornado-web-framewo)，所以这不起作用。使数据库调用同步并尽可能快地对其进行优化。

（可怕的）替代方法是使用 couchbase 的驱动程序并使用 gevent 之类的东西对其进行修补，以创建您自己的异步驱动程序。我不建议这样做。如果你真的想走这条路，看看这个人对[Motor](http://emptysquare.net/blog/introducing-motor-an-asynchronous-mongodb-driver-for-python-and-tornado/)做了什么——他让 mongo 驱动程序异步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T22:22:16.373

请参阅[github 上的 Tornado wiki](https://github.com/facebook/tornado/wiki/Threading-and-concurrency)和[StackOverflow 上的类似问题](https://stackoverflow.com/questions/4938902/tornado-asynchronous-handler)。只需让您的数据库调用同步。如果您的数据库或对数据库/数据库驱动程序的调用是您的瓶颈，即使龙卷风没有被阻止，您的网站也不会更快。当请求不受您控制的资源时，执行异步调用可能更有意义，因为其他网络服务器或资源对您网站的大多数部分（如文件 I/O）并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-17T15:53:26.170

旧线程，但我可能应该提到*coouchbase 支持 twisted*。请参阅[Twisted API for Couchbase not working with Python Tornado](https://stackoverflow.com/questions/31437022/twisted-api-for-couchbase-not-working-with-python-tornado)和[http://pythonhosted.org/couchbase/api/txcouchbase.html](http://pythonhosted.org/couchbase/api/txcouchbase.html)

# shell - 使用 sed 从 txt 文件中删除行

> ID：15093494
> 
> 赞同：0
> 
> 时间：2013-02-26T15:52:59.327
> 
> 标签：shell, unix, sed, awk, grep

我有一个大文本文件，我想从中删除另一个文本文件中的一些行。似乎`sed`Unix shell 中的命令是执行此操作的好方法。但是，我无法弄清楚为此使用哪些标志。.

数据库.txt：

```
this is line 1
this is line 2
this is line 3
this is line 4
this is line 5 
```

lines_to_remove.txt

```
this is line 1
this is line 3 
```

what_i_want.txt

```
this is line 2
this is line 4
this is line 5 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T15:56:35.290

`grep`比`sed`这个更适合：

```
grep -Fxv -f lines_to_remove.txt database.txt > what_i_really_really_want.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:07:22.013

在`awk`：

```
$ awk 'NR==FNR{a[$0];next}!($0 in a)' remove.txt database.txt
this is line 2
this is line 4
this is line 5

$ awk 'NR==FNR{a[$0];next}!($0 in a)' remove.txt database.txt > output.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T16:16:30.373

我会用`comm`这个：

```
comm -1 <(sort database.txt) <(sort lines_to_remove.txt) > what_i_want.txt 
```

该命令更适合您的需求。

**注意**：`<(commmand)`语法是一种 bashism，因此在 SO 上受到很大的诽谤。它是以下内容的简写：

```
sort database.txt > sorted_database.txt
sort lines_to_remove.txt > sorted_lines_to_remove.txt
comm -1 sorted_database.txt sorted_lines_to_remove.txt > what_i_want.txt 
```

# java - Java applet 有哪些布局适合这种界面？

> ID：15093500
> 
> 赞同：1
> 
> 时间：2013-02-26T15:53:11.097
> 
> 标签：java, swing, applet, awt, layout-manager

哪种布局最适合这个界面？我试过`FlowLayout`了，但无法将`SUBMIT`按钮放置在正确的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:04:36.590

我推荐[miglayout](http://www.miglayout.com)，它非常易于使用，并且它总是可以处理我要扔的东西。

在这种情况下，我将创建两个面板。第一个面板有一个“wrap 3”约束作为 miglayout 构造函数的参数，第二个只有一个按钮，添加了一个“alignx center, aligny center”约束。

这是一个例子：

```
public class TestApplet extends JApplet{

@Override
public void init() {
    super.init();
    setSize(400, 300);
    setLayout(new MigLayout("fill, insets 0"));

    JPanel leftPanel = new JPanel(new MigLayout("wrap 3"));
    for (int i = 0; i < 9; i++) {
        leftPanel.add(new JButton(""+i));
    }
    add(leftPanel);

    JPanel rightPanel = new JPanel(new MigLayout());
    rightPanel.add(new JButton("submit"), "alignx center, aligny center");
    add(rightPanel);

}   
} 
```

![在此处输入图像描述](../Images/362c0c87ee1275bd5f225bb315d2448a.png)

您只需根据需要对按钮上的数字进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:55:03.450

*   第一个具有两列的网格布局。
*   在第一列添加 panal1 并在第二列添加提交`BorderLayout.CENTER`。
*   在该 panal1 中，您可以使用 3x3 网格布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:32:26.270

我在 JFrame 上尝试过这个，你可以在你的小程序中做同样的事情。

创建一个一行两列的网格。
在第二个面板上创建一个带有页面轴的框布局，然后确保您有垂直胶水，按钮位于中心。创建一个 3x3 的网格并添加按钮。

代码示例：

```
 JFrame frame = new JFrame();

    frame.setLayout(new GridLayout(1, 2));
    JPanel leftPanel = new JPanel(new GridLayout(3, 3));
    for(int i=0;i<9;i++)

    {
        JButton button = new JButton();
        button.setText(i+"");
        leftPanel.add(button);
    }
    frame.add(leftPanel);
    JPanel rightPanel = new JPanel();
     BoxLayout layout = new BoxLayout(rightPanel, BoxLayout.PAGE_AXIS);
     rightPanel.setLayout(layout);

     JButton button = new JButton("Submit");
         button.setAlignmentX(
     Component.CENTER_ALIGNMENT);
     rightPanel.add(Box.createVerticalGlue()); //Ensure this order
     rightPanel.add(button);
     rightPanel.add(Box.createVerticalGlue());

    frame.add(rightPanel);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true); 
```

# jquery-mobile - li-desc的jQuery Mobile溢出

> ID：15093501
> 
> 赞同：5
> 
> 时间：2013-02-26T15:53:21.153
> 
> 标签：jquery-mobile, responsive-design, overflow

如何强制标题可见，并且下面的文本溢出到省略号？当页面宽度超过 768 像素时，我无法让它与 BlackBerry 列表项一起使用。

[http://jsfiddle.net/TeNXG/14/](http://jsfiddle.net/TeNXG/14/)

```
<div data-role="page" data-theme="a" id="demo-page" class="my-page" data-url="demo-page">
<div data-role="header">
    <h1>News</h1>
    <a href="grid-listview.html" data-shadow="false" data-iconshadow="false" data-icon="arrow-l" data-iconpos="notext" data-rel="back" data-ajax="false">Back</a>
</div><!-- /header -->
<div data-role="content">
    <ul data-role="listview">
        <li><a href="#">
            <img src="http://view.jquerymobile.com/master/docs/_assets/img/apple.png">
            <h2>iOS 6.1</h2>
            <p>Apple released iOS 6.1</p>
            <p class="ui-li-aside">iOS</p>
        </a></li>
        <li><a href="#">
            <img src="http://view.jquerymobile.com/master/docs/_assets/img/blackberry_10.png">
            <h2>BlackBerry 10</h2>
            <p>BlackBerry launched the Z10 and Q10 with the new BB10 OS and more and stuff and lots of stuff and overflowing and stuff and wow so much text man holy mess even more let's see just how jacked we can make this div</p>
            <p class="ui-li-aside">BlackBerry</p>
        </a></li>
    </ul>
</div><!-- /content -->
<div data-role="footer" data-theme="none">
    <h3>Responsive Grid Listview</h3>
</div><!-- /footer --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:56:38.947

添加`white-space: nowrap;`到描述块：

```
ui-listview .ui-li-desc {
    white-space: nowrap;
    overflow: visible;
    position: absolute;
    left: 0;
    right: 0;   
} 
```

请参阅更新的[jsFiddle](http://jsfiddle.net/TeNXG/15/)。

# maven - 如何在不抑制正常输出的情况下抑制 Mavens INFO 垃圾邮件？

> ID：15093502
> 
> 赞同：4
> 
> 时间：2013-02-26T15:53:21.793
> 
> 标签：maven

我想使用 Mavens`dependency:build-classpath`创建一个类路径：

```
$ mvn 依赖：build-classpath -Dmdep.prefix='lib' -f xpath.pom
[INFO] 正在扫描项目...
[信息]
[信息] --------------------------------------------- -------------------------
[信息] 构建 xpath 1
[信息] --------------------------------------------- -------------------------
[信息]
[信息] --- maven-dependency-plugin:2.1:build-classpath (default-cli) @ xpath ---
[INFO] 依赖类路径：
lib/serializer-2.7.1.jar:lib/xalan-2.7.1.jar:lib/xml-apis-1.3.04.jar
[信息] --------------------------------------------- -------------------------
[信息] 构建成功
[信息] --------------------------------------------- -------------------------
[INFO] 总时间：2.251s
[INFO] 完成时间：2013 年 2 月 26 日星期二 16:37:01 CET
[INFO] 最终内存：5M/109M
[信息] --------------------------------------------- -------------------------

```

如何在不抑制预期输出的情况下阻止 Mavens INFO 垃圾邮件`build-classpath`？

我找到了答案，这解释了我必须使用该`-q`选项来抑制 INFO 输出。但是使用这个选项根本没有输出。

我知道我可以使用`grep`，但我想避免它。而且我不敢相信 Maven 不能开箱即用，因为它使依赖插件变得毫无用处。

这是完整的pom：

```
<?xml 版本="1.0"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>没有人</groupId>
  <artifactId>xpath</artifactId>
  <版本>1</版本>

  <依赖项>
    <依赖>
      <groupId>xalan</groupId>
      <artifactId>xalan</artifactId>
      <版本>2.7.1</版本>
    </依赖>
  </依赖>

  <构建>
    <插件>
      <插件>
        <artifactId>maven-dependency-plugin</artifactId>
        <执行>
          <执行>
            <phase>初始化</phase>
            <目标>
              <goal>复制依赖</goal>
            </目标>
            <配置>
              <outputDirectory>${project.basedir}/lib</outputDirectory>
            </配置>
          </执行>
        </执行>
      </插件>
    </插件>
  </build>
</项目>

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:09:20.940

我知道这对某些人来说并不理想，但是您可以使用[outputFile](http://maven.apache.org/plugins/maven-dependency-plugin/build-classpath-mojo.html#outputFile)将输出放入文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:28:37.397

`INFO`***是您真正***需要看到的关于构建的最少量信息。这是它使用的默认日志记录级别。如果您告诉它不要使用`INFO`，那么 Maven 中的所有日志消息和您正在使用的插件将根本不会输出任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T19:49:53.500

在 linux 中，您可以在语句末尾添加 grep -v INFO

`$ mvn help:evaluate -Dexpression=project.parent.version |grep -v INFO 4.0.6-a $`

# javascript - 在调整大小时放大图片

> ID：15093503
> 
> 赞同：0
> 
> 时间：2013-02-26T15:53:26.710
> 
> 标签：javascript, jquery, css

我正在开发一个网站，我必须在其中显示图片（不是问题）。但是，我必须将它显示为这个链接：[http ://buildinternet.com/project/supersized/slideshow/3.2/demo.html](http://buildinternet.com/project/supersized/slideshow/3.2/demo.html)

所以，在调整大小时，我必须放大图片以从不缩放它。有人知道怎么做吗？

这是我所拥有的：

html:

```
<div id="container_images">
    <ul>
        <li><img src="images/desktop/myimage.jpg" alt="An awesome image"></li>
    </ul>
</div> 
```

CSS：

```
#container_images{
    display: block;
    position: fixed;
    left: 0;
    top: 0;
    overflow: hidden;
    z-index: -999;
    height: 100%;
    width: 100%;
}

#container_images li{
    display: block;
    list-style: none;
    z-index: -30;
    position: fixed;
    overflow: hidden;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity:1;
}

#container_images li img{
    width: 100%;
    height: 100%;
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T17:36:13.300

如果我理解正确你不需要浏览器的内置缩放（ctrl+），你只想在调整窗口大小时让图片填满浏览器的整个窗口。

为此，您将需要两件事。

首先，您需要在窗口调整大小事件上执行一些 javascript，然后您将需要一些简单的数学来计算图片的中心，同时考虑新的窗口大小并将图片的左/上边距设置为新值。

[您可以使用jQuery](http://jquery.com)轻松做到这一点：

```
$(window).resize(function() {
    var h = $(window).height();
    var w = $(window).width();
    var pic = $('#container_images img');
    var pic_width = pic.width(), pic_height = pic.height();

    $(pic).css('margin-left': (w - pic_width)/2).css('margin-top': (h - pic_height)/2);
}); 
```

要记住的一件事是，如果您的图片的宽度/高度已经从其原始大小更改，您将从 width() 和 height() 函数中获得新的大小。

所以你要么应该确保原件没有被触及，要么使用其中一种解决方案来获取原始图片大小（例如[，我如何使用 jQuery 获得实际的图像宽度和高度？](https://stackoverflow.com/questions/2395931/how-do-i-get-actual-image-width-and-height-using-jquery)）。

上面的代码片段也是为了让你开始，你应该在一些初始化函数中获取图片及其参数，并且只在调整大小事件时重新计算/修改 css。

# c++ - 在 Boost Python 中公开一个非常量但不可复制的成员

> ID：15093504
> 
> 赞同：4
> 
> 时间：2013-02-26T15:53:27.130
> 
> 标签：c++, boost, boost-python

这是我的问题：

我有两个这样的课程：

```
class Signal {
public:
    void connect(...) { sig.connect(...); }
private:
    boost::signal2::signal sig;
};

class MyClass {
public:
    Signal on_event;
}; 
```

我想公开`MyClass::on_event`以便我可以`my_class_instance.on_event.connect(...)`从 Python 调用。

这就是我包装这些类的方式：

```
class_<Signal, boost::noncopyable> ("Signal", noinit)
    .def("connect", &some_helper_function);

class_<MyClass> ("MyClass")
    .def_readonly("on_event", &MyClass::on_event); 
```

这可以编译，但是当我尝试`connect`从 Python 调用时，我得到：`AttributeError: can't set attribute`. 这在这里解释：http: [//www.boost.org/doc/libs/1_53_0/libs/python/doc/tutorial/doc/html/python/exposing.html](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/tutorial/doc/html/python/exposing.html)，所以我改为`.def_readwrite`for `on_event`。

但现在我得到了一个编译时错误。它几乎不可能阅读 C++ 模板错误消息，但据我了解，它是因为不可`boost::signals2::signal`复制。由于`.def_readwrite`使成员可分配，因此它不能是不可复制的。但是对于我的用法，我不想分配成员，我只是不想调用一种方法。

我考虑过制作 const 的`connect`方法`Signal`，即使它改变了对象，但是我不能`sig.connect()`从那个方法调用，所以那也是不行的..

有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T19:29:47.960

我在重现您的结果时遇到问题，但这里有一些信息可能有助于解决问题。

使用简单的类：

```
class Signal
{
public:
  void connect() { std::cout << "connect called" << std::endl; }
private:
  boost::signals2::signal<void()> signal_;
};

class MyClass
{
public:
  Signal on_event;
}; 
```

和基本绑定：

```
namespace python = boost::python;
python::class_<Signal, boost::noncopyable>("Signal", python::no_init)
  .def("connect", &Signal::connect)
  ;

python::class_<MyClass>("MyClass")
  .def_readonly("on_event", &MyClass::on_event)
  ; 
```

代码无法编译。公开一个类时，Boost.Python 的默认行为是注册转换器。这些转换器需要复制构造函数，作为将 C++ 类对象复制到可由 Python 对象管理的存储中的一种方式。`boost::noncopyable`通过提供类型的参数，可以为类禁用此行为`class_`。

在这种情况下，`MyClass`绑定不会抑制复制构造函数。Boost.Python 将尝试在绑定中使用复制构造函数，并因编译器错误而失败，因为成员变量`on_event`不可复制。 `Signal`不可复制，因为它包含一个类型为 的成员变量`boost::signal2::signal`，它继承自`boost::noncopyable`.

`boost:::noncopyable`作为参数类型添加到`MyClass`的绑定允许编译代码。

```
namespace python = boost::python;
python::class_<Signal, boost::noncopyable>("Signal", python::no_init)
  .def("connect", &Signal::connect)
  ;

python::class_<MyClass, boost::noncopyable>("MyClass")
  .def_readonly("on_event", &MyClass::on_event)
  ; 
```

用法：

```
>>> import example
>>> m = example.MyClass()
>>> m.on_event.connect()
connect called
>>> m.on_event = None
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: can't set attribute
>>> 
```

虽然此设置允许所需的绑定和调用语法，但它看起来好像是最终目标的第一步。

* * *

如果这太冒昧了，我很抱歉。但是，基于最近的其他问题，我想花时间扩展最初的示例，以涵盖似乎是最终目标的内容：能够将 Python 回调连接到`signal2::signal`. 由于机制和复杂程度不同，我将介绍两种不同的方法，但它们可以提供对最终解决方案应考虑的细节的洞察。

## 只有 Python 线程。

对于第一个场景，我们假设只有 Python 线程与库交互。

一种使其相对简单的技术是使用继承。首先定义一个`Slot`可以连接到`Signal`.

```
class Slot
  : public boost::python::wrapper<Slot>
{
public:
  void operator()()
  {
    this->get_override("__call__")();
  }
}; 
```

该类`Slot`继承自[`boost::python::wrapper`](http://www.boost.org/doc/libs/1_53_0/libs/python/doc/v2/wrapper.html)，一个非侵入式地提供钩子以允许 Python 类覆盖基类中的函数的类。

当可调用类型连接到`boost::signals2::signal`时，信号可能会将参数复制到其内部列表中。`Slot`因此，对于函子来说，只要它保持连接到 ，就能够延长实例的寿命是很重要的`signal`。完成此操作的最简单方法是`Slot`通过`boost::shared_ptr`.

生成的`Signal`类如下所示：

```
class Signal
{
public:
  template <typename Callback>
  void connect(const Callback& callback)
  {
    signal_.connect(callback);
  }

  void operator()() { signal_(); }
private:
  boost::signals2::signal<void()> signal_;
}; 
```

辅助函数有助于保持`Signal::connect`通用性，以防其他 C++ 类型需要连接到它。

```
void connect_slot(Signal& self, 
                  const boost::shared_ptr<Slot>& slot)
{
  self.connect(boost::bind(&Slot::operator(), slot));
} 
```

这将导致以下绑定：

```
BOOST_PYTHON_MODULE(example) {
  namespace python = boost::python;
  python::class_<Signal, boost::noncopyable>("Signal", python::no_init)
    .def("connect",  &connect_slot)
    .def("__call__", &Signal::operator())
    ;

  python::class_<MyClass, boost::noncopyable>("MyClass")
    .def_readonly("on_event", &MyClass::on_event)
    ;

  python::class_<Slot, boost::shared_ptr<Slot>, 
                 boost::noncopyable>("Slot")
    .def("__call__", python::pure_virtual(&Slot::operator()))
    ;
} 
```

其用法如下：

```
>>> from example import *
>>> class Foo(Slot):
...     def __call__(self):
...          print "Foo::__call__"
... 
>>> m = MyClass()
>>> foo = Foo()
>>> m.on_event.connect(foo)
>>> m.on_event()
Foo::__call__
>>> foo = None
>>> m.on_event()
Foo::__call__ 
```

虽然成功，但它有一个不幸的特征，即不是 Pythonic。例如：

```
>>> def spam():
...     print "spam"
... 
>>> m = MyClass()
>>> m.on_event.connect(spam)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
Boost.Python.ArgumentError: Python argument types in
    Signal.connect(Signal, function)
did not match C++ signature:
    connect(Signal {lvalue}, boost::shared_ptr<Slot>) 
```

如果任何可调用对象都可以连接到信号，那将是理想的。一种简单的方法是猴子修补Python中的绑定。要对最终用户透明：

*   将 C++ 绑定模块名称从 更改`example`为`_example`. 确保还更改库名称。
*   创建`example.py`将修补程序`Signal.connect()`以将参数包装为继承自的类型`Slot`。

`example.py`可能看起来像这样：

```
from _example import *

class _SlotWrap(Slot):

    def __init__(self, fn):
        self.fn = fn
        Slot.__init__(self)

    def __call__(self):
        self.fn()

def _signal_connect(fn):
    def decorator(self, slot):
        # If the slot is not an instance of Slot, then aggregate it
        # in SlotWrap.
        if not isinstance(slot, Slot):
            slot = _SlotWrap(slot)
        # Invoke the decorated function with the slot.
        return fn(self, slot)
    return decorator

# Patch Signal.connect.
Signal.connect = _signal_connect(Signal.connect) 
```

修补对最终用户来说是无缝的。

```
>>> from example import *
>>> def spam():
...     print "spam"
... 
>>> m = MyClass()
>>> m.on_event.connect(spam)
>>> m.on_event()
spam 
```

使用此补丁，任何可调用类型都可以连接到，`Signal`而无需显式继承自`Slot`. 因此，它变得比最初的解决方案更加 Pythonic。永远不要低估保持绑定简单和非pythonic的好处，而是将它们修补为python中的pythonic。

* * *

## Python 和 C++ 线程。

在下一个场景中，让我们考虑 C++ 线程与 Python 交互的情况。例如，可以将 C++ 线程设置为在一段时间后调用信号。

这个例子可能相当复杂，所以让我们从基础开始：Python 的[全局解释器锁](http://wiki.python.org/moin/GlobalInterpreterLock)(GIL)。简而言之，GIL 是解释器周围的互斥体。如果一个线程正在做任何影响 python 托管对象的引用计数的事情，那么它需要获得 GIL。在前面的示例中，由于没有 C++ 线程，所有操作都在获取 GIL 时发生。虽然这相当简单，但它会很快变得复杂。

首先，模块需要让 Python 为线程初始化 GIL。

```
BOOST_PYTHON_MODULE(example) {
  PyEval_InitThreads(); // Initialize GIL to support non-python threads.
  ...
} 
```

为方便起见，让我们创建一个简单的类来帮助管理 GIL：

```
/// @brief RAII class used to lock and unlock the GIL.
class gil_lock
{
public:
  gil_lock()  { state_ = PyGILState_Ensure(); }
  ~gil_lock() { PyGILState_Release(state_);   }
private:
  PyGILState_STATE state_;
}; 
```

线程将调用`MyClass`的信号。因此，它需要延长`MyClass`线程处于活动状态时的生命周期。完成此任务的一个好方法是`MyClass`使用`shared_ptr`.

让我们确定 C++ 线程何时需要 GIL：

*   `MyClass`被删除`shared_ptr`。
*   `boost::signals2::signal`可以制作连接对象的额外副本，就像[同时](http://www.boost.org/doc/libs/1_53_0/doc/html/signals2/thread-safety.html)调用信号时所做的那样。
*   调用通过`boost::signals2::signal`. 回调肯定会影响 python 对象。例如，`self`提供给该`__call__`方法的参数将增加和减少对象的引用计数。

### 支持`MyClass`从 C++ 线程中删除。

为了保证 GIL 在从 C++ 线程`MyClass`中删除时被保留，需要[自定义删除](http://www.boost.org/doc/libs/1_53_0/libs/smart_ptr/shared_ptr.htm#deleter_constructor)器。这也需要绑定来抑制默认构造函数，并改用自定义构造函数。`shared_ptr`

```
/// @brief Custom deleter.
template <typename T>
struct py_deleter
{
  void operator()(T* t)
  {
    gil_lock lock;    
    delete t;
  }
};

/// @brief Create Signal with a custom deleter.
boost::shared_ptr<MyClass> create_signal()
{
  return boost::shared_ptr<MyClass>(
    new MyClass(),
    py_deleter<MyClass>());
}

...

BOOST_PYTHON_MODULE(example) {

  ...

  python::class_<MyClass, boost::shared_ptr<MyClass>,
                 boost::noncopyable>("MyClass", python::no_init)
    .def("__init__", python::make_constructor(&create_signal))
    .def_readonly("on_event", &MyClass::on_event)
    ;
} 
```

### 线程本身。

线程的功能相当基本：它休眠然后调用信号。但是，了解 GIL 的背景很重要。

```
/// @brief Wait for a period of time, then invoke the
///        signal on MyClass.
void call_signal(boost::shared_ptr<MyClass>& shared_class,
                 unsigned int seconds)
{
  // The shared_ptr was created by the caller when the GIL was
  // locked, and is accepted as a reference to avoid modifying
  // it while the GIL is not locked.

  // Sleep without the GIL so that other python threads are able
  // to run.
  boost::this_thread::sleep_for(boost::chrono::seconds(seconds));

  // We do not want to hold the GIL while invoking C++-specific
  // slots connected to the signal.  Thus, it is the responsibility of
  // python slots to lock the GIL.  Additionally, the potential
  // copying of slots internally by the signal will be handled through
  // another mechanism.
  shared_class->on_event();

  // The shared_class has a custom deleter that will lock the GIL
  // when deletion needs to occur.
}

/// @brief Function that will be exposed to python that will create
///        a thread to call the signal.
void spawn_signal_thread(boost::shared_ptr<MyClass> self,
                       unsigned int seconds)
{
  // The caller owns the GIL, so it is safe to make copies.  Thus,
  // spawn off the thread, binding the arguments via copies.  As
  // the thread will not be joined, detach from the thread.
  boost::thread(boost::bind(&call_signal, self, seconds)).detach();
} 
```

并且`MyClass`绑定已更新。

```
python::class_<MyClass, boost::shared_ptr<MyClass>,
               boost::noncopyable>("MyClass", python::no_init)
  .def("__init__", python::make_constructor(&create_signal))
  .def("signal_in", &spawn_signal_thread)
  .def_readonly("on_event", &MyClass::on_event)
  ; 
```

### `boost::signals2::signal`与 python 对象交互。

`boost::signals2::signal`调用时可以进行复制。此外，可能有 C++ 插槽连接到信号，因此在调用信号时最好不要锁定 GIL。但是，`signal`它没有提供钩子让我们在创建插槽副本或调用插槽之前获取 GIL。

为了增加复杂性，当绑定公开了一个 C++ 函数，该函数接受带有`HeldType`非智能指针的 C++ 类时，Boost.Python 将从引用计数的 python 对象中提取非引用计数的 C++ 对象。它可以安全地执行此操作，因为 Python 中的调用线程具有 GIL。为了保持对尝试从 Python 连接的插槽的引用计数，并允许任何可调用类型进行连接，我们可以使用不透明类型的`boost::python::object`.

为了避免`signal`创建所提供`boost::python::object`的副本，可以创建一个副本以`boost::python::object`使引用计数保持准确，并通过 管理副本`shared_ptr`。这允许`signal`自由创建副本`shared_ptr`而不是在`boost::python::object`没有 GIL 的情况下创建。

这个 GIL 安全槽可以封装在一个辅助类中。

```
/// @brief Helper type that will manage the GIL for a python slot.
class py_slot
{
public:

  /// @brief Constructor that assumes the caller has the GIL locked.
  py_slot(const boost::python::object& object)
    : object_(new boost::python::object(object),   // GIL locked, so copy.
              py_deleter<boost::python::object>()) // Delete needs GIL.
  {}

  void operator()()
  {
    // Lock the gil as the python object is going to be invoked.
    gil_lock lock;
    (*object_)(); 
  }

private:
  boost::shared_ptr<boost::python::object> object_;
}; 
```

将向 Python 公开一个辅助函数以帮助调整类型。

```
/// @brief Signal connect helper.
void signal_connect(Signal& self,
                    boost::python::object object)
{
  self.connect(boost::bind(&py_slot::operator(), py_slot(object)));
} 
```

更新后的绑定公开了辅助函数：

```
python::class_<Signal, boost::noncopyable>("Signal", python::no_init)
  .def("connect",  &signal_connect)
  .def("__call__", &Signal::operator())
  ; 
```

最终解决方案如下所示：

```
#include <boost/bind.hpp>
#include <boost/python.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/signals2/signal.hpp>
#include <boost/thread.hpp>

class Signal
{
public:
  template <typename Callback>
  void connect(const Callback& callback)
  {
    signal_.connect(callback);
  }

  void operator()() { signal_(); }
private:
  boost::signals2::signal<void()> signal_;
};

class MyClass
{
public:
  Signal on_event;
};

/// @brief RAII class used to lock and unlock the GIL.
class gil_lock
{
public:
  gil_lock()  { state_ = PyGILState_Ensure(); }
  ~gil_lock() { PyGILState_Release(state_);   }
private:
  PyGILState_STATE state_;
};    

/// @brief Custom deleter.
template <typename T>
struct py_deleter
{
  void operator()(T* t)
  {
    gil_lock lock;    
    delete t;
  }
};

/// @brief Create Signal with a custom deleter.
boost::shared_ptr<MyClass> create_signal()
{
  return boost::shared_ptr<MyClass>(
    new MyClass(),
    py_deleter<MyClass>());
}

/// @brief Wait for a period of time, then invoke the
///        signal on MyClass.
void call_signal(boost::shared_ptr<MyClass>& shared_class,
                 unsigned int seconds)
{
  // The shared_ptr was created by the caller when the GIL was
  // locked, and is accepted as a reference to avoid modifying
  // it while the GIL is not locked.

  // Sleep without the GIL so that other python threads are able
  // to run.
  boost::this_thread::sleep_for(boost::chrono::seconds(seconds));

  // We do not want to hold the GIL while invoking C++-specific
  // slots connected to the signal.  Thus, it is the responsibility of
  // python slots to lock the GIL.  Additionally, the potential
  // copying of slots internally by the signal will be handled through
  // another mechanism.
  shared_class->on_event();

  // The shared_class has a custom deleter that will lock the GIL
  // when deletion needs to occur.
}

/// @brief Function that will be exposed to python that will create
///        a thread to call the signal.
void spawn_signal_thread(boost::shared_ptr<MyClass> self,
                       unsigned int seconds)
{
  // The caller owns the GIL, so it is safe to make copies.  Thus,
  // spawn off the thread, binding the arguments via copies.  As
  // the thread will not be joined, detach from the thread.
  boost::thread(boost::bind(&call_signal, self, seconds)).detach();
}

/// @brief Helepr type that will manage the GIL for a python slot.
struct py_slot
{
public:

  /// @brief Constructor that assumes the caller has the GIL locked.
  py_slot(const boost::python::object& object)
    : object_(new boost::python::object(object),   // GIL locked, so copy.
              py_deleter<boost::python::object>()) // Delete needs GIL.
  {}

  void operator()()
  {
    // Lock the gil as the python object is going to be invoked.
    gil_lock lock;
    (*object_)(); 
  }

private:
  boost::shared_ptr<boost::python::object> object_;
};

/// @brief Signal connect helper.
void signal_connect(Signal& self,
                    boost::python::object object)
{
  self.connect(boost::bind(&py_slot::operator(), py_slot(object)));
}

BOOST_PYTHON_MODULE(example) {
  PyEval_InitThreads(); // Initialize GIL to support non-python threads.

  namespace python = boost::python;
  python::class_<Signal, boost::noncopyable>("Signal", python::no_init)
    .def("connect",  &signal_connect)
    .def("__call__", &Signal::operator())
    ;

  python::class_<MyClass, boost::shared_ptr<MyClass>,
                 boost::noncopyable>("MyClass", python::no_init)
    .def("__init__", python::make_constructor(&create_signal))
    .def("signal_in", &spawn_signal_thread)
    .def_readonly("on_event", &MyClass::on_event)
    ;
} 
```

和一个测试脚本（`test.py`）：

```
from time import sleep
from example import *

def spam():
    print "spam"

m = MyClass()
m.on_event.connect(spam)
m.on_event()

m.signal_in(2)
m = None
print "Sleeping"
sleep(5)
print "Done sleeping" 
```

结果如下：

```
垃圾邮件
睡眠
垃圾邮件
睡完了
```

* * *

总之，当一个对象通过 Boost.Python 层时，需要花时间考虑如何管理它的生命周期以及使用它的上下文。这通常需要了解正在使用的其他库将如何处理该对象。这不是一个简单的问题，提供一个 Pythonic 的解决方案可能是一个挑战。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T08:44:50.393

写完这个问题后，我向 Signal 添加了一个公共复制构造函数，现在它可以工作了。

# jquery - 如何让 jQuery Slider Widget 在图像之间显示和淡化？

> ID：15093506
> 
> 赞同：1
> 
> 时间：2013-02-26T15:53:30.747
> 
> 标签：jquery, jquery-ui-slider

我发现了一个非常接近我需要做的概念：使用滑块在图像之间淡入淡出。

[这是jSFiddle](http://jsfiddle.net/Ender/9zqbY/)上的工作示例。

这是我的测试页面：[http ://energync.ehclients.com/slider.html](http://energync.ehclients.com/slider.html)

我带来了代码，但它对我来说不能正常工作。

这是HTML：

```
<div class="ui-corner-all" id="sliderContent">     
<div class="viewer ui-corner-all">
<div class="content-conveyor ui-helper-clearfix" style="width: 2128px;">

<div class="item">
<h2>Omega Nebula</h2>
<img alt="Omega Nebula" src="http://d2o0t5hpnwv4c1.cloudfront.net/377_slider/slider_sourcefiles/images/omega.jpg">
</div>

<div class="item">
<h2>Rosette Nebula</h2>
<img alt="Rosette Nebula" src="http://d2o0t5hpnwv4c1.cloudfront.net/377_slider/slider_sourcefiles/images/rosette.jpg">
</div>
</div>
</div>
</div>
<div id="slider"></div> 
```

这是CSS

```
#sliderContent .item { display: none; position: absolute; } 
```

这是 jQuery

```
$(function() {
$('#sliderContent .item:first').addClass('shown').show();
$("#slider").slider({
value: 0,
min: 0,
max: $('#sliderContent .item').size(),
step: 1
}).bind("slidechange", function(event, ui) {
var newIndex = $("#slider").slider("value");
var oldIndex = $('#sliderContent .item').index('.shown');
if (newIndex != oldIndex) {
$('.shown').fadeOut().removeClass('shown');
$('#sliderContent .item').eq(newIndex).fadeIn().addClass('shown');
}
});
}); 
```

我会很感激一些帮助让它正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:00:25.817

你的小提琴对我来说很好用。您是否希望在用户仍按住滑块时更改图像？（不仅在发布时）

# c# - 什么是 C# 线程类型？

> ID：15093510
> 
> 赞同：10
> 
> 时间：2013-02-26T15:53:40.080
> 
> 标签：c#, .net, multithreading, winapi

在三种类型的线程（内核级、用户级和混合）之间，C#（或更一般的 .NET）使用哪种类型？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T15:58:05.880

### 核心线程 (1 : 1)

术语“内核线程”可以用来指代完全在内核空间中运行的实际线程，也可以指由内核调度的用户空间线程。术语“内核支持”线程是指后者，即在用户空间中运行但由内核促进的线程，这通常意味着内核调度它们。

内核线程具有特权，并且可以访问用户模式线程无法访问的内容。看看维基百科上的“ [Ring（计算机安全）](http://en.wikipedia.org/wiki/Ring_%28computer_security%29) ”。在 Windows 上，用户模式对应于 Ring 3，而内核模式对应于 Ring 0。

### 用户级线程 (N : 1)

“用户级线程”通常是指对用户空间可见的线程。也就是说，您在调用线程标准的“创建线程”函数时创建的内容。通常，术语“用户级线程”用于表示由应用程序代码创建的线程，而不管它是如何由系统实现的。它可能是一个纯用户空间线程，几乎没有内核支持，也可能是内核调度的线程。

### 混合线程（M：N）[维基百科]

M:N 将 M 数量的应用程序线程映射到 N 数量的内核实体或“虚拟处理器”上。这是内核级（“1:1”）和用户级（“N:1”）线程之间的折衷。一般来说，“M:N”线程系统比内核或用户线程更复杂，因为需要更改内核和用户空间代码。在 M:N 实现中，线程库负责在可用的可调度实体上调度用户线程；这使得线程的上下文切换非常快，因为它避免了系统调用。

### .Net 线程是用户级线程，它使用 Win32 API 并将其包装为一个不错的框架！

* * *

可以找到更多详细信息：

*   [线程（计算）](http://en.wikipedia.org/wiki/Thread_%28computing%29)
*   [内核线程与内核支持的线程与用户级线程](https://softwareengineering.stackexchange.com/questions/107938/threads-kernel-threads-vs-kernel-supported-threads-vs-user-level-threads)
*   [用户线程和内核线程](https://stackoverflow.com/questions/1178785/user-thread-and-kernel-thread)
*   [线程是内核对象吗？](https://stackoverflow.com/a/9330063/922198)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-26T16:04:10.923

这不取决于 C# 本身，而是取决于运行时 - CLR。

.Net 可以考虑支持两种模式：

*   **仅用户级**调度（或[Windows UMS](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd627187%28v=vs.85%29.aspx)）。在这种模式下，一个用户态线程可以执行上下文切换到另一个用户模式线程，而无需实际更改内核线程。这种模式增加了大量的编码开销，但在内核级上下文切换中节省了宝贵的 10-20 微秒。
*   **混合模型**（目前最流行）。在此模型中，托管代码需要访问内核，例如读取文件。通过一组 API，代码执行从用户级 .NET 调用到 Windows API，再到内核、驱动程序、HAL 层和物理驱动器。并通过调用堆栈返回获取数据。如果线程调度程序启动了上下文切换，那么用户线程和内核线程就会改变。

不允许直接内核模式线程，因为托管代码没有在内核模式下运行的特权。它只能调用Windows API，然后切换到内核模式。

* * *

如果您使用`Thread`, `Task`, `ThreadPool`- CLR 使用混合模型。使用混合模型是因为 CLR 创建托管对象来表示这些类。任何托管代码都在用户空间中运行。然而，每个不是作为 fibber 创建的线程（见下文），无论是否在线程池中，都具有底层内核数据结构。内核数据结构用于保存线程的内核状态——内核线程id、创建和退出时间、进程id、启动线程地址、安全访问令牌、十几个定时器、CPU寄存器、内核堆栈等。所有这些都需要在运行期间更新上下文切换，但我们只需要大约 10-20 * 10^-6 秒。

如果您在 Ums 的一组 C++ 调用（如 CreateUmsThreadContext 、 UmsThreadYield 和许多其他调用）周围使用托管包装器*-* CLR[会](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd627160%28v=vs.85%29.aspx)尝试[使用](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd627183%28v=vs.85%29.aspx)UMS 模式。但这仅适用于您专门手动操作的少数线程。您的应用程序仍将使用混合模型，在用户模式下，将在彼此之间手动生成一些手动选择的线程（纤维）。但即使在这种模式下，操作系统任务调度程序也会在某些时候启动内核线程切换，因此您不会永远被困在执行 UMS 调度线程。

为了完整性，

*   **内核模式**调度是一种非常低级的机制，只能从内核访问。这意味着你只能使用它，如果你开发操作系统内部或某种驱动程序。这种调度很难使用，任何错误，*整个*操作系统都被冻结/卡住/崩溃/蓝屏死机或过渡到任何其他不可预测的状态。内核级线程需要大量的开发和测试工作。例如，Windows 任务调度程序或内存管理服务使用内核模式调度。你能想象一下编写这些组件需要多少时间才能使它们在高度多线程的环境中保持稳定吗？

# java - 播放 2.0.4：有没有机会在 Java 控制器的 WS.Response 中将 followRedirects 设置为 false？

> ID：15093511
> 
> 赞同：1
> 
> 时间：2013-02-26T15:53:42.560
> 
> 标签：java, playframework-2.0

我需要自己调用 w WS 来处理 HEAD 请求，无论如何它总是在重定向后得到响应（所以最后我总是得到 200 状态而不是 301）

在文档中写到我应该`ws.followRedirects=false`在我的 application.conf 中设置，无论如何它似乎不起作用。我可以看到 Scala 版本正在尝试读取此配置，但是我有一个 Java 控制器。现在也不能切换到 2.1，我可以看到有专门的设置器来解决这个问题。

有任何解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:57:31.660

您可以从 Java 调用 Scala。该方法`wsHead`封装了 Scala 代码并仅提供来自 Java Play API 的对象。迁移到 Play 2.1.0，您可以重构该方法。

```
package controllers;

import play.api.libs.ws.Response;
import play.api.libs.ws.WS$;
import play.libs.F;
import play.libs.WS;
import play.mvc.*;

public class Application extends Controller {

    public static Result index() {
        final String url = "http://localhost:80";
        final F.Promise<WS.Response> responsePromise = wsHead(url);
        return async(responsePromise.map(new F.Function<WS.Response, Result>() {
            @Override
            public Result apply(WS.Response response) throws Throwable {
                return ok("got status: " + response.getStatus());
            }
        }));
    }

    private static F.Promise<WS.Response> wsHead(String url) {
        return new F.Promise(WS$.MODULE$.url(url).head()).map(new F.Function<Response, WS.Response>() {
            @Override
            public WS.Response apply(Response o) throws Throwable {
                return new WS.Response(o.getAHCResponse());
            }
        });
    }
} 
```

您仍然需要添加`ws.followRedirects=false`您的 application.conf。

# android - 当 build.prop 值为 true 时，如何只显示一个按钮？

> ID：15093513
> 
> 赞同：0
> 
> 时间：2013-02-26T15:53:58.287
> 
> 标签：android, android-layout

好吧，这是交易：
我正在创建一个包含一些特定于设备的设置的应用程序（在本例中为 sweep2wake），但我只需要它出现在 build.prop *ro.product.device*中的值是 saga, pyramid或努力。

我已经有一个包含更多按钮的布局文件。（只有 3 个带有意图的普通按钮）当按钮出现时，它应该是对新活动 onclick 的意图。（但我可以处理。）

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:17:32.473

```
 if (System.getProperty("ro.product.device", "bollocks").equals("saga") ||
        System.getProperty("ro.product.device", "bollocks").equals("pyramid") ||
        System.getProperty("ro.product.device", "bollocks").equals("endeavoru")) {
        myDopeButton.setVisiblity(View.VISIBLE);
    } 
```

# macos - rlwrap mac os x 安装错误

> ID：15093519
> 
> 赞同：1
> 
> 时间：2013-02-26T14:52:02.687
> 
> 标签：macos, command-line, sqlplus, rlwrap

我正在尝试将 RLWrap 安装到我的 mac os x (Snow Leopard) 中，我有 XCode 并且能够`./configure`成功运行该命令，但是当我尝试该`make`命令时，我收到以下错误：

> make all-recursive 在 doc make[2] 中制作所有内容：对“所有”无事可做。全部在 src gcc -DHAVE_CONFIG_H -I. -I..
> -DDATADIR=\"/usr/local/share\" -g -O2 -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.c main. c: In function 'read_options_and_command_name': main.c:775: error: 'rl_basic_quote_characters' undeclared (第一次在这个函数中使用) main.c:775: error: (每个未声明的标识符只报告一次 main.c:775: error : 对于它出现的每个函数。) make[2]: *** [main.o] Error 1 make[1]:****[all-recursive] 错误 1 ​​make: ** * [all] 错误 2*

 *有人对此原因有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:36:45.873

It looks as though there's a bogus libreadline on OS X:

```
oldhost:rlwrap-0.37 boxcat$ ls -l /usr/lib/libreadline.dylib 
lrwxr-xr-x  1 root  wheel  15 16 Mar 14:25 /usr/lib/libreadline.dylib -> libedit.3.dylib
oldhost:rlwrap-0.37 boxcat$ 
```

I think you'll need a genuine libreadline (i.e. the GNU version) installed first.*

# wordpress - htaccess 重写问题

> ID：15093522
> 
> 赞同：0
> 
> 时间：2013-02-26T15:54:31.373
> 
> 标签：wordpress, .htaccess, mod-rewrite, joomla

我有一个旧的 Joomla 网站，我想迁移到 WordPress。我们的 Joomla 网站上有很多旧新闻，就像这样……</p>

```
/home/news-and-offers/news/476-new-bridal-boutique-posh-frocks-has-opened.html
/home/news-and-offers/news/594-fabulous-new-offer-from-hall-hotel-and-spa-in-birmingham.html
/home/news-and-offers/news/596-win-your-dress-for-free-this-week-at-berketex-bride.html
/home/news-and-offers/news/602-ask-alice-get-your-big-day-questions-answered.html
/home/news-and-offers/news/637-get-down-to-the-west-countrys-largest-wedding-exhibitions.html 
```

我想批量重定向到…</p>

```
/category/wedding-news/ 
```

我将如何编写一个正则表达式来实现这一点，因为我不想将所有这些文章添加到我的 htaccess 文件中。

在此先感谢，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:02:03.827

把这样的东西`/.htaccess`重定向`/home/news-and-offers`到`/category/wedding-news`：

```
RewriteEngine on
RewriteRule ^/home/news-and-offers/ /category/wedding-news/ [R=301] 
```

# google-apps-script - DocsList getSize() 总是返回零

> ID：15093526
> 
> 赞同：1
> 
> 时间：2013-02-26T15:54:41.233
> 
> 标签：google-apps-script

```
Logger.log(DocsList.getRootFolder().getFolders()[0].getSize()); //returns zero
Logger.log(DocsList.getRootFolder().getFiles()[0].getSize()); //returns zero 
```

有小费吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:25:02.007

AFAIK这是正常行为......一个谷歌文件夹没有大小......你得到的第一个文件可能是一个谷歌文档（或电子表格），它也没有大小（这意味着它不占用空间，只有“外国文件”占用驱动器存储空间）。

[DRIVE UI](http://support.google.com/drive/bin/answer.py?hl=en&answer=2736257&p=storage_overview)中清楚地解释了这一点，当他们告诉您您有 5 GB 的免费存储空间以及如何考虑这一点时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:23:15.003

Folder.getSize () 不是文档化的方法。因此，很难说预期的输出是什么。如果您要获取根文件夹中的文件夹数量，请使用

```
Logger.log(DocsList.getRootFolder().getFolders().length); 
```

# sql - 使用逗号分隔值的 SQL 查询

> ID：15093527
> 
> 赞同：2
> 
> 时间：2013-02-26T15:54:47.203
> 
> 标签：sql, sql-server, tsql

我有一个要求，其中我有 3 张桌子

**联系方式**

```
idContactinfo  FirstName  Lastname      idCOmpanyid
---------------------------------------------------
1               Blah1      Blah1            1
2               Blah2      Blah2            1
3               Blah3      Blah3            1
4               Blah4      Blah4            1 
```

**联系人角色**

```
idcontactrole     IdContactRoleName      idContactInfo   
------------------------------------------------------
1                       1                     1
2                       1                     2
3                       1                     3
4                       2                     4 
```

**IdContactRoleLookup**

```
idcontactRole           RoleName
----------------------------------
1                        Admin
2                        Secretary 
```

我需要一个给我这样的结果的查询

```
idcontactrolename            Contacts
--------------------------------------------------------
Admin                    Blah1,Blah1;Blah2,Blah2,Blah3,Blah3
Secretary                Blah4,Blah4 
```

这是我到现在为止的！

```
SELECT l.sValue
    , SUBSTRING((
                        SELECT C.sLast + ',' + C.sFirst + ';'
                        FROM contactinfo c
                        inner join contactrole crole
                        ON crole.idcontactinfo = c.idcontactinfo
                        WHERE crole.idcompany = '<<blah>>'
                        and c.idcompany = '<<blah>>'
                        FOR XML PATH('')

                    ), 1, 1000000)
FROM CONTACTROLE CR
inner join contactinfo c on 
cr.idcontactinfo = c.idcontactinfo 
inner join lookupdata l on cr.idlookuprole = l.idlookupdata
where c.idcompany = '<<blah>>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:05:13.890

```
SELECT
     RoleName,
     STUFF(
         (
            SELECT  ';' + b.FirstName + ', ' + b.LastName
            FROM    ContactRole a
            INNER JOIN ContactInfo b
                  ON a.idContactInfo = b.idContactinfo
            WHERE   a.IdContactRoleName = r.idcontactRole
            FOR XML PATH (''))
            , 1, 1, '')  AS NamesList
FROM  IdContactRoleLookup r
GROUP BY idcontactRole, RoleName 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/f7c7f/10)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:03:27.627

我会做这样的事情，您将主查询的 ID 用于您的子查询

```
SELECT     
l.sValue
    , SUBSTRING((
                        SELECT C.sLast + ',' + C.sFirst + ';'
                        FROM contactinfo c
                        inner join contactrole crole
                        ON crole.idcontactinfo = c.idcontactinfo
                        WHERE c.idcompany = '<<blah>>'
AND c.idcontactrole = CR.idcontactrole
                        FOR XML PATH('')

                    ), 1, 1000000)

FROM CONTACTROLE CR
inner join lookupdata l on cr.idlookuprole = l.idlookupdata 
```

这将为您提供一个公司的所有角色。如果角色不存在，您将有一个 NULL 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T16:09:37.490

您可以使用`CROSS APPLY`来获得结果：

```
select distinct l.RoleName,
  left(list, len(list) -1) list
FROM CONTACTROLE CR
inner join IdContactRoleLookup l 
  on cr.IdContactRoleName = l.idcontactRole
cross apply
(
  select C1.Lastname + ',' + C1.FirstName + ';'
  from CONTACTROLE CR1
  inner join contactinfo c1
    on cr1.idContactInfo = c1.idContactinfo
  where cr.IdContactRoleName = cr1.IdContactRoleName
  FOR XML PATH('')
) t2 (list) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c85e0/32)

# sql - 我可以将 LIKE 与 SQL 变量一起使用吗？

> ID：15093534
> 
> 赞同：1
> 
> 时间：2013-02-26T15:55:11.593
> 
> 标签：sql, sybase

我有一个看起来像这样的查询：

```
select * from Table1 where name like '%ASD%' 
```

我想改变它，以便我可以做这样的事情：

```
declare @name1 varchar(255)
select @name1 = 'dfg'
select * from Table1 where name like @name1 
```

我应该如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T15:56:35.477

尝试：

```
SELECT * 
FROM Table1 
WHERE name LIKE '%' + @name1 + '%' 
```

而`SET @name1 = 'dfg'`不是`SELECT @name1 = 'dfg'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T15:56:47.310

用于`SET`为 分配一个值`@name1`，并确保将其设置为所需的搜索字符串（您通常将其视为以百分号开头、以一个结尾或两者兼有）：

```
set @name1 = '%dfg%' 
```

# ios - 推送时 SVPullToRefresh 不触发操作处理程序

> ID：15093537
> 
> 赞同：0
> 
> 时间：2013-02-26T15:55:16.347
> 
> 标签：ios, objective-c, xcode, uitableview

第一个触发器没问题，但在那之后，如果我尝试将其拉下，它总是显示它仍在加载。

这是我的 UITableViewController 上的简单代码示例：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    __weak StoresViewController * bSelf = self;
    [self.tableView addPullToRefreshWithActionHandler:^{
        [bSelf callStoresService];
    }];
    [self.tableView triggerPullToRefresh];
}

- (void)callStoresService {
    [self.tableView.pullToRefreshView stopAnimating];
} 
```

添加一个断点，`[self.tableView.pullToRefreshView stopAnimating];`我可以看到它再也不会被调用......

我有一个旧项目，其代码几乎相同，并且可以正常工作……我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:15:59.753

由于我只为 iOS 6 开发，我决定使用原生刷新：

在我的 viewDidLoad 上：

```
// managing pullToRefresh
UIRefreshControl *refresh = [[UIRefreshControl alloc] init];
refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Pull down to refresh"];
[refresh addTarget:self action:@selector(refreshView:) forControlEvents:UIControlEventValueChanged];
self.refreshControl = refresh;
[self refreshView:refresh];
[self.refreshControl beginRefreshing]; 
```

然后创建一个 refreshView 方法：

```
-(void)refreshView:(UIRefreshControl *)refresh {
    refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Refreshing..."];
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"dd/MM HH:mm:ss"];

    // do what you need

    NSString *lastUpdated = [NSString stringWithFormat:@"Last update: %@", [formatter stringFromDate:[NSDate date]]];
    refresh.attributedTitle = [[NSAttributedString alloc] initWithString:lastUpdated];
} 
```

`[refresh endRefreshing];`完成后别忘了打电话

# c++ - 链接器生成不同的代码（objdump）

> ID：15093539
> 
> 赞同：0
> 
> 时间：2013-02-26T15:55:23.247
> 
> 标签：c++, linker, gnu, vxworks

我有一个生成共享库的生成文件。从不同的 shell（VxWorks wrenv 和 Cygwin）调用 make 会产生不同的库。你的 VxWorks 版本不能在 Cygwin 版本上运行。差异非常小，并且在`readelf`程序中不可见。

使用`objdumparm -S *.so`显示函数末尾的差异。请参阅以下输出。

示例1：（最后两行不同）

赛格温：

```
00010a14 <_ZN3rag3MD511save_digestEPhPKm>:
10a14:  e1a0c00d    mov ip, sp
10a18:  e92dda30    push    {r4, r5, r9, fp, ip, lr, pc}
...
10b18:  00000000    andeq   r0, r0, r0
10b1c:  3b6e71a1    blcc    1bad1a8 <_stack+0x1b2d1a8>
10b20:  505c3d7f    subspl  r3, ip, pc, ror sp 
```

VxWorks：

```
00010a14 <_ZN3rag3MD511save_digestEPhPKm>:
10a14:  e1a0c00d    mov ip, sp
10a18:  e92dda30    push    {r4, r5, r9, fp, ip, lr, pc}
...
10b18:  00000000    andeq   r0, r0, r0
10b1c:  00000338    andeq   r0, r0, r8, lsr r3
10b20:  0000033c    andeq   r0, r0, ip, lsr r3 
```

或示例 2：（最后一行不同）

赛格温：

```
00010b7c <_ZN3rag3MD55beginEv>:
10b7c:  e1a0c00d    mov ip, sp
10b80:  e92dda10    push    {r4, r9, fp, ip, lr, pc}
...
10bd4:  e89daa10    ldm sp, {r4, r9, fp, sp, pc}
10bd8:  00000000    andeq   r0, r0, r0
10bdc:  695c7960    ldmdbvs ip, {r5, r6, r8, fp, ip, sp, lr}^ 
```

VxWorks：

```
00010b7c <_ZN3rag3MD55beginEv>:
10b7c:  e1a0c00d    mov ip, sp
10b80:  e92dda10    push    {r4, r9, fp, ip, lr, pc}
...
10bd4:  e89daa10    ldm sp, {r4, r9, fp, sp, pc}
10bd8:  00000000    andeq   r0, r0, r0
10bdc:  000005ec    andeq   r0, r0, ip, ror #11 
```

链接器的参数是相同的。这些差异是否来自搬迁过程？

可以说为什么会发生这种情况，原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T10:05:36.417

嗯，链接器不是坏人！发现编译器正在生成不同的 .sho 对象。使用`-fno-builtin`编译.sho的选项确实消除了差异......

# coffeescript - 在 CoffeeScript 类中覆盖 toString

> ID：15093546
> 
> 赞同：2
> 
> 时间：2013-02-26T15:55:39.140
> 
> 标签：coffeescript

我在 CoffeeScript 中创建了一个类，我想覆盖该`toString()`函数；这是我的代码：

```
class MenuController

  constructor: () ->
    'constructor'

  toString: () ->
    'MenuController'

console.log MenuController.toString() 
```

然而`toString()`返回：

```
function MenuController() {
  'constructor';
} 
```

而不是`MenuController`。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:56:55.980

您定义`toString`为类方法。因此，您可以将其称为：

```
menuController = new MenuController()
menuController.toString() 
```

如果静态方法确实是您想要的，那么您应该使用以下语法：

```
class MenuController
  @toString: ->
    'MenuController' 
```

然后，您将可以这样称呼它：

```
MenuController.toString() 
```

但是，它将不再是一个类方法，所以

```
(new MenuController()).toString() 
```

不会调用你的`toString`方法。

# sql - 在庞大的数据集中存储词频

> ID：15093553
> 
> 赞同：1
> 
> 时间：2013-02-26T15:55:57.080
> 
> 标签：sql, word-frequency

我正在研究文档聚类问题，为此我需要获取文档数据集的词频。

目前，我正在使用一种简单的方法：我创建一个单词表，并添加与数据集包含的文档数量一样多的列，获得类似

```
word | document1 | document2 | ... | document n | 
```

这种方法，即使有点慢，也适用于小型数据集（包含少于 100 个文档）。问题是现在我必须处理巨大的文件，每个文件包含 700 多个文件，我觉得必须有更聪明的方法来处理它：问题是，我想不出其他任何东西。

所以，问题是：如何有效地跟踪每个文档的词频？

PS：考虑到每个文档的单词数或数据集大小都是未知的，但合理的上限应该是每个文档 2000 个单词，每个数据集 2000 个文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:04:34.420

我假设您实际上对开发自己的算法感兴趣，而不是对 MySQL、SQL Server、Oracle 等数据库的全文功能感兴趣。

术语文档矩阵——我知道这个数据结构的术语——将与两列一起作为键存储：DocumentID 和 TermID。

您可能有额外的列用于计算文档中的术语、文档中的位置或其他任何内容，但这两个键是标准方式。

这些通常会链接到文档和条款的表格。文档表通常包含文档中的术语数量、位置（或文本本身）和其他信息。术语表通常具有术语的权重，可能还有其他信息，例如同义词列表、词性等。

然后，当您要添加新文档时，只需处理术语并将它们添加进去。添加新术语。. . 好吧，这需要处理该术语的历史文档，但这仍然很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:02:22.187

一个更相关的表设计如下所示：

```
CREATE TABLE DOC_WORD_COUNTS AS
(
    DocID As INT Not NULL,
    Word As VARCHAR(20) Not NULL,
    Frequency As INT Not NULL
) 
```

然后将 (DocID + Word) 作为主键。您还需要另一个表来存储文档的信息，包括 DocID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:04:41.110

创建如下数据结构：

*   **文档表**：DocumentId (PK)、DocumentName
*   **字表**：WordId(PK)、DocumentId(FK)、WordName

这样，您可以运行一些聚合查询来报告数据。

# xamarin.android - 如何使 Zxing.Net 的可移植库与 mvvmcross 一起使用？

> ID：15093554
> 
> 赞同：0
> 
> 时间：2013-02-26T15:55:58.633
> 
> 标签：xamarin.android, zxing, mvvmcross

我想扫描条码，Zxing.Net 看起来不错，但我需要一个便携版本，以便我可以在我的项目中使用（monodroid/WP/IOS/MVVMCROSS）。我将在 ViewModel 中使用这个便携版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T21:17:21.267

我添加了一个项目文件和其他一些为 PCL 构建 ZXing.Net 所需的小改动。您可以从 codeplex 的源代码存储库中获取它。您必须构建自己的版本，因为目前没有预构建的二进制文件。下一个版本将包含它。PCL 版本的限制是您必须处理 RGB 数据。您不能使用特定于平台的类，如 Bitmap、WriteableBitmap、BitmapSource 或 Color32。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-14T20:00:41.980

不确定这是否仍然相关或需要，但我找不到 MvvmCross 的 ZXing 插件，所以我最终构建了一个：[https](https://github.com/asednev/MvvmCross.Plugins.ZXing) ://github.com/asednev/MvvmCross.Plugins.ZXing 。暂时只有安卓。更多即将到来。

# c++ - 动态数组地址

> ID：15093563
> 
> 赞同：0
> 
> 时间：2013-02-26T15:56:31.287
> 
> 标签：c++

我有这段代码，它通过指针返回动态数组的地址..但是如何通过引用返回动态数组的地址？谢谢你..

```
int* e(int a[][2],int rows)
{
    int *p;

    p=new int[2];

    int max,min;

    max=min=a[0][0];

    int i,j;
    for(i=0;i<rows;i++)
    {
        for(j=0;j<2;j++)
        {
            if(min>a[i][j])
                min=a[i][j];
            else if(max<a[i][j])
                max=a[i][j];
            else;
        }
    }

    p[0]=min;
    p[1]=max;
    delete []p;
    return p;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:02:57.030

在这种情况下，“通过引用返回（ing）动态数组的地址”将归结为`p`通过引用返回，但`p`它是一个局部变量，所以当函数退出时内存会被释放，所以这不起作用。

**如果你真的想要，这应该可以工作：（**但我**强烈**怀疑这是你应该做的，并且可能会导致内存泄漏）

```
int* &e(int a[][2],int rows)
{
  int **p = new int*;
  *p = new int[2];
  ...
  return *p;
} 
```

**请注意，这没有意义：**

```
delete []p;
return p; 
```

您正在释放内存，然后返回指向它的指针。

只需删除删除，一切都应该没问题（或至少接近正常）。

# android - Android，解析 422 响应返回的 json 时出现问题

> ID：15093564
> 
> 赞同：3
> 
> 时间：2013-02-26T15:56:31.367
> 
> 标签：android, json

我的 Web 服务器以 422 无法处理的实体错误响应并呈现带有错误列表的 json 响应，例如

```
{"name":["has already been taken"]} 
```

出于某种原因，尽管我的 android 应用程序拒绝承认响应中有任何 json。

```
HttpResponse response = HttpRequest.httpPostJSONObject(this, Urls.getUrlForAccountTeams(this), tm.getJsonObject(), token);
int code = response.getStatusLine().getStatusCode();
if (code == 422){
    String responseJson = EntityUtils.toString(response.getEntity());
    JSONObject responseEntity = new JSONObject(responseJson);
    Log.i(TAG, "Created account errors " + responseEntity.toString());
} 
```

上述日志消息的以下输出是

```
I/ServiceRefreshData(  780): Server response 422
I/ServiceRefreshData(  780): Created account errors {} 
```

如果我使用 curl 通过发布与我的 android 应用程序发送的完全相同的消息来模拟这一点，我会得到如上所示的 json `{"name":["has already been taken"]}`，这正是我期望在我的 android 应用程序中看到的

关于如何获取 json 的任何想法。我在解析成功的 json 响应方面没有问题

发送 json 的请求使用 org.apache.http.HttpResponse 作为 post 请求的结果

```
 public static HttpResponse httpPostJSONObject(Context context, String url, JSONObject data, String token) throws ClientProtocolException, IOException{
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(url);
        setHeaders(httppost, token);
        StringEntity se = new StringEntity(data.toString());

        httppost.setEntity(se);
        return httpclient.execute(httppost);
    } 
```

**更新**为了更清楚，我的 setHeaders 方法看起来像这样

```
private static void setHeaders(HttpRequestBase httpget, String token) {
    httpget.addHeader("Accept", "application/json");
    httpget.addHeader("Content-Type", "application/json; charset=UTF-8");
    if(token != null){
        httpget.addHeader("Authorization", "Token token="+token);
    }
} 
```

为了完整起见，生成此 json 的网络服务器（Rails 3.2.12）上的代码是

```
respond_to do |format|
  if @team.save
    format.html { redirect_to @team, notice: 'Team was successfully created.' }
    format.json { render json: @team, status: :created, location: [:api, @team] }
  else
    format.html { render action: "new" }
    format.json { render json: @team.errors, status: :unprocessable_entity }
  end
end 
```

**根据评论**更新更多调试信息更改我的日志消息的结果，因此我发送数据的方法现在看起来像这样****

 **```
 try {
            HttpResponse response = HttpRequest.httpPostJSONObject(this, Urls.getUrlForAccountTeams(this), tm.getJsonObject(), token);
            int code = response.getStatusLine().getStatusCode();
            Log.i(TAG, "Server response " + code);
            if (code == 422){
                String responseJson = EntityUtils.toString(response.getEntity());
                JSONObject responseEntity = new JSONObject(responseJson);
                Log.i(TAG, "Created account errors Response Entity " + responseEntity.toString());
                Log.i(TAG, "Created account errors Response " + response.toString());
                Log.i(TAG, "Created account errors ResponseJson " + responseJson.toString());
            }
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

并生产

```
I/ServiceRefreshData(  814): Server response 422
I/ServiceRefreshData(  814): Created account errors Response Entity {}
I/ServiceRefreshData(  814): Created account errors Response org.apache.http.message.BasicHttpResponse@44ec4978
I/ServiceRefreshData(  814): Created account errors ResponseJson {} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:06:42.197

好吧，我认为您需要指定这样的标题：

```
HttpPost httppost = new HttpPost(url);
httppost.setHeader("Accept", "application/json");
httppost.setHeader("Content-type", "application/json"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:43:46.143

重新启动我的电脑后问题就消失了。我真的对这整个情节感到困惑。我确信我的代码是正确的，并且日志输出证明它不是。我只能把它归结为一些完全深不可测的缓存问题。

非常感谢那些帮助过的人。**

# performance - 有没有比这个更好的方法（性能）计算斐波那契？

> ID：15093566
> 
> 赞同：5
> 
> 时间：2013-02-26T15:56:32.230
> 
> 标签：performance, algorithm, fibonacci

我制作了这段代码..我需要充分利用它..我真的需要计算斐波那契数的最佳性能..请帮助..

我已经阅读了一些此类计算的代码，我认为我得到了最好的..

帮我解决这个问题.. plz ..

ps：我真的需要BigInteger ..我将计算大量数字的斐波那契

ps2：我用这个算法计算了一些大数字，我得到了很好的响应时间..但我需要知道它是否可以更好

ps3：要运行此代码，您需要使用此 VM 参数`-Xss16384k`(StackSize)

```
public class Fibonacci {

    private static BigInteger[] fibTmp = { BigInteger.valueOf(0), BigInteger.valueOf(1) };

    public static BigInteger fibonacci(long v) {

        BigInteger fib = BigInteger.valueOf(0);

        if (v == 1) {

            fib = BigInteger.valueOf(1);

        } else if (v == 0) {

            fib = BigInteger.valueOf(0);

        } else {

            BigInteger v1 = fibonacci(v - 1);
            BigInteger v2 = fibTmp[(int) (v - 2)];

            fib = v1.add(v2);
        }

        synchronized (fibTmp) {

            if (fibTmp.length - 1 < v)
                fibTmp = Arrays.copyOf(fibTmp, (int) (v + 10));

            fibTmp[(int) v] = fib;
        }

        return fib;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T16:15:38.680

是的，有更好的方法。这是一种`log(n)`经过测试且非常有效的方法，用于计算具有任意精度的斐波那契值，给定一个正整数作为输入。该算法改编自[SICP](https://mitpress.mit.edu/sicp/full-text/book/book.html)[练习 1.19](https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.4)的解决方案：

```
public static BigInteger fibonacci(int n) {

    int count = n;
    BigInteger tmpA, tmpP;
    BigInteger a = BigInteger.ONE;
    BigInteger b = BigInteger.ZERO;
    BigInteger p = BigInteger.ZERO;
    BigInteger q = BigInteger.ONE;
    BigInteger two = new BigInteger("2");

    while (count != 0) {

        if ((count & 1) == 0) {
            tmpP = p.multiply(p).add(q.multiply(q));
            q = two.multiply(p.multiply(q)).add(q.multiply(q));
            p = tmpP;
            count >>= 1;
        }

        else {
            tmpA = b.multiply(q).add(a.multiply(q).add(a.multiply(p)));
            b = b.multiply(p).add(a.multiply(q));
            a = tmpA;
            count--;
        }

    }

    return b;  

} 
```

在本书的链接章节中，解释了它是如何工作的（向下滚动到练习 1.19），并指出：

> 这是一种以对数步数计算斐波那契数的巧妙算法……此练习由 Joe Stoy 建议，基于安妮 Kaldewaij 中的一个示例。1990.*编程：算法的推导*。

当然，如果需要一遍又一遍地计算相同的值，可以通过[记忆](https://en.wikipedia.org/wiki/Memoization)已经计算的结果来进一步提高性能，例如使用映射来存储以前的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T16:08:47.103

您的实现不适用于任何体面的数字，因为它会使堆栈溢出。

我看不出有任何理由在这里使用递归。递归性很漂亮，但通常更重（它取决于语言）。这是一个带有简单`for`循环的工作实现：

```
private static BigInteger[] fibTmp = {BigInteger.ZERO, BigInteger.ONE};
private static int maxCached = 1;
public static BigInteger fibonacci(int v) {
    if (fibTmp.length<=v) {
        fibTmp = Arrays.copyOf(fibTmp, v*5/4);
    }
    for (; maxCached<v;) {
        maxCached++;
        BigInteger v1 = fibTmp[maxCached - 1];
        BigInteger v2 = fibTmp[maxCached - 2];
        fibTmp[maxCached] = v1.add(v2);
    }
    return fibTmp[v];
} 
```

这是一种直接实现，无需在文献中寻找有效的斐波那契算法。你最好去找他们。

另请注意，这种基于缓存的实现是内存成本高的，并且只有在多次调用该函数时才有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:12:13.000

首先，您使用的是递归，这在时间和空间复杂性方面都不是很有效。您应该使用迭代方法。

然后，如果额外的内存或空间不会破坏并且性能确实很关键，那么您可能需要预先计算所有您想稍后计算的数字并将它们存储在数组或磁盘中，如果它对您来说太多的话记忆。稍后您可以在恒定时间内获得该值。

# matlab - 将完整矩阵转换为完整矩阵很慢？

> ID：15093569
> 
> 赞同：4
> 
> 时间：2013-02-26T15:56:36.743
> 
> 标签：matlab, matrix, sparse-matrix

我注意到将已经完整的矩阵转换为完整的矩阵很慢：

```
>> tic; for k = 1:100; x = uint16(ones(10000,100)); end; toc
Elapsed time is 0.035748 seconds.
>> tic; for k = 1:100; x = uint16(uint16(ones(10000,100))); end; toc
Elapsed time is 0.034180 seconds.
>> tic; for k = 1:100; x = full(uint16(ones(10000,100))); end; toc
Elapsed time is 0.460977 seconds. %%%%% SLOW! 
```

我也没有进行测试`uint16`：

```
>> tic; for k = 1:100; x = ones(10000,100); end; toc
Elapsed time is 0.060028 seconds.
>> tic; for k = 1:100; x = full(ones(10000,100)); end; toc
Elapsed time is 0.229058 seconds. %%%%% SLOW! 
```

一样的效果。

为什么是这样？`full`应该只将稀疏矩阵转换为完整矩阵。如果它已经满了，它不应该什么都不做吗？

编辑：`issparse`超快！我想作为 MEX，主要是内存成本？

Mac OS X 上的 MATLAB 版本 7.13.0.564 (R2011b)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:30:03.953

**Disclaimer:** This is my best guess about what is happening, but I don't know for sure what goes on under Matlab's hood. **Update:** In a comment, [EitanT](https://stackoverflow.com/users/1336150/eitant) pointed out that my guess is most likely wrong.

I think that Matlab's [JIT engine](http://en.wikipedia.org/wiki/Just-in-time_compilation) is doing optimizations in some of these cases, but not all.

When you have a loop where a variable is created but never used, the JIT engine doesn't bother creating that variable over and over. It just does it once. Anything like this will be fast:

```
% this calls 'ones' once
for i = 1:100, x = ones(10000,100); end 
```

But if you create a variable and then use it, say by passing it to a function, that variable is created every time. This takes more time, obviously.

```
% this calls 'ones' every iteration to pass to `full`
for i = 1:100, x = full(ones(10000,100)); end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:12:34.107

`full` works just fine.

The slow part is actually the `ones(10000, 100)`... here's the proof:

```
>> tic, for k = 1:100, x = ones(10000,100); end, toc
Elapsed time is 0.043143 seconds.

>> A = ones(10000,100);
>> tic, for k = 1:100, x = full(A); end, toc
Elapsed time is 0.000081 seconds. 
```

`full` is invoked with a non-sparse matrix and runs fast, hence it is not the reason for the slowdown.

# c# - 如何处理对象内部的 List 对象？

> ID：15093572
> 
> 赞同：1
> 
> 时间：2013-02-26T15:56:42.463
> 
> 标签：c#, asp.net, oop

我有一堂课：

```
public class Kit
{
    private int _CK_ID = 0;
    private String _CK_Title = "";
    private String _CK_Description = "";

    public int CK_ID
    {
        get { return _CK_ID; }
        set { _CK_ID = value; }
    }

    public String CK_Title
    {
        get { return _CK_Title; }
        set { _CK_Title = value; }
    }

    public String CK_Description
    {
        get { return _CK_Description; }
        set { _CK_Description = value; }
    }

} 
```

每个套件都可以有一个图像列表。

把 a 放在类里面是一件聪明的事`List<Images>`吗？

`List<Kit>`如果是，当我绑定到 a`Repeater`以调用其他属性时，如何调用图像？`<%# Eval("CK_Title")%>`例如，我使用。如何循环所有图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:59:57.347

我不确定我是否完全理解您，这似乎很简单：定义 a`List`并公开属性：

```
private List<SomeType> underlyingSomeList;

public List<SomeType> SomeList { get { return underlyingList; } } 
```

至于访问条目，您可以将属性本身绑定到 a`Repeater`并在`ItemDataBound`事件处理程序中使用 获取单个事物`var thing = e.Item.DataItem as SomeThing`，然后从那里开始，`FindControl`用于访问元素并填充项目的数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T16:00:42.980

在您的转发器中嵌套另一个转发器，并在事件中将`List`对象绑定到它。`ItemDataBound`

*中继器示例*：

```
<asp:repeater id="rep" runat="server">
   <itemtemplate>
      <h2><%# Eval("CK_Title")%></h2>
      <asp:repeater id="imagerep" runat="server">
         <itemtemplate>
             <img src="<%# Eval("URL")%>" />
         </itemtemplate>
      </asp:repeater>
   </itemtemplate>
</asp:repeater> 
```

# angularjs - AngularJS 将 json 绑定到表单输入

> ID：15093575
> 
> 赞同：2
> 
> 时间：2013-02-26T15:56:44.603
> 
> 标签：angularjs, pyramid

我可以使用以下代码轻松地将数据绑定到 div 或 pre 标记：

```
<div id="json_route{{route.id}}" ng-bind="items.route{{route.id}} | json"></div> 
```

但是，我想尝试将此数据绑定到隐藏的表单输入，我尝试过：

```
<input type="hidden" name="json_route{{ route.id }}" 
ng-model="items.route{{route.id}} | json" /> 
```

这给我一个错误：

```
Error: Non-assignable model expression: items.route2 | json (<input type="hidden" name="json_route2" ng-model="items.route2 | json">) 
```

所以很明显我不能使用 | 使用 ng-model 时的 json。角度文档仍然有点稀疏，我似乎无法找到如何正确分配它，即使我可以？谢谢 ：）

我需要将此 json 数据加载到我的金字塔应用程序中，并将其分配到隐藏的表单字段中似乎是最好的方法，还是我应该以不同的方式这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:54:01.930

尝试使用 ng-init：

```
<input type="hidden" name="..." ng-model="items.route{{route.id}}"
 ng-init="items.route{{route.id}} = data_from_server_here"> 
```

另请参阅[https://stackoverflow.com/a/12657601/215945](https://stackoverflow.com/a/12657601/215945)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:12:07.343

“*为了能够将模型渲染到视图中，模型必须能够从范围内引用。* ”（src：[Angular Guide](http://docs.angularjs.org/guide/concepts#model)）。

Angular 需要能够将 ngModel 表达式中的值引用到控制器中的 $scope 变量。

使用 ng-bind 它可以工作，因为 ng-bind 与 ng-model 不同。ngBind*简单地*获取您的表达式并在当前范围内对其进行评估，然后用结果替换宿主元素的文本。正如 Guide 告诉我们的， ng-model 的值必须是一个*可分配的角度表达式来 data-bind to*。

要让隐藏的输入包含“items.route2”模型的 json 字符串表示，您可以在控制器中设置一个 $watch 表达式，该表达式将在模型的 json 字符串发生更改时“准备”它。请参阅[plnkr 示例](http://embed.plnkr.co/PloDcOzMWdx1aFNWTvfp/preview)。

# c++ - 如何将 warn() 的输出转换为字符串？

> ID：15093579
> 
> 赞同：1
> 
> 时间：2013-02-26T15:56:48.113
> 
> 标签：c++, error-handling, bsd

`warn()`如果无法打开文件，我正在使用非标准函数（由 BSD 提供）输出错误消息，如下所示：

```
std::string path = get_path() ;
std::ifstream file(path) ;
if (file.is_open()) { /* do something */ }
else {
    warn("%s", path.c_str()) ;
    // uses errno to figure out what the error was and outputs it nicely along with the filename
} 
```

这对于输出它来说非常好，但是如果我想在其他地方使用整个字符串，除了打印它怎么办？这些`warn()`函数似乎没有将错误写入字符串的形式。我试过自己动手，但相比之下似乎非常麻烦（除了没有得到程序的名称）：

```
this->foo((boost::format("%s: %s") % path % strerror(errno)).str()) ; 
```

那么如何将`warn()`'s 输出作为字符串呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:08:01.527

`warn`将其输出放在标准错误输出上。因此，您必须创建一种机制来将标准错误输出重定向到可以读回字符串的位置。最直接的方法可能是将标准错误重定向到文件，然后将文件作为字符串读回。例如，您可以尝试使用`dup2()`来完成此操作（如[对此问题](https://stackoverflow.com/questions/5095839/redirect-from-stderr-to-another-file-descriptor)的答案中所述）。

但是，包装您自己的版本`warn`可能是更好的选择。不过，您可以考虑使用 C`vsnprintf()`函数来实现它。[这个问题](https://stackoverflow.com/q/69738/315052)的答案可以同时解决 using`boost::format`和`vsnprintf()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:16:13.727

您的旋转似乎会产生类似于以下内容的结果：

```
path + ": " +  strerror(errno); 
```

猜测一下，它所包含的“程序名称”可能只是`argv[0]`，因此您显然可以生成与您的大致等价的`warn`仅返回 a`std::string`并按此一般顺序返回的内容：

```
std::string warn_s(std::string const &path) { 
    char *pname = strrchr(argv[0], '/');
    if (pname == NULL)
        pname = argv[0];
    return path + pname + ":  " + strerror(errno);
} 
```

这里的主要困难是它`argv`是本地的`main`，因此您可能需要将其保存到 main 中的可访问位置，或者使用一些非标准机制在您的函数中重新检索该数据。

不幸的是，`warn`我能找到的文档很差，如果你想精确地复制它的输出，可能需要进行一些测试/试验和错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:08:29.737

你是对的——没有`sprintf`类比（即没有假设`swarn`函数）。

你的方法似乎可行。

# python - Pandas 安装需要 NumPy 1.6.1

> ID：15093582
> 
> 赞同：3
> 
> 时间：2013-02-26T15:56:55.243
> 
> 标签：python, numpy, pandas

我在 OS X 上安装 pandas 时遇到了一些问题。我尝试通过 pip 安装：

```
sudo pip install pandas 
```

并得到错误：

```
pandas requires NumPy >= 1.6.1 due to datetime64 dependency 
```

当我启动 python 解释器时，我得到了我的 NumPy 版本：

```
import numpy
numpy.__version__
'1.7.0' 
```

我试过通过pip卸载numpy，重新安装1.6.1，通过上述方法确认1.6.1安装，再次用pip安装pandas；同样的错误信息。

我也试过下载 pandas-master 分支并安装

```
python setup.py 
```

并收到

```
install requires: 'python-dateutil < 2','numpy'.  use pip or easy_install.
   $ pip install 'python-dateutil < 2' 'numpy' 
```

对接下来的步骤有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T00:41:51.787

我最近从 Windows 切换到 OS X，并且对使用 pip 的 numpy / scipy / matplotlib 等感到头疼。在 Windows 上，我喜欢*pythonxy*[发行](http://code.google.com/p/pythonxy/)版。我终于为 OS X 找到了类似的东西：[Scipy Superpack](http://fonnesbeck.github.com/ScipySuperpack/)。它对我来说非常出色，包括 Pandas。

# jquery - JSON.parse 错误保护

> ID：15093586
> 
> 赞同：1
> 
> 时间：2013-02-26T15:57:12.040
> 
> 标签：jquery, json

我的脚本从 cookie 中获取了一些字符串化的 json 数据。

```
var cookie = $.cookie('someKey');
if (typeof(cookie) == 'string') {
    var fromCookie = JSON.parse(cookie);
} 
```

数据通过cookie来自用户，所以我想确定它是json。如果不是 json，脚本会因错误而停止

```
SyntaxError: JSON.parse: end of data after property value in object
var fromCookie = JSON.parse(cookie); 
```

如何检查数据并从**Cokie**获取错误而*不是*出错

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T15:58:46.253

你想要一个`try catch`块：

```
var fromCookie;
try {
    fromCookie = JSON.parse(cookie);
} catch (e) {
    fromCookie = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T16:01:23.340

> 如果要解析的字符串不是有效的 JSON，则会引发 SyntaxError 异常。

根据[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)。

您应该将它包围在 try/catch 块中，以捕获异常：

```
var cookie = $.cookie('someKey');
if (typeof(cookie) == 'string') {

    var fromCookie = false;

    try {
        fromCookie = JSON.parse(cookie);
    } catch (e) {
        fromCookie = false;
    }
} 
```

你真的不需要在这里测试 cookie 是否是一个字符串，但我把它留了下来，以防你还有其他代码要执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T15:59:24.943

除非你想写一个完整的 JSON 解析器，否则我建议使用`try-catch`.**

# ruby-on-rails - 如何使用 FactoryGirl 发送参数（而不是手动发送参数作为哈希）？

> ID：15093588
> 
> 赞同：9
> 
> 时间：2013-02-26T15:57:20.260
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, factory-bot

我有以下有效的 rspec 测试：

```
 it "redirects to the created api_key" do
    post :create, :api_key => {:api_identifier => "asdfadsf", :verification_code =>
        "12345"}
    response.should redirect_to(ApiKey.last) #(or any other test function)
  end 
```

但我使用工厂女孩，所以我不必手动创建`api_key`s。

**如何复制上述功能，但使用工厂女孩？**

使用：

```
 it "redirects to the created api_key" do
    test = FactoryGirl.build(:api_key)
    post :create, :api_key => test
    response.should redirect_to(ApiKey.last) #(or any other test function)
  end 
```

或者：

```
 it "redirects to the created api_key" do
    post :create, FactoryGirl.build(:api_key)
    response.should redirect_to(ApiKey.last) #(or any other test function)
  end 
```

`:api_key`当我到达我的控制器时，给我该值的空值。

作为参考，这是我的创建操作，该测试正在测试：

```
def create
  @api_key = ApiKey.new(params[:api_key])
  @api_key.user = current_user
  pp @api_key

  respond_to do |format|
    if @api_key.save
      format.html { redirect_to @api_key, notice: 'Api key was successfully created.' }
      format.json { render json: @api_key, status: :created, location: @api_key }
    else
      format.html { render action: "new" }
      format.json { render json: @api_key.errors, status: :unprocessable_entity }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-26T16:00:20.593

尝试：

```
post :create, :api_key => FactoryGirl.attributes_for(:api_key) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:38:16.377

使用`build`实际上并不会创建记录。它只是假装它做到了。使用[`attributes_for`](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#using-factories)将为您提供对象的属性。这主要用于您描述的上下文中。请注意，这*也*不会创建对象。

如果响应成功/重定向，我会这样做：

```
 response.should be_redirect 
```

甚至更好地使用[expect](https://www.relishapp.com/rspec/rspec-expectations/v/2-0/docs/matchers/expect-change)。

# python - request.path 和 url_for 在 mod_wsgi 下的 Flask 中不匹配

> ID：15093593
> 
> 赞同：5
> 
> 时间：2013-02-26T15:57:27.567
> 
> 标签：python, flask, mod-wsgi

在 Flask 中，有没有办法让 request.path 包含任何“装饰”`WSGI`或其他可能添加的东西？

在测试模式下运行（仅在端口 5000 上）， my`request.path`和`url_for('settings')`匹配就好了，但是一旦在 下`WSGI`，正如预期的那样， my`url_for('settings')`变成`/manage/settings/`，但是`request.path`yeilds `/settings/`。

我有以下内容，`httpd.conf`并且正在努力将[应用程序](https://github.com/FernFerret/servermanager)从开发转移到实时站点。

```
WSGIScriptAlias /manage /sw/servermanager/servermanager.wsgi
WSGIDaemonProcess servermgr user=user group=grp threads=4
<Directory /sw/servermanager>
    WSGIProcessGroup servermgr
    WSGIApplicationGroup %{GLOBAL}
    WSGIScriptReloading On
    Order deny,allow
    Allow from all
</Directory> 
```

我喜欢让模板非常通用，然后使用 CSS 动态显示导航信息的想法。我已经使用[此答案](https://stackoverflow.com/questions/8676455/flask-current-page-in-request-variable/8676486#8676486)中提供的技术来构建我的观点，但是当我添加`mod_wsgi`到等式中时会出现问题。

我环顾了请求对象，除了可能使用之外没有看到我想要的那么多，`url_rule`但后来参数避开了我。

只是为了更好地衡量，我正在使用的 WSGI 脚本的链接：[https ://github.com/FernFerret/servermanager/blob/master/servermanager.wsgi](https://github.com/FernFerret/servermanager/blob/master/servermanager.wsgi)

我也对该`request`对象的文档感兴趣，我通过使用内置调试器和`help(request)`.

编辑：我应该说，在运行 mod_wsgi 的 Apache 下，这些 url 不匹配。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T12:09:30.553

这是一个*特性*，而不是一个错误。查看请求中与[URL 相关的属性](http://flask.pocoo.org/docs/api/#flask.Request.path)和[请求对象本身的](http://flask.pocoo.org/docs/api/#incoming-request-data)文档。

您可能想要使用`request.script_root + request.path`.

# c# - WPF Bind IsEnabled 用于未绑定的复选框？

> ID：15093598
> 
> 赞同：0
> 
> 时间：2013-02-26T15:57:49.750
> 
> 标签：c#, wpf, xaml, binding

我有一个网格，其中取消选中/选中标题行中的框在所有行的此列中的框中的每一行上都相同。该列未绑定到视图模型，使用从此处获取的实现：http: [//www.devexpress.com/Support/Center/p/E1263.aspx](http://www.devexpress.com/Support/Center/p/E1263.aspx)

这是带有复选框的列的标记。这将创建一个框，用户单击将行标记为已签名：

```
<dxg:GridColumn FieldName="UnboundCheck" Header="SignOff" UnboundType="Boolean"  Width="85px" Visible="True" >
    <dxg:GridColumn.HeaderTemplate>
        <DataTemplate>
            <dxe:CheckEdit Content="{Binding}"  Checked="CheckEdit_Checked" Unchecked="CheckEdit_Unchecked"/>
        </DataTemplate>
    </dxg:GridColumn.HeaderTemplate>
</dxg:GridColumn> 
```

用户还可以单击每个单独的复选框，但有一个新要求是首先检查用户权限。我需要根据指示用户是否有权选中该框的另一列在每一行上设置 IsEnabled。我尝试添加`CellTemplate`到 GridColumn，并使用如下绑定：

```
 <dxg:GridColumn.CellTemplate>
        <DataTemplate>
             <dxe:CheckEdit Content=" hi" IsEnabled="{Binding CanBeSignedOff,RelativeSource={RelativeSource TemplatedParent},diag:PresentationTraceSources.TraceLevel=High}" />
        </DataTemplate>
    </dxg:GridColumn.CellTemplate> 
```

但是绑定不起作用，并显示错误消息：

```
System.Windows.Data Error: 40 : BindingExpression path error: 'CanBeSignedOff' property not found on 'object' ''CellEditor' (Name='PART_CellEditor')'. BindingExpression:Path=CanBeSignedOff; DataItem='CellEditor' (Name='PART_CellEditor'); target element is 'CheckEdit' (Name=''); target property is 'IsEnabled' (type 'Boolean') 
```

我也试过：

```
{Binding CanBeSignedOff,RelativeSource={RelativeSource AncestorType={x:Type dxg:GridRow}} 
```

但是出现“在'object'''GridRow'上找不到属性”的路径错误

当列无界时，是否可以在单元格上使用绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:02:34.550

改变

```
<dxe:CheckEdit Content=" hi" IsEnabled="{Binding CanBeSignedOff,RelativeSource={RelativeSource TemplatedParent},diag:PresentationTraceSources.TraceLevel=High}" / 
```

到

```
<dxe:CheckEdit Content=" hi" IsEnabled="{Binding DataContext.CanBeSignedOff,RelativeSource={RelativeSource TemplatedParent},diag:PresentationTraceSources.TraceLevel=High}" / 
```

或者

```
<dxe:CheckEdit Content=" hi" IsEnabled="{Binding DataContext.RowData.Row.CanBeSignedOff,RelativeSource={RelativeSource TemplatedParent},diag:PresentationTraceSources.TraceLevel=High}" / 
```

# performance - 子集向量的最有效方法

> ID：15093606
> 
> 赞同：9
> 
> 时间：2013-02-26T15:58:08.563
> 
> 标签：performance, r

我需要计算向量子集的均值和方差。设`x`为向量，并`y`作为观察值是否在子集中的指标。哪个更有效：

```
sub.mean <- mean(x[y])
sub.var  <-  var(x[y]) 
```

或者

```
sub      <- x[y]
sub.mean <- mean(sub)
sub.var  <-  var(sub)
sub      <- NULL 
```

第一种方法不会显式创建新对象。但是是否隐式调用`mean`并执行此操作？`var`或者他们是否在存储的原始向量上工作？

第二个更快是因为它不必进行两次子集化吗？

我关心大型数据集的速度和内存管理。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T16:09:51.233

对长度为 10M 的向量进行基准测试表明（在我的机器上）后一种方法更快：

```
f1 = function(x, y) {
    sub.mean <- mean(x[y])
    sub.var  <-  var(x[y])
}

f2 = function(x, y) {
    sub      <- x[y]
    sub.mean <- mean(sub)
    sub.var  <-  var(sub)
    sub      <- NULL
}

x = rnorm(10000000)
y = rbinom(10000000, 1, .5)

print(system.time(f1(x, y)))
#   user  system elapsed 
#  0.403   0.037   0.440 
print(system.time(f2(x, y)))
#   user  system elapsed 
#  0.233   0.002   0.235 
```

这并不奇怪——必须为函数创建一个新对象`mean(x[y])` *才能*`mean`起作用，即使它没有将其添加到本地命名空间。因此，`f1`必须进行两次子集化（正如您所猜测的那样）会更慢。

# apache-flex - 拖动火花列表在 Flex 移动应用程序中不起作用？附上测试用例和截图

> ID：15093609
> 
> 赞同：2
> 
> 时间：2013-02-26T15:58:19.193
> 
> 标签：apache-flex, flex4, flex4.5, flex4.6, flex-mobile

我想通过用手指拖动来重新排序 Flex 移动应用程序中的列表项。

作为第一步，我从 Adob​​e 文档中复制了示例[Using drag-and-drop with list-based controls](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7cfd.html) - 虽然他们的示例作为 Web 应用程序运行良好，但在下面的移动应用程序中没有任何反应：

![截屏](../Images/78ed5d62db3a56f8d5e676ff7609fe64.png)

为什么它不起作用（比如移动主题中缺少一些皮肤？）

有没有办法让它工作（至少重新排序移动列表中的项目）？

下面是我尝试过的简单测试代码 - 只需将其放入 Flash Builder 中的新空白（即没有导航栏）Flex 移动项目中：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               applicationDPI="160"
               creationComplete="initApp()">

    <s:layout>
        <s:VerticalLayout/>
    </s:layout>

    <fx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;

            private function initApp():void {
                srclist.dataProvider = 
                    new ArrayCollection(['Reading', 'Television', 'Movies']);
                destlist.dataProvider = new ArrayCollection([]);
            }
        ]]>
    </fx:Script>

    <s:HGroup>
        <s:VGroup>
            <s:Label text="Available Activities"/>
            <s:List id="srclist" 
                    allowMultipleSelection="true"
                    dragEnabled="true"
                    dragMoveEnabled="true"/>
        </s:VGroup>

        <s:VGroup>
            <s:Label text="Activities I Like"/>
            <s:List id="destlist" 
                    dropEnabled="true"/>
        </s:VGroup>
    </s:HGroup>

    <s:Button id="b1" 
              label="Reset"
              click="initApp();"/>  

</s:Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:18:22.823

我自己在[此页面](http://flexponential.com/2011/06/21/using-drag-and-drop-with-a-spark-list-in-a-mobile-flex-application/)上找到并尝试了一个超级解决方法。

只需从他的示例中复制类并将自定义 itemRenderer 添加到您的源列表中。

```
 <s:List id="srclist" 
                allowMultipleSelection="true"
                dragEnabled="true"
                dragMoveEnabled="true">
            <s:itemRenderer>
                <fx:Component>
                    <local:DraggableIconItemRenderer decorator="{DragThumb}" />
                </fx:Component>
            </s:itemRenderer>
        </s:List> 
```

向作者致敬！

结果如下：

![在此处输入图像描述](../Images/3f5bd3b94f35432d834f893b9d5f6b10.png)

# c# - 验证字符串作为 XML 属性值是否有效

> ID：15093610
> 
> 赞同：1
> 
> 时间：2013-02-26T15:58:22.873
> 
> 标签：c#, .net, xml

给定一个字符串，我需要确定它作为 XML 中的属性值是否有效。

根据[规范](http://www.w3.org/TR/xml/#NT-AttValue)，不允许使用以下三个字符：

```
<
& (unless used to encode a disallowed character, such as "&amp;")
" or ' (whichever is not used to wrap the value is allowed) 
```

我的测试表明，使用包含任何这些字符的值创建一个 XAttribute 对象似乎是有效的（我预计会出现异常，但没有抛出任何东西）。

有没有办法检查给定的字符串作为 XML 属性的值是否有效（除了手动检查这些字符）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:00:24.287

> 我的测试表明，使用包含任何这些字符的值创建一个 XAttribute 对象似乎是有效的

是的，因为它们将被适当地逃脱。例如：

```
XElement element = new XElement("Foo",
   new XAttribute("name", "Jon & Holly"));
Console.WriteLine(element); 
```

打印出来：

```
<Foo name="Jon &amp; Holly" /> 
```

属性的*逻辑*内容是，`"Jon & Holly"`但在 XML 文件文本中的表示是`"Jon &amp; Holly"`.

如果你想检查*表示*形式的有效性，你总是可以使用：

```
string text = "<x y=\"" + value + "\" />";
try
{
    XElement.Parse(text);
    // TODO: Check that there's only one attribute in the result...
}
catch (XmlException e) { /* Invalid */ } 
```

但这太可怕了——你*确定*你真的需要这样做吗？

# javascript - IE10：如何在没有条件注释的情况下为 ActiveX 分支 JS？

> ID：15093611
> 
> 赞同：1
> 
> 时间：2013-02-26T15:58:23.900
> 
> 标签：javascript, internet-explorer, internet-explorer-10, activexobject

我的组织有一个技术表单，用于捕获有关 SWF、PDF、MP4 等的浏览器版本信息。

到目前为止，Explorer 与其他人的分支很简单：从条件注释加载的脚本运行 ActiveX 测试，而其他浏览器检查 navigator.plugins[] 和 navigator.mimeTypes[]。

不幸的是，IE10 忽略了条件注释，但它也不支持导航器数组。我需要把所有 ActiveX 的东西放在主脚本中吗？如果是这样，控制它的 if() 语句是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-22T14:22:25.413

正如评论者所说，对 window.ActiveXObject 的测试在 IE 10 及更低版本上返回 true。但请注意，微软正在他们的新 Microsoft Edge（以前的 Project Spartan）浏览器中放弃 ActiveX。

# ajax - 如何将 fitVids.js 集成到 .load 函数中？

> ID：15093612
> 
> 赞同：1
> 
> 时间：2013-02-26T15:58:25.523
> 
> 标签：ajax, video, load

我是 jquery 的新手，我需要集成一些代码，我使用 .load() 函数从外部 html 文件调用它。那部分代码是一个包含视频和描述的.div。我需要做的就是让 fitVids 处理从外部文件加载的代码。

这是在 div.featured-container 中加载的 html：

```
<div class="featured-container">
    <div class="container player clearfix">
            <div class="span8 video-container">
                <iframe width="600" height="338" src="http://www.youtube.com/embed/QkhqI49QeaM?rel=0" frameborder="0" allowfullscreen></iframe>
            </div>
            <div class="span4 featured-content">
                <div class="feat-meta">May 8, 2010 at 16:50 / by <a href="">Silviu Stefu</a></div>
                <h2>Retiner - Mobile UI Kit</h2>
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse.
                </p>
                <a class="button-normal" href="">Read More...</a>
            </div>
        </div>
    </div> 
```

这是JS：

```
 //load the first list item link
    var firstLoad = $('.thumbnails li:nth-child(2) a').attr('href')+' .player';
    $('.featured-container').load(firstLoad,'',showTheContent());
    function showTheContent() {  
            $('.player').fitVids().fadeIn('slow');  
        }

    //load the links on click
    $('.thumbnails li a').click(function(){
        var toLoad = $(this).attr('href')+' .player';
        $('.player').fadeOut('slow',loadContent);  
        $('#load').remove();
        $('#load').fadeIn('normal'); 
        function loadContent() {  
            $('.featured-container').load(toLoad,'',showNewContent());
        }  
        function showNewContent() {  
            $('.player').fadeIn('slow',hideLoader());  
        }  
        function hideLoader() {  
            $('#load').fadeOut('normal');  
        }
        return false; 
    }); 
```

那么，我应该在哪里放置 .fitVids() 函数以使 fideo 流畅？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:11:51.123

我会为此使用成功函数，以便在加载时运行代码。

```
$("#success").load("file.html", function(response, status, xhr) {
   if (status == "succes") {
   // your code
  }
}); 
```

# eclipse - 在 x64 操作系统上使用 WebKit for SWT 浏览器出现错误

> ID：15093621
> 
> 赞同：0
> 
> 时间：2013-02-26T15:58:52.173
> 
> 标签：eclipse, eclipse-plugin, safari, webkit, swt

我的问题有点像[unexplored 的](https://stackoverflow.com/questions/9117651/using-webkit-for-swt-browser-inside-eclipse-plugin)。

我的环境：

*   操作系统：windows server 2008 r2 (x64)
*   Safari 安装 5.1.7
*   32 位 SWT (eclipse SDK 3.7.2 * 32)
*   32 位 jvm (32)
*   加入`-Dorg.eclipse.swt.browser.DefaultType=webkit`_`eclipse.ini`
*   `C:\Program Files(x86)\Safari\Apple Application Support`在 Windows 路径中添加

像这样的代码：

```
//create Mozilla browser
browser = new Browser(parent, SWT.WEBKIT);  //error was caused here. 
```

错误信息：

```
Unhandled event loop exception
No more handles [Safari must be installed to use a SWT.WEBKIT-style Browser] 
```

使用相同的配置，当我的操作系统是win7 - 32位时，它运行良好。

有谁知道原因，或者告诉我如何找到原因？

非常感谢

# c# - 用 trim.End 修剪字符串

> ID：15093624
> 
> 赞同：0
> 
> 时间：2013-02-26T15:59:02.750
> 
> 标签：c#, xml, string, char, trim

我想修剪一个超过 1 个字符的字符串。字符串：

```
<incident_response>
<msg_id>50889_360</msg_id>
<inquiry_id>INC000000087930</inquiry_id>
<response_dt>02.26.2013 14:49:12</response_dt>
<status>0</status>
<error></error>
</incident_response> 
```

是的，我知道，它是一个 XML 文件。

```
string responseXML;
string inc_number = 
responseXML.Trim().Trim('<inquiry_id>').TrimEnd('</inquiry_id>'); 
```

我收到一个 CS1012 错误，因为它们不止一个字符。我需要没有任何其他字符的整个**inquiry_id (INC000000087930) 。**是否有其他选择来获取号码？我不能使用 xmlready 或类似的东西，因为我从 API 模块获取 XML 作为字符串。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-26T16:02:33.873

将 XML 作为字符串并不妨碍您使用任何 XML API。最容易使用的是 Xlinq API。它也应该在 .NET 3.5 中可用。

```
XDocument doc = XDocument.Parse(xml);
string inquiryId = (string)doc.Root.Element("inquiry_id"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:08:47.970

如果您只想要查询 _id，您可以使用正则表达式。

```
string your_xml = @"<incident_response>
<msg_id>50889_360</msg_id>
<inquiry_id>INC000000087930</inquiry_id>
<response_dt>02.26.2013 14:49:12</response_dt>
<status>0</status>
<error></error>
</incident_response>";

Regex re = new Regex(@"<inquiry_id>(?'inquiry_id'.*?)</inquiry_id>");
MatchCollection mc = re.Matches(your_xml);
foreach (Match m in mc)
{
    MessageBox.Show(m.Groups["inquiry_id"].Value);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:06:52.533

如果您仍然想使用这样的字符串可能会起作用

```
 responseXML.Substring(responseXML.IndexOf("<inquiry_id>"), responseXML.IndexOf("</inquiry_id>")) 
```

但在您的情况下使用 XML API 是一种更简洁的方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-26T16:10:25.307

尝试这个：

```
string str = "ggAAAff";
string prefix = "gg";
string suffix = "ff";
if (str.EndsWith(suffix)) str = str.Substring(0, str.Length - suffix.Length);
if (str.StartsWith(prefix)) str = str.Substring(prefix.Length); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-26T16:07:03.937

C# 支持 stringVariable.Replace(string, string)，它将用第二个字符串替换所有出现的第一个字符串。

```
string responseXML;
string inc_number = 
    responseXML.Replace("<inquiry_id>", string.Empty).Replace("</inquiry_id>", string.Empty); 
```

但是您仍然需要处理 XML 的其余部分。我认为 XML 解析器更适合您的需求。

# php - DOMDocument->saveXML() 耗时太长

> ID：15093629
> 
> 赞同：2
> 
> 时间：2013-02-26T15:59:34.320
> 
> 标签：php, xml, domdocument

所以，我创建了一个 34MB 的 XML 文件。

当我尝试从中获取输出时`DOMDocument->saveXML()`，需要 94 秒才能返回。

我假设生成此 XML 的代码在这里无关紧要，因为问题出**在**saveXML() 行上：

```
$this->exportDOM = new DOMDocument('1.0');
$this->exportDOM->formatOutput = TRUE;
$this->exportDOM->preserveWhiteSpace = FALSE;
$this->exportDOM->loadXML('<export><produtos></produtos><fornecedores></fornecedores><transportadoras></transportadoras><clientes></clientes></export>');

[...]

$this->benchmark->mark('a');
$this->exportDOM->saveXML();
$this->benchmark->mark('b');
echo $this->benchmark->elapsed_time('a','b');
die; 
```

这给了我`94.4581`.

我究竟做错了什么？生成文件时，你们知道 DOMDocument 的任何与性能相关的问题吗？

如果您需要更多信息，请告诉我。谢谢。

* * *

我尝试删除`formatOutput`. 它将性能提高了 33%。

还是用的太久。还有其他提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:26:53.633

有帮助的一件事——尽管它不是完美的解决方案——是设置`$this->exportDOM->formatOutput = FALSE;`.

它将性能提高了约 33%。

# linux - 将所有图像放在数据库中或仅放在文件夹中

> ID：15093630
> 
> 赞同：-1
> 
> 时间：2013-02-26T15:59:36.393
> 
> 标签：linux, image, node.js, mongodb

我正在开发一个使用大量图像的网站。图像经常被操纵（每隔几秒钟，由客户）。所有图像都在 linux 服务器上。也有可能两个客户端同时尝试更改图像。所以我的问题是：我应该将图像放入数据库还是将它们留在文件夹中（操作系统如何处理写-写-冲突？）？

我在服务器上使用 node.js 和 mongoDB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:04:14.840

您通常会将对文件位置的引用存储在数据库中。至于写-写冲突在大多数首先打开文件的人中，它主要取决于您正在使用的操作系统。您将需要研究文件锁定。这篇维基百科文章提供了一个很好的概述。

[http://en.wikipedia.org/wiki/File_locking](http://en.wikipedia.org/wiki/File_locking)

如果可能发生写入冲突，在您的代码中检查文件是否正在使用并通知用户也是一种很好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T18:54:50.540

我建议您使用 GridFS 文件系统将图像存储在 MongoDB 中。如果您为数据库使用副本集，这允许您将图像及其元数据保存在一起，它具有原子更新和另外两个优点：

*   您的图像与其他数据具有相同的高可用性，并且可以一起备份

*   最终，您可以将查询定向到集合的次要成员

有关详细信息，请参阅

[http://docs.mongodb.org/manual/applications/gridfs](http://docs.mongodb.org/manual/applications/gridfs)

[http://docs.mongodb.org/manual/replication/](http://docs.mongodb.org/manual/replication/)

这有帮助吗？

干杯

罗纳德

# c# - 让我的 asp.net 网页找到连接的相机，然后流式传输到 Bitmap 构造函数

> ID：15093631
> 
> 赞同：1
> 
> 时间：2013-02-26T15:59:36.630
> 
> 标签：c#, asp.net, bitmap, webcam

我需要我的 asp.net Web 表单（C# 代码隐藏）来查找连接的相机（电话或计算机），然后将数据流式传输到 Bitmap 构造函数。

```
Bitmap myBitmap = new Bitmap(Stream streamFromCam);

// Will then process this stream looking for a QR Code using the .NET Barcode
// scanner .dll I've integrated into my project. This part I can do. 
```

这是可以实现的吗？
如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:06:30.553

如果相机连接到运行您的 Web 应用程序的 Web 服务器，那么是的，它可以从代码隐藏中实现。如果您要问是否可以在连接了摄像头的远程客户端上实现，那么答案是肯定的和否定的。是的，你仍然可以做到，不，你不能从后面的代码中做到这一点。您将需要一些 Silverlight/flash 组件来完成此操作...或 ActiveX... 或浏览器插件，但您无法从代码隐藏中执行此操作。后台代码运行在服务器上，而不是客户端上，连接到客户端的设备无法通过服务器端代码访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:05:25.260

好吧，简短的回答没有。长答案，是的，有点，但你不会喜欢如何。

首先，我假设您想在用户的计算机上找到摄像头，而不是在托管您页面的服务器上。如果不安装其他软件，则无法在浏览器中访问这种东西。您必须让用户下载一个程序，该程序从他们的网络摄像头读取数据并将其上传到 Web 服务。

这样做本身就是一个完整的项目，不适合 Stack Overflow 响应。

# wordpress - 突出显示包含重音符号的 wordpress 帖子中的文本

> ID：15093634
> 
> 赞同：1
> 
> 时间：2013-02-26T15:59:40.717
> 
> 标签：wordpress, search, character, highlight, base

在搜索框中，一些用户要求查找“Munchen”（原来是 München）搜索无论如何都会找到，不要问我怎么不知道。在 wordpress 搜索结果中，我知道如何突出显示与搜索模式完全相同的单词，但如何突出显示单词 München。换句话说，我正在寻找某种可以在基本字符上找到模式匹配的函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:06:16.553

顺便说一句，您可能必须制作一个帖子内容数组的副本，将任何 ç 替换为 c，将 é 替换为 e 等。然后搜索返回索引的副本。

该索引将是原始 ç 包含数组中的正确位置。

# ios - 从 webView 检测 HTTP 代码 302

> ID：15093637
> 
> 赞同：2
> 
> 时间：2013-02-26T15:59:51.307
> 
> 标签：ios, objective-c, webview

在用户输入正确的登录名和密码后，我需要检测 HTTP 代码 302，我正在使用这种方法：

```
- (void) connection:(NSURLConnection *)connection
 didReceiveResponse:(NSURLResponse *)response
{
    NSLog(@"connection:didReceiveResponse");

    if ([response isKindOfClass:[NSHTTPURLResponse class]]) {

        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;

        int status = [httpResponse statusCode];

        if (status == 302) {

            //do something here
        }

        else
        {

            NSLog(@"http status code: %d", status);
        }

        [connection cancel]; 

    }

} 
```

但是我只能在页面重定向后获得状态码 200，请问有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:06:17.260

如果您正在使用，`UIWebView`那么您需要检查委托方法中的错误代码，而`UIWebViewDelegate`不是`didReceiveResponse`。`NSURLConnectionDelegate`

这是您可以检查错误代码的确切方法..

```
-(void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error{
    if (error.code == ERROR_YOU_WANT_TO_CHECK {
       //do what you want to do here 
     }
} 
```

**编辑**

如果您正在使用，`NSURLConnection`那么回答这个[问题](https://stackoverflow.com/questions/1446509/handling-redirects-correctly-with-nsurlconnection)可能会对您的事业有所帮助

# testing - 如何验证我的链接标题属性是否具有指定值？

> ID：15093639
> 
> 赞同：1
> 
> 时间：2013-02-26T16:00:00.730
> 
> 标签：testing, selenium, automated-tests, selenium-ide

我的页面上有一个链接，可以这样说

```
<a href="http://example.com" title="my title message">my link label</a> 
```

如何验证我的链接标题属性是否具有“我的标题消息”值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T08:46:00.227

Assertattribute 命令用于验证它，请检查此代码。

```
assertattribute  | title = my title message@href | http://example.com
assertattribute  | link=my link label@href       | http://example.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:00:00.730

从 Selenium IDE 使用这个：

```
command         | target                   | value
-------------------------------------------------------------
assertAttribute | link=my link label@title | my title message 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T07:35:37.140

试试这样。

命令：验证标题

目标：我的标题信息

此命令会将实际页面标题与命令目标中给出的文本进行比较，如果两者相同，则不会显示错误，否则将显示错误

谢谢你...

# rebol - 如何使用 Rebol 中的字符串从块中选择元素？

> ID：15093642
> 
> 赞同：2
> 
> 时间：2013-02-26T16:00:04.443
> 
> 标签：rebol

鉴于此块

```
fs: [
 usr [
  local [
   bin []
  ]
  share []
 ]
 bin []
] 
```

我可以使用这样的路径表示法检索项目：

```
fs/usr/local 
```

当路径是字符串时，我该怎么做？

```
path: "/usr/local"
find fs path ;does not work!
find fs to-path path ;does not work! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T19:29:08.543

您需要使用正确的根完成输入字符串路径，然后 LOAD 并评估它。

```
>> path: "/usr/local"
>> insert path "fs"
>> do load path
== [
    bin []
] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T21:09:25.693

你知道 Rebol 有一个**原生路径类型**吗？

尽管这并不能完全回答您的问题，但我坚持我会添加有关如何直接在 Rebol 中使用路径的参考。Rebol 有***很多***数据类型，如果可以，您应该利用丰富的语言特性。尤其是当您开始使用和构建方言时，知道存在哪些类型以及如何使用它们变得更加有效。

这是一个关于如何直接构建和运行路径而不使用字符串的示例。为了在源代码中表示路径，您使用**lit-path!** 数据类型。

例子：

```
>> p: 'fs/usr/local
== fs/usr/local
>> do p
== [
    bin []
] 
```

你甚至可以附加到一个路径来操纵它：

```
>> append p 'bin
== fs/usr/local/bin
>> do p
== [] 
```

如果它存储在一个块中，则使用路径！直接输入（不是点亮路径！）：

```
>> p: [fs/usr/local/bin]
== [fs/usr/local]
>> do first p
== [
    bin []
] 
```

另请注意，直接使用路径比使用字符串具有优势，因为路径由一系列单词组成，与使用字符串示例相比，您可以更轻松地进行一些操作：

```
>> head change next p 'bin
== fs/bin/local

>> p: 'fs/path/issue/is
== fs/path/issue/is
>> head replace p 'is  'was
== fs/path/issue/w 
```

与使用字符串相反：

```
>> p: "fs/path/issue/is"
== "fs/path/issue/is"
>> head replace p "is"  "was"
== "fs/path/wassue/is" 
```

如果你想浏览磁盘，而不是 Rebol 数据集，你必须简单地给 'FS 一个文件的值！以及从那里浏览的路径的其余部分（这是路径在文件上的工作方式！类型）：

```
fs: %/c/ 
read dirize fs/windows 
```

# mysql - 根据排名从mysql获取上一行和下一行

> ID：15093644
> 
> 赞同：-2
> 
> 时间：2013-02-26T16:00:11.777
> 
> 标签：mysql

我使用这个 mysql 查询逐点获得排名。我需要按等级获取上一个和下一个项目。

例如：商品的排名是 99。在商品页面，我想显示第 100、第 101、第 98 和第 97 项。

[http://erincfirtina.com/apps/urdemo/track.php?tid=10](http://erincfirtina.com/apps/urdemo/track.php?tid=10)

我需要做相关的曲目列表

这是我获得排名的mysql查询：

```
SELECT 
uo.*, 
( SELECT  COUNT(*) FROM tracks ui WHERE (ui.point, ui.id) >= (uo.point, uo.id) ) AS rank
FROM tracks uo WHERE id = 10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:05:00.363

你从来没有问过一个问题。

我观察到的一件事是，您在子选择中使用了不属于子选择的表（uo）。

也许您正在寻找：

```
SELECT  uo.*, COUNT(*) AS rank
FROM tracks ui, tracks uo 
WHERE (ui.point, ui.id) >= (uo.point, uo.id) 
  AND uo.id = 10; 
```

我很难在不知道您的表格是什么样子或您的问题实际上是什么的情况下测试它的准确性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:15:53.050

这个查询应该可以工作，尽管它的扩展性很差。

```
SELECT *
FROM (
    SELECT 
    uo.*, 
    ( SELECT  COUNT(*) FROM tracks ui WHERE (ui.point, ui.id) >= (uo.point, uo.id) ) AS rank
    FROM tracks uo WHERE id = 10
) t
ORDER BY t.rank DESC 
```

# xaml - 为什么覆盖 ApplicationPageBackgroundThemeBrush 不起作用？

> ID：15093651
> 
> 赞同：3
> 
> 时间：2013-02-26T16:00:27.253
> 
> 标签：xaml, windows-8, windows-runtime

我正在尝试为我的 Windows 8 应用商店应用程序定义默认背景颜色，但尽管它在 XAML 编辑器和 Blend 中正确显示，但在 Windows 8 和 Windows RT 模拟器中运行时会出现默认的黑色背景。

我基于“Split App”VS 2012 模板创建了一个全新的 Windows 8 应用程序，并修改了 App.xaml 以指定 ApplicationPageBackgroundThemeBrush 的新值。

这就是我的 App.xaml 的样子：

```
<Application
x:Class="App3.App"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:App3"
xmlns:localData="using:App3.Data">

<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>

            <!-- 
                Styles that define common aspects of the platform look and feel
                Required by Visual Studio project and item templates
             -->
            <ResourceDictionary Source="Common/StandardStyles.xaml"/>
        </ResourceDictionary.MergedDictionaries>

        <!-- Application-specific resources -->

        <x:String x:Key="AppName">App3</x:String>

        <!-- Basic foreground and background colours -->
        <SolidColorBrush x:Key="ApplicationPageBackgroundThemeBrush" Color="#FF3CA5DC"/>
        <SolidColorBrush x:Key="ApplicationPageForegroundThemeBrush" Color="White"/>

    </ResourceDictionary>
</Application.Resources> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:33:26.190

似乎这两个画笔只被 StandardStyles.xaml 中的几个样式使用，其中之一是

```
<Style x:Key="LayoutRootStyle" TargetType="Panel"> 
```

您可以将其应用于您的根面板。但是您在 App.xaml 中的更改不会影响此样式。它只会影响这个画笔的进一步使用，所以如果你想使用那些特定的画笔，我会看到以下变体：

1）在您的 App.xml 中声明它们并进一步使用它：

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}"> 
```

`StadardStyles.xaml`2）在下面声明它们

```
<ResourceDictionary.ThemeDictionaries>
    <ResourceDictionary x:Key="Default">
        <!-- Style Goes Here -->
    </ResourceDictionary>
</ResourceDictionary.ThemeDictionaries> 
```

在这种情况下，所有 StandardStyles 都会受到影响，但您也应该在 Grid 中使用 LayoutRootStyle。

但实际上，使用这些画笔显示的利润太少了，我认为最好将面板背景设置为您需要的。

# batch-file - 为什么从另一个批处理文件中调用批处理文件时不会运行？

> ID：15093652
> 
> 赞同：2
> 
> 时间：2013-02-26T16:00:29.620
> 
> 标签：batch-file, cmd, call

我有一个批处理文件，它首先创建另一个包含 ClearCase cleartool 命令的批处理文件，然后运行它：

```
ECHO cleartool lsactivity -long "%ACTIVITY%"^>"%OUTPUTFILE%">FILETORUN.bat
CALL FILETORUN.bat 
```

运行批处理时，`FILETORUN.bat`会以正确的格式生成，但`CALL`它会被完全忽略。

如果我在日志文件`ECHO`之后输出`CALL`，我可以看到脚本只是跳过它。

会是什么呢？

我试过删除`CALL`，但没有任何区别。

**编辑：解决方案**

谢谢大家的意见。我发现了问题。在脚本中写入批处理和批处理调用之前，有一个命令可以将信息从文件中读取到变量中：

```
SET /p FILETODELETE=<rmname_%CLEARCASE_USER%.tmp 
```

它只读取第一行。由于某种原因，这与临时批处理文件产生了冲突，我不知道为什么。我使用不同的解决方案从文件中读取第一行，并且不再发生冲突：

```
(set FILETODELETE=)
for /f "delims=" %%q in (rmname_%CLEARCASE_USER%.tmp) do if not defined FILETODELETE set FILETODELETE=%%q 
```

如果有人能提供一些启示，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T07:39:23.873

SET /P 等待用户输入，因此它实际上会使用您之后尝试执行的内容完成命令并消耗输入缓冲区，这可能会在每台机器上产生不同的结果。有关详细信息，请参阅[set 命令参考](http://ss64.com/nt/set.html)

# android - 回到 onCreate

> ID：15093654
> 
> 赞同：0
> 
> 时间：2013-02-26T16:00:31.717
> 
> 标签：android

我希望我的代码可读，所以我正在编写不同的方法来执行它们所做的任何事情并返回到 onCreate ，它会调用下一个要执行的方法。我的一个方法有一个 onAnimationEnd 侦听器，我希望 onCreate 方法等待动画结束然后调用下一个方法，如果不从侦听器本身调用下一个方法，我该如何做到这一点？

提前致谢

```
onCreate() 
{
 doTask1();
 doTask2();
}

private void doTask1(){
    ...
    ...
    public void onAnimationEnd(Animation animation) {

            // finish this method and let onCreate call the next one
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T13:40:51.853

最好的方法是，你应该实现类似的东西：

```
onCreate() 
{
 doTask1();
 doTask2();
}

private void doTask1(){
    Animation animation;
    ...
    ...
    onAnimationEnd(animation);
}

public void onAnimationEnd(Animation animation) { 
        ...
} 
```

如果 onAnimationEnd 方法是一个侦听器，我建议您实现类似：

```
onCreate()  { 
    addActions(); //you can choose which method call first
    doTask1();
    doTask2();
}

private void addActions(){
    ...
    ...
    public void onAnimationEnd(Animation animation) {

            // finish this method and let onCreate call the next one
        } 
}

private void doTask1(){
    ...
} 
```

# javascript - .click(function()) 没有被调用

> ID：15093655
> 
> 赞同：0
> 
> 时间：2013-02-26T16:00:32.357
> 
> 标签：javascript, jquery, api, last.fm

我正在尝试使用 last.fm api 进行 chrome 扩展，并且我已成功地将以下 div 放置在我希望显示的页面中。

```
<div id="showLastFMInfo" Title="More info about song" class="LastFMButtonDown">&raquo;</div> 
```

但是当我点击它时，什么也没有发生，这是使用的 JS：

```
$(document).ready(function () {
    // this get executed
    $('#meta-frame').append('<div id="showLastFMInfo" Title="More info about song" class="LastFMButtonDown">&raquo;</div>');

    // this won't work if I click on my button
    $("#showLastFMInfo").click(function(){
        console.log("Click");
    });
}); 
```

所以你可以看到第一行被执行但 .click() 没有反应。

这是我的 manifest.json：

```
{
   "content_scripts": [ {
      "js": [ "jquery.js", "lastfm.api.cache.js","lastfm.api.md5.js", "lastfm.api.js","lastFMLink.js", "script.js"],
      "css": [ "LastFMLink.css" ],
      "run_at": "document_end"
   } ],

   "name": "Plug.Dj VS last.Fm",
   "description": "Implement information about the artist",
   "icons": { "16": "cookie.png", "48": "cookie.png", "128": "cookie.png" },
   "version": "0.0.1",
   "web_accessible_resources": [ "lastFMLink.js" ],
   "manifest_version": 2
} 
```

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T16:02:14.490

您正在附加它，因此它是动态的，并且您需要一个委托的事件处理程序：

```
$('#meta-frame').on('click', '#showLastFMInfo', function(){
    console.log("Click");
}); 
```

另一方面，在附加元素后附加事件处理程序也应该有效吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:01:48.457

使用文档或最近的静态元素

```
$(document).on('click','#showLastFMInfo',function(){

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:08:29.850

对于动态生成的内容，请使用这些

```
 $("a.offsite").live("click", function(){ alert("Goodbye!"); });                // jQuery 1.3+
    $(document).delegate("a.offsite", "click", function(){ alert("Goodbye!"); });  // jQuery 1.4.3+
    $(document).on("click", "a.offsite", function(){ alert("Goodbye!"); });        // jQuery 1.7+ 
```

不推荐使用 live 和 delegate ，因此建议使用 .on() 。

# java - 将 Java/MVC/Hibernate webapp 移植到 Python

> ID：15093656
> 
> 赞同：3
> 
> 时间：2013-02-26T16:00:35.770
> 
> 标签：java, python, orm, inversion-of-control

我不是 Python 开发人员，但我与 Python 开发人员一起工作。

场景如下：我被要求实现与 Python 框架集成的系统的一部分。然后，我同意其他团队使用 Java 开发我的部分，并为他们实现 REST 绑定提供全面支持。所以我使用 Spring MVC 和 Hibernate 在 Java 中实现了一个 webapp。我无法详细说明，但设计合同类似于以下内容：

Python 框架调用具有特殊身份验证和授权标头的 REST API。Spring MVC 控制器使用拦截器基于此类 HTTP 标头执行身份验证和授权，然后被调用。控制器本身使用一个路径变量和两个可选`GET`参数来确定被访问对象的类型和时间戳范围

```
/api/{datatype}?[starttime=AAA]&[endtime=BBB] 
```

使用正确的`switch`语句，我选择了正确的 Hibernate 存储库来使用这些参数进行查询并返回一个对象（映射到表），该对象由 Jackson 映射器为 Spring MVC 转换为 JSON。

作为系统集成商，我会告诉这些人对我在 Tomcat 上运行的组件形成合法的 HTTP 请求并解码 JSON（根据他们的数据库模型设计**）**。

相反，这些人要求我将所有东西都翻译成 Python。除了完全没有 Python 经验（我几乎不能编写一个计算二项式系数的控制台应用程序，只是不能实现另一个 hello world 或简单的计算器），我猜在 Python 中不存在 Hibernate、Spring 和 Jackson 这样的东西。

那么，让我们来回答这个问题。Python 中是否有任何框架允许我...？

*   用很少的代码轻松创建 REST API (Django????)
*   轻松拦截现有的 REST API 并正确模块化 HTTP 管道，即通过类似于拦截器的机制进行 api 代码外的身份验证、后处理输出流等（我在他们的身份验证代码库中看到了类似的东西） ...我们可以将其标记为已解决）
*   执行依赖注入。在 dev、staging、production 之间切换时，我目前更改了实现业务代码调用的接口的类
*   将对象映射到关系，例如 Hibernate。这是我目前最黑暗的一点。我认为 Python 中没有任何 ORM
*   将对象映射到 JSON（我知道这是可行的，他们已经在他们的代码库中这样做了）

我不会发布示例代码，认为它没用。我试图将问题作为一般问题发布，而不是深入研究细节。

# g++ - giza stream.h 错误致命

> ID：15093660
> 
> 赞同：0
> 
> 时间：2013-02-26T16:00:49.037
> 
> 标签：g++, makefile, fatal-error, moses, giza++

从这里安装 Giza 时：

```
wget http://giza-pp.googlecode.com/files/giza-pp-v1.0.2.tar.gz 
```

解压缩并运行“make”后，出现以下错误：

```
Pointer.h:27:20: fatal error: stream.h: No such file or directory compilation terminated. 
```

任何人都知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-26T16:07:18.363

您可能应该获得更新版本的源代码。根据[https://code.google.com/p/giza-pp/](https://code.google.com/p/giza-pp/)，最新版本是 1.0.7。

# fonts - Ghostscript 8.64 上的 CIDFMAP（未提供替代 CID 字体“Adobe-Identity”）

> ID：15093661
> 
> 赞同：1
> 
> 时间：2013-02-26T16:00:53.810
> 
> 标签：fonts, ghostscript

我正在尝试在 Windows 上使用 gsprint (Ghostscript 8.64) 打印 PDF。在我遇到未嵌入 CID 字体的 PDF 之前，它运行良好。我收到错误，抱怨 PDF 中使用的 Arial CID 字体。

> 找不到 CID 字体“Arial”。将 CID 字体资源 /Adobe-Identity 替换为 /Arial。

如果我升级到 9.07，它可以正常工作——可能是因为它在安装结束时生成了 CIDFMAP 文件。但我不想升级到 9.07。我尝试通过以下命令生成 CIDFMAP 文件，但生成的 CIDFMAP 文件始终为空（除了标题）。

> bin\gswin32c -q -dBATCH -sFONTDIR=c:/windows/fonts -sCIDFMAP=lib/cidfmap lib/mkcidfm.ps

我尝试将 CIDFMAP 文件从 9.07 复制到 8.64 lib 文件夹，但这没有用。也许我需要在某处添加一些属性来指定 CIDFMAP 文件的位置？如何让 gsprint（或 gsview）替换 Arial CID 字体？

更新添加以下行解决了问题

> /Arial << /FileType /TrueType /Path (c:/windows/fonts/arial.ttf) /SubfontID 0 /CSI [(Identity) 0] >> ;

现在我收到关于 Arial Bold 的以下错误

> 错误：/invalidfileaccess in --.libfile-- 操作数堆栈：--
> dict:11/20(L)-- C2_0 1 --dict:6/6(L)-- --dict:6/6(L) -- Arial,Bold --dict:11/12(ro)(G)-- --nostringval-- CIDFontObject
> --dict:8/8(L)-- --dict:8/8(L)-- Arial,Bold CIDFont true Arial,Bold false Arial,Bold --dict:15/16(G)--
> (C:/WINDOWS/Fonts/ARIALBD.TTF)

我尝试添加各种行，但没有帮助。

> /Arial,Bold << /FileType /TrueType /Path (c:/windows/fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Identity) 0] >> ;
> 
> /Arial-Bold << /FileType /TrueType /Path (c:/windows/fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Identity) 0] >> ;
> 
> /Arial-BoldMT << /FileType /TrueType /Path (C:/WINDOWS/Fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Unicode) 0] >> ;
> 
> /Arial,BoldMT << /FileType /TrueType /Path (C:/WINDOWS/Fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Unicode) 0] >> ;
> 
> /Arial-Bold << /FileType /TrueType /Path (C:/WINDOWS/Fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Unicode) 0] >> ;
> 
> /Arial,Bold << /FileType /TrueType /Path (C:/WINDOWS/Fonts/ARIALBD.TTF) /SubfontID 0 /CSI [(Unicode) 0] >> ;

我希望最终我能充分理解这一点，以便能够处理我怀疑将要遵循的接下来的两个字体错误。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:42:42.030

它看起来不像 mkcidfm.ps 会做你所追求的。它似乎只在寻找特定的字体，而 arial 不是其中之一。

尝试手动将以下行添加到`cidfmap`

```
/Arial << /FileType /TrueType /Path (c:/windows/arial.ttf) /SubfontID 0 /CSI [(Identity) 0] >> ; 
```

# android - 在 Android apk 中打包 linux 二进制文件

> ID：15093663
> 
> 赞同：3
> 
> 时间：2013-02-26T16:01:04.350
> 
> 标签：android, android-ndk, ffmpeg, android-build

如果我想在我的 .apk 文件中包含一个 linux 二进制文件（如 ffmpeg）（仅适用于基于 ARM 的设备），这是否可以分发给非 root 手机？我知道可以使用 Runtime.exec() 调用包含的二进制文件，但这是推荐的做法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T21:30:47.243

您可以将二进制文件存储`res/raw`在文件夹中或`assets`文件夹中。这样，它将部署在设备上。您应该在安装后“提取”它，您`/data/data/your.package/files/`的目的地是有效的；`/sdcard/`不是。您的应用程序无法访问通常的`/data/local/`目的地，即使它是针对 adb shell 的。`chmod 500`也很好。

也就是说，带有 JNI 包装器的 libffmpeg.so 更易于在 Android 应用程序中使用，并且占用的系统资源更少。

* * *

**更新，2014 年 4 月**您可以欺骗系统，并将二进制文件存储在`libs/armeabi`文件夹中，然后让安装程序为您提取此二进制文件。它将最终在具有权限的`/data/data/your.package/lib/`文件夹中。`+x`这个 hack 还有一个很好的优势，它可以让系统选择正确的 ABI 来提取二进制文件：**armeabi**、**armeabi-v7a**、**mips**或**x86**。

诀窍是遵循*共享库*命名约定。因此，当您将**ffmpeg**可执行文件放入.so 时`libs/armeabi`，将文件重命名为**lib_ffmpeg_.so**。自然，您还将`Runtime.exec()`使用文件的完整路径，以及新添加的前缀和后缀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:05:47.260

我不认为你不能在没有 root 的情况下将它们标记为 +x。

使用 ffmpeg，为 libffmpeg 创建 JNI 包装器更为常见。

# asp.net - viewstate mac 的验证失败 - 但只是偶尔

> ID：15093669
> 
> 赞同：1
> 
> 时间：2013-02-26T16:01:22.657
> 
> 标签：asp.net

我正在验证视图状态 MAC 失败，但只是非常偶尔。

我不在网络场中，无法重新创建它。

是否有任何已知因素会导致视图状态 MAC 验证失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:06:09.113

微软博主 Tess Ferrandez 对此有一篇[很好的文章](http://blogs.msdn.com/b/tess/archive/2008/03/17/asp-net-viewstate-error-validation-of-viewstate-mac-failed.aspx)：

> Viewstate 和 viewstate 验证使用几个隐藏的表单字段，例如 __VIEWSTATE 和 __EVENTVALIDATION。如果页面呈现速度太慢，以至于当有人单击导致回发的按钮或控件时 __EVENTVALIDATION 字段尚未呈现，ASP.NET 也会认为视图状态无效并报告此情况。

检查您的视图状态在有问题的页面中是否非常大。您可能希望关闭`EnableViewState`不需要它的控件的属性，尤其是不需要记住回发之间状态的大型数据绑定控件。

# sql - 将列乘以值返回“不是单组组函数”错误

> ID：15093675
> 
> 赞同：0
> 
> 时间：2013-02-26T16:01:45.633
> 
> 标签：sql, oracle, multiplication

我创建了一个表格，记录单场比赛的篮球次数 3_point_attempts 和 3_points_scored。

我想要做的是多个 3_point_attempts*1.5 和 3_point_scored*3 的值，但是这样做时我收到“不是单组组函数”错误。

请检查[这个](http://sqlfiddle.com/#!4/1123d/2)dbfiddle

有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:08:25.000

直接做乘法：

```
SELECT performanceid, matchid, teamid, twopattempts, twopattempts*2 AS SumPoints,
        3_point_attempts*1.5, 3_point_scored*3 
FROM Performance
WHERE TeamID = 1 
```

您只需要在`group by`尝试聚合行时使用。例如：

```
select teamid, sum(3_point_attempts*1.5), sum(3_point_scored*3_
from Performance
group by TeamID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:13:01.020

您可以使用`sum() over()`来获得结果：

```
SELECT performanceid, 
  matchid, 
  teamid, 
  twopattempts, 
  (SUM(twopattempts) over(partition by teamid))*2  AS SumPoints
FROM Performance
WHERE TeamID = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/1123d/16)

如果要添加三点尝试，则可以使用：

```
SELECT performanceid, 
  matchid, 
  teamid, 
  twopattempts, 
  SUM(twopattempts) over(partition by teamid)*2  AS SumPoints,
  sum(THREEPATTEMPTS) over(partition by teamid)*1.5 as ThreePointAttempts,
  sum(THREEPSCORED) over(partition by teamid)*3 as ThreePointScored
FROM Performance
WHERE TeamID = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/1123d/18)

以上将为您提供返回的每一行的总值。如果您希望它基于`matchid`and `teamid`，那么您可以使用：

```
SELECT MatchID,
  teamid, 
  SUM(twopattempts)*2  AS SumPoints,
  sum(THREEPATTEMPTS)*1.5 as ThreePointAttempts,
  sum(THREEPSCORED)*3 as ThreePointScored
FROM Performance
WHERE TeamID = 1
group by teamid, MatchID 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/1123d/21)

# kendo-ui - kendoUI，在剑道网格上进行批量内联编辑时如何添加回调函数

> ID：15093679
> 
> 赞同：1
> 
> 时间：2013-02-26T16:01:52.310
> 
> 标签：kendo-ui, kendo-treeview

这是我使用 aspl.net mvc 包装器的剑道网格。问题是当您进行批量内联编辑时。然后点击保存。

```
.Create(create => create.Action("UpdateLiabilities", "Liability", parameters)) 
```

将被触发并将所有更改保存到数据库中。现在我需要添加一个回调函数来显示一个帐户成功添加的消息。我不确定如何添加此回调函数。

```
@(Html.Kendo().Grid<LiabilityVM>()
  .Name("QualifiedNonrecourseDebtGrid")
  .HtmlAttributes(new { style = "height: 300px;" })
  .Columns(columns =>
               {
                   columns.Bound(i => i.Id).Visible(false);
                   columns.Bound(i => i.AccountId).Visible(false);

                   columns.Bound(i => i.AccountNumber)
                       .Title("Account #")
                       .ClientTemplate("<span style='white-space:nowrap'><a href='\\#' onclick=\"showAccountInfo('acctInfoPopupContainer', " + parameters.clientId + ", " + parameters.projectId + ",#=WorkpaperId#, #=AccountId#, '#=AccountNumber#', '#=AccountNumberAndDescAndLabel#')\"> #= AccountNumber # </a></span>")
                       .HtmlAttributes(new { nowrap = "nowrap" })
                       .Width(70);
                   columns.Bound(i => i.Description)
                       .Title("Description")
                       .ClientTemplate("<span href='\\#' title='#= getEncodedValueOrDefault(Description, '')#'  style='white-space:nowrap'>#= getHtmlEncode(Description, '') #</span>")
                       .HtmlAttributes(new { nowrap = "nowrap" })
                       .Width(120);

               })
      .Editable(editable => editable.Mode(GridEditMode.InCell))
      .DataSource(grid => grid.Ajax()
                              .Batch(true)
                              .Model(model => { 
                                                model.Id(i => i.Id);
                                                model.Field(p => p.AccountNumber).Editable(false);
                              })
                              .ServerOperation(true).Group(groups => groups.Add(p => p.Source))
                              .Create(create => create.Action("UpdateLiabilities", "Liability", parameters))
                              .Read(read => read.Action("GetLiabilities", "Liability", parameters))
                              .Update(update => update.Action("UpdateLiabilities", "Liability", parameters))
                              .Aggregates(aggregates =>
                                         {
                                             aggregates.Add(p => p.TaxAdjustmentBalance).Sum();
                                         })
  )
  .Sortable()
  .Filterable()
  .Selectable(s => s.Mode(GridSelectionMode.Single))
  .Resizable(resize => resize.Columns(true))
  .Reorderable(reorder => reorder.Columns(true))
  .ColumnMenu()
  .Scrollable()
  ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T18:44:47.470

为此有一个特殊事件，称为**[sync](http://docs.kendoui.com/api/framework/datasource#sync)**。

在您的情况下，它应该是这样的：

```
 .DataSource(grid => grid.Ajax().Events(ev=>ev.Sync("theNameOfTHeCallBackFUnction"))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:58:31.383

在您的 UpdateLiabilities 方法中返回 jsonp 而不是 json ( JavaScriptResult) 作为

```
 const string alertMessage = "created";
 string aMessage = string.Format("alert('{0}');", alertMessage);
 var returned = new JavaScriptResult { Script = aMessage };
 return returned; 
```

# mule - 将 Mule ESB 连接到 OpenMQ 代理

> ID：15093681
> 
> 赞同：0
> 
> 时间：2013-02-26T16:02:03.403
> 
> 标签：mule, mule-studio, openmq

我正在尝试将 Mule ESB 连接到现有的 OpenMQ 代理。从[用于 openmq 集成的 mulesoft 文档构建](http://www.mulesoft.org/documentation/display/current/Open+MQ+Integration)，我有以下流程；

```
<jms:custom-connector name="Custom_JMS" specification="1.1" 
                      class="com.sun.messaging.ConnectionFactory" 
                      validateConnections="true" doc:name="Custom JMS"/>

<flow name="EchoFlow" doc:name="EchoFlow">

    <jms:inbound-endpoint doc:name="JMS"
                          connector-ref="Custom_JMS" responseTimeout="1000" 
                          topic="mytopic"/>

    <echo-component doc:name="Echo"/>
    <logger message="#[message:payload]" doc:name="Logger"/>
</flow> 
```

但是，我在运行时遇到错误；

```
[02-26 10:54:08] ERROR DefaultMuleApplication [main]: null
org.springframework.beans.NotWritablePropertyException: Invalid property 'acknowledgementMode' of bean class [com.sun.messaging.ConnectionFactory]: Bean property 'acknowledgementMode' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter? 
```

我感觉这个例子中遗漏了几个元素。有人可以告诉我缺少什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:12:08.653

AFAIK`custom-connector`需要一个扩展的类`org.mule.transport.jms.JmsConnector`。试试这个：

```
<spring:bean name="connectionFactory" class="com.sun.messaging.ConnectionFactory"/>

<jms:connector name="JMSConnector"
    connectionFactory-ref="connectionFactory"
    specification="1.1"/> 
```

# javascript - Jquery修剪不工作日文空格

> ID：15093689
> 
> 赞同：1
> 
> 时间：2013-02-26T16:02:30.063
> 
> 标签：javascript, jquery, trim

我刚刚发现 jquery 修剪功能（使用 1.8.x）不会修剪日文空格。这个问题有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:16:22.457

对于 ES5 shim，包括（假定）ES5 String.trim() 方法的完整实现，请参阅[https://github.com/kriskowal/es5-shim](https://github.com/kriskowal/es5-shim)

```
// ES5 15.5.4.20
// http://es5.github.com/#x15.5.4.20
var ws = "\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003" +
    "\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028" +
    "\u2029\uFEFF";
if (!String.prototype.trim || ws.trim()) {
    // http://blog.stevenlevithan.com/archives/faster-trim-javascript
    // http://perfectionkills.com/whitespace-deviations/
    ws = "[" + ws + "]";
    var trimBeginRegexp = new RegExp("^" + ws + ws + "*"),
        trimEndRegexp = new RegExp(ws + ws + "*$");
    String.prototype.trim = function trim() {
        if (this === undefined || this === null) {
            throw new TypeError("can't convert "+this+" to object");
        }
        return String(this)
            .replace(trimBeginRegexp, "")
            .replace(trimEndRegexp, "");
    };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:06:00.000

读完之后我写了一些东西：

[https://github.com/jquery/jquery/pull/896](https://github.com/jquery/jquery/pull/896)

[演示](http://jsfiddle.net/mplungjan/YfXX9/)

```
$.extend({
  jTrim: function(str){
    var re = /^[\s\xA0\uFEFF\u1680\u180E\u2000-\u200A\u202F\u205F\u3000]+|[\s\xA0\uFEFF\u1680\u180E\u2000-\u200A\u202F\u205F\u3000]+$/g 
    return str.replace(re,"");
  }
});

console.log(">"+$.jTrim(' よろしくお願い申し上げます。')+"<"); 
```

# delphi - 将 I/O、VB6 转换为 Delphi

> ID：15093690
> 
> 赞同：0
> 
> 时间：2013-02-26T16:02:31.847
> 
> 标签：delphi, vb6, io

我正在使用 VB6 代码并将其转换为 Delphi。

使用顺序打开文件的 VB6 代码：

```
Dim bytNumDataPoints As Byte
Dim bytcount as Byte
Dim lintData(0 To 23) As Long
    Input #intFileNumber, bytNumDataPoints
    For bytcount = 0 To (bytNumDataPoints - 1)
        Input #intFileNumber, lintData(bytcount)  '
        lintData(bytcount) = (lintData(bytcount) + 65536) Mod 65536
    Next bytcount 
```

档案资料：

```
24  <<<<<<<<<<<< Number Data Points
200  300  400  450  500  600  750  1000  1250  1500  1750  2000  2500  3000  3500  3750  4000  4500  5000  5250  5500  5750  6000  6250  <<<< data 
```

这是一些整洁的东西。您继续调用 Input 并填写数组。据我所知，在 Delphi 中这种现象没有等价物。你不能像那样使用 ReadLn，对吧？在德尔福对我来说，你必须

```
ReadLn(F, S);  //S is a string
z.Delimiter := ' '; //z is a stringlist
z.DelimitedText := S;  //and then breakdown the array 
```

任何想法？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:42:24.250

使用`Read`代替`Readln`; 像这样的东西：

```
var
  ArrLng, Index: Integer;
  Arr: array of Integer;
  F: Text;
begin
  Assign(F, 'your-fie-name');
  OpenFile(F);
  try
    Readln(F, ArrLng);
    SetLength(Arr, ArrLng);
    Index := 0;
    while (not Eof(F)) and (Index < ArrLng) do
    begin
      Read(F, Arr[Index]);
      Inc(Index);
    end;
  finally
    CloseFile(F);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T16:42:30.473

拆分字符串通常是更好的方法，无论是否使用 StringList。

*   [如何将只有十个字符的字符串（例如“12345 * 45688”）拆分为数组](https://stackoverflow.com/questions/5928984/)
*   [根据分隔符将字符串拆分为字符串数组](https://stackoverflow.com/questions/2625707/)
*   [delphi中如何分割字符串](https://stackoverflow.com/questions/6301976/)

但我认为你也可以在那里使用旧的 Pascal 方法。忘记行尾，你可能不需要它。

```
var F: TextFile; I, J, K: integer;
begin
...
ReadLN(F, J);
for i := 1 to J do 
  Read(F, K);
...
end 
```

但我认为这只适用于小众方法（如内存不足），整体 SplitString 方法会更快。

如果你有多行文件，那么两个链式字符串列表将是恕我直言最简单的方法，前提是这些文件不是 GB 大小的。

[https://stackoverflow.com/a/14454614/976391](https://stackoverflow.com/a/14454614/976391) 或利用更多 SL 功能 - [https://stackoverflow.com/a/14649862/976391](https://stackoverflow.com/a/14649862/976391)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:13:20.630

The TStringList class and it's LoadFromFile method. It's got delimiter properties as well.

When you are doing Delphi, treat it like .net. If there's something that should be there, it is, you just haven't found it yet. You can chuck the number of values thing away as well.

# c# - xpath：在元素之前和之后的元素的上下文中查找元素

> ID：15093691
> 
> 赞同：-1
> 
> 时间：2013-02-26T16:02:33.397
> 
> 标签：c#, vb.net, xpath

我正在使用 xpaths 运行使用 VB 在 C# 中开发的自动化。我无法在两个不同元素的上下文中找到一个元素。我需要这样做，因为该元素与页面上的其他元素具有相同的名称，但它后面和前面的元素是唯一的。

我还上传了一个文件来帮助您理解，我想在它之前和之后的上下文中找到日期。

[http://www.filedropper.com/example](http://www.filedropper.com/example)

```
<html>
<head>
</head>
<body>
<div> this is a test 
   <div> <h1> test1 </h1> </div>
   <div> <h1> date </h1> </div>
   <div> <h1> time1 </h1> </div>
   <div> <h1> test2 </h1> </div>
   <div> <h1> date </h1> </div>
   <div> <h1> time2 </h1> </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:11:02.673

这应该这样做：

```
/html/body/div/div/h1[../following-sibling::*[1]/h1/text() = " time2 " and ../preceding-sibling::*[1]/h1/text() = " test2 "] 
```

`following-sibling::*[1]`返回第一个以下兄弟。由于 div 和 h1 元素是嵌套的，因此您必须首先在层次结构中上一层。

# perforce - 从分支覆盖

> ID：15093694
> 
> 赞同：1
> 
> 时间：2013-02-26T16:02:35.293
> 
> 标签：perforce, p4v

我有两个分支_trunk 和_dev。有一个文件夹（实际上是配置），两个分支都在其中执行密集工作。现在我需要从_trunk 合并到_dev。但我只需要合并代码。配置应该被替换。我不确定手动替换它是正确的方法。这个操作怎么调用？你如何做类似的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:29:21.927

这是一个像往常一样的集成，但在解析过程中，您将接受源文件而不尝试将它们合并到目标中。这将用源内容替换目标文件的内容。

编辑：如果源中有添加和删除，请确保让 Perforce 传播这些并选中相应的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T22:55:17.777

您可以从 _trunk 到 _dev 执行“集成/合并”。任何冲突都将在您的待处理更改列表中设置为每个文件的“解决”。

对于代码，您可以让 P4V 尝试为您合并它并手动进行更改/合并。对于配置文件，在解析窗口中执行“接受源” - 这将用源覆盖目标。

同样，如果有任何地方您知道您不想推进您的更改，但仍希望它识别您已检查并适应更改，请使用“接受目标”

# php - swiftmailer 完全损坏 smtp？

> ID：15093702
> 
> 赞同：4
> 
> 时间：2013-02-26T16:02:51.987
> 
> 标签：php

刚刚将我的 swiftmailer 结帐更新到最新版本 4.3.0。以下非常简单的代码不再起作用，并且连接超时：

```
<? 
require_once 'Swift-4.3.0/lib/swift_required.php';

$transport = Swift_SmtpTransport::newInstance('email-smtp.us-east-1.amazonaws.com',465, 'tls')
  ->setUsername('USERNAME')
  ->setPassword('PASSWORD')
  ;
$mailer = Swift_Mailer::newInstance($transport);

// Create a message
$message = Swift_Message::newInstance('Yo')
  ->setFrom(array('jnankin@gmail.com' => 'Josh'))
  ->setTo(array('jnankin@gmail.com'))
  ->setBody('Here is the message itself')
  ;

$result = $mailer->send($message); 
```

然后我得到以下信息：

```
PHP Fatal error:  Uncaught exception 'Swift_IoException' with message 'Connection to tcp://email-smtp.us-east-1.amazonaws.com:465 Timed Out' in /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Transport/StreamBuffer.php:169
Stack trace:
#0 /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Transport/AbstractSmtpTransport.php(400): Swift_Transport_StreamBuffer->readLine(0)
#1 /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Transport/AbstractSmtpTransport.php(291): Swift_Transport_AbstractSmtpTransport->_getFullResponse(0)
#2 /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Transport/AbstractSmtpTransport.php(119): Swift_Transport_AbstractSmtpTransport->_readGreeting()
#3 /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Mailer.php(80): Swift_Transport_AbstractSmtpTransport->start()
#4 /home/jnankin/Desktop/email.php(17): Swift_Mailer->send(Object(Swift_Message))
#5 {main}
  thrown in /home/jnankin/Desktop/Swift-4.3.0/lib/classes/Swift/Transport/StreamBuffer.php on line 169 
```

**更新：**这个完全相同的代码（没有任何更改）在版本 4.1.2 中有效。版本 4.1.3 这不再有效。我尝试过不同的 SMTP 服务器：mailgun、sendgrid 等……这似乎是 swiftmailer 特有的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-26T16:24:05.190

看起来从 4.1.3 版 swiftmailer 开始添加了 starttls 支持。在 4.1.2 和更早的版本中，使用端口 465 并指定“tls”作为加密方法工作正常。然而 4.1.3 看起来它不支持使用 tls 包装器，只允许 starttls。换句话说，“tls”不再是“tls wrapper”的意思，而是“starttls”的意思。因此，将端口更改为 587 而不是 465（正如 SES 文档所说，应该用于 starttls 连接）解决了我的问题。

swiftmailer imho 的非常糟糕的举动。

# grails - 将 init 逻辑外部化为外部文件

> ID：15093706
> 
> 赞同：1
> 
> 时间：2013-02-26T16:03:02.400
> 
> 标签：grails

我想将 BootStrap 初始化内容分解为单独的文件。我的目标是通过将一个相当大的 BootStrap.groovy 文件分解成更小的、智能命名的块来改进它。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:05:24.297

`BootStrap`支持自动装配，因此您可以将逻辑放入服务方法中，将服务注入`BootStrap`并从`init`块中调用方法。

或者，您可以有几个不同的文件，它们的名称以 结尾`BootStrap.groovy`，例如`SecurityBootStrap.groovy`,`DatabaseBootStrap.groovy`等，它们都将被执行。但是我不确定您是否可以保证多个引导脚本将运行的顺序，所以如果顺序很重要，那么服务注入路线更安全。

# menu - 漂亮的菜单如何使活动页面具有不同的颜色 - drupal 7

> ID：15093708
> 
> 赞同：0
> 
> 时间：2013-02-26T16:03:10.587
> 
> 标签：menu, drupal-7

我有一个非常简单的水平菜单，它有一个带有彩色链接的纯色背景。当我在目标页面时如何更改链接的颜色？我试过这个 #nice-menu-1 li a:active 但这只会在我点击它时影响颜色。当我在该页面上时，我希望菜单项的颜色保持不变。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T17:33:15.957

当单击或点击该元素时，元素“在伪类的定义中处于活动状态`:active`。因此，您在上面描述的是预期行为。

您需要：

1.  在与当前页面对应的链接上设置一个类
2.  使用 CSS 定位该类

幸运的是，Nice Menus 和 Drupal 通过向标签添加一个类和向父标签添加一个`.active`类来为您处理 #1 。`<a>``.active-trail``<li>`

所以你可以像这样在 CSS 中定位那些：

```
#nice-menu-1 li.active-trail a,
#nice-menu-1 li a.active { color: #0f0;} 
```

# fortran - 目录路径的修剪字符串

> ID：15093712
> 
> 赞同：1
> 
> 时间：2013-02-26T16:03:27.067
> 
> 标签：fortran

我正在尝试创建文件的完整路径，通过`Read`语句输入父文件夹：

```
PROGRAM fileTest

  IMPLICIT NONE

  Character(LEN=20) :: dirpath,fullpath

  Write(6,*) 'Enter dir path'
  Read(*,'(a)') dirpath
  dirpath=TRIM(dirpath)
  fullpath=dirpath//'/file.abc'
  print*,fullpath

END PROGRAM fileTest 
```

使用 gfortran，代码编译，但`/home/chris`在最终的打印语句中输入结果仍然给出

```
/home/chris         /file.abc 
```

（注意空格的 9 个字符）。

我如何摆脱虚假的空白？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:18:48.507

发生这种情况是因为`dirpath`它仍然是一个`character(len=20)`变量，所以它的内容在 . 之后再次用空格填充`dirpath=TRIM(dirpath)`。您必须像这样进行修剪：

```
fullpath = trim(dirpath)//'/file.abc' 
```

**编辑：**
作为可分配字符串的演示（请参阅我的评论），如果您的编译器支持此功能，您应该能够更令人满意地处理任意字符串长度：

```
character(:), allocatable  :: fullpath
character(len=some_length) :: buffer

write(6,*) 'Enter dir path'
read(*,'(a)') buffer
fullpath = trim(buffer) // '/file.abc' 
```

该字符串`fullpath`应自动分配以适应右侧的确切长度。

# java - actionPerformed() 用于按住按钮

> ID：15093718
> 
> 赞同：2
> 
> 时间：2013-02-26T16:03:38.093
> 
> 标签：java, swing, jbutton, actionlistener

现在我有：

```
panel.getZoomButton().addActionListener(new ActionListener()
{
    @Override
    public void actionPerformed(ACtionEvent e)
    {
        zoom();
    }
} 
```

每次按下缩放按钮时都会调用它。`zoom()`如果按住缩放按钮，如何更改它以便连续调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:13:15.453

You will need to use a `MouseListener` and override the `mousePressed()` method. There you can use a Timer or something similar to measure the time, the button has been pressed, in order to calculate your zoom.

Perhaps this question helps you with that: [Java MouseEvent, check if pressed down](https://stackoverflow.com/questions/6828684/java-mouseevent-check-if-pressed-down)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T16:24:06.173

*   使用[Swing Action](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)（最可扩展的抽象）而不是[ActionListener](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)，您可以设置[isEnabled](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html#isEnabled%28%29)，切换到`false value`直到所有事件完成

*   或添加[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)`Boolean`以重置`true value`

*   有可能[setMultiClickThreshhold(long threshhold)](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractButton.html#setMultiClickThreshhold%28long%29)，但仅适用于 MouseEvents，此方法不会对键盘触发`KeyBindings`(`ENTER`和) 做出反应`TAB`

# ember.js - Ember.js：用视图替换简单的 linkTo 助手

> ID：15093723
> 
> 赞同：2
> 
> 时间：2013-02-26T16:03:48.290
> 
> 标签：ember.js, handlebars.js

我有一个内置了基本功能的应用程序。我不会经历并添加其他功能。在这种情况下，我需要将当前使用的简单按钮转换`linkTo`为视图。问题是我不确定如何将一个转换为另一个并且仍然保持链接完整。

我该如何进行这种转换？这是我现在拥有的代码：

```
<script type="text/x-handlebars" data-template-name="accountItem">
{{#each account in controller}}
    {{#linkTo "account" account}}
        <img {{bindAttr src="account.icon"}} />
    {{/linkTo}}
{{/each}}
</script> 
```

这是我将拥有的代码：

```
<script type="text/x-handlebars" data-template-name="accountItem">
{{#each account in controller}}
    {{#view "Social.AccountButtonView"}}
        <img {{bindAttr src="account.icon"}} />
    {{/view}}
{{/each}}
</script>

Social.AccountButtonView = Ember.View.extend({
    tagName: 'a',
    classNames: ['item-account'],
    click: function(){
        // do something
    }
}); 
```

我会假设我将在视图中的单击处理程序之上构建，但我不确定如何将引用传递给被迭代的项目，也不知道如何在视图中引用正确的路由。

请帮忙？

**更新 1**

`#/accounts/4`第一个版本根据我设置的路由器呈现一个值为 的 href 属性：

```
Social.Router.map(function() {
    this.resource('accounts', function(){
        this.resource('account', { path: ':account_id'});
    });
}); 
```

当我将当前代码转换为视图时，如何模仿 linkTo 提供的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:31:44.753

`account`您可以在车把模板中定义属性绑定。此绑定的工作方式如下：

```
<script type="text/x-handlebars">
    <h1>App</h1> 
    {{#each item in controller}}
        {{#view App.AccountView accountBinding="item"}}
            <a {{bindAttr href="view.account.url"}} target="_blank">
                {{view.account.name}}
            </a>
        {{/view}}
    {{/each}}
</script> 
```

请注意，我添加了`accountBinding`，所以一般规则是`propertyName`和`Binding`作为后缀。请记住，当您将属性添加到视图时，您将无法直接访问它，而是必须使用`view.propertyName`如上所示的方式访问它。

请记住，`View`使用帮助程序时必须有一个类`{{view}}`：

```
window.App = Em.Application.create();
App.AccountView = Em.View.extend(); // this must exist
App.ApplicationRoute = Em.Route.extend({
    model: function() {
        return [
            {id: 1, name: 'Ember.js', url: 'http://emberjs.com'}, 
            {id: 2, name: 'Toronto Ember.js', url: 'http://torontoemberjs.com'}, 
            {id: 3, name: 'JS Fiddle', url: 'http://jsfiddle.com'}];    
    }
}) 
```

工作小提琴：http: [//jsfiddle.net/schawaska/PFxHx/](http://jsfiddle.net/schawaska/PFxHx/)

响应**更新 1**：

我发现自己处于类似的场景中，并最终创建了一个子视图来模仿`{{linkTo}}`助手。我真的不知道/认为这是最好的实现。你可以在这里看到我以前的代码：http: [//jsfiddle.net/schawaska/SqhJB/](http://jsfiddle.net/schawaska/SqhJB/)

当时我在以下位置创建了一个子视图`ApplicationView`：

```
App.ApplicationView = Em.View.extend({
  templateName: 'application',
  NavbarView: Em.View.extend({
    init: function() {
      this._super();
      this.set('controller', this.get('parentView.controller').controllerFor('navbar'))
    },
    selectedRouteName: 'home',
    gotoRoute: function(e) {
      this.set('selectedRouteName', e.routeName);
      this.get('controller.target.router').transitionTo(e.routePath);
    },
    templateName: 'navbar',
    MenuItemView: Em.View.extend({
      templateName:'menu-item',
      tagName: 'li',
      classNameBindings: 'IsActive:active'.w(),
      IsActive: function() {
        return this.get('item.routeName') === this.get('parentView.selectedRouteName');
      }.property('item', 'parentView.selectedRouteName')
    })
  })
}); 
```

我的车把看起来像这样：

```
<script type="text/x-handlebars" data-template-name="menu-item">
  <a {{action gotoRoute item on="click" target="view.parentView"}}>
  {{item.displayText}}
  </a>
</script>

<script type="text/x-handlebars" data-template-name="navbar">
  <ul class="left">
    {{#each item in controller}}
      {{view view.MenuItemView itemBinding="item"}}
    {{/each}}
  </ul>
</script> 
```

对不起，我不能给你更好的答案。这是我当时能想到的，从那以后就再也没有碰过。就像我说的，我不认为这是处理它的方法。如果您愿意查看[`{{linkTo}}`帮助程序源代码](https://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/helpers/link_to.js)，您将看到一个模块化且优雅的实现，可以作为您自己实现的基础。我猜你正在寻找的部分是`href`这样定义的属性：

```
var LinkView = Em.View.extend({
...
    attributeBindings: ['href', 'title'],   
    ... 
    href: Ember.computed(function() {
      var router = this.get('router');
      return router.generate.apply(router, args(this, router));
    })
...
}); 
```

所以我想，从那里你可以理解它是如何工作的并自己实现一些东西。让我知道这是否有帮助。

# jquery - Uncaught SyntaxError: Unexpected token < With $.jsonp and webservices

> ID：15093724
> 
> 赞同：1
> 
> 时间：2013-02-26T16:03:48.727
> 
> 标签：jquery, xml, web-services, jsonp

我能够使用 jquery 插件修复我的 webservice ajax 问题。称为 jquery.jsonp.js。现在在我的成功功能上，我得到了一个 Uncaught

```
 SyntaxError: Unexpected token < 
```

chrome 控制台窗口上的错误。我尝试了各种方法来解决这个问题，但我不知所措

```
$.jsonp({
    type: "POST",
    url: "http://localhost:49524/mobile/Android/AndroidWebServices.asmx/CheckLogin",
    data: "email="+u+"&password="+p,
    crossDomain:true,
    success: function (data) {
        var s = $(data).find('string').text();;
        alert(s);
    }
}); 
```

如果有更好的方法从 xml 中获取价值，我将不胜感激任何帮助

```
<string xmlns="http://wmstec.com/">true</string> 
```

是从 Web 服务返回的 XML 文件

```
 [WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public string CheckLogin(string email, string password)
{

    string vid = "xxxx";

    //Get the User Information
    DB.User cur_user = DB.User.ByEmail(email.Trim());
    //if it failed, try by screen name
    if (-1 == cur_user.ID) { cur_user = DB.User.ByScreenName(email.ToLower()); }

    //Does their password match?

   if (cur_user.CheckPassword(password, vid))
    {
    // companys ToJSON function 
       return Utility.ToJSON("true");
    }
    else
    {
        return Utility.ToJSON(return "false");
    }
} 
```

更新

```
$.ajax({
    type : "GET",
    url: "http://localhost:49524/mobile/Android/AndroidWebServices.asmx/CheckLogin",
    crossDomain:true,
    data: "email="+u+"&password="+p,//({ email: u, password: p}),
    dataType :"jsonp",
    contentType: "application/json; charset=utf-8",
    success : function(data){
        alert(data);}

}); 
```

返回相同的东西..所以它不一定是 jsonp 插件是一个问题.. 它显然是一个用户问题大声笑..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:07:31.773

`jquery.jsonp.js`是一个用于通过 HTTP 访问以 JSON-P 表示的数据的库。

`<string xmlns="http://wmstec.com/">true</string>`是表示为 XML 的数据，而不是 JSON-P（JSON-P 由一个`application/javascript`程序组成，该程序由单个函数调用（对您定义的函数）组成，服务的数据作为该调用的参数）。

如果您想使用这种方法，您将需要更改 Web 服务以输出 JSON-P。

# ruby-on-rails - Rails.cache.fetch *.to_s 有什么作用？

> ID：15093728
> 
> 赞同：1
> 
> 时间：2013-02-26T16:03:55.310
> 
> 标签：ruby-on-rails

```
if Rails.cache
  Rails.cache.fetch(20.to_s) # ec2-50-17-225-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch(0.to_s)  # ec2-174-129-33-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch(10.to_s) # ec2-174-129-16-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch(30.to_s) # ec2-54-242-2-XX.compute-1.amazonaws.com:11212
end 
```

我不完全确定这段代码的作用。是设置缓存变量吗？它以某种方式阅读吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:12:41.067

简单地将`to_s`数字（20、0 等）转换为字符串（“20”、“0”等）。所以它与此相同：

```
if Rails.cache
  Rails.cache.fetch("20") # ec2-50-17-225-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch("0")  # ec2-174-129-33-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch("10") # ec2-174-129-16-XX.compute-1.amazonaws.com:11212
  Rails.cache.fetch("30") # ec2-54-242-2-XX.compute-1.amazonaws.com:11212
end 
```

因此，在某处，这些亚马逊 URL 使用键“20”、“0”等存储在缓存中，然后上面的代码从缓存中检索这些值。

（根据所使用的缓存存储，例如 ActiveSupport::Cache::FileStore 或 Dalli，您可以只使用整数值而无需先转换为字符串，因此这`to_s`可能是不必要的）。

# java - 无法运行 GWT 应用程序：org.mortbay.jetty.AbstractConnector.setReuseAddress(Z)V

> ID：15093732
> 
> 赞同：0
> 
> 时间：2013-02-26T16:04:18.837
> 
> 标签：java, eclipse, gwt, jetty

当我尝试从 Eclipse 运行我的 GWT 应用程序时，出现以下异常：

```
Exception in thread "main" java.lang.NoSuchMethodError: org.mortbay.jetty.AbstractConnector.setReuseAddress(Z)V
at com.google.gwt.dev.shell.jetty.JettyLauncher.setupConnector(JettyLauncher.java:529)
at com.google.gwt.dev.shell.jetty.JettyLauncher.start(JettyLauncher.java:662)
at com.google.gwt.dev.DevMode.doStartUpServer(DevMode.java:509)
at com.google.gwt.dev.DevModeBase.startUp(DevModeBase.java:1093)
at com.google.gwt.dev.DevModeBase.run(DevModeBase.java:836)
at com.google.gwt.dev.DevMode.main(DevMode.java:311) 
```

同时，GWT 开发模式工具打开，但没有任何反应。

![](../Images/6956bb5f35c20095ce526288560e3bd0.png)

我正在为我的项目的依赖项使用 maven，并且我已经将所有条目移到了构建类路径设置的底部。还是没有变化。。

有谁知道如何解决这一问题？

# python - 如何使 Python 循环生成成为有条件的？

> ID：15093745
> 
> 赞同：0
> 
> 时间：2013-02-26T16:04:49.353
> 
> 标签：python, string, loops, tuples, conditional-statements

我有一些这样的 Python 代码：

```
print seq(y), '\t', ', '.join(['%s-%s'%i for i in holetbl[y]]) 
```

但我想让内部字符串生成有条件。in 循环是两个值的`i`元组，它们被放入`%s`字符串中的两个值中。在元组值相同的情况下，我只喜欢一个值，如下所示：

```
print seq(y), '\t', ', '.join(['%s'%i for i, j in holetbl[y]]) 
```

如何设置条件来测试是否`i == j`以及是否仅打印该`i`值，否则，以及上述原始值中的`i`和值？`j`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:06:37.593

您可以使用[条件表达式](http://docs.python.org/2/reference/expressions.html#conditional-expressions)

```
print seq(y), '\t', ', '.join('%s' % i if i == j else '%s-%s' % (i, j)
                              for i in holetbl[y]) 
```

**笔记**

您无需制定要传递给的列表`str.join`。一个简单的生成器表达式就可以了。这将更加内存友好并且相对更快

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:07:18.327

关于什么

```
'%s-%s'%(i,j) if i != j else '%s'%i 
```

# ios - 如何使 MKMap 适合指定的 View-Region？

> ID：15093747
> 
> 赞同：1
> 
> 时间：2013-02-26T16:04:55.200
> 
> 标签：ios, cocoa-touch, cocoa, mkmapview

我在设置 MKMapView 时遇到了一点问题。我真的只是希望完整的地图适合 Storyboard 中指定的 MkMapView-Region。但似乎无法缩放或缩放地图，结果整个世界都是可见的。这是它的样子：

![在此处输入图像描述](../Images/91d6b9ed7e0b81375e3158b11bb0a088.png)

因此，如果我想同时显示连接的注释，如果它们彼此远离，它将无法工作。因为不可能使整个地图适合。也许我错过了设置 MapView 的步骤，但我不明白。任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:09:58.590

您可以使用MKMapView的以下方法

```
- (void)setRegion:(MKCoordinateRegion)region animated:(BOOL)animated 
```

设置中心点和缩放级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:56:41.347

希望这会帮助你。

如果只有 1 个注释，那么让我们有一个很好的缩放比例，比如 10 倍。否则缩放直到我们只看到所有注释（+一些额外的填充:)

```
if ([currentMapView.annotations count] == 1) {
    region.span.latitudeDelta = 0.02;
    region.span.longitudeDelta = 0.02;
} else {
    region.span.latitudeDelta = fabs(topLeftCoord.latitude - bottomRightCoord.latitude) * 1.1; // Add a little extra space on the sides
    region.span.longitudeDelta = fabs(bottomRightCoord.longitude - topLeftCoord.longitude) * 1.1; // Add a little extra space on the sides
} 
```

# pygame - Pygame 精灵由于未知原因未显示

> ID：15093754
> 
> 赞同：1
> 
> 时间：2013-02-26T16:05:08.833
> 
> 标签：pygame, python-2.x

好的，所以我现在已经尝试修复我的 Pygame 代码 5 天，这样我就可以像平台精灵一样绘制怪物精灵了。

我的代码找不到错误，我的朋友也找不到。

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import pygame, random, sys, os
from pygame.locals import *

pygame.init() #pygame initieres

#skærm indstillinger
window_size = [800, 600]
window_mode = 0
window_color_rate = 32
screen = pygame.display.set_mode(window_size, window_mode, window_color_rate)
background_image = 'background.jpg'
background = (pygame.transform.scale(pygame.image.load(background_image).convert(), (800, 600)))
pygame.display.set_caption('I Wanna Be the Reindeer')
clock = pygame.time.Clock()

class Platform(pygame.sprite.Sprite):
    def __init__(self, color, x, y, width, height):
        pygame.sprite.Sprite.__init__(self)
        platform_image = 'platform.jpg'
        self.image = pygame.transform.scale(pygame.image.load(platform_image).convert(), ([width, height]))
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

class Monster(pygame.sprite.Sprite):
    def __init__(self, x, y, width, height):
        pygame.sprite.Sprite.__init__(self)
        monster_image = 'platform.jpg'
        self.image = pygame.transform.scale(pygame.image.load(monster_image).convert(), ([width, height]))
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

class Goal(pygame.sprite.Sprite):
    def __init__(self, color, x, y, width, height):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.Surface([width, height])
        self.image.fill(color)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

class Player(pygame.sprite.Sprite):
    #variabler spilleren ændre
    change_x = 0
    change_y = 0
    jump_ready = False
    frame_since_collision = 0
    frame_since_jump = 0
    levelpoints = 0
    player_right = 'mobright.png'
    player_left = 'mobleft.png'

    def __init__(self, color, x, y):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.transform.scale(pygame.image.load(Player.player_right).convert_alpha(), [30, 30])
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

    def changespeed_x(self, x):
        self.change_x = x

    def changespeed_y(self, y):
        self.change_y = y

    def jump(self):
        self.jump_ready = True
        self.frame_since_jump = 0

    def update(self, platforms):
        old_x = self.rect.x
        new_x = old_x + self.change_x
        self.rect.x = new_x

        old_y = self.rect.y
        new_y = old_y + self.change_y
        self.rect.y = new_y

        collide = pygame.sprite.spritecollide(self, platforms, False)
        if collide:
            self.rect.x = old_x

        platform_hit_list = pygame.sprite.spritecollide(self, platforms, False)
        for platform in platform_hit_list:
            self.rect.x = old_x
            self.rect.y = old_y
            self.change_y = 0
            self.frame_since_collision = 0

        if self.frame_since_collision < 1 and self.frame_since_jump < 6:
            self.frame_since_jump = 5
            self.change_y -= 10

        self.frame_since_collision += 1
        self.frame_since_jump += 1

    def gravity(self):
        self.change_y += 0.35

        if self.rect.y >= 570 and self.change_y >= 0:
            self.change_y = 0
            self.rect.y = 570
            self.frame_since_collision = 0

    def goalcheck(self, goals):
        goal_hit_list = pygame.sprite.spritecollide(self, goals, True)
        for goals in goal_hit_list:
            Player.levelpoints += 1

'''class Monster(pygame.sprite.Sprite):
    global walk_quota
    walk_quota = 0
    def __init__(self, x, y, walk_distance, walk_interval):
        pygame.sprite.Sprite.__init__(self)
        monster_image = 'monsterright.png'
        self.image = pygame.transform.scale(pygame.image.load(monster_image).convert_alpha(), [35, 35])
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y
        self.walk_distance = walk_distance
        self.walk_interval = walk_interval

    def walking(self):
        global walk_quota
        if self.walk_distance > walk_quota:
            self.rect.x += self.walk_interval
            walk_quota += self.walk_interval
            print walk_quota
'''

    #spilleren skabes
player = Player([255, 255, 0], 20, 15)
player.rect.x = 700
player.rect.y = 550

#monster funktioner
#def monsterwalk():
#   for monster in monster_list:
#       monster.walking()

#gruppe indstillinger
all_sprites_list = pygame.sprite.Group()
platform_list = pygame.sprite.Group()
goal_list = pygame.sprite.Group()
monster_list = pygame.sprite.Group()
all_sprites_list.add(player)
all_sprites_list.add(platform_list)
all_sprites_list.add(goal_list)
all_sprites_list.add(monster_list)

#level 1
def level1():
    if Player.levelpoints == 0:
        goal = goal_list.add(Goal((0, 255, 0), 50, 80, 20, 20))
        monster = monster_list.add(Monster(400, 600, 200, 200))
        for i in range(1, 6):
            platform = platform_list.add(
                [Platform((0, 0, 255), 50, 100, i * 20, 20)])
        for i in range(1, 6):
            platform = platform_list.add(
                [Platform((0, 0, 255), 150, 200, i * 20, 20)])
        for i in range(1, 6):
            platform = platform_list.add(
                [Platform((0, 0, 255), 250, 300, i * 20, 20)])
        for i in range(1, 6):
            platform = platform_list.add(
                [Platform((0, 0, 255), 350, 400, i * 20, 20)])
        for i in range(1, 6):
            platform = platform_list.add(
                [Platform((0, 0, 255), 450, 500, i * 20, 20)])
        Player.levelpoints += 1

#level2
def level2():
    if Player.levelpoints == 2:
        platform_list.empty()
        platform = platform_list.add(
        [Platform((0, 0, 255), 600, 200, 100, 20)], 
        [Platform((0, 0, 255), 600, 300, 100, 20)], 
        [Platform((0, 0, 255), 600, 400, 100, 20)])
        Player.levelpoints += 1

#*------Main loop------*
while True: 
    #styring af spiller
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            sys.exit()
        if event.type == pygame.KEYDOWN:
            if event.key == K_LEFT:
                player.changespeed_x(-4)
                player.image = pygame.transform.scale(pygame.image.load(Player.player_left).convert_alpha(), [30, 30])
            if event.key == K_RIGHT:
                player.changespeed_x(4)
                player.image = pygame.transform.scale(pygame.image.load(Player.player_right).convert_alpha(), [30, 30])
            if event.key == K_DOWN:
                player.changespeed_y(6)
            if event.key == K_UP:
                player.jump()
        if event.type == KEYUP:
            if event.key == K_LEFT:
                player.changespeed_x(0)
            if event.key == K_RIGHT:
                player.changespeed_x(0)

    if player.rect.x >= 800:
        player.rect.x = -15

    if player.rect.x <= -20:
        player.rect.x = 799

    #initiering af levels
    level1()
    level2()

    #funktioner til opdating af objekter
    player.gravity()
    player.update(platform_list)
    player.goalcheck(goal_list)
    platform_list.update()
    monster_list.update()
    #monsterwalk()

    #sprites og billeder der skal tegnes på skærmen
    screen.fill((0, 0, 0))
    screen.blit(background, [0, 0])
    all_sprites_list.draw(screen)
    platform_list.draw(screen)
    monster_list.draw(screen)
    goal_list.draw(screen)

    clock.tick(500)
    print Player.levelpoints
    pygame.display.update() 
```

就像现在一样，我可以让我的球员、目标和平台展示，但不能展示怪物。

注意：怪物只使用平台图像作为占位符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:43:07.523

您只需将其绘制到屏幕外即可。

屏幕是`800x600`，您在 处绘制它`400, 600`，因此它位于屏幕下边缘的正下方：

![在此处输入图像描述](../Images/223c6c569e249d918019998186dc423d.png)

`400, 600 - height_of_monster_image`例如，改为尝试。

# css - Mixins 中的 Sass 占位符

> ID：15093756
> 
> 赞同：3
> 
> 时间：2013-02-26T16:05:18.923
> 
> 标签：css, sass

我想使用从样式块传递的任意值动态创建 Sass 占位符：

```
@mixin example-mixin($arg) {
    %placeholder-#{$arg} {
        property: $arg;
    }
    @extend %placeholder-#{$arg};
} 
```

调用混音：

```
.classname {
    @include example-mixin('value');
} 
```

这几乎可以工作，但由于某种原因，在 CSS 输出`.classname`中给出了两次，就好像它是一个后代选择器：

```
.classname .classname {
    property: value;
} 
```

我没有看到重复类名背后的逻辑 - 任何人都可以看到我做错了什么和/或建议解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T17:47:09.620

让我们看看如果你使用真正的类而不是扩展类会发生什么

```
.a {
    .b {
        color: blue;
    }

    @extend .b;
} 
```

输出：

```
.a .b, .a .a {
  color: blue;
} 
```

我能想象你想要这样做的唯一原因是你可以使用扩展类来扩展而不是`.classname`像这样：

```
.c {
    @extend .b;
} 
```

您会看到输出可能根本不是您想要的：

```
.a .b, .a .a, .a .c {
  color: blue;
} 
```

这`.a .a`对我来说也没有多大意义，但它是无害的。你真正想要做的是这样的：

```
%placeholder-name, .classname {
    property: name;
}

.foo {
    @extend %placeholder-name;
} 
```

输出将是这样的：

```
.foo, .classname {
  property: name;
} 
```

# android - EditText 光标在 Android 4.0 中不可见

> ID：15093758
> 
> 赞同：21
> 
> 时间：2013-02-26T16:05:19.740
> 
> 标签：android, android-edittext, android-4.0-ice-cream-sandwich

我`EditText`在 Android 4.0 中有一个输入，但光标没有显示在其中。

什么可以让光标不出现在输入栏？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-09-25T07:12:10.680

Make `android:cursorVisible="true"`

and

If you have used `android:textColor` then set the `android:textCursorDrawable` attribute to `@null`.

Happy coding ;)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-01T23:57:25.673

我有一个类似的问题，但这是因为光标实际上是白色的，我有一个白色的背景。我需要能够以某种方式在代码中将光标更改为黑色并使用这种方法。

我创建了一个名为 textbox.axml 的布局资源，其中包含这个

```
 <?xml version="1.0" encoding="utf-8"?>
   <EditText xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="This is a template"
    android:background="#ffffff"
    android:textColor="#000000"
    android:cursorVisible="true"
    android:textCursorDrawable="@null" /> 
```

然后我在代码中应用了这个布局（C#，因为我使用的是 Xamarin）因此

```
 EditText txtCompletionDate = (EditText)LayoutInflater.Inflate(Resource.Layout.textbox, null); 
```

但它在Java中是相似的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-07-18T06:40:40.633

在 xml 文件中为您的编辑文本添加这一行。

```
android:textCursorDrawable="@null" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-16T09:49:54.493

我遇到了同样的问题——光标只有在用户输入一些字符后才会出现。我尝试了此处列出的解决方案，但在我的设备上没有任何成功。实际上对我有用的是为我的edittext设置空白文本：

```
EditText editText = findViewById(R.id.edit_text);
editText.setText(""); 
```

这会“伪造”用户输入，并出现光标。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-17T22:29:15.300

我的问题是我使用的是 AppCompat 主题，但是我有一些扩展 EditText 的自定义视图类，需要扩展 AppCompatEditText 才能正确应用 AppCompat 样式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-26T16:15:02.753

在 xml 文件中为您的编辑文本添加这一行。

```
android:cursorVisible="true" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-22T00:53:55.137

只需将我自己的个人修复添加给任何可能有帮助的人。我在这里尝试了一切，但强制`android:background="@null"`只在我右对齐的末尾导致一个非常小的光标`TextEdit`（它在其他地方工作正常）。

只需添加`android:padding="1dp"`我`TextEdit`就解决了这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-27T18:06:37.517

我找到了导致它发生在我身上的原因。

您需要从应用程序的主题继承它。我不确定该行项目究竟需要什么，但`android:Theme`它的继承性足以做到这一点。

使用默认值`AppBaseTheme`将起作用（它具有`android:Theme.Light`父级）。

在清单中使用`AppBaseTheme`put into your application 标记。`android:theme="@style/AppBaseTheme"`您也可以使用自定义样式和多级继承，只要其中一个`parent="android:Theme"`在样式标签中。就像我说的那样，可能没有它，只使用某些行项目，但我不知道那些会是什么。

如果您不需要自定义主题，您可以使用

`android:theme="@android:style/Theme"`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-28T08:24:49.197

如果 EditText 有一个带边框的背景可绘制对象，则光标显示在边框中并且看起来是不可见的。纠正问题，将 EditText 中的填充设置为少量，例如 5dp

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-17T11:39:04.640

在我的情况下，如果用户语言是英语，则光标可见，但如果他将语言更改为阿拉伯语，则光标不可见。

为了解决这个问题，我为光标创建了自定义可绘制对象。

可绘制/black_cursor.xml 中的光标形状

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle" >
    <solid android:color="#a8a8a8"/><!-- This is the exact color of android edit text Hint -->
    <size android:width="1dp" />
</shape> 
```

编辑文字：

```
<EditText
    android:id="@+id/user_name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textSize="20sp"
    android:textCursorDrawable="@drawable/black_cursor"
    /> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-23T09:54:24.403

如上所述，这是实际的行
android:textCursorDrawable="@null"

```
 <EditText
               android:textCursorDrawable="@null"
                android:imeOptions="actionNext"
                android:id="@+id/edSMobile"
                 android:layout_width="match_parent"
                android:layout_height="wrap_content"                    
                android:background="@drawable/edit_corner"                    
                android:inputType="phone" /> 
```

# c# - C# WeakReference 对象在终结器中为 NULL，但仍被强引用

> ID：15093762
> 
> 赞同：4
> 
> 时间：2013-02-26T16:05:25.290
> 
> 标签：c#, garbage-collection, weak-references, finalizer

嗨，我在这里有代码，我不明白我为什么要打断点（见评论）。

这是我不知道或我不正确理解的微软错误吗？

该代码在 Debug 中进行了测试，但我认为它不应该改变任何东西。

注意：您可以直接在控制台应用程序中测试代码。

仅供参考...在 supercat 回答之后，我用建议的解决方案修复了我的代码，它运行良好:-) !!! 坏事是静态字典的使用以及随之而来的性能，但它确实有效。...几分钟后，我意识到 SuperCat 给了我所有提示，让我做得更好，解决静态字典，我做到了。代码示例是：

1.  有错误的代码
2.  代码已更正但使用静态 ConditionalWeakTable
3.  包含 SuperCat 技巧的 ConditioalWeakTable 代码（非常感谢他！）

样品...

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace WeakrefBug
{

// **********************************************************************
class B : IDisposable
{
    public static List<B> AllBs = new List<B>();

    public B()
    {
        AllBs.Add(this);
    }

    private bool disposed = false;
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!disposed)
        {
            AllBs.Remove(this);
            disposed = true;
        }
    }

    ~B() { Dispose(false); }
}

// **********************************************************************
class A
{
    WeakReference _weakB = new WeakReference(new B());

    ~A()
    {
        B b = _weakB.Target as B;
        if (b == null)
        {
            if (B.AllBs.Count == 1)
            {
                Debugger.Break(); // b Is still referenced but my weak reference can't find it, why ?
            }
        }
        else { b.Dispose(); }
    }
}

// **********************************************************************
class Program
{
    static void Main(string[] args)
    {
        A a = new A();
        a = null;

        GC.Collect(GC.MaxGeneration);
        GC.WaitForPendingFinalizers();
    }
    }

    // **********************************************************************
} 
```

更正的版本：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Runtime.CompilerServices;

namespace WeakrefBug // Working fine with ConditionalWeakTable
{
    // **********************************************************************
    class B : IDisposable
    {
        public static List<B> AllBs = new List<B>();

        public B()
        {
            AllBs.Add(this);
        }

        private bool disposed = false;
        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                AllBs.Remove(this);
                disposed = true;
            }
        }

        ~B() { Dispose(false); }
    }

    // **********************************************************************
    class A
    {
        private static readonly System.Runtime.CompilerServices.ConditionalWeakTable<A, B> WeakBs = new ConditionalWeakTable<A, B>();

        public A()
        {
            WeakBs.Add(this, new B());          
        }

        public B CreateNewB()
        {
            B b = new B();
            WeakBs.Remove(this);
            WeakBs.Add(this, b);
            return b;
        }

        ~A()
        {
            B b;
            WeakBs.TryGetValue(this, out b);

            if (b == null)
            {
                if (B.AllBs.Count == 1)
                {
                    Debugger.Break(); // B Is still referenced but my weak reference can't find it, why ?
                }
            }
            else { b.Dispose(); }
        }
    }

    // **********************************************************************
    class Program
    {
        static void Main(string[] args)
        {
            A a = new A();
            WeakReference weakB = new WeakReference(a.CreateNewB()); // Usually don't need the internal value, but only to ensure proper functionnality
            a = null;

            GC.Collect(GC.MaxGeneration);
            GC.WaitForPendingFinalizers();

            Debug.Assert(!weakB.IsAlive);
        }
    }

    // **********************************************************************
} 
```

包含 SuperCat 技巧的 ConditioalWeakTable 代码（非常感谢他！）

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Runtime.CompilerServices;

namespace WeakrefBug // Working fine with non static ConditionalWeakTable - auto cleanup
{
    // **********************************************************************
    class B : IDisposable
    {
        public static List<B> AllBs = new List<B>();

        public B()
        {
            AllBs.Add(this);
        }

        private bool disposed = false;
        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                AllBs.Remove(this);
                disposed = true;
            }
        }

        ~B() { Dispose(false); }
    }

    // **********************************************************************
    class A
    {
        private ConditionalWeakTable<object, object> _weakBs = null;

        public A()
        {
        }

        public B CreateNewB()
        {
            B b = new B();
            if (_weakBs == null)
            {
                _weakBs = new ConditionalWeakTable<object, object>();
                _weakBs.Add(b, _weakBs);
            }
            _weakBs.Remove(this);
            _weakBs.Add(this, b);
            return b;
        }

        internal ConditionalWeakTable<object, object> ConditionalWeakTable // TestOnly
        {
            get { return _weakBs; }
        }

        ~A()
        {
            object objB;
            _weakBs.TryGetValue(this, out objB);

            if (objB == null)
            {
                if (B.AllBs.Count == 1)
                {
                    Debugger.Break(); // B Is still referenced but my weak reference can't find it, why ?
                }
            }
            else
            {
                ((B)objB).Dispose();
            }
        }
    }

    // **********************************************************************
    class Program
    {
        static void Main(string[] args)
        {
            A a = new A();
            WeakReference weakB = new WeakReference(a.CreateNewB()); // Usually don't need the internal value, but only to ensure proper functionnality
            WeakReference weakConditionalWeakTable = new WeakReference(a.ConditionalWeakTable);
            a = null;

            GC.Collect(GC.MaxGeneration);
            GC.WaitForPendingFinalizers();

            Debug.Assert(!weakB.IsAlive);
            Debug.Assert(!weakConditionalWeakTable.IsAlive);
        }
    }

    // **********************************************************************

} 
```

在 CitizenInsane 的问题之后......我不记得我究竟为什么做了我所做的......我找到了我的样本，但当时不确定我的意图。我试图弄清楚并附带了以下代码，我认为它更清楚，但仍然不记得我最初的需求。对不起 ？？？

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Runtime.CompilerServices;

namespace WeakrefBug // Working fine with ConditionalWeakTable
{
    // **********************************************************************
    class B : IDisposable
    {
        public static List<B> AllBs = new List<B>();

        public B()
        {
            AllBs.Add(this);
        }

        private bool disposed = false;
        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                AllBs.Remove(this);
                disposed = true;
            }
        }

        ~B() { Dispose(false); }
    }

    // **********************************************************************
    class A
    {
        private ConditionalWeakTable<object, object> _weakBs = null;
        private WeakReference _weakB = null;

        public A()
        {
            _weakBs = new ConditionalWeakTable<object, object>();
            B b = new B();
            _weakB = new WeakReference(b);
            _weakBs.Add(b, _weakB);
        }

        public B B
        {
            get
            {
                return _weakB.Target as B;
            }
            set { _weakB.Target = value; }
        }

        internal ConditionalWeakTable<object, object> ConditionalWeakTable // TestOnly
        {
            get { return _weakBs; }
        }

        ~A()
        {
            B objB = B;

            if (objB == null)
            {
                if (B.AllBs.Count == 1)
                {
                    Debugger.Break(); // B Is still referenced but my weak reference can't find it, why ?
                }
            }
            else
            {
                ((B)objB).Dispose();
            }
        }
    }

    // **********************************************************************
    class Program
    {
        static void Main(string[] args)
        {
            Test1();
            Test2();
        }

        private static void Test1()
        {
            A a = new A();
            WeakReference weakB = new WeakReference(a.B); // Usually don't need the internal value, but only to ensure proper functionnality
            WeakReference weakConditionalWeakTable = new WeakReference(a.ConditionalWeakTable);

            a = null;

            GC.Collect(GC.MaxGeneration);
            GC.WaitForPendingFinalizers();

            Debug.Assert(B.AllBs.Count == 0);

            GC.Collect(GC.MaxGeneration);
            GC.WaitForPendingFinalizers();

            Debug.Assert(!weakB.IsAlive); // Need  second pass of Collection to be collected
            Debug.Assert(!weakConditionalWeakTable.IsAlive);
        }

        private static void Test2()
        {
            A a = new A();
            WeakReference weakB = new WeakReference(a.B);

            B.AllBs.Clear();
            a.B = null;

            GC.Collect(GC.MaxGeneration);
            GC.WaitForPendingFinalizers();

            Debug.Assert(!weakB.IsAlive); // Need  second pass of Collection to be collected
        }
    }

    // **********************************************************************

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T23:57:28.373

有时令人讨厌的限制是，如果不存在对*自身*`WeakReference`的强根引用，则 a可能会失效，即使构造函数参数是，并且*即使 的目标**是强根*的，也可能会发生这种情况。这种行为源于 a有一个非托管资源（一个 GC 句柄），如果 的终结器没有清理 GC 句柄，它将永远不会被清理并会构成内存泄漏。`WeakReference``WeakReference` *`trackResurrection``true`*`WeakReference`*`WeakReference``WeakReference`*

 *如果对象的终结器有必要使用`WeakReference`对象，则该对象必须做出一些规定以确保这些对象保持强引用。我不确定实现此目的的最佳模式是什么，但`ConditionalWeakTable<TKey,TValue>`在 .net 4.0 中添加的模式可能有用。有点像`Dictionary<TKey,TValue>`，只不过只要一个表本身被强引用，给定的key被强引用，其对应的值就会被认为是强引用。请注意，如果 a`ConditionalWeakTable`包含一个将 X 链接到 Y 并将 Y 链接到 table 的条目，那么只要 X 或 Y 保留，则 table 也将保留。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T19:36:27.480

垃圾收集有*两个*方面是您没有指望的：

*   WeakReference.IsAlive 变为假的确切时间。您的代码隐含地假设终结器运行时会发生这种情况。情况并非如此，它发生在对象被垃圾收集时。之后对象被放置在终结器队列中，因为它有终结器并且 GC.SuppressFinalize() 没有被调用，等待终结器线程完成它的工作。所以有一段时间 IsAlive 为假但 ~B() 尚未运行。

*   对象最终确定的顺序是不可预测的。您隐含地假设 B 在 A 之前完成。您不能做出这个假设。

B.Dispose() 方法中还有一个错误，当客户端代码显式处置对象时，它不会正确计算 B 实例。你还没有遇到那个错误。

没有合理的方法来修复此代码。此外，它测试已经由 CLR 提供的硬保证支持的东西。只需将其删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T16:36:44.723

WeakReference`_weakB`与对象同时可用于垃圾收集`a`。您在这里没有订单保证，因此很可能`_weakB`是在 object 之前完成的`a`。

在 A 的终结器中访问`_weakB`是危险的，因为您不知道`_weakB`. 我猜在你的情况下它已经完成，这导致它返回 null for `.Target`。*

# jersey - jersey RESTfull api中不支持的媒体类型

> ID：15093768
> 
> 赞同：0
> 
> 时间：2013-02-26T16:06:00.580
> 
> 标签：jersey

我正在尝试使用 Jersey 库构建一个 RESTfull API，但它给了我一个例外。这是我的文档课

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.PUBLIC_MEMBER)
public class Docs {

    @XmlElement(name = "field")
    public String field;

    @XmlValue
    public String content;

}

@Path("/update")
public class Update {
    @POST
    @Path("/xml")
    @Consumes(MediaType.APPLICATION_XML)
    @Produces(MediaType.APPLICATION_XML)
    public String createIndexXML(Docs docs)
            throws Exception {
        System.out.println(docs.content);
        return "It works";

    }

} 
```

如果我尝试使用 CURL 检查它会抛出`Error 415 Unsupported Media Type`

```
curl -XPOST "http://localhost:8089/update/xml" -d '<docs>
          <field>title</field>
</docs>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T17:02:31.280

您需要将内容类型添加到请求标头中。添加`-H "Content-Type: application/xml" to your`curl 调用。

我认为您还会发现您的 bean 上的注释存在问题 - 但这是另一个问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-26T09:41:59.933

这应该有效：

```
curl -H "Content-Type: application/xml"
-X POST -d "<docs><field>title</field></docs>" "http://localhost:8089/update/xml" 
```

你也应该试试`Accept: application/xml`；注意定义`@Produces`和`@Consumes`！请参阅[使用 @Consumes 和 @Produces 自定义请求和响应](http://docs.oracle.com/cd/E19776-01/820-4867/ghrpv/)。

# macos - 没有 Xcode 的 mac 上的 GCC

> ID：15093772
> 
> 赞同：4
> 
> 时间：2013-02-26T16:06:18.847
> 
> 标签：macos, gcc

如何在 mac（没有 Xcode）上使用 gcc 进行 C 编程？我应该下载哪个文件？如何安装和运行它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-26T16:08:53.930

转到[Apple 开发下载站点](https://developer.apple.com/downloads/index.action)并获取命令行工具。它有没有 XCode 的 gcc。

# java - 成功处理程序中的第一个 finish() 工作正常，第二个 finish() 没有

> ID：15093773
> 
> 赞同：0
> 
> 时间：2013-02-26T16:06:19.957
> 
> 标签：java, android, android-activity, activity-finish

在过去的 6 个小时里，我一直在试图解决以下问题，但我无法弄清楚。我相信这应该是一个容易解决的问题，但不知何故并非如此。

我使用了一个[Async HTTP 库](http://loopj.com/android-async-http/)，它有几个完成处理程序，其中之一是`onSuccess()`. 我的成功处理程序的代码如下所示：

```
@Override
public void onSuccess(String json) {
    // {"statusId":12,"statusText":"Ongeldige logincode","result":[],"duration":"0.320","update":[]}
    // {"statusId":1,"statusText":"OK","result":{"id":"38790","planHash":"0FYzJAodmQzUnZkSEJzWVc1dWFXNW5KbXhzYm5WdFBUTTROemt3","warnCBR":"NO","data":{"name":"Jeroen Dielemans","mail":"j.dielemans@live.nl","address":"Oude Antwerpse Postbaan 6","zip":"4741TK","city":"Hoeven","phone":"0165-502684","mobile":"06-15617390"}},"duration":"1.538","update":[]}
    json = "{\"statusId\":1,\"statusText\":\"OK\",\"result\":[],\"duration\":\"3.910\",\"update\":{\"id\":22,\"title\":\"Update!\",\"text\":\"Hee er is een nieuwe versie ;)\",\"button\":\"Open\",\"link\":\"market:\\/\\/details?id=com.dga.blom>\"}}";

    Integer statusId = 1; // 1 == success
    String statusText = null;
    JSONObject result = null;
    JSONObject update = null;

    try {
        JSONObject object = (JSONObject) new JSONTokener(json)
                .nextValue();
        statusId = object.getInt("statusId");
        statusText = object.getString("statusText");
        result = object.optJSONObject("result");
        update = object.optJSONObject("update");
    } catch (JSONException e) {
        e.printStackTrace();
    }

    if (statusId != 1) {
        showAlertDialog(getString(R.string.failed), statusText);
    } else {
        InputMethodManager inputMethodManager = (InputMethodManager) getSystemService(Activity.INPUT_METHOD_SERVICE);
        inputMethodManager.hideSoftInputFromWindow(
                getCurrentFocus().getWindowToken(), 0);

        if (result != null) {
            SharedPreferences prefs = getSharedPreferences(
                    Constants.SHARED_PREFS, Context.MODE_PRIVATE);
            Editor editor = prefs.edit();
            editor.putString(Constants.SHARED_PREFS_USER,
                    result.toString());
            editor.commit();

            Intent refreshIntent = new Intent(
                    Constants.INTENT_REFRESH_ACTION);
            sendBroadcast(refreshIntent);
        } 

        if (update == null) {
            finish(); /* ALWAYS closes activity */
        } else {
            int updateId = update.optInt("id", -1);
            SharedPreferences prefs = getSharedPreferences(
                    Constants.SHARED_PREFS, Context.MODE_PRIVATE);
            int lastId = prefs.getInt(
                    Constants.LAST_UPDATE_MESSAGE_ID, -1);

            if (updateId > lastId) {
                showUpdateDialog(update);
            } else {
                finish(); /* NEVER closes activity */
            }
        }
    }
} 
```

我猜相关的代码已经接近尾声了。

当没有任何价值时，`update`我将通过调用来关闭活动`finish()`。这总是很好。

如果`update`存在值，我将检查更新标识符是否永远不是最后存储的值。如果更新标识符确实更新，我将显示一个对话框。如果更新标识符不是更新的，我会尝试通过调用来关闭活动`finish()`并继续使用该应用程序。这第二个`finish()`电话永远不会奏效。

我应该注意到，我的模拟器似乎在第二次`finish()`调用时出现了小问题，但 LogCat 没有提及任何错误、警告等。

为什么第二个不`finish()`关闭我的活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:26:48.270

在什么情况下更新不为空？在您当前正在运行的活动下方是否可能存在相同活动的第二个实例，因此顶部活动实际上正在完成，但它看起来不像，因为它返回的活动具有相同的布局？

# sql - 加密 SQL Server 中列中的数据

> ID：15093775
> 
> 赞同：7
> 
> 时间：2013-02-26T16:06:28.467
> 
> 标签：sql, database, security, encryption

sql server中是否存在任何算法来加密数据。我有一个密码字段，我需要对其进行加密，但是一旦将数据传递到存储过程中，我就必须对其进行加密。这意味着我无法从我的 c# 代码中传递加密数据。

```
CREATE PROC saveData(@p1 VARCHAR(50),
                 @p2 VARCHAR(50))
AS
BEGIN
  DECLARE @encryptedP1 VARCHAR(50)

  SET @encryptedP1=dbo.fnEncrypt(@p1)  --ENCRYPTING THE DATA WITH AN INBUILT FUNCTION

  INSERT INTO table1
              (column1,
               column2)
  VALUES     (@encryptedP1,
              @p2)
END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-06T20:02:34.103

这是一个非常快速的例子。它适用于**非对称密钥**。我希望这会有所帮助。

**首先：**使用以下代码创建您的非对称密钥：

* * *

```
USE [yourDB]

GO

CREATE ASYMMETRIC KEY ClaveAsym

WITH ALGORITHM = RSA_2048 ---->Take a look in this type of algorithms

ENCRYPTION BY PASSWORD = 'yourKey'

GO 
```

请记住这一点，您必须始终声明要**解密**或**加密的变量**

```
DECLARE @KEYID INT
SET @KEYID = AsymKey_ID('ClaveAsym') 
```

* * *

**解密数据**

```
SELECT columnA, CAST(DecryptByAsymKey(@keyid, columnUser, N'yourKey') AS VARCHAR(100)),
        CONVERT(VARCHAR(MAX), DECRYPTBYASYMKEY(@keyId, columnPass, N'yourKey'))
FROM yourTable 
```

* * *

**加密数据**

```
DECLARE @User VARCHAR(MAX), @pass VARCHAR(MAX)

SET @User = 'yourUser'

sET @pass = 'yourPass'

DECLARE @KEYID INT SET @KEYID = AsymKey_ID('ClaveAsym') 

INSERT INTO yourTable( User, passw) VALUES EncryptByAsymKey (@keyid, @User ), EncryptByAsymKey (@keyid, @pass)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T16:16:14.943

像往常一样，老皮纳尔戴夫对此有一些[有用的信息](http://blog.sqlauthority.com/2009/04/28/sql-server-introduction-to-sql-server-encryption-and-symmetric-key-encryption-tutorial-with-script/)。这有点牵涉，但如果您**必须**在 SQL Server 中而不是在客户端代码中执行此操作，那么它应该为您完成这项工作。您可能需要留意性能问题，因为它是一个 CPU 密集型过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:11:16.567

我建议使用盐渍 sha1 或 md5

```
CONVERT(VARCHAR(32), HashBytes('MD5', 'email@dot.com'), 2) 
```

尽管散列在技术上不是加密。

# ios - 设置默认隐藏的tableview xcode 4.2

> ID：15093778
> 
> 赞同：1
> 
> 时间：2013-02-26T16:06:38.263
> 
> 标签：ios, xcode, user-interface, storyboard

我正在尝试创建一个下拉菜单，但我仍然不知道该怎么做。

所以我想我可以设置一个默认隐藏的表格视图，当人们点击一个按钮时，表格视图就会出现。我知道如何隐藏/取消隐藏对象，但我不知道如何设置默认隐藏的对象。大家能帮我修一下吗？

预先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T17:50:45.980

在故事板文件中，您可以在视图上设置“隐藏”属性。此属性位于“属性检查器”选项卡的“查看”部分下。

或者在你的类的“-(void)viewWillAppear:(BOOL)animated”函数中，设置 [table setHidden:true];

其中之一应该工作。

# python - 您可以从 Windows 中的 DMP 文件中读取已经运行的 Python 脚本的变量数据吗？

> ID：15093780
> 
> 赞同：0
> 
> 时间：2013-02-26T16:06:40.710
> 
> 标签：python, windows, python-2.7, save

我有一个 Python 程序存在某种错误，导致它无法保存我的数据。该程序仍在运行，但我无法保存任何内容。不幸的是，我真的需要保存这些数据，而且似乎没有其他方法可以访问它。

通过任务管理器为进程创建的 DMP 文件是否包含我的程序收集的数据，如果是，我如何访问它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:31:31.103

它是否包含程序的部分或全部当前执行状态？是的。它的形式是否可以让您轻松地以您可能正在寻找的用户级格式提取信息？可能不是。它将转储整个 Python 解释器的状态，包括正在运行的特定 Python 程序在内存中表示的数据。要重建该数据，我很确定您需要在调试模式下运行 Python 解释器本身，然后尝试从 C 调试器可以拼凑的任何内容中重建您的数据。如果这对您来说听起来非常困难或不可能，那么您可能对它的含义有所了解。

# directory - 我的文档目标 - 我如何更改它以打开我的网站

> ID：15093786
> 
> 赞同：0
> 
> 时间：2013-02-26T16:06:58.147
> 
> 标签：directory, documents

我创建了一个网站（供我的计算机上本地使用）通过常规链接浏览“我的文档”文件夹中的文件。我想更改我的文档文件夹现在打开的方式，如果我双击我的文档文件夹我希望我的网络出现并将其用作界面。有没有办法做到这一点？谢谢阿德里安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:22:41.593

也许它缺乏对网络技术和浏览器的了解。

我真的不确定采取这条路线的原因 - 你可以尝试：

```
<a href=file://///SERVER/folder/file.extension>LAN FILE</a> 
```

但老实说，我不确定为什么您不能在您希望提供页面的机器上运行 Web 服务器。

所以假设你有 3 台机器的局域网

```
10.0.0.1
10.0.0.2
10.0.0.3 
```

您希望使用 10.0.0.1 作为服务器页面的主服务器 - 安装 apache Web 服务器或 IIS，如果其窗口然后将页面放在 DocumentRoot 中指向

```
<a href=/somefolder>Some folder</a> 
```

其中 /somefolder 是默认站点的文档根目录中的一个文件夹。

然后，您可以访问任何其他 LAN 上的浏览​​器

http:// 10.0.0.1 它将显示带有链接的页面，然后可以在远程机器的本地浏览器上查看该链接...从 10.0.0.1 提供的文件

您可以更进一步，查看内部 DNS 或破解剩余机器上的本地主机文件并指向类似的条目

```
10.0.0.1 intranet 
```

所以当任何机器点击 http:// Intranet - 他们点击 10.0.0.1

# vba - 调整报表大小 (Access)

> ID：15093787
> 
> 赞同：1
> 
> 时间：2013-02-26T16:07:02.293
> 
> 标签：vba, ms-access, ms-access-2010

我正在使用 Access 2010。我创建了一个报告，并试图减少它的长度，但我在属性中找不到类似的选项。

如果我尝试在设计模式下调整它的大小，它就不起作用。当我更改为“报告视图”时，大小再次更改。

如何调整报告的大小？

# jsf - CommandButton action: use value of inputText as parameter in dynamic URL

> ID：15093790
> 
> 赞同：1
> 
> 时间：2013-02-26T16:07:06.533
> 
> 标签：jsf, jsf-2, primefaces, el

I need to make a small form where user types a number into the inputField, and clicks on a button, then is sent to a page, using that number as a parameter to the page.

So far I got into this:

```
<p:inputText id="myText" style="width:75px;" />
<p:commandButton id="myButton" value="Ir" 
    action="/site/page.xhtml?id=${param['form:myButton']}"
    title="Ir" ajax="false" proces="@this,myText" /> 
```

tried with `${param['form:myButton']}` and `#{param['form:myButton']}`, error is the same.

Problem is, JSF thinks its a method expression...

```
GRAVE: Servlet.service() for servlet [Faces Servlet] in context with path [/intranet] threw exception [/myPage action="/site/page.xhtml?id=${param['form:myButton']}".xhtml @95,41  action="/site/page.xhtml?id=${param['form:myButton']}" Not a Valid Method Expression:  action="/site/page.xhtml?id=${param['form:myButton']}" with root cause
javax.el.ELException: Not a Valid Method Expression:  action="/site/page.xhtml?id=${param['form:myButton']}"
at org.apache.el.lang.ExpressionBuilder.createMethodExpression(ExpressionBuilder.java:236)
at org.apache.el.ExpressionFactoryImpl.createMethodExpression(ExpressionFactoryImpl.java:55)
at org.jboss.weld.util.el.ForwardingExpressionFactory.createMethodExpression(ForwardingExpressionFactory.java:43)
at org.jboss.weld.el.WeldExpressionFactory.createMethodExpression(WeldExpressionFactory.java:64)
at com.sun.faces.facelets.tag.TagAttributeImpl.getMethodExpression(TagAttributeImpl.java:222)
at com.sun.faces.facelets.tag.jsf.ActionSourceRule$ActionMapper2.applyMetadata(ActionSourceRule.java:104)
at com.sun.faces.facelets.tag.MetadataImpl.applyMetadata(MetadataImpl.java:81)
at javax.faces.view.facelets.MetaTagHandler.setAttributes(MetaTagHandler.java:129)
at javax.faces.view.facelets.DelegatingMetaTagHandler.setAttributes(DelegatingMetaTagHandler.java:102)
at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.doNewComponentActions(ComponentTagHandlerDelegateImpl.java:402) 
```

and this is the bottom-most exception trace.

Question: how can I pass the value typed into of the input-field into the action of the Button when the button is clicked, so the browser navigates to the desired page passing the value in the input as a parameter, without resorting to a backing bean.

I don't need to communicate with the server, just forward the page.

any solution using jQuery or plain javascript in tandem with JSF is acceptable too.

using mojarra, primefaces 3.3.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:17:57.587

use `<f:param>` It's explained in this article from BalusC [http://balusc.blogspot.in/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters](http://balusc.blogspot.in/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:23:45.247

I do not need a bazooka to kill a mouse. The answer is very simple.

bind a javascript function to the `onclick` of the button, and in that function, retrieve the value of the input field by its id, then assemble URL with the parameters and navigate away from within the javascript function.

JSF code (assume they are inside a form with `myForm` as its id):

```
<p:inputText id="myInput" style="width:75px;" />
<p:commandButton id="myButton" value="Ir" onclick="navega();" title="Ir" ajax="false" proces="@none" /> 
```

Javascript script, declared on a separate file or later on in the xhtml document:

```
function navega() {
     var submittedInputValue = $('#myForm\\:myInput').val();
     window.location.href = "/site/mypage.xhtml?param1=whatever&amp;id=" + submittedInputValue ;
                } 
```

Take note of the prepend id (myForm:myInput), of using `\\` to escape the `:` in jQuery, and using `&amp;` instead of `&` in the xhtml so its not treated as an entity.

Note: probably not all of those commandButton attributes are required, feel free to edit this answer and remove the useless ones.

EDIT: removed the submit and changed process to `@none` on the command button.

# c# - 如何在 Windows Phone 上更改 C# 中的本地化？

> ID：15093791
> 
> 赞同：12
> 
> 时间：2013-02-26T16:07:06.663
> 
> 标签：c#, localization, windows-phone

我有两种语言的资源文件，我的应用程序已经读取了其中一种语言的值。我希望能够在 C# 中更改我的应用程序的语言（使用其他资源文件），而不是在设置中更改整个手机的语言。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T16:28:57.400

在`App.xaml.cs`，在`InitializePhoneApplication`方法中：

```
private void InitializePhoneApplication()
{
    Thread.CurrentThread.CurrentCulture = new CultureInfo("fr-FR");
    Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture;
    .......
} 
```

限制是它需要在应用程序初始化中，所以如果用户更改语言，则需要重新启动才能生效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-16T08:18:00.680

您可以通过重新加载用户更改语言的页面并维护页面布局的 RTL/LTR 来执行此操作而无需重新启动

我在 App.xaml.cs 中添加了这个函数

```
public static void ChangeAppLanguage(string CultureName)
    {
        App.RootFrame.Language = XmlLanguage.GetLanguage(CultureName);
        FlowDirection flow = (FlowDirection)Enum.Parse(typeof(FlowDirection), AppResources.ResourceFlowDirection);
        App.RootFrame.FlowDirection = flow;
        App.Current.RootVisual.UpdateLayout();
        App.RootFrame.UpdateLayout();
        var ReloadUri =( App.RootFrame.Content as PhoneApplicationPage).NavigationService.CurrentSource;
        (Application.Current.RootVisual as PhoneApplicationFrame).Navigate(new Uri(ReloadUri + "?no-cache=" + Guid.NewGuid(), UriKind.Relative));
    } 
```

其中 CultureName 像这样：“ar-SA”、“en-US”

我这样打电话

```
private void EnglishMenuItem_Click(object sender, EventArgs e)
    {            
        try
        {
            if(Thread.CurrentThread.CurrentCulture.Name == "en-US")
                Thread.CurrentThread.CurrentCulture = new CultureInfo("ar-SA");
            else
                Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
            Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture;

            AppResources.Culture = Thread.CurrentThread.CurrentCulture;

            App.ChangeAppLanguage(Thread.CurrentThread.CurrentCulture.Name);

            //this._contentLoaded = false; //this way does not refresh appBar
            //this.InitializeComponent();

            //this way work for one time only => if user change language more thane once the api does NOT call constructor
            //NavigationService.Navigate(new System.Uri("/PhoneApp2;component/MainPage.xaml", System.UriKind.Relative));

        }
        catch (Exception ex)
        {
            MessageBox.Show("error:\n\n" + ex.Message);
        }
    } 
```

# html - -ms-viewport 导致 div 不滚动

> ID：15093798
> 
> 赞同：3
> 
> 时间：2013-02-26T16:07:24.667
> 
> 标签：html, css, cordova, windows-phone-8, internet-explorer-10

我好像遇到了一个很奇怪的bug；我正在使用 PhoneGap 为 Windows Phone 8 开发应用程序。我遇到的问题是我有可滚动`div`的，当我使用时可以使用：

```
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, height=480, width=320, target-densitydpi=device-dpi" /> 
```

（我尝试使用`height=device-height`, `width=device-width`，一切正常）

但是，当我删除视口元标记并改用它时：

```
@-ms-viewport {
    width:320px;
    user-zoom: fixed;
    max-zoom: 1;
    min-zoom: 1;
} 
```

一切看起来都一样，**但**`div`不再可滚动。

我需要使用`-ms-viewport`，因为我将把它放在媒体查询中，因为我想更改纵向和横向的视口宽度/高度。

我尝试删除/重新注入元标记，`content`使用 jQuery 更改元标记的值，但它不会在运行时更新视口。

这是整个页面的 HTML。如果您希望重现该问题，您应该在 IE10 移动设备上使用：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="msapplication-tap-highlight" content="no"/>
        <script type="text/javascript" src="./cordova-2.3.0.js"></script>
        <script type="text/javascript" src="./js/jquery-190.js"></script>
        <script type="text/javascript" src="./js/jquery.transit.min.js"></script>
        <style>
            @-ms-viewport {
                width: 320px;
                user-zoom: fixed;
                max-zoom: 1;
                min-zoom: 1;
            }

            html, body {
                height: 100%;
                width: 100%;
                padding: 0px;
                margin: 0px;
                user-select: none;
            }

            body {
                background-color: red;
                color: white;
                -ms-text-size-adjust: none;
                -ms-user-select: none;
            }

            .window_wrapper {
                position: relative;
                background-color: yellow;
                width: 90%;
                height: 90%;
                overflow: auto;
            }

            .test {
                width: 50%;
                height: 500px;
                overflow: hidden;
                position: absolute;
                background-color: silver;
                z-index: 3000;
            }

            #ll {
                position: absolute;
                bottom: 0px;
            }
        </style>
        <title>An App...</title>
    </head>
    <body>
        <div class="window_wrapper">
            <div class="test">
                first line
                <br />
                <div id="ll"> last line </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-07T14:48:52.317

## 对于 Windows 电话 8

我遇到了同样的问题，直到我使用以下 CSS：

```
body {
    @-ms-viewport {
        width: 320px;
        user-zoom: fixed;
        max-zoom: 1;
        min-zoom: 1;
    }
}

div .scrollable-area {
    overflow: scroll;
    -ms-overflow-style: none;
} 
```

有效; 现在我可以毫无问题地滚动该区域。

* * *

## 适用于 Windows Phone 8.1 +

[正如此链接](http://www.hippopunk.com/en/how-to-stop-the-bouncing-wp8-webview/)所指出的，这是一个可行的解决方案

```
html {  
    overflow: hidden;  
    -ms-content-zooming: none;  
}

body {  
   -ms-touch-action: pan-y ;  
}

div .scrollable-area {  
  overflow: auto ;  
  -ms-touch-action: pan-y ;  
} 
```

**学分：**

鸣叫[@r_desimone](https://twitter.com/intent/user?screen_name=r_desimone)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T13:48:13.497

`@ms-viewport`根据[MSDN](http://msdn.microsoft.com/en-us/library/ie/hh869615%28v=vs.85%29.aspx)的规则不支持设置除`width`or以外的属性`height`。

因此，您可能必须使用`meta`标签和`@ms-viewport`规则的组合，但只需覆盖`width`and`height`每次使用不同布局的媒体查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T03:12:06.737

```
body, html { 
  -ms-overflow-style: none !important; 
} 
```

# sql - HiveQL - 大数据的高效 geoip 发现

> ID：15093800
> 
> 赞同：2
> 
> 时间：2013-02-26T16:07:27.927
> 
> 标签：sql, hadoop, mapreduce, hive, hiveql

我正在使用此配置单元查询来发现所有帐户的国家代码。问题是连接将数据集爆炸到无法管理的大小，甚至有时作业也无法完成。

**完成此 geoip 查找查询的快速有效方法是什么？使用 Hive 不是强制性的**

```
SELECT /*+ MAPJOIN(geoip) */
  data.account_id, geoip.country_code
FROM data JOIN geoip
WHERE data.ip_num BETWEEN geoip.begin_ip_num AND geoip.end_ip_num 
```

Hive 不支持`BETWEEN`inside`ON`子句。此外，`WHERE`过滤器仅在连接完成后应用。任何提示也会很有用。我目前正在尝试使用自定义 MapReduce 作业来解决此问题。有人有什么想法吗？

### 信息

*   `geoip`表大小约为 1MB
*   Hadoop集群只有12个map slot和12个reduce slot
*   我试图根据第`begin_ip_num`一个八位位组（例如：`123`of `123.0.0.0`）存储 geoip 表，然后使用`JOIN`子句中的条件，例如`FROM data JOIN geoip ON (data.first_octet_bucket=geoip.first_octet_bucket)`. 此技术不起作用，因为某些行将被遗漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:24:24.590

最终选择的解决方案是绕过 Hive。我们将 geoip 表序列化为常规 java TreeMap，并使用 Hadoop 的 DistributedCache 将其上传到自定义映射器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T20:14:34.617

尝试启用谓词下推。

打开文件：

```
 $HIVE_CONF_DIR/hive-site.xml 
```

添加：

```
<property>
  <name>hive.optimize.ppd to true</name>
  <value>false</value>
  <description>Whether to enable predicate pushdown</description>
</property> 
```

参考： [PredicatePushDown.html](http://hive.apache.org/docs/r0.5.0/api/org/apache/hadoop/hive/ql/ppd/PredicatePushDown.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T19:08:05.280

我想这不是现在简单的解决方案。没有非 equi 连接支持 s#c#s。这是一些解决方案[https://reviews.facebook.net/D4137](https://reviews.facebook.net/D4137)。顺便说一句，祝你好运。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-26T16:14:10.570

SELECT d.account_id,da,db,dc,i.country_code 从数据 d 外部应用（从 geoip g 中选择 TOP 1，其中 d.ip_num 在 g.begin_ip_num 和 g.end_ip_num 之间）我

礼炮

# asp.net-mvc - MVC、FluentValidation 和 Ninject 的单元测试接线

> ID：15093802
> 
> 赞同：4
> 
> 时间：2013-02-26T16:07:33.063
> 
> 标签：asp.net-mvc, ninject, fluentvalidation

我已经使用 Ninject.Extensions.Mvc.FluentValidation 包设置了一个带有 FluentValidation 和 Ninject 的 MVC Web 项目。我直接遵循了该包的文档。

我想编写一个自动化测试来验证此接线，并检查模型验证是否将按预期使用 FluentValidation 验证器。为了做到这一点，我很难在测试中启动 MVC 应用程序的正确部分。

基本上，我想启动 MVC 应用程序，以便创建 Ninject 内核、连接模型绑定器并创建验证器。然后我想尝试通过 MVC 模型验证来验证实体，并确保显示来自验证器的预期消息。

自动化测试 Ninject、MVC 和 FluentValidation 之间交互的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T22:36:08.180

我们这里用于集成测试的是[Selenium Webdriver](http://docs.seleniumhq.org/projects/webdriver/)，你可以通过 NuGet 获得它。我们编写代码使用[页面模式](https://code.google.com/p/selenium/wiki/PageObjects)，因此更易于维护。

当我想检查是否需要字段或任何其他自定义验证时，我会执行以下操作：

```
 [TestFixture]
    public class CenterTests : TestBase
    {

        [Test]
        public void CreateViewAndEditShouldWork()
        {   
            S.OpenWithCI();
            var loginPage = new LoginPage(S);
            var homePage = loginPage.LoginValidUser("email", "Password");
            var centerListPage = homePage.ClickCenterAndRoomLink();
            var centerPage = centerListPage.ClickCreateLink();

            //Create
            centerPage.CreateInvalidCenter();
            Assert.That(S.FindElement(By.CssSelector("span[for=Name]")).Text, Is.StringContaining(Strings.Error_Required));
            Assert.That(S.FindElement(By.CssSelector("span[for=EnglishName]")).Text, Is.StringContaining(Strings.Error_Required));

            centerListPage = centerPage.CreateValidCenter("Saguenay", "Sag", "2089 blv Talbot");
            Thread.Sleep(2000); 
            S.ExpectSuccessNotice(Strings.CenterCreatedSuccessfully);
        }
    } 
```

这是我的 TestBase 助手类的代码：

```
namespace Afi.AutomatedTests.Helpers
{
    [TestFixture]
    public class TestBase
    {
        protected IWebDriver S;

        [SetUp]
        public virtual void TestSetup()
        {
            S = new ChromeDriver();
            S.Manage().Window.Size = new Size(1024, 768);
            S.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10));
        }

        [TearDown]
        public void TearDown()
        {
            S.Quit();
        }

        public string GetUrl(string relativePath)
        {
            if(!relativePath.StartsWith("/"))
                throw new ArgumentException("Relative URL must begins with /");

            return "http://afi.local" + relativePath;
        }
    }
} 
```

所有这些测试都在另一个名为 AutomatedTests 的项目中，我可以像运行单元测试（resharper/nunit）一样运行它们。它使用 Chromedriver 进行测试。

如果您需要更多信息，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T22:20:52.360

我有类似的设置，但我使用 Unity 而不是 Ninject。

我的 IoC 容器继承了 UnityContainer，我在其中注册了所有 repos、validarots 等。我从中受益，因为我有具有 repo 依赖项的验证器（例如，UserRegistrationValidator 检查唯一用户名）。

我的 IoC 容器也实现[了 IValidatorFactory](http://fluentvalidation.codeplex.com/wikipage?title=ValidatorFactory&referringTitle=Documentation)。我使用它注册一个全局 ModelValidatorProvider ，如下所示：

```
var ioc = new IoCContainer();
ModelValidatorProviders.Providers.Add(new FluentValidationModelValidatorProvider(ioc));
DataAnnotationsModelValidatorProvider.AddImplicitRequiredAttributeForValueTypes = false; 
```

通过这种设置，我知道我的验证器将拦截控制器操作中的模型验证，但前提是验证器由 ValidatorFactory 解析。

所以基本上我有两组测试

## - 国际奥委会测试

使用这些我测试我的 IoC 容器是否可以解析模型的验证器。使用 Unity，它看起来像这样：

```
// Arrange
var ioc = new IoCContainer();

// Assert
Assert.IsTrue(ioc.IsRegistered(IValidator<MyModel>)); 
```

如果您将所有模型都放在一个命名空间下，您甚至可以通过从特定命名空间获取所有类型并检查 IValidator 是否在循环中为它们注册来编写单个单元测试。

## - 验证器测试

这些是测试我的（视图）模型的常见测试：

```
// Arrange
var validator = new MyModelValidator();
var model = new MyModel{ Name = null };

// Assert
validator.ShouldHaveValidationErrorFor(x => x.Name, model) 
```

这样就不需要旋转应用程序，您只需测试您创建的内容。

希望这可以帮助。

# javascript - get the id of super-parent onclick on child anchor

> ID：15093809
> 
> 赞同：-2
> 
> 时间：2013-02-26T16:07:58.743
> 
> 标签：javascript, jquery, dom

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:10:18.147

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:09:26.937

```
$('.trigger').on('click', function(e) {
    e.preventDefault();
    var ID = $(this).closest('li').attr('id');
}) 
```

# c++ - Jenkins + CMake 用于多个操作系统和库版本

> ID：15093810
> 
> 赞同：0
> 
> 时间：2013-02-26T16:07:59.710
> 
> 标签：c++, jenkins, cmake

我的 C++ 程序是使用 CMake 为多个操作系统（Win7、MacOS 和 Linux）编译的。

对于依赖于操作系统的东西，我正在做类似的事情：

```
if (${APPLE})
    // Do MacOS dependent things here
elseif(${WIN32})
    // Do Win dependent things here
elseif(${UNIX})
    // Do Linux dependent things here
endif (${APPLE}) 
```

现在，我需要将我的程序与不同版本的库链接起来。继续同样的方式很快就会变得不切实际。

**如何针对库的多个版本编译多个操作系统的程序，同时保持一切实用，以便轻松添加新的操作系统和/或库的新版本？**

最终，一切都将与 Jenkins 集成，所以我不知道在 CMake 或 Jenkins 级别（或两者）工作是否更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:28:15.623

这里可能没有“正确”的答案。CMake 的目的是提供一个跨平台的 Make（因此得名），因此它提供了许多方法来减少或消除特定于平台的代码。

我倾向于发现我需要特定于平台的块的大多数情况是在依赖项查找（[`find_library`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3afind_library),[`find_file`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3afind_file)等）期间或设置编译器/链接器标志。（当然，我的经验可能并不典型，甚至不适用于您的情况）。这通常意味着在给定的 CMakeLists 文件中没有太多地方需要平台或编译器特定的代码。

一种可能的清理方法是将所有特定于平台的代码放在单独的文件中，并且[`include`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3ainclude)每个文件都放在一个`if` `elseif` `else`块中。

# javascript - 当我将 ajax 事件绑定到动态生成的内容时

> ID：15093815
> 
> 赞同：-1
> 
> 时间：2013-02-26T16:08:02.257
> 
> 标签：javascript, jquery, ajax

为了让我的问题简单，我有 index.php 看起来像这样：

```
<button>A</button>
<div id="DivHolder"></div> 
```

首先，我单击按钮 A（在**index.php**中）并触发事件：

```
$.ajax({
   url:"getButtonB.php"
}) 
```

然后在 $.ajax 成功后，我得到了一个按钮 B（它是从 getButtonB.php 生成的）并附加到**index.php**最后，在**index.php**中，它看起来像这样：

```
<div id="DivHolder"><button class="pill YES">B</button></div> 
```

接下来，javascript代码：

```
$("#DivHolder").on("click",".pill",function(){
    var thisButton=$(this);
    if(thisButton.hasClass("NO")){
        $.ajax({
              url:"doingSomethingOne.php",
              type:"POST"
        });
        thisButton.removeClass("NO");
        thisButton.addClass("YES");
    }else if(thisButton.hasClass("YES")){
         $.ajax({
              url:"doingSomethingTwo.php",
              type:"POST"
        });
        thisButton.removeClass("YES");
        thisButton.addClass("NO");
    }
}); 
```

这就是这里所有的代码，我想要这些代码是当我点击按钮A时，我得到一个按钮B。然后我点击按钮B，它会做一些事情，比如注册一个营地，如果我再次点击按钮B，它将注销营地。所有不同的是按钮 B 的类。如果有类**YES**，则单击**取消注册**。如果有班级**NO**，则点击**注册**。

但是这些东西不起作用，在我的实际项目中，我更改了按钮 B 背景颜色以显示不同的状态（是或否）。因此，当我单击按钮 B 时，**它的背景颜色已更改，但右更改为原始颜色。**并触发 $.ajax()，（在上述情况下，它触发**url:"doingSomethingTwo.php"**）。在第二次点击时，它**不会**触发另一个 $.ajax();

**最奇怪的是：**

1.  如果我从上面的脚本中删除 $.ajax() ，也就是说我只是更改了类（或者在我的项目中，只需更改按钮 B 背景颜色），那么它就可以工作了；单击按钮B，它变为红色，再次单击它再次变为黄色。

2.  如果按钮 B 不是动态生成的，假设按钮 B 是**index.php**中的硬代码，在这种情况下，我当然不会使用**on**绑定事件，只是使用

    ```
    $(".pill").click(function(){
        //do something
    }) 
    ```

然后，一切都很好。它会同时改变背景颜色并相应地触发 $.ajax。

如果有人能解决我的问题，请帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:24:53.717

Ajax 请求是异步的，因此在定义 ajax 请求之后尝试删除或添加类将无法按预期工作。您需要的是一种了解 Ajax 请求是否完成的方法，如果是，则根据需要添加/删除所需的类。这是一个非常简单的例子：

```
var xhrOne = $.ajax({
  url:"doingSomethingOne.php",
  type:"POST"
});

xhrOne.done(function () {
  thisButton.removeClass("NO");
  thisButton.addClass("YES");
}); 
```

# extjs4.1 - 如何更改条形图上的标签颜色？

> ID：15093822
> 
> 赞同：0
> 
> 时间：2013-02-26T16:08:24.827
> 
> 标签：extjs4.1

使用文档 Ext.chart.series.Bar 中的示例应该很容易实现这一点。

该系列有一个包含颜色属性的标签配置。更改此设置无效。还是我错过了什么？

我想在条形顶部显示一个白色文本。

[示例http://jsfiddle.net/dfDb8/](http://jsfiddle.net/dfDb8/)的工作代码

在第 48 行，我尝试将颜色设置为白色

```
 label: {
      display: 'insideStart',
        field: 'data',
        renderer: Ext.util.Format.numberRenderer('0'),
        orientation: 'horizontal',
        color: '#fff' //this is what I want to change
        'text-anchor': 'middle'
    }, 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:21:23.907

以下属性：

```
fill: '#fff' 
```

似乎工作。我不完全确定为什么。

# string - 有没有办法在多段字符串中添加引号

> ID：15093828
> 
> 赞同：1
> 
> 时间：2013-02-26T16:08:35.747
> 
> 标签：string, escaping

我写了以下行：

```
 string QuoteTest2 = "Benjamin Netnayahu,\"BB\", said that: \"Israel will not fall\""; 
```

这个例子很顺利，但是如果我想写一个包含引号的多段字符串，我该怎么办？

下面的例子表明，把'@'放在前面并没有削减它..

```
 string QuoteTest2 = @"Benjamin Netnayahu,\"BB\", said that: \"Israel will not fall\""; 
```

字符串结束，第二个引号和 over 只是给我错误，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:13:53.097

使用双引号转义 ""

例如

```
string QuoteTest2 = @"Benjamin Netnayahu,""BB"", said that: ""Israel will not fall"""; 
```

# java - 在 Java 中恢复由 string.split() 分割的字符串

> ID：15093835
> 
> 赞同：2
> 
> 时间：2013-02-26T16:08:54.163
> 
> 标签：java, regex, string, split

我有一个字符串“**我爱 A。我讨厌 B** ”。如果我使用拆分它

```
 string.split("\\p{Punct}") 
```

我会得到两个字符串，`string1`分别是“**我爱 A** ”和`string2`“**我讨厌 B** ”。请注意，代替“ **.** ”，我还可以使用任何其他标点符号。如何使用正确的标点符号恢复拆分操作之前的确切字符串。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T16:10:57.153

保留对字符串的引用 - 如果你有任何 punct，你就无法猜到你以前有什么

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T16:17:19.083

如果您使用以下正则表达式进行拆分（使用[零宽度后视断言](http://www.regular-expressions.info/lookaround.html)）：

```
(?<=\p{Punct}) 
```

它实际上不会消耗标点符号，而只是检查分割点之前是否有标点符号。结果，标点符号留在了最终的字符串中：

```
String s = "I love A. I hate B.";
String res[] = s.split("(?<=\\p{Punct})");
System.out.println(Arrays.toString(res)); 
```

结果：

```
[I love A.,  I hate B.] 
```

现在您可以将数组的元素重新连接在一起以恢复原始字符串。

演示：http: [//ideone.com/0umjkZ](http://ideone.com/0umjkZ)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:28:08.163

您可以使用 StringTokenizer 并使用 nextElement() 方法管理元素。

样本。

```
String str = "I love A. I hate B";

StringTokenizer st = new StringTokenizer(str,".");

String beforeElement;
String otherElement;

while (st.hasMoreElements()){

    beforeElement=st.nextElement();

     if(st.hasMoreElements()){

       otherElement=st.nextElement();

    }

} 
```

# javascript - Highstock - 不规则的时间间隔

> ID：15093837
> 
> 赞同：7
> 
> 时间：2013-02-26T16:09:01.567
> 
> 标签：javascript, highcharts, highstock

Highcharts 有一个使用不规则时间间隔的示例，我想在 highstock 上做同样的事情，但是 xAxis 类型没有参数。

[JSF中间代码](http://jsfiddle.net/cS6r5/17/)

我的选择是

```
$(function() {

$.getJSON('http://184.173.195.228/~ktwsn/temp2.php?action=get_sensor&sensor_serial%5B%5D=3B74F41400000069&sensor_serial%5B%5D=3BB2FA14000000E6&sensor_serial%5B%5D=3B91F11400000079&sensor_serial%5B%5D=3BC7F114000000E5&sensor_serial%5B%5D=3BC0F314000000E3&callback=?',
      {action: "get_sensor"},
          function(data) {
              var seriesOptions = [];
              $.each(data, function(key, val) {
                  seriesOptions.push({
                      name: val.name,
                      data: val.samples,
                      marker : {
                          enabled : true,
                          radius : 3
                      }
                  });
              });       
              // create the chart
              chart = new Highcharts.StockChart({
                  chart: {
                      renderTo: 'container',
                  },
                  xAxis: {
                      type: 'datetime'
                  },
                  rangeSelector: {
                      selected: 4
                  },    
                  series: seriesOptions
              });
          });   
}); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-27T20:09:05.490

找到了。highcharts 和 highstock 之间的命名是不同的。

对于 Hightstock 来说

```
xAxis: {       
    ordinal: false
} 
```

该公司确实需要将 highcharts 和 highstock 结合起来。单个 API 文档会更容易理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:28:24.957

我会验证输出数据实际上使用的是相同的时间戳。

像这样的许多情况包括同一日期的时间戳，但时间不同，这将始终导致不同的 x 轴位置。

（我知道这可能是一个明显的检查，但我已经看过很多次了......）

# javascript - 浏览器中的事件循环和任务队列有区别吗？

> ID：15093838
> 
> 赞同：4
> 
> 时间：2013-02-26T16:09:01.940
> 
> 标签：javascript, dom-events, setinterval, event-loop, task-queue

我对这个问题的答案中的一些术语有些困惑：[JavaScript 中的事件优先级是什么？](https://stackoverflow.com/a/282271)

事件循环和任务队列之间有区别吗？这些队列有多大？

因为当我设置一个间隔`setInterval()`并用一个中断它时，`alert()`间隔会在警报出现的时间被丢弃。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-04-16T07:03:34.690

**堆**：存储所有变量、对象、函数和分配给所有这些内存

**事件队列**：他是包含列表函数的人，**TOBE EXCECUTED** By **Stack**。

**Stack : 他是****Event queue**持有的**EXECUTES** **FUNCTIONS**的主要负责人

 ****事件循环**：

1.  他是与**Event Queue** And **Stack**联系的人（经理） 。

2.  他所做的是。**Ifff****堆栈**为**空**且**事件队列**包含要执行的函数**。****然后将第一个函数从事件队列推送到堆栈**

**视觉示例 1**：[latentflip](http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhlbGxvLCB3b3JsZCEiKTsgIAo%3D!!!)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T16:16:05.600

这是一个实现细节——规范说一个事件**循环**可以使用多个任务队列来存储事件。大概对队列的大小没有实际限制。

例如，鼠标/键盘事件可以进入一个特殊的 INPUT 任务队列，该队列具有比其他任务更高的优先级，可能是为了使 UI 更具响应性。

`alert`会中断事件的处理，因为它是同步操作。在此期间，大概任何适用的事件都会排队。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T16:14:16.937

我认为您只是在`setInterval()`. 如果`setInterval()`无法跟上所需的间隔率，那么它将跳过间隔，因为如果没有，那么额外的间隔可能会永远建立起来，这不好，因为它会使某个地方的队列饱和。

从我在排队行为中看到的一切来看，间隔和事件都在同一个队列中，并按照它们应该发生的顺序进行处理。不同之处在于，如果`setInterval()`队列中已经有一个尚未处理的回调，它不会将另一个回调放入队列（从而跳过它）。

Mousemove 事件也经过特殊处理，因此您也不能用它们填满队列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-21T05:23:20.383

您发布的问题确实是一个受欢迎的问题，但是您无法清楚地说明它。

首先，js本质上是同步的。浏览器有助于使其成为异步的。

js 的调用栈是同步工作的，但是每当遇到异步代码（setTimeout()，HTTP 请求）时，它就会被发送到浏览器的 web api。

处理它的地方，例如等待请求的响应或等待超时完成。（这段异步代码暂时从调用栈中移除，调用栈移到下一个任务上）

在 web api 收到响应或超时 fn 结束后，它将被发送到任务队列，该队列将所有异步代码排队

这是事件循环真正发挥作用的地方。它首先检查调用堆栈是否为空，如果是，则将任务队列的第一个元素压入堆栈。

因此，在您发出警报的情况下，它阻塞了调用堆栈，因此无法将 setInterval 推入调用堆栈**

# php - 在 Pivot 查询中查找最后一个“非 Null”值

> ID：15093845
> 
> 赞同：7
> 
> 时间：2013-02-26T16:09:32.547
> 
> 标签：php, sql-server, performance, pivot

我有以下查询：

```
 SELECT * FROM 
                (
                    SELECT unix_timestamp, input_raw, tag_id 
                    from [200030].[dbo].inputs
                    WHERE inputs.date_time > dateadd(day,-1,getdate())
                    AND
                    (tag_id = 92164 or tag_id = 92149)
                ) src
                pivot
                (
                    max(input_raw)
                    FOR tag_id IN ([92164], [92149])
                ) piv
                ORDER by unix_timestamp DESC 
```

这很棒而且很有效。它给了我结果：

![在此处输入图像描述](../Images/3250f392fe88f18fd4cbdb8d77f2ab0f.png)

但是，我希望查询为我再做一件事。

每当有“NULL”结果时，我希望查询用列中最后一个“非NULL”值替换“NULL”。

例如，在列“92164”中看到的第一个 NULL 将被替换为“211”。

此外，可能会有几个 'NULL' 的 ia 行，因此查询需要继续向上列，直到找到一个无 NULL。

我已经能够用 php 完成这个任务。将结果放入二维关联数组并运行一个查找空值的函数，然后循环查找最后一个非空值，但如果可能的话，我真的想在 SQL 中完成这一切。我宁愿使用

```
while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)){
  //code     
} 
```

方法比分配几个数组。

有什么帮助吗？

谢谢

//编辑

忘了补充一点，这仅适用于空值上方有任何非空值的情况。例如，如果第一行为 NULL，则可以接受。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T19:01:55.360

您可以将数据透视查询放在 CTE 中，并在确定要显示的值时重用 CTE。您的数据仅在第一列中具有空值，但这是一个处理两列中的空值的版本。

```
WITH C AS
(
  SELECT * 
  FROM (
       SELECT unix_timestamp, input_raw, tag_id 
       FROM inputs
       WHERE date_time > dateadd(day,-1,getdate()) AND
             (tag_id = 92164 OR tag_id = 92149)
       ) src
  PIVOT
       (
       MAX(input_raw)
       FOR tag_id IN ([92164], [92149])
       ) piv
)
SELECT C1.unix_timestamp,
       (
       SELECT TOP(1) C2.[92164] 
       FROM C AS C2
       WHERE C1.unix_timestamp <= C2.unix_timestamp AND
             C2.[92164] IS NOT NULL
       ORDER BY C2.unix_timestamp
       ) AS [92164],
       (
       SELECT TOP(1) C2.[92149] 
       FROM C AS C2
       WHERE C1.unix_timestamp <= C2.unix_timestamp AND
             C2.[92149] IS NOT NULL
       ORDER BY C2.unix_timestamp
       ) AS [92149] 
FROM C AS C1
ORDER by C1.unix_timestamp DESC; 
```

如果您遇到性能问题，将 CTE 的结果存储在具有有用聚集键索引的临时表中可能会更快。

```
CREATE TABLE #C
(
  unix_timestamp int PRIMARY KEY,
  [92164] int,
  [92149] int
);

INSERT INTO #C
SELECT *
FROM (
      SELECT unix_timestamp, input_raw, tag_id 
      FROM inputs
      WHERE date_time > dateadd(day,-1,getdate()) AND
            (tag_id = 92164 OR tag_id = 92149)
      ) src
PIVOT
      (
      MAX(input_raw)
      FOR tag_id IN ([92164], [92149])
      ) piv;

SELECT C1.unix_timestamp,
       (
       SELECT TOP(1) C2.[92164] 
       FROM #C AS C2
       WHERE C1.unix_timestamp <= C2.unix_timestamp AND
             C2.[92164] IS NOT NULL
       ORDER BY C2.unix_timestamp
       ) AS [92164],
       (
       SELECT TOP(1) C2.[92149] 
       FROM #C AS C2
       WHERE C1.unix_timestamp <= C2.unix_timestamp AND
             C2.[92149] IS NOT NULL
       ORDER BY C2.unix_timestamp
       ) AS [92149]
FROM #C AS C1
ORDER by C1.unix_timestamp DESC;

DROP TABLE #C; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T19:10:27.643

[您可以使用此处详述](http://geekswithblogs.net/Rhames/archive/2008/10/28/calculating-running-totals-in-sql-server-2005---the-optimal.aspx)的“运行总计”计算方法的改编版。创建一个临时表或表变量来保存数据透视查询的结果，并使用一个额外的列来保存 92164 列的最后一个非空值。我无法让 SQLFiddle 执行此操作，*但它可以在我的机器上运行*（著名的遗言）

```
CREATE TABLE #pivot_results ([unix_timestamp] int, [92164] int, [92149] int)
INSERT INTO #pivot_results  ([unix_timestamp], [92164], [92149])
VALUES
    (1361893407, NULL, 294),
    (1361893218, 207, 294),
    (1361893108, NULL, 292),
    (1361892807, 211, 292),
    (1361892799, NULL, 292)    
CREATE TABLE #update_me 
    ([unix_timestamp] int, [92164] int, [92149] int, last_not_null_92164 int)

DECLARE @last_not_null_92164 INT = NULL;

INSERT INTO #update_me([unix_timestamp], [92164], [92149], last_not_null_92164)
SELECT unix_timestamp, [92164], [92149], NULL
FROM #pivot_results
ORDER BY unix_timestamp DESC

UPDATE #update_me
SET @last_not_null_92164 = last_not_null_92164 = ISNULL([92164],@last_not_null_92164)
FROM #update_me

SELECT 
     unix_timestamp
    ,last_not_null_92164 AS [92164]
    ,[92149] 
FROM #update_me
ORDER BY unix_timestamp DESC 
```

# java - 如何为 Web 应用程序配置 log4j.xml？

> ID：15093850
> 
> 赞同：0
> 
> 时间：2013-02-26T16:09:52.953
> 
> 标签：java, xml, web-applications, log4j, weblogic

我正在尝试在 webLogic 上运行 java 应用程序，我使用 log4j。我将 log4j.xml 放在 Eclipse 和 webLogic 服务器的 WebContent/WEB-INF 中（当我尝试在服务器上运行应用程序并且 Eclipse 出现问题时）说内容中不允许使用 DOCTYPE。我了解问题来自包含以下第一行的 log4j.xml：

```
<element><!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"></element>
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
...
</log4j:configuration> 
```

. log4j.xml 不应该放在 WebContent 文件夹中吗？有没有另一种方法来配置 log4j 不使用！DOCTYPE？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:18:32.160

您的 XML 并不是真正的 XML（因此您甚至不需要查看 log4j 的东西）。

Doctypes 必须在 XML 文档的正文之前声明。您将它放在“元素”标签的中间。通过将 doctype 放在标签的中间，文档“变成”不是 XML。

# tidesdk - 为 TideSDK 应用程序添加白标

> ID：15093851
> 
> 赞同：0
> 
> 时间：2013-02-26T16:09:53.947
> 
> 标签：tidesdk, white-labelling

我正在通过转换现有的 AIR 应用程序来构建我的第一个 TideSDK 应用程序，并且客户希望为该应用程序贴上白标。对于 AIR 应用程序，我们可以将`application.xml`文件指向品牌特定 HTML 的位置，但我没有看到使用`tiapp.xml`. 它在那里，我只是想念它吗？

在这种情况下，白色标签主要意味着徽标的变化，也许还有一些颜色，所以它几乎不是什么密集的东西。使用 TideSDK 执行此类操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:35:38.483

TideSDK 与任何用于品牌推广的网络应用程序没有什么不同。CSS 用于设置 HTML 样式。当然，您在基础应用程序中拥有的任何默认 CSS 都可能会被覆盖以进行品牌塑造。

除了 HTML，本机 UI 由操作系统控制，您只需关注和替换我们提供的本机安装程序中的默认图稿（使用您自己的品牌）。

如果您需要更改图标名称（这不是必需的），请在 tiapp.xml 和清单中执行此操作。只需将图像替换为您自己的图像即可。这同样适用于安装艺术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T12:12:06.890

您可以使用清单文件中的属性图像修改徽标：

#image:default_app_logo.png

改成

#image:my_logo.png

# mysql - 选择表中只有一个值的行

> ID：15093856
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:04.947
> 
> 标签：mysql, sql, select

这是我的表的样子：

（前面不说了，colum2是字符串类型，不是整数，不好意思）

```
╔══════╦═══════╗
║ USER ║ COLOR ║
╠══════╬═══════╣
║ a    ║ Red   ║
║ b    ║ Blue  ║
║ c    ║ Blue  ║
║ b    ║ Red   ║
║ a    ║ Red   ║
║ c    ║ White ║
╚══════╩═══════╝ 
```

我只需要*只有*颜色=“红色”的行。
它必须返回“a”（“b”也包含值“Blue”）。

如何设置选择？谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:12:37.567

```
SELECT  column1
FROM    TableName
GROUP   BY Column1
HAVING  COUNT(DISTINCT column2) = 1
        AND MAX(column2) = 1 
```

*   [SQLFiddle Demo](http://www.sqlfiddle.com/#!2/938d5/1)

here's another way,

```
SELECT  column1
FROM    TableName
GROUP   BY Column1
HAVING  MAX(column2) = MIN(column2) AND
        MAX(column2) = 1 
```

*   [SQLFiddle Demo](http://www.sqlfiddle.com/#!2/938d5/3)

**UPDATE 1**

```
SELECT  user
FROM    TableName
GROUP   BY user
HAVING  SUM(color = 'red') = COUNT(*) 
```

*   [SQLFiddle Demo](http://sqlfiddle.com/#!2/a82e9/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:15:12.947

更有效的方法是比较`min`和`max`值：

```
select column1
from t
group by column1
having min(column2) = max(column2) and min(column2) = 1 
```

如果该列可以采用 NULL 值，则还需要排除这些值：

```
select column1
from t
group by column1
having min(column2) = max(column2) and min(column2) = 1 and count(column2) = count(*) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-26T16:11:39.010

```
Select distinct Column1 from Table1 Where Column2='1' 
```

或者如果它是整数，那么：

```
Select distinct Column1 from Table1 Where Column2=1 
```

假设 Table1 是表名

# javascript - 使用 jquery 异步发送 $_FILES 数据

> ID：15093857
> 
> 赞同：2
> 
> 时间：2013-02-26T16:10:05.600
> 
> 标签：javascript, jquery, ajax, xmlhttprequest

我知道用 jquery 发送 $_POST 数据非常简单，但是可以用 jquery 发送 $_FILES 数据吗？目前我正在使用 HTTPRequest，但如果可以使用 jquery，我会更喜欢它。谢谢。

```
function upload() {

     var fileInput = $('#file')[0];
     var data = new FormData();

     for(var i = 0; i < fileInput.files.length; ++i){data.append('file[]',fileInput.files[i]);}
     var request = new XMLHttpRequest();

     request.open('POST','upload.php',true);
     request.setRequestHeader('Cache-Control','no-cache');
     request.onreadystatechange = function() {
  if(request.readyState == 4 && request.status == 200) {

          var return_data = request.responseText;
          alert(return_data);
               if(return_data !== 'success') {
                  failed();
               }else
                if(return_data == 'success') {

                 success();
               }
            }
         }
          request.send(data);
      }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:25:51.287

这是您所拥有的 jQuery 版本

```
function upload() {
    var fileInput = $('#file')[0];
    var data = new FormData();

    for(var i = 0; i < fileInput.files.length; ++i){
        data.append('file[]',fileInput.files[i]);
    }
    $.ajax({
        type:'POST',
        method:'POST',/* for newest version of jQuery */
        url:'upload.php',
        headers:{'Cache-Control':'no-cache'},
        data:data,
        contentType:false,
        processData:false,
        success: function(response){
            var return_data = response;
            alert(return_data);
            if(return_data !== 'success') {
                 failed();
            }
            else if(return_data == 'success') {
                success();
            }         
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:13:13.653

不，你需要一个表格。将文件 POST 到服务器的方法是使用 enctype="multipart/form-data" 的 FORM。您可以拥有的是发布到 iframe 的表单。

# php - 在没有循环的数组中获取 N 位置的元素

> ID：15093859
> 
> 赞同：18
> 
> 时间：2013-02-26T16:10:13.277
> 
> 标签：php, arrays

如何在没有循环的特定位置获得元素`key`和位置数组`value`的元素。`n`

想象

```
$postion = 3; // get array at 3rd position
$array = array(
        "A" => "Four",
        "B" => "twp",
        "C" => "three",
        "D" => "Four",
        "E" => "Five",
        "F" => "Four");

$keys = array_keys($array);
$value = array_values($array);

echo implode(array_slice($keys, $postion, 1)), PHP_EOL; // Key at 3rd posstion
echo implode(array_slice($value, $postion, 1)), PHP_EOL; // Value at n position 
```

输出

```
D
Four 
```

该方法的问题是

*   数组的多次复制导致更高的内存使用率

为什么不使用循环

*   您必须多次获得多个位置..循环大型数据集也效率不高

为什么不使用数据库

*   是的，使用像 Redis 这样的基于内存的数据库可以让生活更轻松，但特别是数组优化

为什么不使用`SplFixedArray`

*   这本来是解决方案，但我遵循的是因为我没有使用正键（我真的这在 php 部分也不公平）

    ```
    Fatal error: Uncaught exception 'InvalidArgumentException' 
    with message 'array must contain only positive integer keys' 
    ```

大数据集是什么意思：

*   实际上，我在尝试这个问题时偶然发现了这个问题，[在 PHP 中管理大型数组，](https://stackoverflow.com/questions/14880830/managing-mega-arrays-in-php)所以我正在查看`1e6`或`1e7`使用`512M memory limit`

我确信像`fseek`for array 这样的东西可以解决问题..但不确定是否存在

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-26T16:18:06.230

假设 PHP 5.4，使用数组解引用：

```
echo $array[array_keys($array)[$position]]; 
```

在早期版本中，您需要将其分成两行：

```
$keys = array_keys($array);
echo $array[$keys[$position]]; 
```

如果您必须访问多个元素，那么在 5.4+ 中使用两行方法也是值得的，以允许您只调用`array_keys()`一次相对昂贵的函数。此外，取消引用方法假定数组中的特定位置存在，但它可能不存在。将其分解为多个操作将允许您处理该错误情况。

虽然您当然不需要访问密钥，但您可以简单地执行以下操作：

```
echo array_values($array)[$position];
// or
$values = array_values($array);
echo $values[$position]; 
```

**编辑**

该[`ArrayIterator`](http://www.php.net/manual/en/class.arrayiterator.php)课程还可以为您执行此操作：

```
$iterator = new ArrayIterator($array);
$iterator->seek($position);

echo $iterator->key(), " = ", $iterator->current(); // D = Four 
```

这可能是最便宜的方法，假设它不会在您执行此操作时在内存中创建数组的副本（仍在研究此元素），并且可能是多次访问任意键的最佳方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-26T16:19:25.573

你想要的是不可能的。PHP 的数组可以通过键有效访问，但不能通过偏移有效访问。该顺序仅作为链表提供，因此您希望的最佳效率是 O(n) 循环，它只是遍历数组并查找偏移量：

```
$i = 0;
foreach ($array as $value) {
    if ($i++ === $offset) {
        // found value
    }
} 
```

如果您希望此操作快速进行，则必须使用正确的、数字和顺序索引的数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-26T16:18:20.857

事实上你不需要 $values 数组：

```
$keys = array_keys($array);

$value_3=$array[$keys[3]]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T16:16:32.213

我不太了解您的问题，但是如果您需要位置的关键和元素

```
$position = 3; // get array at 3rd position
$array = array(
        "A" => "Four",
        "B" => "twp",
        "C" => "three",
        "D" => "Four",
        "E" => "Five",
        "F" => "Four");

$keys = array_keys($array);
$values = array_values($array);

if($values[$position] == "Four" && $keys[$position] == "D") {
    echo "All it's Right!\n";
} 
```

你不需要为那个任务内爆

# python - 从应用程序包中提取 pyc

> ID：15093865
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:34.813
> 
> 标签：python, macos, py2app

无论如何可以从应用程序包中提取 pyc 文件吗？我指的是通过在 python 代码上使用 py2app 创建的应用程序包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T20:45:42.740

pyc 文件存储在 Resources 文件夹中的 zip 文件中。zip 文件的名称取决于 Python 版本，对于 2.7，它是 .app/Contents/Resources/python2.7/site-packages.zip。

该 zip 文件是可以使用常用工具操作的常规 zip 文件。

# google-app-engine - Appengine 开发模式不会更新对 html 文件的更改

> ID：15093866
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:37.710
> 
> 标签：google-app-engine, gwt

在开发模式下运行时，如果我对我的 html 页面进行更改，则更改不会显示在浏览器中。这是一个 GWT 应用程序，我能够更新的唯一方法是重新编译 gwt 模块。我试过重建项目并停止/启动开发模式，但没有任何运气。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:19:29.493

我发现这只是 chrome 缓存页面。我在开发工具中禁用了缓存，这解决了这个问题。

在这里找到了类似的帖子，其中包含有关如何禁用的说明： [禁用 Chrome 缓存以进行网站开发](https://stackoverflow.com/questions/5690269/disabling-chrome-cache-for-website-development)

# jquery - jQuery：通过 Tab 访问下拉菜单项

> ID：15093867
> 
> 赞同：2
> 
> 时间：2013-02-26T16:10:38.230
> 
> 标签：jquery, drop-down-menu, accessibility

我正在尝试通过键盘访问下拉菜单（仅使用 Tab，没有访问键）。我不知道如何使子项可访问。

期望的行为如下：当“item”被点击或获得焦点时，显示列表；当“项目”失去焦点（模糊）时，如果没有“子项目”有焦点（这意味着它已通过键盘访问），隐藏列表。

小提琴：http: [//jsfiddle.net/DBdbz/](http://jsfiddle.net/DBdbz/)

**HTML**

```
<p id="ui"><a href="#">Item</a></p>
<ul>
    <li><a href="#">Sub item 1</a></li>
    <li><a href="#">Sub item 1</a></li>
    <li><a href="#">Sub item 1</a></li>
</ul> 
```

**JS**

```
$('ul').hide();

$('#ui a').on('focus', function() {
  $('ul').show();
});

$('#ui a').on('blur', function() {
  $('ul').hide();
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T21:32:42.227

这是另一个正确执行标签的小提琴。当我点击“项目”时，你原来的小提琴没有打开菜单，所以我不确定这意味着什么。

[http://jsfiddle.net/DBdbz/4/](http://jsfiddle.net/DBdbz/4/)

此代码遵循您的代码以使标签工作：

```
$("ul a").on('focus', function() {
    $('ul').show();
});

$("ul a").on('blur', function() {
    $('ul').hide();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T12:00:46.113

这个怎么样：http: [//jsfiddle.net/DBdbz/6/](http://jsfiddle.net/DBdbz/6/)？

要使焦点/模糊在每个浏览器上都起作用，唯一需要的是给定元素上的 tabindex（无论是哪一个，请参见 Lee 的[链接](http://www.quirksmode.org/dom/events/blurfocus.html)）：

```
<p id="ui"><a href="#" tabindex="1">Item</a></p>
<ul>
    <li><a href="#">Sub item 1</a></li>
    <li><a href="#">Sub item 1</a></li>
    <li><a href="#">Sub item 1</a></li>
</ul> 
```

JS来了：

```
$('ul').hide();

$('#ui a').on('focus', function() {
  $('ul').show();
});

$('#ui a').on('keydown', function(e) {
  if (e.keyCode == 9) {
    $('ul').addClass('tab');
  }
});

$('ul').on('mouseover', function() {
  $('ul').addClass('mouse');
});

$('ul').on('mouseout', function() {
  $('ul').removeClass('mouse').removeClass('tab');
});

$('ul li:last-child a').on('blur', function() {
  if ($('ul').hasClass('tab')) {
    $('ul').hide().removeClass('tab');
  } 
});

$('#ui a').on('blur', function() {
  if (!$('ul').is('.tab, .mouse')) {
    $('ul').hide();
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:27:07.343

您可以尝试以下方法：

```
$('ul').hide();

$('#ui a').on('focus', function() {
  $('ul').show();
});

$('#ui a').on('blur', function() {
  if ($('ul li').is(':focus').length < 1) $('ul').hide();
}); 
```

如果 ul 的 li 都没有聚焦，它只会隐藏 ul。

# c# - MVC 4 - 在 beginrequest 和 endrequest 之间丢失自定义主体

> ID：15093869
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:42.330
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, httpcontext

在我的项目 (c#) 中，我们有一个 HttpModule，它创建了一个自定义 Principal，我们将其附加到 CurrentPrincipal。

这适用于我们所有的 MVC3 应用程序和我们的经典 ASP.Net 应用程序。

我们有一个 AuthorizeAttribute 覆盖我们用来保护我们的控制器方法 - 看起来很标准。

问题是在自定义 authorizeAttribute 中，用户 (httpContext.User) 是 RolePrincipal 而不是自定义主体。

为了排除故障，我在 global.asax 中放置了一些处理程序来捕获 beginrequest() 和 endrequest()。好吧，在 BeginRequest 中，我的 User 就是我们所期望的 - 自定义主体。在 EndRequest 中，用户又是 RolePrincipal。HttpModule 的 web.config 声明很好——我可以逐步了解 HttpModule 的代码。

有谁知道发生了什么？我们有一个自定义的 HttpModule，但我无法为这个项目修改该代码（它在任何地方都被使用并且工作正常）。

这是我的第一个 MVC4 项目 - 我想知道 MVC4 是否有不同的做法。

代码如下。有没有我遗漏的信息？

编辑：添加授权属性代码。

```
Code
      (In HttpModule)
    private void BeginRequest(object Sender, EventArgs e)
    {
        HttpContext context = HttpContext.Current;
        var Id = new TASBIdentity();
        context.User = new TASBPrincipal(Id);
        Thread.CurrentPrincipal = context.User;
                      (etc...)

    (In global.asax)
    void Application_BeginRequest(object sender, EventArgs e)
    {
        HttpContext context = HttpContext.Current;
        var user = context.User;  // user is correct type
    }

    void Application_EndRequest(object sender, EventArgs e)
    {
        HttpContext context = HttpContext.Current;
        var user = context.User;    // user is default type (not correct)
    }

   (In the authorizeattribute)
public class SecuredByFunctionAttribute : AuthorizeAttribute
{
    private readonly string _functionKey;

    public SecuredByFunctionAttribute(string functionKey)
    {
        _functionKey = functionKey;
    }
    protected override bool AuthorizeCore(System.Web.HttpContextBase httpContext)
    {
        return httpContext.User.IsInRole(_functionKey);
    } 
```

# sql - 在 Sql Server 2012 中获取查询的最后 10 次执行时间

> ID：15093870
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:43.740
> 
> 标签：sql, performance, sql-server-2012

通过这个查询，我得到了 Sql Server 中排名前 10 的慢查询。

```
SELECT TOP 20 
    SUBSTRING(qt.text, (qs.statement_start_offset/2)+1, 
    ((CASE qs.statement_end_offset WHEN -1 THEN DATALENGTH(qt.text) 
                                   ELSE qs.statement_end_offset
      END - qs.statement_start_offset)/2)+1), 
    qs.execution_count, 
    qs.total_logical_reads, qs.last_logical_reads,
    qs.min_logical_reads, qs.max_logical_reads,
    qs.total_elapsed_time, qs.last_elapsed_time,
    qs.min_elapsed_time, qs.max_elapsed_time,
    qs.last_execution_time,
    qp.query_plan
FROM 
    sys.dm_exec_query_stats qs
CROSS APPLY 
    sys.dm_exec_sql_text(qs.sql_handle) qt
CROSS APPLY 
    sys.dm_exec_query_plan(qs.plan_handle) qp
WHERE 
    qt.encrypted = 0
ORDER BY 
    qs.total_logical_reads DESC 
```

我想要做的是找到每个查询最后 10 个执行时间。或者一天中的平均执行时间让我很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T11:20:29.767

您可以在特定时间段创建数据库过程执行的快照，然后您可以比较它们。使用 sql 以将每个快照插入到表中。

```
 SELECT 
         getDAte() as SnapshotDate,
         s.database_id,
       s.[plan_handle],
       s.[object_id],
       s.last_execution_time,
       s.execution_count,
       s.total_worker_time,
       s.last_worker_time,
       s.min_worker_time,
       s.max_worker_time,
       s.total_physical_reads,
       s.last_physical_reads,
       s.min_physical_reads,
       s.max_physical_reads,
       s.total_logical_writes,
       s.last_logical_writes,
       s.min_logical_writes,
       s.max_logical_writes,
       s.total_logical_reads,
       s.last_logical_reads,
       s.min_logical_reads,
       s.max_logical_reads,
       s.total_elapsed_time,
       s.last_elapsed_time,
       s.min_elapsed_time,
       s.max_elapsed_time  

FROM sys.dm_exec_procedure_stats AS s 
WHERE s.database_id NOT IN
                           (
                             DB_ID('master'),
                             DB_ID(N'tempdb'),
                             DB_ID(N'model'), DB_ID(N'msdb'),
                             32767 -- RESOURCE db

                         ) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:29:38.447

如果要检查运行缓慢以及原因，请检查[SSMS 中的标准报告](http://jasonbrimhall.info/2011/03/16/sql-server-standard-reports-winforms/)。

# sql - GROUP BY 返回错误的值？

> ID：15093871
> 
> 赞同：0
> 
> 时间：2013-02-26T16:10:49.903
> 
> 标签：sql, sql-server, tsql

我编写了以下查询，但它没有按日期正确分组并返回 2 行，实际上应该由`GROUP BY`.

```
select i.overridedate,
       month(i.Overridedate), 
       count(i.id)as count,
       sum(case when oi.rating <50 then 1 else 0 end) as unfav,
       sum(case when oi.Rating =50  then 1 else 0 end) as neu,
       sum(case when oi.Rating >50  then 1 else 0 end) as fav,
       avg(oi.Rating)as 'Av Rating'
from Items i (nolock)

inner join ItemOrganisations oi (nolock) on i.ID= oi.ItemID
inner join Lookup_ItemTypes it (nolock) on it.ID = i.ItemTypeID
inner join Batches b (nolock) on b.ID=i.BatchID
inner join Lookup_ItemStatus lis (nolock) on lis.ID = i.StatusID
inner join Lookup_BatchStatus lbs (nolock) on lbs.ID = b.StatusID
inner join Lookup_BatchTypes bt on bt.id = b.Typeid

where lbs.Name = 'Completed by Analyst'
      or lbs.Name='Delivered/Imported into Neptune Online'
      and lis.Name = 'Complete'
      and i.IsRelevant = 1
      and bt.Name = 'Live'
    group by i.overridedate, Month(i.OverrideDate)
    having i.OverrideDate between '2012-07-01 00:00:00.000' and '2012-09-30 00:00:00.000' 
```

如您所见，代表第 7 个月数据的最后两行未按以下方式分组：

```
NULL       NULL             1     0     1     0     1     55
2013-01-03 00:00:00.000     1     1     1     0     0     10
2012-05-28 00:00:00.000     5     7     1     0     1     50
2012-06-01 00:00:00.000     6     7     1     0     0     20
2012-07-10 00:00:00.000     7     1     0     0     0     NULL
2012-07-11 00:00:00.000     7     8     1     0     6     66 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:17:23.473

`group by`是正确的。为什么要在其中包含覆盖日期？

也许您的选择应该是：

```
select min(i.overridedate), month(i.Overridedate),
. . . 
group by month(i.Overridedate) 
```

而且，我强烈同意包含年份的评论：

```
select min(i.overridedate), year(i.Overridedate), month(i.Overridedate),
. . . 
group by year(i.Overridedate), month(i.Overridedate) 
```

# linux - 是否有这样的命令可以在 shell 中合并多个文件？

> ID：15093874
> 
> 赞同：0
> 
> 时间：2013-02-26T16:11:00.847
> 
> 标签：linux, perl, shell, unix, sed

例如，有 5 个数字 => [1,2,3,4,5] 和 3 个组

文件 1（组 1）：

```
1
3
5 
```

文件 2（组 2）：

```
3
4 
```

文件 3（组 3）：

```
1
5 
```

输出（column1：是否在Group1，column2：是否在Group2，column3：是否在Group3 [NA表示不..]）：

```
1 NA 1
3 3 NA
NA 4 NA
5 NA 5 
```

或类似的东西（+ 表示在，- 表示不）：

```
1 + - +
3 + + -
4 - + -
5 + - + 
```

我试过`join`and `merge`，但看起来它们都不适用于**多个**文件..（例如，8个文件）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T17:32:05.760

你说有数字 1-5，但据我所知，这与你想要的输出无关。您只使用在输出中的文件中找到的数字。此代码将执行您想要的操作：

```
use strict;
use warnings;
use feature 'say';

my @hashes;
my %seen;
local $/;   # read entire file at once
while (<>) {
    my @nums = split;                          # split file into elements
    $seen{$_}++ for @nums;                     # dedupe elements
    push @hashes, { map { $_ => $_ } @nums };  # map into hash
}

my @all = sort { $a <=> $b } keys %seen;       # sort deduped elements
# my @all = 1 .. 5;                            # OR: provide hard-coded list

for my $num (@all) {                           # for all unique numbers
    my @fields;
    for my $href (@hashes) {                   # check each hash
        push @fields, $href->{$num} // "NA";   # enter "NA" if not found
    }
    say join "\t", @fields;                    # print the fields
} 
```

您可以将排序的重复数据删除列表替换为`@all`仅`my @all = 1 .. 5`或任何其他有效列表。然后它将为这些数字添加行，并为缺失值打印额外的“NA”字段。

您还应该知道，这取决于您的文件内容是数字这一事实，但仅限于`@all`数组的排序，因此如果您将其替换为您自己的列表或您自己的排序例程，您可以使用任何值。

该脚本将获取任意数量的文件并对其进行处理。例如：

```
$ perl script.pl f1.txt f2.txt f3.txt
1       NA      1
3       3       NA
NA      4       NA
5       NA      5 
```

感谢[Brent Stewart](https://stackoverflow.com/users/353186/brent-stewart)弄清了 OP 的含义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:43:03.243

对于两个文件，您可以轻松使用`join`如下所示（假设`file1`并`file2`已排序）：

```
$ join -e NA -o 1.1,2.1 -a 1 -a 2  file1 file2
1 NA
3 3
NA 4
5 NA 
```

如果你有两个以上的文件，它会变得更加复杂。

这是一个蛮力`grep`解决方案：

```
#!/bin/bash
files=(file1 file2 file3)
sort -nu "${files[@]}" | while read line; do
    for f in "${files[@]}"; do   
         if grep -qFx "$line" "$f"; then
             printf "${line}\t"
         else
             printf "NA\t"
         fi
    done
    printf "\n"
done 
```

输出：

```
1       NA      1
3       3       NA
NA      4       NA
5       NA      5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T17:11:21.303

```
#!/usr/bin/env perl
use strict;
use warnings;
use autodie;

my @lines;
my $filecount = 0;

# parse
for my $filename (@ARGV){
  open my $fh, '<', $filename;
  while( my $line = <$fh> ){
    chomp($line);
    next unless length $line;
    $lines[$line][$filecount]++;
  }
  close $fh;
}continue{
  $filecount++;
}

# print
for my $linenum ( 1..$#lines ){
  my $line = $lines[$linenum];
  next unless $line;

  print ' ' x (5-length $linenum), $linenum, ' ';

  for my $elem( @$line ){
    print $elem ? 'X' : ' '
  }
  print "\n";
} 
```

```
 1 X X
    3 XX
    4  X
    5 X X 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T18:11:08.893

如果您的输入文件是单调递增的，并且正如您的输入样本所建议的那样，每行仅包含一个整数，您可以简单地预处理输入文件并使用粘贴：

```
for i in file{1,2,3}; do  # List input files
  awk '{ a += 1; while( $1 > a ) { print "NA"; a += 1 }} 1' $i > $i.out
done
paste file{1,2,3}.out 
```

这会使某些列中的尾随条目为空。修复这个问题留给读者作为练习。

# bash - 文本模式下 svn checkout 的进度条

> ID：15093884
> 
> 赞同：3
> 
> 时间：2013-02-26T16:11:36.273
> 
> 标签：bash, svn, progress-bar

我正在编写一个 bash 脚本，该脚本需要从多个远程颠覆存储库中获取源代码。我曾经`svn checkout -q`避免显示使输出混乱的长文件列表，但现在我正在寻找一种干净的方式来在每个`svn checkout`. `wget`与和`curl`的进度指标类似的东西。我将在 OSX 和 Linux 中拥有用户。`pv`两者都可用，但到目前为止，我还没有找到如何将它与`svn checkout`. 我还应该说，我不是在寻找使用 GUI 窗口的工具，而是在寻找纯文本工具。

任何建议都将非常受欢迎！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-13T20:37:24.803

我发现的最接近的东西：[http ://www.danielkraaij.nl/2014/03/30/subversion-progressbar-in-bash/](http://www.danielkraaij.nl/2014/03/30/subversion-progressbar-in-bash/)

```
n=$(svn info -R svn://svn/project/trunk | grep "URL: " | uniq | wc -l) 
```

* * *

```
n=$(svn info -R svn://svn/project/trunk | grep "URL: " | uniq | wc -l)
i=1
while read line filename
    do
    counter=$(( 100*(++i)/n))
    echo -e "($counter %)\n"
    echo -e "filename: $filename \n"
done < <(svn co svn://svn/project/trunk /var/www/project) 
```

* * *

```
dialog --backtitle "Subversion Installer" --title "SVN Checkout" --gauge "Getting total file count" 7 120 < <(
    n=$(svn info -R svn://svn/project/trunk | grep "URL: " | uniq | wc -l)
    i=1
    while read line filename
        do
        counter=$(( 100*(++i)/n))
        echo "XXX"
        echo "$counter"
        echo "filename: $filename"
        echo "XXX"

    done < <(svn co svn://svn/project/trunk /var/www/project)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:27:31.437

尝试：

```
svn list -v -R URL 
```

您可以解析结果，并按文件数进行处理。

# c++ - 如何将复杂的三角形数组加载到 CGAL 的 Nef Polyhedra 中以对其进行 3D 布尔运算？

> ID：15093888
> 
> 赞同：0
> 
> 时间：2013-02-26T16:11:50.927
> 
> 标签：c++, geometry, cgal

所以我有一组顶点+三角形（不是一个封闭的实体；多个三角形有些统一，而不是N个岛/平面）。我想将所有这些顶点+三角形视为一个 Nef Polyhedra 并对它们执行布尔运算。如何将所有未连接的三角形加载到 Nef Polyhedra 中？（我的内核是`Exact_predicates_exact_constructions_kernel`）

# regex - cftextarea - 正则表达式 - Microsoft 文本编码问题

> ID：15093891
> 
> 赞同：1
> 
> 时间：2013-02-26T16:12:00.173
> 
> 标签：regex, coldfusion, cfform

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-22T23:23:56.550

# mysql - 尝试更新 NOT NULL var char 字段会将字段设置为空字符串，而不是失败。这是正确的行为吗

> ID：15093893
> 
> 赞同：0
> 
> 时间：2013-02-26T16:12:04.137
> 
> 标签：mysql, null, mode, xeround

我原以为这会失败，但它会擦除现有数据并将其替换为空字符串。这是正确的行为吗？如果是，是否有解决方法来强制错误

例如

```
CREATE TABLE testtable 
    (columna VARCHAR(30) NOT NULL,
    columnb VARCHAR(2) NULL,
    columnc VARCHAR(10) NULL);

INSERT INTO testtable (columna, columnb, columnc)
VALUES ('first entry', '1', null),
    ('second entry', '2', null),
    ('third entry', '3', null);

INSERT INTO testtable (columna, columnb, columnc)
VALUES (null, '4', null); 
```

这失败，错误代码：1048。列“columna”不能为空，这是我所期望的。

然而，

```
UPDATE testtable
SET columna = null WHERE columnb = '2'; 
```

用空字符串替换 columna 的内容

```
Select * from testtable;

first entry 1   
            2   
third entry 3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T19:24:24.447

已经发现这归结为sql模式。通过设置

```
SET GLOBAL sql_mode = 'TRADITIONAL'; 
```

数据库现在可以按我的预期工作并拒绝无效值。

# spring - 带注释的 PRIVATE 方法的 AspectJ 切入点

> ID：15093894
> 
> 赞同：12
> 
> 时间：2013-02-26T16:12:06.913
> 
> 标签：spring, aop, aspectj, spring-aop

我想为带有特定注释的私有方法创建一个切入点。但是，当注释位于下面的私有方法上时，不会触发我的方面。

```
@Aspect
public class ServiceValidatorAspect {
    @Pointcut("within(@com.example.ValidatorMethod *)")
    public void methodsAnnotatedWithValidated() {
}

@AfterReturning(
            pointcut = "methodsAnnotatedWithValidated()",
            returning = "result")
    public void throwExceptionIfErrorExists(JoinPoint joinPoint, Object result) {
         ...
} 
```

服务接口

```
public interface UserService {

    UserDto createUser(UserDto userDto);
} 
```

服务实施

```
 public class UserServiceImpl implements UserService {

       public UserDto createUser(UserDto userDto) {

             validateUser(userDto);

             userDao.create(userDto);
       }

       @ValidatorMethod
       private validateUser(UserDto userDto) {

            // code here
       } 
```

但是，如果我将注释移动到公共接口方法实现`createUser`，则会触发我的方面。我应该如何定义我的切入点或配置我的方面以使我的原始用例正常工作？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-26T16:24:56.860

[8\. Spring 面向切面编程](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/aop.html#aop-introduction-spring-defn)

> 由于 Spring 的 AOP 框架基于代理的性质，根据定义，受保护的方法不会被拦截，对于 JDK 代理（这不适用）和 CGLIB 代理（这在技术上可行但不推荐用于 AOP 目的）都是如此。因此，任何给定的切入点都只会与公共方法匹配！
> 
> 如果您的拦截需求包括受保护/私有方法甚至构造函数，请考虑使用 Spring 驱动的原生 AspectJ 编织而不是 Spring 的基于代理的 AOP 框架。这构成了具有不同特点的不同AOP使用模式，所以在做决定之前一定要先熟悉编织。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T20:36:22.093

切换到 AspectJ 并使用特权方面。或者更改应用程序的设计以适应 Spring AOP 的限制。我的选择是功能更强大的 AspectJ。

# android - How to capture context? polling/events

> ID：15093896
> 
> 赞同：2
> 
> 时间：2013-02-26T16:12:18.037
> 
> 标签：android, cordova

How do apps like tasker capture context. Suppose I want to capture context that when wifi is switched on do something. Is it possible to attach a callback for isWifiEnabled()? or execute a handler when wifi gets enabled without polling. An example code or link to an example code to perform some action when wifi is enabled would be nice. There is `isWifiEnabled()` function in the api but I am not sure how to use this using Intents.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:14:32.900

当这些事件发生时，他们正在收听广播的系统消息。

[https://developer.android.com/guide/components/intents-filters.html](https://developer.android.com/guide/components/intents-filters.html)

当 WiFi 打开或关闭时，会广播一个 Intent，其操作设置为[WIFI_STATE_CHANGED_ACTION](https://developer.android.com/reference/android/net/wifi/WifiManager.html#WIFI_STATE_CHANGED_ACTION)。如果您创建了[`<receiver>`](https://developer.android.com/guide/topics/manifest/receiver-element.html)一个[`<intent-filter>`](https://developer.android.com/guide/topics/manifest/intent-filter-element.html)集合来捕获它，您的应用程序将收到通知。

# jquery - 将 post->post_content 存储在 jquery 变量中

> ID：15093907
> 
> 赞同：0
> 
> 时间：2013-02-26T16:12:52.207
> 
> 标签：jquery, wordpress, variables

我正在尝试将 post_content 存储到一个变量中，然后将该变量添加到数组中。
但是在获取内容时，如果我有这个：

```
<div class="col2 left">
 <!--COMMENT-->
</div>
<div class="col2 right">
 <!--COMMENT-->
</div>
<div class="clr"></div>
  <ul id="mycarousel" class="jcarousel-skin-tango">
     <li><!--IMAGE--></li>
  </ul> 
```

尝试存储它时，由于换行符，它给了我一个错误。我需要保持这种格式。

```
var estructuras = [];
<?php foreach ($est as $estr): ?>
var new_data_var = $('<?php echo $estr->post_content; ?>');
estructuras['<?php echo $estr->post_title; ?>'] = new_data_var;
<?php endforeach; ?> 
```

编辑：现在使用建议的内容，它正在回显到正文中，而不是保留在 $jsData..

```
<?php
   $jsData = array();
   foreach ($est as $estr) {
      $jsData[$estr->post_title] = $estr->post_content;
   }
?>
var estructuras = <?php echo json_encode($jsData); ?>; 
```

对于 var 值，我得到了这个：

```
var estructuras = {"":null}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:17:39.047

关于什么：

```
<?php
$jsData = array();
foreach ($est as $estr) {
    $jsData[$estr->post_title] = $estr->post_content;
}
?>
var estructuras = <?php echo json_encode($jsData); ?>; 
```

# c# - How to open a connection to a SQL Server database that is already in use in c#?

> ID：15093908
> 
> 赞同：0
> 
> 时间：2013-02-26T16:12:53.597
> 
> 标签：c#, asp.net, sql, database-connection, sql-server-2012

I connect to the database in asp.net mvc 3 project. Also I have a windows service project in my solution which on some event writes the data into this database.

The difficulty is that when the code from windows service project needs to connect to the database I get `SqlException`:

> *Cannot open database "WebStore" requested by the login. The login failed. Login failed for user 'NT AUTHORITY\SYSTEM'.*

Here is the code from windows service:

```
 public static string GetConnectionString()
    {
        return @"Data Source=(LocalDB)\v11.0; DataBase=WebStore; 
                AttachDbFilename=myDbFullPath;
                Integrated Security=True;Connect Timeout=30";
    } 
```

And in the event handler that writes to the database:

```
using (var conn = new SqlConnection(GetConnectionString()))
{
    conn.Open();
    var productId = Convert.ToInt32(Regex.Match(e.Name, @"\d+").Value);
    const string cmd1 = "UPDATE Products SET ImageModifiedDate=@date WHERE ProductId=@productId";

    using (var command = new SqlCommand(cmd1, conn))
    {
        command.Parameters.AddWithValue("@productId", productId);
        command.Parameters.AddWithValue("@date", DateTime.Now);
        command.ExecuteNonQuery();
    }
 } 
```

The exception occurs in `conn.Open();` line. If I comment this line new exception will occur in `command.ExecuteNonQuery();`:

> *InvalidOperationException: Opened and available connection is needed for ExecuteNonQuery. Connection is closed.*

**Question:** How to open a connection to the SQL Server database that is already attached in another project?

**Edit 1:** I use the following code to create new login and new user in my DB:

```
CREATE LOGIN user1
WITH PASSWORD = 'password1';
GO
CREATE USER user1 FOR LOGIN user1;
GO 
```

Than I'm trying to attach my DB in Server Explorer: I choose "Use Sql Server Autherntication" and enter user name: user1, password: password1\.

And I get:

> *The attempt to attach to the database failed with the following information:
> Login failed for user 'user1'.*

**Edit 2:** I set this properties:

```
processInstaller.Username = "user1";
processInstaller.Password = "password1"; 
```

and than run in cmd:

```
installutil /name=user1 /password=password1 MyService.exe 
```

and I get *`System.ComponentModel.Win32.Exception:`*
*`the comparison between user names and security identifiers haven't been executed.`*

What do I do wrong?

**Edit 3:** I set my username and password in services.msc and processInstaller "Account" property I left with "Local System". It runs but when I change the image (and the event handler trying to access my database) I get:

*`Cannot attach file 'C:\Users\Aleksey\repos\working-copy\WebStore\WebStore\App_Data\WebStore.mdf' as database 'WebStore' because this file is already in use for database 'C:\USERS\ALEKSEY\REPOS\WORKING-COPY\WEBSTORE\WEBSTORE\APP_DATA\WEBSTORE.MDF',`*

In the connection string I added credentials of user which I've created in the database:

*`User Id=user1;PASSWORD=password1;`*

Besides, when I'm trying to add connection in server explorer and use `Sql Server Authentication` and I enter `user1` and `password1` I get the message from ***Edit 1***.

Should I use in server explorer `*Windows Authentication*` and in windows service in the connection string: *`User Id=user1;PASSWORD=password1;`* ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:18:09.163

```
Cannot open database "WebStore" requested by the login. The login failed. Login failed for user 'NT AUTHORITY\SYSTEM'. 
```

发生这种情况是因为您的服务使用 LocalSystem 帐户运行，并且您正在使用集成安全性连接到 SQL 服务器，而 SYSTEM 不应该在那里访问。所以三选一：

1.  切换到 SQL Server 身份验证。这包括在数据库中创建登录名和修改连接字符串
2.  使用具有它真正需要的唯一权限的特定用户运行服务（这实际上是一个好主意），并授予该用户对数据库的访问权限，以便它可以连接到集成安全性。这是最简单的，因为它不需要对代码进行任何更改
3.  如果您确实需要以 SYSTEM 身份运行，则可以使用模拟通过 LogonUser 切换到另一个用户（如选项 2 中的用户）。这样一来，您最终只能使用选项 2 来访问数据库，并为其余的服务代码保留 SYSTEM 权限。

第二个错误

```
InvalidOperationException: Opened and available connection is needed for ExecuteNonQuery. Connection is closed. 
```

是由第一个错误引起的，无法打开连接会导致此问题。如果没有打开的连接，您将无法执行任何操作，ADO.Net 可以确保这一点。

所以第一个错误是唯一重要的错误。

我建议您使用选项二，因为这是安全实践方面的最佳选择，并且由于您在集成安全中运行，因此您不必存储任何密码，当您的应用程序在多个不同的环境中时，这是一个加分项数据库，用户，密码和你有什么。每个环境，权限和您设置的只是一个用户。

# account - Limit Shipping / Account Creation to single country in OSCommerce

> ID：15093909
> 
> 赞同：-1
> 
> 时间：2013-02-26T16:12:54.310
> 
> 标签：account, shipping, oscommerce

My manager has given me the task of sorting out the ecommerce site which was edited a fair bit by my predecessor - it was based on OSC 3.x

We need to limit shipping to only Ireland (our products generally need to be installed by our staff - and those that don't are either delivered or bulky) and therefore only allow Ireland to be the only options for account creation - is there a way of doing this which doesn't involve using addons - because of the changes made files don't look the same as the instructions for most add ons so I'm reluctant to try and install them.

I'm experience with SQL so considered just editing the country table to remove all countries but Ireland - but perhaps thats too extreme?

thanks! CDC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:24:25.933

最重要的一点是 osCommerce 3.x 从未用于生产站点，因此它不应该用于实时站点。osCommerce 社区在接下来的几个月里看不到稳定版本。

我假设您希望将帐户创建限制在爱尔兰。使用 osCommerce 3.x 数据库表 osc_countries 获取国家/地区列表。

函数 osc_cfg_set_countries_pulldown_menu($default, $key = null)

因此，使用 PhpMyadmin 从 osc_countries 表中删除所有条目，除了从此特定命令创建的条目： INSERT INTO osc_countries VALUES (103,'Ireland','IE','IRL',":name\n:street_address\nIE-:city\ n:国家");

# c# - 在巨大的字符串编译中找到等效的字符串

> ID：15093915
> 
> 赞同：0
> 
> 时间：2013-02-26T16:13:06.743
> 
> 标签：c#, string, performance, compilation

我编写了一个 C# 程序，它保存由一个标题列表组成的解析数据，该列表又包含一个用字符串表示的 ID 列表。

电子邮件：列表<标题>；标题：列表<IDs>

// 一个随机 ID（大约 100 但最多 2000）唯一标识索引中的一个 Header。我将我解析的所有 ID 上传到服务器，该服务器依次在索引中搜索 ID，删除相应的 Header 并使用它删除的 ID 和不在索引上的 ID 写入日志文件。

我的下一步是为已删除的 ID 解析 LogFile，并在我的编译中找到等效 ID，并将其 Header 标记为已删除。

Logparsing 的结果是一个包含所有已成功删除的 ID 的数组。

所以它看起来像这样：

```
foreach(string deletedID in deletedIDs){
   foreach(EMail mail in mails){
      foreach(Header header in mail.headers){
          if(header.Deleted == false){
             for(string iD in header) {
                if(deletedID == iD) header.Deleted = true;
             }
          }
      }
   }
} 
```

我想知道，是否有更有效的方法来做到这一点（甚至更多的方法）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:18:33.080

使用[字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)来保存您的数据，使用`ID`作为键和`Email`或`Header`作为值在这里似乎是合理的。这使您的搜索几乎是即时的。

# angularjs - 当 reloadOnSearch 为 false 时，$location.search 上的 AngularJs $watch 不起作用

> ID：15093916
> 
> 赞同：47
> 
> 时间：2013-02-26T16:13:10.487
> 
> 标签：angularjs, listener, watch

我的*routeProvider*已将*reloadOnSearch*设置为***false***：

```
 $routeProvider
     .when(
        "/film/list",
         {
          templateUrl: '/film/list.html', 
          controller: FilmListController,
          reloadOnSearch: false
          } 
          ....

  ) 
```

我这样做是因为我不希望在查询字符串更改后重新加载整个控制器，但我仍然使用它并且 url 看起来像这样`film/list?sort=isbn&order=asc&offset=0`：现在，每当查询字符串更改时，我想从我的控制器调用一个函数。所以我尝试在控制器中设置一个*$watch ：*

```
$scope.location = $location;
$scope.$watch( 'location.search()', function( search) {
        $scope.list();
 }); 
```

但这不起作用。如果我设置*$watch*来观察查询字符串的单个参数的变化，那么它就可以工作。但我不想为查询字符串的每个参数设置 $watch。我现在使用的解决方案是这样的：

```
$scope.location = $location;
$scope.$watch( 'location.url()', function( url ) {
    if($location.path() == '/film/list')
        $scope.list();
 }); 
```

因此，我没有查看搜索，而是查看整个 url，然后检查路径是否是我在*routeProvider*中设置的路径以有条件地调用该函数。我不喜欢这个解决方案是我必须明确键入要匹配的 $location.path 的值。

谁能提出一个更好的解决方案，也许可以解释一下为什么*$watch*不适用于*$location.search()*？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-05-16T02:09:07.397

如果您不使用 Angular 的路由解析，或者您只想知道 $location 何时更改，则有一个事件就是为了这个目的

```
$rootScope.$on('$locationChangeSuccess', function(event){
        var url = $location.url(),
            params = $location.search();
}) 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2013-02-26T17:52:21.973

您可以在控制器中侦听`$routeUpdate`事件：

```
$scope.$on('$routeUpdate', function(){
  $scope.sort = $location.search().sort;
  $scope.order = $location.search().order;
  $scope.offset = $location.search().offset;
}); 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2013-02-26T19:26:18.287

Stewies 的答案是正确的，您应该为此收听`$routeUpdate`事件，因为它更有效。

但是要回答为什么您的手表不工作；当您观看时`location.search()`，您正在观看搜索方法返回的引用是否相同。每次你调用它时它都会返回对同一个对象的引用，这就是你的手表不触发的原因。也就是说，即使搜索参数发生变化，返回的对象仍然是同一个对象。为了解决这个问题，您可以将 true 作为第三个参数传递给`$watch`. 这将告诉 Angular 按值进行比较，而不是参考。但是在创建这样的手表时要小心，因为它们会消耗更多的内存，并且需要更长的时间来执行。所以这就是为什么你应该像斯图伊所说的那样去做。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-12-03T14:21:11.457

采用

```
$scope.$watch(function(){ return $location.search() }, function(params){
    console.log(params);
}); 
```

反而。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-10T21:44:14.240

`routeUpdate`在控制器中观察这样的变化：

```
 $scope.$watch('$routeUpdate', function(){
     $scope.sort = $location.search().sort;
     $scope.order = $location.search().order; 
 }); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-22T12:03:31.553

**$watch(watchExpression, listener, [objectEquality]);**

watchExpression => 应该是

1.  评估为表达式的字符串或
2.  以当前作用域为参数调用的函数

所以在这里，您应该将第一个参数作为函数传递。

**JavaScript 示例 =>**

```
$scope.$watch (
                function () { return $scope.$location.search(); };
                function (value) { console.log(value); } 
              ); 
```

**打字稿示例 =>**

```
this.$scope.$watch (
                     () => { return this.$location.search(); },
                     (value: any) => { console.log(value); }
                   ) ; 
```

这确实对我有用。

# jquery - jquery 1.9.1 - Tabs shown but not working and tab content fully shown

> ID：15093922
> 
> 赞同：1
> 
> 时间：2013-02-26T16:13:18.957
> 
> 标签：jquery, tabs

I've set up jquery tabs with the ui. Included js and css is there aswell as jquery is.

But as soon as I load the page the tabs are properly shown but in every content is the full content of each tab content on top of each other.

The code is exactly the same as shown in the jquery-ui documentation but not working.

Here my includes

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
<link rel="stylesheet" type="text/css" href="/includes/scripts/jquery/jqueryuicss/base/jquery-ui.css" /> 
```

The script

```
<script>
$(document).ready(function() {
    $(function() {
        $( "#tabs" ).tabs({ active: 0 });
    });
});
</script> 
```

And the HTML

```
<div id="tabs">
<ul>
<li><a href="#tabs-1"><img src="/images/flaggen/Germany.gif" alt="Deutsch" border="0" /></a></li>
<li><a href="#tabs-2"><img src="/images/flaggen/grossbritanien.gif" alt="Englisch" border="0" /></a></li>
<li><a href="#tabs-3"><img src="/images/flaggen/russland.gif" alt="Russisch" border="0" /></a></li>
</ul>
<div id="tabs-1">
    <p>TEST Deutsch</p>
</div>
<div id="tabs-2">
    <p>TEST Englisch</p>
</div>
<div id="tabs-3">
<p>TEST Russisch</p>
</div>
</div> 
```

Please help, thanks in advance

Bernhard

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-07T21:45:45.153

再会，

我遇到了同样的问题，并通过使用另一个 jquery 版本（1.7.0 而不是 1.9.1）来解决。

尝试用 [http://ajax.googleapis.com/ajax/libs/jquery/1.7.0](http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js)替换 JavaScript src [https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js) [/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js)。

我希望这可以帮助任何发现自己处于同一束缚中的人！祝你有美好的一天！-麦克风

# mongodb - 有效地更新 MongoDB / pymongo 中的记录（可能就地？）

> ID：15093926
> 
> 赞同：0
> 
> 时间：2013-02-26T16:13:29.473
> 
> 标签：mongodb, pymongo, mongodb-update

我正在更新我的收藏中的记录，如下所示：

```
for document in myDB.find():
    if compliesToSomeRule(document):
        myDB.update({'_id':document['_id']}, {'$set':{'something':'somevalue'}}) 
```

这是最有效的方法吗？

我必须将更新的第一个参数设置为`_id`文档的参数，这似乎很奇怪，因为那是重新查询索引吗？

可以这么说，有没有办法“就地”更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:55:58.317

您所做的更新命令的第一部分本质上是您想要的“compliesToSomeRule”方法。例如，假设 compliesToSomeRule 定义如下：

```
def compliesToSomeResult(doc):
    if doc['a'] == 0:
        return True
    else:
        return False 
```

然后你可以跳过这组，然后做

```
myDB.update({ 'a' : 0 }, {'$set' : { 'x' : 'y' }}) 
```

然后，这会将您的更新文档（第二个）应用于集合中字段 a 等于 0 的所有文档。

另一个例子：如果你想找到 'a' > 0 你可以做的所有文件

```
myDB.update({ 'a' : { '$gt' : 0 }}, {'$set' : {'x' : 'y'}}) 
```

更新调用的第一部分，“查询”部分，是您如何指定哪些文档接收更新。第二部分定义了更新的实际内容。

这是一个文档，您在查看此材料时可能会发现它有帮助：http: [//docs.mongodb.org/manual/applications/update/](http://docs.mongodb.org/manual/applications/update/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:08:05.960

我想你想看看“$where”关键字。 [http://docs.mongodb.org/manual/reference/operator/where/](http://docs.mongodb.org/manual/reference/operator/where/) 它允许您基于javascript函数进行查询，因此一切都发生在数据库上。不过这可能会慢一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:17:07.457

您正在就地更新。update 的第一个参数是 find 子句，这就是它识别要更新的记录的方式。

编辑

> **MongoDB 是否处理缓存？** 是的。MongoDB 将所有最近使用的数据保存在 RAM 中。如果您为查询创建了索引并且您的工作数据集适合 RAM，则 MongoDB 从内存中提供所有查询。
> 
> MongoDB 不实现查询缓存：MongoDB 直接从索引和/或数据文件提供所有查询。

* * *

另外，你的用户名很棒:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-05-08T20:28:32.137

如果您需要查找特定文档，然后添加一些内容：

```
 flag=db.foo.find({"_id":333})
    try: 
        if flag[0]['_id']:
            db.foo.update({"_id":333},{"$set":{"name":"mongo"}})
    except:
        print "none" 
```

但是如果您需要搜索所有文档并向所有文档添加一些内容：

```
flag=db.foo.find()
for row in flag:
    db.foo.update({"_id":flag['_id']},{"$set":{"name":"mongo"}}) 
```

# modernizr - 是的，不，有条件地加载谷歌网络字体

> ID：15093928
> 
> 赞同：0
> 
> 时间：2013-02-26T16:13:33.903
> 
> 标签：modernizr, google-webfonts, yepnope

我对在 Modernzr 中使用 Yep Nope 完全陌生，并且遇到了一些困难。

我想知道我执行以下操作的语法是什么：

*   使用 yep nope 检查 webfont 支持
*   如果是这样，请将 url 字符串附加到文档的头部以加载远程 css 文件。

类似的东西不起作用 - 还是我在这里吠错了树？

```
yepnope({
  test : Modernizr.fontface
  yep : [
       $('<link href=\'http://fonts.googleapis.com/css?family=Bitter:400,700|Oswald:300,400,700\' rel=\'stylesheet\' type=\'text/css\'>').appendTo($('head'));
  ]
}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-09T19:14:38.680

我希望你已经弄清楚了，但如果你还没有：

您正在尝试将 JS 语句作为数组中的项目运行。这在我所知道的任何 JS 上下文中都不起作用。我尝试的第一步是删除 jQuery 调用，并指定 CSS 的原始 URL，如下所示：

```
yepnope({
    test: Modernizr.fontface,
    yep: [
      'http://fonts.googleapis.com/css?family=Bitter:400,700|Oswald:300,400,700'
    ]
}); 
```

这会加载样式表，但会引发错误，因为 YepNope 认为它是一个 JS 文件。解决此问题的方法是包含 YepNope CSS 前缀插件（您可以在[此处](https://github.com/SlexAxton/yepnope.js/blob/master/prefixes/yepnope.css-prefix.js)的 Github 存储库中找到它）。然后你可以这样做：

```
yepnope({
    test: Modernizr.fontface,
    yep: [
      'css!//fonts.googleapis.com/css?family=Bitter:400,700|Oswald:300,400,700'
    ]
}); 
```

我已经测试过了，效果很好。

您还可以将此方法与 Modernizr.load 一起使用（如果您使用的是 Modernizr 的自定义构建）。您所要做的就是在包含 Modernizr 之后包含任何 YepNope 插件。将适当的调用委托给 YepNope 是足够聪明的。

作为旁注，请注意我从第二个代码块中删除了“http:”。这称为“协议相对 URL”。它允许根据您当前的协议进行加载。这意味着如果您在不安全的域中，它将加载“ **http ://fonts.googleapis...”，如果在安全域中，它将加载“** **https** ://fonts.googleapis...”。

# javascript - 检查 javascript 中的未定义——我应该使用 typeof 还是不使用？

> ID：15093930
> 
> 赞同：12
> 
> 时间：2013-02-26T16:13:41.913
> 
> 标签：javascript, undefined

我对如何最好地检查 javascript 中的变量是否未定义感到有些困惑。我一直在这样做：

```
myVar === undefined; 
```

但是在所有情况下使用 typeof 会更好吗？

```
typeof myVar === undefined; 
```

我也见过`undefined`vs的使用呢？`"undefined"`

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-26T16:15:50.677

这是最好的检查方法——完全万无一失：

```
typeof myVar === "undefined" 
```

这没关系，但如果有人无益地覆盖了全局`undefined`值，它可能会失败：

```
myVar === undefined; 
```

不得不说，ECMAScript 5 指定它`undefined`是只读的，所以上面的内容在任何符合的浏览器中总是安全的。

这永远不会起作用，因为它最终会比较`"undefined" === undefined`（不同类型）：

```
typeof myVar === undefined; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T16:18:59.493

此测试将始终按预期工作：

```
typeof a === 'undefined' 
```

由于 的值`undefined`可以更改，因此像这样的测试并不总是可靠的：

```
a = {}
a.b === undefined 
```

在这些情况下，您可以`void 0`改为测试：

```
a.b === void 0
// true 
```

但是，这不适用于单变量测试：

```
a === void 0 // <-- error: cannot find 'a' 
```

您可以通过测试来解决这个问题`window.a`，但应该首选第一种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-24T08:55:16.860

我相信在最常见的情况下，例如在检查参数是否通过函数传递时，`myVar === undefined`就足够了，因为 myVar 将始终被声明为参数

# mysql - 未知列，即使该列存在

> ID：15093934
> 
> 赞同：1
> 
> 时间：2013-02-26T16:14:08.777
> 
> 标签：mysql, join, left-join

我得到一个错误，`Unknown column 'events.event_id' in 'field list'`即使我的表明显有列，如所附屏幕截图所示：

![在此处输入图像描述](../Images/e66aabeac9fe6515d76891c501dded91.png)

我的 SQL 查询如下：

```
SELECT
   `events`.`event_id`,
   `events`.`realm`,
   `events`.`starts`,
   `events`.`ends`,
   `general_data`.`id`,
   `general_data`.`nick`
FROM `events`
JEFT JOIN
   `general_data` ON `events`.`owner`=`general_data`.`id`
WHERE
   `instance`=1 AND
   `zone`=1 AND
   (`realm`='foo' OR `crossrealm`=1)
ORDER BY
   `events`.`starts`,`events`.`realm` ASC
LIMIT 0,50 
```

任何人都可以提供一些可能导致此问题的见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:20:36.307

> 杰夫特加入

是你打错了还是？我猜它应该是 LEFT JOIN

# php - mssql_query 不起作用：传递的错误消息是“警告：mssql_query(): 7 is not a valid MS SQL-Link resource”

> ID：15093935
> 
> 赞同：0
> 
> 时间：2013-02-26T16:14:09.837
> 
> 标签：php, sql-server, transactions, commit

从 PHP 过程查询 SQL Server 数据库时遇到问题。我的代码是：

```
$commit = FALSE;
            $rs = mssql_query("BEGIN TRANSACTION");
            if($rs) {
                // funzione salvataggio in PrenotazioniFerservizi_Variazioni            
                InsertDisdetta($id_albergo, $POA, $Treno, $Ora_treno, $elenco_giorni_Ok, $subject, $data_email);
                $commit = TRUE;
            }else{
                $msg = "Errore nella BEGIN TRAN<br>Riga ".__LINE__."<br>".mssql_get_last_message();
                InviaMailErrore("Errore nella query", $msg);
                // chiudo la connessione al dbd se ancora aperta
                @mssql_close($con);
                die();
            }
            if($commit) {
                $rs = mssql_query("COMMIT TRAN");               
                if (!$rs){
                    $msg = "Errore nella COMMIT TRANSACTION<br>Riga ".__LINE__."<br>".mssql_get_last_message();
                    InviaMailErrore("Errore nella query", $msg);
                    // chiudo la connessione al dbd se ancora aperta
                    @mssql_close($con);
                    die();
                }
            } 
```

它返回我以下错误消息：

“警告：mssql_query(): 7 is not a valid MS SQL-Link resource”，它似乎与指令特别相关：

你有线索吗？请非常重要。提前很多。D.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:24:24.547

@user2111997 你确定你已经连接到数据库，我在你的代码中没有看到连接代码，并且错误还表明链接无效（因此可能未连接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T17:14:40.513

也许不是最好的选择，但我解决了关闭连接的错误（mssql_close），所以一切仍然有效。以前我工作一次不工作，测试和删除连接的关闭是我可以运行我的连接。更多研究更多...

# css - 为什么列表样式后仍显示项目符号：无；

> ID：15093939
> 
> 赞同：4
> 
> 时间：2013-02-26T16:14:21.577
> 
> 标签：css

我不想为此页面上列出的视频显示项目符号：`http://63.246.25.145/surety-bonds/contract-bonds/performance_bond.htm`

但是，即使在修改 master.css 文件以确保 my`list-style`设置为`none`.

```
#page_bonds #videos {
    padding-top: 20px;
    border-top: 1px dotted #b3b3b3;
    list-style: none;  /*added for video show/hide*/
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-03T16:50:30.983

好问题; 即使使用 list-style:none; 项目符号在 IE 中的显示方式也很奇怪。

这是删除项目符号的代码：

```
/* media query only applies style to IE10 and IE11 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
    /* removes bullets in list items for IE11*/ 
    /* You may need the next line: #page_bonds #videos li */
    li {
        list-style-position: outside;
        overflow: hidden;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:20:23.547

您的`<li>`元素从这里继承：

```
ul {
    list-style: disc outside none;
} 
```

您需要添加

`#page_bonds #videos li { list-style: none; }`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T16:23:07.790

您发布的 CSS 是指`div`包含感兴趣的标签`ul`，而不是其`ul`本身。这使得它很容易被其他地方的 CSS 覆盖，这些 CSS 设置了所有`ul`标签的样式并赋予它们`list-style-type:disc`.

**该怎么办：**

你可以给`ul`你想要影响它自己的`id`目标，或者你可以重新指定你发布的 CSS 块来引用`#page_bonds #videos ul`.

**工作的一般原则：**

您发布的代码使用 by specific 引用特定元素`id`，但没有专门引用您要更改的元素。因为在你的 CSS 的其他地方有一个明确的声明，它给出了所有`ul`元素`list-style-type:disc`。现在至少有两个不同的说明供`ul`您关心。

CSS 的工作原则是尊重最具体地涉及到感兴趣的项目的指令。也许有点不直观，在这种情况下，CSS 会选择一个看起来更通用`ul`的 ( ) 而不是看起来更具体的 ( `#page_bonds #videos`)。但实际上`ul`更具体基于特定类型元素的指令应该胜过其包含样式的逻辑`div`。

请记住：*仅仅因为您* `id` *在 CSS 中引用了 an，并不意味着您实际上是在尽可能具体地声明该语句。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-26T16:23:21.193

使用级联样式表，元素的继承顺序不仅仅是包含顺序的简单问题 - 请参阅 -[级联顺序和继承](http://monc.se/kitchen/38/cascading-order-and-inheritance-in-css)中的详细说明。

`master.css`在您的情况下，您的列表从第 639 行继承值：

```
ul {
    list-style: disc outside none;
    margin-left: 20px;
} 
```

要么删除此引用，要么使用`!important`或添加更专业的 css 标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T16:19:33.047

CSS 元素将它们的值传递给子元素。要覆盖它，请使用 !important。

尝试：

```
list-style: none !important; 
```

在此处了解 !important [。](http://webdesign.about.com/od/css/f/blcssfaqimportn.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-26T16:24:19.067

在您页面的源代码中，我可以看到您的列表样式被此样式表覆盖（63.246.25.145/styles/master.1361894679.css）

您可以通过更改样式以更准确地指定有问题的列表来克服这个问题

```
#videos ul li { list-style: none !important; } 
```

或者您可以编辑链接到页面的 CSS 并更改级联规则以允许视频没有列表样式。

[1]：

# wix - WiX 在构建服务器上失败

> ID：15093942
> 
> 赞同：6
> 
> 时间：2013-02-26T16:14:35.817
> 
> 标签：wix

我有一个使用 WiX 的项目。它在我的本地机器上运行良好，但是当我发布到构建服务器时，构建会出现以下问题。

从 MSBuild 日志

```
Using "HeatDirectory" task from assembly "C:\Program Files (x86)\WiX Toolset v3.6\bin\\WixTasks.dll".
Task "HeatDirectory"
  Command:
  C:\Program Files (x86)\WiX Toolset v3.6\bin\Heat.exe dir "C:\Builds\3\Project\Foo Bar - CI\Sources\Company.Foobar.UI\obj\BuildServer\Package\PackageTmp\\" -cg Company.Foobar.UI_Project -dr INSTALLLOCATION -scom -sreg -srd -var var.WebServiceProjectDir -ag -sfrag -out web\Company.Foobar.UI.wxs
  Could not load file or assembly 'file:///C:\Program Files (x86)\WiX Toolset v3.6\bin\Heat.exe' or one of its dependencies. An attempt was made to load a program with an incorrect format.
     at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
     at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
     at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
     at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark& stackMark)
     at System.Reflection.Assembly.LoadFrom(String assemblyFile)
     at Microsoft.Tools.WindowsInstallerXml.Build.Tasks.WixToolTask.ExecuteToolThread(Object parameters) 
```

我在构建服务器上安装了 Wix 3.6，并且运行 tfs build 的帐户列在域管理员组中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T08:43:15.970

实际上，问题完全与架构不匹配有关。其中一个项目仅在 x86 中编译，因此必须更改构建服务器以使用 x86。

编辑构建、处理、MSBuildPlatform X86

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T18:26:38.553

尝试将您的命令用双引号引起来

```
"C:\Program Files (x86)\WiX Toolset v3.6\bin\Heat.exe" 
```

MS build 中包含空格的路径可能会出现问题。

# iis - 在 Visual Studio 2012 中为 IIS 替换 IIS Express

> ID：15093943
> 
> 赞同：1
> 
> 时间：2013-02-26T16:14:36.177
> 
> 标签：iis, visual-studio-2012, iis-7.5, iis-express

IIS Express 在启用 SSL 或使用本地 IP 等配置方面给我带来了太多问题

我的 Visual Studio2012 项目只允许我使用 IIS Express 而不是常规的 IIS，所以我的 ISS 经理没有与我的项目同步，我很难设置所有内容。

我尝试在 IIS 中手动配置网站，但项目 Bin 文件夹不是我部署到服务所需的目标。

如何将 Visual Studio 2012 设置为使用常规 IIS 而不是 Express 运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-11T17:01:19.263

你有什么操作系统？

在项目属性的网页部分中，您可以取消选中 iisexpress 并使用真正的 iis（如果您的操作系统有）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:17:34.190

您可以在 IIS 中在与 IIS Express 端口不同的端口上设置站点，然后在调试时手动将调试器附加到 w3wp.exe。

# android - 如果合适，如何以编程方式应用纵向/横向配置更改？

> ID：15093944
> 
> 赞同：0
> 
> 时间：2013-02-26T16:14:41.330
> 
> 标签：android, android-layout

我有一个带有 2 个片段的 FragmentActivity，比如片段 A 和片段 B。

片段 A 具有横向和纵向的资源文件，B 没有。A 和 B 都包含加载成本高的数据。所以（我认为）我不希望 FragmentActivity 基于方向在 configChange 上销毁和重新生成自身。

为了不重新加载数据，在我添加的清单中
`android:configChanges="orientation|screenSize"`

但是现在当我旋转我的设备时，我没有应用片段 A 的景观资源。

我怎样才能最好地做到这一点？

或者......最好不要添加`android:configChanges="orientation|screenSize"`到清单中，而是覆盖`onRetainNonConfigurationInstance`和`getLastNonConfigurationInstance`？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:19:49.087

使用 Loader 加载数据并删除`configChanges`attr。加载器的实例将支持旋转，您可以廉价地将数据重新绑定到新布局中。

# android - 错误：未找到与给定名称匹配的资源（在“文本”处，值为“@string/Add Idea”）

> ID：15093945
> 
> 赞同：0
> 
> 时间：2013-02-26T16:14:44.610
> 
> 标签：android, eclipse

我整天在谷歌上搜索这个错误，并用 SO 中提供的各种答案修复了所有 XML，但问题仍然存在。

我正在Mac机器上开发eclipse，代码如下

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="35dp"
        android:layout_marginTop="16dp"
        android:text="@string/Add Idea"
     />
</RelativeLayout> 
```

**字符串.XML**

```
<resources>   
    <string name="app_name">Idea Tracker</string>
    <string name="hello_world">Hello world!</string>
    <string name="menu_settings">Settings</string>
    <string name="button1">Add Idea</string>
</resources> 
```

虽然我在 Strings.xml 文件中添加了所需的代码，但无法弄清楚问题为何仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:16:19.397

`android:text`应该是，`@string/button1`因为它是标识符。

```
 <Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="35dp"
    android:layout_marginTop="16dp"
    android:text="@string/button1"
 /> 
```

# javascript - 如何确定与 jQuery 的支持功能一起使用的选项？

> ID：15093946
> 
> 赞同：1
> 
> 时间：2013-02-26T16:14:44.470
> 
> 标签：javascript, jquery

我正在使用以下 javascript 代码（为了将日历选择器放在 SSRS 页面中），但我意识到它甚至不起作用，因为它已被弃用且不受支持。`.browser.webkit`他们说不应该使用该功能..

```
$(document).ready(
    function () { 
        if ($.browser.webkit) { 
            $($(":hidden[id*='DatePickers']").val().split(","))
                .each(function (i, item) {
                var h = $("table[id*='ParametersGrid'] span")
                    .filter(function (i) {
                        var v = "[" + $(this).text() + 
                                "]"; 
                        return (v != null && v.indexOf(item) >= 0); })
                            .parent("td").next("td").find("input").datepicker(
                                { 
                                    showOn: "button", 
                                    buttonImage: '/Reserved.ReportViewerWebControl.axd?OpType=Resource&Name=Microsoft.Reporting.WebForms.calendar.gif', 
                                    buttonImageOnly: true, 
                                    dateFormat: 'dd/mm/yy', 
                                    changeMonth: true, 
                                    changeYear: true 
                                    }); }); } }); 
```

所以在[这里](http://api.jquery.com/jQuery.support/)他们说要使用 jQuery.support，我不知道该怎么做。我会这样说：

```
$.browser.support(ajax) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T16:17:27.357

您链接到的页面上记录的属性都是布尔值，因此您可以打开它们：

```
if ($.support.ajax) {
    // ajax is supported
} else {
    // ajax is not supported
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:19:54.627

只需阅读您提到的页面:)

```
if (jQuery.support.ajax) { // your code} 
```

# c# - 打开文件时导致我的服务器崩溃的原因是什么？

> ID：15093948
> 
> 赞同：0
> 
> 时间：2013-02-26T16:14:48.803
> 
> 标签：c#, iis, azure

我有一个用于某个项目的简单架构，它有点像这样：

1.  用户使用 ASP.NET MVC 请求文件
2.  为所述文件检查本地缓存，如果缓存中不存在该文件，则从 Azure Blob 存储中提取该文件。
3.  至此，该文件肯定在我的服务器上，并且我知道路径。
4.  我使用第三方库打开文件，我为它提供路径，然后它返回一个类结构，我用它来为用户创建一个视图。

这在 99% 的时间里都有效。文件要么在缓存中找到，要么下载，然后使用第三方代码打开，然后以漂亮的视图呈现给用户。

但是，我可以复制一组奇怪的情况，这会导致我的生产服务器彻底崩溃。

它们是：

*   在缓存中找不到文件
*   文件从 Azure 下载
*   打开文件时第三方（不安全）库崩溃
*   带上服务器。

我知道我在使用不安全的库时遇到了一些麻烦，但最奇怪的是，如果我第二次尝试，该文件现在将在缓存中，因为第一次正确使用了 Azure，Azure 没有被命中，该文件将成功打开。

第三方库本质上认为从 Azure 下载的文件已损坏，但是当完全相同的代码尝试在没有 Azure 参与的情况下打开完全相同的文件时，它打开没有问题。

所以我最初责怪 Azure，也许我没有正确关闭文件。我已经检查过了，我用来获取文件的文件流肯定是关闭的（它被包装在 using 语句中）。

代码如下，（forceRefresh 是一个我可以设置为始终跳过本地缓存的标志）。路径设置为我服务器上的某个位置 ~/tmp

```
if (!File.Exists(path) || forceRefresh)
{
   CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();
   CloudBlobContainer blobContainer = blobClient.GetContainerReference("mycontainer");

   ICloudBlob blob = blobContainer.GetBlockBlobReference("myblob");
   using (var filestream = new FileStream(path,FileMode.Create,FileAccess.ReadWrite,FileShare.Read))
   {
        blob.DownloadToStream(filestream);
   }

} 
```

更奇怪的是，我重复了我的测试，这一次，在崩溃之后，我从缓存中删除了文件，这样 Azure 就会再次被击中。它是，文件打开而不会导致崩溃。

所以它似乎只在第一次打开从 Azure 下载的文件时发生——我可以通过回收应用程序池来按需导致错误。

有人对我如何调试这个有任何建议吗？我无法在我的本地开发机器上复制。

**编辑：理查德·特纳对反馈的回答**

我不相信 Blob 检索代码是导致异常的原因。这样做的原因是，如果 Web 应用程序确实崩溃，这是在文件下载之后。我什至可以验证文件没有损坏，因为我可以在后续重试时打开它。

关于“不安全”，您所说的完全正确-我有执行 PInvoke 的包装器代码-但是，它没有实现 IDisposable，这是我将立即研究的内容。至于性能，目前我并不担心。

关于重组我的代码，我描述的“缓存”实际上是磁盘上的一组文件，所以本质上我已经有了你推荐的结构。第 3 方库仅接受文件路径作为输入，因此我必须遵循该路线。

回答您的最后问题：

1.  将 blob 作为流读取是我可以看到的唯一可以读取它的方法吗？我没有看到任何 API 方法可以将其作为 byte[] 或其他任何东西。

2.  FileStream 不需要读/写，但改变它并没有改善。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:35:20.340

您应该对此类事情使用异常处理：

```
 try
        {
            //connection here
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
            // will give you the error if no connection and you can get an idea why it crashes
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T22:14:17.467

> 很难确定出了什么问题，因为您没有发布足够的代码，例如，了解您如何实例化/销毁您的 3rd 方组件的实例以及您如何将数据传递给所述组件。

但是，这里有几点需要考虑：

默契是正确的：您的应用程序正在崩溃，因为它抛出了未处理的异常。假设任何与存储服务交互的操作都会失败。如果他们还没有，他们会。因此，实现一个异常处理程序来包装您的 blob 检索代码并在必要时实现重试语义。您可能想要添加[ELMAH](http://code.google.com/p/elmah/)日志记录，以便在您的应用代码中记录崩溃和故障。

我不太明白您所说的 3rd 方库“不安全”是什么意思。您的意思是“不安全”，因为它是您必须 PInvoke 进入的本机库？

根据您的代码如何实例化/销毁第 3 方组件，您可能会发现该组件在使用后仍保留在内存中，并且它可能会保持一些被损坏/混淆的状态。如果您必须使用这样的组件，请考虑编写您自己的 PInvoke 包装器，该包装器也支持 IDisposable 并在您完成后强制卸载组件。但是请注意，这可能会导致性能下降。

要考虑的另一件事：也许您应该稍微重新组织您的代码，以便第 3 方组件只从磁盘加载文件。

1.  如果文件不在磁盘上，则从 Azure 加载它（使用必要的异常处理程序进行包装操作）并将其存储在磁盘上
2.  从磁盘加载文件内容并传递给第 3 方组件

此外，您的代码中还有一些其他内容需要查看：

1.  您是否有任何理由将 blob 作为流而不是 byte[] 或字符串来读取？
2.  您创建读/写文件流有什么原因吗？如果您不写入流，请考虑以只读模式打开流。

> 更新 2013-02-28 @ 16:47 PST - 回复以上 KingCronus 的更新：

CloudBlobContainer.GetBlockBlobReference(...) 返回一个 CloudBlockBlob 对象。CloudBlockBlob 对象具有[DownloadByteArray()](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storageclient.cloudblob.downloadbytearray.aspx)、[DownloadText()](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storageclient.cloudblob.downloadtext.aspx)以及重要的是**[DownloadToFile()](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storageclient.cloudblob.downloadtofile.aspx)**的方法。后一个 API 可能有助于完全缓解文件损坏问题！

您正在 PInvoking 的本机组件完全有可能正在破坏 IIS 控制之外的正在运行的进程。

如果它崩溃是因为其输入数据（即文件）已损坏，那么请考虑确定您是否可以预处理数据以使其符合组件的要求。

如果组件继续崩溃，尤其是因为其内部状态被破坏，您可能需要考虑通过例如创建托管组件实例的 Windows 服务来将组件与 IIS 隔离。这样的服务如果失败可以自动重启。您可以通过 WCF/NamedPipes/etc 与托管您的组件的服务进行通信。并来回整理数据。但是，我认为如果可能的话，我宁愿考虑完全替换该组件，而不是引入这样的最后手段机制！

# php - 在 Codeigniter 中调用 1 个视图，但在所有视图中共享页眉/页脚？

> ID：15093949
> 
> 赞同：0
> 
> 时间：2013-02-26T16:14:50.073
> 
> 标签：php, codeigniter, codeigniter-2, templating

喜欢 Codeigniter，但我发现我不得不为每个控制器调用页眉、页脚和主视图，这很烦人。

在所有视图之间共享页眉/页脚并最小化代码复制的最佳方式是什么。我不想使用模板引擎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:23:19.760

创建一个视图，让我们用这段代码调用它 template.php

```
<?php 
$this->load->view('header');
$this->load->view($view);
$this->load->view('footer');
?> 
```

在您的控制器上执行此操作

```
//the name of the view file you want to show, in my case I want to open the login_page.php view that's inside the folder user
$data['view'] = 'user/login_page';
//load the data variable so I can use it across the views
$this->load->vars($data);
//load the template.php view that will load header, user/login_page and footer
$this->load->view('template'); 
```

# python - 如何将 csv.Sniffer 用于 2 种不同的 CSV 类型？

> ID：15093952
> 
> 赞同：8
> 
> 时间：2013-02-26T16:14:57.840
> 
> 标签：python, csv, delimiter, sniffer

我想读取 2 种不同类型的 CSV 文件：

*   一个带`','`分隔符 的
*   一个带`';'`分隔符的

我试图通过以下方式检查我正在使用的分隔符：

```
dialect = csv.Sniffer().sniff(csvfile, [',', ';'])  
data = csv.reader(csvfile, dialect) 
```

但后来我得到了`TypeError : expected string or buffer`.

如果我这样做，它会起作用，但是我不知道什么时候使用什么分隔符。

```
data = csv.reader(csvfile, delimiter = ",")  
data = csv.reader(csvfile, delimiter = ";") 
```

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-26T16:19:54.733

Sniffer 需要一个[示例字符串](http://docs.python.org/library/csv.html#csv.Sniffer)，而不是文件。您需要做的就是：

```
dialect = csv.Sniffer().sniff(csvfile.readline(), [',',';'])
csvfile.seek(0)  
data = csv.reader(csvfile, dialect) 
```

查找很重要，因为您正在使用 readline 命令移动文件中的当前位置，并且您需要重置回文件的开头。否则你会丢失数据。

# matlab - 两组 3D 点之间的欧几里得距离

> ID：15093953
> 
> 赞同：3
> 
> 时间：2013-02-26T16:14:58.090
> 
> 标签：matlab, nearest-neighbor, euclidean-distance

如何找到两组 3D 点的最近点（数量不同，set1 包括 400 个点，set2 包括 2000 个点），然后找到 set1 与问题第一部分结果之间的欧几里得距离？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:45:47.327

您可以使用[`pdist2`](http://www.mathworks.com/help/stats/pdist2.html)计算**所有**距离，然后选择最小距离。

```
allDist = squareform( pdist2( set1, set2 ) );
[minDist nni] = min( allDist, [], 2 ); 
```

现在`minDist`保存每个点`set1`到其最近邻居 ( `set2(nni)`) 的最小距离。

**编辑：**
对于低维点（本例中为 3），查看 k-NN 算法应该更有效，正如[我在其他答案](https://stackoverflow.com/a/15094400/1714410)中提出的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:35:21.870

您是否考虑过使用[`k-Nearest Neighbors (kNN)`](http://www.mathworks.com/help/stats/knnsearch.html)搜索？

# css - 为什么背景图像和 50% 的绝对位置表现不同？

> ID：15093957
> 
> 赞同：0
> 
> 时间：2013-02-26T16:15:10.290
> 
> 标签：css

图像背景位置向左 50% 使背景图像居中，但在绝对定位元素中左 50% 不使 div 元素居中，为什么？

这是代码：

```
<div style="position:relative;height:100px; background:url(images/demo.jpg) no-repeat 50% 0">
   <div style="min-height:40px; width:140px; background-color:#aaa;position:absolute;top:0;left:50%;">
        heloo this is just a demo
  </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T16:17:25.907

属性中声明的相对定位`background-position`考虑了被定位图像的尺寸，而当使用 CSS 位置属性 ( `top,right,bottom,left`) 时，只考虑相对父级的尺寸。

考虑它的一个好方法是使用最小值和最大值：

1.  使用 0% 时，效果相同：
    *   背景定位图像紧贴包含元素的左边缘
    *   绝对定位元素拥抱相对父元素的左边缘
2.  100%，效果明显不同：
    *   背景定位图像紧贴包含元素的右边缘
    *   绝对定位元素的左边缘与相对父元素的右边缘对齐

为了解决您的问题，您可以将元素宽度的一半的负边距添加到第二个 div：

```
margin-left: -70px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:18:32.437

孩子的左侧`div`将与父母`div`的一半交叉`left: 50%;`。集中儿童`div`使用`left: 50%;`和`margin-left: -(half the width of child div)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:26:22.663

为了简单起见，我建议简单地删除`position:absolute;top:0;left:50%;`和使用`margin: 0 auto;`。

# javascript - 在 file_field 的情况下填写字段名称

> ID：15093960
> 
> 赞同：0
> 
> 时间：2013-02-26T16:15:29.370
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3

我有一个nested_form，上面有这个表格：

```
 <%= f.fields_for :uploads do |file| %>
      <%= file.label 'File name :'%>
      <%= file.text_field :name, :size => "19", :id=>"field" %>    
      <%= file.file_field :file if file.object.new_record? %> 
      <p>
      <%= file.link_to_remove "Delete" %>
  <% end %>

  <%= f.link_to_add "Add", :uploads, :class=>"btn" %> 
```

我想在用户选择一个文件（只是名称和扩展名）时填充 text_field“名称”，但我不知道如何使用 javascript 来做到这一点，因为我可以有很多 file_fields 而不仅仅是一个。

你能帮我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:34:07.143

如果你想用 JS 来做到这一点，我想出的方法基本上是在你的输入上设置一个 data 属性，其中包含你想要填充的值。

当您的视图呈现时，它将在您想要的输入中嵌入数据属性，然后在文档准备好后，您可以使用 jQuery 选择具有该特定数据属性的所有输入并设置它们的值。

在您看来：

```
<%= f.fields_for :uploads do |file| %>
    <%= file.label 'File name :'%>
    <%= file.text_field :name, :size => "19", :id=>"field", :data => { "for-auto-fill" => "some value" } %>    
    <%= file.file_field :file if file.object.new_record? %> 
    <p>
    <%= file.link_to_remove "Delete" %>
<% end %>

<%= f.link_to_add "Add", :uploads, :class=>"btn" %> 
```

在您的 javascript 中：

```
/* Select all elements with a 'for-auto-fill' data attribute */
$('[for-auto-fill]').each(function(){
  /* For each one, set it's value to the value that you set on the data attribute */
  $(this).val(($(this).data().forAutoFill));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:18:36.577

试试这样：

```
 <%= f.fields_for :uploads do |file| %>
    <%= file.label 'File name :'%>
    <%= text_field_tag :name, nil, :size => 19 %>    
    <%= file.file_field :file if file.object.new_record? %> 
    <%= file.link_to_remove "Delete" %>
  <% end %>

  <%= f.link_to_add "Add", :uploads, :class=>"btn" %> 
```

# android - 通过 Android 中的 Share Intent 接收特定内容

> ID：15093967
> 
> 赞同：0
> 
> 时间：2013-02-26T16:15:45.750
> 
> 标签：android, text, android-intent, share, mime-types

作为我正在尝试做的一个例子：当我将一篇文章从 Pocket 分享到 Evernote 时，Pocket 会格式化文本并将整篇文章发送到 Evernote，而当我与我的应用程序分享一篇文章时，我只会收到 URL。我知道在 Pocket 端正在执行代码，因为在共享之前有一个“处理”对话框。

我的问题：Pocket 是否知道它正在与 Evernote 共享并专门为 Evernote 格式化其输出，或者 Evernote 是否以某种方式注册为文本编辑应用程序并因此提示 Pocket 共享整篇文章而不仅仅是一个 URL？

如果是后者，它是如何完成的？我应该注册我的应用程序以接收除 以外的 mime 类型`text/plain`吗？这是我目前用来接收文本的部分代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    rcvIntent = getIntent();
    String rcvAction = rcvIntent.getAction();
    String rcvType = rcvIntent.getType();
    if (Intent.ACTION_SEND.equals(rcvAction) && "text/plain".equals(rcvType))
        displaySentText(rcvIntent);
}
private void displaySentText (Intent rcvIntent) {
    String sharedText = rcvIntent.getStringExtra(Intent.EXTRA_TEXT);
    if (sharedText == null) return;
    if (sharedText.startsWith("http://")) {
        ConnectivityManager connMgr = (ConnectivityManager) getSystemService (Context.CONNECTIVITY_SERVICE);
        NetworkInfo networkInfo = connMgr.getActiveNetworkInfo();
        if (networkInfo != null && networkInfo.isConnected()) {
            new DownloadWebpageText().execute(sharedText); 
```

提前致谢！

编辑：

调试器没有提供太多信息。当我分享到 Evernote 时，它​​显示：

```
02-27 16:36:50.005: I/ActivityManager(2257): START u0 {act=android.intent.action.SEND typ=text/plain flg=0x80001 cmp=com.evernote/.note.composer.NewNoteAloneActivity (has clip) (has extras)} from pid 31094 
```

当我分享到我的应用程序时，我会收到一条非常相似的消息：

```
02-27 16:37:39.700: I/ActivityManager(2257): START u0 {act=android.intent.action.SEND typ=text/plain flg=0x80001 cmp=st.olm.readmemberalpha/.WebText (has clip) (has extras)} from pid 31094 
```

它们都是文本/纯文本，但内容不同。我还从`(has clip)`上面检查了剪辑的内容，但内容与额外内容相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:23:20.097

看了袖珍博客后，似乎袖珍实际上确实专门为印象笔记格式化了文章文本。分享`intent`剪辑来自[`ClipData`class](http://developer.android.com/reference/android/content/ClipData.html)，只是额外内容的副本，从 api 11 开始使用。

似乎没有办法——至少通过共享意图，据我所知——强制另一个应用程序提供特定的数据（类型）。

# sql - 按地点统计请假天数

> ID：15093971
> 
> 赞同：0
> 
> 时间：2013-02-26T16:15:54.153
> 
> 标签：sql, oracle, plsql, plsqldeveloper, oracle-apps

该程序是创建一个包计数的。员工根据组织的位置休假的数量。例如：- 如果 XYZ 公司是一家位于许多地点的公司。每个地点都有自己的一套规则……在某些地点，周六工作，而在某些地点，周六和周日都被视为假期。我制作了如下包装，但我认为它可以变得更容易。

```
Create or replace package Body
Leave_location
Procedure Leave_location_proc(Person_id number,
                              Start_date Date
                              )
as 
k Number;
count_weekend number;

Cursor c_var
is 
select pt.person_id,
lt.end_date-lt.start_date Number_of_leaves_excluding_the_end_date,
lt.Start_date      //Start leave date,
lt.Saturday      // 1 if saturday is not working, null if working 
lt.Sunday          ,
loc.location_id
from person_table pt,
leave_table lt
and leave_table.person_id=person_table.person_id
and loc.location_id=pt.person_id \\filtering the location for the particular employee;
Begin

Count_weekend :=0;
       for cursor_var in c_var
       k :=cursor_var.Number_of_leaves_excluding_the_end_date+1
       loop
         for i in..k
         loop
          if(to_char(cursor_var.start_date,'DY') in ('Sat','Sun')
          Then
          if(cursor_var.Saturday is not null and cursor_var.sunday is not null))
          Then
          Count_weekend :=2;
          Else
          count_weekend :=1;
          end if ;
          end if;
       cursor_var.Start_date :=cursor_var.Start_date+1;
No_of_leaves :=K-Count_weekends;
Count_weekends:=Count_weekends+1;
end loop;
end loop;

End Leave_location;
Leave_location_proc; 
```

这段代码似乎效率不高。还有更好的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T18:11:56.030

为此，您不需要 PL/SQL。这就是我的建议 - 这只是可以转换为游标的查询。您可以计算查询中所需的所有内容。然后，如有必要，您可以在光标中使用它：

```
-- calculate values from inner/main query
SELECT all_needed_columns_from_inner_query
    , (Number_of_leaves_excluding_the_end_date - nbr_of_wkends) whatever_count
  FROM
 ( -- your main query --
  SELECT ...
       , lt.end_date-lt.start_date Number_of_leaves_excluding_the_end_date
       , (CASE WHEN lt.Saturday IS NOT NULL AND lt.Sunday IS NOT NULL THEN 2 ELSE 1) nbr_of_wkends
    ...
 WHERE...
 ) 
```

如果您需要更多帮助，请发布示例数据。但是上面的例子应该给你明确的方向和想法——使用 CASE 来计算你需要的所有值。仅在 PL/SQL 中计算那些绝对无法在 SQL 中计算的值...

# java - Objective-c中的点符号

> ID：15093973
> 
> 赞同：1
> 
> 时间：2013-02-26T16:15:55.710
> 
> 标签：java, ios, objective-c, xcode

我有一个要转换为objective-c 的Java 程序。

在 Java 中，我使用点表示法，例如，有以下代码行：

```
this.m_root.computeGlobalTransforms(); 
```

它调用了一个名为 computeGlobalTransforms() 的方法。

我是否能够在objective-c中使用这样的点表示法，或者我需要将行写成并将'm_root'作为对象传递：

```
[self computeGlobalTransforms:m_root]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:23:44.240

if`computeGlobalTransforms`是类`m_root`对象的实例方法，并且 if`m_root`是 的类属性`self`，则语法为：

```
[self.m_root computeGlobalTransforms]. 
```

我建议您参考*学习目标-C：入门*中的[方法和消息传递。](https://developer.apple.com/library/mac/#referencelibrary/GettingStarted/Learning_Objective-C_A_Primer/)

 ** * *

如果`computeGlobalTransforms`是`VA_Bone`方法，则语法为：

```
VA_Bone *bone = [[VA_Bone alloc] init];
[bone computeGlobalTransforms]; 
```

您的`bone`变量是一个简单的局部变量，因此不需要引用`self.m_root`。

* * *

顺便说一句，按照惯例，变量名和类名中间的下划线一般不使用。请参阅*Cocoa 编码指南*中的[命名属性和数据类型。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CodingGuidelines/Articles/NamingIvarsAndTypes.html)*另请参阅Objective-C 编程*[约定](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/Conventions/Conventions.html)中对“camel case”的引用。

 **因此，更常见的命名约定将`VABone`适用于您的类。同样，对于您提到的原始`m_root`财产，您会 (a) 给它一个更具描述性的名称；(b) 使用骆驼案。现在我不知道“m”`m_root`应该代表什么（单独说明问题），但假设它是用于中等大小的图像，那么它可能是`mediumSizedImagesRoot`，或其他什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T16:29:54.450

You *can* use dot notation to call zero parameter methods. You absolutely shouldn't. Dot notation is handled by the compiler, rather than the run time - there's a very good answer to a similar question that talks about why it works, and why you shouldn't use it (...for anything other than setters/getters) here:

[Objective-C dot notation with class methods?](https://stackoverflow.com/questions/2375943/objective-c-2-0-dot-notation-class-methods)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T16:18:17.983

不，您不能，您只能将 Dot.Notation 用于属性的设置器和获取器。***

# pdf - 如果某个标准不正确，则阻止提交 PDF 表单

> ID：15093976
> 
> 赞同：0
> 
> 时间：2013-02-26T16:16:00.407
> 
> 标签：pdf

我有一个需要复选框的 PDF 表单。我将这些复选框设置为必需，但即使未设置，表单仍会提交。似乎其他人也遇到过这个问题。我需要做的是检查复选框的值是否设置为关闭。我能做到的。我遇到的问题是如何防止表单提交。我试过 return false 但语法检查器说 return 不是函数。

```
if(this.getField('spelling').value = 'Off') {

    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:52:57.793

您所做的是使用 submitForm() 函数。

```
if(this.getField('spelling').value != 'Off') {

    var aSubmitFields = new Array( "name", "id", "score" );
    this.submitForm({
        cURL: "http://www.example.com/cgi-bin/myscript.cgi#FDF",
        aFields: aSubmitFields,
        cSubmitAs: "FDF" // the default, not needed here
    });
} 
```

# python - 为什么 print() 在 python 中“切割”浮点变量？

> ID：15093982
> 
> 赞同：0
> 
> 时间：2013-02-26T16:16:16.007
> 
> 标签：python

如果我打印列表中包含的浮点数列表没有问题，但如果我只打印此列表列表中的一个浮点数，它不会打印所有数字！

```
listafeaturevector = [

[0.26912666717306399, 0.012738398606387012, 0.011347858467581035, 0.1896938013442868, 2.444553429782046]
,
[0.36793086934925351, 0.034364344308391102, 0.019054536791551006, 0.0076875387476751395, 3.03091214703604]
,
[0.36793086934925351, 0.034364344308391102, 0.019054536791551006, 0.0076875387476751395, 3.03091214703604]
,
[0.30406240228443038, 0.047100329090555518, 0.0049653458889261448, 0.0004618404341300081, 5.987025009738751]

]

for i in range (0,len(listafeaturevector)):
    a = listafeaturevector[i]
    print(a[0])
    print(",")
    print(a)
    for j in range (0, len(a)  ):
        print(a[j]) 
```

这打印所有数字：

```
print(a) 
```

这会打印部分数字：

```
print(a[0]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:18:57.927

这是因为，`floats`通过调用方法将它们转换为字符串`__str__`。这将截断数字。如果您不想要确切的表示，您应该通过内置调用`__repr__`方法来获取整个浮点表示`repr`

这里的另一个重要因素是浮点数的精度高于 IEEE 64 位可表示格式。所以会有一些截断

例子

```
>>> print 0.26912666717306399
0.269126667173
>>> print repr(0.26912666717306399)
0.269126667173064
>>> print("%.16f" % 0.26912666717306399)
0.2691266671730640
>>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T16:19:36.277

您可以指定小数点后所需的位数：

```
print("%.15f" % a[j]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T16:32:18.373

这样做的原因是，当您`print`调用列表`list`的`__str__`方法时，它又调用`__repr__`每个项目的方法。引用[文档](http://docs.python.org/2/reference/datamodel.html#object.__repr__)

> object.__repr__(self) 由 repr() 内置函数和字符串转换（反引号）调用，以计算对象的“官方”字符串表示。如果可能的话，这应该看起来像一个有效的 Python 表达式，可用于重新创建具有相同值的对象（给定适当的环境）。

所以`__repr__`应该尽量靠近物体。所以：

```
>>> repr(0.012738398606387012)
'0.012738398606387012'
>>> str(0.012738398606387012)
'0.0127383986064' 
```

`list`作为模范公民，他试图让所有的物品看起来都有意义。这就是为什么您的数字不会被截断的原因。

使用这个简单的测试类，我们可以观察到相同的行为：

```
class B():
    def __str__(self): return 'STR CALLED'
    def __repr__(self): return 'REPR CALLED'

>>> print(B())
STR CALLED
>>> print([B()])
[REPR CALLED] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T16:21:57.047

尝试使用字符串格式：

```
print(".%15f" % a[0]) 
```

# php - php/mySQL - 解析错误：语法错误，意外的 T_VARIABLE 错误

> ID：15093991
> 
> 赞同：1
> 
> 时间：2013-02-26T16:16:41.823
> 
> 标签：php

我知道这是一个非常常见的问题，但看在上帝的份上，我在我的 php 代码中找不到错误。我得到的错误是：

```
Parse error: syntax error, unexpected T_VARIABLE in ..\virus_scan.php on line 24 
```

希望一些新鲜的眼睛会带来新的视角并帮助我识别错误。第 24 行是声明 $sql 变量的行：

```
 if ($dbs === False)
    {
        print "can't find $database";
    }

  //--------------------------------------------------------------------------
  // 2) Query database for data
  //--------------------------------------------------------------------------

$sql = "select unix_timestamp(date(Date_Found)) * 1000 as day, count(Virus_Name) as nb from machine_virus_info where Virus_name!='NULL' group by unix_timestamp(date(Date_Found)) * 1000 ;" 
$result = mysql_query($sql) or die('SQL Error 1: ' . mysql_error());

while ($row = mysql_fetch_array($result, MYSQL_ASSOC))
{
    $array[] =
        array (
            $row['day'],
            $row['nb']
            );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T16:18:26.797

在你的 sql 声明之后添加一个分号，即

```
$sql = "..." ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:19:33.663

在. `;`_`$sql`

此外，请确保使用 MySQLi 框架更新您的代码，如您[在此处所见](http://php.net/mysqli)

`mysql_*`从 PHP 5.5.0 开始，使用这些函数会产生`E_DEPRECATED`警告！

# php - jquery post后在多个文件中使用php变量

> ID：15093996
> 
> 赞同：0
> 
> 时间：2013-02-26T16:17:06.343
> 
> 标签：php, javascript, variables

我正在尝试将 php 页面（通过 jquery）加载到网站的主要部分，我尝试加载的 php 页面需要从主页共享一个变量。以下是主页中的代码行：

```
<div id="main" role="main">
<? $path=pathinfo($_SERVER['PHP_SELF']);$path="photo_store/".$path['filename']."/*"; ?>
</div> 
```

在这个主页的头部分调用了一个js文件，它只发布了第二个php文件，js文件中的代码是：

```
$(function() {$.post("images.php",function(data){$('#main').html(data);});}); 
```

第二个 php 文件用于使用以下代码从 photo_store 子目录创建和显示一组图像

```
$files = glob($path); 
```

我研究了`$_GET`，但不完全确定它们是如何运作的，`$_POST`并且`$_SESSION`没有成功。显然，如果我手动将文件夹位置放入，`glob()`那么如果我要丢弃 js 文件并使用它，它将加载完全相同`include''`，但我真的想找到一种方法，这样我就可以在不使用的情况下为所有文件夹使用 1 个图像文件`include''`选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:21:44.580

Tou必须明白，**它是在AJAX加载之前**`images.php`执行的！这意味着，您必须使用 AJAX 将变量发送到网站，或者您必须使用 javascript 处理它。（你不想做第二件事） 发送 ajax POST 参数 - 将出现在： **`$_POST`**

 **```
$.post(   "images.php",
          {path: "<?php echo $path;?>"},
          function(data){$('#main').html(data);}); 
```

所以，在`images.php`你可以访问`$path`这样的：

```
$path = $_POST["path"]; 
```

请记住，用户`$path`可以在 ajax 发送时伪造。他可以发送自己的 POST 请求！**