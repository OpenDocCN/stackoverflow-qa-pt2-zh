# StackOverflow 问答 15648000-15648999

# facebook-graph-api - FQL 不会返回所有新闻提要

> ID：15648005
> 
> 赞同：1
> 
> 时间：2013-03-26T21:47:20.100
> 
> 标签：facebook-graph-api, facebook-fql, facebook-ios-sdk

我正在使用 FQL 检索我的所有新闻提要（根据文档，最近 50 天或 30 天）。但是，在过去的 30 天里，我只得到了一些提要，而不是所有的提要。有没有人有同样的问题？这是我用来检索 FEEDS 的 FQL：

```
SELECT created_time, updated_time, message, attachment, likes, share_count FROM stream WHERE filter_key in "
   @"( SELECT filter_key FROM stream_filter WHERE uid = me() ) AND created_time <= now() 
```

另外，我读到 Graph API 返回的结果比 FQL 多。我阅读了一些 Graph API 示例，但不明白如果我只想列出发布在我的新闻提要上的照片，我的查询应该是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T03:01:09.020

我将从简单的开始：

要仅返回照片帖子，请添加`AND type = 247`到`WHERE`查询部分。这是 Graph API 无法做到的。

对于您遇到的其他问题，该`stream`表是最难查询并获得所需结果的表之一。

由于没有获得足够的结果，Facebook 内部限制不像我所宣传的那样起作用。如果您明确地请求一些帖子，通过添加`LIMIT 100`到查询的末尾，您通常可以接近您期望的实际项目数。

Facebook 过滤算法会在查询执行*后*处理您的结果，因此您最终获得的帖子可能比您在 Facebook 网络应用程序中的新闻源上看到的要少得多。这与您的朋友可能启用的隐私设置有关。不，没有任何方法可以测试这些。

有关更多详细信息，请参阅[此 Facebook 开发者博客文章](https://developers.facebook.com/blog/post/478/)。

# ruby-on-rails - 在 Capistrano 中重新索引太阳黑子 Solr

> ID：15648012
> 
> 赞同：4
> 
> 时间：2013-03-26T21:47:41.277
> 
> 标签：ruby-on-rails, capistrano, sunspot, sunspot-solr, rvm-capistrano

我正在关注这个在 Capistrano [https://gist.github.com/doitian/1795439](https://gist.github.com/doitian/1795439)中添加 Sunspot Solr 的片段，它可以工作，但是当我运行 cap solr:reindex 时，它会显示一个问题（如预期的那样），询问我是否想要删除所有索引，所以我回答“是”，但终端似乎正在等待响应。

这是重新索引的代码：

```
 desc "reindex the whole database"
  task :reindex, :roles => :app do
    stop
    run "rm -rf #{shared_path}/solr/data"
    start
    run "cd #{current_path} && #{rake} RAILS_ENV=#{rails_env} sunspot:solr:reindex" 
  end 
```

这是消息：

```
 * executing "cd /home/user/rapps/app/current && bundle exec rake RAILS_ENV=production sunspot:solr:reindex"
    servers: ["9.9.9.9"]
    [9.9.9.9] executing command
 ** [out :: 9.9.9.9] *Note: the reindex task will remove your current indexes and start from scratch.
 ** [out :: 9.9.9.9] If you have a large dataset, reindexing can take a very long time, possibly weeks.
 ** [out :: 9.9.9.9] This is not encouraged if you have anywhere near or over 1 million rows.
 ** [out :: 9.9.9.9] Are you sure you want to drop your indexes and completely reindex? (y/n)
y 
```

如何避免该消息？另外，我想用 Cron 运行这个 rake，那么我之前怎么能给出答案或设置默认配置？什么是重新索引的最佳/有效方法？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-06T14:53:08.877

我最近遇到了这个问题，发现这是一个有用的解决方法：

```
yes | bundle exec rake sunspot:reindex 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T00:44:09.393

拉[取请求](https://github.com/sunspot/sunspot/pull/370)现已在 sunspot gem 上合并。您应该可以`rake sunspot:reindex[,,true]`用来触发静音重新索引。

再次[模因拯救地球](https://github.com/sunspot/sunspot/pull/370#issuecomment-16323471)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T19:34:24.373

在查看了 sunspot_rails 源之后，目前没有办法**强行**绕过这条消息。请参阅[此处定义的 rake 任务代码](https://github.com/sunspot/sunspot/blob/master/sunspot_rails/lib/sunspot/rails/tasks.rb)

已经提交了一个拉取请求（一个月前）[（Pull request here）](https://github.com/sunspot/sunspot/pull/370)，要求 rake 任务支持*静默*选项，但尚未合并。

我会：

1.  分叉位于此处的 sunspot gem [Repo](https://github.com/sunspot/sunspot)并自己对 rake 任务进行更改（然后更改环境 Gemfile 以使用分叉的 gem）。
2.  向 Capistrano 任务添加一个睡眠命令（大约 10 秒，比此命令出现应该花费的时间更长），然后为标准输入提供“y”

# objective-c - 有什么方法可以查看谁在触发更改：关键值观察？

> ID：15648024
> 
> 赞同：0
> 
> 时间：2013-03-26T21:48:26.447
> 
> 标签：objective-c, cocoa-touch, debugging, key-value, key-value-observing

每当某些属性发生更改时，我都会使用键值观察来执行特定操作（例如，每当其框架或边界发生更改时，重新布局自定义 UIView 的子视图）。有什么方法可以查看是谁（即什么功能）触发了这种变化？在 my 中设置断点`observeValueForKeyPath:ofObject:change:context:`并没有帮助，因为我认为我看不到是谁导致了更改`frame`或`bounds`导致 KVO 被触发。

在我的具体示例中，我无法弄清楚谁/什么在改变我的 UIView 的尺寸。

编辑＃1：我的堆栈跟踪的屏幕截图，在调用帧/边界时暂停`observeValue...`

另请注意，这仅用于调试目的。

![堆栈跟踪](../Images/807dcaabe5df8103da6ac09158cb0dd4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T12:45:59.700

一般来说，不，除了查看堆栈跟踪之外，您不知道是什么导致了特定的 KVC 突变（以及因此 KVO 通知）。在这种情况下，`-[UIView(Geometry) _applyAutoresizingMaskWithOldSuperviewSize]`似乎是罪魁祸首，但更一般地说，它似乎是取消归档和布局触发通知的视图的过程。由于此更改并非来自*您的*代码，因此我不确定知道它的来源会有多大帮助。

您可以使用一些技巧将“知识”从您自己的堆栈较高的代码传递到堆栈较低的观察方法。您可以在其中存储一个标志/值，`[[NSThread currentThread] threadDictionary]`然后在您的观察者方法中检查它（记住在更高的堆栈帧返回之前显式删除标志。）也就是说，这样做有点恶心，最重要的是，它不会为您提供有关此类情况的任何信息，其中您的代码不是直接触发更改的内容。

# c# - 如何从 WinRT 中的 Action 获取方法名称

> ID：15648026
> 
> 赞同：0
> 
> 时间：2013-03-26T21:48:40.357
> 
> 标签：c#, reflection, windows-runtime, expression

我正在尝试从 WinRT 中的 Action 获取方法名称，其中 Action.Method 不可用。到目前为止，我有这个：

```
public class Test2
{
    public static Action<int> TestDelegate { get; set; }

    private static string GetMethodName(Expression<Action<int>> e)
    {
        Debug.WriteLine("e.Body.NodeType is {0}", e.Body.NodeType);
        MethodCallExpression mce = e.Body as MethodCallExpression;
        if (mce != null)
        {
            return mce.Method.Name;
        }
        return "ERROR";
    }

    public static void PrintInt(int x)
    {
        Debug.WriteLine("int {0}", x);
    }

    public static void TestGetMethodName()
    {
        TestDelegate = PrintInt;
        Debug.WriteLine("PrintInt method name is {0}", GetMethodName(x => PrintInt(x)));
        Debug.WriteLine("TestDelegate method name is {0}", GetMethodName(x => TestDelegate(x)));
    }
} 
```

当我调用 TestGetMethodName() 我得到这个输出：

```
e.Body.NodeType is Call
PrintInt method name is PrintInt
e.Body.NodeType is Invoke
TestDelegate method name is ERROR 
```

目标是获取分配给 TestDelegate 的方法的名称。“GetMethodName(x => PrintInt(x))” 调用只是为了证明我做的至少部分正确。我怎样才能让它告诉我“TestDelegate 方法名称是 PrintInt”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:44:33.703

答案比我做的要简单得多。它只是 TestDelegate.GetMethodInfo().Name。不需要我的 GetMethodName 函数。我没有“使用 System.Reflection”，所以 Delegate.GetMethodInfo 没有出现在智能感知中，我不知何故在文档中错过了它。感谢 HappyNomad 弥合差距。

工作代码是：

```
public class Test2
{
    public static Action<int> TestDelegate { get; set; }

    public static void PrintInt(int x)
    {
        Debug.WriteLine("int {0}", x);
    }

    public static void TestGetMethodName()
    {
        TestDelegate = PrintInt;
        Debug.WriteLine("TestDelegate method name is {0}", TestDelegate.GetMethodInfo().Name);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:12:42.633

```
private static string GetMethodName( Expression<Action<int>> e )
{
    Debug.WriteLine( "e.Body.NodeType is {0}", e.Body.NodeType );
    MethodCallExpression mce = e.Body as MethodCallExpression;
    if ( mce != null ) {
        return mce.Method.Name;
    }

    InvocationExpression ie = e.Body as InvocationExpression;
    if ( ie != null ) {
        var me = ie.Expression as MemberExpression;
        if ( me != null ) {
            var prop = me.Member as PropertyInfo;
            if ( prop != null ) {
                var v = prop.GetValue( null ) as Delegate;
                return v.Method.Name;
            }
        }
    }
    return "ERROR";
} 
```

# git-merge - 使用 github API 合并两个存储库

> ID：15648029
> 
> 赞同：1
> 
> 时间：2013-03-26T21:48:42.040
> 
> 标签：git-merge, github-api

Octokit 有一个[`Octokit::Client::Commits#merge`](http://www.rubydoc.info/github/pengwynn/octokit/Octokit/Client/Commits#merge-instance_method)合并的方法。

是否可以使用这种方法（或另一种方法）来合并来自另一个存储库的分支？

我试过：

```
client.merge('user1/repo', 'master', 'user2:master') 
```

和

```
client.merge('user1/repo', 'master', 'user2/master') 
```

但它似乎不起作用......</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T15:18:05.650

您只能合并来自存储库中的分支，而不能合并来自另一个存储库的分支，无论另一个是否是 fork。你可能会这样做：

```
repo = client.repository('user2/repo')
system "git clone #{repo['git_url']}"  # this may be wrong, I've never used Octokit
# change into the directory
system "git checkout #{branch}"
system "git push git@github.com:user1/repo #{branch}"
client.merge('user1/repo', 'master', 'alt_branch') 
```

# java - 更改其中的 JMenuBar 和 JMenu 对象的背景和文本颜色

> ID：15648030
> 
> 赞同：4
> 
> 时间：2013-03-26T21:48:44.710
> 
> 标签：java, swing, look-and-feel, jmenu, jmenubar

如何为其中的对象设置自定义背景`JMenuBar`颜色`JMenu`？我试过`.setBackgroundColor`了，它不起作用！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T23:00:27.107

创建一个扩展的新类`JMenuBar`：

```
public class BackgroundMenuBar extends JMenuBar {
    Color bgColor=Color.WHITE;

    public void setColor(Color color) {
        bgColor=color;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D) g;
        g2d.setColor(bgColor);
        g2d.fillRect(0, 0, getWidth() - 1, getHeight() - 1);

    }
} 
```

现在你使用这个类而不是`JMenuBar`设置背景颜色`setColor()`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-26T23:00:38.467

您可能需要更改菜单项的不透明度，即：

```
JMenuItem item= new JMenuItem("Test");
item.setOpaque(true);
item.setBackground(Color.CYAN); 
```

您还可以使用 全局实现这一点`UIManager`，例如：

```
UIManager.put("MenuItem.background", Color.CYAN);
UIManager.put("MenuItem.opaque", true); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-27T00:49:46.677

最简单的方法（我能想到的）是更改`UIManager`. 这将影响应用程序中的所有菜单栏和菜单项...

![在此处输入图像描述](../Images/f011deaddcc25d414f752ed1a7ab33d5.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestMenuBar {

    public static void main(String[] args) {
        new TestMenuBar();
    }

    public TestMenuBar() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                UIManager.put("MenuBar.background", Color.RED);
                UIManager.put("Menu.background", Color.GREEN);
                UIManager.put("MenuItem.background", Color.MAGENTA);

                JMenu mnu = new JMenu("Testing");
                mnu.add("Menu Item 1");
                mnu.add("Menu Item 2");

                JMenuBar mb = new JMenuBar();
                mb.add(mnu);
                mb.add(new JMenu("Other"));

                JFrame frame = new JFrame("Test");
                frame.setJMenuBar(mb);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new JPanel());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-20T06:31:48.207

简单的方法是通过`.setBackground(Color.RED)`and`setOpaque(true)`

`menubar.setBackground(Color.RED); menu.setBackground(Color.yellow); menubar.setOpaque(true); menu.setOpaque(true);`

这将为菜单栏和菜单提供您选择的颜色。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-12T16:47:10.927

我的只有在我改变时才起作用：

```
 UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); 
```

至：

```
 UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName()); 
```

否则，颜色保持不变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-10T08:00:21.347

这很简单。

**这是代码：**

```
menu.setBackground(Color.DARK_GRAY); 
```

同样，您可以添加自己的颜色，例如`GREEN, BLUE, DARK_GRAY, LIGHT_GRAY, BLACK, RED, etc..`

这是在 java 中更改任何组件的任何颜色的唯一简单方法。

**注意：**这仅适用于 Java Swing 中的所有组件。它在 JavaFX、JFace、SWT 中没有用，但在 AWT 和 Swing 中没有用

谢谢，

德里克·史密斯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-27T14:46:50.143

```
public void run() {

     UIManager.put("MenuBar.background", new java.awt.Color(255, 245, 157));
     UIManager.put("MenuBar.opaque", true);                
     UIManager.put("Menu.background", new java.awt.Color(255, 245, 157));
     UIManager.put("Menu.opaque", true);
     UIManager.put("MenuItem.background",new java.awt.Color(255, 245, 157));
     UIManager.put("MenuItem.opaque", true);
     new MenuPrincipal().setVisible(true);

} 
```

菜单栏不会改变颜色，但其余的会改变（菜单和菜单项）

# c - 类似 C 和 Fortran 代码的不同结果

> ID：15648031
> 
> 赞同：2
> 
> 时间：2013-03-26T21:48:47.747
> 
> 标签：c, fortran, numerical-methods

这是来自家庭作业（已过截止日期）的观察结果，我们必须使用欧拉显式方案来研究捕食者 - 猎物模型。我比较了 Fortran 和 C 代码（如下所示），当我比较 Fortran 代码和 C 代码时，我无法解释为什么结果会有所不同。

C代码：

```
#include <stdio.h>

//Functions for Euler Explicit
float FR(float R,float F,float alpha)
{
    return (2*R - alpha*R*F);
}

float FF(float R,float F,float alpha)
{
    return (-F + alpha*R*F);
}

int main()
{
    int N;
    float alpha,initR,initF,bigR,h;

    /* Data Setup */
    alpha   = 0.001;
    initR   = 15;
    initF   = 22;
    N       = 50;
    bigR    = 400;
    h       = 0.01;

    float R0,F0,R1,F1;
    int i;

    R0 = initR;
    F0 = initF;

    for (i = 0; i < N; i++) 
    {
        R1 = R0 + h*FR(R0,F0,alpha);
        F1 = F0 + h*FF(R0,F0,alpha);
        printf("%d\t%f\t%f\n",i,R1,F1);
        R0 = R1;
        F0 = F1;
    }

    return 0;
} 
```

现在是 Fortran 版本，初始化参数和上面的 C 版本完全一样。

```
! EULER EXPLICIT
SUBROUTINE eulers_explicit (initR,initF,N,alpha,h)
    IMPLICIT NONE
    REAL    :: R0,F0,R1,F1,initF,initR,alpha,h
    INTEGER I,N

    R0 = initR
    F0 = initF

    DO I=1,N
            R1 = R0 + h*FR(R0,F0,alpha)
            F1 = F0 + h*FF(R0,F0,alpha)
            PRINT *,I,R1,F1
            R0 = R1
            F0 = F1
    END DO
END SUBROUTINE eulers_explicit
! EULER EXPLICIT

REAL FUNCTION FR(R,F,alpha)
    REAL, INTENT(IN)        :: F,alpha
    REAL, INTENT(INOUT)     :: R

    R = 2*R - alpha*R*F 
FR = R
END FUNCTION FR

REAL FUNCTION FF(R,F,alpha)
    REAL, INTENT(IN)        :: R,alpha
    REAL, INTENT(INOUT)     :: F

    F = -F + alpha*R*F
FF = F
END FUNCTION FF

PROGRAM solve
    USE usual_routines
    IMPLICIT NONE
    INTEGER :: N
    REAL :: alpha,initR,initF,h

    alpha   = 0.001
    initR   = 15
    initF   = 22
    N       = 50
    h       = 0.01

    PRINT *, "Eulers explicit method: "
    CALL eulers_explicit (initR,initF,N,alpha,h)

END PROGRAM solve 
```

现在是结果，来自 C 代码的结果快照：

```
 0    15.296700   21.783300
   1    15.599301   21.568800
   2    15.907923   21.356476
   3    16.222683   21.146309
   4    16.543707   20.938276
   5    16.871117   20.732357
   6    17.205042   20.528532
   7    17.545610   20.326778
   8    17.892956   20.127077
   9    18.247213   19.929407
   10   18.608521   19.733749 
```

Fortran 代码的结果：

```
 0   29.9666996      -21.5607319    
       1   61.1852989       20.4571381    
       2   122.330109      -18.1591854    
       3   249.350449       13.8127756    
       4   500.209259      -7.04162502    
       5   1013.98022      -2.80275159E-02
       6   2048.26880      -2.91000959E-02
       7   4137.56299      -9.10123810E-02
       8   8358.25781     -0.668782473    
       9   16889.3262      -10.6198158    
      10   34297.5977      -353.508148 
```

为什么我会看到这种分歧？我正在使用 gfortran (v4.7.2)，并在我的笔记本电脑上运行它，并且在 Intel i7 上安装 Arch Linux。

编辑：

这是修复。

```
REAL FUNCTION FR(R,F,alpha)
    REAL, VALUE :: F,alpha
    REAL, VALUE :: R

    R = 2*R - alpha*R*F
FR = R
END FUNCTION FR 
```

注意`VALUE`指针解除关联。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T21:56:33.960

FORTRAN 子例程 FF 和 FR 修改它们的参数，而 C 等价程序不会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:58:13.697

在`FF`中，通过`F`引用传递。在`FR`中，通过`R`引用传递。更新`F`并`R`像 fortran 代码一样。

**编辑**：是的，@JimLewis 说了什么。

# c++ - 在 Visual Studio 中运行教程 - 什么样的“新项目”？

> ID：15648035
> 
> 赞同：0
> 
> 时间：2013-03-26T21:49:10.937
> 
> 标签：c++, visual-studio-2010

我想用 Visual Studio 运行本教程中的第一个代码：

[http://wiki.videolan.org/LibVLC_Tutorial_086c](http://wiki.videolan.org/LibVLC_Tutorial_086c)

由于我对 Visual Studio 不是很有经验，我不知道我应该打开什么样的项目（win32 控制台应用程序？）以及我应该有哪些设置来运行代码。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:53:39.883

您可以简单地创建一个空 (C++) 项目，添加一个源文件 ( `main.cpp`)，然后复制该代码。但是，您还需要：

1.  下载它们的头文件和库，并记下保存它们的位置。
2.  右键单击您的项目并选择“属性”。
3.  导航到“C/C++ -> 常规”。
4.  将其头文件的位置添加到“其他包含目录”区域。
5.  导航到“链接器-> 常规”。
6.  将其库（.lib 文件）的位置添加到“附加库目录”区域。
7.  导航到“链接器-> 输入”。
8.  将您需要链接的库的名称添加到“附加依赖项”区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T23:31:21.830

谢谢。这足以让我的 libVLC 代码在 Visual Studio 中与 OpenCV 一起工作。我确实必须使我的代码和解决方案与 32 位兼容，以防其他人可能遇到类似问题。我最终只是从头开始创建了一个新的 32 位解决方案，然后复制了我的 C++ 代码。

# servicestack - Bulk Request Service

> ID：15648040
> 
> 赞同：2
> 
> 时间：2013-03-26T21:49:36.373
> 
> 标签：servicestack

I have created a bulk request service. The purpose of this service is to allow a developer to send multiple requests at once, and then get a response back for each request made. This works great using non-cached requests. POST, PUT, and DELETE work for cached requests as these operations flush the cache. The response for the GET verb returns a ServiceStack.Common.Web.CompressedResult object instead of an object of the appropriate type.

My first question is am I re-inventing the wheel? Is there ServiceStack functionality that does this already that I missed?

If not, here are code excerpts of how I am accomplishing this. Calling the cached service directly (not using the bulk request object) returns the appropriate response. Thank you for any insight into this matter.

```
 public override object OnPost(BulkRequest request)
    {
        var response = new BulkResponse();
        response.Responses = new System.Collections.Generic.List<object>();

        string url = this.Request.AbsoluteUri.Replace(this.Request.PathInfo, string.Empty);

        if (request.Requests == null)
        {
            response.Message.Add("The Requests property cannot be null.");
            response.Status = Contract.StatusType.Error;
            return response;
        }

        if (request.Verb == null)
        {
            response.Message.Add("The Verb property cannot be null.");
            response.Status = Contract.StatusType.Error;
            return response;
        }

        if (request.Verb.Count != request.Requests.Count && request.UseFirstVerbForAllRequests == false)
        {
            response.Message.Add("There must be a matching verb for each request.");
            response.Status = Contract.StatusType.Error;
            return response;
        }

        try
        {
            for (int i = 0; i < request.Requests.Count; i++)
            {
                string verb = request.UseFirstVerbForAllRequests ? request.Verb[0] : request.Verb[i];

                if (String.IsNullOrWhiteSpace(verb))
                {
                    verb = HttpMethods.Get;
                }

                var requestResponse = this.Query(request.Requests[i], verb);
                response.Responses.Add(requestResponse);
            }

            response.Status = Contract.StatusType.Successful;
        } 
        catch (Exception ex) 
        {
            response.Message = new System.Collections.Generic.List<string>();
            response.Message.Add(ex.Message);
        }

        return response;
    } 
```

The Query function determines the type of the request object and makes the appropriate request.

```
 private object Query(Object request, string verb)
    {
        var type = request.GetType();
        object response = null;

        if (type == typeof(Contract.Activity.ActivityRequest))
        {
            var service = this.ResolveService<Service.Services.Activity.ActivityService>();
            response = (verb == HttpMethod.Post.ToString()) ? service.Post((Contract.Activity.ActivityRequest)request) :
                (verb == HttpMethod.Get.ToString()) ? service.Get((Contract.Activity.ActivityRequest)request) :
                (verb == HttpMethod.Put.ToString()) ? service.Put((Contract.Activity.ActivityRequest)request) :
                (verb == HttpMethod.Delete.ToString()) ? service.Delete((Contract.Activity.ActivityRequest)request) : null;
        }
        else if (type == typeof(Contract.Activity.CachedActivityRequest))
        {
            var service = this.ResolveService<Service.Services.Activity.CachedActivityService>();
            response = (verb == HttpMethod.Post.ToString()) ? service.Post((Contract.Activity.CachedActivityRequest)request) :
                (verb == HttpMethod.Get.ToString()) ? service.Get((Contract.Activity.CachedActivityRequest)request) :
                (verb == HttpMethod.Put.ToString()) ? service.Put((Contract.Activity.CachedActivityRequest)request) :
                (verb == HttpMethod.Delete.ToString()) ? service.Delete((Contract.Activity.CachedActivityRequest)request) : null;
        }
        ...
        return response;
    } 
```

# powershell - PowerShell v2.0+ add a computer to a domain global group

> ID：15648041
> 
> 赞同：0
> 
> 时间：2013-03-26T21:49:42.243
> 
> 标签：powershell, active-directory, powershell-2.0

I'm using `PowerShell` version 2.0 and wanted to know how to add a Domain Computer into a Domain Global Group.

Also I would like to know if there is a good site to go to that has `V2` commands and examples.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T14:52:32.473

我知道这有点晚了，但是你可以使用`PowerShell`'s `Active Directory`modulde 来做到这一点`PowerShell 2.0`：

```
Import-Module activedirectory

$globalGroup = "Your_Global_Group"
$computerName = "Your Computer Name"

$computerObj = Get-ADComputer $computerName -properties *
Add-ADGroupMember -Identity $globalGroup -Members $computerObj.DistinguishedName 
```

**注意**：您需要打开`Active Directory`windows 功能才能使用该`activedirectory`模块。这可以在 Windows 功能的“远程服务器管理工​​具”选项卡下找到。

链接：[对于 AD 模块中的 Cmdlet](http://technet.microsoft.com/en-us/library/ee617195.aspx)

# unit-testing - Unit testing ServiceStack REST webservices

> ID：15648042
> 
> 赞同：2
> 
> 时间：2013-03-26T21:49:44.900
> 
> 标签：unit-testing, servicestack

I've tried couple of approaches to unit test the REST service but to no avail.

1.  Followed [this](https://stackoverflow.com/questions/9586427/service-stack-and-mocking-any-tutorials) post, by creating DirectServiceClient but "method is not implemented" exception is raised.

2.  Directly instantiated the web service and called the Any() method, it worked but it hits the DB. I've initialized the connection in the setup as below. But I am not knowing how to Mock connection object and set in-memory customer object.

    _dbConnection = new OrmLiteConnectionFactory(TestConfig.ConnectionString,SqlServerDialect.Provider).OpenDbConnection();

Could anyone provide some inputs on how to write unit tests in this kind of scenario.

Customer Service

```
public class CustomerService : Service
{
   private readonly IDbConnection _dbConnection;

   public CustomerService(IDbConnection dbConnection)
   {
       _dbConnection = dbConnection;
   }

   public object Any(CustomerRequest request)
   {
      if (request.id == null)
      {
          throw new ArgumentException("id is required");
      }

      var customer = _dbConnection.QueryDapper<Customer>("getCustomer",new {@id=request.id}).ToList();

      return customer;
   }
} 
```

Request

```
[Route("/customers")]
[Route("/customer/{id}")]
public class CustomerRequest : IReturn<Customer>
{
    public string id { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:16:00.400

1.  我相信 DirectServiceClient 更多地用于集成测试（即端到端）。

2.  使用模拟工具来存根数据库。毕竟，对于这个单元测试，您只想测试“任何”方法：

> ```
> [Test]
> public void Any_CalledWithoutId_ExpectThrowArgumentException()
> {
>   var db = MockRepository.GenerateStub<IDbConnection>();
>   var request = new CustomerRequest();
>   var service = new CustomerService(db);
> 
>   Assert.Throws<ArgumentException>(() => service.Any(request));
> } 
> ```

大致就是这样。（对不起，格式化.... SOO 格式化程序不正常，所以我阻止引用它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T23:14:22.170

**这是我可以为这种方法编写的唯一测试。**

ozczehco 的回答将测试引发异常的代码路径。如果您想测试通过异常的代码路径，您需要模拟/存根 _dbConnection.QueryDapper 调用。

下面通过添加测试“Any_CalledWithAnId_ReturnsCustomer()”来扩展 ozczecho 答案，并包括所有“仪式”。我确实在您提供的代码中修改了一些内容。我没有为新测试模拟/存根 IDbConnection，而是创建了一个 InMemoryTestDatabase 仅用于测试。**不要将其用于您自己**的数据库，因为它会擦除“客户”表进行测试。

```
[TestFixture]
public class CustomerServiceTest
{
    public IDbConnectionFactory InMemoryTestDatabase;

    [SetUp]
    public void SetUp()
    {
        InMemoryTestDatabase = new OrmLiteConnectionFactory("c:\\testData.db", SqliteDialect.Provider);
    }

    [Test]
    public void Any_CalledWithoutId_ExpectThrowArgumentException()
    {
        var db = MockRepository.GenerateStub<IDbConnection>();
        var request = new CustomerRequest();
        var service = new CustomerService(db);

        Assert.Throws<ArgumentException>(() => service.Any(request));
    }

    [Test]
    public void Any_CalledWithAnId_ReturnsCustomer()
    {
        //Arrange your data
        long requestId;
        using (var con = InMemoryTestDatabase.OpenDbConnection())
        {
            con.CreateTable<Customer>(true); //Force drop to create clean table and data
            con.Insert<Customer>(new Customer { FirstName = "Johnny", LastName = "Test"});
            requestId = con.GetLastInsertId();
        }

        //Act
        var request = new CustomerRequest {id = (int)requestId};
        var service = new CustomerService(InMemoryTestDatabase.OpenDbConnection());
        var result = (Customer)service.Any(request);

        //Assert
        Assert.AreEqual(requestId, result.Id);
        Assert.AreEqual("Johnny", result.FirstName);
    }
}

[Route("/customers")]
[Route("/customer/{id}")]
public class CustomerRequest : IReturn<Customer>
{
    public long id { get; set; }
}

public class Customer
{
    [AutoIncrement]
    public long Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

public class CustomerService : ServiceStack.ServiceInterface.Service
{
    private readonly IDbConnection _dbConnection;

    public CustomerService(IDbConnection dbConnection)
    {
        _dbConnection = dbConnection;
    }

    public object Any(CustomerRequest request)
    {
        if (request.id == null)
        {
            throw new ArgumentException("id is required");
        }

        var customer = _dbConnection.QueryDapper<Customer>("Select * From Customer Where Id = @id", new { id = request.id }).ToList();

        return customer.FirstOrDefault();
    }
} 
```

# java - text from JSpinner to JTextArea

> ID：15648047
> 
> 赞同：0
> 
> 时间：2013-03-26T21:50:17.203
> 
> 标签：java, swing, gettext, jtextarea, jspinner

How can I transfer text from a `JSpinner` to a `JTextArea`? I thought about `.getText();` but it's not working.

```
dobDate = new JSpinner(new SpinnerDateModel(today, null, null,Calendar.MONTH));
dateEdit = new JSpinner.DateEditor(dobDate, "dd/MM/yy");
dobDate.setEditor(dateEdit);
dobDate.setBounds(215,270, 120, 25); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:54:21.677

从[JSpinner](http://docs.oracle.com/javase/6/docs/api/javax/swing/JSpinner.html)你可以使用[`getValue()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JSpinner.html#getValue%28%29). 从[JTextArea](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTextArea.html)您可以使用[`insert()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTextArea.html#insert%28java.lang.String,%20int%29)或[`append()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTextArea.html#append%28java.lang.String%29)

# php - Only getting the last row from a table using POST with PHP

> ID：15648049
> 
> 赞同：0
> 
> 时间：2013-03-26T21:50:25.827
> 
> 标签：php, mysql, html-table, http-post

Ι'm new in PHP and I have a problem in getting data from POST. I have an SQL query which selects from a table 3 columns, which I echo in a table form. Notice that only the 3rd column should be input type. Although the table is displayed fine (all values from mySQL), when I print the 3rd column variable from `$_POST`, only the last value is printed. Here is the code:

```
$result = mysql_query("SELECT `id`, `component`,`percentage` FROM `waste_percentage` ")or die(mysql_error());
$row = mysql_fetch_array($result);

echo "<table border='1' cellspacing='0'>
<tr>
<th>α/α</th>
<th>Ρεύμα</th>
<th>Ποσοστό</th>
</tr>"; 
while($row = mysql_fetch_array($result))
     {
   $num = mysql_numrows($result);
   $i=0;
       while ($i < $num) 
         {
          $field1 = $i +1;
          $field2=mysql_result($result,$i,"component");
          $field3=mysql_result($result,$i,"percentage");
          $i++;
          echo "<form action=\"\" method=\"post\">";
          echo "<tr>";
          echo "<td> $field1 </td>";
          echo "<td> $field2 </td>";
          echo "<td>" . "<input type=\"text\" name=\"percentage\" value=" .  $field3 . " </td>";
          echo "<td>" . "<input type=\"hidden\" name=\"hidden\" value=" . $row['id'] . " </td>";
          echo "</tr>";
         }

     }
 echo "</table>";
 echo "<input name=\"Submitpercent\" type=\"submit\" value=\"Συνέχεια\" />";
 echo "</form>";

  //When I try to output 

  if(isset($_POST['Submitpercent'])) 
  {
   $user_percentage [] = $_POST['percentage'];
   print_r ($user_percentage);
  } 
```

Output is: 'Array ( [0] => 13.60 )'. I would appreciate any help! Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:59:05.413

首先，您在这里跳过第一行：

```
$row = mysql_fetch_array($result);

// ...

while($row = mysql_fetch_array($result)) 
```

删除`$row = ...`您在查询下方的那个。

其次，您在遍历行的同时遍历行，这很奇怪。将循环更改`while`为（并关闭`<inputs>`）：

```
$i=0;

while($row = mysql_fetch_array($result))
{

      $field1 = ++$i;
      $field2 = $row['component'];
      $field3 = $row['percentage'];

      echo "<tr>";
      echo "<td> $field1 </td>";
      echo "<td> $field2 </td>";
      echo "<td>" . "<input type=\"text\" name=\"percentage\" value=\"" .  $field3 . "\"> </td>";
      echo "<td>" . "<input type=\"hidden\" name=\"hidden\" value=\"" . $row['id'] . "\"> </td>";
      echo "</tr>";
     }

 } 
```

最后，`<form>`在打开`<table>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:59:12.517

您需要为表单输入使用特殊的“数组”表示法，以便同一字段可以多次包含在您的页面上；

更改`percentage`为`percentage[]`; 您还缺少代码中输入标签的结束标签

```
echo '<td><input type="text" name="percentage[]" value="' .  $field3 . '" /></td>"; 
```

然后，显示值；

```
if (!empty($_POST['percentage'])) {
    print_r($POST['percentage']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:53:40.197

您忘记正确结束`<input>`标签，如下所示：

```
echo "<td>" . "<input type=\"text\" name=\"percentage\" value=\"" .  $field3 . "\"> </td>";
echo "<td>" . "<input type=\"hidden\" name=\"hidden\" value=\"" . $row['id'] . "\"> </td>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:56:48.493

您的代码有多个缺陷。如前所述，您忘记关闭标签。

你也可以在内部打开一个`<form>`，但是你只关闭一次（在提交按钮之后）。

另一个问题是您有多个具有相同名称的字段：`percentage`，这可以通过替换`name="percentage"`为来解决`name="percentage[]"`。如果您在 PHP 中访问它，您将拥有一个包含百分比的数组，而不仅仅是一个字段

# jakarta-ee - jboss remote lookup throws exception

> ID：15648052
> 
> 赞同：0
> 
> 时间：2013-03-26T21:50:40.570
> 
> 标签：jakarta-ee, exception, jboss

Im running a Jboss 6.1 and I´m trying to do a test from eclipse where I lookup an ejb on my jboss. But it throws an exception. Have anyone seen it before and knows how to solve it?

(I have put all the jars from my jboss-install-path/client/*.jar on the classpath.)

My pom.xml dependencies

```
 <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
    </dependency>
    <dependency>
        <groupId>org.testng</groupId>
        <artifactId>testng</artifactId>
        <version>6.8</version>
    </dependency>
    <dependency>
        <groupId>org.jboss.ejb3</groupId>
        <artifactId>jboss-ejb3-ext-api</artifactId>
        <version>2.0.0</version>
    </dependency>
    <dependency>
        <groupId>org.jboss.remoting3</groupId>
        <artifactId>jboss-remoting</artifactId>
        <version>3.2.15.GA</version>
    </dependency>
    <dependency>
        <groupId>org.jboss.marshalling</groupId>
        <artifactId>jboss-marshalling</artifactId>
        <version>1.3.17.GA</version>
    </dependency>
    <dependency>
        <groupId>org.jboss</groupId>
        <artifactId>jboss-ejb-client</artifactId>
        <version>1.0.16.Final</version>
    </dependency>
    <dependency>
        <groupId>jboss</groupId>
        <artifactId>jbossall-client</artifactId>
        <version>4.2.2.GA</version>
    </dependency>
    <dependency>
        <groupId>org.mockito</groupId>
        <artifactId>mockito-all</artifactId>
        <version>1.9.5</version>
    </dependency>
  </dependencies> 
```

The exception stacktrace

```
java.lang.ClassCastException: org.jboss.aop.joinpoint.MethodInvocation cannot be cast to org.jboss.ejb3.proxy.impl.invocation.StatefulRemoteInvocation
    at org.jboss.ejb3.stateful.StatefulContainer.dynamicInvoke(StatefulContainer.java:507)
    at org.jboss.ejb3.session.InvokableContextClassProxyHack._dynamicInvoke(InvokableContextClassProxyHack.java:53)
    at org.jboss.aop.Dispatcher.invoke(Dispatcher.java:91)
    at org.jboss.aspects.remoting.AOPRemotingInvocationHandler.invoke(AOPRemotingInvocationHandler.java:82)
    at org.jboss.remoting.ServerInvoker.invoke(ServerInvoker.java:967)
    at org.jboss.remoting.transport.socket.ServerThread.completeInvocation(ServerThread.java:791)
    at org.jboss.remoting.transport.socket.ServerThread.processInvocation(ServerThread.java:744)
    at org.jboss.remoting.transport.socket.ServerThread.dorun(ServerThread.java:548)
    at org.jboss.remoting.transport.socket.ServerThread.run(ServerThread.java:234)
    at org.jboss.remoting.MicroRemoteClientInvoker.invoke(MicroRemoteClientInvoker.java:163)
    at org.jboss.remoting.Client.invoke(Client.java:1634)
    at org.jboss.remoting.Client.invoke(Client.java:548)
    at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:62)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.aspects.tx.ClientTxPropagationInterceptor.invoke(ClientTxPropagationInterceptor.java:67)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.security.client.SecurityClientInterceptor.invoke(SecurityClientInterceptor.java:65)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.async.impl.interceptor.AsynchronousClientInterceptor.invoke(AsynchronousClientInterceptor.java:143)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:61)
    at $Proxy10.invoke(Unknown Source)
    at org.jboss.ejb3.proxy.impl.handler.session.SessionProxyInvocationHandlerBase.invoke(SessionProxyInvocationHandlerBase.java:185)
    at $Proxy9.save(Unknown Source)
    at se.questify.services.ServiceTest.CreateQuestionWithResource(ServiceTest.java:56)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:714)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:128)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:767)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1203)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)
    at org.testng.TestNG.run(TestNG.java:1036)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)
    at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.aspects.tx.ClientTxPropagationInterceptor.invoke(ClientTxPropagationInterceptor.java:67)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.security.client.SecurityClientInterceptor.invoke(SecurityClientInterceptor.java:65)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.async.impl.interceptor.AsynchronousClientInterceptor.invoke(AsynchronousClientInterceptor.java:143)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:61)
    at $Proxy10.invoke(Unknown Source)
    at org.jboss.ejb3.proxy.impl.handler.session.SessionProxyInvocationHandlerBase.invoke(SessionProxyInvocationHandlerBase.java:185)
    at $Proxy9.save(Unknown Source)
    at se.questify.services.ServiceTest.CreateQuestionWithResource(ServiceTest.java:56)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:714)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:128)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:767)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1203)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)
    at org.testng.TestNG.run(TestNG.java:1036)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:03:52.450

只是一个疯狂的猜测。您已从 JBOSS_HOME/client 添加到类路径 jar 中，并且您有

```
<dependency>
    <groupId>jboss</groupId>
    <artifactId>jbossall-client</artifactId>
    <version>4.2.2.GA</version>
</dependency> 
```

在你的 pom.xml 中 JBOSS_HOME/client 中的类和 jbossall-client 中的类可能会混淆，因此您会得到 ClassCastException。由于您使用的是 JBoss 6，4.2.2.GA 中的 jbossall-client 类可能无法工作。

# javascript - Javascript atom Feed parse with XPATH

> ID：15648060
> 
> 赞同：1
> 
> 时间：2013-03-26T21:51:09.837
> 
> 标签：javascript, xpath

I want to parse an atom feed using javascript xpath API:

```
<feed xmlns="http://www.w3.org/2005/Atom">
   <category scheme="http://app.link.com/schemes" type="types"/>
   <link rel="app" href="http://app.link.com"/>
  <entry>
   <link rel="appnn" href="http://app.link.internal"/>
  </entry>  
</feed> 
```

I tried to get the link(s) attributes using the javascript xPath API. This is what I have tried:

```
 var urlvar = '/feed/link/@href';
 var feed = xDoc.evaluate(urlvar, xDoc, null,XPathResult.STRING_TYPE, null); 
```

But the result is null for

> feed.stringValue What I am doing wrong?

**Update:**

I tried

```
function feedNSResolver(prefix) {
  return "http://www.w3.org/2005/Atom";
 } 
```

without any luck.

# quickbooks - Get company name that is opened in Quickbooks using QBFC

> ID：15648061
> 
> 赞同：0
> 
> 时间：2013-03-26T21:51:13.433
> 
> 标签：quickbooks, qbfc

I can get the CompanyFilename using QBFC but could not get the appropriate class to get the opened company name in Quickbooks.

Any idea will be highly appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-07T15:34:21.453

我知道这是一个较老的问题。在搜索了与 QBFC 相关的其他答案后，我想我会发布一个答案。它可能会帮助刚入门的人。

[IDN 统一 OSR（屏幕参考）](https://developer-static.intuit.com/qbSDK-current/Common/newOSR/index.html)是此类问题的绝佳资源。使用起来有点麻烦。但是，它将为您提供一些用于在 VB.NET 或 C# 中进行测试的示例代码。你必须知道你想了解什么请求消息。在这种情况下，您正在寻找`CompanyQuery`\ `ICompanyQuery`。生成的示例代码显示了如何构建请求和解析响应。示例代码中命名的函数`BuildCompanyQueryRq`包含一些无效代码，您需要针对解决方案进行更改。

`CompanyQueryRq.IncludeRetElementList.Add("ab");`

将其更改为：

`CompanyQueryRq.IncludeRetElementList.Add("CompanyName");`

这将只请求 CompanyName 属性。如果您想添加更多属性，您可以使用属性名称添加到列表中。如果您完全删除该行，您将检索所有字段。建议只请求您需要的内容。

**注意：**根据我阅读的文档，它区分大小写。

然后，您需要查看该`WalkCompanyQueryRs`函数以了解如何获取返回的值。该示例将从响应中检索尽可能多的数据。您需要将代码修剪回请求的字段。

仅供参考：OSR 能够更改生成参考时使用的 SDK 规范的版本。

# java - Java 错误“线程“主”java.lang.ArrayIndexOutOfBoundsException 中的异常”

> ID：15648066
> 
> 赞同：0
> 
> 时间：2013-03-26T21:51:54.463
> 
> 标签：java

这是我书中的这个简单代码，它在 netbeans 和通过命令提示符运行的编译版本（.class）版本中产生错误消息。

错误信息

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 0
    at intocm.Intocm.main(Intocm.java:17) 
```

将英寸转换为厘米的简单程序。

```
package intocm;

public class Intocm {

    public static void main(String[] args) {
        // TODO code application logic here
        double inches;
        inches = Double.valueOf(args[0]).doubleValue();
        double cm;
        cm = inches * 2.54;
        System.out.println(cm + "Centimeters");
    }
} 
```

导致错误的行是

```
inches = Double.valueOf(args[0]).doubleValue(); 
```

我不知道为什么这个数组“args”会导致这个错误，请帮助我理解这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:53:12.810

您没有传递命令行参数。`args[0]`期待命令行参数。

如果您从命令行运行它，请尝试以下操作：

```
java Intocm 12.0 
```

在日食

```
Run---> Run Configuration--->
                            Arguments Tab--->
                                            give program arguments-->
                                                                  apply---> run 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:53:38.387

如果`args[0]`导致`ArrayIndexOutOfBoundsException`，那么您没有提供任何命令行参数。测试`args.length`；如果是`0`，则处理错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T21:53:19.450

`args`类方法中的参数`main`由命令行参数提供。您没有使用任何命令行参数调用 jar，因此该数组没有零元素。

# javascript - 带有 CSS 或 JS 的手机上的自动折叠/手风琴

> ID：15648067
> 
> 赞同：1
> 
> 时间：2013-03-26T21:51:56.040
> 
> 标签：javascript, css, html, twitter-bootstrap, collapse

我读[了这个答案](https://stackoverflow.com/questions/14154744/twitter-bootstrap-collapse-group-only-on-phone/14176672#14176672)，但导航栏选项似乎不适合我的问题。

我使用 Twitter bootstrap 2.3.1
我的网站中有一个常见问题解答部分。它有太多的问题和答案。

所以我需要这个：
*在手机*中：只显示标题，文本折叠。单击图标后可以看到文本。
*在平板电脑/桌面*：标题和全文将可见。

我有这样的代码片段：

```
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle" data-toggle="collapse" 
                       data-parent="#accordion2" href="#faq">
                Frequently Asked Questions
            </a>
        </div>
        <div id="faq" class="accordion-body collapse">
            <div class="accordion-inner">
                <h4>What is what ?</h4>
            <ul>
                   <li>Question 1: Do this do that
                   <li>Question 2: Do this do that
                   <li>Question 2: Do this do that
            </ul>

            </div>
        </div>
    </div>
</div> 
```

此代码提供折叠的输出。当然可以通过`$(".collapse").collapse()`但我需要一个 CSS 解决方案来折叠。

另一种选择是复制此代码并将其中一个放在里面`<div class="hidden-phone">`而不折叠，另一个放在里面`<div class="visible-phone">`折叠。但这似乎不是一个好的解决方案。

如果您可以推荐另一个 Twitter 引导选项（如果存在），我也会很高兴。

（如果用户可以看到箭头等以了解标题可以折叠/未折叠，那就更好了）

# node.js - Heroku - 打开失败

> ID：15648068
> 
> 赞同：0
> 
> 时间：2013-03-26T21:51:56.573
> 
> 标签：node.js, heroku, express

我是 Heroku 的新手，并且一直按照他们的说明在 Heroku ( [https://devcenter.heroku.com/articles/nodejs](https://devcenter.heroku.com/articles/nodejs) )上开始使用 Node.js。直到我使用`heroku open`. 那时我收到以下错误：

```
Opening my-app-name... Failure in opening http://my-app-name.herokuapp.com/ with  
options {}: Unable to find a browser command. If this is unexpected, Please rerun with 
environment variable LAUNCHY_DEBUG=true or the '-d' commandline option and file a bug at
https://github.com/copiousfreetime/launchy/issues/new 
```

我已将 LAUNCHY_DEBUG 环境变量设置为 true，并已使用命令验证它是否正确设置`heroku config:get LAUNCHY_DEBUG`。但是当我尝试命令时`heroku open`，它仍然给我完全相同的错误。我希望至少能看到细节？根据第二个建议，我还尝试使用 -d 命令行选项运行它，但它指出`Invalid argument: "-d"`.

我有一个可以在我的本地机器上运行的完整应用程序。但是，当我使用`foreman start`heroku 工具带并导航到 localhost:5000 时，它没有连接。它确实声明它正在控制台上运行：

```
21:44:51 web.1  | started with pid 1457
21:44:53 web.1  | Express server listening on port 5000 
```

我假设这两个问题可能是相关的。

我的搜索没有任何关于此错误的结果，所以我不知道如何继续。任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T09:58:48.023

该错误表明它（启动）无法找到并打开您的浏览器；请检查您机器的配置（默认浏览器等）。

您可以手动启动浏览器并转到`http://my-app-name.herokuapp.com/`

# css - 为什么这个 CSS 立方体 3d 菜单在我的苹果中运行良好，但在我的电脑中却出错了？

> ID：15648069
> 
> 赞同：0
> 
> 时间：2013-03-26T21:51:56.820
> 
> 标签：css, menu, 3d

```
[please check my code][1] 
```

我在这里找不到提交代码的方法，这是我第一次，

我尝试上传图片，但需要某种声誉，

这是我的作业，所以请检查链接的代码，看看发生了什么，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:19:04.220

您的代码使用 CSS 属性，例如`transform`，每个浏览器都需要额外的前缀。您可能在 PC 上使用 Chrome，在 Mac 上使用 Firefox；在 Chrome 和 Safari 中，您需要添加`-webkit-`某些属性：

这个工具应该有帮助： http: [//prefixr.com/](http://prefixr.com/)

将您的 CSS 代码粘贴到那里，它将修复所有前缀。

# java - jdbc-pool 的池耗尽错误太多

> ID：15648076
> 
> 赞同：1
> 
> 时间：2013-03-26T21:52:23.057
> 
> 标签：java, jdbc

我有一个`jdbc-pool`在上个月开始用于 MySQL 连接处理的应用程序。在此之前，我一直在使用 Apache 的`commons-dbcp`. 在阅读了一些显示它更快、维护得更好等的分析后，我切换到了 jdbc-pool。但是，我开始注意到我*的*更多用户看到池耗尽错误。

我不知道这是否与从 commons 切换到 jdbc-pool 有关，但它似乎从那个时候开始，我正在考虑构建我们的产品以恢复并将其提供给有 db 错误的人，看看有什么影响它有。

我编写了一个文档，通过调整池连接、增加最大等待等来帮助他们进行故障排除。但是，我开始看到很多人报告池耗尽错误，即使他们的应用程序基本上是空闲的。A`show full processlist`似乎显示 19 个连接处于“睡眠”状态，其中 1 个连接处于活动状态。

我在生产和开发环境中都经常运行该应用程序，并且从未遇到过问题。我更擅长管理我的 mysql 环境，但池系统较弱的竞争对手产品没有这样的问题。

我花了很多时间阅读 jdbc 和 pooling 文档，但是**我做的事情会导致性能下降**吗？

这些是我们使用默认值的数据库连接代码示例。

```
// Called once on application start, connects to the database
public DataSource initDbPool(){
    String dns = "jdbc:mysql://"+config.getString("prism.mysql.hostname")+":"+config.getString("prism.mysql.port")+"/"+config.getString("prism.mysql.database");
    pool = new DataSource();
    pool.setDriverClassName("com.mysql.jdbc.Driver");
    pool.setUrl(dns);
    pool.setUsername( /*username*/ );
    pool.setPassword( /*password*/ );
    pool.setInitialSize( 10 );
    pool.setMaxActive( 20 );
    pool.setMaxIdle( 10 );
    pool.setMaxWait( 30000 );
    pool.setRemoveAbandoned(true);
    pool.setRemoveAbandonedTimeout(60);
    return pool;
}

// Called from various classes that need to run queries
public static Connection dbc(){
    Connection con = null;
    try {
        con = pool.getConnection();
    } catch (SQLException e) {
        System.out.print("Database connection failed. " + e.getMessage());
        e.printStackTrace();
    }
    return con;
} 
```

[实际代码可以在这里看到。](https://github.com/prism/Prism/blob/master/src/main/java/me/botsko/prism/Prism.java#L279)

我也从不喜欢查询。我们一直在运行批量插入查询，但我们已经通过队列系统和批量插入对其进行了优化，因此它非常快并且使用尽可能少的开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:27:25.053

如我所见，您有`close()`但不在一个`finally`街区。这意味着如果发生异常，连接将丢失。我怀疑它`commons-dhcp`处理泄漏连接的方式与`jdbc-pool`.

有默认`removeAbandoned`配置选项，`off`因为它是 Right Thing™。但据我了解，它不提供任何保证，因为它会通过超时关闭它们。如果您在短时间内有很多异常，它可能会耗尽池。因此，更好的方法是始终关闭块中的所有连接`finally`。

# javascript - 替换 span 元素的文本

> ID：15648077
> 
> 赞同：0
> 
> 时间：2013-03-26T21:52:26.543
> 
> 标签：javascript, replace, entity

我想用一个箭头替换方形图标（html 文件中的 span 元素中的文本：■）：►。当菜单项前面的此图标与其页面 ID 匹配时会发生这种情况，因此访问者知道他在此菜单项指示的页面上。

我经历了很多问题，但坚持这一点。

```
var newIcon = "&#9658;"; // arrow icon
for (var j = 0; j < rightMenuIDs.length; j++){
    var thisID = rightMenuIDs[j];
    var thisSpanIcon = rightMenu[j].children[0].children[0].childNodes[0].nodeValue;
    if(thisID === bodyIDsliced){
        thisSpanIcon = newIcon;
    }
} 
```

我检查了 console.log，它说 thisSpanIcon 已更新为箭头图标。但是页面上没有任何变化。我尝试了 replace() 和其他方法无济于事。

如果有更好/正确的方法可以做到这一点，有人可以躺在我身上吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:59:23.997

当你说：

```
thisSpanIcon = newIcon; 
```

您只是覆盖`thisSpanIcon`包含节点现有属性*副本*`nodeValue`的局部变量，而不是更改属性（以及节点）本身。

尝试：

```
var thisSpanNode = rightMenu[j].children[0].children[0].childNodes[0];
if (thisID === bodyIDsliced) {
    thisSpanNode.nodeValue = newIcon;
} 
```

这应该改变节点的实际属性。

另请注意，您应该对字符串使用 Unicode 格式，而不是 HTML 实体，即`\u25ba`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-26T21:58:45.747

您必须使用[`elem.innerHTML`](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)或`elem.innerText`更新元素/节点的文本。（[小例子](http://jsfiddle.net/hSxtS/1/)）

另外，寻找一些现代的选择元素的方法。

# c - “第一次”动态记忆的新手

> ID：15648078
> 
> 赞同：0
> 
> 时间：2013-03-26T21:52:30.180
> 
> 标签：c, dynamic-memory-allocation

为什么错误

```
#include <stdio.h>

int main(void)
{
    int *p, size, i;
    FILE *fp;

    fp = fopen("input.txt","r");
    fscanf(fp, "%d", &size);

    p = (int*)malloc(size*sizeof(int));  //error
    for (i = 0; i <size; i++)
        fscanf(fp, "%d", &p[i]);

    for (i = size-1; i>= 0; i--)
        printf("%d\n", p[i]);

    free(p);
    fclose(fp);
    return 0;
} 
```

我在 ubuntu 上使用“Geany”

在 Geany 编译器上：

fileName.c:11:2：警告函数“malloc”的隐式声明 [-Wimplicit-function-declaration] fileName.c:11:12：警告：内置函数“malloc”的隐式声明不兼容 [默认启用] fileName.c:18:12：警告：函数'free'的隐式声明 [-Wimplicit-function-declaration] fileName.c:18:12：警告：内置函数'free'的隐式声明不兼容 [启用-by default] 编译成功完成

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T21:53:33.423

您缺少以下标头包括：

```
#include <stdlib.h> 
```

`malloc`和的原型在您错过`free`的头文件中定义。`stdlib.h`

如果您不确定某些标准 C 函数要包含哪些头文件，您总是可以使用`man`它来弄清楚。

对于这种情况[`man malloc`](http://linux.die.net/man/3/malloc)，将显示需要包含的头文件。

顺便说一句，在您的代码中，您没有检查`fp`是否`NULL`在`fopen`.

`fopen`如果文件不存在或者您没有打开文件的权限（在您的情况下用于读取），则可以并且将会失败。

```
fp = fopen("input.txt","r");
if (fp == NULL)
{
    printf("Error opening input.txt\n");
    return -1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:56:56.163

这个：

```
warning implicit declaration of function 'xxxxxx' [-Wimplicit-function-declatation] 
```

总是意味着同样的事情。编译器找不到您正在谈论的功能。大多数情况下，这是因为您忘记了正确的头文件。

如果您在终端（或谷歌）中输入`man <function name>`，在这种情况下，`man malloc`您将获得一个页面，告诉您需要哪些头文件。在这种情况下`<stdlib.h>`，包括它，警告就会消失。

# php - 在函数返回中获取单个数组元素

> ID：15648083
> 
> 赞同：0
> 
> 时间：2013-03-26T21:53:05.373
> 
> 标签：php, arrays

如果我有这样的功能：

```
function getTotal() {
 $total = array("gcBalance" => 5, "gcTotal" => 10);
 return $total;
} 
```

有没有一种方法可以调用函数并从`gcBalance`数组中取出值而不必循环？理想情况下，它会像这样工作，但事实并非如此。

```
$balance = getTotal()[0];
echo $balance; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:54:45.300

`echo $balance['gcBalance']`应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:55:13.007

```
$balance = getTotal();
echo $balance["gcBalance"]; 
```

# java - 重新绘制 - 立即绘制和删除

> ID：15648088
> 
> 赞同：1
> 
> 时间：2013-03-26T21:53:17.513
> 
> 标签：java, swing, repaint, runnable

我有一个乒乓球项目（有点），它可以工作，但是 run() 函数有问题。如果我用我写给面板的函数绘制框架（它们工作，我检查过）它会出现图形问题，如果我使用重绘（我想）它会绘制框架并立即删除它，每个解决方案都会有帮助（在我的代码级别上最好是一个简单的）：

```
import java.awt.*;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JPanel;
import java.util.Random;
import javax.swing.*;
import sun.org.mozilla.javascript.internal.Kit;

public class Picture extends JPanel implements MouseListener, Runnable{

    private int k = 0;
    Thread MyThread;
    private DrawPic img;

    private Rectangle r1, r3;

    public Picture(DrawPic img, Rectangle rect1, Rectangle rect3) {
        super();
        this.setLocation(0, 85);
        this.setLayout(new FlowLayout());
        this.setSize(1280, 1024);

        this.addMouseListener(this);
        this.setFocusable(true);

        this.r1 = rect1;

        this.r3 = rect3;
        this.img = img;
        this.MyThread = new Thread(this);
        MyThread.start();
        this.setVisible(true);

    }

    public void paintRectangleL(Rectangle rect, Graphics g) {
        k = 3;

        rect.DrawRectangle(g);
        rect.FillRectangle(g);

    }
    public void paintRectangleR(Rectangle rect, Graphics g) {
        k = 1;

        rect.DrawRectangle(g);
        rect.FillRectangle(g);

    }
    public void paintImage(DrawPic img, Graphics g) {
        k = 2;

        //g.clearRect(0, 0, this.getWidth(), this.getHeight());
        img.DrawImg(g, this);

    }
    public void changeK(int k1){
        k = k1;
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        // throw new UnsupportedOperationException("Not supported yet.");

    }

    @Override
    public void mousePressed(MouseEvent e) {
        //throw new UnsupportedOperationException("Not supported yet.");

            Point p = r3.FindCenter();
            double dx, dy;

            dy = e.getY() - p.getY();
            r3.Move(0, dy);
              this.getGraphics().clearRect(0, 0, this.getWidth(), this.getHeight());
            this.paintRectangleL(r3, this.getGraphics());
            this.paintRectangleR(r1, this.getGraphics());
            this.paintImage(img, this.getGraphics());
    }

    @Override
    public void mouseReleased(MouseEvent e) {
        //throw new UnsupportedOperationException("Not supported yet.");

    }

    @Override
    public void mouseEntered(MouseEvent e) {
        //throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public void mouseExited(MouseEvent e) {
        //   throw new UnsupportedOperationException("Not supported yet.");
    }
    public void animate(){
        double dx = 0, dy = 2;
        if ((this.img.getX() + 160 + this.r1.RightPoint().getX() - this.r1.LeftPoint().getX() > this.getWidth() || this.img.getX() < this.r3.RightPoint().getX() - this.r3.LeftPoint().getX())) {
                    dx = -1 * dx;

                }
                if (this.img.getY() + 120> this.getHeight() || this.img.getY() < 0 ) {
                    dy = -1 * dy;
                }
                img.Move(dx, dy);
             //   this.getGraphics().clearRect(0, 0, this.getWidth(), this.getHeight());
              //  this.paintImage(img, this.getGraphics());
              //  this.paintRectangleL(r3, this.getGraphics());
              //  this.paintRectangleR(r1, this.getGraphics());
                repaint();            
    }

    @Override
    public void run() {

        Color col;
        while (true) {
                 animate();

                try {
                    MyThread.sleep(35);
                } catch (InterruptedException ex) {
                    Logger.getLogger(Picture.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }
        //   throw new UnsupportedOperationException("Not supported yet.");
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T23:16:21.987

您不应该`getGraphics()`用于自定义绘画，因为它是一个临时缓冲区，在下次重新绘画时会被回收。你在画`paintComponent()`。

有关更多信息和示例，请参阅[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)。Section [A Closer Look at the Paint Mechanism](http://docs.oracle.com/javase/tutorial/uiswing/painting/closer.html)有很好的总结`paint()`和`paintComponent()`方法。另请参阅[AWT 和 Swing 中的绘画](http://www.oracle.com/technetwork/java/painting-140037.html)。

***编辑：***

您的程序的逻辑和结构不适合 Swing 的绘制过程。您需要重构您的程序，以便它可以插入该过程并在正确的时间绘制正确的东西。通常，您通过覆盖其`paintComponent()`. 在这种方法中，所有的绘画都发生了。这种方法应该尽可能快，避免在其中放置任何/过多的应用程序逻辑。

一旦状态改变 issue ，您应该维护已绘制对象的某种状态（即坐标、颜色等）`repaint()`。这将安排重绘，最终 Swing 将`paint()`在将调用的组件上执行`paintComponent()`。

在您的情况下，您有一个定期触发的计时器。您可以覆盖您使用`paintComponent`的。`JPanel`您已经有了计算坐标的逻辑。将这些坐标存储在成员变量中。然后，发出`repaint()`. 在`paintComponent`中，根据计算出的坐标绘制图像。

***编辑：***

关于线程的另一个说明。Swing 有一个单线程绘画模型。所有 UI 交互和绘制都在 Swing 的*事件调度线程*(EDT) 上进行。有关 EDT 的更多信息，请查看[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)请注意，该方法`animate()`不在 EDT 上执行。你没有展示什么`img.Move(dx, dy)`，但以这种方式执行可能是不安全的。[invokeLater](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater%28java.lang.Runnable%29)在这里可能有助于确保代码在 EDT 上执行。[但是，在这种特殊情况下，使用Swing 计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)可能更容易，它可以确保在 EDT 上执行操作。

# python - 将用户输入与元组值进行比较

> ID：15648092
> 
> 赞同：0
> 
> 时间：2013-03-26T21:53:21.450
> 
> 标签：python, python-3.x, tuples

在 Python 3 中，我有一个包含各种记录的元组列表，假设它被称为`alpha_data`. 它们的布局如下：[('A', 'Apple', 14.5), ('B', 'Banana', 23.4), etc.]

有没有一种方法可以让用户输入类似于元组的第一个值（例如 A 或 B）的值，并且程序将检查该值是否存在，如果存在则打印回整个嵌套值？例子：

`Input: A`

`Output: A Apple 14.5`

还有一种方法可以修改它，以便用户可以输入多个值并检查并打印它们吗？例如：

`Input: A, B`

`Output:`

```
 A Apple 14.5
    B Banana 23.4 
```

编辑：也许我需要更清楚一点。我有代码可以获取输入并将其转换为多个条目的列表。然后我得到了一条线，它按照我需要的方式打印元组的 3 个值。我所需要的只是将这两个部分连接在一起。

到目前为止，这是我的代码：

```
import shares
portfolio_str=input("Please list portfolio: ")
portfolio_str= portfolio_str.replace(' ','')
portfolio_str= portfolio_str.upper()
portfolio_list= portfolio_str.split(',')
print(portfolio_list)
print()
print('{:<6} {:<20} {:>8}'.format('Code', 'Name', 'Price'))
data=shares.EXCHANGE_DATA
for  (code, name, share_value) in data:
    if code == portfolio_list[]:
            print('{:<6} {:<20} {:>8.2f}'.format(code, name, share_value))
    else:
            print("Failure") 
```

如您所见，我正在使用一个名为 share 的模块，其中包含一个名为 EXCHANGE_DATA 的元组列表，其设置如下：

```
 EXCHANGE_DATA = [('AIA', 'Auckair', 1.50),
             ('AIR', 'Airnz', 5.60),
             ('AMP', 'Amp',3.22), 
             ('ANZ', 'Anzbankgrp', 26.25),
             ('ARG', 'Argosy', 12.22),
             ('CEN', 'Contact', 11.22),
             ('CNU', 'Chorus',3.01),
             ('DIL', 'Diligent', 5.3),
             ('DNZ', 'Dnz Property', 2.33),
             ('EBO', 'Ebos', 1.1), 
```

现在我如何让它检查用户输入中的任何值并打印它们中的任何一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:56:25.637

给定一些输入`"A"`或`"B"`非常简单的获取记录：

```
alpha_data = [('A', 'Apple', 14.5), ('B', 'Banana', 23.4)]

user_input = "A"

[rec for rec in alpha_data if rec[0] == user_input]
Out[4]: [('A', 'Apple', 14.5)] 
```

但是，如果您的目标是允许用户使用 等访问这些条目`"A"`，`"B"`那么 a`dict`似乎是更明智的解决方案：

```
alpha_dict = {"A": ("Apple", 14.5), "B": ("Banana", 23.4)}

user_input = "A"

alpha_dict[user_input]
Out[8]: ('Apple', 14.5) 
```

将这些想法应用于您的实际用例非常简单，在您尝试迭代数据并尝试在`portfolio_list`键中查找匹配项时，但更容易迭代`portfolio_list`并在数据中查找匹配项：

```
EXCHANGE_DATA = [('AIA', 'Auckair', 1.50),
            ('AIR', 'Airnz', 5.60),
            ('AMP', 'Amp',3.22), 
            ('ANZ', 'Anzbankgrp', 26.25),
            ('ARG', 'Argosy', 12.22),
            ('CEN', 'Contact', 11.22),
            ('CNU', 'Chorus',3.01),
            ('DIL', 'Diligent', 5.3),
            ('DNZ', 'Dnz Property', 2.33),
            ('EBO', 'Ebos', 1.1)]

portfolio_str=input("Please list portfolio: ")
portfolio_str= portfolio_str.replace(' ','')
portfolio_str= portfolio_str.upper()
portfolio_list= portfolio_str.split(',') 
```

输入一些用户输入：

```
Please list portfolio: AIA, ARG 
```

打印代码：

```
print('{:<6} {:<20} {:>8}'.format('Code', 'Name', 'Price'))
Code   Name                    Price

for code in portfolio_list:
    # This assumes there will only be one record per code
    rec = [rec for rec in EXCHANGE_DATA if rec[0] == code][0]
    # The *rec part is using a neat python feature called
    # tuple unpacking, google it if you're not familiar with it
    print('{:<6} {:<20} {:>8.2f}'.format(*rec)) 
```

输出：

```
AIA    Auckair                  1.50
ARG    Argosy                  12.22 
```

# ruby-on-rails - 在 Rails 中删除人员记录的最佳方法

> ID：15648095
> 
> 赞同：2
> 
> 时间：2013-03-26T21:53:25.260
> 
> 标签：ruby-on-rails, duplicates, duplicate-data

我正在编写一个带有 Person 模型的 Rails 应用程序，看起来像这样：

```
 create_table "people", :force => true do |t|
    t.string   "first_name"
    t.string   "last_name"
    t.string   "email"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end 
```

我有一个两步过程，如下所示：

1.  用人名填写人事记录。由于昵称等原因，人名可能有未知重复。例如，“tim smith”和“timothy smith”
2.  查询 API 以获取这些人的潜在电子邮件地址匹配项。

完成该处理后，我可以获得如下数据：

记录 1：名字：tim last_name：smith 电子邮件：tim.smith@sampleemail.com

记录 2：名字：蒂莫西姓氏：史密斯电子邮件：tim.smith@sampleemail.com

在rails中模拟那些重复的最好方法是什么？

更新：澄清

在第 2 步之后，我知道如何找出这两条记录是重复的（即同一个人），我的问题是如何在模型中表示？我是否应该添加一个“duplicate_of_person_id”类型字段并将第一条记录的 id 放在第二条记录的该字段中？有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T04:43:31.217

您可以将所有记录链接在一起。想到的第一个方案是保留 id 最低的记录作为获胜者，并让所有受骗者指向它。您也可以做一个 has_and_belongs_to_many，这将涉及一个单独的表，其中每条记录都表明这两个人是相同的。不过，后者随人数呈二次方增长。

或者，只需将第二个中的所有信息复制到第一个中并删除第二个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:34:13.500

不是 100% 确定您要的是什么。如果您只想查找重复项，例如，将它们列在一个数组中，您可以创建如下方法：

```
# This isn't particularly efficient, but it should return an array in which
# each element is a list of duplicated people (assuming we define duplicates
# by doubled email addresses). 
def self.find_duplicates
  array = []
  self.each do |person|
   similar = self.find_by_email
   if similar.count > 1
    array << similar
   end
  end
  return array
end 
```

如果您**不想**允许重复，只需在您的模型中创建一个验证：

```
validates :email, :uniqueness => true 
```

不过，在此之前，请确保所有电子邮件都在同一个案例中。您可以再次在模型中执行以下操作：

```
before_validation :format_emails

def format_emails
  self.email = self.email.downcase
end 
```

# parameters - 调用 free() 方法后的分段错误，但仅具有某些值

> ID：15648101
> 
> 赞同：0
> 
> 时间：2013-03-26T21:53:40.610
> 
> 标签：parameters, malloc, free, behavior

我在 C 语言中有一个简单的小程序，我发布了它的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[]){

char *char_ptr;
int *int_ptr;
int mem_size;

if (argc<2) {
mem_size = 50;
}
else
{
mem_size = atoi(argv[1]);
}

printf("\t[+] allocating %d bytes of memory on the heap for char_ptr\n", mem_size);
char_ptr = (char *) malloc(mem_size);
if(char_ptr == NULL) {
fprintf(stderr, "Error: could not allocate heap memory.\n");
exit(-1);
}
strcpy(char_ptr, "This memory is in the heap segment");
printf("char_ptr (%p) -> '%s'\n", char_ptr, char_ptr);

printf("\t[+] allocating 12 bytes of memory on the heap for int_ptr\n");
int_ptr = (int *)malloc(12);

if(int_ptr == NULL){
fprintf(stderr, "Error: could not allocate heap memory.\n");
exit(-1);
}

*int_ptr = 31337;

printf("int_ptr (%p) --> %d\n", int_ptr, *int_ptr);
printf("\t[-] freeing char_ptr's heap memory...\n");
free(char_ptr);

printf("\t[+] allocating another 17 bytes for char_ptr\n");
char_ptr = (char *) malloc(17);

if(char_ptr == NULL){
fprintf(stderr, "Error: could not allocate heap memory.\n");
exit(-1);
}

strcpy(char_ptr, "New Memory");
printf("char_ptr (%p) --> '%s'\n", char_ptr, char_ptr);
printf("\t[-] freeing int_ptr's heap memory.\n");
free(int_ptr);
printf("\t[-] freeing char_ptr's memory\n");
free(char_ptr);
printf("Program exiting\n");
return 0;
} 
```

当我使用大于或等于 29 的参数运行它时，一切正常..但是如果我放置 28 或更少，则会出现分段错误...我在考虑堆和堆栈之间的地址问题，问题发生在free() int_ptr 调用。谁能帮我？我无法理解这有任何意义...

非常感谢大家 有美好的一天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:05:44.640

您复制到 char_ptr 内存 ( `"This memory is in the heap segment"`) 的第一个字符串长度为 35 个字节，包括终止的 NUL 字节。这将破坏所有小于 35 的参数的堆。

碰巧它适用于您到 29 岁，因为免费可能不依赖于被覆盖的数据。

# php - 用PHP中的第n个字母字符替换字符串字母

> ID：15648106
> 
> 赞同：0
> 
> 时间：2013-03-26T21:53:56.140
> 
> 标签：php, string, replace

如何用字母表中的 +n 对应对象替换字符串中的字母？

例如，将每个字符替换为其 +4 对应对象，如下所示：

```
a b c d e f g h i j k l m n o p q r s t u v w x y z
↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓
e f g h i j k l m n o p q r s t u v w x y z a b c d 
```

所以，如果我有字符串`johnny`，它应该变成`nslrrc`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:01:01.847

```
<?php
$str="abcdefghijklmnopqrstuvwxyz";
$length=strlen($str);
$ret = "";
$n=5;
$n=$n-1;
    for($i = 0, $l = strlen($str); $i < $l; ++$i) 
    {
        $c = ord($str[$i]);
        if (97 <= $c && $c < 123) {
            $ret.= chr(($c + $n + 7) % 26 + 97);
        } else if(65 <= $c && $c < 91) {
            $ret.= chr(($c + $n + 13) % 26 + 65);
        } else {
            $ret.= $str[$i];
        }
    }
    echo $ret;
?> 
```

[演示 1（例如：abcdefghijklmnopqrstuvwxyz）](http://ideone.com/rUEc65)

[演示 2（例如：johhny）](http://ideone.com/RXOk4R)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:05:08.343

这是一种方式：

```
<?php

$newStr = "";
$str = "johnny";

define('DIFF', 4);
for($i=0; $i<strlen($str); $i++) {        
    $newStr .= chr((ord($str[$i])-97+DIFF)%26+97);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:08:11.200

您可以使用以下命令进行逐字符替换[`strtr()`](http://php.net/strtr)：

```
$shiftBy = 4;
$alphabet = 'abcdefghijklmnopqrstuvwxyz';

$newAlpha = substr($alphabet, $shiftBy) . substr($alphabet, 0, $shiftBy);

echo strtr("johnny", $alphabet, $newAlpha);

// nslrrc 
```

当然，这假设所有小写字母都与您的示例一样。资本使事情复杂化。

[http://codepad.viper-7.com/qNLli2](http://codepad.viper-7.com/qNLli2)

*奖励：也适用于负转变*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-26T22:04:24.403

做一个字母数组。对于数组[$key] 值中的每个字母，回显数组[$key+4]。如果 $key+4 大于数组的大小，做一些基本的计算并转发它开始。

# php - 更改我的 sql 查询的小时间隔

> ID：15648108
> 
> 赞同：1
> 
> 时间：2013-03-26T21:54:12.893
> 
> 标签：php, mysql

所以我页面上的日期格式显示提前 6 小时的时间。我该如何更改它以显示正确的时间这是我的查询

```
 $query = "SELECT firstName,lastName, post,date_format(postDate,'%M,%d,%Y at %H:%i') as     mydatefield
      FROM users INNER JOIN posts ON userId = empl_Id
      ORDER BY postDate"; 
```

这会将值插入表中

```
 $query = "INSERT INTO posts(postId,empl_Id,post,postDate)
        VALUES('','$empId','$idea',NOW())";
    $result = mysqli_query($db, $query); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:57:58.117

大概您正在以 UTC 存储时间，并且您比 UTC 晚 6 小时。

不要更改您的查询。时区表示是应用程序的视图逻辑的关注点，而不是控制器的关注点。

每次在页面中显示日期/时间时，只需将 TZ 偏移量添加到 UTC 值即可。您可以在此处查看示例：[http ://www.php.net/manual/en/book.datetime.php](http://www.php.net/manual/en/book.datetime.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:13:06.570

如[本问题](https://stackoverflow.com/a/5018349/1567993)所述，您可以按照[此处](http://www.ultramegatech.com/2009/04/working-with-time-zones-in-php/)所述进行操作。

或者您可以选择，如[下面的答案所示](https://stackoverflow.com/a/5018339/1567993)，这样做：

您可以使用 DateTime::setTimezone()。如果您的 UTC 日期是 UNIX 时间戳，则可以使用如下代码：

```
$date = new DateTime();
$date->setTimezone(new DateTimeZone('UTC'));
$date->setTimestamp(1297869844); // this should be the 'current' then 
$date->setTimezone(new DateTimeZone('Europe/Paris'));

echo $date->format('Y-m-d H:i:s');
// Will print 2011-02-16 16:24:04 
```

然后使用它将值插入到您的数据库中。更改表示（毕竟它是 unix 时间戳，您甚至可能想要存储它，它只是被翻译成人类形式作为一种说话方式）

# c# - Windows phone 8 Silverlight 工具包前缀不可用

> ID：15648112
> 
> 赞同：0
> 
> 时间：2013-03-26T21:54:28.470
> 
> 标签：c#, windows-phone-8, silverlight-5.0

我有一个网站，使用 JSON 作为 DB 类型向所有设备（iOS、Android、Windows Phone）发送数据或问题。WindowsPhone 工具包和 Silverlight 工具包随 nuget 一起安装。

问题是图表前缀没有定义！

我想使用的代码示例：

```
<charting:Chart>
  <charting:PieSeries Title="Test items" ItemsSource="{Binding Items}" DependentValuePath="ItemValue" IndependentValuePath="Title" />
</charting:Chart> 
```

我确实搜索了一个解决方案，我什至去了 VisualStudio 中的工具箱和混合图表工具不存在，即使在 2010 年的 Youtube 教程中有一个按钮，所以我不知道 Silverlight 是没有正确安装还是在新的2011 或 2012 版本它们被排除在外，因为 Silverlight 是唯一免费的，其余的是付费的，我想使用这种方法。

你能向我解释一下这个问题以及如何解决它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T07:16:02.230

通常，您需要在 XAML 文件的“顶部”标记中添加命名空间语句：

```
xmlns:charting="clr-namespace:System.Windows.Controls.DataVisualization.Charting;
                assembly=System.Windows.Controls.DataVisualization.Toolkit" 
```

根据[此博客，当从](http://www.jeffblankenburg.com/2010/10/31/31-days-of-windows-phone-day-31-charting-data/)[CodePlex](http://silverlight.codeplex.com/)下载*Silverlight Toolkit*时，这种方法已成功应用于 Windows Phone 7 应用程序。

**但是**，我几乎 100% 确定这*不适*用于 Windows Phone 8，因为我不相信*Silverlight Toolkit*与 WP8 兼容。

特别是，如果您的 VS 2012 解决方案仅包含 WP8 项目，NuGet 将阻止您安装*Silverlight Toolkit*，因为它无法识别与该工具包兼容的任何项目（仅支持 Silverlight 4 及更高版本）。

在我的脑海中，这里有一些包含图表控件的商业 Windows Phone 工具包：

*   [泰勒里克](http://www.telerik.com/products/windows-phone.aspx)
*   [基础设施](http://www.infragistics.com/products/windows-phone/)

# javascript - 从 asp.net 错误中获取 Json

> ID：15648115
> 
> 赞同：0
> 
> 时间：2013-03-26T21:54:34.877
> 
> 标签：javascript, asp.net, json, webforms

`<script>... data: [
<%=ser%>, 1 , 1 , 1 , 1 , 1 , 1] ... </script>`

代码背后

```
List<int> list = new List<int>();
ser = serializer.Serialize(list); 
```

变量 ser 不像手动输入的数字 1 那样工作，为什么？

输出

```
ser = "[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49]"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:24:07.110

最后一次尝试

```
[<%=ser%>] 
```

内部代码

```
ser = ser.Substring(1, ser.Length - 2); 
```

感谢帮助！

# c++ - 用换行位移动一个字符？C++

> ID：15648116
> 
> 赞同：6
> 
> 时间：2013-03-26T21:54:36.387
> 
> 标签：c++, bit-manipulation, bit, bit-shift

我有一个将作为字符读入的二进制文件。每个字符都被其他人向左移动了未知次数（假设使用换行）。我希望能够读取每个字符，然后将 shift 向右换行（我猜要移动的次数必须手动计算，因为我还没有想出另一种方法）。

所以，我目前的想法是我读入一个字符，用 temp 创建一个副本，然后使用 XOR：

```
char letter;    //will hold the read in letter
char temp;      //will hold a copy of the letter
while(file.read(&letter, sizeof(letter)) //letter now holds 00001101
{
    temp = letter;  //temp now holds 00001101
    letter >>= 1;   //shift 1 position to the right, letter now holds 00000110
    temp <<= 7;     //shift to the left by (8-1), which is 7, temp now holds 10000000
    letter ^= temp; //use XOR to get the wrap, letter now holds 10000110
    cout << letter;
} 
```

这在我疲惫的头脑中是有道理的，但它不起作用......我不知道为什么。char 的大小是 1 个字节，所以我想我只需要处理 8 位。

任何帮助，将不胜感激。

**编辑：解决。非常感谢大家。爱死这个社区，你们太棒了！**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-26T21:57:11.197

注意字符的符号。在许多系统上，它是签名的。所以你`letter >>= 1`的标志是填补班次。

旋转整数通常如下进行

```
letter = ((unsigned char)letter >> 1) | (letter << 7); 
```

正如马克在评论中指出的那样，您可以使用 OR`|`或 XOR `^`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:02:20.667

该语句`temp <<= 7`正在丢失您要包装的位。您将需要一次循环左移一位。首先检查最重要的字符位，如果设置，在进行移位之前将其移动到最右边的位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:13:27.807

我倾向于使用更大的整数类型：

```
unsigned val = (unsigned)letter & 0xFF;
val |= val << 8; 
```

现在您只需将值移入`val`，而无需任何额外的代码将高位包装回。

# excel - 将多个工作簿合并为一个工作簿，所有工作簿为工作表

> ID：15648118
> 
> 赞同：2
> 
> 时间：2013-03-26T21:54:46.067
> 
> 标签：excel, excel-2010, vba

我有 65 个工作簿，每个工作簿中有一个工作表。我需要将所有 65 个工作簿合并到一个工作簿中，并将所有相应的工作簿作为新工作簿中的 65 个工作表。我需要将所有 65 个工作簿名称保留为新 SINGLE 工作簿中的工作表名称。

到目前为止，我有一个代码可以做到这一点，我在网上找到了这个代码，但是这个代码要求所有将要合并的工作簿都需要打开。有没有办法修改此代码，以便不需要打开所有工作簿？我可以仅引用（文件夹）驱动器上的位置吗？

谢谢你的帮助！

这是代码：

```
Option Explicit
Public u_sheets As String

Sub Consolidate()

Dim ws As Worksheet
Dim wb As Workbook, NewBook As Workbook
Dim scount As Integer
Dim NewWS As Worksheet
Dim wsSheet As Worksheet
Dim i As Integer
Dim NextName As String
Dim sl As Integer
Dim newfilepath As String
    newfilepath = ""
Dim first_only As Boolean
    first_only = False

Call init

'are we doing the first sheet only?
If u_sheets = "First Sheet Only" Then first_only = True    

'Setup
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Application.DisplayAlerts = False

'Create new workbook for merged sheets 
 newfilepath = ThisWorkbook.Path & "\Merged" 'excel will auto append the appropriate extension (xlsx)
Set NewBook = Workbooks.Add
NewBook.SaveAs Filename:=newfilepath

i = 1

'Loop through each open workbook
For Each wb In Workbooks

    If wb.Name <> ThisWorkbook.Name And wb.Name <> NewBook.Name And Left(wb.Name, 8) <> "PERSONAL" Then

    Dim x As String

    'Get name of this workbook
    x = JustText(Left(wb.Name, Len(wb.Name) - 4))

        'count sheets in this workbook
        If first_only Then
            scount = 1
        Else
            scount = wb.Sheets.Count
        End If          
        'Loop through each sheet in Workbook
        For Each ws In wb.Worksheets
            'do some naming conventions
            Dim xy As String
            Dim y As String
            y = JustText(ws.Name) 'strip out all characters from name
            If scount > 1 Then                
              xy = x + y                  
            Else                  
              xy = x                  
            End If

            'check the length of the new name and shorten if needed
            sl = Len(xy)

            If sl > 30 Then                
                xy = Right(x, sl - (sl - 30))                
            End If

            'copy worksheet to new workbook
            ws.Copy After:=NewBook.Worksheets(NewBook.Worksheets.Count)

            'rename worksheet
            NewBook.Worksheets(NewBook.Worksheets.Count).Name = xy
            If scount = 1 Then Exit For 'break out of loop if we are only doing one sheet

        Next    
    End If    
Next

'remove all original worksheets
'NewBook.Worksheets("Sheet1").Delete
'NewBook.Worksheets("Sheet2").Delete
'NewBook.Worksheets("Sheet3").Delete    

ErrorExit: 'Cleanup
    Application.DisplayAlerts = True    'turn system alerts back on
    Application.EnableEvents = True     'turn other macros back on
    Application.ScreenUpdating = True   'refreshes the screen

End Sub

Private Function JustText(text_to_clean As String, Optional upper As Boolean = False)
    'removes all characters except for letters and numbers
    'where
    'text_to_clean is the text to clean
    'upper boolean will return UPPER case if true; false if omitted

    'declare and initialize user variables

    Dim method As Integer
        'choices:
        '1=remove everything except what is in the leave_these variable
        '2=leave everything except what is specifically removed from the "leave" section
        method = 1

    Dim leave_these As String   'only used if method=1
        leave_these = "A-Za-z0-9" 'if you want to allow a space "A-Za-z0-9 "

    'declare and initialize system variables
    Dim temp As String
        temp = text_to_clean

    'method
    Select Case method
        Case 1  'remove everything except what is in the leave_these variable
            Dim x As String, y As String, z As String, i As Long
            x = temp
                For i = 1 To Len(x)
                    y = Mid(x, i, 1)
                    If y Like "[" & leave_these & "]" Then z = z & y
                Next i
            temp = z

        Case 2  'leave everything except characters below
            'feel free to comment out the lines for items you do not wish to remove, or add new lines as desired
            temp = Replace(temp, ",", "")   'remove commas
            temp = Replace(temp, " ", "")   'remove spaces
            temp = Replace(temp, "-", "")   'remove dashes
            temp = Replace(temp, ":", "")   'remove colon
            temp = Replace(temp, ";", "")   'remove semi-colon               
    End Select    

    If upper Then JustText = UCase(temp) Else JustText = temp       
End Function

Public Function WorksheetExists(ByVal WorksheetName As String) As Boolean

On Error Resume Next
WorksheetExists = (Sheets(WorksheetName).Name <> "")
On Error GoTo 0    
End Function

Private Sub init()
    'initialize all public variables
    u_sheets = Range("u_sheets")    
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T04:32:05.773

此代码（以前托管在另一个论坛上）提供了三个选项：

1.  将单个文件夹中所有 Excel 工作簿中的所有工作表整理到单个摘要工作表中
2.  将单个文件夹中所有 Excel 工作簿中的所有工作表整理到单个摘要工作簿中
3.  将单个 Excel 工作簿中的所有工作表整理到单个摘要工作表中

您的要求是 (2)。

**代码**

```
Public Sub ConsolidateSheets()
    Dim Wb1 As Workbook
    Dim Wb2 As Workbook
    Dim ws1 As Worksheet
    Dim ws2 As Worksheet
    Dim ws3 As Worksheet
    Dim rng1 As Range
    Dim rng2 As Range
    Dim rng3 As Range
    Dim rngArea As Range
    Dim lrowSpace As Long
    Dim lSht As Long
    Dim lngCalc As Long
    Dim lngRow As Long
    Dim lngCol As Long
    Dim X()
    Dim bProcessFolder As Boolean
    Dim bNewSheet As Boolean

    Dim StrPrefix
    Dim strFileName As String
    Dim strFolderName As String

    'variant declaration needed for the Shell object to use a default directory
    Dim strDefaultFolder As Variant

 bProcessFolder = (MsgBox("Process a single folder (Yes)," & vbNewLine & "or single file (No)", vbYesNo, "Application Scope: Folder or single File") = vbYes)
    bNewSheet = (MsgBox("Extract all data to a single sheet (Yes)," & vbNewLine & "or a target file sheet for each source sheet (No)", vbYesNo, "Output Format: Single sheet or sheet by sheet collection") = vbYes)
    If Not bProcessFolder Then
        If Not bNewSheet Then
            MsgBox "There isn't much point creating a exact replica of your source file :)"
            Exit Sub
        End If
    End If

    'set default directory here if needed
    strDefaultFolder = "C:\temp"

    'If the user is collating all the sheets to a single target sheet then the row spacing
    'to distinguish between different sheets can be set here
    lrowSpace = 1

    If bProcessFolder Then
        strFolderName = BrowseForFolder(strDefaultFolder)
        'Look for xls, xlsx, xlsm files
        strFileName = Dir(strFolderName & "\*.xls*")
    Else
        strFileName = Application _
                      .GetOpenFilename("Select file to process (*.xls*), *.xls*")
    End If

    Set Wb1 = Workbooks.Add(1)
    Set ws1 = Wb1.Sheets(1)
    If Not bNewSheet Then ws1.Range("A1:B1") = Array("workbook name", "worksheet count")

    'Turn off screenupdating, events, alerts and set calculation to manual
    With Application
        .DisplayAlerts = False
        .EnableEvents = False
        .ScreenUpdating = False
        lngCalc = .Calculation
        .Calculation = xlCalculationManual
    End With

    'set path outside the loop
    StrPrefix = strFolderName & IIf(bProcessFolder, "\", vbNullString)

    Do While Len(strFileName) > 0
        'Provide progress status to user
        Application.StatusBar = Left("Processing " & strFolderName & "\" & strFileName, 255)
        'Open each workbook in the folder of interest
        Set Wb2 = Workbooks.Open(StrPrefix & strFileName)
        If Not bNewSheet Then
            'add summary details to first sheet
            ws1.Cells(Rows.Count, "A").End(xlUp).Offset(1, 0) = Wb2.Name
            ws1.Cells(Rows.Count, "A").End(xlUp).Offset(0, 1) = Wb2.Sheets.Count
        End If
        For Each ws2 In Wb2.Sheets
            If bNewSheet Then
                'All data to a single sheet
                'Skip importing target sheet data if the source sheet is blank
                Set rng2 = ws2.Cells.Find("*", ws2.[a1], xlValues, , xlByRows, xlPrevious)

                If Not rng2 Is Nothing Then
                    Set rng1 = ws1.Cells.Find("*", ws1.[a1], xlValues, , xlByRows, xlPrevious)
                    'Find the first blank row on the target sheet
                    If Not rng1 Is Nothing Then
                        Set rng3 = ws2.Range(ws2.UsedRange.Cells(1), ws2.Cells(rng2.Row, "A"))
                        'Ensure that the row area in the target sheet won't be exceeded
                        If rng3.Rows.Count + rng1.Row < Rows.Count Then
                            'Copy the data from the used range of each source sheet to the first blank row
                            'of the target sheet, using the starting column address from the source sheet being copied
                            ws2.UsedRange.Copy ws1.Cells(rng1.Row + 1 + lrowSpace, ws2.UsedRange.Cells(1).Column)
                        Else
                            MsgBox "Summary sheet size exceeded. Process stopped on " & vbNewLine & _
                                   "sheet: " & ws2.Name & vbNewLine & "of" & vbNewLine & "workbook: " & Wb2.Name
                            Wb2.Close False
                            Exit Do
                        End If
                        'colour the first of any spacer rows
                        If lrowSpace <> 0 Then ws1.Rows(rng1.Row + 1).Interior.Color = vbGreen
                    Else
                        'target sheet is empty so copy to first row
                        ws2.UsedRange.Copy ws1.Cells(1, ws2.UsedRange.Cells(1).Column)
                    End If
                End If
            Else
                'new target sheet for each source sheet
                ws2.Copy after:=Wb1.Sheets(Wb1.Sheets.Count)
                'Remove any links in our target sheet
                With Wb1.Sheets(Wb1.Sheets.Count).Cells
                    .Copy
                    .PasteSpecial xlPasteValues
                End With
                On Error Resume Next
                Wb1.Sheets(Wb1.Sheets.Count).Name = ws2.Name
                'sheet name already exists in target workbook
                If Err.Number <> 0 Then
                    'Add a number to the sheet name till a unique name is derived
                    Do
                        lSht = lSht + 1
                        Set ws3 = Wb1.Sheets(ws2.Name & " " & lSht)
                    Loop While Not ws3 Is Nothing
                    lSht = 0
                End If
                On Error GoTo 0
            End If
        Next ws2
        'Close the opened workbook
        Wb2.Close False
        'Check whether to force a DO loop exit if processing a single file
        If bProcessFolder = False Then Exit Do
        strFileName = Dir
    Loop

    'Remove any links if the user has used a target sheet
    If bNewSheet Then
        With ws1.UsedRange
            .Copy
            .Cells(1).PasteSpecial xlPasteValues
            .Cells(1).Activate
        End With
    Else
        'Format the summary sheet if the user has created separate target sheets
        ws1.Activate
        ws1.Range("A1:B1").Font.Bold = True
        ws1.Columns.AutoFit
    End If

    With Application
        .CutCopyMode = False
        .DisplayAlerts = True
        .EnableEvents = True
        .ScreenUpdating = True
        .Calculation = lngCalc
        .StatusBar = vbNullString
    End With
End Sub

Function BrowseForFolder(Optional OpenAt As Variant) As Variant
'From Ken Puls as used in his vbaexpress.com article
'http://www.vbaexpress.com/kb/getarticle.php?kb_id=284

    Dim ShellApp As Object
    'Create a file browser window at the default folder
    Set ShellApp = CreateObject("Shell.Application"). _
                   BrowseForFolder(0, "Please choose a folder", 0, OpenAt)

    'Set the folder to that selected.  (On error in case cancelled)
    On Error Resume Next
    BrowseForFolder = ShellApp.self.Path
    On Error GoTo 0

    'Destroy the Shell Application
    Set ShellApp = Nothing

    'Check for invalid or non-entries and send to the Invalid error
    'handler if found
    'Valid selections can begin L: (where L is a letter) or
    '\\ (as in \\servername\sharename.  All others are invalid
    Select Case Mid(BrowseForFolder, 2, 1)
    Case Is = ":"
        If Left(BrowseForFolder, 1) = ":" Then GoTo Invalid
    Case Is = "\"
        If Not Left(BrowseForFolder, 1) = "\" Then GoTo Invalid
    Case Else
        GoTo Invalid
    End Select

    Exit Function

Invalid:
    'If it was determined that the selection was invalid, set to False
    BrowseForFolder = False
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:10:07.713

是的，您可以，您可以使用该`Dir`命令查看该目录中存在哪些 .xls 或 .xlsx 或 xlsm（适合您的情况），然后使用循环`Workbooks.Open`打开一个，在其中添加工作表到您的原始工作簿，将其关闭，然后循环到 de Dir 列表中的下一个工作簿。

例如以这种方式使用 Dir：

```
 Dim strPath As String
    Dim strFile As String

    strPath = "C:\yourfolder\"

    strFile = Dir(strPath & "*.xlsx")

    Do Until strFile = ""

        ' ...YOURCODE HERE

    Loop 
```

这将代替`For each wb in Workbooks`，您可以申请`Set wb = Workbooks.Open strPath & strFile`并仍然使用原始代码的其余部分来复制工作表。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-27T02:38:09.353

请使用插件 RDBMerge。

RDBMerge 是一种用户友好的方式，可以将多个 Excel 工作簿、csv 和 xml 文件中的数据合并到摘要工作簿中

[http://www.rondebruin.nl/merge.htm](http://www.rondebruin.nl/merge.htm)

[将不同文件夹中的多个工作簿合并为一个](https://stackoverflow.com/questions/15186302/merge-multiple-workbooks-from-different-folders-into-one/15188080#15188080)

# sigar - SIGAR API：何时使用gather()

> ID：15648128
> 
> 赞同：1
> 
> 时间：2013-03-26T21:55:17.590
> 
> 标签：sigar

我正在考虑使用 SIGAR 包来获取一些系统统计信息（从 Java 调用它）。在浏览各种课程时，有时我会看到一个“收集”例程。我可以理解，需要调用它来获取最新信息，并可能计算诸如吞吐率之类的东西。我不知道是谁应该打电话来收集？程序员，还是包本身？Javadocs 从来没有评论什么时候应该使用gather()。

任何人都可以给我一些关于我是否应该调用它的一般指示，如果是这样，什么时候？有时它似乎需要一个 Sigar 对象，有时则不是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T22:27:52.717

原来是包裹——我根本不需要打电话给收集。每次我调用 API 中的相关项目（例如 CPU 或网络接口数据）时，它都会更新信息。

# javascript - Javascript Google电子表格中的圆形变量

> ID：15648132
> 
> 赞同：1
> 
> 时间：2013-03-26T21:55:39.973
> 
> 标签：javascript, variables, rounding

我正在查询一个谷歌电子表格，我得到的数字正在放大我在代码中进一步做的一些权重。

我的查询：

```
function queryValue3(met1,met2,met3) {
var query3 = new google.visualization.Query('https://spreadsheets.google.com/spreadsheet/tq?range=B7:B9&key=my_key&gid=10');
query3.send(function (response) {
    if (response.isError()) {
        alert('Error in query3: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
    }

    var data3 = response.getDataTable();

    var m1 = data3.getValue(0, 0);
    var m2 = data3.getValue(1, 0);
    var m3 = data3.getValue(2, 0); 
```

我为 m2 拉的数字显然是 25.3333333333333323 并且在函数的后面让我感到震惊。只要我的数字四舍五入到第 10 位或第 100 位（在这种情况下我想要第 10 位），该函数就可以正常工作。我使用自定义回合（十进制 1），它在工作表中看起来正确，但查询正在获取原始数字？在大多数情况下，我的数字是整数，我希望它在这些情况下没有小数。有人可以帮我修改这种情况下的变量 m1、m2 和 m3 吗？

谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T22:02:40.797

有`n.toFixed(2);`

您可以使用它来设置小数点后的数字数量。

例子：

```
foo = 25.3333333333;
foo = +foo.toFixed(2); 
// The plus makes it a number-type again, as toFixed converts to string.
console.log(foo); // 25.33 
```

编辑：小数舍入作为预期的副作用发生：

```
foo = 25.127;
foo = +foo.toFixed(2); 
console.log(foo); // 25.13 
```

整数保持不变：

```
foo = 23;
foo = +foo.toFixed(2);
console.log(foo); // 23 
```

# javascript - 在您选择其中任何一个之前，将显示带有空白的 HTML 选择框

> ID：15648139
> 
> 赞同：4
> 
> 时间：2013-03-26T21:56:10.607
> 
> 标签：javascript, jquery, html, dom, select

想象一下下面的一个选择 HTML 元素：

```
<select id="mySelect">
  <option>Apple</option>
  <option>Orange</option>
  <option>Pineapple</option>
  <option>Banana</option>
</select> 
```

我希望在呈现此 DOM 元素时，所选值应为空白，而不是 4 个水果中的任何一个。
我不想将空白作为另一种选择。
可能吗？

那就是我不想添加另一个项目，例如：

```
<select id="mySelect">
  <option>Select an item </option>
  <option>Apple</option>
  <option>Orange</option>
  <option>Pineapple</option>
  <option>Banana</option>
</select> 
```

或者

```
<select id="mySelect">
 <option></option>
  <option>Apple</option>
  <option>Orange</option>
  <option>Pineapple</option>
  <option>Banana</option>
</select> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:07:30.677

这对你来说很好

使用此 HTML

```
<select id="mySelect">
    <option>Apple</option>
    <option>Orange</option>
    <option>Pineapple</option>
    <option>Banana</option>
</select> 
```

并在 jQuery 中使用

```
$('#mySelect').prop('selectedIndex', -1); 
```

Javascript 版本（在最新的 chrome、firefox 和 IE 11 上测试）

```
document.getElementById("mySelect").selectedIndex = -1 
```

这应该使下拉列表显示为空白，而无需在列表中添加额外的空白选项

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T22:03:44.513

你不能用纯 HTML 做到这一点。检查 MDN 和官方 W3C HTML5.x nightly build：

*   [https://developer.mozilla.org/en-US/docs/HTML/Element/select](https://developer.mozilla.org/en-US/docs/HTML/Element/select)
*   [http://www.w3.org/html/wg/drafts/html/master/forms.html#the-select-element](http://www.w3.org/html/wg/drafts/html/master/forms.html#the-select-element)

您确实需要使用 JavaScript 将其切换出来，并在“假”选项上使用 selected 属性。

这些是`<select>`元素的属性（属性）的可用性：

***全球的***

accesskey class contenteditable contextmenu dir draggable dropzone hidden id inert spellcheck style tabindex title translate

***选择***

自动对焦禁用表单多个名称所需大小

## 更新

由于 OP 似乎允许 JavaScript 作为替代方案，而不是 jQuery，我添加了一个普通的 JavaScript 示例来添加一个空的（选定的）选项标签；

```
var fakeOpt = document.createElement('option');
var myList = document.getElementById('mySelect');

fakeOpt.selected = 'selected';
myList.insertBefore(fakeOpt, myList[0]);

// Listen to a change
myList.onchange = function(evt){
    var clicked_option = myList.options[myList.selectedIndex].text;

    if (clicked_option.trim() != '') {
        console.log(clicked_option);
    }
    else {
        console.log('Empty option selected');
    }
}; 
```

这样就无需在 HTML 代码中手动填写。

这是一个 JSfiddle；[http://jsfiddle.net/VjCbE/3/](http://jsfiddle.net/VjCbE/3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-13T09:47:37.947

我刚刚找到了一个非常漂亮的解决方案：

```
<pre>
<label for="hardness">Select the hardness</label> : 
    <select name="hardness" id="hardness">
        <option selected="selected" disabled="disabled"></option>
        <option value="3">Easy</option>
        <option value="6">Medium</option>
        <option value="10">Hard</option>
    </select>
</pre> 
```

现在 selectHardness.selectedIndex 总是 > 0;

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-19T09:08:55.963

```
<option selected disabled value=''></option> 
```

`selected`将此选项设为默认选项。 `disabled`使该选项无法点击。

# jsf-2 - 如何抑制 MyFaces 控制台 html 警告？

> ID：15648141
> 
> 赞同：1
> 
> 时间：2013-03-26T21:56:18.357
> 
> 标签：jsf-2, facelets, myfaces

我们正准备尽快将我们的 JSF 2（MyFaces with Facelets 页面）应用程序迁移到生产环境。目前，我们的控制台日志（WebSphere v8 上的 SystemOut.log）充满了大量此类消息：

```
[3/26/13 16:42:33:744 CDT] 00000031 HtmlImageRend W   Component UIGraphic Form:errorIconSave has no attribute alt or attribute resolves to null. Path to component {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /view/groupagreement/products/volumebased/VolumeBasedProducts.xhtml][Class: javax.faces.component.html.HtmlBody,Id: commonLayoutId][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id1364021679_785179b][Class: javax.faces.component.html.HtmlForm,Id: Form][Class: javax.faces.component.html.HtmlBody,Id: j_id363369746_1d362e8b][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id363369746_1d362e61][Class: org.richfaces.component.UIRegion,Id: j_id363369746_1d362e4a][Class: org.richfaces.component.UIPopupPanel,Id: confirmationPopUpForWayFinder][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id363369746_1d362ffd][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id363369746_1d362fbc][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id363369746_1d362f9a][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id363369746_1d362f70][Class: javax.faces.component.html.HtmlGraphicImage,Id: errorIconSave]}
[3/26/13 16:42:33:746 CDT] 00000031 HtmlResponseW W   HTML nesting warning on closing div: element td rendered by component : {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /view/groupagreement/products/volumebased/VolumeBasedProducts.xhtml][Class: javax.faces.component.html.HtmlBody,Id: commonLayoutId][Class: javax.faces.component.html.HtmlPanelGrid,Id: j_id1364021679_785179b]} not explicitly closed 
```

我们认为这种过度的日志记录可能会损害性能。虽然我们知道我们应该将我们的应用程序正确地编码为 html 规范，但它是由离岸供应商提供的，我们对代码质量没有我们想要的那样多的控制。此时我们可能没有时间修复所有的 xhtml 文件（将 alt 属性添加到图像等）。

有什么方法可以禁用此日志记录？例如 web.xml 上下文参数？我在 MyFaces 文档中找不到任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T02:36:08.370

我能够自己解决这个问题。

我查看了生成这些警告的 MyFaces 组件的源代码（[例如 HtmlResponseWriterImpl 的 grepcode 源链接](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.myfaces.core/myfaces-impl/2.0.9/org/apache/myfaces/shared/renderkit/html/HtmlResponseWriterImpl.java#336)）。从源代码很明显，在打印这些警告之前没有检查其他配置参数。但当然正在检查 java.util.logging*级别*。所以解决方案是简单地配置 java.util.logging（又名 jul 或 jdk 日志）来抑制来自这些组件的警告。

我本可以尝试在我们的 WebSphere 实例中配置 jdk 日志记录配置文件，但这是在我们的生产环境（共享基础架构、锁定服务器）中部署和管理的一个更加困难的更改。所以我最终使用了一个 java 解决方案——一个我注册为 Spring bean 的类，它的 init 方法更改了它提供的记录器名称的日志记录级别：

```
<bean id="setJdkLoggingToSevere" class="ca.mycompany.myapp.util.JdkLoggingLevelConfigurer" init-method="init">
    <property name="level" value="SEVERE" />
    <property name="loggerNames">
        <list>
            <value>org.apache.myfaces.shared.renderkit.html.HtmlResponseWriterImpl</value>
            <value>org.apache.myfaces.renderkit.html.HtmlImageRenderer</value>
            <value>org.apache.myfaces.renderkit.html.ext.HtmlImageRenderer</value>
            <value>org.apache.myfaces.shared.renderkit.html.HtmlImageRendererBase</value>
            <value>org.apache.myfaces.shared_tomahawk.renderkit.html.HtmlImageRendererBase</value>
            <value>org.apache.myfaces.renderkit.html.HtmlLabelRenderer</value>
            <value>org.apache.myfaces.renderkit.html.HtmlGridRenderer</value>
            <value>org.apache.myfaces.renderkit.html.ext.HtmlGridRenderer</value>
            <value>org.apache.myfaces.shared.renderkit.html.HtmlGridRendererBase</value>
            <value>org.apache.myfaces.shared_tomahawk.renderkit.html.HtmlGridRendererBase</value>
            <value>org.apache.myfaces.shared.renderkit.html.HtmlRendererUtils</value>
            <value>org.apache.myfaces.shared_tomahawk.renderkit.html.HtmlRendererUtils</value>
        </list>
    </property>
</bean> 
```

这是我课堂上的相关方法`JdkLoggingLevelConfigurer`（注意`myLogger`是 slf4j 记录器，因为 slf4j 是我的应用程序的日志框架）：

```
public void init() {
    if (this.getLoggerNames() != null) {

        Level level = Level.parse(this.getLevel());

        for (String loggerName : loggerNames) {
            Logger logger = Logger.getLogger(loggerName);
            if (logger != null) {
                myLogger.info("setting jdk logging for {} to {}", loggerName, level);
                logger.setLevel(level);
                this.loggers.add(logger);
            }
            else {
                myLogger.warn("unable to set jdk logging for {} to {} because logger was null",
                        loggerName, this.getLevel());
            }
        }
    }
} 
```

完成上述操作后，我们将不再看到警告消息。如果我错过了任何发出警告的 myfaces 组件（我最初确实错过了一些），它们可以很容易地添加到 spring 配置中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T14:05:44.840

在 HtmlImageRendererBase 中使用了 JUL 记录器，因此只需将文件**logging.properties**添加到您的类路径中，包括以下行：

```
org.apache.myfaces.shared.renderkit.html.HtmlImageRendererBase.level = SEVERE 
```

# html - 将 HTML5 视频标签中的电影映射到模态

> ID：15648142
> 
> 赞同：0
> 
> 时间：2013-03-26T21:56:19.237
> 
> 标签：html, css, map, html5-video

我有一部电影正在我想映射的网站上播放（如图像），这样我就可以让人们点击电影标签的某个区域，可以这么说。我基本上已经完成了我在 2005 年使用图像地图的方式，但它并没有成功。有没有人尝试过这个？

```
<div usemap="#myMap">
<video width="895" height="495" controls>
   <source src="someMovie.webm" type="video/webm" loop="loop">
</video>
<map name="myMap"> 
<area shape="rect" coords="some coordinates here" href="myAddress"> </aread>
</map> 
```

我的按钮只是告诉我地图标签已被弃用.....所以现在有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:28:23.553

我远不是该领域的专家，但您应该能够通过在标签的父 div 中放置一个`div`包装在标签中并使用 CSS 将其定位在元素前面来实现这一点——类似于“ ”。`<a>``<video>``<video>``position: absolute; z-index: 1; margin: {some_values};`

示例：http: [//jsfiddle.net/a8atS/2/](http://jsfiddle.net/a8atS/2/)

# android - TableLayout 上的 ProgressBar

> ID：15648143
> 
> 赞同：0
> 
> 时间：2013-03-26T21:56:24.720
> 
> 标签：android, progress-bar, visibility, android-tablelayout

我正在尝试将我的 ProgressBar 放在 TableLayout 的顶部。

**代码：**

```
<?xml version="1.0" encoding="utf-8"?> 
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:baselineAligned="false"
    android:orientation="vertical" >

<ProgressBar
    android:id="@+id/bar_Update"
    style="?android:attr/progressBarStyleLarge"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:padding="250dp"
    android:visibility="visible" />

<ScrollView 
    android:id="@+id/ScrollView01" 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content">

<TableLayout    
    android:id="@+id/tableLayout1"  
    android:layout_width="fill_parent"  
    android:layout_height="wrap_content"  
    android:shrinkColumns="*"  
    android:stretchColumns="*"
    android:gravity="center_horizontal"
    android:layout_gravity="top">    

      <TableRow 
          android:id="@+id/RowTitle" 
          android:layout_width="wrap_content" 
          android:layout_height="wrap_content">

      <TextView
          android:id="@+id/Title"
          android:layout_width="fill_parent"
          android:layout_height="60px"
          android:gravity="center"
          android:text="Unterichtsausfall: \n"
          android:textSize="20dp"
          android:textStyle="bold"
          android:typeface="serif" >
      </TextView>

      <ImageView
          android:id="@+id/imgUpdate"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:adjustViewBounds="false"
          android:baselineAlignBottom="false"
          android:clickable="true"
          android:src="@drawable/refresh" />

    </TableRow>   

</TableLayout>
</ScrollView>

</LinearLayout> 
```

我`setVisibility(View.VISIBLE)`在我的代码中使用以在布局顶部显示进度条，但它不起作用。为了显示它消失了，我正在使用`setVisibility(View.INVISIBLE)`. 我究竟做错了什么？我的目标是从互联网上获取数据。在此期间，微调器正在显示。一旦获取数据，它就会显示在表格中，并且 Spinner 消失了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:05:21.027

“在上面”和“在上面”之间存在细微差别。“在顶部”通常意味着它覆盖了下面的图形，就像人们通常想要使用 ProgressBar 一样。

'Above'，通常意味着更高的屏幕顶部，这样 ScrollView 和 TableLayout 会更靠近屏幕底部。

如果您的 ProgressBar 是“在顶部”，那么`View.INVISIBLE`就可以了。但是，您`ProgressBar`的布局“高于”下面的布局。因此，按照您实施的方式，您可能应该将其设置为`View.GONE`以隐藏它。

* * *

如果您想在下面的布局中显示进度条“在顶部”或“上方”，则必须将顶层布局设置为 a`RelativeLayout`而不是 a `LinearLayout`。

* * *

最后，我不明白出了什么问题。究竟是什么不适合您的布局或代码行为？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-04T10:39:09.980

我遇到了这个问题，我的进度条被隐藏在表格布局下方，我设法纠正它并使其成为最顶层并显示在表格顶部而不会在经过反复试验后被遮挡。

我的基本布局需要重新安排，我将进度条放在外部布局内，将 tableLayout 放在嵌套布局内。在我的 ProgressBar 位于包含表格的嵌套布局之后，也需要排序。

工作时看起来像这样......

```
<RelativeLayout....outer layout

    <ScrollView....
    <RelativeLayout....nested layout
         Some TextViews etc...
        <TableLayout.....inside nested layout/>
    </RelativeLayout>
    </ScrollView>
  <ProgressBar....inside outer layout
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:foregroundGravity="center_vertical|center_horizontal"/>
</RelativeLayout> 
```

# node.js - Heroku、Socket.IO、Node.js

> ID：15648145
> 
> 赞同：0
> 
> 时间：2013-03-26T21:56:27.587
> 
> 标签：node.js, heroku, socket.io, twitter-streaming-api

我正在 heroku 上设置一个 node.js 推特流媒体应用程序。在第二个客户端建立连接之前，它可以完美运行。这是我在向某人展示之前没想到的:(

我正在为 Twitter Stram API 功能使用 tweet-pipe：[https ://github.com/peeinears/tweet-pipe](https://github.com/peeinears/tweet-pipe)

为了让 Socket.IO 在 Heroku 上工作，我按照以下说明操作：[https ://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku](https://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku)

```
io.configure(function () { 
  io.set("transports", ["xhr-polling"]); 
  io.set("polling duration", 10); 
}); 
```

在我的 app.js 文件中，我有

```
io.sockets.on('connection', function (socket) {
  tp.stream('statuses/filter', params, false, function (stream) {
    stream.on('tweet', function (tweet) {
      socket.emit('tweet', tweet );
    });
  });
}); 
```

同样，这一切都很好，直到另一个客户访问该页面。然后原始连接丢失，而第二个客户端有连接。有什么想法吗？我对 Socket.IO 的东西有点陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:33:20.607

这是我修复它的方法，感谢评论中的乍得。它现在似乎工作正常，因为它是活的并且有点健康。

```
io.sockets.on('connection', function (socket) {

  var tp = new TweetPipe({
    consumer_key: process.env.CONSUMER_KEY,
    consumer_secret: process.env.CONSUMER_SECRET,
    token: process.env.TOKEN,
    token_secret: process.env.TOKEN_SECRET
  });

  tp.stream('statuses/filter', params, false, function (stream) {
    stream.on('tweet', function (tweet) {
      io.sockets.emit('tweet', tweet );
    });
  });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T06:16:24.223

AFAIK 每个推特句柄只能有一个活动流。您不能`tp.stream`用于第二个客户。

资料来源：

1.  [https://dev.twitter.com/docs/streaming-apis/streams/public](https://dev.twitter.com/docs/streaming-apis/streams/public)
2.  [https://dev.twitter.com/discussions/921](https://dev.twitter.com/discussions/921)

# sql - 如果在 T-SQL 中

> ID：15648148
> 
> 赞同：0
> 
> 时间：2013-03-26T21:56:36.697
> 
> 标签：sql, sql-server, tsql

我正在使用 T-SQL 开发数据库，​​现在我遇到了问题。

我有多行名称相同，但其中一列的值不同（一行`doc`是 0，第二行`doc`是 2000），有些行只出现一次，并且只有一个值。

现在，我想选择行中有 0 的所有行，如果没有 0，那么我想选择具有该值的行。

这是示例数据：

```
CREATE TABLE Table1
    ([name] varchar(3), [doc] int, [sum] int)
;

INSERT INTO Table1
    ([name], [doc], [sum])
VALUES
    ('tom', 0, 100),
    ('tom', 2000, 200),
    ('jon', 2000, 200)
; 
```

现在我希望得到 TOM 值为 100 且 JON 值为 200 的行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:12:10.303

一种方法，[`ROW_NUMBER`](http://msdn.microsoft.com/en-us/library/ms186734.aspx)在 a 中使用[`CTE`](http://msdn.microsoft.com/de-de/library/ms175972.aspx)：

```
WITH cte 
     AS (SELECT [name], 
                [doc], 
                [sum], 
                [rn] = Row_number() 
                       OVER( 
                         partition BY name 
                         ORDER BY CASE WHEN doc=0 THEN 0 ELSE 1 END) 
         FROM   table1) 
SELECT [name], 
       [doc], 
       [sum] 
FROM   cte 
WHERE  rn = 1 
```

[**演示**](http://www.sqlfiddle.com/#!3/14d7a/2/0)（使用您的示例数据）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:59:29.843

假设您的`A`列不能有负值：

```
select name, min(A)
from yourtable
group by name 
```

如果您想要上述每一项的整行，那么您必须使用子查询：

```
select yourtable.* from yourtable
join (
    select name, min(A) [mina]
    from yourtable
    group by name
) a on a.name=yourtable.name and a.[mina]=yourtable.A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:59:32.453

此版本使用窗口函数来计算每个名称为零值的行数。然后，它使用您问题中的逻辑选择值为 0 的行或具有有效值的行。

```
select name, value
from (select name, value,
             sum(case when value = 0 then 1 else 0 end) over (partition by name) as NumZeros
      from t
     ) t
 where numZeros = 0 or value = 0 
```

# c - 使用免费时下一个尺寸无效

> ID：15648152
> 
> 赞同：-2
> 
> 时间：2013-03-26T21:56:57.227
> 
> 标签：c, malloc, realloc

*或者，[Facing an error — glibc detected free invalid next size (fast) 的](https://stackoverflow.com/questions/2317021/facing-an-error-glibc-detected-free-invalid-next-size-fast)副本。*

我有一个名为 bond 的结构，其定义如下：

```
typedef struct{
    int type1;
    int type2;
    int id_1;
    int id_2;
    float dist;
} bond; 
```

我在嵌套循环中分配这些结构的数组并定期释放它。但是，由于某种原因，我收到了 free() Invalid Next size 错误。代码如下：

```
while(i<(C.num_type_A+C.num_type_B)){//1a
    bond_arr=(bond*)malloc(100*sizeof(bond));

    a=-N1;
    while(a<=N1){//2a

        b=-N2;
        while(b<=N2){//3a

            c=-N3;
            while(c<=N3){//4a

                j=0;
                while(j<(C.num_type_A+C.num_type_B)){//5a

                    //if the same atom do nothing
                    if((i==j)&&(a==0)&&(b==0)&&(c==0)){//6a
                        j=j+1;
                    }//6b
                    else{//7a

                        //calculate bond length
                        bondlength=calc_dist(a,b,c,i,j,C);

                        if(bondlength<=cutoff){//8a
                            //store bond
                            temp_bond.type1=((i+1)<=C.num_type_A);
                            temp_bond.type2=((j+1)<=C.num_type_B);
                            temp_bond.id_1=i;
                            temp_bond.id_2=j;
                            temp_bond.dist=bondlength;
                            bond_arr[n]=temp_bond;
                            n=n+1;

                            //if out of memory allocate twice as much
                            if(n==(nmax-1)){//9a
                                printf("begin\n");
                                temp_ptr=realloc(bond_arr,sizeof(bond)*2*nmax);
                                printf("end\n");

                                if(temp_ptr==NULL){
                                    printf("Memory allocation failed\n");
                                }
                                else{
                                    bond_arr=temp_ptr;
                                }
                                nmax=2*nmax;
                            }//9b
                        }//8b
                    }//7b
                    j=j+1;
                }//5b
                c=c+1;
            }//4b
            b=b+1;
        }//3b
        a=a+1;
    }//2b

    //sort bonds and update LI index
    sort_bonds(bond_arr,n);
    f=update_LI(bond_arr,LIcurr,n);
    LIcurr=f;
    printf("%d\n",n);
    free(bond_arr);
    n=0;
    i=i+1;
}//1b 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:04:24.703

看起来 realloc 逻辑可能是罪魁祸首。初始分配大小为 100。然后在`n`达到时增长`nmax-1`。的初始值`nmax`没有显示（我看到了）。即使它从 100 开始，它也不会在循环顶部重置。因此，如果`n`曾经增长超过 100 并导致重新分配，那么 nmax 将加倍并且不再匹配 100 的原始大小。

# android - Android 与 Twitter 的连接 - 从 twitter 获取空答案

> ID：15648159
> 
> 赞同：4
> 
> 时间：2013-03-26T21:57:46.637
> 
> 标签：android, twitter, twitter4j

我在连接到 twitter 时遇到了 %&·$5#~€ 问题。（代码在此下方）

首先，我已经完成了所有配置（twitter 键、清单中的回调等），然后我调用 twitter 并打开浏览器，然后我在 twitter 中登录并接受应用程序，然后浏览器返回到应用程序并尝试从 twitter 获得响应，但我得到 NULL 作为答案。

谁能帮我找出这是怎么回事？

问候

PD：我遵循本教程：[http ://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/](http://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/)

PD 2：有些人认为问题出在电话的日期和时间（[https://dev.twitter.com/discussions/374](https://dev.twitter.com/discussions/374)），但我改变了它并且不起作用

```
import twitter4j.Twitter;
import twitter4j.TwitterException;
import twitter4j.TwitterFactory;
import twitter4j.User;
import twitter4j.auth.AccessToken;
import twitter4j.auth.RequestToken;
import twitter4j.conf.Configuration;
import twitter4j.conf.ConfigurationBuilder;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.net.Uri;
import android.os.AsyncTask;
import android.os.Build;
import android.os.Bundle;
import android.os.StrictMode;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageView;
import android.widget.Toast;

@SuppressLint("NewApi")
public class TwitterActivity extends Activity {

    Intent TWITTER_INTENT = null;
    //TWITTER THINGS
        static String TWITTER_CONSUMER_KEY = "CONSUMER_KEY_HERE";
        static String TWITTER_CONSUMER_SECRET = "CONSUMER_SECRET_HERE";
        static final String TWITTER_CALLBACK_URL = "oauth://t4jsample";

        // Twitter oauth urls
        static final String URL_TWITTER_AUTH = "https://api.twitter.com/oauth/authorize";
        static final String URL_TWITTER_OAUTH_VERIFIER = "https://api.twitter.com/oauth/access_token";
        static final String URL_TWITTER_OAUTH_TOKEN = "https://api.twitter.com/oauth/request_token";

        // Progress dialog
        ProgressDialog pDialog;

        // Twitter
        public static Twitter twitter;
        public static String twitter_token, twitter_secret; 

        // Internet Connection detector
        private ConnectionDetector cd;

        // Alert Dialog Manager
        AlertDialogManager alert = new AlertDialogManager();

    // Preference Constants
    static String PREFERENCE_NAME = "twitter_oauth";
    static final String PREF_KEY_OAUTH_TOKEN = "oauth_token";
    static final String PREF_KEY_OAUTH_SECRET = "oauth_token_secret";
    static final String PREF_KEY_TWITTER_LOGIN = "isTwitterLogedIn";

    // Twitter

    private static RequestToken requestToken;

    // Shared Preferences
    private static SharedPreferences mSharedPreferences;

    @SuppressLint("NewApi")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_twitter);
        if (Build.VERSION.SDK_INT > 9) {
            StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy);
        }
        //setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

        cd = new ConnectionDetector(getApplicationContext());

        // Check if Internet present
        if (!cd.isConnectingToInternet()) {
            // Internet Connection is not present
            alert.showAlertDialog(TwitterActivity.this, "Internet Connection Error","Please connect to working Internet connection", false);
            // stop executing code by return
            return;
        }

        // Check if twitter keys are set
        if(TWITTER_CONSUMER_KEY.trim().length() == 0 || TWITTER_CONSUMER_SECRET.trim().length() == 0){
            // Internet Connection is not present
            alert.showAlertDialog(TwitterActivity.this, "Twitter oAuth tokens", "Please set your twitter oauth tokens first!", false);
            // stop executing code by return
            return;
        }

        // Shared Preferences
        mSharedPreferences = getApplicationContext().getSharedPreferences("MyPref", 0);

        ImageView TW = (ImageView) findViewById(R.id.twitter_boton);
        TW.setClickable(true);
        TW.setOnClickListener(new OnClickListener(){
            public void onClick(View v){
                loginToTwitter();
            }
        });

        /** This if conditions is tested once is
         * redirected from twitter page. Parse the uri to get oAuth
         * Verifier
         * */
        if (!isTwitterLoggedInAlready()) {
            Uri uri = getIntent().getData();
            if (uri != null && uri.toString().startsWith(TWITTER_CALLBACK_URL)) {
                // oAuth verifier
                String verifier = uri.getQueryParameter(URL_TWITTER_OAUTH_VERIFIER);

                try {
                    // Get the access token
                    AccessToken accessToken = twitter.getOAuthAccessToken(
                            requestToken, verifier);

                    // Shared Preferences
                    Editor e = mSharedPreferences.edit();

                    // After getting access token, access token secret
                    // store them in application preferences
                    e.putString(PREF_KEY_OAUTH_TOKEN, accessToken.getToken());
                    e.putString(PREF_KEY_OAUTH_SECRET,
                            accessToken.getTokenSecret());
                    // Store login status - true
                    e.putBoolean(PREF_KEY_TWITTER_LOGIN, true);
                    e.commit(); // save changes

                    Log.e("Twitter OAuth Token", "> " + accessToken.getToken());

                    // Getting user details from twitter
                    // For now i am getting his name only
                    long userID = accessToken.getUserId();
                    User user = twitter.showUser(userID);
                    String username = user.getName();
                    Log.d("nombre",username);
                } catch (Exception e) {
                    // Check log for login errors
                    Log.e("Twitter Login Error", "> " + e.toString());
                    Log.e("Twitter Login Error", "> " + e.getMessage());
                }
            }
        }

    }

    /**
     * Function to login twitter
     * */
    private void loginToTwitter() {
        // Check if already logged in
        if (!isTwitterLoggedInAlready()) {
            ConfigurationBuilder builder = new ConfigurationBuilder();
            builder.setOAuthConsumerKey(TWITTER_CONSUMER_KEY);
            builder.setOAuthConsumerSecret(TWITTER_CONSUMER_SECRET);
            Configuration configuration = builder.build();

            TwitterFactory factory = new TwitterFactory(configuration);
            twitter = factory.getInstance();

            if(!(Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB)) {
                try {
                    requestToken = twitter.getOAuthRequestToken(TWITTER_CALLBACK_URL);
                    this.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(requestToken.getAuthenticationURL())));
                } catch (TwitterException e) {
                    e.printStackTrace();
                }
            }
            else
            {
                new Thread(new Runnable() {
                    public void run() {
                        try {   
                            requestToken = twitter.getOAuthRequestToken(TWITTER_CALLBACK_URL);
                            TwitterActivity.this.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(requestToken.getAuthenticationURL())));
                        } catch (TwitterException e) {
                            e.printStackTrace();
                        }
                    }
                }).start();
            }
        } else {
            // user already logged into twitter
            Toast.makeText(getApplicationContext(),
                    "Already Logged into twitter", Toast.LENGTH_LONG).show();
        }
    }

    /**
     * Function to update status
     * */
    class updateTwitterStatus extends AsyncTask<String, String, String> {

        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(TwitterActivity.this);
            pDialog.setMessage("Updating to twitter...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        /**
         * getting Places JSON
         * */
        protected String doInBackground(String... args) {
            Log.d("Tweet Text", "> " + args[0]);
            String status = args[0];
            try {
                ConfigurationBuilder builder = new ConfigurationBuilder();
                builder.setOAuthConsumerKey(TWITTER_CONSUMER_KEY);
                builder.setOAuthConsumerSecret(TWITTER_CONSUMER_SECRET);

                // Access Token
                String access_token = mSharedPreferences.getString(PREF_KEY_OAUTH_TOKEN, "");
                // Access Token Secret
                String access_token_secret = mSharedPreferences.getString(PREF_KEY_OAUTH_SECRET, "");

                AccessToken accessToken = new AccessToken(access_token, access_token_secret);
                Twitter twitter = new TwitterFactory(builder.build()).getInstance(accessToken);

                // Update status
                twitter4j.Status response = twitter.updateStatus(status);

                Log.d("Status", "> " + response.getText());
            } catch (TwitterException e) {
                // Error in updating status
                Log.d("Twitter Update Error", e.getMessage());
            }
            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog and show
         * the data in UI Always use runOnUiThread(new Runnable()) to update UI
         * from background thread, otherwise you will get error
         * **/
        protected void onPostExecute(String file_url) {
            // dismiss the dialog after getting all products
            pDialog.dismiss();
            // updating UI from Background Thread
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    Toast.makeText(getApplicationContext(),
                            "Status tweeted successfully", Toast.LENGTH_SHORT)
                            .show();
                    // Clearing EditText field

                }
            });
        }

    }

    /**
     * Check user already logged in your application using twitter Login flag is
     * fetched from Shared Preferences
     * */
    private boolean isTwitterLoggedInAlready() {
        // return twitter login status from Shared Preferences
        return mSharedPreferences.getBoolean(PREF_KEY_TWITTER_LOGIN, false);
    }

    protected void onResume() {
        super.onResume();
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T04:02:27.117

在花了几个小时阅读文档（我现在没有眼睛）之后，当我尝试获取 access_token 时，我称之为：

```
// Get the access token
AccessToken accessToken = twitter.getOAuthAccessToken(requestToken, verifier); 
```

我通过了验证器（这是 pin pass，但 pin pass 不再使用），他为空，因为不再使用 twitter，然后我只需要用这个重写：

```
// Get the access token
AccessToken accessToken = twitter.getOAuthAccessToken(requestToken); 
```

只需要 requestToken 即可获取 access_token。

我希望这可以帮助任何有同样问题的人。

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-21T15:52:40.953

我查看了您的代码（由于类似的问题）并发现了一个错误。看，当焦点再次返回到应用程序后，收到 requestToken 后，您尝试获取`oAuth verifier`错误的常量值。

```
String verifier = uri.getQueryParameter(URL_TWITTER_OAUTH_VERIFIER); 
```

`URL_TWITTER_OAUTH_VERIFIER`你的代码在哪里

```
URL_TWITTER_OAUTH_VERIFIER = "https://api.twitter.com/oauth/access_token" (!) 
```

但您必须设置`getQueryParameter(OAUTH_VERIFIER);`其他值

```
OAUTH_VERIFIER =  = "oauth_verifier"; 
```

你的代码变得完全正确！

JosephCastro 为我建议的解决方案不起作用。

# mysql - MySQL：将列转换为行

> ID：15648160
> 
> 赞同：0
> 
> 时间：2013-03-26T21:57:47.907
> 
> 标签：mysql, sql

我有无数列需要转换成行。

我有 3 个主要类别（CAT、ODB 和 GPA）每个类别都有一个月（从 1 月到 12 月），每个类别都有一年）以下是结构示例：

> CATJAN2002 | CATFEB2002...| CATDEC2002...| ODBJAN2003...| GPAMAR2013

在 vba 中，我可以创建一个简单的循环，将此数据导出到另一个表中：

`New_Table`字段： `ID, TYPE, YEAR, MONTH, VALUE` 。你能帮我找到一种方法来自动考虑表格的列并开始将数据输入到新表格中吗？这可以单独在 MySQL 中完成吗？

我忘了提醒第一列（STORE、ITEM 和 CUSTOMER）的组合是 ID（或主键）[`SELECT CONCAT(STORE, ITEM, CUSTOMER) AS ID`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:18:52.803

这个想法是使用这样的查询：

```
SELECT CONCAT(STORE, ITEM, CUSTOMER) ID,
       'CAT' TYPE, 2002 YEAR, 'JAN' MONTH, CATJAN2002 VALUE
FROM yourtable
UNION ALL
SELECT CONCAT(STORE, ITEM, CUSTOMER) ID,
       'CAT' TYPE, 2002 YEAR, 'FEB' MONTH, CATFEB2002 VALUE
FROM yourtable
UNION ALL
... 
```

您可以使用动态查询来实现，如下所示：

```
SELECT
  GROUP_CONCAT(
  CONCAT(
    'SELECT CONCAT(STORE, ITEM, CUSTOMER) ID,',
    '\'',
    LEFT(column_name, 3),
    '\' TYPE,',
    RIGHT(column_name, 4),
    ' YEAR, \'',
    SUBSTR(column_name, 4, 3),
    '\' MONTH,',
    column_name,
    ' VALUE FROM yourtable')
  SEPARATOR ' UNION ALL ')
FROM information_schema.COLUMNS
where
  table_name = 'yourtable'
  AND (column_name LIKE 'CAT%' OR column_name LIKE 'ODB%' OR column_name LIKE 'GPA%')
INTO @sql;

prepare stm from @sql;
execute stm; 
```

请[在此处](http://sqlfiddle.com/#!2/ff6223/1)查看小提琴。

# asp.net-mvc - 用于移动应用的 REST API 上的 OAuth

> ID：15648171
> 
> 赞同：5
> 
> 时间：2013-03-26T21:58:46.870
> 
> 标签：asp.net-mvc, rest, mobile, oauth, asp.net-web-api

我正在开发一个移动应用程序的后端，使用 ASP.NET MVC 4 Web Api 构建一个 RESTful API。该应用程序将在 iOS 和 Android 上运行。我的用户只能使用他们的 Facebook 帐户登录，并且只有在登录后，他们才能使用整个功能。

我对移动应用程序没有太多经验，这更像是一个设计问题：对于谁应该负责 facebook 身份验证，这两种场景中的哪一种（或者可能是第三种？）对您来说似乎更好：

1.  移动客户端负责。在不访问后端的情况下，它直接与 facebook 对话，允许用户输入他的凭据，当它从 facebook 获取令牌时，它第一次访问后端，在每个请求中将令牌传递给它。
2.  后端 API 负责。移动客户端尝试从中访问资源。后端没有从客户端获取身份验证令牌，因此它重定向到 facebook 登录。用户输入凭据，facebook 回复通过令牌的后端。然后，后端愿意回答有关所需资源的客户端响应。

当然，第二种情况意味着后端应该使用像[DotNetOpenAuth](https://nuget.org/packages/DotNetOpenAuth)这样的包来处理 OAuth，而在第一种情况下，这些都发生在移动客户端中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T12:51:03.650

我认为第一种方法更正确，因为它更好地模拟了 http 的无状态性质（它相当于传统的 http auth 方法，如 Basic Auth）。您将在每次调用时将 facebook OAuth 令牌发送到 Web api。否则，服务器需要使用某种机制（例如 cookie）以某种方式保持有关经过身份验证的用户的状态，这首先看起来不正确。仅当服务器需要使用其他需要身份验证的服务时，我才会使用服务器端身份验证，但这看起来确实像您的情况。

# java - 从 java servlet 运行命令行 php 脚本

> ID：15648181
> 
> 赞同：2
> 
> 时间：2013-03-26T21:59:19.937
> 
> 标签：java, php, servlets, command-line, execution

有没有办法从 javaservlet 运行 php 命令行脚本（服务器端）？我一直在尝试，我没有得到任何异常，但是脚本并没有按照它应该做的那样做。我不知道我是否违反了任何安全规则（就像小程序一样）。我正在使用这段代码：

```
Runtime runtime = Runtime.getRuntime();
Process process = null;
try
{
    process = runtime.exec("php " + "wsaa-client.php wsfe" + " wsfe");
}
catch(Exception e)
{
    out.println("<h4>Runned!</h4>");
} 
```

一切看起来都很好。即使我有一个正在运行的进程名为：php-cgi.exe

任何帮助/建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-02T05:53:30.113

您可以尝试使用 PHP 和 wsaa-client.php 文件的绝对路径。还请捕获异常并打印出异常。

# ajax - 使用 jquery mobile ajax - 我的日历仅在我刷新页面后出现？

> ID：15648182
> 
> 赞同：2
> 
> 时间：2013-03-26T21:59:22.697
> 
> 标签：ajax, jquery, jquery-mobile

不知道如何表达这个问题，但是当我使用 jquery mobile 从我的索引页面移动到我的 events.html 页面时，我的日历不会出现，直到我按下浏览器上的刷新按钮。有谁知道我可能会错过什么，我确定它与来自其他页面的 ajax 调用有关

```
 <!DOCTYPE HTML>
<html>
<head>
      <meta charset="utf-8" />
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>
        </title>
        <link rel="stylesheet" href="https://s3.amazonaws.com/codiqa-cdn/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <link rel="stylesheet" href="css/my.css" />
        <script src="https://s3.amazonaws.com/codiqa-cdn/jquery-1.7.2.min.js">
        </script>
        <script src="https://s3.amazonaws.com/codiqa-cdn/mobile/1.2.0/jquery.mobile-1.2.0.min.js">
        </script>
        <!--added for calendar-->
         <link rel="stylesheet" type="text/css" href="../css/mdp.css">
        <link rel="stylesheet" type="text/css" href="../css/prettify.css">
    <script type="text/javascript" src="../js/prettify.js"></script>
        <script type="text/javascript" src="../js/lang-css.js"></script>
        <script type="text/javascript">
        $(function() {
            prettyPrint();
        });
        </script>

        <script type="text/javascript" src="../js/jquery.ui.core.js"></script>
        <script type="text/javascript" src="../js/jquery.ui.datepicker.js"></script>
    <!-- loads mdp -->
        <script type="text/javascript" src="../jquery-ui.multidatespicker.js"></script>

        <!-- mdp demo code -->
        <script type="text/javascript">
        <!--
            var latestMDPver = $.ui.multiDatesPicker.version;
            var lastMDPupdate = '2012-03-28';

            $(function() {
                $('.mdp-version').text('v' + latestMDPver);
                $('#mdp-title').attr('title', 'last update: ' + lastMDPupdate);
                $('#with-altField').multiDatesPicker({
    altField: '#altField'
            });
            });
        </script>

</head>
<body>
   <div data-role="page" id="index">
            <div data-theme="a" data-role="header">
                <h3>
                   Create Event
                </h3>
            </div>

        <div data-role="content">
                <form id="newevent" >
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput1">
                                Event
                            </label>
                            <input name="" id="textinput1" placeholder="" value="" type="text" />
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textarea1">
                                About
                            </label>
                            <textarea name="" id="textarea1" placeholder="">
                            </textarea>
                        </fieldset>
                    </div>
                            <div id="with-altField"></div>
                            <input type="hidden" id="altField" name="dates">
                    <input value="Submit" type="submit" />
                </form>
            </div>

    </div>
</body> 
```

一旦我刷新，日历就会出现在这里

```
<div id="with-altField"></div> 
```

这是页面会调用上面的内容

```
<!DOCTYPE HTML>
<html>
<head>
      <meta charset="utf-8" />
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>
        </title>
        <link rel="stylesheet" href="https://s3.amazonaws.com/codiqa-cdn/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <link rel="stylesheet" href="css/my.css" />
        <script src="https://s3.amazonaws.com/codiqa-cdn/jquery-1.7.2.min.js">
        </script>
        <script src="https://s3.amazonaws.com/codiqa-cdn/mobile/1.2.0/jquery.mobile-1.2.0.min.js">
        </script>

<script>
function id1() {
    $.ajax({
        type: 'POST',
        cache: false,
        url: 'some.php',
        dataType: 'json',
        success: function(data) {
            console.log(data.key); // Outputs "value"
            console.log(data.key2); // Outputs "value2"
        }
    });
    return false;
}
</script>

</head>
<body onload="id1()">
   <div data-role="page" id="index">
            <div data-theme="a" data-role="header">
                <h3>
                   Options
                </h3>
            </div>

             <div data-role="content">
        <ul data-role="listview" data-divider-theme="b" data-inset="true">
            <li data-role="list-divider" role="heading">
                Menu
            </li>
            <li data-theme="c">
                <a href="event.html" data-transition="slide">
                    Create Event
                </a>
            </li>
            <li data-theme="c">
                <a href="#page1" data-transition="slide">
                    Check Events
                </a>
            </li>
        </ul>
    </div>

    </div>
</body>

</html> 
```

我如何让它在内容中添加脚本

```
 <div id="content"></div>
            <script>
                $(function(){
                $("#content").load(("new-event.php"), function(){
        //    $('#content').load($('new-event.php').attr('href'), function () {
                $('#content').trigger("create");
            }).trigger("create");
            return false;

    });
    </script>
rest of code and other scripts

<div> 
```

# url - 我该如何使用#！而不仅仅是在 Durandal URL 中的 #？

> ID：15648183
> 
> 赞同：3
> 
> 时间：2013-03-26T21:59:23.470
> 
> 标签：url, durandal, fragment-identifier, hashbang

默认情况下，使用 Durandal 路由器创建的 URL 的格式如下：

[http://example.com/#/whiskey-tango-foxtrot](http://example.com/#/whiskey-tango-foxtrot)

但是，我想使用 #! 出于 SEO 目的，因此 URL 如下所示：

[http://example.com/#!/whiskey-tango-foxtrot](http://example.com/#!/whiskey-tango-foxtrot)

有关我的意思的更多信息，请参阅：[https ://developers.google.com/webmasters/ajax-crawling/](https://developers.google.com/webmasters/ajax-crawling/)

知道如何使用 Durandal 完成此任务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:09:58.417

您可能必须覆盖路由器插件，例如功能“preparerouteInfo”和其他（cancelNavigation）

# sql - 计算表中字段重复超过 5 次的行数

> ID：15648193
> 
> 赞同：-4
> 
> 时间：2013-03-26T22:00:00.707
> 
> 标签：sql, count

在表格中获得了用户帐户列表，并附有 IP。

我需要运行一个查询，只显示具有超过 5 个相同 IP 的行。

我确实有一个查询，但我失去了它

（我需要返回 ID、USERNAME 和 LAST_IP）- LAST_IP 也是存储 IP 以进行计数的位置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:08:22.777

听起来你需要做这样的事情：

SELECT ID, USERNAME, LAST_IP, count(*) as CNT from TABLE_NAME group by ID, USERNAME, LAST_IP HAVING count(*) > 5 ORDER BY CNT DESC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:18:24.407

这是一个例子：

```
declare @table table (user_id int identity(1, 1), user_name varchar(100), last_ip varchar(50))

insert into @table (user_name, last_ip) values ('joe moe', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('xyz', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('dummy', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('harry potter', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('he who should not be named', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('times square', '192.168.0.XX')
insert into @table (user_name, last_ip) values ('user1', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('user2', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('user3', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('user4', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('user5', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('user6', '192.168.0.YY')
insert into @table (user_name, last_ip) values ('tom dick harry', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('peter pan', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('humpty dumpty', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('red riding hood', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('tintin', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('mickey mouse', '192.168.0.ZZ')
insert into @table (user_name, last_ip) values ('only user', '192.168.0.AA')

select a.* from @table a
inner join
(
    select last_ip, count(*) as cnt from @table
    group by last_ip
    having count(*) > 5
) allCounts
on a.last_ip = allCounts.last_ip 
```

# mapping - 在 MS 动力学中填充查找字段

> ID：15648195
> 
> 赞同：0
> 
> 时间：2013-03-26T22:00:16.450
> 
> 标签：mapping, dynamics-crm-2011, guid, lookup

[这是这个](https://stackoverflow.com/questions/15373528/finding-lookup-item-numerical-values-in-ms-dynamics)问题的后续问题。我正在尝试通过 Freeform 将 Web 表单数据发送到 MS Dynamics 2011。我们构建了一个扩展来将数据发送到 MS Dynamics，它的构建方式是我们可以根据需要添加其他字段收集该数据。

感谢该线程中的几个耐心的人，以及我的更多研究，我现在已经通过我的头骨得到了它，查找值没有数值，而是唯一的 ID (GUID)。我什至想出了如何识别查找值的 GUID。但是，当我用 GUID 构建一个数组以将字段数据映射到 MS Dynamics 时，它并没有填充。

这是一些代码：

```
$configData['fieldMapping'] = array(
    'first_name' => array('name' => 'firstname', 'value' => null),
    'last_name'  => array('name' => 'lastname', 'value' => null),
    'email' => array('name' => 'emailaddress1', 'value' => null),
    'email_address' => array('name' => 'emailaddress1', 'value' => null),
    'phone' => array('name' => 'telephone2', 'value' => null),
    'credit_history' => array(
        'name' => 'new_selfreportedcredithistory', 
        'value' => array(
            'excellent' => 100000000,
            'Good'          => 100000001,
            'Fair'          => 100000002,
            'Poor'          => 100000003,
            'Bad'           => 100000005,
        )
    ),
    'campaign_name' => array(
        'name' => 'campaignid', 
        'value' => array(
            'USDA' => 'B53EA05A-2C29-E211-8C3A-78E3B5101ED7',
            'Radio Ads'             => '8F254BB4-5575-E211-8AAB-78E3B510ED7',
            'Postcards'             => '4F8E216D-9C1D-E211-8DA=-78E3B508542D',
        )
    ),
    'how_referred' => array('name' => 'leadsourcecode', 'value' => null)
); 
```

我在 GUID 周围加上了引号，因为当我没有将它们放在引号中时，我收到了来自 Dreamweaver 的 PHP 语法错误警告。但是，当我测试我的一个表单并在表单中传回其中一个文本值（左列）时，它的 GUID 在此处被标识，该字段仍然没有映射。credit_history 字段映射得很好 - 但这将进入选项集字段，而不是查找字段。我刚刚复制了选项集字段映射，因为它看起来可能会起作用：它正在构建一个数组以将我们的表单可能发送的内容“转换”为 MS Dynamics 可以识别该字段的值，从而知道如何填充数据.

有没有人知道为什么这可能不起作用？或者，我的问题是否有点含糊不清？（我知道我没有给你扩展的完整代码——虽然我们计划再次雇用这个小组来对扩展进行不同的更改，虽然我们可以要求他们映射这些字段......我'如果可以的话，我希望自己能够弄清楚。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T03:51:07.933

我不知道您在做什么，也不知道它是如何工作的，但是在 CRM SDK 本身中，查找字段实际上是 type `EntityReference`，其中包含 GUID 和查找实体类型的实体逻辑名称。因此，无论您的数据翻译过程是什么，它都需要接受实体逻辑名称（全部小写）。在你的情况下看起来像`campaign`......

# php - 如何为 wordpress 主题选项做动态功能

> ID：15648197
> 
> 赞同：1
> 
> 时间：2013-03-26T22:00:20.470
> 
> 标签：php, wordpress

我正在研究一个 wordpress 主题，我想知道在 wp-admin 中显示选项时如何做一个更干净的代码。

现在，我的代码如下：

```
...    

<?php $field_key = 'logo_retina'; if ( ! isset( $options[$field_key] ) ) $options[$field_key] = '';?>
                <tr valign="top"><th scope="row"><?php _e( 'Logo HQ', 'yes' ); ?></th>
                    <td><input id="<?php echo $field_key; ?>" class="regular-text" type="text" name="yes_theme_options[<?php echo $field_key; ?>]" value="<?php esc_attr_e( $options[$field_key] ); ?>" /></td>
                </tr>

            <?php $field_key = 'logo_non_retina'; if ( ! isset( $options[$field_key] ) ) $options[$field_key] = ''; ?>
                <tr valign="top"><th scope="row"><?php _e( 'Logo SQ', 'yes' ); ?></th>
                    <td><input id="<?php echo $field_key; ?>" class="regular-text" type="text" name="yes_theme_options[<?php echo $field_key; ?>]" value="<?php esc_attr_e( $options[$field_key] ); ?>" /></td>
                </tr>

            <?php $field_key = 'slogan_retina'; if ( ! isset( $options[$field_key])) $options[$field_key] = ''; ?>
                <tr valign="top"><th scope="row"><?php _e( 'Slogan HQ', 'yes' ); ?></th>
                    <td><input id="<?php echo $field_key; ?>" class="regular-text" type="text" name="yes_theme_options[<?php echo $field_key; ?>]" value="<?php esc_attr_e( $options[$field_key] ); ?>" /></td>
                </tr>

... 
```

原来的代码不止这三种形式。

我想要做的是显示这个选项，但是是动态的。我的意思是，例如，在 php 中只有一个函数。我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:08:15.717

这是我在为主题定义自定义选项时使用的函数。

要将动态字段添加到自定义选项，请使用以下字段添加到**$options数组：**

**“名称”**是将显示在管理面板中的显示。例如“Facebook URL”

**“desc”**是显示在字段下方的文本。例如“您的 Facebook 页面的完整 HTTP URL”

**“id”**是您在获取设置值时将在主题中使用的变量。

**“类型”**是要显示的字段类型。这些选项可以是文本字段的“文本”、文本区域字段的“文本区域”或标题中断的“标题”。标题分隔符可让您对不同的字段进行分类。

只需要**“姓名”**和**“身份证”**。

```
$options =  
array( 
    array("name" => " Options", "type" => "title"),
    array("type" => "open"), 
    array("name" => "", "desc" => "", "id" => "", "type" => "text"),
    array( "type" => "close")
);  

function mytheme_add_admin() {

    global $shortname, $options;

    if($_GET['page'] == basename(__FILE__)) {
        if($_REQUEST['action'] == 'save') {

            foreach($options as $value) {
                update_option( $value['id'], $_REQUEST[ $value['id'] ] ); 
            }

            foreach($options as $value) {
                if(isset($_REQUEST[ $value['id']])) { 
                    update_option($value['id'], $_REQUEST[$value['id']]); 
                } else { 
                    delete_option( $value['id'] ); 
                } 
            }

            header("Location: themes.php?page=functions.php&saved=true");
            die;

        } else if($_REQUEST['action'] == 'reset') {

            foreach($options as $value) {
                delete_option($value['id']); 
            }

            header("Location: themes.php?page=functions.php&reset=true");
            die;

        }
    }

    //add_menu_page(get_bloginfo('name') . " Options", "Theme Settings", 'administrator', basename(__FILE__), 'mytheme_admin', '', '63.3');
    add_submenu_page('themes.php', get_bloginfo('name') . " Options", 'Theme Settings', 'administrator', basename(__FILE__), 'mytheme_admin');

}

function mytheme_admin() {
    global $shortname, $options;
    if($_REQUEST['saved']) echo '<div id="message" class="updated fade"><p><strong>'.get_bloginfo('name').' settings saved.</strong></p></div>';
    if($_REQUEST['reset']) echo '<div id="message" class="updated fade"><p><strong>'.get_bloginfo('name').' settings reset.</strong></p></div>';
?>

<div class="wrap">
<h2><?php echo get_bloginfo('name'); ?> Settings</h2>

    <form method="post" style="background-color:#f8f8f8; padding:10px; margin-top: 10px;">

    <?php foreach ($options as $value) {
    switch ( $value['type'] ) {

    case "open":
    ?>
    <table width="100%" border="0">

    <?php break;

    case "close":
    ?>

    </table>

    <?php break;

    case 'text':
    ?>

    <tr>
    <td width="20%" rowspan="2" valign="middle"><strong><?php echo $value['name']; ?></strong></td>
    <td width="80%"><input style="width:400px;" name="<?php echo $value['id']; ?>" id="<?php echo $value['id']; ?>" type="<?php echo $value['type']; ?>" value="<?php if ( get_settings( $value['id'] ) != "") { echo stripslashes(get_settings($value['id'])); } else { echo stripslashes($value['std']); } ?>" /></td>
    </tr>

    <tr>
    <td><small><?php echo $value['desc']; ?></small></td>
    </tr><tr><td colspan="2" style="margin-bottom:5px;border-bottom:1px dotted #000000;">&nbsp;</td></tr><tr><td colspan="2">&nbsp;</td></tr>

    <?php
        break;
        case 'heading':
    ?>

    <tr>
        <td width="100%" colspan="2" valign="middle"><h3><?php echo $value['name']; ?></h3></td>
    </tr>

    <?php
    break;

    case 'textarea':
    ?>

    <tr>
    <td width="20%" rowspan="2" valign="middle"><strong><?php echo $value['name']; ?></strong></td>
    <td width="80%"><textarea name="<?php echo $value['id']; ?>" style="width:400px; height:200px;" type="<?php echo $value['type']; ?>" cols="" rows=""><?php if ( get_settings( $value['id'] ) != "") { echo stripslashes(get_settings($value['id'])); } else { echo stripslashes($value['std']); } ?></textarea></td>

    </tr>

    <tr>
    <td><small><?php echo $value['desc']; ?></small></td>
    </tr><tr><td colspan="2" style="margin-bottom:5px;border-bottom:1px dotted #000000;">&nbsp;</td></tr><tr><td colspan="2">&nbsp;</td></tr>    
    <?php break;

    }
    }
    ?>

    <input name="save" type="submit" class="button-primary" value="Save changes" />
    <input type="hidden" name="action" value="save" />
    </form>

    <?php
    }

add_action('admin_menu', 'mytheme_add_admin'); 
```

以下是从自定义设置中获取设置值的方法：

```
<?php
    global $options;
    foreach ($options as $value) {
        if(get_settings($value['id']) === FALSE) { $$value['id'] = stripslashes($value['std']); } else { $$value['id'] = stripslashes(get_settings($value['id'])); }
    }
?> 
```

你把它放在你需要获取设置的文件的顶部。变量将与您在上面定义的“ID”相同。如果 ID 为“ **facebook** ”，则 PHP 变量将为**$facebook**。

# jquery - 返回 false 在单击提交按钮时不起作用

> ID：15648200
> 
> 赞同：0
> 
> 时间：2013-03-26T22:00:30.520
> 
> 标签：jquery, asp.net-mvc

相同的功能正在其他页面上运行，但在这里它调用了该功能，显示警报但仍然表单提交并返回 false 不起作用.....我正在使用视图剃须刀

```
@using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data" })) 
```

这是我的提交按钮

```
<input type="submit" value="Submit" id="demo-submit-button"/> 
```

非常感谢

```
 $(function () {
        $('form').submit(function () {
            //alert($("input[type=radio]:checked").val());
            if ($("input[type=radio]:checked").val() == "True") {
                //Logo Image
                var selectedFile = $('#imgfile').val();
                if (selectedFile == "") {
                    alert('please select valid image logo for marketplace');
                    return false;
                } 
                else {
                    var fileExtension = ['jpeg', 'jpg', 'png', 'gif', 'bmp'];
                    if ($.inArray($('#imgfile').val().split('.').pop().toLowerCase(), fileExtension) == -1) {
                        alert("You are permited to select only '\n.jpeg','.jpg', '.png', '.gif', '.bmp' formats are allowed.");
                        return false;
                    }
                }

                //Screenshots
                if ($('#ssimgfile').val() == "" || $('#ssimgfile1').val() == "" || $('#ssimgfile2').val() == "") {
                    alert('please select valid screenshots for marketplace');
                    return false;
                }
                else {
                    var fileExtension = ['jpeg', 'jpg', 'png', 'gif', 'bmp'];
                    if ($.inArray($('#ssimgfile').val().split('.').pop().toLowerCase(), fileExtension) == -1 || $.inArray($('#ssimgfile1').val().split('.').pop().toLowerCase(), fileExtension) == -1 || $.inArray($('#ssimgfile2').val().split('.').pop().toLowerCase(), fileExtension) == -1) {
                        alert("You are permited to select only '\n.jpeg','.jpg', '.png', '.gif', '.bmp' formats are allowed.");
                        return false;
                    }
                    else {
                        return true;
                    }
                }
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:23:29.507

首先，您应该在表单中取消绑定提交事件。像这样使用：

```
<script>
$(function () {
    $('form').unbind('submit');

    $('form')
        .bind('submit', function () {
            var form = this;
            if ($("form").valid()) {
                $.post('/you/url', $(form).serialize(), function (data) {
                    if (data.success) {
                        //to do something
                    } else {
                        //to do something
                    }
                });
            }

            return false;
        });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T16:41:46.613

我只是将表单提交更改为提交按钮单击，尽管我不知道表单提交有什么问题，但它对我有用。

我在这里改变了什么

```
 $('#demo-submit-button').click(function () {
//my code
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:09:02.967

您需要“取消设置”按钮默认事件。

```
$('form').submit(function (event) {
  event.preventDefault();
  //Your code is here
}); 
```

# javascript - 拦截href时出现DOM异常18

> ID：15648201
> 
> 赞同：0
> 
> 时间：2013-03-26T22:00:32.457
> 
> 标签：javascript, html, event-handling

我在这里有一小段代码可以捕获任何标签点击...

```
var debug = Base.debug;
$(document).on('click', 'a', function () {
    if (debug) {
        console.log("Caught click going to '" + $(this).attr('href') + "'");
    }
    Base.push({ href: $(this).attr('href'), extra: "Caught href from 'a' element" });
    return false;
}); 
```

虽然我得到了它似乎是我使用它的时候`Uncaught Error: SecurityError: DOM Exception 18`，但是当我使用它时`push`它不会发生。

`push`仍然被称为任何一种方式。

我正在使用本地文件系统进行开发。就像`http`我使用的是`file`.

我还没有尝试过，`http`但我认为错误会根据其他问题消失。

实际的潜在错误是什么？实际上出了什么问题？其他人已经问过，但他们只得到了如何解决它的答案。我想了解它。

**编辑 1**

我将错误追踪到：

```
return m.isLastSavedState(f) ? m.busy(!1) : (m.storeState(f), m.expectedStateId = f.id, n.replaceState(f.id, f.title, f.url), m.Adapter.trigger(a, "popstate")), !0 
```

在`jQuery 1.9.1`

`Base.push`做一些小事情，比如将一些东西存储在本地存储中，然后`location.assign`使用给定的调用`href`

**编辑 2**

注释掉`Base.push`没有意义的调用时，我不再收到错误，因为当我调用`Base.push`它时，它运行良好，没有错误。而且点击仍在继续。返回 false 不会停止`href`继续。

`location.assign`我打电话和`a`被点击的元素之间有什么关系吗？

# c# - 将“foreach”循环的每个值存储到字符串数组中

> ID：15648204
> 
> 赞同：-4
> 
> 时间：2013-03-26T22:00:50.070
> 
> 标签：c#

考虑：

```
 string[] collection = new string[3]{"hi","hello","test"}; 
 string [] elements = new string [3];
 int index = 0;
 foreach(string anode in collection)
 {
   string[index++] = anode;
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:06:54.943

[https://stackoverflow.com/a/599373/1618257](https://stackoverflow.com/a/599373/1618257)：

```
List<string> elements = new List<string>();
foreach(xmlnode anode in somecollection)
{
  elements.Add("string");
} 
```

# java - java/spring/tiles - 显示来自多个实体的数据的优雅方式？

> ID：15648212
> 
> 赞同：0
> 
> 时间：2013-03-26T22:01:25.520
> 
> 标签：java, spring, jsp, jstl, el

我有一个 java/spring/tiles 应用程序——基本上是一个表单集合，每个表单都有一个支持实体对象。在这件事结束时，用户将填写至少一个或多达五个实体的数据。

我需要显示一个摘要屏幕，显示用户输入的所有数据。此时，我将知道用户输入了哪些对象，并且可以访问它们。我试图想出一种干净的方式来显示所有这些数据。我最初的想法是使用 jstl/el 来动态地将其全部吐出，但这很快就失控了。现在我正在考虑为每个对象执行此操作：

```
<c:if test="${not empty object1}">
    ${object1.field1}
    ${object1.field2}
</c:if>
...
<c:if test="${not empty object5}">
    ${object5.field1}
    ${object5.field2}
</c:if> 
```

我觉得必须考虑多达五个这样的对象很糟糕 - 它看起来很笨拙（而且每个对象有两个以上的字段）。有没有更好的方法来处理这种事情？我实际上对几乎任何解决方案都持开放态度，我只是在这里沿着 jstl 路径走，因为我认为有一种方法可以遍历每个对象的字段，但如果有的话我找不到示例。所以一些更漂亮的东西，或者只是像这样用jstl猛烈抨击它？任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:28:43.153

您可以创建一个`GenericFormObject`由所有表单对象实现的接口（例如：），并具有显示为 html 的方法（例如：）`getHtmlString()`。

然后，您可以将集合中的所有表单对象传递给您的视图，并在您的 JSP 中执行以下操作：

```
<c:forEach var="formObj" items="${formObjCollection}">
  ${formObj.htmlString}
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:11:47.310

覆盖对象的 toString() 方法并返回您希望显示字段的方式。然后打印对象本身。${objectX}。我相信您可以遍历所有对象。

# ios - Monotouch Google Analytics 应用程序版本

> ID：15648221
> 
> 赞同：1
> 
> 时间：2013-03-26T22:02:07.903
> 
> 标签：ios, xamarin.ios, google-analytics

我在我的 iOS 项目中使用 Google Analytics 绑定（[https://github.com/mono/monotouch-bindings/tree/master/GoogleAnalytics](https://github.com/mono/monotouch-bindings/tree/master/GoogleAnalytics)），除了未跟踪的应用程序版本外，一切似乎都运行良好. 当我在 Google Analytics 上看到报告时，应用程序版本总是**(not set)**。

这是我在应用程序中使用的代码：

```
var ga = GoogleAnalytics.GAI.SharedInstance;
ga.GetTracker("UA-XXXXXXXX-X");
ga.DefaultTracker.TrackView("Home Screen"); 
```

我是否缺少一些东西来让它跟踪我的应用程序版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T12:18:36.840

您必须实际设置应用程序版本才能使其正常工作。我不知道为什么谷歌让你这样做：

```
ga.DefaultTracker.AppVersion = NSBundle.MainBundle.InfoDictionary[new NSString("CFBundleVersion")].ToString(); 
```

这将匹配您在 Info.plist 中的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T21:43:31.747

使用新的 Google Analytics SDK，您需要使用以下代码

```
[GAI sharedInstance].defaultTracker.appVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"]; 
```

这将从您的 plist 文件中读取应用程序版本。

# asp.net - 与 AccessDataSource vb asp.net 一起使用时更新不起作用

> ID：15648225
> 
> 赞同：0
> 
> 时间：2013-03-26T22:02:28.310
> 
> 标签：asp.net, vb.net, sql-update

我在我的 asp.net 项目中使用 UPDATE 命令时遇到问题。该项目允许用户通过登录页面登录，该登录页面将用户名和密码与数据库中的记录相匹配，并将用户名保存为 cookie。然后我有一个设置页面，我希望允许用户编辑他们的帐户详细信息，但是当我使用 UPDATE 功能时，查询执行时没有任何错误，但更新不会发生。我正在使用 AccessDataSource 和 UpdateCommand，希望有人能发现我的代码存在问题并引导我朝着正确的方向前进。提前致谢

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)

    Dim sqlcmd As String
    sqlcmd = "SELECT FirstName, SecondName, UserName, DOB, Password FROM UserTable WHERE UserName = '" & Request.Cookies("UserInfo")("userName") & "'"
    AccessDataSource1.SelectCommand = sqlcmd

    If (Not Page.IsPostBack) Then

        Dim sqlcmd2 As String
        sqlcmd2 = "UPDATE [UserTable] SET [FirstName] = ?, [SecondName] = ?, [UserName] = ?, [DOB] = ?, [Password] = ? WHERE [UserID] = ? AND ISNULL (([FirstName] = ?) OR ([FirstName] IS NULL AND ? IS NULL)) AND (([SecondName] = ?) OR ([SecondName] IS NULL AND ? IS NULL)) AND (([UserName] = ?) OR ([UserName] IS NULL AND ? IS NULL)) AND (([DOB] = ?) OR ([DOB] IS NULL AND ? IS NULL)) AND (([Password] = ?) OR ([Password] IS NULL AND ? IS NULL))"
        AccessDataSource1.UpdateCommand = sqlcmd2

    End If

End Sub 
```

* * *

```
<form id="webform" runat="server">
    <div id="content">
     <asp:AccessDataSource ID="AccessDataSource1" DataSourceMode = "DataSet" runat="server" 
            ConflictDetection="CompareAllValues" DataFile="~/Database.mdb" 
            OldValuesParameterFormatString="original_{0}"  
            UpdateCommand = "UPDATE [UserTable] SET [FirstName] = ?, [SecondName] = ?, [UserName] = ?, [DOB] = ?, [Password] = ? WHERE [UserID] = ? AND ISNULL (([FirstName] = ?) OR ([FirstName] IS NULL AND ? IS NULL)) AND (([SecondName] = ?) OR ([SecondName] IS NULL AND ? IS NULL)) AND (([UserName] = ?) OR ([UserName] IS NULL AND ? IS NULL)) AND (([DOB] = ?) OR ([DOB] IS NULL AND ? IS NULL)) AND (([Password] = ?) OR ([Password] IS NULL AND ? IS NULL))">

         <UpdateParameters>
             <asp:Parameter Name="UserID" Type="Int32" />
             <asp:Parameter Name="FirstName" Type="String" />
             <asp:Parameter Name="SecondName" Type="String" />
             <asp:Parameter Name="UserName" Type="String" />
             <asp:Parameter Name="DOB" Type="String" />
             <asp:Parameter Name="Password" Type="String" />
             <asp:Parameter Name="original_UserID" Type="Int32" />
             <asp:Parameter Name="original_FirstName" Type="String" />
             <asp:Parameter Name="original_FirstName" Type="String" />
             <asp:Parameter Name="original_SecondName" Type="String" />
             <asp:Parameter Name="original_SecondName" Type="String" />
             <asp:Parameter Name="original_UserName" Type="String" />
             <asp:Parameter Name="original_UserName" Type="String" />
             <asp:Parameter Name="original_DOB" Type="String" />
             <asp:Parameter Name="original_DOB" Type="String" />
             <asp:Parameter Name="original_Password" Type="String" />
             <asp:Parameter Name="original_Password" Type="String" />
         </UpdateParameters>
        </asp:AccessDataSource>
        <asp:GridView ID="GridView1" runat="server" DataSourceID="AccessDataSource1">
            <Columns>
                <asp:CommandField ShowEditButton="True" />
            </Columns>
        </asp:GridView>
<div>
</div>
</div>
</form> 
```

抱歉，如果有点乱，但这是我的第一篇文章，我不完全确定我在做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T02:07:57.890

尝试添加

```
accessdatasource1.update() 
```

# php - 如何在 PDO 中使用/编写 mysql_real_escape_string？

> ID：15648228
> 
> 赞同：5
> 
> 时间：2013-03-26T22:02:39.443
> 
> 标签：php, mysql, pdo

在我的代码中，我试图将 mysql_real_escape_string 转换为 PDO 语句。有人有关于如何在 PDO 中编写 mysql_real_escape_string 的提示吗？

我在两行中使用 mysql_real_escape_string： $userName = mysql_real_escape_string($_POST['username']); $password = sha1(mysql_real_escape_string($_POST['password']));

```
<?php
ob_start();
session_start();
include("../database/db.php");

$userName = mysql_real_escape_string($_POST['username']);
$password = sha1(mysql_real_escape_string($_POST['password']));
echo "<br>user: " . $userName;
echo "<br> pw: " . $password;

$query = "select * from tbladmin where admin_usr_name='$userName' and admin_pwd='$password'";

$res = mysql_query($query);

// $rows = $res->fetch(PDO::FETCH_ASSOC); 
$rows = mysql_fetch_assoc($res);
echo "<br>numrows" . mysql_num_rows($res) . "<br>";

// $find = $query->prepare("select * from tbladmin where admin_usr_name='$userName' and admin_pwd='$password'");
// $find->execute();
// if ($find->fetchColumn() > 0)
// {
// echo 'You made it, welcome';
//  $_SESSION['userName']  =  $rows['admin_usr_name'];
//  $_SESSION['admin_id'] = $rows['admin_id'];
//  header("location: ../pages/content.php");
// }
// else
// {
//  echo 'Username and password dont match <br/> Try again';
//  header("location: ../index.php?loginerror=yes");
// } 

if(mysql_num_rows($res)>0)
{
    $_SESSION['userName']  =  $rows['admin_usr_name'];
    $_SESSION['admin_id'] = $rows['admin_id'];
    header("location: ../pages/content.php");
}
else
{
    echo 'Username and password dont match <br/> Try again';
    header("location: ../index.php?loginerror=yes");
} 
```

?>

这就是我试图用 PDO 做的事情

```
 $host = "localhost"; 
$user = "root"; 
$password = "root";
$db = "blog";

$dsn = "mysql:host=$host;dbname=$db;charset=utf8";
$opt = array(PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC);
$pdo = new PDO($dsn,$user,$password, $opt);

$username = $_POST['username'];
$password = $_POST['password'];
$query = "select * from tbladmin where admin_usr_name=:userName and admin_pwd=:passWord";

try 
{   
$databas = new PDO($dsn, $user, $password);
} 
catch (PDOException $e) 
{
echo 'Connection failed: ' . $e->getMessage();
}

$statement = $databas->prepare($query);

$statement->execute(array(':userName'=>$username, ':passWord'=> $password)); 
$row = $statement->fetch(); 
```

我总是收到此错误：调用非对象上的成员函数 prepare()

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T22:04:33.537

关键是通过使用带有参数化查询和绑定值的准备好的语句，您不需要诸如`mysql_real_escape_string`.

查看有关如何使用绑定值和参数化查询/准备语句的[PDO 文档。](http://php.net/manual/en/book.pdo.php)

关键是你会这样写一个 SQL 查询：

```
$query = $pdo->prepare("SELECT * FROM users WHERE username = ? and password = ?"); 
```

然后，您将传入绑定值来代替 ? 符号，因此查询只能按字面意思运行：

```
$query->bindParam(1, $username);
$query->bindParam(2, $password); 
```

任何类型的 SQL 注入尝试（例如`1'; DROP users --`在上面的变量中）都将不再起作用，因为它会按字面意思进行调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T22:09:20.183

你不需要在 PDO 中。至少，您很少需要这样做。

*   使用[参数化 SQL](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)。
*   [绑定你的参数](http://php.net/manual/en/pdostatement.bindparam.php)。
*   [PDO::QUOTE](http://docs.php.net/manual/en/pdo.quote.php)自动转义其字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:27:33.090

如前所述，您不必使用转义...因为通过将值与 ? 绑定可以更安全地处理它。或在 sql 语句中使用冒号命名

我会做这样的事情：

```
<?php
$username = $_POST['username'];
$password = $_POST['password'];
$query = "select * from tbladmin where admin_usr_name=:userName and admin_pwd=:passWord";

try {   
  $db = new PDO($dsn, $un, $pw);
} catch (PDOException $e) {
  echo 'Connection failed: ' . $e->getMessage();
}

$statement = $db->prepare($query);

//:userName and :passWord is set when actually executing the query
$statement->execute(array(':userName'=>$username, ':passWord'=> $password)); 
$row = $statement->fetch();
?> 
```

请注意， fetch() 只会返回一行（结果集中的下一行）。如果要访问整个记录集，可以通过 2 种方式执行此操作：

1.  **使用OR**循环遍历结果集`while() { }`
***   使用 `$rows = $statement->fetchAll();`并循环遍历数组 $rows**

 **将选项 1 与更大的结果集一起使用。

使用带有较小结果集的选项 2（你知道它不会增长这么多）

考虑是否应该设置 PDO::ATTR_EMULATE_PREPARES 的属性。更多关于这里的信息：[PDO MySQL: Use PDO::ATTR_EMULATE_PREPARES or not?](https://stackoverflow.com/questions/10113562/pdo-mysql-use-pdoattr-emulate-prepares-or-not)**

# javascript - JSON.parse 意外字符

> ID：15648231
> 
> 赞同：0
> 
> 时间：2013-03-26T22:02:57.623
> 
> 标签：javascript, jquery, ajax, json, mongodb

我有一个存储在 mongoDB 集合中的 JSON 对象。该对象表示 5 x 图像、5 y 图像和 tictactoe board 图像的位置。

每隔一段时间，我向一个用这个对象响应的 php 文件发送一个请求，然后我想解析那个对象并相应地移动这些片段。

这是我的要求：

```
$.getJSON
(
    "e4.php",
    "",
    function(data)
    {
        world = JSON.parse(data);
        moveObjects(world);
    }
); 
```

但我得到：JSON.parse：意外字符

当我 console.log 数据时，萤火虫给了我正确的对象，所以我知道它正在正确返回。

在 e4.php 中：

```
$criteria = array("name" => "world");

$doc = $collection->findOne($criteria);

$conn->close();

print $doc['world']; 
```

其中 conn 是连接，而 collection 是我正在使用的集合。

数据库在 e3.php 中更新：

```
$encodedworld = $_REQUEST['data'];

$criteria = array("name" => "world");

$doc = $collection->findOne($criteria);

$doc['world'] = $encodedworld;

$collection->save($doc);

$conn->close();

print $encodedworld; 
```

有任何想法吗？我很难过

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:05:49.907

jQuery[`getJSON`](http://api.jquery.com/jQuery.getJSON/)为您反序列化 JSON，因此`data`将是一个对象图，而不是一个字符串。从文档中：

> 回调传递返回的数据，该`success`数据通常是由 JSON 结构定义并使用该`$.parseJSON()`方法解析的 JavaScript 对象或数组。

因此，由于`data`已经*反*序列化，您不需要或不需要调用`JSON.parse`它。这样做会隐式调用`toString`on `data`，这将返回`[object Object]`or `[object Array]`，因此`JSON.parse`不喜欢将其作为输入。:-)`data`直接使用：

```
$.getJSON
(
    "e4.php",
    "",
    function(world)         // <=== Changed name of argument
    {
        moveObjects(world); // <=== Used it directly
    }
); 
```

* * *

另外：除非您在未显示的地方声明，否则您的代码也会成为[*The Horror of Implicit Globals 的*](http://blog.niftysnippets.org/2008/03/horror-of-implicit-globals.html)`world`牺牲品。你可能想在那里。但是有了上面的改变，你根本不需要这个变量，所以......[](http://blog.niftysnippets.org/2008/03/horror-of-implicit-globals.html)*`var`*

# java - java中的菜单方法

> ID：15648233
> 
> 赞同：0
> 
> 时间：2013-03-26T22:03:09.847
> 
> 标签：java, methods

我想通过指令方法打印菜单，但程序什么也不执行。谁能告诉我如何解决这个问题。

**这是类中的方法声明..**

```
public class Factorial 
{

    public void instructions()
    {
        System.out.printf("Enter your choice:\n",
        " 1 to calculate a factorial value of an integer.\n",
        " 2 to calculate mathematical constant e.\n",
        " 3 to calculate e^x.\n",
        " 4 to end.\n");        
    }  // End of instructions
} 
```

**这是从 Factorial 类调用指令方法的主要方法。**

```
import java.util.Scanner;    // Program uses scanner. 

public class behzat
{ 

    private static Scanner input;

    public static void main(String[] args)
    {

        Factorial myfactorial = new Factorial();
        myfactorial.instructions();  

    }    

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:05:32.033

类定义以大写字母开头。尝试：

```
Factorial myfactorial = new Factorial();
myfactorial.instructions(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:11:21.133

您正在使用 printf，它的第一个参数实际上是一个格式字符串，它将根据该格式打印*下一个参数。*

因此，即使忽略阶乘和阶乘之间的类名错误，您的代码也应该只打印`"Enter your choice:\n"`.

您需要使用 print 代替：

```
System.out.print("Enter your choice:\n" +
    " 1 to calculate a factorial value of an integer.\n" +
    " 2 to calculate mathematical constant e.\n" +
    " 3 to calculate e^x.\n" +
    " 4 to end.\n"); 
```

请注意，此函数只有一个参数，此处使用字符串连接分隔，以便于阅读。

# powershell - 如何在 PowerShell 中运行 Konami 代码？

> ID：15648234
> 
> 赞同：0
> 
> 时间：2013-03-26T22:03:11.993
> 
> 标签：powershell, powershell-2.0, powershell-3.0

我已经创建了一个 PowerShell 脚本（GUI 表单），并且我拥有我想要使用的所有功能。

但是可以在 PowerShell 脚本中运行 Konami 代码吗？

如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:36:35.173

尝试这样的[事情](http://www.vexasoft.com/pages/send-keyboardinput)。它是第三方，所以使用风险自负。

# php - 输出多批数据，只输出一个

> ID：15648238
> 
> 赞同：0
> 
> 时间：2013-03-26T22:03:14.410
> 
> 标签：php, html, sql, database

错误

你们可以提供的任何帮助将不胜感激，我期待收到您的来信，Qwerty。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:29:32.440

而不是

```
$don2=mysql_fetch_assoc(
    mysql_query(... 
```

尝试

```
$results2 = mysql_query(... 
```

然后做

```
while (($don2 = mysql_fetch_assoc($results2)) !== false) {
    echo '<h2...
} 
```

`mysql_query`设置要运行的查询。`mysql_fetch_assoc`实际上一次拉下一行。因此，您想在剩余行时循环。

# java - Java中的hasNextDouble方法有问题

> ID：15648242
> 
> 赞同：1
> 
> 时间：2013-03-26T22:03:34.587
> 
> 标签：java, validation, while-loop

在我的程序中，我让用户输入一个半径值，然后程序输出面积和周长。

我想确保用户输入一个数字，所以我使用了 hasNextDouble() 方法。但是，它并不能正常工作。

当程序运行我在下面的代码中加粗的第一个 while 循环（显然，我不能加粗代码，所以它是带有星号的代码）在下面的代码中时，“请输入数字 >”字样按预期显示。

但是，如果程序运行我加粗的第二个 while 循环（它嵌套在一个 while 循环中，用于测试来自用户的数字是否为正），“请输入一个数字 >”出现两次。

我不明白为什么这些词要打印两次。任何人都可以帮忙吗？

```
/**
 * Uses the Circle class to calculate area and perimeter of a circle based on a user-provided radius.
 * 
 * @author Brittany Gefroh
 * @version 1.0
 */

//Import the Scanner class
import java.util.Scanner;

public class CircleTest
{
public static void main (String [] args)
{
    //Initialize a Scanner object
    Scanner scan = new Scanner(System.in);

    //Create new Circle object
    Circle circle1 = new Circle();

    //Declare variables
    double input;
    String garbage;
    String answer;

    //Do/while loop answer is Y or y
    do
    {
        //Ask user for a radius value
        System.out.print("Enter a radius value > ");

        **while ( ! scan.hasNextDouble())
        {
            garbage = scan.nextLine();
            System.out.print("\nPlease enter a number > ");
        }**

        //Assign user input to the input variable
        input = scan.nextDouble();

        //Test if input is a positive number
        while (input <= 0)
        {
            //Prompt user for a new radius value
            System.out.println("Radius must be greater than 0");
            System.out.print("\nEnter a radius value > ");

            **while ( ! scan.hasNextDouble())
            {
                garbage = scan.nextLine();
                System.out.print("\nPlease enter a number > ");
            }**

            //Assign user input to the input variable
            input = scan.nextDouble();
        }

        //Run the setRadius method to change the radius
        circle1.setRadius(input);

        //Print blank space
        System.out.println("");

        //Display output
        System.out.println("The radius is " + circle1.getRadius());
        System.out.println("The area is " + circle1.getArea());
        System.out.println("The perimeter is " + circle1.getPerimeter());

        //Print blank space
        System.out.println("");

        //Ask user if he/she wants to try again
        System.out.print("Would you like to try again? Y or N > ");
        answer = scan.next();

        //Print blank space
        System.out.println("");

    }while (answer.equalsIgnoreCase("Y"));

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:23:57.097

改变：

```
answer = scan.next(); 
```

至：

```
scan.nextLine();
answer = scan.nextLine(); 
```

也许您应该尝试通过创建一个专门的方法来简化此代码，以读取带有验证的双精度？也试着想想为什么你有这些“空”的 nextLine() 操作。这些有必要吗？

编辑...

问题是`scan.nextDouble();`不要删除 EOL 标记（行尾）。与`scan.next();`. 那是你的问题。EOL 标记由*while*条件分析，它显示：

```
"Please enter a number > " <immediate EOL answer which was left in scanner>
"Please enter a number > " <now we are waiting for user input> 
```

# android - Android：Google Play 商店假退款

> ID：15648244
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:03:37.437
> 
> 标签：android, google-play

我在 Play Store 上发布的应用有 4 次退款，但在 Google Play 开发者控制台中，我看到在“安装活动/总计”部分我的应用有 71/71。看起来要求退款的人现在已经在他们的设备中安装了该应用程序。可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:08:49.813

好吧，如果安装了应用程序，然后用户失去了互联网连接，因此设备不知道它已被退款并且尚未卸载它，这是可能的。

也有可能统计信息尚未更新以反映卸载情况（每 24 小时一次）

也有可能确实发生了 4 次卸载，但其他用户将其安装在多个设备上（单个 Google 帐户可能会在无限设备上安装购买的应用程序，并且它们都将显示为单独安装）

# css - 在使用 CSS 单击父 div 后，使 div 出现并保留

> ID：15648245
> 
> 赞同：1
> 
> 时间：2013-03-26T22:03:42.103
> 
> 标签：css, html, css-selectors

我希望`display:hidden;`在单击父 div 后出现一个 div（当前），并使用 CSS 留在那里。

我目前已经让它在“点击”时出现`:active`，但是只要我放开鼠标按钮，div就会消失。

单击后如何使 Div 保持原位？

我试过了`:visited`，`:focus`没有运气，有什么建议吗？

我是新手，所以很确定我在这里的某个地方犯了错误。如果再次单击父 div，则 div 消失会更好。

我将衷心感谢您的帮助。谢谢你。

```
<html  xmlns="http://www.w3.org/1999/xhtml">
<head>
<style type="text/css">

.container .l-col, .r-col {
display: none;
}

.container {
cursor: pointer;
}

.container:active .l-col {
display: block;
clear: left;
float: left;
width: 50%;
height: 50%;
}

.container:active .r-col {
display: block;
float: right;
width: 50%;
height: 50%;
}

</style>

</head>
<body>
<div id="portfolio" class="container">
<h2>Parent Element</h2>
<div class="l-col">
<h3>Left Col</h3>
<p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.</p>
</div>
<div class="r-col">
<h3>Right Col</h3>
<p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.</p>
</div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:27:56.577

[使用jQuery UI 手风琴](http://jqueryui.com/accordion/)可以节省大量时间和精力

```
<script>
$(function() {
        $(".accordion").show().accordion({
            heightStyle: "content",
            collapsible: true,
            active: false,
            animate: {
                duration: 1000,
                easing: 'easeOutBounce'
            },
        });
    })
    </script> 
```

请注意，您可以随意设置此插件的样式，

```
.accordion {/* some style*/}

.ui-accordion-content {/* some style*/}

.accordion h6 {/* some style*/} 
```

这是一个[jsFiddle](http://jsfiddle.net/apaul34208/M3mEX/)，它显示了我如何滥用手风琴小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T02:18:40.627

您可以使用 CSS3 动画来实现您的目标，但它不会跨浏览器兼容.. IE 用户会失去这个..

```
/* <yourstylesheet>.css */
@keyframes box_appear
{
from {opacity: 0;}
to {opacity: 1;}
}

@-moz-keyframes box_appear/* Firefox */
{
from {opacity: 0;}
to {opacity: 1;}
}

@-webkit-keyframes box_appear /* Safari and Chrome */
{
from {opacity: 0;}
to {opacity: 1;}
}

@-o-keyframes box_appear /* Opera */
{
from {opacity: 0;}
to {opacity: 1;}
}

.make_me_appear
{
animation: box_appear 5s;
-moz-animation: box_appear 5s; /* Firefox */
-webkit-animation: box_appear 5s; /* Safari and Chrome */
-o-animation: box_appear 5s; /* Opera */
} 
```

* * *

```
<script type="text/javascript">

document.getElementById('<youroutsideelementsidhere>').onclick = function() {
    // Apply the class to the child elements here.
}

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:22:27.293

CSS 没有您正在寻找的功能。您将不得不使用 JavaScript。

这里有一些 JavaScript 可以帮助您入门。将其放在`</body>`结束标记之前：

```
<script type="text/javascript">
    document.getElementById("portfolio").onclick = function(){
         this.className = "container-clicked";
    };
</script> 
```

`container-clicked`然后为类添加样式。

```
.container-clicked .l-col{
    display:block;
    ...
}
.container-clicked .r-col{
    display:block;
    ...
} 
```

另外，有几点：我认为 :visited 伪类对您不起作用，因为 .container 不是链接。但是，如果它是一个链接，那么 :visited 样式将在页面刷新后保留，我认为这不是您想要的。

希望这可以帮助

# java - 图形窗口中的基本弹跳球

> ID：15648250
> 
> 赞同：0
> 
> 时间：2013-03-26T22:03:57.927
> 
> 标签：java, graphics

我正在尝试创建一个简单的动画，使 GOval 球从图形窗口的底部和顶部反弹，一次又一次地向上和向下，直到我退出窗口。问题是我不明白如何让球识别图形窗口的底部并开始以另一种方式反弹。换句话说，球永远不会从地板上反弹，它只是不断下落，最终从屏幕底部消失。
只要i < STEPS，球就应该向下移动，这是思考这个问题的正确方法吗？我不明白球弹起来然后又弹下来的条件应该是什么。

```
import acm.program.*;
import acm.graphics.*;

public class BouncingBall extends GraphicsWindow{
    public void run(){
        GOval ball = new GOval(0, 0, OVAL_SIZE, OVAL_SIZE);
        ball.setFilled(true);
        add(ball);

        int dx = 0;
        int dy = 1;

        while(true) {
            int i = 0;
            if ( i < STEPS) {
                ball.move(dx, dy);
                pause(PAUSE_TIME);
            } 
            if (??) {
                ball.move(dx, - dy);
                pause(PAUSE_TIME);
            }
            i++;
        }
    }

    private static final STEPS = 1000; 
    private static final OVAL_SIZE = 25; 
    private static final PAUSE_TIME = 7;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:12:42.293

你的意思是`GraphicsProgram`代替`GraphicsWindow`吗？

`GraphicsProgram`s 有一个`getHeight()`方法可以告诉你你的窗户有多高。所以在这种情况下：

```
if (ball.getY() + ball.getHeight() >= getHeight()) {
    dy = -dy;
} 
```

这将在球经过屏幕底部时反转球的 y 速度。如果您希望它来回弹跳，您可以为屏幕顶部编写类似的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:06:52.273

这里的基本算法是使用显示区域的大小和对象边界的大小来确定对象何时与显示区域的边缘发生碰撞。发生这种情况时，将速度矢量的适当元素取反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:17:03.500

您必须将方向存储在布尔值中，如下所示：

```
 boolean up=true;
  while(true){

  if (up){
  ball.move(dx, dy);
  pause(PAUSE_TIME);
  } 
  else
  {
  ball.move(dx, - dy);
  pause(PAUSE_TIME);
  }
  if(getHeight()<=ball.getHeight+ball.getY()||ball.getHeight()<=ball.getY){
  up=!up;      
  }
  } 
```

现在，如果球到达窗口的尽头，它会改变方向并朝相反的方向移动。

# mysql - 如何过滤 INNER JOIN SQL 命令结果

> ID：15648255
> 
> 赞同：2
> 
> 时间：2013-03-26T22:04:24.733
> 
> 标签：mysql, sql, join, inner-join, where-clause

我有一个记录表单提交的表。对于表单的每次提交，都有以下变量：

```
userid
record
accountName
accountNumber 
```

当用户提交表单时，表格中会填充`record`每个行项目的值。换句话说，这些值通常都由`record`值链接。我正在尝试用户`INNER JOIN`将结果过滤到显示`userid`,`accountName`和`accountNumber`列的表中。我非常接近这个命令：

```
SELECT t1.value AS number, t2.value AS name, t3.value AS userid
FROM mytable AS t1
INNER JOIN mytable AS t3
INNER JOIN mytable AS t2 ON t1.record = t2.record
WHERE t1.name = 'addAccountNumber'
AND t2.name = 'addAccountName'
AND t3.name = 'userid' 
```

唯一的问题是结果不限于每个条目一个。桌子上似乎显示了多个实例。

我认为需要围绕`WHERE`声明的部分进行一些编辑。在我看来，结果并没有根据名称值来过滤结果。关于如何解决这个问题的任何建议？

* * *

更新：

我应该补充一点，当我在调用中只包含两行时，我确实得到了正确的过滤结果，如下所示：

```
SELECT t1.value AS accountNumber, t2.value AS accountName
FROM mytable AS t1
INNER JOIN mytable AS t2
ON t1.record=t2.record WHERE t1.name='addAccountNumber' AND t2.name='addAccountName' 
```

认为这可能有助于显示我来自哪里。所以，一般来说，这与添加`userid`给我带来麻烦的变量有关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:08:46.077

我很难理解你需要什么，但也许就是这样。

```
SELECT t1.value AS number, t2.value AS name, t3.value AS userid

FROM mytable AS t1

INNER JOIN mytable AS t3 ON t1.record = t3.record

INNER JOIN mytable AS t2 ON t1.record = t2.record

WHERE t1.name = 'addAccountNumber'

AND t2.name = 'addAccountName'

AND t3.name = 'userid' 
```

# javascript - 在画布上保持文本垂直居中

> ID：15648267
> 
> 赞同：5
> 
> 时间：2013-03-26T22:05:12.997
> 
> 标签：javascript, jquery, html, canvas, html5-canvas

我遇到的问题是将用户输入的文本保持在画布元素中垂直居中。我已经建立了一个测试环境来尝试解决这个问题，我在这篇文章中提供了一个小提琴。这是我的代码：

HTML：

```
Enter Your Text: <br/>
<textarea id="inputtextuser" onkeyup="inputtextgo()" name="Text">Enter Your</textarea> <br/>
TextBaseline: 
<select id="inputtextbaseline" onchange="inputtextgo()";> 
    <option value="alphabetic">alphabetic</option>
    <option value="top">top</option>
    <option value="bottom">bottom</option>
    <option value="middle">middle</option>
    <option value="hanging">hanging</option>
</select> <br/>
<canvas id="canvas1"  width="300px" height="200px" >Your browser does not support the HTML5 canvas tag.</canvas> <br/>
<div id ="textheightentered"></div> 
```

CSS：

```
canvas {
    border: solid 1px black;
} 
```

JavaScript/jQuery：

```
//Declaring the Canvas
var canvas1 = document.getElementById('canvas1');
context1 = canvas1.getContext('2d');

//running the function to update the canvas
 inputtextgo();

function inputtextgo() {
    //Retrieving the text entered by the user
    var inputtext = document.getElementById("inputtextuser").value;
    //Calling the function to calculate the height on the text entered by the user
    var textheight = fontheight(inputtext);
    //retrieving the baseline selected by the user
    var baseline = document.getElementById("inputtextbaseline").value;
    //calculating the new y needed to center the text based on the height of the text
    var y = 100 + textheight/2;

    //Updating the canvas for the new text entered by the user
    context1.clearRect(0, 0, 300, 200);
    context1.font = "36px arial";
    context1.textBaseline = baseline;
    context1.fillText (inputtext, 0, y);   

    //Drawing a line across the middle of the canvas for reference
    context1.strokeStyle="red";
    context1.moveTo(5,100);
    context1.lineTo(290,100);
    context1.stroke();
    $("#textheightentered").text("Text Height: " + textheight);
}

function fontheight(text){

    var canvas=document.createElement("canvas");
    canvas.width = 1000;
    canvas.height = 200;
    var ctx=canvas.getContext("2d");

    function measureTextHeight(left, top, width, height,text) {

        // Draw the text in the specified area
        ctx.save();
        ctx.clearRect(0,0, canvas.width, canvas.height);
        ctx.baseline = "top";
        ctx.fillText(text, 0, 35); // This seems like tall text...  Doesn't it?
        ctx.restore();

        // Get the pixel data from the canvas
        var data = ctx.getImageData(left, top, width, height).data,
            first = false, 
            last = false,
            r = height,
            c = 0;

        // Find the last line with a non-white pixel
        while(!last && r) {
            r--;
            for(c = 0; c < width; c++) {
                if(data[r * width * 4 + c * 4 + 3]) {
                    last = r;
                    break;
                }
            }
        }

        // Find the first line with a non-white pixel
        while(r) {
            r--;
            for(c = 0; c < width; c++) {
                if(data[r * width * 4 + c * 4 + 3]) {
                    first = r;
                    break;
                }
            }

            // If we've got it then return the height
            if(first != r) return last - first;
        }

        // We screwed something up...  What do you expect from free code?
        return 0;
    }
    ctx.font= "36px arial";
    var height = measureTextHeight(0, 0, canvas.width, canvas.height,text);
    //return the height of the string
    return height;
} // end $(function(){}); 
```

JSFiddle：http: [//jsfiddle.net/grapien/R6DWN/3/](http://jsfiddle.net/grapien/R6DWN/3/)

我遇到的问题是，如果用户输入小写“y”，例如文本高度会发生变化，并且文本不会保留在画布的中心。这是因为在 y 变量中执行的基线校正需要根据输入的文本（大小写字符的组合）而有所不同，因为基线下方的文本会扭曲在 y 变量中执行的校正。

这就是我遇到问题的地方，因为我希望文本始终在画布元素中居中。我唯一能想到的就是计算 textbaseline 参考点下方的非空白像素。然后使用从基线到文本末端的差异来偏移文本以使其在画布上居中。我不确定你是如何编写这个脚本的，或者它是否可能。但这是我想出的最好的方法。

如果有人有任何想法或指导，我们将不胜感激，因为开发一种解决此问题的方法让我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:33:17.213

我相信我已经使用我在问题中所述的技术解决了这个问题。我创建了一个新函数，该函数计算在输入文本基线以下延伸的字体数量。使用与计算高度类似的技术。我使用字母基线，然后计算包含高于该基线的内容的像素。请参阅下面的函数。

```
function fontheight2(text){

    var canvas=document.createElement("canvas");
    canvas.width = 1000;
    canvas.height = 200;
    var ctx=canvas.getContext("2d");

    function measureTextHeight(left, top, width, height,text) {

        // Draw the text in the specified area
        ctx.save();
        ctx.clearRect(0,0, canvas.width, canvas.height);
        ctx.fillText(text, 0, 100); // This seems like tall text...  Doesn't it?
        ctx.restore();

        // Get the pixel data from the canvas
        var data = ctx.getImageData(left, top, width, height).data,
            first = false, 
            last = false,
            r = 100,
            c = 0;

        // Find the first line with a non-white pixel
        while(r) {
            r--;
            for(c = 0; c < width; c++) {
                if(data[r * width * 4 + c * 4 + 3]) {
                    first = r;
                    break;
                }
            }

            // If we've got it then return the height
            if(first != r) return 99 - first;
        }

        // We screwed something up...  What do you expect from free code?
        return 0;
    }
    ctx.baseline = "Alphabetic";
    ctx.font= "36px arial";
    var height = measureTextHeight(0, 0, canvas.width, canvas.height,text);
    //return the height of the string
    return height;
} // end $(function(){}); 
```

从那里我只需对 y 使用以下调整将文本偏移到中心：

```
var textheight = fontheight(inputtext); //Calculate Text Height
var textheight2 = fontheight2(inputtext); //Calculate portion above the baseline
var difference = textheight - textheight2; // Calculate the portion below the baseline
var y = 100 - difference + textheight/2; // Adjust the y cordinate 
```

这会偏移 y 以针对低于文本基线的文本部分进行调整。我在这里更新了 JSFiddle [http://jsfiddle.net/grapien/R6DWN/6/](http://jsfiddle.net/grapien/R6DWN/6/)。

# ruby-on-rails-3 - 在 Rails 3 中删除表和删除模型的最佳方法是什么？

> ID：15648268
> 
> 赞同：55
> 
> 时间：2013-03-26T22:05:12.960
> 
> 标签：ruby-on-rails-3, heroku, rails-migrations, rails-models

我的应用程序中不再需要模型和表格，我可以将它们留在那里，但我想删除它们以保持整洁。

我正在尝试找出删除它们的最佳方法，而不会弄乱我的*迁移*和*db/schema.rb*文件以及它可能对我的生产环境产生的任何副作用，我的应用程序在 Heroku 上。我在本地机器和 heroku 上都使用 PostgreSQL。

到目前为止，我已经找到了两种方法来做到这一点，但不确定哪种是最好的方法/导轨方式？

## 方法一

我想过只是进入我的数据库并删除表然后销毁模型。

```
rails db
DROP TABLE table_name
\q
rails destroy model model_name 
```

如果我这样做，我对此模型/表的迁移会发生什么？我对此模型有两个迁移，一个**timestamp_create_modelname**和一个 add_attribute_to_table 名称。

此方法还会更新*db/schema.rb*文件吗？

当我将应用程序推送到 Heroku 时，我怀疑模型将被删除但表格将保留在原处，是否有 heroku 命令删除表格。

## 方法二

我读到的另一种方法是生成一个新的迁移来删除表然后销毁模型。

```
rails generate migration drop_tablename 
```

& 然后更新以下文件：

db/migrate/timestamp_drop_tablename **（针对 Dan Wich 下面的回答进行了更新）**

```
class DropTablename < ActiveRecord::Migration
  def up
    drop_table :tablename
  end

  def down
    create_table :tablename do |t|
      t.string :table_column
      t.references :anothertable

      t.timestamps        
    end
    add_index :tablenames, :anothertable_id
  end
end 
```

& 然后在终端中：

```
rake db:migrate
rails destroy model model_name
rake db:migrate
git add .
git commit -m "removed table/model_name"
git push heroku master
heroku run rake db:migrate
heroku restart 
```

这似乎是最好的方法，但是旧的迁移文件会发生什么？每次我运行 rake db:migrate 时它们是否会保留并更新 db/schema 只是被 db/migrate/timestamp_drop_tablename 覆盖？

我很高兴尝试第二种方法，但希望有经验的人参与并告诉我这样做的方法。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-26T22:16:12.353

第二种方法是处理此问题的理想方法：您的迁移文件旨在表示您的数据库随时间发生的变化。旧的迁移文件将保留在您的项目中（以防万一，假设您想回滚到旧版本），但 Rails 不会在您运行它们时运行它们，`rake db:migrate`因为它知道它们已经运行（基于数据库中的数据） schema_migrations 表）。

您的 schema.rb 将只更新一次以反映您的数据库不再包含该表。

对您的代码进行一个小调整：您的迁移文件应该在`up`方法中删除表，并在理想情况下在方法中重新创建它`down`。“up”表示你的迁移及时丢弃表向前移动，如果迁移回滚，则`down`运行该方法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-05-29T14:27:42.603

我知道这是一个旧线程。通常，您不仅要删除模型，还要删除与该模型关联的路由、控制器和视图。为此，请运行这些

```
rails g migration DropYourModel
rails destroy scaffold YourModelName 
```

编辑您的迁移文件`drop_table`，然后运行

```
rake db:migrate 
```

如果模型恰好在命名空间中定义，例如，`admins`将第一个命令替换为

```
rails destroy scaffold admins/YourModelName 
```

# python - 您如何查看 mechanize 正在使用的请求标头？

> ID：15648272
> 
> 赞同：3
> 
> 时间：2013-03-26T22:05:28.103
> 
> 标签：python, web-scraping, mechanize

我正在尝试以编程方式将一些数据提交到表单。我有一个小问题，服务器“不喜欢”我发送的内容。令人沮丧的是，没有错误消息或任何可以帮助诊断问题的信息，它所做的只是让我回到我点击`br.submit()`.

当我在浏览器中手动单击提交按钮时，结果页面显示一个小的“成功！” 信息。通过脚本提交时不会出现此类消息。此外，实际上并没有将更改发布到服务器。这很奇怪，我第一次遇到这种行为。

挖掘 Mechanize 文档，它表明在这些奇怪的、难以诊断的问题下，最好复制浏览器实际提交的请求标头。

我的问题是，当我打电话时如何查看请求标头是什么`br.submit()`？

## 示例代码

```
location = 'http://ww.mysite.com'

br = mechanize.Browser()
cj = mechanize.LWPCookieJar()
br.set_cookiejar(cj)

username = MY_USER_NAME
password = MY_PASSWORD
br.addheaders.append(('Authorization', 'Basic %s' % base64.encodestring('%s:%s' % (username, password))))

br.open(location)

br.select_form(nr=0)
br['text'] = 'MY JUNK TO SUBMIT'    #Text field. Can put anything
br['DropDown1'] = ['4']             #This is a dropdown of integer values
br['DropDown2'] = ['3']             #Also a dropdown of ints
br.submit() 
```

提交表单时如何查看发送了哪些标题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T15:43:16.847

您是否在问如何查看您的浏览器或机械化发送的标头？

* * *

**浏览器**

就像其他评论员所说，您可以使用[Firebug](http://getfirebug.com) (Firefox)、开发工具（IE ['F12'](http://msdn.microsoft.com/en-gb/library/ie/gg589507%28v=vs.85%29.aspx)、Chrome [开发工具](https://developers.google.com/chrome-developer-tools/)和 Opera [Dragonfly](http://www.opera.com/dragonfly/documentation/network/)）等插件检查浏览器发送的标头。

* * *

**机械化**

使用机械化，您可以通过执行类似的操作来获取发送的标头副本

```
import mechanize 

br = mechanize.Browser()
br.open("http://stackoverflow.com")
request = br.request
request.header_items() 
```

在这种情况下给出

```
[('Host', 'stackoverflow.com'), ('User-agent', 'Python-urllib/2.7')] 
```

* * *

**其他/一次性**

一如既往地进行一次性调试，或者如果没有提供任何内容，那么您可以使用[Wireshark](http://www.wireshark.org)检查通过网络发送的标头。**提示**：使用类似的过滤器`(http.request.uri == "http://stackoverflow.com/")`

# php - 具有不同结果名称的多个 mysql 查询

> ID：15648277
> 
> 赞同：1
> 
> 时间：2013-03-26T22:05:41.370
> 
> 标签：php, mysql

我有来自同一个表的两个查询并选择相同的信息，但将结果发送给两个名称。有两个变量来存储结果，但是如何存储来自查询的其他信息？

```
require_once('connectvars.php');
$dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) or die('Error connecting to server, line 20.');
$query = "SELECT COUNT(id)  FROM artwork"; //find total number of id's
$result = mysqli_query ($dbc, $query) or die("query error, line 22");
$row = mysqli_fetch_array ($result, MYSQL_NUM);
find_pic(); //get the two id numbers
while ($count1 = $count2 or name = ""){ //problem line. check if counts = each other or either name = nothing
    find_pic(); //if true, run function again
}
while ($count1=37 or $count2=37){ //if either count = 37
    find_pic(); //if true, run function again
}
show_pic();

function find_pic(){
    $count1 = rand(0,$row[0]);
    $count2 = rand(0,$row[0]);
    $query1 = "SELECT * FROM artwork WHERE id = $count1";
    $query2 = "SELECT * FROM artwork WHERE id = $count2";
    $result1 = mysqli_query ($dbc, $query1) or die("query error, line 38");
    $result2 = mysqli_query ($dbc, $query2) or die("query error, line 39");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:24:13.370

试试这个（它不是您问题的完整解决方案，它唯一的帮助）：

```
$result1 = $dbc->prepare("SELECT * FROM artwork WHERE id = $count1");
$result2 = $dbc->prepare("SELECT * FROM artwork WHERE id = $count2");
$result1->execute();
$result2->execute();
$result1->bind_result($column1, $column2);   //all columns from table artwork
$result2->bind_result($column1, $column2);   //...

while ($result1->fetch())
{
    echo $column1;                       //here u have your result data
        echo $column2;

}; 
```

学习如何使用准备好的语句！！！！[http://php.net/manual/en/mysqli-stmt.bind-param.php](http://php.net/manual/en/mysqli-stmt.bind-param.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:23:33.143

如果重点是获得两张随机图片，为什么不这样做呢？

```
SELECT
    *
FROM
    artwork
WHERE 
    id != 37 AND
    name != ''
ORDER BY 
    RAND()
LIMIT 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:22:36.817

**1.您分配而不是比较**：

```
while ($count1 = $count2 or name = ""){ //problem line. check if counts = each other or either name = nothing
    find_pic(); //if true, run function again
}
while ($count1=37 or $count2=37){ //if either count = 37
    find_pic(); //if true, run function again
} 
```

注意单`=`s？你想要两个（或三个）：

```
while ($count1 == $count2 or name == ""){ //problem line. check if counts = each other or either name = nothing
    find_pic(); //if true, run function again
}
while ($count1==37 or $count2==37){ //if either count = 37
    find_pic(); //if true, run function again
} 
```

正是出于这个原因，我更喜欢这样做，而`'' == $name`不是导致解析错误，这比正在运行但损坏的脚本更好。`$name == ''``'' = $name`

**2\. 你没有传递`$row`给`find_pic()`：**

大多数变量都受范围的影响。除非您将其作为参数传递，否则函数`$row`内部不存在：`find_pic`

```
function find_pic($row){
    $count1 = rand(0,$row[0]);
    $count2 = rand(0,$row[0]);
    $query1 = "SELECT * FROM artwork WHERE id = $count1";
    $query2 = "SELECT * FROM artwork WHERE id = $count2";
    $result1 = mysqli_query ($dbc, $query1) or die("query error, line 38");
    $result2 = mysqli_query ($dbc, $query2) or die("query error, line 39");
}

find_pic($row); 
```

**3.`$count1`并`$count2`没有定义**：

您将它们设置在`find_pic`函数内部，但它们不存在于该范围之外。您可能想要使用参考：

```
function find_pic($row, &$count1, &$count2){
    $count1 = rand(0,$row[0]);
    $count2 = rand(0,$row[0]);
    $query1 = "SELECT * FROM artwork WHERE id = $count1";
    $query2 = "SELECT * FROM artwork WHERE id = $count2";
    $result1 = mysqli_query ($dbc, $query1) or die("query error, line 38");
    $result2 = mysqli_query ($dbc, $query2) or die("query error, line 39");
}

find_pic($row, $count1, $count2); 
```

# sql - 将行添加到“将 SQL Server 2008 查询拆分为批次”

> ID：15648283
> 
> 赞同：0
> 
> 时间：2013-03-26T22:05:59.757
> 
> 标签：sql, export, batch-processing, bcp

[在Break up a SQL Server 2008 query into batches](https://stackoverflow.com/questions/4729697/break-up-a-sql-server-2008-query-into-batches/15645434#15645434)的帮助下，我成功地使用 bcp 导出到平面文件。

现在我想为每批添加一（或两）行。这需要“抵消”总美元金额，以便每批都将平衡为零。例如，我在一个表中有 2,501 条记录。2,500 的金额为 100 美元，并且全部记入帐户 #70000，因此总计 250,000 美元。最后一条记录 #2,501 记入帐户 #80000，其值为 ($250,000)；因此总表余额。

由于我们的新系统只允许最多 950 行的批处理，因此我必须使用上述链接的代码拆分输出。效果很好，顺便说一句。但是由于每个批次都必须“平衡”为零，我需要在每个批次中添加一行，并将其设置为抵消帐户（例如#80000）。

我希望这对某人有意义！;-] 关于在何处/何时插入记录的建议，我可以在创建每个批次之后还是之前插入它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:30:38.170

看起来您应该在创建每个批次后插入新记录。而且，还有一个建议，您链接的帖子使用“插入表格...选择...”，它比“选择...进入表格”要慢。'select into table' 会自动为你创建表格。每次bcp out成功后，就可以drop自动创建的表了。您还可以使用历史记录表来记住您所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:31:37.943

所以，这就是我按照 Ijh 的建议和我从之前链接的帖子中“提取”的代码得出的结论：

```
-- Set up some variables 
declare
@batchsize      int = 900, 
@bcpTargetDir   varchar(10) = 'c:\tempFolder\', 
@csvQueryServer varchar(15) = 'SQLserverName', 
@rowcount       integer, 
@nowstring      varchar(25), 
@group          varchar(25),
@batch_id       int, 
@startID        int, 
@endID          int, 
@oidCSV         varchar(max), 
@csvQuery       varchar(max), 
@bcpFilename    varchar(25), 
@bcpQuery       varchar(1000)

-- create the Batch Range temp table
declare @tblBatchRanges table (
batch_id        integer NOT NULL IDENTITY(1,1) PRIMARY KEY, 
oid_start       integer NOT NULL, 
oid_end         integer NOT NULL, 
csvQuery        varchar(max)
)

-- Create a unique datestamp-based string, which will be used to name the exported files.
select @nowstring = REPLACE(CONVERT(char(8),GETDATE(),1),'/','-')

-- Set the value of @startid
select top(1) @startID = jeDataID 
    from DBname.dbo.tableName
    where groupReference = @group
    order by jeDataID

-- Set the value of @endid
select top(@batchsize) @endID = jeDataID 
    from DBname.dbo.tableName 
    where groupReference = @group
    order by jeDataID

select @rowcount = @@ROWCOUNT

-- create temp table to hold each batch --------------
CREATE TABLE ##jeDataTemp
(
jeDataID int,
docDate date,
GLacct varchar(17),
amount decimal(13, 2),
groupReference varchar(25) 
)

-- ===================================================
-- Loop through the data with a WHILE loop

WHILE (@rowcount > 0) begin

-- since I'm using a temp table to hold the data,
-- I need to clear it out each Loop through
truncate table ##jeDataTemp

-- insert the data into the temp table using the start and end ID values
insert into ##jeDataTemp
(jeDataID, docDate, GLacct, amount, groupReference)

select jeDataID, docDate, GLacct, amount, groupReference 
from tableName 
where jeDataID between @startID and @endID
order by jeDataID

-- insert the General Ledger offset to a different GL acct #
-- by getting the SUM of the [amount] field * -1
insert into ##jeDataTemp
(docDate, GLacct, amount, groupReference)

Select  max(docDate), 
        '8000000'   as GLacct,
        SUM(##jeDataTemp.amount)*-1 as amount,
        @group

from ##jeDataTemp

-- create the select statement with the ID parameters for each file to be exported
select @csvQuery = 'select * from ##jeDataTemp order by jeDataID'

-- Log the info and get the batch ID.  
insert into @tblBatchRanges (oid_start, oid_end, csvQuery)
    values (@startID, @endID, @csvQuery)

select @batch_id = @@IDENTITY

-- Advance @startid and @endid so that they point to the next batch
-- and filter for the selected Group Reference
select top(1) @startID = jeDataID
    from tableName
    where jeDataID > @endID
  AND groupReference = @group
    order by jeDataID

select top(@batchsize) @endID = jeDataID 
    from tableName
    where jeDataID > @endID
  AND groupReference = @group
    order by jeDataID

-- set the row count variable value
select @rowcount = @@ROWCOUNT

-- Export the current batch to a file. ---------------
-- Set the file name with the current Date and Batch ID #
select @bcpFilename = 'JE_' + @nowstring + '-' + cast(@batch_id as varchar) + '.txt'

select @bcpQuery = 'bcp "' + @csvQuery + '" QUERYOUT "' + 
            @bcpTargetDir + @bcpFilename + '" -S ' + @csvQueryServer + ' -T -c '
exec master..xp_cmdshell @bcpQuery

-- end the WHILE loop
END    

-- drop the temp table
drop table ##jeDataTemp 
```

当然希望这可以帮助其他人！肖恩

# python - Alembic：alembic 修订版显示导入错误

> ID：15648284
> 
> 赞同：28
> 
> 时间：2013-03-26T22:06:02.147
> 
> 标签：python, flask, flask-sqlalchemy, alembic

我正在尝试将我的`Flask`项目与`Alembic`
我的应用程序结构集成看起来像

```
project/
       configuration/
                    __init__.py
                    dev.py
                    test.py
       core/
           # all source code
       db/
         migrations/
                    __init__.py
                    alembic.ini
                    env.py
                    versions/ 
```

当我尝试从我的`db`目录运行以下内容时，我看到

```
 File "migration/env.py", line 55, in run_migrations_online
    from configuration import app, db
ImportError: No module named configuration 
```

[我尝试了Request a simple alembic working example for Auto Generating Migrations](https://stackoverflow.com/questions/11276017/request-a-simple-alembic-working-example-for-auto-generating-migrations)中提到的解决方案，但它对我不起作用

我`env.py` `run_migrations_online()`改变的方法是

```
def run_migrations_online():
    """Run migrations in 'online' mode.

    In this scenario we need to create an Engine
    and associate a connection with the context.

    """
    import os
    import sys

    sys.path.append(os.getcwd())
    from configuration import app, db

    alembic_config = config.get_section(config.config_ini_section)
    alembic_config['sqlalchemy.url'] = app.config['SQLALCHEMY_DATABASE_URI']
    target_metadata = db.metadata

    engine = engine_from_config(
        alembic_config,
        prefix='sqlalchemy.',
        poolclass=pool.NullPool)

    connection = engine.connect()
    context.configure(
        connection=connection,
        target_metadata=target_metadata
    )

    try:
        with context.begin_transaction():
            context.run_migrations()
    finally:
        connection.close()

if context.is_offline_mode():
    run_migrations_offline()
else:
    run_migrations_online() 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-02T16:22:59.513

我做`export PYTHONPATH=<path_to_project>`了并再次运行命令，它运行成功

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-31T21:22:05.753

你说你`alembic migrate --autogenerate -m 'migration description'`从目录运行类似的东西`project/db`并得到`ImportError`，对吧？

如果是这样，问题就很明显了。

请参阅：您尝试导入`configuration`模块并导致错误。然后你把`sys.path.append(os.getcwd())`- 换句话说，你将*当前*目录添加到系统路径中。但是当前目录是什么？它是`project/db`，它下面没有`configuration`模块，所以你继续得到`ImportError`.

解决方案是添加到系统路径父目录 - `project`，其中包含`configuration`模块。像这样：

```
parent_dir = os.path.abspath(os.path.join(os.getcwd(), ".."))
sys.path.append(parent_dir) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-30T21:18:13.197

我们遇到了同样的问题，归结为 env.py 不会被修订调用，**除非**设置了`--autogenerate`标志。您可以通过在 env.py 文件顶部放置一条打印语句来测试它。

我们正在通过调用 with`--autogenerate`然后删除生成的代码来解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-29T05:50:33.343

对于那些不想`PYTHONPATH`在运行 alembic 之前手动设置的人。您可以将 alembic 作为模块运行，例如：

```
python -m alembic.config upgrade head 
```

# javascript - 是否可以在 Raphael 中创建 unzoom 元素？

> ID：15648288
> 
> 赞同：0
> 
> 时间：2013-03-26T22:06:08.163
> 
> 标签：javascript, overlay, raphael, zooming

我有一个像谷歌地图一样的拉斐尔论文。

有一个主要内容，就像一张地图，上面有很多叠加层，就像谷歌地图上的那些图钉和标记一样。

因此，当我缩放时，我希望缩放主要内容，并且这些叠加层需要移动到正确的位置但保持原始大小。（例如，在谷歌地图中，​​当我缩放城市时，这些叠加层将始终附加到屏幕上相同大小的正确地址）。

我目前正在创建数千篇论文，并在缩放发生时手动保持它们的位置。但这会导致大量工作。所以我很想知道是否有可能在一张纸上画出所有东西。并且只是做一些魔术来阻止这些元素在缩放发生时调整大小。就像是：

```
 paper.rect(0, 0, 10, 10).attr({resize: false}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:13:29.173

你只需要两张纸。把一个放在另一个上面。缩放底纸时，使用`setViewBox`. 在最上面的纸上，重新计算位置并平移 ( `.transform('T...)`) 每个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T12:39:19.430

那是不可能的。即使您神奇地设置了 resize:false，您也需要将每个标记移动到一个新位置。

我可以给你一个我自己使用的功能：

```
markAdjustPosition : function(mark){
        var w = mark.data('width');
        var h = mark.data('height');
        var dx = w/2 - w/(2*_data.scale);
        var dy = h - h/_data.scale;
        mark.attr({width: w/(_data.scale), height: h/(_data.scale)}).transform('t'+dx+','+dy);
}, 
```

考虑到标记的目标点位于底部边缘的中间（如谷歌地图中的标记），此功能将重新定位标记。

**你传递给这个函数的标记**是拉斐尔元素。您必须在开始时为其添加正确的默认宽度/高度：

```
Mark.data("width") = 12;
Mark.data("height") = 24; 
```

****_data**是插件中所有数据的全局对象，**_data.scale**是当前比例（您需要在每个缩放级别上计算）。**

# php - tinymce utf8 错误的解决方法

> ID：15648290
> 
> 赞同：2
> 
> 时间：2013-03-26T22:06:12.740
> 
> 标签：php, tinymce

背景：我有一个使用 tinymce 编辑 HTML 的网站。HTML 实体，如不间断空格和 &x22C4; 即使我使用的是 entity_encoding:"named" 选项，tinymce 也会将其转换为 UTF-8 字符。然后我将它存储在一个 UTF-8 的 MySQL 表中。当稍后检索相同的 HTML 以进行重新编辑时，多字节字符将由 tinymce 分隔为单个字符。Tinymce 已验证这是一个错误。

问题是：如何在不破坏 HTML 的情况下将所有多字节 UTF-8 字符转换为 HTML 实体？

我在 PHP 中尝试了以下内容，但刚刚删除了多字节 UTF-8 字符：

```
$encoded_string = htmlentities( $utf_string, ENT_HTML5, 'UTF-8', false );
$html_ent_conv = htmlspecialchars_decode ( $encoded_string , ENT_COMPAT | ENT_HTML5 ); 
```

我也尝试了 mb_encode_numericentity，但我不知道应该为 convmap 参数使用什么。

更新：我有 PHP 5.3.17，它不支持 ENT_HTML5，所以我删除了它。现在它适用于不间断空间，但不适用于其他多字节 UTF-8 字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T20:28:16.523

几年前，我在 PHP 文档中遇到了这段代码：

```
function utf8_to_html($data)
{
  return preg_replace("/([\\xC0-\\xF7]{1,1}[\\x80-\\xBF]+)/e", '_utf8_to_html("\\1")', $data);
}

function _utf8_to_html($data)
{
  $ret = 0;

  foreach((str_split(strrev(chr((ord($data{0}) % 252 % 248 % 240 % 224 % 192) + 128) . substr($data, 1)))) as $k => $v)
    $ret += (ord($v) % 128) * pow(64, $k);

  return "&#$ret;";
} 
```

出去又发现了：

[http://php.net/manual/en/function.utf8-decode.php](http://php.net/manual/en/function.utf8-decode.php)

绝妙的小片段，有几次救了我的培根。

# mysql - 为什么变量没有被传递？

> ID：15648292
> 
> 赞同：0
> 
> 时间：2013-03-26T22:06:20.087
> 
> 标签：mysql, ajax, json, variables, jquery-select2

我正在使用 select2 插件从 mysql 填充标签。所以我将 q 变量传递给 getdada.php。但问题是

1.  q 变量没有被传递给 getdata.php 。我想传递这个变量，以便我可以获得与之相关的数据（可能是我没有将 q 变量放在适当的位置。）

    2.如果我不使用 q 变量，则只检索最后一个或第一个变量。我想将所有结果填充为标签数据（也许错误在我的 getdata.php 中的 jsoncode 格式中）

请帮忙。

```
 $("#e8").select2({

        placeholder: "Search for another Concept",
        minimumInputLength: 1,
        multiple: true,
        ajax: { // instead of writing the function to execute the request we use Select2's convenient helper
            url: "getdata.php",
            dataType: 'json',
            data: function (term, page) {
                return {
                    q: term, // search term

                      page: page

                };

            },
            results: function (data, page) {
                return { results: data};

            }
        }
    }); 
```

这是getdata.php

```
$sql=mysqli_query($db3,"SELECT * FROM o4_tags" );

while($row=mysqli_fetch_array($sql)){
    $tags=$row['tag_name'];
    $id=$row['id'];

        $myArray = array(
            array( "id" => "$id", "text" => "$tags" ),
        );

}

echo json_encode($myArray); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:21:52.790

首先，您的 PHP 脚本似乎出了点问题。您当前正在为检索到的每一行创建一个新的 $myArray。只有最后一个数组实际上是作为 JSON 输出的。这段代码解决了这个问题：

```
$sql=mysqli_query($db3,"SELECT * FROM o4_tags" );
$myArray=array();

while($row=mysqli_fetch_array($sql)){
    $tags=$row['tag_name'];
    $id=$row['id'];

    $myArray[]=array( "id" => "$id", "text" => "$tags" );
}
echo json_encode($myArray); 
```

我不确定为什么您在 PHP 脚本中看不到搜索词，但话又说回来，我在 PHP 中没有看到任何实际处理搜索词的代码。你试过转储 $_REQUEST 吗？

# google-maps - 自 9 月以来未触及的网站——现在抛出 INDEX_SIZE_ERROR DOM 异常 1

> ID：15648295
> 
> 赞同：-2
> 
> 时间：2013-03-26T22:06:38.917
> 
> 标签：google-maps, google-maps-api-3

我的网站显示了一个谷歌地图，平均大约有 20-30 个标记和折线。所有标记和折线每隔几秒更新一次，使用 JavaScript 计时器调用一些 ASP.Net 代码以获取所有标记的新坐标。

该网站在去年 9 月构建和演示时运行良好。它一次打开几天。月底，该网站被形象地搁置在货架上，不再使用。

一个新的演示刚刚弹出，所以我在 6 个月后的这个星期打开了这个网站。该网站现在正在绘制一些折线和一些标记，但不是几乎全部。该网站在尝试重绘时还会抛出“INDEX_SIZE_ERR: DOM Exception 1”消息。

我的服务器和代码根本没有改变，所以感觉像是 Google Maps API 的问题。

有人对发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:21:25.557

自去年 9 月以来，Google Maps API 已经更新了几次。

[请参阅文档中的版本控制说明](https://developers.google.com/maps/documentation/javascript/basics#Versioning)

[或 ChangeLog 进行更改](http://code.google.com/p/gmaps-api-issues/wiki/JavascriptMapsAPIv3Changelog)

# java - Android 的“构建简单的用户界面”教程中的错误

> ID：15648304
> 
> 赞同：0
> 
> 时间：2013-03-26T22:07:14.933
> 
> 标签：java, android, xml

因此，我尝试使用 Eclipse 遵循 Android 的“构建单一用户界面”教程，但我遇到了两个错误，导致我的代码无法运行。

第一个错误在 res/menu/main.xml 广告中说：

> 错误：错误：未找到与给定名称匹配的资源（在“标题”处，值为“@string/action_settings”）。

给我这个错误的代码行是：

```
android:title="@string/action_settings"/> 
```

我的第二个错误是 res/values/strings.xml 并说：

> 错误：在预期项目的位置找到标记字符串

为线

```
<String name="menu_settings">Settings</String> 
```

整个“String.xml”文件如下：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">My First App</string>
    <string name="edit_message">Enter a message</string>
    <string name="button_send">Send</string>
    <String name="menu_settings">Settings</String>
    <String name ="title_activity_main">MainActivity</String>
    <String name ="action_settings">Settings</String>

</resources> 
```

虽然我有使用 Java/Eclipse 的经验，但我对 Android 和 XML 还是陌生的，所以我完全不知道这些错误是什么意思。您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T14:18:23.553

我遇到了同样的问题，并通过更改在 main.xml 中修复了

```
android:title="@string/action_settings"/> 
```

至

```
android:title="@string/menu_settings"/> 
```

作为 strings.xml 读取

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">My First App</string>
    <string name="edit_message">Enter a message</string>
    <string name="button_send">Send</string>
    <string name="menu_settings">Settings</string>
    <string name="title_activity_main">MainActivity</string>
</resources> 
```

基本上，我是对那些偶然发现这一点的人说：确保检查您在相应文件中的命名

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:09:22.723

更改`String`为`string`（小写“s”）。大写的 S 使它无效，你得到第二个错误。由于该定义无效，因此当您尝试在布局中引用它时会遇到第一个错误。

# javascript - 从javascript设置选择选项的值和文本

> ID：15648305
> 
> 赞同：3
> 
> 时间：2013-03-26T22:07:21.947
> 
> 标签：javascript

如何从 javascript 中设置选择选项的值和文本？

```
function getYear() 
{
    var d = new Date();
    var year = d.getFullYear();
    return year;
}

<select name="dateformat" onchange="change_date();" id="dateformat">
   <option value="??" >??</option>
</select> 
```

我想要 getYear() 的值代替 ??。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:10:01.753

```
var option = document.getElementById("dateformat").options[0];
option.value = option.text = getYear(); 
```

**编辑**：我认为 OP 的意思是找到一种方法来*添加*一个选项到`<select>`. 但它似乎更像是编辑现有的。所以在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:09:48.723

你去：

```
var year = getYear();
var combo = document.getElementById('dateformat');
combo.options[combo.options.length] = new Option(year ,year ); 
```

# grails - GRAILS URLMapping：“排除”不起作用：用于打开文件的 href 链接从 gsp 页面返回 404 错误

> ID：15648307
> 
> 赞同：0
> 
> 时间：2013-03-26T22:07:25.857
> 
> 标签：grails, gsp, url-mapping

这是一个奇怪的问题：

我在 gsp 页面上有链接，它应该从位置“/appName/docs”打开一个名为“fileInstruction.pdf”的 pdf 文件，其中“appName”是应用程序的名称

gsp 上的 html 看起来像：

```
 <div>
        <h6>File examples and instructions</h6>
        <a href="/appName/docs/fileInstruction.pdf" target="blank">File format instructions</a>
   </div> 
```

但单击链接似乎在寻找控制器，我收到 404 错误。该文件夹包含我尝试的pdf文件：

“file:///C:/applications/appName/docs/fileInstruction.pdf”在浏览器上打开了文档。

试图将 url 映射排除为：

```
 class UrlMappings {
   static excludes = ["/docs/*"]
    static mappings = {
           ....
     }
 } 
```

似乎不起作用。我正在使用 grails 2.0.1。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:43:06.010

您的应用程序的根目录不是 URL 的根目录，web-app 是。将其移至`C:/applications/appName/web-app/docs/fileInstruction.pdf`并删除 UrlMappings.groovy 中的更改，因为这与静态资源无关，仅与基于控制器的请求有关。

# android - 有时不会触发 onNewIntent()

> ID：15648309
> 
> 赞同：0
> 
> 时间：2013-03-26T22:07:36.647
> 
> 标签：android, android-intent

我已经在发出通知的位置设置了我的应用程序，当它被点击时，我想在程序中知道这一点。每次单击它时，主要活动都会打开，但我时不时会遇到一个错误，即单击通知时不会调用 onNewIntent(Intent intent)。这是我的 onNewIntent：

```
@Override
    public void onNewIntent(Intent intent)  //when notification is clicked
    {
        Log.i("mydebug","Notification clicked.");

    } 
```

这里是创建通知的地方：

```
Intent notificationIntent = new Intent(context, MainActivity.class);
            notificationIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_SINGLE_TOP); 
            PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);

            NotificationCompat.Builder builder = new NotificationCompat.Builder(context);
            builder.setWhen(System.currentTimeMillis())
                     .setContentTitle(schedname)
                     .setContentText("Click to deactivate this silence schedule.")
                     .setContentIntent(pendingIntent)
                     .setSmallIcon(R.drawable.ic_launcher);
                    //notification.flags |= Notification.FLAG_NO_CLEAR; //Notification cannot be clearned by user
            NotificationManager mNotificationManager = (NotificationManager)context.getSystemService(Context.NOTIFICATION_SERVICE);
            // Uses the default lighting scheme
            builder.build().defaults |= Notification.DEFAULT_LIGHTS;
            builder.setAutoCancel(true);
            builder.setOngoing(true);
            builder.setContentIntent(pendingIntent);

            // Will show lights and make the notification disappear when the presses it
            builder.build().flags |= Notification.FLAG_AUTO_CANCEL | Notification.FLAG_SHOW_LIGHTS;
            mNotificationManager.notify(1, builder.build()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:48:18.203

尝试将标志设置为：

```
FLAG_ACTIVITY_CLEAR_TOP 
```

代替

```
FLAG_ACTIVITY_SINGLE_TOP 
```

# java - 这段 Java 代码中的下划线实际上在做什么？

> ID：15648312
> 
> 赞同：81
> 
> 时间：2013-03-26T22:07:48.093
> 
> 标签：java, syntax

我刚开始学习Java。

我帮助我学习的朋友刚刚给我发了这个，并说“弄清楚这个”。

不幸的是，我无法阅读此内容。在我看来，它就像 Perl。

```
class _{_ _;_(){_=this;}} 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2013-03-26T22:08:29.510

`_`是类名。这是一个非常令人困惑的问题，但它确实有效！

随着班级重命名：

```
class Something {Something something;Something(){something=this;}} 
```

并清理：

```
class Something {
    Something something;
    Something() {
        something=this;
    }
} 
```

你可能会因为这个奇怪的名字而发疯`:)`

```
class _{_ __;_ ____;_(){__=this;____=__;}_(_ ___){__=___;}} 
```

事实上，甚至支持 Unicode，所以这是有效的：

```
class 合法類別名稱{合法類別名稱(){}} 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2013-03-26T22:09:45.127

`_`是类名，下划线是一个有效的 Java 变量名，你只需要缩进你的代码来去混淆它：

```
class _{
    _ _;
    _(){
     _=this;
   }
} 
```

喜欢：

```
class A{
    A A;
    A(){
     A=this;
   }
} 
```

**编辑：**感谢@Daniel Fischer

> 类型名称和变量名称具有不同的命名空间。例如代码`class FOO { FOO FOO; }`在 Java 中是有效的。

**概括**

*   `_`是一个类名，例如在`class _{`
*   `_`是类成员名称，例如 at`_ _;`和`_=this`
*   `_`是构造函数名称，例如 at`_()`

请记住：Java 使用[**六个不同的命名空间：**](http://www.cis.upenn.edu/~matuszek/cit591-2011/Pages/o-o-concepts.html)

> *   包名，
> *   类型名称，
> *   字段（变量）名称，
> *   方法名称，
> *   局部变量名（包括参数），和
> *   标签。
> 
> 此外，每个声明的枚举都有自己的命名空间。不同类型的相同名称不冲突；例如，*方法可能与局部变量命名相同*。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-27T12:19:06.507

嗯，这是一个很好的例子。Java 允许 unicode 作为标识符，因此您可以编写如下内容：

```
class ⲥlass {
ⲥlass claѕѕ;
} 
```

这里类名的 c 是 'ⲥ' (U+2CA5 COPTIC SMALL LETTER SIMA) 和

对象名称的“ѕ”（U+0455 西里尔小写字母 DZE）。

# c++ - 如何反转堆栈

> ID：15648313
> 
> 赞同：2
> 
> 时间：2013-03-26T22:07:52.027
> 
> 标签：c++, stack

我有一个任务，我想取一个堆栈，显示输出，然后将其反转以显示输出。

**它假设看起来像这样**

```
Stack:
262 115 74 26 34 243 22 734 113 121
Stack Reversed:
121 113 734 22 243 34 26 74 115 262 
```

**相反，我的是这样出来的**

```
Stack:
262 115 74 26 34 243 22 734 113 121 121 113 734 22 243 34 26 74 115 262
Stack Reversed: 
```

有人可以看看我的代码，看看发生了什么。我已经尝试了很多东西，但无法让任何东西发挥作用。

```
#include <stdio.h>
#include <iostream>

#include "linkedStack.h"

using namespace std;

template <class Type>
void printStack(linkedStackType<Type>& stack);

template <class Type>
void reverseStack(linkedStackType<Type>& stack);

int main(int argc, char **argv)
{
   // Declare stack variables
   linkedStackType<int> stack;

   // Add some data to the stack
   stack.push(121);
   stack.push(113);
   stack.push(734);
   stack.push(22);
   stack.push(243);
   stack.push(34);
   stack.push(26);
   stack.push(74);
   stack.push(115);
   stack.push(262);

   cout << "\nStack:\n   ";
   printStack(stack);

   reverseStack(stack);

   cout << "\nStack Reversed:\n   ";
   printStack(stack);

   cout << "\n\n** Press any key to continue **\n";
   getchar();

   return 0;
}

template <class Type>
void printStack(linkedStackType<Type>& stack)
{
   Type item;
   linkedStackType<Type> tmpStack = stack;

   while (stack.isEmptyStack() == false)
   {
      item = stack.top();
      stack.pop();
      cout << item << " ";
   }

   stack = tmpStack;

 }

template <class Type>
void reverseStack(linkedStackType<Type>& stack)
{
  Type item;
   linkedStackType<Type> tmpStack;

   while (stack.isEmptyStack() == false)
   {
      item = stack.top();
      stack.pop();
      tmpStack.push(item);
   }

   while (tmpStack.isEmptyStack() == false)
   {
      item = tmpStack.top();
      tmpStack.pop();
      stack.push(item);
      cout << item;  

   }

   stack = tmpStack;

   return;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T22:16:26.670

我不是 100%，但我想如果你删除`reverseStack`.

```
template <class Type>
void reverseStack(linkedStackType<Type>& stack)
{
   Type item;
   linkedStackType<Type> tmpStack;

   while (stack.isEmptyStack() == false)
   {
      item = stack.top();
      stack.pop();
      tmpStack.push(item);
   }

   //while (tmpStack.isEmptyStack() == false)
   //{
   //   item = tmpStack.top();
   //   tmpStack.pop();
   //   stack.push(item);
   //   cout << item;
   //}

   stack = tmpStack;
   return;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:18:05.503

您在 reverseStack() 中有一个无关的打印循环，它将值打印在错误的位置。此外，此打印循环会清除您的 tmpStack。这解释了结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:18:56.993

您的第二个`while`循环清空`tmpStack`，但随后您将现在为空的堆栈分配给`stack`，因此您只有一个空堆栈。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-10-11T06:57:32.350

```
void sortStack(struct stack **s)  
{  
if (!isEmpty(*s))  
  {  
    int x = pop(s);  
    sortStack(s);  
    sortedInsert(s, x);  
  }  
}  

void sortedInsert(struct stack **s, int x)  
{  
  if (isEmpty(*s) || x > top(*s))  
  {  
    push(s, x);  
    return;  
  }  
int temp = pop(s);  
sortedInsert(s, x);  
push(s, temp);  
} 
```

# c++ - 多线程文件流

> ID：15648324
> 
> 赞同：0
> 
> 时间：2013-03-26T22:08:26.777
> 
> 标签：c++, multithreading, file, std

我正在创建一个连接到服务器的客户端应用程序，除了其他功能外，还将服务器聊天记录到一个文件中，以便以后可能会惩罚违反规则的行为。
不幸的是，应用程序中必须（至少）有两个线程：接收器循环和发送器循环 - 服务器需要时间精度。这意味着，我需要线程安全的解决方案来将数据记录到文件中。
如果线程（尽可能）同时发送日志信息，则可能会发生这种情况：

```
logfile.txt:
chat: Hello my name is Duke
chat: Hell[WARNING]: Hacker detectedo my name is John 
```

你可以看到一个句子被注入到另一个句子中。我不希望这种情况发生。我的输出也发生了同样的情况`std::cout`，但这并不是那么重要。

问题：

1.  如何使`std::ofstream`一次只记录一个数据？（记住其他并在之后插入，而不是在中间）
2.  如何检查文件是否被其他线程关闭。（或错误）

奖励问题：你能解决同样的问题`std::cout`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:12:31.013

标准流没有线程安全保证。安全地完成您正在尝试做的事情的唯一方法是序列化对流的访问。

最简单的解决方案是将涉及流的任何语句包装在互斥体中。

```
{
    std::lock_guard<std::mutex> locked(gCoutMutex);
    std::cout << "This is a message" << std::endl;
} 
```

更正确的方法，特别是对于记录器，是有一个带有消息队列的记录线程。当另一个线程想要记录时，它只是向队列发布一条消息，记录线程将通过队列并将所有内容写入磁盘。

# java - 使用 JSF 2,1 和 Apache Tomcat 使用 LDAP 登录

> ID：15648328
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:08:36.730
> 
> 标签：java, mysql, authentication, ldap

不仅仅是一个问题，我需要使用 jsf 执行身份验证。我开发了一个登录，它接收存储在 MySQL 中的用户名和密码。从 Active Directory 登录后，这应该使用 AD 的用户名和密码，我想应该与 MySQL 的用户名和密码相同。

然后，进入系统，您不再看到登录，而是直接看到主页或主页。

我希望你的帮助和提前感谢。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T04:55:30.573

这是我的解决方案，它对我有用：编辑 faces-config.xml：

```
<lifecycle>
        <phase-listener>
            com.xxx.admin.security.Login
        </phase-listener>
    </lifecycle> 
```

班级登录：

```
 public class Login implements PhaseListener {
    private static final String USER_LOGIN_OUTCOME = "login";
     @Override
        public void afterPhase(PhaseEvent event) {
            FacesContext context = event.getFacesContext();
            if (userExists(context)) {
                // 1\. Update last login
                // 2\. may be expired ???
                ExternalContext extContext = context.getExternalContext();
                try {
                    ETT_UserDTL tmpUser = (ETT_UserDTL) extContext.getSessionMap().get(User.USER_SESSION_KEY);
                    if (!Authenticator.authenticateUser(tmpUser, context)) {
                        // send the user to the login view
                        reLogin(context);
                    } else {
                        ;
                    }
                    // allow processing of the requested view
                } catch (Exception ex) {
                    SystemLogger.getLogger().error(ex);
                    ClientMessage.logErr(ex.toString());
                    reLogin(context);
                }
            } else {
                // send the user to the login view
                reLogin(context);
            }
        }
    private boolean userExists(FacesContext context) {
    // Need re-check authenticator here.
    // Check user exist
    ExternalContext extContext = context.getExternalContext();
    return (extContext.getSessionMap().containsKey(User.USER_SESSION_KEY));
}
private void reLogin(FacesContext context) {
        // send the user to the login view
        if (requestingSecureView(context)) {
            context.responseComplete();
            context.getApplication().
                    getNavigationHandler().handleNavigation(context,
                    null,
                    USER_LOGIN_OUTCOME);
        } else {
            ;
        }
    }
    } 
```

LDAP认证：

```
public class LDAPAuthentication {

    static String ATTRIBUTE_FOR_USER = "sAMAccountName";

    @SuppressWarnings("unchecked")
    public Attributes authenticateUser(String username, String password, String strDomain, String strHost, String dn) throws NamingException {

        String searchFilter = "(&(objectClass=user)(" + ATTRIBUTE_FOR_USER + "=" + username + "))";
        // Create the search controls

        SearchControls searchCtls = new SearchControls();
        // searchCtls.setReturningAttributes(returnedAtts);
        // Specify the search scope
        searchCtls.setSearchScope(SearchControls.OBJECT_SCOPE);
        String searchBase = dn;
        Hashtable environment = new Hashtable();
        environment.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
        // Using starndard Port, check your instalation
        environment.put(Context.PROVIDER_URL, "ldap://" + strHost);
        environment.put(Context.SECURITY_AUTHENTICATION, "simple");

        environment.put(Context.SECURITY_PRINCIPAL, username + "@" + strDomain);
        environment.put(Context.SECURITY_CREDENTIALS, password);

        LdapContext ctxGC = null;
        try {
            ctxGC = new InitialLdapContext(environment, null);
            // Search for objects in the GC using the filter
            NamingEnumeration answer = ctxGC.search(searchBase, searchFilter, searchCtls);
            while (answer.hasMoreElements()) {
                SearchResult sr = (SearchResult) answer.next();
                Attributes attrs = sr.getAttributes();
                if (attrs != null) {
                    return attrs;
                }
            }
        } catch (Exception e) {
            SystemLogger.getLogger().error(e);
        }
        return null;
    }
} 
```

验证：

```
public static boolean authenticateLDAPUser(String strUser, String strPass, String strDomain, String strHost) throws NamingException, Exception {
        LDAPAuthentication ldap = new LDAPAuthentication();
        Attributes att = ldap.authenticateUser(strUser, strPass, strDomain, strHost, "");
        if (att != null) {
            try {
                ETT_UserDTL tmpUser = (ETT_UserDTL) DataUtil.performAction(DATA_UserGUI.class, "getInfByUserName", strUser);
                tmpUser.setPassword(strPass);
                if (!otherAuthenticate(tmpUser)) {
                    Authenticator.removeUser();
                    return false;
                } else {
                    ;
                }
                pushUser(tmpUser);
                return true;
            } catch (TelsoftException ex) {
                SystemLogger.getLogger().error(ex);
                return false;
            }
        } else {
            updateLoginFail();
            return false;
        }
    } 
```

# twitter-bootstrap - 如何使 .nav-link 无效？

> ID：15648329
> 
> 赞同：57
> 
> 时间：2013-03-26T22:08:37.967
> 
> 标签：twitter-bootstrap

我正在使用 Bootstrap`nav-bar`作为向导进度指示器。我想确保尚未访问的向导步骤不可点击。我希望它们出现在 中`nav-bar`，但让它们变灰并禁用链接。

这可以在 Bootstrap 中完成`nav-bar`吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-03-26T23:36:50.493

您可以将`disabled`类添加到容器中`<li>`：

```
<ul class="nav nav-list">
   <li class="disabled"><a href="index.html">...</a></li>
</ul> 
```

但是，要禁止用户点击它们，您应该使用 JavaScript 来防止这种情况：

```
$(document).ready(function() {
   $(".nav li.disabled a").click(function() {
     return false;
   });
}); 
```

另一种方法是临时`href`用锚 ( ) 替换属性。`#`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-12-05T17:27:04.773

正确的方法是使用不带属性的`<a>`nchor 标签。`href`

虽然这是一种鲜为人知的技术，但它是完全有效的 HTML，并导致元素具有归因于`<a>`标签的所有样式，但没有链接功能。

```
<ul class="nav nav-list">
   <li><a>...</a></li>
</ul> 
```

有关技术背景，请参阅[W3C 的 HTML 规范：](http://www.w3.org/html/wg/drafts/html/master/single-page.html#the-a-element)

> 如果 a 元素没有 href 属性，则该元素代表一个占位符，用于放置链接，如果它是相关的，则仅包含元素的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-18T12:08:34.697

这可以通过`pointer-events`属性在 CSS 中完全完成（除非您需要支持 ie <11）。但是，通过关闭指针事件，`a`我也不再获得不允许的光标，因此我将其设置为 disabled `li`。（我知道这个问题很老但仍然是第一个搜索结果）

这是我的 SCSS 用于此目的：

```
ul.nav {
    li.disabled {
        cursor: not-allowed;

        a {
            pointer-events: none;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-04T20:31:13.360

我想补充一点，仅添加禁用不会阻止导航。此外，答案 jquery 解决方案将起作用，但是如果您添加或删除禁用的类，它不会取消绑定处理程序。

这可以通过将事件处理程序更改为使用 jquery 的 .on 方法来解决。

```
$('body').on('click', '.disabled', function(e) {
    e.preventDefault();
    return false;
}); 
```

这会将处理程序附加到主体（确保用您的容器替换主体）并通过禁用过滤。任何时候单击正文，如果单击的内容已禁用，则会阻止单击。

查看[http://api.jquery.com/on/](http://api.jquery.com/on/)了解更多信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-03-30T23:00:48.653

最简单的方法就是将类从 更改`nav-link`为`nav-link disabled`。

像这样：

```
<a class="nav-link disabled" href="#"> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-01T13:28:42.800

为了禁用导航链接，您需要禁用 li 和 a 标签。但这在使用剃刀语法时可能会有点棘手。将禁用的类添加到 li 工作正常，但它不会禁用 a 标签上的操作。因此，类似于 gustavohenke 解决方案，但有点精致，请在您的文档就绪功能中尝试此操作。

```
$(".nav li.disabled a").prop("disabled",true)
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-07T01:23:23.650

在 href 中保留您的价值。您可以使用 onclick="return false;" 切换锚标记。使用 bootstrap disabled css 类使菜单项变灰。

```
var enableMyLink = false;

if (enableMyLink) {
  $("li").removeClass("disabled").find("a").removeAttr("onclick");
} else {
  $("li").addClass("disabled").find("a").attr("onclick", "return false;");
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<li>
  <a href="http://sample.com/">My Link</a>
</li>
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-12-11T19:18:44.400

首先，您应该在 ul 中添加一个 id：

```
<ul class="nav navbar-nav navbar-right" id="someId">
            <li><a>Element</a></li>
</ul> 
```

您可以隐藏`ul`，例如：

```
$(document).find('ul#someId').hide(); 
```

如果你愿意，你可以显示 ul：

```
$(document).find('ul#someId').show(); 
```

# java - toString 处的 Java StringWriter StringBuilder 异常

> ID：15648341
> 
> 赞同：0
> 
> 时间：2013-03-26T22:09:22.960
> 
> 标签：java, android, tostring, stringbuilder, stringwriter

好的..这很奇怪。我正在尝试在android中发出http请求。它可以工作，我可以使用 StringWriter“构建”一个字符串，但代码在 writer.toString() 处引发异常。如果我使用 StringBuilder 或 StringWriter 没有区别。

```
try {
    HttpResponse response = httpClient.execute(httpPost);
    InputStream is = response.getEntity().getContent();
    StringBuilder writer = new StringBuilder();
    //StringWriter writer = new StringWriter();
    int ch;
    while(( ch = is.read()) != -1) { 
        writer.append((char)ch);
    }
    String theString = writer.toString();
    return theString;
} 
catch (Exception e) {
    return e.getMessage();
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:29:29.950

问题是您的 HTTP 线程正在尝试使用`HTTPResponse`a`TextView`或其他此类 UI 元素更新 UI 线程，因此`CalledFromWrongThreadException`正在引发 a。

使用一种`Handler`或其他此类机制重定向到 UI 线程以进行 UI 更新将解决您的问题。

# php - 为什么对结果对象的 foreach 不起作用？

> ID：15648353
> 
> 赞同：4
> 
> 时间：2013-03-26T22:10:09.847
> 
> 标签：php, object, foreach, yahoo-api

我意识到有很多这种性质的问题，但是我无法使用其他帖子解决我的问题，所以我希望这里有人可以帮助我。

我有一个从 Yahoo 本地搜索 API 返回的对象。我已将结果传递到`json_decode()`并将结果保存到`$yahoo_json_decoded`. 我可以使用 for 循环从结果中获取数据并执行以下操作：

```
echo 'Name: ' . $yahoo_json_decoded->ResultSet->Result[$i]->Title . '<br />' ; 
```

但我似乎无法使 foreach 工作：

```
foreach($yahoo_json_decoded->ResultSet as $res=>$variable)
{
    $listingID = $yahoo_json_decoded->ResultSet[$res]->id ;
    echo $listingID;
} 
```

我可以循环数据并继续前进，但我真的很想了解为什么`foreach`它不起作用。

谢谢（怜悯）

柯克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:12:28.277

根据`$yahoo_json_decoded->ResultSet->Result[$i]->Title`您所说的有效：

```
foreach($yahoo_json_decoded->ResultSet->Result as $index => $result)
{
   $listingID = $result->id ;
    echo $listingID;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T22:19:03.340

**两个循环之间的字面区别**

`for`代码段中的循环遍历数组***，*** `$yahoo_json_decoded->ResultSet->Result`而`foreach`循环遍历***对象*** `$yahoo_json_decoded->ResultSet`。

换句话说，在`for`循环中，您正在按预期迭代***数组元素***，而在`foreach`循环中，您实际上是在迭代***对象属性***。

**差异的示范**

例如，给定这个对象：

```
$json = json_encode(array('result'=>array('apple','orange','lemon')));
$obj  = json_decode($json); 
```

考虑这个循环之间的区别：

```
for ($i=0; $i < count($obj->result); $i++) :
    echo $i.' - '.$obj->result[$i].' ';
endfor; 
```

这个循环：

```
foreach ($obj as $key=>$val) :
    echo $key.' - ';
    var_dump($val);
endforeach; 
```

第一个循环的输出将是：

```
0 - apple 1 - orange 2 - lemon 
```

而第二个的输出将是：

```
result - array(3) { [0]=> string(5) "apple" [1]=> string(6) "orange" [2]=> string(5) "lemon" } 
```

## **[看到行动的不同](http://phpfiddle.org/main/code/608-zr4)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-26T22:12:43.760

据我了解，你应该这样做

```
foreach($yahoo_json_decoded->ResultSet->Result as $key => $val) //(...) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-26T22:12:35.777

您在 foreach 循环中缺少一层数据结构

```
foreach($yahoo_json_decoded->ResultSet->Result as $res=>$variable)
{
   $listingID = $variable->id ;
    echo $listingID;
} 
```

与你的 for 循环

```
for ($i = 0; $i <10; $i++)
$yahoo_json_decoded->ResultSet->Result[$i]->Title 
```

因此

```
$i = $res
$variable = $yahoo_json_decoded->ResultSet->Result[$i] 
```

# jquery - 如何加载在线脚本，如果没有互联网连接，则回退到加载本地脚本？

> ID：15648357
> 
> 赞同：2
> 
> 时间：2013-03-26T22:10:22.113
> 
> 标签：jquery

我是网络开发的初学者，我正在努力实现这一目标：

我有一个脚本，我希望它从我的主机在线加载。但是，如果没有互联网连接（脚本无法加载，即使以另一种方式），则回退以加载本地脚本。这可能吗？

我不介意解决方案，如果它是 jquery 或其他任何东西，我只想让它工作。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T09:30:03.633

```
<script>
var jsLoaded = false;
setTimeout("callback()", 2000);
function callback(){
  if (!jsLoaded) {
    //Do ur stuff means call your local javascript....
  } 
}
</script>

<script type="text/javascript" src="//assets.zendesk.com/external/zenbox/v2.5/zenbox.js" id="popup" onload="jsLoaded=true"></script> 
```

说明：
我们有一个在两秒后调用的回调，并检查由您的脚本引用的 onload-event 设置的变量。您可以在加载本地脚本的回调中执行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:17:22.077

这假设您可以在本地访问 jQuery。

好吧，我建议你“尝试”通过 jQuery/Ajax 从远程主机加载脚本，我认为他们有一些工具可以帮助你做到这一点。然后检查响应代码...我认为 200 是“OK”，如果不是“OK”，则继续加载本地版本。

```
<script>
$('body').getScript('<yourremotehostaddress>').fail(function(jqxhr, settings, exception) {

       // Load your local script here.

});
</script> 
```

希望这可以帮助 ：）

上述评论的解决方案也是：您可以尝试从远程主机加载脚本，然后尝试访问脚本中包含的对象。假设有一个。

更新：对不起最初的帖子，我没有意识到传递给 getScript() 的处理程序只有在请求成功时才会被调用。我们要检查失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:18:55.087

大概是这样的……？

```
<script type="text/javascript" src="//cod.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
    if(!window.jQuery) {
        document.write("<script type=\"text/javascript\" src=\"path/to/local/jquery.js\"><\/script>");
    }
</script> 
```

# perl - 在打印函数中使用未初始化的值

> ID：15648358
> 
> 赞同：3
> 
> 时间：2013-03-26T22:10:29.777
> 
> 标签：perl

我正在运行以下简单的 Perl 程序。

```
use warnings;
use strict;

my %a = (b => "B", c => "C");

print "Enter b or c: ";

my $input = <STDIN>;

print "The letter you just entered is: ", $input, "\n";

my $d = $a{$input};

print ($d); 
```

当我输入 b 时，我得到了以下带有警告的输出。第 47 行是最后一条语句 print ($d);

```
Enter b or c: b
The letter you just entered is: b

Use of uninitialized value $d in print at C:/Users/lzhang/workspace/Perl5byexample/exer5_3.pl line 47, <STDIN> line 1. 
```

为什么我会收到此警告，我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T22:12:44.357

除了or之外，您`$input`还包含换行符。修改它以修剪此字符：`b``c`

```
my $input = <STDIN>;        # 1\. $input is now "b\n" or "c\n"                             
chomp $input;               # 2\. Get rid of new line character
                            #    $input is now "b" or "c"

print "the letter you just entered is: ", $input, "\n"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T22:12:48.493

这是因为当您按 Enter 时，它会添加一个换行符。尝试添加[`chomp`](http://perldoc.perl.org/functions/chomp.html)以摆脱这种情况。

```
chomp(my $input = <STDIN>); 
```

您会收到该警告，因为该值`b\n`未映射到哈希中的值，因此`$d`未初始化。

# git - 我需要删除对 fork 的提交

> ID：15648360
> 
> 赞同：11
> 
> 时间：2013-03-26T22:10:44.440
> 
> 标签：git, github

好吧，我做了一些愚蠢的事情。

*   我分叉了一个我应该贡献的回购。
*   所以我随后创建了一个名为“blafile”的文件来检查我可以提交（显然我不明白什么是 fork）并提交了一条消息“检查我可以提交”。
*   我推到我的 github forked repo 并忘记了它。
*   第二天我开始修复一个错误。
*   我提交了我的修复并推送到我的分叉仓库，并带有消息“fixed bug xyz”。

现在我想发出一个拉取请求，突然间我看到了我的“检查我可以提交”提交。我不希望它出现在拉取请求中。:)

我可以完全删除该提交吗？我可以在单个提交上发出拉取请求，还是会拉取我所有的提交？

我知道我可以在本地`git reset --hard HEAD~1`（这是一个我可以快速重做的小修复），但这只能修复我的本地仓库，而不是我的 github（分叉）仓库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T22:22:00.033

很多选择。

最好的选择可能是创建一个新分支并在该分支中挑选你的修复：

```
git checkout -b my-fix-branch origin/master
git cherry-pick master
git push -u origin my-fix-branch 
```

`my-fix-branch`然后在 GitHub 上做一个拉取请求。（这假设您的工作分支名为`master`，基于远程`master`；根据需要更改分支名称）。

* * *

*如果*没有人拉出或克隆你的分叉，你可以强行重写历史。执行`git rebase -i HEAD~2`并删除有问题的提交，然后`git push --force`. 这将破坏基于您的 fork 的任何其他 repo，因此如果您怀疑其他人正在使用您的 repo，请*不*要这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T22:21:49.477

我相信以下命令序列应该可以工作，假设您的无效提交只是当前 HEAD 之前的一次提交，并且分支名称是`master`.

**注意：**以下命令将重写历史记录，如果有人已经克隆了您的存储库，则不建议这样做。如果不是这样，那`push -f`应该没什么大不了的。

```
# Switch the current working tree to master branch
git checkout master
# Soft reset to get all the changes since HEAD~2 into the index/staging area
git reset --soft HEAD~2
# Remove the blafile from the staging area
git rm --cached blafile
# Commit the changes you actually intended to make
git commit
# Update the refs on the remote forcefully to push the newer commit.
# Note that if any one else has pulled master already with your blafile
# commit, they would be really pissed off with you now.
git push -f origin master 
```

# java - Java中AES加密和解密的首选方法

> ID：15648361
> 
> 赞同：0
> 
> 时间：2013-03-26T22:10:50.973
> 
> 标签：java, aes, encryption

我编写了以下两种加密和解密给定令牌的方法：

```
private static final String ALGORITHM_TYPE = "AES";
private static final String CIPHER_TRANSFORMATION = "AES/CBC/PKCS5Padding";
private static byte[] INITIALIZATION_VECTOR = new byte[] {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};
public String encrypt(String token) {
    Cipher cipher = null;
    SecretKey key = null;
    String tokenAsHex = null;
    byte[] encryptedToken = null;
    byte[] sksKey = getKeyAsByteArray(KEY); // SecretKeySpec key.

    try {
        key = new SecretKeySpec(sksKey, ALGORITHM_TYPE);
        AlgorithmParameterSpec paramSpec = new IvParameterSpec(INITIALIZATION_VECTOR);
        cipher = Cipher.getInstance(CIPHER_TRANSFORMATION);
        cipher.init(Cipher.ENCRYPT_MODE, key, paramSpec);
        encryptedToken = cipher.doFinal(Base64.encodeBase64(token.getBytes("UTF-8")));
    } catch (Exception e) {
        throw new EncryptionException(e);
    }
    return Base64.encodeBase64String(encryptedToken).toLowerCase();
}

public String decrypt(String token) throws EncryptionException {
    Cipher cipher = null;
    SecretKey key = null;
    byte[] decryptedToken = null;
    byte[] sksKey = getKeyAsByteArray(KEY); // SecretKeySpec key.
    try {
        key = new SecretKeySpec(sksKey, ALGORITHM_TYPE);            
        AlgorithmParameterSpec paramSpec = new IvParameterSpec(INITIALIZATION_VECTOR);
        cipher = Cipher.getInstance(CIPHER_TRANSFORMATION);
        cipher.init(Cipher.DECRYPT_MODE, key, paramSpec);
        decryptedToken = cipher.doFinal(Base64.decodeBase64(token));
    } catch(Exception e){
        throw new EncryptionException(e);    
    }
    if (decryptedToken == null) {
         throw new EncryptionException("Unable to decrypt the following token: " + token);
    }
    return Base64.encodeBase64String(decryptedToken);
} 
```

但是，我无法成功解密使用 encrypt 方法加密的任何字符串。我搜索了类似的问题，最接近的发现在这里：[Encrypt and decrypt with AES and Base64 encoding](https://stackoverflow.com/questions/3954611/aes-encript-and-decript-problem-with-apache-base64)。即使使用了类似的策略，我仍然无法解密加密的字符串。感谢任何帮助诊断问题的可能。

此外，我正在使用 Base64 对加密/解密字节数组进行编码，而不是创建一个新字符串，因为后者会导致不安全的 URL 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:16:56.853

您正在加密 base64 编码，然后重新对其进行 base64 编码，然后解密 base64 解码，然后出于某种原因对其进行 base64 编码。这没有意义。你应该：

1.  base64-encoding加密，即本质上`return Base64.encode(cipher.doFinal(...))`
2.  解密（1）的base64解码，即本质上`return cipher.doFinal(Base64.decode(...))`

# java - JDialog 未针对新输入进行更新

> ID：15648364
> 
> 赞同：2
> 
> 时间：2013-03-26T22:10:57.667
> 
> 标签：java, swing, jtextfield, jdialog

我正在构建我的第一个 gui，到目前为止一切正常，除了`JDialog`. 它在第一次使用时相应地接受名称和进程列表。但是当我把它拉回来输入新的输入时，它仍然没有响应。我认为这不是线程问题，因为我已经在`System.out.println ( SwingUtilities.isEventDispatchThread() );`整个源代码中使用多个语句测试了代码。这是可能导致问题的部分代码。

```
package testme;

import java.awt.BorderLayout;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*; 

public class Test {    
    JDialog dialog;
    JButton horseList, ok, clear;
    JPanel jpDialog = new JPanel();
    JPanel buttonPanel = new JPanel();
    GridBagLayout gbLayout = new GridBagLayout(); 
    BorderLayout borderLayout = new BorderLayout();
    GridBagConstraints gbc = new GridBagConstraints();
    int fnh = 8;
    JTextField[] jtxt = new JTextField[fnh];
    int[] hNum = new int[fnh];
    int[] hVal = new int[fnh];
    String[] hNam = new String[fnh];
    JFrame jfr = new JFrame();

     public Test()  {

       jfr.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
       jfr.setTitle("My Alladin Lamp"); 
       jfr.setSize( 200, 80 ); 
       jfr.setVisible( true );
       jfr.setLayout( borderLayout );

       horseList = new JButton( "Enter Horse Names" ); 
       jfr.add( horseList, BorderLayout.CENTER );
       horseList.addActionListener( new ActionListener() {   
          @Override
          public void actionPerformed( ActionEvent e ) {      
           dialog = new JDialog( jfr, "Enter Horse Names", true );
           dialog.setDefaultCloseOperation( JFrame.DISPOSE_ON_CLOSE ); 
           dialog.setSize( 260, 400 );                      
           jpDialog.setLayout( gbLayout );           
           JLabel label;
           String str;
           for( int i = 0; i < fnh; i++ )
           {                   
              gbc.gridx = 0;
              gbc.gridy = i;           
              str = new Integer( i+1 ) + ".";                  
              label = new JLabel( str ); 
              jpDialog.add( label, gbc );         

              gbc.gridx = 1;
              gbc.gridy = i;
              gbc.ipady = 4;
              gbc.insets = new Insets(4,0,0,0);
              jtxt[i] = new JTextField(15);  
              jpDialog.add( jtxt[i], gbc );               
           }
           buttonPanel = new JPanel();        
           ok = new JButton( "OK" );           
           ok.addActionListener( new ActionListener() {
              @Override
              public void actionPerformed( ActionEvent e ) {     
               for( int i = 0; i < fnh; i++ ) {               
                  hNam[i] = jtxt[i].getText();                                 
               }

               dialog.dispose();   
             }
           });          
           buttonPanel.add( ok ); 

           clear = new JButton ( "CLEAR" );        
           clear.addActionListener( new ActionListener() {
               @Override
               public void actionPerformed( ActionEvent e ) {
                  for( int i = 0; i < fnh; i++ )              
                     if ( !"".equals( jtxt[i].getText() ) )
                     jtxt[i].setText( "" );        
                  }
            });          

           buttonPanel.add( clear );       
           JScrollPane jscr = new JScrollPane( jpDialog );  
           dialog.add( jscr, BorderLayout.CENTER ); 
           dialog.add( buttonPanel, BorderLayout.SOUTH ); 
           dialog.setVisible( true );    
           }
       }); 

     }

// -------------------------------------------------------------------------

    public static void main( String args[] )  {                
        SwingUtilities.invokeLater( new Runnable()  {
            @Override
            public void run()
            {
                Test test = new Test();
            }
        });
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:20:49.320

当 `dispose`被调用时，对话框的资源被释放。您必须完全从头开始分配一个新的，或者 - 更好`setVisible(false)`的是 - 调用以关闭对话框，然后`setVisible(true)`在您再次需要它时调用。

第二种方法更好，因为复杂的对话可能需要相当长的时间来构建。立即弹出对话框对用户来说是一种更好的体验。由于这个原因，我的应用程序在应用程序启动期间构建了复杂的对话框 - 在任何用户界面可见之前，而启动画面仍在显示。

您可以覆盖`setVisible`以确保对话框在每次显示时都重新初始化。

如果您仍然想在每次需要对话框时从头开始构建，然后`dispose`在用户进行选择时，那么最好的方法是子类化`JDialog`。您的代码失败，因为它在封闭类中分配对话框的某些部分（例如布局），然后假设这些部分在`dispose()`调用后仍然存在。这是个大问题。如果你子类化`JDialog`，你几乎不可能犯这样的错误。对话框的各个部分都将在构造函数中分配并在子类本身中引用。在对话框为 之后`displosed`，不能存在对其字段/成员的引用。

好的，我将展示一个处理几种常见情况的示例：

1.  每次对话框可见时刷新组件数据。
2.  每次对话框可见时清除选择。
3.  如果按下 OK 或双击等等效操作，则布尔标志为真。
4.  如果按下取消或用户手动关闭对话框，则标志为假。

这个成语在一些相当大的应用程序上对我来说效果很好。我希望它对你有帮助。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Test extends JFrame {

    // The dialog we'll create and use repeatedly.
    TestDialog testDialog;

    // Some words to fill a list.
    String [] words = ("Four score and seven years ago our fathers brought "
            + "forth on this continent a new nation conceived in liberty and "
            + "dedicated to the proposition that all men are created equal")
            .split("\\s+");

    // Start index of words to load next time dialog is shown.
    int wordIndex = 0;

    // A place we'll show what was done by the dialog.
    JLabel msg;

    public Test() {

        setSize(800, 600);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // Add the "show dialog" button.
        JButton showDialog = new JButton("Press to show the dialog");
        add(showDialog, BorderLayout.NORTH);

        // Add the "dialog result" label.
        msg = new JLabel("  Dialog Result: --");
        add(msg, BorderLayout.CENTER);

        showDialog.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                // Create the dialog lazily.
                if (testDialog == null) {
                    testDialog = new TestDialog(Test.this);
                }
                // Load fresh data in the dialog prior to showing it.  
                // Here it's just an array of words into the dialog.
                String [] newWords = new String[5];
                for (int i = 0; i < newWords.length; i++) {
                    newWords[i] = words[wordIndex];
                    wordIndex = (wordIndex + 1) % words.length;
                }
                testDialog.initialize(newWords);

                // Show the dialog and block until user dismisses it.
                testDialog.setVisible(true);

                // Handle the result.  Here we just post a message.
                if (testDialog.getOkClicked()) {
                    msg.setText("Ok, we have: " + testDialog.getSelectedString());
                }
                else {
                    msg.setText("Cancelled!");
                }
            }
        });        
    }

    public static void main(String[] args) {
        // Don't forget Swing code must run in the UI thread, so
        // must invoke setVisible rather than just calling it.
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test().setVisible(true);
            }
        });
    }
}

// A test dialog with some common UI idioms. Subclass JDialog so
// that all dialog data is encapsulated.  Nice and clean.
class TestDialog extends JDialog {

    // A list of words that can be double-clicked to return a result.
    private final JList<String> list;

    // A design pattern that works well for all modal dialogs:
    // Boolean flag that's True if OK was clicked, list double-clicked, etc.
    // False if the dialog was cancelled or closed with no action.
    boolean okClicked;

    public TestDialog(JFrame owner) {

        super(owner, true); // true => modal!

        JPanel content = new JPanel(new GridBagLayout());

        // Initialize all dialog components and set listeners.

        // Hierarchy listener is a way to detect actual visibility changes.
        addHierarchyListener(new HierarchyListener() {
            @Override
            public void hierarchyChanged(HierarchyEvent e) {
                // Reset the ok clicked flag every time we become visible.
                // We could also do this by overriding setVisible, but this is cleaner.
                // Can also do other state settings like clearing selections.
                if (isVisible()) {
                    okClicked = false;
                    list.clearSelection();
                }
            }
        });

        // Set up child components.
        // The usual Java layout fiddling. Nothing special here.
        // Add the list first at position (0,0) spanning 2 columns.
        GridBagConstraints constraint = new GridBagConstraints();
        constraint.fill = GridBagConstraints.HORIZONTAL;
        constraint.gridwidth = 2;
        list = new JList<>(new String[]{});
        list.addMouseListener(new MouseAdapter() {

            @Override
            public void mouseClicked(MouseEvent e) {

                // Treat double click on list as select+OK press.
                if (e.getClickCount() == 2) {
                    okClicked = true;
                    setVisible(false);
                }
            }
        });
        content.add(list, constraint);

        // Add Cancel button below list and in left column.
        constraint.gridwidth = 1;
        constraint.fill = GridBagConstraints.NONE;
        constraint.gridy = 1;
        JButton cancel = new JButton("Cancel");
        cancel.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) { 

                // OK not clicked here! Let flag alone.
                setVisible(false);  
            }
        });
        content.add(cancel, constraint);

        // Add OK button below list and in right column.
        constraint.gridx = 1;
        JButton ok = new JButton("OK");
        ok.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                okClicked = true;
                setVisible(false);
            }
        });
        content.add(ok, constraint);

        // Replace default content pane with our JPanel.
        setContentPane(content);
    }

    // Fill the list in the dialog with fresh values.
    public void initialize(final String [] vals) {
        list.setModel(new AbstractListModel<String>() {
            @Override public int getSize() { return vals.length; }
            @Override public String getElementAt(int index) { return vals[index]; }
        });
        pack(); // Resize to fit contents.
        setLocationRelativeTo(getOwner());  // Position in middle of parent.
    }

    public boolean getOkClicked() {
        return okClicked;
    }

    public String getSelectedString() {
        String val =  list.getSelectedValue();
        return (val == null) ? "[none]"  : val;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T01:12:25.527

即使您创建了一个新的 JDialog，您每次都使用相同的 JPanel，jpDialog，它包含原始 JTextField。创建一个新的一切，包括 JPanel。

```
 dialog = new JDialog( jfr, "Enter Horse Names", true );
       dialog.setDefaultCloseOperation( JFrame.DISPOSE_ON_CLOSE ); 
       dialog.setSize( 260, 400 );        

       jpDialog = new JPanel(); // !! added !! ***********

       jpDialog.setLayout( gbLayout );           
       JLabel label;
       String str; 
```

不过，我自己只保留一个对话框和面板，并在需要时将其清除，而不是继续重新创建 GUI。

就像是：

```
import java.awt.BorderLayout;
import java.awt.Dialog.ModalityType;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.Window;
import java.awt.event.ActionEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.event.WindowListener;

import javax.swing.*;

public class Test2 {
   private static final int HORSE_NAMES_FIELD_COUNT = 10;
   private JPanel mainPanel = new JPanel();
   private EnterHorseNames enterHorsesNames = new EnterHorseNames(
         HORSE_NAMES_FIELD_COUNT);
   private JDialog enterHorseNamesDialog = null;

   public Test2() {
      mainPanel.add(new JButton(new EnterHorsesAction("Enter Horse Names")));
   }

   public JComponent getMainComponent() {
      return mainPanel;
   }

   private class EnterHorsesAction extends AbstractAction {

      public EnterHorsesAction(String text) {
         super(text);
      }

      @Override
      public void actionPerformed(ActionEvent evt) {
         if (enterHorseNamesDialog == null) {
            Window mainWindow = SwingUtilities.getWindowAncestor(mainPanel);
            enterHorseNamesDialog = new JDialog(mainWindow,
                  "Enter Horses Name", ModalityType.APPLICATION_MODAL);
            enterHorseNamesDialog.getContentPane().add(enterHorsesNames.getMainComponent());
            enterHorseNamesDialog.pack();
            enterHorseNamesDialog.setLocationRelativeTo(mainWindow);

         }

         enterHorseNamesDialog.setVisible(true);

         System.out.println("Horse Names:");
         for (int row = 0; row < HORSE_NAMES_FIELD_COUNT; row++) {
            System.out.printf("%2d: %s%n", row + 1, enterHorsesNames.getTextFieldText(row));
         }

         // clear fields
         enterHorsesNames.clearFields();

      }

   }

   private static void createAndShowGui() {
      Test2 test2 = new Test2();

      JFrame frame = new JFrame("Test2");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(test2.getMainComponent());
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

class EnterHorseNames {
   private static final int FIELD_COLS = 18;
   private JPanel mainPanel = new JPanel();
   private JTextField[] textFields;

   public EnterHorseNames(int fieldCount) {
      textFields = new JTextField[fieldCount];
      JPanel centralPanel = new JPanel(new GridBagLayout());
      for (int i = 0; i < textFields.length; i++) {
         textFields[i] = new JTextField(FIELD_COLS);
         addField(centralPanel, textFields[i], i);
      }

      JPanel btnPanel = new JPanel(new GridLayout(1, 0, 5, 0));
      btnPanel.add(new JButton(new OkAction("OK")));
      btnPanel.add(new JButton(new ClearAction("Clear")));

      mainPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
      mainPanel.setLayout(new BorderLayout(5, 5));
      mainPanel.add(centralPanel, BorderLayout.CENTER);
      mainPanel.add(btnPanel, BorderLayout.PAGE_END);
   }

   public void clearFields() {
      for (int i = 0; i < textFields.length; i++) {
         textFields[i].setText("");
      }
   }

   public String getTextFieldText(int row) {
      if (row < 0 || row >= textFields.length) {
         throw new ArrayIndexOutOfBoundsException(row);
      }

      return textFields[row].getText();
   }

   private void addField(JPanel container, JTextField textField, int row) {
      GridBagConstraints gbc = new GridBagConstraints(0, row, 1, 1, 1.0, 1.0,
            GridBagConstraints.WEST, GridBagConstraints.BOTH, new Insets(5, 5,
                  5, 10), 0, 0);
      container.add(new JLabel(String.valueOf(row + 1)), gbc);

      gbc.gridx = 1;
      gbc.anchor = GridBagConstraints.EAST;
      gbc.fill = GridBagConstraints.HORIZONTAL;
      gbc.insets = new Insets(5, 10, 5, 5);
      container.add(textField, gbc);
   }

   public JComponent getMainComponent() {
      return mainPanel;
   }

   private class OkAction extends AbstractAction {
      public OkAction(String text) {
         super(text);
      }

      @Override
      public void actionPerformed(ActionEvent evt) {
         Window win = SwingUtilities.getWindowAncestor(mainPanel);
         win.setVisible(false);
      }
   }

   private class ClearAction extends AbstractAction {
      public ClearAction(String text) {
         super(text);
      }

      @Override
      public void actionPerformed(ActionEvent e) {
         clearFields();
      }
   }

} 
```

# html - 将控制器默认为 JSON 后，如何在 CakePHP 中创建一个方法输出正常的 HTML？

> ID：15648370
> 
> 赞同：0
> 
> 时间：2013-03-26T22:11:21.597
> 
> 标签：html, json, cakephp, views, output

我正在构建一个 Android 应用程序，并且在我的服务器端使用 CakePHP。我有一个用户控制器，它返回用于登录、注册等的 JSON 数据，除了 accountActivation。由于此帐户激活方法仅在 Web 浏览器客户端中调用，因此我想显示一个简单的 HTML 页面而不输出 JSON。在我的控制器默认返回 JSON 数据后，我该怎么做？我已将其默认为 JSON `public $viewClass = 'Json';`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T01:44:59.247

阅读本章，它描述了如何做 json 视图的最佳方法。 [http://book.cakephp.org/2.0/en/views/json-and-xml-views.html](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html)

如果我正确理解您的问题，您想在发送 json 后发送 HTML 吗？好吧，你不能在同一个响应中返回两个不同的东西。

如果您正在寻找分离数据，请阅读链接。只需添加像 /users/action.json 这样的 json 扩展名，你就会得到一个 json 响应，如果不是 HTML 的话。

# css - 我如何将这个简单的幻灯片居中？

> ID：15648371
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:11:21.507
> 
> 标签：css, slideshow

我一直试图让这个幻灯片居中但没有成功：

[http://www.lateralcode.com/simple-slideshow/](http://www.lateralcode.com/simple-slideshow/)

看来`position: absolute`这才是真正困扰我的...

如何使此幻灯片居中，以便在调整页面大小时看起来正确，并且幻灯片仍然可以正常工作？

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:20:38.623

您可以将具有 css 属性的元素居中，`position:absolute`如下所示：

```
.elem { 
    position: absolute; width:200px; height:200px; left:50%;
    margin-left:-100px; /* you need to deduct half width from margin left */
} 
```

[**这是jsFiddle。**](http://jsfiddle.net/jMBaV/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:20:38.830

用 div 包裹那个 ul 。

```
<div id="slider">
  <ul></ul>
</div>

#slider{
width:650px;
margin-left:auto;
margin-right:auto"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:18:19.717

我使用它来工作：

```
.ppt img { margin-left:-50%; }
.ppt li { left:50%; } 
```

# matlab - 在matlab中匹配或排序数组行

> ID：15648375
> 
> 赞同：0
> 
> 时间：2013-03-26T22:11:35.763
> 
> 标签：matlab

我在 Matlab 中有以下数组：

```
-60528084   -60780607
-60497166   -60750204
-60466187   -60719738
-60435147   -60689209
-60404046   -60658618
-60372884   -60627965
-60341661   -60597249
-60310378   -60566472
-60279035   -60535633
-60247632   -60504732
-60216170   -60473770
-60184647   -60442747
-60153066   -60411663
-60121425   -60380518 
```

我需要一个代码/函数来对这个数组进行排序，如下所示：

```
 -60780607
            -60750204
            -60719738
            -60689209
            -60658618
            -60627965
            -60597249
            -60566472
-60528084   -60535633
-60497166   -60504732
-60466187   -60473770
-60435147   -60442747
-60404046   -60411663
-60372884   -60380518
-60341661   
-60310378   
-60279035   
-60247632   
-60216170   
-60184647   
-60153066   
-60121425 
```

这个 SORT 所做的是匹配非常相似的行值。值不一样，但几乎一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T01:00:49.430

您可以使用：

```
[ms,ix]=sort(m(:)) 
```

得到整个排序列表和矩阵 m 的线性索引。然后您可以使用`ind2sub`来获取排序索引的相关列：

```
[r c]=ind2sub(size(m),ix); 
```

然后该排序向量的差异并设置接近阈值（例如10000），

```
proximity_threshold=1e4; %# change as needed
ind=(diff(ms)<proximity_threshold) 
```

然后使用阈值条件重建您的答案：

```
n=0;
nn=0;
while n<numel(ix)
    n=n+1;
    nn=nn+1;
    try
        if ind(n) & c(n)~=c(n+1)
            a(nn,c(n))=ms(n);
            a(nn,c(n+1))=ms(n+1);
             n=n+1;

        else
            a(nn,c(n))=ms(n);

        end
    end
end

        a =
               0   -60780607
               0   -60750204
               0   -60719738
               0   -60689209
               0   -60658618
               0   -60627965
               0   -60597249
               0   -60566472
       -60528084   -60535633
       -60497166   -60504732
       -60466187   -60473770
       -60435147   -60442747
       -60404046   -60411663
       -60372884   -60380518
       -60341661           0
       -60310378           0
       -60279035           0
       -60247632           0
       -60216170           0
       -60184647           0
       -60153066           0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:21:45.043

假设您只想找到最佳班次，您可以轻松做到以下几点：

1.  从某个位置开始，计算它的“好”程度（例如平方非零邻居的平均值）记录偏移量
2.  再移一个，看看是否更好。如果更好地记住这个转变。
3.  如果可以进一步移动，请重复步骤 2。

# c# - 裁剪图像而不复制

> ID：15648378
> 
> 赞同：5
> 
> 时间：2013-03-26T22:12:11.323
> 
> 标签：c#, performance, crop, bitmapimage

我正在编写一个应用程序，需要我将大图像分割成小图块，其中每个图块本质上是原始图像的裁剪版本。

目前我的拆分操作看起来像这样

```
tile.Image = new BitmapImage();
tile.Image.BeginInit();
tile.Image.UriSource = OriginalImage.UriSource;
tile.Image.SourceRect = new Int32Rect(x * tileWidth + x, y * tileHeight, tileWidth, tileHeight);
tile.Image.EndInit(); 
```

直觉上，我认为这基本上会创建对原始图像的“参考”，并且只会显示为图像的子矩形。然而，我的分割操作执行速度很慢，让我相信这实际上是在复制原始图像的源矩形，这对于大图像来说非常慢（分割一个像样的图像时会有明显的 3-4 秒停顿）大小图像）。

我环顾四周，但无法找到一种方法将位图绘制为大图像的子矩形，而无需复制任何数据。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T23:22:06.930

使用 System.Windows.Media.Imaging.CroppedBitmap 类：

```
// Create a CroppedBitmap from the original image.
Int32Rect rect = new Int32Rect(x * tileWidth + x, y * tileHeight, tileWidth, tileHeight);
CroppedBitmap croppedBitmap = new CroppedBitmap(originalImage, rect);

// Create an Image element.
Image tileImage = new Image();
tileImage.Width = tileWidth;
tileImage.Height = tileHeight;
tileImage.Source = croppedBitmap; 
```

# xaml - LayoutRootStyle 的 EntranceThemeTransition 是如何级联到子控件的？

> ID：15648390
> 
> 赞同：0
> 
> 时间：2013-03-26T22:12:48.777
> 
> 标签：xaml, windows-runtime, windows-store-apps, winrt-xaml

我现在正在阅读[WinRT-XAML 教程](http://msdn.microsoft.com/en-us/library/windows/apps/br211380.aspx)，我无法弄清楚为什么 WebView 控件不执行与其他控件相同的入口动画。有一个部分`Adding animations and transitions`解释了它不是预期的，并且需要一个带有动画的情节提要来做到这一点。

我找到了将转换应用于 StandardStyles.xaml 中其他控件的设置器的来源。

```
<Style x:Key="LayoutRootStyle" TargetType="Panel">
    <Setter Property="Background" Value="{StaticResource ApplicationPageBackgroundThemeBrush}"/>
    <Setter Property="ChildrenTransitions">
        <Setter.Value>
            <TransitionCollection>
                <EntranceThemeTransition/>
            </TransitionCollection>
        </Setter.Value>
    </Setter>
</Style> 
```

看起来这应该将 EntranceThemeTransition 应用于具有这种样式的面板的每个子控件 - 或者它应该只将过渡应用于其直接子控件。它似乎两者兼而有之。

此外，我希望没有任何定位信息的控件与它们的父级一起被动画化。情况似乎并非如此，WebView 的直接父级动画就好了。

在这种情况下，是什么让 WebView 如此特别？除了它不是默认模板的一部分之外。为什么我们需要添加一个 PopInThemeAnimation 和 Storyboard 来让这个控件移动，为什么它的移动速度与它应该在里面的控件不同！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:07:13.533

A`WebView`是一个特殊控件，它位于其自己的 HWND（经典 WinAPI 窗口）中，而不是在深度平面空间（jupiter 窗口）中呈现的其他典型的基于 XAML 的 UI。因此，它位于所有其他控件之上的自己的空域（将其捆绑起来）。当您想要对其进行动画处理或在其上覆盖一些其他内容（例如应用栏）时，您通常会将其替换为填充了与`WebViewBrush`WebView 同步的其他控件（例如 Rectangle）。

我认为（某些）主题动画使用[Windows 动画管理器](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371981%28v=vs.85%29.aspx)或其他机制而不是常规 Storyboard，并且 WebView 控件可能无法很好地使用它。

我的建议是 - 如果它不适用于您尝试使用的东西（EntranceThemeTransition） - 使用不同的东西（基于故事板的常规动画）。

# javascript - 用于 dojo/dgrid 的 TextArea 单元格渲染器

> ID：15648392
> 
> 赞同：1
> 
> 时间：2013-03-26T22:12:58.720
> 
> 标签：javascript, dojo, dgrid

我正在使用 dgrid/Grid 来定义表结构。**我希望表格单元格显示多行文本**。我想出了如何让单元格编辑器成为 TextArea。但是，**我不清楚如何让渲染器也显示多行文本。我该如何做到这一点？**这就是我所拥有的：

```
editor({label: "First Name", field: "first", sortable: false, editor: getCellEditor, editOn: "dblclick", dismissOnEnter: false}) 
```

“getCellEditor”是返回**dijit/form/TextArea**的辅助方法。双击单元格会产生一个多行文本区域。但是，当我完成编辑并离开单元格时，单元格文本将恢复为单行显示。这是整个网格定义：

```
function getCellEditor() {
    return new TextArea();
}           

// Create a new constructor by mixing in the components
var CustomGrid = declare([ Grid, Keyboard, Selection, ColumnSet, ColumnResizer, editor ]);

var grid = new CustomGrid({
    columnSets: [
        [
            [
                editor({label: "First Name", field: "first", sortable: false, editor: getCellEditor, editOn: "dblclick", dismissOnEnter: false})
            ]
        ], 
        [
            [
                editor({ label: "Last Name", field: "last", sortable: false, editor: getCellEditor, editOn: "dblclick", dismissOnEnter: false}),
                editor({ label: "Age", field: "age", sortable: false, editor: getCellEditor, editOn: "dblclick", dismissOnEnter: false})
            ]

        ]
    ],
    selectionMode: "single", // for Selection; only select a single row at a time
    cellNavigation: true // for Keyboard; allow only row-level keyboard navigation
}, "grid"); 
```

这是我的第一个 JavaScript 问题，所以请原谅任何缺失/不充分的信息。如果您需要任何其他信息来回答此问题，请告诉我。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-27T03:39:23.430

在 renderCell 函数中，您可以在 textarea 小部件中定义属性。

```
function getCellEditor() {
   return new TextArea({
      rows:"5"
   });
} 
```

试试这个可能对你有帮助。

# ruby-on-rails - Rails - 如何在不使用 Accepts_nested_attributes_for 的情况下管理嵌套属性？

> ID：15648396
> 
> 赞同：8
> 
> 时间：2013-03-26T22:13:15.547
> 
> 标签：ruby-on-rails, nested-forms, nested-attributes, model-associations, update-attributes

我的问题是我遇到了accepts_nested_attributes_for 的限制，所以我需要弄清楚如何自己复制该功能以获得更大的灵活性。（到底是什么让我感到困惑。）**所以我的问题是：如果我想模仿和增加accepts_nested_attributes_for，我的表单、控制器和模型应该是什么样子？真正的诀窍是我需要能够使用现有的关联/属性更新现有的和新的模型。**

我正在构建一个使用嵌套表单的应用程序。我最初将此 RailsCast 用作蓝图（利用 Accepts_nested_attributes_for）：[Railscast 196: Nested Model Form](http://railscasts.com/episodes/196-nested-model-form-revised)。

我的应用程序是带有作业（任务）的清单，我让用户更新清单（名称、描述）并在一个表单中添加/删除关联的作业。这很好用，但是当我将它合并到我的应用程序的另一个方面时遇到了问题：通过版本控制历史。

我的应用程序的很大一部分是我需要为我的模型和关联记录历史信息。我最终推出了自己的版本控制（[这](https://stackoverflow.com/questions/15235524/rails-3-2-app-should-i-use-a-versioning-gem-paper-trail-or-vestal-versions-o)是我的问题，我在其中描述了我的决策过程/考虑因素），其中很大一部分是一个工作流程，我需要创建旧事物的新版本，对新版本进行更新，存档旧版本。这对用户来说是不可见的，他们认为这种体验只是通过 UI 更新模型。

代码 - 模型

```
#checklist.rb
class Checklist < ActiveRecord::Base
  has_many :jobs, :through => :checklists_jobs
  accepts_nested_attributes_for :jobs, :reject_if => lambda { |a| a[:name].blank? }, :allow_destroy => true
end

#job.rb
class Job < ActiveRecord::Base
  has_many :checklists, :through => :checklists_jobs
end 
```

代码 - 当前形式（注意：@jobs 被定义为清单控制器编辑操作中此清单的未归档作业；@checklist 也是如此）

```
<%= simple_form_for @checklist, :html => { :class => 'form-inline' } do |f| %>
  <fieldset>
    <legend><%= controller.action_name.capitalize %> Checklist</legend><br>

    <%= f.input :name, :input_html => { :rows => 1 }, :placeholder => 'Name the Checklist...', :class => 'autoresizer'  %>
    <%= f.input :description, :input_html => { :rows => 3 }, :placeholder => 'Optional description...', :class => 'autoresizer' %>

    <legend>Jobs on this Checklist - [Name] [Description]</legend>

    <%= f.fields_for :jobs, @jobs, :html => { :class => 'form-inline' } do |j| %>
        <%= render "job_fields_disabled", :j => j %>
    <% end %>
    </br>
    <p><%= link_to_add_fields "+", f, :jobs %></p>

    <div class="form-actions">
      <%= f.submit nil, :class => 'btn btn-primary' %>
      <%= link_to 'Cancel', checklists_path, :class => 'btn' %>
    </div>
  </fieldset>
<% end %> 
```

代码 - 来自 checklists_controller.rb#Update 的片段

```
def update
  @oldChecklist = Checklist.find(params[:id])

# Do some checks to determine if we need to do the new copy/archive stuff
  @newChecklist = @oldChecklist.dup
  @newChecklist.parent_id = (@oldChecklist.parent_id == 0) ? @oldChecklist.id : @oldChecklist.parent_id
  @newChecklist.predecessor_id = @oldChecklist.id
  @newChecklist.version = (@oldChecklist.version + 1)
  @newChecklist.save

# Now I've got a new checklist that looks like the old one (with some updated versioning info).

# For the jobs associated with the old checklist, do some similar archiving and creating new versions IN THE JOIN TABLE
  @oldChecklist.checklists_jobs.archived_state(:false).each do |u|
    x = u.dup
    x.checklist_id = @newChecklist.id
    x.save
    u.archive
    u.save
  end

# Now the new checklist's join table entries look like the old checklist's entries did
# BEFORE the form was submitted; but I want to update the NEW Checklist so it reflects 
# the updates made in the form that was submitted.
# Part of the params[:checklist] has is "jobs_attributes", which is handled by
# accepts_nested_attributes_for. The problem is I can't really manipulate that hash very
# well, and I can't do a direct update with those attributes on my NEW model (as I'm 
# trying in the next line) due to a built-in limitation.
  @newChecklist.update_attributes(params[:checklist]) 
```

这就是我遇到 accept_nested_attributes_for 限制的地方（它[在这里](https://github.com/rails/rails/issues/7256)记录得很好。我得到“找不到 ID=X 的 Model1 和 ID=Y 的 Model2”异常，这基本上是按设计的。

那么，如何创建多个嵌套模型并在父模型的表单上添加/删除它们，类似于 accept_nested_attributes_for 所做的，但我自己？

我见过的选项 - 是最好的选项之一吗？**真正的诀窍是我需要能够使用现有的关联/属性更新现有的和新的模型。**我无法链接它们，所以我将命名它们。

繁文缛节（在 github 上） Virtus（也在 github 上）

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T00:04:41.507

您可能想要删除复杂的 Accepts_nested 内容并创建一个自定义类或模块来包含所需的所有步骤。

这篇文章中有一些有用的东西

[http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/](http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/)

特别是第3点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-04T06:41:47.913

由于马里奥评论了我的问题并问我是否解决了它，我想我会分享我的解决方案。

我应该说我确信这不是一个非常优雅的解决方案，也不是很好的代码。但这就是我想出的，并且有效。由于这个问题非常技术性，我不会在这里发布伪代码 - 我正在发布 Checklist 模型和 Checklists 控制器更新操作的完整代码（无论如何，适用于这个问题的代码部分）。我也很确定我的交易块实际上没有做任何事情（我需要修复这些）。

基本思想是我手动打破了更新操作。我没有依赖 update_attributes（和 accept_nested_attributes_for），而是分两个阶段手动更新清单：

1.  实际的清单对象是否发生了变化（清单只有名称和描述）？如果确实如此，请创建一个新清单，使新清单成为旧清单的子项，并使用为其添加或选择的任何工作设置新清单。
2.  如果清单本身没有改变（名称和描述保持不变），分配给它的工作是否改变了？如果有，请归档已删除的工作分配，并添加任何新的工作分配。

我认为这里有一些“提交”的东西可以安全地忽略（它基本上是逻辑来确定它是否甚至对清单的变化很重要——如果没有任何提交（清单的历史数据的记录），那么只需更新清单放置而不做任何这些归档或添加/减去工作的东西）。

我不知道这是否会有所帮助，但无论如何都是这样。

**代码 - checklist.rb（模型）**

```
class Checklist < ActiveRecord::Base
  scope :archived_state, lambda {|s| where(:archived => s) }

  belongs_to :creator, :class_name => "User", :foreign_key => "creator_id"
  has_many :submissions
  has_many :checklists_jobs, :dependent => :destroy, :order => 'checklists_jobs.job_position'#, :conditions => {'archived_at' => nil}
  has_many :jobs, :through => :checklists_jobs
  has_many :unarchived_jobs, :through => :checklists_jobs, 
           :source => :job, 
           :conditions => ['checklists_jobs.archived = ?', false], :order => 'checklists_jobs.job_position'
  has_many :checklists_workdays, :dependent => :destroy
  has_many :workdays, :through => :checklists_workdays

  def make_child_of(old_checklist)
    self.parent_id = (old_checklist.parent_id == 0) ? old_checklist.id : old_checklist.parent_id
    self.predecessor_id = old_checklist.id
    self.version = (old_checklist.version + 1)
  end

  def set_new_jobs(new_jobs)
    new_jobs.to_a.each do |job|
      self.unarchived_jobs << Job.find(job) unless job.nil?
    end
  end

  def set_jobs_attributes(jobs_attributes, old_checklist)
    jobs_attributes.each do |key, entry| 
      # Job already exists and should have a CJ
      if entry[:id] && !(entry[:_destroy] == '1')
       old_cj = old_checklist.checklists_jobs.archived_state(:false).find_by_job_id(entry[:id])
       new_cj = ChecklistsJob.new job_position: old_cj.job_position, job_required: old_cj.job_required
       new_cj.checklist = self
       new_cj.job = old_cj.job
       new_cj.save!
      # New job, should be created and added to new checklist only
      else
       unless entry[:_destroy] == '1'
         entry.delete :_destroy
         self.jobs << Job.new(entry)
       end
      end
    end
  end

  def set_checklists_workdays!(old_checklist)
    old_checklist.checklists_workdays.archived_state(:false).each do |old_cw|
      new_cw = ChecklistsWorkday.new checklist_position: old_cw.checklist_position
      new_cw.checklist = self
      new_cw.workday = old_cw.workday
      new_cw.save!
      old_cw.archive
      old_cw.save!
    end
  end

  def update_checklists_jobs!(jobs_attributes)
    jobs_attributes.each do |key, entry|
      if entry[:id] # Job was on self when #edit was called
        old_cj = self.checklists_jobs.archived_state(:false).find_by_job_id(entry[:id])
        #puts "OLD!! "+old_cj.id.to_s
        unless entry[:_destroy] == '1' 
          new_cj = ChecklistsJob.new job_position: old_cj.job_position, job_required: old_cj.job_required
          new_cj.checklist = self
          new_cj.job = old_cj.job
          new_cj.save!
        end
        old_cj.archive
        old_cj.save!
      else # Job was created on this checklist
        unless entry[:_destroy] == '1'
          entry.delete :_destroy
          self.jobs << Job.new(entry)
        end
      end
    end
  end
end 
```

**代码 - checklists_controller.rb（控制器）**

```
class ChecklistsController < ApplicationController
  before_filter :admin_user

  def update
    @checklist = Checklist.find(params[:id])
    @testChecklist = Checklist.find(params[:id])
    @oldChecklist = Checklist.find(params[:id])
    @job_list = @checklist.unarchived_jobs.exists? ? Job.archived_state(:false).where( 'id not in (?)', @checklist.unarchived_jobs) : Job.archived_state(:false)

    checklist_ok = false
    # If the job is on a submission, do archiving/copying; else just update it
    if @checklist.submissions.count > 0
      puts "HERE A"
      # This block will tell me if I need to make new copies or not
      @testChecklist.attributes=(params[:checklist])
      jobs_attributes = params[:checklist][:jobs_attributes]
      if @testChecklist.changed?
        puts "HERE 1"
        params[:checklist].delete :jobs_attributes        
        @newChecklist = Checklist.new(params[:checklist])
        @newChecklist.creator = current_user
        @newChecklist.make_child_of(@oldChecklist)
        @newChecklist.set_new_jobs(params[:new_jobs])

        begin
          ActiveRecord::Base.transaction do
            @newChecklist.set_jobs_attributes(jobs_attributes, @oldChecklist) if jobs_attributes
            @newChecklist.set_checklists_workdays!(@oldChecklist)
            @newChecklist.save!
            @oldChecklist.archive
            @oldChecklist.save!
            @checklist = @newChecklist
            checklist_ok = true
          end
          rescue ActiveRecord::RecordInvalid 
          # This is a NEW checklist, so it's acting like it's "new" - WRONG?
          puts "RESCUE 1"
          @checklist = @newChecklist
          @jobs = @newChecklist.jobs     
          checklist_ok = false
        end              
      elsif @testChecklist.changed_for_autosave? || params.has_key?(:new_jobs)
        puts "HERE 2"    
        # Associated Jobs have changed, so archive old checklists_jobs,
        # then set checklists_jobs based on params[:checklist][:jobs_attributes] and [:new_jobs]

        @checklist.set_new_jobs(params[:new_jobs])

        begin
          ActiveRecord::Base.transaction do
            @checklist.update_checklists_jobs!(jobs_attributes) if jobs_attributes
            @checklist.save!
            checklist_ok = true
          end
          rescue ActiveRecord::RecordInvalid      
          puts "RESCUE 2"
          @jobs = @checklist.unarchived_jobs
          checklist_ok = false
        end
      else
        checklist_ok = true # There were no changes to the Checklist or Jobs
      end
    else
      puts "HERE B"
      @checklist.set_new_jobs(params[:new_jobs])
      begin
        ActiveRecord::Base.transaction do
          @checklist.update_attributes(params[:checklist])
          checklist_ok = true
        end
        rescue ActiveRecord::RecordInvalid 
        puts "RESCUE B"
        @jobs = @checklist.jobs     
        checklist_ok = false
      end
    end

    respond_to do |format|
      if  checklist_ok
        format.html { redirect_to @checklist, notice: 'List successfully updated.' }
        format.json { head :no_content }
      else
        flash.now[:error] = 'There was a problem updating the List.'
        format.html { render action: "edit" }
        format.json { render json: @checklist.errors, status: :unprocessable_entity }
      end
    end
  end
end 
```

**代码 - 清单表格**

```
<%= form_for @checklist, :html => { :class => 'form-inline' } do |f| %>
  <div>
    <%= f.text_area :name, :rows => 1, :placeholder => 'Name the list...', :class => 'autoresizer checklist-name' %></br>
    <%= f.text_area :description, :rows => 1, :placeholder => 'Optional description...', :class => 'autoresizer' %>
  </div>

  <%= f.fields_for :jobs, :html => { :class => 'form-inline' } do |j| %>
    <%= render "job_fields", :j => j  %>
  <% end %>

  <span class="add-new-job-link"><%= link_to_add_fields "add a new job", f, :jobs %></span>
  <div class="form-actions">
    <%= f.submit nil, :class => 'btn btn-primary' %>
    <%= link_to 'Cancel', checklists_path, :class => 'btn' %>
  </div>

  <% unless @job_list.empty? %>
    <legend>Add jobs from the Job Bank</legend>

    <% @job_list.each do |job| %>
      <div class="toggle">
        <label class="checkbox text-justify" for="<%=dom_id(job)%>">
          <%= check_box_tag "new_jobs[]", job.id, false, id: dom_id(job) %><strong><%= job.name %></strong> <small><%= job.description %></small>
        </label>
      </div>
    <% end %>

    <div class="form-actions">
      <%= f.submit nil, :class => 'btn btn-primary' %>
      <%= link_to 'Cancel', checklists_path, :class => 'btn' %>
    </div>
  <% end %>
<% end %> 
```

# performance - 性能测试龙卷风应用

> ID：15648397
> 
> 赞同：0
> 
> 时间：2013-03-26T22:13:19.217
> 
> 标签：performance, tornado

测试龙卷风应用程序性能的最佳工具是什么？我知道 Apache 基准测试是进行性能测试的一种方法。谁能给我推荐一个好用的工具...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T11:25:01.687

我已经用[jmeter](http://jmeter.apache.org/)在 python 框架上运行了测试，它比 ab 提供了更多的控制。我建议尝试一下。

其他流行的是[ab](http://httpd.apache.org/docs/2.0/programs/ab.html)（正如你提到的）和[Grinder](http://grinder.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T10:44:03.617

[Gatling](http://gatling.io/#/)是我接触过的一个基准测试工具，并且看起来很容易使用。

还有Java 中的[Yahoo Cloud Service Benchmark 。](https://github.com/brianfrankcooper/YCSB)启动和运行的时间比 gatling 长，但是一旦你开始运行它就会非常强大。

# events - 骨干视图事件不会被破坏

> ID：15648401
> 
> 赞同：0
> 
> 时间：2013-03-26T22:13:38.797
> 
> 标签：events, backbone.js, view, destroy

我在解除绑定视图事件时遇到了麻烦。我创建一个视图，即

```
var myView = Backbone.View.extend({
    events : {
        "click .item"        : "nextPage",
        "scroll"             : "isScrolling",
        "click .zoom"        : "imageZoom"

    },
    initialize : function(){
       this.collection.on("reset", this.render, this);
    },
    onClose : function(){
      ... 
    }
 });

 var view = new myView();
     destroyArray.push(view); 
```

一旦我需要销毁视图，我通过路由器调用一个函数，该函数循环遍历销毁数组并在渲染下一个视图之前调用 destroyArray[i].close()（见下文）。

```
 Backbone.View.prototype.close = function(){

    this.undelegateEvents();
    this.$el.removeData().unbind();
    this.remove();
    if (this.onClose){
        this.onClose();
    }
} 
```

close 函数明显地从页面中删除视图，但在视图中来回移动事件（和 DOM 元素）实际上增加了。有什么我做错了吗？

在视图之间移动时，我重新初始化它们，即

```
 var view = new myView();
 destroyArray.push(view);
 ...
 view.close();
 ...
 var view1 = new myView1();
 destroyArray.push(view1); 
```

我认为这可能会导致我的问题，但添加的事件不等于视图中绑定的事件数。

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:34:35.113

请查看 Backbone 0.9 中引入的[listenTo](http://backbonejs.org/#Events-listenTo)方法，以帮助处理视图删除。
你可以有 ：

```
initialize : function(){
    this.listenTo(this.collection, 'reset', this.render);
}

Backbone.View.prototype.close = function() {
    this.remove();
} 
```

此外，您不需要使用此方法指定上下文。

**编辑：**代码看起来更像你一开始的方式。

# r - 在 R 脚本中包含函数

> ID：15648402
> 
> 赞同：1
> 
> 时间：2013-03-26T22:13:43.640
> 
> 标签：r, function

我希望有一个可以一次性粘贴到 R 中的脚本。理想情况下，该脚本将具有穿插各种功能的代码行。但是到目前为止，我必须一次粘贴一些代码，因为（正如我所写的那样）这些函数在与下面的代码同时运行时将不起作用。

对于下面的代码，我想让用户输入初始数据，然后对其进行计算。因为我不能连续运行多个“readline”调用，所以我将它们封装到一个名为 Define 的函数中。但是，如果我一次将其粘贴到 R 中，则以下代码将不起作用。

```
Define<-function(){
N<-readline("EnterDeployment #  ")
Y<-as.numeric(readline("What Year was the Deployment?   "))
L<-as.numeric(readline("What is the Distance?   "))

return(list("Year"=Y,"Name"=N, "Length"=L))     
}

Def<-Define()

Name<-Def$Name
Year<-Def$Year
L<-Def$Length

readline(paste("UPDN=",Name,"Year=",Year,"Distance=",L,"If this is correct press Return", sep=" "))

D<-L/4
F<-D*5 
```

但是如果我把它分成几个部分，它就可以了。有没有办法将单个或多个函数合并到一行代码中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:59:18.730

我认为没有理由不在函数中包含其他步骤。这将解决问题并更整洁恕我直言。

```
FOO <- function() {
  Define<-function(){
    N<-readline("EnterDeployment #  ")
    Y<-as.numeric(readline("What Year was the Deployment?   "))
    L<-as.numeric(readline("What is the Distance?   "))

    list("Year"=Y,"Name"=N, "Length"=L)
  }
  Def<-Define()

  Name<-Def$Name
  Year<-Def$Year
  L<-Def$Length

  readline(paste("UPDN=",Name,"Year=",Year,"Distance=",L,
                 "If this is correct press Return",    
                 sep=" "))

  D<-L/4
  F<-D*5
  list(D = D, F = F)
} 
```

我们使用的有：

```
> FOO()
EnterDeployment #  12
What Year was the Deployment?   2012
What is the Distance?   54
UPDN= 12 Year= 2012 Distance= 54 If this is correct press Return
$D
[1] 13.5

$F
[1] 67.5 
```

当然，您需要包含`source()`的`.R`文件`FOO()`，但这没问题。

为什么这更可取？好吧，封装这样一个函数中涉及的所有步骤会更整洁。您也不会污染作为中间步骤创建的对象。最后，如果将其传递给其他用户，您可以将其打包为 R 包（您不需要编写文档 - 只需添加一个基本`.Rd`文件）。

# servicestack - 覆盖服务实现

> ID：15648403
> 
> 赞同：2
> 
> 时间：2013-03-26T22:13:51.067
> 
> 标签：servicestack

在我们的应用程序中，我们希望为特定客户覆盖服务的默认实现。通常我们会创建一个接口并覆盖我们的 IOC 容器中的默认注册。但这如何与 Servicestack 一起工作？谢谢

# python - Python Mastermind 游戏的麻烦

> ID：15648407
> 
> 赞同：1
> 
> 时间：2013-03-26T22:14:31.487
> 
> 标签：python, python-3.x

我是 Python 编程的初学者，并且在我当前的作业中遇到了问题。作业内容如下...

*   您的程序应秘密生成一个 4 位数字（或仅包含数字，长度为 4 个字符的字符串），其中没有重复的数字。
*   然后，您的程序应要求用户输入对代码的猜测。用户的猜测应该是 4 个字符长，只包含数字，没有重复的数字。您的程序应在对输入进行评分之前验证输入是否有效，并在必要时提示用户重新输入输入。无效输入不计入密码破解者的猜测次数。您的代码可能会忽略（去除）输入中的前导或尾随空格，但应将内部空格计为不正确的输入。
*   **在每一轮，打印轮数并得到用户的猜测。如果输入有效，则转弯的输出应该是用户的猜测，然后是反馈。反馈是一个 4 字符的字符串：“X”代表正确位置的每个数字；'O' 表示代码中但位置不正确的每个数字；'-' 对于所有其他人**。注意 X 和 O 应该在一起；反馈只是每种类型的钉子数量，而不是哪些钉子或它们在哪里。
*   保留所有猜测和反馈的历史记录，以便在每一轮都为用户打印。

现在我只专注于作业的“反馈”部分。我的代码目前是：

```
import random

def validateInput():
inputGuess = input("Enter your guess as 4 numbers:")

while True:
    if len(inputGuess) != 4:
       inputGuess = input("Enter your guess as 4 numbers:")
    else:
        numberList = list(inputGuess) ##

        invalidNumbers = False
        for number in numberList:
            if number not in ['1','2','3','4','5','6','7','8','9']:
                invalidNumbers = True 

        if invalidNumbers == True:
            print ("Possible numbers are 1, 2, 3, 4, 5, 6, 7, 8, 9.")
            inputGuess = input("Enter your guess as 4 numbers:") 

        else:
            return numberList

guessesRemaining=10

code=['1','2','3','4']

while guessesRemaining > 0:
     report=[]
     guess=validateInput()
     guessesRemaining -= 1
     if guess[0] == code[0]:
         report.append("X")
     if guess[1] == code[1]:
         report.append("X")
     if guess[2] == code[2]:
         report.append("X")
     if guess[3] == code[3]:
         report.append("X")

     tempCode=sorted(code)
     tempGuess=sorted(guess)

     if tempCode[0]==tempGuess[0]:
         report.append("O")
     if tempCode[1]==tempGuess[1]:
         report.append("O")
     if tempCode[2]==tempGuess[2]:
         report.append("O")
     if tempCode[3]==tempGuess[3]:
         report.append("O")

     report2=report[0:4]
     dash=["-","-","-","-"]
     report3=report2+dash
     report4=report3[0:5]

     print(report4) 
```

例如，如果用户猜测 1879 并且代码是 1234，我会收到“XO --”但我想收到“X---”。此外，任何关于简化我的代码的建议都会很棒。为简单起见，我暂时将“随机代码”设为 [1,2,3,4]。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:28:37.777

您可以使用 Python 函数 map() 非常优雅地解决您的问题。（不像我最初想象的那么优雅，但仍然很好。）

```
guess = "1879" # or [ '1', '8', '7', '9' ]
answer = "1234" 
```

map() 的工作原理是这样的：你给它一个函数作为它的第一个参数，然后给它一个或多个序列作为参数。然后它获取该函数并首先将其应用于两个第一个元素，然后应用于两个第二个元素，依此类推。例如：

```
>>> def f(a,b):
>>>  return a + b
>>> map( f, [1,2,3,4], [ 10, 20, 30, 40 ] )

[ 11, 22, 33, 44 ] 
```

现在，您有两个字符序列，“猜测”和“答案”。您可以编写一个函数，如果它们相等，则返回 X 并且 - 否则如下所示：

```
>>> def mastermind_hint( a, b ):
>>>   return "X" if a == b else "-" 
```

这还不够，您还需要输入“O”。为此，您需要一次使用整个“答案”序列：

```
>>> def mastermind_hint( a, b ):
>>>   if a == b: return "X"
>>>   if a in answer: return "O"
>>>   return "-" 
```

使用 map，我们可以将其应用于您拥有的序列：

```
>>> map( mastermind_hint, guess, answer )
[ "X", "-", "-", "-" ] 
```

现在，现在我们提供的信息比我们预期的要多，因为我们的提示位置对应于猜测字符的位置。隐藏此信息的一种简单方法是对序列进行排序。Python 有一个 sorted() 函数可以做到这一点：

```
>>> sorted( map( mastermind_hint, guess, answer ) )
[ "-", "-", "-", "X" ] 
```

剩下的就是把它加入一个字符串：

```
>>> "".join( sorted( map( mastermind_hint, guess, answer ) ) )
"---X" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:44:14.823

我必须说非常有趣的作业。我希望我能得到这样的作业。

通常我不会提供家庭作业的完整答案，但我解决了这个问题是为了好玩，你已经尝试自己解决这个问题，所以你去吧：

```
import random

def main():
    print '>> New game started.\n>> Good luck!\n'
    answer = generateAnswer()
    while True:
        userGuess = getUserGuess()
        if userGuess == answer:
            print '>> Congratulations, you won!'
            return
        print '>> The answer you provided is incorrect.\n>> Perhaps this hint will help you: '
        giveFeedback(answer, userGuess)

def generateAnswer():
    digits = [str(x) for x in range(10)]
    answer = ''
    for i in range(4):
        digit = random.sample(digits, 1)[0]
        digits.remove(digit)
        answer += digit
    return answer

def getUserGuess():
    while True:
        guess = raw_input('>> Please enter a 4-digit number: ').strip()
        if len(guess) != 4:
            continue
        guessIsValid = True
        for x in guess:
            if guess.count(x) != 1 or ord(x) not in range(48, 58):
                guessIsValid = False
                break
        if guessIsValid:
            return guess

def giveFeedback(answer, guess):
    for i in range(4):
        if guess[i] == answer[i]:
            print 'X',
            continue
        if guess[i] in answer:
            print 'O',
            continue
        print '-',
    print '\n'

if __name__ == '__main__':
    try:
        main()
    except Exception, e:
        print '>> Fatal error: %s' % e 
```

我希望你能在这段代码中找到你的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-16T19:36:01.030

这是一个使用一些更高级的 Python 习语来提高可读性和简洁性的示例。这也使得制定更通用的解决方案变得更容易，例如 m 基数的 n 位答案。

```
import random
from itertools import permutations   # for "lucky guess" Easter egg

def main(base=10, size=4):
    print 'New game started.\nGood luck!\n'
    answer, turn = list(genAnswer(range(base), size)), 1
    while True:
        hint = ['X' if a == g 
           else '0' if g in answer
           else '-' for a, g in zip(answer, guess(base, size))]
        if set(hint) == set(['X']):
            if turn == 1:
                choices = len(list(permutations(range(base), size)))
                print 'You won, lucky guess out of %d possible choices' % choices
            else:
                print 'Congratulations, you won in %d turns!' % turn
            return
        print '  Hint %d: %s' % (turn, ''.join(hint))
        turn += 1

def genAnswer(digits, size):
    '''Python generator function'''
    for i in range(size):
        choice = random.choice(digits)
        yield str(choice)
        digits.remove(choice)

def guess(base, size):
    '''Uses duck typing for error detection'''
    while True:
        guess = raw_input('>> Guess: ').strip()
        try:
            if int(guess, base) < base**size and len(set(guess)) == size:
                return guess
        except ValueError:
            pass
        print 'Enter %d unique digits from 0 to %d' % (size, base -1)

>>> main(6, 4)
New game started.
Good luck!

>> Guess: 1234
  Hint 1: 0-X-
>> Guess: 12345
Enter 4 unique digits from 0 to 5
>> Guess: 01227
Enter 4 unique digits from 0 to 5
>> Guess: 0123
  Hint 2: XX-0
>> Guess: 0135
Congratulations, you won in 3 turns! 
```

# java - 如何在不重新启动的情况下将信息从广播接收器发送回我的主要活动

> ID：15648408
> 
> 赞同：3
> 
> 时间：2013-03-26T22:14:34.477
> 
> 标签：java, android, cordova, android-activity

```
 if (messages.length > -1) {
                        int duration = Toast.LENGTH_SHORT;
                        Toast toast = Toast.makeText(context, "Message recieved: " + messages[0].getOriginatingAddress(), duration);
                        toast.show();
                        String value = "Message recieved: " + messages[0].getOriginatingAddress(); 
```

我的代码在这里收到一条短信。我想把它带回我的主要活动，但我不能使用我的意图并重新启动该活动（广播接收器是后台服务，人们将在此期间使用该应用程序。）而不是敬酒我如何将该字符串传递回活动（我只有一个主要的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:21:10.280

如果您希望仅在前台通知您的活动，只需从 sms 广播接收器抛出一个新广播，并从您的活动中托管的广播接收器拦截它。

另一方面，如果你想检查是否在activity回到前台时发送了广播，即使在activity在后台时收到了短信，你仍然可以使用广播接收器，但你需要添加一个[sticky](https://stackoverflow.com/questions/3490913/what-is-a-sticky-intent-android)之后可以收到的[意图。](https://stackoverflow.com/questions/3490913/what-is-a-sticky-intent-android)

另外：使用[本地广播接收器](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)以节省资源。

# oauth - https://www.googleapis.com/oauth2/v2/userinfo 返回的用户 ID 是否随时间变化

> ID：15648409
> 
> 赞同：1
> 
> 时间：2013-03-26T22:14:46.287
> 
> 标签：oauth, oauth-2.0, openid, google-oauth

我们希望使用[https://www.googleapis.com/oauth2/v2/userinfo](https://www.googleapis.com/oauth2/v2/userinfo)返回的用户 ID作为应用程序中的唯一标识符。

这个用户 ID 会随着时间而改变吗？例如，如果电子邮件地址更改（在 Google Apps for business 中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:29:21.063

用户 id 是一个稳定的标识符。它不受电子邮件地址更改的影响，这就是为什么它应该用作密钥（而不是电子邮件地址）。

# angularjs - 在 AngularJS 中链接未知数量的 Promise

> ID：15648410
> 
> 赞同：8
> 
> 时间：2013-03-26T22:14:52.887
> 
> 标签：angularjs, promise

好的，假设我有一个包含**n 个**XHR 请求的数组：

```
var promises = [];
var AllResults = [];
$scope.requests = [
    {
        "uri":"http://foo/bar/action1",
        "name":"Action1"
    },{
        "uri":"http://bar/foo/action2",
        "name":"Action2"
    },{...},{...},{...}
];
var ParseMyResultsArray = function(){
    console.log(AllResults);
    //...
};

angular.forEach($scope.requests, function(request){
    var promise = $http.get(request.uri);
    promises.push(promise);
});

angular.forEach(promises, function(promise){
    promise.then(function(results){
        AllResults.push(results);
    });
});

//Then, when all promise are resolved...
ParseMyResultsArray(); 
```

**`ParseMyResultsArray()`在不知道`requests`数组大小的情况下，如何确保在所有承诺都解决时调用？**

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-26T22:29:40.250

从角度文档到[$http](http://docs.angularjs.org/api/ng.$http)：

> $http API 基于 $q 服务公开的延迟/承诺 API。

因此，可以使用[$q.all()](http://docs.angularjs.org/api/ng.$q)方法，该方法采用一组承诺，并且：

> 将多个 Promise 组合成一个 Promise，当所有输入 Promise 都已解决时，该 Promise 将被解决

实现代码为：

```
$q.all(promises).then(function () { /* All promises are resolved */ }); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-16T20:28:02.737

我知道这个问题已经有一年多了，但它值得一个更好的答案。

代码可以更加简洁，并且可以避免丑陋的外部变量`promises`和`AllResults`外部函数。`ParseMyResultsArray()`

尝试 ...

```
$scope.requests = [{
        "uri":"http://foo/bar/action1",
        "name":"Action1"
    }, {
        "uri":"http://bar/foo/action2",
        "name":"Action2"
    },{...},{...},{...
}];

$q.all($scope.requests.map(function(request) {
    return $http.get(request.uri);
})).then(function(results) {
    console.log(results);
    //parse results array here ...
    return parsedResults;
}); 
```

如果需要进一步访问`parsedResults`，那么一定要保留（或返回）对`$q.all(...).then(...)`. 由于获取数据涉及的异步*性，parsedResults 的这个承诺*将比原始的外部 var 有用得多`AllResults`。

# android - LinearLayout 中的布局参数无效：layout_column

> ID：15648414
> 
> 赞同：0
> 
> 时间：2013-03-26T22:15:10.633
> 
> 标签：android, android-layout, warnings

我收到了这个警告，程序仍然可以正常构建和运行。我只是想知道如何摆脱它。

```
<ImageView
        android:id="@+id/myimage4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        **android:layout_column="0"
        android:layout_row="0"**
        android:src="@drawable/ic_launcher" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:18:16.660

`android:layout_column`并且`android:layout_row`仅在表格布局中有效，并且它们不存在于线性布局中。如果您使用的是 LinearLayout，则不需要它们，并且可以安全地删除它们。

# html - 将 html 页面滚动到特定标签并保持焦点，即使页面中添加了动态内容

> ID：15648418
> 
> 赞同：0
> 
> 时间：2013-03-26T22:15:25.803
> 
> 标签：html, css, ajax, scroll, anchor

`<img>`我有一个页面，该页面以标签的形式动态插入图片`<div>`，该页面包含其中的几个`<div>`。每个上面的`<h1>`文本`<div>`都有一个特定的 id，这样当我在锚标记中使用该 id 时，页面将向下滚动以显示`<h1>`和`<div>`容器。问题是从另一个页面访问页面时，例如打开[此链接](http://piyoevents.com/projects/#office)时。由于 ajax 代码需要几秒钟来获取图像并因此调整多个`<div>`容器的高度，因此页面会在图像有时间插入之前向下滚动到 id 为“office”的标签。我试图滚动的容器随着其他`<div>`容器的高度变化而丢失。

有没有办法让浏览器保持焦点`<div>`，并根据页面的动态变化上下滚动？当用户手动点击或滚动时可能会打破焦点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:35:58.113

我认为您最好的选择是修复包含图像的 div 的高度，以便页面始终保持一定高度。然后当它向下滚动时，图像加载时它不会错位。

您还可以使用 javascript 检查 url 中是否有 #，然后阻止跳转，直到页面完全加载。

检查哈希

```
if (location.hash) {
    //prevent scroll
    window.scrollTo(0, 0);

    //add function to wait till page fully loaded then scroll to anchor
} 
```

# windows - 如何在 Windows XP 上显示 Windows 照片打印向导？

> ID：15648419
> 
> 赞同：3
> 
> 时间：2013-03-26T22:15:32.540
> 
> 标签：windows, delphi

您好我使用的是Delphi 2010 + Windows XP，您可以在Delphi 的Windows XP 中调用照片打印向导。

[如何显示 Windows 照片打印向导？](https://stackoverflow.com/questions/15644539/how-do-i-show-the-windows-photo-printing-wizard)

以上提示仅适用于 Windows 7

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:27:51.483

[MSDN](http://msdn.microsoft.com/en-us/library/cc351041.aspx)包括示例代码：

```
static const CLSID CLSID_PrintPhotosDropTarget = 
  {0x60fd46de, 0xf830, 0x4894, {0xa6, 0x28, 0x6f, 0xa8, 0x1b, 0xc0, 0x19, 0x0d}};

// A data object that contains the list of photos to print.
IDataObject* pDataObject;

// Create the Photo Printing Wizard drop target.
CComPtr<IDropTarget> spDropTarget;

hr = CoCreateInstance(CLSID_PrintPhotosDropTarget,
                      NULL,
                      CLSCTX_INPROC_SERVER,
                      IID_PPV_ARGS(&spDropTarget));

// Drop the data object onto the drop target.
POINTL pt = {0};
DWORD dwEffect = DROPEFFECT_LINK | DROPEFFECT_MOVE | DROPEFFECT_COPY;

spDropTarget->DragEnter(pDataObject, MK_LBUTTON, pt, &dwEffect);

spDropTarget->Drop(pDataObject, MK_LBUTTON, pt, &dwEffect); 
```

Delphi 代码是这样的：

```
uses
  ActiveX, ComObj;

const
  CLSID_PrintPhotosDropTarget: TGUID = '{60FD46DE-F830-4894-A628-6FA81BC0190D}';

procedure InvokePhotoPrintingWizard;
var
  Effect: LongInt;
  Position: TPoint;
  DataObject: IDataObject;
  DropTarget: IDropTarget;
begin
  // create the Photo Printing Wizard drop target
  OleCheck(CoCreateInstance(CLSID_PrintPhotosDropTarget, nil,
    CLSCTX_INPROC_SERVER, IDropTarget, DropTarget));
  // drop the data object onto the drop target
  Position.X := 0;
  Position.Y := 0;
  Effect := DROPEFFECT_LINK or DROPEFFECT_MOVE or DROPEFFECT_COPY;
  OleCheck(DropTarget.DragEnter(DataObject, MK_LBUTTON, Position, Effect));
  OleCheck(DropTarget.Drop(DataObject, MK_LBUTTON, Position, Effect));
end; 
```

# jquery-ui - jQuery datePicker 图标不会显示在 xhtml 页面上

> ID：15648420
> 
> 赞同：0
> 
> 时间：2013-03-26T22:15:33.963
> 
> 标签：jquery-ui

我在我的 XHTML 中使用 Primefaces 我决定在我的网页上使用带有图标触发器的 jQuery 的 datePicker 而不是 PrimeFaces 日历。日期选择器的代码是：

```
<h:panelGrid id="searchGrid" columns="3" styleClass="grid" columnClasses="one,two,three">
    <p:column>
        <h:outputLabel for="date" value="Date" />
    </p:column>
    <p:column>                  
        <script type="text/javascript">
            $(function() {
                $("#date").datepicker({
                    minDate : "#{indexBean.searchCriteria.mindate}",
                    maxDate : "#{indexBean.searchCriteria.maxdate}",
                    dateFormat : "dd/mm/yy",
                    showOn : "button",
                    buttonImage : "/style/images/calendar.png",
                    buttonImageOnly : true
                });
            });
        </script>
        <p:inputText id="date" value="#{indexBean.searchCriteria.date}" label="Date" validator="#{indexBean.validateDate}">
            <p:watermark value="eg: 01/01/2013" for="date" /> 
        </p:inputText> 
```

但是 datePicker 的按钮（图标）不会显示在页面上。有什么遗漏吗？？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T23:44:38.897

Yepeeee 我修好了我只需要改变一件小事

# 日期到 .date（在 中）

id="date" 到 styleclass="date" （在 ） 谢谢大家

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T00:52:26.587

看起来您没有导入 jQuery UI。确保您的页面头部有这样的内容：

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script> 
```

另外，我会将您的 javascript 移动到 datepicker 输入元素下方：

```
<h:panelGrid id="searchGrid" columns="3" styleClass="grid" columnClasses="one,two,three">
<p:column>
    <h:outputLabel for="date" value="Date" />
</p:column>
<p:column>                  
    <p:inputText id="date" value="#{indexBean.searchCriteria.date}" label="Date" validator="#{indexBean.validateDate}">
        <p:watermark value="eg: 01/01/2013" for="date" /> 
    </p:inputText>

    <script type="text/javascript">
        $(function() {
            $("#date").datepicker({
                minDate : "#{indexBean.searchCriteria.mindate}",
                maxDate : "#{indexBean.searchCriteria.maxdate}",
                dateFormat : "dd/mm/yy",
                showOn : "button",
                buttonImage : "/style/images/calendar.png",
                buttonImageOnly : true
            });
        });
    </script> 
```

# ios - iOS 以编程方式更改 uiview 布局

> ID：15648421
> 
> 赞同：0
> 
> 时间：2013-03-26T22:15:35.650
> 
> 标签：ios, objective-c, cocoa-touch, uiview, uikit

我的 iOS 应用程序上有一个页面，基于下图布局，如下所示。

*   深灰色框 = 导航栏
*   浅灰色框 = UIView（用于演示，带有一些漂亮的阴影等）
*   黑色边框 = UIView（同样，有漂亮的阴影，不同的背景颜色等）
*   2 个文本字段
*   粉红色框 = 事件后显示的另一个视图。

![布局](../Images/8e877520ed09c82ee12adec751d447aa.png)

目前，我正在使用 initWithFrame 布局所有内容，并明确设置每个项目的框架，我知道这可能不是很好（我是 ios 开发的新手，所以请指出正确的方向）。

我想要实现的是，当在第二个文本字段中输入一些文本时，粉红色框会显示出来，超级视图会正确响应，并在新字段周围很好地布局。

我对事件本身没有任何问题，我可以很容易地依次更改每个 UIView 的框架，但我觉得这是错误的，并且会喜欢一些指针。我最终还希望粉红色的盒子在其中制作动画，因此包含的视图也可以用它制作动画。

我希望我已经彻底解释了自己。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:31:06.820

如果您有想要触发的事件，然后在后面运行动画，这是一件非常简单的事情。

```
- (void)myEventMethod:(id)sender {
  // Do your event stuff here
  // Animate the pink box into view
  // The below assumes the pink box is hidden behind the blackView and you'd like to drop it down 44 pixels over 0.3 seconds - hopefully correct - haven't tested
  // need to be careful as it'll move down 44px every time myEventMethod: is triggered
  [UIView animateWithDuration:0.3
                        delay:0.0
                      options:UIViewAnimationOptionCurveEaseIn
                   animations:^{
                   CGRect pinkboxEndFrame = CGRectMake(self.blackView.frame.origin.x, self.blackView.frame.origin.y + 44, self.pinkbox.frame.size.width, self.pinkbox.frame.size.height);
                   [self.pinkbox setFrame:pinkboxEndFrame];
                   }
                   completion:nil];

} 
```

只需使用您想要对其他视图执行的任何其他动画来更新上述内容。

有关动画视图的更多信息，您可以查看 Apple 的[View Programming Guide](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/animatingviews/animatingviews.html)。

# c# - 无法使用 dapper，“几种方法都适用”

> ID：15648423
> 
> 赞同：0
> 
> 时间：2013-03-26T22:15:40.947
> 
> 标签：c#, .net, dapper

我正在尝试使用 Dapper 对 SQLite 数据库执行简单的 CRUD 操作，但我遇到了麻烦，因为编译器正在指责一个我根本不知道如何修复的错误。

问题中的错误在“conn.Execute ...”行中，它说：

> C#：有几种方法适用于 '(string, DBManager.(anonymous))': 'Dapper.SqlMapper.Execute(System.Data.IDbConnection, string, , System.Data.IDbTransaction, int?, System.Data.CommandType? )' 和 'Dapper.SqlMapper.Execute(System.Data.IDbConnection, string, , System.Data.IDbTransaction, int?, System.Data.CommandType?)' DBManager.cs

下面是我的代码，我试着把我认为有用的所有东西都放在这里，但不要放太多。

```
using System;
using System.Linq;
using Dapper;

public bool Insert(SchedulerHistory record)
{
    int res = -1;

    if (record == null)
        return false;

    try
    {
        //var db = new SQLDatabase();

        string sqlquery = "insert into SchedulerHistory (JobId, NextJob, LastJob, ExecuteOnStart) Values (@JobId, @NextJob, @LastJob, @ExecuteOnStart);";

        using (var conn = new System.Data.SQLite.SQLiteConnection(m_connString))
        {
            conn.Open();
            conn.Execute (sqlquery, new { JobId = record.JobId, NextJob = `record.NextJob, LastJob = record.LastJob, ExecuteOnStart = record.ExecuteOnStart });`

            return (res > 0);
        }
    }
    catch (Exception ex)
    {
        LogWriter.Error(ex);
        return false;
    }
} 
```

注意“使用 Dapper;” 被 VS2012 标记为未使用，并且该方法尚未完成，我正在根据我之前所做的进行调整，因为我认为 dapper 会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T18:18:14.600

所以发生的事情正是@KirkWoll 所说的，我公司的 dll 里面有 dapper 的 dll，所以我只是删除了我项目的 dapper 引用，一切正常。

# java - 在 Mac OSX 上使用 MAMP 的 PHP 中的 shell_exec() 在 VM 初始化期间出现错误无法加载本机库：libjava.jnilib

> ID：15648428
> 
> 赞同：0
> 
> 时间：2013-03-26T22:16:02.933
> 
> 标签：java, php, mamp

我已经到处寻找答案，看来我需要将我的 $DYLD_LIBRARY_PATH 设置为知道我丢失的库在哪里的东西，但我不知道那可能是什么。

我的机器是 Mac OS X，我在 MAMP 下运行 PHP5。我有一个用于我创建的可执行文件的 shell 命令，它在终端中运行良好，但在我的 PHP 应用程序中根本不起作用。我收到以下错误：

`$ Error occurred during initialization of VM Unable to load native library: libjava.jnilib`

我想我只需要找到那个库并将目录添加到上面列出的变量中，但我似乎找不到它。我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-30T07:59:19.397

正如[Broken Java Mac 10.6](https://stackoverflow.com/questions/1482450/broken-java-mac-10-6)提到的 DYLD_LIBRARY_PATH 必须取消设置。不知道为什么，在 Unix 系统上似乎需要它，而不是 MacOSX。

如果 MAMP 设置为 /Applications/MAMP/Library/lib 以下是禁用它的方法：编辑 /Applications/MAMP/Library/bin/envvars 并注释掉以下行

DYLD_LIBRARY_PATH="/Applications/MAMP/Library/lib:$DYLD_LIBRARY_PATH" export DYLD_LIBRARY_PATH 使它看起来像这样：

# DYLD_LIBRARY_PATH="/Applications/MAMP/Library/lib:$DYLD_LIBRARY_PATH"

# 导出 DYLD_LIBRARY_PATH

这应该可以解决问题，java 1.6 可以正常运行。

有关更多信息，请查看此处：[Java 1.6 Broken when called by background Symfony task](https://stackoverflow.com/questions/7650013/java-1-6-broken-when-called-by-background-symfony-task)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-30T09:01:28.723

这也适用于我在另一个环境中：

```
<?php
  exec('export DYLD_LIBRARY_PATH=""; java -version');
?> 
```

参考：
- [https://drupal.org/node/1257654](https://drupal.org/node/1257654)
-[从 PHP exec 调用 java](https://stackoverflow.com/questions/278868/calling-java-from-php-exec)

# javascript - javascript求幂中的数学函数

> ID：15648431
> 
> 赞同：2
> 
> 时间：2013-03-26T22:16:27.903
> 
> 标签：javascript, math, exponentiation

我在 javascript 中有一些计算，包括求幂。

谁能说一下为什么这句话返回值1？？？

```
 alert ((0.03+1)^(271/365)-1); 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T22:18:32.197

`^`实际上是一个按[位异或运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)。您正在寻找`Math.pow()`：

```
alert(Math.pow((0.03+1), (271/365))-1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:19:50.357

`Math.pow( (0.03+1), ((271/365)-1) )`会给你一个结果`0.9924164970995866`

# math - 基于两个向量创建旋转矩阵

> ID：15648433
> 
> 赞同：5
> 
> 时间：2013-03-26T22:16:38.257
> 
> 标签：math, vector, matrix, rotation

当我传入一个向量 (V) where 时，我希望创建一个旋转矩阵 (M) `M * [0, 0, 1] (forward) = V`。

我这样做是因为我想使用这个矩阵来乘以其他向量以将它们放在本地空间中（不确定这是否是正确的术语，但希望你能理解）。

```
V = [0, 1, 0]
M = ?
Result = M * V = [0, 0, -1] 
```

那么如果在乘以M之后`[0,0,1]`向上倾斜了90度就变成了……什么是？`[0,1,0]``M`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T23:22:02.883

三维旋转很难思考，甚至​​更难用文字解释。但是，可以将您的左手形成近似于一组三维轴的东西。查看以下描述弗莱明左手规则的维基百科页面；特别是，看第二张图，它的手指标记为*I*、*B*和*F*：[http ://en.wikipedia.org/wiki/Fleming's_left-hand_rule_for_motors](http://en.wikipedia.org/wiki/Fleming%27s_left-hand_rule_for_motors)

用你自己的手做同样的排列，而不是标记手指*I*、*B*和*F*，让我们称它们为*x*、*y*和*z*。此外，我们会说这三个手指在手掌处相交的点是原点，点 (0 0 0)，并且从原点向这些手指/拇指之一的尖端移动是在移动积极的方向。

向量*v* = (0 1 0) 是食指上的一个点（我们称之为*y*）。我们想旋转这个点以形成点 (0 0 -1)。该点位于*z*轴（拇指）上，但它是负数，因此它位于原点“下方”一个单位，方向是从拇指尖到原点。

因此，要将点 (0 1 0) 旋转为 (0 0 -1)，我们需要围绕*x*轴（您的中指）旋转它。想象一下，将一张 CD 光盘放在您的中指上，推动它，使其位于您的食指和拇指定义的平面上 - ( *x* , *y* ) 平面 - 并在距离其中心一个单位的光盘上放置一个标记。现在想象将该标记与食指对齐，使该标记位于点 (0 1 0)。您可以围绕中指旋转圆盘，使标记位于点 (0 0 -1)。因此，所需的旋转是围绕*x*轴的旋转。

以下 Wikipedia 页面为您提供了[在三维空间中围绕*x*、*y*和*z*轴](http://en.wikipedia.org/wiki/Rotation_matrix#In_three_dimensions)的旋转方程。*绕x*轴旋转的矩阵为：

```
/1     0        0   \
|0   cos θ    -sin θ|
\0   sin θ     cos θ/ 
```

如果您要使用右手旋转圆盘，则定义矩阵以使 θ 的负值对应于右手的顺时针运动（反之亦然，正值）。我们需要旋转的角度是负四分之一圈，因此所需的矩阵是：

```
/1    0     0\
|0    0     1|
\0   -1     0/ 
```

请记住，角度可以用度数或弧度表示，因此如果您在代码中实现更通用的旋转，您需要检查您的数学库所期望的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-03T17:57:47.957

因此，您将获得一个局部**z**轴`V=(vx,vy,vz)`和一个朝向的局部**x**`U=(ux,uy,uz)`轴，其中`U`和`V`是**单位**向量：

局部**y**轴为`W=Normalized(Cross(V,U))`。现在如果`U`不完全垂直于`V`它需要用`U=Normalized(Cross(W,V))`

3×3 旋转矩阵是

```
 | Ux  Wx  Vx |
M = | Uy  Wy  Vy |
    | Uz  Wz  Vz | 
```

请注意，这`Cross(A,B) = (Ay*Bz-Az*By, Az*Bx-Ax*Bz, Ax*By-Ay*Bz)`是叉积运算符并`Normalized(A) = (Ax,Ay,Az)/SQRT(Ax*Ax+Ay*Ay+Az*Az)`创建一个单位向量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:46:33.277

即使是手工，简单，轻松。仅通过检查，可以看出 M 实质上交换了 y 轴和 z 轴，只留下 x 。

这个数组完成了这项工作：

```
 [1  0  0]
M = [0  0  1]
    [0 -1  0]

M * [0, 1, 0] = [0, 0, -1] 
```

请注意，此解决方案在对这两个特定向量具有相同影响的一组变换矩阵中并不是唯一的。事实上，有无数这样的矩阵。这是一个：

```
 [sqrt(2)/2     0    sqrt(2)/2]
M2 = [sqrt(2/2)     0   -sqrt(2)/2]
     [0            -1         0   ] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-08T09:39:37.147

我也必须解决同样的问题。尽管如此，还是有人需要这个，我在这里找到了一种正确的方法[ [https://math.stackexchange.com/questions/180418/calculate-rotation-matrix-to-align-vector-a-to-vector-b-in -3d/](https://math.stackexchange.com/questions/180418/calculate-rotation-matrix-to-align-vector-a-to-vector-b-in-3d/) ]

这是它在c ++中的计算方式

```
 Eigen::Vector3f a(34, 0, 1);
  Eigen::Vector3f b(2, 2, 1);
  a = a/a.norm();
  float b_norm = b.norm();
  b = b/b_norm;

  Eigen::Vector3f v = a.cross(b);
  float s = v.norm();
  float c = a.dot(b);
  Eigen::Matrix3f vx;
  vx << 0, -v[2], v[1], v[2], 0, -v[0], -v[1], v[0], 0;
  Eigen::Matrix3f r = Eigen::Matrix3f::Identity(3,3);
  if(s != 0 ){
    r = r + vx + vx*vx*((1-c)/std::pow(s, 2));
  }else{
    std::cout<< "doesn't work if a == -b"<< std::endl;
  }

  std::cout<<"Testing..."<< std::endl;
  std::cout << "b: " << b.transpose() << std::endl;
  std::cout << "After projected: b: "<< (r*a).transpose() << std::endl; 
```

**注意：如果 a=-b 则失败**

# java - servlet 过滤器重写 URL

> ID：15648437
> 
> 赞同：3
> 
> 时间：2013-03-26T22:17:05.887
> 
> 标签：java, url-rewriting, servlet-filters

我正在尝试从以下位置重写 URL：

*   `localhost:8080/sendEmail/newEmail.pdf?request_id=23456&emailAddress=`

至：

*   `localhost:8080/sendEmail/newEmail.pdf?request_id=23456`

过滤器类代码和映射如下。我怎样才能完成这项任务？（高度赞赏一个例子的答案）。

**过滤器映射：**

```
<filter>
    <filter-name>RequestFilter</filter-name>
    <filter-class>com.abc.ms.email.filter.RequestFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>RequestFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping> 
```

**过滤器代码：**

```
public class RequestFilter implements Filter {
    private static final Pattern REWRITE_PATTERN = Pattern.compile("(^[1-9]\\d*)$");

    public void doFilter(ServletRequest req, ServletResponse res, FilterChain fc) throws IOException, ServletException {
        HttpServletRequestWrapper wrapper = new HttpServletRequestWrapper((HttpServletRequest)req);
        String url = wrapper.getRequestURL().toString();
        String number = url.substring(url.lastIndexOf("/")).replace("/", "");
        Matcher m = REWRITE_PATTERN.matcher(number);
        if (m.find()) {
            RequestDispatcher dispatcher = wrapper.getRequestDispatcher("request?id=" + m.group(1));
            dispatcher.forward(req, res);
        } else {
            fc.doFilter(wrapper, res);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-03-14T23:42:18.613

如果您真正需要的只是一个简单的 URL 清理，那么使用正则表达式或 URL 重写模块可能会矫枉过正。

一个完全简单的实现可能是这样的：

```
public class RequestFilter implements Filter {

    private static final String LOOK_FOR = "sendEmail/newEmail.pdf";

    private static final String REMOVE = "&emailAddress=";

    public void doFilter(ServletRequest req, ServletResponse res, FilterChain fc) throws IOException, ServletException {
        HttpServletRequestWrapper wrapper = new HttpServletRequestWrapper((HttpServletRequest)req);
        String original = wrapper.getRequestURL().toString();
        if(original.contains(LOOK_FOR)) {
            String filtered = StringUtils.substringBeforeLast(original, REMOVE);
            RequestDispatcher dispatcher = wrapper.getRequestDispatcher(filtered);
            dispatcher.forward(req, res);
        } else {
            fc.doFilter(wrapper, res);
        }
    }
} 
```

* * *

它很容易使用`org.springframework.mock.web.*`类进行单元测试：

```
public class RequestFilterTest {

    private RequestFilter filter;

    @Before
    public void setUp() {
        filter = new RequestFilter();
    }

    @Test
    public void testRedirect() throws IOException, ServletException {
        MockHttpServletRequest request  = new MockHttpServletRequest("GET",
                "/sendEmail/newEmail.pdf?request_id=23456&emailAddress=");
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain fc = new MockFilterChain();

        filter.doFilter(request , response, fc);

        Assert.assertEquals("http://localhost:80/sendEmail/newEmail.pdf?request_id=23456", response.getForwardedUrl());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-18T19:48:21.243

I would recommend using an existing implementation, rather than writing this on your own.

There seems to be *the one* Java URL rewriting implementation, which is Tuckey's URLrewriteFilter.

See: [http://tuckey.org/urlrewrite/](http://tuckey.org/urlrewrite/)

This should do what you want, and a lot more.

Alternatively, if you use apache in front of your web container, you might want to look into `mod_rewrite`, which does the same on apache.

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

# mysql - 自定义 CMS - 存储内容

> ID：15648442
> 
> 赞同：2
> 
> 时间：2013-03-26T22:17:25.910
> 
> 标签：mysql, content-management-system

我正在构建一个自定义 CMS 系统来存储文章。

将文章存储在数据库中的正确方法是什么？鉴于一篇文章可能由单个段落或任意数量的段落组成，并且可能包含图像，将每个段落存储在 db 的不同字段中似乎不切实际。

我查看了 Wordpress 如何存储帖子，它似乎将原始 html 集中在单个字段“post_content”中。这是一种公认​​的方法吗？我看到这种方法的缺点是，对于每篇文章，还存储了任何 html 标记。如果我只存储原始文本，那么显示文章的动态页面将只包含一次 html 标记。但是那么如何区分段落和图像呢？

有什么想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:22:55.217

选择的字段将是 BLOB 类型（例如 TEXT）。

然而，要存储什么数据是另一回事，实际上取决于您的实现。我曾在类似的系统上工作过，过去曾将数据存储为：

*   XML - 由应用程序层翻译和转换为 HTML 的自定义 XML 标记。此方法还意味着您可以使用 XPATH 查询对数据进行额外查询。
*   WMD - 将数据存储为 WMD 意味着没有任何 HTML 标签可以帮助防范跨站脚本攻击 (XSS)
*   HTML 这是对数据进行排序的最简单、最快捷的方式。为您清理输入，这将大大有助于 XSS 和其他您不想要的数据，但这会增加 WMD 可以从一开始就解决的更多复杂性。

如果您正在从链接的图像中寻找某种分析数据，我建议将图像 URI 存储在另一个表中并链接到 URL 的主键 ID。这意味着您可以检查而不是重复图像 URL。如果您在域中上传和存储图像，图像 URI 也可以是一个 ID。

# javascript - jQuery 在 JSP 中不起作用

> ID：15648445
> 
> 赞同：0
> 
> 时间：2013-03-26T22:17:36.140
> 
> 标签：javascript, jquery, jsp

我正在尝试编写一个从数据库中检索值并用于`slidetoggle()`在屏幕上滑动它们的代码。

这是没有数据库检索的**.html**文件，效果很好：

```
<html>
<head>

<script type="text/javascript" src="C:\Users\Mohit\Desktop\jquery-1.9.1.min.js"></script>
</head>
<body onload="handleChange();">

<label><input type='checkbox' onchange='handleChange();'>Check box</label>

<script>
function handleChange()
{
    $('.slideTogglebox').slideToggle();
}
</script>
<div class="slideTogglebox">
    <ul>
        <li><input type="checkbox">Judge1</li>
        <li><input type="checkbox">Judge2</li>
    </ul>
</div>
</body>
</html> 
```

然后我写了这个**.jsp**文件，包括上面的带有数据库检索的 jQuery，但在输出中它只显示检索到的值，但`slidetoggle()`函数不起作用。

```
<%@ page contentType="text/html; charset=iso-8859-1" language="java" import="java.sql.*" errorPage="" %>
<html>
<head>

<script language="javascript" type="text/javascript" src="C:\Users\Mohit\Desktop\jquery-1.9.1.min.js"></script>
<script language="javascript">
function handleChange()
{

    $('.slideTogglebox').slideToggle();

}
</script>
</head>
<body onload="handleChange();">
<%
    try{
        Connection conn = null;
        ResultSet rs;

            Class.forName("com.mysql.jdbc.Driver");
        conn=DriverManager.getConnection("jdbc:mysql://localhost:3306/aniket","root","");
        String strsql=null;
        strsql="select * from projects";
        Statement stmt=conn.createStatement();
        rs=stmt.executeQuery(strsql);
        while(rs.next())
        {%><br><input type='checkbox' onchange='handleChange();'><%
            out.print("CO"+rs.getInt(1)+"");
            out.print(rs.getString(2));
        }   
       }
        catch(Exception e)
        {
           e.printStackTrace();
           System.out.println(e);
        }
%>
    <div class="slideTogglebox">
    <%
            Connection conn1 = null;
                ResultSet rs1;
            conn1=DriverManager.getConnection("jdbc:mysql://localhost:3306/aniket","root","");
            String strsql1=null;
            strsql1="select * from judges";
            Statement stmt=conn1.createStatement();

            rs1=stmt.executeQuery(strsql1);
            while(rs1.next())
            {%><br><input type='checkbox'><%
            out.print(rs1.getInt(1));
            out.print(rs1.getString(2));
        }%>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:30:45.907

您应该使用 jQuery 脚本文件的[URI 方案](http://en.wikipedia.org/wiki/URI_scheme)url，而不是绝对文件系统路径。理想情况下，这将类似于

```
<script src="/javascript/jquery-1.9.1.min.js"></script> 
```

其中 jQuery 脚本是您的应用程序的一部分。

如果你只想在本地机器上运行它，你可以坚持使用文件系统路径，但它应该使用[文件 URI 方案](http://en.wikipedia.org/wiki/File_URI_scheme)。

```
<script src="file:///C:/Users/Mohit/Desktop/jquery-1.9.1.min.js"></script> 
```

更好的解决方案是使用[Google CDN 链接](https://developers.google.com/speed/libraries/devguide#jquery)，例如

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

* * *

还有一件事，你真的应该在文档的顶部添加一个 doctype。我推荐 HTML5

```
<!DOCTYPE html> 
```

# android - 在Android中存储用户数据的最佳方式是什么

> ID：15648447
> 
> 赞同：1
> 
> 时间：2013-03-26T22:18:00.443
> 
> 标签：android, sqlite, cookies

我希望能够将用户的 id 存储在我的 Android 应用程序中，这样每当用户访问我的应用程序时，我就可以检索识别用户的信息并为用户创建自定义页面。我在我的网站上使用 javascript 中的 cookie 执行此操作，但在 Android 中推荐的方式是什么？SQLite 还是别的什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:23:27.110

Android 提供了一种`AccountManager`最完整、最健壮、最正确的方式来处理用户身份验证和首选项。[该文档很好地解释了它。](http://developer.android.com/reference/android/accounts/AccountManager.html)

一个更轻量级的解决方案是[将东西保存在`SharedPreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:22:30.080

有几种方法，[请参阅存储选项](http://developer.android.com/guide/topics/data/data-storage.html)。Shared Prefs 可能是您想要的，但如果您要使用 id 存储其他数据，那么您可能需要考虑使用 SQLite DB。

共享首选项可以将数据存储在（“键”，值）对中，因此它们非常适合这种情况

# javascript - 如何使用 Javascript 减去具有多个文本框值的单个文本框值？

> ID：15648448
> 
> 赞同：1
> 
> 时间：2013-03-26T22:18:02.643
> 
> 标签：javascript, html, subtraction

我有代码，但问题是当我减去总文本框值和高级文本框值等于平衡文本框时，我可以得到结果。但是在将减去的值带入`balance textbox`then 函数后不能`subtract balance textbox values with discount textbox value`吗？

当我减去余额文本框中显示的总预付款和值时，但问题是我不能用折扣文本框值减去余额文本框值？

我想要这样

总预付款=余额折扣？

```
<script type="text/javascript"> 
function getObj(objID){
return document.getElementById(objID);
}
function C(){
getObj("balance").value=parseFloat(getObj("total").value)-
(parseFloat(getObj("advance").value)) ;
return false;
}  

function D(){
getObj("balance").value=parseFloat(getObj("balance").value)-
(parseFloat(getObj("discount").value)) ;
return false;
}
</script> 

<input type="text" name="total" id="total" />
<input type="text" name="advance" id="advance" />
<input type="text" name="balance" id="balance"
 onfocus="return C();return D();" />
<input type="text" name="discount" id="discount" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:30:36.013

尝试这个：

**编辑**：添加`|| 0`以防止 NaN

```
<input type="text" name="balance" id="balance" onfocus="return C();" />

function C(){
  var balanceValue = parseFloat(getObj("total").value || 0)-
  (parseFloat(getObj("advance").value || 0)) ;

  getObj("balance").value  = parseFloat(balanceValue || 0) -
  (parseFloat(getObj("discount").value || 0)) ;
  return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:36:19.433

您需要使用 || 0 当 NaN

```
getObj = function (objID){
return document.getElementById(objID);
}
C = function () {
getObj("balance").value=parseFloat(getObj("total").value  || 0)-
(parseFloat(getObj("advance").value || 0)) ;
return false;
}  

D = function () {
getObj("balance").value=parseFloat(getObj("balance").value || 0)-
(parseFloat(getObj("discount").value)||0) ;
return false;
} 
```

查看交互式示例：http: [//jsfiddle.net/pdejuan/FcTd9/](http://jsfiddle.net/pdejuan/FcTd9/)

# ruby-on-rails - 在 Rails 中迭代日期

> ID：15648450
> 
> 赞同：6
> 
> 时间：2013-03-26T22:18:13.660
> 
> 标签：ruby-on-rails, ruby

我正在编写一个使用给定开始和结束日期的日期进行迭代的方法，并且我需要循环中的日期。像这样的东西：

```
start_date = 2013/03/12
end_date = 2013/11/20

# from start_date to end_date do |f|
  puts date_this_iteration_is_processing
end 
```

有人可以帮我吗？

我已经阅读了这些问题，但它们没有说明如何确定给定迭代的日期。

[如何在 Ruby on Rails 中循环数月 在 ruby​​ on rails](https://stackoverflow.com/questions/13898795/how-to-loop-through-months-in-ruby-on-rails) [中迭代日期](https://stackoverflow.com/questions/9770151/iterating-the-dates-in-ruby-on-rails)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-26T22:23:05.570

这是你想要的？使用范围运算符`..`

```
start_date = Date.parse('2013-03-12')
end_date = Date.parse('2013-11-20')

(start_date..end_date).each do |day|
  puts day
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-20T15:44:14.000

以不那么静态的方式：

```
(Date.today - 60.days..Date.today).each do |day|
  puts day
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-22T06:08:42.823

您可以使用`upto`

```
start_date = Date.parse('2019-05-20')
end_date = Date.parse('2019-05-22')

(start_date).upto(end_date).each do |day|
  puts day
end 
```

# c++ - 如何在 C++ 中的 Visual Studios 即时窗口中声明变量？

> ID：15648455
> 
> 赞同：12
> 
> 时间：2013-03-26T22:18:21.357
> 
> 标签：c++, visual-studio, immediate-window

最近我发现调试时可以[在 Visual Studio 即时窗口中声明变量。](http://www.codeproject.com/Articles/121623/10-Tips-you-should-know-about-Watch-Window-While-d)此功能非常有用，因为如果我想在该上下文中试验代码，我可以在不修改新窗口中的实际代码的情况下创建新变量，然后我可以在监视窗口中探索它们。

这对于我一直在调试的 C# 项目非常有用，但现在我正尝试对不同项目中的基本 C++ 声明做同样的事情。我在断点处中断，然后在即时窗口中键入以下内容：

```
int myVariable; 
```

这给出了错误：

```
CXX0013: Error: missing operator 
```

是否需要任何步骤才能使其与 C++ 项目一起使用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-14T14:28:11.873

您可以通过在调试器中停止时将新变量添加到代码窗口（而不是立即窗口）来完成相同的功能。

确保您选中了*工具->选项->调试->编辑并继续->启用本机编辑并继续。*

```
int myVariable=444; 
```

然后添加您的代码*Debug->Apply Code Changes*，它就可以工作了。可以选择使用*Set Next Statement*将执行点移动到不同的行。

# javascript - 这个变量无论如何都会被提升吗？

> ID：15648459
> 
> 赞同：0
> 
> 时间：2013-03-26T22:18:37.990
> 
> 标签：javascript, hoisting

`var foo`即使 false 块内的代码永远不会被执行，是否也会被提升到堆栈顶部？

```
function foo(){
    if ( false ) {
       var foo = 'bar'; //will this be hoisted even if its never executed?
    }
} 
```

我看到它现在是并且只是感到困惑......我没想到它会以虚假的状态被包裹起来。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:21:58.440

是的; 提升发生在代码运行之前，因此该`if`语句是否出现`true`或`false`尚不清楚。

# ruby - 我怎样才能干掉这个 Ruby 代码

> ID：15648460
> 
> 赞同：1
> 
> 时间：2013-03-26T22:18:47.773
> 
> 标签：ruby, refactoring, dry

如何干燥以下 Ruby 代码：

```
 x = 'a random string to be formated'
    x = x.split('^')[0] if x.include?('^')
    x = x.split('$')[0] if x.include?('$')
    x = x.split('*')[0] if x.include?('*') 
```

我正在寻找极其优雅的红宝石一号班轮，但我很难找到它。不过，它可能应该有点可读性。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:21:43.657

我想这可能是你正在寻找的

`x.split(/\^|\$|\*/)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:23:15.267

你正在寻找这个正则表达式：

```
string.match(/^([^^$*]+)[$^*]?/).captures[0] 
```

它返回第一次出现的所有字符`$, ^, or *`，或者字符串的结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:22:09.837

这对我有用：

```
x = "a random string to be formatted"
['^', '$', '*'].each { |token|
  x = x.split(token)[0] if x.include?(token)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T22:23:06.407

根据您提供的代码

```
x = 'a random string to be formated'

%w(^ $ *).each do |symbol|
  x = x.split(symbol)[0] if x.include?(symbol)
end 
```

# knockout.js - 在 hottowel SPA 默认视图模型中计算出可观察到的淘汰赛

> ID：15648465
> 
> 赞同：1
> 
> 时间：2013-03-26T22:19:01.203
> 
> 标签：knockout.js, durandal, hottowel

我正在尝试按照 Hottowel SPA 模板中的视图模式创建一个简单的剔除计算 observable。**最好**的方法是什么？

我最初有这样的事情：

```
define(['services/logger'], function (logger) {
    var vm = {
        activate: activate,
        title: 'Home View',
        testField: ko.observable("This is a test"),
        testComputedField: ko.computed(getComputed, this)
    };

    return vm;

    //#region Internal Methods
    function getComputed() {
        return "Computed: " + this.testField();
    }

    function activate() {
        logger.log('Home View Activated', null, 'home', true);
        return true;
    }
    //#endregion
}); 
```

但这会导致错误，尽管我不是 100% 确定为什么

```
TypeError: this.testField is not a function 
```

所以经过一些试验和错误，我得到了这个：

```
define(['services/logger'], function (logger) {
    var vm = {
        activate: activate,
        title: 'Home View',
        testField: ko.observable("This is a test")
    };

    vm.testComputedField = ko.computed(getComputed, vm);

    return vm;

    //#region Internal Methods
    function getComputed() {
        return "Computed: " + this.testField();
    }

    function activate() {
        logger.log('Home View Activated', null, 'home', true);
        return true;
    }
    //#endregion
}); 
```

但我不确定这是一种非常漂亮的方法；我显然没有很好地理解 HotTowel 中用于视图模型的模块模式。所以我的问题是：

为什么我原来的方法不起作用？有没有比我的第二种方法更好或替代的方法来定义视图模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T03:19:52.047

互斥锁，这是我正在使用的一般模式，它对我来说效果很好。

我为 KO 绑定使用函数表达式和局部范围变量，并为 Durandal 特定方法（激活、viewAttached 等）使用函数声明。vm 对象需要在函数表达式之后。无需在任何地方使用“this”。

```
define(['services/logger'], function (logger) {

    var testField = ko.observable("This is a test");

    var getComputed = ko.computed(function () {
        return "Computed: " + testField();
    });

    function activate() {
        logger.log('Home View Activated', null, 'home', true);
        return true;
    }

    var vm = {
        activate: activate,
        title: 'Home View',
        testField: testField,
        testComputedField: getComputed
    };

    return vm;
}); 
```

注意：这是 HotTowel SPA 模板

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:14:58.580

你原来的方法：

```
var vm = {
   activate: activate,
   title: 'Home View',
   testField: ko.observable("This is a test"),
   testComputedField: ko.computed(getComputed, this)
}; 
```

当您传递`this`给计算的 ..时`this`，不指向您的`vm`. 而是传入`vm`自身：

```
var vm = {
   activate: activate,
   title: 'Home View',
   testField: ko.observable("This is a test"),
   testComputedField: ko.computed(getComputed, vm)
}; 
```

* * *

编辑*** * 我不知道为什么上面没有工作。根据淘汰赛文档，第二个参数应将`this`上下文设置为第一个参数中的方法。试试这个怎么样：

```
function getComputed() {
   return "Computed: " + vm.testField();
} 
```

# javascript - 如何使用 JavaScript/jQuery 搜索/删除 GMail、HotMail 等中的电子邮件？

> ID：15648470
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:19:08.167
> 
> 标签：javascript, jquery

我想创建一个小软件，用于删除由特定/特定用户（例如）GroupOn 发送的所有旧电子邮件。

我想在多个平台上运行这个程序，因此我想用 JavaScript 编写它。

我不确定这是否可能。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:22:21.660

这对于纯客户端 JavaScript 是不可能的。您可能希望使用[IMAP](http://en.wikipedia.org/wiki/Internet_Message_Access_Protocol)来实现这一点。

JavaScript 中有一个[IMAP 库](https://github.com/mscdex/node-imap)，但它是服务器端的（它基于 node.js 构建）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:25:59.703

是的，可以使用[GreaseMonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)（或其他浏览器中的类似工具），您可以将任何 JavaScript 代码注入现有网站。有关使用 GreaseMonkey 可以做什么的大量示例，请参见[UserScripts.org 。](https://userscripts.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:22:04.480

您必须使用 Google API（Hotmail 等的其他东西）才能做到这一点。您可以通过 REST 和 Javascript/JQuery 调用/使用这些 API。我认为没有任何方法可以使用普通的 Javascript/JQuery 来做到这一点。

# cordova - 如何使用 Cordova Phonegap 为 android 弥补像素

> ID：15648473
> 
> 赞同：0
> 
> 时间：2013-03-26T22:19:27.390
> 
> 标签：cordova, pixels

我知道您可以下载 Cordova 并像使用 html 页面一样使用 android 应用程序。如果屏幕尺寸小于我的 PSD 宽度/高度参数，我可以在使用它时使用像素弥补并使用类似缩小功能的功能吗？或者我除了 % 弥补之外别无他法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:32:54.917

您可以像使用常规站点一样使用 phonegap。由于 Android 设备屏幕尺寸的碎片化，您可能需要在 css 中充分利用基于百分比的 css 布局和媒体查询。

# asp.net-mvc-4 - 发布提交表单值的问题（适用于 Chrome，但不适用于 FireFox）

> ID：15648474
> 
> 赞同：0
> 
> 时间：2013-03-26T22:19:27.790
> 
> 标签：asp.net-mvc-4

我猜这是一个非常简单的问题，但由于我对 asp.net mvc 相对较新，我会责怪它。基本上我有下面的表格，当我提交值时会在 Chrome 中发布，而不是在 FireFox 中发布。

> ```
> @using (Html.BeginForm("MyAction", "MyController", new {ReturnUrl = ViewBag.ReturnUrl}))
> {
>     @Html.AntiForgeryToken()
> 
> <text>
>     Fill out this form homie
>     <br/><br/>
> </text>
> 
>     <input type="image" src="~/assets/img/male.jpg" name="iama" value="male" />
>     @Html.Raw("&nbsp;")
>     @Html.Raw("&nbsp;")
>     <input type="image" src="~/assets/img/female.jpg" name="iama" value="female" />
> 
> } 
> ```

非常感谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:59:01.813

请参阅[HTML 输入 (type=image) 在 Firefox 4 上不起作用](https://stackoverflow.com/questions/6402380/html-input-type-image-not-working-on-firefox-4)

您定义了一个图像映射，但应该使用一个按钮

```
 <input  type="submit" name="iama" value="male" style="background: url('assets/img/male.jpg');width: 160px;height:160px;border: 0;" /> 
```

# r - 不会中止的自定义 R 重启功能

> ID：15648479
> 
> 赞同：2
> 
> 时间：2013-03-26T22:19:49.810
> 
> 标签：r

是如何`muffleWarning`实施的`invokeRestart("muffleWarning")`？我问是因为在以下代码中：

```
e <-expression({
  warning("Step 1",immediate.=TRUE)
  warning("Step 2",immediate.=TRUE)
})

r <- withRestarts(withCallingHandlers(eval(e)
                                      ,warning=function(co){
                                        print(co) #1
                                        invokeRestart("mymuffleWarn",co)
                                      })
                  , mymuffleWarn=function(co) print(conditionMessage(co))) 
```

我得到了第一个警告的输出（来自#1）。但是，如果我替换`mymufflewarn`为`muffleWarning`（在`invokeRestart`）中，所有`print(co)`输出都会出现。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T15:48:49.707

Grepping the R source code reveals this:

```
.signalSimpleWarning <- function(msg, call)
    withRestarts({
           .Internal(.signalCondition(simpleWarning(msg, call), msg, call))
           .Internal(.dfltWarn(msg, call))
        }, muffleWarning = function() NULL) 
```

which is be called from

```
static void vsignalWarning(SEXP call, const char *format, va_list ap)
{
    char buf[BUFSIZE];
    SEXP hooksym, hcall, qcall;

    hooksym = install(".signalSimpleWarning");
    if (SYMVALUE(hooksym) != R_UnboundValue &&
        SYMVALUE(R_QuoteSymbol) != R_UnboundValue) {
        PROTECT(qcall = LCONS(R_QuoteSymbol, LCONS(call, R_NilValue)));
        PROTECT(hcall = LCONS(qcall, R_NilValue));
        Rvsnprintf(buf, BUFSIZE - 1, format, ap);
        hcall = LCONS(mkString(buf), hcall);
        PROTECT(hcall = LCONS(hooksym, hcall));
        eval(hcall, R_GlobalEnv);
        UNPROTECT(3);
    }
    else vwarningcall_dflt(call, format, ap);
} 
```

which is called from

```
void warningcall(SEXP call, const char *format, ...)
{
    va_list(ap);
    va_start(ap, format);
    vsignalWarning(call, format, ap);
    va_end(ap);
} 
```

That function is used to generate warnings in C code, and is also called from `do_warning` which is the C function that backs `warning()`.

So the `muffleWarning` handler is always available whenever a warning is raised.

# django - 在 Django 模板中按索引访问列表

> ID：15648481
> 
> 赞同：2
> 
> 时间：2013-03-26T22:19:51.337
> 
> 标签：django, django-templates

我正在尝试动态访问列表中的索引位置。

> {{ allAppsList.{{app.id}}.link }}

它不工作。

> {{ allAppsList.0.link }}

工作。

应该是语法问题。我在网上谷歌，但没有发现任何有用的东西。

顺便说一句：如果在 Java 中使用，这就是我想要做的。

> int 索引 = app.id;
> 
> 字符串链接 = appList[index].getLink();

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:55:46.837

你不能在 django 模板中做这样的事情，但这也不是不可能的。

如果你真的喜欢这个，你可以创建一个[自定义模板过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/)。实现很容易，只需将列表传递`index`给您`custom filter`，然后执行您将使用的操作即可`Java`。

开始[编写自定义模板过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:51:06.663

你不能在 Django 的模板语言中查找这样的列表——这是一个设计决定。方法调用、字典键、属性调用和列表索引都由`.`（点）表示法处理。[查看文档以了解有关 Django 如何在遇到点时决定做什么的更多信息](https://docs.djangoproject.com/en/dev/topics/templates/#variables)

# git - 更改为 git 作为 dotcloud 的推送协议

> ID：15648482
> 
> 赞同：0
> 
> 时间：2013-03-26T22:19:57.040
> 
> 标签：git, push, dotcloud

我有一个使用 rsync 推送的应用程序。要使用 git，我进入 .dotcloud/config 并进行了更改

```
 "push_branch": null,
    "push_protocol": "rsync" 
```

至

```
 "push_branch": "some_branch",
    "push_protocol": "git" 
```

但是，现在当我尝试推动时：

```
$ dotcloud push
==> Pushing code with git, branch some_branch from "./" to application myapp
Error: Unable to spawn git 
```

我做错了什么？我找不到更改推送协议的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T14:51:06.430

使用 git 协议的正确方法是执行类似的操作

```
dotcloud connect --git appname [--branch branchname] 
```

在 dotcloud.yml 所在的目录中。

# php - 如何在 jquery 中放置警报以了解您要添加的事件是否已在数据库中或与其他事件的时间表冲突？

> ID：15648488
> 
> 赞同：0
> 
> 时间：2013-03-26T22:20:19.590
> 
> 标签：php, jquery, mysql, jquery-mobile

我在数据库中有一张预订事件表，其中包含日期、事件名称、地点、时间开始和时间结束。现在，当我想预订一个新活动时，我想首先检查某个场地是否已经在给定日期和时间范围内被占用。

这是我到目前为止所得到的，但它不起作用。

```
<?php
session_start();
include('config1.php');

       $sql = "SELECT venue FROM schedules WHERE venue =".$_POST['venue']" && date =".$_POST['date']" ";

       $select = mysql_query($sql);

       $row = mysql_num_rows($select);

            if ($row > 0)  
          {
            echo 'true';  
          }
             else 
          {
             echo 'false';
          }

?>

and the check-venue.php
<?php
session_start();
include('config1.php');

       $sql = "SELECT venue FROM schedules WHERE venue =".$_POST['venue']" && date =".$_POST['date']" ";

       $select = mysql_query($sql);

       $row = mysql_num_rows($select);

            if ($row > 0)  
          {
            echo 'true';  
          }
             else 
          {
             echo 'false';
          }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:30:16.803

首先，你真的不应该使用这些`mysql_*`功能：

> 此扩展自 PHP 5.5.0 起已弃用，并将在未来删除。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。

其次，通过像这样将`$_POST`值直接放入查询中，您将面临各种注入攻击。您需要确保正确转义任何数据以防止这种情况发生。

第三（大概是为什么它根本不起作用），您没有引用您发送到数据库的（大概是字符串）值，并且在构建查询时存在语法错误 - 您在`.`之后缺少连接运算符 ( )变量。任何体面的编辑器都应该在您保存文件之前标记这些类型的错误。

# github - 推送到服务器时避免使用 Git 存储库顶部文件夹？

> ID：15648491
> 
> 赞同：1
> 
> 时间：2013-03-26T22:20:28.553
> 
> 标签：github, terminal

我想将我的推`github.com/username/reponame`送到我的实时网络服务器`domain.com/demo/`。我已设法将代码正确推送到该位置，但它包括我的仓库的顶级目录，将文件放入`domain.com/demo/reponame/`.

我对 Git 和 SSH 很陌生，我不明白我应该如何推/拉，以便不包括我的 GitHub 存储库的顶级文件夹。

**答案**：必须更改`git clone git@github.com:username/reponame.git`为`git clone git@github.com:username/reponame.git .`- 最后的那段时间忽略顶级文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T07:06:42.747

为了增加您的答案，我宁愿克隆为裸仓库：

```
git clone --bare git@github.com:username/reponame.git /a/path/different/from/reponame 
```

（这里没有最后一个点），以便能够：

*   使用 ssh url 推送到该仓库`ssh://yourServeerAccount@yourServer://a/path/different/from/reponame.git`（您只推送到一个裸仓库）
    请参阅“ [git push/clone to new server](https://stackoverflow.com/a/1402783/6309) ”中的示例。
*   设置一个挂钩`cd`并`/demo/reponame`在`checkout HEAD`其中：请参阅此“[`post-receive`挂钩示例](https://stackoverflow.com/a/11724354/6309)”。

# c# - 我无法弄清楚为什么这个代码在与后台工作人员一起使用时会失败

> ID：15648495
> 
> 赞同：0
> 
> 时间：2013-03-26T22:20:46.720
> 
> 标签：c#, audio, backgroundworker

我正在使用 Alvas Audio 库将文件从 Mp3 转换为 Wave 格式，以便我可以编辑它们，然后将它们转换回 Mp3。转换为 Wave 工作正常，但是当我尝试转换回 Mp3 时遇到了麻烦。出于某种原因，此失败与我使用后台工作程序执行初始转换的事实有关。

我知道如果没有库的源代码，很难尝试弄清楚发生了什么，但我希望有人可能对可能出现的问题提出建议。

当我在没有后台工作人员的情况下同步调用相同的代码时，它可以完美运行。有任何想法吗？

这是我从后台工作人员调用以执行转换的代码：

```
 public Tuple<float, float> convertMp3ToWav(Track track) //with Detection, duration check, and TODO: silence removal
    {
        try
        {
            string baseFile = Path.GetFileName(track.location);
            ////////////////////////////
            //string baseFile = track.location.Remove(track.location.Length - 4);
            string outputFile = directory + "Temp\\" + baseFile.Remove(baseFile.Length - 4) + ".wav";
            cleanupFiles.Add(outputFile);
            if (!File.Exists(outputFile))
            {
                int soundStart = -1;
                int soundEnd = 0;
                Mp3Reader mr = new Mp3Reader(File.OpenRead(track.location));
                IntPtr mp3Format = mr.ReadFormat();
                IntPtr pcmFormat = AudioCompressionManager.GetCompatibleFormat(mp3Format, AudioCompressionManager.PcmFormatTag);
                AcmConverter acm = new AcmConverter(mp3Format, pcmFormat, false);

                int sec = 1024;
                int i = 0;

                bool soundFound = false;
                while (true)
                {
                    byte[] mp3Data = mr.ReadDataInBytes(i, sec);
                    if (mp3Data.Length == 0)
                    {
                        break;
                    }
                    byte[] pcmData = acm.Convert(mp3Data);
                    foreach (byte d in pcmData) //THIS SECTION CHECKS IF THE Section in question has silence
                    {
                        if (d != 0)
                        {
                            soundFound = true;
                        }

                    }
                    if ((soundStart == -1) && (soundFound == true)) //if no beginning sound has been found yet, but has now been found
                    {
                        soundStart = i; //This will be precise to whatever value of sec has been chosen
                    }
                    else if ((soundStart != -1) && (soundFound == true)) //this is a possible end value
                    {
                        soundEnd = i;   //this value will be rewritten each time there is sound found after soundstart is set.
                                        //so this value will remain the same if no further sound is found in the track, and will represent the 
                                        //end of sound in the track
                    }

                    soundFound = false;
                    i += sec;
                }
                int finalDuration = soundEnd - soundStart;
                mr.Close();
                Mp3Reader reader = new Mp3Reader(File.OpenRead(track.location));
                IntPtr thisFormat = reader.ReadFormat();
                byte[] completeTrack = reader.ReadDataInBytes(soundStart, finalDuration);
                byte[] convertedTrack = AudioCompressionManager.Convert(thisFormat, pcmFormat, completeTrack, false);
                WaveWriter ww = new WaveWriter(File.OpenWrite(outputFile), AudioCompressionManager.FormatBytes(pcmFormat));
                ww.WriteData(convertedTrack);
                ww.Close();
                reader.Close();

                float bpm = performBeatDetection(track);
                float duration = getTrackDuration(track);

                return new Tuple<float, float>(bpm, duration);
            }
            else
            {
                //File already exists, just remove silence, get bpm and duration
                //string silenceRemoved = removeSilenceFromTrack(outputFile);
                float bpm = performBeatDetection(track);
                float duration = getTrackDuration(track);
                return new Tuple<float, float>(bpm, duration);
            }
        }
        catch (Alvas.Audio.AudioException e)
        {
            MessageBox.Show("ERROR: " + e.ToString());
            return new Tuple<float, float>(0f, 0f);
        }
    } 
```

编辑：

特定的失败是库中的异常。当您想使用 Alvas 将文件从一种音频格式转换为另一种时，您首先读取文件当前格式的格式，就像您看到的那样

```
IntPtr mp3Format = mr.ReadFormat(); 
```

然后转换，你调用静态方法

```
AudioCompressionManager.GetCompatibleFormat(oldFormat, newFormatTag); 
```

当我在使用后台工作程序后调用最后一个方法时，它会以糟糕的英语抛出异常“格式转换不成功”。在库中使用稍微不同的方法：

```
AudioCompressionManager.GetCompatibleFormatList(oldFormat); 
```

揭示当我不使用后台工作者，而我使用后一种方法（GetCompatibleFormatList）时，它会返回 51 个结果，其中一个是转换为我想要的 mp3 格式。

如果我在使用后台工作程序执行初始转换后执行相同的方法，它只返回 20 个结果，其中没有一个是兼容的 mp3 格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:30:03.173

当您不定义“麻烦”时，很难具体。但也许这些想法会有所帮助：

*   后台工作人员使用的任何数据（或文件）是否被前台线程触及？（例如，`track`参数是否可以在使用时以任何方式处理或修改？）

*   后台线程运行时，前台线程是否调用任何库 API？您的任何代码是否在多个线程上调用库代码？您的前台线程是否正确等待后台线程完成结果？（例如，作为一个测试尝试让你的前台线程加入后台线程（或做一个忙碌的等待/睡眠），所以它只是在处理执行时等待 - 问题会消失吗？）

*   该库是否做了任何可能需要在特定线程上调用它的事情 - 特别是，它是否需要在 UI 线程中运行以更新进度条或类似的东西？（这包括在您的代码中调用可能需要跨到 UI 线程调用的事件处理程序）

*   除了传回主线程的返回类型之外，还有其他数据吗？如果是这样，您是否使用同步（锁或易失性等）来确保您读取正确的（最新）值？

*   您确定在处理方法返回之前所有数据都已写入、刷新到磁盘并且所有文件都已关闭吗？

# ios - ViewControllers MFMailComposer 旋转问题的分段控制

> ID：15648499
> 
> 赞同：0
> 
> 时间：2013-03-26T22:20:59.847
> 
> 标签：ios, objective-c, ios6

我有一个包含分段控件的 ViewController。

每个分段控件都有自己的视图控制器。从技术上讲，我为每个分段控件启动一个 ViewController 并显示要显示的视图，并隐藏其他视图。

这一切都很好，但现在我尝试用 presentModalViewController 显示一个 MFMailComposer。我显然需要在分段控件所在的 ViewController 上执行此操作，因为从其他 ViewController 中，我只将视图放在分段控件上方。

MFMailComposer 出现又消失，但消失后整个 App 旋转了 180°。我只支持一个方向，plist 不支持 180° 旋转。

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:53:24.863

问题是功能：`preferredInterfaceOrientationForPresentation`在我的 TabBar 控制器中。现在我删除了它，现在它已经修复了。

# r - if/ifelse 循环中的布尔运算符

> ID：15648503
> 
> 赞同：0
> 
> 时间：2013-03-26T22:21:18.920
> 
> 标签：r, if-statement, boolean-operations

像这样的矩阵

```
r<-20;
c<-6;
m1 <- round(matrix(runif(r*c), r, c))) 
```

我想使用 if/ifelse 和布尔运算符创建两个基于最后三个的新列。

我尝试了以下但没有成功：

```
for (i in 1:dim(m1)[1]){
  if(sum(m1[i,4:6]==0)) {m1$Code1[i]<-0;m1$Code2[i]<-0}
  else if(sum(m1[i,4:6]==3)) {m1$Code1[i]<-5;m1$Code2[i]<-5}
  else if(m1[i,4]==0 && m1[,5]==1) {m1$Code1[i]<-3}
  else if(m1[i,4]==0 && m1[,6]==1) {m1$Code2[i]<-3}
  else if(m1[i,4]==1 && m1[,5]==0) {m1$Code1[i]<-2}
  else if(m1[i,4]==1 && m1[,6]==0) {m1$Code2[i]<-2} 
  else if(m1[i,4]==1 && m1[,5]==1) {m1$Code1[i]<-4}
  else if(m1[i,4]==1 && m1[,6]==1) {m1$Code2[i]<-4}  
} 
```

我的问题是我是否可以在 if 子句中使用 &&，但不知何故这不起作用。有人可以给我一个提示为什么或提供更好的选择吗？

在此先感谢，斯蒂芬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T10:16:21.293

我从您的循环中提炼出`for`您希望对第 4 行和第 5 行的组合以及第 4 和第 6 行的组合执行相同的操作。我认为您最好可以创建一个通用函数并将其应用于两种组合。我为您的问题提出以下解决方案。

```
get.code <- function(x) {
 if(x[1] == 0 & x[2] == 0){0} else if (x[1] == 0 & x[2] == 1){3
 }else if(x[1] == 1 & x[2] == 1){4} else {2}
}

code1 <- apply(m1[,c(4,5)], 1, get.code)
code2 <- apply(m1[,c(4,6)], 1, get.code)
cbind(m1,code1, code2) 
```

# html - 如何让这两个元素彼此相邻

> ID：15648510
> 
> 赞同：0
> 
> 时间：2013-03-26T22:21:55.430
> 
> 标签：html, css, forms, input, send

所以早些时候我正在编写我的网站联系表格，我想制作它，所以我不得不选择，返回或发送。但我注意到他们没有在一起。现在，我知道这可能是一个非常愚蠢的问题，但我刚从假期回来，所以我脑子里放了一个大屁。我会喜欢我能得到的所有帮助。

这是我的 HTML：

```
<p>Go Back <sup>or</sup></p><input type="submit" value="Send!" name="submit" /> 
```

我希望我能展示一张图片，但我现在不能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:23:18.280

将此样式添加到`<p>`标签中：

```
display: inline-block; 
```

示例：http: [//jsfiddle.net/jUS7Y/1/](http://jsfiddle.net/jUS7Y/1/)

```
p {
    display: inline-block;
} 
```

尝试在其上使用类或 id，否则所有`<p>`-tags 将变成`inline-block`s。

**HTML**

```
<p class="myDescription">Go Back <sup>or</sup></p>
<input type="submit" value="Send!" name="submit" /> 
```

**CSS**

```
.myDescription {
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:25:53.903

标签的`<p></p>`作用就像一个中断来分割 HTML 文档中的内容。在段落中包含提交按钮以避免中断。

```
<p>Go Back <sup>or</sup> <input type="submit" value="Send!" name="submit" /></p> 
```

# bash - 在 Ubuntu 中使用 Bash 每小时重启一次网络设备

> ID：15648518
> 
> 赞同：1
> 
> 时间：2013-03-26T22:22:24.167
> 
> 标签：bash, networking, ubuntu, webserver

好的，这是一个奇怪的。基本上我想要做的是运行一个带有睡眠定时器的无限循环，它延迟了重新启动 wlan0 网络接口的命令的运行。听起来很奇怪，但由于某种原因，网卡在大约两个小时后停止连接到网络。为了结束这一切，我正在为 UNI 运行一个 Web 服务器，并且需要能够远程访问它。如果连接断开，我就不走运了。:|

我发现了这个：[Bash "if ping then else" 我的 else 不起作用](https://stackoverflow.com/questions/12734238/bash-if-ping-then-else-my-else-is-not-working)，这是一种管理网络接口的更简洁的方法，只有在停止 ping 时才进行重新配置。然而，这过于复杂了。我确实找到了一些其他类似的代码，但它们同样含糊不清。

老实说，我是一个基于 C 的程序员。C# C++ 和 Java 在这个阶段（Python 真的不值得一提）反正我只是阅读 bash 代码很开心，更不用说修改预先存在的代码片段了。:)

所以这就是我想在 sudo 代码中做的事情。

```
do {
    sleep 3600s //works
    sudo ifconfig wlan0 down //works in terminal but not script
} while(false); 
```

差不多就是这样。该脚本在启动时运行。由用户手动或通过启动应用系统。我希望它是自动的，但是 ifconfig 命令必须作为 sudo 运行，这意味着将脚本作为 sudo 运行。:)

并且提示和/或指针将不胜感激。我尝试了旧的 echo 解决方法来输入 sudo 的密码，但正如预期的那样，Ubuntu 开发人员已经想出了如何阻止它。

刚刚发现这个 [Bash 脚本可以在循环中打开和关闭一个界面](https://stackoverflow.com/questions/10243845/bash-script-to-bring-up-and-down-an-interface-on-loop) ，这个 [制作 bash 脚本可以检查连接性并在必要时更改连接。帮我改进一下？](https://stackoverflow.com/questions/2531583/making-bash-script-to-check-connectivity-and-change-connection-if-necessary-hel) 第二个做我想要的，但它正在运行其他 bash 脚本？？？？:)

EDIT-1：好的....好吧，我使用了 Crontab，我认为我有一些工作我没有看到任何证据，就像我从命令行调用 sudo ifconfig wlan0 时一样。但我明天让它继续运行，看看它可以保持在线。:) 如果没有，我想我不能从这里做什么？

顺便说一句，ifconfig down 在此特定设备上的工作方式是该命令在大约 20 秒后使设备脱机，然后设备重新打开，自动找到网络并重新连接。:) 绑定到 MAC 地址的 IP 地址不会对我造成问题。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T04:19:21.383

好的，所以我使用 Crontab 完成了我的任务，并且服务器现在已经连接了 7 个小时。

我将 crontab 的所有者设置为 root，以便可以运行 ifconfig 命令。我使用了这个脚本“0 */1 * * * sudo /sbin/ifconfig wlan0 down”，它似乎正在工作。现在对于那些试图自己做这件事的人。你必须警惕你的网络设备实际上做了我的工作。我有一个TP-Link双频网卡。我不知道为什么，但是将此卡与 ubuntu 结合使用，此命令会导致它自动重新启动并神奇地自动重新连接。

你的 mialage 会有所不同。:) 我在我的笔记本电脑上运行了这个命令，但它并没有重新启动网络设备，所以...... :) 是的，你可能想知道如何制作一个匹配的命令来带上设备，但即使我也不得不这样做手动重新连接wifi。:| 但是对于这个设置，这个网络设备，它可以工作。:)

但是，是的。:) 玩得开心，小心点 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:32:17.820

如果您需要使用[sudo](/questions/tagged/sudo "显示标记为“sudo”的问题")避免密码，请尝试以下操作：

```
$ sudo visudo 
```

然后，编辑有类似的东西：

```
Host_Alias LOCAL=10.0.0.1 # your own local IP address
user2213541        LOCAL=NOPASSWD: /sbin/ifconfig 
```

* * *

运行命令@start_up 的最简单方法是在 中添加一行`/etc/rc.local`，它将以root 身份运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:41:47.547

如果你想为此编写一个 shell 脚本，这取决于你，但我非常喜欢重用已经存在的东西。

使用[cron](http://linux.die.net/man/8/cron)每小时运行一次脚本。为 root 帐户设置它并让它与界面混淆。

# javascript - KO Computed 未更新 UI

> ID：15648523
> 
> 赞同：4
> 
> 时间：2013-03-26T22:22:37.447
> 
> 标签：javascript, html, knockout.js

我对淘汰赛还很陌生，我正在尝试使用淘汰赛显示和隐藏引导选项卡。

基本上我有一个计算的可观察量：

```
self.isActive = ko.computed(function () {
            var selected = ko.utils.arrayFirst(self.padParticipant(), function (item) {
                return item.ParticipationStatus == 'Active';
            });
            return selected !== null ? true : false;
        }); 
```

更新这些选项卡：

```
<ul class="nav nav-tabs" id="padTabs">
        <li data-bind="fadeVisible: !isActive()"><a href="#joinPad">Join PAD</a></li>
       <li class="active"><a href="#history">History</a></li>
       <li data-bind="fadeVisible: isActive()"><a href="#update">Update Subscription</a></li>
</ul> 
```

从某种意义上说，计算工作正常，当我刷新页面时，正确的选项卡被隐藏了，但我需要它在不刷新的情况下工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T02:51:28.410

除了可观察数组的规则之外，当您使用计算的可观察对象时，这个问题与理解 Knockout 框架中发生的事情有关。首先让我们看一下关于可观察数组的注释：

> 关键点：一个 observableArray 跟踪哪些对象在数组中， **而不是这些对象的状态**
> 
> **简单地将一个对象放入 observableArray 并不能使该对象的所有属性本身都可观察。**当然，如果您愿意，您可以使这些属性可观察，但这是一个独立的选择。observableArray 只跟踪它持有的对象，并在添加或删除对象时通知侦听器。

这与您在这行代码中犯的相同警告错误，因为这不是可观察的，而只是数组中对象的属性： `return item.ParticipationStatus == 'Active';`

此外，我们需要了解计算的 observable 是如何运行的：

> 1.  每当你声明一个计算的 observable 时，KO 立即调用它的求值函数来获取它的初始值。
>     
>     
> 2.  当您的评估器功能运行时，**KO 会记录**您的评估器读取其值的任何可观察对象（或计算的可观察对象）。
>     
>     
> 3.  当您的评估器完成后，**KO 会为您接触的每个可观察对象（或计算的可观察对象）设置订阅**。订阅回调设置为使您的评估程序再次运行，将整个过程循环回第 1 步（处理任何不再适用的旧订阅）。
>     
>     
> 4.  KO 通知任何订阅者你计算的 observable 的新值。

因此，当您创建计算后的 observable 时，为监视更改而创建的唯一订阅是 observable array 的订阅`self.padParticipant()`。

由于状态的 UI 变化依赖于`ParticipationStatus`变化，这意味着这个属性需要是数组中每个对象内的一个可观察元素，否则当它的状态变化时，计算将无法知道该变化和更新用户界面。

# matlab - 在Matlab中按键合并地图的单元格数组

> ID：15648524
> 
> 赞同：3
> 
> 时间：2013-03-26T22:22:37.677
> 
> 标签：matlab

`containers.Map`给定一个包含给定事件（键）的计数（值）的对象元胞数组。我想获得一个包含每个键的计数总和（作为值）的单个映射（或者允许我计算计数的东西）。

例如：

```
maps = { containers.Map({'a','b'},{1,2}),
         containers.Map({'b','c'},{4,1}) };

mergeMaps(maps)

  ans = Map(a -> 1, b -> 6, c -> 1) 
```

到目前为止，我唯一能想到的是：

```
maps = { ... };
res = containers.Map();
for cMapC = maps
    cMap = cMapC{1};
    for cKeyC = keys(cMap{1})
        cKey = cKeyC{1};
        if isKey(res, cKey)
            res(cKey) = res(cKey) + cMap(cKey);
        else
            res(cKey) = cMap(cKey);
        end
    end
end 
```

哪个应该有效（未经测试），但至少可以说其“效率”和可读性值得怀疑。什么是更好的解决方案？

请注意，目前没有归因于事件的索引，因此使用稀疏矩阵代替地图很麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-04T22:57:35.173

不确定可读性，但它可能更有效：

```
allKeys0   = cellfun(@keys, maps, 'UniformOutput', false);
[allKeys, ~, m] = unique([allKeys0{:}]);
allValues0 = cellfun(@values, maps, 'UniformOutput', false);
allValues = cell2mat([allValues0{:}]);
sumValues = arrayfun(@(x) sum(allValues(m==x)), 1:numel(allKeys));

mergedMap = containers.Map(allKeys, sumValues); 
```

# python - 简单的文件上传页面不起作用

> ID：15648527
> 
> 赞同：0
> 
> 时间：2013-03-26T22:22:56.640
> 
> 标签：python, django, file-upload

我正在尝试在我的网站上添加一个简单的文件上传页面。每当我提交表单时，它会在文件选择器上方显示“此字段是必需的”，就好像它没有通过它一样。这是我的表单、模型和视图。

表格.py

```
from django import forms
from django.http import HttpResponseRedirect
from django.shortcuts import render_to_response

class UploadFileForm(forms.Form):

    MURRMACMOD = "MMM"
    CUBE67 = "C67"
    CUBE20 = "C20"
    VDINCONN = "VDC"
    IMPACT20 = "I20"
    IMPACT67 = "I67"
    CAT_CHOICES = (
        (MURRMACMOD, 'Murrelektronik Mac Module'),
        (CUBE67, 'Cube67/Cube67'),
        (CUBE20, 'Cube20'),
        (VDINCONN, 'Valve DIN Connectors'),
        (IMPACT20, 'Impact 20'),
        (IMPACT67, 'Impact 67')
    )

    article = forms.CharField(max_length=100)
    title = forms.CharField(max_length=100)
    file = forms.FileField()
    cat = forms.ChoiceField(choices=CAT_CHOICES) 
```

模型.py

```
from django.db import models

class File(models.Model):

    article = models.CharField(max_length=100)
    title = models.CharField(max_length=100)
    file = models.FileField()
    cat = models.CharField() 
```

视图.py

```
from django.http import HttpResponseRedirect
from django.shortcuts import render_to_response
from django.template import RequestContext

from files.forms import UploadFileForm

def upload_file(request):
    if request.method == 'POST':
        form = UploadFileForm(request.POST, request.FILES)
        if form.is_valid():
            form.save()
            return HttpResponseRedirect('/success/url/')
    else:
        form = UploadFileForm()

    ctxt_dict = {
        'form': form,
    }
    context = RequestContext(request, ctxt_dict)
    return render_to_response('upload.html', context_instance=context) 
```

我希望得到一些帮助，谢谢。

编辑：这是模板。

```
{% if user.is_staff %}
<form action="." method="post">{% csrf_token %}
{{ form.as_p }}
<input type="submit" value="Submit" />
{% else %}
{% endif %}
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:15:16.923

在 Django 模板中，如果您尝试呈现具有文件字段的表单。你必须通过替换

表单方法="post" 动作="">

和

表单方法="POST" enctype="multipart/form-data">

[同时循环表单集和列表中的表单+ FileField 需要错误：django](https://stackoverflow.com/questions/15319387/loop-over-forms-in-formset-and-a-list-at-same-time-filefield-required-error-d/15319510#15319510)

# scheme - 这个方案代码是尾递归的吗？

> ID：15648528
> 
> 赞同：1
> 
> 时间：2013-03-26T22:23:01.223
> 
> 标签：scheme, tail-recursion, r5rs

编辑：谢谢大家。我是这种语言的新手（两天前才开始使用它），所以这就是我不熟悉 conds 的原因。如果我有时间，我可能会重写它，但我只是想确保我的基本逻辑是正确的。再次感谢！

我的任务是创建一个尾递归函数，它从列表中删除第 n 个元素，1 <= n <= listlength，只有两个参数，列表 x 和元素 n。因此，(remove 1 '(abcd)) 将返回 (bcd)。我已经写了以下内容，并希望确信它确实是尾递归的。我唯一不清楚的是递归调用是否可以嵌套在 IF 语句中。

```
(define (remove n x)
  ; if n is 1, just return the cdr 
  (if (and (not (list? (car x))) (= n 1))
     (cdr x)
     ; if the car is not a list, make it one, and call recursively
     (if (not (list? (car x)))
        (remove (- n 1) (cons (list (car x)) (cdr x)))
        ; if n !=1, insert the cadr into the list at the car.
        ; Else, append the list at the car with the cddr
        (if (not(= n 1))
           (remove (- n 1) (cons (append (car x) (list(cadr x))) (cddr x)))
           (append (car x) (cddr x)))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:15:51.043

是的，该过程是尾递归的，这意味着：无论在何处执行递归调用，它都是在该特定执行分支中发生的最后一件事，在递归返回后无事可做 - 因此，我们说递归调用是在*尾部位置*。

`cond`如果我们使用而不是嵌套s重写过程，可以清楚地看到这一点`if`，在这里您将看到每个执行分支都会导致基本情况或递归情况，并且所有递归调用都位于尾部位置：

```
(define (remove n x)
         ; base case #1
  (cond ((and (not (list? (car x))) (= n 1))
         ; return from base case, it's not recursive
         (cdr x))
         ; recursive case #1
        ((not (list? (car x)))
         ; recursive call is in tail position
         (remove (- n 1) (cons (list (car x)) (cdr x))))
         ; recursive case #2
        ((not (= n 1))
         ; recursive call is in tail position
         (remove (- n 1) (cons (append (car x) (list(cadr x))) (cddr x))))
         ; base case #2
        (else
         ; return from base case, it's not recursive
         (append (car x) (cddr x))))) 
```

有关为什么`if`特殊形式的后件/替代部分可以被视为尾递归的更技术性解释，请查看关于算法语言方案的修订^7报告的当前草案的第 3.5 节 - 语言规范，这里是一个指向 pdf 文件的[链接](http://trac.sacrideo.us/wg/raw-attachment/wiki/WikiStart/r7rs-draft-8.pdf)（本质上，同样的考虑也适用于 R5RS，只是它们在 R7RS 中有更详细的解释）。尤其是：

> 如果以下表达式之一处于尾部上下文中，则显示为 ⟨tail expression⟩ 的子表达式处于尾部上下文中
> 
> ...
> 
> `(if ⟨expression⟩ ⟨tail expression⟩ ⟨tail expression⟩)`
> 
> `(if ⟨expression⟩ ⟨tail expression⟩)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T00:41:05.933

这是句法形式的尾递归位置的 Scheme 规范： ![在此处输入图像描述](../Images/40fe828a4de8c9f7d0b3a2a230b4a989.png)

# c - C中的指针和数组

> ID：15648531
> 
> 赞同：2
> 
> 时间：2013-03-26T22:23:10.077
> 
> 标签：c, arrays, pointers

我是 C 和编程的新手。我被困在家庭作业中。我的输出仅显示大写的第一个字符，以及一些奇怪数字的以下字符。有人可以查看我的代码并就我做错了什么以及解决问题的方法给我一些提示吗？非常感谢您的帮助！

“编写一个函数 void sticky(char* word)，其中 word 是单个词，例如“sticky”或“RANDOM”。sticky() 应该修改该词以显示为“sticky caps”（[http://en.wikipedia。 org/wiki/StudlyCaps](http://en.wikipedia.org/wiki/StudlyCaps) ), 即字母必须大小写交替, 第一个字母以大写开头. 例如, "sticky" 变成 "StIcKy" 和 "RANDOM" 变成 "RaNdOm" . 注意字符串的结尾，用 '\0' 表示。您可以假设将合法字符串提供给 sticky() 函数。"

```
#include <stdio.h>
#include <stdlib.h>

/*converts ch to upper case, assuming it is in lower case currently*/
char toUpperCase(char ch)
{
 return ch-'a'+'A';
}

/*converts ch to lower case, assuming it is in upper case currently*/
char toLowerCase(char ch)
{
 return ch-'A'+'a';
}

void sticky(char* word){
 /*Convert to sticky caps*/

for (int i = 0; i < sizeof(word); i++)
{
    if (i % 2 == 0)
    {
        word[i] = toUpperCase(word[i]);
    }
    else
    {
        word[i] = toLowerCase(word[i]);
    }
} 
```

}

```
int main(){
/*Read word from the keyboard using scanf*/
char word[256];
char *input;
input = word;
printf("Please enter a word:\n");
scanf("%s", input);

/*Call sticky*/
sticky(input);

/*Print the new word*/
printf("%s", input);

for (int i = 0; i < sizeof(input); i++)
{
    if (input[i] == '\n')
    {
        input[i] = '\0';
        break;
    }
}

return 0; 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:27:59.523

您需要使用`strlen`not`sizeof`来查找 char* 字符串的长度

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T22:31:10.887

修改你的`change upper`and`change lower`函数

```
/*converts ch to upper case,*/
char toUpperCase(char ch)
{
    if(ch>='a' && ch<='z')/*If condition just to make sure current letter is in  lower case*/
        return ch-'a'+'A';
}

/*converts ch to lower case, assuming it is in upper case currently*/
char toLowerCase(char ch)
{
    if(ch>='A' && ch<='Z')/*If condition just to make sure current letter is in  Upper case*/
        return ch-'A'+'a';
} 
```

此外，仅`four characters`在您`sizeof`用于查找字符串长度时才进行转换。`sizeof`总是返回 4（取决于机器）。 在以下 for 循环中查找字符串**单词**`use strlen(word)`的长度：

 **```
for (int i = 0; i < strlen(word); i++)
{
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T22:28:29.783

您应该使用`strlen`而不是`sizeof`. 此外，您必须检查您的字母是大写还是小写：

```
for (int i = 0; i < strlen(word); i++)
{
    if (i % 2 == 0)
    {
        if ( isLowerCase(word[i]) )
        {
            word[i] = toUpperCase(word[i]);
        }
        else
        {
            // do nothing.
        }
    }
    else
    {
        if ( isUpperCase(word[i]) )
        {
            word[i] = toLowerCase(word[i]);
        }
        else
        {
            // do nothing.
        }
    }
} 
```

请注意，我还没有实现`isUpperCase`and`isLowerCase`函数；D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T22:29:38.437

您的代码中有问题：您将奇数字符设置为大写，甚至将字符设置为小写，但您首先没有检查它们是小写还是大写。但是降低一个已经小写的字母会给你一个错误的值（“大写”一个已经大写的字母也是如此）。

所以你应该这样做：

```
char toUpperCase(char ch)
{
 if ((ch >= 'a') && (ch <= 'z')) {
   return ch-'a'+'A';
 } else {
   return ch;
 }
} 
```

和同样的`toLowerCase`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T00:06:41.360

非常感谢您的提示！使用您的建议，我修改了我的代码，它现在可以工作了。

以下是我修改后的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/*converts ch to upper case, assuming it is in lower case currently*/
char toUpperCase(char ch){
    return ch-'a'+'A';
}

/*converts ch to lower case, assuming it is in upper case currently*/
char toLowerCase(char ch){
    return ch-'A'+'a';
}

void sticky(char* word)
{
 /*Convert to sticky caps*/

for (int i = 0; i < strlen(word); i++)
{
    if (i % 2 == 0)
    {
        if (word[i] >= 'a' && word[i] <= 'z')
        {
            word[i] = toUpperCase(word[i]);
        }

    }
    else
    {
        if (word[i] >= 'A' && word[i] <= 'Z')
        {
            word[i] = toLowerCase(word[i]);
        }

    }
} 
```

}

```
int main(){
/*Read word from the keyboard using scanf*/
char word[256];
char *input;
input = word;
printf("Please enter a word:\n");
scanf("%s", input);

/*Call sticky*/
sticky(input);

/*Print the new word*/
printf("%s", input);

for (int i = 0; i < sizeof(input); i++)
{
    if (input[i] == '\n')
    {
        input[i] = '\0';
        break;
    }
}

return 0; 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T22:27:28.133

函数`sizeof()`用于计算数据类型的大小，而不是分配给指针的大小。

所以你不能像这样使用它`sizeof(word)`。相反，迭代一个字符，直到你偶然发现一个`\0`，它表示字符串的结尾。

例如：

```
int i = 0;
while ( word[i] != 0 ) {
  // do lower/upper case conversion.
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-26T22:27:54.293

`sizeof (word)`是一个 char * 的大小，你必须用数组大小​​传递另一个参数...或者使用 strlen()。**

# c# - 在 c# 中读取特定的 websourcecode

> ID：15648536
> 
> 赞同：0
> 
> 时间：2013-03-26T22:23:24.970
> 
> 标签：c#, http

当我按下按钮时，会发生以下情况：

```
HttpWebRequest request = (HttpWebRequest)WebRequest
                                  .Create("http://oldschool.runescape.com/slu");
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
StreamReader sr = new StreamReader(response.GetResponseStream());

richTextBox1.Text = sr.ReadToEnd();
sr.Close(); 
```

简而言之，数据被传输到我的文本框（这很好用）

现在，如果我选择世界 78（例如，从组合框中，它将引用该行的最后一位数字）我想获得值 968，如果我选择世界 14，我想获得值 973。

这是打印数据的示例

```
e(378,true,0,"oldschool78",968,"United States","US","Old School 78");
e(314,true,0,"oldschool14",973,"United States","US","Old School 14"); 
```

我可以用什么来阅读这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:57:24.580

所以这里有两个问题，第一个是选对线，然后把号码弄出来。

首先，您需要一种将每一行放入列表的方法，例如使用以下内容：

```
List<String> lines = new List<String>()
string line = sr.ReadLine();
while(line != null)
{
     lines.Add(line);
     line = sr.ReadLine(); // read the next line
} 
```

然后你需要找到相关的行并从中取出令牌。

可能最简单的方法是，对于每一行，将字符串拆分为 ','、'\"'、'(' 和 ')'（使用 [String.Split](http://msdn.microsoft.com/en-us/library/b873y76a)）。也就是说，我们基本上得到了参数。

例如

```
foreach(string lineInFile in lines)
{
     // split the string in to tokens
     string[] tokens = lineInFile.Split(',', '\"', '(', ')');
     // based on the sample strings and how we've split this, 
     // we take the 15th entry 
     string endParameter = tokens[15]; //endParamter = "Old School 14"
     ... 
```

我们现在使用[正则表达式](http://msdn.microsoft.com/en-gb/library/system.text.regularexpressions.regex.aspx)来提取数字。我们将使用的模式是 d+，即 1 个或多个数字。

```
 Regex numberFinder = new Regex("\\d+");
     Match numberMatch = numberFinder.Match(endParameter);

     // we assume that there is a match, because if there isn't the string isn't
     // correct, you should do some error handling here

     string matchedNumber = numberMatch.Value;
     int value = Int32.Parse(matchedValue); // we convert the string in to the number
     if(value == desiredValue)
     ... 
```

我们检查该值是否与我们正在寻找的值匹配（例如 14），我们现在需要获取您想要的数字。

我们已经拆分了参数，我们想要的数字是第 8 项（例如 string[] 标记中的索引 7）。因为，至少在你的例子中，这只是一个单独的数字，我们可以解析它来获取 int。

```
 {
          return Int32.Parse(tokens[7]);
     }
} 
```

再次在这里，我们假设字符串采用您显示的格式，您应该在此处进行错误保护。

# php - 如何在php中的另一个类中使用来自其他类的变量

> ID：15648548
> 
> 赞同：1
> 
> 时间：2013-03-26T22:23:54.553
> 
> 标签：php

嗨，我试图通过stackoverflow找到我的问题的答案，但似乎我找不到任何东西。这是我的问题，我目前正在使用 MVC 框架，我需要从控制器的模型中访问变量。这是我的模型：

```
 <?php

    use Guzzle\Http\Client;

    class Position_model extends CI_Model{

      public function get_location($location){

    // Create a client and provide a base URL
    $client = new Client('http://maps.googleapis.com/maps/api/geocode/json');

    $request = $client->get('?address=' . $location . '&sensor=false');

    // Send the request and get the response
    $response = $request->send();
    //decode json file to get the longitude and latitude

    $json = json_decode($response->getBody(), true);
    var_dump($json);

    if($json["results"][0]["formatted_address"] AND $json["results"][0]["geometry"]["viewport"]["northeast"]){
            $position["address"] = $json["results"][0]["formatted_address"];
            $position["latitude"] = $json["results"][0]["geometry"]["viewport"]["northeast"]["lat"];
            $position["longitude"] = $json["results"][0]["geometry"]["viewport"]["northeast"]["lng"];

            return $position;

            $code = 'success';
            $content = 'LOCATION FOUND ... I AM AWESOME';
            $this->output->set_status_header(201);
        }else{
            $code = 'error';
            $content = 'OOPPS LOCATION NOT FOUND';
            $this->output->set_status_header(400);

        }

    } 
```

}

我需要从此类中获取 $position 以在名为 schedule 的控制器中使用，并将其附加到我尝试过的另一个名为 $data 的变量中：

```
 $position = $this->Position_model->get_location($location)->position;
    $data += $position; 
```

请帮我 ！！！！但是显然，这不起作用并给我错误，例如：未定义的位置或调用非对象属性

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:27:25.327

解决您的问题的简短答案：

```
$position = $this->Position_model->get_location($location);
$data += $position; 
```

但是您的代码中还有其他问题。你有类似的代码

```
$code = 'success';
$content = 'LOCATION FOUND ... I AM AWESOME';
$this->output->set_status_header(201); 
```

那将永远不会被执行，因为它在 return 语句之后。所以程序的执行永远不会到达它。您必须将这些放在 return 语句之前。

另外，我建议不要更新模型中的属性 $this->output。我会向控制器返回一些东西，并根据返回的值设置正确的 HTTP 标头。同时返回东西和改变对象状态会导致不可预知的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:27:31.803

的返回值`get_location`是位置。你不需要额外的`->position`

你的代码应该是

```
$position = $this->Position_model->get_location($location);
$data += $position; 
```

该错误告诉您您正在尝试处理不是对象的东西。

# python - filter_interface = models.HORIZONTAL --- 'module' 对象没有属性 'HORIZONTAL'

> ID：15648552
> 
> 赞同：0
> 
> 时间：2013-03-26T22:24:26.287
> 
> 标签：python, django, django-models

我不断收到错误：

> “模块”对象没有属性“水平”

我的一些模型是用`filter_interface = models.HORIZONTAL`.

什么是`filter_interface = models.HORIZONTAL`以及为什么我缺少此属性？

更多信息：代码是为版本“0.97-pre-SVN-unknown”编写的

我正在使用版本'1.4.1'

也许这个错误是因为我使用的是更新版本的 django？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:06:58.080

过滤器参数不是在模型上指定的，而是在`ModelAdmin`对象上指定的。在不深入研究 0.97 代码库的情况下，我怀疑接口已经改变。过滤是`django.contrib.admin`应用程序的一部分，所以我建议阅读[https://docs.djangoproject.com/en/dev/ref/contrib/admin/](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)上的文档。

您可能必须重构`filter_interface`参数才能使用该[`ModelAdmin.filter_horizontal`](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.filter_horizontal)属性。

# java - Maven 单元测试

> ID：15648557
> 
> 赞同：2
> 
> 时间：2013-03-26T22:24:57.067
> 
> 标签：java, maven

我正在开发一个使用 Maven 编写的项目。

如果我做

```
mvn clean install 
```

然后我希望它会在`/test`forder 下运行所有​​单元测试。

我重定向了构建过程并存储到一个输出文件中，并试图通过名称找出单元测试。但是，我无法找到一些单元测试。似乎某些单元测试实际上并未在构建过程中执行。

我的问题是我如何知道将在构建过程中执行的单元测试的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:54:11.500

您可以尝试在命令行中显式命名组，如下所示：

```
mvn clean install -Dtest.groups="unit,integration" 
```

或者干脆

```
mvn test -Dtest.groups="unit,integration" 
```

这是我每天使用的一个例子。我的测试要么在**单元**中，要么在**集成**组中。如果您希望运行所有（或部分）测试而不需要明确指定要使用的组，您必须修改您的 maven 配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T08:04:12.763

Maven 中的单元测试将按其名称选择，该名称应遵循[命名约定](http://maven.apache.org/surefire/maven-surefire-plugin/test-mojo.html#includes)

```
<includes>
 <include>**/*Test*.java</include>
 <include>**/*Test.java</include>
 <include>**/*TestCase.java</include>
</includes> 
```

此外，您需要将测试放在默认位置**src/test/java/**。

您可以使用以下命令控制仅运行一个测试：

```
mvn -Dtest=MyTest test 
```

运行集成测试是在集成测试阶段处理的[maven-failsafe-plugin的工作。](http://maven.apache.org/plugins-archives/maven-failsafe-plugin-2.12.4/)集成测试的命名约定是：

```
<includes>
 <include>**/*IT*.java</include>
 <include>**/*IT.java</include>
 <include>**/*ITCase.java</include>
</includes> 
```

要运行集成测试，您需要为 maven-failsafe-plugin 添加配置部分。

# facebook-graph-api - 在 Ads API 中更新广告系列预算时达到用户请求限制

> ID：15648558
> 
> 赞同：0
> 
> 时间：2013-03-26T22:24:58.983
> 
> 标签：facebook-graph-api, ads, facebook-ads-api

与更新其他选项相比，更改广告系列预算的速率限制似乎要低得多：http: [//developers.facebridge.net/bugs/285486761555036 ?browse=search_50da9ab10555f6203542865](http://developers.facebridge.net/bugs/285486761555036?browse=search_50da9ab10555f6203542865)

即使快速连续三次更改预算似乎也不起作用。这个特定预算的费率限制是否在任何地方公布？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T16:16:43.973

确切的数字尚未公布，但 FB 确实在几周前发布了新的 API 速率限制文档。

您可以在[https://developers.facebook.com/docs/reference/ads-api/api-rate-limiting/#adcampaignlimit](https://developers.facebook.com/docs/reference/ads-api/api-rate-limiting/#adcampaignlimit)查看。

每日和终生预算确实有自己特定的速率限制（同样，没有确切数字）。

# windows - Windows批处理文件读取文本文件并将全部转换为大写

> ID：15648560
> 
> 赞同：3
> 
> 时间：2013-03-26T22:25:05.783
> 
> 标签：windows, text, batch-file, uppercase

我只是想将文本文件中的所有文本替换为大写。

例如 abc.txt

[转换前] 名字、姓氏、全名 Brad、Pitt、Brad Pitt

[转换后] FIRST NAME, LAST NAME, FULL NAME BRAD, PITT, BRAD PITT

那可能吗？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T02:31:31.960

下面的批处理文件做你想要的，但如果要转换的文件很大，这种方法很慢......

```
@echo off
setlocal EnableDelayedExpansion
for /F "delims=" %%a in (%1) do (
   set "line=%%a"
   for %%b in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
      set "line=!line:%%b=%%b!"
   )
   echo !line!
) 
```

要使用此程序，请将文件名放在第一个参数中。例如，如果此批处理文件名为 TOUPPER.BAT：

```
toupper abc.txt 
```

请注意，此程序会消除文件中存在的空行和任何感叹号。如果需要，这些限制可能会被修复，但程序会变得更慢......

安东尼奥

# macos - MacPorts 二进制文件在哪里？

> ID：15648561
> 
> 赞同：0
> 
> 时间：2013-03-26T22:25:12.067
> 
> 标签：macos, ant, macports

我正在尝试使用 ant`rpm`任务在 Mac OSX 上构建 Linux 安装程序。

我安装了 MacPorts 并编译了现在可以从命令行运行的 rpm。

但是，我希望它与 ant 一起工作（从 Eclipse 内部），但 ant 找不到任何`rpm`可执行文件。其实`whereis rpm`也没有找到。使困惑..

我还尝试使用 macports ( `sudo port pkg rpm`) 创建一个单独的 rpm 二进制安装程序，但安装后没有任何变化。

rpm 二进制文件在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:34:04.393

MacPorts 二进制文件可以在`/opt/local/bin`.

根据手册页，`whereis`仅搜索包含在`user.cs_path`sysctl 变量中的目录（至少在 OS X 上）。这个值默认`/usr/bin:/bin:/usr/sbin:/sbin`在我的机器上。

# c# - 无法找到两个数组的交集

> ID：15648564
> 
> 赞同：-3
> 
> 时间：2013-03-26T22:25:22.087
> 
> 标签：c#

我有一个数组`int[] com`，其中包含两个值 0 和 1（在初始阶段）。

我将另一个数组定义为`String[] arr = new String[100];`

`arr`包含6个元素，它们是：

```
arr[0]={4,8,10,11,12,14}
arr[1]={1,2,3,4,8,12,14}
.. arr[6]=something 
```

我想找到 arr[0] 和 arr[1] 的交集，所以我将代码编写为：

```
foreach (int value1 in intersect) 
{
     //perform logic
} 
```

在这里，我应该将 value1 设为 4,8，但我将 value1 设为 52,44。

我在做什么有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:57:50.533

好的，这就是您正在做的事情，您有字符串数组而不是 int 数组。如果你这样做

```
arr[0]="4,8,10,11,12,14";
arr[1]="1,2,3,4,8,12,14";
var intersection = arr[0].Intersect(arr[1]); 
```

因为`arr[0]`和`arr[1]`是字符串，所以你会得到这个字符列表，`'4', ',' , '8', '1', '2'`它分别对应于`52 44 56 49 50`你得到的整数值。

您应该声明整数矩阵而不是字符串数组，`int [,] arr = new int[100,100];`甚至更好`List<List<int>>`。您不能使用像字符串这样的整数，至少在这种情况下不能。

```
List<List<int>> arr = new List<List<int>>();
arr.Add(new List<int>{4,8,10,11,12,14});
arr.Add(new List<int>{1,2,3,4,8,12,14});
var intersection = arr[0].Intersect(arr[1]); 
```

但是，如果您不相信我，并且想确定您之前的代码没有意义，请更改`foreach`循环并查看发生了什么：

```
foreach (char value1 in intersect) 
{
     //perform logic
} 
```

此外，您不需要这样做：

```
int zero= Convert.ToInt32(com[0].ToString());
int one= Convert.ToInt32(com[1].ToString()); 
```

您可以将其替换为以下内容：

```
int zero= com[0];
int one = com[1]; 
```

但尽管如此，这毫无意义，因为您可以这样做：

```
arr[com[0]]
arr[com[1]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:33:01.473

LINQ [Intersect](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)方法正确计算数组之间的交集：

```
var a = new [] {4,8,10,11,12,14};
var b = new [] {1,2,3,4,8,12,14};
var intersection = a.Intersect(b);
// intersection:
// IEnumerable<int> { 4, 8, 12, 14 } 
```

上面的代码 - 代表一个最小的*非失败*计数器示例 - 在 LINQPad 中运行。

请注意，Intersect 依赖于 Equals，因此可以“破坏”它：

```
var a = new object[] {4,8,10,11,12,14};
var b = new object[] {"1","2","3","4","8","12","14"};
var intersection = a.Intersect(b);
// intersection:
// IEnumerable<object> { } 
```

当然，这*不*考虑“随机新值” - 这只是其他地方的错误。

# python - 该字段没有指定默认值，但不是 NULL

> ID：15648565
> 
> 赞同：1
> 
> 时间：2013-03-26T22:25:42.010
> 
> 标签：python, database, django

我不知道 Django 想告诉我什么。我有一个模型，`WeekTwo`它继承自`Week`，它继承自`modelsModel`。我有另一个模型，`UserProfile`. 我想`WeekTwo`用作 OneToOne Key in `UserProfile`，所以我插入了以下代码行：

```
weekTwo = models.OneToOneField(WeekTwo) 
```

但是，当我尝试使用 迁移我的数据库时`python manage.py schemamigration my_app --auto`，出现以下错误：

```
The field 'UserProfile.weekTwo' does not have a default specified, yet is NOT NULL. 
```

我尝试添加`default=0`到我的`weekTwo`声明中，但现在当我尝试架构迁移时出现此错误：

```
IntegrityError: column weekTwo_id is not unique 
```

此外，南现在告诉我我在一个`interim state between migrations`并且我`might be able to recover`。我真的不知道这意味着什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:41:27.540

*在继续之前请注意，如果 South 已经进行了任何失败的迁移，最好重做|恢复到最后一个`migration`工作。*

你在这里有两个选择，一开始你可以做[`Data Migration`](http://south.readthedocs.org/en/latest/tutorial/part3.html#data-migrations). 也看看[ref](http://south.readthedocs.org/en/latest/commands.html#datamigration)。

在第二种方式中，您可以先制作`weekTwo`字段`null``blank`

```
weekTwo = models.OneToOneField(WeekTwo, null=True, blank=True) 
```

然后让 South 为您生成迁移

```
python manage.py schemamigration my_app --auto 
```

我相信南方现在不会抱怨了，然后

```
python manage.py migrate 
```

如果现在一切正常，您现在可以返回并更改`weekTwo`为

```
weekTwo = models.OneToOneField(WeekTwo) 
```

然后`generate`迁移`migrate`他们。

无论如何，当 south 发现您的字段不在`NULL`并且没有`default`值时，在这`schemamigration`一步它会建议您为它提供一个值，再次在这里您的字段是`OneToOneField`，因为即使 south 也让您有机会为您在模型上的现有记录，weekTwo 字段的唯一性将引发错误。

我认为如果第二种方法不起作用，您仍然必须使用**数据迁移**，或者试一试，这次尝试第二种方法而不是成功`null`，`blank`更改整个`Field`类型。试试看；

```
weekTwo = models.ForeignKey(WeekTwo) 
```

但请记住，这里的**数据迁移**绝对是更智能和标准的方式。

# jquery - Ennui Jquery Content Slider 的 IE 问题，内容不居中

> ID：15648573
> 
> 赞同：0
> 
> 时间：2013-03-26T22:26:11.533
> 
> 标签：jquery, css, slider

我正在使用的滑块演示可以在这里找到：http: [//www.copterlabs.com/demo/contentslider/](http://www.copterlabs.com/demo/contentslider/)

我的滑块页面在这里：[http ://crucialexams.com/test/test-exam-1](http://crucialexams.com/test/test-exam-1)

问题是，在 IE 中，第一页没有居中，而是在它的左侧有很大的空间。使用箭头来回导航后，一切正常。我用过的所有IE都有这个问题。

有任何想法吗？谢谢！

固定：根据 php 的工作方式，有时它没有放置起始 html 标记。修复了它，它现在中心很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:28:59.123

我刚刚在 IE7/8 中都试过了，它是居中的。你发帖后有更新吗？

# symfony-1.4 - 在 where() 子句中推进多参数绑定

> ID：15648574
> 
> 赞同：0
> 
> 时间：2013-03-26T22:26:17.163
> 
> 标签：symfony-1.4, propel

我正在尝试使用 symfony 1.4.20 在 Propel 1.6 上运行此查询。

我想将 2 个参数绑定到这个子查询上，但它不起作用。

```
$paginas = PaginaQuery::create()                              
                               ->where("pagina.id not in (select id from cliente_artista where cliente_artista.cliente_id = ? and cliente_artista.culture = ?)"
                                       ,array('XXX', 'en')
                                      )
                          ->limit(5)
                          ->find(); 
```

这给了我错误：

```
Cannot determine the column to bind to the parameter in clause 
```

我也找到了这篇文章，但没有答案（[https://groups.google.com/forum/?fromgroups=#!topic/propel-users/2Ge8EsTgoBg](https://groups.google.com/forum/?fromgroups=#!topic/propel-users/2Ge8EsTgoBg)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:25:11.313

而不是使用占位符。你可以使用 $id 和 $culture：

```
//first, get an array of the id's
//define your vars
$id = $your_id_param;
$culture = 'en';
$cliente_artistas = ClienteArtistaQuery::create()
                        ->select('id')
                        ->distinct()
                        ->filterByClienteId($id)
                        ->filterByCulture($culture)
                        ->find();

$paginas = PaginaQuery::create()                              
               ->where("pagina.id NOT IN ?", $cliente_artistas)
               ->limit(5)
               ->find(); 
```

如果这必须在一个查询中完成，建议使用原始 sql 并将参数绑定到 PDO 语句中（但这样会失去 PropelObjectCollections 的便利性）：

```
 public function getResultSet($id, $culture) {
    $id = $id_param;
    $culture = $culture_param;
    $sql = <<<ENDSQL
SELECT * from pagina
WHERE id NOT IN (SELECT distinct id 
                 FROM cliente_artista 
                 WHERE cliente_id = ?
                 AND culture = ?
                 )
LIMIT 5
ENDSQL;
    $connection = Propel::getConnection();
    $statement = $connection->prepare($sql);
    $statement->bindValue(1, $id);
    $statement->bindValue(2, $culture);
    $statement->execute();
    $resultset = $statement->fetchAll(PDO::FETCH_ASSOC); // or whatever you need

    if (! count($resultset) >= 1) {
      // Handle empty resultset
    }

    return $resultset;
  } 
```

您还可以编写一些查询方法来使用[推进 orm 查询方法](http://propelorm.org/reference/model-criteria.html#using-a-query-as-input-for-a-second-query-table-su)。当然，[propel api](http://api.propelorm.org/1.6.8/)是有益的参考。有几种方法可以做到这一点。我在这里指出了一种适合您的方法。

**编辑：** 这是一个关于将其作为一个查询执行的想法[因为 useSelectQuery() 需要“关系”名称]，这个想法假设表不相关，但 id 是：

```
$paginas = PaginaQuery::create()                              
           ->addJoin(PaginaPeer::ID, ClienteArtistaPeer::CLIENTE_ID, Criteria::LEFT_JOIN)
           ->where("ClienteArtista.Id <> ?", $id)
           ->where("ClienteArtista.Culture <> ?", $culture)
           ->select(array('your','pagina','column','array'))
           ->limit(5)
           ->find(); 
```

# python - 如果python中有超过4行，则将文本行附加到文件并删除第一个

> ID：15648578
> 
> 赞同：0
> 
> 时间：2013-03-26T22:26:34.240
> 
> 标签：python, text, line

我有一个 IRC 客户端，当我广播我的桌面时人们正在聊天。我想在我的广播中展示它，并找到了一个方便的冲击波 Flash 标题插件，它可以读取文本文件并将它们显示在屏幕上。

我的 IRC 客户端使用 python 脚本，每次有人写消息时都可以调用一个函数。

我可以将这些文本行写入一个文本文件，但是当文件中有超过“说 4”行的文本时，我想要某种方式在 python 中编码，它会在添加下一个时删除最上面的一个。

我计划通过在调用附加行函数时读取文本文件来做到这一点，读取最后 3 行添加新行，然后将其重新写入原始文件。

当然，当脚本第一次运行时，文件中的行数应该少于 3 行，因此 python 也应该考虑到这一点，并且只读取最后的 2 或 1 或 0，具体取决于...

我尝试在上一个问题中编写一些代码，但它不起作用，所以我不会在此处包含它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:00:22.693

您不应该轻易放弃，您[之前问题](https://stackoverflow.com/questions/15647467/copy-the-last-three-lines-of-a-text-file-in-python)的公认答案几乎做到了。

您只需要执行以下操作：

1.  打开输入文件，使用 a`deque`获取最后几行，并附加新行
    （不要忘记使用新行分隔符`\n`）
2.  重新打开该文件作为输出文件并写入您的行集合。

* * *

```
from collections import deque

path = 'test.txt'

with open(path, 'r') as file:
    lines = deque(file, 4)
    lines.append("\nthis is an additional line.")

with open(path, 'w') as file:
    file.writelines(lines) 
```

# parallel-processing - 如何在球拍中并行地将函数映射到列表上？

> ID：15648579
> 
> 赞同：8
> 
> 时间：2013-03-26T22:26:34.883
> 
> 标签：parallel-processing, scheme, racket

问题标题确实说明了一切：在球拍中将函数映射到并行列表的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T23:56:38.720

如果您的意思是多个处理器内核，那么最通用的方法是使用[Places](http://docs.racket-lang.org/reference/places.html)。

> Places 支持开发利用具有多个处理器、内核或硬件线程的机器的并行程序。
> 
> 地点是一个并行任务，它实际上是 Racket 虚拟机的一个单独实例。场所通过场所通道进行通信，场所通道是双向缓冲通信的端点。

您*也许*可以使用另一种并行化技术[Futures](http://docs.racket-lang.org/reference/futures.html)，但它的工作条件相对有限，例如浮点运算，如此处[所述](http://docs.racket-lang.org/guide/performance.html#%28part._effective-futures%29)。

* * *

**编辑**：回应评论：

> 是否有在某处使用地点的并行地图实现？

首先，我应该备份。您可能不需要 Places。您可以使用 Racket 线程获得*并发性。*例如，这是一个`map/thread`：

```
#lang racket

(define (map/thread f xs)
  ;; Make one channel for each element of xs.
  (define cs (for/list ([x xs])
               (make-channel)))
  ;; Make one thread for each elemnet of xs.
  ;; Each thread calls (f x) and puts the result to its channel.
  (for ([x xs]
        [c cs])
    (thread (thunk (channel-put c (f x)))))
  ;; Get the result from each channel.
  ;; Note: This will block on each channel if not yet ready.
  (for/list ([c cs])
    (channel-get c)))

;; Use:
(define xs '(1 2 3 4 5))
(map add1 xs)
(map/thread add1 xs) 
```

如果正在完成的工作涉及阻塞，例如 I/O 请求，这将为您提供“并行性”，即不会卡在 I/O 上。然而，Racket 线程是“绿色”线程，因此一次只有一个线程会使用 CPU。

如果您确实需要并行使用多个 CPU 内核，那么您将需要 Futures 或 Places。

由于 Places 的实现方式——有效地作为多个 Racket 实例——我没有立即看到如何编写泛型`map/place`. 有关以“定制”方式使用地点的示例，请参阅：

*   [*指南*中的地方](http://docs.racket-lang.org/guide/performance.html#(part._effective-places))
**   [*参考文献*中的位置](http://docs.racket-lang.org/reference/places.html)*

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-18T04:23:54.090

我不知道在 Racket 中，但我在[SISC Scheme](http://sisc-scheme.org/)中实现了一个版本。

```
(define (map-parallel fn lst)
  (call-with-values (lambda ()
                      (apply parallel 
                             (map (lambda (e)
                                    (delay (fn e)))
                                  lst)))
    list)) 
```

只是[`parallel`](http://sisc-scheme.org/manual/html/ch06.html#id2592773)不是R5RS。

使用示例：

使用常规`map`：

```
(time (map (lambda (a)
        (begin
          (sleep 1000)
          (+ 1 a)))
     '(1 2 3 4 5)))
=> ((2 3 4 5 6) (5000 ms)) 
```

使用`map-parallel`：

```
(time (map-parallel (lambda (a)
        (begin
          (sleep 1000)
          (+ 1 a)))
     '(1 2 3 4 5)))
=> ((2 3 4 5 6) (1000 ms)) 
```**

# c++ - 每个运行时函数的地址是否改变

> ID：15648582
> 
> 赞同：1
> 
> 时间：2013-03-26T22:26:50.310
> 
> 标签：c++, file-io, function-pointers

我正在用 c++ 编写一些东西，我想从文件中读取文本，该文件指示我在程序中声明的字符串和函数之间的相关性。例如，该文件可以读取：

```
sin:sin
PI:getPi
+:add 
```

我希望代码采用它并创建一个哈希表或字符串和函数指针数据结构的向量。不幸的是，我意识到代码在运行时无法找到函数的*名称*，所以我希望能够将这些函数的地址放入文件中。但是，如果每次程序运行或编译时函数的地址都不同，这个系统当然就不能工作了。任何这些问题的启蒙或替代解决方案都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:28:40.850

也许？

您的系统是否使用 ASLR？

地址空间布局随机化，它是现代系统用来防止漏洞利用执行私有或特权函数执行 ROP 攻击的一种技术。

基本上它随机化了函数在内存中的位置。如果您知道基本图像的位置，这是可以解决的，因为一切仍然是相对的。你会经常看到像 0xDEADBEEF+13 这样的符号。

有关详细信息，请参阅[ASLR](http://en.wikipedia.org/wiki/Address_space_layout_randomization)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:29:12.247

您可以在编译时安全地获取函数地址（函数指针）。当您启动程序时，重新定位您的函数地址是图像加载器的任务。您不必担心函数地址的变化。

您当然不能做的是将函数的地址打印到标准输出并将该地址作为数值放入您的程序中。那会受到您描述的问题的影响。

要获取 C++ 函数的地址，`sin()`只需`&sin`在您的代码中使用。

要通过字符串获取 C++ 函数的地址，您必须具有如下代码：

```
if (function_name == "sin") return &sin;
else if (function_name == "add") return &add;
else ... 
```

或具有字符串/函数指针对的合适数据结构。

要点是：不要将数字函数地址存储在文件中。直接在你的程序中获取和使用函数地址。数字函数地址对您的程序应该无关紧要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:33:13.860

您不能依赖地址保持固定，因为操作系统可能会使用[地址空间布局随机化](http://en.wikipedia.org/wiki/Address_space_layout_randomization)来降低漏洞利用的有效性。

如果它们都在同一个链接的二进制文件中，您*也许*可以依赖函数的*相对地址。*选择一个作为基数，然后从所有其他中减去它。

如果您重新编译和/或重新链接，这自然会全部关闭。我会尝试寻找不同的方法。

一种这样的方法是为每个函数使用整数索引，并保留一个表，其中索引对应于哪个函数。它引入了另一层间接，但会更加健壮。

**编辑：**如果您不想创建静态表，您可以让代码在程序初始化时使用静态对象和构造函数构建一个。

```
struct FunctionTable
{
    typedef std::unordered_map<std::string, void *> table;
    static table& get()
    {
        static table the_table;
        return the_table;
    }
    FunctionTable(std::string name, void * func)
    {
        get().insert(name, func);
    }
};

double getPi()
{
    return 3.14159;
}
static FunctionTable ft_getPi = FunctionTable("getPi", getPi); 
```

# android - 当另一个应用开始播放音频时，如何自动暂停我的应用中的音频播放器？

> ID：15648587
> 
> 赞同：0
> 
> 时间：2013-03-26T22:27:10.433
> 
> 标签：android

我的应用播放音频文件。如果另一个应用程序开始播放音频，我希望我的应用程序暂停音频播放。我不希望这两个音频声音相互混淆。我的应用程序将在其他应用程序完成播放其音频后恢复音频播放。我怎样才能做到？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:49:18.323

取决于您的应用程序的运行方式，即。当应用程序在前台运行时（用户正在查看您的屏幕），或者如果您正在运行当前在后台的“服务”并且您希望继续播放音乐（songza、slacker radio 等），您将如何处理这些事情不同的。Android 使用内部系统状态来确定哪些应用程序应该向扬声器输出音频。所有这些都由音频管理器 requestAudioFocus() releaseAudioFocus() 处理，这将是您最想查看的系统调用。有关更详细的说明，请参阅 android developer api，您可以在其中很好地解释和记录[http://developer.android.com/guide/topics/media/mediaplayer.html](http://developer.android.com/guide/topics/media/mediaplayer.html)

# json - 如何在 webapp2 中 JSON 格式化 HTTP 错误响应

> ID：15648589
> 
> 赞同：4
> 
> 时间：2013-03-26T22:27:19.847
> 
> 标签：json, google-app-engine, error-handling, webapp2

我正在使用 webapp2 在 App Engine 中进行开发。我想做的是在发生错误时发送自定义 JSON 格式的响应。例如，当请求长度大于阈值时，使用 HTTP 400 和响应正文进行响应

```
{'error':'InvalidMessageLength'} 
```

在 webapp2 中，可以选择为某些异常分配错误处理程序。例如：

```
app.error_handlers[400] = handle_error_400 
```

其中 handle_error_400 如下：

```
def handle_error_400(request, response, exception):
    response.write(exception)
    response.set_status(400) 
```

当`webapp2.RequestHandler.abort(400)`被执行时，上面的代码就被执行了。

如何根据上述设置动态地拥有不同的响应格式（HTML 和 JSON）？也就是说，如何调用不同版本的`handle_error_400`函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T23:34:18.797

这是一个完整的示例，它演示了如何为所有类型的错误使用相同的错误处理程序，如果您的 URL 以开头，`/json`那么响应将是一个`application/json`（发挥您的想象力，了解如何充分利用该`request`对象来决定什么你应该提供什么样的回应）：

```
import webapp2
import json

def handle_error(request, response, exception):
  if request.path.startswith('/json'):
    response.headers.add_header('Content-Type', 'application/json')
    result = {
        'status': 'error',
        'status_code': exception.code,
        'error_message': exception.explanation,
      }
    response.write(json.dumps(result))
  else:
    response.write(exception)
  response.set_status(exception.code)

app = webapp2.WSGIApplication()
app.error_handlers[404] = handle_error
app.error_handlers[400] = handle_error 
```

在上面的示例中，您可以通过访问以下将返回 a 的 URL 轻松测试不同的行为，`404`这是最容易测试的错误：

```
http://localhost:8080/404
http://localhost:8080/json/404 
```

# java - Java实际参数列表和形式参数列表的长度不同？

> ID：15648599
> 
> 赞同：-4
> 
> 时间：2013-03-26T22:27:53.760
> 
> 标签：java

我正在为我的编程课开发一个游戏，我在 Eclipse 中编写了没有可见错误的代码，但是当我编译它时，我收到以下错误消息：

> TogizKumalak20.java:220：错误：类 board20 中的方法 moveBoard 不能应用于给定类型；playBoard.moveBoard(playTurn, keyCharAsInt); 必需：cup20 找到：int,int 原因：实际参数列表和形式参数列表的长度不同

我不确定是什么原因造成的以及如何解决它。非常感谢您的任何意见，并提前感谢您！

```
import java.awt.Container;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.MouseEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseMotionAdapter;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Point2D;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;
import java.awt.Cursor;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import javax.swing.*;
import java.io.*;
import javax.swing.JFileChooser;
import java.awt.Color;
import java.awt.event.*;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;

public class TogizKumalak20
{
    public static void main(String[] args)
    {
        TKFrame myFrame = new TKFrame();
        myFrame.setTitle("Togiz Kumalak U22");
        myFrame.setVisible(true);
    }
}

class TKFrame extends JFrame
{
    private TKPanel myPanel;
    private final int FRAMEW = 700;
    private final int FRAMEH = 700;

    public TKFrame()
    {
        setSize(FRAMEW, FRAMEH);

        myPanel = new TKPanel();
        Container contentPane = getContentPane();

        contentPane.add(myPanel);
        addWindowListener(new WindowCloser());

        JMenuBar menuBar = new JMenuBar();
        setJMenuBar(menuBar);

        JMenu fileMenu = new JMenu("File");
        menuBar.add(fileMenu);

        JMenuItem restartItem = new JMenuItem("Restart");
        fileMenu.add(restartItem);

        RestartListener myRestartListener = new RestartListener();
        restartItem.addActionListener(myRestartListener);

        JMenuItem exitItem = new JMenuItem("Exit");
        fileMenu.add(exitItem);

        ExitListener myExitListener = new ExitListener();
        exitItem.addActionListener(myExitListener);
    }

    private class WindowCloser extends WindowAdapter
    {
        public void windowClosing(WindowEvent event)
        {
            dispose();
        }
    }

    private class RestartListener implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {

            myPanel.renewBoard();

            myPanel.renewTextArea();

            myPanel.setMoveCount(1);
        }
    }

    private class ExitListener implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            System.exit(0);
        }
    }
}

class TKPanel extends JPanel
{
    private board20 playBoard;
    private int playTurn;
    private JTextArea actionRecordArea;
    private JScrollPane actionScrollPane;
    private int moveCount = 1;

    public TKPanel()
    {
        super();
        playTurn = 1;
        playBoard = new board20();
        actionRecordArea = new JTextArea(6, 24);
        actionRecordArea.setEditable(false);
        actionScrollPane = new JScrollPane(actionRecordArea,
            JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,
            JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
        add(actionScrollPane, "North");
        addMouseListener(new MouseHandler());
        addMouseMotionListener(new MouseMotionHandler());
        addKeyListener(new KeyHandler());
        setFocusable(true);
    }

    public void renewBoard()
    {
        playBoard = new board20();
        repaint();
    }

    public void renewTextArea()
    {
        actionRecordArea.setText("");
        repaint();
    }

    public int getMoveCount()
    {
        return moveCount;
    }

    public void setMoveCount(int countIn)
    {
        moveCount = countIn;
    }

    public void paintComponent(Graphics g)
    {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        playBoard.drawBoard(g2);
    }

    private class MouseHandler extends MouseAdapter
    {
        public void mouseClicked(MouseEvent event)
        {
            cup20 returnedCup;

            returnedCup = playBoard.isTheMouseInaCup(event.getPoint());

            if(returnedCup != null)
            {
                if(returnedCup.getWhoseCup() == playTurn)
                {
                    setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));

                    playBoard.moveBoard(returnedCup);

                    int whatCupNumber = playBoard.getCupNumber(returnedCup);
                    actionRecordArea.append("Move:  " + moveCount + ".  Player:  " + playTurn + ".  Cup:  " + whatCupNumber + ".\n");
                    moveCount++;

                    if(playTurn == 1)
                      playTurn = 2;
                    else
                      playTurn = 1;

                    repaint();
                }
            }
        }
    }

    private class MouseMotionHandler extends MouseMotionAdapter
    {
        public void mouseMoved(MouseEvent event)
        {
            cup20 retCup = playBoard.isTheMouseInaCup(event.getPoint());

            if(retCup == null)
              setCursor(Cursor.getDefaultCursor());
            else
            {
                if(retCup.getWhoseCup() == playTurn)
                  setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
                else
                  setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));
            }
        }
    }

    private class KeyHandler extends KeyAdapter
    {
        public void keyTyped(KeyEvent event)
        {
            char keyChar = event.getKeyChar();

            int keyCharAsInt;

            if(keyChar == '1' || keyChar == '2' || keyChar == '3' || keyChar == '4' || keyChar == '5' || keyChar == '6' || keyChar =='7' || keyChar == '8' || keyChar == '9')
            {
                keyCharAsInt = (int) keyChar - 48;

                setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));

                playBoard.moveBoard(playTurn, keyCharAsInt);

                actionRecordArea.append("Move:  " + moveCount + ".  Player:  " + playTurn + ".  Cup:  " + keyCharAsInt + ".\n");
                moveCount++;

                if(playTurn == 1)
                  playTurn = 2;
                else
                  playTurn = 1;

                repaint();
            }
            else
            {
            }
        }

        public board20 getBoard()
        {
            return playBoard;
        }

        public String getText()
        {
            return actionRecordArea.getText();
        }

        public void setText(String textIn)

    {
            actionRecordArea.setText(textIn);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:53:41.470

（粗体表示原来的错误信息，就位。）

在**TogizKumalak20.java**的第**220**行，类 board20 中的**方法 moveBoard 不能**用 **给定的类型**调用（它被称为**playBoard.moveBoard(playTurn, keyCharAsInt)**因为该方法被声明为采用单个**cup20**参数，但有两个参数（**int,int** ) 在方法调用中使用，因此**实际参数列表和形式参数列表的长度不同**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:36:43.930

你有另一个只需要一个参数的 moveBoard 调用。你有理由认为有一个版本的方法需要两个整数作为参数吗？如果是这样，您使用的是正确版本的 board20 吗？那是你的课，还是图书馆课？你不给它来源。

该错误告诉您没有具有该方法签名的方法（参数的数量和类型构成签名）。编译器可用的类版本中没有这样的方法。

# c# - WPF - 依赖于树深处的节点样式

> ID：15648604
> 
> 赞同：0
> 
> 时间：2013-03-26T22:28:00.510
> 
> 标签：c#, .net, wpf, treeview

我正在寻找有关在 WPF 中设置 TreeView 样式的信息。我想为每个级别的树设置不同的文本颜色。我有 3 个级别的树。

例子：

-> Root（黑色）
    -> Level 1a（红色）
      -> Level 2a（绿色）
      -> Level 2b（绿色）
    -> Level 1b（红色）
      -> Level 2c（绿色）

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:10:26.847

您可以使用自定义逻辑在视图模型属性上绑定颜色（前景或背景）。

在您的情况下，您必须使用一点逻辑来计算级别：找到父视图模型的级别并添加 1 或如果 parent 为空则返回 0。

如果您是 WPF 和树视图的新手，我强烈建议您阅读： http: [//www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode](http://www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode)

# c# - 将 sql 转换为 LINQ TOP 1 NOT in

> ID：15648606
> 
> 赞同：-2
> 
> 时间：2013-03-26T22:28:06.223
> 
> 标签：c#, sql, linq

如何将此 SQL 转换为 LINQ？

```
Select Top 1 iD, Grad from tbl1 
WHERE tbl1.ID not in 
(Select GradId from tbl2 WHERE ID = 99469) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:52:53.370

看起来最简单的方法是这样的：

```
var grads = 
    (from r in tbl2 
     where r.ID == 99469 
     select r.GradID);
var results = 
    (from r in tbl1
     where !grads.Contains(r.ID)
     select new { r.ID, r.Grad })
    .FirstOrDefault(); 
```

或者更简洁一点：

```
var grads = ...
var results = tbl1
    .Select(r => new { r.ID, r.Grad })
    .FirstOrDefault(r => !grads.Contains(r.ID)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T23:00:27.890

类似的东西：

```
 var query =
         (from c in db.tbl1
          where !(from d in db.tbl2
          select d.id)
               .Contains(c.id)
          select c).Take(1) 
```

# c# - 找到两条线之间的交点

> ID：15648607
> 
> 赞同：5
> 
> 时间：2013-03-26T22:28:06.290
> 
> 标签：c#, math, geometry, unity3d

所以我一直在研究这个相对简单的算法。我不确定我的代码有什么问题，但我没有得到它们实际相交的交点。

我正在使用 Unity3D，我试图在 x,z 平面中找到两条线相交的点，但不在 x,y 平面中。我假设适用于 x,y 的算法应该适用于 x,z；

我的代码：

```
Vector3 thisPoint1 = thisCar.position + (2 * thisCar.forward);
Vector3 thisPoint2 = thisCar.position + (20 * thisCar.forward);

Debug.DrawLine(thisPoint1, thisPoint2, Color.white, 2);

Vector3 otherPoint1 = threateningCar.position + (2 * threateningCar.forward);
Vector3 otherPoint2 = threateningCar.position + (20 * threateningCar.forward);

Debug.DrawLine(otherPoint1, otherPoint2, Color.white, 2);

float A1 = thisPoint2.z - thisPoint1.z;
float B1 = thisPoint1.x - thisPoint2.x;
float C1 = A1 * thisPoint1.x + B1 * thisPoint1.z;

float A2 = otherPoint2.z - otherPoint1.z;
float B2 = otherPoint1.x - otherPoint2.x;
float C2 = A2 * otherPoint1.z + B2 * otherPoint1.z;

float det = A1 * B2 - A2 * B1;

float x = (B2 * C1 - B1 * C2) / det;
float z = (A1 * C2 - A2 * C1) / det;

return new Vector3(x, this.transform.position.y, z); 
```

谁能帮忙指出我做错了什么？

`thisCar.forward`并且`threateningCar.forward`通常是`[0,0,1], [0,0,-1]`或者`[1,0,0], [-1,0,0]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T21:07:21.847

找到了！！！

```
float A2 = otherPoint2.z - otherPoint1.z;
float B2 = otherPoint1.x - otherPoint2.x;
float C2 = A2 * otherPoint1.z + B2 * otherPoint1.z; 
```

应该：

```
float A2 = otherPoint2.z - otherPoint1.z;
float B2 = otherPoint1.x - otherPoint2.x; 
```

`float C2 = A2 * otherPoint1`**.x** `+ B2 * otherPoint1.z` ;

浪费了很多时间：/。

无论如何，这将帮助任何想要进行线交叉的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T10:45:48.273

您可以将一个空的 GameObject 作为汽车的父对象，并将其稍微放在它的前面（在 IDE 中或在启动时）。这样您就可以安全地获得绘制一条线所需的两个点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-22T07:02:28.247

如果你知道`t`这辆车和另一辆车需要行驶的距离`u`，那么交叉点就很简单了。

```
Vector3 intersection = thisCar.position + (t * thisCar.forward);
Vector3 intersection = threateningCar.position + (u * threateningCar.forward); 
```

但是您可以求解`t`并`u`使用一些代数和 2D 矢量叉积，`[x_1,z_1] × [x_2,z_1] = (x_2 z_1 - z_2 x_1)`它是`y`3D 叉积的标量值。

```
t = Vector3.Cross(threateningCar.forward, thisCar.position - threateningCar.position).y 
    / Vector3.Cross(thisCar.forward, threateningCar.forward).y;

u = Vector3.Cross(thisCar.forward, thisCar.position - threateningCar.position).y 
    / Vector3.Cross(thisCar.forward, threateningCar.forward).y; 
```

# cocoa - 如何创建自定义对象库项目？

> ID：15648608
> 
> 赞同：0
> 
> 时间：2013-03-26T22:28:09.627
> 
> 标签：cocoa, interface-builder, custom-component, iboutlet, nssplitview

我编写了一个自定义视图类，它有两个子视图，与 NSSplitView 非常相似。我希望我的新类在界面生成器中使用时显示两个子视图。这两个子视图可以是任何NSView，但需要开发者指定。

如何将我的类添加到对象库？

如何向 IB 指定我的类有两个必需的子视图（IBoutlets）？

在此先感谢，乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:30:56.783

除了制作子视图属性 IBOutlets 之外，无法自定义 Interface Builder 在 Xcode 4 中呈现自定义类的方式。它曾经可以在 Xcode 4 之前的（独立）Interface Builder 中实现，但该功能已被删除。

# c# - 检查 TreeView 滚动条的可见性

> ID：15648616
> 
> 赞同：5
> 
> 时间：2013-03-26T22:28:39.353
> 
> 标签：c#, winforms, treeview, scrollbar

如何检查 TreeView 中的垂直滚动条是否可见？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T22:49:44.120

你必须做一些 p/invoke 来获得 TreeView 的样式。

```
 private const int GWL_STYLE = -16;
    private const int WS_VSCROLL = 0x00200000;
    [DllImport("user32.dll", ExactSpelling = false, CharSet = CharSet.Auto)]
    private static extern int GetWindowLong(IntPtr hWnd, int nIndex);

    bool VScrollVisible()
    {
        int style = GetWindowLong(myTreeView.Handle, GWL_STYLE);
        return  ((style & WS_VSCROLL) != 0);
    } 
```

# windows-7 - 网络使用在批处理文件中工作，在脚本中失败

> ID：15648625
> 
> 赞同：1
> 
> 时间：2013-03-26T22:29:19.050
> 
> 标签：windows-7, scripting, batch-file

我们是一个小型办公室，在桌面上有一台 Linux 设备服务器 (SAMBA) 和 Win7HP。我们有一台机器充当“备份服务器”并每晚备份服务器。

将本应是快速而肮脏的添加到备份脚本中，循环如下：

```
a. net use * /d /y
b. net use u: \\ourserver\userNN /u:userNN password
c. run sync util to sync u: to this user's storage space on backup server
d. repeat 
```

如果我在批处理文件中手动创建上述内容，一切正常。（但是，由于许多原因，该过程必须自动化并绑定到我们现有的备份脚本中。）

如果脚本创建并运行相同的批处理文件，则第一个用户会登录并同步，但所有后续`net use`尝试都会失败。

同样，如果脚本尝试通过代码映射驱动器，则会收到以下消息：

`Unrecognised network error #183`

上述错误表明网络驱动器/路径不可用——但使用相同参数在命令行键入的 net use 命令是成功的。

“备份服务器”是一个禁用了 UAC 的 Win7HP 机器。启动 cmd 提示符时，所有窗口前面都带有以下单词：`Administrator:`-- 但是，当脚本启动命令窗口以使用驱动器时，cmd 标题栏缺少该前缀。

有什么想法/想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-18T04:29:52.990

为了让用户正确执行此代码，他们需要拥有正确的凭据才能执行此操作。同样要自动执行此任务，只需使用任务计划程序，它应该可以正常工作。

# matlab - 如何复制矩阵的所有内列并在Matlab中对列求和

> ID：15648626
> 
> 赞同：1
> 
> 时间：2013-03-26T22:29:21.663
> 
> 标签：matlab, matrix, matrix-multiplication

假设我有一个矩阵`A`

```
 1     2     3     4     5
 1     2     3     4     5
 1     2     3     4     5
 1     2     3     4     5
 1     2     3     4     5 
```

如何复制*内部*列`A`以获得新矩阵`B`

```
 1     2     2     3     3     4     4     5
 1     2     2     3     3     4     4     5
 1     2     2     3     3     4     4     5
 1     2     2     3     3     4     4     5
 1     2     2     3     3     4     4     5 
```

请注意，第一列和最后一列`A`是单独留下的。然后我需要将成对的行加在一起以获得另一个矩阵`C`：

```
 3     5     7     9
 3     5     7     9
 3     5     7     9
 3     5     7     9
 3     5     7     9 
```

1.  我的矩阵的大小`5x5`并不总是那么好，元素也不总是那么好，但矩阵总是方形的。

2.  我*不需要*生成或输出矩阵`B`。这只是我最初想到获得最终矩阵的方式`C`。

3.  我的目标是相当高效，所以我想在**没有**for 循环的情况下完成此任务。

如何为任意矩阵大小完成此操作 `nxn`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:44:09.720

很简单 。.

```
C = A(:,2:end) + A(:,1:end-1) 
```

# php - 仅呈现来自 Drupal 7 自定义字段的 URL

> ID：15648628
> 
> 赞同：1
> 
> 时间：2013-03-26T22:29:24.207
> 
> 标签：php, drupal, drupal-7

我很难为`node--My_Content_Type_Node.tpl.php`. 我一直试图走[这里](https://stackoverflow.com/questions/8727234/extract-url-from-link-field-in-drupal)概述的路线，但一直很艰难。以下是我的具体情况：

我的自定义字段是对论坛的分类术语引用，机器名称为`taxonomy_forums`

我一直在尝试使用以下（以及细微的变化），但没有成功：

```
$url = render($node->taxonomy_forums[$node->language][0]['url']); 
```

本质上，我正在尝试将内容与特定的预先创建的论坛联系起来以供评论，并创建指向它的链接。

我可以使用以下内容显示默认布局（链接、标题、标记），但没有运气将其分开：

```
$Forum = render($content['taxonomy_forums']); 
```

非常感谢任何帮助，这是我在这里的第一篇文章，所以如果需要更多详细信息，请告诉我。

谢谢！

更新：为 var 转储恢复以下内容：

`array(1) { ["und"]=> array(1) { [0]=> array(2) { ["tid"]=> string(1) "5" ["taxonomy_term"]=> object(stdClass)#81 (8) { ["tid"]=> string(1) "5" ["vid"]=> string(1) "2" ["name"]=> string(13) "Total Rewards" ["description"]=> string(167) "Use this space to ask questions, make comments, or start a conversation with Grameen Foundation and other site users related to assessing your total rewards practices." ["format"]=> NULL ["weight"]=> string(1) "4" ["vocabulary_machine_name"]=> string(6) "forums" ["rdf_mapping"]=> array(5) { ["rdftype"]=> array(2) { [0]=> string(14) "sioc:Container" [1]=> string(10) "sioc:Forum" } ["name"]=> array(1) { ["predicates"]=> array(2) { [0]=> string(10) "rdfs:label" [1]=> string(14) "skos:prefLabel" } } ["description"]=> array(1) { ["predicates"]=> array(1) { [0]=> string(15) "skos:definition" } } ["vid"]=> array(2) { ["predicates"]=> array(1) { [0]=> string(13) "skos:inScheme" } ["type"]=> string(3) "rel" } ["parent"]=> array(2) { ["predicates"]=> array(1) { [0]=> string(12) "skos:broader" } ["type"]=> string(3) "rel" } } } } } }`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T06:33:02.507

要仅呈现 url，您可以检查此函数[url()](http://api.drupal.org/api/drupal/includes!common.inc/function/url/7)。您可以指定是否需要绝对或相对 url。因此，如果您需要绝对 url，那么代码可以如下所示：

```
$url = url($node->taxonomy_forums[$node->language][0]['url'], array('absolute' => TRUE)); 
```

而且您需要确保这`$node->taxonomy_forums[$node->language][0]['url']`是正确的数组结构。您可以通过 devel 功能检查它`dsm($node->taxonomy_forums)`。只要确保安装了开发模块。

# batch-file - Dos 命令及其输出

> ID：15648634
> 
> 赞同：0
> 
> 时间：2013-03-26T22:29:41.267
> 
> 标签：batch-file

全部，

请指导我，如何在dos窗口中打印以下命令的o/p？作为 dos 命令的新手，我不知道下面的字符串是什么意思？

设置 ts = %date:~4,2%%date:~7,2%-%time:~0,2%%time:~3,2%

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:41:51.673

欢迎使用 cmd 提示符。

`echo`是将值显示到屏幕的命令（例如`echo %date%`：）

`set ts`正在设置一个变量 ( `ts`)，以后可以像这样调用它：`%ts%`

`%date%`是一个将返回系统日期的变量。 `%date:~4,2%`将给出月份（数字）并`%date:~7,2%`给出月份中的日期（数字）。

`%time%`也是一个变量，但这会返回时间（24 小时）。 `%time:~0,2%`给出小时数（24 小时制，所以 1pm=13）。 `%time:~3,2%`给出了分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:32:22.813

那就是设置一个名为`ts`. 要显示该值，请在其后添加以下行：

```
echo %ts% 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:41:07.867

这是使用一些子字符串操作设置变量。

这`%date:~4,2%`意味着：

*   从机器获取日期；
*   删除它的前 4 个字符；
*   从结果中，获取前 2 个字符；

其余的是重复此过程并将结果连接到日期和时间格式的字符串中。

# javascript - 如果文本框中的值大于 1，则更改为复数

> ID：15648635
> 
> 赞同：4
> 
> 时间：2013-03-26T22:29:46.980
> 
> 标签：javascript, jquery, html, forms

我有一个文本框和一个这样的选择框：

```
<h3>Recipe Yield</h3>
<input style='width:100px' type="text" name="yield" class="small" />
<select name='yieldType'>
    <option value='Servings'>Serving(s)</option>
    <option value='Cups'>Cup(s)</option>
    <option value='Loaves (Loaf)'>Loaves (Loaf)</option>
</select> 
```

这是一个 JSFiddle：http: [//jsfiddle.net/T3Sxb/](http://jsfiddle.net/T3Sxb/)

如您所见，选择选项的形式为`word(s)`

但我想要一个脚本

*   如果输入框中的数字为 1，则选项中的值的形式为`word`
*   如果输入框中的数字大于 1，则选项中的值为复数。

这可能吗？我怎样才能做到这一点？感谢大家的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:47:15.843

*   演示：http: [//jsfiddle.net/T3Sxb/8/](http://jsfiddle.net/T3Sxb/8/)
*   交替使用`input[type="number"]`：http: [//jsfiddle.net/T3Sxb/15/](http://jsfiddle.net/T3Sxb/15/)
*   多个输入，样式：http: [//jsfiddle.net/T3Sxb/17/](http://jsfiddle.net/T3Sxb/17/)

我正在使用数据属性，以便您可以为每个项目声明正确的单数/复数形式。在许多情况下，简单地添加“s”是行不通的。

另请注意，零项通常（总是？）采用复数形式。

**HTML**

```
<input style='width:100px' type="text" id="yield" class="small" />
<select id='yieldType'>
    <option value='Servings' data-single="Serving" data-other="Servings"></option>
    <option value='Cups' data-single="Cup" data-other="Cups"></option>
    <option value='Loaves (Loaf)' data-single="Loaf" data-other="Loaves"></option>
</select> 
```

**JavaScript**

```
var yield = $("#yield");
var yieldType = $("#yieldType");

function evaluate(){
    var single = parseInt(yield.val(), 10) === 1;
    $("option", yieldType ).each(function(){
        var option = $(this);
        if(single){
            option.text(option.attr("data-single"));
        }else{
            option.text(option.attr("data-other"));
        }
    });
}

// whatever events you want to trigger the change should go here
yield.on("keyup", evaluate);

// evaluate onload
evaluate(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T22:48:07.183

你可以试试这个：http: [//jsfiddle.net/T3Sxb/7/](http://jsfiddle.net/T3Sxb/7/)

```
var plural = {
    Serving: "Servings",
    Cup: "Cups",
    Loaf: "Loaves"
};

var singular = {
    Servings: "Serving",
    Cups: "Cup",
    Loaves: "Loaf"
};

$( "#pluralizer" ).on( "keyup keydown change", function() {
    var obj = parseInt( $( this ).val() ) === 1 ? singular : plural;
    $( "#YieldType option" ).each( function() {
        var html = $( this ).html();
        if ( html in obj ) {
            $( this ).html( obj[html] );
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T22:50:05.873

从用户体验的角度来看，我认为`(s)`是完全可以接受的。但无论如何，这个怎么样：

```
<option value='Servings' data-singular="Serving" data-plural="Servings">Servings</option> 
```

然后：

```
// you should really use IDs ;)
$('input[name="yield"]').on('change', function () {
    var singular = parseInt($(this).val(), 10) === 1;
    $('select[name="yieldType"]').each(function () {
        if (singular) {
            $(this).val($(this.attr('data-singular')));
        } else {
            $(this).val($(this.attr('data-plural')));
        }
    });
}); 
```

# java - 如何在 SQLite 数据库的 onCreate 函数中使用 getWritableDatabase()？

> ID：15648640
> 
> 赞同：1
> 
> 时间：2013-03-26T22:30:14.450
> 
> 标签：java, android, sqlite, recursion

我正在编写一个安卓应用程序。为此，我需要使用 txt 文件中的数据填充 SQLite 数据库。所以在数据库的 onCreate 函数中，我正在创建数据库，然后用数据填充它。这是 onCreate 的声明的样子：

```
public void onCreate(SQLiteDatabase db) { 
```

但是当我在 onCreate 中使用这条线时，：

```
db = this.getWritableDatabase(); 
```

我在运行时在 Logcat 中收到此错误：“java.lang.IllegalStateException: getDatabase called recursively(812)”。所以现在我无法从 onCreate 内部填充数据库，并且被卡住了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:38:05.527

第一次调用 getReadableDatabase 或 getWriteableDatabase 时会调用 onCreate()。肯定发生的是 onCreate 被递归调用，因为尚未创建数据库并且您的

```
db = this.getWritableDatabase(); 
```

调用触发创建内部的创建。

如果需要预填充 db，只需使用 db 参数`onCreate`作为可写数据库。

```
@Override
public void onCreate(SQLiteDatabase db) {        
    db.execSQL(YOUR_STATEMENT);
    .
    .
} 
```

如果您需要执行大量数据库操作，请使用

```
db.beginTransaction();
.
.
db.setTransactionSuccessful();
} catch (SQLException e) {
} finally {
       db.endTransaction();
} 
```

一般比较快。

# jquery - jQuery 选择 div 之间的所有内容，除了一些表 div

> ID：15648641
> 
> 赞同：0
> 
> 时间：2013-03-26T22:30:15.643
> 
> 标签：jquery

我想`Divs`为我的页面获取两个之间的 html，除了一个包含隐藏值的表`jqplot`和一个大`Div`的 this `jqplot`。看来我应该使用 jQuery`:not()`选择器来排除这两个元素。但是，我的代码失败了。那么有人可以给我一些建议吗？这是一个[演示](http://jsfiddle.net/godhong/FdZHt/)，下面是我的代码的基本思想。我唯一需要的是内容，直到第一次`table`谢谢！

HTML

```
<div class="articles">
    <h2 class="model_header">Exponential Model Output</h2>

    <table align="center">
        <!--end 04uberoutput_start-->
    </table>

    <table width="550" border="1">  
    </table>  
####I need nothing below#####
    <p>&nbsp;</p>

    <table width="400" border="0" style="display: none">
    </table>

    <div id="chart1" style="margin-top: 20px; margin-left: 20px; width: 650px; height: 400px; position: relative;" class="jqplot-target">
    </div>

</div> 
```

JS：

```
 var jq_html = $("div.articles:not(table&div)").html(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:37:03.460

```
var jq_html = $("div.articles").children(':lt(3)'); 
```

也许只是针对所有从零开始的索引低于 3 的孩子，以获得：

*   [0] H2
*   [1] 第一张表
*   [2] 第二张表

**编辑：**

有点晚了，没注意到评论！

```
var jq_html = $('<div />').append($("div.articles").children(':lt(3)').clone()).html(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:43:57.013

首先，您需要一个`outerHtml()`函数（请参阅[获取选定元素的外部 HTML](https://stackoverflow.com/questions/2419749/get-selected-elements-outer-html)）。出于演示目的，我使用内置的：

```
var jq = $("div.articles").children(':not(div#chart1,table:hidden)');
var jq_html = "";
jq.each(function() {
  jq_html += $(this)[0].outerHTML + "\n";
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T23:13:58.217

来自 jquery.api：

在 HTML 文档中，.html() 可用于获取任何元素的内容。如果选择器表达式匹配多个元素，则只有第一个匹配项才会返回其 HTML 内容。

[http://api.jquery.com/html/](http://api.jquery.com/html/)

所以你只能使用 .html() 来检索第一个匹配的元素。我看看我能不能想到点什么。

# autofac - Autofac 相当于“BuildUp”

> ID：15648643
> 
> 赞同：1
> 
> 时间：2013-03-26T22:30:20.210
> 
> 标签：autofac

Structuremap 定义了一个“BuildUp”方法，该方法采用已构建的对象并执行 setter 注入以将配置的依赖项推送到该对象中。

Autofac 有等效的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T21:41:08.347

问题是指已构建的对象（未在容器中注册的对象），因此正确答案是 InjectProperties 或 InjectUnsetProperties。

以下测试演示了该行为

```
 public class TestPropertyInjection
    {
        public object ShouldBeInjectedByAutofac { get; set; }
    }

    [Fact]
    public void Autofac_can_inject_properties()
    {
        var builder = new ContainerBuilder();
        builder.RegisterType(typeof(object));
        var container = builder.Build();

        var existingObjectNotRegisteredInContainer = new TestPropertyInjection();

        container.InjectProperties(existingObjectNotRegisteredInContainer);

        // can also use InjectUnsetProperties to only set unset properties
        //container.InjectUnsetProperties(existingObjectNotRegisteredInContainer);

       Assert.NotNull(existingObjectNotRegisteredInContainer.ShouldBeInjectedByAutofac);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T03:56:35.517

尝试[InjectUnsetProperties](http://api.autofac.org/html/3192DBAE.htm)。样本：

```
public class YourModule : Module
{
        protected override void Load(ContainerBuilder builder)
        {
            base.Load(builder);

            builder.RegisterType<YourClass>().OnActivated(e => e.Context.InjectUnsetProperties(e.Instance));
        }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-10T15:48:45.727

在 Autofac 的更新版本中，您可以简单地使用：

`builder.RegisterType<YourClass>().PropertiesAutowired();`

# javascript - 谷歌日历 API 请求没有通过 Node.js (Express) + 请求库

> ID：15648644
> 
> 赞同：0
> 
> 时间：2013-03-26T22:30:27.250
> 
> 标签：javascript, node.js, express, google-api, google-calendar-api

我正在编写一个使用 Google Calendar API 的服务器。我已经发出了一个成功的请求，但是这个[应该创建一个新日历](https://developers.google.com/google-apps/calendar/v3/reference/calendars/insert)`POST`的请求在 HTTP 响应正文中返回以下错误：

```
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "required",
    "message": "Required"
   }
  ],
  "code": 400,
  "message": "Required"
 }
} 
```

我正在使用 Node.js、Express 和一个名为[Request](https://github.com/mikeal/request)（由 Mikeal 编写）的 Node 的 HTTP 库包装器来向 Google 的 API 发出请求。我只问这个问题是因为错误信息非常神秘。如果有人可以帮助解决这个问题，那就太好了！

下面包含一些代码示例以帮助了解更多信息：

**setupTasksCalendar 方法（发出创建新日历的请求）：**

```
var setupTasksCalendar = function(req, callback) {
    Oauth.makeApiCall({
      method: 'POST',
      url: 'https://www.googleapis.com/calendar/v3/calendars',
      body: JSON.stringify({
        summary: "Google Calendar Tasks"
      })
    }, req, function(e, body) {
      if (e) console.log(e);
      console.log(body);
      callback();
    });
  }; 
```

**makeApiCall 方法（进行所需检查并将身份验证令牌添加到 URL 的包装器方法）：**

```
this.makeApiCall = function(parameters, req, callback) {
    if (Date.now() >= req.session.user.token_expiration_time) {
      self.Auth.updateAccessToken(req, function() {
        parameters.url = self.addAccessToken(parameters.url, req);
        request(parameters, function(e, r, body) {
          if (e) console.log(e);
          callback(e, body);
        });
      });
    } else {
      parameters.url = self.addAccessToken(parameters.url, req);
      request(parameters, function(e, r, body) {
        if (e) console.log(e);
        callback(e, body);
      });
    }
  }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:39:22.043

我想到了！事实证明，仅将 JSON 放入正文是不够的：我需要确保请求`application/json`具有`content-type`. 要在 Request 中执行此操作，您必须...

替换这个：

```
body: JSON.stringify({
    summary: "Google Calendar Tasks"
    }) 
```

有了这个：

```
json: {
    summary: "Google Calendar Tasks"
    } 
```

# ruby-on-rails - form_for 方法中的参数数量错误（3 对 2）

> ID：15648645
> 
> 赞同：1
> 
> 时间：2013-03-26T22:30:32.620
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已升级到 rails 3.2.13，并且正在迁移旧应用程序以在新环境（ruby1.9.3）中运行。该应用程序在 ruby​​192 和 rails 3.0.0 上运行良好。

我在尝试创建新记录时收到此错误（消防员）

参数数量错误（3 对 2）

这是我的表单代码

```
<%= form_for :fire_fighter, @fire_fighter, :url => { :action => "create" } do |f| %> 
```

根据阅读其他帖子，他们建议删除“fire_fighter”，但看起来像这样

```
<%= form_for :@fire_fighter, :url => { :action => "create" } do |f| %> 
```

这实际上允许页面呈现，但是当我尝试输入填写文本字段并在数据库中提交或创建记录时，我收到一条内置在应用程序中的错误消息，上面写着：![那些字段都是空白的](../Images/09ca953df6b4b75103e05f6f418be0e4.png)

所有字段都设置为字符串。

哦，很明显，在我点击提交之前，我已经填写了所有这些字段。所以现在我被困住了。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:47:26.360

尽管当您发布页面源代码和表单代码的其余部分时，此答案可能会发生变化，但您正在尝试从实例变量创建符号。

```
<%= form_for :@fire_fighter, :url => { :action => "create" } do |f| %> 
```

注意`:@fire_fighter`。它真的应该是`@fire_fighter`。正确的代码应该是

```
<%= form_for @fire_fighter, :url => { :action => "create" } do |f| %> 
```

您使用实例变量的原因`@fire_fighter`是因为在您的控制器中应该有类似的东西

```
def new
  @fire_fighter = FireFighter.new
end 
```

这样，表单直接将实例变量从控制器抓取到表单上。符号不会从控制器到视图，但实例变量会，因此在方法`@fire_fighter`中将 用作第一个参数`form_for`。

# macos - 如何修改 libstdc++ 端口文件来编译胖静态库？

> ID：15648656
> 
> 赞同：0
> 
> 时间：2013-03-26T22:31:22.920
> 
> 标签：macos, gcc, macports, libstdc++, lipo

我正在使用 MacPorts 设置 GCC 4.7.2 的通用版本。它的依赖项之一是一个名为 的子端口`libstdcxx`，它构建然后删除它。

我已经编辑了端口文件中的`libstdcxx`条目，`gcc47`以防止`libstdc++.a`在重建后删除静态库。

但是，静态库是一个 64 位 ( `x86_64`) 文件：

```
$ sudo port -n upgrade --force libstdcxx +universal
--->  Computing dependencies for libstdcxx
...
$ lipo -info /opt/local/lib/libstdc++.a
input file /opt/local/lib/libstdc++.a is not a fat file
Non-fat file: /opt/local/lib/libstdc++.a is architecture: x86_64 
```

我还想为该`i386`架构添加对该文件的支持。

我应该遵循哪些额外的步骤来构建一个胖的静态`libstdc++`库？或者这对 MacPorts 来说是不可能的吗？重新分发和编译整个 GCC 4.7.2 两次（以获得两者`i386`和`x86_64`体系结构支持）以及我的应用程序的源代码的唯一其他选择是链接到这个静态库吗？

**添加 - 2013 年 3 月 27 日**

Brett Hale 的建议似乎没有奏效。构建过程失败。这是错误日志的片段：

```
:notice:configure --->  Configuring libstdcxx
:debug:configure Using compiler 'Mac OS X clang'
:debug:configure Executing proc-pre-org.macports.configure-configure-0
:debug:configure Executing org.macports.configure (libstdcxx)
:debug:configure Environment: CPATH='/opt/local/include' CXXFLAGS='-pipe -O2' CPPFLAGS='-I/opt/local/include' CFLAGS='-pipe -O2' AS_FOR_TARGET='/opt/local/bin/as' LIBRARY_PATH='/opt/local/lib' MACOSX_DEPLOYMENT_TARGET='10.8' CXX='g++ -arch x86_64 i386' CPP='gcc -arch x86_64 i386 -E\
' CC_PRINT_OPTIONS_FILE='/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/work/.CC_PRINT_OPTIONS' F90FLAGS='-pipe -O2' LD_FOR_TARGET='/opt/local/bin/ld' RANLIB_FOR_TARGET='/opt/local/bin/ranlib' LDFLAGS='-L\
/opt/local/lib' OBJDUMP_FOR_TARGET='/opt/local/bin/objdump' OTOOL='/opt/local/bin/otool' FCFLAGS='-pipe -O2' OBJC='/usr/bin/clang' INSTALL='/usr/bin/install -c' AR_FOR_TARGET='/opt/local/bin/ar' NM_FOR_TARGET='/opt/local/bin/nm' FFLAGS='-pipe -O2' OBJCFLAGS='-pipe -O2' CC_PRINT_OPT\
IONS='YES' STRIP_FOR_TARGET='/opt/local/bin/strip' CC='gcc -arch x86_64 i386' OTOOL64='/opt/local/bin/otool'
:debug:configure Assembled command: 'cd "/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/work/build" && ../gcc-4.7.2/configure --prefix=/opt/local --build=x86_64-apple-darwin12 --includedir=/opt/local/incl\
ude/gcc47 --infodir=/opt/local/share/info --mandir=/opt/local/share/man --datarootdir=/opt/local/share/gcc-4.7 --with-libiconv-prefix=/opt/local --with-local-prefix=/opt/local --with-system-zlib --disable-nls --program-suffix=-mp-4.7 --with-gxx-include-dir=/opt/local/include/gcc47/\
c++/ --with-gmp=/opt/local --with-mpfr=/opt/local --with-mpc=/opt/local --with-ppl=/opt/local --with-cloog=/opt/local --enable-cloog-backend=isl --disable-cloog-version-check --enable-stage1-checking --enable-lto --enable-libstdcxx-time --with-as=/opt/local/bin/as --with-ld=/opt/lo\
cal/bin/ld --with-ar=/opt/local/bin/ar --with-bugurl=https://trac.macports.org/newticket --disable-ppl-version-check --enable-languages=c++ --disable-bootstrap --with-pkgversion="MacPorts gcc47 4.7.2_2+universal"'
:debug:configure Executing command line:  cd "/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/work/build" && ../gcc-4.7.2/configure --prefix=/opt/local --build=x86_64-apple-darwin12 --includedir=/opt/local\
/include/gcc47 --infodir=/opt/local/share/info --mandir=/opt/local/share/man --datarootdir=/opt/local/share/gcc-4.7 --with-libiconv-prefix=/opt/local --with-local-prefix=/opt/local --with-system-zlib --disable-nls --program-suffix=-mp-4.7 --with-gxx-include-dir=/opt/local/include/g\
cc47/c++/ --with-gmp=/opt/local --with-mpfr=/opt/local --with-mpc=/opt/local --with-ppl=/opt/local --with-cloog=/opt/local --enable-cloog-backend=isl --disable-cloog-version-check --enable-stage1-checking --enable-lto --enable-libstdcxx-time --with-as=/opt/local/bin/as --with-ld=/o\
pt/local/bin/ld --with-ar=/opt/local/bin/ar --with-bugurl=https://trac.macports.org/newticket --disable-ppl-version-check --enable-languages=c++ --disable-bootstrap --with-pkgversion="MacPorts gcc47 4.7.2_2+universal"
:info:configure checking build system type... x86_64-apple-darwin12
:info:configure checking host system type... x86_64-apple-darwin12
:info:configure checking target system type... x86_64-apple-darwin12
:info:configure checking for a BSD-compatible install... /usr/bin/install -c
:info:configure checking whether ln works... yes
:info:configure checking whether ln -s works... yes
:info:configure checking for a sed that does not truncate output... /usr/bin/sed
:info:configure checking for gawk... no
:info:configure checking for mawk... no
:info:configure checking for nawk... no
:info:configure checking for awk... awk
:info:configure checking for libitm support... yes
:info:configure checking for gcc... gcc -arch x86_64 i386
:info:configure checking for C compiler default output file name...
:info:configure configure: error: in `/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/work/build':
:info:configure configure: error: C compiler cannot create executables
:info:configure See `config.log' for more details.
:info:configure Command failed:  cd "/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/work/build" && ../gcc-4.7.2/configure --prefix=/opt/local --build=x86_64-apple-darwin12 --includedir=/opt/local/include/\
gcc47 --infodir=/opt/local/share/info --mandir=/opt/local/share/man --datarootdir=/opt/local/share/gcc-4.7 --with-libiconv-prefix=/opt/local --with-local-prefix=/opt/local --with-system-zlib --disable-nls --program-suffix=-mp-4.7 --with-gxx-include-dir=/opt/local/include/gcc47/c++/\
 --with-gmp=/opt/local --with-mpfr=/opt/local --with-mpc=/opt/local --with-ppl=/opt/local --with-cloog=/opt/local --enable-cloog-backend=isl --disable-cloog-version-check --enable-stage1-checking --enable-lto --enable-libstdcxx-time --with-as=/opt/local/bin/as --with-ld=/opt/local/\
bin/ld --with-ar=/opt/local/bin/ar --with-bugurl=https://trac.macports.org/newticket --disable-ppl-version-check --enable-languages=c++ --disable-bootstrap --with-pkgversion="MacPorts gcc47 4.7.2_2+universal"
:info:configure Exit code: 77
:error:configure org.macports.configure for port libstdcxx returned: configure failure: command execution failed
:debug:configure Error code: NONE
:debug:configure Backtrace: configure failure: command execution failed
    while executing
"$procedure $targetname"
:info:configure Warning: targets not executed for libstdcxx: org.macports.activate org.macports.configure org.macports.build org.macports.destroot org.macports.install
:notice:configure Please see the log file for port libstdcxx for details:
    /opt/local/var/macports/logs/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_lang_gcc47/libstdcxx/main.log 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T11:41:43.590

如果您使用 gcc 编译器构建 gcc，您可以尝试使用以下`-arch`选项生成通用对象/库：

```
sudo port -n upgrade --force libstdcxx +universal \
configure.cc="gcc -arch x86_64 i386" configure.cxx="g++ -arch x86_64 i386" 
```

# angularjs - 使用 Angular Js 保存复选框状态...对于另一个页面的后退按钮

> ID：15648663
> 
> 赞同：1
> 
> 时间：2013-03-26T22:32:00.893
> 
> 标签：angularjs

使用 AngularJs 保存复选框状态...用于另一个页面的后退按钮。

我有一个像这样通过 AngularJS 生成的复杂搜索页面

```
<input type="checkbox" class="checkall" id="all_types"><strong><?=lang('select_all')?></strong>  
<div class="span12" ng-controller="typesCtrl"> 
<label class="checkbox inline" data-ng-repeat="record in records">
  <input type="checkbox" class="small_checkbox" value="{{ record.type_id }}" name="auto_type[]"> {{ record.en_type_name }} ({{ record.type_count }}) 
```

搜索选择完成后，我检查选择的内容并将其发送到搜索 url

```
/search?auto_type=1,4,5,7 
```

问题是当我单击后退按钮时...复选框和选择的状态未保存。在这种情况下保存复选框状态的最优雅的方法是什么。

# php - 以编程方式查找函数的位置

> ID：15648664
> 
> 赞同：1
> 
> 时间：2013-03-26T22:32:06.203
> 
> 标签：php, function

我正在对另一个人建立的网站进行修改，该网站实际上使用了 1000 个文件，这些文件在任何时候都被调用（我认为这是他实施 DRY 的尝试），我正在寻找一个特定的功能。现在通常，我会下载整个项目（通过 FTP），将其导入我最喜欢的 IDE（netbeans）并执行搜索，但是我受到限制，因为访问文件的唯一方法是通过一个过时的托管控制面板单独访问没有搜索功能或海量下载功能。

那么，为了让我的工作更轻松，有没有办法在运行时对函数执行查找详细信息，例如它的文件，以及它在哪一行？

运行该站点的服务器安装了 xdebug（我知道，对于生产服务器来说很奇怪，但我不会抱怨它是否有帮助）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:38:31.983

您可以使用[ReflectionFunction](http://www.php.net/manual/en/class.reflectionfunction.php)类。使用 PHP 反射类，您可以获得有关 PHP 函数和类的元信息。对于您的问题，您可以这样做：

```
$function = new ReflectionFunction('function_name');
// $function->getFileName() returns the filename where is defined.
// $function->getStartLine() returns in which line is defined. 
```

等等。在上面的链接中，您将获得所有可用方法的列表。

# qt - 如何在 Windows 7 上构建 Quazip 0.5.1？

> ID：15648669
> 
> 赞同：7
> 
> 时间：2013-03-26T22:32:19.410
> 
> 标签：qt, quazip

我正在尝试在安装了 Qt 5.0.1 32 位 LGPL 的 Windows 7（32 位）上构建 quazip 库（版本 0.5.1）。

当我在 Qt-Commandprompt 中运行时：

```
qmake
mingw32-make 
```

将目录设置为我提取 Quazip 的文件夹 (C:\Qt\quazip-0.5.1\quazip)，我得到以下错误日志：

```
C:\Qt\quazip-0.5.1\quazip>mingw32-make
mingw32-make -f Makefile.Release
mingw32-make[1]: Entering directory 'C:/Qt/quazip-0.5.1/quazip'
g++ -Wl,-s -shared -mthreads -Wl,--out-implib,release\libquazip.a -o release\qua
zip.dll object_script.quazip.Release  -LC:\Qt\Qt5\5.0.1\mingw47_32\lib -lQt5Core
./release\unzip.o:unzip.c:(.text+0x1008): undefined reference to `crc32'
./release\unzip.o:unzip.c:(.text+0x10aa): undefined reference to `inflate'
./release\unzip.o:unzip.c:(.text+0x10da): undefined reference to `crc32'
./release\unzip.o:unzip.c:(.text+0x1110): undefined reference to `crc32'
./release\unzip.o:unzip.c:(.text+0x1327): undefined reference to `inflateEnd'
./release\unzip.o:unzip.c:(.text+0x1727): undefined reference to `get_crc_table'
./release\unzip.o:unzip.c:(.text+0x186f): undefined reference to `inflateInit2_'
./release\zip.o:zip.c:(.text+0xac7): undefined reference to `crc32'
./release\zip.o:zip.c:(.text+0xb7c): undefined reference to `deflate'
./release\zip.o:zip.c:(.text+0xcdf): undefined reference to `deflate'
./release\zip.o:zip.c:(.text+0xef5): undefined reference to `deflateEnd'
./release\zip.o:zip.c:(.text+0x13a8): undefined reference to `get_crc_table'
./release\zip.o:zip.c:(.text+0x1af9): undefined reference to `deflateInit2_'
./release\quaadler32.o:quaadler32.cpp:(.text+0x2e): undefined reference to `adle
r32'
./release\quaadler32.o:quaadler32.cpp:(.text+0x61): undefined reference to `adle
r32'
./release\quaadler32.o:quaadler32.cpp:(.text+0xa1): undefined reference to `adle
r32'
./release\quaadler32.o:quaadler32.cpp:(.text+0xb1): undefined reference to `adle
r32'
c:/qt/qt5/tools/mingw/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64
-mingw32/bin/ld.exe: ./release\quaadler32.o: bad reloc address 0x0 in section `.
rdata$_ZTI13QuaChecksum32[__ZTI13QuaChecksum32]'
collect2.exe: error: ld returned 1 exit status
Makefile.Release:106: recipe for target 'release\quazip.dll' failed
mingw32-make[1]: *** [release\quazip.dll] Error 1
mingw32-make[1]: Leaving directory 'C:/Qt/quazip-0.5.1/quazip'
makefile:34: recipe for target 'release' failed
mingw32-make: *** [release] Error 2 
```

但是在我的 Zlib 文件夹 (C:\Qt\Qt5\5.0.1\Src\qtbase\src\3rdparty\zlib) 中安装了所有这些列出的文件。

.

当我试图解决这个问题时，我已经添加到 quazip.pro 和 quazip.pri 中：

```
INCLUDEPATH += $$[QT_INSTALL_PREFIX]/src/3rdparty/zlib 
```

[，这里](https://stackoverflow.com/questions/4449467/how-to-compile-and-use-quazip-on-windows-do-i-need-to-separately-install-zlib)是如何建议的。

到目前为止，我在 Google 上找到的所有其他解决方案都没有帮助。

我希望你们中的某个人可以帮助我。

问候， LVreg

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-22T11:35:05.760

问题是 QuaZIP 找不到 zlib 库。当你运行 qmake 时，你应该包括头文件的路径和库：

```
qmake "INCLUDEPATH+=C:/Qt/Qt5/5.0.1/Src/qtbase/src/3rdparty/zlib" "LIBS+=-LC:/Qt/Qt5/5.0.1/Src/qtbase/src/3rdparty/zlib -lz"
mingw32-make 
```

如果您想查看，我的博客中有完整的解释：[http ://www.antonioborondo.com/2014/10/22/zipping-and-unzipping-files-with-qt/](http://www.antonioborondo.com/2014/10/22/zipping-and-unzipping-files-with-qt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-09T10:28:24.177

这对我有用（在 Windows 7 上使用 MSVC13 32 位编译的 QuaZip 0.7）：

在命令行类型中：

```
SET INCLUDE=<PathToZib\include>;%INCLUDE%
SET LIB=<PathToZib\lib>;%LIB%
qmake PREFIX=<FolderWhereInstallWillPutFiles> LIBS+=<PathToZib\lib>/zdll.lib
nmake
nmake install 
```

<> 之间的所有内容都必须更改为您的适用路径

注意：在 LIBS+= 部分使用 / 而不是 \ 作为文件夹分隔符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-24T16:41:50.897

尝试在 Windows 上制作 quazip 的库 - 看这里：

[https://www.maefloresta.com/wiki/doku.php?id=quazip_windows](https://www.maefloresta.com/wiki/doku.php?id=quazip_windows)

但是 - 尝试以下命令 - 而不是“make”取“mingw32-make”。

# css - 带有标题侧边栏和内容的管理面板编解码器

> ID：15648671
> 
> 赞同：0
> 
> 时间：2013-03-26T22:32:35.483
> 
> 标签：css, css-float, codec, sidebar

大家好，我需要为新的 cms 编解码器管理面板。

**有3个主要的div。**

`header`这不是固定的。

`sidebar`这是在屏幕的右侧

`content`位于侧边栏的右侧

**这是描述问题的图片：**

[http://i.stack.imgur.com/gLKN7.png](http://i.stack.imgur.com/gLKN7.png)

我该怎么做？

我有点迷路了

好吧，我试图做这样的事情：

```
#main { height: 100%; } 
#header { width: 100%; height: 43px; position:absolute; z-index: 2; } 
#layer2 { position: absolute; z-index: 1; width: 100%; float: right; margin-top: 43px; } 
#content { margin-right: 224px; } 
#sidebar { float: right; width: 224px; min-height: 100%; margin-right: -100%; } 
```

和html：

```
<div id="main">
    <div id="header>HEADER</div>
    <div id="layer2">
        <div id="content">
            content
        </div>
        <div id="sidebar">
            sidebar
        </div>
     </div>
</div> 
```

# php - 如何在现有的排序函数中对 SQL 结果进行排序

> ID：15648674
> 
> 赞同：0
> 
> 时间：2013-03-26T22:32:43.797
> 
> 标签：php, mysql, mysqli

您好，我在 CMS 的一个模板中有这个排序功能。如果条件是第二个，我想添加：

```
if(is_array($array)) {
foreach($array as $row) {
    if($row[photos] == 1) { 
        if($isMobile) {
            include($basepath.'/templates/mobile.content_item_photo.php');
        }

        else

         {
            include($basepath.'/templates/template.content_item_photo.php');

        } 
```

我还想添加以下 MySQL 结果以显示

```
$result = mysql_query("SELECT niches.name, niches.record_num FROM niches ORDER BY name ASC"); 
```

在此模板中用于排序：

```
include($basepath.'/templates/template.channel_item_title.php'); 
```

任何想法如何将其集成到第一个代码函数中？

所以这里是主索引模板的代码：

```
 <?
session_start();
if(($_REQUEST[mode] == 'favorites' || $_REQUEST[mode] == 'my_uploads') && !$_SESSION[username]) {
    header("Location: /login.php");
}

include('admin/db.php');
include($basepath.'/includes/inc.seo.php');

$cacheName = $_SERVER[REQUEST_URI];

$cacheResult = getCache($cacheName);
$cacheTotalPages = getCache("total_pages$cacheName"); 

if($cacheResult && $cacheTotalPages) {
    $array = $cacheResult;
    $total_pages = $cacheTotalPages;
}
else {
    include($basepath.'/includes/inc.index_queries.php');
    while($row = mysql_fetch_assoc($result)) {
                $array[] = $row;
    }
    if($thispage != 'favorites' && $_GET[mode] != 'my_uploads') {
        setCache($cacheName,$array,$overall_cache_time);
        setCache("total_pages$cacheName",$total_pages,$overall_cache_time);
    }
}

$thisfile = 'index';
$webpage="index";

if($isMobile) {
    include($basepath.'/templates/mobile.overall_header.php');
}
else {
    include($basepath.'/templates/template.overall_header.php');
}

if(empty($_GET[mode]) && !$_GET[page]) { 

    include($basepath.'/templates/template.home.php');

}

if($webpage=="index" && empty($_GET[mode]) && !$_GET[page])

{}

else
{

if(is_array($array)) {
    foreach($array as $row) {
        if($row[photos] == 1) { 
            if($isMobile) {
                include($basepath.'/templates/mobile.content_item_photo.php');
            }

            else                            

             {
                include($basepath.'/templates/template.content_item_photo.php');

            }

        }
        else {
            if($isMobile) {
                include($basepath.'/templates/mobile.content_item.php');
            }
            else 

            {
                include($basepath.'/templates/template.content_item.php');
            }

        }
    }
}

else {
    echo "Sorry, no results were found.";
}
}

if($isMobile) {
    include($basepath.'/templates/mobile.overall_footer.php');
}
else {
    include($basepath.'/templates/template.overall_footer.php');
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:05:39.443

我想我没有得到你的问题，但我们必须从某个地方开始......

```
<?php
if(is_array($array)) {
foreach($array as $row) {
    if($row[photos] == 1) { 
        if($isMobile) {
            include($basepath.'/templates/mobile.content_item_photo.php');
        }

        else

         {

            include($basepath.'/templates/template.content_item_photo.php');

        } 
```

下一个代码块：

```
<?php
$result = mysql_query("SELECT niches.name, niches.record_num FROM niches ORDER BY name ASC");

if(is_array(result)) {
foreach($result as $row) {
    if($row[photos] == 1) { 
        if($isMobile) {
            include($basepath.'/templates/mobile.content_item_photo.php');
        }

        else

         {

            include($basepath.'/templates/template.channel_item_title.php');

        } 
```

# ruby-on-rails - 非休息动作的路由

> ID：15648676
> 
> 赞同：0
> 
> 时间：2013-03-26T22:32:51.700
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在控制器中为我的非 restfull 操作创建路由时遇到了一些问题，这是我的代码：

控制器：

```
class StoresController < ApplicationController

  def toggle_store
    @store=Store.find(params[:store])
    if @store.available==true
      @store.update_attribute(:available, false)
    else
      @store.update_attribute(:available, true)
    end
    redirect_to @store
  end

end 
```

路线：

```
 resources :groups do
    resources :stores do
      member do
        post :toggle_store
      end
    end
  end 
```

但是当我在链接中使用路径时，我得到了这个网址：[http ://example.com/groups/1/stores/toggle_store.2](http://example.com/groups/1/stores/toggle_store.2)

我需要这样的东西： [http ://example.com/groups/1/stores/2/toggle_store](http://example.com/groups/1/stores/2/toggle_store)

有任何想法吗？

谢谢

编辑：

耙路线：

```
toggle_store_group_store POST   /groups/:group_id/stores/:id/toggle_store(.:format) stores#toggle_store 
```

关联：

```
<%=link_to "toggle", toggle_store_group_stores_path(@group,store), :method => :post %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:00:36.483

好的，我这样修复它：

路线.rb：

```
 resources :groups do
    resources :stores do
      post :toggle_store      
    end
  end 
```

控制器：

```
 def toggle_store
    authorize! :toggle, :store
    @store=Store.find(params[:store_id])
    if @store.available==true
      @store.update_attribute(:available, false)
    else
      @store.update_attribute(:available, true)
    end
    redirect_to @group
  end 
```

关联：

```
<%=link_to "to", toggle_store_group_store_path(@group,store), :method => :post %> 
```

# android - 如何在 Android 上为大型设备设置一个按钮？

> ID：15648677
> 
> 赞同：1
> 
> 时间：2013-03-26T22:32:58.280
> 
> 标签：android, android-ui, resolution-independence

我知道您可以通过声明不同的`layout`文件夹（如`layout-large`或）来拥有不同的 UI 元素`layout-xlarge`。但是，我不想每次更改我的应用程序界面时都更新两个单独的文件。

有没有其他方法可以让按钮仅`visibility="gone"`在小屏幕上具有并且在大屏幕上具有正常可见性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:46:03.423

我将按钮分成 2 个 XML 文件 - 一个在`layout-large`that has`visibility="visible"`和一个在`layout`that has `visibility="gone"`，然后将按钮包含在我的 layout/home.xml 文件中。有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:02:10.530

您可以将其分成两个 XML 布局文件，但您必须同时维护这两个文件。您可以通过拥有一个布局文件将其抽象出来，然后为按钮提供一种为平板电脑定义的样式，而不是为平板电脑定义的样式。

我会将其设置为 GONE 并在代码中进行更改。这样你就没有两个布局文件。

但是，我不会使用 Blumer 的`getConfiguration().screenLayout`. 存储桶不再是处理不同屏幕尺寸的最佳方式。[Dianne Hackborn 在一篇文章中解释了原因](http://android-developers.blogspot.com/2011/07/new-tools-for-managing-screen-sizes.html)，但归结为：

> 根据迄今为止开发人员的经验，我们不相信这组有限的屏幕尺寸存储桶可以为开发人员提供他们所需的一切，以适应日益多样化的 Android 设备形状和尺寸。主要问题是桶之间的边界可能并不总是对应于消费者可用的设备或应用程序的特定需求。

相反，您应该使用它们的新数值——大致`sw600dp`适用于 7 英寸平板电脑和`sw720dp`10 英寸平板电脑：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mylayout);

    if (getResources().getBoolean(R.bool.sw600dp)) {
        ((Buton)findViewById(R.id.mybutton)).setVisibility(VISIBLE);
    }
} 
```

# regex - 在 grepWin 中查找带点的文本字符串或部分文本

> ID：15648679
> 
> 赞同：2
> 
> 时间：2013-03-26T22:33:07.033
> 
> 标签：regex, string, text, grep

我在 Windows 7 64 上使用 grepWin。[http://tools.tortoisesvn.net/grepWin.html](http://tools.tortoisesvn.net/grepWin.html)

我有一个包含文件及其重复副本的文件夹。

原始文件名为“FILENAME DOT FILETYPE”（不带空格），例如“cartonbox.shelf”。

这些文件的副本被命名为“FILENAME DOT 1 DOT FILETYPE”（不带空格），例如“cartonbox.1.shelf”。

我正在尝试查找包含确切字符串的所有文件：

“DOT 1 DOT FILETYPE”（不带空格），因此所有包含例如“.1.shelf”的文件。

请问如何在 grepWin 中做到这一点？

例如，如果我尝试“ `\.1\shelf`”或“ `\.1\.shelf`”，我不会得到任何结果。

请问我的错误是什么？一直在阅读[http://www.regular-expressions.info/](http://www.regular-expressions.info/)但无法提出正确的模式。

无论符号如何，我通常如何搜索文件名的确切部分？

基本上，如果我要查找的文件中包含例如“garden_1.1.4-JE50.tree”，我如何告诉 grepWin 找到包含下划线、点或其他字符的确切文本字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T22:49:33.810

grep 代表 g/re/p（全局/正则表达式/打印）

它搜索 IN 文件，而不是文件名。该文本需要在您正在搜索的文件中是文本可读的。

在您要搜索的目录中，您可以执行以下操作：

```
dir *.* /b/s > my_file.txt 
```

然后您可以在 my_file.txt 上使用 grepWin 执行正则表达式检查

在 Unix 和 Linux 中，您通常通过命令行传递命令：

```
ls -a | grep \.tree$ 
```

在 Windows 中，您将使用

```
dir * /b | findstr \.tree$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T23:25:42.863

我了解到 GripWin 用于搜索 IN 文件，我正在寻找文件的部分文件名，而不是在其中，而只是在它们的名称中。因此我现在正在阅读：[https ://superuser.com/questions/209231/what-search-utilities-can-search-by-file-name-in-windows-7](https://superuser.com/questions/209231/what-search-utilities-can-search-by-file-name-in-windows-7)

感谢您向我解释这个重要的误解，cpattersonv1。

# c++ - C++ - 通过模板仿函数专门化成员函数模板不编译

> ID：15648681
> 
> 赞同：1
> 
> 时间：2013-03-26T22:33:40.550
> 
> 标签：c++, templates, type-conversion, template-specialization

我希望创建一个可以多态地在浮点数组和双精度数组之间转换的类。也就是说，相关的实例（由`<double>`or参数化`<float>`）和通过`float*`or`double*`的决定是在运行时决定的，而不是静态的。

作为另一个问题的[建议答案](https://stackoverflow.com/a/15611245/143397)，但根据[此答案](https://stackoverflow.com/a/1757845/143397)进行了修改（因为我知道不可能在类中完全专门化成员函数模板），`BaseDest`提供简单的重载成员函数的纯虚拟基类被子类化以定义`DestImpl<T>`. 我使用这个基类来维护`DestImpl<T>`实例的动态集合，其中包含不同的`T`. 此类提供`assign()`成员函数的显式重载；一个用于 a `double *`，另一个用于 a `float *`。这个想法是，在运行时，`BaseDest::assign()`通过多态指针或引用调用，这反过来又`assign()`在`DestImpl<T>`.

现在，重要的是数组的非指针类型匹配 T in `DestImpl<T>`，`fast_copy()`调用一个函数（可能是一个 memcpy），并且当类型不匹配一个较慢的静态强制逐项复制时执行。因此，`assign()`成员函数将其卸载到模板*仿函数*。这个函子有两种特化——一种是函子的类型参数匹配的类型`DestImpl<T>`（因此调用快速复制），另一种是捕获所有其他情况（并调用慢速复制）的回退。

但是，我无法编译以下代码。注释显示了编译器错误和警告出现的位置——我怀疑它们是相关的。我不明白的是为什么第二个专业化`apply_helper`无法实例化为`apply_helper<double>`.

```
class BaseDest {
public:
  virtual ~BaseDest() {}

  virtual void assign(const double * v, size_t cnt) = 0;
  virtual void assign(const float * v, size_t cnt) = 0;
};

template <typename T>
class DestImpl : public BaseDest {
public:

  void assign(const double * v, size_t cnt) {
    assign_helper<T>()(v, cnt);
  }
  void assign(const float * v, size_t cnt) {
    assign_helper<T>()(v, cnt);  // ERROR: no matching function for call to object of type 'assign_helper<double>'

  }   
protected:

  template <typename U>
  struct assign_helper {
    void operator()(const U * v, size_t cnt) {
      for (size_t i = 0; i < cnt; ++i) {
        //slow_copy(v[i]);
      }
    }
  };

  template <typename U>
  struct assign_helper<T> {  // WARNING: Class template partial specialization contains a template parameter that can not be deduced; this partial specialization will never be used

    void operator()(const T * v, size_t cnt) {
      //fast_copy(v, cnt);
    }
  };
};

void test() {
  DestImpl<double> d;  // error mentioned above appears when this is present
} 
```

编辑：这似乎确实有效 - 将`assign_helper`结构（现在是一个类）移出`DestImpl<T>`类定义。我不确定这是不是正确的方法，但到目前为止它似乎确实有效：

```
// slow copy between different types
template <typename T, typename U>
class assign_helper {
public:
  void operator()(const U *v, size_t cnt) {
    // slow copy
  }
};

// fast copy between same types
template <typename T>
class assign_helper<T, T> {
public:
  void operator()(const T * v, size_t cnt) {
    // fast copy
  }
};

class BaseDest {
public:
  virtual ~BaseDest() {}

  virtual void assign(const double * v, size_t cnt) = 0;
  virtual void assign(const float * v, size_t cnt) = 0;
};

template <typename T>
class DestImpl : public BaseDest {
public:

  virtual void assign(const double * v, size_t cnt) {
    assign_helper<T, double>()(v, cnt);
  }
  virtual void assign(const float * v, size_t cnt) {
    assign_helper<T, float>()(v, cnt);
  }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T16:48:59.703

```
template <typename U>
  struct assign_helper<T> {  // WARNING: Class template partial specialization contains a template parameter that can not be deduced; this partial specialization will never be used 
```

以上是您错误的原因。警告明确告诉您永远不会使用此定义。你想要的`template < typename U >`不是`template <>`.

# java - 是否有必要使这个变量变得易变？

> ID：15648683
> 
> 赞同：3
> 
> 时间：2013-03-26T22:34:01.187
> 
> 标签：java, multithreading, volatile

我正在阅读[关于“现代 Java 并发”的“JAX London 2011”演示文稿](http://www.youtube.com/watch?v=qrCUy9H76IA)。在持续时间 43:20 - 43:40 之间，一位观众说`shutdown`下面代码中的变量应该被声明为`volatile`并且演示者同意它（并说它也被指出过，但他们只是没有得到修改演示文稿）。有问题的代码是：

```
public abstract class QueueReaderTask implements Runnable {

  private boolean shutdown = false;
  protected BlockingQueue<WorkUnit<String>> lbq;

  public void run() {
    while (!shutdown) {
      try {
        WorkUnit<String> wu = lbq.poll(10, TimeUnit.MILLISECONDS);
        if (wu != null) { doAction(wu.getWork()); }
      } catch (InterruptedException e) {
        shutdown = true;
      }
    }
  }

  public abstract void doAction(String msg);
  public void setQueue(BlockingQueue<WorkUnit<String>> q) { lbq = q; }
} 
```

我的问题：我认为不`shutdown`应该宣布`volatile`。我的理由是，`shutdown`作为 a 的成员`Runnable`，每个任务/线程都将拥有该变量的不同私有副本。那么，为什么要做呢`volatile`？

但由于这已在 JAX 2011 中讨论过，我假设该听众中有很多专业的 Java 开发人员。我不认为他们所有人都会错过这个！那么，我错过了什么？

PS：-我可以理解，如果变量（可能）由多个线程共享，则应声明该变量`volatile`，如双重检查锁定模式：

```
class Foo {
        private volatile Helper helper = null;
        public Helper getHelper() {
            if (helper == null) {
                synchronized(this) {
                    if (helper == null)
                        helper = new Helper();
                }
            }
            return helper;
        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:36:03.120

> 每个任务/线程都将具有该变量的不同私有副本。那么，为什么要让它“不稳定”呢？

*如果*`shutdown`仅在`QueueReaderTask`实例内修改布尔值，则您是正确的。在这种情况下`shutdown`，仅由一个线程修改，不需要`volatile`.

坦率地说，代码对我来说看起来很奇怪。为什么 catch `InterruptedException`，设置`shutdown`布尔值，然后循环并退出。为什么现在只做以下事情？为什么有`shutdown`国旗？

```
while (true) {
  try {
    WorkUnit<String> wu = lbq.poll(10, TimeUnit.MILLISECONDS);
    if (wu != null) { doAction(wu.getWork()); }
  } catch (InterruptedException e) {
     Thread.currentThread().interrupt();
     return;
  }
} 
```

也许帖子中删除了额外的代码？如果不是，我想知道这是否是从更大的代码部分复制和粘贴的，在方法调用中*也*`shutdown`设置为 true 。

 *> PS：-我可以理解，如果变量（可能）由多个线程共享，则应将其声明为“易失性”，如双重检查锁定模式：

正确的。一个典型的模式是`shutdown`从另一个告诉线程停止处理的线程修改的。在这种情况下，它需要是`volatile`.*

# css - 在引导程序中完全居中表单

> ID：15648694
> 
> 赞同：0
> 
> 时间：2013-03-26T22:35:01.107
> 
> 标签：css, forms, twitter-bootstrap, responsive-design

我正在使用 twitter bootstrap 为台式机和手机创建网站。我希望登录表单在 x 方向和 y 方向都居中。

因此，如果网格是 100 x 100，那么表格将是 50,50。

我可以使用 Firefox 将表单稍微放在屏幕的中心，`text-align: center;`但 Firefox 将它放在右边一点。

我该怎么做才能到达中心？

[这是我的 HTML](http://pastebin.com/KTT5T0KM)

[这是我的 bootstrap.css](http://pastebin.com/uuwzxAnD)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:57:19.393

那里有很多嵌套的 div 标签，尽管我知道这部分是 Bootstrap 的错！我要强调的一件事是利用你已经在 Bootstrap 中使用的那些，而不是添加新的来改变定位，因为这会带来很多麻烦。

玩了这个之后，我没有想出一个明确的解决方案，但这是我的想法：

*   阅读 CSS 媒体查询...这将使您的桌面 > 移动问题的解决方案变得更加容易！
*   不要使用 CSS 进行垂直对齐。Divs 不是表格单元格，不能真正像它们一样。嗅探屏幕宽度并进行定位数学的小型 JavaScript 更好。一个快速的谷歌搜索会带来很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:47:49.083

尝试`margin:auto;`在`<div>`包含表单的地方使用。

# xslt - 在 XSLT for MODS XML 到 FilemakerPro 的转换中，如何处理带有参数的 mod？

> ID：15648696
> 
> 赞同：0
> 
> 时间：2013-03-26T22:35:07.317
> 
> 标签：xslt, xpath, filemaker, xmlconvert

参考查询[XSLT 将 Zotero xml 输出转换为 FMPXMLRESULT xml？](https://stackoverflow.com/questions/12132470/xslt-to-translate-zotero-xml-output-to-fmpxmlresult-xml)，我如何在 XSLT 中引用一个 mod，例如：

```
<genre authority="marcgt"> book </genre> 
```

（有多个 mods 开头`genre authority`，每个都有不同的参数。那么 XSLT 中的语法是什么？我尝试了以下方法，但 Filemaker 说存在语法错误。

```
<COL>
   <DATA>
      <xsl:value-of select="mod:genre authority=""marcgt""" />
   </DATA>
 </COL> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:40:26.310

选择正在寻找要选择的节点，似乎您正试图将其指向：

```
<xsl:value-of select="mod:genre[@authority='marcgt']" /> 
```

# android - 让通知在 5 分钟后消失

> ID：15648699
> 
> 赞同：4
> 
> 时间：2013-03-26T22:35:23.407
> 
> 标签：android

是否可以让通知在一段时间后自动消失？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T02:48:06.117

您可以使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。我认为比 Android 服务更合适、更容易实现。

有了`AlarmManager`您，您无需担心在时间完成之前运行某些东西。Android 会为您执行此操作，并在发生时**发送广播**。您的应用程序必须有一个**接收器才能获得正确的意图。**

看这些例子：

*   [Android：如何使用警报管理器](https://stackoverflow.com/questions/1082437/android-alarmmanager)
*   [警报管理器示例](https://stackoverflow.com/questions/4459058/alarm-manager-example)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-20T21:59:20.483

现在有一个选项叫做`.setTimeoutAfter(long durationMs)`

[https://developer.android.com/reference/android/app/Notification.Builder.html#setTimeoutAfter(long)](https://developer.android.com/reference/android/app/Notification.Builder.html#setTimeoutAfter(long))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:41:06.100

是的，您可以创建一个在后台运行的服务，该服务将在五分钟后超时并删除您的通知。你是否“应该”真的这样做还有待商榷。应该有一个通知来通知用户......并且用户应该能够自行关闭它。

[来自 d.android.com：](http://developer.android.com/guide/components/services.html)

> Service 是一个应用程序组件，可以在后台执行长时间运行的操作，并且不提供用户界面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-16T09:53:27.430

是的，这很容易。如果用户未阅读通知，则在收到通知的地方添加一个处理程序，然后删除通知。

```
@Override
public void onMessageReceived(RemoteMessage message) {
sendNotification(message.getData().toString);
} 
```

**添加通知代码**

```
private void sendNotification(String messageBody) {
        Intent intent = new Intent(this, MainActivity.class);
        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, intent,
                PendingIntent.FLAG_ONE_SHOT);

        Uri defaultSoundUri= RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this)
                .setSmallIcon(R.mipmap.ic_launcher)
                .setContentTitle("TEST NOTIFICATION")
                .setContentText(messageBody)
                .setAutoCancel(true)
                .setSound(defaultSoundUri)
                .setContentIntent(pendingIntent);

        NotificationManager notificationManager =
                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        int id = 0;
        notificationManager.notify(id, notificationBuilder.build());
        removeNotification(id);
    } 
```

**取消通知代码。**

```
private void removeNotification(int id) {
Handler handler = new Handler();
    long delayInMilliseconds = 20000;
    handler.postDelayed(new Runnable() {
        public void run() {
            notificationManager.cancel(id);
        }
    }, delayInMilliseconds);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-20T16:20:21.860

您还可以将经典的 Java Runnable 用于简单的小线程。

```
Handler h = new Handler();
    long delayInMilliseconds = 5000;
    h.postDelayed(new Runnable() {
        public void run() {
            mNotificationManager.cancel(id);
        }
    }, delayInMilliseconds); 
```

也看这里：

[几秒钟后清除通知](https://stackoverflow.com/questions/4994126/clearing-notification-after-a-few-seconds)

# git - 多个未发布的提交 - 无法发布任何。怎么了？

> ID：15648700
> 
> 赞同：1
> 
> 时间：2013-03-26T22:35:24.723
> 
> 标签：git, version-control, github, git-push, git-commit

所以我在 Windows 上使用 GitHub。而且我有 4 个未发布的提交（所有 4 个都是最初的 4 个提交）。所以从技术上讲，我的 GH 帐户上还没有创建 repo。为了澄清，这里是提交历史：

![在此处输入图像描述](../Images/9a6f6c7003f61d067e789da3b74e79b1.png)

当我尝试发布其中任何一个时，我收到一个错误：

![在此处输入图像描述](../Images/396738bf9d514f8a8a923dd5146d2e24.png)

当我`git status`，我得到这个：

![在此处输入图像描述](../Images/5428a00678b5f9573b46f47a45ddbe3c.png)

任何人都可以帮助我，好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:09:44.787

*   右键单击您的存储库并选择`Open a shell here`
*   在命令提示符下，键入`git push`. 输出应显示一条`success`或一条错误消息，并为您建议正确的参数`push`。如果它确实给您一个错误（类似于`git push origin`），那么输入该命令，您的存储库应该会在 github 服务器上创建。

# javascript - Javascript/ajax 拒绝显示 XML 数据

> ID：15648703
> 
> 赞同：0
> 
> 时间：2013-03-26T22:35:52.853
> 
> 标签：javascript, xml, ajax

我对现在发生的事情感到非常困惑，这非常令人沮丧，因为在过去的几周中我已经多次这样做了，没有错误。但突然之间，使用 JavaScript 在 HTML 页面中显示 XML 数据变得不可能了。让我解释。

我在 Microsoft Visual Studio 2012 Ultimate 工作。在过去的几周里，我创建了几个网页（作为 ASP.NET 项目和 .aspx 文件而不是 .html）。这一次，我没有创建 .aspx 文件，而是创建了一个 .html 文件，您可以在下面看到。请注意，我已将 CSS 和 JavaScript 内联，以便于阅读：

```
<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">

      <style type = "text/css">
         h2 {color:Navy}

         li 
         {    
             font-family : monospace;
             font-weight: bold; 
             color:Navy;
         }

         li:hover {color: red;}
      </style>

      <script type="text/javascript">
          $(document).ready(function () {
              $.ajax({
                  type: "GET",
                  url: "stylesheets/stocks.xml",
                  dataType: "xml",
                  success: function (xml) {
                      $(xml).find('Stock').each(function () {
                          var company = $(this).find('Company').text();
                          var market = $(this).find('Market').text();
                          var sector = $(this).find('Sector').text();
                          var price = $(this).find('Price').text();
                          $("#company").html(company);
                          $("#market").html(market);
                          $("#sector").html(sector);
                          $("#price").html(price);
                          });

                        }
                    });
                });
      </script>
   </head>

   <body onload="onBodyLoad()">
       <h2>List of Stocks:</h2>
      <div id="stockList"> 
          <ul><!--Temporary-->
              <li>BA</li>
              <li>CSCO</li>
              <li>ED</li>
              <li>GOOG</li>
              <li>MO</li>
          </ul><!--temp-->
      </div>
      <div id="stockInfo"> <!--Make a script to Show/Hide this div. Hide on default-->
          <table>
              <tr>
                  <td>1.</td><td>Company - </td><td id="company"></td>
              </tr>
              <tr>
                  <td>2.</td><td>Market - </td><td id="market"></td>
              </tr>
              <tr>
                  <td>3.</td><td>Sector - </td><td id="sector"></td>
              </tr>
              <tr>
                  <td>4.</td><td>Price - </td><td id="price"></td>
              </tr>
          </table>
      </div>
   </body>
</html> 
```

我要做的就是在我提供的表中显示 XML 数据。在各自的表格单元格中输出公司的名称、市场、部门和股价（ex id="company"）。最终结果应如下所示：

1.  公司 - 谷歌
2.  市场 - 纳斯达克
3.  部门 - 软件
4.  价格 - 487.80 美元

相反，我得到的是：

1.  公司 -
2.  市场 -
3.  部门 -
4.  价格 -

我之前已经多次使用相同的循环（只需要修改变量名等等），效果很好。但是现在，出于某种奇怪的原因，这个脚本不起作用。有趣的是，我已经将 XML 内容复制并粘贴到另一个 ASPX 项目中的另一个 XML 文件中，并且（当然，对脚本变量名称进行了一些修改等等）XML 数据显示得很好......它只是在这种非常令人沮丧的特殊情况下似乎不起作用。我已经重新编写并重写了几乎 4 次涉及的所有 XML、HTML 和 JavaScript，但是，当我加载 HTML 页面时，我只盯着我用 HTML 硬编码的内容，没有 XML 数据。就像脚本甚至没有运行一样。这个 html 文件位于根文件夹中，而 XML 文件我 试图从中获取数据的 m 位于名为“stylesheets”的根文件夹中的文件夹中。该文件名为stocks.xml。因此，我在 JavaScript 中输入的目录是正确的。

我只是不明白......我做错了什么？

# c++ - 私人朋友运营商<<

> ID：15648705
> 
> 赞同：2
> 
> 时间：2013-03-26T22:35:59.007
> 
> 标签：c++

所以我有一个类，我想对其进行重载`operator<<`，以便能够将其内部数据输出到输出流。我只想出于调试目的这样做，因此以某种方式完全隐藏了`operator<<`外界，因此只能从`*.cpp`我的类的实现所在的文件中访问它。要从`operator<<`我的类中访问成员变量，我必须使它成为它的朋友。然而，在班级中声明 `operator<<`朋友可以让任何来自外部世界的人都可以调用 `operator<<`这个班级......

我知道我可以创建一个常规的私有成员函数来执行此操作，但我已经有一些使用的调试宏`operator<<`，所以我想知道是否有可能以某种方式完成此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:50:58.463

You can move the `operator<<` functionality to a helper proxy class. When the proxy is used as the RHS of `<<`, then the original object is printed. Define a `private` implicit conversion from the original to the proxy. Now anyone has access to `operator<<`, but only the class has the ability to construct the proxy.

[Code:](http://liveworkspace.org/code/1okMSL%248)

```
class private_printable {
    int state;

    struct proxy {
        private_printable const &r;
    };
    operator proxy () const { return { * this }; }

    friend std::ostream & operator << ( std::ostream & s, proxy const & o )
        { return s << o.r.state; }

public:
    private_printable() : state( 5 ) {}
    void debug() { std::cout << * this << '\n'; }
}; 
```

Note that the proxy doesn't need to be friended. The only change from the normal way of doing things is that the proxy and conversion function exist. The `friend operator<<` is found by argument-dependent lookup, without a namespace-scope declaration, even though it doesn't take a `private_printable` argument. Then the conversion makes it viable. Don't think a cleaner solution is possible :v) .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:56:35.987

如果一个翻译单元可以访问，那么任何翻译单元都可以访问，除非您使用`#ifdef`.

但是您可能会不小心使其难以使用：

```
// example.hpp
#ifndef EXAMPLE_CLASS_HPP
#define EXAMPLE_CLASS_HPP

#include <ostream>

class Example;

namespace Example_debug {
    std::ostream& operator<<(std::ostream&, const Example&);
}

class Example {
public:
    // ...
private:
    void debug_print(std::ostream&) const;
    friend std::ostream& Example_debug::operator<<(
      std::ostream&, const Example&);
};

#endif

// example.cpp
#include "example.hpp"

std::ostream& Example_debug::operator<<(std::ostream& os, const Example& obj) {
    obj.debug_print(os);
    return os;
}

using Example_debug::operator<<;

// ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:39:13.460

```
#ifdef WIN32
# define DLL_LOCAL
# define DLL_PUBLIC __declspec(dllexport)
#else
# define DLL_LOCAL __attribute__ ((visibility ("hidden")))
# define DLL_PUBLIC
#endif

class DLL_PUBLIC Example
{
  DLL_LOCAL friend std::ostream& operator << ( std::ostream& os_, const Example& inst_ );
  ...
}; 
```

在 Windows DLL 中：不导出友元函数。

在 gcc 中：隐藏它[`__attribute__ ((visibility ("hidden")))`](http://gcc.gnu.org/wiki/Visibility)

这样，您的图书馆用户无法链接此功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T23:16:57.353

将 声明`operator<<`为类中的朋友，但将其*定义*为`static`文件中您希望它可用的位置。

这确实有一个小缺点：尝试在您定义它的文件之外使用它只会导致*链接器*错误，而不是您真正喜欢的编译器错误。另一方面，这仍然比没有保护要好得多*。*

这是一个快速演示。首先，带有类定义的头文件，并声明一个`junk`我们将用来测试对操作符的访问的函数：

```
// trash.h
#include <iostream>

class X { 
    friend std::ostream &operator<<(std::ostream &, X const &);
};

void junk(X const &); 
```

然后是我们定义的文件`X`和操作符，所以我们应该可以从这里访问操作符：

```
#include "trash.h"

static std::ostream &operator<<(std::ostream &os, X const &x) {
    return os << "x";
}

int main() {
    X x;
    std::cout << x;
    junk(x);
    return 0;
} 
```

然后是不应该访问操作员的第二个文件：

```
#include "trash.h"

void junk(X const &x) {
    // un-comment the following, and the file won't link:
    //std::cout << x; 
} 
```

请注意，在这种情况下，我们不能使用匿名命名空间来代替文件级`static`函数——如果您尝试，它会显示为 的模棱两可的重载`operator<<`，即使在我们想要允许的情况下也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T23:55:58.837

好的，所以在阅读了你所有的答案并挠了很长时间之后，我想出了以下事情。我使用私有继承来存储我的类的所有数据，并让我的私有基类的输出函数成为朋友。另外，为了禁止用户实例化这个基类，我必须把它抽象化。我并不是说这是一个好的软件工程，而且这种方法对我的口味也有点过于复杂，作为它所代表的概念证明。我用 gcc 4.7.2 用以下开关编译了这个： -std=c++98 -Wall -Wextra -pedantic -g

在头文件 class.h 中：

```
#ifndef CCLASS_H
#define CCLASS_H

#include <iostream>

class CDataBase
{
  protected:
    /// all data members will go here
    int m_data;

    CDataBase(int data = 0) : m_data(data) { }

    /**
     * Make the base virtual, so that it cannot be instantiated
     */
    virtual ~CDataBase(void) = 0;

    /// and this function is a friend of only the base class
    friend std::ostream & operator<<(std::ostream & os, const CDataBase & base);
};

class CMyClass : private CDataBase
{
  public:
    CMyClass(void) : CDataBase(42) { }
    virtual ~CMyClass(void) { }
    void test(void);
};

#endif 
```

在实现文件 Class.cpp

```
#include "CClass.h"

std::ostream & operator<<(std::ostream & os, const CDataBase & base)
{
  os << base.m_data;
  return os;
}

CDataBase::~CDataBase(void)
{
}

void CMyClass::test(void)
{
  std::cout << *this << std::endl;
} 
```

在其他一些文件中：

```
#include "CClass.h"

#include <iostream>

int main(void)
{
  CMyClass cls;
  cls.test();  // this works

  // this failes, because CDataBase is abstract
  //CDataBase base;

  // this fails as well, because CDataBase is inaccessible
  //std::cout << cls << std::endl;
  return 0;
} 
```

# c++ - 如何将共享指针设置为常规指针

> ID：15648706
> 
> 赞同：1
> 
> 时间：2013-03-26T22:36:02.567
> 
> 标签：c++, pointers, shared-ptr

我完全是共享指针的新闻。我正在尝试通过做初始化一个

```
std::shared_ptr<Gdiplus::Pen> pen(new Gdiplus::Pen); 
```

但它说它需要一个类型说明符......我也在尝试将此共享指针设置为常规指针。谁能解释我这是如何工作的。非常感激

```
#pragma once
class Shape
{
public:
Shape();
Gdiplus::Point start;   
Gdiplus::Point end;

std::shared_ptr<Gdiplus::Pen> pen(new Gdiplus::Pen());
virtual  LRESULT Draw(Gdiplus::Graphics * m_GraphicsImage) = 0;

void setPen(Gdiplus::Pen * pen2) {

    pen.get() = pen2; 
}
void setStart(int xPos, int yPos) {
    start.X = xPos;
    start.Y = yPos;
}
void setEnd(int xCor, int yCor) {
    end.X = xCor;
    end.Y = yCor;
} 
```

};

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:37:06.463

```
std::shared_ptr<Gdiplus::Pen> pen(new Gdiplus::Pen); 
```

应该

```
std::shared_ptr<Gdiplus::Pen> pen(new Gdiplus::Pen(brush, width)); 
```

或者你的构造函数看起来像什么

从 shared_ptr 获取原始指针

```
setPen(pen.get()); 
```

提示：小心设置由智能指针控制的原始指针。您确定不想传递智能指针（共享或唯一）吗？

您还应该通过 std 辅助函数创建共享指针

```
auto pen = std::make_shared<Gdiplus::Pen>(brush, width); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:37:24.343

使用`get`shared_ptr 将其作为原始指针传递：

```
setPen(pen.get()); 
```

但请确保您没有将其存储在 setPen 中。这将在以后导致令人讨厌的错误。

# java - 导出对象客户端时出现“java.rmi.ConnectException: Connection refused to host”

> ID：15648708
> 
> 赞同：4
> 
> 时间：2013-03-26T22:36:13.253
> 
> 标签：java, jvm, client-server, virtual-machine, rmi

我现在至少坚持了 5 个小时，除了在这里问之外别无他法。我正在编写一个 RMI 应用程序。我希望服务器绑定一个远程对象（`NoteBoardImpl`此处），客户端将查找该对象。客户端将其监听器（`NoteBoardListener`此处）传递给服务器，监听器也是客户端导出的远程对象。

我在这里准备了一个简单的SSCCE，所以我真的希望有人可以研究一下。所有类都在默认包的同一个文件夹中。我知道这是不鼓励的，我应该把应用程序分成三个罐子，但我想在这里尽可能简单。

*远程接口：*

```
import java.rmi.Remote;
import java.rmi.RemoteException;

public interface INoteBoard extends Remote {
    public void test(INoteBoardListener listener) throws RemoteException;
} 
```

```
import java.rmi.Remote;
import java.rmi.RemoteException;

public interface INoteBoardListener extends Remote {
    public void onNewText(String text) throws RemoteException;
} 
```

*接口实现：*

```
import java.rmi.RemoteException;

public class NoteBoardImpl implements INoteBoard {
    @Override
    public void test(INoteBoardListener listener) throws RemoteException {
        listener.onNewText("server call the listener");
    }
} 
```

```
import java.rmi.RemoteException;

public class NoteBoardListener implements INoteBoardListener {
    @Override
    public void onNewText(String text) throws RemoteException {
        System.out.println(text);
    }
} 
```

*客户端和服务器：*

```
import java.rmi.Naming;
import java.rmi.server.UnicastRemoteObject;

public class Client {
    public static void main(String[] args) {
        if (args.length < 2) {
            System.out.println("2 arguments required:\nRMI_IP RMI_port");
            return;
        }
        System.setProperty("java.rmi.server.hostname", args[0]);
        try {
            INoteBoard nb = (INoteBoard) Naming.lookup(String.format("rmi://%s:%s/note", args[0], args[1]));
            INoteBoardListener l = (INoteBoardListener) UnicastRemoteObject.exportObject(new NoteBoardListener(), 0);
            nb.test(l);
            l.onNewText("client invokes listener");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

```
import java.rmi.Naming;
import java.rmi.server.UnicastRemoteObject;

public class Server {
    public static void main(String[] args) {
        if (args.length < 2) {
            System.out.println("2 arguments required:\nRMI_IP RMI_port");
            return;
        }
        System.setProperty("java.rmi.server.hostname", args[0]);
        try {
            INoteBoard noteBoard = (INoteBoard) UnicastRemoteObject.exportObject(new NoteBoardImpl(), 0);
            Naming.rebind(String.format("rmi://%s:%s/note", args[0], args[1]), noteBoard);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

我试图模拟一个分布式系统以进行测试，并在虚拟机上运行客户端。主机-VM 网络具有以下规格 - 主机 IP = 192.168.56.1，VM IP = 192.168.56.101。
首先，我使用以下命令（`rmiregistry 1099`预先启动）在本地运行客户端和服务器。工作目录是项目的根目录，编译的类在`bin`目录中：
`java -cp bin -Djava.rmi.server.codebase=http://student.agh.edu.pl/~grajewsk/bin/ Server 192.168.56.1 1099`
`java -cp bin Client 192.168.56.1 1099`
并且它工作。

然后我使用相同的命令在 VM 上运行客户端程序，这是我得到的异常：

```
java.rmi.ConnectException: Connection refused to host: 192.168.56.1; nested exception is: 
    java.net.ConnectException: Connection refused
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:619)
    at sun.rmi.transport.tcp.TCPChannel.createConnection(TCPChannel.java:216)
    at sun.rmi.transport.tcp.TCPChannel.newConnection(TCPChannel.java:202)
    at sun.rmi.server.UnicastRef.invoke(UnicastRef.java:128)
    at java.rmi.server.RemoteObjectInvocationHandler.invokeRemoteMethod(RemoteObjectInvocationHandler.java:194)
    at java.rmi.server.RemoteObjectInvocationHandler.invoke(RemoteObjectInvocationHandler.java:148)
    at sun.proxy.$Proxy0.test(Unknown Source)
    at Client.main(Client.java:14)
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:327)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:193)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:384)
    at java.net.Socket.connect(Socket.java:546)
    at java.net.Socket.connect(Socket.java:495)
    at java.net.Socket.<init>(Socket.java:392)
    at java.net.Socket.<init>(Socket.java:206)
    at sun.rmi.transport.proxy.RMIDirectSocketFactory.createSocket(RMIDirectSocketFactory.java:40)
    at sun.rmi.transport.proxy.RMIMasterSocketFactory.createSocket(RMIMasterSocketFactory.java:146)
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:613)
    ... 7 more 
```

请注意如何在服务器的注册表中成功查找对象，然后导出客户端远程对象（也成功）并在第 14 行中断执行，我试图在第 14 行调用方法传递客户端对象的服务器端对象。

我在任何一个系统上都没有防火墙，两个方向的 ping 都完美无缺。我知道这里肯定存在一些概念问题，当然我误解了关于 RMI 的一些内容。我非常感谢您的帮助。

二进制代码库和[源代码都](http://student.agh.edu.pl/~grajewsk/src/)[在我学生的服务器上](http://student.agh.edu.pl/~grajewsk/bin/)。先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T23:24:19.467

这就是我要做的事情。

1.  运行您的服务器应用程序
2.  找出它用于 RMI 的端口（它是短暂的，因此它应该针对您为服务器创建的每个进程而更改）。

    *   使用 ps -ef 查找 PID
    *   然后 netstat -anp|grep 这应该会给你端口号。它应该绑定到 0.0.0.0
3.  在客户端 VM 上，使用 nc 或 telnet 验证您可以连接到端口。如果失败，您可能遇到了防火墙/iptables 问题。

4.  使用wireshark 来验证您的客户端实际上是在尝试连接到您从步骤#2 中学到的端口/IP 组合。

请记住，仅仅因为您可以 ping，并不意味着您可以连接到给定的端口。还要检查“iptables -L”。

此外，[命名](http://docs.oracle.com/javase/6/docs/api/java/rmi/Naming.html)表示不要放置 URL 的方案组件。格式应该是//host:port/name，所以你也应该检查一下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T13:59:52.383

好的，终于解决了。问题是，我`java.rmi.server.hostname`在两个程序中传递了相同的参数，这意味着客户端和服务器都在这里获得了服务器的地址。事实证明，如果客户端想要导出自己的对象，它必须提供自己的 IP 给`java.rmi.server.hostname`. 这样一切正常。

所以，总结起来，我必须给服务器 3 个参数：
RMI_IP RMI_port server_hostname

和客户端的 3 个类似参数：
RMI_IP RMI_port client_hostname

# javascript - 角度js添加两个数字问题

> ID：15648711
> 
> 赞同：15
> 
> 时间：2013-03-26T22:36:20.460
> 
> 标签：javascript, angularjs

我有使用 Angular js 的代码：

```
<!DOCTYPE html >
<html>
<head>
    <title>Untitled Page</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.min.js"></script>
    <script type="text/javascript">
        function TodoCtrl($scope) {
            $scope.total = function () {
                return $scope.x + $scope.y;
            };

        }
    </script>
</head>
<body>
   <div ng-app>
  <h2>Calculate</h2>

  <div ng-controller="TodoCtrl">
    <form>
        <li>Number 1: <input type="text" ng-model="x" /> </li>
        <li>Number 2: <input type="text" ng-model="y" /> </li>
        <li>Total <input type="text" value="{{total()}}"/></li>       
    </form>
  </div>
</div>

</body>
</html> 
```

我可以进行乘法、除法和减法运算，但对于加法，代码只是连接 x 和 y 值（即，如果 x = 3 和 y = 4，则总数为 34 而不是 7）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-26T22:38:38.957

如果确实如此，那么正在发生的事情是为 x 和 y 传入的值被视为字符串并连接起来。你应该做的是使用它们将它们转换为数字`parseInt`

```
return parseInt($scope.x) + parseInt($scope.y); 
```

或者如果你喜欢简洁

```
return $scope.x*1 + $scope.y*1; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-26T22:38:23.110

你要这个：

```
 return parseFloat($scope.x) + parseFloat($scope.y); 
```

`+`当您有 2 个字符串时覆盖字符串连接。您需要将它们显式转换为整数或浮点数。 `-`, , 如果可能`*`，`/`将全部转换为数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-09T20:52:53.430

这是因为连接的优先级高于加法运算或加号 (+) 运算符。因为，减号运算符 (-) 工作得很好，这里有一个简单的技巧！

```
<script type="text/javascript">
    function TodoCtrl($scope) {
        $scope.total = function () {
            //Subtracting a Zero converts the input to an integer number
            return (($scope.x - 0) + ($scope.y - 0));
        };

    }
</script> 
```

你也可以这样做：

```
<form>
    <li>Number 1: <input type="text" ng-model="x" /> </li>
    <li>Number 2: <input type="text" ng-model="y" /> </li>
    <li>Total <input type="text" value="{{(x-0) + (y-0)}}"/></li>       
</form> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-29T18:45:19.323

以正确的方式添加浮点数

```
 $scope.Total = parseFloat($scope.firstValue) + parseFloat($scope.secondValue);
 $scope.Total = parseFloat($scope.Total.toFixed(2)); 
```

如果应用了绑定，$scope.Total 现在将在视图中正确显示`ng-model`，例如，如果您有

```
$scope.firstValue = 10.01;
$scope.firstValue = 0.7; 
```

`$scope.Total = parseFloat($scope.firstValue) + parseFloat($scope.secondValue);`

变量`$scope.Total`将是`10.709999999999999`，这是不正确的！添加 parseFloat 不足以获得正确的值。但是如果你申请

`$scope.Total = parseFloat($scope.Total.toFixed(2));`

该值将正确产生：`$scope.Total = 10.71`

小心javascript中的浮点数

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-13T10:14:57.657

输入类型为数字，因为是加法运算

```
<input type="text" ng-model="x" />
<input type="text" ng-model="y" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-04T23:22:03.220

要将两个数字相加，我将解析字符串的整数并检查是否为空：

```
function TodoCtrl($scope) {
    $scope.total = function() {
        var firstNum = parseInt($scope.firstNum) 
        var secondNum = parseInt($scope.secondNum);

        if (!firstNum)
            firstNum = 0;
        if (!secondNum)
            secondNum = 0;

        return firstNum + secondNum;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-19T20:29:46.010

我建议您将输入的类型更改为“数字”，然后，您不需要解析它，角度会自动将其转换为整数。我做到了，它可以工作，没有范围，但只是为了声明你的 {{total}}

# python - Pyflakes 与 Emacs

> ID：15648712
> 
> 赞同：1
> 
> 时间：2013-03-26T22:36:21.040
> 
> 标签：python, emacs, static-analysis, flymake, pyflakes

我正在尝试使用 emacs 安装 pyflakes。到目前为止，我已经从[这里](http://cvs.savannah.gnu.org/viewvc/emacs/emacs/lisp/progmodes/flymake.el)获得了 flymake.el 文件。我把它放在我的 .emacs.d 文件夹中。在我的 .emacs 文件中，我有这个：

```
(when (load "flymake" t)
  (defun flymake-pyflakes-init ()
    (let* ((temp-file (flymake-init-create-temp-buffer-copy
                       'flymake-create-temp-inplace))
           (local-file (file-relative-name
                        temp-file
                           (file-name-directory buffer-file-name))))
  (list "pyflakes" (list local-file))))

  (add-to-list 'flymake-allowed-file-name-masks
               '("\\.py\\'" flymake-pyflakes-init)))

(add-hook 'find-file-hook 'flymake-find-file-hook) 
```

我还下载了 pyflakes，它可以从命令行调用。但是，当我用一个文件打开我的 emacs 时，我仍然发现它找不到程序“pyflakes”。为什么 emacs 找不到 pyflakes 而我的命令行可以？我在 iOS 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:26:34.400

通过将以下行添加到 *init.el*或添加`/path/to/python/scripts`emacs`exec-path`*`M-:`*

 *```
(setq exec-path (cons /path/to/python/scripts exec-path)) 
```*

# c# - 面板内的附加属性集合

> ID：15648718
> 
> 赞同：0
> 
> 时间：2013-03-26T22:36:53.447
> 
> 标签：c#, wpf

当我尝试像这样将附加的属性集合添加到面板时；

```
<Grid x:Name="MainContent" Grid.Row="1">
    <StackPanel x:Name="MainContentSp">

        <do:AttachCollection.Col>
            <do:AttachItem x="y"/>
            <do:AttachItem x="z"/>
        </do:AttachCollection.Col>

        <TextBlock x:Name="tb1" Text="xx"/>
        <TextBlock x:Name="tb2" Text="yy"/>

    </StackPanel>
</Grid> 
```

而是将其分配给网格...如何将其附加到面板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T13:16:17.917

事实证明，附加属性与每个 ui 元素共享一个列表实例，因此我不得不使用一种相当老套的方式为每个元素提供它自己的列表实例。

前

```
public static readonly
    DependencyProperty
    XProperty =
        DependencyProperty
            .RegisterAttached
            ("X",
                typeof(List<X>),
                typeof(X),
                new PropertyMetadata(new List<X>())); 
```

后

```
public static readonly
    DependencyProperty
    XProperty =
        DependencyProperty
            .RegisterAttached
-->         ("XInternal",
                typeof(List<X>),
                typeof(X));
-->(removed) 
```

现在使用 getter 为每个 ui 元素创建一个新的列表实例：

```
public static List<X> GetX(UIElement element)
{
    var list = ((List<X>)(element.GetValue(XProperty)));
    if (list == null)
    {
        list = new List<X>();
        SetX(element, list);
    }
    return list;
} 
```

# python - 来自 Python 的标准输入重定向

> ID：15648724
> 
> 赞同：0
> 
> 时间：2013-03-26T22:37:07.500
> 
> 标签：python, io-redirection

假设我有一个程序`some_binary`可以读取数据：

```
some_binary < input 
```

where`input`通常是磁盘中的文件。我想从 Python发送`input`到**而不写入磁盘**。`some_binary`

 **例如`input`通常是具有以下内容的文件：

```
0 0.2
0 0.4
1 0.2
0 0.3
0 0.5
1 0.7 
```

为了在 Python 中模拟类似的东西，我有：

```
import numpy as np

# Random binary numbers
first_column = np.random.random_integers(0,1, (6,))

# Random numbers between 0 and 1
second_column = np.random.random((6,)) 
```

我怎样才能像从命令行调用一样提供和的连接，并收集在`first_column`一个字符串中？`second_column``some_binary``some_binary < input``stdout`

我有以下内容：

```
def run_shell_command(cmd,cwd=None,my_input):
      retVal = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stdin=my_input, cwd=cwd);
      retVal = retVal.stdout.read().strip('\n');
      return(retVal); 
```

但我不确定我是否朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:43:42.480

是的，你正朝着正确的方向前进。

您可以使用 pythons`subprocess.check_output()`函数，它是`subprocess.Popen()`. `Popen`需要更多的基础设施。例如，您需要调用`comminucate()`的返回值`Popen`才能使事情发生。

就像是

```
output = subprocess.check_output([cmd], stdin = my_input) 
```

应该适用于您的情况。**

# apache - 如何使用 mod_rewrite 重定向到 https 连接？

> ID：15648726
> 
> 赞同：1
> 
> 时间：2013-03-26T22:37:20.703
> 
> 标签：apache, mod-rewrite

我试图总是将人们重定向到

```
https://www.somedomain.com/URL 
```

当他们进入非安全端口时。这是因为我的 SSL 是针对这个 url 的。

当有人访问[http://www.somedomain.com](http://www.somedomain.com)时，他们会被发送到

```
http://www.www.somedomain.com 
```

这是我正在尝试的 htaccess 重写：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://www.%{HTTP_HOST}%{REQUEST_URI} 
```

编辑：

我正在使用一个 cPanel 服务器，所以制作额外的主机是行不通的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:27:54.490

> 我试图总是将人们重定向到`https://www.somedomain.com/URL`

我认为这就是你所需要的：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*) https://www.somedomain.com/$1   [R=301,L,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:41:49.190

如果 www 已经存在，您将不希望无条件地添加它。请参阅：[使用 .htaccess 和 mod_rewrite 将“www”添加到 HTTPS url](https://stackoverflow.com/questions/2902590/prepend-www-to-an-https-url-using-htaccess-mod-rewrite?rq=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:44:22.210

请注意，这`mod_rewrite`不是执行此操作的首选方式。使用虚拟主机更简单。只要把这个配置（来源：[apache wiki](http://wiki.apache.org/httpd/RedirectSSL#Using_mod_rewrite)）：

```
NameVirtualHost *:80
<VirtualHost *:80>
   ServerName www.somedomain.com
   Redirect permanent /secure https://www.somedomain.com
</VirtualHost>

<VirtualHost _default_:443>
   ServerName www.somedomain.com
   DocumentRoot /usr/local/apache2/htdocs
   SSLEngine On
# etc...
</VirtualHost> 
```

# django - 带有选择字段的 Django 表单不提供 None 作为选择

> ID：15648730
> 
> 赞同：1
> 
> 时间：2013-03-26T22:37:38.343
> 
> 标签：django, django-forms

我有一个定义为形式的选择字段

```
REFERRAL_CHOICES = (
    (None, 'Please choose'),
    ('search', 'From a search engine'),
    ('social', 'From a social network'),
)
referral_source = forms.ChoiceField(
    choices=REFERRAL_CHOICES
) 
```

我还有一个`clean_company_size`函数可以检查字段是否设置为合适的值：

```
def clean_company_size(self):
    company_size = self.cleaned_data.get('company_size', None)
    if company_size is None:
        raise ValidationError('Please select a company size')

    return company_size 
```

如果我`or company_size == 'None'`在上面的无检查中添加一个条件，一切正常。但是，我很好奇为什么 None 值被强制转换为字符串。在选择字段中完成默认提示并要求该字段的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:52:02.643

所有`POST`和`GET`变量以及`Select`HTML 标记值最初都是作为字符串发送的。当它可以从模型中扣除时， Django 将它们转换为 -say- `int`。在您的情况下，无法将“None”字符串与“None”对象区分开来，它们都是可能的值。您可能更喜欢使用 "" 而不是`None`在您的`REFERRAL_CHOICHES`

# xamarin.ios - 如何绑定到 Xamarin.iOS 中的基本类型和协议

> ID：15648733
> 
> 赞同：3
> 
> 时间：2013-03-26T22:38:04.910
> 
> 标签：xamarin.ios, xamarin

我正在尝试构建一个利用 Cordova 库的 xamarin 应用程序。我一直在为我需要的库的组件进行自己的绑定，到目前为止，它运行良好。

今天我遇到了一个有趣的问题。我试图覆盖[可用 here](https://github.com/apache/cordova-ios/blob/master/CordovaLib/Classes/CDVViewController.h)`webView: shouldStartLoadWithRequest:`上的方法。`CDVViewContainer`

我查看了[Xamarin 绑定指南](http://docs.xamarin.com/guides/ios/application_fundamentals/delegates,_protocols,_and_events#3.protocols)和 Xamarin[高级绑定指南](http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries/binding_types_reference_guide)。这两个都注意到协议类似于接口，如高级绑定指南中所示

```
@interface UITextField : UIControl <UITextInput> {

} 
```

将转化为

```
[BaseType (typeof (UIControl))]
interface UITextField : UITextInput {
} 
```

基于此，我翻译了

```
@interface CDVViewController : UIViewController <UIWebViewDelegate, CDVScreenOrientationDelegate>{

} 
```

进入

```
[BaseType (typeof (UIViewController))]
interface CDVViewController : UIWebViewDelegate {

} 
```

但是当我尝试制作我的绑定库时，我得到了

```
Cordova.cs(26,39): error CS0527L Type `MonoTouch.UIKit.UIWebViewDelegate' in interface list is not an interface. 
```

我检查了 Apple Specifications，[这实际上是一个 Protocol](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)。谁能帮我弄清楚我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T07:27:45.130

这是对工具的限制。当您包含自己的定义时，您只能使用该语法来采用协议。当采用已在外部定义中定义的协议时，它不起作用。

# c# - RichTextBox SelectionFont 改回来

> ID：15648735
> 
> 赞同：0
> 
> 时间：2013-03-26T22:38:06.907
> 
> 标签：c#, forms

我创建 RichTextBox 并得到以下代码：

```
richTextBox1.SelectionFont = new Font("Verdana", 10, FontStyle.Regular);
richTextBox1.SelectionColor = Color.Blue;
richTextBox1.Text += "ddddd"; 
```

文字保持不变。我注意到richTextBox1.Text 将我的字体改回了默认字体。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:40:22.910

尝试使用 AppendText 方法：

```
richTextBox1.SelectionFont = new Font("Verdana", 10, FontStyle.Regular);
richTextBox1.SelectionColor = Color.Blue;
richTextBox1.AppendText("ddddd");

richTextBox1.SelectionFont = myDefaultFont;
richTextBox1.SelectionColor = myDefaultColor; 
```

# xaml - WinRT XAML 工具包 BindableSelections 未更新 UI

> ID：15648736
> 
> 赞同：0
> 
> 时间：2013-03-26T22:38:18.267
> 
> 标签：xaml, windows-runtime, winrt-xaml, mvvm-light, winrt-xaml-toolkit

下面是用于处理我的 gridview 中选定项目的 xaml 和 c# 代码。

我也在使用 MVVM Light，一切正常，包括我能够看到 SelectedItems 内部的内容。

但是，当我尝试清除 SelectedItems 时，我的 UI 似乎没有更新/反映对 SelectedItems 所做的更改。

我正在使用 WinRT XAML 工具包 ( [http://winrtxamltoolkit.codeplex.com/](http://winrtxamltoolkit.codeplex.com/) )，它在 GridView 上具有 BindableSelection 扩展

**XAML**

```
<controls:CustomGridView
    x:Name="VideoItemGridView"
    Grid.Row="2"
    Margin="0,-3,0,0"
    Padding="116,0,40,46"
    HorizontalContentAlignment="Stretch"
    VerticalContentAlignment="Stretch"
    IsItemClickEnabled="True"
    SelectionMode="Extended"
    Extensions:GridViewExtensions.BindableSelection="{Binding SelectedVideoItems, Mode=TwoWay}"
    ItemsSource="{Binding Source={StaticResource ViewSource}}"
    ItemTemplate="{StaticResource VideoItemTemplate}">
    <GridView.ItemsPanel>
        <ItemsPanelTemplate>
            <VariableSizedWrapGrid ItemWidth="250" ItemHeight="160" />
        </ItemsPanelTemplate>
    </GridView.ItemsPanel>
</controls:CustomGridView> 
```

**MyViewViewModel.cs**

```
#region Selected Items

/// <summary>
/// Gets or sets the selected video items.
/// </summary>
public ObservableCollection<object> SelectedVideoItems
{
    get { return this._selectedVideoItems; }
    set
    {
        this._selectedVideoItems = value;
        this.Set("SelectedVideoItems", ref this._selectedVideoItems, value);
    }
}
private ObservableCollection<object> _selectedVideoItems = new ObservableCollection<object>();

#endregion

#region App Bar Click Commands

/// <summary>
/// Gets the ClearSelection click command.
/// </summary>
public ICommand ClearSelectionClickCommand
{
    get
    {
        return new RelayCommand(() => this.ClearSelectionOperation());
    }
}

/// <summary>
/// Selects all command operation.
/// </summary>
private void ClearSelectionOperation()
{
    this.SelectedVideoItems = new ObservableCollection<object>();
}

#endregion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T02:54:18.643

事实证明，由于我使用的是数据模板，实际上是我的数据模型需要设置一个标志来指示它被选中

这是拼图中缺失的部分。一旦我更新了绑定到网格视图项的数据模型（其中还包括对行/列跨越的支持），UI 就会按预期更新。

希望这对其他人有帮助。

```
public class CustomGridView : GridView
{
    protected override void PrepareContainerForItemOverride(DependencyObject element, object item)
    {
        try
        {
            base.PrepareContainerForItemOverride(element, item);

            dynamic _Item = item;
            element.SetValue(VariableSizedWrapGrid.ColumnSpanProperty, _Item.ColumnSpan);
            element.SetValue(VariableSizedWrapGrid.RowSpanProperty, _Item.RowSpan);
            element.SetValue(GridViewItem.IsSelectedProperty, _Item.IsSelected);
        }
        catch
        {
            element.SetValue(VariableSizedWrapGrid.ColumnSpanProperty, 1);
            element.SetValue(VariableSizedWrapGrid.RowSpanProperty, 1);
            element.SetValue(GridViewItem.IsSelectedProperty, false);
        }
        finally
        {
            base.PrepareContainerForItemOverride(element, item);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T00:18:59.190

`ClearSelectionOperation`尝试通过调用清除您选择的项目

```
this.SelectedVideoItems.Clear(); 
```

代替

```
this.SelectedVideoItems = new ObservableCollection<object>(); 
```

如果这无济于事，请检查[3 月 7 日的当前版本的扩展](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/9c814f6c67c5#WinRTXamlToolkit/Controls/Extensions/GridViewExtensions.cs)是否解决了问题。

# css - 用省略号在 div 中换行（+ 浮动 div 的自动换行）

> ID：15648737
> 
> 赞同：1
> 
> 时间：2013-03-26T22:38:18.813
> 
> 标签：css, html

好吧，我用这个把头撞在桌子上一段时间了..想要实现以下目标

1) 标题 (nav) 应该在一行上，没有换行（这包括 nav-back、nav-title 和 nav-next）

2）当你缩小窗口时，导航标题应该缩小并且当窗口不允许显示所有文本时，它应该用省略号切断（例如'这太长了......'）

这是我的工作：

```
<div class="nav">
<div class="nav-back"><</div>
<div class="nav-title">
    <div class="nav-main-title">Want this no-wrap with ellipses</div>
    <div id="default-page-sub-title" class="nav-sub-title">Same here</div>
</div>
<div class="nav-next">></div> 
```

[在 jsfiddle 上](http://jsfiddle.net/KYYTy/)使用样式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:05:28.880

您将省略号溢出属性应用于`.nav`容器而不是标题。

[JSFiddle](http://jsfiddle.net/KYYTy/43/)

**CSS**

```
.nav .nav-main-title, .nav .nav-sub-title {
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    width: inherit;
} 
```

# python - Numpy：给定 argmax 的 np.where 函数

> ID：15648738
> 
> 赞同：0
> 
> 时间：2013-03-26T22:38:20.610
> 
> 标签：python, numpy

我正在尝试在两个 2D numpy 数组上执行此功能：第 1 步：查找`np.argmax(b, axis=1)`索引。第 2 步：查找`b[indices] > a[indices]` 第 3 步：在 2D 布尔数组中返回值。

我试过这个：

```
np.where((b>a)&np.argmax(b,axis=1).reshape((3,-1)), True, False) 
```

但没有骰子。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T23:00:41.727

根据您的评论，我最好的理解是：

```
output = (np.max(b,axis=1)[...,None] == b) & (b > a) 
```

我们利用 Numpy 广播来执行“是其行中的最大值`b`”部分：

```
np.max(b,axis=1)[...,None] == b 
```

或者更清楚：

```
np.max(b,axis=1)[...,np.newaxis] == b 
```

# jquery - 如何让这个简单的销售税计算器不破坏和清除字段？

> ID：15648741
> 
> 赞同：1
> 
> 时间：2013-03-26T22:38:24.567
> 
> 标签：jquery, html, forms

我要做的就是在我按下计算时让它不会中断，并让清除按钮清除两个文本字段。我知道我有一个简单的错误，这是一个快速修复，感谢您的帮助！

[http://jsfiddle.net/Be9P6/](http://jsfiddle.net/Be9P6/)

HTML：

```
<form id="form">
Sub total: <input id="subtot" value="5" type="text"/><br/>
Tax %: <input id="tax" value="6" type="text" /><br/>
<input id="calc" type="submit" value="Calculate" />
<input id="reset" type="submit" value="Clear" />
</form> 
```

jQuery：

```
$(function () {
    $('#calc').click(function(){
        var taxf = ($('#tax').val() / 100);
        var tot = ($('#subtot').val() * (taxf + 1)).toFixed(2);
         alert("Your total is $" + tot);
         $('#form').submit();
    });
    addTax()
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:41:50.330

你需要改变一些东西。这是一个工作[jsFiddle](http://jsfiddle.net/Be9P6/1/)。

**我改变了什么：**

1.  您的重置按钮必须是[reset](http://www.echoecho.com/htmlforms13.htm)类型。
2.  取出硬编码值，因为将它们设置为默认值将使它们不符合被重置的条件。
3.  为您的函数调用和最后的右括号添加了分号，以获得良好的实践。

**HTML：**

```
<form id="form">
Sub total: <input id="subtot" value="" type="text"/><br/>
Tax %: <input id="tax" value="" type="text" /><br/>
<input id="calc" type="submit" value="Calculate" />
<input id="reset" type="reset" value="Reset" />
</form> 
```

**jQuery：**

```
$(function () {
    $('#calc').click(function(){
        var taxf = ($('#tax').val() / 100);
        var tot = ($('#subtot').val() * (taxf + 1)).toFixed(2);
         alert("Your total is $" + tot);
         $('#form').submit();
    });
    addTax();
}); 
```

# android - 未找到与给定名称匹配的资源（在“标题”处，值为“@string/action_settings”）

> ID：15648745
> 
> 赞同：12
> 
> 时间：2013-03-26T22:38:49.203
> 
> 标签：android, eclipse

所以我最近（就像今天最近）开始尝试在eclipse中工作。我一直在学习 android 开发者初学者课程，直到现在一切都很好。我已经开始构建一个简单的用户界面（[http://developer.android.com/training/basics/firstapp/building-ui.html#Button](http://developer.android.com/training/basics/firstapp/building-ui.html#Button)）并逐字逐句地做了所有事情，但是当我尝试运行它时说

> 找不到与给定名称匹配的资源（在“标题”处，值为“@string/action_settings”）。

我回去检查了一切，我按照他们的解释做了一切，它仍然这样做吗？我是个菜鸟，所以也许我只是错过了一些东西，但我不知道是什么。我重新启动了eclipse，它仍然无法运行该应用程序，并且第一百万次说我有一个错误。

这是我的设计表：

在布局activity_main.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"    
    xmlns:tools="http://schemas.android.com/tools"    
    android:layout_width="match_parent"    
    android:layout_height="match_parent"    
    android:orientation="horizontal">    
   <EditText android:id="@+id/edit_message"        
    android:layout_weight="1"        
    android:layout_width="0dp"        
    android:layout_height="wrap_content"        
    android:hint="@string/edit_message" />    
    <Button        
        android:layout_width="wrap_content"        
        android:layout_height="wrap_content"        
        android:text="@string/button_send" />
    </LinearLayout> 
```

在值 string.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <resources>

   <string name="app_name">My First App</string>    
   <string name="edit_message">Enter a message</string>    
   <string name="button_send">Send</string>    
   <string name="menu_settings">Settings</string>
   <string name="title_activity_main">MainActivity</string>
   </resources> 
```

这就是我搞砸的全部。我没看出问题？

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T23:12:00.313

哈 - 我正在做教程并且得到了同样的东西。您复制/粘贴了整个`strings.xml`文件，但该文件缺少应用所需的值。这是他们教程中的一个错误。

将此行添加回 strings.xml：

```
<string name="action_settings">something here</string> 
```

我把“something here”放在哪里，我不记得原文是什么了。

问题是 main.xml（在 res/menu 下），当然我们在教程中没有涉及到，它引用了字符串“action_settings”。当您从他们的示例中复制/粘贴整个 string.xml 时，这已被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-01T08:43:09.027

解决了：

添加 ..\res\values\strings.xml

```
<string name="action_settings">Action Settings</string> 
```

并更新 ..\src\com\example\helloworld\MainActivity.java 第 18 行，如下

getMenuInflater().inflate(R.menu.main **,** menu);

它对我有用。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-08T14:31:35.870

This error means a reference is being made about a recource that has yet to be defined. If you keep going with the tutorial, they actually say you will see this error! So keep going and you will learn how to fix it in the sections following.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T11:28:25.287

是的，就是：设置，这里可以用设置代替。经常出现的错误是你不小心删除了strings.xml中的语句。我也得到了同样的东西并解决了，直到我看到了提示。非常感谢 Kiirani 和 bigmike

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-09T19:01:48.140

我有同样的错误，但我注意到在 res/values/strings.xml 中标签不是以 `"<"`可能你有同样的错误开头

```
?xml version="1.0" encoding="utf-8"?>
<resources>

<string name="app_name">android app</string>
<string name="action_settings">Settings</string>

</resources> 
```

我的建议是从头开始制作你的项目

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-07T09:47:03.280

将此添加到您的 res/values/strings.xml

```
<string name="action_search">Search</string> 
```

# c# - C# 中的 SQL 选择语句

> ID：15648747
> 
> 赞同：-2
> 
> 时间：2013-03-26T22:38:57.110
> 
> 标签：c#

我在执行以下代码时遇到问题（*语法错误*）。请帮助我该怎么办。谢谢。

表列：`pId, pAltId, pMobile, pDate, pName`

变量：`argID, alt_ID, p_mobile, p_date, p_Name`

陈述：

```
String selectStr = "select * from " + thisTable + " where pId = '" + argID "+  OR  + 
pAltId = " + alt_ID "+ OR + pMobile =" + p_mobile "+ OR +  pDate =" + p_date "+ OR + 
pName = "+ p_Name "'"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:46:10.923

pId`+ " where pId = '" + argID "+`的值是否应该用单引号括起来？你有一个开始'，但没有结束。

此外，您似乎缺少许多双引号或将它们放在错误的位置，缺少许多空格，并且缺少 pName 的起始 '。尝试：

```
String selectStr = "select * from " + thisTable + " where pId = " + argID + " " 
    + OR + " pAltId = " + alt_ID + " " + OR + " pMobile = " + p_mobile + " " 
    + OR + " pDate = '" + p_date + "' " + OR + " pName = '" + p_Name + "'"; 
```

如果 pMobile 是一个字符串，那么您将需要更改`+ " pMobile = " + p_mobile + " "`为`+ " pMobile = '" + p_mobile + "' "`

# windows - cabal 安装 pcap windows 64bit

> ID：15648750
> 
> 赞同：2
> 
> 时间：2013-03-26T22:39:07.860
> 
> 标签：windows, haskell, cabal, pcap

我无法在 Windows 7（64 位）下安装 pcap 包。有人知道该怎么做吗？

如果我运行“cabal install pcap”，则会出现错误消息：

cabal.exe：缺少对外部库的依赖：

*   缺少（或错误）的头文件：pcap.h
*   缺少 C 库：pcap

我从这里下载了 WinPcap 4.1.2 Developers Pack：http: [//www.winpcap.org/devel.htm](http://www.winpcap.org/devel.htm)

从头开始安装 MinGW/MSYS。两种都试过了：预打包的 GHC 7-6.2 (ghc-7.6.2-x86_64-unknown-mingw32.tar.bz2) 并在 MinGW/MSYS 下自己编译。

似乎有多个问题：

1.  当我提供 pcap.h (--extra-include-dirs) 的包含路径时，我可以成功执行“cabal configure”，但在“cabal build”上失败，找不到“netinet/in.h”。

2.  如果我通过在 MSYS 下运行“mingw-get install msys-core-dev”来安装 netinet/in.h，那么我会收到大量不同类型的已定义消息。

3.  WinPCap Developers Pack 没有 libpcap.a（它有 libwpcap.a）。看起来它没有 64 位版本。我需要自己编译吗？

如果有人能建议 Windows 下的 cabal 包通常如何处理这种情况，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T18:47:33.377

> WinPCap Developers Pack 没有 libpcap.a（它有 libwpcap.a）。

正确的。无论好坏，虽然库在 UN*X 上称为“libpcap”，因此与 flag 链接`-lpcap`，但在 Windows 上称为“WinPcap”，`.a`文件称为“libwpcap.a”，这意味着如果您构建具有 UN*X 风格工具的应用程序，它将与 flag 链接`-lwpcap`。

所以，不，即使您在 Windows 上使用 UN*X 样式的文件，也不会使用与在 UN*X 上执行的相同标志来链接基于 pcap 的程序。

而且，是的，您必须自己编译一个 64 位版本；虽然他们提供了`.lib`用于 Microsoft 构建工具的 64 位版本的文件，但他们似乎没有提供`.a`用于更多类似 UN*X 的工具的 64 位版本的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T13:20:00.217

您是否尝试过让 netinet/in.h 可用？我记得这是用来生成 Haskell 等价物的。您可能不需要其他任何东西。警告：我上一次在这个包上工作是在 7 年前。

# android - 出于某种奇怪的原因将按钮转换为复选框？

> ID：15648754
> 
> 赞同：2
> 
> 时间：2013-03-26T22:39:27.907
> 
> 标签：android, android-layout, android-widget, android-ui, android-xml

我正在尝试使用每行底部的按钮获取 2 列复选框（不是表格布局）。麻烦的是，当我这样做时，按钮（在第一列中）看起来像是被自动转换为复选框。但是，当我将按钮放在第二列时，似乎没有发生任何不好的事情。它是给我问题的第一列

下面的设置不会崩溃（尽管两个按钮都在第二列而不是每列一个，这当然不是我想要的）。

```
<LinearLayout
       android:layout_width="match_parent"
       android:layout_height="0dp"
       android:orientation="horizontal"
       android:layout_weight="1.7"
       android:layout_marginTop="5dp"
       android:background="@drawable/table_layout_bg" 
       >

         <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:paddingTop="15dp"
            android:paddingBottom="20dp"
            android:paddingLeft="20dp">

            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/American_chkBX"  android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Asian_chkBX"     android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/BarPub_chkBX"    android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Breakfast_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Desert_chkBX"    android:layout_width="fill_parent"/>

            </LinearLayout>

            <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:paddingTop="15dp"
            android:paddingBottom="20dp">

            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/FastFood_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Healthy_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Italian_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/Mexican_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/SeaFood_chkBX" android:layout_width="fill_parent"/>   

            <Button
                android:id="@+id/select_none_btn"
                android:layout_height="wrap_content"
                android:layout_width="wrap_content"
                android:background="@drawable/select_none"
                />  

            <Button
                android:id="@+id/select_all_btn"
                android:layout_height="wrap_content"
                android:layout_width="wrap_content"
                android:background="@drawable/select_all"
                />
            </LinearLayout>

     </LinearLayout> 
```

这种备用设置使应用程序崩溃，并显示如下所示的错误日志（似乎按钮在没有我尝试的情况下被键入为复选框？？）。我发现这个错误真的很奇怪，我想知道是否有一个我不明白的 android/xml/UI 的基本部分导致这种情况发生。

```
<LinearLayout
       android:layout_width="match_parent"
       android:layout_height="0dp"
       android:orientation="horizontal"
       android:layout_weight="1.7"
       android:layout_marginTop="5dp"
       android:background="@drawable/table_layout_bg" 
       >

   <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:paddingTop="15dp"
            android:paddingBottom="20dp"
            android:paddingLeft="20dp">

            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/A_chkBX"  android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/B_chkBX"     android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/C_chkBX"    android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/D_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/E_chkBX"    android:layout_width="fill_parent"/>

            <Button
                android:id="@+id/select_all_btn"
                android:layout_height="wrap_content"
                android:layout_width="wrap_content"
                android:background="@drawable/select_all"
                />
            </LinearLayout>

            <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:paddingTop="15dp"
            android:paddingBottom="20dp">

            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/A1_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/B1_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/C1_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/D1_chkBX" android:layout_width="fill_parent"/>
            <CheckBox android:layout_height="wrap_content" android:layout_weight="1" android:id="@+id/E1_chkBX" android:layout_width="fill_parent"/>    

            <Button
                android:id="@+id/select_none_btn"
                android:layout_height="wrap_content"
                android:layout_width="wrap_content"
                android:background="@drawable/select_none"
                />  
            </LinearLayout>
 </LinearLayout> 
```

以下是生成的相关日志：

```
03-26 22:21:30.279: E/AndroidRuntime(1473): FATAL EXCEPTION: main
03-26 22:21:30.279: E/AndroidRuntime(1473): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.dumbasssoftware/com.dumbasssoftware.mainstuff.PickerViewActivity}: java.lang.ClassCastException: android.widget.Button cannot be cast to android.widget.CheckBox
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.os.Looper.loop(Looper.java:137)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread.main(ActivityThread.java:4424)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at java.lang.reflect.Method.invokeNative(Native Method)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at java.lang.reflect.Method.invoke(Method.java:511)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at dalvik.system.NativeStart.main(Native Method)
03-26 22:21:30.279: E/AndroidRuntime(1473): Caused by: java.lang.ClassCastException: android.widget.Button cannot be cast to android.widget.CheckBox
03-26 22:21:30.279: E/AndroidRuntime(1473):     at com.dumbasssoftware.mainstuff.PickerViewActivity.onCreate(PickerViewActivity.java:708)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.Activity.performCreate(Activity.java:4465)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
03-26 22:21:30.279: E/AndroidRuntime(1473):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
03-26 22:21:30.279: E/AndroidRuntime(1473):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:58:54.400

当以某些小部件保留其 ID 但更改类型（类）的方式更改布局 XML 文件时，可能会出现此问题。

我的猜测是`R`该类不正确，由 Eclipse/Android 插件自动重建。

修复是手动强制项目清理和重建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-10T21:21:30.793

使用“导入 com.rey.material.widget.CheckBox;” 而不是“导入 android.widget.CheckBox;” 它对我有用

# java - 我可以在 SWT FileDialog 过滤器中隐藏文件扩展名吗？

> ID：15648764
> 
> 赞同：2
> 
> 时间：2013-03-26T22:40:30.617
> 
> 标签：java, swt, eclipse-rcp

我有一个带有多个过滤器的 SWT FileDialog（样式：SWT.OPEN），每个过滤器都有多个文件扩展名。我想在应用程序识别的每个文件扩展名中包含一个“所有已知格式”过滤器。此列表很长，无法显示在屏幕上。在 Mac 上，FileDialog 将过滤器组合框的大小调整为最宽过滤器字符串的宽度。该控件不易使用，因为字符串太宽而无法在屏幕上显示，并且文本居中，因此您无法在开头阅读过滤器说明。

我可以在屏幕上绘制的 FileDialog 过滤器组合框中隐藏文件扩展名，但仍将扩展名与过滤器相关联吗？有没有人有其他建议？

**问题截图**

![Mac 上的所有已知格式过滤器](../Images/59ae0c502ea7db42547f9b71d535746e.png) ![应用程序识别的文件的可用过滤器](../Images/729686e8a0eed9a914af1b890e401a07.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:58:43.463

FileDialog 要求您提供描述列表和扩展列表以定义一组过滤器。我忽略了我的代码连接描述符和扩展列表以制作更具描述性的标签这一事实。这是在支持的文件类型数量很少的时候完成的。答案是提供一个条件，即扩展名列表不附加到描述“所有已知格式”中。好尴尬啊...

感谢那些回复的人。

# javascript - node-inspector 不调试 - 它立即停止执行

> ID：15648765
> 
> 赞同：2
> 
> 时间：2013-03-26T22:40:31.557
> 
> 标签：javascript, node.js, node-inspector

我正在运行 node.js v0.10.0。我也刚刚安装了节点检查器。我使用 --debug-brk 并测试我的 javascript（没什么花哨的 - 只有 1 个文件）：

```
console.log('here');
console.log('here');
console.log('here'); 
```

我连接到`http://127.0.0.1:8080?port=5858`，并看到我的脚本如上，执行在第一行停止。但是，当我单击继续（|> 图标）时，执行就会停止。它不会在控制台或命令窗口中记录“此处”。'step' 做同样的事情。

关于为什么我无法调试的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:03:22.843

正如@robertklep 所说，[https://github.com/dannycoates/node-inspector/issues/152](https://github.com/dannycoates/node-inspector/issues/152)上记录了一个解决方案的问题。上次签到是在 10 个月前，因此似乎不会很快修复。分叉回购，然后：

```
npm install -g . 
```

然后正常运行：`node-inspector`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-27T17:45:58.090

如果您使用 adblock 左右，也会出现一些问题

# filtering - 查找设备移动的速度

> ID：15648767
> 
> 赞同：0
> 
> 时间：2013-03-26T22:40:56.037
> 
> 标签：filtering, accelerometer, android-sensors, calibration, drift

我需要找到设备（三星 Galaxy s3）的速度。我现在已经阅读了很多关于它的 stackoverflow 问题，但对于我应该使用什么仍然感到困惑。到目前为止我的观察：

1）有人这样做是[为了](http://maephv.blogspot.co.uk/2011/10/android-computing-speed-and-distance.html)从加速度计传感器的数据中找到速度。但在我的情况下，设备的运动不会有恒定的斜率或直线轨迹。

2）集成会产生很大的漂移。

3) 可以使用卡尔曼滤波，但很难实现且占用 CPU

4) 可以使用互补滤波器，但据我了解，这仅在加速度计与陀螺仪一起用于寻找角度时才有意义。就我而言，我需要找到速度

5) 使用 GPS 的 getSpeed()。但我猜它只对检测大速度值有用，例如移动的汽车，因此对我的目的不够敏感。

请建议我从某个地方开始。

PS如果你想知道我需要什么设备的速度是我需要根据设备的移动速度增加/减少渲染速率。

# javascript - 如何获得创建的元素（按钮）来运行功能？

> ID：15648770
> 
> 赞同：0
> 
> 时间：2013-03-26T22:41:11.437
> 
> 标签：javascript

这是我用来创建按钮的代码：

```
var dfom = document.createElement('div');
dfom.setAttribute("id","options");
dfom.innerHTML = "<input type=\"button\" value=\"Say HI\" onclick=\get()\ />";
dfom.style.padding = '10px';
document.body.insertBefore(dfom, document.body.firstChild); 
```

按钮创建得很好；它显示正确。所以为了测试它，我这样做了：

```
function get()
{
alert("HI");
} 
```

但是，当我单击按钮时，什么也没有发生。请问有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:53:11.483

如果你想编写正确的 JavaScript 代码，那么你应该这样做：

```
var dfom = document.createElement("div"),
    button = document.createElement("input");

button.type = "button";
button.value = "Say HI";
button.addEventListener("click", function() {
    alert("HI");
}, false);

dfom.id = "options";
dfom.style.padding = "10px";
dfom.appendChild(button);

document.body.insertBefore(dfom, document.body.firstChild); 
```

**演示：http:** [//jsfiddle.net/TKdYh/](http://jsfiddle.net/TKdYh/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:57:18.503

`\`应该是`\"`around `get()`，但还有更多考虑：即该函数`get`实际上必须在外部`onload`或另一个回调中定义，因为它需要全局可用。你需要一个类似这样的设置：

[http://jsfiddle.net/CZ2y4/](http://jsfiddle.net/CZ2y4/)

...它`get`在回调之外定义`onLoad`，使其可用于`onclick`.

此外，使用标准事件绑定而不是`onclick`：

```
dfom.innerHTML = "<input type=\"button\" value=\"Say HI\">";
dfom.firstChild.addEventListener('click', get); 
```

[http://jsfiddle.net/CZ2y4/1/](http://jsfiddle.net/CZ2y4/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:42:40.687

函数名也应该用引号括起来，即`onClick="get();"`. 还可以在有时间的时候阅读事件监听器，例如[此处](https://stackoverflow.com/questions/6348494/addeventlistener-vs-onclick)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T23:02:36.803

以下对我有用：

```
window.onload = function() {
  var dfom = document.createElement('div');
  dfom.id = "options";
  dfom.innerHTML = '<input type="button" value="Say HI" onclick="get()">';
  dfom.style.padding = '10px';
  document.body.insertBefore(dfom, document.body.children[0]);
}

function get() {
  alert("HI");
} 
```

需要注意的一些事项：

1.  对于标准的 DOM 属性，通常最好只设置属性，不要使用 setAttribute，因为它的实现不一致。

2.  对脚本使用单引号和对 makrup 使用双引号会更清楚，这样您就不必使用尽可能多的反斜杠来引用引号

3.  [严格来说，HTML 属性值只有在它们包含某些字符](http://www.w3.org/TR/html4/intro/sgmltut.html#attributes)时才需要被引用。将它们全部引用而不是记住那组字符是什么更容易。浏览器也非常宽容，因此您可以摆脱应该在某些浏览器中引用但在其他浏览器中不应该引用的未引用字符。

# r - 开发包时如何防止“r'library'或'require'调用未声明”警告？

> ID：15648772
> 
> 赞同：46
> 
> 时间：2013-03-26T22:41:13.107
> 
> 标签：r

我正在开发一个依赖于 package 的包`foo`，并且在我的包代码中调用了一个从`foo`. 我已经在声明中包含了包名`NAMESPACE`，`import(foo)`也在文件的`Imports:`行下`DESCRIPTION`。但是，我在运行时收到以下警告`R CMD check`：

```
r 'library' or 'require' calls not declared from: 'foo' 
```

我错过了什么？

[在使用 .onLoad 加载依赖的包中](https://stackoverflow.com/questions/5294679/loading-depending-packages-using-onload)有一个类似的问题，但它似乎没有讨论这个特定的警告。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-03-26T22:41:13.107

最有可能的候选者是您的函数包含对`require(<pkg>)`or的不必要调用`library(<pkg>)`。错误消息有点误导 - 它告诉您您已经在代码中放置`require`或`library`调用，但实际上并没有（正确）在`DESCRIPTION`文件中声明这些调用。

如果您打算在自己的包中使用这些包中的代码，那么您不需要这些`library`/`require`调用；相反，您需要在文件中正确声明您正在使用这些包（以及如何使用它们）`DESCRIPTION`。

最有可能的是，您想要“导入”包并使其部分或全部导出的函数/符号可用于您的包。您可以将此类包添加到文件中的`Imports:`字段`DESCRIPTION`- 例如

```
Imports: <pkg> 
```

同样，通过在文件中写入来声明您要使用该包中的*所有*导出符号，`NAMESPACE`

```
import(<pkg>) 
```

通过这样做，`<pkg>`的命名空间中的所有函数都会自动可用，因此不需要`require`在代码中的任何位置使用该包。

在包的上下文中， 的主要用途`require`是您希望仅有条件地提供的功能。例如，假设您编写了一个函数来处理一个非常特殊的绘图方法，该方法需要`foo`，但`foo`在您的包中不需要。因此，如果您想包含有条件地依赖于 package 的代码`foo`，您可以编写如下形式的内容：

```
if (require("foo")) {
  #do stuff
} 
```

然后你可以包含`foo`在`DESCRIPTION`下面`Suggests:`而不是`Imports:`. 另一个示例是用于制作小插图的包，但您的包的用户从不要求该包。

总之：如果您导入一个包只是为了使用在该包的命名空间中导出的函数，那么您不需要在包代码中的任何地方使用它`library`。`require`

编辑：在较新版本的 R 中，`R CMD check`如果您使用`require`，可能会发出警告，而是建议您使用`requireNamespace`. 在这种情况下，您可以遵循以下模式：

```
## Use the 'bar' function from package 'foo'
if (requireNamespace("foo", quietly = TRUE)) {
    foo::bar()
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-08-22T19:31:19.460

仅供参考，使用以下方式导入包的所有功能（当您不使用它们时）是一种不好的形式：

```
@import package 
```

最好只是

```
package::thisOne() 
```

当您需要时，或

```
@importFrom package thisOne 
```

如果您重复使用特定功能

# karma-runner - 如何设置 Karma runner 代码覆盖率？

> ID：15648775
> 
> 赞同：25
> 
> 时间：2013-03-26T22:41:21.420
> 
> 标签：karma-runner

我试图让 Karma runner 在 Jenkins 构建期间生成 cobertura 格式的代码覆盖率报告。我可以让它生成一个coverage.xml 文件，但它实际上没有任何覆盖数据。看起来（使用`LOG_DEBUG`）覆盖预处理器没有运行。

我`karma.conf.js`文件中的相关部分是：

```
files = [
  JASMINE,
  JASMINE_ADAPTER,
  'app/components/angular/angular.js',
  'app/components/angular-mocks/angular-mocks.js',
  'tmp/scripts/**/*.js',
  'tmp/spec/**/*.js'
];

preprocessors = {
  'tmp/scripts/**/*.js': 'coverage'
};

// test results reporter to use
// possible values: 'dots', 'progress', 'junit'
reporters = ['dots', 'junit', 'coverage'];

junitReporter = {
  outputFile: 'test-results.xml'
};

coverageReporter = {
  type: 'cobertura',
  dir: 'coverage/',
  file: 'coverage.xml'
}; 
```

（junit 报告生成良好。）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-26T22:41:21.420

显然，[业力代码覆盖率文档](http://karma-runner.github.com/0.8/config/coverage.html)比我想象的更字面。将我的`preprocessors`配置更改为

```
preprocessors = {
  '**/tmp/scripts/**/*.js': 'coverage'
}; 
```

（注意前面的`**/`）成功了。我不确定为什么`files`数组和`preprocessors`对象（`'tmp/scripts/**/*.js'`vs. `'**/tmp/scripts/**/*.js'`）的语法不同。

# .net - 返回第二低值的迭代过程

> ID：15648777
> 
> 赞同：1
> 
> 时间：2013-03-26T22:41:23.407
> 
> 标签：.net, vb.net, iteration, nearest-neighbor

我对 vb.net 相当陌生，经过几个小时的搜索后找不到任何具体的帮助。

我有一个包含三列的数据点表，第 1 列是“点 id”，第 2 列是“x 坐标”，第 3 列是“y 坐标”。我需要添加第四列，然后用迭代过程中的第二低值填充它。

迭代过程是找到从该点到其他点的距离，并返回第二低的值，因为最小值将为 0（到自身的距离）。点 1 和点 2 之间的距离的数学公式是 sqrt(((x2-x1) *(x2-x1))+((y2-y1)* (y2-y1)))。

我正在努力在迭代过程中执行迭代过程以重新调整单个值。

任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:20:58.153

遍历表中的行。然后对于每一行再次遍历表中的行。但是，当您到达当前主要迭代所在的行时，您可以跳过该行并继续前进。此外，由于距离是点对之间的距离，因此您只需要遍历表中的一半行即可获得所有距离。

如果您发布有关您如何实现此功能的更多详细信息，则可能可以通过一些代码来帮助您，但是就像现在一样，您甚至不说您拥有什么样的表或您的程序是如何设置的，所以很难更具体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T00:41:27.920

这是一种可能的解决方案[未经测试]。该`AddNearestColumn()`方法遍历每一行并获取到表中其他点的距离列表。然后它遍历列表并获取最小值。您应该使用`distances.Sort()`in`AddNearestColumn()` 而不是手动循环，但我会把它留给您。:-)

```
Public Sub ProcessTable(table As Data.DataTable)
    AddNearestColumn(table)
End Sub

Private Sub AddNearestColumn(table As Data.DataTable)
    table.Columns.Add("Nearest", GetType(Double))
    For Each r As Data.DataRow In table.Rows
        Dim distances As List(Of Double) = GetDistancesFromPoint(table, r)
        Dim nearest As Double = Double.MaxValue
        For Each distance As Double In distances
            If (distance < nearest) Then nearest = distance
        Next
        r.Item("Nearest") = nearest
    Next
End Sub

Private Function GetDistancesFromPoint(table As Data.DataTable, referenceRow As Data.DataRow) As List(Of Double)
    Dim output As New List(Of Double)
    For Each r As Data.DataRow In table.Rows
        Dim referenceId As String = CStr(referenceRow.Item("ID"))
        Dim rowId As String = CStr(r.Item("ID"))
        If (rowId = referenceId) Then Continue For
        Dim x1 As Double = Convert.ToDouble(referenceRow.Item("X"))
        Dim y1 As Double = Convert.ToDouble(referenceRow.Item("Y"))
        Dim x2 As Double = Convert.ToDouble(r.Item("X"))
        Dim y2 As Double = Convert.ToDouble(r.Item("Y"))
        output.Add(Math.Sqrt(((x2 - x1) * (x2 - x1)) + ((y2 - y1) * (y2 - y1))))
    Next
    Return output
End Function 
```

# java - Java split() 检查索引是否等于一个值

> ID：15648778
> 
> 赞同：0
> 
> 时间：2013-03-26T22:41:24.610
> 
> 标签：java, split

我有一个以字符串形式传递的函数。从那我分割字符串

```
String[] info = s.split("\\s+"); 
```

然后我想看看第一个索引是否是加号 (+)。如果我输入一个字符串：+其他东西它声称+！=+

```
System.out.println("Check if "+ info[0]+ " = +");
if(info[0]=="+") {
    System.out.println("yes");
} else
    System.out.println("no"); 
```

这是我得到的输出：

```
Interp> + 
Check if + = + 
no 
```

有谁知道这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:44:19.733

它应该是：

```
if(info.length > 0 && "+".equals(info[0])) { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T22:44:14.917

比较`String`s 时，始终使用`String.equals(String str)`. == 将比较字符串以获得相同的内存标识，`String.equals()`将比较相同的内容。

`if(info[0].equals("+")) { do stuff.. }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:44:18.557

为了比较两个`Strings`，您应该始终使用`myString.equals(otherstring);` 在您的情况下，这可能是

```
if(info[0].equalsIgnoreCase("+") {
    System.out.println("yes");
} else
    System.out.println("no");
} 
```

这些是字符串的可能性：

*   `string1.equals(string2)` -> 返回布尔值
*   `string1.equalsIgnoreCase(string2)` -> 返回布尔值
*   `string1.compareTo(string2)`->如果 string1 按字母顺序排在 string2 之前，则返回**-1** ，如果两个字符串相等则返回**0** ，如果 string2 按字母顺序排在 string1 之前，则返回**+1**

解释：`==`运算符比较两个字符串的内存引用而不是字符串的内容。

# linux - 如何使 dlerror() 报告 *all* 来自 dlopen() 无法加载共享库的未解析符号？

> ID：15648781
> 
> 赞同：1
> 
> 时间：2013-03-26T22:41:41.830
> 
> 标签：linux, dlopen

我正在尝试报告共享库上对 dlopen() 的失败调用中的所有未解析符号。我已经尝试将 RTLD_LAZY 和 RTLD_NOW 作为 dlopen 调用的标志。我知道共享库缺少 10 个符号（即，如果您执行静态链接 g++ blah blah：链接将失败，缺少 10 个符号）。我想让 dlerror() 告诉我加载失败期间丢失的所有 10 个符号。

有谁知道如何诱使这种情况发生？我从手册页中看到 dlerror() 返回最后一个错误；所以也许我问得太多了，但想知道是否有人知道。

非常感谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T04:36:34.707

> 我想让 dlerror() 告诉我加载失败期间丢失的所有 10 个符号。

你不能：加载器在发现库无法加载时立即报告错误（即，*一旦*它发现第一个丢失的符号）。装载机没有必要再往前走，所以它没有。

`ldd -r`但是，您可以通过使用`LD_PRELOAD`和来模拟什么`LD_TRACE_LOADED_OBJECTS`，以获得完整的答案。例子：

```
$ cat main.c
#include <dlfcn.h>
#include <stdio.h>

int main()
{
  void *p = dlopen("./foo.so", RTLD_NOW);
  if (p == NULL) {
    printf("%s\n", dlerror());
    return 1;
  }
  return 0;
}

$ cat foo.c
int bar(), baz();  // not defined anywhere
int foo() {
  return bar() + baz();
}

$ gcc main.c -ldl; gcc -fPIC -shared -o foo.so foo.c

$ ./a.out
./foo.so: undefined symbol: baz  # only the first symbol is reported

$ ldd -r ./a.out
    linux-vdso.so.1 =>  (0x00007fff52ddc000)
    libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f158e48d000)
    libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f158e0ce000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f158e6b2000) 
```

那是行不通的，因为您的程序从未执行过，因此从未加载过`foo.so`。但`LD_PRELOAD`为了救援：

```
$ LD_BIND_NOW=1 LD_WARN=1 LD_TRACE_LOADED_OBJECTS=1 LD_PRELOAD=./foo.so ./a.out
    linux-vdso.so.1 =>  (0x00007fff3c1b6000)
    ./foo.so (0x00007ffd33212000)
    libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007ffd3300e000)
    libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007ffd32c4f000)
    /lib64/ld-linux-x86-64.so.2 (0x00007ffd33414000)
undefined symbol: baz   (./foo.so)
undefined symbol: bar   (./foo.so) 
```

瞧：现在报告了所有未解析的符号。

# multithreading - 从多个进程更新 SQLAlchemy 字段线程安全

> ID：15648782
> 
> 赞同：0
> 
> 时间：2013-03-26T22:41:42.343
> 
> 标签：multithreading, sqlalchemy, distributed

我有一个描述在分布式系统上处理的作业的数据库表。所以整个工作被分成许多小部分，每个部分都在不同的机器上在它自己的环境中处理。

我想保留每个进程如何运行的简单日志，因此每个节点都使用 SQLAlchemy 连接到同一个作业表，并将它们的作业编号和状态附加到 UnicodeText 字段的末尾。

我希望看到类似的东西：

```
Part 1: complete<br/>
Part 2: complete<br/>
Part 3: error<br/>
Part 4: complete<br/>
...etc 
```

当它完成处理零件时，我只是`process.log += "Part 1: complete\n"`在每个节点上做一个。然后一个`session.commit()`

我知道零件编号会乱序，这对我的目的来说很好，但是发生的事情是我只得到了全部零件的几个条目。我认为这是因为许多作业同时完成并且执行附加 += 不是线程安全的。

我对会话不是很好，所以我不知道配置它的所有技巧。我确实尝试使用 NullPool 无济于事。

有没有办法让附加操作线程在这样的分布式环境中安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-23T22:18:26.727

如果您想*并行更新一个 - 我假设 - 文本字段，*这就是它在内部进行的方式：每个实例在实例化对象时读取原始字段（`sessionmaker`负责这个，因此对于每个线程都有一个数据实例-控股实体）并将其部分附加到*其*字段版本上。然后提交它自己的实例。结果你得到的是一个 - 完全线程安全的 - 最后一个版本。最后写入的对象获胜。

如果您希望使用*此数据结构将**所有*数据提交到同一字段，则必须放弃线程的任何好处，并同步您对实体实例的读取和写入，以便每个线程等待读取数据（例如append) 直到它的前任提交之后。

 *你*应*该做什么：改变你的数据结构以*利用*SQL 数据库的好处，并让*每个*更新都有自己的 SQL 记录。*

# c - C中char *的处理列表？

> ID：15648785
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:41:50.133
> 
> 标签：c, lisp

我需要对 C 中的长字符串列表执行各种功能。

```
char *list1[] = {"one","two","three", "four","five","six"}; 
```

最初，我正在尝试实现简单的 car/cdr 函数，但是已经有一段时间了，我忘记了在 C 中管理 char *[] 列表的最佳方法。 cdr 应该返回 char * 列表的其余部分在一个新的 malloc'ed 数组中。就我而言，它是“二”、“三”、“四”、“五”、“六”。未知的列表大小使这一点复杂化。也许，我应该使用具有列表长度的结构？

```
char **cdr(char *aList[]) {
  /*
   malloc space for n-1 char*
  */
  return aList; // Return everything to test
} 
```

我将有其他功能，例如，返回具有两个连续元音的所有单词的列表，或者超过 10 个字符的单词。我永远不想更改字符串（即它们是不可变的）。我将在 cdr 之类的函数中分配内存，因此在获取结果并将它们传递给其他函数时，我需要跟踪它。无论如何，如果有人能让我开始，将不胜感激。谢谢。

```
char *list1[] = {"one","two","three", "four","five","six"}; // Short list

char **cdr(char *aList[]) {
  /*
   malloc space for n-1 char*
  */
  return aList; // Return everything to test
}

char *car(char *aList[]) {
  return aList[0];
}

int main() {
  const char *first;
  char *rest[];

  int len = sizeof(list1)/sizeof(char*);
  printf("list1 len=%d\n", len);

  first = car(list1);
  rest = cdr(list1);

  printf("%s\n", first);
  len = sizeof(rest)/sizeof(char*);
  printf("rest len=%d\n", len);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:10:00.697

列表大小未知与其说“复杂化”不如说“使它不可能”。如果您不想传递显式长度，则需要使用 NULL 值作为终止符。

```
int length(const char* strings[]) {
    int rv = 0;
    while( strings[rv] ) ++rv;
    return rv;
}

int main(int argc, char *argv[]) {
    printf( "Note that this technique is also used in argv: %p\n", argv[argc] );

    const *list[] = { "+", "42", "30", NULL };
    printf( "Length: %d\n", length( list ) );

    return 0;
} 
```

在您的其他函数中使用这样的长度（），您应该能够知道要分配的适当内存量。（请记住，您需要为 NULL 的额外指针分配空间！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T23:10:05.123

通常，您要查找的列表不是作为数组实现的，而是作为链表实现的。它们最初实现的方式甚至是这些操作被称为“car”和“cdr”的原因（参见：[http](http://en.wikipedia.org/wiki/CAR_and_CDR) ://en.wikipedia.org/wiki/CAR_and_CDR ）。

以这种方式实现的列表仅由包含两个指针的元素组成。因此，对于您的示例，这样的列表如下所示：

```
 +-----+-----+    +-----+-----+    +-----+-----+         +-----+-----+   
 | car | cdr | -> | car | cdr | -> | car | cdr | -> .... | car | cdr | -> NIL
 +-----+-----+    +-----+-----+    +-----+-----+         +-----+-----+
   |                 |                |                     |
   v                 v                v                     v
 "one"             "two"            "three"               "six" 
```

为了在 C 中达到相同的效果，您宁愿对列表的元素使用如下结构：

```
struct _Element {
  struct _Element *cdr;
  void  *car;
}; 
```

如果您仍想继续使用数组方法，最好查看“svk”的帖子。使用 NULL 终止的数组而不是单独跟踪长度可能是您建议的版本的有趣替代方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T13:27:34.550

C 中的所有分配和释放都是浪费和容易出错的。为什么不只返回实际的字符串？

```
char * car (char ** list) {
    return list[0];
}

char ** cdr (char ** list) {
    return list + 1;
} 
```

# php - php反序列化字符串

> ID：15648788
> 
> 赞同：0
> 
> 时间：2013-03-26T22:41:56.860
> 
> 标签：php, arrays, serialization

当我这样做时，`var_dump($string);`我得到

```
string(894) "[{"id":"11","value":"Gotowy do u\u017cytku"},{"id":"12","value":"Na 4 k\u00f3\u0142kach"},{"id":"13","value":"20 minut - rozgrzany do pracy"},{"id":"14","value":"Pow. u\u017cytkowa 108 cm2"},{"id":"15","value":"Piec i grill w jednym"},{"id":"16","value":["tekst","\/images\/alfa\/domowa\/forninox\/1.jpg","lightbox"]},{"id":"17","value":["tekst","\/images\/alfa\/domowa\/forninox\/1.jpg","lightbox"]},{"id":"18","value":["tekst","\/images\/alfa\/domowa\/forninox\/3.jpg","lightbox"]},{"id":"19","value":["tekst","\/images\/alfa\/domowa\/forninox\/2.jpg","lightbox"]},{"id":"20","value":"cm 127"},{"id":"21","value":"cm 189"},{"id":"22","value":"cm2 108"},{"id":"23","value":"Kg 340"},{"id":"24","value":"\u00a6 cm 25\/20"},{"id":"25","value":"Mat. ceramiczny"},{"id":"26","value":"Stal nierdzewna"},{"id":"27","value":"W\u0142\. ceramiczne"},{"id":"28","value":"min 20"},{"id":"29","value":"7"}]" 
```

我将这个字符串放入数组中，所以我进行反序列化，如下所示：

```
$a = unserialize($string); 
var_dump($a); 
```

但在输出中我得到：

```
bool(false) 
```

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:43:28.560

你有一个 json 字符串。你想用

```
$arr = json_decode($string, TRUE); 
```

将其反序列化为关联数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:43:30.793

它不是序列化的，而是 json 编码的。利用：

```
$decoded = json_decode($string); 
```

# sql - 在指定的记录之后查找以前的记录并加入它们

> ID：15648790
> 
> 赞同：3
> 
> 时间：2013-03-26T22:42:01.953
> 
> 标签：sql, sql-server, tsql

我们有这张表，其中记录了玩家的动作。我想知道人们在哪里购买他们的装备（`Item`弓或剑）。该设备可以在商店或拍卖中购买（地点可以在`Action`栏中找到）。所以当玩家购买物品时，我们需要找到`Action` 商店或拍卖（取决于在购买物品之前最后出现哪一个）

```
**User       Time        Action         Item** 
  1          12:00       Auction
  2          12:01       Shop
  3          12:04       Shop
  4          12:09       Shop        
  4          12:15       Buy             Bow
  2          12:15       Auction
  2          12:19       Auction
  1          12:25       Chat    
  4          12:33       Auction         
  3          12:47       Chat
  1          12:47       Buy             Sword
  2          12:47       Buy             Bow
  3          12:50       Buy             Sword
  4          12:52       Buy             Bow
  3          12:56       Buy             Bow 
```

结果应该是

```
**Time        Item         Place**
 12:15        Bow          Shop
 12:47        Sword        Auction
 12:47        Bow          Auction
 12:50        Sword        Shop
 12:52        Bow          Auction
 12:56        Bow          Shop 
```

我想我可能知道如何在 mssql 中使用交叉应用来解决它，但是没有它是否可以解决它？我可能还必须在配置单元中使用查询。我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:19:05.573

你可能想要这样的东西（我猜你可能也喜欢那里的用户，嗯？）

**感谢蒂姆的建议，更新了**答案****

 **```
with p as    -- pick purchases
(SELECT [user], [time] purchased, [item]
   FROM actions 
   WHERE [action] = 'Buy'
), e as      -- pick entrances where something can be bought
(SELECT [user], [time] entered, [action] place
   FROM actions
   WHERE [action] IN ('Auction', 'Shop')
), j as      -- join purchases with all prior entrances
(SELECT p.[user], p.[purchased], p.[item],
        e.[entered], e.[place]
   FROM p
   JOIN e   on p.[user]=e.[user]
           and p.[purchased]>=e.[entered]
), r as      -- rank entrance closeness to purchase
(SELECT *, row_number() over( partition by [user],[purchased],[item] 
                              order by [entered] desc ) as rnk
   FROM j
)            -- select only where entrance is the closest
SELECT [user],[purchased],[item],[place]
  FROM r
  WHERE rnk = 1
  order by [user],[purchased],[item] 
```

*警告：* TSQL 不是我的母语；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:33:03.963

尝试：

```
select time, item, (
  select top 1 Actions.action
  from   Actions
  where  Actions.[User] = buy.[user] and
         Actions.action in ('shop', 'auction') and
         Actions.time < buy.time
  order by Actions.time desc
                   )
from Actions as buy
where action = 'buy' 
```

感谢 Tim Schmelter 提供的 sqlfiddle 测试（很棒的工具，我不知道！！）**

# javascript - 无法获取我的 javascript 函数？

> ID：15648792
> 
> 赞同：0
> 
> 时间：2013-03-26T22:42:25.643
> 
> 标签：javascript

我有这个简单的格式化程序功能：

```
function Forma(x, y): {
var handler = function(e) {
    document.getElementById(x).innerHTML = Number(this.value * 100).toLocaleString() + " Centimes";
};
document.getElementById(y).onchange = handler;
document.getElementById(y).onkeyup = handler;
} 
```

并将其命名为`formatter.js`

现在，我尝试在 HTML 页面上使用它，在开头加载它：

```
<script src="path/to/formatter.js"></script> 
```

它加载它确定！但是当我放置它时：

```
<input id="price">
<script>
Forma("hhh", "price");
</script>
<h1 id="hhh" > </h1> 
```

控制台说`Forma`没有定义！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:43:27.827

问题是函数声明中的冒号

```
function Forma(x, y) {
    ...
}

// or
Forma = function(x, y) {
    ...
} 
```

应该可以正常工作

# ruby - 用于生产的 config.ru if 语句

> ID：15648800
> 
> 赞同：3
> 
> 时间：2013-03-26T22:43:07.230
> 
> 标签：ruby, rubygems, bundler, rack

在我的 config.ru 中，我想设置一个代码块，该代码块将根据环境运行特定代码。

我尝试了一些代码，但没有任何成功。有什么建议么？

```
if ENV['RAKE_ENV'].to_s.eql?('development')
  Bundler.require(:default, :development)
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:59:50.713

我相信你想检查`ENV['RACK_ENV']`而不是`ENV['RAKE_ENV']`.

# ios - Xcode 编译目标设置

> ID：15648801
> 
> 赞同：0
> 
> 时间：2013-03-26T22:43:08.410
> 
> 标签：ios, xcode

如果我们想针对特定的 iOS 版本编译和链接应用程序，我们必须在 Xcode 中的多少地方更改设置？到目前为止，我发现了三个需要更改的地方：

1.  [项目] / 信息 / iOS 部署目标
2.  [目标] / iOS 应用程序目标 / 部署目标
3.  Interface Builder 文档/文档版本控制/部署

例如，我一直在针对 SDK 6.1 进行开发，但可能会切换到 6.0 以支持更多用户。

# jquery - jquery：遍历表比较硬编码日期与 Date.today() 然后删除日期 感谢大家考虑我的新手问题。我正在使用 jQuery 遍历一个表并在一个数组中捕获所有硬编码的日期。我将这些日期与 Date.today(); 使用 .isAfter() 函数。如果硬编码的日期是过去的，它应该得到一个 .css("display", "none"); 问问题 问问题 2013-03-26T22:44:00.623 786 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 感谢大家考虑我的新手问题。我正在使用 jQuery 遍历一个表并在一个数组中捕获所有硬编码的日期。我将这些日期与 Date.today(); 使用 .isAfter() 函数。如果硬编码的日期是过去的，它应该得到一个 .css("display", "none");

| Mar 27 2013 | the Saloon | Atlanta, Ga | $20 (2 passes) | button to purchase tix |  |
| ... date2 .. |
| ... date3 .. |
| ... date4 ect .. |

 循环逻辑似乎可以正常运行，但是添加样式 display:none 的 if(statement) 很糟糕。任何帮助将不胜感激。 我在这里可能弄错了，但我相信最好的方法是利用 Model::afterFind() 方法。 $type) { foreach ($type['Collector'] as $collector) { // Assuming you built the associations/tables/etc. correctly and are following cake conventions. if (empty($collector['Place'])) { unset($results[$key]); continue 2; } } } } } ?> Type->contain(array( 'Collector' => array( 'Place' ) )); $types = $this->Type->find('all'); ?> jquerydatejs 4 4 回答 4 This answer is useful 0 当您尝试隐藏单行时，您只需隐藏所有行 - $('.gig') 选择所有行，而不仅仅是您认为应该的行。 将您的逻辑移动到您测试日期的循环中。大致是这样（我尽可能少地更改您的代码，可能仍然无法正常工作，尚未检查）： var now = Date.today(); // create current date $('.gigDate').each(function (i, e) { //adds hardcoded dates to array var current = ($(e).text()); var singleDate = Date.parse(current); //parse to milliseconds var compare = now.isAfter(singleDate); //compare to today's date if(compare){ // we want to hide the parent of td, not the td: $(e).parent().css("display", "none"); //hide //if in the past } }); 于 2013-03-26T22:54:08.030 回答 This answer is useful 0 你有什么理由过滤客户端吗？似乎效率低下。你的 html 是硬编码的还是你有服务器端脚本？你真的应该过滤你的结果预渲染，除非没有其他选择。 于 2013-03-26T22:50:39.423 回答 This answer is useful 0 我不知道这个 isAfter 函数，但你可以直接比较日期。我想那会更容易。 于 2013-03-26T22:48:06.900 回答 This answer is useful 0 即使比较有效，你也会用“演出”类隐藏任何东西。 您可以通过从您的字符串创建一个新的 Date(xxxxxxx) 来简化此操作。然后您可以使用“<”运算符进行比较。 假设您的演出日期与您的活动日期格式相同： var now = new Date(); // create current date $('.gigDate').each(function (i, e) { ele = $(this).html(); gigDate = new Date(ele); if (gigDate <now){ 1="" 2="" 3="" 8="" $(this).hide();="" }="" });="" 你可以看到它在这里工作：="" http:="" jsfiddle.net="" skelly="" vzh8u="" 于="" 2013-03-26t23:04:24.450="" 回答="" related="" javascript="" -="" jquery="" 带有一些数字的表格计算的奇怪舍入错误="" java="" 我可以在="" apache="" commons="" config="" 中同时使用数组和非数组吗？="" powershell="" powershell：从="" receive-job="" 获取输出="" excel="" 条件插值="" php="" facebook="" 评论格式="" eclipse="" 如何从="" svn="" 存储库中签出="" maven="" 项目="" 收集和内存优化="" c++="" 修剪递归搜索路径="" objective-c="" 提高快速枚举性能="" 将错误代码枚举与="" std::error_code="" 进行比较="" reference="" php × 1429865="" c="" c++ × 756500="" nginx × 49975="" mongodb × 159057="" mybatis × 3233="" anaconda × 13410="" pycharm × 14671="" python × 1902243="" vscode × 56040="" docker × 110988="" github × 49000="" flask × 49129="" ffmpeg × 24037="" jmeter × 16910="" matplotlib × 63493="" bootstrap × 54641<="" h1="">> ID：15648810
> 
> 赞同：2
> 
> 时间：
> 
> 标签：jquery, datejs

感谢大家考虑我的新手问题。我正在使用 jQuery 遍历一个表并在一个数组中捕获所有硬编码的日期。我将这些日期与 Date.today(); 使用 .isAfter() 函数。如果硬编码的日期是过去的，它应该得到一个 .css("display", "none");

```
<table>
    <html>
      <table>
        <tr class="gig">

           <td class="gigDate">Mar 27 2013</td>
           <td>the Saloon</td>
           <td>Atlanta, Ga</td>
           <td>$20 (2 passes)</td>
            <td>button to purchase tix<td>
        </tr>

        <tr class="gig"><td class="gigDate"> ... date2 ..</td></tr>
        <tr class="gig"><td class="gigDate"> ... date3 ..</td></tr>
        <tr class="gig"><td class="gigDate"> ... date4 ect ..</td></tr>
  </table>

<script type="text/javascript">
$("document").ready( function() {

var stringDate = []; //create array to hold elements

var now = Date.today(); // create current date

$('.gigDate').each(function (i, e) {   //adds hardcoded dates to array
stringDate.push($(e).text());
});

for(var y = 0; y < stringDate.length; y++){
var singleDate =  Date.parse(stringDate[y]);  //parse to milliseconds
var compare = now.isAfter(singleDate);        //compare to today's date

if(compare){
    $('.gig').css("display", "none");   //hide <tr class="gig"> 
                                      //if in the past
      }
}    
 });
</script> 
```

循环逻辑似乎可以正常运行，但是添加样式 display:none 的 if(statement) 很糟糕。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:54:08.030

当您尝试隐藏单行时，您只需隐藏所有行 - $('.gig') 选择所有行，而不仅仅是您认为应该的行。

将您的逻辑移动到您测试日期的循环中。大致是这样（我尽可能少地更改您的代码，可能仍然无法正常工作，尚未检查）：

```
var now = Date.today(); // create current date

$('.gigDate').each(function (i, e) {   //adds hardcoded dates to array
   var current = ($(e).text());
   var singleDate =  Date.parse(current);  //parse to milliseconds
   var compare = now.isAfter(singleDate);        //compare to today's date
   if(compare){
       // we want to hide the parent of td, not the td:
       $(e).parent().css("display", "none");   //hide <tr class="gig"> 
                                      //if in the past
   }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:50:39.423

你有什么理由过滤客户端吗？似乎效率低下。你的 html 是硬编码的还是你有服务器端脚本？你真的应该过滤你的结果预渲染，除非没有其他选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:48:06.900

我不知道这个 isAfter 函数，但你可以直接比较日期。我想那会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T23:04:24.450

即使比较有效，你也会用“演出”类隐藏任何东西。

您可以通过从您的字符串创建一个新的 Date(xxxxxxx) 来简化此操作。然后您可以使用“<”运算符进行比较。

假设您的演出日期与您的活动日期格式相同：

```
var now = new Date(); // create current date    
$('.gigDate').each(function (i, e) { 
    ele = $(this).html();
    gigDate = new Date(ele);
    if (gigDate<now){
        $(this).hide();
    }

}); 
```

你可以看到它在这里工作：

[http://jsfiddle.net/skelly/vzH8U/](http://jsfiddle.net/skelly/vzH8U/)</now){>

# facebook - facebook graph API - 获取墙贴

> ID：15648813
> 
> 赞同：5
> 
> 时间：2013-03-26T22:44:09.867
> 
> 标签：facebook, facebook-graph-api

我无法掌握 facebook 图形 API 和阅读我的墙贴。

我创建了一个 facebook 应用程序，现在有了一个应用程序 ID 和 AppSecret，使用它们，我通过这个 url 获得一个 access_token： [https ://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=MYAPPID&client_secret=MYAPPSECRET](https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=MYAPPID&client_secret=MYAPPSECRET)

例如：access_token=12313231321312312312

所以我在这里打电话：

[https://graph.facebook.com/MYFACEBOOKID/feed?access_token=12313231321312312312](https://graph.facebook.com/MYFACEBOOKID/feed?access_token=12313231321312312312)

但是我看到的结果不是我墙上的项目列表。示例 我今天发了一个帖子，但结果中没有。唯一列出的东西是我大约 2 周前添加的一个朋友，没有别的。

如果我去[https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)并在文本框中输入 /MYFACEBOOKID/feed 并提交，然后我会看到我想要得到的完整结果（使用应用程序密码ETC）。如果我从资源管理器页面复制 access_token 并将其放入我的 url，那么我也会得到完整的结果。

所以想知道我错过了什么？我是否需要在某处添加权限，以便使用 AppID/AppSecret 方法请求 access_token 获得相同的结果？

还是我只是在我的代码中使用资源管理器页面中的 access_token？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:26:34.450

从图形资源管理器中获取访问令牌不是答案。您可以检查并查看那里的访问令牌（选择您的应用程序，而不是图表）是否与您通过 url 获得的相同。对于授权 URL，您是否尝试过类似以下的操作？

[https://www.facebook.com/dialog/oauth?client_id=YOUR_APP_ID&redirect_uri=YOUR_URL&scope=user_likes,user_status,publish_actions,read_stream,ETC_ETC_OR_WHATEVERELSE&response_type=token](https://www.facebook.com/dialog/oauth?client_id=YOUR_APP_ID&redirect_uri=YOUR_URL&scope=user_likes,user_status,publish_actions,read_stream,ETC_ETC_OR_WHATEVERELSE&response_type=token) ”

这对我来说很好，所以值得一试。我[在这里](https://developers.facebook.com/docs/howtos/login/server-side-login/)也看到它仍然可以通过这种方式完成（据我所知，这不是坏习惯）。是的，换句话说，您需要权限。

# python - sqlalchemy.exc.ArgumentError：无法加载插件：sqlalchemy.dialects：驱动程序

> ID：15648814
> 
> 赞同：46
> 
> 时间：2013-03-26T22:44:13.547
> 
> 标签：python, sqlalchemy, psycopg2, alembic

我正在尝试运行`alembic`迁移，当我运行时

```
alembic revision --autogenerate -m "Added initial tables" 
```

它失败了

```
sqlalchemy.exc.ArgumentError: Can't load plugin: sqlalchemy.dialects:driver 
```

数据库网址是

```
postgresql+psycopg2://dev:passwd@localhost/db 
```

我什至已经`psycopg2`安装在我的 virtualenv 中

```
$yolk -l
Flask-Login     - 0.1.3        - active
Flask-SQLAlchemy - 0.16         - active
Flask           - 0.9          - active
Jinja2          - 2.6          - active
Mako            - 0.7.3        - active
MarkupSafe      - 0.15         - active
Python          - 2.7.2        - active development (/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload)
SQLAlchemy      - 0.8.0        - active
Werkzeug        - 0.8.3        - active
alembic         - 0.4.2        - active
antiorm         - 1.1.1        - active
appscript       - 1.0.1        - active
distribute      - 0.6.27       - active
envoy           - 0.0.2        - active
osascript       - 0.0.4        - active
pep8            - 1.4.5        - active
pip             - 1.1          - active
psycopg2        - 2.4.6        - active
wsgiref         - 0.1.2        - active development (/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7)
yolk            - 0.4.3        - active 
```

为什么会导致这个问题？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-03-27T16:51:56.853

以下是如何产生这样的错误：

```
>>> from sqlalchemy import *
>>> create_engine("driver://")
Traceback (most recent call last):
... etc
sqlalchemy.exc.ArgumentError: Can't load plugin: sqlalchemy.dialects:driver 
```

所以我会说您实际上并没有使用您认为的 postgresql URL - 您可能正在某处调用默认生成的 alembic.ini。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-06T02:50:34.880

对于那些没有注意到它的人，“默认生成的alembic.ini” **zzzzeek**指的是在项目的根目录中。

整个问题是在文件中设置`sqlalchemy.url`配置参数之一。`alembic.ini`此外，它可以按照[https://stackoverflow.com/a/15668175/973380](https://stackoverflow.com/a/15668175/973380)中的说明以编程方式设置。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-08-31T10:13:08.483

请注意，该方案实际上并未指定驱动程序，而是指定*方言*：该方案的形式为`dialect://` *or* `dialect+driver://`。

例如，连接到 PostgreSQL 数据库的正确 url 将以 example 开头`postgres://`（默认为 using `psycopg2`），或显式选择驱动程序（`postgres+psycopg2://`，或使用另一个驱动程序）。

如果您碰巧*只* `psycopg2`指定，您将收到错误

```
sqlalchemy.exc.NoSuchModuleError: Can't load plugin: sqlalchemy.dialects:psycopg2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-19T17:38:23.740

我通过简单地在 notepad++ 中打开 alembic.ini 然后将变量 sqlachemy.url （大约在第 38 行）修改为我的项目文件中的 url 解决了这个问题。该错误很可能是因为它在开始时有驱动程序引起的。

即将这一行重命名为

```
sqlalchemy.url = sqlite:///name_of_my_database.db 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-04T15:07:56.637

尝试这些命令来安装缺少的软件包：

```
sudo apt-get install libpq-dev 
sudo pip install psycopg2 
sudo pip install redshift-sqlalchemy 
sudo pip install sqlparse 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-28T09:23:44.323

如果您使用正确的语法来创建引擎，具体取决于您选择的数据库，`create_engine(f"<dialect_name>+<driver_name>://{self.user}:{self.password}@{self.host}:{self.port}/{self.database})`并且此处的其他建议都无法解决您的问题，您可以尝试下一段中概述的解决方案。

问题，`NoSuchModuleError: Can't load plugin: sqlalchemy.dialects:\<dialect_name\>.\<driver_name\>`可能是由于运行支持您需要的驱动程序的 SQLAlchemy 版本引起的。例如，SQLAlchemy 1.4.26 支持这些 PostgreSQL[驱动程序](https://docs.sqlalchemy.org/en/14/dialects/postgresql.html)。所以，解决方案：

1.  检查支持驱动程序的文档，了解您需要的方言。
2.  然后卸载 SQLAlchemy 或有问题的驱动程序`pip uninstall SQLAlchemy`
3.  强制 pip 安装特定版本的 SQLAlchemy 或替代驱动程序，`pip install SQLAlchemy==1.0.14`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-13T15:25:57.250

```
connection_url=""  
#your database connection string here pulled from either environment variable , vaults or can be set directly

def run_migrations_offline():
    """Run migrations in 'offline' mode.

    This configures the context with just a URL
    and not an Engine, though an Engine is acceptable
    here as well.  By skipping the Engine creation
    we don't even need a DBAPI to be available.

    Calls to context.execute() here emit the given string to the
    script output.

    """
    url = connection_url 
    context.configure(
        url=url,
        target_metadata=target_metadata,
        literal_binds=True,
        dialect_opts={"paramstyle": "named"},
    )

    with context.begin_transaction():
        context.run_migrations()

def run_migrations_online():
    """Run migrations in 'online' mode.

    In this scenario we need to create an Engine
    and associate a connection with the context.

    """
    configdict=config.get_section(config.config_ini_section)
    configdict.update({"sqlalchemy.url":connection_url})
    connectable = engine_from_config(
        configdict,
        prefix="sqlalchemy.",
        poolclass=pool.NullPool,
    )

    with connectable.connect() as connection:
        context.configure(
            connection=connection, target_metadata=target_metadata
        )

        with context.begin_transaction():
            context.run_migrations() 
```

如果你想从你的 python 文件本身读取连接 url 而不参考默认值

> alembic.ini

配置文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-27T14:56:56.107

要以编程方式覆盖 中的默认值`alembic.ini`，您可以在 中添加一两行代码`alembic/env.py`：

```
+ import app

[...snip...]

  # this is the Alembic Config object, which provides
  # access to the values within the .ini file in use.
  config = context.config

+ config.set_section_option(
    config.config_ini_section, "sqlalchemy.url", app.settings.SQLALCHEMY_DATABASE_URL
) 
```

where`import app`和`app.settings.SQLALCHEMY_DATABASE_URL`被您自己的特定于应用程序的代码替换以检索 URL。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-15T22:00:08.657

让 Teradata 查询在 Pyinstaller 生成的 .exe 上运行。我将引擎从 SQLAlchemy 更改为 Teradata

从 ：

```
import sqlalchemy as sa
user, pasw, hostname = UserName,Password, 'myurl.com'
# connect
td_engine = sa.create_engine('teradata://{}:{}@{}:22/'.format(user,pasw,hostname),echo=True)
df = pd.read_sql_query(query1,connect) 
```

至：

```
import teradata
user, pasw, hostname = UserName,Password, 'myurl.com'
td = teradata.UdaExec (appName="test", version="1.0", logConsole=True)
td_engine = td.connect(method="odbc",system=hostname, username=user,password=pasw,driver="Teradata") 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-04-09T16:46:49.650

如果你有 anaconda，请卸载它。它正在 anaconda 路径中安装您的 mysql 连接器，并且您的代码可能正在 python 路径中查找。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2019-12-19T14:54:22.773

我做到了，

```
pip install ibm_db_sa 
```

它解决了问题

# css - 使用 overflow-y: hidden 或 overflow-x: hidden 仅隐藏元素的一侧

> ID：15648828
> 
> 赞同：8
> 
> 时间：2013-03-26T22:45:02.350
> 
> 标签：css, overflow

标题几乎问了这个问题，但我知道使用`overflow-y: hidden`，`overflow-x: hidden`您可以隐藏元素的顶部和底部或左侧和骑乘侧，但有没有办法使用这些选择器仅隐藏一侧。

**特别是我有兴趣隐藏一个溢出但不是顶部的 div 的底部。**

如果没有，是否有任何其他 CSS 唯一方法来实现这种预期效果？

需要这个是有合法目的的，我想看看是否有标准的方法来做到这一点。

稍微解释一下，我只控制幻灯片的 CSS，我需要将幻灯片中的一个元素`div`向上推，`div`但是当我这样做时，这些`overflow: hidden`值会切断这个向上推。`div`我当然可以完全删除，`overflow: hidden`但这并不能制作一个非常好的幻灯片！

下面包括一个小提琴：

[https://jsfiddle.net/ejhyz7t3/](https://jsfiddle.net/ejhyz7t3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-25T17:40:47.377

以下基于问题示例的 jsfiddle 提供了使用以下方法仅切断底部边缘的预期效果`clip`：

[https://jsfiddle.net/ejhyz7t3/2/](https://jsfiddle.net/ejhyz7t3/2/)

完整代码复制如下以供参考：

**HTML**

```
<div class="outer-container">
   <div class="inner-container">
   </div>
</div> 
```

**CSS**

```
.outer-container {
  background: red;
  height: 100px;
  margin-top: 100px;
  width: 150px;
  padding-left: 50px;
}

.inner-container {
  background: green;
  height: 200px;
  width: 100px;
  transform: translateY(-50px);
  position: absolute;
  clip: rect(0, 100px, 150px, 0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T17:39:49.207

我有一个类似的问题，我有一个可拖动的 div，我想向右/向下溢出，但不是向上/向左。我通过调整 z-index 解决了这个问题。容器 div 到 z-index:0px; 可拖动到 z-index:500px; 以及顶部和左侧（菜单）中的 div 到 z-index:1000px;。这有效地将可拖动层夹在中间，允许在我想要的方向上溢出。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-11-09T12:21:17.853

```
.mydiv {  
    clip: rect(-100px, -100px, auto, -100px);  
} 
```

将剪辑矩形的底部设置为`auto`类似的剪辑`overflow: hidden`。这些`-100px`值是任意选择的，以便为溢出留出一些空间。

# jquery - 如何将选择器“链接”在一起并在 jQuery 中应用相同的功能

> ID：15648831
> 
> 赞同：4
> 
> 时间：2013-03-26T22:45:32.803
> 
> 标签：jquery, css

也许标题并没有真正说明我的问题是什么。

```
<ul>
    <li>A</li>
    <li>B</li>
    <li class="test">C</li>
    <li>D</li>
</ul> 
```

我想要做的是将背景颜色应用于具有“test”类的元素的相邻兄弟姐妹，以及本身，其中三个将具有背景颜色。所以我必须做以下事情。

```
 $('ul li.test').each(function(){
        $(this).prev().css('background','red');
        $(this).css('background','red');
        $(this).next().css('background','red');
    }); 
```

我认为这是一个非常丑陋的编码。有没有办法做类似 $(prev, this, next).somefunction() 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:50:04.140

您可以使用`.add()`将元素添加到匹配元素集：

```
$(this).add($(this).prev()).add($(this).next()).css('background','red'); 
```

或者使用`.addBack()`（`.andSelf()`对于 1.8 之前的 jQuery 版本）：

```
$(this).prev().addBack().next().addBack().css('background','red'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:48:42.967

利用[`.end()`](http://api.jquery.com/end/)

```
$(this).prev().css('background','red')
       .end().css('background','red')
       .next().css('background','red'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:51:03.287

您可以创建一个变量来缓存选择并对其应用样式。

```
var $this = $(this);
var elements = $this;
elements.add($this.prev());
elements.add($this.next());

elements.css('background','red'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T22:57:44.703

[您可以使用Next Adjacent Selector](http://api.jquery.com/next-adjacent-Selector/)将其中两个压缩在一起

```
$(".test, .test + li").css("background-color","#F00"); 
```

我也试过`$("li + .test")`了，但这对我不起作用

编辑：

`$("li + .test")`确实有效，但它选择了`.test`元素。虽然似乎没有以前的相邻选择器

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T23:09:19.007

好的，我想我可能会尝试使用 jQuery 加入一些 css 练习并这样做：

**CSS**

```
.test,
.test + li {
  background: red;
} 
```

**jQuery**

```
$('.test').prev().css('background','red'); 
```

但我想知道自己是否有更清洁的解决方案。:)

# .net - SQL 查询到 Linq 或 Lambda 表达式

> ID：15648832
> 
> 赞同：0
> 
> 时间：2013-03-26T22:45:34.063
> 
> 标签：.net, sql, linq, lambda

我只是想知道为以下 sql 查询语句创建等效的 linq 或 lambda 表达式：

```
select(sum(a.credit) - sum(a.debit)) as total 
from table_A a inner join table_B b on 
a.accountid = b.id 
where a.[date] >= '2013-01-01' 
and a.[date] < '2013-03-27' 
and b.Name = 'MKBank' 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:52:15.740

您看到的错误是因为您在最终选择中声明匿名类型的方式。如果要指定除属性名称以外的任何内容以供选择，则需要指定成员名称。阅读[匿名类型（C# 编程指南）](http://msdn.microsoft.com/en-us/library/vstudio/bb397696.aspx)了解更多详细信息。

您的查询还有一些其他问题。您也无法比较`DateTime`和`string`值，因此您应该在将日期参数传递给查询之前构造它们。如果您只想要一个帐户的总数，则不需要执行任何操作`.GroupBy`。`.Select`最后`o => o.o.credit - o => o.o.debit`不会编译。我想你想要的是`o => o.o.credit - o.o.debit`。

试试这个：

```
DateTime beginDate = ...
DateTime endDate = ...
p = db.Account_Transaction.Join(
        db.Accounts,
        o => o.AccountId, 
        p => p.ID,
        (o, p) => new { o, p })
    .‌Where(o => o.o.Date >= beginDate && o.o.Date < endDate && o.p.Name == "MKBank")
    .Sum(o => o.o.credit - o.o.debit); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:03:40.100

这应该有效：

```
 var qr = from a in lA
                 join b in lB on a.Id equals b.Id
                 where a.Date >= new DateTime(2013, 1, 1) &&
                 a.Date < new DateTime(2013, 3, 7) &&
                 b.Name == "MKBank"
                 select new
                 {
                     cr = a.credit,
                     db = a.debit
                 };

        var res = qr.Sum((x) => x.cr - x.db); 
```

# ruby-on-rails - 使用 JS 隐藏我的 rails div

> ID：15648834
> 
> 赞同：0
> 
> 时间：2013-03-26T22:45:38.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, coffeescript

我的产品视图：

```
<a href="#" id="show_metrics">Show Metrics</a>
  <div id="metrics" class="hidden">
<%="Number of Primary Products: #{Product.total_product_size(rating_set).count}"%><br/>
<%="Number of Recommendations: #{Product.total_recommendation_size(rating_set).count}"%><br/>
<%="Percentage of Bad Recommendations: #{bad}/#{total} = #{number_to_percentage(percentage_bad, :precision => 2)}"%>
</div> 
```

products.js.coffee：

```
$ ->
  $("a#show_metrics").click (event) ->
    event.preventDefault()
    $("div#metrics").toggle() 
```

“显示指标”链接显示在我的视图中，但是单击链接时没有任何反应，但是当我查看页面源时，我将指标 div 视为隐藏值。单击“显示指标”链接时，我需要更改什么以显示指标信息。

生成的 HTML：

```
<div id="metrics" class="hidden">
Number of Primary Products: 5
<br>
Number of Recommendations: 105
<br>
Percentage of Bad Recommendations: 0/0 = NaN%
</div> 
```

生成的JS：

```
(function() {
$(function() {
return $("a#show_metrics").click(function(event) {
event.preventDefault();
return $("div#metrics").show();
});
});
}).call(this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:00:42.930

我认为你可以这样做：

```
$("div#metrics").removeClass("hidden") 
```

所以像这样将它添加到你的代码中：

```
$ ->
  $("a#show_metrics").click (event) ->
    event.preventDefault()
    $("div#metrics").removeClass("hidden") 
```

相反，如果你想隐藏它，你会这样做：

```
$("div#metrics").addClass("hidden") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T00:52:21.240

```
jQuery ->
  $("a#show_metrics").click (event) ->
    event.preventDefault()
    $("div#metrics").toggle() 
```

# excel - 尝试创建打开新工作表的 excel vba 宏，根据原始工作表中相关单元格的值对其进行重命名

> ID：15648836
> 
> 赞同：0
> 
> 时间：2013-03-26T22:45:43.837
> 
> 标签：excel, vba, relative-path

我有一个联系人的主列表。我正在尝试创建一个使用相对参考点的宏：

打开特定工作表模板为其命名 = ActiveCell 的值或在宏中激活的第一个单元格，然后将信息从主列表复制并粘贴到新工作表打开

我可以弄清楚如何打开工作表并进行复制和粘贴，但是在重命名工作表时总是会出错。

```
ActiveCell.Range("A1,A2:B26").Select
ActiveCell.Offset(1, 0).Range("A1").Activate
ActiveWindow.ScrollRow = 5
ActiveWindow.ScrollRow = 4
ActiveWindow.ScrollRow = 3
ActiveWindow.ScrollRow = 2
ActiveWindow.ScrollRow = 1
ActiveCell.Offset(-1, 0).Range("A1").Select
Sheets("Patient List").Select
Sheets.Add Type:= _
    "C:\Users\Valerie\AppData\Roaming\Microsoft\Templates\Patient-History-Template1.xltx"
Sheets("Patient List").Select
Selection.Copy
Sheets("Patient List").Select
Sheets("Patient List").Name = "Patient List"
Sheets("Patient 1").Select 
```

在下面，我想要新工作表的名称 = 在宏中激活的第一个单元格的相对值，而不是“琼斯”。这样我就可以运行宏并为 columnA 中的每个名称获取单独的工作表。

```
Sheets("Patient 1").Name = "Jones"
Sheets("Jones").Select
ActiveSheet.Paste
Sheets("Patient List").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Jones").Select
ActiveCell.Offset(0, 1).Range("A1").Select
ActiveSheet.Paste
Sheets("Patient List").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Jones").Select
ActiveCell.Offset(2, -1).Range("A1").Select
ActiveSheet.Paste
Sheets("Patient List").Select 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:07:51.903

您可能应该在包含患者姓名的单元格范围内循环执行此操作。

```
Sub TestAddPatientSheet()
Dim rng As Range
Dim r As Long 'row iterator
Dim patientName As String
Dim patientSheet As Worksheet

Sheets("Patient List").Activate

Set rng = Set rng = Sheets("Patient List").Range("A2:B26")   '<-- this is the range of cells w/patient names in Col A
    For r = 1 To rng.Rows.Count
        patientName = rng(r, 1).Value
        'Creates a new worksheet
        Set patientSheet = Sheets.Add(After:=Sheets("Patient List"), _
            Type:="C:\Users\Valerie\AppData\Roaming\Microsoft\Templates\Patient-History-Template1.xltx")
ResRetry:
        'Attempt to rename the sheet, trapping errors (if any) and allowing re-try
        On Error GoTo ErrName:
        patientSheet.Name = patientName
    Next
Exit Sub

ErrName:
Err.Clear
MsgBox patientName & " is not a valid worksheet name", vbCritical

patientName = InputBox("Please rename the worksheet for " & patientName & "." & _
                        vbCRLF & "Make sure the sheet name doesn't already exist, is " & _
                        "fewer than 32 characters, and does not contain " & vbCRLF & _
                        "special characters like %, *, etc.", "Rename sheet for " & patientName, patientName)
Resume ResRetry

End Sub 
```

# php - 基于 PHP 的论坛软件

> ID：15648837
> 
> 赞同：-2
> 
> 时间：2013-03-26T22:45:55.487
> 
> 标签：php, forums

我一直想知道堆栈**溢出**社区最喜欢/使用的基于 PHP 的论坛软件是什么。就是让大家自己做决定，在回答的时候能不能也留个理由？

感谢所有回复的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:48:46.620

自己从未尝试过，但也许您正在寻找像[香草论坛这样的东西](http://vanillaforums.org/)

# c# - C# sql if 查询

> ID：15648840
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:46:06.597
> 
> 标签：c#, sql, if-statement

我试着做

```
var sql = String.Format("if ( {0} > (select sStrength from yCell where Cell_ID = '{1}')) begin UPDATE yCell SET sStrength = {0} WHERE Cell_ID = '{1}' end", inMaxStrength, inCellID);
                   SqlCeCommand myCommand = new SqlCeCommand(sql,connection);
                    myCommand.ExecuteNonQuery(); 
```

有一个错误：令牌行号= 1，令牌行偏移量= 1，错误中的令牌= if 但是在sql studio中它运行正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:10:24.620

不能说为什么会失败，但我可以建议您尝试在一个命令中更新：

`UPDATE yCell SET sStrength = {0} WHERE Cell_ID = '{1}' AND {0} > sStrength`

# c++ - 对类成员使用智能指针

> ID：15648844
> 
> 赞同：173
> 
> 时间：2013-03-26T22:46:35.680
> 
> 标签：c++, c++11, shared-ptr, smart-pointers, unique-ptr

我无法理解智能指针在 C++11 中作为类成员的用法。我已经阅读了很多有关智能指针的内容，并且我认为我确实了解总体上是如何`unique_ptr`和`shared_ptr`/`weak_ptr`工作的。我不明白的是真正的用法。似乎每个人都建议使用`unique_ptr`几乎所有时间。但是我将如何实现这样的事情：

```
class Device {
};

class Settings {
    Device *device;
public:
    Settings(Device *device) {
        this->device = device;
    }

    Device *getDevice() {
        return device;
    }
};    

int main() {
    Device *device = new Device();
    Settings settings(device);
    // ...
    Device *myDevice = settings.getDevice();
    // do something with myDevice...
} 
```

假设我想用智能指针替换指针。A`unique_ptr`不会工作，因为`getDevice()`，对吧？那是我使用`shared_ptr`and的时候`weak_ptr`吗？没办法使用`unique_ptr`？`shared_ptr`在我看来，除非我在非常小的范围内使用指针，否则大多数情况下更有意义？

```
class Device {
};

class Settings {
    std::shared_ptr<Device> device;
public:
    Settings(std::shared_ptr<Device> device) {
        this->device = device;
    }

    std::weak_ptr<Device> getDevice() {
        return device;
    }
};

int main() {
    std::shared_ptr<Device> device(new Device());
    Settings settings(device);
    // ...
    std::weak_ptr<Device> myDevice = settings.getDevice();
    // do something with myDevice...
} 
```

这是要走的路吗？非常感谢！

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2013-03-26T23:06:56.337

> A`unique_ptr`不会工作，因为`getDevice()`，对吧？

不，不一定。这里重要的是为您的对象确定适当的**所有权策略**`Device`，即谁将成为您的（智能）指针所指向的对象的所有者。

它会*单独*`Settings`成为对象的实例吗？当对象被销毁时，该对象是否必须自动销毁，还是应该比该对象更长寿？*`Device``Settings`*

 *在第一种情况下，`std::unique_ptr`这就是您所需要的，因为它是`Settings`指向对象的唯一（唯一）所有者，并且是唯一负责其销毁的对象。

在这种假设下，`getDevice()`应该返回一个简单的*观察*指针（观察指针是不保持指向对象存活的指针）。最简单的观察指针是原始指针：

```
#include <memory>

class Device {
};

class Settings {
    std::unique_ptr<Device> device;
public:
    Settings(std::unique_ptr<Device> d) {
        device = std::move(d);
    }

    Device* getDevice() {
        return device.get();
    }
};

int main() {
    std::unique_ptr<Device> device(new Device());
    Settings settings(std::move(device));
    // ...
    Device *myDevice = settings.getDevice();
    // do something with myDevice...
} 
```

[**注意 1：** *您可能想知道为什么我在这里使用原始指针，因为每个人都一直在说原始指针是坏的、不安全的和危险的。实际上，这是一个宝贵的警告，但将其放在正确的上下文中很重要：原始指针**在用于执行手动内存管理时**是不好的，即通过`new`and分配和释放对象`delete`。当纯粹用作实现引用语义和传递非拥有的观察指针的一种手段时，原始指针本质上没有任何危险，除了可能要注意不要取消对悬空指针的引用这一事实。*-**结束注 1** ]

[**注2：** *正如评论中出现的那样，在这种特殊情况下，所有权是唯一的**，并且**始终保证拥有的对象存在（即内部数据成员`device`永远不会存在`nullptr`），函数`getDevice()`可以（并且可能应该）返回引用而不是指针。虽然这是真的，但我决定在这里返回一个原始指针，因为我的意思是这是一个简短的答案，可以概括为 where `device`could be的情况`nullptr`，并表明只要不将原始指针用于手动内存管理。*-**结束注 2** ]

* * *

当然，如果您的`Settings`对象不应该**拥有**设备的独占所有权，情况就完全不同了。例如，如果`Settings`对象的破坏不应该暗示指向的`Device`对象的破坏，则可能是这种情况。

这是只有作为程序设计者的你才能说出的；从您提供的示例中，我很难判断是否是这种情况。

为了帮助您弄清楚，您可能会问自己是否还有其他对象`Settings`有权保持该`Device`对象的活动，只要它们持有指向它的指针，而不仅仅是被动的观察者。如果确实如此，那么您需要一个**共享所有权策略**，它`std::shared_ptr`提供：

```
#include <memory>

class Device {
};

class Settings {
    std::shared_ptr<Device> device;
public:
    Settings(std::shared_ptr<Device> const& d) {
        device = d;
    }

    std::shared_ptr<Device> getDevice() {
        return device;
    }
};

int main() {
    std::shared_ptr<Device> device = std::make_shared<Device>();
    Settings settings(device);
    // ...
    std::shared_ptr<Device> myDevice = settings.getDevice();
    // do something with myDevice...
} 
```

请注意，这`weak_ptr`是一个*观察*指针，而不是拥有指针 - 换句话说，如果指向指向对象的所有其他拥有指针超出范围，它不会使指向对象保持活动状态。

与常规原始指针相比的优势`weak_ptr`在于，您可以安全地判断是否`weak_ptr`悬空*（*即它是否指向有效对象，或者最初指向的对象是否已被销毁）。这可以通过调用对象的`expired()`成员函数来完成`weak_ptr`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:53:44.913

```
class Device {
};

class Settings {
    std::shared_ptr<Device> device;
public:
    Settings(const std::shared_ptr<Device>& device) : device(device) {

    }

    const std::shared_ptr<Device>& getDevice() {
        return device;
    }
};

int main()
{
    std::shared_ptr<Device> device(new Device());
    Settings settings(device);
    // ...
    std::shared_ptr<Device> myDevice(settings.getDevice());
    // do something with myDevice...
    return 0;
} 
```

[`week_ptr`](http://en.cppreference.com/w/cpp/memory/weak_ptr)仅用于参考循环。依赖图必须是无环有向图。在共享指针中有 2 个引用计数：1 个用于[`shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr)s，1 个用于所有指针（`shared_ptr`和`weak_ptr`）。当所有`shared_ptr`的 s 都被删除时，指针被删除。当需要来自 的指针时`weak_ptr`，`lock`应该使用它来获取指针（如果存在）。*

# c++ - 重新定义类错误

> ID：15648849
> 
> 赞同：0
> 
> 时间：2013-03-26T22:47:20.327
> 
> 标签：c++, graphics, redefinition

我正在设计一个程序，它需要三个给定点并计算第四个点来创建一个平行四边形。到目前为止，我所拥有的是：

```
struct Parallelogram : public Polygon {
    Parallelogram(Point tl, Point tr, Point bl){
        Point br;
        int num = tr.y-tl.y;
        int denom = tr.x-tl.x;
        br.x=denom+bl.x;
        br.y=num+bl.y;
    }
};

Parallelogram::Parallelogram(Point tl, Point tr, Point bl)
{
    add(tl);
    add(tr);
    add(bl);
    add(br);
}; 
```

编译时出现以下错误：

```
hw6pr2.cpp:15:1: error: redefinition of âParallelogram::Parallelogram(Point, Point, Point)â
hw6pr2.cpp:6:2: error: âParallelogram::Parallelogram(Point, Point, Point)â previously defined here 
```

我的问题是：如果我从多边形类派生的方式正确吗？如果是这样，为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:52:41.200

你有两个定义`Parallelogram::Parallelogram(Point, Point, Point)`; 一个在课内，一个在课外。一个函数不能有多个定义。

假设`add`为您添加一个点，您`Polygon`似乎真的只是希望第二个定义成为第一个定义的一部分。您可以像这样在类中定义它：

```
struct Parallelogram : public Polygon {
  Parallelogram(Point tl, Point tr, Point bl) {
    Point br;
    int num = tr.y-tl.y;
    int denom = tr.x-tl.x;
    br.x=denom+bl.x;
    br.y=num+bl.y;

    add(tl);
    add(tr);
    add(bl);
    add(br);
  }
}; 
```

或者，您可以在类中声明它，然后在外部定义它：

```
struct Parallelogram : public Polygon {
  Parallelogram(Point tl, Point tr, Point bl);
};

Parallelogram::Parallelogram(Point tl, Point tr, Point bl) {
  Point br;
  int num = tr.y-tl.y;
  int denom = tr.x-tl.x;
  br.x=denom+bl.x;
  br.y=num+bl.y;

  add(tl);
  add(tr);
  add(bl);
  add(br);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:51:15.267

使固定 。. .

```
Parallelogram::AnyWordButParallelogram(Point tl, Point tr, Point bl)
{
add(tl);
add(tr);
... 
```

如果您希望在构造时调用该代码（我只能猜测），那么 . .

```
struct Parallelogram : public Polygon {
Parallelogram(Point tl, Point tr, Point bl){
    ...

    AnyWordButParallelogram(Point tl, Point tr, Point bl)
} 
```

只要确保函数在构造函数之前定义。

# c# - 如何确定数据集中是否有任何表而不获得“找不到表 0”错误消息？

> ID：15648856
> 
> 赞同：0
> 
> 时间：2013-03-26T22:47:52.927
> 
> 标签：c#, compact-framework, sql-server-ce, windows-ce

我有这样的代码：

```
DataSet QtyDS = null;
. . .
QtyDS = GetAllUPCDSDRecords(txtUPC.Text); 
```

...那是因为“找不到表 0”而爆炸

为了防止这种情况发生，我尝试了以下方法，但均无济于事；当我尝试访问数据集中的第一个表时，我仍然收到该错误消息：

1)

```
if (null != QtyDS) 
```

2)

```
string table0 = QtyDS.Tables[0].ToString();
if (!table0.Equals(string.Empty)) 
```

3)

```
if (null != QtyDS.Tables[0]) 
```

如何安全地确定查询是否返回数据集以避免错误消息？

## 更新

```
public DataSet getAllUPCDSDRecords(string upc)
{
    string query = string.Format(
        "SELECT tyger_id as tyger, upc_source as UPC, description as Descrip, unit_qty as Qty, "+
        "department as Dept, vendor_id as Ven, upc_pack_size as UPCPK, pack_size as PKSize, "+
        "unit_cost as Cst, unit_list as Lst "+
        "FROM {0} WHERE upc_source = {1}", tablename, upc);
    return dbconn.getDataSet(query);
}

public DataSet getDataSet( string dynSQL )
{
    checkConnection();

    SqlCeDataAdapter oDA = new SqlCeDataAdapter( dynSQL, objCon );
    DataSet          oDS = new DataSet( "Command" );

    try
    {
        oDA.Fill( oDS );
    } 
    catch
    {
        //SSCS.ExceptionHandler(ex, "DBConnection.getDataSet");
    }

    return( oDS );
} // getDataSet 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:13:01.837

如果没有看到您的其余代码，我会假设您的查询没有返回任何内容。尝试放置一个断点`return( oDS );`，看看`oDS`有什么要说的。如果其中没有任何内容，则您的查询无法正常工作。

您可能需要检查查询语法或连接字符串。

此外，您可以通过检查找到表数`QtyDS.Tables.Count`。如果它大于 0，则您有表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T13:30:12.470

看起来您正在吞咽并忽略您的错误，这会让您认为您的代码运行良好，而实际上并非如此。

删除评论。

```
public DataSet getDataSet( string dynSQL )
{
  checkConnection();

  SqlCeDataAdapter oDA = new SqlCeDataAdapter( dynSQL, objCon );
  DataSet          oDS = new DataSet( "Command" );

  try
  {
      oDA.Fill( oDS );
  } 
  catch (Exception ex)
  {
      Console.WriteLine(ex.Message);
  }

  return( oDS );
} 
```

只需在 上放一个断点`Console.WriteLine`即可读取错误是什么。一旦解决了这个问题，您就应该删除整个`try...catch`例程，这样如果出现故障，它就不会对您隐藏。

更进一步，更改签名并检查该`checkConnection`方法：

```
public DataSet getDataSet( string dynSQL )
{
  var oDS = new DataSet("Command");
  try
  {
    if (!checkConnection()) {
      throw new Exception("No connection to database.");
    }
    using (var oDA = new SqlCeDataAdapter(dynSQL, objCon)) {
      oDA.Fill(oDS);
    }
  } 
  catch (Exception ex)
  {
      Console.WriteLine(ex.Message);
  }

  return( oDS );
} 
```

# java - STS 3.2 -- 即使没有在 web.xml 中注册，JNDI 仍然可以访问

> ID：15648865
> 
> 赞同：0
> 
> 时间：2013-03-26T22:48:58.273
> 
> 标签：java, spring, tomcat, jndi

可能问题应该是“applicationContext.xml 和 web.xml 之间的关系是什么，是父子关系还是兄弟兄弟关系”

当前的 Spring 应用程序在 Tomcat 中定义了 JNDI，并`<resource-ref/>`在`web.xml`. 有几个由以下人员创建的 JNDI 资源`applicationContext.xml`bean `<jee:jdni-lookup>`：

```
<jee:jndi-lookup id="dataSource_A" jndi-name="jndi/sourceA" />
<jee:jndi-lookup id="dataSource_B" jndi-name="jndi/sourceB" />
<jee:jndi-lookup id="dataSource_C" jndi-name="jndi/sourceC" /> 
```

现在有趣的发现是，在注释掉所有`<resource-ref/>`from之后`web.xml`，JNDI 数据源仍然可以访问，这让我怀疑应用程序访问 Tomcat 是通过`applicationContext.xml`（在哪里可以找到 JNDI 名称）直接没有通过`web.xml`。

还要提一下，这种现象只发生在 STS3.2/tomcat-7.0.35.B.RELEASE 中，而在 STS2.9.2/tomcat-7.0.30.A.RELEASE 中没有

# android - Kivy ScrollView+手风琴错误

> ID：15648866
> 
> 赞同：2
> 
> 时间：2013-03-26T22:49:02.430
> 
> 标签：android, python, user-interface, scrollview, kivy

我有这个代码。如果我将 Accordion 项目的数量增加到超过一定数量，应用程序就会失控。gridLayout 版本（已注释掉）按预期工作。违规区域位于 HERE 和 THERE 之间。

```
from kivy.app import App
from kivy.uix.spinner import Spinner, SpinnerOption
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.accordion import Accordion, AccordionItem
from kivy.uix.label import Label
from kivy.uix.button import Button
from kivy.uix.scrollview import ScrollView
from kivy.uix.gridlayout import GridLayout
from kivy.core.window import Window

class MusicController(App):

    def build(self):
        b = BoxLayout(orientation='vertical')
        top = Spinner(text = '12', values = ["Songs","Artist","Playlist","Search"], background_color = (.3,.2,.5,1), size_hint_y = 0.1)

    #< HERE >#

        items = Accordion(orientation='vertical')
        for x in xrange(30):
            item = AccordionItem(title='Title %d' % x)
            buttons = BoxLayout()
            buttons.add_widget(Button(text='Play'))
            buttons.add_widget(Button(text='Pause'))
            buttons.add_widget(Button(text='Pause'))
            item.add_widget(buttons)
            items.add_widget(item)

        #~ items = GridLayout(cols=1, spacing=10, size_hint_y=None)
        #~ items.bind(minimum_height=items.setter('height'))
        #~ for i in range(30):
            #~ btn = Button(text=str(i), 

    #< THERE >#

        sv = ScrollView(do_scroll_x = False)
        sv.add_widget(items)
        now_playing = BoxLayout(size_hint_y = 0.1)
        for widget in ["Prev","Play","Pause","Next","NP"]:
            now_playing.add_widget(Button(text=widget))

        b.add_widget(top)
        b.add_widget(sv)
        b.add_widget(now_playing)
        return b

if __name__ == '__main__':
    MusicController().run() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T01:22:05.963

正如您控制台上的错误所暗示的那样

```
[WARNING] [Accordion   ] not enough space for displaying all children
[WARNING] [Accordion   ] need XXXX, got XXXXpx
[WARNING] [Accordion   ] layout aborted. 
```

只需增加给 Accordian 的空间，这样它就可以容纳所有的孩子

将代码的第 19 行更改为

```
items = Accordion(orientation='vertical', size_hint_y=None, height=50*30) 
```

应该管用。

在 GridLayout 中，您可以通过将 Gridlayout `minimum_height`（由子级组合的高度计算）绑定到它的高度来执行相同的操作。

```
items.bind(minimum_height=items.setter('height')) 
```

Accordian 没有这种方便的方法，所以你必须自己做。

为了使其更具动态性，您可以像这样绑定到 Accordion 的 children 属性：

```
item.bind(children=self.update_size) 
```

然后像这样定义 update_size::

```
def update_size(self, instance, value):
    # change 50 to what you want your AccordionItem height to be.
    instance.size = 50*len(instance.children) 
```

# javascript - 如何使用 vbscript 在 USB 驱动器的当前目录上创建快捷方式？

> ID：15648873
> 
> 赞同：0
> 
> 时间：2013-03-26T22:49:40.953
> 
> 标签：javascript, vbscript

我是编码新手，我今天的目标是在 USB 拇指/闪存驱动器的当前目录上创建一个快捷方式。我在脚本方面取得了一些进展，但在设置快捷方式的目标路径时遇到问题，因为当 USB 闪存驱动器插入计算机时，它们会自动分配一个驱动器号，因此快捷方式的目标路径每次都不一样。我不知道我将如何解决这个问题。如果你们能帮我解决这个问题，将不胜感激，谢谢！

```
 Set oWS = WScript.CreateObject("WScript.Shell")
    sLinkFile = "A.lnk"
    Set oLink = oWS.CreateShortcut(sLinkFile)
      oLink.TargetPath = "(What the usb drive letter should be):\A.vbs" 
      '  oLink.Arguments = ""
      '  oLink.Description = "MyProgram"   
      '  oLink.IconLocation = "C:\xxx\notporno"
      '  oLink.WindowStyle = "1"
    oLink.Save 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:40:59.740

> 尝试使用相对路径。– forsajt

谢谢**你**！你真的帮了我这个忙，这是我的解决方案的一部分：

```
strLinkFile = "A.lnk" 

Set fso = CreateObject("Scripting.FileSystemObject") 
Set oWS = WScript.CreateObject("WScript.Shell") 
Set oLink = oWS.CreateShortcut(strLinkFile) 

strPath = oWS.CurrentDirectory 

If fso.FileExists (strPath & "\Target.file") Then 
oLink.TargetPath = strPath & "\Target.file" 
oLink.Save 

End if 
```

# ruby-on-rails - 使 diff-lcs 的输出具有人类可读性

> ID：15648875
> 
> 赞同：3
> 
> 时间：2013-03-26T22:49:44.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2, diff, diff-lcs

我正在使用 diff-lcs gem 输出两个 html 内容主体之间的差异。这是示例内容。

**版本一：**

```
<p>Paragraph one. Sentence one.</p>

<p>Paragraph two. Another sentence.</p>

<p>Paragraph three. I dare you to change me!</p> 
```

**版本二：**

```
<p>Paragraph one. Sentence two.</p>

<p>Paragraph two. Another sentence.</p>

<p>Paragraph three. I dare you to update me!</p> 
```

**使用这个：**

```
seq1 = @versionOne.body
seq2 = @versionTwo.body

seq = Diff::LCS.diff(seq1, seq2) 
```

**你得到这个怪物：**

```
seq => [[#<Diff::LCS::Change:0x0000000be539f8 @action="-", @position=27, @element="t">, #<Diff::LCS::Change:0x0000000be538b8 @action="-", @position=28, @element="w">], [#<Diff::LCS::Change:0x0000000be53520 @action="+", @position=28, @element="n">, #<Diff::LCS::Change:0x0000000be53408 @action="+", @position=29, @element="e">], [#<Diff::LCS::Change:0x0000000be3aa70 @action="-", @position=110, @element="u">, #<Diff::LCS::Change:0x0000000be3a840 @action="-", @position=111, @element="p">, #<Diff::LCS::Change:0x0000000be34ee0 @action="-", @position=112, @element="d">, #<Diff::LCS::Change:0x0000000be349e0 @action="+", @position=110, @element="c">, #<Diff::LCS::Change:0x0000000be348a0 @action="+", @position=111, @element="h">], [#<Diff::LCS::Change:0x0000000be34580 @action="-", @position=114, @element="t">, #<Diff::LCS::Change:0x0000000be34210 @action="+", @position=113, @element="n">, #<Diff::LCS::Change:0x0000000be33f40 @action="+", @position=114, @element="g">], [#<Diff::LCS::Change:0x0000000be331d0 @action="-", @position=124, @element="">]] 
```

[文档](http://rubydoc.info/gems/diff-lcs/1.2.1/frames)中的输出`sdiff`和其他方法同样令人恐惧。我了解数组（数组）的结构，但必须有一种简单的方法以人类可读和可样式化的方式显示差异。

PS - 如果有人想创建一个`diff-lcs`标签，那将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:49:44.950

我输入的 diff-lcs 是一个常规字符串——一个字符数组。如果我想要的是字符比较，那么我得到了我想要的，但我想要一些更具可读性的东西——单词、行或句子的比较。我选择了句子。

```
seq1 = @versionOne.body.split('.')
seq2 = @versionTwo.body.split('.')
compareDiff = Diff::LCS.sdiff(seq1, seq2) 
```

这产生了更具可读性和可解析性的内容。实际上，我也想用`!`and分割`?`。然而，该结构不是普通的数组或哈希数组。浏览器中的输出让我大吃一惊，但它是一个对象数组，你可以像其他任何东西一样解析它。这是我在 rails 控制台中得到的 YAML 格式输出（不知道为什么它没有在浏览器中显示）：

```
---
- !ruby/object:Diff::LCS::ContextChange
  action: "="
  new_element: <p>Paragraph one
  new_position: 0
  old_element: <p>Paragraph one
  old_position: 0
- !ruby/object:Diff::LCS::ContextChange
  action: "!"
  new_element: " Sentence two"
  new_position: 1
  old_element: " Sentence one"
  old_position: 1
- !ruby/object:Diff::LCS::ContextChange
  action: "="
  new_element: |-
    </p>
    <p>Paragraph two
  new_position: 2
  old_element: |-
    </p>
    <p>Paragraph two
  old_position: 2
- !ruby/object:Diff::LCS::ContextChange
  action: "="
  new_element: " Another sentence"
  new_position: 3
  old_element: " Another sentence"
  old_position: 3
- !ruby/object:Diff::LCS::ContextChange
  action: "="
  new_element: |-
    </p>
    <p>Paragraph three
  new_position: 4
  old_element: |-
    </p>
    <p>Paragraph three
  old_position: 4
- !ruby/object:Diff::LCS::ContextChange
  action: "!"
  new_element: " I dare you to update me!</p>"
  new_position: 5
  old_element: " I dare you to change me!</p>"
  old_position: 5
 => nil 
```

超级有帮助！这将输出一个类似 wiki 的差异：

```
sdiff = Diff::LCS.sdiff(seq2, seq1)

diffHTML = ''

sdiff.each do |diff|
  case diff.action
  when '='
    diffHTML << diff.new_element + "."
  when '!'
    # strip_tags only needed on old_element. removes pre-mature end tags.
    diffHTML << "<del>#{diff.old_element.strip_tags}</del> <add>#{diff.new_element}</add>. "
  end
end

@compareBody = diffHTML.html

...[format do block] 
```

然后只是风格`<del>`，`<add>`如你所愿。如果您正在寻找更简单的东西，可能就是[diffy](https://github.com/samg/diffy)，但是一旦您弄清楚了，这将非常灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-06T16:12:47.203

您还可以使用块版本，您可以将其与数组解构结合使用：

```
seq1.sdiff(seq2) { |action, (old_pos, old_element), (new_pos, new_element)|
  ...
  puts [action, old_pos, old_element, new_pos, new_element].inspect
  ...
}

seq1.diff(seq2) { |action, position, element| 
  puts [action, position, element].inspect 
} 
```

# c# - 追加 C# 时维护列表数据

> ID：15648877
> 
> 赞同：0
> 
> 时间：2013-03-26T22:49:45.253
> 
> 标签：c#, .net, list, generics

我只是注意到我写的一个函数有问题，我意识到了这个问题，但“修复”只会使情况恶化。

该函数连接到我的数据库并进行选择查询，然后它将任何行作为 a 返回`List<List<string>>`，预期的行为是`List<string>`为每一行返回 1，并且由于每一行都有多个列，我可以使用列表索引访问它们。

```
 try
                    {
                        ///Open connection before we can read
                        dataConnection.Open();

                        ///Prepare to read
                        reader = dataCommand.ExecuteReader();

                        // Call Read before accessing data.
                        while (reader.Read())
                        {
                            myTestData.Clear();
                            for (int i = 0; i < howManyColumns; i++)
                            {
                                ///Add columns to myTestData list
                                myTestData.Add(reader.GetValue(i).ToString());
                            }
                            ///Add myTestData list to dataRows
                            dataRows.Add(myTestData);
                        }
                    }
                    catch (SqlException exSql)
                    {
                        Program.displayExError(exSql, true);
                    } 
```

问题在于：

```
myTestData.Clear(); 
```

我尝试清除列表，所以下次我将一个列表添加到我的列表列表中时，它将没有元素并避免将所有行附加到同一个列表中，但是如果我这样做`myTestData.Clear();`，列表内容将被删除并且我的列表列表也丢失了所有内容，有什么想法可以在不附加到第一个列表的情况下保留数据？

PS：我所做的修复是添加`myTestData.Clear();`导致问题的原因，但是如果我将其删除，所有行都将附加到第一个 List 并且也没有用。如果问题不清楚，请告诉我以尝试澄清

谢谢各位！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:01:27.297

将`myData`其视为您要添加的对象引用`dataRows`- 当您清除`myData`保留的引用时，`dataRows`反映了同样的变化。

`List<string>`因此，每次从数据读取器读取一行时，您都需要简单地创建一个新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:00:17.223

我觉得你`List<List<string>>`在这个例子中被称为 dataRows 。

您可以创建一个新列表并存储它，而不是清除列表，这仍会添加对 dataRows 列表的引用：

```
try
{
  ///Open connection before we can read
  dataConnection.Open();

  ///Prepare to read
  reader = dataCommand.ExecuteReader();

  // Call Read before accessing data.
  while (reader.Read())
  {
    List<string> myTestData = new List<string>();
    for (int i = 0; i < howManyColumns; i++)
    {
      ///Add columns to myTestData list
      myTestData.Add(reader.GetValue(i).ToString());
    }
    ///Add myTestData list to dataRows
    dataRows.Add(myTestData);
  }
}
catch (SqlException exSql)
{
  Program.displayExError(exSql, true);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:56:01.067

您需要创建一个新列表，而不是`Clear`ing 现有列表。更改`mydata.Clear()`为`myData = new List<string>()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T22:59:45.577

我会冒险猜测并说您必须在 for 循环中重新初始化列表，而不是

```
myTestData.Clear(); 
```

尝试

```
myTestData = new List<string>(); 
```

# c# - 建模业务层次结构

> ID：15648878
> 
> 赞同：1
> 
> 时间：2013-03-26T22:49:50.800
> 
> 标签：c#, design-patterns

我有一个仪表板应用程序，用户可以在其中上下导航“业务实体”的层次结构并查看该实体的数据。

层次结构如下

```
 Company
    |           |
 Office DepartmentGroup
               |
    |   Department
          |
    Section
        |
    Employee 
```

我怎样才能最好地使用对象进行建模。我有一个想法，我会有一个 IEntity 接口，如：

```
public interface IEntity
{
    int EntityKey { get; set; }
    string EntityCode { get; set; }
    string EntityName { get; set; }
    List<IEntity> Children { get; set; }
    List<IEntity> Parents { get; set; }
} 
```

我应该如何为我的具体类建模以强加这种结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T08:18:13.390

我在这里担心的是，引用 IEntity 会消除引用具体类型列表的好处。如果一个部门只能包含部分，那么我将拥有一个属性是`IList<Department>`（或者`IList<IDepartment>`如果你是害羞的）。

恕我直言，开放和通用模型（`IList<IEntity>`）存在更多问题，不一定值得从它提供的灵活性中受益。

# c# - Kendo TabStrip：将父模型传递给 MVC 4 中的 ChildAction

> ID：15648883
> 
> 赞同：1
> 
> 时间：2013-03-26T22:50:12.707
> 
> 标签：c#, asp.net, asp.net-mvc, kendo-ui, kendo-asp.net-mvc

我在 MVC 4 中定义了一个 Kendo UI Tab Strip：

```
@model SearchUserModel

@(Html.Kendo().TabStrip()
  .Name("tabMain")
  .Items(items =>
      {
          items.Add()
               .Text("Search")
               .Content(Html.Action("Form","SearchUser").ToString()).Selected(true);
          items.Add()
               .Text("Manage User")
               .Action("Index", "ManageUser");

      })
  .Animation(false)
  ) 
```

ChildAction“表单”与该父级在**同一个**控制器“SearchUser”上。

**问题：**如何将父母的**SearchUserModel**传递给 "Form"/"SearchUser" **ChildAction**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:19:21.563

您应该能够使用 Html.Action() 助手的 routeValues 参数传递模型，如下所示：

```
Html.Action("Form", "SearchUser", new { model = Model }) 
```

然后你只需要修改你的控制器动作来接受模型作为参数：

```
public ActionResult Form (SearchUserModel model)
{
} 
```

# android - 在 android 中访问 gmail 标签 api

> ID：15648884
> 
> 赞同：1
> 
> 时间：2013-03-26T22:50:17.343
> 
> 标签：android, gmail

我在 Play 商店中有一个读取 gmail 标签的应用程序（基于谷歌博客上提供的示例应用程序）

它适用于大多数人，但对于某些人来说，他们从应用程序中收到以下错误：

```
 "java.lang.SecurityException: Permission Denial: reading com.google.android.gm.provider.PublicContentProvider uri content://com.google.android.gm/test@example.com/labels from pid=29069, uid=10087 requires com.google.android.gm.permission.READ_CONTENT_PROVIDER, or grantUriPermission()" 
```

我正在使用的代码是：

```
Cursor c = context.getContentResolver().query(GmailContract.Labels.getLabelsUri(accountName),null, null, null, null); 
```

我的清单文件有：

```
<uses-permission android:name="com.google.android.gm.permission.READ_CONTENT_PROVIDER" /> 
```

因此，我不知道为什么有些人会收到此错误。不仅仅是少数人，有超过 100 人报告了这个（但成千上万的人没有）

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:58:53.873

我对java不熟悉。但是，[Sms Backup Plus](https://github.com/jberkel/sms-backup-plus)应用程序包含类似的功能。值得考虑。

# erlang - Erlang：正确地将数据存储在记录中并检索它？

> ID：15648885
> 
> 赞同：0
> 
> 时间：2013-03-26T22:50:18.630
> 
> 标签：erlang, record

我用输出运行了以下代码

```
Erlang R16B (erts-5.10.1) [smp:8:8] [async-threads:10]

Eshell V5.10.1  (abort with ^G)
1> rr(record_io).
[memory]     
2> record_io:store(99).
stored: 2
ok
3> record_io:print().
stored: 2
ok
4> 
```

我想知道的是如何正确地将值存储到记录中，显然输出`record_io:print().`应该是`99`而不是`2`。这是代码。

```
-module(record_io).
-export([store/1, print/0]).
-record(memory, {value}).

store(Value) ->
    #memory{ value = Value},
    io:format("stored: ~p~n",[#memory.value]).

print() ->
    io:format("stored: ~p~n",[#memory.value]). 
```

我尝试了另一种方法，但也没有用。

```
4> c(record_io).
record_io.erl:6: Warning: a term is constructed, but never used
{ok,record_io}
5> rr(record_io).
[memory]
6> record_io:store(S,10).
* 1: variable 'S' is unbound
7> 
```

修改后的record_io的代码。

```
-module(record_io).
    -export([store/2, print/1]).
    -record(memory, {value}).

    store(S,Value) ->
        S#memory{ value = Value},
        io:format("stored: ~p~n",[S#memory.value]),
        S.

    print(S) ->
        io:format("stored: ~p~n",[S#memory.value]). 
```

**编辑：**解决方案。

编码

```
-module(record_io).
-export([store/1, print/1]).
-record(memory, {value}).

store(Value) ->
   Rec2 = #memory{ value = Value},
   io:format("stored: ~p~n",[Rec2#memory.value]),
   Rec2.

print(S) ->
   io:format("stored: ~p~n",[S#memory.value]). 
```

命令行。

```
Rec = record_io:store(99).
record_io:print(Rec).
stored: 99
{memory,99}
stored: 99
ok 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:34:45.723

您不能在 Erlang 中修改记录。只创造新的。请参阅[如何在 erlang 中修改记录？](https://stackoverflow.com/questions/2715517/how-do-i-modify-a-record-in-erlang)

# javascript - Imacros Eval 函数 需要小帮助

> ID：15648891
> 
> 赞同：0
> 
> 时间：2013-03-26T22:50:51.210
> 
> 标签：javascript, imacros

您好，请帮帮我

这是整个脚本的中间片段（编号和星号仅供参考）

```
1) ONDOWNLOAD FOLDER=C:\MyFiles\ FILE=captcha.jpg WAIT=YES
2) TAG POS=1 TYPE=IMG ATTR = *******
3) *****
4) ****
5) ***
6) SET !VAR1 {{!EXTRACT}}
7) TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:CAPTCHABox ATTR=ID:tokentext CONTENT= {{!EXTRACT}}
8 TAG POS=1 TYPE=BUTTON ATTR=ID:continue 
```

然后在第 8 步之后

我希望它检查这个元素

```
TAG POS=1 TYPE=H1 ATTR=TXT:Check 
```

如果它存在，则前进到代码的下一行（步骤 9、10 等），否则如果它不存在或给出错误，那么我希望它重复从 1 到 8 的步骤，然后再次检查，如果元素不存在再次重复 1-8 否则前进到第 9 步，依此类推..

我认为可以在其中使用 EVAL 函数，您能否提供正确的代码？我尝试了很多次但失败了

Ps - 如果可能的话，我已经从 .vbs 循环整个脚本，请提供只能在 .iim 中使用的代码

请回复

非常非常感谢你

编辑 - 这是我的 .vbs 代码

```
Option Explicit

Dim iim1, i, s , shell
dim iret
dim myname, mypath
dim pos

'initialize iMacros instance
set iim1= CreateObject ("iMacros")

'i = iim1.iimOpen ("-fx", false) 'Use open Firefox instance if available
i = iim1.iimOpen ("-fx", true) 'Always open new instance

pos = 2

Do while pos < 5

iret = iim1.iimSet("loopVar",Cstr(pos))
iret = iim1.iimPlay("ecc2.iim")

set shell=createobject("wscript.shell")
shell.Run "%comspec% /c C:\Users\SDFL\Desktop\dc1.bat"

pos = pos + 1
loop 
```

请告诉我如何在不干扰主循环和 bat 文件的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:36:11.650

您不能在纯 IIM 脚本中执行此操作，因为它无法在代码中循环代码。您需要在 javascript 或主 vbs 代码中管理循环和验证，但不需要在 IIM 代码中使用 EVAL

# mysql - 将语义数据存储在 ID 中总是一个糟糕的主意吗？

> ID：15648902
> 
> 赞同：4
> 
> 时间：2013-03-26T22:52:03.337
> 
> 标签：mysql, database-design

这是几个（不完整的）数据库表，用于存储有关酒店房间的信息。它们存储的信息是相同的，但它们的设计不同：

1.  将楼层信息存储在单独的列中：

    ```
    | id | floor 
    |----|-------
    | 1  | 1 
    | 2  | 1 
    | 3  | 2 
    | 4  | 2 
    ```

2.  将楼层信息存储在 ID 中。

    ```
    | id 
    |-----
    | 101  
    | 102  
    | 201  
    | 202 
    ```

以表 2 的方式将语义数据存储在 ID 中总是一个糟糕的主意，或者是否存在具有更具表现力的 ID 足以证明其合理性的情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T02:21:49.323

如果要使用自然键，请使用自然键。不要命名自然键`id`。

如果您使用合成键，请将其视为必须唯一但没有其他含义的任意值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T02:02:09.217

这实际上与数据的语义无关，而是关于[原子性](http://en.wikipedia.org/wiki/1NF#Atomicity)以及您是否会违反 1NF。你应该问自己的问题是：

***从数据管理的角度来看**，房间号是否应该被视为一个**原子**数据？*

 **换句话说，您是否总是从数据库中读取（和写入）整个房间号（无论您是否在客户端代码中将其视为一个整体）？

*   如果是，您可以安全地将其设置为单个属性（如果需要，则将其设置为键或键的一部分）。您是否*还会*有代理键是另一回事（如下文简要介绍的）。
*   如果不是（例如：因为您需要查询楼层，或者将楼层用作 FK 等），那么您必须将其拆分为单独的属性（例如楼层 + 每楼层的房间），否则您将违反1NF。

注意：我不知道这是否是故意的，但您的场景 (1) 不包含足够的数据来重建房间号，因此与场景 (2) 相比，它模拟了不同的域。

* * *

顺便说一句，将语义数据存储在密钥中本身并不是一个坏习惯。如果某些属性或属性组合必须是唯一的，那么您必须在它们上创建一个键，无论它们是否具有内在含义。您不能用“代理”键替换该键，您只需添加代理（正如您可以想象的那样，它有其[优点和缺点）。](https://stackoverflow.com/tags/surrogate-key/info)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:58:13.110

在表的主键中包含语义肯定是个坏主意。

表中主键的用途是：

*   要独一无二，
*   用作记录的标识。

如果你把这样的语义放在主键中，那么你假设：

*   所有房间都有一层，
*   酒店不会超过一家，
*   房间号不能有字母。

这些假设在未来很容易分崩离析。然后您将需要更改现有记录的主键 - 这将使它们不再是记录的标识。

这种逻辑也可以应用于其他情况。例如，您可以使用条形码作为书籍的唯一标识符，但将来您可能会拥有没有条形码的书籍。

话虽如此，我什至会更进一步，将您原来的表格更改为`id`,`room_number`和`floor`. 由于迷信，`1301`有些酒店没有房间号之类的。`1302`但这并不意味着他们没有 13 楼。

最后回答你的问题——这可能并不总是一个糟糕的主意，但我想不出一个例子来说明这不是一个坏主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-26T23:23:55.517

我说是的，这是一个非常糟糕的主意。id 的想法是它是可能替代多列键的行的单列唯一标识符。如果您将列称为“id”，则查看您的架构的任何人都需要一个主键。知道那个东西是地板的表示，你也*失去了语义价值。*

如果您没有 id 列，并且只需将该列称为“floor”，那就可以了。您关心的是，如果您需要查找特定记录，您能做到吗？如果您的特定应用程序除了查找楼层不需要任何其他信息，则继续使用“楼层”作为列名并且不要添加 ID 列。但是，如果您有一个复合键，例如 floor 和 hotel id，那么您可能希望再次添加 id 列作为“快捷方式”单列键，您可以将其用作其他表中的外键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T23:34:16.673

是的，这总是一个糟糕的主意：

*   如果稍后“价值”发生变化，您也必须更改 ID，这是一个更糟糕的主意
*   如果您发现必须在具有数字相邻 ID 的两个现有行之间插入一个值的数据，则新 ID 没有空间
*   ID 的目的是唯一标识行。如果 ID coveys 信息，你正在超载它的角色，这在编程中从来都不是一个好主意
*   如果您将信息隐藏在 ID 中，则必须再次将其*提取*出来，这会将代码带到任何使用它的*地方*，这意味着努力和维护
*   您可能使用的任何框架都将无法使用您的“优化”；他们会期望值在列中，而不是在 ID 的片段中
*   无论如何，您到底在节省什么？磁盘很便宜，软件/硬件现在这么快，节省的钱可以忽略不计，而且永远不会超过负面影响

我过去自己做过，并且一直后悔这样做，因为你无法预测未来，而业务和数据会以你无法预测的方式发生变化。将自己锁定在任何特定的世界观中都是危险的。事实上，我见过的每一个案例都是这样做的，它会导致很多问题。

[吻](http://en.wikipedia.org/wiki/KISS_principle)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-25T19:41:21.427

用最重要的数字标识楼层的数字来标识房间绝对没有错。我想我住过的每一家酒店都是这样的。我敢肯定，您的表中必须有这样的房间号属性。

自己和别人的疑惑都是因为你把房间号称为“id”。房间号是一个标识符 - 大概它是唯一真正重要的房间标识符 - 但如果这是您的属性所指的，那么只需将其称为“房间号”，而不是“id”。**

# javascript - 页面刷新后 Greasemonkey 快照已过时？

> ID：15648903
> 
> 赞同：1
> 
> 时间：2013-03-26T22:52:12.417
> 
> 标签：javascript, jquery, greasemonkey

**场景：**编写一个 Greasemonkey 脚本，在 BBC 体育直播报道中隐藏 Twitter 评论（由类“class-TWEET”的列表元素表示）。

使用waitForKeyElements，我设法得到了一些大致有效的东西（下面的警告）：

```
// ==UserScript==
// @name        myName
// @namespace   none
// @description myDescription
// @include     http://www.bbc.co.uk/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js
// @require     https://gist.github.com/raw/2625891/waitForKeyElements.js
// @version     2.0
// @grant       none
// ==/UserScript==

function doHousekeeping(jNode) {

//Find all tweet items within the commentary, and hide them
var snapResults = document.evaluate(".//div[@id='live-event-text-commentary']/ol/li[contains(@class,'class-TWEET')]", document.body, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);
for (var i = snapResults.snapshotLength - 1; i >= 0; i--) {
      snapResults.snapshotItem(i).style.display="none"; 
  }
}

// Cleanup on initial load
doHousekeeping();

// Repeat cleanup whenever the main body changes
waitForKeyElements ("#live-event-text-commentary", doHousekeeping); 
```

**问题：**当页面刷新时，doHousekeeping*确实*执行（并隐藏了*大部分*有问题的项目）；但是，少数最近的违规项目仍保留在页面顶部。

为什么它不能隐藏所有这些？我的怀疑是，当正文发生变化时，文档/快照没有被刷新。我也是 jQuery 的新手，所以我知道我的家务功能既老派又不理想；任何对更清洁、功能齐全的实施的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:47:25.530

问题似乎是您想要隐藏的内容与提供给的选择器不匹配`waitForKeyElements`。

在这种情况下正确的使用方法`waitForKeyElements`是：

```
// ==UserScript==
// @name        myName
// @namespace   none
// @description myDescription
// @include     http://www.bbc.co.uk/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js
// @require     https://gist.github.com/raw/2625891/waitForKeyElements.js
// @version     2.0
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

//-- Find all tweet items within the commentary, and hide them.
waitForKeyElements (
    "#live-event-text-commentary ol li.class-TWEET",
    doHousekeeping
);

function doHousekeeping (jNode) {
    jNode.hide ();
} 
```

另外，不要使用`@grant none`，因为这会导致片状副作用。

# entity-framework - 如何从实体框架中删除约束？

> ID：15648905
> 
> 赞同：2
> 
> 时间：2013-03-26T22:52:19.160
> 
> 标签：entity-framework

我从数据库生成了 EF 图，但我决定不设计数据库并生成 edmx，而是设计图并从中生成数据库。

但是，当我从数据库生成图表时仍然存在一些我似乎无法删除的限制。一个约束是针对不再存在的列，因此 .edmx 会引发错误。

我有什么办法可以消除这个限制吗？我不想从数据库中删除它并从数据库中更新，因为我对图表进行了很多更改并且不想再次重做它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T23:20:07.847

.edmx 文件实际上只是一个 XML 文件。如果情况变得更糟，如果你小心的话，你总是可以直接在文本编辑器中编辑它。查找与您感兴趣的约束匹配的关联和关联集，然后删除这些标签。然后保存文件并在 Visual Studio 中重新打开。请注意，如果您这样做，我建议您先备份文件，以防您在某处出错，然后您可以恢复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:10:18.800

从设计器中删除该列后，尝试**Clean Solution**然后**Rebuild Solution**。此时您应该能够删除约束。

# c++ - 为什么这个乘法中有整数溢出？

> ID：15648906
> 
> 赞同：6
> 
> 时间：2013-03-26T22:52:19.480
> 
> 标签：c++

我对这个代码片段感到困惑：

```
#include <climits>
#include <iostream>
int main(void) {
    using namespace std;
    cout << "long max " << LONG_MAX << endl;
    long x = 2 * 1024 * 1024 * 1024;
    cout << "2 * 1024 * 1024 * 1024 = " << x << endl;
    return 0;
} 
```

我期待**2147483648**应该是这样，但我得到了。使用无符号似乎没有帮助。是什么赋予了？

```
long max 9223372036854775807
2 * 1024 * 1024 * 1024 = -2147483648 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T22:53:29.980

添加一些`L`s*。`long x = 2L * 1024L * 1024L * 1024L;`

（从技术上讲，只要一个文字是类型`long`，其他文字就会被提升为`long`）

发生溢出是因为`2`, etc.`int`默认是类型，并且溢出发生*在*赋值之前。

请参阅解释不同文字的[整数文字。](http://en.cppreference.com/w/cpp/language/integer_literal)

# javascript - 两个数组，其中数组 x 中的项目可以在数组 y 中，但反之不行，测试所有排列

> ID：15648911
> 
> 赞同：2
> 
> 时间：2013-03-26T22:52:24.637
> 
> 标签：javascript, arrays, for-loop, bit-manipulation, powerset

我编写的一个小应用程序允许用户将各种项目添加到两个数组中。一些逻辑根据每个数组的内容计算一个数字。

数组 x 中的任何项目都可以放入数组 y 中，然后再放回去。属于数组 y 的项永远不能移动（除非它们是从数组 x 中移动的）。

用户可以使用简单的 javascript ui 在两个列表中移动这些项目。为了让事情更简单，我最初制作了一个简单的脚本：

1.  将项目从 a 移动到 y。
2.  使用这种“可能性”执行了一些逻辑
3.  如果结果小于以前，则将 x 留在 y 中。
4.  如果不是，则 x 保留在 x 中。
5.  移动到 x 中的下一项并重复。

我知道这是无效的。我已经阅读并被告知使用按位数学来记住可能性或“排列”，但在这个阶段我正在努力解决这个特定问题。

如果有人能够解释（伪代码很好）什么是实现以下目标的最佳方法，我将不胜感激。

数组 x = [100,200,300,400,500] 数组 y = [50,150,350,900]

使用这两个数组，对于来自 x 的每个值，将该值和来自 x 的所有其他值的每个组合推入数组 y。对于每一个，我将执行一些逻辑（即测试结果并将这个“排列”存储在一个数组中（一个代表 x 和 y 的两个数组的对象）。我预见这对于大型数组来说非常昂贵，可能会重复很多我觉得我快到了，但在最后阶段迷路了。

抱歉，解释太长了，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:59:23.543

使用它来创建 的[幂](http://en.wikipedia.org/wiki/Power_set)集`x`：

```
function power(x, y) {
    var r = [y || []], // an empty set/array as fallback
        l = 1;
    for (var i=0; i<x.length; l=1<<++i) // OK, l is just r[i].length, but this looks nicer :)
        for (var j=0; j<l; j++) {
            r.push(r[j].slice(0)); // copy
            r[j].push(x[i]);
        }
    return r;
} 
```

用法：

```
> power([0,2], [5,6])
[[5,6,0,2], [5,6,2], [5,6,0], [5,6]] 
```

* * *

> 有人告诉我使用按位数学来记住可能性或“排列”，但在这个阶段我正在努力解决这个特殊问题。

它将迭代到 2 ^n（对于长度为 n 的数组），使用单个位来确定项目是否应包含在子集中。数组 [a,b] 的示例：

```
i   binary   included in set
-----------------------------
0   00       {      }
1   01       {    b }
2   10       { a    }
3   11       { a, b } 
```

我们可以在 JS 中对最多包含 31 个项目的数组使用[位运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)（这应该足够了）。

```
function power(x, y) {
    var l = Math.pow(2, x.length),
        r = new Array(l);
    for (var i=0; i<l; i++) {
        var sub = y ? y.slice(0) : [];
        for (var j=0; j<x.length; j++)
            // if the jth bit from the right is set in i
            if (i & Math.pow(2,j)) // Math.pow(2,j) === 1<<j
                sub.push(x[j]);
        r[i] = sub;
    }
    return r;
} 
```

# php - mysql_fetch_array mysql_num

> ID：15648915
> 
> 赞同：-2
> 
> 时间：2013-03-26T22:53:02.580
> 
> 标签：php, mysql, arrays

我收到以下警告：

```
warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given. 
```

当我尝试这段代码时：

```
$wyn_sport = mysql_query("SELECT a.title, a.content, a.id, FROM article a
LEFT JOIN section s
ON a.id`enter code here`_section=s.id
WHERE s.name='Sport'
ORDER BY date_art desc");
$sport = mysql_fetch_array($wyn_sport, MYSQL_NUM);

$wyn_film = mysql_query( "SELECT a.title, a.content, a.id FROM article a
LEFT join section s on a.id_section=s.id
WHERE s.name='Film'
ORDER BY date_art desc");
$film = mysql_fetch_array($wyn_film, MYSQL_NUM);

$wyn_nauka = mysql_query( "SELECT a.title, a.content, a.id FROM article a
LEFT join section s on a.id_section=s.id
WHERE s.name='Nauka'
ORDER BY date_art desc");
$nauka = mysql_fetch_array($wyn_nauka, MYSQL_NUM); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:07:06.977

@winterblood 已经指出了这一点，但这显然是问题所在......您`enter_code_here`的查询中有一些随机的不属于它的地方

```
 $wyn_sport = mysql_query("SELECT a.title, a.content, a.id, FROM article a
    LEFT JOIN section s
    ON a.id =s.id
    WHERE s.name='Sport'
    ORDER BY date_art desc");
    if(!$sport = mysql_fetch_array($wyn_sport, MYSQL_NUM)){
    echo mysql_error();

} 
```

以上应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:56:38.680

这可能意味着您的查询失败并返回`false`。然后，您尝试`mysql_fetch_array()`执行`false`.

# java - Java中两个远程类之间的消息

> ID：15648921
> 
> 赞同：0
> 
> 时间：2013-03-26T22:53:35.530
> 
> 标签：java, game-engine, slick2d, class-structure

我已经在 J​​ava 游戏上工作了几个月，但我遇到了一个问题。

我`Player`在一个里面走来走去`Environment`，里面是由都有自己的瓷砖组成的`CollisionBox`。简而言之：当`Player`'`CollisionBox`与另一个碰撞`CollisionBox`（如盒子或其他东西）时，玩家无法移动。那部分得到了照顾。

我正在尝试引入`InteractiveTile`s，`Player`如果它与特定`CollisionBox`的 （例如楼梯或门）发生碰撞，将导致某些事情发生。`Environment`具体来说，如果特定 *InteractiveTile* 被击中，我希望能够转换到新的。

我有转换和重绘碰撞贴图的功能，但我不知道如何让碰撞事件告诉*环境*（这在碰撞事件的代码层次结构中并不方便）。

我熟悉观察者模式，其中`Environment`可以“听到”这种冲突，但我不确定它会如何在这里实现，或者即使这是适合这种情况的正确设计模式！

更简单的...

当`Player.IsCollidingWithDoorLeadingToNewEnvironment(newEnvironment)`被调用时，`Environment.TransitionToNewEnvironment(newEnvironment)`应该被调用，但它们在代码结构中彼此相距甚远。

更广泛地说：如何在没有层层方法/构造函数注入的情况下在两个类之间发送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:13:35.673

你听说过模型-视图-控制器模型吗？这没什么花哨的，但也许会有所帮助。基本上，您的程序将包含三个部分：

1.  模型 - 这些是您问题中的所有斜体字，它们代表程序中相互作用以构成它的部分。
2.  查看 - 显示；在这里没有那么重要，就像事物被绘制到屏幕上一样
3.  控制器 - 这是我认为会帮助你的。这是一个贯穿整个节目的课程。此类控制程序的模型组件中生成的所有部分，这就是允许它们进行通信的原因。我想在您的情况下，Environment 类可能对此有好处。

您的控制器类可能包含数组/ArrayLists，其中包含游戏期间生成的所有部分，例如 CollisionBoxes。每个 CollisionBox（我只是用这个作为例子）可以有一个实例变量（可能称之为 id），它代表它在数组中的位置（它可以像索引一样简单，一个 int）。当两个 Box 发生碰撞时，您可以调用控制器类中的方法来获取这两个 id，并且这些 id 可以方便地引用它们在数组中的位置。当然，您可以使用其他数据结构，但我希望这可以为您提供基本概念。

# android - 更改到另一个选项卡时，片段中的 ListView 会丢失

> ID：15648932
> 
> 赞同：1
> 
> 时间：2013-03-26T22:54:15.100
> 
> 标签：android, listview, android-fragments

我有一个活动`ActionBar`和`tabs`。每个选项卡代表一个片段，所有片段都在唯一的活动中运行。

我在第一个里面有一个 Spinner 和一个 ListView `fragment`。当在 Spinner 中选择项目时，ListView 的数据被修改并正确显示。

当我选择第二个选项卡，在那里做某事并导航回第一个选项卡时，就会出现问题。之后`ListView`在 Spinner 上选择项目时不会更新。

**路由片段：**

```
public class RouteFragment extends FragmentBase {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
            Bundle savedInstanceState) {

        View fragView = inflater.inflate(R.layout.route, container, false);

        Spinner spinner = (Spinner) fragView.findViewById(R.id.route_list);
        ArrayAdapter<Route> routeListAdapter = new ArrayAdapter<Route>(this.getActivity(), 
                android.R.layout.simple_spinner_item, 
                this.adapter.getRouteList());
        spinner.setAdapter(routeListAdapter);

        long routeId = ((Route) spinner.getSelectedItem()).Id;

        ListView lv = (ListView) fragView.findViewById(R.id.client_list);
        final ClientAdapter clientListAdapter = new ClientAdapter(this.getActivity(), 
                R.layout.route_listview,
                this.adapter.getClientList(routeId));
        lv.setAdapter(clientListAdapter);

        routeListAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

        spinner.setOnItemSelectedListener(new RouteSpinnerItemSelectedListener(lv));

        return fragView;
    }
} 
```

**RouteSpinnerItemSelectedListener：**

```
public class RouteSpinnerItemSelectedListener implements OnItemSelectedListener {

    private ListView lv;

    public RouteSpinnerItemSelectedListener(ListView fragView) {
        this.lv = fragView;
    }

    @Override
    public void onItemSelected(AdapterView<?> parent, View view,
            int position, long id) {

        Route route = (Route) parent.getItemAtPosition(position);

        android.util.Log.v("Salesman", "selected route id: " + route.Id);
        android.util.Log.v("Salesman", "selected route name: " + route.Name);

        ClientAdapter clientAdapter = (ClientAdapter) lv.getAdapter();

        Log.v("Salesman", "before clear: " + clientAdapter.getCount() + "");

        clientAdapter.clear();

        Log.v("Salesman", "after clear: " + clientAdapter.getCount() + "");

        List<Client> clientList = DataAdapter.getInstance(Main.getContext())
        .getClientList(route.Id);

        Log.v("Salesman", "raw from DB" + clientList.size() + "");

        clientAdapter.addAll(clientList);

        Log.v("Salesman", "after addAll()"  +  clientAdapter.getCount() + "");
        clientAdapter.notifyDataSetChanged();
    }

    @Override
    public void onNothingSelected(AdapterView<?> parent) {
        // TODO Auto-generated method stub

    }
} 
```

**选项卡监听器：**

```
public class TabListener implements ActionBar.TabListener {
    private FragmentBase mFragment;

    public TabListener(FragmentBase fragment) {
        this.mFragment = fragment;
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        ft.add(R.id.fragment_content, mFragment, mFragment.getName());
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        ft.remove(mFragment);
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        android.util.Log.v("Salesman", "reselected");
    }

} 
```

我从数据库中获得的List`clientList`不是空的，我已经检查过了，正如您在代码中看到的那样。但是，ListView 是空的并且没有反应并且保持为空。

我想关键是我在某个地方丢失了我的 ListView，但我只是不明白在哪里。

还有一件事：只有当我从一个选项卡移动到另一个选项卡时才会出现该问题。当我移动到我的应用程序中的另一个活动然后返回时，我仍然可以看到列表视图（它不是空的）并且可以更新它。

你能指点一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T06:11:41.383

我认为这发生在状态改变后处理片段事务时，

```
getFragmentManager().beginTransaction().show(fragment).commitAllowingStateLoss(); 
```

或者

```
getFragmentManager().beginTransaction().add(R.id.layout,fragment).commitAllowingStateLoss(); 
```

或者

```
getFragmentManager().beginTransaction().replace(R.id.layout,fragment).commitAllowingStateLoss(); 
```

接着，

```
getFragmentManager().executePendingTransactions(); 
```

**已编辑...** RouteSpinnerItemSelectedListener

```
public class RouteSpinnerItemSelectedListener implements OnItemSelectedListener {

private ListView lv;

public RouteSpinnerItemSelectedListener(ListView fragView) {
    this.lv = fragView;
}

@Override
public void onItemSelected(AdapterView<?> parent, View view,
        int position, long id) {
 if(lv!=null)
 {
    Route route = (Route) parent.getItemAtPosition(position);

    android.util.Log.v("Salesman", "selected route id: " + route.Id);
    android.util.Log.v("Salesman", "selected route name: " + route.Name);

    ClientAdapter clientAdapter = (ClientAdapter) lv.getAdapter();
   if(clientAdapter !=null)
   {
    Log.v("Salesman", "before clear: " + clientAdapter.getCount() + "");

    clientAdapter.clear();

    Log.v("Salesman", "after clear: " + clientAdapter.getCount() + "");

    List<Client> clientList = DataAdapter.getInstance(Main.getContext())
    .getClientList(route.Id);

    Log.v("Salesman", "raw from DB" + clientList.size() + "");

    clientAdapter.addAll(clientList);

    Log.v("Salesman", "after addAll()"  +  clientAdapter.getCount() + "");
    clientAdapter.notifyDataSetChanged();
   }
   else
   {
      ClientAdapter clientAdapter = = new ClientAdapter(this.getActivity(), 
            R.layout.route_listview,
            this.adapter.getClientList(routeId));
      List<Client> clientList = DataAdapter.getInstance(Main.getContext())
      .getClientList(route.Id);
      clientAdapter.clear();
      clientAdapter.addAll(clientList);
      lv.setAdapter(clientListAdapter);
   }
 }
 else
 {
      lv=(ListView)getActivity.findViewById(R.id.route_list);
      ClientAdapter clientAdapter = = new ClientAdapter(this.getActivity(), 
            R.layout.route_listview,
            this.adapter.getClientList(routeId));
      List<Client> clientList = DataAdapter.getInstance(Main.getContext())
      .getClientList(route.Id);
      clientAdapter.clear();
      clientAdapter.addAll(clientList);
      lv.setAdapter(clientListAdapter);
 }
}

@Override
public void onNothingSelected(AdapterView<?> parent) {
    // TODO Auto-generated method stub

 }
} 
```

# css - 移动设备上的高度问题

> ID：15648935
> 
> 赞同：0
> 
> 时间：2013-03-26T22:54:24.307
> 
> 标签：css, mobile, height

我正在编写一个移动网站。这是我第一次这样做，所以我不知道我做错了什么。

如果文本适合页面的高度，一切都很好，但是当它高于移动屏幕的高度时，页面会变得混乱（它在页面的右侧添加了填充，我在那里有一些空白）。

我试过了

```
body { height: auto } 
```

和

```
body { height:100% } 
```

我确定我做错了什么。请帮忙。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:00:33.710

我相信你的问题是因为屏幕正在自动安装，因为尺寸是关闭的，为避免这种情况，你应该在页面顶部插入这段方便的代码

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

它摆脱了一些移动浏览器的自动适配。[Mozilla这里](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)有一个例子。

还要看看响应式 CSS 媒体查询，因为它们（在我看来）是处理移动设备的最佳方式。[Brad Frost](http://bradfrost.github.com/this-is-responsive/)是学习响应式设计的绝佳人选。

希望有帮助。

# ios - iOS模拟器：如何在命令行上指定窗口方向？

> ID：15648936
> 
> 赞同：1
> 
> 时间：2013-03-26T22:54:30.490
> 
> 标签：ios, command-line, orientation, simulator, device-orientation

我正在从命令行运行 iOS 模拟器，并且我有一个仅限横向的应用程序。不幸的是，当我在模拟器中运行这个应用程序时，它仍然处于纵向模式。从命令行运行模拟器时，有没有办法指定应用程序的默认方向？

# eclipse - 使用 Maven + Eclipse + Tomcat 开发 jersey restfull web 服务。404问题

> ID：15648937
> 
> 赞同：1
> 
> 时间：2013-03-26T22:54:30.863
> 
> 标签：eclipse, maven, restful-url

我无法访问我的示例宁静服务。请让我知道问题出在哪里。

以下是代码片段：

**pom.xml：**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<groupId>com.sample</groupId>
<artifactId>RestFulService</artifactId>
<version>0.0.1-SNAPSHOT</version>
<packaging>war</packaging>

<name>RestFulService</name>
<url>http://maven.apache.org</url>

<dependencies>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.4</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-server</artifactId>
        <version>1.17.1</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-servlet</artifactId>
        <version>1.17.1</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-bundle</artifactId>
        <version>1.17.1</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.0.2</version>
        </plugin>
    </plugins>
</build> 
```

**Web.xml**

```
 <servlet>
    <servlet-name>RestfulContainer</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>com.sample</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>RestfulContainer</servlet-name>
    <url-pattern>/resources/*</url-pattern>
</servlet-mapping> 
```

如果我尝试使用以下 URL 访问我的示例服务，我最终会遇到 404 错误。

RestFulService --> 是生成的战争文件，我可以在 tomcate 管理器页面中看到该应用程序。

http://<>:8080/RestFulService/resources/sayHello

谢谢， Girish K

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T19:15:08.237

提供的范围仅在编译和测试类路径上可用，并且不可传递。

尝试使用这些依赖项

```
 <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-server</artifactId>
        <version>1.17</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-servlet</artifactId>
        <version>1.17</version>
    </dependency>
    <dependency>
        <groupId>javax.ws.rs</groupId>
        <artifactId>jsr311-api</artifactId>
        <version>1.1.1</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-client</artifactId>
        <version>1.17</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-json</artifactId>
        <version>1.17</version>
    </dependency>
    <dependency>
        <groupId>org.codehaus.jettison</groupId>
        <artifactId>jettison</artifactId>
        <version>1.3.2</version>
    </dependency>
    <dependency>
        <groupId>org.codehaus.jackson</groupId>
        <artifactId>jackson-jaxrs</artifactId>
        <version>1.9.12</version>
    </dependency> 
```

# perl - 如何将单行文本格式转换为多行文本？

> ID：15648938
> 
> 赞同：-3
> 
> 时间：2013-03-26T22:54:38.060
> 
> 标签：perl

我是新手，所以我需要一些帮助。例如，我在文件中有氨基酸序列。该序列在一行中。所以我需要在一行中应该有 60 个氨基酸。我怎么能用perl做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:05:41.710

这是一个设置结果宽度的小程序 - 但它应该给你的想法。

```
#!/usr/bin/perl
use strict;
use warnings;
use Bio::SeqIO;

my $in  = Bio::SeqIO->new( -file   => "fasta_junk.fasta" ,
                           -format => 'fasta');

my $out = Bio::SeqIO->new( -file   => '>test.dat',
                           -format => 'fasta');

my $lookup = 'GTGCCAGCAGCCGC';
$out->width(20);

while ( my $seq = $in->next_seq() ) {
    my $pos = index $seq->seq, $lookup;

    # if $pos != -1, ($lookup not found),
    # or $pos != 0, (found $lookup at first position, thus
    #   no preceding characters).
    if ($pos > 0) {
        my $trunc = $seq->trunc(1,$pos);
        $out->write_seq($trunc);
    }
} 
```

它产生了这个输出（宽度为 20），

```
>LM1
AAGTCTGACGGAGCAACGCC
GCGTGTATGAAGAAGGTTTT
CGGATCGTAAAGTACTGTCC
GTTAGAGAAGAACAAGGATA
AGAGTAACTGCTTGTCCCTT
GACGGTATCTAACCAGAAAG
CCACGGCTAACTAC 
```

fasta_junk.fasta 文件是

```
>LM1
AAGTCTGACGGAGCAACGCCGCGTGTATGAAGAAGGTTTTCGGATCGTAA
AGTACTGTCCGTTAGAGAAGAACAAGGATAAGAGTAACTGCTTGTCCCTT
GACGGTATCTAACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGG
TAATACGTAGGTGGCAAGCGTTGTCCGGATTTATTGGGCGTAAAGCGCGC
GCAGGCGGTCTTTTAAGTCTGATGTGAAAGCCCCCGGCTTAACCGGGGAG
GGTCATTGGAAACTGGAAGACTGGAGTGCAGAAGAGGAGAGTGGAATTCC
ACGTGTAGCGGTGAAATGCGTAGATATGTGGAGGAACACCAGTGGCGAAG
GCGACTCTCTGGTCTGTAACTGACGCTGAGGCGCGAAAGCGTGGGGAGCA
AACAGGATTAGATACCCTGGTAGTCCACGCCGT 
```

你可以自己玩不同的宽度来看看结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:56:54.873

```
open my $infile, '<', "/path/to/sequencefile" or die $!;
open my $outfile, '>', "/path/to/newfile" or die $!;

while(my $line = <$infile>) {
    print $outfile join("\n", split(/\s/, $line)) . "\n";
}

close $infile;
close $outfile; 
```

# wix - 不使用更新值的属性引用

> ID：15648940
> 
> 赞同：1
> 
> 时间：2013-03-26T22:55:15.790
> 
> 标签：wix, wix3.6

我正在尝试将`<util:User Id="UpdateServiceAccountLogonAsService" UpdateIfExists="yes" CreateUser="no" Name="[SERVICEACCOUNTFULL]" LogonAsService="yes"/>`logonAsService 授予 UI 指定的用户。此属性值在此*util* :User 在运行时得到处理之前已更新。

我知道这一点，因为我可以给 SERVICEACCOUNTFULL 属性一个默认值“localhost\defaultUserValue”并设置 CreateUser="yes"，它会在我的自定义操作设置属性值*后*生成关于显示原始值的运行时消息框错误。不知道为什么无法创建用户，但它显示了正确的时机。如果我将属性默认值硬编码为我将它们设置为动态（使用`CreateUser="no"`）的值，它就可以工作。

`<ServiceInstall />`作为同一组件的一部分，我拥有的标签正确地使用了属性的更新值，但`<util:User />`不会。

请记住，我正在验证 createUser 步骤是否发生在设置属性值的自定义操作程序之后。但现在我会奇怪地提到，createUser 操作的执行是在日志中，就在获取属性值的自定义操作的上方，以及 who `Before="InstallFiles"`.

帮助？谢谢！

===========

嗨，罗伯，

不完全确定你需要看什么，但我认为这些是相关的：

```
<Component Id="Service" Guid='*'>
  <File Source='$(var.root)My Service.exe' />
  <ServiceInstall Id="ServiceInstall"
    Name="MyServer"
    DisplayName="My Server"
    Type="ownProcess"
    Start="auto"
    ErrorControl="normal"
    Description="My Server Windows Service"
    Interactive="no"
    Account="[SERVICEACCOUNTFULL]"
    Password="[SERVICEACCOUNTPASSWORD]" />
  <ServiceControl Id="StopMyServer" Name="MyServer" Stop="both" Wait="yes" Remove="uninstall" />
  <util:User Id="UpdateServiceAccountLogonAsService" UpdateIfExists="yes" 
    CreateUser="no" Name="[SERVICEACCOUNTFULL]" LogonAsService="yes"/>
</Component>

...

<Binary Id="ConfigBinary" SourceFile="$(var.....TargetDir)$(var.Configuration.TargetName).CA.exe" />

<Property Id="Net">net.exe</Property>
<CustomAction Id="NetStart" Property="Net" ExeCommand="START MyServer" Return="check" />

<Property Id="PerformNetStart" Value="0" />
<CustomAction Id='SetPerformNetStart' Property='PerformNetStart' Value='1' />
<CustomAction Id="RunConfiguration" BinaryKey="ConfigBinary" DllEntry="RunConfiguration" Execute="immediate" Return="check" />
<CustomAction Id='IsPrivileged' Error='You must be an admin to install this feature' />

<InstallExecuteSequence>
    <Custom Action='IsPrivileged' Before='RunConfiguration'>
    <![CDATA[Not Privileged AND &FeatureServer > 2 ]]>
    </Custom>
    <Custom Action="RunConfiguration" Before="InstallFiles">
    <![CDATA[&FeatureServer > 2 AND Not Installed ]]>
    </Custom>
    <Custom Action="SetPerformNetStart" Before="InstallFiles">
    <![CDATA[&FeatureServer > 2 AND Not Installed ]]>
    </Custom>
    <Custom Action="NetStart" After="InstallFinalize">
    PerformNetStart = 1
    </Custom>
</InstallExecuteSequence> 
```

然后在 C# 中：

```
public static ActionResult RunConfiguration(Session session)
{
    session["SERVICEACCOUNTFULL"] = "MyDomain\svcAccount";
    session["SERVICEACCOUNTPASSWORD"] = "secret;

    return ActionResult.Success;
} 
```

以下是硬编码有效值运行的日志：

```
MSI (s) (F0:F8) [18:29:29:191]: Created Custom Action Server with PID 4796 (0x12BC).
MSI (s) (F0:CC) [18:29:29:211]: Running as a service.
MSI (s) (F0:CC) [18:29:29:213]: Hello, I'm your 32bit Impersonated custom action server.
MSI (s) (F0!48) [18:29:29:240]: PROPERTY CHANGE: Adding CreateUserRollback property. Its value is '**********'.
MSI (s) (F0!48) [18:29:29:243]: Doing action: CreateUserRollback
Action 18:29:29: CreateUserRollback. 
Action start 18:29:29: CreateUserRollback.
CreateUserRollback: 
Action ended 18:29:29: CreateUserRollback. Return value 1.
MSI (s) (F0!48) [18:29:29:247]: PROPERTY CHANGE: Adding CreateUser property. Its value is '**********'.
MSI (s) (F0!48) [18:29:29:247]: Doing action: CreateUser
Action 18:29:29: CreateUser. 
Action start 18:29:29: CreateUser.
CreateUser: 
Action ended 18:29:29: CreateUser. Return value 1.
Action ended 18:29:29: ConfigureUsers. Return value 1.
MSI (s) (F0:F0) [18:29:29:252]: Skipping action: IsPrivileged (condition is false)
MSI (s) (F0:F0) [18:29:29:252]: Doing action: RunConfiguration
Action 18:29:29: RunConfiguration. 
Action start 18:29:29: RunConfiguration.
MSI (s) (F0:E0) [18:29:29:286]: Invoking remote custom action. DLL: C:\Windows\Installer\MSIC008.tmp, Entrypoint: RunConfiguration
SFXCA: Extracting custom action to temporary directory: C:\Users\Jason\AppData\Local\Temp\MSIC008.tmp-\
SFXCA: Binding to CLR version v4.0.30319
Calling custom action ...Configuration!...RunConfiguration
Begin RunConfiguration
Setting MSI values from RunConfiguration
MSI (s) (F0!48) [18:29:47:629]: PROPERTY CHANGE: Modifying RUNTIMECONNECTIONSTRING property. Its current value is 'DEFAULT'. Its new value: 'Data Source=.;Initial Catalog=DB;Integrated Security=True'.
MSI (s) (F0!48) [18:29:47:629]: PROPERTY CHANGE: Modifying SERVICEACCOUNTFULL property. Its current value is 'MyDomain\DEFAULTVALUE'. Its new value: 'MyDomain\svcAccount'.
...
Returning from RunConfiguration 
```

它以这种向后的顺序记录，这可以解释问题，除了当我在 CreateUser="yes" 上做出 CreateUser 操作错误时，它显然在配置自定义操作返回后发生了几个节拍。但也许它以某种奇怪的方式排队，实际上执行顺序就是问题所在——在那种情况下，我仍然不知道如何控制该顺序。

这是您诊断的好信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:41:36.967

问题是您`RunConfiguration`设置元素使用的属性的自定义操作`User`运行得太晚了。而不是安排`RunConfiguration`before`InstallFiles`而是安排 before 的动作`ConfigureUsers`。就像是：

```
<Custom Action="RunConfiguration" Before="ConfigureUsers">
<![CDATA[&FeatureServer > 2 AND Not Installed ]]>
</Custom> 
```

# java - 可以使用 JAVA sdk 为不存在的 Azure SerivceBus 队列执行 getQueue()

> ID：15648942
> 
> 赞同：0
> 
> 时间：2013-03-26T22:55:21.913
> 
> 标签：java, azure, azureservicebus, azure-servicebus-queues

在过去 26 小时左右，调用 ServiceBusConstract.getQueue(path) （其中 path 是一个不存在的队列）会引发 ServiceException，其最终原因是绑定问题。

引起：javax.xml.bind.UnmarshalException：意外元素（uri：“ [http://www.w3.org/2005/Atom](http://www.w3.org/2005/Atom) ”，本地：“feed”）。预期的元素是 <{ [http://schemas.microsoft.com/netservices/2010/10/servicebus/connect](http://schemas.microsoft.com/netservices/2010/10/servicebus/connect) }QueueDescription>,<{ [http://schemas.microsoft.com/netservices/2010/10/servicebus/connect](http://schemas.microsoft.com/netservices/2010/10/servicebus/connect) } SubscriptionDescription>,<{ [http://schemas.microsoft.com/netservices/2010/10/servicebus/connect](http://schemas.microsoft.com/netservices/2010/10/servicebus/connect) }TopicDescription>,<{ [http://www.w3.org/2005/Atom](http://www.w3.org/2005/Atom) }entry> at com.sun .xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.handleEvent（UnmarshallingContext.java:647）

当同时使用 0.4.0 和 0.4.1 版本的 SDK 时，情况确实如此。

以前，此调用返回一个 GetQueueResult，其 .getValue() 方法返回 null。发现这一点，因为我的测试现在失败了。

生产服务是否已更新为不再与此调用兼容？ServiceBusContract.getQueue(nonExistentPath) 的预期行为是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T01:10:32.363

预计会引发 ServiceException。我们实际上有一个单元测试来验证这种行为，请参阅以下文件中的 getNonExistQueueFail()。

[https://github.com/WindowsAzure/azure-sdk-for-java/blob/master/microsoft-azure-api/src/test/java/com/microsoft/windowsazure/services/serviceBus/ServiceBusConfigurationTest.java](https://github.com/WindowsAzure/azure-sdk-for-java/blob/master/microsoft-azure-api/src/test/java/com/microsoft/windowsazure/services/serviceBus/ServiceBusConfigurationTest.java)

# sdl - Xcode 4.6 无法识别 SDL.framework

> ID：15648943
> 
> 赞同：0
> 
> 时间：2013-03-26T22:55:22.637
> 
> 标签：sdl, osx-mountain-lion, xcode4.6

当涉及到编译语言（以及一般的 Xcode IDE）时，请考虑我是一个完整而彻底的新手

我遵循了一些关于将 XCode 设置为与 SDL 框架一起使用的教程，它们似乎有点过时，旨在与 OSX 10.6 或 10.7 一起使用，所以我还确保我遵循 SDL dmgs 中的自述文件。

我无法弄清楚我将我的 SDL.framework（或任何其他框架，如 SDL_image.framework，就此而言）放在文件系统的哪个位置。我试过了

```
/Library/Frameworks
/System/Library/Frameworks
~/Library/Frameworks 
```

当我打开 Xcode 并浏览要添加/链接的框架时，找不到 SDL 框架。

当我打开从 [https://github.com/Ricket/HelloSDL](https://github.com/Ricket/HelloSDL)下载的模板项目时， 所有框架引用都被涂成红色，如“错误”或“不存在”。

谁能告诉我，我把这些东西放在哪里？哦，任何最新的 Xcode + sdl 设置教程对我来说也很有价值！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T16:41:20.843

假设您已下载 SDL.Framework 或已编译 SDL2.Framework（如果您正在使用该版本），只要您在项目中正确链接它，放置它的位置并不重要。我通常倾向于将它们保留在`/Library/Frameworks`

步骤 1\. 选择您的构建目标并选择`Build Settings`部分。然后搜索`Framework Search Paths`或向下滚动到该`Search Paths`部分并在需要时将其展开。将 的值设置为`Framework Search Paths`您放置框架的位置。

步骤 2\. 要将框架包含在您的项目中，请选择您的构建目标并选择该`Build Phases`部分。展开`Link Binary With Libraries`并单击 + 按钮。在出现的弹出窗口中，您需要单击`Add Other`然后浏览到您放置框架的位置，例如`/Library/Frameworks`并选择要添加的框架。

# c++ - 从文本文件 C++ 中读取单词（奇怪的字符）

> ID：15648944
> 
> 赞同：0
> 
> 时间：2013-03-26T22:55:26.413
> 
> 标签：c++, file, text

```
firstword secondword thirdword fourthword ... 
```

我的文本文件包含 200 个像这个顺序一样的单词，我想读取它们并将它们复制到一个 2D 固定长度的数组中，没有奇怪的字符。我无法使用这段代码执行此操作：

```
ifstream FRUITS;
FRUITS.open("FRUITS.TXT");

    if(FRUITS.is_open())
    {
        char fruits1[200][LEN];
        int c;

        for(c = 0; c < 200; c++)
        {
            char* word;
            word = new char[LEN];

            FRUITS >> word;

            for(int i = 0; i < LEN; i++)
            {
                fruits1[c][i] = word[i];
            }
        }
    } 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:05:58.390

您需要`'\0'`在单词的末尾添加，这样如果单词的长度小于`LEN`.

但是，我建议使用字符串向量来完成这项工作。

```
#include <iostream>
#include <fstream>
#include <vector>
#include <string>

using namespace std;
int main()
{
    fstream file;
    vector<string> v;
    file.open("FRUITS.txt");
    string tmp;
    while(!file.eof())
    {
        file >> tmp;
        v.push_back(tmp);
    }
    for(vector<string>::iterator i=v.begin(); i!=v.end(); i++)
    {
        cout << *i << endl;
    }
    file.close();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:07:51.543

想一想：

```
FRUITS >> fruits1[c]; 
```

但是您必须确保`LEN`足以容纳`char`每个单词中的所有`'\0'`.

并且不要担心`"=+½$#".`当你做的事情就像`cout << fruits1[c];`他们没有被打印出来一样。

# javascript - 什么是正确的语法？

> ID：15648945
> 
> 赞同：2
> 
> 时间：2013-03-26T22:55:44.557
> 
> 标签：javascript, jquery, html, image

当我将鼠标悬停在现有图像上时，我试图淡入现有图像之上的图像，而不为每个图像重新编写相同的函数。

目前我有：

```
<script type="text/javascript">

    $(document).ready(function() {

        $('.image').mouseenter(function() {  //fade in hover image
            $(this.getAttribute("name")).fadeIn(500);
        });                         
        $('.hoverimage').mouseout(function() { //fade out hover image
            $(this).fadeOut(500);
        });

    });

</script>

...
...

<!--base images-->
<img src="image1.png" class="image" name="hoverimage1">
<img src="image2.png" class="image" name="hoverimage2">
<img src="image3.png" class="image" name="hoverimage3">

<!--image to appear when hovering over-->
<img src="image1_glow.png" class="hoverimage" id="hoverimage1">
<img src="image2_glow.png" class="hoverimage" id="hoverimage2">
<img src="image3_glow.png" class="hoverimage" id="hoverimage3"> 
```

假设 CSS 已经存在，因此悬停图像放置在基本图像的顶部。我的代码试图做的是：

*   当鼠标进入“image1.png”的div时，会得到名称属性“hoverimage1”
*   然后它通过执行 $('#hoverimage1").fadeIn(500); 淡入 ID 为“hoverimage1”的元素；

但问题是名称属性没有“#”，而且我不想写“name="#hoverimage1"，因为这会使 ID 混淆。现在我的函数执行 $('hoverimage1").fadeIn( 500); 这不是正确的语法。

有人可以帮我弄这个吗？是否可以将“#”附加到“$(this.getAttribute())”或其他内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:59:10.320

如果要添加 a `#`，则可以连接字符串：

```
$('#' + this.name) 
```

但如果可能的话，我会为此使用元素索引：

```
 $('.image').mouseenter(function() {
        $('.other_images').eq($(this).index()).stop().fadeIn(500);
    }).mouseout(function() {
        $('.other_images').eq($(this).index()).stop().fadeOut(500);
    }); 
```

这样，您甚至不需要在父图像`id`的属性中写入其他图像。`name`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:59:32.740

由于属性是`hoverimage1`，脚本实际上是在寻找一个`<hoverimage1>`元素。您需要将 a 连接`#`到开头：`$("#"+this.getAttribute("name"))`

# javascript - onreadystatechange 触发页面重新加载

> ID：15648950
> 
> 赞同：1
> 
> 时间：2013-03-26T22:56:09.803
> 
> 标签：javascript, cross-browser, xmlhttprequest

我正在尝试学习一些组合的 php、javascript、sql、html 的东西......我创建了一些可以在 firefox（WinXP 和 android 版本）上完美运行的东西。所需的操作是，每当我单击“处理！”按钮时，一个 php 脚本会获取“textarea”中的文本，将每个单词放入数据库并返回一些 html...

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="somestyle.css">
</head>
<body>
<script>

function ajaxUpdate()
{
    var currStr = document.getElementById("textfield").value;
    document.getElementById("textfield").value = currStr.trim();
    var response;
    try{
        var httpReq = new XMLHttpRequest();
    }
    catch(error){
        document.write(error);
    }
    httpReq.open("POST", "ajaxinput.php", true);
    httpReq.send(currStr);
    httpReq.onreadystatechange = function() {

        if(httpReq.readyState == 4){
            response = httpReq.responseText;
            document.getElementById("ajaxoutput").innerHTML = response;

        }
    }

}

function processText(){
    //document.write("in processURL");
    url = document.getElementById("textarea").value;
    document.getElementById("m_block").innerHTML = document.getElementById("m_block").innerHTML + "<br/>text is being worked on by server..."

    var response;
    try{
        var httpReq = new XMLHttpRequest();
    }
    catch(error){
        document.write(error);
    }
    httpReq.open("POST", "textinput.php", true);
    httpReq.send(document.getElementById("textarea").innerHTML);
    httpReq.onreadystatechange = function() {
        if(httpReq.readyState == 4){
            response = httpReq.responseText;
            document.getElementById("m_block").innerHTML = response;
        }
    }

}

</script>

<div id="container">
    <div id="l_block"></div>
    <div id="m_block">
    <form>
    <br/>
    <textarea id="textarea" rows="10" cols="42">Insert text here!</textarea> 
    <button onclick="processText()">process!</button>
    </form>
    </div>
    <div id="r1_block">css 2</div>
    <div id="r2_block">css 1</div>
</div>
</body>

</html> 
```

来自 php 脚本的响应如下所示：

```
 search: <input type="text" id="textfield" onkeyup="ajaxUpdate()" />
 <div id="ajaxoutput"></div> 
```

我称之为“ajax”，我不知道这是否是 ajax 应该是的。但我之所以这样称呼它，是因为它应该`textfield`在每个 keyup 事件中发送字符串。据我了解，感觉有点 ajax。

尽管如此，正如我所说，这在 Firefox 上非常有效，但是当我在其他浏览器上尝试时没有任何反应。所发生的一切似乎是页面重新加载并附`?`加到地址栏中的 URL...

我可以要求我所有的朋友只使用 firefox，但我很好奇是什么原因造成的。我哪里错了。

谢谢！

**编辑！** 我在 Chrome 的调试器中做了一些挖掘。原来响应恢复正常。当我设置断点时，我看到 div 填充了新内容。但是，回调函数会连续调用两次。完成后，我恢复到以前的内容，服务器响应无处可寻。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-20T23:24:52.873

我今天面临完全相同的问题，明天可能对某人有用。

在表单元素中，输入类型为“提交”，表单具有 onsubmit="func()"。如下所示：

```
<form id="x" name="x"  onsubmit="func()">
  <input type="submit" value="Submit"></input>
</form> 
```

出于某种原因，我不明白，在 chrome 中，整个页面在从 xmlhttp.onreadystatechange=function() 返回后重新加载“？” 到底。就像发布的OP一样。

我在某处读到使用 type="button"，然后表单元素必须更新为 onclick="func()"。以下代码对我来说非常有用：

```
<form id="x" name="x"  onclick="func()">
    <input type="button" value="Submit"></input>
</form> 
```

如果有人能解释为什么会这样，那就太好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:23:53.923

就像乔纳森说的你没有提到哪个浏览器所以很难给你具体的答案。此外，您的 AJAX 实现似乎不完整，请尝试一下

```
//Put this on top before anything
if(!String.prototype.trim) 
{  
    String.prototype.trim = function () 
    {  
        return this.replace(/^\s+|\s+$/g,'');  
    };  
} 
```

同时更新您的 AJAX 相关代码。

```
var xmlhttp;
if (window.XMLHttpRequest)
{
    // code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{
    // code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        //Do something
    }
}
xmlhttp.open("POST","textinput.php",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
//xmlhttp.send("fname=Henry&lname=Ford"); 
```

您也可以尝试使用像 jQuery 这样的库来解决大多数浏览器的不一致问题。

# onclick - PHP File ....使用提交按钮刷新页面

> ID：15648952
> 
> 赞同：1
> 
> 时间：2013-03-26T22:56:15.377
> 
> 标签：onclick, form-submit, page-refresh

大家好，我想在点击提交按钮后刷新页面，或者我想在表单提交后刷新页面。请帮助我

谢谢

# javascript - CakePHP 动态全局变量

> ID：15648960
> 
> 赞同：0
> 
> 时间：2013-03-26T22:57:00.317
> 
> 标签：javascript, cakephp, global-variables, bootstrapping

我正在尝试为 CakePHP 应用程序创建一个全局“ServerStatus”标志。我的想法是我可以切换离线/在线模式进行维护，以便在将数据推送到服务器时，站点处于离线状态。我设置了 JavaScript 切换以及重定向，但我遇到的问题在于全局变量本身。

我已经尝试了两件事，它们都在 bootstrap.php 文件中：

(1) 我使用 Configure Class 来写入初始状态，以及 (2) 我使用 $GLOBALS 数组来写入初始值。

当我尝试稍后在激活切换时将状态更改为备用（非初始）值时，它无法更改。据我所知，这意味着当我在 bootstrap.php 中编写一个全局变量时，它就像一个常量，并且该初始值稍后会覆盖更改。

切换是我的默认布局 default.ctp 中的一个小脚本：

```
<script type="text/javascript">

        var charInputs = [];
        setInterval(clearInputBuffer(), 20000);

        function keyPressHandler(event)
        {
            var currChar = String.fromCharCode(event.charCode);
            charInputs.push(currChar);
            //alert(currChar + ' key pressed!');

            checkForKeyPhrases(charInputs);
        }

        function checkForKeyPhrases(chars)
        {
            // Get inputted chars as a sequence
            var seq = "";
            for (var i=0; i < chars.length; i++)
                seq += chars[i] + "";

            // Check for "Maintenance Mode"
            if (seq == ":maintenance")
            {
                alert("Maintenance mode... go!");

                <?php
                    if ($GLOBALS['ServerOnline'])
                    {
                        $GLOBALS['status'] = 'down';
                        $GLOBALS['ServerOnline'] = false;
                    }
                    else
                    {
                        $GLOBALS['status'] = 'up';
                        $GLOBALS['ServerOnline'] = true;
                    }
                ?>

                var temp = '<?php echo $GLOBALS['status']; ?>';
                alert('Current Server Status: ' + temp);

                clearInputBuffer();
            }
            else if (seq.indexOf('clear') > -1)
                clearInputBuffer();
        }

        function clearInputBuffer()
        {   charInputs = [];    }

    </script> 
```

在 bootstrap.php 中，我写了`$GLOBALS['ServerOnline'] = true;`；但是当警报弹出时，它总是注册初始值 true 并且我将“down”视为当前状态。它永远不会改变。

如果我正确地解释这意味着在初始化引导文件中编写全局变量会覆盖以后的更改，那么为 CakePHP 应用程序编写动态 GLOBAL 初始值的最佳位置是哪里？如果我错了，有没有人看到我错过了什么？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:25:39.910

好的，所以。我相信我遇到的问题是我误解了 PHP 和 JavaScript 的运行方式。PHP 在页面加载到服务器端之前运行，然后运行完成。这意味着我的 PHP 全局变量是“每次执行”变量。当 JavaScript 捕获事件并查看 PHP var 时，它只是在读取 PHP 变量，并且设置的代码已经运行并且不会再次运行。

基本上，我混淆了客户端与服务器端脚本。

这意味着有两种方法可以解决我的问题：(1) 使用某种持久性存储，也就是我检查和更新的文件或数据库表，而不是脚本变量，或者 (2) 我可以发出 AJAX 请求并将数据发布到服务器，导致服务器端代码与数据一起运行。

# xpath - 如何在 XPATH 中选择此文本？

> ID：15648964
> 
> 赞同：2
> 
> 时间：2013-03-26T22:57:14.447
> 
> 标签：xpath

我有这个 div，我想选择城市的邮政编码。我使用的所有选择器都获取了整个 div，或者没有正确的数据。

```
<div class="merchantContact">
    <h2 class="subHeadline firefinder-match">L' Autre Pied</h2>
    5-7&nbsp;Blandford Street<br>
    London&nbsp;W1U 3DB                <-------------------I want this line
    <br>
    <a href="http://www.lautrepied.co.uk" onclick="window.open(this.href); return false;"><font color="#0891be">Company Website</font></a><br>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:13:44.400

尝试这个 ：

```
html/body/div/text()[3] 
```

带有插件的测试：[`firePath`](https://addons.mozilla.org/en-us/firefox/addon/firepath/) `firefox`

![描述图像](../Images/6e1ab491867e866368931f2ef4958c91.png)

* * *

也许你需要在你的[xpath](/questions/tagged/xpath "显示标记为“xpath”的问题")表达式中更具体，所以试试这个：

```
//div[@class="merchantContact"]/text()[3] 
```

# c - C 中的简单 HTTP 服务器 - 如何响应浏览器？

> ID：15648965
> 
> 赞同：4
> 
> 时间：2013-03-26T22:57:15.817
> 
> 标签：c, http, networking, response

我的服务器正在向请求发送带有正文的示例响应标头：

```
 static char* not_found_response_template = 
      "HTTP/1.1 404 Not Found\n"
      "Content-type: text/html\n"
      "\n"
      "<html>\n"
      " <body>\n"
      "  <h1>Not Found</h1>\n"
      "  <p>The requested URL was not found on this server.</p>\n"
      " </body>\n"
      "</html>\n";

    len = strlen(not_found_response_template);
    send(newSct, not_found_response_template, len, 0); 
```

它发送正确，但 Firefox 继续加载，直到我取消传输。

Firefox 插件 HttpRequestHelper 显示了这一点：

获取本地主机：6666

-- 响应 -- 404 Not Found Content-Type: text/html

为什么内容没有加载？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T23:04:11.353

HTTP 要求行由 CR+LF 终止，因此请尝试`\r\n`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T23:04:13.763

发送响应后尝试刷新和/或关闭套接字。

# xml - XSD Schema 验证中 XMLLint 和 Xerces 的不同结果？

> ID：15648968
> 
> 赞同：2
> 
> 时间：2013-03-26T22:57:21.720
> 
> 标签：xml, command-line, xsd, xml-validation, xsd-validation

背景：我正在尝试找到一种方法来针对 XSD 验证 XSD 和 XML，这种方法可以自动集成到软件构建过程中。输入是文件，对于输出，退出代码或可靠的正则表达式控制台输出就足够了。我在 Windows 环境中操作。

作为 XML 和 XSD 输入，我从 Wikipedia（文章“XML Schema (W3C)”）中获取了一个示例。

作为工具，我选择尝试[XMLLint](ftp://ftp.zlatkovic.com/libxml/)和[Xerces](http://xerces.apache.org/xerces-c/stdinparse-3.html)。

问题是，XMLLint 和 Xerces 给出了不同的结果。

这引出了我的问题：我还有哪些其他选择来评估这些工具？我应该如何决定选择哪种工具？

来自维基百科的 XML 数据示例 SimpleAddress.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<Address xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="SimpleAddress.xsd">
  <Recipient>Mr. Walter C. Brown</Recipient>
  <House>49</House>
  <Street>Featherstone Street</Street>
  <Town>LONDON</Town>
  <PostCode>EC1Y 8SY</PostCode>
  <Country>UK</Country>
</Address> 
```

来自维基百科的 XSD 模式示例 SimpleAddress.xsd：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Address">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="Recipient" type="xs:string" />
        <xs:element name="House" type="xs:string" />
        <xs:element name="Street" type="xs:string" />
        <xs:element name="Town" type="xs:string" />
        <xs:element name="County" type="xs:string" minOccurs="0" />
        <xs:element name="PostCode" type="xs:string" />
        <xs:element name="Country" minOccurs="0">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="IN" />
              <xs:enumeration value="DE" />
              <xs:enumeration value="ES" />
              <xs:enumeration value="UK" />
              <xs:enumeration value="US" />
            </xs:restriction>
          </xs:simpleType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

首先我使用 XMLLint 进行测试：

```
$ xmllint.exe --noout --schema SimpleAddress.xsd SimpleAddress.xml
SimpleAddress.xml validates

$ xmllint.exe --noout --schema http://www.w3.org/2001/XMLSchema.xsd SimpleAddress.xsd
SimpleAddress.xsd validates 
```

当我故意在要验证的文件中放置一个额外的属性或标签时，XMLLint 也会给我带来有意义的错误结果。

使用 XMLLint，我还尝试针对自身验证 W3C 的 XML 模式定义：

```
$ xmllint.exe --noout --schema http://www.w3.org/2001/XMLSchema.xsd http://www.w3.org/2001/XMLSchema.xsd
http://www.w3.org/2001/XMLSchema.xsd validates 
```

其次，我使用 Xerces 进行的测试会产生很多警告和错误：

```
$ StdInParse.exe -n -s -f -v=always < SimpleAddress.xml
stdin: 1 ms (7 elems, 2 attrs, 19 spaces, 56 chars)

$ StdInParse.exe -n -s -f -v=always < SimpleAddress.xsd
Error at (file stdin, line 2, char 87): no declaration found for element 'xs:schema'
Error at (file stdin, line 2, char 87): attribute 'elementFormDefault' is not declared for element     'xs:schema'
Error at (file stdin, line 2, char 87): attribute '{http://www.w3.org/2000/xmlns/}xs' is not declared  for element 'xs:schema'
Error at (file stdin, line 3, char 30): no declaration found for element 'xs:element'
(…) 
```

对于以下测试，我在 SimpleAddress.xsd 的开始标记中添加了“xmlns:xsi”和“xsi:schemaLocation”属性：

```
<xs:schema 
  elementFormDefault="qualified" 
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.w3.org/2001/XMLSchema http://www.w3.org/2001/XMLSchema.xsd"
> 
```

XMLLint 产生相同的结果：

```
$ xmllint.exe --noout --schema http://www.w3.org/2001/XMLSchema.xsd SimpleAddress.xsd
SimpleAddress.xsd validates 
```

Xerces 产生了更多的警告和错误，现在也涉及 W3C 的文档：

```
$ StdInParse.exe -n -s -f -v=always < SimpleAddress.xsd
Warning at (file http://www.w3.org/2001/datatypes.dtd, line 99, char 7): attribute 'id' has already been declared for element 'xs:simpleType'
Warning at (file http://www.w3.org/2001/datatypes.dtd, line 122, char 7): attribute 'id' has already been declared for element 'xs:list'
Warning at (file http://www.w3.org/2001/datatypes.dtd, line 130, char 7): attribute 'id' has already been declared for element 'xs:union'
Warning at (file http://www.w3.org/2001/datatypes.dtd, line 140, char 20): attribute 'id' has already been declared for element 'xs:maxExclusive'
(…)
Error at (file stdin, line 15, char 68): unable to find validator for simple type of attribute 'maxOccurs'
Error at (file stdin, line 16, char 56): unable to find validator for simple type of attribute 'maxOccurs'
Error at (file stdin, line 17, char 50): unable to find validator for simple type of attribute 'maxOccurs' 
```

总之，XMLLint 似乎可以满足我的需要，但是它有一个主要缺点。它要求我将要验证的 XSD 文件指定为单独的参数，因为它似乎无法从 XML 输入文件中读取相应的 xmlns 属性。

另一方面是Xerces。它似乎被广泛使用并声称忠实于此类文档中使用的相同标准，但即使关于 W3C 的文档也会产生很多错误和警告。所以，我问自己，我用对了吗？我想让它工作，因为它不需要我为 XMLLint 的必要额外参数找到解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:02:53.220

您不应根据 W3C Schema ( [http://www.w3.org/2001/XMLSchema.xsd](http://www.w3.org/2001/XMLSchema.xsd) ) 验证 XMLSchema。相反，针对您的 XMLSchema 验证一个“空”XML 文档（仅一个根），以查看您的 XMLSchema 是否包含任何错误。

# ruby - CSV 和字节顺序标记的 Ruby 编码问题

> ID：15648969
> 
> 赞同：0
> 
> 时间：2013-03-26T22:57:22.443
> 
> 标签：ruby, csv, encoding

我有以下代码来下载 Windows 生成的带有字节顺序标记的 CSV 文件。

```
 res = HTTParty.get(url, :format => :text)
  res.body.sub!(/^\xEF\xBB\xBF/, '') #Remove BOM 
```

在控制台中运行这个确切的代码，会抛出以下内容：

```
Encoding::CompatibilityError: incompatible encoding regexp match (UTF-8 regexp with ASCII-8BIT string) 
```

但是从类方法中运行它是有效的。

这可能是什么？

# jsf-2 - 使用 JSF RichFaces rich:editor 编辑 word 文档？

> ID：15648971
> 
> 赞同：0
> 
> 时间：2013-03-26T22:57:41.083
> 
> 标签：jsf-2, ms-word, editor, richfaces, documents

我有 JSF RichFaces rich:editor 正在运行，我能够上传和打开文档或者只是将它们流式传输到编辑器。问题是 .doc 或 docx 或其他 RichText 文档会显示很多我在使用 Office 打开时在实际文档中看不到的内容，而我能够真正获得的唯一格式是当我得到它来自一个 HTML 文件。

我的问题是：

有什么方法可以在线打开文档并进行类似于 Google Docs 的编辑？

有没有办法调整 RichFaces rich:editor 组件来做我想做的事情？

注意：如果我从 .doc 复制和粘贴，那么它的工作正常，但在这里我必须从流媒体中获取它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T11:57:59.797

您基本上需要在保存后将 DOC(X) 转换为 HTML 进行编辑，并将 HTML 转换为 DOC(X)。这也是 Google Docs 基本上在做的事情。

您的下一个问题很可能是“如何从 DOC(X) 转换为 HTML 并返回？”。您可以为此使用[Open Office API](http://wiki.openoffice.org/wiki/Documentation/DevGuide/OpenOffice.org_Developers_Guide)或其他库，例如[JDOCConverter](http://www.artofsolving.com/opensource/jodconverter)。[或者，您也可以借助Apache POI HWPF](http://poi.apache.org/hwpf/index.html)等低级 API 自己解析 DOC(X) ，然后根据 Java 对象中收集的信息相应地生成所需的 HTML。

不，这不是一项微不足道的任务。您需要对 DOC(X) 格式（仅此问题已经表明您没有）以及转换步骤中的限制有一个很好的了解。我个人建议只使用 Google Docs。

# css - CSS菜单对齐在不同浏览器中不稳定

> ID：15648978
> 
> 赞同：0
> 
> 时间：2013-03-26T22:58:35.043
> 
> 标签：css, menu, alignment

这是我的页面：[http](http://aasiskos.webpages.auth.gr/1905_YPA/index.php) ://aasiskos.webpages.auth.gr/1905_YPA/index.php 。我的 CSS 有问题。如果站点在不同的浏览器中打开，菜单对齐会发生变化。我从 3 台不同的计算机上检查过，菜单没有完全对齐。其次，当我最小化菜单时也没有对齐。我应该怎么办 ？

我使用 Stylizer 来更改 CSS 代码。这是代码：

```
 *
{
    margin: 0;
    padding: 0;
}
BODY
{
    margin-top: 220px;
    background: #000 url(images/button.jpg) no-repeat center top;
    color: #5E5E5E;
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: small;
    font-style: normal;
    font-weight: normal;
    font-variant: normal;
}
H1, H2, H3
{
    color: #5E5E5E;
}
H2
{
    font: 1em Arial, Helvetica, sans-serif;
    font-size: 11px;
}
H3
{
    font-size: large;
    color: #F00;
}
P, BLOCKQUOTE, UL, OL
{
    margin-bottom: 1.4em;
    line-height: 1.8em;
    text-align: inherit;
}
P
{
}
BLOCKQUOTE
{
    margin-left: 2em;
    margin-right: 2em;
    font-style: italic;
}
UL
{
    /*[empty]margin-left:;*/
}
UL LI
{
}
OL
{
    /*[empty]margin-left:;*/
}
OL LI
{
}
A
{
    text-decoration: none;
    color: #5E5E5E;
}
A:hover
{
    text-decoration: underline;
}
/*Boxed Style*/
.boxed
{
    margin-bottom: 20px;
}
.boxed .content
{
    padding: 15px;
    margin-left: -11px;
}
/*Post*/
.post
{
    /*[empty]margin:;*/
}
.post .title
{
    padding: 10px 0;
    font-size: 1.6em;
    font-weight: normal;
}
.post .story
{
    padding: 10px;
    margin-left: -7px;
    margin-top: 5px;
}
/*Header*/
#header
{
    height: 61px;
    width: 1000px;
    margin-left: auto;
    margin-right: auto;
}
/*Header > Logo*/
#logo
{
    width: 700px;
    height: 19px;
    margin: 0 auto;
    padding: 6px 0 0;
}
#logo H1, #logo H2
{
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 11px;
}
#logo H1
{
    float: left;
}
#logo H2
{
    float: right;
}
#logo A
{
}
/*Header > Menu*/
#menu
{
    width: 1100px;
    height: 27px;
}
#menu UL
{
    /*[empty]margin-left:;*/
    padding: 7px 0 0;
    list-style: none;
}
#menu LI
{
    display: inline;
}
#menu A
{
    display: block;
    float: left;
    height: 30px;
    margin: 0 2px 0 0;
    padding: 2px 25px 0;
    background: url(#FFFFF) repeat-x;
    border: 1px solid #014995;
    text-align: center;
    font-size: 11px;
    font-weight: bold;
    color: #014995;
}
#menu A:hover
{
    background-image: url(images/13.jpg);
    text-decoration: none;
    color: #E5E5E5;
}
#menu .active A
{
    background-image: url(images/12.jpg);
}
/*Wrapper >Font*/
#fonts
{
    font-family: "Arial Black", Gadget, sans-serif;
    color: #5E5E5E;
}
/*Centre Wrapper*/
#wrapper
{
    width: 1000px;
    margin-left: auto;
    margin-right: auto;
}
/*Content*/
#content
{
    width: 60px;
    padding: 50px 0 0;
}

#login INPUT
{
    margin-bottom: 5px;
    padding: 2px 5px;
    border: 1px solid #385B88;
    font-family: Verdana, Arial, Helvetica, sans-serif;
}
#inputtext1, #inputtext2, #inputtext3
{
    color: #014995;
}
#inputsubmit1
{
    background: #385B88;
    color: #FFFFFF;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:08:28.533

鉴于它看起来不像设计是流畅或响应的，这是一个非常简单的修复。只需添加“margin-right：-10px;” #menu 的样式规则。这会将菜单转移到它应该开始的位置。

换句话说：

```
#menu {
   margin-right: -10px;
} 
```

# sql - sql查找中间值

> ID：15648980
> 
> 赞同：1
> 
> 时间：2013-03-26T22:58:53.180
> 
> 标签：sql

我有一张这样的桌子

```
AB
------------
 1.2 2.3
 2.3 3.9
 3.9 4.34
 4.34 5.786

```

数据的意思是 1.2-5.786 是某个表的长度，1.2-2.3 有一些属性 2.3-3.9 有一些属性等等......但是当你认为它是整个表的长度时，1.2 - 5.786（对于这里的例子）。

我想运行一个查询，它会给我两个值之间的行：例如：

A = 1.1 和 B = 4.234

我很难弄清楚如何编写查询，我写的大多数查询都遗漏了一些边缘情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:28:20.927

这似乎运作良好：

```
select *
from yourtable
where (b > 1.1 and a <= 4.234) 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/76dfa0/1)

基本上确保 b 大于下限并且 a 小于或等于上限。根据您想要的结果，您可能需要更改`b >`为`b >=`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:04:53.543

例如，如果您想要介于两者之间的值，`A =1.1 amd B = 4.234`则输出为

```
 A       B 
```

* * *

```
1.2         2.3

2.3         3.9 
```

那么查询是：

```
SELECT * from my_table WHERE A>=1.1 AND B<=4.234 
```

但是如果你想要输出

```
 A       B 
```

* * *

```
1.2         2.3

2.3         3.9

3.9         4.34 
```

然后你想要查询

```
SELECT * FROM my_table WHERE A >= 1.1 AND A < 4.234 B > 4.234 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T23:32:19.063

听起来你想要

```
SELECT a, b
  FROM my_table 
  WHERE A >= 1.1 AND B <= 4.234
     OR A >= 1.1 AND A <  4.234 
     OR B >  1.1 AND B <= 4.234 
```

这假设 A 总是 < B

# java - “弹出”数组列表中的元素。我错过了什么？

> ID：15648986
> 
> 赞同：-1
> 
> 时间：2013-03-26T22:59:16.180
> 
> 标签：java, arraylist

好的，输入是一串数字和运算符，例如 + 2 3 * 4。我想将字符串拆分为一个 ArrayList 对象，字符串中的每个字符都有自己的索引。这就是我所拥有的；

```
String current;
String s = "+ 2 3 * 4";
List <String> splitter = new ArrayList<String>(Arrays.asList(s.split("\\s+")));
current = splitter.remove(0);

if (current == "+"){
   //do stuff }
else if (current = "-") {
   //do stuff } 
.... 
```

if 语句由于某种原因没有被评估为 true，我是否遗漏了一些微妙的东西，或者我在这里完全错了？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T23:00:50.807

在 中`if`，您`==`用于比较字符串；改为使用[`String#equals`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals%28java.lang.Object%29)。

在 中`else`，您正在使用赋值运算符`=`来比较字符串；改为使用`String#equals`。

运算符比较`==`两个字符串引用以查看是否引用相同的对象，这不是您想要的。

# haskell - ghc-prim 的源代码在哪里？

> ID：15648987
> 
> 赞同：1
> 
> 时间：2013-03-26T22:59:18.257
> 
> 标签：haskell

在 google 或 hackage 中找到存储库并不容易。

我在哪里可以找到源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:00:20.387

包的源代码在`ghc-prim`这里：[http ://git.haskell.org/ghc.git/tree/HEAD:/libraries/ghc-prim](http://git.haskell.org/ghc.git/tree/HEAD:/libraries/ghc-prim)

（如果该链接再次断开，请看这里：[https](https://hackage.haskell.org/package/ghc-prim-0.5.0.0) ://hackage.haskell.org/package/ghc-prim-0.5.0.0 ）。

请注意，`GHC.Prim`模块本身是在编译器内部定义的，不对应于任何`.hs`文件：[https](https://ghc.haskell.org/trac/ghc/wiki/Commentary/PrimOps) ://ghc.haskell.org/trac/ghc/wiki/Commentary/PrimOps 。

# google-app-engine - GAE ndb 安全问题？

> ID：15648999
> 
> 赞同：2
> 
> 时间：2013-03-26T23:00:13.053
> 
> 标签：google-app-engine, app-engine-ndb

我有两个模拟用户 Jo 和 Sam，他们的 ID 分别为 117138609372751079516 和 144229817858159123282。

该应用程序具有以下实体：

```
class MockEntity(ndb.Model):
    ownerId = ndb.StringProperty(default=users.get_current_user().user_id()) 
```

当两者同时登录并且任何一个用户第一次保存/放置实体时，属性“ownerId”将随机填充用户 ID：117138609372751079516**或**144229817858159123282

使用 pre_put_hook 似乎可以解决问题：

```
def _pre_put_hook(self):
    if not self.ownerId:
        self.ownerId = users.get_current_user().user_id() 
```

我已经解决了眼前的问题，但为什么会这样呢？这已经在开发和生产中与一组大约 50 名测试人员进行了测试。大约 40% 的人可以看到不属于他们的实体。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T23:42:35.650

该问题可能是由于`ownerId`仅在*第*`MockEntity`一次为每个 App Engine 运行时实例创建类时设置的默认值。因此，当新的 App Engine 实例加载时，默认值由第一个用户设置，以将类加载到 Python 解释器中。

有关 NDB 中相同情况的解释，请参阅Gotcha — Python 中此经典问题的[可变默认参数和](http://pythonconquerstheuniverse.wordpress.com/2012/02/15/mutable-default-arguments/)[App Engine NDB Gotcha PickleProperty Default Value](http://www.justdoesnotwork.com/2012/04/app-engine-ndb-gotcha-pickleproperty.html)。