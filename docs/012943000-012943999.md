# StackOverflow 问答 12943000-12943999

# c# - 识别弹出并杀死它或按确定

> ID：12943000
> 
> 赞同：0
> 
> 时间：2012-10-17T20:39:34.083
> 
> 标签：c#, .net, excel

尽管以下背景信息与该问题不太相关，但我将其包括在内，以防您好奇：

我在跑步：

```
xlWorkBook.RefreshAll(); 
```

在 Excel 工作簿上，有时我会收到以下消息：

![在此处输入图像描述](../Images/1c7409c501619aec7ca08342eaa011a9.png)

使用 c# .NET 3.5 我想在检测到它后立即摆脱这个弹出窗口。

**如何以编程方式检测并关闭它/按确定？**

请注意，即使它在后台，我也希望能够识别此弹出窗口！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T20:46:55.627

您应该能够将显示警报设置为 false 并避免这些

```
Application.DisplayAlerts = False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-29T09:18:56.837

您可以使用`Application.DisplayAlerts = False`来抑制警报/弹出窗口。但是，理想情况下，这不应该是正确的行为。当我们调用`RefreshAll()`并显示错误弹出窗口时，excel不会刷新数据。它仍然会显示旧数据。

为了解决这个问题，您可以保留`Application.DisplayAlerts=True`并创建两个线程：一个会打开 excel 应用程序并调用 RefreshAll()，另一个会等待指定的时间（比如 20 分钟）。如果第一个线程在 20 分钟内没有返回（可能是由于弹出），则第二个线程将终止 excel 进程。第一个线程将被释放，并将记录文件未刷新的异常。

# javascript - 雅虎天气按度数改变背景颜色

> ID：12943001
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:39:37.650
> 
> 标签：javascript, html, css

我有雅虎天气问题。我正在尝试逐步更改背景颜色。例如：

*   10度：蓝色
*   11 - 20 度：绿色
*   21 - 30 度：黄色
*   30度：红色

我正在使用这个链接[http://weather.yahooapis.com/forecastrss?w=2345795&u=c](http://weather.yahooapis.com/forecastrss?w=2345795&u=c)

[http://jsfiddle.net/BJKJT/3/](http://jsfiddle.net/BJKJT/3/)

`#piece`id 是应该改变颜色的元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:55:26.983

您必须使用 PHP 或一些服务器端代码。例如，使用 simpleXML 解析文件并从那里获取温度。如果 temp = 20，则背景颜色：蓝色

# c# - 无法通过 VS 2010/2012 连接到本地数据库

> ID：12943005
> 
> 赞同：2
> 
> 时间：2012-10-17T20:39:54.253
> 
> 标签：c#, .net, sql, visual-studio-2010

我的问题如下。我有一个网站，我正在创建并希望在其上使用表单身份验证。除了现在我添加了将用户保存到数据库的可能性之外，一切都很好。我已将数据库添加到 Visual Studio 上的 AppData 文件夹（已创建）。但是每次用户尝试（在我的网站上）创建一个新帐户时，我都会收到一个看起来像这样的错误（在调试中）：

> 用户 'DOMAIN\username' 登录失败

我的连接字符串如下：

```
<connectionStrings>
    <add name="SecurityConnectionString" 
         connectionString="Data Source=(computername)\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Security.mdf;Integrated Security=True;User Instance=true" 
         providerName="System.Data.SqlClient" />
</connectionStrings> 
```

奇怪的是，我可以使用 Windows 登录连接到 SQL Management Studio 没有问题。我已经尝试创建一个新用户（在 SQL 中）并使用这些凭据，但仍然没有运气（即使我已经给了用户 db_owner 权限，也会出现关于用户无法创建新数据库的错误）。任何见解将不胜感激。提前致谢。

具体来说，这是我得到的错误

`[SqlException (0x80131904): Login failed for user 'DOMAIN\username'.]`

**更新：**

我发现了一些东西。每当我在 SQL Server Management Studio 上将“Windows 身份验证”更改为“SQL Server 身份验证”时，即使使用正确的密码和用户名，我也无法登录。这可能（很可能）是我认为问题的根源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T18:57:13.837

我找到了解决方案。只需要创建一个新用户（在 SQL Server 身份验证下），然后使用我的 Windows 身份验证凭据通过 SQL 向该用户添加管理员权限，这意味着，我创建了一个用户，然后授予该用户管理员权限。这看起来很简单，我遇到的问题如下：

据我了解，如果您有权访问 SQL 数据库（无论您使用何种身份验证模式）并且对该数据库拥有管理员权限，那么您可以为所欲为。但是，似乎情况并非如此，因为在使用 SQL Server 身份验证时我的“域\用户名”凭据没有经过身份验证，这意味着我没有管理员权限。

无论如何，在创建新用户并修改连接字符串之后，我设法能够向数据库写入/读取/任何内容。

我感谢大家在这个问题上的帮助。谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:00:31.903

在连接字符串`(computername)`中应该是`localhost`或您的计算机名称是什么。除非您目前正在`(computername)`用作此帖子的占位符。

# android - 使用 asynctask OnPostExecute 使元素可见/不可见

> ID：12943007
> 
> 赞同：0
> 
> 时间：2012-10-17T20:39:58.777
> 
> 标签：android, android-asynctask, visible

我正在使用 AsyncTask 来获取网络提要。设置活动后，我将在 activity_main 中显示这些元素，就像启动屏幕一样可见......

```
 android:id="@+id/progressBar1"
 android:id="@+id/loading_label" 
```

然后，一旦 asynctask 执行完毕，我想要这些 GONE 并使其他元素可见：

```
 android:id="@+id/login_label"
 android:id="@+id/login_textbox" 
```

如何在我的 onPostExecute 中正确设置可见性，这就是我尝试过的......

```
protected void onPostExecute(String retval) {
    progressBar1.setVisibility(View.GONE);
    loading_label.setVisibility(View.GONE);
    login_label.setVisibility(View.VISIBLE);
    login_textbox.setVisibility(View.VISIBLE);
} 
```

但我收到错误消息...“此行有多个标记
- 无法解析 progressBar1
- 无法将视图解析为变量”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:45:11.327

这是因为这些变量不在 AsyncTask 类的范围内。一个简单的方法是在 Activity 中编写一个设置可见性的函数，然后从 onPostExecute 调用该函数。

# backbone.js - 带有 Twitter Bootstrap TypeAhead 的 Backbone.js

> ID：12943009
> 
> 赞同：1
> 
> 时间：2012-10-17T20:40:15.560
> 
> 标签：backbone.js, twitter-bootstrap, bootstrap-typeahead

有一个[匿名要点](https://gist.github.com/1745614/)介绍了如何让 twitter bootstrap 的 typeahead 与backbone.js 一起工作。我将如何在实践中实现这一点？

# java - Java 到 XSD 或 XSD 到 Java

> ID：12943011
> 
> 赞同：7
> 
> 时间：2012-10-17T20:40:24.347
> 
> 标签：java, xsd, jaxb, pojo

我知道，使用 JAXB，您可以[从 XSD 生成 Java 文件](http://www.javaworld.com/javaworld/jw-06-2006/jw-0626-jaxb.html)，还可以[从带注释的 POJO 生成 XSD](https://stackoverflow.com/q/1325048/7648)。各自的优点和缺点是什么？一个整体比另一个好吗？

我们基本上想将事件序列化为 XML 格式的日志。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:03:04.913

最终，这取决于您要关注的地方：

**如果 XML 模式是最重要的事情**

那么最好从 XML 模式开始，生成一个 JAXB 模型。JAXB (JSR-222) 实现无法生成 XML 模式的详细信息：

*   一个 maxOccurs 不是 0、1 或无界的
*   一个简单类型的许多方面
*   模型组

**如果对象模型是最重要的**

如果您将使用 Java 模型不仅仅是在对象和 XML 之间进行转换（即使用 JPA 来实现持久性），那么我建议您从 Java 对象开始。这将为您提供最大的控制权。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:42:57.367

这取决于您对启动点的要求和场景。

鉴于您的要求，请使用`generate Java files from an XSD`您想首先定义 Java 应该支持的输出（XML）格式。，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T20:56:08.520

鉴于 XML 的要点之一是成为一种可移植的数据传输格式，无论平台或语言如何都可以使用，根据经验，我会避免从任何特定的编程语言生成 XSD。如果您知道您只是在 Java 端点之间进行通信，这可能并不重要（但您确定这将*永远*是真的吗？）。

在其他条件相同的情况下，最好以编程语言中立的方式定义接口/模式。

这个一般原则有很多例外，特别是如果您正在与现有或遗留代码集成......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T20:58:15.930

如果您有机会同时设计 pojo 和模式，这是设计问题 - 您是为“完美”模式设计还是为“完美”java 类设计。

在某些情况下，您没有选择余地，在系统集成场景中，您可能会从需要适应的另一个系统中获得预定义的 XSD，那么 XSD -> Class 将是唯一的方法。

# web-services - 如何将 UserNameToken 传递给 ASMX 服务？

> ID：12943015
> 
> 赞同：1
> 
> 时间：2012-10-17T20:40:42.877
> 
> 标签：web-services, asmx, wse2.0

我有一个 asmx Web 服务和一个测试控制台应用程序。我已将 Web 服务引用添加到控制台应用程序并像这样调用它

```
Employee.Employee e = new TestService.Employee.Employee();
e.SomeMethod(); 
```

在每个 Web 服务调用上都有一个验证检查，看起来像这样

```
 private bool IsUserNameTokenPresent()
    {
        //Get current SOAP context
        SoapContext ctxt = RequestSoapContext.Current;
        UsernameToken user = null;
        if (ctxt == null)
        {
            //This request is using a different protocol other than SOAP.
            return false;
        }

        //Iterate through all Security tokens
        foreach(SecurityToken tok in ctxt.Security.Tokens)
        {
            if (tok is UsernameToken)
            {
                user = (UsernameToken)tok;

            }
        }
        if (user == null)
            return false;

        return true;
    } 
```

**问题：**如何传递安全令牌以便我可以测试此服务。它始终为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:09:49.790

终于找到了这个问题的答案。我必须手动创建自己的 SOAP 标头并将其与请求一起传递。这是一些代码。我必须为每个调用动态创建 Nonce，如果有人想要它的代码，我会在这里发布。

```
 XmlDocument doc = new XmlDocument();

            doc.InnerXml = @"<?xml version='1.0' encoding='utf-8'?>
                                <soap:Envelope 
                                xmlns:wsu='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd' 
                                xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/' 
                                xmlns:wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd'>
                                <soap:Header>
                                <wsse:Security soap:mustUnderstand='1'>
                                <wsse:UsernameToken wsu:Id='uuid_faf0159a-6b13-4139-a6da-cb7b4100c10c'>
                                <wsse:Username>UserID</wsse:Username>
                                <wsse:Password>Pass</wsse:Password>
                                <wsse:Nonce>" + nonce + @"</wsse:Nonce>
                                <wsu:Created>" + date + @"</wsu:Created>
                                </wsse:UsernameToken>
                                </wsse:Security>
                                </soap:Header>
                                <soap:Body>
                                <FindBySelfId>
                                <specification>
                                <LastName>" + lastname + @"</LastName>
                                <FirstName>" + firstname + @"</FirstName>
                                <DateOfBirth>" + dob + @"</DateOfBirth>
                                <HomeZipCode>" + zip + @"</HomeZipCode>
                                <SSN4>" + ssn + @"</SSN4>
                                </specification>
                                </FindBySelfId  >
                                </soap:Body>
                                </soap:Envelope>";

            HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://localhost/Employee/employee.asmx");

            req.Headers.Add("SOAPAction", "https://<Namespace here>");

            req.ContentType = "text/xml;charset=\"utf-8\"";
            req.Accept = "text/xml";

            req.Method = "POST";
            Stream stm = req.GetRequestStream();
            doc.Save(stm);
            stm.Close(); 
```

# javascript - 等待 IDBCursor.onsuccess 完成

> ID：12943018
> 
> 赞同：0
> 
> 时间：2012-10-17T20:40:58.013
> 
> 标签：javascript, asynchronous, indexeddb

我有一个 IndexedDB，其中包含页面上各种元素的属性。我在其中一个属性上有一个索引，我使用一个键范围来获取特定的结果列表。

```
var key = IDBKeyRange.bound(10, 20);
var cursor = store.index('property').openCursor(key); 
```

我遇到的问题是`cursor.onsuccess`功能。它似乎为结果集中的每个结果执行。因此，一旦解析了所有结果，我就无法执行回调函数。

```
cursor.onsuccess = function (e) {
    var cursor = e.target.result;
    if (cursor) {
        if (cursor.value.prop1 > 30 && cursor.value.prop2 < 80) {
            // Do stuff with result
            someArray.push({
                prop1: cursor.value.prop1,
                prop2: cursor.value.prop2
            }):
        }
    }
    cursor.continue();
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:40:58.013

事实证明，`cursor.onsuccess`最后一次以`e.target.result`undefined 触发。发生这种情况时，您可以执行回调函数：

```
cursor.onsuccess = function (e) {
    var cursor = e.target.result;
    if (cursor) {
        if (cursor.value.prop1 > 30 && cursor.value.prop2 < 80) {
            // Do stuff with result
            someArray.push({
                prop1: cursor.value.prop1,
                prop2: cursor.value.prop2
            }):
        }
    } else {
        // Execute code here
        console.log('There are ' + someArray.length + ' elements in someArray.');
    }
    cursor.continue();
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T13:43:22.687

知道您的操作已完成的最安全方法是在完成事件时使用事务。该事件在光标关闭后触发。

```
transaction.oncomplete = function (event) {
    console.log('transaction completed');
}; 
```

还要确保没有发生错误，将事件侦听器添加到错误和中止的事务事件中。

```
transaction.onerror = function (event) {
    console.log('transaction error');
};

transaction.onabort = function (event) {
    console.log('transaction abort');
}; 
```

# ubuntu - 如何使用 Chef 在 crontab 中设置环境变量？

> ID：12943021
> 
> 赞同：4
> 
> 时间：2012-10-17T20:41:22.913
> 
> 标签：ubuntu, amazon-ec2, chef-infra, chef-recipe

我有一个将作业设置为从 EC2 实例的 crontab 运行的配方。这是我正在运行的食谱示例：

```
cron "examplejob" do
 minute "0"
 hour "2"
 command "job"
 user "job"
end 
```

这很好用。除了这个 cron 作业，我还想在 crontab 中设置一些环境变量。读到[这里](http://wiki.opscode.com/display/chef/Resources#Resources-Cron)，似乎应该可以使用“路径”属性。但是，我找不到如何实现这一点的具体示例。

我试过了：

```
cron "env" do
 path "MY_VAR=/path/for/variable"
end 
```

但这不起作用。如何在 crontab 顶部设置环境变量？任何见解表示赞赏！谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T22:12:54.327

我相信您正在寻找的答案是`environment`属性，它需要一个 Hash 对象。

请参阅[http://docs.opscode.com/chef/resources.html#arguments](http://docs.opscode.com/chef/resources.html#arguments)和[https://github.com/opscode/chef/commit/96ef7d770a7d898fdce097c7fda9039abf7bf485](https://github.com/opscode/chef/commit/96ef7d770a7d898fdce097c7fda9039abf7bf485)

为了设置自定义环境变量，您将编写以下内容

```
my_env_vars = {"env1" => "val1", "env2" => "val2"}    

cron "env" do
 environment my_env_vars
 command "/path/to/job -someoption"
end 
```

Chef 将遍历您的哈希，您应该在`sudo crontab -e`

```
# Chef Name: env
env1=val1
env2=val2
* * * * * /path/to/job -someoption 
```

快速说明：在我使用 Chef 10.16.2 的机器上，直接在`cron`节中传递哈希将返回语法错误。`syntax error, unexpected tASSOC, expecting '}'`并不是说你应该直接传递哈希，但我认为值得一提，因为其他人可能会重复我同样的错误。只要将哈希值放入变量中，一切都会按预期进行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-17T20:57:16.320

具有与您的环境相对应的顶级密钥的数据包。Opscode wiki 对如何执行此操作进行了快速且中肯的描述。[数据包和环境](http://wiki.opscode.com/display/chef/Environments#Environments-DataBagsandEnvironments "数据包和环境")根据您之前的示例：

```
cron "[node.chef_environment]" do
 path "bag_item[node.chef_environment]["path_for_variable"]"
end 
```

或者，如果你想变得花哨，你可以在你的数据包中使用[模板](http://wiki.opscode.com/display/chef/Templates "模板")，然后在配方中调用你的模板。当您让 crontab 使用不同的变量调用相同的函数时，这将适用。这样您就可以在需要时编辑模板，并且它会反映在不同的环境中。

# c# - 如何支持多种自定义类型？

> ID：12943023
> 
> 赞同：6
> 
> 时间：2012-10-17T20:41:25.097
> 
> 标签：c#

我有一个 Types 项目，我在其中定义了我想在我的主应用程序中处理的自定义类对象。对象基本上是从字符串派生的，并被解析成一个结构。

我有两个问题

1 - 在一个单独的项目中，我有一个文件阅读器类，我在其中扫描文本文件以查找我定义的字符串类型。例如通过正则表达式。目前，我将我的 Types 项目添加为项目参考，我只是在我的阅读类顶部列出了正则表达式。当我找到一种类型时，我将字符串转换为适当的类型。但是，我该如何改进它，使其直接连接到我的 Types 项目 - 所以当我用新类型更新它时，Read 类知道它应该支持新类型？

2 - 在从文本文件中读取这些特定类型后，我正在尝试创建一个适用于这些特定类型的 DLL。如何告诉我的 DLL 我想要支持我的 Types 项目中的类型？我是否必须为要处理的每种类型创建一个重载函数？我使用接口吗？

任何意见是极大的赞赏。

**编辑**：添加了我正在尝试做的示例代码

//PROJECT 1 - 处理 IO 操作，例如读写
//read 类作业中的函数是通过正则表达式查找几种预定义的字符串类型之一...一旦找到它们被转换为数据结构（通过将字符串传递给在其他项目中定义的类型类

```
 public class Read
{
    public string[] FileList { get; set; }

    private static Int64 endOffset = 0;
    private FileStream readStream;
    private StreamReader sr;

    private System.Text.RegularExpressions.Regex type1 = new System.Text.RegularExpressions.Regex(@"@123:test");
    private System.Text.RegularExpressions.Regex type2 = new System.Text.RegularExpressions.Regex(@"TESTTYPE2");

    public Read(string[] fl)
    {
        FileList = fl;
    }

    public object ReturnMessage(FileStream readStream, out int x)
    {
        //readStream = new FileStream(file, FileMode.Open, FileAccess.Read);
        x = 0;
        //endOffset = 0;
        bool found = false;
        char ch;
        string line = string.Empty;

        object message = null;

        while (!(x < 0)) //do this while not end of line (x = -1)
        {
            readStream.Position = endOffset;

            //line reader
            while (found == false)  //keep reading characters until end of line found
            {
                x = readStream.ReadByte();
                if (x < 0)
                {
                    found = true;
                    break;
                }
                // else if ((x == 10) || (x == 13))
                if ((x == 10) || (x == 13))
                {
                    ch = System.Convert.ToChar(x);
                    line = line + ch;
                    x = readStream.ReadByte();
                    if ((x == 10) || (x == 13))
                    {
                        ch = System.Convert.ToChar(x);
                        line = line + ch;
                        found = true;
                    }
                    else
                    {
                        if (x != 10 && (x != 13))
                        {
                            readStream.Position--;
                        }
                        found = true;
                    }
                }
                else
                {
                    ch = System.Convert.ToChar(x);
                    line = line + ch;
                }
            }//while - end line reader 

            //examine line (is it one of the supported types?)
            if (type1.IsMatch(line))
            {
                message = line;
                endOffset = readStream.Position;

                break;
            }
            else
            {
                endOffset = readStream.Position;
                found = false;
                line = string.Empty;
            }

        }//while not end of line

        return message;
    }

} 
```

//PROJECT 2 - 包含定义类型的类

//TYPE1

```
namespace MessageTypes.Type1
{
public sealed class Type1
{
    public List<Part> S2 { get; set; }

    public Type1(string s)
    {
        S2 = new List<Part>();
        string[] parts = s.Split(':');
        for (int i = 0; i < parts.Length; i++)
        {
            S2.Add(new Part(parts[i]));
        }
    }
}

public sealed class Part
{
    public string P { get; set; }

    public Part(string s)
    {
        P = s;
    }
}
} 
```

//类型2

```
namespace MessageTypes.Type2
{
public sealed class FullString
{
    public string FS { get; set; }

    public FullString(string s)
    {
        FS = s;
    }
}
} 
```

//项目 3

```
class DoSomethingToTypeObject{

//detect type and call appropriate function to process

} 
```

//项目 4 -- 带有 GUI 的主项目

```
 public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }
    private void button1_Click(object sender, RoutedEventArgs e)
    {
        if (tabControl1.SelectedIndex == 0) //Processing Mode 1
        {
            //load file list from main window - Mode1 tab
            IOHandler.Read read = new IOHandler.Read(new string[2] { @"C:\file1.txt", @"C:\file2.txt" });

            //read files
            foreach (string file in read.FileList)
            {

                //while not end of stream
                myobject = read.ProcessFile(file);

                DoSomethingtoTypeObject DS = new DoSomethingtoTypeObject(myobject);

                //write transoformed object
                write(myobject);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T20:44:57.270

您应该使用接口，然后让所有类型都实现该接口。之后，您应该更改您的 Read 类以在接口而不是单个类上操作。

这样，您可以添加任意数量的类型，而不必更新 Read 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T01:08:43.290

我希望我能正确理解你。

您在 Type 项目中创建的类表示一些具有不同行为但具有相同数据成员的对象，您希望能够在项目中轻松使用这些对象，而无需显式列出这些对象。

我将创建一些我在 Types 项目中的所有对象都将实现的基本接口。然后我会使用一个工厂类，它会使用反射来收集所有实现所述接口的对象。

```
public interface iFoo
{
    string FoundItem { get; set; }
    string Expression { get; }
    string Value { get; set; }
    void sharedFunctionName();
}

public static class FooFactory
{
    public static List<iFoo> GetTypeList()
    {
        List<iFoo> types = new List<iFoo>();
        types.AddRange(from assembly in AppDomain.CurrentDomain.GetAssemblies()
                       from t in assembly.GetTypes()
                       where t.IsClass && t.GetInterfaces().Contains(typeof(iFoo))
                       select Activator.CreateInstance(t) as iFoo);

        return types;
    }
} 
```

然后，您的阅读器将收到支持类型的所有必要信息，而无需您再手动指定。

由于我猜值类型在某些时候会有所不同，因此您可以使用这样的通用接口：

```
public interface iFoo
{
    string FoundItem { get; set; }
    string Expression { get; }
    void sharedFunctionName();
}

public interface iFoo<T> : iFoo
{
    T Value { get; set; }
}

public static class FooFactory
{
    public static List<iFoo> GetTypeList()
    {
        List<iFoo> types = new List<iFoo>();
        types.AddRange(from assembly in AppDomain.CurrentDomain.GetAssemblies()
                       from t in assembly.GetTypes()
                       where t.IsClass && t.GetInterfaces().Contains(typeof(iFoo))
                       select Activator.CreateInstance(t) as iFoo);

        return types;
    }
}

public class FooBar : iFoo<int>
{

} 
```

在这个例子中，基本接口 iFoo 被保留以简化发现过程。使用泛型接口将允许保持您的代码类型安全（而不是使用类型对象的值），但是在恢复对象时必须添加一些逻辑才能正确访问您的值。

另外，如果您需要创建需要在所有对象中共享的函数，您可以在工厂类和 Voilà 中添加扩展方法。

编辑：

根据新信息：

您的类型对应于您将在基于某些正则表达式的文件中找到的数据类型。根据用户选择和类型，可能会有不同类型的转换。

我们知道用户必须从列表中选择一种模式，这将影响应用于类型的转换。

所以这就是我要做的：我会将转换逻辑直接移动到 Type 类中，多态将准确地处理将调用哪个转换。

我会将用于检测类型的正则表达式放入类型本身，这将允许您更轻松地使用反射和前面讨论的工厂类。

这样，一切都是标准的。您的读者知道您在类型项目中创建的任何新类型，而无需手动干预，并且一旦检测到可以应用正确的转换并且始终可以访问原始字符串。

```
public enum UserMode {Mode1, Mode2};

public interface iType
{
   string Expression {get;}
   string OriginalString {get; set;}
   string Transform(UserMode Mode);
   iType getNewInstance(string OriginalString);

}

public class Type1 : iType
{
   public string Expression {get { return "RegularExpression"; }}
   public string OriginalString {get; set;}
   //Add any other private members you need to accomplish your work here.
   public string Transform(UserMode Mode)
   {
      switch(Mode)
      {
         case UserMode.Mode1:
             //write the transformation code for this scenario
             return ResultString;
             break;
      }
   }

   public iType getNewInstance(string Original)
   {
     return (iType)(new Type1(){ OriginalString = Original });
   }
}

public static class TypeFactory
{
   public static List<iType> GetTypeList()
   {
       List<iType> types = new List<iType>();
       types.AddRange(from assembly in AppDomain.CurrentDomain.GetAssemblies()
                      from t in assembly.GetTypes()
                      where t.IsClass && t.GetInterfaces().Contains(typeof(iType))
                      select Activator.CreateInstance(t) as iType);

       return types;
    }
} 
```

现在，如果匹配列表中 iTypes 中的表达式，您将要做的一切。当你有比赛时，你会：

```
var TransformationReady = from t in TypeFactory.GetTypeList()
                          where Regex.IsMatch(YourFileLine, t.Expression)
                          select t.getNewInstance(Regex.Match(YourFileLine, t.Expression)); 
```

# python - Python中的图像配准和仿射变换

> ID：12943024
> 
> 赞同：3
> 
> 时间：2012-10-17T20:41:30.760
> 
> 标签：python, numpy, computer-vision, scipy, affinetransform

我一直在阅读Jan Erik Solem 的[Programming Computer Vision with Python](http://shop.oreilly.com/product/0636920022923.do)，这是一本非常好的书，但是我无法澄清有关图像配准的问题。

基本上，我们有一堆图像（人脸）需要稍微对齐，所以首先需要通过相似变换执行刚性变换：

```
x' = | sR t | x
     | 0  1 | 
```

其中 x 是要通过旋转 R、平移 t 和缩放 s 转换为 x' 的向量（在这种情况下为一组坐标）。

Solem 为每个图像计算这个刚性变换，它返回旋转矩阵 R 和一个平移向量作为 tx 和 ty：

```
R,tx,ty = compute_rigid_transform(refpoints, points) 
```

但是，出于某种原因，他重新排序了 R 的元素：

```
T = array([[R[1][1], R[1][0]], [R[0][1], R[0][0]]]) 
```

后来他进行了[仿射变换](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.interpolation.affine_transform.html#scipy.ndimage.interpolation.affine_transform)：

```
im2[:,:,i] = ndimage.affine_transform(im[:,:,i],linalg.inv(T),offset=[-ty,-tx]) 
```

在这个例子中，这个仿射变换是在每个通道上执行的，但这并不相关。`im[:,:,i]`是要处理的图像，此过程返回另一个图像。

什么是`T`以及为什么我们在仿射变换中反转该矩阵？实现图像配准的通常步骤是什么？

## 更新

[在这里](http://books.google.com/books?id=J9b_CH-NrycC&pg=PA67&lpg=PA67&dq=computer%20vision%20python%20compute_rigid_transform&source=bl&ots=BY81U0cNsw&sig=a6sM7BvCsvz9SHMUpjJgFXUFC58&hl=en&sa=X&ei=K9WBUI-dBuLWyQGi1IEI&ved=0CCsQ6AEwAg#v=onepage&q=computer%20vision%20python%20compute_rigid_transform&f=false)，您可以在 Google 图书中找到此代码的相关部分。从第 67 页底部开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T20:31:33.093

对我来说，这看起来像是代码中的错误。`T`似乎只是 的转置`R`，对于旋转矩阵，它与逆矩阵相同。然后他在对 的调用中（再次）取反`ndimage.affine_transform`。我认为它应该是`T`或者`linalg.inv(R)`传递给那个函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T02:59:54.967

我将尝试回答您的问题并指出书中的错误（？）。(1) 为什么使用 T = array([[R[1][1], R[1][0]], [R[0][1], R[0][0]]]) ？因为 R,tx,ty = compute_rigid_transform(refpoints, points) 以以下形式计算旋转矩阵和平移：

```
|x'| = s|R[0][0] R[0][1]||x| + |tx|             Equation (1)
|y'|    |R[1][0] R[1][1]||y|   |ty| 
```

但是，OUT = ndimage.affine_transform(IN,A,b) 需要 (y,x) 形式的坐标而不是 (x,y) 的顺序。所以上面的等式（1）将变为

```
|y'| = s|R[1][1] R[1][0]||y| + |ty| = T|y| + |ty|        Equation(2)
|x'|    |R[0][1] R[0][0]||x|   |tx|    |x|   |tx| 
```

然后，在函数 ndimage.affine_transform() 中，矩阵将是 linalg.inv(T)，而不是 linalg.inv(R)。

(2) 仿射变换 OUT = ndimage.affine_transform(IN,A,b) 实际上是 A*OUT + b => IN 。根据式（2），将其改写为

```
|y| = inv(T)|y'| - inv(T)|ty|
|x|         |x'|         |tx| 
```

所以函数 ndimage.affine_transform() 中的偏移量是 inv(T)[-ty, -tx]，而不是 [-ty -tx]。我认为这是原始代码中的错误。

# java - OutOfMemoryError: PermGen Space -- Jasper Report with Spring 在 Tomcat 上运行

> ID：12943030
> 
> 赞同：8
> 
> 时间：2012-10-17T20:42:04.840
> 
> 标签：java, spring, tomcat, jasper-reports, jstl

我们的 Web 应用程序遇到一个复杂的情况

它是由 STS/ 开发的 Spring 应用程序`Tomcat 7`。应用程序集成后`Jasper report 4.6.0`，总是抛出 `OutOfMemoryError: PermGen Space. 然后让它工作的唯一方法是重新启动应用程序。但过了一会儿又发生了。这是异常之前的日志：

```
Oct 17, 2012 3:42:27 PM org.apache.jasper.compiler.TldLocationsCache tldScanJar
INFO: At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
Oct 17, 2012 3:42:30 PM org.apache.catalina.core.ApplicationDispatcher invoke
SEVERE: Servlet.service() for servlet jsp threw exception 
```

这是异常中的一个部分，我在其中发现了一些内容`Jasper`：

```
at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:442)
at org.apache.jasper.compiler.Compiler.compile(Compiler.java:378)
at org.apache.jasper.compiler.Compiler.compile(Compiler.java:353)
at org.apache.jasper.compiler.Compiler.compile(Compiler.java:340)
at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:646)
at org.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:240)
at org.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:578)
at org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:49)
at org.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:655) 
```

以下是出现这种情况时的一些发现：

1.  该问题可能发生在没有任何 Jasper 报告组件的页面上。Jasper Report bean 似乎一直在尝试查找标记库，而`a request is processed by the back end and responded to the front end`. 通常从日志文件中我可以看到，在所有后端操作（JPA 管理）完成之前，上述异常不会抛出

2.  在调试模式下运行 log4J 时，我看到大量信息显示诸如解析/渲染 Jasper 模板中的所有组件（文本字段、笔、框......），从巨大的日志中有一个小切口：

    ```
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester.sax -- startElement(http://jasperreports.sourceforge.net/jasperreports,textElement,textElement)
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester --   Pushing body text ''
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester --   New match='jasperReport/summary/band/textField/textElement'
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester --   Fire begin() for FactoryCreateRule[className=net.sf.jasperreports.engine.xml.JRTextElementFactory, attributeName=null, creationFactory=net.sf.jasperreports.engine.xml.JRTextElementFactory@12dc6007]
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester -- [FactoryCreateRule]{jasperReport/summary/band/textField/textElement} New net.sf.jasperreports.engine.design.JRDesignTextField
    2012-10-17 15:29:12,025 -- DEBUG -- org.apache.commons.digester.Digester.sax -- ignorableWhitespace() 
    ```

    尽管如此，当对不包含任何 Jasper 组件的页面的请求时，仍会生成此日志。

我做了一些研究，但仍然找不到解决这个问题的方法。

1.  第一个问题是即使`jasperreport bean`在应用程序中也有一个问题，为什么当它甚至没有与当前服务自动装配时它总是在运行（意味着当前页面没有任何 jasper 组件）。这种情况有解决方案/答案吗？

2.  同样来自异常消息 扫描了至少一个 JAR 以查找 TLD，但未包含 TLD。在 org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:442)

    应该来自 Tomcat，并且`Tomcat never contains any JSTL jar`，然后我假设它找不到匹配的 TLD 来解析 jasper 报告，因此对所有 jar 进行全面扫描。如果是这样，那么为什么有大量的调试日志`org.apache.commons.digester.Digester`实际上似乎忙于解析 jasper 模板？

一般来说，做这个线程只是试图找出解决问题的方法，同时也找到为什么Jasper在一个不需要它的地方如此活跃的答案，以及我们如何让tomcat正确解析模板？

如果过于冗长，请道歉，并感谢您的任何提示。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T16:35:55.970

感谢大家提供有关此问题的解决方案，我已针对我的情况确定了该问题，以下是解决方案：

**使用 .jasper 而不是 .jrxml 作为模板！**

众所周知`.jasper`，这是一个已编译的模板以及`.jrxml`该模板的 ASCII 源代码，因此如果我们在当前的 spring 应用程序中使用原始源代码文件（jrxml）作为模板，那么至少 spring 框架必须编译源代码文件。这是留给 Spring 框架的效率问题，因为它是 jasper bean 来处理编译，并且不能保证编译只执行一次，并且只在应用程序启动时发生。

简而言之，将所有模板替换为 .jasper 文件后，日志大小已显着减小，并且不再出现内存不足的问题。我猜 Spring 容器在运行时可能会消耗大量资源来将 jrxml 编译为 jasper。所以它可能是 Jasper 或 Spring 应该改进的东西......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-18T02:38:53.477

当 JVM 的 permgen 空间中有太多 .class 文件，由于引用了 AppClassLoader 之外的对象而无法进行垃圾回收时，就会发生异常。它通常指出您的应用程序存在一些内存泄漏。

[这篇](http://frankkieviet.blogspot.ca/2006/10/classloader-leaks-dreaded-permgen-space.html)文章对 java.lang.OutOfMemoryError: PermGen space 错误有一个清晰的解释，下面[的文章](http://frankkieviet.blogspot.ca/2006/10/how-to-fix-dreaded-permgen-space.html)有关于如何修复它的建议。在 SO 上提出了一个类似（但不完全相同）的[问题](https://stackoverflow.com/questions/88235/dealing-with-java-lang-outofmemoryerror-permgen-space-error)，让您知道是否错过了它。我希望它有所帮助。

正如 jakub 所提到的，设置`-XX:+CMSClassUnloadingEnabled` `-XX:+CMSPermGenSweepingEnabled`或设置更高的值`XX:MaxPermSize`可能对您有用。但从我所阅读的内容来看，这似乎不是一个永久的解决方案。（我不是这方面的大师:)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T21:06:33.450

尝试在您的 VM 中设置这些参数。这些应该能够让 GC 清理你的 permGen。

```
-XX:+UseConcMarkSweepGC
-XX:+CMSPermGenSweepingEnabled
-XX:+CMSClassUnloadingEnabled 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-01T10:00:33.823

我开发了一个使用 JasperReports 4.5.1 的 Web 应用程序

我使用 Tomcat 6.0.26 作为容器。(Win7, JDK 1.6.0_25)

关闭tomcat时，它会抛出：

Web 应用程序创建了一个 ThreadLocal，其键类型为 [net.sf.jasperreports.engine.util.JRFontUtil$1]（值 [net.sf.jasperreports.engine.util.JRFontUtil$1@7892f1]），值类型为 [java .util.HashSet]（值 [[]]）但在 Web 应用程序停止时未能将其删除。**这很可能造成内存泄漏。**

请访问网站：

[http://community.jaspersoft.com/questions/534340/memory-leak-jr-373](http://community.jaspersoft.com/questions/534340/memory-leak-jr-373)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T21:25:01.817

由于 PermGen 主要包含类元数据，以及常量和内部字符串，您可以从两个方向搜索：

*   检查 webapp 是否包含（太多）无用的 jar，这些 jar 可能由于扫描而被加载

*   查看您是否有大量使用堆转储的常量字符串（例如，大量大型 JSP），或者您的代码是否使用 String.intern()

* * *

实际上，您没有指定您使用的 Java 版本：对于 Java 7，字符串可能不是问题。

您可以做的是使用 VisualGC 插件使用 JVisualVM 观察应用程序，以查看生成的状态、加载的类的数量以及在 OOM 时是否出现激增，或者是否构建缓慢-向上。

# perl - Perl 哈希数组 foreach 问题

> ID：12943043
> 
> 赞同：0
> 
> 时间：2012-10-17T20:43:11.413
> 
> 标签：perl, associative-array

我有一个通过 Data::Dumper - Dumper($cat_response->result->{'categories'}) 显示的响应

```
$VAR1 = { 'literature' => '1120', 'law' => '1153', 'arts and crafts' => '1132', 'children' => '1141', 'hobbies' => '1133', 'economy' => '1166', 'jobs' => '1140', 'media' => '1144', 'music' => '1147', 'animals' => '1170', 'business' => '1119', 'diet' => '1122', 'travel reviews' => '1154', 'jewelry' => '1157', 'movies' => '1146', 'television' => '1125', 'politics' => '1168', 'internet' => '1139', 'history' => '1129', 'recipes' => '1156', 'press releases' => '1151', 'presents' => '1128', 'marketing' => '1143', 'translations' => '1162', 'fashion' => '1145', 'technology' => '1163', 'real estate' => '1138', 'computer' => '1173', 'automobile' => '1116', 'finances' => '1126', 'weddings' => '1134', 'games' => '1127', 'esoterism' => '1124', 'horoscopes' => '1135', 'shopping' => '1123', 'humor' => '1137', 'miscellaneous' => '1159', 'science' => '1167', 'programming' => '1152', 'languages' => '1161', 'beauty' => '1117', 'sports' => '1160', 'hotels' => '1136', 'plants' => '1149', 'education' => '1118', 'traveling' => '1155', 'health' => '1130', 'telecommunication' => '1164', 'environment' => '1171', 'software' => '1158', 'sweepstakes' => '1131', 'logistics' => '1142', 'home and family' => '1169', 'news' => '1148' }; 
```

要访问它，我使用：

```
my %categories = $cat_response->result->{'categories'};
foreach my $cat (keys (%categories)) {
    <option value="<% $categories{'$cat'} %>"><% $cat %></option>
} 
```

但是，Dumper($cat) 的值是： $VAR1 = 'HASH(0x7fe972641560)';

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:46:15.360

你缺`use strict; use warnings;`一个。（好吧，要么这样，要么你忘了告诉我们 Perl 告诉过你你的问题。）

`$cat_response->result->{'categories'}`包含对哈希的引用。将其分配给哈希是没有意义的。

```
my $categories = $cat_response->result->{'categories'};
foreach my $cat (keys (%$categories)) {
    <option value="<% $categories->{'$cat'} %>"><% $cat %></option>
} 
```

# django - 模型表格更新页面显示给所有注册用户

> ID：12943044
> 
> 赞同：0
> 
> 时间：2012-10-17T20:43:16.120
> 
> 标签：django

我有这个页面：8000/edit/6/，它显示了一个更新令人兴奋的模型的表单，我以 X 身份登录，如果我以 Y 身份登录并尝试打开该页面，我可以看到它并更新。所以这无疑是一个大错误和危险。

这是我的查看代码

```
class VideoUpdate(UpdateView):
   form_class = VideoForm
   model = Video
   template_name = 'videos/video_update.html'

   @method_decorator(login_required)
   def dispatch(self, *args, **kwargs):
      return super(VideoUpdate, self).dispatch(*args, **kwargs)

   def form_valid(self, form):
      messages.info(self.request, _('Event is updated successfully'))
      return super(VideoUpdate, self).form_valid(form) 
```

有没有办法用用户 ID 检查模型对象 ID。新手的一个简单问题

# 解决方案：

实际上，views.py 中有两种对我有用的解决方案，一种是使用 get_queryset 方法

```
def get_queryset(self):
    base_qs = super(VideoUpdate, self).get_queryset()
    return base_qs.filter(user=self.request.user.get_profile) 
```

或使用 get_object 方法

```
def get_object(self):
    video = get_object_or_404(Video, pk=self.kwargs['pk'])
    if video.user != self.request.user.get_profile():
        raise Http404
    return video 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:53:40.540

您的问题对我来说并不完全清楚，但我认为您想限制注册但未经授权的用户查看。通常，这可以在您的视图而不是模型中更好地实现：

```
# views.py

def edit_form(request, parameter_indicating_user):
  user = request.user

  if #some logic:
    # if user is equal to the user indicated by some parameter 
    # (id, username, etc) then allow that view to be rendered
  else:
    raise Http404 # or redirect the unauthorized user 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:26:35.857

我将您的问题解释为以下含义。

当使用基于类的视图时 - 有没有办法控制表单的特定实例是否可由给定用户编辑，即。我们有一个模型的记录#1。当您以用户 X 身份登录时，您可以编辑记录 #1，但不允许用户 Y 编辑记录 #1。

如果这就是您所说的，您将需要行/对象级别的权限，我发现这在使用 django-guardian 时是最好的。

具体来说，当使用基于类的视图时，您可以使用 PermissionRequiredMixin，可以在这里找到：[http ://packages.python.org/django-guardian/api/guardian.mixins.html#permissionrequiredmixin](http://packages.python.org/django-guardian/api/guardian.mixins.html#permissionrequiredmixin)

如果您只想控制用户 X 与用户 Y 是否可以编辑该表单的任何实例。IE。用户 X 可以编辑表单 A 值。然后您只需要适当地管理权限，然后检查用户是否在视图中具有该权限。

京东

# c - 我需要读取字符串中的所有整数、数学运算符和字符

> ID：12943045
> 
> 赞同：0
> 
> 时间：2012-10-17T20:43:19.563
> 
> 标签：c, parsing, char, int, atoi

我有一个字符串，其中可能包含单个整数`0-9`或数学运算符`(+, -, *, /)`。

基本上，我需要阅读所有字符/数字。我正在检查字符是 +、-、* 还是 /。如果不是，那么我知道它是数字或无效字符。我正在使用 atoi 将其转换为整数。atoi 在两种情况下都将返回 0：如果整数是 0 或如果它是无效字符。

我还能如何做出这种区分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:49:23.380

在使用 atoi 之前使用标准 isdigit() 函数检查每个字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:46:21.723

用于`strtol`执行错误检测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T06:13:40.277

```
int main (void)
{
    int i, j ;
    char num_string[] = "1 234 23 45" ;
    char tmp [2] = {'\0', '\0'} ;
    int length = strlen (num_string) ;
    int* values = (int*) malloc (sizeof (int) * length) ;
    for ( i = 0, j = 0; i < length; ++i)
    {
        if ( isdigit (num_string[i] ) )
        {
            tmp [0] = num_string [i] ;
            values [j++] = atoi (tmp) ;
        }
    }
    printf ("\nThe string: %s", num_string) ;
    printf ("\nThe integer array which results is: ") ;
    for ( i = 0; i < j; ++i)
        printf (" %d ", values[i]) ;
    return 0 ;
} 
```

输入：1 22 33 4 555

输出：1 2 2 3 3 4 5 5 5

# javascript - 单击运行左/右精灵动画

> ID：12943055
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:44:25.537
> 
> 标签：javascript, jquery, sprite-sheet

我对这个精灵动画有问题。 [sprite-sheet](http://www.torbak.com/varie/girl_60x60.png) 脚本不会更改正确的动画，并且每次单击同一方向时速度都会增加。

```
<div id="coordinates">MOUSE XY</div>    
<div id="map" style="width:960px; height:80px; background-color:black; ">   
 <div id="player"></div>  
</div> 
```

Javascript 和 Jquery

```
<style> #player{background-image:url('girl_60x60.png'); 
    width:60px; height:60px; position:relative; 
    z-index:12; left:465px;}</style>

<script type="text/javascript"> 
 // click event 
 $('#map').click(function(e) { 
  // take coordinates
  var posX = e.pageX ;
  var posY = e.pageY;
  //print X e Y
  $('#coordinates').html("X: " + posX + " Y: " + posY); 

  if (posX <= 480) {   //Check the click relative to the center.
   setInterval('ani_left()',100); //left animation                          
  } else {              
   setInterval('ani_right()',100); //right animation
  }
}); 

var frame = 1;

// Right animation
function ani_right() {
 var left = 60 * frame;  //next frame every 60px
 var top = 0;
 $('#player').css('backgroundPosition','-'+left+'px -'+top+'px');
 frame++;
}
// left animation
function ani_left() {
 var left = 60 * frame;
 var top = 60;   //second row of frames
 $('#player').css('backgroundPosition','-'+left+'px -'+top+'px');
 frame++;
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T08:04:37.913

您应该停止执行以前`setInterval`的 with `clearInterval(idInterval)`。

我建议你使用`setInterval(funcName,100)`而不是`setInterval('funcName()',100)`；

```
var idInt = -1; // add this
 // click event 
 $('#map').click(function(e) { 
     if(idInt != -1) 
         clearInterval(idInt); // add this 
/* .. CUT .. */

  if (posX <= 480) {   //Check the click relative to the center.
      idInt = setInterval(ani_left,100); //left animation                          
  } else {              
      idInt = setInterval(ani_right,100); //right animation
  }
}); 

/* cut */ 
```

[在这里提琴](http://jsfiddle.net/BJgQz/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:49:05.530

在开始新的抽签间隔之前，您必须清除旧抽签间隔

```
var interval;

if (posX <= 480) {   //Check the click relative to the center.
   clearInterval(interval);
   interval = 0;
   interval = setInterval(ani_left,100); //left animation                          
  } else {              
   clearInterval(interval);
   interval = 0;
   interval = setInterval(ani_right,100); //right animation
  } 
```

# javascript - node-ntwitter 和 twitter API 限制

> ID：12943060
> 
> 赞同：0
> 
> 时间：2012-10-17T20:44:35.257
> 
> 标签：javascript, node.js, asynchronous, twitter

与 API 限制相关的问题，这可能是我刚刚遗漏的东西，但不确定：

如果我这样做：

```
 twit.showUser(ids, function(error, response) {
   console.log(response)
 } 
```

其中 {ids} 是一个数组，长度 < 100，一切正常。

当我做同样的事情并且 ID 大于 100 时，它会失败。

这是基于： [https ://dev.twitter.com/docs/api/1.1/get/users/lookup](https://dev.twitter.com/docs/api/1.1/get/users/lookup)

特别是：

> 每个请求最多 100 个用户

这是在 ntwitter 模块中以某种方式管理的，还是我需要在外部管理它？如果是这样，关于如何管理它的任何建议？

或者，在 node-ntwitter 模块之外，如果我想发回来自 showUser()的所有*响应的复合 json，你会如何建议以干净的方式解决这个问题？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:07:47.243

> 每个请求最多 100 个用户

意味着您一次只能请求 100 个 ID。你可以运行一个增加 100 的 for 循环：

```
for(var i = 0; i < ids.length; i + 100) {
  requestIds = ids.slice(i, i+99)
  twit.showUser(requestIds, function(error, response) {
   console.log(response)
 }
} 
```

*（未经测试）*

由于它是 node.js，您可能希望它是异步的。查看[forEachLimit](https://github.com/caolan/async#foreachlimitarr-limit-iterator-callback)和[forEachSeries](https://github.com/caolan/async#foreachseriesarr-iterator-callback)。

# tsql - 如何在同一个 SPROC 中编写多个语句

> ID：12943061
> 
> 赞同：0
> 
> 时间：2012-10-17T20:44:35.983
> 
> 标签：tsql

由于我没有**ModuleID**，我想首先使用**ModuleName**从 Modules 表中获取。

```
ALTER PROCEDURE dbo.spEditTask
@ID                     int,
@ModuleName             varchar(50), 
@Task                   varchar(50), 
@ListOfDevelopers       varchar(50),
@StartDate              date, 
@PlannedEndDate         date, 
@EstimatedEndDate       date, 
@Status                 varchar(50),
@Comments               varchar(500),
@LastAction             varchar(50),
@Started                 bit
AS
BEGIN 

  DECLARE @ModuleID int; 
  SET @ModuleID = 
  (SELECT ModuleID 
  FROM Modules
  WHERE ModuleName = @ModuleName); 
  GO

  UPDATE DTasks
SET ModuleID = @ModuleID, 
    Task = @Task, 
    ListOfDevelopers = @ListOfDevelopers, 
    StartDate = @StartDate, 
    PlannedEndDate = @PlannedEndDate, 
    EstimatedEndDate = @EstimatedEndDate, 
    Status = @Status, 
    Comments = @Comments, 
    LastAction = @LastAction,
    Started  = @Started,
    LastUpdated = GETDATE() 
WHERE ID  = @ID
GO
END 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:48:28.900

你需要把你的行换成`begin`和`end`

```
ALTER PROCEDURE dbo.spEditTask 
@ID                     int, 
@ModuleName             int, 
@Task           varchar(50) 
as 
begin     
    DECLARE @ModuleID int;  

    SELECT @ModuleID = ModuleID  
    FROM Modules 
    WHERE ModuleName = @ModuleName  

    UPDATE DTasks 
    SET   ModuleID = @ModuleID,  
      Task = @Task,  
    WHERE ID   = @ID 
end 
```

虽然你可以只用一行

```
UPDATE DTasks
SET
   ModuleID = Modules.ModuleID,
   Task = @task
FROM DTasks cross join Modules
WHERE DTasks.ID = @ID
AND Modules.ModuleName = @ModuleName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:56:14.377

您只是缺少`as`关键字和 select 表达式周围的括号：

```
ALTER PROCEDURE dbo.spEditTask
@ID                     int,
@ModuleName             int,
@Task           varchar(50)
AS

DECLARE @ModuleID int; 

SET @ModuleID =
(SELECT ModuleID 
FROM Modules
WHERE ModuleName = @ModuleName)

UPDATE DTasks
SET   ModuleID = @ModuleID, 
      Task = @Task, 
WHERE ID   = @ID 
```

# ios - UISwitch 双击

> ID：12943062
> 
> 赞同：3
> 
> 时间：2012-10-17T20:44:38.997
> 
> 标签：ios, uiswitch

我目前有一个`UISwitch`打开和关闭时分别递增和递减计数器。

当计数器为 0 时，计数器不会递减。从功能上讲，这很有效，但是我注意到了一个错误，想知道是否有人遇到过这种情况。

本质上，如果您非常快速地双击 UISwitch 在其远位置（完全打开或关闭），计数器将增加两倍，因为我想象 UISwitch 没有完全达到关闭状态，因此只是简单地添加到计数器没有首先减少它。

这是我用来检查交换机的代码：

```
// Sliders modified

- (IBAction)personalityChanged:(id)sender {
    if ([personality isOn] ){
        [[[GlobalData sharedGlobalData]personalitySliderValue] replaceObjectAtIndex:currentRecord-1 withObject:@"1"];
        rating ++;
        NSLog(@"The value of personality slider is %@", [[[GlobalData sharedGlobalData]personalitySliderValue] objectAtIndex:currentRecord-1]);
        [personality set]
    }
    else {
        [[[GlobalData sharedGlobalData]personalitySliderValue] replaceObjectAtIndex:currentRecord-1 withObject:@"0"];
        [self subtractFromRating:nil];
        NSLog(@"The value of personality slider is %@", [[[GlobalData sharedGlobalData]personalitySliderValue] objectAtIndex:currentRecord-1]);
    }
    [self checkRating:nil];
} 
```

然后是减法评分：

```
// subtract from rating

-(void)subtractFromRating:(id)sender{
    if (rating == 0) {
        // do nothing
    }
    else
    {
        rating --;
    }
} 
```

最后，如果滑块处于某个位置会发生什么：

```
// check rating

-(void)checkRating:(id)sender{
    switch (rating) {
        case 0:
            [matchRating setText:@""];
            [ratingGraphic setImage:[UIImage imageNamed:@""]];
            NSLog(@"rating is 0");
            break;
        case 1:
            [matchRating setText:@"Single Match"];
            [ratingGraphic setImage:[UIImage imageNamed:@"ratinggraphic1.png"]];
            NSLog(@"rating is 1");
            break;
        case 2:
            [matchRating setText:@"Potential Match"];
            [ratingGraphic setImage:[UIImage imageNamed:@"ratinggraphic2.png"]];
            NSLog(@"rating is 2");
            break;
        case 3:
            [matchRating setText:@"Great Match"];
            [ratingGraphic setImage:[UIImage imageNamed:@"ratinggraphic3.png"]];
            NSLog(@"rating is 3");
            break;
        case 4:
            [matchRating setText:@"Hot Match"];
            [ratingGraphic setImage:[UIImage imageNamed:@"ratinggraphic4.png"]];
            NSLog(@"rating is 4");
            break;
        default:
            break;
    }
} 
```

有没有办法确保开关在返回之前完全从开启状态变为关闭状态，或者有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T01:05:51.927

检测是否确实发生了变化的一种解决方案是保留一个额外的 BOOL 变量来跟踪最后的开关状态。

```
BOOL lastValue = NO; // initial switch state
- (IBAction)personalityChanged:(id)sender {
    if (personality.isOn != lastValue) {
        lastValue = personality.isOn;
        if ([personality isOn] ){
            [[[GlobalData sharedGlobalData]personalitySliderValue] replaceObjectAtIndex:currentRecord-1 withObject:@"1"];
            rating ++;
            NSLog(@"The value of personality slider is %@", [[[GlobalData sharedGlobalData]personalitySliderValue] objectAtIndex:currentRecord-1]);
            [personality set]
        }
        else {
            [[[GlobalData sharedGlobalData]personalitySliderValue] replaceObjectAtIndex:currentRecord-1 withObject:@"0"];
            [self subtractFromRating:nil];
            NSLog(@"The value of personality slider is %@", [[[GlobalData sharedGlobalData]personalitySliderValue] objectAtIndex:currentRecord-1]);
        }
        [self checkRating:nil];
    }
} 
```

这将仅在开关状态实际改变时执行。

# excel - 使用 MS Jet OLEDB 4 驱动程序从 MS Access 2003 db 将数据导入 Excel 2003 会导致 ISAM 错误

> ID：12943063
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:44:46.130
> 
> 标签：excel, excel-2003, ms-access-2003, vba

我正在尝试通过 Excel 2003 运行存储在 MS Access 2003 数据库中的查询。连接字符串如下：

```
 flLoc=thisworkbook.path
 stDB= floc & "\list.mdb"
 stConn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & stDB & ";" 
```

db 当前存储在网络文件夹中。我可以使用我机器上的上述连接字符串连接到 Access db，但是当我的一位同事打开文件并尝试单击具有与该按钮关联的代码和连接字符串的按钮时，他得到一个“可以找不到可安装的 ISAM”。两台机器都使用 Access 2003 和 Excel 2003 版本。

任何建议如何使这项工作？

请注意，编辑注册表不是一个选项，因为用户没有管理员权限，并且文件将被多个用户使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T18:44:03.580

请参阅 Microsoft 的此 KB：

[http://support.microsoft.com/kb/209805](http://support.microsoft.com/kb/209805)

至于修改注册表，这看起来像是一个单独的机器错误，必须修复，并且可能需要管理员修复 DLL 上的注册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T17:47:19.487

原来，另一个人在他的机器上使用 Access 2002 版本来查看报告。报告链接到 SharePoint 列表，并且 Access 2002 不提供与 Sharepoint 本身的连接。

# jquery - 选择嵌套元素的值

> ID：12943065
> 
> 赞同：0
> 
> 时间：2012-10-17T20:44:55.440
> 
> 标签：jquery

我有嵌套元素：

```
<ul class="level-1">
  <li class="item-i">I</li>
  <li class="item-ii">II
    <ul class="level-2">
      <li class="item-a">A</li>
      <li class="item-b">B
        <ul class="level-3">
          <li class="item-1">1</li>
          <li class="item-2">2</li>
          <li class="item-3">3</li>
        </ul>
      </li>
      <li class="item-c">C</li>
    </ul>
  </li>
  <li class="item-iii">III</li>
</ul> 
```

点击时如何获取价值（它是'1'）`li class="item-1">1</li>`？我在定义正确的选择器时遇到问题......如何以这样的方式结束：

```
$(all children of level-1).click(function() {
    alert($(this.item-1").val(););
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:48:06.623

尝试这个

`$(this).text()` 或者 `$(this).html()`

`.val()`用于输入字段..因此您无法访问您使用的数据`.val()`

```
$('.level-1 li').on('click', function(e) {

    alert($(this).contents().filter(function() {
        return this.nodeType == 3
    }).text());
    e.stopPropagation();
}); 
```

不要忘记`e.stoppropagation()` .. 否则您还会看到父目录中的文本..

[试试小提琴](http://jsfiddle.net/sushanth009/3z3Th/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:59:27.050

我已经创建了一些测试的[小提琴，我想这可以满足你的需要](http://jsfiddle.net/felipekm/YyV4L/)

这是我所做的：

```
$('.level-3').children('.item-1').css('color', 'red');​ 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-17T20:46:45.517

```
$(".level-1 li").click(function() {
    console.log($(this).val());
}); 
```

请阅读 jQuery 事件和选择器： http: [//docs.jquery.com/Main_Page](http://docs.jquery.com/Main_Page)

# android - Android 操作栏两行文本标签

> ID：12943069
> 
> 赞同：2
> 
> 时间：2012-10-17T20:45:00.213
> 
> 标签：android, android-actionbar

有没有办法（可能是一些特殊字符沿着不间断空格的行）我可以强制我的操作栏中的菜单项有两个行标签？我认为这看起来比长的单行标签标签更好......

谢谢，
R。

编辑，附加信息：抱歉，到目前为止，我设法避免需要溢出菜单，可能是因为我正在为具有漂亮大屏幕的 Nexus 7 进行开发。澄清一下，我的菜单选项卡之一（在操作栏中）是“恢复默认值”，但我认为如果是这样的话会更好看：

恢复
默认值

是否可以将某些内容合并到我的 Strings.xml 文件中以强制操作栏显示这样的项目？当我为所有五个菜单项使用更长的名称时，“恢复默认值”DID 显示在两行上（但它是唯一的一行）。无论如何，我知道这是可能的，只是不是故意的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T21:33:16.700

由于 toadzky 没有回答他的评论，我将：

在菜单项的标题中插入“\n”。那应该让它换行。

一旦他提出来作为答案，我将删除我的，您可以接受他的，但这样至少可以正式关闭问题。

# c++ - 过时的数据结构编程书籍的可信度

> ID：12943071
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:45:11.257
> 
> 标签：c++, algorithm, sorting

我最近从本地图书馆租了一本关于 c++ 的书，书名是：Joseph Bergin 的“Data Structure Programming with the standard template library in c++”。问题是当我检查它的出版日期时，它是 1998 年，考虑到今天计算机的发展速度，这是一个相当大的时间框架。这本书会伤害我还是帮助我？这是我书中算法的摘录：

```
//  THIS IS AN ALGORITHM EXPLAINED AS SELECTION SORT
template <class T>
void selectionSort(T* start, T* end)                //first off, i notice an excessive use of pointers, when usually 
{   for(T* where = start ; where < end ; where++)   // im told to work around pointers if i dont need to use them
    {   T* loc = where;                             //weird bracket formatting(old practice i would guess?)
        T small = *loc;
        for                                         //very strange method of organizing for loops used in the book
        (   T* inner = where + 1;
            inner < end;
            inner++;
        )
            if(*inner < *loc)
            {   loc = inner;
                small = *loc;
            }
        *loc = *where;
        *where = small;
    }
} 
```

此代码使用奇怪的方法来进行选择排序。指针可以很容易地用普通值替换，但本书喜欢使用指针和奇怪的 for 循环格式。这段代码与现代 C++11 方法与数组选择排序相差多远？

*他们还用 _ 前缀声明所有变量，这对变量有什么特别的作用吗？声明变量的例子：

```
int _Num1;
float _Select; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:52:27.790

你应该买一本新书，但这并不意味着你现在的书一定是有害的。

C++ 语言由国际委员会编写的标准定义。编译器在不同程度上实现了这个标准，但它们或多或少都遵循 C++ 标准。

自 1998 年以来，产生的不是一个而是两个新标准——一个是在 2003 年（通常称为 C++03），另一个是最近在 2011 年（C++11）。1998 年存在的基本习语在今天仍然适用，因此学习这些习语仍然很重要。但是标准库发生了重大变化，包括许多人（错误地）称为“STL”的标准库部分。随着我们对这门语言的经验的增长，许多在 1998 年已知的习语都得到了改进，并且在 C++11 中出现了在 1998 年不可能出现的新习语。

有一篇很棒的[Wikipedia 文章](http://en.wikipedia.org/wiki/C++0x)列举了 C++11 和 C++03 之间的许多差异，而从 1998 年开始，C++ 的差异甚至更多。

这是我一直在读的一本新书。[C++ 标准库：教程和参考（第 2 版）](https://rads.stackoverflow.com/amzn/click/com/0321623215)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T20:49:00.650

我向你保证，今天每个被称为优秀程序员的人都会从那些日期（甚至在那之前）阅读书籍，所以我认为这不会伤害你，因为它是关于概念和概念永远不会发生巨大变化，但如果你能找到一本更新的书，那就太棒了！

# javascript - 使用 apply() 函数的 JavaScript 函数构造函数链接

> ID：12943073
> 
> 赞同：2
> 
> 时间：2012-10-17T20:45:12.710
> 
> 标签：javascript, html, object, constructor

我试图理解 Mozilla 在构造函数链上发布的一些代码。我已经对我认为我理解的部分添加了评论，但我仍然不清楚这里发生的一切。有人可以逐行解释这段代码中发生了什么吗？

```
// Using apply() to chain constructors.
Function.prototype.construct = function (aArgs) {

    // What is this line of code doing?
    var fConstructor = this, fNewConstr = function () { fConstructor.apply(this, aArgs); };

    // Assign the function prototype to the new function constructor's prototype.
    fNewConstr.prototype = fConstructor.prototype;

    // Return the new function constructor.
    return new fNewConstr();
};

// Example usage.
function MyConstructor () {

    // Iterate through the arguments passed into the constructor and add them as properties.
    for (var nProp = 0; nProp < arguments.length; nProp++) {
        this["property" + nProp] = arguments[nProp];
    }
}

var myArray = [4, "Hello world!", false];
var myInstance = MyConstructor.construct(myArray);

// alerts "Hello world!"
alert(myInstance.property1); 

// alerts "true"
alert(myInstance instanceof MyConstructor); 

// alerts "MyConstructor"
alert(myInstance.constructor); 
```

[原始代码可以在这里找到。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:05:31.387

基本上，这是调用构造函数的另一种方法，它使您有机会将构造函数调用包装在另一个函数中。我将专注于您感到困惑的那条线。 `fConstructor`设置为`this`，它引用了我们原来的构造函数，在这个例子中是`MyConstructor`。 `fNewConstr`是将覆盖原始构造函数的构造函数。在其中，`fNewConstr`您可以实现在`MyConstructor`. 在`fNewConstr`中，我们`fConstructor`使用 Function [apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)方法调用，`this`作为上下文传递，并将`aArgs`数组传递给构造方法。然后我们将原型设置`fNewConstr`为`fConstructor`原型完成继承链。最后，我们返回一个新的实例`fNewConstr`。在函数调用前加上 new 关键字会创建一个新对象，将其原型设置为函数的原型，并在新项的上下文中调用函数。因为我们将`fConstructor`方法应用到`fNewConstr`的上下文中，所以结果与调用 基本相同`new MyConstructor()`。说得通？或者我需要更详细地介绍。

# javascript - Javascript'这个'

> ID：12943076
> 
> 赞同：6
> 
> 时间：2012-10-17T20:45:20.047
> 
> 标签：javascript

你能解释一下为什么第二次调用`fn`会出错吗？代码如下。

```
function Test(n) {
  this.test = n;

  var bob = function (n) {
      this.test = n;
  };

  this.fn = function (n) {
    bob(n);
    console.log(this.test);
  };
}

var test = new Test(5);

test.fn(1); // returns 5
test.fn(2); // returns TypeError: 'undefined' is not a function 
```

这是一个重现错误[http://jsfiddle.net/KjkQ2/的 JSfiddle](http://jsfiddle.net/KjkQ2/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T20:51:12.620

您的`bob`函数是从全局范围调用的。因此，`this.test`指向一个名为的全局变量`test`，该变量正在覆盖您创建的变量。如果你跑`console.log(window.test)`，你会发生什么。

为了使您的代码按预期运行，您需要以下之一

```
function Test(n) {
  this.test = n;

  // If a function needs 'this' it should be attached to 'this'       
  this.bob = function (n) {
      this.test = n;
  };

  this.fn = function (n) {
    // and called with this.functionName
    this.bob(n);
    console.log(this.test);
  };
} 
```

或者

```
function Test(n) {
  this.test = n;

  var bob = function (n) {
      this.test = n;
  };

  this.fn = function (n) {
    // Make sure you call bob with the right 'this'
    bob.call(this, n);
    console.log(this.test);
  };
} 
```

或基于闭包的对象

```
// Just use closures instead of relying on this
function Test(n) {
  var test = n;

  var bob = function (n) {
      test = n;
  };

  this.fn = function (n) {
    bob(n);
    console.log(test);
  };
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T20:51:07.980

当调用`bob(n)`inside时`.fn`，它​​在`global context`(`window`在浏览器中) 内调用。现在，您正在设置`window.test = n;`它基本上会覆盖您的功能`test`之前创建的函数对象。

如果我们把它写得更明确，它会变得更明显：

```
// in the global scope, `test` gets written to the `global object`
// window.test = new Test(5);
var test = new Test(5);

test.fn(1); // returns 5
test.fn(2); // returns TypeError: 'undefined' is not a function 
```

`bob()`您可以通过使用显式上下文调用来“解决”此问题`.call()`，例如：

```
this.fn = function (n) {
   bob.call(this,n);
   console.log(this.test);
}; 
```

* * *

这里的祸根是， 的值`this`是在运行时动态分配的。不要误会我的意思，它实际上是 ECMAscript 的一个很棒的特性——这只是你的问题。当您调用一个函数时，“ *just like that* ”`this`将始终引用全局对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T20:52:19.307

你想打电话`bob.call(this, n)`，不只是`bob(n)`。

当您调用 时`bob(n)`， 的值`this`不是您的对象，*而是*`window`. 因此，您的`test`变量将替换为`1`.

在 jsFiddle 中，代码被包裹在一个函数中，所以一`window.test`开始并不存在。

# jquery - 为带有 jquery .attr() 的图像添加边距

> ID：12943078
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:45:31.853
> 
> 标签：jquery, css

我正在使用 .attr() 将图像添加到跨度上，并且只想为图像添加上边距。但是当我将 css 添加到 jquery 时，它会移动整个跨度，而不仅仅是图像。我已经纠结了一段时间，但无法弄清楚。

**如何仅将 CSS 添加到前置图像而不是整个跨度？**

这是代码。

```
 $("<img />").prependTo('span.album:contains("Toto")').attr({
        src: '/images/toto.jpg',
        alt: '',
        height: '24',
                    style: 'margin-top:3px;' //this moves the whole span
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:46:23.910

当您更改图像的边距时，它会增加当前行的高度。由于图像和跨度是`display: inline`，因此也会增加跨度上方的间距，因为它们都在同一条线上。考虑浮动图像，以使图像不会增加行高。

# node.js - Heroku bash：节点：找不到命令

> ID：12943079
> 
> 赞同：22
> 
> 时间：2012-10-17T20:45:35.800
> 
> 标签：node.js, heroku, express, mongoose

以前在heroku上启动节点应用程序时有人遇到此错误吗？

```
2012-10-17T20:28:52+00:00 heroku[web.1]: Starting process with command `node app.js`
2012-10-17T20:28:53+00:00 app[web.1]: bash: node: command not found 
```

Heroku 应用程序似乎缺少节点。

该应用程序在本地启动得很好。工头启动和节点 app.js。

```
{
    "name": "app-name",
    "description": "some desc",
    "version": "0.0.1",
    "private": true,
    "engines": {
        "node": "0.8.12",
        "npm":  "1.1.49"
    },
    "dependencies": {
        "express" : "2.5.9",
        "mongoose" : ">=2.6.0",
        "colibri" : "*",
        "jade": ">= 0.0.1"
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-06-14T02:42:29.397

为我解决的问题是在 heroku 设置中添加 heroku/nodejs buildpack。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-05-27T13:44:42.943

老问题，但是，尝试添加一个`engines`部分到您的`package.json`：

```
"engines": {
    "node": ">= 6.9.4",
    "npm": ">= 4.4.0"
  } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-05-10T13:35:15.617

首先，确保您的应用程序使用的是 heroku/nodejs buildpack：

$ heroku buildpacks

1.  heroku/nodejs

如果不是这种情况，则使用以下命令将您的 builpack 更改为 nodejs：

$ heroku buildpacks: 设置 heroku/nodejs

[终端图片](https://i.stack.imgur.com/3TiSF.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-06T18:35:03.493

**tl; dr：**遇到同样的问题，[`heroku restart`](https://devcenter.heroku.com/articles/ps#process-restarts)对我有用。

* * *

**长版：**事情是这样的：

1.  在`heroku logs`我看到：

    ```
    heroku[slugc]: Slug compilation finished  
    heroku[web.1]: Starting process with command `node app.js`  
    app[web.1]: bash: node: command not found  
    heroku[web.1]: Process exited with status 127  
    heroku[router]: at=error code=H20 desc="App boot timeout" method=GET path=/ host=node-network.herokuapp.com fwd=70.28.80.4 dyno= queue= wait= connect= service= status=503 bytes=
    heroku[web.1]: State changed from starting to down 
    ```

2.  所以我跑了`heroku restart`，得到：

    ```
    heroku[web.1]: State changed from down to starting
    heroku[web.1]: Starting process with command `node app.js`
    app[web.1]: Listening on port 30693
    heroku[web.1]: State changed from starting to up 
    ```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-17T21:26:00.990

> Heroku 通过 package.json 的存在将应用程序识别为 Node.js。即使您的应用程序没有依赖项，您仍然应该创建一个 package.json 来声明名称、版本和空依赖项，以便它显示为 Node 应用程序。

[https://devcenter.heroku.com/articles/nodejs](https://devcenter.heroku.com/articles/nodejs)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-12T01:00:11.880

**我的修复是删除 package.json.lock。**我有我的 yarn.lock 和 package.json.lock。

显然，heroku 不喜欢这样。

# python - 将 os.system 的输出打印到屏幕上并根据它采取行动

> ID：12943081
> 
> 赞同：2
> 
> 时间：2012-10-17T20:45:39.853
> 
> 标签：python, io

我有一个 Python 脚本，它使用 os.system 来运行 shell 命令。这些命令的输出会回显到屏幕上；我喜欢这个，需要保留它。我还希望我的脚本能够根据系统调用的输出内容采取行动。我怎样才能做到这一点？

在我的具体情况下，我打电话给`os.system("svn update")`. 我需要将输出显示到屏幕上，并且（例如，在发生冲突的情况下），*用户需要能够与 svn 进行交互*。我希望能够让脚本根据输出采取行动 - 例如，如果它看到构建脚本已更新，则触发构建。

我不想自己处理 I/O（这似乎不必要地复杂），我不想将输出发送到我必须稍后清理的临时文件（尽管如果我必须的话我会这样做）。

编辑：

这是我的测试脚本：

```
#!/usr/bin/python -t

import subprocess

output = subprocess.check_output(["echo","one"])
print "python:", output

output = subprocess.check_output(["echo", "two"], shell=True)
print "python:", output

output = subprocess.check_output("echo three", shell=True)
print "python:", output 
```

这是它的输出：

```
$ ./pytest 
python: one

python: 

python: three 
```

（代码块没有显示的末尾有一个额外的空行。）我希望更像：

```
$ ./pytest 
one
python: one
two
python: 
three
python: three 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:56:20.337

要运行一个进程，我会查看[`subprocess.check_output`](http://docs.python.org/library/subprocess.html#subprocess.check_output). 在这种情况下，类似于：

```
output = subprocess.check_output(['svn','update'])
print output 
```

这仅适用于 python2.7 或更新版本。如果您想要一个适用于旧版本 python 的版本：

```
p = subprocess.Popen(['svn','update'],stdout=subprocess.PIPE)
output,stderr = p.communicate()
print output 
```

# java - Eclipse Maven 存储库差异

> ID：12943083
> 
> 赞同：3
> 
> 时间：2012-10-17T20:45:49.250
> 
> 标签：java, eclipse, jakarta-ee, maven, m2eclipse

我是 Maven 新手，目前正在使用 Eclipse 的 m2e 插件。

**问题一：**

在默认中央存储库（右键单击项目：Maven -> 添加依赖项）中搜索工件（atmosphere-runtime）时，将返回结果列表。

但是，在添加依赖项后，我收到以下错误消息：

```
Missing artifact org.atmosphere:atmosphere-runtime:bundle:1.0.2 
```

如果我在 maven 网站上搜索工件，我可以手动找到并下载 jar（请参见[此处](http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22atmosphere-runtime%22)）。我已经尝试清理/更新/重新加载项目，更新/重新索引/重新构建中央 maven 存储库并重新启动 Eclipse，但似乎没有任何帮助。

我收到此错误是否有原因？

**问题2：**

我正在遵循的教程建议将以下存储库添加到 pom 以下载上述工件：

```
<repositories>
  <repository>
    <id>Sonatype snapshots</id>
    <url>https://oss.sonatype.org/content/repositories/snapshots</url>
  </repository>
  <repository>
    <id>Sonatype releases</id>
    <url>https://oss.sonatype.org/content/repositories/releases</url>
  </repository>
</repositories> 
```

这很有效，如果我在 pom.xml 文件中手动指定依赖项，我就可以下载所需的工件。

但是，如果我尝试使用 eclipse 搜索（右键单击项目：Maven -> 添加依赖项）搜索工件，则不会从两个新存储库返回任何结果。

是否可以在搜索中包含这两个新存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:10:57.000

对于你的第一个问题。Maven 中央只有一个“jar”，但您似乎需要一个捆绑包。因此，您必须将依赖项更改为“jar”，这意味着像这样定义依赖项：

```
<dependency>
    <groupId>org.atmosphere</groupId>
    <artifactId>atmosphere-runtime</artifactId>
    <version>1.0.2</version>
</dependency> 
```

代替：

```
<dependency>
    <groupId>org.atmosphere</groupId>
    <artifactId>atmosphere-runtime</artifactId>
    <version>1.0.2</version>
    <type>bundle</type>
</dependency> 
```

解决第二个问题中问题的最佳方法是使用像 Nexus 这样的存储库管理器并在存储库管理器中定义这两个存储库。[https://oss.sonatype.org/content/repositories/snapshots](https://oss.sonatype.org/content/repositories/snapshots)定义了 Maven Central 中工件的快照，而第二个是定期同步到 Maven Central 的存储库。因此，在我看来，您不需要单独使用这两个存储库。如果您想搜索上述两个存储库的内容，您可以使用以下搜索：[https](https://oss.sonatype.org/) ://oss.sonatype.org/在这里您可以访问也可用于搜索的 Nexus 存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T22:13:39.663

对于您的 2\. 问题。`Project Repositories`在视图中展开`Maven Repositories`并右键单击添加的存储库并检查`Enable Full Index`.

对于您的 1\. 问题。如果未启用，则启用中央存储库的完整索引，然后尝试`Update Index`/ `Rebuild Index`。

# flash - 如果不使用从事件处理程序中删除事件参数有什么好处吗？

> ID：12943087
> 
> 赞同：0
> 
> 时间：2012-10-17T20:46:08.683
> 
> 标签：flash, apache-flex, events, displayobject

如果不使用从事件处理程序中删除事件参数有什么好处吗？我有以下实例：

```
<s:Button rollOver="handleRollOver(event)" rollOut="handleRollOut(event)"/> 
```

以及以下代码：

```
private function handleRollOver(event:Event):void
{
    // doing stuff
}

private function handleRollOut(event:Event):void
{
    // doing stuff
} 
```

如果不使用事件对象，删除它有什么好处吗？例如，将其更改为：

```
<s:Button rollOver="handleRollOver()" rollOut="handleRollOut()"/> 
```

以及以下代码：

```
private function handleRollOver():void
{
    // doing stuff
}

private function handleRollOut():void
{
    // doing stuff
} 
```

我问的原因有几个。一个是我听说事件会在所有显示对象中冒泡，所以如果你能阻止它们可以节省一些 CPU（不确定多少）。但这将涉及调用 event.stopProp() 类型的调用不仅在捕获时间而不是在冒泡时间更正吗？另外，我听说键入事件有助于节省 CPU，所以 event:Event 比 event:MouseEvent 慢。我可以尝试寻找消息来源，但在那之前，也许有人知道我在说什么。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T00:10:58.520

我不相信有任何好处，但也没有坏处。它有效，不会出错。您只是无法访问事件属性。在 MXML 的情况下，请确保您没有传递事件，否则您将收到错误消息。

无论如何，最好的做法是*始终*传递事件，无论您是否需要。它可能更方便，但它会使您的代码在搜索时不太灵活且不易识别。

如果您正在寻找一种在不包含事件的情况下调用事件处理程序的方法，您可以这样做：

```
private function clickHandler(e:MouseEvent = null):void{

} 
```

为 event 参数设置一个默认值 null 可以让您绕过该要求而零问题。此时，我设置的每个事件处理程序都有一个默认值 null，有时还添加了参数，以便我可以在需要时手动调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T05:34:07.443

我认为始终传递事件参数是一种很好的做法，因为您以后可能需要它们 - 例如，如果您决定添加日志记录，或者在调试时等。这是有价值的信息，不应该很容易被丢弃。

无论如何，事件冒泡带来的性能问题通常被夸大了：每次点击鼠标单击事件都会冒泡一次，除非您堆叠了几千个显示对象，否则您的系统不会因此而变得迟缓。当然，还有其他事件发生得更频繁或更迅速，*如果*您发现故障，事件处理应该是首先检查的地方之一。但除非它是一个明显的必要性，否则担心 Event.ENTER_FRAME 以外的任何事情对我来说似乎都是过早的优化。

话虽如此 - 您可以通过手动停止处理程序中的传播来安全地防止任何事件冒泡：

```
private function clickHandler ( ev:Event ) : void {
    ev.stopImmediatePropagation();
} 
```

# ruby-on-rails - RSpec 测试不起作用，但在浏览器中效果很好

> ID：12943090
> 
> 赞同：1
> 
> 时间：2012-10-17T20:46:20.420
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, rspec-rails

我不知道我做错了什么，所以请帮帮我。

所以正如标题所说，在浏览器中一切都很好。所以我想这是我无法正确的规范。

我已经多次重写了我的助手、控制器和规范中的代码。

这是我现在的规格：

```
describe "visit as admin" do
    before do
      sign_in admin
      visit organization_users_path # row 20 of users_controller_spec
    end
    it "should display right page" do
      page.should have_selector('title', text: "Users") 
    end
  end 
```

当我运行它时，我得到：

```
1) Organization::UsersController visit as admin should display right page
     Failure/Error: visit organization_users_path
     NoMethodError:
       undefined method `users' for nil:NilClass
     # ./app/controllers/organization/users_controller.rb:5:in `index'
     # ./spec/controllers/organization/users_controller_spec.rb:20:in `block (3 levels) in <top (required)>' 
```

这是我的控制器和助手：

```
# helper
def current_organization
  @current_organization ||= current_user.organization
end

def admin_user
  unless current_user.admin?
    redirect_to root_path
  end
end

#controller
class Organization::UsersController < ApplicationController
  before_filter :admin_user

  def index
    @users = current_organization.users
  end
end 
```

编辑1：来自`rake routes`：

```
organization_users GET    /organization/users(.:format)          organization/users#index 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:49:05.513

似乎在`index`控制器的功能中：`current_organization`is `nil`。

请确保这个助手返回一个有效的对象：

```
def current_organization
  @current_organization ||= current_user.organization
  raise @current_organization.inspect # <--- use this to inspect this value and delete afterwards
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:50:51.507

该错误告诉您`current_organisation`is nil，这似乎是合乎逻辑的，因为它是通过 current_user 加载的，而 current_user 在您的上下文中是 nil。

您可以查看[https://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara](https://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara)以在测试中记录用户。

但是不要忘记在您的设置中记录一个作为组织的用户，这样 current_organization 助手不会返回 nil

编辑：我猜您正在使用设计进行登录，如果不是这种情况，请告诉我们您使用什么进行身份验证

# asana - 创建任务 - “工作区：不是 ID”错误

> ID：12943091
> 
> 赞同：0
> 
> 时间：2012-10-17T20:46:21.010
> 
> 标签：asana

我正在尝试使用此 JSON 创建任务....

```
{
   "data":{
      "project":[

      ],
      "followers":[

      ],
      "workspace":{
         "id":14852,
         "name":"My Default"
      },
      "name":"This is test task",
      "assignee":{
         "id":14850,
         "name":"Steve Reich"
      }
   }
} 
```

我收到返回错误...

```
{
   "errors":[
      {
         "message":"workspace: Not an ID: [object Object]"
      }
   ]
} 
```

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:14:49.417

（我在 Asana 工作）

当您在 API 中指定对象时，您只需提供它们的 ID，而不是其他元信息。所以它应该是`"workspace": 14852`，而不是你所拥有的。这也适用于受让人。

此外，您目前无法在任务创建期间指定项目 - 您必须通过`addProject`端点发出单独的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T00:08:22.180

响应说您使用的工作区 ID 无效。您实际上并没有使用 14852 作为工作区 ID，是吗？它肯定看起来不像是一个有效的 ID。

您可以通过查询验证您是否拥有正确的工作区 ID

[https://app.asana.com/api/1.0/workspaces](https://app.asana.com/api/1.0/workspaces)

# dll - 手动注册 Excel COM 插件

> ID：12943101
> 
> 赞同：1
> 
> 时间：2012-10-17T20:47:07.487
> 
> 标签：dll, com, wix, registry, atl

我有一个使用 ATL COM 创建的 Excel 插件。通常这个插件是使用自我注册安装的，但我想摆脱它。我创建了一个手动将所有内容添加到注册表的安装程序。到目前为止，自从 Excel 看到插件以来，一切似乎都已加载，但在启动时尝试加载它时总是出现错误。甚至 LoadBehavior 从 3 变为 2。现在我正在使用`RegistryKey`和`RegistryValue`节点添加值，但是当我查看[另一个类似主题的 SO 帖子](https://stackoverflow.com/a/364544/403429)时，我只是没有理解 Rob 提到的 .rgs 脚本没有没有任何代理 clsid 或接口，所以我不确定我需要在那里放置什么。是否有任何在线教程可以帮助我进一步了解 WiX 中的手动注册？

**编辑**

所以我假设代理信息来自.idl 文件而不是.rgs。如果这是真的，我认为我填写了所需的正确信息。但是，Excel 仍然说在运行时加载插件时出错。任何其他信息将不胜感激。

例子：

```
<File Id="AddinDll" Name="addin.dll" Source=".\addin.dll" KeyPath="yes" >
    <TypeLib Id="TYPELIB-ID-HERE" MinorVersion="0" MajorVersion="1" Language="0" Description="addin" HelpDirectory="INSTALLLOCATION" >
        <Class Id="GUID-HERE" Context="InprocServer32" ThreadingModel="apartment" Version="1.0" Programmable="yes" Description="Example" >
            <ProgId Id="Addin.Example.1" Description="Example" >
                 <ProgId Id="Addin.Example" Description="Example" />
            </ProgId>
        </Class>

        <Class Id="PROXY-STUB-CLSID-HERE" Context="InprocServer32" ThreadingModel="both" >
            <Interface Id="INTERFACEID-HERE" Name="IExample" />
        </Class>
    </TypeLib>
</File> 
```

# scala - 好的风格：类型别名与子类化空类/特征

> ID：12943106
> 
> 赞同：10
> 
> 时间：2012-10-17T20:47:26.063
> 
> 标签：scala

在[Twitter Effective Scala - Type Aliases](http://twitter.github.com/effectivescala/#Types%20and%20Generics-Type%20aliases)中，他们说：

> 当别名可以使用时，不要使用子类化。
> 
> ```
> trait SocketFactory extends (SocketAddress => Socket) 
> ```
> 
> SocketFactory 是一个产生 Socket 的函数。使用类型别名
> 
> ```
> type SocketFactory = SocketAddress => Socket 
> ```
> 
> 更好。我们现在可以为 SocketFactory 类型的值提供函数字面量，也可以使用函数组合： val addrToInet: SocketAddress => Long val inetToSocket: Long => Socket
> 
> ```
> val factory: SocketFactory = addrToInet andThen inetToSocket 
> ```
> 
> 请注意，类型别名不是新类型——它们等同于在语法上用别名替换其类型。

我们正在谈论的事情是：

```
trait Base
trait T1 extends Base // subclassing
type T2 = Base        // type alias 
```

显然，当类/特征具有主体或存储信息时，您不能使用类型别名作为替代。

因此，使用类型别名 (T2) 而不是使用特征或类 (T1) 进行扩展具有以下优点：

1.  正如他们上面所说，我们可以使用函数文字进行组合。
2.  我们不会生成 .class 文件，编译器要做的事情会更少（理论上）。

但是，它有以下缺点：

1.  要在同一个命名空间（包）中可用，您需要在包对象中定义类型，该对象可能位于使用站点的另一个文件中。
2.  您不能在 Eclipse 中的别名上跳转 'Open Type' ctrl-shift-T，但您可以在 Eclipse 中打开声明 (F3)。这可能会在未来得到解决。
3.  您不能使用其他语言（例如 Java）的类型别名。
4.  如果类型别名是参数化的，那么擦除会阻止模式匹配以与特征相同的方式工作。

第四点对我来说是最严重的：

```
trait T1[T]
trait T2 extends T1[Any]
type T3 = T1[Any]

class C2 extends T2

val c = new C2
println("" + (c match { case t: T3 => "T3"; case _ => "any" }))
println("" + (c match { case t: T2 => "T2"; case _ => "any"  })) 
```

这会产生：

```
T3
T2 
```

编译器对第一个模式匹配发出警告，这显然不能按预期工作。

所以，最后，这个问题。使用类型别名而不是扩展特征/类还有其他优点或缺点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T21:36:12.123

我认为它们的关键实际上是类型别名和特征*确实不同*。差异列表不胜枚举：

1.  速记语法适用于类型别名（例如`x => x+7`将作为 a 工作`type I2I = Int => Int`）而不是特征。
2.  特征可以携带额外的数据，类型别名不能。
3.  隐式适用于类型别名，但不适用于特征。
4.  特征以类型别名不提供的方式提供类型安全/匹配。
5.  类型别名对在子类中被覆盖有严格的规定；取而代之的是同名特征阴影（任何事情都会发生）。

其中。

这是因为你在这两种情况下做的事情截然不同。类型别名只是一种表达方式，“好吧，当我输入 Foo 时，我实际上是指 Bar。它们是一样的。明白吗？很酷。” 完成此操作后，您可以随时随地替换该名称`Foo`。`Bar`唯一的限制是，一旦你决定了类型是什么，*你就不能改变主意*。

另一方面，Traits 创建了一个全新的界面，它可以扩展 trait 扩展的内容，也可以不扩展。如果不是，它*仍然*是一个标记，表明这是它自己的实体类型，可以进行模式匹配，使用“isInstanceOf”进行测试，等等。

所以，既然我们已经确定它们*确实不同*，问题是如何使用它们。答案很简单：如果你喜欢现有的类，只是不喜欢它的名字，那就使用类型别名。如果您想创建自己的不同于其他事物的新实体，请使用特征（或子类）。前者主要是为了方便，而后者是为了增加类型安全性或功能。我认为没有任何规则说使用一个而不是另一个真正抓住了这一点——了解两者的特性，并在你想要的特性时使用它们。

（然后是存在类型，它提供与泛型类似的功能......但让我们把它留给另一个问题。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T11:19:41.793

They are different in that a type alias defines type equality relationship (ie. T1 <: T2 && T1 >: T2) while trait extension defines a strict sub-type relationship (ie. T1 <: T2 && !(T1 >: T2)). Use them wisely.

# ios - 使用自动布局时，如何调整 CALayer 的锚点？

> ID：12943107
> 
> 赞同：167
> 
> 时间：2012-10-17T20:47:26.423
> 
> 标签：ios, calayer, autolayout

**注意**：自从提出这个问题以来，事情已经发生了变化；有关最近的概述，请参见[此处](http://revealapp.com/blog/constraints-and-transforms.html)。

* * *

在自动布局之前，您可以通过存储框架、设置锚点和恢复框架来更改视图层的锚点而不移动视图。

在自动布局的世界中，我们不再设置框架，但约束似乎无法完成将视图位置调整回我们想要的位置的任务。您可以破解约束来重新定位您的视图，但在旋转或其他调整大小事件时，这些再次变为无效。

以下好主意不起作用，因为它创建了“布局属性（左和宽度）的无效配对”：

```
layerView.layer.anchorPoint = CGPointMake(1.0, 0.5);
// Some other size-related constraints here which all work fine...
[self.view addConstraint:
    [NSLayoutConstraint constraintWithItem:layerView
                                 attribute:NSLayoutAttributeLeft
                                 relatedBy:NSLayoutRelationEqual 
                                    toItem:layerView 
                                 attribute:NSLayoutAttributeWidth 
                                multiplier:0.5 
                                  constant:20.0]]; 
```

我的意图是设置左边缘`layerView`，调整锚点的视图，宽度的一半加上 20（我想要从超级视图左边缘插入的距离）。

是否可以在使用自动布局布局的视图中更改锚点而不更改视图的位置？我是否需要使用硬编码值并在每次旋转时编辑约束？我希望不会。

我需要更改锚点，以便在对视图应用变换时获得正确的视觉效果。

* * *

## 回答 #1

> 赞同：366
> 
> 时间：2012-12-31T20:20:31.553

[编辑：*警告：*随后的整个讨论可能会过时，或者至少会被 iOS 8 大大减轻，这可能不再会在应用视图转换时触发布局的错误。]

## 自动布局与视图变换

自动布局在视图变换中根本无法发挥作用。据我所知，原因是您不应该弄乱具有变换（默认身份变换除外）的视图框架 - 但这正是自动布局所做的。自动布局的工作方式是在`layoutSubviews`运行时冲破所有约束并相应地设置所有视图的框架。

换句话说，约束不是魔术。它们只是一个待办事项清单。`layoutSubviews`是待办事项列表完成的地方。它通过设置框架来实现。

我不禁认为这是一个错误。如果我将此转换应用于视图：

```
v.transform = CGAffineTransformMakeScale(0.5,0.5); 
```

我希望看到视图的中心出现在与以前相同的位置，并且大小只有一半。但根据它的限制，这可能不是我所看到的。

[实际上，这里还有第二个惊喜：对视图应用变换会立即触发布局。在我看来，这似乎是另一个错误。或者也许它是第一个错误的核心。我期望的是至少在布局时间之前能够摆脱变换，例如设备旋转 - 就像我可以在布局时间之前摆脱帧动画一样。但实际上布局时间是即时的，这似乎是错误的。]

## 解决方案 1：无约束

当前的一种解决方案是，如果我要对视图应用半永久性变换（而不仅仅是以某种方式暂时摆动它），则删除影响它的所有约束。不幸的是，这通常会导致视图从屏幕上消失，因为自动布局仍然发生，现在没有约束告诉我们将视图放在哪里。因此，除了删除约束之外，我还将视图设置`translatesAutoresizingMaskIntoConstraints`为“是”。该视图现在以旧方式工作，实际上不受自动布局的影响。（很明显，它*受*自动布局的影响，但是隐式的自动调整掩码约束导致它的行为就像在自动布局之前一样。）

## 解决方案 2：仅使用适当的约束

如果这看起来有点激烈，另一种解决方案是设置约束以与预期的转换一起正常工作。例如，如果一个视图的大小完全由它的内部固定宽度和高度决定，并且完全由它的中心定位，那么我的比例变换将按我的预期工作。在这段代码中，我删除了子视图 ( ) 上的现有约束，`otherView`并用这四个约束替换它们，给它一个固定的宽度和高度，并完全按其中心固定它。之后，我的比例变换工作：

```
NSMutableArray* cons = [NSMutableArray array];
for (NSLayoutConstraint* con in self.view.constraints)
    if (con.firstItem == self.otherView || con.secondItem == self.otherView)
        [cons addObject:con];

[self.view removeConstraints:cons];
[self.otherView removeConstraints:self.otherView.constraints];
[self.view addConstraint:
 [NSLayoutConstraint constraintWithItem:self.otherView attribute:NSLayoutAttributeCenterX relatedBy:0 toItem:self.view attribute:NSLayoutAttributeLeft multiplier:1 constant:self.otherView.center.x]];
[self.view addConstraint:
 [NSLayoutConstraint constraintWithItem:self.otherView attribute:NSLayoutAttributeCenterY relatedBy:0 toItem:self.view attribute:NSLayoutAttributeTop multiplier:1 constant:self.otherView.center.y]];
[self.otherView addConstraint:
 [NSLayoutConstraint constraintWithItem:self.otherView attribute:NSLayoutAttributeWidth relatedBy:0 toItem:nil attribute:0 multiplier:1 constant:self.otherView.bounds.size.width]];
[self.otherView addConstraint:
 [NSLayoutConstraint constraintWithItem:self.otherView attribute:NSLayoutAttributeHeight relatedBy:0 toItem:nil attribute:0 multiplier:1 constant:self.otherView.bounds.size.height]]; 
```

结果是，如果您没有影响视图框架的约束，自动布局将不会触及视图的框架 - 这正是您在涉及转换时所追求的。

## 解决方案 3：使用子视图

上述两种解决方案的问题是我们失去了约束来定位我们的视图的好处。所以这里有一个解决方案。从一个不可见的视图开始，它的工作只是充当主机，并使用约束来定位它。在其中，将真实视图作为子视图。使用约束将子视图定位在主视图中，但将这些约束限制为在我们应用变换时不会反击的约束。

这是一个插图：

![在此处输入图像描述](../Images/7e35db7dcac4fc5b40d100778d7f64aa.png)

白色视图是主机视图；你应该假装它是透明的，因此是不可见的。红色视图是它的子视图，通过将其中心固定到主视图的中心来定位。现在我们可以毫无问题地围绕它的中心缩放和旋转红色视图，并且确实插图表明我们已经这样做了：

```
self.otherView.transform = CGAffineTransformScale(self.otherView.transform, 0.5, 0.5);
self.otherView.transform = CGAffineTransformRotate(self.otherView.transform, M_PI/8.0); 
```

同时，当我们旋转设备时，主机视图的约束使其保持在正确的位置。

## 解决方案 4：改用层变换

代替视图变换，使用层变换，它不会触发布局，因此不会立即与约束发生冲突。

例如，这个简单的“悸动”视图动画可能会在自动布局下中断：

```
[UIView animateWithDuration:0.3 delay:0
                    options:UIViewAnimationOptionAutoreverse
                 animations:^{
    v.transform = CGAffineTransformMakeScale(1.1, 1.1);
} completion:^(BOOL finished) {
    v.transform = CGAffineTransformIdentity;
}]; 
```

即使最终视图的大小没有变化，只是设置它`transform`会导致布局发生，并且约束可以使视图跳来跳去。（这感觉像是一个错误还是什么？）但是如果我们对 Core Animation 做同样的事情（使用 CABasicAnimation 并将动画应用到视图层），布局就不会发生，它工作正常：

```
CABasicAnimation* ba = [CABasicAnimation animationWithKeyPath:@"transform"];
ba.autoreverses = YES;
ba.duration = 0.3;
ba.toValue = [NSValue valueWithCATransform3D:CATransform3DMakeScale(1.1, 1.1, 1)];
[v.layer addAnimation:ba forKey:nil]; 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-01-02T08:52:46.270

我有一个类似的问题，刚刚收到 Apple Autolayout 团队的回复。他们建议使用马特建议的容器视图方法，但他们创建了一个 UIView 的子类来覆盖 layoutSubviews 并在那里应用自定义布局代码 - 它就像一个魅力

头文件看起来像这样，因此您可以直接从 Interface Builder 链接您选择的子视图

```
#import <UIKit/UIKit.h>

@interface BugFixContainerView : UIView
@property(nonatomic,strong) IBOutlet UIImageView *knobImageView;
@end 
```

并且 m 文件应用这样的特殊代码：

```
#import "BugFixContainerView.h"

@implementation BugFixContainerView
- (void)layoutSubviews
{
    static CGPoint fixCenter = {0};
    [super layoutSubviews];
    if (CGPointEqualToPoint(fixCenter, CGPointZero)) {
        fixCenter = [self.knobImageView center];
    } else {
        self.knobImageView.center = fixCenter;
    }
}
@end 
```

如您所见，它在第一次调用时会抓取视图的中心点，并在进一步的调用中重用该位置，以便相应地放置视图。从这个意义上说，这会覆盖自动布局代码，它发生在 [super layoutSubviews] 之后；其中包含自动布局代码。

就像这样，不再需要避免自动布局，但是当默认行为不再合适时，您可以创建自己的自动布局。当然，您可以应用比示例中更复杂的东西，但这就是我所需要的，因为我的应用程序只能使用肖像模式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-10-09T06:08:49.637

我找到了一个简单的方法。它适用于 iOS 8 和 iOS 9。

就像在使用基于框架的布局时调整锚点：

```
let oldFrame = layerView.frame
layerView.layer.anchorPoint = newAnchorPoint
layerView.frame = oldFrame 
```

当您使用自动布局调整视图的锚点时，您会做同样的事情，但以约束方式。当 anchorPoint 从 (0.5, 0.5) 变为 (1, 0.5) 时，layerView 会向左移动一个距离为视图宽度长度的一半，因此需要对此进行补偿。

我不明白问题中的约束。因此，假设您添加了一个相对于 superView centerX 的 centerX 约束，并带有一个常量： layerView.centerX = superView.centerX + constant

```
layerView.layer.anchorPoint = CGPoint(1, 0.5)
let centerXConstraint = .....
centerXConstraint.constant = centerXConstraint.constant + layerView.bounds.size.width/2 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-26T12:37:42.017

如果您使用的是自动布局，那么从长远来看，我看不到手动设置位置将如何发挥作用，因为最终自动布局会破坏您在计算自己的布局时设置的位置值。

相反，需要修改布局约束本身以补偿设置锚点所产生的变化。以下函数对未转换的视图执行此操作。

```
/**
  Set the anchorPoint of view without changing is perceived position.

 @param view view whose anchorPoint we will mutate
 @param anchorPoint new anchorPoint of the view in unit coords (e.g., {0.5,1.0})
 @param xConstraint an NSLayoutConstraint whose constant property adjust's view x.center
 @param yConstraint an NSLayoutConstraint whose constant property adjust's view y.center

  As multiple constraints can contribute to determining a view's center, the user of this
 function must specify which constraint they want modified in order to compensate for the
 modification in anchorPoint
 */
void SetViewAnchorPointMotionlesslyUpdatingConstraints(UIView * view,CGPoint anchorPoint,
                                                       NSLayoutConstraint * xConstraint,
                                                       NSLayoutConstraint * yConstraint)
{
  // assert: old and new anchorPoint are in view's unit coords
  CGPoint const oldAnchorPoint = view.layer.anchorPoint;
  CGPoint const newAnchorPoint = anchorPoint;

  // Calculate anchorPoints in view's absolute coords
  CGPoint const oldPoint = CGPointMake(view.bounds.size.width * oldAnchorPoint.x,
                                 view.bounds.size.height * oldAnchorPoint.y);
  CGPoint const newPoint = CGPointMake(view.bounds.size.width * newAnchorPoint.x,
                                 view.bounds.size.height * newAnchorPoint.y);

  // Calculate the delta between the anchorPoints
  CGPoint const delta = CGPointMake(newPoint.x-oldPoint.x, newPoint.y-oldPoint.y);

  // get the x & y constraints constants which were contributing to the current
  // view's position, and whose constant properties we will tweak to adjust its position
  CGFloat const oldXConstraintConstant = xConstraint.constant;
  CGFloat const oldYConstraintConstant = yConstraint.constant;

  // calculate new values for the x & y constraints, from the delta in anchorPoint
  // when autolayout recalculates the layout from the modified constraints,
  // it will set a new view.center that compensates for the affect of the anchorPoint
  CGFloat const newXConstraintConstant = oldXConstraintConstant + delta.x;
  CGFloat const newYConstraintConstant = oldYConstraintConstant + delta.y;

  view.layer.anchorPoint = newAnchorPoint;
  xConstraint.constant = newXConstraintConstant;
  yConstraint.constant = newYConstraintConstant;
  [view setNeedsLayout];
} 
```

我承认这可能不是你所希望的一切，因为通常你想要修改 anchorPoint 的唯一原因是设置一个变换。这将需要一个更复杂的函数来更新布局约束以反映*所有*可能由变换属性本身引起的帧更改。这很棘手，因为变换可以对帧做很多事情。缩放或旋转变换会使框架变大，因此我们需要更新任何宽度或高度约束等。

如果您只是将变换用于临时动画，那么上面的内容可能就足够了，因为我不相信自动布局会阻止飞行中的动画呈现代表纯粹暂时违反约束的图像。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-31T16:02:26.800

**tl:dr：**您可以为其中一个约束创建一个出口，以便可以将其删除并再次添加回来。

* * *

我创建了一个新项目并在中心添加了一个固定大小的视图。约束如下图所示。

![我能想到的最小示例的约束。](../Images/a503e680caaf23434c9ab643c9e43e17.png)

接下来，我为将要旋转的视图和中心 x 对齐约束添加了一个出口。

```
@property (weak, nonatomic) IBOutlet UIView *rotatingView;
@property (weak, nonatomic) IBOutlet NSLayoutConstraint *xAlignmentContstraint; 
```

稍后`viewDidAppear`我计算新的锚点

```
UIView *view = self.rotatingView;

CGPoint rotationPoint = // The point I'm rotating around... (only X differs)
CGPoint anchorPoint = CGPointMake((rotationPoint.x-CGRectGetMinX(view.frame))/CGRectGetWidth(view.frame),
                                  (rotationPoint.y-CGRectGetMinY(view.frame))/CGRectGetHeight(view.bounds));

CGFloat xCenterDifference = rotationPoint.x-CGRectGetMidX(view.frame);

view.layer.anchorPoint = anchorPoint; 
```

然后我删除我有一个出口的约束，创建一个新的偏移并再次添加它。之后，我告诉具有更改约束的视图它需要更新约束。

```
[self.view removeConstraint:self.xAlignmentContstraint];
self.xAlignmentContstraint = [NSLayoutConstraint constraintWithItem:self.rotatingView
                                                          attribute:NSLayoutAttributeCenterX
                                                          relatedBy:NSLayoutRelationEqual
                                                             toItem:self.view
                                                          attribute:NSLayoutAttributeCenterX
                                                         multiplier:1.0
                                                           constant:xDiff];
[self.view addConstraint:self.xAlignmentContstraint];
[self.view needsUpdateConstraints]; 
```

最后我只是将旋转动画添加到旋转视图中。

```
CABasicAnimation *rotate = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
rotate.toValue = @(-M_PI_2);
rotate.autoreverses = YES;
rotate.repeatCount = INFINITY;
rotate.duration = 1.0;
rotate.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]; 

[view.layer addAnimation:rotate forKey:@"myRotationAnimation"]; 
```

即使在旋转设备或以其他方式导致它更新约束时，旋转层看起来也保持居中（它应该如此）。新约束和更改后的锚点在视觉上相互抵消。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-18T10:14:15.093

我目前的解决方案是手动调整图层在`viewDidLayoutSubviews`. 此代码也可用于`layoutSubviews`视图子类，但在我的情况下，我的视图是视图控制器内的顶级视图，因此这意味着我不必创建 UIView 子类。

似乎付出了太多努力，因此非常欢迎其他答案。

```
-(void)viewDidLayoutSubviews
{
    for (UIView *view in self.view.subviews)
    {
        CGPoint anchorPoint = view.layer.anchorPoint;
        // We're only interested in views with a non-standard anchor point
        if (!CGPointEqualToPoint(CGPointMake(0.5, 0.5),anchorPoint))
        {
            CGFloat xDifference = anchorPoint.x - 0.5;
            CGFloat yDifference = anchorPoint.y - 0.5;
            CGPoint currentPosition = view.layer.position;

            // Use transforms if we can, otherwise manually calculate the frame change
            // Assuming a transform is in use since we are changing the anchor point. 
            if (CATransform3DIsAffine(view.layer.transform))
            {
                CGAffineTransform current = CATransform3DGetAffineTransform(view.layer.transform);
                CGAffineTransform invert = CGAffineTransformInvert(current);
                currentPosition = CGPointApplyAffineTransform(currentPosition, invert);
                currentPosition.x += (view.bounds.size.width * xDifference);
                currentPosition.y += (view.bounds.size.height * yDifference);
                currentPosition = CGPointApplyAffineTransform(currentPosition, current);
            }
            else
            {
                CGFloat transformXRatio = view.bounds.size.width / view.frame.size.width;

                if (xDifference < 0)
                    transformXRatio = 1.0/transformXRatio;

                CGFloat transformYRatio = view.bounds.size.height / view.frame.size.height;
                if (yDifference < 0)
                    transformYRatio = 1.0/transformYRatio;

                currentPosition.x += (view.bounds.size.width * xDifference) * transformXRatio;
                currentPosition.y += (view.bounds.size.height * yDifference) * transformYRatio;
            }
            view.layer.position = currentPosition;
        }

    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-01T14:36:52.490

启发了我的马特回答，我决定尝试一种不同的方法。可以使用适当应用约束的容器视图。然后可以将具有修改锚点的视图放置在容器视图中，使用自动调整大小的掩码和显式框架设置，就像在糟糕的过去一样。

无论如何，这对我来说是一种享受。视图在 viewDidLoad 中设置：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    UIView *redView = [UIView new];
    redView.translatesAutoresizingMaskIntoConstraints = NO;
    redView.backgroundColor = [UIColor redColor];
    [self.view addSubview:redView];

    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"|-[redView]-|" options:0 metrics:nil views:NSDictionaryOfVariableBindings(redView)]];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|-[redView]-|" options:0 metrics:nil views:NSDictionaryOfVariableBindings(redView)]];
    self.redView = redView;

    UIView *greenView = [UIView new];
    greenView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    greenView.layer.anchorPoint = CGPointMake(1.0, 0.5);
    greenView.frame = redView.bounds;
    greenView.backgroundColor = [UIColor greenColor];
    [redView addSubview:greenView];
    self.greenView = greenView;

    CATransform3D perspective = CATransform3DIdentity;
    perspective.m34 = 0.005;
    self.redView.layer.sublayerTransform = perspective;
} 
```

由于绿色视图上的自动调整大小蒙版，此时红色视图的帧为零并不重要。

我在一个动作方法上添加了一个旋转变换，结果如下：

![在此处输入图像描述](../Images/88e3c2e8dcaa22adf154707049f84380.png)

它似乎在设备旋转过程中迷失了自己，所以我将它添加到 viewDidLayoutSubviews 方法中：

```
-(void)viewDidLayoutSubviews
{
    [super viewDidLayoutSubviews];
    [CATransaction begin];
    [CATransaction setDisableActions:YES];
    CATransform3D transform = self.greenView.layer.transform;
    self.greenView.layer.transform = CATransform3DIdentity;
    self.greenView.frame = self.redView.bounds;
    self.greenView.layer.transform = transform;
    [CATransaction commit];

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-19T00:22:38.760

我认为你用这种方法打败了自动布局的目的。您确实提到宽度和右边缘取决于超级视图，那么为什么不沿着该思路添加约束呢？

失去anchorPoint/transform范例并尝试：

```
[self.view addConstraint:
[NSLayoutConstraint constraintWithItem:layerView
                             attribute:NSLayoutAttributeRight
                             relatedBy:NSLayoutRelationEqual 
                                toItem:self.view 
                             attribute:NSLayoutAttributeWidth 
                            multiplier:1.0f
                              constant:-somePadding]];
[self.view addConstraint:
[NSLayoutConstraint constraintWithItem:layerView
                             attribute:NSLayoutAttributeWidth
                             relatedBy:NSLayoutRelationEqual 
                                toItem:someViewWeDependTheWidthOn
                             attribute:NSLayoutAttributeWidth 
                            multiplier:0.5f // because you want it to be half of someViewWeDependTheWidthOn
                              constant:-20.0f]]; // your 20pt offset from the left 
```

`NSLayoutAttributeRight`约束意味着完全一样`anchorPoint = CGPointMake(1.0, 0.5)`，并且约束`NSLayoutAttributeWidth`大致相当于您之前的代码的`NSLayoutAttributeLeft`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-23T09:53:48.030

这个问题和答案启发我用自动布局和缩放来解决我自己的问题，但是用滚动视图。我在 github 上创建了我的解决方案示例：

[https://github.com/hansdesmedt/AutoLayout-scrollview-scale](https://github.com/hansdesmedt/AutoLayout-scrollview-scale)

这是一个 UIScrollView 的示例，它具有完全在 AutoLayout 中制作的自定义分页，并且可以通过长按和点击进行缩放 (CATransform3DMakeScale)。iOS 6 和 7 兼容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-02T11:38:07.450

这是一个很大的话题，我没有阅读所有评论，但面临同样的问题。

我从 XIB 看到了带有自动布局的视图。我想更新它的变换属性。将视图嵌入到容器视图中并不能解决我的问题，因为自动布局在容器视图上表现得很奇怪。这就是为什么我刚刚添加了第二个容器视图来包含包含我的视图并对其应用转换的容器视图。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-09T18:55:31.513

tl; dr 假设您将锚点更改为 (0, 0)。锚点现在位于左上角。**每当您在自动布局中看到center**一词时，您应该想到**top-left**。

当您调整锚点时，您只需更改 AutoLayout 的语义。自动布局不会干扰您的锚点，反之亦然。如果你不明白这一点，***你会过得很糟糕***。

* * *

例子：

图 A.**无锚点修改**

```
#Before changing anchor point to top-left
view.size == superview.size
view.center == superview.center 
```

图 B.**锚点更改为左上角**

```
view.layer.anchorPoint = CGPointMake(0, 0)
view.size == superview.size
view.center == superview.topLeft                <----- L0-0K, center is now top-left 
```

* * *

图 A 和图 B 看起来完全一样。没有改变。只是**中心**所指的定义发生了变化。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-31T21:05:21.120

我有一个相对简单的案例，我需要将锚点设置为`(0, 1)`. 显然，我能够使用容器视图并在其上镜像值（如`(0, 1) -> (1, 0)`）来实现此效果，因此生成的视图与任何普通视图一样`(0.5, 0.5)`

```
let scaledLabel = UILabel()
let container = UIView()

container.addSubview(scaledLabel)

// pin label to the edges of container with autolayout

scaledLabel.layer.anchorPoint = .init(x: 0, y: 1)
container.layer.anchorPoint = .init(x: 1, y: 0) 
```

我不完全确定它如何与其他值一起使用，但它可能仍然有帮助

# java - 避免服务类之间的紧密耦合

> ID：12943116
> 
> 赞同：4
> 
> 时间：2012-10-17T20:47:56.063
> 
> 标签：java, spring, spring-mvc, soa

假设我有 2 个服务类：

```
UserService
ProductService 
```

如果在我的 ProductService 类中注入 UserService 是不是错了？

```
public class ProductserviceImpl implements ProductService {

  @Autowired
  UserService userService;

  @Override
  public void someThing() {
      ..
      userService.otherThing(..);
      ..
  }

} 
```

我知道作为替代方案**，我可以创建另一个注入 UserService 和 ProductService 的类，但是为这个类命名非常棘手：)** 在 SOA 世界中这些类型的类有名称吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T17:21:23.607

1) 如果在我的 ProductService 类中注入 UserService 是不是错了？

这本身并没有什么问题，但需要注意以下几点：

*   请注意，您可能会朝着一个类做太多事情的方向前进（这里是 ProductService）
*   注意不要引入循环依赖（你不应该让UserService也依赖ProductService）
*   通过将依赖项连接到接口而不是具体类来限制紧密耦合（这里你是自动连接 UserService 而不是 UserServiceImpl，这很好）

2) 这种类型的类有名称吗（同时注入 UserService 和 ProductService）？

是的，如前所述，您可以将此类称为调解员，因为[调解员模式](http://en.wikipedia.org/wiki/Mediator_pattern)似乎描述了这一点。

您可以同时拥有低级服务和高级服务，将低级服务（ProductService、UserService）注入高级服务（例如，PurchaseOrderService 或 PurchaseOrderMediator）。或者，对于这种特殊情况，您可能会将产品服务视为依赖于 UserService 的单个高级服务。在这一点上，更多的是关于哪个构造在您的业务逻辑和应用程序的上下文中更具[凝聚力。](http://en.wikipedia.org/wiki/Cohesion_%28computer_science%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:57:07.053

对我来说，将服务注入另一个服务是没有问题的。正如您所说，这就是服务和 SOA 的重点。

服务可以互相帮助，以便给您最终的结果。此外，正如 JB Nizet 所说，如果没有循环依赖关系，则没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T20:53:28.713

您所描述的称为[Mediator Pattern](http://en.wikipedia.org/wiki/Mediator_pattern)。

顺便说一句，什么是 SOA？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-18T08:44:08.643

像您提到的那样使用spring将一个服务注入另一个服务将耦合，这两个服务仅在所使用的接口范围内。

如果您需要更多解耦，请考虑使用消息在 2 个服务之间传递。

消息可以像带有模式的值对象/xml 那样被强类型化，或者像 HashMap 那样被弱类型化

虽然弱类型消息可以增加解耦，但这意味着您和您的客户将失去编译时间检查和调试问题在运行时会很麻烦

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T19:57:42.637

您所描述的是面向对象的集成，很可能不是 SOA 集成。您可能会获得（并且应该避免）循环依赖的事实证明了这一点。

如果您的服务知道其他服务 Java 级别的接口，那么引入紧密耦合的风险也很大。例如，用户服务的返回类型是什么？它是属于用户服务的另一个接口吗？您是否在产品服务代码中传递它？

# java - 内置排列生成器

> ID：12943118
> 
> 赞同：2
> 
> 时间：2012-10-17T20:48:01.837
> 
> 标签：java, built-in

java是否有一个内置的方法来排列或随机打乱一个数字或字符数组？像 C++ 中的 Random Shuffle STL 之类的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:50:07.607

您可以使用[`Collections#shuffle`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)

```
List<Integer> intList = new ArrayList<Integer>();
Collections.shuffle(intList); 
```

如果你有一个数字数组，你可以使用： -

```
Collections.shuffle(Arrays.asList(yourArray)); 
```

# php - 使用 jQuery .each() 将 JSON 从数据库读取到组合框

> ID：12943123
> 
> 赞同：0
> 
> 时间：2012-10-17T20:48:07.283
> 
> 标签：php, jquery, json

我需要能够在选择框中选择一个国家，然后获取该国家的所有州。

我正在尝试做这样的事情：[how-to-display-json-data-in-a-select-box-using-jquery](https://stackoverflow.com/questions/2306522/how-to-display-json-data-in-a-select-box-using-jquery)

这是我的控制器：

```
foreach($this->settings_model->get_state_list() as $state)
{
   echo json_encode(array($state->CODSTA, $state->STANAM));
} 
```

和我的 javascript：

```
 $.ajax({
    url: 'settings/express_locale',
    type: 'POST',
    data: { code: location, type: typeLoc },
    success: function (data) {
        console.log(data);
    }
}); 
```

console.log 向我展示了这样的内容：

```
["71","SomeState0"]["72","SomeState"]["73","SomeState2"]["74","SomeState3"] 
```

所以，我需要将所有状态附加到一个新的选择框中。

但我试图在成功回调中读取这个数组：

```
$.each(data, function(key,val){
   console.log(val);
}); 
```

结果，每一行都是一个单词，如下所示：

```
[
 "
 7
 1
 "
 ,
 "
 s
 ....
 ] 
```

为什么会发生这种情况，我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T20:54:49.973

JSON 不是由独立的块组成的。所以这永远不会：

```
foreach($this->settings_model->get_state_list() as $state)
{
    echo json_encode(array($state->CODSTA, $state->STANAM));
} 
```

输出将被视为*text*，迭代器将循环对象的元素......这是*单个字符*。

您需要声明一个列表或字典。我已经包含了一些示例，具体取决于您在 jQuery 回调中使用数据的方式。注意：PHP 方面，您可能还需要为 JSON 输出正确的 MIME 类型：

```
$states = array();
foreach($this->settings_model->get_state_list() as $state)
{
    // Option 1: { "71": "SomeState0", "72": "Somestate2", ... }
    // Simple dictionary, and the easiest way IMHO
    $states[$state->CODSTA] = $state->STANAM;

    // Option 2: [ [ "71", "SomeState0" ], [ "72", "SomeState2" ], ... ]
    // List of tuples (well, actually 2-lists)
    // $states[] = array($state->CODSTA, $state->STANAM);

    // Option 3: [ { "71": "SomeState0" }, { "72": "SomeState2" }, ... ]
    // List of dictionaries
    // $states[] = array($state->CODSTA => $state->STANAM);
}

Header('Content-Type: application/json');
// "die" to be sure we're not outputting anything afterwards
die(json_encode($states)); 
```

在 jQuery 回调中，您可以*使用 charset 指定数据类型和内容类型*（这将在您遇到像奥兰群岛这样的状态时派上用场，其中服务器以 ISO-8859-15 发送数据并且浏览器运行页面在 UTF8 中可能会导致痛苦的 WTF 时刻）：

```
 $.ajax({
            url: 'settings/express_locale',
            type: 'POST',
            data: { code: location, type: typeLoc },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                $("#comboId").get(0).options.length = 0;
                $("#comboId").get(0).options[0] = new Option("-- State --", "");
                // This expects data in "option 1" format, a dictionary.
                $.each(data, function (codsta, stanam){
                   n = $("#comboId").get(0).options.length;
                   $("#comboId").get(0).options[n] = new Option(codsta, stanam);
             });
           },
           error: function () {
                alert("Something went wrong");
           } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:54:36.853

您是否尝试过使用 $.map() 代替？

[http://api.jquery.com/jQuery.map/](http://api.jquery.com/jQuery.map/)

```
$.map(data, function(index, item) {
console.log(item)
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:56:23.217

您应该使用 GET 而不是 POST，因为您实际上并没有创建任何新的服务器端。阅读一些关于[REST](http://www.ibm.com/developerworks/webservices/library/ws-restful/)以及为什么使用 GET 是这里的专有名词。

**我添加了一个 JSFiddle 示例，您可以立即运行。** [http://jsfiddle.net/KJMae/26/](http://jsfiddle.net/KJMae/26/)

如果这是 PHP 服务返回的 JSON：

```
{
    "success":true,
    "states":[
        {
            "id":71,
            "name":"California"
        },
        {
            "id":72,
            "name":"Oregon"
        }
    ]
} 
```

这是我们的 HTML 代码：

```
<select id="country">
    <option value="">No country selected</option>
    <option value="1">USA</option>
</select>

<select id="states">
</select>​ 
```

这是将其添加到选择的代码可能如下所示：

```
// Bind change function to the select
jQuery(document).ready(function() {
    jQuery("#country").change(onCountryChange);
});

function onCountryChange()
{
    var countryId = jQuery(this).val();    

     $.ajax({
        url: '/echo/json/',
        type: 'get',
        data: {
            countryId: countryId
        },
        success: onStatesRecieveSuccess,
        error: onStatesRecieveError
    });
}

function onStatesRecieveSuccess(data)
{
    // Target select that we add the states to
    var jSelect = jQuery("#states");

    // Clear old states
    jSelect.children().remove();

    // Add new states
    jQuery(data.states).each(function(){        
        jSelect.append('<option value="'+this.id+'">'+this.name+'</option>');
    });
}

function onStatesRecieveError(data)
{
    alert("Could not get states. Select the country again.");
}​ 
```

至于 PHP，这里有一个简单的例子，它应该给出与上面例子中使用的 JSON 相同的结果。（还没有测试过，从我的头顶来看，这里没有 php。）

```
$result = new stdClass;
$result->states = array();

foreach($this->settings_model->get_state_list() as $state)
{
    $stateDto = new stdClass();
    $stateDto->id = $state->CODSTA;
    $stateDto->name = $state->STANAM;

    $result->states[] = $stateDto;
}

$result->success = true;

die(json_encode($result)); 
```

# c++ - SetThreadAffinityMask 用法

> ID：12943124
> 
> 赞同：3
> 
> 时间：2012-10-17T20:48:13.367
> 
> 标签：c++, winapi

我真的很难理解 SetThreadAffinityMask 函数。我试图用 QueryPerformanceCounter 函数实现一个计时器，但我不明白如何获得正确的线程亲和力。msdn上的一个人发布了以下代码示例：

```
void HRTimer::StartTimer(void)
{
    DWORD_PTR oldmask = ::SetThreadAffinityMask(::GetCurrentThread(), 0);
    ::QueryPerformanceCounter(&start);
    ::SetThreadAffinityMask(::GetCurrentThread(), oldmask);
} 
```

但是，当我采用此代码片段时，SetThreadAffinityMask 返回的 oldmask 的值为零。在 MSDN 上，我看到返回值为零意味着发生了错误。我调用了 GetLastError() 并得到了 ERROR_INVALID_PARAMETER 的错误代码。现在我想知道上面的代码片段是否不正确。有人可以解释一下如何正确使用 SetThreadAffinityMask 以便仅在系统上的第一个 CPU 上调用 QueryPerformanceCounter 吗？或者上面的例子是否正确，尽管 SetThreadAffinityMask 返回零？

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T20:52:47.297

掩码是一个位域：每个位指定一个处理器。0 表示“无处理器”。这不是逻辑。

*   0x0001 : 过程 1
*   0x0003 : 过程 1 和 2
*   0x000F : 过程 1, 2, 3, 4
*   ...

用于[SetThreadAffinityMask的 MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686247%28v=vs.85%29.aspx)

# facebook - 发帖需要权限登录对话框才能出现两次

> ID：12943128
> 
> 赞同：4
> 
> 时间：2012-10-17T20:48:33.537
> 
> 标签：facebook, mobile, facebook-login, facebook-authorization

我正在开发一个允许在 facebook 上发布照片的移动相机应用程序。相机应用程序是独立的，启动时不需要 facebook 登录。但是我想允许将图片发布到 Facebook。因此，用户第一次尝试上传图像时，必须通过两次权限登录对话框。

我找不到一种方法来要求用户访问他的基本信息 + 通过一个登录对话框在他的墙上张贴图像。

如果您阅读，这似乎是“设计使然”：http: [//developers.facebook.com/docs/concepts/login/permissions-login-dialog/](http://developers.facebook.com/docs/concepts/login/permissions-login-dialog/)

连续两次传入和传出移动应用程序以允许发布，这是一种糟糕的用户体验。

有没有办法一次性向用户询问基本信息+张贴图片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:27:18.663

@Oriel Bergig Facebook 更新 sdk。（截至 2013 年 3 月 20 日的 v3.0.1。查看 3.0 中的新增功能。）。从此链接下载。

[https://developers.facebook.com/android/](https://developers.facebook.com/android/)

按照链接问题已解决。如果有任何问题 ping 我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T16:18:53.800

执行以下步骤：

1) 转到[https://developers.facebook.com/apps](https://developers.facebook.com/apps) 2) 点击您的应用。3) 单击编辑应用程序 4) 单击高级 5) 检查增强验证对话框：已禁用

而已。您有一个身份验证弹出窗口。

您会看到两个弹出窗口，因为其中一个是应用程序的基本权限弹出窗口，而另一个弹出窗口要求扩展权限，即 publish_stream 代表用户发布照片。有关 facebook 权限的更多信息，请访问：[https ://developers.facebook.com/docs/reference/login/](https://developers.facebook.com/docs/reference/login/)

# c++ - 如何使用 glUniformMatrix4fv 将 4x4 变换矩阵传递和使用到 vShader？

> ID：12943129
> 
> 赞同：0
> 
> 时间：2012-10-17T20:48:38.773
> 
> 标签：c++, opengl

我确信有更好的方法可以让我从四元数计算我的变换矩阵，但这就是我现在所拥有的。我需要将 16 个值传递到着色器中，但遇到了问题。我不断收到类型不兼容错误。另外，一旦我把它放在那里，我必须对它做任何事情来将它乘以我已经拥有的吗？

这是我的显示和着色器

```
void display()
{    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);
if (trackballMove) 
{
   glRotatef(angle, axis[0], axis[1], axis[2]);
}
//colorcube();
glUniform3fv( theta, 1, Theta );

float a = angle;
float b = axis[0];
float c = axis[1];
float d = axis[2];
float xform[16] = {(a*a+b*b-c*c-d*d),(2*b*c-2*a*d),(2*b*d+2*a*c),0.0,
(2*b*c+2*a*d),(a*a-b*b+c*c-d*d),(2*c*d-2*a*b),0.0,
(2*b*d-2*a*c),(2*c*d+2*a*b),(a*a-b*b-c*c+d*d),0.0,
0.0,0.0,0.0,1.0};
        GLuint Transform = glGetUniformLocation( program, "vTransform");
        glUniformMatrix4fv(Transform,  xform);
glDrawArrays( GL_TRIANGLES, 0, NumVertices );
glutSwapBuffers();
} 
```

这是着色器

```
#version 150
in vec4 vPosition;
in vec4 vColor;
out vec4 color;
uniform vec3 theta;
uniform vec4 vTransform;

void main()
{
// Compute the sines and cosines of theta for each of
// the three axes in one computation.
vec3 angles = radians( theta );
vec3 c = cos( angles );
vec3 s = sin( angles );

// Remember: these matrices are column-major
mat4 rx = mat4( 1.0, 0.0, 0.0, 0.0,
0.0, c.x, -s.x, 0.0,
0.0, s.x, c.x, 0.0,
0.0, 0.0, 0.0, 1.0 );
mat4 ry = mat4( c.y, 0.0, s.y, 0.0,
0.0, 1.0, 0.0, 0.0,
-s.y, 0.0, c.y, 0.0,
0.0, 0.0, 0.0, 1.0 );
mat4 rz = mat4( c.z, -s.z, 0.0, 0.0,
s.z, c.z, 0.0, 0.0,
0.0, 0.0, 1.0, 0.0,
0.0, 0.0, 0.0, 1.0 );
color = vColor;

gl_Position = vTransform *(rx * ry * rz * vPosition);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:02:02.793

您的 glUniformMatrix4fv 没有足够数量的参数。函数签名是

```
glUniformMatrix4fv(GLint location, GLsizei count,
    GLboolean transpose, const GLfloat *value); 
```

在此处查看完整的 API 文档： [http ://www.opengl.org/sdk/docs/man4/xhtml/glUniform.xml](http://www.opengl.org/sdk/docs/man4/xhtml/glUniform.xml)

# c# - 编写负载测试工具有哪些策略？

> ID：12943137
> 
> 赞同：2
> 
> 时间：2012-10-17T20:49:02.320
> 
> 标签：c#, multithreading, load-testing

我知道用于负载测试 WCF 服务的工具，所以请不要建议我使用。

如果我想编写一个工具来调用服务（或调用任何操作）每秒 X 次持续 Y 秒，我需要考虑哪些事情？

我最初的方法是在所需的时间间隔触发一个计时器，并在它触发时创建一个任务，但我担心这只会将很多任务排队等待线程池中的线程执行，它们会不在要求的时间调用服务。

创建单独的线程来完成工作会更好吗？然后我会担心创建大量线程。

那么我可以使用哪些策略呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T12:47:21.180

这取决于您的可扩展性目标。每个线程运行一个会话更容易 - 在一个线程上运行一系列同步 I/O 事务的代码要简单得多。如果调整得当，您可以在 Windows 和 Linux 上生成数千个线程。如果您需要扩展得更远，那么您将需要使用异步 I/O API 并设置线程池来为这些 I/O 通道的组提供服务。我建议使线程与 I/O 通道的比率可配置并监视这些池中线程的空闲时间……甚至可能允许池在需要时添加更多线程。

# mysql - mysql group by 一张表中的多行

> ID：12943142
> 
> 赞同：0
> 
> 时间：2012-10-17T20:49:16.530
> 
> 标签：mysql, group-by, pivot

> **可能重复：**
> [mysql将多行转换为单行中的列](https://stackoverflow.com/questions/3121812/mysql-converting-multiple-rows-into-columns-in-a-single-row)

我有一个这样的mysql表：

```
id |  p |  c  |  v
1     p1   10    1
2     p1   20    2
3     p1   30    3
4     p2   40    1
5     p2   50    2
6     p2   60    3 
```

现在我需要运行一个 sql 并得到这样的结果：

```
p  |  as_c1 | as_c2 | as_c3
p1     10       20      30
p2     40       50      60 
```

我使用了这个查询，但这还不够：

```
select 
p, 
c as as_c1,
c as as_c2,
c as as_c3
from test_tbl group by p, c 
```

我到处找，这可能吗？我只需要一些指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:20:28.630

这基本上是`PIVOT`您要执行的操作。不幸的是，MySQL 没有一个`PIVOT`函数。有两种方法可以静态或动态地执行此操作。如果您知道要转换为列的值，则可以使用静态版本，但如果值未知，则可以使用准备好的语句动态生成：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'sum(case when v = ''',
      v,
      ''' then c end) AS as_c',
      v
    )
  ) INTO @sql
FROM table1;

SET @sql = CONCAT('SELECT p, ', @sql, ' 
                    FROM table1 
                    GROUP BY p');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e5456/2)

静态版本将与此类似：

```
select p,
  sum(case when v=1 then c end) as_c1,
  sum(case when v=2 then c end) as_c2,
  sum(case when v=3 then c end) as_c3
from table1
group by p 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e5456/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:58:17.300

```
SELECT p,
  ( CASE WHEN v = 1 THEN c ELSE NULL END ) AS as_c1,
  ( CASE WHEN v = 2 THEN c ELSE NULL END ) AS as_c2,
  ( CASE WHEN v = 3 THEN c ELSE NULL END ) AS as_c3
FROM `test_tbl`
GROUP BY p; 
```

我认为应该这样做。

# shopify - shopify API 中的履行取消调用所需的特定 ID 是什么？

> ID：12943144
> 
> 赞同：0
> 
> 时间：2012-10-17T20:49:28.700
> 
> 标签：shopify

我编写了一个自动化系统，通过 API 从履行中心收到的数据自动履行 shopify 中的项目，但想构建一个工具来“撤消”履行，如果有问题，但我似乎无法获得 API做出回应，并且文档对于需要哪些 id 是模糊的..

我假设第一个 #id 是订单 ID，第二个是项目，但我已经尝试了订单/履行中的所有 ID（订单项 ID、item_id 等），但我仍然收到`{"errors":"Not Found"}`来自 POST CURL 的调用。

我用错了身份证吗？还是有其他原因起作用？

这是我点击的网址：

```
https://{API_KEY}:{API_PASS}@{my_store}.myshopify.com/admin/orders/{order_id}/fulfillments/{some_id?}/cancel.json 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T13:33:59.280

第一个 ID 是订单 ID，在`order_id`履行参数中定义。

第二个 ID 是履行 ID，在`id`履行的参数中定义。

假设您有一个如下所示的履行：

```
"fulfillment": {
    "created_at": "2012-10-16T11:31:17-04:00",
    "id": 255858046,
    "order_id": 450789469,
    "service": "manual",
    "status": "pending",
    "tracking_company": null,
    "tracking_number": "1Z2345",
    "tracking_url": "http://www.google.com/search?q=1Z2345",
    "updated_at": "2012-10-16T11:31:17-04:00",
    "receipt": {
      "testcase": true,
      "authorization": "123456"
    }
} 
```

您的 POST URL 应如下所示：

```
/admin/orders/450789469/fulfillments/255858046/cancel.json 
```

# jquery - 从循环中获取正确的 ID

> ID：12943145
> 
> 赞同：0
> 
> 时间：2012-10-17T20:49:29.217
> 
> 标签：jquery, map

我有一个`foreach`用 PHP 打印数据库中的数据。我得到了每一行的链接，允许我从数据库中删除每个数据。就在`foreach`我得到一个`input type="hidden"`以数据ID为值的下方。

```
<?php
    foreach($sql->query("SELECT * FROM table") AS $row) {
        <input type="hidden" value="'.(int)$row['id'].'">
        echo $row['name'].' (<a href="javascript:void(0)" id="delete-row">delete</a>)';
    }
?> 
```

经过一番激烈的谷歌搜索后，我想出了这个。但是，当我单击“删除”链接时，它会使用此代码打印循环中的每一行。

```
$(document).ready(function() {
    $('#delete-row').click(function() {
        var val = $('input[type="hidden"]').map(function() {
            return this.value;
        }).get();

        alert(val);
    });
}); 
```

这是错误的！我想获得我点击的那个链接的 ID。如果我单击 ID 3 的链接，它会以 ID 3 提醒我。你知道我该如何解决我的问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T20:54:29.467

我什至不会为此使用隐藏字段。

```
<?php
    foreach($sql->query("SELECT * FROM table") AS $row) {
        echo $row['name'].' (<a href="javascript:void(0)" data=". (int)$row['id'] ." class="delete-row">delete</a>)';
    }
?>

$(document).ready(function() {
    $('.delete-row').click(function() {
        var val = $(this).attr('data');    
        alert(val);
    });
}); 
```

# c++ - 为什么这个 Boost Spirit 示例无法编译？

> ID：12943146
> 
> 赞同：0
> 
> 时间：2012-10-17T20:49:29.913
> 
> 标签：c++, boost, compiler-construction, calculator, boost-spirit

我决定学习 Boost Spirit 并开始在[这里](http://www.boost.org/doc/libs/1_51_0/libs/spirit/example/qi/compiler_tutorial/)学习外观。但是，我很失望，因为第一个示例[calc1.cpp](http://www.boost.org/doc/libs/1_51_0/libs/spirit/example/qi/compiler_tutorial/calc1.cpp)没有在我的计算机上编译，它给出了以下错误消息：

```
calc1.cpp: In constructor ‘client::calculator<Iterator>::calculator()’:
calc1.cpp:43:13: error: ‘uint_type’ is not a member of ‘client::qi’
calc1.cpp:43:27: error: expected ‘;’ before ‘uint_’
calc1.cpp:60:17: error: ‘uint_’ was not declared in this scope
calc1.cpp:60:17: note: suggested alternatives:
/usr/include/boost/spirit/home/support/common_terminals.hpp:134:1: note:   ‘boost::spirit::uint_’
/usr/include/boost/spirit/home/support/common_terminals.hpp:134:1: note:   ‘boost::spirit::tag::uint_’
/usr/include/boost/spirit/home/support/common_terminals.hpp:134:1: note:   ‘boost::spirit::uint_’ 
```

我添加了这样的一行，但这不是解决方案：

```
#include <boost/spirit/home/support/common_terminals.hpp> 
```

我该怎么办？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:32:51.563

您正在尝试在 Boost 1.46.1 的安装上使用 Boost 1.51.0 中的示例。

而不是你正在使用的演示，试试这个： http: [//www.boost.org/doc/libs/1_46_1/libs/spirit/example/qi/calc1.cpp](http://www.boost.org/doc/libs/1_46_1/libs/spirit/example/qi/calc1.cpp)

# android - 如何在可访问性打开时禁用通过触摸对 Jelly-Bean 进行探索？

> ID：12943149
> 
> 赞同：3
> 
> 时间：2012-10-17T20:49:45.547
> 
> 标签：android, accessibility, android-4.2-jelly-bean

我为盲人创建了一个可访问的键盘，适用于手指手势。但是现在，借助 Jelly-Bean 的可访问性，Explore By Touch 正在“窃取”所有手势，并且键盘无法正常工作。

有没有办法在 TalkBack 处于活动状态时从键盘禁用通过触摸探索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T15:39:58.453

使用两根手指启用正常手势。您可以使用它转到设置并禁用可访问性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-14T18:10:40.303

如果您使用的是模拟器，则可以通过单击底部项目并按空格来滚动列表。这将允许您浏览各种设置。

要保持 TalkBack 开启，但禁用通过触摸浏览：

1.  打开设置应用程序；
2.  向下滚动并打开辅助功能设置；
3.  选择 TalkBack 项；
4.  按 T​​alkBack 活动底部的设置按钮；
5.  向下滚动到“通过触摸探索”选项并取消选中此选项。

您现在可以说出各种项目，但不能通过触摸进行探索。

# maven - DataNucleus persistence.xml 过滤：在 CLASSPATH 中找不到“persistence.xml”文件

> ID：12943150
> 
> 赞同：1
> 
> 时间：2012-10-17T20:50:00.217
> 
> 标签：maven, filtering, datanucleus, persistence.xml

每当我启用对 persistence.xml 文件的（Maven）过滤时，我都会收到以下错误：

```
SEVERE: DataNucleus Enhancer completed with an error. Please review the enhancer log for full details. Some classes may have been enhanced but some caused errors
No "persistence.xml" files were found in the CLASSPATH yet you specified as input the name ("toto") of a "persistence-unit" to enhance. You must have a valid "persistence.xml" file in the CLASSPATH in a valid location to use this option.
org.datanucleus.enhancer.NucleusEnhanceException: No "persistence.xml" files were found in the CLASSPATH yet you specified as input the name ("toto") of a "persistence-unit" to enhance. You must have a valid "persistence.xml" file in the CLASSPATH in a valid location to use this option.
    at org.datanucleus.enhancer.DataNucleusEnhancer.getFileMetadataForInput(DataNucleusEnhancer.java:785)
    at org.datanucleus.enhancer.DataNucleusEnhancer.enhance(DataNucleusEnhancer.java:525)
    at org.datanucleus.enhancer.DataNucleusEnhancer.main(DataNucleusEnhancer.java:1258) 
```

在我的 pom.xml 我只是使用这个：

```
<resources>
    <resource>
         <filtering>true</filtering>
         <directory>src/main/resources/META-INF/</directory>
    </resource>
</resources> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T17:01:25.523

META-INF/ 应该从配置的目录元素中删除，否则 Maven 在过滤了 persistence.xml 文件后不会将 META-INF 目录带到 classes 文件夹。

# php - 如何从自定义 drupal 模块调用简单的 javascript 文件

> ID：12943152
> 
> 赞同：2
> 
> 时间：2012-10-17T20:50:04.927
> 
> 标签：php, drupal

可鄙的新手在这里试图弄清楚如何将 javascript 与 php 集成。我已经包括

```
<?php
drupal_add_js(drupal_get_path('module', 'mymodule').'/test.js');
?> 
```

在我的自定义“.module”文件的顶部，我已经清楚地将 test.js 包含在同一个模块文件夹中。test.js 很简单：

```
<script>
function test(){
alert("I am an alert box");
}
</script> 
```

而且我已经尝试了一堆带有标签的排列（包括 DOCTYPE、head only、head body 等），但我似乎无法让该死的东西弹出。

关于我在这里可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T06:04:52.407

您可以尝试：-

要在 PHP 代码中添加 javascript 代码，最好使用[drupal_add_js()](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_add_js/7)。

以下代码添加了内联 javascript。

```
drupal_add_js('jQuery(document).ready(function () { alert("Hello!"); });',
array('type' => 'inline', 'scope' => 'footer', 'weight' => 5)
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:57:57.497

如果代码在脚本文件中，那么我认为您不需要脚本标签。当您打印代码时，这些会得到处理。尝试删除它们，然后再次运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-04T00:14:59.460

这是一种将 javascript 代码内嵌到 PHP 模块中的方法。[我在这里](http://flashum.com/?q=drupal_blog#simple-table-of-contents-21)写一下。我还没有找到在这里显示 html 的好方法，所以这里是一个图像。

![在此处输入图像描述](../Images/74d8879a31f269230be9ff8099e69752.png)

# ios - 如何将 JSON 中的图像数据从 WCF 数据服务转换为 iOS 中的 UIImage

> ID：12943157
> 
> 赞同：2
> 
> 时间：2012-10-17T20:50:16.653
> 
> 标签：ios, json, uiimage, wcf-data-services, odata

**如何从 WCF 数据服务返回的 JSON 中获取图像数据？**

我有一个 WCF 数据服务，它为一些对象提供服务，这些对象包括一些二进制数据，这些数据是图像（SQL Server 中的列类型是`image`）。它在 JSON 中表现为文本乱码。在我为此服务编写的 iOS 客户端中，我想将此数据显示为图像 ([ `UIImage imageWitData:myData]`)。

这是我正在做的事情：

```
NSData *networkData = nil; //assume this magically gets data from the service
NSError *err = nil;
//assume the returned JSON has one object and is not an array
NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:networkData
     options:NSJSONReadingAllowFragments error:&err];

//handle error if needed

NSString *imageString = [dict objectForKey:@"Image"];
NSData *imageData = [imageString dataUsingEncoding:NSUTF8StringEncoding];
///The service is using UTF-8.
UIImage *image = [UIImage imageWithData:imageData]; 
```

把它`image`放在 a`UIImageView`中不会显示任何东西。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:07:04.060

事实证明，从 WCF 数据服务返回的二进制数据是 base64 编码的。我正在使用[NSData-Base64](https://github.com/l4u/NSData-Base64)类别来解析它，它工作得很好。所以解决方案如下所示：

```
NSData imageData = [NSData dataFromBase64String:imageString]; 
```

当我将这些文件导入到我的项目中时，ARC 引发了一些错误，但我能够通过删除`autorelease`.m 文件中的几个调用来解决它们。

# junit - 寻找在测试方法中替换许多“when...thenReturn”语句的方法

> ID：12943162
> 
> 赞同：0
> 
> 时间：2012-10-17T20:50:54.473
> 
> 标签：junit, mockito

我正在对主要与[org.apache.poi.hssf.usermodel](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/package-summary.html)中的类（如[HSSFWorkbook](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFWorkbook.html)、[HSSFFont](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFFont.html)和[HSSFCellStyle](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFCellStyle.html)） 进行交互的方法编写[JUnit测试。](http://junit.org/)

该方法最终构建并返回一个`HSSFWorkbook`对象。

为了构建`HSSFWorkbook`对象，调用`workbook.createFont()`和之`workbook.createCellStyle()`类的方法。

`setup`我目前在我的单元测试类中模拟出这样的对象

```
workbook = mock(HSSFWorkbook.class);
font = mock(HSSFFont.class);
cellStyle = mock(HSSFCellStyle.class); 
```

然后，在我的测试方法中，我调用以下内容来避免 NPE

```
when(workbook.createFont()).thenReturn(font);
when(workbook.createCellStyle()).thenReturn(cellStyle); 
```

我发现我必须做更多的事情才能避免 NPE，我想知道是否有一种方法可以避免编写所有这些“when...thenReturn”语句。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:14:03.353

Mocking 的规则之一是：永远不要模拟你不拥有的类型。另一条规则是对模拟的存根调用，不应返回另一个模拟。

原因就在你面前:)。

如果您的课程**只**处理创建`HSSFWorkbook`，那么将测试视为集成测试并使用真正的库。如果您的班级也做了其他事情，那么将所有*其他*内容移至其他班级（这是为了遵循[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)）

# c++ - 替换 gluPerspective（使用 glFrustrum）

> ID：12943164
> 
> 赞同：13
> 
> 时间：2012-10-17T20:51:05.020
> 
> 标签：c++, opengl

如何将 gluPerspective 函数转换为 glFrustum？我尝试使用这个等式，但没有任何运气，因为它没有生成与 gluPerspective 相同的图像。

> 顶部 = tan(fov*3.14159/360.0) * 接近底部 = -top
> 
> 左 = 方面 * 右下 = 方面 * 上

我似乎无法正确转换我的视野。例如，如果我的 FOV 是 45，那么 Frustum 调用中的“顶部”参数是什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-17T21:11:51.590

我们开始 - 您可以使用以下方法代替`gluPerspective`：

```
void perspectiveGL( GLdouble fovY, GLdouble aspect, GLdouble zNear, GLdouble zFar )
{
    const GLdouble pi = 3.1415926535897932384626433832795;
    GLdouble fW, fH;

    //fH = tan( (fovY / 2) / 180 * pi ) * zNear;
    fH = tan( fovY / 360 * pi ) * zNear;
    fW = fH * aspect;

    glFrustum( -fW, fW, -fH, fH, zNear, zFar );
} 
```

[您可以在nehe](http://nehe.gamedev.net/article/replacement_for_gluperspective/21002/)页面上找到更多代码说明。

# expressionengine - 表达式引擎：如何显示条目的类别名称？

> ID：12943165
> 
> 赞同：2
> 
> 时间：2012-10-17T20:51:04.093
> 
> 标签：expressionengine

我正在使用 SafeCracker 在网站上创建一些条目，当提交表单时，它会出现在预览模板中。

我需要能够显示条目的选定类别。

我正在使用以下代码在预览模板中显示结果：

```
{exp:safecracker channel="jobs" id="contact" return="jobs/preview/ENTRY_ID" entry_id="{segment_3}"}

<p>Job Type: {job_type}<br />
  Category: {exp:channel:category_heading}{category_name}{/exp:channel:category_heading}<br />  
  Location: {job_location}</p>
  <p>Description:<br />
  {job_description}
  </p>
  <p>Apply by: {how_to_apply} at: {apply_value}</p>
  <p>Company: {company}</p>
  <p>Description: <br />
  {company_description}</p>
{/exp:safecracker} 
```

事实上，Category: 值是空白的。这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T12:32:06.020

用途：`{categories}{if selected}{category_name}{/if}{/categories}`。

如果做不到这一点，您可以使用查询模块：

```
{exp:query sql="
    SELECT c.cat_name
    FROM exp_categories c, exp_category_posts cp
    WHERE cp.entry_id = {segment_3}
    AND c.cat_id = cp.cat_id
" backspace="2"}{cat_name}, {/exp:query} 
```

# php - AJAX 表和插入

> ID：12943166
> 
> 赞同：0
> 
> 时间：2012-10-17T20:51:06.297
> 
> 标签：php, javascript, ajax, calendar

我创建了一个类似“日历”的表格，它通过位于 .PHP 文件中的列表更新其内容。它工作正常，但我希望能够更好地设计它。我想让当前出现在表格下“contentContainer”中的文本出现在它所属的单元格中。到目前为止，如果我将 div 移动到 $calender 中，它只会加载到第一个单元格中。

我还希望该行在 7 列处中断。

```
<script type="text/javascript">
        var request;
        showEvents = function(caller){
            request = new XMLHttpRequest();
            request.open("GET", "getevents.php?id="+caller.id, true);
            request.onreadystatechange = updatePage(caller.id);
            request.send(null);
        };
        function updatePage(elemId){
            if(request.readyState == 4){
                var data = request.responseText;
                document.getElementById(elemId).innerHTML="<span>"+data+"</span>"
            }
        }
    </script>

<style>
table {
    width: 700px;
}
td {
    border: 1px solid;
    min-width: 100px;
    height: 100px;
    vertical-align: text-top;
    text-align: right;
    box-sizing:border-box;
    padding: 5px;
}
</style>       
</head><body>
<table border="0" cellspacing="0" cellpadding="0">
    <tr>
        <th colspan="31" scope="col">Calender</th>
    </tr>
    <tr>
    <?php
        $calendar="";
        for($i=1;$i<=31;$i++){
            $calendar .= "<td id='".$i."' onclick='showEvents(this)'><a href='#' id='".$i."'>".$i."</a> </td>";
        if (($i % 7) == 0) $calendar .= '</tr><tr>';
        }
        echo $calendar;
    ?>
    </tr>
</table>
<div id="contentContainer"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:09:44.493

为了获得您正在寻找的 7 天，我会将其放入 for 循环中：

```
if (($i % 7) == 0) $calendar .= '</tr><tr>'; 
```

至于您的事件在表中弹出的位置，请确保将单元格的 id 从传递`showEvents`到`updatePage`：

```
request.onreadystatechange = updatePage(caller.id);
…
function updatePage(elemId){
…
document.getElementById(elemId).innerHTML="<span>"+data+"</span>" 
```

那应该能让你到达那里。为了使这更加完整，我将利用 PHP 日期/时间函数将每个日期正确设置在日历上的正确位置。

*更新：*

我已经做了一些工作，这就是我所拥有的。出于某种原因，我不知道，javascript 不喜欢将这两个函数分开。这是固定的，我还添加了一周中的一天间隔。结果如下：

```
<script type="text/javascript">
    var showEvents = function(caller){
        request = new XMLHttpRequest();
        request.open("GET", "getevents.php?id="+caller.id, true);
        request.onreadystatechange = function () {
            if(request.readyState == 4){
                var data = request.responseText;
                document.getElementById(caller.id).innerHTML="<span>"+data+"</span>"
            }
        }
        request.send();
    };
</script>
<style>
table {
    width: 700px;
    border-collapse: collapse;
}
td {
    border: 1px solid;
    min-width: 100px;
    height: 100px;
    vertical-align: text-top;
    text-align: right;
    box-sizing:border-box;
    padding: 5px;
}
</style>       
</head><body>
<table>
    <tr>
        <th colspan="7">Calendar</th>
    </tr>
    <tr>
    <?php
        $calendar="";
        $n = 0;
        $month = strtotime("2012-10-01"); // Always the first of the month
        $start = date('N', $month);
        $days = date('t',$month);
        for($i=1;$i<=$days;$i++){
            $n++;
            if ($n <= $start) { // '<=': week starts on Sunday; '<': week starts on Monday
                $calendar .= "<td>&nbsp;</td>";
                $i--;
            } else {
                 $calendar .= "<td id='{$i}' onclick='showEvents(this); return false;'><a href='#' id='{$i}'>{$i}</a></td>";
            }
            if (($n % 7) == 0) $calendar .= '</tr><tr>';
        }
        echo $calendar;
    ?>
    </tr>
</table>
<div id="contentContainer"></div>
</body>
</html> 
```

# ruby-on-rails - 有没有办法用 Savon::Model 设置默认命名空间？

> ID：12943173
> 
> 赞同：1
> 
> 时间：2012-10-17T20:51:34.763
> 
> 标签：ruby-on-rails, soap, savon

Savon 固执地从 WSDL 生成 SOAP 信封。它做得不正确，我看不出有什么办法解决它。`wsdl:`无论出于何种原因，它还可以随意在所有内容上插入名称空间。

我正在构建的请求使用`tns:`命名空间。我希望能够使用 Savon::Model，但现在我必须这样做：

```
client.request :tns, :function_name do
  soap.body = { params }
end 
```

而不是类似的东西：

```
super(params) 
```

在每个函数中创建请求块很乏味，我必须每次都定义函数名称，而不是像理想情况下那样自动调用正确的函数。现在我的功能看起来像

```
def foo
  client.request :tns, :foo do
  ...
end 
```

不得不说两次“foo”似乎很荒谬。有没有办法为扩展 Savon::Model 的类中的每个请求设置默认命名空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-09T01:30:04.280

```
client = Savon.client do
  wsdl "blah blah"
  element_form_default :qualified
  namespace_identifier :tem
  env_namespace :soapenv
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:38:03.683

我不确定我是否理解你的问题。我假设您正在询问如何设置默认命名空间并将请求正文包装在一个函数中，因此您不需要每次都编写请求正文。这段代码对我有用，但我删除了一些不相关的部分

```
class ExampleWS
  EXAMPLE_WS_DEFAULT_NAMESPACE = "urn:example:request:1.0.0"
  ......
  def getStockPrice( locale, stockId )
    response = $client.request :get_stock_price do
    soap.input = [
      "ns1:getStockPrice",
      {
        "xmlns:ns1" => EXAMPLE_WS_DEFAULT_NAMESPACE #set default namespace here
      }
    ]
    soap.body = {
      "locale" => locale,
      "stockId" => stockId
    }
    end
  end
  ......
end
......
# call the function
getStockPrice("en_US", 123 ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T11:55:45.373

这对我有用。但它使用 Savon 2：

```
class Soapservice
  extend Savon::Model

  client wsdl: "http://example.com?wsdl", env_namespace: :tns, 

  operations :get_resource, :put_resource

  def :get_resource(id)
    super(message: { id: id })
  end
end

service = Soapservice.new
response = service.get_resource(1) #overwriting get_resource
# or
response = service.put_resource(message: { username: "luke", secret: "secret" }) 
```

（我的示例建立在官方[savon 主页](http://savonrb.com/version2.html#model)的示例之上）

# php - 页面未转换为 xml 格式

> ID：12943178
> 
> 赞同：0
> 
> 时间：2012-10-17T20:52:01.497
> 
> 标签：php, xml, curl

我正在抓取一个页面，然后将其转换为 xml 格式，我使用的函数如下

```
public function getXML($url){
   $ch = curl_init();
   //curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
   //curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
   curl_setopt($ch, CURLOPT_URL,$url);
   curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
   $response = curl_exec($ch);      
   $xml = simplexml_load_string($response);
   return $xml;
}

print_r($curl->getXML("http://www.amazon.co.uk/gp/offer-listing/0292783760/ref=tmm_pap_new_olp_sr?ie=UTF8&condition=used")); 
```

尝试不同的 url 后没有返回任何内容，页面加载正常，所以问题出在行`$xml = simplexml_load_string($response);`

这段代码可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:11:33.440

不完全了解您在做什么，看起来您正在尝试抓取亚马逊网页？如果我在浏览器中提取该 URL，它不会在标题或文档本身中列为 XHTML——我怀疑它不是。我不认为 simplexml 可以处理这个问题。

（CURL 会为您转换为 XML 吗？我不这么认为，但我不是所有 CURL 的大师。如果是这样，可能是 CURL 的输出与 simplxml 之间的不兼容 - 这是相当有限的 - - 将接受）。

您可以尝试使用 DOMDocument，尽管我的 PHP 可能有点过时——这些天可能有更好的实用程序。

[一个快速的谷歌搜索带来了这个教程](http://drewish.com/content/2007/08/using_simplexml_with_html)

```
<?php
  $doc = new DOMDocument();
  $doc->strictErrorChecking = FALSE;
  $doc->loadHTML($html);
  $xml = simplexml_import_dom($doc);
?> 
```

我认为这不是一个完整的答案，但评论有点多；所以带着一粒盐和一份健康的怀疑来对待它。我希望它能激发一些想法。

# google-apps-script - 查询变量数组

> ID：12943181
> 
> 赞同：1
> 
> 时间：2012-10-17T20:52:14.517
> 
> 标签：google-apps-script

如何使用数组变量而不是文字数组本身作为查询参数？

例如，文档提到以下内容：

```
var result = db.query({name: db.anyOf(['fred', 'barney', 'mark']}); 
```

但相反，我希望这样做：

```
var myTeam = ["fred","barney","mark"];
var result = db.query({name: db.anyOf(myTeam)}); 
```

到目前为止，我还没有成功。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:00:50.057

没有什么。您的代码对我来说很好（除了缺少括号错字）。

```
function scriptdbTest() {
  var db = ScriptDb.getMyDb();
  db.save({name:'fred', age:40}); //just to get one result on my test script

  var myTeam = ["fred","barney","mark"];
  var result = db.query({name: db.anyOf(myTeam)});
  while( result.hasNext() )
    Logger.log(result.next().toJson());
} 
```

# javascript - 将插入符号放在 ContentEditable 中插入的标记之外

> ID：12943182
> 
> 赞同：4
> 
> 时间：2012-10-17T20:52:16.547
> 
> 标签：javascript, html, contenteditable

我正在使用该`document.execCommand` `insertHTML`方法将 span 标签插入到 contentEditable div 中。

插入后，我希望将插入符号设置在输入的末尾，以便任何进一步的输入都在最后插入的 span 标签之外。至少在 Chrome 中，默认行为是在标签本身中放置更多输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-24T23:48:13.687

在我尝试这个之前，我也一直坚持这一点。将 a`&nbsp;`放在插入的末尾，如

```
document.execCommand('insertHTML', false, '<span>&nbsp;</span>&nbsp;'); 
```

仅在 HTML 末尾放置一个空格是行不通的，因为我发现它总是被修剪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T22:26:31.487

我想出的可怕技巧是在之后立即插入另一个 span 元素：

```
document.execCommand('insertHTML', false, '<span>&nbsp;</span>'); 
```

现在新内容进入了这个 span 元素。希望有更好的解决方案。

# ios - iCloud 不会在第一次启动时同步

> ID：12943188
> 
> 赞同：1
> 
> 时间：2012-10-17T20:52:47.513
> 
> 标签：ios, synchronization, load, sync, icloud

我有一个错误，我的应用程序不会在第一次启动时提取 icloud 信息，但在随后的尝试中会这样做。这是我从 icloud 加载文件的代码。

> 无效 DLC::loadFromiCloud(std::string fileName){
> 
> > NSURL *mUbiqUrl = [[NSFileManager defaultManager] URLForUbiquityContainerIdentifier:nil];
> > 
> > 如果（mUbiqUrl）{
> > 
> > > ```
> > > std::string fullPath = getLibraryPath_iOS() + fileName;
> > > 
> > > NSString* restorePath = [NSString stringWithUTF8String:(fullPath.c_str())];
> > >     NSError *error = nil;
> > >     NSURL *fileToDownload = [mUbiqUrl URLByAppendingPathComponent:[NSString stringWithUTF8String:(fileName.c_str())]];
> > >     [[NSFileManager defaultManager] startDownloadingUbiquitousItemAtURL:fileToDownload 
> > >                                                 error:&error];
> > >     if (error != nil)
> > >     {
> > >         NSLog(@"iCloud L2 error: %@", [error localizedDescription]);
> > >     }
> > >     else 
> > >     {
> > >         NSNumber*  isIniCloud = nil;
> > >         if ([fileToDownload getResourceValue:&isIniCloud forKey:NSURLIsUbiquitousItemKey error:nil])
> > >         {
> > >             // If the item is in iCloud, see if it is downloaded.
> > >             if ([isIniCloud boolValue]) 
> > >             {
> > >                 NSNumber*  isDownloaded = nil;
> > >                 if ([fileToDownload getResourceValue:&isDownloaded forKey:NSURLUbiquitousItemIsDownloadedKey error:nil]) 
> > >                 {
> > >                     if ([isDownloaded boolValue])
> > >                     {
> > >                         NSString *fileData = [NSString stringWithContentsOfURL:fileToDownload encoding:NSUTF8StringEncoding error:&error];
> > >                         //NSLog(@"iCloud data: %@", fileData);
> > >                         [fileData writeToFile:restorePath atomically:YES encoding:NSUTF8StringEncoding error:&error];
> > >                         if (error)
> > >                         {
> > >                             NSLog(@"iCloud L3 error: %@", [error localizedDescription]);
> > >                         }
> > >                     }
> > >                 }
> > >             }
> > >         }
> > >     }
> > > }} 
> > > ```

# list - 返回仅在一个列表中出现的元素列表 - SML

> ID：12943189
> 
> 赞同：1
> 
> 时间：2012-10-17T20:52:52.360
> 
> 标签：list, sml

如果 L1 = [1,2,3,4,5] 和 L2 [4,5,6,7,8]，我想返回 [1,2,3,5,7,8] 这是发生的元素仅在一个列表中。我已经编写了一个函数，返回两个列表中出现的项目列表。

```
fun exists x nil = false | exists x (h::t) = (x = h) orelse (exists x t);

fun listAnd _ [] = []
  | listAnd [] _ = []
  | listAnd (x::xs) ys = if exists x ys  then x::(listAnd xs ys) 
else listAnd xs ys 
```

我要查找的列表应该由 L1@L2 - (ListAnd L1 L2) 给出。我还发现了删除元素和删除重复项的函数。我多次尝试稍微更改 remDup 函数，以便它不会留下任何多次​​出现的任何项目的痕迹。无法让它工作。我不确定如何使用和组合所有这些功能以使其工作。

```
fun delete A nil = nil
| delete A (B::R) = if (A=B) then (delete A R) else (B::(delete A R));

fun remDups nil = nil
| remDups (A::R) = (A::(remDups (delete A R))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:59:52.490

如果有一个`diff`函数返回 in而不是 in 的`diff xs ys`所有元素，则可以轻松实现该函数：`xs``ys``listOr`

```
fun listOr xs ys = diff (xs@ys) (listAnd xs ys) 
```

该`diff`函数可以类似地写成`listAnd`：

```
fun diff xs [] = xs
  | diff [] _ = []
  | diff (x::xs) ys = if exists x ys  
                      then diff xs ys 
                      else x::(diff xs ys) 
```

# java - 在编译项目：“系统找不到指定的文件”

> ID：12943190
> 
> 赞同：0
> 
> 时间：2012-10-17T20:52:52.797
> 
> 标签：java, compiler-errors, jcreator

在编译时，我朋友的 JCreator 只是说

“该系统找不到指定的文件”

# android - 遍历Fragment回栈时如何刷新ActionBar导航项？

> ID：12943194
> 
> 赞同：6
> 
> 时间：2012-10-17T20:53:22.053
> 
> 标签：android, android-fragments, android-actionbar

Android 4.1`ActionBar`提供了有用的导航模式作为列表或选项卡。我正在使用 a`SpinnerAdapter`从三个片段中进行选择以显示在视图中`android.R.id.content`。然后`onNavigationItemSelected()`监听器将每个片段膨胀到视图中，并使用`FragmentTransaction.addToBackStack(null)`.

这一切都像宣传的那样工作，但我不知道如何更新`ActionBar`以反映当前的后台堆栈。使用`ActionBar.setSelectedNavigationItem(position)`作品但也会触发一个新的`OnNavigationListener()`，这也会创造另一个`FragmentTransaction`（不是我想要的效果）。代码如下所示以进行说明。任何有关解决方案的帮助表示赞赏。

* * *

```
public class CalcActivity extends Activity {
private String[] mTag = {"calc", "timer", "usage"};
private ActionBar actionBar;

/** An array of strings to populate dropdown list */
String[] actions = new String[] {
    "Calculator",
    "Timer",
    "Usage"
};

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    this.actionBar = getActionBar();

    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    // may not have room for Title in actionbar
    actionBar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);

    actionBar.setListNavigationCallbacks(
    // Specify a SpinnerAdapter to populate the dropdown list.
    new ArrayAdapter<String>(
        actionBar.getThemedContext(),
        android.R.layout.simple_list_item_1,
        android.R.id.text1,
        actions),
    // Provide a listener to be called when an item is selected.
    new NavigationListener()
    );      
}

public class NavigationListener implements ActionBar.OnNavigationListener {
    private Fragment mFragment;
    private int firstTime = 0;

    public boolean onNavigationItemSelected(int itemPos, long itemId) {
        mFragment = getFragmentManager().findFragmentByTag(mTag[itemPos]);

        if (mFragment == null) {
            switch (itemPos) {
            case 0:
                mFragment = new CalcFragment();
                break;
            case 1:
                mFragment = new TimerFragment();
                break;
            case 2:
                mFragment = new UsageFragment();
                break;
            default:
                return false;
            }               
            mFragment.setRetainInstance(true);
        }

        FragmentTransaction ft = getFragmentManager().beginTransaction();
        if (firstTime == 0) {
            firstTime++;
            ft.add(android.R.id.content, mFragment, mTag[itemPos]);
        } else {
            ft.replace(android.R.id.content, mFragment, mTag[itemPos]);
            ft.addToBackStack(null);
        }
        ft.commit();

        Toast.makeText(getBaseContext(), "You selected : " + 
                actions[itemPos], Toast.LENGTH_SHORT).show();

        return true;
    }       
}

public static class CalcFragment extends Fragment {             
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.fragment_calc, container, false);
    return v;
    }   
}

public static class TimerFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.fragment_timer, container, false);
    return v;
    }   
}

public static class UsageFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.fragment_usage, container, false);
    return v;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T23:13:48.330

你可以这样做：

1.  当您基于后退按钮选择导航项时，创建一个布尔值来跟踪：

    ```
    private boolean mListIsNavigatingBack = false; 
    ```

2.  覆盖onBackPressed，在覆盖中，检查backstack是否有item，如果有自己处理，如果没有调用超类：

    ```
    public void onBackPressed() {
        if(getFragmentManager().getBackStackEntryCount() > 0){
            mListIsNavigatingBack = true;

            //You need to get the previous index in the backstack through some means
            //possibly by storing it in a stack
            int previousNavigationItem = ???;

            getActionBar().setSelectedNavigationItem(previousNavigationItem);
        }
        else{
            super.onBackPressed();
        }
    } 
    ```

3.  在 NavigationListener 内部，处理`mListIsNavigatingBack`状态，手动弹出回栈并取消设置状态：

    ```
    if(mListIsNavigatingBack){
        if(fm.getBackStackEntryCount() > 0){
            fm.popBackStack();
        }
        mListIsNavigatingBack = false;
    } 
    ```

# sql - 查询帮助需要 sql 排序

> ID：12943196
> 
> 赞同：1
> 
> 时间：2012-10-17T20:53:26.130
> 
> 标签：sql, oracle10g

我有一张带有 roll_no 和 No_of_items 的表（两者都不是主要的）

是否可以按以下方式对它们进行排序：第一个条目具有最高的项目数，然后属于该 roll_no 的所有条目出现，然后来自具有最高项目数的 diff roll_no 的下一个条目，然后是所有属于该客户的条目等

例如。

```
Column 1 Column 2
A          12
A          05
C          19
C          18
C          02 
B          05 
```

应显示为：

```
C 19
C 18
C 02
A 12
A 05
B 05 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:00:38.583

试试这个。

```
select t1.*
from yourtable t1
    inner join 
    (
        select 
            client_id, max(numberofdays) cnt 
        from yourtable 
        group by client_id
    ) t2
        on t1.client_id = t2.client_id
order by cnt desc, client_id, numberofdays desc; 
```

这也可能有效，取决于 SQL 风格

```
select *
from yourtable
order by 
    max(numberofdays) over (partition by client_id) desc, 
    client_id, 
    numberofdays desc; 
```

编辑：添加 client_id 以保持具有相同编号的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:03:09.743

您将在 sql 查询中使用的是“order by”，您的代码使用 MySql 将如下所示

```
<?php
$query = mysql_query("select `client_id`, `No_of_Days` FROM `tablename` order by `No_of_Days` DESC ");
while($row = mysql_fetch_object($query))
{
     echo $row->client_id." ".$row->No_of_Days;
}
?> 
```

查询是这里的主要工作

# javascript - 应用程序需要刷新才能初始化

> ID：12943197
> 
> 赞同：3
> 
> 时间：2012-10-17T20:53:27.297
> 
> 标签：javascript, dojo, gis, arcgis-server

在 Javascript/Dojo 中创建 Web 地图应用程序：

当我在浏览器中加载应用程序时，它会加载 html 元素但随后停止处理。我必须刷新浏览器才能加载页面的其余部分和 javascript。

我做了一整天的测试和调试，发现我的外部 JS 文件放错了位置（我是菜鸟）。修复了这个问题，应用程序加载得很好......除了我的一个文件没有被正确读取，或者根本没有被读取。

当我将有问题的外部 JS 文件的内容移动到默认的主代码时，它们包含的功能可以正常工作......但是地图需要再次刷新。

难住了。下面是导致我的问题的外部 JS 文件中的代码。我无法弄清楚为什么这是一个问题，因为当它不是外部的时，这些功能会按预期工作。

任何帮助是极大的赞赏。

```
//Toggles
function basemapToggle() {
                basemaptoggler = new dojo.fx.Toggler({
                    node: "basemaptoggle",
                    showFunc : dojo.fx.wipeIn,
                    showDuration: 1000,
                    hideDuration: 1000,
                    hideFunc : dojo.fx.wipeOut
                })
            }
            dojo.addOnLoad(basemapToggle);

            function layerToggle() {
                layertoggler = new dojo.fx.Toggler({
                    node: "layertoggle",
                    showFunc : dojo.fx.wipeIn,
                    showDuration: 750,
                    hideDuration: 750,
                    hideFunc : dojo.fx.wipeOut
                })
            }
            dojo.addOnLoad(layerToggle);

            function legendToggle() {
                legendtoggler = new dojo.fx.Toggler({
                    node: "legendtoggle",
                    showFunc : dojo.fx.wipeIn,
                    hideFunc : dojo.fx.wipeOut
                })
            }
            dojo.addOnLoad(legendToggle); 
```

**编辑**

编辑显示附加代码。真的被这件事难住了。很想得到一些反馈。我已经尝试将它移动到主文件，重新格式化函数并且所有这些东西都可以工作，除了它们需要刷新。我也丢失了一些关于刷新的信息。非常奇怪的行为。有什么好的方法来追踪这个吗？

```
 <!DOCTYPE HTML> 
   <html>  
  <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=7, IE=8, IE=9" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>

        <link rel="Stylesheet" href="ZoningClassifications.css" />
    <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.0/js/dojo/dijit/themes/claro/claro.css">
        <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.0/js/esri/dijit/css/Popup.css">
        <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.0/js/dojo/dojox/grid/resources/Grid.css">
    <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.0/js/dojo/dojox/grid/resources/claroGrid.css">
    <style type="text/css"> 
    </style> 

        <script src="JS/layers.js"></script>
        <script src="JS/search.js"></script>
        <script src="JS/basemapgallery.js"></script>
        <script src="JS/toggles.js"></script>
        <script src="JS/identify.js"></script>
        <script type="text/javascript"> 
      var djConfig = {
        parseOnLoad: true
      };
    </script> 
    <script type="text/javascript" src="http://serverapi.arcgisonline.com/jsapi/arcgis/?v=3.0"></script>
    <script type="text/javascript"> 

            dojo.require("dijit.dijit"); // optimize: load dijit layer
      dojo.require("dijit.layout.BorderContainer");
      dojo.require("dijit.layout.ContentPane");
      dojo.require("esri.map");
      dojo.require("dijit.TitlePane");
      dojo.require("esri.dijit.BasemapGallery");
      dojo.require("esri.arcgis.utils");
            dojo.require("esri.tasks.locator");
            dojo.require("esri.dijit.Legend");
            dojo.require("esri.dijit.Popup");
            dojo.require("dijit.form.Button");
            dojo.require("dojo.fx");
            dojo.require("dijit.Dialog");
            dojo.require("dojo.ready");
      dojo.require("dijit.TooltipDialog");
            dojo.require("dojox.grid.DataGrid");
      dojo.require("dojo.data.ItemFileReadStore");
      dojo.require("esri.tasks.find");

      var map, locator, layer, visible = [];
            var legendLayers = [];
            var resizeTimer;
            var identifyTask,identifyParams;
            var findTask, findParams;
            var basemaptoggler = null;
            var layertoggler = null;
            var legendtoggler = null;
            var findTaskParcel, findParamsParcel;
      // var gridParcel, storeParcel; 
```

**编辑 2**

我已经完全重写了将所有代码（css 除外）放在主 default.html 文件中的应用程序。我逐个测试以确保它按我想要的方式运行。添加切换代码是唯一抛出它并导致额外刷新的代码。

所以现在我使用 dijit.TitlePane 来保存下拉元素（底图库、图层、图例）。然而，有了这个，你不能改变外观和感觉来制作它们，这是我的最终目标。

任何人都可以提出一个替代方案，以便我可以使用 3 个不同的图像，这样当您单击图像并打开下拉菜单时，会打开包含底图库、图层列表和图例的下拉菜单？

**编辑 3**

显示我用来调用切换函数的代码可能会有所帮助：我怀疑这可能是我的问题所在。

```
<!--Legend-->
    <div id="subheader">
  <div style="position:absolute; right:60px; top:10px; z-Index:98;">
            <div id="legendbutton">
        <button dojoType="dijit.form.Button" baseClass="tomButton" title="Show Legend">
            <img src="images/Legend.png" />
                <script type="dojo/method" event="onClick">
                    legendtoggler[(dojo.style("legendtoggle","display") == "none") ? 'show':'hide']();
                </script>
        </button>
                <div id="legendtoggle" dojoType="dijit.layout.ContentPane" style="border: 1px solid black; display: none">
                    <div id="legendDiv"></div>
                </div>
            </div>
<!--Layer Toggle-->
            <div id="layerbutton">
                <button dojoType="dijit.form.Button" baseClass="tomButton" border="0" title="Toggle Layers">
                    <img src="images/layers.png"/>
                        <script type="dojo/method" event="onClick">
                            layertoggler[(dojo.style("layertoggle","display") == "none") ? 'show':'hide']();
                        </script>
                </button>
                    <div id="layertoggle" dojoType="dijit.layout.ContentPane" style="border: 1px solid black; display: none">
                        <span id="layer_list"><input type='checkbox' class='list_item' id='0' value=0 onclick='updateLayerVisibility();'
                        </span>
                    </div>
            </div>
<!--Basemap Gallery-->
            <div id="basemapbutton">
                <button dojoType="dijit.form.Button" baseClass="tomButton" title="Switch Basemap">
                    <img src="images/imgBaseMap.png"/>
                        <script type="dojo/method" event="onClick">

                        </script>
                </button>
                    <div id="basemaptoggle" dojoType="dijit.layout.ContentPane" style="#900;display: none;">
                        <span id="basemapGallery">
                        </span>
                    </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T10:23:11.990

相当你在这里提出的故事，很难确定你的问题是什么。但既然你说'地图需要额外刷新'，那么我猜这可能是由于你要求的事情的流动。问题很可能是，您正在从支持 AMD 加载程序的 dojo 版本推出遗留加载程序代码。

因为我之前真的没有运行过任何`esri`组件，所以这是一个疯狂的猜测——但从我的观点来看，它可能值得一试。我确定谷歌地图有一个 onload 监听器——我怀疑 esri 会遵循这种行为。

在加载任何 esri 模块之前尝试初始化应用程序中的所有内容，如下所示：

```
dojo.addOnLoad(function() {
  basemapToggle();
  layerToggle();
  legendToggle();
  dojo.require("esri.map");
  dojo.require("esri.dijit.BasemapGallery");
  dojo.require("esri.arcgis.utils");
  dojo.require("esri.tasks.locator");
  dojo.require("esri.dijit.Legend");
  dojo.require("esri.dijit.Popup");
  dojo.require("esri.tasks.find");
}); 
```

至于您要寻找的效果，我个人会使用`dojo.animateProperty`并将其与`dijit/TooltipDialog`.

这个[http://jsfiddle.net/seeds/a8BBm/2/](http://jsfiddle.net/seeds/a8BBm/2/)展示了如何“破解” `onShow`mechanizm，在开场动画中留下可选效果。默认情况下，DropDownButton 只是淡入。

请参阅[http://livedocs.dojotoolkit.org/dijit/TooltipDialog#programmatic-example](http://livedocs.dojotoolkit.org/dijit/TooltipDialog#programmatic-example)以了解弹出工具提示对话框的替代方法 - 即连接`dijit.popup`到任何单击/鼠标悬停事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:25:12.507

作为一种解决方法，我做了类似的事情：

[http://www.martindueren.de/paperwriting/](http://www.martindueren.de/paperwriting/)

应用程序右侧的图标使 dijit.TitlePanes 擦除和擦除。可以在此页面上找到用于此的效果：

[http://dojotoolkit.org/documentation/tutorials/1.8/effects/](http://dojotoolkit.org/documentation/tutorials/1.8/effects/)

代码是这样的：

```
<button id="slideAwayButton">Slide block away</button>
<button id="slideBackButton">Slide block back</button>

<div id="slideTarget" class="red-block slide">
    A red block
</div>
<script>
    require(["dojo/fx", "dojo/on", "dojo/dom", "dojo/domReady!"], function(fx, on, dom) {
        var slideAwayButton = dom.byId("slideAwayButton"),
            slideBackButton = dom.byId("slideBackButton"),
            slideTarget = dom.byId("slideTarget");

        on(slideAwayButton, "click", function(evt){
            fx.slideTo({ node: slideTarget, left: "200", top: "200" }).play();
        });
        on(slideBackButton, "click", function(evt){
            fx.slideTo({ node: slideTarget, left: "0", top: "100" }).play();
        });
    });
</script> 
```

随意查看我的源代码并从中复制内容！如果我理解正确，这也正是您所需要的。

# sql-server-2008 - 是否可以在 MS SQL 的同一张表上的两列或多列上创建全文索引？

> ID：12943199
> 
> 赞同：4
> 
> 时间：2012-10-17T20:53:32.597
> 
> 标签：sql-server-2008, full-text-search, multiple-columns

这可能吗，或者默认情况下，这本质上是我通过在整个表上创建全文索引，在我的查询中指定使用“CONTAINS（column，phrase）”函数查询哪一列？

谢谢！

如果这个问题已经被问过（无法找到匹配项），请随时删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:01:07.347

我相信我已经尴尬地回答了我自己的问题[在这里，转到 Ctrl + F 'Contains( )'](http://blog.sqlauthority.com/2008/09/05/sql-server-creating-full-text-catalog-and-index/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T01:08:02.107

这个问题已经[在这里](https://stackoverflow.com/a/2811260/1751090)提出并回答 了一个例子如何[在这里](http://www.codeproject.com/Articles/315101/SQL-Full-Text-Search-Programming)。

# jquery - jQuery 在简单计算中返回 NaN

> ID：12943205
> 
> 赞同：2
> 
> 时间：2012-10-17T20:54:28.927
> 
> 标签：jquery, nan

我有以下脚本。当我最初编写它时，它运行良好。然后我加载了页面，它已经损坏并且永久返回`NaN`。我能够在控制台中成功运行它，但由于某种原因它无法在站点上正常运行。它在 Rails 应用程序内部运行。

```
$(document).ready(function(){
  $('select').click(function(){
    var often = parseInt($('#biohaz_frequency_often').val());
    var time = parseInt($('#biohaz_frequency_time').val());
    var timeoften = often * time
    if(timeoften == 0){
      var freq = 0;
    }
    else if(timeoften <= 2){
      var freq = 1;
    }
    else if(timeoften <= 4){
      var freq = 3;
    }
    else if(timeoften <= 9){
      var freq = 6;
    }
    else if(timeoften > 9){
      var freq = 10;
    }
    var sever = parseInt($('#biohaz_risk_severity').val());
    var master = parseInt($('#biohaz_risk_mastery').val());
    $('#risk_frequency').html(freq);
    $('#risk_total').html(freq * sever * master);
  })
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:19:27.760

运行此诊断：

```
$(document).ready(function(){
  $('select').click(function(){
    var often = parseInt($('#biohaz_frequency_often').val());
    var time = parseInt($('#biohaz_frequency_time').val());
    var sever = parseInt($('#biohaz_risk_severity').val());
    var master = parseInt($('#biohaz_risk_mastery').val());
    alert([often, time, sever, master].join());
  });
}); 
```

这将告诉您四个变量中的哪一个是 NaN。

此外（这可能很重要），`$('select').click(...)`是相当不寻常的。我希望看到`$('select').on('change', ...)`。使用`click`您的 NaN 更有可能是非数字进入计算的结果。如果没有看到 HTML，我无法确定。

最好的策略是确保所有四个选择元素都被初始化（在 HTML 中）并选择了一个有效的选项，然后代码如下：

```
$(document).ready(function(){
    //cache of static jQuery objects
    var $$ = {
        'often':     $('#biohaz_frequency_often'),
        'time':      $('#biohaz_frequency_time'),
        'sever':     $('#biohaz_risk_severity'),
        'master':    $('#biohaz_risk_mastery'),
        'frequency': $('#risk_frequency'),
        'total':     $('#risk_total')
    };
    $('select').on('change', function(){
        var often = parseInt($$.often.val()),
            time = parseInt($$.time.val()),
            sever = parseInt($$.sever.val()),
            master = parseInt($$.master.val()),
            ot = often * time,//keep this member name short, it's about to be used 4 times in the next line
            freq = (ot == 0) ? 0 : (ot <= 2) ? 1 : (ot <= 4) ? 3 : (ot <= 9) ? 6 : 10;
        $$.frequency.html(freq);
        $$.total.html(freq * sever * master);
    }).trigger('change');//call the handler immediately, with initially selected options
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:09:58.110

我刚刚根据 benny 的回答和前一秒在这里删除的答案为您整理了一个快速示例 jsfiddle - 它似乎有效：

[http://jsfiddle.net/Qr5eF/1/](http://jsfiddle.net/Qr5eF/1/)

如果您可以提供自己的 html 来帮助您找到答案。

编辑：更新为新的 jsfiddle，因为我在原版中输入了两个 id。哎呀！

# ajax - HighCharts - 如何创建导出所有内容的动态图表

> ID：12943208
> 
> 赞同：10
> 
> 时间：2012-10-17T20:54:40.713
> 
> 标签：ajax, dynamic, export, highcharts, renderer

我正在尝试导出动态生成的图表，但我注意到有些东西没有被导出。例如，我的图表有 PlotBands，它们是动态的，具体取决于所显示的数据。

在构建图表时，我遵循了所有出色的 HighChart 示例的标准代码布局，在这些示例中，我在文档加载时立即生成了图表。然后稍后在我的代码中，我使用 Ajax 调用来加载数据并修改标题、绘图带、自定义文本等内容。

问题是在初始图表加载后对图表进行的任何修改都不会导出为图像或 PDF。我的 PlotBands 是在 Ajax 调用期间添加的。它们不能包含在基于`document.load()`. 因此，HighCharts 很方便地忽略了它们。

在我的图表中，我想显示不同地点 24 小时内的能源使用情况。用户可以选择不同的日子和不同的站点。Plot Bands 需要突出显示运行时间，并且每个站点都有不同的运行时间，这些时间加载了数据。此外，图表标题显示站点名称，副标题显示平方英尺。

`text()`此外，我的代码使用 HighCharts 渲染器命令在图形底部绘制了一些自定义文本。

我的几乎无法正常运行的导出代码如下所示：

```
var chart;
$(document).ready(function() {
    chart = new Highcharts.Chart({
        chart: {
            renderTo: "ChartContainer",
            type: "line",
            title: { text: null },
            subtitle: { text: null }
        }
    }
});

function UpdateChart() {
    $.ajax({
        url: "/my/url.php",
        success: function(json) {
            chart.addSeries(json[1]);
            chart.addSeries(json[2]);
            chart.setTitle(json[0].title, json[0].subtitle);
            chart.xAxis[0].addPlotBand({ color: "#FCFFB9", from: json[0].OpenInterval, to: json[0].CloseInterval, label: { text: "Operating Hours", verticalAlign: "bottom", y: -5, style: { fontSize: "8pt", color: "gray" } } });
            chart.renderer.text("Custom Text", 50, 100);
        }
    });
} 
```

不幸的是，如果用户导出图表，标题、绘图带和“自定义文本”将不会出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-26T10:12:08.963

是的 - 它可能和 highcharts 支持您在此处提到的`sample code` [http://jsfiddle.net/vijaykumarkagne/9c2vqq7q/](http://jsfiddle.net/vijaykumarkagne/9c2vqq7q/)动态 highchart 使用托管在谷歌驱动器中的文件的 json 数据。

```
 $.getJSON("https://b943d995d961c8938d74bf398f8748e2b34864c6.googledrive.com/host/0B_i_hw1oG1HeaU9nMWxfTnJZd1k/data.json",{format:"json"},function(result){

chart = new Highcharts.Chart({
        chart: {
            zoomType: 'x',
            type: 'line',
            renderTo: 'container'
        },
        title: {
            text: ' '
        },
        subtitle: {
            text: 'Click and drag in the plot area to zoom in',
            x: -20
        },
        xAxis: {
            type: 'datetime',
            title: {
                text: ' '
            }

        },
        yAxis: {
            title: {
                text: ' '
            }
        },        

        series:[{
            name: 'Tokyo',
            data: result
        }]

     });
        });
```

```
 <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://b943d995d961c8938d74bf398f8748e2b34864c6.googledrive.com/host/0B_i_hw1oG1HeaU9nMWxfTnJZd1k/dataEmp.json"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/drilldown.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<body>
<div id="container"></div>
</body>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-09T01:11:02.227

*（在这里回答我自己的问题）*

关键是重新安排您构建图表的方式。

不要在`document.load()`. `success()`在ajax调用的函数中生成它。

首先，检查图表是否已经存在`destroy()`。如果您的代码允许用户动态更改设置，这将导致执行新的 ajax 调用，该调用需要更新图形。图表需要在重建之前被销毁。

现在从头开始构建一个新图表。但是，现在您已经从 ajax 调用中获得了所需的数据，因此您可以使用正确的信息从头开始构建它。**HighCharts 只会导出第一次创建图表时包含的数据。**所以这里需要包含所有自定义数据。如果您需要更改图表上的某些内容，请销毁它并使用自定义数据重建它。

```
function UpdateChart() {
    $.ajax({
        url: "/my/url.php",
        success: function(json) {
            // If the chart exists, destroy it
            if (chart) chart.destroy();

            // Create the chart
            chart = new Highcharts.Chart({
                chart: {
                    renderTo: "ChartContainer",
                    type: "line",
                    events: {
                        load: function(event) {
                            this.renderer.text("Custom Text", 50, 100);
                        }
                    },
                    title: { text: json[0].title },
                    subtitle: { text: json[0].sqft }
                },
                plotBands: {
                    color: "#FCFFB9",
                    from: json[0].OpenInterval,
                    to: json[0].CloseInterval,
                    label: {
                        text: "Store Hours", verticalAlign: "bottom", y: -5, style: { fontSize: "8pt", color: "gray" }
                    }
                }
            };

            // Add two data series to the chart
            chart.addSeries(json[1]);
            chart.addSeries(json[2]);

            // Set title and sub-title
            chart.setTitle(json[0].title, json[0].subtitle);
        }
    });
} 
```

现在，图表将显示您添加的所有自定义内容。请注意，使用命令写入图表的自定义文本`renderer.text()`已添加到`chart.load()`事件中。出于某种原因，它只在这里工作。

记住关键：**HighCharts 只会导出第一次创建图表时包含的数据。** 这将为您省去很多麻烦。

# mysql - 相关表主键节省存储空间的方法

> ID：12943213
> 
> 赞同：0
> 
> 时间：2012-10-17T20:55:29.457
> 
> 标签：mysql, sql, primary-key

我对关系数据库中的主键有疑问。假设我有以下表格：

盒子

*   ID
*   盒子名称

盒子物品

*   ID
*   项目名
*   belongs_to_box_id（外键）

我们还假设我打算每天存储数百万个项目。我可能会为 BoxItems.Id 使用`bigint`or `guid`。

我在想什么，我需要你的建议，而不是 BoxItems 的 Bigint Id，使用序列`TinyInt`号，识别每个项目的是 belongs_to_box_id 加上 tinyint 行的组合（例如 item_numner）。

所以现在我们得到的是：

盒子物品

*   属于_to_box_id
*   item_sequence_number [TINYINT]
*   项目名

例子：

```
Items.Insert(1,1, "my item 1");
Items.Insert(1,2, "my item 2"); 
```

因此，我可以使用 tinyint 并节省大量磁盘空间，而不是使用 bigint 或 GUID。

我想知道这种方法的优缺点。我正在使用 MySQL 和 ASP.NET 4.5 开发我的应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:26:25.973

我建议为这两种方法编写一个简单的测试，比较性能、磁盘空间和实施的难易程度，然后做出判断。您的两个建议都是合理的，我怀疑性能上会有很大差异，但最好的方法是尝试一下，然后您就会确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T23:07:23.310

仔细想想，“盒子/内容”问题和“订单/订单项”问题之间并没有太大区别。

```
create table boxes (
  box_id integer primary key,
  box_name varchar(35) not null
);

create table boxed_items (
  box_id integer not null references boxes (box_id),
  box_item_num tinyint not null,
  item_name varchar(35) not null
); 
```

对于 MySQL，您可能会使用无符号整数和无符号 tinyint。数据库避免负数没有令人信服的理由，但开发人员应该依靠[最小意外原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)。

确保 256 个值就足够了。在每天有数百万行的表中纠正错误可能会很昂贵。

# c++ - 如何避免C++中的“模板模板”模板

> ID：12943216
> 
> 赞同：4
> 
> 时间：2012-10-17T20:55:32.917
> 
> 标签：c++, templates

我试图实现一个“模板模板模板” - 模板类来满足我的需求（我在使用模板元编程方面很新）。不幸的是，我发现以下主题为时已晚： [模板模板参数](https://stackoverflow.com/questions/6484484/template-template-parameters)

不过，我需要实现如下所列的内容。

根据编译器，最后一个 typedef 不起作用。我不确定，但我认为这是由于 3x 模板限制的限制。在这个简单的例子中是否有可能绕过 3xtemplate 定义？

```
template < typename TValueType >
class ITTranslator
{
public:
    ITTranslator() = 0;
    virtual ~ITTranslator() = 0;
    virtual void doSomething() = 0;
}

template < typename TValueType >
class TConcreteTranslator1 : public ITTranslator<TValueType>
{
public:
    TConcreteTranslator1(){}
    ~TConcreteTranslator1(){}
    void doSomething() {}
}

template < typename TValueType >
class TConcreteTranslator2 : public ITTranslator<TValueType>
{
public:
    TConcreteTranslator2(){}
    ~TConcreteTranslator2(){}
    void doSomething() {}
}

template < 
    typename TValueType, 
    template < typename TValueType > class TTranslatorValueType 
    >
class ITClassifier
{
public:
    ITClassifier() = 0;
    virtual ~ITClassifier() = 0;
}

template < 
    typename TValueType, 
    template < typename TValueType > class TTranslatorValueType 
    >
class TConcreteClassifier1 : public ITClassifier<TValueType,TTranslatorValueType >
{
public:
    TConcreteClassifier1() {}
    ~TConcreteClassifier1() {}
    void dodo(){}
}

template < 
    typename TValueType,
    template <typename TValueType> class TTranslatorValueType,
    template <template<typename TValueType> class TTranslatorValueType> class TClassifierValueType
 >
class ITAlgorithm
{
public:
    ITAlgorithm()=0;
    virtual ~TAlgorithm()=0;
    virtual run() = 0;
}

template < 
    typename TValueType,
    template <typename TValueType> class TTranslatorValueType,
    template <template<typename TValueType> class TTranslatorValueType> class TClassifierValueType
 >
class TConcreteAlgorithm1 : public ITAlgorithm<TValueType,TTranslatorValueType,TTranslatorValueType>
{
public:
    TConcreteAlgorithm1 (){}
    ~TConcreteAlgorithm1 (){}
    run()
    {
        TClassifierValueType< TTranslatorValueType>* l_classifier_pt = new TClassifierValueType< TTranslatorValueType>( );
        // add this object to a internal list...
    }
}

int main()
{
    typedef TConcreteTranslator1< cvbase::uint32_t > translator_t;
    typedef TConcreteClassifier1< cvbase::uint32_t, TConcreteTranslator1> classifier_t;
    typedef TConcreteAlgorithm1 < cvbase::uint32_t, TConcreteTranslator1, TConcreteClassifier1> algorithm_t; // not possible
    return 0;
} 
```

非常感谢，我真的很感激任何帮助！

编辑：我已经扩展了我的列表（我很确定它不会编译:)）以显示我使用奇怪概念的动机:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:04:36.887

There is really no need to pass template template parameter around here. Usually you can just take a normal template argument and provide a reasonable default:

```
template<typename ValueType>
struct translator {};

template<typename ValueType, typename Translator = translator<ValueType>>
struct Classifier {};

template<typename ValueType, 
         typename Translator = translator<ValueType>, 
         typename Classifier = classifier<ValueType, Translator>
         >
struct Algorithm {}; 
```

This is done the same way for allocator aware containers.

And please do away with the horrible hungarian-notation prefixes.

NB: It seems from your usage of constructors and destructors that you don't really have a grasp of basic C++. You might want to stay away from templates before you have understood easier concepts.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T22:31:28.617

是的，可以避免模板模板参数（任何级别）。

模板基本上是一个类型级别的函数。你喂它一种类型，然后得到另一种类型。

模板模板参数本身就是一个类型级函数，接受这种参数的模板是一个高阶类型级函数。

可以使用成员模板实现更高阶的类型级函数，而无需使用模板模板参数。我不确定你的设计是否需要它，但这里有一个快速而肮脏的例子：

```
// regular type, a.k.a. zeroth-order type-level function, 
// a.k.a. "type of kind *"
struct N
{
    int a;
};

// a first-order type-level function, a.k.a. "type of kind *->*"
// it is wrapped in a regular type
struct B
{
    template <class A> struct Impl
    {
        void foo(A a)
        {
            int aa = a.a;
        }
    };
};

// a second-order type-level function 
// that accepts a (wrapped) first-order type function
// and also a regular type. the kind of it would be (*->*)->*->*
// it applies its first argument to its second argument
struct Z
{
    template <class X, class Y> struct Impl
    {
        typename X::template Impl<Y> ya;
        void bar()
        {
            ya.foo(Y());
        }
    };
};

// now this is something: a third-order type-level function
// that accepts a (wrapped) second-order type-level function
// and a (wrapped) first-order type-level function
// and a zeroth-order type-level function
// it applies its first argument to its second and third arguments
// it is also wrapped in a regular type for consistency
// try to figure out its kind
struct T
{
    template <class P, class Q, class R> struct Impl 
    {
        typename P::template Impl<Q, R> yb;
        void baz()
        {
          yb.bar();
        }
    };
};

T::Impl<Z, B, N> tt; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:01:33.183

在这种情况下，您真的不需要模板参数，基本上唯一的变量类型是 TValueType 对吧？其他类型可以使用 TValueType 在类主体上解析。

像这样的东西：

```
template < 
    typename TValueType
 >
class TAlgorithm
{
public:
    // TTranslator <TValueType> whatever
    // TTranslatorValueType <TValueType> whatever
    TAlgorithm(){}
    ~TAlgorithm(){}
} 
```

# multithreading - Winsock send() 阻塞服务器？

> ID：12943219
> 
> 赞同：2
> 
> 时间：2012-10-17T20:55:59.000
> 
> 标签：multithreading, block, winsock, send, blocking

我读过 Winsock 上的 send() 函数会阻塞，直到收到最后一个数据包的 ACK。现在我正在使用服务器进行回合制角色扮演游戏。一切都由一个线程处理（对于 64 个套接字）。接收、处理请求并将响应写入套接字。这个过程不能中断。

是否可以使用这种方法处理 1000 个客户端（每 64 个套接字一个线程）？

如果 send() 完成时间过长或者客户端恶意不发送 ACK 或连接中断，它不会阻塞整个服务器吗？

我应该将网络和请求处理的逻辑拆分为 2 个线程吗？如果是这样，处理网络传输的线程仍然可能被 send() 或 recv() 阻塞。

还是最好使用重叠 I/O？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:34:10.190

`send()`仅当套接字以阻塞模式运行并且套接字的出站缓冲区填满排队数据时才阻塞。如果您在同一线程中管理多个套接字，请不要使用阻塞模式。如果一个接收器没有及时读取数据，可能会导致该线程上的所有连接都受到影响。改用非阻塞模式，然后`send()`当套接字进入阻塞状态时会报告，然后你可以使用`select()`检测套接字何时可以再次接受新数据。更好的选择是改用重叠 I/O 或 I/O 完成端口。向操作系统提交出站数据，让操作系统处理所有等待您的事情，并在数据最终被接受/发送时通知您。在收到通知之前，不要为给定的套接字提交新数据。对于大量连接的可扩展性，I/O 完成端口通常是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:05:17.097

不，它不是那样工作的。从 MSDN 文档中[`send`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740149.aspx)：

> **发送**功能的成功完成并不表示数据已成功交付和接收到接收者。该函数仅表示数据发送成功。

# sql - 有条件的 SSIS 新列

> ID：12943220
> 
> 赞同：0
> 
> 时间：2012-10-17T20:55:59.470
> 
> 标签：sql, sql-server, sql-server-2008, ssis

我已经使用派生列 Record_Type 作为 (DT_WSTR,25)"" 数据类型创建了一个新列，然后我使用另一个派生列来创建 Record_Type 为 PRDCT_IND == TRUE 的条件？“PRIME”：“SEC”。

是否可以在一个派生列中创建这两个东西？

感谢你的帮助。

343

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T02:35:57.813

您似乎正在尝试创建一个带有条件的列作为定义为 DT_WSTR,25 的数据，因此您可以使用以下步骤一步创建它：

(DT_WSTR,25)(PRDCT_IND == TRUE ? "PRIME" : "SEC")

第一组 () 将整个结果转换为长度为 25 的 DT_WSTR 第二组 () 使用 PRDCT_IND 的值将值设置为“PRIME”或“SEC”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:13:19.137

简单的回答：没有。
您不能使用在同一组件内的组件中创建的列。

您必须添加第二个派生列组件。

# objective-c - 将 UIImageView 和覆盖的 UIView 保存为图像（xcode/iOS）

> ID：12943222
> 
> 赞同：1
> 
> 时间：2012-10-17T20:56:12.547
> 
> 标签：objective-c, uiview, uiimageview

我将图像加载到 UIImageView 中，其中覆盖了 UIView（其中绘制了 CGRect），我正在寻找一种将屏幕上显示的内容保存为新图像的方法。我正在使用故事板和 ARC。

我有一个 UIViewController，它包含 UIImageView。UIView 显示在此之上，并在用户触摸屏幕的位置绘制一个圆圈。这一切都很好，但现在我想将显示的内容保存为图像（JPG）。

我的故事板截图：

![在此处输入图像描述](../Images/34ecaa6fad2573ce280a36f432feff75.png)

下面是到目前为止我的 PhotoEditViewController 的代码。passPhoto 是加载到 UIImageView 中的照片。

```
#import "PhotoEditViewController.h"
@interface PhotoEditViewController ()
@end

@implementation PhotoEditViewController
@synthesize selectedPhoto = _selectedPhoto;
@synthesize backButton;
@synthesize savePhoto;

- (void)viewDidLoad {
    [super viewDidLoad];
    [passedPhoto setImage:_selectedPhoto];
}

- (void)viewDidUnload {
    [self setBackButton:nil];
    [self setSavePhoto:nil];
    [super viewDidUnload];
}

- (IBAction)savePhoto:(id)sender{
    NSLog(@"save photo");
    // this is where it needs to happen!
}

@end 
```

下面是来自我的 PhotoEditView 的代码，它处理圆圈覆盖的创建：

```
#import "PhotoEditView.h"

@implementation PhotoEditView
@synthesize myPoint = _myPoint;

- (void)setMyPoint:(CGPoint)myPoint {
    _myPoint = myPoint;
    self.backgroundColor = [UIColor colorWithWhite:1.0 alpha:0.01];
    [self setNeedsDisplay];
}

- (id)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    return self;
}

-(void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event {
    NSSet *allTouches = [event allTouches];
    switch ([allTouches count]){
        case 1: {
            UITouch *touch = [[allTouches allObjects] objectAtIndex:0];
            CGPoint point = [touch locationInView:self];
            NSLog(@"x=%f", point.x);
            NSLog(@"y=%f", point.y);    
            self.myPoint = point;
        }
        break;
    }
}

- (void)drawRect:(CGRect)rect {
    CGContextRef ctx = UIGraphicsGetCurrentContext();
    CGContextSetLineWidth(ctx, 4.0);
    CGContextSetRGBFillColor(ctx, 0, 0, 0, 0.5);
    CGContextSetRGBStrokeColor(ctx, 1.0, 0.0, 0.0, 1);
    CGContextStrokePath(ctx);
    CGRect circlePoint = CGRectMake(self.myPoint.x - 50, self.myPoint.y - 50, 100.0, 100.0);
    CGContextStrokeEllipseInRect(ctx, circlePoint);
}

@end 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:26:07.243

你有没有试过这个：

```
UIGraphicsBeginImageContext(rect.size);

[imageView.layer renderInContext:UIGraphicsGetCurrentContext()];
[customView.layer renderInContext:UIGraphicsGetCurrentContext()];

UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImageView *imgView = [[UIImageView alloc] initWithImage:viewImage]; 
```

`UIImage`这与从 a获取 a 的方法相同`UIView`，只是您在同一上下文中绘制两个视图。

# comments - 删除嵌套注释 bz lex

> ID：12943229
> 
> 赞同：5
> 
> 时间：2012-10-17T20:56:31.563
> 
> 标签：comments, lex, flex-lexer, lexical-analysis

我应该如何在 lex（或 flex）中编写程序以从文本中删除嵌套注释并仅打印不在注释中的文本？当我在评论和块评论的起始“标签”数量时，我可能应该以某种方式识别状态。

让我们有规则：
**1.block评论**

```
/*
block comment
*/ 
```

**2.行注释**

```
// line comment 
```

**3.评论可以嵌套。**

**示例 1**

```
show /* comment /* comment */ comment */ show 
```

输出：

```
show  show 
```

**示例 2**

```
show /* // comment
comment
*/
show 
```

输出：

```
show 
show 
```

**示例 3**

```
show
///* comment
comment
// /*
comment
//*/ comment
//
comment */
show 
```

输出：

```
show
show 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-18T07:34:45.547

你的理论是对的。这是一个简单的实现；可以改进。

```
%x COMMENT
%%
%{
   int comment_nesting = 0;
%}

"/*"            BEGIN(COMMENT); ++comment_nesting;
"//".*          /* // comments to end of line */

<COMMENT>[^*/]* /* Eat non-comment delimiters */
<COMMENT>"/*"   ++comment_nesting;
<COMMENT>"*/"   if (--comment_nesting == 0) BEGIN(INITIAL);
<COMMENT>[*/]   /* Eat a / or * if it doesn't match comment sequence */

  /* Could have been .|\n ECHO, but this is more efficient. */
([^/]*([/][^/*])*)* ECHO;  
%% 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T16:59:56.077

这正是您所需要的：`yy_push_state(COMMENT)`它使用堆栈来存储我们的状态，这在嵌套情况下很方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-06T05:41:34.277

恐怕@rici 的回答可能是错误的。首先我们需要记录行号，以后可能会更改文件**行**指令。第二个给出 open_sign 和 close_sign。我们有以下原则：

```
1) using an integer for stack control: push for open sign, popup for close sign
2) eat up CHARACTER BEFORE EOF and close sign WITHOUT open sign inside
<comments>{open} {no_open_sign++;}
<comments>\n {curr_lineno++;}
<comments>[^({close})({open})(EOF)] /*EAT characters by doing nothing*/
3) Errors might happen when no_open_sign down to zero, hence
<comments>{close}  similar as above post
4) EOF should not be inside the string, hence you need a rule
<comments>(EOF) {return ERROR_TOKEN;} 
```

为了使其更健壮，您还需要有另一个密切检查规则

在实践中，如果您的词法分析器支持，您应该在正则表达式语法之前使用否定查找并在正则表达式语法之后查找。

# android - 在 Android 上测试 SQLite 数据库

> ID：12943230
> 
> 赞同：0
> 
> 时间：2012-10-17T20:56:33.770
> 
> 标签：android, sqlite, unit-testing, junit

我正在为使用 SQLite 数据库的 Android 应用程序进行 JUnit 测试。我需要创建一个可以由测试用例操作的测试数据库。数据库需要以已知配置启动并为每个测试用例重置。我发现我可以通过向 SQLiteOpenHelper 传递一个`null`值作为数据库的文件名来使用内存数据库（[有关详细信息，请参阅本文](http://attakornw.wordpress.com/2012/02/25/using-in-memory-sqlite-database-in-android-tests/)）。现在我还想为我的一些测试填充数据库表。我的本地文件系统上有一个 CSV 文件，其中包含一些可用于测试的数据。如何将这些数据放入模拟器或其他设备上的 SQLite 数据库中进行测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:09:51.500

SQLite 库代码中没有内置的 CSV 导入功能。

但是，[`sqlite3`](http://www.sqlite.org/sqlite.html)命令行工具可以导入 CSV 文件。导入后，您将拥有一个数据库文件，您可以使用该`adb`工具将其复制到您的设备中。或者，您可以使用 sqlite3 的`.dump`命令生成 SQL 命令来重新创建数据库；然后将它们放入字符串数组中，或将它们放入测试程序读取的文本文件中。

# php - WP_Query() 不返回所有条目

> ID：12943236
> 
> 赞同：37
> 
> 时间：2012-10-17T20:56:52.510
> 
> 标签：php, wordpress

我有这个查询，它只返回我在表上的几个条目。我有超过 10 个帖子，但此查询仅返回 6 个。请提供建议

```
$query = new WP_Query("year=2011&monthnum=09&post_status=publish&post_type=post&orderby=post_date&order=DESC");
while ($query->have_posts()):
    $query->the_post();
    $title=get_the_Title();                                                                                                                  
    echo"<p><input type=\"checkbox\" name=\"MyArticle[]\" value=\"".get_the_ID()."\">".get_the_Title()."</p>";
endwhile;               
wp_reset_query(); 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-10-17T21:29:55.660

尝试添加`posts_per_page=-1`到传递给的参数字符串`WP_Query`。

如果未设置该值，则它会回退使用您在 中设置的默认每页帖子选项`Settings >> Reading >> Blog pages show at most`。

我的猜测是这个值是 6，所以它返回了很多帖子，因为你没有指定不同的限制。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-04-22T11:33:31.497

```
$args = array(
    'post_type' => 'product',
    'orderby' => 'ASC',
    'posts_per_page'=>-1
);
$wp_query = new WP_Query($args); 
```

# javascript - 在 javascript 中使用 join 和 match 实现 inArray 有什么问题？

> ID：12943237
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:57:01.373
> 
> 标签：javascript, arrays

我刚刚想出了一个用于 javascript 的 inArray 实现，它运行良好。它很奇怪但很短，我感觉它有问题，但我不确定它是什么：

```
Array.prototype.inArray = function (itm) {
  return this.join("|").match( new RegExp('\\b'+itm+'\\b','ig')  );
} 
```

更新：这应该是 inArray 功能的一般实现。我不确定哪个更昂贵，做一个循环或创建一个正则表达式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:03:29.547

I don't know what your implementation requirements are, but keep these in mind:

*   you'll be matching a stringified version of the Array members, not the actual members

*   the `\\b` will allow any word break, including punctuation, giving false positives.

*   it would only be useful for single word entries in the Array, otherwise you could get false positives

*   you'll be returning `null` or and Array of "matches". Not sure if that's what you'd want.

I'm sure these just scratch the surface.

If you are implementing a very narrow functionality, it could work, but would be not be adequate for general use.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:08:41.620

使用 underscore.js[`intersection()`](http://documentcloud.github.com/underscore/#intersection)方法来确定您的数组是否包含一个元素甚至一系列元素：

```
if(_.intersection(yourArray, [item]).length){
    //do stuff
} 
```

您也可以通过将它们推入数组来检查多个项目。它还涵盖**任何**类型的对象

# java - GebConfig.groovy 和 Groovy ConfigSlurper 的 Geb 配置问题

> ID：12943240
> 
> 赞同：0
> 
> 时间：2012-10-17T20:57:14.447
> 
> 标签：java, testing, groovy, geb

我正在尝试启动并运行基于 Groovy 的浏览器自动化/测试框架，但在使基于 ConfigSlurper 的配置正常工作时遇到问题。

我的默认包中有一个 GebConfig.groovy 类，如下所示：

```
import org.openqa.selenium.firefox.FirefoxDriver

// default is to use firefox
driver = { new FirefoxDriver() }

//set the report output directory
reportsDir = "reports/" 
```

但是尝试运行脚本会导致以下错误：

```
Caused by: groovy.lang.MissingMethodException: No signature of method: groovy.util.ConfigSlurper.parse() is applicable for argument types: (script135050580006143429828, java.net.URL) values: [script135050580006143429828@21f11507, file:/Users/alex/Documents/workspace/gebTest/src/main/java/GebConfig.groovy]
Possible solutions: parse(java.net.URL), parse(groovy.lang.Script, java.net.URL), parse(groovy.lang.Script), parse(java.lang.Class), parse(java.lang.String), parse(java.util.Properties)
    at geb.ConfigurationLoader.loadRawConfig(ConfigurationLoader.groovy:295) 
```

我想我需要遗漏一些小而明显的东西。我在 Eclipse 中使用最新版本的 Geb (0.7.2) 和 Groovy 1.8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T13:17:41.380

正如我从您的异常和脚本路径中看到的那样，您似乎正在使用 Maven 或 Gradle 来构建您的项目。要解决您的问题，您应该尝试将 GebConfig.groovy 脚本从文件夹移动`src/main/java`到`src/main/resources`甚至更好`src/test/resources`，因为您可能不希望在生产环境中使用此脚本。

有关详细信息，请参阅[The Book of Geb 中的配置章节](http://www.gebish.org/manual/current/configuration.html#the_config_script)。

# mirc - mIRC 需要确定自上次脚本执行以来是否已过去 25 小时

> ID：12943241
> 
> 赞同：0
> 
> 时间：2012-10-17T20:57:15.247
> 
> 标签：mirc

到目前为止，基本上我有这个脚本：

```
on 1:TEXT:*some text*:#:{
 if(($time(hh)-25) > $lasttime ) {
   This code gets executed only once per 25 hours
   $lasttime = $time(hh)
 }
} 
```

我不确定我是否正确执行此操作，但如果我需要知道如何设置 $lasttime（如果它尚未设置），以及是否在关闭并重新打开 mirc 时保持 $lasttime 设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:46:44.617

当然，将上次所说的时间保存在一个永久变量 ( `set %last_time ...`) 中，并在下次检查。全局 mIRC % 变量即使在关闭/重新打开后也会保留。

# optimization - CUDA 代码中意外的大 cmem[2] 使用

> ID：12943244
> 
> 赞同：0
> 
> 时间：2012-10-17T20:57:26.940
> 
> 标签：optimization, cuda, gpu

我正在 CUDA 上编写一个（诚然是本地内存密集型）代码，并且已经过了开发阶段并进入加速阶段。命令行分析器表明我的占用率（我认为）非常低（主要内核为 0.083 - 0.417），我想改进这一点。不幸的是，计算工作需要大量`__shared__`内存（每 128 个线程块 16-20 kB）和一些寄存器（主要内核报告为 63，尽管我不确定我实际上使用了这么多......）

不过，我真正的问题与`cmem[2]`. 这是一个例子：

> 使用了 8 个寄存器，40 字节 cmem[0]、51584 字节 cmem[2]、368 字节 cmem[14]、4 字节 cmem[16]

所有内核似乎都使用了这么大量的`cmem[2]`，我什至不确定它是什么。我通过通常的调用在设备上存储了大量内存，并通过调用`cudaMalloc`在内存中存储了一些双精度和指针（尽管远不接近 50 kB），但仅此而已。所以我的问题是：我究竟如何才能使用所有这些，它是否限制了我的内核占用？`__constant__``cudaMemcpyToSymbol``cmem[2]`

此外，我正在使用 CUDA 4.2 和 Ubuntu 10.04.4 64 位的 GTX 550 Ti 上运行。nvcc 生成的可执行文件包含在 mpirun 中，因为代码也是 MPI 并行化的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T22:52:17.063

在 Fermi 架构上，CUDA 驱动程序使用 cmem[2] 来存储**常量**变量。同一模块中的所有函数共享相同的常量。这个常量库的大小不会影响您的理论 SM 占用率或增加您的启动开销。如果超过最大大小 (64KB)，您应该会收到编译器错误。

CUDA 二进制实用程序 cuobjdump 可用于调试分配。

如果您的文件 sm20.cu 具有以下常量

```
__constant__ float k_float_array[] = { 0.f, 1.f, 2.f, 3.f };
__constant__ double k_double_array[] = { 0.0, 1.0, 2.0, 3.0 };
__constant__ int k_int_array[] = { 0, 1, 2, 3 };

__global__ void empty_kernel(float* a)
{
    return;
} 
```

你可以跑

```
cuobjdump.exe -elf sm20.cu.obj 
```

可执行文件也可以用作参数。运行 cuobjdump --help 以获取选项列表。

此命令将产生以下输出

```
Fatbin elf code:
================
arch = sm_20
code version = [1,5]
producer = cuda
host = windows
compile_size = 32bit
identifier = c:/dev/constant/sm20.cu

32bit elf: abi=5, sm=20, flags = 0x140114
Sections:
Index Offset   Size ES Align   Type   Flags Link     Info Name
    1     34     a6  0  1    STRTAB       0    0        0 .shstrtab
    2     da     e9  0  1    STRTAB       0    0        0 .strtab
    3    1c4     80 10  4    SYMTAB       0    2        6 .symtab
    4    244     18  0  4 CUDA_INFO       0    3        0 .nv.info
    5    25c     20  0  4 CUDA_INFO       0    3        8 .nv.info._Z12empty_kernelPf
    6    27c     24  0  4  PROGBITS       2    0        8 .nv.constant0._Z12empty_kernelPf
    7    2a0     40  0  8  PROGBITS       2    0        0 .nv.constant2
    8    2e0     10  0  4  PROGBITS       6    3  2000007 .text._Z12empty_kernelPf 
```

elf 部分 .nv.constant2 包含 cmem[2] 的内容。这个大小是 0x40 == 64 字节，符合我的预期。

.nv.constant2 是节索引 7。

```
.section .strtab

.section .shstrtab

.section .symtab
 index     value     size      info    other  shndx    name
   0          0        0        0        0      0     (null)
   1          0        0        3        0      8     .text._Z12empty_kernelPf
   2          0        0        3        0      6     .nv.constant0._Z12empty_kernelPf
   3          0        0        3        0      7     .nv.constant2
   4          0       16        1        0      7     k_float_array
   5         16       32        1        0      7     k_double_array
   6         48       16        1        0      7     k_int_array
   7          0       16       12       10      8     _Z12empty_kernelPf 
```

.symtab 包含定义的 3 个常量数组。所有带有 shndx == 7 的符号都将在 .nv.constant2 中

```
.nv.constant0._Z12empty_kernelPf
0x00000000  0x00000000  0x00000000  0x00000000  0x00000000
0x00000000  0x00000000  0x00000000  0x00000000

.nv.constant2
0x00000000  0x3f800000  0x40000000  0x40400000  0x00000000
0x00000000  0x00000000  0x3ff00000  0x00000000
0x40000000  0x00000000  0x40080000  0x00000000
0x00000001  0x00000002  0x00000003 
```

.nv.constant2 定义节中的二进制数据。这与声明的常量变量匹配。如果您有很多常量，.symtab 部分会标识每个符号的偏移量和大小。

```
// skipping .nv.info and .text 
```

cuobjdump 可用于转储 PTX 和 SASS 代码。PTX 和 SASS 程序集可用于确定哪些内核正在使用常量。

# asp.net-mvc-3 - 在帮助程序中访问全局页面变量

> ID：12943245
> 
> 赞同：55
> 
> 时间：2012-10-17T20:57:37.450
> 
> 标签：asp.net-mvc-3, razor

```
@{
    int i = 0;
}

@helper Text() {
    <input type="text" name="Ans[@i].Text" />
} 
```

`i`在助手中无法访问。如何访问它？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2013-03-15T20:05:22.580

您可以使用**@functions**声明简单地将其作为成员添加到您的页面：

```
@functions
{
    private int i;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-24T14:45:38.847

您可以将其作为参数传递给助手：

```
@helper Text(int i) {
    <input type="text" name="Ans[@i].Text" />
} 
```

进而：

```
@{
    int i = 0;
}
@SomeHelper.Text(i) 
```

或者你可以简单地使用编辑器模板来处理所有事情并摆脱那些助手。例如：

```
@Html.EditorFor(x => x.Ans) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-24T14:39:20.850

您可以通过更改视图的基类来实现这一点。这种情况适用于在视图中声明助手的情况。

创建一个继承自[WebViewPage](http://msdn.microsoft.com/en-us/library/gg402107%28v=vs.98%29.aspx)的基类并引入共享字段或属性：

```
public class MyBasePage<T> : WebViewPage<T>
{
    public int i;

    public override void Execute()
    { }
} 
```

使用`@inherits`指令更改基类。现在可以从“页面上下文”和助手访问字段/属性：

```
@inherits NamespaceOfYourBaseClass.MyBasePage<YourModel>
@{
    i = 0;
}

@helper Text() {
    <input type="text" name="Ans[@i].Text" />
} 
```

* * *

如果您想要一个接近术语“页面属性/字段”但不想创建基类或助手存储在`App_Code`文件夹中的东西，那么您可以尝试[WebPageBase.Page](http://msdn.microsoft.com/en-us/library/system.web.webpages.webpagebase.page%28v=vs.111%29.aspx)属性。

> **MSDN**：提供对页面、布局页面和部分页面之间共享的页面数据的类似属性的访问。

这种情况下的代码是：

```
@{
    Page.i = 0;
}

@helper Text() {
    <input type="text" name="Ans[@Page.i].Text" />
} 
```

缺点是`Page`属性是类型的`dynamic`，因此不支持智能感知。作为替代`Page`有另一个属性 - [WebPageBase.PageData](http://msdn.microsoft.com/en-us/library/system.web.webpages.webpagebase.pagedata%28v=vs.111%29.aspx)。

> **MSDN**：提供对页面、布局页面和部分页面之间共享的页面数据的类似数组的访问。

在这种情况下，可以为“页面变量”创建一个包含字符串/整数键的类容器。代码如下：

```
// class visible to views and helpers
class MyViewFields {
  public const string i = "MyViewFields.i"; // or maybe generate guid for key so there would be not doubts about its uniqueness.. but how would you debug this? :)
}

// in MyView.cshtml
@{
    PageData[MyViewFields.i] = 0
}

@helper Text() {
    <input type="text" name="Ans[@PageData[MyViewFields.i]].Text" />
} 
```

这至少为共享页面数据提供了约束，但仍然无法控制值类型。

# regex - 正则表达式为什么这两个不一样？

> ID：12943253
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:58:10.463
> 
> 标签：regex, grouping

```
[\w+\.]{3} 
```

和

```
\w+\.\w+\.\w+\. 
```

前者匹配“dra”

后来匹配“dragon.is.awesome”

我对他们有什么不理解的地方？

输入文本看起来像

我知道dragon.is.awesome但是

我知道dragon.is.awesome.because,他很棒

我知道dragon.sucks.because,他并不了不起

我知道dragon.is.dead，有人杀了他

所以我需要匹配模式 \w+ 的任何分组组合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:00:13.723

因为第一个是字符类。

```
[\w+/\.] 
```

匹配一个`\w`或一个`+`或一个`/`或一个字面量`.`。如果要缩短后者，请使用普通括号：

```
(\w+\.){3} 
```

请注意，在字符类中，大多数元字符都失去了意义。所以`+`和`.`和`*`（例如）都可以被包含和匹配而不会被转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:00:35.177

`[...]`是一个*字符类*。它匹配一个字符。`[\w+\.]`匹配一个字符，该字符要么是“单词”字符（字母、数字或下划线），要么是加号或点。`[\w+\.]{3}`连续匹配三个这样的字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:01:45.453

`[]`是一个字符类，而不是一个子模式。`[abc]`匹配单个 a、b 或 c。

您可能的意思是`(\w+\.){3}`，它*与*您的第二个正则表达式匹配。

# perl - 将文本文件作为散列打开并在该散列中搜索

> ID：12943256
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:58:19.120
> 
> 标签：perl, hash

我有一个任务是编写一个 Perl 文件来打开一个 IP 地址及其主机名的文本文件，用新行分隔，然后将其加载到哈希中。然后我应该要求用户输入用户想要在文件中搜索的内容。如果找到结果，程序应该打印值和键，并再次请求输入，直到用户没有输入任何内容。我什至还没有接近尾声，但需要一些指导。我已经从这里和通过使用一些 Google-Fu 拼凑了一些代码。

这是我正在进行的工作：

```
#!/usr/bin/perl

print "Welcome to the text searcher! Please enter a filename: ";

$filename = <>;

my %texthash = ();

open DNSTEXT, "$filename"
    or die! "Insert a valid name! ";

while (<DNSTEXT>) {

    chomp;
    my ($key, $value) = split("\n"); 

    $texthash{$key} .= exists $texthash{$key} 
                     ? ",$value" 
                     : $value;
}
print $texthash{$weather.com}

#print "What would you like to search for within this file? "

#$query = <>

#if(exists $text{$query}) { 
```

可能很明显，我很迷茫。我不确定我是否将文件正确插入到哈希中，或者如何打印要调试的值。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-23T16:20:27.743

这里的问题是我们不知道输入文件是什么样的。假设输入文件以某种方式看起来像：

```
key1,value1
key2,value2
key3,value3 
```

（或其他类似方式，在这种情况下，键和值对用逗号分隔），您可以这样做：

```
my %text_hash;

# the my $line in the while() means that for every line it reads, 
# store it in $line
while( my $line = <DNSTEXT>) {
    chomp $line;

    # depending on what separates the key and value, you could replace the q{,} 
    # with q{<whatever is between the key and value>}
    my ( $key, $value ) = split q{,},$line; 

    $text_hash{$key} = $value;

} 
```

但是，是的，请告诉我们文件的内容是什么样的。

# android - 带有对话框的线程正在监听后退键，但我希望主要活动监听后退键

> ID：12943257
> 
> 赞同：-1
> 
> 时间：2012-10-17T20:58:19.753
> 
> 标签：android, android-dialog, onkeydown

我正在启动一个显示对话框的线程，如果我按后退键（执行一些逻辑来停止线程），则不会调用活动的 onKeyDown 侦听器。这是因为它被对话框的线程捕获......我怎样才能避免这种情况？

这是我的代码：

```
public static void getRemoteImage(final String url, final Handler handler) {
        Thread thread = new Thread(){ 
            public void run() {
                try {
                    Looper.prepare();
                    handler.sendEmptyMessage(Util.SHOW_DIALOG);
                    final URL aURL = new URL(url);
                    final URLConnection conn = aURL.openConnection();
                    conn.connect();
                    final BufferedInputStream bis = new BufferedInputStream(conn.getInputStream());
                    image = BitmapFactory.decodeStream(bis);
                    bis.close();
                    handler.sendEmptyMessage(Util.HIDE_DIALOG); 
                    Looper.loop();  
                }catch (Exception e) {e.printStackTrace();}
            }
        };
        thread.start();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:05:56.717

如果您使对话框可取消，则可以在您的活动中使用此代码。那你根本不用用`onKeyDownListener`。后退按钮自动调用该`onCancel()`方法。

`onCreateDialog`代码看起来像这样：

```
updatingDialog = new ProgressDialog(this);
updatingDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
updatingDialog.setMessage(getString(R.string.busy));
updatingDialog.setCancelable(true);
updatingDialog.setOnCancelListener(new OnCancelListener() {
    public void onCancel(DialogInterface dialog) {
        thread.interrupt();
    }
    }); 
```

显然，该`decodeStream`方法不能轻易中断（见评论）。更多信息在这里： [所以回答](https://stackoverflow.com/a/11998891/1110688)

# rjs - 动态设置文本字段 rjs rails 的值

> ID：12943259
> 
> 赞同：0
> 
> 时间：2012-10-17T20:58:23.597
> 
> 标签：rjs, ruby-1.8.7

我正在尝试通过 rjs 设置隐藏文本字段的值。我有一个表格。

```
<% form_tag :action => "upload" do %>
    <%= file_field_tag :zipfile %>
    <%= submit_tag "Upload" %>
    <%= hidden_field_tag "progress" %>
<% end %> 
```

我想根据单击浏览按钮时将创建的进度的 id 设置隐藏文本字段的值。

```
<script>
    $(document).ready(function() {
        $("input#zipfile").change(function() {
        $.ajax({
            url: "/progress_create",
            type: "GET"
            })
        });

    })
</script> 
```

progress_create 如下：

```
def progress_create
    @progress = Progress.create(:value => 0)
    respond_to do |format|
        format.js {}
    end
end 
```

我想我正在progress_create.js.rjs 文件中做一些事情，如下所示：

```
page<< %{
        $('#progress').val("<%= @progress.id %>");
        } 
```

我想将隐藏字段的值设置为@progress 的 id。但是，当我执行上述操作时，隐藏字段的值是“<%= @progress.id %>”字符串，而不是确切的 id。任何人都可以请纠正我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:56:28.257

```
page << "$('#progress').val(#{@progress.id});" 
```

这应该有效。干杯

# php - 将 html id 传递给 php/mysql，接收“无法读取未定义的属性 __e3_”

> ID：12943262
> 
> 赞同：0
> 
> 时间：2012-10-17T20:58:41.087
> 
> 标签：php, jquery, sql, ajax, google-maps

我正在制作一个谷歌地图，它将从数据库中提取信息并输出 xml 以解释为地图上的标记。我想将点击的元素 id 传递给 PHP 以过滤数据库结果。执行该函数时，我收到一条错误消息，指出“无法读取未定义的属性'_ *e3* '”。当我摆脱变量并直接在代码中输入类型时，一切正常。

相关的 jQuery

```
$(document).ready(function() {
        $('.map_item').toggle(
            function() {
                var itemid = this.id;
                $.ajax({
                    type: 'POST',
                    //php script takes info from database, outputs xml
                    url:'SQL.php',
                    //pass var to the php to select only items matching this id
                    data: 'variable1=' + itemid,
                    success: function(data) { 
```

来自文件 SQL.php 的相关 PHP

```
$ajax_var = $_POST['variable1'];
$query = 'SELECT * FROM location WHERE Type="' . $ajax_var . '"';
$result = mysql_query($query); //sqlsrv_query
header('Content-type: text/xml'); 

// Iterate through the rows, adding XML nodes for each

while ($row = @mysql_fetch_assoc($result)){   
// ADD TO XML DOCUMENT NODE  
$node = $dom->createElement('marker');  
$newnode = $parnode->appendChild($node);   
$newnode->setAttribute("dirtType",$row['dirtType']);
$newnode->setAttribute("lat", $row['lat']);  
$newnode->setAttribute("lng", $row['lng']);  
 } 

 echo $dom->saveXML(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:18:36.653

我会说数据应该以不同的方式发送，如下所示：

```
data: {
   "variable1": itemId
} 
```

# java - 猪拉丁程序，开关/其他错误

> ID：12943265
> 
> 赞同：3
> 
> 时间：2012-10-17T20:59:02.370
> 
> 标签：java, string, io, apache-pig

// 我的 else if 语句需要帮助。如果单词以元音开头，则在单词末尾添加方式。如果单词以辅音开头，则将辅音放在末尾并添加ay。

我的问题是，如果我有一个以元音作为第一个字母的单词，它就好像它有一个辅音一样贯穿。如果我输入“are”，我会得到“arewayreaay”而不是“areway”。

```
public class piglatin {
    public static void main(String[] args) {
        String str = IO.    readString();    
        String answer = "";

        if(str.startsWith("a"))
            System.out.print(str + "way");

        if(str.startsWith("e"))
            System.out.print(str + "way");

        if(str.startsWith("i"))
            System.out.print(str + "way");

        if(str.startsWith("o"))
            System.out.print(str + "way");

        if(str.startsWith("u"))
            System.out.print(str + "way");
        else{
            char i = str.charAt(0);
            answer = str.substring( 1, str.length());
            System.out.print(answer + i + "ay");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:02:59.057

```
if(str.startsWith("a") || str.startsWith("e") || str.startsWith("i") ... (and so on)) {
  System.out.print(str + "way"); 
} else{
  char i = str.charAt(0);
  answer = str.substring( 1, str.length());
  System.out.print(answer + i + "ay");
} 
```

or if / else if / else

Explanation:

```
//  combine all the if blocks together .. if you dont it checks for vowel 'a' and prints
//  'areay' then it checks for vowel 'u' and enters the else block .. where it again
//  operates on 'are' (check immutability of strings) gets charAt(0) i.e 'a' and prints
//  'rea' and since you concatenated 'ay' ... the final output = 'arewayreaay' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:03:27.343

Note that each of your leading `if` cases does the same work, and so you can instead collapse all of those into a single branch:

```
if (str.startsWith("a") || str.startsWith("e") || ...
    System.out.print(str + "way");
else
{
    // do the substring and append "ay" 
```

Aside from collapsing those branches, your problem is that each of your `if` statements after the first needs an `else`:

```
if(str.startsWith("a"))
    System.out.print(str + "way");
else if(str.startsWith("e"))
    System.out.print(str + "way");
// ... 
```

You only want *one* of your branches to execute. But consider what happens in your final `if/else`: you've already modified e.g., `"are"` as the result of your *first* `if` statement. Since you aren't using chained `if/else`, you'll get to your final set of tests:

```
if(str.startsWith("u"))
    System.out.print(str + "way");
else{ 
```

And you'll end up in the `else` case, since your string *doesn't* start with `"u"`. But you've already handled the string in an earlier `if` statement.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:03:24.190

What you have here is not a switch - the `else` is only attaching to the final `if`. Replace each `if` with `else if`, other than the first one, or combine the conditions like jakub suggested.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T21:07:21.900

我认为你的花括号搞砸了。它为 'a' 执行“if starts with”，但随后也为“u”执行“else”……所以你得到了两者。你可能的意思是：

```
public static void main(String[] args) 
{
    String str = IO.readString();
    String answer = "";

    if (str.startsWith("a"))
         System.out.print(str + "way");
    else if(str.startsWith("e"))
        System.out.print(str + "way");
    else if(str.startsWith("i"))
        System.out.print(str + "way");
    else if(str.startsWith("o"))
        System.out.print(str + "way");
    else if(str.startsWith("u"))
        System.out.print(str + "way");
    else
    {
        char i = str.charAt(0);
        answer = str.substring( 1, str.length());
        System.out.print(answer + i + "ay");
    }
} 
```

# java - 将对象存储在数组列表中

> ID：12943270
> 
> 赞同：2
> 
> 时间：2012-10-17T20:59:31.340
> 
> 标签：java, arraylist, multidimensional-array

当我在 Java 中使用数组列表时遇到一个小问题。本质上，我希望将数组存储在数组列表中。我知道数组列表可以保存对象，所以应该是可能的，但我不确定如何。

在大多数情况下，我的数组列表（从文件中解析）只是将一个字符作为字符串保存，但有时它会包含一系列字符，如下所示：

```
 myarray
0    a
1    a
2    d
3    g
4    d
5    f,s,t
6    r 
```

大多数时候，我唯一关心的位于位置 5 的字符串中的字符是 f，但有时我可能还需要查看 s 或 t。我对此的解决方案是制作一个这样的数组：

```
 subarray
0     f 
1     s
2     t 
```

并将子数组存储在位置 5 中。

```
 myarray
0    a
1    a
2    d
3    g
4    d
5    subarray[f,s,t]
6    r 
```

我试图用这段代码做到这一点：

```
 //for the length of the arraylist
 for(int al = 0; al < myarray.size(); al++){
      //check the size of the string
      String value = myarray.get(al);
      int strsz = value.length();
      prse = value.split(dlmcma);
      //if it is bigger than 1 then use a subarray
      if(strsz > 1){
          subarray[0] = prse[0];
          subarray[1] = prse[1];
          subarray[2] = prse[2];
      }
      //set subarray to the location of the string that was too long
      //this is where it all goes horribly wrong
      alt4.set(al, subarray[]);
  } 
```

这不是我想要的方式。它不允许我 .set(int, array)。它只允许 .set(int, string)。有人有建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:05:32.250

最简单的方法是使用 ArrayList 的 ArrayList。

```
ArrayList<ArrayList<String>> alt4 = new ArrayList<ArrayList<String>>(); 
```

但是，这可能不是最好的解决方案。您可能需要重新考虑您的数据模型并寻找更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:05:46.140

只需更改`alt4.set(al, subarray[]);`为

```
 alt4.add(subarray); 
```

我假设`alt4`是另一个定义`ArrayList<String[]>`的 . 如果不是，请定义如下：

```
 List<String[]> alt4= new ArrayList<String[]>(); 
```

或者

```
 ArrayList<String[]> alt4= new ArrayList<String[]>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:07:05.760

我的猜测是您将 alt4 声明为`List<String>`，这就是为什么它不允许您将 String 数组设置为列表元素的原因。您应该将其声明为`List<String[]>`and is 每个元素只是单数，只需将其设置为 String[] 数组的第 0 个元素，然后再将其添加到列表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:08:55.660

你可以切换到：

```
List<List<Character>> alt4 = new ArrayList<List<Character>>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T21:25:06.190

可能这就是你想要得到的

```
public class Tester {

    List<String> myArrays = Arrays.asList(new String[] { "a", "a", "d", "g", "d", "f,s,t", "r" });

    ArrayList<ArrayList<String>> alt4 = new ArrayList<ArrayList<String>>();

    private void manageArray() {
        // for the length of the arraylist
        ArrayList<String> subarray = new ArrayList<String>();
        for(int al = 0; al < myArrays.size(); al++) {
            // check the size of the string
            String value = myArrays.get(al);
            int strsz = value.length();
            String prse[] = value.split(",");
            // if it is bigger than 1 then use a subarray
            if(strsz > 1) {
                for(String string : prse) {
                    subarray.add(string);
                }
            }
            // set subarray to the location of the string that was too long
            // this is where it all goes horribly wrong
            alt4.set(al, subarray);
        }

    }
} 
```

# java - 我可以使用 Java 运行 .jasper 文件而不必即时编译 jrxml 吗？

> ID：12943272
> 
> 赞同：3
> 
> 时间：2012-10-17T20:59:42.257
> 
> 标签：java, jasper-reports

我总是在运行之前即时重新编译我们的*.jasper*报告。但我没有理由这样做。这需要很长时间，并且当其中四个报告同时运行时，它会占用我们新生产服务器上的 CPU。我们对设计所做的任何事情都不会让我们不得不这样做。但这是我知道的唯一方法：

```
JasperDesign jasperDesign = JRXmlLoader.load(reportFile);
JasperReport jasperReport = JasperCompileManager.compileReport(jasperDesign); 
```

我试图找出如何从*.jasper文件中实例化****JasperReport***对象，但我很挣扎。

 *任何快速指针都会有所帮助，在此先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T04:46:35.150

您可以在应用程序构建过程中使用 ant 任务`net.sf.jasperreports.ant.JRAntCompileTask`将所有 jrxmls 编译为 .jaspers，然后使用“JRLoader”从文件位置加载 JasperReport。

```
JasperReport rpt = (JasperReport)JRLoader.loadObjectFromFile(location); 
```*

# ajax - AJAX 帖子不适用于 HTTPS

> ID：12943274
> 
> 赞同：10
> 
> 时间：2012-10-17T20:59:56.453
> 
> 标签：ajax, jquery

我对 jquery post 函数有一个相当令人沮丧的问题，这可能源于不了解它是如何正常工作的。

我有一个函数应该将一些表单信息发布到我编写的 php 脚本中，然后该脚本针对 API 运行 curl 请求以绕过 javascript 的跨域策略。只要它提交到“http”，它似乎就可以正常工作，但是当我将它发送到“https”时，表单永远不会被提交。

我在我的电脑上运行了wireshark，它没有显示到目标ip的流量，直到我让url使用http。我在服务器上有基本的身份验证，所以我通过 url 传递用户和密码，但没有在那里进行测试并得到相同的结果。

这是不工作的代码：

```
$j.post("https://<api user>:<password>@<ip>:444/ProxyScript.php", 
         $j("#spoke_ticket").serialize(),
         function(msg) { 
              log_status(msg);
              fade_status();
              $j(':input','#createtheticket')
                   .not(':button, :submit, :reset, :hidden')
                   .val('')
                   .removeAttr('checked')
                   .removeAttr('selected');
               }); 
```

这是工作功能：

```
$j.post("http://<other ip>/ProxyScript.php",  
        $j("#spoke_ticket").serialize(),
        function(msg) { 
              log_status(msg);
              fade_status();
              $j(':input','#createtheticket')
                   .not(':button, :submit, :reset, :hidden')
                   .val('')
                   .removeAttr('checked')
                   .removeAttr('selected');
               }); 
```

关于为什么没有发送流量的任何想法？如果我遗漏了一些关键信息或任何内容，请告诉我。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:06:08.777

如果您正在从 http 页面到 https URL 进行 AJAX 发布，那么跨域策略就会生效，因为该协议也是原始规范的一部分，如此处[所述](http://en.wikipedia.org/wiki/Same_origin_policy)。浏览器将拒绝进行 AJAX 调用，这就是您看不到任何流量的原因。

这里讨论了一个解决方案：

[在 http 页面上使用 https 的 Ajax](https://stackoverflow.com/questions/1105934/ajax-using-https-on-an-http-page)

所以你最好的选择是现在大多数现代浏览器都应该支持的[Access-Control-Allow-Origin标头。](https://developer.mozilla.org/en-US/docs/HTTP_access_control)

因此，让您的服务器将以下标头添加到响应中：

```
Access-Control-Allow-Origin: https://www.mysite.com 
```

如果由于某种原因您无法强制执行此操作，那么剩下的唯一选择就是[JSONP](http://json-p.org)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:39:49.290

为什么不使用**代理**来解决跨域问题？听起来更容易。一个简单的例子是当我想检索丹麦政府国家地理数据的县、道路名称等（幸运的是，他们的数据是 json 或 XML 可选）

简化的proxy.php

```
<?
header('Content-type: application/json');
$url=$_GET['url'];
$html=file_get_contents($url);
echo $html;
?> 
```

在 ajax 中，获取县边界的纬度/经度

```
var url= "proxy.php?url=https://geo.oiorest.dk/"+type+"/"+nr+"/graense.json";           
$.ajax({
  url: url,
  dataType: 'json',
  success:  function (data) {
   ...

}); 
```

注意 https - url 可能是真实的例子，[https://geo.oiorest.dk/kommuner/0810/graense.json](https://geo.oiorest.dk/kommuner/0810/graense.json)

# c# - 为什么“WCF 测试客户端”会抢占我的 WCF 应用程序，我该如何避免？

> ID：12943277
> 
> 赞同：0
> 
> 时间：2012-10-17T21:00:26.250
> 
> 标签：c#, wcf, rest

我的简单示例 wcf 服务工作正常，但突然间它开始提示我在“WCF 测试客户端”对话框中输入端点地址。

我不记得更改任何会导致它从按 F5 时弹出浏览器（IE 8）到现在显示这个“WCF 测试客户端”的东西。

我不知道在它提供的编辑框中输入什么，所以我尝试了“http://localhost:4841/RestServiceImpl.svc”（http://localhost:4841/RestServiceImpl.svc/xml/123 仍然可以从在 Visual Studio 之外）

它接受了（“服务添加成功”显示在对话框的任务栏中），但什么也不做；并单击“我的服务项目”树视图什么都不做（它没有孩子）。

## 更新

如果我尝试直接从 IE8 运行新操作，我会得到：

## “/”应用程序中的服务器错误。

在合同“IRestServiceImpl”中，有多个使用方法“GET”和等效于“xml/{platypusId}”的 UriTemplate 的操作。每个操作都需要 UriTemplate 和 Method 的唯一组合来明确地发送消息。使用 WebGetAttribute 或 WebInvokeAttribute 更改操作的 UriTemplate 和 Method 值。

这是否意味着我只能有一个带字符串的 xml 返回操作？另一种/原始方法是 ...xml/{id}...

## 更新 2

这是代码，它仍然失败：

```
[ServiceContract]
public interface IRestServiceImpl
{
    [OperationContract(Name="Foo")]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "xml/{id}")]
    string XMLData(string id);

    [OperationContract(Name="FooBar")]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "xml/{platypusId, anotherId}")]
    string FirstTrial(string platypusId, string anotherId);

    [OperationContract(Name="FooFooBar")]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "json/{id}")]
    string JSONData(string id);
} 
```

// 实现 (.svc) 文件

```
public class RestServiceImpl : IRestServiceImpl
{
    public string XMLData(string id)
    {
        return "You requested product " + id;
    }

    public string FirstTrial(string platypusId, string anotherID)
    {
        return "I reckon so" + platypusId + anotherID;
    }

    public string JSONData(string id)
    {
        return "You requested product " + id;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:08:50.137

您可以拥有多个接受 String 并返回 XML 的方法，但您不能将它们命名为相同的东西并让它们都是 GET 方法。它怎么知道你打算打电话给哪一个？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:12:43.037

对于任何类型的 Web 服务，您都不能有重载的方法。如果您指定不同的 OperationContract Name EG，WCF 允许这样做

```
[ServiceContract]
interface IService
{
    [OperationContract(Name="Foo")]
    void Foo();

    [OperationContract(Name="Foobar")]
    void Foo(string bar);

} 
```

但这基本上是将公共签名更改为方法，即使它在接口中命名相同，所以我通常不会这样做，因为在创建客户端时可能会更加混乱。

更新：

确保在 web.config 中将 autoformateselectionenabled 设置为 true。

```
<endpointBehaviors>
    <behavior name="web">
        <webHttp automaticFormatSelectionEnabled="true"/>
    </behavior>
</endpointBehaviors> 
```

[“这将根据请求类型（JSON/XML）自动设置响应格式”](http://www.codeproject.com/Articles/386956/RestFul-WCF-JSON-Service-with-client-and-on-Mozill)

# node.js - How to capture streaming results with Prototype Ajax.request

> ID：12943283
> 
> 赞同：2
> 
> 时间：2012-10-17T21:00:38.063
> 
> 标签：node.js, prototypejs, prototype

High Level Overview:

I have a nodejs expressjs server that makes use of the PostgreSQL nodejs driver called pg. I have a html file served to the client browser that when you click a button invokes a expressjs route on my expressjs server. This route will select data out of a PostgreSQL database and return it to the client html file. The problem is the route emits a response for every row selected in the query to the database. All the client (html browser) gets is the first row. I can write to the nodejs console server side and get all the rows to be displayed, but obviously that does me know good on my webpage.

Question: How do I get my client html file to write to console on the client for every row emitted out of my expressjs route /pg? My assumption was on the client that the onSuccess would be fired for every row emitted out of my expressJS route.

NodeJS\ExpressJS Server File:

```
var express = require('express');
var pg = require('pg');

var app = express();

var MemoryStore = express.session.MemoryStore;

var conString = "postgres://joe_user:password@localhost/dev_db";

var client = new pg.Client(conString);
client.connect();

app.get('/home', function(req,res){
 res.sendfile(__dirname + '/views/index.html');
});
app.use(express.bodyParser());
app.use(express.cookieParser());
app.use
(
express.session
(
{ 
    key: 'some-key',
    secret: 'some-We1rD sEEEEEcret!',
    cookie: { secure: true },
    store: new MemoryStore({ reapInterval: 60000 * 10 }) 
}
)
);

app.use
(
function(err, req, res, next)
{
  // logic
  console.error(err.stack);
  res.send(500, 'Something broke!');
}
);

app.get('/pg', function(req, res)
{

   var  query = client.query("SELECT * FROM junk_data;"); //Returns 7000 rows with 8 columns total

query.on('row', function(row) 
{
   res.send(row);
   console.log(row);
}

);

}

);

process.on('uncaughtException', function (err) {
    console.log(err);
});

app.listen(4000); 
```

HTML File:

```
<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Demo: dojo/request/xhr</title>
        <!--<link rel="stylesheet" href="style.css" media="screen">-->
        <!--<link rel="stylesheet" href="../../../resources/style/demo.css" media="screen">-->
    </head>
    <body>
        <h1>Demo: dojo/request/xhr</h1>
        <p>Click the button below to see dojo/request/xhr in action.</p>
        <div>

            <button id="textButton2" onclick="SubmitPGRequest();">Call Express Route For PostgreSQL</button>
            <!--<input type="button" value="Submit" onclick="SubmitRequest();"/> -->
        </div>
        <br /><br />
        <div id="resultDiv">
        </div>
        <!-- load dojo and provide config via data attribute -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.7/prototype.js"></script>
        <script>

function SubmitPGRequest()
{
            new Ajax.Request( '/pg', {
              method:  'get',
              onSuccess:  function(response){
                <!--alert(response.responseText); -->
                if(response.done) {
                alert('Done!');
                }else {
                console.log(response.responseText);}
              },
              onFailure:  function(){
                alert('ERROR');
              }
});
}
        </script>
    < 
```

/body>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T22:21:10.987

Ok so I figured out an answer to my question.

With the nodejs pg driver you can just send all the rows in the result object once the query has completed(end) and send them in one go. Below is what I ended up having in my expressjs server route to send all rows back the client.

```
//fired once the function above has completed firing.    
query.on('end',(result) 
{
    res.send(result.rows);//send all rows back to client.
} 
```

# ruby-on-rails-3 - 如何使用 rake 检测失败的单元测试

> ID：12943284
> 
> 赞同：3
> 
> 时间：2012-10-17T21:00:38.100
> 
> 标签：ruby-on-rails-3, rake

我正在使用 Ruby 1.9.3 和 Rails 3.2.8。这使用 rake 0.9.2.2。

我希望检测失败的单元测试，在 Rails 2.3 中，我们通过检查退出代码来做到这一点。这不再有效。

我尝试：

```
rake test:units TEST=test/unit/failing_test.rb RAILS_ENV=test && echo "OK" 
```

failed_test.rb 由一个断言为假的测试组成。我希望看到测试失败而不是看到“OK”，但相反，我看到：

```
Started
F
===============================================================================
Failure: <false> is not true.
test: failing test case should fail. (FailingTest)
test/unit/failing_test.rb:6:in `block (2 levels) in <class:FailingTest>'
shoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `call'
shoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `block in create_test_from_should_hash'
activesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:72:in `block in run'
activesupport (3.2.8) lib/active_support/callbacks.rb:425:in `_run__3774233495015181374__setup__985181848351195933__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
activesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:70:in `run'
===============================================================================

Finished in 0.002753 seconds.

1 tests, 1 assertions, 1 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications
0% passed

363.24 tests/s, 363.24 assertions/s
rake aborted!
Command failed with status (1): [/Users/chris/.rvm/rubies/ruby-1.9.3-p194/b...]

Tasks: TOP => test:units
(See full trace by running task with --trace)
OK 
```

具体来说，我看到“命令失败，状态为 (1)”，但这似乎被 rake 吃掉了，因为我也看到了“OK”。请注意，如果我这样做`echo $?`，我会看到退出代码为 0（成功）。我试图让它在我们的持续集成和发布脚本的上下文中工作，两者都假设在发生错误的情况下退出代码将是非零的，就像 Rails 2.3 发生的那样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T22:53:32.293

我使用相同的 rails/ruby/rake 失败的测试与`1`你的不同。也许你有一些东西在调用`at_exit { exit 0 }`或`trap('EXIT') { exit 0 }`在你的代码库中的某个地方。这将修改 rake 的退出代码。

如果您想要一种检测故障的非 Ruby 方法，您可以尝试使用`grep`. `grep`如果找到匹配项，则返回 0，否则返回 1。

正则表达式查找，如果找到则`" 0 failures, 0 errors"`返回，否则返回。`0``1`

```
rake test:units TEST=test/unit/failing_test.rb RAILS_ENV=test | \
  tee >(xargs -0 echo {}) | \ 
  grep '\([[:space:]]0[[:space:]]\)failures,\1errors' && 
  echo OK 
```

# wpf - WPF 将窗口置于前面

> ID：12943285
> 
> 赞同：0
> 
> 时间：2012-10-17T21:00:40.810
> 
> 标签：wpf, window, visibility

当通过 DragMove 将窗口拖动到特定区域时，我想在该区域显示半透明窗口覆盖。

显示窗口工作正常，但它总是会出现在我拖动的窗口的顶部。

在显示叠加层后，我尝试了各种方法，例如 .focus/.activate ，但它们不起作用。

每个窗口都有`WindowStyle="None" Topmost="True" ShowInTaskbar="False"` ，覆盖窗口甚至有`IsHitTestVisible="False" Focusable="False"`。不过，当它的可见性被切换时，覆盖仍然会获得焦点。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-17T21:00:40.810

我发现唯一可以工作的就是隐藏我的主窗口，然后再次显示它。不过，我不希望它闪烁，所以我在执行此操作时禁用了调度程序。这最终工作得很好。我在网上找不到任何类似的问题，所以我想我会发布这个来帮助下一个人。

```
private void showOverlay()
{
  //show the docking window
  _overlayWindow.Visibility = Visibility.Visible;

  //problem here will be that the overlay window will be on top of main
  //this.focus   this.activate +other efforts did not work to bring main back on top

  //only thing i could find that would bring the main win on top is to hide/show it again.
  //i wrap this hide/show in a disabled dispatcher block so that the window never really gets hidden on screen

  using (var d = Dispatcher.DisableProcessing())
  {
    this.Visibility = Visibility.Hidden;
    this.Visibility = Visibility.Visible;
  }
} 
```

# ruby-on-rails - 在 rails 视图中查看数组或一条记录

> ID：12943289
> 
> 赞同：0
> 
> 时间：2012-10-17T21:00:49.987
> 
> 标签：ruby-on-rails, ruby, activerecord

在我的方法中通过一些计算获取数据，然后我需要在视图中查看它，但是如果写

`@ar.each do |a|`

当我只有一个记录时，我得到错误，当我有一个错误时，每个错误都是坏主意。那么如何做到这一点呢？

所以我在方法中有这样的代码：

```
non_original = []
@articles.each do |a|
  non_original << get_non_tecdoc("LA44", 1, "KNECHT")
end
@non_original = non_original 
```

get_non_tecdoc 返回对象，或者什么都没有......

所以在我看来，我有：

```
-@non_original.each do |no|
      =no.brand
      =no.description
      =no.price
      =no.quantity 
```

但是如果@non_original 有一条记录怎么办，然后@non_original.each 给出错误。那么如何做检入视图呢？如果@non_original 有一条记录，而不是简单的@non_original.brand 等，但如果不止一条，则使用每个循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:06:18.527

这将与 @ar 作为单个值以及数组一起使用：

```
Array(@ar).each do |a|
  p a
end 
```

这是[Kernel](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-Array)`Array`上的一种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:07:54.803

```
<%= debug @ar %> 
```

这将为您提供一个不错的 YAML 格式，以便在您的视图中查看（假设 ERB）。

**编辑**：我相信这就是你想要的，因为你对调试不感兴趣。

在您的控制器中，使用 splat 运算符将单例元素转换为数组（它不会修改数组）：

```
@ar = *@ar 
```

然后`@ar.each`将在您看来按预期工作。

或者，您可以检查您的视图：

```
<% if @ar.is_a?(Array) %>
  <% @ar.each ... %>
<% else %>
  <%= @ar %>
<% end%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:58:59.973

只要@ar 是一个数组，就不会出现错误。如果您要返回一条记录，请将其更改为具有一条记录的数组。

如果您使用“where”子句等[活动记录查询接口；](http://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects)它将返回一个包含 0 个或多个 active_record 对象的数组。如果您使用 find ，它将返回一个 active_record 对象的实例。

因此，如果您的查询方法使用活动记录 where 子句 @ar 应始终返回一个数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:04:16.843

Why don't you try using @ar.inspect and output it to the console to see the instance variables contents.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-17T21:08:13.947

请试试这个：

```
Tablename.find_by_table_id 
```

例子：

如果 account_id 为 10，则以以下示例为例，

```
@getResults = Account.find_by_account_id(10) 
```

它将给出单个记录。我们可以使用@getResults.id,@getResults.name ....同样明智地获取值。

# python - builtins.AttributeError：“str”对象没有属性“name”

> ID：12943297
> 
> 赞同：1
> 
> 时间：2012-10-17T21:01:33.567
> 
> 标签：python, attributes, python-3.x

文件 1：

```
class Rogue():
    def __init__(self):
        self.name = "Rogue"
        Hero.__init__(self.name, None)

'''class Barbarian(Hero):
    Hero.__init__(self, name, bonuses)

class Mage(Hero):
    Hero.__init__(self, "Mage", bonuses)'''

class Hero(Tile):
'''A class representing the hero venturing into the dungeon.
Heroes have the following attributes: a name, a list of items,
hit points, strength, gold, and a viewing radius. Heroes
inherit the visible boolean from Tile.'''

def __init__(self, name, bonuses=(0, 0, 0)):
    '''(Hero, str, list) -> NoneType
    Create a new hero with name name,
    an empty list of items and bonuses to
    hp, strength, gold and radius as specified
    in bonuses'''

    self.name = name
    self.items = []
    #Rogue
    if self.name == "Rogue":
        self.hp = 10 + bonuses[0]
        self.strength = 2 + bonuses[1]
        self.radius = 2 + bonuses[2]
    #Barbarian
    elif self.name == "Barbarian":
        self.hp = 12 + bonuses[0]
        self.strength = 3 + bonuses[1]
        self.radius = 1 + bonuses[2]
    #Mage
    elif self.name == "Mage":
        self.hp = 8 + bonuses[0]
        self.strength = 2 + bonuses[1]
        self.radius = 3 + bonuses[2]

    Tile.__init__(self, True) 
```

* * *

文件 2：

```
class GameScreen:
    '''Display the current state of a game in a text-based format.
    This class is fully implemented and needs no
    additional work from students.'''

def initialize_game(self):
    '''(GameScreen) -> NoneType
    Initialize new game with new user-selected hero class
    and starting room files.'''

    hero = None
    while hero is None:
        c = input("Select hero type:\n(R)ogue (M)age (B)arbarian\n")
        c = c.lower()
        if c == 'r':
            hero = Rogue()
        elif c == 'm':
            hero = Mage()
        elif c == 'b':
            hero = Barbarian()

    self.game = Game("rooms/startroom", hero) 
```

有多个不同的文件，但这些是唯一重要的部分。上面的代码要求输入，然后根据输入调用英雄类。类是我必须创建的部分。我创建了一个 Rogue 类，我在其中使用特定参数调用 Hero。我收到以下错误：

```
File "/Users//Documents/CSC148/Assignment 2/hero.py", line 7, in __init__
Hero.__init__(self.name, None)
  File "/Users//Documents/CSC148/Assignment 2/hero.py", line 30, in __init__
self.name = name
builtins.AttributeError: 'str' object has no attribute 'name' 
```

我没有更改字符串，我只是检查它是否存在。为什么它告诉我字符串没有简单的“self.name”构造函数的属性名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:15:44.037

当你这样做时会发生什么

```
Hero.__init__(self.name, None) 
```

是'self'参数没有作为第一个参数隐式传递。因此，在这种情况下，您实际上传递了一个字符串 (self.name) 作为第一个参数（而不是 self）和 None 而不是 'name' 参数。如果 'bonuses' 不是关键字参数，则此调用将产生`TypeError: __init__() takes exactly 3 arguments (2 given)`

所以： self.name 代表 self None 代表名字，bonus 被初始化为默认值 (0, 0, 0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:05:58.677

`Hero.__init__`初始化一个`Hero`对象。要构造一个新的 Hero 对象，你必须调用`Hero`. 因此，在 中`Rogue.__init__`，线

```
Hero.__init__(self.name, None) 
```

有故障。你要么想创建一个新的英雄对象：

```
class Rogue:
    def __init__(self):
        self.name = "Rogue"
        self.enemy = Hero(self.name, None) 
```

或让`Rogue`成为 的子类`Hero`：

```
class Rogue(Hero):
    def __init__(self):
        super().__init__("Rogue", None) 
```

# php - 将 PHP 从开发推向生产

> ID：12943298
> 
> 赞同：1
> 
> 时间：2012-10-17T21:01:36.123
> 
> 标签：php, mysql, xampp, filezilla, bluehost

我已经开发 PHP 页面好几个星期了，对我的代码越来越有信心了。我已经通过 Bluehost 获得了一个托管帐户，并准备开始制作一些实时页面。以前我一直在 Windows 上使用 XAMPP，并在本地计算机上开发我的所有页面。我正在尝试确定在本地创建我的页面然后轻松将其移动到我的托管服务器的最佳实践。我使用 Filezilla 传输文件。以下是我的主要问题：

1.) 如何确保我的本地和实时 MySQL 数据库保持同步？我一直在本地手动创建数据库，然后采用相同的代码并将其应用于我的实时服务器。（我在本地和实时服务器上有 phpmyadmin，但不知道如何使用它来简化此过程）

2.) 在将所有文件从本地服务器移动到实时服务器之前，我必须更改所有文件的 mysql 密码和连接凭据。有没有解决的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:03:32.543

对于问题 1，您可以在每次上传时转储数据库并在生产端导入它，或者您可以使用 mysql 复制。

**对于问题 2，将数据库连接详细信息放在单独的 php 文件中，然后将该文件包含**在需要连接到数据库的每个页面的顶部是很常见的

然后您可以只更改一个文件，或者只上传一个带有生产数据库详细信息的文件。

数据库.php

```
<?php
$dbuser="";
$dbpass="";
$dbname="";
$dbserver="";
?> 
```

我的文件.php

```
<?php
include("db.php");
$conn = mysql_connect($dbserver, $dbuser, $dbpass);
mysql_select_db($dbname);
//....
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:06:23.087

您可以将 mysql_connect() 主机指向新服务器的 IP 地址。因此，无论您的代码在哪里，它都会连接到套接字。

```
$link = mysql_connect('<your ip here>', 'mysql_user', 'mysql_password'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:07:50.587

我总是制作我的项目，因此我必须更改 1 行代码才能在开发和生产之间波动。

我有一个基本文件，我在其中指定我的环境，如下所示：

```
$env = 'dev' 
```

然后在我的数据库设置变量中，我有这样的东西：

```
if($env == 'dev') {
    specify dev variables
} else if($env == 'prod') {
    specify prod variables
} 
```

这样做的好处是，当我想在 dev 和 prod 之间移动时，我只需要更改 1 个变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:09:42.827

使用版本控制系统，如 svn 或 git；查看用于数据库管理的 phpmig，查看 capistrano 等部署工具，确保在生产服务器的副本上进行测试（即使您只是使用虚拟主机）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T21:14:44.877

我和你的情况差不多，这就是我打算这样做的方式。

1.  我不打算将本地数据库与实时数据库同步，而是在完成后将本地数据库一次移动到在线数据库。我这样做的方法是，在 PHPMyAdmin 中选择我想要的数据库并将其导出为 .sql 文件。然后在在线服务器上，我只需导入该文件。

2.  我知道的最好的方法是有一个单独的文件，其中有一个看起来像这样的函数：

    `function connectToDB(){ $mysqli = new mysqli("localhost", "root", "123", "myDatabase"); return $mysqli; }`

    然后，当您想使用它时，只需将文件导入其他 PHP 文件的顶部并像这样使用它：

    `$mysqli = connectToDB();`

这是我的做法。如果有人知道更好的方法，我会很高兴知道。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-17T21:48:00.010

从开发部署到生产不是一项简单的任务，而且可能非常复杂。公司投入大量资源以使部署成为一个合乎逻辑且稳定的过程。我建议将您的问题分解并提出更具体的问题。

作为对您的问题的回答，我会做什么：

1）当部署需要更改数据库结构时，将这些更改写在 sql 脚本中。部署时，您需要运行这些脚本并更新代码（如您所见，中间的时间会使应用程序不稳定或损坏）。在任何事情之前，将生产数据库的副本带到开发中，并首先在开发中尝试脚本。每次部署时，您都会使数据库同步。

2）如何保存密码取决于您是否使用框架。遵循框架，这是定义环境变量并根据环境（开发或生产）设置密码的好方法。

至于代码部署，即使您是一个独特的开发人员，我也会使用 svn 或 git 将您的项目保存在版本控制之下。如果您为每个部署创建标签，它将使代码更新更加简单，并帮助您在需要时回滚。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-18T00:13:52.280

最佳实践是编写数据库迁移脚本，对其进行版本控制。然后每次上传到生产环境时，将这些版本的值存储在数据库中。只运行您以前没有运行过的版本。

在存储库之外有不同的本地配置文件。这允许您使用主配置文件在 repo 中维护必要的应用程序配置，然后本地配置文件覆盖数据库和环境设置。

# wcf - 服务器拒绝了会话建立请求：WCF 托管在 IIS 上

> ID：12943299
> 
> 赞同：3
> 
> 时间：2012-10-17T21:01:42.467
> 
> 标签：wcf, iis

我们在 IIS 应用程序中实现了一些 WCF 服务，通过默认端口 (808) 上的 net.tcp 进行通信，使用 Microsoft Net.Tcp 端口共享服务，在生产服务器上引发错误。当我实例化与第一个服务的连接时，我得到一个异常：

> 服务器`<URL>`拒绝了会话建立请求。所有其他服务都响应良好。

但它在我们的测试服务器上运行良好。

我最初认为失败的特定服务有问题，但我尝试将服务列表重新排列成不同的顺序，它似乎总是我遇到的第一个失败的服务。（我说 SEEMS 是因为它认为在测试的早期迭代中，我看到它发生在它命中的第二个服务上。但我无法重现它。）

我查看了应用程序启动延迟，这似乎不是问题，因为我可以在测试完成后立即返回并再次运行测试 - 仅延迟一两分钟 - 并得到相同的错误. 此外，在较低级别的环境中，启动延迟可能为 30 秒到一分钟，但结果仍如预期的那样返回。

我尝试从 INetManager 通过 http 访问服务，但所有服务都出现间歇性故障 - 特定服务将在调用时返回黄屏死机，然后在下一个服务上提供到 WSDL 的预期链接几秒钟后。

我完全无法解释这种行为，或者如何解决它。我已经用谷歌搜索了错误消息，但没有发现任何有用的信息。这可能是一个配置问题——生产服务器是新配置的虚拟机，我们可能没有完全正确的配置（而所有较低级别的环境已经运行这个和其他类似的应用程序有一段时间了），但我不知道是什么寻找。我查看了运行应用程序的应用程序池的属性，并将其与较低级别的环境进行了比较，没有发现任何差异。

如果有人能指出我正确的方向，我将永远感激你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T12:24:50.807

我能找到的东西：

* * *

> [http://go4answers.webhost4life.com/Example/connect-busy-wcf-service-host-while-725.aspx](http://go4answers.webhost4life.com/Example/connect-busy-wcf-service-host-while-725.aspx)：
> 
> [`MaxConcurrentSessions`](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.servicethrottlingbehavior.maxconcurrentsessions.aspx)（默认值 = 10） [Per-channel] 服务一次可以接受的最大会话数。仅与基于会话的绑定（wsHttp 或 netTcp）一起使用"

* * *

> [http://blogs.infosupport.com/unable-to-generate-a-wcf-proxy-using-svcutil-but-retreiving-the-wsdl-works/](http://blogs.infosupport.com/unable-to-generate-a-wcf-proxy-using-svcutil-but-retreiving-the-wsdl-works/)
> 
> 所以最后的诀窍是在 c:\windows\temp 文件夹中为您的 App Pool Identity 添加额外的权限 [使服务能够生成元数据] 以解决问题。

* * *

此外，是否配置了超时或其他限制并被击中？使用WcfTestClient进行[跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)并访问该服务，看看您是否可以找到潜在的错误。

# r - getSymbols 中的错误，对于多个符号请求必须使用 auto.assign=TRUE

> ID：12943303
> 
> 赞同：2
> 
> 时间：2012-10-17T21:02:06.530
> 
> 标签：r, quantmod

我正在尝试编写一个程序，该程序将获取股票代码的 .csv 文件，并针对协整等问题对它们进行相互测试。但是，当我运行以下代码时，quatnmod 给了我一些关于必须对多个符号请求使用 auto.assign = TRUE 的信息。

```
getprices<-function(sym){
  #get prices from last 7 years
  prices<-getSymbols(sym, from = Sys.Date() - (365*7), auto.assign=FALSE)
  #exract closing prices
  prices<-Cl(prices)

  return(prices)}

symbols1 <- c('TSN', 'MSFT')
symbols2 <- c('AAPL', 'NFLX')

container<-c()
addprices <- function(symbols1, symbols2){
   for (i in symbols1){
    for (g in symbols2){
      i<-getprices(i)
      g<-getprices(g)
      container <- i+g
      }
     }
    return(container)
    } 
```

当我运行 addprices(symbols1, symbols2) 我得到这个错误：

```
Error in getSymbols(sym, from = Sys.Date() - (365 * 7), auto.assign = FALSE) : 
  must use auto.assign=TRUE for multiple Symbols requests
Calls: addprices -> getprices -> getSymbols 
```

我知道当我这样做时我应该得到那个错误，我相信这就是错误所指的：

```
getSymbols(sym, from = Sys.Date() - (365 * 7), auto.assign = FALSE) 
```

但是，我正在做的不是那样，那又是什么呢？有什么建议吗？有解决办法吗？

我用谷歌搜索了这个，真的没有任何相关的问题/答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:03:26.563

问题是您在 for 循环中覆盖了迭代`i`器`g`。第一次迭代`g`工作正常，但`i`不再`symbols1[1]`在第二次迭代中......它是来自`getprices(i)`.

# html - 防止 DIV 包装在父级中

> ID：12943305
> 
> 赞同：2
> 
> 时间：2012-10-17T21:02:14.750
> 
> 标签：html, css

我经常遇到这个问题，这通常会导致我花费更多时间来尝试解决问题。本质上，它是一个简单的布局，如下所示：

HTML：

```
<div id="container">
  <div id="items">
    <div class="item">
      (data here)
    </div>
    <div class="item">
      (data here)
    </div>
    <div class="item">
      (data here)
    </div>
    <div class="item">
      (data here)
    </div>
    -- repeats --
  </div>
</div> <-- end container --> 
```

# CSS

```
#container {
  margin: 0 auto;
  width: 980px;
  overflow: hidden;
}
#items {
  float: left;
  width: 980px;
  min-height: 1000px;
}
#items .item {
  float: left;
  width: 230px;
  height: 230px;
  margin-right: 20px;
  margin-bottom: 20px;
} 
```

我的预期结果是有一个 4 x 4 网格显示项目。正如您从上面的 CSS 中看到的那样，我为每个项目添加了右边距，以便将它们隔开。唯一的问题是每行中的第四个项目下降到下一行（这显然是由于项目的右边距引起的）：

(230 x 4) = 920 + (20 x 4) = 80 = 1000（但容器宽度为 980）。因此，我得到的不是每行 4 个项目，而是三个。

如果不包括每四个项目的右边距，则所有四个项目都完全符合父 DIV 的约束。我知道我可以为第四个项目添加一个单独的类并将其右边距设置为 0px 但这意味着我必须在动态显示产品时在我的脚本中添加额外的检查。

理想情况下，我想要一个在所有主要浏览器和 IE7 中都能正常工作的纯 CSS 解决方案。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:07:49.127

您可以尝试使用百分比而不是固定宽度`items`。

```
#items .item {
    float: left;
    width: 23%;
    height: 230px;
    margin-right: 2%;
    margin-bottom: 20px;
} 
```

小提琴：http: [//jsfiddle.net/kboucher/Mv7sh/](http://jsfiddle.net/kboucher/Mv7sh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:11:15.210

要定位元素的每第四个子元素，您可以使用`:nth-child(x)`，但 IE8 和更早版本不支持。[w3schools 文档](http://www.w3schools.com/cssref/sel_nth-child.asp)

`:last-child`不会真的这样做，因为你必须包装每组四人。

但是，根据您的设计，**225**而不是**230**的宽度和高度将在**980**处与边距保持一致。

除非您有特定的理由只拥有 margin-right，否则您可以将其拆分为**10**`margin-right`的`margin-left`值。

# c# - 活动目录连接 C#

> ID：12943308
> 
> 赞同：2
> 
> 时间：2012-10-17T21:02:22.633
> 
> 标签：c#, .net, active-directory, connection-string

我的目的是在控制台 C# 应用程序中连接到 Active Directory（在虚拟机 (Win SRV 2008R2) 上运行）并记下域中的所有用户名。由于我是 AD 的新手，我只是在设置连接时遇到了困难。

现在第一件事就是第一；

根域名 = frt.local

IP : 192.168.xx

用户名：管理员

通行证：yyyy

我编写了下面的代码来设置连接但出现错误。请告诉我我错过的重点。

```
DirectoryEntry entry = new DirectoryEntry();
entry.Path = "LDAP://192.168.x.x/dc=frt.local";
entry.Username = @"frt.local\admin";
entry.Password = "yyyy"; 
```

在指出我错过的任何帮助之后，关于将用户名写到控制台的任何帮助都会受到欢迎。

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:23:32.883

```
 var username = "your username";
  var password = "your password";
  var domain = "your domain";
  var ctx = new PrincipalContext(ContextType.Domain, domain, username, password);

  using (var searcher = new PrincipalSearcher(new UserPrincipal(ctx)))
  {
    foreach (var result in searcher.FindAll())
    {
      DirectoryEntry de = result.GetUnderlyingObject() as DirectoryEntry;
      Console.WriteLine("First Name: " + de.Properties["givenName"].Value);
      Console.WriteLine("Last Name : " + de.Properties["sn"].Value);
      Console.WriteLine("SAM account name   : " + de.Properties["samAccountName"].Value);
      Console.WriteLine("User principal name: " + de.Properties["userPrincipalName"].Value);
      Console.WriteLine();
    }
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T05:08:22.133

Nesim 的回答很好——一开始。但我真的不认为使用它有任何意义或需要

```
DirectoryEntry de = result.GetUnderlyingObject() as DirectoryEntry; 
```

行 - PrincipalSearcher 的结果已经是 UserPrincpial 并且您可以像这样更轻松地访问它的属性：

```
using (var searcher = new PrincipalSearcher(new UserPrincipal(ctx)))
{
   foreach (var result in searcher.FindAll())
   {
       UserPrincipal foundUser = result as UserPrincipal;

       if(foundUser != null)
       {
           Console.WriteLine("First Name: {0}", foundUser.GivenName);
           Console.WriteLine("Last Name : {0}", foundUser.Surname);
           Console.WriteLine("SAM account name; {0}", foundUser.SamAccountName);
           Console.WriteLine("User principal name: {0}", foundUser.UserPrincipalName);         
           Console.WriteLine();
       }
   }
} 
```

已经并且非常好地将`UserPrincipal`最常用的属性公开为对象本身的属性 - 不需要带有`DirectoryEntry`...的相当混乱的代码

# java - Get Value from JComboBox

> ID：12943313
> 
> 赞同：4
> 
> 时间：2012-10-17T21:02:38.377
> 
> 标签：java, swing, jbutton, jcombobox, listcellrenderer

I have `JComboBox` with 2 columns and I have `JButton`. When I click the `JButton`, I need to get the result of the `JComboBox` selected value from first column and seconds column separately...

How do I this?

Also: how do I set the header of that JComboBox ?

The Code:

```
 public class Combo extends JFrame implements ActionListener{
    private JComboBox combo = new JComboBox();
    private JButton button = new JButton();
    public Combo() {

        setLayout(new FlowLayout());
        combo.setRenderer(new render());

        add(combo);

        combo.addItem(new String[] {"1","bbb"});
        combo.addItem(new String[] {"2","ff"});
        combo.addItem(new String[] {"3","gg"});
        combo.addItem(new String[] {"4","ee"});

        add(button);
        button.addActionListener(this);
        pack();
    }

    public static void main(String[]args){
        new Combo().setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if(e.getSource()==button){
            System.out.println(combo.getSelectedItem());
        }
    }
}
class render extends JPanel implements ListCellRenderer{

    private JLabel label1 = new JLabel();
    private JLabel label2 = new JLabel();
    private JLabel label3 = new JLabel();
    private JLabel label4 = new JLabel();
    private JLabel label5 = new JLabel();

    public render() {
        setLayout(new GridLayout(2,5));
        add(label1);
        add(label2);   
    }

    @Override
    public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
        String[] values = (String[]) value;
        label1.setText(values[0]);
        label2.setText(values[1]);
        if(index ==0){
            label1.setForeground(Color.red);
            label2.setForeground(Color.red);
        }else{
            label1.setForeground(Color.white);
            label2.setForeground(Color.white);
        }

        return this;
    }

} 
```

Thanks.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-17T21:07:55.707

您的项目是字符串数组，因此您可以按如下方式打印所选项目：

```
System.out.println(Arrays.toString((String[])combo.getSelectedItem())); 
```

*编辑：*

```
String[] selectedItem = (String[])combo.getSelectedItem();
for (int i = 0; i < selectedItem.length; i++){
    System.out.println(String.format("item %s = %s", i, selectedItem[i]));
} 
```

或者很快，如果您只需要第一项 - `(String[])combo.getSelectedItem())[0]`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:16:15.267

要显示所选元素的第一个值，您可以使用：

```
System.out.println(((String[])combo.getSelectedItem())[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-13T21:54:24.847

我认为这可能比以前的答案更容易：

```
(String) comboBox.getSelectedItem(); 
```

# python - 多用户python App中用户登录的集中跟踪

> ID：12943317
> 
> 赞同：1
> 
> 时间：2012-10-17T21:02:49.090
> 
> 标签：python, python-3.x, python-2.7, wxpython

我用python开发了UI（用户界面）应用程序，这个应用程序可以被n个用户同时访问（多用户业务应用程序）。

请帮助我构建集中式记录器程序，在访问 UI 业务应用程序时提供所有用户日志信息，记录器程序结果应类似于：用户、错误、警告、时间戳、查询触发等。稍后此信息将存储在数据库中（我会注意存储到数据库）。为此，我在下面进行了三合会，但没有运气获得所有用户记录器信息。

```
 import logging
 logging.basicConfig(level=logging.DEBUG,
                     format='%(asctime)s %(name)-12s %(levelname)-8s %(message)s',
                     datefmt='%m-%d %H:%M',
                     filename='/temp/myapp.log',
                     filemode='w')
 console.setLevel(logging.INFO) 
 logger1.debug('Quick zephyrs blow, vexing daft Jim.')
 logger1.info('How quickly daft jumping zebras vex.')
 logger2.warning('Jail zesty vixen who grabbed pay from quack.')
 logger2.error('The five boxing wizards jump quickly.') 
```

请建议正确的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T17:24:52.913

我推荐你 Twiggy 包（BSD 许可证），它使这项工作变得容易。您可以创建一个“主”记录器对象，当您调用方法 fields(...) 时，它会返回一个新的记录器对象，其中包含字段父项和新字段。例如：

我的日志文件

```
import twiggy as twg

twg.quickSetup()

logs = {
    'user1': twg.log.fields(user='user1'),
    'user2': twg.log.fields(user='user2')
} 
```

在其他文件中，您可以通过这种方式调用适当的记录器：

```
import mylog

mylog.logs['user1'].error("Start script") 
```

输出将是

> 错误：用户=用户1：启动脚本

这只是一个简单的例子。

您可以自定义输出、过滤消息并添加其他输出目标（也是数据库）。它很简单而且很pythonic。

[http://twiggy.wearpants.org/](http://twiggy.wearpants.org/)

# google-chrome - Chrome Developer Tools> Open on all pages

> ID：12943319
> 
> 赞同：3
> 
> 时间：2012-10-17T21:02:58.877
> 
> 标签：google-chrome, google-chrome-devtools

The above functionality is available on Firefox Firebug and is really useful when working with pages that are using popups/new tabs etc.

I can't see it in the usual places for Google Chrome and wondered if it was available? ... if so ... any pointers please :)

Thanks

# ruby-on-rails - Facebook 应用程序的 Ajax 安全性？(Ruby on Rails)

> ID：12943320
> 
> 赞同：0
> 
> 时间：2012-10-17T21:03:04.530
> 
> 标签：ruby-on-rails, ajax, facebook, security

我有一个简单的投票应用程序，我希望通过 ajax 完成投票活动。

```
$.ajax({
  type: 'POST',
  url: '/vote',
  data: '',
}) 
```

但是，FB 不会将 signed_request 作为 ajax 调用的参数传递。验证 Facebook 应用程序的 ajax 请求身份的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:13:49.780

> 但是，FB 不会将 signed_request 作为 ajax 调用的参数传递。

是**您**（您的脚本）发出这些 HTTP 请求，也就是 ajax 调用。为什么（w|s）Facebook 应该在其中添加任何内容？

> 验证 Facebook 应用程序的 ajax 请求身份的最佳做法是什么？

如果您所做的只是 AJAX 请求，我认为传递 signed_request 参数以进行服务器端验证是一个好主意——那么您为什么不这样做……？

# cakephp - cakephp：模型中的 $belongsTo 不起作用

> ID：12943334
> 
> 赞同：1
> 
> 时间：2012-10-17T21:03:35.263
> 
> 标签：cakephp

表：graduate_applicants

```
CREATE TABLE IF NOT EXISTS `graduate_applicants` (
  `grat_id` int(10) NOT NULL auto_increment,
  `studentnum` int(9) NOT NULL,
  `QuarterID` int(10) NOT NULL,
  PRIMARY KEY  (`grat_id`)
) 
```

表：学生学生

```
CREATE TABLE IF NOT EXISTS `stu_students` (
  `id` int(11) NOT NULL auto_increment,
  `studentid` int(9) default NULL,
  `firstname` varchar(50) default NULL,
  `lastname` varchar(50) default NULL,
  `email` varchar(100) default NULL,
  PRIMARY KEY  (`id`),
  KEY `studentid` (`studentid`),
 ) 
```

型号：</p>

```
class GraduateApplicant extends AppModel{

var $name = 'GraduateApplicant';

var $tablePrefix = '';

var $belongsTo = array('Student' => array('className' => 'Student','foreignKey' => false,''conditions' => array('Student.studentid=GraduateApplicant.studentnum'),'fields' => '','order' => ''),);

} 
```

控制器：

```
$list = $this->paginate('GraduateApplicant'); 
```

我不明白为什么 $list 是空的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T16:41:13.043

如果您设置表格以正确反映它们之间的关系，CakePHP 确实让您的生活更轻松。您可以将代码减少 90%，因为您不必尝试手动指定表的链接方式。

```
students
---------------------------------------------
id   |   firstname   |   lastname   |   email

graduate_applicants
------------------------------------
id   |   student_id   |   quarter_id 
```

那么你的模型会很简单：

```
class GraduateApplicant extends AppModel {

    public $belongsTo = array('Student');

} 
```

如果可以选择，我建议您像这样正确设置数据库表，而不是将学生 ID 列在不同的表中称为不同的东西（`Student.studentid`, `GraduateApplicant.studentnum`）

如果您命名模型以正确反映您的表名，它也会让您的生活更轻松。您的表被调用`stu_students`，但您的模型被调用`Student`。你应该命名你的表`students`和你的模型`Student`，你的表`stu_students`和你的模型`StuStudent`。

# jquery - jScrollPane jquery plugin, jspDrag doesn't exceed to end

> ID：12943338
> 
> 赞同：4
> 
> 时间：2012-10-17T21:03:41.460
> 
> 标签：jquery, css, scrollbar, jscrollpane

After some time fiddling today I mocked up a quick modular slider for one of my client's website. I wanted to theme the scrollbars so went ahead and picked up the the jQuery plugin called "jScrollPane" available here: [http://jscrollpane.kelvinluck.com/](http://jscrollpane.kelvinluck.com/). This simply did the trick and I was able to style the scrollbar with pictures. The only problem I am stumbling upon is that the scroll bar doesn't drag further than the middle, it does scroll horizontally the modules. Here is a quick jsFiddle to describe on my problem: [http://jsfiddle.net/95fG6/](http://jsfiddle.net/95fG6/). I am pretty sure that this is easily solvable and that I just have to set a parameter in the .js to make it work. But I am quick unfamiliar with the plugin therefore have no idea how to continue.

Thank you very much everyone! Thanks for taking your time!

Shad

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T12:28:18.483

最好调整红色的宽度

```
.jspDrag {
    background: red no-repeat;
    padding: 0px;
    height: 21px !important;
    width: 400px !important;
    cursor: pointer;
  } 
```

我希望这可能对你有帮助 [Demo fiddle](http://jsfiddle.net/95fG6/16/)

# javascript - 使用多个图像创建拼贴

> ID：12943341
> 
> 赞同：0
> 
> 时间：2012-10-17T21:04:00.990
> 
> 标签：javascript

我遇到了很大的挑战...我有一个网页，用户在其中单击图像，这些图像必须添加在一起才能仅创建一个图像，并且用户必须能够将该组图像下载为仅一个图像。 ..

我不知道如何做到这一点，任何提示或信息，以便我可以开始研究？

这是我发现用谷歌搜索的一个例子：

在我的情况下，图像的每个正方形都是完全不同的图像，但这就是我必须实现的......

![在此处输入图像描述](../Images/08eb9e02a58e1b246826cc914287684d.png) 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T16:55:56.683

好的，我找到了做这个服务器端的方法...... ImageMagick 如果你们使用红宝石，它就是答案和 RMagick 宝石！

有一个名为 montage 的命令可以完成这项工作！这里有更多关于它的信息！[http://www.imagemagick.org/Usage/montage/](http://www.imagemagick.org/Usage/montage/)

希望它对那里的任何人都有帮助！

# .net - httpModule 发布到 IIS 时不会触发

> ID：12943343
> 
> 赞同：0
> 
> 时间：2012-10-17T21:04:08.470
> 
> 标签：.net, asp.net-mvc, iis, httpmodule

当我在我的机器上调试时，httpModule 在将它发布到 IIS 后现在正常触发，它没有运行，我做错了什么？我错过了什么吗？

这是 web.config 中的样子

```
<httpModules>
     <add type="MyApp.Web.Mvc.Modules.Scheduler" name="Scheduler" />
</httpModules> 
```

那么调度程序看起来像这样

```
public class Scheduler : IHttpModule
{   
private static readonly object Job;
private static Timer timer;

static Scheduler()
{
    Job = new object();
}

void IHttpModule.Init(HttpApplication application)
{
    try
    {

        if (timer == null)
        {
            var timerCallback = new TimerCallback(ProcessJobs);
            const int startTime = 10 * 1000;
            const int timerInterval = 60 * 1000; // 1 minute
            timer = new Timer(timerCallback, null, startTime, timerInterval);
        }
    }
    catch (Exception ex)
    {
        //exception code here
    } 
}

public void Dispose()
{
}

protected void ProcessJobs(object state)
{
    try
    {
        // This protects everything inside from other threads that might be invoking this
        // which is good for long running processes on the background
        lock (Job)
        {
            //My Stuff
        }
    }
    catch (Exception ex)
    {
        //exception code here
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:09:06.000

如果您在 IIS 7.0+ 集成管道模式上托管，请确保您已在该`<system.webServer><modules>...<modules></>`部分中声明了您的模块：

```
<system.webServer>
    ....
    <modules>
        <add name="Scheduler" type="MyApp.Web.Mvc.Modules.Scheduler" />
    </modules>
</system.webServer> 
```

顺便说一句，在将此代码投入生产之前，请确保您已阅读Phil Haack 撰写的[在 ASP.NET 中实现重复后台任务的危险一文。](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

# heroku - Celery creates multiple queues on RabbitMQ -- Non-default queues have no consumers

> ID：12943344
> 
> 赞同：3
> 
> 时间：2012-10-17T21:04:16.203
> 
> 标签：heroku, rabbitmq, celery, django-celery

I am using Django Celery with a RabbitMQ backend, all hosted on Heroku.

From the Celery docs, it is clear that Celery is designed to create new queues for tasks. My problem is, when I go into my RabbitMQ console, I see that only the default queue has any consumers (celeryd instances) hooked up to it. The result is, all the tasks on the non-default queues never run.

Since the Celery docs explicitly state that Celery is supposed to create many queues, I feel like I must be missing something very basic here with my config. Nonetheless, I can't get my consumers to 'jump around' and look for non empty queues -- they just stay on the empty default queue.

Any ideas on how to solve this problem?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-23T00:19:07.930

我和你有同样的问题，但是深入研究文档我认为即使队列是自动创建的，你仍然需要明确告诉你的芹菜工人从新创建的队列中开始消费。

根据文档，工作人员明确绑定到一个或多个队列。也就是说，如果您在启动 worker 时没有指定 -Q 参数，它将被绑定到“默认”队列，另一方面，如果您为 -Q 参数提供值，那么它将被绑定到您提供的那些特定队列。我理解这意味着您不能将工作人员绑定到“未定义”队列（或稍后将创建的队列）。

来自文档： [http ://docs.celeryproject.org/en/latest/userguide/workers.html#queues](http://docs.celeryproject.org/en/latest/userguide/workers.html#queues)

似乎要让您的工作人员开始从新创建的队列中消费，您可以使用 add_consumer() 方法向他们发送一条消息（在运行时）这样做。

# jquery - 时间选择器不显示

> ID：12943347
> 
> 赞同：2
> 
> 时间：2012-10-17T21:04:19.853
> 
> 标签：jquery, timepicker

我正在使用[jQuery 简单](http://trentrichardson.com/examples/timepicker/)的时间选择器（只是时间选择器而不是日期时间选择器），但我无法显示它。我正在使用 modx 1.0.6 evolution 并通过块将时间选择器添加到选择加入表单中。

这是选择加入表单代码：

```
<div><input type="text" name="basic_example_2" id="basic_example_2" value="" /></div> 
```

这是我的页面标题，我已经修改了所有 jQuery 文件应该在的位置，并且还使用 JSlint 检查了 jQuery 代码，它说没关系：

```
<head>
<title>[(site_name)] | [*pagetitle*]</title>
<meta http-equiv="Content-Type" content="text/html; charset=[(modx_charset)]" />
<base href="[(site_url)]"></base>
<link rel="stylesheet" href="assets/templates/landing-page/layout.css" type="text/css" media="screen" />
<link rel="stylesheet" href="assets/templates/landing-page/modxmenu.css" type="text/css" media="screen" />
<link rel="stylesheet" href="assets/templates/landing-page/form.css" type="text/css" media="screen" />
<link rel="stylesheet" href="assets/templates/landing-page/modx.css" type="text/css" media="screen" />
<link rel="stylesheet" href="assets/templates/landing-page/print.css" type="text/css" media="print" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="[(site_url)][~11~]" />
<link rel="stylesheet" media="all" type="text/css"    href="http://code.jquery.com/ui/1.8.23/themes/smoothness/jquery-ui.css" />
<link rel="stylesheet" media="all" type="text/css" href="assets/templates/landing-page/jquery-ui-timepicker-addon.css" />
<script src="manager/media/script/mootools/mootools.js" type="text/javascript"></script>
<script src="assets/templates/modxhost/drop_down_menu.js" type="text/javascript"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/ui/1.8.24/jquery-ui.min.js"></script>
<script type="text/javascript" src="assets/templates/landing-page/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="assets/templates/landing-page/jquery-ui-sliderAccess.js"></script>
<script>
    $(function() {
        $( "#datepicker" ).datepicker({showAnim: 'slideDown'});
    });
</script>
<script>
    $('#basic_example_2').timepicker();
</script>
</head> 
```

我试过这个：

```
$('#basic_example_2').timepicker({}); 
```

还有这个：

```
$(function() {
    $('#basic_example_2').timepicker({});
}); 
```

还有这个：

```
$('#basic_example_2').timepicker(); 
```

以防万一我认为它不应该重要，但是 CSS 已添加到我的 layout.css 文件中：

```
.ui-timepicker-div .ui-widget-header { margin-bottom: 8px; }
.ui-timepicker-div dl { text-align: left; }
.ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
.ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
.ui-timepicker-div td { font-size: 90%; }
.ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }
.ui-timepicker-rtl{ direction: rtl; }
.ui-timepicker-rtl dl { text-align: right; }
.ui-timepicker-rtl dl dd { margin: 0 65px 10px 10px; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:03:39.137

从块中删除 JS 文件，因为 modx 似乎在块中剥离它们并直接在标签之间添加它们。希望这对其他人有帮助。

# python - Change a buch of dates, regex and python

> ID：12943348
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:04:21.367
> 
> 标签：python, regex, time, python-2.7

I have a bunch of dates in the following format

```
16th February 2011
4th April 2009
31st December 2007 
```

And i want to change them to this format

```
20110216
20090404
20071231 
```

I want to do this in python, I've tried `regex` and `time`, but can't get my head round it.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:13:48.093

您可能希望考虑[使用 parsedatetime](https://github.com/bear/parsedatetime)进行模糊日期匹配。

如果您的日期与 NN(ordinal) Month Year 的格式相当不变，则此方法有效：

```
dates="""\
16th February 2011
4th April 2009
31st December 2007"""

import re
import time

for date in dates.splitlines():
    p=re.findall(r'(\d+)\w\w (\w+) (\d\d\d\d)',date)
    d=time.strptime(' '.join(p[0]),'%d %B %Y')
    iso=time.strftime('%Y%m%d',d)
    print "{0:>20} =>{1:>30} =>{2:>15}".format(date,p,iso) 
```

印刷：

```
 16th February 2011 =>  [('16', 'February', '2011')] =>       20110216
      4th April 2009 =>      [('4', 'April', '2009')] =>       20090404
  31st December 2007 =>  [('31', 'December', '2007')] =>       20071231 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:12:35.687

分两步进行：

1.  使用正则表达式`(\d+)([a-z]{2})\s+([A-Za-z]+)\s+(\d{4})`用空字符串替换第二组

2.  用于`time.strptime(string[, format])`将日期转换为您需要的格式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:15:58.843

您可以使用正则表达式获取信息，然后使用 strptime 将其转换为日期。

```
import datetime
import re
date_re = re.compile("^([0-9]+)[a-z]* (.+)$")
example = "16th February 2011"
m = date_re.match(example)
dt = datetime.datetime.strptime("%s %s" % (m.group(1), m.group(2)), "%d %B %Y")
print dt.strftime("%Y%m%d") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:10:05.227

没有进口，用于学习目的。

月份是月份的字典。

```
months = {"January":"01","February":"02",...}    
# make sure all entries are strings, not integers

for entry in entries:
    # split by spaces.  this is multiple assignment.  
    # the first split gets assigned to date, the second, to month, the third, to year.
    day, month, year = entry.split() 

    # parse the date.  the th/rd/nd part is always 2 characters.  
    date = day[:-2]

    if len(date) == 1:
        # make sure the date is two characters long
        date = "0" + date 

    # concatenate
    print year + months[month] + date 
```

# javascript - 'x' * 5 is 'xxxxx' in Python – How do I do that in CoffeeScript/JavaScript?

> ID：12943349
> 
> 赞同：1
> 
> 时间：2012-10-17T21:04:21.160
> 
> 标签：javascript, string, coffeescript

I want to create a string by concatenating multiple copies of another in CoffeeScript or JavaScript.

Do I have to create my own function for this or is there a shortcut like in Python?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:06:31.270

您可以使用此快捷方式（需要传递重复次数加 1）：

```
Array(6).join 'x' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:13:39.140

这将出现在下一版本的 ECMAScript 中，因此您不妨将其实现为 shim。

[http://wiki.ecmascript.org/doku.php?id=harmony:string.prototype.repeat](http://wiki.ecmascript.org/doku.php?id=harmony:string.prototype.repeat)

从提案中：

```
Object.defineProperty(String.prototype, 'repeat', {
    value: function (count) {
        var string = '' + this;
        //count = ToInteger(count);
        var result = '';
        while (--count >= 0) {
            result += string;
        }
        return result;
    },
    configurable: true,
    enumerable: false,
    writable: true
}); 
```

然后`.repeat()`从字符串调用：

```
"x".repeat(5); // "xxxxx" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:10:54.243

您可以使用 array.join(JavaScript)。大批（）

```
function extend(ch, times){

    return Array(times+1).join('x');
}
 extend('x', 5); 
```

# jquery - Registering any click in Jquery outside a menu element to toggle it hidden

> ID：12943354
> 
> 赞同：1
> 
> 时间：2012-10-17T21:04:39.570
> 
> 标签：jquery, drop-down-menu, click

I have created a simple drop down in my system for order which appears upon clicking an element just below it. I can toggle the menu hidden below it by clicking that element again. But I would like to catch clicks outside after that other than the options in the drop down itself to hide it so users can easily discard it if needs be. Is there an easy way in jQuery to achieve this. All im simply using at the moment for the toggling is clicks on a element which states the current order to hide and reveal with .is(':hidden').

Appreciate any help in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:23:24.960

认为我实际上回答了我自己的问题。

发现 stopPropagation() 然后对 $('html').click() 进行绑定检查以查看元素是否为 (':visible') 和 hide();

谢谢你们的帮助。

# screen - 谷歌电视网站，停止屏保

> ID：12943355
> 
> 赞同：3
> 
> 时间：2012-10-17T21:04:50.960
> 
> 标签：screen, google-tv, screensaver

> **可能重复：**
> [阻止屏幕保护程序启动的 javascript 代码](https://stackoverflow.com/questions/4504238/javascript-code-to-prevent-screensaver-from-starting)

如果网站长时间处于打开状态，屏幕保护程序会弹出，但不会在某些网络应用程序（如 Crackle）上弹出。当网站上的视频正在播放时，一个人（作为 Web 开发人员）如何防止屏幕保护程序处于活动状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:31:05.920

这是新的 Flash Player 功能。它在播放某些媒体（音频、视频）时会阻止屏幕保护程序。

来自[help.adobe.com - 以全屏模式播放视频](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3_Flex/WS44B1892B-1668-4a80-8431-6BA0F1947766.html)：

> Flash Player 和 AIR 允许您为视频播放创建全屏应用程序，并支持将视频缩放到全屏。
> 
> 对于以全屏模式运行的 AIR 内容，系统屏幕保护程序和省电选项在播放期间被禁用，直到视频输入停止或用户退出全屏模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:27:07.187

作为 Web 开发人员，您可能有兴趣知道[为什么不能使用 Javascript 来完成](https://stackoverflow.com/questions/4504238/javascript-code-to-prevent-screensaver-from-starting)。

如果您有兴趣在 Windows 上执行此操作，[这里](https://stackoverflow.com/questions/463813/programmatically-prevent-windows-screensaver-from-starting)和[这里](https://stackoverflow.com/questions/241222/need-to-disable-the-screen-saver-screen-locking-in-windows-c-net)有许多实现和建议。这些实现使用可以与操作系统交互的 C++ 和 C# 等语言。从第二个链接开始，[本文](http://blogs.msdn.com/b/oldnewthing/archive/2009/08/20/9876113.aspx)专门针对视频。

# jquery - 您如何使用 jQuery 1.7+ 检查与 .on() 绑定的事件？

> ID：12943359
> 
> 赞同：3
> 
> 时间：2012-10-17T21:05:13.380
> 
> 标签：jquery

这样做的旧版本似乎不起作用..

```
$(".object").data('events'); 
```

..当我与此绑定时：

```
$(document).on("click", ".object", awesomePossumFunction() ); 
```

这不显示事件：

```
$(".object").data('events'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:09:45.303

我建议您不要使用 .data('events')，它已从较新版本的 jQuery 中删除。您可以在较新版本的 jQuery 中的新位置访问它，但也不建议这样做，因为它可能会发生变化。

参考：[http ://bugs.jquery.com/ticket/10589](http://bugs.jquery.com/ticket/10589)

该票的重要部分是，在 1.7 中，对事件对象进行了更改，导致过去`.data('events')`的代码无法正常运行。新位置是`jQuery._data(elem, "events")`

小提琴：http: [//jsfiddle.net/6PxFx/](http://jsfiddle.net/6PxFx/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:23:15.733

如果您检查绑定到的实际元素上的事件，它应该可以正常工作：

```
$(document).on("click", ".object", awesomePossumFunction); //binds to document

var events  = $.data(document, 'events');  //jQuery 1.7.2 and below
var events2 = $._data(document, 'events'); //jQuery 1.8 ++ 
```

[**小提琴**](http://jsfiddle.net/Dwv69/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:13:58.840

你的第二行是我从未使用过的东西。处理程序可能未在您希望的位置注册。我会这样做：

```
$(".object").on("click", awesomePossumFunction()); 
```

让我知道这是否有任何好处。

# ruby-on-rails - 用于 nil:NilClass 的 Ruby 未定义方法“strftime”

> ID：12943362
> 
> 赞同：7
> 
> 时间：2012-10-17T21:05:28.203
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, methods, null

我只使用 Ruby 很短的时间，今天我在处理日历以提出请求时碰壁了。我花时间在 stackoverflow、ruby 指南等上搜索不同的未定义方法错误文档，以及查看 strftime。我找到了一个使用 try 部分解决了我的问题的解决方案，但现在它实际上并没有通过 strftime 来显示在请求上，即使 rails 服务器在帖子中接收它。我可以很好地访问我的日历，然后点击新的请求按钮，填写表格，但是当我发布该表格时，浏览器会给我这个：

```
undefined method `strftime' for nil:NilClass

Extracted source (around line #3):

1: <h1><%= @vacationrequest.request_name %></h1>
2: 
3: <p class="info">Requested For <%= @vacationrequest.request_date.strftime("%B %e, %Y") %></p>
4: 
5: <%= simple_format @vacationrequest.message %>
6: 
```

我在 Rails 服务器上收到此错误：

```
Started GET "/vacationrequests/1" for 127.0.0.1 at 2012-10-17 15:18:14 -0400
Processing by VacationrequestsController#show as HTML
Parameters: {"id"=>"1"}
←[1m←[35mVacationrequest Load (0.0ms)←[0m SELECT "vacationrequests".* FROM "v
acationrequests" WHERE "vacationrequests"."id" = ? LIMIT 1 [["id", "1"]]
Rendered vacationrequests/show.html.erb within layouts/application (15.6ms)
Completed 500 Internal Server Error in 31ms

ActionView::Template::Error (undefined method strftime' for nil:NilClass):
1: <h1><%= @vacationrequest.request_date %></h1>
2:
3: <p class="info">Requested For <%= @vacationrequest.request_date.strftime(
"%B %e, %Y") %></p>
4:
5: <%= simple_format @vacationrequest.message %>
6:
app/views/vacationrequests/show.html.erb:3:inapp_views_vacationrequests_sho
w_html_erb_217743956_18446544' 
```

这是我的展示视图：

```
<h1><%= @vacationrequest.request_name %></h1>

<p class="info">Requested For <%= @vacationrequest.request_date.strftime("%B %e, %Y") %></p>

<%= simple_format @vacationrequest.message %>

<p>
  <%= link_to "Edit Request", edit_vacationrequest_path(@vacationrequest) %> |
  <%= link_to "Back to Requests", vacationrequests_path %>
</p> 
```

这是用户将请求信息放入的_form：

```
<%= form_for @vacationrequest do |f| %>
  <% if @vacationrequest.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@vacationrequest.errors.count, "error") %> prohibited this request from being saved: if this continue to happens please email the error to alex@allsafeindustries.com</h2>
      <ul>
      <% @vacationrequest.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :request_name %><br />
    <%= f.text_field :request_name %>
  </div>
  <div class="field">
    <%= f.label :request_date %><br />
    <%= f.text_field :request_date %>
  </div>
  <div class="field">
    <%= f.label :message %><br />
    <%= f.text_area :message %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

最后，这是我的控制器中的显示和索引方法：

```
 def index
    @vacationrequests = Vacationrequest.all
    @vacationrequests_by_date = @vacationrequests.group_by(&:request_date)
    @date = params[:date] ? Date.parse(params[:date]) : Date.today
  end

  def show
    @vacationrequest = Vacationrequest.find(params[:id])
  end 
```

任何人都可以告诉我什么是不合适的或为什么这是零？谢谢你。

作为对答案的回应，我现在从服务器得到什么：

```
Started POST "/vacationrequests" for 127.0.0.1 at 2012-10-17 20:18:00 -0400
Processing by VacationrequestsController#create as HTML
  Parameters: {"utf8"=>"√", "authenticity_token"=>"E1+xXP0pAIQpwMZruswxIZIrTZB3b
c3NlW3iRv9OLqU=", "vacationrequest"=>{"request_name"=>"One more time", "request_
date"=>"10/31/2012", "message"=>"Lucky number 7?"}, "commit"=>"Create Vacationre
quest"}
  ←[1m←[35m (0.0ms)←[0m  begin transaction
  ←[1m←[36mSQL (15.6ms)←[0m  ←[1mINSERT INTO "vacationrequests" ("created_at", "
message", "request_date", "request_name", "updated_at") VALUES (?, ?, ?, ?, ?)←[
0m  [["created_at", Thu, 18 Oct 2012 00:18:00 UTC +00:00], ["message", "Lucky nu
mber 7?"], ["request_date", nil], ["request_name", "One more time"], ["updated_a
t", Thu, 18 Oct 2012 00:18:00 UTC +00:00]]
  ←[1m←[35m (109.2ms)←[0m  commit transaction
Redirected to http://localhost:3000/vacationrequests/7
Completed 302 Found in 125ms (ActiveRecord: 124.8ms)

Started GET "/vacationrequests/7" for 127.0.0.1 at 2012-10-17 20:18:01 -0400
Processing by VacationrequestsController#show as HTML
  Parameters: {"id"=>"7"}
  ←[1m←[36mVacationrequest Load (0.0ms)←[0m  ←[1mSELECT "vacationrequests".* FRO
M "vacationrequests" WHERE "vacationrequests"."id" = ? LIMIT 1←[0m  [["id", "7"]
]
  Rendered vacationrequests/show.html.erb within layouts/application (15.6ms)
    Completed 500 Internal Server Error in 16ms

ActionView::Template::Error (undefined method `strftime' for nil:NilClass):
    1: <h1><%= @vacationrequest.request_name %></h1>
    2: <%= debug @vacationrequest %>
    3: <p class="info">Requested For <%= @vacationrequest.request_date.strftime(
"%B %e, %Y") %></p>
    4:
    5: <%= simple_format @vacationrequest.message %>
    6:
  app/views/vacationrequests/show.html.erb:3:in `_app_views_vacationrequests_sho
w_html_erb___377763931_36688344' 
```

我还使用了视图调试并检查了我的方案，所有属性似乎都正确排列。

至于评论中的请求，这里是我的 Vacationrequest 模型：

```
class Vacationrequest < ActiveRecord::Base
  attr_accessible :message, :request_name, :request_date
end 
```

再次感谢您的帮助。

这是架构：

```
ActiveRecord::Schema.define(:version => 20121016194123) do

  create_table "vacationrequests", :force => true do |t|
    t.string   "request_name"
    t.date     "request_date"
    t.text     "message"
    t.datetime "created_at",   :null => false
    t.datetime "updated_at",   :null => false
  end
end 
```

和创建控制器操作代码：

```
def create
  @vacationrequest = Vacationrequest.new(params[:vacationrequest])
  if @vacationrequest.save
    redirect_to @vacationrequest, notice: "Created Request!"
  else
    render :new
  end
end 
```

当我看到这个时，我的模式是复数而我的控制器是单数的问题的一部分？再次感谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-01-03T05:12:37.810

> 首先，您必须确保在通过应用 ActiveRecord 验证创建记录之前是否填写了“request_date”。
> 
> 其次，可以使用ruby的try方法来避免此类异常

```
<%= @vacationrequest.try(:request_date).try(:strftime, '%B %e, %Y') %> 
```

快乐编码！

## 更新

在较新版本的 Ruby 中，您可以使用`&.`->`lonely operator`代替上面的解决方案。它也被称为**安全导航算子**。

```
<%= @vacationrequest&.request_date&.strftime('%B %e, %Y') %> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T21:14:26.890

`@vacationrequest.request_date`为 nil，因此您正在查看的记录缺少请求日期。听起来您的数据不正确。在这种情况下，我会通过以下方式调试原因：

1.  `@vacationrequest`在视图中转储- `<%= debug @vacationrequest %>`（或从您的控制器：）`fail @vacationrequest.inspect`。
2.  签入 Rails 控制台 ( `rails c`) ——`Vactionrequest.find(some_id)`产生了什么？
3.  （可选）检查数据库条目。

但是，您输入的休假请求并未保存请求日期，因此您的`create`控制器操作、模型架构或模型验证中可能存在错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T13:21:35.203

Shioyama 非常感谢你提出这个建议：

验证 :request_date, :presence => true

我真的要花时间学习 Rails 所推广的调试和验证。因此，我特别发现 JQuery 中的日期选择器没有正确通过。我进入我的assests > javascripts >vacationrequests.js.coffee，发现我最后离开了()，如下所示：

```
jQuery ->
  $('#vacationrequest_request_date').datepicker()
    dateFormat: 'yy-mm-dd' 
```

一旦我像这样删除括号：

```
jQuery ->
  $('#vacationrequest_request_date').datepicker
    dateFormat: 'yy-mm-dd' 
```

一切正常，索引、显示、编辑、更新、新建。谢谢你们的所有建议，并向我展示了如何解决这个问题。

# objective-c - 调整 UITableViewCell 的 contentView 大小时对 UILabel 的过渡效果

> ID：12943364
> 
> 赞同：0
> 
> 时间：2012-10-17T21:05:27.997
> 
> 标签：objective-c, ios, cocoa-touch, uitableview, uiview

在 iPhone 上的 mail.app 中，每封电子邮件的摘要以`UITableView`. 当用户扫过一行时，标签会调整大小以适应删除按钮，并且文本会重新换行（在更小的空间内，换行符可以移动）。

我已经想出了如何更新标签的宽度以使文本重新换行。但是你也会注意到，Apple 在标签文本重新对齐时使用了一个简洁的淡入淡出动画。我怎样才能实现类似的目标？

我试图操纵标签的 alpha，`willTransitionToState`但`didTransitionToState`我不能让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T22:37:48.147

我检查了 iOS 5 的行为，以确保它没有被 iOS 6 中添加的对 NSAttributedString 的支持启用，而且似乎没有启用。既然是这样，我看到了几种重新创建它的方法。我做过类似的事情，但不完全是这样，所以带着一点盐（但我几乎肯定它会产生完全相同的效果）。

您可以尝试以下...

将遮罩层添加到 UILabel。遮罩层应该让一切都通过。（所以我相信 blackColor 将作为背景颜色）。将子图层添加到蒙版图层。该子层将成为效果的驱动程序。它会将其背景颜色从黑色渐变为白色（使其下方的内容淡出）。您希望子图层蒙版应用于正在消失的标签区域。您可以将框架固定到该区域，它应该可以解决。如果您需要一些示例代码，请告诉我。

编辑：

你见过这个线程吗？这可能有助于使其隐式工作。 [使用 willTransitionToState 在 uitableviewcell 中为文本标签设置动画](https://stackoverflow.com/questions/4255440/animate-textlabel-in-uitableviewcell-using-willtransitiontostate)

# debugging - Eclipse 中的调试不起作用

> ID：12943373
> 
> 赞同：0
> 
> 时间：2012-10-17T21:06:12.753
> 
> 标签：debugging

当我尝试在 Eclipse 中的 Java 程序上运行“调试”时，它会加载一个完整的“启动器驱动程序”列表，以及标题语句；

```
 URLClassLoader$1.run() line:not available. 
```

到底是怎么回事？如何让 Eclipse 调试工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T21:35:36.203

最后通过删除 .meta 文件并重新打开 Eclipse 来修复它。现在一切正常

# objective-c - NSWindowController keyUp 方法播放声音

> ID：12943374
> 
> 赞同：1
> 
> 时间：2012-10-17T21:06:13.727
> 
> 标签：objective-c, xcode, macos, nswindowcontroller

我希望能够仅使用键在我的 NSWindowController 中使用 tableview。向上和向下键已经起作用，所以我只需要输入键进行选择。我使用 NSWindowController 中的 keyUp 方法执行此操作：

```
- (void)keyUp:(NSEvent *)the Event {
    if (theEvent.keyCode == 36) // Enter key
         // Do stuff
} 
```

它工作正常，唯一的问题是，每当我按 Enter 键时，计算机都会播放系统声音。有谁知道我怎样才能使声音静音，或者另一种方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T22:44:58.527

好的，这就是我为任何想知道的人静音所做的。为您的视图创建一个自定义类并覆盖此方法：

```
- (BOOL)performKeyEquivalent:(NSEvent *)theEvent {
    [super performKeyEquivalent:theEvent];
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T07:16:51.300

您必须`[super keyUp:theEvent];`默认调用

# java - 全新安装 JDBC for Oracle - 不执行

> ID：12943379
> 
> 赞同：1
> 
> 时间：2012-10-17T21:06:29.447
> 
> 标签：java, oracle, jdbc

这是我第一次尝试使用 JDBC 连接到 Oracle DB (10g)。我的机器上安装了 JDK 6 并尝试连接到服务器上的 Oracle 数据库。我已经下载**了 ojdbc6.jar**并将其复制到**C:\oracle\product\10.2.0\client_1\jdbc\lib**。

我还设置了以下类路径：

```
.;
C:\;
C:\oracle\product\10.2.0\client_1\jdbc\lib\ojdbc6.jar;
C:\oracle\product\10.2.0\client_1\jlib\orai18n.jar;
C:\Program Files\QuickTime\QTSystem\QTJava.zip 
```

以下代码已编译，但是当我尝试运行类文件时，它会引发错误

```
C:\>java JDBCVersion
java.lang.ClassNotFoundException: oracle.jdbc.driver.OracleDriver
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Class.java:169)
        at JDBCVersion.main(JDBCVersion.java:10) 
```

我将 .java 文件保存在 C:\ 中，以便从该目录编译和运行。

```
import java.io.*;
import java.sql.*;

class JDBCVersion
{

  public static void main (String args[]) throws SQLException{
  try{
  Connection con=null;
      Class.forName("oracle.jdbc.driver.OracleDriver");
      con=DriverManager.getConnection(
      "jdbc:oracle:thin:@HOSTNAME:1521:MYORADB",
        "SCOTT",
        "TIGER");
      Statement s=con.createStatement();
      s.execute("SELECT * FROM EMPLOYEE");
      s.close();
      con.close();
   } catch(Exception e){e.printStackTrace();}
   }
 } 
```

@dardo ...我直接在 CLASSPATH 中添加了 .jar 文件并对其进行了编译，但是当我运行类文件时，我收到以下错误消息

```
C:\>java JDBCVersion
Exception in thread "main" java.lang.NoSuchMethodError: oracle.i18n.text.convert
er.CharacterConverterOGS.getInstance(I)Loracle/i18n/text/converter/CharacterConverter;
        at oracle.sql.converter.CharacterConverterFactoryOGS.make(CharacterConverterFactoryOGS.java:43)
        at oracle.sql.CharacterSetWithConverter.getInstance(CharacterSetWithConverter.java:97)
        at oracle.sql.CharacterSetFactoryThin.make(CharacterSetFactoryThin.java:129)
        at oracle.sql.CharacterSet.make(CharacterSet.java:514)
        at oracle.jdbc.driver.DBConversion.init(DBConversion.java:169)
        at oracle.jdbc.driver.DBConversion.<init>(DBConversion.java:120)
        at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1135)
        at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:320)
        at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:546)
        at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:236)
        at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)
        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:521)
        at java.sql.DriverManager.getConnection(DriverManager.java:582)
        at java.sql.DriverManager.getConnection(DriverManager.java:185)
        at JDBCVersion.main(JDBCVersion.java:15) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:31:45.357

使用以下命令执行应该让它运行。

```
java -jar -classpath .;C:\oracle\product\10.2.0\client_1\jdbc\lib\ojdbc6.jar;C:\oracle\product\10.2.0‌​\client_1\jlib\orai18n.jar;C:\Program Files\QuickTime\QTSystem\QTJava.zip; jarName.jar 
```

但是，您可能希望考虑使用可执行文件打包这些 jar，而不是设置类路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:23:01.090

我确定您的类路径有问题。

尝试直接将带有驱动程序的 jar 添加到您的项目中，看看它是否有效。然后我会检查你的CP中的错别字。

# c++ - 段错误的奇怪案例

> ID：12943383
> 
> 赞同：6
> 
> 时间：2012-10-17T21:06:40.477
> 
> 标签：c++, segmentation-fault

我在 c++ 程序中遇到了一个奇怪的段错误案例。我可以用一个小代码重现它，但不明白为什么会这样。这是代码：

**a.hpp**：

```
#pragma once
#include <boost/shared_ptr.hpp>
#include "b.hpp"

class A
{
    public:
        explicit A ();    
    private:
        std::string str1_;
        B b_;
        std::string str2_;
};

typedef boost::shared_ptr< A > A_ptr; 
```

**a.cpp**

```
#include "a.hpp"
A::A () {} 
```

**b.hpp**

```
#pragma once
#include <string>

class B
{   
    public:
        B ();
    private:
        std::string str1_;
}; 
```

**b.cpp**

```
#include "b.hpp"    
B::B () {} 
```

**主文件**

```
#include "a.hpp"

int main ()
{
    A_ptr a( new A() );
} 
```

**make 的输出**：

```
% make
g++ -Wall -Wextra -g -fno-inline -O0   -c -o main.o main.cpp
g++ -Wall -Wextra -g -fno-inline -O0   -c -o a.o a.cpp
g++ -Wall -Wextra -g -fno-inline -O0   -c -o b.o b.cpp
g++  -o main main.o a.o b.o 
dsymutil main 
```

现在这运行良好。我从中删除`B b_`（声明`b_`）`a.hpp`，保存`a.cpp`（以触发构建）并`make`再次运行：

```
% make
g++ -Wall -Wextra -g -fno-inline -O0   -c -o a.o a.cpp
g++  -o main main.o a.o b.o 
dsymutil main 
```

现在程序段错误：

```
(gdb) bt
#0  0x00007fff97f106e5 in std::string::_Rep::_M_dispose ()
#1  0x00007fff97f10740 in std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string ()
#2  0x0000000100001091 in A::~A (this=0x1001008b0) at a.hpp:8
#3  0x00000001000011da in boost::checked_delete<A> (x=0x1001008b0) at checked_delete.hpp:34
#4  0x0000000100001026 in boost::detail::sp_counted_impl_p<A>::dispose (this=0x1001008d0) at sp_counted_impl.hpp:78
#5  0x0000000100000d9a in boost::detail::sp_counted_base::release (this=0x1001008d0) at sp_counted_base_gcc_x86.hpp:145
#6  0x0000000100000dd4 in boost::detail::shared_count::~shared_count (this=0x7fff5fbff568) at shared_count.hpp:305
#7  0x0000000100000f2b in boost::shared_ptr<A>::~shared_ptr (this=0x7fff5fbff560) at shared_ptr.hpp:159
#8  0x0000000100000aac in main () at main.cpp:5 
```

如果 I`make clean`和`make`, 则程序运行时没有段错误。请帮助我理解如果类中的成员被删除并且项目在没有清理的情况下构建，为什么程序段错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-17T21:10:48.140

在您第二次运行时`make`：

```
% make
g++ -Wall -Wextra -g -fno-inline -O0   -c -o a.o a.cpp
g++  -o main main.o a.o b.o 
dsymutil main 
```

你只是重新编译`a.cpp`。然后链接到上一次 make 运行中生成的其余目标文件。这将使用(contained in )`main.cpp`的旧定义，而( )的新目标文件将使用较新的定义，因此会崩溃。`class A``a.h``class A``a.o`

（具体来说，new`class A`的大小不同，所以它需要在栈中保留的内存`main()`不同，其成员变量的配置也不同）。

这显然是您的`Makefile`.

当您运行时`make clean/make`，所有文件都将使用相同、正确的定义`class A`，一切都会正常运行。

# .net - 如何使透明的 WPF 窗口保持在所有其他窗口的顶部，但对用户输入没有影响？

> ID：12943387
> 
> 赞同：3
> 
> 时间：2012-10-17T21:07:04.850
> 
> 标签：.net, wpf, xaml, event-handling, inkcanvas

我正在尝试开发一个允许人们“在屏幕上绘图”的 Windows 应用程序。

我正在开发：

.NET 3.5 C#/WPF

我有一个托管 InkCanvas 的 WPF 窗口，两者都具有透明背景。

窗口 XAML 属性：

```
ShowInTaskbar="True" ResizeMode="NoResize" Background="Transparent"
WindowStyle="None" AllowsTransparency="True" Topmost="True" 
```

InkCanvas 属性：

```
Background="#11FFFFFF" 
```

我需要以下事件处理程序： - 右键单击​​窗口中的任意位置 - 按 Escape

期望的结果： - WPF 窗口保持在所有其他窗口之上，但不再处于活动状态并且不再接受输入 - WPF 窗口可以再被关注。来自用户的所有输入都应该转到他们当前的焦点窗口，并忽略带有位于所有内容之上的 inkcanvas 的 wpf 窗口

基本用法示例：应用程序的用户正在玩游戏。他们停下来并在 wpf 窗口/inkcanvas 中绘制了一些箭头。他们按退出键结束。wpf 窗口保持在顶部，用户绘制的形状打开，用户的输入返回到他们打开/聚焦的任何窗口。

到目前为止，我已经尝试过：

```
MouseRightButtonUp ::   

mywindow.isenabled = false 
```

我试过了：

```
mywindow.IsInputMethodEnabled = false 
```

到目前为止还没有工作，wpf 窗口仍然开始获取用户输入。我不知何故需要让这个窗口显示，但没有被激活..即使它已经“使用”了一段时间。

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T01:03:09.290

[您可以拦截 WndProc（使用 HwndSource 的 AddHook，如此处](https://stackoverflow.com/questions/624367/how-to-handle-wndproc-messages-in-wpf#1926796)所示）并拦截[WM_NCHITTEST](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645618%28v=vs.85%29.aspx)并返回 HTTRANSPARENT。但这只会让它传递到该线程中的其他窗口。另一个选项可能是设置 WS_EX_TRANSPARENT 扩展样式位。有关示例，请参[见此问题的答案。](https://stackoverflow.com/questions/2408196/how-to-apply-ws-ex-transparent-in-wpf)

# vb.net - 当它具有某些属性时如何反序列化html div？

> ID：12943391
> 
> 赞同：1
> 
> 时间：2012-10-17T21:07:29.027
> 
> 标签：vb.net, serialization, deserialization

例如这个：

```
<div class="link_text">
 <a href="http://www.stackoverflow.com">
 <strong>Text</strong></a>
</div> 
```

使用像 XML 这样的普通标签很容易，您只需创建与标签同名的类，所以如果标签是：

```
<something></something> 
```

您创建了一个名为 something 的类，但是您将如何在 HTML 中的示例 div 中执行此操作，例如该示例 div，其中包含类属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:38:05.483

您需要将该`XmlAttribute`属性应用于类中的属性，以表明您希望将该属性视为属性而不是元素。例如：

```
Public Class div
    <XmlAttribute()> _
    Public Property [class] As String
        Get
            Return _class
        End Get
        Set(value As String)
            _class = value
        End Set
    End Property
    Private _class As String

    Public Property a As a
        Get
            Return _a
        End Get
        Set(value As a)
            _a = value
        End Set
    End Property
    Private _a As a

    Public Property strong As String
        Get
            Return _strong
        End Get
        Set(value As String)
            _strong = value
        End Set
    End Property
    Private _strong As String
End Class

Public Class a
    <XmlAttribute()> _
    Public Property href As String
        Get
            Return _href
        End Get
        Set(value As String)
            _href = value
        End Set
    End Property
    Private _href As String
End Class 
```

通常，您不需要在属性名称周围使用方括号，就像在`class`属性上一样。在此示例中必须这样做的唯一原因是“类”一词是 VB.NET 语言中的一个特殊关键字。方括号强制 VB 将其视为标识符名称，而不是关键字的典型含义。另一种不使用括号做同样事情的方法是将属性命名为不同的名称，然后强制它在 XML 中具有名称“类”：

```
Public Class div
    <XmlAttribute("class")> _
    Public Property MyClassAttribute As String
        ' ...
    End Property
End Class 
```

无论如何，一旦你将它反序列化为一个`div`对象，你就可以像这样读取它：

```
Dim myDiv As div = '...
Dim theClassOfMyDiv As String = myDiv.class
Dim theHref As String = myDiv.a.href
' etc. 
```

# android - 如何保留被实例状态恢复机制覆盖的值？

> ID：12943401
> 
> 赞同：0
> 
> 时间：2012-10-17T21:08:16.800
> 
> 标签：android

在我的应用程序中，我有一个将类成员的值（比如 ）初始化`Spinner`为其默认值。然后，用户可以执行步骤来更改 的值。我正在保存in的值并将其恢复为. 但是，显然由于恢复了，它被调用并归零。我希望保留用户输入的值。`onItemSelected``a``0``a``a``onSaveInstanceState``onRestoreInstanceState``Spinner``onItemSelected``a`

但是请注意，旧值`a`在 的任何其他设置中都没有意义`Spinner`（因此在选择项目时将其归零）。不幸的是，它也很难验证。因此，不知道调用`onItemSelected`是假的，将`a`其归零是不可避免的。

问题是输入事件处理程序似乎被放入某个队列并*在* `onCreate`/`onRestoreInstanceState`完成后调用（两次，这是我不明白的另一件事）。因此，我的问题是，我应该在什么时候`a`从保存的实例状态恢复到非默认值？我应该以某种方式将此任务放在输入事件队列的末尾吗？或者有没有办法区分调用是`onItemSelected`由于实际用户输入还是仅仅是实例状态恢复而发生的？

代码示例：

```
private String KEY = "(...).A";
private int a;

public void onItemSelected(AdapterView<?> parentView, View childView, int position, long id) {
  /* other important stuff */
  a = 0;
  Log.d("info", "a zeroed");
}

public void onSaveInstanceState(Bundle state) {
  super.onSaveInstanceState(state);
  state.putInt(KEY, a);
}

public void onRestoreInstanceState(Bundle state) {
  super.onRestoreInstanceState(state);
  a = state.getInt(KEY, a);
  Log.d("info", "a restored");
} 
```

改变方向后，日志说

```
info  a restored
info  a zeroed
info  a zeroed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:31:03.907

我必须承认，我没有按照您在问题中所说的所有内容进行操作，但是恢复 Spinner 的选择很容易：

1.  在您的`onItemSelected()`使用中：`a = position`,
2.  在`onRestoreInstanceState()`通话结束时`spinner.setSelection(a);`

了解*每次*Spinner 更改其选择时 Spinner 调用`onItemSelected()`，包括内部`onRestoreInstanceState()`。但是，由于您保持`a`设置为当前选择，因此这不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:29:55.150

```
private boolean trigger = false;
public void onItemSelected(AdapterView<?> parentView, View childView, int position, long id) {
if (trigger){
    a = 0;
   Log.d("info", "a zeroed");
} else trigger = true;
} 
```

它看起来像最简单的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T22:32:20.567

到目前为止，这是我想出的。它可以做到这一点，而无需计算`onItemSelected`仅通过观察发现的两次调用。但是，我仍然认为这是一种解决方法：

```
private String KEY = "(...).A";
private String SEL = "(...).SEL";
private int a;
private int sel = -1;

public void onItemSelected(AdapterView<?> parentView, View childView, int position, long id) {
  /* other important stuff */
  if(position != sel) {
    a = 0;
    Log.d("info", "a zeroed");
    sel = position;
  } else
    Log.d("info", "a kept");
}

public void onSaveInstanceState(Bundle state) {
  super.onSaveInstanceState(state);
  state.putInt(KEY, a);
  state.putInt(SEL, sel);
}

public void onRestoreInstanceState(Bundle state) {
  super.onRestoreInstanceState(state);
  a = state.getInt(KEY);
  sel = state.getInt(SEL);
  Log.d("info", "a restored");
} 
```

改变方向后，日志现在显示

```
info  a restored
info  a kept
info  a kept 
```

这个解决方案的坏处是在 还没有初始化`a`的时候就有它的价值`Spinner`，这暂时不会造成问题，但永远不应该发生。一个适当的解决方案应该让其`onItemSelected`完成所有工作并`a`在此之后进行设置。

# ios - NSPredicate 和 NSManagedObjects 的 NSSet

> ID：12943405
> 
> 赞同：0
> 
> 时间：2012-10-17T21:08:47.340
> 
> 标签：ios, core-data, entity-relationship

我有一个获取请求如下：

```
NSFetchRequest *songRequest = [NSFetchRequest fetchRequestWithEntityName:@"Song"]; 
```

我还有一个名为genreFilter 的类型的NSSet (NSManagedObjects)。

我想设置一个谓词来过滤与genreFilter中的流派有关系的歌曲。

我可以以这种方式设置 NSPredicate 吗：

```
NSPredicate *songRequestPredicate = [NSPredicate predicateWithFormat:@"genre IN %@", [_genreFilter allObjects]]; 
```

?

流派如下所示：

```
@interface Genre : NSManagedObject

@property (nonatomic, strong) NSNumber * id;
@property (nonatomic, strong) NSString * name;
@property (nonatomic, strong) NSSet *preset;
@property (nonatomic, strong) NSSet *song;
@end
@interface Genre (CoreDataGeneratedAccessors)

- (void)addPresetObject:(Preset *)value;
- (void)removePresetObject:(Preset *)value;
- (void)addPreset:(NSSet *)values;
- (void)removePreset:(NSSet *)values;

- (void)addSongObject:(Song *)value;
- (void)removeSongObject:(Song *)value;
- (void)addSong:(NSSet *)values;
- (void)removeSong:(NSSet *)values;

@end 
```

和这样的歌曲：

```
@interface Song : NSManagedObject

@property (nonatomic, strong) NSNumber * arousal;
@property (nonatomic, strong) NSNumber * id;
@property (nonatomic, strong) NSNumber * match;
@property (nonatomic, strong) NSNumber * popularity;
@property (nonatomic, strong) NSNumber * valence;
@property (nonatomic, strong) NSNumber * cloud;
@property (nonatomic, strong) Genre *genre;
@property (nonatomic, strong) Year *year;
@property (nonatomic, strong) Period *period;
@property (nonatomic, strong) NSNumber *yearReleased;

@property (nonatomic, assign) float score;
@property (nonatomic, readonly) MPMediaItem *mediaItem;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T09:00:25.863

是的。这在我看来是正确的。

这是我对另一个问题的回答，它包含简单的说明和代码，可以让准系统核心数据项目启动并运行[。](https://stackoverflow.com/a/12617712/1347502)我经常使用这个基本设置来快速测试这样的事情。

# python - OpenCV Python 单个（而不是多个）blob 跟踪？

> ID：12943410
> 
> 赞同：12
> 
> 时间：2012-10-17T21:09:09.700
> 
> 标签：python, opencv, blob, color-tracking

我一直在尝试通过 Python 上的 OpenCV 进行单色斑点跟踪。下面的代码正在工作，但它找到了所有跟踪像素的质心，而不仅仅是最大斑点的质心。这是因为我正在拍摄所有像素的时刻，但我不确定如何为轨迹着色。我有点坚持我需要做些什么才能使它成为一个单一的 blob 跟踪器而不是一个多 blob 平均器。

这是代码：

```
#! /usr/bin/env python 

#if using newer versions of opencv, just "import cv"
import cv2.cv as cv

color_tracker_window = "Color Tracker" 

class ColorTracker: 

def __init__(self): 
    cv.NamedWindow( color_tracker_window, 1 ) 
    self.capture = cv.CaptureFromCAM(0) 

def run(self): 
    while True: 
        img = cv.QueryFrame( self.capture ) 

        #blur the source image to reduce color noise 
        cv.Smooth(img, img, cv.CV_BLUR, 3); 

        #convert the image to hsv(Hue, Saturation, Value) so its  
        #easier to determine the color to track(hue) 
        hsv_img = cv.CreateImage(cv.GetSize(img), 8, 3) 
        cv.CvtColor(img, hsv_img, cv.CV_BGR2HSV) 

        #limit all pixels that don't match our criteria, in this case we are  
        #looking for purple but if you want you can adjust the first value in  
        #both turples which is the hue range(120,140).  OpenCV uses 0-180 as  
        #a hue range for the HSV color model 
        thresholded_img =  cv.CreateImage(cv.GetSize(hsv_img), 8, 1) 
        cv.InRangeS(hsv_img, (120, 80, 80), (140, 255, 255), thresholded_img) 

        #determine the objects moments and check that the area is large  
        #enough to be our object 
        moments = cv.Moments(thresholded_img, 0) 
        area = cv.GetCentralMoment(moments, 0, 0) 

        #there can be noise in the video so ignore objects with small areas 
        if(area > 100000): 
            #determine the x and y coordinates of the center of the object 
            #we are tracking by dividing the 1, 0 and 0, 1 moments by the area 
            x = cv.GetSpatialMoment(moments, 1, 0)/area 
            y = cv.GetSpatialMoment(moments, 0, 1)/area 

            #print 'x: ' + str(x) + ' y: ' + str(y) + ' area: ' + str(area) 

            #create an overlay to mark the center of the tracked object 
            overlay = cv.CreateImage(cv.GetSize(img), 8, 3) 

            cv.Circle(overlay, (x, y), 2, (255, 255, 255), 20) 
            cv.Add(img, overlay, img) 
            #add the thresholded image back to the img so we can see what was  
            #left after it was applied 
            cv.Merge(thresholded_img, None, None, None, img) 

        #display the image  
        cv.ShowImage(color_tracker_window, img) 

        if cv.WaitKey(10) == 27: 
            break 

if __name__=="__main__": 
    color_tracker = ColorTracker() 
    color_tracker.run() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-18T02:01:42.307

你需要这样做：

1）使用inRange函数获取阈值图像，您可以应用一些腐蚀和膨胀来去除小的噪声粒子。这将有助于提高处理速度。

2) 使用“findContours”功能查找轮廓

3) 使用“contourArea”函数查找轮廓区域并选择一个具有最大面积的区域。

4）现在像你一样找到它的中心，并跟踪它。

以下是新 cv2 模块中的示例代码：

```
import cv2
import numpy as np

# create video capture
cap = cv2.VideoCapture(0)

while(1):

    # read the frames
    _,frame = cap.read()

    # smooth it
    frame = cv2.blur(frame,(3,3))

    # convert to hsv and find range of colors
    hsv = cv2.cvtColor(frame,cv2.COLOR_BGR2HSV)
    thresh = cv2.inRange(hsv,np.array((0, 80, 80)), np.array((20, 255, 255)))
    thresh2 = thresh.copy()

    # find contours in the threshold image
    contours,hierarchy = cv2.findContours(thresh,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)

    # finding contour with maximum area and store it as best_cnt
    max_area = 0
    for cnt in contours:
        area = cv2.contourArea(cnt)
        if area > max_area:
            max_area = area
            best_cnt = cnt

    # finding centroids of best_cnt and draw a circle there
    M = cv2.moments(best_cnt)
    cx,cy = int(M['m10']/M['m00']), int(M['m01']/M['m00'])
    cv2.circle(frame,(cx,cy),5,255,-1)

    # Show it, if key pressed is 'Esc', exit the loop
    cv2.imshow('frame',frame)
    cv2.imshow('thresh',thresh2)
    if cv2.waitKey(33)== 27:
        break

# Clean up everything before leaving
cv2.destroyAllWindows()
cap.release() 
```

您可以在此处找到一些关于跟踪彩色对象的示例：[https ://github.com/abidrahmank/OpenCV-Python/tree/master/Other_Examples](https://github.com/abidrahmank/OpenCV-Python/tree/master/Other_Examples)

另外，尝试使用新的 cv2 接口。它比旧的 cv 更简单、更快。有关更多详细信息，请查看：[所有这些 OpenCV Python 接口之间有什么不同？](https://stackoverflow.com/questions/10417108/what-is-different-between-all-these-opencv-python-interfaces/10425504#10425504)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:35:12.087

阈值化后，使用 blob 检测或 cvfindcontours 获取单个 blob。

# android - 即使屏幕关闭，如何在 Android 中处理用户地理点的连续记录？

> ID：12943413
> 
> 赞同：0
> 
> 时间：2012-10-17T21:09:18.203
> 
> 标签：android, android-location, android-wake-lock

我有一个应用程序可以连续记录用户的位置。*位置更新将非常频繁，以获得用户所走路线的精确映射。*为了让应用程序在手机睡着时记录地理点，我使用了唤醒锁，当用户停止记录或在`onDestroy()`.

我现在意识到我没有从位置管理器中删除位置侦听器。如果用户在离开应用程序之前忘记按下“停止记录路线”按钮，这会导致电池耗尽。我最初的想法是将其删除，`onPause()`但我担心`onPause()`屏幕关闭时可能会被调用，尽管我有一个唤醒锁（但不是屏幕打开）。

我在这件事上的问题是：我什么时候应该从位置管理器中删除位置侦听器？我应该释放听众 i`onDestroy()`吗？或者，只要我在听位置管理器，我可能根本不需要唤醒锁？如果是这样应该如何处理？

我在其他地方看到过这个问题，比如这里： [Android - When using LocationManager.requestLocationUpdates, do I need a WakeLock?](https://stackoverflow.com/questions/3814852/android-when-using-locationmanager-requestlocationupdates-do-i-need-a-wakeloc)

但似乎没有一个绝对的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T00:40:14.543

您没有提到您希望获得与解决方案相关的位置的频率。

**采集频率**

如果你想获取频率大于每 5 分钟 1 个的位置，我建议让监听器注册。GPS 设备应该在采集之间进入节能模式。

如果频率小于该频率，则可以考虑在获得位置后删除列表器并使用计时器任务或警报管理器再次注册，具体取决于您的应用程序设计。

**唤醒锁**

我自己从未尝试过，但我的期望是，如果没有人要求它保持清醒，Android 将在一段时间没有用户交互后进入睡眠模式。即使您注册了侦听器，也应该没有什么不同。

**应用架构**

`onPause()`并`onStop()`在某些其他活动部分或全部覆盖您的活动屏幕时调用。因此，如果您想保持连续录音，这里不适合注销听众。此外，如果用户离开您的应用程序，录制将停止。

我建议您使用服务来记录位置，如果您的采集间隔时间很短，或者使用`AlarmManager`来安排不太频繁的采集。

# class - 在哪里可以找到标准 Java 类的代码？

> ID：12943416
> 
> 赞同：1
> 
> 时间：2012-10-17T21:09:31.880
> 
> 标签：class, awt, java

例如，我想查看 java.awt.geom 包中 Line2D 类的代码。我怎样才能找到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:10:48.047

转到 jdk 主文件夹。将有一个名为 的文件夹`src`。在那里，您将获得所有内置 java 类的源代码。

```
C:\Program Files\Java\jdk<version>\src\java\awt\geom\Line2D.java 
```

可能你可能有`src.zip`文件夹。你可以解压它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:11:09.967

您在 OpenJDK [http://download.java.net/openjdk/jdk6/有一个实现](http://download.java.net/openjdk/jdk6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:11:33.367

如果你有 JDK，它是一个`src.zip`在 JDK 根文件夹中命名的文件。

常见的 32 位位置：

`C:\Program Files (x86)\Java\jdk<version>\src.zip`

# c++ - C++/WinAPI - 从 DWORD 中删除标志（按位运算符？）

> ID：12943420
> 
> 赞同：1
> 
> 时间：2012-10-17T21:09:46.320
> 
> 标签：c++, winapi, bit-manipulation, flags, dword

`&`我现在知道如何使用按位AND 运算符检查 DWORD（特别是 Windows 样式）中是否存在某个标志。我该怎么做：

```
if (dwMyFlags & dwSomeFlag) {
    // dwMyFlags contains dwSomeFlag
    // ->> How do I remove dwSomeFlag from dwMyFlags?
} 
```

我知道减去它是行不通的，是否有一些运算符可以从 DWORD 中删除标志？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-17T21:18:38.790

如果您知道标志已设置，您可以使用独占或取消设置：

```
dwMyFlags ^= dwSomeFlag; 
```

如果你不确定标志的状态，你需要使用按位&，而不是按位~

```
dwMyFlags &= ~dwSomeFlag; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-17T21:12:01.543

用你想要的标志`&`的*倒数*按位：

```
dwMyFlags = dwMyFlags & ~dwSomeFlag; 
```

您可以使用以下方式缩写`&=`：

```
dwMyFlags &= ~dwSomeFlag; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-17T21:11:57.783

与不属于该标志的位：

```
dwMyFlags &= ~dwSomeFlag; 
```

这也可以扩展到删除多个标志：

```
dwMyFlags &= ~(dwSomeFlag | dwSomeOtherFlag); 
```

此外，匈牙利符号已经过时了。

# project-management - 在 Redmine / SVN 中处理多个项目（单个 repo）

> ID：12943425
> 
> 赞同：2
> 
> 时间：2012-10-17T21:10:05.457
> 
> 标签：project-management, redmine, visualsvn, visualsvn-server

当前设置是带有单个主项目的 VSS，嵌套在该单个项目下的是许多其他项目（通常包含其他嵌套项目）。

我正在尝试迁移到 SVN (VisualSVN) 并包含 Redmine（通过 Bitnami 堆栈安装），但我对如何最好地复制当前设置有点困惑。

现在，我有一个主存储库，其中包含一堆项目的子目录和项目中的项目的一些子子目录（都相互关联）。

我的问题是在 Redmine 中，它要求我的回购 URL。我尝试使用 HTTPS，但不断出错（我猜这与 SSL 证书不被接受有关）。我尝试搜索/解决问题，但无济于事。我能够通过使用“file:///”并以这种方式映射 repo 来解决这个问题。这个“解决方案”的问题在于，当我在 Redmine 中创建一个项目/子项目并尝试添加 repo（使用 file:///）时，我得到了 repo 的根......我所有的项目 /回购中的子项目存在。

也许是我对 SVN / Redmine 缺乏了解，但是否可以只显示 repo 中的子目录，而不是整个 repo？当大多数项目性质相似时，我不希望所有项目都有 100 多个回购。当我在 repo 浏览器中查看 repo 时，我可以看到嵌套的项目文件夹，但我不明白（如果可能的话）如何将特定项目的“repo”指向该子目录而不是根目录回购。

我尝试寻找有类似情况/问题的人，但无济于事。希望我的问题是有道理的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:51:17.410

使用 SVN，任何子文件夹本身就是一个存储库。

例如：

```
+ svnroot
|
+-+ Proj 1
| |
| +-+ Proj 1.1
etc. 
```

您只需将 Redmine 中的 SVN 根设置为该特定文件夹即可引用每个子项目。在我的示例中，要访问`Proj 1.1`，那将是`svn://SERVER/svnroot/Prod 1/Prod 1.1/`。

我在学校上的一门课程使用此功能允许教师为所有学生拥有一个单一的 SVN 存储库，但每个学生仍然只能访问他们自己的“子存储库”。

# c# - DirectShow MPEG-2 编码从网络摄像头到文件

> ID：12943427
> 
> 赞同：1
> 
> 时间：2012-10-17T21:10:08.763
> 
> 标签：c#, directshow, video-encoding, directshow.net

我一直在开发一个使用[Directshow.NET](http://directshownet.sourceforge.net/)的应用程序，并决定开始修补 GraphEd.exe 以找出我需要采取的确切路线。

![图形化图](../Images/783688e85b3febed1655b17b70bcfa1c.png)

我想要的最简单版本在上图中（其中“test.mpeg”是“文件编写器”过滤器）。

果然，在 GraphEd 中看起来很简单的事情并不像编码那么简单。几秒钟后，我意识到 directshow 是我不理解的东西。这是我的 C# 代码尝试：

```
int hr;

IBaseFilter cameraStream = null;
IBaseFilter mpegEncoder = null;
IBaseFilter fileWriter = null;
ICaptureGraphBuilder2 capGraph = null;

filterGraph = (IFilterGraph2)new FilterGraph();
try
{
    capGraph = (ICaptureGraphBuilder2)new CaptureGraphBuilder2();
    hr = capGraph.SetFiltergraph(filterGraph);
    Marshal.ThrowExceptionForHR(hr);

    hr = filterGraph.AddSourceFilterForMoniker(dev.Mon, null, dev.Name, out cameraStream);
    Marshal.ThrowExceptionForHR(hr);

    IPin cameraData = null;
    hr = capGraph.FindPin(cameraStream, PinDirection.Output, PinCategory.Capture, MediaType.Video, true, 0, out cameraData );
    //hr = cameraStream.FindPin("Capture", out cameraData);
    Marshal.ThrowExceptionForHR(hr);

    mpegEncoder = (IBaseFilter)new MJPGEnc();
    hr = filterGraph.AddFilter(mpegEncoder, "mpeg encoder");
    //hr = filterGraph.FindFilterByName("Microsoft MPEG-2 Video Encoder", out mpegEncoder);
    Marshal.ThrowExceptionForHR(hr);

    IPin mpegInput = null;
    //hr = mpegEncoder.FindPin("Input0", out mpegInput);
    hr = capGraph.FindPin(mpegEncoder, PinDirection.Input, null, null, true, 0, out mpegInput);
    Marshal.ThrowExceptionForHR(hr);

    filterGraph.Connect(cameraData, mpegInput);

    IPin mpegOutput = null;
    //hr = mpegEncoder.FindPin("Output", out mpegOutput);
    hr = capGraph.FindPin(mpegEncoder, PinDirection.Output, null, null, true, 0, out mpegOutput);
    Marshal.ThrowExceptionForHR(hr);

    //hr = filterGraph.FindFilterByName("File writer", out fileWriter);
    fileWriter = (IBaseFilter)new FileWriter();
    IFileSinkFilter test = fileWriter as IFileSinkFilter2;
    AMMediaType mtype = new AMMediaType();
    mtype.majorType = MediaType.Video;
    mtype.subType = MediaSubType.RGB24;
    mtype.formatPtr = IntPtr.Zero;
    test.SetFileName(videoPath, mtype );

    IPin fwriterIn = null;
    //hr = fileWriter.FindPin("in", out fwriterIn);
    hr = capGraph.FindPin(fileWriter, PinDirection.Input, null, null, true, 0, out fwriterIn);
    Marshal.ThrowExceptionForHR(hr);

    filterGraph.Connect(mpegOutput, fwriterIn);

    hr = capGraph.RenderStream(null, null, cameraStream, null, fileWriter); // *** Breaks on this line! ***
    Marshal.ThrowExceptionForHR(hr);

    mediaControl = filterGraph as IMediaControl;

}
finally
{
    if (cameraStream != null)
    {
        Marshal.ReleaseComObject(cameraStream);
        cameraStream = null;
    }
    if (mpegEncoder != null)
    {
        Marshal.ReleaseComObject(mpegEncoder);
        mpegEncoder = null;
    }
    if (fileWriter != null)
    {
        Marshal.ReleaseComObject(fileWriter);
        fileWriter = null;
    }
    if (capGraph != null)
    {
        Marshal.ReleaseComObject(capGraph);
        capGraph = null;
    }
} 
```

在编写并查看了我的代码有多荒谬（就编程逻辑而言）之后，我意识到我需要一些帮助。

谁能指导我某种结构化的directshow教程，向我解释事情，就好像我是一个巨大的新手一样，或者可能将我链接到某种处理网络摄像头到文件记录的C#库？我一般不是win32程序员，所以任何减轻痛苦的东西都应该是好的:)

另外，我确实有似乎可以工作的相机设备枚举代码：

```
private void rescan_camera()
{
    comboBox1.Items.Clear();

    DsDevice[] cameraDevices = DsDevice.GetDevicesOfCat(FilterCategory.VideoInputDevice);

    for(int i=0; i < cameraDevices.Length; i++) {
        comboBox1.Items.Add(cameraDevices[i].Name);
    }
    if (comboBox1.Items.Count > 0) comboBox1.SelectedIndex = 0;
} 
```

我可以从 DsDevice 获取名字对象数据，我知道这是告诉 directshow 过滤器图表我想从哪里记录的关键部分，但这与我的知识范围有关。

**编辑：**更新的代码，显示换行符的确切位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T17:36:17.123

重复评论：所以，我最终更改了文件输出：我没有为 setFileName 设置媒体类型，而是将其更改为 null，现在一切都很好:)

# maven - 使用多环境资源过滤的通用/默认属性？

> ID：12943429
> 
> 赞同：1
> 
> 时间：2012-10-17T21:10:21.277
> 
> 标签：maven, maven-3, maven-resources-plugin

我有一个具有以下属性文件结构的 Maven 项目：

```
./clientA/
    dev.properties
    staging.properties
    production.properties
./clientB/
    dev.properties
    staging.properties
    production.properties 
```

等等等等。

90% 的属性在同一环境中的客户端之间都是相同的（例如，clientA 和 clientB 上的开发道具通常都是相同的）。但是，不能保证在每个客户端中相同的属性都相同。

我想做的是在根级别创建一个 common.[dev|staging|production].properties 文件，将所有公共属性移到那里，然后根据需要覆盖客户端属性文件中的公共属性，但这并没有' 似乎不受 Maven 支持，例如，我无法在用于过滤的两个属性文件中定义相同的属性，因为 Maven 仅在处理的第一个属性文件上使用该值。

我将如何在 Maven 中实现相同的功能？有没有其他方法可以解决这个问题？还是不可能？

这是我想做的事情：

```
common.dev.properties:
    foo=bar

clientA/dev.properties
     foo=snafu
     custom.prop=clientA Value

clientB/dev.properties
     custom.prop=clientB Value 
```

过滤后的值应该是：

```
clientA:
    foo=snafu
    custom.prop=clientA Value

clientB:
    foo=bar
    custom.prop=clientB Value 
```

取而代之的是，目前发生的是：

```
clientA:
    foo=bar  (i.e. the common.dev.properties foo property value can not be overriden)
    custom.prop=clientA Value

clientB:
    foo=bar
    custom.prop=clientB Value 
```

资源：

```
src/main/resources/test.properties
    foo=${foo}
    custom.prop=${custom.prop} 
```

资源插件配置

```
<build>
    <filters>
        <filter>${basedir}/env/common.properties</filter>
        <filter>${basedir}/env/${client.name}/${env}.properties</filter>
    </filters>
<plugins>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-resources-plugin</artifactId>
            <version>2.5</version>
            <configuration>
                <encoding>UTF-8</encoding>
            </configuration>
            <executions>
                <execution>
                    <id>copy-resources</id>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${basedir}/target/classes</outputDirectory>
            <resources>
                            <resource>
                                <filtering>true</filtering>
                                <directory>src/main/resources</directory>
                            </resource>
                        </resources>
            </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

# database - 在列表框中显示数据库信息

> ID：12943432
> 
> 赞同：0
> 
> 时间：2012-10-17T21:10:32.570
> 
> 标签：database, vb.net, linq

我试图弄清楚如何根据按钮单击显示访问数据库中的某些数据。例如，如果我单击“库存”按钮，它将显示数据库中缺货的项目。我能够打开连接并显示查询信息，但这是一个很长的 LINQ 查询，我不确定它来自哪里。关于如何显示数据库信息的任何建议？即客户信息、库存物品等...

```
Option Strict On

Imports System.Data.OleDb

Public Class frmMicroland

Dim con As New OleDbConnection

Private Sub btnStockItems_Click(sender As System.Object, e As System.EventArgs) Handles btnStockItems.Click

    Dim query1 = From anyOrder In MICROLANDDataSet.Orders
                Join itsStockItem In MICROLANDDataSet.Inventory
                On anyOrder.itemID Equals itsStockItem.itemID
                Let orderQuantity = anyOrder.quantity
                Select itsStockItem.quantity, itsStockItem.description, anyOrder.itemID
                Order By quantity, itemID

    ''Test connection to make sure it opens first
    Try
        con = New OleDb.OleDbConnection("provider= microsoft.ace.oledb.12.0;Data Source = C:\Users\HPG62-220US\Documents\Visual Studio 2010\Projects\Asignment 9\Asignment 9\bin\Debug\MICROLAND.accdb; Persist Security Info=False;")
        Try
            Call con.Open()
        Catch ex As Exception
            MessageBox.Show("Could not connect")
        End Try

        If con.State = ConnectionState.Open Then
            MessageBox.Show("Connection is open")
        End If
    Catch ex As Exception
    End Try

    lstOutput.Items.Add("Here are the items that are out of")
    lstOutput.Items.Add("inventory or must be reordered.")
    lstOutput.Items.Add("")
    lstOutput.Items.Add("The numbers shown give the")
    lstOutput.Items.Add("minimum reorder quantity required.")
    lstOutput.Items.Add("")
    lstOutput.Items.Add(query1)
    con.Close()
End Sub

Private Sub btnTodaysOrders_Click(sender As System.Object, e As System.EventArgs) Handles btnTodaysOrders.Click

End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:51:53.847

这里发生了一些不同的事情......

首先，您需要在 btnStockItems_Click 过程之外声明一个可以存储返回数据集的变量。有点像：

```
Dim con As New OleDbConnection
Dim ReturnedData as Datatable 
```

然后在您的 btnStockItems_Click 过程中，您需要填充该数据表：

```
ReturnedData = query1.CopyToDataTable 
```

现在，您可以在每个按钮单击中使用数据。

我看到的下一个问题是您似乎没有提取正确的数据...例如，您从未在查询 1 中提取订单日期，但您希望了解今天的订单。

假设您修复了该问题并调用了它，在 query1 中说“OrderDate”，那么您可以做的是使用 ReturnedData 数据表中的 linq 查询填充您的列表视图，如下所示：

```
From rw in ReturnedData where OrderDate = xxx select rw.item("itemID").tostring 
```

...我在没有 IDE 的情况下执行此操作，因此拼写可能会关闭，但我希望这能让您知道去哪里...

# jquery - 访问排序列和方向

> ID：12943433
> 
> 赞同：0
> 
> 时间：2012-10-17T21:10:33.337
> 
> 标签：jquery

我有一个不错的 jQuery 数据表，其中包含可排序的列。收到请求以捕获 1) 单击的列和 2) 单击时的排序方向。我已经遍历了 datatables 对象中的各种与排序相关的对象，但似乎无法获得这两个奇异值。

出于这个问题的目的，我希望最终结果类似于 alert('You clicked the column ' + column) 和 alert('The sort direction when you click is ' + sort direction)。

我该如何做到这一点？与往常一样，提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:55:55.230

如果我正确理解您的问题，基本上您只需要**1**条特定信息即可完成此操作：表中行（用户正在排序）的初始位置。

有不同的方法来获得它，但最简单的方法可能是简单地为每一行设置一个数据属性，以在生成表时保存该行的初始位置。

例子：

```
$.each($YOURTABLE.children(), function(idx, val) { val.data('position', idx);}); 
```

现在，您需要做的就是在**sortstop**事件上，获取该值并将其与该行的新位置进行比较：

```
$YOURTABLE.bind('sortstop', function(event, ui) {
    //$(ui.item[0]) selects the user-selected row
    var oldPosition = $(ui.item[0]).data('position'),
        newPosition;    

    //get row's new position
    $.each($YOURTABLE.children(), function(idx, val) {
        if($(val) === $(ui.item[0]))
            newPosition = idx; //store new position
    }
    //now compare
    if(oldPosition > newPosition)
        ////alert user row (oldPosition) moved up
    else if(oldPosition < newPosition)
        ////alert user row (oldPosition) moved down

    //refresh all row positions using first code example
} 
```

});

希望这应该为您指明正确的方向。

# httpresponse - Mule http响应构建器401状态

> ID：12943434
> 
> 赞同：1
> 
> 时间：2012-10-17T21:10:39.243
> 
> 标签：httpresponse, esb, mule

我想在身份验证失败后返回 401 HTTP_response。我试图通过使用具有以下配置的 http:response-builder 组件来做到这一点。我不关心流程中之前的任何事情，一旦达到这一点，它需要做的就是这个。

```
<flow name="main" doc:name="main">
<http:inbound-endpoint exchange-pattern="request-response"
    address="http://localhost:8081/example" doc:name="HTTP" />
<byte-array-to-string-transformer
    doc:name="Byte Array to String" />
<cxf:proxy-service namespace=""
        service="" payload="envelope"
        wsdlLocation=""
        enableMuleSoapHeaders="false" doc:name="ProxyService"/>
<cxf:proxy-client payload="envelope" enableMuleSoapHeaders="true" doc:name="ProxyClient" />
<http:outbound-endpoint exchange-pattern="request-response"
        address=""
        doc:name="request" />
<byte-array-to-string-transformer
    doc:name="Byte Array to String" />
<logger message="The payload after the request is:#[payload]"
    level="INFO" doc:name="Logger" />
<choice doc:name="Choice">
...
<otherwise>
    <processor-chain>
        <logger message="Failed authentication is:#[payload]" level="INFO"
            doc:name="Logger" />
        <http:response-builder status="401"
            doc:name="HTTP Response Builder">
            <set-payload value="Authentication Failed" />
        </http:response-builder>
    </processor-chain>
</otherwise> 
```

我通过soapUI收到的错误

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <soap:Fault>
         <faultcode>soap:Server</faultcode>
         <faultstring>Could not find a transformer to transform "SimpleDataType{type=org.mule.transport.http.HttpResponse, mimeType='text/xml'}" to "SimpleDataType{type=java.io.InputStream, mimeType='*/*'}". (org.mule.api.transformer.TransformerException). Message payload is of type: PostMethod</faultstring>
      </soap:Fault>
   </soap:Body>
</soap:Envelope>. 
```

对我来说，这说明我当前的消息是 text/xml，它正试图返回一个未知类型。我尝试将构建器的内容类型设置为 text/xml，结果相同

编辑：当前状态是 HTTP/1.1 500 Internal Server Error

非常感谢您花时间阅读和任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T16:28:33.657

您不能在使用它的`http:response-builder`地方使用它，因为它的输出不会由 HTTP 入站端点直接处理，而是由`cxf:proxy-service`. 当响应向*下游流向*入站端点时，它会命中`cxf:proxy-service`负责准备 SOAP 响应的流：它只能处理具有 SOAP 有效负载的消息，并将严格控制状态代码，覆盖任何设置它的尝试流中的其他地方。此外，在您的情况下，您正在构建一个非 SOAP 响应，`cxf:proxy-service`当它处理该响应时，这将更加令人不快。

所以诀窍就是将登录失败的检测与HTTP响应的构建分开，将HTTP响应构建定位在流的响应阶段。这给出了：

```
<flow name="main" doc:name="main">
    <http:inbound-endpoint exchange-pattern="request-response"
        address="http://localhost:8081/example" doc:name="HTTP" />
    <response>
        <expression-filter expression="#[flowVars.authenticationFailed]" />
        <http:response-builder status="401"
            doc:name="HTTP Response Builder">
            <set-payload value="Authentication Failed" />
        </http:response-builder>
    </response>
    <byte-array-to-string-transformer
        doc:name="Byte Array to String" />
    <cxf:proxy-service namespace=""
            service="" payload="envelope"
            wsdlLocation=""
            enableMuleSoapHeaders="false" doc:name="ProxyService"/>
    <cxf:proxy-client payload="envelope" enableMuleSoapHeaders="true" doc:name="ProxyClient" />
    <http:outbound-endpoint exchange-pattern="request-response"
            address=""
            doc:name="request" />
    <byte-array-to-string-transformer
        doc:name="Byte Array to String" />
    <logger message="The payload after the request is:#[payload]"
        level="INFO" doc:name="Logger" />
    <set-variable variableName="authenticationFailed" value="false" />
    <choice doc:name="Choice">
    ...
    <otherwise>
        <processor-chain>
            <logger message="Failed authentication is:#[payload]" level="INFO"
                doc:name="Logger" />
            <set-variable variableName="authenticationFailed" value="true" />
        </processor-chain>
    </otherwise> 
```

请注意使用流变量（名为`authenticationFailed`）来控制响应。

# magento - Magento 示例数据安装：表已存在

> ID：12943435
> 
> 赞同：3
> 
> 时间：2012-10-17T21:10:45.473
> 
> 标签：magento, sample-data

我正在尝试安装 Magento 的示例数据几天，并尝试了很多东西，但似乎没有任何效果。

我在 Windows 7 上使用 easyphp 5.3.3.1。

我下载了示例数据文件并运行 SQL 来为示例数据创建表。之后我运行了 Magento 安装，在它询问数据库信息之后，我收到以下错误

```
Zend_Db_Statement_Exception 对象
(
    [_previous:Zend_Exception:private] =>
    [消息：受保护] => SQLSTATE [42S01]：基表或视图已存在：1050 表 'admin_assert' 已存在
[字符串：异常：私人] =>
    [代码：受保护] => 42
    [文件：受保护] => I:\EasyPHP-5.3.3.1\www\magento\magento\lib\Zend\Db\Statement\Pdo.php
    [行：受保护] => 234
    [trace:Exception:private] => 数组
        (
            [0] => 数组
                (
                    [文件] => I:\EasyPHP-5.3.3.1\www\magento\magento\lib\Varien\Db\Statement\Pdo\Mysql.php
                    [行] => 110
                    [功能] => _执行
                    [类] => Zend_Db_Statement_Pdo
                    [类型] => ->
                    [参数] => 数组
                        (
                            [0] => 数组
                                (
                                )

                        )

                )

            [1] => 数组
                (
                    [文件] => I:\EasyPHP-5.3.3.1\www\magento\magento\lib\Zend\Db\Statement.php
                    [行] => 300
                    [功能] => _执行
                    [类] => Varien_Db_Statement_Pdo_Mysql
                    [类型] => ->
                    [参数] => 数组
                        （.......

```

等等....

它只是没有完成安装。什么可能导致此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:51:37.540

您知道您应该在安装 Magento 之前安装示例数据吗？当 Magento 已经创建了一些表时，您似乎正在尝试安装数据。

1）清空数据库。

2) 将数据导入数据库。

3）安装一个新的 Magento

[http://www.magentocommerce.com/knowledge-base/entry/installing-the-sample-data-for-magento](http://www.magentocommerce.com/knowledge-base/entry/installing-the-sample-data-for-magento)

# java - 如何在 Alfresco/Activiti 工作流中检索 Aspect 值

> ID：12943441
> 
> 赞同：0
> 
> 时间：2012-10-17T21:10:59.373
> 
> 标签：java, workflow, share, alfresco, ecm

在我的工作流程中，我希望能够使用文档方面设置变量。现在我知道使用文档的属性设置一个变量，我会做类似的事情......

```
task.setVariable('wf_caseType', bpm_package.children[0].properties["hearing:caseType"]); 
```

这只是基于查看[Alfresco Javascript API](http://wiki.alfresco.com/wiki/4.0_JavaScript_API)。但是，我没有看到任何有关检索文档方面的内容。

到目前为止，我所做的是在文件被带到某个空间时执行的一些 javascript 中，我们创建了这个称为 caseID 的方面，类似于下面..

```
var caseID=0

var props=new Array(1);
props["wf:caseIDNum"]=caseID;
var newAspect=newNewSpaceName.addAspect("wf:caseID",props); 
```

所做的基本上是将 caseID 方面添加到在脚本中创建的文件夹中，随后该文件夹中的文档也继承了这一方面。

所以我在想将它添加到变量中可能会以相同的方式工作，即：

```
task.setVariable('wf_caseId', bpm_package.children[0].aspect["hearing:caseId"]); 
```

然而，事实证明并非如此。有没有人有这样做的经验或者可以在这里提供一些建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:34:37.097

将方面添加到节点后，您可以像获取/设置节点内容类型定义的任何属性一样获取/设置其任何属性。没有区别。因此，您的第一个 setVariable 调用无论是在类型或方面中定义的 hear:caseType 都可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:24:54.913

[JavaScript API](http://wiki.alfresco.com/wiki/4.0_JavaScript_API)页面描述`aspects`了 ScriptNode 对象的属性：

> *方面* 应用于节点的方面的只读数组（作为完全限定的 QName 字符串）。（这是作为 Java HashSet 返回的）

您的问题是指“方面”（单数）-但节点通常（通常？）具有多个方面

您链接到的[JavaScript API Cookbook](http://wiki.alfresco.com/wiki/JavaScript_API_Cookbook)页面也包含向节点添加方面的示例。

**更新：**现在您已经更新了问题，我看到您想要访问在方面中定义的属性 - 请参阅解决此问题的 Jeff 的回答！

# restlet - Restlet 服务器套接字超时

> ID：12943447
> 
> 赞同：5
> 
> 时间：2012-10-17T21:11:22.133
> 
> 标签：restlet

我有一个客户端向服务器发出请求，这可能需要一些时间来响应。

当服务器想要回复时，它会抛出以下异常：

> 连接已断开。它可能被客户关闭。
> 
> org.eclipse.jetty.io.EofException 在 org.eclipse.jetty.io.nio.SelectChannelEndPoint.blockWritable(SelectChannelEndPoint.java:435) 在 org.eclipse.jetty.http.AbstractGenerator.blockForOutput(AbstractGenerator.java:512) 在org.eclipse.jetty.server.HttpOutput.write(HttpOutput.java:159) 在 org.eclipse.jetty.server.HttpOutput.write(HttpOutput.java:101) 在 sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder. java:221) 在 sun.nio.cs.StreamEncoder.implWrite(StreamEncoder.java:282) 在 sun.nio.cs.StreamEncoder.write(StreamEncoder.java:125) 在 sun.nio.cs.StreamEncoder.write(StreamEncoder .java:135) 在 java.io.OutputStreamWriter.write(OutputStreamWriter.java:220) 在 java.io.Writer.write(Writer.java:157) 在 org.restlet.representation.StringRepresentation.write(StringRepresentation.java: 237）在 org.restlet.representation。CharacterRepresentation.write(CharacterRepresentation.java:76) at org.restlet.engine.adapter.ServerCall.writeResponseBody(ServerCall.java:509) at org.restlet.engine.adapter.ServerCall.sendResponse(ServerCall.java:453) at org .restlet.ext.jetty.internal.JettyCall.sendResponse(JettyCall.java:312) 在 org.restlet.engine.adapter.ServerAdapter.commit(ServerAdapter.java:196) 在 org.restlet.engine.adapter.HttpServerHelper.handle (HttpServerHelper.java:153) 在 org.restlet.ext.jetty.JettyServerHelper$WrappedServer.handle(JettyServerHelper.java:170) 在 org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:452) 在 org. eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:894) 在 org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler。org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:943) 的内容(AbstractHttpConnection.java:948) org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235) 的 org.eclipse .jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77) 在 org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:622) 在 org.eclipse.jetty.io.nio.SelectChannelEndPoint$1。在 org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538) 的 org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603) 运行(SelectChannelEndPoint.java:46) ) 在 java.lang.Thread.run(Thread.java:722)jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77) at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:622) at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run (SelectChannelEndPoint.java:46) 在 org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603) 在 org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)在 java.lang.Thread.run(Thread.java:722)jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:77) at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:622) at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run (SelectChannelEndPoint.java:46) 在 org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:603) 在 org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:538)在 java.lang.Thread.run(Thread.java:722)QueuedThreadPool$3.run(QueuedThreadPool.java:538) 在 java.lang.Thread.run(Thread.java:722)QueuedThreadPool$3.run(QueuedThreadPool.java:538) 在 java.lang.Thread.run(Thread.java:722)

发生这种情况时，客户端将无限期挂起。

这是一个重现问题的代码示例：

服务器端：

```
 public static void main(String[] args) throws Exception  {
        Context context = new Context();
        Server server = new Server(context, Protocol.HTTP, 8182, DummyServerResource.class);
        server.start();
    }

public class DummyServerResource extends ServerResource {

    @Get
    public String retrieve() throws InterruptedException {
        Thread.sleep(1000 * 20);
        return "Dummy";
    }
} 
```

客户端：

```
public static void main(String[] args) throws IOException, InterruptedException {
    Context context = new Context();
    context.getParameters().add("maxIoIdleTimeMs", "0");
    Client client = new Client(context, Protocol.HTTP);
    ClientResource cr = new ClientResource("http://localhost:8182");
    cr.setNext(client);
    Representation get = cr.get();
    System.out.println(get.getText());
    Thread.sleep(1000 * 50);
    ClientResource cr2 = new ClientResource("http://localhost:8182");
    cr2.setNext(client);
    Representation get2 = cr2.get();
    System.out.println(get2.getText());

} 
```

这里发生了什么，如何消除错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T15:18:54.840

几周前，我在 GitHub 上打开了一个关于此的问题。感谢分享。 [https://github.com/restlet/restlet-framework-java/issues/675](https://github.com/restlet/restlet-framework-java/issues/675)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-12T18:47:46.043

默认情况下，服务器会在 30 秒后关闭空闲套接字，并且不会尝试重新打开新套接字。

我发现的解决方法是将`ioMaxIdleTimeMs`参数设置为 0，这意味着没有超时。

这是工作服务器代码：

```
public static void main(String[] args) throws Exception  {
    Context context = new Context();
    context.getParameters().add("maxIoIdleTimeMs", "0");
    context.getParameters().add("ioMaxIdleTimeMs", "0");
    Server server = new Server(context, Protocol.HTTP, 8182, DummyServerResource.class);
    server.start();
} 
```

请注意，我设置了 maxIoIdleTimeMs 和 ioMaxIdleTimeMs。在我的情况下，使用的是 ioMaxIdleTimeMs。这是Jetty使用的参数。

但是如果你没有使用 Jetty，我怀疑它可能会使用 org.restlet.engine.connector.BaseHelper.java 中定义的参数 maxIoIdleTimeMs

# jquery - 工具提示内容 qTip2 jQuery

> ID：12943448
> 
> 赞同：0
> 
> 时间：2012-10-17T21:11:23.883
> 
> 标签：jquery, tooltip, qtip2

我试图让它工作，但它只是想要......

警报提醒正确的内容..有什么想法吗？

```
 function initToolTip() {
        $('.product').qtip({
            content: $(this).find('.product-info').html(),
            style: 'ui-tooltip-shadow'
         });
         $('.product').on('hover',function(){
            //alert($(this).find('.product-info').html());
         });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:15:30.570

这里

`$(this)`**不在**第 一种情况`.product`下..

`$(this)`指的是工具提示对象..

使用自定义函数检索该 ..

```
$('.product').qtip({
            content: {
               text: function(api) {
                return $(this).find('.product-info').html() ;
               }
            },
            style: 'ui-tooltip-shadow'
         }); 
```

# c - vsscanf 读取长度

> ID：12943449
> 
> 赞同：0
> 
> 时间：2012-10-17T21:11:25.657
> 
> 标签：c, scanf

我需要的是：

1) 像 sscanf 那样从字符串中读取 2) 像 sscanf 那样用 "%n" 测量已处理序列的长度 3)`format`从上面接受和其他参数（不能控制它）

有没有办法做到这一点？

```
size_t read = 0; //Accumulator of the length of processed characters

void readfn (char* source_string, char* fmt, va_list args)
{
  int length;

  size_t fmtlen = strlen(fmt);

  char* fmt_and_lenght = (char*)realloc(fmt, fmtlen + 3);

  fmt_and_length[fmtlen]     = '%';
  fmt_and_length[fmtlen + 1] = 'n';
  fmt_and_length[fmtlen + 2] = '\0';

  va_list args_and_length = va_append(args, length); //here is the problem, i need to add &length to the list (i dont care if the list is created from scretch

  vsscanf(source_str, fmt_and_length, args_and_length); //here i finally capture the length of processed string

  read += length; //and i do whatever i wanted to do with it
} 
```

即使 fmt 不包含“%n”并且参数列表之前没有捕获它，它也会简单地计算消耗的字符数？

**编辑**：如果有 vsnscanf 或者它应该有什么名字肯定会更好，这将得到处理的字符数。但是我通过将格式字符串拆分为未转义的 % 来解决这个问题。如果它后面没有*，我会获取一个参数并迭代地处理所有参数，每次我添加“%n”并在最后总结长度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:41:42.900

没有便携的方法可以做到这一点。我建议你重构你的代码，这样你就不需要这样做了。[您也许可以用ffcall 库](http://www.gnu.org/software/libffcall/)拼凑一些东西，但它会变得凌乱而脆弱。

# jquery-mobile - 允许滚动 tbody 的 jQuery Mobile 兼容网格

> ID：12943452
> 
> 赞同：2
> 
> 时间：2012-10-17T21:11:39.140
> 
> 标签：jquery-mobile, grid

我需要在 jQuery Mobile 应用程序中放置一个固定高度表。如果行数超过表格的高度，表格的主体应该可以滚动。我刚刚在 jQuery 移动页面中尝试了 jqGrid 插件，但它没有显示滚动条。有没有人成功地将任何一种流行的网格（jqGrid、Flexigrid、SlickGrid、DataTables 等）与 jQuery mobile 集成？

[PS 我在这里](http://www.trirand.com/blog/jqgrid/mobile/)找到了 jqGrid 的 jQuery Mobile 版本，但在我的 Android 设备上看起来非常慢。想知道有没有其他人有过类似的经历。

# c++ - 如何创建一个可以在 GUI 对话框模式或通过命令行启动的 C++ MFC 程序？

> ID：12943463
> 
> 赞同：4
> 
> 时间：2012-10-17T21:12:27.980
> 
> 标签：c++, mfc, cmd, arguments, line

我有一个可以工作的 C++ MFC 程序，但我也希望能够通过命令行调用一个更简单的版本。（如果有 cmd 行参数，这通过使用 cmd 行版本来工作。）我希望程序使用当前打开的“cmd”窗口运行，并在某种程度上为它创建一个新的 shell。在 InitInstance() 中，我有...

```
CString cmdLine;
cmdLine.Format("%s", this->m_lpCmdLine);
if(cmdLine.IsEmpty())
    dlg.DoModal(); // Run application normally
else
{
    CString header = "Welcome to the program!";
    AttachConsole(ATTACH_PARENT_PROCESS);     // Use current console window
    LPDWORD charsWritten = 0;
    WriteConsole(GetStdHandle(STD_OUTPUT_HANDLE), header, header.GetLength(), NULL, NULL);
} 
```

如何将输入输入到我的程序中？cin 似乎不起作用。我试过这样的事情：

```
char input[10] = "";
while((strcmp(input, "q") != 0) && (strcmp(input, "quit") != 0))
    scanf("%s", input); 
```

但它似乎不起作用，因为命令窗口等待新的提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T22:02:41.133

根本问题是您的 MFC 程序在其 EXE 标头中未标记为控制台模式程序。所以命令处理器没有理由等待它完成，就像它通常对控制台模式程序所做的那样。您现在有*两个*程序试图从控制台读取，您和 cmd.exe。你输了。

有几种解决方法，都没有吸引力：

*   开始你的程序`start /wait yourapp.exe arg1 arg2...`
*   将 Linker + System + SubSystem 设置更改为 Console。当您发现您没有任何参数时，请致电 FreeConsole。flash 有点恶心，Java 程序员都知道
*   当你发现你确实有参数时调用 AllocConsole()。您将获得自己的控制台。

# java - JavaMail 有时连接到 gmail，有时不连接。似乎随机

> ID：12943464
> 
> 赞同：0
> 
> 时间：2012-10-17T21:12:29.390
> 
> 标签：java, smtp, gmail, jakarta-mail

我一直在尝试使用 JavaMail 从学校项目的程序中发送电子邮件。我让它工作，但现在它只是偶尔工作。真的，不管我在哪里（在学校、在家、在咖啡馆），它有时有效，有时无效。

我得到的错误信息是：

> 线程“AWT-EventQueue-0”中的异常 java.lang.RuntimeException：javax.mail.MessagingException：无法连接到 SMTP 主机：smtp.gmail.com，端口：465；嵌套异常是：java.net.ConnectException: Connection timed out: connect at varsling.SendEmail.sendEmail(SendEmail.java:40)

奇怪的是我没有以任何方式更改代码。JavaMail 和 gmail 连接有问题吗？

无论如何，这是我的代码:)

```
import java.util.Properties;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class SendEmail {

public void sendEmail(String text, String to, String username, String password) {
    Properties props = new Properties();
    props.put("mail.smtp.host", "smtp.gmail.com");
    props.put("mail.smtp.socketFactory.port", "465");
    props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
    props.put("mail.smtp.auth", "true");
    props.put("mail.smtp.port", "465");

    Session session = Session.getDefaultInstance(props,
    new javax.mail.Authenticator() {
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(username, password);
        }
    });

    try {
        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress("from@no-spam.com"));
        message.setRecipients(Message.RecipientType.TO,
                        InternetAddress.parse(to));
        message.setSubject("Danger!");
        message.setText(text);

        Transport.send(message);
        System.out.println("Sent");
    } catch (MessagingException e) {
        throw new RuntimeException(e);
    }
} } 
```

将 setFrom() 更改为其他任何内容并没有真正的帮助，因此我将其设置为默认值（几周前我在某个网站的示例中发现的内容）。

有没有人有任何修复？:S

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:37:23.823

正如上面的评论所说，这听起来像是网络问题，而不是 JavaMail 问题。也许您的防火墙或防病毒软件会干扰您的连接能力？

您可能还想阅读[常见错误的 JavaMail FAQ 条目](http://www.oracle.com/technetwork/java/javamail/faq/index.html#commonmistakes)并清理您的代码，尽管我怀疑它与您的问题有关。

# google-geocoder - 使用 gmaps v3 的地理编码对多个地址进行地理编码

> ID：12943467
> 
> 赞同：0
> 
> 时间：2012-10-17T21:12:31.040
> 
> 标签：google-geocoder

我需要使用 gmap V3 的地理编码对几个地址进行地理编码。首先我只尝试了一个并且它有效，但是当我传递我在 Json 中的几个地址时，它只显示第一个地址的坐标。

我试过这段代码：

```
$(document).ready(function() {
getcoords(datos);                      

});

 function getcoords(datos){

 Locgoogle = new google.maps.Geocoder();
 var dataJson = eval(datos);

        for(i=0;i<10;i++){  
            var dir=dataJson[i].dir ; 
            var id=dataJson[i].id   ;
            alert(dir);

            setTimeout(function() {GoogleCall(dir,id)}, 30000);

        }

 }

function GoogleCall(dir, id) {  

 Locgoogle.geocode({
        address: dir
    }, function(results,status) {
        if (status == google.maps.GeocoderStatus.OK) {
        var lat1 = results[0].geometry.location.lat();
        var lng1 = results[0].geometry.location.lng();
        $("#testDiv").append("latitudeGoogle:" + lat1 + "<p>longitudeGoogle:" + lng1 + "</p>");
        } else {
        alert("Geocode was not successful for the following reason: " + status);
        }
    });
 } 
```

然后它没有给我错误，但它让我 11 倍于相同的坐标......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T05:00:47.327

两年前，谷歌对其 Maps API 引入了相当严格的政策。（准确地说是 V3，仍然有效的 V2 的策略更软。）Geocoding API 特别严格：

> 使用 Google 地理编码 API 的查询限制为每天 2,500 个地理定位请求。[...] 此外，我们强制执行请求速率限制以防止滥用服务。[...] 注意：地理编码 API 只能与谷歌地图一起使用；禁止在未在地图上显示的情况下对结果进行地理编码。

[https://developers.google.com/maps/documentation/geocoding/#Limits](https://developers.google.com/maps/documentation/geocoding/#Limits)

然而，谷歌有一个网页建议如何处理：

[https://developers.google.com/maps/articles/geocodestrat](https://developers.google.com/maps/articles/geocodestrat)

一种策略显然是缓存，正如一节中提到的那样。另一个正在等待下一个请求。

如果您必须执行如此多的请求并且负担不起商业包，也许您应该更改 API。我对 OSM API 有很好的体验：[http ://wiki.openstreetmap.org/wiki/Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim)

至少反向地理编码器对我来说非常有效。您可以使用 jQuery 的`ajax()`函数发出请求，并且可以自己进行适当的错误处理。尽管 OSM 有非常软的速率限制，但某些请求可能会由于服务器负载高等原因而失败。

# mysql - 左连接比较和 md5(concat()) mysql

> ID：12943470
> 
> 赞同：0
> 
> 时间：2012-10-17T21:12:41.133
> 
> 标签：mysql, left-join

首先，对不起我的英语。

我想将两条记录与生成的 md5 进行比较：

我在 table2 中插入从 table1 带来的信息

```
INSERT INTO table2 (id_table_2, hash_string) 
SELECT t.id, MD5 (CONCAT (t.firstname, t.lastname)) AS hash_string
FROM table1 t WHERE t.id = $some_value 
```

之后我想知道 table1 中的哪些记录在 table2 中不存在，但我无法获得我想要的结果。我这样做：

```
SELECT t.id, MD5(CONCAT(t.firstname, t.lastname)) , ti.hash_string 
FROM table1 t 
    LEFT JOIN table2 ti ON (t.id = ti.id_table_2 
    AND MD5(CONCAT(t.firstname, t.lastname)) != ti.hash_string)
    WHERE t.state = 2 
```

但它不起作用。

我想要的是表 1 中不在 table2 中的记录，但从那里，如果 md5 哈希不同，也显示它。但我没能得到它。我很感激你能给我的所有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:16:36.217

也许您想要这个，请参阅最后添加的行，我也更改`!=`为`=`：

```
SELECT t.id, MD5(CONCAT(t.firstname, t.lastname)) , ti.hash_string 
FROM      table1 t 
LEFT JOIN table2 ti ON (t.id = ti.id_table_2 
                   AND MD5(CONCAT(t.firstname, t.lastname)) = ti.hash_string)
WHERE t.state = 2
  AND ti.id_table_2 IS NULL 
```

这个技巧的基本形式：

```
SELECT *
FROM      a
LEFT JOIN b ON a.id = b.id
WHERE b.id IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:22:17.840

我相信这应该对您有所帮助（将 hash_string 移出 join 并附加为 where 子句）：

```
SELECT t.id, MD5(CONCAT(t.firstname, t.lastname)) , ti.hash_string 
FROM table1 t 
LEFT JOIN table2 ti ON (t.id = ti.id_table_2)
WHERE t.state = 2 
   AND MD5(CONCAT(t.firstname, t.lastname)) != ti.hash_string 
   AND ti.id_table_2 is NULL; 
```

# javascript - 为什么我的 css 语音气泡如此频繁地移位？我怎样才能防止这种情况？

> ID：12943472
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:13:00.180
> 
> 标签：javascript, html, css

我使用 css3 方法来绘制语音气泡。

有时，当我加载我的网站时，语音气泡会被取代。

见[http://cl.ly/image/1A0Y3z401D23](http://cl.ly/image/1A0Y3z401D23)

**然后我必须按几次刷新按钮才能以正确的方式呈现。**

见[http://cl.ly/image/3V043M1K1l0n](http://cl.ly/image/3V043M1K1l0n)

**注意**：没有成功或失败的标记。它始终是相同的标记。

我用chrome对此进行了测试，它经常发生。您可以在此处查看公共页面之一[http://storyzer.com/faq](http://storyzer.com/faq)

****编辑****

我添加此代码是因为我需要显示一些代码的注释。

负责绘制语音气泡的 CSS 代码

```
/******** talkbubble_left **************/
.gradient_header_talkbubble {
    background: #ffffff; /* Old browsers */
    background: -moz-linear-gradient(top, #ffffff 0%, #f8f8f9 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#f8f8f9)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #ffffff 0%,#f8f8f9 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #ffffff 0%,#f8f8f9 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #ffffff 0%,#f8f8f9 100%); /* IE10+ */
    background: linear-gradient(to bottom, #ffffff 0%,#f8f8f9 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#f8f8f9',GradientType=0 ); /* IE6-9 */
}
.talkbubble_left {
    position: relative;
    background: #white;
    border: 1px solid #DCDDDE;
}
.talkbubble_left:after, .talkbubble_left:before {
    right: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
    top: 50%;
}
.talkbubble_left:after {
    border-top: 5px solid transparent;
    border-right: 10px solid #FBFBFB;
    border-bottom: 5px solid transparent;
    margin-top: -5px;
}
.talkbubble_left:before {
    border-top: 6px solid transparent;
    border-right: 11px solid #DCDDDE;
    border-bottom: 6px solid transparent;
    margin-top: -6px;
}

#header .talkbubble{
    display: inline-block;
    position: relative;
    top: 10px; left: 0; right: 0; bottom: 0;
    height: 47px;   
    width: 889px;
    float: right;   
} 
```

如何使用代码防止这种情况？可以是 javascript 或 css 或 html 或任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T00:33:42.403

浮动`.bot50x50`并`.talkbubble`离开并摆脱所有`position: relative;`样式，除非绝对需要。

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

# android - 如何在 Android 中创建一个球？

> ID：12943475
> 
> 赞同：3
> 
> 时间：2012-10-17T21:13:18.813
> 
> 标签：android, eclipse

我一直在尝试在 Eclipse 中创建一个球。我试图找出在[这篇文章](https://stackoverflow.com/questions/12904100/Android-app-force-closes-when-painting-a-ball)中要做什么，但我似乎不知道在我的 Ball 课上放什么。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:19:27.667

这是一个简单的 java 类，您可以从中创建一个球对象：

```
public class Ball {

    private int x, y, r;
    private Color c = Color.YELLOW;

    public Ball (int x, int y, int r)
    {
        this.x = x;
        this.y = y;
        this.r = r;
    }

    // draws the ball
    public void draw (Graphics g)
    {
        g.setColor(c);
        g.fillOval(x-r, y-r, 2*r, 2*r);
    }   

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T14:40:43.413

试试这个，以防你决定改变主意。

```
public class MainActivity extends Activity {
private int c = Color.YELLOW;
private Canvas g;
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    draw();
    }

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

// draws the ball
public void draw ()
{
    Display display = getWindowManager().getDefaultDisplay();

    int width = display.getHeight();
    int height = display.getWidth();

    Bitmap bitmap = Bitmap.createBitmap(width, height, Config.RGB_565);

    g = new Canvas(bitmap);
    g.drawColor(c);
    Paint paint = new Paint();
    paint.setColor(Color.BLACK);
    g.drawCircle(50, 10, 25, paint); //Put your values

    // In order to display this image, we need to create a new ImageView that we can display.
    ImageView imageView = new ImageView(this);

    // Set this ImageView's bitmap to ours
    imageView.setImageBitmap(bitmap);

    // Create a simple layout and add imageview to it.
    RelativeLayout layout = new RelativeLayout(this);
    RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,
    LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.CENTER_IN_PARENT);
    layout.addView(imageView, params);
    layout.setBackgroundColor(Color.BLACK);

    // Show layout in activity.
    setContentView(layout);   
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T22:52:11.087

我知道渲染球体的唯一方法是在 openGl 中 .. 在[这里查看](https://stackoverflow.com/questions/3811082/spinning-globe-in-opengl-es)

对于 2D 渲染，您可能会看到这个 tut .. 它安静简单 ..[链接](http://android.nakatome.net/2010/04/graphics-basics.html)

# c - typedef 变量上缺少强制转换的编译器警告

> ID：12943476
> 
> 赞同：4
> 
> 时间：2012-10-17T21:13:23.273
> 
> 标签：c, gcc

我找不到这样做的方法，但是是否有 GCC/LLVM 的编译器标志，我可以在其中得到它来警告我：

```
typedef float distance_feet_t;
typedef float distance_meters_t;

void shouldWarnMe ( void )
{
    distance_feet_t feet = 10.0f;
    distance_meters_t meters = 20.0f;

    /* this should generate a warning */
    distance_meters_t total = meters + feet;
} 
```

本质上，我想重新定义变量类型，这样如果我开始混合它们，编译器会警告我缺少演员表。

我试过 -Wall: 没有警告。

有一些方法可以在不使用 typedef 的情况下解决这个问题。但是问题是，有没有一种方法可以使用所描述的 typedef 来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:17:25.767

没有。就编译器而言，`distance_feet_t`并且`distance_meters_t`是完全相同的类型。我不知道在纯 C 中执行此操作的任何方法，但是您绝对可以在 C++ 中执行此操作，方法是为每种不同的单元类型定义一个类并定义适当的重载运算符（尽管那里有很多烦人的样板文件）。

旁注：以后缀结尾的全局范围内的标识符`_t`被认为是 POSIX 标准保留的；我建议避免使用此类标识符，尽管发生冲突的可能性非常低（如果发生冲突，很容易修复）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:34:10.830

没有“干净”的方法，但有一些技巧。

[在 C 中强制执行强类型检查（typedefs 的类型严格性）](https://stackoverflow.com/questions/376452/enforce-strong-type-checking-in-c-type-strictness-for-typedefs)

*如果我真的*必须这样做，我通常会使用这个`struct`技巧，否则我只使用 lint。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:18:12.100

`typedef`不会创建新类型，而是为现有类型创建别名。

它的意思是：

```
typedef float distance_feet_t;
typedef float distance_meters_t; 
```

`float`,`distance_feet_t`并且`distance_meters_t`是完全相同类型的不同名称。*

# xcode - 为 Xcode 项目设置默认方案

> ID：12943477
> 
> 赞同：8
> 
> 时间：2012-10-17T21:13:24.190
> 
> 标签：xcode

我有一个 Xcode 项目 MyApp（带有 1 个目标 MyApp），其中包括另一个项目 LibProject（带有 2 个目标，lib 和 app）。我在 Xcode ui 中选择了自动创建方案，当我第一次打开项目时，它确实创建了方案，但是选择了嵌套 LibProject 中的一个方案，而我希望选择 MyApp 中的单个目标/方案。我可以在事后更改方案并且 UI 会记住，但我不想让 Xcode 默认使用不正确的方案。

方案最终的顺序：

```
lib (*with this one selected)
app
MyApp 
```

知道如何为新创建的方案选择默认值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-02T12:34:53.940

我正是这个问题。我们在一个工作区中有三个项目，其中一个依赖于另外两个。为了构建一切，我们构建了主项目，但是，在某种程度上，但不能证明，在我们切换到 Xcode 6 的时候，我们撤出时提出的方案将是子项目之一。即使我们将它更改为主项目，它也会随着 git 的每次拉取而恢复。所以，我知道这不是控制它的用户设置，而是隐藏在一个公共文件中的东西，因为我们的用户设置文件不在我们的 git repo 中。

我设法将它改回我们的工作区。我做了三件事：-

首先，我在主项目中重新排序了一些文件，以防万一它是一些隐藏的项目设置，但这不起作用；

然后我注意到顶层项目设置为并行构建，因此我将其设置为不这样做，因为它确实需要链接其他两个项目的输出。Xcode 实际上管理得很好，但它是一种强制更改方案文件的方法。这似乎也没有解决它；

我的第三个更改是在工作区中删除并重新添加子项目；我还颠倒了两个子项目的顺序。这个最后的改变确实使主要项目的方案出现在其他用户面前，所以我相信是这样做的。

我列出了其他项目，以防万一这不仅仅是一个步骤，而且由于早期的尝试，我很幸运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:22:57.807

您是否尝试过 Xcode 的 Product 菜单中的 Edit Scheme... 或 New Scheme... 或 Manage Schemes...。您应该能够将方案编辑为您想要的，Xcode 会为项目记住它。

![在此处输入图像描述](../Images/610d3479e453afccfa15ab32691f8834.png)

# c++ - 虚拟模板功能解决方法

> ID：12943480
> 
> 赞同：1
> 
> 时间：2012-10-17T21:13:43.567
> 
> 标签：c++, templates, virtual-functions

我偶然发现了一个问题，我（我的任何知识渊博的同事也不知道）知道如何解决（解决问题）。最终的问题是无法创建虚拟模板功能。我已经彻底搜索了网络，找到了几种处理它的方法，但似乎没有一个适用于我的情况。

我不知道如何简短地描述这种情况，但我会尽力而为，希望它有意义。

问题是处理两条曲线，每条曲线都由一个或多个相同或不同曲线类型的段组成。因此，我开始为曲线段创建一个接口，其中包含将与之交互的曲线的模板类（例如，函数与两个不同曲线段之间的交点具有相同的类型）：

```
template<class curve> class curve_segment { // some methods here } 
```

然后，用户可以实现多种类型的曲线，并根据将与之交互的曲线实现适当的功能。例如`circle`和`line`，两者都可以交互：

```
class line :  public curve_segment<line>, public curve_segment<circle> { //... }
class circle :  public curve_segment<line>, public curve_segment<circle> { //... } 
```

之后，我有一个 class `cell`，它依赖于两个曲线段，以及一个`cell_base`封装它的基类：

```
template<class curve1, class curve2> class cell : public cell_base { 
  cell_base* up; cell_base* down;

  curve_segment<curve1>* segment_x;
  curve_segment<curve2>* segment_y;

  // some methods that depend on both curves
} 
```

最后，有一个由这些单元组成的二维网格 m*n，其中两条曲线由`curve_segments`可能不同类型的 m 和 n 组成，并由每个单元中的两个指针保持在一起。

问题开始显示何时将新的 curve_segment 添加到两条曲线之一。显而易见的解决方案是添加

```
template<class curve> virtual void add_curve_x(curve_segment<curve> seg) =0; 
```

到`cell_base`类中，其中的实现`cell`可以提取另一条曲线的适当段，并向其附加一个新单元格。例如，如果曲线`a`和`b`where`a`表示网格中的 x 轴，并且我们要向曲线添加另一个曲线段`a`，我们可以找到网格的右侧大多数单元格，提取每个此类单元格的 y 轴上的曲线, 并从中和新提供的段创建一个新单元格，该单元格将附加到它是正确的。

类型擦除不起作用，因为我们需要在`cell`创建时知道新添加的段的类型（我们需要将两个段的类型作为模板参数提供给`cell`类）。

将模板移动到`cell_base`类也行不通，因为这意味着在每次`cell`分配时我必须知道 next 的类型`curve_segment`。

有没有解决的办法？

**编辑**：按照建议，添加`add_curve_x`方法：

```
template<class curve1, class curve2>
template<class curve> 
cell<curve1, curve>* cell<curve1, curve2>::add_curve_x(curve_segment<curve1>* seg) {
  return new cell<curve1, curve>(seg, (curve_segment<curve>*)(this->segment_y));
} 
```

在这种情况下`seg`必须是类型`curve`，它必须实现`curve_segment<curve1>`。`segment_y`也有执行`curve_segment<curve>`。

**编辑2**：解释为什么演员在那里

[图片](http://i48.tinypic.com/14y4kmv.png)

以非粗体矩形为例。在这种情况下，有两条曲线，`a`2 段曲线`b`和 3 段曲线。class`line`也必须实现`curve_segment<line>`，`curve_segment<circle>`而 circle 也必须同时实现。现在让我们将另一个贝塞尔曲线段添加到 curve `a`。类`bezier`必须实现`curve_segment<line>`and `curve_segment<circle>`，并且`line`and`circle`必须实现`curve_segment<bezier>`。

让我们看看我们如何创建粗体三的中间部分`cells`。我们会打电话

```
add_curve_x<bezier>(new bezier(...)); 
```

在类型的单元格对象上`cell<circle, circle>`。

参数`seg`将是一个新`bezier`对象（可以转换为`curve_segment<circle>`），这也是`curve`类型，并且`segment_y`必须转换为`curve_segment<bezier>`，因为这是它在新创建的单元格中与之交互的曲线类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T15:01:11.737

添加`curve_segment_base`：

```
class curve_segment_base {
   // for double dispatching here:
  virtual cell_base* add_curve_x(cell_base* cell) = 0;
};

template<class curve> 
class curve_segment : public virtual curve_segment_base { 
     // some specific methods here 
     // for double dispatching here:
     virtual cell_base* add_curve_x(cell_base* cell)
     {
         // this has to be moved to cpp file due to dependency from cell_base
         return cell->add_curve_x(this); // now the correct method from cell is called
     }
}; 
```

因此，您可以将此方法作为虚拟方法添加到您的 cell_base

```
class cell_base {
   virtual cell_base* add_curve_x(curve_segment_base* seg) = 0;

   // methods necessary for double dispatching here:
   virtual cell_base* add_curve_x(curve_segment<line>* seg) = 0;
   virtual cell_base* add_curve_x(curve_segment<circle>* seg) = 0;
   ...
}; 
```

所以你的方法看起来像，这里有双重调度：

```
template<class curve1, class curve2>
virtual cell_base* cell<curve1, curve2>::add_curve_x(curve_segment_base* seg) {
  return seg->add_curve_x(this);
} 
```

而且您必须为所有段实现所有真正的实现方法：

```
template<class curve1, class curve2>
virtual cell_base* cell<curve1, curve2>::add_curve_x(curve_segment<line>* seg) {
  return new cell<curve1, line>(...);
}
template<class curve1, class curve2>
virtual cell_base* cell<curve1, curve2>::add_curve_x(curve_segment<circle>* seg) {
  return new cell<curve1, circle>(...);
} 
```

# asp.net-mvc - MVC 剃刀分离的 dll

> ID：12943483
> 
> 赞同：1
> 
> 时间：2012-10-17T21:13:51.090
> 
> 标签：asp.net-mvc, razor, razorgenerator

我有两个非常相似的站点，它们在某些地方有很多共同点，但在其他一些地方却完全不同。所以我创建了三个 mvc4 应用程序 MainSiteA、MainSiteB、SharedUI 并使用 RazorGenerated 在两个站点之间预编译（和共享）视图。当前的问题是我的 SharedUI 视图优先于 MainSiteA 上的已编译或非编译视图，我希望它使其反之亦然。

有：

```
SiteA:
    Views/Index.cshtml (a)

SiteB:
    Views/Index.cshtml (b)
    Views/Header.cshtml (b)

SharedUI:
    Views/Index.cshtml (s)
    Views/Header.cshtml (s)
    Views/Footer.cshtml (s) 
```

* * *

如何以这种方式根据站点访问特定页面：

```
SiteA
Index.cshtml (a)
Header.cshtml (s)
Footer.cshtml (s)

SiteB
Index.cshtml (b)
Header.cshtml (b)
Footer.cshtml (s) 
```

我希望 MVC 首先查看它自己的 MVC 应用程序，如果未找到视图，请查看视图的共享库 (SharedUI)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-07T07:26:25.373

RazorGenerator.Mvc 2.1.0 包括 CompositePrecompiledMvc​​Engine 类。如果您使用 RazorGenerator 在每个项目中预编译您的视图，您现在可以为站点 A 使用以下引擎注册：

```
var engine = new CompositePrecompiledMvcEngine(
    PrecompiledViewAssembly.OfType<SomeSharedUIClass>(),
    PrecompiledViewAssembly.OfType<SomeSiteAClass>(
        usePhysicalViewsIfNewer: HttpContext.Current.IsDebuggingEnabled));

ViewEngines.Engines.Insert(0, engine);
VirtualPathFactoryManager.RegisterVirtualPathFactory(engine); 
```

站点 B 的类似代码：

```
// ...
    PrecompiledViewAssembly.OfType<SomeSiteBClass>(
// ... 
```

当您在引擎的构造函数中注册程序集时，它会构建哈希表，其中每个元素都包含视图的虚拟路径（键）和编译视图类型（值）之间的映射。如果这样的键已经注册到以前的程序集之一，它只是用当前程序集的类型覆盖这个映射。

因此，在 SharedUI 程序集注册之后，哈希表将包含以下映射：

```
"~/Views/Index.cshtml"   -> SharedUI.Index
"~/Views/Header.cshtml"  -> SharedUI.Header
"~/Views/Footer.cshtml"  -> SharedUI.Footer 
```

当您将 SiteA 程序集注册时，哈希表将包含：

```
"~/Views/Index.cshtml"   -> SiteA.Index
"~/Views/Header.cshtml"  -> SharedUI.Header
"~/Views/Footer.cshtml"  -> SharedUI.Footer 
```

如果您放置另一个带有视图“~/Views/Footer.cshtml”和“~/Views/Sidebar.cshtml”的程序集，哈希表将包含：

```
"~/Views/Index.cshtml"   -> SiteA.Index
"~/Views/Header.cshtml"  -> SharedUI.Header
"~/Views/Footer.cshtml"  -> Another.Footer
"~/Views/Sidebar.cshtml" -> Another.Sidebar 
```

# c# - C# 在 Main() 中等待所有线程完成

> ID：12943489
> 
> 赞同：2
> 
> 时间：2012-10-17T21:14:33.287
> 
> 标签：c#, multithreading

我一直在编写多线程应用程序来解决迷宫问题。我从我的`Program Class`,`Main()`方法开始一个新线程，开始解决迷宫。然后，如果他发现分叉，他将调用一个静态方法来创建一个新线程。如何等待后台运行的所有线程完成，例如显示完成消息？

这是我正在尝试做的一个骨架：

```
var explorer = new Explorer(/*Some arguments*/);
var thread = new Thread(explorer.Explore) {Name = "Thread 0"};
thread.Start();

//Thread_0_and_Threads_he_generates_through_static_class.Join()    

Console.WriteLine("I'm done bro.");
Console.ReadKey(); 
```

有没有办法做到这一点？老实说，第一次以这种方式使用多线程，所以我为糟糕的代码道歉。我很乐意提供任何其他信息。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:16:44.513

也许[Thread.Join()](http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx)是您正在寻找的？

您也可能会发现[这篇文章](http://www.yoda.arachsys.com/csharp/threads/locking.shtml)很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:25:49.260

多线程是一个非常令人愉快的主题。

由于您是在线程方面迈出第一步，我建议您仔细参考 Microsoft 的[Thread Synchronization](http://msdn.microsoft.com/en-us/library/ms173179.aspx)优秀初学者文章。

快乐的主题！

# c# - 在 C# 中实现（POCO）结构属性访问器

> ID：12943498
> 
> 赞同：4
> 
> 时间：2012-10-17T21:14:59.747
> 
> 标签：c#, c++-cli

我想在 C# 中从我的 C++/CLI dll 实现一个接口。但我猜我在 C++ 中的返回值优化有问题。考虑

```
// BVHTree.cpp:
public value struct Vector3
{
    float X, Y, Z;
};

public value struct TriangleWithNormal
{
    Vector3 A, B, C, Normal;
};

public interface class IBVHNode
{
    property TriangleWithNormal Triangle { TriangleWithNormal get(); } // among others
    property bool IsLeaf { bool get(); } // can implement this
}; 
```

* * *

```
// BVHNode.cs:
public class BVHNode : IBVHNode // Error: member TriangleWithNormal* IBVHNode.get_Triangle(TriangleWithNormal*) not implemented (sth. along those lines)
{
    public TriangleWithNormal Triangle { get { return new TriangleWithNormal(); } }
    public bool IsLeaf { get { return true; } }
} 
```

它抱怨`BVNode`没有实施`IBVHNode`。我最后的手段是通过常规方法或使用 Visual Studio 建议的不安全模式访问它：

```
public TriangleWithNormal* get_Triangle(TriangleWithNormal* t) 
{ 
    throw new NotImplementedException();
} 
```

有没有办法仍然在属性语法中实现它（除了制作`TriangleWithNormal`... `ref class`）？

**更新 1**似乎是因为`TriangleWithNormal GetTriangle()`同样的原因实现方法失败。但是，您可以像`void GetTriangle(TriangleWithNormal%);`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T21:09:15.987

一旦我修复了几个小的语法错误（`;`在 C++/CLI 中的类声明之后，缺少`bool`返回类型 of的单词`IsLeaf.get()`），您的代码对我有用，并定义了 Vector3 类型。

我猜你是如何定义 Vector3 的，它不是我熟悉的标准类。它在哪里定义？它是托管类、托管结构还是非托管？（我将其定义`public value struct Vector3 { double x, y, z; };`为我的测试。）

正如我所说，您在此处发布的 C++/CLI 代码中存在轻微的语法错误。这两个错误给出了非常明显的编译错误，所以我假设这些是从 Visual Studio 到 Web 的转录中的拼写错误。您发布的内容与实际代码之间是否还有其他更改？

* * *

此外，我无法收到您报告的错误消息，`member TriangleWithNormal* IBVHNode.get_Triangle(TriangleWithNormal*) not implemented`. 我总是以编译错误结束`error CS0535: 'CSharpTest.BVHNode' does not implement interface member 'CppCLITest.IBVHNode.Triangle'`。

您显示的属性不带参数，但编译器错误显示了一个`get_Triangle`采用 type 参数的方法`TriangleWithNormal*`。您是否在某处有另一个属性声明，或者明确声明了该方法？

* * *

我想我可能拥有它。如果我尝试将 C++/CLI 属性声明为索引属性，那么我会得到一个类似于您所看到的方法签名。

在您的实际代码中，您是否有这样的东西：

```
property TriangleWithNormal Triangle[TriangleWithNormal] { TriangleWithNormal get(TriangleWithNormal input); } 
```

这是一个索引属性，C# 不允许您实现。（C# 确实允许一个索引属性`this[]`，但只允许那个。）

当我尝试在 C# 中实现它时，它需要我显式地实现属性的支持方法，而不是将其实现为 C# 属性。

```
public TriangleWithNormal get_Triangle(TriangleWithNormal input)
{
    return new TriangleWithNormal();
} 
```

使索引属性成为常规属性，这对您来说应该很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T23:42:09.260

It turned out that the error was gone after I lived some build cycles with my `void GetTriangle(TriangleWithNormal%);` workaround. Be it a wonder or more likely a silent clean build, upon commenting in the errorneous property trying to reproduce the error condition one more time, it compiled out of the box.

# javascript - 具有绝对定位子 div 的父 div 拒绝 100% 高度

> ID：12943499
> 
> 赞同：3
> 
> 时间：2012-10-17T21:15:15.810
> 
> 标签：javascript, html, css

我想要一个 100% 高度的 div，里面有绝对定位的 div。无论出于何种原因，当我添加子 div 时，父 div 的高度都会缩小到静态内容大小。

澄清一下，我*不*希望绝对定位的元素是全高的。只是包含 div。

我有（简化的）标记如下：

```
<div id="content">
   <div id="dashboard">
      Some text
      <div class="widget"></div>
      <div class="widget"></div>
      ...
   </div>
</div> 
```

和造型：

```
#content {
  min-height: 100%;
}
#dashboard {
  min-height: 100%;
  height: 100%;
  position: relative;
}
.widget {
  height: 50px; /* arbitrary */
  width: 50px;
  position: absolute;
} 
```

我已经把`#content`和`#dashboard`作为最小高度 100% 和高度 100% 并且有效。如果我注释掉绝对定位的 div，它们都是屏幕的全高。

但是当我添加`.widget`s 时，`#content`仍然是全高（好），但`#dashboard`只是“某些文本”的高度。无论出于何种原因，*添加绝对定位的内容来`#dashboard`改变它的高度。*

**注意（编辑）**

> 我不想`#content`成为 100% 的高度，因为它需要随着其他页面上的内容而增长。我*只*希望#dashboard 正好是 100% 的高度。

jQuery 工作，但我想只用 css 做

```
$("#dashboard").height( $("#content").height() ); 
```

我还尝试将显示类型更改为阻止或内联`#content`并将 -moz-box-sizing 设置为默认值，因为我读到它会破坏 Firefox 的最小高度。

知道如何解决这个问题吗？

* * *

相似但不一样：[How to set 100% height of a parent div with absolute Position children (not a duplicate)?](https://stackoverflow.com/questions/12460054/how-to-set-100-height-of-a-parent-div-with-absolutely-positioned-children-not)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:27:16.340

来自[MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/min-height)：

> 属性的百分比值[`min-height`](https://developer.mozilla.org/en-US/docs/Web/CSS/min-height)是相对于生成框的包含块的**高度计算的。**如果`height`包含块的 没有**明确**指定（即，它取决于内容高度），并且该元素不是绝对定位的，则百分比值被视为**0**。

因此，您需要明确指定元素的属性才能`height`使元素的属性起作用。`#content``min-height``#dashboard`

因此，请尝试使用`height`属性 for`#content`而不是`min-height`：

```
#content {
  height: 100%;
} 
```

这是一个**[jsDiddle 演示](http://jsfiddle.net/hashem/RZqDE/30/)**。

```
html, body {
    height: 100%;
}
#content {
  height: 100%;
}
#dashboard {
  min-height: 100%;
  position: relative;
}
.widget {
  height: 50px; /* arbitrary */
  width: 50px;
  position: absolute;
}​ 
```

```
<div id="content">
   <div id="dashboard">
      Some text
      <div class="widget"></div>
      <div class="widget"></div>
      ...
   </div>
</div>​ 
```

**更新**

> 我不想`#content`一直全尺寸。

然后，您需要使用固定高度`#content`：

```
#content {
  height: 200px;  /* or whatever you want */
}

#dashboard {
  height: 100%;   /* or inherit */;
} 
```

否则，您应该使用 JavaScript 计算所需的高度并将其应用于`#dashboard`元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:23:01.420

绝对定位的元素不再是布局的一部分。父元素不知道子项有多大。

您需要手动设置父元素的高度，或者使用JS计算子元素的大小并相应地应用。

此外，高度为 100% 的元素也需要其父元素为 100% 高度：

```
body, html { height:100% } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T22:39:12.220

当您希望 #content 的最小高度为 100%（最小 100%，当有更多内容时展开），请使用 min-height 和`height: auto`：

```
body, html {
  height: 100%;
}
#content {
  min-height: 100%;
  height: auto;
} 
```

此外，如果我正确理解您的问题，您可以简单地使用`position: absolute`with`top: 0; right: 0; bottom: 0; left: 0;`来使#dashboard 的高度正好为 100%。`position: relative`如果#dashboard 的高度应该相对于#content，则添加到#content。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:25:52.320

绝对元素从流中取出。如果他们不在流程中，他们不会给他们的父母增加高度。

# java - 不使用 CSS 样式化 JavaFX 组件

> ID：12943501
> 
> 赞同：4
> 
> 时间：2012-10-17T21:15:20.227
> 
> 标签：java, user-interface, styles, javafx

是否可以在没有 CSS 的情况下设置 JavaFX 组件的样式？我的意思是：我可以实现与没有 CSS 的 CSS 相同的效果吗？“没有 CSS”我的意思是“没有 CSS 字符串”（你在`setStyle(String)`.

通过创建新的样式字符串来更新样式对我来说似乎非常低效。要以以下样式将背景颜色动态更改为白色（事先未知），我必须将其替换为正则表达式或连接字符串。

```
-fx-background-color: red;
-fx-border-color: black;
-fx-border-width: 1; 
```

我相信在内部这些字符串无论如何都会被解析为一些结构/对象，那么为什么这些结构不暴露呢？

我对 JavaFX 很陌生。我知道我可以使用 CSS 继承，但它不是灵丹妙药，仍然会有一些字符串连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T00:37:27.030

从 JavaFX 2.2 开始，样式的某些方面只能通过应用 css 来实现。您在问题中对区域背景颜色和边框信息的定义属于“只能通过css完成的事情”的类别。

您可以通过在 css 样式表中定义不同的样式类并操作节点的样式类来设置[样式](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#getStyleClass%28%29)。这是使用 css 而不是使用[setStyle](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#setStyle%28java.lang.String%29)方法的推荐方法。您还可以更改应用于场景或节点层次结构的样式表列表。然而，这实际上只是以不同的方式使用 CSS，而不是没有 CSS 的样式。

样式的某些方面可以在 fxml 或 java 代码中完成，因为它们在 JavaFX API 中公开，例如，您可以使用[setFont](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Labeled.html#setFont%28javafx.scene.text.Font%29) api 或 fxml 字体属性在标签上设置字体，而不是应用字体使用 css 样式[-fx-font](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#typefont)到标签。

在未来的 JavaFX 版本（例如 JavaFX 8）中，许多这些东西还将有一个公共 API，您可以使用它在代码中应用样式而不使用 CSS。特别是对于 JavaFX 8.0，已经定义了新的 API，这些 API 公开了区域背景和边框样式属性以进行编程操作。请参阅[RT-24506：区域背景和边框的公共 API](http://javafx-jira.kenai.com/browse/RT-24506)。这应该允许您以编程方式完成您在问题中提供的示例样式。

此外，为未来的 JavaFX 版本提议的是 CSS 信息的对象模型，以便除了当前基于字符串的 setStyle 和 getStyleClass 方法之外，还可以通过正式的 Java API 查看和操作节点上的 CSS 属性。请参阅[RT-17293：Java 中的 CSS 样式对象模型](http://javafx-jira.kenai.com/browse/RT-17293)。如果您对此类功能感兴趣，请为功能请求投票。

# jquery - jquery 没有在 IE 启动时加载

> ID：12943505
> 
> 赞同：0
> 
> 时间：2012-10-17T21:15:29.293
> 
> 标签：jquery, startup, doctype

所以一切加载在 chrome 和 firefox 中启动良好，但在 IE 中它在启动时不起作用，我必须单击一个链接转到另一个页面，然后返回以便脚本开始工作。

jQuery：

```
$(document).ready(function(){
   $('.bigimage').mouseover(function(){
      $(this).stop().animate({
         "width": "110%",
         "left": "0px",
         "top": "0px"
      }, 200,'swing');
   }).mouseout(function(){ 
      $(this).stop().animate({
         "width": "100%",
         "left":"15px",
         "top":"15px"
      }, 200,'swing');
   });
}); 
```

html

```
<ul class="getbig"> 
   <li>
      <a href="*"><img class="bigimage" src="pic.png" title="mytitle"></a>
   </li>
   <li>
      <a href="*"> <img class="bigimage" src="pic2.png" title="mytitle2"></a>
   </li>
</ul> 
```

CSS：

```
.getbig{ position:relative; left: 50px; top: 0px; width:200px; height:78px;  }

.bigimage{ position:relative; width:100%; left:15px; top:15px} 
```

所以我想知道它是否与 IE 中的文档类型有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T08:21:55.963

> Would this have anything to do with IE nagging about not letting scripts run unless you press the accept button?

Yes - does it work if you 'allow blocked content'?

If so, there are two solutions:

*   load your page through a web server instead of as a local file (IE restricts the page from running scripts only for local files)

*   use [Mark of the Web](http://msdn.microsoft.com/en-us/library/ms537628%28VS.85%29.aspx) (MOTW). But this is a non-standard workaround, and introduces other issues (IE will then [disable any links to other file types](http://ss.johncardinal.com/motw.htm))

# c# - 何时在 C# 中使用 Wea kReference（如果不用于缓存）？

> ID：12943508
> 
> 赞同：3
> 
> 时间：2012-10-17T21:15:33.207
> 
> 标签：c#, weak-references

> **可能重复：**
> [弱引用](https://stackoverflow.com/questions/310685/weak-references)

这东西是干什么用的？

这似乎是一种创建 GC 可以及早收集的对象的方法，如果它被提前收集，我应该重新创建它。这听起来像是缓存，但其他[StackOverflow 问题说这是一个糟糕的缓存策略，因为实际上 GC 会非常急切和快速地 GC 你的对象](https://stackoverflow.com/questions/930198/does-weakreference-make-a-good-cache)，（[另一个 Q 说弱引用使缓存很差](https://stackoverflow.com/questions/10928329/weakreference-understanding)）有点像使用 ASP.NET 的缓存并将其设置为非常低的缓存逐出时间限制。

背景：我最近在阅读 TraceSource 的 CLR 代码。在构造函数中，发生的第一件事是将 WeakReference(this) 添加到静态字典中。奇怪的是，只有当 TraceSource 重新读取弱引用字典中每个 TraceSource 的配置文件时，它才会在 Refresh 方法中使用，但前提是它还没有被 GC'd。另一个[StackOverflow 问题表明这会导致内存泄漏](https://stackoverflow.com/questions/2345490/what-could-explain-over-5-000-000-system-weakreference-instances-on-the-managed)。

因此，从那以后我一直在阅读有关 WeakReferences 的内容，并且越来越感到困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:54:43.953

WeakReference 通常用于实现[弱事件](http://www.codeproject.com/Articles/29922/Weak-Events-in-C)。事件处理程序是内存泄漏的常见原因，特别是当您拥有一个包含多个实例订阅的事件的长期服务时。如果这些实例未能取消注册它们的事件处理程序（或者是因为开发人员没有意识到它很重要，或者通常是由于异常情况没有触发正常清理），那么延迟引用会阻止这些实例被收集。

另一个很好的情况是，如果您想将附加数据与现有实例相关联。例如，您可能有一个 ExtraWidgetInfo，您希望将其与第 3 方 Widget 相关联。创建关联的一种方法是使用字典。问题是现在所有的小部件都由字典本身保持活动状态，即使它们不再在其他任何地方使用。为 Widget 引用使用 Wea​​kReference 可以防止相关数据在 Widget 过期后保持活动状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:19:09.273

缓存就是一个很好的例子。如果您在缓存中使用弱引用，则可以对未请求的项目进行垃圾收集以回收内存。

简而言之：任何可以方便检索的东西，但如果你不这样做并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:58:40.393

当然不适合缓存，因为 GC 会在运行时清理所有当前未引用的缓存项。它不会等待内存压力或其他东西。它不允许缓存增长。

# python - Redis 或 Memcached 能否用于“锁定”资源，例如像 S3 这样的 blobstore？

> ID：12943511
> 
> 赞同：2
> 
> 时间：2012-10-17T21:15:45.860
> 
> 标签：python, amazon-s3, memcached, redis, distributed-computing

想要“锁定”外部资源，在这种情况下，它将是存储在[机架空间云服务器](http://www.rackspace.com/cloud/public/files/)上的“blob” ，类似于 Amazon S3。（使用 Python）

希望像这样处理竞争条件：

*   第一个进程创建资源锁
*   第一个进程开始编辑资源
*   第二个进程尝试编辑同一资源并发现该资源已被锁定。
*   第二个进程请求在锁被取消时得到通知
*   第一个进程完成编辑资源并移除锁
*   第二个进程收到释放资源的通知并能够进行自己的编辑

想使用 Memcached 或 Redis 来创建锁，但也可以使用不同的机制。

其中大部分非常简单，我正在努力解决的部分是如何在删除锁时通知第二个进程，而不是强制它等待并重试。

Redis 具有[发布/订阅功能](http://redis.io/topics/pubsub)，在这种情况下是否适合使用？

还是有其他方法可以解决这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T10:54:05.197

至于 Redis，如果你真的需要锁，你可以使用`SETNX`创建这样的锁，更多信息可以在[SETNX 文档](http://redis.io/commands/setnx)中找到。

如果您预计给定锁的争用较低，并且您没有任何资源消耗处理锁定信息，您也可以使用//`WATCH`事务。首先，您在要编辑的密钥上设置 WATCH，然后在您编辑密钥本身，然后最后在 之后，它要么使编辑失败，因为有人同时编辑了该观看的密钥（然后您需要重试），要么它返回 OK 并且您没事。这就是在 Redis 中实现机会锁定的方式。[交易文档](http://redis.io/topics/transactions)中的更多信息`MULTI``EXEC``MULTI``EXEC`

# ms-access - 用于访问 2003 数据库的类似 Excel 的数据输入表单

> ID：12943515
> 
> 赞同：0
> 
> 时间：2012-10-17T21:16:00.900
> 
> 标签：ms-access, vba, ms-access-2003

我正在尝试将用于员工培训记录的 Excel 电子表格转换为 Access 2003 数据库。我已将数据库设置为 4 个表：Staff、Tasks、Trainers 和 TrainingRecords。培训记录表包含以下字段：RecordID（自动编号和 PK）、StaffID（链接到员工）、TaskID（链接到任务）、DateCompleted 和 TrainerID（链接到培训师）。我已经创建了用于将数据输入到员工、任务和培训师表中的所有相关表格。我还创建了一个表单，允许您通过从组合框中选择员工姓名、任务名称和培训师姓名来输入新的培训记录。

我的问题是，我的老板希望培训记录的数据输入看起来更像 Excel 电子表格，它显示所有可用任务的完整列表，然后用户可以填写完成日期和所有相关的培训师姓名一次完成项目，通常会留下多个任务而没有创建日期和培训师（因为工作人员尚未接受过该特定任务的培训）。我不太确定如何着手解决这个问题 - 我有以下想法，但不知道它们的可行性：

1）当表单加载时，为任务名称中的所有可用任务和标签添加复选框。然后，用户将单击他们想要添加的任何任务，并为他们勾选的所有任务指定相同的日期和培训师姓名。

2）使用office excel电子表格控件（10或11）允许数据输入，然后编写一些代码来交互信息并根据需要创建/修改TrainingRecords表。这个选项对我来说应该是相当直接的，因为我已经完成了很多 Excel VBA 编程。但是，我不知道如何访问电子表格中的 Range/Cells 对象以读取/写入数据。我猜这个控件并不是真的要以这种方式使用。

3）创建一个临时表（将通过子表单查看），这将填充所有任务的列表，并且当用户从下拉框中选择员工姓名时，员工是否接受过相关培训主要形式。如果用户从下拉框中选择不同的员工，表单将刷新并显示该员工的数据。

我对任何其他比我在这里的想法更直接的想法/建议持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T16:44:31.173

Access 中的表单可以配置为数据表视图表单，看起来类似于 Excel。但是，我认为使用数据表表单并不能解决您在这里遇到的所有问题。

你可能最好做一些你在#1中建议的事情。填充复选框的部分需要取消绑定，您必须编写代码填充复选框并根据复选框的选中方式插入/更新/删除记录。您不能在数据表表单或连续表单中使用未绑定字段。

选项#3 也可以。或者，您也可以将表单绑定到伪造的 ADO 记录集。再一次，您必须编写代码来填充 ADO 记录集，并且您必须编写更多代码来将 ADO 记录集中的所有添加/编辑/删除推送回您的数据源。

我会远离选项＃2。我想不出在 MS Access 应用程序中使用或嵌入 Excel 的很多原因（Excel 的图表可能是唯一的原因之一）。

我想警告你的另一件事是让你的老板决定事情的外观和感觉。当然，老板会有发言权，但理想情况下，他的意见应该是说某些东西太笨拙、太不直观、需要太多点击、需要太多培训才能使用等等。我允许用户规定应用程序的外观和行为的细节，最终结果并不好。在其他情况下，我选择了实现某个功能的最佳方式并根据我自己的知识为其设计了用户界面，结果比我允许最终用户指定他们想要的控件的情况要好得多，他们去哪里，他们持有什么数据，他们的行为方式等等。经验丰富的应用程序开发人员应该对最终用户的设计环境有一定的了解，并允许您为他们提供满足或超出他们期望的东西。当然，不要关闭来自你的老板或最终用户的反馈，但要尝试找出他们想要的东西与他们所拥有的不同的原因。最好不要让用户的旧习惯和习惯决定用户界面的外观。你永远不可能那样取得进步。今天的应用程序应该有现代的、用户友好的用户界面，如果你构建你的应用程序来适应那些思想停留在 90 年代或仅仅停留在其他低级范式的人，你就无法做到这一点。不要关闭来自老板或最终用户的反馈，但要尝试找出他们想要的东西与他们所拥有的不同的原因。最好不要让用户的旧习惯和习惯决定用户界面的外观。你永远不可能那样取得进步。今天的应用程序应该有现代的、用户友好的用户界面，如果你构建你的应用程序来适应那些思想停留在 90 年代或仅仅停留在其他低级范式的人，你就无法做到这一点。不要关闭来自老板或最终用户的反馈，但要尝试找出他们想要的东西与他们所拥有的不同的原因。最好不要让用户的旧习惯和习惯决定用户界面的外观。你永远不可能那样取得进步。今天的应用程序应该有现代的、用户友好的用户界面，如果你构建你的应用程序来适应那些思想停留在 90 年代或仅仅停留在其他低级范式的人，你就无法做到这一点。

# node.js - 在浏览器中运行 nodejs 文件时遇到问题

> ID：12943516
> 
> 赞同：1
> 
> 时间：2012-10-17T21:16:01.770
> 
> 标签：node.js, browser

我正在发现nodejs。所以我创建了一个简单的文件显示一个简单的“hello world！”。当我在控制台中运行它时，它工作得很好。现在我正在尝试从浏览器启动它（我正在监听 8080 端口）。但是我收到一条错误消息，告诉我我的浏览器找不到那个 URL。

我正在使用 MAMP。而且，在使用它配置的根目录中，我尝试监听端口 8888（我用来启动我的 PHP 本地站点的端口，当然更改了我的 nodejs 文件中的端口），但它仍然不起作用。

有关信息，我的 app.js 节点文件也在使用我的 MAMP 服务器配置的根目录中。是防火墙问题吗？如果是，我该如何解决？我应该更改 /etc/hosts 文件中的某些内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:50:22.813

事实上，这确实是一个防火墙问题，我正确地设置了我的偏好，它工作得很好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:51:44.470

使用 node.js，您不需要 MAMP。将您的 app.js 文件放在一个文件夹中，然后在控制台中运行“node app.js”。这将打开一个通常在端口 3000 上的 Web 服务器，您可以在浏览器中的 localhost:3000 上查看该服务器。今天 Nuno Job 做了一场精彩的演讲，介绍了 node.js 以及今天在[nodestack](http://www.nodestack.org/)上与 MAMP 的区别。录音将很快提供。这里还有一些你应该看的视频：[node.js 简介](http://www.youtube.com/watch?v=jo_B4LTHi3I)，[Node.js 一步一步](http://net.tutsplus.com/tutorials/javascript-ajax/this-time-youll-learn-node-js/)

# c# - 将数据从作曲家传递到元素（基于 Tweestation）

> ID：12943517
> 
> 赞同：1
> 
> 时间：2012-10-17T21:16:09.420
> 
> 标签：c#, xamarin.ios

我正在基于*miguel de icaza*的**Tweetstation**构建一个应用程序。C# 单触。基本上，这就是我要处理的：

 *我有一个视图（yourAdd），其中包含一个名为 Title 的 styledstringelement（使用 Monotouch.Dialog）。默认值为“”。我有一个文本作曲家（直接来自**Tweetstation**的作曲家），用户可以在其中写一个问题并附上一张照片。

我想要完成的是，当用户单击作曲家中的添加时，styledstringelement 的值应该改变并反映作曲家中的输入。

**我的问题：**当用户选择了一张照片（并且可能还有一些文字）时，他或她点击了添加。这会触发一系列事件，将图片上传到 yFrog，然后我们会返回一个 url。最后，视图被关闭，用户再次进入 yourAdd 视图。所以，点击按钮触发事件，我们必须等到最后才能得到我想要的：提交图片的 URL（连同文本）。然后我想用这个新信息更新字符串元素。

所以，**我的问题**是：一旦完成来自 yFrog 的回调，我如何将来自 composer 类的数据传递给 stringelement？*

# java - 从表格单元格按钮打开对话框

> ID：12943522
> 
> 赞同：0
> 
> 时间：2012-10-17T21:16:30.340
> 
> 标签：java, dialog, swt, tableviewer

我需要允许我的用户在我的表中编辑文件名值。因此，在我的 tableviewer 中，我添加了代码以在最后一列中创建和显示编辑按钮。我有这个工作。

当他们单击编辑按钮时，我希望在带有保存和取消按钮的文本框中打开一个带有文件名的对话框。

所以我创建了 FileNameDialog 类。

我的问题是：我在哪里创建对话框？

*   我是否在基本对话框中创建一个方法并从 tableviewer 调用该方法

```
class SelectionListener implements Listener {
    TableItem item;
    Button editButton;
    Object element;

    public SelectionListener(TableItem item, Button deleteButton, Object element) {
        this.item = item;
        this.editButton = deleteButton;
        this.element = element;
    }

    public void handleEvent(Event event) {
        AplotPDFDataModel.FileNameData selected = (( AplotPDFDataModel.FileNameData)element);
        int index = AplotPDFDataModel.getInstance().getIndexOf(selected);
        pdfDialog.showEditFileNameDialog();  <<++++++++HERE

        Table table = getTable();
        table.getColumn(5).pack();
        table.getColumn(5).setWidth(100);
    }
} // End SelectionListener Class 
```

*   我是否只是在 tableviewer 中创建一个方法并在那里创建对话框？

```
public void showEditFileNameDialog() {
    editFileNameDialog = new EditFileNameDialog(getShell());
    editFileNameDialog.create();
    editFileNameDialog.getShell().setSize(300, 200);
    editFileNameDialog.open();  
} 
```

从表格查看器中单击按钮打开对话框的最佳程序是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T14:23:21.573

通常，您只需`Dialog`在`handleEvent`.`Listener`

要获得`Shell`您可以交给以下`Dialog`任何一项的方法：

```
new EditFileNameDialog(getTable().getShell()); 
```

或者

```
new EditFileNameDialog(new Shell()); 
```

# c# - 需要一些帮助将 C# 方法转换为 C++

> ID：12943523
> 
> 赞同：4
> 
> 时间：2012-10-17T21:16:33.347
> 
> 标签：c#, c++

我是一个 C# 人，正在拼命学习 C++ 并移植一些旧代码。到目前为止一直做得很好，但下面的方法让我很难过。如果有人能给我一些指示（对不起双关语），我将不胜感激。

C#方法：

```
public static string crappyEncryption(String userKey)    
{    
    StringBuilder eStr = new StringBuilder();    
    String key1 = "somehorriblelongstring";    
    String key2 = "someotherhorriblelongstring";    
    for (int i = 0; i < userKey.Length; i++)   
    {    
        eStr.Append(key2[key1.IndexOf(userKey[i])]);    
    }    
    return encodeTo64(eStr.ToString());    
} 
```

`encodeTo64`是我在 C++ 中解决的本地方法。这种奇怪的方法（如果你想知道的话）是我想出的一种小型加密方法，我们可以使用移动跨平台进行非必要的字符串加密。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:18:45.730

不会给你整个代码，但一些指针：

*   a`StringBuilder`可以用 a 代替`std::stringstream`。
*   是`String`一个`std::string`
*   它有方法`length()`，`find()`和`operator[]`。
*   `std::stringstream``operator <<`为`Append`. _
*   `ToString`是`std::stringstream::str()`。
*   你会想`userKey`通过引用传递。

您不了解的所有概念都可以通过 google 搜索轻松找到。

# c++ - 为什么类型推导在（非指针）函数类型上失败

> ID：12943525
> 
> 赞同：3
> 
> 时间：2012-10-17T21:16:36.140
> 
> 标签：c++, xcode, templates, c++11, template-meta-programming

从一些元编程代码开始：

```
template<class... Ts>
class list {}; //a generic container for a list of types

template<class in_list_type>
class front //get the type of the first template parameter
{
    template<template<class...> class in_list_less_template_type, class front_type, class... rest_types>
    static front_type deduce_type(in_list_less_template_type<front_type, rest_types...>*);
public:
    typedef decltype(deduce_type((in_list_type*)nullptr)) type;
}; 
```

此代码适用于此：

```
typedef typename front<list<int, float, char>>::type type; //type is int 
```

但是当第一项是函数类型时编译失败：

```
// no matching function for call to 'deduce_type'
typedef typename front<list<void (), float, char>>::type type; 
```

我目前只能访问 XCode，无法确认这是否只是一个 XCode 错误。我正在使用 XCode 4.5.1，使用 Apple LLVM 编译器 4.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:32:19.440

当模板参数`deduce_type`被推导时，`front_type`作为`void()`候选。但是，这将`deduce_type`具有类型`void ()()`（函数返回一个函数——`alias<void()>()`如果您假设`template<typename T> using alias = T;`在范围内）。这是一个错误，类型推导失败。

一个解决方案是`deduce_type`返回类似的东西`identity<front_type>`，并`type`成为`typename decltype(deduce_type((in_list_type*)nullptr))::type`.

# http - PUT 没有数据，它是 RESTful 的吗？

> ID：12943531
> 
> 赞同：7
> 
> 时间：2012-10-17T21:16:57.353
> 
> 标签：http, rest

一个简单的问题：如果我不通过 HTTP POST/PUT 方法在我的资源上发送数据（内容）怎么办——它仍然是 RESTful 吗？

显然，问题是在哪种情况下我想在没有数据的情况下使用 PUT。想象一个用户想要重置他/她的密码（就像在[这个旧主题](https://stackoverflow.com/questions/3077229/restful-password-reset)中一样）。

你怎么看呢？可以不使用 POST/PUT 方法发送内容吗？我个人对此没有任何问题，但我只是好奇其他人会怎么说。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T21:29:26.717

是的，这是完全可以接受的。在没有数据的情况下执行每个操作（POST 到集合，PUT 到资源）都应该创建一个新的“空”资源。这里“空”的定义取决于所代表的内容。

但是，在重置用户密码的特定情况下，我不会说上述模型适用。如果确实存在密码资源，则没有数据的 PUT 似乎建议将密码设置为空，而不是重置密码。对于这种情况，我会选择该问题的公认答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:28:04.487

您不需要 POST 或 PUT 中的数据即可使其成为 Restful。如果您正在做的事情是非幂等的（意味着请求将修改或创建资源），您不想使用 GET（无论是否有任何数据要传递）。例如，您可能有一个 RESTful Web 服务，它将请求的时间和资源 url 命中视为创建或修改某些资源所需的全部 - 不需要请求数据！

# python - PyInstaller'没有名为证书的模块'错误

> ID：12943536
> 
> 赞同：0
> 
> 时间：2012-10-17T21:17:16.280
> 
> 标签：python, ssl, pyinstaller

我正在尝试使用 PyInstaller 编译 Python 程序。当我尝试使用使用 ssl 的函数时，得到一个`Import Error`：

```
ImportError: No module named certifi 
```

我已经修改了`.spec`文件以包含来自 Python ssl 库的 cacert.pem 文件：

```
# -*- mode: python -*-
a = Analysis(['main.py'],
             pathex=['D:\\Projects\\soundcloud'],
             hiddenimports=[],
             hookspath=None)
a.datas.append(('cacert.pem', 'cacert.pem', 'DATA'))
pyz = PYZ(a.pure)
exe = EXE(pyz,
          a.scripts,
          exclude_binaries=1,
          name=os.path.join('build\\pyi.win32\\main', 'main.exe'),
          debug=False,
          strip=None,
          upx=True,
          console=True )
coll = COLLECT(exe,
               a.binaries,
               a.zipfiles,
               a.datas,
               strip=None,
               upx=True,
               name=os.path.join('dist', 'main')) 
```

但后来我收到以下错误：

```
Traceback (most recent call last):
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\api", line 186,
in run_api_thread
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\api", line 40, 
in authenticate
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\soundcloud.client", 
line 60,
in exchange_token
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\soundcloud.request", 
line 173, in make_request
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\requests.api", 
line 84, in post
File "...\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\requests.api", 
line 39, in request
File "D:\Projects\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\requests.sessions"
line 200, in request
File "D:\Projects\soundcloud\build\pyi.win32\main\out00-PYZ.pyz\requests.models",
line 537, in send
SSLError: [Errno 185090050] _ssl.c:336: 
error:0B084002:x509 certificate routines:X509_load_cert_crl_file:system lib 
```

使用 PyInstaller 编译时包含证书以使 ssl 工作的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:19:39.583

通过更改环境变量解决了该问题：

```
os.environ['REQUESTS_CA_BUNDLE'] = os.path.join(os.getcwd(), 'cacert.pem') 
```

# linux - pid真的是独一无二的吗

> ID：12943542
> 
> 赞同：6
> 
> 时间：2012-10-17T21:17:52.613
> 
> 标签：linux, multithreading, process, kernel, pid

是否存在 PID 最终不是唯一的情况？它是识别进程（或线程）的最佳方法吗？我读到以前版本的 Linux 有不同的方法

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:22:04.873

PID 可以取大约 32k 值（`sysctl kernel.pid_max`可以更改它），因此它们被足够快地重用。pid + 开始时间可能会更好。systemd 在 cgroupfs 中附加每个进程的扩展属性信息（procfs 也可以）以避免 pid->attr 映射的歧义。

线程和进程共享相同的命名空间（您可以在 中看到它`/proc/<pid>/task/<taskid>`），其中`<pid>`=`<taskid>`表示进程的初始线程。Pid 命名空间限制了可见 pid 的列表，但它们不会引入任何重叠；pid 和任务 ID 在其所有者运行时保持唯一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T21:22:50.310

如果您在谈论`getpid()`系统调用，那么是的，每个进程的 PID 都是唯一的。*除外*，也就是说，如果您在旧版本的 Linux 内核上使用线程。然后每个线程可能有自己的进程ID。

引用[此讨论](http://www.linuxquestions.org/questions/programming-9/pthread-problem-65271/)：

> 内核 2.4.20 使用[NPTL（本地 posix 线程库）](http://en.wikipedia.org/wiki/Native_POSIX_Thread_Library)，这是 RH9 附带的内核。RH8 使用没有实现 NPTL 的内核 2.4.18（这意味着每个线程都有自己的 PID，因此在 /proc 中很好地描述了它的状态）。NPTL 是 POSIX 线程的“真正”实现，这意味着线程共享更多，包括 PID。出于几个原因，它是运行线程的更有效方式，但是，我不知道有什么简单的技巧可以调试这些线程。您如何知道您的线程何时处于睡眠状态与等待信号量，或者哪些线程在具有大量线程的进程中死亡，等等。

从[NPTL 上的维基百科链接](http://en.wikipedia.org/wiki/Native_POSIX_Thread_Library)：

> NPTL 自版本 3 以来一直是 Red Hat Enterprise Linux 的一部分，自版本 2.6 以来一直在 Linux 内核中。它现在是 GNU C 库的一个完全集成的部分。[2](http://en.wikipedia.org/wiki/Native_POSIX_Thread_Library)

在幕后，甚至 2.6.X 内核都有一个用于线程的虚拟进程。您可以使用以下命令查看线程进程 ID `ps auxf`：

```
root      2501  0.0  0.3 244448 25576 ?    Ss   Jul03   0:11 /usr/sbin/httpd
apache    2716  0.0  0.5 384776 46696 ?    S    Oct14   0:17  \_ /usr/sbin/httpd
apache    2717  0.0  0.5 382208 44304 ?    S    Oct14   0:11  \_ /usr/sbin/httpd 
```

以下程序在 Linux 内核 2.6.18 下为 main 和 thread 输出相同的 pid。从返回的 self id`pthread_self()`唯一标识线程。

```
#include <pthread.h>
void foo() {
  printf("thread: pid = %d, self = %ld\n", getpid(), pthread_self());
}
main() {
  pthread_t thread;
  printf("main: pid = %d, self = %ld\n", getpid(), pthread_self());
  pthread_create(&thread, 0L, foo, 0L);
  pthread_join(thread, 0L);
} 
```

输出是：

```
main: pid = 13246, self = 46912496175248
thread: pid = 13246, self = 1084229952 
```

# javascript - 根据所依赖的复选框添加和删除 div 的函数

> ID：12943548
> 
> 赞同：1
> 
> 时间：2012-10-17T21:18:19.573
> 
> 标签：javascript, html

我正在尝试创建一个只需要在 IE8 和 9 中工作的基于 JavaScript 的应用程序。

这是对问题的简化描述：

```
<div id="A" style="display:none">
<div id="a1">content of a1</div>
<div id="a2">content of a2</div>
<div id="a3">content of a3</div>
...goes on
</div>

<div id="B">
<div id="b1"></div>
<div id="b2"></div>
<div id="b3"></div>
...goes on
</div>` 
```

我在 div“A”下的每个 div 都有一个复选框。

我需要一个简单的 JavaScript 函数，它将复制或删除 div“A”下的 div 内容到 div“B”下的内容，具体取决于选中的复选框。

例如，如果选中复选框“a1”，则 div“a1”的内容将被复制到 div“b1”，如果未选中该框，则删除“b1”的内容。

就这么简单，虽然我想不通，但整个 div "B" 将被复制粘贴到电子邮件中，因此 div "B" 不能包含任何隐藏元素。我不能使用文本区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:24:08.463

在复选框事件上调用此函数：

```
function CopyInnerHtml(){
    var innerHTML = document.getElementById('A').innerHTML;
    document.getElementById('B').innerHTML = innerHTML;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:34:40.643

修改后的标记和 Javascript 代码。请注意在复选框元素中使用类属性来找出源和目标 div。

**HTML**

```
<div id="A" style="display:none">
<div id="a1">content of a1</div>
<div id="a2">content of a2</div>
<div id="a3">content of a3</div>
</div>

<div id="B">
<div id="b1"></div>
<div id="b2"></div>
<div id="b3"></div>
</div>

<input type="checkbox" class="1">
<input type="checkbox" class="2">
<input type="checkbox" class="3"> 
```

**Javascript**

```
$(document).ready(function(){
    $("input[type=checkbox]").click(function(){
       var source= $("#a" + $(this).attr('class'));
       var destination= $("#b" + $(this).attr('class'));
       if($(this).attr('checked')=='checked')
          $(destination).html($(source).html());
       else     
           $(destination).html("");
    });

}); 
```

[http://jsfiddle.net/7qmQM/1/](http://jsfiddle.net/7qmQM/1/)

# model-view-controller - node.js express 路由和控制器有什么区别？

> ID：12943553
> 
> 赞同：16
> 
> 时间：2012-10-17T21:18:40.813
> 
> 标签：model-view-controller, node.js, express

传统控制器在快速路线上有什么不同或更强大的地方吗？

如果你有一个 express 应用并定义了模型，它会成为一个 MVC 应用程序，还是有更多必要？

我只是想知道我是否因为不升级到更合法的“控制器”而错过了节点快递应用程序中额外/更简单的功能。如果有这样的事情。

谢谢！

编辑：澄清一下，如果您使用这样的路线：

```
// routes/index.js
exports.module = function(req, res) {
  // Get info from models here, 
  res.render('view', info: models);
} 
```

它与控制器有何不同？控制器能做更多事情吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-18T15:03:20.010

首先，express 中的路由是 connect 中定义的中间件。express 和其他框架的区别在于中间件大多位于控制器前面，控制器结束响应。express 使用中间件的另一个原因是 Node.js 的异步特性。

让我们看看控制器在 Javascript 中的样子。

```
var Controller = function () { };

Controller.prototype.get = function (req, res) {

  find(req.param.id, function (product) {

    res.locals.product = product;

    find(res.session.user, function (user) {

      res.locals.user = user;
      res.render('product');

    }); 

  }); 

}; 
```

关于这个 get 操作，您可能注意到的第一件事是嵌套的回调。这很难测试，很难阅读，如果你需要编辑你需要摆弄缩进的东西。因此，让我们通过使用流量控制来解决这个问题并使其平坦。

```
var Controller = function () { };

Controller.prototype.update = function (req, res) {

  var stack = [

    function (callback) {

      find(req.param.id, function (product) {
        res.locals.product = product;
        callback();
      });

    },

    function (callback) {

      find(res.session.user, function (user) {
        res.locals.user = user;
        callback();
      });

    }

  ];

  control_flow(stack, function (err, result) {
    res.render('product');
  });

} 
```

In this example you can extract all the different functions of the stack and test them or even re-use them for different routes. You might have noticed that the control flow structure looks a lot like middleware. So lets replace the stack with middleware in our route.

```
app.get('/',

  function (req, res, next) {

    find(req.param.id, function (product) {
      res.locals.product = product;
      next();
    });

  },

  function (req, res, next) {

    find(res.session.user, function (user) {
      res.locals.user = user;
      next();
    });

  },

  function (req, res, next) {
    res.render('product');
  }

); 
```

So while it might technically be possible to have controllers in express.js you would probably be forced to use flow control structures, which in the end is the same as middleware.

# jquery - 使用 .slideDown 打开或关闭 div，同时调整箭头

> ID：12943559
> 
> 赞同：0
> 
> 时间：2012-10-17T21:18:51.957
> 
> 标签：jquery, slidedown

尝试创建一个显示在链接下方的 div，该链接会在单击墨迹时滑动显示。

我似乎无法让它工作。

我还需要想办法在 div 为“打开”时将 ► 更改为 ▼，尽管这可能需要使用图像而不是 ascii 字符来完成？

[JS小提琴](http://jsfiddle.net/DAjEK/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:25:43.743

演示：http: [//jsfiddle.net/DAjEK/4/](http://jsfiddle.net/DAjEK/4/)

这是一种完全不同的方法......更简洁。

```
$("#colourList a").click(function(e){
    e.preventDefault();
    $(this).html($(this).is(':contains(▼)') ? 'See the colours ►' : 'Hide the colours ▼');
    $("#colours").slideToggle(500);
});​ 
```

# c++ - 在 C++ 中生成证书请求

> ID：12943560
> 
> 赞同：3
> 
> 时间：2012-10-17T21:18:55.140
> 
> 标签：c++, openssl, certificate

我是加密环境的初学者，我想做一些基本的事情。

正如标题所说，我想生成一个证书请求，然后将其发送给 CA 以生成证书，然后我想撤销它。我想用 C++ 来完成这一切。我已经使用命令提示符使用 openssl 库生成了一个 CA，但现在我想在 Visual Studio (C++) 中使用以这种方式生成的 CA 来完成上述工作。

我在互联网上搜索了哪个图书馆最适合这种工作，但我似乎无法得到结果。有人能指出我正确的方向吗？（一些例子将不胜感激，因为到目前为止 msdn 网站对我帮助不大）。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:39:03.177

我推荐~~[Keyczar（已弃用）](https://github.com/google/keyczar)~~ [Google 的 Tink](https://github.com/google/tink)和[Crypto++](http://www.cryptopp.com/)。如果您喜欢冒险，可以使用[sslpkix](https://github.com/jweyrich/sslpkix/)，它是一个 C++ 包装器，用于使用 OpenSSL 处理数字证书。虽然它是功能性的，但它的 API 并不完整，并且可能会发生变化。它还缺少文档和 VS 项目。不过，您可能会发现它作为学习资源很有用（检查测试用例）。

# cocos2d-iphone - 升级后模板选择器中缺少 cocos2d v2.x

> ID：12943562
> 
> 赞同：1
> 
> 时间：2012-10-17T21:19:21.387
> 
> 标签：cocos2d-iphone, kobold2d

我在 iPhone 上使用 cocos2d v1。当 Steffen Itterheim 的 Learn cocos2d 2 一书出版时，我安装了 Kobold2D v 2.0.4。这本书建议使用 cocos2d v2.x 或 Kobold2D 模板类向项目添加新文件，但在 XCode 中都没有出现！它仍然只是将 cocos2d 作为模板类。这很重要吗？谢谢

# c# - 将外部项目包含为 dll

> ID：12943563
> 
> 赞同：1
> 
> 时间：2012-10-17T21:19:27.063
> 
> 标签：c#, visual-studio-2010, mercurial, tortoisehg, bitbucket

我有一个 VS2010 解决方案，它使用自己的项目（位于该解决方案的文件夹中，因为我认为它们与此解决方案直接相关）但也重用了其他一些解决方案和项目中的代码 - 在处理此解决方案时，我意识到我已经编写了代码来执行某些任务，作为其他不相关程序的一部分。

我使用 TortoiseHg 将主解决方案文件夹维护为 Mercurial 存储库，但是，它不包括我的其他外部项目。当本地仓库推送到我的 BitBucket 仓库时，我的主要解决方案的代码就在那里，但是来自外部项目的代码自然就不见了。

我该如何解决这个问题？

*   保留它对我来说很方便（尽管在硬盘驱动器上移动我的代码以及修改我使用的外部项目时可能需要小心）但是任何尝试构建我的 BitBucket 存储库的人都将无法这样做，因为基本上缺少一些关键代码（他们的 VS 也会抱怨，因为 sln 文件指向他们没有的项目）。
*   包含所有项目将解决该问题，但需要我重做存储库的目录结构，并包含许多与只对一个解决方案感兴趣的人不相关的代码。此外，如果我在一系列提交中修改外部项目到他们自己的存储库，我还必须将所有这些更改在一个大 blob 中提交到此解决方案的存储库。
*   将外部项目预先构建到 dll 中，将这些 dll 附加到我的解决方案和存储库中，然后忘记外部项目的源代码将是理想的。但是，我不知道该怎么做，而且由于源代码不存在，使用 dll 会更难吗？Intellisense 会崩溃吗？使用 dll 时我还会看到我的文档吗？

很抱歉这个基本问题，但我很困惑这样做的“正确”方式是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:22:56.003

最后一个选项对我来说似乎是最直接的。使用构建菜单将您的外部解决方案/项目编译为 .dll（确保在发布模式下构建）。

然后在您的主版本控制项目中添加对 dll 文件的引用。这不会破坏智能感知，并且您的 dll 文件将与您的源代码一起分发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:51:00.900

在 Mercurial-natural 方式（控制源树）中，您可以考虑[Subrepository](http://mercurial.selenic.com/wiki/Subrepository)扩展（而具有几乎相同任务的[GuestRepo](https://bitbucket.org/selinc/guestrepo)对我来说似乎更强大）或者，也许是[hgforest](https://bitbucket.org/gxti/hgforest/overview)

# asp.net-mvc-3 - MVC3 路由混淆

> ID：12943566
> 
> 赞同：3
> 
> 时间：2012-10-17T21:19:33.850
> 
> 标签：asp.net-mvc-3, routing

我希望能够通过一个路由约束声明访问以下内容：

```
/picks                        
/picks/{teamID}/{week}        
/picks/save/{teamID}/{week} 
```

这不适用于第二个请求：`/picks/{teamID}/{week}`

```
routes.MapRoute(
  "picks",
  "picks/{action}/{teamID}/{week}",
  new { controller = "Picks", 
        action = "Index", 
        teamID = UrlParameter.Optional, 
        week = UrlParameter.Optional }); 
```

在我看来，该操作应该默认为，`Index`因为我不提供一个，但我假设它实际上是在尝试找到该操作`{teamID}`（这是一个数字）。

如何使此约束处理所有 3 种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:25:30.820

您只需要省略第一条路线的 rout 字符串中的操作：

```
routes.MapRoute( 
    "picks", 
    "picks/{teamID}/{week}", 
    new { controller = "Picks",  
            action = "Index",  
            teamID = UrlParameter.Optional,  
            week = UrlParameter.Optional }); 
```

请记住将更具体的路线放在更通用的路线之上。

例如：

```
"picks/{teamID}/{week}"
"picks/{action}/{teamID}/{week}"
"{controller}/{action}/{id}" 
```

路由按照添加的顺序进行尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:25:42.553

查看 Phill Haack[路由调试器](http://haacked.com/archive/2011/04/13/routedebugger-2.aspx)。

您还可以添加约束，以便`teamId`仅在它是数字时才会被拾取

```
routes.MapRoute(
  "picks",
  "picks/{action}/{teamID}/{week}",
  new
  {
      controller = "Picks",
      action = "Index",
      teamID = UrlParameter.Optional,
      week = UrlParameter.Optional
  },
  new { teamID = @"\d+" }); 
```

# assembly - 在 x86 (NASM) 中为变量赋值

> ID：12943570
> 
> 赞同：3
> 
> 时间：2012-10-17T21:19:41.070
> 
> 标签：assembly, nasm

我决定为了好玩而学习汇编程序。我已经用 C 编码多年了。

我遵循了一些打印“Hello world”的在线教程，并在 NASM 手册中进行了一些研究。一切都很好。所以，我给自己设置了一个循环打印“hello world”的任务。我知道我可以使用`loop`操作码来做到这一点，但想显式地对其进行编码并使用该`.bss`部分中定义的变量。

但是，当我收到错误消息时，我显然误解了变量赋值在汇编中的工作方式：

```
nasm -felf -o hello.o hello.asm
hello.asm:16: error: invalid combination of opcode and operands
hello.asm:17: error: invalid combination of opcode and operands
hello.asm:28: error: invalid combination of opcode and operands 
```

我尝试在网上搜索有关变量分配的信息，包括 NASM 手册，但似乎找不到我需要的信息。有人可以帮忙吗？这是我的（简单！）代码：

```
; print "Hello world!" to the screen multiple times

section .data
    msg:    db  'Hello world!', 10
    msglen: equ $ - msg

section .bss
    iter:   resb    1

section .text
    global _start

_start:

    ; loop 10 times
    mov iter, 0     ; initalise loop counter
FL: cmp iter, 10    ; is iter == 10?
    jge LoopEnd

    ; write the message to STDOUT:
    mov eax,4       ; code for write syscall
    mov ebx,1       ; stdout fd
    mov ecx,msg     ; message to print...
    mov edx,msglen  ; ...and it's length
    int 80h         ; kernel interrupt

    ; increment loop iterator
    inc iter
    jp FL

LoopEnd:

    ; now exit, with return code 0:
    mov eax,1
    mov ebx,0
    int 80h 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T21:24:24.483

要在 nasm 中进行内存引用，您必须用方括号将地址括起来。此外，在您在这里遇到的每种情况下，您还需要指定大小，如下所示：

```
 mov byte [iter], 0     ; initalise loop counter
FL: cmp byte [iter], 10    ; is iter == 10?

    inc byte [iter] 
```

`iter`但是，在这种情况下，存储在寄存器中而不是存储在内存中可能更有意义。您正在使用系统调用破坏大多数明显的调用，但`esi`或者`edi`看起来可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T21:21:51.303

我认为它必须在括号中。试试`[iter]`。

每当您有此类问题时，请参阅[NASM 文档。](http://www.tortall.net/projects/yasm/manual/html/nasm-language.html)

在这种情况下，[有效地址](http://www.tortall.net/projects/yasm/manual/html/nasm-effaddr.html)部分：

> 有效地址是引用内存的指令的任何操作数。在 NASM 中，有效地址有一个非常简单的语法：它们由一个计算为所需地址的表达式组成，用方括号括起来。例如：

```
wordvar dw 123
mov ax,[wordvar]
mov ax,[wordvar+1]
mov ax,[es:wordvar+bx] 
```

# ruby-on-rails - 如何在 Heroku 上更改 Rails 应用程序的用户名和密码？

> ID：12943572
> 
> 赞同：1
> 
> 时间：2012-10-17T21:19:43.170
> 
> 标签：ruby-on-rails, email, authentication, heroku, mail-server

我不想将电子邮件服务器的用户名/密码组合提交给 Git，因为源代码是公开的。有没有办法在 Heroku 本身上改变它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:21:40.303

[https://devcenter.heroku.com/articles/config-vars](https://devcenter.heroku.com/articles/config-vars)

> 处理此类配置变量的传统方法是将它们放在源下 - 在某种属性文件中。这是一个容易出错的过程，对于开源应用程序来说尤其复杂，因为这些应用程序通常必须使用特定于应用程序的配置来维护单独的（和私有的）分支。
> 
> 更好的解决方案是使用环境变量，并将密钥保留在代码之外。在传统主机上或在本地工作，您可以在 bashrc 中设置环境变量。在 Heroku 上，您使用配置变量。
> 
> 使用 Heroku CLI 的 config、config:add、config:get 和 config:remove 来管理你的配置变量：

# javascript - 如何优化 Javascript 查找？

> ID：12943573
> 
> 赞同：3
> 
> 时间：2012-10-17T21:19:47.507
> 
> 标签：javascript

根据 Javascript 的主要实现，对变量和函数的查找从原点开始并向上遍历直到全局对象。

现在假设您正在构建更大的基于 OOP 的框架，并且您需要在所有地方调用安全检查，那么以这种方式调用这些东西似乎并不正确：“xapp.utils.isValidString(var)。这同样适用于常量，枚举和标志，通常在任何地方发生。

我不太确定这是否会对答案产生影响，但我们在 Dojo 中做了所有事情，并且我们非常了解它的 lang.mixin 方法。

然而，这个想法是通过使用构造函数或原型将一组明显且最小的函数和对象混合到目标对象的本地范围中。你认为这是一种合法的方式吗？

那么缓存和重用那些准备好的对象呢？您会选择哪种缓冲器？对我来说，它看起来很像一个环形缓冲区。

我还在学习 JS 优化，我会很高兴你的想法！

供您参考，这里有一些大师解释的范围管理的常见提示：http: [//googlecode.blogspot.com.es/2009/06/nicholas-c-zakas-speed-up-your.html](http://googlecode.blogspot.com.es/2009/06/nicholas-c-zakas-speed-up-your.html)

更新：我们只需要关注现代桌面和移动浏览器，完全不考虑 IE！此外，我们熟悉 Dojo 的构建链，支持每个平台的条件编译（如果这很重要）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T18:53:47.570

至于标识符解析，即直接引用，我建议您切换到严格语言（如果您还没有的话），也就是“严格模式”。严格的语言是静态作用域的，这使得 JS 引擎可以静态绑定标识符，从而在程序执行过程中获得更好的性能（标识符在编译过程中已经绑定）。

* * *

至于属性查找，如果你有长链，例如

```
foo.bar.baz.method1();
foo.bar.baz.method2(); 
```

通常的解决方案（不仅是为了性能，也是为了避免代码重复）是将最右边的对象存储到局部变量中：

```
var baz = foo.bar.baz;

baz.method1();
baz.method2(); 
```

# java - Spring Data JPA Select Distinct

> ID：12943574
> 
> 赞同：13
> 
> 时间：2012-10-17T21:19:51.517
> 
> 标签：java, sql, spring, spring-data-jpa

我有一种情况，我需要构建一个`select distinct a.address from Person a`（其中地址是个人内部的地址实体）类型的查询。

我正在使用规范来动态构建我的 where 子句并使用该`findAll(Specification<T>)`函数来获取结果。问题是我不能使用规范来构建我的选择子句，因此不能使用`findAll(Spcification)`函数。

做这样的事情的最好方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-04-27T09:07:54.783

由于这是谷歌的首要问题，我将在这里发布答案。

在规范中您可以访问查询，因此您可以这样做

```
query.distinct(true); 
```

完整的示例，导致发出这样的 SQL：

> 2015-04-27 12:03:39 EEST [7766-759] postgres@sales 日志：执行：从 PRODUCTVARIANT 中选择 DISTINCT t1.ID、t1.NAME、t1.WEBNAME、t1.WEBORDER、t1.PVGROUPPARENT_ID、t1.SITE_ID t0, PVGROUP t1 WHERE ((t0.PRODUCTTYPE_ID = $1) AND (t0.PVGROUP_ID = t1.ID)) 2015-04-27 12:03:39 EEST [7766-760] postgres@sales DETAIL: 参数: $1 = ' 4608bdc9-d0f2-4230-82fd-b0f776dc2cfd'

```
public static Specification<PVGroup> byProductType(final ProductType pt) {
        return (final Root<PVGroup> root, final CriteriaQuery<?> query, final CriteriaBuilder builder) -> {

            query.distinct(true);
            final CollectionJoin<PVGroup, ProductVariant> jPV = root.join(PVGroup_.productVariant);

            final Path<ProductType> ptPath = jPV.get(ProductVariant_.productType);

            return builder.equal(ptPath, pt);
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-01-06T14:35:13.707

我遇到了同样的问题，所以如果它对某人有帮助，这就是我所做的：

规范被翻译成 where 子句，`findAll(Specification<T>)`函数正在创建自己的 select 子句。因此，我们无法通过某种方式使用该`findAll(Specification<T>)`函数来解决此问题。我已经有扩展的自定义存储库`SimpleJpaRepository`，所以我添加了一个新方法：

```
@Override
    @Transactional(readOnly = true)
    public List<Object> findDistinctValues(Specifications<T> spec, String columnName) {
        return getQuery(spec, columnName).getResultList();
    }

    protected TypedQuery<Object> getQuery(Specification<T> spec, final String distinctColumnName) {

        CriteriaBuilder builder = em.getCriteriaBuilder();
        CriteriaQuery<Object> query = builder.createQuery(Object.class);
        Root<T> root = applySpecificationToCriteria(spec, query);

        if (null != distinctColumnName) {
            query.distinct(true);
            query.multiselect(root.get(distinctColumnName));
        }

        // We order by the distinct column, Asc
        query.orderBy(builder.asc(root.get(distinctColumnName)));

        return em.createQuery(query);
    } 
```

`applySpecificationToCriteria`在`SimpleJpaRepository`课堂上。

现在您可以使用该`findDistinctValues`方法了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-18T07:57:21.870

好的！您可以在特定列中使用`distinct`，`JPQL`也可以在特定列中使用。它已经[在这里了](https://stackoverflow.com/questions/9231118/using-distinct-keyword-in-jpa-on-individual-columns)。参考[在 JPA 中使用 DISTINCT](https://stackoverflow.com/questions/1346181/using-distinct-in-jpa)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-18T07:37:40.290

一个快速而肮脏的解决方案是使用 a 过滤结果`Set`：

```
Set<...> set = new HashSet<...>( findAll( ... ) ) 
```

并确保`equals()`并`hashCode()`在域类上相关实现:-)

干杯，

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2015-06-01T14:29:04.307

这行得通吗？

`List<Person> findDistinctPeopleByAddress(String lastname, String firstname);`

然后遍历列表并使用 Person.getAddress() ？

# ruby-on-rails - 为数组中对象的索引生成哈希查找表

> ID：12943578
> 
> 赞同：2
> 
> 时间：2012-10-17T21:20:25.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想创建一个查找表来查找数组中对象的索引：

获取一个数组`["a", "b", "c"]`并为每个对象的索引生成一个查找哈希表`{"a"=>0, "b"=>1, "c"=>2}`

我能想到的最简单的方法是：

```
i = 0
lookup = array.each_with_object({}) do |value,hash|
  hash[value] = i
  i += 1
end 
```

和：

```
i = -1
lookup = Hash[array.map {|x| [x, i+=1]}] 
```

我觉得有更优雅的解决方案可以做到这一点，欢迎任何想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:54:55.283

这个怎么样：

```
Hash[array.zip 0..array.length] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:52:51.867

```
lookup  = Hash[array.each_with_index.map{|el,i| [el, i]}] 
```

* * *

@Mark Thomas 的回答比我的还要快：

```
array = (0..100000).to_a;
Benchmark.bm do |x|
  x.report { Hash[array.each_with_index.map{|el,i| [el, i]}] }
  x.report { Hash[array.zip 0..array.length] }
end

     user     system      total        real
 0.050000   0.010000   0.060000 (  0.053233)
 0.040000   0.000000   0.040000 (  0.036471) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-18T03:45:40.677

比 apneadiving 的代码稍慢，但更简单：

```
 Hash[array.map.with_index.to_a] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T21:41:48.670

也许这个？

```
lookup = {}
arr.each_with_index { |elem,index|  lookup[elem] = index } 
```

# qt - Qt如何在点阵打印机上打印格式化文本？

> ID：12943580
> 
> 赞同：1
> 
> 时间：2012-10-17T21:20:28.993
> 
> 标签：qt, printing

我需要在点阵打印机上打印（使用 Qt）格式化文本。问题是 QPrinter 类仅生成图形模式文本。如何在点阵打印机上打印格式化文本？你知道处理这个问题的任何 c++ 库吗？

# php - 避免 WordPress Post Loop 中的重复函数名称（WP_Footer 脚本）

> ID：12943581
> 
> 赞同：0
> 
> 时间：2012-10-17T21:20:31.303
> 
> 标签：php, wordpress

假设我创建了一个将内容（用作短代码）注入帖子的插件。我正在尝试将每个帖子的代码推送到页面底部。

这很好用，但是当您在使用相同简码的多个帖子的存档页面上时，会出现明显的冲突，因为函数名称会重复，并且只会输出一次页脚代码（activate_flex_slider）。

```
<?php
function your_function() {
    echo '<p>This is inserted at the bottom</p>';
}
add_action('wp_footer', 'your_function');
?> 
```

我想要做的是输出页脚脚本，以便有多个 jQuery 实例指向它们各自的 ID...

```
<?php
    function flex_slider() {
        $output ='<ul class="flexslider"><li>Slide Content</li></ul>';
        return $output;
    }

    function activate_flex_slider(){
        ?>
    <script>
                ( function ($) {
             $(window).load(function(){

       //different number will be prepended to ID (matches post ID #)
      $('#carousel-<?php echo $post->ID ?>').flexslider();
    });
        })(jQuery);
    </script>
<?php
    }

    // Hook into footer so slider becomes active after page loads
    add_action('wp_footer','activate_flex_slider');

    // Create the Shortcode
    add_shortcode('flex_slider', 'flex_slider');
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T00:55:11.717

所以这里的整个问题是导致我连续的钩子排队。如果我们编译所有帖子 ID 并包含您自己的 javascript 处理程序以在页面加载时输出 flex_slider 实例会怎样。仅当页面是存档页面时才让脚本入队。如果你让所有的轮播容器都有一个独特的类，那么你可以做这样的事情。

把它放在你的页面模板或页脚或页眉中，在哪里并不重要（当然用你自己的东西填写通用的东西）：

```
 <?php if (is_archive()) wp_enqueue_script('special_sauce', '/js/special_sauce_location.js', 'jquery_handle'); ?> 
```

这适用于您的 special_sauce 脚本。

```
 <script>
 ( function ($) {
 $('document').ready(function () {
 $('.carousel_container').each( function(i,obj) {
     obj.flexslider();
 });
 });
 })(jQuery);
 </script> 
```

尚未对此进行任何测试，但我觉得它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:58:07.530

显然，最好不要在循环内声明函数，但如果不能，那么这应该可以工作......

```
<?php
if(function_exists('your_function') == false) {
    function your_function() {
        echo '<p>This is inserted at the bottom</p>';
    }
}
add_action('wp_footer', 'your_function');
?> 
```

# javascript - 视网膜（或其他高分辨率）显示器是否会影响基于分辨率的手机和平板电脑之间的差异？

> ID：12943586
> 
> 赞同：2
> 
> 时间：2012-10-17T21:20:53.487
> 
> 标签：javascript, android, html, ios, web

我为同一个站点制作了两个不同的网页：一个用于电话设备，一个用于桌面设备。主要原因是网页上有很多按钮，如果您使用手机，这些按钮很难触摸，因为它们在手机屏幕上看起来非常小。所以我制作了一个 javscript，它根据屏幕的分辨率将用户重定向到相应的页面。

```
if ( (screen.width < 800) && (screen.height < 600) ) { 
    window.location = 'mobilesite';
} else {
    window.location = 'desktopsite';
} 
```

但我担心新的视网膜显示器。我认为这种方法行不通。（我没有视网膜显示设备来测试它）

我决定不使用基于操作系统的差异化，因为我的问题在于大小，而不是操作系统，例如在 Android/IOS/Kindle/etc 中。平板电脑 我更喜欢用户使用桌面版本，因为它在大屏幕上看起来更好。

所以我有两个问题：1.-视网膜显示器的分辨率会影响浏览器的分辨率吗？（或者也许只有本机应用程序）

2.- 是否有任何不同的方式来区分手机和平板电脑使用 javascript 或 jquery 客户端？

另外，我认为重要的是不要将脚本限制为仅在 IOS 设备中检测这种差异，很快它将在其他品牌的手机中显示更高分辨率。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T21:39:50.307

Apple Retina 屏幕会报告自己，好像它的像素数量是实际像素的一半，因为浏览器本身就具有魔力。如果要检测高分辨率屏幕，请乘以像素密度。

不要进行用户代理检查，因为您将每 2 周添加更多设备。它打破了网络。进行功能检查或特定检查。

哦，你会想要阅读 CSS3 媒体查询，以防你只想为移动设备显示更大的按钮。

# python - 我在 django-simple-ratings 的“INSTALLED_APPS”中添加了什么？

> ID：12943587
> 
> 赞同：0
> 
> 时间：2012-10-17T21:21:06.497
> 
> 标签：python, django

我正在尝试安装 django-simple-ratings。

它需要 django-generic-aggregation。但是，这两组文档都没有提到任何关于向 INSTALLED_APPS 添加一行的内容。

因此，在我放入`from rating.models import Ratings`其中一个模型之前，按照说明进行操作可以正常工作。我得到错误

```
No module named rating.models 
```

我的第一个假设是，我确实需要在 INSTALLED_APPS 中为 django 加载 django-simple-ratings 模块。但是那个字符串是什么？我试过了`django-simple-ratings`，`djangosimpleratings`但都不管用。我是否也需要为 django-generic-aggregation 执行此操作？

也许一个更好的问题是：对于任何给定的 Django 模块，如何找到在 INSTALLED_APPS 中安装它所需的字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:44:52.163

好的，就是这样。首先，INSTALLED_APPS 中的应用名称只是`ratings`. 第二，不是吗`from ratings.models import Ratings`。这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:28:07.920

据我所知，当应用程序的名称包含破折号时，它会在 INSTALLED_APPS 中用下划线书写。在您的情况下，这将是 django_simple_ratings。

此外，您在帖子中错过了评分中的“t”。你在代码中也是这样写的吗？

# javascript - Gziped Css 和 JS 不工作

> ID：12943588
> 
> 赞同：0
> 
> 时间：2012-10-17T21:21:06.513
> 
> 标签：javascript, html, .htaccess, gzip

我无法让我的 gzip 压缩的 css 和 js 文件工作。它们被压缩了，但是当我打开它们的链接时，我得到如下结果：

```
 ‹������Í½{Û6²0üÿ~
››#“,KNÛm©0ÞÄI¶=ÛÛi²·WVúP$%Ñ–DY_"i?û;\IÊv»çý=owc‘ 0�ƒÁ`03¸‰Å"ý=ž¬³ÈóÄ8^žOòä*K£a<Yfb™Å‹dü]ÍÖ“É†ëY²Ê‹ÙA2ôôÍ/—ÁFçƒ·Vžvó¡h€Sf¸Á§®UÙj±ÎvXH"]$0‰ž§2Åiúî&›­¾Ï—«l–- ŠšTÿh0Y/ŽÄ0ŸL¸¹‚útës§ƒI‚M:‹l™­Ü"‹lµ^Ì¨­¤¨¦¬Vq2&HÁæPÊ¡íQé³TÌÊ
„Î~Z—¿¶Iº1ºl£aÀpëâI¶�?þtðîïï~üxðúãÇ×çßþ�‡‡‡Gung†Ö´Ì6ÐÃ´HÖShKk”­ÞM2||sÿ]ê«Ôxy^°yjf=¶Ý2Åí¬¦XöŸÛóvÝ?ø
\óeë‡¢øX“e´¹ÉKøzÖOÖù$
½øE–¥_}sš¦_Ùþ²~Ýî|õu–œ&amp;j
³oÚÁàOéàÀÆÎ"ººŸg?
# 
```

任何想法为什么会发生这种情况以及我应该如何解决这个问题？

Apache 模块，如 deflate、expires、headers 都已安装并正常工作。

我使用的平台是typo3。

谢谢。

```
 <link rel="stylesheet" type="text/css" media="all" href="typo3temp/scriptmerger/compressed/head-ed0db5492e25e2aae2d5194f2417f7f4.merged.gz.css" />

    <link rel="stylesheet" type="text/css" media="screen" href="typo3temp/scriptmerger/compressed/head-51cb0e8880d742a31d3b7277d848f046.merged.gz.css" />

<!--[if lt IE 7]>
<![endif]-->
    <script type="text/javascript" src="typo3temp/scriptmerger/compressed/head-fd881451a9d72dbe96f8afc7214bf265.merged.gz.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T05:44:35.567

您需要提供更多信息。Deflate 模块无法解压缩 gzip 文件。您还需要在 apache 配置中将 css 和 js 文件添加到 gzip 处理程序，否则文件不会被解压缩。双重压缩并非如​​此，因为正常压缩是一个透明的过程。反正我不会使用 Typo3 后端压缩。我也有很大的问题。如果您想要更快的速度，请使用 nginx 或 lighttpd 等替代网络服务器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-18T04:14:39.873

正如布拉德已经指出的那样，看起来您正在对数据进行双重压缩。通常，当您使用服务器/浏览器 gzip 时，您只需将文件编写为普通的未压缩文本。服务器软件 (Apache) 的工作是动态压缩数据并将其发送到浏览器，然后浏览器透明地解压缩数据。

如果需要，您可以将预压缩的文件上传到服务器，但您需要进行额外的配置（请参阅[http://httpd.apache.org/docs/2.0/content-negotiation.html](http://httpd.apache.org/docs/2.0/content-negotiation.html)）。但是我对此不太了解，因为我不使用它；即时执行此操作所需的 CPU 时间微不足道。

# javascript - 将对象附加到jquery中的dom元素

> ID：12943589
> 
> 赞同：-2
> 
> 时间：2012-10-17T21:21:09.603
> 
> 标签：javascript, dom, jquery

什么是做以下事情的方法？我知道我可以使用 .html() 从对象中提取 html，但我想附加该对象。

```
 var $firstArticle = $('.agentPressList li:first');    
  $('ul').append($firstArticle); 
```

我知道下面会很好地工作，但正在寻找如何以这种方式使用 jquery 对象，而不是使用变量两端的字符串。

```
 var $firstArticle = $('.agentPressList li:first');         
         $('ul').append('<li>' + $firstArticle.html() + '</li>'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:25:37.767

如果您想在新位置使用所有相同的 li 行为，请使用[jquery clone 。](http://api.jquery.com/clone/)其他明智的使用html。

```
var $firstArticle = $('.agentPressList li:first');    
  $('ul').append($firstArticle.clone(true)); 
```

或者

```
$('ul').html($firstArticle.html()); 
```

# c# - 覆盖 GetHashCode() 时使用 Guid().GetHashCode() 的缺点是什么

> ID：12943590
> 
> 赞同：4
> 
> 时间：2012-10-17T21:21:10.263
> 
> 标签：c#, dictionary, equals, gethashcode, iequatable

我找到了一个看起来像这样的 GetHashCode() 实现

```
 Guid _hashCode = Guid.NewGuid();
    public override int GetHashCode()
    {
        return _hashCode.GetHashCode();
    } 
```

即使认为 Equals 看起来是正确的，说这个实现会导致许多关于 .NET 的假设被打破是否正确？

```
 public override bool Equals(object obj)
    {
        if (obj.GetType() != trustedEntity.GetType())
            return false;

        TrustedEntity typedObj = (TrustedEntity)obj;

        if (trustedEntity.BackTrustLink != typedObj.BackTrustLink)
            return false;
        if (trustedEntity.ForwardTrustLink != typedObj.ForwardTrustLink)
            return false;
        if (trustedEntity.EntryName != typedObj.EntryName)
            return false;

        return true;
    } 
```

我听到的反驳论点是，一旦创建对象，GetHashCode 就永远不需要改变。这是因为该对象存储在字典中。

有人可以为我澄清一下，并解释如果对象发生变化，GetHashCode 需要发生什么，最终会改变 Equals 方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:29:58.257

[从 MSDN（实施者注意事项部分）](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)：

> 哈希函数必须具有以下属性：
> 
> 1.  如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。但是，如果两个对象比较不相等，则两个对象的 GetHashCode 方法不必返回不同的值。
>     
>     
> 2.  只要确定对象的 Equals 方法的返回值的对象状态没有修改，对象的 GetHashCode 方法就必须始终返回相同的哈希码。请注意，这仅适用于应用程序的当前执行，并且如果再次运行应用程序，则可以返回不同的哈希码。
>     
>     
> 3.  为了获得最佳性能，散列函数必须为所有输入生成随机分布。

根据`Equals`此对象的方法，您也可能违反了文档中的第一点。

[更多精彩阅读](http://blogs.msdn.com/b/ericlippert/archive/2011/02/28/guidelines-and-rules-for-gethashcode.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:31:45.297

哈希是一种单向数学函数，它接受输入并提供可重现的输出。

哈希通常用于识别本身无法识别的数据，因此如果您对数据块计算哈希，则该数据应始终创建相同的哈希。一个例子是密码。当您注册网站时，他们会通过算法存储您密码的哈希值。当您登录时，您将密码发送到该站点，该站点使用与存储密码时使用的相同算法对其进行哈希处理。如果两个哈希值匹配，则您输入了正确的密码。

如果对象发生变化，计算的哈希值会有所不同。这对于数据验证通常很重要。如果我使用 sha1 将字符串 'Frank' 散列为 123456789（只是一个示例），然后我将数据连同散列一起发送给他们，他们可以执行相同的散列并查看值是否匹配。如果我的位在发送时搞砸了，他们收到“Brank”，当他们计算哈希时，它不会是 123456789，他们知道数据在发送中被破坏了。

通过使用`NewGuid`，您只是在生成一个与原始数据无关的随机数。它不能被复制，所以上面的所有例子都是不可能的。哈希算法必须始终为相同的输入提供相同的输出，并且它还必须尝试防止任何其他输入生成相同的输出。

希望有帮助

# python - 是否可以在 Sublime Text 2 中显示确切位置？

> ID：12943594
> 
> 赞同：27
> 
> 时间：2012-10-17T21:21:34.993
> 
> 标签：python, sublimetext2, markdown

我一直在学习 Markdown，并使用 Python Markdown 包，当我尝试转换从网络粘贴的文本时，它通常会返回以下内容：

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\u201c' in 
position 1611: ordinal not in range(128) 
```

在我的编辑器底部，我目前看到：

```
COMMAND MODE, Line X, Column Y 
```

Sublime Text 2 中是否有一个设置`1611`可以始终显示完整位置（如上例所示），以便我可以快速找到坏字符？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-21T20:47:41.603

您可以制作一个简单的 python 脚本来执行此操作。

`characterCounter.py`1\. 将此代码作为( `Preferences > Browse Packages > User`)保存到您的用户文件夹：

```
import sublime, sublime_plugin

class PositionListener(sublime_plugin.EventListener):
  def on_selection_modified(self,view):
    text = "Position: "
    sels = view.sel()
    for s in sels:
        text += " " + str(s.begin())
        if not s.empty():
            text += "-" + str(s.end()) + " "
    view.set_status('exact_pos', text) 
```

2\. 然后重新启动 Sublime Text 以加载它。

# javascript - javascript写入iPhone上的文本框不工作但在PC上工作

> ID：12943595
> 
> 赞同：1
> 
> 时间：2012-10-17T21:21:38.400
> 
> 标签：javascript, iphone, textbox

我有一个页面，我们的领域使用它来快速为他们在该领域所做的工作创建符号。有一系列下拉框和输入信息的地方，完成后，他们单击“生成注释”链接，该链接将所有信息放在一起并将其显示在文本框中。它在计算机上的 Internet Explorer 中运行良好，但是当尝试使用 iPhone 访问时，文本不会显示在 TextBox 中。我真的可以在这里使用一些帮助。这是我拥有的部分代码。这也是 temp 的链接，以了解它应该如何工作。

[http://forums.mycybernation.net/notegen/trial.html](http://forums.mycybernation.net/notegen/trial.html)

再次适用于 PC，但不适用于 iPhone。

谢谢。

```
<SCRIPT language="javascript">
 function CreateMsg() 
{
  var appCA = document.getElementById("MSG1");
  var appCA1 = document.getElementById("MSG2");
  var appEND = document.getElementById("MSG3");
  var origAPP = document.getElementById("MSG4");

  document.getElementById("Output").value = 

  appEND.innerHTML = "CA=" + 
document.forms[0].appCA.value + 
document.forms[0].appCA1.value + " | " +
document.forms[0].appEND.value + " " + 
document.forms[0].origAPP.value + " " + 
"\n\n";
}
</SCRIPT>

<A href="javascript:CreateMsg();">Generate Notes:</A> 

<BR><TEXTAREA class="TEXT_FIELD" id="OUTPUT" style="WIDTH: 320px" name="OUTPUT" rows="10" cols="75" TYPE="TEXT" INPUT ></TEXTAREA> <BR>
<SPAN id=MSG1>&nbsp;</SPAN> <BR>
<SPAN id=MSG2>&nbsp;</SPAN> <BR>
<SPAN id=MSG3>&nbsp;</SPAN> <BR>
<SPAN id=MSG4>&nbsp;</SPAN> <BR>

<BR></FORM> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T22:15:59.513

您的`textarea`id 在`OUTPUT`您选择带有 id 的元素时`Output`。IE 版本的方法不区分大小写，但 WebKit 版本区分大小写。

# java - Java Socket 自动重启服务器

> ID：12943597
> 
> 赞同：1
> 
> 时间：2012-10-17T21:21:49.860
> 
> 标签：java, serversocket

我正在使用 Oracle 的[Knock Knock](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)示例对服务器和客户端进行编程，当客户端连接到服务器时，它会收到一个要与之交互的 Knock Knock 笑话。一切运行良好。

我的问题是当客户端完成并与服务器断开连接时，服务器程序也会终止。如果服务器终止，我如何让它再次自动运行，以便它可以接受另一个客户端的请求，而无需手动重新启动服务器端？

下面是我的代码，其中注释显示了我卡在哪里。我正在使用两个在 vmware 播放器上运行的 centos vm。

```
import java.net.*;
import java.io.*;

public class KnockKnockServer {
    public static void main(String[] args) throws IOException {
    server(); 
    /*HERE IS WHERE I AM STUCK
     * If I call server() above in my main method everything runs great.
     * However, I would like to put a timer or something inside main so that 
     * every second it checks to see if server() is still running and if not
     * then start it up again.
     */
    }

    public static void server() throws IOException{
    ServerSocket serverSocket = null;
        try {
            serverSocket = new ServerSocket(4444);
        } catch (IOException e) {
            System.err.println("Could not listen on port: 4444.");
            System.exit(1);
        }

        Socket clientSocket = null;
        try {
            clientSocket = serverSocket.accept();
        } catch (IOException e) {
            System.err.println("Accept failed.");
            System.exit(1);
        }

        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(
                new InputStreamReader(
                clientSocket.getInputStream()));
        String inputLine, outputLine;
        KnockKnockProtocol kkp = new KnockKnockProtocol();

        outputLine = kkp.processInput(null);
        out.println(outputLine);

        while ((inputLine = in.readLine()) != null) {
             outputLine = kkp.processInput(inputLine);
             out.println(outputLine);
             if (outputLine.equals("Bye."))
                break;
        }
        out.close();
        in.close();
        clientSocket.close();
        serverSocket.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:25:40.480

您`serverSocket`在处理一个连接后关闭：

```
serverSocket.close(); 
```

您需要保持此状态并将接收到的客户端连接移交给工作线程。

在您的`main`方法中，您将拥有：

```
while (serverIsActive) {
   clientSocket = serverSocket.accept();
   new ClientWorker(clientSocket).launch();
} 
```

`ClientWorker`将是`Runnable`并处理客户端连接：

```
public class ClientWorker implements Runnable {

public ClientWorker(Socket clientSocket) {
   this.clientSocket = clientSocket;
}

public void launch() {
   new Thread(this).start();
}

@Override
public void run() {
   PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);
   ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:37:55.810

您可以将连接处理代码移动到一个额外的线程（我们称之为 KnockKnockHandler）：

```
public class KnockKnockHandler extends Thread {
    private Socket socket;
    public KnockKnockWorker(Socket socket) {
       this.socket = socket;
    }
    public void run() {
        PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(
            new InputStreamReader(
            socket.getInputStream()));
        String inputLine, outputLine;
        KnockKnockProtocol kkp = new KnockKnockProtocol();

        outputLine = kkp.processInput(null);
        out.println(outputLine);

        while ((inputLine = in.readLine()) != null) {
             outputLine = kkp.processInput(inputLine);
             out.println(outputLine);
             if (outputLine.equals("Bye."))
                break;
        }
        out.close();
        in.close();
        socket.close();
    }
} 
```

一旦有人连接到您的服务器，您将创建一个新的 KnockKnockHandler 实例并启动它：

```
try {
    clientSocket = serverSocket.accept();
    KnockKnockHandler handler = new KnockKnockHandler(clientSocket);
    handler.start();
} catch (IOException e) {
    System.err.println("Accept failed.");
    System.exit(1);
} 
```

如果你把它变成一个循环，你的服务器将永远不会关闭（除非抛出异常或 JVM 被终止 ;-)）：

```
while(true) {
    try {
        clientSocket = serverSocket.accept();
        KnockKnockHandler handler = new KnockKnockHandler(clientSocket);
        handler.start();
    } catch (IOException e) {
        System.err.println("Accept failed.");
        System.exit(1);
    }
} 
```

如果客户端连接您的服务器将启动一个新线程并进入循环的下一次迭代并等待下一个客户端连接。

# objective-c - 如何在 iOS 中使用标签来制作可编辑的文本

> ID：12943599
> 
> 赞同：0
> 
> 时间：2012-10-17T21:21:55.757
> 
> 标签：objective-c, ios, cocoa-touch, label, calculator

我想制作一个计算器，当我输入值时它会打印到标签中？

我已经整理好了输入值编码。现在我只需要弄清楚如何将整数/字符串打印到标签上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:00:05.657

尝试这个：

```
//in viewDidLoad    
[self.yourTextField addTarget:self action:@selector(updateLabelUsingContentsOfTextField:) forControlEvents:UIControlEventEditingChanged];

    -(void)updateLabelUsingContentsOfTextField{
       self.yourLabel.text = self.yourTextField.text;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:24:42.290

您可以使用 UITextField 并将其外观更改为看起来像 UILabel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:26:24.513

本教程将逐步引导您在 XCode 中创建计算器。 [http://www.youtube.com/watch?v=SBTXtwTRdk0](http://www.youtube.com/watch?v=SBTXtwTRdk0)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-17T22:14:56.407

试试这个解决方案

```
-(void) updateLabelText: ( NSString *)txt
{
   [self.myLabel performSelectorOnMainThread : @ selector(setText : ) withObject:txt waitUntilDone:YES];
} 
```

# java - Java Batch Job Farms 有成熟的项目吗？

> ID：12943600
> 
> 赞同：2
> 
> 时间：2012-10-17T21:21:59.123
> 
> 标签：java, batch-file, java-ee-6, jboss7.x

我们有 Java EE 服务器，为我们提供负载平衡的集群网络场。我想使用相同的 EE 技术，构建在 Java EE 服务器上，但用于运行批处理作业。

我不想重新发明轮子，也不认为我是第一个想到这一点的人。

这类似于 WebShere 的现代批处理功能包，但我正在寻找一个开源解决方案，最好支持或能够支持 JBOSS 7 并使用自由许可证（Apache / MIT 等）。

理想的解决方案允许：

*   是集群的 - 在集群中的多台机器上进行负载平衡和监控作业
*   在单个 EE 服务器 jvm 中运行所有内容
*   将作业作为从中央存储库中提取的可加载模块，不需要将新作业部署到服务器
*   支持事务性（分块）或计算密集型（单步）应用程序
*   提供一个隔离的容器来运行任意数量的作业
*   允许作业停止、暂停和重新启动
*   通过在作业配置的尽可能多的机器上运行块来实现负载平衡
*   对作业进行优先级排序，使高优先级作业首先运行
*   允许按需安排或启动作业
*   有一个简单的 Web 界面，可以监控作业
*   支持 JMX
*   丰富的API

:D 虽然我们在它...

*   有很好的文档
*   提供可选的商业支持，但不一定来自运行项目开发的“营利性”公司

亲爱的圣诞老人，

今年我过得很好，有一次帮助威金斯老太太过马路，然后……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:29:02.473

我认为[**Spring Batch**](http://static.springsource.org/spring-batch/)满足您的所有要求。

这是由 Spring 社区开发的，并得到了良好的支持：

1.  分块
2.  事务管理
3.  停止，开始
4.  故障转移
5.  重试
6.  作业监控（Spring Batch Admin Web）
7.  消息传递
8.  与作业调度程序集成
9.  可以在负载均衡的环境中运行
10.  [**良好的文档**](http://docs.spring.io/spring-batch/trunk/reference/html/)和[**丰富的 API**](http://static.springsource.org/spring-batch/apidocs/index.html)
11.  有足够详细信息的好书，例如 Arnaud Cogoluègnes Thierry Templier Gary Gregory Olivier Bazoud 的“Spring Batch in Action”

# ssrs-2008 - 确定 SSRS 报告是否不包含来自 WebService 的数据

> ID：12943604
> 
> 赞同：1
> 
> 时间：2012-10-17T21:22:19.753
> 
> 标签：ssrs-2008

我有一个应用程序调用 SSRS WebService (SSRS 2008) 以按以下方式运行报告：

```
SSRSService.Render(rpt, format, deviceInfo, out result, out extension, out mimetype, out encoding, out warnings, out streamids); 
```

完成此操作后，它使用 byte[] 结果创建一个文件。我遇到的问题是有时报告不包含任何数据。发生这种情况时，我想中止/绕过创建文件。调用 render 方法后，有没有办法可靠地判断报告是否包含数据？

我知道 Tablix 上有一个名为 NoRowsMessage 的属性，可以在没有数据返回时进行设置。无论用户选择什么格式来运行报告，有没有办法可靠地将其从 byte[] 中提取出来？或者，有没有办法可以向 SSRSExecutionService.Warning[] 添加警告？

在此先感谢您的帮助。

# c# - 是否有任何类型的通用字典尝试获取不存在的键将返回 null？

> ID：12943605
> 
> 赞同：4
> 
> 时间：2012-10-17T21:22:21.043
> 
> 标签：c#, .net, dictionary

我必须使用而不是仅仅在字典中`.ContainsKey`做 a真的让我很恼火。`value==null`现实生活中的例子：

```
var dictionary = new Dictionary<string, FooBar>();
var key = "doesnt exist";
var tmp = dictionary[key] ?? new FooBar(x, y); 
```

相反，我有以下选择：

```
var key = "doesnt exist";
FooBar tmp = null;
if (dictionary.ContainsKey(key))
{
    tmp = dictionary[key];
} else {
    tmp = new FooBar(x, y);
} 
```

或这个：

```
FooBar tmp = null;
if (!Dictionary.TryGetValue(key, out tmp))
{
    tmp = new FooBar(x, y);
} 
```

对我来说，这段代码非常冗长。是否有实现 IDictionary 的内置泛型类（或以其他方式允许键值类型访问）但在我尝试查找键时不抛出异常，而是返回 null？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T21:26:54.207

问题是它`Dictionary<TKey, TValue>`允许您*存储* `null`为一个值，因此您不知道该键是否不存在，或者只有一个`null`. 另一个问题是`null`它只对`TValue`引用类型（或`Nullable<T>`）有效。

现在，也就是说，您可以自己编写一个扩展方法来这样做：

```
public static class DictionaryUtilities
{
    public static TValue SafeGet<TKey, TValue>(this Dictionary<TKey, TValue> dict, TKey key, TValue defaultIfNotFound = default(TValue))
    {
        TValue value;

        return dict.TryGetValue(key, out value) ? value : defaultIfNotFound;
    }
} 
```

这样，您可以像这样查询您的字典：

```
var sample = new Dictionary<int, string> { {1, "One"}, {2, "Two}, {3, "Three"} };

var willBeNull = sample.SafeGet(4);

var willBeHi = sample.SafeGet(4, "HI!"); 
```

当然，如果`TValue`是值类型，上面的代码将返回值类型的默认值（也就是说，如果值类型是`int`，默认情况下它将返回`0`未找到。）

不过，您可以再次创建两种形式，一种`TValue`是受限的`class`，另一种`struct`是允许您返回`Nullable<T>`值类型的...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:30:55.817

对于泛型集合`null`并不总是有效值，您不能编写返回的泛型方法`null`。它必须是默认值（T）。

如果您确定不会将其用作*值，则可以轻松创建返回 default(T) 的实用程序方法*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T22:34:31.520

如果你扩展，那么你必须每次都传递一个默认值。
这可能是你想要的。
可以实现 Dictionary 并在 ctor 中传递一个默认值。

```
public class DictionaryWithDefault<T1,T2> : Dictionary<T1,T2>
{   
    private T2 t2Default;
    public new T2 this[T1 t1]
    {   // indexer - if the key is not present return the default
        get
        {
            T2 t2t;
            return TryGetValue(t1, out t2t) ? t2t : t2Default;
        }
        set {
            base[t1] = value;
        }
    }
    public DictionaryWithDefault(T2 _t2) { this.t2Default = _t2; }
} 
```

如果您希望 Dictionary 不允许 null 值，则覆盖 Add。

从 JamesMH +1 借用一些语法

我使用这样的东西的地方是带有复合键的字典。

如果您更改默认值，则会受到影响，然后它会更改 t2Default 值。
我正在努力。
如果 T2 是值类型，则此方法有效。
如果 T2 是引用类型，则需要进行深层复制，这不值得麻烦。

# c++ - 可以将类的成员命名为与其类型（另一个类）相同的名称吗？

> ID：12943607
> 
> 赞同：12
> 
> 时间：2012-10-17T21:22:24.807
> 
> 标签：c++, g++, implementation, clang, visual-c++-2012

尝试在不同的编译器上编译以下代码会给我两个不同的结果：

```
struct S{};
struct T{S S;};
int main(){} 
```

如您所见，在内部`T`，我有一个与之前定义的类同名的对象`S`。

* * *

在 GCC 4.7.2 上，[我收到以下](http://liveworkspace.org/code/6cd3eb7604aac15c7fc5c9005e3c561b)`S S;`与内部声明有关的错误`T`：

> 错误：'ST::S' [-fpermissive] 的声明
> 错误：从'struct S' [-fpermissive] 更改'S' 的含义

但是，将其移出类（或移入`main`）[可以正常工作](http://liveworkspace.org/code/7782c16e75dceb383e6af7361c0551cc)：

```
struct S{};
S S;
int main(){} 
```

它给我的错误到底是什么意思？

* * *

在 Visual Studio 2012 中，整个程序编译并运行，没有任何错误。将它粘贴到[这个 Clang 3.0 编译器](http://llvm.org/demo/)中也不会给我任何错误。

哪个是对的？我真的可以这样做吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-17T21:34:58.690

gcc 是正确的，来自 [3.3.7 Class Scope]

> 在 S 类中使用的名称 N 应在其上下文中引用相同的声明，并且在 S 的完整范围内重新评估时。违反此规则不需要诊断。

但是，请注意`no diagnostic is required`，因此所有编译器都符合要求。

原因在于类范围的工作方式。当你写的时候在**整个**类`S S;` `S`中是可见的，并且在你使用时改变了含义。**`S`**

 **```
struct S{};
struct T{
    void foo()
    { 
        S myS; // Not possible anymore because S refers to local S
    }
    S S;
}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-17T22:38:19.333

@JesseGood 提供了一个完整的答案，但如果你真的想这样做没有任何错误，你可以使用类型的全名，它的工作方式如下：

```
struct S {};
struct T { ::S S; };
int main() {return 0;} 
```

不，没有错误，因为`S`在您的课程中是`T::S`并且它的类型是`::S`！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-17T21:34:44.167

此代码格式错误，无需诊断。就像诊断所说的那样，如果声明使用了一个名称，并且该名称的含义与在类定义末尾查找时的含义不同，则程序是错误的，不需要诊断。**

# c# - 尝试构建gridview数据源

> ID：12943609
> 
> 赞同：0
> 
> 时间：2012-10-17T21:22:39.180
> 
> 标签：c#, asp.net, sql

所以我有一个视图（一个实际的数据库视图），其中包含我公司员工已完成的所有任务。每项任务都涉及在一段时间内做某事。所以它可以给盒子贴标签。我们有几个不同的重复任务，所以每天我们都会为任务创建一个记录。因此，您可以拥有 300 个盒子的标签盒。那将成为一个记录，明天将是一个新记录，如果您当天执行不同的任务，它将是另一个记录。有些人可能在一年中完成了 50 项不同的任务（因此每天最多 50 条记录），或者可能在一年中每周每周 40 小时完成相同的任务（因此每天一条记录）。

该计划将有一个网格视图，在一组中显示每项任务在一年内完成的速度。网格视图看起来像这样：

```
Person's Name | Task1 | Task2 | Task3 |...
Person 1      | 300   | 350   | 60    |...
Person 2      |...
... 
```

我的计划是只构建一个类，并在读取数据库后用人名和每个任务的总数初始化每个类，将其添加到类列表中，然后将其绑定到 gridview。但是，经理可以在需要时创建新任务，或者一个人可能不会拥有所有任务。用这个视图填充网格视图的简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:41:02.423

运行 SQL 选择语句，填充数据集并绑定到 gridview。

# php - APC 碎片的目标百分比限制

> ID：12943615
> 
> 赞同：0
> 
> 时间：2012-10-17T21:23:06.583
> 
> 标签：php, caching, apc

我已经看到系统运行良好，APC 报告碎片 < 10%。我知道碎片会增加性能下降，因为 APC 需要四处移动以寻找空间。

在您预期整体性能开始显着下降之前，是否有人对您应该将 APC 保持在以下的碎片百分比有一个很好的经验法则？

如果是这样，在这一点上，是性能逐渐线性下降到碎片化还是性能从悬崖上掉下来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T16:48:32.547

显然没有人知道......我已经广泛搜索，这是一个非常“模糊”的话题。我在任何地方都找不到与此相关的基准或测试。只是很多“哎呀，你不想要很多碎片”，而没有量化“很多”的含义。

我将坚持问题中列出的肠道百分比，大约 < 10%。

最终，我将运行一些基准测试来收集一些真实数据，看看我的猜测是否成立。如果我有时间做这些，我会把它们添加到这个答案中。

# javascript - 仅在特定 div 内执行 eval()？

> ID：12943617
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:23:09.680
> 
> 标签：javascript, jquery, html, eval

我尝试搜索，但没有找到任何有用的东西:(

我有一个可拖动的 div，我可以在其中拖动图像/标签和文本字段。为了在一个新的 div 中预览 div 的内容（不要问我为什么大声笑），我创建了一个名为“preview”的函数：

```
var myDraggableDiv = $('#div_draggable');

function preview()
{
var div = document.createElement('div');
div.id = 'div_preview';

$(div).html(myDraggableDiv.html()); // copy html
} 
```

所以，执行完函数后，我的预览 div 和可拖动 div 的内容是一样的。现在我需要在预览 div 中执行自定义 javascript。自定义 javascript 代码位于名为“customJS”的变量中。更新后的功能是：

```
function preview()
{
var div = document.createElement('div');
div.id = 'div_preview';

$(div).html(myDraggableDiv.html());
eval(customJS);
} 
```

主要问题是自定义 javascript 是全局执行的，也会影响可拖动的 div。我需要仅在预览 div 的元素内执行此自定义 javascript，很可能使用“eval”。

假设我的自定义脚本是：

```
var customJS = "$('img').hide();"; 
```

如果我运行 eval(customJS)，两个 div 中的所有图像都将隐藏。注意我的customJS变量中可以有任何有效的javascript代码......

有谁能够帮助我？如何将自定义脚本的执行限制为特定元素？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:26:29.567

不要使用`eval()`（对于大多数工作来说，它是错误的工具）。在这种情况下，函数会更好：

```
var customJS = function(parent) {
    $('img', parent).hide();
}; 
```

现在，您可以运行`customJS(div)`，选择器将相对于`div`元素。

顺便看看[`.clone()`](http://api.jquery.com/clone/)。它可能对您有用：

```
function preview() {
    var $clone = myDraggableDiv.clone();

    customJS($clone); // IMO, it would be nicer to
                      // just write your custom JS here.
} 
```

# hibernate - 休眠多对多映射 其中映射键是通过 FK 引用的属性

> ID：12943622
> 
> 赞同：4
> 
> 时间：2012-10-17T21:23:38.010
> 
> 标签：hibernate, many-to-many

我正在研究一个棘手的多对多映射，我希望在我的实体中将其表示为地图。问题是，我希望映射键是关联表之一的列，而不是映射表的列，这通常是这种情况。

Account 保存有关用户的基本信息，AccountMetadata 定义一个帐户可能具有的所有可能属性，Account_MetadataAccount 为每个可能的 AccountMetadata 定义一个特定帐户的值。

我已将这些映射到以下实体：

```
@Entity
@Table(name = "ACCOUNT")
public class Account implements Serializable
{
  @Id
  @Column(name = "ACCOUNT_ID")
  private Long accountId;

  @OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL, mappedBy = "pk.account")
  private Set<AccountMetadataAccount> metadata = new HashSet<AccountMetadataAccount>();
...
}

@Entity
@Table(name = "ACCOUNT_METADATA")
public class AccountMetadata implements Serializable
{
  @Id
  @Column(name = "ACCOUNT_METADATA_ID")
  private Long accountMetadataId;

  @Column(name = "KEY", unique = true)
  private String key;

  @Column(name = "TYPE")
  private Class<?> type;
...
}

@Entity
@Table(name = "ACCOUNT_METADATA_ACCOUNT")
@AssociationOverrides({
                @AssociationOverride(name = "pk.account",
                  joinColumns = @JoinColumn(name = "ACCOUNT_ID")),
                @AssociationOverride(name = "pk.metadata",
                  joinColumns = @JoinColumn(name = "ACCOUNT_METADATA_ID"))
              })
public class AccountMetadataAccount implements Serializable
{
  @EmbeddedId
  private AccountMetadataAccountId pk;

  @Column(name = "VALUE")
  private Serializable value;
...
}

@Embeddable
public class AccountMetadataAccountId implements Serializable
{
  @ManyToOne
  private AccountInfo account;

  @ManyToOne
  private AccountMetadataInfo metadata;
...
} 
```

这一切都很好。我的问题是帐户的元数据集。这并不理想。如果我有一个想要查找值的元数据键，我必须遍历整个 Set 直到找到正确的条目。在我们的系统中，可能有数百个。我认为一个`Map<String, AccountMetadataAccount>`或`Map<String, Serializable>`会更理想。但是，我希望映射键是 AccountMetadata 键。

我一直在尝试`@MapKeyColumn`，`@MapKeyJoinColumn`但没有运气。我只能找到映射键从连接表的列派生的示例。

我希望那里有人做过类似的事情，或者至少对如何实现这一点有一些智慧的话。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T06:58:36.893

使用 getter 和 setter 代替成员变量怎么样？像这样：

```
@Transient
private Map<String, AccountMetadataAccount> metadata = new HashMap<>();

@OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL, mappedBy = "pk.account")
private Collection<AccountMetadataAccount> getMetadata() {
  return metadata.values();
}

private void setMetadata(Collection<AccountMetadataAccount> metaSet) {
   metadata.clear();
   for (AccountMetadataAccount meta : metaSet) {
     metadata.put(meta.key, meta);
   }
} 
```

我使用 xml 映射文件而不是注释，而且我没有测试代码，所以它可能不是 100% 正确，但你应该明白这个想法。

# asp.net - 在 ASP.NET 中动态添加元素

> ID：12943623
> 
> 赞同：3
> 
> 时间：2012-10-17T21:23:42.960
> 
> 标签：asp.net, postback

看看这段代码：

```
 static int i = 0;
       protected void Page_Load(object sender, EventArgs e)
    {
        HtmlButton myButton;
        if (!Page.IsPostBack)
        {
            myButton = new HtmlButton();
            myButton.InnerText = "Button first load";
            myButton.ID = i.ToString();
            PlaceHolder1.Controls.Add(myButton);
            i++;
        }
        else
        {
            myButton = new HtmlButton();
            myButton.InnerText = "Button postback" + i.ToString();
            myButton.ID = i.ToString();
            PlaceHolder1.Controls.Add(myButton);
            i++;
        }
    } 
```

预期的：

```
 first load:  "Button first load"
       first postback: first load + "Button postback1"
       second postback: first postback + "Button postback2" ... and so on. 
```

有：

```
 "Button first load"
      "Button postback1"
      "Button postback2". 
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T21:32:25.243

你的预期结果真的是错误的...... :)

现在发生的事情正是你在代码中写的：

第一次加载（不是回发）：

```
 myButton.InnerText = "Button first load"; 
```

然后：

```
"Button first load" 
```

第 2、3、n 次加载（回发）：

```
 myButton.InnerText = "Button postback" + i.ToString(); 
```

然后：

```
"Button postback1"
"Button postback2"
.
.
. 
```

* * *

更新：

现在我明白了你的问题......

ASP.NET 不保留动态控件的状态，因此无法在回发后重新创建它们。

底线：***您必须在每次回发后重新创建动态添加的控件。***

这是我两年多前给出的答案，它向您展示了处理这种情况的好方法：

[https://stackoverflow.com/a/2982271/114029](https://stackoverflow.com/a/2982271/114029)

# css - 使用 LESS 变量作为 CSS 属性

> ID：12943628
> 
> 赞同：1
> 
> 时间：2012-10-17T21:23:57.120
> 
> 标签：css, variables, less, mixins

我有一个将 px 转换为 em 的 mixin：

```
.margin(@target: @targetsize, @basefont: @em){
    margin:(@target / @basefont) + 0em;} 
```

我想更改该 mixin，以便将 CSS 边距属性替换为变量。例如：

```
.pxtoem(@target: @targetsize, @basefont: @em, @property: @property){
@property:(@target / @basefont) + 0em; 
```

}

所以我可以这样称呼它，例如：

```
.pxtoem(2,1,margin-bottom); 
```

这可能吗，如果可以，怎么办？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T07:32:52.603

当时不是，但有一个[未解决的问题](https://github.com/cloudhead/less.js/issues/36)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T22:31:53.000

来自较少的文档：

参数 mixins 的参数也可以有默认值：

```
.border-radius (@radius: 5px) {
  border-radius: @radius;
  -moz-border-radius: @radius;
  -webkit-border-radius: @radius;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-11T16:30:38.380

在搜索相关内容时发现了这一点，并注意到它尚未更新。

从 Less 1.6.0[开始，属性现在支持变量插值](http://lesscss.org/features/#variables-feature-properties)。

```
.setProp(@prop,@val) {
  @{prop}:@val
}

.foo {
  .setProp(opacity,0.75);
} 
```

# java - 嵌套尝试捕获

> ID：12943629
> 
> 赞同：1
> 
> 时间：2012-10-17T21:24:01.667
> 
> 标签：java, nested, try-catch

我对java很陌生，我已经嵌套了打印3次的Try Catch代码！你能告诉我为什么吗？我从命令行获得 3 个 int 并且必须进行验证并检查它们是否在范围内，并且我正在使用 try and catch。但答案打印了 3 次！

```
// Global Constants
final static int MIN_NUMBER = 1;
final static int MAX_PRIME = 10000;
final static int MAX_FACTORIAL = 12;
final static int MAX_LEAPYEAR = 4000;

// Global Variable
static int a, b, c;

public static void main(String[] args) {
    // String[] myNumbers= new String [3];

    // int x =Integer.parseInt(args[0]);
    for (int i = 0; i < args.length; i++) {
        // System.out.print(args[i]+" ");
        validateInput(args[0], args[1], args[2]);

    }
}

// Validate User Input
public static boolean validateInput(String value1, String value2, String value3) {
    boolean isValid = false;

    try {
        try {
            try {
                a = Integer.parseInt(value1);
                if (!withinRange(a, MIN_NUMBER, MAX_PRIME)) {
                    System.out.println(
                            "The entered value " + value1
                            + " is out of range [1 TO 10000].");
                }
                isValid = true;         

            } catch (Exception ex) { 
                System.out.println(
                        "The entered value " + value1
                        + " is not a valid integer.  Please try again.");
            }   

            b = Integer.parseInt(value2);
            if (!withinRange(b, MIN_NUMBER, MAX_FACTORIAL)) {
                System.out.println(
                        "The entered value " + value2
                        + " is out of range [1 TO 12].");
            }
            isValid = true; 
        } catch (Exception ex) { 
            System.out.println(
                    "The entered value " + value2
                    + " is not a valid integer.  Please try again.");
        }

        c = Integer.parseInt(value3);
        if (!withinRange(c, MIN_NUMBER, MAX_LEAPYEAR)) {
            System.out.println(
                    "The entered value " + value3
                    + " is out of range [1 TO 4000].");
        }
        isValid = true; 
    } catch (Exception ex) { 
        System.out.println(
                "The entered value " + value3
                + " is not a valid integer.  Please try again.");
    }   

    return isValid;

}

// Check the value within the specified range
private static boolean withinRange(int value, int min, int max) {
    boolean isInRange = true; 

    if (value < min || value > max) {
        isInRange = false; 
    }
    return isInRange;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:29:44.107

答案打印了 3 次，因为您已将 validateInput 方法调用放入`for`循环中`main()`，如果有三个参数，它将运行它三次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:31:21.630

我建议编写`validateInput`验证*单个*字符串的方法。为最小和最大允许的 int 值添加两个参数。

```
public static boolean validateInput(String value, int minValue, int maxValue) {
    try {
        integer intVal = Integer.parseInt(value);
        if (intVal < minVal || intVal > maxValue) {
            System.out.println("The entered value " + value
                + " is out of range [" + minValue + " TO " + maxValue + "].");

            return false;
        }
    } catch (Exception e) {
        System.out.println("The entered value " + value
            + " is not a valid integer. Please try again");
        return false;
    }
    return true;
} 
```

# php - db.sql 到本地主机

> ID：12943630
> 
> 赞同：0
> 
> 时间：2012-10-17T21:24:07.400
> 
> 标签：php, sql

我无法将我的 db sql 导入本地主机。请帮忙。

导入数据库后，会发生这种情况：

SQL查询：

```
CREATE TABLE IF NOT EXISTS  `admins` (
    `id` SMALLINT( 5 ) NOT NULL AUTO_INCREMENT ,
    `username` VARCHAR( 50 ) NOT NULL DEFAULT  '',
    `password` VARCHAR( 32 ) NOT NULL DEFAULT  '',
    `email` VARCHAR( 100 ) NOT NULL DEFAULT  '',
    `firstname` VARCHAR( 50 ) NOT NULL DEFAULT  '',
    `lastname` VARCHAR( 50 ) NOT NULL DEFAULT  '',
    `datereg` INT( 11 ) UNSIGNED NOT NULL DEFAULT  '0',
    `lastlogin` INT( 11 ) UNSIGNED NOT NULL DEFAULT  '0',
    PRIMARY KEY (  `id` ) ,
    KEY  `username` (  `username` ) ,
    KEY  `password` (  `password` )
) ENGINE = MYISAM DEFAULT CHARSET = latin1 AUTO_INCREMENT =14; 
```

MySQL 说：

```
#1046 - No database selected 
```

请告诉我该怎么办！

这是我的代码：

```
$cfg['db_host']  = 'localhost';
$cfg['db_uname'] = 'root';
$cfg['db_pword'] = '';
$cfg['db_name']  = 'artofmine'; 
```

请告诉我要改变什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:39:18.173

跑

```
use artofmine; 
```

在运行 create 语句之前，在 mysql gui 或命令行中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T22:03:35.313

MySQL 不知道您想在哪个数据库中工作。

用 SQL 编写（在查询之前）：

```
USE artofmine; 
```

或在 PHP 中连接后指定数据库。例子：

```
<?php

// connect - make link
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Not connected : ' . mysql_error());
}

// select database for that link
$db_selected = mysql_select_db('artofmine', $link);
if (!$db_selected) {
    die ('Can\'t use foo : ' . mysql_error());
}

?> 
```

# django - linux用户权限运行Web应用程序的最佳实践？

> ID：12943633
> 
> 赞同：9
> 
> 时间：2012-10-17T21:24:13.023
> 
> 标签：django, permissions, nginx, uwsgi

我在网上看到了很多不同的建议，比如从哪里为您的 Web 应用程序提供服务、以什么用户身份运行它等等。

例如，我看到它从以下位置提供服务：/var/www/site、/srv/www/site、/home/$USER/site。

我已经看到用户是 www-data、$USER（即我的用户帐户）或专门为此目的创建的自定义用户（例如用户 uwsgi）。

在安全性方面，我可以选择的最佳方案是什么？

作为参考，我正在尝试使用 Nginx 和 uwsgi 部署一个 Django 站点。

现在，uwsgi 以 root 身份运行在 Emperor 模式下，uid/gid 设置为 www-data，因此 vassal 与 Nginx worker 具有相同的权限。我在 /home 服务，但正在考虑搬家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T22:10:53.417

对于位置，选择最适合您的位置。以下是一些可以提供帮助的注意事项：

*   下面的位置用于[大小变化](http://linux.die.net/man/7/hier)`/var`的文件，或者通常是“可变的”。
*   `/srv`通常表示与机器上运行的某些服务相关的文件。
*   `/home`通常应该为交互式用户保留。不过，您可以将系统用户的主目录设置为任何内容。

为了安全起见，您应该尽可能地分段。该应用程序不应以与 Web 服务器相同的用户身份运行，这样它就不会被滥用来读取与服务器本身（`.htaccess`或其他）相关的敏感文件。应用程序的二进制文件（或者对于 Django，python 源）应该由 root 拥有，对应用程序用户没有写入权限。

这是我关于如何设置它的 2 美分：

*   Django 应用程序：`/usr/lib/appname/`或者`/usr/lib/python/site-packages/appname/`如果已安装。由 root 拥有，chmod 644。
*   应用程序的文件（例如 sqlite db 文件、用于 FastCGI 的 Unix 套接字、上传的文件存储等）：`/var/lib/appname/`. 由应用用户 chmod 600 拥有。
*   app-user 的 shell 是`/bin/nologin`， home 是`/var/lib/appname/`。用户没有配置密码。

# asp.net - 按属性名称的字母顺序对 XML 节点进行排序

> ID：12943635
> 
> 赞同：0
> 
> 时间：2012-10-17T21:24:20.060
> 
> 标签：asp.net, xml, sorting

我有一个 XML 文档，我想按字母顺序对特定节点进行排序。

**XML 文档**

```
<response>
    <lst name="facet_counts">
        <lst name="facet_fields">
            <lst name="professions_raw_nl">
                <int name="Pharmacy">2724</int>
                <int name="Physiotherapy">2474</int>
                <int name="Doctor">2246</int>
                <int name="Dentist">1309</int>
            </lst>  
        </lst>
    </lst>
</response> 
```

**期望输出**
牙医 (1309)
医生 (2246)
药房 (2724)
物理治疗 (2474)

**当前的 ASP.NET 代码**

```
dim node as XmlNode = objXML.SelectSingleNode("response/lst[@name=""facet_counts""]/lst[@name=""facet_fields""]/lst[@name=""professions_raw_nl""]")
Dim sbuilder As New StringBuilder
Dim navigator As XPathNavigator = node.CreateNavigator()
Dim selectExpression As XPathExpression = navigator.Compile("???") <-- what expression should I use here ???
selectExpression.AddSort("????", XmlSortOrder.Ascending, XmlCaseOrder.None, "", XmlDataType.Text) <-- what expression should I use here ????
Dim nodeIterator As XPathNodeIterator = navigator.Select(selectExpression)
While nodeIterator.MoveNext()
    'how can I print the name and value of the node?
End While 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:31:48.760

如果您使用的是 .Net>=3.5，那么您可以像这样使用 linq 为您执行此操作

```
var xmlString = "YOUR XML STRING";
var doc = XDocument.Parse(xmlString);

var list = doc. Descendants("int").select(n=>new {Name = n.Attribute("name").Value, Value = n.Value});
var sortedList = list.OrderBy(l=>l.Name); 
```

编辑不是 VB 中的专业人士，但试试这个 - 请在这里可能存在语法错误

```
dim xmlString as string
xmlString = "YOUR XML STRING"
dim doc as XDocument()
doc = XDocument.Parse(xmlString)
dim list = doc.Descendants("int").select(n=>new {Name = n.Attribute("name").Value, Value = n.Value}).OrderBy(l=>l.Name) 
```

LINQ 代表语言集成查询。它比您当前使用的东西更容易和统一。您可以[在此处阅读更多信息](http://msdn.microsoft.com/en-us/library/bb397926.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:41:37.917

我尝试了以下代码并且它正在工作（C＃）您可以获得如下值

```
 var doc = new XmlDocument();
        doc.Load("c:\\users\\ozgur\\sample.xml");
        var nav = doc.CreateNavigator();
        var node = nav.SelectSingleNode("response").SelectSingleNode("lst[@name=\"facet_counts\"]").SelectSingleNode("lst[@name=\"facet_fields\"]").SelectSingleNode("lst[@name=\"professions_raw_nl\"]").Select("int");

        var sorted = new SortedDictionary<string, string>();
        while (node.MoveNext())
        {
            var name = node.Current.SelectSingleNode("@name").Value;
            var value = node.Current.Value;
            sorted.Add(name, value);
        }

        foreach (var item in sorted)
        {
            item.Key.ToString();
            item.Value.ToString();
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T11:29:38.727

由于所有答案似乎都适用于 Linq，而我只想使用常规 VB.NET，因此我现在将每个节点添加到 Arraylist 中，并在其上使用常规 Array.Sort()。行得通。

# java - 拉力赛：Java Rest Api：返回结果的限制？

> ID：12943640
> 
> 赞同：5
> 
> 时间：2012-10-17T21:24:58.467
> 
> 标签：java, api, rest, rally

返回结果的数量/大小是否有限制？例如，我查询了所有缺陷并返回了 185，而实际数量在 600 以上。有没有办法可以检测查询是否无法获得所有结果？

编辑：看起来我达到了 200 的页面限制大小。有谁知道如何制作一个循环来获得下一组结果？

这是我的代码：

```
 String rallyProjectOid = getRallyProjectOid(rallyApi, rallyProjectName);
    // Get the list of Rally defects for the project
    QueryRequest defectRequest = new QueryRequest("defect");
    defectRequest.setFetch(new Fetch("Project", "LastUpdateDate", "FormattedId", "SubmittedBy", "Owner"));
    defectRequest.setProject(rallyProjectOid);
    defectRequest.setQueryFilter(new QueryFilter("LastUpdateDate", ">", timestamp));
    QueryResponse projectDefects = rallyApi.query(defectRequest); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T16:57:21.587

虽然设置：

`queryRequest.setLimit(Integer.MAX_VALUE);`

确实照顾许多类型，它不适用于所有类型。

例如，类型*Defect*和*Iteration*似乎在单个页面中返回数千个结果（对 Rally 的单个查询调用），而其他类型（例如*User*和*HierarchicalRequirement* ）忽略了该限制，而是迫使我使用分页（设置 Start然后重新查询）以获取所有结果。

这是我如何处理两者的示例：

```
// NOTE : no pagination needed for defect or iteration, but required for hierarchicalrequirement or user
QueryRequest queryRequest = new QueryRequest("hierarchicalrequirement");

queryRequest.setFetch(new Fetch(new String[] {"ObjectID", "CreationDate", "LastUpdateDate", "FormattedId"}));
queryRequest.setQueryFilter(new QueryFilter("CreationDate", ">=", "2013-01-01T07:00:00.000Z"));
queryRequest.setLimit(Integer.MAX_VALUE);

int responseTotalResultsCount = Integer.MAX_VALUE;// So we enter while loop first time
int actualResultsProcessedSoFar = 0;

// Handle both cases
while ((queryRequest.getStart()) < responseTotalResultsCount && actualResultsProcessedSoFar < responseTotalResultsCount) {

    QueryResponse queryResponse = restApi.query(queryRequest);

    responseTotalResultsCount = queryResponse.getTotalResultCount();// Set to correct value here

    JsonArray results = queryResponse.getResults();

    if (results.size() == 0) {
        return;
    } else {

        for (JsonElement jsonElement : queryResponse.getResults()) {

            // Process this particular JsonElement here

            // If no pagination required, this counter lets us exit while loop
            actualResultsProcessedSoFar++;

        }// end for loop

    }// end if (results.size() == 0)

    // Setting this to handle pagination, if required
    queryRequest.setStart(queryRequest.getStart() + queryRequest.getPageSize());

} // end while loop 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T22:23:59.383

QueryRequest 上有一个 setLimit() 方法，允许您设置从请求返回的最大记录数。如果未为请求对象指定此值，则行为将仅返回一页数据（200 条记录）。

所以如果你这样做：

```
 int queryLimit = 4000;
   defectRequest.setLimit(queryLimit); 
```

RestApi 应该返回大量结果，并自动为您分页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-24T16:00:54.163

截至 2019 年，他们将其限制为 2000 个结果，无论您设置多少限制。没有这方面的文档。我通过测试和设置页面以及最大数量发现了这一点。

这适用于 Java API。

# javascript - 如何嵌套 jquery.when 调用

> ID：12943645
> 
> 赞同：1
> 
> 时间：2012-10-17T21:25:20.257
> 
> 标签：javascript, ajax, jquery, asynchronous

我有一个加载报告部分的功能。

```
// function to load section 
function loadSection(sectionId) {

    $.when(

        // Now load the specified template into the $overlay.
        loadTemplate(sectionId),

        // After the template is in place we need to identify all
        // the editable areas and load their content.
        loadEditables(sectionId)

    )
    .then(function () {

        // Now find all section link elements and wire them up.
        buildSectionLinks(),

        // Find all hover elements and attach the hover handlers.
        loadHovers()

    });

} 
```

我们的想法是我们将加载一个模板，然后遍历模板以找到所有“可编辑项”，它们只是模板中用户提供的内容区域。一旦加载了模板和所有可编辑项，我们就会对标记进行一些处理，以将点击事件与某些元素联系起来。所有模板和可编辑的 ajax 调用都需要在处理发生之前完成。

调用`loadTemplate(sectionId)`工作得很好，`jQuery.when`因为我只做一个 ajax 调用。

```
// This function goes out to an AJAX endpoint and gets the specified
// report template and appends it to the overlay DIV.
function loadTemplate(sectionId) {
    return $.ajax({
        url: settings.templateUrl,
        data: { sectionId: sectionId },
        type: 'post',
        success: function (template) {
            $overlay.append(template);
        }
    });
} 
```

该`loadEditables(sectionId)`功能实现起来并不简单，因为我必须遍历所有可编辑项并为每个可编辑项执行 ajax 调用。

```
// This function loads content for all editables defined in the template.
function loadEditables(sectionId) {
    // Grab all editables into a jQuery wrapped set.
    var $editables = $('#template .editable');

    // Loop through each editable and make an AJAX call to load its content.
    $editables.each(function () {
        var $editable = $(this);

        $.ajax({
            type: 'post',
            url: settings.editableUrl,
            data: {
                sectionId: sectionId,
                editableIndex: $editable.data('editableindex')
            },
            success: function (editable) {
                if (editable.hasData)
                    $editable.html(editable.content);
            }
        });
    });
} 
```

在`loadTemplate`我能够简单地`return $.ajax(...)`在函数中满足`$.when(...)`. 在这里，我遍历包装的集合并为集合中的每个元素执行新的 ajax 调用。如何确保在触发处理函数（`buildSectionLinks()`和`loadHovers()`）之前完成所有这些调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:29:25.980

将 promise 对象存储在一个数组中，然后将该数组传递给`$.when`using`.apply`

```
function loadEditables(sectionId) {
    // Grab all editables into a jQuery wrapped set.
    var $editables = $('#template .editable'),
        defArr = [];

    // Loop through each editable and make an AJAX call to load its content.
    $editables.each(function () {
        var $editable = $(this);

        defArr.push($.ajax({
            type: 'post',
            url: settings.editableUrl,
            data: {
                sectionId: sectionId,
                editableIndex: $editable.data('editableindex')
            },
            success: function (editable) {
                if (editable.hasData)
                    $editable.html(editable.content);
            }
        }));
    });
    return $.when.apply($,defArr);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T21:29:56.913

您需要将每个`.promise`对象写入一个数组并返回该数组。在函数之外，您可以调用`.when() with`.apply()` 来正确调用它。

```
function loadEditables(sectionId) {
// Grab all editables into a jQuery wrapped set.
    var $editables = $('#template .editable'),
        promises = [ ];

    // Loop through each editable and make an AJAX call to load its content.
    $editables.each(function () {
        var $editable = $(this);

        promises.push($.ajax({
            type: 'post',
            url: settings.editableUrl,
            data: {
                sectionId: sectionId,
                editableIndex: $editable.data('editableindex')
            },
            success: function (editable) {
                if (editable.hasData)
                    $editable.html(editable.content);
            }
        }));
    });

    return promises;
} 
```

然后我们像

```
$.when.apply( null, loadEditables() ).done(function() {
}); 
```

# list - 列表 修改 ObservableCollection 当列表 索引项已更改

> ID：12943654
> 
> 赞同：1
> 
> 时间：2012-10-17T21:25:44.083
> 
> 标签：list, observablecollection

我找到了解决我的问题的方法，但我想知道是否有人可以解释为什么会发生这种情况。

我有一个类DataCollector。

```
public class DataCollector
{
    public string Name { get; set; }

    public string Group { get; set; }

    public int Count { get; set; }

    public Brush Color { get; private set; }

    public DataCollector(string name, string group, int count, Brush color)
    {
        Name = name;
        Group = group;
        Count = count;
        Color = color;
    }
} 
```

在我的代码中，我有一个 DataCollector 的 ObservableCollection。

```
public ObservableCollection<DataCollector> dataGrid { get; set; } 
```

我收集我的数据并很好地使用它，直到我去向代码添加更多功能。

我想通过“dataGrid”并列出组并从所有名称中获取总数。

```
List<DataCollector> dataCollector = new List<DataCollector>();
List<string> _groupNames = new List<string>();

foreach (DataCollector dc in dataGrid)
{
    int cnt = 0, index = 0;
    bool groupFound = false;

if (dataCollector.Count == 0)
{
    _groupNames.Add(dc.Group);
    dataCollector.Add(dc));
}
else
{
    foreach (string groupNames in _groupNames)
    {
        if (groupNames == dc.Group)
        {
            index = cnt;
            nameFound = true;
        }

        cnt++;
    }

    if (nameFound)
    {
        // When I do this my dataGrid.Count increments, too
        dataCollector[index].Count += dc.Count;
    }
    else
    {
        _groupNames.Add(dc.Group);
        dataCollector.Add(dc);
    }
}
} 
```

为了解决这个问题，我改变了

```
dataCollector.Add(dc); 
```

到

```
dataCollector.Add(new DataCollector(dc.Name, dc.Group, dc.Count, dc.Color)); 
```

为什么我必须这样做？将“dc”添加到“dataCollector”是否会创建指向“dataGrid”的链接？如果是这样，那就没有意义了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:29:48.010

您这样做是因为`dataCollector.Add(dc)`将引用复制到对象的内存位置。因此，该位置数据的更改会反映在任一集合中，因为它们持有指向相同对象的指针。您可以做的是模仿复制构造函数。

```
public DataCollector(DataCollector dataCollector)
{
  Name = dataCollector.Name;
  Group = dc.Group;
 //...
} 
```

它可以让你的代码保持干净。

# java - 在 SOAP 响应中发送 XML 字符串

> ID：12943662
> 
> 赞同：0
> 
> 时间：2012-10-17T21:26:19.833
> 
> 标签：java, jax-ws

我们有一些使用 JAX WS 框架构建的 Web 服务。这些方法将 Java 对象作为输入并返回 Java 对象，这些 Java 对象又由框架转换为 XML。

现在我有了一个新的用例，我有需要返回给客户端的实际 XML。如何将其放入 SOAP 响应中。此外，调用客户端应该仍然能够将此响应转换为 Java 对象而不会产生任何影响。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:52:17.947

只需在 SOAP 接口中返回一个 String 对象。作为返回值，您可以将 XML 作为字符串返回，然后客户端可以以任何方式使用 XML。

如果客户端想要一个 XML 的 Java 对象，它当然可以使用类似这样的东西来处理它：

```
String responseXml = WebServiceStuff.getXmlFromWebservice(); // this is your webservice
try
{
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    // factory.setNamespaceAware( true ); // if you need it
    // factory.setValidating( true ); // if you need it
    DocumentBuilder builder  = factory.newDocumentBuilder();
    Document document = builder.parse(responseXml);
    Node rootNode = document.getDocumentElement();
    // do something more with the XMLDocument
} 
catch (Exception e)
{
    // handle exception that happend while building the DOM
} 
```

# jpa - jpa 平均（计数（*））

> ID：12943665
> 
> 赞同：2
> 
> 时间：2012-10-17T21:26:27.353
> 
> 标签：jpa, count, average

假设我有三个表用户、产品和用户产品。一旦用户购买了产品，就会在 UserProduct 表中创建一条记录。我想计算用户购买的平均产品数量。我可以在 mySql RDBMS 上使用纯 SQL 来执行此操作，如下所示：

```
select avg(c) from (select count(*) as c from user_product up join user u on (up.user_id = u.id) group by u.id) as res 
```

我有机会用 JPA 做同样的事情吗？

更新：我知道子查询只能在 WHERE 或 HAVING 子句中使用，但仍然......

# ruby-on-rails - 更新方法“没有路由匹配 [POST]”

> ID：12943670
> 
> 赞同：3
> 
> 时间：2012-10-17T21:26:37.747
> 
> 标签：ruby-on-rails, ruby, post, put

下面的 ruby​​ on rails 代码片段有点麻烦 - 我有书，想更新书名，这是我尝试做的方法：

```
<h1>Edit the book "<%= @book.name %>"</h1>
<%= form_tag action: :update, id: @book do %>
    <p>
        <label for="book_name">Name</label>
        <%= text_field :book, :name %>
        <%= submit_tag 'Save changes' %>
    </p>
<% end %> 
```

这就是我在书籍控制器中所做的：

```
def edit
    @book = Book.find(params[:id])
end

def update
    @book = Book.find(params[:id])
    if @book.update_attributes(params[:book])
        redirect_to :action => 'show', id => @book
    else
        @subjects = Subject.find(:all)
        render :action => 'edit'
    end
end 
```

这些是我的路线：

```
root to: 'authors#index'
resources :books, :authors 
```

当我单击表单中的提交按钮时，它给我`No route matches [POST] "/books/5"`并指向 localhost:3000/books/5 而不是停留和 localhost:3000/books/5/edit

我在这里做错了什么？不应该有一个 put 方法来更新某处的东西而不是 post 方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:32:25.280

更新应该使用 put 而不是 post。

```
<%= form_tag( { :controller => :books, :action => :update, :id => @book.id }, { :method => :put } ) do %> 
```

或者更好的是使用 form_for

```
 <%= form_for @book do |f| %> 
```

在您的控制台上运行“rake routes”，它将打印出所有可用的路线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:30:25.050

请试试这个：

我们需要在路由文件中指定匹配。

```
match "/books/:id" => "books#update" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T21:47:57.880

`resources :books`应该做的工作。您不必明确使用“匹配”。

```
def edit
  @book = Book.find(params[:id])
end 
```

表单.html

```
form_for @book, :method => :put do |f|

def update
@book = Book.find(params[:id])
@book.update_attributes(params[:book])
end 
```

这应该可以完成这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-26T01:46:09.560

我以前有这个问题。一切都是正确的，但仍然出现错误，然后我发现它是

```
gem 'rails-api' 
```

删除它，一切正常。

# ios - iOS iTunes 应用程序图标

> ID：12943671
> 
> 赞同：0
> 
> 时间：2012-10-17T21:26:38.870
> 
> 标签：ios, icons, itunes, itunesartwork

在准备分发时，我对如何使用 iTunes 应用程序图标有点困惑。我知道它必须是 512 x 512。但我没有得到的部分是它必须没有扩展名？我提取了几个应用程序，他们的 iTunesArtwork 是一个 unix 可执行文件。在他们网站的 iTunes 图标示例代码中，对于类型，它只是说默认数据。如何将我的 iTunesArtwork 添加到我的项目中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:28:09.647

512x512（或更好的 1024x1024，我认为这是新 iPad 介绍的最新要求）图标文件应为 PNG 文件。

不要担心从二进制文件中提取文件时看到的内容。图标文件可以通过浏览器上传，PNG 就可以了。

# backbone.js - 保护 Play 的 REST API

> ID：12943672
> 
> 赞同：4
> 
> 时间：2012-10-17T21:26:41.147
> 
> 标签：backbone.js, playframework, playframework-2.0

我正在尝试将`Play 2.x`with`backbone.js`用于一个项目。我的目的是在服务器端创建 RESTful API（所有响应主体都在 JSON 中，所有请求主体也在 JSON 中）。

我想使用 Facebook OAuth（服务器端）来验证我的请求。为此，我将[play-authorize](https://github.com/joscha/play-authenticate/)用于 OAuth。我遇到的问题是用户会话信息存储在 Play 中的会话对象中。我真的不想在我的 HTML 代码中使用播放模板，如何在没有播放模板的情况下在客户端使用会话对象。

另外，在使用 Play 时，我可以使用哪些措施来防止 CSRF/XSS 攻击。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T11:24:11.937

也许我误解了你的问题，但请注意 Play 是无国籍的。这意味着“会话”存储在发送到服务器的 cookie 中。您可以将字符串值存储到该 cookie 并从浏览器访问它们。

现在，您不想在其中存储关键值，而是服务器端代码可以识别并让您使用来解决问题的东西。

# javascript - 如何使用 javascript/jquery 添加动态选项？

> ID：12943673
> 
> 赞同：0
> 
> 时间：2012-10-17T21:26:42.273
> 
> 标签：javascript, jquery

我有一个 gsp 页面，上面有一个 ' `<g:select>`' 元素：

```
<label class="control-label">Applicable Offices:</label>
<span class="span6">
    <select name="data.OfficeId" class="required j-office-select" style="height:26px;padding:1px;">
        <option value="0">Select an office...</option>
    </select>
</span> 
```

我必须使用 JavaScript 为这个选择**动态添加更多“选项” 。**我的 JavaScript 部分如下所示：

```
$.ajax({
    url: epcm.urlManager.getUrl({controller: 'controllerName', action:'methodName'}),
    cache: false,
    contentType: "application/json",
    type: "POST",
    dataType: "json",
    data: JSON.stringify(params),
    success: function(officeData) {
        var selectOffice = dialog.find('.j-office-select');
        selectOffice.empty();
        // OfficeData is a list . For each officeData , I need to add an option to the’ select’, but ways I tried did not work.I need to know the proper use of $.each and how can I use that in this context
        selectOffice.append('<option value="'+officeData.id+'">'+officeData.regionName+'</option>' );
        selectOffice.removeAttr('disabled');
        window.location.reload();
    }
}); 
```

“成功”中的“OfficeData”是一个列表。对于**每个 officeData**，我需要为上述“选择”添加一个选项，但我尝试的方法不起作用。我需要有关正确使用`$.each`以及如何在这种情况下使用它的帮助。任何人都可以帮忙吗？上面的例子只添加了第一个，而没有添加所有其他的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:36:03.897

应该是这样的：

```
$.each(officeData, function(index, item){
   selectOffice.append('<option value="'+item.id+'">'+item.regionName+'</option>' );
} ); 
```

但是，在您的示例中，officeData 似乎不是一个集合，因为 officeData.id 和 officeData.regionName 没有嵌套在项目中。您可以使用`console.log(officeData);`将数据结构输出到浏览器控制台（假设您使用的是 Chrome 或 FireFox+devtools 之类的东西）。

# jquery - 在 Jquery 中显示/隐藏 div 问题

> ID：12943674
> 
> 赞同：1
> 
> 时间：2012-10-17T21:26:46.017
> 
> 标签：jquery, show-hide

我从另一个网站复制了 Jquery 代码，“Link one”工作正常。当我按下它时，会出现一个弹出 div，当我在 div 之外单击它时它就消失了（这很好）。但是“链接二和三弹出 div”没有正确出现/消失。你能增强代码吗？请查看下面的链接（到目前为止我所做的）

[http://jsfiddle.net/awaises/SNCtu/](http://jsfiddle.net/awaises/SNCtu/)

另外请确保，即使我按“链接二”或“链接三”，一次也只出现一个 div</p>

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:41:35.453

试试这个代码

```
$(function() {
    $('#hidden1').hide().click(function(e) {
        e.stopPropagation();
    });
    $("a[class^='cart-buttom']").click(function(e) {
        var $cls = $(this).data('class');
        $("[id^='hidden']").not('#' + $cls).fadeOut();
        $('#' + $cls).animate({
            opacity: "toggle"
        });
        $("#shopping-cart").animate({
            "height": "toggle"
        }, {
            duration: 550
        });
        e.stopPropagation();
    });

    $(document).click(function() {
        $('#hidden1').fadeOut();
        $('#hidden2').fadeOut();
        $('#hidden3').fadeOut();
    });
}); 
```

我已经向存储相应 div id 的锚点添加了一个数据属性

[检查演示](http://jsfiddle.net/sushanth009/SNCtu/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:45:04.760

**试试这个更短的演示** [http://jsfiddle.net/vERmV/](http://jsfiddle.net/vERmV/)

休息希望它适合原因`:)`

**代码**

```
$(function() {
    $('#hidden1,#hidden2,#hidden3').hide().click(function(e) {
        e.stopPropagation();
    });
    $(".cart-buttom1,.cart-buttom2,.cart-buttom3").click(function(e) {

        var id = $(this).attr('class').replace(/cart-buttom/, '');

        $('.popup').hide()
        $('#hidden' + id).animate({
            opacity: "toggle"
        });

        e.stopPropagation();
    });

    $(document).click(function() {
        $('#hidden1,#hidden2,#hidden3').fadeOut();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:47:17.827

这是您正在寻找的更简单的演示。

演示：http: [//jsfiddle.net/5NEu3/273](http://jsfiddle.net/5NEu3/273)

[http://jsfiddle.net/5NEu3/276/](http://jsfiddle.net/5NEu3/276/)

```
<div id="nav">
    <a href="#content1">Show content 1</a>
    <a href="#content2">Show content 2</a>
    <a href="#content3">Show content 3</a>
</div>

<div id="content1" class="toggle" style="display:none">show the stuff1</div>
<div id="content2" class="toggle" style="display:none">show the stuff2</div>
<div id="content3" class="toggle" style="display:none">show the stuff3</div>

//In Document.Ready
$("#nav a").click(function(e){
    e.preventDefault();
    $(".toggle").fadeOut();
    var toShow = $(this).attr('href');
    $(toShow).fadeIn();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:31:47.227

当您使用 -> $("a.cart-buttom").click 将 click 事件绑定到类 cart-buttom 的标签时，您只需将指定的事件（如您解释的那样出现/消失）仅提供给类购物车-buttom，但不是 cart-buttom2 或 cart-buttom3。

因此，您可以从这个解释中猜到 html 中类的标识符，具有任何字符作为后缀将变成一个完全不同的类。为了也为它们绑定点击事件，您可以分别为 cart-buttom2 和 cart-buttom3 类定义不同的点击事件。当然有更明智的方法来做这样的事情。

# sql - 带表的 SQL 访问

> ID：12943678
> 
> 赞同：1
> 
> 时间：2012-10-17T21:27:08.697
> 
> 标签：sql, database, database-design

它不会让我上传图片，但列是 OrderID、CustomerName、CustomerAddress、ProductNumber、SellDate、ProductDescription

我正在尝试自学 SQL。有人可以帮我确定一些事情吗？

1) 我想写一个 SQL 语句来检索下订单的客户的客户姓名和地址 7。

这是正确的吗？

```
Select CustomerName, Address
From Order 
Where OrderID = ‘7’ 
```

2）接下来我想写一个SQL语句，将一个新的订单添加到Order表中。

这是正确的吗？

```
INSERT INTO order(OrderID, CustomerName, CustomerAddress, ProductNumber, SellDate, ProductDescription) 
VALUES (8, 'Ben C', '12 Kents Road', 01/15/2012, Clay :)); 
```

3) 这个数据模型有什么问题，你将如何重新设计它？我在这里真的需要帮助。需要排序吗？我如何描述一个新的高级设计？

4) 我如何将这些数据从旧模型移动到新模型？

5）使用新的数据模型，我需要编写一个 JOIN 来检索下订单的客户的客户姓名和地址 7\. 我还没有到这里，因为我不确定为什么旧的数据模型不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:15:06.980

首先，你需要回答一个问题：

*   客户可以下多个订单吗？如果您的回答是“是”，您想要一份客户目录吗？

在这种情况下，您需要规范化您的数据库。首先，您需要将数据分成逻辑集；在这种情况下，客户、产品和订单......我假设一个订单可以有一个或多个产品。

然后，设计你的表（我将使用 MySQL 风格的代码）：

您的客户目录：

```
create table tbl_customers (
    customerId int not null primary key,
    customerName varchar(100),
    customerAdress varchar(200)
); 
```

您的产品目录：

```
create table tbl_products (
    productNumber int not null primary key,
    productName varchar(100),
); 
```

您的订单目录：

```
create table tbl_orders (
    orderId int not null primary key,
    orderDate date,
    customerId int unsigned not null
); 
```

对于每个订单，您需要知道您将订购的产品的“单位”数量：

```
create table tbl_orders_products (
    orderProductId int not null primary key,
    orderId int not null,
    productNumber int not null,
    units int,
); 
```

在此之后，您将使用您的数据填充您的表，然后您可以执行任何适合您的查询。

几点注意事项：

*   `tbl_orders`与`tbl_customers`……您的客户的数据必须`tbl_customers`在他可以下订单之前插入。
*   在插入订单详细信息之前，您需要创建订单
*   在您插入订单的详细信息之前，您需要填写`tbl_products`

这只是解决它的一种方法。

希望这可以帮助你

* * *

现在，如果你想迁移到这个模型，你需要做一些工作：

1.  填充您的产品目录：`insert into tbl_products values (1,'productA'), (2, 'productB'), ...`
2.  填充您的客户目录

然后您就可以开始下订单了。我假设您有以下客户：

```
customerId | customerName | customerAdress
---------------------------------------------
         1 | John Doe     | 31 elm street
         2 | Jane Doe     | 1223 park street 
```

...和产品：

```
productNumber | productName
------------------------------
         1000 | Pencil
         2000 | Paper clip
         3000 | Bottled water 
```

现在，下订单是一个两步过程：首先，创建订单记录，然后插入订单详细信息：

1.  订单（客户 John Doe）：`insert into tbl_orders values (1, '2012-10-17', 1);`

2.  订单详情（一支铅笔，十个回形针）：`insert into tbl_orders_products values (1, 1, 1000, 1), (2, 1, 2000, 10);`

现在，要选择订单七的客户（如您的问题中所述），您可以使用以下查询：

```
select c.*
from tbl_customers as c
inner join tbl_orders as o on c.customerId = o.customerId
where o.orderId = 7; 
```

这只是一个起点。您应该寻找好书或在线教程（w3 教程可以是一个很好的在线“起点”）。

虽然我不太喜欢MS Access，但它是一个学习sql基础的好程序，而且有很多书籍和学习资源。**注意：我不喜欢 Access，也不是要宣传它**，但它可能是一个很好的学习工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T22:49:40.800

首先你需要规范化，这方面有很多东西，但是大量的教程试图采取一些常识并让它变得非常模糊

看着你的列名，我看到三个表

客户（客户 ID、客户名称、客户地址）

CustomerOrders(OrderID, CustomerID, SellDate, ProductNumber) 尽量不要将您的表和列命名为 Sql 关键字之类的相同名称。

产品(ProductNumber, ProductDescription)

规范化表示，您应该能够唯一标识表中的任何记录，您可以使用 OrderId。当我拆分表格时，我添加了 CustomerID，因为您可能有多个同名客户。

另一个简单的规则是在您的结构中，如果您有多个客户订单，您将多次存储他们的姓名和地址，这是一种浪费，但真正的问题是，如果该客户更改地址怎么办？如何找到要更改的行，您可以执行 Where name = "Fred" 和 Address = "Here"，但您不知道是否有多个客户名为 Fred，地址为 Here。

所以你的第一个查询将是一个连接

```
Select Customers.CustomerName,Customers.CustomerAddress From Customers
Inner join CustomerOrders On Customers.CustomerID = CustomerOrders.CustomerID
Where CustomerOrders.OrderID = 7 
```

或者，如果您现在想跳过过去的学习连接，您可以使用两个查询来完成

```
Select CustomerID From CustomerOrders Where OrderID = 7 
```

然后

```
Select CustomerName,CustomerAddress From Customers Where CustomerID = ? 
```

您应该使用连接，但您可能会发现子查询更容易让您了解情况。您可以同时执行这两个查询

```
Select CustomerID From CustomerOrders 
Where CustomerID In (Select CustomerID From CustomerOrders Where OrderID = 7) 
```

不知道您对 sql 表创建的了解有多远，但主键和外键是要查看的两件事。这将使您可以在数据库中放置一些规则。CustomerOrders 上的主键将阻止您拥有两个具有相同 ID 的订单，这很糟糕。

外键会阻止您为不存在的客户创建 CustomerOrder，并阻止您为不存在的产品创建产品。

假设您沿着这条路线走，并且您正在寻找编写一个应用程序来订购东西。

您可能具有维护客户的功能，该功能会向他们添加类似的内容

```
Insert Into Customers(CustomerID,CustomerName,CustomerAddress) Values(1,'Fred Bloggs','England') 
```

还有一个产品

```
Insert Into Products(ProductNumber,ProductDescription) Values(1,'A thingamabob') 
```

然后你会选择一个客户，所以你有它的 id，选择一个产品，所以你有它的编号，所以你不需要弄乱 CustomerName、CustomerAddress 或 ProductDescription

和

```
Insert Into CustomerOrders(OrderID,CustomerID,ProductNumber,SellDate) Values(1,1,1,'20121017') 
```

请注意日期格式，如果您要将日期作为字符串传递给 sql，（另一个主题）在 YYYYMMDD 中执行它们，当您通过选择将它们取出时，您将以机器/数据库的格式获取它们设置在您的情况下似乎是 mm/dd/yyyy。问题是我推断出这是因为我知道一年只有十二个月。（使我成为高级开发人员的原因之一 :) 如果您的示例销售日期是 2012 年 1 月 5 日，我会读到 5 月 1 日，因为我已配置为英语。不惜一切代价避免这种歧义，它会定期影响你并伤害你。

PS 你在 2012 年 1 月 15 日所做的方式将被视为数学表达式，如 1 除以 15 ...

所以你不能写一个连接的原因基本上是你只有一个表。加入是将一个表连接到另一个表。好吧，实际上它比这要复杂一些，但这是超越学习曲线的好方法。

至于移动数据，我应该更快地重新开始。您不太可能创建了两个具有相同名称的不同客户，但移动数据的查询必须考虑到您可能拥有的情况。

要移动数据，假设 CustomerID 是`Identity`（自动编号）列

就像是

```
Insert into Customers(CustomerName,CustomerAddress)
Select Distinct CustomerName,CustomerAddress From [Order] 
```

会为客户做这项工作。

那么对于产品

```
Insert into Products(ProductDescription)
Select Distinct ProductDescription From [Order] 
```

然后

```
Insert into CustomerOrders(OrderID,CustomerID,ProductNumber,SellDate)
Select old.OrderID,c.CustomerID,p.ProductNumber,old.SellDate
From [Order] old
Inner Join Products p On p.ProductDesription = old.ProductDescription
Inner Join Customers c On c.CustomerName = old.CustomerName And c.CustomerAddress = old.CustomerAddress 
```

我认为可能会做 CustomerOrders

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T22:26:59.070

一个简单的提示。在对数据解决方案进行建模时，尝试写下描述场景的简单句子。例如（好吧，这只是一个基本的）：

*   一个订单由许多订单行组成
*   订单行是指产品
*   一个客户创建许多订单

在这里，名词描述了场景的实体。然后，对于每个实体，尝试描述其属性：

*   订单的特点是唯一的序列号、日期、总数。它指的是客户。
*   订单行是指产品，以数量、单价、小计为特征
*   一个客户....

一个等等。好吧，在您的模型中，您大致必须为每个实体创建一个表。表字段取自每个实体的属性。对于每个字段，请记住定义正确的数据类型。

好的，这不是一个建模教程，但它是一个起点，只是为了接近解决方案。

# iphone - 我应该在不需要时使用 UIIntegers

> ID：12943683
> 
> 赞同：0
> 
> 时间：2012-10-17T21:27:23.217
> 
> 标签：iphone, xcode, ipad

我有一个很大的 NSMutableArray `int`，它的值永远不会超过 10 位。是否有充分的理由使用 NSInteger 代替？我宁愿使用尽可能少的位数。

# perl - 数组 deepcopy 而不是 perl 对象中的引用

> ID：12943684
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:27:31.260
> 
> 标签：perl, object, reference, deep-copy

我尝试了几个小时将子数组存储到对象中但失败了。也许你们中的某个人可以向我展示如何使用 perl 存储深层副本。对不起，我不知道这个问题是否清楚，但应该很容易解决......

这里是例子。

这里是对象类

```
package obj;

use strict;
use warnings;
require Exporter;
our @ISA = qw(Exporter);

sub new(\@){
    my $class=shift;
    my $this={};
    $this->{"array"}=shift;
    return bless($this,$class);
}

sub getArray(){
    my $this=shift;
    return $this->{"array"};
} 
```

和测试班

```
use strict;
use warnings;
use obj;

my @a=(1,2);
push @a,3;
my $ob=obj->new(\@a);
@a=();
print @{$ob->getArray()}; 
```

这不返回任何内容 - 不移动取消引用数组？

那么该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:38:14.633

尊重什么数组？移位中涉及的唯一数组是`@_`？`$_[0]`是一个标量，而不是一个数组。

使用以下方法完成（浅）数组复制：

```
@dst = @src; 
```

所以你要

```
@{ $this->{"array"} } = @{ shift }; 
```

如果您真的想要一个深层副本（尽管在您的示例中不需要它），请使用

```
use Storable qw( dclone );

$this->{"array"} = dclone(shift); 
```

# sql - SQL Server 基于行的分组

> ID：12943686
> 
> 赞同：2
> 
> 时间：2012-10-17T21:27:34.657
> 
> 标签：sql, sql-server, sql-server-2008, tsql

鉴于以下设置：

```
DECLARE @TemplateInfo table (Name varchar(10), aRow int, aCol int, Value  int)

insert INTO @TemplateInfo (Name, aRow, aCol, Value)
VALUES ('A', 0,0,1),('B', 0,0,2),('A',1,0,2),('B',1,0,1),('C',0,0,1),('C',1,0,1) 
```

如何选择具有 (aRow=0, aCol=0, Value=1) AND (aRow=1, aCol=0, Value=1) 的唯一名称名称值。

我尝试了这样的查询：

```
select  Name
from    @TemplateInfo info
where   (info.aRow = 0 and info.aCol = 0 AND Value = 1) 
        or (info.aRow = 1 and info.aCol = 0 AND Value = 1)
GROUP BY Name 
```

但这会返回 A、B 和 C。我如何检查以确保跨行匹配（仅返回 C）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:33:09.907

你真的很亲近。由于您希望评估这两个条件，您可以使用`HAVING`：

```
select  Name
from    @TemplateInfo info
where   (info.aRow = 0 and info.aCol = 0 AND Value = 1) 
        or (info.aRow = 1 and info.aCol = 0 AND Value = 1)
group by Name
HAVING COUNT(*) = 2 
```

`aRow, aCol, Value`尽管这仅在for each只能有一个组合时才有效`name`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T04:44:37.617

你甚至可以使用相交

```
Select name From @TemplateInfo where aRow=0 and  aCol=0 and Value=1
intersect
Select name From @TemplateInfo where aRow=1 and  aCol=0 and Value=1 
```

**结果**

```
name
C 
```

# php - Zend_Soap_Server 参数必须是有序的吗？

> ID：12943689
> 
> 赞同：2
> 
> 时间：2012-10-17T21:28:03.150
> 
> 标签：php, zend-framework, soap, zend-soap

我在使用 Zend_soap_server 时遇到了一个奇怪的问题。

如果我有一个看起来像的方法

```
/**
     * This method will say hello
     * 
     * @param string $param1
     * @param integer $param2
     * @param integer $param3
     * @throws Zend_Exception
     */
public method($param1, $param2, $param3) 
```

我的 xml 请求看起来像

```
<param2 xsi:type="xsd:int">0</param2>
<param1 xsi:type="xsd:string">hello</param1>
<param3 xsi:type="xsd:int">2</param3> 
```

碰巧 param1 是 0（应该是你好） param2 是你好（应该是 0） param3 是 2。

如果我的请求被订购，一切正常

```
<param1 xsi:type="xsd:string">hello</param1>
<param2 xsi:type="xsd:int">0</param2>
<param3 xsi:type="xsd:int">2</param3> 
```

关于我为什么会遇到这种情况的任何想法？我该如何解决？

谢谢你的支持，对不起我的英语。

# facebook - “关于这个应用程序”登录文本和设置

> ID：12943692
> 
> 赞同：1
> 
> 时间：2012-10-17T21:28:07.890
> 
> 标签：facebook, dialog, fbconnect

我在 iOS 下为我的应用程序使用单点登录，但我认为我的问题也与其他平台有关。我需要更改登录对话框中的“关于此应用程序”文本，但根据[此 Facebook Docs 页面](http://developers.facebook.com/docs/concepts/login/permissions-login-dialog/)更改各种属性中的文本不会导致任何更改。我将我的文本保存在描述字段中。传播设置需要多长时间？

# php - PHP的SSH包？

> ID：12943696
> 
> 赞同：0
> 
> 时间：2012-10-17T21:28:48.747
> 
> 标签：php, windows, linux, ssh, natty

好的，这似乎是一个非常*非常*尴尬的问题，但这是我的问题：

在我学校的图书馆里，我需要能够通过 SSH 连接到我的网站，但唯一的问题是，如果我尝试使用 FileZilla 或 putTy，它永远不会工作。我什至没有使用端口 22，而是使用单独的端口。它仍然像被阻塞一样接缝。

我想知道我是否可以使用一些可以添加到我网站上的管理部分的包，这样我就可以直接从浏览器 ssh 到我的网站（我的学校也使用 Windows，所以在 nano 中执行 ctrl+x 不起作用。

我最好使用 PHP，因为我不能使用任何其他服务器端语言（技术原因），而且我对网站和其他东西非常陌生，这是我的第一个项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:31:09.223

PHP 有一个优秀的内置 SSH 包（通过 pecl）：[http ://us2.php.net/manual/en/book.ssh2.php](http://us2.php.net/manual/en/book.ssh2.php)

如果您还没有，这里是安装说明：[http ://us2.php.net/manual/en/install.pecl.intro.php](http://us2.php.net/manual/en/install.pecl.intro.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T21:31:25.290

查看[phpSecLib](http://phpseclib.sourceforge.net/)。它在 PHP 中实现了 SSH 协议，并且对于这种类型的东西非常常见。

如果您搜索“PHP SSH 客户端”之类的内容，还有其他可用的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:41:36.263

似乎您想在自己的服务器上运行命令。为 PHP 安装 SSH 库在这方面对你没有帮助，除非你从你的服务器 ssh 到它自己。使用[php web shell](http://code.google.com/p/php-web-shell/)怎么样？

您必须确保对其进行保护，但它应该允许您在浏览器中运行所需的任何命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:52:40.853

从您的学校到 Internet 的连接可能受到防火墙的保护。

在最简单的情况下，您学校的工作站可以直接访问 Internet，但防火墙会阻止与大多数端口的连接。如果是这种情况，您可以尝试`sshd`在端口 80（用于 HTTP 的端口）上运行。

在更复杂的情况下，工作站必须通过 HTTP 代理才能访问网页。显然[Putty 允许通过 HTTP 代理连接到 SSH 服务器](http://meinit.nl/using-putty-and-an-http-proxy-to-ssh-anywhere-through-firewalls)，您只需[正确配置它](http://the.earth.li/~sgtatham/putty/0.62/htmldoc/Chapter4.html#config-proxy)。

这些都不需要 PHP 模块，因为直接连接到`sshd`.

# perl - 如何提取文本文件中的部分行并将其打印到 Perl 中的输出文件（代码半写）

> ID：12943706
> 
> 赞同：1
> 
> 时间：2012-10-17T21:29:40.663
> 
> 标签：perl

我有一个大的 .txt 文件，其中一部分如下所示 -

```
ID   SNP
FT   SNP             102
FT                   /note="refAllele: C SNPstrains: 4395_8_10=A 4395_8_7=A 4395_8_9=A     "
FT                   /colour=1
FT   SNP             1299
FT                   /note="refAllele: A SNPstrains: 6437_8_6=T (non-synonymous) (AA Gin->His) "
FT                   /colour=2
FT   SNP             2134
FT                   /note="refAllele: C SNPstrains: 4395_8_12=T "
FT                   /colour=1
FT   SNP             3205
FT                   /note="refAllele: C SNPstrains: 6437_8_12=T (synonymous) " 
```

我也有这个脚本（不是我写的）-

```
$cod{1} = "Int";
$cod{2} = "non";
$cod{3} = "syn";
$cod{4} = "stop";

$file = "Whole.pl";
open IN, "$file";
open OUT, ">whole2";
print OUT "Coordinate   Type    Strains\n";

while (<IN>) {

    if (m/^FT\s+SNP\s+(\d+)/) {

        $SNP = $1;      
    }
    elsif (m/^FT\s+\/note="(.*)"/) {

        $line = $1;
        $count = ($line =~ tr/=/=/);
    }
    elsif (m/^FT\s+\/colour=(\d+)/) {

        if ($cod{$1}) {

            print OUT "$SNP $cod{$1} $count\n";
        }
        elsif (!$cod{$1}) {

            print OUT "$SNP colour $1 $count\n";
        }
    }
} 
```

它创建一个新文件。对于上述数据，它会创建这个 -

```
Coordinate  Type    Strains 
102          Int    3
1299         non    1
2134         Int    1
3205         syn    1 
```

我对 perl 和编程很陌生，我想我只是了解这个脚本在做什么。但是，对于显示非同义突变的菌株（例如 .txt 文件中的第二个突变），我希望在输出文件中有第四列详细说明氨基酸变化（例如（AA Gin->His )，.txt 文件中第六行的结尾）。此外，理想情况下，我希望在输出中显示非同义突变，而完全不使用“syn”和“int”。

我尝试了很多方法来做到这一点，但没有一个奏效。请问你能告诉我一种方法吗？

提前谢谢了。

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:14:58.553

假设：

1.  您`/note`可能包含一个氨基酸变化作为最后一个元素。它必须用括号括起来并以字母开头`AA`，后跟一个或多个字母的序列，然后是`->`，然后是另一个一个或多个字母的序列。

2.  您只对`non`类型感兴趣。

在您的第一个`elsif`中，我们必须匹配`$line`可能的氨基变化：

```
}elsif(m/^FT\s+\/note="(.*)"/){
        $line=$1;
        $line =~ m/\((AA \w+->\w+)\)\s*$/;
        $change = $1 || "";
        ...; 
```

在您的第二个 elsif 中，我们仅在`$cod{$1}`等于时打印`non`：

```
}elsif(m/^FT\s+\/colour=(\d+)/){
   print OUT "$SNP $count $change\n" if $cod{$1} eq "non";
   # inner if/else not needed any longer.
} 
```

此外，顶部的表格标题必须更改：

```
print OUT "Coordinate   Strains Change\n"; 
```

您将不得不手动重新对齐列。

这将打印类似

```
Coordinate      Strains Change
1299    1       AA Gin->His 
```

在示例输入上。

# java - 迭代地反转单链表

> ID：12943720
> 
> 赞同：1
> 
> 时间：2012-10-17T21:30:36.263
> 
> 标签：java, linked-list, singly-linked-list

必须是 O(n) 并且就地（空间复杂度为 1）。下面的代码确实有效，但有没有更简单或更好的方法？

```
public void invert() {
    if (this.getHead() == null)
        return;
    if (this.getHead().getNext() == null)
        return;
    //this method should reverse the order of this linked list in O(n) time
    Node<E> prevNode = this.getHead().getNext();
    Node<E> nextNode = this.getHead().getNext().getNext();
    prevNode.setNext(this.getHead());
    this.getHead().setNext(nextNode);
    nextNode = nextNode.getNext();

    while (this.getHead().getNext() != null)
    {
        this.getHead().getNext().setNext(prevNode);
        prevNode = this.getHead().getNext();
        this.getHead().setNext(nextNode);
        if (nextNode != null)
            nextNode = nextNode.getNext();
    }
    this.head = prevNode;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-17T22:11:03.670

编辑以删除每次迭代的额外比较：

```
 public void invert() {
        Node<E> prev = null, next = null;;
        if (head == null) return;
        while (true) {
            next = head.getNext();
            head.setNext(prev);
            prev = head;
            if (next == null) return;
            head = next;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T22:02:29.677

适用于 LinkedList 的此实现：[https ://stackoverflow.com/a/25311/234307](https://stackoverflow.com/a/25311/234307)

```
public void reverse() {

    Link previous = first;
    Link currentLink = first.nextLink;
    first.nextLink = null;

    while(currentLink != null) {        

        Link realNextLink = currentLink.nextLink;
        currentLink.nextLink = previous;                        
        previous = currentLink; 
        first = currentLink;    
        currentLink = realNextLink;

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:43:46.870

这个怎么样：

```
public void invert() {
    if (head != null) {
        for (Node<E> tail = head.getNext(); tail != null; ) {
            Node<E> nextTail = tail.getNext();
            tail.setNext(head);
            head = tail;
            tail = nextTail;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T22:08:30.240

使用自包含的实现，即 List 由 head Node 表示：

```
public class Node<E>
{
    Node<E> next;
    E value;

    public Node(E value, Node<E> next)
    {
        this.value = value;
        this.next = next;
    }

    public Node<E> reverse()
    {
        Node<E> head = null;
        Node<E> current = this;
        while (current != null) {
            Node<E> save = current;
            current = current.next;
            save.next = head;
            head = save;
        }
        return head;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T06:01:02.720

```
public void reverse(){

    Node middle = head;
    Node last = head;
    Node first = null;

    while(last != null){

        middle = last;
        last = last.next;
        middle.next = first;
        first = middle;
    }

    head = middle;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-05T16:59:07.353

```
public void invert() {  
  if (first == null) return;  
  Node<E> prev = null;  
  for ( Node<E> next = first.next; next != null; next = first.next) {  
    first.next = prev;  
    prev = first;  
    first = next;  
  }  
  first.next = prev;  
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-03-21T06:23:27.293

修改节点类

你可以覆盖 Node 类中的 toString 方法来输入任何数据

`public class Node { public Node node; private int data; Node(int data) { this.data = data; } @Override public String toString() { return this.data+""; }`

# sql-server-2008 - 索引同一列中由空格分隔的整数时，全文搜索是否同样有效？

> ID：12943728
> 
> 赞同：0
> 
> 时间：2012-10-17T21:31:33.110
> 
> 标签：sql-server-2008, full-text-search, indexing

IE 全文搜索是否同样/更好地*仅*通过空格分隔并使用“全文索引”索引的整数进行搜索？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T20:49:24.120

回答：是的。尝试了超过一百万行。

# java - 如何定义一个新的 Java 类并在运行时创建它的实例？

> ID：12943729
> 
> 赞同：1
> 
> 时间：2012-10-17T21:31:34.670
> 
> 标签：java, dynamic, orm, runtime, metaclass

我想在运行时使用一些输入信息定义一个新的 Java 类，例如，通过一些或持久性 API ( , )`Files.readAllBytes(Paths.get(path));`将此类的对象映射到关系数据库。是否有可能做到这一点，如果可以，如何实现（哪些库、工具等）？我自己的想法是使用[Jython](https://wiki.python.org/jython/UserGuide)[元类](https://en.wikibooks.org/wiki/Python_Programming/Metaclasses)，但我认为有更简单的解决方案。`ORM``MyBatis``Hibernate`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:47:18.357

您可以使用[编译器 API来完成](http://docs.oracle.com/javase/7/docs/api/javax/tools/JavaCompiler.html)

这是一个例子 - [http://www.accordess.com/wpblog/an-overview-of-java-compilation-api-jsr-199/](http://www.accordess.com/wpblog/an-overview-of-java-compilation-api-jsr-199/)

# jquery - 使用 jquery 更改视频文件

> ID：12943732
> 
> 赞同：0
> 
> 时间：2012-10-17T21:31:47.663
> 
> 标签：jquery, html, video, hyperlink, stream

我有一个简单的视频播放器

```
<video id="video" src="http://xyx.com/zzz.m3u8" 
controls="controls" width="480" height="280"></video> 
```

我希望能够通过单击链接来更改视频流，例如

```
<a href="#">Stream A</a>
<a href="#">Stream B</a>
<a href="#">Stream C</a> 
```

我怎样才能做到这一点？通过每个链接，我还必须通过新流。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:34:51.907

```
<a href="#" data-src="/source/for/video1.mp4">Stream A</a>
<a href="#" data-src="/source/for/video2.mp4">Stream B</a>
<a href="#" data-src="/source/for/video3.mp4">Stream C</a> 
```

--

```
$('a').on('click', function(e) {
    e.preventDefault()
    $('#video').attr('src', $(this).data('src'));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:21:37.387

这是一个有效的解决方案：

```
 index.html

        <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml">
        <head>    
        <title>Ipad Video TV v.1.5</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <style>
 body, div {
  padding: 0;
  margin: 0; }

#wrapper {
  width: 100%;
  height: 100%;
  position: absolute;
  left: 0;
  top: 0; }

#divplayer {
  width: 500px;
  height: 100%;
  position:fixed;
  left: 240px;
  top: 90px;
  text-align: left; }

#scroll {
  position: absolute;
  left: 0px;
  top: 0px;
  background-color: #000;
  height: 10px;
  width: 200px;
  z-index: -1; }

#mscroll li {
    background-color: #FFFFFF;
    border: 1px solid rgb(11,47,99);
    color: #061A38;
    display: block;
    padding: 1px 1px 1px 10px;
    margin-left:5px;
    margin-bottom:-5px;
    text-decoration: none;
    width: 155px;
    cursor: pointer;

    text-indent: 5px;
    font: bold 12px Verdana;
}

#mscroll a
{
    color:#061A38;
    text-decoration: none;
}

#mscroll a:hover li
{
    color: #061A38; 
    background: #65B5DF; <!-- rgb(153,249,75); --> 
}

   </style>
         <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
           <script src="main.js" type="text/javascript"></script>
        </head>
        <body bgcolor="#000000" onLoad="init()">

            <div id="wrapper">
                <div id="header"></div>
                <div id="divplayer"></div>

                <div id="scroll"></div>
                <div id="mscroll"></div>
                <ul class="svertical"></div>

        </body>
        </html>​

        main.js
    // properties
    var XML_PATH = "config.xml";
    var video_width;
    var video_height;
    var videos_array=new Array();
    // init the application
    function init()
    {
        // call loadXML function
        loadXML();
    }
    // XML loading
    function loadXML()
    {
        $.ajax({
                type: "GET",
                url: XML_PATH,
                dataType: "xml",
                success: function onXMLloaded(xml)
                {
                    // set video_width and video_height
                    video_width=$(xml).find("videos").attr("width");
                    video_height=$(xml).find("videos").attr("height");

                    // loop for each item
                    $(xml).find('item').each(function loopingItems(value)
                    {
                        // create an object
                        var obj={title:$(this).find("title").text(), mp4:$(this).find("mp4").text()};
                        //, ogg:$(this).find("ogg").text(), description:$(this).find("description").text()};
                        videos_array.push(obj);

                        // append <ul> and video title
                        $("#mscroll").append('<ul>');
                        //value
                        $("#mscroll").append('<a><li>'+obj.title+'</li></a>');
                    });

                    // close </ul>
                    $("#mscroll").append('</ul>');
                    // call addListeners function
                    addListeners();
                }
        });
    }

    // add <li> listener
    function addListeners()
    {
        // loop for each list item
        $('#mscroll li').each(function looping(index)
        {
            // onclick...
            $(this).click(function onItemClick()
            {
                // empty left column and description
                $("#divplayer").empty();
                // append video tag
                $("#divplayer").append('<video width="'+video_width+'" height="'+video_height+'" controls="controls"><source src="'+videos_array[index].mp4+'" autoplay/></video>');
            });
        });
    }

    config.xml

    <?xml version="1.0" encoding="UTF-8"?>
    <videos width="440" height="280">
        <item>
            <title>REALITATEA TV</title>
            <mp4>http://fms3.mediadirect.ro/live3/_definst_/realitatea/playlist.m3u8?publisher=6</mp4>
        </item>
    </videos> 
```

这会从 xml 加载视频，构建一个菜单，然后单击它会播放每个视频。

# java - jsoup - 去除所有格式和链接标签，只保留文本

> ID：12943734
> 
> 赞同：47
> 
> 时间：2012-10-17T21:31:52.623
> 
> 标签：java, html, jsoup

假设我有一个这样的 html 片段：

```
<p> <span> foo </span> <em> bar <a> foobar </a> baz </em> </p> 
```

我想从中提取的是：

```
foo bar foobar baz 
```

所以我的问题是：我怎样才能从 html 中剥离所有包装标签，并只获取与 html 中相同顺序的文本？正如您在标题中看到的，我想使用 jsoup 进行解析。

重音 html 示例（注意 'á' 字符）：

```
<p><strong>Tarthatatlan biztonsági viszonyok</strong></p>
<p><strong>Tarthatatlan biztonsági viszonyok</strong></p> 
```

我想要的是：

```
Tarthatatlan biztonsági viszonyok
Tarthatatlan biztonsági viszonyok 
```

这个 html 不是静态的，通常我只想要一个通用 html 片段的每个文本都以解码的人类可读形式，宽度换行符。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-10-17T21:38:06.427

**使用 Jsoup：**

```
final String html = "<p> <span> foo </span> <em> bar <a> foobar </a> baz </em> </p>";
Document doc = Jsoup.parse(html);

System.out.println(doc.text()); 
```

**输出：**

```
foo bar foobar baz 
```

如果您只想要 p-tag 的文本，请使用它而不是`doc.text()`：

```
doc.select("p").text(); 
```

...或只有身体：

```
doc.body().text(); 
```

* * *

## 越线：

```
final String html = "<p><strong>Tarthatatlan biztonsági viszonyok</strong></p>"
        + "<p><strong>Tarthatatlan biztonsági viszonyok</strong></p>";
Document doc = Jsoup.parse(html);

for( Element element : doc.select("p") )
{
    System.out.println(element.text());
    // eg. you can use a StringBuilder and append lines here ...
} 
```

**输出：**

```
Tarthatatlan biztonsági viszonyok  
Tarthatatlan biztonsági viszonyok 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-17T21:35:03.040

**使用正则表达式**： -

```
String str = "<p> <span> foo </span> <em> bar <a> foobar </a> baz </em> </p>";
str = str.replaceAll("<[^>]*>", "");
System.out.println(str); 
```

*输出*： -

```
 foo   bar  foobar  baz 
```

**使用 Jsoup**：-

```
Document doc = Jsoup.parse(str); 
String text = doc.text(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-19T16:25:37.740

Actually, the correct way to clean with Jsoup is through a [Whitelist](https://jsoup.org/apidocs/org/jsoup/safety/Whitelist.html)

```
...
final String html = "<p> <span> foo </span> <em> bar <a> foobar </a> baz </em> </p>";
Document doc = Jsoup.parse(html);
Whitelist wl = Whitelist.none()
String cleanText = Jsoup.clean(doc.html(), wl) 
```

If you want to still preserve some tags:

```
Whitelist wl = new Whitelist().relaxed().removeTags("a") 
```

# c# - 处理插入 XElement 的字符串

> ID：12943740
> 
> 赞同：8
> 
> 时间：2012-10-17T21:32:40.407
> 
> 标签：c#, string, xelement

我们收集大量字符串并以 xml 片段的形式将它们发送给我们的客户。这些字符串实际上可以包含任何字符。我们一直看到尝试序列化包含“坏”字符的 XElement 实例导致的错误。这是一个例子：

```
var message = new XElement("song");
char c = (char)0x1a; //sub
var someData = string.Format("some{0}stuff", c);
var attr = new XAttribute("someAttr", someData);
message.Add(attr);
string msgStr = message.ToString(SaveOptions.DisableFormatting); //exception here 
```

上面的代码在指示的行生成异常。这是堆栈跟踪：

```
'SUB'，十六进制值 0x1A，是一个无效字符。System.ArgumentException System.ArgumentException：''，十六进制值 0x1A，是无效字符。
   在 System.Xml.XmlEncodedRawTextWriter.InvalidXmlChar（Int32 ch，Char* pDst，布尔实体）
   在 System.Xml.XmlEncodedRawTextWriter.WriteAttributeTextBlock（Char* pSrc，Char* pSrcEnd）
   在 System.Xml.XmlEncodedRawTextWriter.WriteString（字符串文本）
   在 System.Xml.XmlWellFormedWriter.WriteString（字符串文本）
   在 System.Xml.XmlWriter.WriteAttributeString（字符串前缀，字符串 localName，字符串 ns，字符串值）
   在 System.Xml.Linq.ElementWriter.WriteStartElement(XElement e)
   在 System.Xml.Linq.ElementWriter.WriteElement(XElement e)
   在 System.Xml.Linq.XElement.WriteTo（XmlWriter 作家）
   在 System.Xml.Linq.XNode.GetXmlString(SaveOptions o)

```

我怀疑这不是正确的行为，应该将坏字符转义到 XML 中。这是否可取是我稍后会回答的问题。

那么问题来了：

是否有某种处理字符串的方法可能不会发生此错误，或者我应该简单地剥离 char 下方的所有字符`0x20`并交叉手指？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T02:18:17.730

对 ILSpy 的一点挖掘表明，可以使用 XmlWriter/ReaderSettings.CheckCharacters 字段来控制是否为无效字符引发异常。借用 XNode.ToString 方法和 XDocument.Parse 方法，我想出了以下示例：

使用无效（控制）字符对 Xlinq 对象进行字符串化：

```
XDocument xdoc = XDocument.Parse("<root>foo</root>");
using (StringWriter stringWriter = new StringWriter())
{
    XmlWriterSettings xmlWriterSettings = new XmlWriterSettings { OmitXmlDeclaration = true, CheckCharacters = false };
    using (XmlWriter xmlWriter = XmlWriter.Create(stringWriter, xmlWriterSettings))
    {
        xdoc.WriteTo(xmlWriter);
    }

    return stringWriter.ToString();
} 
```

解析带有无效字符的 Xlinq 对象：

```
XDocument xdoc;
using (StringReader stringReader = new StringReader(text))
{
    XmlReaderSettings xmlReaderSettings = new XmlReaderSettings { CheckCharacters = false, DtdProcessing = DtdProcessing.Parse, MaxCharactersFromEntities = 10000000L, XmlResolver = null };
    using (XmlReader xmlReader = XmlReader.Create(stringReader, xmlReaderSettings))
    {
        xdoc = XDocument.Load(xmlReader);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-18T09:30:50.987

这是我在我的代码中使用的：

```
 static Lazy<Regex> ControlChars = new Lazy<Regex>(() => new Regex("[\x00-\x1f]", RegexOptions.Compiled));

    private static string FixData_Replace(Match match)
    {
        if ((match.Value.Equals("\t")) || (match.Value.Equals("\n")) || (match.Value.Equals("\r")))
            return match.Value;

        return "&#" + ((int)match.Value[0]).ToString("X4") + ";";
    }

    public static string Fix(object data, MatchEvaluator replacer = null)
    {
        if (data == null) return null;
        string fixed_data;
        if (replacer != null) fixed_data = ControlChars.Value.Replace(data.ToString(), replacer);
        else fixed_data = ControlChars.Value.Replace(data.ToString(), FixData_Replace);
        return fixed_data;
    } 
```

0x20 以下的所有字符（\r \n \t 除外）都被它们的 XML unicode 代码替换：0x1f => "f"。Xml 解析器在读取文件时应自动将其转义回 0x1f。只需使用 new XAttribute("attribute", Fix(yourString))

它适用于 XElement 内容，它可能也适用于 XAttributes。

# string - 在 MATLAB 中将数据集上的字符串特征值转换为数值

> ID：12943745
> 
> 赞同：0
> 
> 时间：2012-10-17T21:32:58.093
> 
> 标签：string, matlab, dataset

我有一个像

```
5.7,2.9,4.2,1.3,Iris-versicolor
6.2,2.9,4.3,1.3,Iris-versicolor
5.1,2.5,3.0,1.1,Iris-versicolor
5.7,2.8,4.1,1.3,Iris-versicolor
6.3,3.3,6.0,2.5,Iris-virginica
5.8,2.7,5.1,1.9,Iris-virginica
7.1,3.0,5.9,2.1,Iris-virginica 
```

我想将该数据集上的字符串值转换为整数值，例如

```
5.7,2.9,4.2,1.3,0
6.2,2.9,4.3,1.3,0
5.1,2.5,3.0,1.1,0
5.7,2.8,4.1,1.3,0
6.3,3.3,6.0,2.5,1
5.8,2.7,5.1,1.9,1
7.1,3.0,5.9,2.1,1 
```

所以 Iris-versicolor 变成 0 而 Iris-versicolor 变成 1

我怎么能在 Matlab 中做到这一点不实用的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:08:44.373

如果您的数据在单元格数组中，即

```
data = {...
5.7,2.9,4.2,1.3,'Iris-versicolor'
6.2,2.9,4.3,1.3,'Iris-versicolor'
5.1,2.5,3.0,1.1,'Iris-versicolor'
5.7,2.8,4.1,1.3,'Iris-versicolor'
6.3,3.3,6.0,2.5,'Iris-virginica'
5.8,2.7,5.1,1.9,'Iris-virginica'
7.1,3.0,5.9,2.1,'Iris-virginica'}; 
```

您可以按如下方式创建所需的输出（从 的输出中减去 1 `grp2idx`，因为它从 1 开始计数（这是您在使用 Matlab 时可能希望采用的一种做法））：

```
[cell2mat(data(:,1:end-1)),grp2idx(data(:,end))-1]

    5.7000    2.9000    4.2000    1.3000         0
    6.2000    2.9000    4.3000    1.3000         0
    5.1000    2.5000    3.0000    1.1000         0
    5.7000    2.8000    4.1000    1.3000         0
    6.3000    3.3000    6.0000    2.5000    1.0000
    5.8000    2.7000    5.1000    1.9000    1.0000
    7.1000    3.0000    5.9000    2.1000    1.0000 
```

# apache - 有什么方法可以防止 apache 代理超时？

> ID：12943750
> 
> 赞同：0
> 
> 时间：2012-10-17T21:33:20.100
> 
> 标签：apache, mod-proxy

如果可以防止 apache 在代理请求上超时，我在文档中找不到。我正在尝试设置一个套接字服务器，并正在寻找它作为一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:36:07.207

您是否尝试过 ProxyTimeout 指令，并将其设置为在[http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxytimeout中指定的相对较大的数字（以秒为单位）](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxytimeout)

# python - 从 C(++) 访问 python 数据

> ID：12943757
> 
> 赞同：0
> 
> 时间：2012-10-17T21:33:53.837
> 
> 标签：python, c, exchange-server

我编写了一些 Python 函数来将简单的空间数据（如点、多边形、三角曲面）读入/从 Python 中的简单数据结构中读取/写入。我知道有一些可能性可以从**C**或 C++ 访问这些数据结构，就像在这篇文章中一样： [Passing Python list to C++ vector using Boost.python](https://stackoverflow.com/questions/4819707/passing-python-list-to-c-vector-using-boost-python)

但是，我不是使用模板的经验丰富的程序员，我想先从一种简单的方法开始——如果它存在的话。因此，如果我有一个点对象列表（参见简单的类定义），我将如何从读取相应变量的**C程序访问该列表。**

```
class point3d():

def __init__(self, objectName, version, id=[], xyz=[], prop=[], unit=[], val=[]):
    self.id = id
    self.xyz = xyz
    self.prop = prop
    self.unit = unit
    self.val = val
    dim = len(self.xyz)
    self.objectName = objectName
    self.version = version
    if dim == 1:
        self.x = self.xyz[0]
    elif dim == 2:
        self.x = self.xyz[0]
        self.y = self.xyz[1]
    elif dim == 3:
        self.x = self.xyz[0]
        self.y = self.xyz[1]
        self.z = self.xyz[2]

def __del__(self):
    pass

def getObjectName(self):
    return self.objectName

def getVersion(self):
    return self.version

def getXYZ(self):
    return self.xyz

def getDim(self):
    return self.dim

def getProp(self):
    return self.prop

def getUnit(self):
    return self.unit

def getVal(self):
    return self.val

def getId(self):
    return self.id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:54:12.220

如果你想从你的 python 程序中调用一个 C/C++ 函数，[ctypes](http://docs.python.org/library/ctypes.html)是要走的路。

# scala - 参数化类型将 Char 转换为 Int

> ID：12943759
> 
> 赞同：2
> 
> 时间：2012-10-17T21:34:09.107
> 
> 标签：scala

我无意中注意到以下内容：

```
scala> class g[T](val x:T)   
defined class g

scala> val obj=new g[Int]('A')
obj: g[Int] = g@1082d45

scala> obj.x
res6: Int = 65 
```

这里发生了什么？类型转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:40:53.320

这是原语的上转换。如果需要的话，原始值会将自己转换为下一个数值更大的类型。所以`val s: Short = (0: Byte)`有效。没有任何东西可以转换为`Char`, 但`Char`会变成`Int`, `Long`, `Float`, 或者`Double`如果它需要是正确的参数类型。

这样做的原因主要是因为它是 Java 的做法，但部分是因为出错`val d: Double = 0`真的很烦人，因为`0`当然适合 a`Double`没有任何问题，而且类型也没有歧义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T07:32:10.433

也可以看看：

[https://github.com/scala/scala/blob/1c8add14605c4c6e818693d0d9c653407ab69837/src/library/scala/Predef.scala#L319](https://github.com/scala/scala/blob/1c8add14605c4c6e818693d0d9c653407ab69837/src/library/scala/Predef.scala#L319)

默认情况下启用以下隐式转换。

```
implicit def char2int(x: Char): Int = x.toInt 
```

在这种情况下，预期的类型是`Int`。所以`Char`值被转换。

# appcelerator - “[BlackBerry NDK Home] 在指定的 BlackBerry NDK 根路径 '/Applications/bbndk' 下找不到所需的目录 'host'”

> ID：12943764
> 
> 赞同：0
> 
> 时间：2012-10-17T21:34:32.600
> 
> 标签：appcelerator, blackberry-eclipse-plugin

在尝试在 Titanium Studio 中设置 Blackberry SDK 时，我遇到了 Titanium Studio 已过时的问题……显然这种情况经常发生，因为即使他们的网站也比他们自己的程序落后了好几步。（我现在真的不喜欢 Appcelerator。）无论如何，Titanium 会检查以确保`host`和`target`目录存在于您的根 Blackberry SDK 文件夹中。但是，自从进行了此检查后，Blackberry 已经更新了他们的文件结构（我假设？），并且文件夹名称后跟一组数字，因此您会收到以下错误：

`[BlackBerry NDK Home] Could not locate a required directory 'host' under the specified BlackBerry NDK root path '/Applications/bbndk'`

在 Windows 中，这是一条不同的路径，但基本上是相同的错误（这是在 OSX 中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:34:32.600

修复很简单。只需为这些文件夹创建一个别名（在 Mac 中，在 Windows 中为快捷方式），然后将它们命名`host`为`target`. 这解决了这个问题。不幸的是，还有更多内容需要关注，但我想我会分享这个，因为当我搜索解决方案时我在其他任何地方都找不到它。我希望我正确地设置了这个问题/答案......

# javascript - 十六进制到 RGB 转换器

> ID：12943774
> 
> 赞同：4
> 
> 时间：2012-10-17T21:35:19.143
> 
> 标签：javascript, jquery, html

我有用于将 HEX 值转换为 RGB 的 JavaScript，但我想知道是否可以使用 jQuery 调用函数并插入 HTML？

这是JavaScript；

```
function hex2rgb( colour ) {
    var r,g,b;
      if ( colour.charAt(0) == ‘#’ ) {
          colour = colour.substr(1);
    }

    r = colour.charAt(0) + ” + colour.charAt(1);
    g = colour.charAt(2) + ” + colour.charAt(3);
    b = colour.charAt(4) + ” + colour.charAt(5);

    r = parseInt( r,16 );
    g = parseInt( g,16 );
    b = parseInt( b ,16);
    return “rgb(” + r + “,” + g + “,” + b + “)”;
} 
```

### 更新

我正在尝试使用它，因此有一个输入字段，您可以在其中输入十六进制值，按回车键，然后插入 RGB 值（可能在幻影元素或其他东西中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T04:26:36.223

有效的十六进制颜色在“#”之后可以有 3**或6 个字符**

```
function hexToRgb(hex){
    if(/^#([a-f0-9]{3}){1,2}$/.test(hex)){
        if(hex.length== 4){
            hex= '#'+[hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');
        }
        var c= '0x'+hex.substring(1);
        return 'rgb('+[(c>>16)&255, (c>>8)&255, c&255].join(',')+')';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:58:39.010

HTML：

```
<input type="text" id="hex-input" placeholder="hex goes here"/>
<button id="magic-button">PUSH ME!</button>
<div id="rgb-output"></div>​​​​​​​​​​​​ 
```

JS：

```
$(document).ready(function() {
    $("#magic-button").click(function() {
        $("#rgb-output").html(hex2rgb($("#hex-input").val()));
    });

    $("#hex-input").keyup(function(event){
        if(event.keyCode == 13){
            $("#magic-button").click();
        }
    });
});

function hex2rgb( colour ) {
    var r,g,b;
    if ( colour.charAt(0) == '#' ) {
        colour = colour.substr(1);
    }
    if ( colour.length == 3 ) {
        colour = colour.substr(0,1) + colour.substr(0,1) + colour.substr(1,2) + colour.substr(1,2) + colour.substr(2,3) + colour.substr(2,3);
    }
    r = colour.charAt(0) + '' + colour.charAt(1);
    g = colour.charAt(2) + '' + colour.charAt(3);
    b = colour.charAt(4) + '' + colour.charAt(5);
    r = parseInt( r,16 );
    g = parseInt( g,16 );
    b = parseInt( b ,16);
    return 'rgb(' + r + ',' + g + ',' + b + ')';
}​ 
```

[http://jsfiddle.net/2fb3D/](http://jsfiddle.net/2fb3D/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-17T21:39:12.290

您可以将 elementId 传递给函数

```
function hex2rgb( colour, id )
...
   $("#"+id).text("rgb(" + r + "," + g + "," + b + ")")
} 
```

# .net - 具有规范化或非规范化表的性能更高

> ID：12943776
> 
> 赞同：3
> 
> 时间：2012-10-17T21:35:23.173
> 
> 标签：.net, sql, sql-server, performance, normalization

我目前正在开发一个 mvc 应用程序以从现有的 sql server 数据库中读取。数据库是非规范化的 - 我正在考虑修改一些表以在一定程度上对其进行规范化。

这导致与其他开发人员讨论作为读取数据的最有效方式，或者结构是否应该改变。数据将通过 ado.net 使用存储过程读取。我的问题是，在一个表中有多个字段（非规范化）或有几个带有内部连接（规范化）的表来检索数据是否更高效？

我应该提到，表上的操作将是 95% 读取，5% 写入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T22:01:14.933

您应该使用非规范化数据进行数据分析，密集报告使用。出于上述目的，具有非规范化将有助于提高性能。

对于您将要实现的应用程序没有太多了解，对于“标准”客户端-服务器应用程序，您应该使用 DOM 大量类并不断读写数据，我会投票支持规范化数据并尽可能避免维护重复数据。尝试简化表的设计，使它们对您的域模型“感觉舒适”。

因此，简而言之，为密集数据读取规范化更高性能，为密集读取和写入域对象模型类非规范化更高性能（和更全面）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:57:59.353

为报告应用程序保持非规范化。

只要非规范化结构满足您的需求，它就会更快。

如果它是从规范化数据库中填充的，那么一切都很好。即使不是，我仍然不会规范化这个数据库，我会为数据收集创建一个规范化版本，然后使用它来填充您当前的结构。

从一个数据库收集和报告您必须做出的设计妥协，不会花费很长时间比另一台数据库服务器和某种传输方式花费更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:37:43.350

如果您要阅读多于写作，那么非规范化是一个好主意。

如果您将写作多于阅读，则应该规范化您的表格。

如果您不确定，或者将两者混合使用，请尝试对这两种配置进行基准测试或负载测试，看看哪个更适合您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:38:21.400

检索非规范化的数据是一个不错的选择，因为更少的连接数，存储比性能成本便宜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T21:39:07.603

规范化主要是关于消除重复，以便于维护和最小化所需的存储。

非规范化主要是为了提高特定查询的性能，但由于某些数据是重复的（通常是关键数据），它确实使维护变得更加棘手，并增加了存储需求。

# c# - 获取文本文件并随应用程序一起提供

> ID：12943777
> 
> 赞同：1
> 
> 时间：2012-10-17T21:35:34.250
> 
> 标签：c#, asp.net, file, exception-handling, path

我有一个存储一些站点链接的文件。直到现在我使用：

```
string path = Environment.CurrentDirectory + "/forumlinks.txt"; 
```

但我想将文件存储在发布文件夹中，以便我可以更改它，我知道它将为用户永久更改。

所以我改成这样：

```
string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) + @"/forumlinks.txt"; 
```

但我得到一个例外：

> System.IO.FileNotFoundException。

我的问题：这是从发布文件夹中获取文件的正确方法吗？我应该重新考虑一下并将他存放在不同的地方吗？如果是这样，我会很高兴听到这件事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T21:47:45.193

我不明白你为什么需要打电话给

```
System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)) 
```

一点也不。这可以解决问题：

```
AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:46:21.523

好吧，假设前锋 / 是一个错字。如果您已将测试文件添加到您的项目中，请检查它的属性，如果较新则需要复制 / 始终复制以将其放入 bin\Debug 或 bin\Release，以及 exe 和 dll 以及其他 gubbins。

你为什么要这样做，你是否打算改变文件，而不必重建应用程序？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:50:04.783

硬编码代码发布文件夹的路径是危险的。如果您出于某种原因想在调试模式下构建怎么办？当你想部署你的程序时会发生什么？

更好的选择是使用环境的应用程序数据文件夹。这对于每个用户来说都是不同的，因此这意味着每个用户都可以拥有自己的文件版本。

有关如何获取应用程序数据文件夹的详细信息，请参阅[此帖子。](https://stackoverflow.com/questions/915210/how-can-i-get-the-path-of-the-current-users-application-data-folder)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:46:11.347

我犯了一个错误，发现使用这段代码是正确的：

```
string path =  System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location) + "\\fourmlinks.txt"; 
```

如果你输入了正确的文件名，但仍然得到一个异常，这意味着文件不在正确的位置。

# javascript - jquery 对话框加载 url 与 datetimepicker

> ID：12943778
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:35:35.513
> 
> 标签：javascript, jquery

我已经建立了 2 个页面，其中 1 个页面是有一个链接的页面，该链接打开一个对话框并在该对话框中加载另一个页面，一旦对话框打开并加载另一个页面，这个页面就有一个日历，但是当我点击日历时它给出以下错误：无法读取未定义的属性“内联”

我无法解释出了什么问题，就好像我运行日期选择器所在的文件一样，它运行日历，但是一旦我通过打开对话框从第一页执行，它就会出错。

下面是page1和page2的来源：

```
<!--PAGE1.PHP-->

<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-ui.css"  />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>
<script>
function loadurl() {
$(function() {
    $("#dialog").load('page2.php').dialog({modal:true}); 
});
}
</script>
</head>
<body>

<a href="#" onClick="return val()">teste</a>
<div id="dialog" title="Dialog"></div>

</body>
</html>

<!-- PAGE2.PHP -->

<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-ui.css"  />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>

<script>
$(function() {
    $( "#datepicker" ).datepicker();
});
</script>
</head>
<body>
<p>Date: <input type="text" id="datepicker" /></p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T23:29:20.500

代码有一些东西。首先，您需要确定什么`PAGE2.php`是；它是页面的组件还是独立页面。`.load()`将下载的代码直接插入到 DOM 中。因此，您可以将 PAGE2.php 剥离为：

```
<script>
$(function() {
    $( "#datepicker" ).datepicker();
});
</script>
<p>Date: <input type="text" id="datepicker" /></p> 
```

`.load()`或者，您可以通过提供选择器来加载下载页面的一部分：例如`$('#dialog').load('page2.php #datepicker')`。

另一件事是将 PAGE2.php 加载到 DOM 中的语句，即`$("#dialog").load('page2.php').dialog({modal:true})`. 您要做的是先加载页面（可能在后台），然后再使用`.dialog()`. 所以，它应该是这样的：

```
$("#dialog").load('page2.php', function() { $(this).dialog({modal:true})​ })​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T23:06:48.567

## $.load 不在加载页面上运行脚本

该脚本不会在新页面上运行，因为原始页面上的 ready 函数不会触发它。任何用于第二页的脚本都需要在第一页的 $.load 函数的成功侦听器中运行

# mysql - 大型数据集映射到表中

> ID：12943779
> 
> 赞同：0
> 
> 时间：2012-10-17T21:35:37.517
> 
> 标签：mysql, database, postgresql

我的问题有 2 个子问题：

1.  让我们假设这样一种情况，每秒钟我都会收到表示为一组键/值元组的数据。每个值基本上都是一个 64 位计数器。我需要将其保存到数据库中。值的数量为数千。在这数千人中，只有 1% 有实际数据，其他人是空的（人口稀少的集合）。制作几千列的表格有意义吗？或者只是存储为“id、timestamp、key、value”？

2.  如果问题 1 的答案是“千列”，应该使用 mysql/postgres 系列中的哪个 da？

这种情况下的读取模式主要是图表，因此 select 将是一组基于时间戳的数据。所以它是统一的 1/sec 写入和偶尔读取日期/时间范围内的所有数据或数据。

额外的问题，可以使用什么模式将此类数据存储在 NoSQL 数据库中？例如，在 MongoDB 中，可以使用包含仅占整个集合 1% 的文档的统计信息集合。在这种情况下，它如何与 read/map/reduce 一起工作？读取数据与 mysql/postgres 相比如何？

编辑：我的用例与 NewRelic 服务非常相似，但我没有大量的小数据集，而是拥有更大的数据集（在更大的集合中稀疏地填充），但频率更低（用户更少）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:54:00.257

PostgreSQL 将空列存储为位图，但是每行的开销很大。让我们计算一下两种存储方案的存储效率：

```
Average row length for wide table with thousands of columns:
23 bytes row header + 1000*1bit + average 2 bytes of alignment + 4 bytes id
   + 8 bytes timestamp + 10*8 bytes values = 242 bytes

Average number of bytes for storing each value separately:
10 values * (23 bytes row header + 1 byte alignment + 4 bytes id
   + 8 bytes timestamp + 4 bytes key + 8 bytes value) = 480 bytes 
```

因此，千列的效率大约是按键拆分的两倍。单独存储密钥更有效的交叉点[约为 0.45%](http://www.wolframalpha.com/input/?i=%281000%2ap%2a%2823%2B1%2B8%2B4%2B8%29%29%2F%2823%2B1000%2F8+%2B+2+%2B+4+%2B+8+%2B+1000%2ap%2a8%29%3D1)。

然而，这种方法不会扩展得很远。PostgreSQL 中的最大列数限制为 1600。要进一步扩展它，您可以将值垂直拆分为许多表。这也会有一些查询问题，因为结果集也不能大于 1600。

另一种选择是将键值对编码为数组。在这种情况下，表的结构是（id serial, ts timestamptz, keys int2[], values int8[]）。相同 1000 个属性的存储开销，1% 填充因子将是：

```
23 bytes row header + 1 byte alignment + 4 bytes id + 8 bytes timestamp
   + 20 bytes array header + 10*2 byte values + 20 bytes array header
   + 10*8 byte values = 176 bytes per entry 
```

但是，在这种情况下，查询奇异值需要更多的基础设施。

如果需要更好的存储效率或灵活性，可以添加自定义数据类型。

我知道传感器数据的大量列模式已在许多 PostgreSQL 安装中成功使用。至于数据库的选择，我可能会有些偏颇，但我建议使用 PostgreSQL，因为您将拥有更好的工具，如数组、谓词索引和自定义数据类型来重新排列数据存储以提高效率。要记住的最重要的事情是从一开始就使用分区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:48:33.267

当您需要设计具有数千个相同数据类型列的表时，唯一的情况是，您的数据库有其他表需要与这些列具有外键约束。除了拥有数千列之外，充其量是无法管理的。

您还可以使用像[jdbm2](http://code.google.com/p/jdbm2/)这样的持久性地图存储引擎。它专为像您这样的类似用例而设计。

# python - 替换二维 numpy 数组中的向量

> ID：12943782
> 
> 赞同：0
> 
> 时间：2012-10-17T21:35:46.803
> 
> 标签：python, numpy

我有一个从图像加载`numpy array`的形状。`(height, width, 3)`我想`[0, 0, 0]`用特定颜色替换所有黑色像素`[r, g, b]`。有没有`numpy`办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:50:02.973

```
import numpy as np
orig_color = (0, 0, 0)
replacement_color = (r, g, b)

data[(data == orig_color).all(axis = -1)] = replacement_color 
```

# mysql - 添加 MySQL 触发器：不可见（对我而言）语法错误

> ID：12943785
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:35:59.330
> 
> 标签：mysql, triggers, concatenation, concat

**注意：
我*最初*认为我的问题与`CONCAT`，但由于即使我*完全*从查询中消除了确切的错误`CONCAT`，我认为我应该完全覆盖我的原始帖子。**

我正在尝试设置触发器，并不断收到语法错误。
当我尝试这个

```
CREATE TRIGGER set_aka_name 
BEFORE INSERT ON sandbox_person
FOR EACH ROW
BEGIN
  IF (NEW.aka IS NULL) THEN
    SET NEW.aka = 'test value';
  END IF;
END 
```

...我收到此错误：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 6 行的 '' 附近使用正确的语法

尝试*这个*时（没有`IF`peren 的）

```
CREATE TRIGGER set_aka_name 
BEFORE INSERT ON sandbox_person
FOR EACH ROW
BEGIN
  IF NEW.aka IS NULL THEN
    SET NEW.aka = 'test value';
  END IF;
END 
```

...我得到了***同样的***错误

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 6 行的 '' 附近使用正确的语法

它一定*很*简单……但我只是没有看到它。
我在 MySQL 5.1.36 上。
我错过了什么？
任何指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:50:33.827

尝试这个：

```
CREATE TRIGGER set_aka_name 
BEFORE INSERT ON sandbox_person
FOR EACH ROW
BEGIN
  IF NEW.aka IS NULL THEN
    NEW.aka = CONCAT(NEW.fname, ' ', NEW.lname);
  END IF;
END 
```

`IF ()` *函数*和`IF` *语句*之间有区别（[请参阅this](http://dev.mysql.com/doc/refman/5.5/en/if.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T14:38:01.467

尝试先更改分隔符：

```
DELIMITER |

CREATE TRIGGER set_aka_name 
BEFORE INSERT ON sandbox_person
FOR EACH ROW
BEGIN
  IF NEW.aka IS NULL THEN
    SET NEW.aka = 'test value';
  END IF;
END|

DELIMITER ; 
```

也许 MySQL 看到了第一个“;” 作为 CREATE TRIGGER 的结尾

# sql - 在动态查询中使用“IN”运算符

> ID：12943788
> 
> 赞同：0
> 
> 时间：2012-10-17T21:36:03.897
> 
> 标签：sql, sql-server, tsql, dynamic-sql, in-operator

我已经搜索了一段时间，并没有发现与此相关的任何内容。

对于大多数查询，我们大量使用动态方法，如下所示：

```
Declare @ContactId VarChar(8000)

Select @ContactId = '1'

Select * 
From Person.Contact
Where 1 = 1 And 
Case When Len(Ltrim(Rtrim(@ContactId))) = 0 Then 1 Else ContactID End =
Case When Len(Ltrim(Rtrim(@ContactId))) = 0 Then 1 Else @ContactId End 
```

这样，如果参数上有值，查询就会被动态过滤

但是，当尝试具有多个 ID 的相同内容时，问题就出现了，如下所示：

```
Declare @ContactId VarChar(8000)

Select @ContactId = '1,2,3'

Select * 
From Person.Contact
Where 1 = 1 And 
Case When Len(Ltrim(Rtrim(@ContactId))) = 0 Then 1 Else ContactID End In (
Select Case When Len(Ltrim(Rtrim(@ContactId))) = 0 Then 1 Else ( Select id From dbo.SplitString(@ContactId,',') ) End ) 
```

Sql 抛出错误“子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。”

这是完全正常和预期的，我的问题是：

有没有办法动态地进行这种过滤？

我们使用的解决方案是这样的：

```
Declare @Table Table(
    Col1    Int,
    Col2    Int,
    Col3    Int
)

Insert @Table
Select Col1, Col2, Col3
From Person.Contact
Where [many filters except the in clause filters]

If Len(Ltrim(RTrim(@ContactId))) > 0
    Select * 
    From @Table
    Where ContactId In ( Select Id From dbo.SplitString(@ContactId, ',') )
Else 
Select *
From @Table 
```

但是，当查询量很大并且为此提供表变量过大时，这不是一个选择。希望我表达了我的观点，并且有人能帮助我找到解决方案。

PS：`sp_ExecuteSql`在这种情况下，使用也不是一个选项，对不起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:41:13.960

你*应该*如何做到这一点是使用表参数。

但如果你想坚持这种做法。

```
Declare @ContactId VarChar(8000) 

Select @ContactId = '1,2,3'
Select *  
From Person.Contact 
where ',' + @contactID + ',' like '%,'+convert(varchar(50),contactid)+',%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:40:22.540

Try this

```
Select * 
From Person.Contact
Where (
           len(@contactid) > 0 AND 
           ContactID IN (Select id From dbo.SplitString(@ContactId,','))) 
or 1 = 1 
```

# jquery - jQuery选择无序列表中的所有锚元素

> ID：12943795
> 
> 赞同：0
> 
> 时间：2012-10-17T21:36:48.127
> 
> 标签：jquery, html

我有一个具有以下结构的无序列表。

如果我单击列表项 1 中的链接，我希望能够选择列表项 1 下的所有链接（锚标记）并将类更改为“是”。

如何？

```
 <ul>
        <li><div><span><a class="no" href="#">List Item 1</a></span></div>
            <ul>
                <li><div><span><a class="no" href="#">Sub List Item 1</a></span></div></li>
                <li><div><span><a class="no" href="#">Sub List Item 2</a></span></div>
                    <ul>
                        <li><div><span><a class="no" href="#">Sub Sub List Item 1</a></span></div></li>
                        <li><div><span><a class="no" href="#">Sub Sub List Item 2</a></span></div></li>
                        <li><div><span><a class="no" href="#">Sub Sub List Item 3</a></span></div></li>
                    </ul>
                </li>
                <li><div><span><a class="no" href="#">Sub List Item 3</a></span></div></li>
            </ul>
        </li>
        <li><div><span><a class="no" href="#">List Item 2</a></span></div>
            <ul>
                <li><div><span><a class="no" href="#">Sub List Item 5</a></span></div></li>
                <li><div><span><a class="no" href="#">Sub List Item 6</a></span></div></li>
                <li><div><span><a class="no" href="#">Sub List Item 7</a></span></div></li>
            </ul>
        </li>
    </ul> 
```

**回答**

```
 $(href).closest('li').find('a').each(function (index, child) {
            $(child).removeClass('no').addClass('yes');
            //Do more logic here
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:39:30.260

```
$('.no').on('click', function () {
    $(this).closest('li').find('a').andSelf().addClass('yes').removeClass('no');
}); 
```

# jquery - 使 Stratus 2 Beta 与网站 HTML 代码一起工作的困难

> ID：12943796
> 
> 赞同：3
> 
> 时间：2012-10-17T21:36:51.930
> 
> 标签：jquery, html, soundcloud, stratus

我被要求将 Stratus 2 Beta 添加到我们的网站，以便我们可以播放音乐。我去了stratus网站，他们让将他们拥有的代码添加到网站HTML中看起来非常简单，但我无法让它工作。

这就是我所拥有的（包括 jQuery 文件）：

```
<script type="text/javascript" src="jquery.js"></script>    
<script type="text/javascript" src="http://stratus.sc/stratus.js"></script>
<script type="text/javascript">
   $(document).ready(function(){
     $.stratus({
       links: 'http://soundcloud.com/wearelisten/listen_2'
     });
   });
</script> 
```

`</head>`我在和`<body>`脚本之间有这个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T18:27:42.520

我最近遇到了同样的问题，它是使用较旧的 jQuery 库解决的——stratus 使用 $.browser，它在 jQuery 1.9 中被删除。我使用了 1.7.2 版：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

我的播放器终于工作了！您可以在此处查看测试页演示：[www.tworoxdesign.com/EliotCurtis](http://tworoxdesign.com/EliotCurtis)

希望这可以帮助任何有这个问题的人！

马特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:46:52.780

确保你安装了[jQuery](http://jquery.com/)

`<script type="text/javascript" src="jquery.js">`指向`jquery.js`作为 jQuery 主库的文件的点。这就是给你带来问题的原因。

从他们的网站下载 Jquery 产品，解压缩并上传到您的网站（我将我的放在 jquery 文件夹中）并将其更改`src="jquery.js"`为`src="jquery/jquery.js"`（假设*jquery*是您的文件夹）

或者

参考 Google 托管的，将标签更改为方法 1，如“*[使用 Google 托管您的 jQuery（或其他）JavaScript 库](http://www.dynamicdrive.com/forums/entry.php?11-Using-Google-to-host-your-jQuery-%28or-other%29-JavaScript-libraries)*”中所述：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T17:00:44.863

你使用的是什么浏览器？如果它是 Internet Explorer 则无法正常工作。检查 -> [stratus.sc 和 IE](https://stackoverflow.com/questions/12821741/stratus-sc-and-ie)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T01:35:18.347

始终将脚本放在页面底部的结束正文标记之前。

看起来您缺少 jQuery 字符串选择器。将您的代码更新为以下示例。

```
<script type="text/javascript" src="jquery.js"></script>    
<script type="text/javascript" src="http://stratus.sc/stratus.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $('body').stratus({
            links: 'http://soundcloud.com/wearelisten/listen_2'
        });
    });
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-13T15:13:12.563

有点兴奋，似乎有两个问题要让它与项目网站上的示例一起使用。

正如 MDizzleDogg 所说... .browser 已弃用。您可以做的是 A) 使用旧版本的 jQuery。或 B) 使用此处找到的迁移插件[。](https://github.com/jquery/jquery-migrate/)

下一个问题出现在自定义示例中。它说：

```
<script type="text/javascript">
$(document).ready(function(){
 $stratus({
  auto_play: true,
  download: false,
  links: 'http://soundcloud.com/qotsa',
  random: true
 });
});
</script> 
```

问题是 javascript 认为 $stratus 是一个变量并且它从未被定义。要修复它，只需将 $stratus 更改为 $.stratus

我希望这是有道理的。

# javascript - JSON 结构的输出值

> ID：12943798
> 
> 赞同：0
> 
> 时间：2012-10-17T21:37:06.747
> 
> 标签：javascript, jquery, ajax, json

该函数从服务器获取的数据：

```
{
   "COLUMNS":[
      "ID",
      "NAME",
      "LASTNAME"
   ],
   "DATA":[
      [
         "1",
         "John",
         "Lewis"
      ],
      [
         "2",
         "Peter",
         "Gabriel"
      ],
      [
         "3",
         "Susan",
         "Smith"
      ]
   ]
} 
```

JavaScript

```
<script type="text/javascript"> 
    $(document).ready(function(){
            $('#showteams').click(function() {
                $.ajax({
        url: "authenticationService.cfc?method=getAllTeams&returnformat=JSON&queryformat=column",
        dataType: 'json',

        success:function(data) {

            alert('data that function gets from the server:' + '\n' + '\n' + data + '\n' + '\n' + 
            "everything is listed here");

                    $.each(data.DATA, function(i,team){

                        $('#teamList').append('<li><a href="#">' + team + '</a>');
                    });

                }});
            });
            $('#teams').show();
            $('#teamList').fadeIn(1200);
            $(this).attr('disabled', 'disabled');
        });
</script> 
```

虽然我的代码实际上可以工作，但至少在某种程度上它会输出这样的值

```
1,John,Lewis
2,Peter,Gabriel
3,Susan,Smith 
```

现在我想让它更灵活，以其他方式迭代数据并显示它

这是用户的名字：**NAME**姓氏：带有数字**ID的****LASTNAME** 这是用户的名字：**John**姓氏：**Lewis**，带有数字**1** 等

 ******我知道它可以用**for**以某种方式完成，但无法解决，我已经尝试了我能想到的一切 :( 我非常感谢你在这方面的帮助，特别是考虑到 javascript 并不是我真正的东西。

**编辑：现在我在服务器端有一个问题:(我想要实现的是输出数据说第一次点击记录从1到10，第二次点击记录从11-20.etc在客户端jquery代码将传递数据例如 startrow 数据：{ startrow：“1”，maxrow：“10”}，在冷融合组件中 cfloop 应该可以解决问题，但由于某种原因我无法返回正确的 JSON 格式。我已经尝试 cfloop over query put data to数组以及结构数组和序列化JSON，但未能对其进行排序。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:40:05.330

`team`是一个数组，使用数组表示法和索引访问它的值。`team[0]` `team[1]` `team[2]`用于 id、名字、姓氏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:48:57.833

上下文中的团队有一个数组，该数组又是一个数组..所以你需要有两个循环..一个用于每个项目数组，另一个循环用于数组内的项目..试试这个

```
$.each(data.DATA, function(i,team){ 
     $.each( team , function(key , value){
         alert(value)
     });         
 }); 
```

[小提琴](http://jsfiddle.net/sushanth009/Gbrx6/)******

# templates - Joomla 模板 - 没有模块时如何自动隐藏侧边栏？

> ID：12943800
> 
> 赞同：0
> 
> 时间：2012-10-17T21:37:39.507
> 
> 标签：templates, joomla, sidebar

我正在 Joomla 3.0 中创建一个新模板，但边栏出现问题。我想配置一个灵活的侧边栏，就像 Prostar 模板中的那个和其他，当侧边栏中没有模块时可以灵活地隐藏。

您可以在下面的示例中看到我的意思。图 1

![带模块](../Images/dfcccbce960744d6873549d1a6a6c9d5.png)

图 2

![无模块](../Images/4fcf6d2f5067ab761501b5e4a42a5a7c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T22:24:43.457

使用 index.php 中的 countModules() 函数。如果没有模块隐藏列并显示更宽的容器，例如

```
<?php if($this->countModules('left')) : ?>
    <div id="divLeft">show some stuff</div>
    <div id="divContent">show some stuff</div>
<?php else; ?>
    <div id="divContentWide">show a wider version of the content area</div>
<?php endif; ?> 
```

有 divLeft 和 divContent 25% 和 75% 并且有 divContentWide 100%

还可以查看安装中的 Beez3 模板，了解 countModules 的另一种用法

# jquery - 在 Wordpress 中，如何将帖子限制为仅一个类别复选框？

> ID：12943802
> 
> 赞同：3
> 
> 时间：2012-10-17T21:37:42.907
> 
> 标签：jquery, wordpress

发布时，我希望用户只能选择一个类别。我怎样才能实现这样的目标？

对不起，我应该更清楚。在选中复选框以选择帖子将进入的类别时，我希望它充当单选按钮，您可以在其中仅选择一个选项。

jQuery 将是一个快速解决方案，并在网上找到了 jquery 以下代码，我正在尝试找出将其添加到 post.php 头标签的位置：

```
var $t = jQuery.noConflict();
$t(document).ready(function() {   
  $t('#categorychecklist li input[type="checkbox"]').each(function(){
    $t(this).change(function(){
        //alert( $t('#categorychecklist li input[checked="checked"]').parent().html() );
        $t('#categorychecklist li input').attr('checked','');
        $t(this).attr('checked','checked');
    })
  })
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T21:35:37.323

我也在寻找解决此类问题的好方法。本主题显示了一个插件（php）变体，它将类别转换为单选按钮：[http](http://wordpress.org/support/topic/select-only-one-category-1) ://wordpress.org/support/topic/select-only-one-category-1但它不做任何类型的任何验证，所以它可以通过 webkit 或 firebug (type="radio" => type="checkbox") 编辑 html 来操作，并且您可以再次为帖子创建许多类别，并且 js 脚本也容易受到 firebug 操作的影响。

编辑：我找到了一个很好的解决方案，可以将类别（和任何其他分类）变成一个不能被欺骗的下拉列表： [http ://wordpress.org/extend/plugins/acategory-dropdown-list/](http://wordpress.org/extend/plugins/acategory-dropdown-list/)

@dpassage 我似乎无法发表评论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T02:12:43.143

因此，假设您想要选择一个并且恰好选择一个类别，我会考虑将输入输出类型从复选框更改为单选按钮。您可以做到这一点，而不会使管理区域`<head />`变得比现在更加混乱。以下是您可以添加到函数文件中的几种方法：

```
/**
 * Add scripts (JavaScript, etc.) to the admin area
 */
public function addAdminScripts()
{
    if( is_admin() )
    {
        wp_register_script( 'your-script-id', get_template_directory() . '/inc/javascript/jquery.script.name.js', array( 'jquery' ) );
        wp_enqueue_script( 'your-script-id' );
    }
}

/**
 * Add CSS files to the admin area
 */
public function addAdminStyles()
{
    if( is_admin() )
    {
        wp_enqueue_style( 'your-css-id' );
        wp_enqueue_style( 'your-css-id', get_template_directory(). '/inc/css/your_custom_base.css' );
    }
} 
```

该条件`is_admin()`将确保文件仅包含在管理区域中，您可以扩展该条件以专门检查发布/编辑屏幕。这确保您可以包含主题目录中的 js/css 文件（或者，如果您将其包装在插件中，则可以将其保存到插件目录中）。无论哪种方式，您在管理区域的侵入性都会降低。

现在，就您的实际脚本而言，Alex 有一个良好的开端，但您应该更进一步，将输入类型实际更改为单选按钮，以便您继承它们的自然行为，而不是强制复选框像单选按钮一样工作. 这是关于 SO 的相关帖子，这是一个非常好的参考，可以准确地说明[如何使用 jquery 更改元素类型](https://stackoverflow.com/a/8584217/916011)（**奖励**：所选答案的作者将其包装成一个不错的插件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T22:34:48.663

为什么不把它像这样放在**functions.php**中；在管理区域注册它？

```
//All the rest of your php stuff above ^^
add_action( 'admin_head', 'jquery_for_categories' );

function jquery_for_categories(){ ?>
    <script type="text/javascript">
      var $t = jQuery.noConflict();
      $t(document).ready(function() {   
        $t('#categorychecklist li input[type="checkbox"]').each(function(){
          $t(this).change(function(){
            //alert( $t('#categorychecklist li input[checked="checked"]').parent().html() );
            $t('#categorychecklist li input').attr('checked','');
            $t(this).attr('checked','checked');
          })
        })
      });
    </script>
} <? 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-20T20:52:39.733

我尝试使用许多建议的单选按钮插件，但它破坏了 ACF 的任何功能，因此保留复选框是必不可少的。

在我的示例中，大多数代码改编自 [jQuery 复选框更改和单击事件](https://stackoverflow.com/questions/7031226/jquery-checkbox-change-and-click-event)&[使父类别不可选择](https://wordpress.stackexchange.com/questions/22836/make-parent-categories-not-selectable)

在我的**functions.php**`admin_footer-post`中，我为and添加操作`admin_footer-post-new`（否则新帖子不会受到影响）。我相信您可以将其添加到标题中，但不要忘记使用 .ready() 更新 jquery

无论如何，代码非常简单：如果它是一篇文章，则在更改类别复选框时删除所有选中并应用单击的检查。

```
add_action( 'admin_footer-post.php', 'only_allow_one_checkbox' );
add_action( 'admin_footer-post-new.php', 'only_allow_one_checkbox' );

function only_allow_one_checkbox()
{
    global $post_type;

    if ( 'post' != $post_type )
        return;
    ?>
        <script type="text/javascript">
            $('#categorychecklist>li>label input').change(function() {
                if(this.checked) {
                    $('#categorychecklist>li>label input').prop("checked", false);
                    $(this).prop("checked", true);
                }
            });
        </script>
    <?php
} 
```

到目前为止，它很容易实现并且没有遇到任何问题。

# mesh - 在 VTK 中创建 3D 网格

> ID：12943808
> 
> 赞同：2
> 
> 时间：2012-10-17T21:38:14.363
> 
> 标签：mesh, vtk

我正在尝试使用 VTK 创建 3D 网格。VTK 似乎提供了多种方法来创建表示 3D 对象表面的网格。填充对象似乎更加困难。我想这样做的原因是将输出作为实体而不是气球传递给 FEM 工具。

目前，我正在玩球体，似乎有很多方法可以为 3D 对象的表面创建网格。我似乎无法做的是在体积内创建一个带有点的球体。该类`vtkUnstructuredGrid`允许我表示这样一个对象，但我似乎无法以与`vtkPolyData`.

这是 VTK 的基本限制还是我只是没有看到正确的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-13T19:43:25.427

正如您所说： *我想做的是将输出作为实体而不是气球传递给 FEM 工具*

我假设您有自己格式的 FEM 网格，并且您想将其可视化。为此，您可以将 FEM 网格转换为[vtkUnstructuredGrid](http://www.vtk.org/doc/nightly/html/classvtkUnstructuredGrid.html)修改此处描述的代码：

[如何将网格转换为 VTK 格式？](https://stackoverflow.com/questions/20146421/how-to-convert-a-mesh-to-vtk-format/20146620#20146620)

# mysql - 表达：“如果行存在，则从表1中删除并插入到表2中。返回成功。” 在我的 SQL

> ID：12943813
> 
> 赞同：0
> 
> 时间：2012-10-17T21:38:20.747
> 
> 标签：mysql

我有两个表，我希望在其中发生以下逻辑：

```
if (any row with a specific id exist in table1)
{
    1\. Delete the row from table1
    2\. insert some data into the table2 with the id as one of the values
    3\. return success somehow (for me to verify in java)
}
else
{
    return fail
} 
```

我敢肯定这可以用巧妙的方式表达，但我不知道如何！有人可以帮我从我的程序思维方式中翻译出来吗？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:50:03.950

根据您使用的语言（java？）：

```
PreparedStatement stmt = conn.prepareStatement("select * from table1 where id = ?");
stmt.setInt(1, id);
ResultSet rs = stmt.executeQuery();
if (rs.first()) {
    // same for insert and delete
    insert into table2 (id, col2, col3) values(?, ?, ?);
    delete from table1 where id = ?;
    return true;
} else {
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T13:52:00.863

经过一番研究，我发现[了这篇文章](https://stackoverflow.com/questions/3164505/mysql-insert-record-if-not-exists-in-table)。我稍微修改了迈克的回答，最后得到了这个查询：

```
START TRANSACTION;
INSERT INTO table1(col1, col2, col3, id)
SELECT * FROM (SELECT 'value1', 'value2,'valu3', 'id') AS tmp
WHERE EXISTS (
    SELECT id FROM table2 WHERE id='123'
    ) LIMIT 1;
DELETE FROM table2 WHERE id='123';
COMMIT; 
```

如果 id 存在于 table2 中，则插入将在 table1 中执行并从表 2 中删除。否则，将不会执行插入并且删除将找不到任何 id 为 123 的行 - 因此不会被删除。我还使用[START TRANSACTION 和 COMMIT](http://dev.mysql.com/doc/refman/5.0/en/commit.html)来临时禁用 AUTO COMMIT 模式，从而确保要么所有事务都发生，要么不发生（在失败的情况下）。然后，我可以在 Java 中检查受影响的行数，并查看更新是否执行。

# playorm - 是否支持 UUID 作为 playORM 的 id 类型？

> ID：12943816
> 
> 赞同：0
> 
> 时间：2012-10-17T21:38:29.060
> 
> 标签：playorm

当我尝试使用 UUID 字段映射类时出现以下异常。日期类型的字段也是如此。我的实体需要具有这些值的字段，有什么可能的解决方案？

```
java.lang.RuntimeException: Failure scanning class(see chained exception)=class com.s1mbi0se.dmp.da.bean.User
    at com.alvazan.orm.layer0.base.MyClassAnnotationDiscoveryListener.scanClass(MyClassAnnotationDiscoveryListener.java:44)
    at com.alvazan.orm.layer0.base.BaseEntityManagerFactoryImpl.rescan(BaseEntityManagerFactoryImpl.java:83)
    at com.alvazan.orm.layer0.base.BaseEntityManagerFactoryImpl.setup(BaseEntityManagerFactoryImpl.java:131)
    at com.alvazan.orm.impl.bindings.BootstrapImpl.createInstance(BootstrapImpl.java:51)
    at com.alvazan.orm.api.base.Bootstrap.create(Bootstrap.java:53)
    at com.alvazan.orm.api.base.Bootstrap.create(Bootstrap.java:48)
    at com.alvazan.orm.api.base.Bootstrap.create(Bootstrap.java:45)
    at com.alvazan.orm.api.base.Bootstrap.create(Bootstrap.java:41)
    at com.s1mbi0se.dmp.da.dao.PlayOrmConfiguration.init(PlayOrmConfiguration.java:39)
    at com.s1mbi0se.dmp.da.dao.TestUserDao.testUserOperations(TestUserDao.java:18)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.RuntimeException: Failure scanning field=private java.util.Date com.s1mbi0se.dmp.da.bean.User.birthDate for class=User
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.inspectField(ScannerForClass.java:179)
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.scanFields(ScannerForClass.java:172)
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.scanSingle(ScannerForClass.java:111)
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.addClass(ScannerForClass.java:67)
    at com.alvazan.orm.layer0.base.MyClassAnnotationDiscoveryListener.scanClass(MyClassAnnotationDiscoveryListener.java:42)
    ... 32 more
Caused by: java.lang.IllegalArgumentException: No converter found for field='birthDate' in class=class com.s1mbi0se.dmp.da.bean.User.  You need to either add one of the @*ToOne annotations, @Embedded, @Transient or add your own converter calling EntityMgrFactory.setup(Map<Class, Converter>) which will then work for all fields of that type OR add @Column(customConverter=YourConverter.class) or finally if we missed a standard converter, we need to add it in file InspectorField.java in the constructor and it is trivial code(and we can copy the existing pattern)
    at com.alvazan.orm.impl.meta.scan.ScannerForField.processColumn(ScannerForField.java:173)
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.inspectFieldImpl(ScannerForClass.java:205)
    at com.alvazan.orm.impl.meta.scan.ScannerForClass.inspectField(ScannerForClass.java:177)
    ... 36 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T22:45:45.920

对于日期，我们使用 joda-time，因为日期和日历非常有问题。Jdk7 应该集成 joda-time，因为它修复了所有错误。您可以使用 LocalDate 和 LocalDateTime 等。

对于任何东西，您都可以添加自己的转换器。第一次通过Bootstrap创建NoSqlEntityManagerFactory时，有一个Map

```
public synchronized static NoSqlEntityManagerFactory create(DbTypeEnum type, Map<String, Object> properties, Map<Class, Converter> converters, ClassLoader cl) 
```

那里要填写的重要地图是

```
Map<Class, Converter> converters 
```

您可以提供 Class=Date.class 和 Converter=new YourConverterForDate()

您也可以为 UUID 提供一个。如果我们在转换器的标准映射中找不到转换器，则使用此转换器映射。同时，为 Date 和 TimeUUID 打开两个问题，我将添加它们。另外，请注意 java 的 TimeUUID，因为它不是 X 类型（我不记得 X 应该是 1 还是 4），这使得它不是唯一的:(.....还有另一个创建唯一 TimeUUID 的 java 库在网上....等我有空的时候再看看。

院长

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:11:33.053

Playorm 的 1.4.1 版本现在支持 UUID (com.eaio.uuid)。

[https://github.com/deanhiller/playorm/wiki/Release-details](https://github.com/deanhiller/playorm/wiki/Release-details)

# java - Scala foreach 返回

> ID：12943817
> 
> 赞同：1
> 
> 时间：2012-10-17T21:38:39.240
> 
> 标签：java, scala, foreach, return

你如何使这种方法发挥作用？

```
def filled(b: Board): Board = {
  b.next foreach { n =>
    if (n.filled) n
    else filled(n)
  }
} 
```

我需要它在第一次填充 n (n.filled == true) 后返回，就像在 Java 中一样。

现在我得到：

```
chess-knight.scala:72: error: type mismatch;
 found   : Unit
 required: this.Board
    b.next foreach { n =>
           ^
one error found 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:44:54.110

这不是你需要的吗？

```
def filled(b: Board): Board = b.next find {_.filled} get 
```

假设它`b.next`是 a`Seq[Board]`并且总是至少有一个`filled` `Board`。

如果你~~坚持纯粹的功能性~~更喜欢利用模式匹配的方法`List`：

```
def filled(b: Board): Board = {
  b.next match {
    case n :: _ if(n.filled) => n
    case _ :: rest => filled(rest)
    case Nil => throw NoSuchElementException
} 
```

# python - 如何漂亮地打印 JSON 文件？

> ID：12943819
> 
> 赞同：1570
> 
> 时间：2012-10-17T21:38:43.023
> 
> 标签：python, json, formatting, pretty-print

我有一个 JSON 文件，我想把它弄得一团糟。在 Python 中最简单的方法是什么？

我知道 PrettyPrint 需要一个“对象”，我认为它可以是一个文件，但我不知道如何传入文件。仅使用文件名是行不通的。

* * *

## 回答 #1

> 赞同：2405
> 
> 时间：2012-10-17T21:54:12.800

该[`json`模块](https://docs.python.org/3/library/json.html)[`dump`](https://docs.python.org/3/library/json.html#json.dump)已经在and[`dumps`](https://docs.python.org/3/library/json.html#json.dumps)函数中实现了一些基本的漂亮打印，`indent`参数指定要缩进多少个空格：

```
>>> import json
>>>
>>> your_json = '["foo", {"bar":["baz", null, 1.0, 2]}]'
>>> parsed = json.loads(your_json)
>>> print(json.dumps(parsed, indent=4, sort_keys=True))
[
    "foo", 
    {
        "bar": [
            "baz", 
            null, 
            1.0, 
            2
        ]
    }
] 
```

要解析文件，请使用[`json.load()`](https://docs.python.org/3/library/json.html#json.load)：

```
with open('filename.txt', 'r') as handle:
    parsed = json.load(handle) 
```

* * *

## 回答 #2

> 赞同：413
> 
> 时间：2015-08-26T13:42:04.847

您可以在命令行上执行此操作：

```
python3 -m json.tool some.json 
```

（正如问题评论中已经提到的，感谢@Kai Petzke 的python3 建议）。

实际上，就命令行上的 json 处理而言，python 并不是我最喜欢的工具。对于简单漂亮的打印是可以的，但如果你想操纵 json 它可能会变得过于复杂。您很快就需要编写一个单独的脚本文件，您最终可能会得到键为 u"some-key" (python unicode) 的映射，这使得选择字段更加困难，并且并没有真正朝着漂亮的方向发展-印刷。

您还可以使用[jq](https://stedolan.github.io/jq/)：

```
jq . some.json 
```

并且您可以获得颜色作为奖励（并且更容易扩展）。

附录：一方面关于使用 jq 处理大型 JSON 文件，另一方面有一个非常大的 jq 程序的评论中存在一些混淆。为了漂亮地打印由单个大型 JSON 实体组成的文件，实际限制是 RAM。对于包含单个真实数据数组的 2GB 文件的漂亮打印，漂亮打印所需的“最大驻留集大小”为 5GB（无论使用 jq 1.5 还是 1.6）。还要注意 jq 可以在 python 之后使用`pip install jq`。

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2018-01-05T10:12:13.560

您可以使用内置模块[pprint (https://docs.python.org/3.9/library/pprint.html)](https://docs.python.org/3/library/pprint.html#pprint.pprint)。

如何使用 json 数据读取文件并将其打印出来。

```
import json
import pprint

json_data = None
with open('file_name.txt', 'r') as f:
    data = f.read()
    json_data = json.loads(data)

print(json_data)
{"firstName": "John", "lastName": "Smith", "isAlive": "true", "age": 27, "address": {"streetAddress": "21 2nd Street", "city": "New York", "state": "NY", "postalCode": "10021-3100"}, 'children': []}

pprint.pprint(json_data)
{'address': {'city': 'New York',
             'postalCode': '10021-3100',
             'state': 'NY',
             'streetAddress': '21 2nd Street'},
 'age': 27,
 'children': [],
 'firstName': 'John',
 'isAlive': True,
 'lastName': 'Smith'} 
```

输出不是有效的 json，因为 pprint 使用单引号，而 json 规范需要双引号。

如果要将漂亮打印格式的 json 重写为文件，则必须使用[pprint.pformat](https://docs.python.org/3.9/library/pprint.html)。

```
pretty_print_json = pprint.pformat(json_data).replace("'", '"')

with open('file_name.json', 'w') as f:
    f.write(pretty_print_json) 
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2015-08-27T10:30:08.437

# Pygmentize + Python json.tool = 带有语法高亮的漂亮打印

Pygmentize 是一个杀手级工具。[看到这个。](https://stackoverflow.com/a/27501509/2670370)

我将 python json.tool 与 pygmentize 结合使用

```
echo '{"foo": "bar"}' | python -m json.tool | pygmentize -l json 
```

有关 pygmentize 安装说明，请参见上面的链接。

下图是一个演示：

[![演示](../Images/a03d95109a8f1dfbbca94b13c3a83e29.png)](https://i.stack.imgur.com/bpTen.png)

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2016-06-10T21:25:49.367

使用这个函数，不必费力记住你的 JSON 是 a`str`还是`dict`再 - 看看漂亮的打印：

```
import json

def pp_json(json_thing, sort=True, indents=4):
    if type(json_thing) is str:
        print(json.dumps(json.loads(json_thing), sort_keys=sort, indent=indents))
    else:
        print(json.dumps(json_thing, sort_keys=sort, indent=indents))
    return None

pp_json(your_json_string_or_dict) 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2019-04-09T18:27:54.150

使用 pprint：[https ://docs.python.org/3.6/library/pprint.html](https://docs.python.org/3.6/library/pprint.html)

```
import pprint
pprint.pprint(json) 
```

`print()`相比`pprint.pprint()`

```
print(json)
{'feed': {'title': 'W3Schools Home Page', 'title_detail': {'type': 'text/plain', 'language': None, 'base': '', 'value': 'W3Schools Home Page'}, 'links': [{'rel': 'alternate', 'type': 'text/html', 'href': 'https://www.w3schools.com'}], 'link': 'https://www.w3schools.com', 'subtitle': 'Free web building tutorials', 'subtitle_detail': {'type': 'text/html', 'language': None, 'base': '', 'value': 'Free web building tutorials'}}, 'entries': [], 'bozo': 0, 'encoding': 'utf-8', 'version': 'rss20', 'namespaces': {}}

pprint.pprint(json)
{'bozo': 0,
 'encoding': 'utf-8',
 'entries': [],
 'feed': {'link': 'https://www.w3schools.com',
          'links': [{'href': 'https://www.w3schools.com',
                     'rel': 'alternate',
                     'type': 'text/html'}],
          'subtitle': 'Free web building tutorials',
          'subtitle_detail': {'base': '',
                              'language': None,
                              'type': 'text/html',
                              'value': 'Free web building tutorials'},
          'title': 'W3Schools Home Page',
          'title_detail': {'base': '',
                           'language': None,
                           'type': 'text/plain',
                           'value': 'W3Schools Home Page'}},
 'namespaces': {},
 'version': 'rss20'} 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2017-03-28T14:58:37.087

为了能够从命令行漂亮地打印并能够控制缩进等，您可以设置类似于以下的别名：

```
alias jsonpp="python -c 'import sys, json; print json.dumps(json.load(sys.stdin), sort_keys=True, indent=2)'" 
```

然后以下列方式之一使用别名：

```
cat myfile.json | jsonpp
jsonpp < myfile.json 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-01-23T08:19:48.013

这是一个简单的示例，它在 Python 中以一种很好的方式将 JSON 打印到控制台，而不需要 JSON 作为本地文件在您的计算机上：

```
import pprint
import json 
from urllib.request import urlopen # (Only used to get this example)

# Getting a JSON example for this example 
r = urlopen("https://mdn.github.io/fetch-examples/fetch-json/products.json")
text = r.read() 

# To print it
pprint.pprint(json.loads(text)) 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2019-10-11T15:08:35.400

```
def saveJson(date,fileToSave):
    with open(fileToSave, 'w+') as fileToSave:
        json.dump(date, fileToSave, ensure_ascii=True, indent=4, sort_keys=True) 
```

它可以显示或保存到文件中。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2019-10-02T05:09:44.787

你可以试试[**pprintjson**](https://github.com/clarketm/pprintjson)。

* * *

### 安装

```
$ pip3 install pprintjson 
```

### 用法

使用 pprintjson CLI 从文件中漂亮地打印 JSON。

```
$ pprintjson "./path/to/file.json" 
```

使用 pprintjson CLI 从标准输入漂亮地打印 JSON。

```
$ echo '{ "a": 1, "b": "string", "c": true }' | pprintjson 
```

使用 pprintjson CLI 从字符串中漂亮地打印 JSON。

```
$ pprintjson -c '{ "a": 1, "b": "string", "c": true }' 
```

从缩进为 1 的字符串中漂亮地打印 JSON。

```
$ pprintjson -c '{ "a": 1, "b": "string", "c": true }' -i 1 
```

漂亮地从字符串打印 JSON 并将输出保存到文件 output.json。

```
$ pprintjson -c '{ "a": 1, "b": "string", "c": true }' -o ./output.json 
```

### 输出

[![在此处输入图像描述](../Images/ab803fe6fd7d386e43250b225a110161.png)](https://i.stack.imgur.com/vsdBU.png)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-04-26T07:24:10.917

我认为最好先解析json，以避免错误：

```
def format_response(response):
    try:
        parsed = json.loads(response.text)
    except JSONDecodeError:
        return response.text
    return json.dumps(parsed, ensure_ascii=True, indent=4) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-11-12T22:36:15.860

我有一个类似的要求来转储 json 文件的内容以进行日志记录，这既快速又简单：

```
print(json.dumps(json.load(open(os.path.join('<myPath>', '<myjson>'), "r")), indent = 4 )) 
```

如果你经常使用它，那么把它放在一个函数中：

```
def pp_json_file(path, file):
    print(json.dumps(json.load(open(os.path.join(path, file), "r")), indent = 4)) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-02-13T00:16:33.263

希望这对其他人有帮助。

如果出现无法 json 可序列化的错误，则上述答案将不起作用。如果您只想保存它以便人类可读，那么您需要在字典的所有非字典元素上递归调用字符串。如果您想稍后加载它，然后将其保存为泡菜文件，然后加载它（例如`torch.save(obj, f)`工作正常）。

这对我有用：

```
#%%

def _to_json_dict_with_strings(dictionary):
    """
    Convert dict to dict with leafs only being strings. So it recursively makes keys to strings
    if they are not dictionaries.

    Use case:
        - saving dictionary of tensors (convert the tensors to strins!)
        - saving arguments from script (e.g. argparse) for it to be pretty

    e.g.

    """
    if type(dictionary) != dict:
        return str(dictionary)
    d = {k: _to_json_dict_with_strings(v) for k, v in dictionary.items()}
    return d

def to_json(dic):
    import types
    import argparse

    if type(dic) is dict:
        dic = dict(dic)
    else:
        dic = dic.__dict__
    return _to_json_dict_with_strings(dic)

def save_to_json_pretty(dic, path, mode='w', indent=4, sort_keys=True):
    import json

    with open(path, mode) as f:
        json.dump(to_json(dic), f, indent=indent, sort_keys=sort_keys)

def my_pprint(dic):
    """

    @param dic:
    @return:

    Note: this is not the same as pprint.
    """
    import json

    # make all keys strings recursively with their naitve str function
    dic = to_json(dic)
    # pretty print
    pretty_dic = json.dumps(dic, indent=4, sort_keys=True)
    print(pretty_dic)
    # print(json.dumps(dic, indent=4, sort_keys=True))
    # return pretty_dic

import torch
# import json  # results in non serializabe errors for torch.Tensors
from pprint import pprint

dic = {'x': torch.randn(1, 3), 'rec': {'y': torch.randn(1, 3)}}

my_pprint(dic)
pprint(dic) 
```

输出：

```
{
    "rec": {
        "y": "tensor([[-0.3137,  0.3138,  1.2894]])"
    },
    "x": "tensor([[-1.5909,  0.0516, -1.5445]])"
}
{'rec': {'y': tensor([[-0.3137,  0.3138,  1.2894]])},
 'x': tensor([[-1.5909,  0.0516, -1.5445]])} 
```

我不知道为什么返回字符串然后打印它不起作用，但似乎你必须将转储直接放在打印语句中。请注意`pprint`，因为它已经被建议已经工作了。请注意，并非所有对象都可以转换为 dict ，`dict(dic)`这就是为什么我的一些代码会检查这种情况。

语境：

我想保存 pytorch 字符串，但我一直收到错误消息：

```
TypeError: tensor is not JSON serializable 
```

所以我对上面进行了编码。请注意，是的，在您使用的 pytorch 中，`torch.save`pickle 文件不可读。检查此相关帖子：[https ://discuss.pytorch.org/t/typeerror-tensor-is-not-json-serializable/36065/3](https://discuss.pytorch.org/t/typeerror-tensor-is-not-json-serializable/36065/3)

* * *

PPrint 也有缩进参数，但我不喜欢它的外观：

```
 pprint(stats, indent=4, sort_dicts=True) 
```

输出：

```
{   'cca': {   'all': {'avg': tensor(0.5132), 'std': tensor(0.1532)},
               'avg': tensor([0.5993, 0.5571, 0.4910, 0.4053]),
               'rep': {'avg': tensor(0.5491), 'std': tensor(0.0743)},
               'std': tensor([0.0316, 0.0368, 0.0910, 0.2490])},
    'cka': {   'all': {'avg': tensor(0.7885), 'std': tensor(0.3449)},
               'avg': tensor([1.0000, 0.9840, 0.9442, 0.2260]),
               'rep': {'avg': tensor(0.9761), 'std': tensor(0.0468)},
               'std': tensor([5.9043e-07, 2.9688e-02, 6.3634e-02, 2.1686e-01])},
    'cosine': {   'all': {'avg': tensor(0.5931), 'std': tensor(0.7158)},
                  'avg': tensor([ 0.9825,  0.9001,  0.7909, -0.3012]),
                  'rep': {'avg': tensor(0.8912), 'std': tensor(0.1571)},
                  'std': tensor([0.0371, 0.1232, 0.1976, 0.9536])},
    'nes': {   'all': {'avg': tensor(0.6771), 'std': tensor(0.2891)},
               'avg': tensor([0.9326, 0.8038, 0.6852, 0.2867]),
               'rep': {'avg': tensor(0.8072), 'std': tensor(0.1596)},
               'std': tensor([0.0695, 0.1266, 0.1578, 0.2339])},
    'nes_output': {   'all': {'avg': None, 'std': None},
                      'avg': tensor(0.2975),
                      'rep': {'avg': None, 'std': None},
                      'std': tensor(0.0945)},
    'query_loss': {   'all': {'avg': None, 'std': None},
                      'avg': tensor(12.3746),
                      'rep': {'avg': None, 'std': None},
                      'std': tensor(13.7910)}} 
```

相比于：

```
{
    "cca": {
        "all": {
            "avg": "tensor(0.5144)",
            "std": "tensor(0.1553)"
        },
        "avg": "tensor([0.6023, 0.5612, 0.4874, 0.4066])",
        "rep": {
            "avg": "tensor(0.5503)",
            "std": "tensor(0.0796)"
        },
        "std": "tensor([0.0285, 0.0367, 0.1004, 0.2493])"
    },
    "cka": {
        "all": {
            "avg": "tensor(0.7888)",
            "std": "tensor(0.3444)"
        },
        "avg": "tensor([1.0000, 0.9840, 0.9439, 0.2271])",
        "rep": {
            "avg": "tensor(0.9760)",
            "std": "tensor(0.0468)"
        },
        "std": "tensor([5.7627e-07, 2.9689e-02, 6.3541e-02, 2.1684e-01])"
    },
    "cosine": {
        "all": {
            "avg": "tensor(0.5945)",
            "std": "tensor(0.7146)"
        },
        "avg": "tensor([ 0.9825,  0.9001,  0.7907, -0.2953])",
        "rep": {
            "avg": "tensor(0.8911)",
            "std": "tensor(0.1571)"
        },
        "std": "tensor([0.0371, 0.1231, 0.1975, 0.9554])"
    },
    "nes": {
        "all": {
            "avg": "tensor(0.6773)",
            "std": "tensor(0.2886)"
        },
        "avg": "tensor([0.9326, 0.8037, 0.6849, 0.2881])",
        "rep": {
            "avg": "tensor(0.8070)",
            "std": "tensor(0.1595)"
        },
        "std": "tensor([0.0695, 0.1265, 0.1576, 0.2341])"
    },
    "nes_output": {
        "all": {
            "avg": "None",
            "std": "None"
        },
        "avg": "tensor(0.2976)",
        "rep": {
            "avg": "None",
            "std": "None"
        },
        "std": "tensor(0.0945)"
    },
    "query_loss": {
        "all": {
            "avg": "None",
            "std": "None"
        },
        "avg": "tensor(12.3616)",
        "rep": {
            "avg": "None",
            "std": "None"
        },
        "std": "tensor(13.7976)"
    }
} 
```

* * *

## 回答 #14

> 赞同：-8
> 
> 时间：2020-04-01T14:50:13.107

它远非完美，但它可以完成工作。

```
data = data.replace(',"',',\n"') 
```

你可以改进它，添加缩进等等，但如果你只是想能够读取更干净的 json，这就是要走的路。

# php - Magento - 添加特殊的运输规则？

> ID：12943821
> 
> 赞同：0
> 
> 时间：2012-10-17T21:38:45.753
> 
> 标签：php, magento, magento-1.7, shipping

好的，所以我正在为一个想要相当简单的运输设置的客户建立一个 Magento 商店，但我不确定 Magento 是否支持。

她希望向客户收费：

1 件 5 美元 2 件 7 美元 或 3 件以上 10 美元

很简单。这是可以添加的东西吗？如果是这样，我该怎么做？

我是 PHP 新手。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T04:52:00.810

是的，您可能必须构建简单的运输模块，并在 collectRate 方法中检查当前结帐会话中有多少项目

```
Mage::helper('checkout/cart')->getCart()->getItemsCount(); 
```

并在此基础上分配运费金额。

它非常简单直接的模块。

[http://www.magentocommerce.com/wiki/5__-_modules_and_development/shipping/create-shipping-method-module](http://www.magentocommerce.com/wiki/5_-_modules_and_development/shipping/create-shipping-method-module)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T02:55:27.507

如果您需要有关运输的任何信息，首先您必须检查 WebShopApps 扩展

我相信即使是他们的免费矩阵率也允许

[http://www.magentocommerce.com/magento-connect/webshopapps-matrixrate-1-multiple-table-rates-extension-certified-bug-free.html](http://www.magentocommerce.com/magento-connect/webshopapps-matrixrate-1-multiple-table-rates-extension-certified-bug-free.html)

[http://wiki.webshopapps.com/extensions/matrix-rates](http://wiki.webshopapps.com/extensions/matrix-rates)

# c# - 两个应用程序使用的类库中的静态变量

> ID：12943823
> 
> 赞同：0
> 
> 时间：2012-10-17T21:38:51.010
> 
> 标签：c#, asp.net-mvc, wcf, caching, static

我今天遇到了一个问题，希望有人能够回答。我可能遗漏了一些东西，而且我现在没有代码在我面前，所以我从记忆中记住了这一点。

我有一个 .NET MVC Web 应用程序，它有两个层，一个 UI 层和一个服务层（WCF 服务）。UI 层具有对 WCF 服务的服务引用。

UI 层将一些数据缓存到 global.asax 文件中 Application_Start 上的静态变量中。这些静态变量位于引用的共享类库中的类中。

我的 WCF 层还引用了这个类库和提到的静态变量。

这两个层都安装在不同的服务器上，因此在它们自己的 IIS 实例下。

有什么方法可以让我的 WCF 服务访问由 UI 层填充的静态变量中的数据？我会认为服务层有自己的引用程序集实例，因此其中的变量只属于自己？

我问的原因是这个。服务层上曾经有一个 global.asax 文件，我最近也删除了它，它也用于填充共享库中的静态变量。

从服务层完全删除这个 global.asax 文件后，它仍然能够访问由 UI 层填充的数据（至少我认为是这样）。当服务层中的这些变量处于非活动状态时（我认为），应用程序仍将运行一段时间，并且我得到空引用异常。

再次填充变量的唯一方法是重新启动 UI 层应用程序池。然后该应用程序再次运行一段时间并重复。

我不确定我要解释的内容是否可行，在这种情况下我会遗漏一些东西，或者是否有人知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:52:46.217

静态变量仅在 AppDomain 中是静态的。当 IIS 关闭应用程序池（由于不活动等）时，这些静态值将消失。

我将在您的 WCF 项目中引用静态变量，然后为 WCF 层添加服务以用于获取这些静态值。

# jquery - jQuery Mobile：通过 $.getJSON() 从 JSON 创建一个对象

> ID：12943834
> 
> 赞同：0
> 
> 时间：2012-10-17T21:39:29.493
> 
> 标签：jquery, ajax, json

新手问题：

我成功地从服务器获取了一个 json 书籍集合：

```
 $.getJSON("/Data/json.txt", function (data) {
            //Book array?
        }); 
```

鉴于 JSON 看起来像这样：

```
{
   "Books":[
      {
         "ID":"42",
         "Name": "AJAX"
       },
      {
         "ID":"41",
         "Name": "Sand"
       }
    ]
 } 
```

如何获得填充的“书”集合？（我来自 C# 背景）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:43:52.413

`data`应该是服务器发回的 JSON 数据结构`data.Books`，“Book”对象数组也是如此。这些是代表“书”的 javascript 对象，尽管各个对象自己不知道它们是什么类型。把它们当作“书”，你应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:45:31.283

您将已经在数据中拥有 books 数组。像这样：

```
 $.getJSON("/Data/json.txt", function (data) {
        for (var i = 0; i < data.Books.length; i++) {
            var id = data.Books[i].ID;
            var name = data.Books[i].Name;
        }
    }); 
```

# parsing - 我的 LR(0) 语法有什么问题？

> ID：12943842
> 
> 赞同：0
> 
> 时间：2012-10-17T21:40:19.153
> 
> 标签：parsing, language-agnostic, grammar, lr

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T23:18:51.913

（在更仔细地阅读了那个维基百科页面之后。）

维基百科引用是（强调添加）：

> 如果一个项目集 i 包含一个形式为 A → w • 的项目，并且 A → w 是**m > 0 的规则 m，则动作表中状态 i 的行完全被归约动作 r** [m]填充。

规则 0 是增强的开始规则，在您的情况下应该是：

```
start : mexp '$' 
```

（就个人而言，我更喜欢显式添加 EOF 令牌；这样的例外情况较少。）

但是，我认为您所拥有的是：

```
start : exp '$'
exp   : mexp 
```

这实际上不是 LR(0)，因为单位缩减规则 (exp → mexp) 会导致您发现的移位缩减冲突。

`m = 0`如果规则是用明确的结束标记编写的，那么维基百科文章的例外是不必要的；在这种情况下，动作`acc`是根据修改后的动作3生成的：

> 1.  '$'（输入结束）的额外列被添加到包含每个包含 S → E • '$' 的项目集的 acc 的操作表中。

（实际上，您不需要“额外的列”部分；使用明确的结束标记，您应该已经有一个列。关键是用 acc 操作覆盖 shift 操作。）

# python - Git、Django 和可插拔应用程序

> ID：12943846
> 
> 赞同：0
> 
> 时间：2012-10-17T21:40:30.740
> 
> 标签：python, django, git

我目前正在 Django 上开发几个网站，这些网站需要几个 Django 应用程序。假设我有两个 Django 项目：web1 和 web2（网站，每个都有一个 git repo）。web1 和 web2 都有不同的已安装应用程序列表，但碰巧都使用我开发的一个（或多个）应用程序，比如“MyApp”（那里也有一个 git repo）。我的问题是：

1.  将 MyApp 与任何特定网站分离的最佳方法是什么？我想要的是独立开发 MyApp，但让每个网站都使用该应用程序的最新版本（当然，如果它已安装）。我有两个“建议”的解决方案：在每个网站上使用符号链接到“主”MyApp 文件夹，或者使用 git 从 MyApp 推送到每个网站的存储库。

2.  如何使用此设置进行部署？现在，我可以将 web1 和 web2 的 git repo 推送到我的共享主机帐户中的远程 repo，它就像一个魅力。这会充分扩展吗？

我想我脑子里有一个大致的想法，但我不确定细节。这不会创建一个嵌套的 git repo 问题吗？git 如何处理 simlinks，特别是如果 symlink 目标中有一个 .git 文件夹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T22:04:28.323

我的工作方式：

每个网站都有自己的 git repo *，*每个应用程序都有自己的 repo。每个网站也有它自己的`virtualenv`和`requirements.txt`. 尽管 2 个网站现在可能共享最新版本的 MyApp，但它们将来可能不会（也许您还没有让其中一个网站在某些 API 更改上保持最新）。

如果您真的必须只有一个版本的 MyApp，您可以在系统级别安装它，然后将其符号链接到`virtualenv`每个项目的 .

对于本地机器上的开发（不是生产），我做的有点不同。我将应用程序的项目文件夹符号链接到网站的“src”文件夹中`virtualenv`，然后链接到一个`python setup.py develop`，`virtualenv`以便始终“实时”在网站上使用最新的更改。

# html - Bootstrap Popover 放置不起作用

> ID：12943848
> 
> 赞同：1
> 
> 时间：2012-10-17T21:40:43.863
> 
> 标签：html, css, twitter-bootstrap, popover

我无法让 Twitter Bootstrap Popover 放置选项正常工作。这是我的按钮代码，如您所见，我在代码中添加了**data-placement="bottom" 。**也可以在这里进行实时预览：[http ://www.japaneselanguagefriend.com/application/popover.php](http://www.japaneselanguagefriend.com/application/popover.php)

```
<a href="#" id="blob" class="btn btn-primary" rel="popover" data-placement="bottom"　data-content="And here's some amazing content. It's very engaging. right?" data-original-title="A title">hover for popover</a> 
```

![在此处输入图像描述](../Images/5e3500b5087be82972dd6e77be9cb5ed.png)

![在此处输入图像描述](../Images/1c3640d1193c42774133f308b0f65f2c.png)

它一直在我的按钮上直接显示弹出框，甚至没有向弹出框写入正确的标题或内容。这是我的**源脚本页脚**

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="assets/js/bootstrap-transition.js"></script>
<script src="assets/js/bootstrap-collapse.js"></script>
<script src="assets/js/bootstrap-modal.js"></script>
<script src="assets/js/bootstrap-dropdown.js"></script>
<script src="assets/js/bootstrap-button.js"></script>
<script src="assets/js/bootstrap-tab.js"></script>
<script src="assets/js/bootstrap-alert.js"></script>
<script src="assets/js/bootstrap-tooltip.js"></script>
<script src="assets/js/bootstrap-popover.js"></script>
<script src="assets/js/jquery.ba-hashchange.min.js"></script>
<script src="assets/js/jquery.validate.min.js"></script>
<script src="assets/js/jquery.placeholder.min.js"></script>
<script src="assets/js/jquery.jigowatt.js"></script>

<script>
$(document).ready(function() {
       $(function () {
            $("#blob")
        .popover({
            offset: 0
         })
       })
 });
 </script> 
```

# java - 服务器端 JSON 分页

> ID：12943851
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:40:59.653
> 
> 标签：java, javascript, json, jsp, paging

我有一个大的 JSON 文件需要发送给客户端。我想在服务器端对其进行分页；让客户给我下一个页码；因为当我发送整个文件时，它会减慢客户端界面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T01:45:45.973

您需要对您的 json 数组进行最小解析，以便能够以您想要的方式进行分页。

看看谷歌 gson 库：

[https://sites.google.com/site/gson/gson-user-guide#TOC-Array-Examples](https://sites.google.com/site/gson/gson-user-guide#TOC-Array-Examples) https://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples

您可以在服务器中仅存储一组对象。然后，一旦您在服务器端确实有一个 java 数组，您就可以只返回您的客户端期望的对象，以 json 格式。

# c++ - Blackberry Cascades应用程序中的Web服务设计

> ID：12943852
> 
> 赞同：0
> 
> 时间：2012-10-17T21:41:00.383
> 
> 标签：c++, qt, blackberry-10

我正在（尝试）编写一个 Cascades 应用程序，其中包括对各种 Web 服务的许多调用。我在我的主应用程序类中可以正常工作，但我希望能够调用另一个类 - 如果你愿意，可以调用服务管理器类 - 并在处理服务调用时让它返回一个值给我的调用应用程序类由服务管理器类并已完成。

这是一个好的设计吗？这是我在 Java 中采用的路线，但我对 C++ 和 QT 完全陌生。我可以潜在地使用发射和信号过程来产生这个功能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:45:56.313

是的，如果我正确阅读了您的问题。

ServicesManager 类通过信号/槽与 Application 类通信是完全合理的。听起来它们在不同的线程中运行，但对于 Qt 信号/插槽来说这很好。此外，您可以对信号类进行子类化以发送自定义有效负载（或者只是告诉接收器“嘿，我完成了，向我查询结果”）。

如果 async 是你想要的，看看这个很好的解释：

[跨线程的 Qt 信号/插槽](http://cdumez.blogspot.com/2011/03/worker-thread-in-qt-using-signals-slots.html)

# python - 通过 HTTP 提供命令输出的 Python 程序

> ID：12943855
> 
> 赞同：1
> 
> 时间：2012-10-17T21:41:21.927
> 
> 标签：python

我想知道是否有人可以帮助我增强一个 python 脚本，该脚本为各种应用程序运行状态命令：

```
/app/app1/bin/status.sh
/app/app2/bin/status.sh 
```

脚本中的 check() 函数创建一个哈希：

```
results = check_function()

results['app1']['status'] = 'running'
results['app2']['status'] = 'stopped' 
```

我目前的解决方案是仅限终端，并且 display_results() 函数使用适当的转义序列将环境状态打印到终端以对其进行着色：

```
display_results(results) 
```

我想“启用网络”命令，以便它可以通过网络报告结果字典。

我在想我可以让它在套接字上侦听并通过字符串模板编写 HTML，或者让 BaseHTTPServer 进行侦听会更好，但是如何让它服务于命令的输出而不是 index.html 文件在文件系统上？

这不是一个生产应用程序，它被用作开发人员对应用程序状态进行大规模检查的工具。

终端版本适用于 python 2.4 (Centos 5.8) 但没有什么可以阻止我使用 python 2.7

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T00:34:17.577

如果不编写整个代码，为什么不使用这样的东西：

```
import BaseHTTPServer

class MyHTTPRequestHandler(BaseHTTPServer.BaseHTTPRequestHandler):
        def do_GET(self):
                self.send_response(200)
                self.send_header("Content-type", "text/html")
                self.end_headers()
                self.wfile.write("<html><body>You accessed path: {}</body></html>".format(self.path))

BaseHTTPServer.HTTPServer(('', 80), MyHTTPRequestHandler).serve_forever() 
```

将代码添加到`MyHTTPRequestHandler`调用某些脚本或任何使用`self.path`作为参数并将结果添加到格式化页面中没有问题。如此简单的任务，电池的问题在哪里？此外，该`subprocess`模块可能会有所帮助，尤其是`subprocess.Popen(["echo", "test"]).communicate()`.

# javascript - Javascript Object.Create 对对象的复制引用

> ID：12943858
> 
> 赞同：0
> 
> 时间：2012-10-17T21:41:27.003
> 
> 标签：javascript, object, new-operator, object-create

我有以下代码

```
ViewModel.prototype.update = function(initial) {
  var ittr, key, val, x;
  for (key in initial) {
    val = initial[key];
    if ($.isArray(val) && $.isArray(this[key]())) {
      ittr = 0;
      while (ittr < val.length) {
        if (this[key].length > ittr) {
          if ((this[key][ittr - 1]) instanceof ViewModel) {
              x = Object.create(this[key][ittr - 1]);
              x.update(val[ittr]);
              this[key].push(x);
          }
        }
      }
    }
  }
} 
```

我有从 ViewModel 继承的对象，它们都具有更新功能。我有一个数组，我正在使用来自 json 对象（初始）的新内容进行更新。有时 Json 对象比我正在更新的现有数组长，所以我想添加相同类型的对象。我正在使用 Object.create(this[key][ittr -1]) 指向数组中的最后一个对象，并尝试从中实例化一个新对象。问题是，每次迭代，它都不会创建新对象，而只是旧对象的副本。知道我怎么能阻止它吗？

我也试过jquery

```
new $.extend({},this[key][ittr - 1]) 
```

我试过把 x 变成一个数组

```
x[ittr] = Object.create(this[key][ittr - 1]);
x[ittr].update(val[ittr]);
this[key].push(x[ittr]); 
```

每当我调用 x.update 时，它​​都会更改数组中已设置为 x 的每个值。所以当我调用 Object.create 时，我从来没有真正创建一个新对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:22:05.970

嗯，第一个参数`Object.create`是你想成为新创建对象的原型的对象。见[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)。本质上，它将是一个新对象，但它看起来像旧对象，因为它通过原型继承了旧对象的所有属性。尝试`ViewModel.prototype`作为第一个参数传递，将旧对象作为第二个参数传递。扩展路线不会完全成功，因为新对象将具有旧对象的所有属性，除了它不会继承自`ViewModel.prototype`，因此不会有更新或任何其他原型方法/属性。

# methods - Windows批处理脚本内部函数传递变量

> ID：12943865
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:42:00.077
> 
> 标签：methods, batch-file, cmd, internal

好的，所以我尝试进行批处理视频处理，我想将其压缩为单个批处理文件而不是 5，但我无法将变量传递给内部函数，就像我将它们传递给外部 .bat 文件一样.

这是我的“一体式”版本

```
mkdir new

mkdir new\fonts

forfiles /M *.mkv /C "cmd /c call :mkvextract @file @fname" >> log.txt 2>&1

forfiles /M *.mkv /C "cmd /c call :mkvmerge @file" >> merge.txt 2>&1

forfiles /M *.mkv /C "cmd /c call :makeavs @file @fname" >> log.txt 2>&1

forfiles /M *.mkv /C "cmd /c call :getfonts @file @fname" >> fonts.txt 2>&1

forfiles /M *.ttf /C "cmd /c call :movefonts @file" >> fonts.txt 2>&1

forfiles /M *.TTF /C "cmd /c call :movefonts @file" >> fonts.txt 2>&1

forfiles /M *.otf /C "cmd /c call :movefonts @file" >> fonts.txt 2>&1

forfiles /M *.OTF /C "cmd /c call :movefonts @file" >> fonts.txt 2>&1

:mkvextract

"C:\Program Files (x86)\MKVToolNix\mkvextract.exe" --ui-language en tracks "%~1" 2:"%CD%\new\%~2_track3_eng.ass"

goto :EOF

:mkvmerge

set mkvorig=%CD%\%~1
set mkvorig=%mkvorig:\=\\%

set mkvnew=%CD%\new\%~1
set mkvnew=%mkvnew:\=\\%

"C:\Program Files (x86)\MKVToolNix\mkvmerge.exe" -o "%mkvnew%"  "--language" "0:jpn" "--default-track" "0:yes" "--forced-track" "0:no" "--display-dimensions" "0:1920x1080" "--language" "1:jpn" "--default-track" "1:yes" "--forced-track" "1:no" "-a" "1" "-d" "0" "--no-attachments" "-S" "-T" "--no-global-tags" "--no-chapters" "(" "%mkvorig%" ")" "--track-order" "0:0,0:1"

goto :EOF

:makeavs

echo Directshowsource("new\%~1") >"new\%~2.avs"
echo textsub("new\%~2_track3_eng.ass") >>"new\%~2.avs"

goto :EOF

:getfonts

"C:\Program Files (x86)\MKVToolNix\mkvextract.exe" attachments "%~1" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20

goto :EOF

:movefonts

move %~1 new\fonts

goto :EOF 
```

“五个.bat文件”版本如下：

```
mkdir new

mkdir new\fonts

forfiles /M *.mkv /C "cmd /c mkvextract.bat @file @fname" >> log.txt 2>&1

forfiles /M *.mkv /C "cmd /c mkvmerge.bat @file" >> merge.txt 2>&1

forfiles /M *.mkv /C "cmd /c makeavs.bat @file @fname" >> log.txt 2>&1

forfiles /M *.mkv /C "cmd /c getfonts.bat @file @fname" >> fonts.txt 2>&1

forfiles /M *.ttf /C "cmd /c movefonts.bat @file" >> fonts.txt 2>&1

forfiles /M *.TTF /C "cmd /c movefonts.bat @file" >> fonts.txt 2>&1

forfiles /M *.otf /C "cmd /c movefonts.bat @file" >> fonts.txt 2>&1

forfiles /M *.OTF /C "cmd /c movefonts.bat @file" >> fonts.txt 2>&1 
```

我不太确定我是否正确地执行函数调用，但它看起来很正确，因为我在这里找到了：http: [//batcheero.blogspot.com/2007/07/function-call-in-batch.html](http://batcheero.blogspot.com/2007/07/function-call-in-batch.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:34:05.170

forfiles 执行的命令在一个全新的 CMD.EXE 会话中。它们不再在您的母批处理上下文中，因此您不能在您的母批处理脚本中调用子例程。

您可以重组您的主脚本以调用自身并将例程的名称作为参数传递。如果标签存在，您的脚本可以转到该标签。

您的第一个脚本在第一个子例程之前也缺少 EXIT /B 或 GOTO :EOF。

您不需要制作中间目录。您可以直接制作`new\fonts`，`new`如果它尚不存在将被创建。

```
@echo off

:: If first argument is a valid label then GOTO that label
if "%~1" neq "" findstr /bc:":%~1" "%~f0" >nul && (
  shift /1
  goto %~1
)

::Main program
if not exist new\fonts mkdir new\fonts
forfiles /M *.mkv /C "cmd /c "%~f0" mkvextract @file @fname" >> log.txt 2>&1
forfiles /M *.mkv /C "cmd /c "%~f0" mkvmerge @file" >> merge.txt 2>&1
forfiles /M *.mkv /C "cmd /c "%~f0" makeavs @file @fname" >> log.txt 2>&1
forfiles /M *.mkv /C "cmd /c "%~f0" getfonts @file @fname" >> fonts.txt 2>&1
forfiles /M *.ttf /C "cmd /c "%~f0" movefonts @file" >> fonts.txt 2>&1
forfiles /M *.TTF /C "cmd /c "%~f0" movefonts @file" >> fonts.txt 2>&1
forfiles /M *.otf /C "cmd /c "%~f0" movefonts @file" >> fonts.txt 2>&1
forfiles /M *.OTF /C "cmd /c "%~f0" movefonts @file" >> fonts.txt 2>&1
exit /b

:mkvextract
"C:\Program Files (x86)\MKVToolNix\mkvextract.exe" --ui-language en tracks "%~1" 2:"%CD%\new\%~2_track3_eng.ass"
exit /b

:mkvmerge
set mkvorig=%CD%\%~1
set mkvorig=%mkvorig:\=\\%
set mkvnew=%CD%\new\%~1
set mkvnew=%mkvnew:\=\\%
"C:\Program Files (x86)\MKVToolNix\mkvmerge.exe" -o "%mkvnew%"  "--language" "0:jpn" "--default-track" "0:yes" "--forced-track" "0:no" "--display-dimensions" "0:1920x1080" "--language" "1:jpn" "--default-track" "1:yes" "--forced-track" "1:no" "-a" "1" "-d" "0" "--no-attachments" "-S" "-T" "--no-global-tags" "--no-chapters" "(" "%mkvorig%" ")" "--track-order" "0:0,0:1"
exit /b

:makeavs
echo Directshowsource("new\%~1") >"new\%~2.avs"
echo textsub("new\%~2_track3_eng.ass") >>"new\%~2.avs"
exit /b

:getfonts
"C:\Program Files (x86)\MKVToolNix\mkvextract.exe" attachments "%~1" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
exit /b

:movefonts
move %~1 new\fonts
exit /b 
```

# android - 用于移动应用程序的 UI 模型和屏幕导航的工具

> ID：12943868
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:42:13.057
> 
> 标签：android, iphone, user-interface

基本上我看到了[这个](http://www.groosoft.com/blueprint/)应用程序，我正在寻找一个类似的应用程序，但不是用于平板电脑，而是用于台式电脑（或在线）。真的不在乎样机外观是适用于 iPhone 还是 Android 还是物有所值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:51:16.953

你想要[这个](http://keynotopia.com)来自keynotopia。它包括适用于 Android、iPhone、iPad、BlackBerry、Windows 手机、网络、Facebook、OS X 和 Windows 的模板。

模板在 Mac 的 Keynote 或 Windows 的 Power Point 中运行，非常出色。您可以从每个模板的线框、草图或高分辨率版本中进行选择。您可以在 Keynote（或 Powerpoint）中布局您的设计，并且可以将操作联系在一起以使您的设计看起来/感觉实用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:54:30.817

您可以查看[ForeUI](http://www.ForeUI.com/)，它可以创建 UI 模型并定义 Web/桌面/移动应用程序的交互。您还可以在[ForeUI 商店](http://www.foreui.com/store/)中找到可下载的 iPhone 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T06:41:46.470

Balsamiq 也是一个很好的 UI 模型工具，其中包含许多平台的库。您可以尝试以下链接 [https://balsamiqgdrive.appspot.com](https://balsamiqgdrive.appspot.com)

# asp.net-mvc - 在 Asp.Net MVC 4 项目中使用 Linq to Sql 进行数据库查询

> ID：12943870
> 
> 赞同：0
> 
> 时间：2012-10-17T21:42:30.083
> 
> 标签：asp.net-mvc, linq-to-sql

我想要一些关于使用 Linq To Sql 对 Sql Server DB 执行一些基本表查询的技巧。

我的项目是在 ASP.NET MVC 4 中使用 c#（使用 VS2012），但我不想写很多模型并生成实体框架图。我想在我的控制器中编写手动查询，执行它们，然后转换为列表并返回到我的视图（即 jQuery 将解析结果并相应地显示）。

### 背景

XML 场景：我当前的网站项目主要围绕 XML 请求/响应基础设施。所以我主要是在 C# 中调用 JQuery，然后将 xml 请求发送到另一个应用服务器。然后我收到了 xml 响应并将其返回给视图。然后我解析 xml 并使用 jQuery、Datatables 等显示内容。

数据库查询场景：我写的其中一个QA工具其实是一个基于Sql Server Procedure的项目；但是我现在正在尝试编写一个前端管理工具来执行那些基于 QA 的程序。

所以...我想将手动 Linq 查询直接写入我的数据库，并在不生成模型的情况下处理响应。即更多的临时类型查询。

在我的 web.config 我有一个`<connectionStrings>`部分：

```
<add name="RegrDBConnection" connectionString="Server=MSSQLSERVER2008;Initial Catalog=RegressionResults;Integrated Security=true" providerName="System.Data.SqlClient" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:46:23.743

听起来您可能正在市场上购买 Micro-ORM。Sam Saffron 为 Stack Overflow 写了一篇；它被称为[Dapper](http://code.google.com/p/dapper-dot-net/)。Rob Conery 还编写了一个利用`dynamic`C# 4.0 中的关键字的文章，称为[Massive](https://github.com/robconery/massive#readme)。

或者，您可以直接使用突击队并使用[SQLConnection](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)和[SQLCommand](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)对象。

# android - 如何使用 Bundle 在 Activity 之间传递 Uri 数组

> ID：12943873
> 
> 赞同：5
> 
> 时间：2012-10-17T21:42:35.627
> 
> 标签：android, android-intent, android-activity

我需要将 Uri 数组传递给另一个活动，以传递我简单使用的字符串数组

```
String[] images=getImagesPathString();

    Bundle b = new Bundle();
    b.putStringArray("images", images); 
```

但是使用 Uri 数组

```
 Uri[] imagesUri=getImagesUri(); 
```

这不起作用，因为 Bundle 中没有方法“putUri(Uri x)”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:54:10.523

据我所知，普通数组不能放入 Bundles 中。但是你可以把 Uri-s 放到 ArrayList 中，然后调用 Bundle.putParcelableArrayList()。

例子：

```
 ArrayList<Uri> uris = new ArrayList<Uri>();
 // fill uris
 bundle.putParcelableArrayList(KEY_URIS, uris); 
```

稍后的：

```
 ArrayList<Parcelable> uris =
            bundle.getParcelableArrayList(KEY_URIS);
    for (Parcelable p : uris) {
        Uri uri = (Uri) p;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T21:45:32.143

您应该查看 Parcelable 界面以了解如何通过意图传递事物

[http://developer.android.com/intl/es/reference/android/os/Parcelable.html](http://developer.android.com/intl/es/reference/android/os/Parcelable.html)

也许您可以实现一个实现该接口的 ParcelableUri 类。

像这样（未经测试！！）：

```
public class ParcelableUri implements Parcelable {

private Uri[] uris;

public ParcelableUri(Parcel in) {
    Uri.Builder builder = new Uri.Builder();

    int lenght = in.readInt();
    for(int i=0; i<=lenght; i++){           
        uris[i]= builder.path(in.readString()).build();
    }
}

@Override
public int describeContents() {
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    dest.writeInt(uris.length);
    for(int i=0; i<=uris.length; i++){
        dest.writeString(uris[i].toString());
    }
}

public static final Parcelable.Creator<ParcelableUri> CREATOR = new Parcelable.Creator<ParcelableUri>() {

    public ParcelableUri createFromParcel(Parcel in) {
        return new ParcelableUri(in);
    }

    public ParcelableUri[] newArray(int size) {
        return new ParcelableUri[size];
    }
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-17T21:46:11.440

Uri 不是可包裹的吗？您可以尝试创建一个可打包元素（Uri）数组并将其放入 Bundle 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:54:28.943

您可以使用 JSONObject 包装任何对象并快速对其进行字符串化。从字符串返回到 JSON 真的很简单

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-26T09:49:00.453

你可以这样做...

```
private Uri[] getUris(int requestCode, Intent data) {

        Uri[] uris;

    ClipData clipData = null;
    if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN) {
        clipData = data.getClipData();
    }
    if(clipData != null) {
        uris = new Uri[clipData.getItemCount()];
        for(int i=0;i<clipData.getItemCount();i++) {
            ClipData.Item videoItem = clipData.getItemAt(i);
            Uri videoURI = videoItem.getUri();
            uris[i] = videoURI;
        }
    }
    else {
        uris = new Uri[0];
        Uri videoURI = data.getData();
        uris[0] = videoURI;
    }

    return uris;
    } 
```

# c# - 使用 Autofac 自动装配通用装饰器

> ID：12943877
> 
> 赞同：2
> 
> 时间：2012-10-17T21:43:27.557
> 
> 标签：c#, dependency-injection, inversion-of-control, autofac

我有两个装饰器：

```
class DbCommandWithTransactionHandlerDecorator<TCommand>
    : IDbCommandHandler<TCommand> { ... }

class DbOptimisticConcurrencyRetryDecorator<TCommand>
    : IDbCommandHandler<TCommand> { ... } 
```

这些装饰器将事务管理和乐观并发重试功能添加到数据库命令。

我使用 Autofac 作为我的 IoC 容器。我想设置 Autofac 以便它自动连接所有`IDbCommandHandler<>`在程序集中找到的东西，这样当我请求说 an 时`IDbCommandHandler<CreateNewNotificationCommand>`，它会自动先用 a 装饰它`DbCommandWithTransactionHandlerDecorator`，然后用a 装饰它`DbOptimisticConcurrencyRetryDecorator`。

我一直在尝试用 Autofac 来解决这个问题`builder.RegisterGenericDecorator()`，但还没有成功。主要问题是装饰器需要一个“命名”参数才能工作。下面是最“接近”我想要实现的示例代码 - 但是主要缺陷是我仍然必须手动注册类型。

```
var builder = new ContainerBuilder();
var a = Assembly.GetExecutingAssembly();

// I need to find a way how these can be 'auto-wired', 
// rather than having to manually wire each command.

builder.RegisterType<CreateNewNotificationCommandHandler>()
    .Named<IDbCommandHandler<CreateNewNotificationCommand>>("command");
builder.RegisterType<CreateNewNotificationCommandHandler_2>()
    .Named<IDbCommandHandler<CreateNewNotificationCommand_2>>("command");

builder.RegisterGenericDecorator(
    typeof(DbCommandWithTransactionHandlerDecorator<>),
    typeof(IDbCommandHandler<>),
    fromKey: "command");

var container = builder.Build();
var handler1 =
  container.Resolve<IDbCommandHandler<CreateNewNotificationCommand>>();
var handler2 =
  container.Resolve<IDbCommandHandler<CreateNewNotificationCommand_2>>();
handler1.Handle(null); //these are correctly decorated
handler2.Handle(null); //these are correctly decorated 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T15:24:10.493

I did manage to find a workaround via reflection, which although it works is not really elegant. I will post it below for completeness sake:

```
 public interface IDbCommandHandler<in TCommand>: IDbCommandHandlerStub
    where TCommand : IDbCommand
{
    void Handle(TCommand command);
}

public interface IDbCommandHandlerStub
{

}

    private List<Type> getTypesThatImplementIDbCommandHandler(IEnumerable<Assembly> assemblyList)
    {
        List<Type> list = new List<Type>();
        foreach (var a in assemblyList)
        {
            var matches = a.GetTypes().Where(t => typeof(IDbCommandHandlerStub).IsAssignableFrom(t));
            list.AddRange(matches);
        }
        return list;
    }

private void registerDbCommands(List<Type> dbCommandHandlerTypes, ContainerBuilder builder)
    {
        foreach (var t in dbCommandHandlerTypes)
        {
            var interfaces = t.GetInterfaces();
            foreach (var i in interfaces)
            {
                builder.RegisterType(t).Named("dbCommand", i);
            }

        }
    }

   public void Test1()
   {
        ContainerBuilder builder = new ContainerBuilder();
        var dbCommandHandlerTypes = getTypesThatImplementIDbCommandHandler(assemblies);
        registerDbCommands(dbCommandHandlerTypes, builder);            

        builder.RegisterGenericDecorator(typeof(DbCommandWithTransactionHandlerDecorator<>),
                                        typeof(IDbCommandHandler<>),
                                        fromKey: "dbCommand", toKey:"dbCommandWithTransaction").SingleInstance();

        builder.RegisterGenericDecorator(typeof(DbOptimisticConcurrencyRetryDecorator<>),
                                        typeof(IDbCommandHandler<>),
                                        fromKey: "dbCommandWithTransaction").SingleInstance();

        var container = builder.Build();
        var handler1 = container.Resolve<IDbCommandHandler<CreateNewNotificationCommand>>();

} 
```

First, I get via reflection all the types that implement `IDbCommandHandler`. Then, I register them as named types for all the interfaces which they implement, giving them a name of 'dbCommand'.

Then, I register the generic decorator to decorate types named 'dbCommand'. This decorater is named 'dbCommandWithTransaction', and is used to then register another generic decorator for the concurrency-retry.

Considering this is something which would be done once and 'forgotten', I was ready go with this workaround. However, I was trying out other IoC containers and came upon [Simple Injector](http://simpleinjector.codeplex.com/wikipage?title=Advanced-scenarios#Generic_Decorators), and all this can be done in just two lines of code - And have since then won me over.

# javascript - 创建按钮以清除 div 内的所有表单和数组

> ID：12943878
> 
> 赞同：0
> 
> 时间：2012-10-17T21:43:28.880
> 
> 标签：javascript

嗨，我正在尝试创建一个按钮来清除 Divs 框中的所有表单字段和数组一个按钮，我将在顶部的下方发布 2 个脚本
，将清除 div，仅底部的一个将清除表单

```
function clearForms()
 { 
            number=[]
            number.splice(0); 
            var x = document.getElementById("box");  
            x.innerHTML = ""; 
            x.innerHTML = number.join('<br/>');   
        } 

 function clearForms()
{    
 var x, y, z, type = null; 
for (x = 0; x < document.forms.length; x++)
 {     
 for (y = 0; y < document.forms[x].elements.length; y++) {   
  type = document.forms[x].elements[y].type;   
      ('form='+x+' element='+y+' type='+type); 
 switch (type)
 {           
 case 'text':           
 case 'textarea':            
case 'password':           
 //case "hidden":                
document.forms[x].elements[y].value = '';               
 break;           
 case 'radio':           
 case 'checkbox':                
document.forms[x].elements[y].checked = '';               
 break;            
case 'select-one':                
document.forms[x].elements[y].options[0].selected = true;               
 break;           
 case 'select-multiple':              
  for (z = 0; z < document.forms[x].elements[y].options.length; z++)
 {                   
 document.forms[x].elements[y].options[z].selected = false;              
  }                
break;           
 }
 // end switch      
  } 
// end for y 
   } 
// end for x
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:50:54.670

无法弄清楚清除 DIV 中的数组是什么意思，但是要从页面重置所有表单，请尝试以下操作：

```
function clearForms() {
  for (x = 0; x < document.forms.length; x++)
    document.forms[x].reset();
} 
```

此函数会将所有表单值恢复为其默认值。

# javascript - 将 URL 参数传递给 iframe

> ID：12943879
> 
> 赞同：23
> 
> 时间：2012-10-17T21:43:31.737
> 
> 标签：javascript, jquery, html, iframe, parameters

我想从包含 的页面中获取参数`iframe`，并将参数附加`src`到`iframe`.

例子：

**包含 iframe 的页面——**

[http://www.example.com/pref.html?c=%433r3jutlut9se%23&e=test%40example.com](http://www.example.com/pref.html?c=%433r3jutlut9se%23&e=test%40example.com)

**上一页中的 IFRAME——**

```
<iframe id="myiframe" name="myiframe" src="prefcontent.aspx" frameborder="0"
width="100%" height="800"></iframe> 
```

这是我尝试过的许多事情之一，我认为理论上可行，但我没有运气：

```
<script language="javascript">
$(function() {

    var loc = window.location.toString(),
    params = loc.split('?')[1],
    params2 = loc.split('&')[2],
    iframe = $('#myiframe');

    console.log(params);

    iframe.src = iframe.src + '?' + params + '&' + params2;

});
</script> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-17T23:15:39.190

如果您使用 jQuery，您可能想要精简您的代码：

```
$(function() {
    var search = window.location.search;
    $("#myiframe").attr("src", $("#myiframe").attr("src")+search);
}); 
```

使用window.location.search；因为它会在 url 的末尾剪掉哈希标签，并且因为它是本机代码，所以速度要快得多。

然后使用 jQuery 选择器在 iframe 上查找和替换 src 的属性，用它的当前 src 加上从这个页面获取的搜索。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-17T21:50:09.753

您可以将查询字符串附加到 iFrame 的源

```
<script language="javascript">
    var iframe = document.getElementById('myiframe');
        iframe.src = iframe.src + window.location.search;
</script> 
```

# c# - 正则表达式 \d 匹配多个数字

> ID：12943880
> 
> 赞同：1
> 
> 时间：2012-10-17T21:43:34.000
> 
> 标签：c#, regex

我正在查看一个 C# Regex 教程，该教程指出“\d”匹配单个数字 0 到 9。

但是，当我运行以下程序时。

```
 static void Main(string[] args)
    {
        string s = "45";
        Regex myRegex = new Regex(@"(\d)");

        if( myRegex.IsMatch(s))
        {
            System.Console.WriteLine("Matched");
        }
        else
        {
            System.Console.WriteLine("Not Matched");
        }

        Console.ReadKey();
    } 
```

控制台打印出“匹配”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-17T21:45:44.040

是的，它会找到`4`, 因为正则表达式匹配不必覆盖整个输入字符串。如果您想确保您的字符串**只是**一个数字，请包括标记字符串开头和结尾的锚点：

```
Regex myRegex = new Regex(@"^(\d)$"); 
```

现在匹配必须从字符串的开头开始（用 标记`^`），并且必须在字符串的结尾（用 标记`$`）结束。因此，只允许输入一位数。省略它允许正则表达式匹配您输入的任何子字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T21:54:27.090

```
Regex myRegex = new Regex(@"^\d$"); 
```

# java - 计算句子中超过最小字母要求的单词数的程序

> ID：12943890
> 
> 赞同：0
> 
> 时间：2012-10-17T21:43:55.563
> 
> 标签：java, string, io, word-count

该程序要求您输入一个单词和一个句子的最小长度。该程序的目的是计算一个句子中满足字母长度要求的单词数。有人可以帮我计算一下吗，字数不会增加。

```
public class wordcount {

   public static void main(String[] args) {
      int length = IO.readInt();
      String sentence = IO.readString();
      int full = sentence.length();
      int wordcount = 0;

      for(int i = 0; i == length; i++){
         if(Character.isLetter(sentence.charAt(i)))
            wordcount= wordcount + 1;
      }
      System.out.print(wordcount);
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:47:02.043

改变你的 for 循环： -

```
for(int i = 0; i == length; i++)  // Code in this loop will not run even once. 
```

至： -

```
for(int i = 0; i < length; i++) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:47:26.873

```
for(int i = 0; i == length; i++){ 
```

您的`for`循环立即退出。 `i`肯定不等于`length`; 它是`0`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:51:16.047

在 for 循环中，有三个表达式：

*   初始化
*   终止
*   增量

您的初始化和增量很好，但如果您想要迭代，您的终止表达式没有任何意义。正如其他人所说，将终止表达式更改为`i < length`将纠正此问题，并允许您循环`length`多次，因为`i`将迭代直到它大于`length`，此时终止表达式将被满足并且程序将继续运行。

# excel - Excel 工作簿中 2 列的 UTF-8 编码问题

> ID：12943891
> 
> 赞同：0
> 
> 时间：2012-10-17T21:43:56.587
> 
> 标签：excel, unicode, encoding, utf-8, xlsx

我有一个需要编辑的 Excel 工作簿，但是当我打开它时，其中 2 列有奇怪的编码（我认为）。有以下字符串，而不是正常值（字符串）：

```
¼àãëåíäðîáèëèöàêðàòêîáðîä 
```

和

```
ÏÅËÈÑÒÅÐ-ÁÐÎÄ-ÄÐÎÁÈËÈÖÀ 
```

我检查了文档编码（UTF-8），一切都是用 Arial 字体编写的，并且没有限制（我认为）或隐藏列。我可以编辑所有列，但我需要为这 2 列获取正常值才能继续我的工作。我已经尝试使用不同的编码保存文档，尝试使用 Google 电子表格并尝试在控制面板中更改非 Unicode 程序的语言，但不幸的是没有任何帮助。

有没有办法获得它们的正常值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T23:19:39.023

Excel 可能会将您的文本数据解释为`latin-1`or `windows-1252`，而不是`UTF-8`。导入时是否有输入编码选项？

我能够使用 Open Office 的导出/导入功能解决此类格式问题。

# java - 尝试更新Android中sqlite中最后一条记录中的某个列

> ID：12943892
> 
> 赞同：0
> 
> 时间：2012-10-17T21:43:56.610
> 
> 标签：java, android, sqlite

我有一个这样结构化的数据库

```
uid | username | password |     email   | cur_level
1     default      abc123   me@email.com    0 
```

在我的游戏中，当你完成主要活动的一个关卡后，我会运行一个名为`increase_current_level()` value++ 的方法；test_db.open(); test_db.updateLevel(value); cur_level = 值；test_db.close();

所以这似乎没有问题，但是当`test_db.updateLevel(value)`运行时，当程序崩溃时。

在我的 DBHelper 中，更新级别的代码如下。

```
public boolean updateLevel(String level) {
        ContentValues args = new ContentValues();

        args.put(KEY_CUR_LEVEL, level);
        return mDb.update(DATABASE_TABLE, args, KEY_ROWID + "="
                + "WHERE id=(SELECT max(id) FROM DATABASE_TABLE)", null) > 0;

    } 
```

我的日志猫错误似乎是：

```
10-17 17:36:10.833: E/AndroidRuntime(1815): Caused by: android.database.sqlite.SQLiteException: near "WHERE": syntax error (code 1): , while compiling: UPDATE test SET cur_level=? WHERE _id=WHERE id=(SELECT max(id) FROM DATABASE_TABLE) 
```

我对 SQLite 很陌生，所以这有点吓人，但我希望有人能看到一个非常明显的缺陷。谢谢

## 更新1：

我更新的代码：

```
public boolean updateLevel(String level) {
    ContentValues args = new ContentValues();

    args.put(KEY_CUR_LEVEL, level);
    return mDb.update(DATABASE_TABLE, args, KEY_ROWID + " = (SELECT max(id) FROM DATABASE_TABLE",
            null) > 0;

} 
```

更新了错误信息：

```
10-17 18:26:50.804: E/AndroidRuntime(3684): Caused by: android.database.sqlite.SQLiteException: near "DATABASE_TABLE": syntax error (code 1): , while compiling: UPDATE test SET cur_level=? WHERE _id = (SELECT max(id) FROM DATABASE_TABLE 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:51:01.853

从您的代码中，您的 WHERE 子句可能格式不正确。难道不应该

```
"WHERE id=(SELECT max(id) FROM " + DATABASE_TABLE 
```

代替

```
"WHERE id=(SELECT max(id) FROM DATABASE_TABLE)" 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:54:37.883

的语法`mDb.update`是

```
update(table, ContentValues values, String whereClause, String[] whereArgs) 
```

让我们假设`KEY_ROWID = "id"`

对于你的`whereClause`，你实际上是在通过

```
"id = WHERE id = (SELECT max(id) FROM DATABASE_TABLE" 
```

这不是有效的 SQL。

你似乎不需要“ `id =`”。只需以“ ”开头您的`WHERE`子句`WHERE id=`

但是，您的问题意味着您在数据库中只有一条记录。为什么要为一条记录使用数据库？如果你有多个记录，你应该使用一个`WHERE`搜索独特事物的子句，而不是使用`SELECT max(id)`.

底线是您需要提高对 SQL 的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T21:55:52.237

该`update`函数已将 a`WHERE`放入查询中，并且您已复制列名 ( `KEY_ROWID`and `"id"`)。采用：

```
mDb.update(..., KEY_ROWID + "= (SELECT ...)"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-18T00:12:22.530

如果您的表只有一行，那么您不需要 WHERE 子句。以下语句应更新表中的所有行。如果只存在一条记录，这将解决您的问题。

返回 mDb.update(DATABASE_TABLE, args, null, null) > 0;

如果存在不止一行，则在调用更新函数之前，您需要知道要更新的行的 uid。在这种情况下，它看起来像这样......

String dbID = "你要更新的行的唯一id";

return mDb.update(DATABASE_TABLE, args, "id=?", new String[]{dbID}) > 0;

希望这可以帮助。

# jquery - hoverIntent 有条件的

> ID：12943896
> 
> 赞同：1
> 
> 时间：2012-10-17T21:44:12.500
> 
> 标签：jquery, hoverintent

所以我正在尝试使用[hoverIntent](http://cherne.net/brian/resources/jquery.hoverIntent.html)来控制某些图像上的延迟悬停。暂时悬停时图像会放大。不过，这是有条件的，我似乎无法理解它。如果它在屏幕的左侧，它会像平常一样放大，但如果它在屏幕的右侧，它也会向左移动。

```
$(".card").live('click', function () {
    windowWidth = $(window).width();
    var id = $(this).attr('id');
    var offset = $(this).offset();
    var pos = offset.left;

        if (windowWidth - pos < 500) {      
            var config = {
                over: alert(id+" right"),
                timeout: 500,
                out: alert('out'),
                sensitivity: 7,
                interval: 500
            }
        $(this).hoverIntent( config )           
        }

        else (pos < 500) {
            var config = {
                over: alert(id+" left"),
                timeout: 500, 
                out: alert('out'),
                sensitivity: 7,
                interval: 500
            }
            $(this).hoverIntent( config )
        }
}) 
```

现在，我真的很希望它在没有该`.live('click')`功能的情况下工作（这只是为了测试目的而单击），但我不知道如何将我的变量分配给鼠标悬停的内容（以定位图像）。

理想情况下，我想做一个`.live('hoverIntent')`，但这不起作用，或者我只是不确定如何完成它。

有些东西告诉我，我把整个事情搞砸了。 [http://magic.cardbinder.com/](http://magic.cardbinder.com/)进行测试。感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T22:47:07.320

## 委托点击并放弃意图插件

如果要委托事件，请在带有选择器的主体上使用 $.on 将它们固定到 .card 元素。

```
$("body").on("click", ".card", function(){
    //event script here
}); 
```

至于脚本的其余部分，我认为您可能想要一些更健壮的东西。

首先检查图像离屏幕多远。屏幕宽度会有所不同，因此如果 a) 图像仅偏离 10px，b) 图像偏离屏幕超过 500px，则在屏幕上将其敲回 500px 不会削减它。

接下来，您将需要重新考虑意图插件；真的有必要吗？自己写会更好：

```
var tOut;

$("body").on("mouseover", ".card", function(){
    clearTimeout(tOut);
    tOut = setTimeout(function(){
        //enlarge!
    }, 300);
}); 
```

这只是一个开始，但它应该有助于朝着正确的方向发展

# macos - 无法在 appleScript 中设置窗口大小

> ID：12943897
> 
> 赞同：0
> 
> 时间：2012-10-17T21:44:16.563
> 
> 标签：macos, applescript

嗨，

我正在编写一个脚本，它必须设置窗口的位置和大小。

我需要调整大小的应用程序是 AIR 应用程序。

设置的位置没问题，但是设置的大小什么都不做。

我已经简化了这个例子的脚本：

```
tell application "System Events" to tell application process "adl"  
    display dialog (get name of window 1)  
    set position of window 1 to {50, 50}    
    set size of window 1 to {100, 100}  
end tell 
```

你可以帮帮我吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T02:56:23.670

您可以更改`position`窗口的 ，但不能更改`size`。

原因：

1- 此窗口的大小有限制（最小、最大或两者），因此您不能调整大小低于或高于这些限制。

2-这个窗口有一个定义的大小，所以没有缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T22:22:22.327

编辑：我原来的评论是不正确的，因此被删除以免混淆任何人。以下脚本确实显示了具有大小和位置属性的进程窗口。

```
tell application "System Events"
    tell process "Safari"
        properties of window 1
    end tell
end tell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-07T08:05:15.907

此代码适用于本机`macOS`应用程序并将窗口大小调整为全屏。

```
tell application "Finder"
    set maximum_size to bounds of window of desktop
end tell

tell application "Terminal"
    set the bounds of the first window to maximum_size
    activate
end tell 
```

我不知道AIR。来源[在这里](https://www.labnol.org/software/resize-mac-windows-to-specific-size/28345/)。

# css - @import less 文件在另一个 less 中不起作用

> ID：12943898
> 
> 赞同：0
> 
> 时间：2012-10-17T21:44:19.490
> 
> 标签：css, less, umbraco, dotless

我已经关注了这篇博文：[url](http://our.umbraco.org/wiki/recommendations/recommended-reading-for-web-developers/less-and-integration-into-umbraco)与 Umbraco 的集成更少。此外，在我的 mac 上工作时，我正在使用 SimpLESS 应用程序将我的 less 编译为 css，它运行成功。我已将所有较少的文件上传到服务器上，并在虚拟目录上设置了正确的 mime 类型。该网站未显示任何未找到的文件或任何其他错误，但此[url](http://www.siddharthkpandey.co.uk/scripts/less/bootstrap.less)仅显示了我的 less 文件的内容，并且不会像在本地那样编译。

后续步骤：

1.  将 dotless.core.dll 添加到 bin 文件夹。
2.  HTTP 处理程序添加到 web.config。
3.  引用 master.aspx 中的 less 文件
4.  所有较少的文件都在 Scripts 文件夹下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:48:39.243

当根据 IIS6 的 web.config 下的 less 处理程序时，它不起作用`<!-- LESS --> <add path="*.less" verb="GET" type="dotless.Core.LessCssHttpHandler, dotless.Core" />`

但是当我将上面的内容更改`<remove name="DotLessCss" /> <add name="DotLessCss" verb="*" path="*.less" type="dotless.Core.LessCssHttpHandler, dotless.Core"`为 IIS7.5 时，服务器就可以渲染得更少了。

# python - 使用 Python 基于模板创建 PDF

> ID：12943904
> 
> 赞同：-3
> 
> 时间：2012-10-17T21:44:58.933
> 
> 标签：python, django, templates, pdf

我需要创建一个包含一些文本和文本框的 PDF，它们应该出现在我公司的信头模板上。它将覆盖多个页面-并且每个页面都应以信头作为背景（不能是图像，因为信头中的链接等需要可点击且文本可复制）。

知道如何使用 python 做到这一点吗？理想情况下，它会来自 django 网络应用程序。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:59:08.100

有几种方法可以在 python 中创建 PDF。[reportlab](http://www.reportlab.com/software/opensource/)库可能是最简单的。它[由 django 支持](https://docs.djangoproject.com/en/dev/howto/outputting-pdf/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T08:18:29.957

我使用reportlab，效果很好。但是学习如何绘制 pdf 和设计代码需要一些时间。您需要使用代码绘制所有内容。

如果您的要求很简单，您可以使用一些 html to pdf framwork 来代替 reportlab（rml 不是免费的），例如 pisa。这很简单。

希望对您有所帮助。

# memory-management - 调试内核模块（内存损坏_

> ID：12943906
> 
> 赞同：6
> 
> 时间：2012-10-17T21:45:08.747
> 
> 标签：memory-management, linux-kernel, arm, linux-device-driver

我正在调试我的内核模块，它似乎有内存损坏，基本上由 alloc_netdev() 为“net_device”实例分配的一块内存已损坏。

1）我在我的内核中打开了`CONFIG_DEBUG_KERNEL`, `CONFIG_DEBUG_SLAB`，但是不确定会发生什么。是否应该在我阅读时打印出可疑内存泄漏的跟踪转储？有没有办法重置累积的统计信息/信息？最重要的 - 任何人都可以帮助破译输出，例如：`CONFIG_DEBUG_KMEMLEAK``.config``kmemleak``/sys/kernel/debug/kmemleak``kmemleak`

```
unreferenced object 0xc625e000 (size 2048):
  comm "swapper", pid 1, jiffies 4294937521
  backtrace:
    [<c00c89f0>] create_object+0x11c/0x200
    [<c00c6764>] __kmalloc_track_caller+0x138/0x178
    [<c01d78c0>] __alloc_skb+0x4c/0x100
    [<c01d8490>] dev_alloc_skb+0x18/0x3c
    [<c0198b48>] eth_rx_fill+0xd8/0x3fc
    [<c019ac74>] mv_eth_start_internals+0x30/0xf8
    [<c019c5fc>] mv_eth_start+0x70/0x244
    [<c019c810>] mv_eth_open+0x40/0x64
    [<c01e00f0>] dev_open+0xb4/0x118
    [<c01df788>] dev_change_flags+0x90/0x168
    [<c001a3e4>] ip_auto_config+0x1bc/0xecc
    [<c00212f4>] do_one_initcall+0x5c/0x1bc
    [<c00083d0>] kernel_init+0x8c/0x108
    [<c0022f58>] kernel_thread_exit+0x0/0x8
    [<ffffffff>] 0xffffffff 
```

2）我还想知道是否可以在此内存上应用一些“只读”属性，这种方式我希望`Oops`在有人尝试修改内存时生成。听起来合理吗？

感谢任何建议，谢谢。

标记

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-18T07:10:59.730

要捕获不正确的内存访问，[KAsan](https://www.kernel.org/doc/Documentation/kasan.txt)或[kmemcheck](http://www.mjmwired.net/kernel/Documentation/kmemcheck.txt)可能更有用。但是请注意，众所周知，Kmemcheck 会产生重大影响，这有时可能是不可接受的，因此由您决定。KASan 应该快得多。

1.关于kmemleak，其操作在[内核文档](http://www.mjmwired.net/kernel/Documentation/kmemleak.txt)中有详细描述。

总之，执行起来更靠谱

```
echo scan > /sys/kernel/debug/kmemleak 
```

以 root 身份在您阅读之前立即触发内存分析`/sys/kernel/debug/kmemleak`。有时，我发现在阅读 kmemleak 的报告之前执行两次上述命令更可靠。

要“重置” kmemleak 收集的数据，您可以执行

```
echo clear > /sys/kernel/debug/kmemleak 
```

您发布的输出意味着 kmemleak 认为`0xc625e000`在该工具上次分析内存时尚未释放地址处大小为 2Kb 的内存区域。回溯指定内存的分配位置。“swapper”是已分配该内存区域的进程的名称。

2\. 就设置内存只读而言，这种技术确实在内核的某些地方使用，例如保护内核本身的代码和模块。我不能在这里给你确切的说明，但是[set_page_attributes() 函数](http://lxr.free-electrons.com/ident?i=set_page_attributes)的实现是一个开始深入研究的好地方。

请注意，我上面提到的 kmemcheck 使用了一种有点类似的技术来跟踪内存访问：使页面“看起来”好像它们不存在，以便每次访问它们都会导致页面错误等。和往常一样，详细信息在[内核文档中。](http://www.mjmwired.net/kernel/Documentation/kmemcheck.txt)

# c# - GetHashCode() 返回值应该基于原始对象的状态还是修改后的对象的状态？

> ID：12943909
> 
> 赞同：3
> 
> 时间：2012-10-17T21:45:22.973
> 
> 标签：c#, generics, dictionary, gethashcode, iequatable

我最近用几种不同的方式问过这个问题，但没有得到一个答案来告诉我`<T,U>`当我持有对发生变化的事物的引用时需要如何处理字典`T.GetHashCode()`。对于这个问题，“状态”是指在检查时也会检查的属性和字段`Equals()`。假设所有公共、内部和受保护的成员都包括在内。

鉴于我有一个 C# 对象

*   覆盖 GetHashCode 和 Equals

*   该对象作为Key值保存到Dictionary中（注意我的理解是Dictionary此时会读取GetHashCode值）

*   我通过 Key 搜索对象并修改一个值。（修改此值会修改我的自定义 equals 函数和可能的 gethashcode）

我的问题是，GetHashCode 应该反映什么？这个函数的返回应该反映对象的原始状态还是修改后的状态？

**示例代码**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TrustMap
{
    class Program
    {
       static  Dictionary<Model.TrustedEntityReference, string> testDictionary = new Dictionary<Model.TrustedEntityReference, string>();

        static void Main(string[] args)
        {
            Model.TrustedEntity te = new Model.TrustedEntity();

            te.BackTrustLink = null;
            te.ForwardTrustLink = null;
            te.EntryName = "test1";

            var keyValue =  new Model.TrustedEntityReference()
            {
                HierarchyDepth = 1,
               trustedEntity = te 
            };

            testDictionary.Add(keyValue, "some data");

            // Now that I have a reference to the Key outside the object
            te.EntryName = "modified data";

            // Question: how should TE respond to the change, considering that it's a part of a dictionary now?
            //           If this is a implementation error, how should I track of objects that are stored as Keys that shouldn't be modified like I did in the previous line?

        }
    }

}

namespace Model
{
    public class TrustedEntity
    {
        public TrustedEntity()
        {
            this.BackTrustLink = new List<TrustedEntityReference>();
            this.ForwardTrustLink = new List<TrustedEntityReference>();
        }

        public List<TrustedEntityReference> BackTrustLink { get; set; }

        public string EntryName { get; set; }

        public List<TrustedEntityReference> ForwardTrustLink { get; set; }

    }

    public class TrustedEntityReference 
    {
        public int HierarchyDepth { get; set; }
        public TrustedEntity trustedEntity {get; set; }

        public override bool Equals(object obj)
        {
            if (obj.GetType() != trustedEntity.GetType())
                return false;

            TrustedEntity typedObj = (TrustedEntity)obj;

            if (typedObj.BackTrustLink != null)
            { 
                if (trustedEntity.BackTrustLink != typedObj.BackTrustLink)
                    return false;
            }

            if (typedObj.ForwardTrustLink != null)
            {
                if (trustedEntity.ForwardTrustLink != typedObj.ForwardTrustLink)
                    return false;
            }

            if (trustedEntity.EntryName != typedObj.EntryName)
                return false;

            return true;
        }

        /// <summary>
        /// If the hash-code for two items does not match, they may never be considered equal
        /// Therefore equals may never get called.
        /// </summary>
        /// <returns></returns>
        public override int GetHashCode()
        {

            // if two things are equal (Equals(...) == true) then they must return the same value for GetHashCode()
            // if the GetHashCode() is equal, it is not necessary for them to be the same; this is a collision, and Equals will be called to see if it is a real equality or not.
           // return base.GetHashCode();
            return StackOverflow.System.HashHelper.GetHashCode<int, TrustedEntity>(this.HierarchyDepth, this.trustedEntity);
        }
    }

}

namespace StackOverflow.System
{
    /// <summary>
    /// Source https://stackoverflow.com/a/2575444/328397
    /// 
    /// Also it has extension method to provide a fluent interface, so you can use it like this:
///public override int GetHashCode()
///{
///    return HashHelper.GetHashCode(Manufacturer, PartN, Quantity);
///}
///or like this:

///public override int GetHashCode()
///{
///    return 0.CombineHashCode(Manufacturer)
///        .CombineHashCode(PartN)
///        .CombineHashCode(Quantity);
///}
    /// </summary>
    public static class HashHelper
    {
        public static int GetHashCode<T1, T2>(T1 arg1, T2 arg2)
        {
            unchecked
            {
                return 31 * arg1.GetHashCode() + arg2.GetHashCode();
            }
        }

        public static int GetHashCode<T1, T2, T3>(T1 arg1, T2 arg2, T3 arg3)
        {
            unchecked
            {
                int hash = arg1.GetHashCode();
                hash = 31 * hash + arg2.GetHashCode();
                return 31 * hash + arg3.GetHashCode();
            }
        }

        public static int GetHashCode<T1, T2, T3, T4>(T1 arg1, T2 arg2, T3 arg3,
            T4 arg4)
        {
            unchecked
            {
                int hash = arg1.GetHashCode();
                hash = 31 * hash + arg2.GetHashCode();
                hash = 31 * hash + arg3.GetHashCode();
                return 31 * hash + arg4.GetHashCode();
            }
        }

        public static int GetHashCode<T>(T[] list)
        {
            unchecked
            {
                int hash = 0;
                foreach (var item in list)
                {
                    hash = 31 * hash + item.GetHashCode();
                }
                return hash;
            }
        }

        public static int GetHashCode<T>(IEnumerable<T> list)
        {
            unchecked
            {
                int hash = 0;
                foreach (var item in list)
                {
                    hash = 31 * hash + item.GetHashCode();
                }
                return hash;
            }
        }

        /// <summary>
        /// Gets a hashcode for a collection for that the order of items 
        /// does not matter.
        /// So {1, 2, 3} and {3, 2, 1} will get same hash code.
        /// </summary>
        public static int GetHashCodeForOrderNoMatterCollection<T>(
            IEnumerable<T> list)
        {
            unchecked
            {
                int hash = 0;
                int count = 0;
                foreach (var item in list)
                {
                    hash += item.GetHashCode();
                    count++;
                }
                return 31 * hash + count.GetHashCode();
            }
        }

        /// <summary>
        /// Alternative way to get a hashcode is to use a fluent 
        /// interface like this:<br />
        /// return 0.CombineHashCode(field1).CombineHashCode(field2).
        ///     CombineHashCode(field3);
        /// </summary>
        public static int CombineHashCode<T>(this int hashCode, T arg)
        {
            unchecked
            {
                return 31 * hashCode + arg.GetHashCode();
            }
        }
    }

} 
```

基于[Jon Skeet 的这个回答](https://stackoverflow.com/a/10708937/328397)（对我之前的问题）

> “如果我更改了最终会更改键值的属性，我该怎么办？” - 我

.

> “基本上你已经被塞满了。你不会（或至少可能不会）再次在字典中找到那个键。你应该尽可能小心地避免这种情况。就我个人而言，我通常会发现那些是字典键的良好候选者，*也是*不变性的良好候选者。” - JS

这是否意味着我需要从 Dictionary 中删除该对象并重新添加它？这是正确/最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:31:01.967

好的，澄清一下：您正在修改键/值对的*键部分。*

既然问题已经清楚了，答案就相对简单了：

> 这是否意味着我需要从 Dictionary 中删除该对象并重新添加它？

是的。*但是*- 你必须在修改它*之前删除它。*所以你会写：

```
testDictionary.Add(keyValue, "some data");
// Do whatever...

testDictionary.Remove(keyValue);
te.EntryName = "modified data";
testDictionary.Add(keyValue, "some data"); // Or a different value... 
```

但总的来说，仅使用不可变数据结构作为字典键的风险要小得多*。*

另请注意，目前您的`Equals`方法依赖于所涉及的两个列表的*引用*相等 - 这真的是您想要的吗？此外，您没有覆盖`GetHashCode`in `TrustedEntity`，因此即使您*确实*使用相同的列表创建了一个新`TrustedEntity`列表，它也不会给您想要的结果。基本上，不清楚您想要哪种相等操作 - 您需要自己澄清这一点，然后理想地创建所涉及数据的不可变表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-16T02:51:23.573

是否`GetHashCode()`应该改变的问题有点牵强附会。我建议六个公理：

1.  每个对象都应始终被观察为与自身相等。
2.  如果曾经观察到一个对象与另一个对象相等，则两个对象应该永远更多地报告自己彼此相等。
3.  如果曾经观察到一个对象与另一个对象不相等，则两个对象应该永远更多地报告自己与另一个对象不相等。
4.  如果曾经观察到一个物体与另一个物体相等，并且观察到其中一个物体等于第三个物体，那么两者都应该永远更多地报告自己等于那个第三个物体。
5.  如果曾经观察到一个对象与另一个对象相等，并且观察到其中一个对象不等于第三个对象，那么两者都应该永远报告自己不等于第三个对象。
6.  对一个对象的哈希码的观察表示它与曾经返回不同哈希码的每个对象都不相等。

对象的哈希码不变的要求不是公理之一，而是源自点 #1 和 #6；对一个对象的哈希码的观察与之前的观察不同，将构成一个观察，即该对象不等于它自己。

# sql-server - Sql Server 2012 SSIS 集成服务目录

> ID：12943911
> 
> 赞同：1
> 
> 时间：2012-10-17T21:45:28.810
> 
> 标签：sql-server, ssis, sql-server-2012

尝试在 Sql Server 2012 SSIS 中创建 IS 目录时出现以下错误。

```
> TITLE: SQL Server Integration Services
------------------------------

Operation 'Create' on object 'CatalogFolder[@Name='DeployTest']' failed during execution. (Microsoft.SqlServer.Management.Sdk.Sfc)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=11.0.2100.60+((SQL11_RTM).120210-1917+)&LinkId=20476

------------------------------
ADDITIONAL INFORMATION:

Exception has been thrown by the target of an invocation. (mscorlib)

------------------------------

The type initializer for '<Module>' threw an exception. (Microsoft.SqlServer.BatchParserClient)

------------------------------

Loading this assembly would produce a different grant set from other instances. (Exception from HRESULT: 0x80131401) (Microsoft.SqlServer.BatchParser)

------------------------------
BUTTONS:

OK
------------------------------ 
```

我对 SQL Server 不是很了解，并且对 SSIS 很陌生。我只是尝试做一个测试演示项目来熟悉它，因为我已经编写了一个 WCF 服务来在创建 SSIS 包后执行它，但由于这个问题而无法完成本教程。

在谷歌搜索解决方案时，我在互联网上看到了类似的问题，但它适用于 SQL 2005，而 2012 年则没有。

作为非 DBA 人员，如何在 SQL 2012 上配置 SSIS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:51:11.273

我在 Sql Management Studio 的 Integration Services 目录下添加了文件夹，而不是通过 Visual Studio 2010 的部署向导添加了该文件夹，它可以正常工作。如果其他人遇到此问题，请尝试通过 Sql Server Management Studio 进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-19T08:18:30.303

我遇到了这个问题，因为运行 SQL 实例的用户似乎没有正确的权限。

# ruby-on-rails-3 - 文本链接到带有在 Rails 中传递的搜索参数的结果页面

> ID：12943918
> 
> 赞同：0
> 
> 时间：2012-10-17T21:46:03.413
> 
> 标签：ruby-on-rails-3, search

在我的数据库中有一个名为“ **startDate** ”的列。存储的 startDate 示例是**2000-01-01 12:01:01.000000**。（此日期不同于 Created_at 或 modified_at 日期。它将是此视图的 show.html.erb 中提到的事件发生的日期。）

在一篇文章的显示视图中，我想链接到一个结果（索引）页面，其中将显示类似的微博。我不知道该怎么做。

带有链接的文本可能会这样说：

> 在 2009 年 10 月 17 日星期三之前或之后的 10 天内有 17 场活动。

单词“ **17 events** ”将是结果页面的链接。此特定示例中的搜索跨度总共为**20 天**，其中 2009年**10 月 17 日星期三**之前的 10**天和****之后**的 10 天。

 ****这是我当前的 show.html.erb 页面。

```
<div class="row">
  <div class="span2"><center><img src=<%= @micropost.imageURL %> class="img-polaroid"></center></div>

  <div class="span7">
        <h3><%= @micropost.title %></h3><br>
        <p><small><%= @micropost.loc1T %><br>
            <%= @micropost.startTime.strftime('%A, %B %d, %Y') %></small></p>
        <p><%= raw @micropost.content %></p>
    </div>

  <div class="span3"><img src="http://placehold.it/210x210" class="img-polaroid"><br>
    <small>advertisment</small>
    <div class="divider">&nbsp;</div>
    <div class="well">

    <p>There are <%= link_to(pluralize("event", @microposts.count), "#{microposts_path} related=#{@micropost.id}") %> within 10 days...</p>

  </div>

  </div>
</div> 
```

模型/micropost.rb

```
class Micropost < ActiveRecord::Base
  attr_accessible :content, :title,:keyword,:privacy,:groups,:loc1T,:latitude,:longitude,:loc2T,:loc2Lat,:loc2Lon,:startTime,:endTime,:imageURL
  geocoded_by :loc1T
  after_validation :geocode#, :if => :address_changed?

  belongs_to :user

  validates :user_id, presence: true
  validates :title, presence: true
  validates :keyword, presence: true
  validates :privacy, presence: true
  validates :groups, presence: true
  validates :loc1T, presence: true
  validates :latitude, presence: true
  validates :longitude, presence: true
  validates :loc2T, presence: true
  validates :loc2Lat, presence: true
  validates :loc2Lon, presence: true
  validates :startTime, presence: true
  validates :endTime, presence: true
  validates :imageURL, presence: true

  validates :content, presence: true

  default_scope order: 'microposts.created_at DESC'

  def self.from_users_followed_by(user)
    followed_user_ids = "SELECT followed_id FROM relationships
                         WHERE follower_id = :user_id"
    where("user_id IN (#{followed_user_ids}) OR user_id = :user_id", 
          user_id: user.id)
  end

  def related_microposts(this_startTime)
  @microposts.where('startTime > ? AND startTime < ?', 5.days.since(startTime), 5.days.until(startTime))
  end
end 
```

microposts_controller.rb

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user, only: [:create, :destroy]
  before_filter :correct_user,   only: :destroy

  def index
  end

   def show
    @micropost = Micropost.find(params[:id])
  end

  def related_microposts(this_startDdate)
  Micropost.where('startDate > ? AND startDate < ?', 5.days.since(this_startDate), 5.days.until(this_startDate))
  end

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_url
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end

  def destroy
    @micropost.destroy
    redirect_to root_url
  end

  private

    def correct_user
      @micropost = current_user.microposts.find_by_id(params[:id])
      redirect_to root_url if @micropost.nil?
    end
end 
```

这是数据库列的屏幕截图...

![数据库截图](../Images/16045bc01d3d6a454ebef65a1e833566.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T03:08:59.443

听起来有几个问题需要解决。

（按照 Rails 约定，我将假设您的专栏确实被称为`start_date`:-)）

首先，要获取文章发布`start_date`后 5 天内的文章列表，您可以使用类似

```
def related_articles(this_start_date)
  Article.where('start_date > ? AND start_date < ?', 5.days.since(this_start_date), 5.days.until(this_start_date))
end 
```

我的时间功能可能有误，但[请查看此处了解详情](http://as.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Numeric/Time.html)。

现在`related_articles`有你需要的。如果您只需要计数，您可以使用 获取它`related_articles.count`，或者保存到`@articles`. 在显示当前的主页中`@article`添加一个链接以显示相关文章，例如

```
There are <%= link_to(pluralize("event", @articles.count), "#{articles_path}?related=#{@article.id}") %> within 10 days... 
```

`articles_path`是列出所有文章的视图的路径`index`，所以现在在控制器的`index`方法中添加一些代码，以便在存在特殊查询字符串参数时仅列出那些文章。

```
if params[:related]
  this_article = Article.find params[:related]  # 123 is the id of the main article
  @articles = Article.related_articles(this_article)
else
  @articles = Article.all
end 
```

有点杂乱无章的答案，但我认为它很重要:-)****

# c++ - 这到底是什么意思（C++ 函数指针）？

> ID：12943919
> 
> 赞同：3
> 
> 时间：2012-10-17T21:46:07.780
> 
> 标签：c++, c, function-pointers

所以我在看一些 c++ 源代码，想知道这到底是什么意思。我认为这意味着将 tmp 作为函数调用，但我不确定。

```
char* tmp;
///stuff filling tmp with values
((void (*)())tmp)(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T21:47:53.757

是的，它转换`tmp`为指向不接受任何参数且不返回任何内容的函数的指针，然后调用它。

如果你问我，这看起来像是灾难的秘诀。

# python - Pygame Sound/Font/Delay 似乎有问题

> ID：12943922
> 
> 赞同：3
> 
> 时间：2012-10-17T21:46:18.710
> 
> 标签：python, fonts, delay, pygame, audio

我正在使用 Pygame 制作 Snake 类型的游戏。一切都很好，但下面是我的游戏的结尾。有声音效果，我设置了延迟，所以在声音播放完之前窗口不会关闭。一切都很好，我刚刚添加了 Game Over 文本。出于某种原因，声音响起，游戏暂停，*然后*游戏结束在屏幕上快速闪烁。谁能向我解释为什么这会出现问题？

我在 Mac 10.6.8 上使用 Python 2.7。

```
if w.crashed or w.x<=0 or w.x >= width - 1 or w.y<=0 or w.y >= height -1:
    gameover.play()
    font = pygame.font.Font(None, 80)
    end_game = font.render("Game Over!", True, (255, 0, 0), (0,0,0))
    endRect = end_game.get_rect(centerx = width/2, centery = height / 2)
    screen.blit(end_game, endRect)
    pygame.time.delay(3500)
    running = False 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:16:45.400

会不会是你失踪了`pygame.display.flip()`，或者电话`display.update(rectangle=endRect)`刚打完`screen.blit()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T22:08:15.483

我认为您的问题出在`running`变量上。如果这结束了您的主 while 循环*，它将结束程序，这将是您的问题。

*主while循环：

```
while running:
    #everything that the program does goes here 
```

大多数游戏都有一个，并且做任何影响它的事情都会破坏循环，因此结束程序中的所有内容。由于您在问题中显示的代码将在该循环内，因此不会播放文本和声音。

我知道python在找到延迟命令时暂停程序是有意义的，但它实际上并没有真正暂停程序。它只是暂停*pygame*。该程序将继续运行，分配`running`给`false`，并且您的循环刚刚结束。字体不会渲染，因为它在循环中，并且声音不会播放，因为 pygame 已暂停。它永远不会取消暂停，因为这将是一个在 while 循环中调用的事件，现在该循环已关闭。

作为旁注，Pygame 保持“冻结”窗口打开的原因是因为屏幕上每个其他图像和字体的变量保持不变，并且没有被告知关闭。

当然，如果`running`变量不是我认为的那样，那么整个答案可能会浪费我们俩的时间。

一个有价值的问题:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-19T03:23:28.293

```
pygame.display.flip() should be done before `pygame.time.delay(3500)`. 
```

将您的代码更改为此

```
if w.crashed or w.x<=0 or w.x >= width - 1 or w.y<=0 or w.y >= height -1:
    gameover.play()
    font = pygame.font.Font(None, 80)
    end_game = font.render("Game Over!", True, (255, 0, 0), (0,0,0))
    endRect = end_game.get_rect(centerx = width/2, centery = height / 2)
    screen.blit(end_game, endRect)

    pygame.display.update()

    pygame.time.delay(3500)

    running = False 
```

# javascript - 使用 javascript 在 span 标签中组织元素

> ID：12943926
> 
> 赞同：0
> 
> 时间：2012-10-17T21:46:38.263
> 
> 标签：javascript, html

我有一个 span 元素`R`和`space, chk, and text`分别包含换行符、复选框元素和文本节点的元素。

这是我用来附加元素的javascript：

```
 R.appendChild(space);
     R.appendChild(chk);
     R.appendChild(txt); 
```

和跨度的 HTML：

```
Selected   Address    <span style="position:absolute: top:100px; right:700px;"id="results">&nbsp;</span> 
```

组织这些元素以便将它们打印在页面上的行/列论坛中的有效方法是什么？像这样：

```
Selected     Address

checkbox     64-21 broad street
checkbox     58-99 narrow street 
```

我正在动态生成这些元素，因此必须用 javascript 编写并自动化。在旁注中，我也无法在页面上定位跨度。更改样式属性中的“位置”似乎对其没有影响。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:54:08.557

看起来像表格数据，所以使用 HTML 表格：[http ://www.w3schools.com/tags/tag_table.asp](http://www.w3schools.com/tags/tag_table.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T22:14:47.407

关于跨度元素的小问题......

在跨度的`style`属性中，第二个冒号（在“绝对”和“顶部”之间）是错字吗？看起来它应该是一个分号。

不知道如果您使用 HTML 表格结构（正如其他人已经建议的那样），跨度是否仍然相关，但是...... :-)

# ravendb - RavenDB 多租户：单个实例上会话数的实际上限是多少？

> ID：12943931
> 
> 赞同：4
> 
> 时间：2012-10-17T21:46:52.833
> 
> 标签：ravendb, multi-tenant

我想确保我以正确的方式进行。我正在设计一个多租户应用程序。我计划在单个 raven 实例上为每个租户创建一个数据库，但也希望拥有一个我的代码库的单个实例（即一个部署的 mvc webapi 实例）。

所以我会调用一些服务定位器来获取文档存储的单例实例，然后将租户标识符传递给它，以便我可以针对适当的会话进行操作（每个租户数据库一个会话）。

假设每个租户数据库相对较小（在数十万个文档中），事务量相当低（每个租户有数百个用户）..期望在单个服务器上运行多个租户是否现实?

我知道这是一个开放式的橙子到苹果的问题，但我正在寻找的答案是
a) 是的，这是使用 raven 进行多租户的标准方法，并且受硬件限制，或者 b) 你正在解决这个问题错误，并且无论内存/计算容量如何，在少数租户之后这都会失败

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-18T06:29:56.627

戴夫，这是标准方法。您应该能够在单个实例上运行至少数百个租户。我们已经看到有数千个多租户服务器，但这在很大程度上取决于实际负载。

# jsp - 在 HTML 元素中使用 c:out 和 fn 的区别

> ID：12943934
> 
> 赞同：0
> 
> 时间：2012-10-17T21:47:02.770
> 
> 标签：jsp, jstl

这适用于我的 JSP

```
<input type="text" name="first_name" value="<c:out value="${registration.firstName}"/>" size="32" > 
```

上面的行在文本输入中显示了实际的名字

如果我试试这个

```
<input type="text" name="first_name" value="${registration.firstName}" size="32" > 
```

或者

```
<input type="text" name="first_name" value="${fn:escapeXml(registration.firstname)}"/> 
```

输入框只显示 ${registration.firstName} 和 ${fn:escapeXml(registration.firstname)} 分别，我做错了什么？

# heroku - 如何同时使用 Gmail、Heroku 和 Zerigo

> ID：12943935
> 
> 赞同：0
> 
> 时间：2012-10-17T21:47:04.603
> 
> 标签：heroku, dns, gmail

我使用 Dynodot 作为我的 ISP。当我尝试在 Dynodot 控制面板中同时设置 CNAME（Heroku 不支持 A 名称）和 MX 记录时，我收到“当域记录设置为 CNAME 时，不允许 MX 记录或电子邮件转发”错误。

所以我正在尝试使用 Zerigo 以“Heroku 方式”做事。

我已经在 Heroku 上使用 Zerigo 成功地从[http://testivate.herokuapp.com为](http://testivate.herokuapp.com)[http://testivate.com](http://testivate.com)提供服务。现在我还需要通过[http://mail.testivate.com](http://mail.testivate.com)访问 Gmail 。

不幸的是，Heroku 的帮助指南中包含了我已经完成的内容的详细信息，并且缺少关于我尚未完成的内容的详细信息：

```
https://devcenter.heroku.com/articles/zerigo_dns 
```

基本上，它只是说：

> 单击“配置”将自动登录到 Zerigo DNS 管理界面。在那里，您可以完全控制管理您的 MX 记录。

但是，当您在 DNS 管理界面中时，您看不到看起来像是用于获取 MX 记录的字段。您看不到任何明显可以放置以下内容的地方，例如：

```
Name/Host/Alias  Time to Live (TTL)  Record Type     Value/Answer/Destination
Blank or @           300                   MX            1 ASPMX.L.GOOGLE.COM
Blank or @           300                 MX          5 ALT1.ASPMX.L.GOOGLE.COM
Blank or @           300                   MX            5 ALT2.ASPMX.L.GOOGLE.COM
Blank or @           300                 MX         10 ASPMX2.GOOGLEMAIL.COM
Blank or @           300                   MX           10 ASPMX3.GOOGLEMAIL.COM 
```

我应该在的特定选项卡的名称是什么？我应该在哪个特定字段中输入这些数据？还有其他步骤吗？谢谢。史蒂文。

后记：

我现在已经设法通过在基本域上设置转发而不是 CNAME 来仅通过 Dynadot 完成此操作，然后让我将 MX 详细信息输入到 Dynadot 控制面板中。但是，我仍然有兴趣知道如何通过 Zerigo 做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T04:39:10.423

If your CNAME record is for the www subdomain, you can set the MX records by not specifying a subdomain.

# php - 轻量级 PHP CRUD

> ID：12943939
> 
> 赞同：0
> 
> 时间：2012-10-17T21:47:25.487
> 
> 标签：php, pdo, crud

我正在寻找一个 PHP CRUD 解决方案，如果可能的话，它具有以下特性：

*   只生成 CRUD 查询而不是 HTML 表单
*   坚固，但重量轻
*   可以处理表关系
*   使用 PDO 或类似的 Db 抽象层

即使解决方案不能涵盖上述所有内容，我仍然对听取意见很感兴趣

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:58:19.130

看看[http://www.phalconphp.com](http://www.phalconphp.com)。

ORM 是用 C 编写的，可以通过自己的 SQL 混合语言提供所有的 CRUD 操作，但在后台使用 PDO。

# jquery - 在变量中使用函数

> ID：12943944
> 
> 赞同：0
> 
> 时间：2012-10-17T21:47:38.237
> 
> 标签：jquery

我已经设置并测试了一个全局函数，以确保它正常工作：

```
function shortenUrl(url) { 
   ...
} 
```

然后我试图在另一个函数的变量中调用该函数，如下所示：

```
var pageLink = $(location).attr('href'),
    shortLink = shortenUrl(pageLink); 
```

所以当我尝试运行它时，我得到一个未定义的错误。但是，如果我将 pageLink 变量从使用 jQuery 查找页面 url 更改为硬编码的内容，例如“http://example.com”和 console.log，则全局函数中的值将返回一个缩短链接。

我只是像这样评论回电：

```
//return shortUrl;
console.log(shortUrl); 
```

这在控制台中给了我正确的值。但它没有返回到我的 shortLink 变量，因为它仍然显示为未定义。我在这里错过了一些简单的东西吗？为什么值没有返回到 shortLink 变量，为什么使用 jQuery 动态创建的链接会通过函数？

更新编辑：

好的，只需稍微重置一下。我认为问题在于shortcutUrl 函数或我如何将值传递给它。只是为了测试我这样做的功能：

```
 function shortenUrl(url) {

        var url = url,
            username = 'username',
            key = 'api key';

        $.ajax({
            url: 'http://api.bit.ly/v3/shorten',
            data: {
                longUrl: url,
                apiKey: key,
                login: username
            },
            dataType: 'jsonp',
            success: function (v) {
                var shortUrl = v.data.url;
                return shortUrl;
                //console.log(shortUrl);
            }
        });
    }

var shorten = shortenUrl('http://google.com');
console.log(shorten); 
```

Console.log(shorten) 返回未定义。但是，如果我取消注释 console.log(shortUrl); 并注释掉 return shortUrl；在函数中，我得到了从 bit.ly 返回的正确缩短的 URL。

为什么我不能在 console.log(shorten) 中获得正确的缩短 url？传递的变量是否错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:53:00.600

您的`shortenUrl`函数中应该有一个返回 url，它返回缩短的 url，如下所示：

```
function shortenUrl(url) {
   var shortUrl = url; // for the sake of simplicity
   return shortUrl;
} 
```

我很好奇我的小费是否可以，请让我们都知道。

**更新**：

```
$(window).load(function(){
function shortenUrl(url) {

    var url = url,
        username = 'bit.ly username',
        key = 'api Key';

    $.ajax({
        url: 'http://api.bit.ly/v3/shorten',
        data: {
            longUrl: url,
            apiKey: key,
            login: username
        },
        dataType: 'jsonp',
        success: function(v) {
            var shortUrl = v.data.url;
            return shortUrl;
        }
    });
}

function some() {
    var pageLink = $(location).attr('href'),
        shortenLink = shortenUrl(pageLink);

    var link = $('<a href="' + shortenLink + '">Shorten Link</a>');
    link.prependTo('element');
}
}); 
```

由于缺少密钥和用户名，我无法尝试该代码，但这应该可以。确保将两者都替换为正确的并调用代码，如下所示：

```
some(); 
```

并始终注意浏览器控制台的错误/警告！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T22:26:38.027

老实说，我没有太多经验，`jsonp`但 ajax 调用应该返回[promise](http://api.jquery.com/category/deferred-object/)。如果`shortenUrl`函数返回了该承诺，那么在调用者中您可以`done`像这样使用：

```
 function shortenUrl(url) {

        var url = url,
            username = 'bit.ly username',
            key = 'api Key';

        return $.ajax({
            url: 'http://api.bit.ly/v3/shorten',
            data: {
                longUrl: url,
                apiKey: key,
                login: username
            },
            dataType: 'jsonp'
        });
    }

    function modifyDom(v) {
        var shortUrl = v.data.url,
            link = $('<a href="' + shortenLink '">Shorten Link</a>');
        link.prependTo('element');
    }    

    $( function() {
        var pageLink = $(location).attr('href');
        shortenUrl(pageLink)
            .done( modifyDom },
    }​ ); 
```

虽然这段代码没有经过测试，但我希望你能明白。

# image - Imagemagick 在 mac os x 山狮上找不到 .tiff 格式的代表库

> ID：12943947
> 
> 赞同：43
> 
> 时间：2012-10-17T21:47:49.993
> 
> 标签：image, macos, imagemagick, homebrew

我无法将 .tiff 文件转换为其他格式。

这是一些调试输出：

```
$ convert -list configure

Path: /usr/local/Cellar/imagemagick/6.7.7-6/lib/ImageMagick/config/configure.xml

Name          Value
-------------------------------------------------------------------------------
CC            cc
CFLAGS        -D_THREAD_SAFE -D_THREAD_SAFE -pthread -g -O2 -Wall -D_THREAD_SAFE -pthread
CODER_PATH    /usr/local/Cellar/imagemagick/6.7.7-6/lib/ImageMagick/modules-Q16/coders
CONFIGURE     ./configure  '--disable-osx-universal-binary' '--without-perl' '--prefix=/usr/local/Cellar/imagemagick/6.7.7-6' '--disable-dependency-tracking' '--enable-shared' '--disable-static' '--without-pango' '--with-included-ltdl' '--with-modules' '--disable-openmp' '--without-gslib' '--with-gs-font-dir=/usr/local/share/ghostscript/fonts' '--without-x' 'CC=cc' 'CXX=c++'
CONFIGURE_PATH /usr/local/Cellar/imagemagick/6.7.7-6/etc/ImageMagick/
COPYRIGHT     Copyright (C) 1999-2012 ImageMagick Studio LLC
CPPFLAGS      -I/usr/local/Cellar/imagemagick/6.7.7-6/include/ImageMagick
CXX           c++
CXXFLAGS      -g -O2 -D_THREAD_SAFE -pthread
DEFS          -DHAVE_CONFIG_H
DELEGATES     bzlib freetype jpeg jng png xml zlib
DISTCHECK_CONFIG_FLAGS 'CC=cc' 'CXX=c++' --disable-deprecated --with-quantum-depth=16 --with-umem=no --with-autotrace=no --with-gslib=no --with-fontpath= --with-gs-font-dir=/usr/local/share/ghostscript/fonts --with-pango=no --with-wmf=no --with-perl=no
DOCUMENTATION_PATH /usr/local/Cellar/imagemagick/6.7.7-6/share/doc/ImageMagick
EXEC-PREFIX   /usr/local/Cellar/imagemagick/6.7.7-6
EXECUTABLE_PATH /usr/local/Cellar/imagemagick/6.7.7-6/bin
FEATURES      OpenCL
FILTER_PATH   /usr/local/Cellar/imagemagick/6.7.7-6/lib/ImageMagick/modules-Q16/filters
HOST          x86_64-apple-darwin12.1.0
INCLUDE_PATH  /usr/local/Cellar/imagemagick/6.7.7-6/include/ImageMagick
LDFLAGS       -L/usr/local/Cellar/imagemagick/6.7.7-6/lib -L/usr/local/Cellar/freetype/2.4.10/lib
LIB_VERSION   0x677
LIB_VERSION_NUMBER 6,7,7,6
LIBRARY_PATH  /usr/local/Cellar/imagemagick/6.7.7-6/lib/ImageMagick
LIBS          -lMagickCore -lfreetype -ljpeg -lbz2 -lz -lm -Wl,-framework,OpenCL -lm -lpthread
NAME          ImageMagick
PCFLAGS
PREFIX        /usr/local/Cellar/imagemagick/6.7.7-6
QuantumDepth  16
RELEASE_DATE  2012-09-18
SHARE_PATH    /usr/local/Cellar/imagemagick/6.7.7-6/share/ImageMagick
SVN_REVISION  8165
TARGET_CPU    x86_64
TARGET_OS     darwin12.1.0
TARGET_VENDOR apple
VERSION       6.7.7
WEBSITE       http://www.imagemagick.org

Path: [built-in]

Name          Value
-------------------------------------------------------------------------------
NAME          ImageMagick 
```

我曾尝试卸载/安装 libtiff、imagemagick，但无法正常工作

```
$ brew uninstall libtiff
$ brew install imagemagick
$ brew uninstall imagemagick
$ brew install imagemagick 
```

知道我的安装有什么问题吗？提前致谢，

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2012-10-31T02:56:42.477

我一直有同样的问题，只是设法解决它。

```
brew install libtiff
brew install imagemagick --with-libtiff 
```

我尝试了多次卸载和重新安装 imagemagick 和 libtiff 的组合，但每次都得到相同的结果。我希望 brew 能神奇地获取 libtiff 并将其链接。

我最终`with-libtiff`通过查看命令的输出找到了该选项

```
brew info imagemagick 
```

*在 2013 年 1 月 30 日之前，该期权被调用`--use-tiff`。*

# android - Facebook 身份验证 SSO 与 WebView

> ID：12943951
> 
> 赞同：0
> 
> 时间：2012-10-17T21:48:02.870
> 
> 标签：android, facebook

我正在使用 Facebook SDK 制作一个 Android 应用程序。我有以下关于身份验证的问题。

根据 FB 的文档，如果我们安装了 Android 的原生 FB 应用程序并启用了应用程序的 Facebook 登录页面（FB 开发人员面板），那么我们的身份验证使用原生 FB 应用程序进行身份验证，该过程将是一个 SSO。

如果我使用 WebView 对 Dialog 进行身份验证怎么办？不是单点登录？它只是 OAuth 吗？它有什么区别？

在我在 Eclipse + ADT 中进行的测试中，不是所有的模拟器，即使使用 Android 的本机 FB 应用程序，我也会启动这个应用程序进行登录（仅在某些情况下，使用相同的源代码）。你会发生在任何人身上吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:53:25.747

webview 对话框将执行 SSO（使用 OAuth），但用户必须在对话框中输入他们的用户名和密码。如果您安装了本机应用程序，如果用户尚未登录，它将要求用户使用 Facebook 应用程序的登录屏幕登录。如果用户已登录 Facebook 应用程序，他们将不必再次登录。

# ibm-mobilefirst - 如何使用 JQuery 获取 HTML% 选择选项值

> ID：12943956
> 
> 赞同：0
> 
> 时间：2012-10-17T21:48:43.837
> 
> 标签：ibm-mobilefirst

我有 HTML5 代码：选择项目：

和后面的代码：

```
function fillItemsList(jsonResponse){
    var data = jsonResponse.invocationResult;
    var itemsString  = data.commodities.toString();
    itemsList = itemsString.split(",");
    $('#selectItem').empty();
    var options = "";
    for (var i = 0; i < itemsList.length; i++) {
        WL.Logger.debug(itemsList[i]);
         options += '<option value= "' + itemsList[i] + '">' + itemsList[i] + '</option>';

    }
    $('#selectItem').html(options);
    busyIndicator.hide();
    //$('#selectItem').Attributes.Add("onChange", "return itemSelectionChange();");
}
function itemSelectionChange(){
    WL.Logger.debug("Selected item changed");
    var index = $('#itemsList').prop("selectedIndex");
    var selectedItem = itemsList[index];
    getDeals(selectedItem);

} 
```

我正在使用 IBM Worklight 创建一个 Web 应用程序并使用此代码。选择下拉列表获取所有值，但更改选择时不会调用该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T07:55:26.897

取决于您使用的 jQuery 版本，但行：

```
//$('#selectItem').Attributes.Add("onChange", "return itemSelectionChange();") 
```

应该是这样的：

```
$('#selectItem').bind('change', function(){return itemSelectionChange();}); 
```

# model - ASP.NET MVC4 从 url 中提取参数并以隐藏的形式发送值

> ID：12943958
> 
> 赞同：1
> 
> 时间：2012-10-17T21:48:59.027
> 
> 标签：model, asp.net-mvc-4, hidden-field

我有一个要传入 url 的参数。当用户单击 URL 时，他们将被带到允许他们输入其他信息的站点。（密码重置）我需要将我传递的令牌作为 url 的一部分并将其放入我提交给另一个控制器的模型中，该控制器验证令牌和密码并在验证后重置密码。我不知道如何在模型中获取传递的参数。

我的控制器：

```
[AllowAnonymous]
public ActionResult TokenPasswordReset(string token)
{
   return View();
} 
```

我生成的网址是

```
http://localhost:53272/Account/TokenPasswordReset?wzBXjkT1Y8qmWIECwSIFYQ2 
```

在我看来，我尝试设置隐藏模型值。

```
<fieldset>
        <legend>Reset Password Form</legend>
        <ol>
            <li>
                @Html.LabelFor(m => m.NewPassword)
                @Html.PasswordFor(m => m.NewPassword)
            </li>
            <li>
                @Html.LabelFor(m => m.ConfirmPassword)
                @Html.PasswordFor(m => m.ConfirmPassword)
            </li>
        </ol>
        @Html.HiddenFor(model.UserToken = Request.Params["token"])
        <input type="submit" value="TokenPasswordReset" />
    </fieldset> 
```

密码和确认密码都可以。我不知道如何从 url 中提取令牌并将其放入 model.UserToken 中。当我这样做时，我收到一条错误消息

> 当前上下文中不存在名称“模型”

编辑：当我按照下面的建议更改为模型时，我收到一个新错误。由于某种原因，它不会在 HiddenFor 中选择模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:08:45.090

**详细信息：**在 ViewData 中添加您的令牌，以便您可以在视图中访问它。

**解决方案：**

在你的控制器中

```
[AllowAnonymous]
public ActionResult TokenPasswordReset(string token)
{
   ViewData["Token"] = token;

   return View();
} 
```

在你看来

```
@Html.Hidden("Token", ViewData["Token"]) 
```

**更新完成问题**

在您的发布方法中

```
[HttpPost]
public ActionResult TokenPasswordReset(YourModel yourModel, string Token)
{
   yourModel.Token = Token;
   rest of your code....
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T23:48:41.690

是`Model`，不是`model`。

但是，即使这样，它仍然无法正常工作。请注意您的网址没有令牌查询字符串？它只是 ?gibberish 而不是 ?token=gibberish。

此外，如果您想将其作为模型项传递，则必须为其创建模型：

```
public class TokenModel {
    public string Token {get;set;}
} 
```

然后在你的控制器中：

```
return View(new TokenModel() { Token = token }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-18T20:11:26.897

感谢@Mystere Man 和@MVCKarl。我能够从他们的答案中提取部分内容并解决我的问题。MVCKarls 解决方案似乎可行，我只是不想使用 ViewData。我生成的网址是这样的。

```
http://localhost:53272/Account/TokenPasswordReset?Token=LW6lnVrdUXemBMYqluAbMA2 
```

在我看来，我将隐藏字段更改为此。

```
@Html.Hidden("UserToken", Request.Params["token"]) 
```

这允许我将它提交给我的控制器，只传递模型，我只需要验证模型。

再次感谢...

# sql - 有子句与子查询

> ID：12943960
> 
> 赞同：17
> 
> 时间：2012-10-17T21:49:15.710
> 
> 标签：sql, subquery, having

我可以通过两种方式使用聚合函数编写查询：

```
select team, count(min) as min_count
from table
group by team
having count(min) > 500 
```

或者

```
select * 
from (
    select team, count(min) as min_count
    from table
    group by team
) as A
where A.min_count > 500 
```

这两种方法是否有任何性能优势，或者它们在功能上是否相同？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-17T22:06:14.283

The two versions are functionally the same. Well, the second is syntactically incorrect, but I assume you mean:

```
select * 
from (
    select team, count(min) as count
    from table
    group by team
) t
where count > 500 
```

(You need the alias on the calculation and several leading databases require an alias on a subquery in a `FROM` clause.)

Being functionally equivalent *does not* mean that they are necessarily optimized the same way. There are often multiple ways to write a query that are functionally equivalent. However, the specific database engine/optimizer can choose (and often does choose) different optimization paths.

In this case, the query is so simple that it is hard to think of multiple optimization paths. For both versions, the engine basically has to aggregate teh query and then test the second column for the filter. I personally cannot see many variations on this theme. Any decent SQL engine should use indexes, if appropriate, in either both cases or neither.

So, the anwer to this specific question is that in any reasonable database, these should result in the same execution plan (i.e., in the use of indexes, the user of parallelism, and the choice of aggregation algorithm). However, being functionally equivalent does not mean that a given database engine is going to produce the same exeuction plan. So, the general answer is "no".

# windows - 调用 ssh2 命令的 Perl 脚本无法在 Windows 任务调度程序中获取输出

> ID：12943962
> 
> 赞同：3
> 
> 时间：2012-10-17T21:49:36.233
> 
> 标签：windows, perl, task, scheduler

我可以毫无问题地从命令行运行 Perl 脚本，但是当我尝试使用 Windows 任务管理器（64 位 Windows 2008 服务器）自动执行此任务时，无法将 SSH/SSH2 的输出写入输出文件。它是一个 perl 脚本，它执行以下操作：

```
my $DB_FILE1=$PATH . "\\FSBusinessUtil_" . $hostfqdn . $DATE;
open( OUTFILE,  ">$DB_FILE1" )      or die "Could not open data file ";
print OUTFILE "FilesystemInfo\n";   

my $output1=`$SSH_PATH\\ssh $user\@$hostname NAS_DB=/nas /nas/bin/./nas_fs -list`;

if($? != $RC_OK){
    open( OUT1FILE, ">$PATH\\errFSBusinessUtil_$hostfqdn$DATE");
    print OUT1FILE localtime(time) . " Remote ssh failed to create $DB_FILE1\. Error: $output1\n"; 
    close OUT1FILE;
}
else {
    $output1=~ s/%%%/\n/g;
    print OUTFILE $output1;
}  
close OUTFILE; 
```

Perl 脚本本身被 Windows 任务计划程序调用，但在输出文件中，我看到的只是脚本在调用 ssh 命令之前打印出来的“FilesystemInfo”行。除此之外，该命令确实失败了，因为我看到了生成的错误文件。但是，$output1 仍然是空的，所以只有“远程 ssh 无法创建...错误：”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T08:11:48.350

出现这种问题通常是因为手动运行程序和从调度程序运行程序时使用的环境不同。`ssh`对此特别敏感，因为它将用户和主机密钥存储在用户文件夹中的文件中。

您应该尝试的第一件事是以调试模式从脚本运行 ssh：

```
ssh -vvv ... 
```

另一种可能性是使用不使用来自环境的任何信息的[Net::SSH2](https://metacpan.org/module/Net%3a%3aSSH2)，因此不受此类问题的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:41:20.453

在预定的 VBscript 中运行 SCP 和 SSH 时，我遇到了类似的问题。检查“以最高权限运行”就可以了。

# iphone - 如何更改 iPhone 设置应用程序中的文本颜色

> ID：12943964
> 
> 赞同：0
> 
> 时间：2012-10-17T21:49:43.193
> 
> 标签：iphone, ios5.1

我正在尝试更改某些应用程序中的文本颜色，例如拨号器/联系人、设置等。是否有用于该或什么的 plist 文件。

# base64 - 使用 Free Pascal 和 DecodeStringBase64 验证 Base64 输入

> ID：12943971
> 
> 赞同：1
> 
> 时间：2012-10-17T21:50:16.877
> 
> 标签：base64, freepascal, lazarus

我知道已经有很多关于这方面的问题，形式各异。我的问题稍微直接一些。

使用 Free Pascal 和 s:=DecodeStringBase64(s); 函数，是否无论如何要验证作为 s 传递的解码字符串是否实际上是从正确的 Base64 输入数据中解码的，以避免解码垃圾？

我所做的最好的事情是使用 reg exp 来识别潜在的 Base64 数据（[来自此处接受的答案](https://stackoverflow.com/questions/475074/regex-to-parse-or-validate-base64-data)）。然后我使用 mod 检查它是否可以被 4 整除。如果它可以被 4 整除，我将它传递给 DecodeStringBase64。但是，尽管匹配 reg exp，我仍然收到很多误报和返回的数据，这些数据已经“解码”但显然不是 Base64。例如，“WindowsXP=" 匹配表达式但不是 Base64 编码数据。

同样，名称“Ted”编码为 VGVk，它甚至没有通常的“=”填充（有助于将其标记为页脚），但它仍然是我想查找和解码的潜在 Base64 片段。

在 PHP 中，有[base64_decode()](https://stackoverflow.com/questions/2556345/detect-base64-encoding-in-php)可以传递一个 true 参数来帮助验证。

[AFAIK，Free Pascal 在DecodeStringBase64](http://www.freepascal.org/docs-html/fcl/base64/decodestringbase64.html)中没有这个，我需要一些验证方法。

其他关于解码和编码主题的有用回复，如果读者碰巧像我昨天一样在寻找它，在[这里](https://stackoverflow.com/questions/10242580/how-to-encode-file-of-any-type-into-base64-string-and-then-decode-it-into-file-a)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T07:49:25.340

简短的回答是否定的，Base64 编码字符串没有 100% 的有效验证。

编码字符串中的`=`符号[`Base64`](http://www.ietf.org/rfc/rfc4648.txt)并不重要，它是 for [`padding`](http://en.wikipedia.org/wiki/Base64#Padding)，因此它并不总是需要存在（编码字符串的长度必须是 4 的倍数）。您只能检查字符串长度是否为 4 的倍数，检查 Base64 字母表中的有效字符（请参阅 参考资料）并验证输入字符串末尾[`Page 5, Table 1`](http://www.ietf.org/rfc/rfc4648.txt)是否有不超过两个填充符号字符。`=`这是一个可以验证传递的字符串是否可以是有效的 Base64 编码字符串的代码（无论如何，您无能为力）：

```
function CanBeValidBase64EncodedString(const AValue: string): Boolean;
const
  Base64Alphabet = ['A'..'Z', 'a'..'z', '0'..'9', '+', '/'];
var
  I: Integer;
  ValLen: Integer;
begin
  ValLen := Length(AValue);
  Result := (ValLen > 0) and (ValLen mod 4 = 0);
  if Result then
  begin
    while (AValue[ValLen] = '=') and (ValLen > Length(AValue) - 2) do
      Dec(ValLen);
    for I := ValLen downto 1 do
      if not (AValue[I] in Base64Alphabet) then
      begin
        Result := False;
        Break;
      end;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T08:02:29.070

在下一个版本 (2.6.2) 中，DecodeStringBase64 将有一个额外的布尔参数来调用严格模式。（在“流”版本中已经可用）。

如果存在验证错误，则会引发异常。

# jasper-reports - 删除报告中的空白页

> ID：12943976
> 
> 赞同：0
> 
> 时间：2012-10-17T21:50:44.877
> 
> 标签：jasper-reports, report, subreport

我目前是使用*iReport*创建报告的新手。

我的主报告只有一页长，有很多*子*报告。每次我单独运行没有数据的*子报表*时，它都会说没有页面，但是对于我的主报表，它会显示空白页。我希望它只显示有数据的页面，而那些没有数据的页面不应该有空白页。

我将*子报表*放在报表组中：

```
Group
Subreport
Subreport
Group 
```

并且重复大约5-6次。我已经设置了我的所有报告，包括我的主报告***When no data = No Pages***，并且我还检查了所有*子*报告元素的公共属性中空白时的删除行。我的主报告没有查询，所以我放置了一个简单的*`SELECT 1`*.

PS*我不能发布我的代码，因为我不允许在办公室导出和导入代码。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T05:15:58.940

您需要编辑子报表的查询并设置记录节点（Xpath 生成）......它将消除子报表在文档中没有页面的问题......

# actionscript-3 - 尝试使用输入文本更改变量

> ID：12943981
> 
> 赞同：-1
> 
> 时间：2012-10-17T21:50:51.303
> 
> 标签：actionscript-3, flash, variables

我正在尝试获取一个输入文本字段来更改我设置的变量，然后制作一堆我为变量设置的电影剪辑。

这是我要更改的代码

```
 var blue:MovieClip = new Blue  ; 
```

如果可能的话，我需要对输入字段中的内容进行蓝色更改

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:00:25.827

据我所知，您不能基于字符串（即文本字段的值）创建新的类名。

您必须首先创建您的类：

```
var blue:MovieClip = new Blue();
var green:MovieClip = new Green();
... 
```

然后用开关说：

```
switch(player1.text){
case 'blue' : 
  //load blue mc
  break;
case 'green' :
  // load green ms
  break;
} 
```

这里最大的问题是文本输入可以采用任何值。您最好使用一系列具有预定义值的单选按钮。然后是那些有你的开关的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T23:25:22.577

您可以使用基于字符串创建类的实例[`getDefinitionByName()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getDefinitionByName%28%29)。

示例代码：

```
function loadClip(string:String):MovieClip
{
    var type:Class = getDefinitionByName(string) as Class;
    var mc:MovieClip = new type();

    return mc;
} 
```

然后，您可以使用 的值`player1.text`来创建已设置的不同类型的 MovieClip：

```
try
{
    var colorMc:MovieClip = loadClip(player.text);
}
catch(e:ReferenceError)
{
    trace(e);
} 
```

# javascript - 带有 Cropper 的 Valum 文件上传器在 IE 上不起作用

> ID：12943983
> 
> 赞同：1
> 
> 时间：2012-10-17T21:50:54.830
> 
> 标签：javascript, jquery, html, valums-file-uploader

我找到了这个演示，但它在 Internet Explorer 中不起作用。我在我的应用程序中得到了一切工作，并意识到它在 IE 上不起作用！！！裁剪控制台不会出现在 Internet Explorer 中。有谁知道为什么？

可以在[http://valums.com/ajax-upload/](http://valums.com/ajax-upload/)找到 Andrew Valums 的 Ajax Upload 。使用 IMGSelectArea 演示在这里

[http://html5.sapnagroup.com/demos/dragDropUploadsCrop/](http://html5.sapnagroup.com/demos/dragDropUploadsCrop/)

# javascript - node.js/socket.io 中的对象/方法/变量访问

> ID：12943987
> 
> 赞同：0
> 
> 时间：2012-10-17T21:51:09.287
> 
> 标签：javascript, node.js, variables, socket.io

我相信这是一些范围/变量访问问题，但我不确定，所以我将告诉你整个上下文。

这个想法是有一个 node.js-“应用程序”，它允许您在 HTML 前端输入一个数字，该数字通过 socket.io 发送到服务器，然后使用 mongoose 保存到 mongodb。然后，作为回报，从数据库中获取数字并在客户端脚本中对其进行处理。

一个真实的例子是，你可以在客户端输入你的汽车/任何东西的里程数，然后触发一个 socket.io 事件，将该信息传输到 node.js 服务器并使用 mongoose 将其保存到 monogodb。这样可行。现在说我也希望能够保留和保存一些偏好。
我有一个`Preferences`保留变量 numDigits 和一些方法/函数的对象。
保存`numDigits`到服务器工作，从服务器查询条目工作。
但是，将数字保存到`Preferences.numDigits`不会。

**客户端.js**

```
//init.js
//var Preferences;

var Preferences = {
    numDigits: 'default',
    parse: function(){
        this.numDigits = parseInt($('#preferences > #num-digits').val());
    },
    get: function(){
        socket.emit('req-preferences', function(responseData) {
            this.numDigits = responseData.numDigits;
            console.log('#1: ' + this.numDigits);
        });
        console.log('#1: ' + this.numDigits);
        // 2 different outputs (scopes?) here

    },
    save: function(){
        socket.emit('save-preferences', this);
    }
}

var UI = {
    numDigits: Preferences.numDigits,
    build: function() {
        Preferences.get();
        console.log(Preferences.numDigits);
        for (i=0; i<Preferences.numDigits;i++) {
            $('#input-km').append('<input type="text"></input>');
        }   
    }
}

$(document).ready(function() {

    socket = io.connect('http://127.0.0.1:8080');

    function print(data) {
        console.log(data);
        if (data.length == 0) {
            $('#results').html('no entries!');
        } else {
            for (i = 0; i < data.length; i++) {
                $('#results').append(data[i].date + ' - ' + data[i].km + '<br />');
            }   
        }
    }

    socket.on('res-entries', function(entries){
        print(entries);
    });

    $('#submit').click(function() {
        var kmStand = $('#km').val();
        socket.emit('submit', kmStand, function(){
        });
    });

    $('#req-entries').click(function(){
        socket.emit('req-entries', function() {
        });
    });

    $('#remove-all').click(function() {
        socket.emit('remove-all', function() {
            console.log('remove all');
        });
    });

    $('#save-preferences').click(function() {
        Preferences.parse();
        Preferences.save();
    });

    //Preferences.get();
    UI.build();
}); 
```

**服务器.js**

```
var http = require('http');
var connect = require('connect');
var io = require('socket.io');
var mongoose = require('mongoose');

var server = http.createServer(connect()
    .use(connect.static(__dirname))).listen(8080);

var socket = io.listen(server);
socket.set('log level', 2);

var db = mongoose.createConnection('localhost', 'mileagedb');
db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function() {

    var entrySchema = new mongoose.Schema({
        km: String,
        date: {
            type:Date, 
            default:Date.now
        }
    });

    var preferencesSchema = new mongoose.Schema({
        numDigits: Number,
        objId: Number
    });

    var Preferences = db.model('Preferences', preferencesSchema);

    var Entry = db.model('Entry', entrySchema);

    socket.sockets.on('connection', function(socket){ 

        socket.on('submit', function(kmStand){
            var eintrag = new Entry({
                km: kmStand,
            });

            eintrag.save(function(err) {
                if (err) {
                    console.log('error while saving');
                } else {
                    console.log('saved');
                }
            });

            Entry.find(function(err, entries) {
                console.log('all entries:');
                console.log(entries);
            });
        });

        socket.on('req-entries', function() {
            Entry.find(function(err, entries) {
                socket.emit('res-entries', entries);
            });
        });

        socket.on('remove-all', function() {
            Entry.find().remove();
            Preferences.find().remove();
        });

        socket.on('save-preferences', function(prefObj) {

            Preferences.update(Preferences.findOne(), {$set: { numDigits: prefObj.numDigits }}, { upsert: true }, function(err){
                if (err) {
                    console.log('error saving');
                }
            });

            Preferences.find(function(err, prefs) {
                console.log('all preferences:');
                console.log(prefs);
            });
        });

        socket.on('req-preferences', function(fn) {
            Preferences.findOne(function(err, prefs) {
                fn(prefs);
            })
        });

    });
});

/* maybe:
socket.on('get-entries'), function(requestSpecification) {
            ...
        }*/ 
```

客户端的控制台输出为：

```
(on body load, UI.build() fires)
#2: default (line 14)
#1: 5 (line 12)

>Preferences.get();
#2: default (line 14)
<-undefined
#1: 5 (line 12)

>Preferences.numDigits
"default" 
```

UI.build() 中的 for 循环也不会触发，所以我也将它的值设为“默认”。如前所述，我很确定这是某个地方的变量/范围问题，`Preferences.get();`但我自己无法理解这个问题。如果你们中的某个人能帮我解决这个问题，那就太好了。

提前非常感谢！

*编辑：粘贴错误的代码*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T14:39:16.980

我认为您的代码仍然不是生成该输出的代码（即代码中的第 12 行和第 14 行都包含#1。无论如何，这可能不是问题。

好的，首先，我认为“emit”的第二个参数应该是要发送的数据，只有第三个应该是回调函数。但也许这确实有效。

然后是范围问题。始终注意闭包中的“this”指向的内容（=回调函数）。最好的解决方案是：

```
get: function(){
    var that = this;
    socket.emit('req-preferences', function(responseData) {
        that.numDigits = responseData.numDigits;
        console.log('#1: ' + that.numDigits);
    });
    console.log('#1: ' + that.numDigits);
    // 2 different outputs (scopes?) here

}, 
```

我自己，我总是让任何成员函数的第一行是“var that = this”，然后在整个函数中只引用“that”。如果您真的想了解原因，请查看[说明](http://yehudakatz.com/2011/08/11/understanding-javascript-function-invocation-and-this/)。此外，在整个代码中使用“use strict”可以帮助防止此类问题。

我还没有尝试过，但我认为这应该会有所帮助。

# javascript - 触发图像的 onLoad 和 onError 时出现 HTTP 204（无内容）？

> ID：12943990
> 
> 赞同：4
> 
> 时间：2012-10-17T21:51:12.163
> 
> 标签：javascript, http, cross-browser

在为 img src 请求获取 HTTP“204 无内容”时，每个浏览器的行为是否一致？

```
<img src="/gives_me_a_204.gif" onError="alert('err')" onLoad="alert('ok')" /> 
```

在 Firefox 和 Opera 上我得到一个“错误”，想知道所有其他浏览器是否也会给我这个。

# scala - 从对象中的主要方法调用案例类

> ID：12943995
> 
> 赞同：4
> 
> 时间：2012-10-17T21:51:29.950
> 
> 标签：scala

在下面的课程中：

```
package patternmatching

abstract class Expr {

  case class Var(name: String) extends Expr
  case class Number(num: Double) extends Expr
  case class UnOp(operator: String, arg:Expr) extends Expr
  case class BinOp(operator: String, left: Expr, right: Expr) extends Expr

} 
```

我将主类定义为：

```
package patternmatching
import patternmatching.Expr.Var

object PatternMain {

      def main(args:Array[String]) {

         val v = Var("x")
    }

} 
```

但是我在 PatternMain 中收到一个编译时错误`import patternmatching.Expr.Var`：

> *   object Expr 不是包模式匹配的成员 注意：类 Expr 存在，但它没有伴生对象。

如何正确调用`val v = Var("x")`案例类 Var ？我没有正确导入它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T22:14:42.673

删除`abstract`关键字并将其`class Expr`变为`object Expr`. 就您的代码而言，我认为没有理由不进行这些更改。

但是，如果您确实想保留`Expr`一个抽象类，则必须扩展和实例化它：

```
def main(args:Array[String]) {
    val expr = new Expr {} // extending the class - this creates a anonymous class
    val v = expr.Var("x")

    // alternatively, since now we do have a object to import
    import expr._
    val v2 = Var("x")

    // even another approach, now using a named class
    class MyExpr extends Expr
    val myexpr = new MyExpr
    val v3 = myexpr.Var("x")
} 
```

说明：

*   只有对象和包可以导入其成员
*   抽象类必须被扩展才能被实例化。这里的想法是，类中的某些“点”将需要由客户端定义，同时仍与抽象类的其他扩展共享接口的其余部分。

# http - 代理网络服务器远程地址标头

> ID：12943999
> 
> 赞同：1
> 
> 时间：2012-10-17T21:51:49.697
> 
> 标签：http, proxy, http-headers, naming-conventions

我正在设置一些代理功能，并希望使事情与常见的事情保持一致。

远程地址的典型标头名称是什么，是`REMOTE_ADDR`吗？

如果浏览器发送一个`REMOTE_ADDR`标头会发生什么，它会被忽略还是重命名？