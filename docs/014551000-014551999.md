# StackOverflow 问答 14551000-14551999

# google-app-engine - Google App Engine 数据存储区管理控制台 - 离线模式

> ID：14551000
> 
> 赞同：2
> 
> 时间：2013-01-27T19:01:49.450
> 
> 标签：google-app-engine, console, admin, google-cloud-datastore

离线模式下是否有良好的 GAE 数据存储管理控制台可用？我目前正在使用 GAE、Flask 和 Google NDB 设计一个 REST api。在 GAE 中，有一个非常好的管理控制台可以让您查看/编辑数据模型。当您在本地主机模式下工作时是否有类似的东西？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T03:53:00.557

**更新：**此答案已过时，请参阅 Asmo 的答案。

* * *

有一个管理页面`http://localhost:8080/_ah/admin`，尽管它不具备生产管理控制台的所有功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-12T07:23:22.150

在最新的 GAE 版本中，数据存储管理员是*开发控制台*的一部分，位于`http://localhost:8000/`

更多信息：

[https://developers.google.com/appengine/docs/python/tools/devserver#Python_The_Development_Console](https://developers.google.com/appengine/docs/python/tools/devserver#Python_The_Development_Console)

# node.js - Node.js 中的缓冲区是什么？

> ID：14551006
> 
> 赞同：42
> 
> 时间：2013-01-27T19:02:22.267
> 
> 标签：node.js, buffer

正如您可以在[Buffer 类的 Node.js 文档](http://nodejs.org/api/buffer.html)中阅读的那样，缓冲区

> 类似于整数数组，但对应于 V8 堆外的原始内存分配。

到现在为止还挺好。

现在让我困惑的是从技术上讲缓冲区是什么的问题。它是一个只有一些附加函数的数组，用于使用特定编码创建和转换为字符串？

还是有“更多”？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-27T19:04:33.070

缓冲区是一块内存，就像在 C/C++ 中一样。您可以将此内存解释为各种长度的整数或浮点数数组，或二进制字符串。与数组等高级数据结构不同，缓冲区不可调整大小。

它大致对应于：

*   `char*`或`char[]`在 C/C++ 中
*   `byte[]`在爪哇
*   Python中的可变`bytes`或不可调整大小`bytearray`
*   php中的字符串，如果它们是可变的

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-09-10T20:23:31.700

`BUFFER`是数据从一个地方移动到另一个地方的临时存放点。

为了理解 Buffer 是什么，我们需要知道计算机将如何处理事物。请参见下面的图表。[![](../Images/17213850ee61bc9312313e411b7a5bf7.png)](https://i.stack.imgur.com/TvL6A.png)

这个概念就像如果您正在观看 Youtube 视频，您可以开始观看视频而无需下载整个视频。如果您的网速太慢，您会看到“缓冲”，这意味着计算机正在尝试收集数据以便您继续观看该视频。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-27T19:05:23.007

来自[http://nodejitsu.com/](http://nodejitsu.com/)的解释...

> 缓冲区是节点中 Buffer 类的实例，旨在处理原始二进制数据。每个缓冲区对应于在 V8 之外分配的一些原始内存。缓冲区的行为有点像整数数组，但不可调整大小并且有一大堆专门用于二进制数据的方法。此外，缓冲区中的“整数”每个都代表一个字节，因此仅限于 0 到 255 (2^8 - 1) 之间的值，包括 0 到 255 (2^8 - 1)。

阅读更多：[Node.js 中的缓冲区](https://github.com/nodejitsu/docs/blob/master/pages/articles/advanced/buffers/how-to-use-buffers/content.md)

# php - MySQL 中的 VarChar ZeroFill

> ID：14551008
> 
> 赞同：1
> 
> 时间：2013-01-27T19:02:37.090
> 
> 标签：php, mysql

我正在尝试在`MYSQL`表格中添加一行，我希望它包含字母和数字，限制为 4 个字符（字母或数字）。同时..如果有人想提交有 3 个字符或 2 个字符的东西。我希望其余的数据用零填充

例如：

```
23e becomes 023e
2 become 0002
1234 stays the same
123e stays the same 
```

我试图在不使用 PHP 的情况下仅在 MYSQL 数据库中实现结果。可能吗？如果不可能，在 PHP 中执行此操作的代码是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:06:17.700

使用`char`而不是`varchar`（这有一定数量的字符）。在 mysql 中：

```
INSERT INTO t1 (col1)
   VALUES (LPAD(?, 4, '0')) 
```

在 PHP 中也很容易做到：

```
$value = str_pad($value, 4, '0', STR_PAD_LEFT); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-27T19:09:44.487

试试这个 PHP 脚本：

```
<?
$YourNumber="23";
for($i=0;$i<4;$i++)
{
    if(strlen($YourNumber)<4)
    {
        $YourNumber="0".$YourNumber;
    }
}
echo($YourNumber);
?> 
```

# python - MySQLdb.cursors.Cursor.execute 在不同游标的情况下返回不同的值为什么？

> ID：14551009
> 
> 赞同：2
> 
> 时间：2013-01-27T19:02:37.943
> 
> 标签：python, cursor, mysql-python

看到这两个python代码片段，

```
conn = MySQLdb.connect(c['host'], c['user'], c['password'], c['db'])
cur = conn.cursor()
cur.execute("select * from geo_weathers;)   ->  **1147L** 
```

和

```
conn = MySQLdb.connect(c['host'], c['user'], c['password'], c['db'], cursorclass=MySQLdb.cursors.SSCursor)
cur = conn.cursor()
cur.execute("select * from geo_weathers")   ->  **18446744073709551615L** 
```

为什么以上两种情况返回的行数不同？仅供参考，一个表中有 1147 行。

SSCursor 用于在服务器端保存结果。是这个原因吗？此选择查询会影响哪些所有行？

有人知道吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:48:07.317

MySQLdb 使用的标准游标是存储结果游标。这意味着整个结果集从服务器传输并作为`execute()`调用的结果缓存在客户端的内存中。

A`SSCursor`是服务器端游标，只会在请求时将结果返回给客户端。

游标`execute()`调用将返回 MySql C API 函数[mysql_affected_rows()](http://dev.mysql.com/doc/refman/5.0/en/mysql-affected-rows.html)的结果，该函数又返回[mysql_num_rows()](http://dev.mysql.com/doc/refman/5.0/en/mysql-num-rows.html)的`SELECT`查询结果。

因为结果存储在服务器端，所以客户端在迭代结果之前不知道有多少行受到影响。

的文档是`mysql_num_rows()`这样说的：

> mysql_num_rows() 的使用取决于你是使用mysql_store_result() 还是my​​sql_use_result() 返回结果集。如果你使用 mysql_store_result()，mysql_num_rows() 可能会被立即调用。如果您使用 mysql_use_result()，则 mysql_num_rows() 在检索到结果集中的所有行之前不会返回正确的值。

如果要获取行数的计数，请使用`SELECT COUNT(*) from geo_weathers`而不是依赖`execute()`调用的结果。

# c++ - OpenCV 算法的 GPU 版本比我机器上的 CPU 版本慢？

> ID：14551017
> 
> 赞同：2
> 
> 时间：2013-01-27T19:03:32.007
> 
> 标签：c++, opencv, cuda, gpu

在尝试使用带有 OpenCV 的 GPU 加速简单算法时，我注意到在我的机器（Ubuntu 12.10、NVidia 9800GT、Cuda 4.2.9、g++ 4.7.2）上，GPU 版本实际上比 CPU 版本慢。我用下面的代码进行了测试。

```
#include <opencv2/opencv.hpp>
#include <opencv2/gpu/gpu.hpp>

#include <chrono>
#include <iostream>

int main()
{
    using namespace cv;
    using namespace std;

    Mat img1(512, 512, CV_32FC3, Scalar(0.1f, 0.2f, 0.3f));
    Mat img2(128, 128, CV_32FC3, Scalar(0.2f, 0.3f, 0.4f));
    Mat img3(128, 128, CV_32FC3, Scalar(0.3f, 0.4f, 0.5f));

    auto startCPU = chrono::high_resolution_clock::now();
    double resultCPU(0.0);
    cout << "CPU ... " << flush;
    for (int y(0); y < img2.rows; ++y)
    {
        for (int x(0); x < img2.cols; ++x)
        {
            Mat roi(img1(Rect(x, y, img2.cols, img2.rows)));
            Mat diff;
            absdiff(roi, img2, diff);
            Mat diffMult(diff.mul(img3));
            Scalar diffSum(sum(diff));
            double diffVal(diffSum[0] + diffSum[1] + diffSum[2]);
            resultCPU += diffVal;
        }
    }
    auto endCPU = chrono::high_resolution_clock::now();
    auto elapsedCPU = endCPU - startCPU;
    cout << "done. " << resultCPU << " - ticks: " << elapsedCPU.count() << endl;

    gpu::GpuMat img1GPU(img1);
    gpu::GpuMat img2GPU(img2);
    gpu::GpuMat img3GPU(img3);
    gpu::GpuMat diffGPU;
    gpu::GpuMat diffMultGPU;
    gpu::GpuMat sumBuf;

    double resultGPU(0.0);
    auto startGPU = chrono::high_resolution_clock::now();
    cout << "GPU ... " << flush;
    for (int y(0); y < img2GPU.rows; ++y)
    {
        for (int x(0); x < img2GPU.cols; ++x)
        {
            gpu::GpuMat roiGPU(img1GPU, Rect(x, y, img2GPU.cols, img2GPU.rows));
            gpu::absdiff(roiGPU, img2GPU, diffGPU);
            gpu::multiply(diffGPU, img3GPU, diffMultGPU);
            Scalar diffSum(gpu::sum(diffMultGPU, sumBuf));
            double diffVal(diffSum[0] + diffSum[1] + diffSum[2]);
            resultGPU += diffVal;
        }
    }
    auto endGPU = chrono::high_resolution_clock::now();
    auto elapsedGPU = endGPU - startGPU;
    cout << "done. " << resultGPU << " - ticks: " << elapsedGPU.count() << endl;
} 
```

我的结果如下：

```
CPU ... done. 8.05306e+07 - ticks: 4028470
GPU ... done. 3.22122e+07 - ticks: 5459935 
```

如果这有帮助：我的分析器（System Profiler 1.1.8）告诉我大部分时间都花在`cudaDeviceSynchronize`.

我在使用 OpenCV GPU 函数的方式上做错了什么，还是我的 GPU 很慢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T20:21:10.473

感谢 hubs 和 Eric 的评论，我能够以 GPU 版本实际上比 CPU 版本更快的方式更改我的测试。现在也消除了导致两个版本的不同校验和的错误。;-)

```
#include <opencv2/opencv.hpp>
#include <opencv2/gpu/gpu.hpp>

#include <chrono>
#include <iostream>

int main()
{
    using namespace cv;
    using namespace std;

    Mat img1(512, 512, CV_32FC3, Scalar(1.0f, 2.0f, 3.0f));
    Mat img2(128, 128, CV_32FC3, Scalar(4.0f, 5.0f, 6.0f));
    Mat img3(128, 128, CV_32FC3, Scalar(7.0f, 8.0f, 9.0f));
    Mat resultCPU(img2.rows, img2.cols, CV_32FC3, Scalar(0.0f, 0.0f, 0.0f));

    auto startCPU = chrono::high_resolution_clock::now();
    cout << "CPU ... " << flush;
    for (int y(0); y < img1.rows - img2.rows; ++y)
    {
        for (int x(0); x < img1.cols - img2.cols; ++x)
        {
            Mat roi(img1(Rect(x, y, img2.cols, img2.rows)));
            Mat diff;
            absdiff(roi, img2, diff);
            Mat diffMult(diff.mul(img3));
            resultCPU += diffMult;
        }
    }
    auto endCPU = chrono::high_resolution_clock::now();
    auto elapsedCPU = endCPU - startCPU;
    Scalar meanCPU(mean(resultCPU));
    cout << "done. " << meanCPU << " - ticks: " << elapsedCPU.count() << endl;

    gpu::GpuMat img1GPU(img1);
    gpu::GpuMat img2GPU(img2);
    gpu::GpuMat img3GPU(img3);
    gpu::GpuMat diffGPU(img2.rows, img2.cols, CV_32FC3);
    gpu::GpuMat diffMultGPU(img2.rows, img2.cols, CV_32FC3);
    gpu::GpuMat resultGPU(img2.rows, img2.cols, CV_32FC3, Scalar(0.0f, 0.0f, 0.0f));

    auto startGPU = chrono::high_resolution_clock::now();
    cout << "GPU ... " << flush;
    for (int y(0); y < img1GPU.rows - img2GPU.rows; ++y)
    {
        for (int x(0); x < img1GPU.cols - img2GPU.cols; ++x)
        {
            gpu::GpuMat roiGPU(img1GPU, Rect(x, y, img2GPU.cols, img2GPU.rows));
            gpu::absdiff(roiGPU, img2GPU, diffGPU);
            gpu::multiply(diffGPU, img3GPU, diffMultGPU);
            gpu::add(resultGPU, diffMultGPU, resultGPU);
        }
    }
    auto endGPU = chrono::high_resolution_clock::now();
    auto elapsedGPU = endGPU - startGPU;
    Mat downloadedResultGPU(resultGPU);
    Scalar meanGPU(mean(downloadedResultGPU));
    cout << "done. " << meanGPU << " - ticks: " << elapsedGPU.count() << endl;
} 
```

输出：

```
CPU ... done. [3.09658e+06, 3.53894e+06, 3.98131e+06, 0] - ticks: 34021332
GPU ... done. [3.09658e+06, 3.53894e+06, 3.98131e+06, 0] - ticks: 20609880 
```

这不是我预期的加速，但可能我的 GPU 并不是最适合这些东西的。多谢你们。

# logging - 使用 java.util.logging 在 CXF 服务器中配置日志记录

> ID：14551024
> 
> 赞同：0
> 
> 时间：2013-01-27T19:03:52.237
> 
> 标签：logging, cxf, java.util.logging

我有一个使用 CXF 作为框架的服务器应用程序。我通过 Spring 设置 CXF，仅通过 XML 文件，没有任何 Java 代码。

我想将我的服务器应用程序的一些内部信息记录到应用程序服务器的日志文件中。目前我只是通过调用来做到这一点`System.out.println()`，但我想使用类似的日志框架/库`java.util.logging`（因为 CXF 已经使用`java.util.logging`）。

推荐的方法是什么？如何配置我的`java.util.logging` `Logger`？是否可以使用与 CXF 相同的 logging.properties？

我目前`Logger`通过调用接收我的实例`Logger.getLogger(Server.class.getName())`。这是一个好方法吗？

我试图在互联网上搜索这个，但我只能找到启用CXF框架本身的日志记录的方法，但我想在我自己的代码中使用日志记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:25:18.817

我在 CXF 示例中找到了一个示例。

像往常一样定义记录器：

```
private static final Logger LOG = Logger.getLogger(My_Class.class.getPackage().getName()); 
```

该`logging.properties`文件转到`WEB-INF/classes/logging.properties`，例如：

```
handlers = java.util.logging.ConsoleHandler

.handlers = java.util.logging.ConsoleHandler
.level = INFO

java.util.logging.ConsoleHandler.level = FINEST
java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter
java.util.logging.SimpleFormatter.format="%4$s: %5$s [%1$tc]%n"

com.example.My_Class.level = FINE 
```

# jquery - Using jQuery how can I get the value of checkboxes?

> ID：14551025
> 
> 赞同：4
> 
> 时间：2013-01-27T19:03:59.930
> 
> 标签：jquery, checkbox

> **Possible Duplicate:**
> [How to retrieve checkboxes values in jQuery](https://stackoverflow.com/questions/786142/how-to-retrieve-checkboxes-values-in-jquery)

I have the following form:

```
<form action="index.php">
    <div class="answer"><input type="radio" name="vote_answers" value="3615736&1047558" class="vote_answers"> 1</div>

    <div class="answer"><input type="radio" name="vote_answers" value="3615736&1121626" class="vote_answers"> 2</div>

    <div class="answer"><input type="radio" name="vote_answers" value="3615736&9910782" class="vote_answers"> 3</div>

    <input type="submit" name="submit" id="button_submit_vote" value="submit">
</form> 
```

When i click on **submit** I need to get the value of checked checkboxes

This is my code:

```
$('#button_submit_vote').on('click',function() {
    if($('.vote_answers').is(':checked')){var id=$(this).val();}
    alert(id);
}); 
```

Instead of the checkbox value I get value "submit".

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:07:17.017

That's because `this` refers to `button_submit_vote` element, you can `:checked` selector:

```
var id = $('.vote_answers:checked').val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:08:04.490

You haven't been that far:
`$('.vote_answers:checked').val()`

# c++ - 如何在 Windows 上为 ARM 编译 C++ 库

> ID：14551027
> 
> 赞同：2
> 
> 时间：2013-01-27T19:04:27.320
> 
> 标签：c++, arm, windows-phone-8

我有一个 C++ 库，目前 CMAKE 中有一个错误/或缺少使用 Visual Studio Arm Generator 的功能。

我还有什么其他选项可以为 ARM 编译库，这样我就可以在我的 c++ 运行时组件中使用它，用于 Windows 8 手机项目。

我想构建库，然后从运行时组件链接它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:58:09.970

很可能，手机和 PC 有不同的处理器，需要不同的组装指令。

您需要告诉 Visual Studio 您的库的目标平台是 ARM 处理器。您将需要两个库文件，一个用于 PC，一个用于 ARM。

在工作中，我们使用两种不同的编译器，用于 PC 的 Visual Studio 和用于 ARM 平台的 IAR EW。我们目前在它们之间共享一些源代码文件，但不共享对象或可执行库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T14:28:53.650

您能否更具体地说明您遇到的错误...？

我的猜测是您的 CMAKE_TOOLCHAIN 文件容易出错..

尝试使用cmake本地编译同一个库......如果它运行良好，那么你必须编写你的CMAKE_TOOLCHAIN文件覆盖工具链文件中的编译器和/或库搜索路径......

PS cmake 确实提供了visual studio arm 生成器....

[http://www.cmake.org/cmake/help/v2.8.9/cmake.html#gen:VisualStudio11ARM](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#gen:VisualStudio11ARM)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T17:38:38.033

Microsoft 和 Kitware 已启用对 Windows Phone 和 Windows Store 应用程序的 CMake 支持。你能用这个版本的 CMake 试试你的项目吗？ [http://cmakems.codeplex.com/](http://cmakems.codeplex.com/) 很快，该贡献也将在官方 CMake 存储库中可用

# html - 用于下载画布内容的跨浏览器解决方案？

> ID：14551029
> 
> 赞同：1
> 
> 时间：2013-01-27T19:04:32.957
> 
> 标签：html, cross-browser, download

我正在寻找一种解决方案来下载画布元素的内容。背景：我们有一个客户端二维码生成器，到目前为止，只能打印此代码。我们的客户希望能够保存此代码，例如将它们附加到他们的销售单上。到目前为止，我只有一个使用锚标签的谷歌浏览器的工作解决方案：

HTML 代码：

```
<a href="data:image/octet-stream;base64,{base64-string}" class="btn" data-mimetype="image/jpeg" download="Kunden-Zufriedenheitsumfrage.jpeg">JPEG</a> 
```

问题是 Firefox 忽略了“下载”属性并设置了错误的文件名（base64 字符串的前 x 个字母 + 扩展名 .part），而 Internet Explorer 甚至不知道该做什么（没有任何反应）。

当然，可以为我们的客户提供图像标签，这样他们就可以右键单击它并将图像保存在上下文菜单中，但这不是很直观。

这是二维码窗口的屏幕截图： ![在此处输入图像描述](../Images/4ad4bedbce3e2d5f87908974b1599196.png)

# c++ - 用于幼稚 C++ 解决方案的无序映射

> ID：14551031
> 
> 赞同：5
> 
> 时间：2013-01-27T19:04:36.247
> 
> 标签：c++, unordered-map, knuth

我有一个 C++ 任务，我必须用我选择的容器设计一个简单的 Knuth 问题解决方案，并研究生成的性能数据。请参阅下面的问题：

> 从纽约到加利福尼亚，三百万名不同的人被端对端放置。每个参与者都得到一张纸条，他在纸条上写下自己的名字和排在他西边的人的名字。队伍最西端的那个人不知道该怎么办，所以他把纸扔了；剩下的 2,999,999 张纸条被放在一个巨大的篮子里，并被带到华盛顿特区的国家档案馆。篮子里的东西被完全打乱并转移到磁带上。
> 
> 此时，一位信息科学家观察到磁带上有足够的信息可以按照原始顺序重建人员列表。一位计算机科学家发现了一种方法，可以通过少于 1000 次的数据磁带进行重建，只使用磁带的顺序访问和少量的随机存取存储器。这怎么可能？
> 
> [换句话说，给定 1 ≤ i < N 的对 (xi, xi+1)，以随机顺序，其中 xi 不同，如何获得序列 x1 x2….xN，将所有操作限制为串行技术，适用于磁带上。当没有简单的方法来判断两个给定键中的哪一个在另一个之前时，这就是排序问题。

根据我的研究，我决定使用 unordered_map，而不是列表或法线贴图。我不明白的是已经提供给我们以实现为代码的幼稚解决方案：

> 将论文视为 (Name, Name) 元组的集合，后继者（西边邻居）和前身（东边邻居）都可以从这些元组中建立。

```
 - identify an individual xc

 - append xc to empty list

 - while xc has westerly neighbour

 - xc < westerly neighbour of xc

 - append xc to list

 - xc < head of list

 - while xc has easterly neighbour

 - xc < easterly neighbour of xc

 - prepend xc to list 
```

我的第一个问题 - xc 只是一个随机元素，因为容器的性质无法确定顺序吗？

我的第二个问题 - 我们得到的名字在一个文件中，如下所示：

```
Hazbgaei,Ckwkkkxa
Hrunmkoc,Usjgmunt
Cmkcwncb,Ycrnwzjl
Oygvmrhf,Hylmukiw
Jursaual,Gzrddsbg 
```

那么天真的解决方案是说我应该取名字并将其放入一个列表中，然后将姓氏放入另一个列表中吗？

抱歉，如果我完全离开，但我真的试图理解这一点！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:54:41.777

我相信解决方案是说使用一个列表。选择第一个元组，并将其名字作为列表的头部，将西风邻居作为下一项。然后，找到以西风邻居为名字的元组（当然，这是最难的部分），并从该元组中获取西风邻居并将其附加到列表中。重复，直到找不到包含最后添加的人的名字的元组。然后你知道你已经到达了西海岸。

所以，第一个 xc 本质上是随机的。之后，xc 是确定性的。说的那一行

```
- while xc has westerly neighbour 
```

本质上是说“找到以当前西风邻居为自身名称的元组”。

当然，后一部分只是反过来应用相同的逻辑，以填补向东的链条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:57:30.430

# 第一次尝试

我这样做是为了回答，因为不可能将此作为评论。还要澄清这一点，恕我直言，至少有一半的答案

这是否意味着以下方式？

```
identify an individual xc
append xc to empty list
while( xc has westerly neighbour )
{
    if( xc < westerly neighbour of xc )
    {
        append xc to list
    }
    // Do not understand this:
    // - xc < head of list
}
while( while xc has easterly neighbour )
{
    if( xc < easterly neighbour of xc )
    {
        prepend xc to list
    }
} 
```

（这只是尝试接近解决方案 - 我什至还没有考虑算法......）

# 第二次尝试

```
identify an individual xc
append xc to empty list

while( xc has westerly neighbour )
{
    xc := westerly neighbour of xc
    append xc to list
    xc := head of list

    while( xc has easterly neighbour )
    {
        xc := easterly neighbour of xc
        prepend xc to list
    }
} 
```

看起来这是有道理的：因此，您遍历列表，尽可能收集所有西风邻居，然后对所有东风进行此操作。因此，对于通过原始列表的每次运行，排序列表变得越来越长。

# 第三次尝试

恕我直言，缺少一些东西：如果我解释所有可用的信息，我会得出以下解决方案。但这需要对原始磁带进行更多扫描：而不是给定的 10.000 次，而是扫描大约 750.000 次。有任何想法吗？

```
#include <vector>
#include <algorithm>
#include <iostream>
#include <list>

size_t constexpr max_men { 3000000 };

typedef std::tuple< int, int > neighbors_t;
typedef std::vector< neighbors_t > pool_t;

int main() {

  // Need a vector here for random_shuffle - but using it further down
  // just with sequencial methods.
  pool_t pool_list;
  for( size_t i { 0 }; i < max_men - 1; ++i ) {
    pool_list.push_back( std::make_tuple( i, i + 1) );
  }
  std::random_shuffle( pool_list.begin(), pool_list.end() );

  // Use the algorithm to get it sorted again

  // identify an individual xc:
  // Pick first from first tuple
  // append xc to empty list
  std::list<int> sorted_list;
  sorted_list.push_back( std::get<0>( pool_list.front() ) );

  // Count the number of tape scans
  size_t tape_scans { 0 };

  do {
    // Scan through the pool_list
    for( neighbors_t n : pool_list ) {

#if 0
      std::cout << "n [" << std::get<0>( n ) 
        << "] sorted_list [";
      for( int i : sorted_list ) {
        std::cout << i << " ";
      }
      std::cout << "]" << std::endl;
#endif

      // while( xc has westerly neighbour )
      // Found westerly neighbour
      if( std::get< 1 >( n ) == sorted_list.front() ) {
        // append xc to list
        sorted_list.push_front( std::get< 0 >( n ) );
      }
      if( std::get< 0 >( n ) == sorted_list.back() ) {
        // append xc to list
        sorted_list.push_back( std::get< 1 >( n ) );
      }
    } 
    ++tape_scans;
    std::cout << "Tape Scans needed [" << tape_scans 
          << "] sorted list size [" << sorted_list.size() << "]"
          << std::endl;
  } while( sorted_list.size() < max_men );

  std::cout << "Tape Scans needed [" << tape_scans << "]" << std::endl;

  return 0;
} 
```

# java - JAVA：Swing JButton 组件（NullPointerException）

> ID：14551033
> 
> 赞同：1
> 
> 时间：2013-01-27T19:04:45.973
> 
> 标签：java, swing, nullpointerexception, jbutton, jlabel

我正在尝试显示文本 - 当您按下其中一个按钮时“您按下了按钮”。
我得到一个`NullPointerException`. 我已经在类的构造函数中初始化了按钮，初始化后，我从`main()`.

这是代码：

```
import java.awt.event.*;
import javax.swing.*;
import java.awt.*;

public class ButtonDemo implements ActionListener{
    JLabel jlab;

    ButtonDemo(){
        JFrame jfrm = new JFrame("A Button Example");

        jfrm.setLayout(new FlowLayout());

        jfrm.setSize(220, 90);
        jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JButton jbtnUp = new JButton("Up");
        JButton jbtnDown = new JButton("Down");

        jbtnUp.addActionListener(this);
        jbtnDown.addActionListener(this);

        jfrm.add(jbtnUp);
        jfrm.add(jbtnDown);

        JLabel jlab = new JLabel("Press a button.");

        jfrm.add(jlab);
        jfrm.setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent ae) {
        if(ae.getActionCommand().equals("Up"))
            jlab.setText("You pressed Up.");
        else
            jlab.setText("You pressed Down.");
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new ButtonDemo();
            }
        });
    }
} 
```

此异常的原因是什么，我该如何解决？
问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:05:54.277

您的代码通过在构造函数中重新声明变量 jlab 来隐藏变量 jlab，从而使类字段为空。不要那样做，你的 NPE 就会消失。

即，改变这个：

```
ButtonDemo(){
    JFrame jfrm = new JFrame("A Button Example");

    // ...

    // the variable below is being re-declared in the constructor and is thus
    // local to the constructor. It doesn't exist outside this block.
    JLabel jlab = new JLabel("Press a button.");

    // ...
} 
```

对此：

```
ButtonDemo(){
    JFrame jfrm = new JFrame("A Button Example");

    // ...

    jlab = new JLabel("Press a button."); // note the difference!

    // ...
} 
```

解决 NPE 的关键是仔细检查引发异常的行，因为该行上使用的一个变量为空。如果您知道这一点，您通常可以检查其余代码并找到问题并解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:14:50.563

actionPerformed 方法中的 jlab 是指您在构造函数 ButtonDemo 之外声明的 JLabel 。除非您对其进行初始化（即 jlab=new JLabel()），否则它将为 null 。因此您会得到一个 Exception 。

# c# - 从具有多个相似项目的表中仅删除一项

> ID：14551034
> 
> 赞同：0
> 
> 时间：2013-01-27T19:04:48.773
> 
> 标签：c#, asp.net, sql, tsql, sql-server-2008-r2

我想知道，如果我可以执行这样的操作。我在表中有以下数据排列：

```
id SessionId P_Name P_TypeId
1  abc        XYZ   5
2  abc        XYZ   5
3  abc        XYZ   5
4  abc        XYZ   5
5  abc        XYZ   5
6  abc        XYZ   5
7  abc        XYZ   5  
8  abc        XYZ   5 
```

在这里，我有 8 个类似的项目，但有唯一的 ID。

**健康）状况：**

从前端我将通过`[P_TypeId] = 5`，然后查询将使用删除语句从表中仅删除一项。*这可能吗？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:07:37.370

是的，例如使用`ROW_NUMBER`：

```
WITH x 
     AS (SELECT id, 
                sessionid, 
                p_name, 
                p_typeid, 
                RN = Row_number() 
                       OVER( 
                         partition BY sessionid, p_name, p_typeid 
                         ORDER BY id) 
         FROM   dbo.tablename
         WHERE P_TypeId = @P_TypeId ) 
DELETE x 
WHERE  rn = 1 
```

删除每个组的最低 id。

[**演示**](http://www.sqlfiddle.com/#!3/5dd15/3/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:11:17.153

```
delete top(1) from mytable where p_typeid = 5 
```

以上将删除包含 p_typeid 为 5 的一行。

如果要删除 id 最低的行，请尝试

```
 with t as (
   select top(1) * from mytable where p_typeid = 5
   order by id
 )
 delete from t 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:12:09.647

你可以这样做：

```
delete from dbo.your_tablename 
where id = (select top 1 id from dbo.your_tablename where P_TypeId = 5) 
```

虽然感觉有点像黑客。

正如其他答案所做的那样，如果需要，您还可以在查询中添加一个`where`子句。`select top...`

# php - PHP 除以 2 个值 & 回显 1 个除数

> ID：14551041
> 
> 赞同：-4
> 
> 时间：2013-01-27T19:05:28.043
> 
> 标签：php, math

我有这个脚本：

```
<?php
$result = mysql_query("SELECT * FROM high ORDER BY KC DESC LIMIT 20");

while($row = mysql_fetch_array($result))
{
echo $row['KC'];
echo "<br />";
}
?> 
```

还有这个

```
<?php
$result = mysql_query("SELECT * FROM high ORDER BY DC DESC LIMIT 20");

while($row = mysql_fetch_array($result))
{
echo $row['DC'];
echo "<br />";
}
?> 
```

我想占卜 DC 和 KC 并希望它显示除法后的值。

例如 DC = 80 和 KC = 30

系统会将 KC 分配到 DC ( 80 / 30 = 2.666666666666667 )

我试过这样做：

```
<?php
$result = mysql_query("SELECT * FROM high ORDER BY Runecraftlvl DESC LIMIT 20");
while($row = mysql_fetch_array($result))
{
echo $row['kills'] / $row['deaths'];
echo "<br />";
}
?> 
```

它工作得很好，但如果变量 KC 和 DC 都是 0，它会给我这个错误：

警告：第 86 行 /home/justxpp1/public_html/high/highscores.php 中除以零

为什么会这样？

[http://gyazo.com/26b3309c8e72d89ccc4cd32f4cdae7cd](http://gyazo.com/26b3309c8e72d89ccc4cd32f4cdae7cd)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:07:48.440

发生这种情况是因为除以零是未定义的。如果 KC 和 DC 为零，则方程为 0/0，即除以零。

要解决此问题，您只需确保除数（除数）**不**为零。

在您的示例中，如果玩家从未死亡，您将得到除以零。只需检查是否`$row['deaths']`为零，如果是，则显示适当的符号。在许多情况下，接受被零除以产生无穷大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:11:58.467

虽然这是一个太基本的问题，但这是一个可能的解决方案。您只需要检查第二个变量，第一个变量即使为 0 也可以：

```
<?php
$result = mysql_query("SELECT * FROM high ORDER BY Runecraftlvl DESC LIMIT 20");
while($row = mysql_fetch_array($result))
  {
  echo ($row['deaths'] != 0) ? $row['kills'] / $row['deaths'] : '-';
  echo "<br />";
  }
?> 
```

PD，它使用[三元运算符](http://phpmaster.com/using-the-ternary-operator/)。

我找到了一篇[文章](https://stackoverflow.com/questions/10283204/mysql-order-by-x-y-x-asc)，其中解释了如何按照您的要求进行操作。对于您的特定要求，这也很重要：[如何避免 SQL 中的“除以零”错误？](https://stackoverflow.com/questions/861778/how-to-avoid-the-divide-by-zero-error-in-sql)

# javascript - jQuery 简单克隆插件 - 更改输入名称格式

> ID：14551043
> 
> 赞同：1
> 
> 时间：2013-01-27T19:05:30.603
> 
> 标签：javascript, jquery

我正在使用简单的克隆插件。这是该插件的[github 页面](https://github.com/pake007/simple-clone)。

截至目前，它会生成输入名称，例如

```
user[projects][0][name]
user[projects][1][name]
user[projects][2][name] 
```

谁能告诉我如何生成名称

```
user[projects_name][0][1]
user[projects_name][1][1]
user[projects_name][2][1] 
```

我创建了一个`jsfiddle`演示给你看。

[http://jsfiddle.net/Viruthagiri/YLSdQ/1/](http://jsfiddle.net/Viruthagiri/YLSdQ/1/)

我认为这是生成 id 的函数。

```
// append a initial number to elements id, if options[:nested] true, also assign a initial number to the element name
  e.find("input, select").each(function(){
    var old_id = $(this).attr("id");
    $(this).attr("id", old_id+'_0');
    if(option.nested == true) {
      var old_name = $(this).attr("name");
      var reg = /\[\w*\]$/;
      var match = reg.exec(old_name);
      var new_name = old_name.substr(0, match.index) + "[0]" + match[0];
      $(this).attr("name", new_name);
    }
  })
$.fn.regenerate_names = function(number){
    $(this).find("input, select").each(function(){
      var old_name = $(this).attr("name");
      var old_number = old_name.match(/.*\[(\d+)\]/)[1];  // find the last match
      var old_number_index = old_name.lastIndexOf(old_number);
      var new_name = old_name.substring(0,old_number_index) + number + old_name.substring(old_number_index+1);
      $(this).attr("name", new_name);
    });
  }; 
```

这是[完整的源代码](https://github.com/pake007/simple-clone/blob/master/simpleclone.js#L47)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T06:49:20.543

我是pake007，插件的作者。我已更新插件以支持您的要求。请在github上克隆最新版本的simple-clone，对于您的问题，我认为您可以尝试以下代码：

```
<div class='project_group'>
  <input id="user_projects_name" name="user[projects_name][1]" type="text" /> 
</div>

$(".project_group").simple_clone({
  label: "Project Name ",
  label_colon: true,
  nested: true,
  start: 1
}); 
```

新选项“start”用于设置输入名称中第一个数组索引的开始，默认为 0。

上面的代码将生成输入名称，如：

```
user[projects_name][1][1]
user[projects_name][2][1]
user[projects_name][3][1] 
```

# python - 使用 Flask 检索非输入字段的值

> ID：14551050
> 
> 赞同：2
> 
> 时间：2013-01-27T19:06:15.307
> 
> 标签：python, html, flask

可能是一个愚蠢的问题，但我不知道如何使用 python 和 Flask 检索输入字段以外的任何值。例如，我有一个带有元素的 html 表单：

```
<form action="/newgame" method="POST"> 
<input type="text" name="white">
<select>
  <option name="result" value="onezero">1-0</option>
  <option name="result" value="zeroone">0-1</option>
  <option name="result" value="draw">draw</option>
</select>
<input type="text" name="black">
<input type="submit" value="submit">
</form> 
```

在服务器端，如果我调用`print request.form.items(True)`，那么我可以从两个`<input type="text">`元素中检索值，但不能从元素中检索`<select>`。

我有一个类似的问题，我想要一个带有两个提交按钮的表单，然后在服务器端计算出哪个按钮用于提交表单。我也没有运气。

帮助和建议表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:16:06.593

您的`name`属性需要在`select`元素上，而不是`option`元素上。像这样：

```
<select name="result">
    <option value="onezero">1-01</option>
    ...
</select> 
```

# css - css 样板和框架有什么区别？

> ID：14551051
> 
> 赞同：3
> 
> 时间：2013-01-27T19:06:15.477
> 
> 标签：css, frameworks, boilerplate

我一直在研究一些用于我的 shopify 主题的 css 框架，并且我不断看到 css 样板与框架属于同一类别。

两者有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-23T20:30:55.357

不知道我是否同意上面的答案。

我同意“模板”和“样板”是同一事物的不同名称。但是框架？！

我一直使用类比来帮助我思考。如果我考虑一下 Monty Python 的 Terry Gilliam ( [http://www.youtube.com/watch?v=xs7WaL44_Iw](http://www.youtube.com/watch?v=xs7WaL44_Iw) ) 的工作环境，我必须得出结论，实际上存在差异。

模板/样板：带尺子、边距等的办公桌。图书馆：剪报。框架：模板+库+灯+拍摄相机+胶带+玻璃+....

因此，框架基本上意味着所有工作环境，我们可以在其中找到模板、库、调试器、自动完成工具、编译器等其他工具。

这有道理吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:26:13.027

没有区别，只是同一事物的两个名称。Boilerplate（在这种情况下）只是一个（特定）Web 布局框架的怪异词。它也可以被命名为别的东西，如果那个创造它的人对那天的锅炉有一点不同的感觉。我的猜测是它来自`Boilerplate prototype`（*'*根据维基百科，'由更便宜或更简单的材料制成的广泛使用的原型'）。[它后来以样板代码](http://en.wikipedia.org/wiki/Boilerplate_code)的形式在 IT 行业中找到了意义。从本质上讲，它们都是a*的“花哨”*词`template`，因此我们这些极客可以对自己感觉更好。

# ruby - Ruby 的法拉第 - 多次包含相同的参数

> ID：14551057
> 
> 赞同：5
> 
> 时间：2013-01-27T19:06:43.910
> 
> 标签：ruby, api, url-parameters, faraday

我正在使用一个 API，该 API 迫使我多次发送相同的参数名称以级联不同的过滤条件。所以一个示例 api GET 调用如下所示：

```
GET http://api.site.com/search?a=b1&a=b2&a=b3&a=c2 
```

我将 Faraday 用于我的 REST 适配器，它将其 URL 参数作为哈希（因此 - 它具有唯一键）。这意味着我不能做这样的事情：

```
response = Faraday.new({
  url: 'http://api.site.com/search'
  params: { a: 'b1', a: 'b2', a: 'b3', a: 'c2' } # => nay
}).get 
```

我试图在发送请求之前破解 url：

```
connection = Faraday.new(url: 'http://api.site.com/search')
url        = connection.url_prefix.to_s
full_url   = "#{ url }?a=b1&a=b2&a=b3&a=c2"
response   = connection.get( full_url ) 
```

哪个不起作用 - 当我调试响应时，我看到发送到 API 服务器的实际 url 是：

```
GET http://api.site.com/search?a[]=b1&a[]=b2&a[]=b3&a[]=c2 
```

我无法更改 API。有没有办法继续与法拉第合作并以优雅的方式解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T16:16:56.247

一段时间以来，我一直在试图弄清楚如何做到这一点。我最终挖掘了法拉第代码，并在测试套件中找到了这个用例。

```
:params => {:color => ['red', 'blue']} 
```

应该产生

```
color=red&color=blue 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-19T19:14:44.340

如果您不想升级到 0.9.x

```
module Faraday
  module Utils
    def build_nested_query(value, prefix = nil)
      case value
      when Array
        value.map { |v| build_nested_query(v, "#{prefix}") }.join("&")
      when Hash
        value.map { |k, v|
          build_nested_query(v, prefix ? "#{prefix}%5B#{escape(k)}%5D" : escape(k))
        }.join("&")
      when NilClass
        prefix
      else
        raise ArgumentError, "value must be a Hash" if prefix.nil?
        "#{prefix}=#{escape(value)}"
      end
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T14:18:48.533

我认为您称呼法拉第的方式不正确。您需要先定义一个连接（不带参数），然后在该连接上调用 HTTP 方法。

像这样的东西：

```
require 'faraday'

client = Faraday::Connection.new :url => "http://api.twitter.com" do |builder|
    builder.response :logger
    # some middleware that helps to process a request/response comes here
end

client.get "search", { a: 1, b:2 } 
```

这应该为您构建此请求：

```
I, [2013-02-05T15:15:40.665955 #57012]  INFO -- : get http://api.twitter.com/search?a=1&b=2 
```

# c# - 手动将项目添加到 TreeView 时加载 ItemTemplate？

> ID：14551058
> 
> 赞同：0
> 
> 时间：2013-01-27T19:06:47.687
> 
> 标签：c#, wpf, xaml, treeview, itemtemplate

我正在手动创建我的节点（TreeViewItems），我的意思是在后面的代码中。我这样做是因为我在展开时按需加载子项，并且我必须添加一个虚拟节点。这就是我手动添加项目的原因。

现在，最重要的是当我创建 TreeViewItem 时不显示 DataTemplate 并显示默认值。输出窗口什么也没说。

```
 DataTemplate dt1 = this.Resources["exerciseSetTemplate"] as DataTemplate;

        foreach (var qs in qss)
        {
            TreeViewItem tvi = new TreeViewItem();
            tvi.Header = qs.SetName;
            tvi.Tag = qs;
            tvi.ItemTemplate = dt1;
            tvi.Items.Add(yourDummyNode);

            treeView1.Items.Add(tvi);
        } 
```

这是我的 XAML 代码：

```
<UserControl.Resources>
    <DataTemplate x:Key="questionSetTemplate">
        <StackPanel Orientation="Horizontal" Height="20" Margin="2,0,2,0">
            <Image Width="16" Height="16" Source="{StaticResource FolderImage}" Margin="0,0,5,0" />
            <TextBlock Text="{Binding SetName}" />
        </StackPanel>
    </DataTemplate>
</UserControl.Resources>

<Grid>
    <TreeView x:Name="treeView1" TreeViewItem.Expanded="treeView1_Expanded_1"
              ScrollViewer.HorizontalScrollBarVisibility="Disabled">
    </TreeView>
</Grid> 
```

我该怎么做才能显示 DataTemplate？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:26:32.103

我认为最好的选择是不要将对象直接添加到`TreeView` `Items`属性中（因为这将忽略 DataTemplates）并创建一个`Collection`以将这些项目添加到并将其绑定到您的`TreeView`，然后您可以删除您的`x:Key`属性`DataTemplate`并使用`DataType`，这将将模板应用于集合中该类型的任何对象到您的`TreeView`.

例子：

```
<UserControl x:Class="WpfApplication8.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:WpfApplication8"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300" Name="UI">
    <UserControl.Resources>
        <DataTemplate DataType="{x:Type local:MyObject}">
            <StackPanel Orientation="Horizontal" Height="20" Margin="2,0,2,0">
                <!--<Image Width="16" Height="16" Source="{StaticResource FolderImage}" Margin="0,0,5,0" />-->
                <TextBlock Text="{Binding SetName}" Foreground="Red"/>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <Grid DataContext="{Binding ElementName=UI}">
        <TreeView x:Name="treeView1" ItemsSource="{Binding TreeItems}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" />
    </Grid>
</UserControl> 
```

代码：

```
public partial class UserControl1 : UserControl
{
    public UserControl1()
    {
        InitializeComponent();

        //  foreach (var qs in qss)
        for (int i = 0; i < 50; i++)
        {
            // TreeItems.Add(qs);
            TreeItems.Add(new MyObject { SetName = "Test1" }); 
        }
    } 

    private ObservableCollection<MyObject> _treeItems = new ObservableCollection<MyObject>();
    public ObservableCollection<MyObject> TreeItems
    {
        get { return _treeItems; }
        set { _treeItems = value; }
    }
}

// Your "qs" object
public class MyObject : INotifyPropertyChanged
{
    private string _folderImage;
    public string FolderImage
    {
        get { return _folderImage; }
        set { _folderImage = value; NotifyPropertyChanged("FolderImage"); }
    }

    private string _setname;
    public string SetName
    {
        get { return _setname; }
        set { _setname = value; NotifyPropertyChanged("SetName"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:09:10.037

您忘记将树设置`ItemsTemplate`为您的`DataTemplate`

# xslt - 如何获取xslt中变量的元素

> ID：14551059
> 
> 赞同：1
> 
> 时间：2013-01-27T19:06:53.173
> 
> 标签：xslt, xslt-1.0

我已经导入了这个 transcript.xml，因为我有另一个用于 xsl 的源 xml

成绩单.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<t:transcript
    xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
    xmlns:t='http://namespace.profile.com/ns/transcript'
    xsi:schemaLocation='http://namespace.profile.com/ns/transcript transcript.xsd'>
    <t:studentName>Eva</t:studentName>
    <t:courses>
        <t:course>
            <t:code>IK2210</t:code>        
            <t:credits>3</t:credits>
            <t:grade>A</t:grade>
        </t:course>
        <t:course>
            <t:code>IB2210</t:code>
            <t:credits>3</t:credits>
            <t:grade>A</t:grade>
        </t:course>
        <t:course>
            <t:code>IB2210</t:code>
            <t:credits>1</t:credits>
            <t:grade>C</t:grade>
        </t:course>
        <t:course>
            <t:code>ID1234</t:code>
            <t:credits>2</t:credits>
            <t:grade>B</t:grade>
        </t:course>
    </t:courses>
</t:transcript> 
```

这是xsl的部分代码

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
xmlns:t='http://namespace.profile.com/ns/transcript'>
<xsl:output method="xml" />
<xsl:variable name="transcript" select="document('transcript.xml')/transcript"/> 
```

以下都不工作

```
<xsl:value-of select="$transcript/t:courses/t:course"/>
<xsl:value-of select="$transcript/courses/course"/>
<xsl:value-of select="$transcript/courses/t:course"/> 
```

我应该如何调用变量的元素？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:02:32.970

您忘记将命名空间前缀添加到您的变量`$transcript`：

```
<xsl:variable name="transcript" select="document('transcript.xml')/t:transcript"/> 
```

# javascript - 多选金额

> ID：14551060
> 
> 赞同：1
> 
> 时间：2013-01-27T19:07:05.730
> 
> 标签：javascript, jquery

我有不同的选择，其中有不同的值。我怎样才能得到这些值的总量？

例如我有

```
<select class="total">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
</select>
<select class="total">
    <option>2</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
</select> 
```

如果我从第一个选择`1`和第二个选择中选择，`2`我想得到`3`结果。

[http://jsfiddle.net/vQ8Bm/](http://jsfiddle.net/vQ8Bm/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:10:13.973

```
$(document).ready(function () {
    $('.total').on('change', function () {
        var sum = 0;
        $('.total').each(function () {
            sum += parseInt(this.value, 10);
        });
        alert(sum);
    });
}); 
```

[**小提琴**](http://jsfiddle.net/vQ8Bm/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T19:12:56.573

以防万一，一个 vanilla-js 解决方案

```
var map = Array.prototype.map;

var res = map.call(document.getElementsByClassName('total'), function( select ) {
    return select.value;
}).reduce(function( a, b ) {
    return +a + +b;
});

alert(res); 
```

*演示：http:* [//jsfiddle.net/vQ8Bm/6/](http://jsfiddle.net/vQ8Bm/6/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T19:10:32.543

获取跨多个`<select>`s 的值的总和：

```
var total = 0;
$('select.total').each(function () {
    total += parseInt($(this).val(), 10);
});

console.log(total); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-27T19:11:03.410

```
$(".total").change(function() {
    var sum = $(".total").map(function() {
        return +this.value;
    }).get().reduce(function(a, b) {
        return a + b;
    }, 0);
    console.log(sum);
}); 
```

**演示：http:** [//jsfiddle.net/vQ8Bm/4/](http://jsfiddle.net/vQ8Bm/4/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-27T19:12:09.427

您应该查看所选元素并将每个元素转换为整数，然后添加它们。

```
var sum = 0;
$('.total :selected').each(function () {
    sum += parseInt($(this).text());
}); 
```

*   [演示](http://jsfiddle.net/YnMJ4/2/)

**更新**

在选择更改事件中

```
$('.total').change(function () {
    var sum = 0;
    $('.total :selected').each(function () {
        sum += parseInt($(this).text());
    });
}); 
```

# list - SML中使用ListPair.foldr实现zipWith

> ID：14551062
> 
> 赞同：0
> 
> 时间：2013-01-27T19:07:07.177
> 
> 标签：list, functional-programming, sml, currying

背景：SML 初级

我的任务要求我使用 ListPair.foldr 并且只有这个函数来实现 zipWith 函数。

```
ListPair.foldr : ('a * 'b * 'c -> 'c) -> 'c -> 'a list * 'b list -> 'c
zipWith : ('a * 'b -> 'c) -> 'a list -> 'b list -> 'c list 
```

ListPair.foldr 返回单个 'c 元素，而 zipWith 返回一个 'c 列表，所以我的方法自然会反复使用 ListPair.foldr 来溢出单个 'c 元素，然后我将其放入我的 'c 列表中。ListPair.foldr 采用一对列表并根据提供的函数将它们相互折叠，因此获得所需效果的唯一方法是一次从每个列表中获取一个元素，将其作为 ListPair.foldr一对列表，获取结果，并将其连接到下一轮。我还必须将函数从 ('a*'b->'c) 转换为 ('a*'b*'c->'c)。像这样：

```
fun zipWith f [] l2 = []
| zipWith f l1 l2 = 
let val f2 = fn (a,b,c)=> f(a,b)+c   (* converting the function *)
    val xh = [hd(l1)]      (*first element of 'a list, as a list itself *)
    val yh = [hd(l2)]      (*first element of 'b list, as a list itself *)
    val xt = tl(l1)        (*taking the tail of 'a list*)
    val yt = tl(l2)        (*taking the tail of 'b list*)
in
    ListPair.foldr f2 0 (xh, yh)::    (*perform the operation with the two heads*)
    zipWith f xt yt                   (*recursively call zipWith with the remainder*)
end; 
```

这行得通。

```
- zipWith (fn (x,y)=>x+y) [1,2,3] [10,20,30];
val it = [11,22,33] : int list 
```

但现在棘手的部分是：我不应该递归地执行此操作，也就是说，我不能在我的 zipWith 函数中调用 zipWith 。这甚至可能吗？根据我的阅读，Haskell 中的实际 zi​​pWith 函数是递归定义的；我如何以非递归方式执行此操作？

我无法想象教授会敦促我们以面向对象的方式使用 while 循环之类的方法来执行此操作（无论如何我都尝试过，我的水平还不够）。

我是在完全错误的方向吗？我应该如何处理这个问题？

-----------------已回答----------------

我实际上首先尝试了pad的解决方案：

```
fun zipWith f l1 l2 = 
let val f2 = fn (a,b,c)=> f(a,b)::c
in
    ListPair.foldr f2 0 l1 l2
end; 
```

但它不起作用，因为我将它附加到 0 而不是 []。类型不正确，我无法弄清楚！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:06:49.547

您的方法是正确的，但不必要地复杂。函数`zipWith`是递归的，但您可以非递归地定义它，因为它`ListPair.foldr`已经具有递归性质。

为了更接近`zipWith`，您需要`ListPair.foldr`具有以下签名的专用版本

```
ListPair.foldr : 
   ('a * 'b * 'c list -> 'c list) -> 'c list -> 'a list * 'b list -> 'c list 
```

这意味着您将一个空列表作为累加器传递，并在此过程中建立更大的列表。中`zipWith f xs ys`，`f`有`'a * 'b -> 'c`签名，所以很容易适应：

```
fun zipWith f xs ys =
    ListPair.foldr (fn (a, b, cs) => f(a, b)::cs) [] (xs, ys) 
```

# jquery - 本网站使用的 onmouseover div 替换脚本

> ID：14551074
> 
> 赞同：-1
> 
> 时间：2013-01-27T19:08:12.033
> 
> 标签：jquery, css

我意识到这对这里的大多数人来说可能是基本的，但我对此很陌生，还没有找到自己的答案。

如果您将鼠标悬停在下面链接的站点上的 MIND、BODY 或 SOUL 词或图标上，则会显示新内容。任何人都可以指出我使用的技术或JS吗？

[http://combadi.com](http://combadi.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:11:24.063

看一下 jQuery UI 效果：http: [//jqueryui.com/effect/](http://jqueryui.com/effect/)

他们有许多动画，可以显示/隐藏鼠标悬停或单击等事件的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:15:14.270

例子：

```
$(".link").hover(function() {
$(".target").html("HI!");
}); 
```

这是一个简单的 jQuery 函数。它的内容如下：

如果有人将鼠标悬停在具有类链接的元素上，请在具有类目标的元素中打印“HI”。

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

# javascript - 如何打开右侧的下拉菜单？

> ID：14551075
> 
> 赞同：0
> 
> 时间：2013-01-27T19:08:15.980
> 
> 标签：javascript, jquery, twitter-bootstrap

有没有办法让下拉菜单不总是在 twitter bootsrapper 中打开？有时右侧没有空间，特别是在 iphone 等移动设备中，我希望它在左侧打开

请在这里查看我的示例：

```
<div class="container">
<ul class="nav nav-pills">
              <li class="active"><a href="#">Regular link</a></li>
              <li class="dropdown open">
                <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="#">Dropdown <b class="caret"></b></a>
                <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
                  <li><a tabindex="-1" href="#">Action</a></li>
                  <li><a tabindex="-1" href="#">Another action</a></li>
                  <li><a tabindex="-1" href="#">Something else here</a></li>
                  <li class="divider"></li>
                  <li><a tabindex="-1" href="#">Separated link</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a class="dropdown-toggle" id="drop5" role="button" data-toggle="dropdown" href="#">Dropdown 2 <b class="caret"></b></a>
                <ul id="menu2" class="dropdown-menu" role="menu" aria-labelledby="drop5">
                  <li><a tabindex="-1" href="#">Action</a></li>
                  <li><a tabindex="-1" href="#">Another action</a></li>
                  <li><a tabindex="-1" href="#">Something else here</a></li>
                      <li class="divider"></li>
                  <li><a tabindex="-1" href="#">Separated link</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a class="dropdown-toggle" id="drop5" role="button" data-toggle="dropdown" href="#">Open on left <b class="caret"></b></a>
                <ul id="menu3" class="dropdown-menu" role="menu" aria-labelledby="drop5">
                  <li><a tabindex="-1" href="#">Action</a></li>
                  <li><a tabindex="-1" href="#">Another action</a></li>
                  <li><a tabindex="-1" href="#">Something else here</a></li>
                  <li class="divider"></li>
                  <li><a tabindex="-1" href="#">Separated link</a></li>
                </ul>
              </li>
            </ul>
</diV> 
```

[http://jsfiddle.net/MgcDU/1557/](http://jsfiddle.net/MgcDU/1557/)

我希望最后一个按钮“在左侧打开”以在左侧而不是右侧打开它的菜单。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:40:55.197

使用 css 将下拉菜单项设置为具有负边距值。

# java - Java中Obj-C的委托等价物

> ID：14551076
> 
> 赞同：2
> 
> 时间：2013-01-27T19:08:16.737
> 
> 标签：java, objective-c, delegates

在 Objective-C 中，为了创建和处理连接（NSURLConnection），它有一个委托，其中包含 didConnect、didFailWithError 等方法，这些方法可以根据需要调用。这很好也很简单。Java 如何处理连接事件（或类似的事情）？存在某种听众模式，是否必须注册所有内容才能收听？有什么自动回调？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:10:15.850

在 Java 中，等效的机制是 EventListeners 和 EventHandlers。GUI 类充满了它们的使用示例。而且它们没有什么“自动”的，您需要为感兴趣的事件显式注册处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:17:47.193

Objective-C 中的委托模式没有直接的等价物。

您可以使用发布-订阅模式获得几乎相同的结果，该模式在 Objective-C 中由和`NSNotificationCenter`在 Java 中实现。`EventListeners``EventHandlers`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:30:27.193

毕竟委托只是一个保证有一些方法的类，这样你就可以调用它们，让它处理一些事件。

因此，只需声明一个接口或抽象类，其中包含您想要的所有方法，例如 didConnect 等……然后持有委托的类将调用这些方法，并且确定它们会在那里。

# android - 响铃后对话框迅速消失 - android

> ID：14551080
> 
> 赞同：-1
> 
> 时间：2013-01-27T19:08:45.753
> 
> 标签：android, android-alertdialog

我创建了一个程序，即使手机被锁定，它也会在收到消息时发出警报。当电话响起时，它会显示关闭按钮以停止闹钟，但我的代码只显示关闭按钮并迅速消失，让我无法选择如何停止闹钟。请帮我处理这段代码。提前感谢您的帮助

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.receiverinterface);
    unlockScreen();
    alertDialogBuilder = new AlertDialog.Builder(
            context);
    alertDialogBuilder.setTitle("Alarm");
            alertDialogBuilder
            .setMessage("Stop Alarm")
            .setCancelable(false)
            .setPositiveButton("Dismiss", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int id) {
                    Ringtone r = EAlarmReceiver.r;
                    r.stop();
                    Toast.makeText(context.getApplicationContext(), "Alarm Stopped", Toast.LENGTH_LONG).show();
                    if(EAlarmReceiver.sms.length() > 10)
                    {
                        Intent openInterface = new Intent("proj.receiver.VIEWMESSAGE");
                        openInterface.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        context.startActivity(openInterface);
                    }
                    else
                    {
                        Intent openInterface = new Intent("proj.receiver.RECEIVERINTERFACE");
                        openInterface.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        context.startActivity(openInterface);
                    }
                }
            });
            // create alert dialog
            AlertDialog alertDialog = alertDialogBuilder.create();
            // show it
            alertDialog.show();
}// end oncreate()

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    finish();
}

//unlock screen
public void unlockScreen() {
    //make the activity show even the screen is locked.
    Window window = getWindow();
    window.addFlags(WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON
            + WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED
            + WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON
            + WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:46:22.083

`finish()`从 onPause() 中删除后尝试此代码。也发布完整的代码。

编辑：-正如您所说的删除完成对您有用，这是您的第二个问题的解决方案。

1）复杂和临时的解决方案：-尝试添加一个布尔变量，您应该在对 AlertDialog 采取的操作时将其设置为 true，如果在 onResume 中为 true，则完成您的活动。每次你回到你的活动时都会调用 OnResume。

2）但如果我在你的地方，我会遵循以下方法。

创建一个布局看起来像警报对话框。并在清单中的活动声明中将活动主题设置为对话框，它将打开你的活动作为对话框。因此，您无需创建 AlertDialog 来处理操作，您可以添加关闭按钮和所有按钮。

# javascript - 如何在动态 HTML 表格上显示上下文菜单

> ID：14551082
> 
> 赞同：1
> 
> 时间：2013-01-27T19:08:54.490
> 
> 标签：javascript, jquery, html

我是 jquery 的新手，想开发一个只有“编辑”和“取消”功能的上下文菜单。我有一个动态 HTML 表。

我只想为第二个显示上下文菜单（除了标题，即“语句”）表结构如下：

```
 <table>
   <tr>
     <td>ID</td>
     <td>Statement</td>
   </tr>
    <tr>
     <td>1</td>
     <td>Select * From mytable.</td>
    </tr>
     <tr>
     <td>2</td>
     <td>Select * From table.</td>
     </tr>
     <tr>
       <td>3</td>
       <td> Delte tabel mytable.</td>
     </tr>
     <tr>
      <td>4</td>
      <td>Truncate table mytable</td>
     </tr>
     <tr>
      <td>5</td>
        <td>Truncate table mytable</td>
      </tr>
    </table> 
```

我想要一个功能，如果我单击“语句”（标题除外）列，则应显示上下文菜单。谢谢你们的期待......卡皮尔

# php - jQuery ajax 帖子

> ID：14551084
> 
> 赞同：1
> 
> 时间：2013-01-27T19:08:59.077
> 
> 标签：php, jquery, ajax

我有以下无法正常运行的代码。单击 li 时，我正在尝试向 mysql db 发布一个值。第一个是 js 文件，第二个是我的 php 文件。感谢您的帮助。

> javascript:

```
function changeIt(){    
 $("#pagewrap").css({'background-image':'url(/image/HapppsTemplates/BlueTemplates/blueShell.svg)'});
 $.ajax({
  type: "POST",
  url: "templatepost.php",
  data: { tempname: "blueShell.svg"}
});
    } 
```

> 模板post.php：

```
<?php

header("Location: templatetest.php");
require_once("./source/include/membersite_config.php");

if(!$fgmembersite->CheckLogin())
{
    $fgmembersite->RedirectToURL("login.php");
    exit;
}

mysql_connect("xxx", "xxx", "xxx") or die(mysql_error());
mysql_select_db("xxx") or die(mysql_error());

$test = $fgmembersite-> UserID();
    $template_name = $_POST ['tempname'];

$query = "UPDATE events SET tempname= '".$template_name."' WHERE id_user = '$test'"
or die(mysql_error());

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:10:14.787

您实际上从未使用`mysql_query`.

你的代码也很不安全。您不会转义查询中的 POST 值。您应该使用带有`PDO`或的参数化查询`mysqli`。

```
$pdo = new PDO('mysql:host=xxx', 'xxx', 'xxx');
$stmt = pdo->prepare('UPDATE xxx.events SET tempname = ? WHERE id_user = ?');
$stmt->execute($template_name, $test); 
```

# javascript - IE 中的 JavaScript 替换

> ID：14551101
> 
> 赞同：0
> 
> 时间：2013-01-27T19:10:16.147
> 
> 标签：javascript, jquery, internet-explorer, replace

我有一个页面，可以在其中创建包含一些搜索条件字段的相同行数。我创建了模板 div，它在用户按下 addButton 时填充。在我的 js 函数中，我将 id 和 name 替换为正确的值并添加正确的订单号，如 1、2、3 等。该函数在 FireFox、Chrome 和 Safari 下运行良好。但它在 IE 下失败，没有任何警告。

```
 var $rowtp = $('div#partnerFactory-template')
            .html()
            .replace(/id="__prefix__/g, "id=\"truckSearcherFilter_partnerFactoryRow")
            .replace(/name="__prefix__/g, "name=\"truckSearcherFilter.partnerFactoryRow");

var $nrow = $('div#partnerFactory-list').append($rowtp) 
```

这是替换后的正确 Firefox 结果

```
<input id="truckSearcherFilter_partnerFactoryRow_0__partnerName" class="ui-corner-all ui-widget-content ui-autocomplete-input" type="text" value="" name="truckSearcherFilter.partnerFactoryRow[0].partnerName" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true"> 
```

这就是我在 IE 中看到的

```
<INPUT id=__prefix___0__partnerName class="ui-corner-all ui-widget-content" type=text name=__prefix__[0].partnerName jQuery17206032578406930051="64"> 
```

任何人都可以看到我做错了什么？

问候简

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:16:50.887

依赖什么`innerHTML`（或者在这种情况下，`.html()`）吐出是[一个坏主意](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)。您可以从输出中看到，IE 内部不会在一个单词属性周围加上引号（这可能表明您没有费心添加`DOCTYPE`，因为这是 Quirks 模式的行为）。

`onClick`当我尝试从内联属性中解析参数时，我在 Firefox 中遇到了类似的问题。其他人在尝试解析时遇到问题，`getComputedStyle().color`并期望`#RRGGBB`他们实际得到`rgb(R,G,B)`.

解决方法如下：

```
var clone = document.getElementById('partnerFactory-template').cloneNode(true),
    inputs = clone.getElementsByTagName('input'), l = inputs.length, i,
    target = document.getElementById('partnerFactory-list');
for(i=0; i<l; i++) {
    inputs[i].name = inputs[i].name.replace("__prefix__","truckSearcherFilter_partnerFactoryRow");
    inputs[i].id = inputs[i].id.replace("__prefix__","truckSearcherFilter_partnerFactoryRow");
}
while(clone.firstChild) target.appendChild(clone.firstChild); 
```

请注意没有 jQuery，因此大大提高了性能。别客气 ;）

# ffmpeg - 使用 FFMPEG，创建与视频比例成比例的缩略图

> ID：14551102
> 
> 赞同：22
> 
> 时间：2013-01-27T19:10:17.897
> 
> 标签：ffmpeg

我正在使用以下命令使用 FFMPEG 创建缩略图：

```
ffmpeg -itsoffset -1 -i video.avi -vcodec mjpeg -vframes 1 -an -f rawvideo -s 240x180 image.png 
```

它工作正常。但是，当视频不是 4:3 比例时，它仍然会创建一个 240x180 的图像，并且多余的空间将被涂成黑色。命令是否有一些变化可以防止这种情况并给我一个与视频比例成比例的图像？换句话说，我希望 240x180 成为缩略图的最大尺寸，而不是最小尺寸。

如果该命令在视频小于 240x180 时创建较小的图像，则会加分。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-27T19:28:01.707

使用[过滤](http://ffmpeg.org/ffmpeg-filters.html#scale)[器`scale`](http://ffmpeg.org/ffmpeg-filters.html#scale)：

```
ffmpeg -itsoffset -1 -i video.avi -vframes 1 -filter:v scale="280:-1"  image.png 
```

这将保留纵横比以实现 280 像素的宽度。要将宽度增加到最大 280 像素但保持比例，请使用：

```
scale='min(280\, iw):-1' 
```

在这里，我们只假设您的视频是横向格式，因此我们可以将最大宽度设置为 280，而忽略高度，对于 3:2 的视频应该是 180，对于 16:9 的内容应该是 158。

笔记：

*   `-vcodec mjpeg`写入 PNG 文件时没有意义
*   `-f rawvideo`也不在这里做任何事情
*   `-an`不需要，因为 FFmpeg 无法将音频写入 PNG 文件

# php - SQL join into join 创建好数组

> ID：14551103
> 
> 赞同：3
> 
> 时间：2013-01-27T19:10:18.700
> 
> 标签：php, sql, arrays, join, left-join

嗨，我想做一个好的查询以获得一个好的数组。现在例如我有这个查询：

```
SELECT DISTINCT * FROM products 
        LEFT OUTER JOIN  product_aliases 
        ON product_aliases.product_id = products.id 
        AND product_aliases.alias = '$alias'
        LEFT OUTER JOIN  (product_images
            LEFT OUTER JOIN  product_image_votes 
                    ON product_image_votes.product_image_id = product_images.id)
        ON product_images.product_id = products.id 
WHERE products.id = $id 
```

结果是两个这样的数组：

```
array(
(int) 0 => array(
    'products' => array(
        'id' => '1',
        'user_id' => '1',

    ),
    'product_aliases' => array(
        'id' => '1',
        'product_id' => '1',
        'language' => 'it',
    ),
    'product_images' => array(
        'id' => '1',
        'product_id' => '1',
    ),
    'product_image_votes' => array(
        'id' => '2',
        'product_image_id' => '1',
        'vote' => '1',
    )
),
(int) 1 => array(
    'products' => array(
        'id' => '1',
        'user_id' => '1',

    ),
    'product_aliases' => array(
        'id' => '1',
        'product_id' => '1',
        'language' => 'it',
    ),
    'product_images' => array(
        'id' => '1',
        'product_id' => '1',
    ),
    'product_image_votes' => array(
        'id' => '2',
        'product_image_id' => '1',
        'vote' => '1',
    )
) 
```

问题是：我只想要一个包含产品的唯一数组，例如包含在数组 product_images_votes 中的 product_images。第一个问题是：

*   有一个唯一的数组而不是两个数组
*   在我的左连接 annidate 的基础上创建数组内的数组

数组示例：

```
array(
(int) 0 => array(
    'products' => array(
        'id' => '1',
        'user_id' => '1',

    ),
    'product_aliases' => array(
        'id' => '1',
        'product_id' => '1',
        'language' => 'it',
    ),
    'product_images' => array(
        'id' => '1',
        'product_id' => '1',
        array('product_image_votes' => array(
            'id' => '2',
            'product_image_id' => '1',
            'vote' => '1',
        ))
    ) 
```

有可能吗？我正在使用 php

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:29:12.873

您的查询本身很好，但您需要在 PHP 中构建嵌套。您不能真正单独在 SQL 中生成嵌套结构，因此您必须使用现有的扁平结构。

这可以通过一些创造性的循环来完成。创建一个由 索引的输出数组`products['id']`。在每次迭代中，如果新条目尚不存在，则创建一个新条目。如果它确实存在，添加到它的`product_images`，一个也由 索引的数组`product_images['id']`。

```
// To hold the final array
$output = array();
foreach ($original_array as $row) {

  // Storing these id values to make them easier to refer to...
  $id = $row['products']['id'];
  $pid = $row['product_images']['id'];
  $paid = $row['product_aliases']['id'];
  $pivid = $row['product_image_votes']['id'];

  // Create the product entry if it does not exist
  // and initialize arrays for product_images and product_aliases    
  if (!isset($output[$id])) {
    $output[$id] = array(
      'products' => $row['products'],
      // Initialize these to sub-arrays containing the first ones from this row
      // using the id as the array key
      'product_aliases' => array($paid => $row['product_aliases']),
      'product_images' => array($pid => $row['product_images'])
    );
    // Then add the first vote
    $output[$id]['product_images'][$pid]['product_image_votes'] = array();
    $output[$id]['product_images'][$pid]['product_image_votes'][$pivid] = $row['product_image_votes'];
  }
  // If it does exist already, append the alias if that does not exist, the image, the vote etc.
  else {
    // First add the alias if not already set
    if (!isset($output[$id]['product_aliases'][$paid])) {
      $output[$id]['product_aliases'][$paid] = $row['product_aliases'];
    }
    // Then add the image if not already set
    if (!isset($output[$id]['product_images'][$pid])) {
      $output[$id]['product_images'][$pid] = $row['product_images'];
    }
    // And nest in the image_votes
    if (!isset($output[$id]['product_images'][$pid]['product_image_votes'][$pivid])) {
      $output[$id]['product_images'][$pid]['product_image_votes'][$pivid] = $row['product_image_votes'];
    }
  }
} 
```

这里有很多，很可能我有语法错误或在`]`某处丢失。祝你好运。

# php - PHP错误信息的编码

> ID：14551104
> 
> 赞同：4
> 
> 时间：2013-01-27T19:10:23.570
> 
> 标签：php

我在 Windows 上有 WebServer。

在 .htaccess 中：

```
AddDefaultCharset utf-8
php_value mbstring.internal_encoding utf-8
php_value default_charset utf-8 
```

在脚本中：

```
header("Content-Type: text/html; charset=utf-8");
ftp_connect("1"); 
```

在 UTF-8 浏览器中：

```
Warning: ftp_connect() [function.ftp-connect]: php_network_getaddresses: getaddrinfo failed: ���� ���� ����������. ( 
```

问题 - 为什么错误消息不在 UTF-8 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:08:52.547

似乎 PHP 与来自“getaddrinfo failed:”的错误消息无关。错误表示的字符来自不同的来源 - 这里来自 ftp 服务器应用程序。您已经检查了 Web 服务器和 PHP 端，但没有检查 ftp 服务器的配置。

我最好的选择是检查 ftp 服务器。

您可以检查代码下方的另一条错误消息

```
header("Content-Type: text/html; charset=utf-8");
ftp_connect("1");
//generate some mess resulting in error info
file_get_contents('forsurenonexistingfile'); 
```

如果您的错误信息以正确的字符表示形式出现，那么神秘就消失了。

# api - Android NDK 多个 API 级别

> ID：14551113
> 
> 赞同：3
> 
> 时间：2013-01-27T19:11:21.337
> 
> 标签：api, android-ndk

是否可以在 NDK 中定义最低 API 级别和目标 API 级别，就像在 java 清单中一样？

我只知道我可以使用 APP_PLATFORM 来指定目标，但是如果我还想设置最小 API 怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T10:00:34.973

不，您不能在 NDK 构建系统中指定此类信息，因为每个版本的 Android 系统映像都不同。

对于本机代码，可移植性方面与仅用 Java 编写应用程序时不同。

如果您想使用本地代码支持不同版本的 Android，您很可能必须针对不同的 APP_PLATFORM 编译您的代码。

正如您所说，您只能在 Application.mk 文件中使用 APP_PLATFORM 指令，该文件记录为：

> APP_PLATFORM = 命名目标 Android 平台。例如，“android-3”对应于 Android 1.5 系统映像。有关平台名称和相应 Android 系统映像的完整列表，请阅读 docs/STABLE-APIS.html。

来自 docs/STABLE-APIS.html (android-ndk-r8d) 的部分：

> 定义了几个“API 级别”。每个 API 级别对应于给定的 Android 系统平台版本。当前支持以下级别：
> 
> ```
> android-3      -> Official Android 1.5 system images
> android-4      -> Official Android 1.6 system images
> android-5      -> Official Android 2.0 system images
> android-6      -> Official Android 2.0.1 system images
> android-7      -> Official Android 2.1 system images
> android-8      -> Official Android 2.2 system images
> android-9      -> Official Android 2.3 system images
> android-14     -> Official Android 4.0 system images 
> ```
> 
> 请注意，对于 NDK，android-6 和 android-7 与 android-5 相同，即它们提供完全相同的原生 ABI！
> 
> 重要提示：与给定 API 级别对应的标头现在位于 $NDK/platforms/android-/arch-arm/usr/include 下

# c# - 在 ToDictionary 调用中捕获异常

> ID：14551118
> 
> 赞同：2
> 
> 时间：2013-01-27T19:11:27.953
> 
> 标签：c#, linq, exception, exception-handling, dictionary

我有一个简单的 LINQ 语句，它拆分一个字符串，然后将值扔到字典中。问题是字典很少已经具有相同值的现有键，因此抛出异常并且“dict”的值保持为空。

```
dict = lines.Select(l => l.Split('|')).ToDictionary(d => d[0], d => d[1]); 
```

有没有办法修改 LINQ 语句以在插入之前检查字典是否已经具有键或捕获异常但继续将其余值写入字典？我尝试在该行周围放置一个 try 块，它捕获了异常，但没有添加任何元素，因此字典保持为空。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:14:28.930

不要使用`ToDictionary`常规`foreach`和测试键。

将查询从转换中断为字典。

```
var splits = lines.Select(l => l.Split('|'));

var dict = new Dictionary<string,string>();
foreach(var item in splits)
{
   if(!dict.ContainsKey(item[0]))
       dict.Add(item[0], item[1]);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T19:33:45.907

您总是可以使用`GroupBy`为每个键创建一个组，然后只为字典中的每个键选择第一个值；

```
var dict = lines.Select(x => x.Split('|'))
                .GroupBy(x => x[0], x => x[1])
                .ToDictionary(x => x.Key, x => x.First()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:22:04.317

如果您需要每个键保存一个值的字典，您可以使用：

```
var dict1 = lines
          .Select(l => l.Split('|'))
          .GroupBy(s => s[0])
          .ToDictionary(d => d.Key, d => d.First()[1]); 
```

或者您可以使用它，如果您想要`Dictionary<string,IEnumerable<string>>`将键和相应的值保存为`IEnumerable<string>`

```
var dict2 = lines
           .Select(l => l.Split('|'))
           .GroupBy(s => s[0])
           .ToDictionary(d => d.Key, d => d.Select(r => r[1])); 
```

# ant - Ant 复制任务：包括额外的行直到结束“;”？

> ID：14551119
> 
> 赞同：1
> 
> 时间：2013-01-27T19:11:43.630
> 
> 标签：ant

我有一个（见下文）Ant 复制任务，它成功复制了所有包含正则表达式模式中的 5 个元素的行，但这些语句以“;”结尾 有时会超过一行，但不包括这些额外的行。他们是一种将这些额外的行包含到结束“;”的方法吗？

```
<copy file="${updates-dir}/updates.sql"
      tofile="${updates-dir}/updates_filtered.sql">
  <filterchain>
    <linecontainsregexp>
      <regexp pattern="BEGIN;|INSERT INTO|UPDATE|DELETE FROM|COMMIT;"/>
    </linecontainsregexp>
  </filterchain>
</copy> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:08:41.900

使用正则表达式解析任意 SQL 是*困难*的。在 Ant 中也没有什么不同，但是，如果您的输入足够一致，您也许可以摆脱它。

一种选择可能是通过 SQL 语句处理输入 - 即将它拆分为分号而不是行尾 - 使用[标记过滤器](http://ant.apache.org/manual/Types/filterchain.html#tokenfilter)。因此，您发布的内容可能会有所不同

```
<filterchain>
  <tokenfilter>
    <stringtokenizer delims=";"/>
    <containsregex pattern="BEGIN|INSERT INTO|UPDATE|DELETE FROM|COMMIT" />
  </tokenfilter>
</filterchain> 
```

您可以选择从输出中排除分隔符。

如果您的输入不是“干净的”，那么使用像这样的简单过滤器将难以稳健地满足所有输入可能性。

# python - 呈现 AppEngine 数据以供用户编辑的最简单方法

> ID：14551120
> 
> 赞同：1
> 
> 时间：2013-01-27T19:11:45.967
> 
> 标签：python, google-app-engine

是否有任何标准实用程序可以只向`db.Model`用户提供一个类 ( ) 并让他们能够在其上执行所有标准插入、删除、更新功能？我真的不想为我拥有的每种类型写一个。我知道这使它“更强大”，但现在我正在追求更快的概念证明。

# sql-server-2008 - SQL Server 中的一个表可以创建多少个触发器？

> ID：14551122
> 
> 赞同：2
> 
> 时间：2013-01-27T19:11:54.787
> 
> 标签：sql-server-2008, triggers

有限制吗？SQL Server 中的单个表可以创建多少个触发器？

此限制在 SQL Server 2000、2005、2008 和 2012 中也有所更改。

触发器也有`INSTEAD OF`触发器和`For/After`触发器两种类型。分别对它们有什么限制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T19:13:42.033

受数据库中对象总数的限制。一个数据库中所有对象的总数不能超过2,147,483,647

换句话说，您不必担心这个限制；*在一般*情况下你永远不会碰到它。

# ios - 如何修改 GPUImageGaussianSelectiveBlurFilter 以显示矩形区域而不是圆形

> ID：14551128
> 
> 赞同：0
> 
> 时间：2013-01-27T19:12:36.293
> 
> 标签：ios, opengl-es-2.0, blur, gpuimage, imagefilter

> **可能重复：**
> [如何修改 GPUImageGaussianSelectiveBlurFilter 以对矩形而不是圆形进行操作？](https://stackoverflow.com/questions/12257429/how-do-i-modify-a-gpuimagegaussianselectiveblurfilter-to-operate-over-a-rectangl)

How do I modify a GPUImageGaussianSelectiveBlurFilter [to operation over a rectangle而不是圆？](https://stackoverflow.com/questions/12257429/how-do-i-modify-a-gpuimagegaussianselectiveblurfilter-to-operate-over-a-rectangl)但答案并不完整，所以我重新发布。让我重新表述这个问题。我正在尝试使用 Brad Larson 最棒的 GPUImage 库中的 GPUImageGaussianSelectiveBlurFilter。我唯一需要改变的是图像上出现的“清晰”区域的形状。我查看了代码，以下行根据像素与“清晰”区域中心的距离决定将哪种颜色应用于像素：

```
 gl_FragColor = mix(sharpImageColor, blurredImageColor, smoothstep(excludeCircleRadius - excludeBlurSize, excludeCircleRadius, distanceFromCenter)); 
```

我在 SHADER_STRING 中做了什么改变，所以我得到了一个矩形区域？此外，矩形区域也可能具有旋转/缩放功能，因此过滤器需要相应地调整“透明”区域。提前致谢！

# azure - Windows azure 缓存 - 检查密钥是否存在的最佳实践

> ID：14551129
> 
> 赞同：0
> 
> 时间：2013-01-27T19:12:37.803
> 
> 标签：azure, azure-caching

在 Windows Azure 缓存 ( [http://msdn.microsoft.com/en-us/library/windowsazure/hh914161.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh914161.aspx) ) 中，当有人试图获取未缓存的对象（即对象的键不存在）。

除了处理 DataCacheException，有没有办法检查密钥是否正常存在？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:06:51.840

如果未找到提供的键，DataCache.Get(key) 方法将返回null [。](http://msdn.microsoft.com/en-us/library/ff424908%28v=azure.10%29.aspx)

任何其他需要密钥存在的方法（例如与锁定有关的方法）都将导致 DataCacheException。

# javascript - 配置 jQuery 滑块

> ID：14551130
> 
> 赞同：0
> 
> 时间：2013-01-27T19:12:43.280
> 
> 标签：javascript, jquery, slider, jquery-ui-slider

我是 JS 和 Jquery 的新手，我正在尝试解决我的问题。[这是](http://jqueryui.com/slider/#default)我想合并的 jQuery Slider 插件

我有一个包含 1,000-2,000 个对象的数组。每个对象都有一个时间和唯一 ID。时间示例：

```
2013-01-23 23:59:03
2013-01-23 23:58:33
2013-01-23 23:58:03
2013-01-23 23:57:33
2013-01-23 23:57:02
2013-01-23 23:56:33 
```

我需要确保滑块始终加载到它的范围内，并且每次移动滑块时，我都希望看到一个事件，我有时间，并且`addMarker(my unique id)` 触发了函数。

我尝试通过加载值，`$( ".selector" ).slider( "values", [ 'my time 1', 'my time 2'] );`但似乎我做得不对。JS 和 Jquery 对我来说仍然是新的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T02:19:12.513

为了做到这一点，我必须创建一个哈希映射数组并创建对每个事件的响应并调用哈希映射中的元素

```
 $(function() {
                $( "#slider-range-max" ).slider({
                    range: "max",
                    min: 1,
                    //declare maximum which is the amount of elements in array
                    max:  polyArray.filter(function(value) {
                        return value !== undefined
                    }).length,
                    value: 2,
                    slide: function( event, ui ) {
                        var cRte= {};
                        //access my hash map
                        cRte = History[ui.value]; 
                        try { 
                        alert(cRte["timestamp"]);
                        } catch(e) {
                            console.log(e);
                        }
                    }
                });
            }); 
```

# java - cURL在android java中使用httppost

> ID：14551132
> 
> 赞同：1
> 
> 时间：2013-01-27T19:12:44.350
> 
> 标签：java, android, json, curl, libcurl

我正在尝试使用 httpclient 在 android 中获取 cURL 请求。

```
curl -k -X POST \
-F 'image=@00001_1.png;type=image/png' \
-F 'svgz=@00001_1.png;type=image/svg+xml' \
-F 'json={ 
    "text" : "Hello world!",
    "tid" : "0010",
    "timestamp" : "1342683312", 
    "location" : [ 22793, -553.3344],
    "facebook" :
    {
        "id": "4444444",
        "access_token": "7FUinHfxsCTrx",
        "expiration_date": "1358204400"                
    }
};type=application/json' \
https://example.com/api/posts 
```

这是给我一个来自服务器的错误请求错误（400）的代码。

```
public static void example() {
        HttpClient client = getNewHttpClient();
        HttpPost httpost = new HttpPost("https://example.com/api/posts");
        httpost.addHeader("image", "@00001_1.png; type=image/png");
        httpost.addHeader("svgz", "@00001_1.png; type=image/svg+xml");
        httpost.addHeader("type", "multipart/form-data");
//        httpost.setHeader("Content-type", "multipart/form-data");
        JSONObject data = new JSONObject();
        JSONObject facebook = new JSONObject();
        JSONArray location = new JSONArray();
        HttpResponse response = null;
        try {
            data.put("text","Hello world!");
            data.put("templateid","0010");
            data.put("timestamp","2012-07-08 09:00:45.312195368+00:00");

            location.put(37.7793);
            location.put(-122.4192);
            data.put("location", location);
            facebook.put("id", "4444444");
            facebook.put("access_token", "7FUinHfxsCTrx");
            facebook.put("expiration_date", "1358204400");
            data.put("facebook", facebook);

            System.out.println(" ---- data ----- "+data);

            StringEntity stringEntity = new StringEntity(data.toString(), "utf-8");
            httpost.setEntity(stringEntity);
            try {
                response = client.execute(httpost);
                System.out.println(" --- response --- "+response.getStatusLine().getStatusCode());
                HttpEntity entity = response.getEntity();
                // If the response does not enclose an entity, there is no need
                // to worry about connection release
                if(entity != null) {
                    // A Simple Response Read
                    InputStream instream = entity.getContent();
                    String result = convertStreamToString(instream);
                    System.out.println(" ---- result ---- "+result);

                    // Closing the input stream will trigger connection release
                    instream.close();
                }
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

        } catch (JSONException e) {
            e.printStackTrace();
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
    } 
```

它从命令行完美运行，不要在哪里出错。任何帮助高度赞赏。

也让我知道我是否可以在不使用任何用 C 编写的库（Libcurl 等）的情况下做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T09:28:41.180

您已使用 stringEntity 发布数据。尝试使用 UrlEncodedFormEntity 发送数据。这里有一个例子如何做：

```
try {
    List<NameValuePair> nvps = new ArrayList<NameValuePair>();
    nvps.add(new BasicNameValuePair("loginId", username.toString()));
    nvps.add(new BasicNameValuePair("password", password.toString()));
    nvps.add(new BasicNameValuePair("_eventId_submit", "Submit"));

    HttpPost httppost = new HttpPost("url2");
    httppost.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));
    HttpParams params = httppost.getParams();
    HttpConnectionParams.setConnectionTimeout(params, 45000);
    HttpConnectionParams.setSoTimeout(params, 45000);

    // Perform the HTTP POST request
    HttpResponse response = client.execute(httppost);
    status = response.getStatusLine().toString();
    if (!status.contains("OK")) {
        throw new HttpException(status);
    }

    if (cookies.isEmpty()) {
        System.out.println("None");
    } else {
        for (int i = 0; i < cookies.size(); i++) {
            System.out.println("- " + cookies.get(i).toString());
            cookie = cookies.get(i);
        }
    }

} catch (UnsupportedEncodingException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (HttpException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (ClientProtocolException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

# range - 在 ContentEditable 中，如何获取对插入符号之前元素的引用？

> ID：14551134
> 
> 赞同：1
> 
> 时间：2013-01-27T19:12:58.047
> 
> 标签：range, element, contenteditable, caret, textnode

我正在尝试编写一个函数，该函数将在 上`keyup`为我提供对 contentEditable div 中插入符号之前的元素的引用。

如果插入符号在文本节点中，则该函数应返回`null`. 如果插入符号位于 contentEditable 的开头，则该函数应返回`null`。

但是，如果插入符号位于文本节点的开头，并且该文本节点之前紧跟一个元素（例如 Span），则该函数应返回对该元素的引用。

并且，如果插入符号放置在两个 Html 元素之间（例如，在两个 Span 之间），那么它应该返回对插入符号之前的元素的引用，即两个元素中的第一个。

如果有两个或多个文本节点紧接在一起，则应将它们视为单个文本节点。

我已经开始[拼凑一些东西了](http://jsfiddle.net/holf/JvagD/2/)。我正在考虑使用范围偏移来计算我在文本节点中的距离，但感觉过于复杂。我不禁想到有一些明显的事情我没有想到。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-04T11:45:59.767

这可以使用锚节点来完成。锚节点是光标所在的节点。我们可以使用 previousSibling 属性获取它之前的元素。这是我们如何做到的

```
 var selection
 if (window.getSelection)
  selection = window.getSelection();
 else if (document.selection && document.selection.type != "Control")
  selection = document.selection;

var anchor_node = selection.anchorNode; //current node on which cursor is positioned
var previous_node = anchor_node.previousSibling;
var next_node = anchor_node.nextSibling; 
```

previous_node.nodeName 对于 textnode 将是 '#text'，对于 span 节点将是 'span'。这对于 next_node 也是类似的。您现在可以使用这些和代码来满足您的要求。

# css - 以特定类的最终 DIV 为目标以使用 CSS 进行样式设置

> ID：14551136
> 
> 赞同：1
> 
> 时间：2013-01-27T19:13:21.570
> 
> 标签：css, css-selectors

我有一组由我无法修改的不同页面生成的预定项目。我想为列表中的第一个和最后一个项目设置样式。第一项是没有问题的，但是因为最后一项不是列表中的最后一个DIV，所以不知道怎么修改。删除最后一个描述 DIV，这也是这个 Fiddle [http://jsfiddle.net/CeJAS/](http://jsfiddle.net/CeJAS/)的第 15 行，实现了我想要的，但我无法修改真正的 HTML - 不幸的是，空的描述 DIV 是标记的一部分。这可以通过 CSS 实现吗？

```
<div class="list">
    <div class="title">
    <a href="#">Link</a>
    </div>
    <div class="description"> </div>

    <div class="title">
    <a href="#">Link</a>
    </div>
    <div class="description"> </div>

    <div class="title">
    <a href="#">Link</a>
    </div>
    <div class="description"> </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:01:59.423

在做了一些[谷歌搜索](http://www.w3.org/community/webed/wiki/CSS/Selectors/pseudo-classes/%3anth-last-child)后，我发现你可以使用`.list div:nth-last-child(2)`.

[IE 9 和到目前为止 10](http://www.quirksmode.org/css/contents.html#t37)也支持它。

# javascript - 如何在 HTML 或 Javascript 中制作任务栏？

> ID：14551140
> 
> 赞同：0
> 
> 时间：2013-01-27T19:13:47.330
> 
> 标签：javascript, html, web, taskbar

我目前正在制作一个在线操作系统，当然我想要一个任务栏。一个任务栏，有点像屏幕底部的 Windows 任务栏，就像它有一些应用程序一样，当您打开应用程序时，它会出现在任务栏上，当您最小化它时，它会最小化到任务栏，当您单击最小化的应用程序时在任务栏上，它会像以前一样重新出现。

我在互联网上到处搜索，似乎找不到任何有关此的信息。如何制作像 Windows 任务栏一样工作的任务栏？

任何信息和任何链接都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:20:23.360

jQuery绝对是要走的路。我开发了一个应用程序来实现这一点……但我认为这就是你所需要的：让你的生活更简单的[jQuery 任务栏插件。](http://wiki.jqueryui.com/w/page/12138086/Taskbar)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:26:44.663

[Twitter Bootstrap](http://twitter.github.com/bootstrap/index.html)有一个漂亮的（过度使用的）[导航栏](http://twitter.github.com/bootstrap/components.html#navbar)。

这可能不是您正在寻找的东西，或者对于您正在寻找的东西可能有点过头了，但在很多情况下，Bootstrap 是一个很好的创意起点。

# ajax - 子表ajax调用中的SelectOneRadio不起作用

> ID：14551145
> 
> 赞同：5
> 
> 时间：2013-01-27T19:14:14.327
> 
> 标签：ajax, jsf, jsf-2, primefaces

[我正在使用 primefaces 3.4.1，并且我正在尝试在子表](http://www.primefaces.org/showcase-labs/ui/datatableSubTable.jsf)中使用带有 ajax 调用的 SelectOneRadio， 但它不起作用，没有调用 ajax 侦听器

```
<p:dataTable id="competenciesTable" var="competency" value="#{evaluationControl.currentEvaluation.evaluatedCompetencies}">
                <f:facet name="header">
                    <h:outputText value="#{gchmsg['global.competencies']}" />
                </f:facet>
                <p:subTable id="descriptorsTable" var="descriptor" value="#{competency.evaluationDescriptors}">
                    <f:facet name="header">
                        <h:outputText class="strong" value="#{competency.competency.name}" />
                    </f:facet>
                    <p:column>#{descriptor.descriptor.description}</p:column>
                    <p:column>
                        <p:selectOneRadio required="true" styleClass="calification_scale" id="descriptorCalification" value="#{descriptor.calification}" converter="calification">  
                            <f:selectItems value="#{competency.competency.calificationSchema.scales}" var="scale" itemLabel="#{scale.qualitativeValue}" itemDescription="#{scale.description}" itemValue="#{scale}" />
                            <p:ajax process="@this" listener="#{evaluationControl.handleRadioChange}" update=":evaluationForm:finalResultText, descriptorCalificationMsg" />
                        </p:selectOneRadio> 
                        <p:message id="descriptorCalificationMsg" for="descriptorCalification" display="icon" />
                    </p:column>
                </p:subTable>
            </p:dataTable> 
```

evaluationControl 是一个 SessionBean，方法是

```
public void handleRadioChange() {
    log.debug("Listener called");
} 
```

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T13:03:31.057

经过太多的调试和测试，我终于找到了问题，primefaces Subtable 组件没有将值放回Backing Bean，您必须处理整个DataTable 组件，所以我不得不删除`required="true"`（以避免验证错误）每个 selectOneRadio 并添加`process="competenciesTable"`到`p:ajax`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-19T00:43:30.217

你可以试试，删除 process="@this"。它在我的情况下有效。我不确定为什么 p:subTable 会发生这种情况，因为我从来没有遇到过 p:dataTable 的这个问题。

# c# - WPF 图像控件源绑定

> ID：14551149
> 
> 赞同：2
> 
> 时间：2013-01-27T19:14:40.783
> 
> 标签：c#, wpf, image, binding, properties

我是 WPF 和 C# 的新手，我尝试实现以下功能，但经过多次尝试后失败了。谁能帮我吗？

我有一个图像控制：

```
<Image Grid.Row="1" x:Name="ImageEditor"  Stretch="Fill" StretchDirection="Both"/> 
```

我想将此图像控件的源绑定到另一个类的静态属性（`ImageHandler`）

```
class ImageHandler
{
    public static BitmapImage ImageToDisplay { get; set; }

    public ImageHandler(){}

    .... //other codes
} 
```

因此，每当我在课堂上做某事`ImageHandler`并更新`ImageToDisplay`属性时，我的图像控件都会显示新图像。

我尝试了几种方法，但都没有达到这个目标。以下显示了我失败的尝试之一。

```
<Window.Resources>
    <local:ImageHandler x:Key="ImageHandler"></local:ImageHandler>
</Window.Resources>

<Image Grid.Row="1" x:Name="ImageEditor" Stretch="Fill" StretchDirection="Both" 
    Source="{Binding Source={StaticResource ResourceKey=ImageHandler},
    Path=ImageToDisplay,Mode=TwoWay}">
</Image> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:24:16.160

您必须`INotifyPropertyChanged`在`ImageHandler`

对于依赖属性：

```
class ImageHandler : INotifyPropertyChanged
{
    private BitmapImage imageToDisplay;
    public BitmapImage ImageToDisplay
    {
        get { return imageToDisplay; }
        set
        {
            if (imageToDisplay != value)
            {
                imageToDisplay = value;
                OnPropertyChanged("ImageToDisplay");
            }
        }
    }

    public ImageHandler() { }

    // .... Other codes

    #region INotifyPropertyChanged implementation
    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(propertyName));
    }
    #endregion
} 
```

但是，要实现它，我必须删除该`static`属性。

# matlab - 将单元格（matlab）写入 CSV 文件

> ID：14551153
> 
> 赞同：9
> 
> 时间：2013-01-27T19:14:59.403
> 
> 标签：matlab, csv, cell

我怎样才能保存这个单元格

```
 data = cell([3 2]);
    data{1,1} = 'Bla';
    data{2,1} = 'Bla1';
    data{3,1} = 'Bla2';
    data{1,2} = '2';
    data{2,2} = '3';
    data{3,2} = '1' 
```

到 csv 文件？

我试过

```
dlmwrite('C:\Users\Ro\Desktop\Mestrado\Resultados\Tabelas\VaR_tab.csv',data,'delimiter',';') 
```

但它给出了这个错误信息：

```
Error using dlmwrite (line 118)
The input cell array cannot be converted to a matrix. 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-27T19:19:40.397

我刚试过这个，它奏效了：

```
filename = 'test';
cell2csv(filename,data) 
```

可`cell2csv`作为

```
function cell2csv(filename,cellArray,delimiter)
% Writes cell array content into a *.csv file.
% 
% CELL2CSV(filename,cellArray,delimiter)
%
% filename      = Name of the file to save. [ i.e. 'text.csv' ]
% cellarray    = Name of the Cell Array where the data is in
% delimiter = seperating sign, normally:',' (default)
%
% by Sylvain Fiedler, KA, 2004
% modified by Rob Kohr, Rutgers, 2005 - changed to english and fixed delimiter
if nargin<3
    delimiter = ',';
end

datei = fopen(filename,'w');
for z=1:size(cellArray,1)
    for s=1:size(cellArray,2)

        var = eval(['cellArray{z,s}']);

        if size(var,1) == 0
            var = '';
        end

        if isnumeric(var) == 1
            var = num2str(var);
        end

        fprintf(datei,var);

        if s ~= size(cellArray,2)
            fprintf(datei,[delimiter]);
        end
    end
    fprintf(datei,'\n');
end
fclose(datei); 
```

我复制了代码，因为我不知道该函数是否在 MathWorks File Exchange 上可用。但谷歌也应该有所帮助。

# opencv - 查找 HSV 值的最佳方法

> ID：14551154
> 
> 赞同：3
> 
> 时间：2013-01-27T19:15:00.083
> 
> 标签：opencv, hsv

我将在下图中应用 HSV 阈值以提取网球。但我想不出找到球正确 HSV 值的最佳方法。您建议我使用哪种方法/软件？（我使用的是 Ubuntu）另外，根据您的经验，您更喜欢哪个最小/最大值？（±10？±5？）

问候

![图片](../Images/07de52c38c709b91a588c3b8267ad380.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T21:00:33.173

您可以使用[Gimp](http://www.gimp.org/)来获得所需的颜色。该工具称为[颜色选择器](http://docs.gimp.org/en/gimp-tool-color-picker.html)。它还显示 HSV 值。这是您的图像的屏幕截图：

![在此处输入图像描述](../Images/36d72b9e7bbef3d6d00f0af49eb318bf.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:26:44.120

您是否考虑过使用[`Hough Circle`^(Doc)](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/hough_circle/hough_circle.html)？

我认为在这种情况下，它会受到更多的指控，因为您图像中的颜色不是那么清晰

# c# - c#，实体框架：更新/删除孩子的最佳方法是什么？

> ID：14551155
> 
> 赞同：0
> 
> 时间：2013-01-27T19:15:14.070
> 
> 标签：c#, entity-framework, concurrency

我有表 A 和表 B：

```
TableA(IDTableA,...) TableB(IDTableB, IDTableA,...) 
```

我知道如果我在数据库上设置它，我可以在级联上删除，但如果我没有在数据库中定义它并且我想用 EF 删除孩子，这是最好的方法吗？

想象一下这种情况：用户 A 将父级添加到上下文中，用户 A 将子级添加到上下文中，将父级和子级标记为已删除并保存更改。但是，如果用户 B 在用户 A 加载子项并确认更改之间添加了一个新子项，则不会删除用户 B 添加的新子项，或者由于引用完整性而出现异常。

我尝试使用事务，将父级设置为已删除，然后，在下一步中，当我创建时`savechanges`，父级寄存器被锁定，因此其他用户无法加载。但问题是一样的，其他用户可以在父级之间进行更改，即加载和保存更改。

所以我的问题是，如果我想用 EF 删除父级及其所有子级，最好的方法是什么？最好的方法是尝试N次删除父项？当我有良好的表现时，这是一个不错的选择吗？

谢谢。戴姆洛克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:23:59.653

你已经回答了你自己的问题。使用级联删除。您可以先使用 EF 代码启用它们，请参阅[如何确保首先在 EF 代码中的表关系上启用级联删除？](https://stackoverflow.com/questions/5471374/how-do-you-ensure-cascade-delete-is-enabled-on-a-table-relationship-in-ef-code-f)，或通过将关系标记为级联来使用设计器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T12:22:12.247

在这种特殊情况下，我认为最好的方法是使用触发器来删除孩子。

# python - python：对浮点数进行制表时仅显示两位小数

> ID：14551165
> 
> 赞同：0
> 
> 时间：2013-01-27T19:15:57.680
> 
> 标签：python, floating-point, rounding

我编写了一个代码来解析一些文本文档并显示一些单词出现的频率。

输出如下：

```
Counting words by tag
---------------------

modals
per 1000 words                    can  could  shall should   will  would
austen-emma.txt                1.480000 4.350000 1.100000 1.920000 2.900000 4.260000
austen-persuasion.txt          1.090000 4.590000 0.560000 1.920000 1.650000 3.620000
austen-sense.txt               1.500000 4.060000 0.870000 1.640000 2.500000 3.600000
chesterton-ball.txt            1.460000 1.210000 0.510000 0.770000 2.040000 1.440000
chesterton-brown.txt           1.500000 1.990000 0.350000 0.650000 1.290000 1.570000
chesterton-thursday.txt        1.760000 2.180000 0.710000 0.780000 1.570000 1.730000 
```

如您所见，数字四舍五入到百分之一，但我的程序仍然打印了一些过多的零。

这取决于表格，即以下代码行：

```
 cell = round(float(cfdist[fileid][w])*1000/number_of_words[fileid],2)
     print '%6f' % (cell), 
```

有人能帮我改进行打印 '%6f' % (cell)，这样它就不会显示结尾的零了吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:25:01.767

请参阅[Python 字符串格式化](http://docs.python.org/2/library/stdtypes.html#string-formatting)文档。“%6f”是你的问题。相反，尝试

```
print "%.2f" % cell 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-30T07:36:02.880

数字 = 12.3456

new_val = '%.2f' % float(num)

打印浮点数（new_val）

12.34

# c# - 如何在 Visual Studio 2012 基于 C# Windows 的应用程序中添加图表

> ID：14551170
> 
> 赞同：1
> 
> 时间：2013-01-27T19:16:28.857
> 
> 标签：c#, visual-studio-2010

嗨，我是 Visual Studio .net 的新手，我正在开发一个能耗计算器项目，其中我在 xy 图表中绘制了两个年度能源成本，如 energycost1 和 energycost2 。
我将图表从工具箱拖到窗口窗体中，我想在此图表上显示这两个能源成本。我什么都不想显示，`x-axis`但`y-axis`我想显示这样的能量值`200k , 400k , 600k , 800k 1M`。
谁能帮我为我创建这个图表我不知道如何在图表上绘制这两个值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T23:30:10.963

您可以使用已创建图表的轴属性（我们称之为 chData）。

```
chData.Titles.Add("Voltage Data");
chData.ChartAreas[0].AxisX.Title = "Readings";
chData.ChartAreas[0].AxisY.Title = "Voltage (V)"; 
```

或者您可以添加辅助轴：

```
chData.ChartAreas[0].AxisY2.Title = "Current (A)"; 
```

您可以使用大量属性，只需查看 Axis 库以获取完整列表。其中有间隔的属性，手动添加刻度标题等。

要添加单个系列，请使用以下代码：

```
chData.Series.Add("Battery 1"); 
```

然后你可以像这样向它添加数据点：

```
 for (int i = 0; i < dataSize - 1; i++)
 {
     chData.Series[0].Points.Add(array[i]);
 } 
```

其中 array[] 是包含您要在其中显示的数据的数组。您可以从 Series 下的属性窗口更改图表的视觉类型和大多数其他属性。

# javascript - 如何与嵌入式谷歌日历交互？

> ID：14551171
> 
> 赞同：0
> 
> 时间：2013-01-27T19:16:36.513
> 
> 标签：javascript, jquery, iframe, calendar, same-origin-policy

我已将 Google 日历嵌入 HTML 页面。它里面有大量的日历，所以，为了让它更好，我希望所有的日历都默认关闭。

由于同源政策，jQuery 似乎[在这里无能为力。](https://stackoverflow.com/questions/364952/jquery-javascript-accessing-contents-of-an-iframe)

是否有一个简单直接的“让它工作”的解决方案？

**编辑：在**[上面提到](https://stackoverflow.com/questions/364952/jquery-javascript-accessing-contents-of-an-iframe)的问题中，有一个词是关于使用本地代理来完成这项任务的。它是什么以及如何做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:29:09.877

我认为您最好的解决方案是拉入日历提要并自己展示日历。

同源政策总是会咬你。jQuery 只是 JavaScript。这不是魔法，如果它不能访问某些东西，你编写的任何其他客户端脚本也不会。

代理像谷歌日历这样复杂的东西不是一个好主意。即使你得到它的工作，他们可能会在未来改变它。

拉入他们的 XML 是微不足道的。您可以在获得共享日历的 HTML 的同一面板上找到该 URL。然后，您可以加载所有这些服务器端并将它们显示在您的页面上，但您希望如此。

# yii - yii rbac：检查组而不是用户的授权

> ID：14551173
> 
> 赞同：0
> 
> 时间：2013-01-27T19:16:46.580
> 
> 标签：yii, rbac

我有一个关于 rbac 系统的问题。我想我已经很好地理解了它，但我需要有关特殊情况的更多信息。

我想对组而不是用户进行自动化。我的意思是，例如“HR”组有权创建一个人。那么任何加入这个小组的人都会拥有它。

让我给你更多的信息。

**我的数据库的一部分：** ![在此处输入图像描述](../Images/5c341711c4d09548e5c29b4b3880bb89.png)

**这是我的组层次结构的一部分：** ![在此处输入图像描述](../Images/59b34adcfd2551ffad8c249519274c94.png)

所以我正在寻找的，这将是必须的，是一个每个组都有一些授权的系统。人们得到他们的组和他们父母组的授权（例如“Forsys”中的人有“Forsys”、“R&D”和“管理”的授权）。

我目前看到的解决方案是使用**bizrule**。但我不确定在数据库中编写 php 代码是一个好主意，然后如果我更新组层次结构（R&D 继承 RH 而不是管理），我将不得不修改数据库中的 bizrule。我试过了，效果很好，但是你可以看到它需要很多代码。

```
$user = User::model()->with("people","people.groups")->findByPk(Yii::app()->user->id);
foreach($user->people[0]->groups as $group)
  if($group->id == 2)
     return true;
return false; 
```

**仅用于查看用户是否在组中（不检查父组和层次结构）**

另一种可能性是创建一个新表“group_auth”，例如：

-Group_2 具有角色“managePerson”

-Group_3 有操作“deleteUser”...

然后每次在组中添加或删除用户时，我们都会在 auth_assigment 表中更新他的授权。

我想听听关于这个主题的其他意见。所有评论将不胜感激:)

感谢您的阅读，如果您在理解我时遇到困难，请原谅我的英语。

迈克尔·S。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:03:51.940

用户是否曾经获得过自己的授权项目？如果不是，似乎您实际上可以换出 auth_assignment 中的 userid 列并将其命名/将其视为 groupID 。这样您就不必担心使用户身份验证分配与您的组角色保持同步。

您可能需要在几个地方进行一些更改： - 默认情况下，CWebUser 会传入已登录的用户 ID，以便在 bizrules 中使用。使用您自己的覆盖来更改我们的更改可能会很好，该覆盖改为传入 groupId/groupIds。- 您需要覆盖 CDbAuthManager 并重新修改那里的一些工作方式

我们在我从事的一个项目中做了类似的事情（我们正在处理多租户 RBAC 自定义权限），这需要自定义 CDbAuthManager 覆盖。如果你这样做会有点棘手，但你可以使用大量的力量。

**编辑：** 了解您的用户有时需要额外的授权。如果您的组有一个“角色”字段，其中序列化了不同的角色（或者为该组存储多个角色的其他方法，也可能是一种关系）。

然后，在用户登录时（为了提高效率），您会将这些角色存储在会话中。处理事情的最简单方法可能是为您的 WebUser 覆盖编写自定义 checkAccess： [https ://github.com/yiisoft/yii/blob/1.1.13/framework/web/auth/CWebUser.php#L801](https://github.com/yiisoft/yii/blob/1.1.13/framework/web/auth/CWebUser.php#L801)

因为这将使您的自定义检查变得更简单。然后我可能会做类似的事情：

```
if(Yii::app()->user->hasGroupAccess() || Yii::app()->user->checkAccess('operation/task/role')) {
    ....
} 
```

在您的 WebUser`hasGroupAccess`方法中，您可以遍历所有组角色并将其发送到 checkAccess。

认为这会奏效吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T12:42:57.287

当组在另一个表中或应用程序中的其他位置时，我使用它来检查组的访问权限，我默认为用户赋予角色。通过使用这个：

```
return array(
    'components'=>array(
        'authManager'=>array(
            'class'=>'CDbAuthManager',
            'defaultRoles'=>array('authenticated', 'R&D', 'Administration'),
        ),
    ),
); 
```

[下：使用默认角色](http://www.yiiframework.com/doc/guide/1.1/en/topics.auth#Using-Default-Roles)

通过使用它，每个用户都可以获得这些分配。现在，我创建一个`business rule`以确保`checkAccess('group')`将返回正确的值。

例如，在您的情况下，`business rule`for`R&D`将是：

```
return (
    count(
        Person::model()->findByPk(Yii::app()->user->id)->groups(array('name'=>'R&D'))
    ) > 0
) ? true : false; 
```

所以它的作用是：

*   `find the logged-in person by primary key`
*   `look into groups (from the user) for the group with name R&D`
*   `if there is a group: return true (else return false)`

# python - celery vs pyro：Pyro 是 Celery 的替代品吗？

> ID：14551178
> 
> 赞同：11
> 
> 时间：2013-01-27T19:17:00.650
> 
> 标签：python, celery, pyro

我正在尝试了解 Celery 并且想知道 Celery 和 Pyro 是否正在尝试实现相同的目标？

有人可以告诉我，Celery 可以做什么，而 Pyro 不能，反之亦然？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-27T20:01:03.463

正如我在官方网站上看到的，[Celery](http://celeryproject.org/)和[Pyro](http://pypi.python.org/pypi/Pyro4)打算做不同的工作，但混淆是很自然的。

这两个软件包的目标是帮助您进行分布式计算，但采用不同的方法：**Celery**旨在成为分布式任务调度程序，这意味着，如果您有一堆任务（非常不相关），您可以将它们分布在计算机网格上或通过网络。

虽然，**Pyro**旨在通过网络在对象之间建立一个通信网关，这意味着，如果你有一个相当大的任务，你不能分成一些不相关的小任务，而是有一堆独立但通常需要的对象有关其他人的信息，然后 Pyro 启用它们之间的通信，因此您可以执行在计算机网格中或通过网络分发对象的任务。

您使用 Django 标记发布此内容，因此您可以说，对 Web 应用程序执行的请求可以被视为一堆（随着并发性增加而增加的一大堆）不相关的任务，因此**Celery**可能成为你正在寻找的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-17T17:36:53.997

上面的答案解释了 Pyro 和 Celery 之间的区别。

但鉴于多年来 Python 发生的所有其他变化以及 Python ZeroMQ 库和函数选择的可用性，可能值得看看利用 ZeroMQ 和 PiCloud 的函数酸洗。这创造了一种全新的方式来构建分布式堆栈。

[请参阅jeffknupp.com 博客上的](https://jeffknupp.com/blog/2014/02/11/a-celerylike-python-task-queue-in-55-lines-of-code/)链接示例代码

是的，当然你可以坚持使用 Celery 来开发分布式任务工作者。使用 Pyro，您可以开发远程过程调用应用程序。使用 Celery 和 Pyro，您可以在 Python 世界中完成所有这些工作，而使用 ZeroMQ，它们有十几种不同语言的实现，并且它实现了网络的常见模式，如 PUB-SUB、REQ-RES、PIPES 等。这就打开了创造语言不可知的可能性的可能性。

# javascript - 如何在javascript中删除最后一个匹配的正则表达式模式

> ID：14551179
> 
> 赞同：1
> 
> 时间：2013-01-27T19:17:01.607
> 
> 标签：javascript, regex

我有一个这样的文字......

```
var string = '~a=123~b=234~c=345~b=456' 
```

我需要提取字符串，使其拆分为

```
['~a=123~b=234~c=345',''] 
```

也就是说，我需要用`/b=.*/`模式拆分字符串，但它应该与最后找到的模式匹配。如何使用 RegEx 实现这一目标？

**注意：**等号后面的数字是随机生成的。

**编辑：**

以上只是一个例子。我猜我没有把问题说清楚。广义字符串是...

```
<word1>=<random_alphanumeric_word>~<word2>=<random_alphanumeric_word>..~..~..<word2>=<random_alphanumeric_word> 
```

都有随机长度，所有单词*i*都是字母，整个字符串长度不固定。唯一已知的文本是`<word2>`. 因此我需要 RegEx 和模式`/<word2>=.*/`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-20T05:20:12.453

```
(?=.*(~b=[^~]*))\1 
```

将在一场比赛中完成，但如果有重复的条目，它将转到第一个。性能也不是很好，如果你 string.replace 它将破坏所有重复项。它会通过您的示例，但针对 '~a=123~b=234~c=345~b=234' 它会转到第一个 'b=234'。

```
.*(~b=[^~]*) 
```

将运行得更快，但它需要另一个步骤，因为匹配出现在一个组中：

```
var re = /.*(~b=[^~]*)/.exec(string);
var result = re[1]; //~b=234
var array = string.split(re[1]); 
```

此方法也将具有完全相同的重复项。另一种选择是：

```
var regex = /.*(~b=[^~]*)/g;
var re = regex.exec(string);
var result = re[1];
// if you want an array from either side of the string:
var array = [string.slice(0, regex.lastIndex - re[1].length - 1), string.slice(regex.lastIndex, string.length)]; 
```

这实际上找到了最后一个匹配的确切位置，并删除了`regex.lastIndex - re[1].length - 1`我的猜测是索引从前导侧删除省略号，但我没有测试它，所以它可能会偏离 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:36:24.693

假设格式为 ( `~`、字母数字名称、`=`和数字) 重复任意次数。这里最重要的假设是`~`每个名称-值对出现一次，并且它不会出现在名称中。

您可以通过简单的替换来删除最后一个令牌：

```
str.replace(/(.*)~.*/, '$1') 
```

这通过使用 greedy 属性`*`来强制它匹配`~`输入中的最后一个。

这也可以通过 来实现`lastIndexOf`，因为您只需要知道最后一个的索引`~`：

```
str.substring(0, (str.lastIndexOf('~') + 1 || str.length() + 1) - 1) 
```

（嗯，我不知道上面的代码是不是好的JS......我宁愿写几行。上面只是为了展示单行解决方案）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:36:48.527

我不认为我会亲自使用正则表达式来解决此类问题，但您可以使用这样的正则表达式提取最后一个选项对：

```
var str = '~a=123~b=234~c=345~b=456';
var matches = str.match(/^(.*)~([^=]+=[^=]+)$/);

// matches[1] = "~a=123~b=234~c=345"
// matches[2] = "b=456" 
```

演示：http: [//jsfiddle.net/jfriend00/SGMRC/](http://jsfiddle.net/jfriend00/SGMRC/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T19:24:52.727

考虑到您要提取特定部分，这听起来不像是正则表达式的工作。相反，您可以只使用`lastIndexOf`将字符串一分为二：

```
var lio = str.lastIndexOf('b=');

var arr = [];
var arr[0] = str.substr(0, lio);
var arr[1] = str.substr(lio); 
```

[http://jsfiddle.net/NJn6j/](http://jsfiddle.net/NJn6j/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T19:30:17.597

将给出您可以使用的结果的正则表达式是：

```
string.match(/[a-z]*?=(.*?((?=~)|$))/gi);
// ["a=123", "b=234", "c=345", "b=456"] 
```

但在您的情况下，最简单的解决方案是在提取内容之前拆分字符串：

```
var results = string.split('~'); // ["", "a=123", "b=234", "c=345", "b=456"] 
```

现在将很容易提取键和结果以添加到对象：

```
var myObj = {};
results.forEach(function (item) { 
    if(item) { 
        var r = item.split('='); 
        if (!myObj[r[0]]) {
            myObj[r[0]] = [r[1]]; 
        } else {
            myObj[r[0]].push(r[1]); 
        }
    } 
});
console.log(myObj); 
```

目的：

*   一个：[“123”]
*   b: ["234", "456"]
*   c: [“345”]

# qt - QImage OpenCV - setPixel 只有绿色和黑色

> ID：14551184
> 
> 赞同：0
> 
> 时间：2013-01-27T19:17:38.067
> 
> 标签：qt, opencv, qimage

我使用 Qt 制作了一个简单的图形用户界面，并使用 OpenCV 对网络摄像头流进行处理，即精明的边缘检测。

我尝试在网络摄像头的两个显示器之间实现切换：

1*）“正常模式”：网络摄像头提供灰度颜色边界检测视频的灰度显示

2*）“greenMode”：绿色和黑色显示，其中网络摄像头提供相同的“检测到的边框”，但具有绿色和黑色。

第一个作品（带有灰度）作品。结果如下：

![在此处输入图像描述](../Images/9bb0301432b51517f37053eb2cd9c072.png)

现在我遇到了第二个问题。这是我找不到解决方案的代码部分：

```
 // Init capture
  capture = cvCaptureFromCAM(0);
  first_image = cvQueryFrame( capture );
  // Init current qimage
  current_qimage = QImage(QSize(first_image->width,first_image->height),QImage::Format_RGB32);

  IplImage* frame = cvQueryFrame(capture);
  int w = frame->width;
  int h = frame->height;

  if (greenMode) // greenMode : black and green result
  {
    current_image = cvCreateImage(cvGetSize(frame),8,3); 
    cvCvtColor(frame,current_image,CV_BGR2RGB);

    for(int j = 0; j < h; j++)
    {  
      for(int i = 0; i < w; i++)
      {
        current_qimage.setPixel(i,j,qRgb(current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1]));
      }
    }
  }
  else // normal Mode : grayscale result WHICH WORKS
  {
    current_image = cvCreateImage(cvGetSize(frame),8,1); 
    cvCvtColor(frame,current_image,CV_BGR2GRAY);

    for(int j = 0; j < h; j++)
    {  
      for(int i = 0; i < w; i++)
      {
        current_qimage.setPixel(i,j,qRgb(current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1]));

      }
    }
  }
  gaussianfilter(webcam_off);
  border_detect(webcam_off);
  cvReleaseImage(&current_image);
  repaint(); 
```

“greenMode”似乎没有用这个“ `setPixel`”放置好的像素（我取中间的rgb值：） `current_image->imageData[i+j*w+1]`：

```
current_image = cvCreateImage(cvGetSize(frame),8,3); 
    cvCvtColor(frame,current_image,CV_BGR2RGB);

    for(int j = 0; j < h; j++)
    {  
      for(int i = 0; i < w; i++)
      {
        current_qimage.setPixel(i,j,qRgb(current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1]));
      }
    } 
```

这是我得到的：

![在此处输入图像描述](../Images/2ae5c7643ed6971812124baeaeed6b47.png)

首先，输出不是绿色和黑色，其次，与灰度图像相比，它是缩放的。

你能有任何线索来获得 greenMode 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:59:45.833

```
qRgb(current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1],current_image->imageData[i+j*w+1]) 
```

您对所有三个 RGB 颜色分量使用相同的值。R == G == B 总是会导致灰色。

要将 RGB 值转换为绿色/黑色，您可以例如转换为灰度（使用亮度方法），然后将其着色为绿色：

```
const int v = qRound(  0.21 * pixel.red() + 0.71 * pixel.green() + 0.07 * pixel.blue() );
setPixel( i, j, qRgb( v, 0, 0 ) ); 
```

（可能有更复杂的着色方法）。

对于缩放，我假设在计算 current_image 的索引时会发生错误。您对两个图像使用相同的 (i+j*w+1)，但灰色有 1 个通道和第二个 3（第三个 cvCreateImage 参数）。所以后者每个像素会有两个更多的值。

# c - C位掩码AND操作问题

> ID：14551189
> 
> 赞同：2
> 
> 时间：2013-01-27T19:18:38.183
> 
> 标签：c

我是 C 新手，我无法理解位掩码操作的用法。例如我有以下代码

```
if((input & 0x08)== 0)
{

 //Do....//

} 
```

我将输入作为 int 值 00000111 ，它是二进制和十六进制的 7 ，但是当我进行此比较时，它的评估结果为 false （从不输入 if 语句）。

这是我的理解和应该发生的事情

```
 00000111  input
        & 00001000  0x08
         ------------
          00000000  answer 
```

所以我的问题是我怎样才能得到正确的输出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:23:48.377

```
int main(){
        int input = 7;

        if((input & 0x08)== 0)
        {
                printf("Hello!\n");
        }

        return 0;
} 
```

你是对的，这个程序打印“你好！”。

您的代码中一定还有另一个问题。始终尝试创建函数并测试最简单的示例。

尝试打印语句`input`之前的值。`if`

希望能帮助到你。

# arrays - 如何使用标签规划剧院

> ID：14551191
> 
> 赞同：0
> 
> 时间：2013-01-27T19:18:48.330
> 
> 标签：arrays, vb.net, labels

对于一个学校项目，我们必须开发一个剧院预订系统，该系统带有剧院的图形表示，它以一种非常烦人的方式标记。我们的导师说我们应该用一个二维标签数组来表示剧院，但是引用每个标签来改变颜色是很棘手的，比如如果用户预订了 10,10 的座位，那么数组中就不会是 10,10。

有谁知道解决这个问题的好方法？因为我被难住了。

这是座位计划的链接：http: [//i.stack.imgur.com/U14ut.png](http://i.stack.imgur.com/U14ut.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:16:00.127

除了二维标签数组之外，您还可以使用两个相同大小的二维数组，一个用于行字母，一个用于标签数组表示的每个座位的编号。

例如，`labels(4, 7)`座位号可能是`seatNumbers(4,7)`，行字母可能是`rowLetters(4,7)`。

如果您知道如何（或可以弄清楚），您可以使用类或结构的一个二维数组，其中每个成员包含两个值，可能还有预订信息等。在这种情况下，您可以使用类似的方式处理座位信息`seats(4,7).rowLetter`, `seats(4,7).seatNumber`, 和`seats(4,7).reserved`. 您还可以参考`seats`班级中的座位标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:05:09.840

我建议您为每一行使用一组标签。例如，对于 A 行，创建以`lblRowA`索引 1 到 14 命名的标签，并为其他行重复（每行都有一个数组）。这应该可以很容易地将请求映射到现实世界的座位上。

# http - HTTP POST 请求中如何发送参数？

> ID：14551194
> 
> 赞同：1641
> 
> 时间：2013-01-27T19:19:07.627
> 
> 标签：http, post, parameters, request, uri

在 HTTP **GET**请求中，参数作为***查询字符串***发送：

```
http://example.com/page *?parameter=value&also=another*
```

在 HTTP **POST**请求中，参数不与 URI 一起发送。

***价值观在哪里？***在请求标头中？在请求正文中？它是什么样子的？

* * *

## 回答 #1

> 赞同：1382
> 
> 时间：2013-01-27T19:32:10.950

这些值以内容类型指定的格式在请求正文中发送。

通常内容类型是`application/x-www-form-urlencoded`，因此请求正文使用与查询字符串相同的格式：

```
parameter=value&also=another 
```

当您在表单中使用文件上传时，您使用的是`multipart/form-data`编码，它具有不同的格式。它更复杂，但您通常不需要关心它的外观，所以我不会展示示例，但知道它存在会很好。

* * *

## 回答 #2

> 赞同：452
> 
> 时间：2013-01-27T19:21:26.210

内容放在 HTTP 标头之后。HTTP POST 的格式是具有 HTTP 标头，后跟一个空行，然后是请求正文。POST 变量作为键值对存储在正文中。

您可以在 HTTP Post 的原始内容中看到这一点，如下所示：

```
POST /path/script.cgi HTTP/1.0
From: frog@jmarshall.com
User-Agent: HTTPTool/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 32

home=Cosby&favorite+flavor=flies 
```

[您可以使用Fiddler](http://www.fiddler2.com)之类的工具来查看这一点，您可以使用它来观察通过网络发送的原始 HTTP 请求和响应负载。

* * *

## 回答 #3

> 赞同：439
> 
> 时间：2014-11-03T15:54:48.490

**简短的回答：**在 POST 请求中，值在请求的“正文”中发送。对于网络表单，它们最有可能使用`application/x-www-form-urlencoded`或的媒体类型发送`multipart/form-data`。设计用于处理网络请求的编程语言或框架通常对此类请求执行“The Right Thing™”，并为您提供对易于解码的值的轻松访问（如PHP 中的 或 ，或`$_REQUEST`Python中的 ）。`$_POST``cgi.FieldStorage()``flask.request.form`

* * *

现在让我们离题一点，这可能有助于理解其中的区别；）

`GET`和请求之间的区别`POST`主要是语义上的。它们也以不同的方式“使用”，这解释了值传递方式的差异。

# GET（[相关的 RFC 部分](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.1)）

执行`GET`请求时，您向服务器请求一个或一组实体。为了允许客户端过滤结果，它可以使用 URL 的所谓“查询字符串”。查询字符串是`?`. 这是[URI 语法](https://www.rfc-editor.org/rfc/rfc3986#section-3)的一部分。

*因此，从您的应用程序代码（接收*请求的部分）的角度来看，您将需要检查 URI 查询部分以访问这些值。

请注意，键和值是 URI 的一部分。浏览器*可能*会对 URI 长度施加限制。HTTP 标准声明没有限制。但在撰写本文时，大多数浏览器*确实*限制了 URI（我没有具体的值）。`GET`请求*永远不*应该用于向服务器提交新信息。特别是不是更大的文件。那是你应该使用`POST`or的地方`PUT`。

# POST（[相关的 RFC 部分](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.3)）

执行`POST`请求时，客户端实际上是在向远程主机提交一个新*文档。*因此，*查询*字符串（在语义上）没有意义。这就是为什么您无法在应用程序代码中访问它们的原因。

`POST`有点复杂（而且更*灵活*）：

接收 POST 请求时，您应该始终期待“有效负载”，或者用 HTTP 术语来说：[消息正文](https://www.rfc-editor.org/rfc/rfc7230#section-3.3)。消息体本身没什么用，因为没有*标准*（据我所知。也许是应用程序/八位字节流？）格式。正文格式由`Content-Type`标头定义。当使用带有 的 HTML`FORM`元素时`method="POST"`，通常是`application/x-www-form-urlencoded`. 如果您使用文件上传，另一种非常常见的类型是[multipart/form-data 。](https://www.rfc-editor.org/rfc/rfc2388)但它可以是*任何东西*，范围从`text/plain`、超过`application/json`甚至是一种习惯`application/octet-stream`。

在任何情况下，如果使用应用程序无法处理的`POST`请求，它应该返回一个[status-code](https://www.rfc-editor.org/rfc/rfc7231#section-6.5.13)。`Content-Type`[`415`](https://www.rfc-editor.org/rfc/rfc7231#section-6.5.13)

大多数编程语言（和/或网络框架）都提供了一种将消息体从/编码到最常见类型（如`application/x-www-form-urlencoded`，`multipart/form-data`或`application/json`）的方法。所以这很容易。自定义类型可能需要更多的工作。

以标准 HTML 表单编码文档为例，应用程序应执行以下步骤：

1.  阅读`Content-Type`领域
2.  如果该值不是受支持的媒体类型之一，则返回带有`415`状态代码的响应
3.  否则，解码消息正文中的值。

同样，PHP 之类的语言或其他流行语言的网络框架可能会为您处理这个问题。例外是`415`错误。没有框架可以预测您的应用程序选择支持和/或不支持哪些内容类型。这取决于你。

# PUT（[相关的 RFC 部分](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.4)）

请求的处理方式几乎与请求`PUT`完全相同`POST`。最大的区别是`POST`请求应该让服务器决定如何（如果有的话）创建一个新资源。从历史上看（从现在已经过时的 RFC2616 开始，它是创建一个新资源作为请求发送到的 URI 的“下级”（子级））。

相比之下，`PUT`请求应该将资源准确地“存放”*在*该 URI 上，并*准确地*包含该内容。不多也不少。这个想法是*客户*负责在“PUT”之前制作*完整的资源。*服务器应该在给定的 URL 上按*原样接受它。*

因此，`POST`通常不使用请求来*替换*现有资源。一个`PUT`请求既可以创建*也*可以替换。

# 边注

还有一些“[路径参数](https://www.rfc-editor.org/rfc/rfc3986#section-3.3)”可以用来向远程发送额外的数据，但是它们太少见了，这里我就不多说了。但是，作为参考，这里是 RFC 的摘录：

> 除了层次路径中的点段之外，路径段被通用语法认为是不透明的。生成 URI 的应用程序通常使用段中允许的保留字符来分隔特定于方案或特定于解引用处理程序的子组件。例如，分号 (";") 和等号 ("=") 保留字符通常用于分隔适用于该段的参数和参数值。逗号 (",") 保留字符通常用于类似目的。例如，一个 URI 生产者可能使用诸如“name;v=1.1”之类的段来指示对“name”的 1.1 版本的引用，而另一个 URI 生产者可能使用诸如“name,1.1”之类的段来指示相同。参数类型可以由特定于方案的语义定义，

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2013-01-27T19:29:32.383

您不能直接在浏览器 URL 栏上键入它。

例如，您可以看到 POST 数据如何通过[Live HTTP Headers](https://addons.mozilla.org/es/firefox/addon/live-http-headers/)在 Internet 上发送。结果将是这样的

```
http://127.0.0.1/pass.php
POST /pass.php HTTP/1.1

Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Referer: http://127.0.0.1/pass.php
Cookie: passx=87e8af376bc9d9bfec2c7c0193e6af70; PHPSESSID=l9hk7mfh0ppqecg8gialak6gt5
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
username=zurfyx&pass=password 
```

它说的地方

```
Content-Length: 30
    username=zurfyx&pass=password 
```

将是帖子值。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2014-06-16T05:33:30.147

POST 请求中的默认媒体类型是`application/x-www-form-urlencoded`. 这是一种编码键值对的格式。密钥可以重复。每个键值对由一个`&`字符分隔，每个键与其值由一个`=`字符分隔。

例如：

```
Name: John Smith
Grade: 19 
```

被编码为：

```
Name=John+Smith&Grade=19 
```

这放置在 HTTP 标头之后的请求正文中。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2013-01-27T19:20:19.700

HTTP POST 中的表单值在请求正文中发送，格式与查询字符串相同。

有关详细信息，请参阅[规范](http://www.w3.org/TR/html401/interact/forms.html#h-17.13)。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2015-07-31T14:01:37.767

某些 Web 服务要求您分别放置请求*数据*和*元数据*。例如，远程函数可能期望已签名的元数据字符串包含在 URI 中，而数据则发布在 HTTP 正文中。

POST 请求在语义上可能如下所示：

```
POST /?AuthId=YOURKEY&Action=WebServiceAction&Signature=rcLXfkPldrYm04 HTTP/1.1
Content-Type: text/tab-separated-values; charset=iso-8859-1
Content-Length: []
Host: webservices.domain.com
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: identity
User-Agent: Mozilla/3.0 (compatible; Indy Library)

name    id
John    G12N
Sarah   J87M
Bob     N33Y 
```

这种方法在逻辑上使用一个单一的 QueryString 和 Body-Post 组合，`Content-Type`这是一个 Web 服务器的“解析指令”。

**请注意：** HTTP/1.1的*左侧*是`#32`（空格），右侧是`#10`（换行符）。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2018-07-19T07:04:18.180

首先，让我们区分`GET`和`POST`

**Get：**它是向服务器发出的默认`HTTP`请求，用于从服务器检索数据，`?`a 后面的查询字符串`URI`用于检索唯一资源。

这是格式

```
GET /someweb.asp?data=value HTTP/1.0 
```

这`data=value`是传递的查询字符串值。

**POST：**它用于安全地向服务器发送数据，所以需要任何东西，这是`POST`请求的格式

```
POST /somweb.aspHTTP/1.0
Host: localhost
Content-Type: application/x-www-form-urlencoded //you can put any format here
Content-Length: 11 //it depends
Name= somename 
```

**为什么要通过 GET 发布？**

在`GET`发送到服务器的值中，通常会附加到查询字符串中的基本 URL，现在有 2 个后果

*   请求与`GET`参数一起保存在浏览器历史记录中。因此，您的密码在浏览器历史记录中保持未加密状态。这对当时的 Facebook 来说是一个真正的问题。
*   通常，服务器对 a 的长度有限制`URI`。如果发送的参数太多，您可能会收到`414 Error - URI too long`

在发布请求的情况下，您将字段中的数据添加到正文中。计算请求参数的长度，并将其添加到 content-length 的 header 中，并且没有重要数据直接附加到 URL。

您可以使用 Google Developer Tools 的网络部分来查看有关如何向服务器发出请求的基本信息。

而且你总是可以在你`Request Headers`喜欢`Cache-Control`的 , `Origin`,中添加更多的值`Accept`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-06T20:21:58.127

post参数有多种方式/格式

*   表单数据
*   原始数据
*   json
*   编码数据
*   文件
*   xml

它们由表示为 mime 类型的 Header 中的内容类型控制。

# c - 在两者之间跳过一些 scanf

> ID：14551196
> 
> 赞同：0
> 
> 时间：2013-01-27T19:19:22.050
> 
> 标签：c, char, scanf

在这个程序中第二次和第四次scanf都被跳过了，不知道是什么原因。有人可以告诉原因吗？

```
#include<stdio.h>
main()
{
 int age;
  char sex,status,city;
   printf("Enter the persons age \n");
   scanf("\n%d",&age);
   printf("enter the gender\n");
   scanf("%c",&sex);
   printf("enter the health status");
   scanf("%c",&status);
   printf("where the person stay city or village");
   scanf("%c",&city);
   if(((age>25)&&(age<35))&&(sex=='m')&&(status=='g')&&(city=='c'))
   printf("42");
   else if(age>25&&age<35&&sex=='f'&&status=='g'&&city=='c')
    printf("31");
    else if(age>25&&age<35&&sex=='m'&&status=='b'&&city=='v')
   printf("60");
  else
  printf("no");

       } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:24:33.920

当使用 scanf() 读取字符时，它会在输入缓冲区中留下一个换行符。

改变 ：

```
 scanf("%c",&sex);
   printf("enter the health status");
   scanf("%c",&status);
   printf("where the person stay city or village");
   scanf("%c",&city); 
```

至：

```
 scanf(" %c",&sex);
   printf("enter the health status");
   scanf(" %c",&status);
   printf("where the person stay city or village");
   scanf(" %c",&city); 
```

请注意 scanf 格式字符串中的前导空格，它告诉 scanf 忽略空格。

或者，您可以使用[**getchar()**](http://pubs.opengroup.org/onlinepubs/009695299/functions/getchar.html)来使用换行符。

```
 scanf("%c",&sex);
   getchar();
   printf("enter the health status");
   scanf("%c",&status);
   getchar();
   printf("where the person stay city or village");
   scanf("%c",&city);
   getchar(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:17:56.993

我总是遇到与您使用相同的问题`scanf`，因此，我改用字符串。我会使用：

```
#include<stdio.h>
main()
{
    int age;
    char sex[3],status[3],city[3];
    printf("Enter the persons age \n");
    scanf("\n%d",&age);
    printf("enter the gender\n");
    gets(sex);
    printf("enter the health status");
    gets(status);
    printf("where the person stay city or village");
    gets(city);
    if(((age>25)&&(age<35))&&(sex[0]=='m')&&(status[0]=='g')&&(city[0]=='c'))
        printf("42");
    else if(age>25&&age<35&&sex[0]=='f'&&status[0]=='g'&&city[0]=='c')
        printf("31");
    else if(age>25&&age<35&&sex[0]=='m'&&status[0]=='b'&&city[0]=='v')
        printf("60");
    else
        printf("no");
} 
```

如果第一个`scanf`问题仍然给您带来问题（跳过第二个问题`gets`），您可以使用一个小技巧，但您必须包含一个新库

```
#include<stdlib.h>
...
char age[4];
...
gets(age);
...
if(((atoi(age)>25)&&(atoi(age)<35))&&(sex[0]=='m')&&(status[0]=='g')&&(city[0]=='c')) 
```

并在`atoi`每次使用时使用`age`，因为`atoi`将 char 字符串转换为整数 (int)。

# sql - 在子查询中加入具有多个关联行的子查询

> ID：14551198
> 
> 赞同：0
> 
> 时间：2013-01-27T19:19:39.297
> 
> 标签：sql, postgresql

我有一个选择一组用户的查询。每个用户可以有许多与之关联的事件。我想将每个用户加入与该用户关联的最早事件（导致每个用户一行），并在单个查询中这样做。

所以，我有点想这样做：

```
SELECT * FROM users
  left join (
    select * from events where events.user_id = users.id
    order by start_time limit 1) as event
    ON ("event"."user_id" = "users"."id") 
```

但是在加入的选择中引用“用户”是非法的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:23:08.227

您可以使用子查询来获取`min(start_time)`for each `user_id`。然后，您将使用此结果连接回`events`表以获取 min 事件的详细信息：

```
SELECT * 
FROM users u 
LEFT JOIN 
(
  SELECT Min(start_time) Min_Start, user_id 
  FROM events 
  GROUP BY user_id
) e1 
   ON u.id = e1.user_id 
LEFT JOIN events e2 
 ON e1.user_id = e2.user_id 
 AND e1.min_start = e2.start_time 
```

如果您使用的数据库能够应用 a `row_number()`，那么您可以使用以下内容：

```
select *
from
(
  SELECT *, 
    row_number() over(partition by e.user_id order by start_time) rn
  FROM users u 
  LEFT JOIN events e 
   ON u.id = e.user_id 
) src
where rn = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:26:45.740

在大多数数据库中，您可以使用`row_number()`：

```
SELECT *
FROM users u left join
     (select e.*, row_number() over (partition by e.user_id order by start_time) seqnum
      from events e
     ) e
     on e.user_id = u.id 
```

MySQL 和 MS Access 不支持此功能，但大多数其他数据库支持（并且您没有指定您使用的数据库）。

# javascript - Chrome 扩展返回状态 0 的跨域 XMLHttpRequest

> ID：14551200
> 
> 赞同：0
> 
> 时间：2013-01-27T19:19:50.740
> 
> 标签：javascript, google-chrome-extension, xmlhttprequest-states

我正在编写一个 Chrome 扩展程序，它需要从另一个站点加载一些数据。根据我的研究，我相信我应该为此使用 XMLHttpRequest，但它会为我尝试的每个站点返回 responseText="" 和 status=0。我传入 javascript 的 URL 很好；我试过了

`http://www.google.com`

和

`http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22MSFT%22)&env=store://datatables.org/alltableswithkeys`.

我在做一些无知/愚蠢的事情吗？我相信这是清单中的权限，但我现在拥有的应该允许这两个站点。我在我的 javascript 控制台中看不到任何错误。

**清单：**

```
{
  "manifest_version": 2,

  "name": "nnnn",
  "description": "nnnn",
  "version": "1.0",

  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "permissions": [
    "storage",
    "http://*.query.yahooapis.com/*",
    "http://*/*",
    "https://*/*"    
  ]
} 
```

**javascript函数：**

```
function getSite(queryUrl) {
  var request = new XMLHttpRequest();
  request.open("GET", queryUrl, true);
  console.log(queryUrl);
  request.onreadystatechange = function () {
    console.log(request);
   if (request.readyState == 4) {
      if (request.status == 200) {
        console.log(request.responseText);
      } else {
        console.log('Unable to resolve address');
      }
    }
  };
  request.send(null);
} 
```

**编辑： http:** [//developer.chrome.com/extensions/xhr.html](http://developer.chrome.com/extensions/xhr.html) 这几乎是我一直在寻求指导的内容，但显然有些事情已经超出了我的脑海。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:02:25.697

我不认为这是与许可相关的问题。如果是这样，控制台中会出现一条错误消息，宣布权限问题。我认为您的 XMLHttpRequest 有问题。确保`queryUrl`你传递给函数是正确的。

您可以使用[Fiddler](http://www.fiddler2.com/fiddler2/)检查您的请求有什么问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T19:49:02.523

我做了一些无知的事情，并且提交了一个表单，导致页面刷新并在完成时丢弃以前的 XMLHttpRequest

# android - 将内容从 WordPress 获取到 Android 应用程序的最佳方式是什么？

> ID：14551201
> 
> 赞同：0
> 
> 时间：2013-01-27T19:19:54.997
> 
> 标签：android, json, wordpress, rss

我有一个 wordpress 网站，我想将其创建为适用于 Android 的本机应用程序。从网站获取内容有哪些选择？

我研究了 RSS 提要和 JSON API/JSON 提要的 XML 解析。JSON 的 api 表示它已经过时并且可能不适用于新版本的 wordpress 网站。

我最好的选择是什么？

我需要获取帖子的标题、图像和文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:47:11.893

也许您可以从 WordPress for Android 项目源代码中受益：[http ://android.wordpress.org/development/](http://android.wordpress.org/development/)

# linux - 有什么方法可以让 LD 只记录共享库名称，没有子目录？

> ID：14551204
> 
> 赞同：0
> 
> 时间：2013-01-27T19:20:07.030
> 
> 标签：linux, shared-libraries, ld

我正在链接引用共享库的 Linux 可执行文件：

```
g++ Debug/file.o Debug/MyLib.so -o Debug/MyApp -Wl,--rpath='$ORIGIN' 
```

问题是生成的 MyApp 文件引用了“Debug/MyLib.so”，所以如果我从 Debug 目录运行它，它不会找到它。因此，指定 -Wl,--rpath='$ORIGIN' 没有帮助。

有没有办法告诉 GNU LD 使用“Debug/MyLib.so”文件，但在可执行文件中将其记录为“MyLib.so”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:57:18.603

如果不想更改库的名称，可以在创建时 使用**soname选项。**

例如：

*建立图书馆*

```
$> g++ -fpic -c mylib.cpp 
$> g++ -shared -o subdir/mylib.so mylib.o -Wl,-soname=mylib.so 
```

*构建程序*

```
g++ -o subdir/main main.cpp -Lsubdir -l:mylib.so -Wl,-rpath='$ORIGIN' 
```

（不要忘记**-l**选项后的冒号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:18:10.437

您为共享库链接不当。您应该将该库重命名为 libMyLib.so，并使用以下命令链接您的可执行文件：

```
g++ Debug/file.o -o Debug/MyApp -Wl,--rpath='$ORIGIN' -LDebug -lMyLib 
```

`-LDebug`所说的是在链接时在目录中搜索库`Debug`，然后在指定的路径中`-lMyLib`查找名为`libMyLib.so`（或`libMyLib.a`）的`-L`库，以及标准库搜索路径。

linux/unix 下库的标准命名约定是`libLibraryName`，并且链接器知道当您要求使用 链接到库`-l`时，它应该查找以`lib`thatname 为前缀的文件 当您以之前的形式使用它时，它实际上记录了绝对库这是在链接时使用的，而不是仅记录库名称并依靠运行路径解析库路径的正常机制。

# android - 可扩展列表视图：单个子选择

> ID：14551208
> 
> 赞同：-2
> 
> 时间：2013-01-27T19:20:29.417
> 
> 标签：android, expandablelistview

可展开列表视图中有多个组。我需要在每个中选择一个，即从一组中只选择一个。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:37:42.543

如果我没有理解正确，请纠正我，但您希望从 ExpandableListView 中的每个组中进行选择。

例如，您有 2 个组：Cats、Dogs，并且您想选择 1 只猫，但也要选择 1 只狗。

在这种情况下，您需要先在 ListView 上设置多项选择：

```
ExpandableListView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); 
```

然后，当您想选择任何孩子时，请在 OnChildClickListener.onChildClick() 中使用此代码：

```
if (groupPosition == 0) // for cats group
{
     parent.setItemChecked(mCheckedCatPosition, false);
     mCheckedCatPosition = childPosition + 1; // + cats header 
     parent.setItemChecked(mCheckedCatPosition, true);
}
else if (groupPosition == 1) // for dogs group
{
     parent.setItemChecked(mCheckedDogPosition, false);
     mCheckedDogPosition = childPosition + 2 + adapter.getChildrenCount(0); // + cats header + dogs header + number of cats
     parent.setItemChecked(mCheckedDogPosition, true);
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-27T19:26:50.180

在您的 xml 定义`listview`和另一个`listview_item`包含 a 的 xml 定义上`radio group`，然后在您的 java 活动定义`adapter`上为每个 listview_item (listview_row) 获取无线电组值

处理与 listview 非常相似的扩展列表

# c# - 正则表达式不起作用

> ID：14551209
> 
> 赞同：0
> 
> 时间：2013-01-27T19:20:29.973
> 
> 标签：c#, regex

大家好，我有下一条短信：

```
</form>onclick="g(null,null,'.htaccess','touch')">Touch</a> <br><br><pre class=ml1>
DirectoryIndex index.php
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/index.php
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$  [NC]
RewriteRule (.*) index.php
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L]
</pre></div> 
```

我尝试解析所有内容：`<pre class=ml1>`-`</pre></div>`

```
string con = Regex.Match(content, @"<br><br><pre class=ml1>(.*?)</pre></div>", RegexOptions.Multiline).Groups[1].Value;` 
```

但它不起作用。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:26:18.713

你需要

```
RegexOptions.Singleline 
```

所以`.`匹配每个字符，*包括*换行符。

你不需要`RegexOptions.Multiline`，因为你没有使用`^`or `$`。（多行模式使它们匹配一行的开头和结尾，而不是输入字符串的开头和结尾。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:26:49.307

您的代码的唯一问题是您使用了应该是 Regex.SingleLine 的 Regex.MultiLine

```
string con = Regex.Match(content, "<br><br><pre class=ml1>(.*?)</pre></div>", RegexOptions.Singleline).Groups[1].Value; 
```

* * *

## RegexOptions.MultiLine

> 多行模式。更改 ^ 和 $ 的含义，使其分别匹配任何行的开头和结尾，而不仅仅是整个字符串的开头和结尾。

## 正则表达式选项.SingleLine

> 指定单行模式。更改点 (.) 的含义，使其匹配每个字符（而不是除 \n 之外的每个字符）。

# java - 程序在 Java 中初始化对象输入流时暂停

> ID：14551211
> 
> 赞同：3
> 
> 时间：2013-01-27T19:20:33.483
> 
> 标签：java, sockets, stream, objectinputstream

在运行调试器时，程序暂停从服务器主输入输出流初始化对象流。以下是代码：

```
 public TFileReader(Client cli)throws Exception{
    this.cli = cli;
    fileSock = new Socket(cli.ServerIp(), cli.FilePort());
    fobjIn = new ObjectInputStream(fileSock.getInputStream());
    fobjOut = new ObjectOutputStream(fileSock.getOutputStream());
    fobjOut.flush();

}

 @Override
public void run(){

    try{
            System.out.println("file reader thread online");

            fobjOut.writeObject(cli.Name());
            fobjOut.flush();
           String per = (String) fobjIn.readObject();
            System.out.println(per+"video filing...");
            if(!per.equals("OKF"))
            {
                    throw new Exception("Error In retriving video.");
            } 
```

它暂停`fobjIn`并且不去执行，`fobjOut`尽管`fobjIn`它从`fobjIn`断点通过但不命中断点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:53:34.023

我会像这样保持简单

```
public TFileReader(Client cli) throws IOException {
    this.cli = cli;
    socket = new Socket(cli.ServerIp(), cli.FilePort());
    out = new ObjectOutputStream(socket.getOutputStream());
    out.flush();
    in = new ObjectInputStream(socket.getInputStream());
}

public void writeObject(Object o) throw IOException {
    out.writeObject(o);
    out.reset();
    out.flush();
}

public <T> T readObject() throw IOException {
    return (T) in.readObject();
}

public void close() throws IOException {
    in.close();
    out.close();
    socket.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:37:26.657

问题是 ObjectInputStream 在初始化时预读取数据。

首选的解决方案是在[Java 创建一个新的 ObjectInputStream 块](https://stackoverflow.com/questions/5658089/java-creating-a-new-objectinputstream-blocks)：始终在初始化您的 ObjectInputStream*之前*初始化您的 ObjectOutputStream，以便可以启动两者内部使用的“握手”。

当您不控制所有代码并且无法更改顺序时，请考虑延迟 OIS 初始化直到数据可用（InputStream.available 或在包装它的缓冲流上标记/读取/重置等）。

# version-control - 保护敏感文件免于推送到版本控制

> ID：14551217
> 
> 赞同：2
> 
> 时间：2013-01-27T19:21:08.350
> 
> 标签：version-control

这就是问题所在：我正在开发一些需要以某种方式存储用于外部服务的凭据的项目——例如，电子邮件地址和密码。我认为它属于“配置”，并决定将变量数据移动到程序读取的单独文件中。我不希望这个文件被推送到上游，因为在我的一些较小的程序中，为了个人需要而编写，我在生产环境中测试并且数据通常非常敏感。

另一方面，我不想要一个基本的`.gitignore`解决方案或它的等价物——而不是根本不上传文件，我宁愿在它的位置发送另一个文件，一个示例配置文件，同时保留“真实”文件在我电脑上的位置。有什么简单的方法可以实现吗？

如果您需要更多详细信息来回答这个问题，我更喜欢关于 Git VCS、Python 脚本和 Linux 操作系统的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:24:14.473

一种可能的解决方案：

提交并推送一个“示例”配置文件。然后，对本地配置文件进行所需的修改。它现在将在 Git 中标记为已修改。

用于`git update-index --assume-unchanged config`永久忽略未来对配置文件的本地修改（用于`--no-assume-unchanged`恢复跟踪修改）。

这样，您将在上游存储库中有一个示例配置，在您的存储库中有一个自定义配置，并且您不会意外提交更改的配置，因为 Git 不会将其标记为已修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-29T20:14:02.297

您可以做的另一件事是使用 .gitattributes 过滤器。它允许您指定某些文件以通过 unix 命令进行管道传输。您可以编写一个 ruby​​ 脚本来清除您的密码并用虚拟值替换它们，或者只使用 sed 或 awk。你可以比这更疯狂，也可以用它来做一些非常危险的事情，呵呵。[有关详细信息，请参阅其他答案](https://stackoverflow.com/questions/25558424/how-to-push-and-pull-from-github-without-sharing-sensitive-information-smudge)。

# c++ - c++ 多个参数（带结构）char* 发送错误（错误类型）？线程

> ID：14551218
> 
> 赞同：-1
> 
> 时间：2013-01-27T19:21:21.377
> 
> 标签：c++, pthreads, char

回答：（因为我无法在 7 小时后回答我的问题：/）好的，我通过这个修改解决了这个问题：

```
struct RecvDataModel
{
    int sockAddr;
    string inData; //old: char *inData;
};

void Client::Recv(int sockAddr, char *inData)
{
    cout << inData << endl;
    RecvDataModel *outData = new RecvDataModel();
    outData->sockAddr = sockAddr;
    outData->inData = string(inData);//old outData->inData = inData;
    pthread_t rThr;
    pthread_create(&rThr, NULL, ProcessData, outData);
} 
```

我认为字符串会自动修复 char* 格式，否则我什么都不懂！

## 现在我想问：字符串和字符的性能是一样的吗？使用字符串而不是char *（指针-void *-除外）有问题吗？

问题：-inData 和 sockAddr 来自一个套接字，这是一个多客户端聊天服务器-在这里，我可以将 sockAddr 发送到 ProcessData 但 inData 无法发送！它随着损坏的格式而改变（比如“testDataTextÿñ€ÿñ:¥øv:Y”我发送了“testDataText”并且它改变了）。我试图创建另一个 char* 并使用 for 循环复制所有内容，但此时如果我发送“te%s;t”之类的数据，则会再次以损坏的格式更改。我能做些什么？

```
struct RecvDataModel
{
    int sockAddr;
    char *inData;
};

void *ProcessData(void *arg);

void Client::Recv(int sockAddr, char *inData)
{
    RecvDataModel * outData = new RecvDataModel();
    outData->sockAddr = sockAddr;
    outData->inData = inData;
    pthread_t rThr;
    pthread_create(&rThr, NULL, ProcessData, outData);
}

void *ProcessData(void *arg)
{
    RecvDataModel *inData = (RecvDataModel*)arg;
    cout << inData->inData << endl;
    return 0;
} 
```

inData 和 sockAddr 来自这里（客户端类）：

```
#include <winsock2.h>

class Client
{
private:
    int mySock;
    int sockAddr;
    bool logged;
    void *listen(void)
    {
        int numBytes;
        char buffer[5120];
        while(1)
        {
            numBytes = recv(mySock, buffer, 5120, 0);
            if(numBytes == 0 || numBytes == -1)
            {
                Drop(mySock);
                mySock = 0;
                sockAddr = 0;
                return 0;
            }
            Recv(sockAddr, buffer);
            memset(buffer, 0, sizeof buffer);
        }
        return 0;
    }
public:
    void SetSock(int sock)
    {
        mySock = sock;
    }
    void SetSockAddr(int addr)
    {
        sockAddr = addr;
    }
    void Logged(bool status)
    {
        logged = status;
    }
    int GetSock()
    {
        return mySock;
    }
    int GetSockAddr()
    {
        return sockAddr;
    }
    bool IsLogged()
    {
        return logged;
    }
    static void *Listen(void *arg)
    {
        return ((Client*)arg)->listen();
    }
    static void Recv(int sockAddr, char *inData);
    static void Drop(int sockAddr);
}; 
```

和所有 main.cpp

```
#define PORT 9696
#define MAXCONN 9999
#define BACKLOG 128

#include <winsock2.h>
#include <pthread.h>
#include <iostream>
#include "Client.cpp"

using namespace std;

struct RecvDataModel
{
    int sockAddr;
    char *inData;
};

Client m_Clients[MAXCONN];

void *AcceptClients(void *arg);
void *HandleClient(void *arg);
void *DropClient(void *arg);
void *ProcessData(void *arg);

void Client::Recv(int sockAddr, char *inData)
{
    cout << inData << endl;
    RecvDataModel *outData = new RecvDataModel();
    outData->sockAddr = sockAddr;
    outData->inData = inData;
    pthread_t rThr;
    pthread_create(&rThr, NULL, ProcessData, outData);
}

void Client::Drop(int sockAddr)
{
    pthread_t dThr;
    pthread_create(&dThr, NULL, DropClient, (void*)sockAddr);
}

int main()
{
    /* WinSock initialization::START */
    WSADATA wsaData;
    if(WSAStartup(MAKEWORD(2,2), &wsaData) != 0)
    {
        cout << "WSA initialization failed!";
        WSACleanup();
        return 1;
    }
    /* WinSock initialization::END */
    SOCKET m_Socket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    //--> TCP Socket: socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)
    //--> UDP Socket: socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)
    if(m_Socket == INVALID_SOCKET)
    {
        cout << "Cannot create server socket!";
        WSACleanup();
        return 1;
    }
    sockaddr_in m_Inf;
    m_Inf.sin_family = AF_INET;
    m_Inf.sin_port = htons(PORT);
    m_Inf.sin_addr.s_addr = INADDR_ANY;
    if(bind(m_Socket, (sockaddr*)(&m_Inf), sizeof(m_Inf)) == SOCKET_ERROR)
    {
        cout << "Cannot bind server socket!";
        WSACleanup();
        return 1;
    }
    if(listen(m_Socket, BACKLOG) == SOCKET_ERROR)
    {
        cout << "Server socket cannot start listening!";
        WSACleanup();
        return 1;
    }

    for(int i = 0; i < MAXCONN; i++)
    {
        m_Clients[i].SetSock(0);
    }

    cout << "Listening for connections..." << endl;
    pthread_t mThr;
    pthread_create(&mThr, NULL, AcceptClients, (void*)m_Socket);
    cin.ignore();
    cin.get();
    cin.clear();
    WSACleanup();
    return 0;
}

void *AcceptClients(void *arg)
{
    int m_Socket = (int)arg;
    while(1)
    {
        sockaddr_in Sin;
        int SinLen = sizeof(Sin);
        SOCKET c_Socket = accept(m_Socket, (sockaddr*)(&Sin), &SinLen);
        if(c_Socket == INVALID_SOCKET)
        {
            cout << "A connection initialized but dropped! (invalid socket)" << endl;
        }
        else
        {
            pthread_t hThr;
            pthread_create(&hThr, NULL, HandleClient, (void*)c_Socket);
        }
    }
    return 0;
}

void *HandleClient(void *arg)
{
    int inSock = (int)arg;
    bool avaibleFound = false;
    int lastLooked = 0;
    int avaibleAddr = -1;
    while(!avaibleFound)
    {
        avaibleFound = true;
        if(lastLooked != MAXCONN)
        {
            if(m_Clients[lastLooked].GetSock() == 0)
            {
                avaibleAddr = lastLooked;
                avaibleFound = true;
            }
            else
            {
                lastLooked += 1;
                avaibleFound = false;
            }
        }
        else
        {
            avaibleAddr = -1;
            avaibleFound = true;
        }
    }
    if(avaibleAddr != -1)
    {
        m_Clients[avaibleAddr].SetSockAddr(avaibleAddr);
        m_Clients[avaibleAddr].SetSock(inSock);
        cout << "Socket(#" << inSock << ") connected." << endl;
        pthread_t cThr;
        pthread_create(&cThr, NULL, &Client::Listen, (void*)&m_Clients[avaibleAddr]);
    }
    else
    {
        send(inSock, "11", 2, 0);//11: Server is full!
        closesocket(inSock);
    }
    return 0;
}

void *DropClient(void *arg)
{
    int inSock = (int)arg;
    cout << "Socket(#" << inSock << ") disconnected." << endl;
    return 0;
}

void *ProcessData(void *arg)
{
    RecvDataModel *inData = (RecvDataModel*)arg;
    cout << inData->sockAddr << inData->inData << endl;
    delete inData;
    return 0;
} 
```

我已经发布了这样的问题，但没有人回答，这对我来说很重要，对不起：L

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:43:28.357

`listen`在调用之前将以下内容添加到您的函数中`Recv`：

```
buffer[numBytes]=0; 
```

这样，您将确定您尝试打印的字符串是以空值结尾的，并且您将`buffer`第一次看到没有来自未初始化的垃圾（是的，`memset`稍后您会这样做，但这对第一个数据包）。

# css - 动画过渡没有从正确的位置开始

> ID：14551221
> 
> 赞同：1
> 
> 时间：2013-01-27T19:21:30.737
> 
> 标签：css, animation, hover, css-transitions

我正在开发一个带有打结绳索式条的站点，该条可扩展以显示有关悬停的更多信息，并且在使动画看起来正确时遇到问题。（这是一个临时链接：[http](http://couchcreative.co/tcc/) ://couchcreative.co/tcc/ ）。

目前，第一步的栏将向下移动到框的底部，然后再向上移动到新位置，而我希望它在悬停时向上移动到新位置，而不是从悬停框的底部开始。谁能帮助解释为什么会这样？相关的 CSS 以“.look”类开头。

抱歉，如果我没有正确解释这一点，但希望当您访问该站点时，您会明白我对动画看起来有点……关闭的意思。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:52:26.087

我会重新设计您的 HTML 结构，使其更具语义性和更少重复性。

# 演示：http: [//jsfiddle.net/krmn4/5/](http://jsfiddle.net/krmn4/5/)

# HTML：

```
<a href="/testicularcancer/" class="look">
    <figure><img src="http://couchcreative.co/tcc/img/look.png" /></figure>
    <div class="bar"></div>
    <div class="off">
        <h4>Look</h4>
    </div>
    <div class="on">
        <h4>Relax your scrotum.</h4>
        <p>Check your testicles just after you’ve had a bath or shower, when the muscles in the scrotum are relaxed, making it easier for you to feel any lumps, growths or tenderness. Stand in front of the mirror. Look for any swelling on the skin of your scrotum.</p>
        <span>Learn More</span>
    </div>
</a> 
```

# CSS：

```
.look {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 235px;
    overflow: hidden;

    /* optional styling */
    color: #000;
    text-align: center;
    text-decoration: none;
}
.look h4 {
    /* optional styling */
    line-height: 48px;
    font-size: 20px;
    font-weight: bold;
}

.look .bar {
    height: 48px;
    background: url(http://couchcreative.co/tcc/img/step_1.png) 0 0 repeat-x;
    margin: -24px 0 0; /* half of height */

    /* necessary so figure img doesn't overlap */
    position: relative;
    z-index: 1;
}
.look figure,
.look .off,
.look .on {
    -webkit-transition: all 300ms linear;
    -moz-transition: all 300ms linear;
    transition: all 300ms linear;
    height: 0;
    opacity: 0;
    overflow: hidden;
}
.look figure {
    /* optional styling */
    background-color: #b2d5e6;
    padding: 12px;
    margin: 0;
}
.look .off {
    height: 48px;
    opacity: 1;
}

/* hover state */
.look:hover .off {
    height: 0;
    opacity: 0;
}
.look:hover figure {
    height: 120px; /* or however tall it needs to be */
    opacity: 1;
}
.look:hover .on {
    height: 220px; /* or however tall it needs to be */
    opacity: 1;
} 
```

# php - PHP中的空MySQL查询结果

> ID：14551222
> 
> 赞同：1
> 
> 时间：2013-01-27T19:21:40.090
> 
> 标签：php, mysql

这是有问题的 PHP 函数：

```
//Get data associated with $criteria from db
function getUserData($criteria, $value) {
    //obtain user data from db based on $criteria=$value
    global $pdo;
    //echo $criteria . " " . $value;
    try {
        $sql = 'SELECT id, first, last, email, userid FROM users WHERE :criteria= :value';
        //var_dump($sql);
        $st = $pdo->prepare($sql);
        $st->bindValue(':criteria', $criteria);
        $st->bindValue(':value', $value);
        $st->execute();
    }
    catch (PDOException $ex) {
        $error = "Failed to obtain user data.";
        $errorDetails = $ex->getMessage();
        include 'error.html.php';
        exit();
    }
    $row = $st->fetch();
    //var_dump($row);
        if ($row)
        {
            $userdata = array();
            $userdata['id'] = $row['id'];
            $userdata['first'] = $row['first'];
            $userdata['last'] = $row['last'];
            $userdata['email'] = $row['email'];
            $userdata['userid'] = $row['userid'];
            return $userdata;
        }
        return FALSE;
} 
```

我使用此函数返回与其中特定列关联的整行数据。

当在它的当前状态下使用时，通过这样的调用`getUserData("email", "John_Stewart_2013")`，它返回 false，这意味着一个空结果，而相同的查询在 MySQL CLI 中运行良好。

另一方面，如果我将查询字符串 $sql 替换为：

```
$sql = "SELECT id, first, last, email, userid FROM users WHERE $criteria='$value'"; 
```

并注释掉 bindValue 调用，PHP 中的每一件事都运行良好，并且查询按需要返回。

但问题是，这些函数参数是用户提交的表单数据，这意味着该解决方案容易受到 SQL 注入的攻击。

第一个查询表单有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:24:57.640

`bindValue`恐怕你不能使用列名。

如果您考虑一下准备好的语句是什么，这应该会变得更加明显。基本上，当您使用数据库服务器准备语句时，它会预先为查询创建一个执行计划，而不是在运行查询时生成它。这使得它不仅更快而且更安全，因为它知道它的去向，以及它将使用的数据类型以及将要输入的数据类型。

如果列/表名可以以任何方式绑定，它就无法生成这个执行计划，使得整个准备好的语句的想法有些多余。

最好的方法是使用这样的混合查询：

```
$sql = "SELECT id, first, last, email, userid FROM users WHERE $criteria = :value"; 
```

无论如何，我希望该`$criteria`专栏不是完全免费的形式。如果是这样，您最好将其限制为一组特定的允许选项。一个简单的方法是构建一个允许列的数组，并检查它是否有效`in_array`，如下所示：

```
$allowed_columns = array('email', 'telephone', 'somethingelse');
if (!in_array($criteria, $allowed_columns))
{
    $error = "The column name passed was not allowed.";
    $errorDetails = $ex->getMessage();
    include 'error.html.php';
    exit;
} 
```

# c++ - 将 MFC 控件传递给线程或传递句柄？

> ID：14551224
> 
> 赞同：2
> 
> 时间：2013-01-27T19:22:17.510
> 
> 标签：c++, multithreading, visual-c++, user-interface, mfc

我一直在某处读到，将 MFC ui 控件作为句柄传递给线程比将指针传递给控件更安全。

选项 1 - 传递指向静态文本的指针：

```
TestDialog  dlg1;
::_beginthreadex(NULL, 0, &tSetTextByPointer, &dlg1.m_StaticText, 0, NULL);
dlg1.DoModal();

UINT WINAPI tSetTextByPointer(LPVOID arg)
{
    CStatic * pStaticText = static_cast<CStatic*>(arg);
    Sleep(3000);
    pStaticText->SendMessage(WM_SETTEXT, 0, (LPARAM)L"text");

    return 0;
} 
```

选项 2 - 传递句柄：

```
TestDialog  dlg1;
::_beginthreadex(NULL, 0, &tSetTextByHandle, &(dlg1.m_StaticText.m_hWnd), 0, NULL);
dlg1.DoModal();

UINT WINAPI tSetTextByHandle(LPVOID arg)
{
    HWND * pTextHandle = static_cast<HWND*>(arg);
    Sleep(3000);
    ::SendMessage(*pTextHandle, WM_SETTEXT, 0, (LPARAM)L"text");

    return 0;
} 
```

当通过多个线程访问控件时，我真的应该更喜欢使用句柄吗？或者在访问控件时依靠 SendMessage() 来解决线程安全问题就足够了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:57:47.557

首先，您不应该直接从工作线程调用 UI。有很多很好的理由。

但是如果你确实需要这个，那么使用原始 HWND 会更安全。否则，您应该检查`pStaticText->SendMessage`方法是否是线程安全的。

如果您使用的是 VS2010 及更高版本，我建议您使用这种方法： [http ://www.terrainformatica.com/2011/01/c0x-running-code-in-gui-thread-from-worker-threads/](http://www.terrainformatica.com/2011/01/c0x-running-code-in-gui-thread-from-worker-threads/)

# vba - 在excel vba中对时间格式的单元格进行计算

> ID：14551227
> 
> 赞同：2
> 
> 时间：2013-01-27T19:22:46.243
> 
> 标签：vba, excel

我有三个单元格 IN 、 OUT 和 OverTime 都格式化为 [h]:mm，OT 单元格有这个论坛，

```
=ROUND(IF(((D10-C10)+(D11-C11))*24>7,((D10-C10)+(D11-C11))*24-7,0)/24*96,0)/96 
```

计算 OT 到 1/4 小时

```
8 C D E F 
9   IN      OUT      O/T  C/T
10 7:30 AM 12:15 PM 1:45
11 1:00 PM 5:00 PM 
```

   当员工当天下班时，我希望运行以下代码；

```
Dim CT As Date
Title = "Add to CompTime from OverTime"
If Range("E10") > 0 Then
CT = InputBox("Add Hours to CompTime?", Title)
If CT > 0 Then Range("F10").Value = ("E10" - CT)
Else: Range("F10").Value = " "
End If
End Sub 
```

一切似乎都有效，除了；如果 CT > 0 Then Range("F10").Value = ("E10" - CT) 我知道这是格式问题，但我无法解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T03:07:23.247

始终尝试对范围进行显式引用，无论它们是在工作表还是模块上。使用对象的适当属性 - 在您的情况下，您有一个**不合格**`E10`的范围。假设您在工作表 1：

 **```
Option Explicit
'--Beginning of your Subroutine...
Dim Title as String '-- assuming
Dim CT As Date '-- are you sure you want to have a date here?

Title = "Add to CompTime from OverTime"

  If Sheets(1).Range("E10").Value > 0 Then '-- assuming it's a valid date here...
    CT = InputBox("Add Hours to CompTime?", Title)
    '-- assume your CT = 2:45 and OT = 75:30
    '-- use the following as mentioned in my comment
    If CT > 0 Then 
       Application.Text( Sheets(1).Range("F10").Value ,"[h]:mm")  = 
       Application.Text(Sheets(1).Range("E10").Value, "[h]:mm") - Application.Text(CT, "[h]:mm") 
    Else
       Sheets(1).Range("F10").Value = " "
    End If
  End If
End Sub 
```

PS：如果您要计算小时数，您可能只使用 VBA 进行整个计算.. =)**

# perl - 如何将嵌套路由映射到 Mojolicious 中的子类

> ID：14551231
> 
> 赞同：3
> 
> 时间：2013-01-27T19:23:26.453
> 
> 标签：perl, mojolicious

我正在使用 Mojolicious，并将在以下位置建立服务：

```
/admin/users/view/1
/admin/posts/view/1 
/admin/comments/view/1 
```

如何创建路由以使控制器匹配“管理员/用户”并将其转换为 Admin::Users

我想实现：

```
my $r = $self->routes;
$r->get('/*controller/:action/:id'); 
```

似乎没有一个好方法可以做到这一点，而不必为每个管理控制器编写一个路由，这似乎是一种浪费。上面的语句产生一个 'Admin/posts' 而不是 'Admin::Posts' 的控制器

谁能阐明如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:18:50.257

好的，我找到了。

```
$r->get('/admin/:controller/:action/:id')->to(namespace=>'MyApp::Admin); 
```

# c# - GridView - 访问元素

> ID：14551233
> 
> 赞同：0
> 
> 时间：2013-01-27T19:23:31.143
> 
> 标签：c#, asp.net, c#-4.0

我有一个 GridView 控件，它列出了具有以下字段的客户对象：
ID、FirstName、LastName 和 SignUpDate。

我需要向允许我
编辑特定客户的 GridView 控件添加第五列（“编辑”）。它可以是 LinkBut​​ton 或 BoundButton。

因此，当单击“编辑”链接/按钮时，我想访问 Id 并将其传递
给 Click 事件。我有一个方法，它需要一个 Id 并编辑客户。

GridView 绑定到一个客户对象列表。我怎样才能做到这一点？

```
<asp:GridView ...>
    <Columns>
        <asp:ButtonField HeaderText="Customer ID"  DataTextField="Id" />
        <asp:ButtonField HeaderText="First Name"   DataTextField="FirstName" />
        <asp:ButtonField HeaderText="Last Name"    DataTextField="LastName" />
        <asp:ButtonField HeaderText="Member Since" DataTextField="SignUpDate" />
        <'Edit' link/button here. Want to pass 'Id' to a method when clicked />
    </Columns>
</asp:GridView>

customerList.DataSource = customerList; // this is List<Customer>
customerList.DataKeyNames = new string[] {"Id"};
customerList.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:32:10.903

You need to add a commandfield to define your edit column.

```
<asp:CommandField ShowEditButton="True" /> 
```

# ios - 我应该使用精灵（图像）还是应该绘制？

> ID：14551237
> 
> 赞同：1
> 
> 时间：2013-01-27T19:23:55.097
> 
> 标签：ios, cocos2d-iphone

下面是一个著名的建筑游戏的截图。

![在此处输入图像描述](../Images/8b258bf94f79382ccea01c8d36fb6d18.png)

如您所见，杆与球形接头连接在一起。我正在尝试在 iPhone 上实现与 Cosos2d 类似的功能。我这里有两个问题：

1.  我应该画那些球关节还是应该将它们添加为精灵？
2.  我猜杆不是画的，而是图像。但是考虑到棒的长度会根据需要而变化，我如何从一张图像中制作不同长度的棒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:00:51.140

我不确定什么是最好的方法。我想无论哪种方式都可以，但是通过绘制它们来实现您想要的任何视觉效果都会更加困难。我认为最难的部分是确保它们锚定到具有您想要的尺寸的网格系统中的顶点。

至于（2），您始终可以缩放图像。

```
 CCSprite *rod = [CCSprite spriteWithFile:@"rod.png"];
     rod.scaleY = 2.0; //or scaleX 
```

然后根据需要旋转并更改其锚点。

我再次想象最困难的部分是锚定它们并正确定位它们，以便与顶点正确对齐。

# php - 在不更改 url 的情况下使用 htaccess

> ID：14551239
> 
> 赞同：2
> 
> 时间：2013-01-27T19:24:02.977
> 
> 标签：php, html, .htaccess, mod-rewrite

我有这个 htaccess

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^(.*)$ dl.php?id=/$1 [QSA,L]
</IfModule> 
```

它完美无缺。我只有一个问题，我插入了我的网站 URL 和像这样的图像

```
<img src="img/image.gif">
<a href="do.php"> 
```

它的短网址不完整

```
<a href="mysite.com/img/image.gif"> 
```

所以当我现在打开时，`127.0.0.1/dl.php/1/`我可以得到

```
$_GET['id'] 
```

但我的链接和图片想从

```
http://127.0.0.1/dl.php/img/h.png 
```

但它必须是

```
http://127.0.0.1/img/h.png 
```

谁能帮我这个？我无法更改我网站中的所有网址并使它们成为完整网址。我有 50 页，我想要这个 htaccess 只是为了`dl.php`文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:33:35.253

它想要这样做是因为您在`src`.

只需将 a`/`添加到您的路径中，它将转到您网站的根目录（即相对于域），而不是相对于当前文件夹（当然，不是真正的文件夹，而是根据您的浏览器的 URL不知道更好）。

```
<img src="/img/image.gif">
<a href="/do.php"> 
```

很抱歉，您*需要*更改每条路径。有一种选择，但您仍然必须更改每条路径，除非`dl.php`包含像页眉/页脚这样的内容。在这种情况下，您可以将标签附加`<base href=".." />`到标头，这将强制相对路径相对于您提供的路径进行解析。

```
<head>
    ...
    <base href="http://www.mysite.com/" />
</head> 
```

# html - 设置 inline-block div 以忽略换行符

> ID：14551245
> 
> 赞同：0
> 
> 时间：2013-01-27T19:24:30.660
> 
> 标签：html, css

我有三个并排使用的 div `display:inline-block`。

如果 div 为空，则它们处于相同的水平级别。

一旦我将`<p>`标签和一些换行符（`<br/>`）添加到最左边/第一个 div，其余部分就会向下移动。

如果我在第二个盒子里放了足够多的内容，第三个盒子就会下移得更多。

我的盒子HTML：

```
<div class="main-box" id="about">
    <h1>About</h1>
    <p>This box has one paragraph of text, with line breaks</p>
</div>

<div id="login-container">
    <div class="main-box" id="login">
        <h1>Login</h1>
        <p>Already a member? Sign in and see your stuff!</p>
    </div>
    <div class="main-box" id="signup">
        <h1>Signup</h1>
        <p>Create an account by filling out this form.</p>
    </div>
</div> 
```

最后两个框组合在一个 div 中，以便它们“浮动”在一起。

我的 CSS：

```
div.main-box {
    text-align: left;
    display: inline-block;
    border: 10px solid red;
    margin: 20px;
    padding: 25px;
    border-radius: 50px;
    width: 400px;
    height: 400px;
}
div#login-container {
    display: inline-block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:31:22.093

只需添加：

```
 vertical-align: top; 
```

[您可以在此处](http://robertnyman.com/2010/02/24/css-display-inline-block-why-it-rocks-and-why-it-sucks/)阅读`inline-block`IE7 修复和 html 代码中的间距等更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:37:58.317

你愿意使用 float: left 而不是 display: inline-block 用于内部 div 吗？

我能想到的另一个解决方案是使用 float: left 或 display: table 创建一个类并将其应用于段落标签。

# mysql - MySQL比较行与空条目

> ID：14551249
> 
> 赞同：1
> 
> 时间：2013-01-27T19:24:41.013
> 
> 标签：mysql, self-join

我已经阅读了很多关于自联接的示例，但它们似乎没有涵盖某些字段不在某些行中的情况。

例如，我有一个数据库：

```
testId, testItem, testResult 
```

和行：

```
 1,test1,1
 1,test2,0
 1,test3,1
 2,test1,0
 2,test4,1
 2,test5,1 
```

我想要输出：

```
testItem,a.testId,b.testId,a.testResult,b.testResult
test1,1,2,1,0
test2,1,NULL,0,NULL
test3,1,NULL,1,NULL
test4,NULL,2,NULL,1
test5,NULL,2,NULL,1 
```

本质上，我想比较来自两个不同 testId（1 和 2）的每个 testItem（test1->test5）并比较它们的 testResult 值，同时考虑到 testId 可能没有相同的测试项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:52:53.503

鉴于您的确切要求，您可以试试这个：

```
select testItem
     , max(case when testID = 1 then testID else null end) as testID1
     , max(case when testID = 2 then testID else null end) as testID2
     , max(case when testID = 1 then testResult else null end) as testResult1
     , max(case when testID = 2 then testResult else null end) as testResult2
from mytable
where testID in (1,2)
group by testItem 
```

这对您的数据做出了很多假设，因此请谨慎对待。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:37:46.187

看起来您想要一个完整的外部联接，这在 MySQL 中不受支持。您可以使用两个查询的 UNION 来模拟这一点：LEFT JOIN 查询和 RIGHT JOIN 会抛出匹配的行。

像这样的东西将返回指定的结果集：

```
SELECT a.testItem
     , a.testId      AS `a.testId`
     , b.testId      AS `b.testId`
     , a.testResult  AS `a.testResult`
     , b.testResult  AS `b.testResult`   
  FROM mytable a
  LEFT
  JOIN mytable b
    ON b.testItem = a.testItem
       AND b.testId = 2
 WHERE a.testId = 1
   AND a.testItem IN ('test1','test2','test3','test4','test5')
 UNION ALL
SELECT d.testItem
     , c.testId
     , d.testId
     , c.testResult
     , d.testResult
 FROM mytable d
 LEFT
 JOIN mytable c
   ON c.testItem = d.testItem
      AND c.testId = 1
WHERE d.testId = 2
  AND d.testItem IN ('test1','test2','test3','test4','test5')
  AND c.testId IS NULL
ORDER
   BY 1,2,4 
```

（我在 testItem IN ('test1' thru 'test5') 上包含了谓词，因为您将其指定为要求；如果您希望包含 testItem 的所有值，则可以删除这些谓词。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:46:34.793

[SQLFiddle 演示](http://www.sqlfiddle.com/#!2/19fea/17)

```
select testItem, 
group_concat(IFNULL(testId,'null') separator ', ') testIds,
group_concat(IFNULL(testResult, 'null') separator ', ') testResults
from table_name group by testItem; 
```

# sql - 如何在 SQL Server 2008 中启用集成服务 (SSIS)？

> ID：14551255
> 
> 赞同：18
> 
> 时间：2013-01-27T19:25:31.247
> 
> 标签：sql, sql-server-2008, ssis, installation

我无法在 SQL Server 2008 中启动 SSIS。这是 SQL Server 安装程序的屏幕截图。我应该从哪里开始在 SQL Server 2008 中启用/安装集成服务？

![在此处输入图像描述](../Images/ee3dfd0c84661bc6204ec3cf65dc1ef9.png)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-28T15:03:21.107

以下是使用**`SQL Server 2008 R2`**安装程序进行的安装步骤的屏幕截图。下面列出的步骤应该让您了解如何安装`SQL Server 2008`.

在 SQL Server 安装介质上，右键单击**`Setup.exe`**并选择**Run as administrator**。

打开`SQL Server Installation Center`，单击*安装*，然后单击*新安装或向现有安装添加功能*。

![安装程序](../Images/70f79722d63d9ccc48df8e18f842775f.png)

在SQL Server 2008 R2 安装步骤中单击**确定。**`Setup Support Rules`如果设置支持规则出现警告或故障，请采取必要措施进行修复。

单击SQL Server 2008 R2 安装步骤上的**安装**。`Setup Support Files`

在SQL Server 2008 R2 安装步骤中单击**下一步 > 。**`Setup Support Rules`如果设置支持规则出现警告或故障，请采取必要措施进行修复。

在`Installation Type`SQL Server 2008 R2 安装步骤中，选择*全新安装或添加共享功能*，或选择*向现有 SQL Server 2008 R2 实例添加功能*并选择适当的实例名称。点击**下一步 >**

![安装类型](../Images/09554306eb6e0e1eb37ca3f3cd40fd61.png)

`Product Key`在SQL Server 2008 R2 Setup 步骤中输入产品密钥，然后单击**Next >**

检查`I accept license terms`，如果您选择接受条款和条件，然后在 SQL Server 2008 R2 安装步骤中单击下一步> **。**`License Terms`

在SQL Server 2008 R2 Setup的步骤中选择*SQL Server Feature Installation ，单击***Next >**`Setup Role`

 **在`Feature Selection`SQL Server 2008 R2 安装步骤中，您需要决定要安装什么。

*   如果您只需要用于 SSIS 包开发的 Business Intelligence Development Studio，则只需安装 Business Intelligence Development Studio。

*   如果您需要集成服务来部署和运行 SSIS 包，请选择集成服务。**`NOTE`**：我建议您在选择此选项之前阅读 MSDN 或 Microsoft 网站上的许可要求。

下面的屏幕截图显示了 SSIS 包开发和其他仅客户端组件的 BIDS 安装。

![特征选择](../Images/8fb797786bbf26d4680c445fa259c0a4.png)

阅读详细信息并在SQL Server 2008 R2 安装步骤中单击**下一步 > 。**`Installation Rules`

阅读详细信息并在SQL Server 2008 R2 安装步骤中单击**下一步 > 。**`Disk Space Requirements`

阅读详细信息并在SQL Server 2008 R2 安装步骤中单击**下一步 > 。**`Error Reporting`

在SQL Server 2008 R2 安装步骤中单击**下一步 > 。**`Installation Configuration Rules`如果安装配置规则出现警告或故障，请采取必要的措施进行修复。

验证组件并单击SQL Server 2008 R2 安装步骤上的**安装**。`Ready to Install`

安装完成后，将出现状态向导。如果一切都成功，请单击关闭，否则如果安装失败，请采取必要的措施。

希望有帮助。**

# ruby - Ruby：如何判断一个字符是字母还是数字？

> ID：14551256
> 
> 赞同：28
> 
> 时间：2013-01-27T19:25:48.573
> 
> 标签：ruby, string, character, digits

本周早些时候我刚刚开始修补 Ruby，但我遇到了一些我不太了解如何编码的东西。我正在将一个用 Java 编写的扫描仪转换为 Ruby 以进行类分配，我已经深入到本节：

```
if (Character.isLetter(lookAhead))
{      
    return id();
}

if (Character.isDigit(lookAhead))
{
    return number();
} 
```

`lookAhead`是从字符串中挑选出的单个字符（每次循环移动一个空格），这两种方法确定它是字符还是数字，返回适当的标记类型。我一直无法找出与`Character.isLetter()`and等价的 Ruby `Character.isDigit()`。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-27T20:36:51.463

使用匹配字母和数字的正则表达式：

```
def letter?(lookAhead)
  lookAhead.match?(/[[:alpha:]]/)
end

def numeric?(lookAhead)
  lookAhead.match?(/[[:digit:]]/)
end 
```

这些被称为 POSIX 括号表达式，它们的优点是给定类别下的 unicode 字符将匹配。例如：

```
'ñ'.match?(/[A-Za-z]/)     #=> false
'ñ'.match?(/\w/)           #=> false
'ñ'.match?(/[[:alpha:]]/)  #=> true 
```

[您可以在Ruby 的正则表达式文档](https://ruby-doc.org/core/Regexp.html)中阅读更多内容。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-27T19:30:50.310

最简单的方法是使用正则表达式：

```
def numeric?(lookAhead)
  lookAhead =~ /[0-9]/
end

def letter?(lookAhead)
  lookAhead =~ /[A-Za-z]/
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-01-26T20:16:43.687

正则表达式在这里是多余的，它在性能方面要昂贵得多。如果您只需要检查字符是否为数字，则有一种更简单的方法：

```
def is_digit?(s)
  code = s.ord
  # 48 is ASCII code of 0
  # 57 is ASCII code of 9
  48 <= code && code <= 57
end

is_digit?("2")
=> true

is_digit?("0")
=> true

is_digit?("9")
=> true

is_digit?("/")
=> false

is_digit?("d")
=> false 
```

# excel - 在excel中查找单词并返回整个字符串？

> ID：14551261
> 
> 赞同：-4
> 
> 时间：2013-01-27T19:26:19.530
> 
> 标签：excel

您好，我需要在文本中找到一个特定的单词并返回该单词所在的整个字符串。每个字符串都在一个 excel 单元格中。谢谢 Dan

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:45:18.770

大概您想在特定的单元格范围内找到单词？如果您正在查看像 A1:A100 这样的单列数据，那么您可以使用 VLOOKUP，例如，此公式将找到包含“单词”的第一个单元格并返回该单元格中的所有内容

`=VLOOKUP("*word*",A1:A100,1,0)`

# html - html -自定义样式我正在尝试自定义组件的整个样式，并隐藏选择器图像。边框、阴影等所有图形样式均在上表中设置。现在我想从选择菜单中删除所有样式，例如可怕的图标来选择一个项目我在 jsf 中的原始代码： <h:panelgrid class="dropDown"><h:selectonemenu value="#{myBean.selected}" id="list" class="test" style="border-style:none; height:31px;</h1>
<blockquote>
        <p>ID：14551262</p>
        <p>赞同：0</p>
        <p>时间：2013-01-27T19:26:27.667</p>
        <p>标签：html, css, select, webview, styles</p>
        </blockquote>

            <hr/>
            <h2>回答 #1</h2>
            <blockquote>
            <p>赞同：1</p>
            <p>时间：2013-01-27T19:33:42.060</p>
            </blockquote>

<p>标准的 JSF html 渲染工具包会将<code>h:selectOne</code>一个简单的 html 选择标签呈现为您<code>f:selectItems</code>  成为子选项标签。</p>

<pre>所以你的问题是真的有办法从 html 选择标签中删除图标。它实际上与 JSF 无关。

一旦你弄清楚如何编写 html 和 css 来获得你想要的效果，你就可以编写一个自定义渲染器来重现那个 html。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:22:24.367

使用自定义 css 找到了一个可行的解决方案：

由于组件 jsf 呈现为 ，因此我们将所有元素包含在 a 中，或者在本例中包含在 a 中

```
<h:panelGrid class="parent dropDown">
  <h:selectOneMenu value="#{myBean.selected}"
    id="list" class="test" style="border-style:none; height:31px;">
    <f:selectItems value="#{myBean.list}" var="item"
    itemLabel="#{item.name}" itemValue="#{item.code}" />
     <f:ajax execute="@this" />
   </h:selectOneMenu>
</h:panelGrid> 
```

将类父级添加到 panelGrid 并定义：

```
 .parent{
        width:98%;
        overflow:hidden;
    }

    .parent select{
        width:100%;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border: none;
        background: none;    
    } 
```

我们的 jsf 组件是在没有箭头和其他组件（如边框和阴影）的情况下呈现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-01T07:42:37.823

自定义样式选择仅使用 html 和 css 而不是任何 js/javascript

```
`http://jsfiddle.net/suyogN/39tx46L3/` 
```<code><select>
  <option value=" a"&gt;a&lt;="" option&gt;="" &lt;option="" &gt;b&lt;="" &lt;="" select&gt;="" <="" code=""></h:selectonemenu></h:panelgrid>

# image - Matlab imwrite函数改变像素值

> ID：14551264
> 
> 赞同：1
> 
> 时间：2013-01-27T19:26:32.917
> 
> 标签：image, matlab, image-processing

我尝试更改灰度图像的一些像素值并在 matlab 中使用 imwrite 将其保存。保存没问题。问题是当我读回来时，一些像素值已经改变。与我在保存之前分配给像素的值不完全相同。我正在尝试散列图像，因此 1unit 差异会影响散列数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T13:09:58.360

正如 mmgp 所述，JPG 可能是[有损](http://en.wikipedia.org/wiki/Lossy_compression)的。这意味着图像中的某些信息将丢失，以提高存储效率。

JPG 背后的原理有点像 MP3 背后的原理——人眼不太适应分辨的色调等变化将被简化或完全删除，从而减少图像中的信息量。JPG 中的信息代表了一个外观相似但实际上非常不同的图像。这可能就是你正在经历的。

在 Matlab 中，查看`help imwrite`. 你可以给`jpg`写入参数一个叫做的参数`'Quality'`，它是一个介于 0 和 100 之间的数字，100 表示（接近）无损压​​缩。

尽管 JPEG 标准*确实*允许（近乎）无损压缩，但它在实践中并不经常使用（至少在我的领域中）。更流行的无损图像格式是 PNG、JPEG2000 和 TIFF。[在此处](http://en.wikipedia.org/wiki/Lossless_compression#Lossless_compression_methods)阅读更多相关信息。

`imwrite`所有这些在 Matlab 的函数中也可用。

# proxy - [Nginx]如何为已经在端口上运行的服务启用ssl？

> ID：14551271
> 
> 赞同：0
> 
> 时间：2013-01-27T19:26:54.070
> 
> 标签：proxy, nginx, couchdb

默认情况下，我在端口 5984 上运行了 couchdb 1.2，并且我启用了绑定地址 0.0.0.0，以便我可以从外界访问沙发。同时，我将“必需用户”启用为 true（默认情况下启用 couchdb 的基本身份验证）。我可以从外面进入沙发，我主要用它来复制。

我的应用程序前面有 nginx，因此所有请求都`http://example.com`被重定向到`https://example.com`，并且请求由运行我的 rails 应用程序的乘客服务器提供服务。

由于我已经从世界之外启用了沙发，目前我可以通过`http://ip_address:5984`or访问我的 couchdb `http://example.com:5984`（观察它不是 https）。

我想为 couchdb 提供的请求启用 https。我认为对我没有用的几个解决方案是 - 1\. 通过位置 ex 向 couchdb 添加代理：所有请求都`https://example.com/couchdb/`可以通过代理传递给`http://127.0.0.1:5984`（或）2\. 通过侦听端口添加代理 ex：在不同的端口上监听说“ [https://example.com:5985](https://example.com:5985) ”，然后代理将请求传递给`http://127.0.0.1:5984`. 3.我无法收听5984并代理将其传递给，`http://...:5984`因为该端口已被couchdb使用。

有没有办法我可以说 nginx 代理通过 https 将所有请求传递到端口 5984？即任何请求都`http://example.com:5984`应该被重定向到`http**s**://example.com:5984`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:31:14.547

我想我的问题的简单答案是不可能将传递请求从`http://example.com:5984`{ [https://example.com:5984](https://example.com:5984) } 代理。为了解决这个问题，我为沙发启用了默认 https，因此我只能通过 { [https://example.com:5984](https://example.com:5984) } 访问我的沙发。沙发的 SSL 是从 couchdb1.1 实现的

# android - 如何在没有 SD 卡的情况下保存文件？

> ID：14551272
> 
> 赞同：1
> 
> 时间：2013-01-27T19:27:05.233
> 
> 标签：android, file, save

我有一台没有存储卡的设备，我想保存文件。我试过了：

```
filePath = Environment.getDataDirectory().toString(); 
```

/data/.... EACCES（权限被拒绝）

```
filePath = Environment.getDownloadCacheDirectory().toString(); 
```

/cache/.... EACCES（权限被拒绝）

和

```
filePath = Environment.getRootDirectory().toString(); 
```

/system/.... EROFS（只读文件系统）

还有其他方法吗？？（对不起我的英语：P）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:38:18.453

尝试将文件写入内部存储，在您的应用程序本地空间中，文件将被写入类似的地方，下面的代码可能会在这方面对您有所帮助

```
 FileOutputStream fOut = null;
            OutputStreamWriter osw = null;
            try{
                fOut = openFileOutput(FILE_NAME, Context.MODE_PRIVATE);
                osw = new OutputStreamWriter(fOut);
                osw.write("yourString data");
                osw.close();
                fOut.close();
                }catch(Exception e){
                    e.printStackTrace(System.err); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:56:58.473

你可以试试这个。我正在使用它来存储下载图像

```
String cacheDir= 
context.getCacheDir();
File file= new File(cacheDir,
"test.dat");
FileOutputStream out = new
FileOutputStream(file); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:40:33.407

将文件保存在内存中，但您看不到内存中保存的文件。

使用此代码将文件保存在内部存储器中。

```
public boolean saveImageToInternalStorage(Bitmap image,Context context)
{
    try {
        FileOutputStream fos = context.openFileOutput("photo.jpg", Context.MODE_WORLD_READABLE);
        image.compress(Bitmap.CompressFormat.JPEG, 100, fos);
                        // 100 means no compression, the lower you go, the stronger the compression
        fos.close();
        return true;
    }
    catch (Exception e) {
        Log.e("saveToInternalStorage()", e.getMessage());
    }
    return false;
} 
```

阅读[本文](http://connectcoders.blogspot.in/2012/12/save-bitmap-in-internal-and-external.html)以将文件保存在内部和外部存储器中。

# ios - 使用 UITableView 中单元格中的文本

> ID：14551277
> 
> 赞同：0
> 
> 时间：2013-01-27T19:27:24.483
> 
> 标签：ios, xcode, uitableview, switch-statement

我想在 UITableView 中使用选定单元格的文本。它将用于不同视图中的 switch 语句。我该怎么做？

这是**UITableView**的代码：

```
- (void)viewDidLoad
{
[super viewDidLoad];

_list = [[NSArray alloc] initWithObjects:@"Academic Advising Center", @"Academic Vice      President", @"Administrative Services Vice President", @"Admissions", @"Advanced Standing and Transcript", @"Alcohol and Substance Abuse Programs", @"Allied Health Department", @"Alumni Network", nil];

_displayItems = [[NSMutableArray alloc] initWithArray:_list];

}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
return [_displayItems count];
}

- (UITableViewCell *)tableView:(UITableView *) atableView cellForRowAtIndexPath:  (NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
}

cell.textLabel.text = [_displayItems objectAtIndex:indexPath.row];   //TRY THIS ONE!!
return cell;
} 
```

这是将使用 UITableView 中单元格文本的视图代码（现在，我在 switch 语句中使用单元格编号，但**我想使用单元格的内容而不是单元格编号**）：

```
- (void)configureView 
{
// Update the user interface for the detail item.

switch (_itemNumber)
{
    case 0:
        [_phoneButton setTitle:@"233-123-2133" forState:UIControlStateNormal];
        [_emailButton setTitle:@"adf@dsf.sdf" forState:UIControlStateNormal];
        self.title = @"Acdemic Adv. Center";
        break;
    case 1:
        [_phoneButton setTitle:@"324-123-4231" forState:UIControlStateNormal];
        [_emailButton setTitle:@"WERERW@wefff.edu" forState:UIControlStateNormal];
        self.title = @"Acdemic VP";
        break;
    case 2:
        [_phoneButton setTitle:@"232-222-3333" forState:UIControlStateNormal];
        [_emailButton setTitle:@"eeeee@vfff.sss" forState:UIControlStateNormal];
        self.title = @"Admin. Serv. VP";
        break;
    case 3:
        [_phoneButton setTitle:@"111-222-3333" forState:UIControlStateNormal];
        [_emailButton setTitle:@"eeeed@def.ed" forState:UIControlStateNormal];
        self.title = @"Admissions";
        break;
    case 4:
        [_phoneButton setTitle:@"343-333-2222" forState:UIControlStateNormal];
        [_emailButton setTitle:@"eee@fff.www" forState:UIControlStateNormal];
        self.title = @"Adv. Stand. & Trans.";
        break;
    case 5:
        [_phoneButton setTitle:@"333-333-3333" forState:UIControlStateNormal];
        [_emailButton setTitle:@"ffff@sss.aaa" forState:UIControlStateNormal];
        self.title = @"Alc. & Subs. Abuse Prog.";
        break;
    case 6:
        [_phoneButton setTitle:@"444-332-2222" forState:UIControlStateNormal];
        [_emailButton setTitle:@"errvff@ede.def" forState:UIControlStateNormal];
        self.title = @"Allied Health Dept.";
        break;
    case 7:
        [_phoneButton setTitle:@"343-222-4444" forState:UIControlStateNormal];
        [_emailButton setTitle:@"saff@fgd.eee" forState:UIControlStateNormal];
        self.title = @"Alumni Network";
        break;

    default:
        [_phoneButton setTitle:@"" forState:UIControlStateNormal];
        [_emailButton setTitle:@"" forState:UIControlStateNormal];
        self.title = @"";
        break;
    }
}

- (void)viewDidLoad
{
[super viewDidLoad];

_itemNumber = [[NSUserDefaults standardUserDefaults]integerForKey:@"Cell"];

// Do any additional setup after loading the view, typically from a nib.
[self configureView];
} 
```

我知道：_itemNumber = [[NSUserDefaults standardUserDefaults]integerForKey:@"Cell"]; 将使用单元格的数量，我如何使用内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:09:14.453

对于做这样的事情，这实际上是非常糟糕的方法。我建议您将数据存储到具有多个 NSDictinary 的 NSArray 中，其中将包含用户信息名称/电话/电子邮件。然后将 NSArray 中的每个对象映射到表视图中，因此具有特定索引的单元格将具有相同索引的数组中的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:35:27.150

使用具有多个 NSDictionary 实例的 NSArray 作为数据存储（尽管不要直接从该 NSArray 加载表）。这就是 Ivan Alek 在另一个答案中所建议的。

然后，将匹配搜索的 NSDictionary 实例的索引 (NSNumbers) 存储在 NSMutableArray 中。这样，搜索栏不会更改您的基本数据存储，只会更改此索引数组。

一些示例代码：

```
- (UITableViewCell *)tableView:(UITableView *) atableView cellForRowAtIndexPath:  (NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }

    NSInteger listIndex = [[_searchResultIndices objectAtIndex:[indexPath row]] integerValue];
    // assuming you create a dictionary where the title has the key title
    cell.textLabel.title = [[_items objectAtIndex:listIndex] objectForKey:@"title"];
    return cell;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [_searchResultIndices count];
} 
```

# iphone - Monotouch.Dialog：启用 ScopeBar 时禁用自动搜索

> ID：14551279
> 
> 赞同：2
> 
> 时间：2013-01-27T19:27:38.090
> 
> 标签：iphone, ios, uitableview, xamarin.ios, monotouch.dialog

当我启用**ScopeBar**并在**Monotouch.Dialog控件上连接****SelectedScopeButtonIndexChanged时，设置****EnabledSearch=true**时启用的自动搜索功能被禁用。

 ****以下是它被禁用的方式：

```
 UISearchBar sb = SearchBar;
     if (sb != null)
     {
        sb.ScopeButtonTitles = new string[] { "Girl".t(),"Boy".t(),"All".t() };
        sb.ShowsScopeBar = true;
        sb.SizeToFit();
        // THIS NEXT LINE KILLS SEARCH, remove to make it all work again
        sb.SelectedScopeButtonIndexChanged+= (sender, e) => {Update();};
     } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T20:23:49.970

中断搜索的原因是 DialogViewController 在 UISearchBar 上分配了一个自定义 UISearchBarDelegate。

当您连接到一个事件时，它会破坏委托并将其替换为一个特殊的 UISearchBarDelegate，它将所有委托方法转发给事件。

换句话说，您不能将委托与同一控件上的事件混合和匹配。

一种可能的解决方案（如果您不想修补 MonoTouch.Dialog 本身）是用您自己的自定义 UISearchBarDelegate 替换现有的 sb.Delegate，它可以实现 SearchScope 方法并将其他所有内容转发到之前已经设置的 UISearchBarDelegate。

例如：

```
public class MySearchBarDelegate : UISearchBarDelegate
{
    UISearchBarDelegate original;
    MyDialogViewController dvc;

    public MySearchBarDelegate (MyDialogViewController dvc, UISearchBarDelegate original)
    {
        this.original = original;
    }

    public override void SelectedScopeButtonIndexChanged (UISearchBar searchBar, int selectedScope)
    {
        dvc.Update ();
    }

    public override void OnEditingStarted (UISearchBar searchBar)
    {
        original.OnEditingStarted (searchBar);
    }

    public override void OnEditingStopped (UISearchBar searchBar)
    {
        original.OnEditingStopped (searchBar);
    }

    public override void TextChanged (UISearchBar searchBar, string searchText)
    {
        original.TextChanged (searchBar, searchText);
    }

    public override void CancelButtonClicked (UISearchBar searchBar)
    {
        original.CancelButtonClicked (searchBar);
    }

    public override void SearchButtonClicked (UISearchBar searchBar)
    {
        original.SearchButtonClicked (searchBar);
    }
} 
```****

# c - 包装 GTK+ 函数

> ID：14551280
> 
> 赞同：4
> 
> 时间：2013-01-27T19:27:54.957
> 
> 标签：c, gtk

程序是用C编写的，GUI是用GTK+创建的。算法或什么没有问题，我只是不确定一件事。

我打算包装一些 GTK 函数，这样我可以节省很多源代码行。例如：

```
GtkWidget *gtkwrap_label_markup_new(const gchar *txt)
{
    GtkWidget *label;

    g_assert(txt);

    label = gtk_label_new(NULL);
    gtk_label_set_markup(GTK_LABEL(label), txt);

    return label;
} 
```

我多次使用pango修改的文本，这个包装函数节省了很多代码行。也许这还不错，但是如果有一天其他程序员会读我的代码，那会是什么反应呢？“....gtkwrap_label_markup_new？什么？！”

我只想知道，包装这些功能是否符合标准。我不想看起来像个白痴，我也不想学习一些坏习惯。;)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:33:52.353

引入函数以避免代码重复并没有错。事实上，我想说的恰恰相反，引入抽象可以帮助您更快地开发代码，并降低修复问题或更改设计的成本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T09:41:04.770

如果您有疑问，请查看 GTK 代码。例如，对于[gtk_label_set_markup](http://git.gnome.org/browse/gtk+/tree/gtk/gtklabel.c#n2614)，您会看到处理 str 变量为 NULL 的情况。因此，提出一个断言来检查它可能适合您的应用程序，但我认为这有点矫枉过正。如果您想收到警告，您可能更愿意`g_return_val_if_fail(str != NULL, NULL)`返回 NULL 并在`txt`为 NULL 时打印警告。

但是如果你真的想节省一堆代码，使用[Glade](http://glade.gnome.org/)来设计你的 UI，而不是用纯 C 来构建它。

# ruby-on-rails-3.1 - Ruby On Rails：ActionController::RoutingError 没有路由匹配

> ID：14551284
> 
> 赞同：0
> 
> 时间：2013-01-27T19:28:21.260
> 
> 标签：ruby-on-rails-3.1, rails-routing

我正在使用此[示例在 Ruby on Rails 中上传文件。](https://github.com/tors/jquery-fileupload-rails-paperclip-example) 我有一些路由问题：

错误：

```
ActionController::RoutingError (No route matches {:action=>"show", :controller=>"cars", :locale=>#<Car id: 19, car_name: "bwl",, created_at: "2013-01-27 19:12:13", updated_at: "2013-01-27 19:12:13">}):
  app/models/arraydb.rb:46:in `to_jq_car' 
```

路线.rb：

```
resources :cars
match '/show', :to =>'car#index'

root :to => 'cars#index' 
```

汽车控制器.rb

```
class CarsController < ApplicationController

  def index
    @cars = Car.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @cars.map{|car| car.to_jq_car } }
    end
  end

  def view
    @car = Car.find(params[:id])

    respond_to do |format|
      format.html 
      format.json { render json: @car }
    end
  end

  # GET /uploads/1/edit
  def edit
    @car = Car.find(params[:id])
  end

  def create
    p_attr=params[:car]
    p_attr[:car] = params[:car][:car].first if params[:car][:car].class == Array
    @car = Car.new(p_attr)

    respond_to do |format|
      if @car.save
        format.html {
          render :json => [@car.to_jq_car].to_json,
          :layout => false

        }

        format.json { render json: [@car.to_jq_car].to_json, status: :created, location: @car }
      else
        format.html { render action: "new" }      
        format.json{ render json: {name:(@arraydb.car_name).split(".").first ,error: @car.errors.messages[:car_name]}, :status =>422}

      end
    end
  end

  def destroy
    @car = Car.find(params[:id])

    @car.destroy

    respond_to do |format|
      format.html { redirect_to cars_url }
      format.json { head :no_content }
    end
  end

end 
```

在 car.rb 我有以下功能：

```
 def to_jq_car
    {
      "name" => (read_attribute(:arraydb_name)).split(".").first,
      "url" => car.url(:original),
      "delete_url" => car_path(self),
      "delete_type" => "DELETE",

    }
  end 
```

耙路线：

```
cars GET        (/:locale)/cars(.:format)                                  cars#index {:locale=>/en|de|es|ru|zh_cn|ar/}
POST       (/:locale)/cars(.:format)                                  cars#create {:locale=>/en|de|es|ru|zh_cn|ar/}
new_car GET        (/:locale)/cars/new(.:format)                              cars#new {:locale=>/en|de|es|ru|zh_cn|ar/}
edit_car GET        (/:locale)/cars/:id/edit(.:format)                         cars#edit {:locale=>/en|de|es|ru|zh_cn|ar/}
car GET        (/:locale)/cars/:id(.:format)                              cars#show {:locale=>/en|de|es|ru|zh_cn|ar/}
PUT        (/:locale)/cars/:id(.:format)                              cars#update {:locale=>/en|de|es|ru|zh_cn|ar/}
DELETE     (/:locale)/cars/:id(.:format)                              cars#destroy {:locale=>/en|de|es|ru|zh_cn|ar/}
show            (/:locale)/show(.:format)                                      car#index {:locale=>/en|de|es|ru|zh_cn|ar/}
root            /(:locale)(.:format)                                           cars#index {:locale=>/en|de|es|ru|zh_cn|ar/} 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:37:07.497

刚遇到同样的问题并设法解决了

不确定您的情况是否与我的情况相同，但仍然..

只需检查您的网址是否没有尾随'/'

例如

`http://localhost:3000/properties/`

最后一个'/'在我的情况下没用

# python - 无法使用简单的导入语句从子目录导入 python 模块

> ID：14551285
> 
> 赞同：0
> 
> 时间：2013-01-27T19:28:38.340
> 
> 标签：python

所以我想从一个 python 包中导入一个模块，该包是主脚本所在的子目录。这是目录结构：

```
maindir \
  - main.py
  - modules \
    - __init__.py
    - module.py 
```

我觉得奇怪的是我不能`module.py`用一个简单的导入`import modules.module`，因为当我尝试调用它返回的函数`module.foo()`时。但是，当我这样做时，一切正常，与. 而当位于同一目录下时，一个简单的调用就完全足够了。`main.py``NameError: name 'module' is not defined``import modules.module as module``from modules import module``module.py``main.py``import module``module.foo()`

现在的问题是，为什么会这样？为什么一个简单的`import`语句不足以从包中导入模块而不是脚本所在的目录？还是我做错了什么？非常感谢您的回答，因为我现在很困惑...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:30:30.573

它确实导入了模块，只是不能直接访问其名称。当您这样做`import foo.bar`时，导入的名称是`foo`，并且`bar`只能作为其属性访问。如果这是您想要的，您可以使用这种形式的导入；这就是它的用途。如果您不想这样做，请使用不同形式的 import 语句。

如果您希望能够键入`module`而不是`modules.module`，请`import modules.module as module`按照您找到的方式执行，或者执行`from modules import module`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:36:39.347

当你导入时，你仍然需要使用完整的包语法来使用函数 foo。

下面应该工作

```
import modules.module
modules.module.foo() 
```

一个更好的方法是

```
from modules import module
module.foo() 
```

第三种不太优雅的方式（但与上面完全相同）是：

```
import modules.module as module
module.foo() 
```

# php - 将图像转换为 jpg 和透明度

> ID：14551286
> 
> 赞同：0
> 
> 时间：2013-01-27T19:28:41.867
> 
> 标签：php

我有脚本：

```
$path = "uploads/";

$img = $_FILES['photoimg']['tmp_name'];
$dst = $path . $_FILES['photoimg']['name'];

if (($img_info = getimagesize($img)) === FALSE)
  die("Image not found or not an image");

$width = $img_info[0];
$height = $img_info[1];

switch ($img_info[2]) {
  case IMAGETYPE_GIF  : $src = imagecreatefromgif($img);  break;
  case IMAGETYPE_JPEG : $src = imagecreatefromjpeg($img); break;
  case IMAGETYPE_PNG  : $src = imagecreatefrompng($img);  break;
  default : die("Unknown filetype");
}

$tmp = imagecreatetruecolor($width, $height);
imagecopyresampled($tmp, $src, 0, 0, 0, 0, $width, $height, $width, $height);
imagejpeg($tmp, $dst.".jpg"); 
```

[如何将上传的图像始终转换为 JPG 格式？](https://stackoverflow.com/questions/14550299/how-to-connect-move-uploaded-file-and-imagejpeg)

这工作完美，但如果文件是 png 并且具有透明度，那么我的新图像具有黑色背景。我可以改变这个颜色吗？我想要白色背景。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:32:34.613

以透明度打开 png

```
$src = imagecreatefrompng($img);
imagealphablending($src, true); 
```

在创建空文件时，用白色背景填充它（因为默认的空图像是黑色的）

```
$tmp = imagecreatetruecolor($width, $height);
imagefill($tmp, 0, 0, imagecolorallocate($tmp, 255, 255, 255)); 
```

# c# - 超链接不可点击

> ID：14551287
> 
> 赞同：0
> 
> 时间：2013-01-27T19:29:05.967
> 
> 标签：c#, asp.net, webforms

我在 asp.net 中声明了一个超链接，如下所示；

```
 <asp:HyperLink ID="hyp" runat="server" Text="new user"></asp:HyperLink> 
```

但是，我没有得到下划线链接，我可以单击它并转到新页面。

```
HyperLink hyp = new HyperLink();
hyp.ID = "hyp";
hyp.NavigateUrl = "http://localhost/";
hyp.Visible = true;
Page.Controls.Add(hyp); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:32:22.803

根据[MSDN](http://msdn.microsoft.com/en-us/library/e75sxasw%28v=vs.85%29.aspx)，您还应该设置该`Text`属性。也许您在网页和背后的代码中声明它的方式令人困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:41:52.927

您正在多次定义链接。

第一次是在您的`ASPX`-page 中。这次只设置了`ID`- 和`Text`- 属性。

第二次创建新链接时，这一次您不设置`Text`-property（这是强制性的），使用：

```
HyperLink hyp = new HyperLink();
hyp.ID = "hyp"; 
```

和

```
Page.Controls.Add(hyp); 
```

**您的代码隐藏应该只包含：**

```
hyp.NavigateUrl = "http://localhost/"; 
```

这部分是可选的，但根据您的示例似乎没有必要：

```
hyp.Visible = true; 
```

# css - css 日历 - td 背景对角分割 - 两种颜色

> ID：14551291
> 
> 赞同：3
> 
> 时间：2013-01-27T19:29:39.670
> 
> 标签：css, background, split, html-table

我在 jsfiddle 找到了一个 css 样式的日历，并想在 jsfiddle 添加一些特定的 td 背景，例如对角线[分割](http://jsfiddle.net/Tw5Wa/)。

但结合起来看起来很扭曲[的 jsfiddle](http://jsfiddle.net/9pS3L/)。

HTML：

```
 <table>
  <thead>
  <tr>
      <th colspan="8">
          Oktober 2011
      </th>
  </tr>
  </thead>
  <tbody>
  <tr>
      <th class="cw">KW</th>
      <th>Mo</th>
      <th>Di</th>
      <th>Mi</th>
      <th>Do</th>
      <th>Fr</th>
      <th>Sa</th>
      <th>So</th>
  </tr>
  <tr>
      <td class="cw">39</td>
      <td class="off">26</td>
      <td class="off">27</td>
      <td class="off">28</td>
      <td class="off">29</td>
      <td class="off">30</td>
      <td class="free">1</td>
      <td class="free">2</td>
  </tr>
  <tr>
      <td class="cw">40</td>
      <td class="free">3</td>
      <td class="free">4</td>
      <td class="free">5</td>
      <td class="free">6</td>
      <td class="free">7</td>
      <td class="booked_pm">8</td>
      <td class="booked">9</td>
  </tr>
  <tr>
      <td class="cw">41</td>
      <td class="booked">10</td>
      <td class="booked">11</td>
      <td class="booked">12</td>
      <td class="booked">13</td>
      <td class="booked">14</td>
      <td class="booked_am">15</td>
      <td class="free">16</td>
  </tr>
  <tr>
      <td class="cw">42</td>
      <td class="free">17</td>
      <td class="free">18</td>
      <td class="free">19</td>
      <td class="free">20</td>
      <td class="free">21</td>
      <td class="free">22</td>
      <td class="free">23</td>
  </tr>
  <tr>
      <td class="cw">43</td>
      <td class="free">24</td>
      <td class="free">25</td>
      <td class="free">26</td>
      <td class="free">27</td>
      <td class="free">28</td>
      <td class="free">29</td>
      <td class="free">30</td>
  </tr>
  <tr>
      <td class="cw">44</td>
      <td class="free">31</td>
      <td class="off">1</td>
      <td class="off">2</td>
      <td class="off">3</td>
      <td class="off">4</td>
      <td class="off">5</td>
      <td class="off">6</td>
  </tr>
  </tbody> 
```

CSS：

```
body {
background-color: #f4f4f4; }

table {
-webkit-box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.3);
-ms-box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.3);
-o-box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.3);
box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.3);
border-spacing: 0;
font-family: 'Helvetica Neue';
width: 239px; }

table thead th {
-webkit-border-radius: 1px;
-moz-border-radius: 1px;
-ms-border-radius: 1px;
-o-border-radius: 1px;
border-radius: 1px;
-webkit-box-shadow: inset 0 1px 0 0 #e88486;
-moz-box-shadow: inset 0 1px 0 0 #e88486;
-ms-box-shadow: inset 0 1px 0 0 #e88486;
-o-box-shadow: inset 0 1px 0 0 #e88486;
box-shadow: inset 0 1px 0 0 #e88486;
background-color: #e56568;
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #e56568), color-stop(100%, #bd3f41));
background-image: -webkit-linear-gradient(top, #e56568, #bd3f41);
background-image: -moz-linear-gradient(top, #e56568, #bd3f41);
background-image: -ms-linear-gradient(top, #e56568, #bd3f41);
background-image: -o-linear-gradient(top, #e56568, #bd3f41);
background-image: linear-gradient(top, #e56568, #bd3f41);
border: 1px solid #ac2826;
color: white;
font-size: 13pt;
font-weight: 400;
padding: 8px 0;
text-align: center;
text-shadow: 0 -1px 1px rgba(0, 0, 0, 0.3); }

table tbody th {
-webkit-box-shadow: inset 0 1px 0 0 white;
-moz-box-shadow: inset 0 1px 0 0 white;
-ms-box-shadow: inset 0 1px 0 0 white;
-o-box-shadow: inset 0 1px 0 0 white;
box-shadow: inset 0 1px 0 0 white;
background-color: #f5f5f5;
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #f5f5f5), color-stop(100%, #e8e8e8));
background-image: -webkit-linear-gradient(top, #f5f5f5, #e8e8e8);
background-image: -moz-linear-gradient(top, #f5f5f5, #e8e8e8);
background-image: -ms-linear-gradient(top, #f5f5f5, #e8e8e8);
background-image: -o-linear-gradient(top, #f5f5f5, #e8e8e8);
background-image: linear-gradient(top, #f5f5f5, #e8e8e8);
border-bottom: 1px solid #d4d4d4;
color: #666666;
font-size: 7.5pt;
font-weight: normal;
padding: 4px 0;
text-align: center;
text-shadow: 0 1px 0 #ffffff;
text-transform: uppercase;
width: 34px; }

table tbody th:first-child {
border-left: 1px solid #abb6bf; }
table tbody th:last-child {
border-right: 1px solid #abb6bf; }
table tbody td {
background-color: #fcfdfd;
border-bottom: 1px solid #e2e2e2;
border-left: 1px solid #e2e2e2;
color: #444444;
font-size: 11pt;
font-weight: bold;
height: 27px;
padding: 0;
text-align: center;
width: 34px; }
table tbody td.off {
color: #9ea2a7; }
table tbody td:last-child {
border-right: 1px solid #abb6bf; }
table tbody td:first-child {
border-left: 1px solid #abb6bf; }
table tbody td:not(:last-child) {
-webkit-box-shadow: inset -1px 0 0 0 #eeefef;
-moz-box-shadow: inset -1px 0 0 0 #eeefef;
-ms-box-shadow: inset -1px 0 0 0 #eeefef;
-o-box-shadow: inset -1px 0 0 0 #eeefef;
box-shadow: inset -1px 0 0 0 #eeefef; }

table tbody th.cw {
border-bottom: none; }

table tbody td.cw {
background-color: #e8e8e8;
border-bottom: none;
color: #666666;
font-size: 7.5pt;
font-weight: normal;
text-align: center;
text-shadow: 0 1px 0 #ffffff;
text-transform: uppercase; }

table tbody td.free {
background-color: #007700;
color: #fff; }

table tbody td.booked {
background-color: #c43c35;
color: #fff; }

table tbody td.booked_am, table tbody td.booked_pm {
height: 27px !important;
display: inline-block;
background: transparent; }

table tbody td.booked_am {
line-height: 0%;
width: 0px;
background-color:#007700;
border-top: 27px solid transparent;
border-right: 32px solid #c43c35;
color: #fff; }

table tbody td.booked_pm {
line-height: 0%;
width: 0px;
background-color:#007700;
border-top: 27px solid #c43c35;
border-right: 32px solid transparent;
color: #fff; } 
```

也许你们中的某个人可以提供帮助。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T20:55:37.107

由于您似乎正在使用 CSS3，我已经使用 CSS3 渐变更新了您的小提琴：http: [//jsfiddle.net/9pS3L/1/](http://jsfiddle.net/9pS3L/1/) 这似乎是您想要实现的目标。你应该用你自己的颜色更新它。这是一个不错的渐变工具：[http](http://www.colorzilla.com/gradient-editor/) ://www.colorzilla.com/gradient-editor/ 甚至应该是 IE 兼容的，但会产生水平渐变（虽然没有尝试过......）

你也可以使用 SASS 和 compass，这些都是做 CSS3 的好工具。

尝试用边界做你想要实现的事情是很棘手的，因为这不是首先建立边界的目的。

仅作为示例，webkit 代码：

```
div{
    width:20px;
    height:20px;
    background: -webkit-gradient(linear, left top, right bottom, color-stop(50%,red), color-stop(50%,green));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-15T08:55:00.367

我们可以使用以下概念分割多种颜色

```
table {
    border-collapse: collapse;
}
td {
    border: 1px solid black;
    padding: 5px 10px;
}
td.two-color {
    background-image: -webkit-linear-gradient(left, #fbd304 0%, #fbd304 50%, #ffff00 50%, #ffff00 100%);
    background-image: -moz-linear-gradient(left, #fbd304 0%, #fbd304 50%, #ffff00 50%, #ffff00 100%);
    background-image: -ms-linear-gradient(left, #fbd304 0%, #fbd304 50%, #ffff00 50%, #ffff00 100%);
    background-image: -o-linear-gradient(left, #fbd304 0%, #fbd304 50%, #ffff00 50%, #ffff00 100%);
    background-image: linear-gradient(left, #fbd304 0%, #fbd304 50%, #ffff00 50%, #ffff00 100%);
}

td.three-color {
    background-image: -webkit-linear-gradient(left, red 20%, red 56%, green 60%, yellow 80%);
    background-image: -moz-linear-gradient(left, #1EBFE1 0%, #1EBFE1 50%, #34D12C 50%, #34D12C 100%);
    background-image: -ms-linear-gradient(left, #1EBFE1 0%, #1EBFE1 50%, #34D12C 50%, #34D12C 100%);
    background-image: -o-linear-gradient(left, #1EBFE1 0%, #1EBFE1 50%, #34D12C 50%, #34D12C 100%);
    background-image: linear-gradient(left, #1EBFE1 0%, #1EBFE1 50%, #34D12C 50%, #34D12C 100%);
}

td.multi-color {
  background: linear-gradient(to left, tomato 45%, lightgray 56%, green 33%, yelow 33%);
}

.columns-bg {
  background-image:
    linear-gradient(
      to right, 
      #ff7400,
      #ff7400 33%,
      #fbd304 33%,
      #fbd304 66%,
      #ffff00 66%
    );
}
```

```
<table>
    <tr>
        <td>Lorem ipsum</td>
        <td>Lorem ipsum</td>
    </tr>
    <tr>
        <td>Lorem ipsum</td>
        <td class="two-color">Lorem ipsum</td>
    </tr>
    <tr>
        <td>Lorem ipsum</td>
        <td>Lorem ipsum</td>
    </tr>
    <tr>
        <td class="two-color">Lorem ipsum</td>
        <td class="three-color">Lorem ipsum</td>
    </tr>
</table>
<br/>
<table>
  <tr>
    <td class="columns-bg">
      Two Color Background
    </td>
  </tr>
</table>
```

# .net - 使用 Visual Studio 手动管理依赖项

> ID：14551297
> 
> 赞同：1
> 
> 时间：2013-01-27T19:30:17.957
> 
> 标签：.net, visual-studio-2010, dependency-injection

我正在阅读“.Net 中的依赖注入”，并希望实现所提出的一些想法。坦率地说，我想尝试一个“Poor Mans DI”/无 DI 容器——手动管理依赖项——以便在进入 DI 容器之前更好地理解这些概念。

第 2 章中有一个示例演示了组合根和创建依赖项（和构造函数注入）。基本思想与此类似：

```
Web Project (has CompositionRoot.cs) --> Domain Project <-- DataAccess Project 
```

组合根创建一个 DataAccess 实例并将其传递给域项目类的构造函数——所有依赖项都从 web.config 中读取。

我完全同意上述想法，并同意 Web 项目不应引用 DataAccess 项目。我在这一点上的理解是，Web 项目*确实需要*对 DataAccess 项目的引用才能通过反射创建实例。

我的问题：

1.  我的理解是，我需要将 DataAccess.dll 复制到 Web 项目的 Bin 文件夹中才能构建所有内容。这似乎非常费力，所以我有兴趣设置 Visual Studio 为我做这件事吗？到目前为止，[这就是我所发现的。](https://stackoverflow.com/questions/1980114/how-to-get-visual-studios-build-system-to-understand-unmanaged-dependencies-of-m)

2.  DI Container 如何解决我所描述的问题？** 我还没有查看任何容器，所以我不知道它们是否需要对依赖项项目的硬引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:36:45.967

> 我的理解是，我需要将 DataAccess.dll 复制到 Web 项目的 Bin 文件夹中才能构建所有内容。

既然你有一个单独的`DataAccess.dll`，那么是的。

> 我有兴趣设置 Visual Studio 为我执行此操作

您可以使用预构建事件来执行此操作（在项目属性页面的构建选项卡中）。

*考虑到如果您仍然在做 DI 但在同一个项目*中，您可能不需要这样做。当您在物理上需要单独部署类时，项目应该是*部署单元。*使用名称空间/目录进行*逻辑*分离，您将不会遇到此问题。

> DI Container 如何解决我所描述的问题？

你告诉它。要么在配置时明确，要么使用约定。

# javascript - 从源代码中提取特定的 js 片段

> ID：14551298
> 
> 赞同：0
> 
> 时间：2013-01-27T19:30:18.410
> 
> 标签：javascript, jquery

我正在使用 ajax 获取页面源（成功）。在该源代码中，SCRIPT 标记中有一个特定的脚本，在其中定义了我需要获取的一些数据（var vName = [{...}]）。数据是一个数组，比较大，变量名是固定的。

获取此变量并根据该变量的数据制作某种类似数组的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:39:26.317

如果您成功地将页面源作为文本获取，则可以使用正则表达式搜索该文件的文本。确切的正则表达式取决于您的数据是如何设置的。这里有几个很好的起点：

*   [http://net.tutsplus.com/tutorials/javascript-ajax/you-dont-know-anything-about-regular-expressions/](http://net.tutsplus.com/tutorials/javascript-ajax/you-dont-know-anything-about-regular-expressions/)

*   [http://www.w3schools.com/jsref/jsref_obj_regexp.asp](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)

还有很多资源。如果您控制页面的来源，那么我建议您将要搜索的变量放在一行上。这样您就不必进行任何复杂的解析。

编辑：

此外，您还可以使用`indexOf`字符串的方法来获取变量开始的文本中的索引。那是假设变量名是唯一的。`indexOf`像这样使用：

```
var someString = "hello world";
console.log(someString.indexOf('world')) // This should output 6 
```

# html - 不推荐使用对齐属性

> ID：14551305
> 
> 赞同：6
> 
> 时间：2013-01-27T19:30:56.207
> 
> 标签：html, alignment, deprecated

我不久前发现中心标签已被弃用。可以理解，因为 HTML 用于构建内容，而不是用于格式化。但是为什么 align 属性也被弃用了？属性可用于格式化。我知道CSS可以使用，但不是每个人都知道CSS。更糟糕的是，**text-align:center;** 和**左边距：自动；边距右：自动；**并不总是使对象居中，但使用几乎总是有效的。

这是 W3C 的帖子：http: [//www.w3.org/TR/html4/present/graphics.html#h-15.1.2](http://www.w3.org/TR/html4/present/graphics.html#h-15.1.2)

在我正在使用的网站上，我们使用的是最新的 doctype ()。我应该尽量不使用 align 属性吗？CSS是使对象居中的唯一安全方法吗？我正在努力确保内容在未来是安全的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:32:52.170

是的，应该使用 CSS。我想不出为什么最好使用 HTML 属性而不是 CSS 规则进行对齐的单一原因。如果您不想学习 CSS（这很好），您可能需要考虑使用类似[Twitter Bootstrap](http://twitter.github.com/bootstrap/)的 CSS 框架，尤其是[脚手架](http://twitter.github.com/bootstrap/scaffolding.html)部分。它将为您节省大量时间，让您的网站从一开始就看起来不错，并让您在厌倦默认主题时以一致的方式应用自定义主题。

# maven - 仅 POM 项目构建在詹金斯中消失

> ID：14551310
> 
> 赞同：0
> 
> 时间：2013-01-27T19:31:18.437
> 
> 标签：maven, build, jenkins, continuous-integration

我有一个由 Jenkins 构建的仅 pom 项目。它真正做的唯一一件事就是将它发送到我的仓库。这被其他几个项目使用。出于某种原因，Jenkins 没有保留这些构建。它甚至似乎正在删除工作区。颠覆轮询日志显示：“没有现有的构建。正在安排新的构建。” 这会触发一个新构建，这会触发所有下游项目的新构建。这可能是因为在构建过程中没有生成文件吗？我没有在项目配置中选中“删除旧版本”。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T12:18:29.963

在 Jenkins 中，Subversion 轮询可以从主节点或从节点进行。默认情况下，为了减少主服务器上的负载（因为轮询比来自 Subversion 服务器上的 PostCommit 挂钩的推送通知更耗费资源 - 即推荐的方式）默认是从从属服务器轮询。

如果您使用虚拟机从属池，或定期清除从属工作区等。那么基于从属的轮询将必须进行结帐才能完成（我认为，但我不确定，这是因为`svn:external`条目可能会被取消固定因此触发更新......但这听起来很愚蠢）

您可以通过在 Jenkins 中设置以下系统属性来将默认设置更改为 master：

```
hudson.scm.SubversionSCM.pollFromMaster=true 
```

您将需要重新启动 Jenkins 以获取更改。

如果您想使用 Groovy 控制台，您可以将更改应用到正在运行的 Jenkins 实例...我认为以下内容将通过更改来修复我可能出现的语法错误：

```
import jenkins.model.*
import hudson.scm.*
Jenkins.instance.items.each { job ->
    if (job.scm instanceof SubversionSCM) { 
        job.scm.setPollFromMaster(true);
    }
} 
```

虽然我应该指出，groovy 脚本只会在下次重新启动 Jenkins 之前进行更改，因为它调整的字段是暂时的。

# ilmerge - 将 .dll 与 .exe 合并

> ID：14551311
> 
> 赞同：4
> 
> 时间：2013-01-27T19:31:19.080
> 
> 标签：ilmerge

我正在尝试将 CabalMain.exe 与我下载的 ilmerge 的 crckd.dll 合并，然后进入 >Program giles (x86)>Microsoft > Ilmerge 我这样做了。

```
 C:\Program Files (x86)\Microsoft\ILMerge>ilmerge CabalMain.exe crckd.dll /out:me
    rged.exe
    An exception occurred during merging:
    ILMerge.Merge: Could not load assembly from the location 'C:\Program Files (x86)
    \Microsoft\ILMerge\CabalMain.exe'. Skipping and processing rest of arguments.
       at ILMerging.ILMerge.Merge()

   at ILMerging.ILMerge.Main(String[] args) 
```

谁能帮我理解我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:32:48.190

您需要指定要合并的文件的完整路径，而不仅仅是它们的名称。否则，ILMerge 将在安装它的同一目录中查找：

```
C:\Program Files (x86)\Microsoft\ILMerge>ilmerge C:\path\to\your\program\CabalMain.exe C:\path\to\your\program\crckd.dll /out:C:\path\to\your\program\merged.exe 
```

您可能还想在 out 上指定一个路径，否则它将尝试将其写入 Program Files（由于权限而很有可能失败）。

# python - serializer.save() 导致 creation_counter 错误

> ID：14551319
> 
> 赞同：1
> 
> 时间：2013-01-27T19:32:09.373
> 
> 标签：python, django, api, django-rest-framework

我按照 Rest-Framework Tutorial 并按照序列化程序模型的描述设置了我的 api。该`serializer.is_valid()`方法返回 true，并且在打印 serializer.data 和 serializer.object 时，它看起来应该是这样。

但是当我打电话时，`serializer.save()`我收到以下错误消息：

> “str”对象没有属性“creation_counter”

有没有人遇到过同样的问题或有任何想法如何解决它或为什么会出现这个问题？

我的观点是这样的：

```
@csrf_exempt 
def executeRegister(request):

if request.method == 'POST':

    data = JSONParser().parse(request)
    serializer = RegistrationSerializer(data=data)

    if serializer.is_valid():
        serializer.save()

        return JSONResponse(serializer.data, status=201)
    else:
        return JSONResponse(serializer.errors, status=400)
else:
    return HttpResponse(status=404) 
```

# yii - 如何在 Yii 中使用 YUI 3？

> ID：14551324
> 
> 赞同：1
> 
> 时间：2013-01-27T19:32:39.307
> 
> 标签：yii, yui

如何在 Yii 框架中使用 YUI 3？我在互联网上搜索，我找不到任何东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T08:11:48.883

你可以使用 Yii 加载任何 javascript 库。您可以像这样将它添加到您的布局中（很可能`protected/views/layouts/main.php`）：

```
<?php Yii::app()->clientScript->registerScriptFile(Yii::app()->request->baseUrl.'/js/yui/yui-min.js', CClientScript::POS_HEAD); ?> 
```

假设您的 YUI 库位于`js/yui/yui-min.js`. 现在，这会将 js 文件加载到使用该布局的每个视图的 head 部分。

然后，您可以正常使用它。请记住，jQuery 是内置在 Yii 中的，因此您可能会遇到 jQuery 和 YUI 之间的兼容性问题。查看jQuery 网站上的[**这篇文章以获取更多信息。**](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

我还建议在[**这里查看 Yii CClientScript 文档**](http://www.yiiframework.com/doc/api/1.1/CClientScript)。CClientScript 类管理 Yii 中视图的 JavaScript 和 CSS 样式表。

# scala - Play 2.1 JSON to Scala object

> ID：14551326
> 
> 赞同：5
> 
> 时间：2013-01-27T19:32:45.157
> 
> 标签：scala, playframework-2.0, playframework-2.1

I have a Scala case class

```
case class Example(name: String, number: Int) 
```

and a companion object

```
object Example {
  implicit object ExampleFormat extends Format[Example] {
    def reads(json: JsValue) = {
      JsSuccess(Example(
       (json \ "name").as[String],
       (json \ "number").as[Int]))
     }

     def writes(...){}
   }
} 
```

which converts JSON to Scala object.

When JSON is valid (i.e. `{"name":"name","number": 0}` it works fine. However, when `number` is in quotes `{"name":"name","number":"0"}` I get an error: `validate.error.expected.jsnumber`.

Is there a way to implicitly convert `String` to `Int` in such a case (assuming that the number is valid) ?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T20:43:47.340

You can easily handle this case with the Json combinators, thanks to the [`orElse`](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/libs/json/Reads.scala#L46) helper. I rewrote your json formater with the new syntax introduced by Play2.1

```
import play.api.libs.json._
import play.api.libs.functional.syntax._

object Example {
  // Custom reader to handle the "String number" usecase
  implicit val reader = (
    (__ \ 'name).read[String] and
    ((__ \ 'number).read[Int] orElse (__ \ 'number).read[String].map(_.toInt))
  )(Example.apply _)

  // write has no specificity, so you can use Json Macro
  implicit val writer = Json.writes[Example] 
}

object Test extends Controller {
  def index = Action {
    val json1 = Json.obj("name" -> "Julien", "number" -> 1000).as[Example]
    val json2 = Json.obj("name" -> "Julien", "number" -> "1000").as[Example]
    Ok(json1.number + " = " + json2.number) // 1000 = 1000
  }
} 
```

# c# - 在 PHP 中从 C# 复制相同的 AES 加密

> ID：14551332
> 
> 赞同：4
> 
> 时间：2013-01-27T19:33:04.243
> 
> 标签：c#, php, encryption, aes

我正在做一个项目，我有一个 C# 应用程序，它有一个加密类，可以执行字符串值的加密和解密。我现在想使用 PHP 制作一个 Web 界面来与我的 C# 应用程序一起工作。

我正在尝试执行与我的 C# 项目在我的 PHP 网站中执行的相同类型的加密，但我无法弄清楚我需要做什么。

下面是我的 C# 应用程序的代码。

```
public static string encrypt(string encryptionString)
        {
            byte[] clearTextBytes = Encoding.UTF8.GetBytes(encryptionString);

            SymmetricAlgorithm rijn = SymmetricAlgorithm.Create();

            MemoryStream ms = new MemoryStream();
            byte[] rgbIV = Encoding.ASCII.GetBytes("PRIVATE");

            byte[] key = Encoding.ASCII.GetBytes("PRIVATE");
            CryptoStream cs = new CryptoStream(ms, rijn.CreateEncryptor(key, rgbIV), CryptoStreamMode.Write);

            cs.Write(clearTextBytes, 0, clearTextBytes.Length);

            cs.Close();

            return Convert.ToBase64String(ms.ToArray());
        } 
```

我正在我的 PHP Web 界面中尝试以下代码

```
define("CIPHERKEY", "PRIVATE");
function encrypt($data) 
    { 
        //$cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_256, '', MCRYPT_MODE_ECB, '');
        $cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_ECB, '');
        //$iv = mcrypt_create_iv(mcrypt_enc_get_iv_size($cipher), MCRYPT_RAND);
        $iv = 'PRIVATE';
        //$key = substr(CIPHERKEY, 0, mcrypt_enc_get_key_size($cipher));
        $key =CIPHERKEY;
        if (mcrypt_generic_init($cipher, $key, $iv) != 1) 
        {
            $cipherData = mcrypt_generic($cipher, $data);

            mcrypt_generic_deinit($cipher);
            mcrypt_module_close($cipher);

            $sanitizedCipherData = trim(base64_encode($cipherData)); 

            return $sanitizedCipherData;
        } 
    } 
```

我尝试了各种变体，但找不到正确的方法。

iv 变量使用与 C# 应用程序中的 rgbIV 变量相同的密钥，PHP Web 界面中的 CIPHERKEY 使用与我的 c# 应用程序中的密钥变量相同的密钥。

感谢您的任何帮助，您可以提供

**更新** 目前我不断得到不同的结果。我通过传入字符串来测试它`password`。

在上面的 PHP 代码中，我得到`NHHloywxlybbANIH5dS7SQ==`了加密字符串。

但是，使用相同的字符串，我得到的结果是`n86Mwc5MRXzhT3v3A/uxEA==`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:43:20.427

您得到不同结果的原因是默认情况下，C# 中的密码模式是 CBC，而在 PHP 中您使用的是 ECB 模式，有关两种不同模式的信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation)。

CBC 比 ECB 更安全，因此我建议坚持使用默认的 .NET 实现并更改您的 PHP 代码以使用 CBC，但是您有两种选择。

**选项 1** - 更改 .NET 以使用 ECB 模式（如果您有一些遗留代码并且需要使用它）但是请阅读它，ECB 模式会在您的密文中留下伪影，并使攻击者能够了解什么您已加密（请参阅维基百科文章中的企鹅图像）。

要更改 .NET 代码以使用 ECB，只需为模式添加一行：

```
// Start of your code ...
SymmetricAlgorithm rijn = SymmetricAlgorithm.Create();
rijn.Mode = CipherMode.ECB;

MemoryStream ms = new MemoryStream();
byte[] rgbIV = Encoding.ASCII.GetBytes("PRIVATE");
// Rest of your code ... 
```

**选项 2** - 更改 PHP 脚本以使用 CBC 模式

```
$cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_CBC, ''); 
```

**更新** 我更详细地检查了这一点，发现您还需要在明文中添加填充。以下代码将为您提供匹配项：

**PHP代码：**

```
function encrypt($data) 
{ 
    $iv = "AAAAAAAAAAAAAAAA";
    $key = CIPHERKEY;

    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, addpadding($data), MCRYPT_MODE_CBC, $iv));
}

function addpadding($string, $blocksize = 16)
{
    $len = strlen($string);
    $pad = $blocksize - ($len % $blocksize);
    $string .= str_repeat(chr($pad), $pad);
    return $string;
} 
```

C# 代码将自动添加基于 PKCS7 的填充。

**更新 2**剥离填充：如评论中所述，解密后需要剥离填充。

```
function strippadding($string)
{
    $slast = ord(substr($string, -1));
    $slastc = chr($slast);
    $pcheck = substr($string, -$slast);
    if(preg_match("/$slastc{".$slast."}/", $string)){
        $string = substr($string, 0, strlen($string)-$slast);
        return $string;
    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:41:01.523

**试试这个：**

```
 function encrypt_str($str) 
    {
    $iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_ECB), MCRYPT_DEV_URANDOM);
    $encrypted = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, "PRIVATE", $str, MCRYPT_MODE_ECB, $iv);
    return rtrim($encrypted);
    } 
```

**并将其添加到您的 C#**

```
rijn.Mode = CipherMode.ECB; 
```

# jquery - JQuery DateTimePicker 添加小时

> ID：14551333
> 
> 赞同：1
> 
> 时间：2013-01-27T19:33:06.423
> 
> 标签：jquery, jquery-ui, datepicker

我正在使用以下代码`datepicker`from`jquery`来从日历中获取日期。当我为第一个字段选择日期时，该日期和时间也将输入到第二个字段中。

我需要的只是在第二个字段中输入日期和时间并加上 10 小时（addHours(10)）。我尝试了一些选项，但没有成功。您能否建议将代码放在哪里`.addHours(10)`，以便在第二个字段中获得结果？

```
var startDateTextBox = $('#rest_example_4_start');
var endDateTextBox = $('#rest_example_4_end');

startDateTextBox.datetimepicker({ 
    onClose: function(dateText, inst) {
        if (endDateTextBox.val() != '') {
            var testStartDate = startDateTextBox.datetimepicker('getDate');
            var testEndDate = endDateTextBox.datetimepicker('getDate');

            if (testStartDate > testEndDate)
                endDateTextBox.datetimepicker('setDate', testStartDate);
        } else {
            endDateTextBox.val(dateText);
        }
    },
    onSelect: function (selectedDateTime) {
        endDateTextBox.datetimepicker('option', 'minDate',  startDateTextBox.datetimepicker('getDate'));        
    }
});

endDateTextBox.datetimepicker({ 
    onClose: function(dateText, inst) {
        if (startDateTextBox.val() != '') {
            var testStartDate = startDateTextBox.datetimepicker('getDate');
            var testEndDate = endDateTextBox.datetimepicker('getDate');

            if (testStartDate > testEndDate)
                startDateTextBox.datetimepicker('setDate', testEndDate);
        }
        else {
        startDateTextBox.val(dateText);
        }
    },
    onSelect: function (selectedDateTime){
        startDateTextBox.datetimepicker('option', 'maxDate', endDateTextBox.datetimepicker('getDate')) 
        startDateTextBox.addHours(10);
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:59:03.640

我不确定，但根据您的输入，我认为下面的脚本将解决您的问题，请提供一个`jsFiddle`更好的跟踪它。

```
$('#txtName').change(function() {
  var date2 = $('#txtName').datepicker('getDate'); 
  date2.setHours(date2.getHours()+10); 
    //alert(date2);
  $('#txtRes').val(date2);
}); 
```

[JSFiddle 演示](http://jsfiddle.net/MKK2V/)

**更新** ：[与](http://jsfiddle.net/q9TGc/)`datetimepicker`.

```
 var date2 = $('#rest_example_4_start').datetimepicker('getDate'); 
  date2.setHours(date2.getHours()+10); 
  $('#rest_example_4_end').datetimepicker('setDate', date2);
}); 
```

# jquery - 将请求发布到外部服务器并使用 Jquery 取回 Json

> ID：14551342
> 
> 赞同：0
> 
> 时间：2013-01-27T19:34:16.720
> 
> 标签：jquery, django, post, external

所以，我不知道该怎么做。我想通过 post 将一些数据发送到外部服务器，并使用 jQuery 获取一些 Json。感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:42:22.570

以下是我个人在一个项目中实现的示例。

**查看代码：**

```
 var ConsVal = $("#DropDownList_Constituency").val();
        var pollingDatalink = '<%: Url.Action("getConstituencyData", "Home") %>';
        $.ajax({
            url: pollingDatalink,
            type: 'post',
            datatype: 'JSON',
            data: { consitID: ConsVal },
            success: function (data) {
                $("#NoOfMaleVoters").html(data[0].VOTERS_M_TOTAL == null ? 0 : data[0].VOTERS_M_TOTAL );
                $("#NoOfFemaleVoters").html(data[0].VOTERS_F_TOTAL  == null ? 0 : data[0].VOTERS_F_TOTAL );
                $("#NoOfTotalVoters").html(data[0].VOTERS_TOTAL == null ? 0 : data[0].VOTERS_TOTAL );
            }
        }); 
```

**控制器代码：**

```
[HttpPost]
    public JsonResult getConstituencyPolledDataXVII(int? consitID)
    {
        var total = db.CONSTITUENCY_NA_RESULT_SUMMARY.Where(x => x.CONST_NA_CODE == consitID.Value).Select(x => new { x.TOTAL_VALID_VOTES, x.TOTAL_REJECTED_VOTES, x.TOTAL_TENDERED_VOTES});
        return Json(total);
    } 
```

有关详细信息，请访问[jquery 站点](http://api.jquery.com/)并搜索 $.ajax() 函数。

# symfony - 从另一个 Twig 函数调用 Twig 函数

> ID：14551344
> 
> 赞同：1
> 
> 时间：2013-01-27T19:34:25.780
> 
> 标签：symfony, twig

我有一条需要很多参数的路径：

```
{{ path('work_path', {'username': work.user.username, 'work_id': work.id, 'work_slug': work.slug}) }} 
```

我不想在任何地方都使用这条长线，我只想为这条路径提供一个特定的功能。

有没有办法`path()`从我的自定义函数中调用该函数（除了将*路由器*服务传递给扩展类）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:37:09.573

作为一种可能的解决方案，您可能有兴趣编写自己的[twig 宏](http://twig.sensiolabs.org/doc/tags/macro.html)。

# c# - 在 WebClient 中接受 Cookie？

> ID：14551345
> 
> 赞同：17
> 
> 时间：2013-01-27T19:34:32.863
> 
> 标签：c#, html, cookies, webclient

我刚开始尝试 C# `WebClient`。我所拥有的是下面的代码，它从网站获取 html 代码并将其写入 .txt 文件。我唯一的问题是某些网站要求您在使用该网站之前接受 cookie。这导致不是将真正的网站 html 代码写入 .txt 文件，而是写入 cookie 弹出 html 代码。

代码：

```
string downloadedString;
System.Net.WebClient client;

client = new System.Net.WebClient();

//"http://nl.wikipedia.org/wiki/Lijst_van_spelers_van_het_Nederlands_voetbalelftal"
downloadedString = client.DownloadString(textBox1.Text);

using (StreamWriter write = new StreamWriter("Data.txt"))
{
    write.Write(downloadedString);
} 
```

那么解决这个问题的方法是什么？有人可以指导我走向正确的道路吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-27T19:41:18.403

用法 ：

```
 CookieContainer cookieJar = new CookieContainer();
        cookieJar.Add(new Cookie("my_cookie", "cookie_value", "/", "mysite"));

        CookieAwareWebClient client = new CookieAwareWebClient(cookieJar);

        string response = client.DownloadString("http://example.com/response_with_cookie_only.php"); 
```

* * *

```
public class CookieAwareWebClient : WebClient
{
    public CookieContainer CookieContainer { get; set; }
    public Uri Uri { get; set; }

    public CookieAwareWebClient()
        : this(new CookieContainer())
    {
    }

    public CookieAwareWebClient(CookieContainer cookies)
    {
        this.CookieContainer = cookies;
    }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);
        if (request is HttpWebRequest)
        {
            (request as HttpWebRequest).CookieContainer = this.CookieContainer;
        }
        HttpWebRequest httpRequest = (HttpWebRequest)request;
        httpRequest.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate;
        return httpRequest;
    }

    protected override WebResponse GetWebResponse(WebRequest request)
    {
        WebResponse response = base.GetWebResponse(request);
        String setCookieHeader = response.Headers[HttpResponseHeader.SetCookie];

        //do something if needed to parse out the cookie.
        if (setCookieHeader != null)
        {
            Cookie cookie = new Cookie(); //create cookie
            this.CookieContainer.SetCookies(request.RequestUri, setCookieHeader);
        }

        return response;
    }
} 
```

您将看到 GetWebRequest 和 GetWebResponse 的两个重写方法。可以重写这些方法来处理 cookie 容器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-25T09:51:11.133

只需将标头中的 cookie 字符串存储到本地会话 _cookies 字符串中

```
if (System.Web.HttpContext.Current.Session["cookie"] != null)
            _cookies = System.Web.HttpContext.Current.Session["cookie"].ToString(); 

     using (WebClient wc =  new WebClient())
        {

            wc.Headers.Add("Cookie", _cookies);
             string HtmlResult = wc.UploadString(bridge_url, myParameters);
            _cookies = wc.ResponseHeaders["Set-Cookie"];
            Debug.WriteLine("Headers" + _cookies); 

            System.Web.HttpContext.Current.Session["cookie"] = _cookies;

        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T19:40:41.587

这可能与[如何让 WebClient 使用 Cookie？](https://stackoverflow.com/questions/2825377/how-can-i-get-the-webclient-to-use-cookies)

我上面提到的问题是针对 VB.NET，但对于 C#，机制应该是相同的。我怀疑您看到的行为是网站正在发送 cookie，然后请求返回，但您的客户端未设置为将 cookie 返回到服务器，因此它将其解释为您“不接受 cookie”。

您是否使用过 Fiddler 之类的分析工具来分析与客户交流的内容？

您可能还必须发送一个特定的 HTTP 标头来表明您接受 cookie，但我不记得在我过去的经验中这是必需的。

# performance - 一张大表的 Postgresql 性能？

> ID：14551348
> 
> 赞同：4
> 
> 时间：2013-01-27T19:35:20.260
> 
> 标签：performance, postgresql

我有一个关于数据库设计的基本问题。我们有一个 postgresql 数据库，其中一个表比其他表大得多。这是一个审计跟踪，记录我们软件中的任何和所有更改。这样做不聪明吗？将其存储在另一个数据存储（redis）或另一个数据库中会更好吗？或者 Postgresql 是否以大表不会影响其他表的读取性能的方式处理这个问题。postgres 如何知道要在内存中缓存哪些数据等。

对于这样一个基本而模糊的问题，我很抱歉，我不知道该怎么问这个问题。我只是不想走下去，一年后，我们遇到了严重的数据库性能问题，因为我们的一个表是 50gb，而数据库的其余部分小于 1gb。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:44:16.280

我们使用表分区（使用 PostgreSQL[继承](http://www.postgresql.org/docs/current/static/tutorial-inheritance.html)），一个月的数据分区约为 150GB。表的大小并不那么重要，它与您的查询和用于这些查询的索引有关。

在处理性能时，您应该始终使用真实数据、真实查询、EXPLAIN 和 EXPLAIN ANALYZE。没有这个，这将是一个幸运的镜头。

# trigger.io - Forge.ui.enhanceInput - 在 touchStart 上激活？干扰滚动

> ID：14551349
> 
> 赞同：2
> 
> 时间：2013-01-27T19:35:27.437
> 
> 标签：trigger.io

我正在使用 forge.ui.enhanceAllInputs() 在 Android 上获取本机日期选择器

但是，它会导致滚动问题。如果您在页面上触摸并拖动以滚动，如果您的手指从增强的字段开始，日期选择器会立即显示。它没有时间滚动。

所以实际上你去滚动页面，但最终无意中出现了一个日期选择器。

似乎在 touchStart 上调用了日期选择器，而在 touchEnd 上可能会提供预期的体验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:57:26.733

我们平台的 v1.4.31 对此进行了修复 - 请参阅[http://docs.trigger.io/en/v1.4/release-notes.html](http://docs.trigger.io/en/v1.4/release-notes.html)

# jquery - 用户单击缩略图时切换图像

> ID：14551351
> 
> 赞同：0
> 
> 时间：2013-01-27T19:35:36.140
> 
> 标签：jquery, gallery, slideshow, image-gallery

好了朋友们。当用户单击较小的缩略图图像时，我希望切换较大的显示图像。

这是我的 jquery 脚本，但到目前为止它没有切换。单击缩略图时没有任何反应。

这很奇怪，因为我有两个箭头图像，在单击时会滑动缩略图，但由于某种原因，在单击实际拇指时不会。到底是怎么回事？

查询：

```
$(document).ready(function () {

    // when image with ID thumb is clicked change src 
    $("img#thumb").click(function () {              
        var imgpath = $(this).attr("src");
        $("img#cover").attr("src", imgpath);
    });

    // slide more thumbnails 
    $("#arrowright").click(function () {
        $("#innerthumb").animate({ marginLeft: "-850px" });
    });

    $("#arrowleft").click(function () {
        $("#innerthumb").animate({ marginLeft: "0px" });
    });

    // image change on click
    $("img#thumb").click(function () {
        var newimg = $(this).attr("src");
        $("img#cover").attr("src", newimg);
    }); 
```

HTML

```
 <div id="mainimage">
                        <div id="inner">
                            <img id="cover" src="images/environments/img0.jpg" width="980px" />
                            <img id="cover-old" src="" width="980px"/>
                        </div>
                    </div> <!--end of mainimage div-->

               <div id="arrowleft"><img src="images/arrowleft.png"></div>
                   <div id="innerthumb">
               <div id="thumb1" ><img id="thumb" src="images/environments/img0.jpg" width="160px" height="80px"/></div>
               <div id="thumb2" ><img id="thumb" src="images/environments/img1.jpg" width="160px" height="80px" /></div>
               <div id="thumb3" ><img id="thumb" src="images/environments/img2.jpg" width="160px" height="80px" /></div>
                   <div id="innerthumb"></div>
               <div id="arrowright"><img src="images/arrowright.png"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T05:59:04.267

您不应该在同一页面中有具有相同 id 的 img。这会导致 jquery 选择器出现问题。

要解决您的问题，您必须将 img id 更改为 t1, t2, t3 并设置一个 class=thumb 然后在 jquery 部分执行类似这样的操作

```
$("img.thumb").click(function () {
    var id = $(this).attr("id");
    var newimg = $("#"+id).attr("src");
    $("img#cover").attr("src", newimg);
}); 
```

# c#-4.0 - 格式化段落中的文本

> ID：14551352
> 
> 赞同：0
> 
> 时间：2013-01-27T19:35:42.463
> 
> 标签：c#-4.0

从未格式化的文本段落开始，我想让这些行“连续”（即删除换行符）。在下一段中，在前面的文本的第一行中有额外的（“空闲”）空格。

这是我的代码：

```
 private String FormateContent(String content)
    {
        StringBuilder sb = null;
        content = content.Replace(evaluationString, String.Empty);
        content = content.Trim().Trim('\r').Trim('\n').Trim('\t');

        if (content.Trim() != String.Empty)
        {
            sb = new StringBuilder();
            String[] bodyLines = content.Split(new String[] { Environment.NewLine, "\n" }, StringSplitOptions.None);
            for (int i = 0; i < bodyLines.Length; i++)
            {
                if (bodyLines[i].Trim() != String.Empty)
                {
                    sb.Append(bodyLines[i]);
                }

            }
            content = sb.ToString();
            //  content = content.Split(new String[] { Environment.NewLine, "." }, StringSplitOptions.None).ToString();

        }

        return content;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T21:27:00.757

我认为你的主要问题是这段代码：

```
if (bodyLines[i].Trim() != String.Empty)
{
    sb.Append(bodyLines[i]);
} 
```

您正在测试修剪后的字符串，但随后将未修剪的字符串添加到`StringBuilder`. 我想你想要的是：

```
string trimmedLine = bodyLines[i].Trim();
if (trimmedLine != string.Empty)
{
    sb.Append(trimmedLine);
} 
```

# c++ - fread() 或 fseek() 在 win32 上失败，但在 mac32 上失败

> ID：14551353
> 
> 赞同：0
> 
> 时间：2013-01-27T19:36:02.333
> 
> 标签：c++

如果它在 mac32 上运行，它运行良好；如果我在 win32 上运行它，我会在 139 像素处得到一个意外的文件结尾，如果我注释掉 fseek （在我的测试 .tga 图像中它只会寻找 0 字节，所以不应该有区别）我得到在像素 35 处文件意外结束。但标题读取完全正常；这只是数据。

对于不同的编译器/架构，这 2 个函数是否以不同的方式实现？

```
struct TGAHeader
{   
    char    idlength;
    char    colourmaptype;
    char    datatypecode;
    short   colourmaporigin;
    short   colourmaplength;
    char    colourmapdepth;
    short   x_origin;
    short   y_origin;
    short   width;
    short   height;
    char    bitsperpixel;
    char    imagedescriptor;
};    

bool read()
{
    printf("Reading TGA file...\n");

    header.idlength = fgetc(TGAFile);
    header.colourmaptype = fgetc(TGAFile);
    header.datatypecode = fgetc(TGAFile);
    fread(&header.colourmaporigin,2,1,TGAFile);
    fread(&header.colourmaplength,2,1,TGAFile);
    header.colourmapdepth = fgetc(TGAFile);
    fread(&header.x_origin,2,1,TGAFile);
    fread(&header.y_origin,2,1,TGAFile);
    fread(&header.width,2,1,TGAFile);
    fread(&header.height,2,1,TGAFile);
    header.bitsperpixel = fgetc(TGAFile);
    header.imagedescriptor = fgetc(TGAFile);

    printf("...TGA file has been read\n\n");
    printf("ID length:         %d\n",header.idlength);
    printf("Colourmap type:    %d\n",header.colourmaptype);
    printf("Image type:        %d\n",header.datatypecode);
    printf("Colour map offset: %d\n",header.colourmaporigin);
    printf("Colour map length: %d\n",header.colourmaplength);
    printf("Colour map depth:  %d\n",header.colourmapdepth);
    printf("X origin:          %d\n",header.x_origin);
    printf("Y origin:          %d\n",header.y_origin);
    printf("Width:             %d\n",header.width);
    printf("Height:            %d\n",header.height);
    printf("Bits per pixel:    %d\n",header.bitsperpixel);
    printf("Descriptor:        %d\n",header.imagedescriptor);

    bytesToRead = header.bitsperpixel / 8;

    if(!errCheck())
    {
        m_bLoaded = false;
        return false;
    }
    //set stream position indicator to the start of the data
    fseek(TGAFile,(header.idlength+(header.colourmaptype * header.colourmaplength)),SEEK_CUR);

    //allocate space to store data
    releaseTGAData();
    pixelData = new unsigned char*[header.width*header.height];
    for(int i=0;i<header.width*header.height;i++)
        pixelData[i] = new unsigned char[bytesToRead];

    for(int i=0;i<header.width * header.height;i++)
    {
        if (fread(pixelData[i],1,bytesToRead,TGAFile) != bytesToRead)
        {
            printf("Unexpected end of file at pixel %d\n",i);
            m_bLoaded = false;
            releaseTGAData();
            return false;
        }
    }
    fclose(TGAFile);

    return true;
} 
```

编辑：这是加载功能

```
bool load(const char* inFilename = NULL)
{
    m_bLoaded = false;
    if(NULL!=filename)
        delete [] filename;
    filename = new char[128];

    //if the filename has not been selected by the programmer
    if(NULL==inFilename)
    {
        //ask the user for it
        printf("please enter the filename of an uncompressed TGA file:\n");
        scanf("%s", filename);
    }
    else sprintf(filename, inFilename);

    if ((TGAFile = fopen(filename,"r")) == NULL)
    {
        printf("File open failed, please try again\n");
        return false;
    }
    if(!read())
        return false;

    m_bLoaded=true;
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:41:04.033

问题是您以*文本模式*打开文件。在 Windows 上，输入函数会将字节序列`0x0d 0x0a`（即 Windows 换行序列`"\r\n"`）转换为单个字符。

Windows 很可能还会检查字节`0x19`（我认为），它是`CTRL`-`Z`并且是 Windows 中的文件结尾字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:42:06.577

您的问题很可能是由于处理非二进制文件时 Windows 处理从文件读取的方式不同引起的，但更有效的解决方案是使用 #pragma pack 或**属性**(alaligned(1)) 作为标头结构并读取一个 fread 调用中的整个标题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T19:44:40.570

由于该文件包含二进制数据，因此您必须在 Windows 上`"rb"`的调用中使用作为打开模式。`fopen()`在 Unix 上，这`b`是可选的（但无害），因此如果您的代码是可移植的，请在两个系统上使用相同的模式。

如果您在 Windows 上打开文件而不指定`b`，您将获得 'CRLF' 映射（因此回车换行序列`"\r\n"`映射到换行符`"\n"`- 其中换行符只是换行符的另一个名称）。第一个 control-Z 字节标记文件的结尾。

# ruby-on-rails - rails sprockets 获取资产摘要

> ID：14551356
> 
> 赞同：1
> 
> 时间：2013-01-27T19:36:39.767
> 
> 标签：ruby-on-rails, asset-pipeline, sprockets, digest

在 ralis 中获取资产摘要的最简单方法是什么？

例如这里是 javascript 文件

```
javascript_path "jquery.js" 
```

我想知道这个的摘要是什么`jquery.js`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T20:29:49.007

您可以使用公开的环境对象`Rails.application.assets`来获取有关您的资产的更多信息，如下所示：

```
Rails.application.assets['jquery'].digest # => "a7570eab23993d2a207ddaa1b55756c6"
Rails.application.assets['jquery'].digest_path # => "jquery-a7570eab23993d2a207ddaa1b55756c6.js" 
```

# c# - 将 XML 数据读取到 StackPanel 控件

> ID：14551357
> 
> 赞同：1
> 
> 时间：2013-01-27T19:36:41.507
> 
> 标签：c#, xml, windows-phone-7, binding, isolatedstorage

我想从隔离存储中的 XML 文件加载数据。然后我有可变的特定索引号，即 XML 元素索引。在这里我有一个问题，因为我想从这个元素加载 TextBoxes（在普通 StackPanel 中）值。我尝试绑定并将其放入列表框中，但随后我无法从该框中读取文本，因为它是列表框项目。只是我想将元素属性加载到文本框，然后我想在这个文本框中阅读编辑过的文本。这是示例 xml 元素：

```
<person index="1" att1="qwerty" att2="azerty" att3="abcdef"/> 
```

这是 Xaml 代码：

```
<StackPanel x:Name="stack">
 <TextBlock Height="27" Margin="0,0,0,0" Grid.Row="1" TextWrapping="Wrap" Text="Record index:" VerticalAlignment="Top" Foreground="#FF6C6C6C"/>
 <TextBox Text="{Binding Index}" x:Name="index_box_det" Height="65" Margin="-12,-10,0,0" Grid.Row="1" TextWrapping="Wrap" VerticalAlignment="Top" Foreground="#FF40AA2F" HorizontalAlignment="Left" Width="467" SelectionBackground="#FF40AA2F" SelectionForeground="White" BorderBrush="#FF3FA92E" FontSize="18.667"/>
</StackPanel> 
```

我试过这个：

```
var ind = "1";
        using (IsolatedStorageFile isoStore = IsolatedStorageFile.GetUserStoreForApplication())
        {
            using (IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream("People2.xml", FileMode.Open, isoStore))
            {
                XDocument loadedCustomData = XDocument.Load(isoStream);
                var filteredData = from c in loadedCustomData.Descendants("person")
                                   where c.Attribute("index").Value == ind
                                   select new Person()
                                   {
                                       index= c.Attribute("index").Value,
                                       att1= c.Attribute("att1").Value,
                                       att2= c.Attribute("att2").Value,
                                       att3= c.Attribute("att3").Value
                                   };
                stack.DataContext = filteredData;
            } 
```

但正如你所想，它不起作用。有人有想法将此值加载到文本框吗？

编辑：我试过这个：

```
 var ind = "1";
        using (IsolatedStorageFile isoStore = IsolatedStorageFile.GetUserStoreForApplication())
        {
            using (IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream("People2.xml", FileMode.Open, isoStore))
            {
                XDocument loadedCustomData = XDocument.Load(isoStream);
                var filteredData = from c in loadedCustomData.Descendants("person")
                                   where c.Attribute("index").Value == ind
                                   select new Person()
                                   {
                                       index= c.Attribute("index").Value,
                                       att1= c.Attribute("att1").Value,
                                       att2= c.Attribute("att2").Value,
                                       att3= c.Attribute("att3").Value
                                   };
                stack.DataContext = filteredData;
            } 
```

index_box_det.Text = 索引；

还是不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:18:16.033

您必须调用`FirstOrDefault`方法：

```
var ind = "1";
using (IsolatedStorageFile isoStore = IsolatedStorageFile.GetUserStoreForApplication())
{
    using (IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream("People2.xml", FileMode.Open, isoStore))
    {
        XDocument loadedCustomData = XDocument.Load(isoStream);
        var filteredData = (from c in loadedCustomData.Descendants("person")
           where c.Attribute("index").Value == ind
           select new Person()
           {
               Index = c.Attribute("index").Value,
               Att1 = c.Attribute("att1").Value,
               Att2 = c.Attribute("att2").Value,
               Att3 = c.Attribute("att3").Value
           }).FirstOrDefault();
        stack.DataContext = filteredData;
    }
} 
```

`Person`班级：

```
public class Person
{
    string index;
    string att1;
    string att2;
    string att3;

    public string Index
    {
        get { return index; }
        set { index = value; }
    }

    public string Att1
    {
        get { return att1; }
        set { att1 = value; }
    }

    public string Att2
    {
        get { return att2; }
        set { att2 = value; }
    }

    public string Att3
    {
        get { return att3; }
        set { att3 = value; }
    }
} 
```

# python - 获取多对一关系以在 Django 中显示两种方式

> ID：14551359
> 
> 赞同：0
> 
> 时间：2013-01-27T19:36:46.177
> 
> 标签：python, django

我的 Django 应用程序文件中有两个模型，`models.py`如下所示：

```
class User(models.Model):
    user = models.IntegerField(primary_key=True,max_length=5)
    first_name = models.CharField(max_length=35)
    last_name = models.CharField(max_length=35)
class Device(models.Model):
    device_name = models.CharField(unique=True,max_length=30)
    user = models.ForeignKey('User') 
```

每个`Device`人只能拥有一个`User`，但每个人都`User`可以拥有不止一个`Device`。

在管理界面中，当我显示 a 时`Device`，它会`User`在下拉列表中显示 ，但是当我显示 时`User`，我看不到关联的`Device`. 我该如何解决这个问题，以便我可以从任何一方看到关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:44:00.347

您需要使用[InlineModelAdmin 对象](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#inlinemodeladmin-objects)

**UPD**

应该看起来像：

```
class DeviceInline(admin.TabularInline):
    model = Device

class UserAdmin(admin.ModelAdmin):
    inlines = [
        DeviceInline
    ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:47:07.867

您可以将 StackedInline 与 extra=0 选项一起使用。

```
class DeviceInline(admin.StackedInline):
    model = User
    extra = 0

    def has_add_permission(request):
        return True or False # change for your context 
```

# css - 将标题与文本对齐

> ID：14551371
> 
> 赞同：1
> 
> 时间：2013-01-27T19:37:48.037
> 
> 标签：css, css-float

我有以下内容：

[http://jsfiddle.net/B8e8A/](http://jsfiddle.net/B8e8A/)

我有标题`width: 50%;`和标签`span`内的`h2`标签来帮助我实现这一目标。

我希望使标题与文本左对齐，以便标题栏的大小不同，但栏仍会延伸到屏幕的左侧。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:50:16.527

修改以下 CSS：

**更改：删除宽度：50%**

```
h2 {
    background: none repeat scroll 0 0 #FF8C00;
    border-bottom-right-radius: 40px;
    border-top-right-radius: 40px;
    display: inline-block;
    font-size: 150%;
    margin-bottom: 10px;
    overflow: hidden;
    padding: 15px 30px 15px 0;
    /*--width:50%*/
} 
```

**更改：从右到左浮动，从右到左文本对齐，添加 nowrap**

```
h2 span {
    float: left;
    text-align: left;
    white-space: nowrap;
} 
```

示例：http: [//jsfiddle.net/B8e8A/1/](http://jsfiddle.net/B8e8A/1/)

# html - CSS类不起作用

> ID：14551374
> 
> 赞同：-5
> 
> 时间：2013-01-27T19:37:58.807
> 
> 标签：html, css

我有一个大问题。我用外部 .css 编写了一个 HTML。但我所有的人都不在桌子上工作。我只能在 IE8 中工作，但我无法在 Firefox、Chrome 或 IE9 中打开它们请帮助我 :)

我的 HTML 代码：

```
<!DOCTYPE HTML>

<html>

<head>
<title>Ruf zum Sport</title>
<link rel="stylesheet" type="text/css" href="stylesport.css" media="all" />
</head>

<body>
<h1>Ruf zum Sport</h1>
<table border="">
<tr>
<td class="1" id="general">
<p>Auf, ihr steifen und verdorrten<br>
Leute aus B&uuml;ros,<br>
rei&szlig;t euch mal zum Wintersporten<br>
von den &Ouml;fen los.<br>
</p>
</td>

<td class="2" id="general">
<p>Bleiches Volk an Wirtshaustischen<br>
stellt die Gl&auml;ser fort.<br>
Widme dich dem freien, frischen,<br>
frohen Wintersport.
</p>
</td>
</tr>
</table>
</body>

</html> 
```

CSS代码：

```
body {
font-family: Comic Sans MS ;
font-size: 13;
font-weight: bold;
word-spacing: 2px;
color: #000000;
margin: 15px auto auto 25px;
line-height: 1cm ;
background: url(ski.jpg) no-repeat center center fixed;
background-size: cover;

}
h1 {
color: #3366FF;
font-size: 2em;
border-width: 3px;
border-color: #0000CC;
border-style: hidden;
margin: 20px 20px 20px 20px;
}
td.1 {
text-align: left;
}

.td.2 {
text-align: right;
padding-left: 70px;
color: #FF66CC;
}

#general {
font-size: 13;
font-weight: bold;
word-spacing: 2px;
line-height: 0.6cm;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:45:44.567

你有几个问题。

1.  CSS 类选择器中的类名不能以`2`（或任何其他数字）开头
2.  `.td.2`试图匹配“任何类型的元素，它是该类的成员，也是该类的`td`成员`2`

将类名更改为以字母开头的名称，并使`td`类型选择器不是类选择器。

```
td.two { ... } 
```

[如果您通过验证器](http://jigsaw.w3.org/css-validator/)运行您的 CSS，您的第二个问题将被拾取，您的 HTML 中也会出现错误，这些错误将被[标记验证器](http://validator.w3.org/)拾取。

# qml - QML 不改变状态

> ID：14551375
> 
> 赞同：0
> 
> 时间：2013-01-27T19:38:02.637
> 
> 标签：qml, qt4

我正在创建一个应用程序，但 qml 中的状态没有改变......这`LoginView`是一个 QML 文件，`MessageView`也是一个 QML 文件我想将 QML 文件更改为应用程序的页面......我做错了，但我是无法弄清楚是什么....请帮助我

```
import QtQuick 1.0

Item {
id: main

LoginView {
    id: login
    anchors.fill: parent
    visible: true
    onLoginClicked: main.state="messageView"
}

MessageView {
    id: message
    anchors.fill: parent
    visible: false
}

states: [State {
        name:"messsageView"
        PropertyChanges { target: login; visible: false }
        PropertyChanges { target: message; visible: true }
    },State {
        name:""
        PropertyChanges { target: message; visible: false }
        PropertyChanges { target: login; visible: true }
    }]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T13:22:34.983

你打错字了。看看这段代码：

```
LoginView {
id: login
anchors.fill: parent
visible: true
onLoginClicked: main.state="messageView" //state name is "messageView"
} 
```

并且，次要查看：

```
states: [State {
    name:"messsageView" // TRIPLE "s"
    PropertyChanges { target: login; opacity: 0 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T00:32:16.237

当某些“事件”发生时，不应该发生变化。像这样的东西：

```
import QtQuick 1.0

Rectangle
{

    id: main
    color: "blue"
    width : 200
    height: 200

Rectangle
{
    id: login
    color: "red"
    anchors.fill: parent
    opacity: 1
}

Rectangle {
    id: message
    color: "green"
    anchors.fill: parent
    opacity: 0
}

// --------------------------- THIS! ---------------------

MouseArea
{
 anchors.fill: parent
 onClicked: parent.state = "messsageView"
}

// -------------------------------------------------------

states: [State {
        name:"messsageView"
        PropertyChanges { target: login; opacity: 0 }
        PropertyChanges { target: message; opacity: 1 }
    },State {
        name:""
        PropertyChanges { target: message; opacity: 0 }
        PropertyChanges { target: login; opacity: 1 }
    }]

} 
```

# javascript - 页面上有多个自定义 Pinterest“固定”按钮？

> ID：14551380
> 
> 赞同：4
> 
> 时间：2013-01-27T19:38:22.217
> 
> 标签：javascript, jquery, pinterest

我的网站上有一个包含多个产品的页面，每个产品 div 都有自己的直接链接，例如“mysite.com/products.php#product1”或“mysite.com/products.php#product2”。

Pinterest 提供了一个按钮来指定 url（所以我可以具体并链接到页面上的确切产品）和要固定的图像，所以我可以在页面上的多个位置使用它，但它不会让我使用pinit 按钮的自定义图像。

我想要的是每个产品的自定义（意思是，使用我自己的图像）pinterest 按钮。我找到了许多制作自定义 pinterest 按钮的示例，但它们从页面中提取所有图像并链接到浏览器所在的 url（例如，“mysite.com/products.php”，而不是更具体的 url非常产品。）

所以，我需要让我生成 1) 按钮本身的自定义图像的代码，但也会 2) 让我像原始 pinit 按钮一样指定链接和 url。

有什么帮助吗？我可以找到示例来完成我想要的一半，但我找不到任何可以让我同时满足这两个要求的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T21:57:21.113

您可以为您的 Pinterest 按钮指定图像...

```
<a target="_blank" href="http://pinterest.com/pin/create/button/?url=YOURWEBSITE.com&media=YOURIMAGEURLHERE&description=YOURDESCRIPTIONHERE" class="pin-it-button" count-layout="none"><img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" /></a> 
```

看看这个 JS Fiddle：http: [//jsfiddle.net/GF69r/1/](http://jsfiddle.net/GF69r/1/)

# windows - 在 Windows 上安装 qt 结合 MinGW

> ID：14551381
> 
> 赞同：1
> 
> 时间：2013-01-27T19:38:24.820
> 
> 标签：windows, qt, installation, mingw

经过 2 小时的努力，我还没有设法在 Windows 上正确安装 qt。我找不到在一些指示 Qt 安装的站点中[链接的 SDK 版本。](http://qt.nokia.com/download)所以我尝试了另一种方式。如果它仍然可用，你可以给我一个下载完整 sdk 的链接，因为用这种方式安装似乎更容易。

[我从这里](http://qt.nokia.com/download)为 MinGW 和 Qt Creator 安装了 Qt 库 然后我将 C:\Qt\4.8.4 添加到路径变量并在 Qt 文件夹上运行 configure.exe 之后我安装了 Qt Creator 但没有打开一个选项Qt Gui 项目或快速项目。然后从选项中我创建了一个工具包并选择 MinGW 作为编译器并保存 qmake 路径。通过此更改，我可以打开一个 Qt Gui 项目，但随后在运行时出现代码 -1073741511 错误退出。我尝试了这个推荐 的[解决方案](http://www.qtcentre.org/threads/26604-Runtime-problem-in-Release-mode/page2)，但在 system32 上找不到那些 dll 文件。所以我累了，决定问stackoverflow。我错过了安装步骤吗？我应该尝试使用 msvc 吗？是否可以将 msvc 与开源 qt 版本一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:38:04.370

安装 Qt、MinGW、Creator 和其他工具的 Qt SDK 是由诺基亚创建的，Digia 还没有发布这样的 SDK（他们承诺会发布）——无论如何，如果 Qt 4.8.x（我认为 x 是 1）就足够了，你仍然可以从[诺基亚网站](http://www.developer.nokia.com/info/sw.nokia.com/id/da8df288-e615-443d-be5c-00c8a72435f8/Qt_SDK.html)下载 SDK 。

此外，如果您想构建 Qt 本身，而不是使用已经构建的 Qt 的应用程序，则不应运行 configure.exe - 这是一个配置 Qt 框架构建的工具。

至于你的 -1073741511 问题，这是一个 dll 问题，要么你缺少 dll，要么你试图使用一些不兼容的 dll，至于添加到路径，我认为运行时所需的 qt dll 的正确路径在 C:\ Qt\4.8.4\ **bin**（请检查）并确保您安装并添加到为您实际使用的编译器构建的 Qt 的路径（或复制 dll）。

此外，您还需要一些用于 MinGW 运行时的 dll（同样，您可以将 mingw_install_path\bin 添加到路径或将 dll 从那里复制到与您的应用程序相同的文件夹中）

# pdf - mfmailcomposer 将 pdf 附加到电子邮件中不适用于 ipad 1，但适用于 ipad2

> ID：14551385
> 
> 赞同：0
> 
> 时间：2013-01-27T19:38:52.397
> 
> 标签：pdf, email-attachments, mfmailcomposeviewcontroller

我正在使用下面的代码从网站下载 pdf 文件，然后在 uiwebview 中显示它

```
NSString *url = [NSString stringWithString:[[[popOverContent currentValues]     objectAtIndex:0]objectForKey:@"Web"]];

    // Determile cache file path
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,      NSUserDomainMask, YES);
    NSString *filePath = [NSString stringWithFormat:@"%@/%@", [paths objectAtIndex:0],@"index.pdf"];

    // Download and write to file
    NSURL *url2 = [NSURL URLWithString:url];
    NSData *urlData = [NSData dataWithContentsOfURL:url2];
    [urlData writeToFile:filePath atomically:YES];

    fileToAtatch = urlData;

    // Load file in UIWebView
    [self.myWebView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:filePath]]]; 
```

此时一切正常，但后来当我使用以下代码使用 mfmailcomposer 将 pdf 文件附加到电子邮件时，我遇到了问题。

```
-(IBAction)EmailPressed:(id)sender
{
if ([MFMailComposeViewController canSendMail]) {

    MFMailComposeViewController *viewController = [[MFMailComposeViewController alloc] init];
    viewController.mailComposeDelegate = self;
    NSString *query = @"please find atatched the requested data sheet";
    [viewController setSubject:[popOverContent selectedSize]];
    [viewController setMessageBody:query isHTML:NO];
    [viewController addAttachmentData:fileToAtatch mimeType:@"application/pdf" fileName:[popOverContent selectedSize]];
    [self presentModalViewController:viewController animated:YES];

} 
```

}

此代码完全按预期工作，多页 pdf 按预期附加。

如果我使用 ios 5.0.1 在 iPad 上测试应用程序，将电子邮件发送给自己，当我单击电子邮件中 ​​pdf 的图标时，pdf 不会打开，并且预览只是坐在那里，uiprogress 指示器在旋转。但是，如果我在带有 ios 6.0.1 的 ipad2 上以相同的方式测试应用程序，则 pdf 文件将毫无问题地打开。它也适用于 iphone 5 和带有山狮的 mac。

那么发生了什么？谁能告诉我我的代码和实现有什么问题，让我在 ipad 1 上出现这种奇怪的行为，但在 ipad 2 等上却没有。

请指教

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T12:21:54.560

我终于弄清楚了，并通过如下更改我的代码解决了这个问题

```
 fileName = [selectedSizeToUse stringByAppendingString:@".pdf"];
         [mailController setSubject:selectedSizeToUse];
         [mailController addAttachmentData:fileToAtatch mimeType:@"application/pdf" fileName:fileName]; 
```

似乎对于 ios5 实现，pdf 文件需要在预览应用程序中识别 .pdf 扩展名，而在 iOS 6 实现中，预览应用程序足够聪明，可以在没有 .pdf 扩展名的情况下显示 pdf。

希望这可以帮助其他陷入困境的人

# node.js - 不能将 $match 与 mongoose 和聚合框架一起使用

> ID：14551387
> 
> 赞同：6
> 
> 时间：2013-01-27T19:39:08.937
> 
> 标签：node.js, mongodb, express, mongoose

这是我的架构：

```
var userschema = new mongoose.Schema({

  user: String,
  follow: [String],
  imagen: [{ 

              title: String,
              date: { type: Date, default: Date.now }

           }]
 }); 
```

这是代码：

```
 usermodel.findOne({ user: req.session.user }, function (err, user){
  usermodel.aggregate({$unwind: '$imagen'}, 
                   {$match: { _id: { $in: user.follow } }}, 
                   {imagen: true}, 
                   {$sort: {'imagen.date': 1}}, 
                    function (err, images){

                     console.log(images);              

                      res.render('home.ejs', {

                       user: user,
                       following: images

                      });
   });
  }); 
```

`follow`包含用户的`_id`.

该代码有效，除非我包含`$match`. 我使用`$match`来过滤结果，只获取我正在关注的用户的图像，但是 console.log 显示`aggregate`搜索的结果是未定义的，但是当我不编写`$match`查询时，我得到了图像，但我获得了所有图像，而不仅仅是我关注的用户的图像。

有什么解决办法吗...？

谢谢提前！

编辑：

```
var express = require('express');
var MongoStore = require('connect-mongo')(express);
var fs = require('fs');
var mongoose = require('mongoose');

var app = express();
app.listen(9191);

var sessionStore = new MongoStore({db: 'session'});

app.configure(function(){

   app.use(express.bodyParser());
   app.set('views',__dirname + '/views');
   app.set('view engine', 'ejs');
   app.use(express.static(__dirname + '/public'));
   app.use(express.cookieParser());
   app.use(express.session({
     store: sessionStore,
     secret: 'secret'
   }));
   app.use(app.router);

});

var db = mongoose.createConnection('localhost', 'test');

var userschema = new mongoose.Schema({

  user: String,
  follow: [String],
  imagen: [{ 

              title: String,
              date: { type: Date, default: Date.now }

           }]
 });

var usermodel =  db.model('usermodel', userschema);
var ObjectId = require('mongoose').Types.ObjectId;

app.get('/', middleware.noses, function (req, res){

     res.render('home0.ejs');

});

app.get('/home', middleware.yeses, function (req, res){

  usermodel.findOne({ user: req.session.user }, function (err, user){

    if (user.follow.length != 0){

      usermodel.find({ _id: {$in: user.follow } }, { user: true }, function (err, users){

         var usernames = users.map(function(u){ return u.user });

          usermodel.aggregate({$match: { _id: { $in: user.follow.map(
                                           function(id){ return new ObjectId(id); })}}},
                                       {$unwind: '$imagen'}, 
                                       {imagen: true}, 
                                       {$sort: {'imagen.date': 1}}, 
                                        function (err, images){

                                           console.log(images);

                                          res.render('home.ejs', {

                                             user: user,
                                             following: images

                                        });
               });
            });

    }  else {

       res.render('home.ejs', {

              user: user,
              following: undefined

            });

     }

 });
}); 
```

编辑：

```
[ { __v: 4,
   _id: 50fd9c7b8e6a9d087d000006,
   follow: ['50fd9cbd1322de627d000006', '50fd9d3ce20da1dd7d000006'],
   imagen: 
   [{ title: 'foo',
      _id: 50fd9ca2bc9f163e7d000006,
      date: Mon Jan 21 2013 20:53:06 GMT+0100 (CET) },
    { title: 'foot',
      _id: 50fda83a3214babc88000005,
      date: Mon Jan 21 2013 21:42:34 GMT+0100 (CET) }],
   user: 'Mrmangado' } 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-27T22:17:19.680

Mongoose 不会对 的参数进行任何基于模式的转换`aggregate`，因此您需要将`user.follow`字符串 id 数组转换为 ObjectId 数组`$match`：

```
{$match: { _id: { 
    $in: user.follow.map(function(id){ return new mongoose.Types.ObjectId(id); })
}}}, 
```

^(注意：不要`mongoose.Schema.Types.ObjectId`用于铸造。**不起作用。**)

您还应该将其移至`$match`管道的开头以提高效率。

**更新**

您的另一个问题是您需要使用运算符，而不仅仅是在管道中`$project`包含一个普通对象。`{imagen: true}`将所有内容放在一起并重新排序以获得更有效的管道，这对我的数据有用：

```
usermodel.aggregate(
    {$match: { _id: {
        $in: user.follow.map(function(id){ return new mongoose.Types.ObjectId(id); })
    }}},
    {$project: {imagen: true}},
    {$unwind: '$imagen'},
    {$sort: {'imagen.date': 1}},
    function (err, images){ ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T02:46:42.767

对于任何偶然发现这个问题的人，希望有一个更“通用”的解决方案，需要手动`.map`或手动进行转换/转换，这里有一个`may`适合您的解决方案：

**要求**：您的 $match 查询对象必须适合您创建的某些架构。

**一般解决方案**：

```
Model.aggregate([
   { $match: Model.where(yourQueryObject).cast(QueryModel); }
]); 
```

这里的问题是 Mongoose Query API [`Query#cast`](http://mongoosejs.com/docs/api.html#query_Query-cast)，它可以帮助您将普通对象转换为架构定义的任何内容。这有助于规范化 ObjectID、字符串和数字。

**这个问题的可能解决方案**：

仅考虑 $match 阶段：

```
{$match: usermodel.where({_id: { $in: user.follow }}).cast(usermodel) }} 
```

# c++ - 在 C++ 中从数组中删除一个值

> ID：14551388
> 
> 赞同：-1
> 
> 时间：2013-01-27T19:39:22.147
> 
> 标签：c++

嗨，我正在尝试做这样的事情：

在第一次迭代时说我有

```
 A={2,3,5} 
```

然后在第二次迭代中它变成

```
 A={2,3} 
```

等等。我尝试在第一次迭代后将第三个元素设为零，但随后算法出错了。

当我们执行每次迭代时，C++ 中删除数组中元素的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:41:28.267

最好的（也是最类似于 C++ 的）方法是从数组切换到可调整大小的容器，例如[`std::vector`](http://www.cplusplus.com/reference/vector/vector/). 这个容器是动态调整大小的，让您可以从容器的末尾或容器中的任何其他位置删除元素。然后容器将调整为正确的大小。

```
// Create a vector
std::vector<int> mydata(10, -1);
for (int i = 0 ; i != 10 ; i++)
    mydata[i] = i;
// Process all elements
for (int i = 0 ; i != mydata.size() ; i++) {
    cout << mydata[i] << endl;
}
// Remove the last element
mydata.pop_back();
// Process all elements - now the last one is not there
for (int i = 0 ; i != mydata.size() ; i++) {
    cout << mydata[i] << endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:54:03.097

将阵列想象成带有槽的金属结构。插槽不能更改，它们是固定的。

用书填满插槽。这就像将值放入数组中。

从第 3 个插槽中取出第 3 本书。因为它是固定槽的金属结构，所以其他的书都没有调整或移动。他们在他们原来的位置。

要“移除”空槽，请从下一个槽中拉出一本书并将其放入空槽中。重复直到“空”插槽结束或所有剩余的书都已移动。这就是`std::vector`删除项目的方式。

链表在删除槽时更有效。把链表想象成一堆容器，一端有一个钩子，另一端是字符串。您只能将绳子系在一个容器的挂钩上。跟随字符串为您提供容器的顺序。要移除一个容器，先解开前一个容器的绳子并将其系在下一个容器的钩子上，然后解开容器的绳子。您不必复制或移动任何剩余元素；你只是移动了字符串。

除非您跟踪删除的容器，否则它可能会丢失。这种情况称为内存泄漏：内存中丢失的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:41:49.150

您不能在 C++ 中删除常规数组中的元素。如果您使用的是 List 或 vector 则另当别论，但是对于普通数组，您只能创建新数组，并从旧数组中复制值，而无需“删除”您要“删除”的值。然后说“新数组”是“旧数组”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T19:43:40.410

对于 C++ 风格：使用 std:vector 并遵循[this](http://www.cplusplus.com/reference/vector/vector/erase/)。
对于 C 风格：使用动态堆数组，即 new/delete/realloc

# ruby-on-rails - RailsTutorial chap3 3.7 rspec 错误

> ID：14551390
> 
> 赞同：1
> 
> 时间：2013-01-27T19:39:35.113
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railstutorial.org

我在[http://ruby.railstutorial.org/chapters/static-pages#fig-green_passing_spec](http://ruby.railstutorial.org/chapters/static-pages#fig-green_passing_spec)关注 RailsTutorial，运行时收到错误消息：

```
bundle exec rspec spec/requests/static_pages_spec.rb 
```

我得到以下输出：

```
Rack::File headers parameter replaces cache_control after Rack 1.5.
B:/rails_projects/sample_app/app/controllers/application_controller.rb:1:in `<top (required)>': uninitialized constant ApplicationController (NameError)
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:438:in `each'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:438:in `block in eager_load!'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:436:in `each'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:436:in `eager_load!'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `block in run_initializers'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from B:/rails_projects/sample_app/config/environment.rb:5:in `<top (required)>'
    from B:/rails_projects/sample_app/spec/spec_helper.rb:3:in `require'
    from B:/rails_projects/sample_app/spec/spec_helper.rb:3:in `<top (required)>'
    from B:/rails_projects/sample_app/spec/requests/static_pages_spec.rb:1:in `require'
    from B:/rails_projects/sample_app/spec/requests/static_pages_spec.rb:1:in `<top (required)>'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `map'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load_spec_files'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:22:in `run'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:69:in `run'
    from B:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:8:in `block in autorun' 
```

这是我正在使用的gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.11'
group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.11.0'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.5'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.2'

group :test do
  gem 'capybara', '1.1.2'
end

group :production do
  gem 'pg', '0.12.2'
end 
```

我一个月前完成了第 3 章，没有任何问题。从那时到现在，唯一的变化是由于暴露的漏洞而对 Rails 进行了更新。

知道我做错了什么，或者我应该改变/看看什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T02:55:22.927

与[此](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#code-final_gemfile)比较然后重新运行`bundle install`？

# mysql - mysql双列中存储的数字是否有可能在多次乘法后失去精度？

> ID：14551395
> 
> 赞同：2
> 
> 时间：2013-01-27T19:39:52.770
> 
> 标签：mysql, sql

我有两张桌子。假设第一个是带有 user_id + 一些*数字*（双）的数字，每个 user_id 可以有多行。然后我有另一个*用户*user_id(PRIMARY) + product of all numbers for this user from the table *numbers*。

由于记录被插入或从*数字*中删除，我需要重新计算*users.product*。由于一次只插入一条记录，我可以使用以下查询来完成：

```
UPDATE users SET product=product*{number} WHERE user_id={some_id} 
```

但是由于记录被批量删除，因此需要一些丑陋的代码才能做到这一点，重新计算产品更简单。但是，没有像 PRODUCT 这样的功能。我可以用

```
exp(sum(log(coalesce(*number*,1))) 
```

但我不确定我是否会得到一个错误的数字乘积。数字将在 1.00 到 9.99 的范围内。这样会损失多少精度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:55:42.933

如果您使用浮点表示，您的问题的答案是“是”。

一般来说，如果你在一个小范围内相乘并且只有少数几个数字，这不会成为问题。如果您对此感到担心，请以固定的十进制表示形式存储数字。

您记录日志的解决方案很好。对于大多数应用程序，这将产生足够的精度。但是，如果您致力于将轨道器发送到火星，可能会累积小错误，并且您不应该依赖数据库来获得高精度的数值精度。

请注意，计算的顺序也会影响数值精度。

# android - Android（WebView）取消自动滚动到html中的图像

> ID：14551396
> 
> 赞同：0
> 
> 时间：2013-01-27T19:39:53.310
> 
> 标签：android, html, webview, scroll, autoscroll

我在`WebView`. 当我设置带有显示的 html 代码时，`webView.loadData()`会自动聚焦第一个图像。如果我有一张或多张图片，那没关系。如何取消或停止自动对焦/自动滚动到图像并停留在显示屏顶部？

我的意思是，我不想禁用垂直滚动，我只想在最初显示 html 时取消此行为。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
<title></title>
</head>
<body bgcolor="white">
<p>Some Text...</p>
<img src="http://..pic1.gif" style="max-width:100%;" /><br><br>
<img src="http://..pic2.gif" style="max-width:100%;" /><br>
<p>Some Text...</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:02:06.660

我的错。我有一个`ScrollView`作为父母`WebView`。`WebView`不要自动滚动，但我的父母这样`ScrollView`做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:37:19.673

不确定我理解你的意思，但你可以使用

```
webView.setInitialScale() 
```

设置它的大小和

```
pageUp(boolean) or pageDown(boolean) 
```

将其设置为开始/结束。

# javascript - 我需要一个函数，它为属于某个范围的给定浮点数输出十六进制值

> ID：14551398
> 
> 赞同：2
> 
> 时间：2013-01-27T19:40:37.093
> 
> 标签：javascript, colors, hex

我很抱歉标题不好（如果你愿意，可以编辑），但我不知道如何提出这个请求。我附上了一张来自 Photoshop 的图片，它可以更好地说明事情。

请求本身非常简单：您有一个从 10.0 到 0.0 的数字范围。10 代表颜色#00ff00（深绿色），0.0 代表颜色#ff0000（深红色）。

现在，当您交出数字 10.0 时，它将输出 #00ff00。当你给它 8.2 之类的东西时，它会输出类似 #00cc33 的东西，这样你就有一个一直向下的浮动渐变，但总是从 #00ff00 浮动到橙色 #ff9900 到 #ff0000 （中间的橙色也可以省略）。

![这就是我想要的](../Images/4588e78a650575b9a3e56db6d28cb0c4.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:10:51.807

一种方法是将颜色想象成圆的一部分，然后使用`Math.cos`or `Math.sin`。

```
function toColour(x) {
    var pad = function (x) {
        x = x.toString(16);
        if (x.length === 1) {
            return '0' + x;
        }
        return x;
    }, r, g, b;
    r = ~~(255 * Math.cos(Math.PI * x / 20)); // cos(0) = 1, cos(π/2) = 0
    g = ~~(255 * Math.sin(Math.PI * x / 20)); // sin(0) = 0, sin(π/2) = 1
    b = 0;
    return '#' + pad(r) + pad(g) + pad(b);
}

// test the gradient produced
for (var i = 0; i <= 10; ++i) {
    document.body.appendChild(
        document.createElement('div')
    ).setAttribute('style', 'width: 400px;height: 5px;background: '+toColour(i)+';');
} 
```

请参阅[**此小提琴**](http://jsfiddle.net/2RBuL/2/)以获取测试结果（感谢[MikeM](https://stackoverflow.com/users/1565512/mikem)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T19:56:38.107

只是为了好玩：

```
function toHex( n ) {
    var r = 255 - ( n / 10 * 255 | 0 ); 
        g = n / 10 * 255 | 0;  

    return '#' + 
        ( r ? ( r = r.toString(16), r.length == 2 ? r : '0' + r ) : '00' ) +
        ( g ? ( g = g.toString(16), g.length == 2 ? g : '0' + g ) : '00' ) + '00'
} 
```

在这里看到它（它的价值）：http: [//jsfiddle.net/xD6Uf/](http://jsfiddle.net/xD6Uf/)

**更新**

受 Samuel Edwin Ward 使用 HSL 的启发，以下函数改编`hslToRgb`自 Brian Grinstead 的 MIT Licensed [tinycolor.js](http://bgrins.github.com/TinyColor/docs/tinycolor.html)：

注意：此功能不打算成为成品或代表良好实践，它只是概念证明。没有边界检查，对可读性的让步也很少。

`n`是一个从 0 到 10 的值`start`，`middle`和`end`是一个从 0 到 360 的色调值。
请参阅[Mother-effing hsl](http://mothereffinghsl.com/)来选择要试验的色调、饱和度和亮度值。

```
function toHex( n ) {
    var r, g, b, p, q,
        start = 0,          // 0 - 360 (red 0)
        middle = 36,        // 0 - 360 (orange 36, use 0 or null for no middle)
        end = 120,          // 0 - 360 (green 120)
        saturation = 1,     // 0 - 1
        lightness = 0.5,    // 0 - 1
        hue = ( middle ?
            n > 5 ? ( n -= 5, n / 5 * ( end - middle ) ) + middle :
                ( n / 5 * ( middle - start ) ) + start :
                    ( n / 10 * ( end - start ) ) + start ) / 360;

    function hue2hex( p, q, h ){
        if ( h < 0 ) h++;
        else if ( h > 1 ) h--;
        h = ( h < 1/6 ? p + ( q - p ) * 6 * h : h < 1/2 ? q :
            h < 2/3 ? p + ( q - p ) * ( 2/3 - h ) * 6 : p ) * 255 | 0;
        return h ? ( h = h.toString(16), h.length > 1 ? h : '0' + h ) : '00';
    }

    if ( saturation === 0 ) {
        n = lightness * 255 | 0;
        r = g = b = n ?
            ( n = n.toString(16), n.length > 1 ? n : '0' + n ) : '00'; 
    } else {
        q = lightness < 0.5 ? lightness * ( 1 + saturation ) :
            lightness + saturation - lightness * saturation;
        p = 2 * lightness - q;
        r = hue2hex( p, q, hue + 1/3 );
        g = hue2hex( p, q, hue );
        b = hue2hex( p, q, hue - 1/3 );
    }

    return '#' + r + g + b;
} 
```

例子

```
toHex(0);    // "#ff0000"
toHex(5);    // "#ff9900"
toHex(10);   // "#00ff00" 
```

[jsfiddle](http://jsfiddle.net/xD6Uf/3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T20:02:38.750

看起来您想在颜色之间进行插值。

您可以将颜色值设为数字并在它们之间进行插值，但我认为结果会很奇怪。

您可能希望将颜色从 RGB 转换为另一个颜色空间并缩放色调分量。HSL 将是一个不错的选择，因为 CSS3 支持在该空间中指定颜色。

![颜色比例的图像](../Images/001669a9fbaf39d623a9afbe89d2dc56.png)

我将这两种方法[的代码放在 jsfiddle 上](http://jsfiddle.net/dQsCe/)。

这些是重要的部分：

```
/* numeric interpolation */
for (var value = 0; value < 10; value += 10/40) {
    var color = (10-value)/10*(0xff0000-0xff00)+(0x00ff00),
        hex = Math.floor(color).toString(16);

    while (hex.length < 6) {
        hex = "0" + hex;
    }

    /* hex now holds the hex code */
  }

/* hue interpolation */

for (var value = 0; value < 10; value += 10/40) {
    var hue = value/10*120, /* red is 0; green is 120 */
        color = 'hsl(' + hue + ', 100%, 50%)';

    /* hsl now holds the hsl color specification */
} 
```

如果您愿意，可以使用比我使用的简单线性公式（其中 x 是输入比例，y 是输出比例）更高级的方法来插值：

```
y = (x - minX) / (maxX - minX) * (maxY-minY) + minY 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T19:50:10.013

所以基本上你有一些带有两个变量的十六进制范围：

```
var startHex = "0x00ff00";
var endHex = "0xff0000"
int startInt = parseInt(startHex, 16);
int endInt = parseInt(endHex, 16);
int newInt = startInt + (endInt-startInt)/100 * floatValue; // floatValue is number between 10.0 and 0.0
var newHex = newDec.ToString(16); 
```

我假设您打算在开始和结束之间进行 100 次增量。这可以做得更干净，但为了说明，我把它全部打破了。在实践中，我会用 1-2 行来写这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T20:13:21.340

如果你想依赖浏览器的渲染引擎，你可以使用 HTML5 的 canvas 和`createLinearGradient`. 这种方法的一个优点是能够使用色标（尽管如果你真的想要也可以在数学上做到这一点）。

```
var canvas = document.createElement('canvas'),
    context = canvas.getContext('2d');

canvas.height = 100; canvas.width = 1;

var gradient = context.createLinearGradient(0,0,0,100);

// color stops
gradient.addColorStop(0, '#00ff00');
gradient.addColorStop(0.5, '#ff9900');
gradient.addColorStop(1, '#ff0000');

context.fillStyle = gradient;
context.fillRect(0,0,1,100);

var point = 10.0,
    colorData = context.getImageData(0, parseInt(point*canvas.height*.1, 10), 1, 1).data;

// rgba ( colorData[0], colorData[1], colorData[2], colorData[3] ) 
```

`colorData[0]`您可以在（红色）、`colorData[1]`（蓝色）、 （绿色）中找到颜色的确切 rgba 坐标，`colorData[2]`然后轻松将它们转换为十六进制值。

如果您最终使用此解决方案，请设置`point`为 0 到 9.9 范围内的数字。

# php - 计算 $_POST

> ID：14551400
> 
> 赞同：1
> 
> 时间：2013-01-27T19:40:49.570
> 
> 标签：php, forms, loops, post, count

我有一个大表单，其中包含 X 个帖子，每个帖子有 15 个字段以及 1 个隐藏字段。

假设我有 14 个帖子。这意味着我的表单将发送 211 个字段（14x15 个字段加上 1 个隐藏字段）。

用户不必填写所有字段。

我想计算表单发送的帖子数量，但我似乎遇到了困难。

使用 count($_POST) 返回 152。这让我相信 count() 忽略了空字段。

因此，使用 (count($_POST) - 1) / 15 之类的公式会返回错误的结果 (10.0666)，并且如果将来字段数量发生变化，效率会很低。

那么，有人对如何正确计算我的帖子有任何想法吗？

我的表格如下所示：

```
<form name="scraped" action="<?php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI']); ?>" method="post">
        <input type="hidden" name="OSscraper_hidden" value="N">
        <?php
            $inpCnt = 0;
            foreach($articles as $item) {
        ?>
        <input type="text" name="title_<?php echo $inpCnt; ?>">
        <input type="text" name="name_<?php echo $inpCnt; ?>">
        <input type="text" name="url_<?php echo $inpCnt; ?>">
        <input type="text" name="img_<?php echo $inpCnt; ?>">
        <input type="text" name="pet_<?php echo $inpCnt; ?>">
        <input type="text" name="color_<?php echo $inpCnt; ?>">
        <input type="text" name="value_<?php echo $inpCnt; ?>">
        <input type="text" name="height_<?php echo $inpCnt; ?>">
        <input type="text" name="weight_<?php echo $inpCnt; ?>">
        <input type="text" name="hair_<?php echo $inpCnt; ?>">
        <input type="text" name="eyes_<?php echo $inpCnt; ?>">
        <input type="text" name="race_<?php echo $inpCnt; ?>">
        <input type="text" name="phone_<?php echo $inpCnt; ?>">
        <input type="text" name="address_<?php echo $inpCnt; ?>">
        <input type="text" name="zip_<?php echo $inpCnt; ?>">
        <?php 
            $inpCnt++;
        } ?>
        <input type="submit" value="Submit">
    </form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:11:10.020

将您的表单更改为如下所示：

```
<input type="text" name="foo[<?php echo $inpCnt; ?>][title]">
<input type="text" name="foo[<?php echo $inpCnt; ?>][name]">
<input type="text" name="foo[<?php echo $inpCnt; ?>][url]"> 
```

然后你会得到：

```
$_POST['foo'] = [
  0 => ['title' => '...', 'name' => '...', 'url' => '...'],
  1 => ...,
  ...
]; 
```

它使您不必自己进行分组，并且更容易对输入进行计数或迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:58:55.507

为什么不只是`count($articles)*15`回显到隐藏的输入中。无论如何，您正在使用另一个隐藏的输入......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:29:08.727

试试这段代码，[这里](http://phpfiddle.org/main/code/udz-2vr)有演示 请只使用这个想法而不是确切的副本。

```
<?php

error_reporting(E_ALL ^ E_NOTICE);
//debugging

if(@$_POST['submit'] == 'Submit'){
 echo '<pre>';
    print_r($_POST);
 echo '</pre>';
 echo "<br>\n";
 echo 'Number of posts = count($_POST["posts"])='.count(@$_POST['posts'])."<br>\n";

 //finding number of posts that are set and not empty
 $count = 0;
 foreach($_POST['posts'] as $v1){
  //$v is an array
  foreach($v1 as $v1k=> $v1v){
   if(strlen($v1v) > 0){
    ++$count;
    $inputs[$v1k] = $v1v;
   }
  }
 }

 echo 'Count of non-empty posts = $count = '.$count."<br>\n";
 echo '<pre>';
    print_r($inputs);
 echo '</pre>';
}
?>
<form name="scraped" action="" method="post">
        <input type="hidden" name="OSscraper_hidden" value="N">
        <?php
            $articles =array('test');
            $inpCnt = 0;
            foreach($articles as $item) {
        ?>
        <input type="text" name="posts[][title_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][name_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][url_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][img_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][pet_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][color_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][value_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][height_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][weight_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][hair_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][eyes_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][race_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][phone_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][address_<?php echo $inpCnt; ?>]">
        <input type="text" name="posts[][zip_<?php echo $inpCnt; ?>]">
        <?php 
            $inpCnt++;
        } ?>
        <input type="submit" value="Submit" name="submit">
    </form> 
```

# ios - 当结果为零时，UISearchDisplayController 多个分隔线

> ID：14551401
> 
> 赞同：1
> 
> 时间：2013-01-27T19:40:52.787
> 
> 标签：ios, uitableview, uisearchdisplaycontroller

使用 UISearchDisplayController 我发现了以下问题，如在[此 URL](http://postimage.org/image/3zkrxl309/)上传的图像中所示。

行的默认高度是 74，但是当结果为零时，我不会发生什么，但会出现多条分隔线。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
     return 74;
}

   -(BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    [self performSelectorInBackground:@selector(loadMySearchObjectsInBackground) withObject:nil];  
    return NO;
}

- (void) loadMySearchObjectsInBackground{
    NSString *searchStr=self.searchDisplayController.searchBar.text;
    NSArray *foundItems;
    .....Code to fetch Result from Server.......
    [self.searchDisplayController.searchResultsTableView reloadData];
} 
```

当结果> 0 时，上面的代码可以正常工作。但是当 foundItems count=0 时会导致问题。

任何想法都可以解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:49:59.893

```
- (void)searchBarTextDidEndEditing:(UISearchBar *)searchBar{
   if ([self.searchDataArray count] == 0) needSeparateCell = NO;
   else needSeparateCell = YES:
} 
```

在 numberOfRowsInSection 和 cellForRowAtIndexPath 中设置 separatorSyteNone

```
if (tableView == self.searchDisplayController.searchResultsTableView){
    if(!needSeparateCell) {
        [tableView setSeparatorStyle:UITableViewCellSeparatorStyleNone];
    } else {
        [tableView setSeparatorStyle:UITableViewCellSeparatorStyleSingleLine];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-14T22:30:16.540

如果您不需要 tableFooterView，有一种非常干净的方法可以实现这一点。

```
self.searchDisplayController.searchResultsTableView.tableFooterView = [UIView new]; 
```

这将删除最后一个单元格下方的所有分隔符。因此，如果您的 tableView 为空，则根本没有分隔线。

它对我来说适用于任何类型的 UITableView。

# java - 2 个运营商网络之间的套接字连接问题

> ID：14551409
> 
> 赞同：2
> 
> 时间：2013-01-27T19:41:10.447
> 
> 标签：java, android, sockets, 3g

我在android上写了一个简单的socket程序，服务端设置一个服务端socket等待传入的连接，客户端通过与服务端的ip地址建立连接来连接服务端。我使用 Sprint 的 3G Nexus S 作为服务器，使用 ATT 的 4G Samsung Galaxy S3 作为客户端。当我的客户端尝试连接时，它会抛出异常“没有到达目的地的路线”。但后来我切换到我的个人 WIFI 网络，它运行良好。有人可以帮我解决这个问题吗？或者在android中使用蜂窝网络建立套接字连接有什么特殊要求吗？谢谢你！

我的客户端是：

```
socket = new Socket(serveripaddress, 8008);
out = new PrintWriter(socket.getOutputStream()); 
```

我的服务器端是：

```
ss = new ServerSocket(8008); 
```

更新：我刚刚使用了 2 部 Sprint 手机来测试我的代码，它运行良好！！这只是我必须使用手机作为服务器的特殊情况，一般不推荐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:36:00.047

运营商防火墙通常不允许传入连接到移动设备。这样做会使移动设备面临安全风险和滥用其数据限制。它还可以取决于用于连接的 APN。

# mysql - 通过另一个表中的另一列更新值

> ID：14551416
> 
> 赞同：0
> 
> 时间：2013-01-27T19:42:15.860
> 
> 标签：mysql, sql-update

我需要一个查询：

从数据库播放器、表 item_proto_0、列 locale_name 复制

粘贴到数据库播放器、表 item_proto、列 locale_name

**但：**

只需粘贴 if 具有相同的列 vnum

**我试过了：**

```
UPDATE item_proto.locale_name 
SET item_proto_0.locale_name 
WHERE item_proto_0.vnum=item_proto.vnum 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:48:28.870

试试这个：

```
UPDATE item_proto P1
    JOIN item_proto_0 P2
       ON P1.vnum = P2.vnum
SET P1.locale_name = P2.locale_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:47:33.290

这应该有效：

```
UPDATE item_proto AS ip
    INNER JOIN item_proto_0 ip0 ON ip.vnum = ip0.vnum
SET locale_name = ip0.locale_name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:08:05.477

请运行此 sql 查询，这应该可以满足需要

```
UPDATE item_proto
inner join item_proto_0 on item_proto.vnum = item_proto_0.vnum
SET item_proto.locale_name = item_proto_0.locale_name 
```

# macos - 列出所有应用程序的所有窗口

> ID：14551419
> 
> 赞同：10
> 
> 时间：2013-01-27T19:42:39.243
> 
> 标签：macos, window, applescript

我正在尝试编写一个调整所有打开窗口大小的applescript 脚本。为了确保我可以访问所有窗口，我让我的脚本说出应用程序的名称以及该应用程序的打开窗口数。
有趣的是，当我听到所有打开的应用程序的名称时，我的脚本说它们都打开了 0 个窗口。我该如何解决这个问题？

这是我的代码：

```
tell application "System Events"
    repeat with theProcess in (every process)
        if background only of theProcess is false then
            if name of theProcess is not "Finder" then
                if name of theProcess is "Google Chrome" then
                    say "Chrome woo hoo"
                    say (count windows as string)
                else
                    say name of theProcess as string
                    say (count windows as string)
                    tell theProcess
                        repeat with theWindow in windows
                            say "found a window of"
                            say (name of theProcess) as string
                            tell theWindow
                                click button 2
                            end tell
                        end repeat
                    end tell
                end if
            end if
        end if
    end repeat
end tell 
```

我在 Mac OS X 10.7.5 上，使用 automator 2.2.4 编写/运行这个 applescript

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T22:04:36.193

你必须告诉进程计算窗口。毕竟是进程知道它的窗口，而不是系统事件。

您已经告诉进程说出它的名称，例如“将进程的名称说成字符串”，但是您只使用“说（将窗口计数为字符串）”......没有进程与此相关。尝试“计算进程的窗口”。基本上你有一些台词，有时你会告诉过程，有时你不会，有时你会告诉过程，即使你已经告诉了过程，所以你做了两次。那就是你有“说（进程的名称）作为字符串”的地方，但该代码在“告诉进程”块内，所以它已经被告知进程。

真的，您需要仔细检查您的代码并更加精确。提示...如果您想单击窗口中的按钮，则该窗口必须位于屏幕的最前面，否则您无法单击它。另一个提示......“名称”已经是一个字符串，所以你不需要将它强制转换为一个字符串。

顺便说一句，我同意 Michael Dautermann 对您的帖子的评论……您将无法访问某些流程。但随着你的进步，你会发现这一点。

以下是我将如何编写您的代码。基本上我会在开始时使用“tell theProcess”块来获取所有变量。然后我可以用这些变量做一些事情。我希望这会有所帮助。请注意，我只将进程放在最前面，这意味着如果它打开了多个窗口，它只会单击前面窗口上的一个按钮。您必须添加代码以使每个窗口都显示在最前面，然后才能单击其按钮。祝你好运。

```
tell application "System Events"
    repeat with theProcess in processes
        if not background only of theProcess then
            tell theProcess
                set processName to name
                set theWindows to windows
            end tell
            set windowsCount to count of theWindows

            if processName is "Google Chrome" then
                say "Chrome woo hoo"
                say windowsCount as text
            else if processName is not "Finder" then
                say processName
                say windowsCount as text
                if windowsCount is greater than 0 then
                    repeat with theWindow in theWindows
                        say "found a window of " & processName
                        tell theProcess
                            set frontmost to true
                            tell theWindow
                                click button 2
                            end tell
                        end tell
                    end repeat
                end if
            end if
        end if
    end repeat
end tell 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-04T19:02:31.700

我在 Mavericks 上创建了所有可见应用程序打开窗口的列表，如下所示：

```
tell application "System Events"
    set this_info to {}
    repeat with theProcess in (application processes where visible is true)
        set this_info to this_info & (value of (first attribute whose name is "AXWindows") of theProcess)   
    end repeat
    this_info -- display list in results window of AppleScript Editor 
end tell 
```

您需要允许任何使用它的应用程序访问辅助功能下的界面。

# android - 新的 Android Eclipse 版本无法进入工作区

> ID：14551422
> 
> 赞同：1
> 
> 时间：2013-01-27T19:42:46.970
> 
> 标签：android, eclipse

我正在尝试从 Android 编程开始（我正在运行 Mac OS X Lion）。我有一个旧版本的 Eclipse 并在其中安装了 ADT 版本 20，并且代码没有正确编译。美好的; 我在那里没有做太多事情，在这里阅读了一些东西之后，从长远来看，听起来最简单的事情就是组装一个全新的安装。

所以我从 Android 开发者入门网站下载了最新版本的 Android 和 SDK，并运行它（在它自己的目录中）。我加载了我以前的一个工作区，它说一个不起作用，因为 ADT 是 20 版，它需要 21 版。我想很好，那里没有太多，我只是开始一个新的工作区。

所以我开始了一个新的工作区，这就是真正的麻烦来的地方：它给了我一个带有新手欢迎说明的开始屏幕，但不会比这更进一步。当我尝试创建一个新的 Android 应用程序项目时，它会通过菜单，但是当我单击完成时，我会得到一个请稍候的圆形图标，并且几乎没有发生任何事情。底部有一条线，上面写着“66M of 142M”——它在 80 年代缓慢增加，然后在 60 年代无休止地下降。欢迎页面上提供的链接（构建您的第一个应用程序等）不起作用 - 我点击它们并没有任何反应。

知道这里出了什么问题吗？我的系统中是否有一些旧版本遗留下来的东西，我应该删除它们？如果是这样，我应该怎么做？如果没有，我还能尝试什么让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:50:58.250

由于我的水平，我无法在您的下方发表评论，但是您可以通过**[提供更多内存](https://superuser.com/questions/298451/allocating-more-memory-to-eclipse)****来帮助 Eclipse 运行得更快**。这样做会加快速度。

就安装而言，**也许可以尝试谷歌的 Eclipse + Android SDK 打包版本**。整个软件包可[在此处](http://developer.android.com/sdk/index.html)获得。它已经预先配置好工作，并为 eclipse 提供了默认安装的 ADT。当然，如果您已经有一个现有的 Eclipse，那么您想要修改它不会对您有太大帮助。但是，如果您是 Eclipse 新手，那么这是开始 Android 开发的好方法。

# assembly - 手动计算物理地址（IDTR 寄存器）

> ID：14551424
> 
> 赞同：3
> 
> 时间：2013-01-27T19:43:00.880
> 
> 标签：assembly, cpu-registers, memory-segmentation

我一直在努力解决这个问题很长时间了，但我一无所获。

这是我想要做的：如果 IDTR 中包含的值为 0x3A000，则中断向量编号 3 位于保护模式下的哪个物理地址？

我想找到一个公式来帮助我计算中断向量#3 偏移量的每个字节的物理地址，以及中断向量#3 段的每个字节的物理地址。

我一直在寻找互联网，并没有关于 IDTR 如何计算这个的可靠解释，我真的很好奇。

我也很好奇如何为实模式找到相同的物理地址......

如果有人可以帮助我找到解决此类问题的通用公式，那将是一个爆炸！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T23:33:35.333

我找到了答案。Tnx 到 Jester 和链接。:D

下图显示了 IDTR（中断描述符表寄存器）和 IDT（中断描述符表）的关系。（参考：英特尔手册）：

![在此处输入图像描述](../Images/4602c1b54db9dbe2cac3843910a17d4c.png)

这里还有一张图片，显示了 IDT 中的条目的外观（参考：英特尔手册）：

![在此处输入图像描述](../Images/6a5bf7dfd453815f6887d9b58af8e4b0.png)

IDT（中断描述表）的基地址（IDT 开始的地址）由位 16 至 47、16 和 47 （含）给出。要获得向量#3 的地址，必须将前 2 个条目的大小添加到基地址。要找到偏移量和段选择器的位所在的地址，需要找到向量的地址，然后根据第二张图片添加字节，也就是说移动到 IDT 的条目内。

“IDT 的基地址应在 8 字节边界上对齐，以最大限度地提高缓存行填充的性能。限制值以字节表示，并与基地址相加以获得最后一个有效字节的地址。一个限制值 0 会导致正好 1 个有效字节。因为 IDT 条目总是 8 个字节长，所以限制应该总是小于 8 的整数倍（即 8N – 1）。IDT 可以驻留在线性地址中的任何位置空间。如图 6-1 所示，处理器使用 IDTR 寄存器定位 IDT。该寄存器保存 IDT 的 32 位基地址和 16 位限制。- （参考：英特尔手册）

因此，应该按照手册中的说明对齐表格以获得更好的性能。出于教育目的，我将解释如何在 IDTR 包含 3A000h 时找到偏移字节和段字节的物理地址。

程序：

首先我将 3A000h 写成二进制格式，这样使用图片更容易理解数字。

所以 3A000h 变为： 0000 0000 0000 0000 0000 0000 0000 0011 1010 0000 0000 0000 注意：它是一个 48 位数字，因为 IDTR 是 48 位长。

基地址是从第 16 位开始到第 47 位结束的数字。所以：

![在此处输入图像描述](../Images/0caf882642f52695340f07d29da62442.png)

基地址 = 0000 0000 0000 0000 0000 0000 0000 0011 即 3h。

所以第一个条目位于物理地址 3。

要获得第三个条目，需要在它之前添加 2 个条目的大小，因此第三个条目的地址是：

3+2*8=19=13h

这 2 个条目乘以 8，因为一个条目是 8 个字节长。

现在要获取偏移字节的物理地址，我们只需要查看图 6.2 并看到条目如下所示：

![在此处输入图像描述](../Images/f027743568d650f9c0ae572780b87c56.png)

所以从图片中读取

段选择器的物理地址是：

19+2 和 19+2+1

或者

13h+2h 和 13h+2h+1h

偏移字节的物理地址是（假设是中断或陷阱门）：19, 19+1, 19+6, 19+7

或者

13h, 13h+1, 13h+6h, 13h+7h

* * *

**解决此类问题的一般程序：**

BaseAddress=IDTR/(2^16) -> 整数除法

限制=IDTR%(2^16)

VectorPhysicalAddress=BaseAddress+(VectorNumber-1)*8

段选择器字节的物理地址为：VectorPhysicalAddress+2 和 VectorPhysicalAddress+3

偏移字节的物理地址为：VectorPhysicalAddress、VectorPhyscialAddress+1、VectorPhysicalAddress+6​​、VectorPhysicalAddress+7

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T22:36:03.360

我有点困惑为什么您不阅读英特尔手册而不是“环顾互联网”。当然，上述[手册也可以在互联网上找到](http://www.intel.com/products/processor/manuals/)。

如果您愿意阅读*Intel® 64 和 IA-32 架构软件开发人员手册第 3A 卷：系统编程指南，第 1部分中的**第 6.10 节中断描述符表 (IDT)*，您将看到 IDTR 包含一个线性基地址（位 16- 47）和一个限制（位 0-15）。另请注意，手册*中说限制应始终小于 8 的整数倍*，因此，您的示例无效（也不是特别合理的基地址）。要获取物理地址，您必须通过正常的分页机制（如果启用）。每个中断的处理程序由表中的 8 字节描述符定义。更多详细信息请参见手册。**`0x3a000``3`**

 **在实模式下，中断向量是从物理地址 0 开始的 4 字节远指针。**

# android - Android 选项菜单显示为列表

> ID：14551427
> 
> 赞同：0
> 
> 时间：2013-01-27T19:43:36.610
> 
> 标签：android, android-layout, android-menu

我创建了一个菜单，单击设备上的菜单按钮即可激活该菜单，但它显示为列表

![菜单](../Images/56fdade44add55ef0a93b8eebf517254.png)

我在 res/menu/menu.xml 中的代码如下：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:id="@+id/menuRefresh"
     android:icon="@drawable/ic_menu_refresh"
     android:title="Refresh"/>
<item android:id="@+id/menuAbout"
     android:icon="@drawable/ic_menu_info_details"
     android:title="About"/>
</menu> 
```

在我的主要活动中，我有：

```
//Initiate Menu XMl file
    @Override
    public boolean onCreateOptionsMenu(Menu menu){
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.menu.menu, menu);
        return true;
    }

    /**
     * Even handling for individual menu items selected
     * Identity single menu item by its id
     */
    @Override
    public boolean onOptionsItemSelected(MenuItem item){
        switch(item.getItemId()){
        case R.id.menuRefresh:
            Toast.makeText(MainActivity.this, "Refresh Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menuAbout:
            Toast.makeText(MainActivity.this, "About Selected", Toast.LENGTH_SHORT).show();
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    } 
```

如果我从列表中选择一个项目，我会按预期收到通知。

如何使菜单看起来像[android 开发网站](http://developer.android.com/guide/topics/ui/menus.html)上的选项菜单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:46:47.987

这就是选项菜单在新设备上的样子，一个列表。如果您希望您的选项成为顶部栏（称为操作栏）的一部分，请添加`android:showAsAction`到您的 xml.xml 中。

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:id="@+id/menuRefresh"
     android:icon="@drawable/ic_menu_refresh"
     android:title="Refresh"
      android:showAsAction = "always"/>
<item android:id="@+id/menuAbout"
     android:icon="@drawable/ic_menu_info_details"
     android:title="About"
     android:showAsAction = "always"/>
</menu> 
```

出于演示目的，我将属性选择为 be `"always"`，但您有[更多选择](http://developer.android.com/guide/topics/resources/menu-resource.html)：

*   `"ifRoom"`

*   `"never"`

*   `"withText"`

*   `"always"`

*   `"collapseActionView"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T01:50:35.183

即使在新设备中，您也可以将主题设置为旧设备，菜单将显示在旧的 6 项表格布局中：

```
<style name="AppBaseTheme" parent="android:Theme"> 
```

# performance - Oracle ADF 表行选择性能调优？

> ID：14551435
> 
> 赞同：0
> 
> 时间：2013-01-27T19:44:17.013
> 
> 标签：performance, oracle-adf, query-performance

我的 jspx 页面中的 ADF 表组件有问题。在我的表中，每行包含 2 个 LOV 组件（选择）。表行选择值为“单”。单击行表后 5 秒或更长时间后会激活编辑当前行。该表是我页面中最常用的组件。信息入口由该组件提供。所以我需要提高这个组件的性能。

我尝试了上面的一些技术，但还没有找到解决方案。

*   视图对象调整
*   迭代器范围大小和获取大小是等价的
*   表格内容交付 =“立即”... 等等。

    在页面定义迭代器范围大小 =“50” 表 fetchSize =“50”

该表是我页面中另一个视图对象的详细表。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T11:44:48.257

您需要分析您的应用程序以了解导致它的代码部分。尝试减少从数据库中检索的最大行数。示例：VO -> 常规 -> 调整 -> 只到第 10 行

# html - 在 Div 淡入和从 Div 淡出

> ID：14551436
> 
> 赞同：0
> 
> 时间：2013-01-27T19:44:23.327
> 
> 标签：html, callback, fadein, fadeout

当我到达站点目的地的这一点时，发生了滚动路径事件。从下面的代码可以看出，当用户移动到这个特定点时，“我的工作”，div“#mywork”淡入，（因为它的 css 最初设置为 display:hidden。）

```
path.lineTo( 3220, 4600,{
callback: function() {
    $("#mywork").fadeIn(2000, "linear");}, name: "mywork"}); 
```

我希望“#mywork” div 在用户离开此点时淡出（即滚动离开它，和/或单击不同的导航链接。）如果用户返回，我希望 div 淡出像往常一样进入视野。

有什么建议么？如果您能找到时间帮助我，请提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:35:17.227

我认为这个图书馆可以帮助你。您将使用它来代替 path.lineTo。

[https://github.com/sakabako/scrollMonitor](https://github.com/sakabako/scrollMonitor)

# java - 提取哪个通道 - ImageJ

> ID：14551437
> 
> 赞同：1
> 
> 时间：2013-01-27T19:44:32.803
> 
> 标签：java, image-processing, imagej

我有一张图像，我试图根据图像的红色、蓝色或绿色来提取某个通道。

例如，如果我的图像主要是红色，我想提取红色通道。我已经有了可以为我提取频道的代码：

```
private ImageProcessor getRedChannel(ImageProcessor ip) {
    RGBStackSplitterSean splitter=new RGBStackSplitterSean();
    splitter.split(new ImagePlus("tempImage",ip));
    ImagePlus red=new ImagePlus("tempImage",splitter.red);
    return red.getProcessor();
} 
```

如何确定哪个频道最强？

谢谢！

### 编辑：

我最终按照@mmgp 提到的那样做。总结每个通道的所有强度并使用以下方法选择最大的：

```
private int getSumPixels(ImageProcessor ip){
        int sum = 0;
        for(int i=0; i<ip.getWidth(); i++){
            for(int k=0; k<ip.getHeight(); k++){
                sum = sum + ip.getPixel(i, k);
            }
        }
        return sum;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T02:04:45.477

将每个通道的所有强度相加，并选择总和最大的一个。

# php - 谷歌地图地理编码。在 2 个 textboxws 中显示 lat 和 lng 的功能

> ID：14551440
> 
> 赞同：0
> 
> 时间：2013-01-27T19:45:07.647
> 
> 标签：php, javascript, mysql, maps

[http://gmaps-samples.googlecode.com/svn/trunk/geocoder/singlegeocode.html](http://gmaps-samples.googlecode.com/svn/trunk/geocoder/singlegeocode.html)

嗨，这是我的第一篇文章。

我正在尝试编辑上面链接中的代码，以在 2 个 texbox 中显示地址的纬度和经度，以便我可以将其保存到 mysql 数据库中。然后，如果有人查看那里的个人资料，我将使用这个 lat.lng 来显示该用户的位置

我真的很感激任何帮助，因为我已经为此苦苦挣扎了好几个星期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:56:09.453

种族灭绝方法调用的响应应返回一个对象，该对象的一个​​属性将是 google.maps.LatLng 对象。您可以在类和 assig 上调用 .lat() 和 .lng() 吸气剂。文本框的值

# apache-flex - 如何使 BitmapImage 适合其容器的宽度？

> ID：14551443
> 
> 赞同：0
> 
> 时间：2013-01-27T19:45:19.400
> 
> 标签：apache-flex, flex4

我正在尝试使 BitmapImage 标记与其容器一样宽，同时缩放位图。我使用这段代码实现了它，我认为你会发现它很明显：

```
<s:BitmapImage id='image' width='100%' source='assets/eyes.jpg' scaleMode="letterbox"/> 
```

我遇到的问题是，在容器宽度和图像大小的某些组合下，位图根本不显示。我减少了这个问题，发现如果我向上（或向下）取整（或向下） BitmapImage 的高度（例如，使用计时器），它会完美显示。所以我假设问题与高度是一些奇怪的十进制数有关（尽管它确实适用于一些非整数高度）。

有人发现同样的问题吗？如果您需要，我有代码可以重现它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T06:25:29.130

```
 <s:controlBarContent>
    <mx:Form id="fid">
        <mx:FormItem id="fiid" label="cornerRadius:">
            <s:HSlider id="sl"
                       minimum="0"
                       maximum="{bmpImg.height/2}" />
        </mx:FormItem>
    </mx:Form>
</s:controlBarContent>
<s:Group id="grp" width="50%" height="50%" horizontalCenter="0" verticalCenter="0" color="RED" >

<s:BitmapImage id="bmpImg" depth="100" width="{grp.width}" height="{grp.height}"
               source="@Embed('assets/image1.jpg')"
               horizontalCenter="0" verticalCenter="0">
    <s:mask>
        <s:BorderContainer id="bmpMask"
                           cornerRadius="{sl.value}"
                           width="{bmpImg.width}" height="{bmpImg.height}" />
    </s:mask>
</s:BitmapImage>
</s:Group> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T06:20:44.060

```
 <s:Group id="grp" width="50%" height="50%" horizontalCenter="0" verticalCenter="0" color="RED" >

<s:BitmapImage id="bmpImg" depth="100" width="{grp.width - 20}" height="{grp.height - 30}"
               source="@Embed('assets/image1.jpg')"
               horizontalCenter="0" verticalCenter="0">
    <s:mask>
        <s:BorderContainer id="bmpMask"
                           cornerRadius="{sl.value}"
                           width="{bmpImg.width}" height="{bmpImg.height}" />
    </s:mask>
</s:BitmapImage>
</s:Group> 
```

# ios - NSPredicate 与继承的多对多关系

> ID：14551446
> 
> 赞同：0
> 
> 时间：2013-01-27T19:45:30.313
> 
> 标签：ios, cocoa-touch, core-data, nspredicate

我正在开发一个有 Post 对象的应用程序，每个 Post 可以有许多实体（提及、主题标签和链接），每个实体都有一个 Post。我有一个实体的主类，然后我有三个子类。

```
Mention : Entity 
```

我的提及类具有以下属性：

```
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSNumber * userId; 
```

我现在想创建一个`NSPredicate`查找所有提到某个用户和的帖子，但`userId`我不知道该怎么做。

我已经尝试过一些这样的事情：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY mentions.userId like %@",  [Session currentUser].userId];
// That doesn't work since Post(s) have many entities and not Mention(s).
// I have also tried something like this:
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY entities.mentions.userId like %@",  [Session currentUser].userId];
// And that didn't work either. 
```

关于如何最好地找到所有提到具有特定 userId 的特定用户的帖子的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:14:16.960

继承是存在的，因此您不必对相等的属性进行两次编码。否则，具有父对象的托管对象就像其他托管对象一样。

因此，你应该给你的帖子三个关系：

```
Post
 hashes   Hash        
 mentions Mention     
 links    Link 
```

那么你的问题就变得微不足道了：

```
[NSPredicate predicateWithFormat:@"ANY hashes.userID = %@", _currentUser.userID]; 
```

like 没有意义，as`userID`可能是唯一的，并且`LIKE`比简单的等价要昂贵得多。

* * *

如果您只想要与一类实体的一对多关系，则必须在 中包含另一个属性`Entity`，例如 an `NSNumber`，以指示它是什么类型。`enum`假设您使用 an使数字类型更具可读性，谓词将如下所示：

```
[NSPredicate predicateWithFormat:
       @"ANY (entity.type == %@ && entity.userID == %@)",
       @(EntityTypeMention), _currentUser.userID]; 
```

# c# - 如何在 Sharepoint 2010 中为 Coded UI 手动编码人员选择器

> ID：14551450
> 
> 赞同：0
> 
> 时间：2013-01-27T19:45:42.713
> 
> 标签：c#, visual-studio-2010, coded-ui-tests

我正在尝试自动化 sharepoint 2010 人员选择器，但即使突出显示窗口内的任何控件也非常困难。我使用手动编码来查找窗口，但窗口内的控件没有突出显示。

```
 WinWindow pp = new WinWindow(browserWindow);
        pp.TechnologyName = "MSAA";
        pp.SearchProperties[WinWindow.PropertyNames.ClassName] = "Internet Explorer_TridentDlgFrame";
        pp.SearchProperties[WinWindow.PropertyNames.ControlType] = "Window";
        pp.SearchProperties[WinWindow.PropertyNames.Name] = "Select People -- Webpage Dialog";
        pp.Find();
        pp.DrawHighlight();

Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument doc = new Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument(pp);
        doc.TechnologyName = "Web";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.TagName] = "BODY";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.FrameDocument] = "False";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.RedirectingPage] = "False";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.ControlType] = "Document";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.Title] = "Select People";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.PageUrl] = PAGE_URL_Here;
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.AbsolutePath] = AbsolutePath_Here;
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.ClassName] = "HtmlBody";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.FriendlyName] = "Select People";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.HasFocus] = "False";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.Exists] = "True";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.Enabled] = "True";
        doc.SearchProperties[Microsoft.VisualStudio.TestTools.UITesting.HtmlControls.HtmlDocument.PropertyNames.IsTopParent] = "False";
        doc.Find();
        doc.DrawHighlight(); 
```

上面的代码很容易突出显示人物选择器窗口，并使用此对象查找其中没有找到任何控件。

它显示此错误...

```
 The playback failed to find the control with the given search properties. Additional Details: 
TechnologyName:  'Web'
TagName:  'BODY'
FrameDocument:  'False'
RedirectingPage:  'False'
ControlType:  'Document' 
```

我做对了吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T08:56:24.053

我找到了答案，.. 使用十字准线或录制将 peoplepicker 上的控件显示为单独的控件，但在通过代码查找时，其中的所有控件都显示为编辑框。因此需要将所有控件存储在 UITestControlCollection 中，并使用循环使用其 name 属性查找所需的控件。然后执行鼠标或键盘操作。

```
//write ur code here to find the parent control
UITestControlCollection controlFound = matching.FindMatchingControls();
//use loop to find the control 
```

# python - 在python中处理一个非常非常大的数据集 - 内存错误

> ID：14551451
> 
> 赞同：6
> 
> 时间：2013-01-27T19:45:42.990
> 
> 标签：python, numpy, python-2.7, data-analysis

我正在尝试使用 python 中的 csv 模块处理从 csv 文件中获得的数据。其中大约有 50 列和 401125 行。我使用以下代码块将该数据放入列表中

```
csv_file_object = csv.reader(open(r'some_path\Train.csv','rb'))
header = csv_file_object.next()
data = []
for row in csv_file_object:
    data.append(row) 
```

我可以使用 len(data) 获取此列表的长度，它返回 401125。我什至可以通过调用列表索引来获取每个单独的记录。但是当我尝试通过调用 np.size(data) （我将 numpy 作为 np 导入）来获取列表的大小时，我得到了以下堆栈跟踪。

> MemoryError Traceback (最近一次调用最后一次) in () ----> 1 np.size(data)
> 
> C:\Python27\lib\site-packages\numpy\core\fromnumeric.pyc in size(a, axis) 2198 return a.size 2199 except AttributeError: -> 2200 return asarray(a).size 2201 else: 2202 try:
> 
> C:\Python27\lib\site-packages\numpy\core\numeric.pyc in asarray(a, dtype, order) 233 234 """ --> 235 return array(a, dtype, copy=False, order=order ) 236 237 def asanyarray(a, dtype=None, order=None):
> 
> 内存错误：

我什至不能使用列表索引将该列表分成多个部分，或者将该列表转换为一个 numpy 数组。它给出了同样的内存错误。

我该如何处理这种大数据样本。有没有其他方法可以处理像这样的大型数据集。

我在 Windows 7 Professional 中使用 ipython notebook。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-27T20:10:30.923

正如@DSM 在评论中所指出的，您遇到内存错误的原因是调用`np.size`列表会先将数据复制到数组中，然后再获取大小。

如果您不需要将其作为 numpy 数组使用，请不要调用`np.size`. 如果你确实想要类似 numpy 的索引选项等等，你有几个选择。

您可以使用[pandas](http://pandas.pydata.org/)，它用于处理大型非必要数字数据集，并且有一些很好的帮手和东西。

如果您不想这样做，您可以首先定义一个 numpy[结构数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)并逐行填充它，而不是制作一个列表并复制到其中。就像是：

```
fields = [('name1', str), ('name2', float), ...]
data = np.zeros((num_rows,), dtype=fields)

csv_file_object = csv.reader(open(r'some_path\Train.csv','rb'))
header = csv_file_object.next()
for i, row in enumerate(csv_file_object):
    data[i] = row 
```

您也可以定义`fields`基于，`header`这样您就不必手动输入所有 50 个列名，尽管您必须为每个列指定数据类型。

# ruby-on-rails - 如何使用其他表中的数据填充 rails 表？

> ID：14551453
> 
> 赞同：1
> 
> 时间：2013-01-27T19:45:47.233
> 
> 标签：ruby-on-rails, ruby-on-rails-3, database-design

我是一个菜鸟程序员，如果问题不够清楚，我深表歉意。

我正在尝试创建一个基本的 Rails 应用程序，其中有 3 个不同的表：用法（月，用法）、价格（月、价格）和支出（月、支出）。我试图得到它，以便花费 = usages.usage * prices.price。我已将以下代码放入我的 Spend 模型中：

```
class Spend < ActiveRecord::Base
  c = Usage.all.count
      i = 1
      while i <= c
          u = Usage.find(i)
          p = Price.find(i)
          Spend.create(month:u.month, spend:u.usage*p.price)
          i += 1
      end
end 
```

这最初效果很好，但是一旦我开始添加和删除用途和价格，它们的 id 就会发生变化，所以它并不那么明确。我怎样才能以更好的方式做到这一点？

谢谢，

凯夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:06:19.460

在这种情况下，我不会建立一个单独的`Spend`模型，因为它所做的只是计算数据库中已经存在的数据。除非您有严格的缓存要求（我怀疑您的情况），否则您可以使用简单的实例方法来检索您想要的数据。

首先弄清楚你的使用和价格模型是如何相关的。由于您似乎是通过 id 关联它们，因此它似乎是一对一的关系（如果我在这方面错了，请纠正我）。但是，通过假设它们具有相同的主键来关联是一种危险的方法 - 而是使用外键让一个模型指向另一个模型。我们将选择`Price`模型来保存 的主键`Usage`，但反过来也可以。您需要使用如下迁移添加列：

```
def change
  add_column :prices, :usage_id, :integer
end 
```

您的模型应如下所示：

```
class Usage < ActiveRecord::Base
  has_one :price

  def spend
    usage * price.price
  end
end

class Price < ActiveRecord::Base
  belongs_to :usage
end 
```

您可以像这样找到`spend`单个`usage`项目的价值：

```
usage = Usage.find(some_id)
puts usage.spend 
```

或者您可以像这样获得多个“支出”：

```
Usage.include(:price).each do |usage|
  puts usage.spend
end 
```

我省略了对月份的任何参考，因为我不确定您是如何使用它的，或者是否需要它来计算`spend`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:55:40.707

查看 Active Record 关联指南： http: [//guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# html - 仅在 CSS 中同时运行动画

> ID：14551461
> 
> 赞同：1
> 
> 时间：2013-01-27T19:46:53.903
> 
> 标签：html, css, animation, stylesheet

我正在尝试同时运行两个动画。一切对我来说看起来都很完美，但它的行为真的很古怪，我不知道为什么。我想把整个事情都保存在 CSS 中。

正如评论中所发布的，这是工作页面的当前版本：fallowproduction.com/cowabduction/csspractice1.html

它目前只能在 chrome 中 100% 运行，或者我想是 Safari。

CSS 表在这里：fallowproduction.com/cowabduction/practice1StyleSheet.css

如果你注意到，最左边的那头牛就是我正在研究的那头。当不明飞行物在他上方时，他应该向上移动（据我所知，这一切都是正确的）。然而，相反，他只是慢慢地消失了

这是代码的摘录：

```
 .ufo {
left: 0px;
top: 0px;
z-index: 25;
left: 0px;
top: 0px;
width= 225px; 
height= 142px;
position: absolute;

animation: move_ufo 180s ease 0 1;
-moz-animation: move_ufo 180s ease 0 1; /* Firefox 4 */ 
-webkit-animation: move_ufo 180s ease 0 1; /* Safari and Chrome */
-o-animation: move_ufo 180s ease 0 1; /* Opera */

}

@-webkit-keyframes move_ufo {
    0% { left: 0px; top: 0px; }   /* Move to cow6 */
    1.75% { left: 456px; top: 10px; }
    4.55% { left: 456px; top: 10px; }   /* Move to cow2 */
    6.29% { left: 103px; top: 92px; }
    9.09% { left: 103px; top: 92px; }   /* Move to cow7 */
    10.84% { left: 566px; top: 110px; }
    13.64% { left: 566px; top: 110px; }   /* Move to cow4 */
    15.38% { left: 316px; top: -1px; }
    18.18% { left: 316px; top: -1px; }   /* Move to cow1*/
    19.93% { left: 4px; top: 61px; }
    22.73% { left: 4px; top: 61px; }   /* Move to cow8*/
    24.48% { left: 166px; top: 154px; }
    27.27% { left: 166px; top: 154px; }   /* Move to cow5*/
    29.02% { left: 458px; top: 10px; }
    31.82% { left: 458px; top: 10px; }   /* Move to cow10 */
    33.57% { left: 197px; top: -16px; }
    36.36% { left: 197px; top: -16px; }   /* Move to cow3*/
    38.11% { left: 217px; top: 68px; }
    40.91% { left: 217px; top: 68px; }   /* Move to cow9*/
    42.66% { left: 573px; top: -2px; }
    45.45% { left: 573px; top: -2px; }   /* Move */
    47.20% { left: 333px; top: 55px; }
    50.00% { left: 371px; top: 48px; }   /* Move to cow1*/
    51.75% { left: 4px; top: 61px; }
    54.55% { left: 4px; top: 61px; }   /* Move to cow7*/
    56.29% { left: 566px; top: 110px; }
    59.09% { left: 566px; top: 110px; }   /* Move to cow4*/
    60.84% { left: 316px; top: -1px; }
    63.64% { left: 316px; top: -1px; }   /* Move to cow8*/
    65.38% { left: 166px; top: 154px; }
    68.18% { left: 166px; top: 154px; }   /* Move to cow6*/
    69.93% { left: 456px; top: 10px; }
    72.73% { left: 456px; top: 10px; }   /* Move to cow10*/
    74.48% { left: 197px; top: -16px; }
    77.27% { left: 197px; top: -16px; }   /* Move to cow2 */
    79.02% { left: 103px; top: 92px; }
    81.82% { left: 103px; top: 92px; }   /* Move to cow5*/
    83.57% { left: 458px; top: 10px; }
    86.36% { left: 458px; top: 10px; }   /* Move to cow9*/
    88.11% { left: 573px; top: -2px; }
    90.91% { left: 573px; top: -2px; }   /* Move to cow3*/
    92.66% { left: 217px; top: 68px; }
    95.45% { left: 217px; top: 68px; }   /* Move */
    97.20% { left: 300px; top: 25px; }   
    100% { left: 0px; top: 0px; }   /* Original Location */

}

/* Cows and tractor beams */

.cow1 {
left: 80px;
top: 450px;
position: absolute;
z-index: 4;

/* Animation */
animation: move_cow1 180s;
-moz-animation: move_cow1 180s; /* Firefox 4 */ 
-webkit-animation: move_cow1 180s ease 0 1; /* Safari and Chrome */
-o-animation: move_cow1 180s; /* Opera */
}

@-webkit-keyframes move_cow1 {
    0% { left: 80px; top: 450px; } 
    19.93% { left: 80px; top: 450px; } /* UFO is at cow1 */
    22.73% { left: 80px; top: 61px; }  /* cow1 is being lifted */
    22.74% { opacity: 0; ; } /* cow1 disappears */

    51.75% { left: 4px; top: 61px; }
    54.55% { left: 4px; top: 61px; }   /* Move to cow7*/
    100% { left: 80px; top: 450px; }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:34:00.860

Try this:

```
@-webkit-keyframes move_cow1 {
    0% { opacity: 1; left: 80px; top: 450px; } 
    19.93% { opacity: 1; left: 80px; top: 450px; } /* UFO is at cow1 */
    22.73% { opacity: 1; left: 80px; top: 61px; }  /* cow1 is being lifted */
    22.74% { opacity: 0; } /* cow1 disappears */

    51.75% { left: 4px; top: 61px; }
    54.55% { left: 4px; top: 61px; }   /* Move to cow7*/
    100% { left: 80px; top: 450px; }

} 
```

# python - 创建编号目录并按范围分组

> ID：14551462
> 
> 赞同：-1
> 
> 时间：2013-01-27T19:46:54.423
> 
> 标签：python

执行以下操作的正常方法是什么？我在目录中有一些文件（例如）：

```
01, 02, 03
10, 15
35
41, 44, 49 
```

我想创建并将它们放在这样的目录中：

```
01-10
11-20
31-40
41-50 
```

我完全不确定是否有范围列表、开始/结束数字列表或字典。谢谢你的帮助。

编辑：我造成了一些混乱，对此我深表歉意。

我有以下文件：

```
01.txt
02.txt
03.txt
10.txt
15.txt
35.txt
41.txt
44.txt
49.txt 
```

我在与上述文件相同的目录中有以下目录：

```
01-10
11-20
31-40
41-50 
```

我想将 .txt 文件移动到它们所属的目录中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:52:16.323

您的代码应该：

1.  遍历每个文件
2.  确定应该包含该文件的目录的名称
3.  如果目录不存在则创建
4.  将文件移动到目录中

要实现 2，您应该编写一个函数，给定文件名返回相应的目录名。首先，您假设文件名的基本名称是一个数字：

```
n = int(os.splitext(filename)[0]) 
```

然后使用以下表达式

```
d = (n-1)//10 
```

这给出了数字 41 -> 4、50 -> 4 的正确分组。而这个：

```
dir = '%2.2d-%2.2d' % (10*d+1,10*(d+1)) 
```

转换 4 -> '41-40'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:53:16.787

从 manu-fatto 开始，至少这表明了从名称`filename`到`destdir`名称的转换。

`shutil.move(src, dst)`尽管我认为您必须小心，但以不同的方式移动文件可能会有所帮助。

```
import os.path

def destdir(filename):
    f =  int(os.path.splitext(filename)[0])
    d = (f - 1) // 10
    return "%02d-%02d" % (10*d+1,10*(d+1))

def filenames():
    """OP to write implementation"""
    n = 23
    for x in range(1, n + 1):
        yield "%02d.txt" % x

for filename in filenames():
    print filename, destdir(filename) 
```

输出：

```
01.txt 01-10
02.txt 01-10
03.txt 01-10
04.txt 01-10
05.txt 01-10
06.txt 01-10
07.txt 01-10
08.txt 01-10
09.txt 01-10
10.txt 01-10
11.txt 11-20
12.txt 11-20
13.txt 11-20
14.txt 11-20
15.txt 11-20
16.txt 11-20
17.txt 11-20
18.txt 11-20
19.txt 11-20
20.txt 11-20
21.txt 21-30
22.txt 21-30
23.txt 21-30 
```

# python - 在python中嵌入R代码

> ID：14551472
> 
> 赞同：12
> 
> 时间：2013-01-27T19:48:15.313
> 
> 标签：python, r

我需要在 python 程序中进行计算，我更愿意在 R 中进行一些计算。是否可以在 python 中嵌入 R 代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T19:51:05.217

您应该看一下[rpy](http://rpy.sourceforge.net/)（[此处](http://rpy.sourceforge.net/rpy/doc/rpy.pdf)的文档链接）。

这允许您执行以下操作：

```
from rpy import * 
```

然后你可以`r`像在 R 中那样使用调用的对象进行计算。

这是从文档中提取的示例：

```
>>> from rpy import *
>>>
>>> degrees = 4
>>> grid = r.seq(0, 10, length=100)
>>> values = [r.dchisq(x, degrees) for x in grid]
>>> r.par(ann=0)
>>> r.plot(grid, values, type=’lines’) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-27T19:57:35.263

[RPy](http://rpy.sourceforge.net/)是这类事情的朋友。

scipy、numpy 和 matplotlib 包都对 R 做了类似的事情，并且非常完整，但是如果你想混合语言，RPy 是最好的选择！

```
from rpy2.robjects import *

def main(): 
    degrees = 4 
    grid = r.seq(0, 10, length=100) 
    values = [r.dchisq(x, degrees) for x in grid] 
    r.par(ann=0) 
    r.plot(grid, values, type='l') 

if __name__ == '__main__': 
     main() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T22:01:55.170

当我需要进行 R 计算时，我通常会编写 R 脚本，并使用`subprocess`模块从 Python 运行它们。我选择这样做的原因是因为安装的 RI 版本（我认为是 2.16）与当时的 RPy 不兼容（需要 2.14）。

因此，如果您已经“按照您想要的方式”安装了 R，这可能是一个更好的选择。

# git - git packfiles 没有源代码

> ID：14551473
> 
> 赞同：1
> 
> 时间：2013-01-27T19:48:24.403
> 
> 标签：git

我是使用 git 的新手，所以很抱歉我遗漏了一些从[git book](http://git-scm.com/book/en/Git-Internals-Packfiles)中应该很明显的东西。

我想在 .a 之后查看项目的源代码，`git clone`但`git-clone`所做的只是下载`.pack`. `./objects/pack`如何将 a 提取`.pack`到源代码文件中？

[git unpack-objects](http://www.kernel.org/pub/software/scm/git/docs/git-unpack-objects.html)的输出路径是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:34:24.503

Unless your [upstream repo](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166) (the one you are cloning) is empty, you should see the content of its default branch ([usually master, unless its symbolic-ref](https://stackoverflow.com/questions/3301956/git-correct-way-to-change-active-branch-in-a-bare-repository/3302018#3302018) has set to point to am empty branch) in your working tree:

```
 git clone url/repoA
 cd repoA
 git branch # to see in which branch you are 
```

Only git clone --bare would generate an empty working tree (since it would only create a git directory repoA.git, and no working tree at all).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T23:10:12.140

你也可以试试这个从master开始一个新的'develop'分支：

```
git checkout develop 
```

# java - java.lang.NullPointerException:com.google.android.gms.maps.GoogleMap.moveCamera

> ID：14551478
> 
> 赞同：2
> 
> 时间：2013-01-27T19:48:38.200
> 
> 标签：java, android, google-maps-android-api-2

我目前正在开发新的 Google Maps Android API v2。

我的 MapActivity 类正在与我的三星 Galaxy s3 ans s2 一起使用，代码如下：

但是，有些特定设备无法正常工作，例如：GT-S5830i

```
class MapActivity extends FragmentActivity  implements OnMapClickListener, OnMapLongClickListener, OnMarkerClickListener
{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_map);

                tvLocInfo = (TextView)findViewById(R.id.locinfo);

                android.support.v4.app.FragmentManager myFragmentManager = getSupportFragmentManager();
                SupportMapFragment myMapFragment = (SupportMapFragment)myFragmentManager.findFragmentById(R.id.map);
                myMap = myMapFragment.getMap();

                myMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
                ArrayList<Cooridnates> cooridnatesList = MainActivity.getList();
                for(int i=0;i<cooridnatesList.size();i++)
                {
                    //Toast.makeText(MapActivity.this, "SIZE : " + " " + cooridnatesList.size(), Toast.LENGTH_LONG).show();
                    LatLng point = new LatLng(cooridnatesList.get(i).getLat(),cooridnatesList.get(i).getLon());
                    tvLocInfo.setText("markers added");
                    myMap.addMarker(new MarkerOptions().position(point).title(point.toString()));
                    center=CameraUpdateFactory.newLatLng(point);
                }

                CameraUpdate zoom=CameraUpdateFactory.zoomTo(16);
                myMap.moveCamera(center);
                myMap.animateCamera(zoom);
                myMap.setOnMapClickListener(this);
                myMap.setOnMarkerClickListener(this);
                markerClicked = false;
             } 
```

出于某种原因，我收到此错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.coldice.plotfinder/com.coldice.plotfinder.MapActivity}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
at android.app.ActivityThread.access$1500(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3687)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at com.google.android.gms.maps.GoogleMap.moveCamera(Unknown Source)
at com.coldice.plotfinder.MapActivity.onCreate(MapActivity.java:70)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:59:58.863

您的函数`MainActivity.getList()`可能返回了一个空列表，因此 for 循环不会执行`center=CameraUpdateFactory.newLatLng(point);`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:55:53.360

似乎中心`null`在这个 >>`myMap.moveCamera(center);`中，在将它传递给 moveCamera 方法之前对这个变量进行适当的检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:59:30.293

似乎问题就在这里。`center`可能有空值，所以为了得到正确的解释**调试**你的应用程序。

`center`在这里初始化。

```
center=CameraUpdateFactory.newLatLng(point); 
```

它可能会在中心分配空值。

```
myMap.moveCamera(center);  <<<PROBLEM is here

if(center != null )
      myMap.moveCamera(center); 
```

# xcode - 在其他两个视图之间定位 UIView。自动布局

> ID：14551483
> 
> 赞同：2
> 
> 时间：2013-01-27T19:49:01.210
> 
> 标签：xcode, ios6, constraints, autolayout

我正在使用 Autolayout 在视图中设置很多标签和按钮。一个按钮必须正好在 2 个 UILabel 之间，我不知道如何实现。我尝试获取一个标签上的位置，另一个标签的位置，进行数学运算等。但由于它使用自动布局，结果 frame.origin.x 属性始终为 0。

那么关于如何做到这一点的任何线索？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T09:05:11.017

使用设计器执行此操作的一种可能方法是放置一个容器，该容器将填充两个标签之间的空间。只需将视图拖到设计图面上并确保您具有以下约束：顶部空间到具有默认值的顶部标签，底部空间到具有默认值的底部标签。

一旦你有了这个容器，只需将按钮放置为这个容器的子元素，然后在容器中水平和垂直地居中按钮。那应该这样做。

![在此处输入图像描述](../Images/82b108ec8dd13d8f9a270d920e5e01ea.png)

这也可以通过代码来完成。让我知道是否需要示例代码。

# python - 试图理解 python csv .next()

> ID：14551484
> 
> 赞同：18
> 
> 时间：2013-01-27T19:49:09.433
> 
> 标签：python, csv, python-2.x

我有以下代码，它是教程的一部分

```
import csv as csv
import numpy as np

csv_file_object = csv.reader(open("train.csv", 'rb'))
header = csv_file_object.next()

data = []
for row in csv_file_object:
    data.append(row)
data = np.array(data) 
```

代码按预期工作，但我不清楚为什么`.next()`使用变量调用文件`header`有效。不是 csv_file_object 仍然是整个文件吗？程序如何知道在`for row in csv_file_object`调用时跳过标题行，因为一旦定义变量标题就不会出现？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-27T19:53:19.453

由于调用，标题行被“跳过” `next()`。这就是迭代器的工作方式。

当你遍历一个迭代器时，它的`next()`方法每次都会被调用。每次调用都会推进迭代器。当`for`循环开始时，迭代器已经在第二行，并且从那里开始。

这是该方法[的文档](http://docs.python.org/2/library/stdtypes.html#iterator.next)`next()`（[这是另一篇](http://docs.python.org/2/reference/expressions.html#generator.next)）。

重要的是`csv.reader`对象是迭代器，就像`open()`. 您可以迭代它们，但它们在任何给定时刻都不包含所有行（或任何行）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-27T20:00:48.363

该`csv.reader`对象是一个迭代器。迭代器是一个对象，其`next()`方法将返回下一个可用值，`StopIteration`如果没有可用值则返回。将`csv.reader`逐行返回值。

迭代器对象是python实现`for`循环的方式。在循环开始时，`__iter__`将调用循环对象的对象。它必须返回一个迭代器。然后，`next`将调用该对象的方法并将值存储在循环变量中，直到该`next`方法引发`StopIteration`异常。

在您的示例中，通过在循环构造中使用变量之前添加对 next 的调用`for`，您将从迭代器返回的值流中删除第一个值。

您可以使用更简单的迭代器看到相同的效果：

```
iterator = [0, 1, 2, 3, 4, 5].__iter__()
value = iterator.next()
for v in iterator:
    print v,
1 2 3 4 5
print value
0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T19:55:17.227

csv.reader 是一个迭代器。每次调用 .next 时，它都会从 csv 中读取一行。这是文档：[http](http://docs.python.org/2/library/csv.html) ://docs.python.org/2/library/csv.html 。迭代器对象实际上可以从一个太大而无法一次读取的源返回值。使用带有迭代器的 for 循环每次通过循环时都会有效地调用 .next 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T20:04:22.677

csv.reader 是一个迭代器。调用 .next() 将在遍历文件时获得下一个值。

在下面的代码中，for 循环每次都在迭代器上调用 .next() 并将 next 的结果分配到变量行。

```
for row in csv_file_object:
    data.append(row) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-17T02:33:08.070

next() 的行为不止于此，上面的所有暴露都可以，但是缺少一件事，还使用 ​​next 你告诉迭代器你想从哪一行开始迭代所以是一个问题让我们说我想要一些第 3 行中的值没有经过我可以轻松使用的所有行接下来我得到了该值，但是如果我需要在第一行迭代我不能因为无论迭代器仍然从第 3 行开始所以我不能从第 1 行开始，有一种方法，但我还没有找到。

# c# - PHP 无法获取作为 multipart/form-data 发送的原始数据

> ID：14551486
> 
> 赞同：0
> 
> 时间：2013-01-27T19:49:13.813
> 
> 标签：c#, php

这是客户端代码（C#）：

```
string boundary = "--ABC";

try
{
    WebRequest request = WebRequest.Create(url);
    request.Method = "POST";                
    request.ContentType = "multipart/form-data;boundary="+boundary;

    using (var requestStream = request.GetRequestStream())
    using (var writer = new StreamWriter(requestStream))
    {
        writer.WriteLine(boundary);
        writer.WriteLine("Content-Disposition: form-data; name=\"data\"");
        writer.WriteLine();
        writer.WriteLine("abcdefg");
        writer.WriteLine(boundary + "--");
        writer.Flush();
    }
    string responseData = string.Empty;
    using (var response = request.GetResponse())
    using (var responseStream = response.GetResponseStream())
    using (var reader = new StreamReader(responseStream))
    {
        responseData=reader.ReadToEnd();
    } 
```

这是服务器代码（php）：

```
print file_get_contents("php://input"); 
```

或者：

```
print $_POST["data"]; 
```

或者：

```
print $http_raw_post_data; 
```

或者：

```
$fp=fopen("php://output","rb");
$contents=fread($fp,5);
fclose($fp);
print $contents; 
```

这些代码都不起作用，全部打印为空。
有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:34:09.980

The following example illustrates "multipart/form-data" encoding. Suppose we have the following form:

```
 <FORM action="http://server.com/cgi/handle"
       enctype="multipart/form-data"
       method="post">
   <P>
   What is your name? <INPUT type="text" name="submit-name"><BR>
   What files are you sending? <INPUT type="file" name="files"><BR>
   <INPUT type="submit" value="Send"> <INPUT type="reset">
 </FORM> 
```

If the user enters "Larry" in the text input, and selects the text file "file1.txt", the user agent might send back the following data:

```
Content-Type: multipart/form-data; boundary=AaB03x

   --AaB03x
   Content-Disposition: form-data; name="submit-name"

   Larry
   --AaB03x
   Content-Disposition: form-data; name="files"; filename="file1.txt"
   Content-Type: text/plain

   ... contents of file1.txt ...
   --AaB03x-- 
```

If the user selected a second (image) file "file2.gif", the user agent might construct the parts as follows:

```
 Content-Type: multipart/form-data; boundary=AaB03x

   --AaB03x
   Content-Disposition: form-data; name="submit-name"

   Larry
   --AaB03x
   Content-Disposition: form-data; name="files"
   Content-Type: multipart/mixed; boundary=BbC04y

   --BbC04y
   Content-Disposition: file; filename="file1.txt"
   Content-Type: text/plain

   ... contents of file1.txt ...
   --BbC04y
   Content-Disposition: file; filename="file2.gif"
   Content-Type: image/gif
   Content-Transfer-Encoding: binary

   ...contents of file2.gif...
   --BbC04y--
   --AaB03x-- 
```

[Multipart Form Post in C# Example](http://www.briangrinstead.com/blog/multipart-form-post-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:48:45.630

**尝试这个：**

```
 string boundary = "AaB03x";

    try
    {
        WebRequest request = WebRequest.Create(url);
        request.Method = "POST";                
        request.ContentType = "multipart/form-data;boundary="+boundary;

        using (var requestStream = request.GetRequestStream())
        using (var writer = new StreamWriter(requestStream))
        {
            writer.WriteLine("--"+boundary);
            writer.WriteLine( "Content-Disposition: form-data; name=\"files\"; filename=\"file1.txt\"");
             writer.WriteLine("Content-Type: text/plain
    ");
            writer.WriteLine("example");        
            writer.WriteLine("--"boundary + "--");
            writer.Flush();
        }
        string responseData = string.Empty;
        using (var response = request.GetResponse())
        using (var responseStream = response.GetResponseStream())
        using (var reader = new StreamReader(responseStream))
        {
            responseData=reader.ReadToEnd();
        } 
```

# javascript - 将keydown保存在数组中并执行

> ID：14551490
> 
> 赞同：0
> 
> 时间：2013-01-27T19:49:41.380
> 
> 标签：javascript, jquery

我正在创建一个简单的 2d 游戏，我想将 keydown 键保存到数组中，并在循环中执行它们，这样用户就可以按住一个键，让它看起来像是在不停地移动。

我有一个 setInterval 函数，它就像一个游戏计时器，它一直在循环它。我添加了一个监听器和一个数组来保存密钥。

我检查了数组内的键，它看起来不错，但是函数 moveRight 和 moveLeft 无法正常工作。

这是代码：

```
 this.keysPressed = new Array();
      InitGameLoop: function () {
        var that = this;
        setInterval(function () {
            $(document).keydown(function (e) {
                var key = e.which;
                that.keysPressed.push(key);
                for (var i = 0; i < that.keysPressed.length; i++) {
                    if (that.keysPressed[i] == 38) {
                        that.moveRight(worldWidth, 10);
                    }
                    else if (that.keysPressed[i] == 37) {
                        that.moveLeft(10);
                    }
                    log(that.keysPressed, that.yPos);
                    that.keysPressed.pop();
                }
            });
        }, 60); 
```

我的问题是：

1.  我在做什么？
2.  这是一个好主意吗？（如果没有，请随时向我推荐另一个:)）

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:09:32.747

不要将按下的键存储在数组中，而是**让每个键代码激活“运动”数组中的相关变量**。例如，当按下左键时，`movement['left']=1`。用于`keyup`将其设置回 0。

让您的循环检查每个可能的运动的阵列，并在给定时刻触发相关功能到活动运动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:09:48.900

在 setInterval 中注册事件处理程序总是错误的。在您的情况下，每 60 毫秒您将创建一个额外的侦听器，当您按下一个键时，您的所有侦听器都会触发。此外，绝对不需要将它们存储在数组中。只需注册一次侦听器，每次按下键时都会触发。如果按下了多个键，侦听器将分别为每个键触发。

```
$(document).keydown(function (e) {
     var key = e.which;
     console.log(key);
     // call your according functions here
     switch (key){
     case 37: // moving left
        // do stuff
        // set a flag to indicate that you are moving left
        moveleft = true;
        break;
     case 39: // moving right
        // do stuff
        // set a flag to indicate that you are moving right
        moveright = true;
        break;
     }
}); 
```

由于您正在捕获 keydown，因此您应该设置标志。这样您就可以跟踪当前按下了哪些键。在 keyup 上，您将再次重置这些标志（需要另一个事件处理程序）。

# r - 将 ave() 与返回向量的函数一起使用

> ID：14551492
> 
> 赞同：3
> 
> 时间：2013-01-27T19:49:58.080
> 
> 标签：r

我想知道将例如分位数列添加到数据集的最佳方法是什么。我正在考虑为此使用 ave() 函数，例如 `ave(iris$Sepal.Length, iris$Species, FUN=quantile)`- 但在这种情况下，`ave()`合并由返回的值`quantile()`（在这种情况下，每个子集返回 5 个值）并将它们切割为`iris`......

提前感谢您的建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:59:07.920

关于这个一般主题有很多 SO 问题，推荐 , , , 的各种用途，或`ave()`根据个人喜好、可读性、紧凑性、灵活性、速度......这是一个简单的解决方案，似乎可以满足您的需求：`aggregate()``plyr()``reshape2::cast``data.table``aggregate()`

```
(aa <- aggregate(Sepal.Length~Species,data=iris,quantile))

##      Species Sepal.Length.0% Sepal.Length.25% Sepal.Length.50% Sepal.Length.75%
## 1     setosa           4.300            4.800            5.000            5.200
## 2 versicolor           4.900            5.600            5.900            6.300
## 3  virginica           4.900            6.225            6.500            6.900
##   Sepal.Length.100%
## 1             5.800
## 2             7.000
## 3             7.900 
```

**编辑**：重新阅读/基于评论，这不是您想要的：您需要为每一行复制汇总值，而不仅仅是每组一次。

也许

```
merge(iris,aa,by="Species") 
```

虽然这给出了一个稍微奇怪的数据框（最后一个“列”实际上是一个矩阵）。

这有点神奇，但是

```
merge(iris,with(aa,data.frame(Species,Sepal.Length))) 
```

更好——它解开`aggregate()`更多返回的奇怪数据帧（名称仍然有点不稳定）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T20:20:29.547

使用**data.table**包：

```
library(data.table)
dt <- data.table(iris)
dt[, paste0("q", 25*(0:4)) := as.list(quantile(Sepal.Length)), by="Species"] 
```

# ios - 将真实日期转换为 ios 上位置通知的触发日期字符串

> ID：14551496
> 
> 赞同：0
> 
> 时间：2013-01-27T19:50:17.917
> 
> 标签：ios, uilocalnotification

让我再试一次更清楚，我很抱歉。\ 我正在考虑尝试在 iOS 中向我的照片分配应用程序添加日期特定提醒。我希望能够拥有它，这样它就会在一年中的确切日期发出提醒，引导他们完成一年中那个时候的任务

例如：

12月31日-除夕-拍摄烟花，派对7月1日-加拿大日照庆祝活动，10月30日-万圣节前的烟花-拍摄南瓜，12月15日服装-圣诞灯！

等等。

我已经设置了一个每日提醒，每天早上 9 点触发，提醒他们完成一项任务，用户可以通过设置包中的拨动开关打开或关闭该任务。我希望有另一个“假期提醒”

这是我当前的每日提醒代码：

```
NSDateComponents *dateComponents = [calender components:(NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit)
                                                       fromDate:currentDate];

        NSDateComponents *temp = [[NSDateComponents alloc]init];

        [temp setYear:[dateComponents year]];
        [temp setMonth:[dateComponents month]];
        [temp setDay:[dateComponents day]];
        [temp setHour: 9];
        [temp setMinute:00];

        NSDate *fireTime = [calender dateFromComponents:temp];
        [temp release];

        // set up the notifier 
        UILocalNotification *localNotification = [[UILocalNotification alloc]init];

        localNotification.fireDate = fireTime;
        localNotification.timeZone = [NSTimeZone defaultTimeZone]; 
```

如何将实际日期（12 月 31 日）转换为**fireDate =** variable/string？

我希望这更清楚。我已经搜索过，但无法找到答案。谢谢

诺埃尔·切尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T01:40:01.170

您只需要在创建 fireTime 时手动指定年、月和日。

```
NSDateComponents *dateComponents = [calender components:(NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit)
                                                   fromDate:currentDate];

    NSDateComponents *temp = [[NSDateComponents alloc]init];

    [temp setYear:2013];
    [temp setMonth:12];
    [temp setDay:31];
    [temp setHour: 9];
    [temp setMinute:00];

    NSDate *fireTime = [calender dateFromComponents:temp]; // December 31st 2013 9:00
    [temp release];

    // set up the notifier 
    UILocalNotification *localNotification = [[UILocalNotification alloc]init];

    localNotification.fireDate = fireTime;
    localNotification.timeZone = [NSTimeZone defaultTimeZone]; 
```

# javascript - MVC 4 APIController 未接收 POST 数据

> ID：14551503
> 
> 赞同：2
> 
> 时间：2013-01-27T19:51:21.757
> 
> 标签：javascript, jquery, asp.net-mvc, http-post

当然这已经处理了很多次了......但是......只是看不出我做错了什么！

这是一个简单的 JS 脚本，可以将数据发送回 ApiController。

```
function WebCall(url,parameterObject, callBackFunction) {
this.callbackfunction = callBackFunction;
this.parameterObject = parameterObject;
this.url = url;
self = this;
this.GetData = function () {
 //self = this;   
    $.ajax({
        //dataType: "json",
        type: "POST",
        url: self.url,
        data: JSON.stringify(self.parameterObject),
        contentType: "application/json;charset=utf-8",
        success: function (data) {
            self.callbackfunction.call(this, data);
        },//self.GotData,
        error: function (xhRequest, ErrorText, thrownError)
        {
            alert("error : " + ErrorText)
        },
        complete: function () {},
    })

} 
```

}

发送的数据（parameterObject）很简单

```
var postData = {
            clientId: id
        } 
```

控制器中的 c# 代码是：

```
 public class ClientPostObject
{
    public string clientId;
}

public class ClientDetailController : ApiController
{

    [HttpPost]
    public ClientDetailWidgetData GetClient(ClientPostObject clientObject)

    {
        return new ClientModel().GetClientDetail(clientObject.clientId);
    }
} 
```

在 Google chrome 开发人员工具中，XH​​R 将“表单数据”显示为 clientId:A0001 - 这样看起来还可以吗？

无论我尝试什么（并且我在网络上经历了很多建议），帖子数据都不存在。

当然它的东西很简单....在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:10:52.040

除非您计划在其他时候使用完整的表单提交到此方法，否则当您只使用一个属性时要求模型绑定器尝试绑定到复杂类型并没有任何意义. 将您的方法签名更改为：

```
[HttpPost]
public ClientDetailWidgetData GetClient(int clientId) // or whatever type clientId represents
{
    return new ClientModel().GetClientDetail(clientId);
} 
```

我还建议在某个时候添加 Glimpse ( [http://getglimpse.com/](http://getglimpse.com/) )，以便您可以了解模型绑定和/或应用程序的路由是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:02:04.450

尝试`contentType`放弃，不要`stringify` `data`：

```
$.ajax({
    type: "POST",
    url: self.url,
    data: self.parameterObject,
    success: function (data) {...},
    ...
}); 
```

# ruby-on-rails - 验证属性而不保存

> ID：14551506
> 
> 赞同：1
> 
> 时间：2013-01-27T19:52:13.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, validation

在 Rails 3 中，我想查看属性的值是否使用模型的`validates`选项有效，而无需尝试保存或创建。

我正在编写 AJAX API 的后端，它应该检查用户名

```
validates :username, :length => {:minimum => 2, :maximum => 50}, :exclusion => {:in => RESERVED_USERNAMES}, :format => MY_REGEX, .etc 
```

在用户模型中。这是在注册表单中的用户名字段旁边创建一个小勾号或交叉，因此用户不必等待查看用户名是否被使用。

我可以将它与正则表达式进行比较，但为了保持我的代码干燥，我认为在用户模型中使用验证会更好。

任何人都知道我该如何做以下事情：

```
username = params[:username]

if User.not_found(:username => username) && User.validate(:username => username)
    #yay!
else
    #nope
end 
```

（我已经有`not_found`工作了）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:54:18.033

除了运行所有验证之外，您还可以尝试检查与用户名相关的特定错误（您需要这样做才能获得错误消息）。

```
@user = User.new(params[:user])
if @user.invalid? && @user.errors[:username].any?
  # yay!
else
  # nope
end 
```

您可以在不将用户持久保存到数据库的情况下运行它，因为使用的方法（包括#new 和#valid？）都没有实际保存对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:16:11.673

您可以使用用户名参数创建新用户，然后检查错误：

```
@user = User.new( :username => params[:username] )
@user.valid?    

if @user.errors.include? :username
  # username error
end 
```

# windows-phone-7 - 我需要给 WP7 的 Internet 权限吗？

> ID：14551510
> 
> 赞同：1
> 
> 时间：2013-01-27T19:52:21.180
> 
> 标签：windows-phone-7, azure, asp.net-web-api

我制作了一个 web api，现在已经将它托管在 windows azure 上。我看到我的链接正在工作（通过浏览器和提琴手）。

但是，我的 windows phone 7 应用程序（我在模拟器中通过 Vs 2010 运行）似乎不再可以连接到我的 webapi。

我需要设置一些东西才能让它工作吗？

**编辑**

我取消了提琴手，现在它可以工作了。这与提琴手有关。我想重新安装提琴手，但不知道如何解决这个问题。

# macos - OSX 中的列表控件

> ID：14551511
> 
> 赞同：0
> 
> 时间：2013-01-27T19:52:35.430
> 
> 标签：macos, cocoa

我需要在 OSX 的窗口上创建一个简单的项目列表。来自 C# 背景，我正在寻找对应版本的 List ，

一个简单的控件，其中所有项目仅以一列和垂直顺序添加，仅此而已。我在库中看到了 NSTableView，但它似乎是一个更花哨的控件，具有多个列，例如 C# 中的列表视图，

是我需要修改属性以简化还是有一个更简单的控件来满足我的需要？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:02:21.500

NSTableView 应该可以满足您的需求。您可以更改它的设置方式，但通常它只是以单行垂直格式列出内容。NSTableView 可能有更多选项，但如果你不使用它们，一切都应该没问题。

如果您不想使用 NSTableView 有其他原因，请告诉我。

祝你好运。

# html - HTML 语法高亮

> ID：14551512
> 
> 赞同：-2
> 
> 时间：2013-01-27T19:52:38.913
> 
> 标签：html, syntax-highlighting

我想请你帮忙。我需要一些“简单使用”的 HTML 语法荧光笔。我已经尝试过[http://alexgorbatchev.com/SyntaxHighlighter/](http://alexgorbatchev.com/SyntaxHighlighter/)但是这个不支持 HTML5 标签，无论内容有多大（小），它在屏幕右侧都有滑块。

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:53:58.190

# [棱镜.js](http://prismjs.com/)

有很多脚本，但我发现 Lea Verou的[**prismjs**](http://prismjs.com/)库是最容易使用的。当然它支持 HTML5！

* * *

要使用它，只需将代码包装在`pre`和`code`标签中，并给它们一个类`language-markup`：

```
<pre class="language-markup"><code>
  &lt;div class="example"&gt;This is automatially highlighted&lt;/div&gt;
</code></pre> 
```

这是它的样子：

![在此处输入图像描述](../Images/7b02edf922f00e351b9dd17fab174640.png)

这里有一个活生生的例子：[http ://plnkr.co/edit/7Du1Oro4px3wsGv0BPOT?p=preview](http://plnkr.co/edit/7Du1Oro4px3wsGv0BPOT?p=preview)

# c# - 如果发送器要发送 4k 的数据，而串口一次接收 32 字节的数据，如何将这些字节保存在同一个内存流中？

> ID：14551516
> 
> 赞同：1
> 
> 时间：2013-01-27T19:53:09.273
> 
> 标签：c#

我在显示图像时遇到问题，它的字节作为数据块进入我的 pc 串行端口，一次 32 个字节，如何将所有传入字节保存在同一个内存流中，然后如何在图片中显示此图像盒子

这是一段代码

```
if (((int)header[0] == 0x76) && (header[1] == 0x00) && (header[2] == 0x32) && (header[3] == 0x00) && (header[4] == 0x00)) /// the header is true ,read the image bytes
{
    for (int i = 0; i < 32; i++)
        Jpg[i] = (byte)CamPort.ReadByte();

    fs.Write(Jpg, 0, Jpg.Length);

    for (int i = 1; i < Jpg.Length; i++)
    {
        if ((Jpg[i - 1] == 0xFF) && (Jpg[i - 0] == 0xD9))// reaching the last two bytes(FF D9) of Jpg //
        {
            EndFlag = true;
            MessageBox.Show("done");
            //OneSnap.Image = Image.FromStream(fs);
            fs.Close();
        }
    }
}
else
{
    MessageBox.Show("DONE");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:50:26.187

我只会使用一个嵌套循环并一次将 32 个字节添加到一个更大的数组中。

```
int offset = 0;
for(int i = 0; i < total; i++){
    for(int j = 0; j < 32; j++){
        offset = i * 32;
        jpg[offset + j] = (byte)CamPort.ReadByte();
    }
 } 
```

类似的东西应该将所有数据放入一个数组中，然后您可以使用/处理该数据。从那里开始，以您喜欢的任何方式显示数据应该是一件相对简单的事情。

# symfony - 教义参数问题

> ID：14551518
> 
> 赞同：0
> 
> 时间：2013-01-27T19:53:17.177
> 
> 标签：symfony, pdo, doctrine-orm

我有以下代码给出以下异常，我不知道为什么，任何帮助将不胜感激。

> 无效的参数号：绑定变量的数量与标记的数量不匹配

```
if (!empty($ids)) {
            $queryIds = implode(",", $ids);
            $query = $em->createQueryBuilder()
                        ->from('MainClientBundle:Posts','p')
                        ->select('p')
                        ->where('p.id >= :rand')
                        ->where('p.id NOT IN (:ids)')
                        ->orderBy('p.id','ASC')
                        ->setParameter('rand', rand(1, $max))
                        ->setParameter('ids', $queryIds)
                        ->setMaxResults(1);
        } else {
            $query = $em->createQueryBuilder()
                ->from('MainClientBundle:Posts','p')
                ->select('p')
                ->where('p.id >= :rand')
                ->orderBy('p.id','ASC')
                ->setParameter('rand', rand(1, $max))
                ->setMaxResults(1);
        }
        try {
            if($options['videos'] == "off"){
                $query->where("p.type <> :type")->setParameter("type",1);
            }
            if($options['sfw'] == "on"){
                $query->where("p.safeForWork <> :sfw")->setParameter("sfw",0);
            }
            $post = $query->getQuery()->getSingleResult();
        } catch (\Doctrine\Orm\NoResultException $e) {
            $post = null;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:22:07.340

Your first query is the problem. Your query should look like this

```
if (!empty($ids)) {
    $queryIds = implode(",", $ids);
    $query = $em->createQueryBuilder()
                ->from('MainClientBundle:Posts','p')
                ->select('p')
                ->where('p.id >= :rand')
                ->andWhere('p.id NOT IN (:ids)')
                ->orderBy('p.id','ASC')
                ->setParameter('rand', rand(1, $max))
                ->setParameter('ids', $queryIds)
                ->setMaxResults(1);
} else {
    $query = $em->createQueryBuilder()
        ->from('MainClientBundle:Posts','p')
        ->select('p')
        ->where('p.id >= :rand')
        ->orderBy('p.id','ASC')
        ->setParameter('rand', rand(1, $max))
        ->setMaxResults(1);
}
try {
    if($options['videos'] == "off"){
        $query->where("p.type <> :type")->setParameter("type",1);
    }
    if($options['sfw'] == "on"){
        $query->where("p.safeForWork <> :sfw")->setParameter("sfw",0);
    }
    $post = $query->getQuery()->getSingleResult();
} catch (\Doctrine\Orm\NoResultException $e) {
    $post = null;
} 
```

Note that I changed your second where to andWhere. When you use two where() in the same query builder, the first gets overwritten by the second.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T14:24:52.680

如评论中所述，问题在于`->where`您的查询构建器中的双重使用。如果要组合多个 where 子句，则需要使用`->andWhere`or/and `->orWhere`。

此外，我将您的结果更改为`->getOneOrNullResult()`，这样您就不需要使用您用来捕获教义异常的整个 try/catch 块。

```
if (!empty($ids)) {
    $queryIds = implode(",", $ids);
    $query = $em->createQueryBuilder()
        ->from('MainClientBundle:Posts','p')
        ->select('p')
        ->where('p.id >= :rand')
        ->where('p.id NOT IN (:ids)')
        ->orderBy('p.id','ASC')
        ->setParameter('rand', rand(1, $max))
        ->setParameter('ids', $queryIds)
        ->setMaxResults(1);
} else {
    $query = $em->createQueryBuilder()
        ->from('MainClientBundle:Posts','p')
        ->select('p')
        ->where('p.id >= :rand')
        ->orderBy('p.id','ASC')
        ->setParameter('rand', rand(1, $max))
        ->setMaxResults(1);
}

if($options['videos'] == "off"){
    $query->where("p.type <> :type")->setParameter("type",1);
}
if($options['sfw'] == "on"){
    $query->where("p.safeForWork <> :sfw")->setParameter("sfw",0);
}

$post = $query->getQuery()->getOneOrNullResult(); 
```

# mysql - SQL 命令的关系代数公式

> ID：14551520
> 
> 赞同：1
> 
> 时间：2013-01-27T19:53:21.543
> 
> 标签：mysql, sql, tsql, relational-algebra

我有以下 SQL 命令：

```
SELECT X,Y,Z FROM A,B,C WHERE A.U=B.U AND A.V=C.V
ORDER BY X,Y 
```

我需要为此查询编写关系代数公式。到目前为止，我在：

```
E =  (π{X,Y,Z}(S{X,Y} ( σ {A.B.U AND A.V=C.V} (A))) * 
     (π{X,Y,Z}(S{X,Y} ( σ {A.B.U AND A.V=C.V} (B))) * 
     (π{X,Y,Z}(S{X,Y} ( σ {A.B.U AND A.V=C.V} (C))) 
```

这个对吗 ？我不确定我在 A、B、C 之间是否有联合或笛卡尔积？

我还需要将此表达式转换为最佳表达式。谁能给我一步一步的例子来说明如何做到这一点？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-02T16:33:28.800

它应该是这样的：

```
τ(X,A),(Y,A)(πx,y,z(σa.u=b.u,a.v = c.v(A,B,C))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:57:45.313

这不可能。原因是在关系代数中，您不能对结果集应用任何排序。这意味着没有办法做这样的事情`order by`。

# javascript - 页面加载时的 CSS 动画

> ID：14551521
> 
> 赞同：0
> 
> 时间：2013-01-27T19:53:29.487
> 
> 标签：javascript, jquery, css

我正在使用 AJAX 在我的网站上加载页面。

在加载页面时 - 我希望徽标旋转以表示它正在加载。

用于在页面加载时控制 css 的 jQuery（不确定它是否真的是 javascript，我是 java/jquery 的新手）是

```
function loadPage(url)
{
url=url.replace('#page','');

$('#logo').css('display','none;');

$.ajax({
    type: "POST",
    url: "load_page.php",
    data: 'page='+url,
    dataType: "html",
    success: function(msg){

        if(parseInt(msg)!=0)
        {
            $('#pageContent').html(msg);
            $('#logo').css('visibility','visible');
        }
    } 
```

控制动画的 CSS 是

```
 @-webkit-keyframes spin {
        from {
            -webkit-transform: rotate(0deg);
        }
        to {
            -webkit-transform: rotate(360deg);
        }
    }

    @-moz-keyframes spin {
        from {
            -moz-transform: rotate(0deg);
        }
        to {
            -moz-transform: rotate(360deg);
        }
    }

    @-ms-keyframes spin {
        from {
            -ms-transform: rotate(0deg);
        }
        to {
            -ms-transform: rotate(360deg);
        }
    }

    #logoholder { 

    }

    #logo   { 
        background: url(images/logo.png) 0 0 no-repeat; 

        width: 130px; 
        height: 130px; 
        -webkit-animation-name: spin; 
        -webkit-animation-duration: 1000ms; /* 40 seconds */
        -webkit-animation-iteration-count: infinite; 
        -webkit-animation-timing-function: linear;

        -moz-animation-name: spin; 
        -moz-animation-duration: 1000ms; /* 40 seconds */
        -moz-animation-iteration-count: infinite; 
        -moz-animation-timing-function: linear;

        -ms-animation-name: spin; 
        -ms-animation-duration: 1000ms; /* 40 seconds */
        -ms-animation-iteration-count: infinite; 
        -ms-animation-timing-function: linear;

        /* boooo opera */
        -o-transition: rotate(3600deg); /* works */
    } 
```

是否有我可以添加到 CSS（通过 jquery）的属性，以便在页面未加载时徽标不会旋转......目前徽标不断旋转

也许我可以从“#logo”选择器中删除一个属性，这将使旋转无效

然后我可以在页面加载时（通过javascript）添加某个属性以使旋转工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:00:18.397

与其将 CSS 动画绑定到`#logo`，不如将其绑定到一个类，例如`.spin`. 当 Ajax 启动时，将`spin`类添加到`#logo`，使用`addClass`：

```
$("#logo").addClass("spin"); 
```

当 ajax 内容完成加载后，使用`removeClass`：

```
$("#logo").removeClass("spin"); 
```

这样您就可以轻松地正常显示徽标，并使其仅在 ajax 处于活动状态时才旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:01:13.360

`<body class="loading">`在你的页面中使用类似的东西。

然后在页面底部，有`$('body').removeClass('loading');`

然后使用选择器定位您的 css 动画`body.loading #logo`。

页面完全加载后，jquery 将删除 .loading 类并且动画停止。

同样在您的活动中，`$.ajax`您应该在事件中添加`.loading`课程`beforeSend`并删除课程。`complete`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:18:28.027

看起来您最初隐藏了徽标，并在内容加载后显示（如评论中所述）。此外，您正在使用该`display`属性来隐藏它，并使用该`visibility`属性来隐藏它。那些不一样。我在下面切换了您的功能，并将该`display`属性用于两者。不确定是否还有其他错误，但试一试，它应该会让你朝着正确的方向前进。

```
function loadPage(url)
    {
    url=url.replace('#page','');

    $('#logo').css('display','block');

    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+url,
        dataType: "html",
        success: function(msg){

            if(parseInt(msg)!=0)
              {  
               $('#pageContent').html(msg);
               $('#logo').css('display', 'none');
            }
        } 
```

# android - 将动态文本添加到 RelativeLayout

> ID：14551522
> 
> 赞同：0
> 
> 时间：2013-01-27T19:53:32.547
> 
> 标签：android, text, textview, add, android-relativelayout

我想为我的 Android 游戏创建一个“输入你的名字”页面（用于高分），但我遇到了一些问题。我希望它看起来像这样：

> 您已达到 (=enthst1)
> 
> ......这是分数............
> 
> 点！(=enthst2)
> 
> 请输入您的姓名以保存您的分数！(= entst3)
> 
> ...........名称的EditText......
> 
> 后退（=按钮）...................... Enter（=按钮）

但我似乎无法将分数（int）添加到我的 ContentView！

这是代码：

“onCreate”中的 Java：

```
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_enter_hs);

layo = new RelativeLayout(this);
MySco = new TextView(this) ;

Back = (Button)findViewById(R.id.enthsre1);
Back.setOnClickListener(this);

Enter =(Button)findViewById(R.id.enthsok1);
Enter.setOnClickListener(this);

Eingabe = (EditText) findViewById(R.id.editText1) ;

Texta = (TextView) findViewById(R.id.enthst1) ;
Textb = (TextView) findViewById(R.id.enthst2) ;
Textc = (TextView) findViewById(R.id.enthst3) ;

Intent intentk = getIntent();
kontro = intentk.getStringExtra("from").equals("MainActivity") ;

score = 0 ;

if(kontro == false){
score = punkteRechnen(tuleb, le0leb, le1leb, le2leb) ; //calculate the score
} else {
score = 10 ;
}

scoint = "" + score ;

MySco.setText(scoint) ;
MySco.setTextColor(Color.WHITE) ; 
MySco.setTextSize(20);

/*I know that this will throw me an IllegalStateException (the specified child already has a parent)
layo.addView(Texta) ;
layo.addView(MySco) ;
layo.addView(Textb) ;
layo.addView(Textc) ;
layo.addView(Eingabe) ;
layo.addView(Back) ;
layo.addView(Enter) ;
*/ 
```

XML:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
     android:background="@color/black"
    android:orientation="vertical"
    tools:context=".EnterHSActivity" >

    <TextView
        android:id="@+id/enthst1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:text="@string/enthst1a"
        android:textColor="@color/white"
        android:textColorHint="@color/white"
        android:textSize="20sp"  />

    <TextView
        android:id="@+id/enthst2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="50dp"
        android:layout_centerHorizontal="true"
        android:text="@string/enthst1b"
        android:textColor="@color/white"
        android:textColorHint="@color/white"
        android:textSize="20sp"  />

    <TextView
        android:id="@+id/enthst3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="80dp"
        android:layout_centerHorizontal="true"
        android:text="@string/enthst1c"
        android:textColor="@color/white"
        android:textColorHint="@color/white"
        android:textSize="18sp"  />

    <Button
        android:id="@+id/enthsre1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_marginBottom="20dp"
        android:layout_marginLeft="100dp"
        android:text="@string/retour" />

    <Button
        android:id="@+id/enthsok1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentRight="true"
        android:layout_marginBottom="20dp"
        android:layout_marginRight="100dp"
        android:text="@string/allesklar" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/enthsre1"
        android:layout_alignRight="@+id/enthsok1"
        android:layout_below="@+id/enthst3"
        android:ems="10"
        android:inputType="text"
        android:textColor="@color/white"
        android:textColorHint="@color/white"
        android:textColorLink="@color/red" >

        <requestFocus />
    </EditText>

</RelativeLayout> 
```

那么，如何将分数添加到我的布局中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:11:05.253

您不能在 textA、textB 等上调用 addView，因为它们已经存在于您的 XML 文件中，并且已经是视图的子视图。相反，您应该在 XML 文件中创建一个空的 RelativeLayout，然后使用 new TextView() 创建 textA 等，然后将它们添加到布局中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:11:24.297

如果视图已经是该布局的子级，则不应将视图添加到该布局。当您调用 setcontentview 时，您的 XML 布局会膨胀，所有这些视图都会创建并添加到您的视图层次结构中。

我会将 MySco 文本视图添加到您的布局 XML 中，然后调用 findviewbyid 来获取它。我会避免动态添加视图。您始终可以创建一个隐藏的视图，然后再显示它以获得类似的效果。

这是您的 onCreate 方法的修改/精简代码。

```
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_enter_hs);
MySco = (TextView)findViewById(R.id.score);
Intent intentk = getIntent();
kontro = intentk.getStringExtra("from").equals("MainActivity") ;

score = 0 ;

if(kontro == false){
score = punkteRechnen(tuleb, le0leb, le1leb, le2leb) ; //calculate the score
} else {
score = 10 ;
}

scoint = "" + score ;

MySco.setText(scoint) ;
MySco.setTextColor(Color.WHITE) ; 
MySco.setTextSize(20); 
```

在您的布局中添加以下内容：

```
<TextView
        android:id="@+id/score"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@color/white"
        android:textColorHint="@color/white"
        android:textSize="20sp"  /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:14:06.060

试试这个可能对你有帮助。

在相对布局中添加文本视图以在布局上添加分数。

```
MySco.setLayoutParams(new RelativeLayout.LayoutParams(300,300);
layo.addView(MySco); 
```

# playframework-2.0 - 在 HTML 中显示一年中每一天的数据库中的字符串

> ID：14551523
> 
> 赞同：0
> 
> 时间：2013-01-27T19:53:33.493
> 
> 标签：playframework-2.0

也许这是一个愚蠢而幼稚的问题，但我想在我的网页上显示一个字符串（每日报价）。我将 Play 2.0.4 与 Postgres 9.1 一起使用。我需要一点帮助

1.  实现/创建包含一年中每一天的唯一字符串的表的最佳方法，即 365 天的 365 个报价。
2.  从数据库读取/拉取报价的控制器程序

# awk - 使用 awk 将矩阵转换为值对

> ID：14551529
> 
> 赞同：3
> 
> 时间：2013-01-27T19:53:58.690
> 
> 标签：awk

我有一个具有以下格式的纬度经度和温度的数据矩阵：

```
 15W     14.5W   14W     13.5W   13W 
30N         19.3    19.3    19.2    18.9    18.6
30.5N       19.1    19      19      18.9    18.4
31N         18.9    18.8    18.7    18.6    18.3
31.5N       18.9    18.7    18.7    18.6    18.1
32N         18.6    18.5    18.6    18.5    17.5 
```

我想使用 awk 将其转换为具有纬度经度和温度的线。输出应如下所示：

```
15W 30N 19.3 
15W 30.5N 19.1 
15W 31N 18.9 
15W 31.5N 18.9 
15W 32N 18.6
14.5W 30N 19.3
14.5W 30.5N 19
14.5W 31N 18.8 
```

我想你明白了。我想到了 awk，因为我用它做了一些其他的事情，它非常强大。但也许这里要使用其他一些工具。

行数和列数并不总是相同的。

我还需要将纬度和经度转换为十进制分钟，但我一次迈出一步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:16:43.313

awk 单线（可能有点长）：

```
 awk 'NR==1{for(i=1;i<=NF;i++)t[i]=$i}{ r[NR]=$1; for(i=2;i<=NF;i++) v[t[i-1],$1]=$i}END{for(i=1;i<=length(t);i++) for(j=2;j<=NR;j++) print t[i], r[j], v[t[i],r[j]]
} ' file 
```

我想将单行以上格式化为“三行”:)：

```
 awk 'NR==1{for(i=1;i<=NF;i++)t[i]=$i}
        { r[NR]=$1; for(i=2;i<=NF;i++) v[t[i-1],$1]=$i}
        END{for(i=1;i<=length(t);i++)for(j=2;j<=NR;j++)print t[i], r[j], v[t[i],r[j]]} ' file 
```

测试：

```
kent$  cat t
            15W     14.5W   14W     13.5W   13W 
30N         19.3    19.3    19.2    18.9    18.6
30.5N       19.1    19      19      18.9    18.4
31N         18.9    18.8    18.7    18.6    18.3
31.5N       18.9    18.7    18.7    18.6    18.1
32N         18.6    18.5    18.6    18.5    17.5

kent$  awk 'NR==1{for(i=1;i<=NF;i++)t[i]=$i}
        { r[NR]=$1; for(i=2;i<=NF;i++) v[t[i-1],$1]=$i}
        END{for(i=1;i<=length(t);i++)for(j=2;j<=NR;j++)print t[i], r[j], v[t[i],r[j]]} ' t
15W 30N 19.3
15W 30.5N 19.1
15W 31N 18.9
15W 31.5N 18.9
15W 32N 18.6
14.5W 30N 19.3
14.5W 30.5N 19
14.5W 31N 18.8
14.5W 31.5N 18.7
14.5W 32N 18.5
14W 30N 19.2
14W 30.5N 19
14W 31N 18.7
14W 31.5N 18.7
14W 32N 18.6
13.5W 30N 18.9
13.5W 30.5N 18.9
13.5W 31N 18.6
13.5W 31.5N 18.6
13.5W 32N 18.5
13W 30N 18.6
13W 30.5N 18.4
13W 31N 18.3
13W 31.5N 18.1
13W 32N 17.5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T08:23:46.940

解决方案不需要很复杂。一旦你选择了正确的数据结构，它实际上是相当简单的。只需使用`GNU awk`来使用真正的多维数组。像这样运行：

```
awk -f script.awk file 
```

内容`script.awk`：

```
NR==1 {
    for (i=1;i<=NF;i++) {
        a[i]=$i
    }
    next
}

{
    for (j=2;j<=NF;j++) {
        b[j-1][NR]["rec"] = a[j-1] FS $1 FS $j
        b[j-1][NR]["val"] = $j
    }
}

END {
    for (x=1;x<=length(b);x++) {
        for (y=2;y<=NR;y++) {

            if (b[x][y]["val"] != "999.9") {

                print b[x][y]["rec"] | "column -t"
            }
        }
    }
} 
```

结果：

```
15W    30N    19.3
15W    30.5N  19.1
15W    31N    18.9
15W    31.5N  18.9
15W    32N    18.6
14.5W  30N    19.3
14.5W  30.5N  19
14.5W  31N    18.8
14.5W  31.5N  18.7
14.5W  32N    18.5
14W    30N    19.2
14W    30.5N  19
14W    31N    18.7
14W    31.5N  18.7
14W    32N    18.6
13.5W  30N    18.9
13.5W  30.5N  18.9
13.5W  31N    18.6
13.5W  31.5N  18.6
13.5W  32N    18.5
13W    30N    18.6
13W    30.5N  18.4
13W    31N    18.3
13W    31.5N  18.1
13W    32N    17.5 
```

或者，这是单线：

```
awk 'NR==1 { for (i=1;i<=NF;i++) a[i]=$i; next } { for (j=2;j<=NF;j++) { b[j-1][NR]["rec"] = a[j-1] FS $1 FS $j; b[j-1][NR]["val"] = $j } } END { for (x=1;x<=length(b);x++) for (y=2;y<=NR;y++) if (b[x][y]["val"] != "999.9") print b[x][y]["rec"] | "column -t" }' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T13:03:09.193

```
awk 'NR==1{n=split($0,a," ")}NR!=1{for(i=1;i<=n;i++)x[a[i]" "$1]=$(i+1);}END{for(i in x){print i,x[i]}}' temp | sort 
```

测试如下：

```
> cat temp
            15W     14.5W   14W     13.5W   13W 
30N         19.3    19.3    19.2    18.9    18.6
30.5N       19.1    19      19      18.9    18.4
31N         18.9    18.8    18.7    18.6    18.3
31.5N       18.9    18.7    18.7    18.6    18.1
32N         18.6    18.5    18.6    18.5    17.5
phoenix.250> nawk 'NR==1{n=split($0,a," ")}NR!=1{for(i=1;i<=n;i++)x[a[i]" "$1]=$(i+1);}END{for(i in x){print i,x[i]}}' temp | sort
13.5W 30.5N 18.9
13.5W 30N 18.9
13.5W 31.5N 18.6
13.5W 31N 18.6
13.5W 32N 18.5
13W 30.5N 18.4
13W 30N 18.6
13W 31.5N 18.1
13W 31N 18.3
13W 32N 17.5
14.5W 30.5N 19
14.5W 30N 19.3
14.5W 31.5N 18.7
14.5W 31N 18.8
14.5W 32N 18.5
14W 30.5N 19
14W 30N 19.2
14W 31.5N 18.7
14W 31N 18.7
14W 32N 18.6
15W 30.5N 19.1
15W 30N 19.3
15W 31.5N 18.9
15W 31N 18.9
15W 32N 18.6
> 
```

# php - PHP MySQL选择基于跨多列的范围

> ID：14551533
> 
> 赞同：0
> 
> 时间：2013-01-27T19:54:35.730
> 
> 标签：php, mysql, select, range

我有一个类似于以下的表格设置：

```
CREATE table TABLE_prices
(
PRICE_ID int unsigned not null auto_increment primary key,
RANGE1_START int,
RANGE1_END int,
RANGE1_PRICE decimal(10,2),
RANGE2_START int,
RANGE2_END int,
RANGE2_PRICE decimal(10,2),    
RANGE3_START int,
RANGE3_END int,
RANGE3_PRICE decimal(10,2)
); 
```

如果我有一个值（例如 100），有没有办法构建一个 select 语句来根据值所在的范围获取 RANGE#_PRICE？

我的直觉是，我可能不得不从 MySQL 中提取范围数据并在 PHP 中对其进行迭代，但我不知道是否有办法使用 MySQL 直接切入它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:59:49.790

试试这个丑陋的解决方案：

```
SELECT
  PRICE_ID,
  COALESCE(
            CASE WHEN @value BETWEEN RANGE1_START AND RANGE1_END THEN RANGE1_PRICE END,
            CASE WHEN @value BETWEEN RANGE2_START AND RANGE2_END THEN RANGE2_PRICE END,
            CASE WHEN @value BETWEEN RANGE3_START AND RANGE3_END THEN RANGE3_PRICE END
          ) Price
FROM TABLE_prices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:02:12.690

我不知道您要实现什么目标，但您可以在单个语句中做到这一点：

```
$price = 100;

$sql = "
(
  SELECT 1 as range, price_id, range1_start as range_start, range1_end as range_end FROM table_prices WHERE range1_start >= $price AND range1_end <= $price
) UNION
(
  SELECT 2 as range, price_id, range2_start as range_start, range2_end as range_end FROM table_prices WHERE range2_start >= $price AND range2_end <= $price
) UNION
(
  SELECT 3 as range, price_id, range3_start as range_start, range3_end as range_end FROM table_prices WHERE range3_start >= $price AND range3_end <= $price
)"; 
```

# java - 如何在java中用普通矩形轮廓绘制一个圆角矩形

> ID：14551534
> 
> 赞同：4
> 
> 时间：2013-01-27T19:54:37.507
> 
> 标签：java, swing, awt, java-2d, paint

对于我的 java 应用程序，我需要一个圆形矩形，其轮廓看起来像一个普通矩形，像这样

![在此处输入图像描述](../Images/4205a15acfea772b944e26ca8a9984fd.png)

我知道您可以通过在其中绘制一个普通矩形和一个 RoundRect 来做到这一点，但我不想在其中绘制一个 RoundRect，因为我想在其中绘制其他东西。

所以一个带有正常角的圆形矩形。我如何在Java中绘制它？

问题是如果我使用图层，矩形看起来像这样： ![在此处输入图像描述](../Images/aafb589dcddc256b9f1e2abf7b2a20b5.png)角落填充了错误的颜色。我该如何防止呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-28T00:08:08.860

我可以想到两种方法。首先是生成一个`Shape`表示方形外边缘和圆形内边缘的a。

第二个是使用 a`AlphaComposite`来生成屏蔽结果。

![在此处输入图像描述](../Images/6e961afd99f0a02da2a305691936a4d8.png)

```
public class TestMask {

    public static void main(String[] args) {
        new TestMask();
    }

    public TestMask() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new MaskedPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class MaskedPane extends JPanel {

        public MaskedPane() {
            setBackground(Color.RED);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            BufferedImage outter = new BufferedImage(getWidth(), getHeight(), BufferedImage.TYPE_INT_ARGB);
            Graphics2D g2d = outter.createGraphics();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setColor(Color.BLACK);
            g2d.fillRect(0, 0, getWidth(), getHeight());
            g2d.dispose();
            BufferedImage inner = new BufferedImage(getWidth(), getHeight(), BufferedImage.TYPE_INT_ARGB);
            g2d = inner.createGraphics();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setColor(Color.BLACK);
            g2d.fillRoundRect(10, 10, getWidth() - 20, getHeight() - 20, 20, 20);
            g2d.dispose();

            BufferedImage masked = applyMask(outter, inner, AlphaComposite.DST_OUT);
            g.drawImage(masked, 0, 0, this);

        }

        public BufferedImage applyMask(BufferedImage sourceImage, BufferedImage maskImage, int method) {
            BufferedImage maskedImage = null;
            if (sourceImage != null) {

                int width = maskImage.getWidth();
                int height = maskImage.getHeight();

                maskedImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);
                Graphics2D mg = maskedImage.createGraphics();

                int x = (width - sourceImage.getWidth()) / 2;
                int y = (height - sourceImage.getHeight()) / 2;

                mg.drawImage(sourceImage, x, y, null);
                mg.setComposite(AlphaComposite.getInstance(method));
                mg.drawImage(maskImage, 0, 0, null);
                mg.dispose();
            }

            return maskedImage;
        }

        public BufferedImage applyMask(BufferedImage sourceImage, BufferedImage maskImage) {
            return (BufferedImage) applyMask(sourceImage, maskImage, AlphaComposite.DST_IN);
        }
    }
} 
```

**更新了形状示例**

![在此处输入图像描述](../Images/9741861760ed26f154b7dfea17cd82a2.png)

终于有时间打一个...

```
public class TestMask {

    public static void main(String[] args) {
        new TestMask();
    }

    public TestMask() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new ShapedPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class ShapedPane extends JPanel {

        public ShapedPane() {
            setBackground(Color.GREEN);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setColor(Color.BLACK);
            g2d.fill(new RounedFrame(getWidth(), getHeight(), 10, 20));
            g2d.dispose();
        }
    }

    public class RounedFrame extends Path2D.Float {

        public RounedFrame(float width, float height, float thickness, float radius) {

            moveTo(0, 0);
            lineTo(width, 0);
            lineTo(width, height);
            lineTo(0, height);
            lineTo(0, 0);

            float innerWidth = width - thickness;
            float innerHeight = height - thickness;

            moveTo(thickness + radius, thickness);
            lineTo(innerWidth - radius, thickness);

            curveTo(innerWidth, thickness, innerWidth, thickness, innerWidth, thickness + radius);

            lineTo(innerWidth, innerHeight - radius);
            curveTo(innerWidth, innerHeight, innerWidth, innerHeight, innerWidth - radius, innerHeight);
            lineTo(thickness + radius, innerHeight);
            curveTo(thickness, innerHeight, thickness, innerHeight, thickness, innerHeight - radius);
            lineTo(thickness, thickness + radius);
            curveTo(thickness, thickness, thickness, thickness, thickness + radius, thickness);

            closePath();

            setWindingRule(WIND_EVEN_ODD);

        }
    }
} 
```

**更新**

从 Andrew 的评论中，您可以通过使用来简化形状示例的使用`Area`

你可以用这个替换`paintComponent`上面例子中的......

```
@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);

    Area area = new Area(new Rectangle(0, 0, getWidth(), getHeight()));
    area.subtract(new Area(new RoundRectangle2D.Float(10, 10, getWidth() - 20, getHeight() - 20, 20, 20)));

    Graphics2D g2d = (Graphics2D) g.create();
    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
    g2d.setColor(Color.BLACK);
    g2d.fill(area);
    g2d.dispose();
} 
```

哪个更简单：D

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-27T20:15:07.887

就像是：

```
paintComponent(Graphics g) {
    //If you want more: Graphics2D g2 = (Graphics2D) g;
    Rect rect = getBounds();
    g.setColor(Color.BLACK);
    g.fillRect(rect.x, rect,y, rect.width, rect.height);
    rect.grow(-4, -4);
    g.setColor(getBackground());
    g.fillRoundRect(rect.x, rect,y, rect.width, rect.height, 5, 5);
} 
```

## 例如

![别的东西。。](../Images/78b9d7c21ce1ba3f4b4666c6d5164284.png)

```
import java.awt.*;
import java.awt.image.BufferedImage;
import javax.swing.*;

class CustomBorderWithContent {

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                int w = 200;
                int h = 100;
                int pad = 4;

                BufferedImage img = new BufferedImage(
                        w, h, BufferedImage.TYPE_INT_RGB);
                Graphics2D g = img.createGraphics();
                g.setRenderingHint(
                        RenderingHints.KEY_ANTIALIASING, 
                        RenderingHints.VALUE_ANTIALIAS_ON);

                // Ripped/adapted from Joop's answer
                g.setColor(Color.BLACK);
                g.fillRect(0, 0, w, h);
                g.setColor(Color.ORANGE);
                g.fillRoundRect(pad, pad, w-2*pad, h-2*pad, 25, 25);

                // Now..
                g.setColor(Color.BLUE);
                g.drawString("Something else..", 20, 25);

                g.dispose();

                JOptionPane.showMessageDialog(
                        null, new JLabel(new ImageIcon(img)));
            }
        };
        SwingUtilities.invokeLater(r);
    }
} 
```

# mysql - 尝试优化按投票活动列出选民的查询

> ID：14551547
> 
> 赞同：1
> 
> 时间：2013-01-27T19:56:05.533
> 
> 标签：mysql, optimization, join, subquery

我正在构建一个查询，`voters`根据他们在`votes`表中的活动（700 万条记录）列出表中的选民（100 万条记录）。标准如下：

*   大选 (GE) 每年只发生一次，并且只应计算 2004 年或之后的 GE。

*   在前面提到的 GEs 中，只有 10% 到 50% 的选民投票的那些应该被计算在内。

一些不太重要的信息：

*   无法更改架构。它以固定宽度的文本文件形式呈现给我们，通过脚本上传，并用于其他目的。

*   只有当前的活跃选民名单及其投票历史可用。在下面的查询中，我包含了一个方程，该方程将上限阈值降低 10,000 名选民，每当年份减少 1 时。它并不完美，但它似乎过滤掉了不需要的 GE，同时保留了有效的 GE。

**例如，如果在 2005 年、2006 年、2007 年、2009 年、2010 年和 2011 年有 100,000 到 500,000 名选民投票，那么我希望只列出在这些年份投票的选民。**

[**mysqlfiddle 在这里**](http://sqlfiddle.com/#!2/feb32/5)

架构如下：

```
CREATE TABLE IF NOT EXISTS `voters` (
  `CountyEMSID` varchar(9) COLLATE utf8_unicode_ci NOT NULL,
  `LastName` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
  `FirstName` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
  `MiddleInitial` varchar(1) COLLATE utf8_unicode_ci NOT NULL,
  `NameSuffix` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `HouseNumber` varchar(10) COLLATE utf8_unicode_ci NOT NULL,
  `HouseNumberSuffix` varchar(10) COLLATE utf8_unicode_ci NOT NULL,
  `ApartmentNumber` varchar(15) COLLATE utf8_unicode_ci NOT NULL,
  `StreetName` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `City` varchar(40) COLLATE utf8_unicode_ci NOT NULL,
  `Zip` varchar(5) COLLATE utf8_unicode_ci NOT NULL,
  `ZipCode4` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `MailingAddress1` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `MailingAddress2` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `MailingAddress3` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `MailingAddress4` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `DOBY` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `DOBM` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `DOBD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `Gender` varchar(1) COLLATE utf8_unicode_ci NOT NULL,
  `Party` varchar(3) COLLATE utf8_unicode_ci NOT NULL,
  `Other` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
  `ED` varchar(3) COLLATE utf8_unicode_ci NOT NULL,
  `AD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `CD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `CO` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `SD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `CC` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `JD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `RegY` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `RegM` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `RegD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `Status` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `VoterType` varchar(1) COLLATE utf8_unicode_ci NOT NULL,
  `StatusChangeY` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `StatusChangeM` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `StatusChangeD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `LastVoted` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `Telephone` varchar(12) COLLATE utf8_unicode_ci NOT NULL,
  `County` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  KEY `districts` (`CountyEMSID`,`ED`,`AD`,`CD`,`CO`,`SD`,`CC`,`JD`),
  KEY `vsn` (`CountyEMSID`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE IF NOT EXISTS `votes` (
  `CountyEMSID` varchar(9) COLLATE utf8_unicode_ci NOT NULL,
  `County` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `AD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `ED` varchar(3) COLLATE utf8_unicode_ci NOT NULL,
  `Party` varchar(3) COLLATE utf8_unicode_ci NOT NULL,
  `ElectionDateY` varchar(4) COLLATE utf8_unicode_ci NOT NULL,
  `ElectionDateM` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `ElectionDateD` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `ElectionType` varchar(2) COLLATE utf8_unicode_ci NOT NULL,
  `VoterType` varchar(1) COLLATE utf8_unicode_ci NOT NULL,
  KEY `CountyEMSID` (`CountyEMSID`),
  KEY `perfect` (`CountyEMSID`,`ElectionDateY`,`ElectionType`),
  KEY `CountyEMSID_2` (`CountyEMSID`,`ElectionDateY`,`ElectionType`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

到目前为止，我有以下查询应该只列出`votes`表中选民的唯一 ID (CountyEMSID)。它在 mysqlfiddle 中工作，但在 phpmyadmin 中挂起。

```
SELECT DISTINCT CountyEMSID
FROM `votes` 
WHERE ElectionDateY IN 
(
SELECT ElectionDateY
FROM `votes`
WHERE ElectionType = 'GE' 
AND ElectionDateY >= 2004 
GROUP BY ElectionDateY 
HAVING COUNT(*) < ((0.5 * (SELECT COUNT(*) FROM `voters`)) - ((YEAR(CURRENT_TIMESTAMP()) - ElectionDateY) * 10000)) 
AND COUNT(*) > (0.1 * (SELECT COUNT(*) FROM `voters`))
) 
```

对于优化此查询并对其进行修改以使其从`votes`表中返回所有相应的选民信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:20:32.907

MySQL`in`对子句的优化很差。基本上，它为处理的每一行重新运行子查询。您应该将计算移到`from`子句中。这是我的尝试：

```
select distinct v.*
from votes v join
     (select electiondatey, count(*) as NumYVotes
      from votes v
      group by electiondatey
    ) ey
    on v.electiondatey = ev.electiondatey cross join
    (select count(*) as numvoters from voters) as const
where (NumYVotes < 0.5 * numvoters - year(now()) - ElectionDateY * 10000) and
      (NumYVotes > 0.1 * numvoters) 
```

注意：我没有对此进行测试，因此它可能存在语法错误。

# android - Android：停止和记录不可恢复错误的常用方法

> ID：14551551
> 
> 赞同：5
> 
> 时间：2013-01-27T19:56:26.460
> 
> 标签：android, exception, crash, report

如果我的应用程序遇到不可恢复的错误，Android 上停止我的应用程序的常用方法是什么。

finish() 不会这样做，因为它不会停止任何正在运行的服务或线程。此外，我想通知用户发生了什么，并请他发送错误日志。

据我用谷歌搜索，似乎没有办法关闭我的应用程序并打开一个特殊的崩溃报告活动或其他东西来向用户显示正在发生的事情或发送崩溃日志。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:00:03.593

我认为你应该抛出未处理的运行时异常。在这种情况下，android 会杀死你所有的进程。另外我建议您使用[ACRA](http://code.google.com/p/acra/)。该库将帮助您获取崩溃报告（通过电子邮件、谷歌文档等），它可以向用户显示可自定义的错误对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:00:05.187

你应该检查一下。这可能是您的解决方案。 [阿克拉](https://github.com/ACRA/acra)

查看基本设置指南以开始使用该库。[ACRA - 基本设置](https://github.com/ACRA/acra/wiki/BasicSetup)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T20:34:56.510

虽然 ACRA 是一个不错的解决方案，但如果您想实现自己的未处理异常日志记录，请尝试[Thread.setDefaultUncaughtExceptionHandler()](https://developer.android.com/reference/java/lang/Thread.html#setDefaultUncaughtExceptionHandler%28java.lang.Thread.UncaughtExceptionHandler%29)。这样，您可以获得任何被抛出但未被捕获的异常，并以您喜欢的方式记录它们。您需要实现[Thread.UncaughtExceptionHandler](https://developer.android.com/reference/java/lang/Thread.UncaughtExceptionHandler.html)并将其传递给该方法。

使用 Activity，它在 onCreate() 中看起来像这样：

```
getMainLooper().getThread().setUncaughtExceptionHandler(new MyUncaughtExceptionHandler()); 
```

# flask - Gevent 和烧瓶 - 线程本地

> ID：14551554
> 
> 赞同：2
> 
> 时间：2013-01-27T19:56:56.807
> 
> 标签：flask, gevent

运行基于 Gevent 的服务器时，在烧瓶中使用“g”有哪些明确的风险？

还是“没有”意味着猴子修补使烧瓶使用greenlet本地变量而不是线程本地变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:00:37.367

Flask 根据其文档支持使用 greenlets：

> Flask 使用线程本地对象（实际上是上下文本地对象，它们也支持 greenlet 上下文）用于请求、会话和一个额外的对象，您可以将自己的东西放在 (g) 上。

由于这种支持，`g`使用 gevent 时没有使用风险。

阅读[http://flask.pocoo.org/docs/design/](http://flask.pocoo.org/docs/design/)了解更多信息。

# dll - 如何使用 ilMerge 将 dll 合并为 exe 文件？

> ID：14551556
> 
> 赞同：3
> 
> 时间：2013-01-27T19:57:07.460
> 
> 标签：dll, merge, cmd, exe, ilmerge

> **可能重复：**
> [将 .dll 与 .exe 合并](https://stackoverflow.com/questions/14551311/merging-dll-with-exe)

好的，所以...我在一个路径中拥有 ilmerge 的所有文件，以及 .exe (CabalMain.exe) 和 dll (crckd.dll)。`C:\Program Files (x86)\Microsoft\ILMerge`

我shift>右键单击文件夹并打开命令提示符。因为我想合并我输入的两个：

```
 C:\Program Files (x86)\Microsoft\ILMerge>C:\Program Files (x86)\Microsoft\ILMerg
e\ilmerge C:\Program Files (x86)\Microsoft\ILMerge\Cabalmain.exe C:\Program File
s (x86)\Microsoft\ILMerge\crckd.dll /out:C:\Program Files (x86)\Microsoft\ILMerg
e 
```

（我相信这是合并的正确过程）我收到了

```
C:\Program Files (x86)\Microsoft\ILMerge>C:\Program Files (x86)\Microsoft\ILMerg
e\ilmerge C:\Program Files (x86)\Microsoft\ILMerge\Cabalmain.exe C:\Program File
s (x86)\Microsoft\ILMerge\crckd.dll /out:C:\Program Files (x86)\Microsoft\ILMerg
e 
```

如果我还没有放弃它，那么当涉及到这一点时，我完全是个白痴；简单的说明将不胜感激。先谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:25:07.167

由于您现在已经复制了 ilmerge 的程序文件夹中的所有内容（这是不明智的，并且在重复的问题中被建议反对）正确的命令（来自 ilmerge 文件夹）应该是：

```
ilmerge cabalmain.exe crckd.dll /out:%userprofile%\cabalmainmerged.exe 
```

如果没有显示错误，您可以键入`start %userprofile%`并在打开的资源管理器窗口中找到 cabalmainmerged.exe

“无法加载程序集”意味着您尝试合并的 exe 或 dll 文件未复制到正确的文件夹中。如果 exe 或 dll 之一依赖于其他程序集，则它们都必须位于同一文件夹中。

更明智的是拥有一个文件夹 c:\merge 并复制该文件夹中的所有相关文件。然后启动命令提示符并

> C：
> 
> 光盘\合并

然后

```
"C:\Program Files (x86)\Microsoft\ILMerge\ilmerge" "yourexe.exe" "your1stdll.dll" /out:mergedexe.exe 
```

# c - 无法比较多个字符

> ID：14551557
> 
> 赞同：1
> 
> 时间：2013-01-27T19:57:10.643
> 
> 标签：c, char, scanf, getchar

我写了两个程序。在第一个中，我没有使用 getchar 从键盘获取字符，在这种情况下，编译完全缺少第二个 scanf。所以为了克服这个问题，我使用了 getchar。在这种情况下，我可以成功提供输入，但没有进行比较。虽然我已经将输入作为“d”而“d”输出只是“再见”。

```
#include<stdio.h>
main(){
    char c,f;
    printf("e");
    scanf("%c",&c);
    printf("one more");
    scanf("%c",&f);
    if(c=='d'&&f=='d')
        printf("hi");
    else
        printf("bye");

} 
```

使用 getchar

```
#include<stdio.h>
 main(){
    char c,f;
    printf("e");
    scanf("%c",&c);
    printf("one more");
    scanf("%c",&f);
    getchar();
    if(c=='d'&&f=='d')
        printf("hi");
    else
        printf("bye");

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:02:29.730

换行符将保留在标准输入中，因为它不会被`scanf("%c")`. 这意味着第二个 scanf() 读取换行符，而不是下一个输入。更改为`scanf(" %c")`将是一个解决方案，它将跳过前导空格。

# spring-security - ldap spring security http基本身份验证

> ID：14551558
> 
> 赞同：0
> 
> 时间：2013-01-27T19:57:25.010
> 
> 标签：spring-security, ldap, basic-authentication

你能给我一些链接或解决方案来解决我的问题吗？问题如下。我有一个 LDAP 服务器。如何通过此 LDAP 服务器进行 http 基本授权？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T10:17:48.107

您需要设置两个不同的 Spring Security 特征：

*   [LDAP 身份验证](http://docs.spring.io/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#ldap)。[此处](http://docs.spring.io/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#ldap-bean-config)描述的实际配置。
*   HTTP 基本身份验证。[此处](http://docs.spring.io/spring-security/site/docs/3.2.0.RELEASE/reference/htmlsingle/#ns-form-and-basic)描述了此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T12:30:05.397

谢谢。我做了这样的配置：

```
<security:http auto-config="true" use-expressions="true">
    <security:intercept-url pattern="/index.jsp" access="isAuthenticated()"/>
    <security:http-basic/>
</security:http> 
```

然后，BasicAuthenticationFilter

```
 <bean id="basicAuthenticationFilter"
      class="org.springframework.security.web.authentication.www.BasicAuthenticationFilter">
    <property name="authenticationEntryPoint" ref="BauthenticationEntryPoint"/>
    <property name="authenticationManager" ref="BauthenticationManager"/>
</bean> 
```

入口点和经理是这样描述的：

```
 <bean id="BauthenticationEntryPoint"   class="org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint">
    <property name="realmName" value="Name Of Your Realm"/>
</bean>
<bean id="BauthenticationManager" class="org.springframework.security.authentication.ProviderManager">
    <property name="providers">
        <list>
            <ref local="ldapAuthProvider"/>
        </list>
    </property>
</bean> 
```

最后

```
 <bean id="ldapAuthProvider"
      class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
    <constructor-arg>
        <bean class="org.springframework.security.ldap.authentication.BindAuthenticator">
            <constructor-arg ref="contextSource"/>
            <property name="userDnPatterns">
                <list>
                    <value>sAMAccountName={0}</value>
                </list>
            </property>
        </bean>
    </constructor-arg>
    <constructor-arg>
        <bean
                class="org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator">
            <constructor-arg ref="contextSource"/>
            <constructor-arg value=""/>
        </bean>
    </constructor-arg>
</bean> 
```

当我尝试访问 /index.jsp 时，我显示了一个 stadart http auth 窗口，它要求我输入用户名和密码。当我将其输入表单并按 Enter 时，什么也没有发生 - 身份验证窗口只是重新加载，仅此而已。

我在哪里做错了？谢谢。

# int - Scar Divi Float 或 Double 到 Int

> ID：14551562
> 
> 赞同：0
> 
> 时间：2013-01-27T19:57:37.783
> 
> 标签：int, double, pascal

Scar Divi Float 或 Double 到 Int。我如何将浮点数/双精度数传递给整数？

这是代码。我正在尝试查找位图并单击中心，问题是当我尝试划分 x 或 y 以找到 img 中心时。

```
program FindBitmap;

label
main;

var
Bmp: TSCARBitmap;
x, y: Integer;
temp1, temp2: String;

begin
 ClearDebug;
 Bmp := TSCARBitmap.Create('deNqtzGkKglAUhuE2Ea2pwXm8atpAFCIVRdEKi' +
    'qJCkBBpAeVQa+zCBRGH++cEz6/Dd95Oq92ajoZwE8eCG9sm3GhowDkWgrNNHc4' +
    'yNDgTqbnz6fjNMrr49XIXs+IXZuhK0fVyphSS99tz56UXDGlyEb7491ttIY3jp' +
    'eeW9oSuSCVIlQPfLxWyJFkvveqY0GSxCnceQZAXPmm6Xa9ql4QqCbVwJwpDEtl' +
    'vN00zQhb5JkhTnlF02O8oG0ISOApFEugDQuRZOIFj4Hh2AMcxfTh20PuDfhfuB' +
    '32bFT0=');
main:        
if FindBitmap (x, y, Bmp, 0, 0, 2559, 1023) then
begin
WriteLn('IMG FOUND!');    
ClickMouse((x + Bmp.Width / 2),(y + Bmp.Height / 2),mbLeft);
end
else
begin
goto main
end;

end. 
```

ClickMouse 不起作用，Scar Divi 说：类型不匹配

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:07:57.633

好吧，坦克给大家。**Sertac Akyuz**有解决方案：将 div 的 / 更改为返回整数。

```
ClickMouse((x + Bmp.Width div 2),(y + Bmp.Height div 2),mbLeft); 
```

问题是我不能有十进制坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:16:28.573

要转换数据类型，您“转换”它（而不是“通过”）。请参阅[此链接](http://www.gnu-pascal.de/gpc/Type-Casts.html)。

```
ClickMouse(Integer(x + Bmp.Width / 2),Integer(y + Bmp.Height / 2),mbLeft); 
```

当我查看[ClickMouse 的定义时](http://wiki.scar-divi.com/index.php?title=ClickMouseEx)，它不仅需要 a `Integer`，它的`const Integer`所有参数都需要 a ：

```
 procedure ClickMouse(const X, Y: Integer; const Btn: TMouseButton); 
```

根据[定义](http://www.gnu-pascal.de/gpc/Constant-Declaration.html)， a`const`必须在编译时可评估。如果我理解正确，那么您所采取的方法将无法正常工作......

# php - 如何使用 foreach 循环遍历 childNodes？

> ID：14551567
> 
> 赞同：6
> 
> 时间：2013-01-27T19:58:32.970
> 
> 标签：php, dom, xpath

考虑以下 PHP 代码

```
<?php

 $html_data = 
 '<html><body>
  <ol>
  <li><strong>Question 1</strong> Answer1</li>
  <li><strong>Question 2</strong> Answer2</li>
  </ol></body></html>';

  $doc = new DOMDocument();
  $doc->loadHTML($html_data);
  $xpath = new DOMXPath($doc);

  $ols = $xpath->query('//ol');
  $ol = $ols->item(0);
  $lis = $ol->childNodes;

  foreach ($lis as $li) {
    echo $li->firstChild->nodeValue."<br />";
    echo $li->lastChild->nodeValue."<br />";
    //echo $li->childNodes->item(0)->nodeValue."<br />";
  }
  ?> 
```

如果我删除此代码最后一行的注释并访问 childNodes DOM 对象数组，我的 foreach 循环只会执行一次。但是，如果我使用 firstChild 和 lastChild 访问相同的元素，如上所示，我可以成功地遍历所有存在的“li”标签。

我完全无法理解这一点。这是PHP中的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T23:03:03.747

我尝试使用以下代码重现您的问题（在 PHP 5.3.14 上）：

```
Interactive shell

php > $xml = <<<XML
<<< > <root>
<<< > <ol>
<<< > <li><strong>Question 1</strong> Answer1</li>
<<< > <li><strong>Question 2</strong> Answer2</li>
<<< > </ol>
<<< > </root>
<<< > XML;
php > $doc = new DOMDocument();
php > $doc->loadXML($xml);
php > $xpath = new DOMXPath($doc);
php > $ols = $xpath->query('//ol');
php > $ol = $ols->item(0);
php > $lis = $xpath->query('//li', $ol);
php > foreach ($lis as $li) {
php { echo $li->firstChild->nodeValue."<br />";
php { echo $li->lastChild->nodeValue."<br />";
php { echo $li->childNodes->item(0)->nodeValue."<br />";
php { }
Question 1<br /> Answer1<br />
Question 1<br />
Question 2<br /> Answer2<br />
Question 2<br /> 
```

如您所见，我没有成功，一切正常。我唯一改变的是`$lis = $ol->childNodes;`因为`$lis = $xpath->query('//li', $ol);`否则我在节点之间得到空白文本节点`<li>`并且脚本崩溃了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T15:49:44.953

如果您不禁止错误报告，您会看到有一个致命错误会破坏您的脚本。

为了使用**item**方法：

```
foreach ($lis as $li) {
  if (method_exists($li->childNodes, 'item')) {
    echo $li->childNodes->item(0)->nodeValue."<br />";
    // To reproduce the exact output you need this line also. 
    // You need to display the second child (Answer)
    echo $li->childNodes->item(1)->nodeValue."<br />";
  }  
} 
```

唯一的区别是第一个脚本

```
foreach ($lis as $li) {
  echo $li->firstChild->nodeValue."<br />";
  echo $li->lastChild->nodeValue."<br />";    
  //echo $li->childNodes->item(0)->nodeValue."<br />";
} 
```

仅抛出**通知：尝试获取 non-object 的属性**，但脚本继续。

与方法 item() 一样，它会引发致命错误。**（致命错误：在非对象上调用成员函数 item()）。**这会杀死你的脚本。

有关如何迭代这些节点列表（foreach 与 for）的更多详细信息，请阅读这些页面的评论

*   [http://www.php.net/manual/en/class.domnodelist.php](http://www.php.net/manual/en/class.domnodelist.php)
*   [http://www.php.net/manual/en/domnodelist.item.php](http://www.php.net/manual/en/domnodelist.item.php)

`<li>`由于标签后的尾随空格，您尤其会遇到这个问题。

它像这样循环：第一个`<li>`标签，然后是空格`' ' DOMText`元素，然后是第二个`<li>`标签，然后是第二个`' ' DOMText`元素。

在 DOMText 元素上它崩溃了。你可以清除空间，它会工作。

```
$html_data = '<html><body><ol><li><strong>Question 1</strong> Answer1</li><li><strong>Question 2</strong> Answer2</li></ol></body></html>'; 
```

# c++ - c++中的命名空间问题' 不是命名空间'

> ID：14551575
> 
> 赞同：0
> 
> 时间：2013-01-27T19:59:22.623
> 
> 标签：c++, gcc, cygwin

我正在开发一个 c++ 程序，我已经创建了一个 TextUserInterface 类，并试图在 main 方法中调用它的一个实例。这是 TextUserInterface.h、TextUserInterface.cpp 和 GasStationFinder.cpp（包含主要方法）。

```
#include <iostream>
using namespace std;

using namespace view; // compiler is comlaining here saying '<type error>' is not
                       // a namespace and expected namespace name before ;
#include "TextUserInterface.h"

int main() {
    view::TextUserInterface tui;
     tui.run();
    return 0;
} 
```

文本用户界面.h

```
/*
 * TextUserInterface.h
 *
 *  Created on: Jan 27, 2013
 *      Author: Chris
 */

#ifndef TEXTUSERINTERFACE_H_
#define TEXTUSERINTERFACE_H_

namespace view {

class TextUserInterface {
public:
    TextUserInterface();
    void run();
virtual ~TextUserInterface();
};

} /* namespace view */
#endif /* TEXTUSERINTERFACE_H_ */ 
```

文本用户界面.cpp

```
 /*
  * TextUserInterface.cpp
 *
 *  Created on: Jan 27, 2013
 *      Author: Chris
 */

#include <iostream>
using namespace std;

#include "TextUserInterface.h"

namespace view {

TextUserInterface::TextUserInterface() {
    // TODO Auto-generated constructor stub

}

void TextUserInterface::run(){

cout << "Welcome to the Gas Station Finder" << endl;
    cout << "" << endl;
cout << "What would you like to query: (m)inimum price, ma(x)imum price, 
(p)repay pumps, (t)hreshold price, (l)ist stations, (q)uit?" << endl;

}

 TextUserInterface::~TextUserInterface() {
    // TODO Auto-generated destructor stub
}

} /* namespace view */ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:01:24.463

在包含标题之前，您正在使用命名空间。切换它们，否则编译器无法识别此标识符。

```
#include "TextUserInterface.h"
using namespace view; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:02:59.810

颠倒顺序

```
#include "TextUserInterface.h"

using namespace view; 
```

您必须在使用之前引入命名空间。

# qt4 - 使用 QSortFilterProxyModel 时不调用 QItemSelectionModel.selectionChanged

> ID：14551580
> 
> 赞同：1
> 
> 时间：2013-01-27T19:59:47.070
> 
> 标签：qt4, selectionmodel, qsortfilterproxymodel

我有一个[QTreeview](http://doc.qt.digia.com/qt/qtreeview.html)，它使用[QSortFilterProxyModel](http://doc.qt.digia.com/qt/qsortfilterproxymodel.html)允许通过输入文本进行过滤，并且还使用[QItemSelectionModel](http://doc.qt.digia.com/qt/qitemselection.html)将选择保留在树视图上。

问题是，有什么办法可以避免过滤结果反映在项目选择上？

绘制我想要实现的目标，目前发生的事情是这样的。

状态 1。最初的。

```
Root
|---Leaf-1 Selected (manually)
|---Leaf-2
|---Leaf-3 
```

状态 2。例如，通过“Leaf-3”过滤后，treeview 显示：

```
Root
|---Leaf-3 
```

状态 3 非理想。然后清除过滤文本然后：

```
Root
|---Leaf-1 
|---Leaf-2
|---Leaf-3 
```

我希望“Leaf-1”保持选中状态，例如：

状态3-理想。

```
Root
|---Leaf-1 Selected
|---Leaf-2
|---Leaf-3 
```

查看代码，当[QSortFilterProxyModel.filterAcceptsRow](http://doc.qt.digia.com/qt/qsortfilterproxymodel.html#filterAcceptsRow)返回 false 时，看起来[QItemSelectionModel.selectionChanged](http://doc.qt.digia.com/qt/qitemselectionmodel.html#selectionChanged)的​​参数`deselected`设置了要取消选择的项目的信息。而且我还没有找到任何方法来区分一个项目是手动取消选择还是通过过滤取消选择的。

我`PyQt`在 Ubuntu 12.10 上使用，但我认为这应该适用于所有`Qt`实现。

# ios - 检查使用模态视图控制器隐藏的 iOS 状态栏

> ID：14551583
> 
> 赞同：5
> 
> 时间：2013-01-27T20:00:00.877
> 
> 标签：ios, objective-c, modalviewcontroller, statusbar

所以我在 Xcode 中使用“实用程序应用程序”模板并拥有**主视图控制器**，用户可以在其中使用按钮隐藏和显示状态栏。我也有**Flipside View Controller**，使用模态 segue ，它有一个完成按钮返回到**Main VC**。我已经进行了设置，这样每当查看**Flipside VC**时，状态栏始终不会隐藏。这意味着如果用户隐藏**Main VC**上的状态栏并转换到**Flipside VC**，它将动画，如果用户没有隐藏状态栏并且他们转换，状态栏不会发生任何事情。

这一切都很好，问题是从**Flipside VC**转换回**Main VC**。**我需要一个条件来检查Main VC**中状态栏的隐藏状态，当按下完成按钮时，它将在**Flipside VC中调用。**

我已经研究过使用 BOOL 和 NSNotificationCenter 向**Flipside VC**发送关于状态栏状态的消息。

我有这个代码：

```
-(BOOL)checkStatusBarHidden:(id)input
{
    BOOL result;

    if ([UIApplication sharedApplication].statusBarHidden = YES)
    {
        result = YES;
    }
    else
    {
        result = NO;
    }

    return result;
} 
```

但这只是猜测和思考，我也许可以在某处使用它来通知**Flipside VC**状态栏状态。我想也许改变

```
[UIApplication sharedApplication].statusBarHidden = YES) 
```

类似于

```
self.statusBarHidden = YES //which of course isn't going to work 
```

但无论如何，正如我所说，这是猜测，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:19:28.237

您可能会考虑在 using 属性中存储有关状态栏状态的信息`MainViewController`，例如

### 在你的`MainViewController.h`

```
@property (nonatomic, assign) BOOL statusBarHidden; 
```

`FlipsideViewController`然后您可以使用该`presentingViewController`属性访问该值。

### 在你的`FlipsideViewController.h`

```
MainViewController * mainVC = self.presentingViewController;
if (mainVC.statusBarHidden) {
   // Do stuff
} 
```

最后，**请将**您的`checkStatusBarHidden:`方法更改为类似

```
- (BOOL)checkStatusBarHidden {
    return [UIApplication sharedApplication].statusBarHidden;
} 
```

# python - 使用 Python 在放入 Dropbox 之前加密文件

> ID：14551589
> 
> 赞同：0
> 
> 时间：2013-01-27T20:00:09.500
> 
> 标签：python, encryption, dropbox

我想在使用 Python 中的密钥和一些加密标准上传到 Dropbox 之前加密文件。在不使用任何第三方工具的情况下，我将如何在代码中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:03:57.113

我建议使用像[pycrypto](http://pypi.python.org/pypi/pycrypto/2.6)这样的加密库。密码学很难，自己动手做肯定会出现安全漏洞。

哦，您应该阅读 Bruce Schneier 的这篇文章：[为什么密码学很难](http://www.schneier.com/essay-037.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:11:19.607

您可以尝试使用[pyDes](http://twhiteman.netfirms.com/des.html)和/或[rsa](http://stuvel.eu/rsa)

# php - 使用 PHP 从 SQL 数据库更新下拉列表

> ID：14551593
> 
> 赞同：0
> 
> 时间：2013-01-27T20:00:21.973
> 
> 标签：php, drop-down-menu, dbo

我知道这应该很简单，但我似乎无法理解它。

我有一个 sql 数据库中的大陆列表，我使用 PHP DBO 返回并显示在下拉列表中。然后我想做的是从 sql 数据库中获取用户首选的大陆，然后在列表中选择那个大陆。例如，如果列表包含 World、Africa、Europe、N America 和 S America，但用户最喜欢的是“Europe”，我希望选择那个。`$getContinent`是用户的偏好。

```
while ($row = $continent_results->fetch(PDO::FETCH_ASSOC)) {

    if ($getContinent != ''){
        echo '<option value="' . $getContinent . '" selected="selected" >' . $row['CONTINENT_NAME'] . '</option>';
    }else{
        echo '<option value=' . $row['CONTINENT_ID'] . '>' . $row['CONTINENT_NAME'] . '</option>';
    }
} 
```

如果有人能让我直截了当，我将不胜感激，因为我在互联网上找到了一些例子，但无法让它们工作:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:08:43.457

你的代码应该是这样的

```
while ($row = $continent_results->fetch(PDO::FETCH_ASSOC)) {

//just check if the option id is equal to the chosen value

    if ($getContinent != '' && $getContinent==$row['CONTINENT_ID'] ){

        echo '<option value="' . $getContinent . '" selected="selected" >' . $row['CONTINENT_NAME'] . '</option>';

    }else{
        echo '<option value=' . $row['CONTINENT_ID'] . '>' . $row['CONTINENT_NAME'] . '</option>';
    }
} 
```

正如您所猜测的那样，它很简单：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:05:36.527

你会使用这样的东西：

```
while ($row = $continent_results->fetch(PDO::FETCH_ASSOC)) {
    echo '<option value="' . $row['CONTINENT_ID'] . '">' . $row['CONTINENT_NAME'] . '</option>';
} 
```

我希望这会有所帮助！

--al

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:11:49.860

您可以使用三元运算符

```
while ($row = $continent_results->fetch(PDO::FETCH_ASSOC)) {
    echo '<option value="' . $row['CONTINENT_ID'] . 
         ($getContinent == $row['CONTINENT_NAME']) ? '" selected="selected"' : '"' . '>' . 
         $row['CONTINENT_NAME'] . '</option>';
} 
```

# javascript - 如何将 Jplayer 包含并设置为音频播放器？

> ID：14551594
> 
> 赞同：0
> 
> 时间：2013-01-27T20:00:22.280
> 
> 标签：javascript, jquery, html, html5-audio, jplayer

我想使用 Jplayer 音频播放器，但找不到文档或文章告诉我要包含什么以及如何设置 jplayer 音频播放器。

以前做过这个的任何人都可以指导我如何包含 jplayer 音频播放器并使其正常工作吗？

在这个链接中，我想实现`jplayer as an audio player`列表中的第二个：[http](http://www.jplayer.org/latest/demos/) ://www.jplayer.org/latest/demos/ 。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:12:37.813

[Jplayer 快速入门文档](http://www.jplayer.org/latest/quick-start-guide/)

# html - 包含 php 文件会使 html 部分无法正常工作

> ID：14551601
> 
> 赞同：0
> 
> 时间：2013-01-27T20:01:00.063
> 
> 标签：html

我的一个网站出了点问题。如果我包含一个 php 文件来连接到这样的数据库：

```
<?php
$username = "";
$password = "";
$hostname = ""; 

$dbhandle = mysql_connect($hostname, $username, $password) or die("Unable to connect to MySQL");
$selected = mysql_select_db("rugbyspi_ador",$dbhandle) or die("Could not select examples");

mysql_close($dbhandle);
?> 
```

并将文件从 index.html 重命名为 index.php 一节显得非常大。我会给你链接，你自己看：

[http://www.rugbyspirit.net/ador_test/index.php](http://www.rugbyspirit.net/ador_test/index.php)看看“Scolile参与者”这里是完全相同的HTML代码，不包括连接到数据库的php文件：[http ://www.rugbyspirit.net/ ador_test/test.html](http://www.rugbyspirit.net/ador_test/test.html) 我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:13:33.190

这是一个 CSS 问题。你只需要调整你的 CSS：

```
.box {
    background: url(images/box.png) repeat 0 0;
    padding: 19px 32px 29px 32px;
    position: relative;
} 
```

您已`height: 100%`设置 on `.box`，这不是必需的。这导致了 Chrome 问题。

# php - MYSQL PHP 选择

> ID：14551607
> 
> 赞同：-2
> 
> 时间：2013-01-27T20:01:53.980
> 
> 标签：php, mysql

如何以这种方式选择：

```
$sql_result = mysql_query("SELECT 1 FROM myTable WHERE myColumn = 'something' LIMIT 0,1");
if(is_resource($sql_result) && mysql_num_rows($sql_result) > 0 ){
    // how do I select a row here?
} 
```

就像我会这样：

```
$query = "SELECT * FROM myTable WHERE myColumn='something'";
$result = mysql_query($query) or die(mysql_error());
while ($row = mysql_fetch_array($result)) {
    $something = $row['SOMETHING'];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:15:15.263

# 这是过时的解决方案。不要使用 mysql_ 函数

* * *

方法1\. **（不要用我它已经过时了）**

```
$sql_result = mysql_query("SELECT xxx FROM myTable WHERE myColumn = 'something' LIMIT 0,1");
$row = mysql_fetch_array($sql_result); 
echo $row['xxx']; 
```

方法2\. **（不要用我它已经过时了）**

```
$sql_result = mysql_query("SELECT xxx FROM myTable WHERE myColumn = 'something' LIMIT 0,1");
$row = mysql_fetch_row($sql_result); 
echo $row[0]; 
```

请注意`SELECT 1 FROM table`会给你...每行第 1 个/

# node.js - Node.js 支持的编码列表

> ID：14551608
> 
> 赞同：172
> 
> 时间：2013-01-27T20:01:55.990
> 
> 标签：node.js

我需要读取一个用 ISO-8859-1（也称为 latin1）编码的文件，如下所示：

```
var file_contents = fs.readFileSync("test_data.html", "latin1"); 
```

但是，Node 抱怨“latin1”或“ISO-8859-1”不是有效编码（“错误：未知编码”）。

接受哪些编码`readFileSync`？

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2013-01-27T20:07:24.397

节点本身支持的编码列表相当短[：](https://github.com/nodejs/node/blob/master/lib/buffer.js)

*   ASCII
*   base64
*   base64url (节点 v14+)
*   十六进制
*   ucs2/ucs-2/utf16le/utf-16le
*   utf8/utf-8
*   binary/latin1（ISO8859-1，latin1 仅在节点 6.4.0+ 中）

如果您使用的是 6.4.0 之前的版本，或者不想处理非 Unicode 编码，您可以重新编码字符串：

使用[iconv-lite](https://github.com/ashtuchkin/iconv-lite)重新编码文件：

```
var iconvlite = require('iconv-lite');
var fs = require('fs');

function readFileSync_encoding(filename, encoding) {
    var content = fs.readFileSync(filename);
    return iconvlite.decode(content, encoding);
} 
```

或者，使用[iconv](https://github.com/bnoordhuis/node-iconv)：

```
var Iconv = require('iconv').Iconv;
var fs = require('fs');

function readFileSync_encoding(filename, encoding) {
    var content = fs.readFileSync(filename);
    var iconv = new Iconv(encoding, 'UTF-8');
    var buffer = iconv.convert(content);
    return buffer.toString('utf8');
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-10-05T13:54:09.883

编码在[缓冲区文档](https://nodejs.org/api/buffer.html)中有详细说明。

## [缓冲区和字符编码](https://nodejs.org/api/buffer.html#buffer_buffers_and_character_encodings)：

> ### 字符编码
> 
> *   **`utf8`**: 多字节编码的 Unicode 字符。许多网页和其他文档格式使用 UTF-8。这是默认的字符编码。
> *   **`utf16le`**: 多字节编码的 Unicode 字符。与 不同`utf8`的是，字符串中的每个字符都将使用 2 或 4 个字节进行编码。
> *   **`latin1`**：Latin-1 代表 ISO-8859-1。此字符编码仅支持从`U+0000`到的 Unicode 字符`U+00FF`。
> 
> ### 二进制到文本编码
> 
> *   **`base64`**：Base64 编码。从字符串创建缓冲区时，此编码还将正确接受 RFC 4648 第 5 节中指定的“URL 和文件名安全字母”。
> *   **`base64url`**（Node v14+）：RFC 4648 第 5 节中指定的 base64url 编码。从字符串创建缓冲区时，此编码也将正确接受常规 base64 编码的字符串。将 Buffer 编码为字符串时，此编码将省略填充。
> *   **`hex`**：将每个字节编码为两个十六进制字符。
> 
> ### 传统字符编码
> 
> *   **`ascii`**：仅适用于 7 位 ASCII 数据。通常，没有理由使用这种编码，因为在编码或解码纯 ASCII 文本时，“utf8”（或者，如果已知数据始终是纯 ASCII 数据，则为“latin1”）将是更好的选择。
> *   **`binary`**: 'latin1' 的别名。
> *   **`ucs2`**: 'utf16le' 的别名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:10:07.413

如果上述解决方案对您不起作用，则可以使用以下纯 nodejs 代码获得相同的结果。以上对我不起作用，并在 OSX 上运行“npm install iconv”时导致编译异常：

```
npm install iconv

npm WARN package.json portalServer@0.1.0 No README.md file found!
npm http GET https://registry.npmjs.org/iconv
npm http 200 https://registry.npmjs.org/iconv
npm http GET https://registry.npmjs.org/iconv/-/iconv-2.0.4.tgz
npm http 200 https://registry.npmjs.org/iconv/-/iconv-2.0.4.tgz

> iconv@2.0.4 install /Users/markboyd/git/portal/app/node_modules/iconv
> node-gyp rebuild

gyp http GET http://nodejs.org/dist/v0.10.1/node-v0.10.1.tar.gz
gyp http 200 http://nodejs.org/dist/v0.10.1/node-v0.10.1.tar.gz
xcode-select: Error: No Xcode is selected. Use xcode-select -switch <path-to-xcode>, or see the xcode-select manpage (man xcode-select) for further information. 
```

如果未指定编码，fs.readFileSync() 返回一个 Buffer。并且 Buffer 有一个 toString() 方法，如果没有指定编码给你文件的内容，它将转换为 UTF8。请参阅 nodejs 文档。这对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-25T19:11:06.420

从 v12 开始，Node 支持以下编码值：

*   `ascii`
*   `base64`
*   `hex`
*   `latin1`
*   `ucs2`
*   `utf16le`
*   `utf8`

节点 v14 及更高版本添加`base64url`编码。

使用这个 shell 脚本来破解支持的编码：

```
for v in {12..17}; do echo v$v; curl -L https://raw.githubusercontent.com/nodejs/node/v$v.x/lib/buffer.js --silent | grep -A 100000 'const encodingOps' | grep -B 100000 -E '^}' -m 1 | grep -Eo '^  [^ :}]+' | grep -Eo '[^ ]+' | sort; echo ---; done 
```

# r - 从 R 中的核密度估计中获取值

> ID：14551610
> 
> 赞同：10
> 
> 时间：2013-01-27T20:02:02.847
> 
> 标签：r, statistics, kernel-density

我正在尝试获取 R 中股票价格对数的密度估计值。我知道我可以使用`plot(density(x))`. 但是，我实际上想要函数的值。

我正在尝试实现内核密度估计公式。这是我到目前为止所拥有的：

```
a <- read.csv("boi_new.csv", header=FALSE)
S = a[,3] # takes column of increments in stock prices
dS=S[!is.na(S)] # omits first empty field

N = length(dS)                  # Sample size
rseed = 0                       # Random seed
x = rep(c(1:5),N/5)             # Inputted data

set.seed(rseed)   # Sets random seed for reproducibility

QL <- function(dS){
    h = density(dS)$bandwidth
    r = log(dS^2)
    f = 0*x
    for(i in 1:N){
        f[i] = 1/(N*h) * sum(dnorm((x-r[i])/h))
    }
    return(f)
}

QL(dS) 
```

任何帮助将非常感激。一直在这几天！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-27T20:08:49.843

您可以直接从`density`函数中提取值：

```
x = rnorm(100)
d = density(x, from=-5, to = 5, n = 1000)
d$x
d$y 
```

或者，如果您真的想编写自己的内核密度函数，这里有一些代码可以帮助您入门：

1.  设置点`z`和`x`范围：

    ```
    z = c(-2, -1, 2)
    x = seq(-5, 5, 0.01) 
    ```

2.  现在我们将点添加到图表中

    ```
    plot(0, 0, xlim=c(-5, 5), ylim=c(-0.02, 0.8), 
         pch=NA, ylab="", xlab="z")
    for(i in 1:length(z)) {
       points(z[i], 0, pch="X", col=2)
    }
     abline(h=0) 
    ```

3.  在每个点周围放置法线密度：

    ```
    ## Now we combine the kernels,
    x_total = numeric(length(x))
    for(i in 1:length(x_total)) {
      for(j in 1:length(z)) {
        x_total[i] = x_total[i] + 
          dnorm(x[i], z[j], sd=1)
      }
    } 
    ```

    并将曲线添加到图中：

    ```
    lines(x, x_total, col=4, lty=2) 
    ```

4.  最后，计算完整的估计值：

    ```
    ## Just as a histogram is the sum of the boxes, 
    ## the kernel density estimate is just the sum of the bumps. 
    ## All that's left to do, is ensure that the estimate has the
    ## correct area, i.e. in this case we divide by $n=3$:

    plot(x, x_total/3, 
           xlim=c(-5, 5), ylim=c(-0.02, 0.8), 
           ylab="", xlab="z", type="l")
    abline(h=0) 
    ```

    这对应于

    ```
    density(z, adjust=1, bw=1) 
    ```

上面的图给出：

![在此处输入图像描述](../Images/633cba6adbfe91a93bafe8e05bef3862.png)

# javascript - 在滑块 div 上设置动态内容

> ID：14551618
> 
> 赞同：5
> 
> 时间：2013-01-27T20:02:27.877
> 
> 标签：javascript, jquery, html

我正在尝试使用这两个 jquery 插件之一（[笨拙](http://www.awkwardgroup.com/sandbox/awkward-showcase-a-jquery-plugin/)/ [Coda Slider 3](http://kevinbatdorf.github.com/codaslider/)）来滑动 DIV 内容。一切正常，直到我在创建插件对象后尝试设置动态内容（使用 js）。DIV 仅显示在插件创建之前加载的内容。为此目标的任何想法或其他 DIV 滑块插件。谢谢。

ajax 工作完美我已经检查过了。这是 coda 滑块 `$('#slider-id').codaSlider();` 和 "awkward" 的加载函数：

```
$(window).ready(function () {
        $("#showcase").awShowcase(
    {
        content_width: 700,
        fit_to_parent: false,
        auto: false,
        interval: 3000,
        continuous: false,
        loading: true,
        tooltip_width: 200,
        tooltip_icon_width: 32,
        tooltip_icon_height: 32,
        tooltip_offsetx: 18,
        tooltip_offsety: 0,
        arrows: true,
        buttons: true,
        btn_numbers: false,
        keybord_keys: true,
        mousetrace: false, /* Trace x and y coordinates for the mouse */
        pauseonover: true,
        stoponclick: true,
        transition: 'fade', /* hslide/vslide/fade */
        transition_speed: 500,
        transition_delay: 300,
        show_caption: 'onhover', /* onload/onhover/show */
        thumbnails: true,
        thumbnails_position: 'outside-last', /* outside-last/outside-first/inside-last/inside-first */
        thumbnails_direction: 'horizontal', /* vertical/horizontal */
        thumbnails_slidex: 0, /* 0 = auto / 1 = slide one thumbnail / 2 = slide two thumbnails / etc. */
        dynamic_height: true, /* For dynamic height to work in webkit you need to set the width and height of images in the source. Usually works to only set the dimension of the first slide in the showcase. */
        speed_change: false, /* Set to true to prevent users from swithing more then one slide at once. */
        viewline: false /* If set to true content_width, thumbnails, transition and dynamic_height will be disabled. As for dynamic height you need to set the width and height of images in the source. */
    });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T23:58:50.013

Kevin Batdorf 在*Coda Slider*上进行了改进，使用了一种名为*Liquid Slider*的东西，它支持 ajax 和回调。

[在此处](http://liquidslider.kevinbatdorf.com/tutorials/dynamically-add-content-to-a-panel-when-clicked-using-ajax/)阅读有关它的教程

它可以在[github](https://github.com/KevinBatdorf/liquidslider)上找到。

# .htaccess - .htaccess 的特殊重写规则

> ID：14551619
> 
> 赞同：1
> 
> 时间：2013-01-27T20:02:29.030
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, rewrite

在尝试使用以下条件进行正确的 .htaccess 重写时遇到问题

原始 URL： [http](http://example.com/foo/bar/ANYTHING) ://example.com/foo/bar/ANYTHING （http 或 https，任何东西都可以是用户输入的任何内容）

重写网址： [https ://example.com/foo/bar/index.php/this/that/ANYTHING](https://example.com/foo/bar/index.php/this/that/ANYTHING)

但不要用 index.php 重写任何内容。

我尝试了几个选项，但我不断获得包含在新 URL 中的文件系统路径。

我的尝试：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /foo/bar/
RewriteCond %{HTTP_HOST} example.com$ [NC]
RewriteCond %{HTTP_HOST} !index.php
RewriteRule ^(.*)$ https://example.com/foo/bar/index.php/this/that/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:06:11.330

*首先，在没有* 的情况下测试您的规则`301`，因为浏览器会缓存 301 结果并使测试变得更加困难。`R=301`在您对规则满意之前不要添加。另请参阅[调试 .htaccess 重写规则的提示](https://stackoverflow.com/a/9204355/1741542)。

您不需要测试`example.com`，除非多个域托管在同一目录中。测试`index.php`是反对`REQUEST_URI`，不是`HTTP_HOST`

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !index.php
RewriteRule ^/?foo/bar/(.*)$ https://example.com/foo/bar/index.php/this/that/$1 [R,L] 
```

# c# - ServiceStack.Redis 存储对象超时并按键检索

> ID：14551622
> 
> 赞同：1
> 
> 时间：2013-01-27T20:02:44.313
> 
> 标签：c#, redis, servicestack

我正在尝试使用 ServiceStack.Redis 客户端从 memcached 移动到 redis。我希望能够简单地检查 Redis 缓存是否有键的项目，如果没有，则使用过期超时添加它们。然后稍后检索它们（如果它们存在）。

为了测试这一点，我创建了一个简单的 ASP.NET WebApi 项目并使用这两种方法修改了 ValuesController。

```
public class ValuesController : ApiController
{
    public IEnumerable<string> Get()
    {
        using (var redisClient = new RedisClient("localhost"))
        {
            IRedisTypedClient<IEnumerable<SampleEvent>> redis = redisClient.As<IEnumerable<SampleEvent>>();

            if (!redis.ContainsKey("urn:medications:25"))
            {
                var medsWithID25 = new List<SampleEvent>();
                medsWithID25.Add(new SampleEvent() { ID = 1, EntityID = "25", Name = "Digoxin" });
                medsWithID25.Add(new SampleEvent() { ID = 2, EntityID = "25", Name = "Aspirin" });

                redis.SetEntry("urn:medications:25", medsWithID25);
                redis.ExpireIn("urn:medications:25", TimeSpan.FromSeconds(30));
            }

        }

        return new string[] { "1", "2" };
    }

    public SampleEvent Get(int id)
    {
        using (var redisClient = new RedisClient("localhost"))
        {
            IRedisTypedClient<IEnumerable<SampleEvent>> redis = redisClient.As<IEnumerable<SampleEvent>>();
            IEnumerable<SampleEvent> events = redis.GetById("urn:medications:25");

            if (events != null)
            {
                return events.Where(m => m.ID == id).SingleOrDefault();
            }
            else
                return null;
        }
    }
} 
```

这似乎不起作用。redis.GetById 总是返回 null。我究竟做错了什么？

谢谢。

更新 1：

如果我将获取数据的行更改为：

```
IEnumerable<SampleEvent> events = redis.GetValue("urn:medications:25"); 
```

然后我取回我的对象​​，但即使在超时之后也应该删除它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T12:13:50.223

好吧，我想我明白了。这似乎是 TypedRedisClient 和/或处理键的方式的错误。

我将在此处发布我的解决方案，以供其他在这个简单场景中遇到问题的人使用 Redis 作为持久缓存并且并不真正关心 Sets、Hashes 等的额外功能......

添加以下扩展方法：

```
using System;
using System.Text;
using System.IO;
using System.Linq;
using System.Collections.Generic;
using ServiceStack.OrmLite;
using ServiceStack.Common;
using ServiceStack.Common.Utils;
using ServiceStack.DesignPatterns.Model;
using ServiceStack.ServiceInterface;
using ServiceStack.CacheAccess;
using ServiceStack.ServiceHost;
using ServiceStack.Redis;

namespace Redis.Extensions
{
    public static class RedisExtensions
    {
        internal static T GetFromCache<T>(this IRedisClient redisClient, string cacheKey,
            Func<T> factoryFn,
            TimeSpan expiresIn)
        {
            var res = redisClient.Get<T>(cacheKey);
            if (res != null)
            {
                redisClient.Set<T>(cacheKey, res, expiresIn);
                return res;
            }
            else
            {
                res = factoryFn();
                if (res != null) redisClient.Set<T>(cacheKey, res, expiresIn);
                return res;
            }
        }

    }
} 
```

然后我把我的测试代码改成这个。显然这是草率的，需要改进，但至少我的测试按预期工作。

```
using ServiceStack.Redis;
using ServiceStack.Redis.Generic;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Threading.Tasks;
using System.Web.Http;
using Redis.Extensions;

namespace RedisTestsWithBooksleeve.Controllers
{
    public class SampleEvent
    {
        public int ID { get; set; }
        public string EntityID { get; set; }
        public string Name { get; set; }
    }

    public class ValuesController : ApiController
    {
        public IEnumerable<string> Get()
        {
            using (var redisClient = new RedisClient("localhost"))
            {
                if (!redisClient.ContainsKey("Meds25"))
                {

                    redisClient.GetFromCache<IEnumerable<SampleEvent>>("Meds25", () => { 

                        var medsWithID25 = new List<SampleEvent>();
                        medsWithID25.Add(new SampleEvent() { ID = 1, EntityID = "25", Name = "Digoxin" });
                        medsWithID25.Add(new SampleEvent() { ID = 2, EntityID = "25", Name = "Aspirin" });

                        return medsWithID25;

                    }, TimeSpan.FromSeconds(5));
                }

            }

            return new string[] { "1", "2" };
        }

        public SampleEvent Get(int id)
        {
            using (var redisClient = new RedisClient("localhost"))
            {
                IEnumerable<SampleEvent> events = redisClient.GetFromCache<IEnumerable<SampleEvent>>("Meds25", () =>
                {

                    var medsWithID25 = new List<SampleEvent>();
                    medsWithID25.Add(new SampleEvent() { ID = 1, EntityID = "25", Name = "Digoxin" });
                    medsWithID25.Add(new SampleEvent() { ID = 2, EntityID = "25", Name = "Aspirin" });

                    return medsWithID25;

                }, TimeSpan.FromSeconds(5));

                if (events != null)
                {
                    return events.Where(m => m.ID == id).SingleOrDefault();
                }
                else
                    return null;
            }
        }
    }
} 
```

# ajax - 将部分视图中的表单模型发送到 json 函数

> ID：14551627
> 
> 赞同：0
> 
> 时间：2013-01-27T20:03:09.070
> 
> 标签：ajax, json, asp.net-mvc-3, partial-views

我有一个在网站主要部分视图中使用的时事通讯邮件列表中保存电子邮件的部分视图。当点击它的按钮时，它应该将表单发送到 services.js，然后发送到操作以保存在数据库中。但是它会在其中保存“null”，当我在动作上设置断点时，它不会随之而来。我应该怎么办？

通讯模型：

```
 public class NewsletterModel
    {
        [Required(ErrorMessage = "Please enter your email address!")]
        [Display(Name = "Email")]
        public string Email { get; set; }

        public Int16 LanguageId { get; set; }
    } 
```

部分视图代码：

```
 @model Orinus.Models.NewsletterModel

<script src="@Url.Content("~/Scripts/jquery-1.4.4.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<link href="../../Content/Default/Site.css" rel="stylesheet" type="text/css" />
<script src="../../Scripts/Services.js" type="text/javascript"></script>

@using (Html.BeginForm()) {
@Html.ValidationSummary(true)

    <div class="editor-label">
        @Html.LabelFor(model => model.Email)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Email)
        @Html.ValidationMessageFor(model => model.Email)
    </div>
<br />
    <p>
     <input type="button" value="Register" id="saveEmailNewsletter" class="ButtonStyle"/>
   </p>
} 
```

这是操作代码：

```
[HttpPost]
        public ActionResult Index(NewsletterModel newsLetter)
        {
            if (!ModelState.IsValid)
            {
                return PartialView("_Newsletter", newsLetter);
            }
            SaveEmailForNewsletterSrv newsLetterSrv = new SaveEmailForNewsletterSrv();
            newsLetterSrv.SaveEmailForNewsletter(newsLetter);

            return Json(new { success = true });
        }
    } 
```

此代码适用于 Services.js：

```
/// <reference path="jquery-1.7.1.min.js" />

$(function () {
    $("#saveEmailNewsletter").click(function () {
    var email = $("#Email").val();
    var language = 1;
    newsLetter = { 'Email': email,'Language': language };
        if (dat == null) {
            alert("Please enter your email address!");
            return;
        }

        $.ajax({
            url: '/Newsletter/Index',
            type: 'POST',
            dataType: 'json',
            data: newsLetter,
            contentType: 'application/json; charset=utf-8',
            success: function (result) {
                if (result.success) {
                    // We have a JSON object in case of success
                    Alert ('Successfully registered...');
                } else {
                    // We have the partial with errors in case of failure
                    // so all we have to do is update the DOM
                    $('#resultMessage').dialog(result);
                }
            }
        });
    })
}); 
```

# magento - 可配置产品未显示在前端（目录和搜索页面）

> ID：14551630
> 
> 赞同：1
> 
> 时间：2013-01-27T20:03:17.407
> 
> 标签：magento, magento-1.7, configurable-product

我的可配置产品没有显示在前端。在后端，Magento 似乎将可配置产品列为 0 库存（尽管没有可配置产品的数量输入框）。

1.  他们所有的产品都设置为“有货”并且数量高于零
2.  可配置产品本身也设置为“有货”[没有数量设置-如上所述]
3.  数据被重新索引并且缓存已经被刷新
4.  使用 Magento 1.7.0.2
5.  [在此处](http://www.magentocommerce.com/magento-connect/simple-configurable-products.html)使用流行的扩展简单可配置产品

请指教...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-28T01:04:19.063

这是对我有用的解决方案：

问题在于简单可配置产品（有机互联网）中使用的代码

我想指出，我同时遇到了两个单独的问题 - 上述问题，并且产品价格指数拒绝被索引（我收到此消息：*无法初始化索引器进程*，解释为*SQLSTATE [21S01]：插入值列表与列列表不匹配：1136 列计数与第 1 行的值计数不匹配*）

事实证明这两个问题是相关的，下面解决了它们;）

1.  在文件 **/app/code/community/OrganicInternet/SimpleConfigurableProducts/Catalog/Model/Resource/Eav/Mysql4/Product/Indexer/Price/Configurable.php**

改变：

```
$select->columns(array(
        'entity_id'         => new Zend_Db_Expr('e.entity_id'),
        'customer_group_id' => new Zend_Db_Expr('pi.customer_group_id'),
        'website_id'        => new Zend_Db_Expr('cw.website_id'),
        'tax_class_id'      => new Zend_Db_Expr('pi.tax_class_id'),
        'orig_price'        => new Zend_Db_Expr('pi.price'),
        'price'             => new Zend_Db_Expr('pi.final_price'),
        'min_price'         => new Zend_Db_Expr('pi.final_price'),
        'max_price'         => new Zend_Db_Expr('pi.final_price'),
        'tier_price'        => new Zend_Db_Expr('pi.tier_price'),
        'base_tier'         => new Zend_Db_Expr('pi.tier_price'),
    )); 
```

至：

```
$select->columns(array(
        'entity_id' => new Zend_Db_Expr('e.entity_id'),
        'customer_group_id' => new Zend_Db_Expr('pi.customer_group_id'),
        'website_id' => new Zend_Db_Expr('cw.website_id'),
        'tax_class_id' => new Zend_Db_Expr('pi.tax_class_id'),
        'orig_price' => new Zend_Db_Expr('pi.price'),
        'price' => new Zend_Db_Expr('pi.final_price'),
        'min_price' => new Zend_Db_Expr('pi.final_price'),
        'max_price' => new Zend_Db_Expr('pi.final_price'),
        'tier_price' => new Zend_Db_Expr('pi.tier_price'),
        'base_tier' => new Zend_Db_Expr('pi.tier_price'),
        'group_price' => new Zend_Db_Expr('pi.group_price'),
        'base_group_price' => new Zend_Db_Expr('pi.group_price'),
    )); 
```

和

```
$outerSelect->columns(array(
        'customer_group_id',
        'website_id',
        'tax_class_id',
        'orig_price',
        'price',
        'min_price',
        'max_price'     => new Zend_Db_Expr('MAX(inner.max_price)'),
        'tier_price',
        'base_tier',
        #'child_entity_id'
    )); 
```

至

```
$outerSelect->columns(array(
        'customer_group_id',
        'website_id',
        'tax_class_id',
        'orig_price',
        'price',
        'min_price',
        'max_price'     => new Zend_Db_Expr('MAX(inner.max_price)'),
        'tier_price',
        'base_tier',
    'group_price',
    'base_group_price',
        #'child_entity_id'
    )); 
```

来源：与[此](https://github.com/organicinternet/magento-configurable-simple/commit/6d88e5e)一起的[主要问题](https://github.com/organicinternet/magento-configurable-simple/pull/85)（但请注意，正确的代码是**'base_group_price' => new Zend_Db_Expr('pi.group_price')，**而不是**'base_group_price' => new Zend_Db_Expr('** ***pi.base_group_price*** **')，**

 ***2.  另外，在文件中：**/app/code/community/OrganicInternet/SimpleConfigurableProducts/Catalog/Model/Resource/Eav/Mysql4/Product/Indexer/Price.php**

改变

```
$this->cloneIndexTable(true); 
```

至

```
$this->clearTemporaryIndexTable(); 
```

来源：[这里](http://www.magentocommerce.com/boards/viewthread/286645/)

我花了几个小时才弄清楚这一点，所以我写了这篇文章来帮助其他人避免浪费所有的时间。

祝你好运！***

# php - setcookie HTTP 500 错误

> ID：14551631
> 
> 赞同：0
> 
> 时间：2013-01-27T20:03:21.547
> 
> 标签：php

我想知道是否有人能发现我的 php 代码有什么问题，用于设置 cookie。谢谢！

```
 $expire=time()+60*60*24*30;
    $selected_image = $_GET["img"];
    $selected_caption = $_GET["caption"];
    $selected_color = $_GET["color"];

    switch ($selected_image){
        case:"img1"
            setcookie("img1_caption", $selected_caption, $expire);
            setcookie("img1_color", $selected_color, $expire);
            break;
        case:"img2"
            setcookie("img2_caption", $selected_caption, $expire);
            setcookie("img2_color", $selected_color, $expire);
            break;
        case:"img3"
            setcookie("img3_caption", $selected_caption, $expire);
            setcookie("img3_color", $selected_color, $expire);      
            break;
        case:"img4"
            setcookie("img4_caption", $selected_caption, $expire);
            setcookie("img4_color", $selected_color, $expire);          
            break;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:06:07.010

你的语法不正确。`:`追求价值。请参阅[文档](http://php.net/manual/en/control-structures.switch.php)。

```
switch ($selected_image){
    case "img1":
        setcookie("img1_caption", $selected_caption, $expire);
        setcookie("img1_color", $selected_color, $expire);
        break;
    case "img2":
        setcookie("img2_caption", $selected_caption, $expire);
        setcookie("img2_color", $selected_color, $expire);
        break;
    case "img3":
        setcookie("img3_caption", $selected_caption, $expire);
        setcookie("img3_color", $selected_color, $expire);      
        break;
    case "img4":
        setcookie("img4_caption", $selected_caption, $expire);
        setcookie("img4_color", $selected_color, $expire);          
        break;
} 
```

# php - PHP if 语句无法在“！== 0”上验证

> ID：14551632
> 
> 赞同：0
> 
> 时间：2013-01-27T20:03:37.803
> 
> 标签：php, if-statement, equality

以下怎么可能：

```
$varnum = 4;
if( $varnum/4 - floor($varnum/4) !== 0){
    echo 'foo';
} 
```

这在我运行 PHP 5.1.6 的服务器上呼应了“foo”。如果我将运算符更改为`==`我得到相同的结果。

我不知道为什么，但可能是因为“==”是“等于”而“！==”是“不相同”？那么我如何使它们相同？我想在 javaScript 中我会“parseInt”，但 PHP 中没有这样的东西，对吧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T20:06:06.170

失败的原因是因为在 PHP 中，该`floor`函数返回 a `float`，尽管该值始终是整数。您可以在此处的文档中看到这一点：http: [//php.net/manual/en/function.floor.php](http://php.net/manual/en/function.floor.php)

您正在将该浮点数与整数零进行固定类型比较，因此无论该值是否实际上为零，结果都是错误的。

要解决此问题，请执行以下任一操作：

*   将 的输出`floor`转换为整数 -`intval(float(...))`要么`(int)float(..)`
*   使用`!=`而不是`!==`.
*   使用`0.0`而不是仅仅`0`用来比较。

如果您想知道为什么`floor()`会返回浮点数而不是整数，那是因为输入是浮点数。浮点数据类型具有比整数更大的可能范围，因此可以调用`floor()`一个太大而无法保存在整数中的值。因此，函数返回整数是不安全的；它返回一个浮点数，以便它可以保证结果是正确的。

乍一看似乎很奇怪，但希望这可以为您解释其背后的逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:12:04.000

你想要完成什么？如果您想查看 $varnum 是否可被四整除，请使用模数，所以...

```
$varnum = 4;
if ($varnum % 4 != 0) {
    echo "foo - $varnum is divisible by 4";
} 
```

您的原始帖子应使用 '!=' 与 '!=='，如下所示：

```
$varnum = 4;
if( $varnum/4 - floor($varnum/4) != 0){
    echo 'foo';
} 
```

# objective-c - UITableView 不显示数据

> ID：14551638
> 
> 赞同：0
> 
> 时间：2013-01-27T20:04:29.487
> 
> 标签：objective-c, uitableview

应用委托

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {
    UIStoryboard *myStoryboard = [UIStoryboard storyboardWithName:@"MainSB" bundle:nil];
    tCont = [myStoryboard instantiateViewControllerWithIdentifier:@"Table"];
}

- (void)serviceAdded:(NSNetService *)service moreComing:(BOOL)more {
    tCont.server = _server;
    [tCont addService:service moreComing:more];
} 
```

表控制器

```
- (void)addService:(NSNetService *)service moreComing:(BOOL)more {
    [self.services addObject:service];
    if(!more) {
        [self.tableView reloadData];
    }
} 
```

`server`正确结转，并`service`添加到`services`. 但我没有在我的表格视图中看到它。是因为我试图在视图存在之前实例化它吗？

**更新：**我做了更多的调试，发现 TableController 在我的委托调用它之前被初始化。我只见过一个 TableController 线程，所以我的代码很可能是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:53:05.537

您需要创建一个`UIWindow`，将其`rootViewController`属性设置为您的表视图控制器并将`makeKeyAndVisible`消息发送给它。`tableView:cellForRowAtIndexPath:`您还必须在表视图控制器上实现该方法。

# java - 检测图像中的圆圈？

> ID：14551639
> 
> 赞同：1
> 
> 时间：2013-01-27T20:04:29.203
> 
> 标签：java, geometry, detect

该程序应检测圆圈并将其涂成红色。建议使用对称方法，我假设每个像素都是圆心并检查四个点 r （半径）距它的距离。如果它们相同，请画一个圆圈。但是在下面的代码中，我遇到了许多不必要的圈子

```
static boolean isCenterOfCircle(int row, int col, int r, BufferedImage image) {

            //getPixels gets the color of the current pixel. 
        if(getPixel(row,col,image) == getPixel(row+r,col,image)
             || getPixel(row,col,image) == getPixel(row-r,col,image)
                || getPixel(row,col,image) == getPixel(row,col+r,image)
                    || getPixel(row,col,image) == getPixel(row,col-r,image)){
            return true;
        }else{
        return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:07:44.503

这可以使用圆的霍夫变换来完成。

请参阅[用于检测图像中的圆圈的算法](https://stackoverflow.com/questions/3495572/algorithm-for-detecting-a-circle-in-an-image)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:07:33.983

您应该检查 4 个以上的点来检测圆。16个或更多呢。也许取决于半径。对于更大的半径，您应该检查更多点。

或者在网上搜索圆形检测算法。除了检查几个像素之外，还有其他方法。

# php - 如何将 HTML5 画布保存为链接，以便其他人可以查看和共享

> ID：14551640
> 
> 赞同：0
> 
> 时间：2013-01-27T20:04:30.513
> 
> 标签：php, html, canvas

我有一个用户可以绘制图片的应用程序，这一切都很好。我一直遇到的问题是我希望能够共享用户的绘图，以便其他人也可以看到和共享。截至目前，我正在使用此代码来保存画布：

```
window.location = canvas.toDataUrl(); 
```

但是这样做的问题是图片只在客户端生成，这是我不想要的。我没有使用 php/mysql 或服务器端语言的经验，但我确实有使用 html、css、javascript 的经验。无论如何...任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:37:28.357

您只需在画布上调用 toDataURL，您将获得一个 base64 编码的图像，该图像可以传递到浏览器地址栏中以呈现图像。

```
var ctx = document.getElementById("canvas").getContext("2d");
var image = document.getElementById("someImage");
ctx.fillRect(100,100,100,100);
image.src = canvas.toDataURL("image/png");

var link = document.getElementById("link");

link.addEventListener('click', function(){
    window.open(canvas.toDataURL("image/png"), '_blank');
}); 
```

[http://jsfiddle.net/LvZQF/](http://jsfiddle.net/LvZQF/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:11:47.027

你得到的结果是显而易见的。在 HTML5 画布中，您从 javascript 中绘制的内容是在客户端完成的。因此，如果您想共享绘图，您可以将其导出为图像 [这可能会有所帮助](http://www.nihilogic.dk/labs/canvas2image/)

希望我的回答对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:14:52.563

如果您希望用户通过指向您的页面的链接共享图像，可能的方法是：将图像保存到具有唯一键的数据库中，用户可以使用该键与其他人共享。现在您必须提供一个方法来接受生成的密钥，从数据库加载图像并将其返回给客户端。
另一种方法是让用户可以下载创建的图像，例如 PNG，所有 html5 浏览器都支持该图像。

# visual-studio-2010 - 调试时出现“无效的绑定句柄”

> ID：14551641
> 
> 赞同：1
> 
> 时间：2013-01-27T20:04:37.817
> 
> 标签：visual-studio-2010, qt, windows-8

我昨天组装了我的新电脑，我决定试试 Windows 8。然而，今天，在调试适度的 Qt 应用程序期间，调试器在一个非常简单的行上产生了“无效的绑定句柄”错误消息（这是由 Qt 的 moc.exe 自动生成的行：

```
 // QWebView *view (...)
 view->setUrl(QUrl(QString::fromUtf8("about:blank")));
 // Failing in setUrl call, not in QUrl constructor, or in fromUtf8 function. 
```

但是，在 Release 和 Debug 版本中，在没有调试器的情况下运行此应用程序就可以正常工作。

我在互联网上找到了一些启用终端服务的线索，但似乎 Windows 8 中没有这样的服务。

有人知道我应该检查什么吗？

**编辑**

将小部件移动到其他应用程序不会产生任何错误，因此显然，小部件（非常小 - 只是`QWebView`和`QProgressBar`）很好。但是，当我在我的主要功能中显示这个小部件时：

```
QApplication app(argc, argv);
MyWidget w;
w.show();
return app.exec(); 
```

它仍然失败并出现相同的错误。检查调用堆栈（当出现错误时这不是很有帮助）并进入函数调用，我已经将错误跟踪到`retval = HeapFree(_crtheap, 0, pBlock);`in function `_free_base`, in file`free.c`而且似乎函数是从`dbgdel.cpp`函数调用的，`_free_dbg( pUserData, pHead->nBlockUse );`它是从`unlock()`函数调用的。

将调试器附加到已经活动的进程仍然会产生相同的错误。

我在这里链接了很多 3rd 方库，所以我会尝试不使用它们，因为我的想法已经用完了......

**编辑2：**

如果我将此异常传递给程序，它似乎运行良好。

**编辑 3**

评论 setUrl 行在某处引发了相同的异常`QWebKit`，其中`strdup`函数被调用...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T20:00:29.510

好吧，这很容易，但我花了两个月才解决（同时忽略了错误）。

这不是未处理的异常 - 这是已处理的异常，进入汇编代码并查看堆栈帧告诉我此异常已处理。

然后我记得我已经将调试器设置为在引发所有 C++ 和 Win32 异常时中断。重置调试器设置消除了该问题。

# delphi - 为什么这段代码只运行两次

> ID：14551642
> 
> 赞同：3
> 
> 时间：2013-01-27T20:04:58.447
> 
> 标签：delphi

我有这个代码只运行两次，变量 DateStart := 27-01-2013 DateStop := 31-03-2013

我认为它应该以 31-01-2013、28-02-2013 和 31-3-2013 的结果运行但我只得到 2 个结果

我很确定我一直盯着看，看不到问题

```
begin
  DateStart := EndOfTheMonth(DateStart);
  while DateStart <= DateStop do
    begin
      FsFutureCreate(DateStart, cxDebit.Value, cxKredit.Value, aAccount, aType, aStore, aCity, txtText.Text, lRecord);
      DateStart := EndOfTheMonth(IncMonth(DateStart));
    end;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:10:41.103

*要么* `FsFutureCreate`（你从未告诉我们它是什么）有一些副作用，*要么*你对浮点模糊有一些问题。如您所知，日期和时间值是双倍的，因此比较`<=`是危险的。（特别是如果您忽略时间部分，如下面的分析所示。）

第二种可能性更大。我刚试过

```
procedure TForm1.FormCreate(Sender: TObject);
var d: TDate; d2: TDate;
begin
  d := EncodeDate(2013, 01, 31);
  d := IncMonth(d);                          // 2013-02-28
  d := EndOfTheMonth(d);                     // 2013-02-28
  d := IncMonth(d);                          // 2013-03-28
  d := EndOfTheMonth(d);                     // 2013-03-31

  d2 := EncodeDate(2013, 03, 31);

  // d is now 2013-03-31 23:59:59
  // d2 is now 2013-03-31 00:00:00

  ShowMessage(BoolToStr(d <= d2, true));

end; 
```

并且得到了`false`，正如人们所期望的那样。因此，在这种情况下，问题在于该`EndOfTheMonth`函数还将时间设置为一天中的最后一秒（或毫秒）。但即使不是这种情况，在涉及浮点值时使用 = 进行比较也是危险的。

要修复您的比较，请执行

```
CompareDate(d, d2) <= 0 
```

代替

```
d <= d2. 
```

[我将其作为练习使用文档](http://docwiki.embarcadero.com/Libraries/XE3/en/System.DateUtils.CompareDate)来找出它为什么有效并且是强大的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:10:51.053

原因是`EndOfTheMonth`给你一个月的最后一天，也是对应于一天结束的时间。但你`DateStop`可能是一天的开始。

如果您在循环中打印出`DateStart`and的原始值，`DateStop`您会看到：

```
41333.9999999884 41364
41364.9999999884 41364 
```

因此，查看最后一行，您可以看到我们在第 41364 天的时间是 23:59。

我会通过使用纯日期而不是让时间妨碍事情来解决这个问题。更改递增代码以删除日期的时间部分。而且我也会明确地在循环测试中做同样的事情。

```
while DateOf(DateStart) <= DateOf(DateStop) do
begin
  ....
  DateStart := DateOf(EndOfTheMonth(IncMonth(DateStart)));
end; 
```

# iphone - 从 iPhone 应用程序在同一选项卡中打开 safari

> ID：14551644
> 
> 赞同：0
> 
> 时间：2013-01-27T20:05:16.580
> 
> 标签：iphone, ios, safari

我想从 iPhone 应用程序在 safari 中打开一个 url 链接，但我需要在同一个选项卡中打开 url 链接，而不是像 safari 那样在新选项卡中打开。

我使用以下代码打开 URL：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.google.com"]]; 
```

但是这段代码每次调用时都会在 safari 中打开一个新选项卡，有没有办法在 safari 的同一个选项卡中打开 url 链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T03:14:31.397

简短的回答：没有。

长答案：不幸的是，您无法调整 Safari 如何打开新页面，原因很简单。如果一个应用程序在 safari 中打开一个 URL，并想象用户想要保留它（因为他没有关闭它是有道理的），那么在选项卡上打开一个新的 url 将更有可能对 Apple 的用户不友好。

在 Safari 上打开相同选项卡的唯一方法是，如果打开了 8 个（最大数量）选项卡，那么即使已经打开，您的 url 也确实会在 safari 的第 8 个选项卡上打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T03:43:55.890

不，因为这会删除 iOS 设备所有者的最后一个链接。他们可能会失去联系。

> 在 Safari 上打开相同选项卡的唯一方法是，如果打开了 8 个（最大数量）选项卡，那么即使已经打开，您的 url 也确实会在 safari 的第 8 个选项卡上打开。

* * *

那里有免费的网络浏览器教程，如果你想要更多的控制，为什么不创建你自己的浏览器。 **创建移动浏览器应用教程：**

*   带有 web 视图的 2 部分教程[在这里](http://iosdeveloperzone.com/2011/05/21/tutorial-building-a-web-browser-with-uiwebview-part-1/)和[这里。](http://iosdeveloperzone.com/2011/05/22/tutorial-building-a-web-browser-with-uiwebview-part-2/)
*   带有搜索栏视频的互联网浏览器 @ [youtube.com/.....](http://www.youtube.com/watch?v=Vpq8r-HHwZA)

# php - APC 正在破坏输出

> ID：14551645
> 
> 赞同：5
> 
> 时间：2013-01-27T20:05:21.493
> 
> 标签：php, apc, output, corruption

我最近将我的 Web 服务器切换到 Centos 6.3，使用 apache 2.2.15、PHP 5.4.11 和 APC 3.1.14。

我开始不时收到客户的投诉，页面无法正常工作，或者出现奇怪的错误。我看到受影响的页面在输出的随机位置有问号和其他奇怪的符号，即使来源是好的。当我更改源文件中的一个字母时，页面开始正常工作。

我怀疑 APC，但我找不到任何线索何时以及为什么会发生这种情况。

我使用 mercurial 将更改推送到生产环境，但我多年来一直使用这种方法没有问题。也许配置中的某些东西现在是新的，但遗憾的是我没有保留我的旧配置。

下面是上次损坏的屏幕截图。

![来自损坏的 ajax 响应的屏幕截图](../Images/f634a9fd4b98a4e6369f6254e7a391a8.png)

编辑：这是我更改源中的单个字符、保存它，然后撤消文件后的响应（如果我只是重新启动 Web 服务器或清除 APC 操作码缓存）：

![修复后的截图](../Images/34d00eca00ca690aa71136f44e1a43f6.png)

注意行号不匹配，但它是 100% 相同的请求，所以响应也应该是相同的。第一个屏幕截图中的第 111 行根本不应该存在。似乎它来自另一个源文件......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T11:08:48.273

我已将[apc.stat_ctime](http://www.php.net/manual/en/apc.configuration.php#ini.apc.stat-ctime)更改为 1

> 使用 ctime 进行验证将通过确保自上次统计以来 inode 没有更改，从而避免由 svn 或 rsync 等程序引起的问题。APC 通常只会检查 mtime。

我会密切关注这个问题，因为它每周发生一次或两次，如果这解决了它，请在此处发布。

# java - 将 JPanel 转换为 JScrollPane 中的图像

> ID：14551646
> 
> 赞同：7
> 
> 时间：2013-01-27T20:05:26.607
> 
> 标签：java, image, swing, jpanel, jscrollpane

我想将 JPanel 转换为图像。我使用了以下方法：

```
public BufferedImage createImage(){

    int w = getWidth();
    int h = getHeight();
    BufferedImage bi = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
    Graphics2D g = bi.createGraphics();
    paint(g);
    return bi;
} 
```

但问题是 JPanel 包含在 JScrollPane 中。因此，当我将 jpanel 转换为图像时，图像仅包含 jpanel 中可见的部分，而隐藏在滚动窗格内的部分不包含在图像中。

是否有任何解决方案可以将 JPanel 的全部内容转换为图像？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-27T20:08:05.453

> 但问题是 JPanel 包含在 JScrollPane 中。因此，当我将 jpanel 转换为图像时，图像仅包含 jpanel 中可见的部分，而隐藏在滚动窗格内的部分不包含在图像中。

这不会发生在我身上......你试过`paintAll`代替`paint`吗？

这是一个很好的方法，可以捕获任何`Component`可见或不可见的内容（它不是我的，我从 SO 的某个地方得到它并从那以后使用它）：

```
public static BufferedImage componentToImage(Component component, boolean visible) {
    if (visible) {
        BufferedImage img = new BufferedImage(component.getWidth(), component.getHeight(), BufferedImage.TRANSLUCENT);
        Graphics2D g2d = (Graphics2D) img.getGraphics();
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        component.paintAll(g2d);
        return img;
    } else {
        component.setSize(component.getPreferredSize());
        layoutComponent(component);
        BufferedImage img = new BufferedImage(component.getWidth(), component.getHeight(), BufferedImage.TRANSLUCENT);
        CellRendererPane crp = new CellRendererPane();
        crp.add(component);
        crp.paintComponent(img.createGraphics(), component, crp, component.getBounds());
        return img;
    }
}

private static void layoutComponent(Component c) {
    synchronized (c.getTreeLock()) {
        c.doLayout();
        if (c instanceof Container) {
            for (Component child : ((Container) c).getComponents()) {
                layoutComponent(child);
            }
        }
    }
} 
```

这是一个展示上述内容的示例：

框架视图：

![在此处输入图像描述](../Images/036a520359aaae1fc52715d5e7fda395.png)

面板截图：

![在此处输入图像描述](../Images/8428e9c4339841ee6bd80978731f7813.png)

```
import java.awt.Component;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.CellRendererPane;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;

public class Test {

    public Test() {
        createAndShowGui();
    }

    private void createAndShowGui() {
        JFrame frame = new JFrame() {
            @Override
            public Dimension getPreferredSize() {//size frame purposefully smaller
                return new Dimension(100, 100);
            }
        };
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        Image img = null;
        try {
            img = ImageIO.read(new URL("http://images4.wikia.nocookie.net/__cb20120515073660/naruto/images/0/09/Naruto_newshot.png")).getScaledInstance(200, 200, Image.SCALE_SMOOTH);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        final ImagePanel imagePanel = new ImagePanel(200, 200, img);
        JScrollPane jsp = new JScrollPane(imagePanel);
        frame.add(jsp);

        frame.pack();
        frame.setVisible(true);
        BufferedImage bi = componentToImage(imagePanel, true);
        try {
            File outputfile = new File("c:/saved.png");
            ImageIO.write(bi, "png", outputfile);
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static BufferedImage componentToImage(Component component, boolean visible) {
        if (visible) {
            BufferedImage img = new BufferedImage(component.getWidth(), component.getHeight(), BufferedImage.TRANSLUCENT);
            Graphics2D g2d = (Graphics2D) img.getGraphics();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            component.paintAll(g2d);
            return img;
        } else {
            component.setSize(component.getPreferredSize());
            layoutComponent(component);
            BufferedImage img = new BufferedImage(component.getWidth(), component.getHeight(), BufferedImage.TRANSLUCENT);
            CellRendererPane crp = new CellRendererPane();
            crp.add(component);
            crp.paintComponent(img.createGraphics(), component, crp, component.getBounds());
            return img;
        }
    }

    private static void layoutComponent(Component c) {
        synchronized (c.getTreeLock()) {
            c.doLayout();
            if (c instanceof Container) {
                for (Component child : ((Container) c).getComponents()) {
                    layoutComponent(child);
                }
            }
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }
}

class ImagePanel extends JPanel {

    int width, height;
    Image bg;

    public ImagePanel(int width, int height, Image bg) {
        this.width = width;
        this.height = height;
        this.bg = bg;
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(width, height);
    }

    @Override
    protected void paintComponent(Graphics grphcs) {
        super.paintComponent(grphcs);
        grphcs.drawImage(bg, 0, 0, null);
    }
} 
```

**更新：**

根据您的评论：

> 我使用 ImageIO.write(bufferedImage, "jpg" , file); 将 BufferedImage 写入文件 这适用于 png 和 gif 图像，但 jpg 图像显示红色背景而不是白色。我该如何解决这个问题。谢谢

有关更多信息，请参阅[这个](https://stackoverflow.com/questions/4386446/problem-using-imageio-write-jpg-file)类似的问题/答案。你会做这样的事情：

```
private static final int[] RGB_MASKS = {0xFF0000, 0xFF00, 0xFF};
private static final ColorModel RGB_OPAQUE = new DirectColorModel(32, RGB_MASKS[0], RGB_MASKS[1], RGB_MASKS[2]);
...

BufferedImage image = componentToImage(imagePanel, true);
saveJPeg(image, "c:/saved.jpg");

private void saveJPeg(BufferedImage image, String name) {
    PixelGrabber pg = new PixelGrabber(image, 0, 0, -1, -1, true);
    try {
        pg.grabPixels();
    } catch (InterruptedException ex) {
        ex.printStackTrace();
    }
    int width = pg.getWidth(), height = pg.getHeight();

    DataBuffer buffer = new DataBufferInt((int[]) pg.getPixels(), pg.getWidth() * pg.getHeight());
    WritableRaster raster = Raster.createPackedRaster(buffer, width, height, width, RGB_MASKS, null);
    BufferedImage bi = new BufferedImage(RGB_OPAQUE, raster, false, null);

    try {
        ImageIO.write(bi, "jpg", new File(name));
    } catch (IOException ex) {
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T21:07:56.597

[SwingUtilities.paintComponent](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingUtilities.html#paintComponent%28java.awt.Graphics,%20java.awt.Component,%20java.awt.Container,%20java.awt.Rectangle%29)做到了：

```
static void drawComponent(JComponent c,
                          BufferedImage destination) {

    JFrame frame = new JFrame();

    Graphics g = destination.createGraphics();

    SwingUtilities.paintComponent(g, c, frame.getContentPane(),
        0, 0, destination.getWidth(), destination.getHeight());

    g.dispose();

    frame.dispose();
}

static BufferedImage createSnapshotOf(JComponent c) {

    Dimension size = c.getSize();
    if (size.width <= 0 || size.height <= 0) {
        size = c.getPreferredSize();
    }

    BufferedImage snapshot =
        new BufferedImage(size.width, size.height,
            BufferedImage.TYPE_INT_ARGB);

    drawComponent(c, snapshot);

    return snapshot;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-19T21:23:11.597

我不知道你为什么需要做这么复杂的事情。只要您的缓冲图像和绘画功能都使用 JScroolPane 中的组件（巨大），就应该保存整个内容。

```
 //create a tree data structure
    DefaultMutableTreeNode tree = new DefaultMutableTreeNode("root");
    //optional: you can make the tree really big

    //now show the tree
    JFrame frame = new JFrame("TreeDemo");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    //Create a Jtree component to display your data structure 
    JTree treeDisplay = new JTree(tree);

    //expand the tree all out
    for(int i = 0; i < treeDisplay.getRowCount(); i++) {
        treeDisplay.expandRow(i);
    }

    //put your tree display component in a scroll pane
    frame.add(new JScrollPane(treeDisplay));

    //Display the window.
    frame.pack();
    frame.setVisible(true);

    //save tree in the window to a file
    BufferedImage img = new BufferedImage(treeDisplay.getWidth(), treeDisplay.getHeight(), BufferedImage.TYPE_INT_RGB);
    Graphics2D graphics = img.createGraphics();
    //put graphics on the buffered image
    treeDisplay.paintAll(graphics);    
    graphics.dispose();

    try {
        ImageIO.write(img, "png", new File("tree.png"));
    }
    catch (IOException e) {
        e.printStackTrace();
    } 
```

# google-apps-script - 移除我的云端硬盘标签

> ID：14551648
> 
> 赞同：1
> 
> 时间：2013-01-27T20:05:32.263
> 
> 标签：google-apps-script, google-sheets, google-drive-api

创建新电子表格并使用`addToFolder()`“我的云端硬盘”标签后仍然存在。我们可以删除它吗？无法为 My Drive 根目录检索文件夹 ID 以用于`removeFromFolder()`.

如果没有，我知道我们从某个文件夹开始并使用：

```
var folder = DocsList.getFolderById(id);
folder.createFile(); 
```

...但是如何将创建的文件转换为电子表格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:28:00.540

“我的驱动器”文件夹是“根文件夹”，试试这样：

```
function removeFromRoot(){
folder=DocsList.getFolderById(id);
var file=DocsList.getFileById('fileID'); // or createFile...
file.addToFolder(folder);
file.removeFromFolder(DocsList.getRootFolder());
} 
```

至于您关于电子表格的其他问题，请查看[此帖子答案](https://stackoverflow.com/questions/13641760/create-a-google-spreadsheet-in-a-particular-folder/13643101#13643101)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-03T14:46:41.167

Serge insas 的答案是正确的，但 DocsList 现在未在 Drive 中使用。

这是我的更新版本：

```
function removeFromRoot() {
  var spreadSheet = SpreadsheetApp.getActive();
  var file = DriveApp.getFileById(spreadSheet.getId());

  // Remove from the root folder (files can be in multiple folders in Drive - folders are more like labels)
  // Note that "root" depends on who is logged in when running this! It is "their" drive which is the "root" folder (label)
  DriveApp.getRootFolder().removeFile(file);
} 
```

# json - 如何使用 JSON 而不是 CSV 执行这个 d3.js 魔术（分组条形图）？

> ID：14551653
> 
> 赞同：9
> 
> 时间：2013-01-27T20:06:08.500
> 
> 标签：json, csv, d3.js

我试图遵循这个例子：[http ://bl.ocks.org/3887051](http://bl.ocks.org/3887051)

但是，我有一个 JSON 对象，而不是 CSV。

现在，我看到我可以按照此处的说明将 JSON 转换为 CSV：[如何将 JSON 转换为 CSV 格式并存储在变量中](https://stackoverflow.com/questions/8847766/how-to-convert-json-to-csv-format-and-store-in-a-variable)

但这感觉就像一个黑客。

这是我的 JSON：

```
[{"YEAR":2012,"MONTH":1,"MMM":"JAN","Total_Flights":30,"Completed":21,"Canceled":7,"Aborted":2},
{"YEAR":2012,"MONTH":2,"MMM":"FEB","Total_Flights":54,"Completed":28,"Canceled":20,"Aborted":6},
{"YEAR":2012,"MONTH":3,"MMM":"MAR","Total_Flights":39,"Completed":25,"Canceled":12,"Aborted":2},
{"YEAR":2012,"MONTH":4,"MMM":"APR","Total_Flights":27,"Completed":21,"Canceled":6,"Aborted":0},
{"YEAR":2012,"MONTH":5,"MMM":"MAY","Total_Flights":35,"Completed":21,"Canceled":12,"Aborted":2},
{"YEAR":2012,"MONTH":6,"MMM":"JUN","Total_Flights":15,"Completed":10,"Canceled":4,"Aborted":1},
{"YEAR":2012,"MONTH":7,"MMM":"JUL","Total_Flights":42,"Completed":18,"Canceled":21,"Aborted":3},
{"YEAR":2012,"MONTH":8,"MMM":"AUG","Total_Flights":43,"Completed":29,"Canceled":8,"Aborted":6},
{"YEAR":2012,"MONTH":9,"MMM":"SEP","Total_Flights":28,"Completed":20,"Canceled":8,"Aborted":0},
{"YEAR":2012,"MONTH":10,"MMM":"OCT","Total_Flights":43,"Completed":24,"Canceled":18,"Aborted":1},
{"YEAR":2012,"MONTH":11,"MMM":"NOV","Total_Flights":35,"Completed":18,"Canceled":17,"Aborted":0},
{"YEAR":2012,"MONTH":12,"MMM":"DEC","Total_Flights":45,"Completed":9,"Canceled":32,"Aborted":4},
{"YEAR":2013,"MONTH":1,"MMM":"JAN","Total_Flights":49,"Completed":4,"Canceled":43,"Aborted":2}] 
```

我的游戏计划是让图表显示每个月的四个条形图：Total、Completed、Cancelled 和 Aborted。

我将如何转换此示例代码以处理我的 JSON？

我将在这里浏览 d3.js 教程：[https](https://github.com/mbostock/d3/wiki/Tutorials) ://github.com/mbostock/d3/wiki/Tutorials ，直到我弄明白或有人明智地向我展示了绳索。

我会定期用我的进展更新这篇文章。

更新#1：任何来这里的人都应该看看这些天赐的教程：[http ://alignedleft.com/tutorials/d3/](http://alignedleft.com/tutorials/d3/)

我还在努力。这么强大的图书馆。我会在几个小时内再次报告。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-29T10:20:46.883

在对 D3 的文档和我之前链接的优秀教程进行了几天的深入研究之后，我终于创建了我的第一个图表。

```
// Make a JSON object out of the data.d string receieved.
json_data = jQuery.parseJSON(data.d)

// width = 960 - 40 - 20 = 900
// height = 500 - 20 - 30 = 450
var margin = { top: 20, right: 20, bottom: 30, left: 40 },
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

//  Information on ordinal scales can be found at: https://github.com/mbostock/d3/wiki/Ordinal-Scales
//  An ordinal scale that sets the output range from the specified continuous interval (that is, [0, width]).
//  The array interval contains two elements representing the min and max numeric values.
//  This interval is subdivided into n evenly-spaced bands, where n is the number of (unique) values in the domain.
//  The bands may be offset from the edge of the interval and other bands according to the specifided padding, 
//      which defaults to zero.
//  The padding is typically in the range [0,1] (0.1 in this example) and corrseponds to the amount of space
//      in the range interval to allocate to padding.
//  A value of 0.5 means that the band width will be equal to the padding width.
var x0 = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

//  Constructs a new ordinal scale with an empty domain and an empty range.
//  The ordinal scale is invalid (always returning undefined) until an output range is specified).
var x1 = d3.scale.ordinal();

//  Information on linear scales can be found at: https://github.com/mbostock/d3/wiki/Quantitative-Scales
//  Quantitative scales have a continuous domain, such as the set of real numbers, or dates.
//  Linear scales are a type of quantitative scale.
//  Linear scales are the most common scale, and a good default choice to map a continuous input domain to a
//      continous output range.
//  The mapping is linear in that the output range value y can be expressed as a linear function of the
//      input domain value x: y = mx + b.
//  The input domain is typically a dimension of the data that you want to visualize, such as the height of
//      students (measured in meters) in a sample population.
//  The output range is typically a dimension of the desired output visualization, such as the height of bars
//      (measured in pixels) in a histogram.

//  This will set up our y height scale.
var y = d3.scale.linear()
    .range([height, 0]);

// Colors of the graph.
//
// First    : Total flights #097054 (green)
// Second   : Completed flights #6599FF (blue)
// Third    : Cancelled flights #FFDE00 (yellow)
// Fourth   : Aborted flights #FF9900 (orange)
var color = d3.scale.ordinal()
    .range(["#097054", "#6599FF", "#FFDE00", "#FF9900"]);

//  Set up the xAxis to use our x0 scale and be oriented on the bottom.
var xAxis = d3.svg.axis()
    .scale(x0)
    .orient("bottom");
    // We don't worry about tickFormat here, as the ticks will be determined by the data.

//  Set up the yAxis to use our y scale and be oriented on the left.
//      Additionally, set the tick format to display appropriate labels on the axis (taking out for now).
var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
//    .tickFormat(d3.format(".2s"));

// Set up the svg canvas with the width and height we calculated earlier.
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
// Move it to the right margin.left pixels, and move it down margin.top pixels

// Our JSON looks like:
//               [{ "YEAR": 2012, "MONTH": 1,  "MMM": "JAN", "Total": 36, "Completed": 21, "Canceled": 10,  "Aborted": 5 },
//                { "YEAR": 2012, "MONTH": 2,  "MMM": "FEB", "Total": 60, "Completed": 30, "Canceled": 21, "Aborted": 9 }]

//                data = d3.nest()
//                    .key(function (d) { return d.MMM + " " + d.YEAR; })
//                    .entries(json_data)
data = json_data

// seriesNames = "Total", "Completed", "Canceled" and "Aborted"               See, we're filtering out "YEAR", "MONTH" and "MMM"
var seriesNames = d3.keys(data[0]).filter(function (key) { return (key !== "YEAR") && (key !== "MONTH") && (key !== "MMM"); });
//                alert(JSON.stringify(seriesNames));
//                alert(seriesNames);

data.forEach(function (d) {
    d.Flights = seriesNames.map(function (name) { return { name: name, value: +d[name] }; });
    //alert("hi --- " + JSON.stringify(d.Flights));
});

//alert(JSON.stringify(data));

//x0.domain(data.map(function (d) { return d.State; }));
// Change State to be MMM, YEAR (for example: "Jan 2012") Could change this to Jan '12
x0.domain(data.map(function (d) { return d.MMM + " " + d.YEAR; }));
//alert(JSON.stringify(data.map(function (d) { return d.MMM + " " + d.YEAR; })));

//                //x1.domain(seriesNames).rangeRoundBands([0, x0.rangeBand()]);
x1.domain(seriesNames).rangeRoundBands([0, x0.rangeBand()]);

//                //y.domain([0, d3.max(data, function (d) { return d3.max(d.ages, function (d) { return d.value; }); })]);
//                // Make the y domain go from 0 up to the max of d.Total (Total flights)
//                y.domain([0, d3.max(data, function (d) { return d3.max(d.Total); })]);
y.domain([0, (10 + d3.max(data, function (d) { return d3.max(d.Flights, function (d) { return d.value; }); }))]);

// The axis business
svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

svg.append("g")
    .attr("class", "y axis")
    .call(yAxis)
.append("text")
    .attr("transform", "rotate(-90)")
    .attr("y", 6)
    .attr("dy", ".71em")
    .style("text-anchor", "end")
    .text("# of Flights");

// From this point to...

//var state = svg.selectAll(".state")
//    .data(data)
//.enter().append("g")
//    .attr("class", "g")
//    .attr("transform", function (d) { return "translate(" + x0(d.State) + ",0)"; });

var state = svg.selectAll(".state")
    .data(data)
.enter().append("g")
    .attr("class", "g")
    .attr("transform", function (d) { return "translate(" + x0(d.MMM + " " + d.YEAR) + ",0)"; });

//alert(JSON.stringify(d.Flights[0]));
state.selectAll("rect")
    .data(function (d) { return d.Flights; })
.enter().append("rect")
    .attr("width", x1.rangeBand())
    .attr("x", function (d) { return x1(d.name); })
    .attr("y", function (d) { return y(d.value); })
    .attr("height", function (d) { return height - y(d.value); })
    .style("fill", function (d) { return color(d.name); });

var legend = svg.selectAll(".legend")
    .data(seriesNames.slice().reverse())
.enter().append("g")
    .attr("class", "legend")
    .attr("transform", function (d, i) { return "translate(0," + i * 20 + ")"; });

legend.append("rect")
    .attr("x", width - 18)
    .attr("width", 18)
    .attr("height", 18)
    .style("fill", color);

legend.append("text")
    .attr("x", width - 24)
    .attr("y", 9)
    .attr("dy", ".35em")
    .style("text-anchor", "end")
    .text(function (d) { return d; })
    .on("click", function (d) {
        alert(d);
        //state.selectAll("rect")
        //.update()

        //                        .exit().transition()
        //                            .attr("height", 0)
        //                            .remove();

        //state.selectAll("rect")
        //.update()

        //state.selectAll("rect").exit().transition().attr("height", 0).remove();
    }); 
```

在这张图之后，很容易制作多个甜甜圈图以及堆叠图。

# python - 从文件名导入函数（按名称）

> ID：14551655
> 
> 赞同：0
> 
> 时间：2013-01-27T20:06:10.883
> 
> 标签：python, import, python-2.7, filenames

我正在编写一个使用该`trace`模块的代码跟踪器。为了使用跟踪模块，我首先需要能够调用相关函数。

我已成功导入包含函数定义的模块，方法`imp`如下：

```
mod = imp.load_source(os.path.basename(fpath).rpartition('.py')[0], fpath) 
```

`fpath`需要导入的模块的路径在哪里。

我不知道提前，我需要从什么函数/类导入`mod`。这是在一个变量中标识的（为了这个例子，`str`我们称之为）。`var`

例如，`fpath`可能是`'/Users/username/.../myPythonModule.py'`并且`var`可能是`'foo'`

我将如何`foo`从导入`mod`？
我在 python2.7 上，如果重要的话

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:10:20.493

如果您已将模块作为 object 导入`mod`，并且`var`是包含所需函数名称的字符串，则可以`getattr(mod, var)`从模块中获取该名称的函数（或类、值等）。

# android - Android TextureView 和硬件加速

> ID：14551656
> 
> 赞同：5
> 
> 时间：2013-01-27T20:06:17.017
> 
> 标签：android, hardware-acceleration

我正在尝试实现[此页面](http://developer.android.com/reference/android/view/TextureView.html)上显示的示例。我已经在运行 android 4 及更高版本的三种不同设备上进行了尝试，在所有情况下，我都会收到带有以下警告的黑屏：

```
01-27 20:01:22.683: W/TextureView(4728): A TextureView or a subclass can only be used with hardware acceleration enabled. 
```

我在应用程序清单中打开了硬件加速：

```
<application
    android:hardwareAccelerated="true"
    [etc...] 
```

但以下检查我的自定义视图的 onAttachedToWindow 方法总是返回 false

```
private class MyTextureView extends TextureView
{
    public MyTextureView(Context context) {
        super(context);
    }

    @Override
    protected void onAttachedToWindow()
    {
        super.onAttachedToWindow();
        Log.d("", Boolean.toString(mTextureView.isHardwareAccelerated()));          
    }
} 
```

有谁知道这里有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-25T06:50:09.533

如果您使用模拟器进行测试，请检查硬件加速配置。请查看此线程以获取更多信息：http: [//developer.android.com/tools/devices/emulator.html#acceleration](http://developer.android.com/tools/devices/emulator.html#acceleration)

# c# - Facebook 注销 Windows Phone 应用程序而不打开 WebBrowser

> ID：14551662
> 
> 赞同：4
> 
> 时间：2013-01-27T20:06:42.423
> 
> 标签：c#, facebook, windows-phone-7, facebook-c#-sdk, logout

我正在尝试使用 Facebook 登录和注销操作开发 Windows Phone 7 应用程序。我通过打开 WebBrowser 找到了 Facebook SDK 并使用它来执行登录。用户向此浏览器输入凭据并成功登录。此外，我设法在不使用任何 SDK 的情况下登录用户，只使用 http 请求，就像 SDK 实际所做的那样。但是，我想在不使用任何 WebBrowser 的情况下注销用户，而只需单击一个按钮。网络上有很多解决方案建议我打开网络浏览器并将其导航到某个 URL 以注销。然而，这不是我想要的。我认为应该有一种方法可以通过清除 cookie 来注销，我不知道该怎么做，或者你建议的任何其他方法。我的部分代码如下：

```
 private static String appID = "";
    private static String appSecret = "";

    public static void login(String[] permissions)
    {
        try
        {
            permissionArray = permissions;

            popup = new Popup();
            popup.Height = 480;
            popup.Width = 480;
            popup.VerticalOffset = 100;
            FacebookLoginUserControl control = new FacebookLoginUserControl();
            control.facebookWebBrowser.Loaded += new RoutedEventHandler(webBrowser_Loaded);
            control.facebookWebBrowser.Navigated += new EventHandler<System.Windows.Navigation.NavigationEventArgs>(webBrowser_Navigated);

            popup.Child = control;
            popup.IsOpen = true;
        }
        catch (Exception e)
        {
            //handle
        }
    }

    private static void webBrowser_Loaded(Object sender, RoutedEventArgs e)
    {
        WebBrowser wb = (WebBrowser)sender;
        String loginUrl = GetFacebookLoginUrl();
        wb.Navigate(new Uri(loginUrl));
    }

    private static String GetFacebookLoginUrl()
    {
        String permissionString = String.Empty;
        if (permissionArray.Length > 0)
            permissionString = String.Join(",", permissionArray);

        var uriParams = new Dictionary<string, string>() {
                    {"client_id", appID},
                    {"response_type", "token"},
                    {"scope", permissionString},
                    {"redirect_uri", "http://www.facebook.com/connect/login_success.html"},
                    {"display", "touch"}
                };
        StringBuilder urlBuilder = new StringBuilder();
        foreach (var current in uriParams)
        {
            if (urlBuilder.Length > 0)
            {
                urlBuilder.Append("&");
            }
            var encoded = HttpUtility.UrlEncode(current.Value);
            urlBuilder.AppendFormat("{0}={1}", current.Key, encoded);
        }
        var loginUrl = "http://www.facebook.com/dialog/oauth?" + urlBuilder.ToString();

        return loginUrl;
    }

    private static void webBrowser_Navigated(Object sender, System.Windows.Navigation.NavigationEventArgs e)
    {
        if (string.IsNullOrEmpty(e.Uri.Fragment)) return;
        if (e.Uri.AbsoluteUri.Replace(e.Uri.Fragment, "") == "http://www.facebook.com/connect/login_success.html")
        {
            string text = HttpUtility.HtmlDecode(e.Uri.Fragment).TrimStart('#');
            var pairs = text.Split('&');
            foreach (var pair in pairs)
            {
                var kvp = pair.Split('=');
                if (kvp.Length == 2)
                {
                    if (kvp[0] == "access_token")
                    {
                        accessToken = kvp[1];
                        MessageBox.Show("Access granted");
                        RequestUserProfile();
                    }
                }
            }
            if (string.IsNullOrEmpty(accessToken))
            {
                MessageBox.Show("Unable to authenticate");
            }
            popup.IsOpen = false;
        }
    }

    private static void RequestUserProfile()
    {
        var profileUrl = string.Format("https://graph.facebook.com/me?access_token={0}", HttpUtility.UrlEncode(accessToken));
        request = (HttpWebRequest)HttpWebRequest.Create(new Uri(profileUrl));
        request.Method = "GET";
        request.BeginGetResponse(result =>
        {
            try
            {
                var resp = (result.AsyncState as HttpWebRequest).EndGetResponse(result);
                using (var strm = resp.GetResponseStream())
                {
                    StreamReader sr = new StreamReader(strm);
                    var responseString = sr.ReadToEnd();

                }
            }
            catch (Exception ex)
            {
                //
            }
        }, request);
    } 
```

解决问题的任何想法。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T11:39:45.613

使用 webBrowser 到底有什么可怕的？如果您以编程方式创建 WebBrowser 对象，它将不可见，除非您将其添加到表单/页面的某个位置。如果您想清除 Facebook 的 cookie，解决方案将是这样的：

```
// Can be invoked from your button_click event
 public void TryLogout()
        {
            webBrowser = new WebBrowser();

            Uri uri = new Uri("http://m.facebook.com/home.php?r", UriKind.Absolute);
            webBrowser.LoadCompleted += new LoadCompletedEventHandler(webBrowser_TryLogoutLoadCompleted);
            webBrowser.Navigate(uri);
        } 
```

接着：

```
private void webBrowser_TryLogoutLoadCompleted(object sender, EventArgs e)
        {
            try
            {
                var cookies = webBrowser.GetCookies();

                foreach (Cookie cookie in cookies)
                {
                    if (cookie.Domain.Contains("m.facebook.com"))
                    {
                        cookie.Discard = true;
                        cookie.Expired = true;
                    }
                }
            // we've just cleaned up cookies

            }
            finally
            {
                webBrowser.LoadCompleted -= webBrowser_TryLogoutLoadCompleted;
            }
        } 
```

希望这可以帮助。

[GetCookies 方法](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.controls.webbrowserextensions.getcookies%28v=vs.105%29.aspx)

# php - PDO：作为单例连接 = 线程问题？

> ID：14551664
> 
> 赞同：1
> 
> 时间：2013-01-27T20:07:04.873
> 
> 标签：php, pdo, thread-safety

所以我终于开始重构我的 PHP 办公应用程序的基础：我添加了基于单例 PDO 类的新功能，我计划在整个应用程序中部署它。它非常简单且有效（目前），因为它应该：

```
class DB {

    protected static $instance;
    protected function __construct() {}
    public static function getInstance()
    {

        if( empty( self::$instance ) )
        {
            $dsn =  'pgsql:host=' . Config::$a .
                    ';dbname='    . Config::$b .
                    ';port='      . Config::$c .
                    ';connect_timeout=15';            
            $db_user = Config::$d;             
            $db_pass = Config::$e;

            try
            {
                self::$instance = new PDO( $dsn, $db_user, $db_pass );
                self::$instance->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
            }  
            catch( PDOException $e )
            {  
                new Log( 6, "DB Class failed to connect to dbase: $e" );
            }                          
        }
        return self::$instance;
    }
} 
```

今天下午我要告诉我的一个朋友，他是一个 .NET 程序员，关于这个单例 db-connection 类，他警告我使用单例连接到数据库会导致线程问题。

我必须说我已经想到了：几个用户将使用该应用程序，并且几乎所有功能都与（多个）数据库查询相关。两个用户同时执行一个查询并不是不可想象的。

PDO（或 PHP，或 Apache（在办公室），或 Nginx（在家测试环境））是否能够处理这个问题？也许为每个用户提供了一个新实例？也许我应该将此单例与将为每个查询/更新/插入/删除锁定数据库以避免线程问题的事务一起使用？或者也许我的朋友错了，我不必担心？

感谢任何见解！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T20:11:08.680

不要担心使用单例来建立连接。

每个 php 脚本请求都有自己的线程。我的意思是，如果同时发生两个请求，Web 服务器将在两个不同的线程中执行你的单例，所以你最终将有两个不同的对象处理数据库连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-25T04:22:58.917

[Josh Lockhart 在http://www.phptherightway.com/pages/Design-Patterns.html](http://www.phptherightway.com/pages/Design-Patterns.html)上恢复得很好

> 当我们需要确保**在 Web 应用程序的整个请求生命周期中**只有一个类的单个实例时，单例模式很有用。这通常发生在我们拥有全局对象（例如配置类）或共享资源（例如事件队列）时。

因此，如果您请求一个脚本，并且该脚本对 DB 进行多次访问（或调用另一个访问 DB 的脚本），则使用 Singleton 将具有优势。=) 很明显，最好通过请求（例如，通过使用存储过程）来阻止一次以上的访问。

# php - 如何在 Mcrypt 之外使用 Mcrypt 常量？

> ID：14551667
> 
> 赞同：0
> 
> 时间：2013-01-27T20:07:17.093
> 
> 标签：php, constants, mcrypt

如何在 Mcrypt 之外使用 Mcrypt 常量？

我需要调用一个函数，例如：`$s->encrypt(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);`但这些常量仅在我将它们直接调用到像`mcrypt_module_open(MCRYPT_RIJNDAEL_256, '', MCRYPT_MODE_CBC, '')`; 这样的 Mcrypt 函数中时才有效。

我怎样才能调用这些常量？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:28:22.530

实际上，这些只是字符串：

```
MCRYPT_RIJNDAEL_256: "rijndael-256"
MCRYPT_MODE_CBC: "cbc" 
```

尝试使用您的函数传递这些字符串。

# java - Java：交错两个基于整数的数组列表-> 好方法？

> ID：14551670
> 
> 赞同：0
> 
> 时间：2013-01-27T20:07:30.803
> 
> 标签：java, arraylist, iterator

**作业：寻找更好的策略或方法而不是完整的代码。**

在两种情况下，我有两个整数数组列表：

1.  第一个列表大于第二个
2.  第二个列表大于第一个

我的目标是在两种情况下将 list2 的元素交错到 list1 中。我已经创建了一个方法来做到这一点，但我觉得我可以做得更好。

这是条件 1 的预期结果。请注意，在 list2 的元素用尽后，我们将 list1 的元素留在原处：

```
list1: [10, 20, 30, 40, 50, 60, 70]
list2: [4, 5, 6, 7]
Combined: [10, 4, 20, 5, 30, 6, 40, 7, 50, 60, 70] 
```

这是条件 2 的预期结果。由于 list2 有更多元素，我们在 list1 用完后将这些元素附加到 list1：

```
list1: [10, 20, 30, 40]
list2: [4, 5, 6, 7, 8, 9, 10, 11]
Combined: [10, 4, 20, 5, 30, 6, 40, 7, 8, 9, 10, 11] 
```

我的代码使用 if-else 语句来处理这两个条件。然后我使用迭代器遍历 list2 的元素并将它们插入到 list1 中。

```
public static void main(String[] Args)
{
    ArrayList<Integer> numbers = new ArrayList<Integer>();
    numbers.add(10);
    numbers.add(20);
    numbers.add(30);
    numbers.add(40);
    //numbers.add(50);
    //numbers.add(60);
    //numbers.add(70);

    ArrayList<Integer> numbers2 = new ArrayList<Integer>();

    numbers2.add(4);
    numbers2.add(5);
    numbers2.add(6);
    numbers2.add(7);
    numbers2.add(8);
    numbers2.add(9);
    numbers2.add(10);
    numbers2.add(11);

    System.out.println("list1: " + numbers);
    System.out.println("list2: " + numbers2);

    interleave(numbers, numbers2);

    System.out.println();
    System.out.println("Combined: " + numbers);
}

public static void interleave(ArrayList<Integer> list1, ArrayList<Integer> list2)
{
    //obtain an iterator for the collection
    Iterator<Integer> itr2 = list2.iterator();

    //loop counter
    int count = 1;

    //handle based on initial size of lists
    if(list1.size() >= list2.size())
    {
       //loop through the first array and add elements from list 2 after each element
       while(itr2.hasNext())
       {
           //insert elements from list2
           list1.add(count, itr2.next());

           //make sure elements are getting added at 1, 3, 5, 7, 9, etc
           count = count + 2;
       }
    }
    else if(list1.size() < list2.size())
    {
       //loop through the first array and add elements from list 2 after each element
       while(itr2.hasNext())
       {
           if(count <= list1.size())
           {
               //insert elements from list2
               list1.add(count, itr2.next());

               //make sure elements are getting added at 1, 3, 5, 7, 9, etc
               count = count + 2;
           }
           else
           {
               //fill in the remainder of the elements from list2 to list1
               list1.add(itr2.next());
           }
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T20:18:42.663

你喜欢这个解决方案吗？

```
public static void main(final String[] args) {
    ArrayList<Integer> numbers = new ArrayList<Integer>();
    numbers.add(10); numbers.add(20); numbers.add(30); numbers.add(40);
    //numbers.add(50); numbers.add(60); numbers.add(70);

    ArrayList<Integer> numbers2 = new ArrayList<Integer>();
    numbers2.add(4); numbers2.add(5); numbers2.add(6); numbers2.add(7);
    numbers2.add(8); numbers2.add(9); numbers2.add(10); numbers2.add(11);

    System.out.println("list1: " + numbers);
    System.out.println("list2: " + numbers2);
    List<Integer> interleaved = interleave(numbers, numbers2);

    System.out.println("\nCombined: " + interleaved);
}

public static List<Integer> interleave(
    final List<Integer> list1,
    final List<Integer> list2
) {
    List<Integer> result
        = new ArrayList<Integer>(list1.size() + list2.size());

    Iterator<Integer> it1 = list1.iterator();
    Iterator<Integer> it2 = list2.iterator();
    while (it1.hasNext() || it2.hasNext()) {
        if (it1.hasNext()) {
            result.add(it1.next());
        }
        if (it2.hasNext()) {
            result.add(it2.next());
        }
    }
    return result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:13:22.690

几点评论：

*   我可能会返回一个新列表，而不是任意修改其中一个
*   新算法则更简单：
    *   创建一个新的空列表
    *   在计数器上循环从 0 到两个列表大小的最小值并交错
    *   完成后，检查其中一个列表是否有更多项目并添加它们（例如使用`addAll`and的组合`subList`）
    *   返回列表
*   如果您不需要改变两个原始列表，您可以用更短的方式声明它们：`List<Integer> numbers = Arrays.asList(10, 20, 30, 40);`- 请注意，它会创建一个固定大小的列表，因此您无法添加或删除
*   使用您当前的代码，您可以使用以下代码，而不是复制内容：`List listSmall, listBig; if (list1.size() < list2.size()) { listSmall = list1; listBig = list2; } else { /* the opposite */}`- 然后您知道那`listSmall`是小代码，您只需要一个循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T20:39:34.373

这是考虑这个问题的另一种方式，也是一种可以轻松扩展到 3 个列表的方式。

首先，要认识到这里要解决的困难部分是迭代，而不是创建新列表。从一个可迭代对象创建一个新列表是微不足道的。

所以想象我们有一个这样的方法：

```
public <T> Iterable<T> interleave(Iterable<? extends T>... lists) {
    return new Iterable<T>() {
       @Override
       public Iterator<T> iterator() {
           return new InterleavingIterator<T>(lists);
       }
    };
} 
```

我们需要做的是一次`Iterator<T>`循环遍历每个迭代器。这是队列 (fifo) 的完美工作！您的迭代器可能如下所示：

```
class InterleavingIterator<T> implements Iterator<T> {

    private final Queue<Iterator<? extends T>> iterators = new LinkedList<>();

    public InterleavingIterator(Iterable<? extends T>> iteratables) {
        for ( Iterable<T> iterable : iterables ) {
           Iterator<T> iterator = iterable.iterator();
           if ( iterator.hasNext() ) {
              this.iterators.add(iterator);
           }
        }
    }

    public boolean hasNext() {
        return !iterators.isEmpty();
    }

    public T next() {
        Iterator<T> nextIterator = iterators.poll();
        T result = nextIterator.next();
        if ( nextIterator.hasNext() ) {
           iterators.add(nextIterator);
        }
        return result;
    }
} 
```

简而言之，每次请求下一个元素时，都会弹出队列顶部的迭代器，`next()`返回结果，如果迭代器还有元素（`hasNext()`），则将其放到队列的后面。

这对于任何数量的列表都完全相同，并且不需要任何 icky 条件检查。

要使用它创建一个新列表，您可以这样做：

```
List<Integer> combined = new ArrayList<Integer>(interleave(list1, list2)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-24T22:53:35.553

我建议以下代码：

```
private static List<Integer> joinTwoLists(List<Integer> a, List<Integer> b) {
    final boolean aIsBigger = a.size() > b.size();
    final List<Integer> joined = new ArrayList<>(aIsBigger ? a : b);
    final AtomicInteger index = new AtomicInteger(1);
    for (Integer value : aIsBigger ? b : a) {
        joined.add(index.getAndAdd(2), value);
    }
    return joined;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-21T19:45:56.890

这是我的方法。

```
public static void interleave(ArrayList<Integer> a1, ArrayList<Integer> a2) {
    int start = 0;
    int i;
    int size = a1.size();
    for (i = 1; i < a1.size(); i += 2) {
        if (start < a2.size()) {
            a1.add(i, a2.get(start++));
        }
    }
    while (a1.size() < (size + a2.size())) {
        a1.add(i++, a2.get(start++));
    }

} 
```

# session - ZF2中如何实现认证

> ID：14551671
> 
> 赞同：3
> 
> 时间：2013-01-27T20:07:31.337
> 
> 标签：session, authentication, zend-framework2

网上有几个关于如何在 Zend Framework 2 中编写实现身份验证的插件的示例，但没有关于如何在应用程序中使用它们的明确信息。有没有人有一个实现简单登录屏幕的工作（完整）ZF2 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:25:20.247

看一下这个：

[http://blog.evan.pro/getting-started-with-the-zf2-skeleton-and-zfcuser](http://blog.evan.pro/getting-started-with-the-zf2-skeleton-and-zfcuser)

这是一个很好的例子，说明如何让标准框架应用程序与 zfcUser 模块一起工作以提供您所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T14:11:55.283

我认为这会有所帮助：

[http ://samsonasik.wordpress.com/2012/10/23/zend-framework-2-create-login-authentication-using-authenticationservice-with-rememberme/](http://samsonasik.wordpress.com/2012/10/23/zend-framework-2-create-login-authentication-using-authenticationservice-with-rememberme/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-13T20:59:28.177

[http://framework.zend.com/manual/2.0/en/modules/zend.authentication.intro.html](http://framework.zend.com/manual/2.0/en/modules/zend.authentication.intro.html)

从那开始......当我开始时，我和你在同一条船上航行......我没有使用 zfcuser，因为我认为在我仅有的少量时间内使用它很复杂。但这是最好的方法。

检查 zfc 用户的 wiki 页面。

但是您可以使用 zf2 身份验证做一些非常简单的事情，而不是为它编写自己的模块。

# windows-8 - 如何使用 javascript 在 Windows 8 中将动态文本添加到动态磁贴

> ID：14551674
> 
> 赞同：1
> 
> 时间：2013-01-27T20:07:45.603
> 
> 标签：windows-8, windows-store-apps, winjs

好吧，这个话题说明了一切。我正在使用 html/css/javascript 进行 Windows 8 应用程序开发，我很难找到有关如何动态操作动态磁贴的信息。有很多关于如何创建多个 tile xml 文件并依次启动它们的信息，但是如果有人有很好的资源，或者更好的是第一手解释，关于如何以编程方式创建这些 tile，比如说，制作倒计时瓷砖，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:55:26.867

无法以编程方式直接实时更新动态磁贴上的文本/图像。

唯一可用的 API 是 Windows.UI.Notifications 命名空间中的 API，如[发送磁贴更新快速入门](http://msdn.microsoft.com/en-us/library/windows/apps/hh465439.aspx)中所示。

您可以使用通知队列（如此[处所示](http://msdn.microsoft.com/en-us/library/windows/apps/hh465429.aspx)）来提供将自动循环的多个更新，或者您可以使用外部服务（例如[Windows Azure 移动服务](http://www.windowsazure.com/en-us/develop/mobile/resources/#header-3)）发送磁贴更新。使用来自外部服务的推送通知可能会让您最接近您正在寻找的行为，因为它不会依赖应用程序处于活动状态来更新磁贴。但是请注意，应用程序需要至少运行一次才能创建外部服务更新磁贴所需的通道 URI。

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

# c# - 可以在浏览器的对话框窗口上模拟点击事件吗？

> ID：14551676
> 
> 赞同：2
> 
> 时间：2013-01-27T20:07:52.077
> 
> 标签：c#, javascript, .net

我知道 dialog(showMessage) 是一个封闭的 API，并且您不能使用任何基于 Web 的技术（例如 jQuery 或 Javascript）在 Dialog 上强制单击事件。浏览器中的窗口实例是单线程的，并且会锁定线程，直到对话框接收到事件。这个我明白。

我想要做的是为了测试用例的目的而务实地模拟点击事件。我正在使用 Telerik 测试框架在 C# .NET 4.5 环境中运行这些测试用例。

那么是否可以模拟这个点击事件呢？它正在测试我们的一个按钮的行为，当单击该按钮时，用户必须确认他们将离开页面而不保存更改。

提前感谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T17:15:20.090

我不熟悉 Telerik 的测试工具，但据我所知，“发出”这种点击的唯一方法是使用 ui 宏自动移动鼠标并实际点击特定位置的屏幕。

也就是说，您可以通过使用模拟方法来解决您的问题。而不是直接调用window.prompt，而是按照以下方式定义自己的提示函数：

```
debug = true; //remove or set to false when not testing

var myPrompt = function(){
  if(debug){
    return "Greetings, Program";
  } else {
    return prompt("Please enter your greeting:","Greeting");
  }
} 
```

你可以自然地为其他类型的消息框设置它，只要你记住它们返回的类型。

# c# - 动态添加按钮 - 必须放在表单标签内

> ID：14551683
> 
> 赞同：-1
> 
> 时间：2013-01-27T20:09:07.357
> 
> 标签：c#, asp.net

我正在使用 C# 动态创建一个按钮。但是当它被执行时我得到一个错误；

```
Control 'butidd' of type 'Button' must be placed inside a form tag with runat=server. 
```

编码

```
 Button but = new Button();
                but.ID = "butidd";
                but.Attributes.Add("runat", "server");
                but.Text = "test";
                but.Click += new EventHandler(but_click);
                this.Controls.Add(but); 
```

点击事件：

```
void but_click(object sender, EventArgs e){} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:13:14.677

正如错误明确指出的那样，您需要在`<form runat="server">`;内的某处添加控件 不是直接在页面中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:28:16.957

如果您想动态添加控件...最好在表单设计视图中创建一个面板并将控件动态添加到该面板...

如果您在设计视图上创建一个面板，那么它位于表单标签下......这是最简单的......它避免了这种类型的混淆和错误......

尝试此链接以供参考... [http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx](http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx)

# c - 在 IAR 中将常规指针转换为 FLASH 指针

> ID：14551688
> 
> 赞同：0
> 
> 时间：2013-01-27T20:09:50.013
> 
> 标签：c, embedded, iar

IAR 定义了 __flash 关键字来指定一个指针在使用时指向 FLASH 空间，如

```
uint8_t __flash *dataPtr; 
```

我正在尝试通过常规指针将地址传递给函数，并使用 FLASH 指针指向 FLASH 中的该地址。由于可移植性原因（跨其他架构），我被限制使用常规指针传入，所以我不能只更改我的函数定义。似乎找不到任何方法来“抛弃” __flash 修饰符。我买了一张去 IAR 的票，但我真的很想在这个周末结束这件事。

有人有想法么？

# java - 从 java 调用 tesseract 函数

> ID：14551689
> 
> 赞同：0
> 
> 时间：2013-01-27T20:09:51.817
> 
> 标签：java, jna, tesseract

我刚刚下载了 libtesseract302，并且喜欢通过 JNA 使用它从 java 应用程序中导出的一些函数。我的测试应用程序已成功加载该库，但未找到这些函数。我的简单 tesseract api 接口如下所示： {{{ public interface TessAPI extends Library {

```
 public static final TessAPI INSTANCE = (TessAPI) Native.loadLibrary("libtesseract302", TessAPI.class);

    int Init(String datapath, String language);

    public static class TessBaseAPI extends PointerType {

        public TessBaseAPI(Pointer address) {
            super(address);
        }

        public TessBaseAPI() {
            super();
        }
    };
} 
```

}}}

当我尝试使用此代码时，出现此异常：

```
 java.lang.UnsatisfiedLinkError: Error looking up function 'Init': A megadott eljárás nem található.

at com.sun.jna.Function.<init>(Function.java:179)
at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:350)
at com.sun.jna.NativeLibrary.getFunction(NativeLibrary.java:330)
at com.sun.jna.Library$Handler.invoke(Library.java:203)
at $Proxy5.Init(Unknown Source)
at net.docca.backend.ocr.TesseractApplication.run(TesseractApplication.java:53)
at net.docca.backend.ocr.TesseractApplicationTest.testRun(TesseractApplicationTest.java:103)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
at org.testng.internal.Invoker.invokeMethod(Invoker.java:714)
at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)
at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)
at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:128)
at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
at org.testng.TestRunner.privateRun(TestRunner.java:767)
at org.testng.TestRunner.run(TestRunner.java:617)
at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
at org.testng.SuiteRunner.run(SuiteRunner.java:240)
at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
at org.testng.TestNG.runSuitesSequentially(TestNG.java:1203)
at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)
at org.testng.TestNG.run(TestNG.java:1036)
at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175) 
```

我认为这是因为 dll 中导出的函数有奇怪的名称，例如：?Init@TessBaseAPI@tesseract@@QEAAHPEBD0@Z

我的问题是：我应该如何在上面的代码中调用我的方法，以便将它们映射到正确的 dll 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T00:06:54.487

看看[Tess4J](http://tess4j.sf.net)，它也使用 JNA 调用 Tesseract API。

# clojure - 有没有好的 ClojureScript 工作流程？

> ID：14551693
> 
> 赞同：24
> 
> 时间：2013-01-27T20:10:37.497
> 
> 标签：clojure, workflow, read-eval-print-loop, clojurescript

我正在尝试将 ClojureScript 用于项目。要成为一名快乐的开发人员，我需要一个快速的反馈循环：编写一些代码并尽快查看。我也很想在当前页面的上下文中使用 REPL。

我正在使用`lein-cljsbuild`并且从我遇到的问题中我认为我未能正确设置它。

首先，小文件的编译时间太大，即使在“JWM预热”之后`:optimizations :simple`：

```
Compiling "resources/public/js/cljs.js" from ["src-cljs"]...
Successfully compiled "resources/public/js/cljs.js" in 8.233018 seconds.
Compiling "resources/public/js/cljs.js" from ["src-cljs"]...
Successfully compiled "resources/public/js/cljs.js" in 5.522989 seconds.
Compiling "resources/public/js/cljs.js" from ["src-cljs"]...
Successfully compiled "resources/public/js/cljs.js" in 8.144354 seconds. 
```

其次，有时我会得到这样的东西：

```
Compiling "resources/public/js/cljs.js" from ["src-cljs"]...
Compiling "resources/public/js/cljs.js" failed.
Exception in thread "main" java.lang.NullPointerException
at java.util.regex.Matcher.getTextLength(Matcher.java:1140)
at java.util.regex.Matcher.reset(Matcher.java:291)
at java.util.regex.Matcher.<init>(Matcher.java:211)
at java.util.regex.Pattern.matcher(Pattern.java:888)
at clj_stacktrace.utils$re_gsub.invoke(utils.clj:6)

# ... many similar useless lines

at clojure.lang.Var.applyTo(Var.java:532)
at clojure.main.main(main.java:37) 
```

这些堆栈跟踪（大部分时间与语法错误有关，正如我从实验中了解到的那样），比没有帮助更糟糕：它们不仅提供有关错误的零线索，而且还会停止自动重新编译。在每次这样的堆栈跟踪之后，我应该做这些事情：

*   找出问题所在，使用我称之为“假装你是解析器”的技术。感谢上帝，这是 Lisp，我唯一应该做的就是仔细计算匹配的括号。
*   按下运行`Cmd-C`的外壳`lein cljsbuild auto`
*   `lein cljsbuild auto`再次运行
*   进行一些无用的更改，例如在文件中插入换行符以触发新构建
*   等待约 30 秒，直到文件再次编译，因为 JVM 必须再次“预热”
*   在许多情况下，此时我会得到另一个堆栈跟踪，在得到它之后我必须起泡、冲洗并重复所有该死的过程

我不明白的第三件事是 REPL。从互联网上，我学会了如何连接`rlwrap lein trampoline cljsbuild repl-listen`到当前页面。然而，控制台中的每一次重新加载、导航和语法错误（上帝保佑你忘记使用`rlwrap`并按下箭头键）都会使 REPL 完全卡住。我必须重新启动它（约 10 秒），然后重新加载页面，然后在友好的环境中重新开始尝试。

我想，可能有人已经想通了，并且有一个有效的工作流程。请帮助我从一开始就进行设置，因为我觉得自己是一个失败的软件工程师。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T23:06:19.690

对我来说， [Catnip](https://github.com/bodil/catnip)目前为 ClojureScript 提供了最好的开发体验。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-22T23:16:06.433

看看[无花果](https://github.com/bhauman/lein-figwheel)！这就像类固醇上的重载。
使用 clojurescript 和前端开发从未如此有趣！
[自己看看](https://www.youtube.com/watch?v=KZjFVdU8VLI)（演示有点过时了——现在更好了！）
它不仅会在文件更改时重新加载页面——它还为您提供[Bret Victor 所说的](https://vimeo.com/36579366)交互式编程（如果您没有，我建议您观看该演讲） t)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-16T10:25:11.263

我已经在 Emacs 中尝试过这个工具[https://github.com/cemerick/austin](https://github.com/cemerick/austin)并且效果很好，正如您在他的演示和截屏视频中看到的那样。

有一个良好的发展娟

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-13T17:35:13.460

在开发模式下将**:optimizations**转为**:none**时，它​​会产生巨大的差异，它不会改变初始编译时间，但任何额外的更改通常只需要几毫秒。

我的 project.clj 中有以下内容

```
 :cljsbuild {:builds [{;; Directories of interest:
                        :source-paths ["src"]
                        ;; Compiler flags:
                        :compiler {;; Where to save the file:
                                   :output-to "resources/public/js/app.js"
                                   ;; Where to put the output directory
                                   :output-dir "resources/public/js/out"
                                   ;; Optimizations:
                                   :optimizations :none
                                   }}]} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-25T16:40:44.580

> 小文件的编译时间太大

试试`:optimizations :whitespace`。并使用`lein cljsbuild auto`

> 其次，我时不时会收到这样的东西：......

我以前没有遇到过这个问题。它看起来像 cljsbuild 中的一个错误。尝试更改另一个版本。我正在`[lein-cljsbuild "1.0.2"]`使用`[org.clojure/clojurescript "0.0-2156"]`. 在我的`1.0.3`设置中不起作用。

> 我不明白的第三件事是 REPL

在您的情况下，关键是要找到一种**无需重新启动 REPL 或重新加载页面即可重新**加载名称空间的方法。

我觉得`load-file`这对我有好处。

我的工作流程是：

1.  首先启动 REPL：`rlwrap lein trampoline cljsbuild repl-listen`
2.  确保`(repl/connect "http://localhost:9000/repl")`在我的代码中有。
3.  在浏览器中打开我的页面。
4.  做一些测试`(my-namespace/my-func a b c)`
5.  编辑我的代码。
6.  在我的 REPL 中，运行`(load-file "path-to-my-file.cljs")`
7.  **重复`4`**

这仍然是一个非常烦人的工作流程。`load-file`缓慢而脆弱，所以有时我会浏览器进行测试。我希望有人可以提供更好的答案。

# c# - Windows 8 计算机无法迭代工作组成员？

> ID：14551706
> 
> 赞同：3
> 
> 时间：2013-01-27T20:11:44.167
> 
> 标签：c#, windows-8, active-directory, network-programming

我从 Windows 8 (x64) 系统获取工作组中的计算机列表时遇到问题。

在我的工作组中有几台计算机：一些使用 W7，一些使用 W8。W7 计算机能够获得所有工作组 PC 的列表，而 W8 计算机不能（没有结果，甚至运行代码的 PC 也不能）使用相同的代码。

```
using (DirectoryEntry workgroup = new DirectoryEntry("WinNT://Workgroup"))
    {
        foreach (DirectoryEntry childEntry in workgroup.Children)
        {
            Console.WriteLine(childEntry.Name);
        }
    } 
```

我正在尝试这里给出的解决方案： [在工作组中获取计算机](https://stackoverflow.com/questions/5178364/get-computers-in-a-workgroup)

有人对此有任何想法吗？

更新：为此，Visual Studio 以管理员身份运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:13:17.137

以管理员身份运行 Visual Studio 或其生成的可执行文件。

如果情况是您已经以管理员身份运行 VS/exe，请确保 W8 机器位于名为“WORKGROUP”的同一工作组中，并且它们不是 Windows RT（ARM 上的 Windows）操作系统，因为它们不支持工作组。

# java - 在 SWING 中表示车辆

> ID：14551710
> 
> 赞同：0
> 
> 时间：2013-01-27T20:12:06.047
> 
> 标签：java, swing, animation, jpanel

就目前而言，我有一张地图，上面有道路，车辆可以从南到北，从东到西（以及相反的方向）来回行驶。到目前为止，我使用 JPanel 来表示车辆。但是现在它变得有点难以处理，因为我想在路口转弯和平滑换道等。

因此，JPanel 似乎不是最佳选择。到目前为止，我尝试的是使用`Shape`界面来绘制多边形并将它们用作车辆，但是我不确定这是不是正确的选择。

我最终会想要构建自己的车辆图像，因此解决方案必须能够将图像添加为背景或类似的东西，并且仍然能够执行诸如旋转、变换等操作。

对此的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:01:46.643

就个人而言，使用`JPanel`并不是一个糟糕的选择，您需要做的是扩展它的功能，以允许您在车辆转弯时绘制车辆方向的变化。

这将需要一些动画 - 您将想知道车辆完成转弯需要多长时间，以便您可以计算车辆随时间的角度。

为此，我将使用`AffineTransformation`，请[在此处](http://www.javalobby.org/java/forums/t19387.html)查看一些示例。

您还需要在车辆转动时更改组件的大小，请[在此处](https://stackoverflow.com/questions/4156518/rotate-an-image-in-java)查看答案。

车道变化将是一个类似（如果更容易）的概念。基本思想是有一个翻译的开始位置和结束位置，并随着时间的推移移动到那个位置。同样，您需要知道完成翻译所需的时间。

# java - 从 linux 目录结构创建树

> ID：14551719
> 
> 赞同：0
> 
> 时间：2013-01-27T20:12:49.663
> 
> 标签：java

我需要从 linux 目录结构创建一棵树。例如：

```
. 0
./file1.txt 1
./file2.txt 2
./site 3
./site/file3.txt 4
./site/ru 5
./site/ru/file4.txt 6 
```

每个节点都是一个目录或文件（如果它没有子节点）并且具有 ID(>=0)。根 ID 为 0。父 ID 始终低于子 ID。我创建了 2 个类：

```
class Node<T1, T2> {
    T1 key;
    T2 value;

    List<Node<T1, T2>> children;

    Node(T1 key, T2 value) {
        this.key = key;
        this.value = value;
        children = new ArrayList<Node<T1, T2>>();
    }

    public boolean isFile()
    {
        return children.size() == 0;
    }
} 
```

和

```
public class DirectoryTree<T1 extends Comparable<T1>, T2> 
{
   private Node<T1, T2> root = null;

   public DirectoryTree(T1 key, T2 value)
   {
       root = new Node<T1, T2>(key, value);
   }
} 
```

我怎样才能填满树？

# java - 从 POST 保存拆分上传的文件最终为空

> ID：14551723
> 
> 赞同：0
> 
> 时间：2013-01-27T20:13:15.160
> 
> 标签：java, http, servlets, file-upload, http-post

我正在尝试用 Java 完全实现可恢复的文件上传系统。我正在使用的库是 resumable.js，它发送文件块以另存为`.part`，然后在最后将它们合并在一起。当我收到`POST`请求时，我会在我的`doPost`方法中接受请求，将其保存到 a`HttpServletRequestWrapper`中，然后使用它来获取我需要的所有数据。但是，当`.part`我保存文件时，最终它们是空的并且大小为 0 字节。

我检查过，似乎数据都在那里，但我似乎无法保存数据。有什么我实施不正确的吗？

这是我用来执行此任务的一小段代码：

```
public void doPost(HttpServletRequest request, HttpServletResponse response) {
    try {
        HttpServletRequestWrapper wrapReq = new HttpServletRequestWrapper(request);
        BufferedReader reader = wrapReq.getReader();
        /**
        * Get some data from the BufferedReader
        */
        if(ServletFileUpload.isMultipartContent(wrapReq)){
            File mkd = new File(temp_dir);
            if(!mkd.isDirectory())
                mkd.mkdirs();

            DiskFileItemFactory factory = new DiskFileItemFactory();
            ServletFileUpload upload = new ServletFileUpload(factory);
            Iterator<FileItem> iter = upload.parseRequest(request).iterator();
            OutputStream out;

            out = new FileOutputStream(new File(dest_dir));
            while(iter.hasNext()){
                try {

                    FileItem item = iter.next();
                    IOUtils.copy(item.getInputStream(), out);                       
                    logger.debug("Wrote file " + resumableIdentifier + " with chunk number "
                            + resumableChunkNumber + " to " + temp_dir);
                    out.close();
                } catch (FileNotFoundException fnfe) {
                    fnfe.printStackTrace();
                }
            }
        }
        tryCreateFileFromChunks(temp_dir, resumableFileName, resumableChunkSize, resumableTotalSize);

    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

该`tryCreateFileFromChunks()`方法只是检查所有部分是否都存在并合并它们。这不是问题。`.part`文件本身存储为空。

那么，我是否以错误的方式处理了这个问题？我一直在努力让它正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:31:55.063

你不应该使用`HttpServletRequestWrapper`，也不应该调用它`getReader()`。请求正文只能读取一次，您必须选择是否在同一请求上使用`getReader()`方法、**方法或****方法** `getInputStream()`，而不是混合使用它们。 **`getParameterXxx()`**

 **Apache Commons FileUpload 在内部使用`getInputStream()`来解析请求正文。但是，如果您已经调用`getReader()`或`getParameterXxx()`事先调用过，那么 Apache Commons FileUpload 将获得一个空的请求正文。

总而言之，要解决您的问题，请完全摆脱`wrapReq`。

```
if(ServletFileUpload.isMultipartContent(request)){
    // ... 
```

### 也可以看看：

*   [如何使用 JSP/Servlet 将文件上传到服务器？](https://stackoverflow.com/questions/2422468/how-to-upload-files-to-server-using-jsp-servlet/2424824#2424824)**

# cordova - Dojo build(ed) 在 Android 2.2 浏览器上不起作用

> ID：14551732
> 
> 赞同：1
> 
> 时间：2013-01-27T20:14:13.017
> 
> 标签：cordova, dojo

我正在使用 dojo 1.8 测试 webapp 的模块。它使用了许多模块。当我使用未构建的版本时，一切都像魅力一样工作，但速度很慢。当我对使用[http://build.dojotoolkit.org/](http://build.dojotoolkit.org/)构建的版本执行相同操作时，出现错误：

```
01-27 17:12:49.744: E/browser(10771): Console: Error: scriptError 
http://blog.arthurmolina.com/dojotest/lib/dojo.js:15 
```

此问题仅出现在 Android 2.2 浏览器版本上。好吧，我刚刚在它和 4.0 版以及我的 iPhone 上进行了测试。在桌面浏览器上没有问题。

我还看到，如果我去掉这些行：

```
"dojox/mobile/ValuePickerDatePicker",
"dojox/mobile/ValuePickerTimePicker", 
```

它不再显示该错误...

我可以在没有构建版本的情况下使用它，但我想包装在 Phonegap 中，如果我不这样做，它就不起作用。

您可以在[http://blog.arthurmolina.com/dojotest/中找到应用测试](http://blog.arthurmolina.com/dojotest/)

那么该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T16:16:57.213

我不确定，但我怀疑您可能遇到了 Android 不接受以下划线开头的资源的问题。您提到的两个模块与 _TimePickerMixin 有依赖关系，这可能会产生问题。该问题将通过构建包含 _TimePickerMixin 的应用程序来解决，以消除对下划线文件的需求。请参阅：[https](https://dojotoolkit.org/reference-guide/1.9/dojox/mobile/faq.html#id3) ://dojotoolkit.org/reference-guide/1.9/dojox/mobile/faq.html#id3 （您所做的构建可能出于某种原因忽略了该文件？）

# jquery - 用jquery改变和改变图像

> ID：14551734
> 
> 赞同：0
> 
> 时间：2013-01-27T20:14:17.010
> 
> 标签：jquery, image

我找到了一种在单击图像时更改图像的方法...但是我正在寻找循环，这意味着再次单击并取回旧图像，然后再次单击以获取新图像（仅需要 2 张图像）。

```
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$("#ChangeImage").click(function(){
$('#ChangeImage').attr('src','image2.jpg');
});
});
</script>
<img src="image1.jpg" name="my_pic" id="ChangeImage"> 
```

我找不到反之亦然的方法……感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:15:34.547

您可以将一个函数传递给`attr`，该函数将传入当前的`src`. 在更改之前检查：

```
$("#ChangeImage").click(function () {
    $(this).attr('src', function (index, currentSource) {
        return currentSource == 'image2.jpg' ? 'image1.jpg' : 'image2.jpg';
    });
}); 
```

这是小提琴：http: [//jsfiddle.net/3yZNT/](http://jsfiddle.net/3yZNT/)

* * *

如果您使用的是更现代的 jQuery 版本（1.6+），则应[`prop`](http://api.jquery.com/prop/)使用[`attr`](http://api.jquery.com/attr/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:20:34.050

这是另一种方法

```
$("#ChangeImage").click(function() {
    $(this).find('img').toggle();
});​

<div id="ChangeImage"><img src="image1.png"/>
<img src="image2.png" style="display:none"/>
</div> 
```

# ruby-on-rails - 将 accept_nested_attributes_for 与 group_by 一起使用

> ID：14551736
> 
> 赞同：1
> 
> 时间：2013-01-27T20:14:23.297
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我正在尝试在我的模型中使用 accept_nested_attributes_for 方法，但是我需要呈现由另一个关联分组的记录。我已经得到了这个工作，但我使用的方法似乎有点像黑客。

有没有更好的方法来构建它？

我的模特

```
 has_many :quantities
  has_many :ingredients, :through => :quantities, :uniq => true
  has_many :sizes, :through => :quantities, :uniq => true
  has_many :photos, :as => :imageable

  accepts_nested_attributes_for :quantities 
```

我的观点

```
<%= form_for [:admin, @recipe] do |f| %>

    <div class="field">
      <%= f.label :name %><br />
      <%= f.text_field :name %>
    </div>

    <% @recipe.quantities.group_by(&:size).each do |size, quantities| %>
        <h3><%= size.name %></h3>
        <%= f.fields_for :quantities do |builder| %>
            <% if builder.object.size == size %>
          <p>
            <%= builder.text_area :value, :rows => 1 %>
          </p>
          <% end %>
      <% end %>
  <% end %>

    <div class="actions">
        <%= f.submit %>
    </div>

<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T21:02:01.693

你可以摆脱这个`if builder.object.size == size`部分：

```
<% @recipe.quantities.group_by(&:size).each do |size, quantities_for_size| %>
  <h3><%= size.name %></h3>
  <%= f.fields_for :quantities, quantities_for_size do |builder| %>
    <p><%= builder.text_area :value, :rows => 1 %></p>
  <% end %>
<% end %> 
```

将 the`quantities_for_size`作为第二个参数传递给`fields_for`应该使它使用它而不是`quantities`与配方关联的整体。有关更多信息，[请参阅 #fields_for 上的文档。](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)

# c++ - 使用 g++ 的 Glibc 问题

> ID：14551739
> 
> 赞同：0
> 
> 时间：2013-01-27T20:14:47.387
> 
> 标签：c++, linux, g++, glibc

我有一个问题，我正在 Linux 机器上编译我的 C++ 应用程序。然后我将可执行文件移动到其他机器，但我有一个错误：

```
./server: /lib64/libc.so.6: version `GLIBC_2.7' not found (required by ./server) 
```

我该如何解决？无需在发生此错误的第二台机器上重新编译（这是我的客户端机器）

编译命令：

```
g++  -o server  test.cpp server.cpp ... -lboost_system -lboost_thread -std=c++0x 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:22:41.930

您的应用程序正在使用 glibc-2.7 库，并且应用程序在其他机器上找不到它。它可能有这个库的旧版本。您有以下选择：

*   在目标主机上升级此库
*   将您的应用与旧的库版本相关联
*   使用静态链接
*   将库与应用程序一起发送

* * *

如何静态链接到一个库：

```
gcc main.c mylibrary.a -o main 
```

请注意，大多数发行版默认不安装静态库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:22:55.510

有三种选择：

1.  在给定编译器的原始机器上`-static`编译，它将在您的二进制文件中包含相关库[并可能给您一两个关于“这可能无法正常工作”的警告]
2.  在新机器上编译代码。
3.  在目标机器上安装正确版本的库。

大多数时候我倾向于使用选项 1，但在不同的点上都使用了这三个选项。

# smalltalk - 延长吱吱声或 pharo

> ID：14551741
> 
> 赞同：3
> 
> 时间：2013-01-27T20:14:52.877
> 
> 标签：smalltalk, pharo, squeak, package-management

使用 Monticello 包管理器似乎并不能保证，一旦您添加了有趣的包，整个图像仍然是连贯的。有什么方法可以验证吗？是否验证了依赖关系？有没有这方面的指导方针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:37:06.283

我认为您正在寻找*Metacello*，它是 Monticello 的包和配置管理器。

您可以查看本指南：[使用 Metacello 管理项目，](https://gforge.inria.fr/frs/download.php/28462/Metacello.pdf)还有一个关于[Google 代码的页面](http://code.google.com/p/metacello/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T10:47:16.977

虽然蒙蒂塞洛实际上有可能确保满足依赖关系，但它仅限于“这个蒙蒂塞洛版本完全依赖于这些其他蒙蒂塞洛版本”的形式。此外，指定这些依赖项在 Monticello 浏览器中有点隐藏，最重要的是，在社区中很少使用。

正如 Uko 所说，[Metacello](https://code.google.com/p/metacello/)正是为了解决 Smalltalk 系统中的依赖管理问题。从概念上讲，它*不仅*限于蒙蒂塞洛。据我所知，大多数 GemStone、Pharo 和 Squeak 图像都预装了 Metacello 或易于安装。

请查看[Metacello 的作者](http://gemstonesoup.wordpress.com/metacello-101/)Dale Henrichs 的博客，其中他介绍了如何使用 Metacello。

还有[Metacello 存储库](http://www.squeaksource.com/MetacelloRepository/)，可以在其中找到大多数配置（想想软件收据）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T10:50:47.797

Monticello 的职责以加载单个包为结束。Coherence 带有 Metacello（参见 Uko[的回答](https://stackoverflow.com/a/14551974/10259)）或[SqueakMap](http://map.squeak.org)。

SqueakMap 存储安装脚本，以确保将[整个](http://map.squeak.org/package/00e786be-3742-4976-be5b-ddfb6b51aeda) [应用程序](http://map.squeak.org/package/e02a34a1-aefc-4b39-9c30-eb25bbdaccd4)加载到您的图像中。

# gwt - GWT - 相对于屏幕宽度设置面板高度？

> ID：14551743
> 
> 赞同：0
> 
> 时间：2013-01-27T20:15:03.330
> 
> 标签：gwt, height, width

我正在尝试创建一个 layoutPanel，跨越用户屏幕的宽度，其中将包含 4 个图像。无论屏幕高度如何，这些图像都应与其宽度成比例缩放。如：

```
Landscape:
+----+----+----+----+
| i1 | i2 | i3 | i4 |
|    |    |    |    |
+----+----+----+----+
|                   |
+-------------------+

Portrait:
+--+--+--+--+
|i1|i2|i3|i4|
+--+--+--+--+
|           |
|           |
|           |
+-----------+ 
```

我试图通过设置一个面板等于屏幕的宽度来做到这一点。这似乎工作正常。但是当我尝试设置相对于宽度的高度时，高度始终保持为零。

我通过eclipse插件使用GWT。我试图在任何给定时间使用一些换行符来获取变量，但我似乎无法让换行符做任何事情（运行为...，调试为...，在编译期间）。但是，无法进行调试是一个单独的问题。

下面是我正在使用的代码。如果有人能看到我做错了什么，请告诉我。非常感谢！

```
public void onModuleLoad() {
    int layout_panel_width;
    int layout_panel_height;
    RootLayoutPanel rootLayoutPanel = RootLayoutPanel.get();
    rootLayoutPanel.setSize("100%", "100%");

    LayoutPanel layoutPanel = new LayoutPanel();
    rootLayoutPanel.add(layoutPanel);
    rootLayoutPanel.setWidgetLeftWidth(layoutPanel, 0.0, Unit.PCT, 100.0, Unit.PCT);
    layout_panel_width = layoutPanel.getOffsetWidth();
    layout_panel_height = layout_panel_width * 70 / 128;
    rootLayoutPanel.setWidgetTopHeight(layoutPanel, 0.0, Unit.PCT, layout_panel_height, Unit.PX);

    LayoutPanel lp1 = new LayoutPanel();
    layoutPanel.add(lp1);
    layoutPanel.setWidgetLeftWidth(lp1, 0.0, Unit.PCT, 25.0, Unit.PCT);
    layoutPanel.setWidgetTopHeight(lp1, 0.0, Unit.PCT, layout_panel_height, Unit.PX);
    Image i1 = new Image("images/single_test_sprite.png");
    lp1.add(i1);
    lp1.setWidgetLeftWidth(i1, 0.0, Unit.PCT, 100.0, Unit.PCT);
    lp1.setWidgetTopHeight(i1, 0.0, Unit.PCT, 100.0, Unit.PCT);

    LayoutPanel lp2 = new LayoutPanel();
    layoutPanel.add(lp2);
    layoutPanel.setWidgetLeftWidth(lp2, 25.0, Unit.PCT, 25.0, Unit.PCT);
    layoutPanel.setWidgetTopHeight(lp2, 0.0, Unit.PCT, layout_panel_height, Unit.PX);
    Image i2 = new Image("images/single_test_sprite.png");
    lp2.add(i2);
    lp2.setWidgetLeftWidth(i2, 0.0, Unit.PCT, 100.0, Unit.PCT);
    lp2.setWidgetTopHeight(i2, 0.0, Unit.PCT, 100.0, Unit.PCT);

    LayoutPanel lp3 = new LayoutPanel();
    layoutPanel.add(lp3);
    layoutPanel.setWidgetLeftWidth(lp3, 50.0, Unit.PCT, 25.0, Unit.PCT);
    layoutPanel.setWidgetTopHeight(lp3, 0.0, Unit.PCT, layout_panel_height, Unit.PX);
    Image i3 = new Image("images/single_test_sprite.png");
    lp3.add(i3);
    lp3.setWidgetLeftWidth(i3, 0.0, Unit.PCT, 100.0, Unit.PCT);
    lp3.setWidgetTopHeight(i3, 0.0, Unit.PCT, 100.0, Unit.PCT);

    LayoutPanel lp4 = new LayoutPanel();
    layoutPanel.add(lp4);
    layoutPanel.setWidgetLeftWidth(lp4, 75.0, Unit.PCT, 25.0, Unit.PCT);
    layoutPanel.setWidgetTopHeight(lp4, 0.0, Unit.PCT, layout_panel_height, Unit.PX);
    Image i4 = new Image("images/single_test_sprite.png");
    lp4.add(i4);
    lp4.setWidgetLeftWidth(i4, 0.0, Unit.PCT, 100.0, Unit.PCT);
    lp4.setWidgetTopHeight(i4, 0.0, Unit.PCT, 100.0, Unit.PCT);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:38:15.440

这就是你需要的：

```
public void onModuleLoad() {
    RootLayoutPanel rootLayoutPanel = RootLayoutPanel.get();

    FlowPanel flowPanel = new FlowPanel();
    flowPanel.addStyleName("my_images_panel");
    rootLayoutPanel.add(flowPanel);

    Image i1 = new Image("images/single_test_sprite.png");
    Image i2 = new Image("images/single_test_sprite.png");
    Image i3 = new Image("images/single_test_sprite.png");
    Image i4 = new Image("images/single_test_sprite.png");

    flowPanel.add(i1);
    flowPanel.add(i2);
    flowPanel.add(i3);
    flowPanel.add(i4);
} 
```

然后，在您的 CSS 文件中：

```
.my_images_panel img {
    float: left;
    width: 25%;
} 
```

* * *

**原始代码的问题**（取自答案评论）：

在浏览器完成渲染之前，每个小部件的宽度和高度都为零。您需要使用Scheduler等到渲染完成，然后您可以使用`getOffsetHeight()`和`getOffsetWidth()`

# android - 为什么 AsyncTask 偶尔出现？

> ID：14551749
> 
> 赞同：0
> 
> 时间：2013-01-27T20:15:27.367
> 
> 标签：android, multithreading, parsing, android-asynctask, nullpointerexception

我有一个异步任务，我在 ocCreate 方法期间使用它来解析 JSON 和 XML 数据。问题是异步任务每十次只完成一次它的“后台执行”工作。当它无法完成其后台工作时，应用程序由于未在后台进程中实例化并在执行后引用的变量而崩溃。这很奇怪，因为当 AsyncTask 完成它的后台工作时，一切正常。任何帮助是极大的赞赏

我的代码

```
 private class LoadingData extends AsyncTask<String, Integer, String> {

    @Override
    protected String doInBackground(String... sUrl) {

            //TWITTER
            //Parses Twitter XML with no problem...

publishProgress(15,1);

//SPOT GOLD AND SILVER

                try{
                    GoldSpotPriceReader.feed = "http://feed43.com/437361835043234.xml";//Gold
                    GoldSpotPriceReader.getLatestRssFeed();
                    livespotgold=GoldSpotPriceReader.spotprice;
                    storedspotgold=livespotgold;

                    SilverSpotPriceReader.feed = "http://feed43.com/824383110654537.xml";//Silver
                    SilverSpotPriceReader.getLatestRssFeed();
                    livespotsilver=SilverSpotPriceReader.spotprice;
                    storedspotsilver=livespotsilver;
                }catch(NumberFormatException e){    
                    Log.e("Spot Price Initial", "Spot Price Format Error "+e.toString());
                } 
//AsyncTask Usually Ends Here For No Particular Reason.
    //And doesn't finish background work...                 
publishProgress(30,2);

//More background work...           

 @Override
    protected void onPreExecute() {
        super.onPreExecute();
        dialog = new ProgressDialog (MyActivity.this);
        dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        //dialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        dialog.setMessage("Fetching Latest News");          
        dialog.setIndeterminate(false);
        dialog.setMax(100);
        dialog.setProgress(0);
        dialog.show();

        finddealer = (MapView) findViewById(R.id.mvFindDealer);
        finddealer.setBuiltInZoomControls(true);

        Touchy tango = new Touchy();
        overlayList = finddealer.getOverlays();
        overlayList.add(tango);
        compass = new MyLocationOverlay(MyActivity.this, finddealer);
        overlayList.add(compass);
        controller = finddealer.getController();
        controller.setZoom(11);

        lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        lm.requestLocationUpdates(lm.GPS_PROVIDER, 300000, 5000, MyActivity.this);
        crit = new Criteria();
        towers = lm.getBestProvider(crit, false);
        location = lm.getLastKnownLocation(lm.GPS_PROVIDER);

        delta = getResources().getDrawable(R.drawable.map_pin_48);
        zulu = getResources().getDrawable(R.drawable.ic_launcher);
    }

@Override
    protected void onProgressUpdate(Integer... progress) {
        super.onProgressUpdate(progress);
        dialog.setProgress(progress[0]);
        switch (progress[1])
        {
            case 1:
                dialog.setMessage("Acquiring  Prices...");
                break;
            case 2:
                dialog.setMessage("Acquiring  Rates...");
                break;
            case 3:
                dialog.setMessage("Acquiring More Rates...");
                break;
            case 4:
                dialog.setMessage("Pinpointing Your Location...");
                break;
            case 5:
                dialog.setMessage("Locating Nearest  Dealers...");
                break;
            case 6:
                dialog.setMessage("Calculating Shortest Routes...");
                break;
            case 7:
                dialog.setMessage("Mapping  Dealers...");
                break;
            case 8:
                dialog.setMessage("Finalizing...");
                break;
        }
    }               

  @Override     
    protected void onPostExecute(String result) {       
        super.onPostExecute(result);
        dialog.setProgress(100);
        dialog.setMessage("Load Complete.");
        dialog.dismiss();

 //Other UIthread variables...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T04:59:35.413

我的 AsyncTask 之前也遇到过类似的情况。问题是我正在捕获一个异常并试图在没有处理程序和可运行的情况下抛出一个吐司。因此，请确保您不要尝试在后台执行过程中对 UIThread 执行任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:53:27.820

我相信您的问题出在您的`.getLatestRssFeed()`方法上，因为这些是您的网络连接功能。我看不到您的代码，但我假设您可能正在其中生成一个新线程来访问提要，但您`AsyncTask`继续并尝试将值分配给`liveSpotSilver`and `Gold`，但是它们尚未设置。你需要先解决这个问题，然后看看你是否还有问题。

即使这不是问题，10 次中有 9 次，`AsyncTask`如果遇到网络错误并且挂起，则不会完成，**网络连接是问题**。如果您在`SilverSpotPriceReader`and中生成新线程`Gold...`，则不需要这样做，因为您已经在异步完成工作。您可以通过捕获其他人建议的抛出的异常来更好地调试。

# actionscript-3 - Flash 中具有当前日期的组合框

> ID：14551750
> 
> 赞同：0
> 
> 时间：2013-01-27T20:15:30.870
> 
> 标签：actionscript-3, flash, date

好的，我需要在带有 as3 的 Flash CS4 中完成一件相当复杂的事情。我浏览了网络，但找不到太多有用的信息。

基本上我有 3 个组合框，一个用于 UTC 日期，另一个用于 UTC 月份，另一个用于 UTC 年。我需要这样做，以便组合框将显示设置日期（我最初在 Flash 脚本中设置的日期）和当前 UTC 日期之间的日期。例如，如果我将设置日期设置为 2013 年 2 月 1 日，而当前日期是 3 月 4 日，我希望用户只能在“月份”组合框中选择 2 月和 3 月。如果他们选择 2 月，那么“日期”组合框中的可用日期应该是 1 - 28，但如果选择了 3 月，那么应该只有 1 - 4 可用。这应该能够每天自动更新，因此例如在 3 月 5 日，应添加数字 5，因此如果选择了 3 月，则“日期”组合框中应该有 1 - 5 可用，依此类推......

老实说，我不知道该怎么做，但我真的需要以一种或另一种方式完成。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:09:40.517

当您选择一个新月份时，您的两个边界日期会相应更新，然后此功能可以帮助您生成介于两者之间的日期

```
 private function test():void
    {
        var date1:Date = new Date(2012, 11, 25);
        var date2:Date = new Date();
        generateDateBetween(date1, date2);
    }

    private function generateDateBetween(date1:Date, date2:Date):void
    {
        for (var i:Number = date1.time; i < date2.time; i+= 3600*24*1000)
        {
            var date:Date = new Date();
            date.time = i;
            trace(date);
        }
    } 
```

# python - 从本地目录安装（和访问）Python 模块

> ID：14551753
> 
> 赞同：0
> 
> 时间：2013-01-27T20:15:39.917
> 
> 标签：python, installation, portability

我正在尝试制作一个`Python`可以从各种不同计算机上的 USB 驱动器运行的应用程序。让我们假设*客户端计算机安装了 Python*并将其放在一边。

我的应用程序用于`cherrypy` *启动*a `local web server`，但可以安全地假设它尚未安装在运行它的计算机上。

尽可能透明地解决这个问题的最佳方法是什么？

它应该可供非技术用户使用，他们不必担心自己安装任何依赖项。

目前，我已将 的副本`cherrypy source`与我的应用程序打包在一起，如果程序检测到它尚未安装，它会运行`setup.py`但与`--user flag`，避免任何权限问题。

这似乎不是很好的做法。

是否可以只在我的应用程序中包含构建的包？我尝试过使用以下方法来执行此操作：

> /myapp/libs/cherrypy

我`cherrypy`从`CherryPy archive`. 这是预构建，因此可能无法正常工作。我还尝试了另一种运行方式`setup.py`（它创建了一个构建目录）并复制了这些文件。

> /myapp/somefile.py

```
import myapp.libs.cherrypy as cherrypy 
```

从理论上讲，这应该有效......但它没有。当我尝试运行服务器（使用`cherrpy.quickstart()`）时，它会运行两个服务器实例，这显然会导致问题。

所以，问题是：首先，我是不是完全走错了路？如何使第三方包可用于我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:25:23.413

这是由于 PYTHONPATH 问题。在处理从外部导入或获取的包时，我建议使用虚拟环境和 pip 作为标准。

这里有一些很棒的笔记：[https ://python-guide.readthedocs.org/en/latest/](https://python-guide.readthedocs.org/en/latest/)

如果您想导入自己的代码。我会将您的 PYTHONPATH（在 dev_folder 下面的情况下）设置为根开发目录并遵循此结构...

```
dev_folder \
- project_name \
    - main_script.py
    - helper.py
    - libary1 \
        - __init__.py
        - lib1.py
    - libary2 \
        - __init__.py
        - lib2.py 
```

您显然会为库文件夹/包想出更好的名称:-)

希望这可以帮助。

# java - TextView 中部分左对齐和部分右对齐的文本。为什么这不起作用？

> ID：14551759
> 
> 赞同：1
> 
> 时间：2013-01-27T20:16:12.177
> 
> 标签：java, android, android-widget

我在文本视图中遇到问题，其中我有一些应该左对齐的文本和一些应该右对齐的文本。

这是我的尝试。

```
String LeftText = "LEFT";
String RightText = "RIGHT";

String resultText = LeftText + "  " + RightText;
SpannableString styledResultText = new SpannableString(resultText);
styledResultText.setSpan(new AlignmentSpan.Standard(Alignment.ALIGN_OPPOSITE), LeftText.length() + 1, LeftText.length() + 2 + RightText.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
textView.setText(styledResultText); 
```

这是textview的xml。

```
<TextView
    android:id="@+id/titleBar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge" 
/> 
```

但是，这是行不通的。所有文本都左对齐。我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-09T17:21:35.443

如果不需要对边缘右对齐，您可以使用 TabStopSpan 很容易地解决问题。

```
final TextView tv = ...
int column = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,
                (float) 200.0, getResources().getDisplayMetrics());

SpannableStringBuilder textspan = new SpannableStringBuilder("Charges\nPrice\t$25.00\nShipping\t$155.08\nTax\t$5.11\n");
textspan.setSpan(new TabStopSpan.Standard(column), 0, textspan.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
tv.setText(textspan); 
```

如果您希望它移动到靠近文本视图的右边缘，您可以使用全局布局侦听器在布局后设置制表位。然后您可以使用 textview 的宽度在边缘附近设置一个制表位。

如果您希望它正确对齐，您只需要创建一个扩展 ReplacementSpan 的类，它将为您证明文本的合理性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:59:00.713

我自己也走上了这条路……不幸的是，根据我的研究，我认为单行文本不可能有两个对齐跨度。您必须将其拆分为两个不同的`TextView`对象。

# gwt - GWT中遇到内存泄漏的可能原因有哪些

> ID：14551763
> 
> 赞同：2
> 
> 时间：2013-01-27T20:16:30.973
> 
> 标签：gwt

任何人都可以解释在开发模式和实时模式下使用 GWT 时发生内存泄漏的可能方法吗？

我参考以下问题

[如何解决 GWT 中的内存泄漏？](https://stackoverflow.com/questions/8970353/how-to-resolve-a-memory-leak-in-gwt)

如在答案之一中找到以下链接..

[https://developers.google.com/web-toolkit/articles/dom_events_memory_leaks_and_you](https://developers.google.com/web-toolkit/articles/dom_events_memory_leaks_and_you)

它们主要处理 Widget 创建和浏览器事件。是否有任何其他可能的块孔发生内存泄漏，例如在执行 RPC 时 .. 使用很多渲染方法 ..etc 等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:59:43.203

您列出的链接讨论了 GWT 如何避免浏览器众所周知的内存泄漏类型 - 任何地方都没有引用 dom 元素或小部件的情况，但浏览器仍然不会将其从内存中释放。您需要注意的唯一情况是当您创建自己的包含其他小部件的小部件时 - 在这种情况下，您需要小心调用每个孩子的附加和分离方法。坚持使用已知良好的容器和面板将完全避免您这样做，并且永远不会直接调用附加或分离方法。

除此之外，内存泄漏就像所有其他类型的开发一样 - 我们需要小心保留您不再使用的东西的引用。我不同意链接问题中的一些答案——Java 内存泄漏工具不能很好地帮助通过开发模式跟踪这些对象，因为它们考虑的是 JVM 和 Java 对象，而不是浏览器和 JavaScript。

相反，将样式设置为 PRETTY 进行编译，并使用 Chrome 的 Inspector 之类的工具。这可以用来查看正在消耗内存的对象，并判断是什么在占用它们。该策略与任何其他堆分析工具（JProfiler、VisualVM 等）相同。并且适用于编写代码的标准规则 - 如果您持有一个不需要的对象，请将其清空或从持有它的集合中删除它。显然，如果您仍然需要它，请保留它-相反，更高的东西应该放手*它*。

# xaml - XAML ListView - 更改所选项目的图像源

> ID：14551766
> 
> 赞同：1
> 
> 时间：2013-01-27T20:17:04.903
> 
> 标签：xaml, listview, windows-8, windows-runtime

我正在使用带有自定义模板的 ListView，如下所示：

```
<ListView.ItemTemplate>
    <DataTemplate>
        <Grid HorizontalAlignment="Center" Width="220" Height="220">
            <Image x:Name="image" Stretch="UniformToFill" 
                    Source="{Binding Brand.Image, 
                             ConverterParameter=transparent, 
                             Converter={StaticResource LogoToUriConverter}}"/>
            <StackPanel VerticalAlignment="Bottom">
                <TextBlock Text="{Binding Name}" 
                            Foreground="{StaticResource ApplicationColor}" 
                            Style="{StaticResource TitleTextStyle}" 
                            Height="30" Margin="15,0,15,0"/>
                <TextBlock Text="{Binding Name}" 
                            Foreground="{StaticResource ApplicationColor}" 
                            Style="{StaticResource CaptionTextStyle}" 
                            TextWrapping="NoWrap" Margin="15,0,15,10"/>
            </StackPanel>
        </Grid>
    </DataTemplate>
</ListView.ItemTemplate> 
```

现在，选择项目时，我希望将所选项目更改为新的图像源。

Brand.Image 不是 DependencyProperty，因为它来自外部 DataObject。

所以，我认为在 WPF 中我可以使用触发器手动更改它。

但是因为在 winRT 中它不再起作用了，所以我研究了 VSM，但我不知道如何才能做到这一点。

有人可以给我一个真实的例子吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:16:49.677

我能够以一种棘手的方式解决这个问题，但我得到了它的工作：

1.  使用 ExtendedVisualStateManager，（通过 ExpressionBlend dll 可用于 .NET，但不适用于 WinRT，所以我从这里得到它：http: [//nroute.codeplex.com/SourceControl/changeset/69480#nRoute5/nRoute.Framework.Metro /Components/ExtendedVisualStateManager.cs](http://nroute.codeplex.com/SourceControl/changeset/69480#nRoute5/nRoute.Framework.Metro/Components/ExtendedVisualStateManager.cs) )

2.  有了它，我只需捕获一个 OnSelected 事件并使用新的 VisualStateManager 来执行此操作：

    ExtendedVisualStateManager.GoToElementState(sender as Grid, "Selected2", true);

这是 ItemTemplate 的完整 XAML：

```
<DataTemplate>
<Grid x:Name="ItemGrid" HorizontalAlignment="Center" Width="220" Height="220" PointerPressed="GridItemTapped">
    <Image x:Name="image" Stretch="UniformToFill" Source="{Binding Brand.Name, ConverterParameter=white, Converter={StaticResource LogoToUriConverter}}"/>
    <Image x:Name="image_colored" Stretch="UniformToFill" Visibility="Collapsed" Source="{Binding Brand.Name, ConverterParameter=colored, Converter={StaticResource LogoToUriConverter}}"/>
    <StackPanel VerticalAlignment="Bottom">
        <TextBlock Text="{Binding Name}" Foreground="White" Style="{StaticResource TitleTextStyle}" Height="30" Margin="15,0,15,0"/>
        <TextBlock Text="{Binding Name}" Foreground="White" Style="{StaticResource CaptionTextStyle}" TextWrapping="NoWrap" Margin="15,0,15,10"/>
    </StackPanel>
    <VisualStateManager.CustomVisualStateManager>
        <vsm:ExtendedVisualStateManager/>
    </VisualStateManager.CustomVisualStateManager>
    <VisualStateManager.VisualStateGroups>
        <VisualStateGroup x:Name="SelectionStates">
            <VisualState x:Name="Selected2">
                <Storyboard>
                    <ObjectAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="image" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.0000000">
                            <DiscreteObjectKeyFrame.Value>
                                Collapsed
                            </DiscreteObjectKeyFrame.Value>
                        </DiscreteObjectKeyFrame>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="image_colored" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="00:00:00.0000000">
                            <DiscreteObjectKeyFrame.Value>
                                Visible
                            </DiscreteObjectKeyFrame.Value>
                        </DiscreteObjectKeyFrame>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </VisualState>
        </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
</Grid> 
```

希望这可以帮助任何有同样问题的人。

如果您有更好、更简单的方法在 WinRT 中实现相同的结果，请提出您的解决方案。

谢谢

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-28T02:05:55.920

您可以为您的 ListViewItem 创建一个样式，为触发器创建一个控件模板，为您的数据绑定创建一个数据模板，如下所示：

```
 <Style x:Key="FocusedContainer" TargetType="{x:Type ListViewItem}">
        <EventSetter Event="GotKeyboardFocus" Handler="OnListBoxItemContainerFocused" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListViewItem}">
                    <Border x:Name="backgroundBorder">
                        <ContentPresenter Content="{TemplateBinding Content}">
                            <ContentPresenter.ContentTemplate>
                                <DataTemplate>
                                     <Grid HorizontalAlignment="Center" Width="220" Height="220">
                                <Image x:Name="image" Stretch="UniformToFill" Source="{Binding Brand.Image, ConverterParameter=transparent, Converter={StaticResource LogoToUriConverter}}"/>
                                <StackPanel VerticalAlignment="Bottom">
                                    <TextBlock Text="{Binding Name}" Foreground="{StaticResource ApplicationColor}" Style="{StaticResource TitleTextStyle}" Height="30" Margin="15,0,15,0"/>
                                    <TextBlock Text="{Binding Name}" Foreground="{StaticResource ApplicationColor}" Style="{StaticResource CaptionTextStyle}" TextWrapping="NoWrap" Margin="15,0,15,10"/>
                                </StackPanel>
                            </Grid>
                                </DataTemplate>
                            </ContentPresenter.ContentTemplate>
                        </ContentPresenter>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="image" Property="Source" Value="{**Insert your alternate binding here**}"
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

然后像这样配置您的 ListView：

```
<ListView ItemContainerStyle="{StaticResource FocusedContainer}"/> 
```

您会看到该样式有一个 EventSetter：它的目的是即使您在某个控件内单击（而不是直接在背景上），也可以选择正确的项目。您需要在后面的代码中创建处理程序，只需几行：

```
 private void OnListBoxItemContainerFocused(object sender, System.Windows.RoutedEventArgs e)
    { (sender as ListViewItem).IsSelected = true; } 
```

希望这有帮助，问候！

# c# - 用泛型重载。这是预期的行为吗？

> ID：14551769
> 
> 赞同：3
> 
> 时间：2013-01-27T20:17:56.130
> 
> 标签：c#

> **可能重复：**
> [泛型方法重载的问题](https://stackoverflow.com/questions/6093112/a-problem-with-generic-method-overloading)

这是一个简单的代码：

```
static class Example  
{  
    static int DoIt(object o) { return 0; }    
    class A { }
    static int DoIt(A a) { return 1; }
    static int CallDoIt<X>(X x) { return DoIt(x); }
    static void Main()
    {
        var a = new A();
        System.Console.WriteLine(DoIt(a));      // returns 1 (as desired)
        System.Console.WriteLine(CallDoIt(a));  // returns 0
    }
} 
```

结果看起来很奇怪：直接调用的函数 DoIt() 返回的值与从另一个函数调用它的情况不同。这是 C# 中的预期行为吗？如果是，如何实现所需的行为（最好没有反射）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:32:15.947

This is the expected behaviour, the knowledge of what type `X` is does not extend into the `CallDoIt` function. The overload of `DoIt` called from `CallDoIt` is determined statically based on the type of the argument `x`. Since `X` can be anything, the best (and only) candidate is `DoIt(object)`.

You can get around this behaviour by delaying the dispatch to `DoIt` until runtime using dynamic:

```
static int CallDoIt<X>(X x) { return DoIt((dynamic)x); } 
```

The other alternative is to provide a more specific version of `CallDoIt`:

```
static int CallDoIt(A a) { return DoIt(a); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:54:53.097

`DoIt(x)`方法内部的方法调用`CallDoIt<X>(X x)`必须适用于任何`X`类型，因此 C# 编译器选择使用`DoIt(object o)`重载。如果您将类型限制为从这样`X`的类型派生：`A`

```
static int CallDoIt<X>(X x) where X : A { return DoIt(x); } 
```

然后 C# 编译器会知道它可以选择`DoIt(A a)`重载，因为`X`type 总是派生自 type `A`。这也回答了您关于如何实现所需行为的第二个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:33:57.483

Yes, that is the expected behaviour. A generic method is compiled once for all possible arguments. During that single compilation, `DoIt(x)` cannot be resolved to `DoIt(A)`, so it is `DoIt(object)`, and that is what it will always be.

You can dynamically check the object type, or better yet, have .NET Framework do so for you:

```
static int CallDoIt(object x) { return DoIt((dynamic)x); } 
```

Note that there is no benefit here to making `CallDoIt` generic: it would do exactly the same as this version. That means that `CallDoIt((object)a)` calls `DoIt(A)`, *not* `DoIt(object)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T20:34:50.657

为 CallDoIt 添加另一个重载：

```
static int CallDoIt(A x) { return DoIt(x); } 
```

这将使事情顺利进行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T20:36:57.553

重载解析发生在编译时（如果不需要动态解析）并且`X`（类型参数）的最具体类型是`object`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-27T20:40:49.513

选择调用方法的决定将在编译时解决。C# 编译器不知道 X 是什么类型，并选择了带有 DoIt(object o) 的方法。

# grails - 如何使我的 Grails 域类表现得像一个数字？

> ID：14551772
> 
> 赞同：0
> 
> 时间：2013-01-27T20:18:06.783
> 
> 标签：grails, groovy, delegates

我有一堆 Grails 域类，我希望能够将它们视为`Number`s，`Integer`尤其是 s。在大多数情况下，它们只是带有一些额外属性的数值，用作元数据。这是一个例子：

```
class Score {

    String meaning

    Integer value

    static hasMany = [responses:Response]

    static constraints = {
        meaning blank: false, maxSize: 100, unique: true
        value min: 1, unique: true // Assume we're using a base-1 ranking system, where 1 is the lowest
    }
} 
```

我试图添加`@Delegate`到`value`字段中，但它似乎没有任何影响：我仍然无法做到`7 + myScore`。我得到的只是缺少方法异常，因为 Integer 没有签名匹配`plus(Score)`。

这样做的正确方法是什么，因为`@Delegate`似乎不起作用？

[注意：我还需要将我的域类变成`Collection`带有元数据的各种 s，但我希望它会是相同的解决方案。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-19T05:12:09.937

我想象每个人都继续前进，现在这个问题已经存在一年半了，但我仍然很惊讶没有人提供 Groovy 类别作为解决方案。事实上，在我看来，类别是解决这个问题的最*自然的方法。*在不更改原始域类的“Grailsiness”的情况下，您仍然可以相对容易地灌输所需的数字行为。

首先定义类别类：

```
class ScoreCategory {
    static asType(Score s, Class newClass) {
        switch (newClass) {
            case Integer.class:
            case Integer.TYPE: 
            case Number.class: return s?.value ?: 0
            default: throw new GroovyCastException("Cannot cast to ${newClass}")
        }
    }

    static boolean equals(Score me, def you) {
        you instanceof Score && me as int == you as int
    }

    static Score plus(Score a, b) { plusImpl(a, b) }
    static Score plus(Score a, Number b) { plusImpl(a, b) }
    static Score plus(Number a, Score b) { plusImpl(a, b) }
    private static plusImpl(a, b) { new Score(value: (a as int) + (b as int)) }

    static Score minus(Score a, b) { minusImpl(a, b) }
    static Score minus(Score a, Number b) { minusImpl(a, b) }
    static Score minus(Number a, Score b) { minusImpl(a, b) }
    private static minusImpl(a, b) { a + -b }

    static Score multiply(Score a, Number b) { multImpl(a,b) }
    static Score multiply(Number a, Score b) { multImpl(a,b) }
    private static multImpl(a,b) { new Score(value: (a as int) * (b as int)) }

    static Integer div(Score a, b) { (a as int).intdiv(b as int) }
    static Score div(Score a, Number b) { new Score(value:(a as int).intdiv(b as int)) }

    static Score negative(Score a) { new Score(value: -(a as int)) }
    static Score abs(Score a) { new Score(value: (a as int).abs())}
} 
```

然后，在应用程序中某个适当的全局位置声明 mixins：

```
Number.metaClass.mixin ScoreCategory
Score.metaClass.mixin ScoreCategory 
```

毕竟，如下所示，`Score`对象现在应该表现得像数字量：

```
def (w, x, y, z) = [54, 78, 21, 32]
def (s1, s2) = [new Score(value:w), new Score(value:x)]

assert (s1 + s2) == new Score(value: w + x)
assert (s1 + y) == new Score(value: w + y)
assert (z + s2) == new Score(value: z + x)
assert (s1 - s2) == new Score(value: w - x)
assert (s1 - y) == new Score(value: w - y)
assert (z - s2) == new Score(value: z - x)
assert (s1 * y) == new Score(value: w * y)
assert (z * s2) == new Score(value: z * x)
assert (s2 / s1) == x.intdiv(w)
assert (s1 / y) == new Score(value: w / y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:31:05.717

`plus`为元类上的运算符添加重载`Number`：

```
Number.metaClass.plus = { Score s -> delegate + s.value } 
```

`doWithDynamicMethods`在您的应用程序或插件中的 BootStrap.groovy 中添加它。

**编辑：**

`Score`正如评论中所指出的，如果位于操作的左侧，这将不起作用。向类添加一个`plus`方法`Score`来处理它：

```
Number plus(Number n) { value + n } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T03:46:05.290

您的回答可能是[运算符重载](http://groovy.codehaus.org/Operator+Overloading)。在这里，您将重载 plus 方法以使用整数和双精度数进行操作：

```
class Score {
    ...
    int plus(int otherValue){
        return otherValue + value
    }

    double plus(double otherValue){
        return (value as double) + otherValue
    }

    // And you can avoid my pitfall overriding asType method
    Object asType(Class clazz) {
        if (clazz == Integer) {
            return value         
        }
        else if(class == Double){
            return value as Double
        }         
        else {             
            super.asType(clazz)         
        }     
    }    

}

assert new Score(value: 4) + 15 == 19
assert new Score(value: 4) + 15.32 == 19.32
assert 15.32 + (new Score(value: 4) as Double) == 19.32
assert 15 + (new Score(value: 4) as Integer) == 19 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-27T23:42:45.923

You can also extend Number.

```
class Score extends Number {
   Integer value

   public int intValue() { return value }
   public double doubleValue() { return value }
   public long longValue() { return value }
   public float floatValue() { return value }
}

Score sc = new Score( value: 5 );

println 10 + sc 
```

# c - 如何打印字符串的字符值？

> ID：14551774
> 
> 赞同：0
> 
> 时间：2013-01-27T20:18:23.787
> 
> 标签：c

我正在尝试以这种格式打印字符串中每个字符的值：

> 集合 0 中的代码 2 具有值：41 42
> 
> 集合 0 中的代码 6 具有值：41 42 43 44 45 46

我试图通过以下方式做到这一点：

```
printf("Code %d in set %d has value: %.*s\n", ndx, set, getCode(cs[set],ndx).size, getCode(cs[set],ndx).data); 
```

但是当我这样做时，它会打印与值相关联的字符，而不是值本身。我应该如何以指定的格式打印数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:25:39.687

您正在将数组打印为字符串。而是循环遍历每个字符并打印其十进制值：

```
int i;
printf("Code %d in set %d has value: ", ndx, set);
for (i = 0; i < getCode(cs[set],ndx).size ; i++) {
  printf("%d ", getCode(cs[set],ndx).data[i]);
}
puts(""); //print a newline 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:26:04.863

使用说明`%d`符：

```
char str[] = "Hello";
printf("%d\n", str[0]);  // Displays 72
printf("%d\n", str[1]);  // Displays 101 
```

# c++ - 依赖于容器的模板化函数

> ID：14551775
> 
> 赞同：1
> 
> 时间：2013-01-27T20:18:24.737
> 
> 标签：c++, templates

我有一个函数，其中“T”可以是队列或堆栈。目前对于我拥有的函数签名：

```
template <class T>
void foo(T<string> baa){

  //do something
} 
```

在 foo 中我想调用 T.pop() 但我不能这样做。

然后我写了两个版本的pop，一个用于队列，一个用于堆栈。

```
string bar(stack<string> & baa){
  string t=baa.top();
  baa.pop();
  return t;
}
string bar(queue<string> & baa){
  string t=baa.front();
  baa.pop();
  return t;
} 
```

然后我尝试这样做，但它不起作用。我该怎么做？

```
template <class T>
void foo(T<string> baa){
  //do something
  string baz=bar(baa);
} 
```

编辑：我忘记了 top() 只是删除了顶部元素。我现在编辑了代码片段以反映这些更改。但是它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:34:43.800

如果你真的想做这样的事情，那么在*语法上*你需要的是**模板模板参数**：

```
template<template<typename> class T>
void foo(T<string>& baa)
{
    ...
} 
```

但是，请注意*模板模板参数的模板参数`T`必须与模板模板参数的模板参数完全匹配*，即使这些参数具有默认参数值。

换句话说，由于 STL`stack`和`queue`容器适配器接受*两个*类型参数（即使第二个具有默认参数值），如果您希望将它们推导出为函数 template`foo()`的模板模板参数，则模板模板参数`T`必须采用*两个*类型参数：

```
template<template<typename, typename> class T, typename C>
void foo(T<string, C>& baa)
{
    ...
} 
```

不过，我要指出，您当前的需求**似乎不需要这样的设计**。这就够了：

```
template<typename T>
string bar(T& baa)
{
    string t = baa.front();
    baa.pop();
    return t;
} 
```

*只有当您有其他需要在非容器类型上工作的函数模板重载*时，您才会被迫采用带有模板模板参数的解决方案`bar()`，但这似乎不是您的情况。

# qt - 无法从 const QChar 转换为 int

> ID：14551777
> 
> 赞同：-1
> 
> 时间：2013-01-27T20:18:33.520
> 
> 标签：qt

我对这段代码有问题

```
 #define twobit(ch) ((toupper(ch)) == 'S' ? 0LL : \
                             (toupper(ch)) == 'M' ? 1LL : \
                             (toupper(ch)) == 'F' ? 2LL : 3LL)

 const QString pop("SWDGMKF");

    qDebug()<<twobit(pop[2]); //Erorr 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:28:21.340

QChar 代表一个 unicode 字符。因此它不能安全地转换为 char。如果您*知道*它仅包含 ASCII 或 Latin1 字符，则可以分别使用 toAscii() 或 toLatin1() 对其进行转换。

如果可能的话，我会避免转换为 char ，并使用 QChar 方法。即，代替 toupper() 使用[QChar::toUpper](http://qt-project.org/doc/qt-4.8/qchar.html#toUpper)：

```
ch.toUpper() == QLatin1Char('S') ? 0LL : \
  ... 
```

# objective-c - 从 MySQL 数据库中提取 MapView 注释的坐标，但没有显示注释？

> ID：14551779
> 
> 赞同：0
> 
> 时间：2013-01-27T20:18:36.017
> 
> 标签：objective-c, annotations, mkmapview, sigabrt

我正在尝试从 MySQL 数据库中提取 MapView 的坐标，但由于某种原因，我的坐标没有显示在 MapView 上？

请参阅下面我的代码。

**MapViewController.h 文件**

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>    

@interface MapViewController : UIViewController  <MKMapViewDelegate> 
@property (nonatomic, strong) IBOutlet MKMapView *mapView;
@property (nonatomic, retain) NSMutableArray *dispensaries;
@property (nonatomic, retain) NSMutableData *data;
@end 
```

**MapViewController.m**

```
#import "MapViewController.h"
#import "MapViewAnnotation.h"
#import "JSONKit.h"

@implementation MapViewController
@synthesize mapView;
@synthesize dispensaries;
@synthesize data;

#pragma mark - View lifecycle

- (void)viewDidLoad {        
    [super viewDidUnload];

    NSLog(@"Getting Device Locations");
    NSString *hostStr = @"http://stylerepublicmagazine.com/dispensaries.php";
    NSData *dataURL = [NSData dataWithContentsOfURL:[NSURL URLWithString:hostStr]];
    NSString *serverOutput = [[NSString alloc] initWithData:dataURL encoding: NSASCIIStringEncoding];
    NSLog(@"server output: %@", serverOutput);
    NSMutableArray *array = [[[serverOutput objectFromJSONString] mutableCopy] autorelease];   
    dispensaries = [serverOutput objectFromJSONString];
    NSLog(@"%@", [serverOutput objectFromJSONString]);

    for (NSDictionary *dictionary in array) {
            assert([dictionary respondsToSelector:@selector(objectForKey:)]);

            CLLocationCoordinate2D coord = {[[dictionary objectForKey:@"lat"] doubleValue], [[dictionary objectForKey:@"lng"] doubleValue]};

            MapViewAnnotation *ann = [[MapViewAnnotation alloc] init];
            ann.title = [dictionary objectForKey:@"Name"];
            ann.coordinate = coord;
            [mapView addAnnotation:ann];
    }        

    [mapView setMapType:MKMapTypeStandard];
    [mapView setZoomEnabled:YES];
    [mapView setScrollEnabled:YES];

    self.mapView.delegate = self;
}

- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation     {
    MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(userLocation.coordinate, 800, 800);
    [self.mapView setRegion:[self.mapView regionThatFits:region] animated:YES];

    MKPointAnnotation *point = [[MKPointAnnotation alloc] init];
    point.coordinate = userLocation.coordinate;
    point.title = @"You Are Here";
    point.subtitle = @"Your current location";

    [self.mapView addAnnotation:point];
} 
```

**MapViewAnnotation.h**

```
#import <Foundation/Foundation.h>
#import <MapKit/MKAnnotation.h>
#import <CoreLocation/CoreLocation.h>

@interface MapViewAnnotation : NSObject <MKAnnotation> {
    CLLocationCoordinate2D coordinate;
    NSString *title;
    NSString *subtitle;
}    
@property (nonatomic, assign) CLLocationCoordinate2D coordinate;
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *subtitle;
@end 
```

**MapViewAnnotation.m**

```
#import "MapViewAnnotation.h"

@implementation MapViewAnnotation    
@synthesize title, coordinate, subtitle;

-(void)dealloc{
    [title release];
    [super dealloc];
}    

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:27:03.670

这似乎是您期望错误 JSON 的问题：
您将其包装`serverOutput`在一个数组中：

```
 NSMutableArray *array = [NSMutableArray arrayWithObject:[serverOutput objectFromJSONString]]; 
```

* * *

您尝试访问 JKDictionary（Json Kit 字典）WITCH 实际上是一个数组，因此不响应 objectForKey：

尝试确保：

```
for (NSDictionary *dictionary in array) {
    assert([dictionary respondsToSelector:@selector(objectForKey:)]); 
```

--

# 潜在解决方案

我相信你的额外包装会让它变得糟糕。尝试：

```
NSMutableArray *array = [[[serverOutput objectFromJSONString] mutableCopy] autorelease]; 
```

# ios - 将 rootViewController 转换为 UINavigationController 后的“无法识别的选择器发送到实例”*

> ID：14551781
> 
> 赞同：1
> 
> 时间：2013-01-27T20:18:44.270
> 
> 标签：ios, objective-c, exception

不太清楚如何调试。

> 2013-01-24 20:36:18.448 SlideMenu[2069:c07] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[initViewController viewControllers]：无法识别的选择器发送到实例 0xac6cdb0”

这是 initViewController.m

```
#import "initViewController.h"
#import "ECSlidingViewController.h"
#import "MenuViewController.h"

@interface initViewController ()

@end

@implementation initViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.topViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"Main"];
}

@end 
```

以及抛出异常的地方：

AppDelegate.m

```
#import "AppDelegate.h"
#import "MainViewController.h"
#import "ListDoc.h"

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    ListDoc *list1 = [[ListDoc alloc] initWithTitle:@"Potato Bug" thumbImage:[UIImage imageNamed:@"potatoBugThumb.jpg"]];
    ListDoc *list2 = [[ListDoc alloc] initWithTitle:@"House Centipede" thumbImage:[UIImage imageNamed:@"centipedeThumb.jpg"]];
    NSMutableArray *lists = [NSMutableArray arrayWithObjects:list1,list2,nil];

    UINavigationController * navController = (UINavigationController *) self.window.rootViewController;
    MainViewController * mainController = [navController.viewControllers objectAtIndex:0];
    mainController.someData = lists;
    // Override point for customization after application launch.
    return YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T21:11:25.423

从你的帖子：

> 2013-01-24 20:36:18.448 SlideMenu[2069:c07] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[initViewController viewControllers]：无法识别的选择器发送到实例 0xac6cdb0”

找到抛出异常的位置：

```
UINavigationController * navController = (UINavigationController *) self.window.rootViewController;  
MainViewController * mainController = [navController.viewControllers objectAtIndex:0]; 
```

* * *

这是我对此的解读：该项目`navController`是一个实例，`initViewController`这可能不是您所期望的。
`initViewController`可能不是 UINavigationController 的子类。

如何调试？试试这个 ：
`NSLog(@"%@", [navController class]);`

# algorithm - 无法理解算法的复杂性

> ID：14551782
> 
> 赞同：0
> 
> 时间：2013-01-27T20:18:44.990
> 
> 标签：algorithm, complexity-theory

我正在学习算法，偶然发现了这篇顶级编码器的文章。

这是[文章中的一个例子](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=complexity2)

```
int result=0;                           //  1
for (int i=0; i<N; i++)                 //  2
  for (int j=i; j<N; j++) {             //  3
    for (int k=0; k<M; k++) {           //  4
      int x=0;                          //  5
      while (x<N) { result++; x+=3; }   //  6
    }                                   //  7
    for (int k=0; k<2*M; k++)           //  8
      if (k%7 == 4) result++;           //  9
  }                                     // 10 
```

*第 6 行中 while 循环的时间复杂度显然是 O(N) - 它执行不超过 N/3 + 1 次。*

我在这里很困惑，因为作者说时间复杂度是 O(N)。对我来说，这似乎是 O(N^4)。请解释一下，我忽略了什么。我只是开始算法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:25:34.290

**第6 行中 while 循环**的复杂度为 O(N)。

# c# - 无法将简单的组合框与 mvvm 和 wcf ria 服务绑定

> ID：14551785
> 
> 赞同：1
> 
> 时间：2013-01-27T20:18:54.217
> 
> 标签：c#, silverlight, mvvm, wcf-ria-services

我有一个带有域服务的简单项目，我正在尝试将组合框与我的视图模型中的域服务绑定。

我正在使用`mvvm`设计模式，请注意，当我不使用`mvvm`设计模式并且我从后面的代码中绑定组合框时，我会在组合框上看到结果。

```
enter code here

public class MainViewModel:INotifyPropertyChanged
{
    DomainService1 ctx = new DomainService1();
    private ObservableCollection<product> _products;
    public ObservableCollection<product> Products
    {

        get { return _products; }
        set {

            if (value != _products)
            {
                _products = value;
                OnPropertyChanged("Products");
            }
        }
    }

    public MainViewModel()
    {
        if (!DesignerProperties.IsInDesignTool)
        {
            LoadProdcuts();
        }
    }

    private void LoadProdcuts()
    {
        ctx.Load(ctx.GetProductsQuery(), LoadProdcutCallBack, null);
    }
    private void LoadProdcutCallBack(LoadOperation<product>lo)
    {
        _products = new ObservableCollection<product>(lo.Entities);
    }

    private void OnPropertyChanged(string propName)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(propName));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
}
enter code here

<UserControl.Resources>
    <data:MainViewModel x:Key="VwModel"/>
</UserControl.Resources>

    <ComboBox HorizontalAlignment="Left"  VerticalAlignment="Top" Height="30" Width="100" ItemsSource="{Binding Products}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:28:53.360

您必须设置`DataContext`属性：

```
<ComboBox HorizontalAlignment="Left"  VerticalAlignment="Top" Height="30" Width="100" 
                      DataContext="{StaticResource VwModel}"
                      ItemsSource="{Binding Products}"/> 
```

# c - C 执行命令窗口

> ID：14551789
> 
> 赞同：1
> 
> 时间：2013-01-27T20:19:29.963
> 
> 标签：c, windows, command, execute

有没有办法在 Windows 中使用 C 执行命令，并在不使用 System 命令的情况下获取输出？win32 api中有没有功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:25:18.163

看一下[_popen](http://msdn.microsoft.com/en-us/library/96ayss4b%28v=vs.71%29.aspx)函数。它适用于控制台子系统可执行文件。

如果您的目标是 Windows 子系统，则有更复杂的基于[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682499%28v=vs.71%29.aspx)的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T23:04:14.427

从这个问题的[答案](https://stackoverflow.com/a/450950/1741542)[Win32 API 中的 Posix popen() 等价物是什么？](https://stackoverflow.com/q/450865/1741542)有一个指向此 MSDN 文章[Creating a Child Process with Redirected Input and Output](http://msdn.microsoft.com/en-us/library/ms682499%28VS.85%29.aspx)的链接，它或多或少地描述了如何`popen`使用 Win32 调用构建功能

> 本主题中的示例演示如何使用控制台进程中的 CreateProcess 函数创建子进程。它还演示了一种使用匿名管道重定向子进程的标准输入和输出句柄的技术。请注意，命名管道也可用于重定向进程 I/O。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:31:20.513

[ShellExecute()](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb762153%28v=vs.85%29.aspx) or the [_spawn()](http://msdn.microsoft.com/en-us/library/20y988d2%28v=vs.100%29.aspx) function and its variants. MSDN is the place to look.

# c++ - 如何填充提升递归地图容器

> ID：14551791
> 
> 赞同：1
> 
> 时间：2013-01-27T20:19:34.143
> 
> 标签：c++, boost, map

我尝试使用 boost 中的以下[示例](http://www.boost.org/doc/libs/1_52_0/doc/html/container/containers_of_incomplete_types.html#container.containers_of_incomplete_types.recursive_containers)：

```
#include <boost/container/map.hpp>
struct data
{
    std::string label;
    //A map holding still undefined 'data'
    boost::container::map<std::string, data> m_;
};

int main(int argc, char* argv[])
{
    data d,d1,d2;
    d.m_["hello"] = d1;
    return 0;
} 
```

不幸的是它没有编译，我不知道为什么。

编译器消息（仅结束）：../../3d_party_4_5_8/boost_1_49_0/boost/container/detail/tree.hpp|183| 错误：没有匹配 גoperator=ג in ג((boost::container::container_detail::rbtree_node, std::allocator >, data>, void*>*)this)->boost::container::container_detail:: rbtree_node, std::allocator >, data>, void*>::m_data.boost::container::container_detail::pair, std::allocator >, data>::second = p->boost::container:: container_detail::pair, std::allocator >, data>::second 和 Analyzer.cpp|139| 注意：候选人是：data& data::operator=(data&)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:27:52.357

我认为您正在 C++03 模式下编译：请参阅[Assignment operator in classes derived from or holderable copyable and moving types](http://www.boost.org/doc/libs/1_51_0/doc/html/move/emulation_limitations.html#move.emulation_limitations.assignment_operator)。如错误消息所示，您的赋值运算符是**非常量的**`data& data::operator=(data&)`： ，这就是问题所在。`boost::container`模拟 C++03 编译器中的移动语义，为此定义了一个非常量复制构造函数。一种可能的解决方案是将以下内容添加到`data`：

```
data& operator=(data x)
{
    std::swap(*this, x); 
    return *this;
} 
```

或者

```
data& operator=(const data& x)
{
    label = x.label 
    return *this;
} 
```

取决于你的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:27:55.733

我从没想过这是可能的。但确实如此。试试这个插入：

```
//...
int main(int argc, char* argv[])
{
    data d,d1,d2;
    d.m_.insert( std::make_pair(std::string("hello"), d1) ) ;
    return 0;
}
// ... 
```

...它甚至可以在 C++03 中使用。

# javascript - 隐藏固定页脚？

> ID：14551800
> 
> 赞同：3
> 
> 时间：2013-01-27T20:20:45.617
> 
> 标签：javascript, css, footer, css-position

嗨，我想知道有没有办法用按钮隐藏固定页脚，所以如果用户想查看更多屏幕内容，可以将其关闭，反之亦然。有没有办法用 css 做到这一点，还是需要 javascript？

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:22:17.577

**JavaScript**

```
<input type="button" id="myButton" onclick="HideFooter()" />

function HideFooter()
{
    var display = document.getElementById("myFooter").style.display;
    if(display=="none")
        document.getElementById("myFooter").style.display="block";
    else
        document.getElementById("myFooter").style.display="none";
} 
```

**jQuery**

```
$("#myButton").click(function(){

    if($("#myFooter").is(":visible"))
        $("#myFooter").hide();
    else
        $("#myFooter").show();
}); 
```

**如果你想要其他一些不错的效果**

```
$("#myFooter").fadeOut(500);
$("#myFooter").slideUp(500);
$("#myFooter").slideToggle(500); //Hide and Show 
```

另一种方法，正如**Bram Vanroy**建议的那样：

```
$("#myButton").click(function(){

    $("#myFooter").toggle();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T20:22:31.767

这将需要`JavaScript`. 您的按钮单击事件处理程序需要将`display`页脚的属性更改为`none`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T20:24:46.397

这是一个仅限 JavaScript 的版本，按钮的 ID 为“按钮”，页脚 ID 为“页脚”。如果用户想再次看到它，此方法将允许您在隐藏页脚后再次显示它。

```
 var button = document.getElementById('button');

    button.onclick = function() {
        var div = document.getElementById('footer');
    if (div.style.display !== 'none') {
        div.style.display = 'none';
    }
    else {
        div.style.display = 'block';
    }
}; 
```

或者使用 jQuery：

```
$("#button").click(function() { 
    $("#footer").toggle();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-27T20:36:35.057

一个很好的 tutsplus[视频教程](https://tutsplus.com/lesson/slides-and-structure/?WT.mc_id=learnjquery)，正是您所需要的。这是一个简单的 jQuery。

# .net - 将静态嵌套类的字符串属性序列化为 JSON

> ID：14551802
> 
> 赞同：1
> 
> 时间：2013-01-27T20:21:07.133
> 
> 标签：.net, json, serialization, nested-class, static-classes

给定一组静态嵌套类，例如：

```
public static class LocalSiteMap
{
    public static class Navigation
    {
        public static readonly string Home = "homePage";

        public static class PageIds
        {
            public static class ShowManagement
            {
                public static readonly string Index = "showManagement";
            }

            public static class Shows
            { 
                public static readonly string Create = "addShows";
            }
        }

        public static class Actors
        {
            public static readonly string Details = "actorDetailsForm";
            public static readonly string History= "historyDetailsForm";
        }
    }
} 
```

我想构建一个等效的 JSON 字符串，例如：

```
{ 'localSiteMap' : {
    { 'navigation': {
        'home': 'homePage',
        'pageIds': {
            'showManagement': {
                'index': 'showManagement'
            },
            'shows': {
                'create': 'addShows'
            }
        },
        'actors': {
            'details': 'actorDetailsForm',
            'history': 'historyDetailsForm'
        }
    }
} 
```

每个嵌套类都会在 JSON 中生成一个嵌套对象。每个字符串属性都会在 JSON 中生成一个字符串键/值对。

我知道我可以反映根静态类并很容易地构建一个 JSON 字符串（这就是我目前正在采用的方法），但我想知道是否有更优雅的方法来做到这一点。例如，如果这是一个实例匿名类型，那么我可以[很容易地对其进行序列化](https://stackoverflow.com/questions/331976)。

一些背景知识：这是一组通过 WebAPI 控制器传递给在浏览器中运行的单页应用程序的常量。在 C#（服务器）和 JS（客户端）世界中拥有相同的页面标识符集对于使用[页面对象模式](http://code.google.com/p/selenium/wiki/PageObjects)的浏览器自动化测试非常有用。

'LocalSiteMap' 静态类已经融入到一个相当成熟的项目中，因此将其更改为实例类或匿名类型对我来说并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T17:40:39.903

在这里构建字符串的问题是您必须确保语法 100% 正确，打开和关闭大括号，添加逗号等。所有可能但相当麻烦。

完全避免使用魔术字符串的解决方案是使用 LINQ-to-XML 作为中间转换步骤。像这样：

```
public static class NestedStaticClassWithStringPropertiesJsoniser
{
    public static string GetJson(this Type type)
    {
        XElement rootXml = new XElement(type.Name);
        XElement xmlContent = CreateXmlTree(rootXml, type);

        string jsonString = JsonConvert.SerializeXNode(xmlContent);

        return jsonString;
    }

    public static XElement CreateXmlTree(XElement parent, Type type)
    {
        AddStringProperties(parent, type);

        AddNestedClasses(parent, type);

        return parent;
    }

    private static void AddNestedClasses(XElement parent, Type type)
    {
        var subTypes = type.GetNestedTypes();

        foreach (var subType in subTypes)
        {
            var newElement = new XElement(subType.Name);
            var subTree = CreateXmlTree(newElement, subType);
            parent.Add(subTree);
        }
    }

    private static void AddStringProperties(XElement parent, Type type)
    {
        var properties = type.GetFields();
        foreach (var property in properties)
        {
            var propertyElement = new XElement(property.Name);
            propertyElement.SetValue(property.GetValue(null));
            parent.Add(propertyElement);
        }
    }
} 
```

它可以像这样轻松使用：

```
string json = typeof(ATypeWithNestedStaticClasses).GetJson(); 
```

# antlr - 从 DSL 语法文件生成 java 类

> ID：14551805
> 
> 赞同：2
> 
> 时间：2013-01-27T20:21:27.230
> 
> 标签：antlr, dsl, parser-generator, bnf, compiler-compiler

我正在寻找一种从将填充 AST 的语法文件（类似 BNF/BNF）生成解析器的方法。但是，我还希望以开发人员可读的方式自动生成各种 AST 类。

示例：对于以下语法文件

```
expressions = expression+;
expression = CONST | math_expression;
math_expression = add_expression | substract_expression;
add_expression = expression PLUS expression;
substract_expression = expression MINUS expression;

CONST: ('0'..'9')+;
PLUS: '+';
MINUS: '-'; 
```

我希望生成以下 Java 类（以我期望它们的字段为示例）：

```
class Expressions {List<Expression> expression};
class Expression {String const; MathExpression mathExpression;} //only one should be filled.
class MathExpression {AddExpression addExpression; SubstractExpression substractExpression;}
class AddExpression {Expression expression1; Expression expression2;}
class SubstractExpression {Expression expression1; Expression expression2;} 
```

而且，在运行时，我希望表达式“1+1-2”生成以下对象图来表示 AST：

```
Expressions(Expression(MathExpression(AddExpression(1, SubstractExpression(1, 2))))) 
```

（不要介意运算符优先级）。

我一直在探索 DSL 解析器生成器（JavaCC/ANTLR 和朋友），我能找到的最接近的方法是使用 ANTLR 生成具有“enterExpression”和“leaveExpression”样式方法的侦听器类。我发现使用“multi”使用 JavaCC 和 jjtree 生成的代码有点相似——但它非常笨拙且难以使用。

我的语法需求有点简单——我想尽可能地自动化 AST 对象图的创建。

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T01:46:32.107

如果你想要大量支持 DSL 构造，ANTLR 和 JavaCC 可能不是你要走的路。它们提供解析、构建树的一些支持……然后你就靠自己了。但是，正如您所了解的那样，设计您自己的树、处理细节需要大量工作，而此时您还没有完成 DSL；你仍然不能*使用*它。

还有更完整的解决方案：JetBrains MPS、Xtext、Spoofax、DMS。它们都提供了定义 DSL、将其转换为内部形式（“构建树”）并为代码生成提供支持的方法。前三个集成了 IDE 支持，适用于“小型”DSL；DMS 不会，但可以处理 C++ 和 DSL 等真实语言。我认为前三个是开源的；DMS 是商业的（我是 DMS 背后的一方）。

Markus Voelter 刚刚发布了一本关于[DSL 工程](http://dslbook.org)的在线书籍，供您提出捐赠的想法。他详细介绍了 MPS、XText、Spoofax，但没有介绍 DMS。他告诉你你需要知道什么，你需要做什么；根据我对这本书的浏览，它非常广泛。您可能不会在“简单”上下车；DSL 具有很多语义复杂性，支持机制也很困难。

我认识作者，非常尊重他在这个领域的技能，并与他共同教授夏季技术技能，包括喝一些好喝的啤酒。否则我无事可做这本书。

# ruby-on-rails - 同一页面上的 link_to 标记 rails 3

> ID：14551808
> 
> 赞同：13
> 
> 时间：2013-01-27T20:21:57.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3, hyperlink

我正在尝试使用 link_to 链接到同一页面上的元素

在基本的 HTML 中，我会这样做

```
<a href="#tom">Tom Roche</a>
<a id="tom">Chapter 4</a> 
```

我的应用中有这个

```
<%= link_to 'Tom Roche' %>
<h2>Tom Roche</h2> 
```

我将如何链接这些，以便当我单击 Tom Roche 时，我会与 Tom Roche 一起进入 h2

我试过这个

```
<%= link_to 'Tom Roche', our_team_path(:anchor => '#tom') %>
<h2><a id="tom">Tom Roche</a></h2> 
```

但它不工作

谁能指出我需要做的事情，link_to 出于某种原因把我扔了，即使我知道它是一个标签

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-28T02:03:41.647

如果您想链接到访问者当前正在查看的同一页面上的锚标记，您可以`link_to`稍微缩短代码：

```
<%= link_to "Comment wall", anchor: "wall" %> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-27T20:25:40.403

link_to 还可以生成带有锚点或查询字符串的链接：

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html)

```
link_to "Comment wall", profile_path(@profile, :anchor => "wall")
# => <a href="/profiles/1#wall">Comment wall</a> 
```

# mysql - mySQL 语句查找带有斜杠的几乎重复的数据

> ID：14551809
> 
> 赞同：0
> 
> 时间：2013-01-27T20:22:01.037
> 
> 标签：mysql, phpmyadmin

我有一个名为“LINK_INFO”的表，其中包含一个名为“URL”的字段中的 URL。问题是，除了一些使用尾随 / 来绕过唯一字段要求的 URL 之外，存在许多重复的 URL。

例子：

[http://www.yahoo.com](http://www.yahoo.com) 和 [http://www.yahoo.com/](http://www.yahoo.com/)

我可以使用什么语句来选择这些几乎重复的情况，以便我可以删除其中一个？非常感谢您能提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:34:52.053

您可以只使用[`TRIM`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_trim)来查找所有唯一值；

```
SELECT DISTINCT TRIM(TRAILING '/' FROM url) url
FROM link_info 
```

[要测试的 SQLfiddle](http://sqlfiddle.com/#!2/6cc02/2)。

要立即删除重复项，只需执行删除连接；

```
DELETE li1
FROM link_info li1
JOIN link_info li2
WHERE TRIM(TRAILING '/' FROM li1.url) =
      TRIM(TRAILING '/' FROM li2.url)
AND li1.id<li2.id 
```

[另一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!2/90495/1)。

在运行网上找到的任意 SQL 之前，请务必备份您的表，即使是我的 :)

编辑：如果您的数据库机器有限，您可能希望使用索引来执行此操作，并避免将更多内容加载到内存中；

```
-- remove all trailing slashes
UPDATE link_info 
SET url=TRIM(TRAILING '/' FROM url);

-- create an index on the resulting strings (if there isn't already one)    
CREATE INDEX url_index ON link_info(url);

-- delete all duplicates
DELETE li1
FROM link_info li1
JOIN link_info li2
WHERE li1.url = li2.url
AND li1.id<li2.id;

-- drop the index if not needed anymore
DROP INDEX url_index ON link_info; 
```

又一个[SQLfiddle](http://sqlfiddle.com/#!2/ca64b/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:27:11.757

也许是这样的？

```
CREATE TABLE link_info (
  url varchar(255));

INSERT INTO link_info VALUES
('http://www.yahoo.com/'),
('http://www.yahoo.com');

SELECT DISTINCT
  CASE
    WHEN SUBSTRING(url, LENGTH(url)) = '/' 
      THEN LEFT(url, LENGTH(url) -1)
    ELSE url
  END AS `url`
FROM link_info 
```

**结果**

```
| 网址 |
----------------------
| http://www.yahoo.com |
```

## [查看演示](http://sqlfiddle.com/#!2/f2c119/1)

此时您可以将其插入临时表中，删除您的父级并重新填充。

# javascript - 不使用 item.item = string 访问 JSON var

> ID：14551810
> 
> 赞同：0
> 
> 时间：2013-01-27T20:22:01.997
> 
> 标签：javascript, jquery

这是数组

```
var weekdayColor = {
        sunday : 'red',       // sunday
        monday : 'blue',      // monday
        tuesday: 'white',     // tuesday
        wednesday: 'black',    
        thursday: 'green',     
        friday: 'yellow',  
        saturday: 'orange'     
    } 
```

我希望能够做一些事情`weekcayColor[0]`来获得`sunday`：

这是我为面试而写的 JavaScript，已经上交了。我知道有一种更简单的方法可以做到这一点。第一个 var`weekdayColor`不能更改；也`weekdayColor.sunday`返回`red`。

也许我使用了错误的日期方法或错误地访问了 var？

```
var weekdayColor = {
        sunday : 'red',       // sunday
        monday : 'blue',      // monday
        tuesday: 'white',     // tuesday
        wednesday: 'black',     // wednessday
        thursday: 'green',     // thursday
        friday: 'yellow',    // friday
        saturday: 'orange'     // saturday
    }
    var weekday=new Array();
        weekday[0]="sunday";
        weekday[1]="monday";
        weekday[2]="tuesday";
        weekday[3]="wednesday";
        weekday[4]="thursday";
        weekday[5]="friday";
        weekday[6]="saturday";
    d = new Date;
    day = d.getDay();
    console.log(weekday[day]);
    a = weekday[day];
    function change(){
        var x = document.getElementById("weekday");
        x.innerHTML = a;
        x.style.color = weekdayColor[a];
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:51:13.407

更简单的方法是使用如下对象数组：

```
var weekday = [
   {name:"sunday",color:"red"},
   {name:"monday",color:"blue"},
   // and so on
] 
```

然后你可以做这样的事情：

```
d = new Date();
day = d.getDay();
weekday[day].name  // yields name
weekday[day].color // yields color 
```

或者，您可以编写一个原型方法：

```
Date.prototype.getDayName = function() {
return ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday']
       [this.getDay()];
} 
```

现在

```
var d = new Date;
d.getDayName(); // this would actually give you the name of the day 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:42:02.737

不是 100% 确定您要做什么。如果你只是想改变今天的元素颜色需要修改`change()`如下：

```
function change(day){
    var x = document.getElementById(day);       
    x.style.color = weekdayColor[day];
}
var d = new Date(),
    day = d.getDay(),
    a = weekday[day];

/* now call change passing day as argument*/
change(a); 
```

演示：http: [//jsfiddle.net/rhHjn/1](http://jsfiddle.net/rhHjn/1)

# python - Pygame不识别1键？

> ID：14551811
> 
> 赞同：0
> 
> 时间：2013-01-27T20:22:05.527
> 
> 标签：python, pygame

我一直在 python 中使用 pygame 制作游戏，它拒绝识别`1`密钥。

```
if event.type == KEYDOWN and event.key == K_1:
   print("pass")
   started = True 
```

我添加了“通过”来检查是否有其他问题，但没有任何反应。我使用了一些其他的键，比如`up`, `down`, `w`,`s`并且`enter`它们可以工作，但是它不能识别任何数字。

如果有帮助，我正在使用 Trust Xpress 无线键盘。关于多米尼克的问题，我尝试过数字键盘和标准键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:13:10.700

您的问题可能与您的键盘无关。
您可能刚刚关闭了麻木锁定并正在使用键盘。
如果没有，让窗口打印所有事件并查看当您按下 1 键时是否出现任何内容。
它应该是`49`，但如果不是，就使用它是什么。
如果什么都没有出现，并且您不能在其他地方使用键盘，那么您的键盘有问题。

# lua - 获取故事板在 Corona 中的文件名？

> ID：14551812
> 
> 赞同：1
> 
> 时间：2013-01-27T20:22:09.863
> 
> 标签：lua, coronasdk, corona-storyboard

我有一个情节提要文件，我想引用实现情节提要的文件的名称，以便我可以加载具有相同基本名称的配置文件。

这是一个名为的文件中的示例`scene001.lua`

```
-- Called when the scene's view does not exist:
function scene:createScene( event )
    local screenGroup = self.view

    local json = require("json")
    -- load the book definition file
    local contents = textFromFile("scene001.json")
    local page = json.decode(contents)
    image = buildPage(page)
    screenGroup:insert(image)
    image.touch = onSceneTouch
end 
```

如您所见，我必须对`"scene001.json"`. 我想加载一个与当前故事板同名的配置文件，我该如何动态地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T21:32:41.347

您可以使用该`debug`库，特别是 function`debug.getinfo`来检索有关当前文件名的信息。使用简单的模式，您可以将`.lua`扩展名替换为`.json`以打开您的自定义文件。

```
print( debug.getinfo(1,"S").short_src ) --> /path/to/scene001.lua. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T06:30:52.500

实际上，我找到了一种更好更正式的方式来执行此操作，而无需解析路径所需的所有正则表达式。使用`debug.getinfo()`.

[`storyboard.getCurrentSceneName()`](http://docs.coronalabs.com/api/library/storyboard/getCurrentSceneName.html)

# mysql - 使用 mysql 在 Visual Studio 中使用 case-when 语句

> ID：14551819
> 
> 赞同：0
> 
> 时间：2013-01-27T20:22:43.560
> 
> 标签：mysql, visual-studio, select, case

我正在尝试通过使用包含如下列的 mySQL 查询来构建 tableadaptor：

```
if((`c`.`timed` > 0), 'Y', 'N') AS `Timed`, 
```

这在我在 MySQL 工作台中运行时有效，但在 VS2012 中导致错误，无法生成 select 语句。

我也尝试过使用

```
case `c`.`timed` when 0 then 'Y' when 1 then 'N' end AS `Timed`, 
```

没有成功。

有人能告诉我这个查询应该怎么写吗？

谢谢

完整查询：

```
select 
    `c`.`callid` AS `callid`,
    concat(`cs`.`firstname`, ' ', `cs`.`lastname`) AS `Customer`,
    `c`.`postcode` AS `postcode`,
    `c`.`type` AS `type`,
if((`c`.`timed` > 0), 'Y', 'N') AS `Timed`,   `c`.`calldate` AS `calldate`,
`c`.`notes` AS `notes`,
    `c`.`driver` AS `Driver`
from
    (((`quick-quote-2`.`call` `c`
    left join `quick-quote-2`.`driver` `d` ON ((`c`.`driver` = `d`.`driverid`)))
    left join `quick-quote-2`.`booking` `b` ON ((`c`.`booking` = `b`.`bookingid`)))
    left join `quick-quote-2`.`customer` `cs` ON ((`b`.`customer` =  `cs`.`customerid`)))
where
    (`c`.`canx` = 0) 
```

错误：

```
Error in list of function arguments: '>' not recognised
unable to parse query text 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:10:42.357

不确定 VS 和`IF()`函数是否导致错误，但您始终可以使用`CASE`表达式。这是等效的：

```
CASE WHEN `c`.`timed` > 0 THEN 'Y' ELSE 'N' END AS `Timed`, 
```

# php - 正则表达式不允许双下划线

> ID：14551821
> 
> 赞同：0
> 
> 时间：2013-01-27T20:22:52.297
> 
> 标签：php, regex

我正在写我的网站用户注册部分，我有一个简单的正则表达式如下：

```
if(preg_match("/^[a-z0-9_]{3,15}$/", $username)){
    // OK...
}else{
    echo "error";
    exit();
} 
```

我不想让用户拥有像：' `___`'或' `x________y`'这样的用户名，这是我刚刚编写的用于替换双下划线的函数：

```
function replace_repeated_underScores($string){
    $final_str = '';
    $str_len = strlen($string);
    $prev_char = '';
    for($i = 0; $i < $str_len; $i++){
        if($i > 1){
            $prev_char = $string[$i - 1];
        }
        $this_char = $string[$i];
        if($prev_char == '_' && $this_char == '_'){

        }else{
            $final_str .= $this_char;
        }
    }
    return $final_str;
} 
```

它工作得很好，但我想知道我是否也可以用正则表达式而不是另一个函数来检查它。

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:24:27.527

只需添加负前瞻即可检查名称中是否有双下划线。

```
/^(?!.*__)[a-z0-9_]{3,15}$/ 
```

`(?!pattern)`，称为**零宽度负前瞻**，将检查是否无法从“当前位置”开始在字符串中找到模式（当前位置是正则表达式引擎所在的位置）。它是*zero-width*，因为它不消耗过程中的文本，而不是外部的部分。*它是否定的，因为只有在无法*匹配模式的情况下才会继续匹配（所有可能性都已用尽）。

模式是`.*__`, 所以它只是意味着只有在找不到匹配的情况下才会继续匹配，即字符串中`.*__`没有双下划线。`__`由于该组不使用文本，因此当它开始匹配模式的后半部分时，您仍将位于字符串的开头`[a-z0-9_]{3,15}$`。

您已经允许使用大写用户名`strtolower`，但是，仍然可以通过添加不区分大小写的标志直接使用正则表达式进行验证`i`：

```
/^(?!.*__)[a-z0-9_]{3,15}$/i 
```

# python - 运行烧瓶 + gevent + 请求未“同时”服务

> ID：14551823
> 
> 赞同：13
> 
> 时间：2013-01-27T20:23:08.753
> 
> 标签：python, io, flask, gevent

我像这样启动我的烧瓶应用程序：

```
#!flask/bin/python
from app import app_instance
from gevent.pywsgi import WSGIServer

#returns and instance of the application - using function to wrap configuration
app = app_instance()
http_server = WSGIServer(('',5000), app)
http_server.serve_forever() 
```

然后，当我尝试执行此代码时，请求调用会阻塞，直到原始请求超时。我基本上是在同一个烧瓶应用程序中调用网络服务。我对gevent有什么误解？当 i/o 事件发生时，线程不会屈服吗？

```
@webapp.route("/register", methods=['GET', 'POST'])
def register():
    form = RegistrationForm(request.form, csrf_enabled=False)
    data = None
    if request.method == 'POST' and form.validate():
        data= {'email': form.email, 'auth_token': form.password,
                'name' : form.name, 'auth_provider' : 'APP'}
        r = requests.post('http://localhost:5000', params=data)
        print('status' + str(r.status_code))
        print(r.json())
    return render_template('register.html', form=form) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-27T21:42:32.247

我相信这个问题很可能是你忘记了猴子补丁。这使得所有正常阻塞的调用都变成了利用greenlets的非阻塞调用。为此，只需在调用其他任何内容*之前放置此代码。*

```
from gevent import monkey; monkey.patch_all() 
```

访问[http://www.gevent.org/intro.html#monkey-patching](http://www.gevent.org/intro.html#monkey-patching)了解更多信息。

# mediawiki - 表只工作一次

> ID：14551826
> 
> 赞同：-1
> 
> 时间：2013-01-27T20:23:27.840
> 
> 标签：mediawiki

我在使用 Mediawiki!iki 中的表格时遇到问题。为主页创建特定表时，它一次正常工作，第二次被破坏。截图如下所示

![问题截图](../Images/0683b8b93825ad41b96e4e50b062af0b.png)

代码显示在底部。有谁知道为什么视觉框只正确显示一次？

先感谢您！

```
<!--        Lorem ipsum        -->
{| id="mp-lower" style="margin:4px 0 0 0; width:100%; background:none; border-spacing: 0px;"
| class="MainPageBG" style="width:100%; border:1px solid #ddcef2; background:#faf5ff; vertical-align:top; color:#000;" |
{| id="mp-bottom" style="vertical-align:top; background:#faf5ff; color:#000; width:33%"
| style="padding:2px;" | <h2 id="mp-tfp-h2" style="margin:3px; background:#ddcef2; font-size:120%; font-weight:bold; border:1px solid #afa3bf; text-align:center; color:#000; padding:0.2em 0.4em"> [[Lorem ipsum]] 
|-
| style="color:#000; padding:2px;" | <div id="mp-tfp">  Lorem ipsum dolor sit amet,</div>
|}
|}

<!--        Lorem ipsum        -->
{| id="mp-lower" style="margin:4px 0 0 0; width:100%; background:none; border-spacing: 0px;"
| class="MainPageBG" style="width:100%; border:1px solid #ddcef2; background:#faf5ff; vertical-align:top; color:#000;" |
{| id="mp-bottom" style="vertical-align:top; background:#faf5ff; color:#000; width:33%"
| style="padding:2px;" | <h2 id="mp-tfp-h2" style="margin:3px; background:#ddcef2; font-size:120%; font-weight:bold; border:1px solid #afa3bf; text-align:center; color:#000; padding:0.2em 0.4em"> [[Lorem ipsum]] 
|-
| style="color:#000; padding:2px;" | <div id="mp-tfp">  Lorem ipsum dolor sit amet,</div>
|}
|} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:52:30.933

fizzisist 告诉我问题不在于 Mediawiki，而是与我的特定安装有关。

谢谢

# c - 在 C 上编译，函数错误？

> ID：14551828
> 
> 赞同：0
> 
> 时间：2013-01-27T20:23:52.643
> 
> 标签：c, function, matrix, compilation

几个月前我开始学习计算机科学，所以这个问题可能有点愚蠢，但如果有人可以帮助我，我将不胜感激。所以我的老师要求我们制作一个名为 Bejeweled 的游戏版本，我认为到目前为止我做得还不错，但我开始遇到这个问题，我收到以下错误消息： **[Linker error] undefined reference to `change_position'**. 出于某种原因，函数 change_position 不允许我的代码编译，我真的不明白为什么。在下面的代码中，该函数在主函数上有一个“//”，它工作正常，但没有 // 它会收到该消息。谁能解释我如何使它工作？如果有人解释为什么它也不起作用，那就更好了。非常感谢，对任何英语错误深表歉意。非常感谢，我纠正了我所犯的错误，现在它可以正常工作了。你们真棒。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
void create_matrix (int matriz[8][8], int i, int j)
{
srand (time (NULL));
for (i=0;i<8;i++)
{
for (j=0;j<8;j++)
{
matriz[i][j]=rand()%7+1;
}
}
}
//___________________________________________________
void check_matrix(int matriz[8][8], int i, int j)
{
     for (i=0;i<8;i++)
         {
             for (j=0;j<8;j++)
           {    
               while (matriz[i][j] == matriz[i+1][j] && matriz[i+1][j] == matriz [i+2][j] || matriz [i][j] == matriz [i][j+1] && matriz [i][j+2])
               {
               matriz[i][j]=rand()%7+1;
               }
           }
     }
}
//___________________________________________________
void print_matrix (int matriz[8][8], int i, int j)
{
for (i = 0; i < 8 ; i++)
{
for (j=0;j<8;j++)
{
printf("%d ", matriz[i][j]);
}
printf ("\n");
}
}
//___________________________________________________
void change_position(int matriz[8][8], int i, int j)
{
printf ("Select the line. ");
scanf ("%d", &i);
printf ("Select the column. ");
scanf ("%d", &j);
}
//___________________________________________________
int main()
{
int matriz[8][8], i=0, j=0;
create_matrix (matriz, i, j);
check_matrix (matriz, i, j);
print_matrix (matriz, i, j);
change_position (matriz, i, j);
printf ("\n");
system ("pause");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:27:08.363

看起来 change_position 正上方的 print_matrix 缺少一个右括号

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:29:13.527

函数`print_matrix`似乎有一个错误：你打开了三个括号，但你只关闭了其中的两个。

# c - fork() 为什么不是无限输出

> ID：14551829
> 
> 赞同：5
> 
> 时间：2013-01-27T20:24:00.473
> 
> 标签：c, process, fork

为什么

```
int main(...) {  
    fork();  
    printf("hello again\n");  
    exit(0);  
} 
```

不创建无限数量的进程？我理解如下，主进程创建一个子进程，子进程创建另一个子进程，以此类推。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T20:26:26.917

在父子节点的分叉之后继续执行，它不会重新启动程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T20:27:55.047

父进程在被调用的执行点被“克隆” `fork()`，两个进程都从那里开始。子进程不会通过再次调用 main() 重新开始。

# c++ - 如何创建 3d 边界框？（直接 3d 11，HLSL）

> ID：14551831
> 
> 赞同：0
> 
> 时间：2013-01-27T20:24:11.577
> 
> 标签：c++, 3d, hlsl, direct3d11

我第一次使用直接 3d，我正在寻找一种表示边界框（矩形/圆柱体/球体）的方法。我如何勾勒边界框？这是着色器，还是我使用其他东西来创建轮廓形状？

追逐者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:36:36.153

最简单的方法是使用线列表来创建单位线框包围体。使用变换矩阵，您可以围绕 3D 世界中的任何对象缩放、平移或旋转体积。

实现这一点需要 3 个主要部分：

1.  设置了 linelist verts 的常量 VB 和 IB（请记住，它需要以原点为中心，并且单位长度为 1），以及用于每个实例数据的 VB。
2.  将变换矩阵作为每个实例成员的输入布局。
3.  将变换矩阵应用于立方体的每个顶点的顶点着色器。（像素着色器只需要输出提供的颜色）。

（应该注意，同样的原理也适用于球体、船体等）

我使用的着色器如下所示：

```
struct WIRE_VS_INPUT
{
    float3 Position     : POSITION;
    float4 Color        : COLOR0;
    float3 Transform    : TRANSFORM;
    float3 Size         : SIZE;  
};

struct WIRE_VS_OUTPUT
{
    float4 Position     : SV_POSITION; 
    float4 Color        : COLOR0;
};

WIRE_VS_OUTPUT WireBoxVS( WIRE_VS_INPUT Input )
{
    WIRE_VS_OUTPUT Output;
    Output.Position = mul(float4((Input.Position * Input.Size) + Input.Transform,1),g_mWorldViewProjection);
    Output.Color = Input.Color;
    return Output;    
}

float4 WireBoxPS( WIRE_VS_OUTPUT Input ) : SV_TARGET
{ 
    return Input.Color;
} 
```

立方体 VB & IB 设置：

```
const DirectX::XMFLOAT3 kWireCube[] =
{
    DirectX::XMFLOAT3(-1,-1,-1),
    DirectX::XMFLOAT3(1,-1,-1),
    DirectX::XMFLOAT3(1,1,-1),
    DirectX::XMFLOAT3(-1,1,-1),
    DirectX::XMFLOAT3(-1,-1,1),
    DirectX::XMFLOAT3(1,-1,1),
    DirectX::XMFLOAT3(1,1,1),
    DirectX::XMFLOAT3(-1,1,1)
};

const WORD kWireCubeIndices[] =
{
    0,1,
    1,2,
    2,3,
    3,0,

    4,5,
    5,6,
    6,7,
    7,4,

    0,4,
    1,5,
    2,6,
    3,7
}; 
```

# python - 填充列表的 Python 快捷方式

> ID：14551838
> 
> 赞同：2
> 
> 时间：2013-01-27T20:25:10.813
> 
> 标签：python, python-2.7

Java 有`Arrays.fill(A,1)`. 对于预先存在的 List `A`，是否有填充列表的快捷方式`1`？我正在编写一个函数，它接受一个数组并以某种方式更改数组。由于数组是指针，所以我的函数不会返回数组。调用者将在我的函数返回后看到更改。我函数的第一步是用`1s`. 正在做

```
def my_work(A):
   A =[1]*len(A) 
   # more work on A 
```

`A`完成后似乎没有改变`my_work`。

所以是我唯一的选择

```
for i in range(len(A)):
  A[i]=1 
```

还是有捷径？我的看起来像一个解决方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T21:57:16.610

如果您真的想`A`就地更改，`A[:]`语法应该有效：

```
>>> A = [1,2,3]
>>> def my_work(A):
...     A[:] = [1]*len(A) 
...     
>>> A
[1, 2, 3]
>>> my_work(A)
>>> A
[1, 1, 1] 
```

这是本教程的相关部分（“分配给切片”）[。](http://docs.python.org/2/tutorial/introduction.html#lists)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:30:23.937

A 没有改变，因为你没有把它归还给我们`my_work`。一旦 my_work 完成，您在其中的 A 就不会被引用。

```
def my_work(A):
    A =[1]*len(A) 
    return A  #This line is needed

A = my_work(A) 
```

另一种方法是这样的。

```
def reset_list(L, x):
     return [x for i in xrange(len(L))]

A = reset_list(A,1) 
```

# prolog - Prolog - 狼山羊白菜

> ID：14551844
> 
> 赞同：6
> 
> 时间：2013-01-27T20:25:41.937
> 
> 标签：prolog, prolog-setof, river-crossing-puzzle

我正在开发一款名为“狼山羊白菜”的益智游戏。编程语言是 Prolog。

```
change(e,w).
change(w,e).
move([X,X,Goat,Cabbage],wolf,[Y,Y,Goat,Cabbage]) :- change(X,Y).
move([X,Wolf,X,Cabbage],goat,[Y,Wolf,Y,Cabbage]) :- change(X,Y).
move([X,Wolf,Goat,X],cabbage,[Y,Wolf,Goat,Y]) :- change(X,Y).
move([X,Wolf,Goat,Cabbage],nothing,[Y,Wolf,Goat,Cabbage]) :- change(X,Y).

oneeq(X,X,WW).
oneeq(X,WWW,X).

safe([Man,Wolf,Goat,Cabbage]) :-
        oneeq(Man,Goat,Wolf),
        oneeq(Man,Goat,Cabbage).

wgc([e,e,e,e],[]).

wgc(Config,[FirstMove|OtherMoves]) :-
        move(Config,FirstMove,NextConfig),
        safe(NextConfig),
        wgc(NextConfig,OtherMoves). 
```

为了让它工作，我打电话给 `length(X,7),wgc([w,w,w,w],X).`它，它显示了结果。问题是它多次显示第一个结果，然后显示第二个结果：

```
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, wolf, goat, cabbage, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
X = [goat, nothing, cabbage, goat, wolf, nothing, goat] ;
false. 
```

如何只显示一次两个结果？我试图添加！wgc的符号：

```
wgc(Config,[FirstMove|OtherMoves]) :-
        move(Config,FirstMove,NextConfig),
        safe(NextConfig),
        wgc(NextConfig,OtherMoves), !. 
```

...但它只显示第一个结果一次。任何想法如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T07:55:40.480

你在这里得到多余的答案/解决方案。要消除 a (终止) 的冗余答案，只需使用 注意最后一个参数是 just`Goal`包装该目标，您也可以改为编写。`setof(t, Goal, _).``_``[t]`

```
?- 长度(X,7), setof(t, wgc([w,w,w,w],X), _)。
X = [山羊，无，卷心菜，山羊，狼，无，山羊]；
X = [山羊，无，狼，山羊，卷心菜，无，山羊]。

```

只要答案是基本答案，这就是有效的。

正如@SergeyDymchenko 建议的那样，明确地在列表中收集解决方案需要为该列表提供一个新的变量名称，并将所有解决方案表示在一个列表中，这可能比将其留给实现更昂贵。然而，在这种具体情况下，并没有本质上的区别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T21:08:02.317

您可以使用`setof`谓词来获取唯一解决方案的列表：

```
setof(X, (length(X,7),wgc([w,w,w,w],X)), Sols).

X = X
Sols = [[goat, nothing, cabbage, goat, wolf, nothing, goat], [goat, nothing, wolf, goat, cabbage, nothing, goat]]
Yes (0.00s cpu) 
```

# algorithm - 什么是数据结构中的卫星信息？

> ID：14551845
> 
> 赞同：17
> 
> 时间：2013-01-27T20:25:47.627
> 
> 标签：algorithm, pointers, data-structures, b-tree

摘自 Thomas Cormen 的算法简介：

"*为简单起见，我们假设，就像我们对二叉搜索树和红黑树所做的那样，与密钥相关的任何“卫星信息”都存储在与密钥相同的节点中。实际上，人们可能会实际存储每个键只是指向另一个磁盘页面的指针，该磁盘页包含该键的卫星信息。本章中的伪代码隐含地假设与键关联的卫星信息或指向此类卫星信息的指针，无论何时移动键，都与键一起传播从一个节点到另一个节点。* ”

所以我一直在尝试用谷歌搜索卫星信息这个词的含义，但我找不到任何东西（被关于 NASA 的东西所涵盖）。我仅基于文本的理解是，“卫星信息”是指向实际键值位置的地址，例如指针？我是正确的还是我误解了它？

编辑：是什么使它与钥匙不同？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-27T20:29:03.830

卫星数据是指您想要存储在数据结构中并且*不*属于数据结构*结构*的任何“有效负载”数据。它可以是你想要的任何东西。它可以是单个值、大量值或指向保存该值的其他位置的指针。

例如，这是一个单链表的列表节点，其卫星数据是一个整数：

```
struct node
{
    node * next;
    int satellite;
}; 
```

换句话说，任何给定数据结构的全部价值在于它包含的数据，这就是你书中术语中的卫星数据。数据结构将额外消耗结构数据（如`next`示例中的指针）以执行定义它的算法，但从用户的角度来看，这些本质上是“开销”。

对于关联容器，“键”值具有双重作用：一方面是用户数据，另一方面也是容器结构的一部分。然而，一棵树可以配备额外的卫星数据，在这种情况下，它成为从关键数据到卫星数据的“地图”。

At one extreme you have a fixed-size array which has *no* overhead and only payload data, and on the other extreme you have complicated structures like multiindexes, tries, Judy arrays, or lockfree containers which maintain a comparably large amount of structural data.

# c# - 处理用户会话和活动状态

> ID：14551848
> 
> 赞同：1
> 
> 时间：2013-01-27T20:26:22.507
> 
> 标签：c#, asp.net, session, authentication

通常我会在成功登录后通过设置会话来处理登录用户。然后在每个请求上检查该会话以确保它存在。

但是，如果我禁用了一个用户帐户并且他们当前已登录，那是什么意思？在这种情况下，用户仍然可以访问系统，直到他们的会话到期。

目前，我正在从数据库中提取每个请求的帐户信息并检查状态字段。我觉得这是很多不必要的开销。在我的场景中，这些帐户中有帐户和用户。因此，我必须检查每个请求的帐户状态以及用户状态。

有没有更好的办法？请注意，我将 SQL Server 会话状态用作多服务器环境。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:36:53.520

在会话开始时将会话 ID 存储在数据库中。当您禁用用户时，只需删除数据库中用户会话 ID 字段中的值。

检查会话 ID 是否与请求时数据库中存储的会话 ID 匹配。

如果没有，session.abandon()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:29:47.620

当您禁用用户帐户时，为什么不删除与该帐户关联的任何会话。然后我们用户访问服务器，会话将不再存在，用户将无权访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:40:58.393

> 你可以使用cookies！Cookie 是最强大的轻量级数据存储！将加密的用户名信息和状态（活动/不活动）存储到 cookie 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T21:29:59.663

在第一个请求之后，您可以实现类似的方法，而不是在每个请求上存储数据`AuthenticationManager.IsAuthorized("user name")`。此方法应返回两个值：

*   真/假（分别是否被授权）。
*   枚举的原因：UserBlocked、Timeout、...

因此，您将检查会话是否在每个请求上仍然有效，并且每次会话开始都会检索一次用户数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T22:10:19.893

如果在您的应用程序中启用，您可以使用匿名标识：

```
<anonymousIdentification enabled="true"/> 
```

你可以得到它：

```
string strId = Request.AnonymousID; 
```

默认是Guid。

AnonymousId 对于每个**用户**都是唯一的，并且您将跟踪您的用户是否通过 IsAuthenticated。

# php - 设置cookie，什么都没有显示

> ID：14551851
> 
> 赞同：0
> 
> 时间：2013-01-27T20:26:31.437
> 
> 标签：php

这直接取自 w3 的网站。我可能没有正确理解 cookie，但为什么没有显示任何内容？

```
$expire=time()+60*60*24*30;
setcookie("user", "Alex Porter", $expire);
echo $_COOKIE["user"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:27:33.323

只有当您刷新页面或导航到新页面时，您的 cookie 才能访问。

当您的脚本加载时，该页面的 HTML 标头字段已经设置好了。在您的 cookie 可供使用之前，该页面需要再次呈现（另一个 HTTP 事务）。检查[PHP 的文档](http://php.net/manual/en/function.setcookie.php)：

> 一旦设置了 cookie，就可以**在下一页加载**时使用 $_COOKIE 或 $HTTP_COOKIE_VARS 数组访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:33:44.323

该变量`$_COOKIE[]`表示脚本开始时的状态。这意味着您必须等待下一页请求才能看到该变量。您也可以手动将变量添加到全局 cookie 变量`$_COOKIE['user] = 'Alex Porter';`中，但问题是您不确定浏览器是否真的接受了 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:37:32.877

检查您的浏览器是否允许 localhost/127.xxx cookie？如果允许，则**刷新页面**。如果您使用的是谷歌浏览器，那么您可以从这里查看所有浏览器 cookie：`chrome://settings/cookies`导航到 localhost/127.xxx 以查看您的代码是否放置了 cookie！

# php - 如何获取客户端的网络？

> ID：14551852
> 
> 赞同：-1
> 
> 时间：2013-01-27T20:26:34.577
> 
> 标签：php

我做了很多挖掘，但仍然无法弄清楚如何让我的访问者“网络”。

在 Google 分析中，我可以很容易地看到这些数据（在受众 > 技术下），但我想用 PHP 来获得它。

任何人都可以分享您关于如何获取这些数据的经验吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:33:50.430

Google Analytic gives you a javascript code so everything that google analytics has is collected client side (browser version, screen size, etc...)

G/A detects client's ip address when browser loads the G/A given javascript code. after that google looks into the ip database and gives you possible location and network name

if you wanna do same in php use ip address and rich IP database

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:31:48.130

Are you talking about browser info, etc?

```
echo $_SERVER['HTTP_USER_AGENT']; 
```

Other [`$_SERVER` indices](http://php.net/manual/en/reserved.variables.server.php).

Also see [`get_browser`](http://php.net/manual/en/function.get-browser.php)

# ajax - wp-load.php & require_once，在 ajax 调用中

> ID：14551862
> 
> 赞同：2
> 
> 时间：2013-01-27T20:27:43.373
> 
> 标签：ajax, wordpress, require-once

我正在开发一个 WP 插件。

目前，我正在使用 jquery 对插件文件夹中的独立 php 文件进行 ajax 调用。
假设这个文件名为**test.php**。

在此调用之前未加载该文件，因此该文件中没有本机 wordpress 函数。

结果，我`require_once('wp.load');`在test.php中。

以下是我的问题：

1.  我需要 wordpress 的唯一功能是 $wpdb->insert。有比 wp-load 更好的功能吗？不包括这么多的东西，因为我只需要这个功能！

2.  我了解 require_once 仅在尚未加载文件的情况下才加载文件。也许我忽略了这种情况，但是这如何与 ajax 一起工作？如果有“成功”响应，test.php 是否关闭，因此当再次调用它时，它会`wp-load.php`再次加载吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:33:28.043

> 如果有“成功”响应，test.php 是否关闭，因此当再次调用它时，它会再次加载 wp-load.php 吗？

确切地。[`require_once`](http://php.net/manual/en/function.require-once.php)(or )背后的概念[`include_once`](http://php.net/manual/en/function.include-once.php)是确保您不会同时将相同的函数、类和变量重新加载到*当前正在运行*的相同PHP 代码中：

> `include_once`可用于在特定脚本执行期间可能多次包含和评估同一文件的情况，因此在这种情况下，它可能有助于避免诸如函数重新定义、变量值重新分配等问题。

而且由于 PHP 脚本仅应请求运行，因此您所描述的正是它会如何发生。

也就是说，我不会过度考虑`wp.load`每次需要时加载整体的概念。我怀疑它会导致性能下降，甚至会引起注意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:21:04.017

你应该考虑按照[这个](https://codex.wordpress.org/AJAX_in_Plugins)方法来编写一个 Ajax 驱动的插件。通常不需要创建单独的 PHP 文件并将 WordPress 核心加载到该文件中。仔细阅读，您会发现，这相对容易完成，并且比独立的 PHP 文件更灵活......

# java - While循环不重复

> ID：14551866
> 
> 赞同：0
> 
> 时间：2013-01-27T20:27:58.067
> 
> 标签：java, while-loop

我很难让这个while循环执行。我在没有先重置扫描仪的情况下尝试了它，它会循环但会立即将第二行与第一行一起抛出，因此建议添加扫描仪重置行。现在循环根本不重复......有什么建议吗？我正在查看主程序中的第一个 while 循环，它应该重复整个程序，直到在 empName 字段中输入“退出”。不是嵌套在中间的较小的while循环。

```
 Scanner input;
   empName = " ";
   while (!empName.equals("quit"))
   {
     input = new Scanner (System.in);
     System.out.print( "Enter employee name or enter 'quit' when finished. " );
     empName = myScanner.nextLine();
     hourlyRate = -1;
     while (hourlyRate <= 0)
     {
       System.out.print( "What is their hourly rate? $");
       hourlyRate = myScanner.nextDouble();
       if (hourlyRate <= 0)
       {
           System.out.println( "Value is not valid, please enter an amount above zero.");
       }
     }
     totHours = -1;
     while (totHours <= 0)
     {
         System.out.print( "How many hours did they work? ");
         totHours = myScanner.nextDouble();
         if (totHours <= 0)
         {
            System.out.println( "Value is not valid, please enter an amount above zero.");
         }
     }
     if (totHours > 40.00)//Calculate Pay and Taxes if OT
     {
        otHours = totHours - 40;
        regHours = totHours - otHours;
        otPay = (1.5 * hourlyRate) * otHours;
        regPay = hourlyRate * regHours;
        grossPay = regPay + otPay;
        taxes = grossPay * .13;
        netPay = grossPay - taxes;
//Display OT information
        System.out.print( "Employee name: ");
        System.out.println(empName);
        System.out.print( "Hourly Rate: ");
        System.out.println(money.format(hourlyRate));
        System.out.print( "Regular Hours Worked: ");
        System.out.println(regHours);
        System.out.print( "OT Hours Worked: ");
        System.out.println(otHours);
        System.out.print( "Total Hours Worked: ");
        System.out.println(totHours);
        System.out.println("   ");
        System.out.print( "Regular Pay = ");
        System.out.println(money.format(regPay));
        System.out.print( "Overtime Pay = ");
        System.out.println(money.format(otPay));
        System.out.print( "Gross Pay = ");
        System.out.println(money.format(grossPay));
        System.out.print( "Federal Taxes = ");
        System.out.println(money.format(taxes));
        System.out.println( "   ");
        System.out.print( "Net Pay = ");
        System.out.println(money.format(netPay));
     }
     else //Calculate No OT Pay and Taxes
     {
        grossPay = hourlyRate * totHours;
        taxes = .13 * grossPay;
        netPay = grossPay - taxes;
//Display No OT Information
        System.out.print( "Employee name: ");
        System.out.println(empName);
        System.out.print( "Hourly Rate: ");
        System.out.println(money.format(hourlyRate));
        System.out.print( "Hours Worked: ");
        System.out.println(totHours);
        System.out.println( "   ");
        System.out.print( "Gross Pay = ");
        System.out.println(money.format(grossPay));
        System.out.print( "Federal Taxes = ");
        System.out.println(money.format(taxes));
        System.out.println( "   ");
        System.out.print( "Net Pay = ");
        System.out.println(money.format(netPay));
        System.out.println( "   ");
     }
   String clearBuffer = input.nextLine();
   }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:44:11.713

添加以下块的第三行（在您读取员工姓名的位置）是通过对代码进行最少更改来解决此问题的方法。

```
 System.out.print( "Enter employee name or enter 'quit' when finished. " );
 empName = myScanner.nextLine();
 if(empName.equals("quit")) break; 
```

# php - 在链接上做一个php函数代码

> ID：14551870
> 
> 赞同：0
> 
> 时间：2013-01-27T20:28:17.300
> 
> 标签：php, unlink

我正在寻找一种在单击链接时使用 php 执行功能的方法。我的意思是单击此链接时删除一个项目。我的代码设置如下：

```
$files = glob("upload/*.*");

if(count($files) == 0){
echo "No files present";
} else {
foreach ( $files as $file ) {
    $array = explode("/", $file);
    //echo $array[1] . "<br>";
    echo "<tr>";
    echo "<td>" . $array[1] . "</td>";
    echo '<td><img height="70" width="auto" src=" ' . $file . '" ></td>';
    echo '<td><a href="">Delete item</a></td>';
    echo "</tr>";
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:40:19.730

在您的主脚本中：

```
$files = glob("upload/*.*");
if(!count($files)){
   echo "No files present";
} else {
   foreach ($files as $file) {
      $array = explode("/", $file);
      echo "<tr>";
      echo "<td>" . $array[1] . "</td>";
      echo '<td><img height="70" width="auto" src=" ' . $file . '" ></td>';
      echo '<td><a href="delete.php?file='.rawurlencode($file).'">Delete item</a></td>';
      echo "</tr>";
   }
} 
```

在您的删除脚本中：

```
if (isset($_GET['file']) && $file = rawurldecode($_GET['file'])) {
   if (file_exists('upload/' . $file)) 
      unlink($file);
} 
```

您可能需要传入另一个`$_GET`参数（秘密令牌）以增加安全性 - 否则它会将您的上传目录打开到永久威胁。您可以发送随机`sha1()`散列或系统定义的配置值，并让您的删除脚本期望 40 个字符的字符串。

# php - php date() 警告消息即使在设置 date.timezone 之后

> ID：14551874
> 
> 赞同：0
> 
> 时间：2013-01-27T20:28:38.207
> 
> 标签：php

> **可能重复：**
> [如何修复 PHP 中 date() 的警告”](https://stackoverflow.com/questions/5535514/how-to-fix-warning-from-date-in-php)

我在 chrooted 环境中设置了 PHP（在 android 设备上，但这不应该是问题），并根据需要在使用的 php.ini 中设置了 data.timezone。但是我仍然收到警告消息。

我已经使用 phpinfo() 检查我已经更改了正确的 php.ini 但它仍然给出错误。

这可能是什么原因造成的？我的理解是您在 php.ini 中所做的更改会立即生效，对吗？

如果您需要更多信息，请告诉我！

错误信息：

```
Warning: date(): it is not sage to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function...... 
```

# c++ - Murmurhash3_x86_128 如何处理大于 15 字节的数据？

> ID：14551875
> 
> 赞同：1
> 
> 时间：2013-01-27T20:28:39.910
> 
> 标签：c++, c, hash, murmurhash

我想在没有对手的重复数据删除系统中使用 MurmurHash3。例如，Murmurhash3 将对文件进行哈希处理。

但是我在使用它时遇到问题，这意味着我做错了什么。

Murmurhash3_x86_128() [（源代码）](http://code.google.com/p/smhasher/source/browse/trunk/MurmurHash3.cpp)函数接收四个参数。这是我对它们的理解：

**key** - 要散列的输入数据

**len** - 数据长度

**种子**——种子

**out** - 计算的哈希值

由于这部分代码，运行时它会因分段错误而失败：

```
 void MurmurHash3_x86_128 ( const void * key, const uint32_t len,
                               uint32_t seed, void * out )
    {
     const uint8_t * data = (const uint8_t*)key;
     const uint32_t nblocks = len / 16;
     ...

     const uint32_t * blocks = (const uint32_t *)(data + nblocks*16);

     for(i = -nblocks; i; i++)
     {
            uint32_t k1 = blocks[i*4];
            ...
     }
     ...
    } 
```

因此，如果我的数据长度大于 15 个字节（就是这种情况），则执行此*for 循环*。但是，*块*指向我的数据数组的末尾，然后它开始访问该位置之后的内存位置。解释了分段错误。所以*key*不能只是我的数据数组。

我的问题是：我应该在*关键*参数中输入什么？

* * *

**问题解决了**

在 Mats Petersson 的回答之后，我意识到我的代码有一个错误。我必须是一个 int （签名）并且我没有签名。这就是为什么它向块添加内存位置而不是减去的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:40:15.017

`blocks`指向正在计算的块中 16 个字节的最后一个偶数倍数。

`i`从 -nblocks 开始，并且始终小于零（循环在零处结束）。

因此，假设您有 64 个字节的数据，那么指针`blocks`将指向`data + 64`字节，并且`nblocks`将是`4`.

当我们`k1 = blocks[i*4];`第一次到达时，我们`i = -4`得到索引`-16`——它乘以`sizeof(*blocks)`，即 4（在大多数体系结构中为 int = 4 字节）——所以我们得到`-64`= 的起始地址`data`。

# ruby-on-rails - 我应该使用哪种方法将产品的翻译存储在数据库中？

> ID：14551876
> 
> 赞同：1
> 
> 时间：2013-01-27T20:28:49.157
> 
> 标签：ruby-on-rails, database, internationalization, ruby-on-rails-3.2

我正在创建一个应用程序，产品将由我的客户创建（类似于电子商务网站），所以我显然需要存储在数据库中的翻译描述，我不能强迫我的客户学习 git/yml。

关于如何正确本地化描述（以及最终产品名称）并将它们存储在数据库中，我有两个想法，但如果有一种我应该使用的众所周知的方法，我会很高兴知道它。

第一个想法对我来说似乎最合乎逻辑，但我想让它对我“透明”，我不想到处写连接，所以如果它是正确的，一些关于如何实现这一点的建议是赞赏。

**想法1：** 创建一个数据库表`products`（其中`name`和`description`字段可能设置为默认语言环境），然后是一个`products_translations`包含以这种方式构造的表的表：

```
products_translations
- id
- locale
- product_id
- name
- description 
```

举个例子：`product_translation: { id: 1, locale: 'en', product_id: 3, name: 'toy', description: 'play' }`

但我想访问翻译而不需要到处写很多 IF。所以如果我写 product.name 它应该返回 en 或者它基于当前的语言环境。

*奖励：*是否有任何宝石可以帮助我实现这一目标？

**想法2：**另一个想法是有一个表`name_locale1`，`name_it`等等，但我不喜欢这种方法，因为会污染我的模型对象与字段，我将有一个巨大的表。

但是，通过这种方式，我可以避免加入该对象的每个查询。

如果有一种我不知道的更好的方法（数据库模式或类似方法），那也没关系，我不会被迫只对这两个想法严格，但是我必须在两者之间做出选择，我真的不知道哪个会更好。

**重要提示：**我想将翻译保存在 yml 文件中，动态内容除外，这显然需要在数据库中进行翻译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T21:47:04.517

我同意 PinnyM 的观点，即第一种方法是两种方法中更好的方法，但我强烈建议您实施[Globalize3](https://github.com/svenfuchs/globalize3)，其中大部分结构决策已经为您做出（以及 Fuchs 先生本人），而不是实现您自己的模式）。此外，使用 rails 助手，您只需`product.name`在模型实例上调用类似的东西，gem 就会弄清楚如何在正确的语言环境中显示它，太棒了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:34:17.623

The first approach is the recommended one. As you surmised, the second approach is not as clean and requires more work on the coding end with no real gain since you still have to join on this monster table. To the contrary, the first method requires at most one join, while the second approach requires a join on each attribute you may want to add localization support.

You can simply append a scope on all your product calls such as:

```
scope :for_locale, lambda{|locale| joins(:product_translations).
                                   where(product_translations: {locale: locale || 'en'}) } 
```

and pass in the session locale (or wherever you are storing it).

# msbuild - 我可以在 Visual Studio Express 中加载“有时可移植”的类库项目吗？

> ID：14551881
> 
> 赞同：38
> 
> 时间：2013-01-27T20:29:10.393
> 
> 标签：msbuild, visual-studio-express, portable-class-library

对于[Noda Time](http://noda-time.googlecode.com) 1.1 版，主要目标是构建可移植类库风格，主要是为了支持 Windows Phone 和 Windows Store 应用程序。这意味着失去一些功能，因此我们构建了一个桌面配置和一个 PCL 配置（针对每个调试、发布和“签名发布”）。

为避免处理大量项目文件，所有 6 种配置都存在于同一个项目文件中。[项目文件](https://code.google.com/p/noda-time/source/browse/src/NodaTime/NodaTime.csproj)被定制为生成一个名为“Portability”的属性，该属性设置为“PCL”或“Desktop”，如下所示：

```
<!-- Set the custom Portability property based on configuration -->
<PropertyGroup>
  <Portability Condition="'$(Configuration)' == 'Debug Portable'">PCL</Portability>
  <Portability Condition="'$(Configuration)' == 'Release Portable'">PCL</Portability>
  <Portability Condition="'$(Configuration)' == 'Signed Release Portable'">PCL</Portability>
  <!-- Default to desktop if not explicitly set above -->
  <Portability Condition="'$(Portability)' == ''">Desktop</Portability>
</PropertyGroup> 
```

然后，基于上述属性，我们为便携式和台式机设置了单独的属性组。这就是将项目类型定义为“类库”或“可移植类库”的原因（以及共享的`OutputType`of `Library`）：

```
<!-- Desktop-specific properties -->
<PropertyGroup Condition="'$(Portability)' == 'Desktop'">
  <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
  <TargetFrameworkProfile>Client</TargetFrameworkProfile>
</PropertyGroup>

<!-- PCL-specific properties -->
<PropertyGroup Condition="'$(Portability)' == 'PCL'">
  <MinimumVisualStudioVersion>10.0</MinimumVisualStudioVersion>
  <ProjectGuid>{c78f6992-28d7-45c9-a4c1-6eaa649f3247}</ProjectGuid>
  <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
  <TargetFrameworkProfile>Profile2</TargetFrameworkProfile>
  <ProjectTypeGuids>{786C830F-07A1-408B-BD7F-6EE04809D6DB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
</PropertyGroup> 
```

这通常效果很好 - 我有不同的解决方案配置，所以我可以立即构建和测试所有内容，我只需将每个新`.cs`文件添加到单个项目文件中。所以在 Visual Studio 2012 Professional 下（这是我使用的）我非常高兴。

当我尝试在 Visual Studio Express（VS2010 或 VS2012）中加载解决方案时，问题就出现了。在加载解决方案时，它失败并显示无法加载某些项目的错误，并且构建 PCL 版本的两个项目随后具有如下构建输出：

```
C:\Path\To\NodaTime.csproj : error  :
     The project file 'C:\Path\To\NodaTime.csproj' cannot be opened.

There is a missing project subtype.
     Subtype: '{786C830F-07A1-408B-BD7F-6EE04809D6DB}'
     is unsupported by this installation. 
```

（为清晰起见重新格式化。）这两个项目拒绝加载，因此您甚至无法浏览源代码。

我真的希望即使 Express 用户无法构建 PCL 版本，他们仍然能够加载解决方案、浏览源代码并构建非 PCL 版本。MSBuild 从命令行工作，但这并不友好。

我尝试删除引用 PCL 项目配置的解决方案配置，但这无济于事。奇怪的是，甚至注释掉 XML 元素，如下所示：

```
<!-- 
    <ProjectTypeGuids>(Guids as before)</ProjectTypeGuids>
 --> 
```

无济于事-尽管删除该行确实有效。就好像 Visual Studio 实际上并未将其作为真正的 XML 文件加载。（我没有尝试将带有注释掉元素的版本加载到 VS Pro 中。）

如果需要，我*可以*沿着生成单独的 PCL 项目文件的路线走，但如果可能的话，我真的很想避免它——这会使正常的开发更加痛苦。同样，我*可以*生成仅限 Express 的 PCL 和解决方案文件，但我还是不想这样做 - 只是感觉不对。

虽然理想情况下我希望在 2010 年和 2012 年都支持 VS Express，但如果有一个仅适用于 2012 年的解决方案，那将是一个好的开始。

那么，是否有任何方法可以说服 Visual Studio Express尽管有条件属性组（其条件未满足）引用它不知道的项目类型，但它确实*可以加载项目？*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-29T20:49:16.900

大卫基恩在这里的评论给了我目前正在使用的答案：

> 或完全删除 <ProjectTypeGuid> 元素 - 这将为您选择“便携式”增强功能，例如用于更改目标框架的 UI 等

我已经尝试过了，它就像一个梦一样工作。在已正确安装所有内容的机器上，您甚至可以在 Express 下构建 PCL 版本！我已经验证生成的二进制文件确实是 PCL，而且看起来还不错。

后来我发现我遇到了一些问题，我不会感到惊讶，但目前这对我来说很好。如果没有 Visual Studio 中的增强功能，我可以轻松生活 - 我的项目具有非常不同的构建配置已经让我感到困惑，所以我认为无论如何我并没有得到太多好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T08:54:00.713

正如这里所回答的：
[Visual Studio 2012 Express with Portable Class Library？](http://social.msdn.microsoft.com/Forums/en-US/toolsforwinapps/thread/9c7fe120-14b5-49f8-ad09-f48dc80fa5c4)
在这里：
[使用可移植类库共享功能](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj714086%28v=vs.105%29.aspx)

> Express SKU 不支持可移植类库项目……需要更高的 SKU 才能获得全面支持。当然，二进制文件（例如，将其用作参考）是，而不是项目/源代码支持。

我可以想象有一个简单的原因 - 有不同类型的 VS2012 Express 版本：用于 Windows Phone 开发、桌面应用程序、Windows 8 应用程序......我敢打赌 Windows Phone Express 版本不了解 Windows Phone项目类型，反之亦然。这可能是不支持 PCL 的简单原因。

尽管 Portable Class Libraries 的想法非常好，但它在许多方面仍然非常有限，例如，据我所知，您不能使用 #if xy 进行条件编译。如果您确实必须使用 Visual Studio Express 进行开发，那么最好为每个平台使用具有引用源文件和条件编译的项目。

# python - sqlite查询中的对数函数？

> ID：14551884
> 
> 赞同：9
> 
> 时间：2013-01-27T20:29:17.743
> 
> 标签：python, sqlite

我真的需要`update`使用对数函数对超过 400,000 行执行一次。不幸的是，sqlite 中似乎不存在 SQL 对数函数。有什么方法可以导出对数函数或导入`LOG`函数？

我知道如何做到这一点的唯一另一种方法是我相信通过 python 订购 O(n^2) 。这种方法将花费太长时间（我尝试过，在我的慢速计算机上完成 6% 需要大约 1.5 小时）。

编辑：

我也发现了为什么花了这么长时间。数据库中的主键未标记为主键。所以我使用的代码如下：

```
for row in database:
    ...calculations for the row...
    ...sql update for the specific row which follows:...
    for search_row in database:
        if search_row[id] = row[id]:
            ...update values here... 
```

令人难以置信的低效... O(n^2)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T20:41:10.080

没有内置对数函数；您必须定义自己的功能。

如果您使用的是 Python，则可以同时使用[pysqlite](http://docs.python.org/2/library/sqlite3.html#sqlite3.Connection.create_function)和[APSW](http://apidoc.apsw.googlecode.com/hg/connection.html#apsw.Connection.createscalarfunction)模块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-01-05T12:02:59.840

事实证明，数学函数（包括对数）是在 Sqlite 中实现的，但在 Ubuntu 上的标准 Sqlite 编译中被*禁用*。为了启用它们，您应该[从这里](https://www.sqlite.org/cgi/src/dir?ci=tip)下载 Sqlite 源代码（“获取代码”）并根据说明进行编译（“编译”）。默认情况下将启用必要的选项**-DSQLITE_ENABLE_MATH_FUNCTIONS 。**编译后，您将`sqlite3`在构建目录中获得可执行文件，这应该作为本地文件运行：

```
$ ./sqlite3 <database-file> 
```

在编译之前，我建议安装`readline`，以便历史浏览（箭头）和自动完成在 Sqlite 命令行中正常工作。

```
sudo apt install libreadline-dev 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T20:44:35.450

是什么让你认为它会是`O(n^2)`？如果有的话，它应该是线性的：`O(n)`.

如果您使用自动提交模式，这几乎是它如此缓慢的唯一原因 - 这将导致 SQLite 在每次更新时将缓冲区刷新到磁盘。

如果你开始事务，然后使用 SELECT / UPDATE 循环，最后提交，你的更新应该很快（前提是你的对数函数不是很慢）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-10T21:41:34.177

那些只需要它进行低精度的自然排序（小数后一位小数，并且只精确到小数点后 4 位）但性能良好的人可以使用：

`( (length(count(*) * 1000 / 1000) + length(count(*) * 1258 / 1000) + length(count(*) * 1584 / 1000) + length(count(*) * 1995 / 1000) + length(count(*) * 2511 / 1000) + length(count(*) * 3162 / 1000) + length(count(*) * 3981 / 1000) + length(count(*) * 5011 / 1000) + length(count(*) * 6309 / 1000) + length(count(*) * 7943 / 1000)) / 10.0 - 1.0 )`

我在一个连接中需要它，我对连接的 n:m 表中的条目数的日志感兴趣，因此我使用了“count(*)”，我计算了它的对数。

`... ( ( ( ( (0.0 + length(count(*) * 1000 / 1000) + length(count(*) * 1258 / 1000) + length(count(*) * 1584 / 1000) + length(count(*) * 1995 / 1000) + length(count(*) * 2511 / 1000) + length(count(*) * 3162 / 1000) + length(count(*) * 3981 / 1000) + length(count(*) * 5011 / 1000) + length(count(*) * 6309 / 1000) + length(count(*) * 7943 / 1000)) / 10.0 - 1.0 ) * 10 +1 ) + ( IFNULL(stat.sum * 1.0 / (1848) , 0.9999999) ) ) / ( IFNULL(stat.count,1) + ( ( (0.0 + length(count(*) * 1000 / 1000) + length(count(*) * 1258 / 1000) + length(count(*) * 1584 / 1000) + length(count(*) * 1995 / 1000) + length(count(*) * 2511 / 1000) + length(count(*) * 3162 / 1000) + length(count(*) * 3981 / 1000) + length(count(*) * 5011 / 1000) + length(count(*) * 6309 / 1000) + length(count(*) * 7943 / 1000)) / 10.0 - 1.0 ) *10 +1 ) ) ) as rating, stat.expl as expl from ...`

可以使用任何其他整数变量代替 'count(*)'，只要确保它是整数，或者将其转换为整数。浮动的长度显然对你没有任何好处。

这是一个肮脏的技巧，它使用了一个事实，即 int 的十进制表示的字符串的长度由对数定义，并提取它。但是与计算浮点数的所有数字的对数实现相比，将 int 转换为字符串并计算长度似乎是相当有效的，除了精度只有一位小数的缺点。我能用可移植的 sqlite 语法做的最好。

PS：如果有人对如何提高精度、性能或具有可变对数基数有任何想法（而不是将其固定为以 10 为基数的第一个小数位），请发表评论。

PPS：[http ://sqlfiddle.com/#!7/9aadc/2/0](http://sqlfiddle.com/#!7/9aadc/2/0)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-05-12T13:11:38.643

使用`log10(number)`功能。

对于**反日志**，使用`power(10, number)`函数。

# javascript - ajax请求中的图像未缓存

> ID：14551886
> 
> 赞同：1
> 
> 时间：2013-01-27T20:29:28.273
> 
> 标签：javascript, .htaccess, jquery, caching

在我的网站上，我已在 .htaccess 文件中使用 ExpiresActive On 成功缓存了多个图像（和其他文件类型）

```
ExpiresActive On
ExpiresByType text/html "access plus 1 month"
ExpiresByType text/css "access plus 1 month"
ExpiresByType text/javascript "access plus 1 month"
ExpiresByType image/png "access plus 1 month"
ExpiresByType image/jpeg "access plus 1 month"
ExpiresByType image/jpg "access plus 1 month" 
```

虽然这不适用于从 ajax 请求加载的图像

```
<div id="ajaxBox"></div>

<script>
jQuery.ajax({
    url: 'anotherFile.php',
    success: function(msg) {
        jQuery('#ajaxBox').html(msg);
    }
});
</script> 
```

如果我去 anotherFile.php 本身，那么它会缓存图像。我应该在 .htaccess 文件中运行某种“特殊命令”以缓存通过 ajax 加载的图像吗？

# ios - UIBarButtonItem 外观不适用于 resizableImageWithCapInsets

> ID：14551887
> 
> 赞同：2
> 
> 时间：2013-01-27T20:29:28.397
> 
> 标签：ios, uibarbuttonitem, scaling, appearance

问题：当使用[外观代理设置时，没有按照](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)[resizableImageWithCapInsets](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)的 UIBarButtonItem 背景图像的缩放

我已经建立了一个项目，其中包含一些我想要完成的测试资产。我的 UIBarButtonItem 有一个背景图像和两个图标图像。他们是：

背景（50x34）：

![背景图片](../Images/4b2796d23298168d2b671c0c9d7ddcd9.png)

图标 (30x30)：

![圆形图标](../Images/713a065c5796f545a1daa22efacbc8d7.png) ![方形图标](../Images/b5706af2a07dd6d2b6441c98b0b912db.png)

这些图标是@2x 版本（因此它们是上面列出的大小的两倍），但请放心，我也有项目中的标准资源（大小的一半）

创意，我知道！但问题是——我想在我的按钮背景图像上添加一些额外的填充，以便图标仅缩放背景图像的绿色部分。这是我在 AppDelegate 中的代码：

```
UIImage *bgImage = [[UIImage imageNamed:@"testbutton2"] resizableImageWithCapInsets:UIEdgeInsetsMake(16, 20, 16, 20)];
[[UIBarButtonItem appearance] setBackgroundImage:bgImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

这适用于 UIBarButtonItem 的第一个实例。但是，对于每个后续实例，图像的可调整大小部分都将被完全忽略。一探究竟：

![错误的背景图像](../Images/a7074877a0a8d43cd9c17d4e46a41940.png)

如您所见，在第一个屏幕上，一切都按计划进行。但是，UIBarButtonItem 的每次后续使用都没有正确缩放。

现在，我确实设法解决了这个问题。我必须在 UIBarButtonItem 的每个实例上设置外观。我通过拥有一个所有视图控制器都继承自的通用 UIViewController 超类来做到这一点。在其中，我有以下代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIImage *bgImage = [[UIImage imageNamed:@"testbutton2"] resizableImageWithCapInsets:UIEdgeInsetsMake(16, 20, 16, 20)];

    [self.navigationItem.rightBarButtonItem setBackgroundImage:bgImage
                                                      forState:UIControlStateNormal
                                                    barMetrics:UIBarMetricsDefault];

    [self.navigationItem.leftBarButtonItem setBackgroundImage:bgImage
                                                     forState:UIControlStateNormal
                                                   barMetrics:UIBarMetricsDefault];
} 
```

这会产生以下结果：

![正确的按钮背景](../Images/5ff76bb236dcdb73806ed43da97cc94c.png)

所以我想我找到了解决这个问题的方法，但我仍然对为什么我的原始实现不起作用感到有些困惑。在我看来，外观代理的目的是为了让您不必更改对象的每个单独实例的外观——这正是我最终必须要做的。谁能向我解释这里发生了什么？这是一个错误，还是我做错了什么？

# python - 如何检查给定实体是否存在于数据存储中？

> ID：14551892
> 
> 赞同：1
> 
> 时间：2013-01-27T20:29:51.610
> 
> 标签：python, django, google-app-engine

我正在 Google App Engine 中编写一个 Django 页面，用户可以在其中创建或编辑对象的实例并保存它。因为创建新对象和编辑现有对象的代码（几乎）相同，所以我使用相同的代码进行编辑和创建。该对象称为组。

在视图函数的顶部，如果提供了 id，我会加载 Group 实例，如果没有提供 id，我会创建一个新实例：

```
def group_edit(request, group_id=None):

    if(group_id is None):
        group_inst = Group()
    else:
        group_inst = db.get(db.Key.from_path('Group', int(group_id)))

        if(group_inst is None):
            raise Http404() 
```

然后视图函数的其余部分在 group_inst 上运行，而不知道或关心 group_inst 是新实例还是现有实例。但是，有一个地方我需要知道区别：页面标题。如果用户正在创建一个新组，我想显示“创建组”，否则我想显示“编辑组 - {{ group.name }}”

直观地说，如果对象的键为 None，我将只签入模板：

```
<h1>
    {% if group_inst.key %}
        Edit Group - {{ group_inst.name }}
    {% else %}
        Create Group
    {% endif %}
</h1> 
```

但是，这会引发 NotSavedError。浏览 GAE 文档，我没有看到任何有用的信息。如何检查实例是否有对应的数据存储记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:43:24.933

您应该使用`has_key()`而不是仅仅访问密钥：

```
{% if group_inst.has_key %} 
```

# vba - Powerpoint VBA：如何从 Excel 工作表中获取一行中最后使用的列

> ID：14551894
> 
> 赞同：3
> 
> 时间：2013-01-27T20:30:04.887
> 
> 标签：vba, powerpoint, excel-2003

**问：**如何从 Excel 工作表中获取特定行中最后使用的列。
虽然这是[使用 Excel VBA 的简单任务，](https://stackoverflow.com/questions/6301665/excel-vba-row-number-of-last-cell-with-data)但使用 Powerpoint VBA 更困难。

这是我的 Excel 工作表的示例

![在此处输入图像描述](../Images/270ab81df40c1713dac00dc68a2c7300.png)

**重现步骤**

*   创建并保存一个新的 Excel 工作表，如我上面的示例
*   为 VBA 编辑器打开一个新的 PowerPoint 演示文稿并点击`ALT`+`F11`
*   插入下面的代码并在第 3 行自定义测试 Excel 文件的路径
*   使用每行执行代码行`F8`

```
Sub findlastcolumn()

    Set objExcel = CreateObject("Excel.application")
    Set objWorkbook = objExcel.Workbooks.Open("C:\Users\<USERNAME>\Desktop\data.xls")

    objExcel.Visible = True

    'works in Powerpoint VBA but delivers the wrong column
    lastcol = objWorkbook.Sheets(1).UsedRange.Columns.Count

    'produces an error in Powerpoint VBA
    'but works in Excel VBA, correct column in Excel VBA
    lastcol = objWorkbook.Sheets(1).Cells(1, 254).End(Direction:=xlToLeft).Column

    'produces an error in Powerpoint VBA
    'but works in Excel VBA, and wrong column in Excel VBA too
    lastcol = objWorkbook.Sheets(1).Cells.SpecialCells(xlLastCell).Column

    'wrong column. Powerpoint VBA' find method differs from Excel' find method
    'searchdirection isn't available in Powerpoint VBA
    lastcol = objWorkbook.Sheets(1).Rows(1).Find(what:="*", _ 
        after:=objWorkbook.Sheets(1).Cells(1, 1), searchdirection:=xlPrevious).Column

    objExcel.Quit
    Set objWorkbook = Nothing
    Set objExcel = Nothing

End Sub 
```

**期望的结果：**我想得到 lastcol = 3

我的代码中的注释向您展示了我到目前为止所做的尝试以及它们产生的错误。
我很感谢任何建议。

^(有没有 PowerPoint 2003 标签？哦)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T21:33:16.630

您发布的 Excel 特定代码实际上应该可以工作，并为您提供与在 Excel 中执行它相同的结果。

您收到错误消息的原因很可能是您没有在 Powerpoint VBA 中包含 Excel 参考！您确实使用了后期绑定，因此通常不需要引用此库。但是，VBA 编译器不知道 Excel 常量/枚举的内部值，`xlToLeft`因此`xlLastCell`会`xlPrevious`产生错误！

解决您的问题的两种选择：

1.  在您的参考文献中包含 Microsoft Excel 库
2.  而不是使用 Excel 特定的常量/枚举，只需使用它们的基础数值。为此，请转到 Excel Visual Basic 编辑器。在立即窗口 ( `Ctrl`- `G`) 中，键入`? xlToLeft`- 您将得到结果（在本例中`-4159`）。然后用数字替换 Powerpoint VBA 中的名称，它应该可以工作。（为了更好的代码可读性，我通常将常量的名称留在同一行的注释中，例如

    ```
    lastcol = objWorkbook.Sheets(1).Cells.SpecialCells(11).Column 'xlLastCell = 11

    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-19T21:32:24.160

@nixada，您**可以**从**POWERPOINT** vba 执行此操作：

您需要访问工作簿对象：（假设您在幻灯片 #1 中有 Excel 数据，在图表 #1 上：

```
Set cht = ActivePresentation.Slides(1).Shapes(1).Chart
Set DataWorkBook = cht.ChartData.Workbook 
```

然后你应该使用空白类型得到你的最后一个空白列：

```
LastCol = DataWorkBook.Sheets(1).Cells.SpecialCells(4).Column -1 'xlCellTypeBlanks = 4 
```

那应该给你想要的答案“ **3** ”

*注意*：类型列表可以参考[XlCellType enumeration (Excel)](https://docs.microsoft.com/en-us/office/vba/api/excel.xlcelltype)

**编辑：**使用 xlCellTypeLastCell （= 11：使用范围内的最后一个单元格）***不会给您所需的答案***，就好像使用了一个单元格但现在删除了它的内容，它将被视为该范围内的已用单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:43:26.783

这是你可以做的。*** 附带条件：未经测试的代码。如果这不起作用，请在评论中告诉我 ***

```
Dim r as Range
Dim col = 0
set r = objWorkbook.Sheets(1).Range("A1")
while(** test that r has something in it **)
  col = col + 1
  set r = r.offset(0, 1)
end 
```

我没有方便的设置来确定测试应该是什么——但这应该很容易。关键是这不使用 Powerpoint VBA 不知道的常量（如 xlDown）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T22:37:23.317

如果有人遇到类似问题，我只想发布更正的代码。（感谢[彼得·阿尔伯特](https://stackoverflow.com/a/14552558/935614)）

```
Sub findlastcolumn()

    Set objExcel = CreateObject("Excel.application")
    Set objWorkbook = objExcel.Workbooks.Open("C:\Users\<USERNAME>\Desktop\input data.xls")        
    objExcel.Visible = True
    icolumn = 1 'which column should be checked (in sheet 1) 

    'works
    Set r = objWorkbook.Sheets(1).Cells(icolumn, objWorkbook.Sheets(1).Columns.Count)
    Do: Set r = r.offset(0, -1)
    Loop While r.Value = ""
    lastcol1 = r.Column

    'works
    lastcol2 = objWorkbook.Sheets(1).Cells(icolumn, _ 
       objWorkbook.Sheets(1).Columns.Count).End(Direction:=-4159).Column

    'works
    lastcol3 = objWorkbook.Sheets(1).Rows(icolumn).Find(what:="*", _
        after:=objWorkbook.Sheets(1).Cells(1, 1), searchdirection:=2).Column

    'works - but not if your columns have different last cells
    lastcol4 = objWorkbook.Sheets(1).UsedRange.Columns.Count

    'works - but not if your columns have different last cells
    lastcol5 = objWorkbook.Sheets(1).Cells.SpecialCells(11).Column

End Sub 
```

# ios - 如何本地化 iOS 的 AddressBook 框架中定义的 NSString？

> ID：14551896
> 
> 赞同：0
> 
> 时间：2013-01-27T20:30:07.800
> 
> 标签：ios, localization

如何本地化系统框架中定义的 NSString 的值？

eg:`NSString *kABPersonAddressStreetKey`是在框架中定义的`AddressBook`，它的值是`Street`.

# javascript - 在创建节点之前计算绘制的 SVG 路径

> ID：14551897
> 
> 赞同：0
> 
> 时间：2013-01-27T20:30:18.727
> 
> 标签：javascript, svg, jquery-svg

我想在创建节点之前计算并显示绘制路径的长度。其背后的想法是让用户在创建之前查看每个路径段的长度，以便知道将节点准确放置在哪里。

我一直在使用 gettotallength 方法，但这会在单击节点后计算路径的长度，使用户只能查看他已经创建的路径的长度。

我正在使用 jQuery。

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:58:05.073

如果它是从最后绘制点到鼠标点的线，则使用基本数学 = SQRT((x1-x2)^2 + (y1-y2)^2)

唯一的技巧是将屏幕坐标转换为用户坐标。这是我使用的一个功能非常好（到目前为止）......

```
function getMousePos(evt) 
{
    var svgPoint = document.documentElement.createSVGPoint();

    evt = evt || window.event;

    if (typeof evt.pageX != 'undefined') // Firefox
    {
      svgPoint.x = evt.pageX;
      svgPoint.y = evt.pageY;
    }
    else // IE et al
    {
      svgPoint.x = document.body.scrollLeft || document.documentElement.scrollLeft || window.pageXOffset || 0;
      svgPoint.y = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
    }

    return svgPoint.matrixTransform(document.documentElement.getScreenCTM().inverse());
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:34:49.200

只需使元素 visibility="hidden" 或 opacity="0" 使其不可见。如果您想知道最后一段的长度，请测量整个路径，然后测量没有最后一段的路径的不可见副本并减去。

# android - Android - 如何使用 DialogFragment 在单击按钮时打开 AlertDialog？

> ID：14551903
> 
> 赞同：1
> 
> 时间：2013-01-27T20:30:31.963
> 
> 标签：android, android-alertdialog, android-dialogfragment

所以我创建了一个`DialogFragment`.java 文件来显示我的警报对话框。我使用[这里](http://developer.android.com/guide/topics/ui/dialogs.html)的教程来创建一个带有列表的 AlertDialog。

如何在我的 ContactList.java 文件中引用此片段？我从教程中理解为执行此操作的方法似乎不起作用。当我尝试使用 ContactList.java 文件中的以下代码执行 onClick 事件时，我在`getSupportFragmentManager()`. 这是我的片段代码：

```
public class StatusDialogFragment extends DialogFragment {
public Dialog onCreateDialog(Bundle savedInstanceState) {
    // Use the Builder class for convenient dialog construction
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    builder.setTitle(R.string.choose_status);
    builder.setItems(R.array.status_choices,
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    dismiss();
                }
            });
    return builder.create();
} 
```

}

这是我相关的 ContactList.java 文件代码：

```
public class ContactList extends Activity implements OnClickListener {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.activity_contact_list);
    Intent intent = getIntent();

}
public void chooseStatus(View view) {
    DialogFragment newFragment = new StatusDialogFragment();
    newFragment.show(getSupportFragmentManager(), "statuschoice");
} 
```

最后，这是我要打开对话框的按钮的 XML 代码。

```
 <ImageButton
    android:id="@+id/status"  
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/status_available_icon"
    android:onClick="chooseStatus" /> 
```

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:36:37.823

[`FragmentActivity`](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)如果您为 3.0 以下的平台编写代码，则需要扩展兼容性类：

```
public class ContactList extends FragmentActivity implements OnClickListener { 
```

如果没有，请更改`getSupportFragmentManager()`为`getFragmentManager()`

还要确保如果您正在使用`FragmentActivity`，您`StatusDialogFragment`扩展了支持包的兼容性[`DialogFragment`](http://developer.android.com/reference/android/support/v4/app/DialogFragment.html)。

如果不是（意味着您只针对 3.0+），请确保`DialogFragment`您扩展的类**不是**来自支持包。

# php - 从uri检测文件夹路径

> ID：14551904
> 
> 赞同：0
> 
> 时间：2013-01-27T20:30:36.430
> 
> 标签：php, url-rewriting, path

是否有一种可靠且简单的方法来检测 url 中的文件夹路径，而忽略 url 重写的规则？

托管在文件夹中的网站示例`test`：

```
http://www.website.com/test/some/uri/rewritted 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:07:00.830

服务器所做的任何 URL 重写都被设计为对外人不可见。如果您发现如何违反此规则，请立即将错误报告给相关的 Web 服务器。

# jquery - Google Maps Refused to display document because display forbidden by X-Frame-Options

> ID：14551907
> 
> 赞同：0
> 
> 时间：2013-01-27T20:30:50.440
> 
> 标签：jquery, google-maps, iframe

There are quite a few people here that had this problem, but the solutions I found aren't working.

Here is the iframe embed code that I got from Google Maps:

```
<iframe width="640" height="480" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps/ms?msa=0&amp;msid=216410867472561730082.0004d44aa7eec841d333d&amp;ie=UTF8&amp;t=h&amp;ll=40.696778,-73.978543&amp;spn=0.015618,0.027466&amp;z=15&amp;output=embed"></iframe><br /><small>View <a href="https://maps.google.com/maps/ms?msa=0&amp;msid=216410867472561730082.0004d44aa7eec841d333d&amp;ie=UTF8&amp;t=h&amp;ll=40.696778,-73.978543&amp;spn=0.015618,0.027466&amp;z=15&amp;source=embed" style="color:#0000FF;text-align:left">Taskeyo Example 2</a> in a larger map</small> 
```

The console says

```
Refused to display document because display forbidden by X-Frame-Options. 
```

followed by a lot of unsafe JS errors.

The embed code already has &output=embed in it, which seems to be the fix that I need.

Anyone else ever get this error? I only wrapped the iframe in a div (inside a jQuery UI accordion) and it used to work! I appreciate the help.

# sql - Update table using data from other tables (normalization)

> ID：14551915
> 
> 赞同：0
> 
> 时间：2013-01-27T20:32:11.137
> 
> 标签：sql, postgresql, select, insert

I have doubt to mount a query to update and / or add data in a table.

I have a table1 that will be supplied with the following rules:

The **table1** have the same **fields** of **table2** + **status** field to show if the register is active ("A") or inactive ("I").

For each record in table1, check if there are new records in table2

**If the record exists in table2 and the record doens't exist in table1**, includes the information in table 1 - all the fields of that record from table2 + character "A" (active) in the status field.

**If the record exists in table2 and the record exists in table1 too**, I have to compare id_register from table2 with the id_register from table1

**If any data in this row is different**, I have to insert a new row in table1 - all fields from the table2 + character "A" (active) in the *status field* -, **AND** the line that was different in table1 will be update with a character "I" (inactive) in *status field*;

**If the record was deleted in table2**, this row will receive character "I" (inactive) in table1 status field. (Deleted Record = I have to verify the records that exists in table1 and doens't exists in table2)

The records that have no changed will not be updated.

The tables:

## table1

id_register name address phone email date value status

## table2

id_register name address phone email date value

Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T02:24:59.623

在我看来，您正在尝试记录对表的更改。使用触发器这是非常可行的，但出于几个原因，我建议不要这样做。首先，您最近的记录将始终是您在表 2 中的活动记录，因此使用时间戳可以避免更新。

其次，与其自己构建解决方案，我会推荐一个我过去使用过的模块，即[tablelog](http://pgfoundry.org/projects/tablelog/)。这将比尝试自己重新实现它要简单得多。还有更多的眼球和所有这些......

# c++ - 使用 DirectX 渲染单独的纹理

> ID：14551916
> 
> 赞同：0
> 
> 时间：2013-01-27T20:32:14.430
> 
> 标签：c++, directx, textures, directx-9

我敢肯定在某个地方有一个简单的答案。我目前有一个程序可以正确地将 .png 图像渲染为顶点矩形上的纹理。这一切工作正常并正确显示。

我的问题是如何使用单独的图像在屏幕上渲染第二个纹理？最简单/最佳的方式（我知道它们可能不同！）我要添加的第二张图像将用作背景图像。我已经尝试复制 CUSTOMVERTEX 结构、顶点缓冲区、单独的顶点数据、平移矩阵、纹理阶段设置等。对于我想使用的第二个纹理，但我只能在屏幕上成功渲染一个，有些东西被覆盖了。不幸的是，我仍在学习纹理并且缺少正确的方法。甚至需要完全独立的顶点设置吗？

下面的代码反映了我迄今为止的工作代码，将图像显示为覆盖在顶点矩形上的纹理。我应该添加什么来为我的背景设置和渲染单独的纹理？

```
 //////////////////////////////////////////////////////
    // I N V A D E R S
    //////////////////////////////////////////////////////

    #include <Windows.h>    // Windows library (for window functions, menus, dialog boxes, etc)
    #include <d3dx9.h>      // Direct 3D library (for all Direct 3D functions).

    //-----START-----DEFINE GLOBAL ELEMENTS----------//
    LPDIRECT3D9             D3D_Object           = NULL; // Name of the Direct3D Obeject. Used to create the D3DDevice
    LPDIRECT3DDEVICE9       D3D_Device           = NULL; // Name of the rendering device
    LPDIRECT3DVERTEXBUFFER9 g_pVertexBuffer      = NULL; // Buffer to hold vertices for the rectangle
    LPDIRECT3DTEXTURE9      D3D_Tex_Background   = NULL; // The texture for the background
    LPDIRECT3DTEXTURE9      D3D_Tex_Invader      = NULL; // The texture for the invader

    float g_InvaderX = -50, g_InvaderY = 0, g_InvaderZ = 0;  // starting cooordinates of object

    // A structure for our custom vertex type, containing the vertex & texture coordinates
    struct CUSTOMVERTEX
    {
        D3DXVECTOR3 position;   // Vertex coordinates
        FLOAT u, v;             // Texture coordinates
    };

    // The structure of a vertex in our vertex buffer...
    #define D3DFVF_CUSTOMVERTEX (D3DFVF_XYZ | D3DFVF_TEX1)  // it will contain xyz coordinates & a texture

    //////////////////////////////////////////////////////
    // Setup Direct3D
    //////////////////////////////////////////////////////
    HRESULT SetupD3D(HWND hWnd)     
    {
        // Create the D3D object.
        if (NULL == (D3D_Object = Direct3DCreate9(D3D_SDK_VERSION))) return E_FAIL;

        // Set up the structure used to create the D3D Device
        D3DPRESENT_PARAMETERS d3dpp;
        ZeroMemory(&d3dpp, sizeof(d3dpp));
        d3dpp.Windowed = TRUE;                      // application will be windowed
        d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;   // back to front buffer behavior - DISCARD = random data used for error checking
        d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;    // back buffer format - UNKNOWN = use current display resolution to retain consistency
        d3dpp.EnableAutoDepthStencil = TRUE;        // D3D device to create and manage depth and stencil buffer automatically
        d3dpp.AutoDepthStencilFormat = D3DFMT_D16;  // format of the surfaces which hold the depth & stencil buffers - D16 = 16Bit colours

        // Create the D3D Device - on successful completion return a pointer to the created device D3D_Device
        if (FAILED(D3D_Object->CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWnd,
                                        D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                                        &d3dpp, &D3D_Device)))
        {
            return E_FAIL;      // return error if D3D Device creation has failed
        }

        return S_OK;
    }

    //////////////////////////////////////////////////////
    // DIRECT3D CLEANUP
    //
    // Release (delete) all the resources used by this program.
    // Only release things if they are valid (i.e. have a valid pointer).
    // If not, the program will crash at this point.
    //////////////////////////////////////////////////////
    void CleanUp()
    {
        // Delete the textures
        if (D3D_Tex_Background != NULL)  D3D_Tex_Background -> Release();
        if (D3D_Tex_Invader != NULL)     D3D_Tex_Invader -> Release();

        // Release other D3D Device resources
        if (g_pVertexBuffer != NULL) g_pVertexBuffer -> Release();
        if (D3D_Device != NULL)      D3D_Device -> Release();
        if (D3D_Object != NULL)      D3D_Object  -> Release();
    }

    //////////////////////////////////////////////////////
    // Setup the camera
    //////////////////////////////////////////////////////
    void SetupMatrices()
    {
        // Setup View Matrix
         D3DXVECTOR3 vCamera(5.0f, 5.0f, -100.0f);  
         D3DXVECTOR3 vLookat(5.0f, 5.0f, 0.0f);
         D3DXVECTOR3 vUpVector(0.0f, 1.0f, 0.0f);
         D3DXMATRIX matrixView;
         D3DXMatrixLookAtLH(&matrixView, &vCamera, &vLookat, &vUpVector);
         D3D_Device -> SetTransform(D3DTS_VIEW, &matrixView);

         // Setup Projection Matrix
         // This transforms 2D geometry into a 3D space
         D3DXMATRIX matrixProjection;
         D3DXMatrixPerspectiveFovLH(&matrixProjection, D3DX_PI/4, 1.0f, 1.0f, 800.0f);
         D3D_Device -> SetTransform(D3DTS_PROJECTION, &matrixProjection);
    }

    //////////////////////////////////////////////////////
    // SETUP GEOMETRY - 
    // Define a square using the required verticies
    //////////////////////////////////////////////////////
    HRESULT SetupGeometry()
    {
        // Calculate the number of vertices required for the desired graphic
        int Vertices = 2 * 3;   // Six vertices required for the 2 triangles which make up the square.

        // Calculate the size in bytes of the buffer which will hold the vertex information
        // based on the number of verticies required and the elements contained within the CUSTOMVERTEX structure
        int BufferSize = Vertices * sizeof(CUSTOMVERTEX);

        // Create the vertex buffer which will store the vertex data to render
        // (buffer size, special instructions, vertex buffer format, target memory location for buffer,pointer to vertex buffer, future use only)
        if (FAILED(D3D_Device -> CreateVertexBuffer(BufferSize, 0, D3DFVF_CUSTOMVERTEX, D3DPOOL_DEFAULT, &g_pVertexBuffer, NULL)))
        {
            return E_FAIL; // if the vertex buffer could not be created.
        }

    //////////////////////////////////////////////////////
    // Fill vertex buffer with required vertex & texture info
    //////////////////////////////////////////////////////
        CUSTOMVERTEX *pVertices;            // Create a pointer to the first vertex in the buffer.
        if (FAILED(g_pVertexBuffer -> Lock(0, 0, (void**)&pVertices, 0)))  // lock the buffer to prevent interference, allow access using the
        {                                                                  // &pVerticies pointer

            return E_FAIL;  // if the pointer to the vertex buffer could not be established.
        }

        // Fill the vertex buffers with data concerning both vertex and texture locations

        // Triangle 1
        // Vertex 0
        pVertices[0].position.x = 0;    // Vertex coordinates
        pVertices[0].position.y = 0;
        pVertices[0].position.z = 0;
        pVertices[0].u        = 0;      // texture coordinates
        pVertices[0].v        = 1;

        // Vertex 1
        pVertices[1].position.x = 0;
        pVertices[1].position.y = 10;
        pVertices[1].position.z = 0;
        pVertices[1].u        = 0;
        pVertices[1].v        = 0;

        // Vertex 2
        pVertices[2].position.x = 10;
        pVertices[2].position.y = 0;
        pVertices[2].position.z = 0;
        pVertices[2].u        = 1;
        pVertices[2].v        = 1;

        // Triangle 2
        // Vertex 3
        pVertices[3].position.x = 10;
        pVertices[3].position.y = 0;
        pVertices[3].position.z = 0;
        pVertices[3].u        = 1;
        pVertices[3].v        = 1;

        // Vertex 4
        pVertices[4].position.x = 0;
        pVertices[4].position.y = 10;
        pVertices[4].position.z = 0;
        pVertices[4].u        = 0;
        pVertices[4].v        = 0;

        // Vertex 5
        pVertices[5].position.x = 10;
        pVertices[5].position.y = 10;
        pVertices[5].position.z = 0;
        pVertices[5].u        = 1;
        pVertices[5].v        = 0;

        // Unlock the vertex buffer...
        g_pVertexBuffer -> Unlock();

        return S_OK;
    }

    //////////////////////////////////////////////////////
    // Load the textures for the invaders and background
    //////////////////////////////////////////////////////
    void LoadTextures()
    {
            //D3DXCreateTextureFromFile(D3D_Device,         // Direct3D Device name
            //                        "background.jpg",     // Source file in program folder
            //                        &D3D_Tex_Background);     // address of target texture object

            D3DXCreateTextureFromFile(D3D_Device, 
                                      "invader300x300.png", 
                                      &D3D_Tex_Invader);        
    }

    //////////////////////////////////////////////////////
    // Render
    //////////////////////////////////////////////////////
    void Render()
    {
        // Clearing the current frame & Z buffers
        // (rectangles to clear, rectangle coords, clear current buffer & Z buffer, RGB background colour of screen, initial z buffer value, initial
        // stencil buffer value)
        D3D_Device -> Clear(0, NULL, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, D3DCOLOR_XRGB(0, 0, 0), 1.0f, 0);

        // Once current frame has been cleared, begin drawing new frame
        // lock is created at this point to prevent anything else drawing on the frame
        if (SUCCEEDED(D3D_Device -> BeginScene()))
        {   

            // Construct a translation matrix to move the Invader
            D3DXMATRIX TranslateMatrix;
            D3DXMatrixTranslation(&TranslateMatrix, g_InvaderX, g_InvaderY, g_InvaderZ);
            D3D_Device -> SetTransform(D3DTS_WORLD, &TranslateMatrix);

            // Render the contents of the vertex buffer.
            D3D_Device -> SetStreamSource(0, g_pVertexBuffer, 0, sizeof(CUSTOMVERTEX));
            D3D_Device -> SetFVF(D3DFVF_CUSTOMVERTEX);
            D3D_Device -> DrawPrimitive(D3DPT_TRIANGLELIST, 0, 2);

            // Select the invader texture, and initialise the texture stage state...
            D3D_Device -> SetTexture(0,                 // the texture stage being set
                                     D3D_Tex_Invader);  // the object associated with the texture image
            D3D_Device -> SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
            D3D_Device -> SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);

            // Update the invader's x co-ordinate.
            //if (g_RectX <=14.5)                           
            g_InvaderX += 0.5f;

            // Drawing of the scene has finished
            D3D_Device -> EndScene();
        }

        // Present the back frame buffer contents to the screen (front frame buffer swaped with back fram buffer)
        D3D_Device -> Present(NULL, NULL, NULL, NULL);
    }

    //////////////////////////////////////////////////////
    // Windows Message Handling
    //////////////////////////////////////////////////////
    LRESULT WINAPI MsgProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
    {
        switch (msg)
        {
            case WM_DESTROY:
            {
                PostQuitMessage(0);
                return 0;
            }
        }

        return DefWindowProc(hWnd, msg, wParam, lParam);
    }

    //////////////////////////////////////////////////////
    // Create the application window
    //////////////////////////////////////////////////////
    int WINAPI WinMain( HINSTANCE hInst, HINSTANCE, LPSTR, int)
    {
        // Register the window class
        WNDCLASSEX wc = {sizeof(WNDCLASSEX), CS_CLASSDC, MsgProc, 0L, 0L,
                         GetModuleHandle(NULL), NULL, NULL, NULL, NULL,
                         "Invaders", NULL};
        RegisterClassEx(&wc);

        // Create the application window
        HWND hWnd = CreateWindow( "Invaders",           // Window class's name
                                  "I N V A D E R S",    // Title bar text
                                  WS_OVERLAPPEDWINDOW,  // The window style
                                  100,                  // window horizontal position
                                  500,                  // window vertical position
                                  800,                  // window width
                                  800,                  // window height
                                  GetDesktopWindow(),   // the parent window's module
                                  NULL,                 // the window's menu handle
                                  wc.hInstance,         // the instance handle
                                  NULL);

        // Initialize Direct3D
        if (SUCCEEDED(SetupD3D(hWnd)))
        {
            // Create the scene geometry
            if (SUCCEEDED(SetupGeometry()))
            {
                // Load the required texture(s) from files into memeory 
                LoadTextures();

                // Display the window onscreen
                ShowWindow(hWnd, SW_SHOWDEFAULT);
                UpdateWindow(hWnd);

                // Initialse the Viewpoint / Camera based on defined settings
                SetupMatrices();

                // Enter message loop to handle any messages MS Windows sends to the application
                MSG msg;
                ZeroMemory(&msg, sizeof(msg));
                while (msg.message != WM_QUIT)
                {
                    if (PeekMessage(&msg, NULL, 0U, 0U, PM_REMOVE))
                    {
                        TranslateMessage(&msg);
                        DispatchMessage(&msg);
                    }
                    else
                        Render();
                }
            }
        }

        CleanUp(); // release resources used ( delete all dynamically allocated objects)

        UnregisterClass("Server", wc.hInstance);

        return 0;
    }   // end WinMain 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T09:49:45.073

It seems that you need more basic understanding of programming with directx. Try to do some tutorials like [this](http://www.directxtutorial.com/LessonList.aspx?listid=9) or [this](http://www.two-kings.de/tutorials/dxgraphics/), they are quiet useful.

To your specific question: It seems that you want to make a 2D-Game with images that are drawn onto the screen. Therefore it's easier to use the `D3DFVF_XYZRHW` ([doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172559%28v=vs.85%29.aspx)), because so you can render untransformed vertices with 2D-Coordinates. To render the background first draw a fullscreen sized quad with you image applied. After that you render your ships in front of that. If your ship isn't drawed, mabye the Z-Buffering determined that your background is in front of it and clipped it away. For 2D-Games either you deactivate ZBuffering or set the depth in the vertices.

# python - TypeError 'float' 对象在使用 for 循环时不可调用

> ID：14551919
> 
> 赞同：2
> 
> 时间：2013-01-27T20:32:21.827
> 
> 标签：python, methods, numerical

```
# Prototype of N-R for a system of two non-linear equations
#evaluating  functions of two variables
# f(x,y)=1.6 * x ** 2 + 3.6 * x * y - 7.8 * x - 2.6 * y + 5.2
# g(x,y)=0.9 * y ** 2 + 3.1 * x **2 - 6.2 * x + 6.2 * y

# x = 0.5
# y =0.4

from math import *

eq1 = raw_input('Enter the equation 1: ')
eq2 = raw_input('Enter the equation 2: ')
x0 = float(input('Enter x: '))
y0 = float(input('Enter y: '))

def f(x,y):
    return eval(eq1)

def g(x,y):
    return eval(eq2)

Ea_X = 1
x = x0
y = y0

for n in range(1, 8):

    a = (f(x + 1e-06, y) - f(x,y)) / 1e-06   #in this one start the trouble
    b = (f(x, y + 1e-06) - f(x,y)) / 1e-06
    c = 0 - f(x,y)
    d = (g(x + 1e-06, y) - g(x,y)) / 1e-06
    eE = (g(x, y + 1e-06) - g(x,y)) / 1e-06
    f = 0 - g(x,y)

    print "f(x, y)= ", eq1
    print "g(x, y)= ", eq2
    print """x   y """
    print x, y
    print """a   b   c   d   e   f """
    print a, b, c, d, e, f

    print """
    a * x + b * y = c
    d * x + e * y = f
    """

    print a," * x  +  ",b," * y  =  ",c
    print d," * x  +  ",eE," * y  =  ",f

    _Sy = (c - a * f / d) / (b - a * eE / d)
    _Sx = (f / d) - (eE / d) * _Sy

    Ea_X = (_Sx ** 2 + _Sy ** 2)**0.5

    x = x + _Sx
    y = y + _Sy

    print "Sx = ", _Sx
    print "Sy = ", _Sy

    print "x = ", x
    print "y = ", y

    print "|X_1 - X_0| = ", Ea_X 
```

我一直在为两个非线性方程测试 Newton-Rapson 方法，原型代码有效，但后来我想让它更有用，因为原型是关于 2 个方程的输入和第一次猜测，它最好实现一个 for 循环，而不是启动像 6 或 10 这样的过程来解决我正在使用的众多方程中的一个

```
# Prototype of N-R for a system of two non-linear equations
# f(x,y)=1.6 * x ** 2 + 3.6 * x * y - 7.8 * x - 2.6 * y + 5.2
# g(x,y)=0.9 * y ** 2 + 3.1 * x **2 - 6.2 * x + 6.2 * y

# x = 0.5
# y =0.4

# evaluating  functions of two variables

from math import *

eq1 = raw_input('Enter the equation 1: ')
eq2 = raw_input('Enter the equation 2: ')
x0 = float(input('Enter x: '))
y0 = float(input('Enter y: '))

def f(x,y):
    return eval(eq1)

def g(x,y):
    return eval(eq2)

Ea_X = 1
x = x0
y = y0

a = (f(x + 1e-06, y) - f(x,y)) / 1e-06
b = (f(x, y + 1e-06) - f(x,y)) / 1e-06
c = 0 - f(x,y)
d = (g(x + 1e-06, y) - g(x,y)) / 1e-06
eE = (g(x, y + 1e-06) - g(x,y)) / 1e-06
f = 0 - g(x,y)

print "f(x, y)= ", eq1
print "g(x, y)= ", eq2
print """x   y """
print x, y
print """a   b   c   d   e   f """
print a, b, c, d, e, f

print """
a * x + b * y = c
d * x + e * y = f
"""

print a," * x  +  ",b," * y  =  ",c
print d," * x  +  ",eE," * y  =  ",f

_Sy = (c - a * f / d) / (b - a * eE / d)
_Sx = (f / d) - (eE / d) * _Sy

Ea_X = (_Sx ** 2 + _Sy ** 2)**0.5

x = x + _Sx
y = y + _Sy

print "Sx = ", _Sx
print "Sy = ", _Sy

print "x = ", x
print "y = ", y

print "|X_1 - X_0| = ", Ea_X 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:34:27.330

这是问题所在：

```
f = 0 - g(x,y) 
```

您正在`f`从一个函数重新绑定到一个`float`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T20:35:24.353

在行

```
f = 0 - g(x,y) 
```

您为名称分配一个数字`f`。由于函数和其他变量在 Python 中共享一个命名空间（函数只是一个可调用对象，绑定到任何变量），这使得未来的迭代失败。为您在上述行中分配的值选择另一个名称。

# ios - Xcode 在 iPhone 上最小运行的构建设置

> ID：14551920
> 
> 赞同：-1
> 
> 时间：2013-01-27T20:32:24.353
> 
> 标签：ios, xcode

我终于到了需要为我的 iphone 应用程序设置构建设置的地步。我想让我的应用程序在 4.3 到 6.0.1 以及从 iPhone 3gs 到 5 的设备上运行。

目标的以下构建设置是否有效且正确？请注意，我已将 armv7 更改为 armv6。我应该再次更改它还是这样保留它是否安全？

我还应该将 armv6 添加到 Valid Architercures（appstore 方案）吗？

![设置](../Images/828f3b44fea53ed7af9bc5cc5107f778.png)

![设置](../Images/d8f7e26233c36898826bc14856562be4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:40:38.927

您需要像 iPhone 3GS 一样为 armv7 和 armv7s 设置有效架构​​，并且其他设备支持 armv7。iPhone 3G 有 armv6，所以不要使用它，因为你不支持 iPhone 3G。

此外，您的 iOS 目标设置为 iOS 4.3 是正确的。

希望这些信息对你有帮助..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:36:40.797

3gs 可以很好地运行 armv7 那你为什么需要它呢？

# c# - No matching constructor found on type

> ID：14551921
> 
> 赞同：9
> 
> 时间：2013-01-27T20:32:33.263
> 
> 标签：c#, silverlight, windows-phone-7, xaml, exception-handling

I'm making Windows Phone 7.1 app with Visual Studio Express 2012 for Windows Phone.

I added this namespace to MainPage.xaml:

```
xmlns:myNameSpace="clr-namespace:MyApp" 
```

And this:

```
<Grid.Resources>
        <myNameSpace:MyClass x:Key="referenceToMyClass" />
</Grid.Resources> 
```

And used like this in same file:

```
<ListBox Name="MyListBox"
         Height="{Binding ElementName=ContentPanel, Path=Height}"
         Width="{Binding ElementName=ContentPanel, Path=Width}"
         ItemsSource="{StaticResource referenceToMyClass}"
         DisplayMemberPath="MyAttribute" /> 
```

MyClass looks like this:

```
namespace MyApp
{
    class MyClass : ObservableCollection<AnotherClass>
    {
        public MyClass()
        {
            Class temp = new AnotherClass("Example attribute");
            Add(temp);
        }

        public void AddAnotherClass(AnotherClass anotherClass)
        {
            Add(anotherClass);
        }
    }
} 
```

So when I try to Debug it on my cellphone I get the following error:

> A first chance exception of type 'System.Windows.Markup.XamlParseException' occurred in System.Windows.dll Additional information: No matching constructor found on type 'MyApp.MyClass'.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-27T20:54:48.073

这是因为您的课程不公开。应该

```
public class MyClass : ObservableCollection<AnotherClass> 
```

XAML 无法绑定到非公共对象/类/属性

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-14T06:18:27.217

当您的代码`MissingMethodException`在 xaml 对象的构造函数中引发 a 时，您也可能会遇到此异常：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        var t = Activator.CreateInstance(typeof(T), typeof(int)); // Missing constructor
        // or:
        //this.GetType().InvokeMember("NonExistingMember", BindingFlags.Public | BindingFlags.Instance | BindingFlags.InvokeMethod, null, this, new object[0]);
    }
}

public class T
{} 
```

xaml 解析器错误地报告`MainWindow`找不到类的构造函数。查看抛出异常的“内部异常”揭示了失败的真正原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-24T16:16:29.230

我正在添加这个答案，希望它能为那些遇到与我相同的特定问题的人提供一些帮助：

TeamCity 未能构建多个报告 resgen.exe 错误的依赖 SilverLight 项目，并且普遍存在的通用错误代码根本无法提供任何洞察力。

我将 SilverLight 项目从 v3 升级到允许 TeamCity 构建的 v5，但是其中一个 SilverLight 屏幕无法显示任何内容，使用 FireFox 没有报告错误。

通过使用 Visual Studio 2010 和 IE 进行调试，我得到了与 OP 相同的错误消息，但它在调用 InitializeComponent() 时发生了变化，但不同之处在于该类已经公开？！

问题是升级后的项目在 resource.resx 文件方面存在问题，在将它们完全从 SilverLight 项目中删除后，整个事情都按预期工作。

# mysql - conditional mysql operation in shell script

> ID：14551924
> 
> 赞同：0
> 
> 时间：2013-01-27T20:32:56.203
> 
> 标签：mysql, bash, shell, unix

I have the following shell script which writes volumes in a `find` command to a file, and loads that file into a mysql database:

```
# find all the paths and print them to a file
sudo find $FULFILLMENT/ > $FILE
sudo find $ARCH1/ >> $FILE
sudo find $ARCH2/ >> $FILE
sudo find $MASTERING/ >> $FILE

# load the file into the mysql database, `files`, table `path`
/usr/local/bin/mysql -u root files -e "TRUNCATE path"
/usr/local/bin/mysql -u root files -e "LOAD DATA INFILE '/tmp/files.txt' INTO TABLE path" 
```

`TRUNCATE` is to be used to delete all the old entries before adding the new. However, if **any** of the `find` commands don't work (for example, if the volume isn't accessible), I want it to skip on the two `mysql` commands. How would I modify the above script to do this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T22:01:39.040

This will execute your two `mysql` commands only if all the `find` commands succeed:

```
# find all the paths and print them to a file
sudo find $FULFILLMENT/ > $FILE &&
sudo find $ARCH1/ >> $FILE &&
sudo find $ARCH2/ >> $FILE &&
sudo find $MASTERING/ >> $FILE &&
{
  # load the file into the mysql database, `files`, table `path`
  /usr/local/bin/mysql -u root files -e "TRUNCATE path"
  /usr/local/bin/mysql -u root files -e "LOAD DATA INFILE '/tmp/files.txt' INTO TABLE path"
} 
```

The `&&` operator causes the command on the RHS to run only if the command on the LHS succeeds. The `{ ... }` groups the two `mysql` commands into one compound command, so either both run (if the last `find` succeeds) or neither does (if the last `find` does not succeed).

You can use this if there is more to your script that should run whether or not the `find`s succeed and the `mysql` commands run.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:39:24.103

Something like:

```
sudo find $FULFILLMENT > $FILE || exit 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T20:53:18.773

You can use `#!/bin/bash -e` or add a line with `set -e` above the find commands. That way, Bash will automatically abort as soon as a command fails. It's good practice to always do this by default, since you rarely want to continue when the previous command fails:

```
set -e

# find all the paths and print them to a file
sudo find $FULFILLMENT/ > $FILE
sudo find $ARCH1/ >> $FILE
sudo find $ARCH2/ >> $FILE
sudo find $MASTERING/ >> $FILE

# load the file into the mysql database, `files`, table `path`
/usr/local/bin/mysql -u root files -e "TRUNCATE path"
/usr/local/bin/mysql -u root files -e "LOAD DATA INFILE '/tmp/files.txt' INTO TABLE path" 
```

# cakephp - foreign keys incongruity to save in cakephp

> ID：14551925
> 
> 赞同：0
> 
> 时间：2013-01-27T20:33:00.797
> 
> 标签：cakephp, database-design, cakephp-2.0, cakephp-2.1

![database design](../Images/76f4473c4f1fb24d99fb4af7a7f22746.png)

I have this problem when I create phps with cake bake In cakephp.I have the following problem: if I keep **two elements in libraries**, one with id 1 and othe id 2.then I saved an item in **rooms with library_id= 1**,and after another item in **rooms with library_id= 2**. I really can relate **room element with the element of user**. This should not afford it since they have the same library_id.So it does not refer to the same library. I need only user can relate to room if they refer to the same library.**I try that cakephp throws error, or do not allow the relationship, when users and rooms not have the same library_id,how I can do this?**

**result tables:**

```
libraries         users               rooms                 users_rooms
id            id   library_id       id   library_id        user_id   room_id
1             1       1             1       2                1           1
2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T13:44:28.637

> 如果他们引用同一个库，我只需要用户可以与房间相关联。我怎么能这样做？

通常，菱形的两个“边”必须从“底部”到**同一个**“根”的菱形依赖关系需要使用识别关系：

![在此处输入图像描述](../Images/06dfd23867b1ff95f0eeac48d3bf944e.png)

请注意如何`library_id`从“根”迁移到菱形的“两侧”，然后在表中的“底部”**合并**`users_rooms`。这样，如果用户连接到房间，他们都必须连接到同一个库。

不幸的是，我不熟悉 CakePHP，所以我不知道它是否支持这一点。

# magento - Magento newsletter_subscriber change_status_at

> ID：14551928
> 
> 赞同：1
> 
> 时间：2013-01-27T20:33:30.813
> 
> 标签：magento

I've been looking for a while at other threads, several have been close to what I need but not quite.

When a guest or customer sign up for our newsletter the field change_status_at populates with a timestamp.

However, if the guest or customer unsubscribe, we would like the the change_status_at field to pickup the current timestamp.

This is important to use because we do not use the newsletter "feature" of Magento 1.7.0.2 CE. Rather we export the newletter_subscriber list to a company to send an email.

Thank you,

Dan

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T21:41:00.097

我也遇到了这个。客户想知道订阅/取消订阅操作发生的日期。环顾互联网，我发现其他一些人遇到了这个问题，有些人声称它曾经在非常旧的 Magento 版本中工作。

我认为发生的事情是 change_status_at 的字段定义曾经设置为自动更新为默认时间戳（即 ON UPDATE CURRENT_TIMESTAMP），但在某些更新中丢失了。所以没有写入该字段的 Magento 代码，因为 MySql 应该神奇地维护它。

您可以尝试更新表定义以重新添加 ON UPDATE CURRENT_TIMESTAMP（但我不赞成更改默认模型表）或添加另一个字段作为默认时间戳字段。

或者更好的解决方案是创建一个带有观察者的模块，以便在订阅更改时添加日期。这可能看起来像（警告 - 此代码只是一个示例，由于删除我的模块信息可能存在一些语法错误） -

应用程序/代码/本地/Myco/MyMod/etc/config.xml

```
<?xml version="1.0"?>

<config>

    <modules>
        <Myco_MyMod>
            <version>1.0.0</version>
        </Myco_MyMod>>
    </modules>

    <global>
        <models>
            <myco>
                <class>Myco_MyMod_Model</class>
            </myco>
        </models>

       <events>
            <newsletter_subscriber_save_before>
                <observers>
                    <mycomymod_observer_subscriber>
                        <type>singleton</type>
                        <class>Myco_MyMod_Model_Observer</class>
                        <method>setUpdateDate</method>
                     </mycomymod_observer_subscriber>
                </observers>
            </newsletter_subscriber_save_before>
        </events>
    </global>
</config> 
```

===========

在 app/code/local/Myco/MyMod/Modules/Observer.php

```
<?php

class Myco_MyMod_Model_Observer
{

    public function setUpdateDate(Varien_Event_Observer $observer) {
        $subscriber = $observer->getSubscriber();
        $subscriber['change_status_at'] = (date("Y-m-d H:i:s", time()));
    }
} 
```

# c++ - 时髦的 OpenGL 立方体

> ID：14551929
> 
> 赞同：0
> 
> 时间：2013-01-27T20:33:31.637
> 
> 标签：c++, opengl, blending, cubes

啊哈！看来我的问题是我给 gluPerspective 的 zNear 值必须大于 0，并且我必须启用深度缓冲区才能使其工作。我已经更新了下面的代码以使其正常工作。

我已经尝试过很多次，并且一直认为我以错误的顺序定义了我的四边形顶点，但现在，我知道它是另外一回事了。

我试过启用剔除，将frontFace更改为顺时针，禁用混合，添加法线，但我总是得到一个看起来像这样的立方体；

![立方体是什么样子的](../Images/af4576479517e44011058811c97cefd4.png)

希望您甚至不必查看我的代码即可知道问题所在，因为这样得到它并不难。

如果您不立即知道问题出在哪里，这里是用于设置和绘制立方体的代码。

```
// FIXED CODE.
// reshape, called on init, and window resize
void reshape(int w, int h) {
     scrw=w;
     scrh=h;
     glClearColor(0.8,0.8,0.8,1.0);
     glMatrixMode(GL_PROJECTION);
     glLoadIdentity();
     gluPerspective(cfov,(float) scrw/ (float) scrh,1,1000); // this is also a part of the fix.
     glMatrixMode(GL_MODELVIEW);
     glLoadIdentity();
     glEnable(GL_BLEND);
     glEnable(GL_DEPTH_TEST); // this is a part of the fix
     glEnable(GL_CULL_FACE);
     glCullFace(GL_FRONT);
     glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);
     glViewport(0,0,scrw,scrh);
}
// drawQuadCube(), called every frame.
void drawQuadCube() {
     glPushMatrix();
     glTranslated(0.5,0.5,0.5);
     glRotated(xangle,0,1,0);
     glRotated(yangle,1,0,0);
     glRotated(zangle,0,0,1);
     glTranslated(-0.5,-0.5,-0.5);
     glBegin(GL_QUADS);
               //   bottom
               glColor4ub(30,30,255,255);
          glVertex3f(0.0f, 0.0f, 1.0f);
          glVertex3f(1.0f, 0.0f, 1.0f);
          glVertex3f(1.0f, 0.0f, 0.0f);
          glVertex3f(0.0f, 0.0f, 0.0f);
               //   top
               glColor4ub(40,40,255,255);
          glVertex3f(0.0f, 1.0f, 1.0f);
          glVertex3f(1.0f, 1.0f, 1.0f);
          glVertex3f(1.0f, 1.0f, 0.0f);
          glVertex3f(0.0f, 1.0f, 0.0f);
               //   left
               glColor4ub(60,60,255,255);
          glVertex3f(0.0f, 0.0f, 1.0f);
          glVertex3f(0.0f, 0.0f, 0.0f);
          glVertex3f(0.0f, 1.0f, 0.0f);
          glVertex3f(0.0f, 1.0f, 1.0f);
               //   right
               glColor4ub(60,60,200,255);
          glVertex3f(1.0f, 0.0f, 1.0f);
          glVertex3f(1.0f, 0.0f, 0.0f);
          glVertex3f(1.0f, 1.0f, 0.0f);
          glVertex3f(1.0f, 1.0f, 1.0f);
               //   near
               glColor4ub(70,70,100,255);
          glVertex3f(0.0f, 0.0f, 0.0f);
          glVertex3f(1.0f, 0.0f, 0.0f);
          glVertex3f(1.0f, 1.0f, 0.0f);
          glVertex3f(0.0f, 1.0f, 0.0f);
               //   far
               glColor4ub(20,20,90,255);
          glVertex3f(0.0f, 0.0f, 1.0f);
          glVertex3f(1.0f, 0.0f, 1.0f);
          glVertex3f(1.0f, 1.0f, 1.0f);
          glVertex3f(0.0f, 1.0f, 1.0f);
          glNormal3f(0,0,0);
          glNormal3f(0,0,1);
          glNormal3f(0,1,0);
          glNormal3f(1,0,0);
          glNormal3f(1,0,1);
          glNormal3f(1,1,0);
          glNormal3f(1,1,1);
          glNormal3f(0,1,1);
     glEnd();
     glPopMatrix();

}
// if that isn't enough, this is the function used to set up the view.
void setView(void) {
     glLoadIdentity();
     gluLookAt(0.5,0.5,-5,0.5,0.5,0.5,0,1,0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:26:02.347

你的缠绕模式不正确。

glFrontFace 默认为 GL_CCW，但您的“正面四边形”，在本例中为“近”边，顺时针缠绕（从您的相机位置的参考系开始；注意它位于负 Z，并沿正 Z 看） . `glCullFace`默认为 GL_BACK，因此被剔除。正确设置：

```
glFrontFace(GL_CW); 
```

另见[http://www.opengl.org/sdk/docs/man/xhtml/glFrontFace.xml](http://www.opengl.org/sdk/docs/man/xhtml/glFrontFace.xml)

完成该设置后，您将需要启用深度缓冲，以便您的四边形正确地覆盖而不依赖于绘制顺序。见：[http ://www.opengl.org/archives/resources/faq/technical/depthbuffer.htm](http://www.opengl.org/archives/resources/faq/technical/depthbuffer.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:19:29.080

尝试：

```
 glCullFace(GL_FRONT); 
```

见[http://www.opengl.org/sdk/docs/man/xhtml/glCullFace.xml](http://www.opengl.org/sdk/docs/man/xhtml/glCullFace.xml)

或者：

```
glEnable(GL_CULL_FACE); 
```

见[http://www.opengl.org/sdk/docs/man/xhtml/glEnable.xml](http://www.opengl.org/sdk/docs/man/xhtml/glEnable.xml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-07T01:02:27.957

您没有指定您使用的窗口机制，但如果您使用 glut，请不要忘记在创建窗口时设置 GLUT_DEPTH 标志。这是一个经常被忽视的简单常见错误。

# opengl-es - 将十六进制颜色转换为浮点数

> ID：14551938
> 
> 赞同：0
> 
> 时间：2013-01-27T20:34:03.997
> 
> 标签：opengl-es, hex, rgb

这可能看起来有点傻，但我不知道如何在 glColor4f 中输入所需的颜色。我的意思是，它需要 4 个介于 0.0 ~ 1.0 之间的浮点数，并且我找到的所有颜色都是十六进制或 rgb（介于 0 ~ 255 之间）。

如何使用 glColor4f 进行转换以获取所需的颜色？

我已经尝试过这样做：

```
glColor4f(1/248, 1/50, 1/99); 
```

但这并没有成功。

我正在使用 JAVA 和 OpenGL-ES

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T20:37:28.160

'C' 在整数中进行整数算术运算

`1/248`将向下舍入为零，您需要使用浮点值。ie`1.0/248.0`
但是因为你想将 8bit RGB 转换为 0-1 你需要做`(float)R/255.0`

编辑：在任何语言中， glColor4f() 都需要一个 0-1 范围内的值，其中 0 是黑色，1 是全彩色。要将 0-255 值转换为 0-1 范围，您必须除以 255，而不是取倒数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T06:01:11.250

浮出=（1.0f/255）*颜色；

这适用于 AndEngine ColorParticleModifier

# javascript - 命名空间和对象属性

> ID：14551944
> 
> 赞同：1
> 
> 时间：2013-01-27T20:34:36.907
> 
> 标签：javascript, coding-style, namespaces

作为开发非常简单的 Firefox 插件的一部分，我开始学习 Javascript。Firefox 插件教程建议将所有函数和数据封装在这样的命名空间中。

```
if ("undefined" == typeof(XULSchoolChrome)) {
    var XULSchoolChrome = {};
};

XULSchoolChrome.BrowserOverlay = {
    first_name : new String,
    onmenuclick : function(aEvent) {
        // do something here
    }
}; 
```

我有几个与此相关的问题：

3.  我知道这`XULSchoolChrome`是一个具有名为`BrowserOverlay`. 但是什么是`first_name`和`onmenuclick`？它们是对象的*子属性吗？*`BrowserOverlay`
4.  如果我需要访问`first_name`内部`onmenucick`函数，它必须是完全限定`XULSchoolChrome.BrowserOverlay.first_name`的。对于非平凡的代码，这很快就会变得笨拙。有没有更优雅的方式在 Javascript 中模拟命名空间？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:53:14.887

> 但是什么是 first_name 和 onmenuclick？

是的，它们是对象的`BrowserOverlay`属性，由对象的属性引用`XULSchoolChrome`。

> 有没有更优雅的方式在 Javascript 中模拟命名空间？

不，您总是需要通过对象引用属性。但是，您可以将子命名空间缩写为变量：

```
var bo = XULSchoolChrome.BrowserOverlay;
// then use
bo.first_name…
bo.… 
```

或者您可以使用命名空间对象的“方法”中的[`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)。请注意，这不适用于通常在不同上下文中调用的事件处理函数。

# ruby - 即使将命令作为登录 shell 运行，RVM 也不是函数

> ID：14551950
> 
> 赞同：2
> 
> 时间：2013-01-27T20:34:54.197
> 
> 标签：ruby, rvm

> **可能重复：**
> [无法将 RVM 安装的 Ruby 与 sudo 一起使用](https://stackoverflow.com/questions/3644897/cannot-use-rvm-installed-ruby-with-sudo)

我`sudo rvm use 1.9.3`和其他人一样在执行命令时遇到了同样的“RVM 不是函数......”错误，但尽我所能，我似乎无法解决它。我已经阅读并遵循了所有常见的故障排除技巧，但似乎没有任何效果......

我的系统 --- 操作系统：Ubuntu 12.10 --- Ruby 版本：1.9.3 --- RVM 版本：1.18.3

我已执行以下操作以尝试修复此问题：

1.  检查终端首选项的“标题和命令”选项卡中的“作为登录 shell 运行命令”选项
2.  将以下代码块添加到 ~/.bashrc、~/.bash_profile、~/.zshrc 和 ~/.zprofile `[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"`

    `if test -f ~/.rvm/scripts/rvm; then` `[ "$(type -t rvm)" = "function" ] || source ~/.rvm/scripts/rvm` 菲`

3.  运行`user$ source ~/.rvm/scripts/rvm`然后`user$ type rvm | head -n 1`返回`rvm is a function`。但随后运行`sudo rvm use 1.9.3`返回“RVM 不是函数”

我还能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:15:41.853

你不能运行 rvm `sudo`，sudo 正在运行一个新进程，它破坏了`function`可以改变当前运行 shell 环境的方法。

# sql - SQL Server：计算列 DATEDIFF 子句

> ID：14551952
> 
> 赞同：2
> 
> 时间：2013-01-27T20:34:59.713
> 
> 标签：sql, sql-server, formula, datediff

我想要做的是以下内容：我有 3 列（`Control_OpenDate`, `Control_Record Age`, `Control_Stage2`）。插入行后，它将填充`Control_OpenDate`(01/27/2013) 和`Control_RecordAge`(计算列，请参见公式)。

```
(datediff(day, [Control_OpenDate], getdate())) 
```

这给出了最新的日期。

一切都很完美，但我想`IF`在计算列中添加一个条件，`Control_Stage2`如果没有填充列，则不要计算或添加文本......

*如何`WHERE`在上面的公式中添加 - 语句？*

注意：我将此类公式直接输入到列属性中，我知道有些查询可以做到这一点，但有没有办法通过公式来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T20:54:29.057

这可以使用- 语句来完成，如此[处](https://stackoverflow.com/questions/10700447/computed-column-need-help-writing-statement)`CASE`所示。

您的逻辑将如下所示：

```
(CASE 
    WHEN [Control_Stage2] IS NULL THEN NULL -- or -1 or what you like
    ELSE datediff(day,[Control_OpenDate],getdate())
END) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-13T14:51:15.363

这也可以写成三元语句（[IIF](https://docs.microsoft.com/en-us/sql/t-sql/functions/logical-functions-iif-transact-sql?view=sql-server-ver15)）

*IIF (boolean_expression, true_value, false_value)*

IIF 是编写 CASE 表达式的简写方式。它计算作为第一个参数传递的布尔表达式，然后根据计算结果返回其他两个参数中的任何一个。即如果布尔表达式为真则返回true_value，如果布尔表达式为假或未知则返回false_value

例如

```
iif([Control_Stage2] is null, null, datediff(day,[Control_OpenDate],getdate())) 
```

# ios - Cocos2D - iPhone - 在实例方法中创建时不会显示 Sprite

> ID：14551960
> 
> 赞同：0
> 
> 时间：2013-01-27T20:35:33.723
> 
> 标签：ios, cocos2d-iphone, runtime-error, sprite

所以在我的项目中，我在“Survival.m”类中调用了一个名为“-(void)fire”的实例方法：

```
-(void)fire {

NSLog(@"Firing");

CCSprite *sprite = [CCSprite spriteWithFile:@"bullet.png"];
sprite.position = player.position;
NSLog(@"%@",NSStringFromCGPoint(player.position));

[self addChild:sprite z:100];

} 
```

当我这样做时，精灵不会显示在屏幕上。该方法是从另一层调用的，但由于每次点击按钮时都会记录“Firing”，所以这不是问题。

如果这可能导致任何问题，我也在使用 TMXTiledMap。请帮忙，谢谢！

**编辑 - - - - -**

我可以在另一层 HUDLayer 中创建精灵，但不能在包含玩家和平铺地图的生存层中创建精灵。如果我在“init”方法中创建一个精灵，它可以正常工作，但如果我在“fire”方法中这样做，它就不起作用。正在从 HUDLayer 调用“fire”方法，但我现在仍然在调用该方法，因为我在日志中看到它说“Firing”

会不会是这样： 1\. 精灵是在看不见的地方创建的？2\. 精灵没有被创建？3\. 精灵没有添加到正确的父级？

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:39:09.347

在 cocos2d 中添加一个精灵做这样的事情

```
CCNode *parent = [self getChildByTag:kTagParentNode];
[parent addChild:sprite]; 
```

如果这不能解决问题，请确保添加它的位置在屏幕上，然后尝试更改 z 值以查看是否有帮助

编辑

在你导入文件的地方添加这个

```
enum {
kTagParentNode = 1,
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T18:36:50.077

谢谢大家，以某种神秘的方式解决了它。无论如何感谢您的帮助。我想我以错误的方式声明了该层。祝你今天过得愉快！

# python - 获取 QPolygonF 的顶点

> ID：14551962
> 
> 赞同：1
> 
> 时间：2013-01-27T20:35:52.270
> 
> 标签：python, qt, pyqt4, qgraphicsview, qgraphicsscene

我需要获取 QPolygonF 的顶点。这是我到目前为止的代码

```
class Example(QtGui.QGraphicsScene):
    def block(self): 
        self.bpoint1 = QtCore.QPointF(150 , 150)
        self.bpoint2 = QtCore.QPointF(200 , 150)
        self.bpoint3 = QtCore.QPointF(200 , 200)
        self.bpoint4 = QtCore.QPointF(150 , 200)
        self.bproto = QtGui.QPolygonF([self.bpoint1 , self.bpoint2 , self.bpoint3 , self.bpoint4])
        self.block = QtGui.QGraphicsPolygonItem()
        self.block.setPolygon(self.bproto)
        self.block.setFlag(QtGui.QGraphicsItem.ItemIsMovable) 
```

我的块现在变成了可移动的，每次我都需要获取新的顶点，我的块被移动了。我该怎么做？我尝试了 self.block.boundingRect() ，但它给了我相同的 RectF 。有人能帮帮我吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:42:26.110

`QPolygon`只是派生自`QVector`，所以只需使用普通的数组访问器。但是它们将位于局部坐标中，因此需要将它们映射到场景坐标（我假设您的意思是“新顶点”）-使用`block.mapToScene( block.polygon()[i] )`.

# java - Primefaces selectOneMenu 过滤器不起作用

> ID：14551975
> 
> 赞同：2
> 
> 时间：2013-01-27T20:37:09.793
> 
> 标签：java, primefaces, selectonemenu

我正在尝试使 selectOneMenu 工作。我已经设法让它显示带有过滤器输入的选择，但每次我尝试在那里写一些东西时，一切都会消失。

这是视图中的代码：

```
<p:selectOneMenu style="width:160px" label="Supervisor" filter="true" filterMatchMode="startsWith" converter="userConverter">
    <f:selectItem itemLabel="Choose..." itemValue="" />
    <f:selectItems value="#{userBean.supervisors}" var="user" itemLabel="#{user.surname} #{user.name}" itemValue="#{user}"/>
</p:selectOneMenu> 
```

userBean.supervisors 传递的值由以下人员提供：

```
public List<User> getSupervisors() {
    if (supervisors == null) {
        supervisors = userDao.getUsersByRole(Enums.Roles.SUPERVISOR.getValue());
    }
    return supervisors;
} 
```

转换器很简单：

```
@FacesConverter(forClass = User.class, value="userConverter")
public class UserConverter implements Converter {

@Override
public String getAsString(FacesContext context, UIComponent component, Object value) {
    if(value == "") return null;
    // Convert ProjectDetail to its unique String representation.
    User user = (User) value;
    String idAsString = String.valueOf(user.getUserId());
    return idAsString;
}

@Override
public Object getAsObject(FacesContext context, UIComponent component, String value) {
    // Convert unique String representation of ProjectDetail back to ProjectDetail object.
    Long id = Long.valueOf(value);
    UserDAO userDao = new UserDAO();
    User user = userDao.getUser(id);
    return user;
}
} 
```

如果我将 p:selectOneMenu 更改为 p:selectCheckboxMenu 过滤并且一切正常，那会很有趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-01T08:36:51.637

检查此 css 以显示结果：

```
.ui-selectonemenu-items-wrapper{
    height: auto !important;
} 
```

# .net - SQLConnection 没有实现 IEnlistmentNotification

> ID：14551977
> 
> 赞同：1
> 
> 时间：2013-01-27T20:37:17.670
> 
> 标签：.net, sql, vb.net, ado.net, transactions

我试图了解如何确保仅在提交事务时才将日志条目输入到文件系统中。请看下面的代码。

```
Using (scope As TransactionScope = new TransactionScope()) 
    'write log log file (line 2)'
    scope.complete 
End Using 
```

在事务范围完成之前写入日志文件的时刻。

我已经阅读了有关`IEnlistmentNotification`界面的信息。我知道`SQLConnection`该类允许事务和分布式事务。因此，我希望这个类能够实现`IEnlistmentNotification`，但事实并非如此。为什么不呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:48:44.637

`IEnlistmentNotification`资源管理器使用它来参与事务，但它不是由 SQL 连接或事务实现的。

如果您实现自己的事务资源管理器，您将实现该接口并使用其中一种[事务登记方法](http://msdn.microsoft.com/en-us/library/system.transactions.transaction_methods.aspx) `EnlistDurable`或`EnlistVolatile`通知系统您要参与此事务。从此时起，您将收到对允许您对事务状态做出反应并影响事务状态的接口的调用。

如果您想以事务方式修改文件，您必须为此实施或找到资源管理器。该资源管理器将`IEnlistmentNotification`通过上述登记方法实施和参与事务。

# haskell - 折叠 foldr 函数组合 - Haskell

> ID：14551982
> 
> 赞同：8
> 
> 时间：2013-01-27T20:37:43.583
> 
> 标签：haskell, fold, function-composition

所以，我真的在努力理解 foldl.foldr 的组成。这是一个例子：

```
(foldl.foldr) (+) 1 [[1,2,3],[4,5,6]] 
```

结果是 22，但这里到底发生了什么？

在我看来，这就是正在发生的事情：`foldl (+) 1 [6,15]`. 我的怀疑与该`foldr`部分有关。它不应该将 1 添加到所有子列表中吗？像这样：`foldr (+) 1 [1,2,3]`。在我的脑海中，1 只添加了一次，对吗？（可能不是，但我想知道如何/为什么！）。

我很困惑（也许让所有的困惑，哈哈）。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-27T20:41:52.313

```
(foldl.foldr) (+) 1 [[1,2,3],[4,5,6]] 
```

变成

```
foldl (foldr (+)) 1 [[1,2,3],[4,5,6]] 
```

所以你得到

```
foldl (foldr (+)) (foldr (+) 1 [1,2,3]) [[4,5,6]] 
```

在 的第一步之后`foldl`，或

```
foldl (foldr (+)) 7 [[4,5,6]] 
```

如果我们评估应用`foldr`程序（除非严格分析器启动，它实际上仍然是一个未评估的 thunk，直到`foldl`遍历整个列表，但下一个表达式在评估后更具可读性），这就变成了

```
foldl (foldr (+)) (foldr (+) 7 [4,5,6]) [] 
```

最后

```
foldl (foldr (+)) 22 []
~> 22 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-27T21:10:32.590

让我们检查一下`foldl . foldr`。他们的类型是

```
foldl :: (a -> b -> a) -> (a -> [b] -> a)
foldr :: (c -> d -> d) -> (d -> [c] -> d) 
```

我故意使用了不同的类型变量并添加了括号，以便我们现在将它们视为一个参数的函数（并且它们的结果是函数）变得更加明显。看着`foldl`我们看到它是一种提升函数：给定一个`a`从`a`using产生的函数`b`，我们提升它以便它继续工作`[b]`（通过重复计算）。功能`foldr`类似，只是参数颠倒了。

现在如果我们申请会发生什么`foldl . foldr`？首先，让我们推导类型：我们必须统一类型变量，以便 的结果`foldr`与 的参数匹配`foldl`。所以我们必须替换: `a = d, b = [c]`:

```
foldl :: (d -> [c] -> d) -> (d -> [[c]] -> d)
foldr :: (c -> d   -> d) -> (d -> [c] -> d) 
```

所以我们得到

```
foldl . foldr :: (c -> d -> d) -> (d -> [[c]] -> d) 
```

它的含义是什么？首先，`foldr`提升类型的参数`c -> d -> d`以在列表上工作，并反转它的参数，以便我们得到`d -> [c] -> d`. 接下来，`foldl`再次解除此功能以处理`[[c]]`- 列表`[c]`。

在您的情况下，被解除的操作`(+)`是关联的，因此我们不关心其应​​用程序的顺序。双重提升只是创建了一个将操作应用于所有嵌套元素的函数。

如果我们使用 just `foldl`，效果会更好：我们可以多次提升，例如

```
foldl . foldl . foldl . foldl
    :: (a -> b -> a) -> (a -> [[[[b]]]] -> a) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T19:59:58.507

其实，`(foldl.foldr) f z xs === foldr f z (concat $ reverse xs)`。

即使`f`是关联操作，正确的应用程序顺序也很重要，因为它会影响性能。

我们从

```
(foldl.foldr) f z xs
foldl (foldr f) z xs 
```

写一会儿，这`g = foldr f`是`[x1,x2,...,xn_1,xn] = xs`

```
(...((z `g` x1) `g` x2) ... `g` xn)
(`g` xn) ((`g` xn_1) ... ((`g` x1) z) ... )
foldr f z $ concat [xn,xn_1, ..., x1]
foldr f z $ concat $ reverse xs 
```

所以在你的情况下，正确的减少顺序是

```
(foldl.foldr) 1 [[1,2,3],[4,5,6]]
4+(5+(6+(  1+(2+(3+  1)))))
22 
```

以机智，

```
Prelude> (foldl.foldr) (:) [] [[1..3],[4..6],[7..8]]
[7,8,4,5,6,1,2,3] 
```

* * *

同样，`(foldl.foldl) f z xs == foldl f z $ concat xs`。与`snoc a b = a++[b]`,

```
Prelude> (foldl.foldl) snoc [] [[1..3],[4..6],[7..8]]
[1,2,3,4,5,6,7,8] 
```

还有`(foldl.foldl.foldl) f z xs == (foldl.foldl) (foldl f) z xs == foldl (foldl f) z $ concat xs == (foldl.foldl) f z $ concat xs == foldl f z $ concat (concat xs)`，等：

```
Prelude> (foldl.foldl.foldl) snoc [] [[[1..3],[4..6]],[[7..8]]]
[1,2,3,4,5,6,7,8]
Prelude> (foldl.foldr.foldl) snoc [] [[[1..3],[4..6]],[[7..8]]]
[7,8,1,2,3,4,5,6]
Prelude> (foldl.foldl.foldr) (:) [] [[[1..3],[4..6]],[[7..8]]]
[7,8,4,5,6,1,2,3] 
```

# git - 是否有用于滚动发布 Web 应用程序的 Git 工作流？

> ID：14551983
> 
> 赞同：3
> 
> 时间：2013-01-27T20:37:59.177
> 
> 标签：git, workflow, release-management

我的十几个开发人员团队以滚动发布模式开发了一个 Web 应用程序：一旦某些功能集准备就绪，高级开发人员会对其进行审查，然后将其推送到 QA 系统中，然后再推送到生产系统中。这通常在每个工作日发生几次。

当前使用的 VCS 是 SVN，向 QA 和生产系统的推送是通过一个奇怪的内部部署工具完成的，该工具在 SVN 上工作，但基于文件（因此，如果您需要推送文件 X 的新版本，并且 X 已从其他一些您不想推送的变更集中取消推送更改，您有问题）。

我计划为切换到 Git 进行宣传，所以我在考虑工作流的样子。由于我们没有版本化版本，因此通常链接的[成功 Git 分支模型等常见建议不适用。](http://nvie.com/posts/a-successful-git-branching-model/)

**问题 1：**是否有任何文档化的工作流程我可以查看以获得更多灵感，类似于上面链接的工作流程，这些工作流程针对滚动发布进行了优化？或者你会推荐一个？

我试图在纸上建模一个工作流，它像往常一样使用功能分支和*主控*，并且有更多的分支来反映 QA 和生产服务器的状态。（一个只会从*master*合并到那里。）

我无法克服的问题是*master*中的某些东西由于某种原因没有准备好发布。例如，假设功能分支*foo*被认为已完成，合并到*master*并推送到*qa*分支。然后功能分支*栏*也会发生同样的情况。现在在 QA 系统上，我们发现*foo*已损坏，需要更多开发，而*bar*已准备好推入生产系统。但是*master*上没有提交，其中包括*bar*，但不包括*foo*，那么我们应该推送什么？唯一想到的是[恢复合并提交](http://www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt)将*foo*转换为*master*。（在链接后面，Linus 解释了恢复合并提交的几个问题。）

**问题2：**知道如何更优雅地克服这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:49:42.773

不要忘记，使用 DVCS，[您不仅有合并的工作流程，还有](https://stackoverflow.com/questions/2563836/sell-me-distributed-revision-control/2563917#2563917)repos 之间的发布（推/拉）工作流程。

`master`在评估功能时，您不必影响您的存储库。
您可以推送到`feature`单独的 QA 存储库的分支。

*   如果测试通过，则`QA/master`更新，所有开发人员都可以`master`从 QA 中提取以更新他们的 master，同时继续开发其他功能（他们将`feature`在更新的基础上重新设置本地分支`master`）。
*   如果测试失败，`QA/master`则不受影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-06T18:41:54.960

到目前为止，我使用的工作流程非常成功：

* * *

*   每个开发人员都致力于他们的功能/修复

*   一旦他们对工作感到满意，他们就会将分支推送到远程

    git push -u origin 新功能

*   QA 或测试 [服务器 | 人 | team] 拉取 master 和要发布的功能分支，并将其合并到 master 但不推送到远程

*   一旦功能被 QA'ed 它与 --no-ff 合并并推送到 master

*   现在可以删除功能分支

    git 推送来源：新功能

*   实时服务器总是从主服务器拉取

* * *

对我们来说，这可以确保实时服务器包含当前“最佳”代码的滚动发布。

如果您对分支模型感兴趣，我发现这非常有用： [nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T20:53:01.833

[git 主页](http://git-scm.com)上有工作流的文档

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-14T08:54:39.083

这是一个不错的幻灯片，值得您自己思考。没有什么是完美的，尽量满足你的需求。

发布管理 Git 工作流

[https://speakerdeck.com/ewoodh2o/release-management-git-workflow](https://speakerdeck.com/ewoodh2o/release-management-git-workflow)

# git - Cygwin 或 Git Bash 命令窗口？

> ID：14551989
> 
> 赞同：34
> 
> 时间：2013-01-27T20:38:18.600
> 
> 标签：git, cygwin, git-bash

我是 Git 新手。我下载了 Git 并安装在我的 Windows 上。我看到 Git 提供了一个 Git Bash 命令窗口。我的机器上也安装了 Cygwin。Git Bash 和 Cygwin 都提供 Git 命令行实用程序。所以我的问题是：使用 Git 命令的首选方式是：在 Git Bash 或 Cygwin 中运行 Git 命令？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-27T20:42:10.947

**[`git-bash`](https://github.com/msysgit/msysgit/blob/master/share/WinGit/Git%20Bash.vbs)**就足够了，除非您需要更新的 bash 功能（因为 msysgit 使用的来自 MingW 的 bash 已经很老了）

另请参阅“ [msysgit 和 Cygwin + git 之间的区别？](https://stackoverflow.com/questions/3144082/difference-between-msysgit-and-cygwin-git/3144417#3144417) ”。

例如，[适用于 Windows 的 GitHub](http://windows.github.com/)将使用 msysgit，而不是 Cygwin 中的 git。

# javascript - 从 div 调用 Javascript 函数

> ID：14551992
> 
> 赞同：3
> 
> 时间：2013-01-27T20:38:33.210
> 
> 标签：javascript, function, html, reference

当引用 HTML 中的 DIV 时，我能否请一些帮助来调用在 Javascript 中创建的函数。

这是我的功能：

```
 function testFunction()
        {
            alert("Test");
        } 
```

我希望在 HTML 中进行以下引用时调用 testFunction：

```
<div id="testFunction"> 
```

我可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:39:33.607

您可以将调用附加到单击处理程序：

在标记中：

```
<div id="testFunction" onclick="testFunction()"> 
```

或在您的脚本块内：

```
function testFunction() {
   alert("Test");
}

var el = document.getElementById("testFunction");
el.onclick = testFunction; 
```

# mysql - MySQL InnoDB 性能问题

> ID：14551995
> 
> 赞同：0
> 
> 时间：2013-01-27T20:39:00.673
> 
> 标签：mysql, innodb

我的 MySQL 5.1.66 上有以下数据库结构：

```
ID         int(11) PRIMARY
CID        varchar(255) INDEX
V1         varchar(1500)
DATE       datetime
IP_ADDR    varchar(255)
V2         varchar(1000)
USER_DELAY int(11)
M_ID       int(22)
REFERER    varchar(255)
BRAND      varchar(255)
LANG       varchar(255)
USER       varchar(255) 
```

我在数据库中有近 9,000,000 行，这是我的一些更重要的 my.cnf 属性：

```
innodb_buffer_pool_size = 256M
innodb_log_buffer_size = 16M
key_buffer_size = 128M
bulk_insert_buffer_size = 128M
max_heap_table_size = 128M
sort_buffer_size = 8M
tmp_table_size = 128M 
```

问题是，当运行一个简单的查询时，例如：

```
SELECT * FROM table WHERE CID = 123456 
```

获得响应需要 60 多秒（CID 是索引字段，查询只有 10 个结果）。

上述查询的 EXPLAIN 输出：

```
+----+-------------+-------+------+---------------+------+---------+------+---------+-------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows    | Extra       |
+----+-------------+-------+------+---------------+------+---------+------+---------+-------------+
|  1 | SIMPLE      | table | ALL  | CID           | NULL | NULL    | NULL | 9193357 | Using where |
+----+-------------+-------+------+---------------+------+---------+------+---------+-------------+ 
```

**编辑**：我刚刚注意到一些事情，当我将值放在引号下时，我会在 0.13 秒内得到结果，但是如果我在没有引号的情况下运行查询需要 60 秒，这是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T21:06:48.783

如果将值放在引号下，如果没有引号，即在 WHERE 子句中传递的整数值，则服务器将使用索引，并且索引将不起作用。您认为`123456`将转换为`varchar`然后索引必须有效。不。**高于**然后所有值**的优先级`integer``varchar`**`CID`将被转换`integer`为比较并且您进行表扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:56:22.413

CID 的类型很重要。如果要正确使用索引，则应使用正确的类型构建查询。在您的情况下，CID 是 varchar。因此，您应该在引号中给出一个值。否则它将被转换为需要大量时间的整数。

# opengl - Xcode 4.5 - OpenGL glEnable(GL_DEPTH_TEST) EXC_BAD_ACCESS

> ID：14551996
> 
> 赞同：0
> 
> 时间：2013-01-27T20:39:02.033
> 
> 标签：opengl, xcode4.5, osx-mountain-lion, glut

在我尝试学习 CG 和 OpenGL 之后，我找到[了《交互式计算机图形学》](http://www.cs.unm.edu/~angel/BOOK/INTERACTIVE_COMPUTER_GRAPHICS/SIXTH_EDITION/)这本书，我认为这本书对初学者来说是一本好书。现在，我正在尝试按照书中的理论创建所谓的 3D 谢尔宾斯基垫片。该项目在 Xcode 4.5 中构建并运行良好，但是当它到达`glEnable(GL_DEPTH_TEST)`生产线时，它崩溃并且 Xcode 显示错误`Exc_bad_access`。

这是我的代码的样子：

```
//
//  main.cpp
//  SierpinskiGasket
//
//  Created by Federico Martinez on 24.01.13.
//  Copyright (c) 2013 ParallelDev. All rights reserved.
//

#include "Angel.h"

const int NumTimesToSubdivide = 3;
const int NumTriangles = 27;  // 3^5 triangles generated
const int NumVertices  = 3 * NumTriangles;

vec3 points[NumVertices];
vec3 base_colors[4] = {
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0),
    vec3(0.0, 0.0, 0.0)
};
vec3 colors[NumVertices];

int Index = 0;
int colorIndex;

//----------------------------------------------------------------------------

void triangle( const vec3& a, const vec3& b, const vec3& c ){
    colors[Index] = base_colors[colorIndex];
    points[Index++] = a;
    colors[Index] = base_colors[colorIndex];
    points[Index++] = b;
    colors[Index] = base_colors[colorIndex];
    points[Index++] = c;
}
//----------------------------------------------------------------------------

void tetra(vec3 a, vec3 b, vec3 c, vec3 d){
    colorIndex = 0;
    triangle(a, b, c);
    colorIndex = 1;
    triangle(a, c, d);
    colorIndex = 2;
    triangle(a, d, b);
    colorIndex = 3;
    triangle(b, d, c);
}
//----------------------------------------------------------------------------

void divide_tetra(const vec3& a, const vec3& b, const vec3& c, const vec3& d, int count){
    if ( count > 0 ) {
        vec3 mid[6];

        mid[0] = (a+b) / 2.0;
        mid[1] = (a+c) / 2.0;
        mid[2] = (a+d) / 2.0;
        mid[3] = (b+c) / 2.0;
        mid[4] = (c+d) / 2.0;
        mid[5] = (b+d) / 2.0;

        divide_tetra(a, mid[0], mid[1], mid[2], count-1);
        divide_tetra(mid[0], b, mid[3], mid[5], count-1);
        divide_tetra(mid[1], mid[3], c, mid[4], count-1);
        divide_tetra(mid[2], mid[5], mid[5], d, count-1);

    }else {
        tetra(a, b, c, d);    // draw tetrahedron at end of recursion
    }
}

//----------------------------------------------------------------------------

void
init( void )
{
    vec3 vertices[4] = {
        vec3(-1.0, -1.0, -1.0),
        vec3(1.0, -1.0, -1.0),
        vec3(0.0, 1.0, -1.0),
        vec3(0.0, 0.0, 1.0)
    };

    // Subdivide the original triangle
    divide_tetra(vertices[0], vertices[1], vertices[2], vertices[3], NumVertices);

    // Create a vertex array object
    GLuint vao;
    glGenVertexArrays( 1, &vao );
    glBindVertexArray( vao );

    // Create and initialize a buffer object
    GLuint buffer;
    glGenBuffers( 1, &buffer );
    glBindBuffer( GL_ARRAY_BUFFER, buffer );

    glBufferData( GL_ARRAY_BUFFER, sizeof(points)+sizeof(colors), NULL, GL_STATIC_DRAW );
    glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(points), points);
    glBufferSubData(GL_ARRAY_BUFFER, sizeof(points), sizeof(colors), colors);

    // Load shaders and use the resulting shader program
    GLuint program = InitShader( "vertex.glsl", "fragment.glsl" );
    glUseProgram( program );

    // Initialize the vertex position attribute from the vertex shader
    GLuint loc = glGetAttribLocation( program, "vPosition" );
    glEnableVertexAttribArray( loc );
    glVertexAttribPointer( loc, 3, GL_FLOAT, GL_FALSE, 0,
                          BUFFER_OFFSET(0) );

    GLuint loc2 = glGetAttribLocation(program, "vColor");
    glEnableVertexAttribArray(loc2);
    glVertexAttribPointer(loc2, 3, GL_FLOAT, GL_FALSE, 0, BUFFER_OFFSET(sizeof(points)));

    glClearColor( 1.0, 1.0, 1.0, 1.0 ); /* white background */
}

void display(){
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glDrawArrays(GL_TRIANGLES, 0, NumVertices);
    glFlush();
}

int main(int argc, char** argv){

    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGBA | GLUT_3_2_CORE_PROFILE | GLUT_DEPTH);
    glEnable(GL_DEPTH_TEST);
    glutInitWindowSize(640, 480);
    glutCreateWindow("Sierpinski Gasket Recursive");

    init();

    glutDisplayFunc(display);

    glutMainLoop();

    return 0;
} 
```

大部分代码来自本书。这些文件`Angel.h`并`InitShader.cpp`提供了大多数着色器和矢量实用程序，它们由本书的作者提供。

这是什么`Exc_bad_access`意思？代码中是否有任何可能导致此问题的错误？

**更新 GDB 堆栈跟踪**

```
(gdb) t a a bt

Thread 5 (process 60424):
#0  0x00007fff8ecce6d6 in __workq_kernreturn ()
#1  0x00007fff8e5fdeec in _pthread_workq_return ()
#2  0x00007fff8e5fdcb3 in _pthread_wqthread ()
#3  0x00007fff8e5e8171 in start_wqthread ()

Thread 4 (process 60424):
#0  0x00007fff8ecce6d6 in __workq_kernreturn ()
#1  0x00007fff8e5fdeec in _pthread_workq_return ()
#2  0x00007fff8e5fdcb3 in _pthread_wqthread ()
#3  0x00007fff8e5e8171 in start_wqthread ()

Thread 3 (process 60424):
#0  0x00007fff8ecce6d6 in __workq_kernreturn ()
#1  0x00007fff8e5fdeec in _pthread_workq_return ()
#2  0x00007fff8e5fdcb3 in _pthread_wqthread ()
#3  0x00007fff8e5e8171 in start_wqthread ()

Thread 2 (process 60424):
#0  0x00007fff8ecced16 in kevent ()
#1  0x00007fff8d6b0dea in _dispatch_mgr_invoke ()
#2  0x00007fff8d6b09ee in _dispatch_mgr_thread ()

Thread 1 (process 60424):
#0  0x00007fff8ecf03d7 in glEnable ()
#1  0x000000010000212a in main (argc=1, argv=0x7fff5fbff800) at /Users/BRabbit27/Documents/COURSERA/ComputerGraphicsBook/SierpinskiGasket3D/SierpinskiGasket3D/main.cpp:129 
```

**更新 LLDB 堆栈跟踪**

```
(lldb) bt all
* thread #1: tid = 0x2e03, 0x00007fff8ecf03d7 libGL.dylib`glEnable + 15, stop reason = EXC_BAD_ACCESS (code=1, address=0x248)
    frame #0: 0x00007fff8ecf03d7 libGL.dylib`glEnable + 15
    frame #1: 0x000000010000212a SierpinskiGasket3D`main + 58 at main.cpp:129
    frame #2: 0x00007fff8fd5e7e1 libdyld.dylib`start + 1

  thread #2: tid = 0x3103, 0x00007fff8ecced16 libsystem_kernel.dylib`kevent + 10
    frame #0: 0x00007fff8ecced16 libsystem_kernel.dylib`kevent + 10
    frame #1: 0x00007fff8d6b0dea libdispatch.dylib`_dispatch_mgr_invoke + 883
    frame #2: 0x00007fff8d6b09ee libdispatch.dylib`_dispatch_mgr_thread + 54

  thread #3: tid = 0x3203, 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #0: 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #1: 0x00007fff8e5fdeec libsystem_c.dylib`_pthread_workq_return + 25
    frame #2: 0x00007fff8e5fdcb3 libsystem_c.dylib`_pthread_wqthread + 412
    frame #3: 0x00007fff8e5e8171 libsystem_c.dylib`start_wqthread + 13

  thread #4: tid = 0x3303, 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #0: 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #1: 0x00007fff8e5fdeec libsystem_c.dylib`_pthread_workq_return + 25
    frame #2: 0x00007fff8e5fdcb3 libsystem_c.dylib`_pthread_wqthread + 412
    frame #3: 0x00007fff8e5e8171 libsystem_c.dylib`start_wqthread + 13

  thread #5: tid = 0x3403, 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #0: 0x00007fff8ecce6d6 libsystem_kernel.dylib`__workq_kernreturn + 10
    frame #1: 0x00007fff8e5fdeec libsystem_c.dylib`_pthread_workq_return + 25
    frame #2: 0x00007fff8e5fdcb3 libsystem_c.dylib`_pthread_wqthread + 412
    frame #3: 0x00007fff8e5e8171 libsystem_c.dylib`start_wqthread + 13 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T06:43:39.290

简短的回答：在`glutCreateWindow`.

基本原理：OpenGL 使用称为*context*的数据结构，它存储其所有内部状态：纹理、着色器、状态设置等。每个 OpenGL 函数在开始操作之前都会访问当前上下文。创建上下文是您正在使用的窗口系统的功能，或者在 GLUT 的情况下，该`glutCreateWindow`功能。OP 中发生的事情是 OpenGL 实现有效地取消引用 NULL 指针，并导致异常。

这对于 OpenGL 实现来说是一种糟糕的形式——如果没有当前上下文，大多数实现通常只会让任何 OpenGL 函数立即返回。

# sql-server - SQL Server 地理多点插入

> ID：14551998
> 
> 赞同：1
> 
> 时间：2013-01-27T20:39:13.203
> 
> 标签：sql-server, spatial, geography

我正在使用 SQL Server 2012。我有一个表，我在其中跟踪地理列中的单点实例。将它们存储为单点工作正常，但我试图将其中一些组合到一个新表中，它们将是一个多点。我可以通过将 lat 和 long 插入到这样的多点列中来使其工作：

```
DECLARE @g geography; 
SET @g = geography::STMPointFromText('MULTIPOINT(-104.952784 39.524092, -104.935269 39.542652)', 4326);
INSERT INTO test(loc) values(@g) 
```

我想要做的是从已经是地理数据类型的表中选择值。我不确定是否可以使用基本查询来执行此操作，或者是否必须使用循环来构建它？我似乎无法让它工作。

另外，在我有了那个之后，有没有一种方法可以让我返回多点列的中心点？我一直在玩一些方法`STStartPoint`，`STEndpoint`但我似乎找不到返回中心点的方法？

对这些问题的任何帮助都将非常感激并受到高度赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:37:00.670

您正在寻找的是 STCentroid() 方法，但不幸的是，它不适用于 MultiPoint 对象。几年前，我为此提出了一个 Connect 问题，该问题已被 Microsoft 关闭为“不会修复”，但无论如何欢迎您投票：[https ://connect.microsoft.com/SQLServer/feedback/详细信息/588316/make-geometry-stcentroid-method-work-on-geometries-other-than-polygons](https://connect.microsoft.com/SQLServer/feedback/details/588316/make-geometry-stcentroid-method-work-on-geometries-other-than-polygons)

同时，您必须手动求和，然后分别平均 X 和 Y 坐标值以获得多点的平均“中心”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:56:25.693

如果我正确理解您的第一个问题，您有两点，分别存储为地理实例。如果是这种情况，您可以使用 STUnion 方法将它们组合成一个地理多点实例。