# StackOverflow 问答 13689000-13689999

# php - PHP MySQL错误-我没有登录到数据库

> ID：13689000
> 
> 赞同：2
> 
> 时间：2012-12-03T17:58:17.487
> 
> 标签：php, mysql

我是 PHP 新手。我需要一些帮助。

> 警告：mysql_connect() [function.mysql-connect]: 第 3 行 C:\xampp\htdocs\video\dbb.php 中的用户 'bp6am'@'localhost' 的访问被拒绝（使用密码：YES）无法连接。检查您的连接参数。

我知道我没有登录到数据库，但我无法通过它。

```
 db.inc.php
       <?php
          define('MYSQL_HOST','localhost');
          define('MYSQL_USER','root');
          define('MYSQL_PASSWORD','pass');
          define('MYSQL_DB','chat');
          ?>
    dbb.php
      <?php
       require 'db.inc.php';
       $db= mysql_connect('localhost','root','pass') OR
      die('unable to connect. check your connection parameters.');
        mysql_select_db(chat,$db) or die(mysql_error($db));
      // create the user table
        $query = 'CREATE TABLE IF NOT EXISTS
         site user(
        user_id INTEGER NOT NULL AUTO INCREMENT,
          username VARCHAR(20) NOT NULL,
       password CHAR(41) NOT NULL,

       PRIMARY KEY (user_id)
          }
        ENGINE=MYISAM';
          mysql_query($query,$db) or die (mysql_error($db));
         //create the user info table
          $query = 'CREATE TABLE IF NOT EXISTS
          site user_info(
         user_id INTEGER NOT NULL,
        first_name VARCHAR(20) NOT NULL,
          last_name VARCHAR(20) NOT NULL,
        email VARCHAR(50) NOT NULL,
        city  VARCHAR(20)
       state CHAR(2)
       hobbies VARCHAR(255) 
       FOREIGN KEY(user_id) REFERENCES site_user(user_id)
        }
       ENGINE=MYISAM';
        mysql_select_db(chat,$db) or die(mysql_error($db));

         //populate the user table
          $query='INSERT IGNORE INTO site_user
              (user_id,username,password)
          VALUES
      (1,"niharika",PASSWORD("niharika")),
      (2,"admin",PASSWORD("admin"))';
         mysql_select_db(chat,$db) or die(mysql_error($db));
       //populate the user information table 
        $query='INSERT IGNORE INTO site_user_inefo
      (user_id,first_name,last_name,email,city,state,hobbies)
         VALUES
     (1."niharika","katyan","niharikatyan@gmail.com",NULL,NULL,NULL),
        (1."admin","smith","adminsmith@gmail.com",NULL,NULL,NULL)';
          mysql_select_db(chat,$db) or die(mysql_error($db));
       echo 'success!';
      ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:02:34.017

您错过了数据库名称周围的引号，

```
mysql_select_db('chat',$db) or die(mysql_error($db)); 
```

[手动的](http://php.net/manual/en/function.mysql-select-db.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:05:59.687

将问题分解为更简单的步骤。

例如，将以下内容保存到它自己的文件 test.php 中：

```
$db= mysql_connect('localhost','root','pass') OR die('unable to connect. check your connection parameters.');
mysql_select_db('chat',$db) or die(mysql_error($db)); 
```

在浏览器中，试着去`localhost/test.php`看看会发生什么。

每当你像这样被卡住时，做同样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:06:58.737

您收到的错误消息意味着用户名或密码或两者都拼写错误。检查这些，你应该很好。

也许你换了他们？是`bp6am`密码吗？;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T18:18:26.887

确定这个文件的路径。如果它在 dbb.php 的同一个地方

很可能你没有到达这个连接到数据库的文件并改变它

替换这个

```
 mysql_select_db(chat,$db) or die(mysql_error($db)); 
```

经过

```
 mysql_select_db("chat") or die(mysql_error()); 
```

# android - 在android中更新sqlite

> ID：13689003
> 
> 赞同：0
> 
> 时间：2012-12-03T17:58:20.210
> 
> 标签：android, sqlite

先生，我在更新数据库时遇到问题。我制作了一个包含这些数据的列表视图

```
name
phone number
status 
```

如果他发送了一条带有关键字“可用”的消息，我想更新他的状态，并且会像这样更新我的列表视图

```
name
phone number
available 
```

所以我决定把电话号码作为触发器。如果发送消息的人的电话号码在我的列表视图中，它将更新数据库。但这是我的问题，如果我以这种格式将电话号码保存在我的列表视图中

```
09211234567 
```

发件人将返回他们的电话号码为

```
+639211234567 
```

所以我通过获取子字符串并将电话号码剪切为“9211234567”，然后添加0将其转换为“09211234567”来解决这个问题。

但是，数据库状态仍然没有更新。但是当我使用相同的技术从模拟器发送短信到模拟器时，它工作得很好。

我将列表视图中的模拟器数量保存为

```
5556 
```

但模拟器返回

```
15555215556 
```

所以我只是得到子字符串来得到 5556

请帮我。这是我的代码：

```
public static String sender;
public GroupDb info;
public String aStatus = "available";
public String nStatus = "not available";
public String addNum = "0";
public void onReceive(Context context, Intent intent) {
    // TODO Auto-generated method stub
    info = new GroupDb(context);
    Bundle bundle = intent.getExtras(); 
    Object[] pdusObj = (Object[]) bundle.get("pdus"); 
    SmsMessage[] messages = new SmsMessage[pdusObj.length]; 
    for (int i = 0; i<pdusObj.length; i++) 
    { 
            messages[i] = SmsMessage.createFromPdu ((byte[]) 
            pdusObj[i]); 
            sender = messages[i].getOriginatingAddress();
    } 

    for (SmsMessage msg : messages) {
        if (msg.getMessageBody().contains("available")) {
            info.open();

            String remFirstChar = sender.substring(3);
            addNum += remFirstChar;
            Toast.makeText(context.getApplicationContext(), "received sms from: " +addNum,
                    Toast.LENGTH_LONG).show();
            //if starts with +639
            if(sender.length() == 13)
            {
                info.updateStatus(addNum, aStatus);
                Toast.makeText(context.getApplicationContext(), "addNum: " +addNum,
                        Toast.LENGTH_LONG).show();
            }
            else
            {
                Toast.makeText(context.getApplicationContext(), "sender: " +sender,
                        Toast.LENGTH_LONG).show();
                info.updateStatus(remFirstChar, aStatus);
            }
            info.close();
        }//end if - available 
```

这是我如何更新我的状态

```
//update status
public void updateStatus(String mNumber, String mStatus) throws SQLException 
{
    // TODO Auto-generated method stub
    ContentValues cvUpdate = new ContentValues();
    cvUpdate.put(KEY_STATUS, mStatus);
    ourDatabase.update(DATABASE_TABLE, cvUpdate, KEY_NUMBER + "=" + mNumber, null);
} 
```

更新：我什至尝试在列表视图中输入“+63”格式，但我仍然不会更新。删除和编辑等所有功能也不起作用并显示强制关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T06:26:04.340

你需要使用`PhoneNumberUtils`类。

在将电话号码保存在数据库中之前，首先将其转换为

```
String formattedNumber = PhoneNumberUtils.formatNumber(phonenumber); 
```

为了比较，您可以使用[PhoneNumberUtils.compare](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html#compare%28java.lang.String,%20java.lang.String%29)

# javascript - getimagedata在Firefox中不起作用

> ID：13689005
> 
> 赞同：1
> 
> 时间：2012-12-03T17:58:41.943
> 
> 标签：javascript, jquery, html, firefox, canvas

HTML5 元素 getImageData() 出现问题 我在网站上使用 wScratchPad 作为临时工具，并使用 wScratchPad 中的百分比函数来确定何时删除覆盖。它在 IE9、Safari 和 Chrome 上运行良好。但它会在 Firefox 中引发安全错误。

我在 Chrome 和 IE9 中也遇到了同样的问题，但通过将 JS、图像和 HTML 移动到同一台服务器来修复它。

我知道如果 JS 和 Canvas Image 的域不在同一个域上，它会引发错误，所以我检查了 image 和 js 的 document.domain。它看起来像 'document.domain = domain.com' 的 JS，并且图像具有 document.domain = www.domain.com。

这可能是问题吗？如果是这样，我该如何解决？我已经看到了一种覆盖浏览器以获取用户确认脚本的警报的方法，但鉴于这是一个高知名度的网站，这是不可能的。

在 wScratchPad 中导致错误的代码下方：

```
scratchPercentage: function($this)
{
    var hits = 0;
    var imageData = $this.ctx.getImageData(0,0,$this.canvas.width,$this.canvas.height)

    for(var i=0, ii=imageData.data.length; i<ii; i=i+4)
    {
        if(imageData.data[i] == 0 && imageData.data[i+1] == 0 && imageData.data[i+2] == 0 && imageData.data[i+3] == 0) hits++;
    }

    return (hits / $this.pixels) * 100;
}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T05:54:19.060

是的，您的问题是页面和图像不是同源的。

修复它的方法是从 www.domain.com 加载页面，就像图像一样，或者让您的服务器随图像一起发送适当的 CORS 标头。

我很惊讶您说它可以在其他浏览器中使用。您是否可能从 www.domain.com 加载了那些页面？

# database - 如何在 Phonegap 中显示来自数据库错误回调的有用错误消息？

> ID：13689006
> 
> 赞同：8
> 
> 时间：2012-12-03T17:58:44.660
> 
> 标签：database, cordova, error-handling

使用 Phonegap，您可以设置在整个数据库事务或单个 SQL 语句出错时回调的函数。**我想知道如何获取有关该错误的更多信息。**

我有一个通用的错误处理函数，以及许多可能触发它的不同 SELECT 或 INSERT。**我怎么知道是哪一个有错？**从错误消息中并不总是很明显。

到目前为止，我的代码是...

```
function get_rows(tx) {
   tx.executeSql("SELECT * FROM Blah", [], lovely_success, statement_error);
}
function add_row(tx) {
   tx.executeSql("INSERT INTO Blah (1, 2, 3)", [], carry_on, statement_error);
}
function statement_error(tx, error) {
   alert(error.code + ' / ' + error.message);
} 
```

从各种示例中，我看到错误回调将传递一个`transaction`对象和一个`error`对象。我读到`.code`可以具有以下值：

*   UNKNOWN_ERR = 0
*   DATABASE_ERR = 1
*   VERSION_ERR = 2
*   TOO_LARGE_ERR = 3
*   QUOTA_ERR = 4
*   SYNTAX_ERR = 5
*   CONSTRAINT_ERR = 6
*   TIMEOUT_ERR = 7

**错误对象还有其他属性/方法吗？
此时事务对象的属性/方法是什么？**

我似乎无法为此找到一个好的在线参考。当然不在Phonegap网站上！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-14T14:32:14.223

[http://docs.phonegap.com/en/2.2.0/cordova_storage_storage.md.html#SQLError](http://docs.phonegap.com/en/2.2.0/cordova_storage_storage.md.html#SQLError)

> 操作数据库时发生错误时抛出 SQLError 对象。

这个对象有两个属性：

*   代码（您描述的常量之一）
*   **消息：错误的描述。**

所以在你的代码`error.message`中会给你一个很好的描述，说明在哪个事务中出了什么问题。

我想这正是你想要的，不是吗？

最好的问候， F481

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T11:02:15.657

## 交易对象

据我所知，您对事务对象唯一能做的就是调用它的`.executeSql()`方法。我找不到这个对象的任何属性。

## 错误对象

错误对象有一个`.code`包含数字的属性。您可以检查数值（请参阅我上面的原始问题）或使用类似的东西：
`if (error.code == error.DATABASE_ERR) alert('nasty database error')`

该`.message`属性是一个字符串，可能会返回如下内容：

*   *无法准备语句（“wibble”附近的 1：语法错误）*
*   *无法准备语句（1 没有这样的表：MyyTable）*
*   *无法准备语句（1 个表 MyTable 没有名为 MyColunm 的列）*
*   *无法执行语句（19 约束失败）*

其他消息是可能的！这只是我在 Chrome 中调试时发现的少数几个。我注意到 Phonegap 中的消息更简短：“*没有这样的表：MyyTable* ”

## 有两组成功/错误回调

另请注意，在最初调用`.transaction()`. 您的函数只会返回一个错误对象（没有事务对象）。

错误`.code`将为零，并且`.message`将是“*语句回调引发异常或语句错误回调未返回 false* ”。

所以请记住让您的语句回调（里面提到的函数`.executeSql`，例如我原始问题的代码示例中的我的 statement_error）返回真或假，具体取决于您是否希望您的事务错误回调（里面提到的第二个函数`.transaction`）被击中。`.transaction`如果您返回 true（或不返回任何内容），您指定的“成功”回调（内部的第三个）将运行。

# google-maps - 谷歌地图覆盖上的红线

> ID：13689012
> 
> 赞同：0
> 
> 时间：2012-12-03T17:59:00.247
> 
> 标签：google-maps, google-maps-api-3

![这是问题的图片](../Images/4af5d0400bd49178d39355347b66193a.png)

这是我加载重叠地图的代码

```
function cargar_map_restaurant(latitude, longitude, icono, name_restaurant, detalle) {

directionsDisplay = new google.maps.DirectionsRenderer();
var scroll_false = detalle ? false : true;
var punto = new google.maps.LatLng(latitude, longitude);
var myOptions = {
    zoom : 15,
    center : punto,
    mapTypeId : google.maps.MapTypeId.ROADMAP,
    scrollwheel : scroll_false
}
map = new google.maps.Map(document.getElementById("map"), myOptions);

if (detalle === true) {
    marca = new google.maps.Marker({
        position : punto,
        icon : icono,
        map : map,
        title : name_restaurant,
        animation: google.maps.Animation.DROP,

    });

    google.maps.event.addListener(marca, 'click', function() {
          infobox.open(map, this);
          if (this.getAnimation() != null) {
              this.setAnimation(null);
          } else {
              this.setAnimation(google.maps.Animation.BOUNCE);
          }
    });
}
directionsDisplay.setMap(map);
directionsDisplay.setPanel(document.getElementById("ruta")); 
```

}

当您在地图上创建叠加层时，还会在品牌周围创建一条弧形红线。

我不确定我会做错，因为这发生在我所有的叠加层中。

[这是链接问题的示例](http://www.foodmovil.com/restaurant-burger_king_americo_vespucio/27#detail)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:15:45.600

看看[http://www.foodmovil.com/public/css/styles.css](http://www.foodmovil.com/public/css/styles.css)

```
canvas
{ border:1px solid red; } 
```

# sql - SSRS 报告表，包括平均值

> ID：13689018
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:59:30.870
> 
> 标签：sql, reporting-services, sql-server-2008-r2

我需要一个包含一些数据的报告，其中包含常规行之间的计算数据。例如：

```
Name  |  Age  |  Salary

HR    |  35   |   $1300  
John  |  30   |   $1000  
Mark  |  40   |   $1600

Law   |  45   |   $1500  
Bill  |  40   |   $1000  
Sara  |  50   |   $2000 
```

这个想法是按字段对行进行分组，然后为该组添加一行具有平均数的行。

是否可以？我还有 2 个日期参数（开始和结束），所以我需要将所有记录获取到 SSRS，然后将它们过滤掉......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:30:47.457

是的，这是可能的，而且非常直接。

使用数据行创建报表，然后在部门字段上创建一个组。您可以通过以下几种方式执行此操作：右键单击详细信息行，然后选择`Add Group...`部门字段或将其拖动到设计窗口中的行组窗格中。

通过右键单击详细信息组并选择在详细信息之前添加总计，向组中添加一行。在新行中，将公式设置为`=Avg(MyDataset!AgeFieldName.Value)`

查看 MSDN 上提供的[教程](http://msdn.microsoft.com/en-us/library/bb522859%28v=sql.105%29.aspx)，尤其是[Grouping and Totals 部分](http://msdn.microsoft.com/en-us/library/ms170712%28v=sql.105%29.aspx)

# gnuplot - 使用 Gnuplot 在时间序列上绘制事件

> ID：13689022
> 
> 赞同：2
> 
> 时间：2012-12-03T17:59:38.573
> 
> 标签：gnuplot

我试图在其他一些图表之上绘制一个事件的发生，这些图表显示了一个进程需要多少时间来查看是否存在相关性，但我无法弄清楚如何让 gnuplot 正确地对数据求和。由于数据不是数字的，我在应用与绘制直方图相关的材料时遇到了麻烦。这是我的数据：

```
"2012-05-15 08:12:49","foo"
"2012-05-15 08:13:01","foo"
"2012-05-15 08:13:58","foo"
"2012-05-15 08:14:03","foo"
"2012-05-15 08:14:10","foo"
"2012-05-15 08:14:17","foo"
"2012-05-15 08:14:33","foo"
"2012-05-15 08:14:35","foo"

...

"2012-05-15 10:31:51","foo"
"2012-05-15 10:32:02","foo"
"2012-05-15 10:32:03","foo"
"2012-05-15 10:32:07","foo"
"2012-05-15 10:32:09","foo"
"2012-05-15 10:32:15","foo" 
```

这是数据文件的范围，我想要一个带有一条线的图表，表示当时发生了多少事件

（所以我可以将它覆盖到我的另一个绘制了处理时间的图上）

这可能吗？

**编辑：**到目前为止，我已经尝试了几种选项组合，但都没有产生任何可读的图形，[这](http://pastie.org/5475243)是我正在使用的 gnuplot 文件，`type1.csv`并且`type2.csv`来自我正在覆盖的图形。small_report.csv 是“发生”数据的 1000 行提取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-04-26T10:54:44.063

对我来说，这里的诀窍是记住在对 x 轴（分箱）进行数学运算时使用 timecolumn()。

```
set xdata time
set timefmt "[%Y-%m-%y %H:%M:%S"
binwidth = 30  #30 second bin
bin(x,width) = width*floor(x/width)
plot "testdata.log" using (bin(timecolumn(1),binwidth)):(1.0) smooth frequency with boxes 
```

上面的示例对给定 binwidth 内的事件求和，并将它们绘制在时间线上。

```
$gnuplot --version
gnuplot 4.6 patchlevel 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T16:46:54.723

使用 python 2.7 计算特定日期出现的次数非常容易：

```
from collections import Counter
with open('datafile') as fin:
    c = Counter(line.split()[0][1:] for line in fin)

for k,v in sorted(c.items()):
    print k,v 
```

如果你没有 python 2.7，你可以`defaultdict`在早期版本中模仿这个：

```
from collections import defaultdict
with open('datafile') as fin:
    c = defaultdict(int)
    for line in fin:
        c[ line.split()[0][1:] ] += 1

for k,v in sorted(c.items()):
    print k,v 
```

现在您可以使用它来绘制图：

```
set timefmt '%Y-%m-%d'
set xdata time
plot "<python pythonscript.py" u 1:2 
```

# javascript - 更新 javascript 对象的日期部分而不更改时间部分

> ID：13689023
> 
> 赞同：5
> 
> 时间：2012-12-03T17:59:43.300
> 
> 标签：javascript, date, datetime

在 JavaScript 中设置 JavaScript 日期对象的日期部分而不影响时间部分的最佳方法是什么？

假设你有这样的约会 `Wed Oct 31 2012 10:15:00 GMT-0400 (EDT)`

并且您想在不更改时间的情况下将其更新为 11 月 1 日。

乍一看，你会认为这行得通，

```
exampledate.setFullYear(2012);
exampledate.setMonth(10);
exampledate.setDate(1); 
```

但结果是 `Sat Dec 01 2012 10:15:00 GMT-0500 (EST)`

我认为这样做的原因是 10 月有 31 天，而 11 月只有 30 天。因为这显然不能一直正常工作。我还有哪些其他选择？我必须创建一个新的日期对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:02:17.060

*首先*设置日期，然后设置月份。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:14:16.790

JavaScript Date 对象设置方法通常允许您（可选地）一次设置多个日期/时间组件（除了主要组件），视情况而定——这就是您想要做的。

对于您的用例，语法为`setFullYear`is `setFullYear(year,month,day)`，因此除了显式设置年份（这将导致月份和日期根据您的初始日期隐式更新）外，您还可以显式设置月份和日期在它。例如：

```
var d = new Date();
d.setFullYear(2020,10,3); 
```

将返回

```
Tue Nov 03 2020 13:10:34 GMT-0500 (EST) 
```

有关详细信息，请参阅[JavaScript setFullYear() 方法](http://www.w3schools.com/jsref/jsref_setfullyear.asp)。

因为 Date 对象的时间组件（例如小时、分钟、秒、毫秒）不依赖于日期部分（年、月、日期），所以将保留您的初始时间组件。如果您需要随后更新时间组件，您可以`setHours()`根据需要安全地使用或其他方法，因为不会发生对日期组件的隐式更新。

# php - 如何解析具有 SimpleXMLElement 和多个命名空间的 XML 文件？

> ID：13689026
> 
> 赞同：0
> 
> 时间：2012-12-03T18:00:02.193
> 
> 标签：php, xml, parsing, namespaces, simplexml

我有一个类似于此站点示例的 XML 文件：http: [//msdn.microsoft.com/en-us/library/ee223815 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ee223815(v=sql.105).aspx)

我正在尝试使用以下内容解析 XML 文件：

```
$data = file_get_contents('http://mywebsite here');
$xml = new SimpleXMLElement($data);
$str = $xml->Author;
echo $str; 
```

不幸的是，这不起作用，我怀疑这是由于命名空间。我可以使用 asXML() 转储 $xml 并正确显示 XML 数据。

我知道我需要以某种方式插入名称空间，但我不确定如何。如何解析这种类型的 XML 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:14:10.100

您只需要注册命名空间

```
$sxe = new SimpleXMLElement($data);
$sxe->registerXPathNamespace("diffgr", "urn:schemas-microsoft-com:xml-diffgram-v1");
$data = $sxe->xpath("//diffgr:diffgram") ;
$data = $data[0];
echo "<pre>";
foreach($data->Results->RelevantResults as $result)
{
    echo $result->Author , PHP_EOL ;
} 
```

输出

```
Ms.Kim    Abercrombie
Mr.GustavoAchong
Mr. Samuel N. Agcaoili 
```

[查看完整的代码在行动](http://codepad.viper-7.com/3ynOV6)

# php - CentOS php pecl PDO_DBLIB

> ID：13689028
> 
> 赞同：5
> 
> 时间：2012-12-03T18:00:12.093
> 
> 标签：php, sql-server, pdo

我曾尝试在 CentOS 5.8 中安装 PDO_DBLIB，所以我运行以下命令

```
pecl install PDO_DBLIB 
```

我收到以下消息

```
pear/PDO_DBLIB requires PHP extension 'pdo' version >=1.0 
```

但是在[http://php.net/manual/es/ref.pdo-dblib.php](http://php.net/manual/es/ref.pdo-dblib.php)中，它说这是一个实验性 pdo，所以你知道另一个 PDO，我可以用它来连接 CentOS 5 中的 sql server

谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-20T15:15:17.500

请参阅php.net 上的[此错误报告。](https://bugs.php.net/bug.php?id=57045)其中一条评论包括解决此特定问题的步骤。基本上解决方法是下载包，修改 package.xml 以删除依赖项，然后尝试在本地安装包

```
$ pecl download pdo_dblib
$ tar -xzvf PDO_DBLIB-*.tgz

Remove from package.xml and save:
<dep type="ext" rel="ge" version="1.0">pdo</dep>

$ mv package.xml ./PDO_DBLIB-X.X
$ cd PDO_DBLIB-X.X
$ pecl install package.xml 
```

或者，您可以告诉 PECL 跳过依赖项...

```
$ pecl install -n pdo_dblib 
```

# java - String = null 和 String.isEmpty 有什么区别吗？

> ID：13689033
> 
> 赞同：15
> 
> 时间：2012-12-03T18:00:38.827
> 
> 标签：java, string, null

使用 if 语句通过使用 String = null 或 String.isEmpty() 检查字符串是否为空时有什么区别吗？

IE：

```
public String name;

if(name == null)
{
    //do something
} 
```

或者

```
public String name;

if(name.isEmpty())
{
    //do something
} 
```

如果有任何不同（包括性能问题），请告诉我。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-03T18:02:36.887

空字符串是长度为零的字符串。null 值根本没有字符串。

*   如果 s 是空字符串，则表达式`s == null`将返回。`false`
*   `NullPointerException`如果字符串为空，第二个版本将抛出 a 。

下表显示了差异：

```
+-------+-----------+----------------------+
| s     | s == null | s.isEmpty()          |
+-------+-----------+----------------------+
| null  | true      | NullPointerException |
| ""    | false     | true                 |
| "foo" | false     | false                |
+-------+-----------+----------------------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:02:22.583

该变量`name`不是字符串。它是对字符串的*引用。*

因此，空检查确定是否`name`实际*引用*a `String`。如果是这样，那么（并且只有这样）您可以执行进一步检查以查看它是否为空。IE

```
String name = null;  // no string
String name = "";    // an 'empty' string 
```

是两种不同的情况。请注意，如果您不首先检查空值，那么您将尝试在空引用上调用一个方法，这就是您感到恐惧的时候`NullPointerException`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T18:02:51.493

用“”赋值的字符串不包含任何值但为空（长度=0），未实例化的字符串为空。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T18:02:14.127

`isEmpty()`检查空字符串`""`，

`NullPointerException`如果你`isEmpty()`在`null`实例上调用它会抛出

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T18:03:28.533

如果您应用此代码：

```
if(name.isEmpty())
{
    //do something
} 
```

当`name`为空时，你会得到`NullPointerException`.

`null`检查通常会显示您是否有对象。**检查显示现有**对象
`isEmpty`的内容是否为空。 **`String`**

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-03T18:06:48.580

查看您的 java 版本的源代码。

比如在openjdk-7中：http: [//www.docjar.com/html/api/java/lang/String.java.html](http://www.docjar.com/html/api/java/lang/String.java.html)

```
 119       /** The count is the number of characters in the String. */
  120       private final int count;

  663       /**
  664        * Returns <tt>true</tt> if, and only if, {@link #length()} is <tt>0</tt>.
  665        *
  666        * @return <tt>true</tt> if {@link #length()} is <tt>0</tt>, otherwise
  667        * <tt>false</tt>
  668        *
  669        * @since 1.6
  670        */
  671       public boolean isEmpty() {
  672           return count == 0;
  673       } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-03T18:07:17.173

isEmpty 检查字符串“”。最佳做法是检查：

```
if (str != null && !str.isEmpty() {
   // process string
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-31T14:45:22.737

本周我在修改一些旧的 Java 代码时遇到了这个问题，我在这里了解到我必须始终进行所有这些检查。答案确实是正确的，但我发现每次都很难记住，所以我决定做一个小函数，在 1 个简单的调用中为我完成。

有了这个，你总能得到你想要的答案：

```
 public boolean StringIsNull(String pi_sChaine)
        {  boolean bTrueOrFalse = true;

           if (pi_sChaine == null || pi_sChaine.isEmpty())
             { bTrueOrFalse = true; }
           else
             { bTrueOrFalse = false; }

           return bTrueOrFalse;
        } 
```**

# clojure - 如何在 clojure 应用程序中实现每个用户的 .emacs 样式配置？

> ID：13689038
> 
> 赞同：0
> 
> 时间：2012-12-03T18:01:14.690
> 
> 标签：clojure, config, dotfiles

我有一个 Clojure 应用程序，它处理我们公司的一些数据。所以我想获得它的定制抛出`.myapp.clj`文件或类似的东西的可能性。

它必须是一个简单的clojure脚本，用户可以在其中定义自己的数据处理原理。他还必须有可能调整 http 后端和其他应用程序部分。

那么，实现此文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:16:33.080

有几种方法会随着复杂程度的不同而浮现在脑海中。最简单的方法是让每个用户`~/.myall.clj`在他们的主目录中定义一个，然后程序的开头将包含一行：

```
(def per-user-config (load-file "~/.myall.clj")) 
```

`load-file`读取文件并返回文件中读取的最后一个表单。这使您可以很好地编写配置文件。例如，您可以制作一个公司范围的模板，其中包含诸如之类的符号`user-name`，然后从定义用户名的每个用户配置文件中加载它，然后调用`load-file`模板

配置模板.clj：

```
{:app-name "foo"
 :user-url (str "http://server.company:8080/users/" user-name)
 :foo "bar"} 
```

乔斯-config.clj：

```
(def user-name "joe")
(load-file "resources/global-config.clj") 
```

这允许您通过 git 分发大部分配置，同时仍然允许用户覆盖配置的任意部分。

# dynamics-crm-2011 - 如何将包含 SQL Server 数据源和 T-SQL 查询的 SSRS 报告部署到 CRM 2011 Online？

> ID：13689044
> 
> 赞同：5
> 
> 时间：2012-12-03T18:01:54.177
> 
> 标签：dynamics-crm-2011, reporting-services, crm, dynamics-crm-online

我正在为使用 CRM Online 的客户创建自定义 SSRS 报告。但是，我无法部署与它们有 SQL 数据源连接的报表。我收到以下错误：

“无效的数据源。不支持此报表类型。Microsoft Dynamics CRM Online 仅支持使用 Fetch XML 数据源的报表。”

但是，这个错误有些不真实。原因：当我从他们的 CRM 下载其他自定义报告时，数据源都是带有 T-SQL 查询的 SQL 连接字符串。

因此，必须有一种方法来部署这些报告。也许来自客户的网络？到目前为止，我无法在网上找到任何详细信息。帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:59:34.363

恐怕没有解决办法。CRM Online 仅允许您上传基于 fetchXml 的报告。没有解决方法（至少我听说过）。

您确定您下载的其他报告绝对是自定义的（CRM 允许某些系统报告是基于 SQL 的）或者如果自定义它们确实有效（不管它们最初是如何到达那里的！）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-19T03:05:16.323

是的，有几个解决方法是可能的。

您需要为 SQL 创建数据源并将其上传到您的 CRM 服务器。您的 CRM 服务器上是否运行 SSRS 服务？如果是，那么将有 2 个数据源可用。一个用于 CRM 数据源（获取 XML），另一个用于 SQL server。如果它不存在，则需要创建它。

拥有这些数据源后，您就可以在 SSRS 报告中获取数据。确保您的数据源名称应与您的 SSRS 报告数据源匹配。（我的 CRM 2011 有承诺的环境）

# c# - DataSet 和 SQL 动态相似

> ID：13689050
> 
> 赞同：1
> 
> 时间：2012-12-03T18:02:19.027
> 
> 标签：c#, .net, sql, sql-server, stored-procedures

我有一张带有 nvarchar 字段的表。我的应用有一个搜索页面，用户可以在搜索框中输入一些单词。

我在我的应用程序中使用了一个数据集。我想在 where 子句中创建一个动态 Like 的 SQL 语句，例如

```
"WHERE field1 like '%string1%' AND field1 like '%string2%' AND ..." 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T08:45:59.603

尝试这个：

1.  制作一个接受用户输入的程序，例如，

    创建过程搜索（@serch1 varchar(200)、@search2 varchar(200) 作为开始

    …………

2.  在正文中输入 select * from tbl_name where field1 like "%search1%" and field2 like "%search1%"

继续前进。也许它会帮助你。

**您也可以在数据库中尝试全文索引，这非常有帮助**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T10:10:44.870

您可以在数据表中创建数据视图或使用选择命令。

数据视图语法：-

```
dtEditSitePages = new DataView(dtEditSitePages,"field1 like '%t%'","",DataViewRowState.CurrentRows).ToTable(); 
```

//dtEditSitePages 是过滤器将触发的数据表

# java - 在 java 中管理配置（初始配置/保存/加载配置）

> ID：13689056
> 
> 赞同：1
> 
> 时间：2012-12-03T18:02:38.510
> 
> 标签：java, config, preferences

我有一个类 Config 看起来像这样：

```
public Class Config {

    public static int someIntValue = 0;
    public static String someText = "some text";

} 
```

我现在要做的是保存和加载该配置，如果不需要加载另一个配置，还有初始配置。因此配置可以在程序中的任何时候更改。

我想出的是一个类似 Singelton 的模式

```
public Class Config {

    public static Config instance;

    private int someIntValue = 0;
    private int String someText = "some text";

    public static Config getInstance(){
    if(instance == null)
    instance = new Config();
    return instance;
    }

    public void setInstance(Config config){
    this.instance = config;
    }
    //getter/setter
    ...

} 
```

但最后它看起来不是最好的方法，我对它不太满意：/也许你们可以用通常的/“最佳实践”方式来帮助我。

最好的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:08:20.453

我只会使用 java.util.Properties 或一些包装器。另一个好方法是 java bean 和类似 xstream 的东西来保存/加载东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:16:34.520

通常在 Java 中用于配置使用属性文件。然后使用 ResuorseBundle 读取属性。

您的“单身人士”不是传统意义上的单身人士。1）字段实例必须是私有的 2）删除 SetInstance 方法 3）你应该让你的单例线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T22:23:07.373

如果您考虑避免编写围绕 java.util.Properties 的样板代码，您可以看看为您做的事情：[OWNER API](http://owner.aeonbits.org)。

它可以根据您的需求进行配置，并且与 java.util.Properties 相比，它提供了一些额外的简洁功能（阅读文档）。

例子。您使用配置参数定义接口：

```
public interface ServerConfig extends Config {
    int port();
    String hostname();
    @DefaultValue("42")
    int maxThreads();
    @DefaultValue("1.0")
    String version();
} 
```

然后你像这样使用它：

```
public class MyApp {
    private static ServerConfig cfg = ConfigFactory.create(ServerConfig.class);
    private MainWindow window;

    public MyApp() {
       // you can pass the cfg object as dependency, example:
       window = new MainWindow(cfg);
    }

    public void start() {
       window.show();
    }

    public static void main(String[] args) {
       // you can use it directly,  example:
       System.out.println("MyApp version " + cfg.version() + " copyright (c) ACME corp.");
       MyApp app = new MyApp();
       app.start();
    }
} 
```

您可以将 cfg 对象定义为您需要的类的成员实例，或者您可以将实例传递给您需要的构造函数和方法。

版本 1.0.4 即将发布，它还将包括“热重载”和许多改进。

# php - CakePHP 2.2.4：未定义索引错误

> ID：13689059
> 
> 赞同：-1
> 
> 时间：2012-12-03T18:03:00.947
> 
> 标签：php, cakephp, cakephp-model

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T09:18:36.230

在文章控制器中设置 recurisve = 2 就可以了。还必须在用户模型中调整我的用户和头像之间的关联（必须让用户都属于头像并且用户有很多头像）。

我有点担心 recursize = 2 会减慢应用程序的速度，因为文章与评论相关联，而评论与我网站上的所有其他用户内容模块相关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:22:04.763

看起来您的“头像所属的用户”设置不正确，但您说它可以正常工作？事实上，如果您使用约定，则不需要 foreignKey 字段。所以除非有其他事情发生，你的

```
'foreignKey'  => 'id = Avatar.id' 
```

看起来应该是

```
'foreignKey'  => 'avatar_id' 
```

您确实需要包含更多代码/完整错误，以便我们确定发生了什么。

# c++ - 分段错误进程返回 139 (0x8b)

> ID：13689061
> 
> 赞同：1
> 
> 时间：2012-12-03T18:03:12.190
> 
> 标签：c++, linux, segmentation-fault

我是 Linux 和代码块的新手。在构建下面的代码时，我收到此错误：

> “分段错误进程返回 139 (0x8b)”

我知道这与记忆有关，但我找不到问题所在。在使用 Makefile 或在终端中单独编译文件时，我没有收到任何错误。

`main`接收 2 个参数`(argv) ComputersInNet.txt - > argv[1] Simulation.txt -> argv[2]`

而且我无法弄清楚如何使用代码块将这些文件添加到项目中，而且在 Windows（Visual Basic）中代码也可以完美运行。

我无法正确粘贴代码（5 个文件：2 .h 和 3 .cpp），您可以从下面的链接下载它们，包括我用作参数的两个 txt 文件。

[http://depositfiles.com/files/cv2bwmz74](http://depositfiles.com/files/cv2bwmz74)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:04:09.283

发生代码片段问题，调用子程序`Create_PC_List()`以`main()`创建计算机列表。

```
void Router :: Create_PC_List (char *fname) //Reads from file & creates list of computers
{
char C;
char* IPAD=NULL;
FILE* fp;
FILE* msg;
int counter=0;
fp = fopen (fname,"r"); //Reading from Argv parameter file - list of computers in the network
if(fp == NULL)
        cout << "Opening file failed: %s\n" << strerror(errno) << endl;
msg = fopen (fname, "r"); //Reading from Argv parameter file - list of computers in the network
    while((C=fgetc(fp)) != EOF) //Running trougth the file
{
    ... 
```

输出：

```
Opening file failed: No such file or directory
followed  by segmentation fault. 
```

我们可以看到`fopen()`failed with error `"No such file or directory"`。因此，您需要找到一种方法将三个文本文件添加到代码块中，并使其可用于`fopen()`.

分段错误的第二个原因是提供给的 fp`getc()`是一个`FILE *`包含**NULL**地址的指针，该地址不是有效的**FILE**对象。

# xcode - xcode：为什么在图像向右移动的 UITableViewCell 上显示删除图标？

> ID：13689065
> 
> 赞同：0
> 
> 时间：2012-12-03T18:03:23.783
> 
> 标签：xcode, image, uitableview

我的代码在这里：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {

        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"Cell"] autorelease];

    }

    UIImage *myImage = [UIImage imageNamed:@"flower.png"];

    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, cell.frame.size.width, cell.frame.size.height)];

    imageView.autoresizingMask = UIViewAutoresizingFlexibleHeight;

    imageView.contentMode = UIViewContentModeScaleAspectFit;

    imageView.image = myImage;

    [cell.contentView addSubview:imageView];

    [imageView release];

    return cell;
} 
```

实现commitEditingStyle功能后，点击导航栏左侧的编辑按钮，我的图像向右移动。我希望我的图像显示在每个单元格的中心，并且在删除图标显示时不要移动。我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T19:31:53.467

Don't add the image to the contentview but to the view of the cell and set the autoresizing to none.

```
[imageView setAutoresizingMask:UIViewAutoresizingNone];
[cell addSubview:imageView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:21:36.237

如果您的表是组样式的，请尝试将此添加到您的代码中：
`- (BOOL)tableView:(UITableView *)tableView shouldIndentWhileEditingRowAtIndexPath:(NSIndexPath *)indexPath { return NO; }`

# c# - 在 TreeView 外部单击时，如何让 TreeViewItem 离开编辑模式？

> ID：13689069
> 
> 赞同：1
> 
> 时间：2012-12-03T18:03:34.157
> 
> 标签：c#, .net, wpf, listbox, treeview

**问题：**

在下面的示例中，我在左列中有一个 TreeView，在右列中有一个 ListBox。TreeView 显示一小部分示例项目。当用户选择 TreeViewItem 并按 F2 时，该项目通过将其 TextBlock 替换为 TextBox 进入“编辑模式”。

现在，如果我选择第一个 TreeViewItem 并将其置于编辑模式，然后左键单击第二个 TreeViewItem，则第一个项目离开编辑模式，正如预期的那样。

但是，如果我将第一个 TreeViewItem 置于编辑模式，然后在 ListBox 内单击，则 TreeViewItem 仍处于编辑模式。

**当用户在 TreeView 之外单击时，导致 TreeViewItem 离开编辑模式的*可靠方法是什么？***当然，请不要建议我只是在 ListBox 中添加一个鼠标侦听器；我正在寻找一个强大的解决方案。

* * *

**我最好的解决方法：**

我尝试将 IsKeyboardFocusWithinChanged 事件侦听器添加到 TreeView：

```
private static void IsKeyboardFocusWithinChanged(object sender, DependencyPropertyChangedEventArgs e)
{
    var treeView = sender as TreeView;
    if (treeView != null && !treeView.IsKeyboardFocusWithin)
    {
        EditEnding(treeView, false);
    }
} 
```

虽然这确实解决了我的问题，但它有两个不好的副作用：

1.  当 MessageBox 出现时，TreeViewItem 被迫离开编辑模式。
2.  如果我在编辑模式下右键单击 TreeViewItem，则会导致 TreeViewItem 离开编辑模式。这使我无法在 TreeViewItem 的文本框中使用上下文菜单。

* * *

**示例代码：**

（此示例可以[从 Skydrive](http://sdrv.ms/WHpspA)下载）

*MainWindow.xaml：*

```
<Window 
x:Class="WpfApplication3.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
xmlns:wpfApplication3="clr-namespace:WpfApplication3"
Title="MainWindow" Height="350" Width="525"
>
<Window.Resources>
    <DataTemplate x:Key="viewNameTemplate">
        <TextBlock 
            Text="{Binding Name}"
            FontStyle="Normal"
            VerticalAlignment="Center"
            />
    </DataTemplate>

    <DataTemplate x:Key="editNameTemplate">
        <TextBox
            Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
            VerticalAlignment="Center"
            />
    </DataTemplate>

    <Style x:Key="editableContentControl"
        TargetType="{x:Type ContentControl}"
        >
        <Setter
            Property="ContentTemplate"
            Value="{StaticResource viewNameTemplate}"
            />
        <Setter
            Property="Focusable"
            Value="False"
            />
        <Style.Triggers>
            <DataTrigger
                Binding="{Binding Path=IsInEditMode}"
                Value="True"
                >
                <Setter
                    Property="ContentTemplate"
                    Value="{StaticResource editNameTemplate}"
                    />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <TreeView
        Grid.Column="0"
        wpfApplication3:EditSelectedItemBehavior.IsEnabled="{Binding RelativeSource={RelativeSource Self}, Path=IsVisible}"
        ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type wpfApplication3:MainWindow}}, Path=Files}"
        >
        <TreeView.ItemTemplate>
            <DataTemplate>
                <ContentControl 
                    Content="{Binding}" 
                    Focusable="False"
                    Style="{StaticResource editableContentControl}" 
                    />
            </DataTemplate>
        </TreeView.ItemTemplate>
    </TreeView>
    <ListBox
        Grid.Column="1"
        ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type wpfApplication3:MainWindow}}, Path=Files}"
        />
</Grid>
</Window> 
```

*主窗口.xaml.cs*

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        Files = new ObservableCollection<File>();
        Files.Add(new File("A.txt"));
        Files.Add(new File("B.txt"));
        Files.Add(new File("C.txt"));
        Files.Add(new File("D.txt"));

        InitializeComponent();
    }

    public ObservableCollection<File> Files { get; private set; }
} 
```

*EditSelectedItemBehavior.cs*

```
public static class EditSelectedItemBehavior
{
    public static bool GetIsEnabled(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsEnabledProperty);
    }

    public static void SetIsEnabled(DependencyObject obj, bool value)
    {
        obj.SetValue(IsEnabledProperty, value);
    }

    public static readonly DependencyProperty IsEnabledProperty =
        DependencyProperty.RegisterAttached(
            "IsEnabled",
            typeof(bool),
            typeof(EditSelectedItemBehavior),
            new UIPropertyMetadata(false, OnIsEnabledChanged));

    private static void OnIsEnabledChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        var treeView = obj as TreeView;
        if (treeView == null)
        {
            return;
        }

        if (e.NewValue is bool == false)
        {
            return;
        }

        if ((bool)e.NewValue)
        {
            treeView.CommandBindings.Add(new CommandBinding(TransactionCommands.Cancel, CancelExecuted));
            treeView.CommandBindings.Add(new CommandBinding(TransactionCommands.Commit, CommitExecuted));
            treeView.CommandBindings.Add(new CommandBinding(TransactionCommands.Edit, EditExecuted));

            treeView.InputBindings.Add(new KeyBinding(TransactionCommands.Cancel, Key.Escape, ModifierKeys.None));
            treeView.InputBindings.Add(new KeyBinding(TransactionCommands.Commit, Key.Enter, ModifierKeys.None));
            treeView.InputBindings.Add(new KeyBinding(TransactionCommands.Edit, Key.F2, ModifierKeys.None));

            treeView.SelectedItemChanged += SelectedItemChanged;
            treeView.Unloaded += Unloaded;
        }
        else
        {
            for (var i = treeView.CommandBindings.Count - 1; i >= 0; i--)
            {
                var commandBinding = treeView.CommandBindings[i];
                if (commandBinding != null && (commandBinding.Command == TransactionCommands.Cancel || commandBinding.Command == TransactionCommands.Commit || commandBinding.Command == TransactionCommands.Edit))
                {
                    treeView.CommandBindings.RemoveAt(i);
                }
            }

            for (var i = treeView.InputBindings.Count - 1; i >= 0; i--)
            {
                var keyBinding = treeView.InputBindings[i] as KeyBinding;
                if (keyBinding != null && (keyBinding.Command == TransactionCommands.Cancel || keyBinding.Command == TransactionCommands.Commit || keyBinding.Command == TransactionCommands.Edit))
                {
                    treeView.InputBindings.RemoveAt(i);
                }
            }

            treeView.SelectedItemChanged -= SelectedItemChanged;
            treeView.Unloaded -= Unloaded;
        }
    }

    private static void SelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
    {
        var treeView = sender as TreeView;
        if (treeView != null)
        {
            EditEnding(treeView, true);
        }
    }

    private static void Unloaded(object sender, RoutedEventArgs e)
    {
        var treeView = sender as TreeView;
        if (treeView != null)
        {
            EditEnding(treeView, false);
        }
    }

    private static void EditExecuted(object sender, ExecutedRoutedEventArgs e)
    {
        var treeView = sender as TreeView;
        if (treeView != null)
        {
            EditExecuted(treeView);
        }
    }

    private static void CommitExecuted(object sender, ExecutedRoutedEventArgs e)
    {
        var treeView = sender as TreeView;
        if (treeView != null)
        {
            EditEnding(treeView, true);
        }
    }

    private static void CancelExecuted(object sender, ExecutedRoutedEventArgs e)
    {
        var treeView = sender as TreeView;
        if (treeView != null)
        {
            EditEnding(treeView, false);
        }
    }

    private static void EditExecuted(TreeView treeView)
    {
        if (!TreeViewAttachedProperties.GetIsEditingObject(treeView))
        {
            var editableObject = treeView.SelectedItem as IEditableObject;
            TreeViewAttachedProperties.SetEditableObject(treeView, editableObject);

            if (editableObject != null)
            {
                TreeViewAttachedProperties.SetIsEditingObject(treeView, true);
                editableObject.BeginEdit();
            }
        }
    }

    private static void EditEnding(TreeView treeView, bool commitEdit)
    {
        if (TreeViewAttachedProperties.GetIsEditingObject(treeView))
        {
            TreeViewAttachedProperties.SetIsEditingObject(treeView, false);

            var editableObject = TreeViewAttachedProperties.GetEditableObject(treeView);
            if (editableObject != null)
            {
                if (commitEdit)
                {
                    try
                    {
                        editableObject.EndEdit();
                    }
                    catch (ArgumentOutOfRangeException aex)
                    {
                        // This is a hackaround for renaming a Biml file in Mist's project tree view,
                        // where committing an edit triggers an OutOfRange exception, despite the edit working properly.
                        Console.WriteLine(aex.Message + " " + aex.InnerException);
                    }
                }
                else
                {
                    editableObject.CancelEdit();
                }
            }
        }
    }
} 
```

*TreeViewAttachedProperties.cs*

```
public static class TreeViewAttachedProperties
{
    public static readonly DependencyProperty EditableObjectProperty =
           DependencyProperty.RegisterAttached(
               "EditableObject",
               typeof(IEditableObject),
               typeof(TreeViewAttachedProperties));

    [SuppressMessage("Microsoft.Design", "CA1011:ConsiderPassingBaseTypesAsParameters", Justification = "Derived type is intentionally used to restrict the parameter type.")]
    public static void SetEditableObject(TreeView treeView, IEditableObject obj)
    {
        treeView.SetValue(EditableObjectProperty, obj);
    }

    [SuppressMessage("Microsoft.Design", "CA1011:ConsiderPassingBaseTypesAsParameters", Justification = "Derived type is intentionally used to restrict the parameter type.")]
    public static IEditableObject GetEditableObject(TreeView treeView)
    {
        return (IEditableObject)treeView.GetValue(EditableObjectProperty);
    }

    public static readonly DependencyProperty IsEditingObjectProperty =
        DependencyProperty.RegisterAttached(
           "IsEditingObject",
           typeof(bool),
           typeof(TreeViewAttachedProperties));

    [SuppressMessage("Microsoft.Design", "CA1011:ConsiderPassingBaseTypesAsParameters", Justification = "Derived type is intentionally used to restrict the parameter type.")]
    public static void SetIsEditingObject(TreeView treeView, bool value)
    {
        treeView.SetValue(IsEditingObjectProperty, value);
    }

    [SuppressMessage("Microsoft.Design", "CA1011:ConsiderPassingBaseTypesAsParameters", Justification = "Derived type is intentionally used to restrict the parameter type.")]
    public static bool GetIsEditingObject(TreeView treeView)
    {
        return (bool)treeView.GetValue(IsEditingObjectProperty);
    }
} 
```

*TransactionCommands.cs：*

```
public static class TransactionCommands
{
    private static readonly RoutedUICommand _edit = new RoutedUICommand("Edit", "Edit", typeof(TransactionCommands));

    public static RoutedUICommand Edit
    {
        get { return _edit; }
    }

    private static readonly RoutedUICommand _cancel = new RoutedUICommand("Cancel", "Cancel", typeof(TransactionCommands));

    public static RoutedUICommand Cancel
    {
        get { return _cancel; }
    }

    private static readonly RoutedUICommand _commit = new RoutedUICommand("Commit", "Commit", typeof(TransactionCommands));

    public static RoutedUICommand Commit
    {
        get { return _commit; }
    }

    private static readonly RoutedUICommand _delete = new RoutedUICommand("Delete", "Delete", typeof(TransactionCommands));

    public static RoutedUICommand Delete
    {
        get { return _delete; }
    }

    private static readonly RoutedUICommand _collapse = new RoutedUICommand("Collapse", "Collapse", typeof(TransactionCommands));

    public static RoutedUICommand Collapse
    {
        get { return _collapse; }
    }
} 
```

*文件.cs：*

```
public class File : IEditableObject, INotifyPropertyChanged
{
    private bool _editing;
    private string _name;

    public File(string name)
    {
        _name = name;
    }

    public string Name
    {
        get
        {
            return _name;
        }

        set
        {
            if (_name != value)
            {
                _name = value;
                OnPropertyChanged("Name");
            }
        }
    }

    #region IEditableObject

    [Browsable(false)]
    protected string CachedName
    {
        get;
        private set;
    }

    [Browsable(false)]
    public bool IsInEditMode
    {
        get { return _editing; }
        private set
        {
            if (_editing != value)
            {
                _editing = value;
                OnPropertyChanged("IsInEditMode");
            }
        }
    }

    public virtual void BeginEdit()
    {
        // Save name before entering edit mode.
        CachedName = Name;
        IsInEditMode = true;
    }

    [EnvironmentPermission(SecurityAction.Demand, Unrestricted = true)]
    public virtual void EndEdit()
    {
        CachedName = string.Empty;
        IsInEditMode = false;
    }

    public void CancelEdit()
    {
        if (IsInEditMode)
        {
            if (CachedName != null)
            {
                Name = CachedName;
            }

            CachedName = string.Empty;
            IsInEditMode = false;
        }
    }

    public void SetCachedName(string cachedName)
    {
        CachedName = cachedName;
    }

    #endregion

    #region INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T20:17:19.237

当您失去对 TreeViewItem 的关注时，您可以添加一个事件处理程序。

视图模型（或数据上下文）中的事件处理程序方法：

```
 /// <summary>
 /// This is a template method to show that something occurs when you lose focus on the TreeViewItem
 /// </summary>
 /// <param name="sender">TreeViewItem</param>
 /// <param name="e">Routed Event arguments</param>
 public void treeView_FocusLoser(object sender, RoutedEventArgs e) {
      MessageBox.Show("Argg!");
 } 
```

TreeViewItem LostFocus 的 XAML：

```
 <TreeView Name="myTreeView">
      <TreeView.ItemContainerStyle>
           <Style TargetType="{x:Type TreeViewItem}">
                <EventSetter Event="TreeViewItem.LostFocus" Handler="treeView_FocusLoser" />
           </Style>
      </TreeView.ItemContainerStyle>
 </TreeView> 
```

用于 TreeView LostFocus 的 Xaml：

```
 <TreeView Name="myTreeView">
      <TreeView.Style>
           <Style TargetType="{x:Type TreeView}">
                <EventSetter Event="TreeView.LostFocus" Handler="treeView_FocusLoser" />
           </Style>
      </TreeView.Style>
 </TreeView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T20:25:54.537

我遇到了同样的问题，但即使用户在框外点击不可聚焦的元素，也需要触发焦点丢失。我找到了一个解决方案，但它并不漂亮：

在 UI 的主容器元素上，为`PreviewMouseDown`事件创建一个事件处理程序。然后在事件处理程序中，找出点击的来源以及是否需要处理：

```
 private void GridPreviewMouseDown(object sender, MouseButtonEventArgs e)
    {
        var parent = FindVisualParent<StackPanel>((DependencyObject)e.OriginalSource);
        if (parent != null && parent.Tag == "IgnoreClickPanel")
        {
            //ignore previewclicks from these controls
        }
        else
        {
            //prism eventaggregator will notify all user controls which care about this
            eventAggregator.GetEvent<MouseDownEvent>().Publish(true);
        }
        e.Handled = false;
    } 
```

# vb.net - vb.net 从监听私有控件中的按钮单击事件中删除私有方法

> ID：13689071
> 
> 赞同：1
> 
> 时间：2012-12-03T18:03:39.793
> 
> 标签：vb.net, reflection

我在导致崩溃的私有控件中有这个 FindButton_Click 方法。我添加了一个新方法来处理点击事件。我想停止使用反射调用此 FindButton_Click 方法。如果可以删除，您能告诉我吗？

这就是将默认方法添加到私有可覆盖 set 属性中的事件的方式。

```
Dim handler As EventHandler = New EventHandler(AddressOf Me.FindButton_Click)
If (Not Me._mobjFindButton Is Nothing) Then
      RemoveHandler Me._mobjFindButton.Click, handler
End If
If (Not Me._mobjFindButton Is Nothing) Then
    AddHandler Me._mobjFindButton.Click, handler
End If 
```

# javascript - 使用 Javascript 和 SQLite 时的顺序错误

> ID：13689072
> 
> 赞同：0
> 
> 时间：2012-12-03T18:03:45.217
> 
> 标签：javascript, sqlite, loops, nested

亲爱的 Stackoverflow 用户，

我们创建的数据库如下：

```
function populateDB(tx) {
    tx.executeSql('DROP TABLE IF EXISTS Gerechten');
    tx.executeSql('CREATE TABLE IF NOT EXISTS Gerechten (id INTEGER PRIMARY KEY AUTOINCREMENT, Cat TEXT NOT NULL, Name TEXT NOT NULL, Desc TEXT NOT NULL)');
    tx.executeSql('INSERT INTO Gerechten(Cat,Name,Desc) VALUES ("Voorgerecht", "Tomatensoep", "Heerlijke romige tomatensoep")');
    tx.executeSql('INSERT INTO Gerechten(Cat,Name,Desc) VALUES ("Hoofdgerecht", "Pizza", "Kaas en tomaat")');
    tx.executeSql('INSERT INTO Gerechten(Cat,Name,Desc) VALUES ("Voorgerecht", "Groentensoep", "Goed gevulde groentensoep")');
    tx.executeSql('INSERT INTO Gerechten(Cat,Name,Desc) VALUES ("Voorgerecht", "Kippensoep", "Kippensoep met stukjes kip")');
    tx.executeSql('INSERT INTO Gerechten(Cat,Name,Desc) VALUES ("Hoofdgerecht", "Biefstuk", "Biefstuk, wordt geserveerd met patat of rijst")');
} 
```

我有一个Javascript循环的问题，代码如下：

```
function queryDB(tx){
    tx.executeSql('SELECT DISTINCT "Cat" FROM Gerechten',[],function (tx, results) {
        var len = results.rows.length, i;
        msg = "<p>Found rows: " + len + "</p>";
        document.write(msg + '<br/>');
        for (i = 0; i < len; i++){
            document.write(results.rows.item(i).Cat + '<br/>');
            tx.executeSql('SELECT * FROM Gerechten WHERE "Cat" ="'+results.rows.item(i).Cat+'"',[],function (tx, results2) {
                var len2 = results2.rows.length, y;
                msg = "<p>Found rows: " + len2 + "</p>";
                document.write(msg + '<br/>');
                for (y = 0; y < len2; y++){
                    document.write(results2.rows.item(y).Name + '<br/>');
                }
            }, null);
        }
    }, null);
} 
```

代码的问题是首先输出类别，然后显示名称（以正确的顺序）：

```
Voorgerecht
Hoofdgerecht
  Tomatensoep
  Groentensoep
  Kippensoep
  Pizza
  Biefstuk 
```

正确的顺序应该是：

```
Voorgerecht
  Tomatensoep
  Groentensoep
  Kippensoep
Hoofdgerecht
  Pizza
  Biefstuk 
```

有谁知道如何解决这个问题？

亲切的问候，

丹尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:59:49.337

您的问题是`executeSql`异步执行您的函数（其最后一个参数），因此您的外部循环可能会在内部循环的查询完成执行之前打印所有类别。

您应该只使用一个查询，以便您可以按正确的顺序处理所有结果。尝试这样的事情：

```
SELECT * FROM Gerechten ORDER BY Cat 
```

并在列中的值更改时打印类别`Cat`（请参阅 Jose 的答案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:49:09.297

老实说，您不需要多次查询数据库，假设：

> 选择 * 从 Gerechten

并且您的结果包含以下内容，[您可以执行以下操作并且仍然产生相同的结果](http://jsfiddle.net/tADC8/)。显然，您需要实现它以匹配您的 web sql 数据库 api，但逻辑应该保持不变。

```
var results = [
    {
        "Cat" : "Voorgerecht",
        "Name" : "Tomatensoep",
        "Desc" : "Heerlijke romige tomatensoep"
    },{
        "Cat" : "Hoofdgerecht",
        "Name" : "Pizza",
        "Desc" : "Kaas en tomaat"
    },{
        "Cat" : "Voorgerecht",
        "Name" : "Groentensoep",
        "Desc" : "Goed gevulde groentensoep"
    },{
        "Cat" : "Voorgerecht",
        "Name" : "Kippensoep",
        "Desc" : "Kippensoep met stukjes kip"
    },{
        "Cat" : "Hoofdgerecht",
        "Name" : "Biefstuk",
        "Desc" : "wordt geserveerd met patat of rijst"
    }
];

//sorts by the Category
results.sort(compare);
var initial = "";

for(var y = 0; results.length; y++) {
    if(initial != results[y].Cat){
        initial = results[y].Cat;
         document.write(initial + "<br/>");
    }

    document.write("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + results[y].Name + "<br/>");
}

function compare(a,b) {
    if (a.Cat < b.Cat)
        return 1;
    if (a.Cat > b.Cat)
        return -1;    
    else
      return 0;
} 
```

输出

```
Voorgerecht
     Tomatensoep
     Groentensoep
     Kippensoep
Hoofdgerecht
     Pizza
     Biefstuk 
```

# php - Kohana 设置会话和数据库

> ID：13689073
> 
> 赞同：1
> 
> 时间：2012-12-03T18:03:46.823
> 
> 标签：php, orm, kohana

我正在创建一个小型购物车，并将我的产品保存在会话中（无数据库）。我的会话设置产品 ID。但是如何从我的数据库中获取与存储会话中的产品 ID 匹配的正确产品？

代码：

```
foreach ( (isset($shopcart) && is_array($shopcart) && count($shopcart) > 0) ? $shopcart : array() as $item )
{  
    $this->template->shopcart =  $shopcart;
} 
```

.

```
<?php if( isset( $shopcart ) ): ?>
            <?php foreach ($shopcart as $item): ?>
             <?php echo $item['id'] ?>
  <?php endforeach ?>
<?php endif; ?> 
```

编辑：

```
 foreach ( (isset($shopcart) && is_array($shopcart) && count($shopcart) > 0) ? $shopcart : array() as $item )
    {  
        $this->template->shopcart  = DB::select()->where('id', 'IN', $item['id']) ->from('products')->execute();

        //$this->template->shopcart =  $shopcart;
    } 
```

Database_Exception [1064]：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''5'' 附近使用正确的语法 [ SELECT * FROM `products`WHERE `id`IN '5' ]

编辑2：

```
$this->template->shopcart = array();

if (count($shopcart))
{
  $this->template->shopcart = 
    DB::select()
    ->where('id', 'IN', $item)
    ->from('products')
    ->execute();
} 
```

模板：

```
<?php if( isset( $shopcart ) ): ?>
  <?php foreach ($shopcart as $item): ?>
<?php echo $item['id'] ?> //This is the product id in my saved session but i need to get the name from the database

 <?php endforeach ?>
 <?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:14:56.027

您使用的是 ORM 还是查询构建器？如果您使用的是 ORM，您可以这样做：

```
$this->template->shopcart = 
    ORM::factory('products')
    ->where('id', 'IN', $_SESSION['cart'])
    ->find_all(); 
```

如果您使用的是查询生成器：

```
$this->template->shopcart = 
     DB::select()
     ->where('id', 'IN', $_SESSION['cart'])
     ->from('products')
     ->execute(); 
```

在您看来，现在可以随心所欲地迭代您`$shopcart`的。

使用你的案例，（把它从你的循环中取出）

```
$this->template->shopcart = array();

if (count($shopcart))
{
  $product_ids = array();
  foreach ($shopcart as $item)
  {
     $product_ids[] = $item['id'];
  }
  $this->template->shopcart = 
    DB::select()
    ->where('id', 'IN', $product_ids)
    ->from('products')
    ->execute();
} 
```

# asp.net-mvc-3 - MVC3 在同一视图中使用下拉列表模型和其他模型

> ID：13689074
> 
> 赞同：0
> 
> 时间：2012-12-03T18:03:53.203
> 
> 标签：asp.net-mvc-3, view, drop-down-menu, model, visual-studio-2012

我正在使用[这个例子](https://stackoverflow.com/a/9222292/807223)来开发一个下拉列表。在我对视图中调用模型的方式进行一些更改之前，它运行良好。下拉列表模型类称为 dropdownModel。因为我的视图包含 2 个模型，所以我创建了一个“大”模型类 BigModelClass 来保存我的两个模型。

大模型长这样

```
public class BigModelClass {
   public DropDownModel dropDownModel { get; set; }
   public IEnumerable<projectname.Model.model2> var2 { get; set; }
} 
```

在我看来，我将模型称为：

```
@model BigModel 
```

现在在我看来，我调用使用下拉列表如下：

```
@Html.LabelFor(m => m.dropDownModel.State)
@Html.DropDownListFor(m => m.dropDownModel.State,
                 new SelectList(Model.dropDownModel.StateList, "Value", "Text"))
<span class="required"></span>
@Html.ValidationMessageFor(m => m.dropDownModel.State) 
```

不幸的是，我收到以下错误：

> System.NullReferenceException：对象引用未设置为对象的实例。

在线上

> @Html.DropDownListFor(m => m.dropDownModel.State, new SelectList(Model.dropDownModel.StateList, "Value", "Text"))

如果我只使用 dropDownModel 模型，Averything 工作正常。

非常感谢任何帮助

**编辑** 视图的控制器：

```
public ActionResult Index(){
   return View (new BigModelClass());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:20:58.230

假设您直接从该示例中复制了 DropDownModel，您需要向 BigModelClass 添加一个构造函数并在那里实例化 dropDownModel。

```
public class BigModelClass {
   public DropDownModel dropDownModel { get; set; }
   public IEnumerable<projectname.Model.model2> var2 { get; set; }

   public BigModelClass() {
      dropDownModel = new DropDownModel();
   }
} 
```

或者，在您的控制器中，实例化下拉模型：

```
public ActionResult Index(){
   return View (new BigModelClass {
         dropDownModel = new DropDownModel()
   });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:16:26.557

你很可能`Model.dropDownModel`是空的，我很确定你没有在你的默认构造函数中实例化它`BigModelClass()`。当属性定义没问题时`m => m.dropDownModel.State`，它无法返回项目集合的实例：`Model.dropDownModel.StateList`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:24:40.620

发生此问题是因为您没有将数据绑定到下拉列表。您必须将数据绑定到控制器操作中的下拉列表。如果您在控制器操作上绑定数据，请确保它也绑定在 [httppost] 控制器操作中，因为 modelstate.valid 为 false。

```
 public ActionResult Register()
    {
        RegisterModel model = new RegisterModel();
        List<SequrityQuestion> AllSequrityQuestion = new List<SequrityQuestion>();
        model.SequrityQuestions = GetAllSequrityQuestion();

        return View(model);
    }

     [HttpPost]
    public ActionResult Register(RegisterModel model)
    {
        if (!ModelState.IsValid)
        {
            // there was a validation error =>
            // rebind categories and redisplay view

            model.SequrityQuestions = GetAllSequrityQuestion();
        }
        if (ModelState.IsValid)
        {
            // Your code to post
        }

        return View(model);
    } 
```

在上面的例子中，注册模型中有一个名为 SequrityQuestions 的下拉列表。我认为这就是你面临这个问题的原因。如果modelstate.valid为false，请务必将数据绑定到下拉列表，那么您的问题就会消失。

# msbuild - 编译多个文件时如何让MSBuild使用更多线程？

> ID：13689087
> 
> 赞同：1
> 
> 时间：2012-12-03T18:05:18.973
> 
> 标签：msbuild, multiprocessing

我有一个 MSBuild 文件，用于编译目录中的 700 多个头文件。它工作得很好，只是它需要很长时间......如果可能的话，我希望它能够使用多个进程更快地编译这些文件。使用此 XML 作为开始，任何人对如何做到这一点有任何想法吗？

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0"
        xmlns="http://schemas.microsoft.com/developer/msbuild/2003" >

<PropertyGroup>
    ...
</PropertyGroup>

<ItemGroup>
    <SDKFiles   Include="$(CompileDir)\**\*.h" 
            Exclude="$(CompileDir)\**\...;
                    ...
</ItemGroup>

<UsingTask TaskName="CL" AssemblyFile="$(VCTargetsPath)\Platforms\x64\Microsoft.Build.CPPTasks.x64.dll"   Condition="'$(Platform)'=='x64'" />
<UsingTask TaskName="CL" AssemblyFile="$(VCTargetsPath)\Platforms\Win32\Microsoft.Build.CPPTasks.Win32.dll" Condition="'$(Platform)'=='Win32'" />

<Target Name="CompileStuff">
...
    <!-- This CL.exe compiles all the files -->
    <CL Sources="@(SDKFiles)" CompileAs="CompileAsCpp" SuppressStartupBanner="true" ObjectFileName="$(IntDir)" WarningLevel="$(Warnings)" ExceptionHandling="Sync" />
    ...
</Target>
</Project> 
```

我尝试了以下方法，但没有成功： 1\. 在命令行上将 /m 传递给 MSBuild。2\. 我尝试了一些指定多进程的 XML 设置，但它也不起作用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T11:24:14.433

好吧，由于过去 5 个月没有人帮忙，我不妨说我必须编写自己的任务扩展。该任务使用多个线程来编译传入的文件。

# iphone - 转身从 Class 方法中分配一个属性

> ID：13689088
> 
> 赞同：0
> 
> 时间：2012-12-03T18:05:20.217
> 
> 标签：iphone, objective-c, ios, ipad, cocoa

我只是好奇，好像无论如何都要分配一个从类方法触发的属性？

前任：

```
+ (void)asyncResponse:(NSDictionary*)response:(NSError*)error 
```

我`NSURLConnection`在那个调用中得到了响应，但是，我试图在我的另一个类中使用它并将该字典设置为属性，但它给了我错误，因为这是一个类方法。该 asyncResponse 是我用来在运行时定向到任何特定类的“委托调用”。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T23:34:56.550

There are lot of options you may use to store the variable. Why do you need a property in class method. Class method is run when there is no role of instance. But, of course you, could pass create an instance of the class in the class method and store the value in the object. Other way would be to create some global variables and assign the values to it such that it can be accessed through out the class.

Creating instance to store the variable into property;

```
+ (void)asyncResponse:(NSDictionary*)response:(NSError*)error{
  MyClass *me = [[MyClass alloc] init];
  me.someProperty = response;
} 
```

But, I dont think you were looking for this, because it is very simple use of the class and properties.

The other thing you could do is create some static variables inside your implementation and then access those variables through your class. You could even create your own custom getter and setter for it, for more easy uses.

```
@interface MyClass:NSObject
  +(void)setResponse:(NSDictionary*)response;
  +(NSDictionary*)response;
@end

NSDictionary *globalResponse;
@implementation MyClass

+(void)setResponse:(NSDictionary*)response{
  if(response != globalResponse){
    globalResponse = response;
  }
}

+(NSDictionary*)response{
 return globalResponse;
} 
```

You could set the default value for the response in initialize or load method. This makes a simple class level property.

# c - 无法通过 c 标准系统函数执行 bash 命令

> ID：13689090
> 
> 赞同：1
> 
> 时间：2012-12-03T18:05:30.137
> 
> 标签：c

我写的代码片段是这样的：

```
#include <stdlib.h>

int main()
{
  system("/bin/bash ls");
} 
```

当我编译并执行二进制文件时，我得到了结果： **/bin/ls: /bin/ls: 无法执行二进制文件**

那么这里缺少什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:06:46.740

`ls`是一个实际的系统二进制文件。它不是内置的 shell 命令。你只需要`system("ls")`. 现在您正尝试将`ls`二进制文件的内容作为脚本传递给 bash。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:13:39.037

不要`system()`从程序中使用，因为某些环境变量的奇怪值可能会被用来破坏系统完整性。请改用`exec(3)`函数族，但不要使用 execlp(3) 或 execvp(3)。事实上，system() 不会在具有 set-user-ID 或 set-group-ID 权限的系统上正常工作`/bin/sh is bash version 2`，因为 bash 2 在`startup`. （Debian 使用修改后的 bash，它在作为 sh 调用时不会这样做。）

在您的情况下，`ls`shell 中没有内置命令，因此`system()`无法正常工作。

您可以使用`type <cmd_name>`命令检查是否`cmd_name`是内置的。

更多[人 system()](http://linux.die.net/man/3/system)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T18:47:22.003

如果未指定任何选项，则 /bin/bash 的参数是包含要执行的 shell 命令的文件的名称。

要执行命令行上指定的命令，请使用`-c`选项：`/bin/bash -c ls`.

正如其他人所指出的，这样做时有安全考虑，因此您应该寻找替代方案。

# python - Django：N个应用程序共享的1个数据库

> ID：13689091
> 
> 赞同：1
> 
> 时间：2012-12-03T18:05:36.630
> 
> 标签：python, django

我想在几个应用程序之间共享一个 models.py。应该使用 manage.py 从 models.py 创建数据库表。Django 1.4 标准目录结构为：

```
 myproject
  |
  |--  manage.py
  |--  myproject
  |      |
  |       -- settings.py
  |       -- urls.py
  |--  myapp1
  |       |
  |        -- models.py
  |        -- views.py
  |--  myapp2
          |
           -- models.py
           -- views.py 
```

更改此目录结构以实现我想要的最佳方法是什么？将models.py放在myproject目录中，将文件models.py放在myapp1中，它只从以前的models.py导入所有内容并使用“manage.py syncdb”创建数据库表？有没有办法在没有第二个 models.py 的情况下获得相同的结果？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:12:43.543

我喜欢创建一个名为的应用`common`程序，其中包括所有（或多个应用程序）共享的实用程序、基本模型、实用程序基础测试类。

您可以创建一个`common`应用程序并将`models.py`文件放在那里。只要您注册它，您就可以使用`manage.py syncdb`并在您需要的地方导入它的类。

# trigger.io - 确定应用程序是直接打开还是因为通知而打开的任何方法

> ID：13689092
> 
> 赞同：2
> 
> 时间：2012-12-03T18:05:37.037
> 
> 标签：trigger.io

无法弄清楚如何获得启动选项（如果可能的话）。想了解如何弄清楚应用启动机制——也就是说应用是由用户直接启动的，还是因为一个通知而启动的。在使用新的 Safari 智能应用程序横幅时，它甚至会很有帮助。

有类似问题的人吗？对此有任何解决方法或解决方案吗？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T07:14:30.730

我使用此代码来确定我的 Trigger.io 应用程序是否由 Parse 推送通知打开：

```
var appLastResumed = new Date();

window.forge.event.appResumed.addListener(function() {
  window.appLastResumed = new Date();
  // additional code that runs when the app is resumed
});

window.forge.event.messagePushed.addListener(function() {
  // this event fires every time a user clicks on a push notification 
  // no matter whether the app is already opened or not
  // so we need to detect whether this happened right after an appResumed event

  setTimeout( function() { // make sure the appResumed event is fired first
    if (new Date().getTime() - window.appLastResumed.getTime() < 1000) {
      // app was opened by a push notification
      // insert your code here
    }
  }, 50);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T00:52:37.763

您可以通过推送通知或使用自定义 URL 检测应用程序何时打开。

1) 推送通知 - 结合我们与 Parse 的集成使用我们的事件模块来编写在应用程序打开时收到推送通知时运行的代码，或者当它被推送打开时运行：

[http://docs.trigger.io/en/v1.4/modules/event.html#messagepushed-addlistener](http://docs.trigger.io/en/v1.4/modules/event.html#messagepushed-addlistener)

2) 自定义 url - 使用我们的 urlhandler 模块分配一个监听器：

[http://docs.trigger.io/en/v1.4/modules/urlhandler.html](http://docs.trigger.io/en/v1.4/modules/urlhandler.html)

# oracle - PL/SQL 触发器以防止重复

> ID：13689093
> 
> 赞同：0
> 
> 时间：2012-12-03T18:05:39.293
> 
> 标签：oracle, plsql, triggers, duplicates

我有一个名为 TBLAPPLICATION 的表，其中包含指定个人 ID 号和他们申请的工作的 JobID 的数据。每个 ID 号可以有无限个申请，只要 JobID 每次都不一样，就不会重复申请。

```
create or replace
   TRIGGER trg_duplicateapplication BEFORE INSERT ON tblapplication FOR EACH ROW

BEGIN
   IF :NEW.studentrecordnumber_fk_nn = :OLD.studentrecordnumber_fk_nn THEN
      IF :NEW.jobid_fk_nn = :OLD.jobid_fk_nn
         THEN RAISE_APPLICATION_ERROR( -20003, 'Error: duplicate application. You have already applied for this position.');
      END IF;
   END IF;
END; 
```

所以上面的代码不起作用，我希望它会。谁能强调我的错误？:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T18:12:51.840

就目前而言，您的触发器正在将插入的值（`:NEW.studentrecordnumber_fk_nn`等）与不存在的值`:OLD`（对触发器`:OLD`没有意义- `INSERT`<a href="http://docs.oracle.com/cd/E11882_01/appdev.112/ e25519/triggers.htm#LNPLS99955" rel="noreferrer">它的字段总是`null`)。

除此之外，这几乎肯定应该由 DRI 来完成，而不是一个触发器——在 上的唯一索引怎么样`(studentrecordnumber_fk_nn, jobid_fk_nn)`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:56:07.857

您可以使用 MERGE 语句在插入表之前验证每一对（id，application）（检查它是否已经在表中）。

[http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_9016.htm#SQLRF01606](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_9016.htm#SQLRF01606)

问候，

达里约什

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-16T18:10:30.600

我不确定在您的表 TBLAPPLICATION 中哪个标识符是唯一的（可能是 JobID？）以及您不希望您被重复（可能是 studentrecordnumber_fk_nn？）。但是我创建了一个脚本来防止在 studentrecordnumber_fk_nn 上重复。在我的示例“字母表”中，我编写了一个完全相似的脚本来防止重复：您不能插入之前插入表中的字母。

我希望它会有所帮助。z

```
CREATE OR REPLACE TRIGGER trg_duplicateapplication
BEFORE INSERT
ON tblapplication
FOR EACH ROW
DECLARE
counter integer;
BEGIN
  SELECT * INTO counter FROM
      (SELECT COUNT(rownum) FROM tblapplication a
        WHERE a.studentrecordnumber_fk_nn = :new.studentrecordnumber_fk_nn);
  IF counter = 1 THEN
  RAISE_APPLICATION_ERROR( -20003,
  'Error: duplicate application. You have already applied for this position.');
  END IF;
END;
/

––The Alphabet

CREATE TABLE alphabet
(letter VARCHAR2(2));
INSERT INTO alphabet VALUES ('A');
INSERT INTO alphabet VALUES ('B');
INSERT INTO alphabet VALUES ('C');
INSERT INTO alphabet VALUES ('D');

CREATE OR REPLACE TRIGGER insertvalue
BEFORE INSERT
ON alphabet
FOR EACH ROW
DECLARE counter INTEGER;
BEGIN
    SELECT * INTO counter FROM
      (SELECT COUNT(rownum) FROM alphabet a WHERE a.letter = :new.letter);
    IF counter = 1 THEN
      RAISE_APPLICATION_ERROR(-20012,'Duplicated value');
    END IF;
END;
/ 
```

# installshield - 在 installshield 中添加先决条件

> ID：13689094
> 
> 赞同：3
> 
> 时间：2012-12-03T18:05:42.400
> 
> 标签：installshield, prerequisites, installshield-2010

我是 installshield 的新手，我有 installshield 2010，想用 sql server 2008 r2 express 为 vs2010 wpf 项目构建基本 msi 我找到了 sql server 2008 R2 的 .prq 文件，并将该文件复制到“C:\Program Files (x86)\ InstallShield\2010\SetupPrerequisites”这个文件夹，但是当我运行 installshield 时，我的 sql prq 文件没有显示在“安装要求”中以选中复选框并在我的 msi 项目中选择 prq

我试图在谷歌上搜索但没有找到正确的方法请帮助我......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-10T21:58:34.297

转到工具-> 选项。将弹出一个对话框并选择先决条件选项卡。然后，您可以确保它正在检查的先决条件文件夹的位置是您的先决条件所在的位置。

# symfony - 如何在 Query Builder select() 方法中将参数传递给 Doctrine2 自定义函数？

> ID：13689095
> 
> 赞同：1
> 
> 时间：2012-12-03T18:05:42.793
> 
> 标签：symfony, doctrine-orm, symfony-2.1, query-builder

在我的 Symfony2 项目中，我从 Elasticsearch 索引中检索一组有序的实体 ID。然后，我通过`WHERE IN()`调用将此列表传递给 Doctrine2 以检索实际实体。

这不会以正确的顺序返回它们，所以我认为我需要使用 MySQL 特定的`FIELD()`函数。我创建了一个自定义 DQL 函数来允许该功能。

所以现在我使用下面的代码来构建一个 Doctrine 查询对象，但是参数没有被解析到`select()`方法中：

```
$itemIds = array(4,8,2,1);

$this->getRepository()
    ->createQueryBuilder('i')
        ->select('i, FIELD(i.id, :ids_string) AS HIDDEN fixed_order')
        ->where('i.id IN (:ids)')
        ->setParameters(array(
            'ids_string' => implode(',', $itemIds),
            'ids' => $itemIds))
        ->orderBy('fixed_order', 'ASC')
    ->getQuery()
; 
```

这会因错误而失败`"Invalid parameter number: number of bound variables does not match number of tokens"`，因此显然它没有“看到”方法`:ids_string`中的`select()`。

我最初尝试将`FIELD()`函数放入`orderBy()`调用中，但看起来这并没有被解析为自定义 DQL 函数调用，我想我会遇到与上面相同的问题。

**编辑 1**我知道我可以将基础数据直接放入`select()`调用中。

**编辑 2**我已经放弃并将裸数据放入`select()`通话中（我想避免）。这行得通，但随后有必要实施 Koc 的建议，即使用 `HIDDEN`关键字来防止 Doctrine 返回`array(Object i, array(fixed_order))`，而不仅仅是`Object i`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T09:50:05.487

当你发现问题时，你会踢自己......

尝试重新阅读您的句子：“显然它不是在 select() 方法中“看到” **:ids_string** ”。

然后仔细查看您的代码：**'id_string'** => implode(',', $itemIds)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:46:38.957

从 Doctrine 2.2 开始，您可以将`HIDDEN`关键字用于 avability 字段，以便按顺序排列而不用水化它们。

尝试：

```
->select('i, FIELD(i.id, :ids_string) AS HIDDEN fixed_order') 
```

# php - 如何从 PHP 在 jquery 中定义变量

> ID：13689096
> 
> 赞同：0
> 
> 时间：2012-12-03T18:05:54.117
> 
> 标签：php, jquery

我能够将服务器名称传递给成功运行查询的 PHP。在 html 文件中，我希望根据 PHP 文件返回的值来更改评级选项。在我的文件中，我将其设置为 D，但我需要更改它以反映 PHP 返回的内容。

服务器.html

```
<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
        <script type="text/javascript" >
        $(document).ready(function(){
            var id = $('#existingserver').val();            
            $('#assetCenter').click(function(){
                var id = $('#textfield').val();
                $.get('servertest.php',{q:id}, function(htmlData){
                    $('#txtHint').html(htmlData);
                    var rating = $(htmlData).find("td[data-col=rating]").text();
                    alert(rating);
                    });
            });
        });

        </script>
    </head>
    <body>
        <form>
            <label>Existing Server</label><input type="text" name="existingserver" id="textfield" maxlength="15"/>

            <input type="checkbox" id="assetCenter" >Select to Pull Asset Center Data<br>
            <br />
            <br />
            Rating
            <select name="rating" id="rating" >
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
            </select>
        </form>
        <br />

        <div id="txtHint"><b>Server info will be listed here.</b></div>
    </body>
</html> 
```

服务器测试.php

```
<?php
$q=$_GET["q"];

$con = mysql_connect('localhost', 'assignip', 'assignip');
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("ipreservation", $con);

$sql="SELECT * FROM acdata WHERE servername = '".$q."'";

$result = mysql_query($sql);

echo "<table border='1'>
<tr>
<th>Servername</th>
<th>Contact</th>
<th>Classification</th>
<th>Rating</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['servername'] . "</td>";
  echo "<td>" . $row['contact'] . "</td>";
  echo "<td>" . $row['classification'] . "</td>";
  echo "<td>" . $row['rating'] . "</td>";
  echo "</tr>";
  echo "<td data-col='rating'>" . $row['rating'] . "</td>";
  }

  echo "</table>";

mysql_close($con);
?> 
```

数据库字段：servername、contact、classification、rating 数据：Server1、Ray、Production、A

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:17:02.053

简短的回答是使用 JQuery 选择器来获得评分：

```
// get the text of the 4th td
var rating = $(htmlData).find("td").eq(3).text();

$("#rating").val(rating); 
```

* * *

但是，您可能会注意到这种方法有点脆弱（也称为紧密耦合）——如果 UI 发生变化，例如您重新排序列，那么上述逻辑就会中断。

我建议以 JSON 格式从服务器返回数据，然后应用客户端模板来获取 HTML 表。至少，给列起这样的名称：

```
echo "<td data-col='rating'>" . $row['rating'] . "</td>"; 
```

然后您可以通过引用名称在客户端进行选择：

```
var rating = $(htmlData).find("td[data-col=rating]").text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:09:44.040

在您的 PHP 代码中，更改输出，使其显示您想要显示的值，而无需任何 html 标记。

接下来在您的 html 代码中，更改您的 $(document).ready 回调，以便将“D”替换为调用的响应文本（这是 PHP 将返回的内容）。

# django - 为什么这个简单的条件视图代码不起作用？

> ID：13689097
> 
> 赞同：0
> 
> 时间：2012-12-03T18:05:56.660
> 
> 标签：django, django-views

楷模：

```
INTERNAL_STATES = (
    ('1', _('Live')),
    ('2', _('Coming soon')),
    ('3', _('Draft')),
) 
```

看法：

```
if request.user.is_staff is False and building.internal_state is not 1:
    raise Http404
else:
    pass 
```

有人能告诉我为什么这个代码让我登陆 404，即使我试图查看的建筑物在我没有登录时有 internal_state = 1 吗？很抱歉发布这么简单的问题，但我看不出有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:10:58.413

internal_state 的类型是字符串，而不是整数。

试试这个：

```
if not request.user.is_staff and building.internal_state != '1':
    raise Http404
else:
    pass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:53:32.633

即使是整数，与“is”运算符进行比较也可能很危险。在 CPython 实现中，您可以检查是否键入：

```
a = 1
b = 1
a is b
#True 
```

但如果你输入这样的内容：

```
a = -6
b = -6
a is b
#False 
```

事实上，'is' 运算符比较的不是值，而是内存中的地址。

那是我的 50 美分。

# multidimensional-array - 在 numpy 中从二维点数组创建矩形网格（线段列表）

> ID：13689098
> 
> 赞同：1
> 
> 时间：2012-12-03T18:05:58.457
> 
> 标签：multidimensional-array, numpy, mesh

我有一个 MxNx2 二维点数组，其中每个点代表网格的测量属性的中心。图形表示如下，白点是位置：

![在此处输入图像描述](../Images/d78f2d1a5cc450657a757fd1e78f99bd.png)

点结构是这样的（形状：MxNx2）：

```
[[[xij, yij], [xij, yij], ...]],
 [[xij, yij], [xij, yij], ...]],
 [[xij, yij], [xij, yij], ...]],
 [ ..., ...., ............... ],
 [[xij, yij], [xij, yij], ...]]] 
```

所需的输出将是这样的：

```
[[[x1, x2], [y1, y2]],
 [[x1, x2], [y1, y2]],
 ....................,
 [[x1, x2], [y1, y2]] 
```

这样我就可以像这样一个一个地绘制每个段（使用每对 x,y 位置）：

![在此处输入图像描述](../Images/30a83966ef59ddc2ac5659ebb6e09ee3.png)

我尝试过类似的东西：

```
segments = []
for row in xrange(a.shape[0] - 1):
    for col in xrange(a.shape[1] - 1):
        here = a[row, col]
        below = a[row+1, col]
        right = a[row, col+1]
        segments.extend(((here, right), (here, below))) 
```

但这会使右侧和底部边缘未被覆盖。另外，我怀疑这是一种有点“愚蠢”、非矢量化、蛮力的做法，这似乎是一个很常见的问题，可能有一个网格创建功能。

欢迎任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:00:47.630

可以通过分别为轴添加段来完成：

```
for row in xrange(a.shape[0]):
    segments.extend( (a[row, col], a[row, col+1]) for col in xrange(a.shape[1] - 1) )
for col in xrange(a.shape[1]):
    segments.extend( (a[row, col], a[row+1, col]) for row in xrange(a.shape[0] - 1) ) 
```

或与`zip()`：

```
s1 = (a.shape[0]*(a.shape[1]-1), 2)
s2 = (a.shape[1]*(a.shape[0]-1), 2)
segments = list(zip( a[:,:-1].reshape(s1), a[:,1:].reshape(s1))) + \
           list(zip( a[:-1,:].reshape(s2), a[1:,:].reshape(s2))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:48:42.063

如果有人感兴趣，我修改了我正在使用的代码，它现在可以工作了，也许不是那么优雅或高效，但是......

```
pairs = []
for row in xrange(pointarray.shape[0]):
    for col in xrange(pointarray.shape[1]):
        here = pointarray[row, col]
        if row < pointarray.shape[0]-1:
            below = pointarray[row+1, col]
            pairs.append((here, below))
        if col < pointarray.shape[1]-1:
            right = pointarray[row, col+1]
            pairs.append((here, right)) 
```

# c# - 是否有任何简单的程序可以为 Windows 8 应用程序的 JSON 数据绑定生成一个类？

> ID：13689102
> 
> 赞同：2
> 
> 时间：2012-12-03T18:06:17.970
> 
> 标签：c#, windows-8

我正在为一个非常复杂的 Windows 8 应用程序处理大型 JSON 数据。在 .net 中，我们可以绑定类以在解析 JSON 后填充数据。但为此，我们需要一个精确的 JSON 数据类。我很难把课程做好。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:07:57.847

您可以使用[**json2csharp**](http://json2csharp.com/)从 json 生成类

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:47:07.570

通过复制整个 JSON 数据字符串，使用[http://json2csharp.net](http://json2csharp.net)生成类。

然后

```
 public async Task<string>getData()
       {
          HttpClient client=new HttpClient();
    String URL="your string";//url for the JSON response
    HttpResponseMessage response=await client.GetAsync(URL);
    Return await response.Content.ReadAsStringAsync();
    }

   private void async Button1_click ()
   {
      string responseText= await getData();
DataContractJsonSerializer= new DataContractJsonSerializer(typeOf(RootObject));//DataContractJsonSerializer is the class object that u will generate 
RootObject root;
Using(MemoryStream stream=new MemoryStream(Encoding.Unicode.GetBytes(responseText)))
{
    //access properties here
}
} 
```

# javascript - 带有跟踪代码的移动设备的电话号码

> ID：13689104
> 
> 赞同：0
> 
> 时间：2012-12-03T18:06:18.657
> 
> 标签：javascript, jquery, google-analytics, typo3, mobile-website

TYPO3 的用户可以像这样添加电话号码（作为文本）`+49(0)1234/567890`。这将导致以下 HTML 输出。

```
<p class="bodytext">Some Text<br>
    Telephone: +49(0)1234/567890<br>
    Fax: +49(0)1234/56789
</p> 
```

现在我应该重新格式化手机版的电话号码，比如`tel:0049123467890`. 但我必须做更多。我必须在此链接上添加跟踪代码。例如：

```
<a href="tel:0049123467890" onclick="javascript:_gaq.push(['_trackEvent', 'Mobile', 'URL', 'Call']);" target="_blank" title="call me">0049123467890</a> 
```

我该怎么做？

首先，我想到了这样的 Javascript/jQuery 解决方案：

```
<script type="text/javascript">
    /* <![CDATA[ */
    $(function(){
        $("span, p").each(function() {
            var phonelink = '<a href="tel:0049123467890" onclick="' + "javascript:_gaq.push(['_trackEvent', 'Mobile', '" + document.URL + "', 'call']);" + '" target="_blank" title="call me">+49(0)1234/567890</a>';
            var text = $(this).text();
            text = text.replace("+49(0)1234/567890", phonelink);
            $(this).text(text);
        });
    });
    /* ]]> */
</script> 
```

这不符合我的预期。如果我这样做，整个格式都会被破坏。我在这里做错了吗？

一般来说，我会寻找更清洁的解决方案。这意味着内容应该在服务器端进行调整。所以在网站交付到移动设备之前，应该替换 TYPO3 的内容。通常，电话号码不应更改，并且必须确保电话号码始终采用相同的格式。但是在这里我不知道如何实现。

还是我完全错了，有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T15:05:44.177

> 一般来说，我会寻找更清洁的解决方案。这意味着内容应该在服务器端进行调整。所以在网站交付到移动设备之前，应该替换 TYPO3 的内容。

您应该查看可以执行此操作的可能钩子。

该扩展`dmc_hooklist`提供了一个挂钩点列表（参见：[http](http://typo3.org/extensions/repository/view/dmc_hooklist) ://typo3.org/extensions/repository/view/dmc_hooklist ）。

由于有多种实现方式，而您没有提供有关 TYPO3 安装的任何信息，我很难对此给出具体答案。

# javascript - 使用 Yeoman 和 Mocha 对 NodeJS 和客户端进行全面集成测试

> ID：13689110
> 
> 赞同：25
> 
> 时间：2012-12-03T18:06:50.950
> 
> 标签：javascript, unit-testing, node.js, coffeescript, gruntjs

我用 Yeoman 运行了很棒的客户端测试。Yeoman 编译我的 CoffeeScript，在服务器中打开测试页面，使用 PhantomJS 访问它并将所有测试结果传递到命令行。这个过程非常 hacky，测试结果通过`alert()`消息传递给 Phantom 进程，该进程创建一个临时文件并用 JSON 格式的消息填充它。Yeoman（好吧，Grunt）遍历临时文件，解析测试并将它们显示在命令行中。

我解释这个过程的原因是我想给它添加一些东西。我也进行了服务器端测试。他们使用 mocha 和 supertest 来检查 API 端点和 Redis 客户端以确保数据库状态符合预期。但我想合并这两个测试套件！

我不想为服务器调用编写客户端模拟响应。我不想发送服务器模拟数据。在此过程中，我将更改服务器或客户端，并且测试不会失败。我想做一个真正的集成测试。因此，每当测试在客户端完成时，我想要一个钩子在服务器端运行相关测试（检查数据库状态、会话状态、移动到不同的测试页面）。

有什么解决办法吗？或者，或者，我从哪里开始破解 Yeoman / Grunt / grunt-mocha 来完成这项工作？

我认为 grunt-mocha 中的 Phantom Handlers 是一个很好的起点：

```
// Handle methods passed from PhantomJS, including Mocha hooks.
  var phantomHandlers = {
    // Mocha hooks.
    suiteStart: function(name) {
      unfinished[name] = true;
      currentModule = name;
    },
    suiteDone: function(name, failed, passed, total) {
      delete unfinished[name];
    },
    testStart: function(name) {
      currentTest = (currentModule ? currentModule + ' - ' : '') + name;
      verbose.write(currentTest + '...');
    },
    testFail: function(name, result) {
        result.testName = currentTest;
        failedAssertions.push(result);
    },
    testDone: function(title, state) {
      // Log errors if necessary, otherwise success.
      if (state == 'failed') {
        // list assertions
        if (option('verbose')) {
          log.error();
          logFailedAssertions();
        } else {
          log.write('F'.red);
        }
      } else {
        verbose.ok().or.write('.');
      }
    },
    done: function(failed, passed, total, duration) {
      var nDuration = parseFloat(duration) || 0;
      status.failed += failed;
      status.passed += passed;
      status.total += total;
      status.duration += Math.round(nDuration*100)/100;
      // Print assertion errors here, if verbose mode is disabled.
      if (!option('verbose')) {
        if (failed > 0) {
          log.writeln();
          logFailedAssertions();
        } else {
          log.ok();
        }
      }
    },
    // Error handlers.
    done_fail: function(url) {
      verbose.write('Running PhantomJS...').or.write('...');
      log.error();
      grunt.warn('PhantomJS unable to load "' + url + '" URI.', 90);
    },
    done_timeout: function() {
      log.writeln();
      grunt.warn('PhantomJS timed out, possibly due to a missing Mocha run() call.', 90);
    },

    // console.log pass-through.
    // console: console.log.bind(console),
    // Debugging messages.
    debug: log.debug.bind(log, 'phantomjs')
  }; 
```

谢谢！这将有赏金。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-13T19:50:19.700

*我不知道**Yeoman** - 我还没有尝试过 - 但我已经完成了剩下的难题。我相信你会弄清楚其余的。*

## 为什么要进行集成测试？

在您的问题中，您谈论的是同时使用模拟运行客户端测试和服务器端测试的情况。我假设由于某种原因，您无法让两个测试集都使用相同的模拟运行。否则，如果您在客户端更改模拟，您的服务器端测试将失败，因为它们会获取损坏的模拟数据。

您需要的是集成测试，因此当您在无头浏览器中运行一些客户端代码时，您的服务器端代码也将运行。此外，仅仅运行你的服务器端和客户端代码是不够的，你还希望能够在两边都放置断言，不是吗？

## 使用 Node 和 PhantomJS 进行集成测试

我在网上找到的大多数集成测试示例都使用[Selenium](http://seleniumhq.org/)或[Zombie.js](http://zombie.labnotes.org/)。前者是一个基于 Java 的大型框架，用于驱动真正的浏览器，而后者是一个简单的[jsdom](https://github.com/tmpvar/jsdom)包装器。我假设您对使用其中任何一个都犹豫不决，并且更喜欢[PhantomJS](http://phantomjs.org/)。当然，棘手的部分是从你的 Node 应用程序中运行它。我就是这样。

有两个节点模块来驱动 PhantomJS：

1.  [幻影](https://npmjs.org/package/phantom)
2.  [节点幻象](https://npmjs.org/package/node-phantom)

不幸的是，这两个项目似乎都被他们的作者抛弃了，其他社区成员分叉了他们并适应了他们的需求。这意味着这两个项目都被分叉了很多次，而且所有的分叉都几乎没有运行。API 几乎不存在。我用[其中一个幻影叉](https://github.com/sebv/phantomjs-node)运行了我的测试（谢谢你，[Seb Vincent](https://github.com/sebv)）。这是一个简单的应用程序：

```
'use strict';
var express = require('express');

var app = express();

app.APP = {}; // we'll use it to check the state of the server in our tests

app.configure(function () {
    app.use(express.static(__dirname + '/public'));
});

app.get('/user/:name', function (req, res) {
    var data = app.APP.data = {
        name: req.params.name,
        secret: req.query.secret
    };
    res.send(data);
});

module.exports = app;

    app.listen(3000);
})(); 
```

它监听请求`/user`并返回路径参数`name`和查询参数`secret`。这是我调用服务器的页面：

```
window.APP = {};

(function () {
    'use strict';

    var name = 'Alex', secret ='Secret';
    var xhr = new XMLHttpRequest();
    xhr.open('get', '/user/' + name + '?secret=' + secret);
    xhr.onload = function (e) {
        APP.result = JSON.parse(xhr.responseText);
    };
    xhr.send();
})(); 
```

这是一个简单的测试：

```
describe('Simple user lookup', function () {
    'use strict';

    var browser, server;

    before(function (done) {
        // get our browser and server up and running
        phantom.create(function (ph) {
            ph.createPage(function (tab) {
                browser = tab;
                server = require('../app');
                server.listen(3000, function () {
                    done();
                });
            });
        });
    });

    it('should return data back', function (done) {
        browser.open('http://localhost:3000/app.html', function (status) {

            setTimeout(function () {
                browser.evaluate(function inBrowser() {
                    // this will be executed on a client-side
                    return window.APP.result;
                }, function fromBrowser(result) {
                    // server-side asserts
                    expect(server.APP.data.name).to.equal('Alex');
                    expect(server.APP.data.secret).to.equal('Secret');
                    // client-side asserts
                    expect(result.name).to.equal('Alex');
                    expect(result.secret).to.equal('Secret');
                    done();
                });
            }, 1000); // give time for xhr to run

        });
    });
}); 
```

如您所见，我必须在超时内轮询服务器。那是因为所有幻像绑定都不完整且限制太多。如您所见，我能够在一次测试中检查客户端状态和服务器状态。

Run your tests with [Mocha](http://visionmedia.github.com/mocha/): `mocha -t 2s` You'll probably need to increase the default timeout setting for more evolved tests to run.

**So, as you can see the whole thing is doable.** [Here's the repo with complete example.](https://github.com/listochkin/node-phantom-test-example)

# c# - Stylecop：使用父设置文件时出现太多错误，例如 SA1400

> ID：13689115
> 
> 赞同：0
> 
> 时间：2012-12-03T18:07:08.080
> 
> 标签：c#, visual-studio-2010, stylecop

我有一个（公司提供的）stylecop 设置文件，其中包含一些规则。

我将其放入项目的父文件夹中（测试项目，本地，无源代码控制 - stylecop 设置仍然显示“与父文件夹中的设置文件合并”）。

运行 Stylecop (4.7.42, Rescan All) 时，我收到几个警告，如 SA1400、SA1200 等，我没有定义。

另一方面，我有

```
<Analyzer AnalyzerId="Microsoft.StyleCop.CSharp.MaintainabilityRules">
  <Rules>
    <Rule Name="ArithmeticExpressionsMustDeclarePrecedence">
      <RuleSettings>
        <BooleanProperty Name="Enabled">True</BooleanProperty>
      </RuleSettings>
    </Rule>
  </Rules>
  <AnalyzerSettings />
</Analyzer> 
```

和

```
i = i * 2 + 3 * 6; 
```

并且没有得到任何警告。（规则说明：[http](http://stylecop.soyuz5.com/SA1407.html) ://stylecop.soyuz5.com/SA1407.html 。实际上，此处设置 True 或 False 会导致没有消息。）

此外，当打开设置编辑器时，会检查所有设置，尽管我只在我的设置文件中指定了一些设置。

我假设我的设置文件与 Stylecop 报告的内容无关？！

怎么修？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:29:19.550

I think you're looking for this: [https://stackoverflow.com/a/13434198/1505426](https://stackoverflow.com/a/13434198/1505426)

* * *

**Copied from linked answer:**

By default your settings files are merged into parent settings, and this could be causing you some issues. Try stopping the merging at the solution root by adding the following setting:

```
<GlobalSettings>
    <StringProperty Name="MergeSettingsFiles">NoMerge</StringProperty>
</GlobalSettings> 
```

This will ensure that StyleCop acts the same on all development and build machines, regardless of the settings configured higher up the hierarchy (such as the one in the StyleCop application folder). However if you do this, make sure you copy all the required settings from the files no longer being merged.

# sql - 我应该将 CUSIP 定义为什么数据库类型？

> ID：13689118
> 
> 赞同：2
> 
> 时间：2012-12-03T18:07:24.273
> 
> 标签：sql, sql-server, finance

如果[CUSIP](http://en.wikipedia.org/wiki/Cusip)被定义为

> CUSIP 是一个 9 个字符的字母数字代码，用于识别北美金融证券，以促进交易的清算和结算。

那么我应该在我的 SQL Server 数据库中设置什么类型呢？有什么我需要考虑的因素吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:09:45.437

如果我理解正确，它是固定长度的，对吗？总是 9 个字符 - 永远不会更多，永远不会更少？

在这种情况下，我会使用，**`CHAR(9)`**因为使用`VARCHAR`可变长度的 a 对您没有任何好处，并且会带来一些开销。而且由于它是北美标准，我怀疑您必须输入西里尔文、阿拉伯文、希伯来文或远东字符，因此`CHAR`（非 Unicode，每个字符 1 个字节）就足够了。

*它是字母数字代码*这一事实立即排除了所有数字数据类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:29:43.000

需要考虑的最大因素是 CUSIPS 可以并且确实会改变。我会将 cusip 存储为 char(9)，但一定要考虑到它们可能会发生变化，所以不要错误地将它们设置为数据库中的唯一键。

# c# - 使 ListViewItems 平等地共享空间

> ID：13689120
> 
> 赞同：-1
> 
> 时间：2012-12-03T18:07:28.577
> 
> 标签：c#, wpf

我有一个垂直的 ListView，只有一列。我有一个 ItemTemplate 来绘制我的 ListViewItems。目前，每个 ListViewItem 占用所需的最小空间。我希望他们占用最大的可用空间，因此它们在它们之间平均共享可用空间。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:31:14.150

原来诀窍是更改 ListView 的 ItemsPanel。

```
<ListView.ItemsPanel>
  <ItemsPanelTemplate>
    <UniformGrid Columns="1"></UniformGrid>
  </ItemsPanelTemplate>
</ListView.ItemsPanel> 
```

# c# - 向量列表需要一些基础知识

> ID：13689121
> 
> 赞同：0
> 
> 时间：2012-12-03T18:07:31.593
> 
> 标签：c#, xna-4.0

**嗨，我有这些向量：**

```
 Vector2 ground1p1 = new Vector2(0,430);
    Vector2 ground1p2 = new Vector2(200,430);
    Vector2 ground1p3 = new Vector2(0, 290);
    Vector2 ground1p4 = new Vector2(280, 340); 
```

**我想把它们放在一个列表中，而不是这样做：**

```
if (DetectPlayerAndGround1Collision2(playerPosition,ground1p1,player,ground1) == true)
            {
                hasJumped = false;
                velocity.Y = 0f;
            }
            if (DetectPlayerAndGround1Collision2(playerPosition, ground1p2, player, ground1) == true)
            {
                hasJumped = false;
                velocity.Y = 0f;
            } 
```

**这是我在文字末尾写“向量”时的问题，没有任何事情发生，就像我没有声明为列表一样：**

```
 public class Game1 : Microsoft.Xna.Framework.Game
     {

        GraphicsDeviceManager graphics;
        SpriteBatch spriteBatch;

        public Game1()
        {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";
        }

        protected override void Initialize()
        {

            base.Initialize();
        }

        bool hasJumped = true;

        Vector2 velocity;
        Texture2D player;
        Texture2D ground1;
        List<Vector2> vectors = new List<Vector2>();

        Vector2 playerPosition = new Vector2(30, 300);
        Vector2 ground1p1 = new Vector2(0,430);
        Vector2 ground1p2 = new Vector2(200,430);
        Vector2 ground1p3 = new Vector2(0, 290);
        Vector2 ground1p4 = new Vector2(280, 340); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:10:31.957

您可以使用列表（如您所建议的）

```
List<Vector2> vectors = new List<Vector2>();

vectors.Add(ground1p1);
vectors.Add(ground1p2);
vectors.Add(ground1p3);
vectors.Add(ground1p4);

foreach (Vector2 vec2 in vectors) 
{
    if (DetectPlayerAndGround1Collision2(playerPosition, vec2, player, ground1))
    {
        hasJumped = false;
        velocity.Y = 0f;         

        // maybe add a break to prevent superfluous calls
        break;
    }
} 
```

# iphone - 是安装还是更新？

> ID：13689122
> 
> 赞同：1
> 
> 时间：2012-12-03T18:07:35.430
> 
> 标签：iphone, ios, cocoa-touch, app-store

有没有办法告诉（比如在 appDelegate 中）应用程序是否已从 iTunes 更新而不是安装？

我知道我可以构建一些看起来在 NSUserDefaults 中的东西，或者我在 AppStore 中已经有一个版本的东西，并且需要知道我是否正在更新某人的安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:35:40.210

您可以在首次启动应用程序时存储捆绑版本号。因此，第一次安装应用程序时，无论它是什么捆绑版本号，该对象之前从未存储在磁盘上，这就是您检测全新安装的方式。

每次发布更新时，您还会增加捆绑版本号，您可以在代码中将其检测为更新（当然，在检测到更新后，您也会增加存储的版本号）

# jquery - jQuery使用变量访问元素

> ID：13689123
> 
> 赞同：2
> 
> 时间：2012-12-03T18:07:44.847
> 
> 标签：jquery

HTML：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<script src="jQuery/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="js/script1.js" type="text/javascript"></script>
</head>
<body>

<div>
    <ul>
        <li>One</li>
        <li>Two</li>
        <li>Three</li>
    </ul>

</div>    

</body>
</html> 
```

有效的脚本：

```
$(document).ready(function () {
$('li:nth-child(2)').fadeOut('fast');
}); 
```

现在我只是使用一个变量来做同样的事情，它不再起作用了。

```
var $var = $('li:nth-child(2)');
$(document).ready(function () {
$var.fadeOut('fast');
}); 
```

谁能告诉我正确的语法。我刚刚开始学习 jQuery，知道这可能是一个简单的错误，但我就是想不通。提前致谢。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:09:03.073

将其放入实际存在的`document ready function`时间：`li`

```
$(document).ready(function () {
   var $var = $('li:nth-child(2)');
   $var.fadeOut('fast')
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:09:16.563

变量需要在内部赋值`$(document).ready(function() { }`

# asp.net - 在 Windows Azure ASP.NET 应用程序中使用通配符 SSL 子域

> ID：13689127
> 
> 赞同：3
> 
> 时间：2012-12-03T18:07:53.760
> 
> 标签：asp.net, ssl, azure, wildcard-subdomain

我有以下场景，我需要帮助才能将其部署到 Windows Azure。

我有以下 ASP.NET 站点，它根据 DNS 名称的第一部分路由客户：

[https://customer1.mysite.com](https://customer1.mysite.com)

[https://customer2.mysite.com](https://customer2.mysite.com)

[https://customer3.mysite.com](https://customer3.mysite.com)

...

[https://customerN.mysite.com](https://customerN.mysite.com)

我有一个带有以下主题名称 *.mysite.com 的通配符 SSL 证书

我必须做什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:17:45.137

只需将其上传到门户并像使用任何其他 SSL 证书一样使用它。我自己做了，它没有问题。有关 SSL 和 Azure 的一般信息，请访问：http: [//msdn.microsoft.com/en-us/library/windowsazure/ff795779.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ff795779.aspx)

# android - mupdf limits.h：mac os x 中没有这样的文件或目录

> ID：13689129
> 
> 赞同：0
> 
> 时间：2012-12-03T18:08:00.193
> 
> 标签：android, macos, gcc, mupdf

我正在尝试编译 mupdf 项目以在 android 应用程序中使用它。我已经完成了所有步骤，直到我必须在我使用 Mac Os 10.7.5 的 SO 中编译“生成”文件夹。当我尝试在项目的顶级文件夹中执行“make”时，问题就来了，我总是遇到同样的错误。

```
 CC build/debug/ft_ftbase.o
In file included from thirdparty/freetype-2.4.10/include/freetype/config/ftstdlib.h:60,
                 from thirdparty/freetype-2.4.10/include/freetype/config/ftconfig.h:43,
                 from thirdparty/freetype-2.4.10/include/freetype/freetype.h:33,
                 from thirdparty/freetype-2.4.10/src/base/ftpic.c:20,
                 from thirdparty/freetype-2.4.10/src/base/ftbase.c:23:
/Developer/usr/bin/../lib/gcc/i686-apple-darwin9/4.2.1/include/limits.h:10:25: error: limits.h: No such file or directory
In file included from thirdparty/freetype-2.4.10/include/freetype/config/ftconfig.h:43,
                 from thirdparty/freetype-2.4.10/include/freetype/freetype.h:33,
                 from thirdparty/freetype-2.4.10/src/base/ftpic.c:20,
                 from thirdparty/freetype-2.4.10/src/base/ftbase.c:23:
thirdparty/freetype-2.4.10/include/freetype/config/ftstdlib.h:77:20: error: string.h: No such file or directory
thirdparty/freetype-2.4.10/include/freetype/config/ftstdlib.h:101:19: error: stdio.h: No such file or directory
thirdparty/freetype-2.4.10/include/freetype/config/ftstdlib.h:119:20: error: stdlib.h: No such file or directory
thirdparty/freetype-2.4.10/include/freetype/config/ftstdlib.h:155:20: error: setjmp.h: No such file or directory
In file included from thirdparty/freetype-2.4.10/include/freetype/freetype.h:33,
thirdparty/freetype-2.4.10/include/freetype/config/ftconfig.h:127:19: error: errno.h: No such file or directory
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:28:
thirdparty/freetype-2.4.10/src/base/ftgloadr.c: In function ‘FT_GlyphLoader_CheckPoints’:
thirdparty/freetype-2.4.10/src/base/ftgloadr.c:234: warning: implicit declaration of function ‘memmove’
thirdparty/freetype-2.4.10/src/base/ftgloadr.c:234: warning: incompatible implicit declaration of built-in function ‘memmove’
thirdparty/freetype-2.4.10/src/base/ftgloadr.c: In function ‘FT_GlyphLoader_CopyPoints’:
thirdparty/freetype-2.4.10/src/base/ftgloadr.c:375: warning: implicit declaration of function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftgloadr.c:375: warning: incompatible implicit declaration of built-in function ‘memcpy’
In file included from thirdparty/freetype-2.4.10/src/base/ftobjs.c:22,
  from thirdparty/freetype-2.4.10/src/base/ftbase.c:29:
thirdparty/freetype-2.4.10/include/freetype/internal/ftvalid.h: At top level:
thirdparty/freetype-2.4.10/include/freetype/internal/ftvalid.h:87: error: expected specifier-qualifier-list before ‘jmp_buf’
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:29:
thirdparty/freetype-2.4.10/src/base/ftobjs.c: In function ‘ft_service_list_lookup’:
thirdparty/freetype-2.4.10/src/base/ftobjs.c:58: warning: implicit declaration of function ‘strcmp’
thirdparty/freetype-2.4.10/src/base/ftobjs.c: In function ‘ft_validator_error’:
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: nested functions are disabled, use -fnested-functions to re-enable
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: ‘jump_buffer’ undeclared (first use in this function)
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: (Each undeclared identifier is reported only once
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: for each function it appears in.)
thirdparty/freetype-2.4.10/src/base/ftobjs.c:100: error: ‘volatile struct FT_ValidatorRec_’ has no member named ‘jump_buffer’
thirdparty/freetype-2.4.10/src/base/ftobjs.c:107: warning: implicit declaration of function ‘longjmp’
thirdparty/freetype-2.4.10/src/base/ftobjs.c:107: error: ‘jmp_buf’ undeclared (first use in this function)
thirdparty/freetype-2.4.10/src/base/ftobjs.c:107: error: expected expression before ‘)’ token
thirdparty/freetype-2.4.10/src/base/ftobjs.c: In function ‘ft_glyphslot_clear’:
thirdparty/freetype-2.4.10/src/base/ftobjs.c:319: warning: implicit declaration of function ‘memset’
thirdparty/freetype-2.4.10/src/base/ftobjs.c:319: warning: incompatible implicit declaration of built-in function ‘memset’
thirdparty/freetype-2.4.10/src/base/ftobjs.c: In function ‘FT_Request_Metrics’:
thirdparty/freetype-2.4.10/src/base/ftobjs.c:2737: warning: incompatible implicit declaration of built-in function ‘memset’
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:30:
thirdparty/freetype-2.4.10/src/base/ftoutln.c: In function ‘FT_Outline_Copy’:
thirdparty/freetype-2.4.10/src/base/ftoutln.c:404: warning: incompatible implicit declaration of built-in function ‘memcpy’
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:31:
thirdparty/freetype-2.4.10/src/base/ftrfork.c: In function ‘FT_Raccess_Get_DataOffsets’:
thirdparty/freetype-2.4.10/src/base/ftrfork.c:213: warning: implicit declaration of function ‘qsort’
thirdparty/freetype-2.4.10/src/base/ftrfork.c: In function ‘raccess_guess_darwin_hfsplus’:
thirdparty/freetype-2.4.10/src/base/ftrfork.c:510: warning: implicit declaration of function ‘strlen’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:510: warning: incompatible implicit declaration of built-in function ‘strlen’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:523: warning: incompatible implicit declaration of built-in function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftrfork.c: In function ‘raccess_guess_darwin_newvfs’:
thirdparty/freetype-2.4.10/src/base/ftrfork.c:546: warning: incompatible implicit declaration of built-in function ‘strlen’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:559: warning: incompatible implicit declaration of built-in function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftrfork.c: In function ‘raccess_make_file_name’:
thirdparty/freetype-2.4.10/src/base/ftrfork.c:791: warning: incompatible implicit declaration of built-in function ‘strlen’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:795: warning: implicit declaration of function ‘strrchr’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:795: warning: incompatible implicit declaration of built-in function ‘strrchr’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:798: warning: implicit declaration of function ‘strncpy’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:798: warning: incompatible implicit declaration of built-in function ‘strncpy’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:808: warning: implicit declaration of function ‘strcat’
thirdparty/freetype-2.4.10/src/base/ftrfork.c:808: warning: incompatible implicit declaration of built-in function ‘strcat’
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:33:
thirdparty/freetype-2.4.10/src/base/ftstream.c: In function ‘FT_Stream_ReadAt’:
thirdparty/freetype-2.4.10/src/base/ftstream.c:145: warning: incompatible implicit declaration of built-in function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftstream.c: In function ‘FT_Stream_TryRead’:
thirdparty/freetype-2.4.10/src/base/ftstream.c:182: warning: incompatible implicit declaration of built-in function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftstream.c: In function ‘FT_Stream_ReadFields’:
thirdparty/freetype-2.4.10/src/base/ftstream.c:770: warning: incompatible implicit declaration of built-in function ‘memcpy’
In file included from thirdparty/freetype-2.4.10/src/base/ftbase.c:35:
thirdparty/freetype-2.4.10/src/base/ftutil.c: In function ‘ft_mem_alloc’:
thirdparty/freetype-2.4.10/src/base/ftutil.c:58: warning: incompatible implicit declaration of built-in function ‘memset’
thirdparty/freetype-2.4.10/src/base/ftutil.c: In function ‘ft_mem_realloc’:
thirdparty/freetype-2.4.10/src/base/ftutil.c:104: warning: incompatible implicit declaration of built-in function ‘memset’
thirdparty/freetype-2.4.10/src/base/ftutil.c: In function ‘ft_mem_dup’:
thirdparty/freetype-2.4.10/src/base/ftutil.c:186: warning: incompatible implicit declaration of built-in function ‘memcpy’
thirdparty/freetype-2.4.10/src/base/ftutil.c: In function ‘ft_mem_strdup’:
thirdparty/freetype-2.4.10/src/base/ftutil.c:198: warning: incompatible implicit declaration of built-in function ‘strlen’
make: *** [build/debug/ft_ftbase.o] Error 1 
```

我不知道我能做什么，因为我有“limits.h”文件和其他编译器说没有出现的文件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T10:00:25.353

您是否检查了位置“/Developer/usr/bin/../lib/gcc/i686-apple-darwin9/4.2.1/include”以查看该文件夹中是否存在limits.h？（我知道你说你有文件，但它安装*在哪里？）*

我们怀疑您的 gcc 安装已损坏，或者（可能）存在某种路径问题，因为找不到的 .h 文件是系统文件，而不是 MuPDF 或第 3 方库的一部分。

MuPDF 的主要开发人员 FWIW 在 Mac 上完成了他所有的 Android 开发工作，因此我们非常确定它在安装 gcc 或 MuPDF 时无需任何额外步骤即可工作。

# java - log4j 和 DOMConfigurator.configureAndWatch() 函数

> ID：13689132
> 
> 赞同：1
> 
> 时间：2012-12-03T18:08:12.560
> 
> 标签：java, log4j

我想在运行时使用 DOMConfigurator.configureAndWatch() 函数覆盖 log4j 配置。当文件参数的字符串名称被硬编码时，它是有效的。例如 ：`DOMConfigurator.configureAndWatch("C:/some/path/log4j.xml");`

但是我的 log4j.xml 在 EAR 文件中（在 lib 目录中的 JAR 中），我如何在运行时访问它？

我进行了测试`DOMConfigurator.configureAndWatch("log4j.xml");`，但似乎 Glassfish 正在尝试从`${GLASSFISH_HOME}/glassfish/domains/domain1/config`我的旧 log4j.xml 文件所在的位置搜索文件以覆盖...所以实际上我的代码从同一个文件加载、重置和重新加载配置...

我只是在寻找一种将 log4j.xml 加载到 EAR 中的方法

感谢您的想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:11:03.120

调用[`getClass().getResourceAsStream("/log4j.xml")`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)JAR/EAR 中的类以读取`log4j.xml`位于 JAR/EAR 根目录的文件。然后，将结果传递`InputStream`给[`DOMConfigurator.doConfigure(InputStream, LoggerRepository)`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/xml/DOMConfigurator.html#doConfigure%28java.io.InputStream,%20org.apache.log4j.spi.LoggerRepository%29)

或者，您可以调用`DOMConfigurator`. . ，其中返回JAR/EAR 中的对象。[`configure`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/xml/DOMConfigurator.html#configure%28java.net.URL%29)`(getClass()`[`getResource`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getResource%28java.lang.String%29)`("/log4j.xml"))``getClass()``Class`

# javascript - 如何根据 td 为 tr 添加 css 属性

> ID：13689133
> 
> 赞同：1
> 
> 时间：2012-12-03T18:08:14.587
> 
> 标签：javascript, jquery

我想根据表格中的 td 单元格值将类应用于 tr。

我的 html

```
<table class="k-focusable">
 <tr>
  <th>Name</th>
  <th>Favorite color</th>
<th> status</th>
 </tr>
  <td>James</td>
  <td>red</td>
<td>false</td>
 </tr>
 <tr>
  <td>John</td>
  <td>blue</td>
  <td>true</td>
 </tr>
</table>

var cellIndexMapping = { 2: true };
$("table.k-focusable tbody tr").each(function (rowIndex) {
            $(this).find("td").each(function (cellIndex) {
                if (x[cellIndex]) {
                    var c = $(this).text();
                    if (($.trim(c) == "false") || ($.trim(c) == "null")) {
                        $("table.k-focusable tbody tr").find("td").addClass("hover");
                    }
                }
            });
        });

.hover
{
 font-weight:bold
} 
```

当我这样做时，每一行都有这个类悬停。但我希望只有当 td 值为 false 或 null 时才添加该类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:09:32.653

尝试这个

```
$("table.k-focusable tbody tr td:contains('false')") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:13:46.057

尝试这个

```
$("table.k-focusable tbody tr").each(function(rowIndex) {
    var $td = $(this).find("td:eq(2)");
    var c = $td.text();
    if (($.trim(c) == "false") || ($.trim(c) == "null")) {
        $td.closest('tr').addClass("hover");
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/tGYjj/1/)**

首先，您不需要第二个`$.each`来迭代 td。然后，您可以参考`td`要更改的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:13:44.717

在你的测试`if (($.trim(c) == "false") ...`中，你选择所有`td`。您只需将类应用于当前单元格，因为您已经在单元格上循环：

```
$(this).addClass("hover"); 
```

# maven - 将多个 JAR 和 Javadoc 添加到本地 Maven 存储库

> ID：13689136
> 
> 赞同：1
> 
> 时间：2012-12-03T18:08:19.813
> 
> 标签：maven, javadoc, business-objects, business-objects-sdk

我有许多 JAR 文件，它们包含两个不同的用于 BOXI R3.1 的 Java SDK：[BusinessObjects Enterprise Java SDK](http://help.sap.com/businessobject/product_guides/boexir31/en/boesdk_java_apiRef_12_en.zip)和[Web Services Consumer Java SDK](http://help.sap.com/businessobject/product_guides/boexir31/en/wssdk_java_apiRef_12_en.zip)。

BusinessObjects Enterprise Java SDK 有许多“核心”JAR：

```
biarengine.jar
biplugins.jar
cecore.jar
celib.jar
ceplugins_client.jar
ceplugins_core.jar
ceplugins_cr.jar
cereports.jar
cesession.jar
ceutils.jar
corbaidl.jar
ebus405.jar
flash.jar
SL_plugins.jar
logging.jar
pluginhelper.jar
xcelsius.jar 
```

和一些依赖项：

```
asn1.jar
backport-util-concurrent-2.2.jar
certj.jar
commons-logging.jar
derby.jar
freessl201.jar
jsafe.jar
log4j.jar
rascore.jar
sslj.jar 
```

Javadocs 以 ZIP 文件的形式提供。

Web 服务 SDK 的情况类似，因此我将省略详细信息。

目标：将每个 SDK 及其 Javadoc 打包为本地 Maven 存储库（SAP 似乎没有提供远程存储库）。

问题：

*   一个 Maven 存储库可以包含多个 JAR 文件吗？该`mvn deploy:deploy-file`插件似乎只适用于单个文件：[How to add a jar, source and Javadoc to the local Maven repository?](https://stackoverflow.com/questions/9386589/how-to-add-a-jar-source-and-javadoc-to-the-local-maven-repository)
*   Javadocs 是否应该以 ZIP 格式保存在 Maven 存储库中？
*   如果我选择为给定的 SDK（即核心和依赖项）创建 repos，指定链接是否像编辑核心 repos 的配置文件一样容易？
*   我假设最好识别和引用现有的 Maven 存储库（例如 log4j.jar），而不是为依赖项创建存储库。这会导致我进入 JAR 地狱吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-04T15:08:33.353

是的，一个 maven repo 可以包含多个文件，您可以在每个文件上执行 mvn deploy:deploy-file （根据需要使用 -Djavadoc 和 -Dsources ）。

要为 jar 指定依赖项，请为其创建一个 pom 文件（带有依赖项）并在 mvn deploy:deploy-file 中使用 -DpomFile（并省略 -DgeneratePom）。

是的，您不应该重新发明轮子并将工件部署到已经位于中心的存储库。您可以使用[http://mvnrepository.com](http://mvnrepository.com)之类的工具来搜索您的 jars（在您的 jars 中查看 META-INF/MANIFEST.MF 以查找版本）。

有关更多信息，请参阅：[http](http://maven.apache.org/plugins/maven-deploy-plugin/deploy-file-mojo.html) ://maven.apache.org/plugins/maven-deploy-plugin/deploy-file-mojo.html 。

# xml - 使用模板递归将 xsl 转换为 xhtml

> ID：13689137
> 
> 赞同：0
> 
> 时间：2012-12-03T18:08:31.680
> 
> 标签：xml, xslt, xpath

我正在`<div>`使用递归模板匹配将所有 xml 元素转换为 xhtml 标记。

基本上，我希望将元素`name()`变成类名，即 .`<div class="name()">value</div>`

我使用了以下内容：

```
<body>
    <xsl:apply-templates />
</body>

<xsl:template match="*">
  <div class="{name()}"><xsl:value-of select="."/>
  <xsl:apply-templates select="*"/>
  </div>
</xsl:template> 
```

它工作得很好，除了它会提取父标签上的值。例如，这个 xml

```
 <TotalPayments>
    <Amount>26.96</Amount>
    <TaxableAmount>26.96</TaxableAmount>
    <TaxAmount>0.00</TaxAmount>
    <ShippingAmount>0.00</ShippingAmount>
  </TotalPayments> 
```

变成：

```
<div class="TotalPayments">
        26.96
        26.96
        0.00
        0.00
  <div class="Amount">26.96</div>
  <div class="TaxableAmount">26.96</div>
  <div class="TaxAmount">0.00</div>
  <div class="ShippingAmount">0.00</div>
</div> 
```

我只想要

```
<div class="TotalPayments">
  <div class="Amount">26.96</div>
  <div class="TaxableAmount">26.96</div>
  <div class="TaxAmount">0.00</div>
  <div class="ShippingAmount">0.00</div>
</div> 
```

而且它在树上变得越来越糟。根也有这一切。

所以我应该做一个测试还是只能选择某些类型。我也试过匹配

```
* | text()
* | node() 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:14:20.167

只需删除`<xsl:value-of select="."/>`，然后将 更改`<xsl:apply-templates select="*"/>`为`<xsl:apply-templates/>`。这样，文本节点子节点的默认模板将输出它们（并且元素子节点的处理方式与以前相同）。

# mobile - 通过 IP 地址检测移动运营商

> ID：13689138
> 
> 赞同：3
> 
> 时间：2012-12-03T18:08:33.697
> 
> 标签：mobile, operator-keyword, carrier

我需要通过 IP 地址确定移动运营商名称。我已经搜索了堆栈和谷歌，但没有发现任何仍然有效的东西。

我的情况：

IP 37.108.abc.xyz 在波兰被运营商 Orange 使用。Orange 属于 PTK Centertel，您可以通过 whois 在 ISP 名称和域名中看到它。现在，我需要匹配这些。更重要的是，我需要最新的数据（最近在波兰时代改为 T-Mobile，我想知道），最后，我需要 API 来获取这些数据。当然，我愿意为这样的服务付费。

有这样的服务吗？如果没有，我怎么能自己做到这一点？

# c# - webclient wp7的错误

> ID：13689141
> 
> 赞同：0
> 
> 时间：2012-12-03T18:09:02.527
> 
> 标签：c#, windows-phone-7, webclient

我正在使用 WebClient 对象从服务器轮询一些数据。当 DownloadStringCompleted 执行时，我会进行错误检查：e.error，其中“e”是 DownloadStringCompletedEventArgs，如果发生错误，我会输出消息。一切正常，但是当我在 PHONE 上运行 3G 应用程序时，我收到一个错误“远程服务器响应：未找到”。但是，如果我打开 WiFi 一切正常。在具有此 url 的浏览器页面中打开并在模拟器上，一切正常。也许这是有史以来最愚蠢的问题，但我真的不明白发生了什么：D

我能做些什么来解决这个问题？！

PS对不起我的英语。必应翻译帮我=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T06:50:39.827

问题解决了。它帮助了我

```
WebClient webClient = new WebClient();
                webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler(clientED2_DownloadStringCompleted);
                webClient.DownloadStringAsync(new Uri("http://www.server.com"), "GET"); 
```

取而代之的是

```
WebClient webClient = new WebClient();
                    webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler(clientED2_DownloadStringCompleted);
                    webClient.DownloadStringAsync(new Uri("http://www.server.com")); 
```

# vb.net - Try/Catch 是否比哈希查找更便宜？

> ID：13689144
> 
> 赞同：4
> 
> 时间：2012-12-03T18:09:09.890
> 
> 标签：vb.net, exception-handling

我知道异常捕获可能很昂贵，但我想知道是否存在实际上比查找便宜的情况？

例如，如果我有一个大字典，我可以测试一个键是否存在：

```
If MyDictionary.ContainsKey(MyKey) Then _
  MyValue = MyDictionary(MyKey) ' This is 2 lookups just to get the value. 
```

或者，我可以捕获一个异常：

```
Try
  MyValue = MyDictionary(MyKey) ' Only doing 1 lookup now.
Catch(e As Exception)
  ' Didn't find it.
End Try 
```

异常捕获总是比上面的查找更昂贵，还是在某些情况下更便宜？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:19:07.173

关于字典查找的事情是它们发生在恒定或接近恒定的时间。无论您的字典包含一个项目还是一百万个项目，您的计算机所花费的时间大致相同。我提出这个问题是因为您担心在大字典中进行两次查找，而现实情况是，这与在小型字典中进行两次查找并没有太大区别。作为旁注，这里的一个含义是字典并不总是小型集合的最佳选择，尽管我通常发现额外的清晰度仍然超过这些小型集合的任何性能问题。

决定字典查找速度的因素之一是为特定对象生成[*哈希值所需的时间。*](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)有些对象可以比其他对象快得多。这意味着这里的答案取决于字典中的对象类型。因此，唯一确定的方法是构建一个版本，对每种方法进行数十万次测试，以找出哪个更快地完成集合。

这里要记住的另一个因素是，它主要只是 Catch 块在异常处理方面很慢，因此您需要寻找与您在生产中期望的合理匹配的查找命中和未命中的正确组合。出于这个原因，您无法在此处找到一般指南，或者如果您这样做，则很可能是错误的。如果您很少有遗漏，那么我希望异常处理程序做得更好（并且，由于遗漏有点，嗯，例外，它也是*正确*的解决方案）。如果你经常错过，我可能更喜欢不同的方法

当我们在做的时候，让我们不要忘记[`Dictionary.TryGetValue()`](http://msdn.microsoft.com/en-us/library/bb347013.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:44:25.350

我测试了`ContainsKey`vs`TryCatch`的性能，结果如下：

附加调试器：

![在此处输入图像描述](../Images/d53d9199d5300cee548e78c589cc135b.png)

没有附加调试器：

![在此处输入图像描述](../Images/14646e67df74737f387db5adb72f4dbf.png)

`Sub Main`仅使用以下代码在控制台应用程序的发布版本上进行了测试。`ContainsKey`使用调试器的速度大约是 37000 倍，而在没有附加调试器的情况下仍然快 355 倍，因此即使您进行两次查找，它也不会像您需要捕获额外的异常那样糟糕。这是假设您经常寻找丢失的密钥。

```
Dim dict As New Dictionary(Of String, Integer)
With dict
  .Add("One", 1)
  .Add("Two", 2)
  .Add("Three", 3)
  .Add("Four", 4)
  .Add("Five", 5)
  .Add("Six", 6)
  .Add("Seven", 7)
  .Add("Eight", 8)
  .Add("Nine", 9)
  .Add("Ten", 10)
End With

Dim stw As New Stopwatch
Dim iterationCount As Long = 0
Do
  stw.Start()
  If Not dict.ContainsKey("non-existing key") Then 'always true
    stw.Stop()
    iterationCount += 1
  End If
  If stw.ElapsedMilliseconds > 5000 Then Exit Do
Loop

Dim stw2 As New Stopwatch
Dim iterationCount2 As Long = 0
Do
  Try
    stw2.Start()
    Dim value As Integer = dict("non-existing key") 'always throws exception
  Catch ex As Exception
    stw2.Stop()
    iterationCount2 += 1
  End Try
  If stw2.ElapsedMilliseconds > 5000 Then Exit Do
Loop

MsgBox("ContainsKey: " & iterationCount / 5 & " per second, TryCatch: " & iterationCount2 / 5 & " per second.") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:22:25.183

如果您试图在某种不易搜索的数据结构中找到一个项目（例如，在 100K 个项目的未索引字符串数组中找到一个包含单词“flabbergasted”的项目，那么是的，让它抛出异常将是更快，因为您只进行一次查找。如果您首先检查该项目是否存在，然后获取该项目，您将进行两次查找。但是，在您的示例中，您正在查找一个项目在字典（哈希表）中，它应该非常快，因此进行两次查找可能比让它失败更快，但是如果不测试它就很难说。这完全取决于对象的哈希值有多快计算以及列表中有多少项共享相同的哈希值。

正如其他人所建议的那样，对于`Dictionary`，`TryGetValue`将提供两种方法中最好的方法。其他列表类型提供类似的功能。

# javascript - html5 画布向画布上绘制的图像添加拖放功能

> ID：13689146
> 
> 赞同：1
> 
> 时间：2012-12-03T18:09:22.573
> 
> 标签：javascript, drag-and-drop, html5-canvas

我有一个带有 HTML5 画布的网页，我用它来显示许多图像以及画布上的四个“描述框”。

目的是用户将能够将图像拖放到他们匹配的描述框中，但是，我在拖放工作时遇到了一些麻烦。

我尝试了几种不同的方法来启用图像拖放，但它们似乎都不起作用。

我遇到的问题是要在画布上显示的内容需要是动态的，即管理员将能够通过更改要在画布中使用的图像的文件名来更改在画布上显示的图像等XML 文件，对于他更愿意使用的任何图像。

所以基本上，我想向在画布上显示图像的 JavaScript 添加代码，以使它们能够在画布上拖放。

有没有人对最好的方法有什么建议？

我的 HTML 页面如下所示：

```
<!DOCTYPE html>
<html>
<head>
<script src = "kinetic.js" type = "text/javascript"></script>
<title>Home</title>

<script src = "drawLevelOneElements.js" type = "text/javascript"></script>
<script src = "layers&analytics.js" type = "text/javascript"></script>
<script src = "startGameDrawGameElementsDrawStartButton.js" type = "text/javascript"></script>
<script src = "interaction.js" type = "text/javascript"></script>
<script src = "dragAndDrop.js" type = "text/javascript"></script>
<script src = "dragAndDrop1.js" type = "text/javascript"></script>
<script src = "dragAndDrop2.js" type = "text/javascript"></script>
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.0.5.js"></script>

</head>

<body onLoad="startGame()">

<section hidden>
<img id="StartButton" src="StartButton.png" alt="Start Button" width="179" height="180" href="javascript:drawLevelOneElements();"/>
</section>

    <h1>Home</h1>
    <p>The purpose of this website is to teach users the basic principles of running a business by playing the game below. <br /><br /></p>

    <canvas id="gameCanvas" width="1000" height="500" style="border:1px solid">
    Your browser does not support the canvas element.
    </canvas>

    <br /><br />
    <p>Use this paragraph to enter text that provides the user with instructions for how to play the game. <br />
        Update the instructions so that they're appropriate to whatever level the user is currently playing.</p>

    <script src = "variables&preloadingImages.js" type = "text/javascript"></script>
</body> 
```

我已经尝试以三种不同的方式添加拖放功能 - 因此我包含了三个拖放 JS 文件，但这些似乎都不起作用。

我用来将图像绘制到画布上的 JavaScript 只是一些数组，每个元素都包含一个图像。我在画布上绘制的每个图像类别都有一个数组，每个类别中的图像数量是可变的。

然后，我使用 JS 的 concat 方法连接数组，将所有图像放在一个名为`allImagesArray`.

我有以下函数，它将 allImagesArray 中的每个图像绘制在画布上的随机位置：

```
function drawLevelOneElements(){
            /*First, clear the canvas */ 
            context.clearRect(0, 0, myGameCanvas.width, myGameCanvas.height);
            /*This line clears all of the elements that were previously drawn on the canvas. */
            /*Then redraw the game elements */
            drawGameElements(); 

            /*Create the four description areas, and place them near the bottom of the canvas */
            /*Create boxes with rounded corners for the description areas */
            CanvasRenderingContext2D.prototype.drawDescriptionArea = function(x, y, width, height, radius, stroke){
                if(typeof stroke == "undefined" ){
                    stroke = true;
                }
                if(typeof radius === "undefined"){
                    radius = 5;
                }
                this.beginPath();
                this.moveTo(x + radius, y);
                this.lineTo(x + width - radius, y);
                this.quadraticCurveTo(x + width, y, x + width, y + radius);
                this.lineTo(x + width, y + height - radius);
                this.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                this.lineTo(x + radius, y + height);
                this.quadraticCurveTo(x, y + height, x, y + height - radius);
                this.lineTo(x, y + radius);
                this.quadraticCurveTo(x, y, x + radius, y);
                this.closePath();
                if(stroke){
                    context.stroke();
                }
            }

            context.drawDescriptionArea(70, 400, 120, 70);
            context.font = '25pt Calibri';
            context.strokeText('Asset', 90, 440);

            context.drawDescriptionArea(300, 400, 120, 70);
            context.strokeText('Liability', 310, 440);

            context.drawDescriptionArea(540, 400, 120, 70);
            context.strokeText('Income', 550, 440);

            context.drawDescriptionArea(750, 400, 180, 70);
            context.strokeText('Expenditure', 760, 440);

            /*Now draw the images to the canvas */
            /*First, create variables for the x & y coordinates of the image that will be drawn.
                the x & y coordinates should hold random numbers, so that the images will be 
                drawn in random locations on the canvas.*/
                var imageX = Math.floor(Math.random()*100);
                var imageY = Math.floor(Math.random()*100);

                /*Create a 'table' of positions that the images will be drawn to */
                var imagePositionsX = [20, 80, 140, 200, 260, 320, 380, 440, 500, 560];
                var imagePositionsY = [20, 60, 100, 140, 180, 220, 260, 300, 340, 380];

            /*Draw all images from assetsImageArray */
            /*Use a while loop to loop through the array, get each item and draw it. */
            var arrayIteration = 0;
            console.log('All Images Array length: ' + allImagesArray.length); /*Display the length of the array in the console, to check it's holding the correct number of images. */
            while(arrayIteration < allImagesArray.length){
                var randomPositionX = Math.floor(Math.random()*10);
                var randomPositionY = Math.floor(Math.random()*10);
                context.drawImage(allImagesArray[arrayIteration], imageX, imageY, 50, 50);
                console.log(arrayIteration); /*Display the current array position that's being drawn */
                arrayIteration = arrayIteration+1;
                /*Now try changing the values of imageX & imageY so that the next image is drawn to a 
                    different location*/
                imageX = imagePositionsX[randomPositionX];  /* imageX+(Math.floor(Math.random()*100)); */
                imageY = imagePositionsY[randomPositionY];  /* imageY+(Math.floor(Math.random()*100));  */

            }

        } 
```

该函数还在画布上绘制了四个“描述区域”，分别标记为“资产”、“负债”、“收入”和“支出”。

用户需要做的是将每个图像拖到其相应的“描述区域”。当图像被拖到正确的描述区域时，它应该从画布上消失。

但是，尽管我将图像和描述区域绘制到画布上，但我似乎无法弄清楚如何向图像添加拖放功能。

我在网上查看了几个示例，但似乎无法让它们中的任何一个工作 - 我想知道是否是因为我正在使用 while 循环从数组中绘制图像？我还查看了该网站上提出的其他问题，但似乎无法在其中任何一个中找到答案。

我查看了[http://www.html5canvastutorials.com/kineticjs/html5-canvas-drag-and-drop-an-image-tutorial/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-drag-and-drop-an-image-tutorial/)和[http://www.html5canvastutorials.com/labs/html5上的教程-canvas-drag-and-drop-multiple-images-with-kineticjs/](http://www.html5canvastutorials.com/labs/html5-canvas-drag-and-drop-multiple-images-with-kineticjs/)但似乎无法使这些示例与我的代码一起使用。有没有人知道如何使用我的函数向画布上绘制的每个图像添加拖放`drawLevelOneElements()`功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:56:07.987

在这种情况下，cgSceneGraph 将很容易为您提供帮助。您可以查看示例页面（演示中包含源代码）： http: [//gwennaelbuchet.github.com/cgSceneGraph/examples.html](http://gwennaelbuchet.github.com/cgSceneGraph/examples.html)

我是这个框架的设计者，所以我可以很容易地帮助你将它包含到你的项目中:)

要使对象可拖动，就像这样：

```
this.img = new CGSGNodeImage(x, y, sourceURL);
this.img.isDraggable = true;
this.img.isCollisionManaged = true; 
```

然后，要知道您的图像是否在描述区域内，您可以像这样使用 cgSceneGraph 的碰撞检测：

```
//detect collision each frame
var bindCheckCollision = this.checkCollision.bind(this);
this.onRenderEnd = function () {
    bindCheckCollision();
}; 
```

和 checkCOllision 方法：

```
checkCollision: function () {
    var isColliding = this.img.isColliding(this.descriptionNode, 0);
} 
```

没有更多的事情要做:)

一个完整的例子在网站上。希望这可以帮到你。

格温。

# c# - 用 VB.NET 创建 5000 个目录

> ID：13689147
> 
> 赞同：1
> 
> 时间：2012-12-03T18:09:24.057
> 
> 标签：c#, vb.net, directory

我想创建 5000 个目录，目录的名称是计数器。

下面是我想使用的代码，但这只会为我创建 1 个目录，这是为什么呢？

```
 Dim Counter As Integer

 Counter = 1

 Do Until Counter = 5000

       FolderPath = "C:/pics/" + Counter.ToString() + "/"
       Directory.CreateDirectory(FolderPath)

 Loop

        Counter += 1 
```

VB.NET 或 C# 都可以，我只想运行一次。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:11:12.190

移动`counter+=1`到 do 循环内。它可能会创建第一个目录，但因为 counter 在循环内从不递增，它可能只是覆盖自身。

改成这样：

```
Do Until Counter = 5000

       FolderPath = "C:/pics/" + Counter.ToString() + "/"
       Directory.CreateDirectory(FolderPath)
        Counter += 1
 Loop 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T18:17:19.380

不要`do while`与整数一起使用，整数和双精度类型更好地使用函数`For`：

```
For Counter as Integer = 1 to 5000
   FolderPath = "C:/pics/" + Counter.ToString() + "/"
   Directory.CreateDirectory(FolderPath)
Next 
```

PS在您的情况下，您需要在声明`counter+=1`之前移动。`loop`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T18:17:33.217

你真的应该`For`为此使用一个循环：

```
For counter as Integer = 1 To 5000
    FolderPath = "C:/pics/" + counter.ToString() + "/"
    Directory.CreateDirectory(FolderPath)
End For 
```

# maps - 在谷歌地图中设置自定义缩放级别

> ID：13689151
> 
> 赞同：4
> 
> 时间：2012-12-03T18:09:36.860
> 
> 标签：maps, zooming

我正在使用谷歌地图 api，并希望在两个设置之间进行一半缩放。这可能吗？我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:22:29.580

尽管`Mapview`在内部使用连续缩放级别变化（您可以看到它，因为在缩放动画中，getProjection() 与中间缩放级别对齐），API 仅可用于选择整数缩放级别。

问候。

# delphi - 如何列出 FTP 服务器中的所有文件？

> ID：13689155
> 
> 赞同：0
> 
> 时间：2012-12-03T18:09:48.753
> 
> 标签：delphi, ftp, delphi-2010, indy, indy10

我想列出 FTP 服务器中的所有文件以进行索引（主目录和子目录）。

如何获取服务器中可访问文件的完整列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:44:15.107

Indy 有一个`TIdFTP`组件，它有一个`List()`方法和一个`DirectoryListing`属性。调用`List()`然后`DirectoryListing`根据需要循环遍历结果。中的每个项目`DirectoryListing`都会告诉您它是文件还是子文件夹。如果您需要索引整个系统，则必须`List()`为每个子文件夹调用递归循环。

需要牢记的一点 - 当今 Internet 上的 FTP 服务器仍在使用数百种特定于平台的目录列表格式。`LIST`原始 FTP 规范[RFC 959](https://www.rfc-editor.org/rfc/rfc959)中概述的命令没有定义用于列表的任何格式，因此系统可以自由使用它们想要使用的任何东西，并且多年来他们确实这样做了。Windows 和 Unix 格式很常见，但不是必需的。[直到RFC 3659](https://www.rfc-editor.org/rfc/rfc3659)在 FTP 的扩展中才定义正式的列表格式`MLSD`，它替换了旧`LIST`命令（如果服务器支持它，`TIdFTP.List()`则使用它）。`MLSD`

我提到这一点是因为`TIdFTP`Indy 10 使用插件系统来支持许多不同的列表格式。`IdFTPListParse...`在 Indy中，每种格式都在一个单独的单元中实现。默认情况下，只有`NLST`和`MLSD`格式始终处于启用状态。对于您想要支持的任何其他列表格式，您需要在子句中包含适当的`IdFTPListParse...`单位以便识别它。例如，和。或者，有一个单元可以启用所有可用的解析器。当您调用 时，该属性将设置为用于解析原始列表数据的解析器的名称。`uses``TIdFTP``IdFTPListParseUnix``IdFTPListParseWindows``IdAllFTPListParsers``TIdFTP.List()``TIdFTP.DirFormat`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:17:02.703

FTP 协议记录在[RFC 959](https://www.ietf.org/rfc/rfc959.txt)中。列出文件的命令被调用`LIST`，如第 4.1.3 节所述。

# javascript - 更改事件时图像交换的 jQuery/javascript“旋转”效果

> ID：13689158
> 
> 赞同：2
> 
> 时间：2012-12-03T18:10:01.490
> 
> 标签：javascript, jquery, html, image, jquery-effects

我正在寻找类似于 WOW Slider 中的旋转效果的图像过渡：[http ://wowslider.com/javascript-slideshow-quiet-rotate-demo.html](http://wowslider.com/javascript-slideshow-quiet-rotate-demo.html)

主要区别是我希望转换发生在下拉列表的更改事件中。这是功能代码：

[http://jsfiddle.net/zCknb/14/](http://jsfiddle.net/zCknb/14/)

js很简单：

```
$("#assignee").change(function () {
   $("#pic").attr("src", $("#assignee").val());
}) 
```

如果我更改受让人，我希望新照片像 WOW 滑块中的旋转效果一样旋转。

如果可以的话，我不想解构整个滑块库。有人知道获得这种效果的更简单方法吗？

**编辑：**到目前为止，我感谢大家的投入，但我正在寻找一种相当于 WOW Slider 中的旋转的效果。简单的幻灯片不会削减它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:57:43.023

这是一个例子。见：http: [//jsfiddle.net/zCknb/12/](http://jsfiddle.net/zCknb/12/)

效果：

```
/*
* effects
* animate-left_goright           
* animate-right_goleft           
* animate-top_gobottom
* animate-bottom_gotop
*/ 
```

选项 attr **animate="animate-left_goright"**

*   在动画左++之后创建左；

选项 attr **animate="animate-right_goleft"**

*   在左动画++之后创建；

选项 attr **animate="animate-top_gobottom"**

*   在底部动画++之后创建-top；

选项 attr **animate="animate-bottom_gotop"**

*   在顶部动画 ++ 之后创建 -bottom；

> 查看并理解此示例。

采取很容易；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:20:12.157

硬币滑块 jquery 插件具有漩涡效果。检查它是否有帮助[http://www.htmldrive.net/items/show/245/Coin-Slider-Image-Slider-with-Unique-EffectsjQuery](http://www.htmldrive.net/items/show/245/Coin-Slider-Image-Slider-with-Unique-EffectsjQuery)并且您可以在 jquery 的更改事件处理程序上使用

# python - 为什么我在这里得到 UnicodeDecodeError？

> ID：13689166
> 
> 赞同：1
> 
> 时间：2012-12-03T18:10:50.157
> 
> 标签：python, python-3.x

我正在尝试制作一个 python 脚本来查找 USB 闪存驱动器中的重复文件。

我正在关注的过程是创建一个文件名列表，对每个文件进行哈希处理，然后创建一个逆字典。但是在过程中的某个地方我得到了一个`UnicodeDecodeError`. 有人可以帮我理解发生了什么吗？

```
from os import listdir
from os.path import isfile, join
from collections import defaultdict
import hashlib

my_path = r"F:/"

files_in_dir = [ file for file in listdir(my_path) if isfile(join(my_path, file)) ]
file_hashes = dict()

for file in files_in_dir:
    file_hashes[file] = hashlib.md5(open(join(my_path, file), 'r').read()).digest()

inverse_dict = defaultdict(list)

for file, file_hash in file_hashes.iteritems():
    inverse_dict[file_hash].append(file)

inverse_dict.items() 
```

我面临的错误是：

```
Traceback (most recent call last):
  File "C:\Users\Fotis\Desktop\check_dup.py", line 12, in <module>
    file_hashes[file] = hashlib.md5(open(join(my_path, file), 'r').read()).digest()
  File "C:\Python33\lib\encodings\cp1253.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
UnicodeDecodeError: 'charmap' codec can't decode byte 0xff in position 2227: character maps to <undefined> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:16:03.937

您正在尝试读取未以默认平台编码 ( `cp1253`) 编码的文件。通过以文本模式 ( `r`) 打开文件，Python 3 将尝试将文件内容解码为 un​​icode。您没有指定编码，因此使用平台首选编码。

改为以二进制模式打开文件，使用`rb`as 模式。由于您只计算 MD5 哈希（一个需要字节的函数），因此无论如何您都不应该使用文本模式。

# perl - 如何获得最低匹配的 captureno？

> ID：13689167
> 
> 赞同：3
> 
> 时间：2012-12-03T18:10:50.147
> 
> 标签：perl

如何在正则表达式中获得最低匹配组号？

假设有一个正则表达式

```
/(a(b))|(b(1))|(c(4))/... 
```

例如输入字符串是 "b1" ，最低匹配组没有 2\. ($2)

例如输入字符串是 "c4" ，最低匹配组没有 5\. ($5)

例如输入字符串是 "ab" ，最低匹配组没有 1\. ($1)

我有一个解决方案，但效率不高。谢谢大家的尝试。真正的问题是效率。许多人提供了我发现的类似解决方案。问题是线性时间搜索最低组。O(N) 其中 n 是捕获组的数量。我想知道是否有更快的方法。O(1) 这就是这个问题的目的。我希望 Perl 有一个隐藏的特性来获得这个值。我想没有。

同时我自己找到了**解决方案**，**在这里..**

/(a(b)(??{ $first=1;"" }))|(b(1)(??{ $first=2;"" }))|(c(4)(??{ $first=5;"" }))/

找出 $first 的时间是 O(1)。

```
if (@matches = $conv::content =~/$conv::trtree{convertsourceregqr}[$conversionno]/)
      {

        my $firstno;
        my $c = 0;
        for my $m (@matches)
        {
          if (defined $m)
          {
            $firstno=$c;
            last;
          }
          $c++;
        }**strong text****strong text** 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:40:08.253

*这与您的问题并不完全匹配，但它可能会解决您的实际问题（或者未来读者的问题）。*

**编辑（12 年 12 月 10 日）：**

另一种选择是，[特殊构造`(?|)`](http://perldoc.perl.org/perlretut.html#Alternative-capture-group-numbering)将交替重新组织编号，以使数字保持一致。这无助于识别匹配的组，但会确保匹配项位于`$1`and中`$2`。如果您需要知道哪些匹配，命名的捕获（如下）是要走的路。

```
#!/usr/bin/env perl

use strict;
use warnings;

foreach my $v ('ab', 'b1', 'c4') {
  print "Input: $v\n";
  next unless $v =~ /(?|(a(b))|(b(1))|(c(4)))/;
  print "$1 => $2\n";
} 
```

**原创** 也许您想使用[命名捕获](http://perldoc.perl.org/perlretut.html#Named-backreferences)来减轻理解匹配内容的负担。命名的捕获结果被放置在`%+`散列中，因此更容易自省。

```
#!/usr/bin/env perl

use strict;
use warnings;

foreach my $v ('ab', 'b1', 'c4') {
  print "Input: $v\n";
  next unless $v =~ /(?<a>a(?<ab>b))|(?<b>b(?<b1>1))|(?<c>c(?<c4>4))/;
  foreach my $key (sort keys %+) {
    next unless defined $+{$key};
    print "\t$key => $+{$key}\n";
  }
} 
```

印刷

```
Input: ab
    a => ab
    ab => b
Input: b1
    b => b1
    b1 => 1
Input: c4
    c => c4
    c4 => 4 
```

**编辑**

事实上，对于这样的交替，也许您只想使用重复的名称！

```
#!/usr/bin/env perl

use strict;
use warnings;

foreach my $v ('ab', 'b1', 'c4') {
  print "Input: $v\n";
  next unless $v =~ /(?<outer>a(?<inner>b))|(?<outer>b(?<inner>1))|(?<outer>c(?<inner>4))/;
  print "\touter => $+{outer}\n";
  print "\tinner => $+{inner}\n";
} 
```

印刷

```
Input: ab
    outer => ab
    inner => b
Input: b1
    outer => b1
    inner => 1
Input: c4
    outer => c4
    inner => 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:29:53.477

将匹配项存储在数组中，并找到第一个定义值的索引：

```
my $str = 'c4';
my @matches = ( $str =~ m/(a(b))|(b(1))|(c(4))/ );
for my $i ( 0..$#matches ) {
    if ( defined $matches[$i] ) {
        printf "First matching group: %d\n", $i+1;
        last;
    }
}
# output: 5 
```

请注意，这将永远不会输出 2、4 或 6，因为组 1、3 或 5 必须匹配才能匹配其中一个。

如果您只想要第一个匹配组的内容：

```
use List::Util 'first';
my $str = 'c4';
print first { defined } $str =~ m/(a(b))|(b(1))|(c(4))/; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:31:19.210

特殊变量[`@-`and`@+`](http://search.cpan.org/perldoc?perlvar#LAST_MATCH_END)保存成功匹配的开始和结束位置。对您的问题的实际应用是，如果`$<n>`具有某些值（对于`$<n>`in `$1`、`$2`等），则将`$+[<n>]`大于`$-[<n>]`。

```
for ('b1', 'c4', 'ab') {

    /(a(b))|(b(1))|(c(4))/;
    my @i = grep { $+[$_] > $-[$_] } 1..$#+;

    # @i contains list of successful matches,
    # i.e., if @i == (3,4), then $3 and $4 contain values
    if (@i > 0) {
        print "Earliest match for '$_' is: \$$i[0]\n";
    } else {
        print "No match for '$_'\n";
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T19:15:29.277

首先，以这种方式使用括号是令人困惑的。这个特定问题的最简单的解决方案是只使用一个：

```
/(ab|b1|c4)/ 
```

由于其他括号在这种特殊情况下不起作用，因此这将起作用。

但是，有时可能需要分组，在这种情况下，您可以使用非捕获括号并只使用一个来捕获，`(?: ... )`. 在您的情况下，它看起来像这样：

```
/((?:a(?:b))|(?:b(?:1))|(?:c(?:4)))/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T18:20:10.457

正则表达式中的组编号是括号的数量。

```
 1 2    3 4    5 6
/(a(b))|(b(1))|(c(4))/ 
```

一个快速脚本来演示这一点：

```
#!/usr/bin/perl

foreach my $v ('ab', 'b1', 'c4') {
    $v =~ /(a(b))|(b(1))|(c(4))/;
    if(defined $1) { print "One!\n"; }
    if(defined $3) { print "Three!\n"; }
    if(defined $5) { print "Five!\n"; }
    print << "--EOB--";
$v
1 $1
2 $2
3 $3
4 $4
5 $5
6 $6

--EOB--
} 
```

产生输出：

```
One!
ab
1 ab
2 b
3 
4 
5 
6 

Three!
b1
1 
2 
3 b1
4 1
5 
6 

Five!
c4
1 
2 
3 
4 
5 c4
6 4 
```

此时，应该能够轻松地修改代码以针对匹配的任何组执行任何操作。

# ms-access - MS Access 错误：两个选定表中的列数不匹配

> ID：13689169
> 
> 赞同：5
> 
> 时间：2012-12-03T18:10:55.103
> 
> 标签：ms-access, ms-access-2007, union

我在 MS Access 查询中收到此错误：`The number of columns in the two selected tables or queries of a union query do not match.`

列数明显匹配，当我运行 UNION 查询一次选择任意 2 组时，它工作正常。当我在查询中包含超过 2 个选择时，它会显示此错误。

```
SELECT  "Applied" as Application_Status, Count(*) AS [CountOfApplication Status]
FROM [EDB Applicants - ALL]
WHERE [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]>Date()-366

UNION

SELECT  "Hold" as Application_Status, Count(*) AS [CountOfApplication Status]
FROM [EDB Applicants - ALL]
WHERE [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]<=Date()-366 And [EDB Applicants - ALL].[Application Status]="Hold"

UNION

SELECT  "Withdraw" as Application_Status, Count(*) AS [CountOfApplication Status]
FROM [EDB Applicants - ALL]
WHERE [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Date of Enrollment Change]<=Date()-366 And [EDB Applicants - ALL].[Application Status] In ("Declined","Withdrew Application","Withdrew After Enrollment") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:11:24.937

我不知道你原来的问题的原因，但你可以重写你的查询来消除工会：

```
select Application_Status, COUNT(*)
from (select (case when  [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]>Date()-366
                   then 'Applied'
                   when [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]<=Date()-366 And [EDB Applicants - ALL].[Application Status]="Hold"
                   then 'Hold'
                   when [EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Date of Enrollment Change]<=Date()-366 And [EDB Applicants - ALL].[Application Status] In ("Declined","Withdrew Application","Withdrew After Enrollment")
                   then 'Withdraw'
              end) as Application_Status, [EDB Applicants - ALL].*
      from [EDB Applicants - ALL]
     ) t
where Application_Status is not null
group by Application_Status 
```

没错，在 MS Access 中你必须使用 IIF()，但同样的想法也适用：

```
select Application_Status, COUNT(*)
from (select iif([EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]>Date()-366,
                  'Applied',
                  iif([EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Dec Date]<=Date()-366 And [EDB Applicants - ALL].[Application Status]="Hold",
                       'Hold',
                       iif([EDB Applicants - ALL].[Application Year].Value Like "2012" And [EDB Applicants - ALL].[Application Date]<=Date()-366 And [EDB Applicants - ALL].[Date of Enrollment Change]<=Date()-366 And [EDB Applicants - ALL].[Application Status] In ("Declined","Withdrew Application","Withdrew After Enrollment")
                        'Withdraw', '')))) as Application_Status, [EDB Applicants - ALL].*
      from [EDB Applicants - ALL]
     ) t
where Application_Status <> ''
group by Application_Status 
```

# arrays - 更好的排列生成算法

> ID：13689172
> 
> 赞同：3
> 
> 时间：2012-12-03T18:10:58.970
> 
> 标签：arrays, emacs, lisp, elisp

这里有一些我可以想出的，但我对其中任何一个都不满意：

```
(defsubst i-swap (array a b)
  (let ((c (aref array a)))
    (aset array a (aref array b))
    (aset array b c) array))

(defun i-permute-recursive (array offset length)
  (if (= offset length)
      (message "array: %s" array)
    (let ((i offset))
      (while (< i length)
        (i-permute-recursive (i-swap array i offset) (1+ offset) length)
        (i-swap array i offset)
        (incf i)))))

(defun i-permute-johnson-trotter (array)
  (let ((i 0) largest largest-pos largest-sign swap-to
        (markers (make-vector (length array) nil)))
    (while (< i (length array))
      (aset markers i (cons '1- i))
      (incf i))
    (setcar (aref markers 0) nil)
    (while (some #'car markers)
      (setq i 0 largest nil)
      (while (< i (length array))
        (destructuring-bind (tested-sign . tested-value)
            (aref markers i)
          (when (and tested-sign
                     (or (not largest)
                         (< largest tested-value)))
            (setq largest tested-value largest-pos i
                  largest-sign tested-sign)))
        (incf i))
      (when largest
        (setq swap-to (funcall largest-sign largest-pos))
        (i-swap array largest-pos swap-to)
        (i-swap markers largest-pos swap-to)
        (when (or (= swap-to 0) (= swap-to (1- (length array)))
                  (> (cdr (aref markers
                                (funcall largest-sign swap-to)))
                     largest))
          (setcar (aref markers swap-to) nil))
        (setq i 0)
        (while (< i (length array))
          (setq swap-to (cdr (aref markers i)))
          (when (> swap-to largest)
            (setcar (aref markers i)
                    (if (< i largest-pos) '1+ '1-)))
          (incf i))
        (message "array: %s <- makrers: %s" array markers))))) 
```

递归变体都进行了额外的交换，而且它是递归的，这让我很不高兴（我不关心堆栈的大小，因为我关心的是调试的容易程度——递归函数在调试器中看起来很糟糕......）

我从 Wiki 上的描述中实现的另一个版本，如果您有兴趣，可以在这里：[http](http://en.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm) ://en.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm但它都太长了（只是代码本身很长），它或多或少是 O(n*m)，对于短数组来说几乎是二次的。（m 是数组的长度，n 是排列的数量。）

通过查看递归版本，我希望必须有一个 *plain* O(n) 变体，但我无法理解它......

如果你觉得用另一个 Lisp 写起来更舒服，欢迎你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:01:17.380

这就是我现在所拥有的，感谢这个博客：[http ://www.quickperm.org/](http://www.quickperm.org/)

```
(defun i-permute-quickperm (array)
  (let* ((len (length array))
         (markers (make-vector len 0))
         (i 1) j)
    (while (< i len)
      (if (< (aref markers i) i)
          (progn
            (setq j (if (oddp i) (aref markers i) 0))
            (i-swap array j i)
            (message "array: %s" array)
            (aset markers i (1+ (aref markers i)))
            (setq i 1))
        (aset markers i 0)
        (incf i))))) 
```

但请随时提出更好的建议。（虽然这对我来说看起来很漂亮，所以 idk ：P）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T03:17:46.367

```
(defun map-permutations (fn vector)
  "Call function FN on each permutation of A, with each successive
permutation one swap away from previous one."
  (labels ((frob (n)
             (if (zerop n) (funcall fn vector)
               (dotimes (i n (frob (1- n)))
                 (frob (1- n))
                 (rotatef (aref vector n)
                          (aref vector (if (oddp n) i 0)))))))
    (frob (1- (length vector))))) 
```

示例（如果使用 Emacs-Lisp，将 #'print 替换为 #'message 并`C-h``e`查看结果）：

```
CL-USER> (map-permutations #'print "123")
"123" 
"213" 
"312" 
"132" 
"231" 
"321" 
```

# c# - How to get index of object in observablecollection passed as parameter

> ID：13689178
> 
> 赞同：0
> 
> 时间：2012-12-03T18:11:12.543
> 
> 标签：c#, object, collections, parameters, indexing

so here it is:

```
Bowls = new ObservableCollection<Bowl>();

SowCommand = new DelegateCommand(param => SowGame(param));

private void SowGame(Object param)
{
Int32 index = Convert.ToInt32(param);

Bowls[index] = ...
} 
```

So i pass "param" to SowGame by pressing a button Command="{Binding SowCommand}"

param is now an object of Bowl type

in SowGame i want to do something with this Bowl object and i know a certain object from a collection can be reached by using Bowls[index of object]. But converting the object to int as above doesn't seem to work.

How can i get the index of the passed object?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:30:49.610

Use IndexOf method of your ObservableCollection:

```
int index = Bowls.IndexOf((Bowl)param); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T17:50:21.740

I figured it out! Here's what caused the problem:

```
SowCommand = new DelegateCommand(param => SowGame(param)); 
```

To be able to get the index of the pressed button (which is bound to the above command) you need two things:

First you need to implement a function which somehow computes the index of an element in a collection. For example in my case:

```
public Int32 Number { get {

            if (Y == 0)
            {
                return _Size - 1 - X;
            }
            else
            {
                return _Size + X;
            }

        } } 
```

Of course the method of getting the index depends on the problem. The above code is a part of the implementation of my Bowl type.

After this you have to add

```
Command Parameter="{Binding Number}" 
```

to your *.xaml* and the code in the question should work properly.

# python - 我应该如何在 Python 中使用文件阅读器类？

> ID：13689183
> 
> 赞同：1
> 
> 时间：2012-12-03T18:11:39.300
> 
> 标签：python

我想弄清楚我应该如何使用一个类从文件中读取输入，以便我可以在其他类中使用该数据。如果我将文件中的输入读入列表，我是否应该将其传递给另一个需要使用该信息的类？

现在我有：

```
import sys

class FileReader:
    """Reads a file"""
    def __init__(self):
        input = ''
        try:
            with open(sys.argv[1], 'r') as inFile:
                input = inFile.readline()
                print(input)
        except IndexError:
            print("Error - Please specify an input file.")
            sys.exit(2)

def main():
    x = FileReader()

if __name__ == "__main__":
    main() 
```

我考虑过制作某种列表来保存文件中的字符串，但我不确定这是否应该是全局的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:38:02.137

如果您要做的只是逐行读取文件，则类似以下的内容就可以正常工作（省略异常处理）。

```
>>> path = '/path/to/file.txt'
>>> with open(path, 'r') as f:
...     lines = [l for l in f] 
```

然后，您可以根据需要四处走动`lines`。

# python - 如何让实际的表格调整其大小以适应 QTableWidget 容器？

> ID：13689184
> 
> 赞同：3
> 
> 时间：2012-12-03T18:11:39.403
> 
> 标签：python, qt, pyqt4, qt-designer

我什至不知道如何问这个问题。我有下表：

![在此处输入图像描述](../Images/6cb790cc928e61bae18a012ef0bebae0.png)

可以看到 QTableWidget 是如何被选中的，但是实际的表格要小一些。如何使表格与 QTableWidget 容器的大小相同？

我正在使用 QT-Designer。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:27:35.020

来自 Qt Designer 有

```
horizontalHeaderStretchLastSection 
```

和

```
verticalHeaderStretchLastSection 
```

QTableWidget 上的属性。

# statistics - SQL Server 索引使用统计信息多久更新一次？是什么触发了它？

> ID：13689186
> 
> 赞同：3
> 
> 时间：2012-12-03T18:11:47.670
> 
> 标签：statistics, sql-server-2012, indexing

还有一些其他类似的问题，但请不要混淆。

我知道有一个功能`STATS_DATE()`可以知道统计数据在哪里更新，这很好，但我想知道是什么触发了此统计数据的更新或截止。我知道也有这方面的报告。

但是上周我在某些服务器上看到了统计数据，他们给了我非常好的信息，这个特定数据库中的主表的数量为 4 位数。

现在查看相同的生产服务器，`STATS_UPDATE`返回的函数是上周六更新的，但是该服务器已经运行了数周而没有重新启动，甚至没有重新启动服务。所以我知道我正在查看基本上只是在这个星期一早上积累的统计数据。

所以，我想知道在哪里可以设置此设置，以便服务器不断累积索引使用统计信息，直到我清除日志或它使用的任何存储。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T03:47:30.900

SQL 服务器为表和索引维护了各种“统计信息”。

1.  直方图统计。这些是查询优化器使用的统计信息。STATS_DATE() 返回这些更新的最后日期/时间。直方图统计信息自动更新的标准是 500 行 + 20% 的表。因此，对于一个有 100,000 行的表，您必须更新 20,500 行，然后才能触发对这些行的重新计算。您无法更改自动统计更新的阈值，但是，您可以关闭自动统计更新和/或手动更新特定表和索引的统计信息。

2.  使用统计：这些位于 sys.dm_db_index_usage_stats。索引使用统计信息跟踪诸如来自 SELECT 查询的搜索和扫描之类的事情。它们不会持久化并在 sql server 重新启动时重置。如果基础索引被重建“ALTER INDEX ... REBUILD”，这些统计数据也会被重置，但不是“ALTER INDEX ... REORG”

3.  操作统计：这些位于 sys.dm_db_index_operational_stats。操作统计是诸如页面拆分、叶级插入和 PAGEIOLATCH 延迟之类的东西。这些也不是持久的。

# c++ - 类错误导致数百个错误

> ID：13689187
> 
> 赞同：0
> 
> 时间：2012-12-03T18:11:51.713
> 
> 标签：c++, class, sfml

我班级的标题是

```
#ifndef _CENGINE_H
#define _CENGINE_H
#include "SFML\Graphics.hpp"
#include "CTextureManager.h"
#include "CTile.h"

class CEngine
{
private:
    //Create instance of CTextureManager
    CTextureManager textureManager;
    //Load textures
    void LoadTextures();
    //New tile
    CTile* testTile;

    bool Running; //Is running?
    sf::RenderWindow* window; //Create render window
public:
    CEngine(); //Constructor
    int Execute(); //Execute
    bool OnInit(); //On intialization
    void GameLoop(); //Main game loop
    void Render(); //Render function
    void Update(); //Update
};
#endif 
```

现在它给我的3个错误是：

> cengine.h(8)：错误 C2236：意外的“类”“CEngine”。你忘了一个';'吗？
> 
> cengine.h(8)：错误 C2143：语法错误：缺少 ';' 前 '{'
> 
> cengine.h(8)：错误 C2447：'{'：缺少函数头（旧式正式列表？）

我知道错误很明显，但我看不出课程有问题。我可能真的很愚蠢，因为我累了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:14:26.577

这似乎是一个循环包含问题。做`CTextureManager.h`或`CTile.h`包括彼此或`CEngine.h`？

要解决此问题，请尽可能使用前向声明。例如，您的课程不需要包含`CTile.h`- 它可以如下所示：

```
#ifndef CENGINE_H
#define CENGINE_H
#include "SFML\Graphics.hpp"
#include "CTextureManager.h"

class CTile;    //forward declaration instead of include

class CEngine
{
private:
    //Create instance of CTextureManager
    CTextureManager textureManager;
    //Load textures
    void LoadTextures();
    //New tile
    CTile* testTile;

    bool Running; //Is running?
    sf::RenderWindow* window; //Create render window
public:
    CEngine(); //Constructor
    int Execute(); //Execute
    bool OnInit(); //On intialization
    void GameLoop(); //Main game loop
    void Render(); //Render function
    void Update(); //Update
};
#endif 
```

其他 2 个标题类似。

此外，`_CENGINE_H`这不是一个有效的标识符 - 请注意我如何将其重命名为`CENGINE_H`.

# ruby-on-rails - Devise Registration form on any page

> ID：13689188
> 
> 赞同：6
> 
> 时间：2012-12-03T18:11:55.663
> 
> 标签：ruby-on-rails, view, devise, controller

I'm trying to allow users to sign up for the site on my home/landing page. I've duplicated the devise registration form into my landing page view-

```
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= devise_error_messages! %>

  <div><%= f.label :first_name %><br />
  <%= f.text_field :first_name %></div>

  <div><%= f.label :last_name %><br />
  <%= f.text_field :last_name %></div>

  <div><%= f.label :profile_name %><br />
  <%= f.text_field :profile_name %></div>

  <div><%= f.label :email %><br />
  <%= f.email_field :email %></div>

  <div><%= f.label :password %><br />
  <%= f.password_field :password %></div>

  <div><%= f.label :password_confirmation %><br />
  <%= f.password_field :password_confirmation %></div>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

And I've also [added the helper methods](https://github.com/plataformatec/devise/wiki/How-To%3a-Display-a-custom-sign_in-form-anywhere-in-your-app) in my `application_controller.rb` so that I properly define the resource-

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  def resource_name
    :user
  end

  def resource
    @resource ||= User.new
  end

  def devise_mapping
    @devise_mapping ||= Devise.mappings[:user]
  end
end 
```

However I'm still getting the error `undefined local variable or method` `resource'`for #<#:0x007fa816b4b750>`

What am I missing here to properly render a REGISTRATION form on my home landing page?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-03T18:15:59.650

You need to declare those controller methods as helper methods to access them from the views:

```
helper_method :resource, :resource_name, :devise_mapping 
```

Just add that line inside your `ApplicationController` after the methods are defined.

You'll notice that the link you provided actually mentions to put this code in the application *helper*, not the controller... You can avoid this `helper_method` declaration if you do it that way.

# php - 致命错误：找不到类“Modelmyaccount”

> ID：13689190
> 
> 赞同：1
> 
> 时间：2012-12-03T18:11:57.287
> 
> 标签：php, codeigniter, netbeans, e-commerce, xampp

我正在使用 PHP 创建一个电子商务网站，并通过 XAMPP 加载。但是我遇到了以下错误：致命错误：找不到类'Modelmyaccount'

我尝试使用启用了 XDebug 的 NetBeans 进行调试，遇到了以下调用堆栈。

```
Call Stack

 1\. {main}( ) ..\index.php:0
 2\. require_once( 'E:\xampp\htdocs\promotion\system\codeigniter\CodeIgniter.php' ) ..\index.php:117
 3\. myshop->__construct( ) ..\CodeIgniter.php:201
 4\. CI_Loader->model( ???, ???, ??? ) ..\myshop.php:7 
```

我已经验证了该类确实存在，但是它似乎无法识别它。

下面以粗体突出显示的是它无法找到要存储到 $name 中的类名的部分

```
if ( ! class_exists('Model'))
    {
        load_class('Model', FALSE);
    }

    **require_once(APPPATH.'models/'.$path.$model.EXT);**

    $model = ucfirst($model);

    $CI->$name = new $model();
    $CI->$name->_assign_libraries();

    $this->_ci_models[] = $name;    
} 
```

另请参阅下面的“modelmyaccount”和“Model”类以供参考：

```
<?
class modelmyaccount extends Model{

    protected   $table_name = 'consumer_master';

    function __construct()
    {
        parent::Model();

        $this->table_country_master     = 'country_master';
        //$this->table_country_detail   = 'country_detail';
        $this->table_state_master       = 'state_master';
        //$this->table_state_detail         = 'state_detail';
    }

    function checkEmail()
    {

      $fetch_user = "SELECT count(*) AS CNT FROM ".$this->table_name." 
                     WHERE email     = '".addslashes($_POST['email'])."'
                    ";
      $fetch_result=$this->db->query($fetch_user);      

      if($fetch_result->num_rows() > 0) {
           $row=$fetch_result->row_array();
           if($row['CNT'] == 0) {
              return true;
           }else {
              return false;
          }
      }
   }

   function updateMember($member_id)
   {

    $dt = explode("-",addslashes($_POST['birth_date']));
    $birth_date = $dt[2]."-".$dt[0]."-".$dt[1];

    $saveSql = "UPDATE ".$this->table_name." 
                SET first_name      =   '".addslashes($_POST['first_name'])."',
                    last_name       =   '".addslashes($_POST['last_name'])."',
                    streetname          =   '".addslashes($_POST['address1'])."',   
                    dob     =   '".$birth_date."',
                    interest            =   '".addslashes($_POST['interest'])."',
                    country         =   '".addslashes($_POST['country'])."',
                    state           =   '".addslashes($_POST['state'])."',
                    city            =   '".addslashes($_POST['city'])."',
                    postal              =   '".addslashes($_POST['zip'])."',

                    edit_date   =   NOW()
                WHERE consumer_id = '".$member_id."'
                ";              
     //echo $saveSql;
     //exit;
      $saveResult = $this->db->query($saveSql);

      return true;  

   }

   /*function delMyFav($member_id, $topic_type)
   {
        $sql_del = "DELETE FROM favourite_master 
                    WHERE   member_id='".$member_id."' 
                    AND     topic_type='".$topic_type."'";
        $result = $this->db->query($sql_del);
   }*/

   function checkConfirmation($emailId)
   {
     $sql = "SELECT status FROM ".$this->table_name." 
             WHERE   email ='".base64_decode($emailId)."'";
     $res = $this->db->query($sql);
     if($res->num_rows() > 0) {
       $row = $res->row_array();
       if($row['status']=='A') 
            return false;
       else 
            return true;
     }
   }

   function confirmMember($emailId)
   {
     $confirmSql = "UPDATE ".$this->table_name. "
                    SET status = 'A' 
                    WHERE email ='".base64_decode($emailId)."'";

     $confirmResult = $this->db->query($confirmSql);

     if($confirmResult) {
       return true;
     }   
   }

   function getCountry()
   {
        $sql = " SELECT  CM.*
                 FROM  " .$this->table_country_master. " AS CM               
                 WHERE CM.is_active ='Y'";
        $recordSet = $this->db->query($sql);

        if($recordSet) {
            if($recordSet->num_rows() > 0) {
                foreach($recordSet->result_array() as $key =>$val) {
                    $rs[]=$val;
                }
            }
        } else {
            return false;
        }
        return $rs ;
   }

   function getMemberById($member_id)
   {

       $sql = "SELECT * FROM ".$this->table_name." WHERE consumer_id = '".$member_id."'";
       $recordset = $this->db->query($sql);

       if($recordset->num_rows() > 0){
           foreach($recordset->result_array() as $key=>$val){
               $rs[] = $val;
           }
       }else{
            return false;   
       }

       return $rs;
   }

   function validateOldPassword($id)
    {   

        $this->old_pwd   = $this->input->request('old_pwd','');

        $sql = " SELECT count(*) AS CNT 
                 FROM   ".$this->table_name." 
                 WHERE  consumer_id ='".$id."' 
                 AND    password ='".$this->old_pwd."'
               ";       
        $rs  = $this->db->query($sql);

        if($rs) {
            if($rs->num_rows() > 0) { 
                $row = $rs->row_array();
                if($row['CNT'] > 0) {
                  return true;
                } else {
                 return false;
                }
            } else {
                return false;
            }
        } else {            
            return false;
        }
    }

    /*
    function valideNewPassword
    This function to check the New Password and Confirm New Password will be same or not
    if both are the same then return true else return false
    */
    function validateNewPassword() 
    {
        $this->new_pwd        = $this->input->request('new_pwd','');
        $this->conf_new_pwd     = $this->input->request('con_pwd','');

        if($this->new_pwd!='' && $this->conf_new_pwd!='') {
            if($this->new_pwd===$this->conf_new_pwd) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }

    }

    function updatePassword($id)
    {
        $this->new_pwd   = $this->input->request('new_pwd','');

        $sql = " UPDATE ".$this->table_name." 
                 SET    password = '".$this->new_pwd."' 
                 WHERE  consumer_id ='".$id."'
               ";

        $rs  = $this->db->query($sql);

        if($rs) {
            return true;
        } else {            
            return false;
        }
    }

    function newsletterSubscription($subscriberEmail)
    {
        $sql = "SELECT subscriber_email 
                FROM newsletter_subscriber
                WHERE subscriber_email = '".$subscriberEmail."'
                AND is_active = 'Y' 
                ";
        //echo $sql;
        $rs = $this->db->query($sql);
        if($rs){
            if($rs->num_rows() > 0){
                return true;
            }else{
                return false;
            }       
        }
    }

    function subscribeNewsletter($subscriberEmail)
    {
        $sql = "
                INSERT INTO newsletter_subscriber
                SET 
                    subscriber_email = '".$subscriberEmail."',
                    is_active = 'Y',
                    db_add_date = NOW(),
                    db_edit_date = NOW()            
               ";
        //echo $sql;       
        $rs = $this->db->query($sql);
        if($rs){
            return true;
        }else{
            return false;
        }
    }   
    function unSubscribeNewsletter($subscriberEmail)
    {   
        $sql = "
                DELETE FROM newsletter_subscriber
                WHERE 
                    subscriber_email = '".$subscriberEmail."'               
               ";
        $rs = $this->db->query($sql);
        if($rs){
            return true;
        }else{
            return false;
        }          

    }

}
?>
----------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------
<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');
/**
 * CodeIgniter
 *
 * An open source application development framework for PHP 4.3.2 or newer
 *
 * @package     CodeIgniter
 * @author      ExpressionEngine Dev Team
 * @copyright   Copyright (c) 2008 - 2009, EllisLab, Inc.
 * @license     http://codeigniter.com/user_guide/license.html
 * @link        http://codeigniter.com
 * @since       Version 1.0
 * @filesource
 */

// ------------------------------------------------------------------------

/**
 * CodeIgniter Model Class
 *
 * @package     CodeIgniter
 * @subpackage  Libraries
 * @category    Libraries
 * @author      ExpressionEngine Dev Team
 * @link        http://codeigniter.com/user_guide/libraries/config.html
 */
class Model {

    var $_parent_name = '';

    /**
     * Constructor
     *
     * @access public
     */
    function Model()
    {
        // If the magic __get() or __set() methods are used in a Model references can't be used.
        $this->_assign_libraries( (method_exists($this, '__get') OR method_exists($this, '__set')) ? FALSE : TRUE );

        // We don't want to assign the model object to itself when using the
        // assign_libraries function below so we'll grab the name of the model parent
        $this->_parent_name = ucfirst(get_class($this));

        log_message('debug', "Model Class Initialized");
    }

    /**
     * Assign Libraries
     *
     * Creates local references to all currently instantiated objects
     * so that any syntax that can be legally used in a controller
     * can be used within models.  
     *
     * @access private
     */ 
    function _assign_libraries($use_reference = TRUE)
    {
        $CI =& get_instance();              
        foreach (array_keys(get_object_vars($CI)) as $key)
        {
            if ( ! isset($this->$key) AND $key != $this->_parent_name)
            {           
                // In some cases using references can cause
                // problems so we'll conditionally use them
                if ($use_reference == TRUE)
                {
                    $this->$key = NULL; // Needed to prevent reference errors with some configurations
                    $this->$key =& $CI->$key;
                }
                else
                {
                    $this->$key = $CI->$key;
                }
            }
        }       
    }

}
// END Model Class

/* End of file Model.php */
/* Location: ./system/libraries/Model.php */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T20:47:06.340

这可能会有所帮助： [CodeIgniter 用户指南 - 模型](http://ellislab.com/codeigniter/user-guide/general/models.html)

如果您查看“模型剖析”，您会发现您需要更正您的命名约定，以便 CodeIgniter 正确地找到您的模型。你的类名的第一个字母**必须**大写，如下所示：

```
class Modelmyaccount extends Model { 
```

此外，如果您想正确遵循 CodeIgniter 命名约定；你应该命名你的文件`my_account_model.php`。此外，相应地更改类名，如下所示：

```
class My_account_model extends Model{ 
```

此外，您使用的是哪个版本的 CodeIgniter？您的模型应该扩展`CI_Model`，或者如果您使用自己的模型类扩展，`MY_Model`除非您在`config.php`文件中设置不同的前缀。

因此，如果您使用 2.1.3 版，您的模型类声明应如下所示：

```
class My_account_model extends CI_Model { 
```

替换`CI_`为您使用的前缀。

# java - 将用户定义的对象添加到数组 - 并返回 2 个对象之一

> ID：13689192
> 
> 赞同：0
> 
> 时间：2012-12-03T18:12:15.867
> 
> 标签：java, arrays, collections

我有四门课`A, B, C and Test`。`Test`用于测试目的。

`B`继承自`A`。并`C`继承自`A`。

`check()`我有一个在`test`课堂上调用的方法。它应该返回任`B or C`一对象。所以我希望添加`B and C objects`一个数组，并调用一个介于 1 和 2 之间的随机数。所以这 2 个中的一个将被返回。我不确定如何将 B 和 C 添加到数组中。有人可以告诉我如何在 Java 中做到这一点吗？

```
public Test{

public A check(){
  // add new B() and new C() to an array
  // call a random number to return element 1 or 2 in the array so it will either return B or C

  return either B or C;
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:13:35.700

像这样更好：

```
public class Test{
    private static Random r = new Random();
    private static A[] arr = new A[] {
        new B(), 
        new C()
    };
    public static A check(){
        return arr[r.nextInt(arr.length)];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:18:50.070

下面的数组可以包含任何对象

```
Object[] objects = new Object[2];
objects[0] = new A();
objects[1] = new B(); 
```

# android - Android - 状态栏有时会隐藏部分视图

> ID：13689199
> 
> 赞同：1
> 
> 时间：2012-12-03T18:12:54.060
> 
> 标签：android, android-layout, android-activity, statusbar, android-camera-intent

嗨，我以前问过这个问题，但没有得到任何解决方案。

我对运行 android 4.2 的 Galaxy nexus 有以下问题。

我正在使用相机意图拍照。如果我以横向模式捕获图片并返回到活动（活动`android:screenOrientation="portrait"`在清单中处于纵向模式），状态栏会隐藏视图。如果以纵向模式拍摄照片，效果很好。

这只发生在某些设备上，例如`Galaxy Nexus` 和 `Sony Xperia Neo` 。我在设备上对其进行了测试，`htc Desire`它 `Samsung Ace`运行良好。

请帮忙。

查看状态栏后面![在状态栏后面查看](../Images/9a89c1fac174a730abafac76b08f924b.png)

而需要![在状态栏下方查看](../Images/05daa43ff01710a335000285df29669a.png)

编辑：布局xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@color/signup_bg"
android:orientation="vertical" >
<include
    android:layout_width="match_parent"
    android:layout_height="@dimen/abs__action_bar_default_height"
    layout="@layout/titlebar_account" />
<ScrollView
    android:id="@+id/editAccountScrollView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
    <LinearLayout
        android:id="@+id/editAccountLinearLayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" >
        <include
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="16dp"
            android:layout_marginLeft="16dp"
            android:layout_marginRight="16dp"
            android:layout_marginTop="16dp"
            layout="@layout/signup_basic" />
        <include
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            layout="@layout/signup_home_base" />
        <TextView
            android:id="@+id/textView1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="16dp"
            android:paddingBottom="12dp"
            android:paddingLeft="16dp"
            android:paddingRight="16dp"
            android:paddingTop="10dp"
            android:text="@string/account_about_me"
            android:textColor="@color/account_headings" />
        <include
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="16dp"
            android:layout_marginRight="16dp"
            layout="@layout/edit_account_email_about_me" />
        <include
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            layout="@layout/edit_account_social" />
    </LinearLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T16:31:04.353

这是由于相机 api 在您启动相机应用程序时隐藏状态栏而发生的，并且由于某些问题状态栏绘制与布局重叠意味着状态栏区域覆盖了布局。您可以通过隐藏和显示状态栏来解决此问题。标题栏没有问题。在此处查看我的解决方案：[Android:Layout move up & about 20dp area from the top hides behind the status bar](https://stackoverflow.com/questions/15600450/androidlayout-move-upwards-about-20dp-area-from-the-top-hides-behind-the-stat)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:20:04.807

你可以这样做

```
 setTitle(""); leaves the title blank. 
```

和

```
setDisplayShowTitleEnabled(false); also just leaves the title blank. 
```

# javascript - js代码来判断一个函数是否可用于一个对象

> ID：13689201
> 
> 赞同：0
> 
> 时间：2012-12-03T18:13:05.127
> 
> 标签：javascript

以下 javascript 行得到一个未捕获的类型错误：**对象 #Text 在 chrome 和 safari 中没有方法“getAttribute”**，但在 IE 中没有。

```
this.Element.getAttribute("whatever") 
```

我知道 this.Element 是主要问题，但想要一个临时修复程序来调试代码的其他部分。**如何在不出现 javascript 错误的情况下测试某项功能是否可用？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:15:16.087

```
if (this.Element.getAttribute)
{
// exists
}
else
{
// does not
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:17:18.537

```
if (this && this.Element && typeof this.Element.getAttribute == "function") {
    // ...
} 
```

# regex - 搜索字符串不以开头的 Eclipse 工作区

> ID：13689204
> 
> 赞同：0
> 
> 时间：2012-12-03T18:13:19.883
> 
> 标签：regex, eclipse

在 Eclipse 工作区搜索 (CTRL+H) 中，可以使用什么正则表达式来查找不以 2 个前导正斜杠 (/) 开头的单词的出现 - 或者换句话说，没有注释？

例如`//var_dump`，and`// var_dump`是不匹配的，但是`var_dump`是要匹配的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:30:25.670

文件搜索选项卡中的以下正则表达式可以做到这一点：

```
(?<!//)[ \t]*var_dump 
```

如果您只关心一行中的第一个单词，请在其前面加上一个插入符号：

```
^(?<!//)[ \t]*var_dump 
```

该`(?<!//)`部分是一个否定的后视 - 它只匹配在您正在寻找的东西之前*没有括号内容的东西。*

但是，如果您要查找没有注释的变量，而不是前面没有特定组合“//”的变量，则最好使用语法感知搜索，这取决于所使用的语言。例如，此正则表达式仍将匹配`/* var_dump */`，您可能希望也可能不希望发生这种情况。语法感知搜索会知道这已被注释。

如果您查看“搜索”窗口，您将看到“Java 搜索”选项卡和您可能拥有的其他插件的选项卡（例如，我有“C/C++ 搜索”和“Git 搜索”）。在这些选项卡中，您可以选择仅搜索函数、变量、类或在该语言中有意义的任何其他内容。

您可能想要的另一件事是点击`Ctrl`- `Shift`-`G`一个单词，它会在您的代码中列出对该对象的所有引用 - 在尝试追踪调用您的函数或使用您的变量时非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:27:05.817

如果您要查找变量名称（或任何其他类型的 Java 元素的名称），您可以使用 Java 搜索而不是文件搜索。您没有正则表达式支持，但搜索知道您正在寻找变量/类名，因此您不必担心周围的语法。

# javascript - Bootstrap 预输入未触发

> ID：13689211
> 
> 赞同：0
> 
> 时间：2012-12-03T18:13:56.170
> 
> 标签：javascript, jquery, twitter-bootstrap

我正在尝试使用 Bootstrap typeahead - 但没有运气让它工作。我已经尝试过使用`data-source`Javascript 以及手动使用 Javascript。我最新的例子是：

```
<input class="typeahead" type="text"/>
<script type="text/javascript">
     $(function(){
          $('.typeahead').typeahead({
             items:4,
             source: ['Aaaa', 'Abbb', 'Accc']
          });
     });
</script> 
```

我正在使用 jQuery 1.7.2 ... 是的，jquery 已正确加载，因为我有其他使用 jQuery 的插件并且它们都可以正常工作。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:26:30.940

刚刚想通了。这是一个 CSS 问题。我已经自定义了我的 CSS 下载（我只想要预输入）并省略了我需要的其他项目 - IE，预输入使用下拉框。我一开始就没有把它包括在内。

# c# - 引用许多程序集是否有负面影响？

> ID：13689215
> 
> 赞同：3
> 
> 时间：2012-12-03T18:14:06.683
> 
> 标签：c#

引用许多程序集有什么负面影响？我注意到 ReSharper 具有“删除未使用的引用”的能力（尽管有时它是错误的，例如在运行时通过 Ninject 加载依赖于引用的程序集时），但是除了使项目看起来更干净之外还有什么好处? 生成的程序集在运行时会占用更少的内存吗？也许编译器足够聪明，可以注意到未使用的引用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:16:05.757

编译器足够聪明，可以忽略任何未使用的引用。

但是，Visual Studio Intellisense 中引用的许多程序集会对性能产生影响。

来自[MSDN 上 C# 团队的常见问题解答博客](http://blogs.msdn.com/b/csharpfaq/archive/2004/10/20/245411.aspx)

> 鉴于 .NET 平台鼓励二进制重用类型，通常使用 Visual Studio .NET 添加引用对话框设置对外部程序集的引用。许多程序员（尤其是 C(++) 之流的程序员）担心添加不必要的外部引用会导致一些“代码膨胀”。没有东西会离事实很远。当您添加程序集引用或使用“使用”关键字时，csc.exe 将忽略您在代码中实际未使用的任何程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:28:15.780

每个程序集引用都是增加系统内耦合的依赖项。根据我的经验，引用过多的最大影响是它表明系统设计执行不力，并且可能表明系统正在成为一个[大泥球](http://www.laputan.org/mud/)。

# sharepoint - 农场之间的 CAML 查询

> ID：13689217
> 
> 赞同：2
> 
> 时间：2012-12-03T18:14:11.177
> 
> 标签：sharepoint, caml

我需要规划和实现允许基于元数据标记集搜索文档库的搜索功能。我需要搜索多个文档库和多个场。

有人实施类似的解决方案吗？实施此类要求的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T04:07:54.450

可以肯定的是，这个问题的答案取决于您正在运行的 SharePoint 的哪个版本，没有指定。也就是说，在[SharePoint 2010](http://technet.microsoft.com/en-us/magazine/hh528474.aspx)（和[SharePoint 2013](http://technet.microsoft.com/en-us/library/ff621100.aspx)）中，可以配置跨场服务应用程序。搜索是一个服务应用程序，因此您可以设置跨场搜索。虽然，针对*特定的*文档库可能会很棘手；您需要配置包含文档库所在站点的内容源。

# jquery - CSS3 - “连接” 2 类动画

> ID：13689222
> 
> 赞同：5
> 
> 时间：2012-12-03T18:14:25.043
> 
> 标签：jquery, css, animation, hover

我有这个 CSS +HTML 代码：

```
 <!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>What</title>
    <style type="text/css">
        #page {
            width: 900px;
            padding: 0px;
            margin: 0 auto;
            direction: rtl;
            position: relative;
        }

        #box1 {
            position: relative;
            width: 500px;
            border: 1px solid black;
            box-shadow: -3px 8px 34px #808080;
            border-radius: 20px;
            box-shadow: -8px 5px 5px #888888;
            right: 300px;
            top: 250px;
            height: 150px;
            -webkit-transition: all 1s;
            font-size: large;
            color: Black;
            padding: 10px;
            background: #D0D0D0;
            opacity: 0;
        }

        @-webkit-keyframes myFirst {
            0% {
                right: 300px;
                top: 150px;
                background: #D0D0D0;
                opacity: 0;
            }

            100% {
                background: #909090;
                ;
                right: 300px;
                top: 200px;
                opacity: 1;
            }
        }

        #littlebox1 {
            top: 200px;
            position: absolute;
            display: inline-block;
        }

            .littlebox1-sentence {
                font-size: large;
                padding-bottom: 15px;
                padding-top: 15px;
                padding-left: 25px;
                padding-right: 10px;
                background: #D0D0D0;
                border-radius: 10px;  -webkit-transition: background .25s ease-in-out;
            }

            #littlebox1:hover ~ #box1 {
                -webkit-transition: all 0s;
                background: #909090;;
                right: 300px;
                top: 200px;
                -webkit-animation: myFirst 1s;
                -webkit-animation-fill-mode: initial;
                opacity: 1;

            }
        .littlebox1-sentence:hover {
  background: #909090;
}
.littlebox1-sentence:hover + .triangle {
  border-right: 50px solid #909090;
}

            .triangle {
                position: relative;
                width: 0;
                height: 0;
                border-right: 50px solid #D0D0D0;
                border-top: 24px solid transparent;
                border-bottom: 24px solid transparent;
                right: 160px;  -webkit-transition: border-right .25s ease-in-out;

            }
        .triangle:hover {
               border-right:50px solid #909090;

            }
    </style>
     <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script>     
     $(function() {
  $('.littlebox1-sentence').hover(function() {
    $(this).css('background', '#909090');
    $('.triangle').css('border-right', '50px solid #909090');
  });

   </script>
     <script>    $(function() {
  $('.triangle').hover(function() {
    $(this).css('border-right', '50px solid #909090');
    $('.littlebox1-sentence').css('background', '#909090');
  });
 </script>
</head>
<body dir="rtl">
    <div id="page">
        <div id="littlebox1" class="littlebox1-sentence">put your mouse here</div><div id="littlebox1" class="triangle"> </div>
        <div id="box1">
                       </div>
        </div>

</body>
</html> 
```

[你可以在这里](http://jsfiddle.net/FLe4g/12/)找到活生生的例子。这里的问题是第二个 jQuery 代码有问题。我希望每次将鼠标放在盒子或三角形上时，两者都会一起改变颜色。当我将鼠标放在盒子上时它工作正常，但是当我将鼠标放在三角形上时它不起作用。

任何建议如何修复此代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:42:53.317

只需将框和三角形包装在一个容器中，您就可以使用 CSS 而无需 javascript，在容器的悬停状态上使用后代选择器：

```
#bothcontainer:hover ~ #box1 { ... }
#bothcontainer:hover .littlebox1-sentence { ... }
#bothcontainer:hover .triangle { ... } 
```

[在这里](http://jsfiddle.net/FLe4g/30/)拉小提琴。

# git - 如何将文件从一个 git 分支复制到另一个并保存为不同的文件？

> ID：13689226
> 
> 赞同：3
> 
> 时间：2012-12-03T18:14:36.400
> 
> 标签：git

我想将一个文件从一个 git 分支复制到另一个，但将其保存为不同的文件名。我知道我可以这样做以使用相同的名称复制它。结帐时有没有办法重命名？

```
git checkout otherbranch myfile.txt 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:18:13.290

```
git show otherbranch:myfile.txt > myfile2.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-01-07T04:34:33.820

让我们通过一个例子来理解：如果你想从 master 分支复制***index.html文件来开发具有不同文件名的分支，那么***

第 1 步：结帐以开发分支

```
git checkout develop 
```

step-2：将文件从master复制到develop分支

```
git show main:index.html > new_index.html 
```

第三步：添加这个新文件

```
git add . 
```

第四步：提交文件

```
git commit -m "message" 
```

第5步：并推送文件

```
git push 
```

# php - 使用表单上传制表符分隔的txt文件，然后制作成PHP数组？

> ID：13689227
> 
> 赞同：1
> 
> 时间：2012-12-03T18:14:39.960
> 
> 标签：php, arrays, file, tabs, delimited

我正在尝试将一个制表符分隔的文本文件解析为一组 PHP 数组，非常感谢您的帮助。

.txt 看起来像这样（制表符分隔而不是空格）

```
data1a data1b data1c data1d
data2a data2b data2c data2d
data3a data3b data3c data3d
data4a data4b data4c data4d 
```

等等

我希望 PHP 数组看起来像这样

```
$arrayA = array('data1a', 'data2a', 'data3a', 'data4a');
$arrayB = array('data1b', 'data2b', 'data3b', 'data4b');
$arrayC = array('data1c', 'data2c', 'data3c', 'data4c');
$arrayD = array('data1d', 'data2d', 'data3d', 'data4d'); 
```

我需要一个简单的html表单上传的.txt文件，例如

```
<form action="form.php" method="post" enctype="multipart/form-data">
  <label for="file">Filename:</label>
  <input type="file" name="file" id="file" /> 
  <input type="submit" name="submit" value="Submit" />
</form> 
```

关于放在 form.php 中的代码有什么想法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:48:49.513

考虑`text.txt`文件的内容

```
FristLineFirstData FirstLineSecondData FirstLineThirdData
SecondLineFirstData SecondLineSecondData SecondLineThirdData

```

制表符分开。

和脚本：

```
<?php
$file = "text.txt";// Your Temp Uploaded file
$handle = fopen($file, "r"); // Make all conditions to avoid errors
$read = file_get_contents($file); //read
$lines = explode("\n", $read);//get
$i= 0;//initialize
foreach($lines as $key => $value){
    $cols[$i] = explode("\t", $value);
    $i++;
}
echo "<pre>";
print_r($cols); //explore results
echo "</pre>";
?> 
```

将返回

```
大批
(
    [0] => 数组
        (
            [0] => FristLineFirstData
            [1] => FirstLineSecondData
            [2] => FirstLineThirdData
        )

    [1] => 数组
        (
            [0] => SecondLineFirstData
            [1] => SecondLineSecondData
            [2] => SecondLineThirdData
        )

)

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:36:07.980

以下是针对您的问题的准系统解决方案：

```
<?php
 $error = false;

 if (isset($_POST) && isset($_POST['submit']) && isset($_FILES) {)
    $file = $_FILES['file'];
    if (file_exists($_FILES['tmp_name'])){
       $handle = fopen($_FILES['tmp_name']);
       $data = fgetcsv($handle, 0, '\t');
    }
    // do your data processing here
    // ...
    // do your processing result display there
    // ...
    // or redirect to another page.
 }
 if ($error) {
   // put some error message here if necessary
 }
 // form display below
 ?>
 <!-- HTML FORM goes here --!>
 <?
 }
 ?> 
```

文件数据将全部分组在同一个数组`$data`中，由文件中相应的行号索引。

看：

*   [`fgetcsv`](http://php.net/fgetcsv)
*   [`$_FILES`](http://php.net/manual/en/reserved.variables.files.php)

在 PHP 文档网站上。

# asp.net - 让 https 在 asp.net MVC4 应用程序中本地工作

> ID：13689232
> 
> 赞同：2
> 
> 时间：2012-12-03T18:15:15.970
> 
> 标签：asp.net, asp.net-mvc, ssl, https

我完全按照本教程进行操作：

[http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx](http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx)

但是，当我在本地运行并尝试从非 https 页面（如主页/索引）导航到我用 [RequireHttps] 装饰的页面时，我会收到通用的“SSL 连接错误”消息。

我讨厌发布这样一个笼统的问题，但你能想到我错过了什么吗？这是一个大型的 asp.net mvc4 应用程序，我在项目中启用了 ssl，它显示了 ssl url。手动导航到 ssl url 也不起作用。

停！

注意：在 Visual Studio 2012 中使用 IIS Express

根据评论，我得到的错误是无法建立 SSL 连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T03:01:26.760

在本地测试时不应该使用 Https。我创建了自己的 Https 过滤器，它将忽略 localhost 中的所有本地流量，并且仅适用于登台和实时环境。您可以修改代码以满足您的需要。

```
public class RequireSSLAttribute : FilterAttribute, IAuthorizationFilter {
    public virtual void OnAuthorization(AuthorizationContext filterContext) {
        if(filterContext == null) {
            throw new ArgumentNullException("filterContext");
        }

        if(!filterContext.HttpContext.Request.IsSecureConnection) {
            HandleNonHttpsRequest(filterContext);
        }
    }

    protected virtual void HandleNonHttpsRequest(AuthorizationContext filterContext) {
        if(filterContext.HttpContext.Request.Url.Host.Contains("localhost")) return;

        if(!String.Equals(filterContext.HttpContext.Request.HttpMethod, "GET", StringComparison.OrdinalIgnoreCase)) {
            throw new InvalidOperationException("The requested resource can only be accessed via SSL");
        }

        string url = "https://" + filterContext.HttpContext.Request.Url.Host + filterContext.HttpContext.Request.RawUrl;
        //ignore if the request is from a child action
        if(!filterContext.IsChildAction) {
            filterContext.Result = new RedirectResult(url);
        }
    }
} 
```

这就是你使用它的方式......

```
[RequireSSL(Order=1), Authorize(Order=2)]
public PartialViewResult AccountHeader() {

blah...blah...

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-18T09:09:52.293

我知道它已经回答了，但我想我会指出原始错误的原因，其他答案省略了。

当您在 IIS Express 上启用 SSL 时，您的站点托管在 2 个端口上，1 个用于 http，另一个用于 https。在 Visual Studio 中调试时，通常会明确指定端口。您网站上的链接可能没有指定端口号，因此当您从普通 http 页面链接到 https 页面时，端口号不会更改，您将在普通 http 端口上请求 https 页面。这就是您收到 SSL 连接错误的原因。

在真实的服务器上，端口号应该是隐式的，所以问题不应该出现，但是您需要确保在本地调试时使用正确的端口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T18:26:49.383

您需要在 IIS 中将 ssl 证书添加到您的站点实例。要创建证书并将其添加到 IIS7，请尝试本教程：[http ://technet.microsoft.com/en-us/library/cc753127(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc753127%28v=ws.10%29.aspx)

创建后，您将能够将其添加到您的网站。在 IIS '你的网站'中打开 -> 绑定 -> 添加并添加新的主机头。选择 https，端口 443 并选择创建的证书。

# python - 使用 easy_install 更改临时工作文件夹 (tmp)

> ID：13689235
> 
> 赞同：0
> 
> 时间：2012-12-03T18:15:34.767
> 
> 标签：python, easy-install

我正在尝试使用包含的简易安装包从 Broad Institute 安装 Birdsuite 管道。尝试查找设置脚本时安装失败：

```
=================================================================
SETTING UP http://pypi.python.org/packages/2.5/p/plinkpipeline/plinkpipeline-1.6.6-py2.5.egg
:
Downloading http://pypi.python.org/packages/2.5/p/plinkpipeline/plinkpipeline-1.6.6-py2.5.egg

Processing plinkpipeline-1.6.6-py2.5.egg

error: Couldn't find a setup script in /tmp/easy_install-hxr0WF/plinkpipeline-1.6.6-py2.5.egg

================================================================= 
```

我同意这个错误，我也无法在指定文件夹中找到脚本。我有权在 /tmp/ 中写入文件和文件夹。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:19:39.757

不幸的是，该项目*只*提供了一个 python 2.5 egg，根本不包含 setup.py 文件。

这是包作者的错误。您需要找到`.tar.gz`源代码分发版。不过，我找不到一个。

# codeigniter - 在 CodeIgniter 的核心类中使用辅助函数

> ID：13689238
> 
> 赞同：1
> 
> 时间：2012-12-03T18:15:40.380
> 
> 标签：codeigniter, helpers

我想在核心类 CI_Router（更准确地说是 MY_Router）中使用一个助手。在这个自定义路由器中，我对原始代码进行了一些修改，以便能够在我的网址中插入连字符。像往常一样，我已经在 autoload.php 文件上定义了帮助程序，但似乎我不能在视图或控制器以外的类中调用帮助程序函数。

关于如何处理这个问题的任何想法？我最初的方法是使用一个助手，所以我可以在任何我想要的地方重用它。

TYVM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:25:15.900

直到核心之后才实例化助手，因此它为什么不起作用。

您要么必须：

1.  在你的类中复制函数`MY_Router`，或者，
2.  重新思考为什么您可能会在路由器中使用与标准控制器或视图中相同的功能。

选项 1 显然更容易，但可能不是更可取，具体取决于您的强迫症有多严重。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T19:17:41.450

您可以尝试获取主 CI 对象的实例并将其设置为变量，然后使用该变量加载帮助程序。前任：

```
$ci =& get_instance();
$ci->load->helper('date'); 
```

我知道这适用于其他领域，对于任何路由器类都不是 100% 确定的。

# java - 休眠中的多对一关系，而不是数据库中的关系

> ID：13689240
> 
> 赞同：1
> 
> 时间：2012-12-03T18:15:42.990
> 
> 标签：java, hibernate, orm

我有一个名为“部门”的实体和另一个名为“学生”的实体。我知道该部门会有很多学生，并且数据库中这两个表之间应该有关系。但是在我的项目中，数据库表已经存在，并且部门和学生表之间没有关系（外键）。

在实体类 student.java 中，有一个关系写成，

```
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = 'DeptId', nullable = false, insertable = false, updatable = false)
Department department 
```

我对这个现有的代码感到困惑。

当我编写测试时，我通过 deptId 从数据库中获取部门并将学生实体设置为，

```
student.setDepartment(department); 
```

这不会填充学生表中的数据库列“DEPTID”。

由于部门中没有学生收藏，我无法将学生设置为，

```
department.addStudents(student); 
```

我不确定我们是否可以坚持 @ManyToOne 关系而不需要 DB 中的表之间的关系。

请告诉我如何解决此问题，以便在学生表中的“DEPTID”列中填充正确的数据。

在此先感谢，BS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:44:58.377

你有

`@JoinColumn(name = 'DeptId', nullable = false, insertable = false, updatable = false)` 相反，你为什么不试试

`@JoinColumn(name = 'DeptId', nullable = false)`

Hibernate 不会检查您放置的映射约束在数据库级别是否有效。它只是假设它是有效的并基于该假设执行查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T10:49:45.870

嗨，很抱歉这么晚才回复您的问题，但我认为回复同样可以帮助另一个人。现在您说这些表已经存在于数据库中，如果它们`haven't yet got some data`那么我建议您，请在您的文件中`drop`激活您的，在这种情况下，它将使用您想要的关系列重新创建这些表。不要忘记在课堂上使用注释来表明它对许多学生的接待能力。它与`Table Generation Strategy``persistence.xml``Create``@OneToMany``Department.java``@ManyToOne`

# java - 使用线程逐块处理文件

> ID：13689245
> 
> 赞同：2
> 
> 时间：2012-12-03T18:15:58.777
> 
> 标签：java, multithreading, ftp, snmp

我有一个包含 5000 个 IP 地址的数组列表。对于每个 IP 地址，我想执行一个 SNMPGet 请求和一个 FTPDownload 命令。我想以一种方式实现它，其中前五个 IP 地址同时运行 2 个不同的线程。在执行完这些 IP 地址之后，接下来的 2 个 IP 地址将在这些线程上执行。任何人都可以帮助如何做到这一点？

这里的connection是一个扩展线程的类，要实现的工作写在它的run()方法中。请帮忙。

```
Connection newConnection =new Connection(0);
Connection newConnection1 =new Connection(1);

for(int i = 0; i < NE_list.getRowCount(); i=i+2)
{
if(NE_list.getValueAt(i, 0).toString().equals("true")) //Some condition here for the IP Address
{

            newConnection.i=i;
            newConnection1.i=i+1;
            newConnection.runprogram();
            newConnection1.runprogram();
 }

    } 

class Connection extends Thread{
int  i;
Connection(int val){
  i=val;
}
void runprogram(){
start();
}
public void run(){
//SNMP and FTP Code here for IP Address in index i of NE_list
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T07:11:14.000

Executor Framework 将最适合您的解决方案。我在这里创建了一个示例。您可以根据需要增加线程数。

```
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

class SomeRunnable implements Runnable {
    int threadNo = -1 ;
    List<String> list = new ArrayList<String>();
    public SomeRunnable(List list, int threadNo ) {
        this.list.addAll(list);
        this.threadNo =threadNo;
    }
    @Override
    public void run() {
        for (String element : list) {
            System.out.println("By Thread:" + threadNo+", Processed Element:" +element);
        }
    }

}

public class ExecutorDemo {
    public static void main(String[] args) {
        List<String> list = new ArrayList<String>();
        for (int i = 0; i < 100; i++) {
            list.add("Elem:"+i);
        }
        // Divide list 
        int divideIndex = list.size()/2;
        //Create objects of Runnable
        SomeRunnable obj1 = new SomeRunnable(list.subList(0, divideIndex),1);
        SomeRunnable obj2 = new SomeRunnable(list.subList(divideIndex,list.size()),2);

        //Create fixed Thread pool, here pool of 2 thread will created
        ExecutorService pool = Executors.newFixedThreadPool(2);

        pool.execute(obj1);
        pool.execute(obj2);

        pool.shutdown();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-29T15:08:03.283

特此添加具有 5 个线程的工作示例。只需将 test.txt 放在应用程序的 CLASS_PATH 中即可。

```
class MyRunnable implements Runnable {
List<List<String>> records;
MyRunnable(List<List<String>> records){
    this.records = records;
}
public void run(){
    for(List list : records){
        System.out.println(Thread.currentThread().getName() + " : "+list.toString());
    }
}} 
```

主要课程 -

```
public class FileProcessThreads {
public List<List<String>> process(String fileName) throws IOException {
    List<List<String>> records = new ArrayList<>();
    BufferedReader br = new BufferedReader(new FileReader(fileName));
    String line = null;
    while((line = br.readLine()) != null){
        List<String> listValues = Arrays.asList(line.split(" "));
        records.add(listValues);
    }
    System.out.println(records.size());
    return records;
}
public static void main(String[] args) throws IOException {
    FileProcessThreads fp = new FileProcessThreads();
    List<List<String>> records = fp.process("test.txt");
    ExecutorService es = Executors.newFixedThreadPool(5);
    int recordsInEachThread = (int) (records.size()/5);
    System.out.println(recordsInEachThread);

    MyRunnable my1 = new MyRunnable(records.subList(0, recordsInEachThread));
    MyRunnable my2 = new MyRunnable(records.subList(recordsInEachThread+1, recordsInEachThread*2));
    MyRunnable my3 = new MyRunnable(records.subList(recordsInEachThread*2 + 1, recordsInEachThread*3));
    MyRunnable my4 = new MyRunnable(records.subList(recordsInEachThread*3 + 1, recordsInEachThread*4));
    MyRunnable my5 = new MyRunnable(records.subList(recordsInEachThread*4 + 1, records.size() - 1));
    es.execute(my1);
    es.execute(my2);
    es.execute(my3);
    es.execute(my4);
    es.execute(my5);
    es.shutdown();
}} 
```

# css - 如何将 twitter-bootstrap 图标添加为 CSS 背景图像？

> ID：13689249
> 
> 赞同：0
> 
> 时间：2012-12-03T18:16:10.947
> 
> 标签：css, twitter-bootstrap

我有一个用于将鼠标悬停在表格上以突出显示当前行的 CSS。

```
.cb_table-hover tbody tr:hover td,
.cb_table-hover tbody tr:hover th {
  background-color: #cfcfcf;

} 
```

此外，我想在同一个 CSS 中添加另一行，以在悬停表格行的背景中显示一个 twitter 引导图标。

```
<i class="icon-search"></i> 
```

起初我想使用 a`background-image:url('??');`但图标不能这样定义。

如果可能的话，知道吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:37:48.973

当然 ！您不能使用图像精灵设置背景图像

但是您可以将图标放在 td/th 标签内并使用“显示”来显示/隐藏图标：

```
.cb_table-hover tbody tr td .icon-search,
.cb_table-hover tbody tr th .icon-search{
    display: none;
}

.cb_table-hover tbody tr td:hover .icon-search,
.cb_table-hover tbody tr th:hover .icon-search{
    display: inline-block;
} 
```

# facebook - Facebook 在随后的共享中未在 MSIE9 中显示 og:image 缩略图

> ID：13689252
> 
> 赞同：5
> 
> 时间：2012-12-03T18:16:25.103
> 
> 标签：facebook, internet-explorer-9

我在使用 Facebook 时遇到了一个奇怪的问题。当我在 MSIE 9 中共享我的内容时，它会在我第一次共享 URL 时成功加载缩略图，但如果我再次共享它，缩略图不会加载（并且永远不会再次加载）。它只显示他们的动画“加载”图像几秒钟，然后消失，缩略图选项也是如此。

您可以通过单击 MSIE 9 中的这些 Facebook 共享链接自行查看。

[示例 1](http://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Fsparkengine.call2action.com%252Fsparks%252F5186%252Flive) [示例 2](http://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Fsparkengine.call2action.com%252Fsparks%252F5175%252Flive)

相同的共享功能在其他浏览器中运行良好，并且每次从同一个 MSIE 9 共享其他页面（例如 Youtube 视频）都运行良好。

运行[Facebook 的调试器](https://developers.facebook.com/tools/debug)并不能解决问题，也不会报告我页面上的 OpenGraph 标记有任何问题。它甚至显示有问题的缩略图。

查看 Facebook 中开发人员工具的网络选项卡显示，每次我共享内容时都会加载缩略图。

**更新**

我发现 MSIE 9 将在以下条件下显示图像： - 如果我的缓存中已经有图像 - 如果浏览器没有向服务器请求图像来自的 safe_image.php URL .

我一直在搞乱这个测试页面：[http ://www.facebook.com/sharer/sharer.php?u=http://c2a-v3-staging.s3.amazonaws.com/sparks%2Fspark_5079%2Findex_test .html](http://www.facebook.com/sharer/sharer.php?u=http://c2a-v3-staging.s3.amazonaws.com/sparks%2Fspark_5079%2Findex_test.html)

如果刷新页面，我将无法加载图像，因为这会向服务器请求 safe_image.php。不管响应是 200 还是 304，图像都不会显示。但是，如果我然后转到位置栏并按 Enter，那是“导航”事件而不是“刷新”，不会对图像发出请求，并且会显示（从缓存加载后）。

我尝试从另一个域提供图像，添加 og:image:secure_url 标签，让 Facebook 在不同域上抓取 HTML，这是迄今为止我能做的最好的。不幸的是，它毫无用处，因为这意味着任何用户的第一个共享永远不会正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T01:39:36.750

facebook 不再支持 fb 的共享功能，您应该使用 javascript api 的提要对话框部分：[https ://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)

还要确保您的 og 元标记包含可能是您的问题的正确信息[http://ogp.me/](http://ogp.me/)，图像大小是元标记，图像至少应为 200x200，以优化 og 元数据的抓取

您还可以检查元数据从[https://developers.facebook.com/tools/debug得到的错误](https://developers.facebook.com/tools/debug)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T19:41:54.917

解决了！奇怪的是，问题在于图像的尺寸。如果我减小 og:image 的尺寸以适合 255x255 像素框，则共享在 MSIE9 中完美运行！稍大的尺寸（如 262x262）不起作用。

当然，我必须通过 Facebook 调试工具运行 URL 以清除我们的缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T00:07:12.493

I have another answer to your Question.

Reference: [**https://sparkengine.call2action.com/sparks/5186/live**](https://sparkengine.call2action.com/sparks/5186/live)

The above webpage you want to share doesn't have the **Facebook Opengraph** protocol for the webpage's thumbnail to be used when sharing links with Facebook.

Here's what that metatag should look like:

```
<meta property="og:image" content="https://sparkengine.call2action.com/assets/c2a_logo_white-6396a6a536d065359780af683e66dd2a.png"/> 
```

Read more about using this propery name [**HERE**](http://www.bravr.com/custom-thumbnail-facebook-shares/).

In **Facebook's debugger** tool, it could just be showing a thumbnail that's rendered in the debugger but not necessarily associated with the shared link process.

Although you do see ***a thumbnail image*** in the Network Tab, it's not necessarily the case that this will be used in the shared link process, hence the **Facebook Opengraph** protocol solves this problem, and allows further customization.

* * *

**EDIT:**
It appears at the moment of this writing, your webpage's template has changed. I now notice that the only previously seen og metatag names of:

```
og:video
og:video:height
og:video:width 
```

now includes the `og:image` metatag, along with other newly added `og` metatag properties.

Current image file provided for `og:image` metatag:

[**https://c2a-v3.s3.amazonaws.com/sparks/spark_5186/media/thumbnails/spark_5186_09_28_2012_WgZN50Q.jpg**](https://c2a-v3.s3.amazonaws.com/sparks/spark_5186/media/thumbnails/spark_5186_09_28_2012_WgZN50Q.jpg)

In Firefox web browser, but not in IE8, accessing the og:image directly in the browsers address bar produced this download box:

![enter image description here](../Images/3abe209a798f33e7cd19a6488a532f0e.png)

What also struck me odd about that download is that it's identified as a **flash movie**. To be sure, no issues were seen in IE8.

I then tested that image thumbnail link directly in Chromes web browser, and that caused an automatic download of that image, but it did not display in the browser, treating it like a downloaded mime type file.

This was true for both thumbnails in both your examples. Perhaps the server-side **flash-to-thumbnail** is saving the images with incorrect mime file-type information. Once downloaded and analyzed in **IfranView**, no errors were reported with the `.jpg image`, as IrfanView will check the file header to ensure it matches it's file-type extension automatically. I would look into how these thumbnails are created on the back-end.

* * *

**DIGGING DEEPER:**

I now understand that you'll have no control on how these thumbnails are made, since it's a service/process done by **Amazon s3 Web Servers**.

Digging deeper, I see that the main domain for this image files URL is for an `XML File`:

Reference: [**https://c2a-v3.s3.amazonaws.com**](https://c2a-v3.s3.amazonaws.com)

Google to the rescue. I typed in [**amazon thumbnail opens as file**](http://bit.ly/12omsmE) and [**this article**](http://ansonalex.com/troubleshooting/fix-articles-linked-on-facebook-dont-display-thumbnails-images/) mentioned to drop the protocol `http://www.` or `https://www.` when using a URL for `og` metatags.

The [**Facebook Debugger**](http://developers.facebook.com/tools/debug/og/object?q=sparkengine.call2action.com%2Fsparks%2F5186%2Flive) shows no errors when dropping the `https://` too, even though it will be report as `http://` protocol.

**Try:**

```
<meta content='sparkengine.call2action.com/sparks/5186/live' property='og:url'>
<meta content='c2a-v3.s3.amazonaws.com/sparks%2Fspark_5186%2Fmedia%2Fthumbnails%2Fspark_5186_09_28_2012_WgZN50Q.jpg' property='og:image'> 
```

Note any Facebook user can force **HTTPS** requests via there settings, otherwise **HTTP** is assumed here.

**Resulting Shared Link Generated:**

```
http://www.facebook.com/sharer.php?u=http%3A%2F%2Fsparkengine.call2action.com%2Fsparks%2F5186%2Flive 
```

# asp.net - 将网页从 HTML 转换为 PDF？

> ID：13689255
> 
> 赞同：1
> 
> 时间：2012-12-03T18:16:28.697
> 
> 标签：asp.net, html, pdf, pdf-generation

我有一个具有以下结构的网站： 选项卡容器 - 有 4 个选项卡面板 每个选项卡面板都有 4 个由换行符分隔的网格视图。

现在，当我在一个特定的选项卡中时，我想使用一个“导出到 pdf”按钮，它应该生成一个在这个选项卡面板中可见 4 个网格视图的 pdf。所有其他选项卡面板相同。

我已经进行了足够多的搜索，发现可能有关于使用 itextsharp、wkhtmltopdf、pdf 生成器等的文章，但是我似乎在任何地方都找不到完全实现的功能。

任何人都可以指导/建议任何事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:26:14.677

我使用了 CutePDF 的 API，它们似乎工作得很好。

[http://www.cutepdf.com/Solutions/](http://www.cutepdf.com/Solutions/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:22:59.313

我总是使用[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)将 html 页面转换为 pdf。（您将需要服务器访问权限才能安装它）

它工作得很好，看起来与网站相同，并将文本保存为实际文本（以矢量形式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T06:39:34.160

Adobe ColdFusion 有一个名为 `<CFPDF>`built-in 的标签。

[http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7995.html](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7995.html)

此外，它还具有可以弥合与 ASP.Net 差距的 Web 服务

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T07:03:55.323

您可以通过两种方式执行此操作，或者在您的服务器上处理它，或者使用第三方服务。

如果您想在服务器上将 html 页面转换为 PDF，您可以使用 [wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)（一个使用 webkit 渲染引擎和 qt 将 html 转换为 pdf 的简单 shell 实用程序。）我没有在 .NET 中使用它但是有看到很多例子。

如果您想使用第三方服务[www.impdf.com](http://www.impdf.com/save-to-pdf.htm)可以使用，这是一项免费服务。你甚至不需要注册。我曾经使用过它但没有很长时间（后来我切换到 wkhtmltopdf 获得了一些性能提升）。

这取决于您的要求，您必须使用哪种方法。无论如何，如果使用 impdf 对您来说就足够了，

```
<a href="impdf.com?url=http://www.yourwebsite.com">Convert this page to a PDF</a> 
```

A4 页面：`impdf.com?url=http://www.yourwebsite.com&--page-size=A4`

信页： `impdf.com?url=http://www.yourwebsite.com&--page-size=Letter`

# c# - 正则表达式匹配多个组

> ID：13689259
> 
> 赞同：5
> 
> 时间：2012-12-03T18:16:56.273
> 
> 标签：c#, regex

我有以下我试图匹配的带有正则表达式的字符串示例：

正则表达式： `^\d{3}( [0-9a-fA-F]{2}){3}`

要匹配的字符串： `010 00 00 00`

我的问题是 - 正则表达式匹配并捕获 1 个组 -`00`字符串末尾的最后一个。但是，我希望它最后匹配所有三个`00`组。为什么这不起作用？当然，括号应该意味着它们都是平等匹配的吗？

我知道我可以分别输入这三个组，但这只是一个更长的字符串的简短摘录，所以这会很痛苦。我希望这会提供一个更优雅的解决方案，但似乎我的理解有所欠缺！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:22:10.977

因为您在捕获组上有一个量词，所以您只能看到上次迭代的捕获。[不过幸运的是，.NET（与其他实现不同）提供了一种通过CaptureCollection 类从](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.capturecollection.aspx)*所有*迭代中检索捕获的机制。从链接的文档中：

> 如果将量词应用于捕获组，则 CaptureCollection 为每个捕获的子字符串包含一个 Capture 对象，并且 Group 对象仅提供有关最后捕获的子字符串的信息。

以及链接文档中提供的示例：

```
 // Match a sentence with a pattern that has a quantifier that  
  // applies to the entire group.
  pattern = @"(\b\w+\W{1,2})+";
  match = Regex.Match(input, pattern);
  Console.WriteLine("Pattern: " + pattern);
  Console.WriteLine("Match: " + match.Value);
  Console.WriteLine("  Match.Captures: {0}", match.Captures.Count);
  for (int ctr = 0; ctr < match.Captures.Count; ctr++)
     Console.WriteLine("    {0}: '{1}'", ctr, match.Captures[ctr].Value);

  Console.WriteLine("  Match.Groups: {0}", match.Groups.Count);
  for (int groupCtr = 0; groupCtr < match.Groups.Count; groupCtr++)
  {
     Console.WriteLine("    Group {0}: '{1}'", groupCtr, match.Groups[groupCtr].Value);
     Console.WriteLine("    Group({0}).Captures: {1}", 
                       groupCtr, match.Groups[groupCtr].Captures.Count);
     for (int captureCtr = 0; captureCtr < match.Groups[groupCtr].Captures.Count; captureCtr++)
        Console.WriteLine("      Capture {0}: '{1}'", captureCtr, match.Groups[groupCtr].Captures[captureCtr].Value);
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:22:48.577

这应该适用于您当前的字符串。我需要一个更好的例子（更多的字符串等）来看看这是否会破坏那些。单词边界 (\b) 检查任何非单词字符：

```
\b[0-9a-fA-F]{2}\b 
```

# ruby - 在 Sass 中更改缩进

> ID：13689264
> 
> 赞同：6
> 
> 时间：2012-12-03T18:17:10.590
> 
> 标签：ruby, sass

使用 Sass 时，如何将输出 CSS 文件中的缩进从 2 个空格更改为 4 个空格？我正在使用扩展样式。我对 Ruby 一无所知，但我尝试读取`/Library/Ruby/Gems/1.8/gems/sass-3.2.1/`计算机上的每个 rb 文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T18:39:55.747

`sass-3.2.3/lib/sass/tree/visitors/to_css.rb``' '`有许多用于缩进的硬编码双空格字符串 ( )。如果您将它们全部替换为四个空格的字符串，它将按照您的说明编译您的 css。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-16T05:34:35.653

更改 sass 缩进的正确方法是转到`rubygems/gems/sass-3.x.x/lib/sass/tree/visitors/to_css.rb`（或您的 to_css.rb 文件所在的任何位置），然后编辑：

`tab_str = ' ' * (@tabs + node.tabs)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-30T10:59:26.120

由于这是关于`sass`缩进的参考问题，截至目前（2019 年 12 月），接受的答案已经过时；我添加了这个答案。
根据[`sass`文档](https://sass-lang.com/documentation/js-api#indenttype)，在其选项中，它接受两个名为`indentType`和的选项`indentWidth`来控制缩进行为。
默认使用 4 个空格，可以更改为 1 个选项卡，如下所示：

```
function css() {
    return gulp
    .src("./scss/**/*.scss")
    .pipe(plumber())
    .pipe(sass({
        outputStyle: "expanded",
        includePaths: "./node_modules",
        indentType: "tab",
        indentWidth: 1
    }))
    .on("error", sass.logError)
    .pipe(autoprefixer({
        cascade: false
    }))
    .pipe(header(banner, {
        pkg: pkg
    }))
    .pipe(gulp.dest("./css"))
    .pipe(rename({
        suffix: ".min"
    }))
    .pipe(cleanCSS())
    .pipe(gulp.dest("./css"))
    .pipe(browsersync.stream());
} 
```

# .net - .NET 3.5 Smtpclient - 发送电子邮件失败 - 仅在每次重新启动后才有效

> ID：13689265
> 
> 赞同：2
> 
> 时间：2012-12-03T18:17:13.640
> 
> 标签：.net, smtpclient

在带有 .NET 3.5 的 Windows 控制台应用程序中（我将现有的 .NET 2.0 应用程序更改为 .NET 3.5）

我有一个奇怪的问题，发送电子邮件的代码工作几次（可能是 5 到 10 次）。

几次后，它无法发送带有消息“发送邮件失败”的电子邮件。重新启动系统后，相同的代码可以工作。（这不是生产中的预期解决方案）。

这是一段代码，我觉得在某个地方我关闭了这个 SmtpClient 连接。所以我将客户端设置为 null 并调用 GC.Collect ，但没有帮助我。

请帮忙

```
 private static void SendEmail(MailMessage msg)
{
            SmtpClient client = new SmtpClient(GetSMTPServer(), GetSMTPPort());

            client.Credentials = CredentialCache.DefaultNetworkCredentials;
            client.EnableSsl = false;
            client.ServicePoint.MaxIdleTime = 1;
            //client.Timeout = GetSMTPTimeout(); 30000000
            client.Send(msg);
            client = null;
            GC.Collect();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-07T14:11:39.727

尝试简单地使用`using`块来正确处理`SmtpClient`发送后的内容。

```
private static void SendEmail(MailMessage msg)
{
    using(SmtpClient client = new SmtpClient(GetSMTPServer(), GetSMTPPort()))
    {
        client.Credentials = CredentialCache.DefaultNetworkCredentials;
        client.EnableSsl = false;
        client.Send(msg);
    }
} 
```

另请参阅：[.NET 发送电子邮件的最佳方法（System.Net.Mail 有问题）](https://stackoverflow.com/questions/930236/net-best-method-to-send-email-system-net-mail-has-issues)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T06:31:07.250

如果两次发送邮件的间隔大于 60 秒小于 90 秒，你肯定会得到这个错误。

例如，您在上午 8:08:08 发送第一封电子邮件，然后在上午 8:09:10 发送第二封电子邮件，则会抛出异常。

这是`SmtpClient.TimeOut`设置的错误，您无法更改它。

如何解决这个问题呢？三种方式：

1.  尝试捕获发送，如果捕获异常，则再次发送。
2.  `SmtpClient.Dispose()`适用于 .net 框架 3.0 及更高版本
3.  设置`SmtpClient.servicepoint.maxidletime=1000;`为 1 太小，在调试模式下不起作用

# javascript - 谷歌地图 V3 地理编码 + 缩放

> ID：13689270
> 
> 赞同：4
> 
> 时间：2012-12-03T18:17:19.830
> 
> 标签：javascript, google-maps, google-maps-api-3, zooming

我正在使用 Javascript API 的 Google Maps Version 2 的地理编码服务。 [https://developers.google.com/maps/documentation/javascript/v2/reference](https://developers.google.com/maps/documentation/javascript/v2/reference) 但是谷歌决定不再支持他。

> 注意：Google Maps JavaScript API 版本 2 已于 2010 年 5 月 19 日正式弃用。V2 API 将继续工作到 2013 年 5 月 19 日。我们鼓励您将代码迁移到 Maps JavaScript API 版本 3。

那么如何在谷歌地图版本 3 javascript api 中使用缩放进行地理编码？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-03T18:35:56.243

要缩放地图以最好地显示地理编码操作的结果，您可以使用[google.maps.Map fitBounds](https://developers.google.com/maps/documentation/javascript/reference#Map)方法和结果的 viewport 属性：

```
function codeAddress() {
    var address = document.getElementById("address").value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map, 
                position: results[0].geometry.location
            });
        if (results[0].geometry.viewport) 
          map.fitBounds(results[0].geometry.viewport);
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  } 
```

**代码片段：**

```
var geocoder, map, marker;

function codeAddress() {
  var address = document.getElementById("address").value;
  geocoder.geocode({
    'address': address
  }, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      if (marker && marker.setMap) marker.setMap(null);
      marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location
      });
      if (results[0].geometry.viewport)
        map.fitBounds(results[0].geometry.viewport);
    } else {
      alert("Geocode was not successful for the following reason: " + status);
    }
  });
}

function initialize() {
  geocoder = new google.maps.Geocoder();
  map = new google.maps.Map(
    document.getElementById("map_canvas"), {
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
  google.maps.event.addDomListener(document.getElementById('btn'), 'click', codeAddress);
  codeAddress();

}
google.maps.event.addDomListener(window, "load", initialize);
```

```
html,
body,
#map_canvas {
  height: 100%;
  width: 100%;
  margin: 0px;
  padding: 0px
}
```

```
<script src="https://maps.googleapis.com/maps/api/js"></script>
<input id="address" value="Palo Alto, CA" />
<input id="btn" value="Geocode" type="button" />
<div id="map_canvas"></div>
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:17:19.830

```
var geocoder = new google.maps.Geocoder();
geocoder.geocode({ 'address': zipcode }, function(results, status)
{
    if (status == google.maps.GeocoderStatus.OK)
    {
        map.setCenter(results[0].geometry.location);
        map.setZoom(12);
    }
    else
    {
       alert(zipcode + " not found");
       console.log("status : ", status);
    }
}); 
```

# android - 底部栏中的android溢出菜单

> ID：13689272
> 
> 赞同：1
> 
> 时间：2012-12-03T18:17:23.103
> 
> 标签：android, android-actionbar

我试图让操作栏中的溢出按钮显示在底部，在返回/主页/其他应用程序按钮旁边。我假设如果我关闭标题栏就会出现这种情况，但事实并非如此。我尝试用谷歌搜索它，但找不到任何解决方案。

谁能给我一个提示？

例如这个应用程序有它： ![例如这个应用程序有它](../Images/e8bba166b62171533cf401131e77948a.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T18:37:28.850

在您`AndroidManifest`必须将 targetSdkVersion 设置为 13 或更早，如下所示：

```
<uses-sdk android:targetSdkVersion="13" /> 
```

这将迫使 ICS 在兼容模式下运行您的应用程序，并在底部栏中为您提供 3 个点作为溢出菜单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:38:06.527

将溢出菜单按钮添加到系统导航栏是为了支持针对没有硬件菜单按钮的旧版本 android（2.3 及更早版本）的应用程序。

[http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html)

上面的文章提供了系统在导航栏中放置溢出按钮时的逻辑。它没有说明如何强制它出现在所有设备上。但它可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:34:24.923

您是否尝试过此代码来创建选项菜单？

```
 //Menu options within the app.
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    } 
```

# three.js - loader.load 崩溃

> ID：13689273
> 
> 赞同：2
> 
> 时间：2012-12-03T18:17:29.927
> 
> 标签：three.js

我无法让 loader.load 工作！我这样称呼它：

```
// loader
var loader = new THREE.JSONLoader(),

callbackModel   = function( geometry ) { 
  createScene( geometry,  90, FLOOR, -50, 105 ) 
}

loader.load(  'oakley/step3.js', callbackModel  ); 
```

我要么得到

```
Object # < Object > does not have a definition for 'split', (uncaught TypeError) 
```

最近，在更改为 Firefox 后，我得到了

```
TypeError: zmesh is undefined.
step3.js:1 is malformed (haven't touched it) 
```

和

```
TypeError: a is undefined in three.min.js:347 
```

和

```
TypeError: ma is undefined in three.min.js:429. 
```

我一直在关注教程。事实上多个。尽管如此，我无法让它工作..

# html - nicEdit 的 iframe 版本无法在 IE8 和 IE9 上运行

> ID：13689278
> 
> 赞同：1
> 
> 时间：2012-12-03T18:17:59.060
> 
> 标签：html, internet-explorer, iframe, nicedit

我真的需要适用于 IE8 和 IE9 的 nicEdit 的 iframe 版本。但问题是，对于 IE8，编辑器是不可编辑的，对于 IE9，它说 addEvent() 没有为元素定义。

请帮忙！

# flash - Apache 缓存控制 max-age 不能被覆盖

> ID：13689284
> 
> 赞同：2
> 
> 时间：2012-12-03T18:18:43.647
> 
> 标签：flash, apache, apache2, streaming, cache-control

我正在尝试在 Apache 2.2 上设置缓存控制属性，以便连接的客户端不会缓存任何内容。我在 httpd.conf 文件中添加了各种 Header 属性，但是这些属性不会覆盖默认的 max-age 和 expires 标头。这些是我在 httpd.conf 中为 Header 属性设置的值：

```
 Header set Expires "Thu, 01 Dec 2003 16:00:00 GMT"
   Header set Cache-Control "no-store, no-cache, must-revalidate"
   Header set Pragma "no-cache" 
```

生成的标题是：

```
HTTP/1.1 200 OK
Date: Mon, 03 Dec 2012 18:06:35 GMT
Server: Apache/2.2.21 (Win32) DAV/2
Cache-Control: max-age=86400, no-store, no-cache, must-revalidate
Expires: Tue, 04 Dec 2012 18:06:36 GMT, Thu, 01 Dec 2003 16:00:00 GMT
Content-Length: 548113
Last-Modified: Fri, 14 Sep 2012 22:08:04 GMT
Vary: Accept-Encoding
Pragma: no-cache
Keep-Alive: timeout=15, max=98
Connection: Keep-Alive
Content-Type: video/f4f 
```

所以缓存控制头仍然发送“max-age=86400”，并附加其余的属性。我怎样才能完全覆盖这个值？我还尝试使用 mod_expires 模块，这是我对 httpd.conf 所做的编辑，但它似乎没有做任何事情：

```
<IfModule mod_expires>
    ExpiresActive On
    ExpiresDefault 0
</IfModule> 
```

那么那里的任何人都可以告诉我如何完全覆盖 Apache 的缓存控制并为每个请求过期标头吗？我们在 Windows 上为 Flash 媒体流服务器运行 Apache 2.2。我想覆盖evertything，因为服务器根据连接到它的客户端发送许多深奥的格式。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:21:05.537

在这里试试这个：

```
Header unset Expires
Header set Expires "Thu, 01 Dec 2003 16:00:00 GMT" 
```

我在某处读到最好先删除旧标题。所以[`unset`](http://httpd.apache.org/docs/2.4/mod/mod_headers.html#header)规则会这样做。

如果这不起作用，请尝试[mod expires](http://httpd.apache.org/docs/2.4/mod/mod_expires.html)：

```
ExpiresActive On
ExpiresByType video/f4f "access minus 9 years" 
```

# php - Magento 类别平面表

> ID：13689285
> 
> 赞同：0
> 
> 时间：2012-12-03T18:18:44.380
> 
> 标签：php, magento

我在类别实体中添加了很多自定义属性，现在当我尝试重新索引时出现错误

```
SQLSTATE[42000]: Syntax error or access violation: 1118 Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535\. You have to change some columns to TEXT or BLOBs 
```

我知道这意味着平面表太大，而且确实有很多列。我不需要该表中的自定义属性，因此我可以删除它们，但我该怎么做呢？我发现如果我将 filterable 和可比性设置为 false 他们不应该在平面表中。任何帮助将不胜感激

```
public function getDefaultEntities()
{
    return array(
        'catalog_category' => array(
            'entity_model'      => 'catalog/category',
            'attribute_model'   => 'catalog/resource_eav_attribute',
            'additional_attribute_table' => 'catalog/eav_attribute',
            'entity_attribute_collection' => 'catalog/category_attribute_collection',
            'table'             => 'catalog/category',
            'attributes'        => array(
                'cat_type' => array(
                    'group'             => 'General',
                    'label'             => 'Category Type',
                    'type'              => 'int',
                    'input'             => 'select',
                    'default'           => '0',
                    'class'             => '',
                    'backend'           => '',
                    'frontend'          => '',
                    'source'            => 'eav/entity_attribute_source_cattype',
                    'global'            => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_STORE,
                    'visible'           => true,
                    'required'          => false,
                    'user_defined'      => false,
                    'searchable'        => false,
                    'filterable'        => false,
                    'comparable'        => false,
                    'visible_on_front'  => false,
                    'visible_in_advanced_search' => false,
                    'unique'            => false
                ), 
```

编辑：

我已经删除了属性并且它可以工作，然后我再次运行安装脚本，所有这些都将可过滤和可比较设置为 false，就像我在下面发布的示例一样，它再次向我显示错误，我错过了什么？

编辑：

我检查了平面类别表，我看到所有属性都添加了它们。那么可过滤和可比较仅适用于产品属性？我认为它们对于类别产品将是相同的值。

无论如何要从该表中排除我的属性吗？我可以排除他们修改创建表的文件，显然是在我的本地文件夹中，但我想知道哪种方法是干净的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:04:29.667

检查 eav_attribute 表和名为 used_in_product_listing 的列将其设置为 0 或 false，并且不应将其添加到类别产品平面表中。

# java - java-将列表迭代器重置为列表的第一个元素

> ID：13689288
> 
> 赞同：46
> 
> 时间：2012-12-03T18:19:01.973
> 
> 标签：java, iterator

我需要知道如何将 LinkedList 迭代器“重置”为其第一个元素。

例如：

`LinkedList<String> list;`

`Iterator iter=list.listIterator;`

`iter.next();`

`iter.next();`

一遍又一遍，在迭代器的多次移动之后，我需要“重置”迭代器的位置。`

我想问我如何将我的迭代器“重置”到第一个元素

我知道我可以通过这种方式获取第一个元素的列表迭代器：

`iter= list.listIterator(1);`

这是最好的解决方案吗？或者我错过了 Oracle 文档中的某些内容？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-03T18:20:52.000

您可以再次调用`listIterator`方法以获取指向列表开头的迭代器实例：

```
iter = list.listIterator(); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-03T18:23:44.393

最好根本不使用`LinkedList`，通常它在所有学科中都比较慢，而且不太方便。（主要在前面插入/删除时，尤其是大数组LinkedList更快）

使用`ArrayList`, 并迭代

```
int len = list.size();
for (int i = 0; i < len; i++) {
  Element ele = list.get(i);
} 
```

重置是微不足道的，只需再次循环。
如果您坚持使用迭代器，那么您必须使用新的迭代器：

```
iter = list.listIterator(); 
```

（我一生中只看到过一次 LinkedList 的优势：我可以通过 while 循环循环并删除第一个元素）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-02-28T02:46:26.330

这是一种替代解决方案，但有人可能会争辩说它没有增加足够的价值使其值得：

```
import com.google.common.collect.Iterables;
...
Iterator<String> iter = Iterables.cycle(list).iterator();
if(iter.hasNext()) {
    str = iter.next();
} 
```

如果它是结尾，则调用 hasNext() 会将迭代器光标重置到开头。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-16T09:55:15.683

如果顺序无关紧要，我们可以使用and方法使用相同的迭代器重新**向后迭代：**`hasPrevious()``previous()`

```
ListIterator<T> lit = myList.listIterator(); // create just one iterator 
```

最初迭代器位于开头，我们进行*前向*迭代：

```
while (lit.hasNext()) process(lit.next()); // begin -> end 
```

然后迭代器位于最后，我们可以进行**反向**迭代：

```
while (lit.hasPrevious()) process2(lit.previous()); // end -> begin 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-07-02T12:03:08.573

您可能真正想要使用的是一个`Iterable`可以`Iterator`通过调用`iterator()`.

```
//A function that needs to iterate multiple times can be given one Iterable:
public void func(Iterable<Type> ible) {
    Iterator<Type> it = ible.iterator(); //Gets an iterator
    while (it.hasNext()) {
        it.next();
    }
    it = ible.iterator(); //Gets a NEW iterator, also from the beginning
    while (it.hasNext()) {
        it.next();
    }
} 
```

您必须事先定义该`iterator()`方法的作用一次：

```
void main() {
    LinkedList<String> list; //This could be any type of object that has an iterator
    //Define an Iterable that knows how to retrieve a fresh iterator
    Iterable<Type> ible = new Iterable<Type>() {
        @Override
        public Iterator<Type> iterator() {
            return list.listIterator(); //Define how to get a fresh iterator from any object
        }
    };
    //Now with a single instance of an Iterable,
    func(ible); //you can iterate through it multiple times.
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-12-30T08:23:35.277

调用`iterator()`Collection impl，可能会在每次调用时获得一个新的 Iterator。

因此，您只需`iterator()`再次调用即可获得新的。

* * *

## 代码

**迭代器学习.java**

```
import org.testng.Assert;
import org.testng.annotations.Test;

import java.util.Collection;
import java.util.HashSet;
import java.util.Iterator;

/**
 * Iterator learn.
 *
 * @author eric
 * @date 12/30/18 4:03 PM
 */
public class IteratorLearn {
    @Test
    public void test() {
        Collection<Integer> c = new HashSet<>();
        for (int i = 0; i < 10; i++) {
            c.add(i);
        }

        Iterator it;

        // iterate,
        it = c.iterator();
        System.out.println("\niterate:");
        while (it.hasNext()) {
            System.out.printf("\t%d\n", it.next());
        }
        Assert.assertFalse(it.hasNext());

        // consume,
        it = c.iterator();
        System.out.println("\nconsume elements:");
        it.forEachRemaining(ele -> System.out.printf("\t%d\n", ele));
        Assert.assertFalse(it.hasNext());
    }
} 
```

**输出：**

```
iterate:
    0
    1
    2
    3
    4
    5
    6
    7
    8
    9

consume elements:
    0
    1
    2
    3
    4
    5
    6
    7
    8
    9 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-27T00:15:04.687

您可以做的是，使用 while 循环手动将迭代器设置为第一个位置。

```
while(iter.hasPrevious())
{
    iter.previous();
} 
```

当您退出循环时，您的迭代器将位于位置 0

###### 对不起任何语法错误

# c# - 为什么这个正则表达式模式不匹配这个文本？（简单的正则表达式只包括中间带有通配符的转义文本）

> ID：13689290
> 
> 赞同：2
> 
> 时间：2012-12-03T18:19:05.307
> 
> 标签：c#, regex, visual-studio-2010, assertions, nunit-2.5

抱歉，如果这是重复的；我保证我确实搜索过。

我正在使用 Visual Studio 2010 Professional 中的 NUnit 进行 C# 集成测试项目，并使用 Resharper v6.1 运行测试。（Resharper 6.1 规定我使用 NUnit 2.5.10；我一直无法尝试覆盖它。）

我的部分测试是断言正确的异常被抛出，包括异常消息。但是，有时异常消息包含我不希望每次都完全相同的 guid 或其他信息。为了解决这个问题，我想使用包含异常消息的基本正则表达式模式匹配异常消息，并简单地使用通配符在某些地方说“这部分可以匹配任何东西”我试图在下面的场景，但每次我得到一个没有匹配的错误。代码摘要：

```
[Test]
public void ExceptionPatternTest()
{
var patternA = Regex.Escape(@"SQL Code: 2601 Message: Cannot insert duplicate key row in object 'dbo.ResourceCategory' with unique index 'IDX_ResourceTypeResourceCategoryName'.");
var patternB = ".*";  //wildcard
var patternC = Regex.Escape(@"\r\nThe statement has been terminated.");    
var pattern = patternA + patternB + patternC;

var thrownException = Assert.Throws(Is.TypeOf(_testException.GetType()),
               () => Throw()); //Call method and assert that exception is thrown.

Assert.That(Regex.IsMatch(thrownException.Message, pattern));
}

private void Throw()
{
    throw _testException;
}

readonly Exception _testException = new Exception("SQL Code: 2601 Message: Cannot insert duplicate key row in object 'dbo.ResourceCategory' with unique index 'IDX_ResourceTypeResourceCategoryName'. The duplicate key value is (9fec90c1-12b4-42c3-adc0-a0d600b9a8e8, 1, Item Cat 1).\r\nThe statement has been terminated."); 
```

我也尝试了这部分的变化。包括为模式手动转义字符：

```
var pattern = @"SQL\ Code:\ 2601\ Message:\ Cannot\ insert\ duplicate\ key\ row\ in\ object\ 'dbo\.ResourceCategory'\ with\ unique\ index\ 'IDX_ResourceTypeResourceCategoryName'\..*\\r\\nThe\ statement\ has\ been\ terminated\."; 
```

而且我也尝试过 StringAssert ，以防有区别：

```
StringAssert.IsMatch(pattern, thrownException.Message); 
```

在此先感谢您的帮助！另外，如果我只是错过了一些非常愚蠢的东西，我深表歉意。我只很少使用正则表达式，所以这当然是可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:37:22.780

`Regex.Escape(@"\r\n")`会产生`\\r\\n`，这不是你想要的。我建议将换行符移至未转义的字符串：

```
var patternB = @".*\r\n";
var patternC = Regex.Escape(@"The statement has been terminated."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:42:35.817

当您可以使用`string.StartsWith`and`string.EndsWith`来检查前缀和后缀时，为什么还要使用复杂的正则表达式？更少的代码，更容易阅读，并且不会为试图找出为什么看似简单的事情不能正常工作而烦恼。

# javascript - 循环遍历元素的脚本在 Chrome 中不起作用

> ID：13689293
> 
> 赞同：0
> 
> 时间：2012-12-03T18:19:20.543
> 
> 标签：javascript, google-chrome

该代码操作一个表格以显示彼此相邻的软件功能（以便人们可以比较它们）。当有人单击特定软件图标时，它将在表格中显示或隐藏该软件的功能。

下面的代码在 IE9 中完美运行，但`features.querySelectorAll`在 Chrome 中没有填充标题/列。

`element.querySelectorAll`在 Chrome 中不起作用？

```
function viewfeature(feature) {
    var features = document.querySelector('#birdseye');
    var headers = features.querySelectorAll('th');
    var columns = features.querySelectorAll('td');
    if (feature.getAttribute("class") == 'selected') {
        feature.setAttribute("class", 'unselected');
        for (var i = 0; i < headers.length; i++) {
            if (headers[i].value == feature.id) {
                headers[i].style.display = 'none';
            }
        }
        for (var i = 0; i < columns.length; i++) {
            if (columns[i].value == feature.id) {
                columns[i].style.display = 'none';
            }
        }
    } else {
        feature.setAttribute("class", "selected");
        for (var i = 0; i < headers.length; i++) {
            if (headers[i].value == feature.id) {
                headers[i].style.display = 'block';
            }
        }
        for (var i = 0; i < columns.length; i++) {
            if (columns[i].value == feature.id) {
                columns[i].style.display = 'block';
            }
        }
    }
} 
```

* * *

```
<table class="apps">
    <tr>
        <td id="npg206" class="selected" onclick="viewfeature(this);"><img src="images/app-npg206.png" title="NamePrint Graphics 2.06"/></td>
        <td id="npg2061" class="selected" onclick="viewfeature(this);"><img src="images/app-npg2061.png" title="NamePrint Graphics 2.061"/></td>
        <td id="npg30" class="selected" onclick="viewfeature(this);"><img src="images/app-npg30.png" title="NamePrint Graphics 3.0"/></td>
        <td id="npgo" class="selected" onclick="viewfeature(this);"><img src="images/app-npo.png" title="NPG Online"/></td>
        <td id="npgw" class="selected" onclick="viewfeature(this);"><img src="images/app-npw.png" title="NPG Web"/></td>
        <td id="npgj" class="selected" onclick="viewfeature(this);"><img src="images/app-npj.png" title="NPG Java"/></td>
        <td id="enpg" class="selected" onclick="viewfeature(this);"><img src="images/app-enp.png" title="E-store NPG"/></td>
        <td id="tagw" class="selected" onclick="viewfeature(this);"><img src="images/app-tag.png" title="Tagware"/></td>
        <td id="word" class="selected" onclick="viewfeature(this);"><img src="images/app-word.png" title="Word Templates"/></td>
    </tr>
</table>
<table class="birdseyeview" id="birdseye">
    <tr>
        <th class="subcat">Restrictions</th>
        <th value="npg206">NPG 2.06</th>
        <th value="npg2061">NPG 2.061</th>
        <th value="npg30">NPG 3.0</th>
        <th value="npgo">NPG Online</th>
        <th value="npgj">NPG Java</th>
        <th value="npgw">NPG Web</th>
        <th value="enpg">E-NPG</th>
        <th value="tagw">TagWare</th>
        <th value="word">Word</th>
    </tr>
    <tr>
        <td>Administrator rights<span>Example:<br/><img src="images\admin.png" alt="Administrative Rights"/></span></td>
        <td value="npg206" class="green"></td>
        <td value="npg2061" class="green"></td>
        <td value="npg30" class="green"></td>
        <td value="npgo" class="green"><span>If Silverlight isn't installed</span></td>
        <td value="npgj"></td>
        <td value="npgw"></td>
        <td value="enpg"></td>
        <td value="tagw" class="green"></td>
        <td value="word"></td>
    </tr>
    <tr>
        <td>Internet access</td>
        <td value="npg206"></td>
        <td value="npg2061"></td>
        <td value="npg30"></td>
        <td value="npgo" class="green"></td>
        <td value="npgj"></td>
        <td value="npgw" class="green"></td>
        <td value="enpg" class="green"></td>
        <td value="tagw"></td>
        <td value="word"></td>
    </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:34:48.277

这就是问题所在。这是你正在做`.value`的而不是`.getAttribute("value")`在一个`th`元素上。

```
//if (headers[i].value == feature.id) { // Won't work in Chrome

if (headers[i].getAttribute("value") == feature.id) { 
```

IE 会将属性映射`.value`到`value="..."`属性，但 Chrome 不会*正确地*执行此操作。一个`th`元素没有原生`.value`属性，所以不应该有这样的映射。

* * *

您最好使用 HTML5`data-`属性来实现前向兼容性。

```
<th data-value="npg206">NPG 2.06</th> 
```

然后在旧浏览器中：

```
headers[i].getAttribute("data-value") 
```

或者在 HTML5 浏览器中，您可以执行以下操作：

```
headers[i].data.value 
```

# android - Android 应用程序在数据库连接尝试时强制关闭

> ID：13689294
> 
> 赞同：0
> 
> 时间：2012-12-03T18:19:23.900
> 
> 标签：android, database, android-sqlite

我正在尝试与我的应用程序建立数据库连接。它有一个访问者的允许和拒绝按钮。每当我尝试调用数据库类的操作时，我的应用程序强制关闭。例如，当我单击允许按钮时，我希望应用程序将访问者 ID、日期和字符串响应存储在数据库中。以下是我为按钮设置的 mainActivity 中的代码：

```
//databaseVisitor VisDB = new databaseVisitor (this);
//VisitorDatabase VDB = new VisitorDatabase();
//Defining the actions of the Allow Button

Button.OnClickListener allowListener = new Button.OnClickListener(){
    public void onClick(View arg0) {
        // TODO Auto-generated method stub

        Toast allowToast = Toast.makeText(MainActivity.this, R.string.toastYes, Toast.LENGTH_LONG);
        allowToast.show();

        //Log.d("Insert Log: ", "Inserting add log..");
        //count = VisDB.getVisitorCount();
        response = "Access Granted";
        //dt = date.getDate();

        //VisDB.addVisitor(new VisitorDatabase(count+1, dt, response));

    }   
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:25:39.790

很可能是因为您正在关闭光标

```
cursor.close() 
```

然后对其进行操作

```
return cursor.getCount() 
```

像这样试试

```
int count = cursor.getCount();
cursor.close();
return count; 
```

编辑 ：

至于 VisDB 那样做

```
...
databaseVisitor VisDB;
...
public void onCreate(Bundle savedInstanceState) {
      ...
      VisDB = new databaseVisitor (this);
      ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:28:49.940

你在给 getCount() 之前关闭了游标。试试这个：

```
int count = cursor.getCount();
cursor.close();
return count; 
```

祝你好运！

# iphone - 日志上的奇怪消息

> ID：13689309
> 
> 赞同：1
> 
> 时间：2012-12-03T18:20:49.753
> 
> 标签：iphone, ios, ipad, icloud

我在从 iCloud 保存/检索键/值时遇到问题。我的问题本质上是将密钥保存到 iCloud 并在尝试使用另一台设备读取相同的密钥时检索 nil。

调查这个问题，我在设备控制台上找到了这个。

```
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: Dec  3 18:11:16  SecTrustEvaluate  [leaf CriticalExtensions IssuerCommonName]
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-container-identifiers' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-kvstore-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-container-identifiers' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-kvstore-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'keychain-access-groups' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-container-identifiers' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-kvstore-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-container-identifiers' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'com.apple.developer.ubiquity-kvstore-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'aps-environment' has value not permitted by a provisioning profile
Dec  3 18:11:16 iPhone-4S amfid[641] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile 
```

我已删除所有配置文件并重新创建它们，将它们从 Xcode 中删除并重新安装，重新启动设备，但错误仍然存​​在。

这是我的权利文件内容（该文件由 Xcode 自动创建）

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>com.apple.developer.ubiquity-container-identifiers</key>
    <array>
        <string>$(TeamIdentifierPrefix)com.myCompany.myApp</string>
    </array>
    <key>com.apple.developer.ubiquity-kvstore-identifier</key>
    <string>$(TeamIdentifierPrefix)com.myCompany.myApp</string>
    <key>keychain-access-groups</key>
    <array>
        <string>$(AppIdentifierPrefix)com.myCompany.myApp</string>
    </array>
</dict>
</plist> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T13:07:47.787

最后！我找到[了这个解决方案](http://www.cocos2d-iphone.org/forum/topic/68488#post-224423)，它有效！！！！此问题的解决方案是从您正在测试应用程序的所有设备中删除所有 iCloud 帐户并重新创建它们！

# scala - 在 Scala 中表达正方形

> ID：13689314
> 
> 赞同：12
> 
> 时间：2012-12-03T18:21:00.653
> 
> 标签：scala

出于某种原因（这让我无法理解），Scala`math`库没有`pow`用于整数的 -function，而仅用于`Double`s。

我需要一个整数的平方函数，并且正在计算在 Scala 中执行此操作的常用方法。

```
object TestX extends App {

  def pow2(v: Int)= v*v

  //class MyRichInt( val v: Int ) {
  //  def ² : Int = v*v      // says: "illegal character" for UTF-8 power-of-two
  //}

  println( pow2(42) )
  //println( 42² )
  println( math.pow(42,2).toInt )
} 
```

我很惊讶地发现 Scala 不喜欢 '²' 字符。也许它被认为是一个数字？通常，各种奇怪的 Unicode 值都是有效的，在代码中使用 42² 确实会很漂亮。

没关系。我应该闭嘴并开始使用我自己的`pow2`功能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-03T18:25:09.400

是的，使用你自己的`pow2`. 如果你需要更高的权力，你可能`Int`无论如何都没有空间。考虑使用`BigInt.pow`：

```
scala> BigInt(40).pow(40)
res0: scala.math.BigInt = 12089258196146291747061760000000000000000000000000000000000000000 
```

当然，如果您不需要 N ²而是 2 ^N，只需使用班次即可。( `1 << k`= 2 ^k ) 这些`BigInt`也适用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-03T19:18:37.587

对 Unicode 字符使用反引号，并使用隐式类 (Scala 2.10) 来添加对任意类型的操作：

```
implicit class PowerInt(i: Int) {
  def `²`: Int = i * i
} 
```

用法：

```
3 `²` 
```

结果：

```
9 
```

# visual-studio-2010 - visual basic 2010 复制粘贴子程序

> ID：13689318
> 
> 赞同：1
> 
> 时间：2012-12-03T18:21:07.513
> 
> 标签：visual-studio-2010

我正在尝试在 VB 2010 中编写 2 个简单的子例程，这些子例程可以与工具条按钮控件一起用于表单中的多个文本框。我知道可以使用 textbox1.Copy() 和 TextBox1.Paste() 方法完成简单的复制粘贴。我想做的是编写一个通用子例程，它可以用于表单中的任何文本框，而不仅仅是一个特定的文本框。我的代码如下，我知道其中有错误，只是想知道它是如何实现的。任何帮助将不胜感激。谢谢。

```
Public Class Form1
 Private Sub copytext()
    Dim txt As Control
    If TypeOf txt Is TextBox Then
        Clipboard.Clear()
        Clipboard.SetText(txt.SelectedText)
    End If
End Sub
Private Sub pastetext()
    Dim txt As Control
    If TypeOf txt Is TextBox Then
        txt.Text = Clipboard.GetText
    End If

End Sub

Private Sub mnuCopy_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mnuCopy.Click
    Call copytext()
End Sub

Private Sub mnuPaste_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mnuPaste.Click
    Call pastetext()
End Sub
End Class 
```

# android - 在 GridView 单元格上画一条线 - Android

> ID：13689322
> 
> 赞同：1
> 
> 时间：2012-12-03T18:21:26.783
> 
> 标签：android, android-layout

```
package com.hh.LetterGame;

import android.app.Activity;
import android.graphics.Canvas;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.GridView;
import android.widget.Toast;

public class MainActivity extends Activity {

    //This is what is first displayed when the person opens the app:
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //Displays the letters on the board.
            GridView gridview = (GridView) findViewById(R.id.letters);
        gridview.setAdapter(new letterImageAdapter(this));

        //Controls what is displayed when the user clicks on the letter.
        gridview.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
                Toast.makeText(MainActivity.this, "" + position, Toast.LENGTH_SHORT).show();

            }
        });

        //Displays the header, including players and word selected.
        //NOT FINISHED: Needs to show player pictures and also the word the player is making.
        GridView header = (GridView) findViewById(R.id.header);

    }

    //Draw lines between the letters.

    //Menu options within the app.
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

**到目前为止，这就是我的代码。为了在单元格（此时包含图像）上画一条线，我想我知道我需要使用 Paint 或 Path（哪一个？）。在其中，我将声明起点是什么，然后当用户触摸屏幕的另一部分时，这将是第二个点。欢迎任何建议。我对此非常非常陌生，因此非常感谢您提供任何帮助。谢谢你。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:47:58.413

您可以覆盖`onDraw()`在视图中执行自定义绘图的方法。在这里您可以找到更多信息的[链接](https://stackoverflow.com/questions/4355569/subclassing-view-and-ondraw)。

# javascript - 检测新打开的窗口是否已完全加载并附加内容

> ID：13689323
> 
> 赞同：0
> 
> 时间：2012-12-03T18:21:34.930
> 
> 标签：javascript, html

> **可能重复：**
> [Jquery：如何检查新打开的窗口是否已完全加载？/window 加载外部页面（如 www.yahoo.com）](https://stackoverflow.com/questions/7209745/jquery-how-to-check-if-a-newly-opened-window-has-been-fully-loaded-window-l)

所以我有这个功能，它需要一些html代码，它会打开一个新窗口并将代码放在窗口中，然后提示打印功能。但是，有时，打印 css 没有被加载，并且打印没有构建正确的页面。有什么方法可以查看新打开的窗口是否已经加载了所有内容？

```
function printer(el)
    {
        print_window= window.open();

        var print_css = '<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />'; 

        print_css = print_css + '<link rel="stylesheet" href="css/main.css" type="text/css" />';
        print_css = print_css + '<link rel="stylesheet" href="css/print.css" type="text/css" media="print" />';

        print_window.document.write("<html><head>" + print_css + "</head><body>" + "<div class='contents'>" + el + "</div>" + "</body> </html>");
        print_window.document.close();
        print_window.focus();
        print_window.print();
        print_window.close();

    } 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:27:06.087

这可能会有所帮助——使用`window.onload`事件处理程序：

```
print_window.document.close();
print_window.onload = function() {
    print_window.focus();
    print_window.print();
    print_window.close();
}; 
```

像往常一样`window.onload`，在所有链接的图像、脚本和样式表都加载并准备好之前，该事件不会触发。

[http://jsfiddle.net/mblase75/3BEkV/](http://jsfiddle.net/mblase75/3BEkV/)

# maven - Cobertura 无法识别测试

> ID：13689329
> 
> 赞同：0
> 
> 时间：2012-12-03T18:21:53.683
> 
> 标签：maven, cobertura

我添加了依赖项，但由于某种原因，Cobertura 决定不从`src/test/`. 它只是从中加载类`src/java/`，因此不显示代码覆盖率或任何内容。我检查了包（所有类、测试都在同一个包中）和依赖项。任何帮助，指针？

这是我在配置下的 cobertura 依赖插件`maven-shade`：

```
<cobertura.version>2.5.2</cobertura.version>

<plugin>
   <groupId>org.codehaus.mojo</groupId>
   <artifactId>cobertura-maven-plugin</artifactId>
   <version>${cobertura.version}</version>
</plugin> 
```

我在`maven-site`插件下也有同样的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T15:22:19.130

除非您覆盖了默认的 Maven 配置，否则您的结构未经过 Maven 化。它应该是 src/ *main* /java 和 src/test/java。

还要检查您是否遵循了surefire插件（运行测试的插件）约定（例如*Test.java）或已覆盖配置，请参阅所有接受的默认模式的[surefire包含排除](http://maven.apache.org/plugins/maven-surefire-plugin/examples/inclusion-exclusion.html)。

验证 mvn clean test 是否已运行您的测试，即在输出中查找“Tests run: 52, Failures: 0, Errors: 1, Skipped: 0”。

验证 mvn cobertura:cobertura 是否也运行您的测试并在 /target/site/cobertura/ 中生成一个 index.html（打开此文件以确保它包含您的所有类）。还要检查 /target/cobertura/cobertura.ser 是否存在。

# android - 在设定的时间从睡眠中唤醒应用程序

> ID：13689330
> 
> 赞同：2
> 
> 时间：2012-12-03T18:21:58.163
> 
> 标签：android

我想让我的应用程序进入睡眠状态，然后在设定的时间唤醒它。我让它睡觉，但没有醒来。

这将设置唤醒锁：

```
private void setWakeLock(){
    System.out.println("wakelock");
    PowerManager pm = (PowerManager)context.getSystemService(Context.POWER_SERVICE);
    wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK |
            PowerManager.ACQUIRE_CAUSES_WAKEUP
            | PowerManager.ON_AFTER_RELEASE, "DoNotDimScreen");
    wl.acquire();
} 
```

这会设置唤醒/睡眠时间的警报：

```
private void setWakeSleep(){
    java.util.Calendar c = java.util.Calendar.getInstance();
    c.set(java.util.Calendar.HOUR_OF_DAY, 17);
    c.set(java.util.Calendar.MINUTE, 53);
    c.set(java.util.Calendar.MILLISECOND, 0);
    Intent sleepIntent = new Intent("SLEEP_INTENT");
    PendingIntent sleepPendingIntent = PendingIntent.getBroadcast(this, 0, sleepIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
    alarmManager.set(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), sleepPendingIntent);

    c.set(java.util.Calendar.HOUR_OF_DAY, 18);
    c.set(java.util.Calendar.MINUTE, 14);
    c.set(java.util.Calendar.MILLISECOND, 0);
    Intent wakeIntent = new Intent("WAKE_INTENT");
    PendingIntent wakePendingIntent = PendingIntent.getBroadcast(this, 0, wakeIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    AlarmManager alarmManager2 = (AlarmManager) getSystemService(ALARM_SERVICE);
    alarmManager2.set(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), wakePendingIntent);
} 
```

这是广播接收器：

```
private BroadcastReceiver receiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        Time updateHour = new Time();
        updateHour.set(System.currentTimeMillis());         
        if (intent.getAction().equals("SLEEP_INTENT")) {
            System.out.println("sleep");
            wl.release();
        }
        if (intent.getAction().equals("WAKE_INTENT")) {         
            wl.acquire();
            System.out.println("wake");
            //initialise();
        }
    }
}; 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T19:11:42.833

首先，您不想要唤醒锁；这些是为了防止设备进入睡眠状态，这是高度反社会的，除非你的应用真的需要它（它会耗尽电池）。

其次，如果您在 18:14 之后调用设置唤醒时间的代码将失败，因为您现在将定义过去的时间。让我们暂时忽略它。

接下来，您的意图操作应该类似于“org.user1797190.WAKE_INTENT”，而不仅仅是可能导致冲突的“WAKE_INTENT”。如果您希望公开此意图，请考虑在[http://openintents.org](http://openintents.org)进行注册。不过，这也不是你的问题。

您不需要alarmManager2——系统中只有一个警报管理器，所以只需重新使用第一个。

我从来没有听说过让应用程序本身进入“睡眠”状态。您的意思是您希望该应用程序消失，然后稍后再回来？

这就是我要做的。完全忘记“SLEEP_INTENT”。只需安排一个“WAKE_INTENT”，然后调用finish()。您的应用程序将简单地离开屏幕。

我会完全忘记广播接收器。相反，我会使用 getActivity() 而不是 getBroadcast() 来获取将重新启动活动的待处理意图。修改您的清单，以便您的 WAKE_INTENT 将进入活动。此外，您应该将“android:launchMode”属性设置为“singleTask”，这样就不会创建活动的多个实例。`onNewIntent()`如果您的活动在到达时已经在运行，您还需要实施以处理唤醒意图。

最后，如果您的活动是创建意图的同一应用程序的一部分，则根本不需要命名意图；您可以按类创建它们。不过，您需要另一种方法让接收者知道这是一个唤醒意图。

所以，把它们放在一起：

您的清单应包含：

```
<activity android:name=".TestActivity" android:launchMode="singleTask">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

您的代码应包含：

```
/**
 * Arrange for the activity to return at a specific time.
 * Call finish() after calling this method().
 * This function can be called from anywhere that has a valid Context.
 */
public static void scheduleWakeup(Context ctx, long timeMillis) {
    if (DEBUG) Log.d(TAG, "Scheduling wakeup for " + timeMillis);
    Intent intent = new Intent(ctx, TestActivity.class);
    intent.putExtra("wakeup", true);
    PendingIntent pi = PendingIntent.getActivity(ctx, 0, intent,
                          PendingIntent.FLAG_UPDATE_CURRENT);
    AlarmManager mgr = (AlarmManager) ctx.getSystemService(Context.ALARM_SERVICE);
    mgr.cancel(pi);    // Cancel any previously-scheduled wakeups
    mgr.set(AlarmManager.RTC_WAKEUP, timeMillis, pi);
}

...

protected void onCreate(Bundle state) {
    Intent intent = getIntent();
    if (intent.getBooleanExtra("wakeup", false)) {
        // We were woken up by the alarm manager
    }
    ...
}

protected void onNewIntent(Intent intent) {
    if (intent.getBooleanExtra("wakeup", false)) {
        // We were woken up by the alarm manager, but were already running
    }
} 
```

这与我在自己的应用程序中所做的非常接近，而且对我来说效果很好。

当然，您必须自己进行测试。Log.d() 是你的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:52:09.377

如上。问题是我在调用活动中使用了广播接收器。

# c++ - 如何更改“显示隐藏文件”设置？

> ID：13689331
> 
> 赞同：0
> 
> 时间：2012-12-03T18:22:01.270
> 
> 标签：c++, windows, hidden-files

如何在我的程序中启用或禁用“显示隐藏的填充和文件夹”和“显示系统隐藏的文件和文件夹”选项？（我并不是要更改文件属性是否隐藏 - 我需要更改 Windows 选项。）

如果它们不是 C++ 方法，是否可以通过更改注册表项或类似的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:56:44.740

```
SHELLSTATE ss;
ZeroMemory(&ss,sizeof(ss));
ss.fShowAllObjects=TRUE;
ss.fShowSysFiles=TRUE;
ss.fShowSuperHidden=TRUE;
SHGetSetSettings(&ss, SSF_SHOWALLOBJECTS|SSF_SHOWSYSFILES|SSF_SHOWSUPERHIDDEN,TRUE) 
```

# ruby - 使用 Mocha 提取类方法

> ID：13689336
> 
> 赞同：2
> 
> 时间：2012-12-03T18:22:20.063
> 
> 标签：ruby, rspec, ruby-mocha

我有一个我想用 rspec 和 Mocha 测试的方法。我的目标是存根`Dir.glob`，以便只返回一个文件的简单数组。该方法定义如下：

```
def my_method
  Dir.glob("#{upload_dir}/*.pdf").each do |file|
    ...
  end
end 
```

和测试：

```
it "ignores a file of no size" do
  zero_file = File.expand_path("../fixtures/zero_size_file_12345.pdf", __FILE__)
  Dir.expects(:glob).returns([zero_file])

  ...
end 
```

问题是该方法`upload_dir`不是我想在这里测试的东西，我假设如果我取消任何调用`Dir.glob`then`upload_dir`将永远不会被调用。`Dir.glob`如果我在调用和调用之前放入调试器`Dir.glob`，那么我会看到我的一个零文件数组，所以存根肯定是有效的。但是，当测试实际调用方法`Dir.glob("#{upload_dir}/*.pdf")`时，它会尝试调用`upload_dir`.

我正在使用 Ruby 1.9.3、rspec 2.12.0 和 mocha 0.13.0。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T18:30:55.833

它调用 upload_dir 是因为它必须构建要传递给 glob 的字符串。你可以通过添加类似的东西来存根它 -

[YourClass].expects(:upload_dir).returns("foo")

然后期望您的代码将“foo/*.pdf”传递给 glob。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T19:01:59.950

@Scott 的建议可能会奏效。所以+1他的回答。

但是，您应该考虑提取该行：

```
Dir.glob("#{upload_dir}/*.pdf") 
```

进入一种阐明意图的方法，例如`pdf_files_to_upload`。

然后，您可以在被测对象上存根该方法，以根据需要返回一个数组。然后，您将与 upload_dir 方法完全分离，无需关心 PDF 文件列表是如何生成的。将产生更具声明性的`my_method`结果！

HTH。

# algorithm - 输入为 O(n log n) 时算法的时间复杂度

> ID：13689338
> 
> 赞同：1
> 
> 时间：2012-12-03T18:22:25.010
> 
> 标签：algorithm, time-complexity

我有一个在 O(m) 时间内运行的算法。该算法接收一组包含 m 个条目的数据。

通过指定严格的正整数输入 n 随机生成数据。生成的条目数为 O(n log n)。

**编辑**

单独生成数据的时间复杂度与 n（或 O(1)）无关，这意味着给定整数 n，条目是立即随机生成的。结果条目的数量是随机的，但为 O(n log n)。例如 n = 10，则生成的条目数是某个常数乘以 10（log 10）。

数据是事先生成的。然后将得到的 m 个条目作为输入馈送到算法中。

**问题**

然后我可以假设算法在 O(n log n) 时间内运行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:26:31.440

您的问题中有一些模棱两可的地方，要么是故意放置以帮助您内化输入大小和运行时间复杂度之间的关系，要么是由于沟通不畅而导致的。

因此，尽我所能解释这种情况：

* * *

您的算法复杂度**与 m 成**`O(m)`线性关系。

 **因此，由于`We assume that generating the data is independent of input. i.e. O(1).`，您的时间复杂性仅取决于`n`您指定的生成条目的一些内容。

所以是的，你可以说算法`O(n log n)`及时运行，因为它对 size 的输入没有任何作用`m`。

* * *

**针对您更新的问题：**

仍然很难理解，因为一些关键词指的是不同的事物。但总的来说，我认为这就是你所得到的：

*   您有一个数据集作为输入，即大小为 O(n log n)，给定一些特定的 n。
*   该数据集仅用作输入，它要么是预先生成的，要么是使用在 O(1) 时间内运行的某个黑盒生成的，而不管黑盒的 n 是多少。（我们对这个问题的黑匣子不感兴趣）
*   然后将该数据集输入到我们真正感兴趣分析的算法中。
*   对于大小为 m 的输入，该算法的时间复杂度为 O(m)。
*   由于您的输入相对于 n 的大小为 O(n log n)，因此通过扩展，您的 O(m) 线性时间算法相对于 n 的时间复杂度为 O(n log n)。

要查看差异：假设您的算法不是线性的，而是二次 O(m^2)，那么它相对于 n 的时间复杂度为 O(n^2 log^2 n)。**

# macos - 10.6 的 NSOutlineView

> ID：13689342
> 
> 赞同：1
> 
> 时间：2012-12-03T18:22:45.267
> 
> 标签：macos, cocoa

我是可可的新手。我需要为 10.6 OS X 及更高版本实现一个 NSoutlineview。我有必须以大纲视图的形式显示的数据层次结构。大纲视图的单元格必须包含图像和文本。有人可以建议如何解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:46:58.130

大纲视图基本上只是一个表格视图，因此 NSTableView 的所有教程都适用于它， **只有 dataSource 方法不同**

所以： http: [//www.martinkahr.com/2007/05/04/nscell-image-and-text-sample/](http://www.martinkahr.com/2007/05/04/nscell-image-and-text-sample/)

并将其结合起来将是一个基于单元格的大纲的教程。例如[http://devcry.heiho.net/2012/02/treeview-in-cocoa-nsoutlineview.html](http://devcry.heiho.net/2012/02/treeview-in-cocoa-nsoutlineview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T04:19:36.750

为了您的最佳实践，您可以参考此示例代码 [Sourceview](https://developer.apple.com/library/mac/#samplecode/SourceView/Introduction/Intro.html#//apple_ref/doc/uid/DTS10004441)

要自定义文本，您需要将单元格设置为 ImageAndText 单元格，如该示例代码所示

# mysql - 如果特定的 meta_key 不存在，wordpress 自定义 mysql 查询仅获取帖子

> ID：13689344
> 
> 赞同：2
> 
> 时间：2012-12-03T18:22:49.330
> 
> 标签：mysql, sql, wordpress, categories

我正在尝试使用自定义查询获取 wp 帖子。这是sql查询：

```
SELECT p.*, IFNULL(SUM(vote), 0) AS vote_count, CAST(m.meta_value AS SIGNED) AS idea_count
FROM wp_posts p
INNER JOIN wp_term_relationships r ON p.ID=r.object_id
INNER JOIN wp_term_taxonomy t ON t.term_taxonomy_id=r.term_taxonomy_id AND t.taxonomy='category'
LEFT JOIN wp_wdpv_post_votes v ON v.post_id=p.ID
LEFT JOIN wp_postmeta m ON m.post_id=p.ID AND m.meta_key='ideas_count'
WHERE p.post_status='publish' AND p.post_type='post' AND t.term_id='5'
GROUP BY p.ID
ORDER BY p.ID DESC
LIMIT 0, 8 
```

这个 sql 查询工作正常。但现在我有另一种情况，我想在哪里显示使用此查询的帖子，但只显示没有特定元键的帖子。过滤的元键是

```
'private_spaces_post' 
```

这可能特定于 mysql 查询。但如果有人能给我解决这个问题，我将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:25:56.070

您可以`LEFT JOIN`针对只返回那些*确实*有的子查询`private_spaces_post`，并寻找`NULL`s

```
SELECT p.*, IFNULL(SUM(vote), 0) AS vote_count, CAST(m.meta_value AS SIGNED) AS idea_count
FROM wp_posts p
  INNER JOIN wp_term_relationships r ON p.ID=r.object_id
  INNER JOIN wp_term_taxonomy t ON t.term_taxonomy_id=r.term_taxonomy_id AND t.taxonomy='category'
  LEFT JOIN wp_wdpv_post_votes v ON v.post_id=p.ID
  LEFT JOIN wp_postmeta m ON m.post_id=p.ID AND m.meta_key='ideas_count'
  /* LEFT JOIN subquery returning only ids that *do* have the meta key */
  LEFT JOIN (
    SELECT post_id FROM wp_postmeta WHERE meta_key='private_spaces_post'
  ) psp ON p.ID = psp.post_id
WHERE p.post_status='publish' AND p.post_type='post' AND t.term_id='5'
  /* And find post ids from the main table that *don't* have a match in the subquery (LEFT JOIN returns NULL) */
  AND psp.post_id IS NULL
GROUP BY p.ID
ORDER BY p.ID DESC
LIMIT 0, 8 
```

# android - Android 谷歌地图 ClassNotFoundException

> ID：13689346
> 
> 赞同：5
> 
> 时间：2012-12-03T18:22:56.390
> 
> 标签：android, android-mapview, classnotfoundexception

我正在创建我的第一个谷歌地图应用程序，但我遇到了一些麻烦，我不知道为什么。我得到一个 ClassNotFoundException。一般来说，我是 Android 新手，但这个错误让我很困惑。这是我的清单。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="edu.purdue.cs.cs180.safewalk"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <uses-library android:name="com.google.android.maps" />
        <activity
            android:name=".RequestActivity"
            android:configChanges="orientation|keyboardHidden|screenSize"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

以下是我的布局如何使用 MapView。我知道我的 API 密钥是正确的。

```
 <com.google.android.maps.MapView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:apiKey="@string/mapskey" /> 
```

最后，这是来自 logcat 的错误。

```
 12-03 13:11:25.861: E/AndroidRuntime(940): Caused by: java.lang.ClassNotFoundException: Didn't find class "edu.purdue.cs.cs180.safewalk.RequestActivity" on path: /system/framework/com.google.android.maps.jar:/data/app/edu.purdue.cs.cs180.safewalk-2.apk 
```

编辑：对不起，清单没有完美复制。是的，包已经设置好了。我的虚拟设备设置为 Target: Google APIs (Google Inc.) - API Level 17。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:29:57.417

如果您尝试在模拟器中运行它，则需要定义您的 AVD，并将 Target 设置为`Google APIs (Google Inc) - ...`and not `Android nn - ...`。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T11:39:49.353

仅关闭项目并重新打开它。修理它。

奥兹

# database - Rails 3：将数据从一个数据库添加到另一个具有不同数据的相同数据库，避免 id 冲突

> ID：13689350
> 
> 赞同：0
> 
> 时间：2012-12-03T18:23:07.517
> 
> 标签：database, ruby-on-rails-3

假设我有两个具有相同架构但数据不同的数据库。如果我想将一个数据库数据导出到另一个数据库中怎么办？如果没有 id 冲突，这可以在没有太多不便的情况下完成。但是，不仅同一模型的成员之间会出现 id 冲突（比如第一个数据库中有一个 id 为 1 的用户，而在第二个数据库中有一个完全不同的用户具有相同的 id），而且当你已经得到引用 id 的外键列，这些列必须更改以避免冲突。

我想知道是否有任何快速而干净的方法可以做到这一点。谢谢

# r - 在 data.frame 中使用 If 条件

> ID：13689356
> 
> 赞同：0
> 
> 时间：2012-12-03T18:23:47.937
> 
> 标签：r, date, if-statement

另一个我无法解决的棘手问题。

我有两个数据框（“阳光”和“霜”）。一个是每年累积日照时数，另一个是冬季极端温度（12 月至 2 月）。我现在需要做的是，检查这些 data.frames 是否有 Frost。如果温度低于-19度，我们在这种情况下谈论霜冻。但是，如果一年中的日照时数超过 300 小时，我们就会谈到 - 21 度的霜冻。但是，另一个前提条件是，必须检查数据帧 Frost 中的年份是否为当前年末和次年年初（12 月至 2 月）。这意味着，如果 1962 年的日照时间超过 300 小时，我需要检查 1962 年 12 月到 1963 年 2 月的 Frost。这是 data.frames。

```
"Sunshine"

year       hours
1962       396
1963       290
1964       301

"Frost"

Date temperature
1962-12-26 -19.21
1963-01-13 -20.29
1963-01-17 -21.47
1964-01-31 -20.54 
```

现在我遇到的麻烦是如何将这些与数据框结合起来，以便它只向我显示满足条件的霜冻温度的日期。

在这种情况下，我们在 1962 年冬季没有发生霜冻事件，温度为 19,21°，因为全年日照时间超过 300 小时，触发温度为 -21°。1963 年 1 月我们发生了霜冻事件，因为 1962 年的日照时间超过了 300 小时，所以条件上升到 -21°。1964 年也有霜冻，因为 1963 年日照时间超过 300 小时。

```
1963-01-17 -21.47
1964-01-31 -20.54 
```

有没有人知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:06:15.453

接受贾斯汀的建议，并假设`Frost$Date`有类`Date`：

```
x <- Frost
x$year <- as.numeric(format(x$Date, "%Y"))
x <- merge(x, Sunshine)
x <- transform(x, threshold = ifelse(hours > 300, -21, -19))
subset(x, temperature < threshold)[,2:3]  # Noting that column 1 is year

#         Date temperature
#2 1963-01-13      -20.29
#3 1963-01-17      -21.47 
```

# twig - 在 Symfony2 中使用类似片段的视图

> ID：13689359
> 
> 赞同：0
> 
> 时间：2012-12-03T18:23:58.200
> 
> 标签：twig, symfony-2.1

我在数据库中有两个表。其中一个包含应用程序的用户，另一个以多对一的关系保存一些关于他们的医疗报告，因此每个用户可以在信息表中拥有随机数量的医疗报告。

我想在屏幕左侧显示用户名列表，这很简单。每次我点击其中一个人的名字时，我都会进入另一个显示医疗数据的页面，我必须返回再次获取用户列表。但是，我希望在同一个视图中显示此信息，因此每次单击左侧的名称时，我都会在右侧获取他或她的数据，当我单击另一个用户时，会显示前一个用户的信息消失并显示新的。我的意思是，我想要与旧的 HTML iframe 或新的 Android 4 片段类似的行为。

这在 Symfony2/Twig 中可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:33:23.543

Twig 只是一个模板引擎，它在服务器端进行解析并将原始 HTML/CSS/JS 返回给浏览器，你不能在 Twig 中编写与用户的交互。

Symfony 是一个服务器端框架，这意味着它在服务器端进行解析，并将原始 HTML/CSS/JS 返回到浏览器，您无法使用 Symfony 编写与用户的交互。

您需要使用客户端脚本语言，例如 JavaScript。您可以创建 AJAX 请求来解决您的问题。AJAX 请求一个 url 并在页面上显示该 url 的内容。由于 AJAX 是 JavaScript 中最不跨浏览器的东西之一，因此建议使用 MooTools 或 jQuery 之类的库。

我建议为 AJAX 请求创建一个 RESTful API。类似的东西`/users/{id}`应该显示用户信息。为此，创建一个显示用户数据的控制器并将其映射到`/users/{id}`路由：

```
<?php
// src/Acme/DemoBundle/Controller/UserController.php
namespace Acme\DemoBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;

class UserController extends Controller
{
    // ...

    /**
     * @Route("/users/{id}")
     */
    public function showAction($id)
    {
        // select user by id
        $user = ...;

        // renders the user data
        $this->render('AcmeDemoBundle:User:show.html.twig', array('user' => $user));
    }
} 
```

现在您创建一个对该 url 的 AJAX 请求以获取用户数据：

```
<ul> 
    <li><a class="js-show-user" data-id="1">Joren</a></li>
    <li><a class="js-show-user" data-id="2">Wouter</a></li>
    <!-- ... -->
</ul>
<div id="js-user-data"></div>

<!-- ... include jquery -->
<script>
jQuery(function($) {

    var output = $('#js-user-data');

    $('.js-show-user').click(function(e) {
        jQuery.ajax({
            url: '/users/' + $(this).data('id'), // request the correct url
            success: function (result) {
                output.html(result); // output the result
            },
        });
    });

});
</script> 
```

# iphone - 是否可以使用来自非 Apple 操作系统的兼容 LLVM IR/位码来定位 iPhone？

> ID：13689360
> 
> 赞同：2
> 
> 时间：2012-12-03T18:24:00.493
> 
> 标签：iphone, objective-c, gcc, llvm, clang

好的，撇开明显的打包和签名问题不谈，是否有可能通过使用来自非 Apple 操作系统（如 Linux 或 Windows）的正确构造的 LLVM 位码 (IR) 来编译 IOS/iPhone 兼容的可执行文件，即利用一些LLVM、Clang 或 GCC 等开源编译器基础架构的组合？

基本上，我正在考虑的是

1.  将预先存在的跨平台 SDK（IOS 兼容）编译为 LLVM 中间表示（IR/bitcode）。

2.  使用 LLVM 分析工具分析和识别该层内的 IOS 特定 LLVM (IR) 函数调用。

3.  在非 Apple 系统上将 SDK 编译为 LLVM IR 后，*替换*非 Mac 主机生成的相应 LLVM IR 函数调用中的 Apple/IOS-generated-LLVM-bitcode-SDK-representation。

4.  [可能] 使用 Mac 的 XCode/Clang/LLVM 基础设施发出的构建标志，以便在非 Apple 主机编译机（例如 Linux 或 Windows）上构建与 IOS 兼容的可执行文件。

如果这完全可行，我稍后将研究创建 iPhone/IOS 捆绑包（IPA 的构造已记录，请询问 Google）并使用开源 Apple 代码签名例程，该例程已在其他跨平台中使用IOS SDK 的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-08T17:12:20.737

RoboVM 不支持从 Mac OS 以外的操作系统交叉编译 iOS 应用程序，但我们计划在未来支持它。这是一个运行在 Linux 上的 iOS 交叉编译工具链，您可能会感兴趣：[https](https://code.google.com/p/ios-toolchain-based-on-clang-for-linux/) ://code.google.com/p/ios-toolchain-based-on-clang-for-linux/ 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-28T09:54:58.857

看起来 Java-to-IOS 正在由[RoboVM](http://www.robovm.org)项目处理：

> Java 到本机
> 
> RoboVM 编译器将 Java 字节码翻译成原生 ARM 或 x86 代码。应用程序直接在 CPU 上运行。不涉及解释器或虚拟机。

正如我的问题所建议的那样，它使用了 LLVM。

另外值得注意的是[Avian JVM](http://oss.readytalk.com/avian)项目。它可用于编译为本机和 IOS 二进制文件（通过捆绑 JVM），但是，我不确定其用户界面 (UI) 层的状态或完整性。

这两个项目似乎都处于当前和不断发展的阶段。

# openerp - 如何在 OpenERP 6 中创建参考字段

> ID：13689363
> 
> 赞同：4
> 
> 时间：2012-12-03T18:24:01.197
> 
> 标签：openerp

我正在尝试从 OpenERP 的 web gui 和字段类型创建一个字段作为参考 1st 没有更好的参考文档

我想要的第二个是当有人选择该字段时，它应该给出另一个没有发生的选择选项（尽管它给出了一些字段但第二个字段抛出错误）！

它抛出一个错误对象不存在

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T09:12:06.373

参考字段主要用于在您的记录中显示不同模型的记录作为参考。例如，您创建了一个模型，每当创建和保存销售订单、采购订单、交货单、项目等时，就应该在您的模型中创建一个包含用户名、日期等数据的新记录。因此，您可以在此处添加一个参考字段，该字段链接到创建记录的原始记录（销售订单、采购订单等）。您可以在 openerp 6 的 res.request 模型中找到它

在您的班级中创建参考字段

```
def _get_selection_list(self, cr, uid, context=None):
    #@return a list of tuples. tuples containing model name and name of the record
    model_pool = self.pool.get('ir.model')
    ids = model_pool.search(cr, uid, [('name','not ilike','.')])
    res = model_pool.read(cr, uid, ids, ['model', 'name'])
    return [(r['model'], r['name']) for r in res] +  [('','')]

_columns = {
    'ref': fields.reference(Reference', selection=_get_selection_list, size=128)
} 
```

# plone - Plone：在导航树上显示默认视图

> ID：13689365
> 
> 赞同：0
> 
> 时间：2012-12-03T18:24:25.393
> 
> 标签：plone

我的问题很简单......

在 Plone 4 (4.2) 中，我需要设置什么以使默认视图（例如简单页面）显示在导航树中。

![不显示默认视图](../Images/052c250d8b020f7c59cb4bc1c7466b6a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:02:39.667

导航树使用该`INavigationQueryBuilder`组件来查找显示的所有元素。默认实现*过滤掉*任何用作默认页面的内容。

您必须提供自己的实现；但您可以重新使用原始实现。您所要做的就是稍微改变生成的查询；通常，如果不存在更具体的查询，`is_default_page`则使用索引来过滤掉默认页面。但是，如果您*更改*的查询添加了对该索引的搜索，则它不会尝试添加更具体的过滤器。将其设置为搜索`(True, False)`意味着它将返回默认和非默认页面，从而有效地中和过滤器。

然后实现变为：

```
from plone.app.portlets.portlets.navigation import QueryBuilder, INavigationPortlet
from zope.component import adapts
from zope.interface import implements, Interface

class INonDefaultPageFilteringNavigationPortlet(INavigationPortlet):
    pass

class DontFilterDefaultQueryBuilder(QueryBuilder):
    implements(INavigationQueryBuilder)
    adapts(Interface, INavigationPortlet)

    def __init__(self, context, portlet):
        super(DontFilterDefaultQueryBuilder, self).__init__(context, portlet)
        self.query['is_default_page'] = (True, False)  # Don't filter out default pages 
```

您必须将其注册为适配器，*并将*其添加`INonDefaultPageFilteringNavigationPortlet`到您的 portlet 以“激活”此构建器：

```
<configure
    xmlns="http://namespaces.zope.org/zope"
    xmlns:five="http://namespaces.zope.org/five">

<adapter factory=".yourmodule.DontFilterDefaultQueryBuilder" />

<five:implements
    class="plone.app.portlets.portlets.navigation.Assignment"
    interface=".yourmodule.INonDefaultPageFilteringNavigationPortlet" />

</configure> 
```

需要注意的是，这是未经测试的，但它*应该可以*工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:59:43.293

您还可以在文件夹中创建一个链接，将目标设置为“./idOfPage1”并将链接设置为文件夹的默认视图。

没有编辑权限的用户将被重定向到 Page1，页面本身将显示在 navportlet 中。

# sql - sql / phpmyadmin 在另一个 INSERT 语句中使用查询结果

> ID：13689369
> 
> 赞同：0
> 
> 时间：2012-12-03T18:25:07.127
> 
> 标签：sql, insert, phpmyadmin

我有一个问题，我无法直接访问数据库，需要为客户端生成一些 SQL 查询，以便将粘贴直接复制到 phpMyAdmin 中的 SQL 查询框中。

我想要实现的是：（这种语法不起作用）

```
SET @var1 = Select id FROM Table1 WHERE another_id = 'UNIQUEID';
INSERT INTO Table2 ('v1', 'v2') VALUES (@var1 , 'blahblah'); 
```

@var1 将始终是单个字符串。

我怎样才能只使用 sql 语句来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:33:09.897

好的，想通了，等了 1 小时，只有 5 次查看，没有回复。

```
INSERT INTO Table2(v1, v2)
SELECT Table1.id, blahblah WHERE Table1.another_id = 'UNIQUEID'; 
```

# ruby-on-rails - 如何创建仅包含部分的 4x4 网格？

> ID：13689371
> 
> 赞同：3
> 
> 时间：2012-12-03T18:25:08.237
> 
> 标签：ruby-on-rails, ruby-on-rails-3, partial-views

假设我的收藏中有 16 个对象，我想创建 4 行，每行 4 个。

我如何使用部分来做到这一点？

一种方法是只在主页上使用一个部分，并让该部分呈现每一行。然后在那个部分里面，有 4 个对象 - 但我实际上如何做到这一点，这样它就不会重复对象和所有这些好东西？

所以我想的结构是一个局部的（产生 4 行），每个局部是另一个并排产生 4 个对象的局部。

但不太确定如何做到这一点。

建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T19:07:34.197

```
<% @objects.in_groups_of(4, false) do |objects| %>
  <div class="row">
    <% objects.each do |object| %>
      <%= render object %>
    <% end %>
  </div>
<% end %> 
```

# database - 学习关系规范化有人可以帮我解决这个问题吗？

> ID：13689374
> 
> 赞同：2
> 
> 时间：2012-12-03T18:25:34.880
> 
> 标签：database, normalization, database-normalization

我一直在为某些工作阅读这个主题，但这个符号对我来说仍然没有意义

```
Relation R(A,B,C,D,E,F,G,H) with the following functional dependencies:
Fd1: A → BCD
Fd2: AD → E
Fd3: EFG → H
Fd4: F → GH 
```

有人可以简要解释一下这是什么意思，或者让我知道是否有这方面的指南吗？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:40:07.387

`R(A,B,C,D,E,F,G,H)`指关系及其组成字段 (AH)。

函数依赖（标记`A -> B`为 ）意味着对于 A 的单个值，B 的值只有一个且只有一个。

在这样的情况下：`A -> BCD`这意味着对于 A 的单个值，只有一个BCD 值*元组*。元组只是字段的组合。

所以，让我们看一些示例数据，看看什么是函数依赖，什么不是函数依赖：

```
A  |  B  |  C  |  D  |  E
=========================
1  |  a  |  2  |  b  |  3
-------------------------
2  |  a  |  3  |  c  |  4
-------------------------
3  |  a  |  4  |  d  |  5 
```

从上面的非常基本的表格中，我们可以推断出以下内容：

1.  `A --> B`是一种函数依赖，因为对于 A 的每个值，B 的值只有一个且只有一个。
2.  另一方面，`B --> A`它不是函数依赖，因为对于单个 B 值（“a”），存在多个可能的 A 值（1,2,3）。
3.  上述相同的两个结论适用于关于 B 列的所有其他列，以及由 A、C、D 和 E 列组成的元组。

希望这会有所帮助。如果您用更多细节更新您的问题，我可以解决您可能遇到的其他问题。

# php - 试图通过比较不同的表从 SQL 查询中输出正确的值

> ID：13689378
> 
> 赞同：3
> 
> 时间：2012-12-03T18:25:46.797
> 
> 标签：php, mysql, sql

我对 SQL 很陌生，需要有关如何使用正确的查询来完成此任务的帮助。

我有 2 张桌子需要使用。表“TB1”有：

```
id Name
1  bob
2  blow
3  joe 
```

表“TB2”有：

```
compid property
1      bob
2      blow 
```

我正在尝试获取“TB2”中缺少哪个compid并从“TB1”中插入它

我正在做的查询是：

```
SELECT id, name from TB1, TB2 where id <> compid 
```

我得到的是 ID 1 和 2 的 2 个输出，以及来自 id 3 的 3 个输出。通过使用 php：

```
for($i=0;$i <= mysql_num_rows($comp)-1; $i++)
{
 echo mysql_result($comp, $i, 0)."<br>";

} 
```

我期望输出 3 但得到了这个：

```
1
1
2
2
3
3
3 
```

我了解它比较表中的所有行但是有没有办法实现我正在寻找的东西？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:29:29.207

您正在执行隐式笛卡尔运算`JOIN`，这会导致每一行都与其他行相对。您需要指定`JOIN`两个表的哪些属性。

使用隐式语法（不推荐）：

```
SELECT id, name 
FROM TB1, TB2 
WHERE id <> compid
  AND TB1.Name = TB2.property <-- Column join 
```

使用显式语法：

```
SELECT id, name
FROM TB1
JOIN TB2
  ON TB2.property = TB1.Name <-- Column join
WHERE id <> compid 
```

为了实现您的目标，您需要以下内容：

```
SELECT TB1.id, TB1.name
FROM TB1
LEFT JOIN TB2
  ON TB2.property = TB1.Name
WHERE TB2.compid IS NULL 
```

## [看到它在行动](http://sqlfiddle.com/#!2/dac4e/1)

最佳做法是始终为您选择的列设置别名以防止出现歧义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:28:53.933

要选择它，您可以执行以下操作：

```
SELECT * 
FROM TB1 
WHERE id NOT IN (
    SELECT compid 
    FROM TB2
); 
```

# java - 读取 UTF-8 文件并编写普通的 ANSI？

> ID：13689379
> 
> 赞同：2
> 
> 时间：2012-12-03T18:25:49.090
> 
> 标签：java

我有一个 UTF-8 文件（它是一个 csv）。
我需要逐行读取这个文件做一些替换，然后逐行写入另一个文件。

```
 BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(
        new FileOutputStream(fileFix), "ASCII")
    );
    bw.write("");   //clean current file

    BufferedReader br = new BufferedReader(new InputStreamReader(
        new FileInputStream(file),"UTF-8")
    );

    String line;
    while ((line = br.readLine()) != null) {
        line = line.replace(";", ",");
        bw.append(line + "\n");
    } 
```

就那么简单。
问题是输出文件（fileFix）是 UTF-8，我认为它有 BOM 字符。

如何在没有 BOM 的情况下将文件编写为纯 ANSI？

使用软件（weka）读取文件时遇到的错误

![在此处输入图像描述](../Images/435e54d0436889f800afd68a3d84198b.png)

该文件的第一行：

![在此处输入图像描述](../Images/32a4f24ca959390a9adcfadfb77fb564.png)

考虑一下记事本++告诉我字符集是UTF-8。如果我尝试将此文件转换为纯 ASCII（使用 Windows 记事本），则字符消失

## 解决方案

当您在第一行运行时：

```
line = line.substring(1); 
```

删除任何 BOM 字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:40:54.593

听起来这是一个 BOM 问题，而不是编码问题。

您可以在编写文件时删除任何 BOM 字符，使用：

```
line = line.replace("\ufeff", ""); 
```

这留下了一个问题，即您是否首先准确地读取了数据......我*强烈*建议您不要使用`FileWriter`and `FileReader`—— 相反，使用`InputStreamReader`and `OutputStreamWriter`，为它们明确指定编码。将阅读器编码设置为 UTF-8（假设输入文件确实是 UTF-8），并将编写器编码设置为您想要的任何内容......但老实说，我建议坚持使用 UTF-8。

另请注意，如果您使用的是 Java 7 ，您应该在`finally`块中关闭您的阅读器/编写器，或者使用[try-with-resources语句。](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:05:57.737

查看[http://en.wikipedia.org/wiki/Byte_order_mark](http://en.wikipedia.org/wiki/Byte_order_mark)替换的模式，看起来像 EF BB BF 而不是 FE FF

**这个解决方案是错误的**检查 Jons 回答 intsead

# javascript - 根据选定的单选按钮显示多个字段集之一

> ID：13689385
> 
> 赞同：1
> 
> 时间：2012-12-03T18:26:10.143
> 
> 标签：javascript, jquery, html, forms

我制作[了一个表单来使用 PHP 处理用户输入](http://dendodge.me/?p=harvard)，第一个问题要求用户选择三个单选按钮之一来填写“类型”参数 - 可用选项是“书”、“期刊”和“网站”，代码如下所示：

```
<strong>Type of work:</strong>
<input type="radio" name="type" id="book" value="book" checked="checked" /> <label for="book">Book</label>
<input type="radio" name="type" id="journal" value="journal" /> <label for="journal">Journal</label>
<input type="radio" name="type" id="website" value="website" /> <label for="website">Website</label> 
```

在页面的下方，我有三个字段集（使用`<fieldset>`），每个字段集对应于一种类型。我希望一次只显示其中一个，具体取决于选择了哪个单选按钮，以使页面看起来更干净。

不幸的是，我是一个 JavaScript 菜鸟，我最后一次尝试把事情搞砸了。这些字段集已经有 ID（`boxBook`、`boxJournal`和`boxWebsite`），尽管它们目前没有做任何特别的事情。

如果它影响任何东西，我希望输出是有效的 HTML5，并优雅地降级，如果用户禁用了 JS，则显示所有三个字段集。

任何帮助将不胜感激^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:31:37.940

使用 jQuery 我建议：

```
// hides the elements using jQuery (so they're visible without JavaScript)
$('#boxBook, #boxJournal, #boxWebsite').hide();

// when the radio inputs whose name is equal to "type" is changed:
$('input:radio[name="type"]').change(function() {
    var id = this.id;

    // hides all the fieldset elements whose `id` starts with "box":
    $('fieldset[id^="box"]').hide();

    // looks for the element with the id equal to
    // `box` + upper-cased first-letter of this.id +
    // the substring from second-letter onwards of this.id
    $('#box' + id[0].toUpperCase() + id.substring(1)).show();
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/U2MKh/)。

`id`顺便说一句，与其对输入执行字符串操作，不如*使用*属性来指定目标元素的精确度会`radio`更容易：*`data-*``id`*

 *```
<input type="radio" id="book" name="type" data-targets="boxBook" /> 
```

并使用：

```
$('#boxBook, #boxJournal, #boxWebsite').hide();

$('input:radio[name="type"]').change(function() {
    var id = $(this).attr('data-targets'); // or: $(this).data('targets');
    $('fieldset[id^="box"]').hide();
    $('#' + id).show();
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/U2MKh/1/)。

* * *

**编辑**后一个代码块以满足 OP 的要求：

```
$('input:radio[name="type"]').change(function() {
    $(this).siblings('input:radio[name="type"]').each(function() {
        $('#' + $(this).data('targets')).hide();
    });
    $('#' + $(this).data('targets')).show();
}).filter(function() {
    return !this.checked;
}).each(function() {
    $('#' + $(this).data('targets')).hide();
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/U2MKh/6/)。

不过，坦率地说，我认为我把它复杂化了很多。但它确实有效，并且满足了评论中指定的需求：

> 如果默认选中其中一个单选按钮，则不会显示字段集。如果可能的话，我想让它默认预订

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:32:44.080

您应该在头部的脚本元素中使用一个函数，大致如下

```
function chooseFieldset(id) {
  document.getElementById('boxBook'   ).style.display =
      (id == 'book')   ?'display':'none';
  document.getElementById('boxJournal').style.display =
      (id == 'journal')?'display':'none';
  document.getElementById('boxWebsite').style.display =
      (id == 'website')?'display':'none';
} 
```

然后，您可以在每次单击单选按钮时调用 id ，使用每个单选上的属性：

```
onClick="chooseFieldset(this.id);" 
```*

# php - 实现接口的抽象类的 PHPUnit 代码覆盖率

> ID：13689390
> 
> 赞同：1
> 
> 时间：2012-12-03T18:26:30.073
> 
> 标签：php, interface, phpunit, abstract-class, code-coverage

我目前正在为 Symfony2 开发比特币支付包。你可以在[我的github](https://github.com/wikp/WikpPaymentBitcoinBundle)上查看。它还没有（我希望）完全由测试驱动开发，但我尽量让它尽可能地被测试覆盖。

Bundle 包含[`AbstractCommand`](https://github.com/wikp/WikpPaymentBitcoinBundle/blob/master/Bitcoin/Client/Command/AbstractCommand.php) 实现[`CommandInterface`](https://github.com/wikp/WikpPaymentBitcoinBundle/blob/master/Bitcoin/Client/Command/CommandInterface.php)接口的类。因为它是一个抽象类，所以不需要实现接口的每一个方法。伟大的。

接下来，我有[`AbstractCommandTest`](https://github.com/wikp/WikpPaymentBitcoinBundle/blob/master/Tests/Bitcoin/Client/Command/AbstractCommandTest.php)测试用例。它测试该`validateParameters`方法是否有效。测试涵盖课程的每一行。但是......当我在我的 IDE（带有 PHP 插件的 IntelliJ Idea）上运行测试覆盖率分析时，它表明覆盖率高达 93%。这很奇怪，因为没有一条线用红色标记（我已经更改了默认配色方案，所以我看得很清楚；））。

问题是：为什么？是 PHPUnit 错误吗？或者可能是类模型构建问题？当我在 AbstractCommand （并且没有接口）中有抽象方法时，它们也没有被覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:41:18.737

如我所见，您可能没有涵盖方法中的`catch`声明`validateParameters`。

尝试将您的`ParameterBug`论点设为模拟，以便`\InvalidArgumentException`在另一个测试中抛出异常。这应该涵盖您想要的（但为了使其成为可能，您必须将`validateName`方法更改为受保护的）：

```
$parameterSetMock = $this->getMock('AppropraiteNamespace\ParameterSet', array('validateName'));
$parameterSetMock->expects($this->any())
    ->method('validateName')
    ->will($this->throwException(new \InvalidArgumentException); 
```

还有一件事：

您的测试中没有使用 try/catch 块。如果您使用：

```
 $this->setExpectedException('ExpectedException', 'Expected Message'); 
```

在测试开始时，如果不抛出预期的异常，测试将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T18:47:41.243

在查看三叶草覆盖率文件时，我已经解决了这个问题。表明：

```
<file name="/srv/bundles-src/payment-bitcoin/Bitcoin/Client/Command/AbstractCommand.php">
    <class name="AbstractCommand" namespace="Wikp\Payment\BitcoinBundle\Bitcoin\Client\Command">
      <metrics methods="2" coveredmethods="2" conditionals="0" coveredconditionals="0" statements="13" coveredstatements="13" elements="15" coveredelements="15"/>
    </class>
    <line num="0" type="stmt" count="0"/>
        <!-- coverage data for methods -->
    <line num="36" type="stmt" count="0"/>
    <metrics loc="35" ncloc="35" classes="1" methods="2" coveredmethods="2" conditionals="0" coveredconditionals="0" statements="13" coveredstatements="13" elements="15" coveredelements="15"/>
  </file> 
```

查看 AbstractCommand 文件时，第 36 行是类定义后的空白行。删除它会导致覆盖率为 100%。我认为这是 IntelliJ/PHPStorm 的问题。

# game-center - 基于回合的参与者超时日期始终为 NULL

> ID：13689397
> 
> 赞同：6
> 
> 时间：2012-12-03T18:27:06.240
> 
> 标签：game-center

一直在开发使用自定义 UI 进行比赛管理的两人回合制游戏。考虑将应用程序限制为 iOS 6+ 以使用播放器超时。我想向用户显示移动的剩余时间，但参与者.timeoutDate 始终为空？根据 WWDC 2012 视频（表示超时不适用于 nextParticipants 中的最后一个参与者），我在调用 endTurnWithNextParticipants:turnTimeout:matchData:completionHandler 时传递了一个包含两个条目的数组（索引 0 处的对手和索引 1 处的本地播放器） : 转一圈。我已经尝试过 GKTurnTimeoutDefault 和各种整数文字......没有运气......似乎总是为空。玩家的最后一回合日期工作正常。

关于播放器超时......在我让它们工作之后，这是如何交付的？我看到 GKTurnBasedMatchOutcomeTimeExpired ... 这是在回合事件中出现的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-17T18:41:18.880

来自 Apple 的开发者论坛

埃利安·吉多尼——

> +1 文档应该是： timeoutDate 参与者轮到超时的日期和时间。（只读）

# android - 保存上一个活动

> ID：13689399
> 
> 赞同：1
> 
> 时间：2012-12-03T18:27:11.963
> 
> 标签：android

> **可能重复：**
> [重新启动时如何使 android 应用程序返回到上次打开的活动？](https://stackoverflow.com/questions/2441203/how-to-make-an-android-app-return-to-the-last-open-activity-when-relaunched)

我正在将我的 iOS 应用程序转换为 Android。在 iOS 中，我使用 NSUserDefaults 保存最后使用的视图，以便在应用程序关闭后它会返回该视图。对于Android，我也想做同样的事情。

这就是我想要实现的目标：

用户导航到特定活动 > 应用程序将活动保存在内存中 > 用户退出应用程序 > 用户再次启动应用程序 > 用户再次看到上次使用的活动。

我应该从哪里开始寻找？有没有一种简单的方法可以实现我的目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:33:40.603

是的，您可以将上次活动的名称保存在共享首选项中。这里很好地解释[了](https://stackoverflow.com/questions/2441203/how-to-make-an-android-app-return-to-the-last-open-activity-when-relaunched)。

希望这能解决你的问题:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:31:39.243

通常，由于系统管理 Activity 和内存的方式，此功能仅在 Android 中发生，但如果应用程序被终止，那么它将从默认的 Activity 重新开始。

为了确保重新启动特定的 Activity，我可能会使用[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)并在其中存储一个键值来指定要启动的 Activity。然后在默认 Activity 中，我会让它在 SharedPreferences 启动时检查该键，如果存在，则启动指定的 Activity。

# java - 如何通过应用程序的内部浏览器发送设备信息

> ID：13689402
> 
> 赞同：0
> 
> 时间：2012-12-03T18:27:33.397
> 
> 标签：java, android, mobile

我有一个具有内部网络浏览器的本机应用程序。在网络浏览器中，我将打开我自己创建的移动网络应用程序。我想做的是在用户单击内部浏览器上的按钮时发送本机设备的信息，例如经度、纬度、电池状态或设备名称。有没有办法我可以做到这一点？

如果需要，我可以提供更多信息。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:35:43.537

最简单的方法是创建一个 javascript 界面。这样您就可以从 javascript 调用 Java 方法。

[http://developer.android.com/guide/webapps/webview.html](http://developer.android.com/guide/webapps/webview.html) “将 JavaScript 代码绑定到 Android 代码”部分

为了更清楚：

1.  调用javascript方法（javascript会调用java方法）
2.  该 java 方法将查询 android 操作系统以获取您想要的信息
3.  java方法会将所有信息返回给javascript
4.  javascript 现在可以在某处显示或发送这些数据

# batch-file - 从文件中读取，批处理

> ID：13689403
> 
> 赞同：0
> 
> 时间：2012-12-03T18:27:38.023
> 
> 标签：batch-file, read-write

我在批处理中乱搞，我想知道......

有人可以帮我写入文件（`Doc1.txt`或`Doc1.doc`）然后读取它，将其设置为变量。如果需要更改并保存？并且在一个文件中有多个密码？

我听说可以读取文件，但我似乎无法让它工作。我把以下。

```
FOR /F %i IN (Test1.txt) DO Echo %i 
```

我得到错误：

```
IN is not excepted at this time. 
```

任何帮助都会受到喜爱。谢谢！

例如。假设我正在登录东西。有人可以创建新帐户、设置密码、更改密码等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:03:38.547

this is relatively simple. use the echo command, set /p, and the less than and greater than signes.

to save something to a file, do

```
echo %variablename%> Filename.extension 
```

to read something from a file into a variable, do

```
set /p variablename= < filename.extension 
```

# ruby - 如何使用 sinatra 实现分页？

> ID：13689404
> 
> 赞同：1
> 
> 时间：2012-12-03T18:27:48.640
> 
> 标签：ruby, pagination, sinatra

我正在使用 Sinatra 和 Ruby 1.9.3。

我有一个项目列表，并想对它们进行分页。我是 web 开发的新手，所以我不知道如何详细地做到这一点。

我不知道如何实现每个页面的链接，例如指向`page2`on的链接`page1`。我应该这样做：

```
<a href='?page=2' 
```

我认为这不是一个好主意，因为它会覆盖我的其他参数，例如`?searchterm=`并且`?sort=?`它不会考虑现有`?page=`参数。

我的想法是使用与我的等相同的表单`searchterm`，并通过按钮和 JavaScript 更改值。但是，这似乎相当复杂，所有大型网站，包括 stackoverflow.com，都使用链接进行分页。

如何实现具有以下特点的分页：

1.  转到另一个页面时包括其他参数。
2.  覆盖现有`?page=`参数。
3.  没有 Javascript（可选，但会很好）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:35:30.377

您始终可以将必要的参数加载到实例变量中：

```
@page = params[:page] || 1 
```

然后像以前一样使用它：

```
<a href="?page=#{@page + 1}&search_term=#{params[:searchterm]}"... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-21T03:28:18.500

还有一个很受欢迎的 gem `will_paginate`，它会自动为你做一些这样的事情：[https](https://github.com/mislav/will_paginate) ://github.com/mislav/will_paginate 。与辛纳屈合作。

```
## Sinatra app:
require 'will_paginate'
require 'will_paginate/active_record'  # or data_mapper/sequel 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T19:07:17.780

您可以这样做，在@ChuckE 的回答中添加一些内容：

```
# Controller
  def index
    # ...
    @models = MyModel.find(:yourquery)
    if params[:page]
      page = params[:page].to_i
      @models = @models[(page * 10)..(page + 10)] # Selecting an slice out of the @models array
    end
  end

# In your view
  - @model.each do |item|
    =# do stuff
  = link_to "Next Page", "?page=#{@page + 1}"
  = link_to "Next Page", "?page=#{@page - 1}" unless @page = 1 
```

# php - 如何使用数据库值更改旧 php 站点上的 URL 结构？

> ID：13689405
> 
> 赞同：0
> 
> 时间：2012-12-03T18:27:51.557
> 
> 标签：php, .htaccess, url-rewriting, url-routing

我的任务是让旧网站的 URL 变得“漂亮”

这是一个房地产网站，有几十栋建筑，可能有 100 多套公寓房源。

当前的网址是这样的：（我可以`.php`很容易地删除扩展名`.htaccess`）

```
example.com/about?building-id=65
example.com/about?apartment-id=35 
```

它变得比这复杂得多，有一些搜索页面、不同的列表视图、一个联系表单页面，它被发送到一个建筑物或 apt id 以用一些信息预先填写表单等等......

但是对于这个例子......

理想情况下，URL 应该是

```
example.com/about/building-name/
example.com/about/building-name/apartment-name 
```

建筑物名称和公寓名称都是存储在数据库中的值，其中 id#s 作为主键。

在研究了这个问题之后，我确定了几种不同的方法

1）**在管理员更改时****动态生成文件`.htaccess`**

*   我想我能做到这一点吗？
*   它会明确重写几乎所有可能的有效查询字符串可能性（可能多达几百个）
*   我想这会导致一些性能问题，并且可能不是最佳实践。
*   如果它是最简单的选择，那么只要它有效，我就可以接受它是草率和糟糕的做法。

2)**创建一个*控制器*并重写所有查询，`index.php`这些查询将把这里的所有视图放在一起。**

*   这有点超出我的舒适区，但可能被认为是最佳实践？

*该站点严重陈旧，并且组合不佳（1000 行自定义（非 OOP）php 行，有很多代码重复）就此而言，它实际上是 2 个不同的站点共享一个数据库，并且大部分代码库（第二个是前段时间使用原始代码库的复制粘贴创建的，并且已经分崩离析）*

* * *

**我的问题**

*   这些是可行的选择吗？我错过了任何选择吗？

*   我应该采取哪种方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:02:28.363

.htaccess 文件的实际生成不会成为问题。我的意思是，将 500 或 1000 行文本写入文件根本不是什么大问题。但是，大量规则实际上可能会影响性能，因为引擎会针对每个 HTTP 请求检查请求的 URL。这可能不是一个很大的性能影响，但对我来说似乎很浪费。请注意，Apache、AFAIK 没有对 .htaccess 重写规则或重定向进行优化，即它不会从小正则表达式等构建大正则表达式。

选项 2，在 PHP 中解析请求，实际上是更少的工作，我认为，特别是对于一个巨大的非 OOP 站点。

考虑这样的片段：

```
$uri = explode('/', $_SERVER['REQUEST_URI']);
if($uri[0] == 'about') {
    $id_aray = lookup_building_and_apartment_by_name( $uri[1], $uri[2] );
    $_GET['building_id'] = $id_array['building'];
    $_GET['apartment_id'] = $id_array['apartment'];
    include('about.php');
} 
else if($uri[0] == 'something_else') {
    // something else.
}
else {
    // 404
} 
```

这样的逻辑可以很好地用作控制器，而且它的工作量并不大。

或者，您可以在每个入口点的顶部放置一个 URI 解析器片段。比如，在 about.php 的顶部：

```
$uri = explode('/', $_SERVER['REQUEST_URI']);
$id_aray = lookup_building_and_apartment_by_name( $uri[1], $uri[2] );
$_GET['building_id'] = $id_array['building'];
$_GET['apartment_id'] = $id_array['apartment']; 
```

这将使您能够增量工作，一次一个子页面，并且旧链接也将继续工作。

* * *

主要是为了记录：有一个选项 3，您可以在 mod_rewrite 规则中使用[捕获组，如下所示：](http://www.regular-expressions.info/brackets.html)

```
RewriteRule ^/about/([^/]+)/([^/]+)$ about.php?building_name=$1&apt_name=$2 [NC,L]
RewriteRule ^/about/([^/]+)$ about.php?building_name=$1 [NC,L] 
```

（这可以用一条规则来完成，但是像这样读写要容易得多。）这仍然需要您在 about.php 中进行基于 php 的翻译，但您可以将这些规则放入您的httpd.conf。

还有一个选项 4：[RewriteMap](http://httpd.apache.org/docs/current/rewrite/rewritemap.html)。这是一个很棒且功能强大的工具，如果您能够应对 Apache 手册的简洁性，它可能正是您的理想之选。学习使用它可能会比使用基于 PHP 的解决方案花费更多的时间，但知道这是一件好事，它是一种高效的解决方案，而且非常优雅。

您可以轻松生成基于[文本的映射](http://httpd.apache.org/docs/current/rewrite/rewritemap.html#txt)，然后使用 RewriteRule 中的映射，如下所示：

```
RewriteMap building_map txt:/etc/apache2/buildings.txt
RewriteRule ^/about/([^/]+)$ about.php?building-id=${building_map:$1|0} [NC,L] 
```

# sql - 将 UNION 添加到两个 SELECT 语句（使用 CASE）

> ID：13689407
> 
> 赞同：0
> 
> 时间：2012-12-03T18:27:54.980
> 
> 标签：sql, union

好的，这是我的实际表格和数据：

这只是返回 Y 或 N 而不是直接比较数据

tblViewLearners（这个 intID = intLearnerID 在另一个表中）

```
IntID   -   FirstName    -  Surname   -  Course    - Dob    - address     - nationality
701271      Julie           Barnett      Physics     NULL       NULL          NULL
345239      Rachel          Smith        Physics     NULL       NULL          NULL
240259      David           Feffer       Maths       NULL       NULL          NULL 
```

tblAWARDSLearner（基本上，如果学习者进入此表，并且具有“DISTINCTION”）

```
 intID   -  intLearnerID    -  dateawarded
 2402       701271             21/04/1992
 1032       345239             01/01/2010 
```

我的目标

```
IntID   -   FirstName    -  Surname   -  Course     - DISTINCTION Awarded
701271      Julie           Barnett      Physics          Yes
345239      Rachel          Smith        Physics          Yes
240259      David           Feffer       Maths            No 
```

编码

```
SELECT Y.intID
FROM
(
SELECT    A.* ,   
CASE 
        WHEN B.intLearnerID IS NULL THEN 'N' 
        ELSE 'Y' 
END 'DISTINCTION Awarded' x
FROM 
    tblviewlearners A
    LEFT JOIN tblAWARDSLearner B
    ON A.intID = B.intLearnerID

)AS Y; 
```

我也将它与另一张桌子连接起来，但一旦上面的工作正常，就会越过那座桥，值得注意的是，上面的表格已经被进一步声明，所以当我加入时，我不需要将它包含在 FROM 和只是更直接地比较表列（我认为这是正确的）。但是我想先让上述工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:46:21.303

编辑#2，根据您的更新，使用您的示例数据，您应该能够使用以下内容：

```
SELECT  A.Intid, A.Firstname, A.Surname, A.Course,   
  CASE 
        WHEN B.intLearnerID IS NULL THEN 'No' 
        ELSE 'Yes' 
  END DISTINCTIONAwarded 
FROM tblviewlearners A
LEFT JOIN tblAWARDSLearner B
  ON A.intID = B.intLearnerID 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/491a0/6)

这将为您提供所需的结果：

```
|  INTID | FIRSTNAME | SURNAME |  COURSE | DISTINCTIONAWARDED |
---------------------------------------------------------------
| 701271 |     Julie | Barnett | Physics |                Yes |
| 345239 |    Rachel |   Smith | Physics |                Yes |
| 240259 |     David |  Feffer |   Maths |                 No | 
```

~~您当前的查询有几个问题。`)`首先，在最后的末尾有一个额外的右括号`JOIN`- 删除它。其次，您要给出`BestSeller`一个字符串列名，您不能使用字符串文字 - 删除单引号。最后在您使用的第二个查询中，`SELECT A.*`但`A`别名来自您需要使用别名的内部查询`Y`：~~

 ~~```
SELECT * 
FROM tblbookshop 
INNER JOIN tblAllsellers
    ON tblbookshop.productID = tblAllsellers.BookID
UNION
SELECT Y.*  
FROM AnotherTable X 
JOIN 
 (
    SELECT  A.*, 
        CASE 
            WHEN B.ProductId IS NULL THEN 'N' 
            ELSE 'Y' 
        END BestSeller
    FROM tblAllSellers A
    LEFT JOIN tblBestSellers B
        ON A.ProductId = B.ProductID
 ) AS Y
    ON X.ProductId = Y.ProductID 
```~~ 

*请注意，当您使用 a 时`UNION`，`UNION ALL`两个查询中的列数需要相同，并且数据类型需要与两个查询中的列相同。*

编辑，根据您收到的错误的评论`UNION`，我有一些建议。虽然如果您有不同数量的列，我看不到您的完整表结构，但是您可以在查询中包含一个占位符列，它的列数较少。这是一个示例，这些示例表具有不同数量的列：

```
CREATE TABLE Table1([col1] int, [col2] varchar(4));

INSERT INTO Table1 ([col1], [col2])
VALUES (1, 'test'),(2, 'blah');

CREATE TABLE Table2 ([col1] int, [col2] varchar(5), [col3] varchar(5));

INSERT INTO Table2 ([col1], [col2], [col3])
VALUES  (1, 'test1', 'data1'),  (2, 'test2', 'data2'); 
```

如果我尝试一个`UNION`操作，那么它将生成一条错误消息，但如果我包含一个占位符列，那么它将起作用：

```
select col1, col2, null as col3
from table1
union all
select col1, col2, col3
from table2; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/5fe6a/1)

~~我对您的另一个建议是不要`SELECT *`在您的表上使用，然后您可以指定要返回的列，这可以纠正您收到的错误。~~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:35:54.113

您需要删除最后一个“）”。

我建议您将 BOTH Select 包含在 ( ) 中，以便您获得

```
(SELECT * 
FROM tblbookshop INNERJOIN tblAllsellers
ON tblbookshop.productID = tblAllsellers.BookID)

UNION
( SELECT A.*  
 FROM 
 AnotherTable X 
 JOIN 
 (
    SELECT 
        A.*, 
        CASE 
            WHEN B.ProductId IS NULL THEN 'N' 
            ELSE 'Y' 
        END 'BestSeller'
    FROM 
        tblAllSellers A
        LEFT JOIN tblBestSellers B
        ON A.ProductId = B.ProductID
 ) AS Y
 ON X.ProductId = Y.ProductID) 
```

# ruby-on-rails - 如何在出版物中为“广告”建模

> ID：13689409
> 
> 赞同：0
> 
> 时间：2012-12-03T18:28:11.947
> 
> 标签：ruby-on-rails, e-commerce, modeling

我正在构建一个应用程序，允许用户购买广告以在印刷出版物中显示。广告以类似于黄页的方式列在出版物的某个部分中，您可以在其中选择一个类别来显示您的列表。

每个广告的价格由许多因素决定。列表以“基本”价格开始。超过一定字符数的广告将产生额外费用（例如，包括 0-74 个字符、75-150 个字符 20 美元、150-200 个字符 40 美元），广告可以选择显示小徽标以收取额外费用，并且您可以通过在多个出版物中投放相同的广告来获得折扣。（例如，如果您在接下来的两期中投放广告，则每个广告可获得 20% 的折扣，在接下来的四期中投放广告可获得每个广告 30% 的折扣）

我正在尝试考虑建模这种行为的不同方法。我想过做一些类似于[这个接受的答案](https://stackoverflow.com/questions/10690506/hotel-rooms-prices-how-to-manage-discounts-that-changes-according-to-some-condi)的事情，结合 ActiveRecord:store 来保存每个变体的条件，但我不确定这是否是个好主意。

我想要一些半灵活的东西，因为客户似乎在每个问题上都尝试了很多不同的定价调整。提前感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:37:42.487

```
Advertisement:{
    length,
    body,
    cost,
    owner,
    icon,
    startDate,
    endDate
} 
```

在这里，您有一个类广告，具有长度（计算）、正文、成本（计算）、所有者、图标、开始和结束日期。使用正文确定长度。使用图标、结束 - 开始日期和长度来计算成本。我会在类方法中完成所有这些。

现在您可能想要考虑拥有一个广告所有者表等，这取决于您。

# java - 在启动应用程序时保存“检查”复选框状态

> ID：13689420
> 
> 赞同：0
> 
> 时间：2012-12-03T18:29:32.343
> 
> 标签：java, android, checkbox, state

嗨，我遇到了“保存复选框的状态”的问题。在我的情况下：检查状态 - 启用声音，取消选中状态 - 禁用它们。在我的 options.xml 上，我进行了设置：

```
<CheckBox
android:id="@+id/bbutton_sound"
android:layout_width="match_parent"    
android:layout_height="wrap_content"    
android:text="@string/ebsound"    
android:layout_marginTop="20.00dp"    
android:checked="true"/> 
```

问题是当我取消选中选项中的复选框时。退出应用程序并再次输入后，所有声音均已启用（这是正确的），但复选框保持未选中状态（应返回检查状态）。我不知道如何实现这一点。我试图通过 ondestroy 方法强制“检查状态”，但没有任何帮助。这是我的java代码：

```
package com.Pong;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.Toast;

public class Options extends Activity {
  private CheckBox bbutton_sound;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.options);
    addListenerOnButton();
    bbutton_sound.setChecked(true);
    final MediaPlayer mpButtonClick = MediaPlayer.create(this, R.raw.menu_button_sound);
    Button BackButton = (Button)findViewById(R.id.Back);
    BackButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent MenuIntent = new Intent(Options.this,Menu.class);
            Options.this.finish();
            startActivity(MenuIntent);
            mpButtonClick.start();
        }
    });

  }
  @Override
  public void onPause() {
      super.onPause();
      save(bbutton_sound.isChecked());

  }

  @Override
  public void onResume() {
      super.onResume();
      bbutton_sound.setChecked(load());
  }

  private void save(final boolean isChecked) {
      SharedPreferences sharedPreferences = getPreferences(Context.MODE_PRIVATE);
      SharedPreferences.Editor editor = sharedPreferences.edit();
      editor.putBoolean("check", isChecked);
      editor.commit();
  }

  private boolean load() { 
      SharedPreferences sharedPreferences = getPreferences(Context.MODE_PRIVATE);
      return sharedPreferences.getBoolean("check", true);
  }

  public void addListenerOnButton() {
      bbutton_sound = (CheckBox) findViewById(R.id.bbutton_sound);
      bbutton_sound.setOnClickListener(new OnClickListener() {

      @Override
      public void onClick(View v) {
        if (((CheckBox) v).isChecked()) {
            AudioManager volumeControl = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
            volumeControl.setStreamMute(AudioManager.STREAM_MUSIC, false);
            int maxVolume = volumeControl.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
            volumeControl.setStreamVolume(AudioManager.STREAM_MUSIC, maxVolume, maxVolume);

            Toast.makeText(Options.this,
               "Sounds enabled", Toast.LENGTH_LONG).show();
        } else if (((CheckBox) v).isChecked()==(false)){
            AudioManager volumeControl = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
            volumeControl.setStreamMute(AudioManager.STREAM_MUSIC, true);
            Toast.makeText(Options.this,
                       "Sounds disabled", Toast.LENGTH_LONG).show();
        }
      } 
    });

  }
} 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T11:01:07.980

嗨，很抱歉回复晚了，但我找到了一种方法来删除不需要的检查:)。这有点作弊，因为我所要做的就是在 IntroGame 活动的 onCreate 方法中删除该状态，这是我游戏中的第一个活动，不能跳过:)。

```
@Override
    public void onCreate(Bundle savedInstanceState) {
    SharedPreferences sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
    SharedPreferences.Editor editor = sharedPreferences.edit();
    editor.remove("check");
    editor.commit(); 
```

感谢您的帮助和关注！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:53:34.507

当您备份您的设置时，您的设置将被保存，因此当您启动应用程序时，它会取消选中该值。

尝试这个：

```
@Override
protected void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();
    SharedPreferences sharedPreferences = getPreferences(Context.MODE_PRIVATE);
    SharedPreferences.Editor editor = sharedPreferences.edit();
    editor.remove("check");
    editor.commit();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:05:16.273

如果您使用内置的 Preferences XML+Activity/Fragment 框架，您的选项/菜单设置可能更易于使用和调试。您可以只使用预先构建的 CheckBoxPreference，它总是会从关联的已保存首选项中获取其选中状态。[http://developer.android.com/guide/topics/ui/settings.html](http://developer.android.com/guide/topics/ui/settings.html)

在 res/xml 中：

```
 <CheckBoxPreference
        android:key="@string/pref_sounds_key"
        android:title="@string/pref_sounds_title"
        android:summary="@string/pref_sounds_summary"
        android:persistent="true"
        android:enabled="true"
        android:defaultValue="false"
    /> 
```

在您的活动中：

```
public boolean getPreferenceSounds() {
    String key = getString (R.string.pref_sounds_key);
    boolean result = getSharedPreferences().getBoolean (key, false);

    return result;
}

public void onSharedPreferenceChanged (SharedPreferences sharedPreferences, 
    String key) { ... } 
```

# c++ - 自动驱动器格式化？

> ID：13689423
> 
> 赞同：1
> 
> 时间：2012-12-03T18:29:41.020
> 
> 标签：c++, batch-file, hard-drive

有没有一种简单的方法可以以编程方式格式化多个驱动器？我们有一个用于格式化拇指驱动器的批处理文件（如下），但每次成功格式化驱动器时都需要按 Enter 键。我假设这是防止作恶者创建驱动器格式化病毒的保障措施。无论如何，我一直在考虑使用 C++ 自动执行此操作，但找不到任何好的资源。任何提示将不胜感激。

```
@echo off
start for %%i in (e:, f:, g:, h:, i:, j:, k:, l:, m:, n:, o:, p:, q:, r:, s:, t:, u:, v:)
do format %%i /FS:fat32 /x /q /v: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:15:42.630

如果您在 WinXP 机器上执行此操作，您应该能够在`/Y`没有用户交互的情况下添加到格式。旧版本的 DOS 使用该`/AUTOTEST`开关。我知道`/AUTOTEST`不能与 结合`/Q`，但我不确定是否`/Y`有相同的要求。应该很容易让您测试和发现。

# arrays - 按标题对对象数组进行排序。Flash - 动作脚本 2

> ID：13689433
> 
> 赞同：0
> 
> 时间：2012-12-03T18:30:30.983
> 
> 标签：arrays, flash, sorting, actionscript, actionscript-2

我有一个对象数组。我的对象里面有它的标题作为参考。我需要按标题按字母顺序对我的对象数组进行排序。

下面是我一直在玩的东西，试图实现这个目标。例如，我将数组对象上的标题引用存储为索引 0。在索引 1 上，我存储了一个 ID 引用，只是为了检查排序数组的结果。

我从 flash 中得到的最后一个输出是以一种奇怪的方式排序的，这对我来说完全没有意义。请帮忙！我对实现同一目标的不同方法持开放态度。

```
//This is an example list of my objects, and their test titles.

var obj = Array("ants", 24);
var obj2 = Array("cants", 29);
var obj3 = Array("xants", 35);
var obj4 = Array("bants", 80);

//Hear I assign each object to an array
var test = Array(obj, obj2, obj3, obj4);

//I create 2 arrays. 1 to store the titles in, and 1 for the object itself.
var alpha_sort = Array();
var obj_index = Array();

for(var i in test){//loop through all properties
    alpha_sort.push(test[i][0]);
    obj_index.push(test[i]);
}

trace('----- Display unsorted list ------');

for(var i in alpha_sort){//loop through all properties
    trace(i+' - '+alpha_sort[i]);
}

trace('----- Display sorted list ------');

alpha_sort.sort(2);
for(var i in alpha_sort){//loop through all properties
    trace(i+' - '+alpha_sort[i]+ ' - '+obj_index[i][1]);
} 
```

输出是：

```
----- Display unsorted list ------
3 - ants
2 - cants
1 - xants
0 - bants
----- Display sorted list ------
2 - bants - 29
1 - cants - 35
0 - xants - 80
3 - ants - 24 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:22:13.607

您可以通过将数组值转换为对象（而不是子数组）并使用该`sortOn`方法或创建自定义排序函数来完成此操作。

我建议事先： [http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/2/help.html?content=00000751.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/2/help.html?content=00000751.html)

```
var test = Array({title: "ants", value: 24}, {title: "cants", value: 29},{title: "xants", value: 35});

test.sortOn("title"); 
```

要使用自定义排序功能：

```
test.sort(sortTitle);

function sortTitle(a, b):Number {
    if (a[0] < b[0]) {
    return -1;
    } else if (a[0]>a[0]) {
    return 1;
    } else {
    return 0;
    }
} 
```

# .net - 为什么不是到处都有 JIT（及时）编译器？

> ID：13689435
> 
> 赞同：7
> 
> 时间：2012-12-03T18:30:45.903
> 
> 标签：.net, jvm, jit

我最近了解到 JIT 编译器用于将平台无关代码编译为本机代码。JVM 和 .net 运行时环境使用它，以获得更好的性能并显着减少编译时间。我的问题是，为什么不将直接编译为本机代码的普通编译器（如 c 编译器）也制作为 JIT？如果使用 JIT 编译器，是否有使用限制或规范？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:37:28.600

JIT 有优点也有缺点。如果您将软件部署到许多不同的 PC，JIT 会非常有用，因为 JIT 编译器可以检测如何针对每个特定平台优化代码。

问题是 JIT 增加了在软件可以首先执行之前必须采取的另一个步骤：首先必须将其编译为 IL，然后再编译为机器代码，这意味着额外的性能开销。然而，这种从 IL 到机器代码的转换只需要在软件第一次运行时完成，因此每次后续调用都会快得多。

所以基本上（根据经验）你可以说：如果软件是一个长期运行的过程，那么使用 JIT 通常会很好，如果软件的生命周期很短，最好使用本机代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:36:19.370

现代 javascript 实现也执行 JIT，一些 PHP、Python 和 Ruby 实现（至少）也是如此。不过，JIT 的诀窍在于它们是相对较新的开发，使它们工作的部分原因是您依赖于最终用户机器上的某种类型的框架或运行时，它能够生成正确的该机器和应用程序实例的优化。

对于想要接近计算机“裸机”的语言，依赖那个额外的抽象层并不总是有意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T18:50:44.060

我能想到几个原因：

*   预编译的二进制文件可以使用需要数天才能达到最佳性能的高级优化，您不会希望在 JIT 编译器中这样做

*   初始 JIT 编译可能比直接解释花费更长的时间，在常见情况的后续运行中差异不明显

*   JIT 编译会占用其他运行时进程所需的用户资源（我没有看到很多 3d JIT 编译的游戏）

*   预编译的解释器，如果编写得好，可以达到足够接近的速度，同时允许用户即时修改源代码而不会降低性能

随着 x86 指令集的分歧以及 arm、mips 等在消费设备以及不同操作系统中的日益广泛使用，商业软件的这种情况开始发生变化。当您添加 JIT 编译器在视频卡上使用本机代码的能力（也有很大差异）时，尝试分发针对每个独特组合优化的编译版本变得越来越不合理。在某些时候，可以访问所有 cpu 和 gpu 的合理 JIT 编译器的性能将优于仅限于（例如）x86 子集的已编译等效项。

经常被问到的一件事是您是否可以仅分发字节码……几乎，但不完全。它适用于 java，因为它被设计为虚拟的，因此不需要担心 libc 所做的字节顺序和其他硬件问题，或者每个架构的自定义汇编语言位（所有这些都在虚拟机中实现）要真正获得稳固的基础，需要实现一个为 JIT 设计的基本 libc（可能基于 musl libc，因为它的简化代码和许可许可）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T18:34:34.830

像大多数 C 编译器（例如 GCC）一样，提前优化编译器可能会产生比 JIT 编译器更好的机器代码。但是提前编译器通常需要更多的时间（比 JIT）来优化。例如，`gcc -O3`正在进行大多数 JIT JVM 无法承受的大量优化。因此，`gcc -O3`通常会产生非常高效的机器代码（比 JVM 可以做的要好得多）。

但是，在某些情况下，JIT 技术可能会提供更好的代码，因为它能够考虑一些提前编译器未知的动态属性。例如，JIT 编译器可以考虑到，在某个特定的调用站点上，调用的参数通常具有一个给定的类（并且该类取决于调用站点，并且是动态学习的）。

# java - Java servlet - 停止执行并在错误时重定向

> ID：13689438
> 
> 赞同：3
> 
> 时间：2012-12-03T18:30:50.677
> 
> 标签：java, servlets

我的 java servlet 中有以下代码：

```
if(passenger == null){
            response.sendError(400, "The specified passenger does not exist.");
        } 
```

该页面确实重定向到错误页面，但是，仍然执行其余的 servlet 代码。如何重定向并从 servlet 中“中断”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:32:54.770

```
if(passenger == null){
            response.sendError(400, "The specified passenger does not exist.");
    return; //or return null; depending on return type of method
} 
```

# ruby-on-rails-3 - Rails 3 DateTime 比较与 ActiveRecord 查询中的日期

> ID：13689441
> 
> 赞同：8
> 
> 时间：2012-12-03T18:30:56.780
> 
> 标签：ruby-on-rails-3, date, datetime, activerecord

我正在尝试在模型中搜索等于特定日期的任何日期，同时忽略时间戳。在 Rails 中，我可以简单地将其执行`DateTime.to_date == somedate`为

```
Foo.where("created_at == some_day_without_time_stamp").count 
```

最初我认为因为我使用的是 postgresql 数据库，所以我可以简单地使用 psql 语法，但我更愿意将它留给 ActiveRecord 来决定哪种 sql 最适用，并使我的代码与数据库供应商无关。如果没有任何额外的插件或宝石，这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-04T10:26:59.553

我会做类似...

```
someday = Date.today
Foo.where( :created_at => (someday)..(someday + 1.day) ) 
```

这将捕获午夜和`created_at`之间的所有日期。这是包容性的（因此它将包括在 +1 天午夜创建的 Foo 爆炸），但可能对您的需求“足够好”而不会弄乱时间戳。`someday``someday + 1`

为了好看，我会把它包装成一个`scope`

```
scope :on_day, ( lambda do |someday|
  where( :created_at => (someday)..(someday + 1.day) )
end ) 
```

所以

```
Foo.on_day( Date.yesterday ).count 
```

可读性很好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-04-02T07:42:17.297

DateTime 类有两个有用的方法来做到这一点：`beginning_of_day`和`end_of_day`.

对于这种情况，您有一个 Date 对象，您可以这样做：

```
Foo.where('created_at >= #{Date.today.to_time.beginning_of_day} AND 
           created_at <= #{Date.today.to_time.end_of_day}') 
```

请注意，您必须**将 Date 对象转换为 DateTime 对象**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-11-10T05:05:53.047

有范围：

```
scope :on_day, (lambda do |day|
   where(date: day.beginning_of_day..day.end_of_day)
end) 
```

使用：

```
Foo.on_day(Date.today).count 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-03T18:52:52.353

尝试`created_at >= some_day_with_00:00:00 timestamp and create_at < some_day_plus_one_with_00:00:00 timestamp`

# java - GL11.loadIdentity() GL11.Translatef() 和 GL11.Rotatef()

> ID：13689447
> 
> 赞同：2
> 
> 时间：2012-12-03T18:31:24.317
> 
> 标签：java, opengl, lwjgl

我在平移对象的位置和旋转之前使用 loadIdentity() 渲染模型和纹理。

我试图以不同的方法使用 Translatef 和 Rotatef 来旋转我的简单相机（一个角度，角色总是在中间）并且地板四边形没有移动或旋转。我试图在游戏的无限循环中操纵视图：

```
while (!Display.isCloseRequested()) {
    Display.sync(60);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glTranslatef(test, 0, 0);
    drawScene();
    processKeyboard();
    Display.update();

}

drawScene() {    
    glLoadIdentity();
    glBindTexture(GL_TEXTURE_2D,animationTexture.getTextureID());
    GL11.glPushMatrix();
    glTranslatef(ax, ay, az);
    glRotatef(rotatex, 1, 0, 0);
    glRotatef(rotatey, 0, 1, 0);
    glRotatef(rotatez, 0, 0, 1);
    glScalef(scalex, scaley, scalez);
    GL11.glCallList(this.objectlist);
    GL11.glPopMatrix();
} 
```

有没有一种方法可以编辑此代码以使我的简单视图编辑工作，或者我必须找到其他方法来设置模型位置？

编辑：问题已结束......我刚刚找到了世界上最简单的解决方案。我只需要从项目中的每个绘图类中删除 glLoadIdentity() 命令，当我仅使用 PushMatrix 时，它只会为 Push 和 Pop Matrix 命令之间的命令重置视图参数。

# git - 将提交应用于多个发布分支 - Git Rebase 或 Cherry-Pick？

> ID：13689448
> 
> 赞同：1
> 
> 时间：2012-12-03T18:31:36.233
> 
> 标签：git, cherry-pick

我正在开发一个带有 Master 分支的项目，当然：P 和随着时间的推移创建的多个发布分支。我正在使用的版本控制是 Git，我正在寻找一种方法来将在一个发布分支中进行的错误修复（例如）应用到其他分支，如果可能的话自动。IE..

```
--------------------------Master
|      |        |__v3
|      |__v2
|___v1
  |____bugfix 
```

如果我修复了 v1 中发现的错误，并且需要在 v2 和 v3 中应用相同的修复（并且仅修复），有没有办法在 Git 中方便地做到这一点？

我是 Git 的新手，但我认为我可以选择 Chery-pick 提交并应用它，但我想知道分支是否需要在层次结构中直接相关？是否可以从 v1 下的“错误修复”到 v2 和 v3 进行挑选或变基？（或 v3 到 v2 等）Afaik，rebase 将重播所有提交，所以我认为cherry-pick 是我正在寻找的，但我不确定如何实现这一点。我看到从子分支到父分支的帖子。我想做什么可能吗？

干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T19:03:21.560

如果错误修复是单个提交或一系列提交，您可以使用cherry pick。

您的错误修复将是一次提交，而 sha 是 SHA1

```
git checkout v2
git cherry-pick SHA1 
```

如果是多个commit，则查找bugfix第一次commit之前的commit sha, SHA1, bugfix SHA2的最后一次commit sha

```
git checkout v2
git cherry-pick SHA1..SHA2 
```

# php - 用php从sql表中检索xml标签

> ID：13689451
> 
> 赞同：0
> 
> 时间：2012-12-03T18:31:39.377
> 
> 标签：php, sql

我正在尝试从表中检索 xml 标签。我无法打印标签，只能打印值。

例如：

```
<product>
<item>a</item>
<price>20</price>
</product> 
```

当我尝试用 php 代码打印它时：

```
$q2 = mysql_query("SELECT * from products");
while ($rowq2 = mysql_fetch_array($q2)) {
echo $rowq2["product_xml"];
} 
```

打印件没有标签，但我想按原样打印（带有标签）。

请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:34:25.853

这是因为浏览器认为`<product>`是一个 HTML 标签而不显示它。您需要像这样使用[htmlentities()](http://php.net/manual/en/function.htmlentities.php)：

```
$q2 = mysql_query("SELECT * from products");
while ($rowq2 = mysql_fetch_array($q2)) {
    echo htmlentities($rowq2["product_xml"]);
} 
```

# c# - 使用自定义类作为键时出现“字典中不存在给定键”错误

> ID：13689453
> 
> 赞同：5
> 
> 时间：2012-12-03T18:31:53.897
> 
> 标签：c#

我有这样的代码：

```
if (CounterForEachRelatedTagDict.Select(x => x.Key).Contains(tag.Key))
   CounterForEachRelatedTagDict[tag.Key] += tag.Value; 
```

IF语句是否有可能返回true，同时`CounterForEachRelatedTagDict[tag.Key]`返回“给定键不在字典中”错误？`tag`是一个`KeyValuePair<MyClass,int>`。

`CounterForEachRelatedTagDict`像这样启动：

```
Dictionary<MyClass, int> CounterForEachRelatedTagDict = new Dictionary<MyType, int>(); 
```

`MyClass`是这样的

```
public class MyClass
{
    public string name {get;set;}
    public Guid Id { get; set; }
    ...
} 
```

在我看来这几乎是不合理的......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:41:56.113

问题是您的`Equal`和`GetHashCode`方法不同步`MyType`。

当您使用时，`CounterForEachRelatedTagDict.Select(x => x.Key).Contains(tag.Key)`您正在通过所有键执行线性搜索，`Equals`以比较您正在搜索的每个键。

当您使用`ContainsKey`in `Dictionary`、索引器或许多其他方法之一来查找密钥时，您首先使用该密钥对密钥进行哈希处理`GetHashCode`，然后它仅用于`Equals`查找该存储桶中的哪些（希望很少的对象）是相同的。

发生的事情是您有两个对象`first.Equals(second)`返回 true，但`GetHashCode`返回两个不同的值。非常重要的是，当使用对象作为 a 中的键时`Dictionary`，任何两个返回的对象`Equals`也`true`必须返回相同的整数`GetHashCode`。理想情况下，不同的对象应该尽可能返回不同的哈希码，但这并不总是可能的（具有相同哈希码的不同对象称为“碰撞”）。

请注意，这种查找键的方法，虽然它确实迫使您确保所有用作键的对象都具有合理的实现`GetHashCode`（来自的默认实现`object`很少合适），但该算法*非常*高效（使用高效的散列算法），即是什么让它值得。使用`ContainsKey`，或字典的索引器，比遍历每个键并比较它要快得多，这是您的`Select`代码需要做的，以避免使用`GetHashCode`.

所以，要回答你的问题，是的，很有可能`CounterForEachRelatedTagDict.Select(x => x.Key).Contains(tag.Key)`找到一个项目，而索引器却不能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:37:34.747

第一：您可以使用该`ContainsKey`方法而不是那个 Linq Query。

第二：您必须覆盖`GetHashCode`and `Equals`for `MyType`。这就是 Dictionary 查找和比较键的方式。

查看这些类似的问题：[Dictionary.ContainsKey return False, but a want True](https://stackoverflow.com/questions/3014945/dictionary-containskey-return-false-but-a-want-true) , [Using an object as a generic Dictionary key](https://stackoverflow.com/questions/634826/using-an-object-as-a-generic-dictionary-key-in-net)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:47:29.837

要将您的类型用作字典键，您应该重写两种方法：`GetHashCode`和`Equals`.

默认情况下（如果您不覆盖`GetHashCode`）您类型的每个对象（即使具有相同的字段值）都将返回唯一值。这意味着您将只能找到您将放入字典中的完全相同的“参考”。考虑以下两种类型：`MyType1`不覆盖`GetHashCode`and`Equals`和 MyType2 ：

```
class MyType1
{
  public MyType1(int id, string name) {Id = id; Name = name;}
  public int Id {get; private set;}
  public string Name {get; private set;}
}

internal class MyType2
{
    public MyType2(int id, string name)
    {
        Id = id;
        Name = name;
    }

    public int Id { get; private set; }
    public string Name { get; private set; }

    bool Equals(MyType2 other)
    {
        return Id == other.Id && string.Equals(Name, other.Name);
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj)) return false;
        if (ReferenceEquals(this, obj)) return true;
        if (obj.GetType() != this.GetType()) return false;
        return Equals((MyType2) obj);
    }

    public override int GetHashCode()
    {
        unchecked
        {
            return (Id*397) ^ Name.GetHashCode();
        }
    }
}

var d1 = new Dictionary<MyType1, int>();
d1[new MyType1(1, "1")] = 1;
d1[new MyType1(1, "1")]++; // will throw withKeyNotFoundException

var d2 = new Dictionary<MyType2, int>();
d1[new MyType2(1, "1")] = 1;
d1[new MyType2(1, "1")]++; // Ok, we'll find appropriate record in dictionary 
```

# php - jQuery ajax 和追加 - 内容太大？

> ID：13689455
> 
> 赞同：3
> 
> 时间：2012-12-03T18:32:05.697
> 
> 标签：php, javascript, jquery

我正在编写一个包含搜索框和“选项卡”的 ajax 搜索页面；这个想法是用户输入查询，更改选项卡，使用新选项提交查询，并在下面加载结果。

我有一个奇怪的问题，返回的数据（'内容'）的长度（？）似乎阻止我运行任何额外的 JS。

见下文，#resultsArea 旨在在用户在选项卡之间滑动时包含多组结果，因此如果查询相同，它将显示缓存的结果，而不是发送另一个不必要的数据库查询。

“内容”是返回的数据——似乎一旦我使用它（无论是在警报中，还是在页面上打印），我就无法再执行任何 javascript。如果我从 .append 函数中删除 +content+ ，则会触发该行后面的警报。这是设计使然吗？

“内容”包含大量数据 - s 和格式的负载，所以我想知道这是否是问题所在。然而，这一切都有效并按原样显示！我只想添加一些额外的 JS，这样我就可以将广告加载到呈现的结果中，但这让我很困惑。

```
$.ajax({
type: 'POST',
url: formUrl,
data: formData,
dataType: 'html',
success: function(content) {
    $('#resultsBit').slideUp(200);

    if (query!=prevQuery)
        {   
            $('#results_'+flavour).remove();
        }

    alert('I will fire');

    $('#resultsArea').append('<div id="results_'+flavour+'" style="display:true;">'+content+'</div>');

    alert('I will not fire');

    }
}); 
```

在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T16:07:04.343

> 如果我`+content+`从`.append()`函数中删除，则会触发该行后面的警报。这是设计使然吗？

这为正在发生的事情提供了一个很大的线索。这意味着内部的某些东西`content`正在导致错误（实际上引发了异常），并且可以从控制台看到此错误。

如果没有控制台，您可以将代码包装在`try { } catch`这样的块中：

```
try {
    $('#resultsArea').append('<div id="results_'+flavour+'" style="display:true;">'+content+'</div>');
} catch (e) {
    alert('Oh no, error: ' + e);
} 
```

这应该给你一个关于有什么问题的线索`content.`

# java - 将时区应用于 Date 对象

> ID：13689456
> 
> 赞同：4
> 
> 时间：2012-12-03T18:32:12.280
> 
> 标签：java, android

```
 Date now = new Date();
    Date then = new Date((long)obj.timestamp*1000);

    TimeZone tz = TimeZone.getDefault(); 
```

对java不是很熟悉，但是有没有办法将时区应用于`Date`对象？我找到[了这个](https://stackoverflow.com/questions/230126/how-to-handle-calendar-timezones-using-java)线程，但这是关于日历时区的，我认为这是不同的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:36:04.293

**`Date`对象默认使用当前时区。**如果您尝试打印特定时区的时间，您可以使用`SimpleDateFormat`如下：

```
 //put the desired format      
   DateFormat formatter= new SimpleDateFormat("MM/dd/yyyy hh:mm:ss Z");
   //set the desired timezone
   formatter.setTimeZone(TimeZone.getTimeZone("Europe/London"));

   String formattedNowInTimeZone  = formatter.format(now);
   String formattedThenInTimeZone  = formatter.format(then); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:35:05.830

使用[**SimpleDateFormat.setTimeZone(TimeZone)**](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#setTimeZone%28java.util.TimeZone%29)设置时区。

```
 SimpleDateFormat sdf = new SimpleDateFormat("yourformat");   
    TimeZone tz = TimeZone.getDefault(); 
    sdf.setTimeZone(tz);
    sdf.format(yourdate); //will return a string rep of a date with the included format 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T18:36:58.203

`Date`对象没有时区，它只是特定时刻的容器。如果要对其应用时区，则必须使用`Calendar`. 我这样做如下

```
Calendar cal = Calendar.getInstance();
cal.setTime( date ); 
```

如果您只是想显示`Date`针对时区的调整，那么您可以使用[SimpleDateFormat](http://developer.android.com/reference/java/text/SimpleDateFormat.html)应用适当的时区调整。

# javascript - 循环一个 url

> ID：13689457
> 
> 赞同：0
> 
> 时间：2012-12-03T18:32:15.170
> 
> 标签：javascript, d3.js

目前我有多个圈子，每个圈子都有自己唯一的 ID。目前，我在链接到他们的 url 页面的对象中使用了他们的唯一 ID，例如

```
var link = { 

     1:"http://174.77.29.78:3000/pages/1?"
     2:"http://174.77.29.78:3000/pages/2?"
     3:"http://174.77.29.78:3000/pages/3?"

 }; 
```

然后在我的圈子变量中，我返回了与圈子 ID 链接的对象

```
 .attr("xlink:href", function(d) { return link[d.id] ;}) 
```

你可以想象，当我最终在硬编码中放置更多页面和圈子时，链接根本不实用或有效。

有没有人举例说明如何提高效率？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:08:23.803

不确定这是否会提高效率，但它应该返回相同的结果，

```
.attr("xlink:href", function(d) { 
    return "http://174.77.29.78:3000/pages/"+d.id+"?";
}) 
```

这样您就不需要该`link`对象，并且您的 url 的公共部分只写一次

此外，如果您的网站与图片位于同一地址 (http://174.77.29.78:3000)，则您不必在每个网址中包含该部分。您只需要编写`/pages/1`部分。这样，如果您更改服务器，您就不必检查您的代码并更改每个 URL。你的链接会变成这样，

```
.attr("xlink:href", function(d) { 
    return "/pages/"+d.id+"?";
}) 
```

# mysql - 从第一个表中选择数据并将其与第二个表进行比较

> ID：13689459
> 
> 赞同：1
> 
> 时间：2012-12-03T18:32:17.483
> 
> 标签：mysql, selection

我这里有个问题，我不明白这东西是怎么工作的。所以这是交易：

```
$q= mysql_query("SELECT * FROM fruits_list, fruits_have WHERE fruits_list.fruit != fruit_have.fruit AND fruit_list.color != fruit_have.color"); 
```

表：

```
fruits_list
- fruit --- color   -
-   1    -     2    -
-   2    -     3    -
-   1    -     3    -
-   1    -     4    -
---------------------

fruits_have
- fruit --- color -
-   1   ---   2   -
-   1   ---   3   -
------------------- 
```

所以现在这个查询将从“fruits_list”中删除“fruit”中具有“1”和“color”中具有“2”、“3”的所有内容。

但我只想删除两列相等的车道。在此示例中，应从“fruits_list”中仅删除 2 条车道，结果应如下所示：

```
fruits_dont_have
- fruit --- color -
-  2    -    3    -
-  1    -    4    -
------------------- 
```

所以问题是，我应该在我的查询中改变什么？我希望我自己说得足够清楚，以便您理解。

编辑：

Ryan E - 简单地从结果中删除。

bonCodigo - 两者都是整数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:53:28.890

理想情况下，您会使用 SQL`MINUS`集合运算符，但 MySQL 尚不支持此功能。

您应该可以通过使用 WHERE 的左连接来过滤掉匹配项，但可以这样做：

```
SELECT fl.*
FROM fruits_list fl
LEFT JOIN fruits_have fh 
   ON fl.fruit = fh.fruit AND fl.color = fh.color
WHERE fh.fruit IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:57:18.407

尝试使用分隔符连接两列，然后进行如下比较：

```
 SELECT * FROM fruits_list, fruits_have 
     WHERE CONCAT_WS('@',fruits_list.fruit, fruits_list.color) !=  
               CONCAT_WS('@',fruits_have.fruit, fruits_have.color) 
```

# visual-studio - 文件/文件夹权限 Web Deploy + Amazon Elastic Beanstalk

> ID：13689460
> 
> 赞同：1
> 
> 时间：2012-12-03T18:32:25.197
> 
> 标签：visual-studio, amazon-web-services, msdeploy, amazon-elastic-beanstalk

我正在为我们的 Web 应用程序设置 Amazon Elastic Beanstalk。使用 Visual Studio Express 我无法使用 AWS 工具包，因此我必须作为 Web 部署包发布，然后将 zip 文件上传到 EB。我遇到的问题与部署中的文件/文件夹权限有关。有一个文件夹需要写权限，但是在部署应用程序时，所有文件夹都获得只读权限。在[本文](http://leethams.wordpress.com/2010/06/12/modifying-directory-permissions-with-web-deployment/)之后，我创建了一个用于部署的 .targets 文件，该文件使用 setAcl 设置文件夹的权限。但是，当我部署应用程序时，权限不会出现并且应用程序会中断。以下是我的 .targets 文件中的内容

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003"> 
<PropertyGroup>
<IncludeCustomACLs>TRUE</IncludeCustomACLs>

<AfterAddIisSettingAndFileContentsToSourceManifest Condition="$(AfterAddIisSettingAndFileContentsToSourceManifest)==''">
  $(AfterAddIisSettingAndFileContentsToSourceManifest);
  SetCustomACLs;
  </AfterAddIisSettingAndFileContentsToSourceManifest>
</PropertyGroup>

<Target Name="SetCustomACLs" Condition="'$(IncludeCustomACLs)'=='TRUE'">
<Message Text="Adding Custom ACls" />
<ItemGroup>      
  <MsDeploySourceManifest Include="setAcl"
                           Condition="$(IncludeSetAclProviderOnDestination)">
    <Path>$(_MSDeployDirPath_FullPath)\Includes\Site</Path>
    <setAclAccess>Read,Write,Modify</setAclAccess>
    <setAclResourceType>Directory</setAclResourceType>
    <AdditionalProviderSettings>setAclResourceType;setAclAccess</AdditionalProviderSettings>
  </MsDeploySourceManifest>

</ItemGroup> 
```

当我查看创建的 zip 文件并打开 archive.xml 文件时，我会在那里看到我的权限设置：

```
<setAcl path="C:\Users\Peuge\Documents\Visual Studio 2012\Projects\ProjectName\ProjectWebstie\obj\Release\Package\PackageTmp\Includes\Site" MSDeploy.path="2" isDest="AA==" MSDeploy.isDest.Type="Microsoft.Web.Deployment.DeploymentObjectBooleanAttributeValue" setAclUser="" MSDeploy.setAclUser="1" setAclAccess="Modify" MSDeploy.setAclAccess="1" MSDeploy.MSDeployLinkName="Child4" MSDeploy.MSDeployKeyAttributeName="path" MSDeploy.MSDeployProviderOptions="H4sIAAAAAAAEAE2PwU4CMRCGF4Uq6gWfYB+AbIAVNCYcCFyIQVdAPNhLtztgoWw3nRbdp9dWBJ3DP3+mnX5/g0oQBF+ufPd1deLkbSK4VqiWJvqANMqgkKrcQm6a4QI0CpX3b6N21IpazXBopbEa+jlYo5lsholNpeAPUM7VBvJ+3E6X8V23x7K4dwNxt+ZJnT/AqwOMjoB/NtFqJzLQT4VxQKz6cMXv7JFtoVow817LnUOyY9ICViqE+Pjk1AuCGXBJ/N7n8J6+oEtOE7AroCPFrUcgXQi0TIYzYzOhwk6r3aGOuwbuzp6t4Bswh+6CojBAVbqmU5DAEGjC+Iatjn2+Leg459JmgHTmLtdrjl4nThre/YQ78x/ZhxtwDojk3E2u95MpoLKaw7wsoEEOK3UvE5WJZUku/IsjoV1EpcvLb2s9SavBAQAA" /> 
```

我不确定它是否与具有我的本地目录的路径有关？

任何帮助深表感谢。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T04:17:18.527

另一种更简单的方法是使用 App_Data.ebextensions\install.config 中的 AWS 配置。

例如

```
commands:
  set_iis_log_acl:
    command: icacls "C:\inetpub\logs\LogFiles\W3SVC1" /grant IIS_IUSRS:(OI)(CI)R
    ignoreErrors: true 
```

更多信息在这里[http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-windows-ec2.html](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-windows-ec2.html)

# google-chrome - 获取最后 10 个用户的搜索

> ID：13689461
> 
> 赞同：0
> 
> 时间：2012-12-03T18:32:26.367
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-devtools, google-chrome-app

我正在编写 chrome 扩展程序，它需要从历史记录中获取最后 10 个用户的搜索。这似乎保存在用户配置文件目录中的 sqlite3 文件“历史记录”中。但是表keyword_search_terms 的格式并不明显。而且我不知道如何从扩展的代码中获取 chrome 的配置文件目录。在 Linux 上，该目录位于“~/.config/chromium/Default”，但我不知道它在不同环境中会是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:08:50.557

你不需要读取本地文件，

你可以使用[chrome.history api](https://developer.chrome.com/extensions/history.html)

一个基本的例子，

```
chrome.history.search({maxResults : 10, text: ""}, function(historyItem) {
   console.log(historyItem);
}); 
```

不要忘记在`manifest.json`.

**编辑：**是的，这仅适用于最后 10 个 URL。API 不提供该功能。

如果您想知道历史文件的位置，

```
Windows Vista or 7: \Users\_username_\AppData\Local\Google\Chrome\User Data\Default\History
Windows XP: \Documents and Settings\_username_\Local Settings\Application Data\Google\Chrome\User Data\Default\History
Mac OS X: ~/Library/Application Support/Google/Chrome/Default/History
Linux: ~/.config/google-chrome/Default/History 
```

但我不知道您将如何从外部文件中读取数据。

# mysql - 保护数据库中的mysql密码

> ID：13689465
> 
> 赞同：2
> 
> 时间：2012-12-03T18:32:32.287
> 
> 标签：mysql, database, database-design

我有以下数据库

```
`database`
id | domain        | db_user | db_pass | db_name
------------------------------------------------------
1  | domainone.com | root    | root    | domain_one

// MORE DATABASES HERE 
```

当我访问时`domainone.com`，我选择 domainone.com 的数据库信息并连接到新数据库。

问题是，我如何“保护”当前处于原始模式的密码？

**更新**

我想知道如何在数据库中存储**让您访问其他数据库**的密码。因此，据我所知，我无法散列和验证散列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:03:42.850

将您的结构更改为：

```
`database`
id | domain        | db_user | db_pass | pass_iv | db_name
------------------------------------------------------
1  | domainone.com | root    | root    | ....... | domain_one

// MORE DATABASES HERE 
```

附加列`pass_iv`将保存用于加密该特定密码的[IV 。](http://en.wikipedia.org/wiki/Initialization_vector)

[这是一些示例 PHP 代码，它以比使用 MySQL 的AES_ENCRYPT](http://dev.mysql.com/doc//refman/5.5/en/encryption-functions.html#function_aes-encrypt)函数更安全的方式进行加密和解密。

```
<?php

$mysqlPass = '12345thispassword$'; // this is the password you want to store

$key    = 'this is a secure secret key...';  // a secure secret key for encryption
$cipher = MCRYPT_RIJNDAEL_256;
$mode   = MCRYPT_MODE_CBC;

$keysize = mcrypt_get_key_size($cipher, $mode);
$ivsize  = mcrypt_get_iv_size($cipher, $mode);
$iv      = mcrypt_create_iv($ivsize);  // create random IV for encryption

$encrypted = mcrypt_encrypt($cipher, $key, $mysqlPass, $mode, $iv); // encrypt pass 
```

此时，将密码与用于加密密码的密码`$encrypted`一起插入到数据库中（插入到列中）。`$iv``pass_iv`

解密：

```
$key    = 'this is a secure secret key...';  // a secure secret key for encryption
$cipher = MCRYPT_RIJNDAEL_256;
$mode   = MCRYPT_MODE_CBC;
$keysize = mcrypt_get_key_size($cipher, $mode);

// read password info from db...this includes the encrypted pass and pass_iv

// put encrypted password into $encrypted, put pass_iv into $iv

$decrypted = mcrypt_decrypt($cipher, $key, $encrypted, $mode, $iv);
$decrypted = rtrim($decrypted, "\0");

// decrypted is now the plain-text database password. 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T18:35:55.203

您应该在将其保存到数据库之前应用散列算法。

要检查密码，只需应用相同的算法并根据存储在数据库中的哈希值检查哈希值。

确保你选择了一个好的算法和盐值！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T18:39:51.247

您可以使用 md5 加密您的密码并保存在数据库中。当您检查密码时，将输入的密码加密并与数据库中的密码进行比较。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-03T18:40:59.183

这是密码哈希在 MySQL 中如何工作的解释 - [http://dev.mysql.com/doc/refman/5.1/en/password-hashing.html](http://dev.mysql.com/doc/refman/5.1/en/password-hashing.html)

# objective-c - NSCondition vs 信号量，Objective C-ish 还有什么？

> ID：13689467
> 
> 赞同：1
> 
> 时间：2012-12-03T18:32:40.873
> 
> 标签：objective-c, ios, thread-safety

我很确定我理解 NSCondition 和信号量（来自 c api）之间的区别。Apple 开发人员，尤其是 iPhone 开发人员更常用哪一种？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T18:35:14.533

根据我的经验，“两者都不是”。无论出于何种原因，信号量的使用都不足以让人气竞赛变得很重要。

不过，我是 dispatch_semaphore 的忠实粉丝。非常巧妙的实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T19:11:15.283

dispatch_semaphore 肯定

同步对资源的并发访问的 objc 方法是避免锁定或 @syncronize（如果可能）并使用队列、串行或并发（ios5 >）

如果多个线程需要访问共享资源，它们可以分派到一个公共串行队列。通过以这种方式访问​​资源，我们避免了没有内核陷阱的并发访问。

可以使用并发队列（我认为在 wwdc11 视频中显示了这一点），例如，当多个线程可以同时访问一个资源进行读取，但我们需要一个同步点进行写入。这可以很容易地使用屏障来实现：写入线程将等待所有读取器完成，将资源独占写入并发队列，之后再次并发读取器可以访问资源。

我认为这是一个很好的资源[https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091](https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091)用于在对象方式

# ios - preferredInterfaceOrientationForPresentation 必须返回受支持的界面方向 (iOS 6)

> ID：13689474
> 
> 赞同：4
> 
> 时间：2012-12-03T18:32:58.630
> 
> 标签：ios, uiviewcontroller, ios6, autorotate

我的应用程序窗口的根视图控制器是一个子类 UINavigationController。我已将此代码添加到类中：

```
- (BOOL)shouldAutorotate
{
    return [self.topViewController shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations
{
    return [self.topViewController supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [self.topViewController preferredInterfaceOrientationForPresentation];
} 
```

在我的根 UIViewController 中，我添加了以下代码：

```
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationPortrait;
}

- (BOOL)shouldAutorotate
{
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationPortrait;
} 
```

当设备在这个视图控制器上旋转到横向时，我会展示一个模态视图控制器。当设备旋转回纵向时，我应该关闭模式视图，但是当我这样做时，我收到以下错误：

```
'preferredInterfaceOrientationForPresentation must return a supported interface orientation!' 
```

为什么我会收到此错误？

* * *

我尝试从根 UIViewController 中的 shouldAutorotate 返回 YES，现在我收到错误消息“支持的方向与应用程序没有共同的方向，并且 shouldAutorotate 正在返回 YES”。这对我来说毫无意义，因为 UIInterfaceOrientationPortrait 是应用程序支持的方向之一。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-03T19:42:56.517

在`-supportedInterfaceOrientations`中，您需要从 中返回值`UIInterfaceOrientationMask`，而不是`UIInterfaceOrientation`。特别是，它看起来像你想要的`UIInterfaceOrientationMaskPortrait`

以下是 -supportedInterfaceOrientations 的文档中关于返回值的说明：

> **返回值**
> 
> 指定支持哪些方向的位掩码。有关有效的位掩码值，请参阅“UIInterfaceOrientationMask”。此方法返回的值不能为 0。

# java - iOS 调用 [NSDate timeIntervalSinceNow] 的 Android/Java 等效项是什么？

> ID：13689475
> 
> 赞同：2
> 
> 时间：2012-12-03T18:33:10.663
> 
> 标签：java, android, iphone, ios, date

这是来自iOS的一些示例代码：

```
NSDate *startDateX = [NSDate date];

// Do a bunch of stuff

NSLog(@"Time difference: %f", -[startDateX timeIntervalSinceNow]); 
```

输出如下所示：

```
Time difference: 15.009682 
```

在 Android/Java 中执行此操作的等效方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T18:38:00.567

您可以使用[`System.currentTimeMillis()`](http://developer.android.com/reference/java/lang/System.html#currentTimeMillis%28%29)毫秒来计算：

```
long start = System.currentTimeMillis();
// Do stuff
long difference = System.currentTimeMillis() - start;
Log.v("Time difference:", String.valueOf(difference)); 
```

如果你想要更精确的东西，请使用[`System.nanoTime()`](http://developer.android.com/reference/java/lang/System.html#nanoTime%28%29). 如果你想要秒，只需除以`System.currentTimeMillis()`1000。

有一个 DateUtils 类 ( `android.text.format.DateUtils`) 可以计算相对时间差，如“5 分钟前”。如果您打算花时间做很多工作，[Joda Time](http://joda-time.sourceforge.net/)也是一个很棒的第 3 方库。

# javascript - JavaScript/Jquery 不是没有提交表单

> ID：13689479
> 
> 赞同：0
> 
> 时间：2012-12-03T18:33:29.643
> 
> 标签：javascript, jquery, html, forms

我正在开发一个 JavaScript，它检测文本中的链接并打开一个带有三个按钮“是”、“否”、“取消”的 JqueryUI 对话框。一切正常。当 javascript 检测到文本中的链接时，它会显示对话框。“否”和“取消”按钮工作正常。我想在用户单击“是”按钮时提交表单，但它不起作用。这是我的 HTML 和 Javascript 代码。

```
<script type="text/javascript">

function findUrls()
{
var text = document.forms["myForm"]["text"].value;

var source = (text || '').toString();

var urlArray = [];

var url;

var matchArray;

// Regular expression to find FTP, HTTP(S) and email URLs.
var regexToken = /\b(http|https)?(:\/\/)?(\S*)\.(\w{2,4})\b/ig;

// Iterate through any URLs in the text.
if( (regexToken.exec( source )) !== null )
{
    $(document).ready(function(){

            $( "#dialog" ).dialog({
                autoOpen: false,
                width: 400,
                buttons: [
                    {
                        text: "Yes",
                        click: function() {
                            $("#myForm").submit();
                        }
                    },
                    {
                        text: "No",
                        click: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    {
                        text: "Cancel",
                        click: function() {
                            $( this ).dialog( "close" );
                        }
                    }
                ]
            });

            $( "#dialog" ).dialog( "open" );

    });
}

}

function submitform()
{
    document.forms["myForm"].submit();
}
</script>
<div id="dialog" title="Dialog Title">
<p>Tes Test Test.</p>
<p><a href="javascript: submitform()">Submit</a></p>
</div>

<form name="myForm" id="myForm1" action="" onsubmit="return findUrls();">
<textarea name="text"></textarea>
<input type="submit" name="submit" id="dialog-link" value="Check it out." />
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:41:15.220

对于初学者来说，你`onsubmit`总是收到`undefined`. 为了在这种情况下提交表单，`findUrls()`需要返回`true`.

> JavaScript 没有 void 类型，因此每个函数都必须返回一个值。默认值未定义，但构造函数除外，其默认返回值为 this。

[http://javascript.crockford.com/survey.html](http://javascript.crockford.com/survey.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:39:41.927

您正在使用属性名称作为 id，请改用它：

```
$("#myForm1").submit(); 
```

或者：

```
submitform(); 
```

# javascript - Android + iOS 上的 CSS 过渡

> ID：13689481
> 
> 赞同：1
> 
> 时间：2012-12-03T18:33:33.193
> 
> 标签：javascript, css, cordova, webkit, transitions

我有一个很小的设置，两个 html 文件和一个 javascript 安装（http://www.fasw.ws/faswwp/non-jquery-page-transitions-lightweight/）。

这两个 html 文件中有 100% 的高度和宽度 div 和一个链接（每个链接指向另一个 html 文件以启动转换）。

该脚本似乎在启动开始时创建了两个 div，d1 和 d2，d1 设置为当前正文内容，d2 设置为目标 html 文件内容。然后 CSS 转换两个 div 以产生幻灯片效果，最后 javascript 获取 d2 内容并将其设置为 body 内容，然后再删除两个新 div。

问题是当 css 过渡开始时，字体略有变化（字符变大了一点，当我说一点时，我的意思是一点点但很明显）。过渡完成后，字体恢复正常。这会在字体上产生一种“跳跃”的感觉，当开始转换时，你会得到这个字体跳跃，然后它会跳回原来的大小。

它发生在 android 上的次数比 iOS 多得多。

我正在使用 Phonegap 运行应用程序，所以我相信网络浏览器是 webkit，Cordova。

谢谢你的帮助！！！我真的希望有人可以帮助解决这个问题。

我尝试在链接上设置过渡效果以阻止字体更改，例如 3d 设置等，我的研究表明，很多人都在谈论将这些项目放入硬件层，这样它们就不会变得模糊。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T22:45:56.877

在 android webview 中，转换是一件非常糟糕的事情。

某些版本的 android 正在创建某种截图，为图片设置动画，然后返回到真正的网络渲染器。对此您无能为力（如果您找到解决方案，请添加评论或答案）。

有时它有助于设置`preserve3d`或`translate(0,0)`进入`divs`

# c++ - 在关联容器中使用 emplace(args&& ...)

> ID：13689482
> 
> 赞同：4
> 
> 时间：2012-12-03T18:33:34.800
> 
> 标签：c++, c++11, variadic-templates, stdmap, std-pair

我正在尝试转发一些论点来进行对象的就地构造。我不太明白在关联容器中使用 emplace 背后的基本原理，或者我可能只是以错误的方式使用/思考。如果有人可以共享代码片段以供使用，那就太好了。

像 map 这样的关联容器总是存储一个类型为 pair() 的对象，并且 emplace 函数表示它将通过转发参数来调用存储的对象的构造函数（对于映射，它总是 pair ）。那么即使函数具有可变参数签名，我们是否只限于提供两个参数（键、值）？

当我将 emplace 与 boost 容器一起使用之前，我可以传递如下参数：emplace(arg1, arg2,arg3,arg4) // 其中 arg2,arg3,arg4 用于构造对象，而 arg 1 是关键。

当使用新的 gcc-4.6 和 c++11 编译时，这会中断但现在我必须做类似的事情： emplace (arg1 , myobj(arg2,arg3,arg4)); // 使相同的代码工作；

所以新的 emplace 没有像 boost 这样的分段构造？我是否仅限于为 maps 提供 2 个参数，因为对将始终为其构造函数接受两个参数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T01:27:48.520

> So the new emplace doesn't do any piece wise construction like boost ?

What you refer to a "piece wise construction" is not what the standard refers to as piecewise construction, which is:

```
m.emplace(std::piecewise_construct,
          std::forward_as_tuple<A1>(arg1),
          std::forward_as_tuple<A2,A3,A4>(arg2, arg3, arg4)); 
```

This does exactly what you want, forwarding the tuples of args to the first and second `pair` members (but be aware that with GCC 4.6 this requires an accessible copy constructor for each argument type, see [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=51183](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=51183) -- this requirement is fixed for GCC 4.7 by using delegating constructors, not supported by GCC 4.6)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-03T19:49:57.680

这确实是标准中的一个缺陷，它在[N3178](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3178.htm)中有详细说明。

去引用，

> 构造 value_type 对象的唯一方法是为 Key 和 Value、一对或后跟两个元组的 piecewise_construct_t 提供恰好两个参数。最初的 emplace() 提议将允许您指定一个 Key 值，然后为 Value 指定任意数量的构造函数参数。当我们删除可变参数构造函数来配对时，这种能力就消失了

...

> 如果要构造对象，现状是使用piecewise_construct_t。

它被[关闭为“NAD”](http://cplusplus.github.com/LWG/lwg-closed.html#2006)

# upnp - UPnP检测延迟

> ID：13689486
> 
> 赞同：8
> 
> 时间：2012-12-03T18:33:55.510
> 
> 标签：upnp, raspberry-pi, xbmc

我在 Raspberry Pi 上安装了 RaspBMC，在 Window 笔记本电脑上安装了 XBMC，在我的 Android 设备上安装了 UPnPlay。Raspberry Pi 始终处于开启状态，旨在充当系统的服务器。

涉及的 IP 地址：

*   192.168.0.18：树莓派

*   192.168.0.13：笔记本电脑

*   192.168.0.1：路由器

当我将 Android 设备连接到 WiFi 并在笔记本电脑上打开 UPnPlay 或启动 XBMC 时，之前在 Raspberry Pi 出现在设备列表中之前会有 5-10 分钟的延迟。然而，在过去的几周里，Pi 根本没有出现，除非我在其他服务（XBMC 或 UPnPlay）正在运行时重新启动它。我可以 ssh 和 sftp 到 Pi，并且可以从两个设备访问 RaspBMC 的 Web 界面，没有任何问题。

UPnP 网络发现/公告消息是否有可能以某种方式丢失或阻塞？我将如何调查这个？我对网络的了解仅限于端口转发。

我对 UPnP 替代协议的建议持开放态度 - 这是我遇到的第一个简单协议，并且在我之前的设置（桌面上的 XBMC 将媒体发送到 Apple TV）上运行良好。

* * *

编辑：

在笔记本电脑上使用 Wireshark 进行的一些分析表明，笔记本电脑的行为符合预期——通过 SSDP 定期向 239.255.255.250（我认为是多播地址）发送 M-SEARCH 和 NOTIFY 数据包。然而，RPi 不仅没有用单播数据包响应这些数据包（正如维基百科所建议的那样），而且它也没有发送任何 SSDP 数据包，除了在启动时。

总的来说，我对 Wireshark 和网络分析非常陌生，但我非常感谢您提供的任何指导或建议。

我使用的 Wireshark 过滤器是“(udp.dstport == 1900 or ip.addr == 192.168.0.18) and !(ip.src == 192.168.0.1)”，其中 192.168.0.18 是我的 RPi 的地址 - 我相信这是正确的，但是，正如我所说，我对 Wireshark 很陌生 - 如果我犯了错误，请纠正我！特别是，我假设 RPi 对 M-SEARCH 的多播响应将具有 ip.src = 192.168.0.18，但我不确定（可能是 192.168.0.1 或 239.255.255.250）

* * *

编辑2：

[在这篇文章的](http://forum.xbmc.org/showthread.php?tid=64822&pid=491931#pid491931)指导下，我运行`/sbin/route -n`并获得了以下输出。

```
pi@raspbmc:~$ /sbin/route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.0.1     0.0.0.0         UG    0      0        0 eth0
192.168.0.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0 
```

我不知道如何解释这一点，但是，从链接线程中的其他评论来看，这似乎缺少多播条目。同样，按照链接线程的建议，我运行了`sudo route add -net 239.0.0.0 netmask 255.0.0.0 eth0`，将其添加到`/etc/rc.local`，然后重新启动了 RPi - 但是，Pi 仍然没有出现在 UPnP 客户端的网络设备列表中。我还尝试使用 239.255.255.250 作为多播地址（请参阅上面的编辑 1），这给出了错误`route: netmask doesn't match route address`。

同样，在链接帖子的指导下，我运行了安装的 tshark 并运行`sudo tshark -i et0 multicast | grep 192.168.0.18`（我添加了，`grep`因为我看到网络上其他设备之间的流量很大）。

[这](http://pastebin.com/U7xj89gm)是输出。

RPi 确实会发出一组`NOTIFY`数据包，但非常不频繁（这条记录持续了将近 20 分钟，并且只发出了两个集群）。我相信`ARP`数据包如此处所述，[这](http://ask.wireshark.org/questions/5412/what-does-arp-42-who-has-19216811-tell-192168133-mean)意味着某些设备缺少网络上其他设备的 MAC 地址。尽管这可能令人担忧（某些设备不止一次要求相同的地址 - 为什么他们“忘记”这个？），也许更令人担忧的是这些数据包的发送频率很低，以及即使它们被发送的事实，网络上的客户端仍然没有拿起 RPi。

所以，总结一下：

*   RPi 正在发送`NOTIFY`数据包，但非常罕见。有没有办法控制这个？

*   即使 RPi 发出`NOTIFY`数据包（在正常的事件过程中，而不是在启动时），网络上的客户端也不会发现它的存在。

*   RPi 似乎没有响应`M-SEARCH`从其他设备发送的数据包。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T09:49:48.960

> UPnP 网络发现/公告消息是否有可能以某种方式丢失或阻塞？

输了，绝对不会。由于在任一 UPnP 节点中语音多播 UDP 的不正确实现，可能在根本没有发送的意义上被阻止。我经常在品牌认证的家庭娱乐设备中看到与 RaspBMC 类似的行为。

任何连接到 UPnP 网络的节点都必须*通告自己*：发送多播（即到地址 239.255.255.250）UDP 数据包，其内容与 HTTP 非常相似，但动作是`NOTIFY`。*RaspBMC*的这一部分显然运行良好——这就是我要求其他测试场景的原因。

然后同一个节点可以选择*发现网络*：再次发送带有 action 的多播 UDP 数据包`M-SEARCH`，但相反`NOTIFY`，它实际上等待来自其他 UPnP 节点的单播响应。*RaspBMC*作为媒体服务器不需要这样做，因为它不需要知道其他节点。但是其他节点确实需要了解网络中的服务器，并且有几件事可能是错误的：

*   XBMC/UPnPlay 不发送此多播发现（不太可能，您说 XBMC 曾经为您工作）
*   *RaspBMC*阻塞并且在第一次发现时不发送预期的单播响应，仅在稍后发现
*   XBMC/UPnPlay 不理解*RaspBMC*发送的响应并将其丢弃

> 我将如何调查这个？

在您的 Windows 笔记本电脑上，从[英特尔 UPnP 开发人员工具安装](http://opentools.homeip.net/dev-tools-for-upnp)*DeviceSpy*。它一直被认为是 UPnP 控制点的最可靠实现。如果你的*RasPi*没有立即弹出，那就是*RaspBMC*问题。它要么根本没有发送单播响应，要么响应不正确。

 **如果确实弹出，请从同一工具集中运行*Device Sniffer 。*启动 XBMC 或 UPnPPlay 并观察 UPnP 发现多播流量。如果有来自 Windows 或 Android 的预期 IP 地址的 M-SEARCH，但*RaspBMC*没有弹出，那么它是*RaspBMC*问题。不幸的是，该工具无法捕获来自*RaspBMC*的单播响应（如果有的话）

在最坏的情况下，安装**Wireshark**并将捕获过滤到*RasPi*的 IP 地址。它会告诉你它是否发送了单播响应，你可以看到内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T20:26:40.977

您可能想尝试将您的路由器与网络的其余部分断开连接（即所有其他设备可以互相看到但不能通过您的路由器） - 一些路由器“干扰”UPNP 流量。这将告诉您您的路由器是否正在丢弃或阻止 UPnP 流量。BT Homehubs 尤其是罪魁祸首。**

# c# - 从任务中的异步 HttpWebRequest 调用中捕获异常

> ID：13689493
> 
> 赞同：6
> 
> 时间：2012-12-03T18:34:12.357
> 
> 标签：c#, httpwebrequest

我将如何在下面的这种方法中捕获异常？

```
 private static Task<string> MakeAsyncRequest(string url)
    {
        if (!url.Contains("http"))
            url = "http://" + url;

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
        request.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)";
        request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        request.Method = "GET";
        request.KeepAlive = false;
        request.ProtocolVersion = HttpVersion.Version10;

        Task<WebResponse> task = Task.Factory.FromAsync(
        request.BeginGetResponse,
        asyncResult => request.EndGetResponse(asyncResult),
        (object)null);

        return task.ContinueWith(t => FinishWebRequest(t.Result));

    } 
```

我得到 404、403 等错误的具体地方是：

```
Task<WebResponse> task = Task.Factory.FromAsync(
            request.BeginGetResponse,
            asyncResult => request.EndGetResponse(asyncResult),
            (object)null); 
```

我不知道如何处理它们

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T18:47:52.003

您的错误可能发生在您的委托调用`request.EndGetResponse(asyncResult)`中。

但是，您可以使用以下方法创建任务：

```
Task<WebResponse> task = Task.Factory.FromAsync<WebResponse>(request.BeginGetResponse, request.EndGetResponse, null); 
```

这应该将任何异常传播到任务。

您可以检查`ContinueWith`委托中的错误：

```
return task.ContinueWith(t =>
{
    if (t.IsFaulted)
    {
        //handle error
        Exception firstException = t.Exception.InnerExceptions.First();
    }
    else
    {
        return FinishWebRequest(t.Result);
    }
}); 
```

或者，如果您使用 C#5，那么您可以使用 async/await 创建您的`MakeAsyncRequest`. 这将为`AggregateException`您解开异常：

```
private static async Task<string> MakeAsyncRequest(string url)
{
    if (!url.Contains("http"))
        url = "http://" + url;

    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
    request.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)";
    request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
    request.Method = "GET";
    request.KeepAlive = false;
    request.ProtocolVersion = HttpVersion.Version10;

    Task<WebResponse> task = Task.Factory.FromAsync<WebResponse>(request.BeginGetResponse, request.EndGetResponse, null);
    WebResponse response = await task;
    return FinishWebRequest(response);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:59:52.640

因此，您的任务将其状态更改为故障状态，您可以通过多种方式检查此错误：

```
// Inside method MakeAsyncRequest
Task<WebResponse> task = Task.Factory.FromAsync(
    request.BeginGetResponse,
    asyncResult => request.EndGetResponse(asyncResult),
    (object)null);

// this 'task' object may fail and you should check it

return task.ContinueWith(
   t => 
     {
        if (t.Exception != null)
          FinishWebRequest(t.Result))

        // Not the best way to fault "continuation" task
        // but you can wrap this into your special exception
        // and add original exception as a inner exception
        throw t.Exception.InnerException;

        // throw CustomException("The request failed!", t.Exception.InnerException);
     }; 
```

在任何情况下，您都应该准备好任何任务都可能失败，因此您也应该使用相同的技术来处理生成的任务：

```
// outside method MakeAsyncRequest
var task = MakeAsyncRequest(string url);

task.ContinueWith(t => 
  // check tasks state or use TaskContinuationOption
  // handing error condition and result
);

try
{
  task.Wait(); // will throw
  Console.WriteLine(task.Result); // will throw as well
}
catch(AggregateException ae)
{
  // Note you should catch AggregateException instead of
  // original excpetion
  Console.WriteLine(ae.InnerException);
} 
```

# python - Python 使用日志记录记录 SQL 错误

> ID：13689496
> 
> 赞同：0
> 
> 时间：2012-12-03T18:34:22.910
> 
> 标签：python, python-2.7

为什么名称解析错误没有被 EXCEPT 捕获？另外，我怎样才能获取错误文本并将其也扔到记录器设施中？谢谢你。

```
logging.basicConfig(filename = "{}.log".format(sys.argv[0]), level=logging.DEBUG)

def simpleLogger(something):
     try :
         something
         logging.info("Iteration fine")
     except :

         logging.warning("Something bad happened!")

 def doSometh():
     conn = psycopg2.connect(host = "1x18.249.21" , user = "tima",  dbname = "tima")
     curr = conn.cursor()
     sql = "select * from app_catalog;"

     curr.execute(sql)

     print curr.fetchall()

 def main():
    simpleLogger(doSometh())

 if __name__ == '__main__':
     sys.exit(main()) 
```

这是产生的错误：

```
conn = psycopg2.connect(host = "172.x18.249.21" , user = "tima",  dbname = "tima")
File "/apps/appeng/python-2.7.3/lib/python2.7/site-packages/psycopg2/__init__.py", line   179, in connect   connection_factory=connection_factory, async=async)
psycopg2.OperationalError: could not translate host name "172.x18.249.21" to address: Name or service not known 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:08:36.227

如果这代表您的实际代码结构，那么您实际上是在将 doSomething() 函数传递给 simpleLogger 时调用它，*而不是*传入可调用对象然后调用它；因此执行不会发生在 try/except 块中。

# asp.net-mvc - 视图中的多个强类型模型

> ID：13689510
> 
> 赞同：2
> 
> 时间：2012-12-03T18:35:20.900
> 
> 标签：asp.net-mvc

我正在尝试在 MVC 4 中创建一个“新建”页面。该页面将包含文本字段和下拉字段。我希望下拉框中列出的项目来自另一个模型。

主模型：（忽略语法，以下代码是通用示例）

```
public int MainID {get; set;}
public int location {get; set;}
... 
```

一些细节模型：

```
public int detailID {get; set;}
public int MainID {get; set;}
...
public int actionID {get; set;} 
```

行动模式：

```
public int actionID {get; set;}
public int location {get; set;}
public string action {get; set;} 
```

`SomeDetails`携带有关的附加信息，`Main`并通过使用链接`mainID`。我有兴趣为`someDetails`. 此页面的一部分将包含一个下拉菜单，`Action`该下拉菜单基于 中的`location`字段`main`。

实现下拉框的最佳方法是什么？我有一个涉及在 ViewBag 中传递可能值的解决方案，但我已经看到了这种标记为不好的做法。我也在想有可能`public int actionID {get; set;}`改成`<List>Action`. 如果执行此方法，我想我会有用于`someDetails`填充列表的构造函数？`someDetails`由于它每次都会尝试创建列表，因此在仅查看特定内容时会导致性能问题吗？

创建动作：

```
 public ActionResult Create(int id = -1)
    {
        if (id == -1)
        {
            //NOTE: INSERT REDIRECT HERE
        }
        someDetails model = new someDetails();
        model.MainID = id;
        return View(model);
    } 
```

编辑：根据要求，更好地解释业务逻辑`main model`我所展示的模型是在一个我无法更改的现有表之后建模的，因为它是位于我的控制/组之外的数据仓库的一部分。我正在创建一个允许用户添加的应用程序，`someDetails`以便更好地了解/跟踪其中一些数据。该`Action`模型仅根据位置显示可能的操作/操作ID。

我的应用程序将允许用户从模型中搜索或过滤一组项目`main`。然后他们将被允许添加`someDetails`这将打开一个表单，其中将包含一些文本字段和一个下拉列表以选择一个操作。为了获得可能的值`action`，我会做类似的事情`SELECT * FROM Action a WHERE a.location = currentLocation`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:38:09.053

只需为每个模型创建一个带有属性的 ViewModel ......并且可以在您的控制器中填充 ViewModel，然后将其传递给视图。

**编辑：对于下拉列表：**

在您的 ViewModel 中，您需要一个用于所选操作 ID 的属性，以及另一个用于列表本身的属性。

**在模型中：**

```
public int actionId { get; set;}
public SelectList ListOfActions { get; set;}
//Other model members 
```

**在视图中：**

```
@Html.DropDownListFor(model => model.actionId, Model.ListOfActions, "Select one action", new { @class = "yourclass" }) 
```

**在您的控制器中：**

```
var model = new YourViewModel();
model.ListOfActions = new SelectList(this.GetListOfActions(), "ActionName", "ActionId", [here the selected action id in case you need it]) 
```

# php - 在未启用 Javascript 的情况下按复选框过滤产品列表

> ID：13689511
> 
> 赞同：0
> 
> 时间：2012-12-03T18:35:21.390
> 
> 标签：php, yii

我正在使用 YII，并且我有一个按品牌过滤产品的复选框过滤器。

这是我的过滤器 HTML：

```
<dl class="brand-filter"> 
    <dd class="cat-text">  
        <input value="1" id="chb_1" class="brand-filter-chb" type="checkbox" name="brands[]">            
        <label for="chb_1" class="brand-filter-text" style=" display: inline-block;">Brand Name 1</label>      
    </dd>
    <dd class="cat-text">          
        <input value="2" id="chb_2" class="brand-filter-chb" type="checkbox" name="brands[]">            
        <label for="chb_2" class="brand-filter-text" style=" display: inline-block;">BRAND Name 2 </label>
    </dd>
    etc.
</dl> 
```

当用户单击复选框时，jquery 会执行 YII fn.yiiListView.update。这类似于更新我正在过滤的数据的 ajax 调用。对控制器/动作进行 Ajax 调用（在我的例子中，控制器是产品，动作是列表），参数 $brands 被传递给控制器​​/动作。

这是我的过滤器 javascript (Jquery)：

```
$('.brand-filter-chb').live('click', function(){        
    brands = $('#filter-form').serialize();     //brand names are serialized 
    $.fn.yiiListView.update(  //this updates product list by brand names
        'product-list',   //id of product list table
        {data: brands}   //serialized data send to controller/action by ajax call
    );    
}); 
```

这允许按品牌过滤产品列表。使用检查品牌名称复选框并过滤列表。用户还可以检查多个品牌名称，一切正常。但是，如果没有 Javascript，它就无法工作。

我想知道在没有 javascript 的情况下允许相同或非常相似的用户体验的最佳解决方案是什么。例如，如果未启用 javascript，用户可以仅按一个品牌过滤产品列表也是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:29:38.613

我的建议是将您的过滤器 HTML 包含在表单中，并将表单的操作设置为您用于 AJAX 过滤器的相同操作。

如果你正在考虑 SEO，那么你的表单应该使用 get 方法提交，然后你可以使用 Yii 的请求对象：

`Yii::app()->request->isPostRequest`

确定正在处理的是 AJAX 请求还是非脚本版本。

您可以将表单过滤器的提交按钮包含在几个标签中。

至于在重新加载页面之前知道选择了哪些复选框，我不完全确定没有 javascript 是否可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:50:49.847

如果你不想使用 javascript，你可以做的是创建一个

`<noscript>Please enable javascript</noscript>`

或在选中复选框后刷新页面并使用您的 php.ini 显示/隐藏元素。

# python - 大熊猫系列上的 numpy diff

> ID：13689512
> 
> 赞同：12
> 
> 时间：2012-12-03T18:35:28.120
> 
> 标签：python, numpy, pandas

我想在熊猫系列上使用 numpy.diff。这是一个错误，我说得对吗？还是我做错了？

```
In [163]: s = Series(np.arange(10))

In [164]: np.diff(s)
Out[164]: 
0   NaN
1     0
2     0
3     0
4     0
5     0
6     0
7     0
8     0
9   NaN

In [165]: np.diff(np.arange(10))
Out[165]: array([1, 1, 1, 1, 1, 1, 1, 1, 1]) 
```

我正在使用熊猫 0.9.1rc1，numpy 1.6.1。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-03T18:41:47.330

Pandas 实现`diff`如下：

```
In [3]: s = pd.Series(np.arange(10))

In [4]: s.diff()
Out[4]:
0   NaN
1     1
2     1
3     1
4     1
5     1
6     1
7     1
8     1
9     1 
```

直接使用`np.diff`：

```
In [7]: np.diff(s.values)
Out[7]: array([1, 1, 1, 1, 1, 1, 1, 1, 1])

In [8]: np.diff(np.array(s))
Out[8]: array([1, 1, 1, 1, 1, 1, 1, 1, 1]) 
```

那么为什么不起作用`np.diff(s)`呢？因为 np`np.asanyarray()`在找到`diff`. 像这样：

```
In [25]: a = np.asanyarray(s)

In [26]: a 
Out[26]:
0    0
1    1
2    2
3    3
4    4
5    5
6    6
7    7
8    8
9    9

In [27]: np.diff(a)
Out[27]:
0   NaN
1     0
2     0
3     0
4     0
5     0
6     0
7     0
8     0
9   NaN 
```

# php - WordPress 主题子菜单不显示

> ID：13689513
> 
> 赞同：1
> 
> 时间：2012-12-03T18:35:29.363
> 
> 标签：php, wordpress

我是 WordPress 新手。我正在使用 All Tuts 主题

在自定义菜单中，我添加了所有类别和子类别。我以适当的方式从上到下从左到右排列它们。子类别位于其父类别之下。我确实保存了菜单。当我刷新浏览器并将鼠标放在父类别上时，没有出现子类别。

当我看到编辑器时，菜单确实出现在一些主题功能文件中，如下所示。我只是无法理解这种代码。我需要帮助，请。谢谢。

函数.php

```
 /*******************************
     MENUS SUPPORT
    ********************************/
    if ( function_exists( 'wp_nav_menu' ) ){
        if (function_exists('add_theme_support')) {
            add_theme_support('nav-menus');
            add_action( 'init', 'register_my_menus' );
            function register_my_menus() {
                register_nav_menus(
                    array(
                        'primary-menu' => __( 'Primary Menu' ),
                        'secondary-menu' => __( 'Secondary Menu' )
                    )
                );
            }
        }
    } 
```

样式.css

```
/* TopMenu */
.ddsmoothmenu {
    position:absolute;
    left:0;
    top:6px;
    border-right:1px solid #2F2F2F;
}

.ddsmoothmenu ul li {
    float:left;
}

.ddsmoothmenu ul li a{
    display:block;
    color:#ccc;
    text-decoration:none;
    border-left:1px solid #2F2F2F;
    height:42px;
    line-height:42px;
    text-transform:uppercase;
    font-size:11px;
    padding:0 12px;
}

.ddsmoothmenu ul li a:hover {
    color:#FFFFFF;
    background:url(images/bk_top_hover.png) 50% 0 no-repeat;
} 
```

头文件.php

```
<!-- drop down top menu init -->
<script type="text/javascript">
ddsmoothmenu.init({
    mainmenuid: "topMenu", //menu DIV id
    orientation: 'h', //Horizontal or vertical menu: Set to "h" or "v"
    classname: 'ddsmoothmenu', //class added to menu's outer DIV
    //customtheme: ["#1c5a80", "#18374a"],
    contentsource: "markup" //"markup" or ["container_id", "path_to_menu_file"]
})

<?php if ( function_exists( 'wp_nav_menu' ) ){
                    wp_nav_menu( array( 
                    'theme_location' => 'primary-menu',
                    'container_id' => 'topMenu', 
                    'container_class' => 'ddsmoothmenu',
                    'fallback_cb'=>'primarymenu')
                     );
        }else{
            primarymenu();
        }?>

        <!-- End #topMenu --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:06:23.090

检查您的模板文件是否有`wp_nav_menu`这样的调用：

```
if ( has_nav_menu( 'primary-menu' ) ) {
                                    ... could be lots of args here...
                                    'menu' => 'primary-menu', 
                                    'depth'           => 1,
                                    'theme_location' => 'primary-menu')); 
} 
```

如果您想要两级子菜单，我的建议是寻找深度参数，并将其更改为 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:42:49.000

![设置菜单](../Images/c39bc74787642aca7c12e52b6e4c0873.png)

确保您将菜单设置为如上面屏幕截图所示的菜单。

# android - 在我的 android 应用程序中使用读取方法

> ID：13689519
> 
> 赞同：0
> 
> 时间：2012-12-03T18:35:45.423
> 
> 标签：android, multithreading, bluetooth

所以我创建了一个应用程序，其中有一个 GUI 类。此应用程序将在激活切换按钮时侦听来自我创建的另一个应用程序的 2 个传入字符串。我根本无法理解的是如何读取传入的字节并将它们通过我的代码传递回它们在我的 GUI 类中使用的位置。希望任何人都能够提供帮助。

当我发送我的两个字符串时，我得到两个字符串的字节，然后发送第一个，获取“％”字符串的字节，将其作为分隔符发送，然后发送第二个。

```
public void ListenForAddress(View view)
{
    on = ((ToggleButton) view).isChecked();

    if(on)
    {
        Address address = reciever.RecieveObject();
        Intent intent = new Intent(this, Screen3.class);
        String adressStr = address.Address;
        intent.putExtra("ADRESS_MESSAGE", adressStr);
        String postalcodeStr = address.Postalcode;
        intent.putExtra("POSTALCODE_MESSAGE", postalcodeStr);
        intent.putExtra("ONE", 1);
        startActivity(intent);
    }
    else
    {
        reciever.closeReception();
    }   
} 
```

如您所见，我创建了一个接收器，并调用了一个名为 RecieveObject() 的方法，该方法如下所示。

```
public Address RecieveObject() 
{
    accThread = new AcceptThread();
    accThread.start();
    return null;
} 
```

下一步是创建连接并启动管理线程的线程

```
public class AcceptThread extends Thread {

public AcceptThread() {
    BluetoothServerSocket tmp = null;
    try {
    tmp = mBluetoothAdapter.listenUsingRfcommWithServiceRecord("Server", MY_UUID);
    } catch (IOException e) { }
    mmServerSocket = tmp;
}

public void run() {
    BluetoothSocket socket = null;
    while (true) {
        try {
            socket = mmServerSocket.accept();
        } catch (IOException e) {
            break;
        }
        // If a connection was accepted
        if (socket != null) {
            mConnSock = new manageConnectedSocket(socket);
            mConnSock.read();
            try {
                mmServerSocket.close();
            } catch (IOException e) {
            }
            break;
        }
    }
}
} 
```

最后一步是处理数据的线程

```
public class manageConnectedSocket extends Thread {

public manageConnectedSocket(BluetoothSocket socket) {
    mmSocket = socket;
    InputStream tmpIn = null;

    try {
        tmpIn = socket.getInputStream();
    } catch (IOException e) { }

    mmInStream = tmpIn;
}

public Address read() {
    byte[] buffer = new byte[1024];
    int bytes; 
    Address address = new Address("", "");
    int count = 0;

    while(count<2)
    {
        try {
            bytes = mmInStream.read(buffer);

            if(count==0)
            {
                address.Address = new String(buffer);
            }
            else
            {
                address.Postalcode = new String(buffer);
            }
            buffer = new byte[1024];

        } catch (IOException e) {
            break;
        }
    }
    return address;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:24:08.290

发送地址和邮政编码时，请在它们之间发送分隔符。它可以是任何既不会出现在地址也不会出现在邮政编码中的字符，甚至是字符序列，以更加安全。例如：`!@#@!`。*您应该一次调用将数据发送到`write`.*

所以你以这种方式发送地址：

```
String data = address + "!@#@!" + postalCode;
byte[] bytes = data.getBytes();
socket.getOutputStream().write(bytes); 
```

读取地址时，您不应该调用检索地址的方法，因为它会阻塞您的线程。相反，当地址准备好时，从连接线程调用一个方法。以这种方式启动 therad：

```
manageConnectedSocket(socket).start(); 
```

在它的`run`方法中，读取字符串：

```
public void run() {
    byte[] data = new byte[1024]; //You can make this array larger, if you think it won't have enough space to contain some addresses.
    socket.getInputStream().read(data); //This may block the thread, if no data is currently available.
    String strings = new String(data);
    int seperatorIndex = strings.indexOf("!@#@!");
    String addressStr = strings.substring(0, seperatorIndex);
    String postalCode = strings.substring(seperatorIndex + 5); //5 is the length of "!@#@!".
    Address address = new Address(addressStr, postalCode);
    makeUseOfAddress(address); //Show it to the user, for example. Remember it's called from this thread, so if you want to interact with your UI, you have to run the interacting code on the UI thread and not here.
} 
```

# android - 如何处理 GCM 更改注册 ID？

> ID：13689530
> 
> 赞同：2
> 
> 时间：2012-12-03T18:36:12.720
> 
> 标签：android, android-c2dm, google-cloud-messaging

我想知道如果 GCM 服务器决定刷新应用程序先前从 GCM 服务器检索的registrationId，将如何通知应用程序/设备。目前，我保存第一个检索到的 registrationId 并将其保存在数据库中并将此 registrationId 发送到应用服务器。因此，从下次开始，App 将不再与 GCM 服务器对话。在这种情况下，App 永远不会知道 GCM 服务器是否更改了registrationId。谷歌文件提出了一些处理此案的建议，但没有提及应采取哪些步骤。来自谷歌的报价 -

> 尽管**com.google.android.c2dm.intent.REGISTRATION** Intent 通常是在应用程序发出请求后收到的，但*Google 可能会定期刷新注册 ID。所以应用程序必须随时准备处理它。*

任何建议都会有所帮助，

谢谢， SKU

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:53:50.273

旧的 reg id 会继续工作一段时间，但 Google 会在响应的 canonical_id 字段中发送一个新的以供将来使用。

# r - 使用分组/切割列的 geom_boxplot IQR 计算

> ID：13689542
> 
> 赞同：0
> 
> 时间：2012-12-03T18:37:14.887
> 
> 标签：r, statistics, ggplot2, boxplot

我想用来`geom_boxplot()`在我的数据上显示 IQR。

如果我有一个分组变量来按数据块计算 stat，我需要预先计算一个数据帧，`ddply`其中包含每个数据块的所有数据（IQR 等）？或者我可以`group=`在 geom_boxplot() 自动显示之前使用一些指令来强制计算所有统计数据吗？

我的数据结构等于这个样本，用于统计计算的分组/切割变量是`replication`：

```
dat <- read.table(textConnection("city population replication 
1 1 2500 1
2 2 3000 1
3 3 1200 1
4 1 2200 2
5 2 3100 2
6 3 1800 2
")) 
```

例如，我想显示`geom_boxplot()`复制 1 人口，然后复制 2 人口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T10:09:17.903

这是你要找的情节吗？

在这里，数值变量`replication`被转换为一个因子，为每个级别生成单独的箱线图。

```
library(ggplot2)
ggplot(dat, aes(x = as.factor(replication), y = population)) + geom_boxplot() 
```

![在此处输入图像描述](../Images/ef1952f3b076ade46e82f0009580937f.png)

* * *

如果您不转换`replication`为因子但`aes(group = replication)`用作 的参数，您将获得类似的图（带有数字 x 刻度） `geom_boxplot`：

```
ggplot(dat, aes(x = replication, y = population)) +
  geom_boxplot(aes(group = replication)) 
```

![在此处输入图像描述](../Images/e7bc651cc580a3723037d041534dab27.png)

# command-line - Jekyll 命令在每个新的终端窗口中运行

> ID：13689546
> 
> 赞同：1
> 
> 时间：2012-12-03T18:37:27.590
> 
> 标签：command-line, terminal, jekyll

当我打开一个新的终端窗口或选项卡时**，Jekyll 会自动尝试在当前目录中构建一个站点**。出于显而易见的原因，我已经卸载了 Jekyll gem，这样就不会弄乱我正在处理的任何其他项目，但该命令仍会尝试运行。我没有更改任何首选项以在新的终端窗口中运行自定义命令。我找不到触发 jekyll 命令的位置。搜索任何包含“jekyll”的文件，包括系统文件和隐藏文件，结果都是否定的。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T04:25:18.490

如果您的外壳是 bash 尝试添加

```
set -x 
```

靠近 ~/.bashrc 或 ~/.profile 或 ~/.bash_profile 的顶部。这会将您的 shell 所做的所有事情都回显到标准输出，这可能会帮助您找出问题所在。

# objective-c - NSTextField 的自定义 NSFormatter 实现

> ID：13689554
> 
> 赞同：3
> 
> 时间：2012-12-03T18:37:49.287
> 
> 标签：objective-c, cocoa, nsformatter

我对 Cocoa 开发很陌生，并且在自定义 NSFormatter 实现方面遇到了麻烦。

在我的应用程序中，我需要获取用户的输入并对其进行验证。输入格式应该是这样的：

hh:mm:ss:nn - 其中 hh（小时从 00 到 24），mm 和 ss（从 00 到 60 的分和秒），nn 是从 00 到 50 的某个数字。

如果有人知道任何一种好的来源，我可以在其中找到类似的问题示例，或者可以解释我如何解决这个问题，我将不胜感激！！！

谢谢！

# perl - 如何在 HTML::FormHandler 中创建多个字段

> ID：13689564
> 
> 赞同：2
> 
> 时间：2012-12-03T18:38:24.717
> 
> 标签：perl, catalyst

我需要在我的表单中创建复选框数组。据我了解，我必须使用`(type => 'Repeatable')`字段。我在表单类中创建了字段：

```
has_field 'userroles'       => ( type => 'Repeatable');
has_field 'userroles.idx'   => ( type => 'Checkbox'); 
```

我在构造函数中传递了角色 ID：

```
 my $form = MyApp::Form::adduser->new( 
  ml_labels         => $c->stash->{labels},
  userlang          => $c->stash->{userlang}, 
  langs_available   => [map{+{value => $_->id, label => $_->id}}@all_langs],
  userroles => [
   { idx => 5 },
   { idx => 6 },
   { idx => 7 }

  ]
 ); 
```

并尝试在模板中呈现此字段

```
 <div style="float:left">
  [% form.field('userroles').render %]
 </div> 
```

但我只有：

```
 <div style="float:left">
  <div class="hfh-repinst">
  <div>
 <label for="userroles.0.idx">Idx</label>
 <label class="checkbox" for="userroles.0.idx"><input type="checkbox" name="userroles.0.idx" id="userroles.0.idx" value="1" />

 </label>
 </div> 
```

我应该怎么做才能获得三个名为“5”、“6”、“7”的复选框？我在 H::FH 的文档中找不到答案。即使在似乎包含 [示例的页面上](https://metacpan.org/module/HTML%3a%3aFormHandler%3a%3aManual%3a%3aCookbook)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:42:31.320

我认为问题在于构造函数的参数不直接映射到“has_field”，而只是映射到“has”。所以我需要将我的用户角色传递给一些中间变量

```
 has 'userroles'            => ( is => 'rw' );

 has_field 'roles'          => ( type => 'Repeatable');
 has_field 'roles.idx'      => ( type => 'Text');
 has_field 'roles.value'    => ( type => 'Text'); 
```

然后在表单类中初始化我的字段：

```
 sub init_object{
   my $self = shift;
   my $roles = [];
   foreach my $role (@{$self->userroles}){
     push(@$roles, $role);
   }
   return { roles => $roles }
 } 
```

TT:

```
 [% form.field('roles').render %] 
```

构造函数：

```
 ...
 userroles => [
+{ idx => 5, value => 15 },
+{ idx => 6, value => 15 },
+{ idx => 7, value => 15 }
 ]
   ... 
```

结果：

```
 <div class="hfh-repinst">
  <div>
   <label for="roles.0.idx">Idx</label>
   <input type="text" name="roles.0.idx" id="roles.0.idx" value="5" />
  </div>
  <div>
   <label for="roles.0.value">Value</label>
   <input type="text" name="roles.0.value" id="roles.0.value" value="15" />
  </div>
 </div>
<div class="hfh-repinst">
 <div>
  <label for="roles.1.idx">Idx</label>
  <input type="text" name="roles.1.idx" id="roles.1.idx" value="6" />
 </div>
 <div>
  <label for="roles.1.value">Value</label>
  <input type="text" name="roles.1.value" id="roles.1.value" value="15" />
 </div>
</div> 
```

# objective-c - 在提交之前使用 Singleton 跟踪表单数据。. . 好主意？

> ID：13689565
> 
> 赞同：0
> 
> 时间：2012-12-03T18:38:27.243
> 
> 标签：objective-c, ios, xcode, design-patterns, singleton

这里是初学者-我一直在阅读单例，似乎很多人认为在大多数情况下单例是设计不佳的一个特征。

我有一个应用程序，我在其中收集用户名、密码、电子邮件等表单数据。但是，数据收集不限于单个视图控制器，也就是说，我有一个视图控制器收集一条数据，然后我推送一个新的 VC 来收集另一条数据，等等。

我的想法是创建一个单例，它可以在收集完所有数据后将所有数据提交到 Web 服务之前聚合所有数据。

我的问题是，这是对单例的适当使用吗？在这种情况下使用单例的替代方法是什么（即，我还能如何保存这些数据？这个数据收集器属于谁？）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:42:25.270

当您像字典一样移动时，您可以将它从一个控制器传递到另一个控制器。每个控制器都可以有一个名为的属性`data`，您可以随时传递它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:41:45.300

Apple 经常使用 Singelton，但正如您所读到的，它们是邪恶的。在 java 中尤其如此，在测试用例中，您再也无法删除 Singleton。

另一种方法是在启动时创建一个对象并使用它。

在 ios 上，这将位于例如 AppDelegate.m

# css - CSS 规则被覆盖

> ID：13689568
> 
> 赞同：0
> 
> 时间：2012-12-03T18:38:49.613
> 
> 标签：css

我为我的网站创建了一个照片库，在我的最新网站上，我认为我会将 CSS 和所有页面文件包含在一个子文件夹中，我认为这会更容易，因为我可以像其他网站上的插件一样使用它而不是像我过去所做的那样在主 CSS 文件中包含所有图库 CSS。

这是画廊页面：[http ://unserclosecustoms.com/gallery/gallery.php](http://unserclosecustoms.com/gallery/galleries.php)

现在的问题是，H3 画廊标题默认为 Times New Roman，而不是画廊的 CSS 文件 (h3.gTitle) 中调用的 Trebuchet。

我知道有些东西压倒了这一点，但我还不够熟练，无法弄清楚是什么。我的预感是画廊的单独 CSS 与网站的主 CSS 文件冲突。

如果我遗漏了什么，请告诉我，我会详细说明。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:46:22.147

您在声明字符集时忘记了@。尝试

```
@charset "utf-8"; 
```

该解析器错误也吞噬了样式表中的第一条规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:46:33.247

您在 gallery.css 文件中的字符集声明之前缺少该`@`字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:47:04.797

问题是由您的 gallery.css 文件中的以下行引起的：

```
charset "utf-8"; 
```

它缺少一个 @ 符号：

```
@charset "utf-8"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T18:41:59.173

把这包括：

```
<link href="css/gallery.css" rel="stylesheet" type="text/css"> 
```

后：

```
<link href="../css/ucc.css" rel="stylesheet" type="text/css"> 
```

ucc.css 中可能有一些 CSS 声明覆盖了您在 gallery.css 中的样式

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T18:46:21.303

我在你的 CSS 中没有看到你的 .gTitle 类。请看一下。;)

# php - 通过php在mysql中选择行作为列

> ID：13689577
> 
> 赞同：1
> 
> 时间：2012-12-03T18:39:44.033
> 
> 标签：php, mysql, database

您好，我正在尝试成功选择行作为 mysql 中的列。

也许有人可以帮助我。

这就是我的桌子的样子

```
+----------+----------------------------------------------------+----------+
| brand_id | brand_name                                         | linecode | 
+----------+----------------------------------------------------+----------+
| DPQT     | 1-800 Tow Truck                                    | DER      | 
| DPQT     | 1-800 Tow Truck                                    | DCF      |
| DPQT     | 1-800 Tow Truck                                    | DCA      |
| DPQT     | 1-800 Tow Truck                                    | AAA      |
| DPQT     | 1-800 Tow Truck                                    | DDD      |
| BLGR     | 1-800-Radiator                                     | Curt     |
| BGVM     | 100+ Manufacturing/Coyote                          | ASC      |
| DPQS     | 10C Technologies Inc                               | AQW      |
| DPQS     | 10C Technologies Inc                               | ASQ      |
| FDJG     | 2 Cool AirVents                                    | CAS      | 
```

我试图让结果看起来像：

```
 +----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| brand_id | brand_name                                         | Code1 | Code2 | Code3 | Code4 | Code5 | Code6 | Code7 | Code8 | Code9 | Code10 |
+----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| DPQT     | 1-800 Tow Truck                                    | DCF   | DCA   | AAA   | DDD   | DER   | NULL  | NULL  | NULL  | NULL  | NULL   |
| BLGR     | 1-800-Radiator                                     | Curt  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| BGVM     | 100+ Manufacturing/Coyote                          | ASC   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| DPQS     | 10C Technologies Inc                               | ASQ   | AQW   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| FDJG     | 2 Cool AirVents                                    | CAS   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   | 
```

如您所见，当品牌 ID 和品牌名称相同时，我想将行代码分组到单独的列中

最大行代码将是 10。这就是为什么我有 Code1-Code10

这就是我现在正在做的事情，但它不起作用。

```
$sql0 = 'set @num := 0';
$result = mysqli_query($dbh,"select brand_id,   brand_name,   
max(case when group_row_number = 1 then linecode end) Code1,   
max(case when group_row_number = 2 then linecode end) Code2,   
max(case when group_row_number = 3 then linecode end) Code3,   
max(case when group_row_number = 4 then linecode end) Code4,   
max(case when group_row_number = 5 then linecode end) Code5,   
max(case when group_row_number = 6 then linecode end) Code6,  
max(case when group_row_number = 7 then linecode end) Code7,   
max(case when group_row_number = 8 then linecode end) Code8,   
max(case when group_row_number = 9 then linecode end) Code9,   
max(case when group_row_number = 10 then linecode end) Code10 
from (  select brand_id, brand_name, linecode, @num := @num + 1 as group_row_number from linecodes_temp ) src 
group by brand_id, brand_name 
order by if(linecode = '' or linecode is null,1,0), brand_name ASC"); 
```

我得到的结果是

```
+----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| brand_id | brand_name                                         | Code1 | Code2 | Code3 | Code4 | Code5 | Code6 | Code7 | Code8 | Code9 | Code10 |
+----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| DPQT     | 1-800 Tow Truck                                    | DER   | DCF   | DCA   | AAA   | DDD   | NULL  | NULL  | NULL  | NULL  | NULL   |
| BLGR     | 1-800-Radiator                                     | NULL  | NULL  | NULL  | NULL  | NULL  | Curt  | NULL  | NULL  | NULL  | NULL   |
| BGVM     | 100+ Manufacturing/Coyote                          | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | ASC   | NULL  | NULL  | NULL   |
| DPQS     | 10C Technologies Inc                               | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | AQW   | ASQ   | NULL   |
| FDJG     | 2 Cool AirVents                                    | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | CAS    | 
```

我需要一种方法，这样一旦brand_id 和brand_name 更改，num 变量就会回到0。

正如您所看到的，它正在做我想要它做的事情，但是一旦它进入下一行，num 变量就会继续上升到下一列。那么这就是添加下一行代码的地方。我假设我需要在某些地方使用 if 语句，但我不明白该怎么做。

如果有人可以更新我的查询以便发生这种情况，我将非常感激

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:57:28.867

您说的是部分*转置*，PHP 不会自动执行。但是，您可以自己进行一些小的修改。

在您的查询中，使用[`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)：

```
SELECT brand_id, brand_name, GROUP_CONCAT(linecode) AS codes brands GROUP BY brand_id, brand_name 
```

在 PHP 中，用于[`explode()`](http://php.net/explode)获取不同的*代码*：

```
$codes = explode(',', $row['codes']); 
```

**注意：**我对您的基础表结构做了一些假设。相应地调整查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:52:44.403

```
select a.name,a.value,a.code,T.code  from test1 as a INNER JOIN test1 as T on  
a.name=T.name and a.value = T.value and a.code != T.code  group by a.name; 
```

Try this. I have assumed that your brand name and brand id are always going to be the same. If they are going to be different , they remove the check for brand names.

This one is just an idea of what the query should be . U can tweak this to get better results

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:13:52.270

编辑：如果你必须完全在 MySQL 中完成，这并不漂亮，但是......

```
SELECT 
    a.brand_id, a.brand_name, b.linecode AS code1, c.linecode AS code2, d.linecode AS code3, e.linecode AS code4, f.linecode AS code4 FROM test a 
LEFT JOIN 
    test b ON b.brand_id = a.brand_id 
LEFT JOIN 
    test c ON c.brand_id = b.brand_id AND b.linecode != c.linecode
LEFT JOIN 
    test d ON d.brand_id = c.brand_id AND d.linecode != c.linecode AND d.linecode != b.linecode
LEFT JOIN 
    test e ON e.brand_id = d.brand_id AND e.linecode != d.linecode AND e.linecode != c.linecode AND e.linecode != b.linecode
LEFT JOIN 
    test f ON f.brand_id = e.brand_id AND f.linecode != e.linecode AND f.linecode != d.linecode AND f.linecode != c.linecode AND f.linecode != b.linecode
GROUP BY 
    a.brand_id
ORDER BY 
    a.brand_id 
```

重复 LEFT JOIN 直到您有 10 个代码列。

# c++ - C++图像比较每个块中的平均位数

> ID：13689584
> 
> 赞同：0
> 
> 时间：2012-12-03T18:39:58.993
> 
> 标签：c++, c, algorithm, opencv

我正在使用 OpenCV 库编写图像比较应用程序。我正在使用基本块匹配方法

如何提取每个块中的位数

考虑这是一张图片

16x16 像素

```
--------------
+            +
+            +
+            +
+------------+ 
```

块大小 = 8x8 像素

```
--------------
+      |     +
+------------+
+      |     +
+------------+ 
```

我的程序：

1）读取两个图像
2）将它们转换为灰度
3）将图像划分为块的数量
4）块进行比较
5）在输出中打印相似性百分比

我的函数比较图像中块的每个像素

```
 float imCompBMA(float **b1, float **b2, float h, float w){
    float percent;
    int i, j, counter=0;

    for(i=0;i<h;i++){
        for(j=0;j<w;j++){
            // If both blocks have the same value at pixel (i,j)
            //this line has to be improved
            if(b1[i][j]==b2[i][j]){
                counter++;
            }
        }
    }

    // Percent is the number of same pixels to the total number of pixels
    percent=(float)(counter/(h*w))*100;
    return percent;
} 
```

那么如何通过比较每个块中的平均位数来改进它

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:45:44.487

如果您正在寻找一个块中的所有位都相同，那么您不可避免地必须读取每个块中的所有位！

如果您尝试比较真实图像，这可能不是最好的方法。即使两个原始图像一开始是相同的，在大多数包中加载和保存也会使个体变得很小但会发生变化（因为它们被转换为不同的颜色空间并返回），当然，像 jpeg 这样的格式保存会改变所有的位。

编辑：如果您只想计算位，则获取一个指向一行像素块的 int（或 long 或 longlong）指针并计算该 int 中的位 - 请参阅[k&r bitcounter](http://code.google.com/p/k-and-r-exercises/source/browse/2-9.c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:49:21.460

如果您的目标是对**图像进行比较而不是“块匹配”，我建议您**[在 Opencv templateMatching 上](http://docs.opencv.org/doc/tutorials/imgproc/histograms/template_matching/template_matching.html)查找解释。

# ruby-on-rails-3 - 具有多种用户类型的 rails 应用程序

> ID：13689585
> 
> 赞同：0
> 
> 时间：2012-12-03T18:40:03.143
> 
> 标签：ruby-on-rails-3, design-patterns, database-design, web-applications

我正在与多种类型的用户一起开发 ruby​​ on rails 应用程序。所有用户将共享电子邮件地址和密码的基本属性，以及 created_at 和 updated_at 的时间戳字段。其他字段对于用户类型是唯一的（想想员工、供应商、经理等）。我一直在研究单表继承，但这似乎不是正确的模式。另一种选择似乎是拥有一个拥有其他模型之一的用户模型。一个用户也可以有多种类型，即。员工和经理可以是同一个用户。我还想根据用户的类型将用户引导到登录时的特定页面。这最好通过路由器中的约束或登录时的大型 switch 语句来完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:06:36.363

您可能需要定义用户角色。我建议[CanCan](https://github.com/ryanb/cancan)管理您的角色和访问权限。

在单个表上实现不同字段的一种方法是使用 Postgres 中的 NoSQL (hstore)。这是一个简单的[入门教程](http://schneems.com/post/19298469372/you-got-nosql-in-my-postgres-using-hstore-in-rails)。

[这](http://blog.rawonrails.com/2012/02/using-activerecordstore-with-rails-32.html)是在 Rails 3.2+ 中使用它的示例

# ios - 用户升级 iPhone 时是否传输 NSDocumentDirectory 中的文件

> ID：13689589
> 
> 赞同：0
> 
> 时间：2012-12-03T18:40:20.430
> 
> 标签：ios, nsdocumentdirectory

我有一个将用户输入的信息保存到 NSDocumentDirectory 的应用程序。人们遇到的问题是，当他们将 iPhone 升级到 iPhone 5 时，他们旧的 NSDocumentsDirectory 中的信息不会被传输过来，即使他们选择了要传输的应用程序也是如此。

用户在升级时最终会丢失所有输入的数据。

当用户在同一部手机上升级应用程序时，他们不会丢失数据。只有当他们升级到新 iPhone 时才会发生这种情况。

如何正确保存用户数据并确保在手机升级时将其传输过来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:55:30.460

只有当他们选择对旧设备进行完整备份，然后选择将该完整备份恢复到新设备时，数据才会传输到新设备。简单地传输应用程序会导致全新安装的应用程序没有数据。

这一直是 iTunes（以及现在的 iCloud 备份）的主要问题。无法备份单个应用程序及其数据，也无法恢复单个应用程序及其数据。除非完成完整的设备恢复，否则只能恢复应用程序，但不能恢复数据。

我所有的应用程序都有自己的内置功能，用于备份和恢复自己的数据。这使用户可以轻松地在设备之间传输数据或处理他们错误地弄乱自己的数据。

# android - 应用程序未在 google play 应用程序中显示，但通过网络浏览器显示

> ID：13689590
> 
> 赞同：1
> 
> 时间：2012-12-03T18:40:22.923
> 
> 标签：android, google-play, publishing

是否有人在通过 Android 设备在 Google Play 上查看他们的应用时遇到问题？我们平均每天有 20 - 30 笔销售，而两天前的销售就消失了。（每天 1 -2 次）。搜索应用程序时，它会通过网络浏览器显示，但不会在我们拥有的任何设备上显示。

我们取消发布、重新发布、检查所有设置等等。

我们在 2 天前上传了一个新应用程序，这是我们可以通过设备上的 google play 应用程序看到的唯一应用程序。有什么想法或想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:43:51.747

也许您无意中将分发设置设置为不允许某些操作系统版本的设备。这将导致应用程序显示在网络上（并不总是根据您注册的设备进行过滤）。

如果某些设备不支持您的应用，则它不会显示在设备本身的搜索中。

最重要的是，仔细检查您的设置 - 我的应用在网络或设备上显示时没有任何问题（并且我看到了正常的预期下载率）。

# android - 永久保存个性化类型的 ArrayList 的最佳方法

> ID：13689591
> 
> 赞同：0
> 
> 时间：2012-12-03T18:40:31.933
> 
> 标签：android, arraylist, sharedpreferences

我有一个 Persons 的 ArrayList `(ArrayList<Person>)`，我想将该 ArrayList 存储在持久数据类型中。SharedPreferences 是一种解决方案，但它只是在操纵 String、int、float`... 变量。你有什么想法吗？非常感谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:48:18.710

更简单的是使用 java `Serialisation`。

你只需要一个 Persons 类：

```
public class Persons {

  ArrayList<Person> personList;
} 
```

然后只需使用

```
// init Persons
Persons person = new Persons();
// add some
persons.personList.add(new Person());

// write out
ObjectOutpuStream oos = new ObjectOutputStream(new BufferOutputStream(new FileOutputStream("personsDB.ser")));

oos.writeObject(persons);
oos.close(); 
```

回读

```
ObjectInputStream ois = new ObjectInputStream(new BufferedInpuStream(new FileInpuStream("personsDB.ser")));
persons = (Persons) ois.readObject();
ois.close();
// ready! Java does that all for you; since Persons is one object which contains something 
```

缺点是在写入过程中会丢失电池电量。有些人先写入一个临时文件，删除旧文件并重命名为正确的文件名。

为了获得高性能（更少的空间，更快）你可以使用`DataOutputStream`，但是你必须自己编写所有字段（但这也很简单）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:41:55.037

我会将`Person`数组中的每个存储为 SQLite 数据库中的一行。当您想将其读回程序中时，每一行都将成为`Person`数组中的一个对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:47:29.770

您必须使用数据库或将 json 响应写入文件并从文件中读取

# javascript - 与非 js 用户打交道 - 在页面呈现之前将元素设置为 display:none / opacity:0

> ID：13689593
> 
> 赞同：0
> 
> 时间：2012-12-03T18:40:49.517
> 
> 标签：javascript, jquery

我没有从一个正常的页面开始，然后在上面构建 js 功能，我做了一些 Web 开发的失礼。我正在重新开发的网站是一个旧网站，里面有很多漂亮的 jquery 动画。

我费了很大力气来确保所有页面加载都可以使用或不使用 ajax 来处理，但我刚刚意识到这完全没有意义，因为初始页面加载会产生几个元素，这些元素使用`display:none;`or的属性加载`opacity:0;`并且动画在文档准备好时可见

我非常想纠正这个问题，但我首先这样做有几个原因：

1：在jquery插件启动之前隐藏一闪而过的无样式菜单。（我将用非js菜单替换它并在jquery菜单中添加动画来解决这个问题）

2：另一个原因是我喜欢页面加载时的初始动画，最好保留它。但这提出了一个问题，因为我希望页面的大部分对 js 用户不可见，而对非 js 用户在加载时可见，但是如何确保在页面呈现之前更改我的元素 css 属性 - 我已经尝试过这与 jquery 但当 jquery 库已加载（没有缓存）时，我的页面已经呈现，所以内容在被隐藏和动画回来之前闪现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:49:19.270

此块仅对关闭 JS 的用户可见。

```
<noscript>html code here</noscript> 
```

你可以像这样添加一些样式：

```
<noscript>
    <style>
        #content{
            background: red;
        }
    </style>
</noscript> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:54:54.707

您可以在 中添加以下内容`<head>`：

```
<script>document.documentElement.className+='js'</script> 
```

然后，您可以使用元素`js`上的类`html`f.ex 以不同的方式设置启用 javascript 的浏览器的样式：

```
html .animate{opacity:1} /* all browsers */
html.js .animate{opacity:0} /* js-enabled browsers */ 
```

该类已添加到 中`head`，因此 DOM 的其余部分没有闪烁。

您也可以使用`noscript`标签，但我个人认为这更简洁，因为您可以在单个样式表中管理样式。

# rendering - 使用renderDefinition.ItemId以编程方式将站点核心渲染复制到新模板？

> ID：13689602
> 
> 赞同：6
> 
> 时间：2012-12-03T18:41:25.973
> 
> 标签：rendering, sitecore, sitecore6, sublayout

我有一个自定义站点核心按钮，它可以更改当前项目的模板，非常简单。

但是，作为其中的一部分，我还尝试将旧布局的渲染迁移到新布局（如果它属于某个子布局类型）`ItemId`。但是`ItemId`返回的总是空的，我从返回的唯一值`RenderingDefinition`是`UniqueId`.

我究竟做错了什么？

我已[将此博客文章](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2011/09/Programmatically-Update-Layout-Details-with-the-Sitecore-ASPNET-CMS.aspx)用作指南。

**编码**

```
public class ConvertToNewTemplateCommand : Command
{
protected void Run(ClientPipelineArgs args)
{
    if (!SheerResponse.CheckModified())
        return;

    Item item = Context.ContentDatabase.Items[args.Parameters["id"]];
    if (args.IsPostBack)
    {
        if (args.Result == "yes")
        {
            //Get current layout details
            var originalLayoutXml = item[FieldIDs.LayoutField];

            //Get new template
            TemplateItem hubTemplate = Context.ContentDatabase.GetTemplate("some guid...");
            //Change template  
            item.ChangeTemplate(hubTemplate);
            //Reset laytout
            ResetLayout(item);
            //Get reset layout
            var newLayoutXml = item[FieldIDs.LayoutField];

            //Add all the module containers to the new layout in the central column
            MoveModuleContainers(item, originalLayoutXml, newLayoutXml);
        }
    }
}

private void MoveModuleContainers(Item item, string oldXml, string newXml)
{
    var oldLayout = LayoutDefinition.Parse(oldXml);
    var newLayout = LayoutDefinition.Parse(newXml);

    bool updated = false;

    var oldRenderings = (oldLayout.Devices[0] as DeviceDefinition).Renderings;
    var newRenderings = (newLayout.Devices[0] as DeviceDefinition).Renderings;

    foreach (RenderingDefinition rendering in oldRenderings)
    {
        // Here is where the rendering.ItemID is always null
        if (rendering != null && !String.IsNullOrEmpty(rendering.ItemID) && new Guid(rendering.ItemID) == new Guid("matching guid..."))
        {
            rendering.Placeholder = "middlecolumn";
            newRenderings.Add(rendering);
            updated = true;
        }
    }

    if (updated)
    {
                   // Save item...
            }
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:30:39.950

最后我得到了[Sitecore 支持](http://support.sitecore.net)，它告诉我应该使用：

```
Sitecore.Data.Fields.LayoutField.GetFieldValue(item.Fields[Sitecore.FieldIDs.LayoutField]) 
```

代替：

```
item[FieldIDs.LayoutField] 
```

正确获取物品`layoutField`。这导致渲染值被正确解析，正如他们所说，其余的都是历史。

# computer-science - 斯坦福 CS 193P 的新 XCode 存在问题

> ID：13689603
> 
> 赞同：0
> 
> 时间：2012-12-03T18:41:36.067
> 
> 标签：computer-science, xcode4.5, cs193p

我正在学习斯坦福大学 2011 年的 CS 193P 课程，但大部分代码都不起作用。当我更新到新的 XCode 时，我编写的所有按钮都没有工作，并且今天尝试实现滚动视图很有趣。有什么办法可以恢复到旧的 XCode 或我应该知道的一些解决方法，这样我至少可以跟着课程学习？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T22:34:56.137

iBookstore 上有一本来自斯坦福的免费 iBook，它补充了 iOS 6 和 XCode 4.5 的课程材料：[Editor's Cut 网页](http://editorscut.com/Books/003ipadiphone/003ipadiphone-details.html)

这不是同一位作者，做事的顺序也有所不同，但写得很好，有动画演练，并且很好地解释了发生了什么变化以及为什么发生了变化。比在学习新技术时尝试自己找出版本差异要容易得多。当然，作为 iBook，它只能在 iOS 设备上查看，而且只有在 iPad 上才有用。

# javascript - JQuery's ajax function stripping HTML tags from XML

> ID：13689605
> 
> 赞同：1
> 
> 时间：2012-12-03T18:41:42.667
> 
> 标签：javascript, jquery, html, xml, ajax

Okay, I'm pulling data from an XML file to populate my elements of my webpage dynamically. My problem is that when I use JQuery .ajax to pull the xml file, it strips my HTML tags.

For example,

**Data in XML file:**

```
<transcript><p>Hello, world</p></transcript> 
```

**Desired output on webpage:**

```
<p>Hello, world</p> 
```

**Actual output:**

```
Hello World 
```

Here is my code inside of my ajax function:

```
$(xmlData).find('item').each(function() {
        var n = $(this).find('transcript').text(); 
```

I've tried to use JQuery's '.html()' but it returns null. What is the *simplest way* I can fix this? Preferably without changing too much of what I've already done.

Thanks in advance.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:53:21.910

Using `text` will strip the tags as you experienced. You can instead use the jQuery `children` method ([reference](http://api.jquery.com/children/)) on the transcript node to get the HTML. Here is a working example: [http://jsfiddle.net/gjwyd/](http://jsfiddle.net/gjwyd/)

```
$(document).ready(function() {
    $.ajax({
        type: "POST",
        url: "/echo/xml/",
        dataType: "xml",
        data: {
            xml: "<transcript><p>Hello, world</p></transcript>"
        },
        success: function(xml) {
            var container = $('#content');
            var html = $(xml).find('transcript').children();
            container.html(html);
        }
    });
});​ 
```

The key is this line:

```
var html = $(xml).find('transcript').children(); 
```

And being sure to set the dateType as xml.

# Issues

When taking HTML from an XML response it may be missing the default styles. For example, a paragraph tag may not have `display: block`. Resetting the styles may be one way around this issue. A more correct and probably easier way would be to put the HTML content inside of CDATA within the XML as one of the other commenters suggested.

[http://jsfiddle.net/tZJQp/](http://jsfiddle.net/tZJQp/)

```
$(document).ready(function() {
    $.ajax({
        type: "POST",
        url: "/echo/xml/",
        dataType: "xml",
        data: {
            xml: "<transcript><![CDATA[<p>Hello, world</p><p>Bye</p>]]></transcript>"
        },
        success: function(xml) {
            var container = $('#content');
            var html = $(xml).find('transcript').text();
            container.html(html);
        }
    });
}); 
```

As others note, `html` won't work on XML.

# google-app-engine - 自定义域的后端实例

> ID：13689611
> 
> 赞同：1
> 
> 时间：2012-12-03T18:42:05.473
> 
> 标签：google-app-engine

我无法在自定义域中访问我的后端实例。

例如，我有一个应用程序，并且我在以下位置成功访问了普通实例：

http://www.[my_app_id].appspot.com**或**http://[my_app_id].appspot.com

而且我有一个后端配置 name=test 并且我在以下位置成功访问了后端实例：

http://test.[my_app_id].appspot.com

在管理界面中，“实例”链接分别显示后端和普通实例的实例。内容展示是一样的，但是很容易看出什么时候请求去后端实例，什么时候去普通实例。

* * *

然后我在 Google Apps 中配置了通配符“test”，以通过自定义 URL 访问我的后端实例：

我继续在以下位置成功访问正常实例：

http://www.[my_domain].com**或**http://[my_domain].com

但要求在

http://test.[my_domain].com

重定向到普通实例而不是后端实例。

医生说它应该可以工作，但我现在不能，我需要使用自定义域，因为我的应用程序是多租户的。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T12:27:29.607

据我了解，您的支持确实应该由前端访问。

因此，当您的应用程序前端向其后端发出请求（例如通过 URL）时，它会像在内部完成一样工作。

您是否将后端设置为可公开访问？

[https://developers.google.com/appengine/docs/python/backends/overview#Public_and_Private_Backends](https://developers.google.com/appengine/docs/python/backends/overview#Public_and_Private_Backends)

> 默认情况下，后端是私有的，因为它们通常充当应用程序内部的组件，而不是充当其公共面孔。应用程序管理员、应用程序实例以及 App Engine API 和服务（例如任务队列任务和 Cron 作业）无需任何特殊配置即可访问私有后端。后端并非主要用于面向用户的流量，但您可以公开后端以进行测试或与外部系统交互。

我不知道为什么重定向不起作用，但也许您应该修改您的问题以显示您在此处尝试解决的问题并得到答案？

# python - 使用 Django 模型的应用程序需要是 Django 应用程序吗？

> ID：13689617
> 
> 赞同：0
> 
> 时间：2012-12-03T18:42:25.973
> 
> 标签：python, django

Django 应用程序的定义是什么？任何使用 Django 功能的应用程序，例如 orm 和 url-view 映射？

我问是因为我有一个包含 2 个子组件的组件：一个 Web 服务服务器和一个独立的应用程序。Web 服务服务器使用 Django 视图将 url 映射到请求处理程序。Web 服务服务器和应用程序使用 Django 模型和由 Django 管理的数据库。Web 服务服务器显然需要是一个 Django 应用程序。独立应用程序也必须是 Django 应用程序？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:45:43.033

不，只要您安装并正确配置了 Django，导入您的模型就足够了。

# internet-explorer-8 - 边框半径和 IE 7 和 IE8

> ID：13689618
> 
> 赞同：0
> 
> 时间：2012-12-03T18:42:28.757
> 
> 标签：internet-explorer-8, internet-explorer-7, css3pie

我在我的布局上应用了边框半径，但我遇到了 IE 7 和 IE8 的问题。我正在使用 PIE.htc 但我仍然无法进行兼容性工作。

代码是：

```
border-top-left-radius: 4px;
border-top-right-radius: 4px;
border-top: 0;          

-moz-border-top-left-radius: 4px;
-webkit-border-top-left-radius: 4px; 
behavior: url(PIE.htc); 
```

我在ieTester中测试，谁能帮帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:02:27.970

1.  如果您使用`behavior: url(PIE.htc);`，那么您`Pie.htc`应该与您的 html 页面或母版页位于同一文件夹中。

2.  您页面的文档类型应该是 XHTML 或 HTML5。

3.  那么我的经验表明，最好将行为代码放在你的 CSS 规则之上。

4.  您最好不要将 IE Tester 用作值得信赖的实用程序。它想出了一个充满工具但不是很有用的工具。最好使用 IE 9，然后在其开发人员工具中更改其浏览器和文档模式。当您更改它们时，整个页面将在该模式下重新加载。它甚至具有怪异模式，这是一个完整的噩梦。

    如果您可以使用有关您的代码和浏览器的更多事实来更新您的问题。

# visual-studio-2010 - 使用带有 svn 的 Visual Studio 建模项目时发生冲突

> ID：13689621
> 
> 赞同：1
> 
> 时间：2012-12-03T18:42:44.570
> 
> 标签：visual-studio-2010, svn, uml

我的项目团队目前正在使用 Visual Studio 2010 为中型软件开发一个建模项目。我们使用 AnkhSVN 进行源代码控制。我们不是同时编辑文件，我们只编辑同一个项目中的不同文件。

**可悲的是，在每次提交之后，一个以.uml**结尾的文件中存在很多冲突，该文件位于一个名为**ModelDefinition**的文件夹中。每当整个解决方案中的任何图表发生更改时，该文件似乎都会更改。

如果我们将此文件放在 SVN 忽略列表中，这样我们就可以同时处理建模项目，subversion 中的所有文件都显示为空白文件。

有没有办法解决这个困境，所以我们可以使用 SVN 同时编辑我们的建模项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T12:46:35.863

MSDN 有[关于](http://msdn.microsoft.com/en-us/library/dd574364)共享建模项目的说明。基本上，您必须将建模元素组织到 UML 模型资源管理器中的包中。如果将元素放入不同的包中，它们也会被放入不同的 .uml 文件中。

我发现重组现有图表的最快方法是在模型资源管理器中创建一个新包，设置要移动到新包的图表的 Linked Package 属性，选择图表中的所有内容，复制它，删除它，然后再次粘贴。

# python - 是否有与 Memcpy 等效的 Python

> ID：13689628
> 
> 赞同：5
> 
> 时间：2012-12-03T18:42:56.127
> 
> 标签：python, c, memcpy

我正在尝试移植一些 C 代码，但由于我尝试使用 ctypes 的 memcpy （没有工作），我真的陷入了困境。我希望找到一种使用 memcpy 等效功能的 python 方式

有任何想法吗

这是我尝试移植的 C 代码示例

```
i = l + 5;
t = htons(atoi(port));
memcpy((buf+i), &t, 2); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T19:10:44.653

您几乎可以肯定不需要调用`htons`然后将 2 个字节复制到缓冲区中 - 请参阅 Keith 的答案以了解原因。

但是，如果您*确实*需要这样做（也许您正在制作 IP 数据包以与捕获的有线数据包进行比较作为测试或其他东西？），您可以。

首先，如果您使用的是 a `bytearray`（或任何其他符合可写缓冲区协议的东西），您只需使用普通的`list`-style 切片分配：

```
# like C's memcpy(buf+i, foo, 2)
buf[i:i+2] = foo 
```

你没有那个两字节的字符串`foo`；你有一个短整数。在 C 语言中，您可以将其转换为指向两个字节的指针，只需使用`&`运算符获取其地址，但 Python 无法做到这一点。幸运的是，有一个标准库模块[`struct`](http://docs.python.org/3/library/struct.html)专门为这种事情而设计：

```
t = socket.htons(int(port))
buf[i:i+2] = struct.pack('h', t) 
```

或者，因为`struct`可以为您处理字节序：

```
t = int(port)
buf[i:i+2] = struct.pack('!h', t) 
```

但是，通常您甚至不需要缓冲区复制；您可以在内部一次定义整个结构`struct`。例如，如果您尝试将 IP 地址和端口打包到 6 字节数组中，您可以这样做：

```
buf = bytearray(6)
i = 0
addrbytes = [int(part) for part in addr.split('.')]
buf[i:i+4] = struct.pack('4B', addrbytes[0], addrbytes[1], addrbytes[2], addrbytes[3])
i += 4
portshort = int(port)
buf[i:i+2] = struct.pack('!h', portshort) 
```

但这要简单得多：

```
addrbytes = [int(part) for part in addr.split('.')]
portshort = int(port)
buf = struct.pack('!4Bh', addrbytes[0], addrbytes[1], addrbytes[2], addrbytes[3], portshort) 
```

我刚刚定义了一个按网络顺序排列的结构，四个字节后跟一个短字节，并将我的数据打包到其中。

最后要提到的一件事：如果你真的想使用 C 风格的代码来处理 C 风格的变量，[ctypes](http://docs.python.org/3/library/ctypes.html)模块是另一种选择。它是专门为与 C 代码交互而设计的，所以一般来说它是非常低级的（并且是标准库中唯一可以让您的代码段错误的模块），但它可以让您构建一些看起来更漂亮的中级东西像C：

```
class ADDRPORT(ctypes.BigEndianStructure):
    _fields_ = [("addr", ctypes.c_char*4),
                ("port", ctypes.c_short)]

addrport = ADDRPORT(addrbytes, portshort) 
```

由于您的 C 代码正在逐步填充缓冲区，而不是设置 a 的元素`struct`，因此这可能不是您想要的。但值得注意的是，因为它可能会在某个时候成为你想要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T18:56:00.563

看起来您正试图从用户输入或字符串中获取端口号。

在 Python 中：

```
port = int(port) 
```

然后您可以将其直接传递给套接字实例：

```
socket = socket.socket(("127.0.0.1", port)) 
```

Python`htons`为您进行翻译。您只需将地址作为字符串和整数的元组提供给套接字（在 TCP 的情况下）。

# android - 每次更改后重置editText的值

> ID：13689630
> 
> 赞同：0
> 
> 时间：2012-12-03T18:43:00.740
> 
> 标签：android, android-edittext, textwatcher

我希望`editText`在该行之后将 的值设置为 null:`new nwcomm.execute(cmd,cmd1)`这样我就可以在我在键盘上按下它们时发送键。我试过`keyboard.setText(null);`了，但它不起作用。我该怎么办？

```
keyboard.addTextChangedListener(new TextWatcher() {
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        // TODO Auto-generated method stub
        String stt="key_";
        String key=keyboard.getText().toString();
        String cmd=stt+key;
        new nwcomm().execute(cmd,cmd1);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:44:34.460

您应该使用[afterTextChanged](http://developer.android.com/reference/android/text/TextWatcher.html#afterTextChanged%28android.text.Editable%29)而不是`onTextChanged`我链接的文档。这应该可以解决您清除`TextView`;的问题。但是，您必须小心不要陷入无限循环。您必须添加对空字符串的检查，例如

```
keyboard.addTextChangedListener(new TextWatcher(){
    public void afterTextChanged(Editable s) {
        // TODO Auto-generated method stub
        String key = s.toString();
        if ( key.isEmpty() )
            return;
        String stt="key_";
        String cmd=stt+key;
        new nwcomm().execute(cmd,cmd1);
        s.clear();
} 
```

那应该是诀窍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:49:47.930

每当您想重置 edittext 值时，请使用 editText.setText("");

# c# - 有没有办法根据坐标获取地名？

> ID：13689631
> 
> 赞同：4
> 
> 时间：2012-12-03T18:43:14.757
> 
> 标签：c#, geolocation, coordinates, windows-store-apps, bing-maps

给定一个位置的坐标，有没有办法得到地名？

我不是指地址，我指的是地点的“标题”，例如：

```
Coordinates: 76.07, -62.0 // or whatever they are
Address: 157 Riverside Avenue, Champaign, Illinois
Place name: REO Speedwagon's Rehearsal Spot 
```

-或者：

```
Coordinates: 76.07, -62.0 // or whatever they are
Address: 77 Sunset Strip, Hollywood, CA
Place name: Famous Amos Cookies 
```

那么是否有反向地理编码网络服务或我可以调用的东西，例如：

```
string placeName = GetPlaceNameForCoordinates(76.07, -62.0) 
```

...这将返回“Wal*Mart”或“Columbia Jr. College”或任何合适的？

我找到了对其他语言的引用，例如 java 和 ios（我猜是目标 C），但没有专门针对如何在 Windows 商店应用程序中使用 C# 执行此操作...

## 更新

我已经有了这个来获取地址（改编自 Freeman 的“Metro Revealed：使用 XAML 和 C# 构建 Windows 8 应用程序”第 75 页）：

```
public static async Task<string> GetStreetAddressForCoordinates(double latitude, double longitude)
{
    HttpClient httpClient = new HttpClient();
    httpClient.BaseAddress = new Uri("http://nominatim.openstreetmap.org");
    HttpResponseMessage httpResult = await httpClient.GetAsync(
        String.Format("reverse?format=json&lat={0}&lon={1}", latitude, longitude));

    JsonObject jsonObject = JsonObject.Parse(await httpResult.Content.ReadAsStringAsync());

    return string.format("{0} {1}", jsonObject.GetNamedObject("address").GetNamedString("house"),
                                    jsonObject.GetNamedObject("address").GetNamedString("road"));
 } 
```

...但我在他们的文档中看不到地名；他们似乎提供房屋、道路、村庄、城镇、城市、县、邮政编码和国家，但没有提供地名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T04:56:36.097

I usually store the latitude/longitude coordinates and then use GMaps to look up the location, then "on a best effort basis" - look up the place's name using the address - again via Google Maps.

```
static string baseUri = 
  "http://maps.googleapis.com/maps/api/geocode/xml?latlng={0},{1}&sensor=false";
string location = string.Empty;

public static void RetrieveFormatedAddress(string lat, string lng)
{
    string requestUri = string.Format(baseUri, lat, lng);

    using (WebClient wc = new WebClient())
    {
        string result = wc.DownloadString(requestUri);
        var xmlElm = XElement.Parse(result);
        var status = (from elm in xmlElm.Descendants() where 
            elm.Name == "status" select elm).FirstOrDefault();
        if (status.Value.ToLower() == "ok")
        {
            var res = (from elm in xmlElm.Descendants() where 
                elm.Name == "formatted_address" select elm).FirstOrDefault();
            requestUri = res.Value;
        }
    }
} 
```

Edit:

Here's a simple version of the reverse:

```
public static Coordinate GetCoordinates(string region)
{
    using (var client = new WebClient())
    {

        string uri = "http://maps.google.com/maps/geo?q='" + region + 
          "'&output=csv&key=sadfwet56346tyeryhretu6434tertertreyeryeryE1";

        string[] geocodeInfo = client.DownloadString(uri).Split(',');

        return new Coordinate(Convert.ToDouble(geocodeInfo[2]), 
                   Convert.ToDouble(geocodeInfo[3]));
    }
}

public struct Coordinate
{
    private double lat;
    private double lng;

    public Coordinate(double latitude, double longitude)
    {
        lat = latitude;
        lng = longitude;

    }

    public double Latitude { get { return lat; } set { lat = value; } }
    public double Longitude { get { return lng; } set { lng = value; } }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:45:45.000

> 我找到了对其他语言的引用，例如 java 和 ios（我猜是 Objective C）

仔细查看这些参考资料——它们中的大多数都可能使用*反向地理编码*Web 服务……您的 Windows 应用商店应用程序也可以使用这些参考资料。为您的应用选择具有适当功能和限制的服务，并向其发出 HTTP 请求。（您甚至可能会发现有一个合适的客户端库可用，尽管我认为现在相对不太可能，因为 Windows 8 的最新性...）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-11T06:03:00.543

> ```
>  Geolocator geolocator = new Geolocator(); 
>            Geoposition geoposition = await geolocator.GetGeopositionAsync();
>             string lat = geoposition.Coordinate.Point.Position.Latitude.ToString();
>             string lon = geoposition.Coordinate.Point.Position.Longitude.ToString();
>             string baseUri = string.Format("http://maps.googleapis.com/maps/api/geocode/xml?latlng={0},{1}&sensor=false", lat, lon);
>             HttpClient client = new HttpClient();
>             var response = await client.GetStringAsync(baseUri);
>             var responseElement = XElement.Parse(response);
>             IEnumerable<XElement>statusElement = from st in responseElement.Elements("status") select st;
>             if (statusElement.FirstOrDefault() != null)
>             {
>                 string status = statusElement.FirstOrDefault().Value;
>                 if (status.ToLower() == "ok")
>                 {
>                     IEnumerable<XElement> resultElement = from rs in responseElement.Elements("result") select rs;
>                     if (resultElement.FirstOrDefault() != null)
>                     {
>                         IEnumerable<XElement> addressElement = from ad in resultElement.FirstOrDefault().Elements("address_component") select ad;
>                         foreach (XElement element in addressElement)
>                         {
>                             IEnumerable<XElement> typeElement = from te in element.Elements("type") select te;
>                             string type = typeElement.FirstOrDefault().Value;
>                             if(type=="locality")
>                             {
>                                 IEnumerable<XElement> cityElement = from ln in element.Elements("long_name") select ln;
>                                 string city = cityElement.FirstOrDefault().Value;
>                                 break;
>                             }
>                         }
>                     }
>                 }
>             } 
> ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-02T19:25:45.957

在 c# 控制台应用程序中使用以下代码。传递具有坐标的 CSV 路径，它将从响应中获取地址标签并将其放入 CSV

```
 using Newtonsoft.Json.Linq;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Threading.Tasks;

namespace Google_Padouri

{
    class Program
    {
        static void Main(string[] args)
        {
            Google obj = new Google();
            obj.Execute();
        }

}

class Google
{

    public void Execute()
    {
        string result = string.Empty;
        try
        {
            Console.WriteLine("Enter complete csv path");
            string path = Console.ReadLine();

            //string path = @"C:\tmp\google\test_file.csv";

            string[] rows = File.ReadAllLines(path);
            StringBuilder sb = new StringBuilder();
            int count = 0;

            foreach(string row in rows)
            {
                string[] arr = row.Split(',');
                string lat = arr[0];
                string lng = arr[1];

                if (count > 0) 
                {
                    result = GetResult(lat, lng);
                    if (result.Length > 1)
                    {
                        result = GetAddress(result);
                        if (result.Length > 1)
                        {
                            Console.WriteLine("Working on row number " + count);
                            sb.Append(lat + "," + lng + "," + result.Replace(",", "") + "\n");

                            //if(count==200)
                            //{
                            //    break;
                            //}
                        }
                        else
                        {
                            Console.WriteLine("Could not fetch results");
                        }
                    }
                    else
                    {
                        Console.WriteLine("Google API response failed");
                    }
                }
                count = count+1;
            }

            string dir = Path.GetDirectoryName(path);
            string file = Path.GetFileNameWithoutExtension(path);
            file = file + "_output.csv";
            string fullpath = dir + "\\" + file;
            using (StreamWriter wrtier = File.CreateText(fullpath))
            {
                wrtier.Write(sb.ToString());
            }
            Console.Write("File compiled successfully");
            Console.Read();

        }
        catch (Exception ex)
        {
            Console.Write(ex);
        }
    }

    public string GetResult(string lat,string lang)
    {

        string method = "GET";
        string URL = "https://maps.googleapis.com/maps/api/geocode/json?";
        string Key = "key=YOUR_KEY";
        string Sensor = "sensor=false&";
        string latlng = "latlng=" + lat + "," + lang;
        string result = string.Empty;

        URL = URL + Key + Sensor + latlng;

        try
        {
            using (WebClient wc = new WebClient())
            {
                wc.Headers[HttpRequestHeader.ContentType] = "application/json";
                wc.Encoding = Encoding.UTF8;
                wc.Headers.Add("User-Agent: Other");

                switch (method.ToUpper())
                {
                    case "GET":
                        result = wc.DownloadString(URL);
                        break;
                }
            }
        }
        catch (Exception ex)
        {
            Console.Write(ex);
            Console.Read();
        }

        return result;
    }

    public string GetAddress(string data)
    {
        string result = string.Empty;
        try
        {
            if (data.Length > 1)
            {
                JToken token = JToken.Parse(data);
                JArray array = JArray.Parse(token["results"].ToString());

                    result = array.First["formatted_address"].ToString();

            }

        }
        catch (Exception ex)
        {
            Console.WriteLine(ex);
            Console.Read();
        }
        return result;
    }

   }

} 
```

# javascript - 将顶点法线转换为面法线

> ID：13689632
> 
> 赞同：5
> 
> 时间：2012-12-03T18:43:15.560
> 
> 标签：javascript, graphics, geometry, visualization, normals

我有一个三角多面体（不一定是凸的）和以下信息：

每个顶点的位置列表。定义每个面的顶点三元组列表。顶点法线列表（这里的顶点法线是来自每个顶点的向量，通过平均每个顶点周围的面法线（见下文）来计算）。

我想计算面法线列表（垂直于每个面的平面的标准化向量，指向外面）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T05:35:46.310

您可以通过使用顶点法线之一或所有 3 个顶点的平均值来简单地确定交叉法线的方向。

这是伪代码：

```
Vec3 CalcNormalOfFace( Vec3 pPositions[3], Vec3 pNormals[3] )
{
    Vec3 p0 = pPositions[1] - pPositions[0];
    Vec3 p1 = pPositions[2] - pPositions[0];
    Vec3 faceNormal = crossProduct( p0, p1 );

    Vec3 vertexNormal = pNormals[0]; // or you can average 3 normals.
    float dot = dotProduct( faceNormal, vertexNormal );

    return ( dot < 0.0f ) ? -faceNormal : faceNormal;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-04T16:00:18.067

使用三个顶点执行此操作的本机 three.js 代码`a`，`b`并且`c`：

您可以从您的和几何顶点获取`a`,`b`和：`c``THREE.Face3`

```
var a = geometry.vertices[ face.a ];
var b = geometry.vertices[ face.b ];
var c = geometry.vertices[ face.c ]; 
```

然后你做：

```
var normal = new THREE.Vector3().crossVectors( 
    new THREE.Vector3().subVectors( b, a ), 
    new THREE.Vector3().subVectors( c, a ) 
).normalize(); 
```

但是`THREE.Geometry`类中也有一些方便的方法可以为您进行顶点和面计算：[`computeVertexNormals`](http://threejs.org/docs/#Reference/Core/Geometry.computeVertexNormals)和[`computeFaceNormals`](http://threejs.org/docs/#Reference/Core/Geometry.computeFaceNormals).

# knockout.js - knockout.js (2.2.0) 如何使用下拉列表从 Json 数组中获取数据

> ID：13689636
> 
> 赞同：1
> 
> 时间：2012-12-03T18:43:50.640
> 
> 标签：knockout.js

**[工作演示](http://jsfiddle.net/pkysylevych/ptmwr/)**

我面临以下问题：
我有一个 json 数组：

```
self.customExportFileArray = ko.observableArray([
      {
        "IncludeInExportConversionTypesSelectList" :
          [
            {
              "ConversionGroupID" : 1,
              "Title" : "Quote Start - Auto"
            },
            {
              "ConversionGroupID" : 2,
              "Title" : "Quote Finish - Auto"
            },
            {
              "ConversionGroupID" : 5,
              "Title" : "Sales Data"
            }
          ],
        "ChooseFromConversionTypesSelectList" : [],
        "FileName" : "Template1",
        "FileFormat" : "Excel",
        "FilterSettings" : true,
        "ComparisonMetrics" : false
      },
      {
        "IncludeInExportConversionTypesSelectList":
          [
            {
              "ConversionGroupID" : 1,
              "Title" : "Quote Start - Auto"
            },
            {
              "ConversionGroupID" : 5,
              "Title" : "Sales Data"
            }
          ],
        "ChooseFromConversionTypesSelectList":
          [
            {
              "ConversionGroupID" : 2,
              "Title" : "Quote Finish - Auto"
            }
          ],
        "FileName" : "Template2",
        "FileFormat" : "CSV",
        "FilterSettings" : false,
        "ComparisonMetrics" : true
      }
    ]);
} 
```

我有一些 HTML 代码，其中包含一个下拉列表、文本框、几个单选按钮和两个列表控件。所以，重点是：下拉列表应该包含与数组长度一样多`customExportFileArray`的项目，并且项目名称（optionsText）应该是`FileName`数组的属性。（看起来它现在可以工作了）。接下来，如果从下拉列表中更改项目，假设`Template1`文件名文本框应由数组（Template1）中的 FileName 属性填充，应选中 Excel 单选按钮，应选中保留过滤器设置，应取消选中 Compatison Metrics 和“要选择的转换类型From' 应该包含一个`IncludeInExportConversionTypesSelectList`数组列表（Text = Title）
但是如果在我的 HTML 代码中看到我做错了什么，但不知道到底是什么。它不会通过从下拉列表中更改项目来加载特定数据，但我认为我所做的一切都是正确的。
附加问题：如何保存特定 Item 数组的更改（我的意思是，例如，您更改了名称，或更改了选中的单选按钮）。
任何帮助将不胜感激。

提前致谢。

**[工作演示](http://jsfiddle.net/pkysylevych/ptmwr/)**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:00:47.520

您需要将下拉列表的值绑定到名为“SelectedTemplate”之类的可观察属性以存储所选值，然后将可更改字段绑定到所选对象：

```
<select data-bind="options: customExportFileArray, optionsText: function(item) { return item.FileName }, value: selectedTemplate">

<input type="text" data-bind="value: selectedTemplate().FileName"/>

self.selectedTemplate = ko.observable();
self.customExportFileArray = ko.observableArray([
      {
       .... 
```

我已将您的 jsfiddle 修改如下：http: [//jsfiddle.net/ptmwr/11/](http://jsfiddle.net/ptmwr/11/)

如您所见，下拉列表的值绑定现在指向这个新属性，我必须更改选项文本绑定的方式以将对象作为值使用。

**编辑：**

此外，您正在尝试将布尔值绑定到 RadioButton 的选中属性，它们并不是真正设计的。如果你想绑定到一个布尔属性，那么你应该使用复选框控件，因为它是打开或关闭的。

希望这可以帮助！

# iphone - imageView 的 iOS alpha 值比较失败

> ID：13689638
> 
> 赞同：0
> 
> 时间：2012-12-03T18:44:05.980
> 
> 标签：iphone, objective-c, ios, ipad, uiimageview

这是我的代码：

```
#define kDeselected .3
#define kSelected 1

- (void) selectButton:(UIImageView*)iconView{
    [iconView setAlpha:kDeselected];
    if(iconView.alpha == kDeselected){
        [iconView setAlpha:kSelected];
    }
    else if(iconView.alpha == kSelected){
        [iconView setAlpha:kDeselected];
     }
} 
```

我是一个相当高级的程序员，但我无法理解为什么在 if 语句之前，当我手动进入并确保 if 语句的结果为真时，它仍然没有命中它。

应该注意的是，当 kDeselected = .5 时，它可以完美运行。然而，当它是 0.3 时……它不喜欢我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:58:08.193

尝试将您的 const 转换为浮点值`#define kDeselected 0.3f`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:53:39.587

我猜想在 iconView 中存储 alpha 的精度有限。它可能返回 0.3334。或者差不多。

在图像编辑中，很少看到 8 位整数范围之外的 alpha 值。事实上，我想我从来没有见过。

我试过了

```
 for (int i = 0; i <100; i++) {
        double myAlpha = 0.3 + i * 0.01;
        self.view.alpha = myAlpha;
        NSLog(@"myAlpha=%30.20f viewAlpha=%30.20f", myAlpha, self.view.alpha);
    } 
```

看到了

```
myAlpha=        0.29999999999999998890 viewAlpha=        0.30000001192092895508
myAlpha=        0.30999999999999999778 viewAlpha=        0.31000000238418579102
myAlpha=        0.32000000000000000666 viewAlpha=        0.31999999284744262695
myAlpha=        0.32999999999999996003 viewAlpha=        0.33000001311302185059
myAlpha=        0.33999999999999996891 viewAlpha=        0.34000000357627868652 
```

因此，期望 alpha 的返回值不是近似值看起来像是一厢情愿！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:54:00.630

将常量转换为类型时可能是由于编译器问题

尝试做

```
CGFloat deselectedValue = kDeselected; 
```

看看它的实际价值是什么，并尝试使用它：

```
- (void) selectButton:(UIImageView*)iconView{
    CGFloat deselectedValue = kDeselected;
    [iconView setAlpha:deselectedValue];
    if(iconView.alpha == deselectedValue){
        [iconView setAlpha:deselectedValue];
    }
    else if(iconView.alpha == kSelected){
        [iconView setAlpha:kDeselected];
    }
} 
```

您的另一个选择是尝试将您的 .3 定义为`#define kDeselected 0.3f`，但是我怀疑如果 .5 有效，它会有所作为

# wordpress - 分页结果在我的插件中

> ID：13689641
> 
> 赞同：0
> 
> 时间：2012-12-03T18:44:22.533
> 
> 标签：wordpress

我正在制作一个显示某些用户操作日志的插件。

问题是我需要添加分页以每页仅显示 5 个结果，而不是如何 paginate_links() 函数。

这是我的代码（我需要添加分页））：

```
$mylink = $wpdb->get_results("SELECT * FROM wp_points");

foreach ($milink as $mostrar) 
{

<tr>

echo"<td>".$mostrar->punto_user_ID."</td>
<td>".$mostrar->punto_nombre."</td>
<td>".number_format($mostrar->punto_canjeados, 0, ',', '.')."</td>
<td>".cambiarFormatoFecha($mostrar->punto_fecha)."</td>";

}
echo"</tr>
</tbody>
</table>"; 
```

请任何可以提供代码帮助的人。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T05:16:39.660

这是一个可行的快速解决方案

使用的功能

ceil： http: [//php.net/manual/en/function.ceil.php](http://php.net/manual/en/function.ceil.php)

wpdb->准备 [http://codex.wordpress.org/Class_Reference/wpdb](http://codex.wordpress.org/Class_Reference/wpdb)

分页链接 [http://codex.wordpress.org/Function_Reference/paginate_links](http://codex.wordpress.org/Function_Reference/paginate_links)

```
$per_page = 5;
$page = intval(get_query_var('page')); // cast to int to be on the safe side
$total_pages = ceil($wpdb->get_var("SELECT COUNT(*) FROM wp_points") / $per_page);  

//use $wpdb->prepare to help against sql injection
$sql  = $wpdb->prepare("SELECT * FROM wp_points LIMIT %d, %d", $page * $per_page, $per_page);

// your processing here 

$mylink = $wpdb->get_results($sql);
//...

// here's the helper no magick here, straight from docs
$big=999999999; // dummy used by 'base' below

echo paginate_links( array(
    'base' => str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),
    'format' => '?page=%#%',
    'current' => max( 1, $page ),
    'total' => $total_pages,
) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T10:05:03.030

最好看看[wp_query](http://codex.wordpress.org/Class_Reference/WP_Query)（“分页参数”在页面中间的某个地方）使用类似的东西：

```
$query = new WP_Query( 'posts_per_page=5' ); 
```

# wpf - WPF 双显示器应用程序覆盖

> ID：13689644
> 
> 赞同：1
> 
> 时间：2012-12-03T18:44:30.327
> 
> 标签：wpf, window, overlap, multiple-monitors

我查看了这个线程以在 WPF 中创建双监视器应用程序：[http](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/5d181304-8952-4663-8c3c-dc4d986aa8dd) : //social.msdn.microsoft.com/forums/en-US/wpf/thread/5d181304-8952-4663-8c3c-dc4d986aa8dd WPF 窗口将显示在两个监视器上。

我遇到的问题是窗口重叠 - 它们都显示在同一个屏幕上。调试器告诉我 System.Windows.Forms.Screen.AllScreens 数组中有 2 个显示器，每个屏幕的工作区域的 Top 和 Left 值分别为 0、-1600 和 0、0（这似乎是对我来说准确）。

两个屏幕的分辨率均为 1600x1200。

有没有人遇到过类似的问题？显示器在屏幕分辨率设置中设置为“将桌面扩展到此显示器”。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:32:03.323

通过使用以下代码，我设法在第二个监视器（位于主监视器的右侧）中显示了一个窗口：

`window.Left = System.Windows.SystemParameters.VirtualScreenWidth / 2;`

# asp.net-mvc - ASP.NET MVC 4 中的每个请求都没有命中 ActionFilterAttribute

> ID：13689648
> 
> 赞同：1
> 
> 时间：2012-12-03T18:44:37.560
> 
> 标签：asp.net-mvc, ssl, ninject

我有一个自定义的 RequireHttps 操作过滤器。我登录并且我的网站是 https，但是当您在登录时输入 http 页面时，操作过滤器永远不会被击中。我知道这一点，因为我已经登录并且我没有看到它被记录了。我希望它得到它的原因是测试用户是否经过身份验证并执行 301 重定向到 SSL 中的同一页面，但它永远不会被击中。

**全球.asax**

```
 kernel.BindFilter<UseHttpsFilter>(FilterScope.Action, 0)
                          .WhenActionMethodHas<UseHttpsAttribute>()
                          .WithConstructorArgumentFromActionAttribute<UseHttpsAttribute>("requireSecure", q => q.RequireSecure);

                    kernel.BindFilter<UseHttpsFilter>(FilterScope.Controller, 0)
                          .WhenActionMethodHas<UseHttpsAttribute>()
                          .WithConstructorArgumentFromControllerAttribute<UseHttpsAttribute>("requireSecure", q => q.RequireSecure); 
```

**使用HttpsAttribute.cs**

```
namespace Site.Web.Attributes
{
    [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited = true, AllowMultiple = false)]
    public class UseHttpsAttribute : FilterAttribute
    {
        public bool RequireSecure { get; set; }

        public UseHttpsAttribute(bool requireSecure)
        {
            RequireSecure = requireSecure;
        }
    }

    public class UseHttpsFilter : ActionFilterAttribute
    {
        protected static readonly NLogLogger Logger = new NLogLogger();

        public bool RequireSecure = false;

        public UseHttpsFilter(bool requireSecure)
        {
            Logger.Debug("Use Https Constructor: " + requireSecure);
            RequireSecure = requireSecure;
        }

        protected virtual void HandleNonHttpRequest(ActionExecutingContext filterContext)
        {
            if (string.Equals(filterContext.HttpContext.Request.HttpMethod, "GET", StringComparison.OrdinalIgnoreCase))
            {
                string url = "http://" + filterContext.HttpContext.Request.Url.Host + filterContext.HttpContext.Request.RawUrl;
                filterContext.Result = new RedirectResult(url, true);
            }
        }

        protected void HandleNonHttpsRequest(ActionExecutingContext filterContext)
        {
            if (string.Equals(filterContext.HttpContext.Request.HttpMethod, "GET", StringComparison.OrdinalIgnoreCase))
            {
                string url = "https://" + filterContext.HttpContext.Request.Url.Host + filterContext.HttpContext.Request.RawUrl;
                filterContext.Result = new RedirectResult(url, true);
            }
        }

        public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            Logger.Debug("Use Https Authenticated: " + filterContext.RequestContext.HttpContext.User.Identity.IsAuthenticated);

            if (filterContext.RequestContext.HttpContext.User.Identity.IsAuthenticated || HttpContext.Current.Session[Config.ViewData.MemberSession] != null)
            {
                RequireSecure = true;
            }

            Logger.Debug("Use Https Local: " + filterContext.RequestContext.HttpContext.Request.IsLocal);

            if (filterContext.RequestContext.HttpContext.Request.IsLocal)
                RequireSecure = false;

            if (RequireSecure)
            {
                Logger.Debug("Use Https Secure Connection: " + filterContext.HttpContext.Request.IsSecureConnection);

                if (!filterContext.HttpContext.Request.IsSecureConnection)
                {
                    HandleNonHttpsRequest(filterContext);
                }
            }
        }

        public override void OnActionExecuted(ActionExecutedContext filterContext)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T15:44:03.920

发现这是因为我第一次装订有这个

```
.WhenActionMethodHas<UseHttpsAttribute>() 
```

而不是

```
.WhenControllerHas<UseHttpsAttribute>() 
```

# perl - Perl 相当于 PHP 的 strtotime()？

> ID：13689650
> 
> 赞同：4
> 
> 时间：2012-12-03T18:44:52.993
> 
> 标签：perl, date, date-parsing

我意识到 Perl 有 strftime，它允许你传递一个格式化对象。我想知道是否可以找到的功能更像以下（来自 PHP）：

```
$string1 = "Jun 6, 2012";
$string2 = "June 06 2012";
if (strtotime($string1) == strtotime($string2)) {
  echo "BLAMMO!";
}
// will echo "BLAMMO!" 
```

其原因是业务需求需要比较用户提供的日期以进行验证和扩展逻辑（此日期是否属于还提供的另一个日期范围等）。现在，我意识到我可以编写一个专门用于执行此操作的整个库，并且我意识到日期解析存在许多潜在的陷阱，您永远不应该相信用户输入，但这里有一些基本假设。

1.  输入实际上是从任意数量的软件包中输出的，这些软件包符合它们自己的日期格式内部规范。它们都遵循一些标准，但这些标准在程序之间并没有统一规范。话虽如此，我应该总是比较来自同一个程序的两个日期，但我可能永远不知道它们可能遵循什么格式。
2.  我意识到任何给定系统的标准可能会有所不同，但这里的假设是我们将所有日期都输入到同一事物中，因此我们可以信任一致的实现，希望在 CPAN 或其他易于更新的模块中实现.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T18:53:37.093

[Date::Parse supply](https://metacpan.org/pod/Date%3a%3aParse)，`str2time`它执行此操作。

文档列出了模块可以解析的一些示例：

```
 1995:01:24T09:08:17.1823213           ISO-8601
 1995-01-24T09:08:17.1823213
 Wed, 16 Jun 94 07:29:35 CST           Comma and day name are optional 
 Thu, 13 Oct 94 10:13:13 -0700
 Wed, 9 Nov 1994 09:50:32 -0500 (EST)  Text in ()'s will be ignored.
 21 dec 17:05                          Will be parsed in the current time zone
 21-dec 17:05
 21/dec 17:05
 21/dec/93 17:05
 1999 10:02:18 "GMT"
 16 Nov 94 22:28:20 PST 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T18:54:28.697

Perl 中日期/时间操作的标准是 DateTime 项目。

[https://metacpan.org/pod/DateTime](https://metacpan.org/pod/DateTime)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T22:20:40.563

`strptime`对于 Perl 可以在核心模块[Time::Piece](https://metacpan.org/module/Time%3a%3aPiece)中获得。这提供了一个核心模块解决方案，而不幸的是，丰富的`DateTime`模块不是核心 Perl 的一部分。

# xcode - 解析 JSON Facebook 对话 XCODE

> ID：13689653
> 
> 赞同：0
> 
> 时间：2012-12-03T18:45:00.347
> 
> 标签：xcode, facebook, json, message, feed

我需要你的帮助。我可以正确解析 graph.facebook.com/me/feed JSON，但我无法使用 graph.facebook.com/me/conversations 来解析。你能帮我么？这就是我从提要中获取最后一条消息的方式

```
 NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData
                                                                       options:kNilOptions
                                                                         error:nil];
                  NSLog(@"json %@", json);
                  NSDictionary *items = [json objectForKey:@"data"];
                  // NSDictionary *item = [items objectAtIndex:1];

                  NSLog(@"items %@", items);

                  NSMutableArray *story = [NSMutableArray array];

                  for (NSDictionary *item in items )
                  {

                      if([item objectForKey:@"message"] || [item objectForKey:@"message"] != nil || [[item objectForKey:@"message"] length]>0)
                      {
                          [story addObject:[item objectForKey:@"message"]];
                      }
                      else{

                          NSLog(@"no message");
                      }

                  }
                  NSLog(@"story %@", story);

                  NSString *lastMessage = [story objectAtIndex:0];
                  NSLog(@"lastmessage received is %@", lastMessage); 
```

你能帮我么？谢谢

编辑：我在 NSString *lastMessage = [story objectAtIndex:0]; 中收到此错误

> ***终止应用程序由于未捕获的异常'NSRangeException'，原因是： '*** - [__ NSArrayM objectAtIndex：]：索引0超出界限为空数组' ***第一掷调用堆栈：（0x341fc2a3 0x3aede97f 0x34147b75 0xc3a1d 0x3add2d91 0x3c22c11f 0x3c22fecf 0x3c22fdc1 0x3c23091d 0x3c230ac1 0x3ae54a11 0x3ae548a4） libc++abi.dylib：终止调用抛出异常

来自“项目”的 NSLog 如下：

```
(
        {
        "can_reply" = 1;
        id = "t_id.xx5719286166414";
        "is_subscribed" = 1;
        link = "http://www.facebook.com/messages/?action=read&tid=id.xx5719286166414";
        "message_count" = 4;
        messages =         {
            data =             (
                                {
                    "created_time" = "2012-11-30T17:53:00+0000";
                    from =                     {
                        email = "1367741936@facebook.com";
                        id = 1367741936;
                        name = " xxx xxx";
                    };
                    id = "m_msg.fe83b318fa94e6bbcc90a9a52fa4645b01";
                    message = "Questo \U00e8 un messaggio";
                    tags =                     {
                        data =                         (
                                                        {
                                name = inbox;
                            },
                                                        {
                                name = messenger;
                            },
                                                        {
                                name = read;
                            },
                                                        {
                                name = "source:mobile";
                            }
                        );
                    };
                    to =                     {
                        data =                         (
                                                        {
                                email = "100004765716168@facebook.com";
                                id = 100004765716168;
                                name = "AccountDevelopment Development";
                            },
                                                        {
                                email = "1367741936@facebook.com";
                                id = 1367741936;
                                name = " xxx xxx";
                            }
                        );
                    };
                },
                                {
                    "created_time" = "2012-11-29T11:49:00+0000";
                    from =                     {
                        email = "1367741936@facebook.com";
                        id = 1367741936;
                        name = " xxx xxx";
                    };
                    id = "m_id.128631660627297";
                    message = "funziona?";
                    tags =                     {
                        data =                         (
                                                        {
                                name = inbox;
                            },
                                                        {
                                name = read;
                            },
                                                        {
                                name = "source:web";
                            }
                        );
                    };
                    to =                     {
                        data =                         (
                                                        {
                                email = "100004765716168@facebook.com";
                                id = 100004765716168;
                                name = "AccountDevelopment Development";
                            },
                                                        {
                                email = "1367741936@facebook.com";
                                id = 1367741936;
                                name = " xxx xxx";
                            }
                        );
                    };
                },
                                {
                    "created_time" = "2012-11-28T18:05:57+0000";
                    from =                     {
                        email = "1367741936@facebook.com";
                        id = 1367741936;
                        name = " xxx xxx";
                    };
                    id = "m_id.141590452655798";
                    message = "prova messaggio";
                    tags =                     {
                        data =                         (
                                                        {
                                name = inbox;
                            },
                                                        {
                                name = read;
                            },
                                                        {
                                name = "source:web";
                            }
                        );
                    };
                    to =                     {
                        data =                         (
                                                        {
                                email = "100004765716168@facebook.com";
                                id = 100004765716168;
                                name = "AccountDevelopment Development";
                            },
                                                        {
                                email = "1367741936@facebook.com";
                                id = 1367741936;
                                name = " xxx xxx";
                            }
                        );
                    };
                },
                                {
                    "created_time" = "2012-11-28T18:04:50+0000";
                    from =                     {
                        email = "1367741936@facebook.com";
                        id = 1367741936;
                        name = " xxx xxx";
                    };
                    id = "m_id.xx5719286166414";
                    message = "Ciao Francesco, come stai?";
                    tags =                     {
                        data =                         (
                                                        {
                                name = inbox;
                            },
                                                        {
                                name = read;
                            },
                                                        {
                                name = "source:web";
                            }
                        );
                    };
                    to =                     {
                        data =                         (
                                                        {
                                email = "100004765716168@facebook.com";
                                id = 100004765716168;
                                name = "AccountDevelopment Development";
                            },
                                                        {
                                email = "1367741936@facebook.com";
                                id = 1367741936;
                                name = " xxx xxx";
                            }
                        );
                    };
                }
            );
            paging =             {
                next = "https://graph.facebook.com/t_id.xx5719286166414/messages?access_token=BAABlotMxL1MBACbrnuvICOwBKjkw68ZBaqLOY2MVE6tga8xPmiF9VWH7RZAZCoZBDeSD29KWTzuze3xpjP7xb1kmfyw7VYtvGZC0E1gwgJthpZAoKoFXAYanGcBMb1qzO7SBAI3WPLcLAq7yAUpyF9NiHY0vIpsiGJZASx3eZCA83Lm18hpjmo0K97ZBSOiAoYeZCm2vYDgqq4S8jqOvZCvGZCZByNeg4ElNiSwZA1hHqdA6qrFAZDZD&limit=25&until=1354125890&__paging_token=m_id.xx5719286166414";
                previous = "https://graph.facebook.com/t_id.xx5719286166414/messages?access_token=BAABlotMxL1MBACbrnuvICOwBKjkw68ZBaqLOY2MVE6tga8xPmiF9VWH7RZAZCoZBDeSD29KWTzuze3xpjP7xb1kmfyw7VYtvGZC0E1gwgJthpZAoKoFXAYanGcBMb1qzO7SBAI3WPLcLAq7yAUpyF9NiHY0vIpsiGJZASx3eZCA83Lm18hpjmo0K97ZBSOiAoYeZCm2vYDgqq4S8jqOvZCvGZCZByNeg4ElNiSwZA1hHqdA6qrFAZDZD&limit=25&since=1354297980&__paging_token=m_msg.fe83b318fa94e6bbcc90a9a52fa4645b01&__previous=1";
            };
        };
        participants =         {
            data =             (
                                {
                    email = "1367741936@facebook.com";
                    id = 1367741936;
                    name = " xxx xxx";
                },
                                {
                    email = "100004765716168@facebook.com";
                    id = 100004765716168;
                    name = "AccountDevelopment Development";
                }
            );
        };
        senders =         {
            data =             (
                                {
                    email = "1367741936@facebook.com";
                    id = 1367741936;
                    name = " xxx xxx";
                }
            );
        };
        snippet = "Questo \U00e8 un messaggio";
        tags =         {
            data =             (
                                {
                    name = inbox;
                },
                                {
                    name = read;
                },
                                {
                    name = seen;
                },
                                {
                    name = "source:web";
                }
            );
        };
        "updated_time" = "2012-11-30T17:53:00+0000";
    }
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T17:13:44.067

您的访问器中缺少一个级别。JSON 中的顶级项目是`messages`，并且包含`data`. 然后`data`是一个数组，而不是字典。所以你应该把第一行改成这个......

```
NSArray *messageGroups = [json objectForKey:@"data"];
NSDictionary* firstMessageGroup = [messageGroups objectAtIndex:0];
NSDictionary *messages = [firstMessageGroup objectForKey:@"messages"];
NSArray* items = [messages objectForKey@"data"]; 
```

# java - 优先队列插入键值对java

> ID：13689656
> 
> 赞同：5
> 
> 时间：2012-12-03T18:45:17.503
> 
> 标签：java, priority-queue

# 背景

我试图在 O(mlogn) 时间内编写 Dijkstra 算法，其中 m 是边数，n 是节点数。我用来查找给定起始节点和给定结束节点之间的最短路径。我对此很陌生。

这是我提出的算法：

假设图由邻接矩阵表示，每个节点都有一个行索引。

```
Initialize starting node distance to zero, and all other nodes to inifinity, in the heap.

Create a list of shortest paths, equal to the number of nodes in the graph, set to 0.

While the index of the node that corresponds to the minimum element in the heap 
has no value in the list of shortest paths and heap has node distances, do:
    Remove the minimum node distance from the heap, and bubble as necessary to fill the removed node.
    Put the minimum node distance into the list of shortest paths at its row index.

    For all nodes that were adjacent to the node with the minimum distance (that was just removed), do:
      Update the distances in the heap for the current node, using the following calculation:
        min((deleted node distance + adjacent edge weight), current node's distance)
    Reorganize the heap to be a minimum heap.

Return value in the list of shortest paths at the location of the end node. 
```

这是 O(mlogn) 因为您只更新每条边的距离一次。

> “初始化堆需要线性时间，然后我们以 O(log n) 的成本执行 m 次更新，总时间为 O(mlog n)。” - [http://www.cs.cmu.edu/~avrim/451f07/lectures/lect1011.pdf](http://www.cs.cmu.edu/~avrim/451f07/lectures/lect1011.pdf)

# 问题

为了在堆中的正确位置更新与起始顶点的距离，对堆的插入必须是键值对 - 键是节点（行索引），值是距离。

[网上](http://www.cs.nott.ac.uk/~nza/G52ADS/heap2.pdf)有演讲幻灯片说优先级队列 ADT 中的每个条目都是一个键值对（否则，它怎么能优先级呢？）。

# 问题

[PriorityQueue](http://docs.oracle.com/javase/6/docs/api/java/util/PriorityQueue.html)的方法最多只有一个参数，那么如何插入与值关联的键呢？

这必须在具有特定名称的单个文件中完成（即我的理解是我不能使`KeyValuePair`类实现`Comparator`）。

我很想听听你的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:49:02.340

要为您的应用程序使用 JDK 的优先级队列实现，您可以维护一个`Map<Key, Value>`除了`PriorityQueue<Value>`. 在您的情况下，`Key`表示一个节点，并且`Value`是一个与节点保持最短距离的对象。要更新到节点的距离，首先在地图中查找其对应的距离对象。然后，从优先级队列中删除距离对象。接下来，更新距离对象。最后，将距离对象插回优先级队列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-25T12:56:59.887

下面是使用 priority_queue 的 Dijkstra 实现。这里忽略 InputReader 类，因为它用于快速输入。我们可以根据键值对中对的“值”来保持优先级。然后选择 Pair with minimum cost ie value 。

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.InputMismatchException;
import java.util.List;
import java.util.PriorityQueue;
/** 
 * By: Rajan Parmar
 * At : HackerRank 
 **/
public class Dijkstra { 
     // node ,pair ( neighbor , cost)
    static HashMap < Integer , HashSet <Pair>> node;
    static PrintWriter w;   
    public static void main(String [] s) throws Exception{
        InputReader in;

        boolean online = false;
        String fileName = "input";

        node = new HashMap<Integer, HashSet<Pair>>();

        //ignore online if false it is for online competition
        if (online) {

            //ignore
            in = new InputReader(new FileInputStream(
                    new File(fileName + ".txt")));
            w = new PrintWriter(new FileWriter(fileName + "Output.txt"));
        } else {

            // for fast input output . You can use any input method
            in = new InputReader(System.in);
            w = new PrintWriter(System.out);
        }

        // Actual code starts here
        int t;
        int n, m;
        t = in.nextInt();

        while(t-- > 0){
            n = in.nextInt();
            m = in.nextInt();
            while(m-- > 0){
                int x,y,cost;
                x = in.nextInt();
                y = in.nextInt();
                cost = in.nextInt();

                if(node.get(x)==null){
                    node.put(x, new HashSet());
                    node.get(x).add(new Pair(y,cost));
                }
                else{
                    node.get(x).add(new Pair(y,cost));
                }
                if(node.get(y)==null){
                    node.put(y, new HashSet());
                    node.get(y).add(new Pair(x,cost));
                }
                else{
                    node.get(y).add(new Pair(x,cost));
                }
            }
            int source = in.nextInt();
            Dijkstra(source,n);
            node.clear();
            System.out.println("");
        }
    }

    static void Dijkstra(int start , int n) {

        int dist[] = new int[3001];
        int visited[] = new int[3001];
        Arrays.fill(dist, Integer.MAX_VALUE);
        Arrays.fill(visited, 0);
        dist[start] = 0 ;
        PriorityQueue < Pair > pq = new PriorityQueue();

        //this will be prioritized according to VALUES (i.e cost in class Pair)
        pq.add(new Pair(start , 0));
        while(!pq.isEmpty()){
            Pair pr = pq.remove();
            visited[pr.neighbor] = 1;
            for(Pair p:node.get(pr.neighbor)){
                if(dist[p.neighbor] > dist[pr.neighbor] + p.cost){
                    dist[p.neighbor] = dist[pr.neighbor] + p.cost;

                    //add updates cost to vertex through start vertex
                    if(visited[p.neighbor]==0)
                        pq.add(new Pair(p.neighbor ,dist[p.neighbor] ));
                }

            }
        }
        for(int i=1;i<=n;i++){
            if(i==start) continue;
            if(visited[i]==0)
                dist[i]=-1;
            System.out.print(dist[i]+" ");
        }
    }

    static class Pair implements Comparable {

        int neighbor;
        int cost;

        public Pair(int y, int cost) {
            // TODO Auto-generated constructor stub
            neighbor = y;
            this.cost = cost;
        }

        @Override
        public int compareTo(Object o) {
            // TODO Auto-generated method stub
            Pair pr = (Pair)o;

            if(cost > pr.cost)
                return 1;
            else
                return -1;

        }

    }

    //Ignore this class , it is for fast input.
    static class InputReader {

        private InputStream stream;
        private byte[] buf = new byte[8192];
        private int curChar, snumChars;
        private SpaceCharFilter filter;

        public InputReader(InputStream stream) {
            this.stream = stream;
        }

        public int snext() {
            if (snumChars == -1)
                throw new InputMismatchException();
            if (curChar >= snumChars) {
                curChar = 0;
                try {
                    snumChars = stream.read(buf);
                } catch (IOException e) {
                    throw new InputMismatchException();
                }
                if (snumChars <= 0)
                    return -1;
            }
            return buf[curChar++];
        }

        public int nextInt() {
            int c = snext();
            while (isSpaceChar(c))
                c = snext();
            int sgn = 1;
            if (c == '-') {
                sgn = -1;
                c = snext();
            }
            int res = 0;
            do {
                if (c < '0' || c > '9')
                    throw new InputMismatchException();
                res *= 10;
                res += c - '0';
                c = snext();
            } while (!isSpaceChar(c));
            return res * sgn;
        }

        public long nextLong() {
            int c = snext();
            while (isSpaceChar(c))
                c = snext();
            int sgn = 1;
            if (c == '-') {
                sgn = -1;
                c = snext();
            }
            long res = 0;
            do {
                if (c < '0' || c > '9')
                    throw new InputMismatchException();
                res *= 10;
                res += c - '0';
                c = snext();
            } while (!isSpaceChar(c));
            return res * sgn;
        }

        public int[] nextIntArray(int n) {
            int a[] = new int[n];
            for (int i = 0; i < n; i++)
                a[i] = nextInt();
            return a;
        }

        public String readString() {
            int c = snext();
            while (isSpaceChar(c))
                c = snext();
            StringBuilder res = new StringBuilder();
            do {
                res.appendCodePoint(c);
                c = snext();
            } while (!isSpaceChar(c));
            return res.toString();
        }

        public boolean isSpaceChar(int c) {
            if (filter != null)
                return filter.isSpaceChar(c);
            return c == ' ' || c == '\n' || c == '\r' || c == '\t' || c == -1;
        }

        public interface SpaceCharFilter {
            public boolean isSpaceChar(int ch);
        }
    }
} 
```

这将采用以下格式输入。

第一行是 T（测试用例数）。

对于每个测试用例，下一行输入将是 N 和 M ，其中 N 是节点数，M 是边数。

接下来的 M 行包含 3 个整数，即 x,y,W。它表示节点 x 和 y 之间的边，权重为 W。

下一行包含单个整数，即 Source node 。

输出 ：

打印从给定源节点到所有节点的最短距离。如果节点不可达打印-1。

例如

输入 ：

```
1
6 8
1 2 1
1 5 4
2 5 2
2 3 2
5 6 5
3 6 2
3 4 1
6 4 3
1 
```

输出：（所有节点到节点 1 的最短距离）

```
1 3 4 3 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T10:52:44.137

* * *

我正在解决同样的问题。我知道你在哪里可以找到你问题的答案。这是一本包含代码示例的好书*——Robert Sedgewick 和 Kevin Wayne 的 Algorithms, 4th Edition。*

* * *

[网站手册](http://algs4.cs.princeton.edu/home/)和[代码示例](http://algs4.cs.princeton.edu/code/)（包括使用**PriorityQueue的***Dijkstra算法的实现）* *Dijkstra*算法的这个实现不使用 Java 的标准*PriorityQueue*实现。相反，它实现了[*IndexMinPQ*](http://algs4.cs.princeton.edu/24pq/IndexMinPQ.java.html)，这在本书的前面已经讨论过，并有详细的解释！****[](http://algs4.cs.princeton.edu/24pq/IndexMinPQ.java.html)****

 ****** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T20:32:48.987

我很欣赏我的问题的答案，当时我选择了 Map 答案，因为鉴于我对语言的理解有限，我似乎更容易实施。

事实证明，我忽略了一个重要细节，使问题比我想象的要简单得多：如果我维护一个距离数组并将节点插入堆（而不是距离），以用作对距离数组的引用，我能够根据节点的值对节点进行排序。

在这个实现中，我根本不需要设计键值属性。更新距离数组中的值后，我必须删除这些特定节点并将其重新添加到堆中，以使堆保持最新并排序，正如@reprogrammer 所建议的那样。

一旦我更改了放入堆中的内容，该算法就与[Wikipedia 上](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)的算法非常相似。

这是我最终使用的代码，以防万一有人遇到同样的问题。注意：神奇的部分是 PriorityQueue 的创建（类似于@stevevls 的建议）：

```
import java.util.*;
import java.io.File; //Because files were used to test correctness.
import java.lang.Math;

public class Dijkstra{

//This value represents infinity.
public static final int MAX_VAL = (int) Math.pow(2,30);

/* Assumptions:
    If G[i][j] == 0, there is no edge between vertex i and vertex j
    If G[i][j] > 1, there is an edge between i and j and the value of G[i][j] is its weight.
    No entry of G will be negative.
*/

static int dijkstra(int[][] G, int i, int j){
    //Get the number of vertices in G
    int n = G.length;

    // The 'i' parameter indicates the starting node and the 'j' parameter
    // is the ending node.

    //Create a list of size n of shortest paths, initialize each entry to infinity
    final int[] shortestPaths = new int[n];

    for(int k = 0; k < n; k++){
        shortestPaths[k] = MAX_VAL;
    }

    //Initialize starting node distance to zero.
    shortestPaths[i] = 0;

    //Make a Priority Queue (a heap)
    PriorityQueue<Integer> PQ = new PriorityQueue<Integer>(n,
        new Comparator<Integer>()
            {
                public int compare(Integer p, Integer q)
                {
                    return shortestPaths[p] - shortestPaths[q];
                }
            } );

    //Populate the heap with the nodes of the graph
    for(int k = 0; k < n; k++){
        PQ.offer(k);
    }

    //While the heap has elements.
    while(PQ.size() > 0){

    //  Remove the minimum node distance from the heap.
        int minimum = PQ.poll();

    //  Check if graph is disconnected, if so, return -1.
        if(shortestPaths[minimum] == MAX_VAL)
            {
                return -1;
            }
    //  End node has been reached (i.e. you've found the shortest path), return the distance.
        if( minimum == j){
            return shortestPaths[j];
        }

    //  Take the current node and look through the row to see the vertices adjacent to it (neighbours)
        for(int columnIt = 0; columnIt < n; columnIt ++){

    //    Update the distances in the heap for the current node, using the following calculation:
    //      min((deleted node distance + adjacent edge weight), current node's distance)

            if(G[minimum][columnIt] > 0){

                int sum = shortestPaths[minimum] + G[minimum][columnIt];

                shortestPaths[columnIt]= Math.min(sum, shortestPaths[columnIt]);

                if(shortestPaths[columnIt]==sum)
                {
                    PQ.remove(columnIt);
                    PQ.offer(columnIt);
                }
            }
        }
    }
    return -1;
} 
```

感谢您的回答和建议。*****

# vb.net - 将图像存储到 SQL Server

> ID：13689657
> 
> 赞同：0
> 
> 时间：2012-12-03T18:45:17.853
> 
> 标签：vb.net, image, sql-server-2008-r2

我使用 SQL Server 2008 R2 和 SQL Server Management Studio 作为我的数据库。

我需要将一组图像上传到服务器，以便在系统中的某些触发器上显示它们。我知道可以通过将图像转换为二进制来将图像上传到服务器。

如何在不编码的情况下将图像直接上传到服务器？或者这样做的唯一方法是在启动时加载所有图像然后将它们全部上传到服务器？会不会影响系统性能，启动时会出现卡顿？

# css - 仅在某些类之前应用样式

> ID：13689658
> 
> 赞同：2
> 
> 时间：2012-12-03T18:45:22.770
> 
> 标签：css

我想知道是否有一种方法只有在某个元素出现在它之前时才将 CSS 样式应用于元素。例如，仅当`.foo`紧接在之前出现时才应用我的样式`.bar`：

```
<div class="foo"></div>
<div class="bar"></div> //apply style

<div class="dur"></div>
<div class="bar"></div> //do not apply style

<div class="bar"></div> //do not apply style 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:46:06.383

是的，使用 CSS3 你可以做到

```
.foo + .bar {

} 
```

以 a 为目标`.bar`，它紧跟在 a 之后`.foo`。

请参阅[w3.org 参考](http://www.w3.org/TR/selectors/#selectors)以了解变体（例如，在但不一定紧随其后）。

请注意，[您不能在 IE7 上使用它，并且它不能在 IE8 上完美运行](http://www.quirksmode.org/css/contents.html)。

# asp.net - ASP.NET 中的视频上传和查看

> ID：13689662
> 
> 赞同：0
> 
> 时间：2012-12-03T18:45:47.803
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, youtube, youtube-api

我正在开发一个社交网站..我已经完成了基本功能。现在我希望我的用户上传视频并让他们查看..同时甚至可以删除或编辑它。

我遇到了一些实现实践，例如 HTML5、FlowPlayer、YouTube 数据 API。其中我最喜欢 Youtube Data API。但我有几个问题想分享..

用户上传的视频是否可搜索...如果是，那么我将遇到隐私问题。

或者任何人都可以指定我完成这项任务的最佳方法是什么......？

# c++ - cin.get 得到一个额外的字符？

> ID：13689665
> 
> 赞同：0
> 
> 时间：2012-12-03T18:46:16.947
> 
> 标签：c++, io, cin

> **可能重复：**
> [为什么循环条件内的 iostream::eof 被认为是错误的？](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)

我正在通过 cin.get() 读取一组字符，我注意到我的 cin.get() 在输入结束时获得了一个 exra 字符。可能有人知道如何解决这个问题吗？这是我的代码：

```
unsigned char c;

while(!cin.eof())
{
   c = cin.get();
   cout << (int)c << endl;
} 
```

我的问题是它得到的字符是 255 ascii 值之一。我只是不希望它得到这个额外的字符，但是如果用户输入 255 的 ascii 值而不是最后的垃圾字符，那应该没问题。我的输出就是一个例子：

如果我在输出中输入 abc\n：

我得到 97 98 99 10 255

但我想要：97 98 99 10

有想法该怎么解决这个吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:54:21.873

[永远不要`cin.eof()`用作循环条件](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)。它几乎总是产生错误代码，就像这里一样。

相反，请尝试：

```
int c;
while ( (c=cin.get()) != EOF ) {
  cout << c << endl;
} 
```

或者：

```
char c;
while (cin.get(c)) {
  cout << (int)c << endl;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:55:02.443

没有参数的[`get()`](http://en.cppreference.com/w/cpp/io/basic_istream/get)函数返回一个`int_type`，而不是一个`char`。在流结束时，它返回一个特殊的*非字符*值，指示文件结束（通常为 -1）。通过将 的结果`cin.get()`直接分配给`unsigned char`，您会无意中丢弃此 eof 信息。相关文档报价为：

> 1) 读取一个字符并在可用时返回它。否则，返回`Traits::eof()`并设置`failbit`and `eofbit`。

# opencv - 如何使用词袋训练和预测？

> ID：13689666
> 
> 赞同：14
> 
> 时间：2012-12-03T18:46:16.770
> 
> 标签：opencv, machine-learning, sift, feature-detection

我有一个从各个角度拍摄的汽车图像文件夹。我想使用词袋方法来训练系统识别汽车。训练完成后，我希望如果给出那辆车的图像，它应该能够识别它。

为了完成这项工作，我一直在尝试学习 opencv 中的 BOW 函数，并且已经达到了我现在不知道该怎么做的水平，希望得到一些指导。

这是我用来制作单词袋的代码：

```
Ptr<FeatureDetector> features = FeatureDetector::create("SIFT");
    Ptr<DescriptorExtractor> descriptors = DescriptorExtractor::create("SIFT");
    Ptr<DescriptorMatcher> matcher = DescriptorMatcher::create("FlannBased");

    //defining terms for bowkmeans trainer
    TermCriteria tc(MAX_ITER + EPS, 10, 0.001);
    int dictionarySize = 1000;
    int retries = 1;
    int flags = KMEANS_PP_CENTERS;
    BOWKMeansTrainer bowTrainer(dictionarySize, tc, retries, flags);

    BOWImgDescriptorExtractor bowDE(descriptors, matcher);

    //training data now
    Mat features;
    Mat img = imread("c:\\1.jpg", 0);
    Mat img2 = imread("c:\\2.jpg", 0);
    vector<KeyPoint> keypoints, keypoints2;
    features->detect(img, keypoints);
    features->detect(img2,keypoints2);
    descriptor->compute(img, keypoints, features);
    Mat features2;
    descripto->compute(img2, keypoints2, features2);
    bowTrainer.add(features);
    bowTrainer.add(features2);

    Mat dictionary = bowTrainer.cluster();
    bowDE.setVocabulary(dictionary); 
```

这一切都基于[BOW 文档](http://docs.opencv.org/modules/features2d/doc/object_categorization.html#bowtrainer-getdescriptors)。

我认为在这个阶段我的系统已经过训练。下一步是预测。

这是我不知道该怎么做的地方。如果我使用`SVM`或者`NormalBayesClassifier`他们都使用术语训练和预测。

在此之后我如何预测和训练？任何指导将不胜感激。如何将分类器的训练连接到我的“bowDE”函数？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-04T13:07:19.893

下一步是提取实际的单词描述符包。您可以使用`compute`BOWImgDescriptorExtractor 中的函数执行此操作。就像是

```
 bowDE.compute(img, keypoints, bow_descriptor); 
```

使用此函数，您可以创建描述符，然后将其收集到一个矩阵中，该矩阵用作分类器函数的输入。也许[本](http://www.morethantechnical.com/2011/08/25/a-simple-object-classifier-with-bag-of-words-using-opencv-2-3-w-code/)教程可以为您提供一些指导。

我想提到的另一件事是，对于分类，您通常需要至少 2 个类。因此，您还需要一些不包含汽车的图像来训练分类器。

# iphone - 无法在我的 iPhone 应用程序中为横向设置 SplashScreen

> ID：13689671
> 
> 赞同：0
> 
> 时间：2012-12-03T18:46:23.977
> 
> 标签：iphone, objective-c, ios6, landscape

我的图像尺寸为 480*320。我想将它设置为我的应用程序的默认启动。

我阅读了所有博客，按照他们所说的做了一切，但我未能以横向模式启动我的应用程序。

我成功在横向模式下启动了应用程序，但在纵向模式下仍然出现飞溅。

帮我解决这个问题。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:50:30.600

只需在外部编辑器中旋转您的图像。仅仅因为您将其视为风景并不意味着它实际上不是“旋转肖像”。

简而言之，把你的启动画面画成肖像画，但是把它们画到侧面！

![在此处输入图像描述](../Images/7c0c31532a14f697f249009038c555e9.png) ![在此处输入图像描述](../Images/208ee9ecf4b5cd5c98b390b7dccc6261.png)

```
        模拟器上的 Finder 图像中的文件
```

* * *

![在此处输入图像描述](../Images/adcf8c000d5c6f8385b47be8355edf6f.png) ![在此处输入图像描述](../Images/74fa24d53ab8e3ef35ed58be6ada2ff3.png)

```
        模拟器上的 Finder 图像中的文件
```

[图片经AceViral.com](http://aceviral.com)许可转载

# html - HTML5 串口访问？

> ID：13689672
> 
> 赞同：6
> 
> 时间：2012-12-03T18:46:28.133
> 
> 标签：html, serial-port

有没有办法让 HTML5 页面访问设备的串行端口，所有客户端？我知道这可以用 Java 小程序完成，但我想知道它是否可以用 HTML5 完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:48:07.543

这不可以。浏览器不允许在不使用插件的情况下访问端口。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-10T12:56:18.043

google chrome 有一个 javascript API 可以做到这一点（[http://developer.chrome.com/apps/serial.html](http://developer.chrome.com/apps/serial.html)），但它是特定于浏览器的，没有 HTML5

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T18:48:42.813

不，JavaScript 也不能​​。您正在混合 Java（小程序）和 JavaScript。他们彼此没有任何关系。

# c++ - 安排此类课程的最佳方式是什么？

> ID：13689684
> 
> 赞同：3
> 
> 时间：2012-12-03T18:47:12.393
> 
> 标签：c++, oop, class, refactoring

我正在做一个简单的项目来管理桌面游戏的数据，但我主要使用它来获得有关正确编码的经验。

我刚刚达到了一个点，即我有五个紧密耦合的类，我不确定是保持原样还是重构。

我所拥有的基本上是这样的：

*   class `ShipTemplate`：这个类（与 c++ 模板无关）具有所有常量成员，并包含有关 Ships 类别的基本信息。
*   class `TemplateSet`：此类包含当前可构建的所有 ShipTemplates，并且它有一个名称。它应该是独立的，因为它代表了每个玩家在任何时候都可以使用的技术，因此可以在不同的时间保存/加载不同的集合。
*   class `Ship`：这个类代表一艘完整的船，带有装载、名称和其他东西。它包含对 ShipTemplate 的 const 引用，该类不允许更改，以引用其基本功能。它*可以*扩展 ShipTemplate，但我想跟踪哪些 Ships 具有特定的底层 ShipTemplate，这样做似乎更容易。
*   class `Fleet`：这个类包含一个船舶列表，它有一个名称并包含其他信息。它应该包含一个成本变量，等于其中所有船舶成本的总和。
*   class `Deployment`：此类包含指向玩家可用的所有 Ships、Fleets 和 TemplateSet 的指针。它还需要跟踪不再可用的 ShipTemplates，但仍然由已建造的 Ships 使用。它应该包含一个成本变量，该变量等于玩家可用的所有船舶成本的总和。它必须管理船舶从一个舰队到另一个舰队的转移。它必须找出给定舰队中的哪些船舶，或者哪些船舶具有给定的 ShipTemplate。

不幸的是，每个班级都与其他班级紧密相连。我想过不同的方法，但我不确定其中一种是否正确。

*   到处使用`friend`语句，这样如果一个类修改了某些内容，它就可以正确更新所有其他类。
*   使用非常长的名称，例如`Deployment::modifyShipThrustInFleet`，并允许仅通过 Deployment 类进行任何修改，这将处理所有事情。
*   删除 TemplateSets 和 Fleet 并在 Deployment 中表示它们，以便它可以正确更新成本值/指针，而不会破坏任何“正确性”规则。这也意味着对系统的每一次修改都必须通过部署。
*   将指向上层类的指针插入到下层类中，例如，当更改 Ship 中的某些内容时，它可以自动更新其 Deployment 和 Fleet 的成本。

是否有其他一些我没有看到的解决方案，或者重构为更多类来帮助我实现可读、可维护的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:31:50.343

只是一些想法。

当以面向对象的方式思考时，思考现实生活中的对象会布置视图，您应该在程序中描述什么。现实生活中的对象是什么？它是一种“事物”，具有某些特性并暴露了某些功能。

例如 ShipTemplate 是船的蓝图。它应该定义尺寸、布局、零件**类型**和数量（DieselEngine、SteamEngine、AntiAircraftGun、UnderwaterMines 等），以及它们如何相互连接。

另一艘船是根据蓝图建造的——它应该有所有的零件**实例**。例如，它可能有两个 DieselEngines 和三个 AntiAircraftGuns。没错，那艘船并没有继承蓝图。蓝图只是对船的描述，而不是它的父级。

现在，每种类型的对象（蓝图、零件、船）都有自己的属性和功能。例如，每台发动机都会消耗一定量的燃料，并且可以将船速提高到某个值。为什么没有引擎的基类，它具有这些特性？（遗产）。枪支也是如此（我们称之为 ShipWeapon）。地雷枪和高射炮当然有很大的区别，但它们都是枪，都可以装在船上，都有重量，弹药类型，装填时间，弹药容量，火炮是否在工作。

所以这些是对象的一些属性。功能呢？OO 设计的其他重要概念是每个对象都有（封装）一些可以用它完成的功能（它可能会或可能不会改变对象状态）。例如 ShipWeapon 应该有方法 Fire()，它可能应该规定其中的弹药量。或者首先尝试使用 Aim(sometarget) 来瞄准。另一方面，引擎将具有 Start()、Stop()、SetSpeed(speed)。请注意，这些将在对象内部及其状态上起作用。船可能有 SetCourse(direction, speed)，它将以所需的功率启动它的引擎并定向它的方向舵。船也可能有 Colide(船)。还有 Hit(typeofattackinggun)，它将遍历船的所有部分并随机损坏一些（并为枪设置 IsOperating，或关闭其中一个引擎等）

如您所见，在设计 OO 方法时，您可以深入了解很多细节。知道什么时候停止也很好——你的程序真正需要多少细节（或准确性）才能工作。

此外，可能有一个全球性的世界，可以容纳所有船只。等等..

还有程序的其他部分，基础设施。您如何管理数据对象（船舶、世界、玩家），它们如何相互了解和交互。例如，可以通过全局地图观察每艘船作为对象，并且每艘船都会通知它有关运动（观察者模式）。或者全球世界会根据全球时钟在一定的时间间隔内查询每艘船的状态。或者...

我想我想说的是坚持主要的 OO 原则——封装、继承、多态。并且有很多关于面向对象设计、设计模式等的文献，它们很有用。[Wiki 条目](http://en.wikipedia.org/wiki/Object-oriented_programming)有点“学术”，但有主要定义，这让您思考 :) 另请查看[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

PS。在一个类中做所有事情通常是糟糕设计的标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:44:50.953

现在您已经描述了如何表示各种数据，在定义完整的关系之前，尝试通过定义“*协议*”来完成描述：

每个班级可以对其他班级做什么？实现你的目标需要哪些方法和方法之间的规则？

一旦你定义了类如何相互影响，你很可能会发现什么是私有的候选者，什么是公共的，以及各方之间必须存在什么级别的友谊。

可能不是你的情况，但是 - 通常 - 当存在复杂的关系时，一种可能的模式可以是使用“通信总线类”，它将可以“发送”到各种对象的操作公开，每个对象都有一个私有的接口并成为...总线本身的朋友（只有总线）。

**编辑**

在 Svalorzen 评论之后：

这取决于你在看它的那一面。实际上，这将引入多层次的“隐私”，允许在比类本身更广泛的单元上实现封装。这是好是坏是上下文的问题，而不是成语。

你有一个“*胶囊*”，它是一个“俱乐部”（“有‘公共汽车’作为朋友的班级俱乐部”）而“俱乐部经理”是真正的“公众过滤器”（因此也是真正的 OOP 对象），允许需要同时与更多类私有部分交互的某些方法仅在俱乐部内部进行。

否认“友谊”只不过是一种误解，将技术与工具混为一谈，使 OOP 对象与 C++ 类相同。那是-一般来说-一个FASLE成语。C++ 类可以是比 OOP 对象更小的单元（想想*pimpl*成语：那里的“对象”是什么？）。一个类可以成为另一个类的朋友这一事实并不能使它成为任何人的朋友，因此私有部分不会公开。您只是在定义另一个级别的隐私，其中封装与“私人”相同。它只适用于更广泛的群体。就 OOP 而言，“更广泛的群体”所扮演的角色与非朋友类所扮演的角色相同。

“朋友破坏封装”的误解与OOP的概念无关。它与在 Java 中实现 OOP 的方式有关，这是一种与 C++ 完全不同的语言。在 C++ 中，friendsip 只是一个“将 thimgs 组合在一起”的构造，就像类、结构、模板、继承、成员资格等一样。

什么 OOP 关系（组合、继承、链接......）必须映射到什么 C++ 构造，不像在 java 中，当语言哲学被定义为单向时，不是由语言本身和它的标准定义的图书馆。

映射“OOP 对象 = C++ 类”只是从过去继承下来的一种常见文化误解，当 C++ 没有模板、没有 lambda、没有友谊、无非是类（实际上被称为“C with classes”）时实现 OOP 层次结构的唯一方法是通过类，因为这是使用当时 c++ 构造创建层次关系的唯一方法。

现在，我什至可以使用 C++ 成员和“OOP 继承”的隐式转换和“OOP 成员资格”的 C++ 私有继承来实现 OOP 系统。或者我可以使用“类集群（或 mat be labdas）”实现一个 OOP 对象，定义它的运行时行为（想想 std::locale 和相关方面）。

使用 OOP 对象 == C++ 类习语开始设计实际上是减少了 C++ 为程序设计增加的两个自由度，将您的思维限制在十多年前的 C++ 上。

# php - 跟踪 MongoDB 中的唯一页面浏览量和唯一访问者

> ID：13689685
> 
> 赞同：1
> 
> 时间：2012-12-03T18:47:20.833
> 
> 标签：php, mongodb, schema, database

我正在使用 MongoDB 和 GoogleAnalytics 为每月拥有数百万浏览量的网站设置广告跟踪系统。以下架构是我计划用于 Mongo DB 的（欢迎提出建议）：

```
{
    name: 'Ad Name',
    image: 'http://cdn.hosteddomain.com/ad/ad.jpg',
    link: 'http://linktoadwebsite.com/?ad=123123',
    advertiser: 'Ad Client Name',
    date: 4,
    weight: 0,
    clicks: 0,
    purchased_clicks: 0,
    impressions: 0,
    purchased_impressions: 10000,
    unique_impressions: 0,
    ctr: 0.045,
    display_duration: '',
    start_time: '',
    end_time: '',
    status: 0
} 
```

为什么我也计划使用 Google Analytics，所以我不会在我的服务器上创建一个巨大的数据库，其中包含我不需要立即访问的数据。然而，总展示次数和唯一展示次数对于跟踪每个页面上的广告很重要，并且需要存在才能准确展示广告。

我的问题是：是否有一种模式或方法可以让我跟踪唯一访问者/页面浏览量并防止数据库变得庞大？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:54:23.217

您可以将此数据拆分为两个单独的集合（甚至是不同服务器上的数据库），并将很少使用的数据存储在第一个集合中，其余的存储在第二个集合中。因此，第二个存储将增长得更慢。

# php - 无法使此 mod 重写规则起作用

> ID：13689687
> 
> 赞同：1
> 
> 时间：2012-12-03T18:47:22.613
> 
> 标签：php, apache

这是我所拥有的

```
RewriteRule ^/articles/category/([0-9]+)/$ ./index.php?module=articles&view=cat&catid=$1 
```

我肯定错过了什么？

只是想得到“catid”而不是别的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:50:04.617

将您的规则更改为：

```
RewriteRule ^articles/category/([0-9]+)/?$ /index.php?module=articles&view=cat&catid=$1 [L,NC,QSA] 
```

请记住，**RewriteRule 在去除前导斜杠后开始匹配 URI`/`**

添加的一些标志是：

*   L : 最后一条
*   QSA：查询字符串追加
*   NC：忽略大小写比较

# c++ - 将 atltime 标头包含到 WTL 项目中时出错

> ID：13689699
> 
> 赞同：1
> 
> 时间：2012-12-03T18:48:20.213
> 
> 标签：c++, atl, wtl

在我使用 WTL - Visual Studio 9 中的对话框向导创建了一个普通对话框之后，我已经包含了`<atltime.h>`标题，我得到了这个：

```
Error   2   error C2039: 'CString' : is not a member of 'WTL'   ...\wtl\include\atlctrls.h  5060    TASKSCHEDULER
Error   3   error C2039: 'CString' : is not a member of 'WTL'   ...\wtl\include\atlctrls.h  969 TASKSCHEDULER
Error   4   error C2039: 'CString' : is not a member of 'WTL'   ...\wtl\include\atldlgs.h   535 TASKSCHEDULER
Error   5   error C2039: 'CString' : is not a member of 'WTL'   ...\wtl\include\atldlgs.h   627 TASKSCHEDULER
Error   6   error C2039: 'CString' : is not a member of 'WTL'   ...\wtl\include\atldlgs.h

697 TASKSCHEDULER 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-25T09:09:07.363

我遇到了类似的情况，有两件事帮助我摆脱了错误，也许对其他人有帮助。

1.  包括`atlstr.h`以上`atlapp.h`
2.  定义`_WTL_NO_CSTRING`

# php - 如何在我自己的 cakephp 应用程序中使用插件？

> ID：13689700
> 
> 赞同：-1
> 
> 时间：2012-12-03T18:48:25.480
> 
> 标签：php, cakephp, cakephp-2.0

我想使用插件上传文件并在 cakephp`http://milesj.me/code/cakephp/uploader`中为我自己的网站创建缩略图。但我无法理解文档。

如果你有更好的插件然后建议我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:23:55.340

CakePHP 书籍/文档中有一个关于“插件”的完整部分：

[http://book.cakephp.org/2.0/en/plugins.html](http://book.cakephp.org/2.0/en/plugins.html)

# mysql - 带有子查询的 MySQL 选择

> ID：13689701
> 
> 赞同：0
> 
> 时间：2012-12-03T18:48:35.310
> 
> 标签：mysql

我在数据库中有 2 个表：mainTable 和分类表：

主表：

```
id  |   classification_id   |   name
---------------------------------------
1   |           1           |   Name1
2   |           2,3,4       |   Name2
3   |           1,4         |   Name3
4   |           4           |   Name4 
```

分类表：

```
classification_id   |   class_name
---------------------------------------
        1           |   Class Name1
        2           |   Class Name2
        3           |   Class Name3
        4           |   Class Name4 
```

例如，我想从 mainTable 中选择 ID 为 3 的行，例如：

```
id          =   3
class_name  =   Class Name1, Class Name4
Name        =   Name3 
```

我尝试了这个选择，但这仅返回数组中的第一个元素（例如 ID 为 3 的行的示例，仅返回 Class Name1）

```
SELECT i.*, 
(SELECT GROUP_CONCAT(cl.class_name) FROM classificationTable as cl WHERE cl.classification_id IN(i.classification_id)) as class_name 
FROM mainTable as i; 
```

帮助PLZ。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:53:46.523

问题是 your `mainTable`，它不仅**违反[了第一范式](http://en.wikipedia.org/wiki/First_normal_form)**，而且甚至超出了因为它连接了同一字段中的值（教科书上违反 1NF 的示例通常包括多个字段，这已经够糟糕了）。

该`classification_id`列不应该是值的串联，但您应该有一个新表，其中每个分类 ID 都有一个单独的行，并且它应该通过 id 绑定到 mainTable。

例如

```
id  |   classification_id   
---------------------------------------
1   |           1           
2   |           2           
2   |           3         
2   |           4           
3   |           1       
3   |           4     
4   |           4 
```

一旦你这样做了，你的查询会容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:16:03.247

是的，您的数据库设计不佳。但你可以做你想做的。

这需要两个步骤。首先是通过在mainTable的列表中查找每个classification_id，将mainTable加入到classificationTable中。您可以使用运算符执行此`like`操作。

第二步是将所有类名重新归入一列。这是使用`group_concat`.

下面的查询完成了这个（虽然它没有经过测试，所以它可能有错字）：

```
select mt.id, mt.name, group_concat(ct.class_name separator ', ')
from mainTable mt join
     classificationTable ct
     on concat(',', classification_id, ',') like concat('%,', ct.classification_id, ',%')
group by mt.id, mt.name 
```

# javascript - 如何添加谷歌地图自动完成搜索框？

> ID：13689705
> 
> 赞同：75
> 
> 时间：2012-12-03T18:48:46.033
> 
> 标签：javascript, google-maps-api-3, autocomplete

我正在尝试将 Google 自动完成搜索框添加到网站，以便用户可以尽可能轻松地搜索地址。

我的问题是，我在这里查看了很多问题以及有关此内容的 Google Maps Javascript API v3 和一些教程，但它们都将自动完成功能捆绑在一起，并将其映射到嵌入式 Google 地图上。

我不需要直观地映射位置，我现在只需要自动完成框，不幸的是我无法确定 API 的哪些部分与此相关，并且我查看的每个示例都包含大量用于映射的 JS。

我怎样才能只添加自动完成输入功能？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2013-05-08T22:38:45.667

可以消除此代码的很大一部分。

HTML 摘录：

```
<head>
  ...
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
  ...
</head>
<body>
  ...
  <input id="searchTextField" type="text" size="50">
  ...
</body> 
```

Javascript：

```
function initialize() {
  var input = document.getElementById('searchTextField');
  new google.maps.places.Autocomplete(input);
}

google.maps.event.addDomListener(window, 'load', initialize); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2018-03-13T06:30:59.157

要获得纬度和经度，您可以使用以下简单代码：

```
<html>
<head>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>
    <script>
        function initialize() {
          var input = document.getElementById('searchTextField');
          var autocomplete = new google.maps.places.Autocomplete(input);
            google.maps.event.addListener(autocomplete, 'place_changed', function () {
                var place = autocomplete.getPlace();
                document.getElementById('city2').value = place.name;
                document.getElementById('cityLat').value = place.geometry.location.lat();
                document.getElementById('cityLng').value = place.geometry.location.lng();
            });
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>
<body>
    <input id="searchTextField" type="text" size="50" placeholder="Enter a location" autocomplete="on" runat="server" />  
    <input type="hidden" id="city2" name="city2" />
    <input type="hidden" id="cityLat" name="cityLat" />
    <input type="hidden" id="cityLng" name="cityLng" />
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-10-26T14:18:50.393

现在要使用 Google Maps/Places API，您需要使用 API 密钥。所以 API URL 将从

```
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script> 
```

到

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-11-06T21:11:43.393

只需复制并粘贴下面的相同代码即可。

```
<!DOCTYPE html>
<html>
    <head>
        <script src="https://maps.googleapis.com/maps/api/jsvv=3.exp&sensor=false&libraries=places"></script>
    </head>
    <body>
        <label for="locationTextField">Location</label>
        <input id="locationTextField" type="text" size="50">

        <script>
            function init() {
                var input = document.getElementById('locationTextField');
                var autocomplete = new google.maps.places.Autocomplete(input);
            }

            google.maps.event.addDomListener(window, 'load', init);
        </script>
    </body>
</html> 
```

可以从此链接找到格式良好的代码。 [http://jon.kim/how-to-add-google-maps-autocomplete-search-box/](http://jon.kim/how-to-add-google-maps-autocomplete-search-box/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-21T07:07:09.140

使用 Google Maps JavaScript API 和地点库在网页中实现 Google Maps 自动完成搜索框。

**HTML**

```
<input id="searchInput" class="controls" type="text" placeholder="Enter a location"> 
```

**JavaScript**

```
<script>
function initMap() {
    var input = document.getElementById('searchInput');
    var autocomplete = new google.maps.places.Autocomplete(input);
}
</script> 
```

完整指南、源代码和现场演示可从此处找到 -[带有地图和信息窗口的 Google 地图自动完成搜索框](http://www.codexworld.com/autocomplete-places-search-box-google-maps-javascript-api/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-13T10:20:11.007

所以我一直在玩这个，看来你需要激活地方和 js maps api。然后使用以下内容：

HTML：

```
<input id="searchTextField" type="text" size="50">
<input id="address" name="address" value='' type="hidden" placeholder=""> 
```

JS：

```
<script>
function initMap() {
  var input = document.getElementById('searchTextField');
  var autocomplete = new google.maps.places.Autocomplete(input);
  autocomplete.addListener('place_changed', function() {
    var place = autocomplete.getPlace();
    document.getElementById("address").value = JSON.stringify(place.address_components);
  });
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap" async defer></script> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-18T07:23:07.317

```
// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(poenter code heresition) {
      var geolocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-20T10:30:56.830

```
<input id="autocomplete" placeholder="Enter your address" type="text"/>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="https://mapenter code heres.googleapis.com/maps/api/js?key=AIzaSyC7vPqKI7qjaHCE1SPg6i_d1HWFv1BtODo&libraries=places"></script>
<script type="text/javascript">
    function initialize() {

        new google.maps.places.Autocomplete(
        (document.getElementById('autocomplete')), {
            types: ['geocode']
        });
    }

    initialize();

</script> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-18T19:19:57.817

```
<input type="text"required id="autocomplete">

<script>
function initAutocomplete() {
   new google.maps.places.Autocomplete(
          (document.getElementById('autocomplete')),
          {types: ['geocode']}
   );
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=&libraries=places&callback=initAutocomplete"
                async defer></script>
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-11-16T16:48:10.733

按照下面的代码。

**将此添加到您的 TS 文件**中。

声明这一点，你班上的佼佼者。

```
declare var google; 
```

声明 Map 的子视图和输入。

```
@ViewChild('mapElement', {static: true}) mapNativeElement: ElementRef;
@ViewChild('autoCompleteInput', {static: true}) inputNativeElement: any; 
```

此方法在 ngOnInit() 事件或 ngAfterViewInit() 事件上运行。

```
autoComplete() {
    const map = new google.maps.Map(this.mapNativeElement.nativeElement, {
      center: {lat: -33.8688, lng: 151.2093},
      zoom: 7
    });

    const infowindow = new google.maps.InfoWindow();
    const infowindowContent = document.getElementById('infowindow-content');

    infowindow.setContent(infowindowContent);

    const marker = new google.maps.Marker({
      map: map,
      anchorPoint: new google.maps.Point(0, -29)
    });
    const autocomplete = new google.maps.places.Autocomplete(this.inputNativeElement.nativeElement as HTMLInputElement);
    autocomplete.addListener('place_changed', () => {
      infowindow.close();
      marker.setVisible(false);
      const place = autocomplete.getPlace();

      let cus_location = {
        lat: place.geometry.location.lat(),
        long: place.geometry.location.lng()
      }

      console.log('place data :................', cus_location); 
      localStorage.setItem('LOC_DATA', this.helper.encryptData(cus_location));

      if (!place.geometry) {
        // User entered the name of a Place that was not suggested and
        // pressed the Enter key, or the Place Details request failed.
        window.alert('No details available for input: ' + place.name );
        return;
      }

      if (place.geometry.viewport) {
        map.fitBounds(place.geometry.viewport);
      } else {
        map.setCenter(place.geometry.location);
        map.setZoom(17);  // Why 17? Because it looks good.
      }

      marker.setPosition(place.geometry.location);
      marker.setVisible(true);
      let address = '';
      if (place.address_components) {
        address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
        ].join(' ');
      }

      if(infowindowContent){
        infowindowContent.children['place-icon'].src = place.icon;
        infowindowContent.children['place-name'].textContent = place.name;
        infowindowContent.children['place-address'].textContent = address;
      } 

      infowindow.open(map, marker);
    });

  } 
```

在 ngAfterViewInit 上调用该方法。

```
ngAfterViewInit(): void {
    this.autoComplete();
  } 
```

这是**HTML 代码**。请根据您的需要进行修改。

```
<ion-content fullscreen>
    <div class="location-col">

        <div class="google-map">
            <!-- <img src="../../assets/images/google-map.jpg" alt=""> -->
            <div #mapElement id="map"></div>
        </div>

        <div class="location-info">
            <h2>Where is your car located?</h2>
            <p>Enter address manually or click location detector icon to use current address.</p>
            <div class="form-group">

                <div class="location-row">
                    <input type="text" #autoCompleteInput class="location-input" [(ngModel)]="search_location" placeholder="Search location">
                    <span class="location-icon" (click)="getCurrentLocation()">
                        <img src="../../assets/images/location-icon.svg" alt="">
                    </span>
                </div>

                <button type="button" class="location-search-btn" (click)="goToVendorSearch()">
                    <i class="fa fa-angle-right"></i>
                </button>

            </div>
        </div>
    </div>
</ion-content> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-11-25T18:41:50.720

我目前正在使用 Google API 来检索用户在表单/输入中输入的位置。我还使用了显示当前位置并建议城市名称密码等的角度函数...... - 添加谷歌 API index.html。
`<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=xxxxxxxx&libraries=geometry,places"></script>`
- 在输入框中添加 id 以获取字符串和字符。
`<input id="autocomplete" type="text"(keydown)="checkAddress($event.target.value)">`
- 并在您的 component.ts 文件上创建函数。
**导入这些文件**

```
import * as _ from 'lodash';
declare var google: any; 
```

```
 checkAddress(value) {
    if (!value) {
      this.model.location = _.cloneDeep(value);
      this.rfpForm.controls['location'].setValue(this.model.location);
    }
  } 
```

```
initLocationAutocomplete() {
    let autocomplete, place;
    const getLocation = () => {
        place = autocomplete.getPlace();
        if (place && (place.formatted_address || place.name)) {  
            // if you want set value in your form controls like this
            this.model.location = _.cloneDeep(place.formatted_address || place.name);
            // YourFormName.controls['location'].setValue(this.model.location);
            // YourFormName.controls['location']['_touched'] = true;
        }
    };
    autocomplete = new google.maps.places.Autocomplete((document.getElementById('autocomplete')), { types: ['geocode'] });
    autocomplete.addListener('place_changed', getLocation);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-06-23T05:14:49.453

```
<!DOCTYPE html>
<html>
  <head>
    <title>Place Autocomplete Address Form</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script>
    <script>
// This example displays an address form, using the autocomplete feature
// of the Google Places API to help users fill in the information.

var placeSearch, autocomplete;
var componentForm = {
  street_number: 'short_name',
  route: 'long_name',
  locality: 'long_name',
  administrative_area_level_1: 'short_name',
  country: 'long_name',
  postal_code: 'short_name'
};

function initialize() {
  // Create the autocomplete object, restricting the search
  // to geographical location types.
  autocomplete = new google.maps.places.Autocomplete(
      /** @type {HTMLInputElement} */(document.getElementById('autocomplete')),
      { types: ['geocode'] });
  // When the user selects an address from the dropdown,
  // populate the address fields in the form.
  google.maps.event.addListener(autocomplete, 'place_changed', function() {
    fillInAddress();
  });
}

// [START region_fillform]
function fillInAddress() {
  // Get the place details from the autocomplete object.
  var place = autocomplete.getPlace();

  for (var component in componentForm) {
    document.getElementById(component).value = '';
    document.getElementById(component).disabled = false;
  }

  // Get each component of the address from the place details
  // and fill the corresponding field on the form.
  for (var i = 0; i < place.address_components.length; i++) {
    var addressType = place.address_components[i].types[0];
    if (componentForm[addressType]) {
      var val = place.address_components[i][componentForm[addressType]];
      document.getElementById(addressType).value = val;
    }
  }
}
// [END region_fillform]

// [START region_geolocation]
// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = new google.maps.LatLng(
          position.coords.latitude, position.coords.longitude);
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
}
// [END region_geolocation]

    </script>

    <style>
      #locationField, #controls {
        position: relative;
        width: 480px;
      }
      #autocomplete {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 99%;
      }
      .label {
        text-align: right;
        font-weight: bold;
        width: 100px;
        color: #303030;
      }
      #address {
        border: 1px solid #000090;
        background-color: #f0f0ff;
        width: 480px;
        padding-right: 2px;
      }
      #address td {
        font-size: 10pt;
      }
      .field {
        width: 99%;
      }
      .slimField {
        width: 80px;
      }
      .wideField {
        width: 200px;
      }
      #locationField {
        height: 20px;
        margin-bottom: 2px;
      }
    </style>
  </head>

  <body onload="initialize()">
    <div id="locationField">
      <input id="autocomplete" placeholder="Enter your address"
             onFocus="geolocate()" type="text"></input>
    </div>

  </body>
</html> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-13T18:46:28.217

我在这里使用 jQuery 来获取输入的文本并将所有代码包装在 $(document).ready() 中。确保您已为 Google Places API Web 服务准备好 API 密钥。在下面的脚本文件中替换它。

```
<input type="text" id="location">
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=[YOUR_KEY_HERE]&libraries=places"></script>
<script src="javascripts/scripts.js"></scripts> 
```

使用脚本文件加载自动完成类。您的 scripts.js 文件将如下所示。

```
 // scripts.js custom js file
$(document).ready(function () {
   google.maps.event.addDomListener(window, 'load', initialize);
});

function initialize() {
    var input = document.getElementById('location');
    var autocomplete = new google.maps.places.Autocomplete(input);
} 
```

# django - Django ugettext_lazy、插值和ChoiceField

> ID：13689710
> 
> 赞同：7
> 
> 时间：2012-12-03T18:49:05.210
> 
> 标签：django, internationalization

我想要一个具有以下选择的 ChoiceField：

```
choices = [(1, '1 thing'),
           (2, '2 things'),
           (3, '3 things'),
           ...] 
```

我想让它翻译。

这不起作用：

```
choices = [(i, ungettext_lazy('%s thing', '%s things', i) % i) for i in range(1,4)] 
```

因为一旦惰性对象被插入，它就变成了一个 unicode 对象——因为 ChoiceField.choices 在启动时被评估，它的选择将在 Django 启动期间处于活动状态的语言中。

我可以使用`ugettext_lazy('%s things' % i)`，但这需要对每个数字进行翻译，这很愚蠢。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T05:38:37.773

在 Django 文档中，[*Translation* ... *Working with lazy translation objects*](https://docs.djangoproject.com/en/1.5/topics/i18n/translation/#working-with-lazy-translation-objects)中，我看到了一条似乎解决了您的问题的评论。

> 在模型和实用函数中使用[`ugettext_lazy()`](https://docs.djangoproject.com/en/1.5/ref/utils/#django.utils.translation.ugettext_lazy)and标记字符串是一种常见的操作。[`ungettext_lazy()`](https://docs.djangoproject.com/en/1.5/ref/utils/#django.utils.translation.ungettext_lazy)当您在代码的其他地方使用这些对象时，您应该确保不会意外地将它们转换为字符串，因为它们应该尽可能晚地转换（以便正确的语言环境生效）。这需要使用下面描述的辅助函数。

然后它们出现`django.utils.functional.lazy(func, *resultclasses)`，[`django.utils.functional`模块文档](https://docs.djangoproject.com/en/1.5/ref/utils/#module-django.utils.functional)目前没有涵盖这些内容。但是，根据[`django.utils.functional.py`源代码](https://github.com/django/django/blob/master/django/utils/functional.py)，它“将任何可调用对象转换为惰性求值的可调用对象……每次访问时都会评估该函数。”

[*从延迟翻译中的其他延迟使用中*](https://docs.djangoproject.com/en/1.5/topics/i18n/translation/#other-uses-of-lazy-in-delayed-translations)修改他们的[示例](https://docs.djangoproject.com/en/1.5/topics/i18n/translation/#other-uses-of-lazy-in-delayed-translations)*以合并您的代码，以下代码可能对您有用。*

 *```
from django.utils import six  # Python 3 compatibility
from django.utils.functional import lazy
from django.utils.safestring import mark_safe

choices = [
    (i, lazy(
        mark_safe(ungettext_lazy('%s thing', '%s things', i) % i),
        six.text_type
    )# lazy()
    for i in range(1,4)
] 
```

此外，[`django.utils.functional`模块文档](https://docs.djangoproject.com/en/1.5/ref/utils/#module-django.utils.functional)确实提到了一个函数 decorator `allow_lazy(func, *resultclasses)`。这使您可以编写自己的函数，该函数将惰性字符串作为参数。“它修改了函数，因此如果使用惰性翻译作为第一个参数调用它，函数评估会延迟，直到需要将其转换为字符串。” `lazy(func, *resultclasses)`不是装饰器，它修改了可调用对象。

注意我没有在 Django 中尝试过这段代码。我只是传递我在文档中找到的内容。希望它会为您指出可以使用的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-06T11:58:52.190

对于那些遇到这个问题的人。不幸的是，@Jim DeLaHunt 的回答并没有完全奏效——它几乎就在那里，但并不完全是需要做的。

重要的区别是：

1.  你需要扭曲的`lazy`是一个返回文本值的函数，而不是另一个惰性翻译对象，否则你可能会看到奇怪`<django.utils.functional.__proxy__ at ...>`而不是实际文本（IIRC Django 不会深入惰性对象链）。所以，使用`ungettext`，而不是`ungettext_lazy`。

2.  您只想在包装函数运行时进行字符串插值。如果你写`lazy(f("%d" % 42))`的插值发生得太早了——在这种情况下，Python 会急切地求值。并且不要忘记变量作用域——你不能只从包装函数中引用迭代器。

在这里，我使用了一个`lambda`接收数字参数并进行插值的 a。里面的代码`lambda`只在惰性对象被求值时执行，也就是在渲染选择的时候。

所以，工作代码是：

```
choices = [
    (
        (i, lazy(
            lambda cnt: ungettext(u"%(count)d thing",
                                  u"%(count)d things", cnt)
                        % {"count": cnt},
            six.text_type
        )(i))
    )
    for i in [1, 2, 3]
] 
```

这将正确地具有与

```
choices = [
    (1, _("1 thing")),
    (2, _("2 things")),
    (3, _("3 things")),
] 
```

但是翻译数据库中只有一个条目，而不是多个条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T04:51:02.560*

# amazon-ec2 - AWS EC2：无法访问我自己的 Windows AMI 的实例

> ID：13689712
> 
> 赞同：5
> 
> 时间：2012-12-03T18:49:09.350
> 
> 标签：amazon-ec2

我是 Windows 用户，想通过我自己的 EBS Windows AMI 使用 Spot 实例。为此，我遵循了以下步骤：

*   我有自己的具有特定设置的按需实例
*   使用 AWS 控制台，我使用“创建映像 EBS”选项来创建基于 EBS 的 Windows AMI。IT 工作并成功创建了 AMI
*   然后使用这个新的 AMI，我启动了一个现场媒体实例，该实例创建得很好，现在运行并通过了状态检查。
*   等待一个小时或更长时间后，我尝试使用 Windows 7 RDC 客户端连接它，但无法通过客户端工具的标准错误访问它，即任何一台计算机都无法访问或未打开电源。

我试图实现这个目标，并创建/删除了许多卷、实例、快照，但仍然没有成功。没有其他人有解决这个问题的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-04T12:23:18.383

基本上发生的情况是 Windows 的现有管理员密码（和其他用户身份验证信息）仅在原始实例中有效，并且不能在您启动 AMI 的新“硬件”上使用（即使它是全部虚拟化）。

这就是 RDP 连接将无法连接到新启动的实例的原因，任何检索管理员密码的尝试都会失败。不幸的是，您别无选择，只能关闭您尝试连接的新实例，因为您将无法对它们执行任何操作。

由于各种原因，在不同硬件（甚至虚拟化硬件）上运行操作系统快照时无法保留 Windows 管理员密码 - 这是 Active Directory 等技术存在的很大一部分原因，因此用户身份验证信息可在机器和网络。

听起来您完成了所有必要的步骤以使其正常工作，除了一个 - 您从未采取任何步骤来根据您创建的原始 AMI 将新密码分配给新启动的实例。

要解决此问题，在将您的实例转换为可用于启动新实例的自定义 AMI 之前，您需要（在原始实例中）运行 Ec2ConfigService 设置工具（在使用 RDP 远程进入原始实例时在开始菜单中找到） ，并启用在下次重新启动时生成新密码的选项。保存此设置更改。

然后，当您从原始实例创建 AMI 并使用该 AMI 启动新实例时，它们将各自启动到您的自定义 Windows 映像，但会选择自己的随机管理员密码。

此时，您可以转到您的 ec2 仪表板并检索基于旧 AMI 的新实例新生成的密码，您还可以下载用于连接它的 RDP 文件。

另一个注意事项是，亚马逊警告说，在启动新实例后检索管理员密码可能需要 30 分钟以上，但是根据我以前的经验，我从来不需要等待超过几分钟才能获得它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:42:07.430

您的问题很可能是您用于启动 AMI 的安全组未启用 RDP（TCP 端口 #3389）。

当您首次启动 windows AMI 时，AWS 将在启用此端口的情况下填充快速启动。但是，当您启动后续 AMI 时，您必须确保此端口对您的安全组开放。

# ruby - 何时使用 Sequel::Dataset 和 Sequel::Model

> ID：13689716
> 
> 赞同：1
> 
> 时间：2012-12-03T18:49:36.290
> 
> 标签：ruby, sequel

我是 Ruby 的 Sequel 的新手，我很好奇什么时候应该使用`Sequel::Dataset`，什么时候最好使用`Sequel::Model`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:08:22.960

如果您需要一流的模型，则应该使用该模型。这提供了验证、状态转换和事件之前和之后的回调等功能，以及存储业务逻辑的集中位置。

数据集通常用于更底层的操作。

# c# - 覆盖渲染以将 Excel 文件写入响应挂起？

> ID：13689720
> 
> 赞同：0
> 
> 时间：2012-12-03T18:50:05.873
> 
> 标签：c#, asp.net, .net, webforms

我`Render`像这样压倒一切：

```
protected override void Render(HtmlTextWriter writer)
{
    var keyCheck = HttpContext.Current.Session["PaymentSearchResults"];

    if (_exportToExcel && keyCheck != null)
    {
        ExportToExcel();
        return;
    }

    base.Render(writer);
} 
```

要下载我在`ExportToExcel`方法中添加到响应中的 Excel 文件，如下所示：

```
File.WriteAllBytes(tempFileName, buffer);

Response.ContentType = "application/ms-excel";
Response.WriteFile(tempFileName);

HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

但是，响应永远不会返回到浏览器，因此浏览器只是挂起。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:53:08.517

这就是我在按钮单击事件中使用的。奇迹般有效。

```
HttpContext httpCtx = System.Web.HttpContext.Current;

httpCtx.Response.Clear();
httpCtx.Response.AddHeader("content-disposition", string.Format("attachment; filename={0}", fileName));
httpCtx.Response.ContentType = "application/vnd.ms-excel";
httpCtx.Response.Charset = "utf-8";

httpCtx.Response.WriteFile(filePath);

httpCtx.Response.End(); 
```

# c - 骑士巡回赛递归

> ID：13689725
> 
> 赞同：1
> 
> 时间：2012-12-03T18:50:48.003
> 
> 标签：c, recursion, knights-tour

我正在尝试编写骑士巡回递归算法：

```
int mov[8][2] = {{2,1},{2,-1},{-2,1},{-2,-1},{1,2},{-1,2},{1,-2},{-1,-2}};

typedef struct element {
    int x;
    int y;
    struct element *prev, *next;
} node; 

//adding pool to list
void dEnd(node **root, int x,int y)
{
    node *pos;
    pos = *root;
    while(pos->next!= NULL)
    pos = pos->next;
    pos->next = (node *)malloc(sizeof(node));
    pos->next->x=x;
    pos->next->y=y;
    pos->next->prev=pos;
    pos->next->next=NULL;
}

void uEnd(node **root,int x,int y)
{
    node *pos;
    pos = *root;
    while(pos->x!= x && pos->y !=y)
    {
        pos = pos->next;
    }
    pos->prev->next=NULL;
    free(pos);
}

void printAll(node **root)
{
    node *pos = *root;
    while(pos->next)
    {
        printf("%d %d\n", pos->x,pos->y);
        pos = pos->next;
    }
}

int contains(int x,int y)
{
    return(((x >= 0 ) && (x <= 7)) && ((y >= 0) && (y <= 7)));
}
//find move
int searchForMove(int x, int y, int **tab, node **list, int *number)
{

    int i ;
    for(i = 0; i < 8; i++)
    {
        int nx, ny;
        nx = x + mov[i][0];
        ny = y + mov[i][1];
        if(contains(nx, ny) && !tab[nx][ny])
        {
            dEnd(list, nx, ny);
            tab[nx][ny] = 1;
            *number++;
            if(!searchForMove(nx,ny,tab,list,number))
            {
                uEnd(list,nx,ny);
                tab[nx][ny]=0;
                *number--;
            }
        }
    }
    if(i == 7 && *number <64)
        return 0;
    if(*number == 64)
        return 1;
} 
```

有人可以告诉我我在哪里犯了错误吗？我已经逐步检查了哪些池算法添加到列表中。添加 4,3 池然后 6,4 池后什么是大惊喜算法应该以 6,4 作为实际位置调用它自己，但我不知道为什么它以 4,3 作为实际位置调用它自己。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T06:16:20.393

OP主要有它。除了一些次要代码外，`*number`增量/减量在 2 个地方是错误的。

```
int searchForMove(int x, int y, int **tab, node **list, int *number) {
  ...
  // *number++;  // This increase the pointer to the next pointer.
  (*number)++; // This dereferences number and increases it.
  ...
    // *number--;
    (*number)--; // CD 
```

* * *

工作示例。“CD”暗示我的改变

```
// CD
#include <assert.h>
#include <inttypes.h>
#include <stddef.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

int mov[8][2] = { { 2, 1 }, { 2, -1 }, { -2, 1 }, { -2, -1 }, { 1, 2 },
        { -1, 2 }, { 1, -2 }, { -1, -2 } };

typedef struct element {
  int x;
  int y;
  struct element *prev, *next;
} node;

//adding pool to list
void dEnd(node **root, int x, int y) {
  node *pos;
  pos = *root;
  assert(pos); // CD
  while (pos->next != NULL)
    pos = pos->next;
  pos->next = (node *) malloc(sizeof(node));
  pos->next->x = x;
  pos->next->y = y;
  pos->next->prev = pos;
  pos->next->next = NULL;
}

void uEnd(node **root, int x, int y) {
  node *pos;
  pos = *root;
  while (pos->x != x && pos->y != y) {
    pos = pos->next;
  }
  pos->prev->next = NULL;
  free(pos);
}

void printAll(node **root) {
  node *pos = *root;
  unsigned i = 0; // CD
  uint64_t mask = 0; // CD
  while (pos->next) {
    // printf("%d %d\n", pos->x, pos->y);
    printf("%2u %d %d\n", i++, pos->x, pos->y); // CD prepend visit index.
    mask |= 1llu << (pos->x + 8*pos->y); // CD accumulate visited squares
    pos = pos->next;
  }
  printf("Mask %016" PRIX64 "\n", mask); // CD Show all locations visited
}

int contains(int x, int y) {
  return (((x >= 0) && (x <= 7)) && ((y >= 0) && (y <= 7)));
}

//find move
int searchForMove(int x, int y, int **tab, node **list, int *number) {
  int i;
  for (i = 0; i < 8; i++) {
    int nx, ny;
    nx = x + mov[i][0];
    ny = y + mov[i][1];
    if (contains(nx, ny) && !tab[nx][ny]) {
      dEnd(list, nx, ny);
      tab[nx][ny] = 1;

      // *number++;
      (*number)++; // CD

      if (!searchForMove(nx, ny, tab, list, number)) {
        uEnd(list, nx, ny);
        tab[nx][ny] = 0;

        // *number--;
        (*number)--; // CD

      }
    }
  }
  if (i == 7 && *number < 64)
    return 0;
  if (*number == 64)
    return 1;
  return 2;  // CD added
}

// All added by CD
int main(int argc, char *argv[]) {
  int tab0[8] = {0,0,0,0,0,0,0,0};
  int tab1[8] = {0,0,0,0,0,0,0,0};
  int tab2[8] = {0,0,0,0,0,0,0,0};
  int tab3[8] = {0,0,0,0,0,0,0,0};
  int tab4[8] = {0,0,0,0,0,0,0,0};
  int tab5[8] = {0,0,0,0,0,0,0,0};
  int tab6[8] = {0,0,0,0,0,0,0,0};
  int tab7[8] = {0,0,0,0,0,0,0,0};
  int *tab[8] = {tab0, tab1, tab2, tab3, tab4, tab5, tab6, tab7 };
  node HeadNode = { 0, 0, NULL, NULL };
  node *pHeadNode = &HeadNode;
  int number = 0;
  int result;
  result = searchForMove(0, 0, tab, &pHeadNode, &number);
  printAll(&pHeadNode);
  return result;
} 
```

# jsf - Primefaces 主题配置

> ID：13689731
> 
> 赞同：2
> 
> 时间：2012-12-03T18:51:32.920
> 
> 标签：jsf, jsf-2, primefaces

我正在 Primefaces 用户指南上研究 primefaces 主题。 [https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/primefaces/primefaces_users_guide_3_3.pdf](https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/primefaces/primefaces_users_guide_3_3.pdf)在第 页。457 您可以阅读：“下载主题后，配置 PrimeFaces 以使用它

```
<context-param>

    <param-name>primefaces.THEME</param-name>

    <param-value>aristo</param-value>
</context-param> 
```

我应该把它放在哪里？进入我正在开发的网页文件？我选择了 Redmond 主题的 jar 文件并将其导入到我的 Eclipse Dynamic Web 项目中，但我没有看到任何改进。

我正在测试的 Primefaces 示例是：[https ://www.primefaces.org/showcase/ui/data/datatable/basic.xhtml](https://www.primefaces.org/showcase/ui/data/datatable/basic.xhtml)

**汽车.java**

```
import java.util.Date;

public class Car {

        private String model;
        private int year;
        private String manufacturer;
        private String color;

        public Car(String model, int year, String manufacturer, String color) {
                this.model = model;
                this.year = year;
                this.manufacturer = manufacturer;
                this.color = color;
        }

        public String getModel() {
                return model;
        }

        public void setModel(String model) {
                this.model = model;
        }

        public int getYear() {
                return year;
        }

        public void setYear(int year) {
                this.year = year;
        }

        public String getManufacturer() {
                return manufacturer;
        }

        public void setManufacturer(String manufacturer) {
                this.manufacturer = manufacturer;
        }

        public String getColor() {
                return color;
        }

        public void setColor(String color) {
                this.color = color;
        }
} 
```

**TableBean.java**

```
package classi;

import java.io.Serializable;  
import java.util.ArrayList;  
import java.util.List;  
import java.util.UUID;  
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import org.primefaces.context.RequestContext;

@ManagedBean(name="tableBean")
@SessionScoped
public class TableBean implements Serializable
{  
    private final static String[] colors;  

    private final static String[] manufacturers;  

    private List<Car> carsSmall;  
    static {  
        colors = new String[10];  
        colors[0] = "Black";  
        colors[1] = "White";  
        colors[2] = "Green";  
        colors[3] = "Red";  
        colors[4] = "Blue";  
        colors[5] = "Orange";  
        colors[6] = "Silver";  
        colors[7] = "Yellow";  
        colors[8] = "Brown";  
        colors[9] = "Maroon";  

        manufacturers = new String[10];  
        manufacturers[0] = "Mercedes";  
        manufacturers[1] = "BMW";  
        manufacturers[2] = "Volvo";  
        manufacturers[3] = "Audi";  
        manufacturers[4] = "Renault";  
        manufacturers[5] = "Opel";  
        manufacturers[6] = "Volkswagen";  
        manufacturers[7] = "Chrysler";  
        manufacturers[8] = "Ferrari";  
        manufacturers[9] = "Ford";  
    }  

    public TableBean() {  
        carsSmall = new ArrayList<Car>();  

        populateRandomCars(carsSmall, 9);  
    }  

    private void populateRandomCars(List<Car> list, int size) {  
        for(int i = 0 ; i < size ; i++)  
            list.add(new Car(getRandomModel(), getRandomYear(), getRandomManufacturer(), getRandomColor()));  
    }  

    public List<Car> getCarsSmall() {  
        return carsSmall;  
    }  

    private int getRandomYear() {  
        return (int) (Math.random() * 50 + 1960);  
    }  

    private String getRandomColor() {  
        return colors[(int) (Math.random() * 10)];  
    }  

    private String getRandomManufacturer() {  
        return manufacturers[(int) (Math.random() * 10)];  
    }  

    private String getRandomModel() {  
        return UUID.randomUUID().toString().substring(0, 8);  
    }  
} 
```

**表.xhtml**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Insert title here</title>
</head>
<body>
<h:form>  
    <p:dataTable var="car" value="#{tableBean.carsSmall}">  
        <p:column headerText="Model">  
            <h:outputText value="#{car.model}" />  
        </p:column>  

        <p:column headerText="Year">  
            <h:outputText value="#{car.year}" />  
        </p:column>  

        <p:column headerText="Manufacturer">  
            <h:outputText value="#{car.manufacturer}" />  
        </p:column>  

        <p:column headerText="Color">  
            <h:outputText value="#{car.color}" />  
        </p:column>  
    </p:dataTable>  
</h:form>  
</body>
</html> 
```

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0">
  <display-name>PrimeFaces_DataTable</display-name>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping>
  <context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>resources.application</param-value>
  </context-param>
  <context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>client</param-value>
  </context-param>
  <context-param>
    <param-name>primefaces.THEME</param-name>
    <param-value>redmond</param-value>
  </context-param>
  <context-param>
    <description>
    This parameter tells MyFaces if javascript code should be allowed in
    the rendered HTML output.
    If javascript is allowed, command_link anchors will have javascript code
    that submits the corresponding form.
    If javascript is not allowed, the state saving info and nested parameters
    will be added as url parameters.
    Default is 'true'</description>
    <param-name>org.apache.myfaces.ALLOW_JAVASCRIPT</param-name>
    <param-value>true</param-value>
  </context-param>
  <context-param>
    <description>
    If true, rendered HTML code will be formatted, so that it is 'human-readable'
    i.e. additional line separators and whitespace will be written, that do not
    influence the HTML code.
    Default is 'true'</description>
    <param-name>org.apache.myfaces.PRETTY_HTML</param-name>
    <param-value>true</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.DETECT_JAVASCRIPT</param-name>
    <param-value>false</param-value>
  </context-param>
  <context-param>
    <description>
    If true, a javascript function will be rendered that is able to restore the
    former vertical scroll on every request. Convenient feature if you have pages
    with long lists and you do not want the browser page to always jump to the top
    if you trigger a link or button action that stays on the same page.
    Default is 'false'
</description>
    <param-name>org.apache.myfaces.AUTO_SCROLL</param-name>
    <param-value>true</param-value>
  </context-param>
  <listener>
    <listener-class>org.apache.myfaces.webapp.StartupServletContextListener</listener-class>
  </listener>
</web-app> 
```

**项目结构截图** [http://i.imgur.com/tgrMH.png](https://i.imgur.com/tgrMH.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-05T12:06:44.383

一位用户告诉我我必须编辑

```
<head> and </head> 
```

进入

```
<h:head> and </h:head> 
```

有效 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T18:59:01.810

您必须将主题 jar 放在 WebContent/WEB-INF/lib 文件夹中，我不知道您是如何部署项目的，所以您可能也必须将 primefaces jar 放在那里，这样它就会在部署的项目。

jar 就位后，您必须编辑 web.xml 文件以指示您将使用的主题。以 Redmond 为例：

```
<context-param>

    <param-name>primefaces.THEME</param-name>

    <param-value>redmond</param-value>
</context-param> 
```

# delphi - 显示 TImage 部分变暗

> ID：13689732
> 
> 赞同：2
> 
> 时间：2012-12-03T18:51:33.970
> 
> 标签：delphi, delphi-7

我正在尝试制作一个如下所示的裁剪工具：

**原图：**

![在此处输入图像描述](../Images/216ba96a65e5d69ef2bcf318efcb7472.png)

**裁剪工具 - 这就是我想要的：**

![在此处输入图像描述](../Images/2dd65c02efae445a6e42ccff50ec6ad2.png)

请注意，裁剪区域显示的是原始颜色，并且周围的颜色很暗。

* * *

我所做的是`TShape`在我`TImage`的属性上放置一个：

```
object Shape1: TShape
  Brush.Color = clSilver
  Pen.Mode = pmMask
  Pen.Style = psDot
end 
```

我计划使用 TShape 进行重新调整大小/应对控制。这是它在 Delphi 中的样子：

![在此处输入图像描述](../Images/ba7cf6a099ef02f45bbd8f482e6dc547.png)

如您所见，它看起来不太好（调色板看起来抖动），但主要问题是我需要将昏暗区域围绕裁剪区域，而不是在中心。我试图用另一个 TShpae 覆盖整个 TImage，尝试了不同的`Pen.Mode`组合但没有好的结果，我认为我的方法/方法很糟糕。

您对如何实现所需行为有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T19:17:47.950

这里缺少一小部分，但添加应该不是问题......

```
unit Unit3;
// 20121108 by Thomas Wassermann
interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, jpeg;

type
  TForm3 = class(TForm)
    Image1: TImage;
    PaintBox1: TPaintBox;
    procedure FormCreate(Sender: TObject);
    procedure PaintBox1Paint(Sender: TObject);
    procedure PaintBox1MouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer);
    procedure PaintBox1MouseMove(Sender: TObject; Shift: TShiftState; X, Y: Integer);
  private
    { Private-Deklarationen }
    FDownPoint, FCurrentPoint: TPoint;
  public
    { Public-Deklarationen }
  end;

var
  Form3: TForm3;

implementation

uses Math;
{$R *.dfm}

procedure TForm3.FormCreate(Sender: TObject);
begin
  PaintBox1.BringToFront;
end;

type
  pRGBQuadArray = ^TRGBQuadArray;
  TRGBQuadArray = ARRAY [0 .. $EFFFFFF] OF TRGBQuad;

Procedure SetAlpha(bmp: TBitMap; Alpha: Byte; R: TRect);
var
  pscanLine32: pRGBQuadArray;
  i, j: Integer;
begin
  bmp.PixelFormat := pf32Bit;
  bmp.HandleType := bmDIB;
  bmp.ignorepalette := true;
  bmp.alphaformat := afDefined;
  for i := 0 to bmp.Height - 1 do
  begin
    pscanLine32 := bmp.Scanline[i];
    for j := 0 to bmp.Width - 1 do
    begin
      if (j >= R.Left) and (j <= R.Right) and (i >= R.Top) and (i <= R.Bottom) then
      begin
        pscanLine32[j].rgbReserved := 0;
        pscanLine32[j].rgbBlue := 0;
        pscanLine32[j].rgbRed := 0;
        pscanLine32[j].rgbGreen := 0;
      end
      else
      begin
        pscanLine32[j].rgbReserved := Alpha;
        pscanLine32[j].rgbBlue := Alpha;
        pscanLine32[j].rgbRed := Alpha;
        pscanLine32[j].rgbGreen := Alpha;
      end;
    end;
  end;
end;

procedure TForm3.PaintBox1MouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer);
begin
  FDownPoint.X := X;
  FDownPoint.Y := Y;
  FCurrentPoint := FDownPoint;
  PaintBox1.Invalidate;
end;

procedure TForm3.PaintBox1MouseMove(Sender: TObject; Shift: TShiftState; X, Y: Integer);
begin
  if ssLeft in Shift then
  begin
    FCurrentPoint.X := X;
    FCurrentPoint.Y := Y;
    PaintBox1.Invalidate;
  end;
end;

procedure TForm3.PaintBox1Paint(Sender: TObject);
var
  bmp: TBitMap;
  SelRect: TRect;
begin
  bmp := TBitMap.Create;
  try
    bmp.Width := PaintBox1.Width;
    bmp.Height := PaintBox1.Height;
    if (FCurrentPoint.X = FDownPoint.X) and (FCurrentPoint.Y = FDownPoint.Y) then
      SelRect := PaintBox1.BoundsRect
    else
    begin
      SelRect.Left := Min(FCurrentPoint.X, FDownPoint.X);
      SelRect.Top := Min(FCurrentPoint.Y, FDownPoint.Y);
      SelRect.Right := Max(FCurrentPoint.X, FDownPoint.X);
      SelRect.Bottom := Max(FCurrentPoint.Y, FDownPoint.Y);
    end;
    SetAlpha(bmp, 140, SelRect);
    PaintBox1.Canvas.Draw(0, 0, bmp);
  finally
    bmp.Free;
  end;
end;

end. 
```

此解决方案的尝试是使用与图像相同的客户端矩形的覆盖画框进行所有绘图和选择。通过使用鼠标/向下/移动生成的坐标，创建了一个半透明的位图，它在选定的矩形中是完全透明的。生成后，它被绘制在颜料盒上。可以在那里进行进一步的绘画，例如框架、锚点、十字准线。任何用户操作都必须在 mousedown 中捕获，具体取决于所选部分，例如可以完成矩形大小的锚点。通常我更喜欢 GDI+ 来处理这样的请求，但如图所示，不需要额外的单元。来源：[http ://www.bummisoft.de/download/transparenteauswahl.zip](http://www.bummisoft.de/download/transparenteauswahl.zip) ![演示](../Images/ac561afacef97c1563249c21166570ab.png)

# android - Android中的内发光

> ID：13689734
> 
> 赞同：0
> 
> 时间：2012-12-03T18:51:36.933
> 
> 标签：android, layout, glow

> **可能重复：**
> [如何使文本发光？](https://stackoverflow.com/questions/5692804/how-to-make-text-glow)

我想知道如何在我的 Android 布局中向 TextView 添加内部发光。

我已经搜索过，只能找到如何在 Android 上做 Inner Shadow。

请问有没有一种方便快捷的方法来让内部发光围绕一个TextView，或者获得类似的效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:54:04.527

您必须在 TextView中使用`android:shadowColor`, `android:shadowDx`, `android:shadowDy`&`android:shadowRadius`

# c - 在C中将字符串传递给popen时保留双引号

> ID：13689738
> 
> 赞同：2
> 
> 时间：2012-12-03T18:52:17.227
> 
> 标签：c, ssh, grep, popen, printf

我正处于两难境地，我试图通过 C 中的 popen 传递一个字符串，但让它保持字符串中的双引号。该字符串如下所示：

```
ssh %s@%s grep -c \"%s\" %s%s 
```

我需要运行此命令，以便它从远程系统上的日志中 greps 并返回它的计数。我通过字符串传递不同的参数，因此它生成用户名和密码以及搜索字符串和目标。但是，搜索字符串包含由空格字符分隔的多个单词，因此我需要完整的双引号，以便正确解析搜索字符串。但是，到目前为止，popen 一直在从字符串中去除双引号，因此搜索没有完成。我不确定执行远程 ssh 命令的另一种方法，或者在语句中保留双引号。有任何想法吗？

谢谢！

*编辑：这是我用来生成字符串以及 popen 命令的完整 sprintf 语句。

```
sprintf(command, "ssh %s@%s grep -c \"%s\" %s%s", user, server, search, path, file);
fd = popen(command, "r"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:04:34.117

`popen`派生一个执行带有 2 个参数的 shell 的子进程：`-c`以及传递给 popen 的命令字符串。因此，您传递的任何对 shell 有意义的字符都需要转义，以便 shell 对它们进行正确的处理。在您的情况下，您需要外壳程序来`"`保留字符，以便远程外壳程序可以获取它们，这是最简单的方法，方法是`'`在它们周围加上引号：

```
sprintf(command, "ssh %s@%s grep -c '\"%s\"' %s%s", ... 
```

但是，这仅在您的搜索字符串不包含任何`'`或`"`字符时才有效——如果包含，您需要进行一些更复杂的转义。您可以改为使用反斜杠转义：

```
sprintf(command, "ssh %s@%s grep -c \\\"%s\\\" %s%s", ... 
```

但如果您的搜索字符串有引号或多个连续空格或其他空格（如制表符），这将失败。要处理所有情况，您需要首先在搜索字符串中的所有相关字符之前插入反斜杠，`'`而且处理起来很痛苦：

```
// allocate 4*strlen(search)+1 space as escaped_search
for (p1 = search, p2 = escaped_search; *p1;) {
    if (*p1 == '\'') *p2++ '\'';
    if (strchr(" \t\r\n\"\\'{}()<>;&|`$", *p1))
        *p2++ = '\';
    if (*p1 == '\'') *p2++ '\'';
    *p2++ = *p1++; }
*p2 = '\0';
sprintf(command, "ssh %s@%s grep -c '%s' %s%s", user, server, escaped_search, ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:57:11.633

正如其他人在这里解释的那样，引用有时会很麻烦。

为了避免过度引用，只需将命令通过管道传输到 ssh 的标准输入中。就像下面的 bash 代码一样：

```
ssh remote_host <<EOF
grep -c "search string" path
EOF 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:06:17.370

经过一些实验，这似乎是您所需要的：

```
snprintf(command, sizeof(command), "ssh %s@%s grep -c \\\"%s\\\" %s%s",
         username, hostname, search_string, directory, file); 
```

您需要多个反斜杠，因为涉及多个反斜杠解释器。

1.  C 编译器：它将每个三个反斜杠序列中的前两个反斜杠视为一个反斜杠。第三个反斜杠转义双引号，在`command`字符串中嵌入双引号。然后命令字符串包含`\"`两次。
2.  还有另一个处理反斜杠的过程，决定它在哪里有点棘手，但需要它们才能获得正确的结果，如实验所示。

## 工作代码——远程执行，正确的结果

这是一些演示代码工作。本地程序被调用`pop`。里面的所有东西都是硬连线的，因为我很懒（但我把远程主机名与我实际测试过的主机名相比）。该程序`/u/jleffler/linux/x86_64/bin/al`列出其收到的参数，每行一个。对于这种情况，我发现它是一个非常有用的工具。请注意，参数`al`是用双空格精心制作的，以显示参数何时被视为一对多。

```
$ ./pop
Command: <<ssh jleffler@remote.example.com /u/jleffler/linux/x86_64/bin/al \"x  y  z\" \"pp qq rr\">>
jleffler@remote.example.com's password: 
Response: <<x y z>>
Response: <<pp qq rr>>
$ 
```

### 代码

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char command[512];
    char const *arg1 = "x  y  z";
    char const *arg2 = "pp qq rr";
    char const *cmd  = "/u/jleffler/linux/x86_64/bin/al";
    char const *hostname = "remote.example.com";
    char const *username = "jleffler";

    snprintf(command, sizeof(command), "ssh %s@%s %s \\\"%s\\\" \\\"%s\\\"",
             username, hostname, cmd, arg1, arg2);

    printf("Command: <<%s>>\n", command);
    FILE *fp = popen(command, "r");
    char line[512];
    while (fgets(line, sizeof(line), fp) != 0)
    {
        line[strlen(line)-1] = '\0';
        printf("Response: <<%s>>\n", line);
    }
    pclose(fp);
    return(0);
} 
```

## 变体 1——远程执行，错误的结果

```
$ ./pop1
Command: <<ssh jleffler@remote.example.com /u/jleffler/linux/x86_64/bin/al "x  y  z" "pp qq rr">>
jleffler@remote.example.com's password: 
Response: <<x>>
Response: <<y>>
Response: <<z>>
Response: <<pp>>
Response: <<qq>>
Response: <<rr>>
$ 
```

### 代码

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char command[512];
    char const *arg1 = "x  y  z";
    char const *arg2 = "pp qq rr";
    char const *cmd  = "/u/jleffler/linux/x86_64/bin/al";
    char const *hostname = "remote.example.com";
    char const *username = "jleffler";

    snprintf(command, sizeof(command), "ssh %s@%s %s \"%s\" \"%s\"",
             username, hostname, cmd, arg1, arg2);

    printf("Command: <<%s>>\n", command);
    FILE *fp = popen(command, "r");
    char line[512];
    while (fgets(line, sizeof(line), fp) != 0)
    {
        line[strlen(line)-1] = '\0';
        printf("Response: <<%s>>\n", line);
    }
    pclose(fp);
    return(0);
} 
```

## 变体 2 — 本地执行，（不同）错误结果

```
$ ./pop2
Command: <<al jleffler@remote.example.com /u/jleffler/linux/x86_64/bin/al \"x  y  z\" \"pp qq rr\">>
Response: <<jleffler@remote.example.com>>
Response: <</u/jleffler/linux/x86_64/bin/al>>
Response: <<"x>>
Response: <<y>>
Response: <<z">>
Response: <<"pp>>
Response: <<qq>>
Response: <<rr">>
$ 
```

本地 shell 在双引号之前不需要反斜杠；事实上，添加它会出错。

### 代码

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char command[512];
    char const *arg1 = "x  y  z";
    char const *arg2 = "pp qq rr";
    char const *cmd  = "/u/jleffler/linux/x86_64/bin/al";
    char const *hostname = "remote.example.com";
    char const *username = "jleffler";

    snprintf(command, sizeof(command), "al %s@%s %s \\\"%s\\\" \\\"%s\\\"",
             username, hostname, cmd, arg1, arg2);

    printf("Command: <<%s>>\n", command);
    FILE *fp = popen(command, "r");
    char line[512];
    while (fgets(line, sizeof(line), fp) != 0)
    {
        line[strlen(line)-1] = '\0';
        printf("Response: <<%s>>\n", line);
    }
    pclose(fp);
    return(0);
} 
```

### 变体 3 — 本地执行，正确的结果

```
$ ./pop3  
Command: <<al jleffler@remote.example.com /u/jleffler/linux/x86_64/bin/al "x  y  z" "pp qq rr">>
Response: <<jleffler@remote.example.com>>
Response: <</u/jleffler/linux/x86_64/bin/al>>
Response: <<x  y  z>>
Response: <<pp qq rr>>
$ 
```

### 代码

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char command[512];
    char const *arg1 = "x  y  z";
    char const *arg2 = "pp qq rr";
    char const *cmd  = "/u/jleffler/linux/x86_64/bin/al";
    char const *hostname = "remote.example.com";
    char const *username = "jleffler";

    snprintf(command, sizeof(command), "al %s@%s %s \"%s\" \"%s\"",
             username, hostname, cmd, arg1, arg2);

    printf("Command: <<%s>>\n", command);
    FILE *fp = popen(command, "r");
    char line[512];
    while (fgets(line, sizeof(line), fp) != 0)
    {
        line[strlen(line)-1] = '\0';
        printf("Response: <<%s>>\n", line);
    }
    pclose(fp);
    return(0);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:11:57.253

问题不在于也不`sprintf`在于`popen`。问题是调用`ssh`. 它是剥去你的引号的外壳。

您可以简单地打开一个终端并手动尝试。你会看到

```
ssh user@server grep -c "search string" path 
```

如果搜索字符串包含空格，则无法按预期工作。您的 shell 使用引号，因此最终`grep`会收到不带引号的命令行并错误地解释它。

如果您希望引号持续存在，则必须为外壳转义它们。您要执行的命令是

```
ssh user@server grep -c \"search string\" path 
```

要使用形成这样的字符串，`sprintf`您还必须转义`"`和`\`字符（对于 C 编译器）意味着`\"`变成`\\\"`. 最终格式行如下

```
sprintf(command, "ssh %s@%s grep -c \\\"%s\\\" %s%s", user, server, search, path, file); 
```

当然，这仍然会受到克里斯多德回答中提到的其他问题的影响。

# ios - 如何从 Flash Builder 创建基于 HTML 的 AIR 应用程序？

> ID：13689742
> 
> 赞同：0
> 
> 时间：2012-12-03T18:52:33.477
> 
> 标签：ios, flash, mobile, air, flash-builder

由于在 iOS 下无法在子 swf 中运行代码，我试图让我的应用程序的顶部成为一个 HTML 页面，该页面选择要加载的 swf。我在 Flash Builder 中构建。

问题是在 app.xml 中指定的值

```
<initialWindow>
  <content>value</content>
</initialWindow> 
```

被项目 swf 的名称自动覆盖。我想将此值指定为 html 页面。这可以在 FlashBuilder 中完成还是我必须执行命令行 AIR？

谢谢，

--S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T01:25:34.163

你应该尝试另一种方法。无法创建基于 HTML 的移动应用程序，因为它们[不受支持](http://help.adobe.com/en_US/air/build/WSfffb011ac560372f-5d0f4f25128cc9cd0cb-8000.html)。您可以使用 StageWebView 对象显示 HTML 页面，但在 iOS 上不会呈现 swf 文件。

# asp.net - AjaxControlToolkit AutoCompleteExtender ...如何从 linq 查询中填写？

> ID：13689747
> 
> 赞同：0
> 
> 时间：2012-12-03T18:52:51.630
> 
> 标签：asp.net, linq, ajaxcontroltoolkit, autocompleteextender

放轻松...我是这方面的新手。

好的，我已将 AutoCompleteExtender 添加到我的网页中。用户将搜索标签添加到项目中，我希望文本框使用数据库中已经存在的标签自动完成。

我没有标签的“注册表”；只有一个带有 tagName 和 projectID 的表。因此，一个 tagName 可能会在表中重复多次。所以我只想在我的查询中返回不同的结果。（这很容易。）

但是我如何将它绑定到 AutoCompleteExtender？我不精通WebServices等...

我正在使用实体框架，仅供参考...

这是我在 aspx 页面上的自动完成代码：

```
<asp:TextBox ID="TagNameTextBox" runat="server"></asp:TextBox>

<ajaxToolkit:AutoCompleteExtender ID="TagNameTextBox_AutoCompleteExtender" 
runat="server"    
ServiceMethod="GetCompletionList" 
 MinimumPrefixLength="2" 
 EnableCaching="false" 
DelimiterCharacters="" 
Enabled="True" 
TargetControlID="TagNameTextBox"> 
</ajaxToolkit:AutoCompleteExtender> 
```

这是我的 linq 查询：

```
 var qrygettags = (from t in db.TagTables
                          select new { t.TagName }).Distinct().ToString(); 
```

我也找到了一些 jquery 解决方案的示例，但我不知道如何将我的查询转换为该格式。任何帮助或想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:07:45.273

好吧，我一直在寻找这个看似简单的解决方案，它对我有用。

在 aspx 页面中，在控件中，我有

```
ServiceMethod="GetTagNames" 
```

在cs页面中，我在页面加载中添加了这个：

```
[System.Web.Services.WebMethod]
public static string[] GetTagNames(string prefixText, int count)
{
    mydatabase db = new mydatabase();
    return db.TagTables.Where(n => n.TagName.StartsWith(prefixText)).OrderBy(n => n.TagName).Select(n => n.TagName).Distinct().Take(count).ToArray();
} 
```

希望它会帮助其他人！

# java - 在重置之前检查重置值的值 - 性能影响？

> ID：13689753
> 
> 赞同：4
> 
> 时间：2012-12-03T18:53:24.373
> 
> 标签：java, performance, variables

我有一个每秒被读取和更新数千次的变量。它需要定期重置。但是“一半”的时候，该值已经是复位值。在重置（写操作）之前先检查值（看看是否需要重置）是个好主意，还是无论如何我都应该重置它？主要目标是优化代码以提高性能。

为了显示：

```
Random r = new Random();
int val = Integer.MAX_VALUE;

for (int i=0; i<100000000; i++) {
    if (i % 2 == 0)
        val = Integer.MAX_VALUE;
    else
        val = r.nextInt();

    if (val != Integer.MAX_VALUE) //skip check?
        val = Integer.MAX_VALUE;
} 
```

我尝试使用上述程序来测试 2 个场景（通过取消/注释第二个“if”行），但任何差异都被运行持续时间的自然变化所掩盖。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:59:54.790

不要检查它。

更多的执行步骤 = 更多的周期 = 更多的时间。

顺便说一句，您正在打破基本的软件黄金法则之一：“不要过早优化”。除非你有确凿的证据证明这段代码是一个性能问题，否则你不应该看它。（请注意，这并不意味着您在编写代码时没有考虑性能，您仍然遵循正常的最佳实践，但您不会添加任何唯一目的是“与性能相关”的特殊代码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:59:33.537

该检查没有实际的性能影响。我们将谈论单个时钟周期或其他东西，这通常与 Java 程序无关（因为在 Java 中通常不进行硬核数字运算）。

相反，应根据可读性做出决定。想想五年后要更改这段代码的维护者。

在你的例子中，使用我的理由，我会跳过检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:01:48.670

JIT 很可能会优化代码，因为它什么都不做。

与其担心性能，通常不如担心它是什么

*   更容易理解
*   更清洁的实施

在这两种情况下，您都可以删除代码，因为它没有做任何有用的事情，而且还可以使代码更快。

即使它确实使代码变慢了一点，与`r.nextInt()`不便宜的调用成本相比，它也会非常小。

# c# - 如何在 ASPX 中引用变量后面的代码？

> ID：13689763
> 
> 赞同：1
> 
> 时间：2012-12-03T18:53:52.470
> 
> 标签：c#, asp.net, .net

我不确定为什么在 asp.net 控件中引用变量后面的代码时，我得到了引用的文本：

```
<%=this.Person.Contact.Emails[0].EmailAddress%> 
```

这将输出文字参考文本：

```
<asp:TextBox ID="EmailAddress" runat="server" Text="<%=this.Person.Contact.Emails[0].EmailAddress%>"></asp:TextBox> 
```

这将呈现变量值：

```
<input id="testfield" type="text" value="<%=this.Person.Contact.Emails[0].EmailAddress%>" /> 
```

任何想法如何在 asp.net 控件中获取变量值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:56:39.967

你可以说：

```
EmailAddress.Text = this.Person.Contact.Emails[0].EmailAddress 
```

在你后面的代码中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:20:03.047

我更喜欢 Hunter's 解决方案中 Code Behind 中的解决方案，但另一种选择是使用带有 # 的数据绑定：

```
<asp:TextBox ID="EmailAddress" runat="server" Text="<%# this.Person.Contact.Emails[0].EmailAddress%>" /> 
```

但是你必须在代码隐藏中绑定服务器控件：

```
EmailAdress.DataBind(); 
```

= 符号就像`Response.Write()`在这个地方的调用，只是将后面的内容输出为文本。

# artificial-intelligence - 权重初始化

> ID：13689765
> 
> 赞同：7
> 
> 时间：2012-12-03T18:53:59.273
> 
> 标签：artificial-intelligence, neural-network

我计划将 Nguyen-Widrow 算法用于具有**多个隐藏层**的 NN 。在研究过程中，我发现了很多模棱两可的地方，我希望澄清它们。

以下是 Nguyen-Widrow 算法的伪代码

```
 Initialize all weight of hidden layers with random values
      For each hidden layer{
          beta = 0.7 * Math.pow(hiddenNeurons, 1.0 / number of inputs);
          For each synapse{
             For each weight{
              Adjust weight by dividing by norm of weight for neuron and * multiplying by beta value
            }
          } 
      } 
```

**只是想澄清 hiddenNeurons 的值是特定隐藏层的大小，还是网络中所有隐藏层的大小。**我通过查看各种来源混淆了。

换句话说，如果我有一个网络 (3-2-2-2-3) *（索引 0 是输入层，索引 4 是输出层）*，那么 hiddenNeurons 的值会是：

```
NumberOfNeuronsInLayer(1) + NumberOfNeuronsInLayer(2) + NumberOfNeuronsInLaer(3) 
```

要不就

> NumberOfNeuronsInLayer(i) ，其中 i 是我所在的当前层

编辑：

那么，hiddenNeurons 值将是当前隐藏层的大小，而输入值将是前一个隐藏层的大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:46:37.060

*Nguyen-Widrow*初始化算法如下：

1.  使用（范围）随机值初始化隐藏层的所有权重

2.  对于每个隐藏层
    2.1 计算 beta 值，0.7 * Nth(#neurons of input layer)
    每个突触的当前层 2.2 #neurons 的根
    2.1.1 每个权重
    2.1.2 通过除以神经元的权重范数来调整权重和乘以贝塔值

[Encog Java 框架](http://code.google.com/p/encog-java/source/browse/branches/2.5.0/encog-core/src/org/encog/mathutil/randomize/NguyenWidrowRandomizer.java)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T15:11:05.397

听起来你想要更精确的代码。以下是我参与的项目中的一些实际代码行。希望您阅读 C。它有点抽象和简化。有一个`struct nn`, 保存神经网络数据。您可能有自己的抽象数据类型。

我的项目中的代码行（有些简化）：

```
float *w = nn->the_weight_array;
float factor = 0.7f * powf( (float) nn->n_hidden, 1.0f / nn->n_input);

for( w in all weight )
    *w++ = random_range( -factor, factor );

/* Nguyen/Widrow */
w = nn->the_weight_array;
for( i = nn->n_input; i; i-- ){
    _scale_nguyen_widrow( factor, w, nn->n_hidden );
    w += nn->n_hidden;
} 
```

调用的函数：

```
static void _scale_nguyen_widrow( float factor, float *vec, unsigned int size )
{
    unsigned int i;
    float magnitude = 0.0f;
    for ( i = 0; i < size; i++ )
        magnitude += vec[i] * vec[i];

    magnitude = sqrtf( magnitude );

    for ( i = 0; i < size; i++ )
         vec[i] *= factor / magnitude;
}

static inline float random_range( float min, float max)
{
    float range = fabs(max - min);
    return ((float)rand()/(float)RAND_MAX) * range + min;
} 
```

**提示：**
在您实现了 Nguyen/Widrow 权重初始化之后，您实际上可以在前向计算中添加一个小代码行，将每个激活转储到一个文件中。然后你可以检查这组神经元对激活函数的影响程度。求均值和标准差。您甚至可以使用绘图工具绘制它，即。gnuplot。（无论如何，您都需要一个像 gnuplot 这样的绘图工具来绘制错误率等。）我为我的实现这样做了。情节很不错，在我的项目中使用 Nguyen/Widrow 使最初的学习变得更快。

PS：根据 Nguyen 和 Widrows 的意图，我不确定我的实施是否正确。我什至认为我不在乎，只要它确实改善了最初的学习。

祝你好运，
-Øystein

# tfs - TFS 2010 - 门户设置

> ID：13689769
> 
> 赞同：0
> 
> 时间：2012-12-03T18:54:09.823
> 
> 标签：tfs, tfs-2010

您似乎无法修改 TFS 2010 中门户设置的基本 URL。我目前有

```
http://tfsserver.mydomain.com 
```

我想启动系统

```
http://tfsserver 
```

相反，当用户从团队资源管理器中选择“显示项目门户”时。

是否可以更改它指向的站点根目录？我们不断收到 fqdn 的安全提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:03:25.830

我自己找到了答案。在应用程序层上，打开管理控制台，选择 SharePoint Web 应用程序并在那里更改基本 URL。

# c# - 使用 WSHttpBinding，默认情况下安全吗？

> ID：13689773
> 
> 赞同：0
> 
> 时间：2012-12-03T18:54:27.640
> 
> 标签：c#, wcf

我有一个 WCF 服务，最初是使用 BasicHttpBinding 设置的，但有人建议我切换到 WsHttpBinding，因为这样更安全。我看到有一种方法可以设置 WsHttpBinding 的安全功能，但我想知道它是否已经默认安全？来自我的服务的消息是否已经以某种格式加密，如果是这样，任何人都使用什么安全/算法，因为我们需要为项目提供文档并且使用安全需要让他们知道是哪一个。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:59:11.750

默认情况下，WsHttpBinding 将使用消息安全性，这意味着您的消息（有效负载）根据[WS-Security](http://en.wikipedia.org/wiki/WS-Security)规范进行加密和签名。但是，您可以在此基础上添加更多安全性，方法是使用带有 SSL 证书的传输安全性。Microsoft 有一篇非常[详细的关于 Message Security 的文章](http://msdn.microsoft.com/en-us/library/ms733137.aspx)，您绝对应该阅读。

# c++ - 具有较低 sys 时间的 C++ 计时方法

> ID：13689777
> 
> 赞同：0
> 
> 时间：2012-12-03T18:54:50.190
> 
> 标签：c++, timing

我正在尝试让我的程序自定时，我知道两种方法

1）使用getrusage

```
truct rusage startu; struct rusage endu;
getrusage(RUSAGE_SELF, &startu); 

//Do computation here

getrusage(RUSAGE_SELF, &endu);
double start_sec = start.ru_utime.tv_sec + startu.ru_utime.tv_usec/1000000.0; 
double end_sec = endu.ru_utime.tv_sec + endu.ru_utime.tv_usec/1000000.0; 
double duration = end_sec - start_sec; 
```

这将获取程序段的用户时间。

2) 使用clock()，获取处理器的执行时间

```
double start_sec = (double)clock()/CLOCKS_PER_SEC;

//Do computation here

double end_sec = (double)clock()/CLOCKS_PER_SEC;
double duration = end_sec - start_sec; 
```

这将获取程序段的实时时间。

但是，这两种方法的系统时间都很长。用户时间也比没有这些时间长。系统时间有时甚至是用户时间的两倍。

例如，我正在做旅行推销员问题，对于用户和实时运行大约 3 秒的输入，这两个时间都使用户时间超过 5 秒和实时超过 15 秒，这意味着 sys时间大约是 10 秒长。

如果可能的话，我希望知道是否有改进方法或其他库能够缩短系统时间和用户时间。如果我必须使用其他库，我想要用户时间计时和实时计时的库。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:00:19.207

我建议仔细阅读[time(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/time.7.html)手册页并考虑[clock_gettime(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/clock_gettime.2.html)系统调用。

# google-chrome - 无效或意外的 MouseEvent 对象

> ID：13689780
> 
> 赞同：0
> 
> 时间：2012-12-03T18:55:01.180
> 
> 标签：google-chrome, google-chrome-extension, mouseevent, offscreentabs

我正在尝试将[鼠标事件](https://developer.chrome.com/trunk/extensions/experimental.offscreenTabs.html#method-sendMouseEvent)发送到我的屏幕外选项卡，但收到以下错误：

```
Error during experimental.offscreenTabs.sendMouseEvent:
 Invalid or unexpected MouseEvent object 
```

**我的代码：**

```
chrome.experimental.offscreenTabs.sendMouseEvent(tab.id, {
    "type": "click",
    "altKey": false,
    "ctrlKey": false,
    "shiftKey": false
}, {
    "x": 10,
    "y": 10
}, function () {
    console.log("Mouse Event Sent");
}); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:15:14.960

`button`如果您使用鼠标事件，您还需要添加一个键。

```
{
    "type": "click",
    "button": 1,      // 0 = left, 1 = middle, 2 = right
    "altKey": false,
    "ctrlKey": false,
    "shiftKey": false
} 
```

由于 API 是实验性的，而且文档还不是很完整，所以我查看了源代码：

*   [chromium/src/chrome/browser/extensions/api/offscreen_tabs/offscreen_tabs_api.cc](http://code.google.com/searchframe#OAMlx_jo-ck/src/chrome/browser/extensions/api/offscreen_tabs/offscreen_tabs_api.cc)（offscreenTabs API的实现）
*   [chromium/src/third_party/WebKit/Source/WebKit/chromium/public/WebInputEvent.h](http://code.google.com/searchframe#OAMlx_jo-ck/src/third_party/WebKit/Source/WebKit/chromium/public/WebInputEvent.h&exact_package=chromium&q=ButtonLeft&l=292)（用于“按钮”常量的定义）。

PS。当我使用`button: 2`. 对于调试与屏幕外选项卡的交互非常有用！

# mysql - 使用聚合函数在查询和问题中从静态日期更改为更改日期 - MYSQL

> ID：13689782
> 
> 赞同：0
> 
> 时间：2012-12-03T18:55:03.240
> 
> 标签：mysql, database, aggregate-functions

我有以下查询：

```
SELECT Artist_no, SUM(purchasedate BETWEEN '2012-07-01' AND '2012-07-31') / 
                  SUM(purchasedate BETWEEN '2011-07-01' AND '2011-07-31')
FROM Sales 
```

这成功地返回了我的 CD 表“销售额”中销售额增加/减少的百分比。但是，我希望更改代码以列出 2011 年 7 月和 2012 年 7 月的具体日期，而不是今年 7 月，而不是去年 7 月。我知道现在运行这个新查询将获得相同的结果，但是我希望如果您在 100 年后执行此查询，该查询将测试 2111 年 7 月和 2112 年 7 月。

我自己尝试过这样做，但是当我运行代码时，我的答案是 NULL。不应该是这样，下面的新代码在这里（即使它不正确）：

```
SELECT SUM(purchasedate = YEAR(CURDATE() AND MONTH(purchasedate) = 7))
     / SUM(purchasedate = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND MONTH(purchasedate) = 7)) 
FROM Sales 
```

其次，如果有一个新艺术家有一张新CD，它会除以0，并且不会包含在结果中，但是例如2011年7月为0，2012年7月为398，显然应该包含这个在我的结果中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:04:16.237

尝试比较格式化的日期字符串，如下所示：

```
 SELECT SUM(date_format(purchasedate, '%m-%Y') = CONCAT('07-',YEAR(CURDATE()))
         / SUM(date_format(purchasedate, '%m-%Y') = 
                         CONCAT('07-',YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) 
   FROM Sales 
```

# python - 极地立体图

> ID：13689788
> 
> 赞同：4
> 
> 时间：2012-12-03T18:55:26.780
> 
> 标签：python, matplotlib, cartopy

是否可以使用最新版本的 cartopy 在极地立体地图上绘制等高线？我想看一个例子来说明这是如何完成的，因为我自己正在努力解决这个问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:22:51.920

立体投影引起了一些头痛，并且可能是对 cartopy 的多边形转换代码提出最多问题的投影。

以下示例显示了如何使用 cartopy 生成极坐标立体图。请注意：即使使用此代码，也可以调整示例数据分辨率并发现实际渲染该图需要大约 30 分钟（这是一个错误，我们需要尽快进行排序）。

```
import cartopy.crs as ccrs
import matplotlib.pyplot as plt

from cartopy.examples.waves import sample_data

ax = plt.axes(projection=ccrs.NorthPolarStereo())

x, y, z = sample_data((100, 200))
cs = ax.contourf(x, y, z, 50,
                 transform=ccrs.PlateCarree(),
                 cmap='gist_ncar')
ax.coastlines()

# without the set_global, currently, the plot is tiny because the limits
# are being erroneously being set (opened issue for that)
ax.set_global()

plt.show() 
```

![极地立体等高线图](../Images/80738efa557808c5807f560a665b9c0f.png)

希望这将向您展示*如何*在 cartopy 中制作极地立体等高线图。如果您的数据有问题，请查看[标记为“几何变换”的未解决问题](https://github.com/SciTools/cartopy/issues?labels=Geometry%20transforms&state=open)，看看您是否得到类似的东西，如果没有，[请继续打开一个问题](https://github.com/SciTools/cartopy/issues/new)，我们可以进行调查。

注意：这个答案与 cartopy v0.5.x（即在 v0.5 版本之前）有关，这里提到的许多错误应该有望在未来的版本中得到解决。

希望有帮助，

# google-app-engine - 手动将实体添加到空的 Google App Engine DataStore

> ID：13689792
> 
> 赞同：3
> 
> 时间：2012-12-03T18:55:38.183
> 
> 标签：google-app-engine, google-cloud-datastore

从我通过创建一个简单项目确认[的教程](https://developers.google.com/appengine/docs/python/gettingstartedpython27/usingdatastore)中，该`index.yaml`文件是在运行查询时自动生成的。我进一步观察到的是，在此之前管理控制台 ( `http://localhost:8080/_ah/admin/datastore`) 不会显示数据存储。

我的问题是：我有一个项目，要通过数据存储管理控制台手动添加数据/实体。该网站仅用于显示/检索数据，而不是向数据存储添加数据。

如何让我的数据存储出现在控制台上以便我可以添加数据？

是的，尝试通过浏览器从空的数据存储中检索，以便我可以`index.yaml`填充等。但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:13:08.040

最简单的方法可能只是在您的项目文件夹中创建一个小的 python 脚本并在脚本中创建您的实体。将其分配给您将使用一次然后禁用的 URL 处理程序。

您甚至可以从 python shell 中执行此操作。它对调试非常有用，但您需要设置一次。 [http://alex.cloudware.it/2012/02/your-app-engine-app-in-python-shell.html](http://alex.cloudware.it/2012/02/your-app-engine-app-in-python-shell.html)

为了在生产中执行相同的操作，请使用 remote_api： [https ://developers.google.com/appengine/articles/remote_api](https://developers.google.com/appengine/articles/remote_api)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:01:58.707

这是一个非常奇怪的问题。

自动创建`index.yaml`仅在本地发生，只是为了帮助您创建该文件并将其上传到 AppEngine。一旦该文件在服务器上，就不会自动创建或更新该文件：正如文档所解释的，除非相关索引已存在于 index.yaml 中，否则无法运行任何查询。

由于您需要索引来运行查询，因此您必须在本地创建该文件 - 手动或通过针对您的开发数据存储运行相关查询 - 然后将其与您的应用程序一起上传。

但是，这与数据存储查看器是否出现在管理员中完全没有关系。在线时，它将始终显示，但只会显示实际在商店中有实例的实体类型。数据存储查看器对您的模型一无所知，它只知道数据存储中存在的种类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-16T23:01:51.250

On your development server you can use [the interactive console](http://localhost:8000/console) to create/instantiate/save an entity, which should cause the entity class to appear in the datastore interface, like so:

```
from google.appengine.ext import ndb

class YourEntityModel(ndb.Model):
    pass

YourEntityModel().put() 
```

# asp.net-mvc-3 - MVC3从模型中为文本框设置默认值

> ID：13689796
> 
> 赞同：3
> 
> 时间：2012-12-03T18:56:00.460
> 
> 标签：asp.net-mvc-3, default-value, html.textboxfor

我有一个使用创建的文本框

```
@Html.TextBoxFor(m => m.Model1.field1, new { @class = "login-input", @name="Name",  @Value = "test" }) 
```

我想将此文本框的默认值从“文本”更改为存储在模型字段中的值。如何将模型字段设置为值属性？假设要调用的模型名称是Model2，属性是field2。如何将文本框的值设置为 field2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:21:34.277

您必须首先编写一个扩展方法，如下所示：

```
public class ObjectExtensions
{
    public static string Item<TItem, TMember>(this TItem obj, Expression<Func<TItem, TMember>> expression)
    {
        if (expression.Body is MemberExpression)
        {
            return ((MemberExpression)(expression.Body)).Member.Name;
        }
        if (expression.Body is UnaryExpression)
        {
            return ((MemberExpression)((UnaryExpression)(expression.Body)).Operand).Member.Name;
        }
        if (expression.Body is ParameterExpression)
        {
            return expression.Body.Type.Name;
        }
        throw new InvalidOperationException();
    }
 } 
```

当你这样写时，它会提取属性的名称：`@Html.TextBoxFor(m => m.Model1.field1)`

那么你可以像这样使用它：

```
Html.TextBoxFor(m => m.Model1.field1, 
  new { @class = "login-input", 
        @name="Name",  
        @value = Model.Item(m => m.Model1.field1) }) 
```

如果您不想`m => m.Model1.field1`再次调用，则必须声明`TextBoxFor`更复杂的方法版本，但如果您愿意，我可以为您提供详细信息。

这是我在[Github](https://github.com/jzinedine/Cedar)上的代码库的示例：

```
public static class HtmlHelperExtensionForEditorForDateTime
{

    public static MvcHtmlString Editor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression)
    {
        ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);

        string propname = html.ViewData.Model.Item(expression);
        string incomingValue = null;
        var httpCookie = html.ViewContext.RequestContext.HttpContext.Request.Cookies["lang"];
        if (metadata.Model is DateTime && (httpCookie.IsNull() || httpCookie.Value == Cultures.Persian))
            incomingValue = PersianCalendarUtility.ConvertToPersian(((DateTime)metadata.Model).ToShortDateString());
        if (string.IsNullOrEmpty(incomingValue))
            return html.TextBox(propname, null, new { @class = "datepicker TextField" });

        return html.TextBox(propname, incomingValue, new { @class = "datepicker TextField"});
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:28:11.893

在您的控制器中，`field1`在将其传递给视图之前设置它的值......这将自动设置该值。如果您在另一个字段中有值，只需执行以下操作：

`model.field1 = model.field2;`

在你的控制器中......这样模型就有了一致的数据。

如果您不需要/不希望默认值实际上是文本框的值，您也可以使用`PlaceHolder`... 这样用户可以将值视为提示，但它不会算作文本框内容一旦您发布表格。

```
@Html.TextBoxFor(m => m.Model1.field1, new { @class = "login-input", @name="Name",  placeholder= "test" }) 
```

请记住，并非 HtmlAttributes 中的所有字段名都需要“@”...`@class`是正确的，但我认为不需要其他字段名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T15:06:57.177

您可以在将模型传递给视图之前在控制器操作中设置默认值：

```
model.field1 = "Test"
return View(model) 
```

# powershell - 如何在 PowerShell 远程处理会话的提示中为机器名称添加颜色？

> ID：13689797
> 
> 赞同：9
> 
> 时间：2012-12-03T18:56:00.320
> 
> 标签：powershell, powershell-remoting, powershell-3.0

为了让我在远程到实时/生产服务器时更加明显，我认为在使用远程 PowerShell 会话时能够为我连接的机器名称着色会很方便。

但是，我看不到这样做的方法......服务器名称前缀似乎独立于 Prompt 函数，即使我可以使用它，我也不确定如何定义一个新的 Prompt 仅用于会话的持续时间。

有没有办法自定义这个？注意：我不想将所有服务器名称都涂成相同的颜色，我想区分本地/生产服务器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T22:42:30.357

经过一番搜索后，您似乎是正确的，没有内置的钩子可以覆盖预提示`[computername]:`标记。

幸运的是，我有一个可以为您工作的 hacky 解决方法！

要获得颜色，我们可以使用`Write-Host`. `Write-Host`函数的输出`prompt`将完全左对齐，这是我们想要的。不幸的是，默认`[computername]:`标签是在之后直接插入的。这导致计算机名称在提示中重复，一次有颜色，一次没有。

我们通过返回一个包含退格字符的字符串来解决这个问题，因此未着色的`[computername]:`将被覆盖。这是正常的提示字符串，通常是当前路径。

最后，如果正常提示字符串很短并且没有完全覆盖未着色的`[computername]:`标签，我们需要通过添加虚拟空格字符来进行最后的清理。但是，这可能会推出插入符号，因此我们需要添加更多的退格来将插入符号返回到正确的位置。

总而言之，在您的远程机器上使用它：

```
# put your logic here for getting prompt color by machine name
function GetMachineColor($computerName)
{
   [ConsoleColor]::Green
}

function GetComputerName
{
  # if you want FQDN
  $ipProperties = [System.Net.NetworkInformation.IPGlobalProperties]::GetIPGlobalProperties()
  "{0}.{1}" -f $ipProperties.HostName, $ipProperties.DomainName

  # if you want host name only
  # $env:computername
}

function prompt
{
  $cn = GetComputerName

  # write computer name with color
  Write-Host "[${cn}]: " -Fore (GetMachineColor $cn) -NoNew

  # generate regular prompt you would be showing
  $defaultPrompt = "PS $($executionContext.SessionState.Path.CurrentLocation)$('>' * ($nestedPromptLevel + 1)) "

  # generate backspaces to cover [computername]: pre-prompt printed by powershell
  $backspaces = "`b" * ($cn.Length + 4)

  # compute how much extra, if any, needs to be cleaned up at the end
  $remainingChars = [Math]::Max(($cn.Length + 4) - $defaultPrompt.Length, 0)
  $tail = (" " * $remainingChars) + ("`b" * $remainingChars)

  "${backspaces}${defaultPrompt}${tail}"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-19T22:12:59.063

我使用[Posh-Git](https://github.com/dahlbyk/posh-git)来实现这一点。查看他们的[提示定制](https://github.com/dahlbyk/posh-git#customizing-the-posh-git-prompt)。我注意到有些文档有点过时了，如果你只输入`$GitPromptSettings`PowerShell，你会看到所有可用的属性。使用 Posh-Git 的额外好处是可以在提示符上查看 Git 统计信息。

我用来设置机器名的命令是...

`$GitPromptSettings.DefaultPromptPrefix = '$(get-content env:computername) '`

这里是颜色设置

$GitPromptSettings.DefaultPromptPath.ForegroundColor = '橙色'

# javascript - 在 Internet Explorer 8、9、10 中播放 MP3 的 HTML 5 音频

> ID：13689801
> 
> 赞同：0
> 
> 时间：2012-12-03T18:56:15.597
> 
> 标签：javascript, internet-explorer-9, html5-audio

我已经在 Chrome 中测试了以下代码，它很有效，但 Internet Explorer 似乎没有开始播放声音（我正在 IE9 中测试）。其余端点根据需要返回具有音频/mp3 音频/aac 音频/ogg mime 类型的数据流...

```
var url = "/MyServer/services/rest/notifications/sounds/"+soundId+"/"+soundFormat;
var snd = new Audio(url);

snd.addEventListener('ended', function() {
    if (this.debug) {
        console.info("Sound ended");
    }
    that.playingSound = false;
});

if (this.debug) {
    console.info("Requesting sound to start url:"+url);
}

that.playingSound = true;

snd.play(); 
```

有什么想法可以让 IE 工作吗？我看到一些 HTML 5 功能表说 IE9 不支持此功能，而其他地方暗示它应该可以工作？也许这仅在您使用嵌入的 HTML 标记而不是代码（预加载为 true）时才有效，但是我需要在运行时动态加载声音。

# matlab - 根据 MA TLAB 中的索引位置将 RGB 图像中的特定位置更改为特定颜色

> ID：13689802
> 
> 赞同：2
> 
> 时间：2012-12-03T18:56:16.153
> 
> 标签：matlab, rgb

我在 MATLAB 中有一个 2336x3504 RGB uint8 文件。我还有一个由索引符号中感兴趣的像素组成的向量（基于 2336x3504 二进制图像）。我希望将 RGB 图像中与感兴趣的像素对应的所有点设置为特定颜色。

我的第一个想法是执行以下操作：

```
% Separate RGB image into three 3 uint8 arrays.

RGB1 = RGBImage(:,:,1);

RGB2 = RGBImage(:,:,2);

RGB3 = RGBImage(:,:,3);

% Change each layer based on the color I want (say for red, or [255 0 0])

RGB1(interestPixels) = 255;

RGB2(interestPixels) = 0;

RGB3(interestPixels) = 0;

% Then put it all back together

NewRGBImage = cat(3,RGB1,RGB2,RGB3); 
```

虽然这有效，但它看起来很混乱。我确信有一个更优雅的解决方案，但我没有看到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:44:56.617

到目前为止，我能找到的最简单的方法是：

```
% test init
mat = randi(3,[2 4 3]);        % a 3-channel 2x4 image
interest_pix = [1 1;2 2; 1 3]; % some pixel coordinates

channel_selector = ones(1,size(interest_pix,1));
inds_chn1 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),1*channel_selector);
inds_chn2 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),2*channel_selector);
inds_chn3 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),3*channel_selector);

mat(inds_chn1)=255;    % you could also use NaN or Inf to make the changes more apparent
mat(inds_chn2)=0;
mat(inds_chn3)=0; 
```

这种方法的优点是它不会为通道创建新矩阵。

阅读材料：[矩阵索引](http://www.mathworks.co.uk/company/newsletters/articles/Matrix-Indexing-in-MATLAB/matrix.html;jsessionid=236260c63222dd295e27e5284d5f)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T09:52:24.927

上面的代码有错误。这是正确的。试试吧。

```
function testmat=testmat()
mat = rand(3,3,3)% a 3-channel 2x4 image
[v w c]=size(mat)
interest_pix = [1 1;2 2; 1 3]; % some pixel coordinates

channel_selector = ones(1,size(interest_pix,1));
c1=1*channel_selector;
d1(:,1)=c1(1,:);

c2=2*channel_selector;
d2(:,1)=c2(1,:)

c3=3*channel_selector;
d3(:,1)=c3(1,:);

inds_chn1 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),1*d1);
inds_chn2 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),1*d2);
inds_chn3 = sub2ind(size(mat),interest_pix(:,1), interest_pix(:,2),1*d3);

mat(inds_chn1)=255;    % you could also use NaN or Inf to make the changes more apparent
mat(inds_chn2)=0;
mat(inds_chn3)=0;
end 
```

# extjs - Extjs 网格在商店加载后滚动

> ID：13689803
> 
> 赞同：1
> 
> 时间：2012-12-03T18:56:22.790
> 
> 标签：extjs, extjs4

加载商店后，如何禁用网格的“滚动到顶部”行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:29:30.040

使用 viewConfig 的**[preserveScrollOnRefresh](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.view.Table-cfg-preserveScrollOnRefresh)**属性。

```
viewConfig: {
    preserveScrollOnRefresh: true
} 
```

# asp.net-mvc - MVC 控件在没有页面刷新的情况下无法正常工作

> ID：13689804
> 
> 赞同：2
> 
> 时间：2012-12-03T18:56:24.087
> 
> 标签：asp.net-mvc, model-view-controller

我有一个 MVC 控制器，可以在几个不同的地方通过表单提交来调用它。然后控制器呈现一个视图，其主要目的是允许用户发送文档或将其发布到外部站点，以及填写将在通知电子邮件中使用的文本字段。

我正在对这些字段执行验证 - 用户可以输入自定义主题/正文。如果他们不这样做，他们将收到一个弹出警报，并且可以返回到表单或使用占位符值中指示的默认文本提交它。

问题是，当用户第一次到达该页面并单击发送按钮时，文本框中的任何输入实际上都没有注册，并且无论字段中实际有什么，它都会给出空字符串通知；但是，如果我按 F5 并再试一次，则输入完美。

我觉得这与最初通过 POST 操作完成调用此控制器的表单提交有关，而在页面刷新时使用 GET 似乎可以正常工作。我只是不知道如何在通过 POST 调用控制器时让内容正确响应，或者如何在不发布数据的情况下提交表单。

提前感谢您的阅读和任何帮助。

这是调用控制器：

```
 public ActionResult Index(FormCollection collection)
    {
        //modelbuilding code
        return View (Model);
    } 
```

调用控制器的代码总是使用这种格式：（在这种情况下，它将从 Recipients/Index 视图中调用。

```
@using(Html.BeginForm("Index", "Distribution", FormMethod.Post )) {
    //form values
    <input type="submit" data-role="button" value="Done"/>
} 
```

这是视图和 JS 验证功能的相关部分：

```
<div id="SubjectTemplate">
    <p>Subject: <input id="emailSubjectTextBox" name="EmailSubject" placeholder="@EmailSubject" /></p>
</div>

<a href="javascript:validateInput();">Send Notification</a>

<script>               
    function validateInput() {
         var possibleErrors = [];   
         if (!(document.getElementById('emailSubjectTextBox').value)) {
               possibleErrors.push('@incompleteEmailSubject' + '\n');
         }
         //more validation that works the same way and has the same problem
         if (possibleErrors.length > 0) {
             if (confirm(possibleErrors))
             {
               window.location.href = '@Url.Action("Send")'
             }
         }
         else {
               window.location.href = '@Url.Action("Send")'
         }
    }                
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:10:12.573

我不确定我是否完全理解您的问题，但一般来说，您不应该对 POST 和 GET 使用相同的操作。

更重要的是，如果您的操作没有某种副作用，则不应使用 POST。如果您在提交表单时所做的只是做出某种选择，那么您应该使用 GET。

有关如何使用 jQuery 执行 ajax GET 请求的更多信息和示例，请参阅以下帖子：[http ://www.jquery4u.com/ajax/key-differences-post/](http://www.jquery4u.com/ajax/key-differences-post/)

无论您尝试做什么，POST 调用执行一些操作，然后重定向到返回给用户的 GET 操作是非常好的做法。

```
[HttpPost]
public ActionResult Index(FormCollection collection)
{
    //do whatever you need to save the record
    return RedirectToAction("Index")
}

[HttpGet]
public ActionResult Index()
{
    //modelbuilding code
    return View (Model);
} 
```

这不仅可以帮助您的控制器遵循 RESTful 方法，还可以阻止用户在碰巧按 f5 时出现烦人的“您确定要重新提交此页面吗”

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T21:45:59.180

我发现问题是由 jQueryMobile 自动利用 AJAX 发布表单引起的。我通过包含`new {data_ajax = "false"}`在`Html.BeginForm`语句中解决了这个问题。

# multithreading - .NET 4.5 增加 WCF 客户端调用异步？

> ID：13689807
> 
> 赞同：1
> 
> 时间：2012-12-03T18:56:37.967
> 
> 标签：multithreading, wcf, async-await

我有一个 .NET 4.5 WCF 客户端应用程序，它使用异步/等待模式进行大量调用。我的开发机器是具有 8gb RAM 的双处理器（Amazon AWS 的生产将是 5 CPU 和 8gb RAM）。我的代码调用的远程 WCF 服务在我需要的 Web 方法上使用了 out 和 ref 参数。我的代码每次都实例化一个代理客户端，将任何结果写入公共 ConcurrentDictionary，然后返回 null。

我运行 Perfmon，观察系统上的线程数，它在 28-30 之间。我的客户需要几个小时才能完成拨打的大量电话。是的，小时。远程服务由一家大公司提供支持，他们有很多服务器来接收我的 WCF 调用，所以我可以向它们发送的调用越多越好。

我认为事情实际上仍在同步发生，即使进行 WCF 调用的方法用“async”装饰，因为代理方法不能有“await”。真的吗？

我的代码如下所示：

```
 async private void CallMe()
    {
    Console.WriteLine( DateTime.Now );
    var workTasks = this.AnotherConcurrentDict.Select( oneB => GetData( etcetcetc ).Cast<Task>().ToList();
    await Task.WhenAll( workTasks );
    }

    private async Task<WorkingBits> GetData(etcetcetc)
    {
    var commClient = new RemoteClient();
    var cpResponse = new GetPackage();
    var responseInfo = commClient.GetData( name, password , ref (cpResponse.aproperty), filterid , out cpResponse.Identifiers);
    foreach (var onething in cpResponse.Identifiers)
    { 
        // add to the ConcurrentDictionary
    }
    return null; // I already wrote to the ConcurrentDictionary so no need to return anything 
```

responseInfo 不可等待，因为 WCF 调用具有 ref 和 out 参数。

我在想加快速度的方法不是将 async/await 放在这个方法中，而是创建一个包装器方法，我可以在其中使事情 await/async，但我不是最聪明/最安全的工作方式。

什么是获得更多对服务的出站调用的聪明方法（扩展 IO 完成线程池，欺骗调用在后台运行，以便 Task.WhenAll 可以更快地完成）？

感谢所有的想法/样本/指针。我在某个地方遇到了瓶颈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T16:48:57.717

1）确保你真的是异步调用它，而不是仅仅阻塞调用。代码示例在这里会有所帮助。
2）您可能需要这样做：

`ServicePointManager.DefaultConnectionLimit = 100;`

默认情况下，它只允许 2 个同时连接到同一服务器。
3) 确保在调用完成后处理代理对象，以免占用资源。

如果您以异步方式执行操作，则线程池大小不应成为瓶颈。为了更好地了解您遇到的问题类型，您可以使用`Interlocked.Increment`并`Interlocked.Decrement`跟踪待处理呼叫的数量，看看它是否在某个地方受到限制。

你也可以用一个你知道不会有任何瓶颈的非常简单的方法来代替你的真实调用，看看问题出在客户端还是服务器上。

# php - 如何在 PHP 导出的 .xls 文件中制作粗体文本

> ID：13689810
> 
> 赞同：7
> 
> 时间：2012-12-03T18:56:41.807
> 
> 标签：php, xls

我正在使用核心 PHP。我需要以粗体格式制作标题文本并保持正常文本格式。.xls 文件将从 PHP 导出。

**我没有在我的项目中使用任何插件。我需要在不使用任何插件的情况下完成此操作。但我无法解决这个问题。**

我的代码如下，

```
//header part cration
while($r=mysql_fetch_array($exe))
{
    //need to set bold. But it is not working. it giving error
    //$header .= "<b>".$r['question']."</b>"."\t ";

    $header .=.$r['question']."\t ";
}

//body part cration
while($r=mysql_fetch_array($exe))
{
    $data .= $r['answer']."\t ";
    //code continuous...
} 
```

和导出代码如下，

```
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=reports.xls");
header("Pragma: no-cache");
header("Expires: 0");
print "$header\n\n$data"; 
```

导出文件工作正常。但是我无法使标题变粗。

请非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:03:05.623

一种可能的选择是让您的 PHP 代码生成一个 HTML 表格模型，其中包括您在特定单元格上的格式。然后让 PHP 将文件保存为 XLS 文档，Excel 应该能够使用应用的格式打开该文件。

这可能不是最优雅的解决方案，但[看起来之前已经完成了](https://stackoverflow.com/a/281902/1028949)。

[我明白为什么很多人建议使用插件。](https://stackoverflow.com/a/3522608/1028949)

# chef-infra - 获取已部署的说明书版本

> ID：13689811
> 
> 赞同：11
> 
> 时间：2012-12-03T18:56:49.627
> 
> 标签：chef-infra

我在哪里可以找到已部署的说明书版本？似乎自动属性不听版本。

有没有办法访问食谱或模板中某处的 cookbook_version？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-04T19:34:04.373

您必须访问 Chef run 知道的食谱集合。

```
run_context.cookbook_collection[cookbook_name].metadata.version 
```

[运行上下文是一个](http://rubydoc.info/gems/chef/Chef/RunContext)跟踪 Chef 运行上下文的对象。

cookbook_collection 方法返回Chef 在本地缓存中的所有食谱[的类似哈希的对象。](http://rubydoc.info/gems/chef/Chef/CookbookCollection)

cookbook_name 方法返回“this”食谱的名称，因此它会在集合中查找食谱。该集合包含食谱中的所有元数据，可以通过访问器进行选择。在这种情况下，由于您需要“版本”，请使用“版本”访问器。

# lucene - Lucene SpellChecker 首选排列或特殊评分

> ID：13689812
> 
> 赞同：2
> 
> 时间：2012-12-03T18:56:53.943
> 
> 标签：lucene, lucene.net, spell-checking

我正在使用 Lucene.NET 3.0.3

如何使用给定函数修改 SpellChecker（或一般查询）的评分？

具体来说，我希望 SpellChecker 对搜索词排列的任何结果进行评分高于其余建议，但我不知道应该在哪里完成。

我也会接受解释如何使用普通查询执行此操作的答案。我有这个功能，但我不知道将其设置为查询或过滤器或其他东西是否会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:41:08.657

我认为解决此问题的最佳方法是在 SpellChecker 对象中使用自定义的比较器。

在此处查看默认比较器的源代码：

[http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-spellchecker/3.6.0/org/apache/lucene/search/spell/SuggestWordScoreComparator.java?av=f](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-spellchecker/3.6.0/org/apache/lucene/search/spell/SuggestWordScoreComparator.java?av=f)

非常简单的东西，如果你已经有了比较两个字符串的算法，应该很容易扩展。

然后你可以使用设置它来使用你的比较器与[SpellChecker.SetComparator](http://lucene.apache.org/core/3_6_0/api/contrib-spellchecker/org/apache/lucene/search/spell/SpellChecker.html#setComparator%28java.util.Comparator%29)

我想我在上一个问题中提到了为此使用过滤器的可能性，但我认为这不是正确的方法，多看一点。

编辑 - -

事实上，3.0.3 中没有 Comparator 可用，所以我相信您需要通过[StringDistance](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/contrib-spellchecker/org/apache/lucene/search/spell/StringDistance.html)对象访问评分。Comparator 会更好，因为已经应用了评分并将其传递给它以做你喜欢的事情。扩展 StringDistance 可能不太具体，因为您必须将规则作为分数的一部分应用。

您可能想要扩展[LevensteinDistance](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/contrib-spellchecker/org/apache/lucene/search/spell/LevensteinDistance.html)（[源代码](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-spellchecker/3.0.3/org/apache/lucene/search/spell/LevensteinDistance.java)），这是默认的 StringDistance 实现，但当然，您也可以随意尝试[JaroWinklerDistance](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/contrib-spellchecker/org/apache/lucene/search/spell/JaroWinklerDistance.html)。对算法不是很熟悉。

首先，在从标准（父）实现的 getDistance 调用中获得基线距离后，您需要覆盖 getDistance 并在那里应用您的评分规则。

我可能会实现类似的东西（假设你有一个辅助方法`boolean isPermutation(String, String)`：

```
class CustomDistance() extends LevensteinDistance{
    float getDistance(String target, String other) {
        float distance = super.getDistance();
        if (isPermutation(target, other)) {
            distance = distance + (1 - distance) / 2;
        }
        return distance;
    }
} 
```

为一个排列的结果计算一个接近 1 的分数的一半（也就是说，如果默认算法给出距离 = .6，这将返回距离 = .8，等等）。返回的距离必须介于 0 和 1 之间。我的示例只是可能的评分方法之一，但您可能需要稍微调整算法。我对简单地为所有排列返回 1.0 持谨慎态度，因为当使用“weiss”查看时，肯定会更喜欢“isews”而不是“weis”，并且它也会失去对不同排列的接近度进行排序的能力（'在这种情况下， isews' 和 'wiess' 将与 'weiss' 相等匹配）。

拥有自定义 StringDistance 后，可以通过构造函数或使用 SpellChecker.setStringDistance 将其传递给[SpellChecker](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/contrib-spellchecker/org/apache/lucene/search/spell/SpellChecker.html#setStringDistance%28org.apache.lucene.search.spell.StringDistance%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:10:55.097

根据 femtoRgon 的建议，这就是我最终要做的事情：

```
 public class PermutationDistance: SpellChecker.Net.Search.Spell.StringDistance
    {

    public PermutationDistance()
    {

    }

    public float GetDistance(string target, string other)
    {
        LevenshteinDistance l = new LevenshteinDistance();
        float distance = l.GetDistance(target, other);

        distance = distance  + ((1 - distance) * PermutationScore(target, other));

        return distance;
    }

    public bool IsPermutation(string a, string b)
    {
        char[] ac = a.ToLower().ToCharArray();
        char[] bc = b.ToLower().ToCharArray();

        Array.Sort(ac);
        Array.Sort(bc);

        a = new string(ac);
        b = new string(bc);

        return a == b;
    }

    public float PermutationScore(string a, string b)
    {
        char[] ac = a.ToLower().ToCharArray();
        char[] bc = b.ToLower().ToCharArray();

        Array.Sort(ac);
        Array.Sort(bc);

        a = new string(ac);
        b = new string(bc);

        LevenshteinDistance l = new LevenshteinDistance();
        return l.GetDistance(a, b);
    }
} 
```

然后：

```
_spellChecker.setStringDistance(new PermutationDistance());
 List<string> suggestions = _spellChecker.SuggestSimilar(word, 10).ToList(); 
```

# c# - 以编程方式向 datagridview 添加一行

> ID：13689814
> 
> 赞同：1
> 
> 时间：2012-12-03T18:57:12.307
> 
> 标签：c#, datagridview

互联网上都有答案，但它不起作用，我想知道我做错了什么。

我有一个`DataGridView`1 列，`Column1`. 那是列的名称，而不是文本或其他任何内容。

```
 private void InitializeComponent()
    {
        this.dataGridView1 = new System.Windows.Forms.DataGridView();
        this.Column1 = new System.Windows.Forms.DataGridViewTextBoxColumn();
        ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
        this.SuspendLayout();
        // 
        // dataGridView1
        // 
        this.dataGridView1.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
        this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
        this.Column1});
        this.dataGridView1.Name = "dataGridView1";
        // 
        // Column1
        // 
        this.Column1.HeaderText = "Column1";
        this.Column1.Name = "Column1";
        .....
    }

    public Form1()
    {
        InitializeComponent();

        // Works
        DataGridViewRow row = (DataGridViewRow)dataGridView1.Rows[0].Clone();
        row.Cells[0].Value = "AAAAA";
        dataGridView1.Rows.Add(row);

        // Fails
        row = (DataGridViewRow)dataGridView1.Rows[0].Clone();
        row.Cells["Column1"].Value = "AAAAA"; // Argument Exception: "Column named Column1 cannot be found"
        dataGridView1.Rows.Add(row);
    } 
```

请解释？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:44:20.777

该行不是 Datagridview 的一部分，因此它找不到该列。首先将其添加回datagridview，然后使用列名将值分配给它，或者通过列的索引对单元格进行寻址：

```
row.Cells[dataGridView1.Columns["Column1"].Index].Value = "AAAAA"; 
```

# unicode - 什么是格式良好的 UTF-16 字符串？

> ID：13689815
> 
> 赞同：0
> 
> 时间：2012-12-03T18:57:16.277
> 
> 标签：unicode

我需要一些帮助来理解格式良好的 UTF-16 字符串的概念，如第 2 章的这两段所述[：通用结构 2.7 Unicode 字符串](http://www.unicode.org/versions/Unicode6.2.0/ch02.pdf)：

“根据编程环境，Unicode 字符串可能需要也可能不需要采用相应的 Unicode 编码形式。例如，Java、C# 或 ECMAScript 中的字符串是 Unicode 16 位字符串，*但不一定格式正确UTF-16 序列*。在正常处理中，允许此类字符串包含*格式不正确的 UTF-16 的*代码单元序列（即孤立的代理）会更有效。因为字符串是每个程序的基本组成部分，在修改字符串的每个操作中检查孤立的代理可能会产生巨大的开销，特别是因为补充字符在全球程序中占整个文本的百分比极为罕见。

每当此类字符串被指定为特定的 Unicode 编码形式时——即使是具有相同代码单元大小的字符串——该字符串不得违反该编码形式的要求。例如，*当字符串被指定为格式正确的 UTF-16 时，不允许在 Unicode 16 位字符串中使用孤立的代理*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:02:10.350

该段落对 UTF-16 进行了解释；格式不正确意味着字符串包含孤立的代理代码单元。

也就是说，某些代码单元仅在它们成对出现时才有效。[0xD800-0xDFFF] 范围内的代码单元只能成对出现，其中第一个必须在 [0xD800-0xDBFF] 范围内，第二个必须在 [0xDC00-0xDFFF] 范围内。如果一个字符串不符合这个要求，那么它就不是格式良好的。

# c# - C# 中的 SQL 查询生成器

> ID：13689819
> 
> 赞同：-1
> 
> 时间：2012-12-03T18:57:38.810
> 
> 标签：c#, sql, sql-server-2008, query-builder

我想创建一个自定义查询构建器，它将支持 CRUD 操作。我正在使用 c#、.Net 4.0 SQL Server 2008。但我不知道从哪里开始。我不会使用任何 DLL 或 API。但是你可以向我推荐任何开源文件，我可以在其中获得我想要构建的主题以及它是如何构建的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:09:14.690

以下开源项目进行 SQL 生成和对象映射。

*   [亚音速](https://github.com/subsonic)
*   [小巧玲珑](https://github.com/StackExchange/Dapper)
*   [大量的](https://github.com/robconery/massive)
*   [BL工具包](https://github.com/igor-tkachev/bltoolkit)
*   [PetaPoco](https://github.com/CollaboratingPlatypus/PetaPoco)
*   [SqlKata](https://github.com/sqlkata/querybuilder)

# javascript - D3js - 创建和轻松更新多折线图

> ID：13689821
> 
> 赞同：9
> 
> 时间：2012-12-03T18:58:02.793
> 
> 标签：javascript, d3.js, linechart

我已经使用 D3 创建了一个小测试折线图，但是由于我对库还很陌生，我不确定向图表添加多条线的最佳方法是什么，目前我只显示一条线[小提琴](http://jsfiddle.net/GyWpN/)。

我想在图表上显示 2 条线，但我不确定如何在不复制粘贴代码的情况下实现这一点，我确信这会非常低效，因为我想根据用户选择定期更新/动画图表.

取而代之的是，

```
var data = [12345,22345,32345,42345,52345,62345,72345,82345,92345,102345,112345,122345,132345,142345]; 
```

我想展示这样的东西，

```
var data = [
            [12345,42345,3234,22345,72345,62345,32345,92345,52345,22345], // line one
            [1234,4234,3234,2234,7234,6234,3234,9234,5234,2234] // line two
          ]; 
```

这有可能吗？如果是这样，解决此问题的最佳方法是什么，以便我可以在需要时轻松更新/动画图表？

**注意：**我只是想学习和熟悉 D3 最佳实践和整个库。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T20:37:07.810

这是可能的，也是合理的。在 [D3 嵌套选择教程](http://bost.ocks.org/mike/nest/)中有一个教程可以解决这个问题， 它描述了数据的嵌套。

下面是我从你的小提琴中破解的代码来证明这一点。

```
var data = [        
[12345,42345,3234,22345,72345,62345,32345,92345,52345,22345], 
[1234,4234,3234,2234,7234,6234,3234,9234,5234,2234] 
          ];

var width = 625,
    height = 350;

var x = d3.scale.linear()
    .domain([0,data[0].length])   // Hack. Computing x-domain from 1st array
    .range([0, width]);

var y = d3.scale.linear()
    .domain([0,d3.max(data[0])])  // Hack. Computing y-domain from 1st array
    .range([height, 0]);

var line = d3.svg.line()
    .x(function(d,i) { return x(i); })
    .y(function(d) { return y(d); });

var area = d3.svg.area()
    .x(line.x())
    .y1(line.y())
    .y0(y(0));

var svg = d3.select("body").append("svg")
    //.datum(data)
    .attr("width", width)
    .attr("height", height)
  //.append("g");

var lines = svg.selectAll( "g" )
  .data( data );  // The data here is two arrays

// for each array, create a 'g' line container
var aLineContainer = lines
  .enter().append("g");  

/*svg.append("path")
    .attr("class", "area")
    .attr("d", area);*/

aLineContainer.append("path")
    .attr("class", "area")
    .attr("d", area);

/*svg.append("path")
    .attr("class", "line")
    .attr("d", line);*/

aLineContainer.append("path")
    .attr("class", "line")
    .attr("d", line);

/*svg.selectAll(".dot")
    .data(data)
  .enter().append("circle")
    .attr("class", "dot")
    .attr("cx", line.x())
    .attr("cy", line.y())
    .attr("r", 3.5);*/
// Access the nested data, which are values within the array here
aLineContainer.selectAll(".dot")
  .data( function( d, i ) { return d; } )  // This is the nested data call
  .enter()
    .append("circle")
    .attr("class", "dot")
    .attr("cx", line.x())
    .attr("cy", line.y())
    .attr("r", 3.5);
​ 
```

一个缺陷是我计算了第一个数组的 x 和 y 轴的域，这是一个 hack，但与您的问题不完全相关。

![输出图像样本](../Images/124558e9e40c1c57b891d64ed9dc7c1b.png)

# c# - 如何将超过 7 个字母的所有单词保存到文件中

> ID：13689825
> 
> 赞同：-4
> 
> 时间：2012-12-03T18:58:07.650
> 
> 标签：c#

我目前正在为一项作业开发一个控制台文本分析程序。

我的问题是，我需要将所有用户输入的超过 7 个字母的单词保存到文本文件中。用户可以通过键入段落或从文本文件加载来输入单词。

关于我如何做到这一点的任何想法？

感谢您提前提供任何帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T19:02:24.427

在不给你代码的情况下，想想你真正需要做什么。

1.  [阅读](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)全文。
2.  根据空格/标点符号[拆分文本以识别每个单词。](http://msdn.microsoft.com/en-us/library/system.string.split%28v=VS.71%29.aspx)这将存储在一个数组中。
3.  测试每个拆分字符串的[长度](http://msdn.microsoft.com/en-us/library/system.string.length.aspx)。
4.  [将结果写入](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:01:10.933

我不确定您如何获取用户输入的单词，但您可以执行一个简单的 LINQ 语句来获取大于 7 个字母的单词：

```
//get all words into an array (wordArray)
var bigWords = wordArray.Where(w => w.Length > 7).ToArray(); 
```

然后你对 bigWords 数组做一些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:01:47.877

我不会为你做你的任务。

`String.Split`您应该检查函数，例如`String.Length`和`String.Substring()`

# tfs - 通过 git-tf 或 git-tfs 将 git 与 TFS 一起使用时要考虑的限制？

> ID：13689829
> 
> 赞同：4
> 
> 时间：2012-12-03T18:58:32.340
> 
> 标签：tfs, git-tfs, git-tf

如果将我的源代码处理基于 TFS（以获取所有集成和报告等）但在本地使用 git-tf 或 git-tfs，我实际上会错过什么？

然后，我是否能够像使用基于 git 的中央存储库一样使用完整的 git 功能在本地进行分支和合并，还是需要考虑不同的工作流程和限制？

我们经常使用功能和发布开发分支并且喜欢继续这样做，当使用 git-tf 等在本地推送这些时，TFS 服务器实际上是如何处理这个问题的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T12:57:42.683

实际上，git-tfs 比 git-tf 更先进。我强烈建议使用它而不是 git-tf （目前）。

使用 git-tf，您应该将每个分支克隆为存储库（并且无法选择、合并...），而在 git-tfs 的最新版本中，您可以这样做并保持您的工作流程。见[https://stackoverflow.com/a/13710811/3619](https://stackoverflow.com/a/13710811/3619)

如果你知道 git 使用 git-tfs 没有问题！

文档：[https ://github.com/git-tfs/git-tfs/blob/master/doc/](https://github.com/git-tfs/git-tfs/blob/master/doc/)

只要知道，如果你使用：

```
git tfs checkintool 
```

或者 ：

```
git tfs checkin 
```

它将创建一个合并提交

如果你使用：

```
git tfs rcheckin 
```

它将在 tfs 中提交每个本地提交，并根据这些提交自动获取和变基...

但是阅读 wiki 文档，已经足够清楚了；）

编辑：与@gbjbaanb 所说的相反，使用 git-tfs 而不是普通的 TFS 有很多优点（如果你知道如何使用 git ......）。您可以在本地使用 git 进行的所有操作，并且仍然是一个优势（轻分支、变基、本地提交、重做提交、确切知道签出哪个版本、获取和查看更改而不将它们与您当前的工作区合并，更好的历史，.. .)。

现在使用 git-tfs，您甚至可以比使用 TFS 更轻松地创建一个 TFS 分支（您只需在提交之前创建它，或者如果您之前在 git 分支中开始工作，则在创建它之后重新建立它...... . ).

目前，唯一不比 TFS 更好的是合并 2 个不受支持的 TFS 分支。如果您想在历史记录中查看合并（我们通常想要的），您应该与 TFS 进行合并，或者与 git 合并并签入 tfs（并且您不会看到合并变更集 :( ）。拉取请求 [ 1] 解决所有这些问题（并允许管理合并提交比使用 TFS 更容易）已经完成并等待 trunc 中的合并（我只需重构单元测试并审查功能）。

[1] [https://github.com/git-tfs/git-tfs/pull/363](https://github.com/git-tfs/git-tfs/pull/363)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:11:03.760

如果您首先使用 git-tf（MS 版本），您将必须了解您使用的命令会有所不同——它们在每个命令中都附加了一个“tf”。（例如`git tf push`）

第二个是分支不会像 git 那样工作 - 我发现（这可能是由于安全设置等原因，即使我可以在本地和服务器上创建分支）虽然你可以分支你的本地 git 设置，但你不能推送一个新的分支回到服务器 - 你必须先将它合并到一个“官方”分支。

如果使用 TFS，我不会费心尝试使用任何网桥（尽管 svn-tfs 网桥非常接近，因为 TFS 的性质接近 SVN）。我会使用本机客户端。虽然我不会首先选择 TFS，但*如果*这是我必须使用的 - [Team Explorer Everywhere](http://holymonkey.com/team-foundation-version-control-client-in-linux.html)客户端将是我的选择。

# javascript - javascript如何在不使用警报的情况下创建验证错误消息

> ID：13689832
> 
> 赞同：9
> 
> 时间：2012-12-03T18:58:52.730
> 
> 标签：javascript, validation

我正在寻找一个简单的表单验证错误消息，显示在用户名字段下。

我似乎无法弄清楚。

```
<form name ="myform" onsubmit="validation()">
     Username: <input type ="text" name="username" /><br />              
     <input type ="submit" value="submit" />
      <div id ="errors">
      </div>
</form> 
```

这是我的验证脚本：

```
function validation(){ 
    if(document.myform.username.value == ""){   //checking if the form is empty
         document.getElementById('errors').innerHTML="*Please enter a username*";
                //displaying a message if the form is empty
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T19:02:59.827

如果发生错误，您需要停止提交：

***HTML***

```
<form name ="myform" onsubmit="return validation();"> 
```

***JS***

```
if (document.myform.username.value == "") {
     document.getElementById('errors').innerHTML="*Please enter a username*";
     return false;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-17T12:15:21.387

JavaScript

```
<script language="javascript">
        var flag=0;
        function username()
        {
            user=loginform.username.value;
            if(user=="")
            {
                document.getElementById("error0").innerHTML="Enter UserID";
                flag=1;
            }
        }   
        function password()
        {
            pass=loginform.password.value;
            if(pass=="")
            {
                document.getElementById("error1").innerHTML="Enter password";   
                flag=1;
            }
        }

        function check(form)
        {
            flag=0;
            username();
            password();
            if(flag==1)
                return false;
            else
                return true;
        }

    </script> 
```

HTML

```
<form name="loginform" action="Login" method="post" class="form-signin" onSubmit="return check(this)">

                    <div id="error0"></div>
                    <input type="text" id="inputEmail" name="username" placeholder="UserID" onBlur="username()">
               controls">
                    <div id="error1"></div>
                    <input type="password" id="inputPassword" name="password" placeholder="Password" onBlur="password()" onclick="make_blank()">

                    <button type="submit" class="btn">Sign in</button>
                </div>
            </div>
        </form> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T19:13:46.783

我强烈建议您开始使用 jQuery。您的代码如下所示：

```
$(function() {
    $('form[name="myform"]').submit(function(e) {
        var username = $('form[name="myform"] input[name="username"]').val();
        if ( username == '') {
            e.preventDefault();
            $('#errors').text('*Please enter a username*');
        }
    });
}); 
```

# database - 使用 NHibernate 是否可以根据语言创建不同的数据库列（字段）名称？

> ID：13689833
> 
> 赞同：0
> 
> 时间：2012-12-03T18:58:53.507
> 
> 标签：database, nhibernate, database-design, language-agnostic, internationalization

今天工作中发生了一些事情，我不知道你会怎么做。本质上，我们有一个使用 NHibernate 的应用程序。目前，我们正在使用 Fluent NHibernate 并使用 ExportSchema 直接从域中导出模式。列名是英文的。

在今天的一些讨论中，结果表明，除了将数据国际化外，还有一个想法是让列名也使用安装的语言。

因此，例如，如果数据库部署到英语国家，则列名将使用英语，如果将数据库部署到法语国家/地区，则列名将使用法语。

该理论似乎是这样的，如果用户想要针对数据存储编写查询，他们将能够使用基于其母语的列名进行查询。（假设它们被描述性地命名）。

我不能说我以前遇到过这个，我很好奇你会怎么做？此外，即使我提到了 NHibernate，如果还有其他选项，请随时提及它们。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:21:12.267

您可以为要支持的每种语言使用资源文件，并且在流畅的映射中引用这些资源而不是硬编码的字符串。所以一个示例映射看起来像这样：

```
public OrderMap()
{
    CultureInfo culture = CultureInfo.CurrentCulture;
    ResourceManager rm = new ResourceManager("HelloWorldGlobed.myRes",typeof(OrderMap).Assembly);

    DynamicUpdate();
    Table(rm.GetString("ORDER_TABLE_NAME",culture));
    Id(x => x.Id, rm.GetString("ORDER_ID",culture));
    Map(x => x.Name, rm.GetString("ORDER_NAME",culture));
} 
```

以上只是一个简单的示例，我没有对此进行测试，但这让您了解如何使用资源来执行此操作。您可能希望将`CultureInfo`对象的检索和`ResourceManager`静态类或其他对象中的对象合并。

这也是在 C# 中使用资源的示例：

[http://www.codeproject.com/Articles/5208/MultiLanguage-Applications](http://www.codeproject.com/Articles/5208/MultiLanguage-Applications)

# android - Android Asynctask：等待整个计算而不阻塞 UI 线程

> ID：13689842
> 
> 赞同：0
> 
> 时间：2012-12-03T18:59:30.673
> 
> 标签：android, android-asynctask, media-player

我几乎完成了我的项目，只有一件事需要改进。

我的应用程序是一个音乐测验，它检索有关作者、歌曲标题、previewUrl ecc 的所有信息。使用适当的搜索 API 从 iTunes Store 下载。

当用户选择要玩的类型时，我必须告诉用户等待 4-5 秒，因为计算会填充包含所有信息的列表。

我调用 Asynctask 来检索这些信息，如下所示：

```
JsonCanzoni recuperoCanzoni = new JsonCanzoni(arrayGenere,Canzone.this);

    try {
        recuperoCanzoni.execute().get();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ExecutionException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

执行这些操作的类（扩展 Asynctask）如下：

```
class JsonCanzoni extends AsyncTask<Void, Void, Void>
{
    List<String> canzoni = new ArrayList<String>(5);
    ProgressDialog pDialog;
    int[] arrayGenere;
    Context context;

    public JsonCanzoni(int[] arrayGenere,Context context) 
    {
        this.arrayGenere = arrayGenere;
        this.context = context;
    }

    @Override
    protected void onPostExecute(Void result)
    {
        super.onPostExecute(result);

        pDialog.dismiss();
    }

    @Override
    protected void onPreExecute() 
    {
        super.onPreExecute();

        pDialog = new ProgressDialog(context);
        pDialog.setMessage("Preparazione round...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    protected Void doInBackground(Void... params) 
    {
        try
        {       
            int randomLookupId = 0;
            JSONObject obj;                         
            JSONArray jsonArray;    

            for(int i = 0; i < 10; i++)
            {
                canzoni = new ArrayList<String>();

                Log.d("GENERE", arrayGenere.toString());

                obj = getJSONObject(scegliClassifica(arrayGenere));
                jsonArray = obj.getJSONArray("resultIds");

                Log.d("dimensione JsonArray", String.valueOf(jsonArray.length()));
                try
                {
                    randomLookupId = new Random().nextInt(jsonArray.length()-1);
                }
                catch(IllegalArgumentException errore)
                {
                    new AlertDialog.Builder(context)
                    .setTitle("Connessione non attiva!")
                    .setMessage("Connessione di rete debole, uscita dal programma!");
                }
                Log.d("randomLookupID", String.valueOf(randomLookupId));

                JSONObject finalObj = getJSONObject("http://itunes.apple.com/lookup?id="+jsonArray.getString(randomLookupId)); 
                Log.d("URL","http://itunes.apple.com/lookup?id="+jsonArray.getString(randomLookupId));

                while(finalObj.getJSONArray("results").length() == 0)
                {
                    Log.d("Array VUOTO!!","Non è possibile!!!!");
                    randomLookupId = new Random().nextInt(jsonArray.length()-1);
                    Log.d("randomID rigenerato", String.valueOf(randomLookupId));

                    finalObj = getJSONObject("http://itunes.apple.com/lookup?id="+jsonArray.getString(randomLookupId));
                    Log.d("URL Rigenerato","http://itunes.apple.com/lookup?id="+jsonArray.getString(randomLookupId));
                }

                JSONArray finalJsonArray = finalObj.getJSONArray("results");

                JSONObject returnObj = finalJsonArray.getJSONObject(0);
                Log.d("returnObj.length",String.valueOf(returnObj.length()));

                canzoni.add(returnObj.getString("previewUrl"));
                canzoni.add(returnObj.getString("artistName"));
                canzoni.add(returnObj.getString("trackName"));
                canzoni.add(returnObj.getString("artistViewUrl"));
                canzoni.add(returnObj.getString("artworkUrl100"));
//              GTTapp app=(GTTapp) ((Activity)context).getApplication();
//              app.dieciCanzoni;
                Canzone.dieciCanzoni.add(i, new ArrayList<String>(canzoni));
            }
        }   
        catch (JSONException ignored)
        {
            ignored.getCause();
        }
        catch (MalformedURLException e) 
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        catch (IOException e) 
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return null;
    }

    private String scegliClassifica(int[] arrayGenere)
    {
        int randomArrayPosition = new Random().nextInt(arrayGenere.length);
        return "http://itunes.apple.com/WebObjects/MZStoreServices.woa/ws/charts?cc=us&g="+arrayGenere[randomArrayPosition]+"&name=Songs&limit=200";
    }

    JSONObject getJSONObject(String url) throws IOException, MalformedURLException, JSONException
    {

        HttpURLConnection conn = (HttpURLConnection) new URL(url).openConnection();

        InputStream in = conn.getInputStream();

        try
        {
            StringBuilder sb = new StringBuilder();
            BufferedReader r = new BufferedReader(new InputStreamReader(new DoneHandlerInputStream(in)));
            for (String line = r.readLine(); line != null; line = r.readLine())
            {
                sb.append(line);
            }
            return new JSONObject(sb.toString());
        }
        finally
        {
            in.close();
        }
    }
} 
```

问题：使用 .get() 方法使应用程序等待 AsyncTask 的整个计算，但它也阻塞了 UI 线程！！所以用户将保持黑屏 5 秒或更长时间，这不是一件好事！

如果我不使用 .get() 方法，我会收到一个 IndexOutOfBounds 异常，因为我开始播放音乐流但列表尚未填充。

你能建议我解决这种情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:07:14.530

删除`.get()`它会阻塞 UI 直到任务完成。

启动任何依赖于`AsycTask`in 的任务，例如（播放视频）

```
@Override
protected void onPostExecute(Void result)
{
    super.onPostExecute(result);

    pDialog.dismiss();
      //You can start music stream here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T16:18:55.570

Finally I solved my problem, some advices were good and helped me a lot!

I simply moved the startActivity instruction to onPostExecute of JsonCanzoni AsyncTask, and changed some code to adapt to the new version and it's all right! ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:08:05.463

get() 调用被阻塞。从文档：

> 如有必要，等待计算完成，然后检索其结果。

您应该做的是在开始播放音乐之前异步等待计算完成。

如果您不想在您的类之外公开异步任务，您可以在您的 JSonCanzoni 类中设置一个回调，以便在异步任务的 onPostExecute 方法中调用该回调。

就像是

```
public interface CanzoniDownloadedInterface {
   public void onCanzoniDownloaded();
}

public JsonCanzoni(int[] arrayGenere, CanzoniDownloadedInterface callback, Context context){
    this.arrayGenere = arrayGenere;
    this.context = context;
    this.callback = callback;
} 
```

在你的 onPostExecute() 中：

```
@Override
protected void onPostExecute(Void result)
{
    super.onPostExecute(result);
    this.callback.onCanzoniDownloaded();
    pDialog.dismiss();
} 
```

如果您让您的活动实现接口，则可以将其传递给您的类。

onCanzoniDownloaded() 实现是您需要开始播放的地方。

# java - JXL + POI：不兼容

> ID：13689843
> 
> 赞同：0
> 
> 时间：2012-12-03T18:59:31.937
> 
> 标签：java, apache-poi, jxl, jexcelapi, poi-hssf

我首先使用 JXL 修改 POI 创建的一个 xls 文件。之后，我将尝试使用 POI 读取该文件。在 POIFSFileSystem 创建的那一刻

```
 poFileSystem = new POIFSFileSystem(input); 
```

我得到了例外

```
 java.io.IOException: block[ 907 ] already removed - does your POIFS have circular or duplicate block references? 
```

这是这两个库之间的兼容性问题还是其他问题？我正在使用 POI 3.6 版和最新版本的 JXL。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T10:21:16.030

将 POIFSFileSystem 更改为 NPOIFSFileSystem 解决了我的问题。

# python - pygame声音格式差异

> ID：13689849
> 
> 赞同：0
> 
> 时间：2012-12-03T18:59:40.167
> 
> 标签：python, pygame, audio

为了播放我的声音，我有这个工作代码：

```
import pygame

pygame.init()
pygame.mixer.pre_init(44100, 16, 2)
screen = pygame.display.set_mode([100,100])
print(pygame.mixer.get_num_channels(),"cannels")
sounda = pygame.mixer.Sound("track.mp3")
print("Length",sounda.get_length())
print("Volume",sounda.get_volume())
channela = sounda.play()
while channela.get_busy():
   pygame.time.delay(100)
pygame.quit() 
```

你可以看到我主要使用 .mp3 文件。

但我的问题是它可以播放一些声音，但其他声音会导致错误，即无法加载声音。mp3文件之间有什么区别吗，你知道如何解决这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T06:33:17.187

所以我发现一种声音格式可能存在差异，因此 pygame 存在问题。使用 ocenaudio 程序，我可以以多种 .wav 格式操作和保存我的声音。Pygame 可以处理其中之一。

但是加载音乐从来都不是问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T16:18:40.740

如果 Pygame 没有加载您的音频，则有 3 种可能性。

# 可能性一：

Pygame 找不到您的文件。在说出文件名时，请确保声音文件与您的程序文件位于同一目录中，或者您可以提供整个文件路径（如“/home/person/sound.mp3”，而不仅仅是“声音.mp3'。）

# 可能性2：

您的文件格式错误。虽然它被称为 .mp3，但它可能是不同的类型。尝试使用音频转换程序。

# 可能性3：

Pygame 无法读取文件。Pygame 最适用于 .ogg 文件，但有时会遇到其他类型的问题。只需使用音频转换程序将其转换为 .ogg，它可能会起作用。

如果这些都不起作用，我们将不胜感激提供确切的错误消息。

# ruby-on-rails - Mongoid：是否有一个实用程序可以将数据库的字段与我的模型中定义的当前“模式”“同步”？

> ID：13689851
> 
> 赞同：1
> 
> 时间：2012-12-03T18:59:42.887
> 
> 标签：ruby-on-rails, mongoid

对不起，如果这个问题措辞很尴尬——这里仍然是 Mongo/Mongoid/Rails 新手。

我想问的是：

在我的开发过程中，我一直在改变我的模型设计，在这里添加一些字段，在那里删除一些字段（关于 MongoDB/Mongoid 的一大优点是你可以非常快速轻松地做到这一点！）

一切正常，但在浏览开发数据库时，我有一些“碎屑”——包含未使用的旧字段（和数据）的文档。除了我的垃圾收集敏感性之外，这没什么大不了的。理论上，我可以删除数据库并从头开始，但这很麻烦。

是否有一个实用程序/gem / 等可以从本质上查看当前文档设计并删除实时数据库中与数据模型不匹配的任何字段？

我知道这可以手动完成，并且我知道那里的 mongoid 迁移宝石——它们都是好的，最终是更彻底的解决方案（我会看看）。

不过，现在，我想知道是否有一个简单的“快速”类型的实用程序来简单地同步数据库并删除任何未在我的模型中明确指定的字段。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T17:39:48.900

我不知道有什么工具可以为您做到这一点。这不是一个常见的问题，因为大多数人认为这种灵活性是一个有用的特性。

对于您的开发数据库，​​您可能应该将其清除并重新开始。

在生产中，您有几个选择：

*   编写代码以防止字段丢失和数据库文档与您的 mongoid 模型不匹配。换句话说，要为两者不同步做好准备。

*   养成每次更改模型时迁移数据的习惯。如果您遵循第一个，这有点麻烦并且不是绝对必要的，但是如果不整洁困扰您，这是一个好主意。有关策略，请参阅[管理 mongoid 迁移](https://stackoverflow.com/questions/8570705/managing-mongoid-migrations)。

# gwt - 在 GWT 托管模式下在嵌入式 Jetty 上部署不同的上下文

> ID：13689853
> 
> 赞同：1
> 
> 时间：2012-12-03T18:59:49.547
> 
> 标签：gwt, jetty, gwt2

在使用 GWT 托管模式运行我的 web 应用程序时，我还没有找到一种方法将其部署在 Jetty 的根上下文之外。我只能在使用独立应用服务器并在没有 Jetty 的情况下运行托管模式时做到这一点。

有没有办法直接在嵌入式 Jetty 上运行，但在根上下文之外？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T17:44:42.113

我不确定您是否为此检查了谷歌群组。这对我[有用 https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/a8OsRmMSaMg](https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/a8OsRmMSaMg)

`jetty-web.xml`在你的`WEB-INF`目录中创建文件

```
<?xml version="1.0"  encoding="UTF-8"?> 
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" 
"http://jetty.mortbay.org/configure.dtd"> 
<Configure class="org.mortbay.jetty.webapp.WebAppContext"> 

        <Set name="contextPath">/myapp</Set> 

</Configure> 
```

GWT >= 2.6 的解决方案

```
<?xml version="1.0"  encoding="UTF-8"?>
<!DOCTYPE Configure PUBLIC 
    "-//Mort Bay Consulting//DTD Configure//EN" 
    "http://www.eclipse.org/jetty/configure_9_0.dtd">

<Configure class="org.eclipse.jetty.webapp.WebAppContext">
    <Set name="contextPath">/contextpath</Set>
</Configure> 
```

# azure - 将 Windows Azure 项目从库加载到 Visual Studio 2012

> ID：13689857
> 
> 赞同：6
> 
> 时间：2012-12-03T19:00:04.583
> 
> 标签：azure, visual-studio-2012, orchardcms, azure-web-app-service, webmatrix-2

我有一个 Windows Azure 网站。我以新建 -> 计算 -> 网站 -> 从图库开始这个网站。来到这里后，我选择了 Orchard CMS。我的站点在 Windows Azure 中成功运行。我的挑战是，我想对其进行一些自定义。

如何将此代码放入我的本地 Visual Studio 2012 实例中，以便我可以：

1.  使用 Visual Studio 2012 对站点进行自定义。
2.  将其签入源代码管理，以便我团队中的其他人可以使用它

我看到了以下帖子：[http](http://www.davidhayden.me/blog/installing-orchard-cms-as-an-azure-web-site) ://www.davidhayden.me/blog/installing-orchard-cms-as-an-azure-web-site 。但是，这仅涉及在 WebMatrix 中打开站点。如果可能，我想跳过 WebMatrix 并直接进入 Visual Studio。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:36:53.987

[下载 WebMatrix](http://www.microsoft.com/web/webmatrix/)并单击[功能区中的 Visual Studio 按钮](http://weblogs.asp.net/scottgu/archive/2010/07/06/introducing-webmatrix.aspx)。它必须为您创建一个解决方案文件，然后才能通过 Visual Studio 访问您的网站。我目前没有可供试用的 Azure 网站。

* * *

您可能需要[调整注册表以使 VS 2012 正确打开](http://scribblebin.com/post/2012/09/13/WebMatrix-opens-Visual-Studio-2012.aspx)：

*   键入`regedit`并选择`HKEY_CLASSES_ROOT`.
*   找到`VisualStudio.DTE`并更改`CurVer`为 `VisualStudio.DTE.11.0`
*   最后`CLSID`改成`{059618E6-4639-4D1A-A248-1384E368D5C3}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-28T23:49:02.920

您根本不需要使用 WebMatrix；另一种选择是从 FTP 下载文件，然后创建一个 VS 解决方案并添加您下载的文件。

在 Visual Studio 中，您可以轻松地将解决方案部署到 TFS 和您的 Azure 网站。

附带说明一下，从今天（2014 年 1 月 28 日）开始，不再需要 SilverNinja 提出的注册表编辑，我可以在不编辑注册表的情况下从 Webmatrix 打开 VS 2013 Professional。

# java - 用正则表达式替换Java中的String并replaceAll

> ID：13689860
> 
> 赞同：2
> 
> 时间：2012-12-03T19:00:10.297
> 
> 标签：java, regex, replaceall

是否有一个简单的解决方案可以`String`通过在 Java 中使用正则表达式来解析 a？

我必须适应一个 HTML 页面。因此我必须解析几个字符串，例如：

```
href="/browse/PJBUGS-911"
=>
href="PJBUGS-911.html" 
```

字符串的模式仅对应于 ID 不同（例如`911`）。我的第一个想法是这样的：

```
String input = "";
String output = input.replaceAll("href=\"/browse/PJBUGS\\-[0-9]*\"", "href=\"PJBUGS-???.html\""); 
```

我想替换除 ID 之外的所有内容。我怎样才能做到这一点？

如果有人可以帮助我会很好:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:02:54.970

您可以使用括号[捕获](http://www.regular-expressions.info/brackets.html)与您的模式匹配的子字符串。然后您可以在替换中使用捕获的内容，`$n`其中`n`括号组的数量是（从左到右计算左括号）。对于您的示例：

```
String output = input.replaceAll("href=\"/browse/PJBUGS-([0-9]*)\"", "href=\"PJBUGS-$1.html\""); 
```

或者，如果您愿意：

```
String output = input.replaceAll("href=\"/browse/(PJBUGS-[0-9]*)\"", "href=\"$1.html\""); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:05:09.993

这不使用正则表达式。但也许它仍然可以解决您的问题。

```
output = "href=\"" + input.substring(input.lastIndexOf("/")) + ".html\""; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:23:18.367

我会这样做：

```
public static void main(String[] args) 
    {
        String text = "href=\"/browse/PJBUGS-911\" blahblah href=\"/browse/PJBUGS-111\" " +
                "blahblah href=\"/browse/PJBUGS-34234\"";

        Pattern ptrn = Pattern.compile("href=\"/browse/(PJBUGS-[0-9]+?)\"");

        Matcher mtchr = ptrn.matcher(text);

        while(mtchr.find())
        {
            String match = mtchr.group(0);
            String insMatch = mtchr.group(1);

            String repl = match.replaceFirst(match, "href=\"" + insMatch + ".html\"");

            System.out.println("orig = <" + match + "> repl = <" + repl + ">");
        }
    } 
```

这仅显示正则表达式和替换，而不是最终的格式化文本，您可以使用以下命令获得`Matcher.replaceAll`：

```
String allRepl = mtchr.replaceAll("href=\"$1.html\""); 
```

如果只是对替换所有感兴趣，则不需要循环-我仅将其用于调试/显示正则表达式的业务方式。

# python - 金字塔烧杯和uwsgi入门

> ID：13689863
> 
> 赞同：1
> 
> 时间：2012-12-03T19:00:32.593
> 
> 标签：python, wsgi, pyramid, uwsgi, beaker

我有点迷失在这里。如何开始使用金字塔烧杯的 python 脚本。我更喜欢像这样通过 uwsgi 调用它：

```
uwsgi -s :9001  --module script 
```

但是当我使用 curl 调用它时，我得到了

```
KeyError: 'beaker.session' 
```

script.py 是这样的

```
from beaker.middleware import SessionMiddleware
from pyramid.config import Configurator

def application(environ, start_response):
    # Get the session object from the environ
    session = environ['beaker.session']

    start_response('200 OK', [('Content-type', 'text/plain')])
    return ['returned']

# Configure the SessionMiddleware
session_opts = {
    'session.type': 'file',
    'session.cookie_expires': True,
}
#wsgi_app = SessionMiddleware(application, session_opts)
config = Configurator()
config.include('pyramid_beaker')
wsgi_app = SessionMiddleware(application, session_opts) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:28:24.557

uwsgi -s :9001 --module 脚本:wsgi_app

是你需要的，否则uWSGI会调用“应用”函数，跳过中间件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:41:30.880

您不应该将 与`SessionMiddleware`结合使用`pyramid_beaker`。`request.session`Pyramid 通过自动为会话对象提供它自己的接口。

# ios - iOS 将照片保存到相机胶卷不会保留 EXIF/GPS 元数据

> ID：13689864
> 
> 赞同：6
> 
> 时间：2012-12-03T19:00:32.903
> 
> 标签：ios, uiimage, exif

我知道 UIImage 可以用 保存到相机胶卷中`UIImageWriteToSavedPhotosAlbum`，但是这种方法会从原始文件（EXIF、GPS 数据等）中删除所有元数据。有什么方法可以保存原始文件，而不仅仅是将图像数据保存到 iOS 设备的相机胶卷中？

编辑：我想我应该更具体一点。目的是将现有 JPEG 文件的副本保存到用户的相机胶卷中。最有效的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T00:25:55.140

根据您保存图像的方式，您可以选择**ALAssetsLibrary**提供的方法之一。

```
– writeImageDataToSavedPhotosAlbum:metadata:completionBlock:

– writeImageToSavedPhotosAlbum:metadata:completionBlock: 
```

（取决于您将图像作为实际的 UIImage 还是作为 NSData）

[http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)

请注意您必须为字典设置正确的键，否则它们可能无法正确保存。

以下是 GPS 信息的示例：

```
NSDictionary *gpsDict = [NSDictionary dictionaryWithObjectsAndKeys:
                 [NSNumber numberWithFloat:fabs(loc.coordinate.latitude)], kCGImagePropertyGPSLatitude, 
                 ((loc.coordinate.latitude >= 0) ? @"N" : @"S"), kCGImagePropertyGPSLatitudeRef, 
                 [NSNumber numberWithFloat:fabs(loc.coordinate.longitude)], kCGImagePropertyGPSLongitude, 
                 ((loc.coordinate.longitude >= 0) ? @"E" : @"W"), kCGImagePropertyGPSLongitudeRef, 
                 [formatter stringFromDate:[loc timestamp]], kCGImagePropertyGPSTimeStamp, 
                 [NSNumber numberWithFloat:fabs(loc.altitude)], kCGImagePropertyGPSAltitude, 
                 nil]; 
```

这是一个键列表：

[http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGImageProperties_Reference/Reference/reference.html#//apple_ref/doc/uid/TP40005103](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGImageProperties_Reference/Reference/reference.html#//apple_ref/doc/uid/TP40005103)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T23:02:59.920

UIImagePickerControllerDelegate 是您正在寻找的。

> 从 iOS 4.0 开始，您可以将静止图像元数据与静止图像一起保存到相机胶卷。为此，请使用 Assets Library 框架的 writeImageToSavedPhotosAlbum:metadata:completionBlock: 方法。请参阅 UIImagePickerControllerMediaMetadata 键的描述。

[UIImagePickerControllerDelegate 协议参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerControllerDelegate_Protocol/UIImagePickerControllerDelegate/UIImagePickerControllerDelegate.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-12T17:21:43.687

对于使用[Photos API](https://developer.apple.com/reference/photos)的 Swift 解决方案（在 iOS 9 中不推荐使用[ALAssetLibrary ），您可以](https://developer.apple.com/reference/assetslibrary/alassetslibrary)[在此处查看我对这个问题的解决方案，包括示例代码](https://stackoverflow.com/a/43375633/6431067)。

使用 Photos API，需要注意的关键是 PHAsset 的 .location 属性不会将 CLLocation 元数据嵌入文件本身，因此使用 EXIF 查看器不会显示任何结果。

为了解决这个问题，您必须将任何元数据更改直接嵌入到图像本身的数据中，然后再使用 Photos API 将其写入相机胶卷（或者，对于 9 之前的 iOS 版本，您必须使用 Data 写入一个临时文件嵌入的元数据并从文件的 URL 创建 PHAsset）。

另请注意，将图像数据转换为 UIImage 的行为似乎会剥离元数据，因此请注意这一点。

# eclipse - 在 Eclipse 插件开发期间如何对项目下的元素进行排序？

> ID：13689865
> 
> 赞同：0
> 
> 时间：2012-12-03T19:00:35.303
> 
> 标签：eclipse, eclipse-plugin, eclipse-cdt

我有一个 Eclipse(CDT) 插件，它在 Project Explorer 中某种类型的项目的根目录中提供了两个自定义节点。

由于某种原因，其中一个节点显示在项目下方节点的最顶部，而另一个节点位于文件夹和文件之间的底部。我可以更改这些节点上的标签，它不会改变任何东西。

有没有办法添加一个排序器（有点像我的自定义节点下的节点的 commonSorter）来直接在项目下重新排序东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:49:31.750

虽然不是确切的解决方案，但您可以将另一个 navigatorContent 项的 ID 放在 navigatorContent 项的“appearsBefore”属性中。这将强制您的自定义节点出现在另一个 navigatorContent 之前。

更完整的解决方案可能涉及使用“sortOnly”方法，但现在这对我有用（并且可能更快）。

# php - 使用 $_get 变量验证 css.php？

> ID：13689870
> 
> 赞同：0
> 
> 时间：2012-12-03T19:00:53.960
> 
> 标签：php, css, validation, w3c

我正在使用 php 生成一个 css 文件，声明一个标题，如：

```
<?php
header("Content-type: text/css; charset: UTF-8"); 
?> 
```

并从 index.php 传递 url，如：

```
<link href="http://www.site.com/css.php?style_profile=2" media="screen" rel="stylesheet" type="text/css" /> 
```

我无法从 w3c css 验证器验证此文件，因为它无法识别文件类型。这是我不断收到的错误：

```
Unknown error org.w3c.www.http.HttpInvalidValueException: Invalid content type. 
```

有什么方法可以在不手动粘贴 css 数据的情况下进行验证？如果没有，是否有任何其他验证服务可以识别 css.php 文件（或者带有 get vars 的文件，如果这是导致错误的问题）？我真的很希望能够通过链接进行验证，而不必为我网站上的每个页面剪切和粘贴 css。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:23:57.923

我不知道这是否会解决您的问题（现在无法测试），但这是我注意到的：

[根据 W3 规范](http://www.w3.org/International/O-HTTP-charset.en.php)，您的 PHP 标头不正确，应为`charset=utf-8`.

# javascript - 如何在 Windows Script Host 中使用 jQuery？

> ID：13689871
> 
> 赞同：10
> 
> 时间：2012-12-03T19:00:53.513
> 
> 标签：javascript, jquery, jscript, wsh

我正在处理一些需要解析大量包含 HTML 片段的文件的代码。jQuery 似乎对此非常有用，但是当我尝试将 jQuery 加载到 WScript 或 CScript 之类的东西中时，由于 jQuery 对窗口对象的许多引用，它会引发错误。

在没有浏览器运行的代码中使用 jQuery 有什么实用的方法？

**更新：**作为对评论的回应，我已经成功编写了 JavaScript 代码来使用`new ActiveXObject('Scripting.FileSystemObject');`. 我知道 ActiveX 是邪恶的，但这只是一个内部项目，用于从一些包含 HTML 片段的文件中获取一些数据并进入适当的数据库。

**另一个更新：**到目前为止，我的代码看起来像这样：

```
var fileIo, here;

fileIo = new ActiveXObject('Scripting.FileSystemObject');
here = unescape(fileIo.GetParentFolderName(WScript.ScriptFullName) + "\\");

(function() {
    var files, thisFile, thisFileName, thisFileText;

    for (files = new Enumerator(fileIo.GetFolder(here).files); !files.atEnd(); files.moveNext()) {
        thisFileName = files.item().Name;
        thisFile = fileIo.OpenTextFile(here + thisFileName);
        thisFileText = thisFile.ReadAll();        

        // I want to do something like this:
        s = $(thisFileText).find('input#txtFoo').val();    
    }

})(); 
```

**更新：**我也在 jQuery 论坛上发布了这个问题：http: [//forum.jquery.com/topic/how-to-use-jquery-without-a-browser#14737000003719577](http://forum.jquery.com/topic/how-to-use-jquery-without-a-browser#14737000003719577)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T18:57:46.443

按照您的代码，您可以使用 Windows Script Host 创建一个 IE 实例，将您的 html 文件加载到该实例中，将 jQuery 动态附加到加载的页面，然后从中编写脚本。

这适用于带有 XP 的 IE8，但我知道 Windows 7/IE9 中存在一些安全问题。如果您遇到问题，您可以尝试[降低您的安全设置](https://stackoverflow.com/questions/6661005/error-the-object-invoked-has-disconnected-from-its-clients-automate-ie-8-wit)。

```
var fileIo, here, ie;

fileIo = new ActiveXObject('Scripting.FileSystemObject');
here = unescape(fileIo.GetParentFolderName(WScript.ScriptFullName) + "\\");
ie = new ActiveXObject("InternetExplorer.Application");
ie.visible = true

function loadDoc(src) {
  var head, script;
  ie.Navigate(src);
  while(ie.busy){
    WScript.sleep(100);
  }
  head =  ie.document.getElementsByTagName("head")[0];    
  script = ie.document.createElement('script');
    script.src = "http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js";
  head.appendChild(script);
  return ie.document.parentWindow;
}

(function() {
    var files, thisFile, win; 
    for (files = new Enumerator(fileIo.GetFolder(here).files); !files.atEnd(); files.moveNext()) {
        thisFile = files.item();         
        if(fileIo.GetExtensionName(thisFile)=="htm") {
          win = loadDoc(thisFile);
          // your jQuery reference = win.$
          WScript.echo(thisFile + ": " + win.$('input#txtFoo').val());
        }  
    }
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-15T00:41:56.937

这在 Node.js 中使用cheerio 包很容易做到。您可以从任何您想要的来源读取任意 HTML，用cheerio 解析它，然后使用 jQuery 样式选择器访问解析的元素。

# wordpress - 配置 Ubuntu VPS 以发送外发邮件？

> ID：13689878
> 
> 赞同：1
> 
> 时间：2012-12-03T19:01:23.603
> 
> 标签：wordpress, apache, email, ubuntu, vps

我需要从托管 wordpress 网站的 VPS 发送邮件，外发邮件主要用于新用户注册，我找不到一个单一的指南。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:28:35.930

You can follow this guide to setup email service on Ubuntu if your VPS doesn't have it

[http://jonsview.com/how-to-setup-email-services-on-ubuntu-using-postfix-tlssasl-and-dovecot](http://jonsview.com/how-to-setup-email-services-on-ubuntu-using-postfix-tlssasl-and-dovecot)

But usually if your VPS have Control panel like Plesk,cPanel ..etc... Just simple create a new email account and using it

You can also install this plugin to wordpress (optional). If you want send mail via SMTP [http://wordpress.org/extend/plugins/wp-mail-smtp/](http://wordpress.org/extend/plugins/wp-mail-smtp/)

# java - Java的通用`any`函数

> ID：13689880
> 
> 赞同：2
> 
> 时间：2012-12-03T19:01:28.507
> 
> 标签：java, generics

我有各种`Node`和`Token`其他课程。每个类都有自己的`Type`枚举。

我有节点列表、标记列表和其他事物列表。

而且我经常想看看列表中是否有任何特定项目`Type`。

例如，要查看标记列表中是否有任何*关键字*，我会遍历它们：

```
Token found = null;
for(Token token: statement)
    if(token.type == Token.Type.KEYWORD &&
      (token.token.equals("static") ||
      (token.token.equals("final")) {
        found = token;
        break;
    }
if(found != null) {
    .... 
```

如果我编写小帮手，我可以大量整理我的代码（因为我想弄清楚列表中的内容很多）：

```
Token any(Collection<Token> haystack,Token.Type type,String... needles) {
   for(Token straw: haystack)
       if(straw.type == type)
            for(String needle: needles)
                if(needle.equals(straw.token))
                    return straw;
   return null;
} 
```

然后，在其他地方，我可以：

```
if((found = any(statement,Token.Type.KEYWORD,"static","final")) != null)
   ... 
```

有什么方法可以概括这个`Node`和其他变量，以及不是字符串的比较，字段不同，命名不同？

使用 C++ 模板，您可以回避类型；使用Java，我正在努力了解如何做到这一点，尽管使类与它们自己的类型等可比可能是一种前进的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:15:33.357

使用鸭子类型的事情通常可以通过 java 中的接口来完成。考虑这个接口：

```
public interface Typed<T extends Enum<T>> {
    T getType();
    String getToken();
} 
```

然后您可以更改您的`any`方法以仅使用实现此接口的类型：

```
public <A extends Enum<A>, B extends Typed<A>> B any(Collection<B> haystack, A type, String... needles) {
    for (B straw : haystack)
        if (straw.getType().equals(type))
            for (String needle : needles)
                if (needle.equals(straw.getToken()))
                    return straw;
    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:08:04.293

您可以在 Java 中使用带有反射的鸭子类型，但它很可能是

*   更复杂，而不是更简单
*   更容易出错

我建议你坚持写和理解最简单的东西。

```
FOUND: {
  for(Token token: statement)
    if(token.type == Token.Type.KEYWORD &&
      (token.token.equals("static") ||
      (token.token.equals("final")) {
        // handle token here
        break FOUND;
    }
  // handle not found here
} 
```

您可以创建一个方法并在找到匹配项时返回，而不是使用标签。

我怀疑 KEYWORD 检查在这里是多余的，因为我假设您不能拥有`static`或者`final`它不是关键字。一种更有效的方法是这样的。

```
static final List<String> KEYWORDS_TO_MATCH = Arrays.asList("static", "final");

FOUND: {
   for(Token token: statement)
     if(KEYWORDS_TO_MATCH.contains(token.token)) {
        // handle token here
        break FOUND;
     }
   // handle not found here
} 
```

# javascript - Google Map API v3“点击”事件仅在双击时有效？

> ID：13689882
> 
> 赞同：0
> 
> 时间：2012-12-03T19:01:47.163
> 
> 标签：javascript, google-maps-api-3, dom-events

再一次，我对 Google Map API v3 有一个奇怪的小问题。我确定我忽略了一些简单的事情，但是在寻找了几个小时的答案之后，我已经准备好寻求帮助了。

我有一个多边形形状，我终于想出了如何通过单击放大...除了现在它不是通过单击放大多边形，而是需要双击。令我困惑的是，该脚本只需单击一下即可。这是我所指的脚本部分：

```
 // Add a listener for the click event
  google.maps.event.addListener(zone1, 'center_changed', function() {     
      window.setTimeout(function() {
          map.panTo(marker.position());
      }, 1000);
  });

  google.maps.event.addListener(zone1, 'click', function() {
      map.setCenter(marker.position(29.737, -95.394),
      map.setZoom(18)
      );
  }); 
```

这是一个工作页面的链接：http: [//www.conleym.com/map/google_maps_code_9_zoom.html](http://www.conleym.com/map/google_maps_code_9_zoom.html) *当前设置为缩放的唯一多边形是多边形 1 - 地图顶部的蓝色形状。

我已经在 Firefox(23)、IE(9) 和 Chrome(16) 上对其进行了测试，结果都相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T17:43:33.890

我假设您希望地图缩放到多边形的“边界”（以显示整个多边形）。在这种情况下，你可以做这样的事情（对于每个区域）；并删除多边形上的“center_changed”侦听器：

```
zone1._myBounds = new google.maps.LatLngBounds();
for (var i=0; i<triangleCoords.length; i++)
{
   zone1._myBounds.extend(triangleCoords[i]);
}

google.maps.event.addListener(zone1, 'click', function () {
  map.fitBounds(zone1._myBounds);
}); 
```

[工作示例](http://www.geocodezip.com/conleym_com_google_maps_code_9_zoom.html)

请注意，这种方法不是很可扩展（我建议创建一个函数来获取多边形的数据，完成所有这些，然后将引用推送到数组中以供以后使用）。

# scripting - 查找所有用户，将它们用作变量以从 cmd 中提取 appdata 目录列表？

> ID：13689884
> 
> 赞同：2
> 
> 时间：2012-12-03T19:01:46.837
> 
> 标签：scripting, cmd, appdata, findstr

我正在尝试构建一个脚本，该脚本将提取用户列表，获取他们的每个姓名，然后为他们的每个 appdata 文件夹创建一个目录列表。

到目前为止，我认为我可以只使用`net user > C:\userlist.txt`来创建用户列表，我真正的问题在于获取用户的姓名并将它们放入下一个命令。

通过使用某种变量，我想让 findstr 拉入每个用户，以便我可以获得所有用户目录的列表。

最终结果将如下所示：

```
dir C:\users\$variableforusers\AppData\Roaming > C:\directorylist.txt 
```

我希望能够让这个命令为每个用户的 appdata 目录运行，所以这个命令需要根据终端机器有多少用户来重复。

这将从本地系统帐户运行，因此 %appdata% 将不起作用，因为它只会为您提供当前登录用户的 appdata 文件夹。

如果可能的话，我希望将目录列表全部转储到一个文件中，否则我必须引入一个变量来检查多个文件的结果。

提前感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:15:25.217

我认为您不应该使用用户名来获取用户配置文件目录的路径。目录名可以与用户名不同 - 例如，如果在创建配置文件后更改了用户名 hsa 或存在用户名冲突（本地用户与域用户具有相同的用户名）。

您可以使用以下语法为每个子目录执行 a `dir`of ：`AppData\Roaming``C:\Users`

```
for /d %A in (C:\Users\*) do if exist %A\AppData\Roaming dir %A\AppData\Roaming 
```

但同样，此解决方案将省略存储在 C:\Users 之外的任何用户配置文件。

要为每个用户配置文件创建一个`dir`目录`AppData\Roaming`，您可以从注册表中获取用户配置文件的路径：

```
for /f "tokens=3" %A in ('reg query "HKLM\Software\Microsoft\WindowsN T\CurrentVersion\ProfileList" /s /v ProfileImagePath ^| find "REG_EXPAND_SZ"') do @dir %A\AppData\Roaming 
```

如果要在脚本中使用这些命令，请使用双百分号 (%%A)。了解有关`for`命令类型的更多信息`for /?`

# javascript - HTML5 过渡

> ID：13689887
> 
> 赞同：0
> 
> 时间：2012-12-03T19:01:53.243
> 
> 标签：javascript, html, css, css-transitions

寻找一些 HTML5 过渡的例子，我调整了我发现的东西，最终得到了我真正想要的东西。

```
<!DOCTYPE html>
<html>
<head>
    <style>
        div {
          width: 50px;
          height: 50px;
        }

        div.myDiv {
          position: absolute;
          -webkit-transition-property: top, opacity;
          -webkit-transition-duration: 1s, 1s;
          -webkit-transition-timing-function:ease-in-out, ease-in-out;

          -moz-transition-property: top, opacity;
          -moz-transition-duration: 1s, 1s;
          -moz-transition-timing-function:ease-in-out, ease-in-out;

          -o-transition-property: top, opacity;
          -o-transition-duration: 1s, 1s;
          -o-transition-timing-function:ease-in-out, ease-in-out;

          transition-property: top, opacity;
          transition-duration: 1s, 1s;
          transition-timing-function:ease-in-out, ease-in-out;
        }
        #one {
          top: 0px;
          background-color: blue;
          opacity: 1;
        }

        #two {
          top: 50px;
          background-color: green;
          opacity: 0;
        }

        #three {
          top: 100px;
          background-color: red;
          opacity: 0;
        }

        #container {
          width: 50px;
          height: 150px;
          position: relative;
          overflow:hidden;
        }
    </style>
    <script>

    function one() {
      document.getElementById('one').style.top = "0px";
      document.getElementById('two').style.top = "50px";
      document.getElementById('three').style.top = "100px";

      document.getElementById('one').style.opacity = "1";
      document.getElementById('two').style.opacity = "0";
      document.getElementById('three').style.opacity = "0";
    }
    function two() {
      document.getElementById('one').style.top = "-50px";
      document.getElementById('two').style.top = "0px";
      document.getElementById('three').style.top = "50px";

      document.getElementById('one').style.opacity = "0";
      document.getElementById('two').style.opacity = "1";
      document.getElementById('three').style.opacity = "0";
    }

    function three() {
      document.getElementById('one').style.top = "-100px";
      document.getElementById('two').style.top = "-50px";
      document.getElementById('three').style.top = "0px";

      document.getElementById('one').style.opacity = "0";
      document.getElementById('two').style.opacity = "0";
      document.getElementById('three').style.opacity = "1";
    }
    </script>
</head>
<body>
<div id='container'>
    <div class="myDiv" id='one'>
    </div>
    <div class="myDiv" id='two'>
    </div>
    <div class="myDiv" id='three'>
    </div>
</div>
<input type='button' onclick='one();' value='one!'></input>
<input type='button' onclick='two();' value='two!'></input>
<input type='button' onclick='three();' value='three!'></input>
</body>
</html> 
```

我在某个地方读到了不建议从 javascript 更改 css 属性的地方。我认为这是一个不好的做法。我确信必须有一个更优雅和更好的方法来做到这一点。

任何的想法？[（这里](http://jsfiddle.net/EgSJ5/)小提琴）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:04:43.377

我不确定在 JavaScript 中更改 CSS 属性是否一定是不好的做法，但也许如果您的用户可能会关闭 JavaScript，您可能不想以这种方式更改对网站运行至关重要的属性.

您的 JavaScript 可以按如下方式重构，其明显优势在于它使添加或删除框变得微不足道（参见 fiddle [here](http://jsfiddle.net/q9ATF/)）：

```
 // We can define any number of boxes here
  var boxes = ['blue', 'green', 'red'];
  var height = 50;

  // We'll put the boxes in a div which we will move 
  // so that we don't have to manage the movement of 
  // multiple elements
  var slider = document.getElementById('slider');
  var div;

  for (var i = 0; i < boxes.length; i ++) {

    // Create a box for each element in array
    div = document.createElement('div');

    div.setAttribute('id', 'box_' + i);
    div.setAttribute('class', 'myDiv');

    div.style.background = boxes[i];
    div.style.top = (i * height) + "px";
    div.style.opacity = (i == 0) ? 1 : 0;

    // Now stick it in the slider div
    slider.appendChild(div);
  }

  function slide(index) {

    // Calculate new slider position according to supplied index
    var top = (index * height) * -1;

    document.getElementById('slider').style.top = top + 'px';
    toggleVisible(document.getElementById('box_' + index));
  }

  // Hide non-selected boxes and reveal selected
  function toggleVisible(show) { 

    var div;

    for (var i = 0; i < boxes.length; i ++) {
      div = document.getElementById('box_' + i);
      div.style.opacity = (div === show) ? 1 : 0;
    }
  } 
```

**HTML：**

```
<div id='container'>
  <div id='slider'></div>
</div>

<input type='button' onclick='slide(0);' value='one!'></input>
<input type='button' onclick='slide(1);' value='two!'></input>
<input type='button' onclick='slide(2);' value='three!'></input> 
```

**CSS：**

```
div {
  width: 50px;
  height: 50px;
}

div.myDiv {
  position: absolute;
  -webkit-transition-property: opacity;
  -webkit-transition-duration: 1s, 1s;
  -webkit-transition-timing-function:ease-in-out, ease-in-out;

  -moz-transition-property: opacity;
  -moz-transition-duration: 1s, 1s;
  -moz-transition-timing-function:ease-in-out, ease-in-out;

  -o-transition-property: opacity;
  -o-transition-duration: 1s, 1s;
  -o-transition-timing-function:ease-in-out, ease-in-out;

  transition-property: opacity;
  transition-duration: 1s, 1s;
  transition-timing-function:ease-in-out, ease-in-out;
}

#container {
  width: 50px;
  height: 150px;
  position: relative;
  overflow:hidden;
}

#slider { 
  position: absolute;
  -webkit-transition-property: top;
  -webkit-transition-duration: 1s, 1s;
  -webkit-transition-timing-function:ease-in-out, ease-in-out;

  -moz-transition-property: top;
  -moz-transition-duration: 1s, 1s;
  -moz-transition-timing-function:ease-in-out, ease-in-out;

  -o-transition-property: top;
  -o-transition-duration: 1s, 1s;
  -o-transition-timing-function:ease-in-out, ease-in-out;

  transition-property: top;
  transition-duration: 1s, 1s;
  transition-timing-function:ease-in-out, ease-in-out;
} 
```

# html - 像 twitter bootstrap 这样的单杠图标

> ID：13689892
> 
> 赞同：0
> 
> 时间：2012-12-03T19:02:13.337
> 
> 标签：html, css, internet-explorer-8, twitter-bootstrap

当屏幕缩小到@media(mobile~) 宽度时，我正在尝试创建选项图标，例如右上角的 twitter bootstrap 图标。我做了一些逆向工程，能够在 Chrome 和 Safari 上重新创建图标。然而，它在 Firefox 中看起来有点不同，而在 IE8 中则完全不同。

![各种浏览器中的图像](../Images/67379596596728eacde3357a40438c6a.png)

寻求帮助来解决这个问题。

html:

```
<html>
<head>
  <link rel="stylesheet" type="text/css" href="optionspanel.css" />
</head>
<body>
  <ul id="nav">
    <li>
      <button type="button" class="fw-opt-panel">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a id="optionsicon" href="#" class="selected"></a>
        <ul>
            <li><a href="#">Item 01</a></li>
            <li><a href="#" class="selected">Item 02</a></li>
            <li><a href="#">Item 03</a></li>
        </ul>
        <div class="clear"></div>
    </li>
</ul>
<div class="clear"></div>

</body>
</html> 
```

CSS：

```
.fw-opt-panel {
  background-color: rgb(14, 14, 14);
  background-image: -webkit-linear-gradient(top, rgb(21, 21, 21), rgb(4, 4, 4));
  border-bottom-color: rgba(0, 0, 0, 0.247059);
  border-radius: 4px;
  border-style: solid;
  border-color: rgba(0, 0, 0, 0.0980392);
  border-width: 1px;
  border-top-width: 1px;
  box-shadow: rgba(255, 255, 255, 0.0980392) 0px 1px 0px 0px inset, rgba(255, 255, 255, 0.0745098) 0px 1px 0px 0px;
  cursor: pointer;
  float: right;
  padding: 7px;
}

.icon-bar {
  background-color: rgb(245, 245, 245);
  border-radius: 1px;
  cursor: pointer;
  display: block;
  height: 2px;
  margin-top: 3px;
  width: 18px;  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:15:57.900

另一种方法是使用[三连](https://en.wikipedia.org/wiki/Triple_bar)字符 Unicode 字符 - ☰ (U+2630)。它也有许多不同的图标字体，可以修复跨浏览器的差异，比如 Font Awesome 或[Entypo](http://entypo.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:12:49.893

IE 6-9 不会按照您期望的方式（或根本没有）呈现半径、渐变或文本阴影。

尝试使用 PIE（请参阅[此处的 PIE 示例](http://css3pie.com/)）。

至于 Firefox，它也喜欢在您生成渐变或半径时被指向。除了 webkit 之外，还使用 ​​-moz-linear-gradient。

# javascript - Dojo 水平滑块显示在标签上

> ID：13689894
> 
> 赞同：0
> 
> 时间：2012-12-03T19:02:19.100
> 
> 标签：javascript, slider, dijit.form

我正在设置`dijit.form.HorizontalSlider`带有标签和规则的标签，但我无法让显示器正常工作。滑块显示在规则和标签的顶部。我可以看到放置标签和规则的 div 没有高度属性，我猜这就是我的问题，但我似乎无法修复它。

这是代码...

```
//create a div for the rule in my inner node div
this.ruleDiv = dojo.create("div", {}, dojo.byId("ruleDiv"), "first");
this.getInnerNode().appendChild(this.ruleDiv);

//create a div for the labels in my inner node div
this.labelsDiv = dojo.create("div", {},dojo.byId("labelsDiv"), "first");
this.getInnerNode().appendChild(this.labelsDiv);

//create the rule object
this.sliderLabelsRule = new HorizontalRule({
    container: "topDecoration",
    count: 10
}, this.getLabelsRuleDiv());

//create the labels object  
this.sliderLabels = new HorizontalRuleLabels({
    container: "topDecoration",
    labelStyle: "font-size: 10px;",
    labels: ["test0", "test1", "test2", "test3", "test4", "test5", 
             "test6", "test7", "test8", "test9"]
}, this.getLabelsDiv());

//create the slider   
this.slider = new Slider({}, this.getInnerNode());

//startup the widgets
this.getSlider().startup();
this.getLabelsRule().startup();
this.getLabels().startup(); 
```

我试过交换东西并尝试了很多不同的方法，但我似乎找不到正确的组合，感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T14:16:45.173

在您的 Horizo​​ntalRule 构造函数中，添加一个样式属性来设置高度。像这样的东西。

```
this.sliderLabelsRule = new HorizontalRule({
  container: "topDecoration",
  count: 10,
  style: "height: 5px;"
}, this.getLabelsRuleDiv()); 
```

我有一个类似的问题，我的所有标签和规则都在滑块下方，但也直接堆叠在一起，所以我有十个标签和规则乱七八糟，我不得不将上述构造函数中的宽度设置为相同的宽度作为我的滑块并使用 position: absolute 将它们移动到正确的位置。要将它们准确地放在您想要的位置，您可能需要做类似的事情。只需在构造函数的 style 属性中使用 css

# iphone - 在 iPhone 5 和其他设备上管理屏幕高度差异的最佳方法

> ID：13689895
> 
> 赞同：2
> 
> 时间：2012-12-03T19:02:19.360
> 
> 标签：iphone, ios, uiview, storyboard, iphone-5

管理 iPhone 5 和其他版本之间屏幕高度差异的最佳方法是什么？

如果我们使用故事板或 xib，它会相应地调整它的大小。但是如果整个视图都是以编程方式构建的，我们如何处理这个问题。

目前我所做的是获得整个屏幕高度并根据此高度设置其余 UI 元素，例如 height * .7 或 height *.5 ..

但它仍然没有给我最好的体验。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:09:14.707

您可以检查`[UIScreen mainScreen].bounds.size.height`（可能是，将其用作静态方法或执行`#define`）并根据屏幕高度进行屏幕设计。另一种方法是使用`view.autoresizingMask`属性来调整视图。

例如：-

```
view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

如果您正在为 iOS 6 构建，您可以使用[自动布局](http://developer.apple.com/library/mac/#releasenotes/UserExperience/RNAutomaticLayout/_index.html#//apple_ref/doc/uid/TP40010631)功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T06:52:28.153

在您的 viewDidLoad 中，只需检查屏幕大小就像这样......

```
- (void)viewDidLoad
{
   [super viewDidLoad];
    CGRect screenBounds = [[UIScreen mainScreen] bounds];
   if (screenBounds.size.height == 568)
   {
       //iPhone 5
   }
   else
   {
       // iPhone 4
   }

} 
```

# javascript - 用斜线填充的 JSON 数据

> ID：13689898
> 
> 赞同：1
> 
> 时间：2012-12-03T19:02:30.177
> 
> 标签：javascript, json, csv

您好，我正在从事一个项目，我必须更新一个充满 JSON 数据的数据库。但是，此数据如下所示：

> {\"Id\":\"1\",\"Sounding\":\"1.075\",\"Ullage\":\"0\",\"Full\":\"100\",\ "容量M\":\"3.918\",\"容量MT\":\"3.918\",\"LCG\":\"3.779\",\"TCG\":\"0\",\"VCG \":\"2.39\",\"FSM\":\"4.492\"}

但是，如果我将原始数据转换为 json 格式（来自 CSV 文件），它看起来像这样：

> {"ID":1,"SOUNDING":1.075,"ULLAGE":0.000,"FULL":100.000,"CAPACITY":3.918,"CAPACITY":3.918,"LCG":3.779,"TCG":0.000," VCG":2.390,"FSM":0.000}

我如何像第一个一样添加所有这些斜杠，使其格式正确？我真的需要它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:41:43.747

看起来数据库中的字符串是 javascript（或 C- 或 Java-，您应该检查）字符串转义。最简单的方法是使用[org.apache.commons.lang3.StringEscapeUtils.escapeEcmaScript()](http://commons.apache.org/lang/api-3.0.1/org/apache/commons/lang3/StringEscapeUtils.html#escapeEcmaScript%28java.lang.String%29)或[org.apache.commons.lang.StringEscapeUtils.escapeJavaScript()](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/StringEscapeUtils.html#escapeJavaScript%28java.lang.String%29)方法。还要检查这些类的其他方法。

替代方法是将第一个 JSON 作为字符串存储在第二个临时 JSON 对象中，然后将第二个 JSON 对象转换为字符串，然后从中获取仅包含第一个 JSON 对象的转义字符串值的子字符串（我认为这将是之间的部分第二个 JSON 字符串中的第三个和最后一个双引号...）。有点hacky，但避免添加额外的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:26:41.057

如果我没有误解任何内容，我认为您可以使用[`json_parse`](https://github.com/douglascrockford/JSON-js/blob/master/json_parse.js).

这是一个例子：http: [//jsfiddle.net/mqchen/yEJdq/](http://jsfiddle.net/mqchen/yEJdq/)

```
json_parse(data, function(key, value) {
    var floatVal = parseFloat(value);
    return !isNaN(floatVal) && isFinite(value) ? floatVal : value;
}); 
```

它使用 json_parse 但向它发送一个委托，该委托将看起来像数字的字符串解释为数字。

编辑：这是一个版本，它也将所有键转换为大写（如果你也想要的话）：http: [//jsfiddle.net/mqchen/yEJdq/2/](http://jsfiddle.net/mqchen/yEJdq/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:14:47.417

看起来数据已经针对某些编程语言的字符串/文本文字格式进行了转义。

# javascript - 在 Rails 中保存和更新基于 AJAX 的图形的状态

> ID：13689903
> 
> 赞同：1
> 
> 时间：2012-12-03T19:02:59.317
> 
> 标签：javascript, ruby-on-rails, ajax, json, google-visualization

我在 Rails 项目中有一个 Google Chart 的 ColumnChart。这是通过调用呈现 JSON 的 Rails 控制器操作在 JavaScript 中生成和填充的。

该图表显示了客户一个月的信息。

在图表上方，我有下一个和上一个箭头，允许客户更改图表上显示的月份。这些没有任何功能。

我的问题是，对于查看图表的客户来说，就当前月份而言，保存图表状态的最佳方法是什么。

以下是我正在考虑的工作流程：

1.  选择箭头之一。
2.  此事件在 JavaScript 中被捕获。
3.  另一个对 Rails 动作呈现 JSON 的请求是通过一个附加的 GET 参数执行的，该参数基于箭头按钮的数据属性（+ 或 - ）。
4.  使用新的 JSON 响应重新呈现图表。

是否会在服务器端执行有关增加或减少图表当前日期的逻辑？图表的日期存储在会话数组中，首次加载时默认为当前日期？

另一方面，将图表状态保存在客户端的 JavaScript 代码或 cookie 中，然后在将其发送到 Rails 控制器之前操纵日期是否有意义？

我已经使用 Rails 开发了大约 6 个月并且对它感到满意，但最近才开始使用 AJAX 使用 JavaScript 进行开发。在这一点上，我将 JS 代码与 Rails 结合在一起的经验是有限的，所以寻找一些关于如何处理这个问题的建议/最佳实践。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:18:35.237

我将通过几个选项，一些好的，一些坏的。

首先，您绝对不想做的是在 cookie 或任何其他形式的持久服务器端存储中维护您所在月份的任何概念。当然，有时服务器状态是必要的，但当它们是简单的替代品时不应该使用它。REST 的一部分（Rails 主要围绕它构建）试图以纯属性表示数据，而不是让它的状态像那样分散。

从这里开始，大多数解决方案可能都是可以接受的，并且意见起着更大的作用。您可以做的一件事是使用当前月份从 +/- 符号计算一个月并将其发送到服务器，服务器将返回所请求月份的信息。

不过，我不是这个的超级粉丝，因为您必须编写能够创建有效日期范围的 javascript，并且大部分功能可能已经在服务器上。只需将 +/- 和当前月份传递给服务器也可以，您只需执行一些额外的路由和逻辑即可将服务器上的符号解析为不同的月份。

虽然其中任何一个都可以，但我首选的解决方案是让月份的初始请求生成相邻月份的有效表示，并将其返回给客户端。然后，当您使用请求的数据更新图表时，您还将图表上的前向/后向链接替换为服务器提供的链接。这很好地融合了前两种解决方案的优点——在服务器上没有额外的路由，也没有对客户端代码进行实质性的添加。此外，您还有一个额外的好处，那就是能够将过渡到没有从客户那里收集数据的月份（即在他们成为客户之前和未来）。如果没有这个，您必须创建单独的逻辑来处理客户端对不存在的信息的请求，

# statistics - 拉普拉斯平滑如何影响先验/证据

> ID：13689912
> 
> 赞同：1
> 
> 时间：2012-12-03T19:03:48.357
> 
> 标签：statistics, probability, classification, bayesian

我有一个与实施朴素贝叶斯分类器相关的概率/统计问题，特别是关于实施拉普拉斯平滑以避免零计数问题和过度拟合。

从我读过的内容来看，使用 MLE 的基本 NBC 公式如下所示：

```
p(C│F_1 ...F_n )=(p(C)p(F_1 |C)...p(F_n |C))/(p(F_1)...p(F_n)) 
```

但是，如果其中一个 p(F_i |C) 为零，则整个概率变为 0。一种解决方案是 Lapace 平滑

```
p(F_i│C)~(x_i+k)/(N+kd) 
```

其中 x_i 是 F_i 在 C 类中出现的次数，N 是 C 类出现的次数，d 是已知 F_i 具有的不同值的数量。

我的问题是这样的：

如果需要对分子中的 p(C) 和分母中的 p(F_i) 做任何事情怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T16:43:21.173

令 f = (f_1 ... f_n)。拉普拉斯平滑影响类似然项 p(f|C)。它不影响类先验 p(C)。它确实对 f 的边际概率有影响，从某种意义上说：

p(f) = \sum_c p(C) * p(f|C)

因此，如果你是拉普拉斯平滑，那么术语 p(f|C) 是不同的。但是由于所有 C 的分母都是恒定的，所以无论如何你都不应该费心去评估它。

PS这不是一个真正的编程问题！

# c - 在基于手臂的拱门上声明标志的更好方法是什么？

> ID：13689913
> 
> 赞同：2
> 
> 时间：2012-12-03T19:04:03.460
> 
> 标签：c, linux, linux-kernel, arm

对于基于手臂的拱门来说，什么更好？

```
struct my_struct{
    struct device   *dev;
    unsigned char   a:1,
            b:1,
            v:1,
            d:1;
}; 
```

或者定义一个 char 并使用按位操作：

```
struct my_struct{
    struct device   *dev;
    unsigned char abcd;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:53:14.997

我认为处理器的架构对于这个问题并不重要。在许多方面，这纯粹是一个风格问题。

根据我的经验，大多数人倾向于使用无符号整数和按位运算：

```
#define MASK_B 0x20;
unsigned char field;
int b_is_set = field & MASK_B; 
```

位域似乎从未真正在主流代码中流行起来。

话虽这么说，我会用你觉得更自然的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:37:27.143

首先要做的是考虑对齐，阅读更多关于unaligned [-memory-access](https://github.com/torvalds/linux/blob/master/Documentation/unaligned-memory-access.txt)和[mem_alignment](https://github.com/torvalds/linux/blob/master/Documentation/arm/mem_alignment)的问题。

可扩展性或开销是第二个非常重要的事情。如果这个结构将被多次分配，例如缓存条目或将其与文件系统内部结构等结构一起使用，那么您需要保持紧凑。

可读性也很重要，但由于这是我们正在讨论的操作系统内核，您需要提供性能和维护，因此您应该有意识地做出权衡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T23:20:07.607

位域打包顺序是实现定义的。这意味着如果你声明

```
struct my_struct {
    struct device  *dev;
    unsigned char   a:1,
                    b:1,
                    c:1,
                    d:1;
}; 
```

完全由编译器决定在哪里`a`或实际驻留在哪里。（不过，GCC 和其他一些编译器确实定义`b`或`c`取决于它们如何打包位域。）`d``__BIG_ENDIAN_BITFIELD``__LITTLE_ENDIAN_BITFIELD`

另一方面，如果你定义

```
struct my_struct {
    struct device  *dev;
    unsigned char   abcd;
};
#define MASK_A  (1U << 0U)
#define MASK_B  (1U << 1U)
#define MASK_C  (1U << 2U)
#define MASK_D  (1U << 3U)

static inline unsigned char get(const struct my_struct *const m, const unsigned char mask)
{
    return m->abcd & mask;
}

static inline unsigned char set(struct my_struct *const m, const unsigned char mask, const unsigned char value)
{
    m->abcd = (m->abcd & mask) | (mask & value);
    return m->abcd & mask;
}

static inline unsigned char flip(struct my_struct *const m, const unsigned char mask)
{
    m->abcd ^= mask;
    return m->abcd & mask;
} 
```

你知道它`a`映射到指针后面字节中的最低有效位，映射到`b`第二位、`c`第三位和`d`第四位。

如果您的 C 编译器支持`static inline`，那么这些函数与宏一样快，但不存在宏所具有的问题。副作用。

这也允许您将位域作为一个组进行操作。例如，要设置`b`结构`t`，您将使用`set(&t, MASK_B, MASK_B)`. 要设置`b`但清除`a`，您可以使用`set(&t, MASK_A | MASK_B, MASK_B)`. 要测试是否`a`已设置，请使用`get(&t, MASK_A)`. 要测试`a`or`b`是否已设置，请使用`get(&t, MASK_A | MASK_B)`. 要检查是否同时设置了`a`和`b`，请使用`(get(&t, MASK_A | MASK_B)) == (MASK_A | MASK_B))`。所有三个函数都返回生成的位掩码，并应用掩码，即所有其他位为零。

就个人而言，我更喜欢后一种方法，主要是因为我觉得它更明确（我完全可以控制），更通用（允许我不仅可以单独操作，还可以分组操作），并且更节省空间（因为编译器倾向于添加填充，除非您明确告诉他们不要通过例如命令行开关）。根据您使用标志的方式，我建议您通过宏或静态内联函数访问它们。

也就是说，如果结构是应用程序内部的，从不存储在大容量存储器中或传输，我不会对任何一种方法有任何真正的反对。

# javascript - 异步调用返回值？

> ID：13689914
> 
> 赞同：-1
> 
> 时间：2012-12-03T19:04:07.957
> 
> 标签：javascript, html

我正在构建一个显示播放按钮或停止按钮的表格。（和其他一些东西）

```
for(var i = 0; i < result.length; i++){
var current = result[i].split("$");
if (CheckRunning(current[0])){
    t = t + "<tr><td><img alt='stop' id='img"+i+"' src='stop.png' onclick='ChangeButton(\"img"+i+"\");'/>";
} else {
    t = t + "<tr><td><img alt='play' id='img"+i+"' src='play.png' onclick='ChangeButton(\"img"+i+"\");'/>";
}} 
```

这里的问题是 CheckRunning 方法。它打开一个数据库，这是一个异步方法。我不能简单地返回真/假。那么解决方案是什么？无论如何，这是它的代码：

```
 var tabel;
    var running = false;
    function CheckRunning(tabel){
    this.tabel = "tabel"+tabel+"";
    var db = window.openDatabase(this.tabel, "1.0", this.tabel, 1000000);
    db.transaction(checkrunningDB, checkerrorCB);
    console.log(this.running);
    return this.running;
    }

    function checkrunningDB(tx) {
       tx.executeSql('SELECT max(id), sluttime FROM '+this.tabel, [], checkrunningSuccess, checkerrorCB);
    }

    function checkrunningSuccess(tx, results) {
        if (results.rows.item(0).sluttime != null){
            this.running = false;
        } else{
            this.running = true;
        }
    }
    function checkerrorCB(err) {
         this.running = false;
        console.log(err);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:17:39.730

将回调函数传递给`CheckRunning`：

```
CheckRunning(current[0], function(isRunning){...})
...
function CheckRunning(tabel, callback)
{
    var isRunning = null; // we don't know yet
    ....
    callback(isRunning);
} 
```

它类似于`tx.executeSql`将 checkRunningSuccess 作为回调的函数。在这种情况下，函数名称被硬编码为 checkRunningSuccess，您可以在 checkRunning 中执行相同的操作。

* * *

顺便说一句，如果这是一个运行 SQL 查询的公共 Web 应用程序，那么您很容易受到[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。

# ios - iOS 和网络持续集成？

> ID：13689915
> 
> 赞同：0
> 
> 时间：2012-12-03T19:04:09.157
> 
> 标签：ios, macos, networking

请多多包涵——我从来没有真正使用过 Mac 超过几个小时。

如果我的网络中有一台带有 OS X 和 Xcode 设置的新 Mac，我是否可以将代码推送到它以从非 OSX 计算机构建/编译 iOS 应用程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:13:01.243

我在 Mac 上运行[Hudson 。](http://hudson-ci.org/)当我将代码推送到 github 上的存储库时，github 会通知它有关更改的信息。然后，Hudson 将提取新代码并使用 xcodebuild 命令构建它。之后应用程序被上传到[testflightapp](https://testflightapp.com/)。

当您说“向其推送代码”时，这听起来像您的意思吗？

# python - 如何获得 Python 多处理池要完成的“工作”量？

> ID：13689927
> 
> 赞同：10
> 
> 时间：2012-12-03T19:05:11.587
> 
> 标签：python, process, parallel-processing, multiprocessing, pool

到目前为止，每当我需要使用时，[`multiprocessing`](http://docs.python.org/2/library/multiprocessing.htm)我都是通过手动创建一个“进程池”并与所有子进程共享一个工作队列来完成的。

例如：

```
from multiprocessing import Process, Queue

class MyClass:

    def __init__(self, num_processes):
        self._log         = logging.getLogger()
        self.process_list = []
        self.work_queue   = Queue()
        for i in range(num_processes):
            p_name = 'CPU_%02d' % (i+1)
            self._log.info('Initializing process %s', p_name)
            p = Process(target = do_stuff,
                        args   = (self.work_queue, 'arg1'),
                        name   = p_name) 
```

通过这种方式，我可以将内容添加到队列中，这些内容将被子进程消耗。然后我可以通过检查以下内容来监控处理的进度`Queue.qsize()`：

```
 while True:
        qsize = self.work_queue.qsize()
        if qsize == 0:
            self._log.info('Processing finished')
            break
        else:
            self._log.info('%d simulations still need to be calculated', qsize) 
```

现在我认为这[`multiprocessing.Pool`](http://docs.python.org/2/library/multiprocessing.html#module-multiprocessing.pool)可以大大简化这段代码。

我找不到的是如何监控仍有待完成的“工作”量。

举个例子：

```
from multiprocessing import Pool

class MyClass:

    def __init__(self, num_processes):
        self.process_pool = Pool(num_processes)
        # ...
        result_list = []
        for i in range(1000):            
            result = self.process_pool.apply_async(do_stuff, ('arg1',))
            result_list.append(result)
        # ---> here: how do I monitor the Pool's processing progress?
        # ...? 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-14T15:21:25.320

使用`Manager`队列。这是一个在工作进程之间共享的队列。如果您使用普通队列，它将被每个工作人员腌制和取消腌制并因此被复制，因此每个工作人员都无法更新队列。

然后，您让您的工作人员将内容添加到队列中，并在工作人员工作时监控队列的状态。您需要使用它来执行此操作`map_async`，因为这可以让您看到整个结果何时准备就绪，从而使您可以中断监视循环。

例子：

```
import time
from multiprocessing import Pool, Manager

def play_function(args):
    """Mock function, that takes a single argument consisting
    of (input, queue). Alternately, you could use another function
    as a wrapper.
    """
    i, q = args
    time.sleep(0.1)  # mock work
    q.put(i)
    return i

p = Pool()
m = Manager()
q = m.Queue()

inputs = range(20)
args = [(i, q) for i in inputs]
result = p.map_async(play_function, args)

# monitor loop
while True:
    if result.ready():
        break
    else:
        size = q.qsize()
        print(size)
        time.sleep(0.1)

outputs = result.get() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-08T17:18:16.483

我为 async_call 提出了以下解决方案。

琐碎的玩具脚本示例，但我认为应该广泛应用。

基本上在无限循环中轮询列表生成器中结果对象的就绪值并求和以计算剩余多少已调度的池任务。

一旦没有剩余的休息和加入（）和关闭（）。

根据需要添加睡眠循环。

与上述解决方案的原理相同，但没有队列。如果您还跟踪最初发送池的任务数，您可以计算完成百分比等...

```
import multiprocessing
import os
import time
from random import randrange

def worker():
    print os.getpid()

    #simulate work
    time.sleep(randrange(5))

if __name__ == '__main__':

    pool = multiprocessing.Pool(processes=8)
    result_objs = []

    print "Begin dispatching work"

    task_count = 10
    for x in range(task_count):
        result_objs.append(pool.apply_async(func=worker))

    print "Done dispatching work"

    while True:
        incomplete_count = sum(1 for x in result_objs if not x.ready())

        if incomplete_count == 0:
            print "All done"
            break

        print str(incomplete_count) + " Tasks Remaining"
        print str(float(task_count - incomplete_count) / task_count * 100) + "% Complete"
        time.sleep(.25)

    pool.close()
    pool.join() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-13T12:20:54.947

我遇到了同样的问题，并为 MapResult 对象提出了一个简单的解决方案（尽管使用内部 MapResult 数据）

```
pool = Pool(POOL_SIZE)

result = pool.map_async(get_stuff, todo)
while not result.ready():
    remaining = result._number_left * result._chunksize
    sys.stderr.write('\r\033[2KRemaining: %d' % remaining)
    sys.stderr.flush()
    sleep(.1)

print >> sys.stderr, '\r\033[2KRemaining: 0' 
```

请注意，剩余值并不总是准确的，因为块大小通常根据要处理的项目数四舍五入。

您可以使用`pool.map_async(get_stuff, todo, chunksize=1)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:48:39.760

从文档中，在我看来，您想要做的是将您`result`的 s 收集到一个列表或其他序列中，然后迭代检查结果列表`ready`以构建您的输出列表。然后，您可以通过将未处于就绪状态的剩余结果对象的数量与已调度的作业总数进行比较来计算处理状态。请参阅[http://docs.python.org/2/library/multiprocessing.html#multiprocessing.pool.AsyncResult](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.pool.AsyncResult)

# javascript - Primefaces 和 RemoteCommand：处理 JavaScript 参数的最佳实践

> ID：13689930
> 
> 赞同：3
> 
> 时间：2012-12-03T19:05:25.953
> 
> 标签：javascript, jquery, jsf, jsf-2, primefaces

我已经定义了两个这样的 RemoteCommand：

```
<p:remoteCommand name="rc1" actionListener="#{rcBean.rcActionListener1}" action="#{rcBean.rcAction1}" />

<p:remoteCommand name="rc2" action="#{rcBean.rcAction2}" /> 
```

Javascript 方法使用如下参数调用 rc1 和 rc2：

```
rc1({a:'value for a', b:'value for b'});

rc2({a:'value for a', b:'value for b'}); 
```

而rcBean的rcActionListener和rcAction是：[rcBean部分代码]

```
protected String param_a, param_b;

protected void processRcParams() {
    FacesContext context = FacesContext.getCurrentInstance();
    Map map = context.getExternalContext().getRequestParameterMap();
    param_a = (String) map.get("a");
    param_b = (String) map.get("b");
}

public void rcActionListener1() {
    processRcParams();
}

public void rcAction1() {
    //-> parameters setted
    //-> process something...
}

public void rcAction2() {
    //-> parameters not set yet, and so
    processRcParams();
    //-> process something...
} 
```

判断参数不是直接在p:remoteCommand中定义的（它们是通过rc1或者rc2从JavaScript传过来的），如果可以在action中直接读取参数，那么就不需要actionListener。

最佳实践是什么：在 actionListener 上或直接在动作中读取参数？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T13:55:29.630

```
<script type="text/javascript">
            //<![CDATA[
            function test(){
                document.getElementById('hiddenurlpage').value = "test1";
                lazyload();

            }
                //]]>
        </script>
<h:inputHidden id="hiddenurlpage" value="#{userBean.currentpage}"/>
<p:remoteCommand name="lazyload"  process="@this,hiddenurlpage" /> 
```

# ios - 有没有办法在构建阶段自动将自定义值写入包的 .plist ？

> ID：13689934
> 
> 赞同：4
> 
> 时间：2012-12-03T19:05:45.237
> 
> 标签：ios, xcode, xcodebuild, agvtool

我正在使用 Jenkins 设置 CI 系统，并在构建时使用 agvtool 来调整和设置营销和技术版本。

除了在构建时设置版本控制之外，在 .plist 中设置几个自定义值会非常有用。

这可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T19:22:41.560

您可以在构建时通过利用“预操作”选项运行脚本来编辑 Info.plist。

![在此处输入图像描述](../Images/b0b2c790429df7179a864f51f547d4db.png)

这是一个示例脚本，它在 Plist 中增加一个名为 UserDefinedVersionNumber 的键

```
#!/bin/sh

#Grabs info from plist
plist=$SRCROOT"/"$INFOPLIST_FILE
currentBuild=`/usr/libexec/PlistBuddy -c "Print :UserDefinedVersionNumber" "$plist"`

#And changes it before writing out the plist again
if [ -z "$currentBuild" ]
then
    currentBuild=1
    /usr/libexec/PlistBuddy -c "Add :UserDefinedVersionNumber string $currentBuild" "$plist"

else
    currentBuild=$(($currentBuild + 1));
    /usr/libexec/PlistBuddy -c "Set :UserDefinedVersionNumber $currentBuild" "$plist"
fi 
```

您应该可以将脚本直接输入到那个小框中，但我发现编辑和维护它会变得很麻烦，尤其是对于共享脚本。

# scala - 枚举->具有“值”的密封特征？

> ID：13689936
> 
> 赞同：1
> 
> 时间：2012-12-03T19:05:54.157
> 
> 标签：scala, salat

这个问题与第一个问题有关： [Iteration over a seal trait in Scala?](https://stackoverflow.com/questions/13671734/iteration-over-a-sealed-trait-in-scala)

我有以下密封特征

```
/**
 * @author Sebastien Lorber (<i>lorber.sebastien@gmail.com</i>)
 * Date: 02/12/12 - Time: 17:49
 */
sealed trait ResizedImageKey {

  /**
   * Get the dimensions to use on the resized image associated with this key
   */
  def getDimension(originalDimension: Dimension): Dimension

}

object ResizedImageKey {
  val ALL_KEYS: List[ResizedImageKey] = List(Large,Medium,Small,X2)
}

case class Dimension(width: Int,  height: Int)

case object Large extends ResizedImageKey {
  def getDimension(originalDimension: Dimension) = Dimension(1000,1000)
}

case object Medium extends ResizedImageKey{
  def getDimension(originalDimension: Dimension) = Dimension(500,500)
}

case object Small extends ResizedImageKey{
  def getDimension(originalDimension: Dimension) = Dimension(100,100)
}

case object X2 extends ResizedImageKey{
  def getDimension(originalDimension: Dimension) = Dimension(
    width = originalDimension.width * 2,
    height = originalDimension.height * 2
  )
} 
```

这目前工作正常。问题是我需要能够使用我的 ResizedImageKey 作为映射的键，该映射将使用 Salat 存储在 MongoDB 中。

我不认为 Salat 支持“密封特征转换”，对吗？那么我应该转向枚举，这会迫使我为维度计算进行匹配/案例吗？或者这个问题有什么已知的解决方案吗？是否可以在不扩展 Enumeration 或其他东西的情况下创建枚举 Value 对象？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:46:18.443

萨拉特开发商在这里。

Salat 使用`@Salat`注释支持案例对象层次结构。（我*从不*推荐在 Scala 中使用枚举——它们太可怕了。）

现在......使用 case 对象作为地图的键实际上不是 mongo 支持的。mongo 中的所有映射键都需要是字符串。

那么你试图坚持的这张地图是什么样的呢？

# java - 尝试获取 Google API 的访问令牌时请求无效

> ID：13689941
> 
> 赞同：0
> 
> 时间：2012-12-03T19:06:09.487
> 
> 标签：java, request, google-api

我正在尝试使用 Apache Http 从 Java 桌面/独立应用程序获取访问令牌：

```
 StringBuilder sb = new StringBuilder();
    sb.append("code").append('=').append(authorization_code)
      .append('&').append("client_id").append('=').append(client_id)
      .append('&').append("client_secret").append('=').append(client_secret)
      .append('&').append("redirect_uri").append('=').append("urn:ietf:wg:oauth:2.0:oob2")
      .append('&').append("grant_type").append('=').append("authorization_code");

    HttpPost httppost
        = new HttpPost("https://accounts.google.com/o/oauth2/token");
    httppost.setEntity(new StringEntity(sb.toString()));

    System.out.println(httppost.getURI());

    System.out.println(new String(
            EntityUtils.toByteArray(httppost.getEntity())));
    httppost.getEntity().getContent();

    HttpClient httpclient = new DefaultHttpClient();
    HttpResponse resp = httpclient.execute(httppost);

    byte[] ba = EntityUtils.toByteArray(resp.getEntity());
    System.out.println(new String(ba)); 
```

请求网址为：

```
https://accounts.google.com/o/oauth2/token 
```

内容是：

```
code=4/uktjFRIoKS-VTwADJjO6vSYV3ZyU.Qop5zb7BIj0bOl05ti8ZT3bH57rDdgI
&client_id=128871852795.apps.googleusercontent.com
&client_secret=***********************
&redirect_uri=urn:ietf:wg:oauth:2.0:oob2
&grant_type=authorization_code 
```

我得到：

```
{
  "error" : "invalid_request"
} 
```

我阅读了其他类似的 SO 问题，但它并没有解决我的问题。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:56:09.280

我的错。实际上下面的代码

```
&redirect_uri=urn:ietf:wg:oauth:2.0:oob2 
```

应该

```
&redirect_uri=urn:ietf:wg:oauth:2.0:oob 
```

# asp.net - 从 htmlbutton 在转发器中提高 ItemCommand

> ID：13689943
> 
> 赞同：2
> 
> 时间：2012-12-03T19:06:15.893
> 
> 标签：asp.net, repeater, htmlbutton

我有一个 htmlbutton，我已将它标记为 runat=server，并带有一个 id 和我的中继器的 itemtemplate 中的所有爵士乐。当我单击它时，即使设置了 CommandName，它也不会引发中继器的 ItemCommand 事件。

我需要在 htmlbutton 上做一些特定的事情来实现吗？

我在项目模板中有其他服务器控件在这方面工作正常，所以这不是回发/数据绑定问题，但出于一些非常具体的原因，我需要为此控件使用 htmlbutton 语法。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:43:06.907

常规输入按钮没有[CommandEventHanlder](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.commandeventargs.aspx)。您需要 Asp.net Button、ImageButton 或 LinkBut​​ton 才能在 ItemCommand 中捕获 CommandName。

# javascript - 无法使用 javascript 访问第二个表单元素

> ID：13689947
> 
> 赞同：0
> 
> 时间：2012-12-03T19:06:21.143
> 
> 标签：javascript, forms

问题是，用户 ID 被抓取得很好，但是第二个元素“密码字段”和所有剩余的元素总是返回 null。我已经尝试了所有获取此元素值的方法，但它们总是返回一个空对象，然后当我尝试访问空值时，我的代码会抛出错误。

这是我的脚本。

```
function formValidation() {
    var uid = document.registration.userid.value;
    document.write("<h1>" + uid + "</h1>");
    try {
        var passid = document.registration.passwordfield.value;
        document.write("<h1>" + passid.value + "</h1>");
    } catch (error) {
        alert(error);
    }
    var uname = document.getElementById("username");
    document.write("<h1>" + uname + "</h1>");
    var uadd = document.getElementById("address");
    document.write("<h1>" + uadd + "</h1>");
    var ucountry = document.getElementById("country");
    document.write("<h1>" + uncountry + "</h1>");
    var uzip = document.getElementById("zip");
    document.write("<h1>" + uzip + "</h1>");
    var uemail = document.getElementById("email");
    document.write("<h1>" + uemail + "</h1>"); 

    {
        if (passid_validation(passid, 7, 12)) {
            if (allLetter(uname)) {
                if (alphanumeric(uadd)) {
                    if (countryselect(ucountry)) {
                        if (allnumeric(uzip)) {
                            if (ValidateEmail(uemail)) {
                                if (validsex(umsex, ufsex)) {}
                            }
                        }
                    }
                }
            }
        }
    }
    return false;
}

function userid_validation(uid, mx, my) {
    var uid_len = uid.value.length;
    if (uid_len == 0 || uid_len >= my || uid_len < mx) {
        alert("User Id should not be empty / length be between " + mx + " to " + my);
        uid.focus();
        return false;
    }
    return true;
}

function passid_validation(passid, mx, my) {
    var passid_len = passid.value.length;
    if (passid_len == 0 || passid_len >= my || passid_len < mx) {
        alert("Password should not be empty / length be between " + mx + " to " + my);
        passid.focus();
        return false;
    }
    return true;
}

function allLetter(uname) {
    var letters = /^[A-Za-z]+$/;
    if (uname.value.match(letters)) {
        return true;
    } else {
        alert('Username must have alphabet characters only');
        uname.focus();
        return false;
    }
}

function alphanumeric(uadd) {
    var letters = /^[0-9a-zA-Z]+$/;
    if (uadd.value.match(letters)) {
        return true;
    } else {
        alert('User address must have alphanumeric characters only');
        uadd.focus();
        return false;
    }
}

function countryselect(ucountry) {
    if (ucountry.value == "Default") {
        alert('Select your country from the list');
        ucountry.focus();
        return false;
    } else {
        return true;
    }
}

function allnumeric(uzip) {
    var numbers = /^[0-9]+$/;
    if (uzip.value.match(numbers)) {
        return true;
    } else {
        alert('ZIP code must have numeric characters only');
        uzip.focus();
        return false;
    }
}

function ValidateEmail(uemail) {
    var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
    if (uemail.value.match(mailformat)) {
        return true;
    } else {
        alert("You have entered an invalid email address!");
        uemail.focus();
        return false;
    }
}

function validsex(umsex, ufsex) {
    x = 0;
    if (umsex.checked) {
        x++;
    }
    if (ufsex.checked) {
        x++;
    }
    if (x == 0) {
        alert('Select Male/Female');
        umsex.focus();
        return false;
    } else {
        alert('Form Successfully Submitted');
        window.location.reload()
        return true;
    }
} 
```

这是我的html。

```
<!DOCTYPE html>
<html>
<head>

<title>form</title>

<script src="hai.js" type="text/javascript" ></script>
</head>

<body>
<h1>Registration Form</h1>
<p>Use tab keys to move from one input field to the next.</p>
<form name="registration" onSubmit="return formValidation();" action="hai.js"  METHOD="POST">
    User id:
    <input type="text" name="userid" size="12" /><br>
    Password:
    <input type="password" name="passwordfield" size="12" /><br>
    Name:
    <input type="text" name="username" size="50" /><br>
    Address:
    <input type="text" name="address" size="50" /><br>
    Country:
    <select name="country">
    <option selected="" value="Default">(Please select a country)</option>
    <option value="AF">Australia</option>
    <option value="AL">Canada</option>
    <option value="DZ">India</option>
    <option value="AS">Russia</option>
    <option value="AD">USA</option>
    </select><br>
    ZIP
    <input type="text" name="zip" /><br>
    Email:
    <input type="text" name="email" size="50" /><br>
    Sex:
    <input type="radio" name="sex" value="Male" /><span>Male</span><br>
    <input type="radio" name="sex" value="Female" /><span>Female</span><br>
    Language
    <input type="checkbox" name="en" value="en" checked /><span>English</span><br>
    <input type="checkbox" name="nonen" value="noen" /><span>Non English</span><br>
    About:<br>
    <textarea name="desc" id="desc"></textarea><br>
    <input type="submit" name="submit" value="Submit" />
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:27:43.013

问题可能出在 document.write 上，好像它在页面加载后运行它会覆盖您的页面，然后您当然不能再访问这些元素了。

另外，为什么你使用 document.registration.userid 而不是 document.registration.username？根据您的浏览器，getElementById 可能不适用于名称属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:37:20.433

问题是密码字段之前的 document.write() .. 出于某种原因调用它会从文档中删除注册变量...我不太清楚为什么...

但我尝试删除它“document.write”并以推荐的方式添加节点：

```
var myElement = document.createElement("h1");
myElement.appendChild(document.createTextNode("My Text here"));
document.appendChild(myElement); 
```

它工作得很好......你应该阅读这个：[http](http://ejohn.org/blog/dom-documentfragments/) ://ejohn.org/blog/dom-documentfragments/ 我认为它可能会对你有所帮助:)

# facebook-graph-api - 在嵌套图调用中检索地点类别的问题

> ID：13689950
> 
> 赞同：1
> 
> 时间：2012-12-03T19:06:33.307
> 
> 标签：facebook-graph-api, nested

我正在尝试进行嵌套图形调用，它将返回签到和位置的位置类别。

为了将我的问题归结为查询中不起作用的部分，我将使用端点`GET /me?fields=locations.fields(place.fields(name,location,category),id)`。

如果我使用图形浏览器 API 令牌运行此端点，我将收到正确的结果。但是，如果我使用我的实际应用程序的令牌，我会得到

```
{
    "error": {
        "message": "(#100) Unknown fields: category.", 
        "type": "OAuthException", 
        "code": 100
     }
} 
```

place.category 字段也适用于使用任一 API 令牌签入。

我试图通过执行批处理查询并使用`GET ?ids={result=user-info:$.locations.data.*.place.id}&fields=(name,location)`第二个查询来解决这个问题，但我收到了同样的错误。

这是一个需要在 Facebook 端解决的问题，还是有另一种方法可以执行此查询而无需执行额外的请求？

谢谢！

# prolog - 所有正除数的总和

> ID：13689956
> 
> 赞同：2
> 
> 时间：2012-12-03T19:06:57.603
> 
> 标签：prolog

一个查询`sum(X,Y)`将回答 X 的所有正除数的总和（不包括 X 本身）说，`sum(12,Y)`将回答`Y=16`因为 1、2、3、4、6 是 12 的除数。

我打算实现以下 prolog 程序，但它失败了，说一些变量没有实例化。

```
sum(X,Y) :- f(X,Y,1).
f(X,Y,F) :- X>Y,X>F, 0 is X mod F, F1 is F+1, f(X,Y1,F1), Y is F+Y1.
f(X,Y,F) :- X>Y,X>F, not(0 is X mod F), F1 is F+1, f(X,Y,F1). 
```

上述程序有什么问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:31:41.747

我不会向您展示如何编写 sum_of_divisors 函数，因为它不会很有启发性。相反，我可以尝试向您展示如何理解您的`sum(12,Y)`查询出了什么问题。

让我们看看错误：

```
?- sum(12, Y).
ERROR: >/2: Arguments are not sufficiently instantiated
   Exception: (8) f(12, _G215, 1) ? a
% Execution Aborted 
```

查询后

```
?- sum(12, Y). 
```

Prolog 引擎读取`sum(X,Y) :- f(X,Y,1).`并评估第二个谓词：

```
f(X,Y,F) 
```

其中`X = 12`,`F = 1`且`Y`不受约束。所以它尝试这个：

```
:- X>Y 
```

这是

```
12 > _G350 
```

其中`_G350`是`Y`，一个未实例化的变量。

问题是算术谓词 like `(>)/2`(and like `(+)/2`and `(*)/2`, etc..) 要求**您要比较的两个变量都是实例化的**。你不能这样查询：

```
?- 12 > X 
```

并期望 Prolog 引擎找到所有小于 12 的绑定。因此，您需要重新考虑解决问题的方法，并记住您只能使用 NUMBERS 进行算术运算，而不能使用数字和变量`X`。`X`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T22:12:36.563

对于完整的声明性算术，您可以按照已经建议的方式使用 CLP(FD)。例如，在 SWI-Prolog 中，当我简单地将 (is)/2 替换为 (#=)/2 等以概括原始算术运算以便它们也可以与两侧的变量一起使用时，我得到：

```
:- use_module(library(clpfd)).

sum(X,Y) :- f(X,Y,1).

f(X,Y,F) :- X#>Y,X#>F, 0 #= X mod F, F1 #= F+1, f(X,Y1,F1), Y #= F+Y1.
f(X,Y,F) :- X#>Y,X#>F, 0 #\= X mod F, F1 #= F+1, f(X,Y,F1). 
```

现在您的示例查询产生：

```
?- sum(12, Y).
false. 
```

所以很明显程序太具体了，检查一下你是否忘记描述一个重要的案例。

# python - 使用一个开源项目的源码学习

> ID：13689961
> 
> 赞同：-2
> 
> 时间：2012-12-03T19:07:24.537
> 
> 标签：python, open-source, projects

我在 python 中有一个开源项目的源代码，该项目有一个模块（python）和 gui，使用该模块 gui 是用 qtpython 编写的，现在在使用 gui 并在其中执行各种操作时，我有什么办法可以知道被调用的函数是什么以及从哪里调用日志之类的东西，有什么方法可以生成源代码的 uml 图，以便我可以更好地理解它并为项目做出贡献。项目使用的 python 版本是 2.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:30:34.717

正如评论中提到的，从 Python 生成 UML 已经在[这个答案](https://stackoverflow.com/questions/260165/whats-the-best-way-to-generate-a-uml-diagram-from-python-source-code)中讨论过。（请记住，Python 实际上不必是 UML 可表示的，但如果是，那就太好了。）

至于在运行时查看控制流，有几种方法可以做到这一点。一种是使用分析和/或调试工具。但是让我们看一下最简单的记录方法，这就是您所要求的：

您可以随时通过`print`ing 到控制台“记录”任何内容。您将不得不从命令行运行该应用程序，而不是以 GUI 样式启动它（在 Mac 上，这意味着您必须直接运行可执行文件/脚本，而不是任何`.app`由它构建的包），然后您'已经得到了你的日志输出——`cmd`如果你愿意的话，你可以使用你的 shell（甚至是 Windows ）将它重定向到一个文件以供以后浏览。如果这对您来说还不够好，请参阅[`logging`](http://docs.python.org/library/logging.html)标准库中内置的模块。

如果您想知道从哪里调用函数，可以在每次调用函数时记录堆栈跟踪。这有点难看，但它提供了您可能想要的所有信息，并且您总是可以编写一些代码来稍后解析输出。函数[traceback.print_stack](http://docs.python.org/library/traceback.html#traceback.print_stack)正是这样做的。（如果您想更花哨，请使用其他功能来提取信息，根据需要格式化，并根据需要记录。）

为此，您可以将此行添加到要跟踪的每个函数中：

```
traceback.print_stack() 
```

另一种方法是编写一个猴子修补程序并将其应用于您关心的所有功能：

```
def tracify(func):
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        traceback.print_stack()
        func(*args, **kwargs)
    return wrapper 
```

现在，在主脚本中，只需执行以下操作：

```
InterestingClass.interestingMethod = tracify(InterestingClass.interestingMethod) 
```

现在，每次调用 InterestingClass.interestingMethod 时，它都会打印出一个堆栈跟踪。您不必了解其`tracify`工作原理。如果你想改变它对函数的作用，只需用`traceback.print_stack()`你想做的任何东西替换该行。

那么，如果你想修补类中的每个“公共”方法怎么办？

```
for attr in dir(InterestingClass):
    if not attr.startswith('_'):
        method = getattr(InterestingClass, attr)
        if isinstance(method, instancemethod):
            setattr(InterestingClass, tracify(method)) 
```

（这是针对 Python 2 的。Python 3 改变了事情，使复杂的情况变得更加简单，但琐碎的情况却没有那么琐碎。）

如果您想修补模块中每个类的每个公共方法和每个自由函数怎么办？您可以以相同的方式迭代模块，并检查每个事物的类型，就像您可以使用类一样。

你也可以使用[检查](http://docs.python.org/library/inspect.html)模块为你做一些困难的事情。但如果你只是学习 Python，我认为复制和粘贴`dir`代码比学习如何使用`inspect`. 一旦你对这种语言更加熟悉了，就回来`inspect`尝试一下，找出它为什么会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:38:59.977

我不使用 Python，但是当您想实时跟踪程序正在做什么时，您可以使用调试器，并且对 Python 调试器进行一些谷歌搜索可能会给您一些有希望的结果。

# favicon - 令人沮丧的网站图标问题

> ID：13689964
> 
> 赞同：2
> 
> 时间：2012-12-03T19:07:33.840
> 
> 标签：favicon

我有一个非常令人沮丧的问题，因为我找不到任何解决方案。所以大约两周前，我将一个网站图标上传到我的网站，现在我决定要更改它。所以，是的，我上传了新的来替换旧的，但即使在一遍又一遍地这样做十次并尝试在不同的计算机上，并尝试创建一个新的 favicon，并且 100% 确定问题不存在之后我使用了各种自动化程序，但我的网站图标仍然没有更新。知道问题可能是什么吗？这对我来说太基本了，不能成为问题，但我真的看不出问题是什么。至少这不是什么大问题，因为我可以在没有 favicon 的情况下生活，但是当这个基本的东西不起作用时，当然会令人沮丧。顺便说一句，网站是[http://www.minepick.com](http://www.minepick.com)

我在`head`元素中有这个标记：

```
<link rel="shortcut icon" href="/favicon.ico" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:19:22.680

尝试确保清除正在查看该站点的任何 PC 的浏览器上的缓存。

确保没有可能更新速度不快的 CDN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:17:36.017

用这个替换旧行：

```
<link rel="shortcut icon" href="http://{your-site}/favicon.ico?ver=2" /> 
```

我希望它有所帮助。

# jquery - jquery：如何从滚动位置打开 div

> ID：13689965
> 
> 赞同：0
> 
> 时间：2012-12-03T19:07:37.947
> 
> 标签：jquery, html, css

我正在处理一个用浮动按钮打开的菜单。我想从我所在的位置打开菜单，这样我就可以看到菜单了。问题是我不能使用css `position: fixed;`，因为菜单很大并且需要滚动页面。

```
 $("#exp_menu").click(function() {
        $("#left_block").show();
        $("#exp_menu_close").show();
        $("#exp_menu").hide();
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:20:18.663

我假设该`#exp_menu`元素是您所指的“菜单”。

您可以在单击事件处理程序中获取当前滚动位置，并`#left_block`根据需要更新元素的位置。如果要将`#left_block`元素停靠在视口的顶部，可以使用：

```
$("#exp_menu").click(function() {
    $("#left_block").css({
        top : $(window).scrollTop()
    }).show();
    $("#exp_menu_close").show();
    $("#exp_menu").hide();
}); 
```

这个解决方案要求`#left_block`元素是绝对定位的，并且它的偏移父元素是`body`元素。

`$(window).scrollTop()`返回当前窗口的滚动位置：http: [//api.jquery.com/scrolltop/](http://api.jquery.com/scrolltop/)

# c# - c# 具有相同数据但类型不同的变量的命名约定

> ID：13689966
> 
> 赞同：13
> 
> 时间：2012-12-03T19:07:41.513
> 
> 标签：c#, types, casting, coding-style, naming-conventions

我查阅了一些 msdn 文章，这些文章涉及 c# 编码约定和命名指南（[C# Coding Conventions](http://msdn.microsoft.com/en-us/library/vstudio/ff926074.aspx) and [Naming Guidelines](http://msdn.microsoft.com/en-us/library/xzf533w0%28v=vs.71%29.aspx)）以及几个月前关于堆栈溢出的[类似问题。](https://stackoverflow.com/q/11659036/573083)

我不确定如何处理同时在范围内的两个变量，它们以不同类型保存 [概念上] 相同的数据。

一个有助于说明问题的示例是最初作为字符串保存的标识符，但随后被强制转换/解析为整数。

我提出了 3 种可能的行动方案，而且我确信我错过了合理的选择。

**COA #1：**

```
int iRecordId;
string sRecordId; 
```

其中一个或两个变量作为类型缩写的前缀。这违反了 MS 编码准则，即不使用匈牙利类型符号作为参数名称的前缀。

**COA #2：**

```
int recordId;
string recordIdString; 
```

其中一个或两个变量明确说明名称中的类型。这看起来很笨拙，虽然它没有使用匈牙利符号，但它似乎违反了之前 COA 的精神。

**认证证书 #3：**

```
int recordIdForDatabase;
string recordIdFromUrl; 
```

每个变量的位置由数据的来源或去向进一步限定。

**提议**

我的想法是我最终想区分两个仅在类型上有所不同的变量，因此虽然有明确规定不要使用类型信息为变量添加前缀的指南，但我倾向于使用匈牙利语前缀。由于它与代码其余部分中的命名约定形成鲜明对比，因此它似乎会突出显示情有可原的情况。这是一个合理的方法吗？

欢迎提出问题、评论和愤怒的呼喊。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T19:12:11.040

第一个选项已过时，因为我们不再使用 Hunharian Notation。

第二种选择还不错，我看到它在不同的项目中使用。

但从我的角度来看，最后一个选项更可取，因为它显示了两个变量之间的语义差异，而不是类型的差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T19:22:41.767

为什么要存储两次数据？你能把记录id变成一个int，然后在你想转换它的时候调用ToString()吗？

通过只存储一次数据，您就不会那么容易受到代码错误的影响。

如果每个变量都存储不同的值，则按逻辑命名它们。例如，

```
int socialSecurityID;
string driversLicenceID; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:35:10.303

完全没问题。在私有范围内有这样的东西：

```
int recordId;
string recordIdString; 
```

但如果这些 id 是接口的一部分，请考虑不同的类设计。在大多数情况下，将 url id 移动到表示 Url 的类会导致更好的架构。

# mysql - mysql存储过程跳过空参数

> ID：13689968
> 
> 赞同：1
> 
> 时间：2012-12-03T19:07:43.890
> 
> 标签：mysql, stored-procedures, parameters, null, where

我想我在这里阅读了所有文章，但仍然无法让我的代码 100% 工作。我是一个 PHP 表单，用户可以根据 4 个位置中的任何一个进行搜索，也可以完全跳过它，在这种情况下应该跳过“where location”子句并移至下一个参数组。我的 mysql 存储过程如下所示：

```
CREATE PROCEDURE search( 
  IN inRoomsPerPage INT,
  IN inStartItem INT,
  IN inAddDate INT,
  IN inLocation1 ENUM('T','F'),
  IN inLocation2 ENUM('T','F'),
  IN inLocation3 ENUM('T','F'),
  IN inLocation4 ENUM('T','F')
)
BEGIN
SELECT * 
 FROM useradds as ua
 INNER JOIN household as hh on hh.idx_user_id = ua.idx_user_id
 INNER JOIN house as h on h.idx_user_id = ua.idx_user_id
 WHERE adddate >= (CURDATE() - INTERVAL inAddDate DAY) AND
 ((inLocation1 IS NULL OR downtown = inLocation1) OR 
 (inLocation2 IS NULL OR hwy = inLocation2) OR
 (inLocation3 IS NULL OR dewey = inLocation3) OR
 (inLocation4 IS NULL OR lewes = inLocation4))
 ORDER BY ua.adddate DESC
 LIMIT inStartItem, inRoomsPerPage;
 END$$ 
```

每当我选择任何一个或多个位置时，这都可以正常工作，但如果我尝试跳过它则不起作用（它应该只选择最后一个 inAddDate 中的所有内容）。如果我更换

```
(inLocation1 IS NULL OR downtown = inLocation1) 
```

和

```
downtown = COALESCE(NULLIF(inLocation1, ''), downtown)) 
```

然后如果我绕过该位置，它会选择所有内容，但如果我想搜索任何 2 个或更多位置，它不会返回任何内容。我相信一定有很好的方法来克服这个问题，因为我有更多的参数组要添加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T21:51:16.363

My php/html part looks like this:

```
<form action='' method='post'  >
    <select name='ckadddate'>
        <option value='1'>last 24 hours</option>
        <option value='3' selected>last 3 days</option>
        <option value='7'>last week</option></select>
in:<input type='checkbox' name='Downtown' >Downtown
     <input type='checkbox' name='Hwy' >HWY 1
      <input type='checkbox' name='Dewey'>Dewey
      <input type='checkbox' name='Lewes'>Lewes
<input name='SubmitSearch' type='submit' value='Search'> 
```

The part of the php function that is calling the stored procedure is:

```
if(isset($_POST['SubmitSearch'])){
    $cklocation1 = $cklocation2= $cklocation3= $cklocation4= '';
    if(isset($_POST['Downtown']))$cklocation1 = 'T';
       if(isset($_POST['Hwy']))$cklocation2 = 'T';
       if(isset($_POST['Dewey']))$cklocation3 = 'T';
       if(isset($_POST['Lewes']))$cklocation4 = 'T';
    **if(!isset($_POST['Downtown']) && !isset($_POST['Hwy']) && !isset($_POST['Dewey']) && !isset($_POST['Lewes'])){
        $cklocation1 = $cklocation2= $cklocation3= $cklocation4= 'T';
    }**
$sql = 'CALL search_room(:RoomsPerPage, :StartItem,:Adddate,
:Location1,:Location2,:Location3,:Location4)';
$params = array (':RoomsPerPage' => ADDS_PER_PAGE, ':StartItem' => $start_item, 
':Adddate' => $_POST['ckadddate'],':Location1' => $cklocation1, 
':Location2' => $cklocation2, ':Location3' => $cklocation3, ':Location4' => $cklocation4
    ); 
```

This seams to work just fine but I am pretty sure it should be a more elegant solution out there.

# android - Android webview导致点击监听器不触发

> ID：13689970
> 
> 赞同：3
> 
> 时间：2012-12-03T19:07:55.877
> 
> 标签：android, android-webview, listener

我有一个包含文章列表的 ListView。每 X 篇文章（目前 10 篇），我都有一个显示广告的 WebView。我可以单击任何列表项，除了显示 WebView 的项正上方的项。那个不会注册我的点击。

**显示或隐藏 WebView 的代码：**

```
if(position % 10 == 0) // || position == 0) && position > 0
{
    viewHolder.adView.loadUrl(tmpAdURL);
    viewHolder.adView.setVisibility(View.VISIBLE);
}
else
{
    viewHolder.adView.setVisibility(View.GONE);
    viewHolder.adView.invalidate();
} 
```

**主要的.xml**

```
<ListView android:id="@+id/articles_list"
    style="@style/ListView"
    android:fadingEdge="vertical"
    android:fadingEdgeLength="16dp"
    android:divider="@color/extreme_light_gray"
    android:dividerHeight="1dp" /> 
```

**MainActivty.java 的 onCreate() 中的监听器：**

```
articleEntryListView.setOnItemClickListener(new OnItemClickListener()
{
    public void onItemClick(AdapterView<?> parent, View v, int position, long id)
    {
        Log.d("MINE", "ARTICLE CLICKED");
    }
} 
```

**article_entry_list_item.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:minHeight="60dp" >

    <!-- Title of the news entry -->

    <ImageView
        android:id="@+id/article_thumbnail"
        android:layout_width="90dp"
        android:layout_height="80dp"
        android:layout_alignParentRight="true"
        android:adjustViewBounds="true"
        android:contentDescription="@string/articleThumbnail"
        android:cropToPadding="true"
        android:paddingRight="10dp"
        android:paddingBottom="10dp"
        android:paddingTop="10dp"
        android:paddingLeft="0.5dp"
        android:scaleType="centerCrop" />
        <!-- WAS: android:padding="0.5dp" -->

    <LinearLayout
        android:id="@+id/article_row"
        android:layout_width="match_parent"
        android:layout_height="80dp"
        android:layout_marginRight="5dp"
        android:layout_toLeftOf="@id/article_thumbnail"
        android:minHeight="80dp"
        android:orientation="vertical"
        android:padding="10dp" >

        <TextView
            android:id="@+id/article_title"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/articleTitle"
            android:textColor="@drawable/list_title_selector"
            android:textSize="14sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/article_subtitle"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/articleSubtitle"
            android:textColor="@drawable/list_subtitle_selector"
            android:textSize="10sp" />
    </LinearLayout>

    <WebView
        android:id="@+id/article_ad"
        android:layout_width="match_parent"
        android:layout_height="90dp"
        android:background="@color/meddark_gray"
        android:layout_below="@+id/article_thumbnail"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp"
        android:padding="10dp" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:23:14.743

您正在使用单行布局浪费资源。想一想：您在所有行中创建了一个 WebView，但您在 90% 的时间里立即隐藏它们（超过）......相反，您应该通过覆盖这些方法来使用具有两个行布局的自定义适配器：

```
@Override
public int getItemViewType(int position) {
    return position % 11 == 0 ? 1 :  0;
}

@Override
public int getViewTypeCount() {
    return 2;
} 
```

接下来在里面`getView()`或`newView()`检查您应该加载哪种类型的布局。返回 0时膨胀新闻项目布局，`getItemViewType()`并在返回 1 时膨胀 WebView（自身）。

除了更快和更有条理之外，您的 WebView 现在有自己的行，应该可以玩得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:13:04.003

这可能类似于我`CheckBox`在列表项中遇到的问题。尝试使用列表项 XML 中的`android:focusable="false"`选项。`WebView`

在我的情况下，`CheckBox`它从列表项中获取焦点，并且由于某种原因阻止了事件触发。

[http://developer.android.com/reference/android/view/View.html#attr_android:focusable](http://developer.android.com/reference/android/view/View.html#attr_android:focusable)

```
<WebView
    android:id="@+id/article_ad"
    android:layout_width="match_parent"
    android:layout_height="90dp"
    android:background="@color/meddark_gray"
    android:layout_below="@+id/article_thumbnail"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="10dp"
    android:padding="10dp"
    android:focusable="false" /> 
```

您也可以在后面的代码中执行此操作

```
setFocusable(false); 
```

# django - request.user 和 request.user.username 有什么区别？

> ID：13689971
> 
> 赞同：1
> 
> 时间：2012-12-03T19:07:57.970
> 
> 标签：django

正如标题所说，request.user 和 request.user.username 有什么区别？我使用它们将它们与一些变量进行比较，有时它使用第一个，有时使用第二个

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:15:02.927

`request.user`是`User`实例，`request.user.username`是该用户的字符串`username`。

如果您有一个字符串，例如`'admin'`，那么您可能希望将其与`request.user.username`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T20:44:46.650

我认为只有在您在模板中使用用户对象之后才会出现问题`{{user}}`，`{{user.username}}`并且了解模板呈现相同的内容。

关键是，当您渲染模板时，django 会自动将变量转换为其 unicode 表示（字符串），并且在您的视图函数中，它可以不是字符串，而是某个模型的实例。

来自应用程序 django.contrib.auth 的用户类具有 unicode 表示，例如

```
def __unicode__(self):
    return self.username 
```

也许这就是您感到困惑的原因，`user`并且`user.username`.

这种误解可能很危险，因为当您输入类似

```
if user1 == user2.username: 
```

你不会得到`TypeError`，因为从 models.Model 继承的任何 django 模型都有一个运算符

```
def __eq__(self, other):
    return isinstance(other, self.__class__) and self._get_pk_val() == other._get_pk_val() 
```

查找 user1 和 user2.username 是否具有相同的类。

无论如何，我认为经过一些练习后，您会发现字符串和某些模型的对象之间的区别。

* * *

# java - 不能从另一个中减去一个双倍？

> ID：13689975
> 
> 赞同：3
> 
> 时间：2012-12-03T19:08:05.480
> 
> 标签：java, string, double

总的来说，我对 Java 和编程很陌生，但我已经阅读了很多。我目前正在制作我的第一个真正的 OOP——一个可以执行某些方程的计算器。但是，在尝试编写可以计算分布方差的程序时，代码如下：

```
void variance() {
  System.out.println("The variance of a distribution with x values of " + a + b + "and mean" 
                + mean + "is " + a*a+b*b/2 - mean*mean); 
} 
```

我得到错误

> 二元运算符'-'的错误操作数类型第一种类型=字符串第二种类型=双”。

我之前说过 a、b 和平均值是双倍的，并且还说明了平均值是如何计算的。我也尝试`a*a+b*b/2`从字符串更改为双精度数，但后来意识到如果我将任何整数或双精度数放入 where `a*a+b*b/2`（例如 2），但我会得到相同的错误。任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T19:12:41.097

那是因为`+`在Java中重载了字符串连接。您需要在数学表达式周围加上括号。

```
System.out.println("The variance of a distribution with x values of " + a + b + "and mean" 
 + mean + "is " + (a*a+b*b/2 - mean*mean)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T19:12:31.400

简短的回答是你需要这样做：

```
 + mean + "is " + (a*a+b*b/2 - mean*mean)); 
```

更长的答案是Java从左到右评估您的表达式。所以一步一步，它会发生这样的事情：

1.  均值 + "是" + a*a+b*b/2 - 均值*均值
2.  *字符串*+ "是 " + a*a+b*b/2 - 平均*平均
3.  *字符串*+ a*a+b*b/2 - 平均值*平均值
4.  *字符串*- 均值*均值

编译器在此处停止，因为尽管您可以使用（在步骤 3 中）*连接*字符串和数字，但从字符串中*减去*`+`数字是没有意义的。通过在整个算术表达式周围使用括号，这将导致首先计算算术，然后将结果与输出字符串的其余部分连接起来。

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T19:12:01.410

将所有数学表达式括在括号之间，并且（取决于 , , 的实际类型`a`）`b`，`mean`最好除以`2.0`，以确保执行浮点除法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:13:49.867

您正在将`String` `+`运算符与`Double`运算符混合在一起。

尝试这个：

```
System.out.println( "The variance of a distribution with x values of " 
    + ( a + b ) + " and mean " 
    + mean + " is " 
    + ( ( a * a + b * b / 2 ) - ( mean * mean )) ); 
```*

# c++ - 错误后如何停止循环

> ID：13689976
> 
> 赞同：0
> 
> 时间：2012-12-03T19:08:07.397
> 
> 标签：c++

我只想在那个循环中做一件事...... - IF 或 ELSE .. （当你知道它的真假时..）如果我有两个输入学生的信息和我的第一个学生第 1 组成绩不优秀，第二个学生成绩优秀 我的程序打印：1）第一个循环 for:it;s false 所以它使 else 2）第二个循环 for：它是 true 所以它使如果

我有： 没有信息 成绩优异的学生...

我只想看到成绩优异的学生（如果我使用 BREAK；我将停止 FOR 循环）这是我的代码：

```
int gr;
cout<<"Enter group that you want to check: ";cin>>gr;
cout<<"Students with excellent grade in group "<<gr<<":\n";
    for(i=0;i<n;i++)
        {
            if(m[i][2]==gr && m[i][3]>=5.500)
            {
                for(j=0;j<4;j++)
                    cout<<setprecision(8)<<m[i][j]<<"\t";
            }
            else
                    cout<<"No students with excellent grade in this group"<<endl;

        } 
```

我在这里有同样的问题。我可以使用“bool”类型以及如何在该代码中使用（代码基于结构）：

```
int x;
bool no_info=false;
p: cout<<"| What personal id you want to search for: ";cin>>x;

for(int i=0;i<n;i++)
{
  if(pov[i].id==x)
  {
    no_info=true;
    cout<<pov[i].id<<endl;
    cout<<pov[i].name<<endl;
    cout<<pov[i].lastname<<endl;
    cout<<pov[i].department<<endl;
    cout<<pov[i].salary<<endl;
  }
}
  if(no_info){
   cout<<"No information"<<endl;}
 goto p; 
```

**已编辑！！！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:11:25.073

很难理解你想要达到的目标。但我认为你想要的是：

```
int gr;
bool no_excellents = true;
cout<<"Enter group that you want to check: ";cin>>gr;
cout<<"Students with excellent grade in group "<<gr<<":\n";
for(i=0;i<n;i++)
{
    if(m[i][2]==gr && m[i][3]>=5.500)
    {
       no_excellents = false;
       for(j=0;j<4;j++)
           cout<<setprecision(8)<<m[i][j]<<"\t";
    }
}

if(no_excellents)
{
    cout<<"No students with excellent grade in this group"<<endl;
} 
```

这不会停止您的`for`循环，只会打印那些成绩优异的学生。如果没有人有优秀的成绩，程序会告诉你。

# mysql - MySQL 查询日期

> ID：13689978
> 
> 赞同：1
> 
> 时间：2012-12-03T19:08:21.370
> 
> 标签：mysql

> **可能重复：**
> [Mysql 查询：检索当前日期查询](https://stackoverflow.com/questions/1086297/mysql-query-retrieve-current-date-query)

我需要一个 MySQL 查询来选择一些包含今天日期的数据。我已经构建了以下查询：

```
SELECT CRM_TRATATIVAS.ID_Vendedor, CRM_TRATATIVAS.Fecha
FROM CRM_TRATATIVAS
GROUP BY CRM_TRATATIVAS.ID_Vendedor, CRM_TRATATIVAS.Fecha, CRM_TRATATIVAS.ID_Categoria
HAVING (((CRM_TRATATIVAS.ID_Vendedor)=10 Or (CRM_TRATATIVAS.ID_Vendedor)=29 Or (CRM_TRATATIVAS.ID_Vendedor)=32) AND ((CRM_TRATATIVAS.Fecha)=Date()) AND ((CRM_TRATATIVAS.ID_Categoria)=14)); 
```

如果我把 =Date() 拿走，它就可以工作。任何想法可能是什么问题？

最终的数据显示是这样的，没有括号和点（我找不到如何制作表格！

```
 Fecha                      Vendedor
 2012-12-03 10:12:13        (10)
 2012-12-03 12:14:16        (10)
 2012-12-03 09:15:46        (29)
 2012-12-03 13:35:56        (32) 
```

* * *

固定的！

我通过使用此查询进行了修复。

```
SELECT CRM_TRATATIVAS.ID_Vendedor, CRM_TRATATIVAS.Fecha
FROM CRM_TRATATIVASGROUP BY CRM_TRATATIVAS.ID_Vendedor, CRM_TRATATIVAS.Fecha, CRM_TRATATIVAS.ID_Categoria
HAVING (((CRM_TRATATIVAS.ID_Vendedor)=10 Or (CRM_TRATATIVAS.ID_Vendedor)=29 Or (CRM_TRATATIVAS.ID_Vendedor)=32) AND ((DATE(CRM_TRATATIVAS.Fecha)) = CURDATE()) AND ((CRM_TRATATIVAS.ID_Categoria)=14)); 
```

由于 Fecha 是一`DATETIME`列，我在引用之前添加了 Date 以将其转换为日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:13:52.587

我想你可能想要以下内容：

```
SELECT c.ID_Vendedor, c.Fecha
FROM CRM_TRATATIVAS c
WHERE c.ID_Vendedor IN (10, 29, 32) 
    AND c.Fecha = Curdate()
    AND c.ID_Categoria=14
-- GROUP BY c.ID_Vendedor, c.Fecha, c.ID_Categoria; 
```

*注意：我将其更新为使用 a`WHERE`而不是`HAVING`子句。该`HAVING`子句用于需要过滤的聚合函数。另外，我不确定您为什么使用列表`GROUP BY`中没有聚合函数的子句`SELECT`*

如果您的日期`Fecha`有日期和时间，并且您只想匹配日期部分，那么您可能需要使用：

```
SELECT c.ID_Vendedor, c.Fecha
FROM CRM_TRATATIVAS c
WHERE c.ID_Vendedor IN (10, 29, 32) 
    AND Date(c.Fecha) = Curdate()
    AND c.ID_Categoria=14
-- GROUP BY c.ID_Vendedor, c.Fecha, c.ID_Categoria; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:54:36.183

尝试改变：

```
CRM_TRATATIVAS.Fecha=Date() 
```

有了这个：

```
DATE(CRM_TRATATIVAS.Fecha)=CURDATE() 
```

`CURDATE()`返回当前日期，并`DATE(Fecha)`仅返回日期部分`Fecha`（不包括小时、分钟和秒）。我还建议您以这种方式编写查询，这样看起来更简洁：

```
SELECT Distinct
  CRM_TRATATIVAS.ID_Categoria,
  CRM_TRATATIVAS.ID_Vendedor,
  CRM_TRATATIVAS.Fecha
FROM
  CRM_TRATATIVAS
WHERE
  CRM_TRATATIVAS.ID_Vendedor in (10, 29, 32)
  AND DATE(CRM_TRATATIVAS.Fecha) = CURDATE()
  AND CRM_TRATATIVAS.ID_Categoria=14 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:13:19.123

尝试改变

```
((CRM_TRATATIVAS.Fecha)=Date()) 
```

至

```
((CRM_TRATATIVAS.Fecha)=Date(NOW())) 
```

MySQL[`DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date)函数需要一个参数，它本身不返回当前日期。您也可以只使用该[`CURDATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_curdate)功能而不是`DATE(NOW())`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T19:16:43.420

查询中是否缺少任何内容？如果您不需要某种形式的聚合函数，我可能不会使用 GROUP BY/HAVING 子句。

查询如何，例如：

```
SELECT CRM_TRATATIVAS.ID_Vendedor, CRM_TRATATIVAS.Fecha
FROM CRM_TRATATIVAS
WHERE (((CRM_TRATATIVAS.ID_Vendedor)=10 Or (CRM_TRATATIVAS.ID_Vendedor)=29 Or
 (CRM_TRATATIVAS.ID_Vendedor)=32) AND ((CRM_TRATATIVAS.Fecha)=Date()) AND 
 ((CRM_TRATATIVAS.ID_Categoria)=14)); 
```

# javascript - jquery click() 函数返回两个变量？

> ID：13689984
> 
> 赞同：0
> 
> 时间：2012-12-03T19:08:52.437
> 
> 标签：javascript, jquery, variables, return

我是 jquery 和 javascript 的新手，我想要一个

```
 .click(function(e){
  /* some code and creating two vars with the position of the clicked place*/}) 
```

我想返回这两个变量，但我不知道如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:12:32.393

jQuery`.click`函数返回一个 jQuery 对象。所以你不能从函数内部返回。因此，您只需要在 click 函数之外创建一个 var 并将其设置在函数内部，如下所示，

```
var elPos = {};
$(element).click (function () {
  /* some code and creating two vars with the position of the clicked place*/
  elPos.x = xpos;
  elPos.y = ypos
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T19:17:56.950

函数返回一个值。这就是它的工作原理。但是你有选择。

您可以返回一个数组：

```
function foobar () {
    var x = "foo";
    var y = "bar";
    return [x, y];
} 
```

您还可以返回一个对象：

```
function foobar () {
    var x = "foo";
    var y = "bar";
    return {x: x, y: y};
} 
```

您还可以满足于在全局范围内拥有一对变量：

```
var x, y;
function foobar () {
    x = "foo";
    y = "bar";
} 
```

或传入对象/数组：

```
function foobar (obj) {
    obj.x = "foo";
    obj.y = "bar";
} 
```

顺便说一句，这些都不是 jQuery 特有的；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:13:49.630

```
 .click(function(e) {
   var x = e.pageX;
   var y = e.pageY;
   return [x, y];  

}); 
```

如果有像 img 这样的元素，那么你可以试试这个......

```
 var x = e.pageX - $(this).offset().left;
 var y = e.pageY - $(this).offset().top; 
```

# c# - 我怎样才能摆脱循环

> ID：13689985
> 
> 赞同：-2
> 
> 时间：2012-12-03T19:08:52.000
> 
> 标签：c#, while-loop

```
while (true)
            {
                    while (true)
                    {
                        int h = ok_group_join(gr);
                        if (h == 0)
                            ok_group_post(gr);
                        else if (h == -1)
                        {
                          //How can I go to first while cycle?
                        } 
```

我在我的代码中写了一条评论，我怎样才能从那里返回到第一个 while 循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:10:20.703

```
while (true)
            {
                string acc = "";
                lock (accslocker)
                {
                    if (accs.Count == 0)
                    {
                        break;
                    }
                    else
                        acc = accs.Dequeue();
                }
                string cook = od_auth(acc);
                if (cook != "badacc")
                {
                    string gr;
                    while (true)
                    {
                        int h = ok_group_join(gr);
                        if (h == 0)
                            ok_group_post(gr);
                        else if (h == -1)
                        {
                          //How can I go to first while cycle?
                          break;
                        } 
```

`break`关键字会让你出去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:10:45.500

使用[`break`](http://msdn.microsoft.com/en-us/library/adbctzc4%28v=vs.80%29.aspx).

```
else if (h == -1)
{
    break;
} 
```

这将使您脱离当前的 while 循环，导致您退回到前一个 while 循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:30:52.200

比使用 a 更好的`break`是将内部循环重写为不是 a `while (true)`。

```
while (true)
{
    int h = 0;
    while (h != -1)
    {
        h = ok_group_join(gr);
        if (h == 0)
            ok_group_post(gr);
    }
 } 
```

# java - 绘制图像时出现空指针异常？

> ID：13689989
> 
> 赞同：-2
> 
> 时间：2012-12-03T19:09:15.120
> 
> 标签：java, image, swing, imageicon

我试图在java中绘制图像。在我创建一个单独的类来存储图像之前，它正在工作。但现在我得到空指针异常。

主类：

```
Image image;
Images images; // class object
public void paint(Graphics G){
    image = images.GETImage();
    G.drawImage(image, x, y, 20,20,null);
}

protected void paintComponent(Graphics G){
    paint(G);       
} 
```

用于存储图像的 Image 类：

```
public Image GETImage(){
    int direction = pacman.getDirection();
    int newDirection = pacman.getDirection();
    int x = pacman.getX();
    int y = pacman.getY();

    if(direction == Constant.UP){
        ImageIcon i = new ImageIcon("src\\images\\pacman up.png");
        image = i.getImage();

        }
    return image;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T19:19:53.403

你的问题在这里：

```
Image image;
Images images; // class object (this is never initiated in code snippet given)
public void paint(Graphics G){
    image = images.GETImage(); //images is null, thus calling any method on the object will throw NPE
    G.drawImage(image, x, y, 20,20,null);
} 
```

你永远不会启动`images`，因此它会抛出一个 NPE。

另请注意@HovercraftFullOfEels 的评论，这很重要，尤其是方法的命名

# google-apps-script - FinanceApp.getHistoricalStockInfo 调用不返回正确的值

> ID：13689993
> 
> 赞同：0
> 
> 时间：2012-12-03T19:09:30.150
> 
> 标签：google-apps-script, google-finance-api

当我尝试使用以下代码块获取历史报价时，stockInfo 数组返回为空。根据 FinanceApp.getHistoricalStockInfo 函数调用中指定的标准，我应该得到 2012 年 11 月 30 日交易日 GOOG 股票的价格。

```
function TestMethod()
{
  var ss = SpreadsheetApp.getActiveSheet();
  var date = new Date(2012, 11, 30);
  var retValue = FinanceApp.getHistoricalStockInfo("GOOG", date, date, 1);
  var ret = retValue.stockInfo[0];  

  Logger.log(ret);  /* This comes back as 'undefined' */
  Logger.log(retValue.close);  /* This comes back as 'undefined' */

  if (retValue != undefined && retValue.stockInfo[0] != undefined)
    Logger.log(retValue);
} 
```

直到大约 10 天前，这种方法才能正常工作。我也尝试将其发布到谷歌群组论坛，但尚未有人回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T06:21:41.323

当您设置 1 天的间隔时，您将必须在开始日期和结束日期之间至少相差一天。例如

```
function TestMethod(){
  var ss = SpreadsheetApp.getActiveSheet();
  var startDate = new Date(2012, 10, 30);
  var endDate = new Date(2012, 11, 1);
  var retValue = FinanceApp.getHistoricalStockInfo('GOOG', startDate, endDate, 1);
  var ret = retValue.stockInfo[0];  

  Logger.log(ret); 
  Logger.log(retValue);  
} 
```

# ruby - 使用 RHEL 5.2 和 Puppet 3.0.0 配置 Phusion Passenger 3.0.18

> ID：13689994
> 
> 赞同：0
> 
> 时间：2012-12-03T19:09:32.453
> 
> 标签：ruby, passenger, puppet

我正在尝试在 RHEL 5.2 下配置 Apache/Phusion Passenger。到目前为止，apache 的乘客模块和 mod_ssl 的安装是成功的，但是我在尝试测试 puppet 客户端代理时遇到了问题。

这就是我位于**/etc/httpd/conf.d上的****乘客**.conf 的样子

 **```
LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-3.0.18/ext/apache2/mod_passenger.so

PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-3.0.18
PassengerRuby /usr/bin/ruby

# you probably want to tune these settings
PassengerHighPerformance on
PassengerMaxPoolSize 12
PassengerPoolIdleTime 1500
# PassengerMaxRequests 1000
PassengerStatThrottleRate 120
RackAutoDetect On
RailsAutoDetect Off

Listen 8140

<VirtualHost *:8140>
        SSLEngine on
        SSLProtocol -ALL +SSLv3 +TLSv1
        SSLCipherSuite ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:-LOW:-SSLv2:-EXP

        SSLCertificateFile      /var/lib/puppet/ssl/certs/xxxxx.pem
        SSLCertificateKeyFile   /var/lib/puppet/ssl/private_keys/xxxxx.pem
        SSLCertificateChainFile /var/lib/puppet/ssl/ca/ca_crt.pem
        SSLCACertificateFile    /var/lib/puppet/ssl/ca/ca_crt.pem
        # If Apache complains about invalid signatures on the CRL, you can try disabling
        # CRL checking by commenting the next line, but this is not recommended.
        SSLCARevocationFile     /var/lib/puppet/ssl/ca/ca_crl.pem
        SSLVerifyClient optional
        SSLVerifyDepth  1
        # The `ExportCertData` option is needed for agent certificate expiration warnings
        SSLOptions +StdEnvVars +ExportCertData

        # This header needs to be set if using a loadbalancer or proxy
        RequestHeader unset X-Forwarded-For

        RequestHeader set X-SSL-Subject %{SSL_CLIENT_S_DN}e
        RequestHeader set X-Client-DN %{SSL_CLIENT_S_DN}e
        RequestHeader set X-Client-Verify %{SSL_CLIENT_VERIFY}e

        DocumentRoot /etc/puppet/rack/public/
        RackBaseURI /
        <Directory /etc/puppet/rack/>
                Options None
                AllowOverride None
                Order allow,deny
                allow from all
        </Directory>
</VirtualHost> 
```

我的人偶配置**/etc/puppet/puppet.conf**

```
[main]
    # The Puppet log directory.
    # The default value is '$vardir/log'.
    logdir = /var/log/puppet

    # Where Puppet PID files are kept.
    # The default value is '$vardir/run'.
    rundir = /var/run/puppet

    # Where SSL certificates are kept.
    # The default value is '$confdir/ssl'.
    ssldir = $vardir/ssl
    ssl_client_header = SSL_CLIENT_S_DN
    ssl_client_verify_header = SSL_CLIENT_VERIFY
[agent]
    # The file in which puppetd stores a list of the classes
    # associated with the retrieved configuratiion.  Can be loaded in
    # the separate ``puppet`` executable using the ``--loadclasses``
    # option.
    # The default value is '$confdir/classes.txt'.
    classfile = $vardir/classes.txt

    # Where puppetd caches the local configuration.  An
    # extension indicating the cache format is added automatically.
    # The default value is '$confdir/localconfig'.
    localconfig = $vardir/localconfig 
```

在 httpd 服务器日志上，我可以看到以下警告

```
[Mon Dec 03 13:53:08 2012] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Mon Dec 03 13:53:08 2012] [warn] RSA server certificate CommonName (CN) `xxxxx' does NOT match server name!?
[Mon Dec 03 13:53:08 2012] [notice] Digest: generating secret for digest authentication ...
[Mon Dec 03 13:53:08 2012] [notice] Digest: done
[Mon Dec 03 13:53:08 2012] [warn] RSA server certificate CommonName (CN) `xxxxx' does NOT match server name!?
[Mon Dec 03 13:53:08 2012] [notice] Apache/2.2.3 (Red Hat) configured -- resuming normal operations 
```

*运行puppet agent --test*时，我还从客户端日志中获得了 html 输出

 *```
The application has exited during startup (i.e. during the evaluation of config/environment.rb). The error message may have been written to the web server's log file. Please check the web server's log file (i.e. not the (Rails) application's log file) to find out why the application exited.
If that doesn't help, then please use the backtrace below to debug the problem.

Application root:
/etc/puppet/rack

    /usr/lib/ruby/site_ruby/1.8/puppet/util.rb  514 in `exit'
    /usr/lib/ruby/site_ruby/1.8/puppet/util.rb  514 in `exit_on_fail'
    /usr/lib/ruby/site_ruby/1.8/puppet/application.rb   344 in `run'
    /usr/lib/ruby/site_ruby/1.8/puppet/util/command_line.rb 76  in `execute'
    config.ru   33  
    /usr/lib/ruby/gems/1.8/gems/rack-1.4.1/lib/rack/builder.rb  51  in `instance_eval'
    /usr/lib/ruby/gems/1.8/gems/rack-1.4.1/lib/rack/builder.rb  51  in `initialize'
    config.ru   1   in `new'
    config.ru   1 
```

*配置.ru*

```
# a config.ru, for use with every rack-compatible webserver.
# SSL needs to be handled outside this, though.

# if puppet is not in your RUBYLIB:
# $LOAD_PATH.unshift('/opt/puppet/lib')

$0 = "master"

# if you want debugging:
# ARGV << "--debug"

ARGV << "--rack"

# Rack applications typically don't start as root.  Set --confdir to prevent
# reading configuration from ~/.puppet/puppet.conf
ARGV << "--confdir" << "/etc/puppet"

# NOTE: it's unfortunate that we have to use the "CommandLine" class
#  here to launch the app, but it contains some initialization logic
#  (such as triggering the parsing of the config file) that is very
#  important.  We should do something less nasty here when we've
#  gotten our API and settings initialization logic cleaned up.
#
# Also note that the "$0 = master" line up near the top here is
#  the magic that allows the CommandLine class to know that it's
#  supposed to be running master.
#
# --cprice 2012-05-22

require 'puppet/util/command_line'
# we're usually running inside a Rack::Builder.new {} block,
# therefore we need to call run *here*.
run Puppet::Util::CommandLine.new.execute 
```

这是使用 Webrick 默认网络服务器工作的，它连接到 puppet 客户端没有任何问题。

还有其他线索可以帮助我解决此问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:54:32.193

由于默认文件中缺少参数，因此在 3.0.0 和 3.0.1 之间对 config.ru进行[了修复。](https://github.com/puppetlabs/puppet/commit/623fa028)尽管您遇到的错误尚不清楚，但这可能就是问题所在。

添加了以下行：

```
ARGV << "--vardir"  << "/var/lib/puppet" 
```

尝试[从 Puppet 3.0.1 获取完整的 config.ru](https://github.com/puppetlabs/puppet/blob/3.0.1/ext/rack/files/config.ru)。***