# StackOverflow 问答 14408000-14408999

# c# - How are paths to embedded resources stored?

> ID：14408003
> 
> 赞同：6
> 
> 时间：2013-01-18T21:33:46.617
> 
> 标签：c#, embedded-resource

Is it possible to retain the logical layout of the project file?

If I have 2 embedded resources laid out like the following

![Embedded Resources](../Images/31e39e2f83fe18e7aedbdcd772796eca.png)

When I call Assembly.GetManifestResourceNames(), the two of them get named:

*   MyLibrary._MyItems.SubItems.SubItem1.xml
*   MyLibrary._MyItems.SubItems.SubItem2.xml

However, this gives me no real insight into how they're logically ordered in my project. For all I know, they could both be in the same directory.

I worry that this may not be possible, because if I name the files like so, my app will not even compile:

![Embedded Resources](../Images/53b857e595deeec45cd2b7aa65adca55.png)

I want to be able to distinguish between

*   MyLibrary._MyItems\SubItems\SubItem1.xml

*   MyLibrary._MyItems\SubItems.SubItem2.xml

[Similar question, but less detail than I am looking for](https://stackoverflow.com/questions/27757/how-can-i-discover-the-path-of-an-embedded-resource)

[Exact duplicate, no traction](https://stackoverflow.com/questions/11849917/how-do-i-get-folder-names-from-c-sharp-embedded-resource)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:49:04.347

一个简单的解决方案是提出一个约定来指示文件名的开始位置。然后，您可以“安全地”假设名称的其余部分表示文件夹结构。

但是，由于这些是嵌入式资源，您可以创建在编译之前运行的 T4 脚本（或一些类似的代码），以检查文件夹结构并构建详细说明该结构的类。

这是生成的类的外观示例。

```
public static class MyResources
{
    private readonly Dictionary<String, String> ResourceNameToDirPathMappingSetSource = new Dictionary<String, String>();

    static MyResources()
    {
        ResourceNameToPathMappingSetSource.Add("MyLibrary._MyItems.SubItems.SubItem1.xml", @"MyLibrary._MyItems\SubItems");
        ResourceNameToPathMappingSetSource.Add("MyLibrary._MyItems.SubItems.SubItem2.xml", @"MyLibrary._MyItems");
    }

    public static IReadOnlyDictionary<String, String> ResourceNameToDirPathMappingSet
    {
        get
        {
            return ResourceNameToDirPathMappingSetSource;
        }
    }
} 
```

我的假设是您想要获取资源名称并确定它最初所在的文件夹路径。字典当然可以包含您需要映射到的任何值（阅读：自定义类）。

# jetty - 如何使用 jetty-all.jar 启动 Jetty 嵌入式 HelloWorld

> ID：14408010
> 
> 赞同：1
> 
> 时间：2013-01-18T21:34:17.080
> 
> 标签：jetty

我正在创建一个 Jetty 项目，作为一种学习体验。我今年 15 岁，正在探索编程世界并寻找我喜欢的东西，并在此过程中尽可能多地获取信息。

我刚刚开始按照本教程创建我的 Jetty 服务器，[http://wiki.eclipse.org/Jetty/Tutorial/Jetty_HelloWorld](http://wiki.eclipse.org/Jetty/Tutorial/Jetty_HelloWorld)

我已经到了最后一步，正在尝试启动我的服务器

```
java -cp jetty-all.jar:servlet-api-2.5.jar HelloWorld 
```

我正在尝试在 Mac 上运行它，这是我的错误消息

```
Error: Could not find or load main class HelloWorld 
```

有谁知道这可能是什么原因造成的？我已经编译了 HelloWorld.java 文件并使用了

```
javac -cp servlet-api-2.5.jar:jetty-all.jar HelloWorld.java 
```

任何人都可以帮助解决这个问题吗？

提前致谢。我只需要在这里指出正确的方向。:)

——亨利·哈里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:46:20.913

如果您按照教程执行了 javac 命令，请尝试使用此命令行...

```
java -cp jetty-all.jar:servlet-api-2.5.jar:. HelloWorld 
```

注意额外的`:.`部分，它也将使用当前目录来查找 HelloWorld.class 文件。

# mysql - 根据外键的多个值选择记录

> ID：14408016
> 
> 赞同：-1
> 
> 时间：2013-01-18T21:34:40.563
> 
> 标签：mysql

我目前正在写查询。我想从表中选择所有记录。记录将基于外键的多个值。例如与 1 和 2 相关的所有记录，例如。表可能有

```
 id  name uid
 1    bil   3 
 2    test   3
 3    test  4
 4    test  4
 5    bil   5
 6    bil   5 
```

我想选择与 3 相关但也与 4 相关的所有记录，在这种情况下它是记录号 2

```
SELECT id 
FROM `table` 
WHERE uid = value1 AND like_id 
       IN (SELECT like_id 
            FROM likes 
            WHERE uid = uid2) 
LIMIT 0 , 30 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:50:07.513

根本不清楚“ `value1`”来自哪里，或者“ `uid2`”来自哪里，或者“”列来自哪里`like_id`。这些列名不会出现在您的示例表中。您的示例查询引用了两个不同的表名（`table`和`likes`），但您只显示一个示例表的数据，并且该表没有名为 的列`like_id`。

如果我们假设您的查询中的“ `value1`”和“ `uid2`”是文字，或者是提供给查询的绑定参数，这似乎是合理的，考虑到您的规范（不同地），值 1、2、3 和 4。但是我们'仍然留下“ `like_id`”列。鉴于它在 IN 子查询的 SELECT 列表中被引用，我们将假定它是 " `likes`" 表中的一列，并且鉴于它在外部查询中被引用，我们将假定它是（不幸命名）`table`表。

（归根结底，鉴于您无法复制工作测试用例，您的查询如何返回“正确”结果根本不清楚。）

* * *

给定一个表格，如您的示例数据所示，例如

```
CREATE TABLE likes (id INT, name VARCHAR(4), uid INT);
INSERT INTO likes VALUES (1,'bil',3),(2,'test',3),(3,'test',4)
 ,(4,'test',4),(5,'bil',5),(6,'bil',5);

ALTER TABLE likes ADD PRIMARY KEY (id);
ALTER TABLE likes ADD CONSTRAINT likes_ix UNIQUE KEY (uid, name); 
```

假设我们正在针对该单个表运行查询，并且我们正在将与 uid=3 关联的“likes”与与 uid=4 关联的“likes”进行匹配，并且匹配是在“name”列上完成的，然后

```
SELECT t.id
  FROM `likes` t
 WHERE t.uid = 3
   AND EXISTS
       ( SELECT 1
           FROM `likes` s
          WHERE s.name = t.name
            AND s.uid = 4
       ) 
```

这将从表中返回uid=3 的`id`行`likes`，我们还在`likes`表中找到 uid=4 具有匹配`name`值的行。

鉴于要从外部查询的表中检查的行数`likes`有限，这给出了需要运行相关子查询的有限次数，这应该会提供合理的性能：

对于大型集合，连接操作通常会更好地返回等效结果：

```
SELECT t.id
  FROM `likes` t
  JOIN `likes` s
    ON s.name = t.name
       AND s.uid = 4
 WHERE t.uid = 3
 GROUP
    BY t.id 
```

任一查询的最佳性能的关键是适当的索引。

# django - django 静态文件是否跳过中间件？

> ID：14408017
> 
> 赞同：9
> 
> 时间：2013-01-18T21:34:49.920
> 
> 标签：django, django-staticfiles

我正在运行一个 django 1.4.1 应用程序。

我没有意识到仅仅`django.contrib.staticfiles`在`INSTALLED_APPS`你的设置中加入就足以在`settings.DEBUG`为 True 时获得静态文件，也就是说，你不必手动向你的 urls 文件中添加任何东西。

我还注意到这绕过了 django 中间件。有谁知道如何或为什么会发生这种情况？

* * *

我刚刚创建了一个空白的新项目，我的views.py：

```
from django.http import HttpResponse
def index(request):
    html = '<html><body>Logo: <img src="/static/logo.gif"></body></html>'
    return HttpResponse(html) 
```

我的 urls.py：

```
from django.conf.urls import patterns, include, url
urlpatterns = patterns('',
    url(r'^$', 'testapp.views.index', name='home'),
) 
```

我的 settings.py 指定了一个目录来查找静态文件，并且还添加了以下内容：

```
MIDDLEWARE_CLASSES = (
    'testapp.middleware.TestMiddleware',
    ...
) 
```

使用这个中间件：

```
from __future__ import print_function
class TestMiddleware(object):
    def process_request(self, request):
        print("[REQUEST]", request.path) 
```

当我提出请求时，会打印出来：

```
[REQUEST] /
[18/Jan/2013 15:30:27] "GET / HTTP/1.1" 200 60
[18/Jan/2013 15:30:27] "GET /static/logo.gif HTTP/1.1" 200 2190
[REQUEST] /favicon.ico 
```

这与测试服务器的启动方式有关吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-18T21:45:46.933

我是在发帖后才发现的……</p>

如果您正在使用`django-admin.py runserver`or `python manage.py runserver`，那么添加常规中间件无法触及的静态文件处理程序会带来一些额外的魔力。

你可以通过运行来禁用它`django-admin.py runserver --nostatic`——参见[django 文档](https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/#django-admin-option---nostatic)

当你这样做时，`--nostatic`它会退回到你的应用程序中的 url，例如，如果你直接包含 staticfiles_urls() ：

```
urlpatterns += staticfiles_urlpatterns() 
```

然后您的中间件将为这些网址运行（当然还有您的所有其他网址）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T02:19:07.870

尝试使用中间件修改 request.path 时发现此问题。

发现的 url 解析为`request.path_info`not`request.path`

# android - 在 ANDROID 中显示来自 XML 的 HTML

> ID：14408019
> 
> 赞同：0
> 
> 时间：2013-01-18T21:34:57.760
> 
> 标签：android, html, xml, xml-parsing

我有小问题。。

我创建了获取 xml 中的 rss 提要的应用程序 一切正常，直到我尝试将 XML 中的字符串显示为 HTML ..

```
 <content:encoded>
<![CDATA[
<p><b>Boris Petrović, jedan od finalista trenutno najpopularnijeg muzičkog šoua u Srbiji  &#8211; Prvog glasa Srbije, nije mogao ni da pretpostavi da će mu samo dan nakon što su mediji u Srbiji preneli  njegovu izjavu </b><strong>“Ako jednog dana skupim pare, možda me Aleksandra Radović primi u njenu školu“ – popularna pevačica ostvariti želju.</strong> Radovićeva je danas prijatno iznenadila i Borisa i njegove fanove kada mu je na društvenoj mreži Twitter poželela dobrodošlicu u njenu školu pevanja koja važi za jednu od najboljih u Srbiji.</p> <p style="text-align: center;"><img class="aligncenter wp-image-23370" alt="Boris" src="http://www.ilovezrenjanin.com/wp-content/uploads/2013/01/Boris.png" width="448" height="286" /></p> <p>Nakon ispadanja iz takmičenja, popularna pevačica i članica žirija, pozvala je u svoju školu Zorana Stanića koji je te večeri bio Borisov „rival“. Postupak je ovog mladog Žitištanina, kako je i sam kasnije izjavljivao, pomalo revoltirao s obzirom da je i on imao želju da radi na svom glasu i dovede ga do savršenstva.</p> <p><img class="aligncenter size-full wp-image-23371" alt="boris" src="http://www.ilovezrenjanin.com/wp-content/uploads/2013/01/boris.jpg" width="455" height="279" /></p> <p style="text-align: center;"><strong>Ostvarila mu se želja &#8211; Boris Petrović na sceni</strong></p> <p>Posle današnjeg prijatnog gesta pevačice, može se očekivati da Borisa tek očekuju sjajne mogućnosti s obzirom da je u Prvom glasu Srbije bio jedan od retkih koji nije prošao ni jedan čas profesionalnog pevanja.</p> <p><strong>Radovićeva je najavila Borisu da 1\. marta – počinju časovi!</strong></p>
]]> 
```

现在在代码和段落中有图像strong b ...等。

如何让我的应用程序对 CDATA 进行编码并显示 HTML .. 如何让它看起来不错..

这是我需要显示 html 的 SINGLEITEM 活动。

```
 static final String KEY_TITLE = "title";
    static final String KEY_DESCRIPTION = "description";

    // XML node keys

public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.single_menu_item);

         // getting intent data
            Intent in = getIntent();

            // Get XML values from previous intent
            String title = in.getStringExtra(KEY_TITLE);
            String description = in.getStringExtra(KEY_DESCRIPTION);

            //String link = in.getStringExtra(KEY_LINK);
           // String description = in.getStringExtra(KEY_DESCRIPTION);

            // Displaying all values on the screen
            TextView lblTitle = (TextView) findViewById(R.id.txtTitle);
            //TextView lblLink = (TextView) findViewById(R.id.link_label);
            TextView lblDesc = (TextView) findViewById(R.id.txtDescription);

            lblTitle.setText(title);
            //lblLink.setText(link);
            lblDesc.setText(Html.fromHtml(description));

        }
    } 
```

那么我现在需要做什么才能使这个节目成为 HTML ......？？？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T03:51:05.160

一种方法是将 TextView 更改为 WebView。您可以将 WebView 放在标题 TextView 的下方。

我有一个通用的帮助活动。我在 HTML 编辑器中创建帮助文件并将它们加载到原始文件中。您可以使用活动构建的 HTML：

```
 setContentView(R.layout.helpactivity);
    helpWebView = (WebView) findViewById(R.id.helpWebView);

    Bundle extras = getIntent().getExtras();
    int helpId = extras.getInt(GC.HELP_FILE_ID);

    htmlString = readRawTextFile(getApplicationContext(), helpId);
    helpWebView.loadData(htmlString, "text/html", null); 
```

readRawTextFile 是一个检索适当的 HTML 文件并将其加载到字符串中的函数。你可以把它改成

```
htmlString = in.getStringExtra(KEY_DESCRIPTION); 
```

# coldfusion - ColdFusion 9 中的登录系统

> ID：14408020
> 
> 赞同：1
> 
> 时间：2013-01-18T21:35:00.333
> 
> 标签：coldfusion, coldfusion-9, cflogin

我正在使用我的公司以前在使用框架的网站上使用的非常旧的登录系统。以前，当有人尝试错误的用户/密码组合时，框架会加载一个简单的 cfinclude 文件，其中包含登录表单和顶部的错误消息。现在我在一个调用 application.cfc 的弹出窗口中使用了一个表单，但是页面并没有在我的弹出窗口中返回错误消息，而是将 cfinclude 文件从应用程序组件加载到一个新页面。

所以我需要为这个应用程序做一些事情。首先，我需要初始弹出窗口保持不变，如果用户/密码的组合错误，页面不应该提交，最后我需要错误消息出现在弹出窗口的某个位置。

如果有人在我之前做过这样的事情，我将非常感谢您的反馈。

这是我的代码的一部分：

登录表格：

```
<!--- loginErrMsg display - to tell why login is denied --->
<cfif isdefined("loginErrMsg")><span style="color:red">#loginErrMsg#</span><br /></cfif>

<form name="LoginForm" id="LoginForm" action="<cfif test is false>https://secure.example.com</cfif>#loginFormAction#" method="post" target="_top">
</cfoutput>
<input type="hidden" name="loginPost" value="true">
    <p>
      Login below to take advantage of the great services we offer:
    </p>

    E-mail:<input name="j_username" class="loginform" type="text" size="30" maxlength="50" id="j_username"> 
    Password: <input name="j_password" type="password" size="30" maxlength="16" class="loginform">
    <br />

    <input type="submit" name="btn" value="Submit" class="bluebuttonnormal">
    </form> 
```

应用程序.cfc 代码：

```
<cflogin applicationtoken="swmadmin">
        <cfif NOT IsDefined("cflogin")>
            <cfinclude template="login.cfm">
            <cfabort>
        <cfelse>
            <cfquery name="userlookup" datasource="#ds#">
            SELECT clientadminID, roles, isFaxOnly, acctEnabled FROM clientadmin
            WHERE
            username=<cfqueryparam value="#cflogin.name#" CFSQLTYPE="CF_SQL_VARCHAR" maxlength="50">
            and password=<cfqueryparam value="#cflogin.password#" CFSQLTYPE="CF_SQL_VARCHAR" maxlength="16">
            </cfquery>
            <cfif userlookup.recordcount eq 0>
                <cfset loginErrMsg = "Invalid login.">
                <cfinclude template="login.cfm">
                <cfabort>

    </cflogin> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T04:03:51.480

> 我正在使用我的公司以前在使用框架的网站上使用的非常旧的登录系统。

如果这是一个新网站，请不要使用它。登录表格是一角钱，可以在你睡觉的时候完成。从新开始，做正确的事。

> 所以我需要为这个应用程序做一些事情。首先，我需要初始弹出窗口保持不变，如果用户/密码的组合错误，页面不应该提交，最后我需要错误消息出现在弹出窗口的某个位置。

您将希望在这里使用 AJAX 解决方案，要么编写自己的解决方案，要么使用像 jQuery 这样的优秀库。一旦您检查了登录值，您就可以使用 jQuery 或简单的 javascript 来取消隐藏或更新空元素的 innerHTML 以显示您的错误消息。

```
<cflogin ...>
...
</cflogin> 
```

CFLogin 让我很难过。ColdFusion 的另一个标签旨在简化一些通常做的事情，这些事情并没有太大帮助，而且牺牲了灵活性。没有它，您可以更好地控制您的应用程序。而不是 CFLogin，试试这个伪代码

```
<cfcomponent>
  <cffunction name = "onRequest" ...>
    <cfargument name="targetPage" type="String" required = "true" />
    <cfif !structKeyExists(session, "roles") and !findNoCase("loginHandler.cfm",cgi.script_name)>
      <!--- notice I prevent the redirect on the form handler, otherwise the ajax will get redirected to the login.cfm page --->
      <cfinclude template = "login.cfm">
    <cfelse>
      <cfinclude template = "#arguments.targetPage#">
    </cfif>
  </cffunction> 
</cfcomponent> 
```

然后，您的 login.cfm 将包含您的表单，但您的按钮会触发类似[jQuery.post()](http://api.jquery.com/jQuery.post/)到“loginHandler.cfm”的内容，然后根据登录结果，您的回调函数可能会使用[jQuery.html()](http://api.jquery.com/html/)来显示错误或[window.location.replace / window.location.href](https://stackoverflow.com/questions/503093/how-can-i-make-a-redirect-page-in-jquery-javascript)如果登录成功。当然，在成功登录的情况下，您的 ColdFusion 页面必须创建它们的会话变量并执行您希望它执行的任何其他操作，然后再将结果发送回您的 AJAX 调用。

# java - 学习 Android Java - 应用程序失败

> ID：14408025
> 
> 赞同：0
> 
> 时间：2013-01-18T21:35:33.400
> 
> 标签：java, android, converter

我一直在尝试学习 Java 进行 Android 开发，所以我决定尝试制作一个简单的转换器应用程序来学习。目前我有一个简单的用户界面，我正在尝试从摄氏度转换为华氏度。转换器将在工作时在摄氏度、华氏度和开尔文之间转换。

当我单击应该运行计算方法的按钮时，我收到错误“不幸的是，转换器已停止”。下面是我的代码，我还包含了视图的 XML。

```
    包 com.michaelmurphy.converter；

    导入android.app.Activity；
    导入android.os.Bundle；
    导入 android.widget.EditText；
    导入 android.widget.Spinner；

    公共类温度扩展活动{

        /** 在第一次创建活动时调用。*/
        @覆盖
        public void onCreate(Bundle savedInstanceState)
        {

            super.onCreate(savedInstanceState);
            设置内容视图（R.layout.temperature_view）；

            // TODO 自动生成的方法存根
        }

        公共无效临时计算（）
        {
            //定义变量
            浮点值 = 0;
            String from = "";//用于微调器
            String to = "";//用于微调器

            //获取输入值
            EditText 输入 = (EditText) findViewById(R.id.editText1);
            //转换为字符串
            字符串输入值 = input.getText().toString();
            //将字符串转换为浮点数
            浮点数 = Float.valueOf(enteredValue);

            //从微调器中获取值
            final Spinner fromSpinner = (Spinner) findViewById(R.id.spinner1);
            从 = fromSpinner.getSelectedItem().toString();    
            //检索到微调器值
            最终微调器 toSpinner = (Spinner) findViewById(R.id.spinner1);
            to = toSpinner.getSelectedItem().toString();

            EditText 输出 = (EditText) findViewById(R.id.textView2);

            /*if(from.equals(to)) //相同的转换类型
            {
                //错误
            }*/

            if(from.equals("摄氏度"))
            {
                if(to.equals("华氏度"))
                {
                    值 = celToFar(num);
                }
                别的
                {
                    //值 = celToKel(num);
                }
            }
            else if(from.equals("Fahrenheit"))
            {
                if(to.equals("摄氏度"))
                {
                    //值 = fahToCel(num);
                }
                别的
                {
                    //值 = fahToKel(num);
                }
            }
            否则//开尔文
            {
                if(to.equals("摄氏度"))
                {
                    //值 = kelToCel(num);
                }
                别的
                {
                    //值 = kelToFah(num);
                }
            }

            //将标签设置为变量值
            String valueStr = Float.toString(value);//将浮点数转换为字符串
            output.setText(valueStr);
        }

        公共浮动 celToFar（浮动 cel）
        {
            浮动法 = cel * 9/5 + 32;
            返回 fah；
        }

    }

```

查看 XML 代码：

 `````
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/app_name"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10"
        android:inputType="numberDecimal" >

        <requestFocus />
    </EditText>

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:entries="@array/temp_arr" />

    <Spinner
        android:id="@+id/spinner2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:entries="@array/temp_arr" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/convertBtn"
        android:onClick="tempCalc" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:textAppearance="?android:attr/textAppearanceLarge" />

</LinearLayout> 
````  `有没有人能指出我哪里出错了，我不知道。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T21:38:04.037

改变：

```
public void tempCalc() 
```

到

```
public void tempCalc(View v) 
```

任何 onClick 方法都需要一个`View`参数。由于您没有通过，因此方法签名不匹配，并且您的应用程序会引发异常。``

# javascript - Javascript Prototype 在 html 标签上添加观察点击而不是 id 或 name

> ID：14408027
> 
> 赞同：2
> 
> 时间：2013-01-18T21:35:36.303
> 
> 标签：javascript, html, prototype, prototypejs, dom-events

我想在`<h4>`标签上的原型 js 中添加一个观察语句，而不使用任何 id 或名称。所以例如我在html中：

```
 <h4>Some Item</h4> 
```

在Javascript中我想做：

```
$(<h4>).observe('click', function() {
 //do some stuff here
}); 
```

我知道我可以在`<h4>`标签上添加一个 id 或 name 并使用它，但我如何在没有任何 id 或 name 标签的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:40:01.883

我的原型生锈了，但我*认为*这会起作用。基本上它只是获取所有的`<h4>`s，遍历它们，并添加事件观察者。

```
$$('h4').each(function(h) {
  $(h).observe('click', function(e) {
    //do some stuff here
  }
}); 
```

如果你只想要第一个`<h4>`然后使用数组解引用：

```
$$('h4')[0].observe('click', function(e) {
  //do some stuff here
}); 
```

自然，如果您想要第二个，只需将零更改为一，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:38:12.767

据我所知，你不能。浏览器如何区分两个具有任何 id 的 h4？

你也可以做

```
<h4 onclick=""> 
```

但是你也可以给它一个ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T01:24:08.667

[PrototypeJS](http://api.prototypejs.org/language/Enumerable/prototype/invoke/ "原型JS")有一个`invoke()`方法可以遍历项目列表并在列表中的所有项目上运行相同的方法。

例如

```
$$('h4').invoke('observe','click',function(e){
    //handle event here
    //'this' is the element
    //'e' is the Event object
}); 
```

# jms - 在 WAS 中，为什么 TOPIC 和 QUEUE 一起使用？

> ID：14408031
> 
> 赞同：1
> 
> 时间：2013-01-18T21:35:51.683
> 
> 标签：jms, websphere, ibm-mq, websphere-6.1, jms-topic

在 websphere app server 6.1 中，当我想设置 JMS 时，我需要设置一个主题，我需要设置队列，然后在 MQ 资源管理器中创建主题和队列之间的订阅。现在此配置适用于发布/订阅模型。如果有内容发布到主题，所有队列都会接收该消息。

那么我们如何在 websphere 中进行点对点消息传递呢？我问这个问题是因为我认为主题是针对发布订阅模型的。队列用于点对点消息传递。但在 WAS 中，两者混为一谈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T01:09:17.047

两者没有混淆。这里没有矛盾，真的。

*   发布/订阅模型使用一个主题（“事物”发布到该主题）和一组设置为使用该主题的队列。
*   点对点模型使用队列；“生产”应用程序将消息放入队列中，“消费”应用程序从该队列中获取消息。

因此，不存在矛盾。请记住，主题和队列只是实现发布/订阅或点对点拓扑的“工具”。

# javascript - Javascript命名空间 - 如何根据命名导出函数范围内定义的函数和变量？

> ID：14408033
> 
> 赞同：4
> 
> 时间：2013-01-18T21:36:00.520
> 
> 标签：javascript, namespaces, javascript-namespaces

使用下面的代码，除了手动指定之外，有没有办法只导出名称不以下划线开头的函数和变量？

```
var myapp = myapp || {};
myapp.utils = (function() {
  var
    CONSTANT_A = "FOO",
    CONSTANT_B = "BAR";

  function func() {}
  function _privateFunc() {}

  return {//return all variables and functions whose name does not have the "_" prefix.}
}()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:22:24.097

您的想法需要能够列出本地范围内的所有变量。不幸的是，JavaScript 无法做到这一点。请参阅[此相关问题](https://stackoverflow.com/questions/3831932/access-all-local-variables)。

我见过有两种方法可以做到这一点：

1）将每个变量定义到要导出的对象时附加：

```
var myapp = myapp || {};
myapp.utils = (function () {
    var exports = {};

    exports.CONSTANT_A = "FOO",
    exports.CONSTANT_B = "BAR";

    exports.func = function func() {}

    function _privateFunc() {}

    return exports;
}()); 
```

2）或者在对象文字的末尾列出所有导出：

```
var myapp = myapp || {};
myapp.utils = (function () {
    var 
       CONSTANT_A = "FOO",
       CONSTANT_B = "BAR";

    function func() {}
    function _privateFunc() {}

    return {
        CONSTANT_A: CONSTANT_A,
        CONSTANT_B: CONSTANT_B,
        func: func
    };
}()); 
```

我已经在实践中看到了两者（甚至两者的混合）。第二个可能看起来更迂腐，但也允许读者查看单个代码段并查看该函数返回的整个接口。

# css - CSS 选择一个直系兄弟链

> ID：14408035
> 
> 赞同：8
> 
> 时间：2013-01-18T21:36:08.733
> 
> 标签：css, css-selectors

我有一个项目，其中我无法控制标记。我正在寻找一种方法来选择*紧跟*在“class1”实例之后的“class2”的每个实例。以下策略有效，但在某些情况下，连续有 20 多个“class2”实例，我希望避免代码中出现巨大的混乱。

```
.class1 + .class2,
.class1 + .class2 + .class2,
.class1 + .class2 + .class2 + .class2,
.class1 + .class2 + .class2 + .class2 + .class2,
.class1 + .class2 + .class2 + .class2 + .class2 + .class2
// etc.
{
  // Applied Styles
} 
```

...设置以下样式

```
<div class="class1"></div>
<div class="class2">Style Me!</div>
<div class="class2">Style Me!</div>
<div class="class2">Style Me!</div>
<div class="class2">Style Me!</div>
<p>Blah blah blah</p>
<div class="class2">DO NOT STYLE ME</div>
<div class="class2">DO NOT STYLE ME EITHER</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:38:17.893

`:not`这是使用@spudley 建议的新选择器在黑暗中刺伤。看起来它有很好的支持：[http](http://caniuse.com/#search=%3Anot) ://caniuse.com/#search=%3Anot 。我希望语法是正确的。欢迎编辑。

其中大部分来自@mookamafoob 的解决方案。我没有提交编辑以防@mookamafoob 反对`:not`过早使用选择器。

[http://jsbin.com/umivas/6/edit](http://jsbin.com/umivas/6/edit)

```
.class1 ~ .class2 + .class2 {
  color: red;
}

.class1 + .class2 {
  color: red;
}

.class1 ~ *:not(.class2) ~ .class2 {
  color: inherit;
} 
```

编辑：抱歉没有解释。最后一部分尝试选择任何没有的兄弟元素，`.class1`并将`.class2`所有后续兄弟元素重置`.class2`为原始状态。这可能有点疯狂，具体取决于您应用了多少样式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:39:37.503

一般的**兄弟组合器**可能会得到你需要的东西。它看起来像这样：

```
.class1 ~ .class2 {
/* Styles */
} 
```

您可以在[此处](http://css-tricks.com/child-and-sibling-selectors/)找到有关它的更多信息。

这里也是一个例子[http://jsbin.com/arorij/1/edit](http://jsbin.com/arorij/1/edit)

**编辑**

[这](http://jsbin.com/umivas/1/edit)可能适用于您的情况，同时使用两个规则，如下所示：

```
.class1 ~ .class2 + .class2 {
  color: red;
}

.class1 + .class2 {
  color: red;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-18T22:39:15.117

我的建议是简单地为 设置样式`.class1 ~ .class2`，然后将其覆盖回之前的值`p ~ .class2`。

这不是一个完美的解决方案，因为那里的第二个选择器不知道它覆盖的是什么；您只需将其设置为您期望的默认值即可。但它应该是可行的。

我的另一个想法是使用 CSS`not`选择器。

这样，您可以切换到更容易`~`选择所有相关`class2`元素的组，但使用`not`并`~`过滤掉`<p>`标签后面的元素。

例如：

```
.class1 ~ :not(p) ~ .class2 
```

不幸的是，我认为这个想法不会如图所示。此处的使用`~`会导致我们不希望选择的某些组合，而不管`not`. 可能会想出一个`not`可以工作的选择器，但是我在我现在尝试的时间里还没有设法设计它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:57:23.023

也许您需要翻转逻辑？您可以为 .class1 之后的 .class2 或 .class2 之后的 .class2 编写规则吗？

```
.class1 + .class2, .class2 + .class2 {
    ...
} 
```

该规则不适用于您示例中的最后一个 div，因为它不遵循任何规则。

# jsf-2 - Primefaces 对话框不显示

> ID：14408041
> 
> 赞同：0
> 
> 时间：2013-01-18T21:37:07.103
> 
> 标签：jsf-2, dialog, primefaces, commandbutton

我希望`dialog`在单击 a 后显示 a `commandButton`，但它根本不显示。我认为该按钮正在提交表单而不是显示对话框。更重要的是，我尝试制作 a`'Cancel' commandButton`并且它也无法正常工作 - 只有当我首先单击它时它才有效（如果我单击应该首先`commandButton`打开 a `dialog`，取消按钮将不再起作用）。

这是我的.xhtml：

```
<ui:define name="content">
     <p:dialog id="dlg" header="#{messages.chooseSkillLevel}" widgetVar="dlg" modal="true" dynamic="true">
       <h:form>
         <h:dataTable value="#{editSkills.skillsAndLevels}" var="skillslevel">
            <h:column>
               #{skillslevel.skill.umiejetnosc}
            </h:column>
            <h:column>
               <p:selectOneMenu value="#{skillslevel.level}" >
                   <f:selectItems value="#{editSkills.levels}" var="level" itemLabel="#{level.stopien}" itemValue="#{level.id}" />
               </p:selectOneMenu>
            </h:column>
         </h:dataTable>
         <p:commandButton value="#{messages.confirm}" action="#{editSkills.showSkillsAndLevels}" oncomplete="dlg.hide();" />
         <p:commandButton value="#{messages.cancel}" onclick="dlg.hide()"/>
       </h:form>
     </p:dialog>
     <h:form>
        <p:messages/>
          <p:pickList value="#{editSkills.skills}" var="skill" effect="none"  converter="#{picklistConverter}"
                itemValue="#{skill.id}" itemLabel="#{skill.umiejetnosc}"  
                showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains" 
                addLabel="#{messages.add}" removeLabel="#{messages.remove}" removeAllLabel="#{messages.removeAll}" >  
                <f:facet name="sourceCaption">#{messages.skillsList}</f:facet>  
                <f:facet name="targetCaption">#{messages.yourSkills}</f:facet>
                <p:ajax event="transfer" listener="#{editSkills.onTransfer}" /> 
                <p:column style="width:100%;">  
                    #{skill.umiejetnosc}  
                </p:column> 
          </p:pickList>      
          <p:commandButton value="#{messages.confirm}" actionListener="#{editSkills.afterSubmit}" update=":dlg" oncomplete="dlg.show();" />  THIS IS THE MENTIONED BUTTON  
          <p:commandButton value="#{messages.cancel}" action="profile" immediate="true"/>  THIS IS THE CANCEL BUTTON
     </h:form>
</ui:define> 
```

我应该怎么做才能让它运作良好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T02:18:11.480

你的代码对我来说似乎很好:)。但是，您需要注意的一件事是`id`和的`widgetVar`属性`<p:dialog>`不能具有相同的值。尝试以下操作：

```
<p:dialog id="levelDlg" widgetVar="levelDialog"> 
```

# c# - 为项目创建动态控件

> ID：14408045
> 
> 赞同：1
> 
> 时间：2013-01-18T21:37:16.313
> 
> 标签：c#, asp.net-mvc, razor

我想在我的 ASP.NET MVC 项目中创建动态控件。例如

我的模型包含一个`IList<Product> Products`. 此列表中的每个产品都包含一个新的`IList<ProductItem>`. 产品项目具有属性文本和值。

现在我想为每个产品创建一个 DropDownList 并且每个都`dropdownlist`应该包含 ProductItem 的项目。

这可能`HtmlHelpers`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:40:41.267

这很简单。在您的控制器中

```
public ActionResult Index()
{
    List<Product> model = GetProductList();
    View(model);
} 
```

在您看来：

```
@model IList<Products> 
```

...然后稍后...

```
@Html.DropDownListFor(item => item.Name, new SelectList(Model, "Name", "Value")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:07:44.867

如果您不想使用助手，您可以随时执行以下操作：

```
<select>
    @foreach (var x in Model)
    {
        <option value="@x.Value">@x.Text</option>
    }
</select> 
```

# maven - 解压程序集并将其复制到给定文件夹的快捷方式？

> ID：14408046
> 
> 赞同：0
> 
> 时间：2013-01-18T21:37:20.107
> 
> 标签：maven, maven-assembly-plugin

我有一个相当简单的 Maven 程序集，我想将它部署到文件系统上的文件夹中。我绝对可以使用提取命令链接我的 Maven 构建，但是有没有办法通过将文件部署到何处的属性从 Maven 内部执行以下操作？

```
mvn install && tar -C /my/deployment/folder xvzf target/${project.artifactId}-${project.version}-default.tar.gz ${project.artifactId}-${project.version}-default/ 
```

有没有一种方法可以为 Maven 提供一些配置，以便我可以执行以下操作：

```
mvn install deploy -DdeploymentDir=/my/deployment/folder 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T08:56:07.363

使用 dir`<format>dir</format>`获取解压后的目录

```
 <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
                <descriptors>
                    <descriptor>path/to/assembly.xml</descriptor>
                </descriptors>
            </configuration>
        </plugin> 
```

程序集.xml

```
 <?xml version="1.0" encoding="GBK"?>
    <assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.1">
        <id></id>
        <baseDirectory>${project.artifactId}-${project.version}-default/</baseDirectory>
        <formats>
            <format>dir</format>
        </formats>

        <fileSets>
            <fileSet>
                <directory>../../path/to/${project.artifactId}-${project.version}-default/</directory>
                <outputDirectory></outputDirectory>
                <includes>
                    <include>**/**</include>
                </includes>
            </fileSet>
        </fileSets>
    </assembly> 
```

使用 antrun 复制到 dest 目录

```
 <plugin>   
       <artifactId>maven-antrun-plugin</artifactId>    
         <executions>     
        <execution>
        <phase> ... choose after assembly </phase>        
               <goals>            
                     <goal>run</goal>        
               </goals>             
               <configuration>       
                     <tasks>          
                         <copy todir="/tmp/xx" >        
                        <fileset dir="target/${project.build.finalName}"/>
                </copy>
                     </tasks>          
               </configuration>        
        </execution>    
         </executions>  
    </plugin> 
```

# image-processing - 可调锐化颜色矩阵

> ID：14408047
> 
> 赞同：0
> 
> 时间：2013-01-18T21:37:20.330
> 
> 标签：image-processing, aforge

我正在使用 .NET AForge 库来锐化和成像。“锐化”过滤器使用以下矩阵。

```
 0  -1   0
-1   5  -1
 0  -1   0 
```

这实际上确实锐化了图像，但我需要更积极地锐化图像并基于数字范围，比如 1-100。

使用 AForge，我如何用数字 1 到 100 转换这个矩阵，其中 1 几乎不明显，而 100 非常明显。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:12:02.553

像这样的过滤器必须保持的一个属性是所有值的总和为 1。您可以从中间值中减去 1，乘以某个常数，然后将 1 加回到中间值，它将被正确缩放。玩弄范围（几乎可以肯定 100 太大），直到找到可行的方法。

您也可以尝试使用更大的过滤器矩阵，或者在角落也有值的过滤器矩阵。

我还建议查看[GaussianSharpen 类](http://www.aforgenet.com/framework/docs/html/4600a4d7-825b-138f-5c31-249a10335b26.htm)并调整 sigma 值。

# data-binding - 无法在 Xaml 中获取对 clr 对象的引用以进行数据绑定

> ID：14408050
> 
> 赞同：0
> 
> 时间：2013-01-18T21:37:43.077
> 
> 标签：data-binding, windows-8, windows-applications

我正在尝试遵循将数据绑定到 clr 对象的代码示例。

该示例指出

```
<DockPanel
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:c="clr-namespace:SDKSample">
  <DockPanel.Resources>
    <c:MyData x:Key="myDataSource"/>
  </DockPanel.Resources>
  <DockPanel.DataContext>
    <Binding Source="{StaticResource myDataSource}"/>
  </DockPanel.DataContext>
  <Button Background="{Binding Path=ColorName}"
          Width="150" Height="30">I am bound to be RED!</Button>
</DockPanel> 
```

但是，我似乎在获取我在 XAML 中创建的对象（在 C# 中）的引用时遇到了问题

```
<Page
    x:Class="HelloWindows.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:HelloWindows"
    xmlns:src="clr-namespace:HelloWindows"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <src:MainPage+Person x:key="person" />
    </Page.Resources> 
```

这是我的 C#

```
 public Person person = new Person();

    public class Person
    {
        public String name { get; set; }
    } 
```

如图所示，我创建了“src”命名空间。但是，Visual Studio 无法识别“Person”并想在其前面添加“MainPage+Person”。我收到以下错误

> 添加到 IDictionary 的所有对象都必须具有 Key 属性或与之关联的其他类型的键。

所以我对此感到困惑，也对“MainPage+Person”感到困惑。我假设我需要一种方法来告诉 XAML 不仅是对象的类型，而且还要获得我正在创建的实际对象的句柄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:06:21.190

不幸的是，您面临着 WPF 和 Windows 应用商店应用程序的 XAML 语法略有不同的挑战。DockPanel 示例是 WPF（DockPanel 不是本机 Windows 应用商店控件），您的 MainPage 似乎来自 Windows 应用商店应用程序。

更改您的命名空间声明

```
xmlns:src="clr-namespace:HelloWindows" 
```

到

```
xmlns:src="using:HelloWindows" 
```

`using`是`clr-namespace`.

# php - PHP脚本在浏览器运行一段时间后停止运行

> ID：14408051
> 
> 赞同：3
> 
> 时间：2013-01-18T21:37:47.850
> 
> 标签：php, timeout

我制作了一个 PHP 脚本，可能需要大约 3 个小时才能完成。我从浏览器运行它，大约 45 分钟后它停止做任何事情。我知道这一点，因为它会轮询某些网址，然后将一些数据保存到数据库中。所以它基本上停止将任何数据放入数据库，这导致我得出它已经停止的结论。它仍然显示在浏览器中，就像它会加载页面一样，但它永无止境。

没有任何错误，所以它可能是某种超时......但它发生的地方是个谜，或者我怎样才能防止它发生。在我的情况下，我不能使用 CLI，我必须使用浏览器客户端来启动脚本。

我试图把

```
set_time_limit(0); 
```

但它没有明显的效果。有什么建议可能导致超时并修复它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-29T12:20:01.243

尝试这个：

```
set_time_limit(0); 
ignore_user_abort(true);
ini_set('max_execution_time', 0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:40:30.730

大多数虚拟主机会终止运行一段时间的进程。这旨在作为针对无限循环的故障保护。

询问您的主机，看看是否有任何方法可以为您的这个特定脚本禁用它。在某些情况下，killer 不适用于 Cron 任务或 SSH 运行的进程。但是，这因主机而异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:41:19.537

可能是浏览器超时，不确定浏览器是否这样做，但我也从来没有一个页面需要这么多时间。

建议：我假设您正在运行一个循环。加载一个页面，然后在对另一个页面的 ajax 调用中运行循环的每次迭代，直到前一个迭代返回时才触发下一次迭代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:42:59.050

PHP中有一个设置可以在一段时间后终止进程。这对于共享服务器尤其重要（您不希望一个进程减慢整个服务器的速度）。

您需要询问您的主机是否可以对 php.ini 进行修改（通过 .htaccess）。特别是 max_execution_time 设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T21:48:25.187

如果您正在使用会话，那么您需要查看“session.cookie_lifetime”而不是 set_time_limit。如果您使用的是数组，则数组大小也可能会填满。

如果没有有关脚本如何处理任务的更多信息，将很难识别。

# c++ - 内存地址 0x0 可用吗？

> ID：14408062
> 
> 赞同：6
> 
> 时间：2013-01-18T21:38:22.410
> 
> 标签：c++, pointers, memory-management, null, new-operator

我想知道......如果你做一个新的，预订开始的地址是0x0怎么办？我想这是不可能的，但为什么呢？新运营商是否为此做好了准备？第一个字节的那部分不可用吗？操作系统启动时总是保留它？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-18T21:43:07.157

空*指针*不一定是地址`0x0`，因此架构可能会选择另一个地址来表示*空指针*，并且您可以从中获取`0x0`有效`new`地址。（我认为没有人这样做，顺便说一句，它会破坏大量`memset`调用背后的逻辑，而且无论如何它更难实现）。

*空指针*是由*操作系统*保留还是*C++ 实现*未指定，但 plain`new`永远不会返回*空指针*，无论它的地址是什么（*nothrow`new`*是一个不同的野兽）。所以，回答你的问题：

> 内存地址 0x0 可用吗？

也许，这取决于特定的实现/架构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:39:50.520

“早期”内存地址通常为操作系统保留。操作系统不使用早期物理内存地址来匹配虚拟内存地址以供用户程序使用。根据操作系统，可以有很多东西——中断向量表、页表等。

这是 Linux 中物理和虚拟内存布局的非特定图；从发行版到发行版以及发布到发布可能会略有不同：

[http://etutorials.org/shared/images/tutorials/tutorial_101/bels_0206.gif](http://etutorials.org/shared/images/tutorials/tutorial_101/bels_0206.gif)

^不要被图形混淆 - 引导加载程序不在物理内存中......不知道他们为什么包含它......但除此之外它是准确的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T21:39:31.517

我想你在问为什么虚拟内存没有一直映射到 0x0。最大的原因之一是当你没有分配一个指针时它是非常明显的——如果它是 0x0，它指向“无”并且总是错误的。

当然，NULL 可以是任何值（因为它依赖于实现），但是由于未初始化的 int 的值是 0，在我看到的每个实现中，为了保持一致性，他们都选择保持 NULL 0。

还有很多其他原因，但这是一个很好的原因。[这](http://en.wikipedia.org/wiki/Virtual_address_space)是一篇关于虚拟寻址的 Wikipedia 文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T21:51:33.377

系统保留了许多内存地址以帮助调试。

`0x00000000 Returned by keyword "new" if memory allocation failed`

`0xCDCDCDCD Allocated in heap, but not initialized`

`0xDDDDDDDD Released heap memory.`

`0xFDFDFDFD "NoMansLand" fences automatically placed at boundary of heap memory. Should never be overwritten. If you do overwrite one, you're probably walking off the end of an array.`

`0xCCCCCCCC Allocated on stack, but not initialized`

但是就像其他一些人指出的那样，操作系统使用的物理内存地址与操作系统分配给您的应用程序的逻辑内存地址之间存在区别。[此处](http://www.google.com/url?source=imglanding&ct=img&q=http://www.scm.tees.ac.uk/users/u0000408/MMUeg/Image127.gif&sa=X&ei=0MP5UITsLuS9iwLGxYGYBQ&ved=0CAoQ8wc&usg=AFQjCNGXrkGIvu2-n0eW-SiHT8BUyAu_RQ)显示的示例图像。

# android - 我可以使用 SAX 解析器快速获取指定标签的值吗？

> ID：14408070
> 
> 赞同：3
> 
> 时间：2013-01-18T21:39:10.200
> 
> 标签：android, xml, parsing

我想在从 XML 提要导入我的文章时制作一个进度条。

解析工作正常，但对于我的进度条，我需要快速知道`<item>`提要中的总#数，以便确定已加载的百分比。

我的想法是，在 PHP 中执行此操作并将“计数”添加到提要本身会快得多 - 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<channel>
<title>My Apps Feed</title>
<link>http://link_to_this_fiel</link>
<language>en-us</language>
<count>42</count> 
```

但随后我需要能够快速访问该“计数”数字。

目前，我有一个`RSSHandler.java`这样的名称：

```
//Add all items from the parsed XML
for(NewsItem item : parser.getParsedItems())
{
    //... 
```

注意：我的应用的最低 API 级别 8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T04:56:37.493

您可以使用 Xpath 来获取 XML 中的特定节点值。样本将是：

```
SAXBuilder builder = new SAXBuilder();
Document doc = builder.build(.....); // get document for your xml here
Element elem = (Element) XPath.selectSingleNode(doc, "channel/count");
System.out.println(elem.getValue()); 
```

这样就可以直接获取计数值。但我不确定这是实现此目的的有效且更快的方法。作为一个选项，您可以使用它。还要花一些时间阅读：[SAX parsing - effective way to get text nodes](https://stackoverflow.com/questions/2064679/sax-parsing-efficient-way-to-get-text-nodes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T02:05:33.620

SAX 按照它们进入的顺序读取标签。确保将您的标签放在 XML 的开头，否则无论如何您都需要解析它。为了更容易解析，我将其放入具有唯一名称的自闭合标签的属性中。然后等待 SAX 解析器调用您的`startElement`方法，检查标记名称是否与计数标记的名称匹配，提取属性并将其显示给用户。

如果要在显示计数后停止解析器，可以抛出 a`SAXException`来执行此操作。

我假设您已经知道如何在主线程之外进行解析工作，因为您提到了一个进度条并暗示解析可能需要一些时间（并且在主线程上执行长任务会给您带来 ANR）。万一有人偶然发现了这个不知道的问题：您可以使用`AsyncTask`and `publishProgress`(在“worker”线程中由您的代码调用) 和`onProgressUpdate`(在您调用时由 Android 在 UI 线程上调用`publishProgress`) 方法来解决这个问题。

# ruby-on-rails - 没有javascript的Rails Bootstrap模态传递值？

> ID：14408072
> 
> 赞同：2
> 
> 时间：2013-01-18T21:39:13.633
> 
> 标签：ruby-on-rails

我有一个带有 Bootstrap 模式的 Rails 应用程序。

以下是启动模式的部分代码：

```
 <a type="button" class="btn" href="#labor_modal" data-toggle="modal" data-woid= <%= workorder.id %>><i class="icon-time"></i></a> 
```

以下是模态代码的一部分：

```
<div class="modal fade" id="labor_modal">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">&times;</a>
  <h3>Add Labor</h3>
  </div>
  <div class="modal-body">
    <%= simple_form_for(Event.new, validate: true, remote: true, html: {"data-type" => :json}) do |f| %>
    <%= f.hidden_field :workorder_id, :value => data-woid.val() %> 
```

我想将工作 order.id 传递给模态，以便可以将其保存在新记录中。

此代码不起作用：

```
<%= f.hidden_field :workorder_id, :value => data-woid.val() 
```

任何帮助，将不胜感激 ！！

PS - 我希望我可以在没有 jquery 的情况下做到这一点 - 但是，如果我需要它，就这样吧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:34:30.870

`<%= %>`是一个 ERb（嵌入式 Ruby）标签。里面应该是 Ruby 代码。

```
data-woid.val() 
```

在您使用它的上下文中不是有效的 Ruby。

ERb 在呈现 HTML 之前被处理。在处理 ERb 时，Ruby 不知道 DOM 或呈现的 HTML 元素或其属性。无法通过 ERb 读取 Ruby 中的 HTML 数据属性。您必须在页面呈现并构建 DOM 后访问它们。为此使用 JavaScript/jQuery。

我猜这`work_order.id`将用于设置关联。将其暴露给用户是不安全的；在提交之前可以将值更改为任何值。应该在控制器中设置关联，特别是`create`调用之前的操作`save`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-26T16:59:33.860

好吧，这个问题**没有 javascript**。我的答案可能不适用于每种情况或完美地回答问题，而且它不会扩展，但它不使用 javascript！

所以我要做的是根据参数**创建尽可能多的模态。**我会通过为他们分配不同的ID来做到这一点。这可以在轨道上动态完成。

Then each link would open (reveal) its matching modal, and it would **seem like a parameter was sent**, because each modal would have the necessary information, set at render time.

# jquery - safari、chrome、webkit 浏览器中 2 个不同 jquery 脚本的问题

> ID：14408077
> 
> 赞同：0
> 
> 时间：2013-01-18T21:39:27.457
> 
> 标签：jquery, google-chrome, safari, webkit

我将首先说我没有编写此代码，因为 jquery 并不是我真正的强项。我在 webkit 浏览器中的几个脚本遇到了一些问题，想知道是否有人可以帮助我。可以在[http://disalle.dev.activemls.com](http://disalle.dev.activemls.com)查看相关站点。

**问题 #1 等高 div：**
我正在使用以下代码，然后分配如下 id="leftcol" class="equal-height" 和 id="maincol" class="equal-height"。使用以下内容，该脚本似乎只是定期工作：

```
<!--JQUERY EQUAL COLUMN HEIGHT-->
function resetHeight() {
   var maxHeight = 0;
   $(".equal-height").height("auto").each(function(){ 
       maxHeight = $(this).height() > maxHeight ? $(this).height() : maxHeight; 
   }).height(maxHeight);
}
resetHeight();
// reset height on resize of the window:
$(window).resize(function() { 
    resetHeight();
}); 
```

**问题#2 动态选择的选项值：**
以下代码用于根据选择框中选择的内容来选择在多选框中显示哪组选项值。首次加载页面时，选择框中的默认选项是“选择一个州”，选项是“ohio”或“michigan”。在默认状态下，css 设置为在选择框中隐藏 .ohio 和 .michigan 内容，然后应在选择时显示。这在 Firefox 中完美运行，但在 webkit 浏览器中再次失败。这是代码：

**jQuery**

```
<!--JQUERY DYNAMIC SELECT BOX-->
$('.area-select').change(function(){
    var selected = $(this).find(':selected');
    $('.area-list').hide();
   $('.'+selected.val()).show(); 
    $('.optionvalue').html(selected.html());
}); 
```

**HTML**

```
<div class="spacer">
                        <label>Select A State</label><br />
                            <select class="area-select">
                                <option selected="selected" value="start">Select A State...</option>
                                <option value="ohio">Ohio</option>
                                <option value="michigan">Michigan</option>
                            </select>
                    </div>
                    <div class="spacer">
                        <label>Select An Area</label><br />
                            <select name="area" size="10" multiple="multiple">
                                <option class="area-list start" value="start">Select A State First...</option>
                                <!-- TMPL_LOOP Area_descs -->
                                <option class="area-list ohio" value="<!-- TMPL_VAR area_name -->">
                                <!-- TMPL_VAR area_name -->
                                </option>
                                <!-- /TMPL_LOOP -->
                                <!-- TMPL_LOOP Area_descs -->
                                <option class="area-list michigan" value="<!-- TMPL_VAR area_name -->">
                                <!-- TMPL_VAR area_name -->
                                </option>
                                <!-- /TMPL_LOOP -->
                            </select>
                    </div> 
```

**CSS**

```
.ohio, .michigan {display:none;} 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T19:55:34.863

你是如何加载 jQuery 等列脚本的？

如果你正在使用，`$(document).ready(function()`那么你应该尝试`$(window).load(function()`。

# c# - Active Directory 中查询的 PrincipalContext

> ID：14408079
> 
> 赞同：3
> 
> 时间：2013-01-18T21:39:35.300
> 
> 标签：c#, active-directory, principalcontext

我想从 Active Directory 制作一些简单的报告。经过讨论等，我发现如果我使用 .NET FW 3.5 及更高版本，则适合使用`PrincipalContext`. 我想了解原理以及我可以用这个新功能做什么（不像`DirectoryEntry`）。

**代码骨架**

```
// create your domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain, 
    "YOURDOMAIN", "OU=SomeOU,DC=YourCompany,DC=com");

// define a "query-by-example" principal - here, we search for a UserPrincipal 
// which has a password that will expire in 3 days or less
UserPrincipal userTemplate = new UserPrincipal(ctx);
userTemplate.AdvancedSearchFilter.AccountExpirationDate(DateTime.Today.AddDays(3), MatchType.LessThanOrEquals);

// instantiate searcher
PrincipalSearcher searcher = new PrincipalSearcher(userTemplate);

// enumerate matching users
foreach (Principal foundPrincipal in searcher.FindAll())
{
    UserPrincipal foundUser = (foundPrincipal as UserPrincipal);

    if (foundUser != null)
    {
        // do something with users found - e.g. send e-mail
    }
} 
```

可以通过代码添加此属性以登录到 LDAP？：

*   使用什么 LDAP（版本 2 或 3）
*   如何设置运行 LDAP 的端口
*   如果我需要 SSL 连接如何工作？（不同的端口，必须有特殊要求）

此外，我可以用`AdvancedSearchFilter`这个条件吗？
（我发现只有`AccountExpirationDate`和`AccountLockoutDate`）

*   用户密码将在不久的将来到期
*   用户密码已过期
*   检查用户的密码是否可以过期
*   用户帐户过期（帐户，无密码）
*   过期用户帐户（帐户，无密码）
*   用户帐户未过期

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:54:39.720

这么晚才回复很抱歉。我找到了这两个链接的解决方案，其中描述了所有信息。就像它只需要结合上面的代码一样。

[检索域密码策略中“最小密码长度”的值](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/8bf326d9-16b8-47a3-8916-7af41e8b1121)

[House of Derek - 密码过期电子邮件实用程序](http://houseofderek.blogspot.cz/2008/07/password-expiration-email-utility.html)

# java - Web服务/动态类生成/流

> ID：14408089
> 
> 赞同：0
> 
> 时间：2013-01-18T21:40:09.653
> 
> 标签：java, web-services, jaxb, wsdl, jax-ws

我的问题可能听起来全错了，因为我不确定要问什么。一般来说，我对 Web 服务很陌生，但得到了一个非常高级的想法。我正在查看一些代码，其中类/方法被注释并为服务调用公开。

该`wsimport`命令可用于调用`http://.....?wsdl`它看起来像动态生成这些客户端类。我没有看到特定的 WSDL 文件，所以我猜测 JAX-WS 正在创建客户端源代码并将其发送到客户端，客户端会下载它并将其编译到相应的类中。

我注意到客户端生成的类和原始的服务器端类存在一些差异，例如缺少`toString()`方法和`equals()`方法。尝试阅读有关此内容的建议是关于自定义 JAXB 绑定和其他内容。我的问题是：

1.  有谁知道并可以分享信息，以便更好地理解我所看到的过程。即带注释的方法如何神奇地出现在客户端，作为它们各自类的一部分？
2.  关于 JAXB 绑定，大多数网站都是从现有的 WSDL 开始的。这如何适应我目前的问题？

谢谢

# java - 用于测试的 Java 编写的嵌入式 Kerberos 服务器

> ID：14408093
> 
> 赞同：9
> 
> 时间：2013-01-18T21:40:25.840
> 
> 标签：java, integration-testing, kerberos

有谁知道任何可嵌入的 Kerberos 服务器（KDC / KAdmin），它们是用 Java 编写的，并且可能只在 JVM 进程中运行（比如 Hadoop 微型集群或嵌入式 LDAP 服务器）？

我的目标是让人们运行需要 Kerberos 身份验证的集成测试，而无需安装本地 kerberos 服务器/配置远程服务器并连接到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T04:53:09.180

你可以试试Apache Directory Server ( [http://directory.apache.org/ )。](http://directory.apache.org/)它支持 LDAP 和 Kerberos。看这个例子：

[http://svn.apache.org/repos/asf/directory/apacheds/trunk/kerberos-test/src/test/java/org/apache/directory/server/kerberos/kdc/SaslGssapiBindITest.java](http://svn.apache.org/repos/asf/directory/apacheds/trunk/kerberos-test/src/test/java/org/apache/directory/server/kerberos/kdc/SaslGssapiBindITest.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:04:49.933

我也在/正在寻找这样的东西，但这根本不可能，因为您需要一个功能齐全的 DNS 服务器。完全解耦的系统是必要的。您可以通过[virtualbox-maven-plugin](http://mojo.codehaus.org/virtualization-maven-plugin/index.html)和一组具有内部网络的 VirtualBox 中的虚拟机来实现这一点。

LDAP 服务器根本不会帮助您，因为它们对 GSS-API 和 Kerberos 完全没有任何作用。SASL 通过将身份验证委托给下一个可用的 KDC 来完成所有工作。

您需要 KDC 和 DNS 服务器。您可以在一台机器上尝试 Samba 4，然后设置第二台加入域的机器。在上面安装 Hadoop，添加第三个（客户端），从那里加入并运行测试。

似乎您可以让 Apache DS 模仿 KDC：[http ://directory.apache.org/apacheds/configuration/ads-2.0-configuration.html](http://directory.apache.org/apacheds/configuration/ads-2.0-configuration.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-21T17:46:17.427

我为类似目的编写了一个嵌入式 LDAP，您也可以将它用于使用 Kerberos 进行测试，这对于测试 Hadoop Kerberos 测试等情况特别有用。

[https://github.com/krishdey/EmbeddedLdapKDC](https://github.com/krishdey/EmbeddedLdapKDC)

您还可以查看编写嵌入式 JUnit 测试的类 [https://github.com/krishdey/EmbeddedLdapKDC/blob/master/EmbeddedLdapKDC/src/test/java/com/krish/ead/server/KerberosLdapIntegrationTest.java](https://github.com/krishdey/EmbeddedLdapKDC/blob/master/EmbeddedLdapKDC/src/test/java/com/krish/ead/server/KerberosLdapIntegrationTest.java)

可能对你有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-26T21:17:27.973

Hadoop 发布了一个可以使用的 MiniKdc 类。来自 MiniKdc 类文档评论：

> 基于 Apache Directory Server 的迷你 KDC，可以嵌入到测试用例中或从命令行用作独立的 KDC。

[https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-minikdc](https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-minikdc)

# python - Python - subprocess.Popen - ssh -t user@host 'service --status-all'

> ID：14408094
> 
> 赞同：2
> 
> 时间：2013-01-18T21:40:28.717
> 
> 标签：python, linux, ssh, subprocess, popen

我读过很多例子，但没有一个适用于这个特定的任务。

Python代码：

```
x = Popen(commands, stdout=PIPE, stderr=PIPE, shell=True)
print commands
stdout = x.stdout.read()
stderr = x.stderr.read()
print stdout, stderr
return stdout 
```

输出：

```
[user@host]$ python helpers.py
['ssh', '-t', 'user@host', ' ', "'service --status-all'"]
 usage: ssh [-1246AaCfgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]
           [-D [bind_address:]port] [-e escape_char] [-F configfile]
           [-I pkcs11] [-i identity_file]
           [-L [bind_address:]port:host:hostport]
           [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port]
           [-R [bind_address:]port:host:hostport] [-S ctl_path]
           [-W host:port] [-w local_tun[:remote_tun]]
           [user@]hostname [command] 
```

为什么我会收到此错误？使用 os.popen(...) 它可以工作，它至少可以执行，但我无法通过 SSH 隧道检索远程命令的输出。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T21:42:43.767

我认为您的命令列表是错误的：

```
commands = ['ssh', '-t', 'user@host', "service --status-all"]
x = Popen(commands, stdout=PIPE, stderr=PIPE) 
```

此外，`shell=True`如果您要将列表传递给`Popen`.

例如，要么这样做：

```
Popen('ls -l',shell=True) 
```

或这个：

```
Popen(['ls','-l']) 
```

但不是这个：

```
Popen(['ls','-l'],shell=True) 
```

最后，还有一个方便的函数可以像你的 shell 一样将一个字符串拆分成一个列表：

```
import shlex
shlex.split("program -w ith -a 'quoted argument'") 
```

将返回：

```
['program', '-w', 'ith', '-a', 'quoted argument'] 
```

# javascript - Jquery之间的冲突

> ID：14408098
> 
> 赞同：-2
> 
> 时间：2013-01-18T21:40:40.190
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [Jquery 之间的冲突](https://stackoverflow.com/questions/14407146/conflict-between-jquerys)

当我在同一个文件上创建很多 jQuery 函数时，我遇到了一个问题，但它不起作用。在任何 jQuery 选项卡中，我都想创建一个表格，只需单击冒号即可对其进行排序。我用它来添加 jQueryTabs：

```
<script type="text/javascript" src="jquery-1.7.2.min.js"></script> 
```

这对于排序功能：

```
<script type="text/javascript" src="jquery.js"></script> 
```

我尝试使用 de jQuery.noConflict() 函数但它不起作用，问题出在哪里？

```
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script>
jq172.noConflict();
   jq172(document).ready(function()
    {
       var jQueryTabs1Opts =
       {
          event: 'click',
          collapsible: false
       };
       jq172("#jQueryTabs1").tabs(jQueryTabs1Opts);
    }); 
</script>
<script type="text/javascript" src="jquery.ui.core.min.js"></script>
<script type="text/javascript" src="jquery.ui.widget.min.js"></script>
<script type="text/javascript" src="jquery.ui.mouse.min.js"></script>
<script type="text/javascript" src="jquery.ui.tabs.min.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script>
jQuery.noConflict();
jQuery(document).ready(function() {
        jQuery('#example').dataTable( {
            "aaSorting": [[ 4, "desc" ]]
        } );
    } );
</script>
<script type="text/javascript" src="jquery.dataTables.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:44:50.663

尝试将不冲突分配给变量。

```
var jq172 = jQuery.noConflict();
var jQuery2 = jQuery.noConflict(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:46:15.310

你需要这样做：

```
<script>
var jq172 = jQuery.noConflict();
   jq172(document).ready(function()
    {
       var jQueryTabs1Opts =
       {
          event: 'click',
          collapsible: false
       };
       jq172("#jQueryTabs1").tabs(jQueryTabs1Opts);
    }); 
</script> 
```

也就是说，我从未尝试过，也不知道浏览器加载和缓存会如何影响这一点。我不相信第一个`jQuery.noConflict`会调用 1.7.2 库。尽管有编码和设置开销，但最好使用[Require.js 之类的库来加载和分离模块。](http://requirejs.org/)

# c++ - 如何使用 std::bind() 调用基类的虚函数版本？

> ID：14408105
> 
> 赞同：11
> 
> 时间：2013-01-18T21:40:51.953
> 
> 标签：c++, c++11, bind, virtual-functions, member-function-pointers

我正在尝试使用 std::bind() 创建一个函数，该函数将调用虚函数的基类版本，而不是调用派生类的版本。

```
struct Base
{
    virtual void foo() { cout << "Base\n"; }
};

struct Derived : public Base
{
    virtual void foo() { cout << "Derived\n"; }
};

int main(int argc, const char * argv[])
{
    Base* base = new Derived;
    auto baseMethodHopefully = std::bind( &Base::foo, base );
    baseMethodHopefully();    // Want call to Base::foo(), but get call to Derived::foo().

    return 0;
} 
```

我从[其他地方](https://stackoverflow.com/questions/1207106/calling-base-class-definition-of-virtual-member-function-with-function-pointer)了解到，您通常不能以这样的“反虚拟”方式调用基本函数。明显的例外是通用范式：

```
void Derived::bar() { Base::bar(); } 
```

由于该表达式`Base::bar()`在 Derived 的方法中被识别为“反虚拟”（在我所指的意义上），是否可以从 Derived*的*`Base::bar()`方法之一中以所需的方式绑定到？例如：

 *```
void Derived::bar()
{
    auto baseMethod = std::bind( &Base::foo, this );
    baseMethod();
} 
```

如果是这样，语法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-18T21:53:12.870

嗯，`&Base::foo`是一个成员函数指针。并且没有办法使用不调用虚拟覆盖的成员函数指针。避免虚拟覆盖的唯一语法是类名、函数名和参数列表都在同一个表达式中的语法。

但是如果你有`std::bind`，你可能也有 lambdas，所以也许你可以使用：

```
auto baseMethod = [this](){ return Base::foo(); };
//...
baseMethod(); 
```*

# performance - 包含在 ScrollViewer 中的 LongListSelector 性能非常差

> ID：14408106
> 
> 赞同：5
> 
> 时间：2013-01-18T21:41:00.550
> 
> 标签：performance, xaml, windows-phone-8, longlistselector

我有一个需要在顶部和下方`UserControl`包含一堆控件的控件。`LongListSelector`整体的总高度`UserControl`可能（并且几乎总是会）超过屏幕高度，在这种情况下，整体`UserControl`必须是可滚动的。

我目前的设置如下：

```
<staff:UserContentControl 
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:MyApp.Controls"
    xmlns:staff="clr-namespace:MyApp.Helpers"
    x:Class="MyApp.Controls.RemoteHomePage"

    DataContext="{Binding RelativeSource={RelativeSource Self}}"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}">

    <ScrollViewer>
        <ScrollViewer.Content>
            <StackPanel>
                <TextBlock Txt="Text1" Sign="@" />
                <TextBlock Txt="Text2" Sign="#" />
                <controls:Divider />

                <TextBlock Txt="Text3" Sign="~" />
                <TextBlock Txt="Text4" Sign="~" />
                <controls:TextDivider Text="Divider text" />

                <phone:LongListSelector ItemsSource="{Binding Items}">
                    <phone:LongListSelector.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Title}" />
                        </DataTemplate>
                    </phone:LongListSelector.ItemTemplate>
                </phone:LongListSelector>
            </StackPanel>
        </ScrollViewer.Content>
    </ScrollViewer>
</staff:UserContentControl> 
```

这个解决方案满足了我的需求，但也有一个大问题：`LongListSelector`当它包含的项目数量相当大时，目前确实需要很长时间才能加载。处理 300 个项目需要 8 秒，在此期间整个 UI 被阻塞。如果我删除所有内容，但是`LongListSelector`，像这样：

```
<staff:UserContentControl 
    ...>

    <phone:LongListSelector ItemsSource="{Binding Items}">
        <phone:LongListSelector.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Title}" />
            </DataTemplate>
        </phone:LongListSelector.ItemTemplate>
    </phone:LongListSelector>
</staff:UserContentControl> 
```

然后`LongListSelector`几乎立即加载，即使有大量的项目。但显然我需要它上面的其他控件，所以问题是我能做些什么来解决这个问题？

（还有相关的问题：我担心`LongListSelector`内部`ScrollViewer`可能会导致双重滚动或类似的事情，但最终在这方面一切都很好。我不确定是否`LongListSelector`以某种方式知道它在其他可滚动控件内，或者是否发生了其他事情我不知道。一些解释为什么它工作得很好，虽然很慢，但将不胜感激。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-19T05:13:51.800

不要使用滚动查看器，因为它会使 longlistselector 认为它有一个无限高的可用屏幕并渲染它的所有项目。为了解决您的用例，请使用 Header 和 Footer 属性在列表项上方或下方添加数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:00:38.810

您不能强制 ScrollViewer 虚拟化 LongListSelector 项目。

所以你只需要通过 LongListSelector 来模仿它的行为。

使第一个项目包含 StackPanel （第一个项目模板）中的所有您需要的元素。其他元素将是基本的 LongListSelector 元素（第二个 itemtemplate）。

以下是如何为项目设置不同模板的说明：[在 Windows 8 CP 中为选定的 ListViewItem 设置样式](https://stackoverflow.com/questions/9623938/styling-a-selected-listviewitem-in-windows-8-cp)

# java - 解决 IllegalAccessError

> ID：14408118
> 
> 赞同：0
> 
> 时间：2013-01-18T21:42:23.497
> 
> 标签：java, eclipse, exception, reflection

我有以下情况：

同一工作区中的 2 个 Eclipse 项目，Apa 和 Bepa（为简洁起见使用化名）。

Project Apa 引用（包括）项目 Bepa。

我在 Bepa 有一个 X 类，带有公共方法 b()。在项目 Bepa 中直接调用 Xb() 可以正常工作。

但是，在 Apa 中创建对 X 实例的引用，然后在此引用上调用 b() 会导致：

```
Exception in thread "main" java.lang.IllegalAccessError: tried to access method java_cup.runtime.Symbol.<init>(II)V from class de.uni_freiburg.informatik.ultimate.smtinterpol.util.MySymbolFactory$LineColumnSymbol
at de.uni_freiburg.informatik.ultimate.smtinterpol.util.MySymbolFactory$LineColumnSymbol.<init>(MySymbolFactory.java:31)
at de.uni_freiburg.informatik.ultimate.smtinterpol.util.MySymbolFactory.startSymbol(MySymbolFactory.java:95)
at java_cup.runtime.LRParser.parse(LRParser.java:393)
at de.uni_freiburg.informatik.ultimate.smtinterpol.smtlib2.ParseEnvironment.parseStream(ParseEnvironment.java:152)
at de.uni_freiburg.informatik.ultimate.smtinterpol.smtlib2.ParseEnvironment.parseScript(ParseEnvironment.java:118)
at de.uni_freiburg.informatik.ultimate.smtinterpol.smtlib2.SMTLIB2Parser.run(SMTLIB2Parser.java:47)
at de.uni_freiburg.informatik.ultimate.smtinterpol.Main.main(Main.java:121)
at de.uka.ilkd.key.keynterpol.KeYnterpolInterface.main(KeYnterpolInterface.java:36) 
```

据我了解，罪魁祸首是 B 引用的第三方 jar。但是，我终生无法弄清楚为什么我只能在 Bepa 内部使用它，而不能在 Apa 内部使用它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:01:56.423

IllegalAccessError 是[IncompatibleClassChangeError](http://docs.oracle.com/javase/6/docs/api/java/lang/IncompatibleClassChangeError.html)的子类。如果在您的代码执行时抛出 IncompatibleClassChangeError，这通常表明您的代码没有使用编译时所针对的相同类运行。

在您的情况下，导致抛出 IllegalAccessError 的方法是具有默认可见性的[类](http://grepcode.com/file/repo1.maven.org/maven2/edu.princeton.cup/java-cup/10k/java_cup/runtime/Symbol.java#64)[的构造函数：`java_cup.runtime.Symbol`](http://grepcode.com/file/repo1.maven.org/maven2/edu.princeton.cup/java-cup/10k/java_cup/runtime/Symbol.java#64)

```
 Symbol(int sym_num, int state)
    {
        sym = sym_num;
        parse_state = state;
    } 
```

调用此构造函数的代码位于不同的包中，因此不应直接调用此构造函数。通常，编译器会捕获此类错误，因为尝试从另一个包访问包私有成员会导致编译器错误。但是，在您的情况下，您似乎没有任何此类编译器错误。

如果您使用与编译它相同的类路径运行代码，那么我只能猜测这些`java_cup.*`类在类路径上出现了不止一次，上面的构造函数具有不同的可见性。编译器必须找到`Symbol`该构造函数为公共的类的一个副本，并且 JVM 必须找到具有此构造函数包私有的副本。

# android - 使用 Eclipse (Android) 导出存档文件或文件系统时出错

> ID：14408119
> 
> 赞同：11
> 
> 时间：2013-01-18T21:42:24.610
> 
> 标签：android, eclipse

我想导出我的项目，以便将代码重用到新项目中。每次我尝试导出它时，“文件系统”和“存档文件”都会出错

```
Problems were encountered during export:
  Error exporting name_of_my_project/bin/jarlist.cache: Resource is out of sync with the file system: '/name_of_my_project/bin/jarlist.cache'.
    Resource is out of sync with the file system: '/name_of_my_project/bin/jarlist.cache'. 
```

也许这取决于我在不使用 Eclipse 的情况下将文件复制到我的项目文件夹中的事实。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-18T21:51:19.303

在 Eclipse 中，右键单击项目并单击`Refresh`. 这将使 Eclipse 将项目与文件系统重新同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-20T13:27:25.933

1.  右键单击该特定项目
2.  单击**刷新**
3.  就是这样

现在：进行导出，它会像魅力一样工作。有时当您像我一样手动将项目复制到工作区时，您会遇到同步问题。刷新项目将其与文件系统重新同步。

# python - * 不支持的操作数类型：“numpy.ndarray”和“numpy.float64”

> ID：14408122
> 
> 赞同：8
> 
> 时间：2013-01-18T21:42:46.830
> 
> 标签：python, numpy, operand

长期阅读，第一次写。

我在谷歌和堆栈溢出上四处搜索，但并没有真正找到这个问题的一般答案。

我在使用 numpy 1.6.2 的 python 2.7.3 中收到“*: 'numpy.ndarray' 和 'numpy.float64' 不支持的操作数类型”错误。

该错误来自将 numpy 数组和 numpy 浮点数相乘，但并非每次都发生。

例如：

```
x = np.tan(1) # numpy.float64
y = np.array([0,1,2,3]) # numpy.ndarray
np.multiply(x,y) # works no problem 
```

或者

```
x = np.tan(np.abs(np.multiply(-31,41)))  # numpy.float64
y = np.square(np.add(np.divide(np.zeros(100),42),(-27)**40)) # numpy.ndarray
np.multiply(x,y) # works no problem 
```

两者都工作

现在对于有问题的孩子：

```
np.multiply(np.square(np.add(np.divide(np.zeros(100),42),-27)**40)),
np.tan(np.abs(np.multiply(-31,41)))) 
```

或者，x 定义如上：

```
np.multiply(np.square(np.add(np.divide(np.zeros(100),42),(-27)**40)),x) 
```

两者都会产生错误：NotImplemented

我知道随机函数和数字看起来很奇怪，但从概念上讲这仍然应该工作，因为当两者都单独设置为变量时它工作。

为什么会这样？我该如何从一般意义上解决它？

非常感谢！杰森

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T22:32:16.410

我怀疑这里的问题是 NumPy 无法`long`在其数组中存储 Python 值。一旦您尝试执行此操作，它会将数组的数据类型切换为`object`. 然后对数组的算术运算变得更加棘手，因为 NumPy 不能再自己进行算术运算。

```
>>> np.array(27**40)
array(1797010299914431210413179829509605039731475627537851106401L, dtype=object)
>>> np.array(27**40) * np.tan(1)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unsupported operand type(s) for *: 'numpy.ndarray' and 'numpy.float64' 
```

奇怪的是，有时可以交换参数的顺序：

```
>>> np.tan(1) * np.array(27**40)
2.7986777223711575e+57 
```

在第二种情况下，结果的类型是 Python `float`，而不是 NumPy 数组。

解决方法是避免`long`在 NumPy 数组中创建值，并使用`float`s 代替：

```
>>> np.array(27.0**40)
array(1.797010299914431e+57)
>>> np.array(27.0**40) * np.tan(1)
2.7986777223711575e+57
>>> np.multiply(np.square(np.add(np.divide(np.zeros(10),42),(-27.0)**40)),np.tan(1))
array([  5.02925269e+114,   5.02925269e+114,   5.02925269e+114,
         5.02925269e+114,   5.02925269e+114,   5.02925269e+114,
         5.02925269e+114,   5.02925269e+114,   5.02925269e+114,
         5.02925269e+114]) 
```

如果您确实收到这样的错误是未来，首先要做的是检查`dtype`被相乘的数组。它是否包含 NumPy 值或 Python 对象？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:59:36.217

这是测验吗？我不明白为什么这个问题如此模糊......一切都归结为这个简单的事实。

给定

```
>>> x = 10**100
>>> type(x)
<type 'long'>
>>> y = np.float64(1) 
```

我们有

```
>>> y.__mul__(x)
1e+100
>>> y.__rmul__(x)
NotImplemented 
```

这是错误~~（或功能，我不知道）~~因为它应该是`y.__mul__(x) == y.__rmul__(x)`（至少对于`x`和的这些特定值`y`）。

Python`long`不知道如何处理乘法`numpy.float64`（但这是正确的。）

```
>>> x.__mul__(y)
NotImplemented
>>> x.__rmul__(y)
NotImplemented 
```

所以`y*x`评估`y.__mul__(x)`并给出预期的结果。相反`x*y`，首先尝试 as `x.__mul__(y)`(not implementation, OK) 比 as `y.__rmul__(x)`(not implemented but a bug.)。

正如已经指出的，我们可以拥有`nd.arrays`任意对象，一切都变得清晰起来。

**编辑**

此错误已得到纠正（可能在 numpy 版本 1.7 中）：

```
>>> np.version.version
'1.13.1'
>>> x = 10**100
>>> y = np.float64(1)
>>> x.__mul__(y)
NotImplemented
>>> x.__rmul__(y)
NotImplemented
>>> y.__mul__(x)
1e+100
>>> y.__rmul__(x)
1e+100
>>> x*y
1e+100
>>> y*x
1e+100 
```

# python - 在 Ubuntu 上安装 SciPy

> ID：14408123
> 
> 赞同：26
> 
> 时间：2013-01-18T21:42:48.553
> 
> 标签：python, ubuntu

我正在运行 Python 2.7 并尝试使用 easy_install 安装 scipy，它返回以下错误：

```
Searching for scipy
Reading http://pypi.python.org/simple/scipy/
Reading http://www.scipy.org
Reading http://sourceforge.net/project/showfiles.php?group_id=27747&package_id=19531
Reading http://new.scipy.org/Wiki/Download
Best match: scipy 0.11.0
Downloading http://pypi.python.org/packages/source/s/scipy/scipy-0.11.0.zip#md5=40b700ddde9ddab643b640fff7a9d753
Processing scipy-0.11.0.zip
Running scipy-0.11.0/setup.py -q bdist_egg --dist-dir /tmp/easy_install-49BQSz/scipy-0.11.0/egg-dist-tmp-KMjwKy
Running from scipy source directory.
/usr/lib64/python2.7/site-packages/numpy/distutils/system_info.py:1425: UserWarning: 
    Atlas (http://math-atlas.sourceforge.net/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [atlas]) or by setting
    the ATLAS environment variable.
  warnings.warn(AtlasNotFoundError.__doc__)
/usr/lib64/python2.7/site-packages/numpy/distutils/system_info.py:1434: UserWarning: 
    Blas (http://www.netlib.org/blas/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [blas]) or by setting
    the BLAS environment variable.
  warnings.warn(BlasNotFoundError.__doc__)
/usr/lib64/python2.7/site-packages/numpy/distutils/system_info.py:1437: UserWarning: 
    Blas (http://www.netlib.org/blas/) sources not found.
    Directories to search for the sources can be specified in the
    numpy/distutils/site.cfg file (section [blas_src]) or by setting
    the BLAS_SRC environment variable.
  warnings.warn(BlasSrcNotFoundError.__doc__)
error: 
    Blas (http://www.netlib.org/blas/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [blas]) or by setting
    the BLAS environment variable. 
```

所以我通过执行安装了 Blas 和 Atalas

```
apt-get install blas
apt-get install atlas 
```

但是，easy_install 错误并没有消失。

谢谢！

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2014-01-12T11:08:51.447

什么对我有用：

要从 PIP 实际安装 scipy，您需要软件包`libatlas-base-dev`（用于 ATLAS/BLAS 的库等）和`gfortran`（GNU Fortran 编译器）。

安装这些软件包后，scipy 安装程序应按预期完成。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-01-18T21:48:56.797

Ubuntu 将库文件放在一个相当奇特的目录中。 `/usr/lib/x86_64-linux-gnu/`或其他东西，取决于您的架构。您需要将此目录添加到 site.cfg 文件或 BLAS 环境变量中。

如果easy install还需要头文件，则需要安装相应的-dev包。

但是，就像@pitsanu-swangpheaw 建议的那样，您也可以使用 ubuntu 包管理器安装到站点包目录。

```
sudo apt-get install python-numpy python-scipy 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-02-21T14:14:19.720

如果您使用的是 Python3，您可以使用安装包`apt-get`

```
sudo apt-get install python3-numpy python3-scipy 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-22T11:47:14.970

`sudo apt-get install python-scipy`在我的情况下工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-02T10:14:01.353

如果还想用 using 安装`pip`，可以使用 build-dep 获取 python-numpy 和 python-scipy 的依赖关系，然后用 using 安装`pip`

```
sudo apt-get build-dep python-numpy python-scipy 
```

替代 python3 作为您正在寻找的其他答案状态。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-18T22:09:02.370

我通过运行解决了这个问题（类似于以前的建议）

```
apt-get install scipy 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-07T10:33:01.513

我通过运行解决了这个问题：

```
sudo pip install scipy 
```

# c# - 如果它是结构数组，foreach 是否会复制每个元素？

> ID：14408124
> 
> 赞同：10
> 
> 时间：2013-01-18T21:42:49.730
> 
> 标签：c#, .net

我有一个结构数组。`foreach`遍历数组时，运算符是否会复制每个元素？据我了解`foreach`，只是将引擎盖下的语法糖转换为`for`. 所以看起来答案是否定的，但我很想得到一些确认。

PS：似乎有人应该已经问过了，但我找不到任何东西。因此，请在提供参考的情况下以 dup 的身份投票。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T21:48:20.090

是的，将制作值类型实例的副本。当迭代一个数组时，`foreach`确实会使用数组访问而不是使用枚举器，但是每个数组槽中的值仍然被复制。

这段代码：

```
struct AStruct
{
    public string a;
    public int b;

    static void Main()
    {
        var structs = new AStruct[10];

        foreach (var x in structs) {
            Console.WriteLine(x);
        }
    }
} 
```

为该`Main()`方法生成以下 IL：

```
.method private static hidebysig
       default void Main ()  cil managed
{
    .entrypoint
    .maxstack 4
    .locals init (
            valuetype AStruct[]     V_0,
            valuetype AStruct[]     V_1,
            int32   V_2,
            valuetype AStruct       V_3)
    IL_0000:  ldc.i4.s 0x0a
    IL_0002:  newarr AStruct
    IL_0007:  stloc.0
    IL_0008:  ldloc.0
    IL_0009:  stloc.1
    IL_000a:  ldc.i4.0
    IL_000b:  stloc.2
    IL_000c:  br IL_002d

    IL_0011:  ldloc.1
    IL_0012:  ldloc.2
    IL_0013:  ldelema AStruct
    IL_0018:  ldobj AStruct
    IL_001d:  stloc.3
    IL_001e:  ldloc.3
    IL_001f:  box AStruct
    IL_0024:  call void class [mscorlib]System.Console::WriteLine(object)
    IL_0029:  ldloc.2
    IL_002a:  ldc.i4.1
    IL_002b:  add
    IL_002c:  stloc.2
    IL_002d:  ldloc.2
    IL_002e:  ldloc.1
    IL_002f:  ldlen
    IL_0030:  conv.i4
    IL_0031:  blt IL_0011

    IL_0036:  ret
} // end of method AStruct::Main 
```

请注意指令 IL_0013 到 IL_001d。每个数组槽的整个值都被压入堆栈并存储在本地 V_3（`x`迭代变量）中。

# regex - 在 bash 中解析此网页中的文本

> ID：14408125
> 
> 赞同：2
> 
> 时间：2013-01-18T21:42:56.177
> 
> 标签：regex, bash, parsing, curl, sed

我想写一个bash脚本，可以解析android appstore中应用的版本号。例如这个应用程序，[https://play.google.com/store/apps/details?id=com.alphonso.pulse&hl=en](https://play.google.com/store/apps/details?id=com.alphonso.pulse&hl=en)

如何从页面右侧的当前版本标题中获取值“3.0.6”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:57:20.910

```
$ site=https://play.google.com/store/apps/details?id=com.alphonso.pulse

$ curl -s $site | sed -rn 's/.*(Current Version:)[^0-9]*([0-9.]+).*/\1\2/p'
Current Version:3.0.6 

$ curl -s $site | sed -rn 's/.*Current Version:[^0-9]*([0-9.]+).*/\1/p'
3.0.6 
```

# servicestack - 带有 ServiceStack 的 BreezeJS？

> ID：14408133
> 
> 赞同：8
> 
> 时间：2013-01-18T21:43:31.970
> 
> 标签：servicestack, breeze, single-page-application

我想知道 BreezeJS 在使用 Web API 和/或实体框架以外的其他技术时是否兼容？因为我目前正在开发一个使用服务堆栈来检索数据和 ORMLite 的 SPA？

所以我很好奇 BreezeJS 是如何处理这个的，因为我知道它通常使用它自己的 API 控制器和`DbContext`实体框架使用的类的扩展。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T22:23:47.237

目前在微风网站上的示例 zip 中有一个名为 NoDb 的示例。此示例不使用 EF，但确实使用了 WebApi。所以我会先看看那里。（也应在一两天内添加有关此示例的其他文档）。

在使用 ServiceStack 而不是 WebApi 方面，breeze 支持“dataServiceAdapter”的概念，目前附带两个，一个 OData 适配器和一个 WebApi 适配器。当然可以编写一个微风可以使用的 ServiceStack 适配器，但这并非易事。[请在微风用户语音](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions)上将此添加为功能请求（并投票）。我们认真对待这些要求。

# java - 从数组中删除点并返回一个新数组 - Java

> ID：14408134
> 
> 赞同：0
> 
> 时间：2013-01-18T21:43:40.717
> 
> 标签：java, arrays, point

> 编写一个名为 removeSomePoints 的方法。此方法接受一个点数组，并返回一个与原始数组相同的新点数组，只是它删除了所有 x 和 y 坐标相差小于 20 的点。换句话说，返回的数组可能比原始数组的大小更小。此方法应保持原始数组不变。澄清：如果以下任何点在原始数组中，它们将不在返回的数组中。
> 
> 100 90（x 和 y 相差 10）
> 
> 90 100（x 和 y 相差 10）
> 
> 3 22（x 和 y 相差 19）
> 
> 另一方面，以下任何点都将在返回的数组中：
> 
> 100 80（x 和 y 相差 20）
> 
> 80 100（x 和 y 相差 20）
> 
> 2 25（x 和 y 相差 23）

我的代码：

```
 public static Point[] removeSomePoints(Point[] arr) 
   {

    int count = 0;      
    for (int i = 0; i < arr.length; i++) {
         if (Math.abs(arr[i].getX() - arr[i].getY()) > 19) {
            count++;
          }
         }

        Point[] finalArr = new Point[count];

        for (int i = 0; i < finalArr.length; i++) {
          if (Math.abs(arr[i].getX() - arr[i].getY()) > 19) {
               finalArr[i] = arr[i];
          }

     }

       return finalArr;
    } 
```

似乎无法弄清楚出了什么问题。它正在返回一个数组，但它不会改变任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:28:34.017

好的，因此您的程序当前无法运行，因为您确定了`N`长度为输入数组中匹配项的数量（比如说 ）`M`。现在鉴于`N`保证小于`M`，请注意您正在迭代输入数组的***子集***（长度为`N`）并将该子集中的任何匹配项复制到输出数组中。这是完全不正确的。

我认为这是一个学习项目——很明显，本课的重点是为您的代码选择合适的数据结构。数组在处理固定大小的集合时很棒，但不适合可变大小的集合。对于可变数据，*列表*绝对是要走的路。

那么让我们来看看一些伪代码：

```
public static Point[] removeSomePoints(Point[] arr) {
    // If 'arr' is null, return null
    // If 'arr' is empty, return empty

    // Initialize a variable list structure, of at least arr.length in size
    // For each element in arr
    //     if element matches condition, add to variable list
    // End for
    // 
    // Convert variable list into array and return
} 
```

简而言之，这就是你的算法。将其转换为真实代码：

```
public static Point[] removeSomePoints(Point[] arr) {
    if(arr == null) return null;
    if(arr.length == 0) return new Point[0];

    List<Point> outputList = new ArrayList<Point>(arr.length);
    for(Point p : arr) {
        if (Math.abs(p.getX() - p.getY()) > 19) outputList.add(p);
    }

    return outputList.toArray(new Point[outputList.size());
 } 
```

不要忘记查看[List](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)和[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)的文档，以便更好地了解它们的工作原理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:51:41.997

逻辑中的关键缺陷是在原始数组中使用了较短的数组索引。

这意味着数组 [[90,100],[75,100],[85,100],[80,100]] 将首先计算 2 个有效条目，创建一个大小为 2 的新数组，然后从原始数组中复制前两个条目以创建[[90,100],[75,100]] 而不是所需的 [[75,100],[80,100]]。

一种方法是添加“resizeArray()”函数（此处示例：http: [//www.source-code.biz/snippets/java/3.htm](http://www.source-code.biz/snippets/java/3.htm)），在初始循环期间使用单独的索引填充新数组（例如“count”），它仅在添加到新数组时递增，然后将新数组的大小调整为目标大小。

像这样：

```
public static Point[] removeSomePoints(Point[] arr)
{
    int count = 0;

    Point[] finalArr = new Point[arr.length];

    for (int i = 0; i < arr.length; i++)
    {
        if (Math.abs(arr[i].getX() - arr[i].getY()) > 19)
        {
            finalArr[count] = arr[i];
            count++;
        }
    }

    return (Point[])resizeArray(finalArr, count);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:51:56.707

你的第二个循环应该是：

```
int j = 0;
for (int i = 0; i < arr.length; ++i) {
   if ((Math.abs(arr[i].getX() - arr[i].getY()) > 19) {
            finalArr[j++] = arr[i];
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T23:43:34.460

正如其他人所提到的，问题是由于第二个循环中的逻辑缺陷造成的。您应该遍历原始数组而不是要返回的数组。

利用`ArrayList`和的答案`resizeArray`都很好。在@Perception 的回答中，用作`ArrayList`中间数据结构，而在@DreadPirateShawn 的回答中，`Array`用作中间数据结构。最后，它们都将被调整为要返回的结果数组。由于不需要随机访问中间数据结构，因此我更喜欢使用`LinkedList`。使用链表不需要任何调整大小，因此可能会节省一些时间和空间。

```
public static Point[] removeSomePoints(Point[] arr) {
    if(arr == null) return null;
    if(arr.length == 0) return new Point[0];

    List<Point> outputList = new LinkedList<Point>();
    for(Point p : arr) {
        if (Math.abs(p.getX() - p.getY()) > 19) outputList.add(p);
    }

    return outputList.toArray(new Point[outputList.size()]);
} 
```

# c++ - 使用 C/C++ 在同一个可执行文件中进行不同的优化（plain、SSE、AVX）

> ID：14408136
> 
> 赞同：8
> 
> 时间：2013-01-18T21:43:43.030
> 
> 标签：c++, c, compiler-construction, sse, avx

我正在为我的 3D 计算开发优化，现在我有：

*   `plain`使用标准 C 语言库的 " " 版本，
*   `SSE`使用预处理器编译的优化版本`#define USE_SSE`，
*   `AVX`使用预处理器编译的优化版本`#define USE_AVX`

是否可以在 3 个版本之间切换而无需编译不同的可执行文件（例如，拥有不同的库文件并动态加载“正确”的文件，不知道`inline`函数是否“正确”）？我还会考虑在软件中使用这种开关的性能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T22:02:41.457

有几种解决方案。

一种是基于 C++，您可以在其中创建多个类 - 通常，您实现一个接口类，并使用工厂函数为您提供正确类的对象。

例如

```
class Matrix
{
   virtual void Multiply(Matrix &result, Matrix& a, Matrix &b) = 0;
   ... 
};

class MatrixPlain : public Matrix
{
   void Multiply(Matrix &result, Matrix& a, Matrix &b);

};

void MatrixPlain::Multiply(...)
{
   ... implementation goes here...
}

class MatrixSSE: public Matrix
{
   void Multiply(Matrix &result, Matrix& a, Matrix &b);
}

void MatrixSSE::Multiply(...)
{
   ... implementation goes here...
}

... same thing for AVX... 

Matrix* factory()
{
    switch(type_of_math)
    {
       case PlainMath: 
          return new MatrixPlain;

       case SSEMath:
          return new MatrixSSE;

       case AVXMath:
          return new MatrixAVX;

       default:
          cerr << "Error, unknown type of math..." << endl;
          return NULL;
    }
} 
```

或者，如上所述，您可以使用具有通用接口的共享库，并动态加载正确的库。

当然，如果您将 Matrix 基类实现为“普通”类，您可以逐步改进并仅实现您真正认为有益的部分，并依靠基类来实现性能不是非常关键的功能。

编辑：您谈论的是内联，如果是这种情况，我认为您正在查看错误的功能级别。你需要相当大的函数来处理相当多的数据。否则，您将花费所有精力将数据准备为正确的格式，然后执行一些计算指令，然后将数据放回内存中。

我还会考虑您如何存储数据。您是在存储包含 X、Y、Z、W 的数组集合，还是在单独的数组中存储大量 X、大量 Y、大量 Z 和大量 W [假设我们正在进行 3D 计算]？根据您的计算方式，您可能会发现采用一种或另一种方式会给您带来最大的好处。

我已经做了相当多的 SSE 和 3DNow！几年前的优化，“技巧”通常更多地是关于如何存储数据，以便您可以轻松地一次性获取正确类型数据的“捆绑”。如果您以错误的方式存储数据，您将浪费大量时间“混合数据”（将数据从一种存储方式移动到另一种存储方式）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-18T21:50:04.267

一种方法是实现三个符合相同接口的库。使用动态库，您只需交换库文件，可执行文件将使用它找到的任何内容。例如在 Windows 上，您可以编译三个 DLL：

*   PlainImpl.dll
*   SSEImpl.dll
*   AVXImpl.dll

然后针对`Impl.dll`. 现在只需将三个特定 DLL 之一放入与 相同的目录中`.exe`，将其重命名为`Impl.dll`，它将使用该版本。同样的原则应该基本上适用于类 UNIX 操作系统。

下一步是以编程方式加载库，这可能是最灵活的，但它是特定于操作系统的，需要更多工作（如打开库、获取函数指针等）

*编辑：*但是，当然，您可以只实现该功能三次并在运行时选择一个，具体取决于某些参数/配置文件设置等，如其他答案中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:53:18.947

当然有可能。

最好的方法是让函数完成完整的工作，并在运行时在它们中进行选择。这可行但不是最佳的：

```
typedef enum
{
    calc_type_invalid = 0,
    calc_type_plain,
    calc_type_sse,
    calc_type_avx,
    calc_type_max // not a valid value
} calc_type;

void do_my_calculation(float const *input, float *output, size_t len, calc_type ct)
{
    float f;
    size_t i;

    for (i = 0; i < len; ++i)
    {
        switch (ct)
        {
            case calc_type_plain:
                // plain calculation here
                break;
            case calc_type_sse:
                // SSE calculation here
                break;
            case calc_type_avx:
                // AVX calculation here
                break;
            default:
                fprintf(stderr, "internal error, unexpected calc_type %d", ct);
                exit(1);
                break
        }
    }
} 
```

每次通过循环时，代码都在执行一个`switch`语句，这只是开销。一个非常聪明的编译器理论上可以为您修复它，但最好自己修复它。

相反，编写三个单独的函数，一个用于普通函数，一个用于 SSE，一个用于 AVX。然后在运行时决定运行哪一个。

对于奖励积分，在“调试”构建中，使用 SSE 和平原进行计算，并断言结果足够接近以提供信心。写明文版本，不是为了速度，而是为了正确；然后使用它的结果来验证你聪明的优化版本是否得到了正确的答案。

传奇人物约翰卡马克推荐后一种方法；他称之为“并行实现”。阅读[他的文章](https://web.archive.org/web/20140719065227/http://www.altdev.co/2011/11/22/parallel-implementations/)。

所以我建议你先写普通版。然后，返回并开始使用 SSE 或 AVX 加速重写部分应用程序，并确保加速版本给出正确的答案。（有时，普通版本可能存在加速版本没有的错误。拥有两个版本并比较它们有助于发现任何一个版本的错误。）

# java - Java If 语句对初学者的帮助

> ID：14408138
> 
> 赞同：-3
> 
> 时间：2013-01-18T21:43:53.040
> 
> 标签：java, if-statement

我只是在学习 Java，所以这可能是一个非常愚蠢的问题，但我找不到足够简单的答案。我正在尝试制作程序，因此如果用户键入“男性”来运行 System.out.print("You are a guy");
这是我的代码：

```
 import java.util.Scanner;

public class clac {
    public static void main(String[] args){
        double gender;
        Scanner input = new Scanner(System.in);
        System.out.print("Are you male or female? ");
        gender = input.nextDouble();
        if (gender == "male"){
            System.out.println("You are a guy");
        }else{
            System.out.print("You are a gal.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:45:11.603

你做错了什么：你需要阅读一个字符串。字符串是一段文本。双精度数是十进制数。您正在阅读双份。

如何解决：

```
String gender = input.next(); // read a String, instead of double
if (gender.equals("male")) // if (gender == "male") use .equals for strings
{
    System.out.println("U mad bro!?");
} else
{
    System.out.println("Hey Doll!");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:45:03.567

您不应该使用`nextDouble()`，它指的是小数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:46:33.450

尝试

```
 String gender = input.nextString();
    if ("male".equals(gender)){
        System.out.println("Wazzup dude?");
    }else{
        System.out.print("Hey Doll!");
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:55:55.460

我相信您想对扫描仪使用**.next()**方法。尝试这样的事情：

```
导入 java.util.Scanner；

公共类 clac {
    公共静态无效主要（字符串[]参数）{
        //将性别变量定义为字符串，因为这是我们期望的输入
        字符串性别；
        //实例化一个Scanner对象
        扫描仪输入 = 新扫描仪（System.in）；
        //向用户提问
        System.out.print("你是男是女？");
        //将响应读入性别变量
        性别 = input.next();
        //检查用户的回答是否匹配“男”
        //我们把“男”放在第一位，以防用户返回空值
        //这将有助于避免致命错误
        如果（“男性”.equals（性别））{
            System.out.println("你是个男人");
        }
        别的 {
            System.out.print("你是个女孩。");
        }
    }
}

```

我希望这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-24T07:24:12.620

你应该使用equals方法比较两个字符串，字符串是一个对象，这是一个引用，equals()方法会比较两个字符串的内容，但是==会比较两个字符串的地址

所以，你应该这样写：

```
gender = input.next();
if (gender.equals("male")){
    System.out.println("You are a guy");
}else{
    System.out.print("You are a gal.");
} 
```

# r - R匹配同一data.frame中的两列

> ID：14408139
> 
> 赞同：-3
> 
> 时间：2013-01-18T21:43:53.530
> 
> 标签：r

如何将同一数据框中的两列合并为一列，一个简单的例子是：

```
a <- data.frame(id = 1:3, v1 = c('a', NA, NA), v2 = c(NA, 'b', 'c'))
a
  id  v1   v2
   1  a   <NA>
   2 <NA>  b
   3 <NA>  c 
```

我需要的输出如下所示：

```
a
  id  v1   v2   v3
   1  a   <NA>   a
   2 <NA>  b     b
   3 <NA>  c     c 
```

[我在 data.frame 或 data.table 中](https://stackoverflow.com/questions/9918450/join-matching-columns-in-a-data-frame-or-data-table)找到了类似的 post join 匹配列，但我无法用我自己的情况弄清楚，请帮忙，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:09:00.950

目前还不清楚你想要什么。如果`v1`和`v2`有不同的值会发生什么？

这种方法将更喜欢的值`v1`

```
a <- data.frame(id = 1:4, v1 = c('a', NA, NA,'d'), v2 = c(NA, 'b', 'c','e'))

a <- as.data.table(a)
a[,v3 := v1]
a[is.na(v1), v3 := v2] 
```

使用传统`data.frame`方法：

```
a$v3 <- as.character(a$v1)
a[is.na(a$v1),"v3"] <- as.character(a[is.na(a$v1),"v2"]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:12:49.663

嗯，`ifelse()`也许？

```
> a <- data.frame(id = 1:3, v1 = c('a', NA, NA), v2 = c(NA, 'b', 'c'),
                  stringsAsFactors=FALSE)
> a$v3 <- ifelse(is.na(a$v1), a$v2, a$v1)
> a
  id   v1   v2 v3
1  1    a <NA>  a
2  2 <NA>    b  b
3  3 <NA>    c  c 
```

# .net - MVVM Light 的 SimpleIoC 背后是什么

> ID：14408140
> 
> 赞同：2
> 
> 时间：2013-01-18T21:43:54.263
> 
> 标签：.net, mvvm, ioc-container

我只需要知道 MVVM Light 的 SimpleIoC 背后是什么？是现有的之一（Unity、Castle Windsor、StructureMap、MEF，也许是 Simple Injector ...）？或者它是由 MVVM Light 的开发团队实现的简单的一个？

有没有办法让 SimpleIoC 与特定的 IoC 一起工作？或者我应该使用[服务定位器](http://commonservicelocator.codeplex.com/)？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T19:02:41.707

由于没有人回答这个问题，我做了一个研究。我迫不及待想知道 SimpleIoC 的背后是什么，这个问题[Laurent](https://stackoverflow.com/users/12233/lbugnion)可能会回答它。

但是第二个（有没有办法让 SimpleIoC 与特定的 IoC 一起工作？或者我应该使用服务定位器吗？）我现在可以回答了。

问题是它`SimpleIoc.Default`是接口的一个实现`IServiceLocator`，并且 MVVMLight Toolkit 使用服务定位器模式工作。所以如果我们想使用任何 IoC 库，我们只需要实现`IServiceLocator`接口，然后我们就可以使用它。

例如，使用 Unity IoC：

```
 public ViewModelLocator()
    {
        var container = new UnityContainer();

        //ServiceLocator.SetLocatorProvider(() => SimpleIoc.Default);
        ServiceLocator.SetLocatorProvider(() => new UnityServiceLocator(container));
        //If we wish use another IoC we must implement the IServiceLocator interface

        ////if (ViewModelBase.IsInDesignModeStatic)
        ////{
        ////    // Create design time view services and models
        ////    SimpleIoc.Default.Register<IDataService, DesignDataService>();
        ////}
        ////else
        ////{
        ////    // Create run time view services and models
        ////    SimpleIoc.Default.Register<IDataService, DataService>();
        ////}

        container.RegisterType<MainViewModel>();
        //SimpleIoc.Default.Register<MainViewModel>();
    } 
```

这段代码是 ViewModelLocator 的构造函数。UnityServiceLocator 类实现了 IServiceLocator 接口...

# php - 无法使用 PHP/PDO 在 mySQL DB 上更新/插入

> ID：14408141
> 
> 赞同：2
> 
> 时间：2013-01-18T21:43:54.717
> 
> 标签：php, mysql, sql, pdo

我在使用 PHP 中的 PDO 对我的数据库进行更新和插入时遇到问题。错误代码表明成功，但预期的更改未反映在数据库中。

这是我设置连接的地方：

```
 $dsn = "mysql:host=".DB_HOST.";dbname=".DB_NAME;
    $db = new PDO($dsn, DB_USER, DB_PASS);
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $db->setAttribute(PDO::ATTR_AUTOCOMMIT, FALSE); 
```

我可以很好地连接和选择事物，但它根本不会更新或插入。我试过只使用硬编码的字符串，但即使这样也行不通。这是代码：

```
 $ins = "insert into choice_history (id_choice_history,choice_num,choice_taken) values ( 0, 10, 28);";
     if($stmt = $this->_db->prepare($ins))
     {
        $status  = $stmt->execute();
        return  $errorcode = $stmt->errorCode();
     } 
```

我有一个类似的更新字符串，但它们都有相同的结果。

表定义（没有约束）：

```
mysql> describe choice_history;
+-------------------+---------+------+-----+---------+----------------+
| Field             | Type    | Null | Key | Default | Extra          |
+-------------------+---------+------+-----+---------+----------------+
| id                | int(11) | NO   | PRI | NULL    | auto_increment |
| id_choice_history | int(11) | NO   |     | NULL    |                |
| choice_taken      | int(11) | YES  |     | NULL    |                |
| choice_num        | int(11) | YES  |     | NULL    |                |
+-------------------+---------+------+-----+---------+----------------+ 
```

错误代码始终为 00000（成功）。我也试过用相同的字符串调用 exec() ，但没有骰子。我可以将该查询粘贴到我服务器上的 mysql 中，它执行得很好，但是从 PDO 没有任何反应。

在这一点上，我不知所措。PDO 报告成功，但数据库中没有任何反应。我怎样才能找出问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:50:06.840

您已关闭自动提交，因此您需要明确`commit()`所有事务。

您的查询是成功的（因此您看到的结果），它们只是从未提交过。

如果您不想显式提交每个请求，则需要删除这行代码：

```
$db->setAttribute(PDO::ATTR_AUTOCOMMIT, FALSE); 
```

# oracle - 在 oracle 中采样

> ID：14408148
> 
> 赞同：0
> 
> 时间：2013-01-18T21:44:12.827
> 
> 标签：oracle, sample-data

我正在尝试从保险索赔数据库中抽取样本。

例如，从 100 万份索赔数据中抽取 20% 的随机样本，其中提供商类型为“25”，年份为“2012”。数据在 sqldeveloper 中。我是一名具有基本 SQL 知识的统计学家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:15:39.530

您可以使用`SAMPLE`从表中获取一组随机行。

```
SELECT * 
FROM   claim SAMPLE(20) 
WHERE  type ='25' 
AND    year = 2012; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:15:01.150

SQL 有一个内置的 SAMPLE 命令。示例：

```
SELECT * FROM emp SAMPLE(25) 
```

表示 emp 中的每一行都有 25% 的机会包含在结果集中。注意：这并不意味着必须选择恰好 25% 的行

这个[博客](https://blogs.oracle.com/datamining/entry/to_sample_or_not_to_sample_part_2)是关于采样的更多细节的快速阅读

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2021-08-09T19:38:43.603

有了这个，你会得到一个随机显示的样本行。

```
SELECT * FROM TABLE@ SAMPLE(10)
FETCH NEXT 1 ROWS ONLY 
```

# extjs4 - Extjs4，控制网格渲染器中的检查列

> ID：14408150
> 
> 赞同：2
> 
> 时间：2013-01-18T21:44:39.673
> 
> 标签：extjs4

```
// Grid Column
{ header: "Defected", xtype: 'checkcolumn', dataIndex: "test", renderer : this.chTest}

// renderer function
chTest : function(value, metadata, record){
  if(record.get('A') == "Y"){
    return true; //I expected the checkbox be checked, but it show letter 'true'
  }else{
    return false;
  }
} 
```

如何在 rederer 函数中选中或取消选中 checkcolum？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T12:04:08.107

[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.ux.CheckColumn](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.ux.CheckColumn)

我认为您应该在模型中定义**测试**字段，而不是在渲染中。

# php - pdftk 输入pdf作为字符串示例，可能吗？

> ID：14408151
> 
> 赞同：1
> 
> 时间：2013-01-18T21:44:42.367
> 
> 标签：php, pdftk

[我使用找到@t github.com/bensquire/php-pdtfk-toolkit](http://github.com/bensquire/php-pdtfk-toolkit)的php-pdtfk-toolkit来合并多个pdf，基本示例是

```
$pdftk=new pdftk();
$pdftk->setInputFile(array("filename" => 'example.pdf', 'start_page' => 2));
$pdftk->setInputFile(array("filename" => 'example2.pdf', 'rotation' => 100));
$pdftk->_renderPdf(); 
```

如果我有一个 pdf 作为字符串，有没有办法在不创建临时文件的情况下使用 pdftk？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:15:20.980

不，这是不可能的。该软件包只是 pdftk 二进制文件的包装器。pdftk 需要文件名，PHP 包也是如此

# c++ - blitz 0.10 中的 blitz/tinyvec.h 在哪里？

> ID：14408164
> 
> 赞同：1
> 
> 时间：2013-01-18T21:45:11.257
> 
> 标签：c++, blitz++

我已经使用 blitz 0.09 很长时间了。目前我将其更新为 blitz 0.10。blitz/tinyvec.h 消失了。有一个类似的 blitz/tinyvec2.h。我改成它，但编译没有通过。我必须包含 blitz/array.h 才能通过编译。由于我只使用微小的向量，如何在 blitz 0.10 中包含一个简短的 tinyvec 头文件？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-04T08:17:20.617

我发现`blitz/tinyvec2.h`如果你还包括`blitz/tinyvec2.cc`.

我希望这会有所帮助。

# c++ - 字符串比较很奇怪

> ID：14408171
> 
> 赞同：0
> 
> 时间：2013-01-18T21:45:45.133
> 
> 标签：c++

我一直在这里绞尽脑汁：

```
cout << orig << " * " << count << endl;
string check = multiply2(orig, count);
cout << "Check was: " << check << " and number is: " << number << endl;
cout << "the compare result: " << check.compare(number) <<  endl;
if(check.compare(number) == 0)
{
  cout << "wahoo it matches!!! we did it! " << endl;
}
else
{
  cout << "Doesnt Match " << endl;
} 
```

我希望它能够匹配并打印`wahoo it matches!!! we did it!`，但它却说它不匹配。

这是我的输出：

```
1 * 900000
Check was: 900000 and number is: 90000
the compare result: 1
Doesnt Match 
```

任何人都知道他们为什么不匹配？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:47:37.857

您比较`900000`（如 9E5）与`90000`（如 9E4）。电脑是对的。

# python - 具有相对 url 支持的 nodejs 或 python 代理库

> ID：14408179
> 
> 赞同：0
> 
> 时间：2013-01-18T21:46:21.607
> 
> 标签：python, node.js, proxy, relative-url

我正在寻找一个可以让我大致的库：

*   连接到 localhost:port，但请参阅[http://somesite.com](http://somesite.com)
*   重写所有静态资产以指向 localhost:port 而不是 somesite.com
*   支持cookies/认证

我知道[http://betterinternet.co/](http://betterinternet.co/)已经这样做了，但出于某种原因他们不会给我他们的源代码。

我认为这不作为免费代码存在，所以如果我要写一个，它有什么细微差别吗？如果我在 html 和标题中替换所有出现的 somesite.com，这就足够了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T16:53:40.190

所以...您想要一个可以进行链接重写的 http 代理？听起来像 Apache 和[mod_proxy_html](http://httpd.apache.org/docs/2.4/mod/mod_proxy_html.html)。它不是用节点或 Python 编写的，但我认为它会满足您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T17:51:19.650

我没有看到任何直接解决您问题的方法。如果我理解正确，您需要一个缓存 HTTP 代理，它在本地提供静态内容，并在 Python（或 nodejs）中定义 URL 重写规则。这是一项相当艰巨的任务。

缓存 HTTP 代理实现并非易事。所以我会使用现有的实现，比如 Squid（或者 Apache，如果它也缓存的话）。

然后，您可以在其前面放置一个（相对）简单的用 Python 编写的 HTTP 服务器（例如，基于`BaseHTTPServer`and `urllib2`），它根据您的需要执行 URL 重写并将请求转发到代理（或直接到互联网）。

这个想法是依靠代理设置来执行您不想修改的所有处理（包括基本的重写规则、身份验证、缓存和缓存管理），并将您的前端实现限制为仅执行您的自定义重写有兴趣。

# php - imagecolorset 不适用于 alpha 值

> ID：14408181
> 
> 赞同：0
> 
> 时间：2013-01-18T21:46:40.537
> 
> 标签：php, gd, color-palette

[此处](http://php.net/manual/en/function.imagecolorset.php)的手册指出 PNG 函数`imagecolorset()`接受红色、绿色、蓝色和 alpha 值，但是当我指定 alpha 值时 PHP 给了我错误：

> 警告：imagecolorset() 需要 5 个参数，给定 6 个

这让我很困惑：像 imagecolorallocate() 这样向调色板添加颜色的其他函数正确支持 alpha 值，即使对于这个函数，手册也指出它应该这样做。

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:48:39.427

在 v5.4.0 中添加了 Alpha 支持（及其相关参数），因为它在函数的联机帮助页更改日志中明确说明：http: [//php.net/imagecolorset#refsect1-function.imagecolorset-changelog](http://php.net/imagecolorset#refsect1-function.imagecolorset-changelog)

您必须升级您的 PHP 版本，或者不使用 alpha。

# jquery - ASP.NET 母版页和 Kendo UI 移动视图

> ID：14408183
> 
> 赞同：0
> 
> 时间：2013-01-18T21:46:46.247
> 
> 标签：jquery, asp.net, html, kendo-ui

假设我必须使用 ASP 母版页并在其中设置 Kendo UI Mobile 布局，同时使用`<asp:contentplaceholder>`加载 aspx 页面内容。为了使其正常工作，我尝试了以下方法（在此处剥离标签属性以提高可读性）：

**母版页文件：**

```
<html>
<head></head>
<body>
    <form>
        <asp:contentplaceholder></asp:contentplaceholder>    
    </form>

    <!-- Master Layout -->
    <div data-role="layout" data-id="mMasterLayout">
        <header data-role="header">
        </header>
        <footer data-role="footer">
        </footer>
    </div>

    <!-- load scripts here (jquery, kendo, etc.) -->

    <script>
        var app;

        $(document).ready(function () {
            app = new kendo.mobile.Application(document.forms, {
                layout: "mMasterLayout"
            });
        });
    </script>
</body>
</html> 
```

**使用母版页文件的其他页面：**

```
<asp:Content>
    <!-- View -->
    <div data-role="view">    
        <!-- Content -->
        <div data-role="content">
            .
            .
            .
        </div>
    </div>
</asp:Content> 
```

因此，检查 DOM 我没有发现任何错误，并且 Kendo 正在正确渲染。问题是，我的屏幕是空白的（只看到正文背景颜色）。在 DOM 中，要显示的预期视图实际上是可见的。

有人有什么想法可以帮忙吗？我觉得针对 Kendo 的表单容器来呈现我的视图是罪魁祸首，但我不确定。我还尝试继承 body 标签的宽度和高度，看看是否有帮助，但它什么也没做。

另外，请注意我必须让它以这种方式工作，因为解决方案没有设置为 MVC，所以没有 MVVM 或类似的东西是可能的。

我正在使用 Kendo UI Mobile 和 JQuery 的最新版本。谢谢！

**更新：**

在我的母版页文件中硬编码标签的固定高度`form`确实会产生我想要的视图内容。我想剩下的问题是..将此表单标签扩展到文档正文高度的最佳方法是什么..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:03:12.703

找到了我自己的解决方案 - 将以下 CSS 属性添加到母版页文件：

`html { height: 100%; }`

# arduino - ATtiny 阵列更新错误

> ID：14408191
> 
> 赞同：1
> 
> 时间：2013-01-18T21:47:28.760
> 
> 标签：arduino, avr

我正在使用 Arduino 使用[arduino-tiny core](http://code.google.com/p/arduino-tiny/)编程的 ATTiny85 进行视觉持久性显示。

它由一根带有 16 个 LED 的棒组成，它可以快速旋转以在空中“画”出一幅画。显示缓冲区由一个数组表示，每次定时器触发时都会输出其下一个索引。它使用连接到 INT0 的霍尔传感器来检测上死点，并将阵列索引归零。

它是一个 8 位处理器，我有 16 个 LED 连接到 LED 驱动器，所以我实际上使用两个阵列进行显示。

所以奇怪的是，当我用十字图案初始化显示时，它显示了一堆虚线；所以我先把它归零，以防内存中有一些随机的东西。现在它不显示任何东西（即使我在将其归零后直接将十字图案写入它）。我不知道发生了什么，有什么想法吗？

我之前让它只输出索引值，它跟踪的图片看起来像计数二进制，所以我认为硬件正在工作。

请注意，我没有使用 digitalWrite，因为它禁用了可能会导致计时中断的中断。

这是代码：（对不起，很多）

```
#define COLUMNCOUNT 180

const int datapin = 4;
const int clockpin = 0;
const int latchpin = 1;
const int rxpin = 3;
const int hallpin = 2;

volatile int columns0[COLUMNCOUNT];
volatile int columns1[COLUMNCOUNT];
volatile int counter = 0;

void setup()
{
  pinMode(datapin, OUTPUT);
  pinMode(clockpin, OUTPUT);
  pinMode(latchpin, OUTPUT);
  pinMode(rxpin, INPUT);
  pinMode(hallpin, INPUT);

  //make sure the arrays are all zeroed
  for (int i = 0; i < COLUMNCOUNT; i++)
  {
    columns0[i] = 0;
    columns1[i] = 0;
  }

  //make a cross pattern
  columns0[0] = 255;
  columns1[0] = 255;
  columns0[45] = 255;
  columns1[45] = 255;
  columns0[90] = 255;
  columns1[90] = 255;
  columns0[135] = 255;
  columns1[135] = 255;

  //turn on the timer (prescale CK/16)
  OCR1A = 255;
  OCR1C = 255;
  TCNT1 = 0;
  TIMSK = _BV(OCIE1A);
  TCCR1 = _BV(CTC1) | _BV(CS12) | _BV(CS10);

  GIMSK = _BV(INT0);

  sei();
}

void loop()
{
  //nothing to do here
}

ISR(TIMER1_COMPA_vect)
{
   if (counter < COLUMNCOUNT)
     counter++;

   outputWord(columns0[counter], columns1[counter]);
}

ISR(INT0_vect)
{
  counter = 0;
}

void outputByte(int b)
{
  int currentBit;

  for (int i = 0; i < 8; i++)
  {
    currentBit = (b & 128) == 128;
    PORTB = _BV(clockpin) | (currentBit ? _BV(datapin) : 0);
    PORTB = PORTB ^ _BV(clockpin);

    b <<= 1;
  }
}

void outputWord(int hi, int lo)
{
  outputByte(hi);
  outputByte(lo);
  PORTB = _BV(latchpin);
  PORTB = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:23:34.433

我已经弄清楚了：这是一个 SRAM 问题。ATtiny85 只有 512 字节的 SRAM，因此它不能同时将所有数据保存在内存中。[我正在研究使用PROGMEM](http://arduino.cc/en/Reference/PROGMEM)指令将数据存储在闪存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T22:29:38.967

根据 C 标准，全局变量初始化为 0。因此，

```
//make sure the arrays are all zeroed
for (int i = 0; i < COLUMNCOUNT; i++)
{
  columns0[i] = 0;
  columns1[i] = 0;
} 
```

没有必要。`__do_clear_bss`执行该部分时会自动处理该操作。

此外，根据 C 标准，int 类型必须至少为 16 位宽。在 AVR 中，使用最小值。如果您使用的是免费软件工具链，它包含`inttypes.h`提供的功能`stdint.h`和一些额外的东西。这在另一个答案中提到。

该声明：

```
PORTB = PORTB ^ _BV(clockpin); 
```

可以改写为：

```
PINB = _BV(clockpin); 
```

根据 Atmel 的数据表，它只编译为 1 条指令。

提供的宏`pgmspace.h`可以从闪存中读取。请注意，您无法更改闪存的内容，因为您的程序在大多数 AVR 芯片中运行。

处理这么多数据时要小心局部/全局变量和堆栈/堆冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T22:58:52.467

我还在使用 Attiny44 进行视觉持久性 (POV)。（我通过 Arduino 作为 ISP 对其进行编程）

用户 Ben Jackson 关于保存 SRAM 内存的提示很明确：我最初使用“int”作为我的数组，如果我尝试包含其他数组，我的 Attiny 会出错 - 但是，当我简单地将所有数组声明为“无符号”时char" 的代码运行得非常好！

下次我将订购 attiny45 或类似的以获得更多 SRAM 内存，并继续使用 unsigned char 进行我的数组声明。谢谢小伙伴们的讨论！

# facebook - 刷新页面时的 FB.login(function(response) /me 不更新

> ID：14408193
> 
> 赞同：0
> 
> 时间：2013-01-18T21:47:31.307
> 
> 标签：facebook, login

我有一个大问题，我试图解决好几天但无法解决。

我得到了以下代码来登录 Facebook 上的应用程序。一切都运行良好，除了当页面重新加载时（使用 window.location.reload();）它没有更新 API /me，所以它总是返回登录按钮。

例外：当我单击 F5 刷新页面时，它运行良好

如果有人可以提供帮助，将不胜感激

谢谢

```
 <?php

require 'facebook.php';

 // Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
'appId'  => 'xxxxxxxxxxxx',
'secret' => 'xxxxxxxxxxxxx',));

$user = $facebook->getUser();

 // login or logout url will be needed depending on current user state.
if ($user) {
$logoutUrl = $facebook->getLogoutUrl();
 } else {
 $loginUrl = $facebook->getLoginUrl();
 }

 $user = $facebook->getUser();
 // Session based API call.
if ($user) {
  try {
    $me = $facebook->api('/me');
} catch (FacebookApiException $e) {
    echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
     $user = null;
}
}

?>
<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
 <title>test full name and photo</title>
 </head>
<body>
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
    FB.init({
        appId      : '<?php echo $facebook->getAppId(); ?>', // App ID
        channelURL : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        oauth      : true, // enable OAuth 2.0
        xfbml      : true  // parse XFBML
    });

    // whenever the user logs in, we refresh the page
    FB.Event.subscribe('auth.login', function() {
      window.location.reload();
    });

};

(function() {
    var e = document.createElement('script');
    e.src = document.location.protocol + '//connect.facebook.net/fr_CA/all.js';
    e.async = true;
    document.getElementById('fb-root').appendChild(e);
}());

 function fbLogin() {
        FB.login(function(response) {
      if (response.status == 'connected') {
                window.location.reload();            }
      else {
        alert('Try to connect');
        }
    }, {scope: 'email,user_likes'});
    }
  </script>

<?php if ($user): ?>
USER LOGGIN

<?php else: ?>
<div>
 Connexion button: <INPUT TYPE="BUTTON" ONCLICK="fbLogin()" value="login">
</div>
<?php endif ?>

<?php if ($user): ?>
    <?php $uid = $me['id']; ?>
    <div align="center">
        <img id="image" src="https://graph.facebook.com/<?php echo $uid; ?>/picture" />
        <div id="name"><?php echo $me['name']; ?></div>
        <div id="name">UID: <?php echo $me['id']; ?></div>
        <div id="name">Courriel <?php echo $me['email']; ?></div>

    </div>
<?php endif ?>
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T09:43:31.773

`FB.login`不返回，**这**`response.status`是返回的[`FB.getLoginStatus`](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)。另请参阅[`FB.login`文档](https://developers.facebook.com/docs/reference/javascript/FB.login/)以获取更多信息。

# image - 如何在两个进程之间共享深度图像？

> ID：14408197
> 
> 赞同：2
> 
> 时间：2013-01-18T21:47:39.560
> 
> 标签：image, matlab, boost, kinect, shared-memory

我有 4 种不同的深度相机可供使用：Kinect、Xtion、PMD nano、Softkinetic DepthSense。

我有知道如何阅读所有这些的库：OpenNI、PMD 驱动程序、Softkinetic 驱动程序。

理想情况下，我想为每种相机制作一个简单的抓取器，然后将其用作任何其他程序的插件，即快速、非冗余地访问数据流（即没有太多的内存副本）。

问题之一是，在许多情况下，我没有正确的 32 位或 64 位库，因此我无法在同一个项目中编译所有抓取器。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:47:39.560

我是一名研究人员，所以这个想法不一定对生产代码有用，但考虑到这种情况，我最好的解决方案是为每种类型的相机创建一个服务器进程。每个服务器进程都知道如何加载自己类型的摄像头流，然后将其扔到其他进程可以读取的共享内存空间中。显然可以使用不同类型的锁定机制，但我在下面的代码中没有任何锁定。

服务器进程将包括以下内容：

```
#define BOOST_ALL_NO_LIB

#include <boost/interprocess/shared_memory_object.hpp>
#include <boost/interprocess/mapped_region.hpp>
#include <boost/interprocess/sync/scoped_lock.hpp>
#include <boost/interprocess/sync/interprocess_mutex.hpp>

using namespace std;
using namespace boost::interprocess;

struct sharedImage
{
    enum { width = 320 };
    enum { height = 240 };
    enum { dataLength = width*height*sizeof(unsigned short) };

    sharedImage(){}   
    interprocess_mutex mutex;
    unsigned short  data[dataLength]; 
};

shared_memory_object shm;
sharedImage * sIm;
mapped_region region;

int setupSharedMemory(){
    // Clear the object if it exists
    shared_memory_object::remove("ImageMem");

    shm = shared_memory_object(create_only  /*only create*/,"ImageMem" /*name*/,read_write/*read-write mode*/);

    printf("Size:%i\n",sizeof(sharedImage));
    //Set size
    shm.truncate(sizeof(sharedImage));

    //Map the whole shared memory in this process
    region = mapped_region(shm, read_write);

    //Get the address of the mapped region
    void * addr  = region.get_address();

    //Construct the shared structure in the preallocated memory of shm
    sIm = new (addr) sharedImage;

    return 0;
}

int shutdownSharedMemory(){
    shared_memory_object::remove("ImageMem");
    return 0;
} 
```

启动呼叫`setupSharedMemory()`和关闭呼叫`shutdownSharedMemory()`。

在这个简单的例子中，所有的值都是硬编码的，但很容易想象使它更灵活。

现在让我们假设您正在使用 SoftKinetic 的 DepthSense。因此，您可以为 Depth 节点编写以下回调。

```
void onNewDepthSample(DepthNode node, DepthNode::NewSampleReceivedData data) {
    //scoped_lock<interprocess_mutex> lock(sIm->mutex); 
    memcpy(sIm->data, data.depthMap, sIm->dataLength);
} 
```

这样做只是将最新的深度图复制到共享内存空间中。您还可以添加时间戳和锁以及您需要的任何其他内容，但这个基本代码对我来说已经足够好了，所以我将保持原样。

现在在其他一些过程中，您可以以非常相似的方式访问数据。下面的代码是我用来将实时 SoftKinetic DepthSense 深度流导入 Matlab 进行实时处理的代码。与尝试专门为 SoftKinetic 编写我自己的 mex 包装器相比，这种方法具有巨大的优势，因为如果我为所有其他相机编写服务器，我可以对它们使用相同的代码。

```
#include <math.h>
#include <windows.h>
#include "mex.h"

#define BOOST_ALL_NO_LIB
#include <boost/interprocess/shared_memory_object.hpp>
#include <boost/interprocess/mapped_region.hpp>
#include <boost/interprocess/sync/scoped_lock.hpp>
#include <boost/interprocess/sync/interprocess_mutex.hpp>
#include <iostream>
#include <cstdio>
#include <cstdlib>

using namespace boost::interprocess;

struct sharedImage
{
    enum { width = 320  };
    enum { height = 240 };
    enum { dataLength = width*height*sizeof(short) };

    sharedImage(): dirty(true){}
    interprocess_mutex mutex;
    uint8_t  data[dataLength];
    bool  dirty;
};

void getFrame(unsigned short *D)
{      
    //Open the shared memory object.
    shared_memory_object shm(open_only ,"ImageMem", read_write);

    //Map the whole shared memory in this process
    mapped_region region(shm ,read_write);

    //Get the address of the mapped region
    void * addr = region.get_address();

    //Construct the shared structure in memory
    sharedImage * sIm = static_cast<sharedImage*>(addr);

    //scoped_lock<interprocess_mutex> lock(sIm->mutex);
    memcpy((char*)D, (char*)sIm->data, sIm->dataLength);
}

void mexFunction(int nlhs, mxArray *plhs[ ], int nrhs, const mxArray *prhs[ ])
{
    // Build outputs
    mwSize dims[2] = {320, 240};
    plhs[0] = mxCreateNumericArray(2, dims,  mxUINT16_CLASS, mxREAL);
    unsigned short *D = (unsigned short*)mxGetData(plhs[0]);
    try
    {
        getFrame(D);
    }
    catch (interprocess_exception &ex)
    {
        mexPrintf("getFrame:%s\n", ex.what());
    }
} 
```

在我的计算机上，我在 Matlab 中编译：`mex getSKFrame.cpp -IC:\Development\boost_1_48_0`

最后在 Matlab 中使用它：`D = getSKFrame()'; imagesc(D)`

# c# - 使用 System.Web.Security.Roles.CreateRole 时有什么需要注意的吗？

> ID：14408200
> 
> 赞同：0
> 
> 时间：2013-01-18T21:47:58.803
> 
> 标签：c#, security, asp.net-3.5

我意识到这是一个安全库，但我只想覆盖我的基础。假设我想使用类似的东西：

```
System.Web.Security.Roles.CreateRole(newRole.Text); 
```

哪里`newRole`是`<asp:Textbox>`。用户有什么办法可以通过该文本框将任何恶意内容注入我的数据库，或以其他方式破坏网站？Roles 类是否可以防止注入所有有害代码？我在 msdn 网站上看到有关于 javascript 漏洞的警告。这是否也只是通过成为 ASP .Net 来防止，还是我读错了？

[http://msdn.microsoft.com/en-us/library/system.web.security.roles.createrole(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.web.security.roles.createrole(v=vs.90).aspx)

谢谢！

# java - apache重定向后如何获取原始请求uri

> ID：14408203
> 
> 赞同：2
> 
> 时间：2013-01-18T21:48:21.770
> 
> 标签：java

apache代理java代码中的url后是否可以获取原始请求uri？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-18T22:42:39.443

看看你的请求的 HTTP 标头 [1] 像 X-Forwarded-For 这样的标头可能包含客户端的 IP 地址，X-Forwarded-Host（客户端在 Host HTTP 请求标头中请求的原始主机）， X-Forwarded-Server（代理服务器的主机名）。有关更详细的说明，请参阅 mod_proxy 文档 [1]。

[1] [http://httpd.apache.org/docs/2.2/mod/mod_proxy.html](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)

# gwt - 需要下载谷歌显然删除的 GWT eclipse 插件版本 3.5

> ID：14408205
> 
> 赞同：0
> 
> 时间：2013-01-18T21:48:30.740
> 
> 标签：gwt, eclipse-plugin

谷歌似乎取消了 GWT（2.4 版）的 Eclipse 插件（3.5 版），因为它太旧了。我在 Google 社区网站上发现了一个这样的帖子。

我有一些旧软件必须修复，升级任何软件都是不可能的，没有人想过存档 Eclipse 插件。这最初是在[http://dl.google.com/eclipse/plugin/3.5](http://dl.google.com/eclipse/plugin/3.5)

有人可以帮我找到这个吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:10:35.433

你在运行 Eclipse 伽利略吗？较新的版本可能不会将其视为该 Eclipse 版本的有效插件。

# sharepoint - Sharepoint 2010 - caml 查询性能预期

> ID：14408206
> 
> 赞同：2
> 
> 时间：2013-01-18T21:48:33.580
> 
> 标签：sharepoint, spmetal

在 Sharepoint 2010 中查询一个非常大的列表时，我应该期望的合理性能水平是多少？我的清单只有 1000 项，在查看了 Sharepoint 性能注意事项几天后，我仍然无法确定一个好的性能基准应该是什么。

我正在处理的一个项目是使用 Sharepoint 2010 启动和设计的，其列表布局结构为关系数据库。我认为最初的期望是使用 Sharepoint 来利用开箱即用的搜索和版本控制功能，并使用 spmetal 和存储库模式进行数据检索。我在负载下的表现很糟糕（或者我认为这将是糟糕的表现，因为我习惯于使用 sql server）。使用 spmetal 和 20-30 个用户对 1000 个项目的列表进行查询需要 10-15 秒才能加载。我决定直接去看看我能得到什么。下面是代码。

```
SPQuery query = new SPQuery();
query.Query = "<View><ViewFields><FieldRef Name=\"ID\" /></ViewFields></View>";
query.ViewFieldsOnly = true;
query.RowLimit = 1000;
SPList list = web.Lists["Incidents"];
var items = list.GetItems(query).OfType<SPListItem>().ToArray(); 
```

项目数：1000 平均时间：1197 毫秒

这是很好的表现吗？这只是一个电话，同时没有对事件列表的其他查询..没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:52:20.170

是的，这是平均性能，至少对于多合一农场来说是这样。

# c# - 创建“冻结窗口”效果

> ID：14408211
> 
> 赞同：1
> 
> 时间：2013-01-18T21:49:04.567
> 
> 标签：c#, wpf, winforms

您知道当您有一个窗口被冻结时，但是当您将另一个窗口拖到顶部时它会留下痕迹？有时它看起来有点像 Windows 3 纸牌的结束 :) 当你完成时（如我的屏幕截图）。

我想制作一个 C# windows (winforms/wpf) 应用程序来创建这样的表面并允许我捕获图像，但我有点不知从何开始。

图片： ![几乎看起来像纸牌](../Images/a1801dabfc1659d5249d37d32cb8424f.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:55:03.550

**使用WPF**会更容易。您可以从任何控件创建 a `VisualBrush`，包括 a`Window`或`FrameworkElement`。一旦你有了它`VisualBrush`，你可以在你的表单上涂上它，它会产生同样的效果。`ImageBrush`或者，如果你想用图片而不是 UI 元素来做，你可以使用。

当你绘画时，每次只需将它偏移几个 X/Y，它就会看起来就像那样，因为它会覆盖（er.. overpaints？）自己！

您可以创建自己的`FrozenVisualHost`派生类，`FrameworkElement`以托管`DrawingVisual`您呈现的 a。请参阅：[MSDN：使用 DrawingVisual 对象](http://msdn.microsoft.com/en-us/library/ms742254.aspx)

覆盖您的`FrozenVisualHost.OnRender()`方法将允许您在记录鼠标移动时绘制“冻结快照”（通过`MouseMove`）。只需确保调用该`InvalidateVisual()`方法来更新主机控件即可。

一个警告：`VisualBrush`从窗口创建一个**不会**捕获标题栏或窗口边框镶边。如果需要，您必须手动获取快照 (GDI)：如此[处所述](http://blog.developers.ba/post/2009/09/03/Screenshot-your-WPF-application.aspx)。但是，您可以将其`Bitmap`用于您的`ImageBrush`并进行类似的渲染。

# c++ - 如何改进此模板以在 VS2012 中接受 lambda

> ID：14408212
> 
> 赞同：1
> 
> 时间：2013-01-18T21:49:15.500
> 
> 标签：c++, templates, boost, visual-studio-2012

以下是我经常使用的可爱小模板。简单地告诉我给定元素是否是集合的成员（它本身必须与 find_if 模板兼容）：

```
// returns true if a given collection contains the given element
// NOTE: This is NOT optimized for associative containers!
template <typename ELEMENT, typename COLLECTION, typename PREDICATE>
bool contains(const COLLECTION & collection, ELEMENT element, PREDICATE predicate)
{
    return collection.end() != std::find_if(collection.begin(), collection.end(), boost::bind(predicate, element, _1));
} 
```

如果我尝试使用 lambda 作为谓词，我发现 VC2012 会犹豫：

```
if (!contains(specs, str, [] (CString pathname, CString pattern) { return AsBool(PathMatchSpec(pathname, pattern)); }))
    continue; 
```

VS2012SP1 为上述上下文吐出以下内容：

```
1>c:\users\steve\projects\cimex cad-cam\15.0\3rd party\boost\boost\bind\bind.hpp(69): error C2039: 'result_type' : is not a member of 'CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>'
1>          c:\users\steve\projects\cimex cad-cam\15.0\cimex application\cimcad\macro directory.cpp(166) : see declaration of 'CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>'
1>          c:\users\steve\projects\cimex cad-cam\15.0\3rd party\boost\boost\bind\bind_template.hpp(15) : see reference to class template instantiation 'boost::_bi::result_traits<R,F>' being compiled
1>          with
1>          [
1>              R=boost::_bi::unspecified,
1>              F=CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>
1>          ]
1>          c:\users\steve\projects\cimex cad-cam\15.0\mfc toolbox\miscellaneous.h(360) : see reference to class template instantiation 'boost::_bi::bind_t<R,F,L>' being compiled
1>          with
1>          [
1>              R=boost::_bi::unspecified,
1>              F=CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>,
1>              L=boost::_bi::list2<boost::_bi::value<CString>,boost::arg<1>>
1>          ]
1>          c:\users\steve\projects\cimex cad-cam\15.0\cimex application\cimcad\macro directory.cpp(166) : see reference to function template instantiation 'bool contains<CString,substring_container_adapter,CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>>(const COLLECTION &,ELEMENT,PREDICATE)' being compiled
1>          with
1>          [
1>              COLLECTION=substring_container_adapter,
1>              ELEMENT=CString,
1>              PREDICATE=CMacroInterpreter::GetDirectoryOf::<lambda_60eac39ee69a5bdc77e08d06d79ae4c4>
1>          ] 
```

我不清楚如何强迫事物接受谓词 lambda。似乎 boost 无法推断出 lambda 的返回类型。我不清楚我能做些什么来解决这个问题？

我可以定义一个本地 std::binary_function 导数函子。似乎修复 contains<> 以允许它直接处理 lambda 会更好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:01:14.020

这似乎是一个问题`boost::bind`。相反，使用`std::bind`VS2012 中的 lambda，您的代码可以很好地构建：

```
#include <functional>
#include <algorithm>
#include <vector>

template <typename ELEMENT, typename COLLECTION, typename PREDICATE>
bool contains(const COLLECTION & collection, ELEMENT element, PREDICATE predicate)
{
    return collection.end() != std::find_if(collection.begin(), collection.end(), std::bind(predicate, element, std::placeholders::_1));
}

std::vector<int> a;

int main()
{
    a.push_back(1);
    a.push_back(2);
    a.push_back(3);
    a.push_back(42);
    bool c = contains(a, 42, [](int a, int b) { return a == b; });
    return 0;
} 
```

同样的代码也可以很好地构建`g++`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:05:50.933

您总是可以尝试使用另一个 lambda：

```
template <typename ELEMENT, typename COLLECTION, typename PREDICATE>
bool contains(const COLLECTION & collection, ELEMENT element, PREDICATE predicate)
{
    typedef typename COLLECTION::value_type VALUE;

    return collection.end() != std::find_if(collection.begin(), collection.end(),
      [&]( VALUE const & e ){ return predicate( element, e ); });
} 
```

# php - 我们可以使用 IN 语句在多个查询中分解 SQL 连接吗

> ID：14408217
> 
> 赞同：2
> 
> 时间：2013-01-18T21:50:03.067
> 
> 标签：php, sql, join, orm

No`orm 的创建者表明，可以将 3 个表的连接分解为 3 个更快的查询：[http](http://www.notorm.com/#performance) ://www.notorm.com/#performance 。

您认为通过将 ID 放在 IN 语句中可以避免连接和使用多个查询吗？

由于上述原因，那个库（NoORM）不支持连接，你认为我可以放弃使用连接而只使用那个库吗？对我来说很奇怪避免加入是如此容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:57:14.877

对于相对小规模的应用，这可能是可行的。但是在您可能传递许多参数的情况下（相当于您在许多行上匹配的连接条件），这将使您失败。我能想到的最好的例子是 Informix 的一个限制，例如，（我不知道最新版本是否如此）准备好的语句不允许超过 20 个（不准确）左右的参数要通过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:21:40.560

在单个查询上使用连接的一个原因是它允许数据库的优化器根据现有数据为所涉及的表提出最佳计划。如果您将一个联合查询分解为单独的查询，您实际上是在对执行计划进行硬编码。除其他外，这假设您在编写代码时将花一些时间考虑查询的选择性，并且选择性将在应用程序的生命周期内保持不变。在我看来，这些都是相当大的假设。

此外，如果您将数据库用作不只是一个愚蠢的容器，您可能会发现有些查询不会那么容易分解为单个查询（例如，几乎在您使用聚合函数的任何时候）。

# c# - 检查值 2 秒

> ID：14408220
> 
> 赞同：-5
> 
> 时间：2013-01-18T21:50:10.210
> 
> 标签：c#

我有一个整数，其值会发生变化，我想知道是否有办法检查该值是否在 2 秒内相同。

比如如果 num = 2 for 2 sec then Messagebox.show("for 2 sec");

因为我的数字会立即改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:55:42.773

如何让它跟踪上次更改的时间？

```
int _num;

public int num
{
    get { return _num; }
    set 
    {
        if(value != _num)
        {
            _num = value;
            numModified = DateTime.Now;
        }
    }
}

public DateTime numModified { get; private set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:54:36.997

考虑实现`INotifyPropetyChanged`接口`System.ComponentModel`-[这里是示例的描述](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:56:37.053

这可能是多余的，我喜欢使用[DispatcherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)。这将每 2 秒打勾以查找更改：

```
private DispatcherTimer _checkNumberTimer = null;
private int _myNumber = int.MinValue;
private int _lastValue = int.MaxValue;

public Constructor1(){
  _checkNumberTimer = new DispatcherTimer();
  _checkNumberTimer.Tick += new System.EventHandler(HandleCheckNumberTick);
  _checkNumberTimer.Interval = new TimeSpan(0, 0, 0, 2); //Timespan of 2 seconds
  _checkNumberTimer.Start();
}

private void HandleLoginOrderDispatcherTick(object sender, System.EventArgs e) {
  if(_myNumber == _lastValue){
    MessageBox.Show("Alert!");
    _checkNumberTimer.Stop(); //If you want
  }
  _lastValue = _myNumber;
}

private void SomeOtherCodeAffectingMyNumber(int something){
  _myNumber = something;
} 
```

您需要包括`System.Windows.Threading`.

DispatcherTimer 的好处是它可以处理所有委托给 UI 线程的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:57:05.497

Try to create a `property`, a `Bool`, buffer and a `Timer`. Now change the `setter` like this:

```
 public int Variable
    {
        get { return _variable; }
        set
        {
            yourtimer.Stop();
            IsLongerThanTwoSec = false;
            _variable = value;
            yourtimer.Start();
        }
    } 
```

Create a `timer` like this and set this `.Elapsed`:

```
 bool IsLongerThanTwoSec = false;
        Timer timer = new Timer(2000);
        timer.Elapsed += (e, s) => IsLongerThanTwoSec = true; 
```

if IsLongerThanTwoSec is `false` it is not; otherwise, it is.

# php - 两个从属下拉列表，其中包含两个不同表中的值

> ID：14408223
> 
> 赞同：0
> 
> 时间：2013-01-18T21:50:39.337
> 
> 标签：php, yii

我需要在我的页面中显示两个相关的下拉列表。如果我们从第一个下拉列表中选择一个项目，根据我们选择的项目，它应该过滤第二个下拉列表中的条目，然后我需要使用第二个下拉列表中的值执行搜索. 但问题是来自表格的值显示在第一个下拉列表中不是它的活动记录。有人可以帮忙吗？

目前我有第二个下拉列表，它可以根据所选值执行搜索。现在我需要做的是在其上方放置一个下拉列表并根据第一个下拉列表过滤项目。

## 编辑

第一个表 - client_id，client_name - 第一个下拉列表中的项目应显示客户端名称

第二个表 - program_id，client_id，program_name -

第三个表 - ad_id、program_id、ad_name - 第二个下拉列表应显示使用 client_id 过滤的 ad_names。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T22:17:03.323

最后我做到了，就是这样。

在我的控制器中，

```
public function actionDynamicDropdownList()
   {
    if($_POST['client_id'] > '0') {
        $result = Yii::app()->db->createCommand()->select('program_id, program_name')->from('program')->where('client_id='.$_POST['client_id'].'')->order('program_name')->queryAll();
        $this->render('admin', array(
            'result' => $result,
        ));
      }
}
public function actionDynamicProgramsList()
{
    if($_POST['program_id'] > '0') {
        $results = Yii::app()->db->createCommand()->select('ad_id, ad_name')->from('ads')->where('program_id='.$_POST['program_id'].'')->order('ad_name')->queryAll();
        $this->render('admin', array(
            'results' => $results,
        ));
    }
} 
```

在我看来，我添加了

```
<?php
$data = Yii::app()->db->createCommand()->select('client_id, client_name')->from('client')->order('client_name')->queryAll();
echo CHtml::dropDownList('client_id', '',CHtml::listData($data,'client_id','client_name'), array(
'empty'=>'- Select Client Name -',
'ajax'=> array(
'type'=>'POST',
'url'=>Yii::app()->baseUrl.'/index.php?r=page/dynamicDropdownList',
'update'=>'#program_id'))); 

//empty since it will be filled by the above dropdown
echo CHtml::dropDownList('program_id','', CHtml::listData($result,'program_id','program_name'), array(
'empty'=>'- Select Program Name - ',
'onchange'=>'alert(this.value);',
'ajax'=> array(
'type'=>'POST',
'url'=>Yii::app()->baseUrl.'/index.php?r=page/dynamicProgramsList',
'update'=>'#ad_id')));
    //empty since it will be filled by the above dropdown
echo CHtml::dropDownList('ad_id','', CHtml::listData($results,'ad_id','ad_name'), array(
'empty'=>'- Select Ad Name - ',

));
?> 
```

# javascript - 如何将 JS 函数的结果解析为 SVG 对象？

> ID：14408240
> 
> 赞同：0
> 
> 时间：2013-01-18T21:52:01.153
> 
> 标签：javascript, parsing, svg, call, geometry

```
<script type="text/ecmascript">
<![CDATA[
function setCoordinates(evt) {
var centerX = Math.round(Math.random() * 1000);
var centerY = Math.round(Math.random() * 1000);      
evt.target.setAttributeNS(null,"cx",centerX);
evt.target.setAttributeNS(null,"cy",centerY);
}
]]>
</script> 
```

那是我的职责。我真的很困惑如何将结果解析（不确定这是否是正确的词）到一个圆圈中的属性。

假设我的圈子如下：

```
<circle cx="0" cy="0" r="10" fill="red" /> 
```

调用该函数并将属性值解析为圆圈所需的 Javascript 是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:59:03.920

我不认为你想要一个事件参与。你可能想要类似的东西

```
function setCoordinates(circle) {
  var centerX = Math.round(Math.random() * 1000);
  var centerY = Math.round(Math.random() * 1000);      
  circle.setAttribute("cx",centerX);
  circle.setAttribute("cy",centerY);
} 
```

（`setAttributeNS()`如果您仍然使用命名空间，则不需要`null`。）

如果你给你的圈子一个 ID，比如

```
<circle cx="0" cy="0" r="10" fill="red" id="myCircle"/> 
```

然后您可以使用以下代码更改坐标

```
setCoordinates(document.getElementById("myCircle")); 
```

# database - 从 Apache cassandra 读取数据的问题

> ID：14408242
> 
> 赞同：0
> 
> 时间：2013-01-18T21:52:09.747
> 
> 标签：database, nosql, cassandra

我在使用 apache cassandra 时遇到了一些麻烦。我已经尝试解决这个问题好几个星期了。

这是我的设置。我有 2 台运行 apache cassandra 的计算机（让我们称之为计算机 C1 和计算机 C2），我创建了一个复制因子为 2 的密钥空间。这样每台计算机都有一个数据的本地副本。

我有一个程序可以读取大量数据，例如大约 500MB。

场景 1）假设只有计算机 C1 正在运行 cassandra，我在计算机 C1 上运行读取程序，然后此读取发生半分钟到一分钟。

场景 2) 我现在在计算机 C2 上启动 cassandra 实例并再次在计算机 C1 上运行读取程序 - 现在需要很长时间才能完成，大约 20 分钟。

我不确定为什么会这样。读取一致性设置为“一”

**预期表现**

理想情况下，计算机 C1 和 C2 上的读取程序必须快速完成。这应该是可能的，因为两台计算机都有数据的本地副本。

谁能指出我正确的方向？非常感谢您的帮助，谢谢

**更新：网络使用**

这可能意义不大，但我使用 nethogs 监控互联网连接，当两个 cassandra 节点都启动时，我读取数据库，cassandra 使用带宽与另一个节点通信 - 大概这是在后台发生的读取修复我使用了读取一致性级别“一”，在我的情况下，具有所需数据的最近节点是本地计算机的 cassandra 实例（所有节点都有所有数据） - 所以数据源应该来自本地计算机。 .

**更新：SQLTransentExceptions：TimedOutException()**

然而，当两个节点都启动时，读取数据库的程序有几个 SQLTransentExceptions：TimedOutException()。我使用 10 秒的默认超时。但这引发了一个问题，即当所有数据检索都应该来自本地实例时，为什么 SQL 语句会超时。此外，如果只有一个节点启动，则相同的 SQL 代码运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:41:20.567

没有“ANY”的读取一致性（仅适用于写入）。最低读取一致性为 ONE。您需要检查您的读取一致性到底是什么。

也许您的配置设置为读取需要从两个服务器获取数据（如果两者都已启动），并且从 C2 获取数据到 C1 的速度非常慢。

强制将您的读取一致性级别设置为“ONE”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:04:21.610

您似乎有令牌冲突，在您的情况下，这意味着两个节点都拥有 100% 的密钥。您需要做的是重新分配其中一个节点，使其拥有一半的令牌。使用`nodetool move`(使用令牌 85070591730234615865843651857942052864) 后跟`nodetool cleanup`.

缓慢的速度很可能来自高网络延迟，当您的所有事务（某些子集实际上超时）相乘时，会导致相应的大量工作时间。许多客户端库使用自动节点发现来了解新节点或停机节点，然后跨可用节点循环请求。因此，即使您只告诉它有关 localhost 的信息，它也可能会自行了解其他节点。

在节点必须通信的任何分布式计算环境中，网络延迟和可靠性是一个巨大的因素，必须加以处理。

# clojure - 在函数中使用带列表的引号

> ID：14408244
> 
> 赞同：1
> 
> 时间：2013-01-18T21:52:12.750
> 
> 标签：clojure

我一定对如何定义函数有误解。我正在做这个 SICP 练习，“定义一个以三个数字作为参数并返回两个较大数字的平方和的过程。”

我在 REPL 中尝试了这个，它似乎有效：

```
=> (reduce + (map (fn [x] (* x x)) (rest (sort '(2 1 0)))))
5 
```

但是定义一个过程并用参数替换数字会给我一个错误：

```
=> (defn my-procedure [a b c] (reduce + (map (fn [x] (* x x)) (rest (sort '(a b c))))))
ClassCastException clojure.lang.Symbol cannot be cast to java.lang.Number clojure.lang.Numbers.multiply (Numbers.java:146) 
```

我没看到什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:55:20.730

这应该适合你：

```
(defn my-procedure [a b c]
  (reduce + (map (fn [x] (* x x)) (rest (sort (list a b c)))))) 
```

这就是为什么：

当您使用[报价表单](http://clojure.org/special_forms#Special%20Forms--%28quote%20form%29)时，不会评估表单，也不会解析您的变量。在您的情况下，您会得到一个符号列表。

```
user=> (def a 1)
#'user/a
user=> '(a)
(a)
user=> (list a)
(1)
user=> `(a) ;; backtick causes vars to be namespace qualified
(user/a)
user=> (class (first '(a)))
clojure.lang.Symbol 
```

`list`您应该使用函数或其他集合，而不是创建未评估的表单

```
user=> [a] ;; vector
[1]
user=> #{a} ;; set
#{1}

;; (defn sum-of-squares [& args]
;;   (apply + (map #(* % %) args))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:19:31.850

自动将函数的参数放入集合中：

```
(defn foo [& x]
  (reduce + (map #(* % %) (rest (sort x))))) 
```

# c# - 有没有办法使用 json.net 序列化嵌入对象

> ID：14408245
> 
> 赞同：0
> 
> 时间：2013-01-18T21:52:12.993
> 
> 标签：c#, .net, serialization, foreign-keys, json.net

我正在尝试使用 JSON.Net 模拟外键行为，但我似乎无法找到获得真实引用的方法。

假设我有这个简单的例子：

```
private static void Main(string[] args)
        {
            var g1 = new Group {Name = "g1"};
            var g2 = new Group {Name = "g2"};

            var users = new[]
            {
                new User{ Username = "truc", Group = g1 },
                new User{ Username = "machin", Group = g2 },
                new User{ Username = "dom", Group = g2 },
                new User{ Username = "boum", Group = g2 }
            };

            string json = JsonConvert.SerializeObject(users);

            var jsonUsers = JsonConvert.DeserializeObject<User[]>(json);

            Console.WriteLine(jsonUsers[2].Group == jsonUsers[3].Group);

            Console.ReadLine();
        } 
```

这里的问题是它`Console.WriteLine(jsonUsers[2].Group == jsonUsers[3].Group);`总是错误的。

我发现使它起作用的唯一方法是存储用户列表，然后是组列表并在用户内部具有 GroupId 属性。然后在所有内容都反序列化后，我手动在用户内部插入组的引用。这很骇人听闻。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:56:25.767

您正在进行实例比较。你应该覆盖`Equals`和上课`GetHashcode`。`Group`运算符重载也很好，因为您`==`在 Console.WriteLine 中使用运算符

除此以外;

```
new Group() { Name = "a" } == new Group() { Name = "a" } 
```

或者

```
new Group() { Name = "a" }.Equals(new Group() { Name = "a" }) 
```

总是返回**false**

.

```
public class Group
{
    public string Name;
    public int i;

    public static bool operator ==(Group a, Group b)
    {
        return a.Equals(b);
    }

    public static bool operator !=(Group a, Group b)
    {
        return !(a.Name == b.Name);
    }

    public override bool Equals(object obj)
    {
        var g = obj as Group;
        if (ReferenceEquals(this,g)) return true;
        return g.Name.Equals(Name);
    }

    public override int GetHashCode()
    {
        return Name.GetHashCode();
    }
} 
```

# jquery - 从 DOM 中删除违规元素时，无效的表单不会重新计算其有效性

> ID：14408246
> 
> 赞同：2
> 
> 时间：2013-01-18T21:52:14.527
> 
> 标签：jquery, forms, dom, validation, angularjs

我`ctrl.$setValidity`在我的一个指令中使用使表单无效。但是，有一种方法存在于其他地方，可以在不同的条件下从 DOM 中删除该元素。当我使表单无效`$setValidity`然后删除有问题的元素时会发生什么是表单仍然无效，而我希望它做的是根据其新的 Inputfield 集重新计算其有效性。

请注意，我不只是在寻找`ctrl.$setValidity true`, （表单中的其他输入字段可能有效也可能无效），我只是希望表单重新计算。

以下是指令代码：

```
 app.directive('dir', function() {
   return {
      restrict: 'C',
      require: "ngModel",
      link: function(scope, element, attrs, ctrl) {
      someValue = scope.someValue;
      someField = element.find(".some-class");

      monitorField = function(newValue, oldValue){
        console.log("whee");
        scope.someFunction(newValue);
        if(newValue =="Invalidate NOW!"){
        ctrl.$setValidity('someClass', false);      
        } else if (oldValue == "Invalidate NOW!"){
           angular.element(document.querySelector('.some-class')).remove();
        } else {
          ctrl.$setValidity('someClass', true); 
       }
    }  
    scope.$watch("someValue", monitorField, true);
   }
 }
}); 
```

运行于：

```
 <FORM class="dir" ng-model="someValue">
     <INPUT type="text" class="some-class" ng-model="someValue"/>
     <INPUT type="text" class="some-other-class"/>
   </FORM> 
```

（是的，这是一个有点做作的例子）。

问题在这里重现：http: [//jsfiddle.net/kTuAY/](http://jsfiddle.net/kTuAY/)

在我的实际代码中，我根据对象数组填充输入字段，这些对象通过 Service 填充，并通过 array.splice 删除元素。jsfiddle 中给出的示例只是为了简单起见。

在这个小提琴中可以看到另一个有趣的失败情况：

[http://jsfiddle.net/JACAv/](http://jsfiddle.net/JACAv/)

具体来说，如果其中一个输入依赖于值与另一个不冲突，因此无效，那么在更改其他字段值之后，有效性仍然不正确。

我上班时暂时不能正常工作的小提琴：

[http://jsfiddle.net/yQpHL/](http://jsfiddle.net/yQpHL/)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:27:59.190

如果可能，应该通过删除模型指向的 $scoped 对象的一部分来删除链接到模型的一部分的 DOM 元素。想想基本的 ngRepeat，如果你从数组中删除一个项目，它就会从 DOM 中删除一个元素。您的表单应该以相同的方式工作。这将防止这种情况发生。所有验证信息都包含在 $scope 中的模型中......就像这样： `$scope.myForm.model.$error.required`例如。如果您删除模型指向的 $scope 属性或数组项（例如`$scope.foo`或`$scope.items.splice(2,1)`，Angular 将知道（大概在下一个 $digest 期间）删除模型以及它的验证信息。

删除控制器或指令中的项目无关紧要，但应该从 $scope 中删除它，然后需要进行摘要以更新 UI 和验证。

我希望这会有所帮助，因为我觉得我偶然发现了我想说的话......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:09:00.237

我不认为问题出在指令中，而是在“其他”代码中

如果 DOM 元素删除是在响应“本机”事件时完成的 - 即拖放事件、ajax 事件或其他事件，则角度框架将不知道自己运行重新计算。在此代码中，完成更新后，您必须在适当的范围内调用 $scope.$apply()。

哦，我看到了你的小提琴......好的。让生活变得更轻松一些怎么样 - 为什么不使用 ng-show 属性来装饰它，而不是删除你的 DOM 元素，让 Angular 来处理其余的事情呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T09:38:52.567

我最终解决这个问题的方法是：

1.  在结束的数组上放置一个单独的监视表达式`ng-repeated`。
2.  在该监视表达式中，构造当前存在于与相关指令匹配的输入字段中的所有值的哈希。
3.  用 强制重置这些字段的值`.val()`，然后调用`$compile`内部字段以重新触发内部监视表达式
4.  在函数中添加控制器上的输入字段值（之前`ctrl.$setValidity`从内部指令调用的函数：
    *   验证输入值的次数是否为 1
    *   重置被 ng 重复的数组以包含哈希值

好的：

*   当删除一个元素时，外部监视（整个数组上的监视）触发，重新计算哈希，重置每个字段的值并重新验证
*   当检测到碰撞时，它会正确冒泡，将所有碰撞字段标记为无效，当碰撞被移除时，所有字段都重新验证

坏处：

*   每次数组更改时对每个字段调用 $compile 计算效率低下
*   由于内部 watch 表达式会在值更改时触发一次，而外部 watch 表达式调用 compile 时会触发一次，因此有效的`$digest`'s 的数量增加了一倍

清理代码后，我将整理一个代码示例。

# command-line - WiX 扩展命令行自定义操作未执行

> ID：14408247
> 
> 赞同：0
> 
> 时间：2013-01-18T21:52:14.217
> 
> 标签：command-line, wix, custom-action

我正在处理的应用程序的先前版本（连同它的安装程序）是由其他人编写的。我一直很难让更新功能正常工作，所以我想在安装之前卸载以前的版本，但在我确定安装会继续进行之后。

我显然做错了什么。我想从安装程序执行以下命令行，但在安装开始之前。当我运行安装程序时，应用程序会安装，但我的命令行没有执行。任何帮助，将不胜感激。

我要执行的命令行是：

```
start /wait MsiExec.exe /quiet /x{MyGuid-0F4A-4F53-8639-0BEE6018EAD6} 
```

我的 WiX XML 的相关部分：

```
<Property Id="QtExecCmdLine" Value="start /wait MsiExec.exe /x{MyGuid-0F4A-4F53-8639-0BEE6018EAD6}"/>
<CustomAction Id="UninstallOldVersion" BinaryKey="WixCA" DllEntry="CAQuietExec" Execute="immediate" Return="ignore"/>
<InstallExecuteSequence>
  <Custom Action="UninstallOldVersion" Before="InstallInitialize"/>
</InstallExecuteSequence> 
```

如果我从提示符执行命令，该命令将按预期工作。此外，在安装程序的编译或执行过程中，我没有收到任何错误或警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:56:01.663

由于 Windows Installer 内置的互斥锁会在计算机上一次强制执行一个安装事务，因此您尝试做的事情没有机会工作。

相反，您应该查看 MajorUpgrade 元素以创作删除先前版本的内容。

# solr - 是否可以在不重新索引的情况下更改 Solr 中的查询分析器？

> ID：14408248
> 
> 赞同：1
> 
> 时间：2013-01-18T21:52:18.523
> 
> 标签：solr

更改 Solr 字段的*查询*分析器是否需要我在查看结果之前重新索引所有数据。显然这对于*​​索引*分析器来说是正确的，但我可以在不需要重新索引的情况下更改查询分析器似乎是合理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:56:04.283

应该没事。只需重新加载核心或重新启动 Solr。我相信只要不更改字段的类型（例如整数等），您实际上也可以更改索引分析器。您只会在索引中拥有以旧方式索引的标记，这可能会很混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T19:35:21.437

不，如果您更改查询分析器，您不需要重新索引数据，但您仍然需要重新加载 SOLR 核心

```
http://localhost:8080/solr/admin/cores?action=RELOAD&core=core1 
```

检查此页面以了解重新加载核心命令的限制，[https://wiki.apache.org/solr/CoreAdmin#RELOAD](https://wiki.apache.org/solr/CoreAdmin#RELOAD)

# apache - mod_rewrite 条件不起作用

> ID：14408251
> 
> 赞同：0
> 
> 时间：2013-01-18T21:52:53.700
> 
> 标签：apache, mod-rewrite, url-rewriting

我正在尝试设置一个 apache URL 重写/重定向，它将从

```
http://<domain #1>/work/<domain #2>/***** 
```

至

```
http://<domain #1>/work/<domain #1>/***** 
```

我尝试了以下操作，但 rewritecond 在比较 2 个变量时不起作用。

```
RewriteCond %{HTTP_HOST} !$1 
RewriteRule /work/([^/]+)/(.*)$  /work/%{HTTP_HOST}/$2 [R=302,L] 
```

感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:11:35.953

`$1`在`RewriteCond`指令中没有任何意义。你可以尝试这样的事情：

```
RewriteCond expr "! '%{REQUEST_URI} -strmatch '/work/%{HTTP_HOST}*'"
RewriteRule /work/([^/]+)/(.*)$  /work/%{HTTP_HOST}/$2 [R=302,L] 
```

# ios - 呈现具有自定义大小的 UIViewController

> ID：14408252
> 
> 赞同：2
> 
> 时间：2013-01-18T21:53:07.650
> 
> 标签：ios, uiviewcontroller, popupwindow, window-resize

一段时间以来，我一直在用头撞墙。我有一个 iPad 应用程序，它使用 Master-Detail SplitViewController 作为其演示框架。我需要在应用程序首次加载时显示一个登录对话框，并使其具有自定义大小。我在主情节提要中创建了一个 UIViewController 场景，并在 DetailController 首次加载时加载了 VC。

我遇到的问题是我完全无法控制 VC 的大小。我已将其定义为 FormSheet，以纵向模式显示。我将演示文稿设置为 FormSheet。我尝试以几种不同的方式显式设置大小，但绝对没有任何效果。

根本问题是，由于所有这些，VC*总是*以全屏方式呈现为纵向。当我旋转到横向时，它会*保持*纵向模式，在左右两边留下空隙，并切断视图的顶部和底部。

这令人难以置信的令人沮丧，我真的不知道从哪里开始。有趣的是，在应用程序完全加载后，我使用水龙头呈现完全相同类型的 VC。它呈现精美，使用以下设置：

```
MyViewController *itemDetails;

itemDetails = [Globals.storyboard   instantiateViewControllerWithIdentifier:@"MyViewController"];

itemDetails.itemImage.image = imageView.image;
itemDetails.jewelryObject = jewelryObject;

itemDetails.delegate = self;

itemDetails.modalPresentationStyle = UIModalPresentationPageSheet;
itemDetails.modalTransitionStyle = UIModalTransitionStyleCoverVertical;

UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:itemDetails];

itemDetails.navigationItem.title = jewelryObject.itemDescription;

[navigationController setModalPresentationStyle:UIModalPresentationFormSheet];

[self presentViewController:navigationController animated:YES completion:nil];

navigationController.view.superview.autoresizingMask =
    UIViewAutoresizingFlexibleTopMargin |
    UIViewAutoresizingFlexibleBottomMargin;

navigationController.view.superview.frame = CGRectMake(
    itemDetails.view.superview.frame.origin.x,
    itemDetails.view.superview.frame.origin.y,
    540.0f,
    450.0f
    );
navigationController.view.superview.center = self.view.center;

self.itemDetails = itemDetails; 
```

我非常沮丧，我什至无法表达。尽管我非常喜欢为 iOS 编程，但偶尔也会有一些 WTF 时刻让我希望自己是个隐士。如果有人有任何“啊哈！” 他们可以给我的见解，我真的很感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:39:12.673

好的，所以... 这在技术上不受支持。没有官方的方式来呈现一定尺寸的东西。所以这个问题的真正答案是——[向苹果公司提交一份雷达](http://bugreport.apple.com)文件。

但是……这是可能的。但是，如果您不理解下面的代码，请不要使用它。它是这样的：

```
#import <objc/runtime.h>

UIViewController *viewControllerToPresent = /* ... */;
viewControllerToPresent.modalPresentationStyle = UIModalPresentationFormSheet;

Ivar instanceVar = class_getInstanceVariable([UIViewController class], "_formSheetSize");
if (instanceVar) {
    ptrdiff_t offset = ivar_getOffset(instanceVar);
    CGSize *offsetVCPtr = (CGSize*)(((uintptr_t)(__bridge void*)viewControllerToPresent) + offset);
    *offsetVCPtr = size;
}

// Present as usual with presentViewController:animated:completion: 
```

这很丑陋，但它有效。请注意，我不特别建议在 App Store 应用程序中执行此操作，因为您可能无法通过其中的类似内容进行审核。使用风险自负！请记住您问题的真正答案 - 现有 API 无法做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T11:36:47.877

好吧，我终于弄清楚了如何正确使用 UISplitViewController，所以所有这些与自定义 VC 一起跳舞的事情都是徒劳的。在详细控制器中设置了所有基本结构后，我调用 [UISplitViewController presentViewController:animated:completion]。

我真的搞砸了一段时间。但它现在起作用了，所以……赢了！;-)

感谢您所有的帮助。我真的很感激。你让我的轮子转动，这正是我所需要的。我会在其他时候考虑你的建议，只是为了满足我自己的好奇心，并为我的箭袋添加另一个箭头。

再次感谢！

# mysql - 连接表不同的休眠条件

> ID：14408254
> 
> 赞同：0
> 
> 时间：2013-01-18T21:53:13.450
> 
> 标签：mysql, hibernate, distinct

我有一个表 A，其中有一个表 B 的外键字段。我想获取（首选标准 API，HQL 也可以）具有唯一 B 引用的**A 的X 条目，**

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:41:11.587

```
FROM A AS a
WHERE a.b IN (SELECT ax.b 
              FROM A AS ax 
              GROUP BY b HAVING COUNT(b) = 1) 
```

# regex - Lucene 查询嵌套 OR

> ID：14408260
> 
> 赞同：0
> 
> 时间：2013-01-18T21:53:42.627
> 
> 标签：regex, solr, lucene

我很难编写将返回所有这些可能的字符串值的查询。为了使情况更加困难，可以有超过 1 套 |###>###| 一个字符串中的块，因此在这些之间使用 OR 根本行不通。

我可能不正确地使用 OR 运算符进行分组，因为我使用的每一次尝试最终都要求我从“schema3”开始匹配。

这就是我在脑海中描绘的样子：

item_s:schema3|(a OR atext OR "")>(a OR atext OR "")|

```
item_s:schema3|a>|
item_s:schema3|>a|
item_s:schema3|atext>|
item_s:schema3|>atext|
item_s:schema3|atext>a|
item_s:schema3|a>atext| 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:28:10.857

我假设您正在使用 StandardAnalyzer 进行查询和索引，在这种情况下，您列出的查询会出现一些问题。

您正在尝试创建一个短语查询，在此处生效。Lucene 正在解释冒号，这就是为什么您只能尝试从“schema3”开始的搜索。查询：

```
item_s:somestuff 
```

将在字段名称中搜索“somestuff” `item_s`。如果您将整个内容用引号括起来，那应该会为您解决这个问题。

其次，您不能在短语查询中包含逻辑或通配符，为了精确匹配您指定的术语，您必须枚举所有 6（或 9）种可能性，例如：

```
"item_s:schema3|a>|" "item_s:schema3|>a|" "item_s:schema3|a>atext|" etc. 
```

（澄清一下`OR`，Lucene 语法中并不真正需要 s，它是默认操作，我更喜欢Lucene 的`+/-`语法`and/or/not`）。

如果您不太关心术语的精确正确排序，并且愿意依赖 Lucene 的评分算法，那么您可以让生活更轻松一些，查询更像：

```
+"items_s:schema3" +(a atext) 
```

这需要匹配前缀“items_s:schema3”，以及“a”和“atext”中的一个（或两者）。

请注意，如果保持相同的精确格式（包括标点符号）至关重要，那么您将需要使用关键字或空格分析器进行索引，以维护标点符号（当然，您可能已经这样做了）。

# javascript - 如何将脚本添加到 iframe，然后添加元素来触发它

> ID：14408261
> 
> 赞同：0
> 
> 时间：2013-01-18T21:53:43.723
> 
> 标签：javascript, jquery, iframe, dynamic, insert

（使用 jquery 或仅使用 js）是否可以将脚本添加到 iframe，然后添加元素来触发它？这添加了脚本，但它在 Chrome 中给我一个错误，说该函数未定义。

```
 //create element
        var cloned = $("<input type='button'/>")

        cloned.attr('onclick', "alertUser()");
        var parent = $("#parent");
        var iframe = $('<iframe />').attr("id", "rbm_pu");
        parent.append(iframe);
        var frame = $("#rbm_pu").contents();
        frame.find("body").append(cloned);
        frame.find('body').append("<script type='text/JavaScript'>function alertUser(){alert('hello');}</script>"); 
```

它出现在那里，但说这`alertUser()`是未定义的。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:09:20.453

这个小提琴应该引导你正确的方式：http: [//jsfiddle.net/vsXYA/2/](http://jsfiddle.net/vsXYA/2/)

```
<div id='parent'></div>

// first, create button and assign the callback
var button = $("<input type='button' value='click me' />");
button.click(function() {
    alert("hello");
});

// then, append the button to the freshly created iframe
$('<iframe id="someId"/>')
    .appendTo('#parent')
    .contents().find('body')
    .append(button); 
```

如果您坚持将函数定义为字符串（我*强烈*建议您不要这样做），则此方法有效：http: [//jsfiddle.net/vsXYA/5/](http://jsfiddle.net/vsXYA/5/)

（从[https://stackoverflow.com/a/4120007/729403](https://stackoverflow.com/a/4120007/729403)和[https://stackoverflow.com/a/3603496/729403](https://stackoverflow.com/a/3603496/729403)获取一些信息）

# facebook-graph-api - Facebook GRAPH API 照片喜欢计数，无需分页

> ID：14408262
> 
> 赞同：5
> 
> 时间：2013-01-18T21:53:44.430
> 
> 标签：facebook-graph-api, count, facebook-like

我正在尝试获取 FB 图片的点赞数。我们计算喜欢的图片通常非常受欢迎，因此有大量的喜欢。

例如，“再过 4 年”的奥巴马照片是 facebook 上“最喜欢”的照片，点赞数超过 400 万。

问题是，在该图片的 GRAPH API 响应中，我们没有得到计数，我必须翻阅整个 400 万个喜欢的页面才能得到这个数字……这太疯狂了。

[https://graph.facebook.com/10151255420886749/likes](https://graph.facebook.com/10151255420886749/likes)

```
{
   "data": [
      {
         "id": "100004002885259",
         "name": "Camy Doyna"
      },
      {
         "id": "100003495050210",
         "name": "Louzoco de Carvasal"
      },
      {
         "id": "536183064",
         "name": "Emily Brearley"
      },
      {
         "id": "100002742193990",
         "name": "Rosette Gracia Moukengue"
      },
      {
         "id": "100001107540696",
         "name": "Pac\u00f4me Chazelle"
      },
      {
         "id": "100001035425365",
         "name": "Niklas Pulli"
      },
      {
         "id": "100003292089993",
         "name": "Barbara Grimm"
      },
      {
         "id": "642830020",
         "name": "Elin Vinterhed"
      },
      {
         "id": "100000718890127",
         "name": "Katya Katyusha"
      },
      {
         "id": "1644725575",
         "name": "Lara Corti"
      },
      {
         "id": "100002024205882",
         "name": "Garibyan Anna"
      },
      {
         "id": "100002159247248",
         "name": "Marcos Fernando"
      },
      {
         "id": "1725354804",
         "name": "Kevin Burk"
      },
      {
         "id": "1524833123",
         "name": "Roberto TwoHands Bertuccelli"
      },
      {
         "id": "1056165559",
         "name": "Arman Hossain Anand"
      },
      {
         "id": "1052974324",
         "name": "Kathy Johng Shelton"
      },
      {
         "id": "100000254736003",
         "name": "Tina Mosely"
      },
      {
         "id": "595281527",
         "name": "Kim Fontaine-Skronski"
      },
      {
         "id": "100002935725139",
         "name": "Iulian Boxerul"
      },
      {
         "id": "100001450004383",
         "name": "Nora Lachgar"
      },
      {
         "id": "100001859484728",
         "name": "Joan Breen"
      },
      {
         "id": "1802479070",
         "name": "Jan Meyer"
      },
      {
         "id": "1815802454",
         "name": "Gregory Nobre"
      },
      {
         "id": "100002988798465",
         "name": "Aika JU"
      },
      {
         "id": "100003737463206",
         "name": "Ingrid Theiszov\u00e1-Bajusov\u00e1"
      }
   ],
   "paging": {
      "next": "https://graph.facebook.com/10151255420886749/likes?limit=25&offset=25&__after_id=100003737463206"
   }
} 
```

[https://graph.facebook.com/10151255420886749](https://graph.facebook.com/10151255420886749)

```
{
   "id": "10151255420886749",
   "from": {
      "category": "Politician",
      "name": "Barack Obama",
      "id": "6815841748"
   },
   "name": "Four more years.",
   "picture": "http://photos-a.ak.fbcdn.net/hphotos-ak-ash4/409202_10151255420886749_2117448131_s.jpg",
   "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s720x720/409202_10151255420886749_2117448131_n.jpg",
   "height": 478,
   "width": 720,
   "images": [
      {
         "height": 1359,
         "width": 2048,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s2048x2048/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 532,
         "width": 800,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 478,
         "width": 720,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s720x720/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 398,
         "width": 600,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s600x600/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 318,
         "width": 480,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s480x480/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 212,
         "width": 320,
         "source": "http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash4/s320x320/409202_10151255420886749_2117448131_n.jpg"
      },
      {
         "height": 119,
         "width": 180,
         "source": "http://photos-a.ak.fbcdn.net/hphotos-ak-ash4/409202_10151255420886749_2117448131_a.jpg"
      },
      {
         "height": 86,
         "width": 130,
         "source": "http://photos-a.ak.fbcdn.net/hphotos-ak-ash4/409202_10151255420886749_2117448131_s.jpg"
      },
      {
         "height": 86,
         "width": 130,
         "source": "http://photos-a.ak.fbcdn.net/hphotos-ak-ash4/s75x225/409202_10151255420886749_2117448131_s.jpg"
      }
   ],
   "link": "http://www.facebook.com/photo.php?fbid=10151255420886749&set=a.53081056748.66806.6815841748&type=1",
   "icon": "http://static.ak.fbcdn.net/rsrc.php/v2/yz/r/StEh3RhPvjk.gif",
   "created_time": "2012-11-07T04:15:07+0000",
   "updated_time": "2012-11-07T04:15:07+0000",
   "comments": {
      "data": [
         {
            "id": "10151255420886749_12810477",
            "from": {
               "name": "David Carol",
               "id": "100003175318626"
            },
            "message": "BISHOP ZACHARY KAKOBE VERIFIED AIDS HEALING MIRACLES IN HIS MINISTRIES. THIS MINISTRY REGISTERED IN U.S.A IN 2010\. WEBSITE: WWW.bishopzacharykakobe.org",
            "can_remove": false,
            "created_time": "2012-11-28T20:00:21+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12811019",
            "from": {
               "name": "Lievin Bangali",
               "id": "1812106678"
            },
            "message": "Barack Obama, Felicitation de votre reelection. Il est grand temps d'agir pour la situation de l'EST de la RD Congo. Merci et courage!",
            "can_remove": false,
            "created_time": "2012-11-28T20:40:28+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12811211",
            "from": {
               "name": "Pamela Aupindi",
               "id": "100004586432226"
            },
            "message": "President Obama is not only a charismatic leader but an obviously passionate man. One can feel the love for his wife through the pic! Amazing",
            "can_remove": false,
            "created_time": "2012-11-28T20:54:40+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12811850",
            "from": {
               "name": "Ardavan Shafiie",
               "id": "1174217484"
            },
            "message": "graet picture",
            "can_remove": false,
            "created_time": "2012-11-28T21:35:26+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12812793",
            "from": {
               "name": "Samson Anifowose",
               "id": "658496517"
            },
            "message": "All the best!",
            "can_remove": false,
            "created_time": "2012-11-28T22:51:30+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814187",
            "from": {
               "name": "Yago Costa",
               "id": "100000919886198"
            },
            "message": "isso ae negao !!!",
            "can_remove": false,
            "created_time": "2012-11-29T00:39:57+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814238",
            "from": {
               "name": "Sena Raharja",
               "id": "100004587874401"
            },
            "message": "wow",
            "can_remove": false,
            "created_time": "2012-11-29T00:43:08+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814255",
            "from": {
               "name": "Getachew Biratu",
               "id": "100004104261949"
            },
            "message": "Better \u0040 home...!!!",
            "can_remove": false,
            "created_time": "2012-11-29T00:43:45+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814350",
            "from": {
               "name": "Bennydictus Ari Setiabudi",
               "id": "714307966"
            },
            "message": "uhuk... lama2 terkikis image seno raharjo... XD",
            "can_remove": false,
            "created_time": "2012-11-29T00:50:10+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814615",
            "from": {
               "name": "Sena Raharja",
               "id": "100004587874401"
            },
            "message": "mukanya mirip gua. Ini foto bikin rekor dunia.",
            "can_remove": false,
            "created_time": "2012-11-29T01:06:44+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814662",
            "from": {
               "name": "Bennydictus Ari Setiabudi",
               "id": "714307966"
            },
            "message": "beda nasib dikit doang kali y... hehehe... :D",
            "can_remove": false,
            "created_time": "2012-11-29T01:09:59+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12814794",
            "from": {
               "name": "Subhash Biradar",
               "id": "100003474405756"
            },
            "message": "    Its better...ha ha ha ha.",
            "can_remove": false,
            "created_time": "2012-11-29T01:20:35+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12815269",
            "from": {
               "name": "Barbara J. Beverly",
               "id": "1348022951"
            },
            "message": "I am still smiling and happy....such a wonderful day in America.",
            "can_remove": false,
            "created_time": "2012-11-29T01:51:15+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12815652",
            "from": {
               "name": "Phillip Mason",
               "id": "100001280178407"
            },
            "message": "Makes me want to throw up. The Muslim and his ..........",
            "can_remove": false,
            "created_time": "2012-11-29T02:17:19+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12815699",
            "from": {
               "name": "Jeremiah Bates",
               "id": "100000912015322"
            },
            "message": "The clown above me is far below me .",
            "can_remove": false,
            "created_time": "2012-11-29T02:21:04+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12815758",
            "from": {
               "name": "Jeremiah Bates",
               "id": "100000912015322"
            },
            "message": "Sad...Phillip Mason, they have self help tapes, education programs, support groups for uneducated fools such as yourself....",
            "can_remove": false,
            "created_time": "2012-11-29T02:26:12+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12816036",
            "from": {
               "name": "Romy Christie",
               "id": "100003856980181"
            },
            "message": "To Barbara J Beverly, I completely agree with you, what a Wonderful day for America, long live President Obama, may his next four years leave him a shining place in history! Great charisma and a great orator, I believe that he is doing his utmost with the heavy burden that was put upon his shoulders when he first began... From Romy, British National, Permanent resident in Tokyo Japan.November 29th2012 instant.",
            "can_remove": false,
            "created_time": "2012-11-29T02:45:35+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818055",
            "from": {
               "name": "\u0122in \u01feblsk\u00e5 K\u00e4n\u0115",
               "id": "100001520690200"
            },
            "message": "\u0641\u0649 \u0627\u064a\u0647 \u064a\u0627 \u0648\u0644\u0627\u062f \u0627\u0644.........",
            "can_remove": false,
            "created_time": "2012-11-29T06:37:20+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818064",
            "from": {
               "name": "Cm Amgad",
               "id": "100001979501265"
            },
            "message": "\u0627\u0646\u062a\u0627 \u064a\u0627 \u0639\u0645 \u0628\u0627\u0631\u0627\u0643 \u0627\u0648\u0628\u0627\u0645\u0627",
            "can_remove": false,
            "created_time": "2012-11-29T06:38:26+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818067",
            "from": {
               "name": "Cm Amgad",
               "id": "100001979501265"
            },
            "message": "\u0644\u0645\u0627 \u0627\u0644\u0627\u0633\u062a\u0627\u0630 \u062c\u064a\u0646 \u064a\u062a\u0643\u0644\u0645 \u062a\u0631\u062f \u0639\u0644\u064a\u0629 \u064a\u0627 \u0643\u0633\u0645\u0643",
            "can_remove": false,
            "created_time": "2012-11-29T06:39:21+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818275",
            "from": {
               "name": "Denise Mutty Henry",
               "id": "707184927"
            },
            "message": "who is the boss? michele of course",
            "can_remove": false,
            "created_time": "2012-11-29T07:21:36+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818295",
            "from": {
               "name": "Steve Muguerza",
               "id": "100001926262266"
            },
            "message": "Dont worry honey I will do as you say and begin down america with the americas helping me they are so so weak we will just send them a check and keep them down like we keep the blacks down and in their place. Keep them poor and uneducated and teach them to rap.",
            "can_remove": false,
            "created_time": "2012-11-29T07:25:55+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818637",
            "from": {
               "name": "David Torrens",
               "id": "699130216"
            },
            "message": "So USA votes for the right team after all.  And there was me thinking you might go back to a rather bushy nut.",
            "can_remove": false,
            "created_time": "2012-11-29T08:48:22+0000",
            "like_count": 1,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12818837",
            "from": {
               "category": "Fictional character",
               "name": "\u0645\u064f\u0640\u0633\u062a\u062d\u064a\u0640\u0640\u0640\u0640\u0644 \u0623\u0646\u0640\u0633\u0640\u0640\u0640\u0640\u0627\u0643\u064a\u0650 \u0644\u0623\u0646\u0646\u0651\u0640\u0640\u0640\u0640\u064a \u0639\u0627\u064a\u0640\u0640\u0640\u0640\u0634\u064c \u0639\u0644\u0640\u0640\u0640\u0640\u064a \u0630\u0643\u0640\u0640\u0640\u0631\u0627\u0643\u0640\u0640\u0640\u0640\u0640\u064a\u0650",
               "id": "101906399977956"
            },
            "message": "http://www.facebook.com/pages/\u0025D9\u002585\u0025D9\u00258F\u0025D8\u0025B3\u0025D8\u0025AA\u0025D8\u0025AD\u0025D9\u00258A\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002584-\u0025D8\u0025A7\u0025D9\u002586\u0025D8\u0025B3\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D9\u002580\u0025D8\u0025A7\u0025D9\u002583\u0025D9\u00258A-\u0025D9\u002584\u0025D8\u0025A3\u0025D9\u002586\u0025D9\u002586\u0025D9\u00258A-\u0025D8\u0025B9\u0025D8\u0025A7\u0025D9\u00258A\u0025D8\u0025B4-\u0025D8\u0025B9\u0025D9\u002584\u0025D9\u00258A-\u0025D8\u0025B0\u0025D9\u002583\u0025D8\u0025B1\u0025D8\u0025A7\u0025D9\u002583\u0025D9\u00258A/101906399977956?ref=hl",
            "can_remove": false,
            "created_time": "2012-11-29T09:36:54+0000",
            "like_count": 0,
            "user_likes": false
         },
         {
            "id": "10151255420886749_12819093",
            "from": {
               "name": "Mojisola Otu",
               "id": "100000238597273"
            },
            "message": "All the Best.\nMy family prays for yours.",
            "can_remove": false,
            "created_time": "2012-11-29T10:41:24+0000",
            "like_count": 1,
            "user_likes": false
         }
      ],
      "paging": {
         "next": "https://graph.facebook.com/10151255420886749/comments?limit=25&offset=25&__after_id=10151255420886749_12819093"
      }
   },
   "likes": {
      "data": [
         {
            "id": "100004002885259",
            "name": "Camy Doyna"
         },
         {
            "id": "100003495050210",
            "name": "Louzoco de Carvasal"
         },
         {
            "id": "536183064",
            "name": "Emily Brearley"
         },
         {
            "id": "100002742193990",
            "name": "Rosette Gracia Moukengue"
         },
         {
            "id": "100001107540696",
            "name": "Pac\u00f4me Chazelle"
         },
         {
            "id": "100001035425365",
            "name": "Niklas Pulli"
         },
         {
            "id": "100003292089993",
            "name": "Barbara Grimm"
         },
         {
            "id": "642830020",
            "name": "Elin Vinterhed"
         },
         {
            "id": "100000718890127",
            "name": "Katya Katyusha"
         },
         {
            "id": "1644725575",
            "name": "Lara Corti"
         },
         {
            "id": "100002024205882",
            "name": "Garibyan Anna"
         },
         {
            "id": "100002159247248",
            "name": "Marcos Fernando"
         },
         {
            "id": "1725354804",
            "name": "Kevin Burk"
         },
         {
            "id": "1524833123",
            "name": "Roberto TwoHands Bertuccelli"
         },
         {
            "id": "1056165559",
            "name": "Arman Hossain Anand"
         },
         {
            "id": "1052974324",
            "name": "Kathy Johng Shelton"
         },
         {
            "id": "100000254736003",
            "name": "Tina Mosely"
         },
         {
            "id": "595281527",
            "name": "Kim Fontaine-Skronski"
         },
         {
            "id": "100002935725139",
            "name": "Iulian Boxerul"
         },
         {
            "id": "100001450004383",
            "name": "Nora Lachgar"
         },
         {
            "id": "100001859484728",
            "name": "Joan Breen"
         },
         {
            "id": "1802479070",
            "name": "Jan Meyer"
         },
         {
            "id": "1815802454",
            "name": "Gregory Nobre"
         },
         {
            "id": "100002988798465",
            "name": "Aika JU"
         },
         {
            "id": "100003737463206",
            "name": "Ingrid Theiszov\u00e1-Bajusov\u00e1"
         }
      ],
      "paging": {
         "next": "https://graph.facebook.com/10151255420886749/likes?limit=25&offset=25&__after_id=100003737463206"
      }
   }
} 
```

执行诸如添加具有高得离谱的值的分页限制参数之类的操作太慢了...有没有办法直接获得计数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-07-17T10:47:38.117

您也可以尝试 /likes?summary=1 将“summary/total_count”添加到您的结果中，所以

```
https://graph.facebook.com/10151255420886749/likes?summary=1 
```

返回：

```
{
  "data": [
    {
      "id": "100004351206696",
      "name": "Marcos Nones"
    },
    {
      "id": "100002271852907",
      "name": "Kishor Ray"
    },
    ...
  ],
  "paging": {
    "cursors": {
      "after": "MTU4NTQ1MzczMw==",
      "before": "MTAwMDA0MzUxMjA2Njk2"
    },
    "next": "https://graph.facebook.com/10151255420886749/likes?summary=1&limit=25&after=MTU4NTQ1MzczMw%3D%3D"
  },
  "summary": {
    "total_count": 4434080
  }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-18T22:02:53.617

[`photo`您可以通过FQL 表](https://developers.facebook.com/docs/reference/fql/photo)检索此信息：

```
select like_info from photo where object_id = 10151255420886749; 
```

回报：

```
{
  "data": [
    {
      "like_info": {
        "can_like": true, 
        "like_count": 4444816, 
        "user_likes": false
      }
    }
  ]
} 
```

# javascript - 所有页面的相同网址

> ID：14408265
> 
> 赞同：0
> 
> 时间：2013-01-18T21:54:05.923
> 
> 标签：javascript, ajax, jsp

我正在开发 JSP 中的项目，但我想在导航栏中为我的项目中的所有页面显示相同的 url。

我知道如何使用 iframe 和框架集来实现，但我正在寻找一种使用 javascript/ajax 的方法。

有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T05:20:13.133

您可以在同一个 servlet 中使用切换条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:57:41.480

所有页面更改都通过 AJAX 完成的单页面 Web 应用程序当然是可能的，并且实际上在[Backbone.js](http://backbonejs.org/)等框架中越来越受欢迎。确切的实现将根据您的项目的性质而有很大的不同，因此如果没有更具体的信息，就没什么好说的了。

作为我能想到的最简单的示例，您可以在页面上创建一个链接，运行以下 javascript（使用 jQuery）来完全重新加载页面正文：

```
$("body").load("/path/to/new/body.htm"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:58:41.407

您可以加载将使用 Ajax 更新 HTML DOM 的页面。

主页：foo.com/bar

```
<div id='ajax_container'>

</div> 
```

然后在您的 JS 中，针对特定的用户操作（单击菜单...）：

```
$(function(){
  $('#baz').click(function(){
    $.ajax({
     url: "foo.com/bazzz",
     cache: false
    }).done(function(html) {
      $("#ajax_container").append(html);
    });
  });
}); 
```

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# php - PHP将一个数组中的值插入另一个数组

> ID：14408270
> 
> 赞同：0
> 
> 时间：2013-01-18T21:54:33.523
> 
> 标签：php, multidimensional-array

我在处理几个数组时遇到了一些问题并且被卡住了。我能够阅读两者，但无法弄清楚如何让第一个基于一个键搜索第二个并将另一个键的值拉入第一个。两个数组都有*code*和*description*。我需要将下一个数组中的*描述*放入*代码*相同的第一个数组中。第一个数组中有多个*代码实例。*

```
Array1 (
[0] => Array (
    [state] => AK
    [effdate] => 01/01/2012
    [code] => 1
    [description] => null
    [enddate] => null
)
[1] => Array (
    [state] => AK
    [effdate] => 01/01/2012
    [code] => 2
    [description] => null
    [enddate] => null
)
[2] => Array (
    [state] => AK
    [effdate] => 01/01/2012
    [code] => 3
    [description] => null
    [enddate] => null
)
)

Array2 (
[0] => Array (
    [code] => 1
    [description] => some description
)
[1] => Array (
    [code] => 2
    [description] => some other description
)
[2] => Array (
    [code] => 3
    [description] => yet another description
)
) 
```

此外，第一个数组是从 MySQL 表创建的，而第二个数组来自制表符分隔的文本文件。最终结果会将文本文件中的描述写入 MySQL 表。下面是我必须在两个数组之间查看并将它们写入 HTML 表的代码。我能够检索第一个条目的描述，但没有别的。我知道它与if 语句中的 *$ncci_array[$ *i* ]* 中的 $i 有关，但我不确定用什么替换它。Array1 = *$rates_array* 和 Array2 = *$ncci_array*

```
echo '<table border="1"><tr><td>ID</td><td>State</td><td>Effective</td><td>Code</td><td>Description</td><td>End</td></tr>'."\n";

if (($rates_array[$i]['state'] == 'AL'||'AK'||'AZ'||'AR'||'CO'||'CT'||'DC'||'FL'||'GA'||'HI'||'ID'||'IL'||'IA'||'KS'||'KY'||'LA'||'ME'||'MD'||'MS'||'MO'||'MT'||'NE'||'NV'||'NH'||'NM'||'OK'||'RI'||'SC'||'SD'||'TN'||'UT'||'VT'||'VA'||'WI') && ($rates_array[$i]['code'] == $ncci_array[$i]['code']))
{
    $rates_array[$i]['description'] = strtolower($ncci_array[$i]['description']);
}else{
    $rates_array[$i]['description'] = 'Description unavailable at this time';
}

for ($rates_row = 0; $rates_row < count($rates_array)-1; $rates_row++)
{
    if ($rates_array[$i]['code'] == $rates_array[$i+1]['code'])
    {
        $rates_array[$i]['enddate'] = date('Y-m-d', strtotime('-1 day', strtotime($rates_array[$i+1]['effdate'])));
    }else{
        $rates_array[$i]['enddate'] = date('Y-m-d', strtotime('+1 year', strtotime($rates_array[$i]['effdate'])));
    }

    echo '<tr><td>'.$i.'</td><td>'.$rates_array[$i]['state'].'</td><td>'.$rates_array[$i]['effdate'].'</td><td>'.$rates_array[$i]['code'].'</td><td>'.$rates_array[$i]['description'].'</td><td>'.$rates_array[$i]['enddate'].'</td></tr>'."\n";

    $i++;
}
echo '</table>'; 
```

当前输出看起来像这样

```
| ID | State | Effective  | Code | Description      | End        |
| 0  | AK    | 01/01/2011 | 1    | Some description | 12/31/2011 |
| 1  | AK    | 01/01/2012 | 1    |                  | 01/01/2013 |
| 2  | AK    | 01/01/2012 | 2    |                  | 01/01/2013 |
| 3  | AK    | 01/01/2012 | 3    |                  | 01/01/2013 | 
```

谢谢参观！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:08:30.673

遍历两个数组，检查两者之间的匹配。（在问题编辑之前发布）

```
foreach($rates_array as $key => $val){ // Array1 where description is null
    foreach($ncci_array as $k => $v){ // Array2 where description is set
        if($val['code'] == $v['code']) 
            $rates_array[$key]['description'] = $v['description'];
    }
} 
```

这将强制将 Array2 中的描述值放入 Array1 中，从而为您提供一个可以在表中使用的数组以避免混淆。

此外，您实际上并不需要 $i ，因为您使用 $rates_row 作为循环计数器。

# multithreading - 每个演员的 Akka 套接字

> ID：14408273
> 
> 赞同：16
> 
> 时间：2013-01-18T21:54:40.490
> 
> 标签：multithreading, sockets, scala, akka, actor

将 Scala 与 Akka IO 一起使用是否有办法让 Actor 严格用于侦听，然后在建立连接时创建一个新的 Actor，然后负责该 Socket（读取、写入等）？

到目前为止，我有这个。问题是服务器参与者正在接收数据。我想将套接字的所有权转移给新创建的客户端参与者，以便它接收与套接字相关的任何消息。有谁知道该怎么做？

编辑：添加解决方案。我只需要将 ActorRef 传递给accept的curried参数

```
import akka.actor._
import akka.actor.IO.SocketHandle
import java.net.InetSocketAddress

/**
 * Purpose:
 * User: chuck
 * Date: 17/01/13
 * Time: 5:37 PM
 */
object Main {

  class Server extends Actor {

    override def preStart() {
      IOManager(context.system) listen new InetSocketAddress(3333)
    }

    def receive = {

      case IO.NewClient(server) =>

        val client = context.actorOf(Props(new Client()))
        server.accept()(client)
        println("Client accepted")

      case IO.Read(socket, bytes) =>
        println("Server " + bytes)

    }
  }

  class Client() extends Actor {

    def receive = {

      case IO.Read(socket, bytes) =>
        println("Client " + bytes)

      case IO.Closed(socket, reason) =>
        println("Socket closed " + reason)

    }

  }

  def main(args: Array[String]) {
    val system = ActorSystem()
    system.actorOf(Props(new Server))
  }

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-13T12:20:29.730

为了让答案更明显：

来自[Akka](http://doc.akka.io/api/akka/2.0.1/akka/actor/IO%24%24ServerHandle.html)`ServerHandle`文档：

```
def accept ()(implicit socketOwner: ActorRef): SocketHandle 
```

> **socketOwner** ActorRef 应该接收与 SocketChannel 关联的事件。当前 Actor 的 ActorRef 将被隐式使用。

如果没有向 curried 参数传递任何内容（仅调用`server.accept()`），则当前 Actor（服务器）将从 SocketChannel 接收事件。然而，正如方法签名所暗示的，您可以将 ActorRef 传递给 curried 参数，以便 SocketChannel 上发生的事件将由这个新的 Actor 处理。

留给我们问题所有者添加的解决方案：

```
def receive = {
  case IO.NewClient(server) =>
      val client = context.actorOf(Props(new Client()))
      server.accept()(client) // Transferring ownership of the socket to a new Actor
      println("Client accepted")

  case IO.Read(socket, bytes) =>
      println("Server " + bytes)
} 
```

# javascript - 像数组一样访问 json 对象中的元素

> ID：14408281
> 
> 赞同：13
> 
> 时间：2013-01-18T21:55:22.820
> 
> 标签：javascript, arrays, json, object, properties

> **可能重复：**
> [我有一个嵌套的数据结构/JSON，我怎样才能访问一个特定的值？](https://stackoverflow.com/questions/11922383/i-have-a-nested-data-structure-json-how-can-i-access-a-specific-value)

我有一个 json 对象，如下所示：

```
[
  ["Blankaholm", "Gamleby"],
  ["2012-10-23", "2012-10-22"],
  ["Blankaholm. Under natten har det varit inbrott", "E22 i med Gamleby. Singelolycka. En bilist har.],
  ["57.586174","16.521841"], ["57.893162","16.406090"]
] 
```

它由 4 个“属​​性级别”（城市、日期、描述和坐标）组成。

我想要做的是能够像这样在数组中访问这些级别：

```
var coordinates = jsonObject[4]; 
```

这显然不起作用所以我的问题是我该怎么做？

我需要解码它还是什么，如果需要，怎么做？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-18T22:13:34.657

我找到了解决这个问题的直接方法，使用 JSON.parse。

假设下面的 json 在变量**jsontext**中。

```
[
  ["Blankaholm", "Gamleby"],
  ["2012-10-23", "2012-10-22"],
  ["Blankaholm. Under natten har det varit inbrott", "E22 i med Gamleby. Singelolycka. En bilist har.],
  ["57.586174","16.521841"], ["57.893162","16.406090"]
] 
```

解决方案是这样的：

```
var parsedData = JSON.parse(jsontext); 
```

现在我可以通过以下方式访问元素：

```
var cities = parsedData[0]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T22:01:31.740

您似乎是一个多数组，而不是 JSON 对象。

如果要像数组一样访问对象，则必须使用某种键/值，例如：

```
var JSONObject = {
  "city": ["Blankaholm, "Gamleby"],
  "date": ["2012-10-23", "2012-10-22"],
  "description": ["Blankaholm. Under natten har det varit inbrott", "E22 i med Gamleby. Singelolycka. En bilist har.],
  "lat": ["57.586174","16.521841"], 
  "long": ["57.893162","16.406090"]
} 
```

并通过以下方式访问它：

```
JSONObject.city[0] // => Blankaholm
JSONObject.date[1] // => 2012-10-22

and so on... 
```

或者

```
JSONObject['city'][0] // => Blankaholm
JSONObject['date'][1] // => 2012-10-22

and so on... 
```

或者，作为最后的手段，如果你不想改变你的结构，你可以这样做：

```
var JSONObject = {
  "data": [
    ["Blankaholm, "Gamleby"],
    ["2012-10-23", "2012-10-22"],
    ["Blankaholm. Under natten har det varit inbrott", "E22 i med Gamleby. Singelolycka. En bilist har.],
    ["57.586174","16.521841"], 
    ["57.893162","16.406090"]
  ]
}

JSONObject.data[0][1] // => Gambleby 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T22:00:21.860

我注意到一些语法错误，但除此之外，它应该可以正常工作：

```
var arr = [
  ["Blankaholm", "Gamleby"],
  ["2012-10-23", "2012-10-22"],
  ["Blankaholm. Under natten har det varit inbrott", "E22 i med Gamleby. Singelolycka. En bilist har."], //<- syntax error here
  ["57.586174","16.521841"], ["57.893162","16.406090"]
];

console.log(arr[4]);    //["57.893162","16.406090"]
console.log(arr[4][0]); //57.893162 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:06:18.963

```
var coordinates = [jsonObject[3][0], 
                   jsonObject[3][0],
                   jsonObject[4][1], 
                   jsonObject[4][1]]; 
```

# ruby - 在 Ruby 中解析 URL 以获取没有“www”的子域或主域？

> ID：14408289
> 
> 赞同：8
> 
> 时间：2013-01-18T21:55:47.597
> 
> 标签：ruby

如果我有一个网址：

```
http://www.example.com/page 
```

我想将其解释为：

```
example.com 
```

但是，如果我有：

```
http://blog.example.com/page 
```

我想回来：

```
blog.example.com 
```

那很难吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-18T22:02:44.490

使用 Ruby 的[URI](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI.html)模块：

```
require 'uri'
URI.parse('http://www.example.com/page').host
=> "www.example.com"
URI.parse('http://blog.example.com/page').host
=> "blog.example.com" 
```

在这两种情况下，URI 都会提取整个主机名，因为选择性地将主机从域中剥离是没有意义的。

您必须使用以下方法单独实现该逻辑：

```
%w[http://www.example.com/page http://blog.example.com/page].each do |u|
  puts URI.parse(u).host.sub(/^www\./, '')
end 
```

哪个输出：

```
example.com
blog.example.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:03:36.267

你可以使用[`URI`类](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI.html)；例如：

```
require 'uri'
uri1 = URI.parse("http://www.example.com/page")
puts uri1.host.gsub(/www\./i, "") #This will print example.com
uri2 = URI.parse("http://blog.example.com/page")
puts uri2.host #This prints blog.example.com 
```

`gsub`将简单地替换`"www"`，不区分大小写， for `""`。

# sql - “as”附近的案例表达式语法错误

> ID：14408294
> 
> 赞同：0
> 
> 时间：2013-01-18T21:56:08.310
> 
> 标签：sql, syntax, case

我的案例表达式出现错误。我只想评估一个条件，并返回正确的语句。但是我在“as”附近不断收到语法错误。

这是我所拥有的：

```
left outer join (            
        SELECT wbs1, wbs2, wbs3  
    , case 
            when (ProgramAffiliation = magrann.[programAffiliation_AEP/COHesh2010]()) 
            then '[AEP] as ''AEP1'''
            else [AEP Base] as 'AEP1'
        end
    , [AEP:Non-Compliant Mechanical Ventilation] as 'AEP2'  
    , [AEP - Non Energy Star AC ($90 deduction)] as 'AEP3'  
    , [AEP: Bonus] as 'AEP4' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:58:59.497

您的`CASE`语法错误。您有一个用单引号括起来的列名，并且在两个地方都有别名（都是错误的）：

```
 , case 
    when (ProgramAffiliation = magrann.[programAffiliation_AEP/COHesh2010]()) 
    then '[AEP] as ''AEP1'''  -- <-- don't put the column in single quotes and no alias here
    else [AEP Base] as 'AEP1'  -- < don't put the alias here
   end  -- < the alias goes here 
```

所以你`CASE`应该是：

```
, case 
    when (ProgramAffiliation = magrann.[programAffiliation_AEP/COHesh2010]()) 
    then [AEP]
    else [AEP Base] 
    end as AEP1 
```

别名`END`在`CASE`表达式中的后面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:58:21.333

你应该`end`在`case`之前`as`：

```
case 
  when (ProgramAffiliation = magrann.[programAffiliation_AEP/COHesh2010]()) then [AEP] as 
  else [AEP Base] 
end as [AEP1]
// not else [AEP Base]  as 'AEP1' end 
```

更新

# c++ - 为什么 c++ 对看起来相同的计算给出不同的答案？

> ID：14408295
> 
> 赞同：0
> 
> 时间：2013-01-18T21:56:12.077
> 
> 标签：c++, floating-point

我在一个简单的 main 中有以下源代码：

```
int main(int argc, char** argv)
{
    double x = atof(argv[1]);
    double y = atof(argv[2]);

    double res = x + std::floor((y - x) * .5 * 100 + .5)*0.01;

    std::cout << res << std::endl;
} 
```

如果我用 75.21 75.22 运行上面的代码，它给了我 75.22，但如果我用 7.21 和 7.22 运行它，它给了我 7.21。这两个数字相差 0.01，所以我不明白为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:08:42.260

简短的回答：浮点值是不精确的。

长答案：[每个计算机科学家都应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T22:12:17.023

浮点运算的许多错综复杂之处在于，浮点数并不是沿着它们的最小值和最大值之间的实线均匀分布的。接近`0`浮点数，被认为是实数线上的点，比远离 更密集`0`，并且密度随着（绝对）距离的`0`增加而减小。

对于通常的 IEEE 标准表示，例如 1(base-10) 和 2(base-10) 之间的数字与 2(base-10) 和 4(base-10) 之间的数字一样多。`[2^i,2^i+1]`对于任何（正或负）整数，区间中有相同数量的浮点数，因此区间的`i`两个端点都是可表示的。

考虑到这一点，以 10 为底的计算的精度随着所涉及的绝对值幅度的增加而降低也就不足为奇了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:10:35.850

`in x = atof ()`不可能是对的

```
double atof ( const char * str ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T18:56:30.403

When you subtract two almost identical numbers `y` and `x`, to get a number orders of magnitude smaller than both, you *always* lose a lot of precision (except in the unlikely case that the binary expansions of both `y` and `x` terminates no later than at the 53rd bit). That's not surprising.

In this particular case, you can see the "issue" easily without tricks by just calculating

```
75.22 - 75.21 
```

and

```
7.22 - 7.21 
```

(the results will be `0.0100000000000051` and `0.00999999999999979`, respectively).

# grails - grails - 数据源插件，域类未映射

> ID：14408300
> 
> 赞同：0
> 
> 时间：2013-01-18T21:56:21.227
> 
> 标签：grails

使用 grails 1.3.6 使用数据源插件（即将升级）我在渲染 taglib 时收到此错误

```
org.springframework.orm.hibernate3.HibernateQueryException: DomainA is not mapped 
```

这些是数据库（两者都是 postgresql 并且位于同一服务器中）：

```
database A
    schema x
        table domain_a
        table domain_b
database B
    schema x
        table DomainA
        table DomainB 
```

这些是我的映射：

```
class domainA { // Domain A is defined in a plugin
    mapping(table: "x.domain_a")
}

class domainB {
    mapping(table: "x.domain_b")
} 
```

我想要的是 domainA 映射到数据库 A 和 domainB 映射到数据库 B。

我在 Config.groovy 中为数据库 A 使用 grails.config.locations，在数据库 B 中使用 Datasources.groovy，并使用以下配置：

```
datasource(name: 'databaseB') {
    driverClassName('org.postgresql.Driver')
    url('jdbc:postgresql://host/databaseB')
    username('user')
    password('****')
    domainClasses(['DomainB'])
    readOnly(true)
    dialect("org.hibernate.dialect.PostgreSQLDialect")
    pooled(true)
    environments(['development', 'test'])
} 
```

我不明白似乎是什么问题

有没有人遇到过这个问题，有没有我可以使用的解决方法？也许升级到 grails 2 会有所帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T15:59:55.383

好吧，我有点解决了在 datasources.groovy 中使用数据库 A（主数据库）创建另一个数据源并在其中包括 domainA（以及所有其他相关域）的问题，如下所示：

```
import package.DomainA

datasource(name: 'databaseA') {
    driverClassName('org.postgresql.Driver')
    url('jdbc:postgresql://host/databaseA')
    username('user')
    password('***')
    domainClasses([DomainA, OtherDomains])
} 
```

# javascript - 在 Windows 中调试 Geddy Node.js 应用程序

> ID：14408302
> 
> 赞同：0
> 
> 时间：2013-01-18T21:56:24.407
> 
> 标签：javascript, node.js, signals, node-inspector, geddy

有没有办法在 Windows 下调试 Geddy.js（一个 Node.js 框架）应用程序？

他们的网站上有一个关于调试的[wiki 页面](https://github.com/mde/geddy/wiki/Debugging)`node-inspector`，但我想它在 Windows 上不起作用，因为它使用信号：

```
kill -s USR1 3180 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-08T16:01:31.110

我使用 Webstorm 开发和调试 geddy。您需要编写一个服务器启动脚本来启动没有工人的 geddy 服务器，如下所示：

```
var geddy = require('geddy');

if (geddy.isMaster) {
    geddy.config({
        environment: 'development'
        , workers: 0
    }); 
}   

geddy.start(); 
```

只需让 WebStorm 运行“node start.js”[即上面的脚本]，您就可以添加断点等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T18:39:43.277

您还可以使用[Debugging Wiki Page](https://github.com/mde/geddy/wiki/Debugging)中提到的 WebStorm 或 IntelliJ 。其他 IDE 可能使用类似的配置。

我尝试使用调试器启动它，但我只能调试 geddy。你可以试一试。仅当进程在没有调试器的情况下启动时才需要该信号，但是您可以运行以下命令：

`node --debug /usr/local/lib/node_modules/geddy/bin/cli.js` 或者 `node --debug-brk /usr/local/lib/node_modules/geddy/bin/cli.js`

我还发现[node-inspector-windows](https://github.com/glennblock/node-inspector-windows)看起来很有希望，但我还没有尝试过。

# jquery - 通过单击删除链接从 textarea 中删除链接并从 div 中删除图像

> ID：14408310
> 
> 赞同：1
> 
> 时间：2013-01-18T21:56:43.610
> 
> 标签：jquery, html, textarea

我是 jQuery 新手，希望解决这个问题。提前感谢您。

我在[小提琴](http://jsfiddle.net/oknasir/k6TEr/)中制作了我的代码示例。在这个代码示例中，我有一个 textarea 和一个 div。

```
<div id="divfordisplay"></div> 
```

这个 div 显示所有在 textarea 中的图片链接。

现在我的问题是我想要在图像上删除图像链接，通过单击此删除链接，该图像应从 div 中删除，并从 textarea 中删除链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:03:49.557

```
$('#divfordisplay').on('click', 'img', function(){
   var link = this.src;
   $(this).remove();
   $('#img_upload_value').val(function(i, v){
       return v.replace(link, '');
   });   
}); 
```

[http://jsfiddle.net/SpHeT/](http://jsfiddle.net/SpHeT/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:04:54.487

试试这个代码。[**演示在这里**](http://jsfiddle.net/k6TEr/1/)

```
jQuery(document).ready(function() {
    var imguploadvaluesdis = jQuery('#img_upload_value').val().split('\n');
    for( var i=0; i<imguploadvaluesdis.length; i++){
        jQuery('#divfordisplay').append('<img src="' + imguploadvaluesdis[i] + '" alt="" />');

    }
    $('img').click( function() {
        var newVal =$('#img_upload_value').val().replace($(this).attr('src'),'');
        $('#img_upload_value').val(newVal);
        $(this).remove();
    });
}); 
```

# html - 搜索结果进入列表框？

> ID：14408312
> 
> 赞同：0
> 
> 时间：2013-01-18T21:57:01.507
> 
> 标签：html, vb.net, search, listbox

这是我在这里的第一篇文章。我之前使用过这个网站，最后决定注册一个帐户。

我正在尝试制作一个程序，其中列出`url's`了谷歌搜索出现的前 50 个站点。我是 VB.net 的初学者，我知道我应该尝试一些更简单的方法，但我真的很想制作这个程序。

我的想法是获取 HTML，然后从那里获取网站的链接，但是当我查看 Google 搜索结果页面的 HTML 时，大部分链接都不存在。所以，我右键单击其中一个结果，发现`url's`可以在`<cite>`标签之间找到。

![在此处输入图像描述](../Images/2b6f849bc5ec3772708165c057089008.png)

我的问题是：
如何将每个元素的 HTML 转换为字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:02:12.353

假设您只关心提取 and 之间`<cite>`的内容，您可以通过拆分然后从每个项目中删除`</cite>`来解析字符串。您还可以从每个项目中删除and 。从索引 1 到数组上限的项目应该有你的链接。`<cite>``</cite>``<b>``</b>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T00:11:18.880

使用[HTML Agility Pack](http://nuget.org/packages/HtmlAgilityPack)可以大大简化解析 HTML 的过程。

这是一个非常基本的实现来做你正在寻找的东西：

```
Private Sub DoSearch(query As String)
    Dim wc = New WebClient()
    wc.DownloadStringAsync(New Uri("http://google.com/search?q=" + query))
    AddHandler wc.DownloadStringCompleted, AddressOf ParseResults
End Sub

Private Sub ParseResults(sender As Object, e As DownloadStringCompletedEventArgs)
    LvResults.Items.Clear()

    If e.Error IsNot Nothing Then
        MsgBox(e.Error.Message, MsgBoxStyle.Critical Or MsgBoxStyle.OkOnly)
        Exit Sub
    End If

    Dim htmlDoc As New HtmlAgilityPack.HtmlDocument()
    htmlDoc.LoadHtml(e.Result)

    For Each node In htmlDoc.DocumentNode.SelectNodes("//h3[@class='r']/a")
        Dim item As New ListViewItem(node.InnerText)
        item.SubItems.Add(CleanURL(node.Attributes("href").Value))
        LvResults.Items.Add(item)
    Next

    LvResults.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent)
End Sub

Private Function CleanURL(url As String) As String
    url = url.Replace("/url?q=", "")
    If url.Contains("&") Then url = url.Split("&"c)(0)
    Return url
End Function 
```

成功使用 HTML Agility Pack 的诀窍是知道将生成正确结果的正确 XPath，但这可能很棘手，特别是对于初次使用的用户。

因此，我强烈建议您下载[HAP Testbed](http://haptestbed.codeplex.com/)以帮助您测试和试验多个 XPath，直到您获得所需的内容（无需不断调试您的应用程序来测试您的更改）。

* * *

如果您愿意，可以下载实现此代码的功能示例：[SearchToListView](http://software.xfx.net/stackoverflow/SearchToListView.zip)

# java - Maven：surefire插件忽略-Dgroups时 已经配置

> ID：14408317
> 
> 赞同：5
> 
> 时间：2013-01-18T21:57:18.260
> 
> 标签：java, maven, junit, surefire

我的项目有一些`JUnit`我很少想运行的测试。为此，我将它们放入 a 中`@Category`，然后执行以下操作：

```
<plugin>
   <artifactId>maven-surefire-plugin</artifactId>
   <!-- Run all but the inject tests -->
   <configuration>
      <groups>!be.test.InjectTests</groups>
   </configuration>
</plugin> 
```

我想覆盖命令行中的配置以运行注入测试，如下所示：

```
mvn clean install -Dgroups=be.test.InjectTests 
```

但这不起作用， -Dgroups 被 Maven 忽略。

如果我不把命令工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:50:24.613

不幸的是，如果在 pom 中设置了某些东西，它似乎不容易被覆盖（如果你`skipTests`明确设置，也很难用属性覆盖）......但是！（这有点小技巧）您可以将属性的设置推迟到 pom 属性，然后在命令行上覆盖它。

```
<project>
...
<properties>
    <groups>!Slow</groups>
<properties>
....
<build>
    <plugins>
        ...
        <plugin>
           <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-surefire-plugin</artifactId>
           <version>2.13</version>
           <configuration>
            <groups>${groups}</groups>
           </configuration>
        </plugin>
    </plugins>
</build>
... 
```

有了这个（以及一个快速构建的项目，在 OSX、Maven 3.0.4、Java 1.6.0_37 上运行）：

```
$ mvn clean test
...
Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
...
$ mvn clean test -Dgroups=Slow
...
Results :

Tests run: 3, Failures: 0, Errors: 0, Skipped: 0 
```

# mysql - 如何知道 MySQL 中使用了哪些索引？

> ID：14408319
> 
> 赞同：0
> 
> 时间：2013-01-18T21:57:21.303
> 
> 标签：mysql, database, explain, database-indexes

我的 MYSQL 数据库中有一个表，其中创建了许多索引，但我不知道这些索引中的哪些有用，哪些没有。我想知道生产中使用的索引是什么。

有没有办法使用索引日志？

我知道 EXPLAIN 命令，但这是针对一个特定查询的。我有一个复杂的系统，所以我无法确切知道正在使用的查询是什么。我可以打开通用日志，获取所有查询并对所有查询进行解释，然后获取汇总结果，但必须有一种更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:44:00.593

为了分析查询和索引，我使用名为[SQLYog](http://www.webyog.com/product/sqlyog)的 GUI 工具。非常有用，功能强大且易于使用。

# asp.net - 捕获“ReturnUrl”以进行重定向

> ID：14408326
> 
> 赞同：0
> 
> 时间：2013-01-18T21:58:10.570
> 
> 标签：asp.net

我正在使用表单身份验证。当我的表单超时时，我得到了 URL：

```
http://XXXXXX/login.aspx?ReturnUrl=%2fSessionExpired.aspx 
```

有没有办法说 url 是否包含“ReturnUrL”重定向到 sessiontimeout.aspx？我试过把它放在我的 global.asax 中，但它不起作用。它仍然转到： `http://XXXXXX/login.aspx?ReturnUrl=%2fSessionExpired.aspx`，这是我的登录页面。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:09:31.997

您可以在 login.aspx 中的变量中捕获`ReturnUrl`它的值。**`Request.QueryString`**

我猜您正在使用`FormsAuthentication.RedirectFromLoginPage`如果您想先检查并决定将自己重定向到哪里；你应该**`SetAuthCookie`**使用`FormsAuthentication`. 然后您可以自己重定向页面。

此外，还有一种**`FormsAuthentication.GetRedirectUrl`**方法。文档注释“*当您想在应用程序代码中执行重定向时可以使用此方法，而不是使用 RedirectFromLoginPage 方法。* ”请参阅**[此处的文档](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.getredirecturl.aspx)**。

# testing - 在 TFS 中进行系统测试的最佳方法是什么？

> ID：14408327
> 
> 赞同：0
> 
> 时间：2013-01-18T21:58:17.343
> 
> 标签：testing, architecture, tfs

我有 TFS 2010，以及一个带有从某些文件填充的数据库的应用程序。现在文件可能有 200K 行那么大，我想生成一个测试来扫描表中的每条记录并报告它们是否遵循我们的业务逻辑。

在 TFS 中执行此操作的正确架构是什么？

我尝试进行单元测试，打开与数据库的 ODBC 连接并测试每一行，例如：

```
 Assert.IsNotNull(trec("id").value, "Record ID is required") 
```

但当然，它会在第一次失败时停止，我想扫描整个表。

我可以从头开始创建自己的结构，但我的开发人员喜欢通过 TFS 进行报告。有人可以指出我的例子或参考吗？

# sql - 在不使用调试方法的情况下查找代码运行时传递哪些参数的最快方法？

> ID：14408328
> 
> 赞同：0
> 
> 时间：2013-01-18T21:58:20.037
> 
> 标签：sql

我已经执行了隐藏在代码中的存储过程，因此需要一些时间来调试代码中的错误。我想知道在不使用调试的情况下运行代码时确定将哪些参数传递给存储过程的最快方法是什么？这是在 SQL Server 2005 中。

# c++ - C加加Kill进程windows标题

> ID：14408330
> 
> 赞同：2
> 
> 时间：2013-01-18T21:58:22.190
> 
> 标签：c++

在这个简单的脚本中，我需要你的一点帮助。我正在尝试通过阅读 Windows 标题来创建一个运行“taskkill”的脚本，但我不知道如何让它在 C++ 中运行。据我所知，批量将非常容易

```
system("TASKKILL /F /FI "WINDOWTITLE eq Notepad*""); 
```

但是当我尝试在 C++ 中这样做时

```
#include <iostream>
#include <cstdlib>

int main()
{
using namespace std;

system("TASKKILL /F /FI "WINDOWTITLE eq Notepad*""); 

} 
```

我无法编译它！我在 DevC++ 中得到了这个

> [错误] 'WINDOWTITLE' 之前应为 ')'

我确信问题在于能够运行 Windowstitle 所需的“_”，但如果没有它，它将无法工作。

有什么建议吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T21:59:20.020

转义引号：

```
system("TASKKILL /F /FI \"WINDOWTITLE eq Notepad*\""); 
//                     ^^^                      ^^^ 
```

# java - Eclipse 的 Google 插件：如何在运行配置中添加 JVM 参数

> ID：14408340
> 
> 赞同：2
> 
> 时间：2013-01-18T21:59:20.063
> 
> 标签：java, eclipse, google-app-engine, google-plugin-eclipse

[如https://developers.google.com/appengine/docs/java/cloud-sql/developers-guide](https://developers.google.com/appengine/docs/java/cloud-sql/developers-guide)中所述，我需要在 Eclipse 中的“程序参数”文本框的“参数”选项卡上为我的 App Engine 运行配置添加参数

```
 --jvm_flag=-Drdbms.server=local
 --jvm_flag=-Drdbms.driver=com.mysql.jdbc.Driver
 --jvm_flag=-Drdbms.url=jdbc:mysql://localhost:3306/yourdatabase?user=username&password=password 
```

但我总是遇到快速错误：

```
Usage: <dev-appserver> [options] <app directory>

Options:
 --help, -h                 Show this help message and exit.
 --server=SERVER            The server to use to determine the latest
  -s SERVER                   SDK version.
 --address=ADDRESS          The address of the interface on the local machine
  -a ADDRESS                  to bind to (or 0.0.0.0 for all interfaces).
 --port=PORT                The port number to bind to on the local machine.
  -p PORT
 --sdk_root=DIR             Overrides where the SDK is located.
 --disable_update_check     Disable the check for newer SDK versions.
 --generated_dir=DIR        Set the directory where generated files are created.
 --jvm_flag=FLAG            Pass FLAG as a JVM argument. May be repeated to
                              supply multiple flags. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:13:43.783

在`Run Configurations - Arguments`中，将以下 jvm_flag 参数添加到`VM arguments`部分，而不是`Program arguments`部分：

```
-Drdbms.server=local
-Drdbms.driver=com.mysql.jdbc.Driver
-Drdbms.url=jdbc:mysql://localhost:3306/yourdatabase?user=username&password=password 
```

这应该可以解决您的问题。

# perl - 在perl中对数组进行排序

> ID：14408341
> 
> 赞同：0
> 
> 时间：2013-01-18T21:59:24.473
> 
> 标签：perl, sorting

我在 perl 中有一个数组，其中包含大约 200 个用于 csv 文件的索引。它喜欢下面的行：

```
46.9234784633993,Springwood Drive,Naples,FL
89.7786182217159,W 8th St,Lakeland,FL 
```

我想在第一个逗号之前按该数字对它们进行排序。我尝试只使用排序，但有时数字会达到成百上千，它只是对所有 1 中的数字进行排序。然后数字排序不喜欢它，因为它们不是数字条目

我试过这个

```
my @sortedDistances = sort{ $a <=> $b }(@completedDistances);
and
my @sortedDistances = sort(@completedDistances); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:22:40.207

这是一个可能的解决方案，试试它是否有效：

```
open FILE, "<", $ARGV[0] or die $!;
my @sorted =
    map { join ",", @{$_} }
    sort { $a->[0] <=> $b->[0] }
    map { [ split /,/ ] } <FILE>;
close FILE;
say join "\n", @sorted; 
```

编辑：将冒号更改为逗号

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T01:49:52.610

我认为打算编码的经典[*Schwartzian Transform看起来像这样*](http://www.stonehenge.com/merlyn/UnixReview/col64.html)`@sdir`

```
use strict;
use warnings;

my @sorted =  map $_->[0],
              sort { $a->[1] <=> $b->[1] }
              map [$_, /([^,]+)/], <>;

print for @sorted; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:14:51.120

正常排序救援

```
sort -t, -n -k1,1 file.cvs 
```

-t，表示在comman 处分开

-n 或 -g 数字排序

-k1,2 使用第 1 到 2 列见 -t

[人排序](http://unixhelp.ed.ac.uk/CGI/man-cgi?sort)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-18T22:20:18.983

我会编写一个排序函数来获取每个项目的第一项，然后对这些项目进行比较。它将是以下形式：

```
sub sortStuff($$)
{
  my ($a) = split(',',$_[0]);
  my ($b) = split(',',$_[1]);

  return ( $a <=> $b ) ;
} 
```

然后调用子例程作为调用排序的一部分：

```
@sortedArray = sort sortStuff @array; 
```

它将按数字排序并忽略该行中的其余项目。

# jquery - 绑定鼠标滚轮返回未定义

> ID：14408348
> 
> 赞同：3
> 
> 时间：2013-01-18T22:00:00.750
> 
> 标签：jquery

我正在测试以下代码：

```
$(window).bind('mousewheel', function(e) {
  alert(e.wheelDelta);
}); 
```

每次我移动鼠标轮时，我都会得到“未定义”。任何人都可以帮助解决这个问题，因为我正在尝试捕获鼠标滚轮并基于它移动一个 div。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:04:24.213

我认为你必须做更多的工作才能让它在所有浏览器中工作 - 或者尝试[jquery-mousewheel 扩展](https://github.com/brandonaaron/jquery-mousewheel)

如果扩展仍然无法正常工作，您可以尝试我之前创建的这个修改版本：

```
/* jquery.mousewheel.min.js
 * Copyright (c) 2009 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 *
 * Version: 3.0.2
 * 
 * Requires: 1.2.2+
 */
(function(c) {
    var a = [ "DOMMouseScroll", "mousewheel" ];
    c.event.special.mousewheel = {
        setup : function() {
            if (this.addEventListener) {
                for ( var d = a.length; d;) {
                    this.addEventListener(a[--d], b, false)
                }
            } else {
                this.onmousewheel = b
            }
        },
        teardown : function() {
            if (this.removeEventListener) {
                for ( var d = a.length; d;) {
                    this.removeEventListener(a[--d], b, false)
                }
            } else {
                this.onmousewheel = null
            }
        }
    };
    c.fn.extend({
        mousewheel : function(d) {
            return d ? this.bind("mousewheel", d) : this.trigger("mousewheel")
        },
        unmousewheel : function(d) {
            return this.unbind("mousewheel", d)
        }
    });
    function b(f) {
        var d = [].slice.call(arguments, 1), g = 0, e = true;
        if (f.wheelDelta) {
            g = f.wheelDelta / 120
        }
        if (f.detail) {
            g = -f.detail / 3
        }
        // I had to move the following two lines down, probably because of jQuery update
        f = c.event.fix(f || window.event);
        f.type = "mousewheel";
        f.pageX = f.originalEvent.pageX;
        f.pageY = f.originalEvent.pageY;
        d.unshift(f, g);
        return c.event.handle.apply(this, d)
    }
})(jQuery); 
```

我只是在火狐和Chrome中测试过，不知道在其他浏览器中是否可以使用。用法：

```
$('element').mousewheel(function(e, delta) { alert(delta); }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:59:54.213

我最终使用了以下代码段：

```
jQuery(function($) {
$(document)
        .bind('mousewheel', function(event, delta) {
        if(delta > 0) {
                    // Scrolling down
        } else {
                    // Scrolling up
        }
    });
}); 
```

这需要 jquery 鼠标滚轮扩展，适用于 IE、Firefox 和 Chrome。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-31T16:01:08.260

我遇到了同样的问题，解决方法是将 jquery 版本从 1.7.x 更改为 1.9.x

# jquery - 备用表行背景颜色，每个 tbody 重新启动

> ID：14408352
> 
> 赞同：0
> 
> 时间：2013-01-18T22:00:32.773
> 
> 标签：jquery

我可以为表格中的交替行添加背景，如下所示：

```
$(".myTbl tr:even td").css("background-color", "#f5f5f5"); 
```

但是，如果我有多个使用同一个表的实例，我希望它在每组中重新启动。由于某种原因，以下代码不起作用：

```
$("tbody tr:even td").css("background-color", "#f5f5f5"); 
```

PS 使用 jQuery 安抚旧版 IE 浏览器...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:41:09.710

在这里，使用这个

```
$(document).ready(function()
    {
      $("table tbody tr:even").css("background-color", "#F4F4F8");
      $("table tbody tr:odd").css("background-color", "#EFF1F1");
    }); 
```

# github - 如何在 Github 中获取更多上下文

> ID：14408353
> 
> 赞同：23
> 
> 时间：2013-01-18T22:00:37.833
> 
> 标签：github, diff

在 github 提交查看器或拉取请求查看器或比较视图中，我可以让它在差异周围显示更多的上下文行吗？

使用 git cli，我会做 git diff -U100 （或者我想要的多行上下文）。

我检查了 help.github.com 没有运气（上下文行甚至没有出现）。其他差异查看器通常会这样做，而其他代码审查工具通常会这样做。而且 Github 有各种隐藏功能，所以我想这里可能有隐藏功能。这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-12-03T01:34:47.170

Github 刚刚通过单击差异视图的排水沟发布了一个功能：[https ://github.com/blog/1705-expanding-context-in-diffs](https://github.com/blog/1705-expanding-context-in-diffs)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-03T20:13:44.257

**更新：**此功能现已存在[https://github.com/blog/1705-expanding-context-in-diffs](https://github.com/blog/1705-expanding-context-in-diffs)

一个月前，我向 github 发送了一个关于此的功能请求，并得到了这个答案：

> 马蒂亚斯，
> 
> 感谢您的反馈。请放心，我们知道差异显示可以改进，因为我们感到同样的痛苦。我们有创意™。
> 
> 约瑟夫

所以让我们希望他们想出一些好的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-15T14:21:32.477

我还向 github 发送了一个功能请求，并给出了类似的响应，但与此同时，我一直在使用 mridgway 的 github-expand-diff FF/chromegreasemonkey 脚本，它运行得非常好：

[https://github.com/mridgway/github-expand-diff](https://github.com/mridgway/github-expand-diff)

# jquery-mobile - 在 jquery mobile 中对 pageLoadErrorMessage 使用服务器响应

> ID：14408355
> 
> 赞同：1
> 
> 时间：2013-01-18T22:00:40.660
> 
> 标签：jquery-mobile

尽管您可以更改 JQuery Mobile 中的默认错误响应，但可以执行以下操作：

```
$(document).bind("mobileinit", function() {
    $.mobile.pageLoadErrorMessage = 'This is my custom error.';
});￼ 
```

我想使用从实际应用程序返回的错误，这允许我根据错误设置不同的消息。

例如，如果`Forbidden`出现错误，我想显示与该问题相关的内容。

如果这对 JQuery 更可口，我可以灵活地将响应作为 JSON 返回，我只是不确定如何`pageLoadErrorMessage`使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T08:06:42.917

您可以[`pageloadfailed`](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)为此使用事件。

```
$(document).on("pageloadfailed", function(event, data){
    event.preventDefault();

    var errMessage = data.xhr.status + " " + data.xhr.statusText;

    setTimeout(function(){
        $.mobile.loading('hide');
        $.mobile.loading('show', {theme:"e", text:errMessage, textonly:true, textVisible: true});
    },50);

    setTimeout(function(){$.mobile.loading('hide')}, 2000);

    data.deferred.reject(data.absUrl, data.options);
}); 
```

[jsFiddle](http://jsfiddle.net/pmatseykanets/5m8kj/)

# facebook-graph-api - 获得访问用户音乐收藏夹的权限

> ID：14408357
> 
> 赞同：0
> 
> 时间：2013-01-18T22:00:56.460
> 
> 标签：facebook-graph-api, permissions, facebook-php-sdk, favorites

我们需要使用 PHP SDK 通过我们的应用程序从用户帐户中获取音乐收藏夹，但`$facebook->api('/' . $facebookUser['id'] . '/music', 'get')`如果用户已将音乐收藏夹的权限更改为公共，则调用只会检索信息。

有没有办法让用户获得访问他们收藏夹的特殊权限，即使他们没有将这些权限设置为公开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:20:27.263

您需要`user_likes`or`friends_likes`权限才能获得此信息。

如果未设置为公开，则还需要`access_token`从可以查看此信息的用户中获得一个用户。

如果您试图规避用户的隐私选项，这是让您的应用被禁止的好方法。

# iphone - 将附加项目写入磁盘失败

> ID：14408358
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:01:00.197
> 
> 标签：iphone, ios, objective-c, ipad

我有以下代码：

```
 NSData * JSONData = [MyJSON dataWithJSONObject:highlightItemsArray];
                if ([JSONData isNotNull]){
                    NSError *error;
                    BOOL writeToDiskSuccess = [JSONData writeToFile:self.highlightDiskCachePath_ options:NSDataWritingAtomic error:&error];
                    if (!writeToDiskSuccess){
                        NSLog(@"Writing appended caption failed %@", error);
                    } else {
                        NSLog(@"Writing appended caption succeed");
                    }
                } 
```

但是，当打印为空时，这将返回 NO 和错误。我怎样才能找出问题所在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:16:47.657

我认为您需要添加更多细节才能在此处获得答案。

我假设你得到 writeToDiskSuccess = FALSE？如果是这样的话，我首先要看的是你是否错误地写入了错误的目录......你能给出 self.highlightDiskCachePath_ 的值吗？你在模拟器上也遇到同样的错误吗？如果是这样，您应该能够在 Finder 中导航到那里，以查看是否缺少路径元素或其他磁盘问题，为什么它不能在那里写入。

最后我会检查它不是特定于 JSONData writeToFile 失败的东西......你能写一个简单的文本文件到你试图写这个的位置吗？

此外，可能值得注意的是控制台输出中可能不寻常的任何内容，当这些事情失败时，您有时会在那里获得线索。

# vba - 使用范围变量...语法

> ID：14408359
> 
> 赞同：0
> 
> 时间：2013-01-18T22:01:01.410
> 
> 标签：vba

我有以下代码：

```
Set rFinder = wkEnrollment.Range("EnrollmentIDs")  
With Range(rFinder)
    Set LastCell = .Cells(.Cells.Count)
End With 
```

当我做我的`With Range(rFinder)`线路时它会出错。 `rFinder`变暗为`Range`. 错误是：

> 对象“_Global”的方法“范围”失败

我不确定这个的语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:03:45.797

由于`rFinder`已经是 Range 对象，您应该简单地使用：

```
Set rFinder = wkEnrollment.Range("EnrollmentIDs")  
With rFinder
    Set LastCell = .Cells(.Cells.Count)
End With 
```

# jquery - 变量作为 Jquery 选择器无效？

> ID：14408363
> 
> 赞同：0
> 
> 时间：2013-01-18T22:01:12.887
> 
> 标签：jquery

我目前有这些 Jquery 行

```
var location = urlParams["location"]; //grabs URL parameter generated from earlier function
alert (location); // alerts the value WEST
alert ($("#" + location)); //returns [object Object]
var name = $("#" + location).attr("name").split(".");
alert (name); // no alert box appears
var css = name[0] + "px " + name[1] + "px";
$("#main-div").css("background-position",css)
alert ("Even this alert won't appear?"); 
```

代码针对此 HTML 运行：

```
<a class="nav-links r1s1" id = "WEST" name="0.0" href="test.php?loc=WEST"></a> 
```

不为名称生成任何值。后来的警报甚至不会出现，这让我相信这条线有问题：

```
var name = $("#" + location).attr("name").split("."); 
```

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:07:25.730

对这条线的修改似乎解决了它。

```
 var location = String(urlParams["location"]); 
```

谢谢大家。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T22:08:32.360

我认为根据您想要的第一个或第二个部分，您需要这样做：

```
var name = $("#" + location).attr("name").split(".")[0]; 
```

或者

```
var name = $("#" + location).attr("name").split(".")[1]; 
```

# php - nuSOAP - 注册一个不返回任何内容的函数？

> ID：14408365
> 
> 赞同：0
> 
> 时间：2013-01-18T22:01:17.747
> 
> 标签：php, nusoap

我希望我的 SOAP 服务器注册一个不返回任何内容的函数。我尝试将 array() 作为返回列表传递，但它不起作用。我怎样才能做到这一点？

# javascript - 如何使用 JQuery 将动态内容加载到 DIV

> ID：14408366
> 
> 赞同：2
> 
> 时间：2013-01-18T22:01:27.123
> 
> 标签：javascript, jquery, html, jquery-load

我有一个 div：

```
<div id="content"></div> 
```

当页面加载时，我调用一个`.load()`. 此加载大约需要 10 分钟才能完成，并且在执行期间，其 PHP 文件会返回一些有关执行状态的信息，例如 Linux 加载。我想`#content`动态地将这些信息放入 div 中，但`.load()`仅在执行结束时放入。有人可以帮我这样做吗？

`.load()`来电：

```
$("#content").load("/admin/ajax/analyse.php"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T01:30:46.430

jQuery 的 ajax 接口不提供获取响应进度更新的方法（即使它声称是浏览器原生`XMLHttpRequest`对象的超集）。显然，[这样的用例对于 jQuery 开发人员来说是不可想象的](http://api.jquery.com/jQuery.ajax/#jqXHR)：

> 然而，没有提供任何`onreadystatechange`机制，因为、`success`和涵盖了所有可能的要求。`error``complete``statusCode`

通过直接使用 an ，您可以在事件处理程序`XMLHttpRequest`中读取响应的当前进度：`onreadystatechange`

```
var xhr = new XMLHttpRequest();
xhr.open("GET", "/admin/ajax/analyse.php", true);
xhr.onreadystatechange = function receiveUpdate(e) {
    $("#content").html(this.responseText);
}
xhr.send(); 
```

这适用于大多数浏览器的最新版本，包括 IE 10、Chrome 和 Firefox。

**演示：**

*   [持续发送响应 10 分钟](http://jumpingfishes.com/progresstest2.htm)
*   [在发送数据超过 15 分钟之间暂停几分钟](http://jumpingfishes.com/progresstest3.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:28:25.017

这只是一个你必须淘汰的想法......

在服务器上，

1.  用户点击 URL #1，
2.  如果还没有会话，则开始会话。
3.  启动生成数据的异步进程。
4.  当它完成部分数据时，它会排队。更简单地说，它将数据以块的形式放在某处。可能是内存中缓存的数据库。
5.  当异步任务生成所有数据时，它会使用一些魔术字符串发送文件结束指示。

在服务器上也：

1.  同一个用户点击 URL #2（你从会话信息中知道）
2.  你从队列的前面给他一大块数据。
3.  每次他点击 URL #2 时，您都会给他更多数据。
4.  当浏览器最后一次请求并且只剩下文件结束指示时，服务器可以返回一些表明没有更多数据的HTTP结果代码，或者它可以返回魔术字符串。

在客户端，

1.  对 URL #1 执行 ajax 请求以启动服务器生成。
2.  重复向 URL #2 发出请求。
3.  每个结果都会附加到页面元素，以便用户可以在它到达时看到它。
4.  当客户端请求返回“没有更多数据”结果代码（或神奇的文件结尾字符串）时，它会停止请求更多数据并向用户发出信号，方法是在屏幕上显示所有数据都在那里。

那应该对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:14:48.750

有几种方法可以解决这个问题，但所有这些都需要服务器端的更改。一种解决方案（我认为最适合您想象它的工作方式）是[long polling](http://en.wikipedia.org/wiki/Comet_%28programming%29#Ajax_with_long_polling)。

请参阅有关[使用 PHP 和 jQuery 进行长轮询的问题](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)。

# java - EJB 3.0 异常处理

> ID：14408369
> 
> 赞同：13
> 
> 时间：2013-01-18T22:01:40.967
> 
> 标签：java, jakarta-ee, exception, ejb, ejb-3.0

EJB 规范的引用：

> 如果 bean 方法遇到系统异常或错误，它应该简单地将错误从 bean 方法传播到容器（即 bean 方法不必捕获异常）。

但我不明白。这是否意味着我不应该捕获所有类型的异常（即尝试捕获`Exception`类）并将其作为我的应用程序异常重新抛出？

一个更清晰的例子：

```
public void beanMethod throws MyApplicationException {
  try {
    // do something
  } catch (Exception e) {
     throw new MyApplicationException(e); // Should I do it like this? 
  }
} 
```

或者这不是针对 EJB 开发人员，而仅针对 EJB 引用实现开发人员（容器开发人员）：在后一种情况下，因此，容器不能将系统异常传播到我的业务方法，并且我的`catch(Exception e)`块永远不会捕获任何系统异常?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-18T22:20:35.613

还有更多类型的异常：

*   系统异常（RuntimeExceptions 例如 NullPointerException）
*   业务异常（您自己的异常，扩展异常，但不是 RuntimeException，例如 NotEnoughMoneyOnYourAccountException）
*   错误（例如 OutOfMemoryError）

通常你应该捕获业务异常。但当然，如果你想在那里处理它，你可以把它扔到客户端。默认情况下，如果您抛出 BusinessException，EJB 容器不会回滚您的事务，但您可以通过以下方式注释您的 Exception 来更改此行为：

```
@ApplicationException(rollback = true)
public class NotEnoughMoneyOnYourAccountException extends Exception { 
```

如果您的程序抛出 RuntimeException，它将被包装为 RemoteException 发送到客户端，并且您的事务将被回滚。这些异常比业务异常少，因此我们通常不会在 EJB 端捕获它们。

错误是最不例外的，它们甚至可以关闭 JVM，通常我们不会捕获它们，因为通常我们无法在程序中处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:07:47.247

我不知道你从哪里得到这个提示以及上下文是什么，但这似乎意味着 bean 方法本身根本不应该进行异常处理，只要抛出它得到的任何东西。这种行为通常最好通过添加方法体可能抛出的异常来实现，具体取决于环境/随机因素，例如现在在`throws`哪里的 clausule 中的变量输入`MyApplicationException`。

直接由方法中的代码错误（而不是方法调用）引起的异常通常不需要正确处理，应该通过测试和调试来解决。

# github - 如何在 GitHub wiki checkout 中使用子目录？

> ID：14408376
> 
> 赞同：11
> 
> 时间：2013-01-18T22:02:39.340
> 
> 标签：github, wiki, gollum-wiki

我想在子目录中组织我的 GitHub wiki 页面。我们如何引用子目录中的页面？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T04:05:40.107

github wiki / [gollum-wiki](https://github.com/github/gollum)本身并没有提供任何明确的内容来将页面组织到子目录中。任何页面都可以从任何其他页面链接，无论它在逻辑上属于何处。这是一个强大的功能，使 wiki 非常灵活。

实现子目录结构的一种方法是遵循命名约定。

示例：所有相关页面的`subject1`名称都以 开头`subject1`，依此类推。

# html - ClojureScript 和 HTML 实体

> ID：14408377
> 
> 赞同：12
> 
> 时间：2013-01-18T22:02:41.400
> 
> 标签：html, clojurescript

我无法通过 ClojureScript 在 HTML 中获取不间断的空间。

如果我使用“ ” 该字符串只是按字面意思打印。

我正在使用 Crate 库。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-04-29T00:42:16.503

clojurescript 利用的 Google 闭包库包括允许您扩展 HTML 实体的字符串助手。

```
(require '[goog.string :as gstring])
(gstring/unescapeEntities "&nbsp;") 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-19T13:17:12.443

看完后明白了：

[https://github.com/ibdknox/crate/issues/12](https://github.com/ibdknox/crate/issues/12)

基本上，问题似乎是 Crate 直接插入到 DOM 中，因此跳过了实体扩展（如果我误解了，请有人纠正我）。

一种解决方案是使用以下表示 UTF 的字符串`&nbsp:` `\u00A0`。

# apache-pig - apache pig - 将网址解析为地图

> ID：14408380
> 
> 赞同：1
> 
> 时间：2013-01-18T22:02:45.877
> 
> 标签：apache-pig

我对猪很陌生，并且对日志解析有疑问。我目前通过 regex_extract 解析出我的 url 字符串中的重要标签，但我认为我应该将整个字符串转换为地图。我正在使用 0.10 处理一组样本数据，但我开始迷路了。实际上，我的 url 字符串有重复的标签。所以我的地图实际上应该是一张以袋子为值的地图。然后我可以使用 flatten 编写任何后续工作。

这是我的测试数据。最后一个条目显示了我的重复标签问题。

```
`pig -x local`
grunt> cat test.log
test1   user=3553&friend=2042&system=262
test2   user=12523&friend=26546&browser=firfox
test2   user=205&friend=3525&friend=353 
```

我正在使用标记化来生成内袋。

```
grunt> A = load 'test.log' as (f:chararray, url:chararray);
grunt> B = foreach A generate f, TOKENIZE(url,'&') as attr;
grunt> describe B;
B: {f: chararray,attr: {tuple_of_tokens: (token: chararray)}}

grunt> dump B;
(test1,{(user=3553),(friend=2042),(system=262)})
(test2,{(user=12523),(friend=26546),(browser=firfox)})
(test2,{(user=205),(friend=3525),(friend=353)}) 
```

在这些关系上使用嵌套的 foreach，但我认为它们有一些我不知道的限制..

```
grunt> C = foreach B {
>> D = foreach attr generate STRSPLIT($0,'=');
>> generate f, D as taglist;
>> }

grunt> dump C;
(test1,{((user,3553)),((friend,2042)),((system,262))})
(test2,{((user,12523)),((friend,26546)),((browser,firfox))})
(test2,{((user,205)),((friend,3525)),((friend,353))})

grunt> G = foreach C {
>> H = foreach taglist generate TOMAP($0.$0, $0.$1) as tagmap;
>> generate f, H as alltags;
>> }

grunt> describe G;
G: {f: chararray,alltags: {tuple_of_tokens: (tagmap: map[])}}

grunt> dump G;
(test1,{([user#3553]),([friend#2042]),([system#262])})
(test2,{([user#12523]),([friend#26546]),([browser#firfox])})
(test2,{([user#205]),([friend#3525]),([friend#353])})

grunt> MAPTEST = foreach G generate f, flatten(alltags.tagmap);
grunt> describe MAPTEST;
MAPTEST: {f: chararray,null::tagmap: map[]}

grunt> res = foreach MAPTEST generate $1#'user';
grunt> dump res;
(3553)
()
()
(12523)
()
()
(205)
()
()

grunt> res = foreach MAPTEST generate $1#'friend';
grunt> dump res;
()
(2042)
()
()
(26546)
()
()
(3525)
(353) 
```

所以这并不可怕。我认为它很接近，但并不完美。我更担心的是我需要对标签进行分组，因为最后一行有 2 个“朋友”标签，至少在我将其添加到地图之前。

```
grunt> dump C;
(test1,{((user,3553)),((friend,2042)),((system,262))})
(test2,{((user,12523)),((friend,26546)),((browser,firfox))})
(test2,{((user,205)),((friend,3525)),((friend,353))}) 
```

我尝试使用一组嵌套的 foreach ，但这会导致错误。

```
grunt> G = foreach C {
>> H = foreach taglist generate *;
>> I = group H by $1;
>> generate I;
>> }
2013-01-18 14:56:31,434 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1200:   <line 34, column 10>  Syntax error, unexpected symbol at or near 'H' 
```

任何人有任何想法如何更接近将此 URL 字符串生成到包地图中？认为会有一个猪宏或其他东西，因为这似乎是一个常见的用例。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:57:54.887

我想我会更新这个，以防将来有人尝试这样做。我从来没有让猪拉丁文工作，但我走了完整的 UDF 路线。可悲的是，我并不是一个真正的程序员，所以 Java 示例让我迷失了一段时间。但我设法破解了一个迄今为止一直在工作的 python UDF。仍然需要清理它以处理错误等等，但这现在可以使用。我敢肯定还有更好的java方法来做到这一点。

```
#!/usr/bin/python
@outputSchema("tagmap:map[{(value:chararray)}]")

def inst_url_parse(url_query):
        query_vals = url_query.split("&")
        url_query_map = {}
        for each_val in query_vals:
                kv = each_val.split("=")
                if kv[0] in url_query_map:
                        url_query_map[kv[0]].append(kv[1])
                else:
                        url_query_map[kv[0]] = [kv[1]]

        return url_query_map 
```

我真的很喜欢我们的 URL 查询以这种方式存储，因为每个键可以有 0,1,N 值。下游作业只需在 eval 中调用 flatten(tagmap#'key') ，与我之前所做的相比，它相当轻松。我们可以使用它更快地开发。我们还将数据存储在 hcatalog 中

```
querymap<string, array<string>> 
```

并且它似乎也适用于使用 LATERAL VIEW 的配置单元查询/视图。谁知道？

抱歉，如果这对于 Q 和 A 网站来说过于固执己见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:11:01.547

好消息和坏消息。好消息是实现这一点非常简单。坏消息是，如果不使用 UDF，您将无法实现我认为的理想状态——单个映射中的所有标记/值对。

首先，一些提示：`FLATTEN`结果是`STRSPLIT`这样你的元组中没有无用的嵌套级别，并且`FLATTEN`再次嵌套在嵌套中`foreach`，这样你以后就不需要这样做了。此外，`STRSPLIT`还有一个可选的第三个参数来给出输出字符串的最大数量。使用它来保证其输出的模式。这是脚本的修改版本：

```
A = load 'test.log' as (f:chararray, url:chararray);
B = foreach A generate f, TOKENIZE(url,'&') as attr;
C = foreach B {
    D = foreach attr generate FLATTEN(STRSPLIT($0,'=',2)) AS (key:chararray, val:chararray);
    generate f, FLATTEN(D);
};
E = foreach (group C by (f, key)) generate group.f, TOMAP(group.key, C.val);
dump E; 
```

输出：

```
(test1,[user#{(3553)}])
(test1,[friend#{(2042)}])
(test1,[system#{(262)}])
(test2,[user#{(12523),(205)}])
(test2,[friend#{(26546),(3525),(353)}])
(test2,[browser#{(firfox)}]) 
```

在您完成拆分标签和值之后，`group`也可以通过标签来获取您的值包。然后将其放入地图中。请注意，这假设如果您有两行具有相同的 id ( `test2`, 此处) 您希望将它们组合起来。如果不是这种情况，您需要为该行构造一个唯一标识符。

不幸的是，显然没有办法在不使用 UDF 的情况下组合地图，但这应该是所有可能的 UDF 中最简单的。类似（***未经测试***）：

```
public class COMBINE_MAPS extends EvalFunc<Map> {
    public Map<String, DataBag> exec(Tuple input) throws IOException {
        if (input == null || input.size() != 1) { return null; }

        // Input tuple is a singleton containing the bag of maps
        DataBag b = (DataBag) input.get(0);

        // Create map that we will construct and return
        Map<String, Object> m = new HashMap<String, Object>();

        // Iterate through the bag, adding the elements from each map
        Iterator<Tuple> iter = b.iterator();
        while (iter.hasNext()) {
            Tuple t = iter.next();
            m.putAll((Map<String, Object>) t.get(0));
        }

        return m;
    }
} 
```

使用这样的 UDF，您可以执行以下操作：

```
F = foreach (group E by f) generate COMBINE_MAPS(E.$1); 
```

请注意，在此 UDF 中，如果任何输入映射的键重叠，则其中一个将覆盖另一个，并且无法提前判断哪个会“获胜”。如果这可能是一个问题，您将需要向 UDF 添加某种错误检查代码。

# java - MiG 布局到 iText PDF

> ID：14408385
> 
> 赞同：0
> 
> 时间：2013-01-18T22:03:16.313
> 
> 标签：java, swing, itext, miglayout

我想使用 iText 库将在我的程序中创建的文档（由 JPanel、JTextAreas、JLabels 等制成）导出为 pdf。

我将在 iText 中手动重新创建文档的整体外观，这就是我遇到问题的地方。

为了使它们达到 1:1 的比例，我将在编写代码时直观地比较两者，硬编码任何间距、高度等。

但是，我想知道在 MiG 中使用哪个单元，这样当有人以不同的分辨率运行我的程序时，不会得到不同的结果。

想法？

# windows-8 - 如何利用 Windows 8 中的内置地图应用程序为我的应用程序提供方向

> ID：14408386
> 
> 赞同：1
> 
> 时间：2013-01-18T22:03:17.673
> 
> 标签：windows-8, windows-store-apps, winjs

我想为我的 Windows 应用商店应用程序提供地图和方向，但不想编写和维护该代码。

有没有办法利用 Windows 8（和 Windows RT）中的内置地图应用程序来提供该功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:03:17.673

Windows 应用商店应用支持[协议激活](http://msdn.microsoft.com/en-us/library/windows/apps/hh452686.aspx)，当单击或点击具有匹配协议架构的 URL 时，允许应用注册以激活。

预装在 Windows 8 和 Windows RT 中的地图应用程序支持通过 bingmaps: 架构激活协议，[此处记录了](http://msdn.microsoft.com/en-us/library/windows/apps/jj635237.aspx)该架构。

基本上，在您的应用程序中，您构建了一个超链接，其 href 以“bingmaps:”开头，并且可以选择包含所需的查询参数。就我而言，我最终创建了一个这样的 URL：

```
if (item.latlong) {
    element.querySelector("article .item-directions").href = "bingmaps:?where=" 
    + item.address + ", " + item.city + ", " + item.state;
} 
```

然后在我的 HTML/JS Windows Store 应用程序中使用它作为超链接的 href。当用户单击超链接时，地图应用程序将启动，并以提供的地址为中心。然后用户可以获取路线、打印地图和路线等，而我不需要编写或维护任何代码。这是它在我的应用程序社区扩音器中的样子：

![单击获取路线链接打开地图应用程序](../Images/364474d553fa46e623f88ccfcb4537be.png)

请注意，让应用程序处于快照视图中如何让我同时看到事件信息和地图应用程序。

这是向您的应用快速添加地图和路线功能的便捷方式。

如需更多图片和视频演示，请查看[我关于协议激活的博文](http://devhammer.net/blog/w8wil-6-leverage-the-maps-app-for-location-based-features)。

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

# vim - Vim 语法递归匹配第一个和第二个元素

> ID：14408398
> 
> 赞同：2
> 
> 时间：2013-01-18T22:03:58.380
> 
> 标签：vim, syntax, vim-syntax-highlighting

我正在尝试编写一组语法规则来匹配可嵌套的语法。基本上，在最简单的层面上，一切都是令牌或括号。下面是这种语法的一个例子：

```
[
    [a b c]
    [1 2 3]
    [foo
        [bar baz]]
] 
```

我希望每个“列表”的第一个元素都被着色，所以在这种情况下，`a`、`1`、`foo`和`bar`。我还希望每个列表的第二个元素被着色，但以不同的方式。在这种情况下，`b`、`2`和`baz`。我不关心其他任何事情。除了空格之外，项目之间没有分隔符。

我怎样才能用 vim 模式系统做到这一点？我设法让一个简单的系统工作，但它处理嵌套列表很差。我遇到的麻烦是分别可靠地匹配每个列表的*第一*项和*第二*项，而不会与其他项发生冲突。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:00:43.587

以下规则集突出显示了您的语法：

```
highlight       FirstToken      ctermfg=green       guifg=green
highlight       SecondToken     ctermfg=red         guifg=red

syntax region   FirstTuple      start="\(\[\_s*\)\@<=\["    end="]"
            \ containedin=FirstTuple,OtherTuple
            \ nextgroup=SecondToken
            \ skipwhite skipnl skipempty
syntax region   OtherTuple      start="\(\[\_s*\)\@<!\["    end="]"
            \ containedin=FirstTuple,OtherTuple

syntax match    FirstToken      "\(\[\_s*\)\@<=[^ [\]]\+"
            \ containedin=FirstTuple,OtherTuple
            \ nextgroup=SecondToken
            \ skipwhite skipnl skipempty
syntax match    SecondToken     "[^ [\]]\+"
            \ contained 
```

该`FirstTuple`区域匹配其父元组中的第一个元组，无论是标记还是其他元组；`OtherTuple`用于所有其他元组。这是通过互斥的lookbehinds 完成的，并且会自动处理正确的嵌套。`FirstToken`使用正向回溯仅匹配区域的开头。`FirstToken`并`FirstTuple`使用该`nextgroup`属性尝试`SecondToken`在自己之后立即匹配，忽略空格、换行符和空行。`SecondToken`使用该`contained`属性来避免自己到处匹配。

# sitecore - Sitecore 编辑器的预览网站

> ID：14408400
> 
> 赞同：1
> 
> 时间：2013-01-18T22:04:05.453
> 
> 标签：sitecore, preview

我们的内容编辑希望有一个指向主数据库的预览站点。该站点可用于预览网页在实时站点上的外观。用户对使用 Sitecore 中的“预览”选项不太满意。该站点将指向 CMS 服务器并与 CMS 站点（用于内容编辑）分开。我们不能使用 CMS 站点来预览数据的原因是 HTML 缓存开始发挥作用，并且在呈现页面时内容不会立即更新。

通过设置一个单独的预览站点，我们计划禁用此站点上的缓存并将其纯粹用于内容检查。我知道站点部分的配置文件中有一个名为“cacheHtml”的设置，该设置将在配置中设置为false。我的问题是，采用我们正在采用的方法是否安全。关闭预览站点的 HTML 缓存会导致任何不必要的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T04:22:57.677

这是一种有效的方法。我有一篇博文：[如何设置 Sitecore 预览网站以在发布前查看内容](http://firebreaksice.com/how-to-setup-a-sitecore-preview-site-to-review-content-before-publishing/)

要考虑的一件事是，如果您有 Lucene.NET 索引，除了 Web DB 之外，这些索引还需要基于主 DB。您可以在此处查看如何为主数据库和 Web 配置它们：[配置跨主数据库和 Web 数据库的 Sitecore 搜索索引支持](http://www.sitecoredevelopment.com/en/MarkUrsino/2012/December/Configure-Sitecore-Search-Index-Support-across-Master-and-Web-Databases.aspx)

# jquery - ajax 替换数据主题但 trigger('create') 或 listview('refresh') 不起作用

> ID：14408404
> 
> 赞同：0
> 
> 时间：2013-01-18T22:04:18.853
> 
> 标签：jquery, ajax, mobile, data-theme

问候，

我正在尝试替换数据主题，但从不使用`trigger.('create')`或应用更改`listview('refresh')`

[请在JSFIDDLE](http://jsfiddle.net/fanartie/Yz9mc/6/)测试我的代码

谢谢您的帮助

这是我的代码...

HTML：

```
<div data-role="page" id="home">
  <div data-role="content">
    <div>
      <ul id="uuu" data-role="listview">
        <li id="kkk" data-theme="e">fail change to theme A</li>
      </ul>
    </div>
  </div>
</div> 
```

JavaScript：

```
$('#uuu').append('<li data-theme="a">success change to theme A</li>');

$('#kkk').attr('data-theme', 'a');  // I need do this through ajax

// ======

$('#home').trigger('create');
$("#uuu").listview("refresh");
$("#kkk").listview("refresh"); // this is not working ? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:17:15.287

你需要刷新你的ul：

```
$("#uuu").listview("refresh") 
```

更多信息：http: [//jquerymobile.com/demos/1.2.0/docs/lists/lists-methods.html](http://jquerymobile.com/demos/1.2.0/docs/lists/lists-methods.html) [1](http://jquerymobile.com/demos/1.2.0/docs/lists/lists-methods.html)

# java - 检查数字是否按特定顺序

> ID：14408406
> 
> 赞同：1
> 
> 时间：2013-01-18T22:04:34.110
> 
> 标签：java, arrays, int, modulo

我有一个 int 数组，其中包含 4 个按升序排序的数字。

我想知道这些数字是否符合这条规则：

```
1, 2, 3, 4 or
5, 6, 7, 8 or
9, 10, 11, 12 or
13, 14, 15, 16
etc. 
```

他们不能

```
2, 3, 4, 5 or
4, 5, 6, 7 or
23, 24, 25, 26
etc 
```

所以它们必须按顺序排列，但只能在这 4 组中！

**我尝试**将所有数字相加（例如 1+2+3+4）并以 12 为模求和，结果始终为 10、2、6、10、2、6 等。我的想法是检查结果是否是这三个数字 2、6 或 10 之一。

**但它不能工作**，因为例如 (17+18+19+20)%12 是 2 这是合法的，但例如 (2+3+4+5)%12 也是 2 但它不合法所以它会是错误的结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:07:34.853

让数字成为

```
a, a+1, a+2, a+3 
```

规则是

```
a % 4 == 1    // is the same as:  a & 3 == 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T22:07:42.207

如果我清楚地理解了您的问题，那么您只需要检查序列中的最后一个数字是否可以被 4 整除。如果它可以被 4 整除，则它是一个有效序列。

所以，如果你的序列是： - `a1`, `a2`, `a3`, `a4`. 检查这个条件： -

```
a4 % 4 == 0 
```

如果上述条件为真，那么你有一个有效的序列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-18T22:08:28.410

说你的数组的第一个数字是`x` 然后`x`模`4`必须等于`1`

```
if (a[0]%4 == 1)
  return true;
else 
  return false; 
```

或者，如果
`a[1] % 4 == 2`

或者

`a[2] % 4 == 3`

或者

```
a[3] % 4 == 0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-18T22:07:35.590

我能看到的最简单的规则是；

```
array[3] % 4 == 0 
```

也就是说，数组中的最后一个元素除以 4。这将是一个简单的解决方案。

# c# - 在 WinRT 中，如何以编程方式滚动到 TextBox 的底部？

> ID：14408408
> 
> 赞同：7
> 
> 时间：2013-01-18T22:04:42.437
> 
> 标签：c#, windows-runtime

我正在为 WinRT 编写一个简单的应用程序，但我无法找到一种在我的代码中自动滚动到 TextBox 底部的方法。我正在将日志信息写入 TextBox 并希望它滚动以便最新条目在框中可见，但似乎没有任何效果。以下是我尝试过的一些事情：

将 TextBox 放在 ScrollViewer 中：

```
this.txtLog.Text = this.txtLog.Text + line + "\r\n";
ScrollToVerticallOffset(scrollView.ScrollableHeight); 
```

选择 TextBox 中的最后一个数据：

```
this.txtLog.Select(this.txtLog.Text.Length, 0); 
```

但实际上我所做的任何事情都不会导致显示的文本滚动以使底部数据可见。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:12:20.300

这有效：

**XAML**

```
<TextBox
    x:Name="tb".... 
```

**C＃**

```
var sv = tb.GetFirstDescendantOfType<ScrollViewer>();
sv.ScrollToVerticalOffsetWithAnimation(sv.ExtentHeight - sv.ViewportHeight); 
```

这使用[Winrt XAML Toolkit](http://bit.ly/WinRTXamlToolkit)。

非工具包方式：

```
Func<DependencyObject, ScrollViewer> getFirstDescendantScrollViewer = null;
getFirstDescendantScrollViewer =
    parent =>
    {
        var c = VisualTreeHelper.GetChildrenCount(parent);

        for (int i = 0; i < c; i++)
        {
            var child = VisualTreeHelper.GetChild(parent, i);
            var sv = child as ScrollViewer;
            if (sv != null)
                return sv;
            sv = getFirstDescendantScrollViewer(child);
            if (sv != null)
                return sv;
        }

        return null;
    };

var tbsv = getFirstDescendantScrollViewer(tb);
tbsv.ScrollToVerticalOffset(tbsv.ScrollableHeight); 
```

# ios - 在 NSEntity 上设置值在 iOS 5 但不是 iOS 6 中爆炸

> ID：14408410
> 
> 赞同：0
> 
> 时间：2013-01-18T22:04:48.870
> 
> 标签：ios, ios5, ios6

所以我有一种方法可以下载“皮肤”我的应用程序的图像的网址。它已经在 iOS 5 中运行了几个月，我在我的 xcdatamodel 中的实体中添加了一个字符串类型的新属性，但它停止了工作。即使我删除了该属性，它仍然不起作用。

当我清理 xcode 并从 iPad 中删除应用程序时，然后启动该应用程序。

在 iOS 5 中，我收到此错误：“线程 1：EXC_BAD_ACCESS(code=1,address=0x1)”，如果我按照堆栈跟踪，这发生在我调用`setValue:forKey:`.

但是，如果我在 iOS 6 中清理并运行，则效果很好。

```
- (void)fetchSkinWithCompletion:(void (^)(void))completionBlock failure:(void (^)(void))failureBlock {
    NSString *skin = [self skinName];

    if (skin) {
        NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@/skin/%@", BASE_URL, skin]];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        NSURLResponse *response = nil;
        NSError *error = nil;

        NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

        if (!error) {
            NSError *jsonError = nil;
            NSDictionary *json = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableLeaves error:&jsonError];

            if (!jsonError) {
                Skin *s = (Skin *)[Skin findFirstObjectByAttribute:@"name" withValue:skin inContext:[AppDelegate moc]];
                if (s == nil) {
                    s = [NSEntityDescription insertNewObjectForEntityForName:@"Skin" inManagedObjectContext:[AppDelegate moc]];
                }

                for (NSString * key in json) {
                    /******** THIS IS WHATS BLOWING UP IN iOS 5 *************/
                    [s setValue:[json objectForKey:key] forKey:key];
                }

                [[AppDelegate moc] save:nil];

                self.selectedSkin = s;
                [self downloadImageAssetsForSkin:self.selectedSkin completionBlock:completionBlock];
                return;
            } else {
                DLog(@"Error parsing JSON:%@", jsonError);
            }
        } else {
            DLog(@"User with Device ID:%@ failed fetch skin with error:%@.", [AppDelegate uniqueID], error);
        }
    }

    failureBlock();
    return;
} 
```

`findFirstObjectByAttribute:withValue:inContext`是对 NSManaged Object 的补充。

```
+ (NSManagedObject *)findFirstObjectByAttribute:(NSString *)attr_name withValue:(id)value inContext:(NSManagedObjectContext *)context {
    NSFetchRequest *fetch = [[NSFetchRequest alloc] initWithEntityName:NSStringFromClass([self class])];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K == %@", attr_name, value];
    fetch.predicate = predicate;
    fetch.fetchLimit = 1;

    NSError *error = nil;
    NSArray *results = [context executeFetchRequest:fetch error:&error];
    if (results.count > 0) {
        return [results objectAtIndex:0];
    }
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:34:13.337

这最终成为核心数据的错误。

万一其他人遇到这个问题，这是我非常“脆弱”的解决方案。

删除和添加实体什么也没做（没有解决它）。但是，我的一位同事向 xcdatamodel“foobar”添加了另一个属性，而数据模型上没有动态或任何内容，它似乎运行良好。但是，如果我删除“foobar”，xcdatamodel 将不再工作（仅适用于 ios5）。

希望对遇到此问题的人有所帮助。

此外，如果您有关于此错误的信息或更好的修复，请发布。我真的很想对这个错误有深入的了解，以及一个“真正的”修复。

# c# - 如何在 C# MVC 3 的视图中循环数据库记录

> ID：14408412
> 
> 赞同：2
> 
> 时间：2013-01-18T22:04:52.647
> 
> 标签：c#, asp.net-mvc-3

谁能告诉我如何在我的视图中循环浏览我的表格？我拥有的行是：`disease_id, disease, and remedy.`

# 我的数据库查询

我试图将所有结果放入一个列表中，这样我就可以在视图中循环浏览它们。

```
 SqlCommand cmd = new SqlCommand("SELECT * FROM disease", m_DBCon);
        m_Reader = cmd.ExecuteReader();

        List<string> record = new List<string>();
        while (m_Reader.Read())
        {
            string s = Convert.ToString(m_Reader[0]);
            record.Add(s);
        }

        ViewBag.Record = record; 
```

# 我的观点

我想循环表中的数据库记录

```
@{
    ViewBag.Title = "Dashboard";
    List<string> record = ViewBag.Record;
} 
```

我不断收到一个空字符串。我以为我必须做一些类似 s["disease"]、s["remedy"} 的事情，但 s 是一个字符串，所以它没有所有这些字段。

```
 @{
        foreach (string s in record)
        {
            <tr>
              <td>@s</td>
            </tr>
        }
    } 
```

谁能给我一些建议:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:23:54.260

我首先要指出的是，首先创建一个 DiseaseResult 类可能更容易。这样：

```
public class DiseaseResult
{
  public int DiseaseId { get; set; }
  public string Disease { get; set; }
  public string Remedy { get; set; }
} 
```

这使事情变得更容易一些。现在你可以说：

```
public ActionResult Index()
{
    SqlCommand cmd = new SqlCommand("SELECT [disease_id], [disease], [remedy] FROM disease", m_DBCon);
    m_Reader = cmd.ExecuteReader();

    List<DiseaseResult> record = new List<DiseaseResult>();
    while (m_Reader.Read())
    {
        record.Add(new DiseaseResult() { DiseaseId = m_Reader[0], Disease = m_Reader[1], Remedy = m_Reader[2]);
    }

    return View(record);
} 
```

之后在您的视图中：

```
@model List<DiseaseResult>

@foreach(DiseaseResult item in Model)
{
   <div>@item.Disease</div>
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:12:21.477

和三个项目`disease_id`是值还是列？表中有多少条记录？似乎您将“记录”与“来自不同记录的字段值”的集合混淆了。尝试`disease``remedy``desease`

```
string s = Convert.ToString(m_Reader[0]) + "," + Convert.ToString(m_Reader[1]) + "," + Convert.ToString(m_Reader[2]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:16:18.343

我对同一环境的视图代码是这样的：

```
<% foreach (var item in Model.Item)
{ 
%>
  <tr>
    <td>
      <%: item.Id %>
    </td>
    <td>
      <%: item.Name %>
    </td>
  </tr>
<%
}
%> 
```

使用**var**而不是**string**可以隐式而不是强烈地从**记录**中提取的对象。我相信这是您在上面的代码中遇到的问题。查看以下链接了解更多信息：

[http://msdn.microsoft.com/en-us/library/bb383973.aspx](http://msdn.microsoft.com/en-us/library/bb383973.aspx)

我希望这有帮助。

# python - 通过导入一个简单的函数来停止日志记录？

> ID：14408419
> 
> 赞同：3
> 
> 时间：2013-01-18T22:05:31.783
> 
> 标签：python, logging, import

现在我正在尝试更大的程序，我想使用日志记录模块而不是在我的代码中添加打印。但我一开始就摔倒了。我有一个两页的程序，添加了我能做的最简单的日志记录，但它没有用。所以，我运行了这个例子，它奏效了。然后，我将我的代码逐行运入示例中，直到找到阻止它的原因。一个近乎空的模块的简单导入会停止正确的日志记录行为。

```
# import ntu.dummy
import logging
LOG_FILENAME = 'example_15.log'
print 'before basicconfig'
logging.basicConfig(filename=LOG_FILENAME,level=logging.DEBUG)
print 'before log write'
logging.debug('This message should go to the log file')
print 'after log write' 
```

使用# import ntu.dummy，程序运行，打印出调试信息，并将预期的.log 文件连同预期的内容一起存放到程序的文件夹中。在 IDLE 中或直接在操作系统中都是如此。

如果我删除 # 以允许 import ntu.dummy 执行，则程序运行，打印我的调试，但没有创建 .log 文件，既不在程序文件夹中，也不在机器上的任何其他位置创建 AFAICS。

C:\Python26\Lib\ntu\ 包含一个 __init__.py，而这个文件 dummy.py，其内容...

```
def bolleaux():
    """ empty function """
    return None 
```

代替 import ntu.dummy 语句，我可以有各种其他导入，随机、Tkinter、os.path，它们不会导致日志记录失败

求助，请问这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T07:57:56.823

嗬！

ntu 包包含许多其他单一功能或单一类模块，真正便于测试和更新。其中一些来自朋友，所以我不熟悉其中的内容。由于包的宽度越来越笨重，他建议在 __init__.py 我放...

```
from modname import ClassName 
```

对于我在那里的每个模块，然后将 ClassName 带入 ntu 命名空间。这意味着当我想使用任何模块时，我只需使用

```
import ntu       # instead of import ntu.modname for each module ! 
```

当然，是的，他的一个模块在类定义之前的模块级别执行了 logging.basicConfig。因此，即使我只导入我的模块，这样做也会运行 __init__，它会导入他的模块，这会扰乱后续使用日志记录。注释掉该链中的任何链接会使日志记录正常工作。

我不确定在包中使用 import 是否能节省这么多，它让我对这种讨厌的副作用持开放态度。因此，我将返回从 packname.modname 导入所有模块。

但我会想在某个时候使用那个狡猾的模块，所以必须让它更安全，或者让他让它更安全。

非常感谢

# sql - SQL 语句和或之间

> ID：14408420
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:05:35.093
> 
> 标签：sql, pdo

我收到以下 SQL PDO 语句的语法错误，你能告诉我错误在哪里吗？谢谢！

```
SELECT * 
FROM events 
WHERE 
    (start_date BETWEEN '2013-01-14' AND '2013-01-20') 
    OR (start_date NOT < '2013-01-14' and end_date > '2013-01-20') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:07:02.657

您在第一部分的日期之后缺少一个 '。

```
SELECT * FROM events WHERE (start_date BETWEEN '2013-01-14' AND '2013-01-20') OR (start_date NOT < '2013-01-14' and end_date > '2013-01-20') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:16:58.797

你不能放在`NOT`表达式的中间，它在表达式之前：

```
NOT start_date < '2013-01-14' 
```

或者使用运算符的补码`<`，即`>=`：

```
start_date >= '2013-01-14' 
```

（使用的例外`NOT`是`IS NULL`运算符，其中`NOT x IS NULL`和都`x IS NOT NULL`起作用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:08:30.390

您在 2013-01-20 之后错过了一个勾号

```
SELECT * FROM events 
WHERE 
(start_date BETWEEN '2013-01-14'  AND '2013-01-20')  
OR (start_date >= '2013-01-14' and end_date > '2013-01-20') 
```

# linux - 在 shell 脚本中编辑标准输入文件

> ID：14408430
> 
> 赞同：1
> 
> 时间：2013-01-18T22:06:21.943
> 
> 标签：linux, shell, scripting

我在读取标准输入文件、编辑标准输入以及将输出写入其他文件时遇到问题。因此，shell 将使用如下命令运行：

```
./shellName < inputFile > outputFile 
```

所以我这样写我的shell：

```
read INPUT
tr '[:upper:]' '[:lower:]' INPUT
grep "<td>" INPUT | sed -r 's/<td>([^<]*)<\/td>/\1/g' #to search all line that contain <td> and delete <td> and <\/td>
echo $INPUT 
```

然后，我才意识到读取命令是逐行读取标准输入的。代码本身不起作用。我尝试将所有大写字母更改为小写字母，然后在包含 . 我该怎么办？如果我需要创建一个临时文件，如何在 shell 中创建一个临时文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:13:25.280

它实际上比你想象的要容易得多。默认情况下， tr 从 stdin (fd 0) 读取。除非您重定向脚本，否则脚本中的命令会从脚本“继承”标准输入。所以像

```
#!/bin/sh
tr '[:upper:]' '[:lower:]' | sed -E 's/<td>([^<]*)<\/td>/\1/g' 
```

我将 -r 更改为 -E 因为我的平台需要。

# php - 从 AJAX 获取 POST 时出错

> ID：14408432
> 
> 赞同：0
> 
> 时间：2013-01-18T22:06:35.730
> 
> 标签：php, jquery, ajax, post

当我尝试检索特定的 POST 值时，我遇到了一些问题。

我的ajax代码：

```
var _data = $('#activateForm').serialize() + "&1=" + name1 + "&2=" + name2;
$.ajax({
    type: "POST",
    url: "./do.php",
    data: _data,
    dataType: "json",
    success: function(msg) {
    ... 
```

PHP代码：

```
$ball = $_POST['ball']; 
```

（这个“球”是一个元素`$('#activateForm').serialize())`

结果是所有`_data`字符串，而不仅仅是“ball”值。

比如：ball=dsds&1=ddd&2=ddfd

我怎样才能得到一个特定的值？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:10:01.887

你不应该这样做。我认为你应该首先删除你在 jQuery 中序列化之后附加的东西，看看它是否有效。

如果没有。尝试这个：

```
$params = array();
parse_str($_REQUEST, $params); 
```

# facebook - OG：为非文章的单个网页键入文章与网站

> ID：14408436
> 
> 赞同：31
> 
> 时间：2013-01-18T22:06:58.687
> 
> 标签：facebook, facebook-like, facebook-opengraph

我正在寻求澄清有关使用 og:type 文章与网站的单个网页在技术上不是“文章”但也不代表整个网站。

文档似乎是矛盾的：

来自[https://developers.facebook.com/docs/opengraphprotocol/#types](https://developers.facebook.com/docs/opengraphprotocol/#types)

```
Use article for any URL that represents transient content - such as a
news article, blog post, photo, video, etc. Do not use website for this
purpose. website and blog are designed to represent an entire site, an 
og:type tag with types website or blog should usually only appear on the 
root of a domain. 
```

在这种情况下，文章应该只用于“瞬态”内容。“短暂”的定义是“只持续很短的时间”。这句话还含蓄地说“网站和博客旨在代表整个网站......（并且）通常应该只出现在域的根目录上。”

编辑：有趣的是，描述类型的同一页面还说：

```
If your URL is a video, you should set og:type to video. 
```

这本身就与上面关于视频的引用相矛盾。

回到主题，但是，在更高的地方，同一页面还说：

```
If your URL is a piece of content — such as a news article, photo, or 
similar — you should set og:type to article (see below). 
```

这似乎与第一句话一致。

此外，以下页面 ( [https://developers.facebook.com/docs/technical-guides/opengraph/built-in-objects/#article](https://developers.facebook.com/docs/technical-guides/opengraph/built-in-objects/#article) ) 显示使用 og:type = article 以及 Publish Time、Expiration Time 和作者，它支持应该将其用于具有“文章”的页面的想法。在同一页面上，网站示例支持指示*整个*网站是正在定义的对象的用法。

但是，来自 Open Graph 协议网站：

[http://ogp.me/#types](http://ogp.me/#types)

```
Any non-marked up webpage should be treated as og:type website. 
```

这句话似乎表明了一种最佳实践，即我假设“网页”是指可能存在于具有许多页面的网站的上下文中的单个网页，应被视为 og:type 网站。这似乎与上述说法相矛盾。

更复杂的是，它们都没有解决常见的现实世界场景，其中网站内单个网页的内容不是文章、博客条目或一些类似的“过时”或“临时”内容，而是长期的也不是由任何其他 og:type 直接表示的内容。

例如，网站上的常见问题解答页面。它是什么类型的？一个介绍公司提供的服务的页面怎么样？还是描述公司使命宣言和经商方法的页面？*或者描述产品或服务的好处*但实际上并不直接代表产品或服务的营销页面，这留给产品详细信息页面。

尽管 Open Graph 协议网站声明，如果我们希望这些页面每个都有唯一的 LIKE 按钮，“网站”似乎不是正确的 og:type。

但是，这些页面上的内容通常不会被描述为“临时/临时”，并且没有注明日期或与特定作者相关联，因此“文章”似乎也不是正确的 og:type。

但是，这似乎是我们仅有的两个选择。*奇怪的是，我在任何地方都*找不到关于这个非常灰色的话题的讨论。没有澄清。没有最佳实践。提及 og:type 的文章很少提及，大多数文章都将读者推荐给“开放图对象类型列表”以了解更多信息。

使类型正确似乎也很关键，因为错误会产生潜在的后果。

那么，有人知道 Facebook 希望这些类型的单个页面对象是什么类型吗？有没有人看到任何关于这个的讨论？其他人都在做什么？

谢谢！弗里茨

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-13T14:58:43.167

根据我的经验，“文章”和“网站”之间的区别与 Facebook 使用“赞”的方式有关。具有网站类型的页面的“喜欢”将出现在用户个人资料的列出他们喜欢的部分中；“喜欢”类型为文章的页面不会。用户对“文章”对象的喜欢更有可能在他们的新闻源中显示给朋友（尽管到目前为止，即使是没有评论的文章也不太可能成为新闻源项目，除非有强大的原因——共同感兴趣的话题，用户之间非常频繁的交互——使项目出现在 Facebook 的算法中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-03T07:35:47.770

facebook 中的网站和博客将代表根域或子域，而不是根。

据我了解，这最初是为类似按钮社交插件设计的，它是一种为网站设置层次结构的方法。“这是 Facebook 特有的功能”。

type = social_plugin 是我用来表示我的社交插件的东西，我在我的应用程序的开放图形设置中设置了它。如果不存在代表您的页面类型的类型，则创建一个。

```
anotherfeed.com - website
  |
  |
  |
  /widgets/index.php - social_plugin
  /?cat=world_news - article 
```

# google-apps-script - validateEmail 需要小写值？

> ID：14408439
> 
> 赞同：0
> 
> 时间：2013-01-18T22:07:19.817
> 
> 标签：google-apps-script

不确定我是否在这里遗漏了某些内容，但似乎当我使用“validateEmail”时，它要求电子邮件地址为小写。如果您在下面运行我的代码并输入您的姓名和带有大写值的电子邮件地址，它将不会提交。但是，如果您删除所有大写值以降低它的工作正常。有谁知道这是设计使然还是错误？

```
function doGet() {
//  // Create the signup application
 var app = UiApp.createApplication();

  //Create vertical panel to hold the widgets
  var panelMain = app.createVerticalPanel().setId('mainPanel');

  var lblName = app.createLabel('Name:').setId('lblName').setWidth('80px')
  .setStyleAttribute("fontFamily","Trebuchet MS")
  .setStyleAttribute("fontSize","12pt");

  var txtName = app.createTextBox().setName('txtName').setId('txtName').setWidth('300px')
  .setStyleAttribute("background-color", "#ffbb00")
  .setStyleAttribute("fontFamily", "Trebuchet MS")
  .setStyleAttribute("fontSize", "12pt");

  var lblEmail = app.createLabel('Email:').setId('lblEmail').setWidth('80px')
  .setStyleAttribute("fontFamily","Trebuchet MS")
  .setStyleAttribute("fontSize","12pt");

  var txtEmail = app.createTextBox().setName('txtEmail').setId('txtEmail').setWidth('300px')
  .setStyleAttribute("background-color", "#ffbb00")
  .setStyleAttribute("fontFamily", "Trebuchet MS")
  .setStyleAttribute("fontSize", "12pt");

  var lblRequiredEmail = app.createLabel('*').setId('lblRequiredEmail');
  var lblRequiredName = app.createLabel('*').setId('lblRequiredName');
  var lblStatus = app.createLabel("Sign up to receive specials and promotions.").setId('lblStatus')
  .setStyleAttribute("fontFamily","Trebuchet MS")
  .setStyleAttribute("fontSize","12pt");

  var btnSubmit = app.createButton("Submit").setId("btnSubmit").setWidth("120px")
  .setStyleAttribute("fontFamily", "Trebuchet MS")
  .setStyleAttribute("fontSize", "12pt")

  var gridMain = app.createGrid(4, 3).setId('gridMain');

 gridMain.setWidget(0,0,lblName)
 .setWidget(0,1,txtName)
 .setWidget(0, 2, lblRequiredName)
 .setWidget(1, 0,lblEmail)
 .setWidget(1, 1,txtEmail)
  .setWidget(1,2,lblRequiredEmail)
 .setWidget(2,1,btnSubmit);

  panelMain.add(lblStatus).add(gridMain);

  //Create server handler for when user submits the information
  var serverHandler = app.createServerHandler('Signup')
 .validateEmail(txtEmail)
 .validateLength(txtName,1,500)
 .addCallbackElement(panelMain);

  var validateEmail = app.createClientHandler()
  .validateNotEmail(txtEmail)
  .forTargets(txtEmail).setStyleAttribute("color", "red")
  .forTargets(lblRequiredEmail).setVisible(true)
  .setText('Invalid Email')
  .setStyleAttribute("color", "red");

  var validateName = app.createClientHandler()
  .validateNotLength(txtName,1,500)
  .forTargets(txtName).setStyleAttribute("color", "red")
  .forTargets(lblRequiredName).setVisible(true)
  .setText('Please Enter Name')
  .setStyleAttribute("color", "red");

 btnSubmit.addClickHandler(serverHandler).addClickHandler(validateEmail).addClickHandler(validateName);
   app.add(panelMain);
  return app;
}

function Signup(thisForm)
{

  var app = UiApp.getActiveApplication();
  var txtName = thisForm.parameter.txtName;
  var txtEmail = thisForm.parameter.txtEmail;
  var lblStatus = thisForm.parameter.lblStatus;

  //Other code to save to data store
 ////
  app.getElementById("lblStatus").setText('Thanks for signing!');
  app.getElementById('gridMain').setVisible(false);

  return app;

 // return app2; //Everything is working fine right now 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T02:06:58.950

我不认为 validateEmail 过去是这样工作的。我在[填写表格时是否可以为用户关闭自动填写中的解决方案？](https://stackoverflow.com/questions/12124539/is-there-a-way-to-turn-off-auto-fill-for-users-when-filling-out-a-form)之前，我很确定它需要混合大小写。@Serge 可能记得。

[问题 1799：谷歌应用程序脚本中的验证功能无法正常工作](https://code.google.com/p/google-apps-script-issues/issues/detail?id=1799)已报告，然后在 2012 年 9 月关闭，因为它过于广泛。我认为这为报告这个特定问题打开了大门。

对于自己进行电子邮件验证并处理混合大小写的替代方案，请查看此 Apps Script Tutorial on [Email Validation](https://sites.google.com/site/appsscripttutorial/user-interface/validation)。

# php - PHP 邮件有时只发送主题（空正文）

> ID：14408440
> 
> 赞同：0
> 
> 时间：2013-01-18T22:07:29.880
> 
> 标签：php, html, email

所以问题是，有时，在我的网站上使用 PHP 邮件表单时，它只发送主题行和一个空正文！但这有时会发生。实际上很少。我收到了来自网站用户的电子邮件（主题行，但正文为空白），所以我认为他们只是太早地提交了表单，直到我自己测试了一些电子邮件，我自己最终得到了一些空白！同样，主题行始终存在。

在这里形成代码：

```
echo "<form method='POST' action='item.php?id=$strItemNumber'>
<table><tr><td style='vertical-align:middle;'>
Subject:<BR />
<input type='text' name='subject' value='Item # $strItemNumber'  size='19'><br />
Name:<BR /> <input type='text' name='name' size='19'>
<br />Your Email:<br />
<input type='text' name='email' size='19'>

</td><td>
Message:<BR />
<textarea rows='9' name='message' cols='60'></textarea>

</tr></table>
<input type='submit' value='Send Email' name='submitted'>
</form>"; 
```

电子邮件功能的代码在这里：

```
$to = "info@mydomain.com";
$subject = $_POST['subject'];
$name_field = $_POST['name'];
$email_field = $_POST['email'];
$message = $_POST['message'];
$body = "From: $name_field\n E-Mail: $email_field\n Message:\n $message\n"; 

mail($to, $subject, $body); 
```

各位有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:38:43.157

更改`$body`为以下内容：

```
$body = "From: {$name_field} E-Mail: {$email_field} Message: {$message}"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-20T05:42:21.010

好的。这个答案是对原始海报的。几个小时以来，我遇到了同样的问题。当我发现一个从 PHP wiki 引起我注意的小花絮时，我正在敲打我的头。原来身体必须由线条组成。每行必须以臭名昭著**的 '\n\r'**结尾。这可能会或可能不会出现在电子邮件中，但对电子邮件正文字符串至关重要。每行不能超过特定长度。在雅虎的情况下，我不知道确切的长度，但 wiki 声明 70 个字符长度。我认为这并不准确。由于我通过电子邮件发送的数据是 html 代码，因此我只是插入了**'\n\r'**到每个 html 标签的末尾。我没有这个问题了。我怀疑您发送的消息正文偶尔会超出行长的数据限制，并且只是发送了空白的消息正文。

示例字符串：

```
"<body>Hello World</body>\n\r<i>Something, something, darkside</i>\n\r..." 
```

至少对我来说，这解决了这个问题，我也在 Yahoo!

我意识到这篇文章是一个古老的人工制品，按照互联网标准，但我看到很多相关的观点，我相信有人会发现它很方便。

# ruby - Cloud Foundry多节点环境RestClient Request Timeout during VMC push

> ID：14408448
> 
> 赞同：0
> 
> 时间：2013-01-18T22:07:48.110
> 
> 标签：ruby, sinatra, vmware, cloud-foundry

我正在使用 VMC 0.3.18 并设置我的环境，就像这里讨论的那样：http: [//support.cloudfoundry.com/entries/20407923-single-multi-node-vcap-deployment-using-dev-setup](http://support.cloudfoundry.com/entries/20407923-single-multi-node-vcap-deployment-using-dev-setup)

每个 VM VCAP 状态都声称它们的服务正在运行（即 vcap_dev 状态），但是当我尝试推送一个我知道有效的应用程序（在单节点环境中成功测试它）时，我收到一个 HTTP 异常：RestClient Timeout。这是推送应用程序时该行的外观。

```
root@myHome:~/Ruby/Hello# vmc push hello
Would you like to deploy from the current directory? [Yn]: Y
Detected a Sinatra Application, is this correct? [Yn]: Y
Application Deployed URL [hello.vcap.me]: hello.vcap.me
Memory reservation (128M, 256M, 512M, 1G, 2G) [128M]: 128M
How many instances? [1]: 1
Bind existing services to 'hello'? [yN]: N
Create services to bind to 'hello'? [yN]: N
Would you like to save this configuration? [yN]: N
Creating Application: OK
Uploading Application:
  Checking for available resources: OK
  Packing application: OK
  Uploading (0K): OK
Push Status: OK
Staging Application 'hello': .............................................HTTP exception: RestClient::RequestTimeout:Request Timeout 
```

我一直在尝试加载的这些应用程序是简单的 hello.rb 文件[http://docs.cloudfoundry.com/tools/vmc/installing-vmc.html#next-steps](http://docs.cloudfoundry.com/tools/vmc/installing-vmc.html#next-steps)（向上滚动查看文件）和 env.rb，回显页面的环境变量（在上面提到的单节点\多节点页面的底部）

关于我在这里做错了什么的任何想法？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:53:36.180

您用于多节点设置的文档非常陈旧，而 Cloud Foundry 正处于快速开发阶段。

您可以在此处找到有关 vcap 的活跃对话： [https ://groups.google.com/a/cloudfoundry.org/forum/?fromgroups#!forum/vcap-dev](https://groups.google.com/a/cloudfoundry.org/forum/?fromgroups#!forum/vcap-dev)

如果您正在考虑使用 chef 进行多节点 cf 安装，建议您在此处使用 Andrea Campi 的脚本：[https](https://github.com/zephirworks) ://github.com/zephirworks - 请注意，这是一个独立项目。Cloud Foundry 团队正在从 dev_setup 转向 BOSH 安装。

# ios - 如何以编程方式发送 UILongPressGesture？

> ID：14408455
> 
> 赞同：5
> 
> 时间：2013-01-18T22:08:33.123
> 
> 标签：ios, uigesturerecognizer

如何`UILongPressGesture`向对象发送消息？

我知道如何发送触摸，但不知道手势。例如，如果我想发送一个触摸，我可以使用：

```
[button sendActionsForControlEvents: UIControlEventTouchUpInside]; 
```

并且按钮将收到“内部修饰”。我需要用长按手势做同样的事情。

想想自动化的 UI 测试。调用与手势关联的选择器不会对任何东西进行有意义的测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T19:31:10.107

根据需要模拟的状态序列导入`<UIKit/UIGestureRecognizerSubclass.h>`并手动设置属性。`state`这将导致调用添加的目标/动作对。每次手动设置状态后，您必须让运行循环运行，以便发送消息。

为了`UILongPressGestureRecognizer`获得正确的状态序列，就像在实际的“触摸、按住、拖动、释放”手势序列中找到的那样，我在 .`UIViewController`内部的子类中编写了以下代码`viewDidLoad`：

```
UILongPressGestureRecognizer *r = [[UILongPressGestureRecognizer alloc] init];
[self.view addGestureRecognizer:r];
[r addTarget:self action:@selector(recognize:)];
r.state = UIGestureRecognizerStateBegan;
[[NSRunLoop mainRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:0.01]];
r.state = UIGestureRecognizerStateChanged;
[[NSRunLoop mainRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:0.01]];
r.state = UIGestureRecognizerStateEnded;
[[NSRunLoop mainRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:0.01]];
[r reset]; 
```

我想这在生产代码中会有风险（您可能希望之后调用`reset`，但我发现在我的测试中这样做与不这样做之间没有区别），但是如果您的用例是自动化测试以验证目标和操作是否已正确设置这可能会满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T01:08:34.033

你知道对象绑定了哪个选择器`UILongPressGestureRecognizer`吗？如果你知道，你可以打电话给它。如果你问是否有类似的方法`touchesMoved:(UITouch *)touch`，那么答案是否定的。

# objective-c - 为什么 waitForDataInBackgroundAndNotify 不能与超过 1 个参数的实时监视器一起使用？

> ID：14408456
> 
> 赞同：0
> 
> 时间：2013-01-18T22:08:35.477
> 
> 标签：objective-c, nstask, nspipe

我从其中一个 API 中找到了以下代码，我正在尝试使用它来实时监控 vm_stat 1：

```
BOOL terminated = NO;

-(void)realTimeMonitor
{

NSTask *task = [[NSTask alloc] init];
[task setLaunchPath:@"/bin/bash"];
[task setArguments:[NSArray arrayWithObjects:@"-c", @"/usr/bin/vm_stat 1", nil]]; //works fine

// [task setArguments:[NSArray arrayWithObjects:@"-c", @"/usr/bin/vm_stat 1 | /usr/bin/awk '{print $1}'", nil]]; not working

NSPipe *pipe = [NSPipe pipe];
NSPipe *errorPipe = [NSPipe pipe];
[task setStandardOutput:pipe];
[task setStandardError:errorPipe];

NSFileHandle *outFile = [pipe fileHandleForReading];
NSFileHandle *errFile = [errorPipe fileHandleForReading];

[task launch];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(terminated:)
                                             name:NSTaskDidTerminateNotification
                                           object:task];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(outData:)
                                             name:NSFileHandleDataAvailableNotification
                                           object:outFile];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(errData:)
                                             name:NSFileHandleDataAvailableNotification
                                           object:errFile];

[outFile waitForDataInBackgroundAndNotify];
[errFile waitForDataInBackgroundAndNotify];
while(!terminated)
{
    if (![[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode beforeDate:[NSDate distantFuture]])
    {
        break;
    }
}
}

-(void) outData: (NSNotification *) notification
{
NSFileHandle *fileHandle = (NSFileHandle*) [notification object];
NSData *data = [fileHandle availableData];

if ([data length]) {

    NSString *currentString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    // do something 
}

[fileHandle waitForDataInBackgroundAndNotify]; //Checks to see if data is available in a background thread.
}

-(void) errData: (NSNotification *) notification
{
NSLog(@"errData");
NSFileHandle *fileHandle = (NSFileHandle*) [notification object];
[fileHandle waitForDataInBackgroundAndNotify];
}

- (void) terminated: (NSNotification *)notification
{
NSLog(@"Task terminated");
[[NSNotificationCenter defaultCenter] removeObserver:self];
terminated =YES;
} 
```

========

请查看 setArguments 行。第一个工作得很好“/usr/bin/vm_stat 1”，但是第二行不起作用“/usr/bin/vm_stat 1 | /usr/bin/awk '{print $1}'”（没有输出全部），但如果我在终端上运行它，它工作得非常好。这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T15:31:15.513

Maybe`awk`正在缓冲其 stdout 流，因为它认为它不会将其 stdout 流写入 tty 设备。

这最终可能导致完全死锁，因为如果' 的 stdin 被填满并且 ' 的 stdout 上没有消费者，则可能无法`vm_stat`写入其stdout。`awk``awk`

因此尝试`awk`使用其内置`fflush()`函数刷新标准输出。

```
[task setArguments:[NSArray arrayWithObjects:@"-c", @"/usr/bin/vm_stat 1 | /usr/bin/awk '{print $1; fflush();}'", nil]]; 
```

我能够使用（稍作修改）[asynctask.m](http://cocoadev.com/wiki/NSPipe)运行您的代码。

# regex - 检查字符串的codePage

> ID：14408457
> 
> 赞同：0
> 
> 时间：2013-01-18T22:08:37.620
> 
> 标签：regex, actionscript-3, codepages

我尝试检查字符串是否是 CP1254 或 CP1250 等代码页的一部分：

```
//cp1250
public static const CP1250_REGEXP:RegExp = /[\u00A0\u00A4\u00A6-\u00A9\u00AB-\u00AE\u00B0\u00B1\u00B4-\u00B8\u00BB\u00C1\u00C2\u00C4\u00C7\u00C9\u00CB\u00CD\u00CE\u00D3\u00D4\u00D6\u00D7\u00DA\u00DC\u00DD\u00DF\u00E1\u00E2\u00E4\u00E7\u00E9\u00EB\u00ED\u00EE\u00F3\u00F4\u00F6\u00F7\u00FA\u00FC\u00FD\u0102-\u0107\u010C-\u0111\u0118-\u011B\u0139\u013A\u013D\u013E\u0141-\u0144\u0147\u0148\u0150\u0151\u0154\u0155\u0158-\u015B\u015E-\u0165\u016E-\u0171\u0179-\u017E\u02C7\u02D8\u02D9\u02DB\u02DD\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122]/;

//cp1254
public static const CP1254_REGEXP:RegExp = /[\u00A0-\u00CF\u00D1-\u00DC\u00DF-\u00EF\u00F1-\u00FC\u00FF\u011E\u011F\u0130\u0131\u0152\u0153\u015E-\u0161\u0178\u0192\u02C6\u02DC\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122]/;
var stringValue = "Lorem ipsum"

if( CP1250_REGEXP.exec( stringValue ) ) {
trace( "is cp1250" );
}

if( CP1254_REGEXP.exec( stringValue ) ) {
trace( "is cp1254" );
} 
```

但是 exec() 仅在 stringValue 中的一个字符具有正则表达式模式的字符时才返回。如果 stringValue 的第一个字符相等，则 test() 返回。

简而言之：我的目标是检查所有 stringValue 字符是否等于 codePage 的模式/部分。

但我被困在这一点上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:14:26.150

```
[\u00A0-\u00CF\u00D1-\u00DC\u00DF-\u00EF\u00F1-\u00FC\u00FF\u011E\u011F\u0130\u0131\u0152\u0153\u015E-\u0161\u0178\u0192\u02C6\u02DC\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122] 
```

只匹配集合中的任何字符一次。向表达式添加 a`*`以识别任意数量的它们（包括 0，`+`代替 1 或更多），并消耗整个输入，以`^`(start of line) 开始并以`$`(end of line) 结束，例如：

```
^[chars]*$ 
```

或者，使用您的字符集：

```
^[\u00A0-\u00CF\u00D1-\u00DC\u00DF-\u00EF\u00F1-\u00FC\u00FF\u011E\u011F\u0130\u0131\u0152\u0153\u015E-\u0161\u0178\u0192\u02C6\u02DC\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122]*$ 
```

# objective-c - 如何将视图推送到导航堆栈并删除当前视图？

> ID：14408464
> 
> 赞同：5
> 
> 时间：2013-01-18T22:09:04.353
> 
> 标签：objective-c, ios5, uiviewcontroller, uinavigationcontroller, uitableview

我想将视图推送到导航控制器堆栈中，但删除当前视图，这样当用户按下下一个视图时，它不会将他们带到上一个视图。

一个方向的流动可能是以下之一：

```
View X -> View 1 -> View 2 -> View 3    
View X -> View 1      ->      View 3 
```

但相反方向的流动总是这样：

```
View X <- View 1      <-      View 3 
```

问题是我想在 View 2 Controller 上处理它，在 View 3 上处理它很容易覆盖后退按钮操作。View 3 可以是很多不同的视图，我不想覆盖所有视图的后退按钮并检查堆栈的前一个控制器是否是 View 2 控制器。它们都有相同的父类，所以我不能只为“查看 3 类”控制器覆盖后退按钮。

我已经尝试过了，所以 View 2 的控制器没有添加到导航堆栈中：

```
//Pop controller from stack before pushing
[self.navigationController popViewControllerAnimated:YES];
[self.navigationController pushViewController:controller animated:YES]; 
```

但是一旦你弹出它会删除视图并且不会推送到下一个控制器

具有相同结果的其他选项

```
NSMutableArray *viewControllers = [NSMutableArray arrayWithArray: self.navigationController.viewControllers];
[viewControllers removeObjectIdenticalTo:self];
self.navigationController.viewControllers = viewControllers;
[self.navigationController pushViewController:controller animated:YES]; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-19T02:24:34.097

关于你最后一个没有推动的例子，这行得通吗？

```
NSMutableArray *viewControllers = [NSMutableArray arrayWithArray: self.navigationController.viewControllers];
[viewControllers removeObjectIdenticalTo:self];
[viewControllers addObject:controller];
[self.navigationController setViewControllers: viewControllers animated: YES]; 
```

由于您将控制器设置为没有您自己的控制器数组，因此您可能会将您的`navigationController`属性设置为`nil`，从而使您无法立即推送新的控制器。反正试一试也无妨。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-06T06:17:59.210

我也有一个类似的用例，这是我在 Swift 5 中提出的解决方案：

```
 if var controllers = self.navigationController.viewControllers {
        // finding 'View 2' to remove from navigation stack
        if let index = controllers.firstIndex(of: 'View 2') {
          controllers.remove(at: index)
        }
        controllers.append('View 3') // adding new viewController to navigation stack
        // this will update the navigation stack with system animation
        self.rootNavController.setViewControllers(controllers, animated: true)
      } else {
        // fallback scenario
        self. self.navigationController.pushViewController('View 3', animated: true)
      } 
```

# jquery - jQuery 更新后 ASP.NET MVC3 客户端验证不起作用

> ID：14408465
> 
> 赞同：1
> 
> 时间：2013-01-18T22:09:08.550
> 
> 标签：jquery, asp.net, asp.net-mvc, asp.net-mvc-3

我正在使用 jQuery 1.5.1 在 MVC3 中运行一个项目。我们最近不得不迁移到 jQuery 1.8.3，但是现在客户端验证不再起作用了。

[我在JQuery 1.5](https://stackoverflow.com/questions/5117458/jquery-1-5-breaks-compare-validate-jquery-validate-1-8)尝试了解决比较验证（JQuery Validate 1.8）但它不起作用。我试图从我的布局中删除 jquery.validate.unobstrusive.js，我意识到如果我使用默认的 jQuery 1.5.1 而不是 jQuery 1.8.3，客户端验证仍然有效，这意味着验证必须在某个地方完成在 MVC3 的默认 jQuery 1.5.1 中。

*编辑*问题似乎来自 jquery.validate.unobtrusive.min.js，因为当我删除它时，即使是旧的 jQuery 也停止了工作。

如果有人可以帮助我解决这个问题，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:12:11.317

我的问题实际上是 jquery.validate.min.js ，我只是从 CDN 网站更新了一个新版本，一切都很完美:)

谢谢大家！

# android - 使用电话号码搜索联系人

> ID：14408466
> 
> 赞同：1
> 
> 时间：2013-01-18T22:09:10.367
> 
> 标签：android, contacts, android-contacts

我正在开发接收来电和传入短信的广播意图的 android 应用程序。

然后它应该获取传入号码并使用传入号码对用户联系人执行搜索。

这更不工作，但我有一个小问题。我让它工作，以便在联系人列表中搜索号码，如果它以 + 开头，则去除前 3 个字符并在开头放置一个 0，或者如果它不包含 +，则只进行搜索。但是，我有一个小问题，如果用户在号码中输入空格，那么应用程序找不到联系人。例如，如果我有一个联系人号码另存为`07412xxxxxx`，而传入的号码是`07412xxxxxx`或`+447412xxxxxx`。但是，如果联系人号码保存为`07412 xxx xxx `and the incoming number is`07412xxxxxx`，则该号码无法被识别，因此无法找到联系人姓名。

如何执行搜索以考虑数字格式。下面是我目前正在使用的代码。

```
public String getContactNameFromNumber(String number)
    {

        if (number.startsWith("+"))
        {
            number = "0" + number.substring(3);
        }

        String contactName = null;
        ContentResolver contentResolver = context.getContentResolver();

        Uri uri = Data.CONTENT_URI;
        String[] projection = new String[] {PhoneLookup._ID, PhoneLookup.DISPLAY_NAME};
        String selection = ContactsContract.CommonDataKinds.Phone.NUMBER + " = ?";
        String[] selectionArgs = { number };
        Cursor cursor = contentResolver.query(uri, projection, selection, selectionArgs, null);

        if (cursor.moveToFirst())
        {

            contactName = cursor.getString(cursor.getColumnIndexOrThrow(PhoneLookup.DISPLAY_NAME));
            cursor.close();
            return contactName;
        }
        else
        {
            cursor.close();
            return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T12:02:17.183

尝试：

```
String selection = "REPLACE (" + ContactsContract.CommonDataKinds.Phone.NUMBER + ", \" \" , \"\" ) = ?"; 
```

请参阅[替换](http://www.sqlite.org/lang_corefunc.html)功能。

# vba - 用于插入列和粘贴数据的 VBA 代码 - 更改日期值

> ID：14408467
> 
> 赞同：0
> 
> 时间：2013-01-18T22:09:11.050
> 
> 标签：vba, excel

我遇到了路障，无法弄清楚。

我有一张表，它有 9 列，每列都有一个标题。其中 2 列有开始日期和结束日期。第 10 列，我用开始日期减去结束日期得到天数。这些可能是从 0（仅 1 天）到 5 的任何值。

我正在尝试编写一个 VBA 代码，它将检查第 10 列（J 列）并引用该数字，在其下方插入一行，并且还包含其中包含的信息。

我有以下代码将信息与添加的行一起插入到 Sheet2 中，并将数据复制到新行中。

但我遇到的问题是：

J3 = 4，然后在 J3 下插入 4 行并从 A3:I3 复制数据，除了开始日期和结束日期，输入适当的日期。

暗示，假设开始日期是 2013 年 1 月 1 日，结束日期是 2013 年 1 月 4 日，然后放

```
Sdate          Edate
1/1/2013    1/4/2013
1/2/2013    1/2/2013
1/3/2013    1/3/2013
1/4/2013    1/4/2013 
```

这可能吗？我知道我可以将这些数据导入 Access 并执行追加查询，但我的工作不喜欢我使用 Access。

这是用于插入行并将数据从所有 10 列复制到新列的代码：

```
Option Explicit

Sub BuildSortedSht()

Dim sht As Worksheet
Dim rng As Range
Dim IP As Range
Dim LastRow As Integer
Dim i As Integer
Dim scell As Variant

LastRow = Sheets("Sheet1").Range("A65536").End(xlUp).Row

Set sht = Application.ThisWorkbook.Worksheets("Sheet2")
Set rng = Sheets("Sheet1").Range("J2:J" & LastRow)
Set IP = sht.Range("A2")

For Each scell In rng

If scell > 1 Then

  For i = 1 To scell

    Range(scell.Offset(0, -9), scell.Offset(0, 1)).Copy
    IP.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, _
                  SkipBlanks:= False, Transpose:=False

    Set IP = IP.Offset(1, 0)

  Next i

Else

    Range(scell.Offset(0, -9), scell.Offset(0, 1)).Copy
    IP.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, _
               SkipBlanks:= False, Transpose:=False

    Set IP = IP.Offset(1, 0)

End If

Next

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:05:53.327

如果我理解正确，您的代码应该是这样的：

```
Dim MyDate As Date
Dim LastRow As Long
Dim i As Long
Dim j As Long

With Sheets("Sheet1")
    LastRow = .Range("A" & Rows.Count).End(xlUp).Row

    For i = LastRow To 2 Step -1    'as you insert new rows that shift data, you have to go in a loop up: from bottom to top
        If .Cells(i, "J") > 0 Then
            .Rows(i + 1 & ":" & i + .Cells(i, "J")).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove

            'copy range(s) you want from row above
            .Range(.Cells(i + 1, "A"), .Cells(i + .Cells(i, "J"), "I")).Value = .Range(.Cells(i, "A"), .Cells(i, "I")).Value

            'create start:end dates in columns A:B (A = start date)
            MyDate = .Cells(i, "A")
            For j = i + 1 To i + .Cells(i, "J")
                MyDate = DateAdd("d", 1, MyDate)
                .Range(.Cells(j, "A"), .Cells(j, "B")) = MyDate
            Next j
        End If
    Next i
End With 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T21:41:11.320

```
Dim MyDate As Date
Dim LastRow As Long
Dim i As Long
Dim j As Long

With Sheets("Sheet1")
    LastRow = .Range("A" & Rows.Count).End(xlUp).Row

    For i = LastRow To 2 Step -1    'as you insert new rows that shift data, you have to go in a loop up: from bottom to top
        If .Cells(i, "J") > 0 Then
            .Rows(i + 1 & ":" & i + .Cells(i, "J")).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove

            'copy range(s) you want from row above
            .Range(.Cells(i + 1, "A"), .Cells(i + .Cells(i, "J"), "I")).Value = .Range(.Cells(i, "A"), .Cells(i, "I")).Value

            'create start:end dates in columns A:B (A = start date)
            MyDate = .Cells(i, "A")
            For j = i + 1 To i + .Cells(i, "J")
                MyDate = DateAdd("d", 1, MyDate)
                .Range(.Cells(j, "A"), .Cells(j, "B")) = MyDate
            Next j
         End If
     Next i
End With 
```

# excel - Excel VBA 无法在 Mac 上运行

> ID：14408478
> 
> 赞同：1
> 
> 时间：2013-01-18T22:10:21.137
> 
> 标签：excel, excel-2008, vba

我在 Excel 2007 中编写了一些代码，并尝试在带有 Excel 2008 的 Mac 上运行它。该过程链接到工作表上的控制按钮，这里进行了类似的讨论：[Excel vba to mac](https://stackoverflow.com/questions/10935028/excel-vba-to-mac)

但是，就我而言，这似乎不是完全相同的问题。当我在 Mac 上打开文件时，Excel 识别出存在宏（它提供了在禁用宏的情况下打开文件的选项）。当我单击控制按钮运行宏时，Excel 确实认识到这不仅仅是一张图片，而是一个实际的控制按钮（与我在上面发布的线程中的问题的主要区别），然后告诉我相关的宏名为'Main ' 找不到。

不幸的是，我现在才阅读 ActiveX 与表单按钮的问题（在我上面发布的线程中讨论过），目前我无法访问 Mac。否则我会测试是否可以解决它；但是，从上面的线程中，我了解到问题以不同的方式呈现出来。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:31:19.793

不幸的是，Excel 2008 不支持 VBA。2004 和 2011 版本虽然如此。

[http://en.wikipedia.org/wiki/Microsoft_Excel#VBA_programming](http://en.wikipedia.org/wiki/Microsoft_Excel#VBA_programming)

[Mac Excel 2008：宏？](https://stackoverflow.com/questions/2051682/mac-excel-2008-macros)

# c++ - （ROMable）对象的 ROMable（但复杂）数组 - 如何解决？

> ID：14408479
> 
> 赞同：4
> 
> 时间：2013-01-18T22:10:24.713
> 
> 标签：c++, c, embedded, rom

我正在为 MCU（ARM Cortex-M3）开发固件。这些设备没有很多 RAM，所以无论如何你应该尝试将数据放在恒定内存（闪存）中。

问题是这样的：设备必须提供将由接口（MODBUS）读取的“寄存器”，因此操作员读取“地址”10并获得一些数字，他/她“写入”到“地址”101和它会导致一些动作等。将有数百个这样的“地址”并且访问它们会导致一些动作 - 例如，从 1-10 读取会导致传感器 1 到 10 上的温度测量，从 11-20 读取会导致读取在一些校准值中，写入这些地址会导致这些校准值存储在非易失性存储器等上 - 会有很多不同的功能（;

目前我已经实现了这样的：

1.  有一个数组将地址绑定到回调函数以进行读写 - 一个回调函数可以绑定到多个地址（就像在上面的示例中，相同的回调将用于 1-10）

2.  还有另一个数组将地址绑定到回调参数，有很多这样的数组，因为参数可能具有不同的类型/大小 - 在上面的示例中，将有一个结构数组 {int address; int sensor;} 用于 1-10 和结构数组 {int address; 内部标识；整数大小；最小; 最大整数；int 默认值;} 11-20。

3.  每个回调都可以获取当前地址，在它的数组中找到相关的struct，并获取它需要的参数

这种方法有点重复，因为我必须多次声明地址 - 主数组中有一个条目 {1, readSensor, writeSensor}，数组或传感器中有另一个地址为 1 的条目 {1, 0x5423} - 它只是没有'不符合 DRY 原则 (;

我考虑过的一个解决方案是一组多态对象，但是：

~~一个。虚函数导致对象被放置在 RAM 中（它不是 ROMable）~~ **编辑：**这似乎是由 GCC 错误引起的，在 4.6 constexpr 构造函数导致对象被放置在 RAM 中，但对于 4.7 它可以工作！

湾。这仍然有点麻烦，因为我必须在“某处”创建对象，并将其地址放入数组中（该数组实际上会放在闪存中）

我不能使用任何像向量这样的 STL 东西，因为它完全放在 RAM 中。

我考虑过一些模板魔法，但那是黑魔法（;

我也考虑过一个链表，但我只是看不到任何“好”的方式来以可读和连续的形式（如数组 [; ）声明它，但我可能不熟悉一些好的解决方案这个问题。

最简单的解决方案是让回调接受另一个“void *”参数并将其转换为内部需要的任何内容，但这“不好”，还需要我创建带有“某处”参数的结构，然后将它们绑定到主大批。

任何关于优雅解决方案的想法？这必须在 ROM 中，会有数百个条目，每个条目都可以有多个不同的参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T08:10:53.390

I would definitely opt for a `switch .. case` statement. It is very likely that your compiler will resolve it to a [branch table](http://en.wikipedia.org/wiki/Branch_table), which is as efficient as the callback function vector you implemented, but much more readable, in my opinion. It goes like this:

```
void parse_modbus (int register, bool write, int more_parameters) {
    switch (register) {

    case TEMPERATURE_REGISTER_1:
    ...
    case TEMPERATURE_REGISTER_10:
        read_temperature(register - TEMPERATURE_REGISTER_1);
        break;

    case CALIBRATION_REGISTER_1:
    ...
    case CALIBRATION_REGISTER_10:
        if (write)
            write_calibration(register - CALIBRATION_REGISTER_1);
        else
            read_calibration((register - CALIBRATION_REGISTER_1);
        break;

    default:
        unimplemented_register(register);
        break;
    }
} 
```

You still need look-up tables for min-max limits, though.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T12:45:52.320

我们用 X-Macros 解决了这个问题。

这个想法是使用寄存器创建一个*可读*文件，该文件将通过多次包含它来创建适当的代码。

*   寄存器.h

```
typdef enum {
  MR_SET_VOLTAGE = 100,  // 8bit-Register for the voltage R/W
  MR_SET_CURRENT = 104,  // 8bit-Register for the current R/W
  MR_ACT_VOLTAGE = 206,  // 16bit-Register for the actual Voltage Read-Only
} teRegister; 
```

*   allRegister.inc

```
REGISTER(uint8_t,MR_SET_VOLTAGE,readFnA,writeFnA)
REGISTER(uint8_t,MR_SET_CURRENT,readFnA,writeFnA)
REGISTER(uint16_t,MR_ACT_VOLTAGE,readFnB,NULL) 
```

*   寄存器.c

```
#define PASTE(a,b)  a##b
#define REGISTER(_type,_regName,_readCallback,_writeCallback) \
    static _type PASTE(VAR_,_regName);

#include "allRegister.inc"

#undef REGISTER

typedef uint8_t (*tfnRegistercallback)(tsRegister const *pRegister);

typedef struct {
  uint8_t registerIdx;
  uint8_t registerSize;
  tfnRegistercallback readCallback;
  tfnRegistercallback writeCallback;
  void *pData;  // This is a pointer to the data of the register (in RAM)
} tsRegister;

// Creating of the array of all registers
#define REGISTER(_type,_regName,_readCallback,_writeCallback) \
    {_regName, sizeof(_type), _readCallback,_ writeCallback, &PASTE(VAR_,_regName)},

// Array of all registers, resides in Flash
static const tsRegister allRegister[] = {
#include "allRegister.inc"
};

#undef REGISTER 
```

它为每个寄存器创建一个变量，`static uint8_t VAR_MR_SET_VOLTAGE;`
并为每个寄存器创建一个数组条目。

```
static const tsRegister allRegister[] = {
   { MR_SET_VOLTAGE, sizeof(uint8_t), readFnA, writeFnA, &VAR_MR_SET_VOLTAGE},
   ...
}; 
```

并且回调函数得到一个指向寄存器的 const 条目的指针，所以函数本身可以用于多个寄存器。

```
void readCallback(tsRegister const *pRegister)
{
  int value;
  if (pRegister->registerSize == 1 )
    value = *(uint8_t*)pData;
  else if (pRegister->registerSize == 2 )
    value = *(uint16_t*)pData;

  if ( pRegister->register == MR_ACT_VOLTAGE )
    doSomething();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T22:38:14.853

我可能会为此编写一些代码来提供“源代码”，并且有一个“编译器”。

所以你的原始来源是这样的：

```
# INPUT_SENSOR(callback1, callback2, address, sensor_id)
SENSOR(read_sensor, write_sensor, 100, 1)
SENSOR(read_sensor, write_sensor, 104, 2)
 ...
# CALIBTRATE(callback1, callback2, id, address, size, min, max, default)
CALIBRATE(calib_write, calib_read, 1, 44, 11, 18, 99, 33)
CALIBRATE(calib_write, calib_read, 2, 45, 12, 19, 98, 34) 
```

然后，您可以让它生成这样的数据结构：

```
struct funcptrs {
   int (*readfunc)(int count, int arr[]); 
   void (*writefunc)(int count, int arr[]); 
   int count;
   int *arr; 
};

static const int arr1[] = { 100, 1 };
static const int arr2[] = { 104, 2 };

static const int arr3[] = { 1, 44, 11, 18, 99, 33 };
static const int arr4[] = { 2, 45, 12, 19, 98, 34 };

struct funcptrs functable[] = 
{
    { read_sensor, write_sensor, 2, arr1 },
    { read_sensor, write_sensor, 2, arr2 },
    { calib_write, calib_read, 6, arr3 }, 
    { calib_write, calib_read, 6, arr4 }, 
}; 
```

也许可以使用 C 预处理器提出这个问题并运行两次，也许 - 我过去做过这种事情，但我有点懒得在这里尝试 - 我想我' d 宁愿写一段 20-30 行的 C 代码来生成代码，因为它更灵活，通常更容易理解/遵循。

# css - Visual Studio 在 CSS 文件的开头插入不需要的文本

> ID：14408482
> 
> 赞同：1
> 
> 时间：2013-01-18T22:10:33.867
> 
> 标签：css, visual-studio

在最近的几个版本中，Visual Studio 一直在 CSS 文件的开头插入奇数字符。我知道它与文本文件的编码有关（它是 Unicode Byte-Ordering-Mark (BOM)。）。几个版本前，我能够更改设置，以便 VS 以不同方式保存文件并停止这样做，但我似乎找不到关于该设置的任何注释。

额外的代码似乎会影响某些浏览器对 css 文件的解释，或者至少会影响 BOM 之后的第一段 css 代码。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:18:57.577

在 VS 2012 中，在工具 > 选项下，有将文档另存为 Unicode 的选项：

![文档选项](../Images/e78d2e9d448dba1070a8e9b36f7921f3.png)

如果您已选中，请尝试取消选中它。您可能必须确保您的 css 文件包含您使用的任何代码页的合法字符。

# c# - 将 MsgPack 与 Servicestack 一起使用：我该如何做 KnownType？

> ID：14408485
> 
> 赞同：3
> 
> 时间：2013-01-18T22:10:37.593
> 
> 标签：c#, serialization, servicestack, msgpack, messagepack

我正在尝试在我当前的 Servicestack 实现中支持 MessagePack 协议。我需要它来支持（反）序列化这样定义的 ISegment 列表：

```
[KnownType(typeof(ArcSegment)), KnownType(typeof(LineSegment))]
public class PathRequest
{
  public List<ISegment> Segments {get;set;}
}

public interface ISegment
{
  Point StartPoint {get;set;}
  Point EndPoint {get;set;}
}

public class ArcSegment: ISegment {...}
public class LineSegment: ISegment {...} 
```

开箱即用它告诉我

类型“Asi.Geometry.ISegment”没有默认（无参数）公共构造函数和具有 Int32 参数的公共构造函数。

这是非常真实的。显然它不使用 KnownType 属性。在网上阅读后，我发现我可以制作自己的序列化器。因此我尝试了这个：

```
class ArcLineSerializer: MessagePackSerializer<ISegment>
{
    private readonly MessagePackSerializer<ArcSegment> _arcSerializer = MessagePackSerializer.Create<ArcSegment>();
    private readonly MessagePackSerializer<LineSegment> _lineSerializer = MessagePackSerializer.Create<LineSegment>();

    protected override void PackToCore(Packer packer, ISegment objectTree)
    {
        if(objectTree is ArcSegment)
            _arcSerializer.PackTo(packer, (ArcSegment)objectTree);
        else if (objectTree is LineSegment)
            _lineSerializer.PackTo(packer, (LineSegment)objectTree);
        else
            throw new NotSupportedException();
    }

    protected override ISegment UnpackFromCore(Unpacker unpacker)
    {
        var data = unpacker.Data;
        if (data != null)
        {
            if (data.Value.IsTypeOf<ArcSegment>().GetValueOrDefault())
                return _arcSerializer.UnpackFrom(unpacker);
            if (data.Value.IsTypeOf<LineSegment>().GetValueOrDefault())
                return _lineSerializer.UnpackFrom(unpacker);
            throw new NotSupportedException();
        }
        return null;
    }
} 
```

唉，这给了我尝试构造 _arcSerializer 的相同错误。它是怎么做的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T00:09:02.843

您不能只从消息中获取打包类的类型，而是可以将一些类型标识符与序列化数据一起传递。

这就是接口序列化的通用方式。

```
class InterfaceSerializer<T> : MessagePackSerializer<T>
{
    private Dictionary<string, IMessagePackSerializer> _serializers;

    public InterfaceSerializer()
        : this(SerializationContext.Default)
    {
    }

    public InterfaceSerializer(SerializationContext context)
    {
        _serializers = new Dictionary<string, IMessagePackSerializer>();

        // Get all types that implement T interface
        var implementingTypes = System.Reflection.Assembly
            .GetExecutingAssembly()
            .DefinedTypes
            .Where(t => t.ImplementedInterfaces.Contains(typeof(T)));

        // Create serializer for each type and store it in dictionary
        foreach (var type in implementingTypes)
        {
            var key = type.Name;
            var value = MessagePackSerializer.Create(type, context);
            _serializers.Add(key, value);
        }
    }

    protected override void PackToCore(Packer packer, T objectTree)
    {
        IMessagePackSerializer serializer;
        string typeName = objectTree.GetType().Name;

        // Find matching serializer
        if (!_serializers.TryGetValue(typeName, out serializer))
        {
            throw SerializationExceptions.NewTypeCannotSerialize(typeof(T));
        }

        packer.PackArrayHeader(2);             // Two-element array:
        packer.PackString(typeName);           //  0: Type name
        serializer.PackTo(packer, objectTree); //  1: Packed object
    }

    protected override T UnpackFromCore(Unpacker unpacker)
    {
        IMessagePackSerializer serializer;
        string typeName;

        // Read type name and packed object
        if (!(unpacker.ReadString(out typeName) && unpacker.Read()))
        {
            throw SerializationExceptions.NewUnexpectedEndOfStream();
        }

        // Find matching serializer
        if (!_serializers.TryGetValue(typeName, out serializer))
        {
            throw SerializationExceptions.NewTypeCannotDeserialize(typeof(T));
        }

        // Unpack and return
        return (T)serializer.UnpackFrom(unpacker);
    }
} 
```

您需要为所需的接口注册自定义序列化程序。例如，使用默认序列化上下文，您可以：

```
SerializationContext.Default.Serializers
    .Register<ISegment>(new InterfaceSerializer<ISegment>()); 
```

由于注册了序列化程序，因此可以像往常一样打包和解包包含 ISegment 的对象。

```
var packer = MessagePackSerializer.Create<PathRequest>();
packer.Pack(stream, somePathRequest);
stream.Position = 0;
var unpackedPathRequest = packer.Unpack(stream); 
```

# java - Maven Appassembler 插件 - 标准输出和/或标准错误重定向

> ID：14408486
> 
> 赞同：3
> 
> 时间：2013-01-18T22:10:41.657
> 
> 标签：java, bash, shell, maven, appassembler

我正在将一个 java 项目迁移到 Maven 中，我们正在使用 Appassembler maven 插件（1.3 版）来生成 shell 启动脚本。我的问题是如何重定向标准输出和/或 java 程序的输出？这个 Appassembler 的 pom.xml 配置

```
 <program>
          <mainClass>com.mycompany.app.App</mainClass>
          <commandLineArguments>
            <commandLineArgument>arg1</commandLineArgument>
            <commandLineArgument>arg2</commandLineArgument>
          </commandLineArguments>
          <name>app</name>
        </program> 
```

生成：

```
exec "$JAVACMD" $JAVA_OPTS \
  $EXTRA_JVM_ARGUMENTS \
  -classpath "$CLASSPATH" \
  -Dapp.name="app" \
  -Dapp.pid="$$" \
  -Dapp.repo="$REPO" \
  -Dbasedir="$BASEDIR" \
  com.mycompany.app.App \
  arg1 arg2 "$@" 
```

参数占位符 ($@) 是启动脚本中最后生成的标记。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:10:41.657

找到了解决此问题的方法。幸运的是，参数占位符与生成的命令行参数位于同一行。所以这个 pom.xml 配置：

```
<commandLineArguments>
    <commandLineArgument>"$@"</commandLineArgument>
    <commandLineArgument>&gt;&gt;out.log</commandLineArgument>
    <commandLineArgument>2&gt;&amp;1</commandLineArgument>
    <commandLineArgument>#</commandLineArgument>
</commandLineArguments> 
```

将生成脚本：

```
....
com.mycompany.app.App \
"$@" >>out.log 2>&1 # "$@" 
```

Hash 是 bash 中的注释，因此最后一个参数占位符将被忽略，此 hack 将完成重定向工作。

# algorithm - 根据平均值计算增长百分比的最有效方式

> ID：14408487
> 
> 赞同：0
> 
> 时间：2013-01-18T22:10:43.833
> 
> 标签：algorithm, math

假设 5 件商品以 10% 的加价出售。在产生销售后，发现可变费用已经吞噬了某些商品的利润。

例子：

```
Item #1:
    price = 11.00
    cost = 10.00
    fees = 1.34
    desired change = 12.34

Item #2:
    price = 16.50
    cost = 15.00
    fees = 2.00
    desired change = 18.00

Item #3:
    price = 55.00
    cost = 50.00
    fees = 2.50
    desired change = N/A

Item #4:
    price = 33.00
    cost = 30.00
    fees = 4.65
    desired change = 35.65

Item #5:
    price = 27.50
    cost = 25
    fees = 1.25
    desired change = N/A 
```

是否有一个公式可以用来计算基于先前销售的平均利润损失的所有项目的利润增长百分比？

我不擅长公式，我打算用算法编写这个算法的方式效率低下。我确信这应该很简单，但我的头脑很冷，很难弄清楚这两种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:54:58.693

不确定这对于您的想法是否过于简单，但假设我们有

```
P = purchase price (total for all items) 
M = Markup (profit) factor  (0.1, or 10 percent initially, in your case) 
V = variable fees  (the cost that eats up your net profit) 
```

然后您要确保以下等式为真

```
P * M - V >= 0 
```

这与

```
P * M >= V 
```

这与

```
M >= V / P 
```

因此，假设您的总购买金额为 1000 美元，而您的“可变费用”为 200 美元，那么您的利润率应该至少为 200 美元/1000 美元 = 0.2，即 20%。

您是否试图计算为弥补您已经遭受的损失而必须施加的价格上涨？

# mongodb - MongoDB 的 getLastError() 命令是否指示受 $rename 命令影响的记录数？

> ID：14408489
> 
> 赞同：1
> 
> 时间：2013-01-18T22:10:46.267
> 
> 标签：mongodb, mongodb-shell

我正在开发一个应用程序，它使用“字典”集合中的字段映射整理导入的数据，并试图查看有多少记录受到[`$rename`](http://docs.mongodb.org/manual/reference/operator/rename/)操作的影响。mongo shell 什么时候[`db.getLastError()`](http://docs.mongodb.org/manual/reference/command/getLastError/)代表用户调用？我读过它确实`getLastError()`在控制台中以交互方式接受新语句之前调用，但是命令行调用的语义是`mongo script.js`什么？我假设`getLastError()`根本没有调用脚本，但无法在文档中找到确认。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T05:35:29.157

从[打开新连接文档](http://docs.mongodb.org/manual/tutorial/write-scripts-for-the-mongo-shell/#opening-new-connections)：

> ...此外，在脚本中，您需要显式调用 db.getLastErrorObj() 或 db.getLastError() 以等待写入操作的结果。

这`db.getLastErrorObj()`是您想要调用以获取 update/$rename 操作的结果。它返回和对象看起来像：

```
{
    "updatedExisting" : true,
    "n" : 2,
    "connectionId" : 35,
    "err" : null,
    "ok" : 1
} 
```

`n`是更新文档的数量。

# vba - 通过 VBA 的 SMTP Outlook 地址

> ID：14408491
> 
> 赞同：0
> 
> 时间：2013-01-18T22:10:46.570
> 
> 标签：vba, smtp, excel-2007, outlook-2007

我正在尝试通过 VBA 为 Outlook 2007 中的一组电子邮件检索 SMTP 地址。我需要来自发件人的完整 SMTP 地址。该地址主要来自 EXCHANGE 2007 服务器。

我有 smtp 地址 test@something.co.uk；test1@something.co.uk; test3@somthing.co.uk 在另一个表中查看电子邮件地址到另一个字段。

我需要使用电子邮件中的 SMTP 地址来查找该字段。

执行 storename = mItem.SenderEmailAddress 时，我得到一个 x400 地址，但我需要 SMTP 地址。当然有办法解决这个问题。我不想使用赎回。我希望有人可以为此提供答案。

谢谢H

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T09:16:47.423

试试下面的代码，虽然在 2010 年忙着使用

```
Sub Test()
Dim appOutlook As Outlook.Application
Dim nsOutlook As Outlook.Namespace
Dim cfOutlook As Outlook.Folder
Dim ifOutlook As Outlook.Folder
Dim x  As Long
Dim y As Long

'Create a new instance of the Outlook application.
'Set the Application object as follows:
Set appOutlook = New Outlook.Application

'use the GetNameSpace method to instantiate (ie. create an instance)
'a NameSpace object variable, to access existing Outlook items.
'Set the NameSpace object as follows:
Set nsOutlook = appOutlook.GetNamespace("MAPI")

'assign the object variable cfOutlook to the default Contacts folder:
Set cfOutlook = nsOutlook.GetDefaultFolder(olFolderContacts)
MsgBox cfOutlook

'assign the object variable ifOutlook to the default Inbox folder:
Set ifOutlook = nsOutlook.GetDefaultFolder(olFolderInbox)
MsgBox ifOutlook

y = nsOutlook.Accounts.Count
MsgBox y

For x = 1 To y
MsgBox nsOutlook.Accounts(x)
MsgBox nsOutlook.Accounts.Item(x).SmtpAddress
Next x

End Sub 
```

# image - Scrapy：下载 svg 图像

> ID：14408495
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:11:24.380
> 
> 标签：image, svg, download, scrapy, web-crawler

我需要从这些网站上抓取一些网站和一些图片。当图像是 *.jpg 时，我没有任何问题，但这些网站也有 *.svg 图像，我需要这些。

有没有人这样做过？

这是带有错误的shell输出：

```
2013-01-18 14:44:10-0600 [crawler] DEBUG: Image (downloaded): Downloaded image from <GET http://page/image.svg> referred in <None>
2013-01-18 14:44:10-0600 [crawler] Unhandled Error

Traceback (most recent call last):
File "/virtualenvs/asd/local/lib/python2.7/site-packages/twisted/internet/defer.py", line 576, in _runCallbacks
        current.result = callback(current.result, *args, **kw)
File "/virtualenvs/asd/local/lib/python2.7/site-packages/twisted/internet/defer.py", line 381, in callback
        self._startRunCallbacks(result)
File "/virtualenvs/asd/local/lib/python2.7/site-packages/twisted/internet/defer.py", line 489, in _startRunCallbacks
        self._runCallbacks()
File "/virtualenvs/asd/local/lib/python2.7/site-packages/twisted/internet/defer.py", line 576, in _runCallbacks
        current.result = callback(current.result, *args, **kw)
    --- <exception caught here> ---
File "/virtualenvs/asd/local/lib/python2.7/site-packages/Scrapy-0.16.3-py2.7.egg/scrapy/contrib/pipeline/images.py", line 199, in media_downloaded
        checksum = self.image_downloaded(response, request, info)
File "/virtualenvs/asd/local/lib/python2.7/site-packages/Scrapy-0.16.3-py2.7.egg/scrapy/contrib/pipeline/images.py", line 252, in image_downloaded
        for key, image, buf in self.get_images(response, request, info):
File "/virtualenvs/asd/local/lib/python2.7/site-packages/Scrapy-0.16.3-py2.7.egg/scrapy/contrib/pipeline/images.py", line 261, in get_images
        orig_image = Image.open(StringIO(response.body))
File "/virtualenvs/asd/local/lib/python2.7/site-packages/PIL/Image.py", line 1980, in open
        raise IOError("cannot identify image file")
    exceptions.IOError: cannot identify image file 
```

谢谢 ！（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T14:05:53.360

如果它对其他人有帮助，我可以按以下方式解决这个问题

在 item.py 中，将这些属性添加到对象中：

```
 body = Field()
      url = Field() 
```

在蜘蛛中（在 def parse() 内），添加以下代码：

```
import urllib2 

(...)

    #select each img url
    relative_urls = info.select('tr/td/a[@class="image"]/img/@src').extract()

    for relative_url in relative_urls:
        #static url
        relative_url = relative_url.split("svg")[0][2:-1]+".svg"
        relative_url = ''.join(relative_url.split("/thumb")).strip()

        relative_url = "http://"+relative_url

        asd = urllib2.urlopen(relative_url)
        data = asd.read()
        with open("%s/%s" % ('/home/user/virtualenvs', img.svg), "wb") as code:
            code.write(data) 
```

这个对我有用

（显然可以将蜘蛛和管道之间的代码分开）

# php - 没有回显来自查询结果的数据 - mysqli/php

> ID：14408497
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:11:30.650
> 
> 标签：php, mysqli

我想将查询结果中的数据输出到文本输入和正常回显中，但它没有输出任何内容。我在 php 中没有错误，我在 mysqli 代码中做错了什么，它没有回显任何东西吗？

```
function ShowAssessment()
    {
        $sessiondetailsquery = "
            SELECT SessionId, SessionName        
            FROM Session
            WHERE
            (SessionId = ?)";

        global $mysqli;

        $sqlstmt=$mysqli->prepare($sessiondetailsquery);

        $sqlstmt->bind_param("i",$_POST["session"]);

        $sessiondetailsqrystmt=$mysqli->prepare($sessiondetailsquery);
        // You only need to call bind_param once
        $sessiondetailsqrystmt->bind_param("i",$_POST["session"]);
        // get result and assign variables (prefix with db)
        $sessiondetailsqrystmt->execute(); 
        $sessiondetailsqrystmt->bind_result($detailsSessionId,$detailsSessionName);?>

        $sqlstmt->fetch(); 

        $sqlstmt->close(); 

        <h3>CHOSEN ASSESSMENT</h3>
        <input type='text' id='currentId' name='Idcurrent' readonly='readonly' value='<?php $detailsSessionId; ?>' /></td> 
        <br>
        <strong>Assessment:</strong> <?php echo $detailsSessionName; ?>
        <?php
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:23:45.320

你有 2 个 bind_params 在你的代码中做同样的事情。

# hazelcast - Hazelcast 在调用 IMap.get() 时是否总是反序列化？

> ID：14408501
> 
> 赞同：2
> 
> 时间：2013-01-18T22:11:55.077
> 
> 标签：hazelcast

我有一个应用程序需要每秒数千次从分布式缓存中获取对象。我一直在使用 Hazelcast 的 IMap.get()，但似乎当我调用它时，我的对象的反序列化代码也会被调用。我们无法承受一遍又一遍反序列化的开销。

有没有办法让 Hazelcast 保存完整的对象而不是字节数组？

（我会将此发送到 Hazelcast 邮件列表，但 Google 群组拒绝让我发帖。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:22:03.113

对您的问题的简短回答是否定的，没有办法阻止每次访问时对字节数组进行反序列化（有一个小例外，见下文。）

为了让 Hazelcast 与集群中的其他节点共享您的对象，它必须将这些对象的序列化版本作为字节数组传递。因此，每次调用`IMap.get(key)`Hazelcast 时，都会从拥有它的任何节点检索代表对象的字节数组，并对其进行反序列化以创建对象的克隆副本。没有办法解决这个问题，并且仍然有一个在集群中的多个节点之间保持一致的分布式映射。

有一个小例外。默认情况下，IMaps 将为*请求节点拥有的对象*缓存实际的反序列化对象。这是使用`cache-value`配置参数设置的（默认为`true`）。但是，除非您在修改对象后显式执行（或、或、或其变体之一），否则对该缓存值的任何更改*都不会分发到其他节点。*请参阅 Hazelcast 文档中的第 18.1 节第 2 项。`IMap.put(key, value)``replace``set`

启用`near-cache`映射将节省从拥有节点检索字节数组的成本（即通过网络将字节从拥有节点传输到请求节点），因为它将字节缓存在请求节点上，但反序列化仍然发生在每次访问。这以牺牲一致性为代价为您提供了更好的性能。它对于检索不经常更改的对象很有用。

# objective-c - 在设备之间来回发送 NSData - GameCenter 替代方案

> ID：14408502
> 
> 赞同：3
> 
> 时间：2013-01-18T22:11:57.053
> 
> 标签：objective-c, xcode, network-programming, nsdata, gamekit

我正在尝试构建一个需要通过互联网在两个设备之间发送数据的应用程序。有点像 GameKit，但我想在没有 GameKit 的情况下实现该功能，因为我希望能够在不同类型的智能手机之间进行交换。我希望它像 GameCenter 中的实时比赛。

在 GameKit 中，我将使用以下内容：

```
//To send the data
- (BOOL)sendDataToAllPlayers:(NSData *)data withDataMode:(GKMatchSendDataMode)mode error:(NSError **)error;

//To receive the data
- (void)match:(GKMatch *)theMatch didReceiveData:(NSData *)data fromPlayer:(NSString *)playerID; 
```

有没有办法在没有 GameKit 的情况下完成同样的实现？我知道 Fun Run 游戏可以在没有 GameCenter 的情况下进行实时比赛。

任何回复都非常感谢！在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-10T22:25:11.193

好吧，这对于两个设备都打开持久连接的专用服务器来说是微不足道的，如果没有它可能是不可能的（如果它们的 IP 地址都发生变化，你的设备如何找到彼此？）

# azure - Azure 'Microsoft.ACE.OLEDB.12.0' 提供程序未在本地计算机上注册

> ID：14408511
> 
> 赞同：1
> 
> 时间：2013-01-18T22:12:18.357
> 
> 标签：azure

我在使用 Azure 时遇到问题，我想处理一个 excel 文件，但我收到错误消息“'Microsoft.ACE.OLEDB.12.0' 提供程序未在本地计算机上注册。”。

我已经在我的电脑上安装了 AccessDataBaseEngine 2007，我得到了同样的错误信息。

我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T11:02:02.500

> 如果您只需要使用 Excel 2007 格式或更高版本 (xlsx)，则可以使用 OpenXml SDK。此 SDK 需要在您的本地计算机上安装。但是您可以简单地在您的 Web/Worker 角色中引用 DocumentFormat.OpenXml.dll 程序集，并将 Copy Local 设置为 true。它将在云中工作。它也不需要在云机器上安装 Office。

有关更多信息，请检查[**仅 Azure 上的错误 - 'Microsoft.ACE.OleDb.12.0' 提供程序未在本地计算机上注册，**](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/dea3746e-d5ae-4ccc-af0f-9a0e708d32aa)并且[**'Microsoft.ACE.OLEDB.12.0' 提供程序未在本地计算机上注册**](http://www.c-sharpcorner.com/Forums/Thread/106756/)

我希望这对你有帮助。

# javascript - 重构代码 - 处理它的一般方法

> ID：14408514
> 
> 赞同：1
> 
> 时间：2013-01-18T22:12:30.647
> 
> 标签：javascript, algorithm, language-agnostic, refactoring

我有一个代码，它有一个`start()`执行每个周期的函数。在其中我在这里和那里调用一个`pause()`函数。

我现在必须`pause()`根据某些条件变得更加聪明。在某些地方，它是在其他地方不需要的条件下执行的。

我知道我现在必须创建一个单独的函数来调用该`pause()`函数。但这就是我所得到的。感觉就像一个迷宫，我迷路了。

编写此代码的最佳方法是什么？高手是怎么做到的？

**更新：**

我已经添加了我的代码。基本上我希望我`pauseActivator`做不止一个动作。

1.  充当条件测试器并返回真或假。

2.  实际调用暂停函数。

也许我不应该让我的功能这样做？

```
void doPause() {
   //call system default pause function()
}

bool pauseOn = true;
string myPauseTime = "02:30";
bool pauseTimeReached = false;

bool pauseActivator() {
    if(pauseOn && systemTime() == myPauseTime){
        pauseTimeReached = true;
        doPause();
    } 
    return (pauseTimeReached);  
}

int start() {
    if(maxMovement > 500 && pauseActivator()) {
        if(maxA() && secondMovement==600) {
            pauseActivator();
        }
    }
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T16:47:44.827

我建议您使用 DoPause 进行暂停，并具有返回暂停状态的功能。具有实际暂停的“隐藏”副作用的测试功能可能会导致问题。

# coldfusion - Helicon ISAPI Rewrite 3 Lite 是否缓存文件以进行存在检查？

> ID：14408519
> 
> 赞同：1
> 
> 时间：2013-01-18T22:13:01.227
> 
> 标签：coldfusion, iis-6, isapi-rewrite

我正在为站点开发动态缩略图生成功能，并且正在使用 mod_rewrite 功能对已生成的图像进行快速缓存。

我使用以下重写条件执行此操作：

```
RewriteCond  %{DOCUMENT_ROOT}%{REQUEST_FILENAME}    !-s
RewriteRule  ^/thumber/images/([0-9]+)_([0-9]+)_(.+)$  /thumber/thumbnail.cfm?src=$3&w=$1&h=$2  [PT,L,QSA] 
```

第一行确保重写规则仅在请求的图像不存在时转发到我的脚本页面。

这在 Apache 2 中运行良好，但是当我使用 ISAPI Rewrite 3 Lite 将相同的规则移动到 IIS 服务器时，它总是表现得好像文件不存在一样，即使在已经生成缩略图的第一次重定向之后也是如此。

简而言之，由于某种原因，**!-s**标志似乎根本不起作用。我也尝试过**!-f**并且没有任何变化。

我在想也许这个版本的 ISAPI Rewrite 正在使用某种缓存信息来确定文件是否存在。

除此之外，我不明白为什么它适用于 Apache 而不是 ISAPI。

请帮忙！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:54:20.087

好的，我发现了问题！

这一切都归结为权限问题。ISAPI 重写进程没有足够的权限来读取我在其中写入生成的缩略图 (/thumber/images/) 的文件夹的内容，因此它假定该文件不存在。

解决方案是将正确的权限分配给正确的用户。

我只是按照这篇博文中的步骤操作：

[http://vbscriptautomation.net/29/wordpress-permalinks-isapi-rewrite-3-windows-plesk/](http://vbscriptautomation.net/29/wordpress-permalinks-isapi-rewrite-3-windows-plesk/)

谢谢

# memory-leaks - 使用 destroy() 命令时的 Perl/Tk 内存泄漏

> ID：14408521
> 
> 赞同：2
> 
> 时间：2013-01-18T22:13:09.880
> 
> 标签：memory-leaks, destroy, perltk

我在 Unix 上运行的 Perl/Tk 中存在大量泄漏问题。由于某些限制，我无法发布大部分代码，但我已经能够确定导致内存泄漏的原因并创建了一个具有相同症状的小程序。基本上，我正在运行一个 GUI，其中一个框架被破坏并定期重新填充。然而，这似乎会导致大量内存泄漏并不断增长。我以为销毁命令会清除内存中的所有痕迹，但似乎并非如此。我也不太熟悉 Perl 中的垃圾收集。该程序一次将运行数天或数周，因此内存泄漏并不理想。有没有人有任何想法来阻止内存泄漏？我仅限于使用 Perl，所以不幸的是我不能轻易地将代码移植到 Python 或其他东西上。

```
#!opt/project/COTS/bin/perl
use strict;
use warnings;
use Tk;

$Tk::mw = MainWindow->new;
$Tk::mw->repeat(10,\$build);
my $status;
&build;

sub build{
    $status->destroy() if ($status);
    $status = $Tk::mw->Frame->pack(-side => 'top');

    my $left_frame = $status->Frame(
        -relief =>'sunken',
        -borderwidth => 1
    )->pack(-side => 'left', -anchor => 'nw', -padx => 4, -pady => 5);

    my $right_frame = $status->Frame(
        -relief =>'sunken',
        -borderwidth => 1
    )->pack(-side => 'left', -anchor => 'nw', -padx => 4, -pady => 5);

}
MainLoop; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T08:16:13.533

是的，这是众所周知的。Perl/Tk 系统在销毁小部件时会出现一些遗留问题（实际上不是 Perl 的错，而是 Perl/Tk 子系统的错）。

最好的方法是重用小部件。大多数情况下这是可能的，因为您可以重新配置所有选项。如果某些子小部件即将消失并重新出现，则可以使用`packForget()`暂时将它们从显示中移除，然后`pack()`再次使用以使它们可见。

# jquery - 循环遍历 AJAX 响应和 div，设置 div 值等于相同 id 的 AJAX 值

> ID：14408522
> 
> 赞同：0
> 
> 时间：2013-01-18T22:13:14.230
> 
> 标签：jquery, ajax, object, loops, uniqueidentifier

因为有了 jQuery，我已经能够最大限度地放纵我的懒惰，但真正的好处是把大部分时间花在好东西上，而不是花在乏味的东西上。我想进一步说明这一点。

目前，我会有一些像这样的 HTML：

```
<div id="id1"></div>
<div id="id2"></div>
<div... 
```

等等。

然后，我会调用`ajax`，期望对象“ids”与 div ids 相同，如下所示：

```
$.ajax({
    success: function (msg) {
        $("#id1").text(msg.id1);
        $("#id2").text(msg.id2);
        $("#... 
```

等等。

这可以简化为“单线”吗？具体来说，我不知道如何`div`在响应对象数组中使用 s 的 id。

提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:17:21.153

如果有办法将您的 div 与页面上的其他 div 分开，您可以这样做

```
$('div[id^=id]').text(function(){ return msg[this.id]  }); // <-- one liner just for you 
```

访问对象的属性可以通过两种方式完成。

```
msg.property
msg[property] // <-- this way is more flexible... 
```

因此，您实际上将每个 div 的 id 作为属性名称传递

```
msg[id1] // etc.. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:17:44.817

是的，它可以，使用[`jQuery.each()`](http://api.jquery.com/jQuery.each/)方法：

```
success: function (msg) {
  jQuery.each(msg, function(key, value){
    $('#' + key).text(value);
  });
} 
```

# javascript - 自执行匿名函数和闭包

> ID：14408527
> 
> 赞同：0
> 
> 时间：2013-01-18T22:13:26.370
> 
> 标签：javascript, closures

**信息**

我正在尝试构建一个站点，我可以在其中包含某些文件并使用不同的方法附加到我的全局变量中，这些方法可以很容易地添加到对象中。这意味着我只需要包含该文件，此页面现在可以访问 hutber 对象中的所有内容。

**核心hutber.js**

```
var hutber = {};

(function ($) {
    "use strict"; //For good development standards :)

    hutber.init = function(){

    };
    hutber.init();
})(jQuery); 
```

**额外的位 hutber.form.js**

```
(function ($) {
    "use strict"; //For good development standards :)

    hutber.form = {

    }

}); 
```

**问题**

我知道在闭包`hutber`中将无法访问它。`hutber.form`因此，如果不将这些从自我执行功能中取出，我该如何`hutber`访问`hutber.form`？或者这只是解决这个问题的完全错误的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:17:01.000

不，它可以访问，`hutber.form`因为`hutber`它是全球性的，但问题在于时间。

如果 init() 在`hutber.form`函数执行之前运行，它将不存在。init 不能运行到所有的“附加组件”都加载完毕。

附注：您的第二个不会运行，因为它没有`(jQuery);`.

```
(function ($) {
    "use strict"; //For good development standards :)

    hutber.form = {

    }

});  <-- missing  (jQuery); so it is not going to do anything 
```

运行一个小演示看看会发生什么。

```
var myObj = {};

(function(){

    myObj.init = function(){
        alert("init");
        try{ //will fail since bar has not loaded yet
        myObj.bar();
        } catch(e){ alert("failed calling bar"); }
    };
    //call init before bar is loaded
    myObj.init();
})();

(function(){

    myObj.bar = function(){
        alert("bar");
    };
})();

//call init after bar has been loaded
myObj.init(); 
```

[上面代码的jsFiddle](http://jsfiddle.net/pFvkc/)

当你运行它时，你会看到 init 在第一次调用时会失败，因为 bar 没有加载。自添加该方法以来，它将第二次起作用。因此，如果 init 依赖于加载的“模块”，它需要知道它们何时加载才能调用 init 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:20:09.107

我想你想要这个：

```
<script src="hutber.js"></script>
<script src="hutber.form.js"></script>
<script> hutber.init(); </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:18:39.533

看到您如何将 hutber 定义为全局变量，“form”属性肯定可以在任何立即调用的函数表达式中访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:30:12.493

您可能以错误的方式看待这个问题。

并不是说立即调用的函数是构建功能的错误方式......

然而，我要说的是，你有一个全局可用的对象，你直接从你的函数中引用它......

分配后`hutber.form = {};`，全球范围内的所有事物都可以完全访问`hutber.form`，因为`hutber`是全局可访问的。

如果你像这样，真的不会有什么不同：

```
//form.js
hutber = hutber || {};
hutber.form = { /* ... */ }; 
```

在公共访问方面`hutber.form`。

闭包涵盖了您不返回的内容以及您不分配给外部范围内的对象/数组/变量的内容。

所以如果你`var mySecretIdentity = "Jerry O'Connell";`在闭包里面，那么只有里面的方法`hutber.form`可以访问`mySecretItentity`......

...但是同样，您可以通过执行以下操作来完成相同的操作：

```
// form.js
hutber = hutber || {};
hutber.form = (function () {
    var mySecretIdentity = "Jerry O'Connell";

    return {
        submit : function () {},
        clear  : function () {},
        validate : function () {}
    };
}()); 
```

现在任何私有的东西都只能被写在闭包内的函数直接访问。

再一次，它归结为：“你想解决什么问题？”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T22:42:52.923

`<script>`正如@Sime Vidas 提到的，标签顺序很重要。

执行以下命令：

```
<script src="hutber.js"></script>
<script src="hutber.form.js"></script> 
```

我修改了[jsFiddle](http://jsfiddle.net/QUePr/)中的脚本。你会注意到我喜欢通过使用 window.variable 来明确全局变量。如果这是您想要的，我在核心 hutber.js 文件中的 init 函数会立即触发。

```
//core hutber.js 
window.hutber = {}; // Explicit Global Variable

(function ($) {
    "use strict"; //For good development standards :)

    window.hutber.init = function(){
      alert('init fired');  
    };

    window.hutber.init(); // You can fire this anywhere since you set it on a global variable...
})(jQuery);

//Extra bits hutber.form.js
(function ($) {
    "use strict"; //For good development standards :)
    window.hutber.form = {prop: "hello im a form"}
    alert('window.hutber.form is now' + window.hutber.form.prop);
})(jQuery); 
```

# php - 如何通过 PHP 连接到 Sybase

> ID：14408531
> 
> 赞同：8
> 
> 时间：2013-01-18T22:13:35.623
> 
> 标签：php, sybase, dbo

我正在尝试使用 PHP5 连接到 Sybase 数据库。我相信我已经成功地将 PHP 编译`PDO_DBLIB`为PDO 驱动程序下的`phpinfo()`列表和风味。`dblib``freetds``pdo_dblib`

但是，当我尝试测试连接时，我得到一个错误读数：

> 带有消息“找不到驱动程序”的“PDOException”

我正在尝试使用以下代码连接到 LAN 上的服务器：

```
$dbh = new PDO("sybase:host=192.168.1.xxx;dbname=[database-name]", '[user]', '[pass]'); 
```

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-16T18:10:16.693

您应该使用`dblib`而不是`sybase`，如下所示：

```
$dbh = new PDO("dblib:host=192.168.1.xxx;dbname=[database-name]", '[user]', '[pass]'); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-08T11:39:06.340

如果您使用的是 Ubuntu，您可以将**LD_LIBRARY_PATH**放在 envvars 中，它似乎可以读取......仍在尝试找到一种方法让它坚持在基于**RHEL**的系统上......我不太确定我希望你能在下设置一个系统范围的变量

> 我的电脑 -> 属性 -> 高级选项

如果使用的是基于**RHEL**的系统，最好 在 httpd 重启脚本中包含： **export LD_LIBRARY_PATH=/path/to/library** **/** - 现在重新启动 apache，您应该会看到一些活动。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-19T00:26:02.440

PDO 不起作用，或者至少没有 PDO Sybase 对 php 的支持。在 Windows 上，您可以使用 ODBC，以及[PDO_SQLSRV](http://php.net/manual/en/ref.pdo-sqlsrv.php)或[PDO_ODBC](http://php.net/manual/en/ref.pdo-odbc.php)，这听起来可能很奇怪，但它应该可以工作。

第二个选项，我会推荐它，是直接连接到 Sybase (SqlAnywhere)，但你需要安装[SQL Anywhere PHP 模块](http://www.sybase.co.uk/detail?id=1019698)

# php - mod_rewrite 破坏链接href

> ID：14408532
> 
> 赞同：0
> 
> 时间：2013-01-18T22:13:38.413
> 
> 标签：php, .htaccess, mod-rewrite

使用 mod_rewrite 时，我想知道是否有一种可能的灵活方式将当前工作目录全局设置为 root，因此通过 mod_rewrite 传递参数时样式表/图像路径不会中断：

我目前使用`define("PATH", "/subfolder/");`它放在每个链接href / src的开头，但我认为必须有一种更灵活的方式来做到这一点。

前任：

stylesheets/styles.css 在没有传递参数时有效，但在使用 mod_rewrite 参数时会中断。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:21:58.490

此处的前两条`RewriteCond`规则排除了与实际存在的文件或文件夹匹配的 URL。

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php?rt=$1 [L,QSA] 
```

或者[通过向您的 mod_rewrite 指令添加显式排除规则。](https://stackoverflow.com/a/1848579/1064767)

# sap - Sybase SUP,(2.1.3) 使用 SAP RFC/BAPI，如何知道调用结果何时可用？

> ID：14408535
> 
> 赞同：1
> 
> 时间：2013-01-18T22:14:16.207
> 
> 标签：sap, sup

设想：

我正在从我的 MBO（作为 OTHER）调用 SAP RFC。该调用会更新我需要回到我的设备上的数据库。呼叫最终正常工作。当结果可用时，我可以使用什么机制让我知道？

1.  （其他）调用是否有一致的同步机制？不是我最喜欢的，但是....
2.  我必须在后台投票，直到我看到我的结果吗？
3.  是否有表明设备和服务器同步的回调？
4.  苹果通知消息？
5.  还有什么？？？？

谢谢。

# ruby-on-rails - 继承方法：STI？MTI？还是简单的多态关联？

> ID：14408536
> 
> 赞同：3
> 
> 时间：2013-01-18T22:14:18.173
> 
> 标签：ruby-on-rails, inheritance, polymorphic-associations, multiple-tables, sti

我正在实施一个应用程序来管理生产订单。每个订单都有很多工序（阶段），包括印刷和折弯。所有流程都有一些共同的属性，如数量和评论，以及一些特定于阶段的属性：

```
create_table :stages do |t|
  t.integer :number
  t.decimal :roll_width
  t.decimal :quantity
  t.string :comments
  t.boolean :finished

  t.timestamps
end

create_table :printing_stages do |t|
  t.integer :color
  t.decimal :technical_card

  t.timestamp
end

create_table :bending_stages do |t|
  t.decimal :flap_width
  t.boolean :seal_distance

   t.timestamps
end 
```

我不确定这里要遵循的propper方法以便能够轻松访问它们的常见+特定属性。

如果我使用 STI，我最终会得到一个巨大的单表，因为某些阶段有 10 多个特定属性。

如果我将多态关联用作：

```
class Stage < ActiveRecord::Base
  belongs_to :stageable, :polymorphic => true
end

class SlittingStage ActiveRecord::Base
  has_one :stage, :as => stageable
end

class PrintingStage ActiveRecord::Base
  has_one :stage, :as => stageable
end 
```

那么我将不得不访问例如印刷阶段的评论，例如`printing_stage.stage.comments`，恕我直言，相当繁琐且不那么优雅。

最后，我不确定使用 MTI 的含义和后果。

你能给我一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:23:39.190

这位女士说得比我好。如果你跳到大约 20 分钟，那就是你的答案所在。

[桑迪·梅斯（Sandi Metz）弄得一团糟](http://confreaks.com/videos/1115-gogaruco2012-go-ahead-make-a-mess)

# mysql - 选择不同的列

> ID：14408538
> 
> 赞同：0
> 
> 时间：2013-01-18T22:14:45.887
> 
> 标签：mysql, sql

我有以下MYSQL：

```
SELECT DISTINCT(`user_id`), `type`, `link`, `add_text`
FROM `activity`  WHERE `id` != 0 AND `type` !=6 AND (`type` = 4 OR `type` = 5)
ORDER BY `id` DESC  LIMIT 4 
```

我只想要 unique `user_id`s，但我的 sql 结果中出现重复。对此 sql 进行的正确修改是什么，以便不重复`user_id`s

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:20:33.363

如果您不关心每个用户的类型、链接或添加文本，您可以使用 min/max 和 group by。

```
SELECT user_id, max(type), max(link), max(add_text)
FROM activity
WHERE id != 0 A
AND type in (4,5) 
Group by User_Id 
ORDER BY id DESC  LIMIT 4 
```

如果你真的关心你可以 group_concat 类型，链接并添加文本

```
SELECT user_id, Group_Concat(type), Group_Concat(link), Group_Concat(add_text) 
FROM activity
WHERE id != 0 A
AND type in (4,5) 
Group by User_Id
ORDER BY id DESC  LIMIT 4 
```

eded group by shoudl 只能在 user_ID 上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:18:04.413

```
SELECT GROUP_CONCAT(DISTINCT `user_id`) user_ids, `type`, `link`, `add_text`
FROM `activity`
WHERE `id` != 0 AND `type` IN (4,5)
GROUP BY `type`, `link`, `add_text` DESC  LIMIT 4; 
```

# html - a href 不可点击

> ID：14408543
> 
> 赞同：2
> 
> 时间：2013-01-18T22:14:58.787
> 
> 标签：html, wordpress, wordpress-theming, z-index, href

[我在 wordpress http://heather.stevenspiel.com/](http://heather.stevenspiel.com/)上有一个简单的博客，我正在尝试将标题标题作为主页的链接。我进入 header.php 并重写了该部分的脚本，但仍然无法获得工作链接。

这是我重新写的：

```
<h1>
   <a href="http://heather.stevenspiel.com/" style="cursor:pointer !important;">My Spiel</a>
  <br/>&nbsp;
</h1> 
```

我知道由于 css 颜色更改，正在注册 href。

之前的代码是这样的：

```
 <h1>
        <?php
            if ($balloons_option['balloons_site-title_line1'] == '' && $balloons_option['balloons_site-title_line2'] == '') { ?>
            This is a<br />
            WordPress theme
        <?php } else {
            echo $balloons_option['balloons_site-title_line1']; ?><br />
            <?php echo $balloons_option['balloons_site-title_line2'];       
        } ?>
    </h1> 
```

我最初尝试将 href 放在 h1 之外，但仍然没有运气。

是否有一些隐藏的 Wordpress 设置会禁用可点击的标题？或者是否有一些我应该注意的禁用它的javascript？

我还应该注意标题的 css 包含一个 z-index。我在某处读到它可能会受到影响：

```
#header .content {
line-height: 18px;
margin: 0;
z-index: 4;
} 
```

如果 z-index 影响它，为什么会这样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T22:17:26.973

`line 37`将 layout.css 的z-index 属性更改为

```
#header h1 {
position: relative;
z-index: 10; /* Was 2 */
} 
```

您的`.entry`( `z-index:4`) div 从上到下垂直覆盖您`#header`，其高度`z-index`高于您的 h1 z-index `(2)`。所以你的 h1/Anchor 是不可点击的，因为它在另一个 div 下。

# java - 使用我创建的 jar 时出现“无法解析导入”错误

> ID：14408544
> 
> 赞同：0
> 
> 时间：2013-01-18T22:15:00.187
> 
> 标签：java, unit-testing, jar, mocking, struts

我正在使用 struts1.2 和 junit 3。为了测试我的动作类，我需要创建 HttpServletRequest 对象。

现在 Struts 1.2 已经没有提供一种方法来创建 HTTPServletRequest 的模拟对象。但是，Struts1.3 有 MockHttpServletRequest.class，您可以使用它来模拟 HTTPServletRequest。

目前还不能从 Struts 1.2 升级到 Struts 1.3。所以我所做的是从 Struts 1.3 中的 mock 包中创建一个 jar 文件并将其添加到我的项目中。

Eclipse 内容工具确实看到了 MockHttpServletRequest 类，即如果我键入“Mockhtt”并按 CTRL+空格，Eclipse 会为我完成类名并添加导入语句。

但是在我创建 HTTPServletRequest 对象后，eclipse 给出了一个错误，说“无法解析导入 org.apache.struts.mock”。![在此处输入图像描述](../Images/af560de45cf78acc83c1a09c4253d5b4.png)

我能做些什么来解决这个错误？我需要模拟 HTTPServletRequest。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T07:05:29.940

您是否在项目中包含了所需的 jar 文件，可能是 struts-core-1.2.xx.jar？

您在项目中包含的 jar 文件似乎不包含引用的类。

仔细检查您包含的 jar 文件，看看它是否真的包含该类。

您可能想下载新的 strut 副本并将上面的 jar 文件复制到您的 lib 文件夹中。

您可以通过任何解压缩软件 (winRAR) 访问 jar 文件来检查 jar 文件中是否存在该类，并查看该类是否存在

“//org/apache/struts/mock/MockHttpServletRequest.class”

希望能帮助到你！

# c++ - 传递结构或类对象

> ID：14408549
> 
> 赞同：2
> 
> 时间：2013-01-18T22:15:35.573
> 
> 标签：c++

```
struct anup1 {
    int a;
};
void structpass_1(struct anup1 b) // accepting structure
{
    cout << b.a;
};
void structpass_2(struct anup1& b) // accepting address of a structure
{
    cout << b.a;
};

int main() {
    struct anup1 a2;
    a2.a = 100;
    structpass_1(a2);
    structpass_2(a2);
} 
```

上面的代码给出了相同的输出...是否接受参数是结构/结构的地址。

谁能向我解释这种行为？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:17:04.337

它将对 struct anup1的[引用传递给函数。](http://en.wikipedia.org/wiki/Reference_%28C++%29)

```
void structpass_2( struct anup1 &b) 
```

看看什么是参考：[参考](http://en.wikipedia.org/wiki/Reference_%28C++%29)

`struct`函数参数列表中也不需要关键字，您可以编写：

```
void structpass_1(anup1 b) // accepting structure
void structpass_2(const anup1& b) // accepting address of a structure 
```

`const`如果它是只读的，则将限定符添加到参数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:16:44.680

```
void structpass_2( struct anup1 &b) 
```

这是拿来*参考*的。指针将带有`*`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T22:31:07.023

在`structpass_1`您的结构中是*按值*`anup1`传递的，因此完成了本地副本并将其传递给函数。

 *相反，在`structpass_2`结构中被传递`by reference`，即指向结构实例的指针被传递给函数（你有指针语义但值语法）。没有完成整个结构的本地副本。

请注意，对于仅包含一个通过值或引用传递的整数的简单结构，从性能角度来看是相同的。但是当您拥有更复杂（更大）的数据时，通过引用传递会更有效。

按值传递与按引用传递的两种情况之间的一个重要区别是，如果您在函数体内*修改*结构实例，则只有通过引用传递结构时，修改才会在调用站点持久化。相反，当您按值传递结构时，由于在函数体内完成了本地复制，因此在函数退出时修改会丢失。例如：

```
void structpass_1(anup1 b) // pass by value
{
    cout << b.a << '\n';
    b.a++; // modification lost at the call site
};

void structpass_2(anup1& b) // pass by reference
{
    cout << b.a << '\n';
    b.a++; // the caller will see the incremented value for b.a
};

int main() 
{
    anup1 a2;
    a2.a = 100;
    structpass_1(a2); // will print 100
    structpass_2(a2); // will print 100
    cout << a2.a; // willl print 101 (structure modified by structpass_2)
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T22:18:22.070

第二个功能

```
void structpass_2( struct anup1 &b) 
```

在 C++ 语法中是按引用传递，按引用传递只会将对象的地址传递给函数。

而第一个功能

```
void structpass_1(struct anup1 b) 
```

使用按值传递。它将首先制作结构 a 的副本，然后传递给函数。通过引用传递更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T22:19:33.947

这些函数对于程序员来说是等价的，它们唯一的区别在于底层的机器代码——第一个对副本（对象）进行操作，第二个通过引用（实际上是指针）对原始对象进行操作。

您得到的输出是 100% 正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T22:44:02.707

简单地说，第一个创建对象的**精确副本**。这对于**优化**代码很有用，但如果您不想修改原始对象，请记住使用**const 。***

# c++ - G ++链接批处理PATH

> ID：14408551
> 
> 赞同：0
> 
> 时间：2013-01-18T22:15:42.280
> 
> 标签：c++, batch-file, path, linker, g++

我的计算机上有 2 个不同的 g++ 编译器：

*   一个在标准目录（C:\MinGW），
*   一种是便携式发行版。

现在我正在尝试链接一个 c++ 项目。

问题是，它与使用 g++ 的可移植发行版编译的 boost 库相关联。标准安装目录当然包含在`PATH`环境变量中。因此，当我尝试编译我的项目时，它会产生链接器错误。

我尝试创建一个批处理文件，该文件在 PATH 变量**的开头添加了可移植版本的目录。**没有运气。也许有人可以帮助我？

```
@echo off
set PATH=%~dp0..\c++\compiler\bin;%PATH%

REM cd /d "%~dp0"

..\c++\compiler\bin\g++ main.cpp ^
-std=c++0x -static-libgcc -static-libstdc++ ^
-I"../c++/include" ^
-L"../c++/lib" ^
-l"boost_serialization-mgw46-mt-1_52" ^
-l"boost_system-mgw46-mt-1_52" ^ 
-o output.exe -W -O2
pause 
```

注意：我在 g++ 命令之前使用了“..\c++\compiler\bin\”，因为我想确保它使用了正确的路径，但它当然不会按我预期的方式工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T23:51:09.750

通过使用已安装的 GCC 版本重新编译 boost 来解决它。

# python - 无法从 django 导入中引用模型

> ID：14408552
> 
> 赞同：0
> 
> 时间：2013-01-18T22:15:42.747
> 
> 标签：python, django

我正在尝试在我正在处理的站点中设置一个模块。我正在构建一个推荐模块，我相信我已经将代码结构正确地组合在一起，尽管我不太确定（我是 Django/Python 的新手，但被告知它类似于 RoR。我没有太多运气）。当我导入它并尝试引用它时，我遇到了一个 Django 无法识别模块模型的问题。例如：

```
 from django.db import models
            from django.db.models import permalink 
```

但是第 2 行会引发错误，因为第 1 行不想正确导入。我从教程中获取了这段代码，我购买的书籍似乎支持这种结构。所以我做了进一步的研究，我认为我需要先激活我的模块，然后才能开始在整个代码中引用它。模型模块陷入了尝试加载和尝试同时查看的循环中。从理论上讲，我的理解是，如果我激活模块，这将停止发生。

所以我被告知我需要在终端中使用与此类似的代码：

```
 python manage.py sql realtor/apps/testimonial/ 
```

然而我的回应是：

```
 Error: App with label realtor/apps/testimonial/ could not be found. 
            Are you sure your INSTALLED_APPS setting is correct? 
```

因此，我查看了已安装的应用程序，据我所知……我已正确设置：

```
 # project
            'realtor',
            'realtor.apps.blog',
            'realtor.apps.testimonial', 
```

我真的被困住了，因为我不知道如何推进，而且由于我缺乏经验，我什至不知道这是我的实际问题。

多谢你们！

**更新**

我还想我会分享我在浏览网站时遇到的错误。

```
ImportError at /admin/
No module named models
Request Method: GET
Request URL:    http://127.0.0.1:8000/admin/
Django Version: 1.4.1
Exception Type: ImportError
Exception Value:    
No module named models
Exception Location:     /Users/andrewkelly/Documents/Projects/1027_BRAD_BIRD/WORKING_BUILD/realtor/apps/testimonial/ad    min.py in <module>, line 2
Python Executable:  /usr/bin/python
Python Version: 2.7.2
Python Path:    
['/Users/andrewkelly/Documents/Projects/1027_BRAD_BIRD/WORKING_BUILD',
 '/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-    scriptpackages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC',
 '/Library/Python/2.7/site-packages'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T01:20:33.400

是`realtor`应用程序吗？也许你必须从你的`INSTALLED_APPS`.

# ms-access - “x =”上的 MS Access VBA 编译错误

> ID：14408557
> 
> 赞同：1
> 
> 时间：2013-01-18T22:15:52.793
> 
> 标签：ms-access

每次我尝试编译我的 VBA 代码时，都会收到一条错误消息，显示“找不到项目或库”。

我不知道我缺少哪个库，因为调试器突出显示的所有内容都是我的 VBA 行之一的一部分：

```
x= 
```

整行如下所示：

```
x = MsgBox("You must select a manufacturer") 
```

任何线索我需要包含什么库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:44:36.973

谢谢汉斯，

我没有注意到我的参考文献之一被标记为“失踪”。...

首先要检查：从 VB Editor 主菜单中，选择 Tools->References。如果任何选定（检查）的引用是“丢失”，那么您的代码可能会发生各种奇怪的废话。修复任何丢失的东西

# php - 我可以获取表名并将其转换为变量然后将其放入 img 标签中吗

> ID：14408558
> 
> 赞同：0
> 
> 时间：2013-01-18T22:15:56.740
> 
> 标签：php, mysql

我正在尝试为我的 Minecraft 服务器投票。我希望它像在网站上一样显示在那里。数据库是 MySQL。

这是我的代码。这只是一个测试；我只是想把一个链接变成一个变量。

```
<?php
$imageNumber = https://minotar.net/helm/GRANTSWIM4/100.png;
?>
<img src="<?php echo $imageNumber ?>.jpg"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:26:43.243

您提供的代码可以正常工作，假设您修复了语法问题并删除了双扩展名（您在 .png 之后附加了 .jpg）。

```
<?php $imageNumber = 'https://minotar.net/helm/GRANTSWIM4/100.png'; ?>
<img src="<?php echo $imageNumber ?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:31:01.437

如果您询问如何获取 MySQL 表名并引用变量中的值，那么可以。您可以使用方法从结果中检索表名，也可以**[`mysql_tablename`](http://php.net/manual/en/function.mysql-tablename.php)**使用方法获取表的完整列表**[`mysql_list_tables`](http://php.net/manual/en/function.mysql-list-tables.php)**。

但我不建议您在客户端包含您的表名。

# math - 如何获取 2D 点，并通过透视相机将其投影到 3D 矢量中

> ID：14408559
> 
> 赞同：1
> 
> 时间：2013-01-18T22:15:59.043
> 
> 标签：math, 3d, 2d, projection

我有一个 2D 点 (x,y)，我想将它投影到一个向量，这样我就可以执行光线追踪来检查用户是否点击了一个 3D 对象，我已经编写了所有其他代码，除非当我回到了我的功能，从鼠标的 xy 线获取矢量，我没有考虑视野，我不想猜测因素是什么，因为“巫毒”修复不是图书馆的好主意。有数学魔术师想帮忙吗？:-)。

这是我当前的代码，需要应用相机的 FOV：

```
sf::Vector3<float> Camera::Get3DVector(int Posx, int Posy, sf::Vector2<int> ScreenSize){
    //not using a "wide lens", and will maintain the aspect ratio of the viewport
    int window_x = Posx - ScreenSize.x/2;
    int window_y = (ScreenSize.y - Posy) - ScreenSize.y/2;
    float Ray_x = float(window_x)/float(ScreenSize.x/2);
    float Ray_y = float(window_y)/float(ScreenSize.y/2);

    sf::Vector3<float> Vector(Ray_x,Ray_y, -_zNear);
    // to global cords
    return MultiplyByMatrix((Vector/LengthOfVector(Vector)), _XMatrix, _YMatrix, _ZMatrix);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:29:54.487

你不是太放屁，一件事是确保你的鼠标在 -1 到 1 空间（不是 0 到 1）然后你创建 2 个向量：

```
Vector3 orig = Vector3(mouse.X,mouse.Y,0.0f);
Vector3 far = Vector3(mouse.X,mouse.Y,1.0f); 
```

您还需要使用透视变换的倒数（或者如果您想要世界空间，则使用视图投影）

```
Matrix ivp = Matrix::Invert(Projection) 
```

然后你做：

```
Vector3 rayorigin = Vector3::TransformCoordinate(orig,ivp);
Vector3 rayfar = Vector3::TransformCoordinate(far,ivp); 
```

如果你想要一条射线，你还需要方向，这很简单：

```
Vector3 raydir = Normalize(rayfar-rayorigin); 
```

# maven - 使用分类器在本地安装 maven 项目

> ID：14408569
> 
> 赞同：1
> 
> 时间：2013-01-18T22:16:33.277
> 
> 标签：maven, maven-install-plugin

如果项目的版本`foo`是`1.0-SNAPSHOT`，应该运行命令

```
 mvn install -Dclassifier=bar 
```

安装`foo-1.0-SNAPSHOT-bar.jar`在我的本地`.m2`目录中？我试过这样做，但它会安装`foo-1.0-SNAPSHOT.jar`并且[maven install plugin](http://maven.apache.org/plugins/maven-install-plugin/usage.html)`-Dclassifier`并没有提供关于该选项的太多细节。

有没有办法安装（本地）带有分类器的 jar？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:52:56.463

该`-Dclassifier`参数与目标相关联，该`install:install-file`目标不是默认构建生命周期的安装阶段执行的目标。相反，它用于以临时命令行方式安装辅助工件。换句话说，它用于在正常运行的 maven 构建的上下文之外将内容粘贴到存储库中。

当您使用 调用默认构建生命周期时`mvn install`，他的安装阶段会执行`[install:install][1]`目标。因此，当您执行时`mvn install -Dclassifier=bar`，您执行了默认的构建生命周期，并且该参数没有用于任何事情。

`install:install`正如文档中所述，目标是安装以及`primary artifact`aka`secondary`工件`attached`。您的构建生成的 jar 是主要工件。它没有分类器。所有附加的工件都需要第四个 maven 坐标来从主要工件中唯一地识别它们。这个坐标就是分类器。

除非您附加了工件，否则您不需要分类器。附加的工件来自哪里？除了主要工件之外，它们是您的构建产生的东西。因此，它可能是由程序集插件构建的。它可能是另一个包含项目源文件的 jar，等等。分类器由附加辅助工件的机制确定，例如程序集插件。

# node.js - 需要减少expressjs中路由的超时时间

> ID：14408573
> 
> 赞同：8
> 
> 时间：2013-01-18T22:16:51.963
> 
> 标签：node.js, express, timeout

在 expressjs 中有一种方法可以设置每条路由的超时限制。

我有一些路线可能需要 30-45 秒才能处理（大量任务）

然后是其他路线，如果它需要超过 5 秒，我希望它超时。

我想我问的是有没有办法全局设置请求的超时限制，有没有办法在路由上单独设置。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-20T03:58:59.937

使用内置的连接超时中间件：

[http://www.senchalabs.org/connect/timeout.html](http://www.senchalabs.org/connect/timeout.html)

```
var connectTimeout = require('connect-timeout');

var timeout = connectTimeout({ time: 10000 });
var longTimeout = connectTimeout({ time: 45000 });

app.use(timeout); // you can set a global timeout value
app.get('/some/route', longTimeout, yourHandler); // or you can set per-route timeouts 
```

# tcl - 将秒转换为小时分钟秒格式

> ID：14408580
> 
> 赞同：2
> 
> 时间：2013-01-18T22:17:17.287
> 
> 标签：tcl

我需要以秒为单位将时间转换为`HH:MM:SS.mm`格式。秒输入是从嵌入式设备中读取的`double`，格式为`seconds.millseconds`. 我尝试了以下转换代码，但失败了：

```
set cpu_time [function_that_fetches_the_time]
puts "[clock format $cpu_time -format {%H:%M:%S}]" 
```

这失败并出现错误

```
expected integer but got "98.92" 
```

从抛出

```
"ParseFormatArgs {*}$args"
    (procedure "::tcl::clock::format" line 6) 
```

我可以将双精度转换为整数，上面的方法可以工作，但在输出显示中也有毫秒部分会很好。

另外，毫秒的时钟格式说明符是什么？

**编辑：**

似乎仅将其转换`double`为`int`也不起作用。我试过了

```
puts "[clock format [expr int($cpu_time)] -format {%H:%M:%S}]" 
```

这会导致一些奇怪的时间。例如，当嵌入式设备返回`3.53`（我将其转换为 a `3`）时，打印出来的时间是`17:00:03`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T23:25:18.350

格式化可靠工作的间隔的最简单方法是手动完成所有操作。

```
set cpu_time [function_that_fetches_the_time]
set cpu_ms   [expr { int(fmod($cpu_time, 1.0) * 1000) }]
set cpu_secs [expr { int(floor($cpu_time)) % 60 }]
set cpu_hrs  [expr { int(floor($cpu_time / 3600)) }]
set cpu_mins [expr { int(floor($cpu_time / 60)) % 60 }]
puts [format "%d:%02d:%02d.%3d" $cpu_hrs $cpu_mins $cpu_secs $cpu_ms] 
```

您可能希望将其包含在一个过程中……</p>

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T23:30:45.227

关于您的编辑，它以这种方式显示的原因（17:00:03）是时钟格式期望从纪元开始的整数秒。所以，我猜你离 UTC 有五个时区？它将您的“3”解释为 1970 年 1 月 1 日午夜过后 3 秒，然后调整到您当地的时区。如果您只是将秒数转换为格式（而不是将实际日期/时间转换为格式化字符串），Donal 的答案是最好的。如果将 -gmt 参数添加到已编辑的解决方案中，您将获得预期的 00:00:03（然后您可以将“.53”毫秒字符串附加到结果中以包括毫秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:26:56.047

一毫秒的说明符是一个小 s

尝试 [时钟格式 [时钟秒数] -format "%H:%M:%S:%s"]

[看到这个链接](http://wiki.tcl.tk/948)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-08T05:17:11.853

这是我修改Donal Fellows答案的方法，这对某些人来说可能会更好一些，因为它对我有用。

```
proc time_cmd {cmd} {
    set start [clock milliseconds]
    eval $cmd
    set end [clock milliseconds]
    set runtime [expr $end - $start]
    set seconds [expr $runtime / 1000]
    set cpu_ms [expr $runtime % 1000]    
    set cpu_secs [expr { int(floor($seconds)) % 60 }]
    set cpu_mins [expr { int(floor($seconds / 60)) % 60 }]
    set cpu_hrs  [expr { int(floor($seconds / 3600)) }]
    puts [format "Command completed in %d:%02d:%02d.%-03d" $cpu_hrs $cpu_mins $cpu_secs $cpu_ms]
} 
```

# timer - 随时设置中断标志

> ID：14408588
> 
> 赞同：0
> 
> 时间：2013-01-18T22:18:01.280
> 
> 标签：timer, flags, avr, interruption

我在 AVR AT90S2313 中设置中断标志时遇到问题。通常中断是通过硬件计数器设置的。我想在需要时（在特定时刻）以编程方式设置此标志。我正在用 C 编写所有代码：

```
SEI();                  //enable globall interupt
TIMSK | = (1<<TOIE1);    //enable interrupt from timer 1
TIFR | = (1<<TOV1);      //enable interruption (setting bit) - IT DOESN"T WORKS! 
```

所以，在最后一行应该是编程中断，但什么也没发生，我不知道为什么。任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T06:00:18.630

TIFR 寄存器的特殊之处在于将 1 写入某个位会将其设置为 0。

编辑以回应评论：

据我所知，您提供的信息很少，您不应该对寄存器做任何事情。也就是说，不要尝试使用中断机制来运行处理程序。在代码中要触发中断的地方，只需自己调用处理程序即可。您可能还想同时调整启用位或清除标志——我不知道您要做什么。

如果您希望处理程序像响应中断一样运行，那么您需要首先禁用中断。通常的方法是

```
void function_to_trigger_handler()
{
     uint8_t sreg = SREG;
     cli();

     my_interrupt_handler();

     SREG = sreg;
} 
```

# google-maps - 提供的密钥不是有效的 Google API 密钥 Ext JS 问题

> ID：14408595
> 
> 赞同：0
> 
> 时间：2013-01-18T22:18:25.007
> 
> 标签：google-maps, extjs, google-maps-api-2

我的项目中的 Google Map api 出现了一些问题。我没有处理与这部分相关的任何事情，并且在今天之前它工作正常。

![在此处输入图像描述](../Images/a102eac48472534867ea5dddb21dc6dd.png)

但是现在，如果我运行该应用程序，我会收到此弹出消息，然后使用 google map api 的页面无法处理此错误。 ![在此处输入图像描述](../Images/8f7f00a578626b56b2b4ef56e27f1981.png)

我用谷歌搜索并遵循了这一步。

1) [https://code.google.com/apis/console/b/0/#project:40595208241:access](https://code.google.com/apis/console/b/0/#project:40595208241:access) 2) 生成新密钥 3) 将新密钥复制到 index.htm 里面的密钥值

```
<script src="http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=AIzaSyAJz86xjTce_oqnSTw8MoNaY-13tIx03XU" type="text/javascript">       </script>

<script type="text/javascript" src="extJS-ux/GMapPanel.js"></script>
<link href="extJS-ux/Ext.ux.grid.RowActions.css" rel="stylesheet" type="text/css" />

<script src="http://www.google.com/jsapi?key=AIzaSyAJz86xjTce_oqnSTw8MoNaY-13tIx03XU" type="text/javascript"></script>
<script type="text/javascript">
    google.load('search', '1');
</script> 
```

所以我遵循了同样的步骤，但现在它不再起作用了。它不再显示错误消息，但也不会显示结果。它说没有结果，什么也不做。它昨天工作正常！

我试图做一些其他的方法，但没有一个好的解决方案。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:57:25.023

您正在使用 v=2.x（“实验版”）。不建议将其用于生产站点。如果您调用 v=2 或 v=2.s（“稳定”版本），它可能会开始工作，如果这个是 API 的变化。

请注意，您使用[的 Google Maps API v2](https://developers.google.com/maps/documentation/javascript/v2/reference)已弃用，可能会在 2013 年 5 月 19 日停止工作；绝对不推荐用于生产现场。

# asp.net-mvc - 使用 mvc 框架进行表单身份验证

> ID：14408597
> 
> 赞同：0
> 
> 时间：2013-01-18T22:18:32.757
> 
> 标签：asp.net-mvc, form-authentication

我正在尝试使用 mvc 框架进行表单身份验证，但是如果我登录并复制 url 并从页面注销并在其他浏览器或选项卡中打开它应该转到登录页面但它重定向到需要首先进行身份验证的页面意味着直接进入在没有身份验证的登录页面内。任何帮助都将得到重视。

这是我的网络配置设置：

```
 <!--Using forms authentication-->
        <location path="Content">
            <system.web>
                <authorization>
                    <allow users="*" />
                </authorization>
            </system.web>
        </location>

        <!-- allow any user to see the login controller -->
        <location path="~/Developer/Index">
            <system.web>
                <authorization>
                    <allow users="*" />
                </authorization>
            </system.web>
        </location>

               <authentication mode="Forms">
                <forms name=".ASPXFORMSAUTH" loginUrl="~/Developer/Index" timeout="2880" />
            </authentication>

And in my controller login Action method i used 

     [HttpPost]
        public ActionResult LoginAPI(LoginAPIFormModel loginapp)
        {
            if (!ModelState.IsValidField("username") || !ModelState.IsValidField("pwd"))
            {
                if (!ModelState.IsValidField("username"))
                {
                    ModelState.AddModelError("username", "Invalid Email");
                }
                else
                {
                    ModelState.AddModelError("Incomplete", "Please fill out each field");
                }

                return View(loginapp);
            }

            try
            {

                var context = new ndCorp_SiteEntities();
                var Hashpwd = CreateHash(loginapp.pwd);
                var res = context.DevUserInfoes.Where(i => i.UserName == loginapp.username && i.USerPwd == Hashpwd).FirstOrDefault() ;
 TempData["mode"] = "LoginAPI";

                FormsAuthentication.SetAuthCookie(loginapp.username, false);
                return RedirectToAction("SuccessView");
 }

            catch (Exception ex)
            {
                Console.Write(ex);
                return View(loginapp);
            }

        } 
```

这是登录后实际重定向到用户页面的javascript代码：

```
 if (@Html.Raw(Json.Encode(TempData["mode"])) == "LoginAPI")
       {
            parent.closeFancybox(); 
            //setTimeout(parent.closeFancybox(), 1000) 
            //window.top.closeFancybox();
             var url = '@Html.Raw(Url.Action("ManageApps", "Developer", new { username =@Html.Raw(Json.Encode(TempData["uname"]))} ))';
             url =  url.replace(/%22/g,'');
            parent.location.href = url;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T16:21:37.443

尝试将 [Authorize] 属性放置到您的控制器或视图中。

# java - 如果您将扫描仪作为参数传递，它的状态也会被传递吗？

> ID：14408602
> 
> 赞同：1
> 
> 时间：2013-01-18T22:18:58.440
> 
> 标签：java, java.util.scanner

我有一个从文本文件中读取的扫描仪。当它到达文件中的某一行时，我希望能够调用一个使用 Scanner 作为当前状态参数的方法 - 例如，我希望将扫描仪（连同使用的文件一起）传递给到底在哪一行。

```
public static void createEntry(File list, int mediaTypeNum, String mediaType) throws FileNotFoundException {
    Scanner mediaReader = new Scanner(list);
    int occurrence = mediaTypeNum;
    int scannerCounter = 0;
    String match;
    String title = "";
    String director = "";
    while (mediaReader.hasNext() && scannerCounter < occurrence) {
        match = mediaReader.nextLine();
        if (match.equalsIgnoreCase(mediaType)) {
            scannerCounter++;
            if (scannerCounter == occurrence) {
                // based on type, create the media object
                // createMediaObject(list, mediaReader, mediaType)
                title = mediaReader.nextLine();
                director = mediaReader.nextLine();
            }
        }
    } 
```

createMediaObject() 将有一个 switch case，并且根据 case，Scanner 将读取以下几行，直到出现空行。对于每种媒体类型，行数不同。

先感谢您！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:20:14.063

当然，它实际上适用于 Java 中的任何对象。在任何时候都不会创建对象的隐式副本。*

你需要注意的是它`Scanner`有一个“顺序”状态，如果你经常传递它，很容易忘记它处于什么状态。特别是如果执行条件处理，不同的执行路径最终可能会将其留在不同的位置。

解决此问题的一个好方法是始终在方法 Javadoc`Scanner`中记录预期处于什么状态以及最后剩下的状态。

*该声明有一个很大的警告：多线程。但是在这里详细讨论这个话题是非常偏离主题的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:20:24.243

当然。您将引用传递给 Scanner 对象，以便接收者看到相同的实例和相同的状态。

# java - “org.eclipse.equinox.ds@3:start”背后的魔力？

> ID：14408605
> 
> 赞同：0
> 
> 时间：2013-01-18T22:19:22.133
> 
> 标签：java, eclipse, eclipse-plugin, rcp

我有一个带有以下命令行参数的独立无头 RCP。

```
Command-line arguments:  -os macosx -ws cocoa -arch x86_64 -clean -consoleLog 
```

我可以成功生成要作为命令行工具运行的二进制文件，但问题是我必须修改 config.ini 文件

```
osgi.bundles=org.eclipse.equinox.common@2:start,
org.eclipse.update.configurator@3:start,
org.eclipse.equinox.ds@2:start,
org.eclipse.core.runtime@s 
```

到

```
osgi.bundles=org.eclipse.equinox.common@2:start,
org.eclipse.update.configurator@3:start,
org.eclipse.equinox.ds@3:start, <---
org.eclipse.core.runtime@s 
```

如果没有此更改，我在执行二进制文件时会收到这些错误消息。

```
org.osgi.framework.BundleException: The bundle "org.eclipse.equinox.ds_1.4.0.v20120522-1841 [3]" could not be resolved. Reason: Missing Constraint: Import-Package: org.eclipse.equinox.internal.util.event; version="1.0.0"
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.getResolverError(AbstractBundle.java:1332)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.getResolutionFailureException(AbstractBundle.java:1316)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:323) 
```

“org.eclipse.equinox.ds@3:start”背后的魔力？为什么我更改后效果很好？如何在 Eclipse IDE 中进行设置，以便在创建无头 RCP 时不必一直手动更改 ini 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:40:07.430

我可以解释更改背后的魔力，但遗憾的是我不熟悉从 Eclipse 导出应用程序。

[`osgi.bundles`](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html#osgibundles)是一个属性，它定义了哪些包可用以及它们应该在何时（例如在什么[开始级别）开始。](http://www.osgi.org/javadoc/r4v43/core/org/osgi/service/startlevel/StartLevel.html)平台在 1 级加载并启动这些捆绑包，然后是 2 级，依此类推，直到`osgi.startLevel`（默认为 6，在上面链接的 juno 文档中描述）。

为了启动`org.eclipse.equinox.ds`平台，需要加载一个导出包的 1.0.0 版本的`org.eclipse.equinox.internal.util.event`包。从一些搜索来看，这似乎是[`org.eclipse.equinox.util`](http://git.eclipse.org/c/equinox/rt.equinox.bundles.git/tree/bundles/org.eclipse.equinox.util/META-INF/MANIFEST.MF)捆绑包。

因此，通过从@2 更改为@3，您将 ds 包的启动时间推迟到平台启动的后期，直到加载 util 包后的某个时间点。我怀疑这里有帮助的是`org.eclipse.update.configurator`捆绑包（因为它是一个捆绑包，其工作是[从插件目录加载所有捆绑包](https://stackoverflow.com/a/1801463/504685)。）

# java - 如何打开具有可关闭属性的面板？

> ID：14408608
> 
> 赞同：0
> 
> 时间：2013-01-18T22:19:35.253
> 
> 标签：java, ajax, jsf-2, primefaces

我在下面发布了我的代码。一切正常，而面板 ( `id = "idPanemCriticas"`)的属性`closable = "false"`。

如果我将其更改为，`true`则它不会显示更多消息，如果我关闭面板，我将无法打开更多消息。我真的需要帮助，谢谢。

```
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>JSF 2 + PrimeFaces</title>
</h:head>
<h:body>
<h:form>
<p:panel id="idPanelCad" header="Cadastro de Usuário" style="width: 60%;">
<h:panelGrid columns="6">
<h:outputText value="Nome:" />
<p:inputText id="nome" value="#{loginMb.usuario.nome}" required="true" size="20"
requiredMessage="Informação do nome é obrigatório.">
<h:outputText value="*" />
</p:inputText>

<h:outputText value="Sobrnome:" />
<p:inputText id="idSobreNome" value="#{loginMb.usuario.sobreNome}"
required="true" size="20" requiredMessage="Informação do sobrenome é obrigatório.">
</p:inputText>
<h:outputText value="*" />
</h:panelGrid>

<h:panelGrid columns="3">
<h:outputText value="Senha:" />
<p:password id="idSenha" value="#{loginMb.usuario.senha}" feedback="true"
required="true" requiredMessage="Informação da senha é obrigatória.">
</p:password>
<h:outputText value="*" />
</h:panelGrid>

<h:panelGrid>
<p:commandButton value="Gravar" action="#{loginMb.gravar}" update="toUpdate "     
onclick="wp.show();"  process="toUpdate"/>
</h:panelGrid>

<h:panelGrid>
<h:outputText value="(*) - Campos com informação obrigatórias." />
</h:panelGrid>

<p:separator> </p:separator>

<p:outputPanel id="toUpdate">
<p:panel id="idPanemCriticas" widgetVar="wp" closable="false" header="Críticas"  
rendered="true">
<p:messages id="mss" closable="true" />
</p:panel>
</p:outputPanel>

</p:panel>
</h:form>
</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T12:07:06.733

您是否尝试`autoUpdate="true"`在您的 中使用属性`p:outputPanel`？的目标`p:outputPanel`是让您[不要在元素树中包含元素](http://www.primefaces.org/showcase/ui/outputPanel.jsf)。在您的情况下，您的嵌入式`p:panel`并且`p:messages`总是会被渲染，所以我看不出使用`p:outputPanel`来实现这一点的意义。

# inno-setup - Inno 设置 4 图像 JPG

> ID：14408612
> 
> 赞同：0
> 
> 时间：2013-01-18T22:20:10.447
> 
> 标签：inno-setup

我加载了 4 张图片 .jpg（带有 botva2.dll）以在我的安装程序上使用类似的背景，但是，这些图片只是一个接一个地留在欢迎页面（ID wpWelcome）中。如何在您的各自页面中将每个图像设置为背景？

这是我的想法：

图片 1.jpg 像欢迎页面上的 bagkground (wpWelcome)

图像 2.jpg 类似于 Readypage (wpReady) 上的背景

图像 3.jpg 类似于 Installpage 上的背景 (wpInstalling)

图像 4.jpg 类似于 Finishedpage 上的背景 (wpFinished)

# java - 以编程方式重构参数名称

> ID：14408614
> 
> 赞同：5
> 
> 时间：2013-01-18T22:20:12.447
> 
> 标签：java, eclipse, parameters, refactoring

使用 eclipse 的 jdt 重构框架，我试图将两个不同的代码库转换为相同的名称。它们几乎是相同的代码库，只是名称不同。函数/字段/类重命名工作正常，但是当涉及到参数时，它对我大喊工作台尚未创建。然而，我正试图在无头庄园中做到这一点。

```
private void refactor(String task, IJavaElement element, String new_name) throws CoreException
{
    RefactoringStatus status = new RefactoringStatus();

    RefactoringContribution contrib = RefactoringCore.getRefactoringContribution(task);
    RenameJavaElementDescriptor rnDesc = (RenameJavaElementDescriptor)contrib.createDescriptor();
    rnDesc.setFlags(JavaRefactoringDescriptor.JAR_MIGRATION | JavaRefactoringDescriptor.JAR_REFACTORING);
    rnDesc.setProject(element.getJavaProject().getProject().getName());
    rnDesc.setUpdateReferences(true);
    rnDesc.setJavaElement(element);
    rnDesc.setNewName(new_name);

    Refactoring ref = rnDesc.createRefactoring(status);

    ref.checkInitialConditions(NULL_MON);
    ref.checkFinalConditions(NULL_MON);

    Change change = ref.createChange(NULL_MON);
    change.perform(NULL_MON);
} 
```

这工作正常：

```
for (IMethod method : type.getMethods())
{
    refactor(IJavaRefactorings.RENAME_METHOD, method, {new name});
} 
```

这不会：

```
for (IMethod method : type.getMethods())
{
    for (ILocalVariable param : method.getParameters())
    {
        refactor(IJavaRefactorings.RENAME_LOCAL_VARIABLE, param, {new name});
    }
} 
```

错误，正如我所说的，我需要在无头庄园中这样做{所以不能制作工作台}

```
java.lang.IllegalStateException: Workbench has not been created yet.
    at org.eclipse.ui.PlatformUI.getWorkbench(PlatformUI.java:92)
    at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider.install(ASTProvider.java:245)
    at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider.<init>(ASTProvider.java:236)
    at org.eclipse.jdt.internal.ui.JavaPlugin.getASTProvider(JavaPlugin.java:710)
    at org.eclipse.jdt.ui.SharedASTProvider.getAST(SharedASTProvider.java:128)
    at org.eclipse.jdt.internal.corext.refactoring.util.RefactoringASTParser.parseWithASTProvider(RefactoringASTParser.java:119)
    at org.eclipse.jdt.internal.corext.refactoring.rename.RenameLocalVariableProcessor.initAST(RenameLocalVariableProcessor.java:231)
    at org.eclipse.jdt.internal.corext.refactoring.rename.RenameLocalVariableProcessor.checkInitialConditions(RenameLocalVariableProcessor.java:218)
    at org.eclipse.ltk.core.refactoring.participants.ProcessorBasedRefactoring.checkInitialConditions(ProcessorBasedRefactoring.java:203) 
```

**更新：**取得了一些进展，现在我可以重构不是覆盖的函数。但是任何覆盖另一个或接口的函数都会搞砸：

```
F_ARGUMENTS = JavaRefactoringDescriptor.class.getDeclaredField("fArguments");
F_ARGUMENTS.setAccessible(true);

private void refactor(IMethod method, String[] names) throws CoreException
{
    /* My attempt to fix the interface issues, causes duplicate functions instead of renaming the parameters
    IMethod parent = null;
    if (method.getDeclaringType().isInterface())
    {
        parent = MethodChecks.overridesAnotherMethod(method, method.getDeclaringType().newSupertypeHierarchy(NULL_MON));
    }
    else if (MethodChecks.isVirtual(method))
    {
        ITypeHierarchy hierarchy = method.getDeclaringType().newTypeHierarchy(NULL_MON);
        parent = MethodChecks.isDeclaredInInterface(method, hierarchy, NULL_MON);
        if (parent == null)
        {
            parent = MethodChecks.overridesAnotherMethod(method, hierarchy);
        }
    }

    parent = (parent == null ? method : parent);
    if (!method.equals(parent))
    {
        refactor(parent, names);
        return;
    }*/

    String task = IJavaRefactorings.CHANGE_METHOD_SIGNATURE;
    RefactoringStatus status = new RefactoringStatus();

    ChangeMethodSignatureRefactoringContribution contrib = (ChangeMethodSignatureRefactoringContribution)RefactoringCore.getRefactoringContribution(task);
    ChangeMethodSignatureDescriptor desc = (ChangeMethodSignatureDescriptor)contrib.createDescriptor();
    desc.setFlags(JavaRefactoringDescriptor.JAR_MIGRATION |
                  JavaRefactoringDescriptor.JAR_REFACTORING |
                  RefactoringDescriptor.MULTI_CHANGE |
                  RefactoringDescriptor.STRUCTURAL_CHANGE);

    Map<String, String> args = null;
    try
    {
        args = (Map<String, String>)F_ARGUMENTS.get(desc);
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }

    String project = method.getJavaProject().getProject().getName();

    desc.setProject(method.getJavaProject().getProject().getName());

    args.put("input", JavaRefactoringDescriptorUtil.elementToHandle(project, method));
    args.put("name", method.getElementName());
    args.put("deprecate", "false");
    args.put("delegate", "true");        

    boolean changed = false;
    int x = 0;
    for (ILocalVariable param : method.getParameters())
    {
        if (!param.getElementName().equals(names[x]))
        {
            changed = true;
        }
        String type = "String"; //Doesn't seem to actually matter as long as they are both the same
        String info = type + " " + param.getElementName() + " " + x + " " + 
                      type + " " + names[x] + " false";
        args.put("parameter" + (x + 1), info);
        x++;
    }
    if (changed)
    {
        refactor(desc.createRefactoring(status));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-19T10:22:44.787

这就是我想出的：

```
ChangeSignatureProcessor changeSignatureProcessor = new ChangeSignatureProcessor((IMethod) node.resolveBinding().getJavaElement());

ParameterInfo info=new ParameterInfo("FormContext", "formContext", ParameterInfo.INDEX_FOR_ADDED);
info.setDefaultValue("formContext");
changeSignatureProcessor.getParameterInfos().add(0,info);

RefactoringStatus status = new RefactoringStatus();
CheckConditionsContext context= new CheckConditionsContext();
context.add(new ValidateEditChecker(null));
context.add(new ResourceChangeChecker());

changeSignatureProcessor.checkInitialConditions(monitor);
changeSignatureProcessor.checkFinalConditions(monitor,context);

changeSignatureProcessor.createChange(monitor).perform(monitor); 
```

# magento - 可配置的虚拟产品 magento

> ID：14408624
> 
> 赞同：2
> 
> 时间：2013-01-18T22:20:46.170
> 
> 标签：magento, magento-1.7

我想在我的商店里有一个可配置的产品，其中“关联产品”是虚拟的。我之前用简单的产品设置了我的可配置产品，但它是一个面向“订阅”的产品，我需要虚拟产品功能。

我之前设置的方式是先创建可配置产品，然后从可配置产品创建屏幕添加简单产品，但没有虚拟产品选项。经过大量搜索后，我没有看到任何其他添加“关联”产品的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T18:10:46.540

通过首先使用我想用于可配置产品的属性集创建三个虚拟产品来解决此问题。然后，我能够创建一个可配置的产品，并在单击“重置过滤器”后在“关联产品”部分的底部找到虚拟产品。然后虚拟产品出现在超级产品属性部分，我能够设置可配置产品。

# javascript - Javascript Alertify 并从确认返回

> ID：14408627
> 
> 赞同：10
> 
> 时间：2013-01-18T22:21:21.003
> 
> 标签：javascript, jquery, dom, alertify

我正在尝试将`alertify.js`其用作所有确认脚本的确认对话框。但它不像普通的 JS`confirm`那样工作。在下面的代码中，我从来没有得到`return true`

```
function aConf ( mes ) {
    alertify.confirm( mes, function (e) {
        return e;
    });
}

<a href="#" onclick="if(aConf(\'Are you sure you wish to remove this?\')) { function(); } return false;">Delete</a> 
```

当然，如果我`aConf`用 JS'替换`confirm`它就可以了。那么为什么`alertify`不把结果寄回给我呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-18T22:28:58.310

因为confirm是一个阻塞函数（在它返回true/false之前不会运行javascript），而alertify是非阻塞的（JS一直在执行）。Alertify 不会立即返回 true/false，而是可能立即返回 undefined，然后在用户单击 OK 或 Cancel 之后调用回调函数。该回调函数的返回值在您的示例中无效，因为 onclick 代码已经完成运行（因为它是非阻塞的）。

假设你正在使用这个：[https ://github.com/fabien-d/alertify.js/](https://github.com/fabien-d/alertify.js/)

这是它实际使用回调函数的方式，而不是返回值：

```
alertify.confirm( message, function (e) {
    if (e) {
        //after clicking OK
    } else {
        //after clicking Cancel
    }
}); 
```

对于您的代码示例，您可以尝试以下操作：

```
function performDelete ( a_element ) {
    // perform your delete here
    // a_element is the <a> tag that was clicked
}

function confirmAction ( a_element, message, action ) {
    alertify.confirm(message, function(e) {
        if (e) {
            // a_element is the <a> tag that was clicked
            if (action) {
                action(a_element);
            }
        }
    });
}

<a href="#" onclick="confirmAction(this, 'Are you sure you wish to remove this?', performDelete); return false;">Delete</a> 
```

编辑：更新为通用确认对话框，如果用户单击确定，则调用回调函数。

# android - 为什么 NoActionbar Theme 会影响 ScrollView 和整体布局？

> ID：14408630
> 
> 赞同：2
> 
> 时间：2013-01-18T22:21:33.343
> 
> 标签：android, layout, themes, android-actionbar, scrollview

所以我在 Android 中有一个布局，它是一个包含 ScrollView、LinearLayout、LinearLayout 的垂直 LinearLayout。

我让每个孩子大约占据屏幕的三分之一。当我拥有带有 ActionBar 的**Holo**或**Holo.Light**时，看起来与预期的一样：

![图像1](../Images/561895269cb2ec3f65e2ef24e8f734cf.png)

但是，当我将 Theme 更改为 Holo.NoActionBar 或 Holo.Light.NoActionBar 时，出于某种原因，它完全忽略了我的 android:layout_weight，甚至我的 ScrollView。就像我滚动视图中的所有内容都不再折叠一样。然后看起来像这样：

![图2](../Images/5c083d26920f6981608174d4dc6e78e5.png)

为什么会这样？我不知道为什么。我什至在我的 styles.xml 中制作了一个自定义主题，但问题仍然存在。**为什么 ScrollView 只有在我有 ActionBar 时才有效？**

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingTop="10dp"
    android:weightSum="100"
     >

    <ScrollView 
        android:layout_height="0dp"
        android:layout_width="fill_parent"
        android:layout_weight="30">

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >
            <TextView
                android:id="@+id/tvEmail"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/email" />

            <EditText
                android:id="@+id/etEmail"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="textNoSuggestions" />

                       .......................

        </LinearLayout>
    </ScrollView>
    <LinearLayout
        android:layout_height="0dp"
        android:layout_width="fill_parent" 
        android:orientation="vertical"
        android:layout_weight="40">
        <Button
            android:id="@+id/bSendEmail"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="@string/sendEmail" />

    </LinearLayout>

    <LinearLayout
        android:layout_height="0dp"
        android:layout_width="fill_parent" 
        android:orientation="vertical"
        android:layout_weight="30">

        <AnalogClock
            android:id="@+id/analogClock1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />

    </LinearLayout>

</LinearLayout> 
```

# java - 如何修复 EditText？

> ID：14408632
> 
> 赞同：0
> 
> 时间：2013-01-18T22:21:47.393
> 
> 标签：java, android, android-edittext

> **可能重复：**
> [显示软键盘时背景布局移动 - android](https://stackoverflow.com/questions/3783318/background-layout-moving-when-soft-keyboard-displayed-android)

我有一个包含多个视图和 EditText 的布局文件：

```
<RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="match_parent" xmlns:android="http://schemas.android.com/apk/res/android">
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/connect"
            android:id="@+id/btnConnect" android:layout_alignParentRight="true" android:layout_alignParentTop="true"/>
    <Spinner
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/spServers"
            android:layout_toLeftOf="@+id/btnConnect" android:layout_alignTop="@+id/btnConnect"
            android:layout_alignBottom="@+id/btnConnect" android:layout_alignParentLeft="true"/>
    <ToggleButton
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/btnType" android:layout_alignLeft="@+id/btnConnect"
            android:layout_below="@+id/btnConnect" android:layout_alignRight="@+id/btnConnect" android:textOff="@string/text"
            android:textOn="@string/grid" />
    <Spinner
            android:layout_width="98dp"
            android:layout_height="22dp"
            android:id="@+id/spDataBases" android:layout_toLeftOf="@+id/btnConnect"
            android:layout_below="@+id/btnConnect"
            android:layout_alignBottom="@+id/btnType" android:layout_alignLeft="@+id/spServers"/>
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/check"
            android:id="@+id/btnCheck" android:layout_alignLeft="@+id/spServers" android:layout_alignParentBottom="true"/>
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/run"
            android:id="@+id/btnRun" android:layout_toRightOf="@+id/btnCheck" android:layout_alignTop="@+id/btnCheck"
            android:layout_toLeftOf="@+id/btnLoad"/>
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/load"
            android:id="@+id/btnLoad" android:layout_alignRight="@+id/btnConnect"
            android:layout_alignTop="@+id/btnCheck"/>
    <EditText
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/txtSQL" android:layout_alignLeft="@+id/spServers" android:layout_below="@+id/btnType"
            android:layout_alignRight="@+id/btnConnect" android:layout_above="@+id/btnCheck"
            android:gravity="left|top" android:singleLine="false" android:textAlignment="gravity"/>
</RelativeLayout> 
```

它看起来像这样：

![在此处输入图像描述](../Images/9e2f7aacb614721600356ae984c5f532.png)

但是当我试图输入一些东西时，我遇到了这个问题：

![我正在尝试输入一些东西](../Images/9ef2b73f409c1c40360269fb6f1fb275.png)

请帮我解决这个问题。当我输入一些文本时，我不想更改布局上的屏幕位置。当用户尝试输入内容时，它会向上移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:25:01.250

您可以尝试告诉 Android 在键盘启动时不要调整布局大小，以确保您输入的内容可见。（文档：http: [//developer.android.com/guide/topics/manifest/activity-element.html#wsoft](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)）

将以下内容添加到您的应用程序清单中：（在相关活动中，而不是下面的虚拟活动中）

```
<activity android:name="Activity"
  ..
  android:windowSoftInputMode="adjustPan"
  ..
</activity> 
```

我不清楚您的问题是在您单击 EditText 并且键盘出现时发生，还是仅在您开始输入时才发生？如果是后者，我的回答可能无济于事。我也不确定“adjustPan”是否是可取的行为，但值得一试！将整个 RelativeLayout 放在 ScrollView 中也是一个好主意。

# python - 在 pandas/python 中加速 newton-raphson

> ID：14408634
> 
> 赞同：3
> 
> 时间：2013-01-18T22:22:10.650
> 
> 标签：python, pandas, newtons-method

我目前正在迭代一个非常大的数据集~85GB（~600M 行），并简单地使用 newton-raphson 来计算一个新参数。截至目前，我的代码非常慢，关于如何加快速度的任何提示？BSCallClass 和 BSPutClass 中的方法是封闭形式的，因此没有什么可以真正加快速度。谢谢。

```
class NewtonRaphson:

    def __init__(self, theObject):
        self.theObject = theObject

    def solve(self, Target, Start, Tolerance, maxiter=500):
        y = self.theObject.Price(Start)
        x = Start
        i = 0
        while (abs(y - Target) > Tolerance):
            i += 1
            d = self.theObject.Vega(x)
            x += (Target - y) / d
            y = self.theObject.Price(x)
            if i > maxiter:
                x = nan
                break
        return x

    def main():
        for row in a.iterrows():
            print row[1]["X.1"]
            T = (row[1]["X.7"] - row[1]["X.8"]).days
            Spot = row[1]["X.2"]
            Strike = row[1]["X.9"]
            MktPrice = abs(row[1]["X.10"]-row[1]["X.11"])/2
            CPflag = row[1]["X.6"]

            if CPflag == 'call':
                option = BSCallClass(0, 0, T, Spot, Strike)
            elif CPflag == 'put':
                option = BSPutClass(0, 0, T, Spot, Strike)

            a["X.15"][row[0]] = NewtonRaphson(option).solve(MktPrice, .05, .0001) 
```

编辑：

对于那些好奇的人，我最终通过使用 scipy 建议以及使用多处理模块显着加快了整个过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:29:12.150

不要在 Python 中编写自己的 Newton-Raphson 方法。[使用 scipy.optimize 中的根查找器之一，](http://docs.scipy.org/doc/scipy/reference/optimize.html#root-finding)例如[brentq](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq)或[newton](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.newton.html#scipy.optimize.newton)，您将获得更好的性能。（大概，如果你有`pandas`，你也会安装`scipy`。）

* * *

信封背面计算：

对 brentq 进行 600M 调用应该可以在标准硬件上进行管理：

```
import scipy.optimize as optimize
def f(x):
    return x**2 - 2

In [28]: %timeit optimize.brentq(f, 0, 10)
100000 loops, best of 3: 4.86 us per loop 
```

所以如果每次调用`optimize.brentq`需要 4.86 微秒，600M 调用将需要大约 4.86 * 600 ~ 3000 秒 ~ 1 小时。

* * *

`newton`可能会更慢，但仍然可以管理：

```
def f(x):
    return x**2 - 2
def fprime(x):
    return 2*x

In [40]: %timeit optimize.newton(f, 10, fprime)
100000 loops, best of 3: 8.22 us per loop 
```

# sql-server - 如何使用 SSIS 包检索文件名并将其存储在数据库中？

> ID：14408636
> 
> 赞同：1
> 
> 时间：2013-01-18T22:22:20.640
> 
> 标签：sql-server, ssis

我正在对五十个或更多 Excel 文件进行 Excel 循环。循环遍历每个 Excel 文件，获取所有数据并将其输入数据库而不会出错。这是将延迟验证设置为 true 的典型过程，并确保 Excel 连接的表达式是一个名为的字符串变量，该变量`EFile`设置为空（在循环中）。

什么不工作：试图将 Excel 文件的名称输入数据库。

什么已经尝试过（编辑；所以将我的 2 更改为 1 - 不知道为什么）：

1.  在 Excel 文件和数据库输入之间添加一个派生列，并使用 EFile 表达式添加一个列（因此在派生列中的表达式下，它将是 @[User::EFile]）。并添加空的。但是，这没有输入任何空白（什么都没有）。

2.  一个建议是添加另一个字符串变量并将其属性 EvaluateAsExpression 设置为 True 并将表达式设置为 EFile 变量 (@[User::EFile])。有趣的是，它做了同样的事情——在数据库中输入一个空白。

博客上的许多人声称他们可以做到这一点，但我还没有看到有人真正解决这个问题（我有一个博客，当我得到答案时，我肯定会向人们展示如何做到这一点，因为到目前为止，其他人已经倒下短的）。如何在循环期间获取 Excel 文件的名称并将其输入数据库？

已添加：忘记添加，没有脚本；声称它可以在没有它们的情况下完成，所以我想看到没有它们的解决方案。

**注意**：我已经能够从 Excel 文件中导入数据——这很容易（请参阅我的 GitHub 帐户，因为我有两个不同的项目用于导入各种 txt、csv、xls、xlsx 数据）。我也在尝试将*要导入的文件的实际名称也*导入数据库。因此，如果有 50 个 Excel 文件，以及每个文件中的数据，则数据库将在该数据旁边有 50 个文件名（因此，如果每个文件有 1000 行数据，则每 1000 行也会有文件名它们来自旁边作为附加列）。这一点似乎引起了很多混乱，因为人们认为我在文件中导入数据时遇到了问题——不，请参阅我的 GitHub；这很容易。文件名也需要导入。

测试包：[https ://github.com/tmmtsmith/SSISLoopWithFileName](https://github.com/tmmtsmith/SSISLoopWithFileName)

**解决方案：**@jaimet 指出派生列需要是 @[User::CurrentFile] （请参阅测试包）。当我第一次运行包时，我的数据库中仍然有一个空白值。但是当我们最初建立连接时，我们确实将它指向一个实际的文件（我称之为“欺骗包”），然后将连接上的表达式更改为 @[User::CurrentFile]，它是空白的。使用变量 @[User::CurrentFile] 的派生列显示字符串 0。因此，我删除了派生列，将完整的文件路径和名称放入变量中，然后将变量添加到派生列（其中让它认为字符串有 91 个字符长），然后返回并将变量设置为空（英语老师现在会讨厌 THEN）。当我运行包时，它输入了完整的文件路径。也许，

感谢所有的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T17:56:07.280

问题是由于变量中的空白值，`@[User::FileNameInput]`这导致 SSIS 包假定此变量的值在派生列转换中的长度始终为零。

![原来的](../Images/38ea3f57a32cbe594f3d90c6aab48866.png)

将派生列转换上的表达式从 更改`@[User::FileNameInput]`为**`(DT_STR, 2000, 1252)@[User::FileNameInput]`**。

类型转换派生列以`2000`将列长度设置为该最大值。该值`1252`表示代码页。我假设您使用的是 ANSI 代码页。我**`2000`**从您的表定义中获取了值，因为 FilePath 列有变量**VARCHAR(2000)**。如果列数据类型为**NVARCHAR(2000)**，则表达式为**`(DT_WSTR, 2000)@[User::FileNameInput]`**

![新表达](../Images/e9a279844bf00c7d33e132ef1f10d21c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:37:52.520

对于所有意图和目的，您的方法 #1 应该有效。这正是我将尝试做到的方式。我很困惑为什么它不起作用。你能分享你的包裹吗？

托尼，非常感谢您的链接。非常感激。

问候杰米

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T17:19:15.857

蒂姆，

您在派生列组件中使用了错误的变量。您将文件名存储在 @[User::CurrentFile] 但您在派生列组件中使用的变量是 @[User::FileNameInput]

更改您的派生列组件以使用 @[User::CurrentFile] ，您会很好。

希望有帮助。

捷通

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T22:38:37.333

如果您使用`ForEach`循环来处理文件夹中的文件，那么我已经使用 SSIS Junkie 的博客中描述的技术将文件名放入 SSIS 变量中：[SSIS：在 Foreach 循环中枚举文件](http://consultingblogs.emc.com/jamiethomson/archive/2005/05/30/1489.aspx)

您可以稍后在流程中使用该变量将其写入数据库。

# javascript - 检票口和传单多面体

> ID：14408640
> 
> 赞同：2
> 
> 时间：2013-01-18T22:22:43.343
> 
> 标签：javascript, jquery, wicket, gis, leaflet

我正在尝试使用 Wicket 插件制作一个多面体对象。我开始使用该插件，但现在我有点飘了。如果我能弄清楚如何使用它，那将对我有很大帮助。

我也是传单的新手，并不真正了解文档中关于多面体的内容。我能够制作正多边形，但不能制作多面体。

以前有人用过这些库吗？

这是我的尝试：

```
map = new L.Map("map");
wkt = new Wkt.Wkt();
val = $("#wktInput").val();
output = wkt.read( val );

var temp = new Array();
for( i=0; i<output[0][0].length; i++ )
    temp[i] = new L.LatLng(output[0][0][i].x, output[0][0][i].y);

L.polygon( temp ).addTo( map ); //This works
L.multiPolygon( temp ).addTo( map ); //This doesn't 
```

所以我想，对于多面体，我需要另一个包含 temp 的数组，所以我也尝试了，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:49:58.313

我不确定它究竟是如何工作的，但我找到了一个与您所谈论的内容相关的有用库。“Leaflet-paste”是 GitHub 上的一个开源项目，允许您使用 Wicket 库将 WKT 粘贴到 Leaflet-JS 地图中。

这是存储库的链接：[https ://github.com/tnightingale/Leaflet.paste](https://github.com/tnightingale/Leaflet.paste)

可以在这里找到演示：http: [//tnightingale.github.com/Leaflet.paste/demo.html](http://tnightingale.github.com/Leaflet.paste/demo.html)

# c++ - 计算 C++ 文件中的类

> ID：14408643
> 
> 赞同：0
> 
> 时间：2013-01-18T22:23:06.047
> 
> 标签：c++

我想知道是否有软件或某种方法可以计算 C++ 编写程序中使用的类的数量。

我正在做一个项目，该项目要求我在开源程序中进行调查并计算类的数量。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:35:43.590

如果你使用 Xcode，你可以用 Cmd-2 打开符号导航器，它会显示你项目中类、函数和其他元素的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:42:28.047

以下 Python 脚本将给出指示。在源代码树的根目录中运行它，它将为您提供源代码树中定义的类的数量。

```
import os
import re

def main():
    classes = set()

    for root, folders, files in os.walk("."):
        for file in files:
            name, ext = os.path.splitext(file)

            if ext.lower() not in [".h", ".hpp", ".hxx"]:
                continue

            f = open(os.path.join(root, file))
            for l in f:
                m = re.match(r"class ([a-zA-Z0-9]*)[^;]*$", l)
                if not m:
                    continue

                classes.add(m.groups())

            f.close()

    print len(classes)

if __name__ == "__main__":
    main() 
```

# android - 如何为自我卸载提示生成“自我引用”URI？

> ID：14408644
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:23:09.727
> 
> 标签：android, uri, uninstallation

在这里：以 [编程方式安装/卸载 APK（PackageManager vs Intents）](https://stackoverflow.com/questions/6813322/install-uninstall-apks-programmatically-packagemanager-vs-intents)

海报指的是用于卸载 APK 的 apkUri。我如何让 android 应用程序为自己生成一个 Uri？和/或应用程序自己的 APK 的 URI 是什么样的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:26:14.503

采用：

```
Uri packageURI = Uri.parse("package:com.android.myapp");
Intent uninstallIntent = new Intent(Intent.ACTION_DELETE, packageURI);
startActivity(uninstallIntent); 
```

确保替换`com.android.myapp`为您的包名称

# shell - 在生成文件中使用 $RANDOM

> ID：14408648
> 
> 赞同：6
> 
> 时间：2013-01-18T22:23:35.740
> 
> 标签：shell, makefile, terminal

我正在制作一个生成文件来重命名其中包含随机数的文件（我是 shell 脚本的新手）。我不明白为什么，但是当我运行文件时，$rand 被赋予了值“ANDOM”。当我在makefile之外运行它时，它可以工作。

我在 Mac os 终端中运行它，以防它有帮助。

```
all: renamefiles

renamefiles:
    rand=$RANDOM && mv myfile.css $rand-myfile.css && mv myotherfile.css $rand-myotherfile.css 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T00:41:34.147

1.  使用日期/时间戳不是更容易/更好，以便重命名的文件按日期顺序列出吗？

2.  您需要在您希望 shell 看到的每个`$`标志中使用两个标志。`makefile``$`

因此：

```
all: renamefiles

renamefiles:
    rand=$$RANDOM && \
    mv myfile.css      $$rand-myfile.css && \
    mv myotherfile.css $$rand-myotherfile.css 
```

或者，使用日期/时间戳：

```
all: renamefiles

renamefiles:
    time=$$(date +'%Y%m%d-%H%M%S') && \
    mv myfile.css      $$time-myfile.css && \
    mv myotherfile.css $$time-myotherfile.css 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-05T13:56:20.970

要在一个或多个 make 变量中使用随机数，以下对我来说很好：

```
FOO="some string with \"$$rand\" in it"
BAR=" you may use it $$rand times."
foobar:
    rand=$$$$ && \
    echo $(FOO) $(BAR) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:54:55.070

例如，您可能需要用大括号（或圆括号）将多字母宏名称括起来

```
${RANDOM}
$(RANDOM) 
```

[**参考**](http://github.com/git/git/blob/master/Makefile)

# powershell - 避免在 PowerShell 中递归获取特定文件夹

> ID：14408655
> 
> 赞同：3
> 
> 时间：2013-01-18T22:23:53.980
> 
> 标签：powershell, get-childitem

我有一个包含多个项目的 Visual Studio 解决方案。作为清理的一部分，我使用以下脚本清理了 bin 和 obj 文件夹。

```
Get-ChildItem -path source -filter obj -recurse | Remove-Item -recurse
Get-ChildItem -path source -filter bin -recurse | Remove-Item -recurse 
```

这完美地工作。但是，我有一个基于文件的数据文件夹，其中包含大约 600,000 个子文件夹，位于名为 FILE_DATA 的文件夹中。

上面的脚本需要很长时间，因为它遍历了所有这 600,000 个文件夹。

当我递归遍历并删除 bin 和 obj 文件夹时，我需要避免使用 FILE_DATA 文件夹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T14:29:53.170

这是一种更有效的方法，可以满足您的需要——跳过要排除的子树：

```
function GetFiles($path = $pwd, [string[]]$exclude)
{
    foreach ($item in Get-ChildItem $path)
    {
        if ($exclude | Where {$item -like $_}) { continue }

        $item
        if (Test-Path $item.FullName -PathType Container)
        {
            GetFiles $item.FullName $exclude
        }
    }
} 
```

[这段代码改编自 Keith Hill 对这篇文章](https://stackoverflow.com/questions/8024103/how-to-retrieve-a-recursive-directory-and-file-list-from-powershell-excluding-so)的回答；我的贡献是修复了一个错误并进行了少量重构；您将在我对同一个 SO 问题的回答中找到完整的解释。

这个调用应该做你需要的：

```
GetFiles -path source -exclude FILE_DATA 
```

如需更悠闲的阅读，请查看我在 Simple-Talk.com 上的文章，其中讨论了这一点以及更多内容：[实用 PowerShell：修剪文件树和扩展 Cmdlet](https://stackoverflow.com/questions/8024103/how-to-retrieve-a-recursive-directory-and-file-list-from-powershell-excluding-so)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T09:10:10.513

如果 FILE_DATA 文件夹是 $source 的子文件夹（不是更深），请尝试：

```
$source = "C:\Users\Frode\Desktop\test"
Get-Item -Path $source\* -Exclude "FILE_DATA" | ? {$_.PSIsContainer} | % {
    Get-ChildItem -Path $_.FullName -Filter "obj" -Recurse | Remove-Item -Recurse
    Get-ChildItem -Path $_.FullName -Filter "bin" -Recurse | Remove-Item -Recurse
} 
```

# php - 设置验证消息

> ID：14408658
> 
> 赞同：0
> 
> 时间：2013-01-18T22:24:09.453
> 
> 标签：php, codeigniter

我正在尝试为 set_rule 设置验证消息....这可能吗？

我试过这个

```
$this->form_validation->set_rules('payment_amount', 'Payment Amount', 'regex_match[/^\d{0,4}(\.\d{1,2})?$/]');
$this->form_validation->set_message('payment_amount', 'This is a test'); 
```

我的信息没有改变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:30:01.363

您可以通过为规则创建函数来设置自定义验证错误消息。

此代码未经测试。

```
public function payment_amount($str)
{
    if (preg_match('[/^\d{0,4}(\.\d{1,2})?$/]', $str)
    {
        $this->form_validation->set_message('payment_amount', 'The %s field has an error');
        return FALSE;
    }
    else
    {
        return TRUE;
    }
} 
```

我们CI的回调如下：

```
$this->form_validation->set_rules('payment_amount', 'Payment Amount', 'callback_payment_amount') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T00:30:53.253

创建 MY_Form_validation.php 并将您的代码放入其中。

使用文档（[http://ellislab.com/codeigniter/user-guide/general/creating_libraries.html](http://ellislab.com/codeigniter/user-guide/general/creating_libraries.html)）

扩展原生库

如果您需要做的只是向现有库添加一些功能 - 可能添加一两个功能 - 那么用您的版本替换整个库就有点过头了。在这种情况下，最好简单地扩展类。扩展一个类几乎与替换一个类相同，但有几个例外：

类声明必须扩展父类。您的新类名和文件名必须以 MY_ 为前缀（此项是可配置的。见下文。）。例如，要扩展本机 Email 类，您将创建一个名为 application/libraries/MY_Email.php 的文件，并使用以下命令声明您的类：

```
class MY_Email extends CI_Email {

} 
```

注意：如果您需要在类中使用构造函数，请确保扩展父构造函数：

```
class MY_Email extends CI_Email {

  public function __construct()
  {
      parent::__construct();
  }
} 
```

# java - Java - OS X - Unicode 错位字符串

> ID：14408663
> 
> 赞同：0
> 
> 时间：2013-01-18T22:24:55.273
> 
> 标签：java, macos, unicode

我正在使用 OS X 上的 Java 平台处理 Unicode 文本文件。当我使用 TextEdit 或 TextWrangler 打开文件而不是看到“Nattvardsgästerna”时，我看到“Nattvardsg‰sterna”（这是不正确的）。当我使用 Java io 流打开文件时，我看到同样不正确的`String`“Nattvardsg‰sterna”。

当我在 PC 上打开文件时，我看到了正确的字符串。我不知道从哪里开始解决这个问题......这是我的 OS X 设置的问题吗？我应该使用特殊标志打开 Java 流吗？

谢谢。

PS我打开文件是这样的：`fileReader = new BufferedReader(new FileReader(file));`

PSS 另外，我应该提到我想将结果输出为 SQL 文本文件，因此操作系统正确区分**ä**很重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:40:37.050

An`InputStream`读取字节（不是字符），所以当你说：

> 当我使用 java io 流打开文件时

...您的真正意思是*“当我使用 Java 打开文件时`Reader`”*。

编辑：您的评论说您正在这样做：

```
new BufferedReader(new FileReader(file)); 
```

An`InputStreamReader`有一个[构造函数](http://docs.oracle.com/javase/7/docs/api/java/io/InputStreamReader.html#InputStreamReader%28java.io.InputStream,%20java.nio.charset.Charset%29)，允许您设置字符编码。如果您不指定一个，它将使用平台默认值。平台默认值不太可能是 unicode（在我的 Macbook 上，它设置为“US-ASCII”）。

为了设置字符编码，您必须创建中间输入流阅读器，而不是`FileReader`让其为您完成（因为`FileReader`使用平台默认编码）。

假设文件使用 UTF-8 进行编码，请使用：

```
new BufferedReader(new InputStreamReader(new FileInputStream(file), 
                                         Charset.forName("UTF-8"))); 
```

或者，您可以通过向 JVM 提供参数来更改平台默认值。您可以查看[此答案](https://stackoverflow.com/a/623036/1212960)以获取完整的详细信息，但基本思想是您设置`file.encoding`Java 系统属性。链接的答案提供了几种实现此目的的方法。

进一步编辑：

> PSS 另外，我应该提到我想将结果输出为 SQL 文本文件，因此操作系统正确区分 ä 很重要。

操作系统与此无关。文件系统只是四处移动字节。如何解释这些字节完全取决于正在读取这些文件的*应用程序。*这个答案告诉你如何让你的 Java 程序正确解释字节。为了让您的数据库能够正确解释字节，您需要配置数据库编码。

# php - Modx Wayfinder 不同的上下文菜单仅在刷新后显示

> ID：14408664
> 
> 赞同：0
> 
> 时间：2013-01-18T22:25:17.440
> 
> 标签：php, modx, modx-revolution, modx-chunks

我正在尝试使用 Wayfinder 从其他上下文显示主菜单。我有以下电话：

```
[[!Wayfinder@MainMenu? &startId=`0` &contexts=`web` &scheme=`full`]] 
```

问题是第一次访问页面时，没有显示菜单。刷新后就出现了。这不时发生。

我猜这是某种缓存问题，但我不知道为什么它没有在第一次显示。

将 cacheResults 设置为 true 或 false 似乎不会影响问题。

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T04:37:51.510

这个答案可能来晚了，但您应该尝试通过 ftp 或 ssh 手动删除 core > cache 的内容。当我遇到这样的问题时，这通常会奏效。

# ember.js - Ember.js - 从 ember 对象中获取所有绑定

> ID：14408665
> 
> 赞同：2
> 
> 时间：2013-01-18T22:25:18.857
> 
> 标签：ember.js

从对象中获取所有 ember 绑定的更好方法是：

```
 Ember.keys(@).forEach (key) =>
    re = /\b[A-Za-z]*Binding\b/
    if key.match(re)
      prop = key.replace('Binding', "")
      controller.set(prop, @get(prop)) if @get(prop) 
```

这可行，但似乎有问题。

我正在做的是尝试获取 .hbs 文件中定义的所有绑定并将它们设置在另一个对象上。

# html - 如何在移动设备上缩小我的视网膜图像

> ID：14408667
> 
> 赞同：0
> 
> 时间：2013-01-18T22:25:30.247
> 
> 标签：html, css, twitter-bootstrap, retina-display, retina.js

我最近决定在一些网站上添加视网膜显示的图像，但是当我在我的 iPhone5 上查看它们时，它们看起来很大（虽然很清晰，这很好）。我应该如何减小徽标的大小？[你可以在这里](http://wedgetire.com/)查看我的网站

我假设这是我需要在我的wedge.css 文件中编辑的一些代码。谁能指出我正确的方向？另外，不确定是否重要，但我正在使用 Bootstrap。

# ios - UiTextView - 仅添加一行时的位置

> ID：14408668
> 
> 赞同：1
> 
> 时间：2013-01-18T22:25:39.640
> 
> 标签：ios, objective-c, cocoa-touch, cocoa

当添加 2 行或更多`UiTextView`行时，它看起来不错，但是当用户只输入一行时，文本会停留在`UiTextView`. 我怎样才能强迫它留在左上角`UiTextView`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:43:41.080

您可以查看此博客（[iOS：UITextView 中的垂直对齐文本](http://imagineric.ericd.net/2011/03/10/ios-vertical-aligning-text-in-a-uitextview/)），其中解释了如何进行中心和底部垂直对齐。在您的情况下使用类似的逻辑并将 contentOffset y 参数设置为零以使其顶部对齐。

这是来自博客的代码，

```
- (void) viewDidLoad {
   [textField addObserver:self forKeyPath:@"contentSize" options:(NSKeyValueObservingOptionNew) context:NULL];
   [super viewDidLoad];
}

-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
   UITextView *tv = object;
   //Center vertical alignment
   //CGFloat topCorrect = ([tv bounds].size.height - [tv contentSize].height * [tv zoomScale])/2.0;
   //topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
   //tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};

   //Bottom vertical alignment
   CGFloat topCorrect = ([tv bounds].size.height - [tv contentSize].height);
    topCorrect = (topCorrect <0.0 ? 0.0 : topCorrect);
    tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T16:21:35.613

我刚刚找到了一个更简单的解决方案。下一个代码将只移动文本：`[textView setContentInset:UIEdgeInsetsMake(5, 0, 5,0)]`

# mysql - 如何复制 MySQL 函数？

> ID：14408669
> 
> 赞同：4
> 
> 时间：2013-01-18T22:25:44.477
> 
> 标签：mysql, function

我尝试使用 phpMyAdmin 例程面板中的导出选项将函数从一个数据库复制到另一个数据库，但没有成功。

导出选项为我提供了以下内容：

```
CREATE DEFINER=`root`@`localhost` FUNCTION `JSON_FIELD_NUM`(`col_name` TEXT CHARSET utf8, `data` TEXT CHARSET utf8) RETURNS text CHARSET utf8
    NO SQL
BEGIN
   RETURN 
   CONCAT('"',col_name,'":',
       IF(ISNULL(data),0,data)
   );
END 
```

当我在另一个数据库中运行它时出现此错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 7 
```

我尝试`DELIMITER $$`在顶部和`$$`之后添加`END`，但仍然没有喜悦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:42:49.010

您必须将客户端的语句分隔符设置为字符串`;`，以免它认为结束`CONCAT()`表达式的分号也终止`CREATE FUNCTION`语句。

在 MySQL 命令行工具中，您可以使用`DELIMITER` [命令](http://dev.mysql.com/doc/en/mysql-commands.html). 在 phpMyAdmin 中，您需要`Delimiter`在单击之前使用文本框`Go`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:52:18.770

有一种更简洁的方法可以做到这一点：

```
MYSQLDUMP_OPTIONS="${MYSQLDUMP_OPTIONS} --routines"
MYSQLDUMP_OPTIONS="${MYSQLDUMP_OPTIONS} --all-databases"
MYSQLDUMP_OPTIONS="${MYSQLDUMP_OPTIONS} --no-data"
MYSQLDUMP_OPTIONS="${MYSQLDUMP_OPTIONS} --no-create-info"
mysqldump ${MYSQLDUMP_OPTIONS} > StoredProcedures.sql
less StoredProcedures.sql 
```

这将只转储存储过程。

试试看 ！！！

# rally - 刷新拉力图

> ID：14408673
> 
> 赞同：0
> 
> 时间：2013-01-18T22:25:53.320
> 
> 标签：rally

我有一个显示图表的 Rally SDK 2.0p5 应用程序。当用户选择一个选项时，数据将被更新，我想刷新图表。但它不会重新绘制，而是在下方放置一个新图表。什么是正确的语法？

```
 // Configure and Add the chart
                this.add(
                    {
                        xtype: 'rallychart',
                        height: 400,
                        id: 'chart',
                        chartConfig: {
                            chart: {
                            },
                            title: {
                                text: 'My Chart',
                                align: 'center'
                            },
                            xAxis: [
                                {
                                    categories: ['M0','M1','M2','M3','M4','M5'],
                                    title: {
                                        text: 'Interval'
                                    }
                                }
                            ],
                            yAxis: {
                                title: {
                                    text: yText
                                }
                            },
                            series: [ { type: 'column',
                                        name: yText,
                                        data: mCount } ],
                            plotOptions : {
                                column: {
                                    color: '#F00'
                                },
                                series : {
                                    animation : {
                                        duration : 2000,
                                        easing : 'swing'
                                    }
                                }
                            }
                        }
                    }
                ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:25:06.857

在添加新图表之前，您需要删除第一个图表。

```
redrawChart: function() {
    this.remove('#chart');
    this.add({...});
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:16:31.527

通常最好只更新图表。HighCharts 是 App SDK 中包含的图表库。HighCharts 甚至会为您的更改设置动画。凉爽的！！！[在此处](http://api.highcharts.com/highcharts#Chart)查找对图表进行操作的方法列表。您可以添加系列、更改数据、更改轴限制、控制缩放等。

# c# - 基于条件的代码存储库

> ID：14408674
> 
> 赞同：0
> 
> 时间：2013-01-18T22:25:56.270
> 
> 标签：c#, .net

我必须编写一堆小代码片段来执行基于数字代码的字符串连接和转换。代码将成百上千。

显然，我可以构建一个巨大的 switch 语句来执行与该数字代码相关的代码。这似乎很笨拙。似乎我可以创建类似的东西：

```
1001: if (x != null) {
    console.writeline("Not Null");
} else {
    console.writeline("Null");
} 
```

然后，每当我需要运行该代码时，我都可以调用`1001`并执行代码。

不确定这是否有意义，但我以前从未将值映射到一段源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:41:27.563

如果作为一个假设，你所有的“片段”都使用一个整数变量（是的，一个相当大的假设），你可以使用字典来存储它们，如下所示：

```
public class CodeRepo
{
  private Dictionary<int, Func<int, int>> snippets = new Dictionary<int, Func<int, int>>();

  public void RegisterCodeSnippet(int key, Func<int, int> code)
  {
    if (!snippets.ContainsKey(key))
      snippets.Add(key, code);  
  }

  public Func<int, int> GetCodeSnippet(int key)
  {
    if (snippets.ContainsKey(key))
      return snippets[key];
    return null;
  }

  public IEnumerable<int> RunAllSnippets(int parameter)
  {
    foreach (var item in snippets)
      yield return item.Value(parameter);
  }
} 
```

您可以使用该存储库，例如：

```
CodeRepo repo = new CodeRepo();
repo.RegisterCodeSnippet(1, x => x); //identity function;
repo.RegisterCodeSnippet(2, x => x * x);//x squared
repo.RegisterCodeSnippet(3, x => Math.Sign(x));//sign of x
// etc...

var square = repo.GetCodeSnippet(2);
Console.WriteLine(square(7)); //writes 49

//runs all snippets in order, produces 3, 9, 1
foreach (int result in repo.RunAllSnippets(3))
{
  Console.WriteLine(result);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:30:48.280

您可以创建一个`List<Action>`并按顺序分配每个片段，然后您可以使用列表索引调用它们：

```
public List<Action> Actions {get;set;}

public void CreateActions()
{
  Action action0000 = () => {//code snippet here};

  Actions.Add(action0000);

  //.. etc etc etc

} 
```

然后在调用它时：

```
public void CallAction(int code)
{
    Actions[code]();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:38:50.110

一种替代方法是反射（MethodBase.Invoke）。这使您的代码片段可以进行单元测试。我自己没有测试它，但它可能看起来像：

```
class MyClass
{
    public void Fn100() {...}
    public void Fn101() {...}
    public void Fn102() {...}
}

public class Program
{
    public static void Main()
    {
        ExecFnNumber("100");
        ExecFnNumber("105");
    }

    public static void ExecFnNumber(string num)
    {
        // can probably optimize by not instantiating
        // myType, myTypeObject every time.
        Type myType = typeof(MyClass);

        // create an instance
        var myTypeObject = new MyClass();

        // call method without params
        MethodInfo method = myType.GetMethod("Fn" + num);
        method.Invoke(myTypeObject, new object[]{});
    }
} 
```

另请参阅 MSDN - [MethodBase.Invoke](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx)

# php - (count($list) 1 或 2 个项目

> ID：14408679
> 
> 赞同：0
> 
> 时间：2013-01-18T22:26:23.197
> 
> 标签：php, joomla

脚本说明是否有 1 个或 2 个脚本帖子的部分是双倍的。我只想要（如果有 1 或 2 篇文章）它只显示 1 或 2 篇文章

```
<?php
    defined('_JEXEC') or die;
    $count = 0;
    if (count($list)%3!=0) {
        $list = array_merge($list, array_slice($list, 0, 3-count($list)%3));
    }
    if (count($list)%2!=0) {
        $list = array_merge($list, array_slice($list, 0, 2-count($list)%2));
    }
    if (count($list)%1!=0) {
        $list = array_merge($list, array_slice($list, 0, 1-count($list)%1));
    }
?>

<?php JLoader::register('fieldattach', 'components/com_fieldsattach/helpers/fieldattach.php'); ?>

<div id="slides">
    <div class="slides_container">

        <div class='slide'>
            <?php foreach ($list as $item) :
                if (($count>0) and ($count%3==0)): ?>
                    </div>
                    <div class="slide">
                <?php endif; ?>

                <li class="categories">
                    <a href="<?php echo $item->link; ?>">
                        <?php echo fieldattach::getImg($item->id, 6); ?>
                        <h4><?php echo $item->title; ?></h4>
                    </a>
                </li>

            <?php $count++; endforeach; ?>
        </div>
    </div>
</div> 
```

# sql - 根据另一个日期范围更新表格

> ID：14408680
> 
> 赞同：2
> 
> 时间：2013-01-18T22:26:26.487
> 
> 标签：sql, sql-server

我有 2 个如下所示的表格。

表_A

**START_DT END_DT 值**

4/1/1993 4/29/1993 48
4/29/1993 5/12/1993 48
5/13/1993 5/27/1993 44
5/27/1993 8/18/1993 44

表_B

**START_DT END_DT 值**

1993 年 4 月 1 日 1993 年 5 月 12 日 无 1993 年 5 月 13 日 1993 年 8 月
18 日 无

如您所见，表 A 的前 2 行日期范围属于表 B 的第一行日期范围。表 A 的第 3 行和第 4 行日期范围位于表 B 的第 2 行。

根据日期范围，我想采用 A.VALUE 并更新 B.VALUE 以使表 B 显示为：

表_B

**START_DT END_DT 值**

1993 年 4 月 1 日 1993 年 5 月 12 日 48

1993 年 5 月 13 日 1993 年 8 月 18 日 44

我开始尝试通过使用游标来执行此操作，并通过表 A 并尝试查看 A.START_DT 和 A.END_DT 是否在表 B 的范围内，并相应地更新。

基本上，

`DECLARE @StartDate datetime, @EndDate datetime, @Value smallint;` `DECLARE MyCursor cursor for` `select * from TABLE_A`

`OPEN MyCursor` `FETCH NEXT FROM MyCursor INTO @StartDate,@EndDate, @Value` //然后我想做一些事情：

```
//  SELECT START_DT, END_DT
//      FROM TABLE_B
//      WHERE START_DT <= A.@EndDate
//      AND END_DT>= A.@StartDate
//
// 
```

//从这里开始，我对如何最好地更新表 B 中的 VALUE 列感到困惑。

```
UPDATE TABLE B
    SET VALUE = @Value

WHERE B.START_DT,B.END_DT in (
    SELECT start_dt,end_dt
        FROM TABLE_B
        WHERE start_dt <= @EndDate
        AND end_dt >= @StartDate) 
```

上面的语法不正确，但你明白了。有没有人有一种快速而肮脏的方法来做/解决这个问题？我正在思考如何编写 sql 以根据日期范围选择我想要使用的行，然后更新单个 VALUE 列。

当然有一种更简单的方法可以在不涉及游标的情况下做到这一点？

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:30:17.257

尝试以下代码来更新值，您可以完全避免游标并使用它

```
UPDATE B
SET B.VALUE = V.VALUE
FROM TABLE_B B 
CROSS APPLY (SELECT DISTINCT VALUE FROM TABLE_A A 
              WHERE B.start_dt <= A.End_dt AND B.end_dt >= A.Star_Dt) V 
```

# java - 如何从 Java 访问外部 Jar 中的资源/配置/文本文件？

> ID：14408685
> 
> 赞同：1
> 
> 时间：2013-01-18T22:27:01.410
> 
> 标签：java, jar, osgi, classloader, embedded-resource

我正在*com.me.X.jar*中运行一个程序。

在外部*com.me.Y.jar*中，我有一个配置文件位于Jar 根目录的“ *config/conf.txt ”中。*

**如何从 Java 中以编程方式访问此配置文件？**

*com.me.Y.jar*当前未加载到内存中，仅由非代码资源组成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:30:42.703

jar 文件只是 zip 文件。因此，谷歌以如何读取 zip 文件为例。或者看看 API [ZipInputStream](http://docs.oracle.com/javase/6/docs/api/java/util/zip/ZipInputStream.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T23:19:42.140

读取嵌入式资源的最简单选择是使用`Class.getResource`或`Class.getResourceAsStream`

根据您的需要，我可以想出几种方法来实现这一点。

添加`com.me.Y.jar`到类路径。您可以在系统级别（不是真的推荐）或在推荐行中执行此操作...

`java -cp com.me.Y.jar -jar com.me.X.jar`

**编辑** 有人指出，显然`-cp`使用上述命令忽略了参数，但是，如果您包含主类，它将起作用...... `java -cp com.me.Y.jar -jar com.me.X.jar com.me.x.Main`（例如）

如果这不方便，您可以添加`com.me.Y.jar`到`com.me.X.jar` [清单的类路径](http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html)中，该路径会自动`com.me.Y.jar`为您包含在内。

如果你不能这样做，你可以使用 a`URLClassLoader`直接加载`com.me.Y.jar`...

```
URL[] urls = new URL[]{new File("/path/to/com.me.Y.jar").toURI().toURL())};
URLClassLoader classLoader = new URLClassLoader(urls);
URL resource = classLoader.findResource("/config/conf.txt"); 
```

或者，如果您愿意，您可以简单地使用 来打开罐子[`java.util.JarFile`](http://docs.oracle.com/javase/7/docs/api/java/util/jar/JarFile.html)，但这看起来很像用核武器来破解核桃......恕我直言

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:43:57.750

## 获取 URL 的代码

```
URL configURL = this.getClass().getResource("/config/conf.txt"); 
```

## `Manifest.mf`的`com.me.X.jar`

请参阅[将类添加到 JAR 文件的类路径](http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html)。

```
Main-Class: ...
Class-Path: com.me.Y.jar 
```

# javascript - “元素脚本的文本内容不是所需的格式：预期的空格、制表符、换行符或斜杠，但找到了 {。”

> ID：14408687
> 
> 赞同：8
> 
> 时间：2013-01-18T22:27:18.517
> 
> 标签：javascript, html, w3c-validation

根据 W3C Validator，我的 HTML 几乎与 HTML5 兼容，只剩下一个错误：配置 Google Plus 按钮的 Javascript 代码。

无论我是否添加 CDATA，都会出现错误*“元素的文本内容`script`不是所需的格式：预期的空格、制表符、换行符或斜杠，而是找到`{`了。”* 显示此行：

```
<script src="http://apis.google.com/js/plusone.js" type="text/javascript">
   {"lang":"en","parsetags":"explicit"}
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:39:58.287

错误信息是正确的。`script`具有其`src`属性集的标签[只能包含文档](http://www.w3.org/html/wg/drafts/html/master/scripting-1.html#inline-documentation-for-external-scripts)：空格和注释（`/* ... */`或`//...`）。

如果你只是想避免错误，你可以尝试`script`使用 js 创建标签，如[异步加载示例](https://developers.google.com/+/plugins/+1button/#example-async-load)中所示。这不会使其有效，但至少最初提供的 html 将没有错误，并且验证器不会抱怨。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:35:49.030

...我非常怀疑你会在这里赢得验证战。

如果您有一个痴迷于验证的客户/老板（而不是可靠的代码——因为您完全可以拥有脆弱、易碎、有效的代码），那么您可以告诉他们完全放弃 g+。

但是谷歌正在使用该脚本标签来加载其文件，该文件正在查找最后加载的脚本标签，然后使用内部文本来配置程序。

它是完全有效的语法吗？不是真的，不。

也许他们可能会考虑尝试在 JS-comments 中工作，但实际上，Google 会经常改变这些东西，因为他们接管了世界并发展了 web 编程（angular.js 太疯狂了）。

虽然它们并不完美，但我怀疑它们的代码比“W3C 验证器批准”的代码更可靠。

# command-line - cmd.exe 是否强制命令行实用程序的语法规则？

> ID：14408689
> 
> 赞同：0
> 
> 时间：2013-01-18T22:27:32.020
> 
> 标签：command-line

我遇到了几个用 C 或 C++ 编写的命令行实用程序 (CLU) 程序。我见过的所有这些程序都使用减号来控制选项，后跟正在“打开”或“关闭”的名称。例如，[gdal_translate](http://www.gdal.org/gdal_translate.html)：

```
gdal_translate -of GTiff -co "TILED=YES" utm.tif utm_tiled.tif 
```

我的问题：为什么 CLU 程序以这种方式使用减号？这仅仅是被广泛接受为良好实践的东西，CLU 程序在 cmd.exe 中工作所需要的东西，还是 C/C++ 需要的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:43:40.527

我会说更常见的是短/长形式的论点，例如

```
-C <commit>, --reuse-message=<commit>
    Take an existing commit object, and reuse the log message and the
    authorship information (including the timestamp) when creating the
    commit. 
```

这可能是因为它们可以被[`getopt_long`](http://linux.die.net/man/3/getopt_long). 就`-of`风格而言，这当然是程序员的一个选择，但我相信需要一个自定义解析器。

[**参考**](http://kernel.org/pub/software/scm/git/docs/git-commit.html)

# javascript - 使用jquery“on”命名多个事件

> ID：14408692
> 
> 赞同：7
> 
> 时间：2013-01-18T22:27:36.020
> 
> 标签：javascript, jquery

想知道使用 jquery "on" 命名多个事件的正确方法是什么......

**例如：**

```
$(".parent-selector").on({
"mouseenter.namespace": function() {
    // mouseenter event
},
"mouseleave.namespace": function() {
    // mouseleave event
}
}, ".selector"); 
```

这不起作用......如果我删除“.namespace”它确实有效。

**带有工作命名空间的 jquery 示例：**

```
$(".parent-selector").on("mouseenter.namespace", ".selector", function() { }); 
```

我知道我可以分别执行 mouseenter/mouseleave 事件......只是好奇是否有办法通过对象传递命名空间

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:29:40.430

要附加到多个事件，您必须传递以空格分隔的事件列表：

```
$(".parent-selector").on("mouseenter.namespace mouseleave.namespace",
                         ".selector", function() { }); 
```

**编辑：**

您始终可以在回调中获取事件类型并在其中调用其他函数：

```
$(".parent-selector").on("mouseenter.namespace mouseleave.namespace", ".selector", function(e) {
    if (e.type == "mouseenter.namespace") {
        myMouseEnter(e);
    } else if (e.type == "mouseleave.namespace") {
        myMouseLeave(e);
    }
}); 
```

虽然它似乎有效，但我无法确认，因为我不在我的机器上。试试看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T22:39:41.547

下面的代码实际上是正确的——我在代码前面遇到了命名空间冲突的问题。

```
$(".parent-selector").on({
    "mouseenter.namespace": function() {
        // mouseenter event
    },
    "mouseleave.namespace": function() {
        // mouseleave event
    }
}, ".selector"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:35:46.910

根据您在评论中所说的，您想为每个命名空间触发不同的函数。似乎很奇怪，您将它们结合起来想做一些不同的事情。但是如果你想知道是什么触发了事件，你可以使用[`event.type`](http://api.jquery.com/event.type/).

```
$("#foo").on("mouseover mouseout", ".bar",
    function(evt){
       console.log(evt.type); 
    }
); 
```

[JSFiddle](http://jsfiddle.net/5W5Qg/)

# c - C中的按位运算问题

> ID：14408703
> 
> 赞同：0
> 
> 时间：2013-01-18T22:28:26.593
> 
> 标签：c, bit-manipulation

是否有一个简单的按位运算（包括加法、模数等）可以产生以下输出，并且对于 cur=6...

这是为了用 x264 中的场图片对 L0 参考列表进行排序。

```
field_ref_dist( cur, ref );

f( 1, 0 ) = 0

f( 2, 1 ) = 1
f( 2, 0 ) = 0

f( 3, 2 ) = 1
f( 3, 1 ) = 0
f( 3, 0 ) = 2

f( 4, 3 ) = 1
f( 4, 2 ) = 0
f( 4, 1 ) = 3
f( 4, 0 ) = 2

f( 5, 4 ) = 1
f( 5, 3 ) = 0
f( 5, 2 ) = 3
f( 5, 1 ) = 2
f( 5, 0 ) = 4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T00:00:21.913

我不确定我是否正确推断了这些值，但如果我这样做了，

```
unsigned field_ref_dist(unsigned cur, unsigned ref) {
    return ((cur - ref - 1) & ~1u) + ((cur - ref) & !!ref);
} 
```

可以：

```
f(1, 0) = 0

f(2, 1) = 1
f(2, 0) = 0

f(3, 2) = 1
f(3, 1) = 0
f(3, 0) = 2

f(4, 3) = 1
f(4, 2) = 0
f(4, 1) = 3
f(4, 0) = 2

f(5, 4) = 1
f(5, 3) = 0
f(5, 2) = 3
f(5, 1) = 2
f(5, 0) = 4

f(6, 5) = 1
f(6, 4) = 0
f(6, 3) = 3
f(6, 2) = 2
f(6, 1) = 5
f(6, 0) = 4

f(7, 6) = 1
f(7, 5) = 0
f(7, 4) = 3
f(7, 3) = 2
f(7, 2) = 5
f(7, 1) = 4
f(7, 0) = 6

f(8, 7) = 1
f(8, 6) = 0
f(8, 5) = 3
f(8, 4) = 2
f(8, 3) = 5
f(8, 2) = 4
f(8, 1) = 7
f(8, 0) = 6

f(9, 8) = 1
f(9, 7) = 0
f(9, 6) = 3
f(9, 5) = 2
f(9, 4) = 5
f(9, 3) = 4
f(9, 2) = 7
f(9, 1) = 6
f(9, 0) = 8 
```

它甚至可能和查找表一样快。

暂时不考虑大小写`ref == 0`和`cur`奇数，这些值自然可以成对分组`(2*k, 2*k+1)`，并且值仅取决于`cur - ref`那里的差异。

交换这些对，我们只需`cur - ref - 1`. 所以为了得到这些对的较小值`2*k`——我们可以屏蔽掉最低有效位，因此

```
(cur - ref - 1) & ~1u 
```

现在，对的顺序实际上是较大的（奇数）值来自较小的（奇数）差异，所以`1`如果差异是奇数，我们添加，

```
((cur - ref - 1) & ~1u) + ((cur - ref) & 1u) 
```

这适用于除`cur`奇数和之外的所有情况`ref == 0`，在这种情况下，值必须是`cur - 1`（然后是偶数，因此`& ~1u`不会改变它）而不是`((cur - ref - 1) & ~1u) + ((cur - ref) & 1u)`。

所以对于这种特殊情况，加数应该是`0`而不是`1`。我们从 中得到它`(cur - ref) & 0`，因此我们需要一个产生`1`非零`ref`和[如果`0`是偶数，则差也是偶数，并且，因此用for ] 替换不会触及的操作。这是通过 实现的。`ref == 0``cur``((cur - ref) & 1u) == 0``1u``0``ref == 0``!!ref`

# ios - 根据 URL 更改 UIWebView 滚动位置

> ID：14408708
> 
> 赞同：0
> 
> 时间：2013-01-18T22:28:58.570
> 
> 标签：ios, objective-c, xcode, uiwebview

有没有办法根据当前 URL 更改 UIWebView 的滚动位置？

例如：

```
if (webView = thisURL) {
webView scrollPosition = ...
}
elseif (webView = thisURL) {
webView scrollPosition = ...
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:55:16.300

实现 UIWebViewDelegate，然后做这样的事情：

```
-(void) webViewDidFinishLoad:(UIWebView *)webView{
    NSString *currentURL = webView.request.URL.absoluteString;
    if([currentURL isEqualToString:@"http://www.foo.com/uri"])
    [webView stringByEvaluatingJavaScriptFromString:@"scrollTo(100,100);"];
} 
```

它捕获 Web 视图中显示的当前 url，然后与另一个 url 进行比较，如果比较返回 true，则当前 webview 会触发一个调用 scrollTo() 函数的 javascript。

# java - Android 应用程序在接收来自其他应用程序的内容时崩溃

> ID：14408711
> 
> 赞同：1
> 
> 时间：2013-01-18T22:29:09.210
> 
> 标签：java, android, android-intent, android-contentprovider

因此，我按照[本](http://developer.android.com/training/sharing/receive.html)教程进行操作，以便我的应用可以接收内容。但是当我尝试向我的应用程序分享某些内容时，它会崩溃。

这是代码：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Intent intent = getIntent();
        String action = intent.getAction();
        String type = intent.getType();

        if (Intent.ACTION_SEND.equals(action) && type != null) {
            if ("text/plain".equals(type)) {
                handleSendText(intent);
            }
            else {  
            }
        }
    }

void handleSendText (Intent intent) {
        String sharedText = intent.getStringExtra(Intent.EXTRA_TEXT);
        if (sharedText != null) {
            //Display definition. Use HTTP GET for Wikitonary.

            CardUI mCardView = (CardUI) findViewById(R.id.cardsview);
            mCardView.setSwipeable(true);

            //mCardView.addCard(new MyCard("1 card"));

        }

    } 
```

当它崩溃时，它会抛出所有这些错误：

```
01-18 17:24:34.735: E/AndroidRuntime(1937): FATAL EXCEPTION: main
01-18 17:24:34.735: E/AndroidRuntime(1937): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.dictionary/com.example.dictionary.MainActivity}: java.lang.NullPointerException
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.os.Looper.loop(Looper.java:137)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at java.lang.reflect.Method.invokeNative(Native Method)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at java.lang.reflect.Method.invoke(Method.java:511)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at dalvik.system.NativeStart.main(Native Method)
01-18 17:24:34.735: E/AndroidRuntime(1937): Caused by: java.lang.NullPointerException
01-18 17:24:34.735: E/AndroidRuntime(1937):     at com.example.dictionary.MainActivity.handleSendText(MainActivity.java:42)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at com.example.dictionary.MainActivity.onCreate(MainActivity.java:29)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.Activity.performCreate(Activity.java:5104)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-18 17:24:34.735: E/AndroidRuntime(1937):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-18 17:24:34.735: E/AndroidRuntime(1937):     ... 11 more
01-18 17:24:43.078: I/Process(1937): Sending signal. PID: 1937 SIG: 9 
```

谁能告诉我有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:36:05.007

看起来你`mCardView`就是`null`这样，你的电话`mCardView.setSwipeable(true);`会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:34:49.230

它接缝堆栈跟踪的帮助部分是：

```
01-18 17:24:34.735: E/AndroidRuntime(1937):     at com.example.dictionary.MainActivity.handleSendText(MainActivity.java:42) 
```

=> 看看第 42 行。

如果您不喜欢调试器（或由于某种原因不能使用调试器），请记录可疑变量的值以查找`null`.

# javascript - 在继续循环之前等待回调

> ID：14408718
> 
> 赞同：36
> 
> 时间：2013-01-18T22:29:42.347
> 
> 标签：javascript, jquery

我有一个正在循环的 for 循环。

我想制作一个自定义模式并在继续之前等待响应。

我怎样才能做到这一点？我知道我必须等待回调。

像这个例子：

```
 for(var x in array){
            alert(x);
            console.log(x);
        } 
```

它完全符合我的要求。但我想要三个按钮。但是警报不是javascript的一部分（？它在浏览器中。）

那么，各位有什么想法吗？

我正在考虑做这样的事情：

```
var run = true;
function foo(){
    if (run){
        setTimeout(foo, 500);
    }
}

function stop(){
    run = false;
}

foo(); 
```

然后等待停止，它会在继续之前调用按钮单击。但这真的是好习惯吗？

或者使用 lambda 函数作为 customAlert 的参数和一个“全局”变量，该变量保存我正在遍历的数组的当前位置，并使用函数执行此操作。喜欢：检查数组是否仍然持有大于 X 的键。然后再次执行该功能，每次增加全局 X。

谢谢你的代码：哦，我有一个想法；我将简单地在匿名函数中使用 lostsource 的解决方案，所以我没有得到全局变量。优秀的。

```
(function(){

})(); 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-01-18T22:47:43.260

假设这是你的数组

```
var list = ['one','two','three']; 
```

您可以尝试使用这种循环/回调方法

```
var x = 0;
var loopArray = function(arr) {
    customAlert(arr[x],function(){
        // set x to next item
        x++;

        // any more items in array? continue loop
        if(x < arr.length) {
            loopArray(arr);   
        }
    }); 
}

function customAlert(msg,callback) {
    // code to show your custom alert
    // in this case its just a console log
    console.log(msg);

    // do callback when ready
    callback();
} 
```

用法：

```
// start 'loop'
loopArray(list); 
```

JSFiddle在这里：http: [//jsfiddle.net/D9AXp/](http://jsfiddle.net/D9AXp/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T02:10:41.557

MaggiQall，我知道您有答案，但我有一个灵活的解决方案，您或其他人可能会感兴趣。

该解决方案依赖于 jQuery (1.7+) 和 jQuery UI `dialog`，但被实现为 Array 原型的自定义方法，而不是 jQuery 插件。

这是数组方法：

```
Array.prototype.runDialogSequence = function(dialogCallback, startIndex, endIndex){
    startIndex = Math.max(0, startIndex || 0);
    endIndex = Math.min(this.length - 1, endIndex || this.length - 1);
    var sequenceIndex = 0,
        arr = this,
        dfrd = $.Deferred().resolve(startIndex);
    function makeCloseFn(seqData){
        return function(event, ui){
            if(seqData.continue_) { seqData.dfrd.resolve(seqData.arrayIndex+1, seqData); } //continue dialog sequence
            else { seqData.dfrd.reject(seqData.arrayIndex, seqData); } //break dialog sequence
        }
    }
    $.each(this, function(i){
        if(i < startIndex || i > endIndex) { return true; }//continue
        dfrd = dfrd.then(function(arrayIndex){
            var seqData = {
                dfrd: $.Deferred(),
                arrayIndex: arrayIndex,
                sequenceIndex: ++sequenceIndex,
                length: 1 + endIndex - startIndex,
                item: arr[arrayIndex],
                continue_: false
            };
            dialogCallback(seqData).on("dialogclose", makeCloseFn(seqData));
            return seqData.dfrd.promise();
        });
    });
    return dfrd.promise();
} 
```

`Array.runDialogSequence()`依靠 ：

*   文档正文中的对话框模板，适合填充文本/值。
*   一组相似的项目（通常是 javascript 对象），其中包含按顺序填充对话框所需的数据。
*   作为第一个参数传递一个正确构造的“openDialog”函数。

这是一个带有解释性注释的示例“openDialog”函数：

```
function openDialog(seqData){
    /*
    seqData is an object with the following properties:
        dfrd: A Deferred object associated with the current dialog. Normally resolved by Array.runDialogSequence() to run through the sequence or rejected to break it, but can be resolved/rejected here to force the dialog sequence to continue/break. If resolved, then pass (seqData.arrayIndex+1, seqData), or custom values. If rejected, typically pass (seqData.arrayIndex, seqData).
        arrayIndex: The current array index.
        sequenceIndex: The current index within the sequence. Normally the same as arrayIndex but Differs when a non-zero startIndex is specified.
        length: The full length of the dialog sequence.
        item: The current item from the array.
        continue_: (false) Set to true to allow the sequence to continue.
    */
    var item = seqData.item;
    var $d = $("#d");
    $d.dialog({
        title: 'Dialog (' + seqData.sequenceIndex + ' of ' + seqData.length + ')',
        modal: true,
        buttons: {
            "Continue": function(){
                seqData.continue_ = true;//set to true before closing to go to next dialog.
                $(this).dialog("close");
            },
            "Cancel": function(){
                $(this).dialog('close');//closing with seqData.continue_ set to its default value false will break the dialog sequence.
            }
        }
    }).find("#message").text(item);//Typically you will do a lot more here to populate the dialog with item data.
    return $d;//openDialog() must return a dialog container, jQuery-wrapped.
} 
```

`Array.runDialogSequence()`返回一个 jQuery `promise`，允许在对话序列完成（done 函数）或在序列中间中断（fail 函数）时执行自定义操作。

以下是几个示例调用：

```
//Simplest possible
$("#myButton1").click(function(){
    myArray.runDialogSequence(openDialog);
});

//Call with custom startIndex and endIndex, and chanined `.then()` to provide custom actions on break/completion.
$("#myButton2").click(function(){
    myArray.runDialogSequence(openDialog, 1, 3).then(function(i, seqData){
        alert('All dialogs complete - last item = "' + seqData.item + '"');
    }, function(i, seqData){
        alert('Dialog sequence was broken at item ' + i + ' "' + seqData.item + '"');
    });
}); 
```

**[演示](http://jsfiddle.net/QpjdY/)**

这与我的想象所允许的一般化解决方案一样接近。

# ruby-on-rails-3 - 使用 Bootstrap 对 rails3 中的链接列表进行分页

> ID：14408727
> 
> 赞同：0
> 
> 时间：2013-01-18T22:30:24.443
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, pagination, will-paginate

基本问题：如何在 Rails 3 中创建约 1000 个对象的分页列表，同时需要为列表中的每个对象创建链接目标？

我正在开发一个有大约 1000 个用户的项目，我想用分页来显示。网站是使用 Rails 3 制作的，如果可能的话，希望使用 Bootstrap 分页显示帮助。

这是最相关的代码块，我在其中创建列表并循环遍历所有用户以添加指向其个人资料的链接：

```
<ul class="list">   
<% @users.each do |user| %>
<li style="list-style-type: none"><a href="/users/<%= user.id %>" class="user"><%= user.name %></a></li>
<% end %>
</ul> 
```

我正在考虑使用 will_paginate-bootstrap gem，但是当我需要遍历@users 为每个人添加一个链接时，我无法弄清楚如何实现它。我对 Rails 比较陌生，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:51:24.090

首先，在用户控制器中，添加 will_paginate 代码以获取 @user 实例变量，如下所示`@users = User.paginate(page: params[:page])`：然后在您看来，添加`<%= will_paginate @users, :renderer => BootstrapPagination::Rails %>`. 你可以把它放在任何你想要显示分页的地方，所以放在列表的顶部或底部，或者如果你愿意的话，甚至两者都可以。然后在页面的某处，放置类似这样的内容，这将为之前在控制器中设置的 @users 变量中的每个用户呈现 _user.html.erb 部分：

```
<ul class="list">
  <%= render @users %>
</ul> 
```

在该 _user.html.erb 文件中，您可以放置​​任何您想与每个用户一起显示的代码，例如指向用户显示页面`<%= link_to user.name, user, :class => "user" %>`或用户头像的链接。

# away3d - 为什么平面的顶点数据包含 52 个条目？

> ID：14408732
> 
> 赞同：1
> 
> 时间：2013-01-18T22:30:42.903
> 
> 标签：away3d, vertices, vertex-array, uv-mapping

我是 3D 领域的新手，并且已经尝试了几种引擎以开始使用。我选择 away3D 是因为它很简单。

我正在创建一个平面并在其上粘贴纹理，并希望能够通过实时更改 UV 数据来为纹理设置动画。

```
var plane:Mesh = new Mesh(new PlaneGeometry(10, 10, 1, 1), textMat); 
```

这些行都返回 52：

```
CompactSubGeometry(plane.geometry.subGeometries[0]).UVData.length;
plane.subMeshes[0].vertexData.length; 
```

据我在其他引擎中的理解，顶点数据包含每个顶点的 3 个值（x，y，z）。考虑到一个平面可以由 4 个或 6 个顶点构建，这将导致整个顶点数组有 12 个或 18 个顶点值。

UVData 数组通常包含每个对应顶点的 U 和 V 值，这将导致比顶点数组少的值。但是 UVdata 和 vertexData 数组在这里具有相同的长度。

我尝试在 away3D 论坛上提问，但没有得到回应，而且我对 3D 的了解仍然太少，无法理解任何 away3d 源代码。

谁能解释为什么 vertexData 和 UvData 包含这么多值，以及它们代表什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-26T01:37:59.267

[http://away3d.com/forum/viewthread/4854/](http://away3d.com/forum/viewthread/4854/)

vertexData = num_vertices * (x,y,z,Nx,Ny,Nz,Tx,Ty,Tz,u,v,Su,Sv)

车道几何（10、10、1、1）

52 = 4 * 13

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T13:43:05.693

创建网格时，使用 new PlaneGeometry(10, 10, 1, 1) 您应该在 vertexData 中获得 12 个项目，在 UVData 中获得 8 个项目。它们对应于：

vertexData：4 个顶点 * 3（x、y、z 值）。UVData：4 个顶点 * 2（u、v 值）。

# sql - 如何使用转换（）函数？

> ID：14408734
> 
> 赞同：2
> 
> 时间：2013-01-18T22:30:58.303
> 
> 标签：sql, sql-server, sql-server-2008

我想将日期时间转换为 nvarchar(64)。以下代码是用作一系列存储过程参数的一部分的代码片段。我已经包括了有错误的区域。

KEYWORD 'CONVERT' 附近的语法不正确

```
exec mysproc...@Password=N'',@IsAuthorized=1,
@UTCTIMESTAMP=CONVERT(NVARCHAR(64), GETUTCDATE(), 121),
@UserId=@SingleId output 
```

任何想法这种语法有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:48:19.343

您需要在调用存储过程之前执行这样的计算，您不能在将值传递给参数的过程中执行此操作。例如：

```
DECLARE @utc NVARCHAR(64) = CONVERT(NVARCHAR(64, GETUTCDATE(), 121);

EXEC mysproc 
  @Password = N'',
  @IsAuthorized = 1,
  @UTCTIMESTAMP = @utc,
  @UserId = @SingleId OUTPUT; 
```

这不仅限于函数调用；你也不能做这样的事情：

```
EXEC sp_help @objname = N'sys.' + 'tables'; 
```

结果：

```
Msg 102, Level 15, State 1, Line 1
Incorrect syntax near '+'. 
```

# c# - 自定义表和成员资格之间的关系

> ID：14408738
> 
> 赞同：0
> 
> 时间：2013-01-18T22:31:17.390
> 
> 标签：c#, asp.net, entity-framework, database-design, asp.net-membership

我看到很多人说不要将您的表格直接关联到会员提供者的表格。

但这是我该如何解决的场景：

*   我使用 sqlmembershipprovider 作为会员资格。
*   有一些办公室有人员，`Doctors`并且`Secretaries`。
*   我有一张桌子供`doctors`另一个`secretaries`
*   每个医生/秘书都应该有一个用于登录的帐户。

    ```
    public class Doctor
    {
        public Doctor()
        {
            this.Expertises = new HashSet<Expertise>();
        }

        [Key]
        public int DoctorId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }

        [ForeignKey("Office")]
        public int OfficeId { get; set; }
        public virtual aspnet_Users User { get; set; }
        public virtual Office Office { get; set; }
        public virtual ICollection<Expertise> Expertises { get; set; }
    }

    public class Secretary
    {
        [Key]
        public int SecretaryId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }

        // the rest..

        [ForeignKey("Office")]
        public int OfficeId { get; set; }
        public virtual aspnet_Users User { get; set; }
        public virtual Office Office { get; set; }
    } 
    ```

我以为我可以在医生/秘书表`user`与会员提供者表之间建立关系，但这似乎不是一个好方法。

我该如何解决这个问题？

**编辑：**每个员工（医生或秘书）都应该像其他网站的用户一样拥有一个注册帐户才能登录，看来我不应该直接在员工和会员表之间建立关系，因为也许我们以后会更改会员提供者。那么员工如何拥有账户呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:44:21.903

Have 和 Employee 对象。

```
 public class Employee
        {
            [Key]
            public int EmployeeId { get; set; }

            public string FirstName { get; set; }

            public string LastName { get; set; }

            // the rest..

            [ForeignKey("Office")]
            public int OfficeId { get; set; }

            [ForeignKey("EmployeeType")]
            public int EmployeeTypeId { get; set; }

            public virtual aspnet_Users User { get; set; }

            public virtual Office Office { get; set; }
        }

public class EmployeeType
{ 
  [Key]
  public int EmployeeTypeId {get; set;}
  public string EmployeeTypeDescription {get; set;} // Doctor or whatever
} 
```

# php - Elseif 错误无法修复

> ID：14408744
> 
> 赞同：0
> 
> 时间：2013-01-18T22:31:39.437
> 
> 标签：php, if-statement

我的 PHP 代码由于某种原因无法工作，我在`elseif`. 我真的无法弄清楚，因为我从未使用过`elseif`，但我在 YouTube 上看到你可以使用它，但我真的需要一些帮助来解决这个问题，但在我设置之前它运行良好`$status1-2 = closedmsg1-2`。你知道答案或其他方法`$status1-2 = closedmsg1-2`吗？我也搜索了一些“字符串替换器”或“字符串集”，但我找不到它。

```
<?php
//Made by Arnem\\

//\\Options//\\
$closed = 2000;
$opend = 1500;
$openmsg = '<p class=customfont>Streaming status: Online</p>';
$closemsg = '<h1 class=customfont2>Streaming is currently offline!</h1>';
$closemsg2 = '<p class=customfont>Streaming status: Offline</p>';
//DO NOT CONFIGURE UNDER THIS LINE!\\
$time = gmdate(H)+1 . gmdate(i);
if ($time>$closed)
$status1 = $closemsg;
$status2 = $closemsg2;
elseif ($time<$opend)
$status1 = $closemsg;
$status2 = $closemsg2;
else
$status2 = $openmsg;

echo$status1;
echo $status2;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:33:23.400

尝试

```
if ($time>$closed){
$status1 = $closemsg;
$status2 = $closemsg2;
}elseif ($time<$opend){
$status1 = $closemsg;
$status2 = $closemsg2;
}else{
// are you missing $status1 here? could be why its not working
$status2 = $openmsg;
} 
```

你少了大括号`{}`。唯一可以不使用它们的情况是它的单个语句 if/else。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:33:27.783

您需要大括号（只有单个语句分支可以没有它们）。

```
if ($time>$closed) {
    $status1 = $closemsg;
    $status2 = $closemsg2;
} elseif ($time<$opend) {
    $status1 = $closemsg;
    $status2 = $closemsg2;
} else {
    $status2 = $openmsg;
} 
```

# php - PHPMailer 中的地址无效

> ID：14408745
> 
> 赞同：4
> 
> 时间：2013-01-18T22:31:46.610
> 
> 标签：php, smtp, phpmailer

运行下面的 PHP 脚本时出现`invalid address`错误。此帖子的 SMTP 凭据和收件人电子邮件已更改。它们在实际脚本上都是有效的。我不知道为什么收件人的电子邮件被拒绝。我正在尝试使用 SMTP 身份验证发送电子邮件，并且不需要 SMTP 安全性（SSL、TLS）。

任何帮助，将不胜感激。

```
 include 'PHPMailer_5.2.2/class.phpmailer.php';

  function SendConfirmation ($sName, $sEmail)
  {
    $mail = new PHPMailer ();

    $mail->SMTPDebug  = 2;

    $mail->Host = "mail.exchange.telus.com";
    $mail->IsSMTP ();
    $mail->Username = "inbin@website.com";
    $mail->Password = "password";

    $mail->From = "inbin@website.com";
    $mail->FromName = "Web Site";

    $mail->AddAddress ($sEmail, $sName);

    $mail->Subject = 'PHPMailer Test' . date ('Y-m-d H:i:s');
    $mail->Body = "This is a test.";

    if ($mail->Send ())
      echo "\r\nMail sent.";
    else
      echo "\r\nMail not sent. " .  $mail->ErrorInfo;

    echo "\r\n";
  }  

  /***[ Main ] **************************************************************************/

  $sName = 'Johan Cyprich';
  $sEmail = 'jcyprich@website.com';

  $bSent = SendConfirmation ($sName, $sEmail); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-12-29T12:36:23.043

确保您有有效的电子邮件地址`AddReplyTo`和/或`AddAddress`.

我遇到了同样的问题，原来是因为我为`AddReplyTo`.

# java - 用于不同行的 ListView 自定义适配器

> ID：14408750
> 
> 赞同：1
> 
> 时间：2013-01-18T22:32:31.453
> 
> 标签：java, android, c

我正在使用 ListView 来显示一些 JSON 数据，并希望根据其类型（艺术家、发布、标签...）显示每个结果。

我将使用由每种结果类型实现的接口：

```
public interface Result {
    public Int getId();
    public String getThumb();
    // ...
} 
```

我想知道这些选择中的哪一个是最好的解决方案（我对更好的事情持开放态度，这正是我的想法）：

*   在交互中创建一个（因此继承的类必须像在方法中`enum ResultType`一样返回自己的值`ResultType.ARTIST``getType()`
*   使用检查实例类型`isInstance()`

我想知道执行与此 C 代码（函数指针数组）等效的操作的最佳方法是什么，因为我想避免使用许多`if`/`else`语句。

```
typedef struct s_func {
   const char *type_name;
   void* (*func_pointer)(void *result_infos);
} t_func;

static t_func type_array[] = {
 {"artist", artist_function},
 {"label", label_function},
  // ....
 {NULL, NULL}
}

void check_type(const char *type_string)
{
  int i, j = 0;
  char *key_value;

  // compare string and array key
  while (type_array && type_array[i][0]) {
    key_value = type_array[i][0];
    // if key match
    if (type_string && strncmp(type_string, key_value, strlen(type_string)) == 0) {
       type_array[i][1](); // call appropriate function;
    }
    i++;    
  }
} 
```

我猜它会使用 a`HashMap`但是（我可能错了）它似乎没有文字符号。有没有简单的方法来构建一`HashMap`对？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:56:40.823

我认为您可以使用 ArrayAdapter。看看[这个教程](http://www.vogella.com/articles/AndroidListView/article.html#listview_adapterintro)，看看我的意思。

它需要一些玩弄才能处理不同种类的物品。制作一个接口 MyListItem

```
public interface MyListItem {
    public int getLayout();
    public void bindToView(View v);
} 
```

为 Artist、Release、Label 的显示制作不同的布局。制作实现 MyListItem 的 Artist、Release、Label 类。

```
public class Artist implements MyListItem {
    private String Name;

    public Artist(String name){
        this.name = name;
    }

    public int getLayout() {
        return R.layout.artistlayout;
    }

    public void bindToView(View v) {
        TextView textView = (TextView) rowView.findViewById(R.id.artistLabel);
        textView.setText(name);
    }
} 
```

现在适配器只需调用正确的方法来填充所选项目的视图。

```
public class MySimpleArrayAdapter extends ArrayAdapter<MyListItem> {
  private final Context context;
  private final MyListItem[] values;

  public MySimpleArrayAdapter(Context context, MyListItem[] values) {
    super(context, android.R.layout.simple_list_item_1, values);
    this.context = context;
    this.values = values;
  }

  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
    MyListItem item = values[position];

    LayoutInflater inflater = (LayoutInflater) context
        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View view = inflater.inflate(item.getLayout(), parent, false);
    item.bindTo(view);
    return view;
  }
} 
```

# perl - 一个 perl 孩子可以等待另一个 perl 孩子完成吗？

> ID：14408751
> 
> 赞同：2
> 
> 时间：2013-01-18T22:32:35.723
> 
> 标签：perl, fork, parent-child, wait

所以我有一个程序，我可以让一些孩子做一些有用的任务。然后，我生成了另一个需要等待第一个孩子停下来才能完成工作的孩子。然后父程序继续运行，最后等待最后一个分叉的子程序停止。

我遇到了一个需要等待其他人的孩子没有的问题。

```
use strict;
use warnings;
use diagnostics;

my $pid1;
my $child1 = fork();
if ($child1) {
    # parent
    #print "pid is $pid, parent $$\n";
    $pid1 = $child1;
} elsif ($child1 == 0) {
        # child1
        # do something
        sleep 20;
        print "Child1\n";

        exit 0;
} else {
        die "couldnt fork: $!\n";
}

my $pid2;
my $child2 = fork();
if ($child2) {
    # parent
    #print "pid is $pid, parent $$\n";
    $pid2 = $child2;
} elsif ($child2 == 0) {
        # child2
        # wait for child1 to finish
        my $tmp = waitpid($pid1, 0);

        # do something else
        print "Child2\n";

        exit 0;
} else {
        die "couldnt fork: $!\n";
}

# do more stuff

# wait for child2 to finish
my $tmp = waitpid($pid2, 0); 
```

是否有捷径可寻？可能不必将第一个孩子包裹在第二个孩子中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:38:35.180

在类 Unix 系统中，给定进程只能等待其自己的子进程死亡。它不能等待兄弟姐妹、祖先或孙子死去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T23:47:03.377

生成一个子进程，让该进程生成子子进程，然后等待它们完成，然后再继续第一个子进程。

然后让父进程完成它的工作，并在子进程准备好等待时等待它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:30:31.513

假设您`perl`有[`semop`](http://perldoc.perl.org/functions/semop.html)朋友，您可以使用 System V 信号量在孩子之间进行同步。请参阅下面的工作示例程序。

我们从通常的正面问题开始。[代码使用内置的IPC::SysV](http://perldoc.perl.org/IPC/SysV.html)和 [IPC::Semaphore](http://perldoc.perl.org/IPC/Semaphore.html)模块，而不是直接调用低级信号量操作 。

```
#! /usr/bin/env perl

use strict;
use warnings;

use IPC::Semaphore;
use IPC::SysV qw/ IPC_PRIVATE S_IRUSR S_IWUSR IPC_CREAT /; 
```

该程序将子进程分为两个阶段。第一阶段的子进程运行到完成，在没有同步问题的情况下执行他们的处理。我们可以拥有任意数量的这些。

我们有一个第二阶段进程，但它在*所有* 第一阶段子进程完成后执行。

下面是简单的占位符实现。

```
# how many other children the last child must wait for
my $FIRST_STAGE_CHILDREN = 2;

sub first_stage {
  my($id) = @_;

  print "[$$] hello from child $id\n";
  sleep rand 10;
  print "[$$] child $id done\n";
}

sub second_stage {
  print "[$$] hello from second-stage child!\n";
} 
```

为了实现第一阶段和第二阶段之间的同步，程序创建了一组信号量，其大小等于第一阶段子节点的数量。当第一阶段的孩子完成时，程序会释放对应于该孩子的特定信号量。

```
my $sem = IPC::Semaphore->new(
  IPC_PRIVATE, $FIRST_STAGE_CHILDREN,
  S_IRUSR | S_IWUSR | IPC_CREAT)
    or die "$0: failed to create semaphore: $!"; 
```

正如我们稍后将看到的，第二阶段的孩子试图减少他们的信号量来等待他的兄弟。通过将值从零开始，当第二阶段的孩子尝试这些减量时，操作系统将使孩子进入睡眠状态，因为。只有在所有第一阶段孩子都退出并释放信号量后，系统才会解锁第二阶段孩子。

```
# start in blocked state
$sem->setall((0) x $FIRST_STAGE_CHILDREN); 
```

首先我们`fork`是第一阶段的孩子。在这种设计中，父进程会尽可能多地进行簿记。这保持了`first_stage`和`second_stage`简单的定义。此外，如果第一阶段的孩子在没有释放信号量的情况下以某种方式退出，那么第二阶段将没有运行的希望。

```
my %kids;
foreach my $id (0 .. $FIRST_STAGE_CHILDREN - 1) {
  my $pid = fork;
  die "$0: fork: $!" unless defined $pid;

  if ($pid) {
    ++$kids{$pid};
  }
  else {
    first_stage $id;
    $sem->op($id, 1, 0);  # release
    exit 0;
  }
} 
```

现在我们分叉第二阶段的孩子。重要提示：虽然代码对多个信号量执行操作，但这会*原子地*发生，也就是说，它要么对所有信号量起作用，要么对它们都不起作用。在任何可观察的状态下，似乎第二阶段能够抓取的信号量都少于第一阶段的*所有*信号量。这是一个重要的属性。在更复杂的系统中，随意的 onesie-twosie 获取和释放将导致死锁。

```
my $pid = fork;
die "$0: fork: $!" unless defined $pid;

if ($pid) {
  ++$kids{$pid};
}
else {
  # block waiting on all first-stage children
  my @op = map +($_, -1, 0), 0 .. $FIRST_STAGE_CHILDREN - 1;
  $sem->op(@op);

  second_stage;
  exit 0;
} 
```

最后，父进程等待所有子进程完成。

```
do {
  $pid = waitpid -1, 0;
  print "[$$] reaped $pid\n";
  warn "$0: unknown child $pid" unless delete $kids{$pid};
} while $pid > 0 && keys %kids; 
```

示例输出如下。在可以看到停顿的地方观看直播会更有趣。

```
[18389] 来自孩子的你好 0
[18390] 孩子 1 你好
[18390] 孩子 1 完成
[18388] 收获 18390
[18389] 孩子 0 完成
【18391】二期孩子你好！
[18388] 收获 18389
[18388] 收获 18391
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T01:37:53.340

最简单的方法是使用[`Forks::Super`](http://search.cpan.org/perldoc?Forks%3a%3aSuper#depend_on).

```
use Forks::Super;
my $child1 = fork();
if ($child1 != 0) {
    # ... parent code ...
} else {
    # ... child code ...
    exit;
}

my $child2 = fork { 
    depend_on => $child1, 
    on_busy => 'queue',
    sub => sub {
       # ... code to execute in 2nd child ...
    }
};
# ... more code to run in the parent ...
# ... and at the end of the program:
waitall; 
```

在`Forks::Super`,`waitpid`仍然在父级中调用（在幕后）。但是当第一个子进程完成后，`Forks::Super`就会知道是时候在后台启动第二个子进程了。

# javascript - jquery与jquery工具冲突

> ID：14408752
> 
> 赞同：-4
> 
> 时间：2013-01-18T22:32:36.443
> 
> 标签：javascript, jquery

我的问题是添加后：

```
<script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script> 
```

到我的网站，像 nivoslider 这样的插件和其他 jquery 脚本都不起作用。

但为了使下面的代码工作，我需要“jquery tools”

```
<script type="text/javascript"><!--
    function GetAvailProductSizes() {
        $('select#productsize option').remove();
        $('select#productsize').append('<option value=""><? echo $langdata['oneprodpage_selectsize']; ?>...</option>');

        var color = $('#productcolor').val();
        if (color > 0) {
            var availsizes;
            var http_request = new XMLHttpRequest();
            http_request.open( "GET", '<? echo ROOT; ?>/autocompleteavailsizes/?productid=<? echo $thisproduct['id']; ?>&color=' + color, true );
            http_request.send(null);
            http_request.onreadystatechange = function () {
                if ( http_request.readyState == 4 ) {
                    if ( http_request.status == 200 ) {
                        availsizes = eval( "(" + http_request.responseText + ")" );

                        for (var i = 0; i < availsizes.length; i++) {
                            $('select#productsize').append('<option value="' + availsizes[i].id + '">' + availsizes[i].name + '</option>');
                        };
                    } else {
                        alert( "There was a problem with the URL." );
                    }
                    http_request = null;
                }
            };
        };
    }
//-->
</script> 
```

只有当我包括：

```
<script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script> 
```

但是，如果我这样做，其他 jquery 脚本无法正常工作，我的意思是 nivoslider 和其他简单的弹出 div ......

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:45:03.210

jQuery 工具包括它自己的 jQuery 版本。包含一个不包含它自己的 jQuery 的 jQuery 工具版本。`http://cdn.jquerytools.org/1.2.7/all/jquery.tools.min.js`

确保首先包含您的其他 jquery，然后是 jquery 工具，然后是其余的。

```
<script src="jquery.min.js"></script>
<script src="http://cdn.jquerytools.org/1.2.7/all/jquery.tools.min.js"></script>
<script src="nivoslider.js"></script>
... 
```

# java - 有没有类似 Java 的 pkg-config 的东西？

> ID：14408754
> 
> 赞同：0
> 
> 时间：2013-01-18T22:32:41.307
> 
> 标签：java, classpath, pkg-config

我有一个项目，我们的 CLASSPATH 正在失控。我们的 jars 依赖于其他 jars，而其他 jars 又依赖于更多的 jars，以及大量的第三方 jars。因此，每次我们使用其中一个 jar 时，我们都需要构建一个相当大的 CLASSPATH，如果下游依赖项发生变化，它就不再同步。

一个想法是可能编写一个有点像 pkg-config 的工具来帮助解决所有这些问题。我做了一些搜索，没有找到任何东西。有没有我错过的类似工具或者人们有替代解决方案？

不，我不想使用 Maven。我们已经有了一个不同的构建系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:45:05.177

如果您还没有使用构建工具，我建议您从[Maven](http://maven.apache.org/)开始。让人们远离 Maven 的主要原因是它有一个标准的项目结构。就个人而言，我认为这是一件好事。

如果您想让您的项目更自由一点，可以使用[Maven Ant Tasks](http://maven.apache.org/ant-tasks/index.html) for [Ant](http://ant.apache.org/)。与 Ivy 相比，我更喜欢这些，但部分原因是我习惯了 Maven 工件命名约定。

无论哪种情况（或者如果您使用 Ivy），请查看存储库管理器。[Nexus](http://www.sonatype.org/nexus/)是由维护 Maven 的人编写的，我发现它比[Artifactory](http://www.jfrog.com/)更容易使用，Artifactory是另一个广泛使用的系统。Artifactory 的一个好处是它们提供托管（收费）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:59:40.303

您可能希望将 maven 与 m2eclipse 之类的 IDE 插件一起使用。您所要做的就是在代码中输入类，它将帮助您搜索并引入正确的包及其依赖项。它还将自动为您配置类路径。这是一个快速教程[http://www.sonatype.com/people/2010/03/adding-dependencies-using-m2eclipse/](http://www.sonatype.com/people/2010/03/adding-dependencies-using-m2eclipse/)

# c++ - 在 c++ 中使用 c 库时遇到问题

> ID：14408757
> 
> 赞同：1
> 
> 时间：2013-01-18T22:33:22.153
> 
> 标签：c++, c, shared-libraries

为了自学一点 C++，我决定编写一个小程序来将文本写入我的 Saitek X52 Pro 操纵杆显示器。

我想使用 Eduards C 库 [http://plasma.hasenleithner.at/x52pro/](http://plasma.hasenleithner.at/x52pro/)

我知道如果我想在我的 C++ 程序中使用它们，我必须在方法周围放置一个“extern C”。但这意味着更改库的头文件 - 然后它就不会再构建了。在这种情况下，正确的方法是什么？

编辑：建议的方法部分起作用。

通讯.cpp：

```
...
extern "C"{
#include <x52pro.h>
}
using namespace std;
int main ( int argc, char *argv[] ) {
    cout<<"entered main"<<endl;
    char *String;
    strcpy(String,"testing");
    struct x52 *hdl = x52_init();
    x52_settext(hdl, 0,String , 7);
    x52_close(hdl);
    return EXIT_SUCCESS;
} 
```

错误信息：

```
Comm.o: In function `main': 
Comm.cpp|38| undefined reference to `x52_init' 
Comm.cpp|39| undefined reference to `x52_settext' 
Comm.cpp|40| undefined reference to `x52_close' 
```

这些都是在 x52pro.h 中定义的所有方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:37:21.123

要`extern "C"`在 C 头文件中使用，请将其包装为

```
#ifdef __cplusplus
extern "C" {
#endif
...
#ifdef __cplusplus
}
#endif 
```

或者你可以`#include`用`extern "C"`

```
extern "C" {
#include <chdr1.h>
#include <chdr2.h>
} 
```

链接您的应用程序时，您必须告诉链接器要使用哪个库以及库在哪里。从您的链接中，您还必须添加 libusb。这看起来大致像这样

```
g++ -o app_name Comm.o -L /path/to/library -lx52pro -lusb 
```

当库安装在系统lib目录下时，可以省略该`-L /path/...`部分。如果你使用 Makefile，你可以在一些变量中定义它，通常

```
LDFLAGS = -L /path/to/library
LDLIBS = -lx52pro -lusb 
```

另请参阅[编译和链接](http://www.cprogramming.com/compilingandlinking.html)和 [维基百科 - 链接器（计算）](http://en.wikipedia.org/wiki/Linker_%28computing%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:36:29.037

```
#ifdef __cplusplus
   extern C {
#endif 
    ...

#ifdef __cplusplus
   }
#endif 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:36:30.670

在您的 C++ 代码中，您可以像这样围绕包含的头文件`extern "C"`：

```
extern "C" {
#include "c_header_file.h"
} 
```

然后，您不需要修改第三方库的头文件。

# php - Wordpress Nivo Slider / Slug PHP 问题

> ID：14408759
> 
> 赞同：1
> 
> 时间：2013-01-18T22:33:24.023
> 
> 标签：php, wordpress, slider, slug, nivo-slider

我正在为 WordPress 使用 Nivo Slider 插件，但想将滑块硬编码到我的页面中，并让它动态拉入正确的滑块，因为页面和 Nivo 滑块将共享相同的 slug。

如果我的滑块被称为翻转时钟打印，这就是有效的......

```
<?php echo do_shortcode('[nivoslider slug="flip-clock-print"]'); ?> 
```

如果我想要页面的slug，这就是有效的......

```
 <?php echo $post->post_name; ?> 
```

我如何将两者结合在一起，因为我想这是不对的？

```
 <?php echo do_shortcode('[nivoslider slug="$post->post_name;"]'); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T00:56:38.587

这只是使用正确的引用样式的问题。

你可以做：

```
$var = 'Lorem ipsum ' . $other_var . 'lorem ipsum lorem';
$shortcode = '[nivoslider slug="' . $post->post_name .'"]';
echo do_shortcode( $shortcode ); 
```

或者

```
$var = "Lorem ipsum $other_var lorem ipsum lorem";
echo do_shortcode("[nivoslider slug='$post->post_title']"); 
```

* * *

查看：

*   [WordPress_Coding_Standards#Single_and_Double_Quotes](http://codex.wordpress.org/WordPress_Coding_Standards#Single_and_Double_Quotes)

*   [PHP中单引号和双引号字符串有什么区别？](https://stackoverflow.com/q/3446216/1287812)

# internet-explorer - 应用程序总是在 IE9 兼容性视图中加载

> ID：14408763
> 
> 赞同：3
> 
> 时间：2013-01-18T22:33:50.743
> 
> 标签：internet-explorer, cross-browser, compatibility

我们有一个 ASP.NET MVC 应用程序，它最近刚开始在加载时强制 IE 进入 IE9 兼容性视图。我们在布局页面中添加了以下内容

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

或者

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

但是页面仍然强制 IE 进入兼容模式。问题是我们只支持 IE 8 及更高版本，所以当我们执行服务器端检查时，它认为浏览器是 IE 7 并告诉用户升级他们的浏览器。

任何人都知道为什么给定的浏览器会完全忽略 X-UA-Compatible 标签并以兼容模式呈现页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:39:24.880

没关系。这很尴尬。也许我的愚蠢将来会拯救别人。

![在此处输入图像描述](../Images/49a61aca3d68534b3c682100b8f3e5a7.png)

# crystal-reports - 如何在 Crystal Reports 中对齐线条

> ID：14408767
> 
> 赞同：5
> 
> 时间：2013-01-18T22:34:15.637
> 
> 标签：crystal-reports, crystal-reports-xi

有没有一种好方法可以在 Crystal Reports 中使水平线真正对齐？我可以选择文本和字段对象、右键单击并进行各种大小调整和对齐。但这不是一条线的选择。我需要带下划线的标题字段（无论出于何种原因，我们的标准规定不使用下划线），并且我希望它们在报告中排列。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T22:52:59.643

这很痛苦，但我找到了一种方法。

字段和订单项都有一个名为“大小和位置”的右键单击菜单选项。它不需要任何值，尤其是在打开对齐网格的情况下（并且在未打开时并不总是完全采用您选择的值），但是您可以仔细确保每条线具有相同的 Y 值（对于水平行）。而且，如果您希望它们对齐并与它们下划线的字段标题长度相同，请比较每个标题字段 X 和 Width 值，并使每一行也匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T14:05:26.997

在设计模式下，您可以通过单击标尺（垂直的）字段来添加水平参考线，这会粘在它上面。

您还可以选择多个字段，右键单击“对齐 > 底部”，然后将字段移动到参考线。

您还可以格式化单个字段以“锁定其位置和大小”，然后将其他字段对齐

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-25T13:14:45.467

另一种方法是选择所有要左对齐的行，用左光标键将它们移到最左边，直到它们碰到左边距，然后按住左键直到它们都对齐。只是一个把戏！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-08T16:36:45.960

在标题文本对象上放置一个底部边框。

# coldfusion - 这是 cfscript 中的 ColdFusion 错误吗？

> ID：14408774
> 
> 赞同：3
> 
> 时间：2013-01-18T22:34:51.227
> 
> 标签：coldfusion, coldfusion-9, coldfusion-10

这是返回用户表中单引号包围的电子邮件的有效查询。

```
SELECT  '''' +email + '''' as email
FROM    users
where fname = @fname 
```

然而，当我尝试在这样的 cfscript (cf9) 查询中执行此操作时：

```
var q = new Query(datasource="warewithal");
q.setSQL("SELECT  '''' +email + '''' as email
                FROM users where firstName= :firstName ");
q.addParam(name="firstName", value=trim(firstName), cfsqltype="cf_sql_varchar"); 
```

我最终得到的是

```
Email
+email+ 
```

当我期望时（并通过在分析器中运行查询来获得）

```
Email
'bozo@clowns.com' 
```

cfscript 正在执行 perserveSingleQuote 并且不让我将单引号添加到输出中。

这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T18:35:38.820

回答标题中的问题：不，这不是 CFScript 中的错误。您所展示的内容与 CFScript 完全无关。

但是，要回答您*要*问的问题：是的，您在 Query.cfc 中发现了一个错误。

这是一些演示该错误的代码（并证明它与 CFScript 无关，而与 Query.cfc 无关）。

此代码工作正常：

```
<cfset query = new Query(datasource="scratch_mssql")>
<cfset query.setSql("
    SELECT  '''' + email + '''' as email
    FROM    users
    WHERE   firstName = '#firstName#'   
")>
<cfset emailAddresses = query.execute().getResult()> 
<cfdump var="#emailAddresses#"> 
```

请注意，我已将过滤器值硬编码到 SQL 字符串中。呸。

此代码错误：

```
<cfset query = new Query(datasource="scratch_mssql")>
<cfset query.setSql("
    SELECT  '''' + email + '''' as email
    FROM    users
    WHERE   firstName = :firstname  
")>
<cfset query.addParam(name="firstname", value=firstName, cfsqltype="CF_SQL_VARCHAR")>
<cfset emailAddresses = query.execute().getResult()> 
<cfdump var="#emailAddresses#"> 
```

我的错误是：

`[Macromedia][SQLServer JDBC Driver][SQLServer]An object or column name is missing or empty.` `For SELECT INTO statements, verify each column has a name. For other statements,` `look for empty alias names. Aliases defined as "" or [] are not allowed. Change the alias to a valid name.`

仅供参考：CF 传递给数据库的 SQL 是：

```
SELECT  '' '' + email + '' '' as email FROM users WHERE firstName = (param 1) 
```

为了证明它是由 ColdFusion 错误处理您的单引号引起的，这有效：

```
<cfset query = new Query(datasource="scratch_mssql")>
<cfset query.setSql("
    SELECT  email as email
    FROM    users
    WHERE   firstName = :firstname  
")>
<cfset query.addParam(name="firstname", value=firstName, cfsqltype="CF_SQL_VARCHAR")>
<cfset emailAddresses = query.execute().getResult()> 
<cfdump var="#emailAddresses#"> 
```

所以如果我是你，我会为此提出一个[错误。](https://bugbase.adobe.com/)注：CF9.0.2 和 CF10.0.7 相同

但是，同样......如果我是你，无论如何我都不会把那些引号放在那里。除非有很好的理由，否则请在显示时将它们插入，而不是在进行数据处理时插入。我想它们是为了展示目的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-15T19:01:58.067

对于它的价值，我只是被这个问题所吸引。似乎有效的是对您的 Query.cfc 对象 (/[YOUR-CF-INSTALL]/CustomTags/com/adobe/coldfusion/Query.cfc) 的简单修复。在 replaceDelimsWithMarkers() 函数中，更新这一行（对我来说是 LN 341）

```
newSql = newSql & SINGLEQUOTE & sqlArray[i] & SINGLEQUOTE & " "; 
```

通过删除最后引用的空格，它是：

```
newSql = newSql & SINGLEQUOTE & sqlArray[i] & SINGLEQUOTE & ""; 
```

然后效果很好。我正在查找用户，需要找到姓氏为“O'Neill”的用户。无论我做什么，我都会得到“O''Neill”，正如你所说的那样失败了。

您能想到此更改/修复会产生负面影响的任何情况吗？我不能离开我的头顶，但现在我们将复制 query.cfc 文件，重命名它并将其用作自定义标记，仅当我们需要运行我们怀疑可能使用额外撇号的查询时。唯一的区别将是这一点小变化。

# php - 为什么当我点击输入我的文本字段时，我的“否”单选按钮被点击？

> ID：14408790
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:36:32.257
> 
> 标签：php, jquery, html, css

[http://web.cs.dal.ca/~selig/serverside/assignment1/](http://web.cs.dal.ca/~selig/serverside/assignment1/)

在这里，在最底部的单选按钮处查看它的实际效果。

这是我的 jQuery（很简单）：

```
$(document).ready(function() {

    // Reveals the email address field when option is selected
    $('#yes-radio').click(function() {
        $('.email-field').show(200);
    });
    $('#no-radio').click(function() {
        $('.email-field').hide(200);
    });
 }); 
```

谁能告诉我为什么这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:41:37.033

这一行：

`<label for="no-radio" class="radio-label"><input type="radio" name="email-radio" id="no-radio" value="no"> No <label>`

需要是：

`<label for="no-radio" class="radio-label"><input type="radio" name="email-radio" id="no-radio" value="no"> No </label>`

请注意，您没有关闭标签。^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:44:48.910

你的“否”按钮的标签仍然打开（你写`<label>`而不是`</label>`），所以当点击文本框时，你点击标签，从而激活没有单选框。

# java - 让 ViewFlipper 使用字符串数组

> ID：14408793
> 
> 赞同：0
> 
> 时间：2013-01-18T22:37:10.870
> 
> 标签：java, android, eclipse, viewflipper

我正在尝试将 ViewFlipper 放在我的字符串数组中，这样我就可以在应用程序之外制作一种闪存卡应用程序。应用程序在模拟器上加载时崩溃。我认为我可能将所有内容排列起来或遗漏了某些内容的方式有问题。

```
 package starting.bio;

import java.util.Random;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.animation.AccelerateInterpolator;
import android.view.animation.Animation;
import android.view.animation.TranslateAnimation;
import android.widget.Button;
import android.widget.TextView;
import android.widget.ViewFlipper;

public class Flashcard extends Activity implements OnClickListener{

    View.OnTouchListener gestureListener;
    ViewFlipper flipper;
    String facts[] = {
//Biology ch. 9

"Fermentation is a partial degradation of sugars that occurs without O2\. Aerobic respiration consumes organic molecules and O2 and yields ATP",
"Cellular respiration includes both aerobic and anaerobic respiration but is often used to refer to aerobic respiration",
"Chemical reactions that transfer electrons between reactants are called oxidation-reduction reactions, or redox reactions. In oxidation, a substance loses electrons, or is oxidized. In reduction, a substance gains electrons, or is reduced (the amount of positive charge is reduced)",
"The electron donor is called the reducing agent. The electron receptor is called the oxidizing agent. Some redox reactions do not transfer electrons but change the electron sharing in covalent bonds",
"Harvesting of energy from glucose has three stages-Glycolysis (breaks down glucose into two molecules of pyruvate), The citric acid cycle (completes the breakdown of glucose), and Oxidative phosphorylation (accounts for most of the ATP synthesis).",
"Oxidative phosphorylation accounts for almost 90% of the ATP generated by cellular respiration. A smaller amount of ATP is formed in glycolysis and the citric acid cycle by substrate-level phosphorylation",
"Most cellular respiration requires O2 to produce ATP. Without O2, the electron transport chain will cease to operate. In that case, glycolysis couples with fermentation or anaerobic respiration to produce ATP",
"All use glycolysis (net ATP = 2) to oxidize glucose and harvest chemical energy of food. In all three, NAD+ is the oxidizing agent that accepts electrons during glycolysis. The processes have different final electron acceptors: an organic molecule (such as pyruvate or acetaldehyde) in fermentation and O2 in cellular respiration. Cellular respiration produces 32 ATP per glucose molecule; fermentation produces 2 ATP per glucose molecule ",
"Obligate anaerobes carry out fermentation or anaerobic respiration and cannot survive in the presence of O2\. Yeast and many bacteria are facultative anaerobes, meaning that they can survive using either fermentation or cellular respiration.",

 };

private Animation inFromRightAnimation() {

Animation inFromRight = new TranslateAnimation(
Animation.RELATIVE_TO_PARENT,  +1.0f, Animation.RELATIVE_TO_PARENT,  0.0f,
Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,   0.0f
);
inFromRight.setDuration(500);
inFromRight.setInterpolator(new AccelerateInterpolator());
return inFromRight;
}
private Animation outToLeftAnimation() {
Animation outtoLeft = new TranslateAnimation(
  Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,  -1.0f,
  Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,   0.0f
);
outtoLeft.setDuration(500);
outtoLeft.setInterpolator(new AccelerateInterpolator());
return outtoLeft;
}

private Animation inFromLeftAnimation() {
Animation inFromLeft = new TranslateAnimation(
Animation.RELATIVE_TO_PARENT,  -1.0f, Animation.RELATIVE_TO_PARENT,  0.0f,
Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,   0.0f
);
inFromLeft.setDuration(500);
inFromLeft.setInterpolator(new AccelerateInterpolator());
return inFromLeft;
}
private Animation outToRightAnimation() {
Animation outtoRight = new TranslateAnimation(
  Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,  +1.0f,
  Animation.RELATIVE_TO_PARENT,  0.0f, Animation.RELATIVE_TO_PARENT,   0.0f
);
outtoRight.setDuration(500);
outtoRight.setInterpolator(new AccelerateInterpolator());
return outtoRight;
}

TextView display, display1;
TextView counter;
Button begin;
Button next;
Button previous;
Button random;
Random myRandom;

int index = facts.length;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.main);

 flipper = (ViewFlipper) findViewById(R.id.flipper);
 Button button1 = (Button) findViewById(R.id.Button01);
 Button button2 = (Button) findViewById(R.id.Button02);

 button1.setOnClickListener(new View.OnClickListener() {
     public void onClick(View view) {
         flipper.setInAnimation(inFromRightAnimation());
         flipper.setOutAnimation(outToLeftAnimation());
         flipper.showNext();      
     }
 });

 button2.setOnClickListener(new View.OnClickListener() {
     public void onClick(View view) {
         flipper.setInAnimation(inFromLeftAnimation());
         flipper.setOutAnimation(outToRightAnimation());
         flipper.showPrevious();      
     }
 });

 display = (TextView) findViewById(starting.bio.R.id.tvResults);
    counter = (TextView) findViewById(starting.bio.R.id.tvCounter);
    next = (Button) findViewById(starting.bio.R.id.Next);
    previous = (Button) findViewById(starting.bio.R.id.Previous);
    random = (Button) findViewById(starting.bio.R.id.Random);

    next.setOnClickListener(this);
    previous.setOnClickListener(this);
    random.setOnClickListener(this);

    myRandom = new Random();

}

private void showDisplay() {
    display.setText(facts[index]);
    counter.setText(String.valueOf(index + 1) + "/"
            + String.valueOf(facts.length));
}

public void onClick(View arg0) {
    // TODO Auto-generated method stub
    switch (arg0.getId()) {
    case starting.bio.R.id.Next:
        index++;
        if (index > facts.length - 1) {
            index = 0;
        }
        showDisplay();

        break;

    case starting.bio.R.id.Previous:
        index--;
        if (index < 0) {
            index = facts.length - 1;
        }
        showDisplay();
        break;

    case starting.bio.R.id.Random:
        index = (myRandom.nextInt(facts.length) - 1);
        if (index < 0) {
            index = facts.length - 1;
        }
        showDisplay();
        break;

    }

}

} 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<ViewFlipper xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/flipper"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <include
        android:id="@+id/first"
        layout="@layout/first_view" />

    <include
        android:id="@+id/second"
        layout="@layout/second_view" />

</ViewFlipper> 
```

first_view.xml

```
<RelativeLayout android:id="@+id/LinearLayout01"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical">

<TextView android:text="This is the first view"
android:id="@+id/TextView01"
android:layout_height="wrap_content"
android:layout_width="wrap_content"
android:layout_gravity="center_horizontal">
</TextView>

<TextView
    android:id="@+id/tvResults"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/Next"
    android:layout_marginTop="58dp"
    android:gravity="center"
    android:text="Touch Next or Previous to begin Biology!!!"
    android:textColor="@android:color/black"
    android:textSize="32dp"
    android:textStyle="bold" />

<Button
    android:id="@+id/Button01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/Next"
    android:layout_marginLeft="33dp"
    android:layout_marginTop="18dp"
    android:text="Click for Second view " />

<Button
    android:id="@+id/Next"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@drawable/arrow"
    android:text="Next"
    android:textStyle="bold" />

<Button
    android:id="@+id/Random"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_toRightOf="@+id/TextView01"
    android:background="@drawable/bigred"
    android:text="Random"
    android:textStyle="bold" />

<Button
    android:id="@+id/Previous"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@drawable/arrowl"
    android:text="Previous"
    android:textStyle="bold" />

</RelativeLayout> 
```

second_view.xml

```
<RelativeLayout android:id="@+id/LinearLayout01"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical">

<TextView android:text="This is the second view"
android:id="@+id/TextView02"
android:layout_height="wrap_content"
android:layout_width="wrap_content"
android:layout_gravity="center_horizontal">
</TextView>

<Button
    android:id="@+id/Button02"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/TextView02"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="39dp"
    android:text="Click for first view " />

<TextView
    android:id="@+id/tvResults"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/Button02"
    android:layout_marginTop="20dp"
    android:gravity="center"
    android:text="Touch Next or Previous to begin Biology!!!"
    android:textColor="@android:color/black"
    android:textSize="32dp"
    android:textStyle="bold" />

<Button
    android:id="@+id/Next"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@drawable/arrow"
    android:text="Next"
    android:textStyle="bold" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:56:43.113

你能发布你的layout.xml吗，想看看你是如何设置你的小部件的

编辑：

查看您的 xml，我没有看到带有 ID 的小部件

```
开始.bio.R.id.tvCounter
```

```
    计数器 = (TextView) findViewById(starting.bio.R.id.tvCounter);

```

# c++ - 如何验证运行时失败是否是由于产生的线程过多？

> ID：14408796
> 
> 赞同：4
> 
> 时间：2013-01-18T22:37:26.290
> 
> 标签：c++, multithreading, c++11

我使用`std::thread`gcc 作为我的编译器来实现[Cormen 的算法简介中](https://rads.stackoverflow.com/amzn/click/com/0262033844)所述的并行合并。

我想我得到了工作的代码。它传递所有不太大的随机种子数组。但是，当我尝试合并两个大数组（每个数组 1e6 个元素）时，我得到以下终止：

```
terminate called without an active exception
terminate called recursively
terminate called recursively 
```

使用 gdb 没有帮助：它在运行期间被损坏。

我很确定由于产生了太多线程而导致运行失败。

*我能做些什么来确认这个错误是由于产生了太多的 std::threads 造成的？*

**笔记**

1.  代码工作到 n=1e4，失败 n=1e5
2.  # 如果您想查看输出，请定义 DEBUG，但我不建议这样做，除非像 10 或 50 这样的小 n。

3.  STRBUF_SIZE/fprintf 的使用是丑陋的，但 iostream 在线程中不能很好地刷新 - 这是 hacky，但有效（无需在这里关注）。
4.  我尝试通过在线程周围使用 try/catch 块来遵循 Barnes53 的建议，但这显然不起作用。
5.  我知道产生大量线程是一件坏事——在这一点上，我只是试图实现书中的内容，看看它是否有效，也许会发现它的局限性。

**更新**

1.  [GManNickG 在下面的回答](https://stackoverflow.com/a/14409088/975129)有所帮助：并非每次运行，但在 1e5 的某些运行期间，我可以看到，资源确实消失了。
2.  我可能会研究某种 k 路并行排序，如果该算法不可挽救，我可以在其中控制产生的线程数。

**代码**

```
#include <vector>
#include <iostream>
#include <algorithm>
#include <vector>
#include <thread>
#include <cmath>
#include <cstring>
#include <cassert>

#define STRBUF_SIZE 1024

class Random
{
public:
    Random( unsigned int seed=::time(nullptr))
        : m_seed( seed )
    { }
    // between [ 0 .. n-1 ]
    unsigned int rand_uint( unsigned int n )
    {
        return static_cast<unsigned int>
                     (static_cast<float>(n) * rand_r( &m_seed ) / RAND_MAX);
    }
    unsigned int getSeed() const { return m_seed; }
private:
    unsigned int m_seed;
};

template<typename T>
char* dump( char* line, T it1, T it2 )
{
    char buf[80];
    line[0] = '\0';
    for( T it=it1; it!=it2; ++it )
    {
        sprintf( buf, "%u ", *it );
        strcat(  line, buf );
    }
    return line;
}

template< typename T, class It >
It binary_search_it( It beg, It end, const T& value )
{
    auto low  = beg;
    auto high = std::max( beg, end );   // end+1
    while( low < high )
    {
        auto mid = low + std::distance( low, high ) / 2;
        if ( value <= *mid )
            high = mid;
        else
            low = mid + 1;
    }
    return high;
}

template< class InputIt, class OutputIt >
void p_merge( 
    char const*  msg, 
    unsigned     depth,
    unsigned     parent_lvl_id,
    unsigned     lr,
    InputIt  p1, InputIt  r1, 
    InputIt  p2, InputIt  r2, 
    OutputIt p3, OutputIt r3
    )
{
#ifdef DEBUG
    char buff[STRBUF_SIZE];
#endif
    unsigned sum_prev  = pow( 2, depth ) - 1;
    unsigned lvl_id    = 2*parent_lvl_id + lr;
    unsigned thread_no = sum_prev + lvl_id + 1;

    unsigned limit0    = sum_prev + 1;
    unsigned limit1    = pow( 2, depth+1 ) - 1;

#ifdef DEBUG
    char msg_dep[256];
    sprintf( msg_dep, "%s [%2d] %-10d [%d,%d]", msg, depth, thread_no, limit0, limit1 );
    fprintf( stderr, "%s\n", msg_dep );
#endif

    if ( thread_no<limit0 || thread_no>limit1 )
    {
        fprintf( stderr, "OUT OF BOUNDS\n" );
        exit( 1 );
    }

    auto n1 = std::distance( p1, r1 );
    auto n2 = std::distance( p2, r2 );
#ifdef DEBUG
    fprintf( stderr, "%s dist[v1]=%2ld   : %s\n", msg_dep, n1, dump( buff, p1, r1 ) );
    fprintf( stderr, "%s dist[v2]=%2ld   : %s\n", msg_dep, n2, dump( buff, p2, r2 ) );
#endif
    if ( n1<n2 )
    {
        std::swap( p1, p2 );
        std::swap( r1, r2 );
        std::swap( n1, n2 );
#ifdef DEBUG
      fprintf( stderr, "%s swapped[v1]   : %s\n", msg_dep, dump( buff, p1, r1 ));
      fprintf( stderr, "%s swapped[v2]   : %s\n", msg_dep, dump( buff, p2, r2 ));
#endif
    }
    if ( n1==0 )
    {
#ifdef DEBUG
      fprintf( stderr, "%s done              \n", msg_dep );
#endif
        return;
    }
    auto q1 = p1 + n1 / 2;   // midpoint
    auto q2 = binary_search_it( p2, r2, *q1 );  // <q1   q2[q1]   >=q1
    auto q3 = p3 + std::distance( p1, q1 ) + std::distance( p2, q2 );
    *q3 = *q1;

#ifdef DEBUG
    fprintf( stderr, "%s q1[median]=%u  : %s\n", msg_dep, *q1, dump( buff, p1, r1 ));
    fprintf( stderr, "%s q2[fulcrum]=%u : %s\n", msg_dep, *q2, dump( buff, p2, r2 ));
    fprintf( stderr, "%s q3(copied)=%u  : %s\n", msg_dep, *q3, dump( buff, p3, r3 ));
#endif

#ifdef DEBUG
    auto d1 = std::distance( p1,   q1-1 );
    auto d2 = std::distance( q1+1, r1   );
    fprintf( stderr, "%s q1[dist_L]=%ld  : %s\n", msg_dep, d1, dump( buff, p1, r1 ));
    fprintf( stderr, "%s q1[dist_M]=%ld  : %s\n", msg_dep, d2, dump( buff, p1, r1 ));
#endif

    try {
        std::thread t1{ 
            [&](){ p_merge( "LESS", depth+1, lvl_id, 0, p1, q1,   p2, q2,   p3, r3 ); } 
        };
        std::thread t2{ 
            [&](){ p_merge( "MORE", depth+1, lvl_id, 1, q1+1, r1, q2, r2, q3+1, r3 ); } 
        };
        t1.join();
        t2.join();
    }
    catch( ... )
    {
        fprintf( stderr, "OK - I am dying during a std::thread spawn\n" );
        exit( 1 );
    }

#ifdef DEBUG
    fprintf( stderr, "%s synchronized\n", msg_dep );
#endif
}

int
main( int argv, char* argc[] )
{
    // ok up to 1e4, fails by 1e5
    unsigned n = 1e5; 
    Random   r;
    std::vector<unsigned> v1( n ), v2( n ), v3( 2 * n );

#ifdef DEBUG
    fprintf( stderr, "SEED = %u\n", r.getSeed() );
#endif

    std::generate( v1.begin(), v1.end(), [&]() { return r.rand_uint(n); } );
    std::generate( v2.begin(), v2.end(), [&]() { return r.rand_uint(n); } );

#ifdef DEBUG
    char buff[STRBUF_SIZE];
    fprintf( stderr, "%s\n", dump( buff, v1.begin(), v1.end() ));
    fprintf( stderr, "%s\n", dump( buff, v2.begin(), v2.end() ));
#endif

    std::sort( v1.begin(), v1.end() );
    std::sort( v2.begin(), v2.end() );

    p_merge( "TOP ", 0, 0, 0,
        v1.begin(), v1.end(), v2.begin(), v2.end(), v3.begin(), v3.end() );

    assert( std::is_sorted( v3.begin(), v3.end() ));

#ifdef DEBUG
    fprintf( stderr, "FINAL : %s\n", dump( buff, v3.begin(), v3.end() ));
#endif
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T23:06:57.277

您可以捕获`std::system_error`并检查代码是否为`resource_unavailable_try_again`：

```
#include <atomic>
#include <iostream>
#include <system_error>
#include <thread>
#include <vector>

class thread_collection
{
public:
    thread_collection() :
    mStop(false)
    {}

    ~thread_collection()
    {
        clear();
    }

    template <typename Func, typename... Args>
    bool add(Func&& func, Args&&... args)
    {
        try
        {
            mThreads.emplace_back(std::forward<Func>(func),
                                  std::cref(mStop),
                                  std::forward<Args>(args)...);
        }
        catch (const std::system_error& e)
        {
            if (e.code().value() == std::errc::resource_unavailable_try_again)
                return false; // not possible to make more threads right now
            else
                throw; // something else
        }

        return true; // can keep going
    }

    void clear()
    {
        mStop = true;
        for (auto& thread : mThreads)
        {
            if (thread.joinable())
                thread.join();
        }

        mThreads.clear();
        mStop = true;
    }

    std::size_t size() const
    {
        return mThreads.size();
    }

private:
    thread_collection(const thread_collection&);
    thread_collection& operator=(const thread_collection&);

    std::atomic<bool> mStop;
    std::vector<std::thread> mThreads;
};

void worker(const std::atomic<bool>& stop)
{
    while (!stop)
        std::this_thread::yield();
}

int main()
{
    thread_collection threads;

    try
    {
        while (threads.add(worker))
            continue;

        std::cout << "Exhausted thread resources!" << std::endl;
    }
    catch (const std::exception& e)
    {
        std::cout << "Stopped for some other reason: " << e.what() << std::endl;
    }

    std::cout << "Made: " << threads.size() << " threads." << std::endl;
    threads.clear();
} 
```

*（运行此操作需您自担风险！）*

根据§30.3.1.2/4，这是用于指示线程创建失败的错误代码：

> 错误条件：
> resource_unavailable_try_again — 系统缺乏创建另一个线程所需的资源，或者系统对进程中的线程数施加的限制将被超过。

请注意，这可能是由于您自己的参数被复制到结果线程而引发的。为了保证不会发生这种情况，您需要预先构建您的参数，然后将它们不扔到您的线程函数中。

也就是说，无论如何你最好限制线程创建。运行的线程多于内核可以执行的线程是没有意义的。用于`std::thread::hardware_concurrency`获取该号码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T16:33:28.633

```
try {
    std::thread t1{ 
        [&](){ p_merge( "LESS", depth+1, lvl_id, 0, p1, q1,   p2, q2,   p3, r3 ); } 
    };
    std::thread t2{ 
        [&](){ p_merge( "MORE", depth+1, lvl_id, 1, q1+1, r1, q2, r2, q3+1, r3 ); } 
    };
    t1.join();
    t2.join();
}
catch( ... )
{
    fprintf( stderr, "OK - I am dying during a std::thread spawn\n" );
    exit( 1 );
} 
```

此代码可能无法达到您的预期。如果构造`t2`引发异常，`t1`则将被销毁，但由于该线程是可连接的，它将调用`std::terminate()`，因此您`catch`将不会处理该异常。

您看到的一个原因`terminate called recursively`可能是许多线程同时遇到相同的问题，因此许多线程`terminate()`在相似的时间调用。

这将改为：

```
std::thread t1;
std::thread t2;

try {
    t1 = std::thread{ 
        [&](){ p_merge( "LESS", depth+1, lvl_id, 0, p1, q1,   p2, q2,   p3, r3 ); } 
    };
    t2 = std::thread{ 
        [&](){ p_merge( "MORE", depth+1, lvl_id, 1, q1+1, r1, q2, r2, q3+1, r3 ); } 
    };
}
catch( ... )
{
    fprintf( stderr, "OK - I am dying during a std::thread spawn\n" );
    exit( 1 );
}

t1.join();
t2.join(); 
```

我不认为这是一个问题，因为唯一`p_merge`可以抛出的地方是在一个`try`块内，但你也应该知道，如果一个异常离开运行的函数，`std::thread`它也会调用`std::terminate()`，所以这不是你想要的那么你应该将`noexcept`函数（或只是非抛出函数）传递给`std::thread`.

# javascript - 什么决定了 JavaScript 函数看到的 DOM（“窗口”全局）？

> ID：14408801
> 
> 赞同：0
> 
> 时间：2013-01-18T22:38:20.097
> 
> 标签：javascript, dom, iframe

我们的网络平台使用 IFrame 在桌面类型设置中托管子窗口。因为它们托管在同一个 url 上，所以这些 DOM 可以相互通信。但是，我看到一些奇怪的情况，即从一个子窗口中调用函数正在切换到全局 DOM，我试图弄清楚是什么决定了`window`全局将指向什么。

我会假设它是创建相关对象的任何 DOM，~~但这里似乎不是这种情况，因为我正在对子 DOM 中创建的对象调用函数，但它是在上下文中执行的父（全局）DOM。~~

我`window === window.top`用来确定当前上下文是子 DOM 还是顶级 DOM，并且可以准确跟踪调用切换到不同 DOM 的时间点，但我无法弄清楚是什么导致 DOM 上下文发生这种变化.

# flash - Adobe Flash - 从现有锚点开始的路径

> ID：14408805
> 
> 赞同：0
> 
> 时间：2013-01-18T22:38:39.003
> 
> 标签：flash, path, anchor, pen

如何从已关闭形状的现有锚点开始新的笔路径？(Adobe Flash)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:21:56.787

如果您刚刚绘制了形状，请取消选择它（我发现最快的方法是点击 [V] 启用选择工具，然后再次 [P] 启用笔），然后将鼠标悬停在路径上的锚点上. 您应该会看到笔光标旁边的小符号变为对角线。单击一次，然后您可以继续绘制。

# android - Android 文件写入 Null

> ID：14408817
> 
> 赞同：0
> 
> 时间：2013-01-18T22:39:55.180
> 
> 标签：android, file, null

在我的应用程序中，我根据从数据库中获得的数据计算了一些特征（平均值、最大值、分箱分布等）。但是当我尝试将这些功能写入文件时，它只显示 null 其中特定的功能变量。我看着并试图找到问题的根源，但找不到解决方案。这是我计算在文件上显示 null 的值（它仅在 binz10 上显示 null）：

```
i=1;

    first=minZ;
    next=minZ+zInterval;
    while(i<=10){
        Cursor myCursor2;
        if(i==10)
            myCursor2=db.rawQuery("SELECT * from Koordinatlar where zKoor>="+first+" AND zKoor<="+next+" AND zaman>="+firstTime+" AND zaman<="+lastTime,null);
        else
            myCursor2=db.rawQuery("SELECT * from Koordinatlar where zKoor>="+first+" AND zKoor<"+next+" AND zaman>="+firstTime+" AND zaman<="+lastTime,null);       

        myContentValues.put("binZ"+i, myCursor2.getCount());
        i++;
        first=next;
        next=next+zInterval;
    } 
```

这就是我将它写入文件（csv 格式）的地方：

```
private void dosyayaYaz(){

    Cursor dataReader;

        File myFile;  
        myFile= new File("sdcard/"+label+"-features.csv");

            try {
                myFile.createNewFile();
            FileOutputStream fOut = new FileOutputStream(myFile);
            OutputStreamWriter myOutWriter = new OutputStreamWriter(fOut);

            myOutWriter.append("ortX;ortY;ortZ;stdX;stdY;stdZ;maxX;maxY;maxZ;aadX;aadY;aadZ;averageResultantAcc;binX1;binX2;binX3;binX4;binX5;binX6;binX7;binX8;binX9;binX10;binY1;binY2;binY3;binY4;binY5;binY6;binY7;binY8;binY9;binY10;binZ1;binZ2;binZ2;binZ3;binZ4;binZ5;binZ6;binZ7;binZ8;binZ9;binZ10;label");
            myOutWriter.append("\n");

            dataReader=db.rawQuery("SELECT * FROM Features", null);

            while(dataReader.moveToNext()){

                Float ortX1=(dataReader.getFloat(dataReader.getColumnIndex("ortX")));
                Float ortY1=(dataReader.getFloat(dataReader.getColumnIndex("ortY")));
                Float ortZ1=(dataReader.getFloat(dataReader.getColumnIndex("ortZ")));
                Float maxX1=(dataReader.getFloat(dataReader.getColumnIndex("maxX")));
                Float maxY1=(dataReader.getFloat(dataReader.getColumnIndex("maxY")));
                Float maxZ1=(dataReader.getFloat(dataReader.getColumnIndex("maxZ")));
                Float stdX1=(dataReader.getFloat(dataReader.getColumnIndex("stdX")));
                Float stdY1=(dataReader.getFloat(dataReader.getColumnIndex("stdY")));
                Float stdZ1=(dataReader.getFloat(dataReader.getColumnIndex("stdZ")));
                Float aadX1=(dataReader.getFloat(dataReader.getColumnIndex("aadX")));
                Float aadY1=(dataReader.getFloat(dataReader.getColumnIndex("aadY")));
                Float aadZ1=(dataReader.getFloat(dataReader.getColumnIndex("aadZ")));

                int binX1=(dataReader.getInt(dataReader.getColumnIndex("binX1")));
                int binX2=(dataReader.getInt(dataReader.getColumnIndex("binX2")));
                int binX3=(dataReader.getInt(dataReader.getColumnIndex("binX3")));
                int binX4=(dataReader.getInt(dataReader.getColumnIndex("binX4")));
                int binX5=(dataReader.getInt(dataReader.getColumnIndex("binX5")));
                int binX6=(dataReader.getInt(dataReader.getColumnIndex("binX6")));
                int binX7=(dataReader.getInt(dataReader.getColumnIndex("binX7")));
                int binX8=(dataReader.getInt(dataReader.getColumnIndex("binX8")));
                int binX9=(dataReader.getInt(dataReader.getColumnIndex("binX9")));
                int binX10=(dataReader.getInt(dataReader.getColumnIndex("binX10")));

                int binY1=(dataReader.getInt(dataReader.getColumnIndex("binY1")));
                int binY2=(dataReader.getInt(dataReader.getColumnIndex("binY2")));
                int binY3=(dataReader.getInt(dataReader.getColumnIndex("binY3")));
                int binY4=(dataReader.getInt(dataReader.getColumnIndex("binY4")));
                int binY5=(dataReader.getInt(dataReader.getColumnIndex("binY5")));
                int binY6=(dataReader.getInt(dataReader.getColumnIndex("binY6")));
                int binY7=(dataReader.getInt(dataReader.getColumnIndex("binY7")));
                int binY8=(dataReader.getInt(dataReader.getColumnIndex("binY8")));
                int binY9=(dataReader.getInt(dataReader.getColumnIndex("binY9")));
                int binY10=(dataReader.getInt(dataReader.getColumnIndex("binY10")));

                int binZ1=(dataReader.getInt(dataReader.getColumnIndex("binZ1")));
                int binZ2=(dataReader.getInt(dataReader.getColumnIndex("binZ2")));
                int binZ3=(dataReader.getInt(dataReader.getColumnIndex("binZ3")));
                int binZ4=(dataReader.getInt(dataReader.getColumnIndex("binZ4")));
                int binZ5=(dataReader.getInt(dataReader.getColumnIndex("binZ5")));
                int binZ6=(dataReader.getInt(dataReader.getColumnIndex("binZ6")));
                int binZ7=(dataReader.getInt(dataReader.getColumnIndex("binZ7")));
                int binZ8=(dataReader.getInt(dataReader.getColumnIndex("binZ8")));
                int binZ9=(dataReader.getInt(dataReader.getColumnIndex("binZ9")));
                int binZ10=(dataReader.getInt(dataReader.getColumnIndex("binZ10")));

                String tempLabel=(dataReader.getString(dataReader.getColumnIndex("label")));

                Float averageResultantAcc1=(dataReader.getFloat(dataReader.getColumnIndex("averageResultantAcc")));

                myOutWriter.append(String.format("%f",ortX1)+";"+String.format("%f",ortY1)+";"+String.format("%f",ortZ1)+";"+String.format("%f",stdX1)+";"+String.format("%f",stdY1)+";"+String.format("%f",stdZ1)+";"+String.format("%f",maxX1)+";"+String.format("%f",maxY1)+";"+String.format("%f",maxZ1)+";"+String.format("%f",aadX1)+";"+String.format("%f",aadY1)+";"+String.format("%f",aadZ1)+";"+String.format("%f",averageResultantAcc1)+";"+String.format("%d",binX1)+";"+String.format("%d",binX2)+";"+String.format("%d",binX3)+";"+String.format("%d",binX4)+";"+String.format("%d",binX5)+";"+String.format("%d",binX6)+";"+String.format("%d",binX7)+";"+String.format("%d",binX8)+";"+String.format("%d",binX9)+";"+String.format("%d",binX10)+";"+String.format("%d",binY1)+";"+String.format("%d",binY2)+";"+String.format("%d",binY3)+";"+String.format("%d",binY4)+";"+String.format("%d",binY5)+";"+String.format("%d",binY6)+";"+String.format("%d",binY7)+";"+String.format("%d",binY8)+";"+String.format("%d",binY9)+";"+String.format("%d",binY10)+";"+String.format("%d",binZ1)+";"+String.format("%d",binZ2)+";"+String.format("%d",binZ3)+";"+String.format("%d",binZ4)+";"+String.format("%d",binZ5)+";"+String.format("%d",binZ6)+";"+String.format("%d",binZ7)+";"+String.format("%d",binZ8)+";"+String.format("%d",binZ9)+";"+String.format("%d",binZ10)+";"+tempLabel);
                myOutWriter.append("\n");

            }

            myOutWriter.close();
            fOut.close();

            Toast toast=Toast.makeText(this.myContext, "Feature'lar başarıyla üretilip dosyaya yazıldı...",Toast.LENGTH_SHORT);
            toast.show();

        } 
        catch(IOException ex){
            Toast toast=Toast.makeText(this.myContext, "Dosyaya yazma sırasında bir hata oluştu"+" "+ex.toString(),Toast.LENGTH_LONG);
            toast.show();
        }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:56:36.840

我终于可以找到解决方案了。所有的问题是我在填写文件中的功能文本时不小心。

# ios - 如何将 PFQuery 用于存储为 NSDictionary 值的 PFObject 数组

> ID：14408820
> 
> 赞同：1
> 
> 时间：2013-01-18T22:40:44.017
> 
> 标签：ios, nsdictionary, parse-platform

我在 iOS 应用程序中使用 parse.com 将数据存储到解析云服务。我在查询嵌套对象时遇到问题。我有以下数据模型：

“游戏”类包含“赢家”

"winners" 是一个数组`NSDictionary`，字典中的每一项都是 1 个玩家到 N 个权力的映射

playerPowers 值是一个**PFObjects 数组**（权力目前只有一个名称），用于**key:objectId**的玩家（PFObject）

对于每个获胜者，我向“获胜者”（可以有多个获胜者）添加一个`NSDictionary`对象，如下所示：

```
NSDictionary * winnerWithPowers = [NSDictionary dictionaryWithObject:tempPowers
                                                forKey:[aWinnerPFObject objectId]];
[newGame addObject:winnerWithPowers forKey:@"winners"]; 
```

对于字典中的每个项目，键是玩家的现有 objectId，值是`PFObjects`也在服务器上的 (powers) 数组。当我查询“获胜者”时，我想检索**所有**填充的数据、所有获胜者及其各自的权力`PFObjects`及其所有数据。当我查询“获胜者”时，每个权力的详细信息`PFObject`都不完整（key:name 的值为 null）。以下是查询，然后是打印结果的代码，然后是包含两个获胜者的字典的输出：

// 在**vi​​ewWillAppear 中：**

```
PFQuery * gamesQuery = [PFQuery queryWithClassName:@"Game"];
[gamesQuery orderByDescending:@"createdAt"];
[gamesQuery findObjectsInBackgroundWithBlock:^(NSArray * theGames, NSError * error) {
    if (error) {
        NSLog(@"ERROR: There was an error with the Query for Games!");
    } else {
        _gamesPF = [[NSMutableArray alloc] initWithArray:theGames];
        [_tableView reloadData];
    }
}]; 
```

// 在tableview **cellForRowAtIndexPath:**方法中（是我自己的TableViewController）

```
NSArray * testArray = [[_gamesPF objectAtIndex:row] objectForKey:@"winners"];
if ([testArray count] > 0) {
    // print contents of first dictionary winners entry
    NSLog(@"TestDictfromPF %@", [testArray objectAtIndex:0]);
} 
```

日志：

```
2013-01-18 09:42:26.430 GamesTourney[20972:19d03] TestDictfromPF {

jchtlqsuIY =     (
    "<Power:OlJfby1iuz:(null)> {\n}",  // problem is {\n}. Data exists on server but not in local structure after query
    "<Power:eQkMUThGOh:(null)> {\n}"   // ditto
);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T00:07:59.183

当您检索`PFObject`与其他 PFObjects（Powers 数组）相关的（Game）时，不会检索这些 Powers 的值。您将必须在后续获取请求中获取这些 Power 的所有值。

从解析文档：

> 默认情况下，在获取对象时，不会获取相关的 PFObject。这些对象的值在被获取之前无法检索，如下所示：

```
PFObject *post = [fetchedComment objectForKey:@"parent"];
[post fetchIfNeededInBackgroundWithBlock:^(PFObject *object, NSError *error) {
  NSString *title = [post objectForKey:@"title"];
}]; 
```

对 Fetch 与 Find 的说明：在 PFObjects (docs) 上调用 Fetches，[而在 PFQueries (](https://www.parse.com/docs/ios/api/Classes/PFObject.html) [docs](https://www.parse.com/docs/ios/api/Classes/PFQuery.html) )中使用 Finds 。

获取需要 PFObjects 作为输入，并且不返回任何内容。获取只是更新您已经从 Parse 检索到的 PFObjects 上的值。另一方面，Finds 将从 Parse 中检索 PFObjects。

由于您有一个 Powers 数组（它们是 PFObjects），请使用以下命令从 Parse 中检索所有值：

```
[PFObject fetchAllIfNeeded:(NSArray *)myPowers]; 
```

或者`fetchAllIfNeededInBackground:`，如果您希望它是异步的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-26T05:33:04.180

```
PFQuery *query = [PFQuery queryWithClassName:@"Cars"];
[query findObjectsInBackgroundWithBlock:^(NSArray *comments, NSError    *error) {
    for (PFObject *comment in comments)
    {
        PFObject *post = [comment objectForKey:@"name"];
        NSLog(@"%@",post); 
```

# tomcat - 如何配置Tomcat 6 使一个子目录中的JSP 文件不会被执行？

> ID：14408821
> 
> 赞同：0
> 
> 时间：2013-01-18T22:41:02.877
> 
> 标签：tomcat, tomcat6

假设我有一个在 Tomcat 6 服务器上运行的 webapp，其目录结构如下。

```
/home/
/home/css/
/home/images/
/home/inc/
/home/js/
/home/uploads/ 
```

我想禁止在 /home/uploads/ 中执行 JSP 文件，因为那里不应该有任何 JSP 文件。有没有办法在标准的 Tomcat 6 配置中做到这一点？“标准”是指不使用第 3 方附加组件或插件，仅安装基础 Tomcat。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:25:16.267

恕我直言，最好的办法是将上传目录放在 webapp 文件夹之外。

如果你真的想把它留在那里，你可以简单地向你的应用程序添加一个映射到 的 servlet 过滤器`/home/uploads`，并在 URL 以 结尾的情况下返回错误`.jsp`。

# spring - 如何将 log4j 输出重定向到我的 HttpServletResponse 输出流？

> ID：14408822
> 
> 赞同：6
> 
> 时间：2013-01-18T22:41:05.540
> 
> 标签：spring, servlets, log4j, httpresponse, outputstream

我在部署在 JBoss AS 7.1.1.Final 上的 Spring 3.1.1.RELEASE 应用程序中使用 log4j 1.2.15。我正在尝试将用 log4j 编写的输出路由到我的响应输出流。我有这样写的输出

```
private static final Logger LOG = Logger.getLogger(TrainingSessionServiceImpl.class);
…
LOG.info("Creating/updating training session associated with order #:" + order.getId()); 
```

我正在尝试像这样将它路由到我的输出流......</p>

```
@RequestMapping(value = "/refreshPd", method = RequestMethod.GET)
public void refreshPD(final HttpServletResponse response) throws IOException
{
    ...        
    final WriterAppender appender = new WriterAppender(new PatternLayout("%d{ISO8601} %p - %m%n"),response.getWriter());
    appender.setName("CONSOLE_APPENDER");
    appender.setThreshold(org.apache.log4j.Level.DEBUG);
    Logger.getRootLogger().addAppender(appender);

    worker.work();

    Logger.getRootLogger().removeAppender("CONSOLE_APPENDER"); 
```

但遗憾的是，我的浏览器没有任何输出，即使我知道（通过调试）正在调用日志记录语句。有谁知道我可以如何调整我的设置以使其正常工作？下面是我的 log4j.properties 文件，部署到我的 wAR 的 WEB-INF/classes 目录。

```
log4j.rootLogger=DEBUG, CA, FA

#Console Appender
log4j.appender.CA=org.apache.log4j.ConsoleAppender
log4j.appender.CA.layout=org.apache.log4j.PatternLayout
log4j.appender.CA.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n

#File Appender
log4j.appender.FA=org.apache.log4j.FileAppender
log4j.appender.FA.File=/usr/java/jboss/server/default/log/log4j.log
log4j.appender.FA.layout=org.apache.log4j.PatternLayout
log4j.appender.FA.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n

# Set the logger level of File Appender to WARN
log4j.appender.FA.Threshold = DEBUG 
```

谢谢， - 戴夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T11:06:53.913

这是一个有趣的问题。 **关键是编写自己的 appender**。我查找了内置的 org.apache.log4j.ConsoleAppender 代码以获取灵感。我已经在我的 tomcat 中对此进行了测试并验证了它是否有效。我使用了 log4j-1.2.17（希望没关系）

1）首先实现你自己的appender。此 appender 会将所有日志事件写入当前线程的输出流

```
package com.tstwbprj.log;

import org.apache.log4j.Layout;
import org.apache.log4j.WriterAppender;

import java.io.IOException;
import java.io.OutputStream;

public class HttpLogAppender extends WriterAppender {

    static ThreadLocal<OutputStream> streamPerHttpThread = new ThreadLocal<OutputStream>();

    public HttpLogAppender() {

    }

    public HttpLogAppender(Layout layout) {
        setLayout(layout);       //super-class method
        activateOptions();
    }

    public void setCurrentHttpStream(OutputStream stream) {
        streamPerHttpThread.set(stream);
    }

    public void activateOptions() {
        setWriter(createWriter(new CurrentHttpThreadOutStream()));
    }

    /**
     * An implementation of OutputStream that redirects to the
     * current http threads servlet output stream
     */
    private static class CurrentHttpThreadOutStream extends OutputStream {
        public CurrentHttpThreadOutStream() {
        }

        public void close() {
        }

        public void flush() throws IOException {
            OutputStream stream = streamPerHttpThread.get();
            if (stream != null) {
                stream.flush();
            }
        }

        public void write(final byte[] b) throws IOException {
            OutputStream stream = streamPerHttpThread.get();
            if (stream != null) {
                stream.write(b);
            }
        }

        public void write(final byte[] b, final int off, final int len)
                throws IOException {
            OutputStream stream = streamPerHttpThread.get();
            if (stream != null) {
                stream.write(b, off, len);
            }
        }

        public void write(final int b) throws IOException {
            OutputStream stream = streamPerHttpThread.get();
            if (stream != null) {
                stream.write(b);
            }
        }
    }
} 
```

2) 在你的 log4j 配置文件中添加这个 appender，就像其他设置一样

> log4j.rootLogger=调试，CA，FA，HA
> ..
> log4j.appender.HA= **com.tstwbprj.log.HttpLogAppender** log4j.appender.HA.layout=org.apache.log4j.PatternLayout log4j.appender.HA.layout.ConversionPattern =%-4r [%t] %-5p %c %x - %m%n

3) 在您的 servlet 中添加一小段代码，以便此附加程序正常工作。这是我的servlet。

```
import org.apache.log4j.Category;
import org.apache.log4j.Logger;
import javax.servlet.ServletOutputStream;
import java.io.IOException;

public class LogServlet extends javax.servlet.http.HttpServlet {

    private static final Logger LOG = Logger.getLogger(LogServlet.class);

    protected void doPost(javax.servlet.http.HttpServletRequest request, javax.servlet.http.HttpServletResponse response) throws javax.servlet.ServletException, IOException {

    }

    protected void doGet(javax.servlet.http.HttpServletRequest request, javax.servlet.http.HttpServletResponse response) throws javax.servlet.ServletException, IOException {
        ServletOutputStream outstream = response.getOutputStream();
        configureLogForCurrentRequest(outstream);

        LOG.info("Got request");//this is now send to the servlet output stream !!
        LOG.info("Hello!!");
        LOG.info("Done!!");
    }

    private void configureLogForCurrentRequest(ServletOutputStream outstream) {

        HttpLogAppender appender = (HttpLogAppender) LOG.getAppender("HA");
        while (appender == null) {
            Category parent = LOG.getParent();
            if (parent == null) {
                break; //This ideally shouldn't happen. Navigated all the way to root logger and still did not find appender !!..something wrong with log4j configuration setup
            }
            appender = (HttpLogAppender) parent.getAppender("HA");

        }
        appender.setCurrentHttpStream(outstream);
    }
} 
```

**注意**：这没有经过彻底测试，特别是对于多个 servlet 请求等。也不确定为什么要这样做。将日志消息通过管道传输到浏览器并不典型。谨慎行事.. :)-

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:10:10.993

尝试这样的事情：

```
Logger logger = Logger.getRootLogger();
String name = "myAppender";

Appender servletAppender = logger.getAppender(appenderName);
OutputStream out = response.getOutputStream();

if (servletAppender == null) {
    servletAppender = new WriterAppender(new PatternLayout("%d{ISO8601} %p - %m%n"), out);
    servletAppender.setName(appenderName);
    appender.setThreshold(org.apache.log4j.Level.DEBUG);
    logger.addAppender(servletAppender);
}

try {
    // Your work
    worker.work();
} finally {
    logger.removeAppender(appenderName);
    out.flush();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:58:39.287

我建议采取替代方法并将日志文件内容获取到单独的浏览器选项卡。

这不需要修改主代码，也不会破坏原始页面的格式。

一些基于 Web 的日志文件查看器链接：

*   [http://logio.org/](http://logio.org/)
*   [http://www.log-viewer.com/net-java-log4j-log-viewer/](http://www.log-viewer.com/net-java-log4j-log-viewer/)
*   [https://github.com/aroneous/Log4j-Log-Viewer](https://github.com/aroneous/Log4j-Log-Viewer)
*   [http://log2web.sourceforge.net/](http://log2web.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T17:12:20.383

这不是一个精确的答案，但我看到处理这个问题的更好方法是编写你自己的 Appender，它将收集日志到`ThreadLocal`. 在您的 servlet 请求完成时，您可以`ThreadLocal`随心所欲地将 和输出的内容排出到响应流中。

这满足了线程安全的（未说明的）要求，并且可以相当干净地将 log4j（或其他日志框架）实现代码（使用这种技术应该很小）与`ThreadLocal`.代码的区域。

许多服务器端脚本语言（例如 ColdFusion 等）都使用这种技术。

我不会讨论在应用服务器中不当使用可能*导致*的潜在错误，有一些技术可以管理这个问题，以及SO 和其他网站上的[相关答案。](https://stackoverflow.com/questions/4866006/is-it-a-good-idea-to-use-threadlocal-as-a-context-for-data)`ThreadLocal`

希望这个答案可以将您的想法重定向到稍微不同的方向！

# c# - 从静态方法更改 textBox.Text

> ID：14408831
> 
> 赞同：2
> 
> 时间：2013-01-18T22:41:58.080
> 
> 标签：c#, static, static-methods, invoke

我正在运行服务器/客户端通信。现在我想在服务器上写一些东西`textBox`并在客户端上显示，`textBox`所以我从服务器向客户端发送一条消息，客户端使用静态方法接收它：

```
 static void Client_MessageReceived(object sender, MessageEventArgs e)
    {
        //Client only accepts text messages
        var message = e.Message as ScsTextMessage;
        if (message == null)
        {
            return;
        }
    } 
```

现在我只想`textBox`通过这个静态方法将消息附加到客户端。我想我需要某种东西，但我不知道该怎么做，而且我在[Google](http://www.google.com)`invoke`上找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:10:37.187

调用方法

```
public void AppendText(string what, bool debug = false)
     {
         if (debug)
             return;
         if (this.InvokeRequired)
         {
             this.Invoke(
                 new MethodInvoker(
                 delegate() { AppendText(what); }));
         }
         else
         {
             DateTime timestamp = DateTime.Now;
             tbox.AppendText(timestamp.ToLongTimeString() + "\t" + what + Environment.NewLine);
         }
     } 
```

消息接收方法

```
 private void Client_MessageReceived(object sender, MessageEventArgs e)
        {
            //Client only accepts text messages
            var message = e.Message as ScsTextMessage;
            if (message == null)
            {
                return;
            }
            AppendText(message.Text, false);

            //Console.WriteLine("Server sent a message: " + message.Text);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:41:52.747

```
// Program.cs

public static ProgramForm Form;

publi static void Main()
{
    // ...
    Application.Run(Form = new ProgramForm());
    // ...
}

public static void ChangeText(String message)
{
    Form.TextBox1.Text = message;
}

// ProgramForm.cs

private void Client_MessageReceived(object sender, MessageEventArgs e)
{
    if (e.Message != null)
        Program.ChangeText(e.Message);
} 
```

# hyperlink - Sharepoint 2013 如何编辑应用程序的顶部链接栏的父站点链接

> ID：14408841
> 
> 赞同：1
> 
> 时间：2013-01-18T22:42:49.543
> 
> 标签：hyperlink, sharepoint-2013

我有 Sharepoint 2013 并使用开发人员站点模板创建了一个站点集，然后我部署了一个名为企业新闻应用程序的开源应用程序，该应用程序可在 codeplex 中使用，在 VS2012 中打开它，指定站点并进行部署。

当我打开应用程序（Default.aspx）时，我仍然是默认的顶部链接栏，上面有 Newsfeed、Skydrive、Sites、问号等。我看到左上角有一个带有开发者网站名称的链接“ DevSite”和左侧的箭头，表示它是一个指向父站点的链接，但它会将我重定向到应用程序的页面而不是父站点，它指向：[http://app-a909f044c27e8a。我的域名：2300](http://app-a909f044c27e8a.mydomain:2300)

关于如何修改该链接并使其正确转到父站点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T15:32:52.450

您能否截取您的网站并显示您要更改的链接位置？

尝试导航设置以更改一些链接元素：/_layouts/15/AreaNavigationSettings.aspx。

# python - 重构python：替换字符串列表中的单词列表

> ID：14408846
> 
> 赞同：1
> 
> 时间：2013-01-18T22:43:12.030
> 
> 标签：python, regex, refactoring

仍然对python有所了解，我想知道这个函数是否可以在性能或可读性方面得到改进？

```
def multi_replace_words(sentences, words, replace_str):
    """Replace all words in the sentences list with replace_str
    ex. multi_replace_words(['bad a list', 'og bad', 'in bady there bad2', 'another one', 'and bad. two'], ['bad','bad2']', 'EX')
    >> ['EX a list', 'og EX', 'in bady there EX','another one','and EX two']
    """
    docs = []
    for doc in sentences:
        for replace_me in words:
            if(replace_me in doc.encode('ascii', 'ignore')):
                doc = re.sub('((\A|[^A-Za-z0-9_])'+replace_me+'(\Z|[^A-Za-z0-9_]))', ' ' + replace_str+' ', doc)
        docs.append(doc)
    return docs 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:02:20.327

像这样的东西：

```
In [86]: def func(lis,a,b):
    strs= "|".join("({0}{1}{2})".format(r'\b',x,r'\b[;",.]?') for x in a)
    for x in lis:
        yield re.sub(strs,b,x)
   ....:         

In [87]: lis
Out[87]: ['bad a list', 'og bad', 'in bady there bad2', 'another one', 'and bad. two']

In [88]: rep=['bad','bad2']

In [89]: st="EX"

In [90]: list(func(lis,rep,st))
Out[90]: ['EX a list', 'og EX', 'in bady there EX', 'another one', 'and EX two']

In [91]: rep=['in','two','a']

In [92]: list(func(lis,rep,st))
Out[92]: ['bad EX list', 'og bad', 'EX bady there bad2', 'another one', 'and bad. EX'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:04:05.627

你可以尝试使用replace()。它作用于字符串并用另一个字符替换一系列字符的所有实例。[此处](http://www.tutorialspoint.com/python/string_replace.htm)的示例显示了替换的作用。

```
#!/usr/bin/python

str = "this is string example....wow!!! this is really string";
print str.replace("is", "was");
print str.replace("is", "was", 3); 
```

# ruby-on-rails - 访问联合表

> ID：14408852
> 
> 赞同：1
> 
> 时间：2013-01-18T22:43:55.360
> 
> 标签：ruby-on-rails, ruby, sequel

如果我有两个具有 many_to_many 关系的表：

```
DB.create_table? :students do
  primary_key    :id
  String         :name
end

DB.create_table? :books do
  primary_key    :id
  String         :title
end

DB.create_table? :students_books do
  Integer        :num_days_borrowed

  foreign_key    :student_id,
                 :students,
                 :key => :id,
                 :allow_null => false

  foreign_key    :book_id,
                 :books,
                 :key => :id,
                 :allow_null => false
end 
```

我有以下续集课程：

```
class Student < Sequel::Model(:students)
  many_to_many  :books,
                :left_key => :student_id,
                :right_key => :book_id,
                :join_table => :students_books

  def borrowed(bk)
    add_book(bk)
  end
end

class Book < Sequel::Model(:books)
  many_to_many  :books,
                :left_key  => :book_id,
                :right_key  => :student_id,
                :join_table  => :students_books
end 
```

所以，现在我可以像这样向学生添加书籍：

```
s1 = Student.create(:name => 'Hari')
b1 = Book.create(:title => 'Foundation')

s1.borrowed(b1) 
```

我的问题是如何`num_days_borrowed`使用 Sequel 模型分配值和检索属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:09:33.220

将 one_to_many 与连接模型一起使用是一种方法（正如 Threeve 所提到的），但您也可以通过添加一个选项来使用现有`many_to_many books`关联。`:select=>[:books.*, :students_books__num_days_borrowed]`然后在返回的书籍实例上，用于`book[:num_days_borrowed]`获取值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T17:08:20.997

您需要向 Sequel 提供有关您的模型的更多信息。

在您的`Student`和`Book`模型中，添加`one_to_many`这些模型和联结表之间的关系（引用联结表中的外键）。

然后创建一个`StudentsBook`模型，您将在其中设置`many_to_one`联结表和其他表之间的关系。

但首先，在联结表中设置主键：

```
DB.create_table :students_books do
  # add columns, etc
  primary_key [:student_id, :book_id]
end 
```

然后将您的模型设置为如下所示：

```
class Student < Sequel::Model(:students)
  many_to_many  :books,
                :left_key => :student_id,
                :right_key => :book_id,
                :join_table => :students_books
  one_to_many   :students_books, :key=>:student_id

  def borrowed(bk)
    add_book(bk)
  end
end

class Book < Sequel::Model(:books)
  many_to_many  :books,
                :left_key  => :book_id,
                :right_key  => :student_id,
                :join_table  => :students_books
  one_to_many   :students_books, :key=>:student_id
end

class StudentsBook < Sequel::Model(:students_books)
  many_to_one :book
  many_to_one :student
end 
```

现在您可以访问在您的联结表中找到的任何列：

```
s1 = Student.create(:name => 'Hari')
b1 = Book.create(:title => 'Foundation')

s1.add_book(b1)
s1.students_books.first[:num_days_borrowed] = 10
s1.students_books.first.save

puts StudentsBook.first.inspect
  #=> #<StudentsBook @values={:num_days_borrowed=>10, :student_id=>1, :book_id=>1}> 
```

还要注意联结表和型号名称的复数形式。当涉及到联结表时，一开始可能会有点棘手。

# c# - ReadLine 在 .NET 中的工作原理

> ID：14408857
> 
> 赞同：0
> 
> 时间：2013-01-18T22:44:20.100
> 
> 标签：c#, memory, memory-management

假设我有一个 1 GB 的文本文件，我想阅读它。如果我尝试打开此文件，我会收到“内存溢出”错误。我知道，通常的答案是“使用 StreamReader.ReadLine() 方法”。但我想知道这是如何工作的。如果使用 ReadLine 方法的程序想要获取一行，它迟早要打开整个文本文件。据我所知，文件存储在磁盘上，可以按照“全有或全无”的原则在内存中打开它们。如果使用 ReadLine() 方法一次只将我的 1 GB 文本文件的一行存储在内存中，这意味着我们必须在读取 1 GB 文本文件的每一行时为它进行磁盘 IO。这对性能来说不是一件可怕的事情吗？

我很困惑，我想要一些关于这个的细节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:57:00.327

> 这意味着我们必须为我的 1 GB 文本文件的每一行磁盘 IO

不，您的 ReadLine() 调用和物理磁盘之间有很多层，旨在不造成问题。最重要的是：

*   FileStream 是为 StreamReader 执行工作的基础类，它使用缓冲区来减少 ReadFile() 调用的数量。默认大小为 4096 字节
*   ReadFile() 从文件系统缓存而不是磁盘读取文件数据。这*可能会*导致调用磁盘驱动程序，但这并不常见。操作系统足够聪明，可以猜测您可能会从文件中读取*更多*数据并从磁盘中预读取数据，只要这样做成本低且 RAM 不用于其他任何用途。它通常会消耗整个磁盘柱面的数据。
*   磁盘驱动器本身也有一个缓存，通常是几兆字节。

文件系统缓存是迄今为止最重要的一个。这也是一个棘手的问题，因为它会阻止您准确地分析您的程序。当您一遍又一遍地运行测试时，您的程序实际上*从不*从磁盘读取，而只是从缓存中读取。这使它变得不切实际地快。尽管 1 GB 的文件可能不太适合，但取决于您的机器中有多少 RAM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:48:59.210

通常在幕后`FileStream`打开一个对象，该对象从磁盘读取文件的大块并将其拉入内存。该块充当`cache`ReadLine() 的读取对象，因此您不必担心每个 ReadLine() 都会导致磁盘访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:58:54.167

可怕的事情是为了表现什么？

显然它应该更快，因为您有可用的内存来处理内存中的整个文件。

但是，查找和分配一个连续的块是有代价的。

演出是一个重要的内存块，如果你的进程有它，有什么伤害？

交换比流媒体更容易受到伤害。

您是否一次需要所有文件，您是否一直需要它？

如果你去读/写。那会对你有什么影响？

如果文件转到 2 gig 怎么办？

您可以针对一个因素进行优化。在你这样做之前，你必须确保它是正确的，最重要的是你必须记住这是一台真正的机器。你的资源是有限的，所以优化总是让彼得付钱给保罗。彼得可能会生气...

# php - $this 是对对象的引用吗？

> ID：14408862
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:44:49.623
> 
> 标签：php

我知道这“指”了当前对象，但它不是实际对象。究竟如何`$this`指代对象。是`$this`指向对象的指针吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:49:10.903

`$this`是一个[参考](http://php.net/manual/en/language.references.php)。来自 PHP 手册：

> PHP 中的引用是一种通过不同名称访问相同变量内容的方法。它们不像 C 指针；例如，您不能使用它们执行指针运算，它们不是实际的内存地址，等等。有关更多信息，请参阅[什么不是参考](http://php.net/manual/en/language.references.arent.php)。相反，它们是符号表别名。注意在PHP中，变量名和变量内容是不同的，所以同样的内容可以有不同的名字。最接近的类比是 Unix 文件名和文件 - 变量名是目录条目，而变量内容是文件本身。引用可以比作​​ Unix 文件系统中的硬链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:46:28.597

从[手册](http://www.php.net/manual/en/language.oop5.basic.php)：

> 当从对象上下文中调用方法时，伪变量 $this 可用。$this 是对调用对象的引用（通常是方法所属的对象，但也可能是另一个对象，如果该方法是从辅助对象的上下文中静态调用的）。

[引用不是指针](http://php.net/manual/en/language.references.arent.php)

# ruby-on-rails - 对两个不同的对象使用相同的“投票”控制器动作

> ID：14408866
> 
> 赞同：0
> 
> 时间：2013-01-18T22:45:11.020
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正在关注 schneems关于创建 Reddit 克隆的[Rails 教程](https://github.com/schneems/reddit_on_rails/blob/master/part_two_comments_and_votes.md)的精彩介绍，并希望扩展“投票”结构，不仅可以用于问题，还可以用于评论，并且很难弄清楚如何传递到控制器`question_id`因此`comment_id`它可以相应地投票赞成或反对，而不是将使用限制为仅`question_id`.

目前， my 中只有一个`create`函数`VotesController`，定义如下：

```
 def create
    @vote = Vote.where(:question_id => params[:vote][:question_id], :user_id => current_user.id).first #the question_id is baked right in.. 
    if @vote
      @vote.up = params[:vote][:up]
      @vote.save
    else
      @vote = current_user.votes.create(params[:vote])
    end
    redirect_to :back
  end 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:00:06.993

好吧，当您尝试对评论进行投票时，这意味着它`params[:vote]`应该包含 a`:comment_id`而不是 a `:question_id`，对吗？

所以你的`where`陈述需要要么是

```
# for a question
where(:question_id => params[:vote][:question_id], :user_id => current_user.id)

# for a comment
where(:comment_id => params[:vote][:comment_id], :user_id => current_user.id) 
```

您可以通过各种方式来解决此问题，例如通过检查 if `params[:vote].has_key?(:question_id)`，但一个简单的选择是使用[`Hash#slice`](http://api.rubyonrails.org/classes/Hash.html#method-i-slice)：

```
where(params[:vote].slice(:question_id, :comment_id).merge(:user_id => current_user.id)) 
```

# linux - Linux 无法删除（rm）文件

> ID：14408870
> 
> 赞同：0
> 
> 时间：2013-01-18T22:45:41.330
> 
> 标签：linux, shell

我正在尝试删除一个包含空格的文件，但它不起作用。

```
hw1:84$ ls
hw yoyo ~  misc.ml  test.ml
hw1:85$ rm hw yoyo ~
rm: cannot remove `hw': No such file or directory
rm: cannot remove `yoyo': No such file or directory
rm: cannot remove `/home/linux/ieng6/cs130w/cs130wau': Is a directory 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T22:47:55.063

如果文件是，`hw yoyo ~`那么您需要引用它，否则`rm`将尝试删除三个单独*的（不存在或更糟糕的存在）*文件：

```
rm "hw yoyo ~" 
```

文件名中的空格通常不是一个好主意，`~`与空格结合起来简直是愚蠢的！您最终会在某个时候删除您的主目录。

由于文件在当前目录`hw`中`yoyo`不存在，您会收到错误消息：

```
rm: cannot remove `hw': No such file or directory
rm: cannot remove `yoyo': No such file or directory 
```

该文件`~`也不存在于当前目录中，但`~`它是您主目录的别名，因此您会看到不同的错误消息：

```
rm: cannot remove `/home/linux/ieng6/cs130w/cs130wau': Is a directory 
```

您很幸运，默认情况下`rm`不会删除没有该`-r`选项的目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T22:54:15.383

当文件名中有空格等特殊字符时，文件名必须放在引号字符内。处理此问题的另一种方法是转义名称中的特殊字符。

所以，使用报价方法你应该这样做：

```
rm 'hw yoyo ~' 
```

并使用转义方法，您将执行以下操作：

```
rm hw\ yoyo\ ~ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T23:05:38.763

告诉您引用文件名或转义特殊字符的答案是正确的。

此外，如果您的 shell 支持它，您可以使用文件名完成（只要文件名不以特殊字符*开头）。*例如：

```
$ ls
hw yoyo ~
$ rm h<Tab> 
```

键入`rm h`，然后`Tab`，shell 会将其扩展为给定可用文件名的最长唯一前缀。如果这是当前目录中唯一名称以 . 开头的文件`h`，它将扩展为整个名称，并*正确转义*. 击中后`Tab`，我看到：

```
rm hw\ yoyo\ ~ 
```

我可以点击`Enter`删除文件。

或者我可以从引用名称开始：

```
$ rm 'h<Tab> 
```

扩展为：

```
$ rm 'hw yoyo ~' 
```

它甚至会在必要时结合引用和转义：

```
$ touch 'foo$bar'
$ rm "f<Tab> 
```

扩展为：

```
$ rm "foo\$bar" 
```

如果您的 shell 可以为您记住引用规则，那么它会比您自己记住它们更快、更容易——即使您已经知道它们。

以上适用于 bash。它也可能适用于其他现代外壳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:49:31.813

```
rm "hw yoyo ~"

or 

rm hw\ yoyo\ ~ 
```

**在某些特殊情况下，使用单引号。**

例如

```
kent$  l
total 0
-rw-r--r-- 1 kent kent 0 Jan 18 23:54 a b $HOME

kent$  rm "a b $HOME"
rm: cannot remove ‘a b /home/kent’: No such file or directory

kent$  rm 'a b $HOME'

kent$  l
total 0 
```

# python - 如何在 Python 中进行适当的 Cholesky 分解

> ID：14408873
> 
> 赞同：4
> 
> 时间：2013-01-18T22:46:18.350
> 
> 标签：python, numpy, scipy

我正在尝试进行适当的 Cholesky 分解，但是该功能实际上并未在 scipy 中实现，或者有些我不理解。我在这里发帖以防是后者。这是我正在做的一个简化示例：

```
import numpy
import scipy.linalg

numpy.random.seed(0)
X = numpy.random.normal(size=(10,4))
V = numpy.dot(X.transpose(),X)
R = V.copy()
scipy.linalg.cholesky(R,False,overwrite_a=True)
print V
print R 
```

我认为应该发生的是 R 被上三角矩阵覆盖。然而，当我运行这段代码时，我的 V 和 R 是相同的（cholesky 没有覆盖 R）。我是误解了overwrite_a的目的，还是犯了其他错误？如果这只是 scipy 中的一个错误，是否有解决方法或其他方法可以在 Python 中进行适当的 Cholesky 分解？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:56:29.760

再试一次，用

```
>>> scipy.__version__
'0.11.0'
>>> np.__version__
'1.6.2' 
```

它完美地工作：

```
X = np.random.normal(size=(10,4))
V = np.dot(X.transpose(),X)
print V
R = V.copy()
print R
C = scipy.linalg.cholesky(R,False,overwrite_a=True)
print V
print R 
```

输出是：

```
[[ 11.22274635   5.10611692   0.70263037   3.14603088] # V before
 [  5.10611692   8.94518939  -3.17865941   1.64689675]
 [  0.70263037  -3.17865941   7.35385131  -2.23948391]
 [  3.14603088   1.64689675  -2.23948391   8.25112653]]
[[ 11.22274635   5.10611692   0.70263037   3.14603088] # R before
 [  5.10611692   8.94518939  -3.17865941   1.64689675]
 [  0.70263037  -3.17865941   7.35385131  -2.23948391]
 [  3.14603088   1.64689675  -2.23948391   8.25112653]]
[[ 11.22274635   5.10611692   0.70263037   3.14603088] # V after
 [  5.10611692   8.94518939  -3.17865941   1.64689675]
 [  0.70263037  -3.17865941   7.35385131  -2.23948391]
 [  3.14603088   1.64689675  -2.23948391   8.25112653]]
[[ 3.35003677  1.52419728  0.20973811  0.93910339] # R after
 [ 0\.          2.57332704 -1.35946252  0.08375069]
 [ 0\.          0\.          2.33703292 -0.99382158]
 [ 0\.          0\.          0\.          2.52478036]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T22:03:51.800

为了完整起见，以下基于 Warren 注释的代码解决了该问题：

```
import numpy
import scipy.linalg

numpy.random.seed(0)
X = numpy.random.normal(size=(10,4))
V = numpy.dot(X.transpose(),X)
R = V.copy('F')
print V.flags['C_CONTIGUOUS']
print R.flags['F_CONTIGUOUS']
scipy.linalg.cholesky(R,False,overwrite_a=True)
print V
print R 
```

我所做的只是将 R 的底层存储格式从 C 顺序更改为 Fortran 顺序，这会导致`overwrite_a`按预期运行。

如果您的矩阵是真正有价值的，您可以通过简单地将转置传递给 cholesky 来执行此操作而无需复制。如果您的矩阵是复值矩阵，我认为转置修复将不起作用，因为复数厄米矩阵的转置通常不等于其共轭转置。但是，如果您确保您的矩阵首先使用 fortran order ( `R.flags['F_CONTIGUOUS'] == True`)，那么您应该没有问题。但是，请参阅[在 Numpy 中设置 *default* 数据​​顺序（C 与 Fortran）以](https://stackoverflow.com/questions/7911041/setting-the-default-data-order-c-vs-fortran-in-numpy)了解该策略的困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T12:02:18.530

如果您足够勇敢，您可以避免`scipy`并进行低级别呼叫`linalg.lapack_lite.dpotrf`

```
import numpy as np

# prepare test data
A = np.random.normal(size=(10,10))
A = np.dot(A,A.T)
L = np.tril(A)

# actual in-place cholesky
assert L.dtype is np.dtype(np.float64)
assert L.flags['C_CONTIGUOUS']
n, m = L.shape
assert n == m
result = np.linalg.lapack_lite.dpotrf('U', n, L, n, 0)
assert result['info'] is 0

# check if L is the desired L cholesky factor
assert np.allclose(np.dot(L,L.T), A)
assert np.allclose(L, np.linalg.cholesky(A)) 
```

您必须了解 lapack 的[DPOTRF](http://www.netlib.org/lapack/double/dpotrf.f)、fortran 调用约定、内存布局。不要忘记在退出时检查`result['info'] == 0`。尽管如此，您会看到它只是一行代码，并且通过丢弃所有完整性检查和`linalg.cholesky`由此完成的复制也可能更有效。

# r - R中整数数据频率的可视化

> ID：14408886
> 
> 赞同：3
> 
> 时间：2013-01-18T22:47:40.033
> 
> 标签：r, plot, integer, histogram

当我尝试使用*histogram(mydata,breaks=c(0,n))*可视化我的整数数据时，R 通常不关心我使用了多少个中断（通常每个样本 1 个条），它绘制 n-1 个条（前两个小节相加为一个）。

在大多数情况下，我使用*barplot(table(mydata))*

还有另一种方法可以做到这一点 [如何在R中分离直方图最左边的两个箱，](https://stackoverflow.com/questions/14392647/how-to-separate-the-two-leftmost-bins-of-a-histogram-in-r) 但我认为它不是“清晰”的方式。

那么如何可视化整数数据的频率呢？哪一个是对的？

十分感谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T22:55:53.010

```
hist(dataset, breaks=seq(min(dataset)-0.5, max(dataset)+0.5, by=1)  ) 
```

另一种选择（对于那些你*知道*这些是整数的情况是：

```
require(lattice) 
barchart(table(dataset), horizontal=FALSE) 
```

或者：

```
barplot(table(dataset)) 
```

# java - 在 Android 中如何添加 user_photos 权限以获取 facebook 相册照片？

> ID：14408889
> 
> 赞同：3
> 
> 时间：2013-01-18T22:47:56.867
> 
> 标签：java, android, facebook, facebook-graph-api

我正在使用 facebook android sdk 访问用户的 facebook 相册和实习生获取照片。但是当我这样做时，`"https://graph.facebook.com/"+wallAlbumID+"/photos?access_token="+facebook.getAccessToken()`它会返回空白数据。`{ "data": [] }`

我[在 stackoverflow question](https://stackoverflow.com/questions/3706678/fetch-photos-from-facebook-album-in-android)和[Graph API for Photo](https://developers.facebook.com/docs/reference/api/photo/)中阅读了我需要`user_photos`在创建 facebook 对象时授予权限。我不知道该怎么做。我阅读了很多论坛并检查了 SOF，但找不到解决方案。

这就是我创建 facebook 对象的方式

```
facebook = new Facebook(APP_ID); 
```

谁能帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:59:53.403

您需要创建一个`ArrayList`要访问的权限。例如，当我这样做时，在声明变量时。

```
private static final String[] PERMISSIONS = { "user_photos" }; 
```

然后，在实现用户登录区时：

```
if (!facebook.isSessionValid()) {
    facebook.authorize(this, PERMISSIONS, new LoginDialogListener());
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-13T19:21:10.937

您需要使用 Facebook SDK 3.0+。此外，在 FB 站点的开发人员设置中启用**OAuth 客户端登录流程**。然后您可以使用以下代码：

1.  首先，将用户登录到应用程序内的 FB 以获取 Session 对象，然后请求 user_photos 的权限（如果尚未授予）：

    ```
    // start Facebook Login
    Session.openActiveSession(this, true, new Session.StatusCallback() {

        // callback when session changes state
        @Override
        public void call(Session session, SessionState state, Exception exception) {
            if (session.isOpened()) {
                // check for permission to see user photos
                if (!hasPhotoPermissions())
                    session.requestNewPublishPermissions(new Session.NewPermissionsRequest(MyActivity.this, "user_photos"));

                else {
                    // photos permission granted, fetch user's albums
                    fetchAlbumsFromFB(session);
                }
            }
        }
    }); 
    ```

2.  这是**hasPhotoPermissions()**方法的样子：

    ```
    private boolean hasPhotoPermissions() {
        Session session = Session.getActiveSession();
        return session.getPermissions().contains("user_photos");
    } 
    ```

3.  然后，您的应用程序将向用户显示照片权限屏幕以供批准。

# javascript - GetElementByID - 多个 ID

> ID：14408891
> 
> 赞同：40
> 
> 时间：2013-01-18T22:48:00.263
> 
> 标签：javascript, arrays, get, element, document

```
doStuff(document.getElementById("myCircle1" "myCircle2" "myCircle3" "myCircle4")); 
```

这不起作用，所以我需要一个逗号或分号来完成这项工作吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-18T22:49:12.320

`document.getElementById()`一次只支持一个名称，并且只返回一个节点而不是节点数组。您有几种不同的选择：

1.  您可以实现自己的函数，该函数接受多个 id 并返回多个元素。
2.  您可以使用[`document.querySelectorAll()`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)它允许您在 CSS 选择器字符串中指定多个 id。
3.  您可以在所有这些节点上放置一个通用类名并`document.getElementsByClassName()`与单个类名一起使用。

每个选项的示例：

```
doStuff(document.querySelectorAll("#myCircle1, #myCircle2, #myCircle3, #myCircle4")); 
```

或者：

```
// put a common class on each object
doStuff(document.getElementsByClassName("circles")); 
```

或者：

```
function getElementsById(ids) {
    var idList = ids.split(" ");
    var results = [], item;
    for (var i = 0; i < idList.length; i++) {
        item = document.getElementById(idList[i]);
        if (item) {
            results.push(item);
        }
    }
    return(results);
}

doStuff(getElementsById("myCircle1 myCircle2 myCircle3 myCircle4")); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-18T22:49:22.457

这不起作用，`getElementById`只会按时间查询一个元素。

您可以`document.querySelectorAll("#myCircle1, #myCircle2")`用于查询多个元素。

## ES6 或更新版本

使用新版本的 JavaScript，您还可以将结果转换为数组以轻松遍历它。

例子：

```
const elementsList = document.querySelectorAll("#myCircle1, #myCircle2");
const elementsArray = [...elementsList];

// Now you can use cool array prototypes
elementsArray.forEach(element => {
    console.log(element);
}); 
```

## 如何在 ES6 中查询 ID 列表

如果您有一组 ID，另一种简单的方法是使用该语言来构建您的查询，例如：

```
const ids = ['myCircle1', 'myCircle2', 'myCircle3'];
const elements = document.querySelectorAll(ids.map(id => `#${id}`).join(', ')); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-18T22:49:18.433

## 不，这行不通。

[`document.getElementById()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)方法只接受一个参数。

但是，您可以始终将类设置为元素并[`getElementsByClassName()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)改为使用。现代浏览器的另一个选择是使用[`querySelectorAll()`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)方法：

```
document.querySelectorAll("#myCircle1, #myCircle2, #myCircle3, #myCircle4"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-03T18:49:54.133

我建议使用 ES5 数组方法：

```
["myCircle1","myCircle2","myCircle3","myCircle4"] // Array of IDs
.map(document.getElementById, document)           // Array of elements
.forEach(doStuff); 
```

然后`doStuff`将为每个元素调用一次，并将接收 3 个参数：元素、元素数组中的元素索引和元素数组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-18T22:50:16.190

`getElementByID`就是这样 - 通过 id 获取元素。

也许你想给这些元素一个`circle`类[`getElementsByClassName`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-18T22:51:21.433

`document.getElementById()`只接受一个论点。你可以给他们一个类名并使用`getElementsByClassName()`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-20T20:24:49.007

您可以使用类似这样的 whit 数组和 for 循环。

```
<p id='fisrt'>??????</p>
<p id='second'>??????</p>
<p id='third'>??????</p>
<p id='forth'>??????</p>
<p id='fifth'>??????</p>
<button id="change" onclick="changeColor()">color red</button>
<script>

    var ids = ['fisrt','second','third','forth','fifth'];

    function changeColor() {
        for (var i = 0; i < ids.length; i++) {
          document.getElementById(ids[i]).style.color='red';
 }
    }
</script> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-14T05:00:15.983

最好的方法是定义一个函数，并传递一个你想从 DOM 中获取的 ID 名称的参数，然后每次你想获取一个 ID 并将其存储在一个数组中，然后你可以调用函数

```
<p id="testing">Demo test!</p>

function grabbingId(element){
    var storeId = document.getElementById(element);

    return storeId;
}

grabbingId("testing").syle.color = "red"; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-15T09:39:26.547

不知道如果这样的东西在我经常使用的 js、PHP 和 Python 中有效，这是可能的。也许只是使用 for 循环，如：

```
function doStuff(){
    for(i=1; i<=4; i++){
        var i = document.getElementById("myCiricle"+i);
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-02-09T14:53:18.133

Vulgo 在这个线程上有正确的想法。我相信他的解决方案是最简单的，尽管他的回答可能更深入一点。这是对我有用的东西。我已经提供了一个例子。

```
<h1 id="hello1">Hello World</h1>
<h2 id="hello2">Random</h2>
<button id="click">Click To Hide</button>

<script>

  document.getElementById('click').addEventListener('click', function(){
    doStuff();
  });

  function doStuff() {
    for(var i=1; i<=2; i++){
        var el = document.getElementById("hello" + i);
        el.style.display = 'none';
    }
  }

</script> 
```

显然，只需更改 for 循环中的整数以说明您要定位的元素数量，在此示例中为 2。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-28T16:30:42.887

使用 jQuery 或类似工具，只需一句话即可访问元素集合。当然，您需要在 html 的“head”部分中添加类似这样的内容：

> ```
> <script type='text/javascript' src='url/to/my/jquery.1.xx.yy.js' ...> 
> ```

所以这里是魔法：

.-首先让我们假设你有一些带有你写的ID的div，即

> ```
>  ...some html...
>  <div id='MyCircle1'>some_inner_html_tags</div>
>  ...more html...
>  <div id='MyCircle2'>more_html_tags_here</div>
>  ...blabla...
>  <div id='MyCircleN'>more_and_more_tags_again</div>
>  ...zzz... 
> ```

.- 使用这个'spell' jQuery 将返回代表所有 div 元素的对象集合，其 ID 在任何地方都包含整个字符串“myCircle”：

> ```
>  $("div[id*='myCircle']") 
> ```

这是所有的了！请注意，您摆脱了诸如数字后缀之类的细节，您可以在一个句子中操作所有 div，为它们设置动画......瞧！

> ```
>  $("div[id*='myCircle']").addClass("myCircleDivClass").hide().fadeIn(1000); 
> ```

立即在浏览器的脚本控制台中证明这一点（按 F12）！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-30T10:13:20.450

对我来说，像这样完美无瑕

```
doStuff(

    document.getElementById("myCircle1") ,

    document.getElementById("myCircle2") ,

    document.getElementById("myCircle3") ,

    document.getElementById("myCircle4")

); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-02-13T17:45:54.957

正如jfriend00所说，

> document.getElementById() 一次只支持一个名称，并且只返回一个节点而不是节点数组。

但是，这是我创建的一些示例代码，您可以提供一个或逗号分隔的 id 列表。它会给你一个或多个数组中的元素。如果有任何错误，它将返回一个带有 Error 作为唯一条目的数组。

```
function safelyGetElementsByIds(ids){
    if(typeof ids !== 'string') return new Error('ids must be a comma seperated string of ids or a single id string');
    ids = ids.split(",");
    let elements = [];
    for(let i=0, len = ids.length; i<len; i++){
        const currId = ids[i];
        const currElement = (document.getElementById(currId) || new Error(currId + ' is not an HTML Element'));
        if(currElement instanceof Error) return [currElement];
        elements.push(currElement);
    };
    return elements;
}

safelyGetElementsByIds('realId1'); //returns [<HTML Element>]
safelyGetElementsByIds('fakeId1'); //returns [Error : fakeId1 is not an HTML Element]
safelyGetElementsByIds('realId1', 'realId2', 'realId3'); //returns [<HTML Element>,<HTML Element>,<HTML Element>]
safelyGetElementsByIds('realId1', 'realId2', 'fakeId3'); //returns [Error : fakeId3 is not an HTML Element] 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-07-18T06:32:15.207

这是解决方案

```
if (
  document.getElementById('73536573').value != '' &&
  document.getElementById('1081743273').value != '' &&
  document.getElementById('357118391').value != '' &&
  document.getElementById('1238321094').value != '' &&
  document.getElementById('1118122010').value != ''
  ) {
code
  } 
```

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2014-10-15T13:44:51.423

你可以用 document.getElementByID 来做这就是方法。

```
function dostuff (var here) {
  if(add statment here) {
  document.getElementById('First ID'));
  document.getElementById('Second ID'));
  }
} 
```

给你！xD

# java - 从超类构造子类

> ID：14408895
> 
> 赞同：0
> 
> 时间：2013-01-18T22:48:43.010
> 
> 标签：java, casting, subclass, wrapper, superclass

这一切都在 JBox2D 的上下文中（在 Java 中）。World 类使用函数创建 Body 实例。我正在尝试为我的应用程序向 Body 添加更多内容。在这个问题中，主体由 ComplexClassWithLotsOfAPI 表示。

这是一个笼统的问题。我试图通过扩展类来为预制类添加更多功能。我希望做这样的事情：

```
class SomeMore extends ComplexClassWithLotsOfAPI{
    int myExtraInt;
    //A bit more API functions
} 
```

这样我就可以这样做：

```
SomeMore sm=new SomeMore();
sm.someOldAPI();
sm.butAlsoMyNewAPI(); 
```

问题是这个 ComplexClassWithLotsOfAPI 是由另一个我无法修改的类（原始上下文中的 World 类）创建的，所以我不是简单地自己创建它们（否则这会起作用）。由于我不得不从 ComplexClassWithLotsOfAPI 开始，我一直在寻找一种从 SuperClass*构造*SubClass 的方法，而有许多将 SuperClass*转换*为 Subclass 的示例（但这在这里不适用）。下面是一个需要完成的功能示例：

```
public SomeMore create(...){ 
    ComplexClassWithLotsOfAPI ccwlao=myWorld.create(...);
    SomeMore sm;
    //??
    return sm;
} 
```

**包装的替代品？** 我最初的解决方案是将 ComplexClassWithLotsOfAPI 封装到我自己的类中。为了构造我的新类，我只需将旧类传递给我的新构造函数并继续：

```
class SomeMore{
    public ComplexClassWithLotsOfAPI ccwloa;
    int myExtraInt;
    public SomeMore(ComplexClassWithLotsOfAPI nccwloa){
        ccwloa=nccwloa;
        myExtraInt=0;
    }
    //A bit more API functions
}
public SomeMore create(...){ 
    ComplexClassWithLotsOfAPI ccwlao=myWorld.create(...);
    SomeMore sm=new SomeMore(ccwlao);
    return sm;
    //OR more simply
    //return new SomeMore(myWorld.create(...));
} 
```

但为了访问旧 API，我需要这样做：

```
SomeMore sm=new SomeMore();
sm.ccwloa.someOldAPI();
sm.butAlsoMyNewAPI(); 
```

我可能有点不合理，但是这种功能很乏味，并且给不需要它的东西增加了更多的复杂性。我的意思是，如果有人想添加更多功能，他们会将我的类包装到另一个类中，并通过 3 个类层次结构来获取旧 API？此外，将旧类中的每个 API 都包装到我的新类中会感觉很浪费（其中有很多）。

```
sm.someOldAPIButWrappedInMyClass(); //not desirable 
```

我无法访问 ComplexClassWithLotsOfAPI 的 java 文件，只能访问已编译的类文件。我不能简单地将我的修改强加到旧类中（即使可以，我也不想这样做）。我对java比较陌生，所以也许这不是最好/正确的方法，但我一直无法找到替代方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:54:39.857

Eclipse 可以为您构建一个委托类，它是某个类（即父类）的子类，并在字段中保存一个“父类”实例（称为受委托者），并生成覆盖“父类”中所有方法的方法，并调用受委托人中的相同方法。然后，您可以添加自己的方法。

您可以从上下文菜单 Source 选项中执行此操作，生成委托方法。您必须拥有子类并让它扩展“Parent”并拥有“Parent”类型的字段才能让代码生成器工作。

这是一个例子：

```
/** Example class delegating to a contained variable */
public class DelegatingComparator implements Comparator<String> {
    // Delegatee has to be present before letting Eclipse generate
    private Comparator<String> delegatee;

    /** My own method extends Comparator methods */
    public int compareToFoo(String o1) {
        return compare(o1, "foo");
    }

    /** Generated by Eclipse. Source > Generate getters and setters */
    public void setDelegatee(Comparator<String> delegatee) {
        this.delegatee = delegatee;
    }

    /** Generated by Eclipse. Source > Generate Delegate Methods */
    public int compare(String o1, String o2) {
        return delegatee.compare(o1, o2);
    }

    /** Generated by Eclipse. Source > Generate Delegate Methods */
    public boolean equals(Object obj) {
        return delegatee.equals(obj);
    }

} 
```

# python - 在下载完成之前开始观看下载

> ID：14408899
> 
> 赞同：2
> 
> 时间：2013-01-18T22:49:03.373
> 
> 标签：python, download

> **可能重复：**
> [如何从 Python 异步运行外部命令？](https://stackoverflow.com/questions/636561/how-can-i-run-an-external-command-asynchronously-from-python)

到目前为止，我的代码将下载文件然后播放。我想做的是开始下载文件，然后说 30 秒后开始观看下载。

这是代码：

```
urllib.urlretrieve(url2, "/hdd/movie/movie"))
sleep(30)
self.session.open(MoviePlayer, sref) 
```

环顾四周，我认为这可能有效；

```
os.spawnl(os.P_NOWAIT, urllib.urlretrieve(url2, "/hdd/movie/movie"))
sleep(30)                
self.session.open(MoviePlayer, sref) 
```

但这完全一样，并在播放前完成下载

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T02:03:59.513

如果您想在下载完成之前开始观看电影，您需要使用一种方法来部分下载您的文件，并且最重要的是，刷新写入。使用的代码以`urlretrieve`缓冲的方式写入数据，因此不能立即使用。

以下是一些基本代码来执行此操作：

```
import sys
import urllib2
import subprocess

url = sys.argv[1]
outname = sys.argv[2]

response = urllib2.urlopen(url)
output = open(outname, 'wb')

chunk_bytesize = 1024 * 1024

data = response.read(chunk_bytesize)
output.write(data)
output.flush()

# Now you can call your movie player.
subprocess.Popen(["open", outname])

# Read the rest of the data.
while True:
    print "Data.."
    data = response.read(chunk_bytesize)
    if not data:
        break
    output.write(data)
    output.flush()

response.close()
output.close() 
```

在这种情况下，指定程序在第一个块被读取后启动。您可以增加块的大小或在读取几个块后启动它。

# c++ - 为什么我不能得到 std::function ::iterator> 绑定到返回该类型的 lambda？

> ID：14408905
> 
> 赞同：0
> 
> 时间：2013-01-18T22:49:16.377
> 
> 标签：c++

我不明白为什么这不起作用。我有一个返回`std::find`方法结果的函数。我读到它返回一个迭代器到它找到的对象。但是当我尝试传递返回该值的 lambda 时，它给了我一堆错误，为什么？

```
void f(std::function<std::vector<int>::iterator()>) {}

int main()
{
    std::vector<int> v{0, 1, 2, 3};

    auto p = [=] (int n) {
        return std::find(v.begin(), v.end(), n);
    };

    f(p);
} 
```

我得到了很多难以理解的错误。我什至在这里进行了类型检查，结果返回 true：

```
std::is_same<std::vector<int>::iterator, decltype(std::find(v.begin(), v.end(), N))>::value;
// -> true 
```

`f`那么，当我将一个函数传递给`std::function`返回这种类型的函数时，为什么这不起作用呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T23:03:03.967

假设`int`参数中缺少的`std::function`参数是复制粘贴错误，显然是返回s`v.begin()`而不是普通的迭代器。`v.end()``const_iterator`

这是因为您的 lambda 是按值捕获的，从而生成了您的`std::vector` `const`（以及它的迭代器）。[通过](http://ideone.com/Qrn9be)引用捕获所有内容，否则，您`std::function`应该返回`const_iterator`：

```
#include <vector>
#include <functional>
#include <algorithm>

void f(std::function<std::vector<int>::iterator (int)>) {}

int main()
{
    std::vector<int> v{0, 1, 2, 3};

    auto p = [&] (int n) {
        return std::find(v.begin(), v.end(), n);
    };

    f(p);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T23:05:05.653

当您按值捕获时，默认情况下捕获的`vector`（和关联的迭代器）是`const`。如果您希望它是可变的，则需要更改 lambda：

```
auto p = [=] (int n) mutable {
    return std::find(v.begin(), v.end(), n);
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:58:10.590

因为 f 需要一个不带参数的函数，但是您的 lambda 有一个 int 参数。

# php - 无法将 JSON 响应发布到服务器

> ID：14408909
> 
> 赞同：1
> 
> 时间：2013-01-18T22:49:42.633
> 
> 标签：php, json, post, http-post

我正在使用 API 允许我向特定号码发送文本消息，然后它将该文本信息作为 JSON 响应发布到我的服务器。它让我配置了回调 url，它正在向它发布一些东西。这就是我被告知电话的样子：

```
POST /business/getSMS HTTP/1.1
x-hookmobile-message-id: 297173743
User-Agent: Jakarta Commons-HttpClient/3.1
Host: testing.com
Content-Length: 152
Content-Type: text/plain; charset=UTF-8

{
  "timestamp":"Fri Jan 18 21:56:32 GMT 2013",
  "text":"Test",
  "from":"+11111111111",
  "messageId":"297173743",
  "type":"incomingSms",
  "recipient":"+11111111111"
} 
```

我无法弄清楚的是如何在 PHP 中获取 JSON 响应。我尝试 $_POST 只是为了查看发布的数据是否存在，但我什么也没得到。这是我第一次这样做，所以我在这里有点茫然。如何获取发布的 json？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:56:44.380

您必须阅读原始帖子数据。

```
$postdata = file_get_contents("php://input");
$obj = json_decode($postdata);
//$obj->timestamp == "Fri Jan 18 21:56:32 GMT 2013" etc 
```

# iframe - youtube iframe api的替代品？

> ID：14408910
> 
> 赞同：1
> 
> 时间：2013-01-18T22:49:46.153
> 
> 标签：iframe, youtube-api, swfobject

我放弃了使用 youtube iframe api。我将它与 asp.net 页面一起使用，并使用 youtube 以编程方式创建 iframe 的方法，我发现在 Internet Explorer 中，这些 iframe 是不可靠的。在 chrome 中，它们工作正常。所以我需要有一个 IE 的替代品。我为非 iframe youtube api 找到以下代码：

```
 var params = { allowScriptAccess: "always" };
    var atts = { id: "player" };
    swfobject.embedSWF('http://www.youtube.com/v/<%=session("uTubeCode") %>?enablejsapi=1&playerapiid=ytplayer&version=3',
                       "player", '<%=Session("PlayerWidth")%>', '<%=Session("PlayerHeight")%>', "8", null, null, params, atts); 
```

我的问题是两方面的。首先，上面的 swfobject 必须从某处声明并在某处初始化。我怎么做？其次，在我的 iframe 代码中，我具有以下属性：

```
 { 'controls': 1, 'fs': 1, 'autoplay': 1, 'autohide': 0, 'modestbranding': 1, 'rel': 0, 'showinfo': 0} 
```

如何将这些等价物放入我的 swfobject 中？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T08:27:14.550

要回答问题 1，如果您只是在调用 embedSWF 方法之前引用 SWFObject javascript 库，那么代码应该可以运行：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
<script type="text/javascript">
    var attributes = ... etc. 
```

要回答问题 2，这些属性中的大多数将作为参数传递给 embedSWF 作为参数接收的 URL；以您的代码为例：

```
swfobject.embedSWF('http://www.youtube.com/v/<%=session("uTubeCode") %>?enablejsapi=1&playerapiid=ytplayer&version=3&fs=1&autplay=1&modestbranding=1',
                       "player", '<%=Session("PlayerWidth")%>', '<%=Session("PlayerHeight")%>', "8", null, null, params, atts); 
```

这是完整列表：

[https://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)

# java - 如何从 Java 中以编程方式动态加载 OSGI 片段？

> ID：14408912
> 
> 赞同：0
> 
> 时间：2013-01-18T22:49:57.927
> 
> 标签：java, osgi

如何从 Java 以编程方式加载 OSGI 片段及其捆绑包中的所有资源（配置文件等）？

我想通过 getResource() 访问资源，就好像它们在内部 Jar 中一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:36:50.163

首先，您需要一个句柄来捆绑上下文。从那里你可以收听包引用，得到一个 Bundle 实例并使用它的类加载器来做你想做的事。

使用 Servlet 连接到包上下文和[ServiceTracker](http://www.osgi.org/javadoc/r4v42/org/osgi/util/tracker/ServiceTracker.html)来侦听出现的 osgi 包的示例

```
public class AnotherHelloWorldServlet extends HttpServlet {

  private MessageService service = null;
  private BundleContext context;

  @Override
  public void init(final ServletConfig config) throws ServletException {
    super.init(config);

    context = (BundleContext) config.getServletContext().getAttribute("osgi-bundlecontext");

    final AnotherHelloWorldServlet servlet = this;

    ServiceTracker tracker = new ServiceTracker(context,
        MessageService.class.getName(), null) {

      @Override
      public Object addingService(final ServiceReference sref) {
        log.infof("Adding service: %s to %s", sref, servlet);
        service = (MessageService) super.addingService(sref);
        return service;
      }

      @Override
      public void removedService(final ServiceReference sref, final Object sinst) {
        super.removedService(sref, service);
        log.infof("Removing service: %s from %s", sref, servlet);
        service = null;
      }
    };
    tracker.open();
  }
} 
```

使用 ServiceReference，您可以调用[getBundle()](http://www.osgi.org/javadoc/r4v43/core/org/osgi/framework/ServiceReference.html#getBundle%28%29)来获取捆绑实例，为此，[getResource()](http://www.osgi.org/javadoc/r4v43/core/org/osgi/framework/Bundle.html#getResource%28java.lang.String%29)可以获取您所要求的内容。

如果您不能使用 servlet 或类似的东西（=如果您在 Java EE/servlet 容器之外），那么我所知道的挂钩到捆绑上下文的标准方法并不多。在这种情况下，您可能需要求助于[BundleContextProvider hack](https://github.com/tdiesler/jbosgi/blob/d7caf3126fb35b823d083b238e7d974b06865396/testsuite/jbossas/api/src/main/java/org/jboss/test/osgi/jbossas/example/payment/BundleContextProvider.java)来获取它。

# java - Java - 不可实例化类中缺少静态方法

> ID：14408914
> 
> 赞同：1
> 
> 时间：2013-01-18T22:50:05.410
> 
> 标签：java, sonarqube

我有“builder”类，Sonar 给出以下警告：

```
Missing Static Method In Non Instantiatable Class
pmd : MissingStaticMethodInNonInstantiatableClass
A class that has private constructors and does not have any static methods or fields cannot be used 
```

我将如何重构此类以满足上述检查？我正在挠头，因为我确实使用了那个类。

样品用途：

```
ViewBuilder vb = new ViewBuilder.Builder()
    .modelPart(CONTENT_PAGE, contentPageDao.get(id))
    .modelPart("navigation_sections", navigationSectionDao.list() )
    .modelPart("available_tags", tagDao.list() )
    .modelPart("available_albums", albumDao.list() )
    .section(CONTENT_PAGE)
    .page("index")
    .element("form")
    .action("/admin/content_page/save/" + id + ".html")
    .build(); 
```

类本身：

```
import java.util.HashMap;
import java.util.Map;

 public final class ViewBuilder {

    private static final String ADMIN_LAYOUT = "admin/layout";
    private String layout = ADMIN_LAYOUT;
    private String section = "";

  private static Map<String, Object> viewParts = new HashMap<String, Object>();

  /**
   * @return the layout
   */ public String getLayout() {
    return layout;
  }

  /**
   * @param layout the layout to set
   */ public void setLayout(String layout) {
    this.layout = layout;
  }

  /**
   * @return the section
   */ public String getSection() {
    return section;
  }

  /**
   * @param section the section to set
   */ public void setSection(String section) {
    this.section = section;
  }

  public static class Builder{

    // required params
    private String layout;
    private String section;

    // optional params
    private Map<String, Object > viewParts = new HashMap<String, Object >();

    public Builder(){

        this.layout = ADMIN_LAYOUT;
        viewParts.put("layout", ADMIN_LAYOUT);

    }
    public Builder( String layout ){

      if( layout != null ){
        this.layout = layout;
        viewParts.put("layout", layout );
      } else {
        this.layout = ADMIN_LAYOUT;
        viewParts.put("layout", ADMIN_LAYOUT);
      }

    }// constructor
    public Builder modelPart( String val, Object o ){
      this.viewParts.put(val, o );
      return this;
    }

    public Builder action( String val ){
      this.viewParts.put("action", val);
      return this;
    }
    public Builder element( String val ){
      this.viewParts.put("element", val);
      return this;
    }
    public Builder section( String val ){
      this.section = val;
      this.viewParts.put("section", val);
      return this;
    }
    public Builder page( String val ){
      this.viewParts.put("page", val);
      return this;
    }
    public Builder layout( String val ){
      this.layout = val;
      return this;
    }

    public ViewBuilder build( ){
      return new ViewBuilder( this );
    }

  }// Builder

    private ViewBuilder(Builder builder){
      this.section = builder.section;
      this.layout = builder.layout;

      viewParts = builder.viewParts;
    }

  /**
   * Get the value of viewParts
   *
   * @return the value of viewParts
   */
  public Map<String, Object> getViewParts() { return viewParts; }

  /**
   * Set the value of viewParts
   *
   * @param viewParts new value of viewParts
   */
  public void setViewParts(Map<String, Object> viewParts) { this.viewParts = viewParts; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-25T17:32:06.253

需要更新 SonarQube PMD 规则以考虑静态嵌套构建器类中的访问器。

为此创建了一个 PMD 问题，但它看起来已被废弃：http: [//sourceforge.net/p/pmd/bugs/955/](http://sourceforge.net/p/pmd/bugs/955/)

我不同意“重构”以摆脱这种声纳违规，构建器模式是众所周知的并且在创建复杂对象时非常有用。参见“Effective Java”第 2 章第 2 项。 [http://www.informit.com/articles/article.aspx?p=1216151&seqNum=2](http://www.informit.com/articles/article.aspx?p=1216151&seqNum=2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-04T15:38:44.533

满足此检查的另一种方法是使构造函数包私有而不是私有。这样做的另一个好处是，编译器将不再需要为内部类生成具有包私有访问权限的附加合成构造函数，请参阅[关于内部类中私有方法的问题的答案](https://stackoverflow.com/a/663147/503668)。

如果您强烈要求将构造函数保持私有，以防止同一包中的其他类在不使用的情况下创建实例`Builder.build()`，您应该能够通过以下方式抑制 Sonar 问题：

```
// private constructor to enforce the use of Builder.build()
@SuppressWarnings("pmd:MissingStaticMethodInNonInstantiatableClass") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:55:45.087

鉴于您的嵌套 Builder 类是`public`and `static`，我真的认为嵌套它没有什么好处。我建议将其分解为自己的顶级课程。当然，这不是 PMD 抱怨的原因。您的外部类`ViewBuilder`没有公共构造函数，也没有静态方法。`Builder`正如它现在存在的那样，它是围绕你的类的一个相当无用的“命名空间包装器” 。要么向它添加一个构造函数，要么完全摆脱它。

# java - 多个 JFrame

> ID：14408920
> 
> 赞同：1
> 
> 时间：2013-01-18T22:50:29.350
> 
> 标签：java, swing, jframe

我目前有两个框架，当您运行应用程序时，显示的第一个 JFrame 是登录，它有两个输入字段和一个按钮。当用户登录并通过验证时，我想关闭框架并启动第二个框架。

所以，我唯一能想到的就是`setVisible(false)`为登录框架和`setVisible(true)`框架做`Main`。

有没有更好的方法来做到这一点，或者这是唯一的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:54:34.370

就个人而言，我会立即启动您的第二个`JFrame`框架，并`JDialog`用`JFrame`.

另请参阅[The Use of Multiple JFrames, Good/Bad Practice？](https://stackoverflow.com/a/9554657/928711)

这是我建议的基本演示：

```
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestLogin {
    private JFrame frame;
    private boolean authenticated;
    private JTextField login;
    private JPasswordField password;

    protected void initUI() {
        frame = new JFrame(TestLogin.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(600, 600);
        frame.setVisible(true);
    }

    protected void showLoginDialog() {
        authenticated = false;
        final JDialog dialog = new JDialog(frame, "Please provide your credentials");
        dialog.setModal(true);
        JPanel panel = new JPanel(new GridBagLayout());
        JPanel buttonPanel = new JPanel();
        login = new JTextField(40);
        password = new JPasswordField(20);
        JLabel loginLabel = new JLabel("Login:");
        JLabel passwordLabel = new JLabel("Password:");
        JButton ok = new JButton("OK");
        ok.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                // Here perform authentication and set authentication flag to appropriate value
                authenticated = true;
                if (authenticated) {
                    setUpFrame();
                    dialog.dispose();
                }
            }
        });
        JButton cancel = new JButton("Cancel");
        cancel.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                System.exit(0);
            }
        });
        dialog.addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosed(WindowEvent e) {
                if (!authenticated) {
                    System.exit(0);
                }
            }
        });
        dialog.getRootPane().setDefaultButton(ok);
        buttonPanel.add(ok);
        buttonPanel.add(cancel);
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.insets = new Insets(5, 5, 5, 5);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        panel.add(loginLabel, gbc);
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        gbc.weightx = 1.0;
        panel.add(login, gbc);
        gbc.gridwidth = 1;
        gbc.weightx = 0;
        panel.add(passwordLabel, gbc);
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        gbc.weightx = 1.0;
        panel.add(password, gbc);
        panel.add(buttonPanel, gbc);
        dialog.add(panel);
        dialog.pack();
        dialog.setLocationRelativeTo(frame);
        while (!authenticated) {
            dialog.setVisible(true);
        }
    }

    protected void setUpFrame() {
        frame.add(new JLabel("Successfully authenticated"));
        frame.revalidate();
        frame.repaint();
    }

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException,
            UnsupportedLookAndFeelException {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                TestLogin testLogin = new TestLogin();
                testLogin.initUI();
                testLogin.showLoginDialog();
            }

        });
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:56:14.463

有几种方法可以做到这一点。
例如，您可以重复使用您的 1st `JFrame`。因此，删除您在第一个框架上获得的组件，为第二个框架添加组件，然后添加`repaint()`框架。
但我不认为这是一种好的做法。
正如 Andrew Thompson 建议的那样，您也可以使用 a`CardLayout`来初始化 one `JFrame`，显示您的登录卡，然后切换到完全初始化的第二张完整应用程序卡。这样，您将摆脱那些重绘。
您还可以显示您的第二帧（首先是您的应用程序），然后使用模式`JDialog`让用户登录。

# sql - 错误：列名或提供的值的数量与表定义不匹配

> ID：14408922
> 
> 赞同：1
> 
> 时间：2013-01-18T22:50:38.560
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我目前正在处理我的小型数据库项目，但我已经遇到了问题。我有两个表，生成的脚本发布在下面，现在我正在尝试编写一个程序，该程序将首先将记录添加到较小的记录中，然后使用第一个记录中的 ID 添加到第二个记录。但是我收到一个错误：“列名或提供的值的数量与表定义不匹配。” 在尝试将默认值添加到表 Klienci 的行中。我不知道发生了什么，因为没有列或参数，所以应该没有问题，至少像这个一样。

第一张表：

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[KlienciIndywidualni](
    [IDKlientaIndywidualnego] [int] IDENTITY(1,1) NOT NULL,
    [IDKlienta] [int] NOT NULL,
    [Imie] [nvarchar](50) NOT NULL,
    [Nazwisko] [nvarchar](50) NOT NULL,
    [NumerLegitymacji] [int] NULL,
    [Adres] [nvarchar](50) NOT NULL,
    [Miasto] [nvarchar](50) NOT NULL,
    [KodPocztowy] [nvarchar](50) NOT NULL,
    [Kraj] [nvarchar](50) NOT NULL,
    [Telefon] [int] NOT NULL,
    [Email] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_KlienciIndywidualni] PRIMARY KEY CLUSTERED 
(
    [IDKlientaIndywidualnego] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,     ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[KlienciIndywidualni]  WITH CHECK ADD  CONSTRAINT [FK_KlienciIndywidualni_Klienci] FOREIGN KEY([IDKlienta])
REFERENCES [dbo].[Klienci] ([IDKlienta])
GO

ALTER TABLE [dbo].[KlienciIndywidualni] CHECK CONSTRAINT [FK_KlienciIndywidualni_Klienci]
GO

ALTER TABLE [dbo].[KlienciIndywidualni]  WITH CHECK ADD  CONSTRAINT [CK_KlienciIndywidualni] CHECK  ((len([Telefon])>=(9)))
GO

ALTER TABLE [dbo].[KlienciIndywidualni] CHECK CONSTRAINT [CK_KlienciIndywidualni]
GO

ALTER TABLE [dbo].[KlienciIndywidualni]  WITH CHECK ADD  CONSTRAINT [CK_KlienciIndywidualni_mail] CHECK  (([Email] like '%@%.[a-z][a-z][a-z]'))
GO

ALTER TABLE [dbo].[KlienciIndywidualni] CHECK CONSTRAINT [CK_KlienciIndywidualni_mail]
GO 
```

第二个：

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Klienci](
    [IDKlienta] [int] IDENTITY(1,1) NOT NULL,
CONSTRAINT [PK_Klienci] PRIMARY KEY CLUSTERED 
(
    [IDKlienta] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,   ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

程序：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE dodaj_klienta_indywidualnego 
-- parametry
@Imie nvarchar(50),
@Nazwisko nvarchar(50),
@Adres nvarchar(50),
@KodPocztowy nvarchar(50),
@Miasto nvarchar(50) ,
@Kraj nvarchar(50),
@Telefon int,
@Email nvarchar(50),
@NumerLegitymacji nvarchar(50) = null

AS
BEGIN

SET NOCOUNT ON;
declare @IDKlienta as int;

begin try
    begin tran
    --dodaj klienta
    INSERT INTO Klienci
    DEFAULT VALUES
    set @IDKlienta = @@IDENTITY;

    --dodaj klienta indywidualnego
    INSERT INTO KlienciIndywidualni
    VALUES(@IDKlienta, @Imie, @Nazwisko, @Adres, @Miasto, 
    @KodPocztowy, @Kraj, @Telefon, @Email);
    COMMIT TRAN
end try
begin catch
    declare @error as varchar(127)
    set @error = (Select ERROR_MESSAGE())
    RAISERROR('Nie mozna dodac osoby-klienta, blad danych. %s', 16, 1, @error);
    ROLLBACK TRAN
end catch
END
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:56:27.827

您的第二次插入需要十个参数，您只提供了 9 个，如果您将跳过该`NumerLegitymacji`字段，那么您应该按其名称指定每列，因为现在插入等待最后一个 NOT NULL 列。

```
 --dodaj klienta indywidualnego
    INSERT INTO KlienciIndywidualni (
    IDKlienta,
    Imie,
    Nazwisko,
    Adres,
    Miasto,
    KodPocztowy,
    Kraj,
    Telefon,
    Email
)
    VALUES(@IDKlienta, @Imie, @Nazwisko, @Adres, @Miasto, 
    @KodPocztowy, @Kraj, @Telefon, @Email);
    COMMIT TRAN 
```

# sql - 如何在 Catalyst 中的 DBIx::Class 上设置 sql 选项

> ID：14408923
> 
> 赞同：2
> 
> 时间：2013-01-18T22:50:52.967
> 
> 标签：sql, sql-server, perl, catalyst, dbix-class

我需要`set ARITHABORT ON`在 Catalyst 上使用 DBIx::Class。我不确定我可以这样做：

```
$source->storage->do("set ARITHABORT ON"); 
```

我从 MS SQL Server 2008 收到此错误：

> SELECT 失败，因为以下 SET 选项的设置不正确：“ARITHABORT”。验证 SET 选项是否适用于索引视图和/或计算列上的索引和/或查询通知和/或 xml 数据类型方法。

在 Catalyst 中设置此类选项的最佳做法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T23:11:37.960

在您的数据库模型中，您可以在[connect_info](http://search.cpan.org/~getty/DBIx-Class-0.08204/lib/DBIx/Class/Storage/DBI.pm#connect_info)中为包的配置设置`on_connect_do`属性。

这是一个例子：

```
__PACKAGE__->config(
    schema_class => 'Your::Schema',
    connect_info => [
        'dbi:ODBC:server=my.host.name;port=1433;driver=FreeTDS;tds_version=8.0',
        'username',
        'password',
        undef,
        { on_connect_do => [ 'SET ARITHABORT ON' ] },
    ]
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:07:18.680

您发布的错误不是 Catalyst 错误，而是 SQL Server 告诉您需要以某些方式设置某些设置。例如，在查询 XML 时，您需要[这个](http://msdn.microsoft.com/en-us/library/ms188285%28v=sql.105%29.aspx). 因此，从 Catalyst 的角度来看，您所做的一切都是正确的。

# python - 即使有尝试，Python循环也会重新启动：除了：

> ID：14408924
> 
> 赞同：2
> 
> 时间：2013-01-18T22:51:12.120
> 
> 标签：python, loops, except

这是我刚刚编写的一个小程序的代码，用于测试我学到的一些新东西。

```
while 1:
    try:
        a = input("How old are you? ")
    except:
        print "Your answer must be a number!"
        continue

    years_100 = 100 - a
    years_100 = str(years_100)
    a = str(a)
    print "You said you were "+a+", so that means you still have "+years_100+" years"
    print "to go until you are 100!"
    break
while 2:
    try:
        b = str(raw_input('Do you want to do it again? If yes enter "yes", otherwise type "no" to stop the script.'))
    except:
        print 'Please try again. Enter "yes" to do it again, or "no" to stop.'
        continue

    if b == "yes":
            print 'You entered "yes". Script will now restart... '
    elif b == "no":
            print 'You entered "no". Script will now stop.' 
            break 
```

它适用于 for 循环。如果您输入的不是数字，它会告诉您只允许输入数字。

但是，在第二个循环中，它会要求您输入是或否，但如果您输入不同的内容，它只会重新启动循环而不是在之后打印消息

```
except: 
```

我做错了什么以及如何解决它以显示我告诉它的消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:53:28.940

您不会遇到异常，因为您在使用时*总是*输入字符串`raw_input()`。因此`str()`在返回值上`raw_input()`永远不会失败。

相反，在您的or测试中添加一条`else`语句：`yes``no`

```
if b == "yes":
        print 'You entered "yes". Script will now restart... '
elif b == "no":
        print 'You entered "no". Script will now stop.' 
        break
else:
    print 'Please try again. Enter "yes" to do it again, or "no" to stop.'
    continue 
```

请注意，您永远不应该使用笼统的`except`陈述；捕获*特定的*异常。否则，您将掩盖不相关的问题，使您更难发现这些问题。

您的第一个 except 处理程序应该只 catch ，`NameError`例如：`EOFError``SyntaxError`

```
try:
    a = input("How old are you? ")
except (NameError, SyntaxError, EOFError):
    print "Your answer must be a number!"
    continue 
```

因为那`input()`会抛出。

另请注意，它`input()`采用*任何*python 表达式。如果我输入`"Hello program"`（带引号），不会引发异常，但它也不是数字。改为使用`int(raw_input())`，然后 catch `ValueError`（如果你输入任何不是整数的东西会抛出什么）和`EOFError`for `raw_input`：

```
try:
    a = int(raw_input("How old are you? "))
except (ValueError, EOFError):
    print "Your answer must be a number!"
    continue 
```

`True`要使用第二个循环来控制第一个循环，请将其设为返回or的函数`False`：

```
def yes_or_no():
    while True:
        try:
            cont = raw_input('Do you want to do it again? If yes enter "yes", otherwise type "no" to stop the script.'))
        except EOFError:
            cont = ''  # not yes and not no, so it'll loop again.
        cont = cont.strip().lower()  # remove whitespace and make it lowercase
        if cont == 'yes':
            print 'You entered "yes". Script will now restart... '
            return True
        if cont == 'no':
            print 'You entered "no". Script will now stop.' 
            return False
        print 'Please try again. Enter "yes" to do it again, or "no" to stop.' 
```

在另一个循环中：

```
while True:
    # ask for a number, etc.

    if not yes_or_no():
        break  # False was returned from yes_or_no
    # True was returned, we continue the loop 
```

# c - USB驱动编译错误

> ID：14408930
> 
> 赞同：2
> 
> 时间：2013-01-18T22:51:35.230
> 
> 标签：c, linux, compilation, usb, drivers

我目前正在尝试编译 Linux USB UART 驱动程序，此处提供： [http ://www.exar.com/connectivity/uart-and-bridging-solutions/usb-uarts/xr21v1410](http://www.exar.com/connectivity/uart-and-bridging-solutions/usb-uarts/xr21v1410)

该驱动程序由 2 个头文件和 1 个大 C 文件组成。这些是 Makefile 的内容：

```
obj-m := vizzini.o

KERNELDIR ?= /lib/modules/$(shell uname -r)/build
PWD       := $(shell pwd)

EXTRA_CFLAGS    := -DDEBUG=0

all:
    $(MAKE) -C $(KERNELDIR) M=$(PWD)

modules_install:
    $(MAKE) -C $(KERNELDIR) M=$(PWD) modules_install

clean:
    rm -rf *.o *~ core .depend .*.cmd *.ko *.mod.c .tmp_versions vtty 
```

这是我运行 make 时编译器抛出的错误：

```
[sj755@localhost xr21v141x-lnx-2.6.35-pak]$ make
make -C /lib/modules/3.4.9-2.fc16.x86_64/build M=/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak
make[1]: Entering directory `/usr/src/kernels/3.4.9-2.fc16.x86_64'
  LD      /home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/built-in.o
  CC [M]  /home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.o
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1643:9: warning: initialization from incompatible pointer type [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1643:9: warning: (near initialization for ‘vizzini_device.ioctl’) [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1646:9: warning: initialization from incompatible pointer type [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1646:9: warning: (near initialization for ‘vizzini_device.tiocmget’) [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1647:9: warning: initialization from incompatible pointer type [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1647:9: warning: (near initialization for ‘vizzini_device.tiocmset’) [enabled by default]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c: In function ‘vizzini_init’:
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1663:9: error: implicit declaration of function ‘usb_serial_register’ [-Werror=implicit-function-declaration]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1677:9: error: implicit declaration of function ‘usb_serial_deregister’ [-Werror=implicit-function-declaration]
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c: In function ‘__check_debug’:
/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.c:1698:83: warning: return from incompatible pointer type [enabled by default]
cc1: some warnings being treated as errors
make[2]: *** [/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak/vizzini.o] Error 1
make[1]: *** [_module_/home/sj755/Downloads/xr21v141x-lnx-2.6.35-pak] Error 2
make[1]: Leaving directory `/usr/src/kernels/3.4.9-2.fc16.x86_64'
make: *** [all] Error 2 
```

这些是包含在主 c 源文件中的头文件：

```
#include <linux/kernel.h>
#include <linux/jiffies.h>
#include <linux/errno.h>
#include <linux/tty.h>
#include <linux/tty_flip.h>
#include <linux/module.h>
#include <linux/usb.h>
#include <linux/usb/serial.h>
#include <linux/serial.h>
#include <linux/slab.h>
#include <asm/unaligned.h>
#include <asm/uaccess.h>

#include <linux/usb/cdc.h>
#ifndef CDC_DATA_INTERFACE_TYPE
#define CDC_DATA_INTERFACE_TYPE 0x0a
#endif
#ifndef USB_RT_ACM
#define USB_RT_ACM      (USB_TYPE_CLASS | USB_RECIP_INTERFACE)
#define ACM_CTRL_DTR            0x01
#define ACM_CTRL_RTS            0x02
#define ACM_CTRL_DCD            0x01
#define ACM_CTRL_DSR            0x02
#define ACM_CTRL_BRK            0x04
#define ACM_CTRL_RI             0x08
#define ACM_CTRL_FRAMING        0x10
#define ACM_CTRL_PARITY         0x20
#define ACM_CTRL_OVERRUN        0x40
#endif

#include "linux/version.h"

#include "vizzini.h" 
```

运行 Linux 内核 3.4.9-2.fc16.x86_64

我将不胜感激任何帮助解决错误。

**编辑**

似乎`usb_serial_register`并且`usb_serial_deregister`从未在我的内核 API 中定义过。然而，`usb_serial_register_drivers`并且`usb_serial_deregister_drivers`是。以下是定义：

```
int usb_serial_register(struct usb_serial_driver *driver);
void usb_serial_deregister(struct usb_serial_driver *device);
int usb_serial_register_drivers(struct usb_driver *udriver,
                                struct usb_serial_driver * const serial_drivers[]);
void usb_serial_deregister_drivers(struct usb_driver *udriver,
                                   struct usb_serial_driver * const serial_drivers[]); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T01:28:50.850

内核中的 API（可用的头文件、它们的内容、函数原型（或者如果它们首先存在）......）**不是**固定的（如果你好奇，请参阅离你最近的 Linux 源代码中的[Documentation/stable_api_nonsense.txt](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=Documentation/stable_api_nonsense.txt;h=db3be892afb2b64ee582a5e43ce87223a1251ad3;hb=HEAD) ） ，因此驱动程序通常只能针对相当窄的内核范围进行编译。检查源代码是否（大致）与内核同时存在。

您还应该检查其驱动程序是否已包含在内核中，无论是作为官方驱动程序还是在暂存区域中。查看[Linux USB](http://www.linux-usb.org/)以检查替代驱动程序和其他新闻。如果没有其他帮助，你应该看看[LWN](http://lwn.net)的内核页面（在那里搜索你在当前源代码中找不到的函数并讨论替换），可能是在使用类似 cscope 的东西来创建你的源代码的索引之后（内核和驱动程序）。请务必与负责该区域的人员取得联系，以便他们知道您正在四处摸索，也许可以提供一些指示。

# javascript - 如何使用 scrollTo(0,0) 打开带有滚动条的剑道窗口？

> ID：14408931
> 
> 赞同：2
> 
> 时间：2013-01-18T22:51:38.790
> 
> 标签：javascript, scroll, window, kendo-ui

我有一个带有滚动条的剑道窗口。如果用户向下滚动到窗口内容的底部，关闭窗口，然后重新打开，则窗口以相同的滚动位置（即窗口内容的底部）打开。但是，我希望窗口在重新打开时始终显示在内容的顶部。如何才能做到这一点？

这是演示问题的jsfiddle：

[http://jsfiddle.net/e6shF/24/](http://jsfiddle.net/e6shF/24/)

这是小提琴中的一些代码，因为我必须将其包含在内才能使帖子正常工作...

```
var win;
function openWindow() {
    if (!win) {
        win = $('#win').kendoWindow({
            modal: true,
            width: '100px',
            height: '100px'
        });
    }
    $('#win').css('display', '');
    win.data('kendoWindow').center().open();
}

$(document).ready(function() {
    $('#button').click(openWindow);
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T23:56:38.970

要将您的背部滚动`<div id="win">`到顶部位置，只需运行：

```
$("#win").scrollTop(0); 
```

重新打开后：

```
var win;
function openWindow() {
    if (!win) {
        win = $('#win').kendoWindow({
            modal : true,
            width : '100px',
            height: '100px'
        });
    }
    $('#win').css('display', '');
    win.data('kendoWindow').center().open();
    $('#win').scrollTop(0);
}
$(document).ready(function() {
    $('#button').click(openWindow);
}); 
```

或者如果你想简化你的代码：

```
$(document).ready(function () {
    function openWindow() {
        win.center().open();
        win.element.scrollTop(0);
    }
    var win = $('#win').kendoWindow({
        visible: false,
        modal  : true,
        width  : '100px',
        height : '100px'
    }).data("kendoWindow");
    $('#button').click(openWindow);
}); 
```

# ios5 - 将旧数据模型文件复制到新项目中进行轻量级核心数据迁移

> ID：14408935
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:52:01.977
> 
> 标签：ios5, core-data, migration

我正在学习核心数据迁移，我错误地对我当前的模式文件本身进行了一些更改。但是，我确实有该项目的备份副本，它使用以前的模式。现在，我不想从头开始，但我确实想使用旧模式作为迁移的一部分。所以这是我计划实现的步骤：

（1）从备份项目中将旧的.xcdatamodel文件导入主项目，并使其成为v1.xcdatamodel （2）将现有项目（main）中的.xcdatamodel文件重命名为v2.xcdatamodel （3）定义“选项" 字典并将其设置为由persistentstorecoordinator 使用。

我不确定这是否可行。任何人都可以建议我解决问题的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T00:20:38.700

好的。现在我明白了这个概念。核心数据允许您在存储这些文件的 .xcdatamodeld 文件夹中存储多个 .xcdatamodel(ManagedObjectModel) 文件。我所做的是，我复制了旧的 MOM 文件并将其放在我当前（新）项目的 .xcdatamodeld 文件夹中。现在，轻迁移进入画面，并正确执行迁移。

# jquery-mobile - Jquery Mobile，可折叠套装和儿童

> ID：14408936
> 
> 赞同：0
> 
> 时间：2013-01-18T22:52:15.603
> 
> 标签：jquery-mobile, accordion

我正在尝试动态填充 JQM 手风琴/可折叠集的内容。我看过[http://the-jquerymobile-tutorial.org/jquery-mobile-tutorial-CH20.php](http://the-jquerymobile-tutorial.org/jquery-mobile-tutorial-CH20.php)，但这些例子似乎已经过时了。所以我试图想出一个可行的例子，但我目前被卡住并且看不到，为什么这不应该工作：

```
<script type="text/javascript">
$(document).ready(function() {
    $(".mySet").bind('expand', function (event, ui) {
        /* This prints e.g. "This is the first entry\n
        I'm the collapsible set content for section 1." */
        console.log($(this).text());

        /* This should print "This is the first entry" (=the innerText of <h3>)
        but it doesn't, it prints "This is the first entry\n
        I'm the collapsible set content for section 1." as well */
        console.log($(this).next().text());

        /* This should just print "I'm the collapsible set content for section 1"
        (=the innerText of <p>) but it doesn't, it prints e.g. "This is the 
        first entry\n I'm the collapsible set content for section 1." as well */
        console.log($(this).nextAll("p").text());
    });
});
</script>

<div data-role="collapsible-set">
    <div data-role="collapsible" class="mySet">
        <h3>This is the first entry</h3>
        <p>I'm the collapsible set content for section 1.</p>
    </div>
    <div data-role="collapsible" class="mySet">
        <h3>This is the second entry</h3>
        <p>I'm the collapsible set content for section 2.</p>
    </div>
</div> 
```

有谁看到，为什么 jQuery 不会下降`$(this)`(=which 指向当前扩展的`<div ...class="mySet">`？如果我在 Opera 的 DragonFly 中调试此代码，我可以看到，这`$(this)`似乎与`$(this).next()`(至少它们对 innerHTML 等具有相同的值) .)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:33:34.390

所以，在摆弄了一下之后，我想出了以下黑客/解决方法：

```
$(document).ready(function() {
    $(".mySet").bind('expand', function (event, ui) {
        /* I'm just creating a new var "myDiv" which points to my current div (so in a 
        way "myDiv" is just a copy of "this" */
        var myDiv = $("#"+$(this).attr('id'));
        var myP = myDiv.find('p:first');

        // Works as expected, prints "I'm the collapsible set content for section 1."
        console.log(myP.text());
    });
}); 
```

# git - 如何删除提交？

> ID：14408938
> 
> 赞同：0
> 
> 时间：2013-01-18T22:52:19.567
> 
> 标签：git

我在 Git 中合并了一些提交，现在我需要删除这个提交，因为它有一些机密信息。我需要在合并之前将 HEAD 放入提交中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:59:02.650

我更喜欢使用`git rebase`这项工作，因为会弹出一个不错的列表，我可以在其中选择要摆脱的提交。选择要列出的提交数量，然后像这样调用

```
git rebase -i HEAD~3 
```

样品清单

```
pick aa28ba7 Sanity check for RtmpSrv port
pick c26c541 RtmpSrv version option
pick 58d6909 Better URL decoding support 
```

然后 git 将删除您删除的任何行的提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:01:45.070

还有另一种方法可以做到这一点，但在这种情况下我有一个解决方案。

假设您正在使用`master`分支。

首先，我签出我想成为 master 中最后一个的提交并重新创建 master 分支。

```
git checkout 2fa59698256c4c3fb85c6e32741071797d5965b3
git checkout -b master 
```

然后我撤回强制服务器删除它的历史记录。

```
git checkout --amend
git push origin master --force 
```

这将删除之后的所有提交。

您可以使用`git rebalse~x`然后强制推送...但是当我遇到麻烦时，我总是记得使用结帐，我一直在分支之间切换。

# c++ - 在 C++ 中使用 this 时出错

> ID：14408939
> 
> 赞同：0
> 
> 时间：2013-01-18T22:52:23.577
> 
> 标签：c++, lvalue, towers-of-hanoi, gwt-history

```
class Tower
{
int index;//index of the tower;
nodeStack<int> t;
int size;//number of disks in the tower;

public:
Tower(int in);
void moveTopTo(Tower&);
void move(int size,Tower& dest,Tower& buffer);

};

void Tower::move(int n,Tower& dest,Tower& buffer)
{
    if(n>0)
    {
    move(n-1,buffer,dest);
    moveTopTo(dest);
    move(n-1,dest,this);
    }
} 
```

在这一行：move(n-1,dest,this);

得到一个错误，说对非 const 的引用的初始值必须是左值；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:03:05.503

您需要取消引用您的`this`指针，以便您可以将其用作参考：

```
move(n-1, dest, *this); 
```

# python - Python、键入的文本和粘贴的文本会产生不同的结果。为什么？

> ID：14408946
> 
> 赞同：0
> 
> 时间：2013-01-18T22:53:10.300
> 
> 标签：python, python-2.7

我在 python 中编写了一个回文测试器，当手动输入某个包含双引号的回文时，程序会正确地将其识别为回文。但是，当我复制并粘贴同一行文本时，程序无法在将字符串与其反向字符串进行比较之前删除双括号。

这是代码：

```
 ### Palindrome Test ###

  import string                               # class which includes all punctuation characters 

  word = raw_input("Please enter a word or phrase:\n")

  if (len(word) <= 1):                        # if 0 or 1 character input
      print 'Sorry, ' + '"' + word + '"' + ' is too short to be a palindrome.'

  else:

      tword = word.lower()                    # make input lowercase so capital letters don't cause problems, assn to new var

      tword2 = tword.replace(' ','')          # replace spaces with empty strings to remove space asymmetry

      tword3 = list(tword2)                   # break lowercase, spaceless input into list of characters, assn to new variable

                                              # ditch punctuation in list 
      tword3 = [''.join(c for c in s if c not in string.punctuation) for s in tword3]

      fword = ''.join(tword3)                 # gives us a lowercase, spaceless, punctuationless forward string

      tword3.reverse()                        # reverse list of characters

      bword = ''.join(tword3)                 # rejoin backwards list, assn to new variable

      if bword == fword:                      # check equivalence of backwards and forwards lowercase, spaceless, punctuationless input
                                              # if equivalent, print 'yes' message with original input
          print 'YES, ' + '"' + word + '"' + ' is a palindrome.' 

      else:                                   # else, 'no' message with original input
          print 'NO, ' + '"' + word + '"' + ' is not a palindrome.' 
```

什么时候，例如，“甜点，姐姐？” （强调感性）。作为输入输入，它正确地返回“是”消息。当我粘贴它时，它会给出一个“不”的消息。

这是怎么回事？

编辑：我发现从本网站粘贴或 word 文档不会给我带来问题。但是，从此页面 (http://www.palindromelist.net/Desserts-sis-Sensuousness-is-stressed/) 粘贴确实会产生错误的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:43:11.787

研究这个例子。您的代码工作正常，这只是清理了一下：

```
from string import punctuation

def is_palindrome(word):
    if len(word) <= 1:                              
        raise Exception("Sorry, '%s' is too short to be a palindrome" % word)

    lowered = ''.join(word.lower().split())
    filtered = filter(lambda x: x not in punctuation, lowered)                                  
    return filtered == filtered[::-1] 
```

# c# - XAML Metro 应用程序中弹出窗口的用途是什么？

> ID：14408952
> 
> 赞同：1
> 
> 时间：2013-01-18T22:53:55.463
> 
> 标签：c#, xaml, windows-8, windows-runtime

我的应用程序需要一个模式对话框，但在 XAML Metro 应用程序中似乎没有类似的东西。有人建议弹出窗口。

我试过了，似乎底层 UI 仍然响应......所以弹出窗口不是模态的。

我认为 OK 可能是它的目的是成为屏幕中心的弹出窗口，而不管其他布局和它是否出现 - 不是。弹出窗口与其他所有内容一样绑定到布局。如果它在网格中，它将被放置在第 0 行和第 0 列，而不是在中心。

所以可能我错过了什么。请帮助理解。我找不到任何与使用 Grid 可以实现的不同的用途。

**Popup 的目的是什么？**它与任何其他内容控件有何不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:28:24.113

差异：

1.  您不必将其作为另一个控件的子项。尽管在这种情况下，您可能会在遍历可视化树时遇到问题，并且专注于 TextBox 不会改变其内容，因此虚拟键盘可能会覆盖其内容，或者其装饰内容可能会与不在弹出窗口上的装饰控件失去对齐。

2.  它的内容树呈现在任何其他内容之上，并且（我相信）不会被父控件的剪辑区域剪辑。

3.  您通常需要在首次显示或父布局（或大小）更改时手动设置其宽度和高度，尤其是在最常见的场景之一中，当您将其宽度和高度设置为父级（或窗口）的宽度和高度时）。

也就是说 - 模态对话框是糟糕的 UI，应该避免。如果您想要显示对话框或使用其他方法，您可以简单地导航到另一个页面。（几乎）没有什么比在 UI 上显示一个模式对话框更烦人的了，该对话框看起来以其他方式启用但不响应输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-21T21:27:37.970

> 我的应用程序需要一个模式对话框，但在 XAML Metro 应用程序中似乎没有类似的东西。有人建议弹出窗口。

从 Windows 8.1 开始，实际上您可能想要查看类似于模式对话框的内容：它称为[Flyouts](http://msdn.microsoft.com/en-us/library/windows/apps/hh465341.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-14T21:47:20.763

显然，Windows 8.1 中缺少带有自定义内容的模式弹出窗口。一种可能的解决方法：

1.  使用`Popup`控件（本身不是模态的）
2.  使背景半透明
3.  在整个屏幕上拉伸它
4.  将实际的弹出内容放在该容器内并在其周围留出一些空间

现在，父页面可见但变暗，并且无法访问，因为它`Popup`正在覆盖它。

# php - 如何计算 tf-idf？

> ID：14408953
> 
> 赞同：0
> 
> 时间：2013-01-18T22:54:04.647
> 
> 标签：php, mysql, full-text-search, tf-idf

我有一个问题，我无法用我的实际代码计算 tf-idf。

这是 tf-idf 的示例：

```
$tfidf = $term_frequency *  // tf
        log( $total_document_count / $documents_with_term, 2); // idf 
```

我有全部文件，但我需要 $documents_with_term 和 $term_frequency。

这是我的实际代码：

```
$frase = htmlspecialchars($_GET['frase'], ENT_NOQUOTES);

$sssql = $server_link->query("SELECT uDR.webTitulo, uDR.webDescripcion, uDR.webkeywords, uDR.weburl, SUM(uDR.priority) as SPriority
FROM (

(SELECT s1.webTitulo, s1.webDescripcion, s1.weburl, s1.webkeywords, $a as priority FROM webs s1 WHERE MATCH (webTitulo) AGAINST ('$frase'))

UNION

(SELECT s2.webTitulo, s2.webDescripcion, s2.weburl, s2.webkeywords, $b as priority FROM webs s2 WHERE MATCH (webkeywords) AGAINST ('$frase*' IN BOOLEAN MODE))

UNION

(SELECT s3.webTitulo, s3.webDescripcion, s3.weburl, s3.webkeywords, $c as priority FROM webs s3 WHERE MATCH (webDescripcion) AGAINST ('$frase'))) uDR

GROUP BY uDR.webTitulo, uDR.weburl, uDR.webDescripcion, uDR.webkeywords

ORDER BY SPriority DESC ");

$totalRows = $sssql->num_rows; //This is the $total_document_count 
```

我有 $total_document_count，但我不知道如何提取 TF 和 $documents_with_term。

我怎样才能提取它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T13:40:57.123

*   在您的示例中 $totalRows 将是带有术语的文档。
*   总文档数为 SELECT COUNT(*) total_documents FROM webs
*   用 SQL 来计算词频有点困难。请参阅：[计算 VARCHAR 字段中字符串的出现次数？](https://stackoverflow.com/questions/12344795/count-the-number-of-occurences-of-a-string-in-a-varchar-field)

# java - 如何使 CLIENT-CERT SSL 重新协商在 Jetty 中工作？

> ID：14408958
> 
> 赞同：5
> 
> 时间：2013-01-18T22:54:21.547
> 
> 标签：java, servlets, ssl, jetty, client-certificates

我有一个具有公共 https 区域的 webapp，以及一个使用 SSL 重新协商受客户端证书保护的私有 https。此配置在带有 APR 的 Tomcat 7 中正常工作（并非没有大量工作）。

现在我正在与 Jetty 合作，我已经尝试了所有方法，但我无法让它发挥作用。

客户端证书对话框永远不会出现在浏览器中，而且我总是收到 HTTP 403 错误。

我的环境是：jdk 1.7.0.02 jetty 9.0.0.M3 从 Eclipse Helios 用 m2e 启动。（码头：运行）

服务器似乎启用了 SSL 重新协商，并按照[此处](http://blog.ivanristic.com/2009/12/testing-for-ssl-renegotiation.html)的指示对其进行了测试，因此我很确定 SSL 重新协商安全问题没有问题。

我已经覆盖了 ClientCertAuthenticator（以便能够调试）并创建了一个自定义 LoginService，看起来 X509Cert 从未出现在请求中。

看起来 SSL 重新协商从未被触发，并且身份验证失败，因为请求中没有证书。

配置的 LoginService 只是对每个验证返回 true。如果被问到，我也可以发布它们，但重要的方法永远不会被调用。

如果我使用 needCLientCert 或 wantClientCert 应用程序可以正常工作，但是浏览器会在公共区域要求证书。

我的配置文件：

web.xml： http: [//pastebin.com/LQ3RcWY4](http://pastebin.com/LQ3RcWY4)

jetty.xml： http: [//pastebin.com/iE9xqcLq](http://pastebin.com/iE9xqcLq)

码头上下文.xml：http: [//pastebin.com/rcSsBfRW](http://pastebin.com/rcSsBfRW)

pom.xml（码头部分）： http: [//pastebin.com/wBLATggq](http://pastebin.com/wBLATggq)

我错过了一些明显的东西吗？我不知道。我进行了很多搜索并尝试了许多可能的配置，但是没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:23:26.977

[http://docs.codehaus.org/display/JETTY/Jetty+Security](http://docs.codehaus.org/display/JETTY/Jetty+Security)

通过关闭 Jetty 中的 SSL 重新协商来解决。如果使用 JVM > 1.6u19 setAllowRenegotiate(true) 可以在连接器上调用

但是，您将服务器打开以进行 BEAST 攻击。

# mysql - 带有虚拟数据的 UNION SELECT

> ID：14408963
> 
> 赞同：0
> 
> 时间：2013-01-18T22:54:52.950
> 
> 标签：mysql, sql, join

我想用这个逻辑创建一个 6 行的限制：

1.  选择好友列表中的 user_id（也在同一个表中）
2.  如果少于 6 个，则选择另一个 RANDOM 用户，但不在好友列表中（直到限制为 6 个）
3.  如果没有 6 个 user_id，则添加一些“虚拟”用户 id（id 为 0）
4.  所有“真实”用户必须是不同的（id > 0）

    ```
    编号 | 好友列表 | 姓名
    1 2,3,5 约翰
    2 1,7,9 迈克尔
    3 1,2,5 汤姆
    4 3,2,6 拉里

    ```

预期的结果必须是这样的`(for a given user e.g. id=1)`：

`2, 3, 4, 0, 0, 0`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:52:15.970

您可能应该以不同的方式存储数据并使用连接从多个表中选择数据。根据您的用例，您还可以考虑存储数据的其他方式。

```
PEOPLE TABLE
id | name
1  | John
2  | Michael
3  | Tom
4  | Larry

PEOPLE_FRIENDS TABLE
id | person_id | friend_id
1  | 1         | 2          //In this case John is friends with Michael
2  | 3         | 1          //In this case Tom is friends with John. 
```

以下选择将为 John 的朋友提取 id。

```
SELECT * FROM PEOPLE `P` INNER JOIN PEOPLE_FRIENDS `PF` ON P.id = P.person_id WHERE P.id = 1 
```

还有一百万种不同的方式来编写该查询，但这会让你指向我认为的正确方向。

# javascript - 显示提交链接 onchange 并通过改变输入框的值

> ID：14408968
> 
> 赞同：-1
> 
> 时间：2013-01-18T22:55:05.210
> 
> 标签：javascript, html, asp-classic, onchange

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:06:36.097

因此，您可以做的`updateQty`是拥有一个对列表中的所有产品都正确的函数，只需创建一个通过相对路径查找所有必要元素的函数。

```
//in this function the context is the element, so the
//`this` variable can be used rather than a param 
//for the product id
function updateQty() {
    //show the update link
    var parent = this.parentNode;
    //assumes only the update text uses the class bodyTiny, and that there
    //is only one element using it. obviously making this invariant true
    //would be trivial by adding a different class name
    var updateText = parent.getElementsByClassName("bodyTiny")[0];
    updateText.style.display = 'block';
    var updateLink = updateText.parentNode
      , updateHref = updateLink.href;
    //next we find the current quantity and replace it with the input
    updateHref = updateHref.replace(/qty=(\d*)/, 'qty='+this.value);
    //then we set the link element's attribute
    updateLink.href = updateHref;
    //now when you mouse over the link you should see the url has changed
} 
```

您还可以将您的表单设置`POST`为等效数据，然后我猜在服务器端您将拥有您的`OnGetPage`和`OnPostback`两者都委托给相同的方法，其参数要么从查询字符串中解析出来，要么从发布数据中解析出来。

您可以看到它[在 jsfiddle 上](http://jsfiddle.net/ejHRn/1)运行。希望这会有所帮助！

# windows - 使用 SC.exe 设置服务凭据密码失败

> ID：14408973
> 
> 赞同：13
> 
> 时间：2013-01-18T22:55:44.340
> 
> 标签：windows, command-line, windows-services

我知道过去有人问过这个问题，但尚未提供令人满意的答案。

我正在使用 SC 命令来配置服务的凭据。

```
SC.exe config "SERVICE NAME" obj= "domain\user" password= "password" 
```

这成功完成，但是当我启动服务时，它无法执行登录。
[ `NET START "service name"`]

如果我仅手动更新*services.msc*中的密码，那么当我启动服务时它工作正常。

我有数百台服务器来更新此更改发生在部署中间，因此手动干预不是一种选择。

我尝试使用配置更新登录帐户，然后使用另一个配置命令来更新密码。

从所有帐户来看，`SC.exe`密码都不起作用，微软也没有帮助。

想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-02-08T19:09:27.883

除了在进行更改之前[停止服务并](https://msdn.microsoft.com/en-us/powershell/reference/4.0/microsoft.powershell.management/stop-service)[授予用户作为服务登录的权限](https://gallery.technet.microsoft.com/scriptcenter/Grant-Log-on-as-a-service-11a50893)外，我还必须添加`type= own`参数，否则会失败：

```
[SC] ChangeServiceConfig FAILED 87:

The parameter is incorrect 
```

所以这是有效的命令：

```
SC.EXE config "ServiceName" type= own obj= "domain\user" password= "password" 
```

考虑到我在双括号之间输入了密码，它甚至可以在密码中使用特殊字符。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-18T18:33:26.297

当您通过服务属性窗口中的正常路由将服务配置为在特定帐户下运行时，会自动授予该帐户作为服务登录的权限。当您使用 sc.exe 时，您还必须授予用户作为服务登录的权限。

[作为服务登录权限](https://technet.microsoft.com/en-gb/library/cc794944%28v=ws.10%29.aspx?f=255&MSPPError=-2147217396)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-23T14:57:29.117

在重新启动服务之前，您应该授予您的用户作为服务登录的权限。不幸的是，无法使用默认的 windows 工具从命令行执行此操作，但您可以使用*Windows Server 2003 Resource Kit Tools*中的小型附加 util ntright.exe 。

从[https://www.microsoft.com/en-us/download/details.aspx?id=17657下载](https://www.microsoft.com/en-us/download/details.aspx?id=17657)

*安装后，您将在C:\Program Files (x86)\Windows Resource Kits\Tools*中（或在 32 位机器上的 Program Files 中）获得很多工具。

你需要**ntrights.exe**。您可以复制它并从另一台主机上的任何位置运行。

要授予您的用户所需的权限，您应该在脚本中添加：

```
ntrights.exe +r SeServiceLogonRight -u "%DOMAIN%\%USER%" 
```

之后，您可以使用新用户成功重新启动服务。还有一个选项可以在远程主机上运行 ntrights.exe：

```
ntrights.exe +r SeServiceLogonRight -u "%DOMAIN%\%USER%" -m %HOSTNAME% 
```

当我需要远程重新配置大量主机时，这个工具对我很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-16T22:27:47.970

要通过我编写的脚本启用作为服务登录，您可以按原样使用它或提取对您有用的内容

[https://raw.githubusercontent.com/cdaf/windows/master/automation/provisioning/setServiceLogon.ps1](https://raw.githubusercontent.com/cdaf/windows/master/automation/provisioning/setServiceLogon.ps1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-23T18:26:47.037

在设置密码之前尝试停止服务：

```
sc.exe stop "<my_service>" 4:4:3
sc.exe config "<my_service>" obj= "\.<local_acc_name>" password= "<local_acc_pass>"
sc.exe start "<my_service>" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-12T19:58:33.190

我有这个问题。感谢 ST 对原帖的评论，我意识到我需要研究如何输入密码。`%%`就我而言，我需要将密码中的百分号 ( ) 加倍。

ST 提供的链接很有帮助： [在 cmd 中转义特殊字符](https://stackoverflow.com/questions/10296162/escaping-special-characters-in-cmd)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-08T07:40:44.380

在执行一些 Powershell 脚本时遇到这个问题，我的问题是密码中的特殊字符。

通过将密码存储在带有双引号的变量中来使其工作：

`$servicePassword = "`"passwordWithSpecialCharacters`"" cmd /c sc config myService obj= mydomain\myuser password= $servicePassword`

特殊字符有：

`()'"$><^?`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-23T15:55:55.430

尝试这个。开始菜单 - 键入不带引号的“本地安全策略”。打开“本地策略”，然后左键单击“用户权限分配”。在右侧面板上，右键单击“作为服务登录”，然后选择“属性”。单击“添加用户或组”并添加您的用户。单击确定。您可能必须重新启动计算机。

添加后可以在cmd中设置服务的用户名和密码。

# iphone - 从通用应用程序中排除 iPhone 3GS 和较旧的 iPhone 和 iPod

> ID：14408975
> 
> 赞同：3
> 
> 时间：2013-01-18T22:55:51.030
> 
> 标签：iphone, ios, ipad, ios-universal-app, iphone-3gs

我想实现与[这个问题](https://stackoverflow.com/questions/9146625/excluding-iphone3gs-and-down-from-downloading-my-app)中的人相同的目标，但使用通用应用程序。也就是说，包括所有 iPad 版本以及所有具有视网膜显示屏的 iPhone 和 iPod。

我认为我需要添加到 UIRequiredDeviceCapabilities 部分的 info.plist 文件中的键是：

*   armv7
*   前置摄像头~iphone
*   前置摄像头~ipod

我不确定的是 ~iphone 和 ~ipod 后缀是否足以让系统知道我想要包含 iPad 1（它没有前置摄像头）

任何人都可以确认这是正确的方法吗？

苹果支持门户网站上的人只会将我指向文档和指南，但我还没有找到任何我想做的真实示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T21:56:00.607

您不能使用“后缀”。此键允许您列出应用程序需要的“类似硬件”的功能。所以.. 比方说：麦克风 - 您的应用“需要”麦克风！你不能说“我需要麦克风……如果是 iPad”……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T01:05:41.457

我很确定这会起作用 - 特别是如果有`front-facing-camera~ipad`.

# hibernate - 休眠：OneToMany 映射失败

> ID：14408977
> 
> 赞同：2
> 
> 时间：2013-01-18T22:55:56.117
> 
> 标签：hibernate, duplicates, one-to-many

我是 Hibernate 的新手，正在尝试一些应该很容易的事情，但我无法让它工作。

有两个表，一个人和一个地址。一个人可以有一个或多个地址，即：一个 OneToMany 映射。当我尝试将相同的地址添加给两个不同的人时，我得到了一个例外。几乎就好像对“连接”表内的 foriegn_key 强制执行唯一性一样。

我的源代码：

**人**

```
package testing.com.hibernate.entities;

import java.util.HashSet;
import java.util.Set;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.JoinTable;
import javax.persistence.OneToMany;
import javax.persistence.Table;

import org.hibernate.annotations.GenericGenerator;

@Entity
@Table(name="Person")
public class Person {
private long personID; 
private String personName;
private Set<Address> addresses = new HashSet<Address>(0);

public Person() {}

public Person(String personName, Set<Address> addresses) {
    setPersonName(personName);
    setAddresses(addresses);
}

@Id
@GeneratedValue(generator="increment")
@GenericGenerator(name="increment", strategy="increment")
@Column(name="Person_ID")
public long getPersonID() {
    return personID;
}
@Column(name="Person_Name")
public String getPersonName() {
    return personName;
}
@OneToMany
@JoinTable(name = "PersonAddresses", joinColumns = {@JoinColumn(name="PersonID", unique=false)}, inverseJoinColumns = {@JoinColumn(name="AddressID", unique=false)})
public Set<Address> getAddresses() {
    return addresses;
}

public void setPersonID(long personID) {
    this.personID = personID;
}
public void setPersonName(String personName) {
    this.personName = personName;
}
public void setAddresses(Set<Address> addresses) {
    this.addresses = addresses;
}
} 
```

**地址**

```
package testing.com.hibernate.entities;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

import org.hibernate.annotations.GenericGenerator;

@Entity
@Table(name="Address")
public class Address {
private long addressID;
private String address; 

public Address() {}

public Address(String address) {
    setAddress(address);
}

@Id
@GeneratedValue(generator="increment")
@GenericGenerator(name="increment", strategy="increment")
@Column(name="Address_ID")
public long getAddressID() {
    return addressID;
}
@Column(name="Address")
public String getAddress() {
    return address;
}

public void setAddressID(long addressID) {
    this.addressID = addressID;
}
public void setAddress(String address) {
    this.address = address;
}
} 
```

**主要的**

```
package testing.com.hibernate.tests;

import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import testing.com.hibernate.entities.Address;
import testing.com.hibernate.entities.EntityCategory;
import testing.com.hibernate.entities.EntityNetflixFilm;
import testing.com.hibernate.entities.Person;
import testing.com.hibernate.sessionmanager.HibernateUtil;

import org.hibernate.Session;

public class Test {

public static void main(String[] args) {
    Session session = HibernateUtil.getSessionFactory().openSession();
    // Create multiple addresses
    Address addr1 = new Address("Address one");
    Address addr2 = new Address("Address two");
    Address addr3 = new Address("Address three");
    Address addr4 = new Address("Address four");

    // Add all addresses to the database
    session.beginTransaction();
    session.save(addr1);
    session.save(addr2);
    session.save(addr3);
    session.save(addr4);
    session.getTransaction().commit();
    session.close();

    /*
     * At this point in the code there will be four addresses 
     * in the table 'Address'. 
     * 
     * 1 - Address one
     * 2 - Address two
     * 3 - Address three
     * 4 - Address four
     * 
     * Now we want to create some people and add addresses to them
     */

    // Pull out a list of addresses from the database
    List<Address> addresses = null;
    session = HibernateUtil.getSessionFactory().openSession();
    session.beginTransaction();
    addresses = session.createQuery("from Address").list();
    session.getTransaction().commit();
    session.close();

    /*
     * We now have a List of Address objects.
     * 
     * This is replicating a Database with existing
     * Addresses and querying them from the table
     * to attach to a new Person being added. 
     */

    // Create person with Address 1 and 2
    Set<Address> addressSet1 = new HashSet<Address>();
    addressSet1.add(addresses.get(0));
    addressSet1.add(addresses.get(1));
    Person george = new Person("George", addressSet1);

    // Create person with Address 3 and 4
    Set<Address> addressSet2 = new HashSet<Address>();
    addressSet2.add(addresses.get(2));
    addressSet2.add(addresses.get(3));
    Person robert = new Person("Robert", addressSet2);

    // Create person with Address 1 and 2\. The same as George
    Person harry = new Person("Harry", addressSet1);

    // Attempt to add them to the Person table
    session = HibernateUtil.getSessionFactory().openSession();
    session.beginTransaction();
    session.save(george);
    session.save(robert);
    session.save(harry);
    session.getTransaction().commit();
    session.close();
}
} 
```

代码在保存 Person 对象“Harry”时崩溃。这是因为在 PersonAddress 表中，引用为“1”的地址已经存在并分配给了“George”。我怎样才能使'Harry'和'George'可以映射到地址'1'？

**日志**

Hibernate：插入 Person (Person_Name, Person_ID) 值 (?, ?) 22:39:42,284 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [VARCHAR] - George 22:39:42,284 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 1 休眠：插入到人（Person_Name，Person_ID）值（？，？） 22:39:42,285 TRACE BasicBinder：83 - 绑定参数 [1] 作为 [VARCHAR] - Robert 22:39:42,286 TRACE BasicBinder：83 - 绑定参数 [2] 作为 [BIGINT] - 2 Hibernate：插入人（Person_Name，Person_ID）值（？，？）22：39：42,287 TRACE BasicBinder：83 - 绑定参数 [1] 作为 [VARCHAR ] - Harry 22:39:42,287 TRACE BasicBinder:83 - 绑定参数 [2] 作为 [BIGINT] - 3

Hibernate：插入 PersonAddresses (PersonID, AddressID) 值 (?, ?) 22:39:42,289 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [BIGINT] - 1 22:39:42,292 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 1

Hibernate：插入 PersonAddresses (PersonID, AddressID) 值 (?, ?) 22:39:42,294 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [BIGINT] - 1 22:39:42,295 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 2

Hibernate：插入 PersonAddresses (PersonID, AddressID) 值 (?, ?) 22:39:42,296 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [BIGINT] - 2 22:39:42,296 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 3

Hibernate：插入 PersonAddresses (PersonID, AddressID) 值 (?, ?) 22:39:42,297 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [BIGINT] - 2 22:39:42,298 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 4

Hibernate：插入 PersonAddresses (PersonID, AddressID) 值 (?, ?) 22:39:42,298 TRACE BasicBinder:83 - 绑定参数 [1] 作为 [BIGINT] - 3 22:39:42,300 TRACE BasicBinder:83 - 绑定参数 [ 2] 作为 [BIGINT] - 1

22:39:42,320 WARN SqlExceptionHelper:143 - SQL 错误：1062，SQLState：23000 22:39:42,320 错误 SqlExceptionHelper:144 - 键 'AddressID' 的重复条目 '1'

线程“主”org.hibernate.exception.ConstraintViolationException 中的异常：键“AddressID”的重复条目“1”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T13:28:24.063

好的。所以我自己找出了问题所在。

事实证明，Hibernate 将一对多的“多”部分视为连接表中的唯一实体。这方面的一个例子是汽车/服务历史情况，您有一辆车记录其独特的服务历史。如果您尝试再次将服务历史添加到另一辆汽车，它将失败，因为此服务历史已经是汽车独有的。

如果你想共享信息，在这种情况下，一个可以在多个人之间共享的地址，你需要一个多对多的关系。要修复此问题，请更新您的源代码，以便 Person 具有 @ManyToMany 并提供 @JoinTable 注释。

# rally - 同时查询 UserStory 和 Defects 以获取 WsapiDataStore

> ID：14408988
> 
> 赞同：0
> 
> 时间：2013-01-18T22:57:02.397
> 
> 标签：rally

有没有办法使用单个查询来查询多个“模型”？类似于使用 _Type 的回溯查询：{'$in': ['HierarchicalRequirement','Defect']}

```
 Ext.create('Rally.data.WsapiDataStore', {
                    model: ['UserStory','Defect'], //this does NOT work
                    context: context,
                    autoLoad: true,
                    filters: newFilter,
                    fetch: 'Name,FormattedID,AcceptedDate,ScheduleState,PlanEstimate,KanbanState',
                sorters: [
                          {
                              property: 'AcceptedDate',
                              direction: 'ASC'
                          }
                    ],
                    listeners: {
                    load: this._onDataLoaded,
                    scope: this
                }
                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:28:48.813

RUI SDK 目前不支持此功能，但希望将来会支持。

# database - 用于选择多个可能的外部表之一的 DB 设计

> ID：14408992
> 
> 赞同：2
> 
> 时间：2013-01-18T22:57:10.173
> 
> 标签：database, database-design, schema

假设我有两个或更多完全不同的对象，每个对象都由数据库中的一个表表示。将这些称为文章、书籍等。现在假设我想为这些对象中的每一个添加评论功能。注释在每个对象中的行为完全相同，因此理想情况下，我希望将它们表示在一个表中。

但是，我不知道这样做的好方法。我知道如何做到这一点的方法是：

*   为每个对象创建一个注释表。Article_comments、Book_comments 等也是如此。每个都有一个指向相应对象的外键列。
*   创建一个全局注释表。有一个引用“Book”或“Article”的comment_type。每个对象都有一个可以为空的外键列，并使用 comment_type 来确定要使用的外键。

上述任何一种方式都需要在每次添加新对象时更新模型/数据库。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:02:16.090

我个人认为您的第一个选项是最好的，但我会将此选项用于样式点：

评论对他们来说有一个自然的结构。你有第一个评论，也许是关于评论的评论。这真的是一棵评论树。

如果您为每个指向注释树根的对象添加一个字段会怎样。然后你可以说，“检索文章 123 的评论树。”，然后你可以取根，然后根据一个评论表构建树。

注意：我仍然最喜欢选项 1。=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:42:16.047

还有另一种策略：从一个公用表**继承**¹种不同类型的“可注释”对象，然后将注释连接到该表：

![在此处输入图像描述](../Images/a81e36c1e947172e27a10f1b0c999114.png)

所有 3 种策略都是有效的，并且各有利弊：

1.  单独的注释表是干净的，但需要在 DML 和可能的客户端代码中重复。此外，除非您采用某种形式的继承，否则不可能对它们强制使用公共密钥，这引出了一个问题：为什么不首先直接使用 (3) 呢？
2.  一个具有多个 FK 的评论表会有很多 NULL（这可能是也可能不是存储和缓存方面的问题），并且每当将一种新的“可评论”对象添加到数据库。顺便说一句，你不一定需要`comment_type`- 它可以从*哪个*字段是非空的。
3.  当前的关系 DBMS 不直接支持继承，这带来了自己的一组[工程权衡](https://stackoverflow.com/a/12037398/533120)。从好的方面来说，它可以轻松添加新类型的可注释对象，而无需更改模型的其余部分。

* * *

*¹阿卡。类别、子类化、泛化层次结构...有关继承的更多信息，请查看[ERwin 方法指南](http://tangra.si.umich.edu/~radev/654/resources/ERMGALL.PDF)的“子类型关系”部分。*

# php - 加载时压缩帧内的图像

> ID：14408996
> 
> 赞同：0
> 
> 时间：2013-01-18T22:57:33.220
> 
> 标签：php, performance, compression, frames

我们开发了这个网站：[http ://www.aloha-connect.com/](http://www.aloha-connect.com/)

我们的问题是，在这个页面中，我们有很多框架。在某些情况下，框架中的框架。

我们的问题是，在低带宽的连接上。加载可能需要很长时间。我们曾尝试使用 php gzip code: 加载，但我们注意到框架内容加载速度不快。然后我们尝试将代码也放在框架页面中，但没有任何区别。

此页面上也会发生同样的情况[http://aloha-connect.com/rates/](http://aloha-connect.com/rates/)

任何支持/建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:02:17.753

1.  查看并尝试修复来自[Google pagespeed的任何高优先级和中等优先级项目](https://developers.google.com/speed/pagespeed/insights#url=http_3A_2F_2Fwww.aloha-connect.com_2F&mobile=false)
2.  摆脱不必要的框架（所有这些）。您将其标记为 PHP，因此使用 PHP [include()](http://us3.php.net/manual/en/function.include.php)包含来自其他文件的内容。（正如@cryptic 所指出的，您必须从包含的文件中编辑html，以便正确显示）
3.  当你有很多图标和小图像时使用 CSS Sprites。将您的图标放在一张图片中，然后使用 CSS 仅显示正确的图标：[http ://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)
4.  将所有 CSS 压缩到一个 css 文件中，将所有 JS 压缩到一个缩小的 JS 文件中。[如何即时缩小 JS 或 CSS](https://stackoverflow.com/questions/5389822/how-to-minify-js-css-on-the-fly-runtime)
5.  为 jQuery使用[CDN](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:03:21.763

所有帧都来自同一个域吗？

请记住，浏览器会限制对同一域的请求数量。我认为当前设置为 2。这包括 HTML 页面、图像、脚本、CCS 文件。

一种常见的解决方法是在其他域上托管一些资源，例如`cdn1.mydomain.com`和`cdn2.mydomain.com`. 这将允许浏览器一次获取更多资源，可能同时获取所有资源。

如果您在 Firebug 中打开“网络”选项卡或在 Chrome 中打开“网络”选项卡，您可以看到哪些请求处于待处理状态。