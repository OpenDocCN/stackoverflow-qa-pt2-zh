# StackOverflow 问答 13351000-13351999

# python - 所有回复都返回“无”附加

> ID：13351002
> 
> 赞同：2
> 
> 时间：2012-11-12T20:25:18.083
> 
> 标签：python, google-app-engine, python-2.7, webapp2

在我的 Google App Engine 应用程序中，每个请求都返回附加“无”。

例如，我有自己的视图控制器实现，当我返回时

```
self.response.out.write(view.toString()) 
```

我得到了预期的视图，但字符串末尾附加了“无”

我认为这可能是我的视图控制器实现，但如果我只是返回

```
self.response.out.write("") 
```

然后我得到“无”

我认为这是自从我从 webapp 框架更改为 webapp2 框架后发生的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:37:55.727

当 webapp2 框架调用您的处理程序方法之一时，它使用该方法的返回值作为对浏览器的响应值。

但是，您不会从您的方法中返回任何内容。您改为直接写入响应（这很好）。当你这样做时，你需要返回一个空字符串：

```
return '' 
```

没有显式 return 语句的 python 函数的默认返回值是`None`，这是您所看到的附加值。

或者，您可以只返回字符串结果而不是将其写入`self.response`：

```
return view.toString() 
```

# android - 按字符串查找可绘制对象

> ID：13351003
> 
> 赞同：48
> 
> 时间：2012-11-12T20:25:22.287
> 
> 标签：android

> **可能重复：**
> [Android - 从@drawable String 打开资源](https://stackoverflow.com/questions/2349652/android-open-resource-from-drawable-string)

首先对标题感到抱歉，但我不知道我可以设置什么标题。

好的，这是我的问题：

我将从外部数据库中提取一个字符串，例如：'picture0001'。

在 res/drawable 文件夹中，我有一张名为 picture0001 的图片。

我想将该图片设置为 ImageView 的背景（源）。

问题是，如何使用从外部数据库中获得的字符串查找这张图片。

非常感谢。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-11-12T20:43:27.653

是的，您可以使用[`Resources.getIdentifier()`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29).

```
Context context = imageView.getContext();
int id = context.getResources().getIdentifier("picture0001", "drawable", context.getPackageName());
imageView.setImageResource(id); 
```

它效率不高，但它可以用来查找偶尔的资源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T20:31:40.763

你也可以像这样使用反射：

```
Class c = Class.forName("your.project.package.R");
Field f = c.getDeclaredField("drawable");
Class d = f.getDeclaringClass();
Field f2 = d.getDeclaredField("yourstring");
int resId = f2.getInt(null);
Drawable d = getResources().getDrawable(resId); 
```

不过，最好的解决方案是 MarvinLabs 建议的。

# c - 如何为C中未知长度的字符串数组分配内存

> ID：13351010
> 
> 赞同：3
> 
> 时间：2012-11-12T20:25:40.667
> 
> 标签：c, arrays, string, dynamic, realloc

我有一个数组，比如文本，其中包含另一个函数读入的字符串。字符串的长度是未知的，它们的数量也是未知的。**我应该如何尝试将内存分配给字符串数组**（而不是字符串本身，它们已经作为单独的数组存在）？

我现在设置的内容似乎可以很好地读取字符串，并且似乎可以正确完成我想要完成的后处理（我用静态数组尝试过）。但是，当我尝试打印文本元素时，出现分段错误。更准确地说，当我尝试打印文本的特定元素（例如 text[3] 或 text[5]）时，会出现分段错误。我认为这意味着我错误地将内存分配给文本，并且读取的所有字符串都没有正确保存到文本中？

到目前为止，我已经尝试了不同的方法，例如首先分配一定数量的一些`size_t=k , k*sizeof(char)`，然后重新分配更多的内存（使用`realloc k*sizeof(char)) if cnt == (k-2)`，其中 cnt 是 **text.txt 的索引。

我试图搜索这个，但我发现的唯一类似问题是一组长度未知的字符串。

我想尽可能多地自己弄清楚，因此没有发布实际代码。但是，如果这些都没有任何意义，我会发布它。

编辑：这是代码

```
int main(void){
  char **text;
  size_t k=100;
  size_t cnt=1;
  int ch;
  size_t lng;

  text=malloc(k*sizeof(char));

  printf("Input:\n");

  while(1) {

    ch = getchar();
    if (ch == EOF) {
      text[cnt++]='\0';
        break;
    }

    if (cnt == k - 2) {
      k *= 2;
      text = realloc(text, (k * sizeof(char))); /* I guess at least this is incorrect?*/
    }

    text[cnt]=readInput(ch); /* read(ch) just reads the line*/
    lng=strlen(text[cnt]);
    printf("%d,%d\n",lng,cnt);
    cnt++;
  }

  text=realloc(text,cnt*sizeof(char));
  print(text); /*prints all the lines*/

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:32:27.100

简短的回答是你不能直接分配内存，除非你知道要分配多少。

但是，有多种方法可以确定您需要分配多少。

这有两个方面。一是知道你需要处理多少个字符串。必须有某种明确的认识方式；要么给你一个计数，要么有一些特定的指针值（通常为 NULL）告诉你何时到达终点。

要将指针数组分配给指针，最简单的方法可能是计算必要指针的数量，然后分配空间。假设一个空终止列表：

```
size_t i;
for (i = 0; list[i] != NULL; i++)
    ;
char **space = malloc(i * sizeof(*space));
...error check allocation... 
```

对于每个字符串，您可以使用`strdup()`; 您假设字符串格式正确，因此以 null 结尾。或者您可以编写自己的`strdup()`.

```
for (i = 0; list[i] != NULL; i++)
{
    space[i] = strdup(list[i]);
    ...error check allocation...
} 
```

另一种方法扫描指针列表一次，但使用`malloc()`and`realloc()`多次。这可能总体上比较慢。

如果您无法可靠地判断字符串列表何时结束或字符串本身何时结束，那么您将被水洗。完全彻底地冲洗。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:30:26.573

C 没有字符串。它只有指向（通常以 null 结尾的）字符序列的指针，并将它们称为字符串。

所以只需首先分配一个指针数组：

```
 size_t nbelem= 10; /// number of elements
 char **arr = calloc(nbelem, sizeof(char*)); 
```

你真的想要`calloc`，因为你真的想要清除那个数组，所以每个指针都有`NULL`. 当然，你测试`calloc`成功了：

```
 if (!arr) perror("calloc failed"), exit(EXIT_FAILURE); 
```

最后，填充数组的一些元素：

```
 arr[0] = "hello";
 arr[1] = strdup("world"); 
```

（不要忘记`free`的结果`strdup`和 的结果`calloc`）。

`realloc`您可以使用（但我不建议这样做，因为`realloc`失败时您可能会丢失数据）来扩展您的阵列。您可以通过分配更大的副本来简单地增长它，将其复制到内部，然后重新定义指针，例如

```
 { size_t newnbelem = 3*nbelem/2+10;
   char**oldarr = arr;
   char**newarr = calloc(newnbelem, sizeof(char*));
   if (!newarr) perror("bigger calloc"), exit(EXIT_FAILURE);
   memcpy (newarr, oldarr, sizeof(char*)*nbelem);
   free (oldarr);
   arr = newarr;
 } 
```

不要忘记`gcc -Wall -g`在 Linux 上编译（改进你的代码直到没有给出警告），并学习如何使用`gdb`调试器和`valgrind`内存泄漏检测器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:31:34.600

在 c 中，您不能直接分配字符串数组。您应该坚持使用指向 char 数组的指针以将其用作字符串数组。所以使用

```
char* strarr[length]; 
```

并保持字符数组您可以采用以下方法：

* * *

1.  通过调用分配一块内存`malloc()`
2.  跟踪输入的大小
3.  当您需要增加缓冲区大小调用时`realloc(ptr,size)`

# c# - .NET 中每种类型消耗多少字节的内存（32 位环境）？

> ID：13351012
> 
> 赞同：10
> 
> 时间：2012-11-12T20:25:42.443
> 
> 标签：c#, .net, memory, memory-management

`int`, `bool`, `float`, `double`, `decimal`,`object`和等类型`string`作为字段添加到类的实例时使用多少字节内存？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-12T20:27:24.850

[此页面](http://msdn.microsoft.com/en-us/library/ms228360(v=vs.80).aspx)以位为单位显示每种数据类型的大小（除以 8 得到字节）：

```
字节 8
字节 8
诠释 32
单位 32
短 16
超短 16
ETC...

```

对象和字符串是引用类型。引用类型至少占用它们包含的所有字段的大小加上引用本身的大小。

**有关的**

*   [.NET 中的对象引用有多大？](https://stackoverflow.com/questions/3800882/how-big-is-an-object-reference-in-net)

# ruby-on-rails - Twitter引导程序“lead”不适用于simple_form

> ID：13351020
> 
> 赞同：0
> 
> 时间：2012-11-12T20:26:11.260
> 
> 标签：ruby-on-rails, twitter-bootstrap, simple-form

我在 Rails 中使用 Twitter Bootstrap 和 simple_form。由于某种原因，我无法让 Bootstrap class="lead" 发挥作用。我在呈现的 HTML 中看到了一些我认为来自 simple_form 的附加类。怎样才能让两个人一起玩？

这是我的代码：

```
<p class="lead">
  <%= sentence.input :dialog, :input_html => { :class => "span8" },
              :placeholder => "Enter your sentence here", :label => false %>              
</p> 
```

这是呈现的 HTML：

```
<p class="lead">
  <div class="control-group string optional">
  <div class="controls"><input class="string optional span8" id="dialog_catagory_dialogs_attributes_0_dialog" name="dialog_catagory[dialogs_attributes][0][dialog]" placeholder="Enter your sentence here" size="50" type="text" />
 </div>
 </div>
</p> 
```

**编辑** 我尝试了各种选项，包括使用呈现的 HTML，像这样并删除 div。还是行不通。

```
<p class="lead">
  <input class="string optional span8" id="dialog_catagory_dialogs_attributes_0_dialog" name="dialog_catagory[dialogs_attributes][0][dialog]" placeholder="Enter your sentence here 2" size="50" type="text" />
</p> 
```

**输出**

```
<p class="lead">
   <input id="dialog_catagory_dialogs_attributes_0_dialog" name="dialog_catagory[dialogs_attributes][0][dialog]" size="30" type="text" />
</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:25:29.820

这就是问题所在：在元素内部放置一个`div`内部会`p`隐式关闭`p`标准确认浏览器中的标记。（[参考](https://stackoverflow.com/questions/4291467/nesting-block-level-elements-inside-the-p-tag-right-or-wrong)）

You can see (and modify locally, if you wish) the behavior of Simple Form's Bootstrap generators in [this file on Github](https://github.com/plataformatec/simple_form/blob/master/lib/generators/simple_form/templates/config/initializers/simple_form_bootstrap.rb).

# c# - 时间：2019-05-01 标签：c#open url in chrome with hash (#)

> ID：13351021
> 
> 赞同：7
> 
> 时间：2012-11-12T20:26:11.670
> 
> 标签：c#, google-chrome, hash, process

我正在尝试从 c# 在 Chrome 中打开一个 url 并保留哈希 (#)。例子：

```
string command = "http://127.0.0.1/test.html#foobar";
ProcessStartInfo ps = new ProcessStartInfo(command) { UseShellExecute = true };
Process.Start(ps); 
```

启动进程时，包括哈希 (#) 之后的所有内容都会丢失。我可以从命令提示符手动运行 Chrome，包括 url 中的哈希

> C:\Program Files (x86)\Google\Chrome\Application>chrome.exe 127.0.0.1/test.html#foobar

并且当默认浏览器设置为 IE 或 FireFox 时保留哈希值。

非常感谢任何建议。谢谢！

测试.html：

```
<!DOCTYPE HTML>
<html>
<head>
    <title>Test</title>
</head>
<body>
<h1>Test</h1>
<div style="height:1000px; background: #ccc; width: 100%"></div>
<a name="foobar">foobar</a>
</body>
</html> 
```

**注意：**我不想假设用户想要使用 chrome，我需要它在用户默认浏览器中工作。当用户的默认浏览器是 IE 或 Fire Fox 时，它可以工作，但当用户的默认浏览器是 Chrome 时，哈希值会丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:13:37.283

在默认浏览器中打开 URL 的命令`start myURL`不仅仅是`myURL`.

您需要执行以下命令：

> 开始“127.0.0.1/test.html#foobar”

请注意，引号需要在结果字符串中，而不是在 C# 中；C# 代码将是：

```
string command = @"start" + @"""127.0.0.1/test.html#foobar"""; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:51:44.480

我的默认浏览器是 chrome，这个命令可以正常工作：

```
System.Diagnostics.Process.Start(@"http://www.bitterminion.com/excel-launchpad#gopro"); 
```

“#gopro”保持不变。

# c# - 在静态类中列出的接口

> ID：13351022
> 
> 赞同：0
> 
> 时间：2012-11-12T20:26:12.290
> 
> 标签：c#, interface

我有一个类型列表。我需要通过名称在列表中找到匹配的类型。如果存在这种类型应该得到它的实例。类型列表存储在一个静态类中，该类扮演全局配置的角色并存储为应用程序配置的所有内容。向外部显示类型列表的接口的正确方法是什么，以便我可以轻松地按名称查找类型，获取我需要的类型，并且仍然不要将太多方法放入静态类并且不要不要陶醉太多的数据。

我正在考虑放置一些允许我按名称查找类型的接口，例如 IConfigurationSearchable。使配置返回此接口并针对它实现所有内容。灵活，不污染Configurator界面。但我决定询问 SO 以确保没有更好的方法来做到这一点。

我有一个静态类，允许我添加一些类。像这样：

`configuration.Add(new Test()); configuration.Add(new AnotherTest()); configuration.Add(new SomeFancyName());`

我想要一个允许我检查集合中包含名称 Test 的类的接口。也许稍后我会决定检查以 Test 开头的类是否在集合中，等等。我还需要按名称获取包含在那里的类或包含在那里的类列表。所以事情可能会发生变化，我不确定如何为我的配置器创建接口，这样就可以更轻松地进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:59:01.697

您可以查看一个简单的依赖注入容器，例如 TinyIoC： [https ://github.com/grumpydev/TinyIoC](https://github.com/grumpydev/TinyIoC)

有了这个，您可以注册类型的实例，例如：

```
// register Foo
container.Register<Foo>();
...
// later on, get this instance by using:
var instance = container.Resolve<Foo>(); 
```

或者更好的是，注册一个接口和一个实现，然后在代码中，只使用接口：

```
// register Foo as the concrete implementation of IFoo
container.Register<IFoo, Foo>();
...
// later on, get a concrete instance that implements the IFoo interface
var foo = container.Resolve<IFoo>(); 
```

这将为您提供更改 Foo 实现的灵活性，而使用它的任何代码都将仅依赖于 IFoo 接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T19:09:44.787

好的，不想回答我自己的问题，但由于答案数量相对较少（1）。我不介意将您在我自己之后发布的任何好的答案标记为答案。

我创建了一个接口 IGetTestable() 并将其作为方法从我的单例配置中返回。因此，如果在实施方面发生任何变化，我只需要更改实施即可。

我与我的集合交互的方式并没有被配置对象和它的方法所破坏。

# java - 在 Scala 中委托 java.util.List#toArray(T[] a)

> ID：13351026
> 
> 赞同：6
> 
> 时间：2012-11-12T20:26:23.743
> 
> 标签：java, scala

我正在编写一个实现（包装）java.util.List 的 Scala 类，即：

```
class MyList(backingList: java.util.List) extends java.util.List 
```

后者有一个带有 Java 签名的 toArray 方法，如下所示：

```
<T> T[] toArray(T[] a) 
```

天真地，我把它写成：

```
def toArray[T](a: Array[T]) = backingList toArray a 
```

但编译器抱怨在 backingList 上对 toArray 的调用需要一个`Array[? with java.lang.Object]`.

我想我已经尝试了所有可能的变化，比如`Array[_ >: T with Object]`（编译器友好地建议），但没有运气。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:34:44.510

这也有效：

```
def toArray[T](a: Array[T with Object]) = backingList.toArray[T](a) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T20:32:56.677

`Array[_ >: T with Object]`是 的语法糖`Array[X forSome {type X <: Object}]`，意思是一个对象数组，其类型是 Object 的子类型，但您需要的是相同类型 X 的对象数组，它是 Object 的子类型。所以简而言之，这只是一个范围界定问题。

```
def toarray(a: Array[X] forSome {type X <: Object}) = backingList toArray a 
```

# ruby - 字符串包含

> ID：13351030
> 
> 赞同：2
> 
> 时间：2012-11-12T20:26:31.147
> 
> 标签：ruby, string

除了遍历所有位置之外，有没有办法在 Ruby 中检查字符串`"1:/2"`是否包含在更大的字符串中？`str``str`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:31:23.290

您可以使用该[`include?`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-include-3F)方法

```
str = "wdadwada1:/2wwedaw"
# => "wdadwada1:/2wwedaw"
str.include? "1:/2"
# => true 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T20:28:34.687

正则表达式会做到这一点。

```
s =~ /1:\/2/ 
```

如果 s 不包含字符串，这将返回 nil，如果包含，则返回整数位置。由于 nil 是*falsy*并且整数是*truthy*，因此您可以在语句中使用此表达式`if`：

```
if s =~ /1:\/2/
  ...
end 
```

正则表达式通常由 分隔`/`，这就是为什么正则表达式中的斜杠被转义为`\/`

可以使用不同的分隔符来避免转义`/`：

```
s =~ %r"1:/2" 
```

`"`如果需要，您可以使用此语法以外的其他字符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-12T20:49:22.987

最简单最直接的方法是简单地询问字符串是否包含子字符串：

```
"...the string 1:/2 is contained..."['1:/2']   
# => "1:/2"
!!"...the string 1:/2 is contained..."['1:/2'] 
# => true 
```

[文档](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-5B-5D)有完整的独家新闻；看最后两个例子。

# php - 来自实时服务器的 mysql db_connect 功能不起作用

> ID：13351031
> 
> 赞同：0
> 
> 时间：2012-11-12T20:26:30.677
> 
> 标签：php, mysql, database

我正在尝试连接托管在实时服务器上的 mySQL db 连接数据库的代码行是

```
mysql_connect("example.com", "webwork_odesk1", "xxxxxxxx" , "webwork1_odesk") or die("Couldn't make connection."); 
```

用户名和密码正确，但浏览器中显示的错误是

```
Warning: mysql_connect() [function.mysql-connect]: Access denied for user 'webwork_odesk1'@'119.154.3.131' (using password: YES) in C:\xampp\htdocs\project\index.php on line 4 
```

无法建立联系。

我该如何解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:35:05.297

它可能与 MySql Server 权限有关。可能它不接受来自外部的连接。您可以通过上传脚本并使用 localhost 连接到数据库服务器来快速测试这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:39:32.853

看到[这个类似的线程](https://stackoverflow.com/questions/13036780/php-script-wont-connect-to-database/13036828)。

就像我在那里说的那样，“用户'webwork_odesk1'@'119.154.3.131'的访问被拒绝（使用密码：YES）”-消息来自两件事-主机名/用户名/密码/数据库错误或用户没有所需的权限。检查用户是否具有正确的权限。

# c++ - clang 对 C++ 11 lambda 的支持

> ID：13351032
> 
> 赞同：14
> 
> 时间：2012-11-12T20:26:34.503
> 
> 标签：c++, c++11, lambda, clang

我有这个使用 lambda 的 C++ 11 代码，这是一个示例。

```
#include <iostream>

using namespace std;

int main()
{
    auto func = [] () { cout << "Hello world"; };
    func(); // now call the function
} 
```

当我用 clang 3.1 ( ) 编译这段代码时`Apple clang version 3.1 (tags/Apple/clang-318.0.54) (based on LLVM 3.1svn)`，我得到了这个错误

```
lambda.cpp:7:17: error: expected expression
auto func = [] () { cout << "Hello world"; }; 
```

可能有什么问题？在[这个站点](http://clang.llvm.org/cxx_status.html)中，clang 3.1 似乎支持 lambda。

## 添加

使用 -std=gnu++11 或 c++11 选项，我收到了这些错误消息。

```
0\.      Program arguments: /usr/bin/clang -cc1 -triple x86_64-apple-macosx10.7.4 -emit-obj -mrelax-all -disable-free -disable-llvm-verifier -main-file-name lambda.cpp -pic-level 1 -mdisable-fp-elim -relaxed-aliasing -masm-verbose -munwind-tables -target-cpu core2 -target-linker-version 128.2 -resource-dir /usr/bin/../lib/clang/3.1 -fmodule-cache-path /var/folders/ng/h2hkycqd2q5g2hz42c47bt4w0000gn/T/clang-module-cache -std=gnu++11 -fdeprecated-macro -fdebug-compilation-dir /Users/smcho/Desktop/C++test -ferror-limit 19 -fmessage-length 173 -stack-protector 1 -fblocks -fobjc-runtime-has-arc -fobjc-runtime-has-weak -fobjc-dispatch-method=mixed -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -o /var/folders/ng/h2hkycqd2q5g2hz42c47bt4w0000gn/T/lambda-XvZzHg.o -x c++ lambda.cpp 
1\.      lambda.cpp:7:49: current parser token ';'
2\.      lambda.cpp:6:1: parsing function body 'main'
3\.      lambda.cpp:6:1: in compound statement ('{}')
clang: error: unable to execute command: Segmentation fault: 11
clang: error: clang frontend command failed due to signal 2 (use -v to see invocation)
clang: note: diagnostic msg: Please submit a bug report to http://developer.apple.com/bugreporter/ and include command line arguments and all diagnostic information.
clang: note: diagnostic msg: Preprocessed source(s) and associated run script(s) are located at:
clang: note: diagnostic msg: /var/folders/ng/h2hkycqd2q5g2hz42c47bt4w0000gn/T/lambda-roTwCZ.ii
clang: note: diagnostic msg: /var/folders/ng/h2hkycqd2q5g2hz42c47bt4w0000gn/T/lambda-roTwCZ.sh 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-12T21:42:40.467

这是因为默认情况下， ***clang++*** [使用 ISO C++ 1998 标准编译您的代码（包括 ISO C++ 2003 标准中解决的缺陷），“export”除外（已在 C++11 中删除）](http://clang.llvm.org/cxx_status.html)

Lambda 是[Clang 的](http://clang.llvm.org/) [C++11 Language Extension](http://clang.llvm.org/docs/LanguageExtensions.html#cxx11)的一部分，因此您需要使用**-std=c++11**或**-std=gnu++11编译代码**

另请参阅：[Clang 3.1 和 C++11 支持状态](https://stackoverflow.com/questions/10601545/clang-3-1-and-c11-support-status)和[在 Clang 中激活 C++11 支持](https://stackoverflow.com/questions/7875241/activating-c11-support-in-clang#comment9616450_7875241)

编辑：我认为您正在尝试使用 C 编译器 ( ***clang*** ) 而不是 C++ 编译器 ( ***clang++*** ) 编译程序，或者您的 Clang 安装未链接到***libc***或***libstdc++***。尝试链接每个库以查看哪个适合您，可能 libc 可能未安装在您的系统上。

尝试使用**clang++**可执行文件（C++ 编译器）以 C++11 模式编译您的程序，并将其与[Clang C++ 标准库](http://libcxx.llvm.org/)或[GNU 标准 C++ 库链接](http://gcc.gnu.org/libstdc++/)

1)

```
# Uses Clang C++ Library and enables C++11 mode
clang++ -stdlib=libc++ -std=c++11 [input] 
```

2)

```
# Uses GNU Standard C++ Library and enables C++11 mode
clang++ -stdlib=libstdc++ -std=c++11 [input] 
```

另一个可能的问题可能是您没有使用正确的选项编译 Clang 以启用 C++11 语言扩展，请尝试检查文档以获取在为 Clang 配置编译过程时要使用的正确标志。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T16:01:53.553

Xcode 使用 AppStore 更新，但它仍然在我的 Mac (Lion 10.7.5) 上崩溃

我可以下载 macport 以成功编译示例。

```
sudo port install clang-3.1
clang++-mp-3.1 -std=c++11 lambda.cpp 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T22:04:00.123

回复新编辑的帖子：

我对这个问题进行了一些调查，这是一个在`clang 3.1`. 我目前正在使用：

```
Debian clang version 3.1-3eudoxos1 (branches/release_31) (based on LLVM 3.1) 
```

但是，当我进行测试时，`clang 3.0-6ubuntu3`我收到了与您发布的错误类似的错误。

因为您的版本是从 SVN 标记的，所以我假设您的问题是它来自 3.1 的预发布版本，并且 lambda 支持尚未完全实现。

我可以确认 lambda 确实在 clang 中工作，因为我正在开发一个使用它们的项目，并且我们同时针对 clang 和 gcc。不时会出现一些编译器问题。但是，当然，没有什么比您给出的示例更简单了。

因此，我的建议是更新您的 clang 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T22:36:25.973

正如这篇文章所解释的那样，我需要安装命令行工具 - [Xcode 4.4 是否带有颠覆？](https://stackoverflow.com/questions/9326647/does-xcode-4-4-come-with-subversion)

![在此处输入图像描述](../Images/027aa8a1a0a5a870bd73e2e906ea691d.png)

# chef-infra - 厨师食谱中的类型错误

> ID：13351036
> 
> 赞同：3
> 
> 时间：2012-11-12T20:26:57.347
> 
> 标签：chef-infra, recipe

我有以下节点定义：

```
{
    "prestashop_sites" : {
       "site1": { "username": "dave", "password" :"password123", "URL":"www.madeup.com" },
       "site2": { "username": "dave2", "password" :"password12", "URL":"www.madeup2.com" }
    },
       "run_list": [
       "recipe[prestashop]"
    ]
} 
```

和食谱：

```
node["prestashop_sites"].each do |site|
        username site['username']
        Chef::Log.debug("Found a server: #{site['username']}")
end

remote_file "/tmp/prestashop152.zip" do
        source "http://www.prestashop.com/download/old/prestashop_1.5.2.0.zip"
        mode "0644"
        checksum "37aee9ef5388376e4377aeb240ab027e"
        backup false
        not_if "test -f /tmp/prestashop152.zip"
end

execute "unzip -o /tmp/prestashop152.zip -d #{node[:prestashop][:location]}" do
        not_if "test -f /var/www/#{node[:prestashop][:user]}/prestashop/index.php"
end 
```

所以我的目标是安装几个 prestashop 实例（在我完成脚本之后）。

但我被困住了：

```
10:  node["prestashop_sites"].each do |site| 
11>>    Chef::Log.debug("Found a server: #{site['username']}")
12:  end

Mon, 12 Nov 2012 21:26:14 +0100] DEBUG: Re-raising exception: 
                                        TypeError - can't convert String into Integer 
```

知道为什么吗？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:41:58.860

您有一个哈希作为 *node["prestashop_sites"]* 的子元素，而不是数组。因此，您必须为*每种*方法提供 2 个变量。1 代表键，另一个代表值：

```
10>>!  node["prestashop_sites"].each do |key, site| 
11:    Chef::Log.debug("Found a server: name: #{key}, #{site['username']}")
12:  end 
```

将为第一个站点打印*“找到服务器：名称：site1，dave”*。

你得到的“奇怪”错误：*TypeError - can't convert String into Integer*，是因为当你只为 each 方法提供 1 个变量时，ruby 会尝试将键和值都放入该变量中。这结束了分配的 [key, value] 的值，在您的情况下，这意味着

*网站*== [“网站”，{“用户名”：“戴夫”，“密码”：“密码123”，“网址”：“www.madeup.com”}]

实际上是一个数组，并且您尝试使用字符串索引而不是整数访问数组元素。

# magento - Magento 安装程序设置不可知插入

> ID：13351039
> 
> 赞同：2
> 
> 时间：2012-11-12T20:27:08.030
> 
> 标签：magento, installation, database-agnostic

我完成了有关 Magento 设置资源的[本教程。](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-6-magento-setup-resources)

在某些时候，我看到它支持更多的数据库后端，但在提到的教程中只描述了**创建**表的方式。

我需要一些关于将（不可知脚本）数据插入到先前创建的表中的方法的***资源***/*示例*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T00:34:14.440

就像 Magento（和开源）的所有东西一样，最好的办法是看看其他开发人员，特别是 Magento 核心开发人员是如何做同样的事情的。这里有几个例子

```
#File: app/code/core/Mage/Tax/sql/tax_setup/mysql4-upgrade-0.7.2-0.7.3.php
$installer = $this;
/* @var $installer Mage_Core_Model_Resource_Setup */

$installer->startSetup();

if (!$installer->getConnection()->fetchOne("select * from {$this->getTable('tax_class')} where `class_name`='Shipping' and `class_type`='PRODUCT'")) {
    $installer->run("
        insert  into {$this->getTable('tax_class')} (`class_name`,`class_type`) values ('Shipping','PRODUCT');
    ");
}

$installer->endSetup(); 
```

...

```
#File: app/code/core/Mage/Sales/sql/sales_setup/mysql4-upgrade-0.8.29-0.9.0.php
$installer->getConnection()->insert($installer->getTable('sales_flat_quote'), $quoteData); 
```

您基本上是针对数据库运行原始 SQL，因此您将负责（即开发人员的责任）保持它足够通用以在各种 SQL（MySQL、SQL Server、Oracle 等）环境中运行。

我不建议在设置资源中使用标准 Magento 模型。Magento 运行这些迁移脚本的上下文与模型通常运行的上下文不匹配。您可能能够摆脱它，但是如果模型对完全自举的 Magento 系统。

您可以通过一些搜索自己找到更多示例。如果你精通命令行，试试这个

```
$ cd app/code/core/Mage
$ find . -type f -wholename '*/sql/*'  | xargs grep -i -r insert 
$ find . -type f -wholename '*/sql/*'  | xargs ack -i insert       #if you use ack 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:09:29.767

您应该使用相应的模型来插入数据。示例来自`app/code/core/Mage/Dataflow/data/dataflow_setup/data-install-1.6.0.0.php`：

```
$dataflowData = array(
    array(
        'name'         => 'Export All Products',
        'actions_xml'  => '<action type="catalog/convert_adapter_product" method="load">\r\n    <var name="store"><![CDATA[0]]></var>\r\n</action>\r\n\r\n<action type="catalog/convert_parser_product" method="unparse">\r\n    <var name="store"><![CDATA[0]]></var>\r\n</action>\r\n\r\n<action type="dataflow/convert_mapper_column" method="map">\r\n</action>\r\n\r\n<action type="dataflow/convert_parser_csv" method="unparse">\r\n    <var name="delimiter"><![CDATA[,]]></var>\r\n    <var name="enclose"><![CDATA["]]></var>\r\n    <var name="fieldnames">true</var>\r\n</action>\r\n\r\n<action type="dataflow/convert_adapter_io" method="save">\r\n    <var name="type">file</var>\r\n    <var name="path">var/export</var>\r\n    <var name="filename"><![CDATA[export_all_products.csv]]></var>\r\n</action>\r\n\r\n',
        'gui_data'     => 'a:5:{s:4:"file";a:7:{s:4:"type";s:4:"file";s:8:"filename";s:23:"export_all_products.csv";s:4:"path";s:10:"var/export";s:4:"host";s:0:"";s:4:"user";s:0:"";s:8:"password";s:0:"";s:7:"passive";s:0:"";}s:5:"parse";a:5:{s:4:"type";s:3:"csv";s:12:"single_sheet";s:0:"";s:9:"delimiter";s:1:",";s:7:"enclose";s:1:""";s:10:"fieldnames";s:4:"true";}s:3:"map";a:3:{s:14:"only_specified";s:0:"";s:7:"product";a:2:{s:2:"db";a:0:{}s:4:"file";a:0:{}}s:8:"customer";a:2:{s:2:"db";a:0:{}s:4:"file";a:0:{}}}s:7:"product";a:1:{s:6:"filter";a:8:{s:4:"name";s:0:"";s:3:"sku";s:0:"";s:4:"type";s:1:"0";s:13:"attribute_set";s:0:"";s:5:"price";a:2:{s:4:"from";s:0:"";s:2:"to";s:0:"";}s:3:"qty";a:2:{s:4:"from";s:0:"";s:2:"to";s:0:"";}s:10:"visibility";s:1:"0";s:6:"status";s:1:"0";}}s:8:"customer";a:1:{s:6:"filter";a:10:{s:9:"firstname";s:0:"";s:8:"lastname";s:0:"";s:5:"email";s:0:"";s:5:"group";s:1:"0";s:10:"adressType";s:15:"default_billing";s:9:"telephone";s:0:"";s:8:"postcode";s:0:"";s:7:"country";s:0:"";s:6:"region";s:0:"";s:10:"created_at";a:2:{s:4:"from";s:0:"";s:2:"to";s:0:"";}}}}',
        'direction'    => 'export',
        'entity_type'  => 'product',
        'store_id'     => 0,
        'data_transfer'=> 'file'
    ),
    // ... 
);

foreach ($dataflowData as $bind) {
    Mage::getModel('dataflow/profile')->setData($bind)->save();
} 
```

# c++ - 重载 cin 以采用 ifstream 而不是 char* fname？

> ID：13351044
> 
> 赞同：0
> 
> 时间：2012-11-12T20:27:44.650
> 
> 标签：c++

我正在尝试创建一个文件操纵器，因此当我`cin >> filename`读取文件并计算值时...当然我会添加更多内容，但我想继续获取文件内容的基础知识。

我想要实现的是通过 cout 提示用户输入文本文件名，然后当他输入时，我将`cin >> readfile`在下一行代码中执行另一个操作，然后编译器将运行运算符重载并 cout 内容。

我如何实现它。下面是我的代码。

问题是代替接收`char* fname`，我可以发送 ifstream 代替吗

所以我可以做类似的事情

```
ifstream infile(filename.c_str());
cin >> infile 
```

以下是我当前的代码

```
#include <iostream>
#include <fstream>
#include <string>
#include "point2d.cpp"
#include "line2d.cpp"
#include <iomanip>

using namespace std;

struct myself
{
    string myname;
};

istream &operator>> (istream &stream, myself &myself )
{
    cout << "Enter my name";
    stream >> myself.myname;
    return stream;
}

istream &operator>> (istream &in, char* fname)
{
    ifstream inFile;
    inFile.open(fname);
    char ch1;
    while (inFile.get(ch1))
    {
        cout << ch1;
    }
}

int main()
{
    string filename;
    cout << "Enter file name: ";
    cin >> filename;

    // was thinking of
    // ifstream infile(filename.c_str());
    // then read infile with cin

    //how do i cin filename and read its content.     
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:53:06.080

你在这里搞砸了一些概念。你的问题太模糊了，我不相信你清楚你想做什么。

据我了解，你想要

```
cin >> istream; 
```

执行以下操作：

*   读取文件名
*   打开文件进行阅读
*   替换`cin`为文件的输入流

那是对的吗？

恕我直言，这是一个坏主意，因为按照惯例，`cin >>`不应**以任何重要的方式进行****修改`cin`**。当然，它会推进流，并且有一些技巧可以改变解析模式。

**如果您将流替换为新流，请使其*显而易见*，不要试图将其隐藏在某些`>>`构造**中。

编程不是拯救角色的运动。如果你让它更神秘，你的程序不会更快。优秀的程序员*编写的代码非常清楚它的作用*，以避免错误并更容易找到它们。

```
istream* input = &cin; // Default input is stdin
*input >> filename; // read filename
input = new istream(filename, istream::in);
// Continue to use *input

// Clean up input, if you replaced it:
// You might want to use a boolean flag instead of this hack.
if (input != &cin) {
    delete input;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:58:10.077

恐怕你在这里很困惑。`cin`什么都不读；你从`cin`. 因此，您可能希望以`>>`某种方式重载运算符以将其内容读`cin`入文件，但反之则不然。

您可以做的是重载运算符`<<`，以便将文件的内容输出到输出流中，例如`cout`. 然而，以下内容是无效的：

```
ostream& operator<<(ostream& out, char* filename); 
```

您无法定义此运算符，因为它已被定义。您需要编写一个表示文件名的类并在其上重载运算符。一个简单的版本：

```
struct Filename
{
  Filename(const string& filename) : filename_(filename) {}
  string filename_;
};

ostream& operator<<(ostream& out, const Filename& name)
{
  // read the file whose name is name.filename_
} 
```

你可以这样称呼它：

```
cout << Filename("filename.ext"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:56:19.150

你同时在做几个不好的做法。

首先，`cin`是一个 istream，因此您希望重载一个`istream`运算符以获取一个`istream`. 对于任何试图阅读您的代码的人来说，这将是令人难以置信的困惑。

其次，一个函数应该做一项工作（也就是说，你不应该试图通过将几个不同的任务集中到一个函数中来隐藏功能）。 `istream`从输入流中读取数据（在这种情况下，是您要打开的文件名）。然后，您需要将该文件名传递给`ifstream`实例以实际读取该文件。大概你想输出它，在这种情况下你会使用`ostream`（例如`cout`）。

您希望实现的整个逻辑可以在大约 5 行代码或更少的代码中完成：

```
string filename = "";
cin >> filename;
ifstream fin(filename.c_str(), ifstream::in);
copy(istreambuf_iterator<char>(fin), istreambuf_iterator<char>(), ostreambuf_iterator<char>(cout)); 
```

这比您尝试做的更短且更具可读性。

# javascript - 有没有办法确定 iframe 是否可见/活动

> ID：13351047
> 
> 赞同：3
> 
> 时间：2012-11-12T20:27:47.173
> 
> 标签：javascript, iframe, cross-domain

我有一个在站点上运行的 iframe（具有不同的域）。我能否在 iframe 中知道它对用户是否可行，或者该 iframe “居住”的页面是否处于活动状态。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:33:54.863

这实际上是不可能的，因为如果您在不同的域/端口/方案上，您将无法从框架本身访问嵌入框架的主页。

如果您的 iframe 在同一个域 && 端口 && 方案上，您可以这样做：

```
<html>
<body>
    <iframe src="frame.htm" id="myframe" style="display:block"></iframe>
</body>
</html> 
```

和frame.htm：

```
<script>
    var is_hidden = parent.document.getElementById("myframe").style.display == "none";
    alert(is_hidden ? "I am hidden" : "I am visible");
</script> 
```

**更新**忽略了“来自不同域”-问题的一部分，相应地更新了帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-07T14:52:55.547

您应该查看[Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)。我能够让它适用于两个不同的域。

像这样的东西对我有用：

```
function handleIntersect(entries, observer) {
  console.log('intersecting', entries[0].isIntersecting, 'visible', entries[0].isVisible);
}

let observer;

let options = {
  root: null,
  rootMargin: "0px",
  threshold: [0.5]
};

observer = new IntersectionObserver(handleIntersect, options);
// The DOM element here should be a div that captures the whole content of the iframe.
observer.observe(DOM_ELEMENT); 
```

# php - 用于上传图片的wordpress中的php代码

> ID：13351048
> 
> 赞同：3
> 
> 时间：2012-11-12T20:27:54.177
> 
> 标签：php, wordpress, image, image-size

请帮助使用php代码：

我有以下代码只上传 360x514 图像。我的问题是：如何编辑它以使任何大小都可以上传而不会出现错误消息？

```
<?php
$MAXIMUM_FILESIZE = 5 * 1024 * 1024; 
$uploaddir = './uploads/image/large_image/'; 
$file = $uploaddir . basename($_FILES['image2']['name']); 
$raw_file_name= $_FILES['image2']['tmp_name'];
list($width, $height) = getimagesize($_FILES['image2']['tmp_name']);
if ($width==360 && $height==514) {
if (move_uploaded_file($_FILES['image2']['tmp_name'], $file)) { 
echo "success"; 
} 
else {
echo "error";
}
}else {
echo "size_error";
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:32:43.740

就像@Musa 所说，删除检查：

```
<?php
$uploaddir = './uploads/image/large_image/'; 
$file = $uploaddir . basename($_FILES['image2']['name']); 
$raw_file_name = $_FILES['image2']['tmp_name'];
if (move_uploaded_file($_FILES['image2']['tmp_name'], $file)) { 
    echo "success"; 
} else {
    echo "error";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:31:49.440

```
list($width, $height) = getimagesize($_FILES['image2']['tmp_name']);
if ($width==360 && $height==514) {
    if (move_uploaded_file($_FILES['image2']['tmp_name'], $file)) { 
        echo "success"; 
    } 
else {
    echo "error";
} 
```

如果您阅读它，它就在您的代码中...这里说它必须等于 360x514，只需摆脱该 IF 语句，然后跳到 move_uploaded_file 命令。

# php - PHPMailer - 错误无法实例化邮件功能

> ID：13351051
> 
> 赞同：0
> 
> 时间：2012-11-12T20:27:58.017
> 
> 标签：php, phpmailer, mailer

我有一个向我的会员发送电子邮件的脚本，它成功地向前 141 个用户发送了电子邮件，然后对于剩余的 100 多个用户（所有这些用户都有有效的电子邮件。

任何人都知道为什么它会在循环中停止运行？

我基本上是在循环中执行此操作：

```
$Log->Notice("Iteration " . $count . ": About to send email to $name ($address)");
$mail->ClearAddresses();
$mail->AddAddress($address, $name);
if(!$mail->Send())
{
   echo " - FAILED to send email: " . $mail->ErrorInfo . "<br/>" . $NL;
   $Log->Error("Failed to send email");
   $Log->Error($mail->ErrorInfo);
   $num_fail++;
} else {
   echo " - Email sent" . $NL;
   $Log->Notice("Email successfully sent");
   $num_success++;
} 
```

# caching - 共享内存 IPC 中的虚拟地址匹配是否重要？

> ID：13351054
> 
> 赞同：1
> 
> 时间：2012-11-12T20:28:10.033
> 
> 标签：caching, cpu, shared-memory, x86-64

我正在同一台机器上的两个进程之间实现 IPC（Linux x86_64 shmget 和朋友），并且我正在尝试最大化进程之间的数据吞吐量：例如，我已将两个进程限制为仅在同一机器上运行CPU，以便利用硬件缓存。

我的问题是，每个进程将共享对象放在虚拟地址空间的哪个位置是否重要？例如，将对象映射到两个进程中的相同位置是否有利？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T12:36:34.697

只要涉及操作系统，就没有关系。如果在上下文切换之间没有刷新 TLB 缓存，那么在两个进程中使用相同的基地址会是有利的。Translation Lookaside Buffer (TLB) 缓存是一个小型缓冲区，用于缓存各个页面的虚拟地址到物理地址的转换，以减少从进程页表中读取昂贵内存的次数。每当发生上下文切换时，TLB 缓存就会被刷新——您不希望进程能够读取其他进程的一小部分内存，因为它的页表条目仍然缓存在 TLB 中。

在不同内核上运行的进程之间不会发生上下文切换。但是随后每个内核都有自己的 TLB 缓存，其内容与另一个内核的 TLB 缓存内容完全不相关。在同一进程的线程之间切换时不会发生 TLB 刷新。但是线程仍然共享它们的整个虚拟地址空间。

如果您将绝对指针传递给其中的区域，那么将共享内存段附加到相同的虚拟地址才有意义。例如，想象一下共享内存中的链表结构。通常的做法是使用块开头的偏移量而不是绝对指针。但这比较慢，因为它涉及额外的指针运算。这就是为什么使用绝对指针可以获得更好的性能，但是在两个进程的虚拟地址空间中找到合适的位置可能不是一件容易的事（至少不是以可移植的方式），即使在具有大量 VA 空间的平台上，如x86-64。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T20:39:28.710

我不是这里的专家，但鉴于没有其他答案，我会试一试。我不认为它真的会有所作为，因为虚拟地址不一定与物理地址相对应。换句话说，操作系统将您的虚拟地址映射到的底层物理地址不依赖于操作系统为您提供的虚拟地址。

再说一次，我不是记忆大师。对不起，如果我离开这里。

# actionscript-3 - 类的调度事件不在显示列表中

> ID：13351055
> 
> 赞同：0
> 
> 时间：2012-11-12T20:28:09.910
> 
> 标签：actionscript-3, apache-flex

我使用扩展 EventDispatcher 的控制器类来处理文件上传事件。当我将文件添加到此类中的 ArrayCollection 并且我想在其他地方更新组件时，最好的方法是什么？

看到我的控制器类不在显示列表中，如何通知我的组件更新？

感谢您提供任何有用的提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:15:23.120

@The_asMan：他想出了最好的方法；使用绑定。

# c# - HtmlAgilityPack Metro 版本？

> ID：13351060
> 
> 赞同：1
> 
> 时间：2012-11-12T20:28:24.030
> 
> 标签：c#, windows-8, windows-runtime, html-agility-pack

我对 WinRT 世界有点陌生，但我已经发现一些旧的库不再适用于 Metro，因为新的 WinRT 运行时。
现在我想将一些带有 HtmlAgilityPack 的旧项目转换为 Metro。旧的库不起作用，所以我从 Nuget 获得了最新的库。不幸的是，这与旧版本不兼容。有趣的是，在我使用 Nuget 的最新版本（完全相同）更新我的旧项目后，它仍然具有旧功能。

你能在同一个包中支持两个不同的运行时吗？这是如何运作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:36:09.700

您不需要像其他人那样将 HtmlAgilityPack 转换为 Metro。

我已经使用过它并且效果很好。

[http://fizzlerex.codeplex.com/](http://fizzlerex.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:41:44.360

NuGet 允许您包含不同 .NET Framework 版本的版本：

[支持多个 .NET Framework 版本和配置文件](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package#Supporting_Multiple_.NET_Framework_Versions_and_Profiles)

使用很多（例如 JSON.NET 有这个）为 net20/net35/net40/net45 或 silverlight/winrt 使用不同的程序集

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:32:07.630

不确定我是否完全理解这个问题。我会添加新库并重构我的旧代码以使用新库。否则，您将在同一个项目中拥有 2 个具有相同命名空间的库......这是行不通的。

# php - Zend2 - 模块特定导航

> ID：13351064
> 
> 赞同：0
> 
> 时间：2012-11-12T20:28:37.127
> 
> 标签：php, navigation, zend-framework2

我正在使用 Zend Framework 2，我想为`Admin`模块做一个导航。怎么做？

我可以简单地添加`local.php`导航树`module/Admin/config/autoload`吗？

编辑：现在我有导航`app-root/config/autoload/global.php`：

```
'navigation' => array(
    'default' => array(
        array(
            'label' => 'Admin home',
            'route' => 'admin',
        )
    )
) 
```

并在`app-root/module/Admin/config/module.config.php`：

```
'service_manager' => array(
        'factories' => array(
            'Navigation' => 'Zend\Navigation\Service\DefaultNavigationFactory'
        )
 ) 
```

并在`app-root/module/Admin/view/layout/layout.phtml`：

```
<?php echo $this->navigation('navigation')->menu(); ?> 
```

一切正常，但是当我从`navigation`数组中剪切`app-root/config/autoload/global.php`并将其放入时，`app-root/module/Admin/config/autoload/global.php`我得到一个错误：`Navigation can't be initalized`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T00:10:05.633

将导航配置放入`app-root/module/Admin/config/module.config.php`

# php - preg_match+多模式

> ID：13351065
> 
> 赞同：1
> 
> 时间：2012-11-12T20:28:37.897
> 
> 标签：php, regex, preg-match

我想更改此代码

```
$reg_exUrl = "/imageshack/";
if(preg_match($reg_exUrl, $imageURL, $url)) 
```

因此它将检查多个站点，例如

```
"/imageshack/,/photobucket/"; 
```

我是php的菜鸟！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:53:06.520

在正则表达式中，要选择多个选项，请使用`(|)`snytax：

```
$reg_exUrl = "/(imageshack|photobucket)/";
if(preg_match($reg_exUrl, $imageURL, $url)) 
```

请注意`/`它们只是正则表达式分隔符，而不是匹配模式的一部分。

# c# - c# LIST 中不区分大小写的匹配

> ID：13351067
> 
> 赞同：-1
> 
> 时间：2012-11-12T20:28:50.320
> 
> 标签：c#

我有一个清单，如下所示。

```
List<string> Animallist = new List<string>();
Animallist.Add("cat");
Animallist.Add("dog");
Animallist.Add("lion and the mouse");
Animallist.Add("created the tiger"); 
```

我有一个输入文本框

“不要责怪上帝创造了老虎，而是感谢他没有给它翅膀”

我想查看文本框中的哪些单词与列表中的项目匹配并在控制台上打印列表。搜索必须不区分大小写。即文本框中的TIGER 应该与列表中的tiger 匹配。

在上面的例子中，“created the tiger”将打印在控制台上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T20:31:25.273

```
var animalFound = Animals
    .Where(a=> a.Equals(searchAnimal, StringComparison.OrdinalIgnoreCase)); 
```

*   [String.Equals 方法（字符串、字符串比较）](http://msdn.microsoft.com/en-us/library/c64xh8f9.aspx)
*   [最佳实践：为您的方法调用选择一个 StringComparison 成员](http://msdn.microsoft.com/en-us/library/dd465121.aspx#choosing_a_stringcomparison_member_for_your_method_call)

或者，如果您还想搜索单词：

```
var animalsFound = from a in Animals
             from word in a.Split()
             where word.Equals(searchAnimal, StringComparison.OrdinalIgnoreCase)
             select a; 
```

哦，现在我看到了你的长文

```
string longText = "Do not blame God for having created the TIGER, but thank him for not having given it wings";
string[] words =  longText.Split();
var animalsFound = from a in Animals
             from word in a.Split()
             where words.Contains(word, StringComparer.OrdinalIgnoreCase)
             select a; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T20:31:52.993

```
var text = "Do not blame God for having created the TIGER, but thank him for not having given it wings";
var matched = Animallist.Where(o => text.Contains(o, StringComparer.CurrentCultureIgnoreCase));
foreach (var animal in matched)
    Console.WriteLine(animal); 
```

Specifying `StringComparer` or `StringComparison` will allow you to search for values that are case insensitive. Most `String` class methods will provide an overload that supports one of them.

# ruby-on-rails - 如何实现基于电子邮件地址隔离的“社交网络”？

> ID：13351069
> 
> 赞同：1
> 
> 时间：2012-11-12T20:28:55.957
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在建立一个基本的社交网络，并希望根据用户的电子邮件地址来划分网站的内容。整个站点的所有功能都是相同的，只是内容会有所不同。

例如，如果用户使用@berkeley.edu 电子邮件地址注册，他们只能与其他@berkeley.edu 用户成为朋友、评论和查看等。而拥有@uoregon.edu 电子邮件地址的用户只能与其他@uoregon.edu 用户加好友、评论和查看等。

什么是实现这一目标的好技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:36:14.290

您可以多租户系统从电子邮件域键控 - 然后所有查询都将在该租户键外运行。

例如...

租户表

> id，域（1，'berkeley.edu'）
> 
> id，域（2，'uoregon.edu'）

用户表

> id、tenantId、电子邮件 (1, 1, 'steve@berkeley.edu')
> 
> id、tenantId、电子邮件 (2, 1, 'fenton@berkeley.edu')
> 
> id、tenantId、电子邮件（3、2、'steve@uoregon.edu'）

每当您运行查询时，您都包括：

```
WHERE tenantId = 1 
```

仅显示来自伯克利的用户、内容、消息、图像等。

# jquery - 带有自己的 div 的 Jquery 下拉列表

> ID：13351070
> 
> 赞同：1
> 
> 时间：2012-11-12T20:29:04.423
> 
> 标签：jquery, ruby-on-rails

我怎么能做这样的事情：[链接](http://www.autoklad.ua/)

现在我这样做了（rails haml）：

```
= link_to "Масла/автохимия", :oil_mp, :id => "oil-dd"
          .oil-dd
            %ul
              %li
                = link_to "Масла моторные для легковых автомобилей", oils_path(:product_type_id => 13)
              %li
                = link_to "Масла трансмисионные", oils_path(:product_type_id => 15)
              %li
                = link_to "Антифризы", oils_path(:product_type_id => 3)
              %li
                = link_to "Вода дисцилированная", oils_path(:product_type_id => 6) 
```

我的 jquery 代码看起来是这样的：

```
$("#oil-dd").mouseover(function() {
    $(".oil-dd").show();
  });
  $("#oil-dd").mouseout(function() {
    $(".oil-dd").fadeOut(2000);
  }); 
```

我的主要问题是，当我离开#oil-dd 区域时，我的带有 ul 的 div`.oil-dd`消失了（“”）……但是怎么办，即使我没有#oil-dd（它必须显示我是在.oil-dd还是#oil-dd上），但是当我没有.oil-dd和#oil-dd时，.oil-dd会隐藏？

它必须与链接页面上的一样（近`Автозапчасти`）

在 HTML 中

```
<a href="/catalogs/oil_mp" id="oil-dd">Масла/автохимия</a>
    <div class="oil-dd" style="display: block;">
                <ul>
                  <li>
                    <a href="/catalogs/oils?product_type_id=13">Масла моторные для легковых автомобилей</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=15">Масла трансмисионные</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=3">Антифризы</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=6">Вода дисцилированная</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=5">Моющие жидкости</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=8">Жидкости тормозные</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=18">Автокосметика/автохимия</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=7">Жидкости гидравлические</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=11">Масла прочие</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=10">Масла индустриальные</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=12">Масла для грузовых автомобилей</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=16">Смазки</a>
                  </li>
                  <li>
                    <a href="/catalogs/oils?product_type_id=17">Тех.жидкости</a>
                  </li>
                </ul>
              </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:47:56.057

你可以试试这样的

```
​$(document).ready(function(){
    var timeOut=0;
    $("#oil-dd").mouseenter(function(){
        clearTimeout(timeOut);
        $(".oil-dd").stop(1,1).show();
    }).mouseleave(function() {
        timeOut=setTimeout(function(){
            $(".oil-dd").fadeOut(1000);
        }, 1000);

    });

    $(".oil-dd").mouseenter(function(){
        clearTimeout(timeOut);
    }).mouseleave(function(){
        timeOut=setTimeout(function(){
            $(".oil-dd").fadeOut(1000);
        }, 1000);
    });

}); 
```

[**一个例子**](http://jsfiddle.net/cKFTf/1/)。

# php - 当用户第一次通过 Paypal 重定向时，如何获取传递的已发布数据？

> ID：13351072
> 
> 赞同：0
> 
> 时间：2012-11-12T20:29:09.033
> 
> 标签：php, html, paypal, paypal-ipn

一段时间以来，我一直在努力解决这个问题。我有一个订单页面，客户必须在其中输入姓名、地址等信息以及一些更独特的字段。我已经用 Paypal 设置了 IPN，客户被重定向到我指定的页面。但数据并没有随之而来。我希望我能正确地问我的问题，这样我就不会被“关闭”。这是重定向到他们页面的 Paypal 提交按钮中的 HTML。

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="NT2YC6LP7SWBE">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<input type="hidden" name="child_name" id="child_name" value ="<? echo $child_name; ?>" maxlength="20"/>
<input type="hidden" name="age" id="age" value ="<? echo $age; ?>" maxlength="4"/>
<input type="hidden" name="hometown" id="hometown" value ="<? echo $hometown; ?>" maxlength="32"/>
<input type="hidden" name="boy_girl" id="boy_girl" value ="<? echo $boy_girl; ?>" maxlength="4"/>
<input type="hidden" name="first_name" id="first_name" value ="<? echo $first_name; ?>" maxlength="32"/>
<input type="hidden" name="last_name" id="last_name" value ="<? echo $last_name; ?>" maxlength="32"/>
<input type="hidden" name="email" id="email" value ="<? echo $email; ?>" maxlength="64"/>
<input type="hidden" name="address1" id="address1" value ="<? echo $address1; ?>" maxlength="64"/>
<input type="hidden" name="address2" id="address2" value ="<? echo $address2; ?>" maxlength="32"/>
<input type="hidden" name="city" id="city" value ="<? echo $city; ?>" maxlength="32"/>
<input type="hidden" name="state" id="state" value ="<? echo $state; ?>" maxlength="20"/>
<input type="hidden" name="zip" id="zip" value ="<? echo $zip; ?>" maxlength="10"/>
<input type="hidden" name="country" id="country" value ="<? echo $country; ?>" maxlength="32"/>
<input type="hidden" name="payment_type" id="payment_type" value ="paypal" maxlength="6"/>
<input type="hidden" name="paid" id="paid" value ="yes" maxlength="3"/>
<input type="hidden" name="mailed" id="mailed" value ="no" maxlength="3"/>
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

有人向我指出，某些变量不是“Paypal 变量”，我可以稍后修复，但在访问 Paypal 后，我的数据都没有返回到我指定的页面，即使是 Paypal 支持的变量，例如“城市。” 这是我在他们被重定向到的页面上的 PHP。

```
$raw_post_data = file_get_contents('php://input');
$raw_post_array = explode('&', $raw_post_data);
$myPost = array();
foreach ($raw_post_array as $keyval) {
  $keyval = explode ('=', $keyval);
  if (count($keyval) == 2)
     $myPost[$keyval[0]] = urldecode($keyval[1]);
}
$req = 'cmd=_notify-validate';
if(function_exists('get_magic_quotes_gpc')) {
   $get_magic_quotes_exists = true;
} 
foreach ($myPost as $key => $value) {        
   if($get_magic_quotes_exists == true && get_magic_quotes_gpc() == 1) { 
        $value = urlencode(stripslashes($value)); 
   } else {
        $value = urlencode($value);
   }
   $req .= "&$key=$value";
}

$ch = curl_init('https://www.paypal.com/cgi-bin/webscr');
curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_FORBID_REUSE, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: Close'));

if( !($res = curl_exec($ch)) ) {
    // error_log("Got " . curl_error($ch) . " when processing IPN data");
    curl_close($ch);
    exit;
}
curl_close($ch);

if (strcmp ($res, "VERIFIED") == 0) {
        $child_name = htmlentities($_POST['child_name']);
        $age = $_POST['age'];
        $hometown = $_POST['hometown'];
        $boy_girl = $_POST['boy_girl'];
        $email = $_POST['email'];
        $first_name = htmlentities($_POST['first_name']);
        $last_name = htmlentities($_POST['last_name']);
        $address1 = htmlentities($_POST['address1']);
        $address2 = htmlentities($_POST['address2']);
        $city = htmlentities($_POST['city']);
        $state = $_POST['state'];
        $zip = htmlentities($_POST['zip']);
        $country = htmlentities($_POST['country']);
        $payment_type = $_POST['payment_type'];
        $paid = $_POST['paid'];
        $mailed = $_POST['mailed'];
} else if (strcmp ($res, "INVALID") == 0) {
}       

        $query = "INSERT INTO customer_list (
        number, child_name, age, hometown, boy_girl, first_name, last_name, email,
        address1, address2, city, state, zip, country, payment_type, paid, mailed)
        VALUES ('', 
        '".mysql_real_escape_string($child_name)."',
        '".mysql_real_escape_string($age)."',
        '".mysql_real_escape_string($hometown)."',
        '".mysql_real_escape_string($boy_girl)."',
        '".mysql_real_escape_string($first_name)."',
        '".mysql_real_escape_string($last_name)."',
        '".mysql_real_escape_string($email)."',
        '".mysql_real_escape_string($address1)."',
        '".mysql_real_escape_string($address2)."',
        '".mysql_real_escape_string($city)."',
        '".mysql_real_escape_string($state)."',
        '".mysql_real_escape_string($zip)."',
        '".mysql_real_escape_string($country)."',
        '".mysql_real_escape_string($payment_type)."',
        '".mysql_real_escape_string($paid)."',
        '".mysql_real_escape_string($mailed)."')";
            if ($query_run = mysql_query($query)) {

                $subject = "Thank You for Your Order";
                $message = "Thank you for placing your order with My-Letter-From-Santa-Claus.com. \n\nYou can expect to receive your personalized letter soon. Please make note of your customer number. Your customer number is: ".mysql_insert_id().". \n\nPlease send all inquiries to : info@my-letter-from-santa-claus.com";
                $from = "info@my-letter-from-santa-claus.com";
                $headers = "From:" . $from;
                mail($email, $subject, $message, $headers);
                echo 'Thank you for your order.';
                echo 'Letter For '.$child_name;
            } else {
                echo mysql_error();
            } 
```

我直接从 x.com 复制了大部分内容，当然除了更改为我自己的变量。没有任何东西被发布到数据库中，但这不是问题，因为我什至无法回显数据。有几件事正在输入数据库，但不是来自我的订单页面的数据 - 它是在 Paypal 上作为信用卡信息输入的名字和姓氏，对于 payment_type，它显示“instan”（我最大化了） 6 个字符），但正如您从 HTML 中的隐藏输入字段中看到的那样，我想发布值“paypal”。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:56:13.563

您是否使用 Paypal 沙盒进行测试？如果没有，我强烈推荐：[https](https://developer.paypal.com/) ://developer.paypal.com/和手册：[https](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_Sandbox_UserGuide.pdf) ://cms.paypal.com/cms_content/US/en_US/files/developer/PP_Sandbox_UserGuide.pdf 。

我在您的代码中没有看到字段 name="business"。这是 Paypal 用来识别您的卖家帐户的字段。但也许它只与“cmd”参数有关（我使用 _xclick）。

这是目前对我有用的一组字段，也许对您有帮助：

```
<form name="_xclick" action="https://www.paypal.com/de/cgi-bin/webscr" method="post">
    <input type="hidden" name="cmd" value="_xclick">
    <input type="hidden" name="business" value="seller_email_here">
    <input type="hidden" name="notify_url" value="ipn_url_here">
    <input type="hidden" name="return" value="redirect_url">
    <input type="hidden" name="cancel_return" value="redirect_if_cancelled_url">
    <input type="hidden" name="amount" value="number_of_items">
    <input type="hidden" name="currency_code" value="EUR">
    <input type="hidden" name="item_name" value="product_name">
    <input type="hidden" name="item_number" value="product_number"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:12:40.723

您的问题是您使用的是托管按钮。您不能在这些的通用 HTML 中包含自定义内容。唯一可以包含的自定义字段必须在 PayPal 按钮创建向导中完成。

您还需要确保不会混淆 IPN 和 PDT。如果您只是希望数据返回到用户在完成付款后发送到的返回 URL，这将是 PDT。但是，不建议您使用它来处理订单后处理，因为不能保证用户会在那里完成。

IPN 可以用于此，因为无论如何它都会被触发，但同样，这与您的结帐和 PDT 完全分开。

我强烈建议您使用 Express Checkout 而不是标准按钮，因为您似乎也熟悉 PHP。我有一个[用于 PayPal 的 PHP 类库，](http://www.angelleye.com/overview-of-php-class-library-for-paypal/)这对您来说非常简单，如果您需要，我可以提供 30 分钟的免费培训，这通常足以让人们开始并运行，只要您了解 PHP 以及如何处理数组数据。

您也可以使用 Standard 来做到这一点，但您必须放弃使用 @AndreiHardau 显示的托管按钮。这将允许您包含[其他字段](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_Appx_websitestandard_htmlvariables)，例如 address1、address2、address_overide 等，然后这些字段将在 IPN、PDT 和 GetTransactionDetails 中返回。

# javascript - 如何读取实体的数量

> ID：13351074
> 
> 赞同：0
> 
> 时间：2012-11-12T20:29:18.850
> 
> 标签：javascript, azure

我有

```
for (var index in entries) 
```

条目是我从 azure -query 得到的响应。此条目是一个对象。

当我退出时，我想知道条目数。那就是我必须做一个逻辑：

```
int i;
    for (var index in entities) 
     if the for llop is exiting and this is the final iteration do som ething 
```

我怎样才能做到这一点 ？我不知道有多少实体

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:32:27.613

我的意思是在 上定义的数字或属性`entries`，你可以使用这个：

```
Object.keys( entries ).length 
```

顺便说一句，您不需要 for-in 循环。你可以像这样迭代：

```
Object.keys( entries ).forEach(function ( key ) {
    var value = entries[ key ];
    // do things with value
}); 
```

# java - 如何制作一个同时使用过滤器和漂亮打印的 ObjectWriter？

> ID：13351075
> 
> 赞同：3
> 
> 时间：2012-11-12T20:29:22.580
> 
> 标签：java, json, jackson

杰克逊提供了以下方法：

```
ObjectWriter ObjectMapper.writer(FilterProvider)
ObjectWriter ObjectMapper.writer(PrettyPrinter)
ObjectWriter ObjectMapper.writerWithDefaultPrettyPrinter() 
```

但我想在我的作家中同时使用漂亮的打印和自定义 FilterProvider。我如何获得同时使用两者的作家？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:35:28.487

您仍然可以在`ObjectWriter`任何方法返回的实例上配置它`ObjectMapper.write()`：

```
ObjectWriter objectWriter = ObjectMapper.writer(yourFilterProvider).withPrettyPrinter(yourPrettyPrinter); 
// or
ObjectWriter objectWriter = ObjectMapper.writer(yourPrettyPrinter).withFilters(yourPrettyPrinter); 
```

有关详细信息，请参阅[ObjectWriter 类](http://jackson.codehaus.org/1.9.2/javadoc/org/codehaus/jackson/map/ObjectWriter.html)

# haskell - haskell scanl元组

> ID：13351076
> 
> 赞同：1
> 
> 时间：2012-11-12T20:29:24.350
> 
> 标签：haskell, tuples, fold

我有一个元组列表：

```
myList = [(1,1000), (2,2000), (3,3000),(4,4000] 
```

我想处理这个列表，使每个元组的第一个元素保持不变，第二个元素是累积的。所以对于上面的 myList，它看起来像这样：

```
[(1,1000),(2,3000),(3,6000),(4,10000)] 
```

我尝试编写一个使用`scanl1`但无法编译的函数：

```
myFunction myList = scanl1 f l
           where f = (\acc (x,y) -> (x, acc + y)) 
```

任何帮助，非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:40:40.153

首先，这个问题有一个错字：它应该是`myList`而不是`l`in `myFunction myList = scanl1 f l`。

* * *

主要问题是`scanl1`应该有 type的第一个参数`a -> a -> a`，但是您的扫描函数`f`有 type `Num c => c -> (b, c) -> (b,c)`，并且当一个同时具有`a = c`and时，无法统一类型`a = (b,c)`​​（即`c = (b,c)`，“无法构造无限类型”错误）。

解决这个问题的方法是记住它`scanl1 f`适用`f`于列表中的上一个结果和下一个项目，在这种情况下，两者都是 form `(x,y)`。这给出了：

```
myFunction myList = scanl1 f myList
       where f (_,acc) (x,y) = (x, acc + y) 
```

（注意。下划线表示未使用的参数。）

# postgresql - 如何以非交互方式为 PostgreSQL 的 createdb 提供密码？

> ID：13351078
> 
> 赞同：12
> 
> 时间：2012-11-12T20:29:35.047
> 
> 标签：postgresql, jenkins, phing

我在 phing 中有一项任务，在测试之前我删除数据库（如果存在）并创建它。这是在 Jenkins 上运行的。我想用 createdb 像这样：

```
<exec command="createdb my_database" /> 
```

问题是 createdb 要求我进行身份验证并添加 -Umy_user 参数不是问题 - 问题是我无法在 createdb 命令中指定密码。而且我不想为系统用户（在本例中为“jenkins”）创建角色。有解决方案吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-13T12:45:37.373

`createdb`如果已设置，将使用[PGPASSWORD](http://www.postgresql.org/docs/current/static/libpq-envars.html)环境变量，这是在非交互式运行中提供密码的一种简单方法。

[另](http://www.postgresql.org/docs/current/static/libpq-pgpass.html)一种选择是在启动`createdb`.

# c# - 如何从 bbv.Common.StateMachine（现为 Appccelerate.StateMachine）类获取当前状态？

> ID：13351081
> 
> 赞同：12
> 
> 时间：2012-11-12T20:30:15.723
> 
> 标签：c#, state-machine

`bbv.Common.StateMachine`class 是我见过的最好的状态机代码。但它只缺少一件事：获取当前状态。

这是一个订单跟踪系统：

```
fsm = new ActiveStateMachine<States, Events>();

        fsm.In(States.OrderCreated)
            .On(Events.Submitted)
            .Goto(States.WaitingForApproval);
        fsm.In(States.WaitingForApproval)
            .On(Events.Reject)
            .Goto(States.Rejected);
        fsm.In(States.WaitingForApproval)
            .On(Events.Approve)
            .Goto(States.BeingProcessed);
        fsm.In(States.BeingProcessed)
            .On(Events.ProcessFinished)
            .Goto(States.SentByMail);
        fsm.In(States.SentByMail)
            .On(Events.Deliver)
            .Goto(States.Delivered);

        fsm.Initialize(States.OrderCreated);
        fsm.Start();
        fsm.Fire(Events.Submitted);
        // Save this state to database 
```

你可以很容易地看到它是如何工作的。

但我想将订单状态保存在数据库中。所以我将能够显示订单处于哪个状态。

我需要一个

```
fsm.GetCurrentState()
//show this state in the a table 
```

方法。实际上有一种方法：我可以`ExecuteOnEntry`在每个州的条目上使用和更改本地值。但是`ExecuteOnEntry`为每个州都写会很麻烦，因为我会重复自己！

必须有一个微妙的方法来做到这一点。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-13T12:45:32.540

正如丹尼尔解释的那样，这是设计使然。让我解释一下原因：

状态机允许事件排队。因此，向状态机询问其当前状态可能会产生误导。它当前处于状态 A，但已经有一个事件排队，它将使其进入状态 B。

此外，我认为将状态机内部状态（您在状态机定义中使用的状态）直接与状态机外部状态（您希望保留在数据库中的状态）耦合是一种糟糕的设计。如果您直接将这两者结合起来，您将失去在内部重构状态机而不影响外部（在您的情况下是数据库）的能力。我经常遇到必须将状态 A 拆分为 A1 和 A2 的场景，因为我必须将不同的操作附加到它们，但它们仍然代表环境的相同状态。因此，我强烈建议您将内部和外部状态分开，就像您使用 ExecuteOnEntry() 编写的那样，或者通过提供映射和使用扩展。这是一个可以让你了解当前状态的扩展：

```
public class CurrentStateExtension : ExtensionBase<State, Event>
{
    public State CurrentState { get; private set; }

    public override void SwitchedState(
        IStateMachineInformation<State, Event> stateMachine, 
        IState<State, Event> oldState, 
        IState<State, Event> newState)
    {
        this.CurrentState = newState.Id;
    }
} 
```

您可以通过这种方式将扩展添加到状态机：

```
currentStateExtension = new CurrentStateExtension();
machine.AddExtension(currentStateExtension); 
```

当然，您也可以直接使用此扩展来访问当前状态。为了更简单，让定义状态机的类实现扩展并将自己作为扩展传递。让你摆脱多余的课。

[最后一点：当您在https://groups.google.com/forum/?fromgroups#!forum/appccelerate](https://groups.google.com/forum/?fromgroups#!forum/appccelerate)的 google 组中询问有关 bbv.Common（或现在称为 Appccelerate）的问题时，对我来说更容易找到问题并回答它;-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T20:58:25.193

这是设计使然。我们将查询状态机的状态视为设计气味。但当然也有例外情况。您有以下两种选择：

1.  使用`ExecuteOnEntry`方法来保存订单的状态。这反映了要走的路，因为您不想将状态机的状态泄漏到您的业务逻辑中。
2.  编写您自己的内部使用的状态机装饰器`StateMachine<TState, TEvent>`。这暴露了状态。

丹尼尔

# jquery - 使用 jQuery .val() 返回值执行计算

> ID：13351086
> 
> 赞同：-1
> 
> 时间：2012-11-12T20:30:54.217
> 
> 标签：jquery, math

过去几个小时一直在尝试，但似乎无法使其工作。

我需要计算总和的平方根。似乎存在一种使用 Math.sqrt() 计算此值的 JavaScript 方法（[http://www.w3schools.com/jsref/jsref_sqrt.asp](http://www.w3schools.com/jsref/jsref_sqrt.asp)）。如何使用此方法计算总和的平方根？填写两个输入字段后显示总和并且工作正常..

[演示](http://jsfiddle.net/yunowork/zLKgT/)或代码如下：

```
$(document).ready(function(){
    $('#beers').keyup(calculate);
    $('#ranking').keyup(calculate);

function calculate(e)
{
    $('p#sum').html($('#beers').val() * 5 / $('#ranking').val() + 1); //calculation of the two fields
        /*Math.sqrt()*/ //This is the function to calculate the square root
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:34:04.653

首先，您需要将其转换为数字因为 .val() 返回一个字符串，并且您在这里将两个字符串相乘..

使用`parseInt()` or`parseFloat()`先转换为数字..

```
var beers = parseInt($('#beers').val() , 10 );
var rankings =  parseInt($('#ranking').val() , 10 );

var sqrt = Math.sqrt((beers * 5)/ (rankings + 1))

$('p#sum').html(sqrt); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/zLKgT/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:46:54.257

您需要做的是通过传入您想要平方根的数字来*调用：http:* [//jsfiddle.net/zLKgT/2/](http://jsfiddle.net/zLKgT/2/)`Math.sqrt`

```
$('#beers').keyup(calculate);
$('#ranking').keyup(calculate);

function calculate(e) {
    var maths = $('#beers').val() * 5 / $('#ranking').val() + 1;
    $('p#sum').text(maths);
    $('p#squareroot').text(Math.sqrt(maths));
}​ 
```

您无需事先将任何内容转换为数字，因为您使用的是数字对象，而不是使用`+`同时用于加法和连接的运算符。Javascript 会自动将`val`s 转换为数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:33:28.587

与您的问题相关的示例，将其转换为数字，使用 var 'answer' 您可以使用 Jquery 或您喜欢的任何其他方式在 html 中显示它

```
var numericFormat = new Number($('#beers').val() * 5 / $('#ranking').val() + 1)
var answer = Math.sqrt(numericFormat); 
```

# c# - 通过套接字缓冲和编组的字符数组，打印 System.Char[]

> ID：13351088
> 
> 赞同：0
> 
> 时间：2012-11-12T20:31:05.317
> 
> 标签：c#, arrays, sockets, char, marshalling

我正在使用 .NET 套接字制作客户端/服务器程序（它是我正在使用的系统的模型），以便于使用。一切顺利，数据全部发送；最大的问题是 char 数组。

我发送的数据包本质上是结构内的一堆双精度和一个字符数组（这是必要的/必不可少的，因为它在我正在模仿的系统上对数据包进行建模）。所有的双打都工作得很好，但是 char 数组有点棘手，因为数组需要 4 个字节/字符长。

我一直在使用编组库来处理字节数据以及 4 的 Char 数组缓冲区大小，如下所示：

```
[MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)] public char[] tmp; 
```

我还使用： [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)] 确保我的字符为 1 个字节。最终将读取我的客户端程序的服务器是用 C 语言编写的，我想确保类型对齐。

无论如何，我当前用来测试东西的服务器程序接收到数据包并且一切正常，但是当我尝试打印它以进行调试时，char 数组并没有完全按计划进行。

我有一个大字符串，我把所有的东西都放进去，像这样：

```
return_str += "\nChar Array (tmp) : " + str.tmp; 
```

然后我用稍后的函数调用打印它。

打印的内容如下：

```
 System.Char[] . 
```

而不是我指定的 char 数组（IE、ABCD 或类似的东西）。

我指定数据包值的方式是使用带有滑块和文本框等的 Windows 窗体应用程序。就像我说的那样，双打都完美地传达了它们的值，但这是另一个问题。

我不确定这是否是编组代码的问题，或者只是我缺少 char 数组的问题。

真的可以使用一些帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:42:58.273

调用`ToString()`a`char[]`将准确打印您所看到的内容。

您需要使用 将您`char[]`的字符串转换为字符串`new string(str.tmp)`。

如果您正在读取字符串，请考虑使用 a`byte[]`代替，然后使用`System.Encoding.Text`来读取字符串（有用于 ASCII 和各种 UTF 变体的编码器）。

# jquery - 如何删除 | 每个 ajax 加载页面时的 Html 脚本（Jquery）

> ID：13351092
> 
> 赞同：2
> 
> 时间：2012-11-12T20:31:15.143
> 
> 标签：jquery, html, regex

我想知道如何`|`在我的脚本中删除那些令人不安的特殊字符。

示例 HTML：

```
<a name="1">&nbsp;</a><br>|<b>5.11\. Monday</b> | 
```

这只是一个示例，它们在代码中到处都是某种菜单分隔符。

我在包装器中加载每个 Ajax 的页面，我想在那里操作它，例如删除菜单，唯一的问题是没有可以使用的类或 id，所以我必须找到一个正在搜索它们的解决方案.

所有这些都存储在 class="main" 的 div 中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:42:49.337

您可以简单地使用`replace`全局正则表达式（修饰符`g`）。请注意，您需要转义管道，因为它是一个正则表达式元字符：

```
str = str.replace(/\|/g, ''); 
```

正斜杠只是分隔符，`\|`是文字管道，并`g`确保**所有**出现的地方都被替换。

# .net - DataType(DataType.Date) 格式 (MVC)

> ID：13351109
> 
> 赞同：5
> 
> 时间：2012-11-12T20:32:00.497
> 
> 标签：.net, asp.net-mvc-3

我们可以以某种方式为此应用格式吗？

```
[Display(Name = "Date of Birthday")]
[DataType(DataType.Date)]
public DateTime DOB { get; set; } 
```

我只想看到日期而不是时间。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-12T20:34:02.953

您可以使用*DisplayFormatAttribute*

> 指定 ASP.NET 动态数据如何显示和格式化数据字段。

[http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayformatattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayformatattribute.aspx)

```
[DisplayFormat(DataFormatString = "{0:dd MMM yyyy}")]
[Display(Name = "Date of Birthday")]
[DataType(DataType.Date)]
public DateTime DOB { get; set; } 
```

# android - 开发前台服务建议

> ID：13351114
> 
> 赞同：0
> 
> 时间：2012-11-12T20:32:27.793
> 
> 标签：android, android-service

我想开发一个前台服务来产生声音。然而，我尝试的所有东西都只在我调试时有效，一旦我断开电缆并且手机是独立的，我就得不到我想要的东西。

我想要的是一种使用 CountDownTimer 每隔 X 间隔执行一个任务的服务，**即使**手机处于休眠状态也是如此。

为此，我使用了以下 2 个选项，每个选项都有其缺点：

1) 使用 startForeground() 创建前台服务；以后台服务结束。该服务只是在手机运行时进入睡眠状态，并且每隔一段时间操作系统就会运行它（我可以听到声音）。一旦我将手机打开到其锁定屏幕，该服务就会激活并立即发出声音。

2）利用WakeLock；这即使在手机睡眠时也有效，但现在手机的“进入睡眠”超时被禁用，但我仍然希望它打开，这样用户就不必按下锁定按钮。

有人可以告诉我我能做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:36:39.443

这`AlarmManager`可能是您正在寻找的。

[http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html)

```
setRepeating(int type, long triggerAtMillis, long intervalMillis, PendingIntent operation) 
```

> 安排重复警报。

```
setInexactRepeating(int type, long triggerAtMillis, long intervalMillis, PendingIntent operation) 
```

> 安排触发时间要求不准确的重复警报；例如，每小时重复一次的警报，但不一定在每小时的开头。

# javascript - 禁用和启用表单提交按钮

> ID：13351119
> 
> 赞同：0
> 
> 时间：2012-11-12T20:32:41.930
> 
> 标签：javascript, html, forms

我一直在尝试创建一些 javascript，它会在页面加载时禁用作为锚标记的提交按钮，然后在填写所有表单输入和文本区域时，它将被启用，并且按钮的类也需要启用时更改。

我有一些不成功的编码，并找到了一种 jquery 方法，但这不起作用，因为我使用的是锚标记而不是输入按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:35:12.350

要禁用任何`a`标签：

```
$('a').click(function(event)
{
  event.preventDefault();
}); 
```

如果您知道锚标记的 id 或类，则分别使用 $('#aId') o $('.aId')

如果你不想使用 jQuery：

```
var anchors = document.querySelectorAll('a');
for (var i = 0; i < anchors.length; i++ )
    anchors[i].onclick = function(event)
    {
     event.preventDefault();   
    }​​​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:35:25.763

您必须防止触发链接点击事件。

使用 jQuery 类似于：

```
$('a.disabled').on('click', function(event){
    event.preventDefault();
}); 
```

因此，当表单准备好提交时，您可以运行以下命令：

```
$('a.disabled').toggleClass('disabled enabled'); 
```

这会导致按钮被启用并且现在有类`.enabled`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:49:54.447

在 jQuery 中，您可以简单地通过`return false`

```
$("#disable_button").click(function(){
   //somethings you need
   return false;
}); 
```

# c - 排序后如何在 GtkTreeView 中重新启用拖放功能？

> ID：13351121
> 
> 赞同：2
> 
> 时间：2012-11-12T20:32:50.630
> 
> 标签：c, gtk

我正在使用 GtkTreeView。默认情况下，此小部件支持拖放。但是，如果您按其中一列对其进行排序，则拖放功能将被禁用（这是合乎逻辑的，并且我希望它可以正常工作）。

我想要一种清除排序的方法（我不关心实际的行，只需清除列标题中的箭头）并重新启用拖放。我尝试调用 gtk_tree_view_set_reorderable (tree_view, TRUE)，但这似乎不起作用。

# objective-c - Route-Me TapOnMarker hideLabel 不会隐藏所有其他标记标签，但会崩溃

> ID：13351131
> 
> 赞同：0
> 
> 时间：2012-11-12T20:33:12.893
> 
> 标签：objective-c, ios, route-me

我似乎在隐藏我的路线标记时遇到了一些麻烦。它们似乎显示得很好，但如果我尝试用 for 循环隐藏它们，它似乎会崩溃。这是我所拥有的：

```
- (void) tapOnMarker: (RMMarker*) marker onMap: (RMMapView*) map{
   NSArray* markers = mapView.markerManager.markers;
   for(RMMarker *mk in markers) {
       [mk hideLabel];
   }
   [marker showLabel];
} 
```

理论上，for 循环应该遍历标记管理器中的所有标记并隐藏它们，但它会因以下错误消息而崩溃：

```
-[RMMapLayer hideLabel]: unrecognized selector sent to instance 0x83f7680
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[RMMapLayer hideLabel]: unrecognized selector sent to instance 0x83f7680'
*** First throw call stack:
(0x1b91012 0x1959e7e 0x1c1c4bd 0x1b80bbc 0x1b8094e 0x4afa 0x6978a 0x8d433f 0x8d4552 0x8b23aa 0x8a3cf8 0x256bdf9 0x256bad0 0x1b06bf5 0x1b06962 0x1b37bb6 0x1b36f44 0x1b36e1b 0x256a7e3 0x256a668 0x8a165c 0x2b75 0x2a75)
libc++abi.dylib: terminate called throwing an exception 
```

仔细查看此错误消息，我确实注意到了一些东西，为什么它调用 RMMapLayer？hideLabel 函数在 RMMarker 类中。我确实把它写成“标记中的 RMMarker *mk”。我在这里做错了什么？提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:40:48.200

在你的 for 循环中尝试这样的事情：

```
 if ([mk isKindOfClass:[RMMarker class]])
    [mk hideLabel];
 else
    NSLog(@"We have a different class here:  %@", [mk class]); 
```

您还可以使用“respondsToSelector”方法来防止它...

# c# - ThreadPool 或 Task 是否适合用于服务器？

> ID：13351135
> 
> 赞同：6
> 
> 时间：2012-11-12T20:33:33.400
> 
> 标签：c#, .net, tcp, task-parallel-library, threadpool

我正在尝试将一些代码从创建一个新线程以运行一个函数转换为使其使用线程池甚至任务并行库。我这样做是因为我知道尽管工作线程的函数可能会无限期地运行（理论上），但每个线程将花费大部分时间什么都不做。我还想要一些东西来最小化创建和销毁工作线程的开销，因为连接可能会超时或创建新的连接。那 - 并且看到 CLRProfiler 显示 7836 个线程在 62 小时测试运行中/之后完成，这有点令人不安，单个（如果挑剔）设备发送消息。

这是我想要做的：

主线程。

1.) 让 TCPListener 接受 TcpClient

2.) 触发一个使用该 TcpClient 的工作线程

3.) 如果我们没有被告知停止，请返回第 1 步。

工作线程（用于池/任务）

1.) 检查我们是否有来自 TcpClient 的消息

2.) 如果是，则解析消息，发送到数据库，然后休眠 1 秒。

3.) 否则，休眠 1 毫秒。

4.) 如果我们没有被告知停止并且没有超时，请返回步骤 1。

这是原始方法：

```
private AutoResetEvent connectionWaitHandle = new AutoResetEvent(false);
private static bool stop = false;

private void MainThread()
{
    TcpListener universalListener = new TcpListener(IPAddress.Any, currentSettings.ListeningPort);
    universalListener.Start();

    while (!stop)
    {
        IAsyncResult result = universalListener.BeginAcceptTcpClient(WorkerThread, universalListener);
        connectionWaitHandle.WaitOne();
        connectionWaitHandle.Reset();
    }
}

private void WorkerThread(IAsyncResult result)
{
    TcpListener listener = result.AsyncState as TcpListener;

    if (listener == null)
    {
        connectionWaitHandle.Set();
        return;
    }

    TcpClient client = listener.EndAcceptTcpClient(result);
    connectionWaitHandle.Set();

    NetworkStream netStream = null;

    bool timedout = false;

    try
    {
        while (!timedout && !stop)
        {
            if (client.Available > 0)
            {
                netStream = client.GetStream();

                //Get and Parse data here, no need to show this code
                //The absolute fastest a message can come in is 2 seconds, so we'll sleep for one second so we aren't checking when we don't have to.
                Thread.Sleep(1000);
            }
            else
            {
                //Sleep for a millisecond so we don't completely hog the computer's resources.
                Thread.Sleep(1);
            }

            if (/*has timed out*/)
            {
                timedout = true;
            }
        }
    }
    catch (Exception exception)
    {
        //Log Exception
    }
    finally
    {
        client.Close();
    }
} 
```

我试过替换 UniversalListener.BeginAcceptTcpClient(...) 等。所有与

```
(new Task.TaskFactory.FromAsync<TCPClient>(universalListener.BeginAcceptTcpClient, universalListener.EndAcceptTcpClient, universalListener).ContinueWith(WorkerThread); 
```

以及删除 AutoResetEvent connectionWaitHandle 代码，但工作线程似乎只触发一次。

我也有点不确定我是否应该尝试使用线程池或任务，因为我能找到的关于线程池和任务（官方文档或其他）的所有内容似乎都表明它们应该与具有极寿命短。

我的问题是：

1.  线程池甚至任务并行库中的任务是否适合长期存在但主要是轮子旋转的线程？
2.  如果是这样，我将如何最好地实施正确的模式？
3.  如果是这样，我对使用 TaskFactory.FromAsync(...).ContinueWith(...) 有正确的想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:37:41.587

默认情况下，TPL 将使用线程池。因此，无论哪种方式，您都在使用线程池。问题是您使用哪种编程模型来访问池。我强烈建议使用 TPL，因为它提供了卓越的编程抽象。

您示例中的线程实际上并没有*旋转*（消耗 CPU 周期），而是*阻塞*了等待句柄。这是非常有效的，并且在阻塞时不会消耗线程。

**更新**

TaskFactory.FromAsync(...).ContinueWith(...) 模式是合适的。有关原因的详细列表，请参阅[此问题](https://stackoverflow.com/q/7578998/141172)。

如果您使用的是 C# 5 / .NET 4.5，则可以使用 async/await 更紧凑地表达您的代码模式。

[http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2010/11/22/c-5-0-rise-of-the-task.aspx](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2010/11/22/c-5-0-rise-of-the-task.aspx)

# html - 隐藏取消隐藏 div 标签

> ID：13351146
> 
> 赞同：2
> 
> 时间：2012-11-12T20:34:19.887
> 
> 标签：html, primefaces, show-hide

以下是javascript代码：

```
<script language="JavaScript">
    function ShowHide(divId)
    {
        if(document.getElementById(divId).style.display == 'none')
        {
            document.getElementById(divId).style.display='block';
        }
    }
</script> 
```

这是调用 showhide 函数的 xhtml 代码：

```
<p:column>
<p:commandLink onclick="javascript:ShowHide('HiddenDiv');" ajax="false" value="#{rail.trainNo}" action="#yardMaster.populateTrainDetails(rail.trainNo)}" style="font-family:Times New Roman, Times, serif;"></p:commandLink>
</p:column> 
```

以上是应该取消隐藏以下部门的链接：

```
<div style="display: none" id="HiddenDiv">
 Stuff
</div> 
```

基本上我试图取消隐藏第一次呈现网页时未显示的 div 标签中的表格。这只是工作了一半，因为当我单击链接时，它会出现一秒钟左右，然后立即消失。我究竟做错了什么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:45:38.987

删除`ajax="false"`. 您不需要只刷新给定 div 的整个页面。在您的情况下，当您单击`p:commandLink`div 时，将显示该 div，但由于`ajax="false"`整个页面已刷新 - 这将显示您的 div 初始状态。

# c++ - 调整指针数组的大小c ++

> ID：13351148
> 
> 赞同：0
> 
> 时间：2012-11-12T20:34:24.200
> 
> 标签：c++, arrays, object, pointers, resize

假设我有这个

```
#define T 10

StackOverflow *_stObject[H]; 
```

如何将此数组“调整”为 20？我不能使用向量。我必须将这 11 个位置复制到另一个具有 20 个位置的指针数组，但是这样我就不能在我的其他函数中使用这个对象。

这个对象存储数据，当它满了我需要找到一种方法来继续添加数据。

我怎样才能做到这一点？

好的，这里有更多信息，因为它不起作用。我做了方法 extendArray() 但是当我做 r = temp 时它有一个错误

这是一个计算器，Reg 类存储了我在计算器中进行的操作的信息。对象“r”存储了 10 个操作，如果我进行超过 10 个操作，我必须扩展这个指针数组。

我收到的错误消息在 r = temp 中，它说：'Reg* [20]' 到 'Reg* [10]' 的分配中的类型不兼容|

```
#define T 10

   class Calculator
    {
        public:
            Calculator();
            Calculator(NumComp&,NumComp&);
            ~Calculator();

            void printVisor();
            void setCalculator(const NumComp&,const NumComp&);
            void menu();
            void help();
            void clean();
            void run();
            void extendArray();

        private:
            NumComp n1, n2;
            Reg *r[T];
            int _tMax;
    };

        void Calculator::extendArray()
    {
        Reg *temp[T*2];

        for(int i = 0; i < 5; i++){
            temp[i] = new Reg;
            temp[i] = r[i];
          delete r[i];
         }

        r = temp;
        _tMax *= 2;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:38:32.440

您必须创建一个新数组并进行深层复制。

```
 StackOverflow * array = new StackOverFlow[(H * 2)];

 for (int i = 0; i < H; i++)
       arrary[i] = _stObject[i]; 
```

现在您有一个数组，其大小是原始数组的两倍，其中包含原始数据的所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:53:47.333

如果您的作业/作业表明您不能使用任何 STL 容器，您可以执行以下操作

```
#define T 10

class NumComp {
// ---
};

class Reg {
// ---
};

class Calculator
{
     public:
         Calculator();
         Calculator(NumComp&,NumComp&);
         ~Calculator();

         void printVisor();
         void setCalculator(const NumComp&,const NumComp&);
         void menu();
         void help();
         void clean();
         void run();
         void extendArray();

     private:
         NumComp n1, n2;
         Reg** r;
         int _tMax;

         void createArray();
         void cleanupArray(); 
};

Calculator::Calculator() {
    createArray();
}

Calculator::Calculator(NumComp&,NumComp&) {
    createArray();
}

Calculator::~Calculator() {
    cleanupArray();
}

void Calculator::createArray() {

    // create a pointer array
    r = new Reg*[T];

    // initialize to nulls
    for (int i = 0; i < T; i++) {
        r[i] = 0;
    }

    _tMax = T;
}

void Calculator::cleanupArray() {

    // make sure the contents of r[] are deleted by whoever allocates them
    delete [] r;
    r = 0;
}

void Calculator::extendArray()
{
    Reg** temp = new Reg*[_tMax*2];

    // copy contents of r to temp
    for(int i = 0; i < _tMax; i++) {
        temp[i] = r[i];
    }

    // initialize rest of temp
    for (int i = _tMax - 1; i < _tMax*2; i++) {
        temp[i] = 0;
    }

    // delete what was originally in r
    delete [] r;
    r = temp;

    _tMax *= 2;
} 
```

扩展数组的唯一方法是将其内容复制到更大的数组中。您不能简单地将较大的数组分配给较小的数组（这就是您收到错误的原因`incompatible types in assignment of 'Reg* [20]' to 'Reg* [10]'`）。但是您可以将任意大小的指向数组的指针分配给另一个指向数组的指针（相同类型）。所以要扩展一个数组，首先创建一个更大的数组，将较小数组的内容复制到它，清理较小的数组，将指向较大数组的指针分配给较小的数组。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-12T22:31:54.300

如果您不能使用`std::vector`（这将是最合理的使用方式），那么您可以编写自己的具有简化功能的“向量”：

```
class MyVector
{
    int size;
    int capacity;
    StackOverFlow ** data;

    public:

    MyVector() : size(0), capacity(10), data(new StackOverFlow * [10]) {}
    ~MyVector() {delete data;}

    void duplicateCapacity()
    {
        capacity *= 2;
        StackOverFlow ** tmp = new StackOverFlow * [capacity];
        for(int i=0; i<size; i++)
             tmp[i] = data[i];
        delete data; //<-- here was an error...
        data = tmp;
    }

    void add(StackOverFlow * item)
    {
        if(size == capacity)
            duplicateCapacity();
        data[size++] = item; 
    }

    StackOverFlow * get(int index) {return data[index];}
}; 
```

有了这个基本功能，您就可以完成工作。

# wpf - 如何制作一个允许 $（美元符号）在第一个位置的正则表达式？

> ID：13351149
> 
> 赞同：0
> 
> 时间：2012-11-12T20:34:28.120
> 
> 标签：wpf, regex, validation, xaml, currency

我正在使用 ValueConverter 将`double`类型显示为货币。我想确保输入是有效的，所以我尝试使用我制作的这种验证方法。我唯一的问题似乎是我无法选择整个值（即 500.00 美元）并输入任何内容。如果未选择“$”，一切似乎都很好。我怎样才能解决这个问题？

XAML：

```
<TextBox Text="{Binding Converter={StaticResource MoneyConverter}, Path=fr}"
  PreviewTextInput="ValidateMoney" DataObject.Pasting="TextBox_Pasting"/> 
```

后面的代码：

```
private void ValidateMoney(object sender, TextCompositionEventArgs e) {
  Regex rgx = new Regex(@"^(\$)[0-9]*[.]{0,1}[0-9]*$|^[.][0-9]+$|^[0-9]*[.]{0,1}[0-9]*$");
  e.Handled = !rgx.IsMatch((sender as TextBox).Text.Insert((sender as TextBox).SelectionStart, e.Text));
}
public class MoneyConverter : IValueConverter {
  public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
    if (value != null) {
      double d;
      string temp = value.ToString();
      if (double.TryParse(temp, out d)) {
        return String.Format("{0:C}", d);
      } else {
        return value;
      }
    } else {
      return value;
    }
  }
  public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
    if (value != null) {
      double d;
      string temp = value.ToString();
      if (double.TryParse(temp, out d)) {
        return String.Format("{0:C}", d);
      } else {
        return value;
      }
    } else {
      return value;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:37:13.017

您包含美元符号的方法是正确的，尽管括号是不必要的。写这个就足够了：`^\$`.

您可以大大简化您的正则表达式：

*   您不需要交替使用三个单独的案例。那里有一些不必要的重复。
*   `{0,1}`可以替换为`?`。
*   您可能希望确保至少有一位数字。

试试这个：

```
@"^\$?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$" 
```

或者使用捕获组来减少混乱：

```
@"^\$?([0-9]+(\.[0-9]+)?|\.[0-9]+)$" 
```

其他几点：

*   您应该知道`TryParse`受当前文化的影响。`1.990`根据您的文化，意味着不同的东西。
*   `ToString`也取决于文化。该`"{0:C}"`格式不保证美元符号。
*   您的正则表达式允许`$.990`. 这可能是你想要的，但对我来说它看起来有点奇怪。
*   您可能应该使用`decimal`而不是`double`存储货币金额。`double`类型不能`1.99`准确存储，但可以`decimal`。
*   我换成`[.]`了等价物`\.`，但这只是口味问题。两者都做同样的事情。

# c# - 下载文件 asp.net 后禁用按钮不起作用

> ID：13351150
> 
> 赞同：2
> 
> 时间：2012-11-12T20:34:33.373
> 
> 标签：c#, asp.net

我有以下代码将文件从服务器下载到客户端，单击按钮时会发生这种情况`btnSavetoDB_ExportToExcel`，之后我想让按钮禁用，我该如何实现？

```
string fileName = newFN + ".xlsx";
                Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
                Response.AddHeader("Content-Disposition", "attachment;filename=" + fileName);
                Response.TransmitFile(DestFile);                    
                Response.End();
btnSavetoDB_ExportToExcel.Enabled = false; 
```

我注意到放置上面的代码（响应）时按钮没有被禁用，因为我在那里有另一个代码并且按钮被它禁用了。所以它必须与响应有关。

**编辑：**

按钮在 a 内`ModalPopupExtender`，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:45:53.720

这样做的原因是，如果您使用服务器代码禁用按钮，则需要将响应返回到浏览器窗口。

在这里，您将浏览器捕获的流作为文件返回，而不是返回到浏览器窗口，因此当前显示永远不会更新。

为了解决这个问题，您可以在 html 本身的按钮上实现一个 javascript 行。

您可以在 Page_Load，f.ex 的代码中使用 Attribute.Add()：

```
btnSavetoDB_ExportToExcel.Attribute.Add("onclick","this.disabled=true") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:21:06.807

至少有两种可能的解决方案。
1）您可以在服务器上的临时目录中生成文件，并为用户提供指向该文件的链接（或重定向到该链接），而不是将文件写入响应。

`Page_Load`2）如果您想使用写入响应，您可以创建新的 Generate.aspx 页面，在其方法中将文件写入响应。

```
if (Request.QueryString["ID"] != null)  
{
    //find file by its ID
    ...
    Response.AddHeader("Content-disposition", "attachment; filename=" + fileName));
    Response.ContentType = "application/octet-stream";
    Response.WriteFile(fullFileName);
    Response.End();
} 
```

在您的 btnSavetoDB_ExportToExcel 页面上`Page_Load`添加以下代码：

```
var script = @"<script language=JavaScript>function Export(fileID)
{
        var iframe = document.createElement('iframe');
        iframe.src = 'Generate.aspx?ID='+ fileID;
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
}
</script>";

Page.RegisterStartupScript("Startup", script); 
```

然后只需调用 javascript`Export`方法将文件发送给用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:01:17.227

正如另一个答案中提到的，该按钮应在客户端禁用（因为您`Response.End()`在代码中使用，ASP.NET 将永远不会呈现带有`Enabled=False`.

在您的 .aspx 文件中添加

```
<asp:Button ID="btnSavetoDB_ExportToExcel" OnClientClick="this.disabled=true;" [..] /> 
```

但也请注意，这可能不是一个好主意——如果用户不小心从文件下载窗口单击“取消”怎么办？

更好的解决方案（了解您希望防止用户多次单击该按钮）是添加一个计时器以重新启用该按钮：

```
<asp:Button ID="btnSavetoDB_ExportToExcel" OnClientClick="var a=this; a.disabled=true; window.setTimeout(function() { a.disabled=false; }, 5000)" [..] /> 
```

值`5000`是以毫秒为单位的时间，在此之后按钮将被重新启用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:50:12.207

我找到了解决问题的方法，归功于：Dave Ward [（点击这里）](http://encosia.com/disable-a-button-control-during-postback/)

```
<asp:Button ID="btnSavetoDB_ExportToExcel" runat="server" 
                    OnClientClick="this.disabled = true;"
                    UseSubmitBehavior="false"
                    Text="Save results to DB and export to Excel"   
                    onclick="btnSavetoDB_ExportToExcel_Click" /> 
```

这可以解决问题： `OnClientClick="this.disabled = true;"` `UseSubmitBehavior="false"`

# android - 如何在没有 notifyDataSetChanged 的 情况下过滤 listView？

> ID：13351151
> 
> 赞同：0
> 
> 时间：2012-11-12T20:34:39.433
> 
> 标签：android, android-listview

在开发我的第一个应用程序时，我想让用户能够搜索 ListView 中的条目（它在 UI 线程中）。为此，我将 SearchView 添加到操作栏中。

```
listView1.setTextFilterEnabled(true); 
```

在 AsyncTask 中，我将 Adapter 设置为 listView：

```
protected void onPostExecute(boolean result) {
ListAdapter listadapter= new ArrayAdapter<String>(getApplicationContext(), R.layout.list_item, nameList);
listview1.setAdapter(listadapter);
} 
```

现在搜索视图：

```
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);    
    SearchView searchView = (SearchView) menu.findItem(R.id.menu_search).getActionView();
searchView.setOnQueryTextListener(this);
return true;
[...]
} 
```

我还添加了这些功能：

```
public boolean onQueryTextChange(String newText) {
    ListView listview1= (ListView) findViewById(R.id.mylist);
    listview1.setFilterText(newText);
    //mFilter.filter(newText);
    return false;
}

public boolean onQueryTextSubmit(String query) {
    ListView listview1= (ListView) findViewById(R.id.mylist);
    listview1.setFilterText(query);
} 
```

*现在*过滤工作正常，但是这个带有搜索到的字符序列的覆盖隐藏了过滤后的数据->看起来不太好。

当我到处阅读时，没有简单的可能性来关闭这个覆盖。所以我稍微改变了我的代码：

```
onPostExecute(blaaaaa) { [...]
     //Filter mFilter= = new ArrayAdapter<String>(getApplicationContext(), R.layout.list_item, nameList).getFilter(); 
```

和两个功能：

```
 //mFilter.filter(the_entered_text);
 ((ArrayAdapter<String>)listAdapter).getFilter().filter(query);
 ((ArrayAdapter<String>)listAdapter).notifyDataSetChanged(); 
```

**我现在的问题是，我怎样才能让 listView 得到更新？** “listview1.notifyDataSetChanged()”对我来说不是选项，因为它不适用于我的 ListAdapter。

编辑：转换适配器，就像在答案 postet 中一样，现在它可以工作了，但它会过滤：输入的文本 =“ka”-> 显示所有以“ka”开头的条目，而不是包含“ka”的条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:46:05.857

`listview1.getAdapter().notifyDataSetChanged()`

简单的

# scala - 自动检查依赖项是否是最新的

> ID：13351155
> 
> 赞同：1
> 
> 时间：2012-11-12T20:35:05.687
> 
> 标签：scala, sbt

我正在寻找一种工具来检查我的 SBT 构建定义中的库依赖项是否是最新的。我听说存在这样的工具，但我的谷歌技能让我失望。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:45:03.783

您可以使用Roman Timushev 的[SBT 插件](https://github.com/rtimush/sbt-updates-plugin)

# matplotlib - 创建与地球上特定区域相对应的简单底图

> ID：13351157
> 
> 赞同：3
> 
> 时间：2012-11-12T20:35:13.980
> 
> 标签：matplotlib, gdal, matplotlib-basemap

我正在尝试熟悉 matplotlib 和 Basemap。首先，我正在尝试生成与我拥有数据的特定网格相匹配的格陵兰图像。

下面令人毛骨悚然的细节描述了我的问题：我无法创建与所需投影/区域匹配的正确尺寸的图像。

我想匹配的投影和网格： Projection as Proj4 string：`"+proj=stere +lat_0=90 +lon_0=-45 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m"`

由网格定义的区域是一个 800x1400 2000m 分辨率的网格，其中：LowerLeft Corner 的外边缘（m）：-700,000.，-3,400,000。右上角的外边缘 (m)：900,000.，-600,000。=> (-700,000 + 2000 * 800, -3,400,000 + 2000 * 1400)

底图不允许我为立体投影指定以米 xy 为单位的角，因此我必须将它们转换为纬度/经度。

```
> gdaltransform -s_srs "+proj=stere +lat_0=90 +lon_0=-45 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" -t_srs "+proj=latlong"`
-700000 -3400000
-56.6336339989404 58.7244253840871 0
900000 -600000
11.3099324740202 80.0389929796586 0 
```

现在我应该拥有创建 800x1400 图像的所有信息。

```
from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt

def create_map():
    fig = plt.figure(1, figsize=(8, 14), frameon=False, dpi=100)
    fig.add_axes([0, 0, 1, 1])

    m = Basemap(resolution="i",
                projection='stere', lat_ts=70, lat_0=90., lon_0=-45.,
                llcrnrlon=-56.6336339989404, llcrnrlat=58.7244253840871,
                urcrnrlon=11.3099324740202, urcrnrlat=80.0389929796586,
                rsphere=(6378137.0, 6356752.3142))

    m.drawcoastlines()
    m.fillcontinents(color='#c1c1c1')
    m.drawmapboundary(fill_color='#6587ad', linewidth=0.0)
    plt.savefig('greenland.png', pad_inches=0.0, bbox_inches='tight')

if __name__ == '__main__':
    create_map() 
```

我面临的问题是，当我这样做时，我得到一个 800x1399 的图像。如果我没有`bbox_inches='tight'`在`plt.savefig`命令中包含 ，我会得到一个 800x1400 的图像，沿着（编辑）底部边缘（编辑）有一条不可见的像素。

任何人都可以帮助我，以便我可以确定我正在正确设置我的底图吗？我觉得我可能只是错过了一个简单的技巧，但没有得到我期望的大小的图像很奇怪。

与往常一样，提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:32:51.680

看来这可能是 matplotlib 中的错误的结果。Jeff Whitaker 看了看，说它看起来不错，我尝试在不使用 Basemap 的情况下重现这种行为，我能够做到。

似乎数据值的方面可能会导致输出图像的大小错误。

这是一些显示问题的代码。很抱歉误报。

```
# rectangle.py   --
import matplotlib.pyplot as plt

def create_image():
    fig = plt.figure(1, figsize=(8, 14), frameon=False, dpi=100)
    fig.add_axes([0, 0, 1, 1])
    ax = plt.gca()

    # This isn't necessary to create the issue unless you want to see the
    # transparent pixels at bottom.

    # for spine in ax.spines.values():
    #     spine.set_linewidth(0.0)

    limb = ax.axesPatch
    limb.set_facecolor('#6587ad')

    x1 = 0.0
    y1 = 0.0
    x2 = 16.

    # Use this line and get what I was expecting:
    #    y2 = 27.999999999999994671   # produces 800 x 1400 image

    # Use this line and get the wrong size
    y2 = 27.999999999999994670   # produces (wrong?) 800 x 1399 image

    corners = ((x1, y1), (x2, y2))
    ax.update_datalim(corners)
    ax.set_xlim((x1, x2))
    ax.set_ylim((y1, y2))

    ax.set_aspect('equal', anchor='C')
    ax.set_xticks([])
    ax.set_yticks([])

    plt.savefig('rectangle.png', pad_inches=0.0, bbox_inches='tight')

    # If you use this below, the file size is correct, but there is a single
    # line transparent pixels along the bottom of the image if you set the
    # linewidth to zero...

    #  plt.savefig('rectangle.png', pad_inches=0.0)

if __name__ == '__main__':
    create_image() 
```

# javascript - jtable (jquery) 缺少对话框格式

> ID：13351162
> 
> 赞同：5
> 
> 时间：2012-11-12T20:35:30.287
> 
> 标签：javascript, jquery, jquery-ui, jquery-jtable

我正在尝试根据[GettingStarted](http://www.jtable.org/GettingStarted)的文档创建 jquery jtable 。

每次打开对话框时，都会丢失整个格式/对话框样式。我仍然可以看到文本，而按钮是链接，但它看起来很糟糕。

感觉就像我错过了一些非常微不足道的东西，但我似乎无法找出什么。

[我在这里](http://goo.gl/3bRHC)尝试过，您可以在其中看到缺失的样式（与[GettingStarted](http://www.jtable.org/GettingStarted)上的几个对话框相比）。

我正在使用**jquery-1.7.2.min.js**和**jquery-ui-1.8.23.custom.min.js**（也在[jquery-ui.js](http://code.jquery.com/ui/1.9.1/jquery-ui.js)上尝试过 CDN 版本，结果相同）。

**编辑**：这里没有故意实现逻辑。我知道添加记录不起作用，但样式仍应显示对话框。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T20:40:49.187

如果您查看[jtable.css](http://leitzler.net/te/jtable/themes/lightcolor/red/jtable.css)的源代码，它正在导入：

```
@import '../jtable_lightcolor_base.css'; 
```

该文件是否存在于您的目录结构中？如果不是，那么这可能就是导致问题的原因。

**更新**

对话框格式是 jQuery UI 的一部分，您没有包含 jQuery UI CSS

```
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/themes/base/jquery-ui.css" type="text/css" rel="stylesheet" /> 
```

# html - 在页面中间创建内容面板

> ID：13351164
> 
> 赞同：2
> 
> 时间：2012-11-12T20:35:57.117
> 
> 标签：html, css, jsf, primefaces

我想创建一个位于页面绝对中间的内容面板。它可以在滚动条出现之前将其宽度和高度扩展到页面的某个百分比。

我在 JSF 页面上使用 Primefaces。我相信有很多解决方案可以做到这一点。我想用JSF的作文。

这是我的解决方案：

```
<p:layout id="layout">
        <p:layoutUnit position="center">
            <p:panel header="Test" style="width:50%">
                <ui:insert name="content"/>
            </p:panel>
        </p:layoutUnit>
    </p:layout> 
```

然而，这并没有真正做任何事情。它不居中，我插入“内容”标签的内容会扩展到整个页面。

谁能帮助我如何实现我的目标？

编辑

我已经尝试了 Rick Calder 发布的解决方案。下面是我的代码。但是，它对我不起作用。我将css写入style.css。我将 javascript 写入 resizeContentPanel.js。我在resource.xhtml 的头部加载JQUery 和resizeContentPanel.js。我相信这些都是正确的步骤。有什么我可能会丢失的。

至于我实际上错了什么，我没有看到内容面板。当我调试 javascript 时，它的高度边距为 -71，宽度边距为 -160。我假设这就是我看不到它的原因。

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
  xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>
        <ui:insert name="windowTitle"/>
    </title>

    <h:outputStylesheet library="css" name="style.css"/>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <h:outputScript library="scripts" name="resizeContentPanel.js" />
</h:head>
<h:body>
    <div class="centeredPanel">
        <p:layout id="layout" >
            <p:layoutUnit position="center">
                <ui:insert name="content"/>
            </p:layoutUnit>
        </p:layout>
    </div>

    <h:form>
        <div id="stack">
            <p:stack id="stackMenu" icon="/resources/images/stack/stack.png" model="#{pageBuilder.stackMenuModel}" /> 
        </div>
    </h:form>

    <div id="dock">
        <p:dock id="dockMenu" model="#{pageBuilder.dockMenuModel}"/>
    </div>

</h:body> 
```

样式.css

```
root 
{ 
    display: block;
}

body
{
    background-image: url('../../resources/images/background/background.jpg');
}

.centeredPanel{
    width:25%;
    height:25%;
    min-width:100px;
    min-height:100px;
    position:absolute;
    left:50%;
    top:50%;
}​ 
```

调整内容面板.js

```
$(document).ready(function(){
var heightMargin =  -($('.centeredPanel').height()/2);
var widthMargin=  -($('.centeredPanel').width()/2);
$('.centeredPanel').css('margin-left',widthMargin);
$('.centeredPanel').css('margin-top',heightMargin);
});

$(window).resize(function(){
var heightMargin =  -($('.centeredPanel').height()/2);
var widthMargin=  -($('.centeredPanel').width()/2);
$('.centeredPanel').css('margin-left',widthMargin);
$('.centeredPanel').css('margin-top',heightMargin);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T20:46:53.937

为了使页面中的某些内容完美居中，您确实希望它具有固定大小，以便您可以进行计算。

```
.centeredPanel{
    width:500px;
    height:500px;
    position:absolute;
    left:50%; //sets left edge at the midway point of it's container
    top:50%; //sets top edge at the midway point of it's container
    margin-left:-250px; //moves the div back half it's width to centre it.
    margin-top:-250px; //moves the div up half it's height to centre it.
} 
```

演示：http: [//jsfiddle.net/calder12/qNNvb/](http://jsfiddle.net/calder12/qNNvb/)

使用百分比来做到这一点需要 jQuery。

```
.centeredPanel{
    width:25%;
    height:25%;
    min-width:100px;
    min-height:100px;
    position:absolute;
    left:50%;
    top:50%;
    background-color:red;
}​

$(document).ready(function(){
var heightMargin =  -($('.centeredPanel').height()/2);
var widthMargin=  -($('.centeredPanel').width()/2);
$('.centeredPanel').css('margin-left',widthMargin);
$('.centeredPanel').css('margin-top',heightMargin);
});

$(window).resize(function(){
var heightMargin =  -($('.centeredPanel').height()/2);
var widthMargin=  -($('.centeredPanel').width()/2);
$('.centeredPanel').css('margin-left',widthMargin);
$('.centeredPanel').css('margin-top',heightMargin);
}); 
```

演示：http: [//jsfiddle.net/calder12/qNNvb/3/](http://jsfiddle.net/calder12/qNNvb/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T15:21:59.103

您可能希望使用 JQuery 使页面居中。这个解决方案有效吗？

[https://stackoverflow.com/a/210733/1285564](https://stackoverflow.com/a/210733/1285564)

# mysql - 修复自动增量mysql

> ID：13351167
> 
> 赞同：2
> 
> 时间：2012-11-12T20:36:31.543
> 
> 标签：mysql, sql, database

> **可能重复：**
> [MySQL：重新排序/重置自动增量主键？](https://stackoverflow.com/questions/740358/mysql-reorder-reset-auto-increment-primary-key)

我的 sql 中有一个自动增量字段，我不小心删除了一些东西，现在我的表已经关闭，因为自动增量编号跳跃了。我忘记了确切的 sql 命令，但我记得有一个 Select table set auto increment='whatever' 我只是忘记了语法，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T20:38:38.700

```
ALTER TABLE theTableInQuestion AUTO_INCREMENT=1234 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T20:38:01.407

```
ALTER TABLE YOUR_TABLE AUTO_INCREMENT=YOUR_DESIRED_NUMBER; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T20:38:55.663

见下文：

```
ALTER TABLE tbl AUTO_INCREMENT = newNumber; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T20:45:47.793

根据[手册](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)：

```
ALTER table drop column autoinc_column;
ALTER table add column autoinc_column ...; 
```

其中“...”是用于创建初始列的相同参数。

# c# - c# dropdownlist selectedindexchanged in gridview设置第二个下拉列表的selectedindex

> ID：13351170
> 
> 赞同：2
> 
> 时间：2012-11-12T20:36:47.710
> 
> 标签：c#, gridview, drop-down-menu, selectedindexchanged

我有一个网格视图，其中包含从数据库填充的两个下拉列表。一个是描述性名称，另一个是缩写名称。我需要完成以下任务：

当我在 DDL1 中选择一个项目时，我需要更改 DDL2 的选定索引以匹配，反之亦然。

我在这里搜索并发现以下内容：

```
protected void ddlAddLabTest_SelectedIndexChanged(object sender, EventArgs e)
{
   DropDownList ddlLabTest = (DropDownList)sender;
   GridViewRow row = (GridViewRow)ddlLabTest.NamingContainer;
   DropDownList ddlAddLabTestShortName = (DropDownList)row.FindControl("ddlAddShortname");

   ddlAddLabTestShortName.SelectedIndex = intSelectedIndex;
} 
```

只有当它到达“行”的分配时，我才会收到以下信息：

```
Unable to cast object of type 'System.Web.UI.WebControls.DataGridItem' to type 'System.Web.UI.WebControls.GridViewRow'. 
```

我试图找到一个可行的例子，但我不能。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T21:08:12.597

试试这个

```
protected void ddlAddLabTest_SelectedIndexChanged(object sender, EventArgs e)
{
   DropDownList ddlLabTest = (DropDownList)sender;
   DataGridItem row = (DataGridItem) ddlLabTest.NamingContainer;
   DropDownList ddlAddLabTestShortName = (DropDownList)row.FindControl("ddlAddShortname");

   ddlAddLabTestShortName.SelectedIndex = intSelectedIndex;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:43:50.600

似乎`NamingContainer`不是一行，所以就这样吧。它已经有了`FindControl`方法。

```
var row = ddlLabTest.NamingContainer; 
```

# python - 改变测试的执行速度？

> ID：13351171
> 
> 赞同：4
> 
> 时间：2012-11-12T20:36:53.070
> 
> 标签：python, webdriver

**更新更多上下文：** Selenium 1 有一个名为“setSpeed”的命令。这允许每个命令的执行减慢 X 毫秒。Selenium 2 (Webdriver) 背后的团队决定弃用此命令，现在无法减慢测试运行速度，以便在执行期间轻松直观地监控应用程序。我已经阅读了开发人员关于他们弃用它的原因的解释，以及使用implicit_waits 等建议的解决方法，但这并不能解决我（或其他抱怨弃用的人）的问题。也就是说，我希望通过设置适用于 unittest 中的每个方法或整个测试套件的全局执行速度来解决这个问题。

**原始问题：**我想在命令之间使用不同的*延迟来执行不同的单元测试。*我知道我可以`time.sleep`在命令之间继续复制和粘贴，但肯定有一种方法可以设置一个通用睡眠，它将在指定方法中的每个命令之前运行？

```
 def test_x_test(self):
     driver = self.driver
     time.sleep(2)
     print("running the First selenium command such as click button")
     time.sleep(2)    
     print("running another Selenium command such as click link ")
     time.sleep(2)    
     self.driver.quit()

 if __name__ == '__main__':
     unittest.main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T05:25:49.990

啊，现在答案是如此明显。

创建一个辅助方法来控制 webdriver 操作，并在执行该操作之前暂停：

下面将是伪代码，因为我不再可以在工作中访问 Python IDE

```
#passing in Webdriver instance and the command we want to execute into our helper method   
webdriverHelper(driver, command):
    #this 2 second sleep will get run each time
    time.sleep(2)
    if command == "click":
        driver.getElement.click()
    elif command== "getText":
        driver.getElement.getText()
    etc............... 
```

# c - C语言中的inotify文件

> ID：13351172
> 
> 赞同：11
> 
> 时间：2012-11-12T20:36:57.157
> 
> 标签：c, inotify

我正在尝试在 C 中运行 inotify 的示例，但它不起作用。我想监视对文件的修改（文件是 tmp.cfg），但它不起作用..我不知道我是否正确运行它，因为我了解如何监视目录，但不是单个文件示例如下：

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <sys/types.h>
#include <sys/inotify.h>
#include <unistd.h>

#define EVENT_SIZE  ( sizeof (struct inotify_event) )
#define BUF_LEN     ( 1024 * ( EVENT_SIZE + 16 ) )

int main( int argc, char **argv )
{
  int length, i = 0;
  int fd;
  int wd;
  char buffer[BUF_LEN];

  fd = inotify_init();

  if ( fd < 0 ) {
    perror( "inotify_init" );
  }

  wd = inotify_add_watch( fd, "/home/name/tmp.cfg",
                         IN_MODIFY | IN_CREATE | IN_DELETE );
  length = read( fd, buffer, BUF_LEN );

  if ( length < 0 ) {
    perror( "read" );
  }

  while ( i < length ) {
    struct inotify_event *event = ( struct inotify_event * ) &buffer[ i ];
      if ( event->mask & IN_CREATE ) {
          printf( "The file %s was created.\n", event->name );
      }
      else if ( event->mask & IN_DELETE ) {
          printf( "The file %s was deleted.\n", event->name );
      }
      else if ( event->mask & IN_MODIFY ) {
          printf( "The file %s was modified.\n", event->name );
      }
    i += EVENT_SIZE + event->len;
  }

  ( void ) inotify_rm_watch( fd, wd );
  ( void ) close( fd );

  return 0;
} 
```

一旦我运行它，如果我在文件上写一些东西然后保存它，什么都不会发生。我试过调试它..问题似乎是 if ( event->mask & IN_MODIFY )，因为它没有将其识别为修改

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T06:08:30.130

你有2个问题。首先，据我所知，inotify 并不能真正处理文件——它需要目录名才能观看。

其次，你错过了`if (event->len) {`while 循环。

此代码适用于我在当前目录中创建、删除和修改文件：

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <sys/types.h>
#include <sys/inotify.h>
#include <unistd.h>

#define EVENT_SIZE  (sizeof(struct inotify_event))
#define BUF_LEN     (1024 * (EVENT_SIZE + 16))

int main(int argc, char **argv) {
    int length, i = 0;
    int fd;
    int wd;
    char buffer[BUF_LEN];

    fd = inotify_init();

    if (fd < 0) {
        perror("inotify_init");
    }

    wd = inotify_add_watch(fd, ".",
        IN_MODIFY | IN_CREATE | IN_DELETE);
    length = read(fd, buffer, BUF_LEN);

    if (length < 0) {
        perror("read");
    }

    while (i < length) {
        struct inotify_event *event =
            (struct inotify_event *) &buffer[i];
        if (event->len) {
            if (event->mask & IN_CREATE) {
                printf("The file %s was created.\n", event->name);
            } else if (event->mask & IN_DELETE) {
                printf("The file %s was deleted.\n", event->name);
            } else if (event->mask & IN_MODIFY) {
                printf("The file %s was modified.\n", event->name);
            }
        }
        i += EVENT_SIZE + event->len;
    }

    (void) inotify_rm_watch(fd, wd);
    (void) close(fd);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-28T06:07:13.053

它不适用于单个文件，因为当我们使用编辑器修改文件时，编辑器会打开文件的副本，当我们从文本编辑器保存编辑后的版本时，现有文件被删除，新文件修改后创建了相同的名称。

删除旧文件后，在该文件上创建的监视程序将失效并自动删除。

如果您监视父目录，您可以看到旧文件被新文件替换。

有两种方法可以解决它，监视父目录并在对您要观看的特定内容进行修改时打印消息。

否则，每当进行修改时，都会在文件上创建一个新的监视。当旧文件被删除时，会触发 IN_DELETE_SELF 事件。

event->name 仅当您监视目录时才会为非空，因为它将包含在监视目录中发生事件的文件的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T20:53:38.807

我认为您没有使用您的*用户名*，这是您的主目录，并且您没有检查`inotify_add_watch`可能失败的返回：

```
"/home/name/tmp.cfg" 
```

编辑：好的第二个问题，你不应该打印`name`，因为

> name 字段仅在为监视目录中的文件返回事件时出现；

Edit2：第三个问题，在运行程序之前文件必须存在，因为你在文件上添加了一个监视，我建议你检查错误从`inotify_add_watch`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-11T03:57:00.567

在观看文件时，如果文件被编辑器操作，您可能会对其进行编辑并创建更改，那么它可能会执行一些操作，导致您要求观看的原始文件被删除。因此，如果您只观看一个文件，通知将停止。

# jquery - Rails DatePicker - 对象[对象对象]没有方法'datepicker'

> ID：13351173
> 
> 赞同：0
> 
> 时间：2012-11-12T20:36:57.710
> 
> 标签：jquery, ruby-on-rails, datepicker

我正在尝试将 datepicker 添加到我的 rails 3.2.8 应用程序中。

由于它是 rails 3+，我没有向 application.html.erb 添加任何内容。

我的 application.js 如下：

```
// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//
// WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD
// GO AFTER THE REQUIRES BELOW.
//
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree .

$(function(){
    $("#transaction_deadline").datepicker();
}); 
```

在views/transactions/_form.html.erb

我有：

```
<div class="field">
    <%= f.label :deadline %><br />
    <%= f.text_field :deadline %>
  </div> 
```

但是，datepicker 仍然不起作用并给出：

> TypeError: Object [object Object] 没有方法'datepicker'

错误

如果你能帮助我，那就太好了。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:27:16.707

也许这个 gem 可以帮助你 => [https://github.com/joliss/jquery-ui-rails](https://github.com/joliss/jquery-ui-rails)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:49:15.853

根据这个[Railscast](http://railscasts.com/episodes/213-calendars-revised?view=asciicast)，您应该在 application.js 和 application.css 中显式添加 datepicker 组件。

在 application.js 中：

```
//= require jquery.ui.datepicker 
```

在 application.css 中：

```
*= require jquery.ui.datepicker 
```

# php - 使用 AJAX 在 Javascript 中调用 PHP 函数

> ID：13351175
> 
> 赞同：3
> 
> 时间：2012-11-12T20:36:59.257
> 
> 标签：php, javascript, ajax

我有一个javascript文件，我想在php服务器端调用一个函数并使用ajax将结果返回给客户端，但我不确定如何向特定的php函数发出请求。

这是我的文件：

javascript 文件基本上从 html 表单中检索用户名，我想将该用户名发送到 php 并检查数据库的可用性。

在`something.js`：

```
function check_availability()
{
    var username = $.trim(document.getElementById('usernameField').value);
    var xmlhttp= new XMLHttpRequest();

    // not sure how to make the request here to check_availability() under php
} 
```

PHP 文件只会检查从 js 文件传递​​到数据库的用户名，如果可用则返回 true，否则返回 false。

在`something.php`：

```
 class Something_Model {
    private $data;
    private $table;

    public function __construct() {
        $this->data = new udata(DBSERVER, DBUSERNAME, DBPASSWORD, DBNAME);
    }

    # check for username availability
    public function check_availability()
    {
        // make the check here, but needs to retrieve username from js file
        echo "here";
    }
} 
```

所以，在 Something_Model 类中，我想从 javascript 进行 check_availability() 调用，有人可以给我一个例子来进行这个 ajax 调用吗？另外，如何将结果返回给 javascript？我需要将其编码为 JSON obj 吗？

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:43:14.740

您不能直接在 PHP 中调用函数 - 但您可以调用 PHP 页面，该页面又可以调用 PHP 函数。例如...

服务.php

```
include_once('something.php');
$model = new Something_Model();
$model->check_availability(); 
```

东西.js

```
function check_availability() {

    var request = new XMLHttpRequest();
    request.open('GET', 'http://yoursite/service.php', false);
    request.send();

    if (request.status === 200) {
      alert(request.responseText);
    }
} 
```

我使用了一个非常简单的 XMLHttpRequest 示例——这个示例在发出请求时实际上是阻塞的。实际上，您可能希望使用回调并允许它异步运行，但我想使答案尽可能简短。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T20:39:29.870

您不能从客户端 JavaScript 调用 PHP 函数。

您可以向 URL 发出 HTTP 请求。

该 URL 可以由 PHP 处理。

要调用一个函数，它可以是一个 PHP 脚本，除了定义函数和调用函数函数之外什么都不做。（或者它可以检查查询字符串并根据其中的一组数据的值调用函数等）。

您可以以任何您喜欢的格式返回数据。如果您想返回结构化数据，JSON 是一种明智的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T00:47:32.987

正如@Rhs 指出的那样，您可以使用 phery 库[http://phery-php-ajax.net](http://phery-php-ajax.net)

您的代码如下所示：

```
Phery::instance()->set(array(
  'check_availability' => array(new Something_Model, 'check_availability');
))->process(); 
```

然后你会从你的代码中调用它

```
// rename put attribute name="username" on your field
var local_phery = $('#usernameField').phery();
local_phery.make('check_availability').bind('phery:json', function(event,data){
  // deal with username suggestions
});
local_phery.remote(); // call the check_availability PHP function 
```

在您的课程中，您必须进行警报/DOM 操作

```
class Something_Model {
private $data;
private $table;

public function __construct() {
    $this->data = new udata(DBSERVER, DBUSERNAME, DBPASSWORD, DBNAME);
}

# check for username availability
public function check_availability($data)
{
    $r = new PheryResponse;

    if ($this->get(array('username'=> $data['username']))){
      $r->alert('Not available!');
      // Or something like using colorbox library, would be like $.colorbox({html: ''});
      $r->jquery()->colorbox(array('html' => 'Not available!'));
      $r->json($suggestions); // $suggestions would be an array with username suggestions
    } else {
      $r->alert('Available!');
    }
    // make the check here, but needs to retrieve username from js file
    return $r;
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T20:42:14.737

您正在尝试做的事情称为“REST Web 服务”。用外行的话来说是一个网页，其结果并不是真正要显示为网页，而是主要通过使用 AJAX/javascript 等技术以编程方式检索、处理和可视化。

除非您的返回类型非常简单（在这种情况下，您可以只返回一个文本字符串）如果您的结果数据类型很复杂，那么使用 javascript 使其可解析的最佳方法是将其编码为 JSON 对象 - 因此可以将其保存为然后允许您检索其组件的变量 - 查看[http://php.net/manual/en/ref.json.php](http://php.net/manual/en/ref.json.php)

# razor - Razor 找不到我的 HTML 助手

> ID：13351176
> 
> 赞同：12
> 
> 时间：2012-11-12T20:37:07.213
> 
> 标签：razor, asp.net-mvc-4

我正在为 Web 使用 VS Express 2012。我的项目是一个 MVC 4 项目。

我正在尝试制作一个助手来创建一个菜单项，该菜单项是一个带有标签的 png 图像。我几乎剪切并粘贴了这段代码：

[动作图像 MVC3 剃刀](https://stackoverflow.com/questions/4896439/action-image-mvc3-razor)

当我尝试使用 helper razor 时找不到它。

我收到此错误：

CS1061：“System.Web.Mvc.HtmlHelper”不包含“AddMenuItem”的定义，并且找不到接受“System.Web.Mvc.HtmlHelper”类型的第一个参数的扩展方法“AddMenuItem”（您是否缺少使用指令还是程序集引用？）

我的代码如下所示： http: [//pastebin.com/cfsN99tF](http://pastebin.com/cfsN99tF)

我正在尝试从 _Layout.cshtml 使用它：http: [//pastebin.com/5vN8yYCa](http://pastebin.com/5vN8yYCa)

我已将命名空间添加到 Web.Config

```
<pages>
  <namespaces>
    <add namespace="System.Web.Helpers" />
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Optimization" />
    <add namespace="System.Web.Routing" />
    <add namespace="System.Web.WebPages" />
    <add namespace="HtmlHelperExtensions" />
  </namespaces>
</pages> 
```

我还需要做什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-12T20:40:20.063

您还需要重新加载您的解决方案

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-12T21:37:57.050

它需要添加到 Views 文件夹中的配置文件中，而不是主配置中。

看到这个答案：

[如何在 Razor 视图页面中导入命名空间？](https://stackoverflow.com/questions/3239006/how-to-import-a-namespace-in-razor-view-page)

# ruby-on-rails - ransack 搜索 text_field 中的每个单词

> ID：13351179
> 
> 赞同：4
> 
> 时间：2012-11-12T20:37:18.317
> 
> 标签：ruby-on-rails, ransack

我将在我的 Rails 应用程序中按名字和姓氏搜索用户。在 firstname 的一个 text_field 和 lastname 的一个 text_field 中，应用程序用户应该可以搜索姓名的多个部分。

例如，用户将输入“Thomas Jeffrey”，这将导致：

```
SELECT FROM users WHERE firstname LIKE "%Thomas%" AND firstname LIKE "%Jeffrey%"; 
```

如果我使用 firstname_cont，结果如下所示：

```
SELECT FROM users WHERE firstname LIKE "%Thomas Jeffrey%"; 
```

当我尝试 firstname_cont_all 时，我得到了一些不同的东西。

谢谢你的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T08:07:52.470

```
User.search(firstname_cont_all: params[:my_field].split) 
```

但是，我不知道在使用 ransack 的`condition_field`表单构建器实用程序时如何正确地将拆分引入数组。

# objective-c - SBTableAlert 崩溃

> ID：13351183
> 
> 赞同：1
> 
> 时间：2012-11-12T20:37:27.577
> 
> 标签：objective-c, ios

这快把我逼疯了！

我已经尝试完全像演示应用程序那样使用表格视图来实现警报视图。但是，在我的崩溃中： *** -[SBTableAlert tableView:cellForRowAtIndexPath:]: message sent to deallocated instance 0x1e0aa800

我知道为什么这样做，我似乎无法追踪或修复它。同样莫名其妙的为什么我的版本在演示应用程序版本时不起作用。除非我遗漏了一些明显的东西。

我的实现：

```
 SBTableAlert *alert = [[SBTableAlert alloc] initWithTitle:NSLocalizedString(@"contact_deleted_title", NULL) cancelButtonTitle:NSLocalizedString(@"contact_deleted_cancel_button_title", NULL) messageFormat:NSLocalizedString(@"contact_deleted_message", NULL)];
    [alert setType:SBTableAlertTypeMultipleSelct];
    [alert.view addButtonWithTitle:NSLocalizedString(@"contact_deleted_other_button_title", NULL)];
    [alert.view setTag:0];
    [alert setDataSource:self];
    [alert setDelegate:self];
    [alert show]; 
```

出于调试的目的，我的委托方法实现是直接从示例应用程序复制和粘贴的，并且 SBTableAlert.h/m 未触及。

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T10:04:36.153

我有这个问题；下面概述的解决方案修复了它：

**第 1 步：**添加`SBTableAlert.h`和`SBTableAlert.m`到您的项目。此类使用 MRC。

**步骤2：**因此，Tell`ARC`排除整个类文件（.m），转到`Target Build Phase`s 并在其中`Compiler Sources`添加`-fno-objc-arc`标志，如下图所示：http: [//www.invasivecode.com/blogimages/Xcode/ARC -Fig1.png](http://www.invasivecode.com/blogimages/Xcode/ARC-Fig1.png)

**第**3 步：**`message sent to deallocated instance 0x1e0aa800`发生错误是因为在警报显示之前`SBTableAlert *alert`已解除分配。`ARC`**

 **以确保它在您需要时仍然存在。使它成为一个强大的属性，即

```
//
//  YourViewController.h
//

#import <UIKit/UIKit.h>
#import "SBTableAlert.h"

@interface YourViewController : UITableViewController <SBTableAlertDelegate,     SBTableAlertDataSource>{

@property (strong, nonatomic) SBTableAlert *strongAlert;

}

@end

//
//  YourViewController.m
//

@implementation YourViewController
@synthesize strongAlert; 
```

然后您的上述代码（尝试显示警报）变为

```
strongAlert = [[SBTableAlert alloc] initWithTitle:NSLocalizedString(@"contact_deleted_title", NULL) cancelButtonTitle:NSLocalizedString(@"contact_deleted_cancel_button_title", NULL) messageFormat:NSLocalizedString(@"contact_deleted_message", NULL)];
[strongAlert setType:SBTableAlertTypeMultipleSelct];
[strongAlert.view addButtonWithTitle:NSLocalizedString(@"contact_deleted_other_button_title", NULL)];
[strongAlert.view setTag:0];
[strongAlert setDataSource:self];
[strongAlert setDelegate:self];
[strongAlert show]; 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T04:11:59.157

你错过了[alert autorelease]；

如果您不使用 ARC，则上面的代码将不起作用。但是，您不应该使用 ARC，因此由于缺少参考，必须使用 release/autorelease/dealloc。**

# php - 在 CakePHP 中路由静态文件夹名称

> ID：13351185
> 
> 赞同：2
> 
> 时间：2012-11-12T20:37:36.250
> 
> 标签：php, cakephp, redirect, routing, cakephp-2.0

我从浏览器尝试了这个：

```
http://example.com/contact 
```

但后来我得到“**无法找到控制器类 ContactController** ”错误

它不存在，因为“contact”是一个不属于 CakePHP 应用程序的文件夹名称。它里面有 2 个 php 文件，但它们独立工作。它们不是 CakePHP 应用程序文件。

我试过这个：

```
Router::redirect('/contact/*', 'http://example.com/contact/',
    array('status' => 302)); 
```

但我从浏览器收到此错误“**此网页有重定向循环**”

如何进行重定向，以免出现此错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:00:12.250

可以添加 mod_rewrite 规则。

假设您的应用程序路径是：

```
/var/www/
/var/www/app
/var/www/app/webroot 
```

将您的文件夹“联系人”添加到

```
/var/www/contact 
```

在以下位置找到 CakePHP .htaccess

```
/var/www/.htaccess 
```

这是原始内容：

```
<IfModule mod_rewrite.c>
   RewriteEngine on
   RewriteRule    ^$ app/webroot/    [L]
   RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

在“RewriteEngine on”行之后添加以下规则

```
RewriteRule  ^contact -               [L] 
```

它看起来像这样

```
<IfModule mod_rewrite.c>
   RewriteEngine on
   RewriteRule  ^contact -           [L]
   RewriteRule    ^$ app/webroot/    [L]
   RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

# php - 使用 .htaccess 绕过 Zend Framework 并在子目录中运行不同的框架

> ID：13351187
> 
> 赞同：5
> 
> 时间：2012-11-12T20:37:45.823
> 
> 标签：php, .htaccess, zend-framework, mod-rewrite

我正在尝试在 Zend 站点的子目录中运行非 Zend php 应用程序。我想为 .htaccess 中的子目录 '/branches' 中的所有文件绕过 Zend 应用程序。到目前为止，我发现的解决方案都没有奏效。这是当前的 .htaccess 文件：

```
RewriteEngine on
RewriteBase /

# WWW Resolve
RewriteCond %{HTTP_HOST} ^domain\.com$ [NC]
RewriteRule ^web/content/(.*)$ http://www.domain.com/$1 [R=301,L]

# Eliminate Trailing Slash
RewriteRule web/content/(.+)/$ http://www.domain.com/$1 [R=301,L]

# Route Requests
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

这甚至可以在 .htaccess 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:59:57.823

您目前拥有：

```
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

这是没有意义的，因为您指定的基本上不对实际文件、目录和符号链接执行任何操作的 RewriteCond 将永远无法工作。这是因为，RewriteRule 后面紧跟规则将所有内容重写到 index.php。

如果您的意图是将所有不是对 index.php 文件真实目录的请求的请求，您应该有这样的内容：

```
RewriteCond %{REQUEST_FILENAME} -s
RewriteCond %{REQUEST_FILENAME} -l
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ index.php [NC,L] 
```

要添加忽略的特殊情况，`/branches`只需添加一个条件，如下所示：

```
RewriteCond %{REQUEST_FILENAME} -s
RewriteCond %{REQUEST_FILENAME} -l
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_FILENAME} !^branches/
RewriteRule ^.*$ index.php [NC,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T23:54:53.443

我能够在不更改 .htaccess 的情况下解决这个问题，而只需将我的子目录放在“/content”中。

# android - 如何解码俄语

> ID：13351189
> 
> 赞同：1
> 
> 时间：2012-11-12T20:37:49.000
> 
> 标签：android, unicode, utf-8

我试图加载几个具有不同语言内容的网站。我只将俄罗斯内容视为`<?>`元素。请帮助我将其解码为正确的符号。我的代码示例：

```
RequestTask t = new RequestTask();
response = t.doIt("http://google.ru"); //troubles 
//response = t.doIt("http://stackoverflow.com"); //ok
//response = t.doIt("http://web.de/"); //ok
//response = t.doIt("http://www.china.com/"); // omg, it's ok too!

StatusLine statusLine = response.getStatusLine();

if(statusLine.getStatusCode() == HttpStatus.SC_OK){
    ByteArrayOutputStream out = new ByteArrayOutputStream();                    
    response.getEntity().writeTo(out);
    out.close();
    String response_string = new String(out.toByteArray(), "UTF-8"); 
```

请求代码：

```
public class RequestTask {
    public HttpResponse doIt(String... uri) 
    throws ConnectTimeoutException, UnknownHostException, IOException{
        HttpParams params = new BasicHttpParams();
        HttpConnectionParams.setConnectionTimeout(params, 6000);
        HttpConnectionParams.setSoTimeout(params, 6000);
        HttpClient httpclient = new DefaultHttpClient(params);
        HttpResponse response = null;
        Log.d(this.toString(), "HTTP GET to " + uri[0]);
        response = httpclient.execute(new HttpGet(uri[0]));
        Log.d(this.toString(), "response: " + response.getStatusLine().getReasonPhrase());

        return response;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:18:59.027

我没有看到任何问题`google.ru`：

```
$ wget google.ru
[...skipped....]
$ enca -L ru index.html 
MS-Windows code page 1251
  LF line terminators 
```

您应该永远记住，至少有 3 种其他或多或少使用的编码，可以在包含俄语内容的页面上找到。除了“UTF-8”，我肯定会检查“KOI-8R”、“WIN-1251”和（不是很流行）“Mac Cyrillic”。

你可能会更好地使用这样的东西：

```
encoding = ( "win-1251", "koi8-r" )  # maybe some others...

for enc in encoding:
    try:
        result = unicode( data, enc )
        break
    except:
        result = ""
        continue

if result:
    print name + "\t: " + enc
else:
    print name + "\t: unable to determine the encoding" 
```

# c# - 在 MVVM 模式中使用 ASP.NET MVC 中的 C# 扩展方法

> ID：13351191
> 
> 赞同：1
> 
> 时间：2012-11-12T20:37:50.737
> 
> 标签：c#, asp.net-mvc, entity-framework, mvvm, extension-methods

在当前的项目中，我们正在尝试使用不同的方法来填充`ViewModel`来自 Entity Framework 的对象。目前，在收到`EntityModel`我们使用扩展方法的列表后：

```
public static IEnumerable<ViewModel> GetViewModel(this IEnumberable<EntityModel> data){} 
```

此扩展方法定义在与对象相同的命名空间中，`ViewModel`以使其与`ViewModel`ASP.NET MVC 中的特定控制器密切相关。

具体来说，我们正在寻找来自开发社区的反馈：

*   这是使用扩展方法的合适地方吗？我们很担心，因为这似乎是从 OOP 中解脱出来的，更像是一种“创可贴”的解决方案。
*   `ViewModel`什么是从对象填充对象的“经过试验和测试”的方法`EntityModel`。我们尝试了以下方法：
    *   手动分配控制器中的每个字段（视图和控制器之间的耦合过多）
    *   将 Entity/ViewModel 对象传递给 View Model 构造函数（迄今为止最好，但 ViewModel 与实体耦合）

提前感谢您的任何建议/帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:43:50.363

建议将 EntityModel 和 ViewModel 之间的*映射*从两者中解耦。如果映射管道与视图耦合，则将来很难为不同的目的而放入新视图。如果绑定到 EntityModel，则很难使用相同的视图放入新的实体模型。无论哪种方式，如果映射基础架构与其中任何一个相关联，则独立发展视图模型和实体模型会更加困难。

我建议映射应该是一个独立的架构构建块，并进一步建议您将 AutoMapper 视为该组件的实现。

[http://automapper.codeplex.com/](http://automapper.codeplex.com/)

# windows - Win32_PhysicalMemory.Capactiy -- 它在 32 位应用程序中的表现如何？

> ID：13351198
> 
> 赞同：3
> 
> 时间：2012-11-12T20:38:24.033
> 
> 标签：windows, winapi, memory, operating-system, wmi

我在 WMI 中理解 Win32_PhysicalMemory.Capacity 的方式是，如果你将它拥有的所有不同行加起来，它的总和就是 Windows 实际可用的 RAM 量。

但是，对于内存超过 2G（通过物理地址扩展）的 32 位机器呢？如果有 6G 的实际可用内存，它会返回，还是返回 2G 或 4G？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:40:19.863

WMI 类的大部分属性值[`Win32_PhysicalMemory`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394347%28v=vs.85%29.aspx)都继承自[`CIM_PhysicalMemory`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387968%28v=vs.85%29.aspx)，在这种情况下，`Capacity`属性值来自[SMBIOS 2.7.1](http://dmtf.org/sites/default/files/standards/documents/DSP0134_2.7.1.pdf)内存设备表（类型 17）。因此，回答您的问题，此属性返回的值是**内存设备的大小**。

# javascript - 每个循环中的 JavaScript“意外标识符” - 为什么会出现此错误？里面的简单演示代码

> ID：13351213
> 
> 赞同：0
> 
> 时间：2012-11-12T20:39:16.207
> 
> 标签：javascript, jquery

```
function printClassForAllDivs()
{
    var divs = $('div');
    divs.each(function{
        var klass = $(this).attr('class');
        console.log('div class = '+klass);
    });
} 
```

在我看来，这段代码应该遍历所有的 div，并且对于循环的每次迭代都应该创建一个变量来存储类，然后将其打印到控制台。

恐怕我不明白如何使用匿名函数。

```
function printClassForAllDivs()
{
    var divs = $('div');
    divs.each(function{
        // what don't I understand about what I am permitted to do in here?
    });
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:39:47.603

```
divs.each(function{ 
```

应该是

```
divs.each(function(){ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T20:40:01.137

您缺少内部函数的括号`divs.each`.. 见下文，

```
divs.each(function (){ 
```

更改您的代码，如下所示，

```
function printClassForAllDivs()
{
    var divs = $('div');
    divs.each(function (){
        var klass = $(this).attr('class');
        console.log('div class = '+klass);
    });
} 
```

# ios - iOS 游戏开发

> ID：13351222
> 
> 赞同：0
> 
> 时间：2012-11-12T20:39:54.387
> 
> 标签：ios

> **可能重复：**
> [有网络开发经验。如何开始 iPhone 游戏开发？](https://stackoverflow.com/questions/8728809/experienced-in-web-development-how-to-get-started-with-iphone-game-development)

**- 问题**

我是一名从事商业应用程序的 iOS 开发人员。我想开始为 iOS 开发游戏。我的问题是从哪里开始，游戏开发需要哪些工具，哪些资源最重要。到目前为止，我认为 openGL 和核心动画是必需的工具。

请指导

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:44:46.977

你应该看看 Cocos2d 框架。这是一个很棒的教程：

[http://www.raywenderlich.com/352/how-to-make-a-simple-iphone-game-with-cocos2d-tutorial](http://www.raywenderlich.com/352/how-to-make-a-simple-iphone-game-with-cocos2d-tutorial)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:45:14.977

我会推荐一个游戏开发框架。这篇文章有点过时了，但确实参考了仍然存在并且很好的工具包：

[http://maniacdev.com/2009/08/the-open-source-iphone-game-engine-comparison/](http://maniacdev.com/2009/08/the-open-source-iphone-game-engine-comparison/)

如果您还没有准备好学习大量数学/编程，那么请尝试使用像 Unreal 这样的商业引擎，其中大部分繁重的工作都已为您完成。他们的教程是一个很好的起点。

您还应该开始使用[Blender](http://blender.org)和/或 Google Sketch-up。它们会让您更好地了解使用预建引擎需要了解的内容......而且两者都是免费的。

虚幻游戏[引擎](http://www.unrealengine.com/udk/)也有免费版。

# parsing - 预处理 Scala 解析器阅读器输入

> ID：13351225
> 
> 赞同：1
> 
> 时间：2012-11-12T20:40:10.910
> 
> 标签：parsing, scala, combinators

我有一个包含对象的文本表示的文件。我编写了一个组合器解析器语法来解析文本并返回对象。在文本中，“#”是注释分隔符：从该字符到行尾的所有内容都将被忽略。空行也被忽略。我想一次处理一行文本，这样我就可以处理非常大的文件。

我不想用通用注释和空行逻辑弄乱我的解析器语法。我想删除这些作为预处理步骤。通过行将文件转换为迭代器，我可以执行以下操作：

```
Source.fromFile("file.txt").getLines.map(_.replaceAll("#.*", "").trim).filter(!_.isEmpty) 
```

如何将这样的表达式的输出传递给组合器解析器？我不知道如何`Reader`从这样的过滤表达式中创建一个对象。Java`FileReader`接口不是这样工作的。

有没有办法做到这一点，或者我应该把我的评论和空行逻辑放在解析器语法中？如果是后者，是否有一些`util.parsing`包已经为我做了这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:33:12.383

最简单的方法是使用`fromLines`on 方法`PagedSeq`：

```
import scala.collection.immutable.PagedSeq
import scala.io.Source
import scala.util.parsing.input.PagedSeqReader

val lines = Source.fromFile("file.txt").getLines.map(
  _.replaceAll("#.*", "").trim
).filterNot(_.isEmpty)

val reader = new PagedSeqReader(PagedSeq.fromLines(lines)) 
```

现在你有了一个`scala.util.parsing.input.Reader`可以插入解析器的东西。无论如何，这本质上就是解析 a 时发生的事情`java.io.Reader`——它立即被包裹在 a 中`PagedSeqReader`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:01:22.497

这不是你写过的最漂亮的代码，但你可以通过`Source`如下新代码：

```
val SEP = System.getProperty("line.separator")
def lineMap(fileName : String, trans : String=>String) : Source = {
  Source.fromIterable(
    Source.fromFile(fileName).getLines.flatMap(
      line => trans(line) + SEP
    ).toIterable
  )
} 
```

解释：`flatMap`将产生一个关于*characters*的迭代器，你可以把它变成一个`Iterable`，你可以用它来构建一个新的`Source`. 您需要额外的`SEP`，因为`getLines`默认情况下会删除它（使用`\n`可能无法正常工作，因为`Source`无法正确分隔行）。

如果您也想应用过滤，即删除一些行，您可以尝试：

```
// whenever `trans` returns `None`, the line is dropped.
def lineMapFilter(fileName : String, trans : String=>Option[String]) : Source = {
  Source.fromIterable(
    Source.fromFile(fileName).getLines.flatMap(
      line => trans(line).map(_ + SEP).getOrElse("")
    ).toIterable
  )
} 
```

举个例子：

```
lineMapFilter("in.txt", line => if(line.isEmpty) None else Some(line.reverse)) 
```

...将删除空行并反转非空行。

# javascript - FB auth 的正确方法

> ID：13351235
> 
> 赞同：14
> 
> 时间：2012-11-12T20:40:54.630
> 
> 标签：javascript, facebook, node.js

我的项目使用 Node.js 和 Express，但问题是关于通用方法。

我们的用户都来自FB，除了FB，我们没有任何身份验证。我们需要将一些动作与特定的 FB 用户相关联，还需要他们的令牌与 FB 进行通信。

**目前**我们这样做：

*   用户来到页面
*   有一些*不可见*的块：一个带有用户头像和名称的占位符（'logged-in'），另一个带有触发FB登录的按钮（'logged-out'）
*   使用 FB JS SDK 我们检查用户的登录状态。如果**连接**（实际上意味着：登录 FB，验证我们的应用程序并提供我们需要的所有权限），我们将获取用户名和 FB ID 并显示“登录”块。否则会显示“注销”块
*   对于登录用户的某些操作，用户的 access_token 通过 AJAX 传递给服务器（不用担心，这里是 HTTPS），并由服务器代码用于发布到用户的墙或其他任何操作
*   FB 登录按钮由 JS 处理并调用 FB.login()
*   在 JS authResponseChanged 事件上采取明显的行动（显示/隐藏登录/退出块）

**好处**：我们一直都知道用户的状态是有效的（token 的 TTL 超过了正常页面的生命周期，所以我们这里很好）。

**我们不太喜欢的是**： * 客户端令牌是短暂的（是的，我们可以交换它们，但如果我们能找到任何替代品，我们就不想这样做） * 通常需要对 FB 的多个请求（1 - 加载JS SDK，2 - 获取登录状态），直到我们可以显示一些东西。直到我们网站的“登录”块为空。

**问题是什么？**

我们正在寻找一种最佳方式来在这里使用一些服务器端代码，并至少在我们确定用户已登录时呈现用户名和头像。

我可以想象一些这样的方案：

*   使用服务器端身份验证（带有重定向）来获取长期令牌并将其保存在服务器上
*   在会话中保存用户的状态（登录/退出、FB ID、名称）
*   如果会话在服务器上处理模板时具有登录状态，则呈现名称和头像

**关注点**：

*   如果用户从 FB 登录或撤销了 App 权限，我们应该如何知道它以及我们应该何时检查它（每 N 个请求检查一次？每 X 小时检查一次？只检查令牌将在 Y 小时内到期的时间？）
*   如果我们在渲染任何模板之前从服务器检查用户的状态（这是[官方示例](https://developers.facebook.com/docs/guides/web/#insights)中的情况），这会减慢速度，对吗？因为我认为 FB API 调用在炎热的时候会相当慢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T10:28:08.540

使用 JS SDK 是“实时”了解用户状态的唯一可行方法。（引号中的“实时”，因为 FB.getLoginStatus 的结果也会被缓存——如果希望它始终准确，则必须使用第二个参数设置为 true。）

如果您设置了 JS SDK 以在您的域下设置 cookie，那么 PHP SDK 能够确定用户的登录状态，而无需通过 HTTP 进行任何 API 查找——它只是从 cookie 中读取用户 ID，因此 Facebook::getUser () 将为您获取用户 ID。这足以显示图片 - 但对于用户名，仍然需要 API 请求。

在这里，您可以选择请求名称*一次*- 然后将其保存到您的会话中。如果在下一个请求中，JS SDK 指示用户不再连接，您可以从页面中删除登录信息和/或强制重新加载（然后清除会话），以返回未连接登录状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T09:34:19.670

其实说“为了实时，你需要使用JS SDK”是完全不正确的！Facebook 有“Realtime Updates Graph API”，每次更新一些数据时，你的本地数据库会自动更新，那么你就不需要使用 JS SDK

# encryption - 使用相同的密钥通过 AES 256 对称加密来加密多个字段是否安全？

> ID：13351241
> 
> 赞同：1
> 
> 时间：2012-11-12T20:41:36.030
> 
> 标签：encryption, aes, encryption-symmetric

我有一个 AES256 密钥，用于在我的应用程序中加密 SSN。现在我需要加密安全答案。

是否建议使用不同的密钥来加密每个字段，或者我可以使用相同的密钥来加密多个字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:55:52.253

只要您遵循最佳实践，就可以使用相同的密钥来加密多个字段。对于最佳实践，我的意思是如果您使用 AES CBC 加密，则需要使用随机 IV。

请注意，AES 的密钥大小并不那么重要。拥有良好的密钥基础设施、良好的服务器安全性和加密安全协议更为重要。如果 AES-256 部署不当，AES-128 甚至三重 DES 几乎比 AES-256 安全得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:49:05.567

我们有一个用于大多数加密字段的密钥，另一个用于一些额外的敏感字段。它背后的想法是，如果有人获得了公共密钥，他们仍然无法访问最敏感的信息。

我不知道这如何适合“最佳实践”，但到目前为止它对我们来说效果很好。

无论您做什么，决心破解它的人都会找到方法。您只需要找到您存储的信息类型所需的余额和级别。当涉及到 SSN 和其他类似的个人信息时，很难“过于安全”。

# windows-8 - 在 Windows8 应用程序的后台播放音频文件？

> ID：13351242
> 
> 赞同：0
> 
> 时间：2012-11-12T20:42:04.087
> 
> 标签：windows-8, windows-runtime, winrt-xaml

我正在开发一个显示信息的应用程序，同时在后台播放音频文件。这是一个 Windows 8 平板电脑应用程序。任何帮助或建议都是有帮助的。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:15:32.387

在 XAML 中，您将拥有一个具有以下属性的 MediaElement

```
 <ContentControl x:Name="Host">
            <MediaElement Source="Assets/myMusic.mp3" IsLooping="True" AutoPlay="True" AudioCategory="BackgroundCapableMedia" PosterSource="/Images/placeholder-sdk.png" VerticalAlignment="Center" HorizontalAlignment="Center" Name="myMediaElement" Height="350" Width="640" />
  </ContentControl> 
```

在应用栏中，您可以有一些用于媒体控制的按钮，例如

```
<Page.BottomAppBar>
    <AppBar Opened="BottomAppBar_Opened" Background="#FF3C3838" x:Name="BottomAppBarColors" Padding="10,0,10,0" AutomationProperties.Name="Bottom App Bar Colors">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50*"/>
                <ColumnDefinition Width="50*"/>
            </Grid.ColumnDefinitions>
            <StackPanel x:Name="LFullScreenLandscapeViewGrid" Orientation="Horizontal" Grid.Column="0" HorizontalAlignment="Left">
                <Button x:Name="Play" Click="PlayButton_Click" Style="{StaticResource PlayAppBarButtonStyle}" Tag="Play"/>
                <Button x:Name="Stop" Click="StopButton_Click" Style="{StaticResource StopAppBarButtonStyle}" Tag="Stop"/>
            </StackPanel>
            <StackPanel Visibility="Collapsed" x:Name="PortraitViewGrid" Orientation="Horizontal" Grid.ColumnSpan="2" HorizontalAlignment="Right">
                <Button x:Name="PauseCollapsed" Click="PauseButton_Click" Style="{StaticResource PauseAppBarButtonStyle}" Tag="Pause"/>
                <Button x:Name="PlayCollapsed" Click="PlayButton_Click" Style="{StaticResource PlayAppBarButtonStyle}" Tag="Play"/>
                <Button x:Name="StopCollapsed" Click="StopButton_Click" Style="{StaticResource StopAppBarButtonStyle}" Tag="Stop"/>
            </StackPanel>
        </Grid>
    </AppBar>
</Page.BottomAppBar> 
```

在 .CS 代码文件中，您可以控制 mediaelement 对象。

```
 private void PauseButton_Click(object sender, RoutedEventArgs e)
    {
        myMediaElement.Pause();
    }

    private void StopButton_Click(object sender, RoutedEventArgs e)
    {
        myMediaElement.Stop();
    }

    private void ForwardButton_Click(object sender, RoutedEventArgs e)
    {
        myMediaElement.DefaultPlaybackRate = 0.0;
        myMediaElement.PlaybackRate = 2.0;
    }

    private void RewindButton_Click(object sender, RoutedEventArgs e)
    {
        myMediaElement.DefaultPlaybackRate = 0.0;
        myMediaElement.PlaybackRate = -1.0;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T14:05:09.060

如果您有多个屏幕使用媒体和控件来播放、暂停和停止媒体文件，那么最好为这些事件编写一次代码，然后从不同的屏幕使用它。我看到人们在他们使用媒体的每个屏幕上都编写以下代码。

```
private void PauseButton_Click(object sender, RoutedEventArgs e)
{
    myMediaElement.Pause();
}

private void StopButton_Click(object sender, RoutedEventArgs e)
{
    myMediaElement.Stop();
}

private void ForwardButton_Click(object sender, RoutedEventArgs e)
{
    myMediaElement.DefaultPlaybackRate = 0.0;
    myMediaElement.PlaybackRate = 2.0;
}

private void RewindButton_Click(object sender, RoutedEventArgs e)
{
    myMediaElement.DefaultPlaybackRate = 0.0;
    myMediaElement.PlaybackRate = -1.0;
} 
```

因此，与其在每个屏幕中重复代码，不如遵循良好的事件模式来减少重复代码

最好的办法是使用 MVVM 模式，您可以在[http://code.msdn.microsoft.com/windowsapps/Background-Audio-c-Metro-d2fc7719/view/SourceCode找到一个示例](http://code.msdn.microsoft.com/windowsapps/Background-Audio-c-Metro-d2fc7719/view/SourceCode)

所以设计是在一个共同的地方编写代码并从前端 UI 中触发它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T20:47:49.697

您需要使用 MediaElement。

# java - 跨 Hibernate 会话和普通 jdbc 的单个事务

> ID：13351243
> 
> 赞同：2
> 
> 时间：2012-11-12T20:42:08.730
> 
> 标签：java, spring, hibernate, jdbc, transactions

是否可以为 Hibernate Session 和普通的 JDBC 查询使用单个事务边界。? 两者的数据库和数据源配置相似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:49:28.000

是的。使用`HibernateTransactionManager`. 以下摘自其[javadoc](http://static.springsource.org/spring/docs/1.2.x/api/org/springframework/orm/hibernate3/HibernateTransactionManager.html)

> 此实现适用于仅使用 Hibernate 进行事务数据访问的应用程序，但它也支持事务中的直接数据源访问（即使用相同数据源的纯 JDBC 代码）。这允许混合访问 Hibernate 的服务（包括事务缓存）和使用普通 JDBC 的服务（不知道 Hibernate）！应用程序代码需要遵循与 DataSourceTransactionManager 相同的简单连接查找模式（即 DataSourceUtils.getConnection 或通过 TransactionAwareDataSourceProxy）。
> 
> 请注意，为了能够为纯 JDBC 代码注册 DataSource 的 Connection，此实例需要知道 DataSource（请参阅 setDataSource）。给定的 DataSource 显然应该与给定的 SessionFactory 使用的相匹配。要实现这一点，请将两者配置为相同的 JNDI 数据源，或者最好使用 LocalSessionFactoryBean 和本地数据源（将由该事务管理器自动检测）创建 SessionFactory。

# php - 选择的选择返回 Null

ID：13351244

赞同：0

时间：2012-11-12T20:42:08.843

标签：php, jquery, html, forms, null

# excel - 复制一系列单元格，只选择包含数据的单元格，只选择值而不是公式

> ID：13351245
> 
> 赞同：2
> 
> 时间：2012-11-12T20:42:08.823
> 
> 标签：excel, vba

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:59:22.230

简单 - 只需稍微编辑 Else 语句...

```
' Loop through columns and rows
For iCol = 1 To 3 ' or however many columns you have
    For iRow = 1 To iMaxRow 

    With Worksheets("Sheet1").Cells(iRow,iCol)
        ' Check that cell is not empty.
        If .Value = "" Then
            'Nothing in this cell.
            'Do nothing.
        Else
            ' Copy the cell to the destination
            Worksheets("Sheet2").cells(iRow,iCol).value = .value
        End If
    End With

    Next iRow
Next iCol 
```

希望这就是你的意思......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:51:27.513

*要将所有单元格从Sheet1*列的已用部分复制`A:C`到*Sheet2*作为您可以使用的值

无论如何复制时，空白单元格将是空白的。

```
Sub Better()
Dim ws As Worksheet
Set ws = Sheets("Sheet1")
Set rng1 = ws.Range(ws.[a1], ws.Cells(Rows.Count, "A").End(xlUp))
Sheets("Sheet2").Range(rng1.Address).Value = rng1.Value
End Sub 
```

# java - 如何仅更改一个组件的工具提示颜色？

> ID：13351250
> 
> 赞同：5
> 
> 时间：2012-11-12T20:42:23.707
> 
> 标签：java, swing, tooltip

如何仅更改一个组件的工具提示颜色？

我知道您可以执行以下操作来更改工具提示颜色：

```
UIManager.put("ToolTip.background", new ColorUIResource(255, 247, 200)); 
```

但这会改变所有组件的工具提示背景，而不仅仅是一个。

有什么简单的解决办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T21:03:43.273

向@MadProgrammer 和@Reimeus +1 提供建议和示例。

这些都是正确的。

添加...

没有默认方法可以做到这一点。您必须扩展`ToolTip`该类，使用前景色和背景色创建自己的自定义`ToolTip`，然后扩展`JComponent`s 类（`JButton`,`JLabel`等都是`JComponent`s ）并覆盖其`createToolTip()`方法并将您的自定义设置`ToolTip`为`JComponent`s `ToolTip`，如下所示：

这是我做的一个例子：

![在此处输入图像描述](../Images/ba40d0de0a5a4711b7b7cd8be95cba4f.png)

```
import java.awt.Color;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JToolTip;
import javax.swing.SwingUtilities;

/**
 *
 * @author David
 */
public class CustomJToolTipTest {

    private JFrame frame;

    public CustomJToolTipTest() {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new CustomJToolTipTest();
            }
        });
    }

    private void initComponents() {
        frame = new JFrame("Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);

        JButton button = new JButton("button") {
            //override the JButtons createToolTip method
            @Override
            public JToolTip createToolTip() {
                return (new CustomJToolTip(this));
            }
        };
        button.setToolTipText("I am a button with custom tooltip");

        frame.add(button);

        frame.pack();
        frame.setVisible(true);
    }
}

class CustomJToolTip extends JToolTip {

    public CustomJToolTip(JComponent component) {
        super();
        setComponent(component);
        setBackground(Color.black);
        setForeground(Color.red);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T20:58:11.683

您需要为[`JTooltip`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JToolTip.html)组件提供自定义。

看看[JComponent#createToolTip](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#createToolTip%28%29)

来自 Java 文档

> 返回用于显示工具提示的 JToolTip 实例。组件通常不会覆盖此方法，但它可用于使不同的工具提示以不同的方式显示。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-12T21:01:53.587

没有标准的方法可以做到这一点，但您可以覆盖`JComponent.createToolTip()`. 这是一个按钮示例：

```
MyButton testButton = new MyButton("Move Mouse Over Button");
testButton.setToolTipText("Some text");

class MyButton extends JButton {

   public MyButton(String text) {
      super(text);
   }

   @Override
   public JToolTip createToolTip() {
      return (new MyCustomToolTip(this));
   }
}

class MyCustomToolTip extends JToolTip {
   public MyCustomToolTip(JComponent component) {
      super();
      setComponent(component);
      setBackground(Color.black);
      setForeground(Color.red);
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-05T07:30:30.870

如果您可以访问源代码，我不会推荐这个。但如果没有，您可以利用 HTML 格式化功能更改颜色。

```
JButton b = new JButton();
b.setToolTipText("<html><div style='margin:0 -3 0 -3; padding: 0 3 0 3; background:green;'>My Text</div></html>"); 
```

您需要负边距，因为存在标准边距，否则不会着色。我们通过添加填充来弥补边距。3 px 似乎适用于金属 LAF。

# wordpress - 联系表格 7 (wordpress) 样式的 hml 邮件模板

> ID：13351259
> 
> 赞同：2
> 
> 时间：2012-11-12T20:43:17.103
> 
> 标签：wordpress, contact-form-7

我正在使用联系表 7（wordpress、联系表）作为产品的订单页面。但我有兴趣将 HTML-Mail-template 的样式设置为与图片相同的 3 列样式。有什么简单的方法可以做到这一点吗？![在此处输入图像描述](../Images/767791fd377f32e61e32dfefb49c91a9.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-06-20T17:25:34.263

我认为前两个答案误解了这个问题。Johny 询问他如何编辑通过联系表格 7 发送给他自己或填写表格的人的 html 电子邮件。

为此，您需要选择“使用 HTML 内容类型”选项，以便在电子邮件中使用 html。这是 CF7 的“邮件”部分。

那么设置 html 电子邮件模板样式的最简单方法是使用表格。

1.  首先从一个带有 XHTML 文档类型的空白 html 模板开始：

    StackOverflow 电子邮件模板

2.  然后你可以添加任何你需要的 html 和信息，让它看起来像你想要的那样：

例如，从没有边距或填充开始可能更容易，因此您可以在 body 标签中添加一些样式：

```
<body style="margin: 0; padding: 0;"> 
```

3.  然后，您需要将所有样式内联添加到表格中，因为您的电子邮件没有发送样式表。您还可以像使用普通 html 一样在该部分中创建一个内联样式部分。

所以我会为你的例子做这个：

```
<table align="center" border="0" cellpadding="2" cellspacing="0" width="100%" bgcolor="#ffffff" style="border-collapse: collapse; font-family: Arial,sans-serif; font-size:1em;" > 
```

4.  完成所有设置后，您需要将单元格添加到表格中。

例如，您的第一行和第二行可能是这样的：

```
<tbody>
    <tr>    
    <td colspan="6">To: [your-name]</td>
    </tr>
    <tr>
        <td>Falt Utan Flask:</td>
        <td>[Input-One] Back</td>
        <td>Falt Utan Flask:</td>
        <td>[Input-Two] Back</td>
        <td>Set Datum:</td>
        <td>[Date-324]</td>
    </tr>
</tbody> 
```

每个将是一个新行，每个部分将是一个新单元格。然后继续填充和构建您的表格以显示您想要的方式。

您可以根据需要将内联样式添加到 or 元素中，也可以如前所述在区域中添加内联样式。

这是我需要为使用联系表格 7 插件的网站做的事情。我发现这些教程非常有帮助。

1.  [啧啧 1](https://webdesign.tutsplus.com/articles/build-an-html-email-template-from-scratch--webdesign-12770)

2.  [啧啧2](https://www.ethicalseoconsulting.com/how-to-make-contact-form-7-contact-emails-awesome/)

希望我自己没有误解这个问题，它有点模棱两可，但它是我找到的最接近我正在寻找的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-25T17:04:58.050

有两种方法

(1) 覆盖 Contact Form-7 本身的 CSS。这可以通过 .wpcf7-[inner class] 然后你的 CSS 代码来完成。

[简单的方法]

(2) 您可以使用此插件[https://wordpress.org/plugins/contact-form-7-style/](https://wordpress.org/plugins/contact-form-7-style/)来设置联系表格 7 的样式。它有多种选择。虽然它并不完美，但肯定是一个解决方案。希望这可以帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-24T10:03:39.147

是的，您可以这样做，您需要在现有的主题文件中添加一些 css，因为不建议修改插件文件，因为我可以看到您已经使用了文本框，您可以这样做

样式

> .wpcf7-text { 宽度:150px !important; }

.wpcf7-text 是表单设置中联系表单7中的文本框类

> 你的名字- [text- text-20]
> 
> 你的地址- [text- text-30]

# javascript - 识别项目何时在网站上可见和不可见

> ID：13351264
> 
> 赞同：0
> 
> 时间：2012-11-12T20:43:28.717
> 
> 标签：javascript, ios, scroll, offset

我正在构建一些代码以尝试在图像在视图中时发生某些事情，然后在图像不在视图中时重置计数器，如果图像返回查看，则再次发生相同的事情。

我有代码可以识别图像何时进入视野并执行某些操作，但是当我添加代码以在图像不在视野时重置计数器时，整个事情就停止了工作。

html:

```
<div style="height: 2000px">
<img  height="320px" width= "240px" id="pbr" src="http://i47.tinypic.com/33bztj8.jpg" alt="image 1">
<img height="320px" width= "240px" id="pbrglow" src="http://i48.tinypic.com/2ykduvl.jpg" alt="image 2">
<button id="button">click to reset</button>
</div> 
```

CSS：

```
#pbr {
    position: absolute;   
    top: 500px;
    z-index: 0;
}
#pbrglow {
    position: absolute;             
    display: none;
    top: 500px;
    z-index: 1;

}
#button {
    position: absolute;
    top: 850px;
    z-index: 3;
} 
```

javascript:

```
var y = $("#pbr").offset().top;
var eventsFired = 0;

$(window).scroll(function() {
    var y = $("#pbr").offset().top;
    var scrollY = $(window).scrollTop();
    if (scrollY + 100 > y && eventsFired == 0) {
        eventsFired++;
        alert(eventsFired);
    }
});

$("#button").on("click", function() {
    var scrollYY = $(window).offsetTop();
    if (eventsFired == 1) {
        alert("happened");
        eventsFired = 0;
    }
} 
```

这是带有代码的[jsfiddle](http://jsfiddle.net/esegev1/ZwJpw/9/)

一旦我删除了以 $("#button")... 开头的代码，代码就可以工作了，但是代码中的这个却没有。

PS这是一个我需要在iOS上工作的网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:04:17.893

那是因为您的`#button`点击处理程序正在引发错误：

`Uncaught TypeError: Object [object Object] has no method 'offsetTop'`

如果您打开了控制台，您可以在 jsFiddle 页面上看到它（您可以通过 Settings->Safari->Developer 为移动 Safari 启用控制台）。

那个问题是`$(window)`没有`offsetTop()`方法。如果您摆脱了那条线（并且无论如何您都不需要它，因为您从未使用过`scrollYY`），那么一切正常。

# rspec - rspec 在自定义匹配器中模拟 should_receive

> ID：13351266
> 
> 赞同：6
> 
> 时间：2012-11-12T20:43:34.817
> 
> 标签：rspec, mocking, match

我正在尝试使用 RSpec 模拟和`should_receive`自定义匹配器。我想捕获由`should_receive`匹配器返回正确值引起的错误，并导致它输出我的自定义失败消息。

怎么做？或者也许我应该改变我的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T10:30:51.187

答案是：

```
match do |obj|
  # do some setup and mocks here   
  begin
    RSpec::Mocks::verify  # run mock verifications
    true
  rescue RSpec::Mocks::MockExpectationError => e
    # here one can use #{e} to construct an error message
    false
  end
end 
```

终于在[这里找到了](https://github.com/rspec/rspec-mocks/blob/9c169b40fc10a7ae495002c9a1c712e0f791eb8b/spec/rspec/mocks_spec.rb#L31)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-05T23:47:33.523

接受的答案是正确的，但现在已经过时了。[从 RSpec 3.x 开始](https://github.com/rspec/rspec-mocks/commit/f9caf99924758dee268b91a1039aec4e4701b107)，`RSpec::Mocks::verify` [不再](https://github.com/rspec/rspec-mocks/blob/b789d70b76d5bde224796de6e5d2c5af2bbd291b/lib/rspec/mocks/message_expectation.rb#L30-L35)`MockExpectationError` [像以前](https://github.com/rspec/rspec-mocks/blob/9c169b40fc10a7ae495002c9a1c712e0f791eb8b/lib/rspec/mocks/message_expectation.rb#L208-L213)那样加注。

这对我来说效果很好，使用块期望：

```
RSpec::Matchers.define :expect_something_custom do |matcher_args|
  supports_block_expectations

  match do |block|
    expect(…).to receive(…)

    block.call

    RSpec::Mocks.verify
  end
end 
```

```
expect { … }.to expect_something_custom(matcher_args) 
```

另请参阅[有关自定义匹配器的文档](https://relishapp.com/rspec/rspec-expectations/v/3-8/docs/custom-matchers/define-a-custom-matcher#with-a-block-arg)。

# sql - 显示员工每个可能等级的 COUNT，当没有等级条目时显示为零

> ID：13351267
> 
> 赞同：-2
> 
> 时间：2012-11-12T20:43:40.540
> 
> 标签：sql, oracle, join

我只有一张桌子。我想显示该员工的成绩和记录该成绩的次数，但如果该员工没有记录，则必须显示该成绩为 0。当存在两个表时，我知道如何使用左连接来执行此操作，但我只有 1 个表。

这怎么可能？

例如：
表

```
empID |  dept  |  grade
 1    |   11   |    a
 2    |   11   |    a
 3    |   11   |    b
 1    |   22   |    c
 2    |   22   |    f
 3    |   22   |    d
 1    |   33   |    a
 2    |   33   |    a
 3    |   33   |    a 
```

例如，如果我运行`SELECT grade, count(grade) from table where empID = 1 Group by grade;`，它最终只会打印出员工获得的成绩和计数。现在我还想为员工没有的成绩打印出 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:22:47.977

我想你要这个？

```
SQL> select e.grade, count(e2.empid)
  2         from (select distinct grade from e) e
  3              left outer join e e2
  4                           on e2.grade = e.grade
  5                          and e2.empid = 1
  6        group by e.grade
  7        order by grade;

G COUNT(E2.EMPID)
- ---------------
a               2
b               0
c               1
d               0
f               0 
```

或者因为您没有带有“e”等级的行，那么如果您有一个名为等级的查找表：

```
SQL> select * from grade;

G
-
a
b
c
d
e
f

SQL> select e.grade, count(e2.empid)
  2    from grade emp
  3          left outer join emp e2
  4                       on e2.grade = e.grade
  5                      and e2.empid = 1
  6    group by e.grade
  7    order by grade;

G COUNT(E2.EMPID)
- ---------------
a               2
b               0
c               1
d               0
e               0
f               0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:50:33.600

假设您选择一个值的查询是：

```
select value from tbl; 
```

如果 tbl t 中没有行，您可以确保返回 0：

```
 select nvl(t.value, 0) value
     from dual d
left join tbl t on 1=1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:50:38.083

听起来你想要 NVL 功能。使用 NVL，如果值为空，您可以有条件地返回替代值。请参阅文档。

所以，如果你有以下...

```
SELECT fooName, fooNumber FROM foo 
```

这些是你的结果

```
fooName, fooNumber
Blah, 1
Asdf, null
Qwer, 3
poiu, null 
```

你可以像这样重写查询......

```
SELECT fooName, NVL(fooNumber, 0) FROM foo 
```

你的结果现在是......

```
fooName, fooNumber
Blah, 1
Asdf, 0
Qwer, 3
poiu, 0 
```

[http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions105.htm](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions105.htm)

# sql - PostgreSQL 会优化 LIKE '%' 吗？

> ID：13351274
> 
> 赞同：1
> 
> 时间：2012-11-12T20:44:03.490
> 
> 标签：sql, postgresql, sql-execution-plan

我想知道是否会比假设 name 不是 NULL`SELECT * FROM foo`执行得更快？`SELECT * FROM foo WHERE name LIKE '%'`

对文档的任何引用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:40:44.103

您的两个查询都将扫描整个表。name 是否为 NOT NULL 仅在极少数情况下很重要，即（1） name 上有一个索引，（2）它*非常非常*稀疏。只有这样 PostgreSQL 才会考虑从名称索引中查找记录。

在所有其他情况下，此[SQLFiddle](http://www.sqlfiddle.com/#!1/f0e91/1/1)显示 LIKE 版本添加了一个过滤器，必须对其进行检查。PostgreSQL 没有`LIKE '%'`针对非空 varchar 列删除的优化，尽管它看起来很合理。

## 表 SELECT * 所有行

```
QUERY PLAN
Seq Scan on foo (cost=0.00..15.00 rows=1000 width=62) 
```

## 表 SELECT * 所有带有 `LIKE '%' 的行

```
QUERY PLAN
Seq Scan on foo (cost=0.00..17.50 rows=1000 width=62)
Filter: ((name)::text ~~ '%'::text) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:52:03.387

是的。除了简单地返回行之外，使用 LIKE 还需要数据库进行全表扫描。

# actionscript-3 - AS3 声音加载

> ID：13351275
> 
> 赞同：0
> 
> 时间：2012-11-12T20:44:12.803
> 
> 标签：actionscript-3

我正在使用下面的代码来加载外部 mp3 文件：

```
//Create an instance of the Sound class
var soundClip:Sound=new Sound();

//Create a new SoundChannel Object
var sndChannel:SoundChannel=new SoundChannel();

//Load sound using URLRequest
soundClip.load(new URLRequest("namesounds/agamemnonas.mp3"));

//Create an event listener that wll update once sound has finished loading
soundClip.addEventListener(Event.COMPLETE,onComplete,false,0,true);
function onComplete(evt:Event):void {
    //Play loaded sound
    sndChannel=soundClip.play();
} 
```

同样在我的 html 中，我有一个下拉列表：

```
<select name="sounds" id="sounds">
  <option value="sounds/eden.mp3" selected="selected">eden</option>
  <option value="sounds/zeus.mp3">zeus</option>
  <option value="sounds/earth.mp3">earth</option>
</select> 
```

是否可以将下拉菜单中的路径发送到 Flash 文件？例如：

```
//Load sound using URLRequest
soundClip.load(new URLRequest("namesounds/agamemnonas.mp3")); 
```

URLRequest 必须是来自我的 .php 文件的下拉菜单列表的路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:46:32.330

您必须`ExternalInterface.addCallback`在您的 AS 中使用并从 javascript 调用该函数

### AS3

```
ExternalInterface.addCallback("loadSoundClip", loadSoundClip);
function loadSoundClip(mp3File:String):void{
    soundClip.load(new URLRequest(mp3File));
} 
```

### 纯Javascript

```
// This is the <select>
var sounds = document.getElementById('sounds');
// This is the <object>/<embed>
var flashObject = document.getElementById('flashObject');
sounds.onchange = function(){
    flashObject.loadSoundClip(sounds.options[sounds.selectedIndex].value);
}; 
```

## 或者

### jQuery

```
// This is the <select>
var sounds = $('#sounds');
// This is the <object>/<embed>
var flashObject = $('#flashObject');
sounds.on('change', function(){
    flashObject[0].loadSoundClip($(this).val());
}); 
```

**不要忘记将 / 设置`allowscriptaccess`为`object`正确`embed`的值，以便页面可以与 flash 对象通信**

# facebook-graph-api - 使用 Play 2.0.1 和 RestFB 访问签名的 Facebook JSON

> ID：13351276
> 
> 赞同：1
> 
> 时间：2012-11-12T20:44:16.850
> 
> 标签：facebook-graph-api, playframework-2.0, restfb

我正在编写一个 Play 2.0.1 应用程序，它将部署在 Facebook 的画布页面中。我将 restFB 用于 Facebook API。

[通过在https://developers.facebook.com/tools/explorer?method=GET](https://developers.facebook.com/tools/explorer?method=GET)手动创建访问令牌，我可以让我的应用程序访问 Facebook 用户名并将其呈现在 Facebook 上的 Canvas 页面 iFrame 中。

因此，我的应用程序控制器接收 POST 并呈现如下页面：

```
public static Result handle_fb_post() {         
    return redirect(routes.canvas.fb_render_profile_page());
}

public static Result fb_render_profile_page() {
     String accessToken = "<access token copied from facebook graph explorer>";     
     DefaultFacebookClient().getExtendedAccessToken(application_id, application_secret);
     FacebookClient facebookClient = new DefaultFacebookClient(accessToken);
     User fbUser = facebookClient.fetchObject("me", com.restfb.types.User.class);
     return ok(views.html.fbuser.render(fbUser));
} 
```

我的路线设置为：

```
POST    /fbcanvas/  controllers.FBCanvas.handle_fb_post()
GET     /fbcanvas/profile controllers.FBCanvas.fb_render_profile_page() 
```

但是，我如何才能访问 Facebook 在 POST 中发送给我的签名 JSON？我相信这也包含来自用户的访问令牌（假设他们已授权我的应用程序），如下所述：

[https://developers.facebook.com/docs/samples/canvas/](https://developers.facebook.com/docs/samples/canvas/) （参见“signed_request 参数”部分）。

Java、PHP、Javascript 和 Python 有许多示例，但我找不到任何描述如何在 Play 2 中或使用 RestFB 执行此操作的示例。我尝试了许多不同的方法，但无法弄清楚如何在 Play 2 中访问已签名的请求。

谁能帮助并解释如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T21:44:27.343

如果令牌在 POST 请求中作为 Json 发送，则可以通过

```
def handle_post() = Action { implicit request =>
  val jsonBody = request.body.asJson
  //process it
} 
```

# sql - 强制 sql 结果返回每个日期，即使它不在数据库中

> ID：13351279
> 
> 赞同：2
> 
> 时间：2012-11-12T20:44:37.053
> 
> 标签：sql, sql-server-2005

> **可能重复：**
> [从日期范围生成天数](https://stackoverflow.com/questions/2157282/generate-days-from-date-range)

这是我的查询：

```
SELECT SUM(number) AS number, c_date 
    FROM my_table 
    WHERE c_date between '11/6/2012' AND '11/12/2012' 
    GROUP BY c_date 
    ORDER BY c_date DESC 
```

它会返回这样的东西

```
11    '11/12/2012'
9     '11/9/2012'
10    '11/8/2012'
10    '11/7/2012'
10    '11/6/2012' 
```

现在，我如何强制返回结果包含 11/11 和 11/10，*数字*为 0，而不是完全跳过它们。我也无法创建日期表来存储日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:48:48.663

由于您无法创建新表，[因此另一种方法是建立“日历” CTE](http://blog.celdesigns.com/?p=4)。

接下来，`LEFT JOIN`从您新创建的“日历”表中执行以下操作`my_table`：

```
SELECT ISNULL(SUM(mt.number), 0) AS number, mc.c_date 
FROM 
    my_calendar mc LEFT JOIN
    my_table mt ON mt.c_date = mc.c_date
WHERE mc.c_date between '11/6/2012' AND '11/12/2012' 
GROUP BY mc.c_date 
ORDER BY mc.c_date DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:06:55.177

您可以创建一个返回日期范围的用户定义函数。它看起来像这样：

```
CREATE FUNCTION uspDateRange(@MinDate datetime, @Maxdate datetime)
RETURNS @DateRange TABLE ([Date] datetime)
AS
BEGIN
    DECLARE @Date datetime

    SET @Date = @MinDate

    WHILE (@Date < @MaxDate)
    BEGIN
        INSERT INTO @DateRange VALUES(@Date)
        SET @Date = DATEADD(day, 1, @Date)
    END

    RETURN
END
GO 
```

现在您可以选择一个范围来获取 2012 年 10 月所有日期的范围：

```
SELECT * FROM uspDateRange('2012-10-01', '2013-11-01') 
```

您的查询将如下所示：

```
SELECT SUM(number) AS number, c_date 
    FROM my_table t
    INNER JOIN uspDateRange('11/6/2012', '11/12/2012') r ON t.c_date = r.[Date]
    GROUP BY c_date     
    ORDER BY c_date DESC 
```

# jquery - jQuery 工具选项卡 - 从另一个文本链接链接到选项卡？

> ID：13351284
> 
> 赞同：0
> 
> 时间：2012-11-12T20:45:09.383
> 
> 标签：jquery, jquery-ui-tabs, jquery-tools

我正在使用 jQuery 工具选项卡...我需要从同一页面上的单独链接打开选项卡。这是我正在尝试的代码。

```
jQuery(function($){

        $('#accord1trig').click(function(){
              $(".accordion").tabs('selected', 1);
        });

        $('#accord2trig').click(function(){
              $(".accordion").tabs('selected', 2);
        });

        $('#accord3trig').click(function(){
              $(".accordion").tabs('selected', 3);
        });

        $('#accord4trig').click(function(){
              $(".accordion").tabs('selected', 4);
        });

}); 
```

html如下

```
<a href="#" id="accord1trig">Tab Link 1</a>
<a href="#" id="accord2trig">Tab Link 2</a>
<a href="#" id="accord3trig">Tab Link 3</a>
<a href="#" id="accord4trig">Tab Link 4</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:50:32.890

假设您的“单独链接”是：

```
<a href="#" id="click-me">Click me</a> 
```

并且您希望它打开“Tab Link 1”，您可以将`.click()`脚本中的第一个 jQuery 更改为：

```
jQuery(function($){

    $('#accord1trig, #click-me').click(function(){
          $(".accordion").tabs('selected', 1);
    });

    // Remainder of your code...

}); 
```

看看我是如何用逗号分隔并添加`#click-me`到那里的选择器的？

***更新：***

根据您提供的 URL，以下内容对我有用：

```
<script type='text/javascript'>
jQuery(function(){
    jQuery('h4 a[data-tab]').click(function(e){
        e.preventDefault();
        var tab = jQuery('.accordion-toggle:eq(' + (parseInt(jQuery(this).data('tab')) - 1) + ')');
        tab.triggerHandler('click').addClass('current');
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:02:29.420

使用 e.preventDefault() 停止默认操作。您还可以将代码压缩为单个事件处理程序..

添加 HTML-5 数据属性以存储选项卡信息..

**HTML**

```
<a href="#" id="accord1trig" data-tab="1">Tab Link 1</a>
<a href="#" id="accord2trig" data-tab="2">Tab Link 2</a>
<a href="#" id="accord3trig" data-tab="3">Tab Link 3</a>
<a href="#" id="accord4trig" data-tab="4">Tab Link 4</a> 
```

**Javascript**

```
$('#accord1trig ,#accord2trig ,
                #accord3trig ,#accord4trig  ').on('click' , function(){

       var tab = parseInt( $(this).data('tab') , 10) ;
       $(".accordion").tabs('selected', tab);
 }); 
```

**或者简单地说**

```
 $('[id^="accord"]').on('click' , function(){

           var tab = parseInt( $(this).data('tab') , 10) ;
           $(".accordion").tabs('selected', tab);
     }); 
```

# javascript - 多个文件和 iFrame 的范围

> ID：13351286
> 
> 赞同：1
> 
> 时间：2012-11-12T20:45:16.983
> 
> 标签：javascript, html, windows-runtime

我有多个文件：

默认.html

```
<script src="/js/global.js"></script>
<script src="/js/default.js"></script> 
```

全球.js：

```
var session_id=null; 
```

默认.js：

```
session_id = "stuffs";
console.log(session_id); //works 
```

chatroom.html（默认.html 中的 iframe）

```
<script src="/js/global.js"></script>
<script src="/pages/chatroom/chatroom.js"></script> 
```

聊天室.js：

```
console.log(session_id);//doesn't work. returns 
```

如何访问 chatroom.js 中的 session_id？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T20:51:59.563

在 iframe 中尝试以下操作：

```
window.parent.session_id 
```

`window.top`如果您有许多嵌套的 iframe，也应该可以工作：

```
window.top.session_id 
```

# sympy - Sympy无法区分变量

> ID：13351288
> 
> 赞同：0
> 
> 时间：2012-11-12T20:45:18.963
> 
> 标签：sympy

我正在尝试评估一个函数（另一个函数的二阶导数），但 Sympy 似乎很难做到这一点......？

```
from sympy import *
from sympy import Symbol

# Symbols
theta = Symbol('theta')
phi = Symbol('phi')
phi0 = Symbol('phi0')
H0 = Symbol('H0')
# Constants
a = 0.05 
t = 100*1e-9
b = 0.05**2/(8*pi*1e-7)
c = 0.001/(4*pi*1e-7)
phi0 = 60*pi/180 
H0 = -0.03/(4*pi*1e-7)
def m(theta,phi):
    return Matrix([[sin(theta)*cos(phi), sin(theta)*cos(phi), cos(phi)]])
def h(phi0):
    return Matrix([[cos(phi0), sin(phi0), 0]])
def k(theta,phi,phi0):
    return m(theta,phi).dot(h(phi0))
def F(theta,phi,phi0,H0): 
    return -(t*a*H0)*k(theta,phi,phi0)+b*t*(cos(theta)**2)+c*t*(sin(2*theta)**2)+t*sin(theta)**4*sin(2*phi)**2
def F_theta(theta,phi,phi0,H0):
    return simplify(diff(F(theta,phi,phi0,H0),theta))
def F_thetatheta(theta,phi,phi0,H0):
    return simplify(diff(F_theta(theta,phi,phi0,H0),theta))

print F_thetatheta(theta,phi,phi0,H0), F_thetatheta(pi/2,phi,phi0,H0) 
```

如下所示，评估了通用函数，但是当我尝试用 pi/2 或其他值替换 theta 时，它不起作用。

```
(4.0e-7*pi*sin(theta)**4*cos(2*phi)**2 - 4.0e-7*pi*sin(theta)**4 + 0.00125*sin(theta)**2 - 0.0001875*sqrt(3)*sin(theta)*cos(phi) - 0.0001875*sin(theta)*cos(phi) + 1.2e-6*pi*cos(2*phi)**2*cos(theta)**4 - 1.2e-6*pi*cos(2*phi)**2*cos(theta)**2 - 1.2e-6*pi*cos(theta)**4 + 1.2e-6*pi*cos(theta)**2 + 0.004*cos(2*theta)**2 - 0.002625)/pi
Traceback (most recent call last):
File "Test.py", line 46, in <module>
print F_thetatheta(theta,phi,phi0,H0), F_thetatheta(pi/2,phi,phi0,H0)
File "Test.py", line 29, in F_thetatheta
return simplify(diff(F_theta(theta,phi,phi0,H0),theta))
File "Test.py", line 27, in F_theta
return simplify(diff(F(theta,phi,phi0,H0),theta))
File "/usr/lib64/python2.7/site-packages/sympy/core/function.py", line 1418, in diff
return Derivative(f, *symbols, **kwargs)
File "/usr/lib64/python2.7/site-packages/sympy/core/function.py", line 852, in __new__
Can\'t differentiate wrt the variable: %s, %s''' % (v, count)))
ValueError: 
Can't differentiate wrt the variable: pi/2, 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:25:35.917

该错误意味着您无法区分数字 pi/2。即，您根据变量 (x, y...) 而不是数字得出。

在具有多个变量的表达式中，您可以使用以下方法将其中一个（或多个）替换为其值（或另一个表达式）`subs`：

```
F_thetatheta(theta,phi,phi0,H0).subs(theta, pi/2) 
```

然后，要将其评估为所需的准确度，您可以使用`evalf`. 比较两个结果：

```
F_thetatheta(theta,phi,phi0,H0).evalf(50, subs={theta:pi/2, phi:0})
F_thetatheta(theta,phi,phi0,H0).subs({theta: pi/2, phi:0}) 
```

您可能应该查看[sympy 文档](http://docs.sympy.org/dev/modules/evalf.html)或按照[教程](http://docs.sympy.org/dev/tutorial.html)进行操作。文档非常好，您甚至可以在浏览器中尝试示例并评估代码。

# jquery - 使用路由文件将参数散列到漂亮的网址？

> ID：13351289
> 
> 赞同：0
> 
> 时间：2012-11-12T20:45:27.277
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

我正在为列表索引页面（100 个属性）实现（jQuery 同位素）过滤器。过滤器是价格、人员、房间等。

过滤索引页面时...... url 看起来像这样，例如：

```
domain/en/controller
domain/en/controller#.1100
domain/en/controller#.1100.4persons
domain/en/controller#.4persons.4rooms 
```

等

这工作正常。但我想要这样的 SEO 友好网址：

```
domain/en/controller/4persons/2badrooms
domain/en/controller/2persons/pool
ect 
```

这可能与路由文件有关吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T04:55:21.087

我认为你可以做到这一点，在你的路线文件中试试这个：

```
match 'controller/*persons' => 'controllers#action' 
```

所以，用你的网址：

```
domain/en/controller/4persons/2badrooms
domain/en/controller/2persons/pool 
```

那么你可以得到 的值`params[:persons]`，它的值就是`"4persons/2badrooms"`或`"2persons/pool"`。您可以在此处获取更多信息：[Route Globbing](http://guides.rubyonrails.org/routing.html#route-globbing)。

# android - 杰夫夏基列表视图

> ID：13351294
> 
> 赞同：2
> 
> 时间：2012-11-12T20:45:53.347
> 
> 标签：android, listview, android-arrayadapter, listadapter, simpleadapter

我对 Android 和 Java 比较陌生，所以如果这是一个愚蠢的问题，请原谅我。我正在使用 Jeff Sharkeys SeperatedListAdapter，我想创建一个如下所示的列表，其中**HEAD** item_complex.xml、list_item.xml、item_complex.xml ANOTHER **HEADER** ...等等，但我无法理解什么需要做才能实现这一目标。很可能是由于我缺乏android和java知识。有人可以帮帮我吗？

![例子](../Images/00510d6413ba9b3f082fc01686146c94.png)

如果它有帮助...代码...

```
package com.biosonik.iceland.news;

import java.util.LinkedHashMap;
import java.util.Map;

import android.content.Context;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Adapter;
import android.widget.ArrayAdapter;
import android.widget.BaseAdapter;
import com.biosonik.iceland_planner.R;

public class SeparatedListAdapter extends BaseAdapter {  

    public final Map<String,Adapter> sections = new LinkedHashMap<String,Adapter>();  
    public final ArrayAdapter<String> headers;  
    public final static int TYPE_SECTION_HEADER = 0;  

    public SeparatedListAdapter(Context context) {  
        headers = new ArrayAdapter<String>(context, R.layout.list_header);  
    }  

    public void addSection(String section, Adapter adapter) {  

             this.headers.add(section);

        this.sections.put(section, adapter);  
    }  

    public Object getItem(int position) {  
        for(Object section : this.sections.keySet()) {  
            Adapter adapter = sections.get(section);  
            int size = adapter.getCount() + 1;  

            // check if position inside this section   
            if(position == 0) return section;  
            if(position < size) return adapter.getItem(position - 1);  

            // otherwise jump into next section  
            position -= size;  
        }  
        return null;  
    }  

    public int getCount() {  
        // total together all sections, plus one for each section header  
        int total = 0;  
        for(Adapter adapter : this.sections.values())  
            total += adapter.getCount() + 1;  
        return total;  
    }  

    @Override
    public int getViewTypeCount() {  
        // assume that headers count as one, then total all sections  
        int total = 1;  
        for(Adapter adapter : this.sections.values())  
            total += adapter.getViewTypeCount();  
        return total;  
    }  

    @Override
    public int getItemViewType(int position) {  
        int type = 1;  
        for(Object section : this.sections.keySet()) {  
            Adapter adapter = sections.get(section);  
            int size = adapter.getCount() + 1;  

            // check if position inside this section   
            if(position == 0) return TYPE_SECTION_HEADER;  
            if(position < size) return type + adapter.getItemViewType(position - 1);  

            // otherwise jump into next section  
            position -= size;  
            type += adapter.getViewTypeCount();  
        }  
        return -1;  
    }  

    public boolean areAllItemsSelectable() {  
        return false;  
    }  

    @Override
    public boolean isEnabled(int position) {  
        return (getItemViewType(position) != TYPE_SECTION_HEADER);  
    }  

    public View getView(int position, View convertView, ViewGroup parent) {  
        int sectionnum = 0;  
        for(Object section : this.sections.keySet()) {  
            Adapter adapter = sections.get(section);  
            int size = adapter.getCount() + 1;  

            // check if position inside this section   
            if(position == 0) return headers.getView(sectionnum, convertView, parent);  
            if(position < size) return adapter.getView(position - 1, convertView, parent);  

            // otherwise jump into next section  
            position -= size;  
            sectionnum++;  

        }  
        return null;  
    }  

    public long getItemId(int position) {  
        return position;  
    }  

} 
```

活动...

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.planner_list);

        List<Map<String,?>> security = new LinkedList<Map<String,?>>();  
    week34.add(createItem("62","Monday 19th Novermber","C1P1 Change-Over Day 1", "text text text text",String.valueOf(R.drawable.lsnow),"9C"));  
    week35.add(createItem("52","Monday 19th Novermber", "C1P1 Change-Over Day 2", "text text text text",String.valueOf(R.drawable.hsnow),"12C"));  

    // create our list and custom adapter  
    SeparatedListAdapter adapter = new SeparatedListAdapter(this);  

    adapter.addSection("Week 34", 
            new SimpleAdapter(DisplayNewsActivity.this, week34, R.layout.list_complex,  
                    new String[] {ITEM_UID, ITEM_DATE, ITEM_HEADLINE, ITEM_GRAB_LINE, ITEM_WEATHER_TEMP, ITEM_WEATHER_ICON }, new int[] {R.id.uid, R.id.date, R.id.headline, R.id.grab_line,R.id.weather_icon,R.id.weather_temp }));  
    adapter.addSection("UNWANTED HEADER", new ArrayAdapter<String>(this,  
        R.layout.list_item, new String[] { "SIMPLE LIST ENTRY" })); 

    adapter.addSection("Week 35", 
            new SimpleAdapter(DisplayNewsActivity.this, week35, R.layout.list_complex,  
                    new String[] {ITEM_UID, ITEM_DATE, ITEM_HEADLINE, ITEM_GRAB_LINE, ITEM_WEATHER_TEMP, ITEM_WEATHER_ICON }, new int[] {R.id.uid, R.id.date, R.id.headline, R.id.grab_line,R.id.weather_icon,R.id.weather_temp }));  

    list=(ListView)findViewById(R.id.list); 
    list.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-24T12:29:57.033

在`getViewTypeCount()`，为什么它假设标题算作一个？在我看到这种方法的方式中，每个部分会有**两种不同的视图**，因此例如，对于 2 个部分，您将有 4 种类型的视图而不是 3 种，因为它是由这段代码带来的（抱歉我的英语)

# multithreading - XInitThreads() 的缺点是什么？

> ID：13351297
> 
> 赞同：4
> 
> 时间：2012-11-12T20:45:59.383
> 
> 标签：multithreading, qt, x11

我知道`XInitThreads()`将允许我从主线程以外的线程调用 X 服务器，如果我想[使用 Qt 从辅助线程进行 OpenGL 调用](http://doc.qt.digia.com/qq/qq06-glimpsing.html#writingmultithreadedglapplications)，Xlib 中的并发线程支持是必要的。我对我的应用程序有这样的需求，但在非常罕见的情况下。不幸的是，XInitThreads() 需要在我的应用程序执行的一开始就被调用，因此无论我是否需要它来进行特定的运行都会影响它（在我运行应用程序之前我无法知道我是否需要多线程 OpenGL支持与否）。

我很确定如果我无用地调用 XInitThread()，应用程序的整体行为将保持不变，但编程就是权衡取舍，我很确定多线程支持不是 Xlib 的默认行为是有原因的。

[手册页](http://www.x.org/archive/X11R6.8.2/doc/XInitThreads.3.html)说建议单线程程序不要调用此函数，但没有说明原因。调用 XInitThreads() 时的权衡是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-13T13:59:21.410

它在每个显示器上创建一个全局锁，因此每次调用 Xlib 都会执行锁定/解锁。如果您改为进行自己的锁定（使用自己的锁一次将 Xlib 使用保持在单个线程中），那么理论上您可以通过获取锁定、一次执行大量 Xlib 内容然后丢弃来减少锁定开销你的锁。或者在实践中，大多数工具包使用的模型根本不锁定，只是要求应用程序仅在主 UI 线程中使用 X。

由于许多 Xlib 调用正在阻塞（它们等待来自服务器的回复），锁定争用可能是一个问题。

在 Display 上锁定 per-Xlib-call 也有一些语义上的痛苦；在线程 A 上的每个 Xlib 调用之间，理论上任何其他 Xlib 调用都可以在线程 B 上进行。因此线程可以在混淆显示状态方面相互踩踏，即使它们一次只有一个发出 Xlib 请求. 也就是说，XInitThreads() 正在防止由于并发显示访问而导致的崩溃/损坏，但它并没有真正考虑让多个线程共享 X 服务器连接的任何语义考虑。

我认为需要从并发显示访问中获得自己的语义意义是人们不关心 XInitThreads per-Xlib-call 锁定的原因之一。因为无论如何它们最终都会获得应用程序级别或工具包级别的锁。

这里的一种方法是在每个线程中打开一个单独的 Display 连接，这取决于你在做什么。

另一种方法是使用较新的 xcb API 而不是 Xlib；xcb 从头开始​​设计为多线程和非阻塞的。

从历史上看，在某些 OS/Xlib 版本中的 XInitThreads() 中也存在一些错误，尽管我不记得任何细节，但我记得看到那些过去了。

# objective-c - AVCaptureSessionPresetiPad 上的高分辨率？

> ID：13351301
> 
> 赞同：2
> 
> 时间：2012-11-12T20:46:30.327
> 
> 标签：objective-c, ios, video, avfoundation

我需要知道最新 iPad 以及所有各种设备的 AVCaptureSessionPresetHigh 分辨率是多少。Apple 的文档有一个图表，解释了不同预设的各种分辨率，但仅适用于 iPhone 3、3GS 和 4。该图表在这里：http: [//developer.apple.com/library/mac/#documentation /AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html](http://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html)

是否有其他地方为其他设备记录了这一点？我无法在任何地方找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T14:48:00.643

我已经测试了 AVCaptureSessionPresetHigh，在 iPad 4 上它返回了 1280x720 的分辨率！

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T05:16:29.103

我用 iPad 3 (Retina) 进行了测试，它返回 1280x720。

顺便说一句，AVCaptureSessionPresetHigh 是 AVCaptureSession 的默认值。

# java - Java Android HTTP POST 登录错误

> ID：13351307
> 
> 赞同：3
> 
> 时间：2012-11-12T20:46:48.460
> 
> 标签：java, android, http, http-post

我在登录一个用 asp 制作的网站时遇到问题......这是我正在使用的代码：

```
public class MainActivity extends Activity {
Button bottone;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        bottone = (Button) findViewById(R.id.button1);
        if (android.os.Build.VERSION.SDK_INT > 9) {
            StrictMode.ThreadPolicy policy = 
                    new StrictMode.ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy);
            }
        bottone.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // starting new Async Task
                try {
                    login();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    public static void login() throws IOException
    {
        String loginurl = "https://www.blurum.it/Web/", user, pass;
        user = "tester55";
        pass = "provapassword321";

        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(loginurl);

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);
        nameValuePairs.add(new BasicNameValuePair("ctrl_LoginControl$loginView$c01$RPLogin$LoginView$Username", user));
        nameValuePairs.add(new BasicNameValuePair("ctrl_LoginControl$loginView$c01$RPLogin$LoginView$Password", pass));
        nameValuePairs.add(new BasicNameValuePair("remember", "on"));
        nameValuePairs.add(new BasicNameValuePair("ctrl_LoginControl$loginView$c01$RPLogin$LoginView$LoginButton", "Accedi"));

        httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request 
        HttpResponse response = httpClient.execute(httpPost);
        Log.d("logggd", "response stat code " + response.getStatusLine().getStatusCode());

        if (response.getStatusLine().getStatusCode() < 400) {

            String cookie = response.getFirstHeader("Cookie")
                    .getValue();
            Log.d("logggdc", "cookie: " + cookie);

            // get the contacts page 
            HttpGet getContacts = new HttpGet("https://www.blurum.it/Web/default.aspx");
            getContacts.setHeader("Cookie", cookie);
            response = httpClient.execute(getContacts);

            InputStream ins = response.getEntity().getContent();
            BufferedReader in = new BufferedReader(new InputStreamReader(
                    ins));

            String inputLine;
            while ((inputLine = in.readLine()) != null) {
                Log.d("logggd1", " " + inputLine);
            }

            in.close();
        } else {
                Log.d("logggd2", "Response error: "
                        + response.getStatusLine().getStatusCode());
            }
        }
    } 
```

但是我的应用程序崩溃了，所以我在代码中找不到错误......这是logcat：

```
 11-12 20:05:37.678: W/dalvikvm(1806): threadid=1: thread exiting with uncaught exception (group=0xb4177180)
11-12 20:05:37.688: E/AndroidRuntime(1806): FATAL EXCEPTION: main
11-12 20:05:37.688: E/AndroidRuntime(1806): java.lang.NullPointerException
11-12 20:05:37.688: E/AndroidRuntime(1806):     at com.example.testlogin.MainActivity.login(MainActivity.java:93)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at com.example.testlogin.MainActivity$1.onClick(MainActivity.java:53)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.view.View.performClick(View.java:3511)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.view.View$PerformClick.run(View.java:14105)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.os.Handler.handleCallback(Handler.java:605)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.os.Handler.dispatchMessage(Handler.java:92)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.os.Looper.loop(Looper.java:137)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at android.app.ActivityThread.main(ActivityThread.java:4424)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at java.lang.reflect.Method.invokeNative(Native Method)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at java.lang.reflect.Method.invoke(Method.java:511)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
11-12 20:05:37.688: E/AndroidRuntime(1806):     at dalvik.system.NativeStart.main(Native Method)
11-12 20:05:38.218: I/dalvikvm(1806): threadid=3: reacting to signal 3
11-12 20:05:38.228: I/dalvikvm(1806): Wrote stack traces to '/data/anr/traces.txt' 
```

我使用 Tamper Data 在 Firefox 中将发布的数据提取到服务器，这是一个屏幕，我认为登录分为 2 个帖子，这里是屏幕：http: [//i.stack.imgur.com/GZiZ0.png](http://i.stack.imgur.com/GZiZ0.png) http ://i.stack.imgur.com/FKH3P.png

我不确定我是否必须发送第一页或第二个帖子数据，这可能是错误吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:53:20.340

似乎 `response.getFirstHeader("Cookie")`正在回归`null`。

根据[javadoc](http://developer.android.com/reference/org/apache/http/HttpMessage.html#getFirstHeader%28java.lang.String%29)

> 返回具有此消息的指定名称的第一个标头。标题值被忽略。如果消息中有多个匹配的标头，则返回 getHeaders(String) 的第一个元素。如果消息中没有匹配的标头，则返回 null

解决方案：

`null`打电话前做个检查`getValue();`

例子：

```
String cookie = null;
if(response.getFirstHeader("Cookie") != null)
{
cookie = response.getFirstHeader("Cookie")
                    .getValue();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:56:32.267

您不能在代码块中多次调用以下行；

```
response.getStatusLine() 
```

您在看起来像这样的行中不止一次调用它；

```
Log.d("logggd", "response stat code " + response.getStatusLine().getStatusCode()); 
```

然后你在这条线上再次调用它；

```
if (response.getStatusLine().getStatusCode() < 400) { 
```

注释掉第一次调用`response.getStatusLine()`- 那是您尝试记录状态代码的地方。所以你的代码应该是这样的；

```
//Log.d("logggd", "response stat code " + response.getStatusLine().getStatusCode()); 
```

您还想尝试在您的方法中的某个地方执行此操作，称为`login()`;

```
 // Execute HTTP Post Request 
    HttpResponse response = httpClient.execute(httpPost);
    StatusLine statusLine = response.getStatusLine();

    Log.d("logggd", "response stat code " + statusLine.getStatusCode());

    if (statusLine.getStatusCode() < 400) {

         String cookie = null;
          if(response.getFirstHeader("Cookie") != null){
                 cookie = response.getFirstHeader("Cookie").getValue();
          }
          Log.d("logggdc", "cookie: " + cookie);

    //...etc....etc...etc 
```

# android - 为什么我的广播接收器没有得到系统广播动作？

> ID：13351308
> 
> 赞同：4
> 
> 时间：2012-11-12T20:46:52.487
> 
> 标签：android, broadcastreceiver

在清单中指定 BroadcastReceiver 时，我没有收到以下系统操作：

```
public class BRMemoryHandler extends BroadcastReceiver 
{
    public BRMemoryHandler()
    {
        Log.d("BRMH", "ctor");
    }

    @Override
    public void onReceive(Context arg0, Intent arg1) 
    {
        Log.d("BRMH", "onReceive()");
    }
}

<application
    android:name="Test"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.NoTitleBar" >

    <receiver android:name=".BRMemoryHandler" >
        <intent-filter>
            <action android:name="android.intent.action.ACTION_HEADSET_PLUG" />
            <action android:name="android.intent.action.ACTION_DEVICE_STORAGE_OK" />
        </intent-filter>
    </receiver> 
```

但是，如果我在我的主要活动中以编程方式创建相同的广播接收器，我能够接收此操作：

```
void onCreate(Bundle b)
{
    super.onCreate(Bundle b);

    BRMemoryHandler tbr = new BRMemoryHandler();

    IntentFilter intF = new IntentFilter();
    intF.addAction(Intent.ACTION_HEADSET_PLUG);
    intF.addAction(Intent.ACTION_DEVICE_STORAGE_LOW);

    registerReceiver(tbr, intF); 
```

# android - android一次翻译多个动画，使动画运行缓慢且有间隙

> ID：13351311
> 
> 赞同：1
> 
> 时间：2012-11-12T20:46:59.737
> 
> 标签：android, animation

我正在尝试创建一个包含多个图像库的活动。从每个画廊，用户可以使用翻译动画翻转图像。

问题是当用户试图一次翻转许多图像时（我在其他翻转动画结束之前我meab），动画变得非常有间隙和缓慢。

有谁知道如何同时显示许多动画，但仍然让它们顺利进行？

感谢你们

编辑：

动画1：X10

动画2：X10

动画3：X10

动画4：X10

考虑以下场景：从左侧到右侧再返回飞行图像（鸟类）。它对我来说真的很慢而且很糟糕，我不知道为什么。谢谢

# c - 生成非唯一（重复）排列

> ID：13351312
> 
> 赞同：0
> 
> 时间：2012-11-12T20:47:07.757
> 
> 标签：c, permutation, combinatorics

我用 C 编写了一个基本的排列程序。用户输入一个数字，它会打印出该数字的所有排列。

基本上，这就是它的工作原理（主要算法是用于[找到下一个更高排列](https://stackoverflow.com/q/9368205/1380370)的算法）：

```
int currentPerm = toAscending(num);
int lastPerm = toDescending(num);
int counter = 1;

printf("%d", currentPerm);

while (currentPerm != lastPerm)
{
   counter++;
   currentPerm = nextHigherPerm(currentPerm);
   printf("%d", currentPerm);
} 
```

但是，当输入的数字包含重复的数字（重复）时，不会生成一些排列，因为它们是重复的。计数器显示的数字与预期的不同 - 它没有显示数字中位数的阶乘，而是显示了一个较小的数字，只有唯一的排列。

例如：

```
num = 1234567
counter = 5040 (!7 - all unique)

num = 1123456
counter = 2520

num = 1112345
counter = 840 
```

我希望它把重复/重复的数字视为不同的数字——我不想只生成唯一*的*排列——而是生成*所有*的排列，不管它们是否重复和重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:52:07.877

嗯...为什么不直接计算输入字符串长度的阶乘呢？;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:56:15.073

当您有 3 个字母（例如 ABC）时，您可以制作：`ABC, ACB, BAC, BCA, CAB, CBA`、6 种组合（6！）。如果其中 2 个字母像 AAB 一样重复，您可以做出：AAB、ABA、BAA，它不是 3！那是什么？它来自哪里？重复数字或字母时计算它的真正方法是使用组合->`( n k ) = n! / ( n! * ( n! - k! ) )`

我们再做一个说明性的例子：`AAAB`，那么可能的组合`AAAB, AABA, ABAA, BAAA`只有四种组合，如果你用公式计算它们`4C3 = 4.`

生成所有这些列表的正确程序如何：

*   将数字存储在数组中。例子`ABCD`。
*   将数组的 0 元素设置为枢轴元素，并将其从临时数组中排除。`A {BCD}`
*   然后，当您想要所有组合（即使是重复的）时，将时间数组的元素向右或向左移动（随您的喜好），直到到达第 n 个元素。

> A{BCD}------------A{CDB}------------A{DBC}

*   再次执行第二步，但使用临时数组。

> A{B{CD}}------------A{C{DB}}------------A{D{BC}}

*   再次执行第三步，但在第二个临时数组内。

> A{B{CD}}------------A{C{DB}}------------A{D{BC}}
> 
> A{B{DC}}------------A{C{BD}}------------A{D{CB}}

*   转到第一个数组并移动数组，`BCDA`，将 B 设置为枢轴，然后执行此操作，直到找到所有组合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:03:38.597

> 我希望它将重复/重复的数字视为不同的数字 - 我不想只计算唯一排列的数量。

如果唯一`nextHigherPerm()`使用的信息是传入的数字，那么您就不走运了。考虑`nextHigherPerm(122)`。该函数如何知道`122`它已经看到了多少个版本？应该`nextHigherPerm(122)`返回`122`还是`212`？除非您单独跟踪生成器的当前状态，否则无法知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:08:25.670

为什么不将其转换为字符串，然后将您的程序视为一个字谜生成器呢？

# node.js - 如何安装 jasmine-node（理想情况下不使用“sudo”）？

> ID：13351314
> 
> 赞同：2
> 
> 时间：2012-11-12T20:47:22.423
> 
> 标签：node.js, root, npm, jasmine, jasmine-node

所以我是一个被宠坏的 ruby​​ist，基本上再也不用使用 sudo 安装任何东西了。我已经安装了 node.js 和 npm（授予，使用 Mac 64 位 .pkg，天哪知道我的系统上有什么），它们工作正常。

现在，执行以下操作： `npm install jasmine-node -g`

不起作用并说：“请尝试以 root/管理员身份再次运行此命令。” 我的意思是`sudo npm install jasmine-node -g`

做：（`npm install jasmine-node`不是*全局*）工作正常，但没有正确设置我的路径，没有从命令行运行等。

**我*应该*如何安装 jasmine-node？** `cd`并在那里`/usr/local/bin`安装它（没有'-g'选项）？使用自制软件？或者使用`sudo ...`我上面列出的命令？

谢谢。

/更新：如上所述，我使用通用安装程序在我的 Lion OS X Mac（64 位）上安装了 node.js 和 npm，这是我在 /usr/local/bin 中的 node/npm 列表，以防它们是帮助：

```
-rwxr-xr-x  1 24561  wheel       355 Apr 11  2012 /usr/local/bin/node-waf
-rwxr-xr-x  1 24561  wheel  18930304 Oct 25 14:07 /usr/local/bin/node
lrwxr-xr-x  1 root   admin        38 Nov 12 10:00 /usr/local/bin/npm -> ../lib/node_modules/npm/bin/npm-cli.js 
```

另外，我找到[了这个答案](https://stackoverflow.com/a/13219572/492404)，这是另一种选择（除了我上面介绍的三个）。

请让我知道推荐哪种方法（同样，最好不使用“sudo”是我的偏好）。

/结束更新

这是使用`-g`（全局）返回（不使用`sudo`）的方法：

```
npm http GET https://registry.npmjs.org/jasmine-node
npm http 200 https://registry.npmjs.org/jasmine-node
npm http GET https://registry.npmjs.org/jasmine-node/-/jasmine-node-1.0.26.tgz
npm http 200 https://registry.npmjs.org/jasmine-node/-/jasmine-node-1.0.26.tgz
npm ERR! Error: EACCES, mkdir '/usr/local/lib/node_modules/jasmine-node'
npm ERR!  { [Error: EACCES, mkdir '/usr/local/lib/node_modules/jasmine-node']
npm ERR!   errno: 3,
npm ERR!   code: 'EACCES',
npm ERR!   path: '/usr/local/lib/node_modules/jasmine-node',
npm ERR!   fstream_type: 'Directory',
npm ERR!   fstream_path: '/usr/local/lib/node_modules/jasmine-node',
npm ERR!   fstream_class: 'DirWriter',
npm ERR!   fstream_stack: 
npm ERR!    [ 'DirWriter._create (/usr/local/lib/node_modules/npm/node_modules/fstream/lib/dir-writer.js:36:23)',
npm ERR!      '/usr/local/lib/node_modules/npm/node_modules/mkdirp/index.js:37:53',
npm ERR!      'Object.oncomplete (fs.js:297:15)' ] }
npm ERR! 
npm ERR! Please try running this command again as root/Administrator.

npm ERR! System Darwin 11.4.2
npm ERR! command "node" "/usr/local/bin/npm" "install" "jasmine-node" "-g"
npm ERR! cwd /Users/brad/play/troles
npm ERR! node -v v0.8.14
npm ERR! npm -v 1.1.65
npm ERR! path /usr/local/lib/node_modules/jasmine-node
npm ERR! fstream_path /usr/local/lib/node_modules/jasmine-node
npm ERR! fstream_type Directory
npm ERR! fstream_class DirWriter
npm ERR! code EACCES
npm ERR! errno 3
npm ERR! stack Error: EACCES, mkdir '/usr/local/lib/node_modules/jasmine-node'
npm ERR! fstream_stack DirWriter._create (/usr/local/lib/node_modules/npm/node_modules/fstream/lib/dir-writer.js:36:23)
npm ERR! fstream_stack /usr/local/lib/node_modules/npm/node_modules/mkdirp/index.js:37:53
npm ERR! fstream_stack Object.oncomplete (fs.js:297:15)
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /Users/brad/play/troles/npm-debug.log
npm ERR! not ok code 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:50:45.063

当不使用`-g`（全局安装）选项时，“[可执行文件进入`./node_modules/.bin/`](http://blog.nodejs.org/2011/03/23/npm-1-0-global-vs-local-installation/)”。

我不使用`-g`自己。如果你真的不想全局安装它，你可以在你的 $HOME 中安装 jasmine-node 并添加`$HOME/node_modules/.bin`到 $PATH 变量中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T16:36:29.153

我刚刚更改了所有节点关注的文件夹的所有权。

```
sudo chown -R my_account_name /usr/local/lib/node_modules/
sudo chown -R my_account_name /usr/local/lib/node/
sudo chown -R my_account_name /usr/local/include/node/ 
```

我真的不知道这是否是不好的做法，但我真的不在乎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T19:05:23.010

当您运行 npm install -g somepackage 时，您可能会收到 EACCES 错误，要求您以 root/管理员身份再次运行该命令。这是权限问题。

很**容易修复**，打开你的终端（应用程序>实用程序>终端）

```
sudo chown -R $USER /usr/local 
```

** 我强烈建议你不要使用 sudo 进行包管理（sudo npm -g install something），因为以后可能会遇到一些问题**

参考： http: [//foohack.com/2010/08/intro-to-npm/](http://foohack.com/2010/08/intro-to-npm/)

****推荐方式****

原因是这可能会导致许多其他应用程序出现权限问题，所以我建议不要这样做。 **全局安装时更好的解决方案：**

> sudo chown -R `whoami`~/.npm

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-13T01:18:27.483

因此，node 和 npm 社区似乎终于（在过去一年）制定了一种无需使用 sudo 即可安装 npm 和 node 的方法。

由于我在 Mac OS X 上，我发现[这些说明](https://stackoverflow.com/a/26919540/492404)对我适用于`uninstall`node 和 npm，然后我只是用来`brew`安装 npm（它也会自动提供一个节点）。顺便说一句，如果您需要 sudo 安装，您可能需要 sudo 卸载。

如果以上链接的说明不起作用，请尝试投票最多（1500 多票）的答案，以手动操作。

现在已经这样做了，jasmine-node 安装得很好，没有 sudo、任何 chowning 或任何权限争论。只是运行`npm install jasmine-node -g`，一切都很好。

# sql - 如果测试 rownum 的值大于 100，则表 rownum 返回 0 条记录

> ID：13351318
> 
> 赞同：4
> 
> 时间：2012-11-12T20:47:47.700
> 
> 标签：sql, database, oracle, join, oracle11g

> **可能重复：**
> [Rownum 不使用查询](https://stackoverflow.com/questions/9240192/rownum-not-working-with-query)

我正在运行一些测试以了解其`rownum`工作原理。请有人解释以下查询的输出 - 特别是为什么第三个查询返回 0 行。

查询 1 - 返回 2456 行

```
Select rownum, s.id, s.title, sv.version_id
from software s JOIN software_version sv on (s.id = sv.id); 
```

查询 2 - 返回 100 行

```
Select rownum, s.id, s.title, sv.version_id
from software s JOIN software_version sv on (s.id = sv.id)
where rownum between 1 and 100; 
```

查询 3 - 返回 0 行

```
Select rownum, s.id, s.title, sv.version_id
from software s JOIN software_version sv on (s.id = sv.id)
where rownum between 101 and 400; 
```

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-12T21:07:23.690

rownum 仅在获取行并评估其他谓词之后才评估。那是关键。所以如果你说 select * from table where rownum >= 2;

它永远无法工作，因为它就像

```
open cursor loop
  fetch row (rownum is evaluated as the last thing here)
    if fetched then rownum = rownum + 1
end cursor 
```

如果您请求 rownum 从 > 1 开始，那么它永远不会正确。如果你需要做分页，你必须像这样编码

```
select *
  from (select rownum r, t.*
          from your query tables
         order by ..)
 where r>=101 
   and rownum <= 400 
```

[还可以在问汤姆](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:62364503028143)这里阅读更多信息

# c# - 使用 IoC 时未调用 MustHaveHappened

> ID：13351323
> 
> 赞同：0
> 
> 时间：2012-11-12T20:48:01.100
> 
> 标签：c#, unit-testing, mocking, structuremap, fakeiteasy

我正在尝试测试是否进行了服务调用。我有一个`IAuthenticationService`可以`UpdateUserProfile`打电话的。在`IAuthenticationService`IoC 中（`StructureMap`在我的情况下）。 `MustHaveHappened`正在返回`0`呼叫，但我知道它发生在调试中。

```
[TestMethod]
public void It_should_call_the_UpdateUserProfile()
{
    // initialize in the base class, here for brevity
    ObjectFactory.Initialize(registry =>
    {
        registry.For<IAuthenticationService>().Use(A.Fake<IAuthenticationService>());
    });
    UserProfile profileSend = new UserProfile
    {
        UserName = this.HttpContextBaseFake.User.Identity.Name,
        CultureSelection = expectedCultureInfoString
    };

    Utils.UpdateProfile(profileSend);
    IAuthenticationService service = ObjectFactory.GetInstance<IAuthenticationService>();
    UserProfile profileExpect = new UserProfile
    {
        UserName = this.HttpContextBaseFake.User.Identity.Name,
        CultureSelection = expectedCultureInfoString
    };

    // this is returning 0 calls
    // I've also tried sending in the profileExpect instead of A.Dummy<UserProfile>
    // it would be nice to test for the name and string was sent
    A.CallTo(() => service.UpdateUserProfile(A.Dummy<UserProfile>())).MustHaveHappened();
}

// using static class for a reason, the code in my project has more in it
public static class Utils
{
    public static void UpdateProfile(UserProfile profile)
    {
        // user profile is more easily available, use that for the unique identifier
        IAuthenticationService service = ObjectFactory.GetInstance<IAuthenticationService>();
        UserProfile userProfile = new UserProfile
        {
            UserName = userProfileName,
            CultureSelection = cultureInfoString
        };

        service.UpdateUserProfile(userProfile);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T20:56:18.313

我需要在 A.CallTo(.

所以它变成：

```
A.CallTo(() => service.UpdateUserProfile(A<UserProfile>.Ignored)).MustHaveHappened(); 
```

# java - 如何在java中动态创建数据对象？

> ID：13351325
> 
> 赞同：0
> 
> 时间：2012-11-12T20:48:14.250
> 
> 标签：java, object, dynamic, data-objects

我正在研究 Java 中的数据对象

我对动态创建数据对象有疑问。

例如 ，

我们有...

```
public class tasks {
private int vmnumber; 
private int tasknumber;
private String status;
public tasks(int vmnumber , int tasknumber , String status) {
this.vmnumber = vmnumber;
this.tasknumber = tasknumber;
this.status = status; } 
```

还有一些 getvmnumber gettasknumber 、 getstatus 和一些 set 函数

我对创建数据对象的理解是我们每次都必须初始化。

例如，在主文件中，

```
public class task{
public static void main(String [] args){
task t = null , t2 = null;

t = new task();
t.tasknumber = 3;
t.vmnumber = 4;
t.status = "Start";

t2 = new task();
t.tasknumber = 2;
t.vmnumber = 1;
t.status = "Wait";
} 
```

但是，我想我们如何动态创建数据对象，因为程序可能会实时获取任务的信息。（然后我们不能手动创建数据对象，我们需要可以动态创建数据对象的东西.. .)

其次，我想知道如何从数据对象中获取数据。

例如，如果我们想找到任务号 3 的所有信息，我应该怎么做？可以说，我们有 task1、task2、task3 数据对象，我们想查看 task1 的所有信息。那我该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:32:25.613

从你的问题来看，有几点需要讨论。

我猜你想创建新任务，这可能是来自应用程序用户界面的请求，或者是 web 服务，批处理......

好吧，您已经知道如何使用 new 关键字创建对象了。根据原始请求，您的主要功能可能必须创建同一类“任务”的多个实例。

此外，当您实例化“任务”类时，您永远不会希望直接为它的属性分配值。

因此，`t.tasknumber = 3`您应该编码，而不是编码：`t.setTaskNumber(3)`

此外，您应该重命名类的属性以反映 JavaBeans 约定： -`private int taskNumber`而不是`tasknumber`

当然，这只是一个约定，在你的程序中并不是强制性的。但它有助于生成 getter/setter，而且，它是一个约定 :-)

要在您创建的任务中检索“信息”，您只需调用 getter：-`myTask.getTaskNumber()`

希望这对您有所帮助。

# visual-studio - 有没有办法在 IDE 中将两条评论链接在一起？

> ID：13351326
> 
> 赞同：2
> 
> 时间：2012-11-12T20:48:20.347
> 
> 标签：visual-studio, ide

案例：一个源文件中有一个注释，该注释直接链接到另一个源文件中的注释（有关详细信息，请参见 xxx.cs 中的第 315 行）。这种方法的问题在于，第 315 行的注释将来可能不在该行号处。有没有办法在 IDE 中将评论链接在一起？（目前使用 Visual Studio 2010，但不时使用其他 IDE）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:54:29.740

引用一个特定的源文件和行号从来都不是一个好主意，因为有人可能会在另一个文件中移动东西而不知道有什么东西指向它。最好指出特定的类型/方法，例如`See DoThings() in the MyThing class.`.

在 Java 中，您可以使用 Javadoc`@link`来执行此操作，例如`See {@link MyThing#doThings()}`. Eclipse 将在使用其重构工具（例如重命名类或方法）时自动更新这些内容。如果更改是手动完成的，Eclipse 仍然会警告目标`@link`无效。（`@see`在某些情况下也有更合适的。）

我不确定 C# 和 Visual Studio，但它的基于 XML 的文档格式很可能提供类似的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:56:33.733

你可以试试这个插件（我没用过）：

[http://hyperaddin.codeplex.com/](http://hyperaddin.codeplex.com/)

除了这个插件，我唯一能想到的就是使用文件链接直接进入链接文件；就像是：

```
// ...
// See file://path_to_file
//... 
```

该链接将转换为您可以单击使用的实际链接，`Ctrl+Left Click`但它不会将您带到给定的行号 - 它只是打开文件。

路径可以是相对文件路径或完整文件路径 - 如果所有团队成员在项目中使用相同的文件夹结构，则完整路径效果最佳。例如：

`// file://w:/projects/GUI/frmMain.cs`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:52:47.837

处理此问题的唯一方法是将注释放在同一个文件中。复制注释与复制代码不同，尽管理想情况下代码不需要在注释中过多解释。

注释在另一个文件中会引起痛苦的原因有很多。正如您所说，行号可能会更改，但也可能会被删除（因为他们不会知道其他评论引用它），以改变其含义的方式进行更新，并且无论如何都必须打开另一个文件很烦人.

# oracle - 触发器和 nextval 的 Oracle 问题

> ID：13351327
> 
> 赞同：1
> 
> 时间：2012-11-12T20:48:24.267
> 
> 标签：oracle, triggers, nextval

我有一个名为 employees 的表，其中包含以下数据：

```
 Employee_ID     Employee_Salary       Employee_HireDate
  100              ----                  -----
  101              ----                  ----- 
```

现在我想创建一个触发器，允许我获取新的employee_id 并将其递增1，以便将其放入表中。我发现了一个这样的例子：

```
 CREATE OR REPLACE TRIGGER employee_b
 BEFORE INSERT ON employee
 FOR EACH ROW
 DECLARE
      v_employee_id employee.employee_id%TYPE;
 BEGIN
       SELECT employee_ID_SEQ.NEXTVAL
       INTO v_employee_id
           FROM dual;
       :NEW.employee_id:=v_employee_id;
 END; 
```

但我得到的错误是：

```
 ERROR at line 4: PL/SQL: ORA-02289: sequence does not exist 
```

我想在插入事件之前使用该触发器，例如：

```
 INSERT INTO employee(employee_salary,employee_hiredate) VALUES (-----,------) 
```

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:09:57.150

跑

```
create sequence employee_ID_SEQ start with 100 increment by 1; 
```

然后编译触发器并尝试它。阅读序列并设置适当的 CACHE 等值（默认缓存 20 可能没问题，如果您正在执行大量快速插入，您可能需要更多）。

# powershell - ForEach 在 PowerShell 中输出文件

> ID：13351329
> 
> 赞同：0
> 
> 时间：2012-11-12T20:48:30.600
> 
> 标签：powershell, foreach, file-io

我正在尝试将此脚本的结果输出到文本文件。到目前为止，我所有的尝试都给我留下了一个空白的文本文件。

我什至不确定 Out-File 是否是正确的 cmdlet。将我的结果正确输出到 .txt 文件的位置和语法是什么？

```
$store = Get-Content C:\Users\store_list.txt <#list of numbers#>

ForEach ($item in $store)
{
    $item = [int]$item
    Write-Host "Item: " $item  <# Used to show list item being operated
                                  on, can be commented out #>

    if ($item -gt 0 -and $item -le 255)
    {
        Write-Host "10.128.$item.50"
    }

    if ($item -ge 256 -and $item -le 511)
    {
        $item1 = $item-256
        Write-Host "10.129.$item1.50"
    }

    if ($item -ge 512 -and $item -le 767)
    {
        $item2 = $item-512
        Write-Host "10.130.$item2.50"
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T00:04:34.133

完成任务的最简单方法是这样的：

```
$store = Get-Content C:\Users\store_list.txt <#list of numbers#>

ForEach ($item in $store) 
{
    $item = [int]$item
    Write-Verbose "Item:  $item"  <#Use Write-Verbose so you can enable/disable it by
                                passing the -Verbose parameter #>

    if ($item -gt 0 -and $item -le 255)
    {
        "10.128.$item.50" |  Out-File -filePath $filePath -append -encoding utf8
    }
    if ($item -ge 256 -and $item -le 511)
    {
        $item1 = $item-256
        "10.129.$item1.50" |  Out-File -filePath $filePath -append  -encoding utf8
    }
    if ($item -ge 512 -and $item -le 767)
    {
        $item2 = $item-512
        "10.130.$item2.50" |  Out-File -filePath $filePath -append -encoding utf8
    }
} 
```

# hadoop - avro gradle 插件示例使用

> ID：13351334
> 
> 赞同：10
> 
> 时间：2012-11-12T20:48:58.463
> 
> 标签：hadoop, gradle, avro

我正在尝试[在 github 上使用 avro-gradle-plugin](https://github.com/iamsteveholmes/avro-gradle-plugin)，但没有任何运气让它工作。有没有人有任何关于他们如何让它工作的示例代码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-13T19:00:19.473

我想出了如何自己做。以下是我想与可能遇到与我相同问题的人分享的片段：

```
apply plugin: 'java'
apply plugin: 'avro-gradle-plugin'

sourceCompatibility = "1.6"
targetCompatibility = "1.6"

buildscript {
  repositories {
    maven { 
      // your maven repo information here
    }
  }
  dependencies {
    classpath 'org.apache.maven:maven-artifact:2.2.1'
    classpath 'org.apache.avro:avro-compiler:1.7.1'
    classpath 'org.apache.avro.gradle:avro-gradle-plugin:1.7.1'
  }
}

compileAvro.source = 'src/main/avro'
compileAvro.destinationDir = file("$buildDir/generated-sources/avro")

sourceSets {
  main {
    java {
      srcDir compileAvro.destinationDir
    }
  }
}

dependencies {
  compileAvro
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-06T12:22:16.017

我发现“com.commercehub.gradle.plugin.avro”gradle 插件工作得更好。

使用以下：

```
// Gradle 2.1 and later
plugins {
  id "com.commercehub.gradle.plugin.avro" version "VERSION"
}

// Earlier versions of Gradle
buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "com.commercehub.gradle.plugin:gradle-avro-plugin:VERSION"
    }
}
apply plugin: "com.commercehub.gradle.plugin.avro" 
```

更多细节在[https://github.com/commercehub-oss/gradle-avro-plugin](https://github.com/commercehub-oss/gradle-avro-plugin)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-11T18:40:54.117

在评估插件时，需要询问以下问题：

*   生成的文件是否包含在源 jar 中？
*   插件快吗？好的插件使用 avro 工具 api 而不是为每个文件分叉 VM。对于大量文件，为每个文件创建 VM 可能需要 10 分钟来编译。
*   您需要中间 avsc 文件吗？
*   构建增量（即除非其中一个源发生更改，否则不重新生成所有文件）？
*   插件是否足够灵活，可以访问生成的模式文件，因此可以进行进一步的操作，例如在模式存储库中注册模式？

如果您对插件不满意或需要更多灵活性，则无需任何插件即可轻松实现。

```
//
// define source and destination
//
def avdlFiles = fileTree('src/Schemas').include('**/*.avdl')
// Do NOT generate into $buildDir, because IntelliJ will ignore files in 
// this location and will show errors in source code
def generatedJavaDir = "generated/avro/java"

sourceSets.main.java.srcDir generatedJavaDir

//
// Make avro-tools available to the build script
//
buildscript {
    dependencies {
        classpath group:'org.apache.avro', name:'avro-tools' ,version: avro_version
    }
}

//
// Define task's input and output, compile idl to schema and schema to java
//
task buildAvroDtos(){
    group = "build"

    inputs.files avdlFiles
    outputs.dir generatedJavaDir

    doLast{
        avdlFiles.each { avdlFile ->
            def parser = new org.apache.avro.compiler.idl.Idl(avdlFile)
            parser.CompilationUnit().getTypes().each { schema ->
                def compiler = new org.apache.avro.compiler.specific.SpecificCompiler(schema)
                compiler.compileToDestination(avdlFile, new File(generatedJavaDir))
            }
        }
    }
}

//
// Publish source jar, including generated files
//
task sourceJar(type: Jar, dependsOn: buildAvroDtos) {
    from sourceSets.main.allSource
    // Package schemas into source jar
    into("Schemas") { from avdlFiles }
}

// Clean "generated" folder upon "clean" task
clean {
    delete('generated')
} 
```

# html - IE9 中的 DXIMageTransform.Microsoft.Matrix 模糊

> ID：13351339
> 
> 赞同：6
> 
> 时间：2012-11-12T20:49:07.687
> 
> 标签：html, css, internet-explorer, internet-explorer-9, quirks-mode

我在 IE9 中注意到使用矩阵 DXIImageTransform 会使旋转的文本像素化。我在 IE8 或 7 中没有这个问题。通常我会在 IE9 中使用 css3 选项，但由于我无法控制的原因，页面以怪异模式呈现（有效的 html5 iframe 嵌入在没有 doctype 的第 3 方页面中）

这是我正在使用的代码：

```
<!--Looks like crap but is my only option in quirks mode-->
<span style="position:absolute; 
    filter:progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', 
    M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678);">
  Does this make my butt look pixelated?    
</span> 
```

在 IE8 中，旋转后的文本是平滑的，但在 IE9 中它非常像素化。与此相比（在怪癖模式下不起作用）

```
<!-- looks great but doesn't work in quirks mode-->
<span style="position:absolute; top:150px; -ms-transform: rotate(-45deg);">
    Does this make my butt look pixelated?
</span> 
```

要查看它的实际效果，请查看**IE9中的这个小提琴** [http://jsfiddle.net/U4CCD/3/](http://jsfiddle.net/U4CCD/3/)

**我的问题**是，如何在 IE9 中以怪癖模式旋转文本，这看起来并不全是像素化和模糊的。为什么矩阵变换开始在 IE9 中吸吮？

如果你很幸运没有运行 IE9，这就是我所看到的。更清晰的示例是它在 IE8 中的外观以及使用 css3 转换的外观。

![IE9 很烂](../Images/a83059c11c0c2f4c4df1b423374267fd.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T18:31:25.800

最终我发现我目前的配置根本无法做到这一点。但是，我能够通过将我的有效 html5 页面包装在一个对象中，然后嵌入到 iframe 中来解决它。在 IE 9 中，这似乎允许我的页面以标准模式在 iframe 中呈现，并使用看起来干净的 SVG 转换。我创建了以下包装 aspx 脚本：

```
<%@ Page Language="C#" %>

<% 
    string url = "app/path";
    if(!String.IsNullOrEmpty(Request.QueryString["path"]))
        url = HttpUtility.UrlDecode(Request.QueryString["path"]);

    url += "?i=1";
    if(!String.IsNullOrEmpty(Request.QueryString["id"]))
        url += "&id=" + Request.QueryString["id"];

    if(Request.Browser.Browser!="IE"||Request.Browser.MajorVersion!=9) {
        Response.Redirect(url);   
    }
    url += "&quirky=1";
%>
<html>
<head><title></title>
</head>
<body style="width:100%; height:100%; margin:0; padding:0; overflow:hidden;">
<object type="text/html" data="<% =url %>" style="overflow:hidden; width:100%; height:100%"></object>
</body>
</html> 
```

# python - 尝试使用列表理解过滤字典

> ID：13351341
> 
> 赞同：0
> 
> 时间：2012-11-12T20:49:12.183
> 
> 标签：python

使用单个语句，打印仅包含原子符号及其对应权重的字典，这些元素在 wts（我的字典）中的原子符号中只有一个字母。即，包括“H”但省略“He”。我的字典设置为`{'H':'1.00794','He':'4.002602','Li':'6.941','Be':'9.012182','B':'10.811','C':'12.0107','N':'14.0067','O':'15.9994'}`

```
[for element in wts if len(element) == 1] 
```

我在想一个列表理解会起作用，但是，我怎么让它只看元素符号。这将返回错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_45.py", line 10, in <module>
    exec compile(u"print _support_.syseval(python, u'[for element in wts if len(element) == 1]', __SAGE_TMP_DIR__)" + '\n', '', 'single')
  File "", line 1, in <module>

  File "/sagenb/sage_install/sage-5.3-sage.math.washington.edu-x86_64-Linux/devel/sagenb-git/sagenb/misc/support.py", line 487, in syseval
    return system.eval(cmd, sage_globals, locals = sage_globals)
  File "/sagenb/sage_install/sage-5.3-sage.math.washington.edu-x86_64-Linux/local/lib/python2.7/site-packages/sage/misc/python.py", line 53, in eval
    eval(compile(s, '', 'exec'), globals, globals)
  File "", line 3
    [for element in wts if len(element) == 1]
       ^
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:51:06.930

您有语法错误（如 Python 所述）。利用：

```
[element for element in wts if len(element) == 1] 
```

列表推导式必须以 . 之前的表达式开头`for`。使用此语法，您可以应用进一步的操作，例如大写：

```
[element.upper() for element in wts if len(element) == 1] 
```

因为你必须重复迭代变量名太多，你会经常看到用短变量名编写的推导。我可以这样写`x`：

```
[x for x in wts if len(x) == 1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:55:46.737

由于您被要求“**打印**仅包含原子符号及其相应权重的字典......”我认为答案应该使用字典理解，如下所示：

```
>>> print {el: wt for el, wt in wts.iteritems() if len(el) == 1}
{'H': '1.00794', 'C': '12.0107', 'B': '10.811', 'O': '15.9994', 'N': '14.0067'} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:02:59.050

您可以使用列表组合：

```
>>> dts = {'H':'1.00794','He':'4.002602','Li':'6.941','Be':'9.012182','B':'10.811','C':'12.0107','N':'14.0067','O':'15.9994'}
>>> [(el, weight) for el, weight in dts.iteritems() if len(el) == 1]
[('C', '12.0107'), ('B', '10.811'), ('N', '14.0067'), ('H', '1.00794'), ('O', '15.9994')] 
```

或者`filter`：

```
>>> filter(lambda (k, v): len(k) == 1, dts.iteritems())
[('C', '12.0107'), ('B', '10.811'), ('N', '14.0067'), ('H', '1.00794'), ('O', '15.9994')] 
```

# android - 从安卓设备通过蓝牙广播消息

> ID：13351345
> 
> 赞同：1
> 
> 时间：2012-11-12T20:49:32.207
> 
> 标签：android, ios, bluetooth, broadcast

我想将简单的短信从Android设备广播到附近的iOS和Android设备。该消息足够短且静态，因此就我而言，它甚至可以作为设备蓝牙名称。唯一的要求是我在其他设备（iOS 和 Android）上的应用无需配对即可读取。

那可能吗？如果是，如何？我听说过 bonjour，但是可以使用它在 Android 和 iOS 之间广播简单的消息吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:04:01.897

我不知道目的是什么，但如果您认为消息足够短，请更改适配器的名称。

```
String message = "Read me before I change!";
BluetoothAdapter myAdapter = getDefaultAdapter();
myAdapter.setName(message); 
```

# codeigniter - 注销链接失效

> ID：13351346
> 
> 赞同：1
> 
> 时间：2012-11-12T20:49:35.933
> 
> 标签：codeigniter

因此，我尝试单击注销链接并结束会话，但它似乎不起作用。

链接位于此处：应用程序-> 视图-> 模块-> header.php 看起来像这样：

```
<a href="../admin/logout">Logout</a> 
```

在管理控制器中，我具有以下功能：

```
public function logout()
{
    $this->session->unset_userdata('logged_in');
    session_destroy();
    redirect('admin', 'refresh');
} 
```

我的管理员路由文件如下所示：

```
$route['admin/(:any)'] = 'admin/view/$1';
$route['admin'] = 'admin'; 
```

管理员视图文件夹位于：views -> admin

问题：当我单击注销链接时，它什么也不做。就像在我的管理员中一样，如果没有会话，它会被重定向到登录屏幕。那行得通，但是当我注销时，如果它重定向到管理页面，如果没有会话，则假设重定向到登录页面，为什么什么也没发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:04:30.983

为什么在注销时重定向到管理员？只是出于好奇。

试试这个，听起来你的链接本身就是问题所在。使用 base_url() 意味着您不必担心相对 url 会根据您在站点中的深度而变得混乱。

```
<a href="<?php echo base_url();?>admin/logout">Logout</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T04:02:56.270

`$route['admin/(:any)'] = 'admin/view/$1';`

此代码正在重定向`admin/logout`到`admin/view/logout`

所以，就像你说的，`$route['admin/logout'] = 'admin/logout';`在你的路线顶部附近添加应该会把你带到正确的页面

# spring - 登录和注销后 Spring Security 重定向回引用 URL

> ID：13351347
> 
> 赞同：3
> 
> 时间：2012-11-12T20:49:52.440
> 
> 标签：spring, grails, redirect, spring-security, grails-plugin

我正在使用 Spring Security 进行身份验证。登录和注销按钮位于页面布局上，所有页面都使用该布局。我有一个 BookController，它需要创建操作的参数（例如，图像 ID）：

```
class BookController {

@Secured("ROLE_USER")   
def create() {
  def someImage = params.imageId
  ...
}
@Secured("ROLE_USER")   
def show() {
  ...
}
...
} 
```

我的登录控制器是：

```
class LoginController {
...
def auth() {
  ...
  redirect uri: SpringSecurityUtils.securityConfig.successHandler.defaultTargetUrl
}
...
} 
```

这将在登录成功后将用户重定向到基本 URL。我想让用户始终被重定向到引用 URL，这是他成功登录之前的 URL。

例如：用户没有登录，他在home/index，想要访问book/create，只有登录用户可以访问。在这种情况下，Spring Security 会将用户重定向到 login/auth 并（在他成功登录后）重定向到 /（这是基本 URL）。

我想让重定向转到用户试图访问的 URL，在这种情况下是 book/create。任何其他操作也应如此。如果 home/index 上的未登录用户尝试访问 book/show/32333，他将被重定向到 login/auth，并在成功登录后返回 book/show/32333。

我该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:11:27.510

我有以下解决方案：

```
 HttpSession session = request.getSession(false)
        def referUrl
        def referParamsMap
        def referParams = "?"
        if(session != null) {
            SavedRequest savedRequest = new HttpSessionRequestCache().getRequest(request, response)
            if(savedRequest != null) {
                referUrl = savedRequest.getRedirectUrl()
                referParamsMap = savedRequest.getParameterMap()
                referParamsMap.each { referParams += "${it.key}=${it.value[0]}&" }
            }
        }
        println "referUrl "+referUrl+referParams
        if(referUrl != null)
            redirect url: referUrl+referParams
        else
            redirect uri: SpringSecurityUtils.securityConfig.successHandler.defaultTargetUrl 
```

唯一的问题是，如果未登录的用户在页面上并登录（通过单击布局 GSP 上的登录链接），他将始终被重定向到 defaultTargetUrl 而不是他之前的页面。

在这种情况下，有没有办法获得正确的网址？

# java - 从输入文件中获取值并逐行添加到整数数组（java）

> ID：13351349
> 
> 赞同：1
> 
> 时间：2012-11-12T20:49:55.487
> 
> 标签：java, arrays, file, integer

本质上，我有一个整数行文件。每行有 9 个数字。我想阅读文件。然后将每一行输入到它的数组中。我希望数组每次都相同。因为我将对从第一行创建的数组进行一些处理。然后使用不同的行处理相同的数组。

我的输入文件如下：

```
8 5 3 8 0 0 4 4 0
8 5 3 8 0 0 4 2 2 
```

我正在使用的当前代码是：

```
 BufferedReader br = new BufferedReader(new FileReader("c:/lol.txt"));
            Scanner sc = new Scanner(new File("c:/lol.txt"));
            String line;
            while (sc.hasNextLine()){
                line = sc.nextLine();
                int k = Integer.parseInt(line); 
```

现在显然我应该做更多的事情，我只是不确定如何去做。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:58:52.647

尝试：

```
import java.util.Scanner;
import java.io.File;

public class Test {
    public static void main(String[] args) throws Exception {
        Scanner sc = new Scanner(new File("c:/lol.txt"));

        while (sc.hasNext()) {
            String line = sc.nextLine();
            // get String array from line
            String[] strarr = line.split(" "); // attention: split expect regular expression, not just delimiter!
            // initialize array
            int[] intarr = new int[strarr.length];
            // convert each element to integer
            for (int i = 0; i < strarr.length; i++) {
                intarr[i] = Integer.valueOf(strarr[i]); // <= update array from new line
            }
        }
    }
} 
```

当然，您应该处理异常来传递它。

# ipad - 移动 Safari 滚动页面键盘关闭

> ID：13351350
> 
> 赞同：0
> 
> 时间：2012-11-12T20:49:59.703
> 
> 标签：ipad, events, dom, safari

我们有一个需要在 iPad 上运行的 HTML5 网络应用程序。问题是当键盘打开时页面（正文）向上滚动。当键盘关闭时，页面保持在向上滚动的位置。我们需要检测键盘的关闭并向下滚动页面。我无法确定让我知道用户已关闭键盘的事件。我们使用 WSIWIG 基于 Javascript 的 HTML 编辑器来编辑内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T01:40:13.303

经过更多调查，我了解到 iPad Safari 存在 iframe 问题。在我们的案例中，编辑区域位于 iFrame 中，因此当键盘关闭时页面滚动出现问题。当我们消除 iframe 时，问题就解决了。

# java - Java 使用什么版本的 HTML 来呈现标记文本

> ID：13351353
> 
> 赞同：0
> 
> 时间：2012-11-12T20:50:03.670
> 
> 标签：java, html, swing, syntax, version

我只是想知道 Java 5、6 和 7 支持哪个版本的 HTML 语法，我似乎没有在网上找到任何关于此的文档。

编辑：抱歉，澄清一下，我的意思是通过 Swing 呈现 UI 内容，例如 JLabel 文本值等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:54:12.117

来自[HTMLEditorKit JavaDoc](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/HTMLEditorKit.html)：

> Swing JEditorPane 文本组件通过称为EditorKit 的插件机制支持不同类型的内容。因为 HTML 是一种非常流行的内容格式，所以默认提供了一些支持。默认支持由此类提供，它支持 HTML 3.2 版（带有一些扩展），并且正在向 4.0 版迁移。

[请注意教程Swing HTML 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/html.html)底部的微妙建议：

> 如果您使用 JavaFX 进行编程，请参阅 HTML 编辑器。

此外，他们指出了一个错误：

> 还要注意，当一个按钮被禁用时，它的 HTML 文本不幸地保持黑色，而不是变成灰色。（请参阅错误 #4783068 以查看这种情况是否会改变。）

底线：HTML 支持非常基础，实现得不是很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:01:13.403

用于生成网页的常见 java 库是 spring MVC。下页提到了对 spring mvc 的 jsp 标签库和 html5 的支持。

[http://www.thymeleaf.org/thvsjsp.html](http://www.thymeleaf.org/thvsjsp.html)

# css - 在 css 中创建独特的背景，插入图像

> ID：13351360
> 
> 赞同：0
> 
> 时间：2012-11-12T20:50:44.277
> 
> 标签：css, background

有没有办法在css中创建这样的背景？我不知道如何描述它，所以谷歌无法帮助我。谢谢！

![想要的背景](../Images/30177c5586e8defac270a563bcba68cd.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:04:46.373

您可能可以使用 SVG 图像来完成此操作，但请注意支持可能参差不齐。在 Photoshop 或 GIMP 中创建它并使其变得非常大（比如 1620x1080）可能会更容易

对 CSS 和 SVG 背景的快速搜索出现了这个[页面](http://helephant.com/2009/08/12/svg-images-as-css-backgrounds/)；但这是从 2009 年开始的。

# php - Kohana 3.3 中的助手类

> ID：13351361
> 
> 赞同：1
> 
> 时间：2012-11-12T20:50:46.503
> 
> 标签：php, kohana, helper

我想创建我的自定义助手类，但我总是`ErrorException [ Fatal Error ]: Class 'media' not found`在调用`print media::alert();`.

这是我的课：

```
class media_Core {
    public static function alert() {
        return "adsfasffasdsafd";
    }
} 
```

目录结构如下所示`application/helpers/media.php`。我也尝试按照这些[步骤](https://stackoverflow.com/questions/5524119/class-not-found-exception-making-a-helper-on-kohana-3-1)操作，但仍然无法正常工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T20:58:53.620

根据[Kohana 3.3 约定](http://kohanaframework.org/3.3/guide/kohana/conventions)，类映射的行为如下：

*   `media_Core`映射到`application/classes/media/Core.php`
*   `Helpers_Media`映射到`application/classes/Helpers/Media.php`

约定页面还描述了命名类的样式指南。

如果你想打电话`media::alert()`，你的班级必须被命名`media`并在`application/classes/media.php`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:55:21.997

名称应该是 Helpers_Media，以便 Kohana 可以在 helpers/ 目录 [http://kohanaframework.org/3.0/guide/kohana/conventions中找到您的类](http://kohanaframework.org/3.0/guide/kohana/conventions)

# macos - 推送 64 位英特尔 osx

> ID：13351363
> 
> 赞同：8
> 
> 时间：2012-11-12T20:51:00.050
> 
> 标签：macos, assembly, x86-64

我想将 64 位地址推入堆栈，如下所示，

```
__asm("pushq $0x1122334455667788"); 
```

但是我得到编译错误，我只能按以下方式推送，

```
__asm("pushq $0x11223344"); 
```

有人可以帮我理解我的错误吗？

我是组装新手，所以如果我的问题听起来很愚蠢，请原谅。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-13T00:40:26.720

x86-64 有一些有趣的怪癖，即使您熟悉 32 位 x86，这些怪癖也不明显……

1.  大多数指令只能采用 32 位立即数，如果在 64 位上下文中使用，则将其符号扩展为 64 位。（指令编码只存储 32 位。）

    这意味着您可以使用`pushq`范围内的立即值`0x0`- `0x7fffffff`（即用 0 位符号扩展的正符号 32 位值）或`0xffffffff80000000`- `0xffffffffffffffff`）（即用 1 位符号扩展的负符号 32 位值） . 但是您不能使用超出此范围的值（因为它们无法在指令编码中表示）。

2.  `mov`是一种特殊情况：有一种编码采用完整的 64 位立即操作数。因此丹尼尔的回答（这可能是你最好的选择）。

3.  如果您*真的*不想破坏寄存器，则可以使用多个较小值的推送。但是，推送两个 32 位值的显而易见的事情是行不通的。在 64 位世界中，`push`将使用 64 位操作数（受上述第 1 点约束，如果它是立即数常量）或 16 位操作数，但不是 32 位操作数（甚至`pushl %eax`无效）。所以你能做的最好的就是 4 个 16 位推送：

    `pushw $0x1122; pushw $0x3344; pushw $0x5566; pushw $0x7788`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-12T22:04:59.127

你最好的选择是做这样的事情。

```
movq $0x1122334455667788, %rax
pushq %rax 
```

替换`%rax`为您认为合适的任何其他 64 位寄存器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-12T20:56:21.547

没有一条指令能够获取 64 位立即数并将其压入堆栈。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-13T06:51:24.677

从[如何使用 rip 相对寻址](https://stackoverflow.com/questions/3250277/how-to-use-rip-relative-addressing-in-a-64-bit-assembly-program/13356588)

```
pushq my_const(%rip)
...
my_const: .quad 1122334455667788 
```

# java - 如何为不属于该组织的用户授予角色的组织管理权限？

> ID：13351364
> 
> 赞同：2
> 
> 时间：2012-11-12T20:51:01.057
> 
> 标签：java, liferay, user-permissions, rbac

我正在使用*Liferay 6.1*，并且我想更改单个组织的**权限**，以便这些组织可以由不属于该组织**OrgA**的具有**RoleX的****UserX**管理。

 ****尤其是：

*   我想让**OrgA** 可以通过**RoleX**以形式*查看和更新***`Control Panel->Users and Organizations`**
***   **UserX**可以添加新的组织和用户*   **UserX**属于**RoleX**但**不属于 OrgA**（所以我认为组织范围的角色不会有帮助）。**

 **我想以**编程**方式进行。

* * *

**到目前为止我已经尝试过**：

*   创建**RoleX**并赋予它以下权限：

    *   访问控制面板->用户和组织（portlet 125）
    *   组织机构，范围 4（个人）：

        ActionKeys.VIEW、ActionKeys.UPDATE、ActionKeys.ASSIGN_USER_ROLES、ActionKeys.DELETE、ActionKeys.MANAGE_USERS

    *   OrgA 的小组，范围 4：

        ```
        ActionKeys.ASSIGN_MEMBERS, ActionKeys.ASSIGN_USER_ROLES,
        ActionKeys.CONFIGURE_PORTLETS, ActionKeys.DELETE,
        ActionKeys.MANAGE_ANNOUNCEMENTS, ActionKeys.MANAGE_LAYOUTS,
        ActionKeys.UPDATE, ActionKeys.VIEW, ActionKeys.VIEW_MEMBERS 
        ```

拥有 RoleX 的用户可以访问`Users and Organizations`控制面板中的表单，但他们只能看到自己的组织，而看不到 OrgA。

如何授予查看和管理 OrgA 的权限？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:11:19.207

最后，我能够完成`Resource Permissions`对**RoleX**的修改和修改 init users_admin portlet jsp 文件，两者都使用 Hook 插件。

主要问题是 Liferay 没有使用 ResourcePermissions 来启用用户所属组织之外的组织管理。

特别`portal-trunk/portal-web/docroot/html/portlet/users_admin/init.jsp`是只有几行代码**仅针对 Company Admin Role**启用它：

```
else if (permissionChecker.isCompanyAdmin()) {
    filterManageableGroups = false;
    filterManageableOrganizations = false;
    filterManageableUserGroups = false;
} 
```

因此，我在 init.jsp 中添加了以下几行（您可以在钩子中使用 init-ext.jsp），以便也为**RoleX**启用它：

```
if (MyUtils.isRoleX()) {
    filterManageableGroups = false;
    filterManageableOrganizations = false;
    filterManageableUserGroups = false;
} 
```

这样，数据库查询不会过滤组织、用户和组。

第二步是定义添加、更新、管理等权限。用户和组织以及访问控制面板中的 portlet。

使用启动操作钩子和`ResourcePermisssionLocalService`API 非常简单：

```
private static final String[] ORGANIZATION_ENTRY_ACTION_IDS = new String[] {
            ActionKeys.VIEW, ActionKeys.UPDATE, ActionKeys.ASSIGN_USER_ROLES,
            ActionKeys.DELETE, ActionKeys.MANAGE_USERS };

    private static final String[] ORGANIZATION_CUSTOM_FIELDS_ENTRY_ACTION_IDS = new String[] {
            ActionKeys.VIEW, ActionKeys.UPDATE };

    public static final String[] ORGANIZATION_MODEL_ACTION_IDS = new String[] {
            ActionKeys.ASSIGN_MEMBERS, ActionKeys.ASSIGN_USER_ROLES,
            ActionKeys.DELETE, ActionKeys.MANAGE_ANNOUNCEMENTS,
            ActionKeys.UPDATE, ActionKeys.VIEW, ActionKeys.MANAGE_USERS,
            ActionKeys.MANAGE_SUBORGANIZATIONS };

    public static final String[] ORGANIZATION_GROUP_ENTRY_ACTION_IDS = new String[] {
            ActionKeys.ASSIGN_MEMBERS, ActionKeys.ASSIGN_USER_ROLES,
            ActionKeys.UPDATE, ActionKeys.VIEW, ActionKeys.VIEW_MEMBERS };

    private static final String[] PORTAL_ACTION_IDS = new String[] {
            ActionKeys.ADD_USER, ActionKeys.ADD_ORGANIZATION,
            ActionKeys.VIEW_CONTROL_PANEL };

    private static final String[] USERS_ORG_ADMIN_ACTION_IDS = new String[] { ActionKeys.ACCESS_IN_CONTROL_PANEL }; 
```

……省略……

```
 ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,
                Organization.class.getName(),
                ResourceConstants.SCOPE_GROUP_TEMPLATE, "0", CiUtils
                        .getRoleX().getPrimaryKey(),
                ORGANIZATION_MODEL_ACTION_IDS);

        // ORGANIZATION MODEL COMPANY PERMISSIONS
        ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,
                Organization.class.getName(), ResourceConstants.SCOPE_COMPANY,
                Long.toString(companyId),
                CiUtils.getRoleX().getPrimaryKey(),
                ORGANIZATION_MODEL_ACTION_IDS);

        // PORTAL (portlet 90) PERMISSIONS
        ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,
                "90", ResourceConstants.SCOPE_COMPANY,
                Long.toString(companyId),
                CiUtils.getRoleX().getPrimaryKey(),
                PORTAL_ACTION_IDS);

        // USER_ORG_ADMINS PORTLET (125) PERMISSIONS
        ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,
                "125", ResourceConstants.SCOPE_COMPANY,
                Long.toString(companyId),
                CiUtils.getRoleX().getPrimaryKey(),
                USERS_ORG_ADMIN_ACTION_IDS); 
```

对于每个组织：

```
ResourcePermissionLocalServiceUtil.setResourcePermissions(organization.getCompanyId(),
                            Organization.class.getName(),   ResourceConstants.SCOPE_INDIVIDUAL, Long                    .toString(organization.getPrimaryKey()),
                                MyUtils.getRoleX().getPrimaryKey(),
                                ORGANIZATION_ENTRY_ACTION_IDS);
        long groupId = organization.getGroupId();

        ResourcePermissionLocalServiceUtil.setResourcePermissions(
                    organization.getCompanyId(),Group.class.getName(), ResourceConstants.SCOPE_INDIVIDUAL,Long.toString(groupId),
                    MyUtils.getRoleX().getPrimaryKey(),
                    ORGANIZATION_GROUP_ENTRY_ACTION_IDS); 
```

希望这可以帮助别人。******

# c - C : 0 & 1 组合使用递归

> ID：13351365
> 
> 赞同：1
> 
> 时间：2012-11-12T20:51:03.990
> 
> 标签：c, recursion, combinations, truthtable

我想根据变量编号（数字）使用 c 递归地列出 o 和 1 的组合

我想要的输出是

```
000
001
010
011
100
101
110
111 
```

我尝试了很多算法，最后一个是：

```
void permute(unsigned number)    {

    if(number == 0) {
        printf("\n");
        return;
    }

    permute(number - 1);
        printf("0");
    permute(number - 1);
        printf("1");

}   //permute ends here

void permuteN(unsigned number) {

    unsigned i;

    for(i = 0; i < number + 1; i++){
        permute(i);
    }
}   //permuteN ends here 
```

我认为它给了我答案但没有订购，因为我不知道该放在哪里 \n;

需要你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T20:54:51.757

如果您确实只是在寻找`1`'s 和`0`'s 的组合，我建议您只需**计算数字**并以二进制形式列出它们。

取`0...7`二进制数字并只取最后 3 位（可能应用掩码），最终得到与您指定的相同的集合：

```
000
001
...
...
111 
```

对于**n 位**组合，您需要执行`0..2^n - 1`

* * *

根据[**这个答案**](https://stackoverflow.com/a/700184/759019)，对于3 位 的**一个特定情况****（归功于@ChrisLutz 和 @dirkgently）**

```
#include <stdio.h>
int main(){
int numdigits = 3, j;
    for(j=1; j<8; j++)
        printbits(j);
}

void printbits(unsigned char v) {
  int i;
  for(i = 2; i >= 0; i--) putchar('0' + ((v >> i) & 1));
  printf("\n");
} 
```

**输出：**

```
000
001
010
011
100
101
110
111 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T20:58:35.193

您实际上所做的只是将数字转换为二进制......一个简单的循环可以在没有任何库调用的情况下完成此操作（除了`printf`）......

```
const unsigned int numbits = 3;
unsigned int bit;

for( bit = 1U << (numbits-1); bit != 0; bit >>= 1 ) {
    printf( number&bit ? "1" : "0" );
}
printf( "\n" ); 
```

* * *

已编辑，因为您似乎想要递归。您需要有一些方法来指定您需要多少位。您需要将其传递到您的递归例程中：

```
#include <stdio.h>

void permute(unsigned number, unsigned bits)
{
    if( bits == 0 ) return;
    permute(number / 2, bits-1);
    printf( "%d", number % 2 );
}   //permute ends here

void permuteN(unsigned number, unsigned bits ) {

    unsigned i;

    for(i = 0; i < number + 1; i++){
        permute(i, bits);
        printf("\n");
    }
}   //permuteN ends here

int main(void)
{
    permuteN(7, 3);
    return 0;   
} 
```

要按您需要的顺序获得输出，您不知道何时编写换行符。所以在这种情况下，你以后再写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:25:58.520

@paddy 有一个很好的答案；只增加了一点（正如你对我的评论的回复，我的强硬 - 比赛有点晚了）。这依赖于 pow() ，（以及 log10 打印的一些细节），尽管如此；如果使用 gcc 编译`-lm`：

`base`这里可能有点令人困惑 - 但你猜你明白了。

> gcc -Wall -Wextra -pedantic -o combo combo.c -lm

```
/* gcc - Wall -Wextra -pedantic  -o combo combo.c -lm */
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

static void prnt_combo(unsigned number, unsigned bits, int base)
{
    if (!bits)
        return;
    prnt_combo(number / base, --bits, base);
    printf("%d", number % base);
}

void prnt_combos(int bits, int base)
{
    int i;
    int n = pow(base, bits);
    int wp = log10(n) + 1;

    fprintf(stderr,
        "Printing all combinations of 0 to %d by width of %d numbers. "
        "Total %d.\n",
        base - 1, bits, n
    );

    for (i = 0; i < n; i++) {
        fprintf(stderr, "%*d : ", wp, i);
        prnt_combo(i, bits, base);
        printf("\n");
    }
}

/* Usage: ./combo [<bits> [<base>]]
 *        Defaults to ./combo 3 2
 * */
int main(int argc, char *argv[])
{
    int bits = argc > 1 ? strtol(argv[1], NULL, 10) : 3;
    int base = argc > 2 ? strtol(argv[2], NULL, 10) : 2;

    prnt_combos(bits, base);
    return 0;
} 
```

样本：

```
$ ./combo 4 2
Printing all combinations of 0 to 1 by width of 4 numbers. Total 16.
 0 : 0000
 1 : 0001
 2 : 0010
 3 : 0011
 4 : 0100
 5 : 0101
 6 : 0110
 7 : 0111
 8 : 1000
 9 : 1001
10 : 1010
11 : 1011
12 : 1100
13 : 1101
14 : 1110
15 : 1111 
```

或*干净的*输出：

```
$ ./combo 3 2 >&2-
000
001
010
011
100
101
110
111 
```

您可能想添加如下内容：

```
if (base > 10)
    printf("%x", number % base);
else
    printf("%d", number % base); 
```

在`prnt_combo()`. 这样你就可以得到 2 16 的 ie：

```
 0 : 00
    1 : 01
    2 : 02
    3 : 03
    4 : 04
  ...
  250 : fa
  251 : fb
  252 : fc
  253 : fd
  254 : fe
  255 : ff 
```

# windows - 具有不同刷新率的 OpenGL 多头垂直同步

> ID：13351369
> 
> 赞同：2
> 
> 时间：2012-11-12T20:51:40.460
> 
> 标签：windows, winapi, opengl

如何使用 OpenGL（在 Windows 7 上）以不同的分辨率和刷新率驱动多个显示器（多头），并且仍然能够在设备之间共享纹理？

我有一个多头 gpu。它驱动 4 个磁头。（它恰好是 AMD FirePro V7900，以防万一。）所有头都共享一个“场景”（顶点和纹理数据等），但我希望每次在显示器上发生 vsync 时渲染这个场景（每个头本质上是一个不同的视口）。但问题是不同的磁头可能具有不同的刷新率。例如，有些显示器可能是 60Hz，有些可能是 30Hz，有些可能是 24Hz。

当我调用`SwapBuffers`调用块时，我无法判断下一个需要渲染哪个头部。我希望有类似 Direct3D9 的`[IDirect3DSwapChain9::Present](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205908%28v=vs.85%29.aspx)`带有`[D3DPRESENT_DONOTWAIT](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172585%28v=vs.85%29.aspx#D3DPRESENT_DONOTWAIT)`标志的东西，以及相关的`D3DERR_WASSTILLDRAWING`返回值。使用这种方法，我可以确定接下来要渲染哪个头。通过循环轮询不同的头，直到一个成功。但我不知道OpenGL中的等效方法是什么。

我已经发现`wglSwapIntervalEXT(1)`使用 vsync。而且我可以在 HDC 之间切换以使用单个 HGLRC 渲染到不同的窗口。但是刷新率的差异让我很困惑。

我不确定我能做些什么来让一个 HGLRC 以不同的刷新率渲染所有这些显示器。我认为它必须是单个 HGLRC 才能有效利用共享纹理（和其他资源）......如果我错了，请纠正我。如果资源与多个 HGLRC 重复，我并不感兴趣，因为我希望这会将我的内存减少到 25%（1 个 GPU 上的 4 个磁头：所以我不想要任何资源的 4 个副本。）

如果需要的话，我对使用多个线程的想法持开放态度。

有人能告诉我如何构建我的主循环，以便我可以共享资源，但仍然以自己的刷新率和分辨率驱动显示器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:24:44.517

您可以通过共享上下文来共享携带数据的 OpenGL 缓冲区。Windows 中的调用是 names `wglShareLists`。

使用它，您可以为每个窗口提供在自己的线程中运行的自己的渲染上下文，而所有上下文共享它们的数据。多窗口垂直同步实际上是多线程 OpenGL 有意义的少数情况之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:29:16.150

我以前没有做过这样的事情。

看起来您实际上需要多个线程才能获得独立的刷新率。

OpenGL 渲染上下文只能在一个线程中处于活动状态。一个线程只能有一个活动的渲染上下文。因此，对于多个线程，您将需要多个渲染上下文。

可以在 OpenGL 上下文之间[共享资源。](http://www.opengl.org/wiki/Platform_specifics%3a_Windows#wglShareLists)这样就不必多次存储资源。

# ruby-on-rails-3 - 找不到 CoffeeScript 函数

> ID：13351375
> 
> 赞同：0
> 
> 时间：2012-11-12T20:52:08.800
> 
> 标签：ruby-on-rails-3, coffeescript, ruby-on-rails-3.2

我有一个最近从 3.1 升级的 Rails 3.2.8 应用程序，并且我已将所有原始`application.js`代码转换为 CoffeeScript。其中大部分工作正常。但是，我有一个面包屑函数，我在几个未找到的视图中调用它。现在，我只是发出警报，看看它是否有效：

```
product_breadcrumb = (attr) ->
  alert attr 
```

那在一个名为`product_search.js.coffee`. 它正在成功编译，最终看起来像这样：

```
(function() {
  var product_breadcrumb;
  product_breadcrumb = function(attr) {
    return alert(attr);
  };
}).call(this); 
```

我想是的，我不知道。无论如何，在 Firebug 中我得到：

```
ReferenceError: product_breadcrumb is not defined 
```

请注意，这是在 Ajax 调用之后。我不知道为什么该功能不可用。毕竟这只是一个函数定义。它不应该仍然可用于 Ajax 调用中呈现的 HTML 吗？我不明白为什么找不到该功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:09:39.650

这需要在全局范围内，然后您需要以这种方式调用它。

你应该写：

```
root = exports ? this 
```

并命名你的功能

```
root.product_breadcrumb 
```

然后您可以按预期在其他地方调用它。

请参阅[此答案](https://stackoverflow.com/a/4215132/417872)以获得更长的解释。

# asp.net-mvc-3 - 首先使用数据库为自动生成的 desgner.cs 创建伙伴类

> ID：13351379
> 
> 赞同：0
> 
> 时间：2012-11-12T20:52:40.827
> 
> 标签：asp.net-mvc-3, entity-framework-4.1, data-annotations, buddy-class

我想为 Datafirst Entity Framework 中自动生成的 Designer.cs 创建一个伙伴类，以使用数据注释实现验证。

我在 google 上找到的解决方案包含具有简单属性的示例，例如

```
public int EmpID
{get;set;} 
```

而在 Designer.cs 中生成的属性中包含一些逻辑。对于前

```
/// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=false)]
    [DataMemberAttribute()]
    public global::System.Byte RoleID
    {
        get
        {
            return _RoleID;
        }
        set
        {
            OnRoleIDChanging(value);
            ReportPropertyChanging("RoleID");
            _RoleID = StructuralObject.SetValidValue(value);
            ReportPropertyChanged("RoleID");
            OnRoleIDChanged();
        }
    } 
```

请指导如何为上述属性创建伙伴类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:02:58.440

您可以使用部分类为上述属性创建伙伴类。看看这篇文章：[Entity Framework using Partial classes to add business logic and validation to generated entity](http://robbincremers.me/2012/01/31/entity-framework-using-partial-classes-to-add-business-logic-and-validation-to-generated-entities/)

如果您需要创建大量的伙伴类并且有一致的模式，那么考虑使用代码生成：[使用 T4 模板自定义实体设计器生成的代码](http://blogs.msdn.com/b/efdesign/archive/2009/01/22/customizing-entity-classes-with-t4.aspx)

# c# - 如何将 UIActivityViewController 与 MonoTouch 一起使用

> ID：13351380
> 
> 赞同：4
> 
> 时间：2012-11-12T20:52:44.577
> 
> 标签：c#, xamarin.ios, ios6, uiactivityviewcontroller

我正在尝试使用`UIActivityViewController`以下代码从 MonoTouch 访问：

```
var textToShare = new NSString("hallo there");
var activityItems = new NSObject[] {textToShare};
var excludedActivityTypes = new NSString[] { new NSString("UIActivityTypePostToWeibo"),       new NSString("UIActivityTypeMessage") };
var activityViewController = new UIActivityViewController(activityItems, null);
activityViewController.ExcludedActivityTypes = excludedActivityTypes;
this.PresentViewController(activityViewController, true, null) 
```

显示 iOS 操作表，但不排除指定的活动。有什么建议吗？有没有这方面的 MonoTouch 示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T00:00:22.523

你很亲密。改变这个：

```
var excludedActivityTypes = new NSString[] { 
    new NSString("UIActivityTypePostToWeibo"),
    new NSString("UIActivityTypeMessage") 
}; 
```

进入：

```
var excludedActivityTypes = new NSString[] {
    UIActivityType.PostToWeibo,
    UIActivityType.Message
}; 
```

注意：常量的名称并不总是与其值相同。同样，ObjC 比较指针（而不是它们的值）以检测常量相等是很常见的（即使是不好的做法）`NSString`——在这种情况下创建自己的`NSString`实例将不起作用（无论如何，暴露`const`的外观更好看，代码完成效果更好来自 IDE）。

# java - 使用 Fitnesse 测试基于 xml over http 的服务

> ID：13351383
> 
> 赞同：1
> 
> 时间：2012-11-12T20:53:02.803
> 
> 标签：java, testing, automated-tests, fitnesse, fit-framework

我正在努力想出一个好方法来使用 Fitnesse 为基于 xml over http 的服务编写自动化验收测试。这些服务具有复杂的请求和响应，其中包含未在服务之间共享的模式中的 xml 元素。我不想创建大量的 Fixture 代码来构建请求、编组/解组以及为每个服务执行 http 调用。

我研究了 RestFixture(https://github.com/smartrics/RestFixture)，这似乎是一种限制测试此类服务的管道工作的好方法。唯一的问题是以一种好的方式生成请求。对于“真正的”休息服务，这不是问题，但我的服务在请求正文中需要大量 xml。

我想以某种方式允许测试人员使用 Scenario 表建立他们的请求，但是由于所有服务都使用不同的模式，所以如果不创建一个非常复杂的后备夹具来负责创建所有不同的服务，它就看不到我怎么能做到这一点request 或多个 Fixture，每个 Fixture 负责为一项服务生成请求。无论哪种情况，我都会重新编写昂贵的管道。这里有没有人对此有一些想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-01T19:34:44.877

我创建了一个夹具来解决这个问题，而无需任何额外的编码：[XmlHttpTest](https://github.com/fhoeben/hsac-fitnesse-fixtures/wiki/2.-Slim-Fixtures#xmlhttptest)。使用模仿 XML 结构的（自定义）Java 代码不处理创建请求。相反，它被处理为生成需要替换占位符的文本值。使用 XPath 表达式执行检查。

单个调用的示例用法（摘自[项目的 GitHub wiki 页面之一）：](https://github.com/fhoeben/hsac-fitnesse-fixtures/wiki/4.-XmlHttpTest-Examples)

```
!define POST_BODY { {{{
<s11:Envelope xmlns:s11="http://schemas.xmlsoap.org/soap/envelope/">
  <s11:Body>
    <ns1:GetCityWeatherByZIP xmlns:ns1="http://ws.cdyne.com/WeatherWS/">
      <ns1:ZIP>90210</ns1:ZIP>
    </ns1:GetCityWeatherByZIP>
  </s11:Body>
</s11:Envelope>
}}} }

|script         |xml http test                                                       |
|post           |${POST_BODY}   |to                   |${URL}                        |
|check          |response status|200                                                 |
|show           |response                                                            |
|register prefix|weather        |for namespace        |http://ws.cdyne.com/WeatherWS/|
|check          |xPath          |//weather:City/text()|Beverly Hills                 | 
```

[（结果）](http://fhoeben.github.io/hsac-fitnesse-fixtures/examples-results/HsacExamples.SlimTests.HttpTests.HttpPost1Test.html)

或者（使用场景拨打多个电话）

```
!*> Scenario definition
!define POST_BODY_2 { {{{
<s11:Envelope xmlns:s11="http://schemas.xmlsoap.org/soap/envelope/">
  <s11:Body>
    <ns1:GetCityWeatherByZIP xmlns:ns1="http://ws.cdyne.com/WeatherWS/">
      <ns1:ZIP>@{zip}</ns1:ZIP>
    </ns1:GetCityWeatherByZIP>
  </s11:Body>
</s11:Envelope>
}}} }

|script|xml http test|

|table template |send request                                                        |
|post           |${POST_BODY_2} |to                   |${URL}                        |
|check          |response status|200                                                 |
|show           |response                                                            |
|register prefix|weather        |for namespace        |http://ws.cdyne.com/WeatherWS/|
|check          |xPath          |//weather:City/text()|@{City}                       |
*!

|send request       |
|zip  |City         |
|10007|New York     |
|94102|San Francisco| 
```

（[结果](http://fhoeben.github.io/hsac-fitnesse-fixtures/examples-results/HsacExamples.SlimTests.HttpTests.HttpPost2UsingScenarioTest.html)）

对于更复杂的请求，[fixture 还允许使用 Freemarker 模板](http://fhoeben.github.io/hsac-fitnesse-fixtures/examples-results/HsacExamples.SlimTests.HttpTests.HttpPost3UsingFreemarkerTemplateTest.html)（用于可选元素和迭代等）。

# mod-rewrite - 尝试使用 ModRewrite 实现登录禁区

> ID：13351387
> 
> 赞同：0
> 
> 时间：2012-11-12T20:53:24.293
> 
> 标签：mod-rewrite, basic-authentication, extranet

我正在尝试使用基本身份验证和 ModRewrite 实现登录限制区域。我正在尝试的逻辑是，除非引用页面位于外联网或登录页面中，否则请求可能需要身份验证，因此我将请求转发到登录页面。然后，如果用户已经通过身份验证，请求将自动转发回请求的 URL。

我正在尝试使用以下重写规则来实现上述目标，但是在用户通过身份验证并且请求恰好在没有引用者的情况下出现后，请求最终会在重写规则和来自登录页面的重定向之间循环。

有人知道我在这里做错了什么吗？

问候，

奥利

```
RewriteCond %{HTTP_REFERER} !^/extranet/(.*)$ [NC]    
RewriteCond %{HTTP_REFERER} !^/extranet_login.html [NC]    
RewriteRule ^/extranet/(.*)$ /extranet_login.html?url=%{REQUEST_URI} [L,R,NC] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:00:24.310

最后想通了。

问题是我在我的登录页面中为已经过身份验证的用户执行 response.sendDirect。这意味着没有推荐人。在页面完全加载后在 javascript 中执行重定向可以解决此问题并为我提供引用。

奥利

# .net - 匹配多个条件的密码检查正则表达式

> ID：13351390
> 
> 赞同：1
> 
> 时间：2012-11-12T20:53:49.537
> 
> 标签：.net, regex, visual-studio

在谷歌上广泛搜索后，我遇到了一个问题。我正在尝试根据我在 SO 上找到的一个正则表达式

1.  字符串必须为 8-24 个字符，并且

2.  除了长度之外，字符串还需要匹配以下两个条件（最少）：

    *   大写
    *   小写
    *   数字
    *   非字母数字

这是我一直试图修改的正则表达式：

```
^.*(?=.{8,24})(?=.*\d|\W)(?=.*[a-zA-Z]).*$ 
```

我需要修改它以确保密码符合上述条件。

我不能进入并以编程方式执行此操作，因为它会改变我们某些代码如何工作的其他基本原理。现在我们已经进行了正则表达式检查，所以我必须做的就是使用新表达式更新配置文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:30:00.350

也许尝试类似（删除空格）

```
^
(((?=.*[a-z])
  ((?=.*[A-Z])|(?=.*\d)|(?=.*\W))) |
 ((?=.*[A-Z])
  ((?=.*\d)|(?=.*\W))) | 
 ((?=.*\d)(?=.*\W)))
.{8,24}
$ 
```

其结构如下：

```
^<char restrictions><length restriction>$ 
```

在哪里

```
char restriction = (<lower> and (<upper> or <numeric> or <non-alphanum>)) 
                  or (<upper> and (<numeric> or <non-alphanum>))
                  or (<numeric> and <non-alphanum>) 
```

（所有这些都是前瞻。）

长度限制不是前瞻，因为我们需要告诉正则表达式引擎在字符串的开头和结尾之间应该有 8 到 24 个字符。（通过将`.*`任何地方放在顶层，我们失去了执行此限制的能力。）

* * *

但是，应该尽一切努力更改代码，而不是使用这种可怕的正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T02:28:41.317

不，它不是很漂亮，但是您*可以*像这样使用蛮力使用单个正则表达式有效地做到这一点（假设 C#）：

## 正则表达式匹配 4 个密码条件中的 2 个：

```
Regex re = new Regex(@"
    # Match 2 of 4 passwords criteria and length from 8 to 24.
    ^                   # Anchor to start of string.
    (?:                 # Group acceptable pair alternatives.
      (?=[^A-Z]*[A-Z])  # At least one Upper Case.
      (?=[^a-z]*[a-z])  # At least one Lower Case.
    |                   # or...
      (?=[^A-Z]*[A-Z])  # At least one Upper Case.
      (?=[^0-9]*[0-9])  # At least one Numeric.
    |                   # or...
      (?=[^A-Z]*[A-Z])  # At least one Upper Case.
      (?=\w*\W)         # At least one Non-AlphaNumeric.
    |                   # or...
      (?=[^a-z]*[a-z])  # At least one Lower Case.
      (?=[^0-9]*[0-9])  # At least one Numeric.
    |                   # or...
      (?=[^a-z]*[a-z])  # At least one Lower Case.
      (?=\w*\W)         # At least one Non-AlphaNumeric.
    |                   # or...
      (?=[^0-9]*[0-9])  # At least one Numeric.
      (?=\w*\W)         # At least one Non-AlphaNumeric.
    )                   # Brute force!
    .{8,24}             # Match from 8 to 24 chars.
    \z                  # Anchor to end of string.
    ", RegexOptions.IgnorePatternWhitespace);
if (re.IsMatch(text)) {
    // Password is valid.
} else {
    // Password is NOT valid.
} 
```

4 个要求中的 2 个有六种可能的组合。最后的`.{8,24}`长度检查假定除换行符以外的任何字符都可以（您可能/应该想要修改它）。

**编辑：**我现在看到 dbaupp 的答案工作得很好（我给了它我的赞成票）。尽管我查找大写字母的表达式：`(?=[^A-Z]*[A-Z])`比： 更有效`(?=.*[A-Z])`（其他前瞻也是如此）。另一方面，dbaupp 的答案在分组方面更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-30T20:26:45.440

```
def check_password_strength(x):
    ## Initialize the toggle flags to check 3 conditions - Capital Letter/Small Letter/Numeric Value
    flag_capital_letter = 0
    flag_small_letter = 0
    flag_numerical_letter = 0

    ## Message strings that will be displayed to the user
    strong_pass_msg = "Strong password"
    weak_pass_msg = "Weak Password"

    if len(x) >= 6 and len(x) <= 12 : ## Ensure the Length of Password between [6,12], both inclusive 
        if '#' in x or '$' in x or '@' in x : ## At least one Special Character Should be in password
            for i in x:  ## Loop for parsing the string to check for 3 remaining conditions
                if i.islower():
                    flag_small_letter = 1
                if i.isupper():
                    flag_capital_letter = 1
                if i.isnumeric():
                    flag_numerical_letter = 1
            ## if all three conditions are fulfilled, all flags toggle to 1
            if flag_numerical_letter == 1 and flag_capital_letter == 1 and flag_small_letter == 1:
                return(strong_pass_msg)
            else:
                return(weak_pass_msg)
        else:
            return(weak_pass_msg)
    else:
        return(weak_pass_msg)

username = input("Enter your Username: ")
password = input("Enter Password: ")
check_password_strength(password) 
```

# c++ - C++：Linux 中的计时（使用时钟（））不同步（由于 OpenMP？）

> ID：13351396
> 
> 赞同：2
> 
> 时间：2012-11-12T20:54:20.923
> 
> 标签：c++, c, time, openmp, clock

在我的程序的顶部和末尾，我使用 clock() 来计算我的程序需要多长时间才能完成。不幸的是，它的报告时间似乎只有一半。我用“时间”命令仔细检查了这一点。

我的程序报告：在 45.86 秒内完成

时间命令报告：real 0m22.837s user 0m45.735s sys 0m0.152s

用我的手机计时，它在 23 秒内完成（又名：“真实”时间）。“用户”时间是所有线程的总和，因为我使用的是 OpenMP，所以这很有意义。（你可以在这里阅读：[What do 'real', 'user' and 'sys' mean in the output of time(1)?](https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1)）

那么，为什么 clock() 在“用户”时间而不是“实时”时间报告？我应该使用不同的函数来计算我的程序运行了多长时间？

作为旁注，Windows 的时钟（）按预期工作并“实时”报告。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T20:56:26.153

> 用户 0m45.735s

`clock()`根据 7.27.2.1 测量进程使用的 CPU 时间（尽可能好）

> 自仅与程序调用相关的实现定义时代开始以来，clock 函数返回实现对程序使用的处理器时间的最佳近似值。

而不是挂钟时间。因此，`clock()`报告的时间接近于正常且符合标准的报告`user`时间。`time`

要测量经过的时间，如果您可以假设 POSIX，using`clock_gettime`可能是最好的选择，标准函数`time()`也可以用于此，但不是很细粒度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:00:18.090

我建议[`clock_gettime`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_getres.html)使用`CLOCK_MONOTONIC`时钟。

根据您的特定系统，这应该提供接近微秒或更好的分辨率，并且如果（例如）有人在您的程序运行时设置系统时间，它不会做有趣的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:05:45.120

我建议在 OpenMP 应用程序中进行基准测试，您可以使用可移植的 OpenMP 计时函数`omp_get_wtime()`，该函数返回一个`double`包含自过去某个未指定时间点以来的秒数的值。调用它两次并减去返回值以获得经过的时间。您可以通过调用来了解时间测量的精确度`omp_get_wtick()`。它返回`double`计时器分辨率的值 - 更接近的值`0.0`表示更精确的计时器。

# .htaccess - .htaccess 文件用于漂亮的 url

> ID：13351397
> 
> 赞同：1
> 
> 时间：2012-11-12T20:54:22.710
> 
> 标签：.htaccess, friendly-url, pretty-urls

（这似乎应该是网络上最常见和最容易解决的问题之一，因为大多数网站都有“漂亮”或“干净”的网址。但在我所有的搜索中，它被证明是最复杂的问题之一。）

以最简单的形式，我希望能够进入**`example.com/about`**url 栏并让服务器返回文件**`example.com/about.php`**。事实上，我必须输入或链接到 example.com/about.php，这不是 SEO 或用户友好的。这与复杂的字符串无关——文件可以很容易地成为`example.com/about.html`.

我有一些我试图与`.htaccess`文件一起使用的代码，但它似乎什么也没做：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteCond %{SCRIPT_FILENAME} !-f
RewriteRule ^([a-z]+)/$ /$1.php 
```

我知道该`.htaccess`文件正在运行，因为我设置的 404 重定向（出现在`.htacces`我在这里包含的代码下方的文档中）运行正常，尤其是当我尝试访问`example.com/about`并获得 404 页面时。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:31:26.703

您的最后一条规则旨在匹配[http://example.com/about/](http://example.com/about/)。我想你想要的是

```
RewriteRule ^([a-z]+)$ $1.php 
```

# php - php循环 - 检查总数之前的最后一个倍数

> ID：13351398
> 
> 赞同：0
> 
> 时间：2012-11-12T20:54:25.143
> 
> 标签：php, foreach

假设您有一个包含 30 个字符的数组，并且您正在循环它们以在 HTML 中构建一个可视网格。我想知道它何时在最后一行项目上并应用 CSS 规则。对于每 8 个项目，我可以使用下面的代码应用附加的 CSS 规则：

```
$cnt=1;
foreach ($characters as $index => $character){
   if ($cnt % 8==0) echo "newline";
   $cnt++;
} 
```

由于我只有 30 个字符，因此将有 3 行和较短的第 4 行（它将只有 6 个项目）。如何将 24-30 之间的每个字符标记为属于最后一行。字符的总数总是不同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:58:50.233

```
$rowCount = 8; // the number of items per row
$lastRowStarts = intval(floor(count($characters) / $rowCount)) * $rowCount;
// e.g: floor(30 / 8) * 8 = 3 * 8 = 24 = <index of first item in last row>

$index = 1;
foreach ($characters as $character) {
   if ($index >= $lastRowStarts) echo "last line";

   $index++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:59:21.887

```
$cnt=1;
$length = strlen($characters);//if a string
//$length = count($characters);//if an array
foreach ($characters as $index => $character){
   if ($cnt % 8==0) echo "newline";
   if($index > ($length - 8))//or whatever number you want
   {
      echo 'flagged';//flag here however
   }
   $cnt++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:00:14.127

只要您的行长度为 8，这将适用于任何大小的字符。这假设`$cnt`是一个保持循环计数器的变量。

```
$count = count($charchters)

foreach ($characters as $index => $character){
   if ($cnt % 8==0) echo "newline";
   if ($cnt < $count && $cnt > ($count - $count % 8)) echo "This is on the last row";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:05:26.437

您可以`array_pop`在摸索它们后使用它们来获取最后一行`array_chunk`

```
header("Content-Type: text/plain");

$characters = range(1, 30); // Generate Random Data
$others = array_chunk($characters, 8); //Break Them apart
$last = array_pop($others); //Get last row

foreach ( $others as $characters ) {
    echo implode("\t", $characters), PHP_EOL;
}

print_r($last); // Do anything you want with last row 
```

输出

```
1   2   3   4   5   6   7   8
9   10  11  12  13  14  15  16
17  18  19  20  21  22  23  24 
```

最后一排

```
Array
(
    [0] => 25
    [1] => 26
    [2] => 27
    [3] => 28
    [4] => 29
    [5] => 30
) 
```

# wpf - WPF MediaElement - 视频暂停和位置重置时图像不会更新

> ID：13351403
> 
> 赞同：4
> 
> 时间：2012-11-12T20:54:49.573
> 
> 标签：wpf, c#-4.0, mediaelement

我正在使用 WPF MediaElement 播放视频。当 MediaElement 暂停时，我将位置设置为视频中的另一个点。我希望 MediaElement 中的视频图像刷新以反映新位置。但在我再次按下播放按钮之前，它不会更新图像。有没有办法在不调用其 Play 方法的情况下强制刷新 MediaElement 图像？

代码示例

```
TimeSpan tsPosition = new TimeSpan(0,0,30);   // set to 30 seconds
MediaElementObj.Position = tsPosition;
 if (PlayStatus == PAUSED) // ignore if not paused
            {
                // image refresh method call here if there is a way to do it
            } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T21:54:59.213

将MediaElement 上的[ScrubbingEnabled属性设置为 true。](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.scrubbingenabled.aspx)

# mongodb - 如何将 gridfs 与不接受非阻塞 gridfs 的库一起使用？

> ID：13351405
> 
> 赞同：0
> 
> 时间：2012-11-12T20:54:50.570
> 
> 标签：mongodb, asynchronous, pymongo, nonblocking, gridfs

我如何`gridfs`与不接受非阻塞 gridfs 并且只接受非阻塞其他调用的库一起使用？我得到了错误：

```
from mongotor.database import Database
import gridfs
db = Database.connect("localhost:27017", "mydb")
fs = gridfs.GridFS(db)

---------------------------------------------------------------------------
TypeError                                 
Traceback (most recent call last)
<ipython-input-4-e0f456d7d574> in <module>()
----> 1 fs = gridfs.GridFS(db)

C:\Python27\lib\site-packages\pymongo-2.3_-py2.7-win-amd64.egg\gridfs\__init__.pyc in     __init__(self, database, collection)
 49         """
 50         if not isinstance(database, Database):
---> 51             raise TypeError("database must be an instance of Database")
 52 
 53         self.__database = database

TypeError: database must be an instance of Database 
```

我是否了解 gridfs**必须***仅* 使用**BLOCKING**数据库？(pymongo)

那么，我是否使用 pymongo 和 mongotor，然后我得到了：

```
from mongotor.database import Database
from pymongo import Connection
import gridfs
db = Database.connect("localhost:27017", "mydb")
dbb = Connection().mydb
fs = gridfs.GridFS(dbb) 
```

那么`dbb`只有在有图片要提供的时候才会使用？它当然会阻止数据库调用？所以如果有人请求图片，那么我的非阻塞呼叫会阻塞吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T17:49:27.970

问题是你混合使用了 pymongo 和 mongotor ...... mongotor 的数据库实现与 pymongo 的数据库实现不同，你不能一起使用它们

MongoTor 还没有对 gridfs 的支持，但是你可以使用 Motor 提供的 gridfs，一个异步驱动程序，比如 mongotor：

[http://emptysquare.net/motor/pymongo/api/motor/examples/gridfs.html](http://emptysquare.net/motor/pymongo/api/motor/examples/gridfs.html)

# apache - 使用 AJP 将 Apache 连接到 Tomcat

> ID：13351408
> 
> 赞同：1
> 
> 时间：2012-11-12T20:55:29.567
> 
> 标签：apache, apache2, tomcat6, tomcat7, ajp

我正在尝试使用 Apache 在 Ubuntu 上启动 localhost 应用程序并将其代理到 Tomcat，以便我可以在我的应用程序中使用 .jsp 页面。似乎这是可能的，我认为我非常接近，但我似乎无法完全正确。任何帮助是极大的赞赏！我以前从未使用过 apache 或 tomcat，所以如果其中任何一个看起来很愚蠢，请不要恨我。

我已经让 Apache 在 localhost 上托管了一个站点，并为主机提供了以下代码：

```
<VirtualHost *:80>
ServerName localhost
ServerAlias test.com

DocumentRoot /var/www/test.com/helloworld
<Directory />
    Options FollowSymLinks
    AllowOverride None
</Directory>
<Directory /var/www/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    allow from all
</Directory>

ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
<Directory "/usr/lib/cgi-bin">
    AllowOverride None
    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
    Order allow,deny
    Allow from all
</Directory>

ErrorLog ${APACHE_LOG_DIR}/error.log

# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
LogLevel warn

CustomLog ${APACHE_LOG_DIR}/access.log combined

Alias /doc/ "/usr/share/doc/"
<Directory "/usr/share/doc/">
    Options Indexes MultiViews FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
    Allow from 127.0.0.0/255.0.0.0 ::1/128
</Directory>

</VirtualHost> 
```

这允许我通过在 URL 中键入 localhost/hello.html 成功导航到我的页面 hello.html。我已经从这一点读到，我需要插入一些代码，例如：

```
ProxyRequests Off
ProxyPreserveHost On

<Proxy *>
  Order deny,allow
  Allow from all
</Proxy>

ProxyPass /(appname) ajp://localhost:8009/(appname)
ProxyPassReverse /(appname) ajp://localhost:8009/(appname) 
```

然后Tomcat应该得到请求。在这种情况下，appname 是什么？我的页面位于`/var/www/test.com/helloworld/hello.html`，所以我认为它会是“helloworld”，但这不起作用。当我将 appname 留空时，我会看到 Tomcat “恭喜，您已成功安装 Tomcat。” 当我导航到本地主机时，但找不到我的页面。

请帮忙。这正在慢慢变成一场噩梦。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:13:40.693

我想到了。这太愚蠢了，但我试图从 /var/www 加载应用程序，而不是将其存放在 tomcat 目录中。/掌脸

我在原始问题中发布的代理代码是虚拟主机中唯一需要的代码。谢谢大家。

# javascript - 剥离 Jquery Cookie 脚本

> ID：13351415
> 
> 赞同：0
> 
> 时间：2012-11-12T20:56:27.337
> 
> 标签：javascript, jquery, cookies

我正在尝试减少我网站上的 javascript 开销，我正在使用这个插件： [https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

这是代码：

```
/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function ($, document, undefined) {

  var pluses = /\+/g;

    function raw(s) {
        return s;
    }

    function decoded(s) {
        return decodeURIComponent(s.replace(pluses, ' '));
    }

    var config = $.cookie = function (key, value, options) {

        // write
        if (value !== undefined) {
            options = $.extend({}, config.defaults, options);

            if (value === null) {
                options.expires = -1;
            }

            if (typeof options.expires === 'number') {
                var days = options.expires, t = options.expires = new Date();
                t.setDate(t.getDate() + days);
            }

            value = config.json ? JSON.stringify(value) : String(value);

            return (document.cookie = [
                encodeURIComponent(key), '=', config.raw ? value : encodeURIComponent(value),
                options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
                options.path    ? '; path=' + options.path : '',
                options.domain  ? '; domain=' + options.domain : '',
                options.secure  ? '; secure' : ''
            ].join(''));
        }

        // read
        var decode = config.raw ? raw : decoded;
        var cookies = document.cookie.split('; ');
        for (var i = 0, l = cookies.length; i < l; i++) {
            var parts = cookies[i].split('=');
            if (decode(parts.shift()) === key) {
                var cookie = decode(parts.join('='));
                return config.json ? JSON.parse(cookie) : cookie;
            }
        }

        return null;
    };

    config.defaults = {};

    $.removeCookie = function (key, options) {
        if ($.cookie(key) !== null) {
            $.cookie(key, null, options);
            return true;
        }
        return false;
    };

})(jQuery, document); 
```

这是我通过删除“写”代码来剥离它的尝试

```
(function ($, document, undefined) {

  var pluses = /\+/g;

function raw(s) {
    return s;
}

function decoded(s) {
    return decodeURIComponent(s.replace(pluses, ' '));
}

var config = $.cookie = function (key, value, options) {

    // read
    var decode = config.raw ? raw : decoded;
    var cookies = document.cookie.split('; ');
    for (var i = 0, l = cookies.length; i < l; i++) {
        var parts = cookies[i].split('=');
        if (decode(parts.shift()) === key) {
            var cookie = decode(parts.join('='));
            return config.json ? JSON.parse(cookie) : cookie;
        }
    }

    return null;
};

config.defaults = {};

$.removeCookie = function (key, options) {
    if ($.cookie(key) !== null) {
        $.cookie(key, null, options);
        return true;
    }
    return false;
};

})(jQuery, document); 
```

如果我只想将它用于读取 cookie，而不是用于删除、写入和读取，我可以去掉更多的死重吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:01:39.257

好吧，使用 jQuery 插件来读取 cookie 有点愚蠢，尽管我用同一个插件做了同样的事情！

[在 JavaScript 中按名称读取 cookie 的最短函数是什么？](https://stackoverflow.com/questions/5639346/shortest-function-for-reading-a-cookie-in-javascript)

有一些你可以使用的更短的代码。

所有这些的核心是 document.cookie——它们只是一个字符串，而不是一个很好的数组，这有点糟糕——但是你去了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:03:38.070

有很多。您可以删除`removeCookie()`初学者。此外，您将看到该`$.cookie()`方法采用`value`和`options`。如果您只阅读 cookie，这些都是不必要的。您还将删除与它们相关的代码。我猜你可以把它归结为这样的事情：

```
/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function ($, document, undefined) {

    var pluses = /\+/g;

    function raw(s) {
        return s;
    }

    function decoded(s) {
        return decodeURIComponent(s.replace(pluses, ' '));
    }

    var config = $.cookie = function (key, value, options) {
        // read
        var decode = config.raw ? raw : decoded;
        var cookies = document.cookie.split('; ');
        for (var i = 0, l = cookies.length; i < l; i++) {
            var parts = cookies[i].split('=');
            if (decode(parts.shift()) === key) {
                var cookie = decode(parts.join('='));
                return config.json ? JSON.parse(cookie) : cookie;
            }
        }

        return null;
    };

    config.defaults = {};

})(jQuery, document); 
```

根据您的用例，您可能能够删除与 、 和 相关的所有代码`config` `decode`，`raw`只需`json`将其设置为默认返回您想要的格式。

# ios - iOS 的打包神秘地失败了

> ID：13351419
> 
> 赞同：0
> 
> 时间：2012-11-12T20:56:41.410
> 
> 标签：ios, trigger.io, forge

我运行此命令以使用 forge 创建一个 .ipa 文件，它起作用了：

```
forge package ios --ios.profile.provisioning_profile name.mobileprovision 
```

其中“名称”是我的配置文件的名称。

该程序立即在我的 iPhone 上崩溃。我尝试使用完全相同的 bash 命令重新打包，但现在出现此错误：

```
[  ERROR] Failed when running /usr/bin/codesign: codesign_allocate: object: /Users/me/Coding/gits/Project/development/ios/device-ios.app/Forge malformed object (unknown load command 43)
/Users/me/Coding/gits/Project/development/ios/device-ios.app: object file format unrecognized, invalid, or unsuitable 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:17:51.223

对于未来 - 我尝试遵循[trigger.io 的建议 - 无法再创建 ipa 文件](https://stackoverflow.com/questions/12679229/trigger-io-cant-create-ipa-file-anymore)以降级到较低版本的 forge。那没有用。

但是完全重新安装 XCode 做到了！所以如果你遇到这个问题，作为最后的手段，你总是可以尝试的！

# sql - SQL 服务器插入触发器

> ID：13351421
> 
> 赞同：1
> 
> 时间：2012-11-12T20:56:51.640
> 
> 标签：sql, sql-server-2008, if-statement, triggers

我是 SQL Server 的新手，我的任务是创建一个触发器，该触发器将在付款逾期时插入/更新客户的状态为“已阻止”。

我如何检查是否在触发器中说出类似以下内容？

```
if getdate() > dateDue
then update status = 'Blocked'
end if 
```

非常感谢您提前提供帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:22:27.070

这是 Martin 建议创建[非持久计算列](http://msdn.microsoft.com/en-us/library/ms191250%28v=sql.105%29.aspx)的实现：

```
ALTER TABLE dbo.YourTable 
ADD Status AS CASE WHEN DueDate < GETDATE() THEN 'Blocked' ELSE 'Not Blocked' END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:17:35.320

我没有时间真正测试这个，所以可能会有一些问题/语法问题，但这里有一些东西应该让你知道如何去做。基本上，只要“dateDue”的值发生更改，您的触发器就会触发。如果更新了多个记录，它应该遍历“插入”值，并且对于“插入”中的每条记录，如果新的“dateDue”值大于当前时间，则更新该记录并将状态设置为'封锁'。

```
CREATE TRIGGER myTriggerName
ON myTable
AFTER INSERT, UPDATE
AS
IF UPDATE(dateDue)
BEGIN
  DECLARE @currPk INT
  DECLARE @currDateDue DATETIME
  DECLARE @today DATETIME
  DECLARE inserted_Cursor CURSOR FOR
  SELECT myTableID, dateDue, GETDATE() FROM Inserted

  OPEN inserted_Cursor;
  FETCH NEXT FROM inserted_Cursor INTO @currPk, @currDateDue, @today
  WHILE @@FETCH_STATUS = 0

    BEGIN
      IF(@currDateDue < @today)
      UPDATE myTable SET status = 'Blocked' WHERE myTableID = @currPk

      FETCH NEXT FROM inserted_Cursor INTO @currPk, @currDateDue, @today
    END;

  CLOSE inserted_Cursor;
  DEALLOCATE inserted_Cursor;
END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:45:06.207

如果您希望在dueDate 变为< 今天时更新此状态，而不是仅在修改记录的dueDate 时更新它，您应该通过SQL Sever Agent 安排一个存储过程并让它运行一个简单的更新来设置状态对于到期日期 < 今天的任何记录。你可以每晚运行一次，或者每小时运行一次，或者任何你需要的。

如果您不想运行代理，您可以使用您为其编写代码的 Windows 服务（设置起来更麻烦），甚至是从 Windows 任务运行的批处理文件，但显然代理是最方便的方法。

# solr - 如何使用 Solr 的 CurrencyField 并避免“缺少必填字段”错误

> ID：13351423
> 
> 赞同：2
> 
> 时间：2012-11-12T20:57:07.850
> 
> 标签：solr

我正在尝试使用 Solr 的 CurrencyField。我正在使用示例 Solr 实例 (apache-solr-4.0.0/example/solr/collection1) 来测试 CurrencyField。我在 schema.xml 中添加了一个字段，如下所示：

```
<field name="money" type="currency" indexed="true" stored="false" required="true" multiValued="false" /> 
```

但是，在发布 XML 文件时：

```
<doc>
    <field name="id">12344321</field>
    <field name="text">4312341</field>
    <field name="money">1.30,USD</field>
</doc> 
```

我收到以下错误：

```
SEVERE: org.apache.solr.common.SolrException: [doc=4312341] missing required field: money 
```

为什么我会收到此错误，我该如何解决？

我正在使用 Solr 4.0.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T03:08:58.140

Paige 是正确的：您收到此错误是因为 CurrencyField 是 PolyField。

以下文档显示了*三个*字段：字段“money”，以及两个特殊的动态字段“__raw_amount”和“__currency”。

```
<doc>
    <field name="money">1.30,USD</field>
</doc> 
```

不存储“金钱”字段的一种解决方法是将其作为动态字段包含在内。

```
<dynamicField name="*_c" type="currency" indexed="true" stored="false" /> 
```

我的猜测是 Solr 会为原始金额和货币动态生成新的存储字段。

也就是说，这个问题非常适合邮件列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:13:59.730

经过大量的试验和错误，我发现了一个解决方案：money字段必须在schema.xml中存储了="true"。

```
<field name="money" type="currency" indexed="true" stored="true" required="true" multiValued="false" /> 
```

我不知道*为什么*会这样。

# python - Python MySQL UTF-8 编码因执行顺序而异

> ID：13351427
> 
> 赞同：3
> 
> 时间：2012-11-12T20:57:28.763
> 
> 标签：python, mysql

我最近继承了一个 python 项目，但我遇到了一些我正在努力解释的行为。

该代码有两个部分，可以将文件导入数据库，也可以将数据库转储到输出文件。导入看起来像这样：

```
def importStuff(self):
    mysqlimport_args = ['mysqlimport', '--host='+self.host, '--user='+self.username, '--password='+self.password, '--fields-terminated-by=|', '--lines-terminated-by=\n', '--replace', '--local', self.database, filename, '-v']
    output = check_output(mysqlimport_args) 
```

转储看起来像这样：

```
def getStuff(self):
    db = MySQLdb.connect(self.host, self.username, self.password, self.database)
    cursor = db.cursor()
    sql = 'SELECT somestuff'
    cursor.execute(sql)
    records = cursor.fetchall()
    cursor.close()
    db.close()
    return records

def toCsv(self, records, csvfile):
    f = open(csvfile, 'wb')
    writer = csv.writer(f, quoting=csv.QUOTE_ALL)
    writer.writerow(['StuffId'])
    count = 1
    for record in records:
        writer.writerow([record[0]])

    f.close() 
```

好吧，这不是你见过的最漂亮的蟒蛇（欢迎发表风格评论，因为我很想了解更多信息），但这似乎是合理的。

但是，我收到一位消费者的投诉，说我的输出不是 UTF-8（顺便说一下，mysql 表使用的是 utf8 编码）。如果程序像这样执行，这就是我迷路的地方：

```
importStuff(...)

getStuff(...)

toCsv(...) 
```

然后输出文件似乎不是有效的 utf-8。当我将执行分为两个不同的步骤时

```
importStuff(...) 
```

然后在另一个文件中

```
getStuff(...)

toCsv(...) 
```

突然我的输出显示为有效的 utf-8。除了我有一个解决办法之外，我似乎无法解释这种行为。谁能阐明我在这里做错了什么？还是我可以提供更多信息来澄清发生了什么？

谢谢。

（python 2.7，以防万一）

编辑：根据要求提供更多代码。我做了一些小的调整来保护像我公司这样的无辜者，但它或多或少在这里：

```
def main():

    dbutil = DbUtil(config.DB_HOST, config.DB_DATABASE, config.DB_USERNAME, config.DB_PASSWORD)
    if(args.import):
        logger.info('Option: --import')

        try:
            dbutil.mysqlimport(AcConfig.DB_FUND_TABLE)
        except Exception, e:
            logger.warn("Error occured at mysqlimport. Error is %s" % (e.message))

    if(args.db2csv):
        try:
            logger.info('Option: --db2csv')
            records = dbutil.getStuff()
            fileutil.toCsv(records, csvfile)
        except Exception, e:
            logger.warn("Error Occured at db2csv. Message:%s" %(e.message))

main() 
```

就是这样。它真的很短，这使得这一点变得不那么明显。

我不确定如何忠实地表示输出，它看起来像这样：

```
"F0NR006F8F" 
```

在我看来，它们都或多或少像 ASCII 字符，所以我不确定它们会造成什么问题。也许我从错误的角度接近这个问题，我目前依靠我的文本编辑器对文件编码的最佳猜测。我不确定如何最好地检测哪个字符导致它停止读取我的文件作为 utf-8。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:23:03.183

有史以来最愚蠢的答案。输入数据不是 UTF-8 格式。有人通过编写另一个存储过程来解决这个问题，该存储过程会定期调用以将非 utf-8 字符转换为 utf-8。在我把我的代码分成两个文件并分别运行它们的时间里，工作运行了。它只是碰巧以这种方式运行，我尝试了 4-5 次，导致我得出错误的结论。我现在正在更改读取过程以适应非 utf-8 输入源，因此我没有隐藏在系统中的奇怪竞争条件。很抱歉带领大家参加这场鹅追逐。

# javascript - 使用 Javascript 对 UL 类子项进行排序

> ID：13351432
> 
> 赞同：2
> 
> 时间：2012-11-12T20:57:48.083
> 
> 标签：javascript, html-lists

我对 JavaScript 很陌生。我已经沿着这条线查看了几个先前回答的问题。我的 HTML 大致是：

```
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.skills{
list-style:none;
padding: 0;
margin-bottom: 200px;
}
.skills li{
width: 200px;
float: left;
padding: 0;
 }
 </style>
 </head>
  <body>
  <h2>Skills</h2>
<ul class="skills">
    <li>a</li>
    <li>b</li>
    <li>c</li>
    <li>d</li>
    <li>e</li>
</ul>
  </body>
  </html> 
```

我曾尝试使用：

```
 <script type="text/javascript">
   function sortLi()
    {
      var skills = [getElementsbyTagName("li")];
      skills.sort();
          var x=document.getElementsByTagName("li");
              x.innerHTML=skills;
     }
  </script> 
```

并通过交换 .getElementsbyTagName 与 .getElementsbyClass("skills") 无济于事。我知道我做错了什么，但就是不能把我的手指放在它身上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:09:38.300

查看此解决方案[（这是 jsfiddle 的链接。）](http://jsfiddle.net/qLRDF/)

```
var mylist = $('.skills');
var listitems = mylist.children('li').get();
listitems.sort(function(a, b) {
    return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase());
})
$.each(listitems, function(idx, itm) {
    mylist.append(itm);
});​ 
```

这使用 jQuery，几乎完全是从另一个[Stackoverflow](https://stackoverflow.com/questions/1134976/how-may-i-sort-a-list-alphabetically-using-jquery)答案中提取的。

基本上你有一些语法错误，你没有调用你的代码，等等。看看我在 jsfiddle 函数上链接到的工作解决方案如何，看看是否有帮助。

# css - Fancybox 画廊的前 2 张图片在不同的高度与画廊的其余部分相关

> ID：13351437
> 
> 赞同：0
> 
> 时间：2012-11-12T20:58:17.297
> 
> 标签：css, fancybox, alignment, inline

我正在我正在开发的网站上实现一个fancybox画廊 - 出于某种原因，尽管前两张图片出现在页面的不同高度：

[http://leedsragfashionshow.co.uk/wp/index.php/committee/](http://leedsragfashionshow.co.uk/wp/index.php/committee/)

我在 Chrome 和 Firefox 上遇到这个问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T03:44:55.687

首先，您的问题的图块具有误导性，因为fancybox 画廊是图像已经显示在fancybox 中而不是之前显示的时候。在您的情况下，问题在于与fancybox 无关的画廊**缩略图。**

无论如何，为什么会发生这种情况？这是因为您在包装图像标签的`<br />`每个链接之后添加了一个 html 换行符，例如：`<a>``<img />`

```
<a rel="group" href="http://leedsragfashionshow.co.uk/wp/wp-content/uploads/2012/committee/1.jpg" class="fancybox"><img alt="" src="http://leedsragfashionshow.co.uk/wp/wp-content/uploads/2012/committee/1.jpg" class="committee"></a><br />
<a rel="group" href="http://leedsragfashionshow.co.uk/wp/wp-content/uploads/2012/committee/2.jpg" class="fancybox"><img alt="" src="http://leedsragfashionshow.co.uk/wp/wp-content/uploads/2012/committee/2.jpg" class="committee"></a><br />
...etc. 
```

如果您已经在浮动图像，那么您只需要删除那些换行符`<br />`。看这个没有标签的**[演示。](http://jsfiddle.net/WqkVx/)**`<br />`

# android - 溢出的 UI 布局

> ID：13351438
> 
> 赞同：2
> 
> 时间：2012-11-12T20:58:22.090
> 
> 标签：android, android-ui

我有一个使用自定义下拉样式界面的应用程序。由于解释起来有些复杂的原因，我不得不使用它而不是内置的 Android Spinner。

我在让下拉选项（橙色）与我正在打开的对话框（绿色）重叠时遇到问题。当下拉菜单未打开时，fill_parent 会使绿色部分过大，并且将其设置得太小会在绿色对话框区域后面留下一个黑色区域，与填充父级时的大小相同。

有没有办法实现这种类型的布局？

![在此处输入图像描述](../Images/f9d05e93c2920a34ea12460d110f2188.png)

相反，它显示如下： ![在此处输入图像描述](../Images/f125a40249b18d3377a812bce2ec1dbd.png)

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rl_root"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">

    <View
        android:id="@+id/vw_background"
        android:layout_width="fill_parent"
        android:layout_height="180dip"
        android:background="#FFFFFF"/>

    <RelativeLayout
        android:id="@+id/rl_stacker"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:padding="10dip">

        <TextView 
            android:id="@+id/tv_question"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/sample_prompt_message"
            android:textColor="#000000"
            android:textSize="18dp"
            android:padding="10dip"/>

        <TextView 
            android:id="@+id/tv_dropdown_closed"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/tv_question"
            android:gravity="center_vertical|left"
            android:text="@string/request_control_dropdown_option_1"
            android:textColor="#000000"
            android:background="@drawable/background_dropdown"
            android:layout_marginLeft="3dip"
            android:layout_marginRight="3dip"
            android:layout_marginTop="0dip"
            android:layout_marginBottom="5dip"
            android:paddingLeft="10dip"/>

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/ll_buttons"
            android:orientation="horizontal"
            android:layout_height="wrap_content"
            android:layout_width="fill_parent"
            android:layout_below="@id/tv_dropdown_closed">

            <trioro.voyeur.ui.GhostButton
                android:id="@+id/gb_yes"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="@string/button_yes"/>

            <trioro.voyeur.ui.GhostButton
                android:id="@+id/gb_no"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="@string/button_no" />

        </LinearLayout>

        <LinearLayout
            android:id="@+id/ll_dropdown_open"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/tv_question"
            android:layout_marginBottom="0dip"
            android:layout_marginLeft="3dip"
            android:layout_marginRight="3dip"
            android:layout_marginTop="0dip"
            android:background="#CCCCCC"
            android:gravity="center"
            android:orientation="vertical"
            android:paddingBottom="1dip"
            android:paddingLeft="1dip"
            android:paddingRight="1dip"
            android:paddingTop="0dip"
            android:visibility="invisible" >

            <TextView
                android:id="@+id/tv_dropdown_option_1"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/request_control_dropdown_option_1"
                android:textColor="#000000"
                android:padding="10dip"
                android:background="#FFFFFF"
                android:layout_marginTop="1dip" />

            <TextView
                android:id="@+id/tv_dropdown_option_2"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/request_control_dropdown_option_2"
                android:textColor="#000000"
                android:padding="10dip"
                android:background="#FFFFFF"
                android:layout_marginTop="1dip" />

            <TextView
                android:id="@+id/tv_dropdown_option_3"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/request_control_dropdown_option_3"
                android:textColor="#000000"
                android:padding="10dip"
                android:background="#FFFFFF"
                android:layout_marginTop="1dip" />

            <TextView
                android:id="@+id/tv_dropdown_option_4"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/request_control_dropdown_option_4"
                android:textColor="#000000"
                android:padding="10dip"
                android:background="#FFFFFF"
                android:layout_marginTop="1dip" />

        </LinearLayout>

    </RelativeLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:24:33.557

尝试使用`LayoutParams.TYPE_APPLICATION_PANEL`您的弹出列表窗口。抱歉，如果没有看到实际代码，我无法更具体。

# c# - C# 正则表达式：在过程文件中查找对其他存储过程的所有调用

> ID：13351441
> 
> 赞同：1
> 
> 时间：2012-11-12T20:58:30.787
> 
> 标签：c#, asp.net, regex, comments

我正在尝试查找存储过程文件中调用的存储过程的所有名称。有效的存储过程调用是：

`call my_stored_procedure(param1, param2)`

我的策略 [基于我有限的正则表达式知识] 是寻找类似于以下内容的独特事件：调用 my_stored_procedure(

例外情况是在“调用”之前在行首有双破折号“--”注释的那些。

我的想法是，一旦我得到上面的字符串，我可以通过使用“call”和“(”作为我在一些后期处理中所做的分隔符来找到实际的存储过程名称。

在存储过程文件中，此调用可能有多种变体。每个完整单词之间可以有多个空格和/或制表符。

```
call     my_stored_procedure(param1, param2)
        call     my_stored_procedure(param1, param2)
call my_stored_procedure  (param1, param2)
call my_stored_procedure  (
 param1, param2)
call my_stored_procedure  ( param1, param2 )
-- call my_stored_procedure  (param1, param2)
--call my_stored_procedure  (param1, param2)
--call my_stored_procedure
-- jsmith call my_stored_procedure  (param1, param2) 
```

我正在使用 ASP.Net Regex 引擎，到目前为止，这就是我所拥有的：

`Regex rgxFindStoredProcedures = new Regex(@"(?<!.*--? *)(call|CALL)\s*([A-Za-z0-9-_\.]+)(\s*)\(", RegexOptions.Multiline | RegexOptions.IgnoreCase);`

上面的正则表达式似乎有效，我找到了所有匹配项并排除了前 3 个已注释掉的调用。但是，它包括最后评论的电话：

```
-- jsmith call my_stored_procedure  (param1, param2) 
```

有没有人知道如何过滤掉最后一个注释掉的电话？我的想法是在里面设置一个条件

```
(?<!.*--? * some_condition_here) 
```

如果 -- 不等于“call”之后有单词，它会丢弃匹配，但我不太清楚如何为这种情况构建正则表达式。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:34:27.420

只需使用[start-of-line anchor`^`](http://msdn.microsoft.com/en-us/library/h5181w5w.aspx)。还，

*   `call`当`CALL`您已经指定`IgnoreCase`.
*   假设`call`必须是一行中的第一个标记，您可以跳过后视
*   您不需要转义句点，因为它已经在字符类中
*   您可以为与 proc 名称匹配的部分命名，并使用 Match.Groups 属性获取它

```
string pattern = @"^\s*call\s*(?<ProcName>[A-Za-z0-9_.]+)(\s*)\(";
var rx = new Regex(pattern, RegexOptions.Multiline | RegexOptions.IgnoreCase);
foreach(var m in rx.Matches(yourInput))
    Console.WriteLine(m.Groups["ProcName"].Value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:34:48.820

这是一个应该做你想做的事情的正则表达式。

```
^(?<!--.*?)\s*call\s+[A-Za-z0-9-_\.]+\s*\( 
```

它与示例文本中的前五个调用相匹配。

# javascript - javascript 数组条件的简写版本

> ID：13351443
> 
> 赞同：1
> 
> 时间：2012-11-12T20:58:35.973
> 
> 标签：javascript, jquery, arrays, jquery-ui

我的 JavaScript 文件中有 10 个颜色样式数组。我需要检查下拉列表中当前选择的值是否等于我创建的数组名称之一，并在更改后分配数组。

以下是其中的 2 个数组：

```
var red = {
    primary_color: 'red',
    primary_hover_color: 'black',
    menu_color: '#9c9fa3'
}

var yellow = {
    primary_color: '#22c39b',
    primary_hover_color: '#187e65',
    menu_color: '#9c9fa3'
} 
```

然后我也有这个下拉菜单：

```
$('#color_palette').change(function() {
    var palette = $(this).val();

    if (palette = 'red') { palette = red }
    if (palette = 'yellow') { palette = yellow }
    // etc etc
}); 
```

我想知道是否有这个的简写版本，而不是必须检查每个值的 if 条件并使其更加“动态”，而不是硬编码条件中的每个颜色值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:01:45.027

您可以将颜色放在单个对象中

```
var colors = {
red: {
  primary_color: 'red',
  primary_hover_color: 'black',
  menu_color: '#9c9fa3'
},

yellow: {
  primary_color: '#22c39b',
  primary_hover_color: '#187e65',
  menu_color: '#9c9fa3'
}
} 
```

然后将您的支票更改为

```
$('#color_palette').change(function() {
    var palette = colors[$(this).val()];
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:01:17.763

你可以安排你的调色板：

```
var palettes = {
   red: red,
   yellow: yellow
}; 
```

然后像这样访问它们

```
var palette = palettes[palette]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:01:34.313

首先，让我们修复您发布的代码中的问题；

1.  您拥有的不是数组，而是通过对象文字语法声明的对象。
2.  `if (palette = 'red')`设置`palette`为`"red"`; 它没有做任何比较；那是`==`和`===`。你*应该*拥有的是：

    ```
    if (palette === "red") 
    ```

3.  在您的更改处理程序中，您正在覆盖您的变量，该变量`palette`包含用户选择的值以及每个`if`块的内容。

    ```
    $('#color_palette').change(function() {
        var palette = $(this).val(); // <-- set here

        if (palette = 'red') { palette = red  // <--- overwritten here}
        if (palette = 'yellow' /* well, and here, but we fixed that in #2 */) { palette = yellow }
        // etc etc
    }); 
    ```

您应该考虑将所有颜色样式包含在一个母对象中；

```
var styles = {
    red: {
        primary_color: 'red',
        primary_hover_color: 'black',
        menu_color: '#9c9fa3'
    },
    yellow: {
        primary_color: '#22c39b',
        primary_hover_color: '#187e65',
        menu_color: '#9c9fa3'
    }
};​ 
```

那么你可以在你的更改功能中做的很简单：

```
$('#color_palette').change(function() {
    palette = styles[$(this).val()];
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:02:40.833

我会有一个调色板对象：

```
palettes = {
    red: {
        primary_color: 'red',
        /* etc. */
    }, 
    yellow: {
         primary_color: 'yellow',
        /* etc. */
    }
} 
```

然后，您可以轻松选择它：

```
var selectedPalette = palettes[$(this).val()]; 
```

# c++ - C++ 在重载赋值运算符声明中 & 做什么？

> ID：13351447
> 
> 赞同：2
> 
> 时间：2012-11-12T20:58:42.510
> 
> 标签：c++, reference

> **可能重复：**
> [为什么使用“新”会导致内存泄漏？](https://stackoverflow.com/questions/8839943/why-does-the-use-of-new-cause-memory-leaks)

（如果有的话）有什么区别：

```
 Player player=*(new Player()); 
```

和：

```
 Player &player=*(new Player()); 
```

两者（似乎）表现相同，但我肯定错过了什么？！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:00:09.403

不同之处在于第一个创建副本，而第二个创建对由返回的指针指向的对象的引用`new Player()`。

```
Player player=*(new Player()); 
```

`player`使用复制构造函数进行复制初始化。

```
Player &player=*(new Player()); 
```

只是创建一个别名`*(new Player())`，这是有效的，因为`new Player()`它不是临时的。`Player& player = Player()`因此将是非法的。

它们的相同之处在于**它们都很烂**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:01:32.160

`new Player()`是在所谓的堆上创建对象（未命名）的表达式。表达式的结果是指向新创建对象的指针。现在当你做

```
Player player = *(new Player()) 
```

您定义了一个名为 player 的变量，它是新创建的对象的**副本**。此外，您已经失去了对堆对象的所有句柄（访问），并且您永远无法释放它占用的内存。

另一方面，

```
Player &player=*(new Player()); 
```

为新创建的对象创建一个名为 player 的**引用。**因此，您可以访问该对象。特别是，您可以通过以下方式释放内存并销毁该对象

```
delete &player; 
```

# objective-c - timeIntervalSinceDate 在过去？

> ID：13351452
> 
> 赞同：2
> 
> 时间：2012-11-12T20:58:59.540
> 
> 标签：objective-c, ios

我在过去（过去 1 小时）创建了一个 NSDate，看起来设置正确，唯一的事情是我想用它来确定是否发生了事件。因为我设置为过去，所以当我进行检查时，它肯定会认为偶数已经发生，但 timeIntervalSinceDate 似乎只给出了积极的结果？

这是我与 timeIntervalSinceDate 一起使用的代码

```
 NSDate *now = [NSDate date];
  NSTimeInterval secondsSincePlantingInterval = [now timeIntervalSinceDate:plantingDate]; 
```

哪个给出了 68 秒，但应该是 -68 秒，还是不返回负值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:05:07.560

这是完全正常的，记录在案的行为

该[文件](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html)指出：

```
- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate 
```

> **返回值**
> 
> 接收者与另一个日期之间的间隔。如果接收者早于另一个日期，则返回值为负。

由于`plantingDate`是过去，接收者**不**早于它。因此该值为正。

而且 ; 这是简单的英语

```
 [now timeIntervalSinceDate:plantingDate]; 
```

所以，从种植日期到现在的时间间隔是正的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:06:22.960

它确实返回负值，是的。但如果`plantingDate`是过去，那么我希望`secondsSincePlantingInterval`是积极的。

如果你仔细想想，那一行是这样写的：

> *告诉我从*`now`开始的秒数。 *`plantingDate`*

 *就像星期二 2 是从星期一 1 开始的一天，`now`是 +ve 秒之后`plantingDate`。

你要：

```
NSTimeInterval secondsSincePlantingInterval = [plantingDate timeIntervalSinceNow]; 
```*

# c# - 使用 if 语句时，绑定列表在 post 中给出空结果

> ID：13351459
> 
> 赞同：1
> 
> 时间：2012-11-12T20:59:25.490
> 
> 标签：c#, asp.net-mvc-3, razor, if-statement, model-binding

我正在使用带有剃须刀的 C#、MVC 3 使用环绕的 if 语句时，post 中的列表为空。没有if，它工作正常。我需要的是包含文本框中所有值的列表。

```
for (var i = 0; i < Model.Budget.BudgetRader.Count; i++)
    {
        if (Model.Budget.BudgetRader[i].Konto != -1) { 
            <tr>
                <td>@Html.TextBoxFor(x => x.Budget.BudgetRader[i].BudgetBelopp)</td>
            </tr>
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:23:02.320

[Phil Hack](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)描述了它不起作用的原因。

索引集合需要 0 及以上的索引值增加 1 并且不跳过任何索引值。因此，当您使用 if 语句跳过某些行时，绑定不起作用。添加一个特定的索引器 i ，如果您的行需要是唯一的，请添加一个隐藏字段 Id 或类似的。请参阅下面的更新示例。

```
int i = 0;
foreach (var rad in Model.Budget.BudgetRader)
{
    if (rad.Konto != -1)
    {
        <tr>
            <td>@Html.HiddenFor(x => x.Budget.BudgetRader[i].Id)</td>
            <td>@Html.TextBoxFor(x => x.Budget.BudgetRader[i++].BudgetBelopp)</td>
        </tr>
    }
    else
    {
        //...
    }
} 
```

以下堆栈溢出也是很好的信息：[https ://stackoverflow.com/a/8896840/455904](https://stackoverflow.com/a/8896840/455904)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T00:03:16.980

尝试`Index`对每个项目使用显式值。这允许您在集合中拥有非顺序索引：

```
for (var i = 0; i < Model.Budget.BudgetRader.Count; i++)
{
    if (Model.Budget.BudgetRader[i].Konto != -1) { 
        <tr>
            <td>
                <input type="hidden" name="Budget.BudgetRader.Index" value="@i" /> 
                @Html.TextBoxFor(x => x.Budget.BudgetRader[i].BudgetBelopp)
            </td>
        </tr>
    }
} 
```

这是一个类似的答案：[https ://stackoverflow.com/a/8598287/1373170](https://stackoverflow.com/a/8598287/1373170)

我不确定是否`Budget.BudgetRader.Index`是正确的名称，因为它应该与您的收藏名称相同。如果您发布当前的 html 输出，我会在必要时进行更正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T00:21:00.243

尝试做这样的事情：

```
for (var i = 0; i < Model.Budget.BudgetRader.Count; i++)
{
    if (Model.Budget.BudgetRader[i].Konto != -1) { 
        <tr>
            <td>@Html.TextBoxFor(x => x.Budget.BudgetRader[i].BudgetBelopp)</td>
        </tr>
    }
    else
    {
        @Html.HiddenFor(x => x.Budget.BudgetRader[i].BudgetBelopp)
    }
} 
```

# javascript - Node.js 是否应该用于密集处理？

> ID：13351462
> 
> 赞同：9
> 
> 时间：2012-11-12T20:59:35.950
> 
> 标签：javascript, node.js, mongodb, webserver, scalability

假设我正在构建一个 3 层网站，后端有 Mongo DB，浏览器中有一些非常轻量级的 javascript（假设只是对表单进行验证，也许是几个可以触发一些 AJAX 请求的花哨的控件）。

我需要为“中间”层选择一种技术（我们可以将其细分为子层，但该细节不是这里的重点，只是整体技术选择），我想在其中处理一些来自DB，并将其呈现为我推送到浏览器的一些 HTML。一个相当典型的瘦客户端 Web 架构。

我的安全选择是在 Java 中实现这个中间层，使用 Jongo 之类的库与 Mongo DB 对话，也许 Jackson 在他们发出 AJAX 请求时编组/解编 JSON 与我的花哨的控件对话。还有一些用于在服务器上呈现我的 HTML 的 Java 模板框架。

但是，我对将所有这些都扔到窗外并在这个中间层使用 Node.js 的想法很感兴趣，原因如下：

*   我喜欢 javascript（好的部分），假设这个应用程序的业务逻辑比 Java 更具表现力。

*   到处都是javascript。在堆栈上的任何位置工作时，无需在语言之间切换，实际上也无需在 OO 和功能范式之间切换。层之间没有翻译管道，JSON 在任何地方都受到原生支持。

*   我可以在客户端和服务器上重用验证逻辑。

*   如果将来我决定在浏览器中进行 HTML 渲染客户端，我可以用 Backbone 之类的东西重用现有模板，只需极少的重构/重新测试工作。

如果您在这一点上并且喜欢 Node，那么以上所有内容似乎都是显而易见的。所以我应该选择Node对吗？

但是……这就是我失败的地方：众所周知，Node 基于单线程异步 I/O Web 服务器模型。这对我在服务数据请求方面的可扩展性和性能非常有用，但是我的业务逻辑呢？我的模板渲染呢？这些东西不会对单线程上的所有请求造成巨大的瓶颈吗？

我想到了两个明显的解决方案，但它们都不是正确的：

1.  保留“阻塞”业务逻辑，只需使用节点实例集群和负载均衡器，即可真正并行地为请求提供服务。好的，那么为什么 Node 一开始就不是多线程的呢？或者这始终是一个想法，保持简单愚蠢并避免在基本情况下多线程复杂性的可能性，如果需要多核处理能力，让程序员在此之上进行额外的设置工作？

2.  保持单个节点实例，并通过调用在其他一些多线程应用服务器上运行的我的业务逻辑的一些 java 实现来保持它的非阻塞。好的，这个选项完全抵消了我列出的使用 Node 的每个专业人士（实际上它比仅使用 Java 增加了复杂性），除了可能获得对数据库的 CRUD 请求的性能和可伸缩性。

这最终让我想到了我的问题——我是否遗漏了 Node 难题的一些重要部分，我是否完全错误地理解了事实，或者 Node 只是不适合在服务器上处理业务逻辑？换句话说，与其他阻塞 I/O 的实现相比，Node 是否仅对坐在数据库上并以更高效和可扩展的方式服务许多 CRUD 请求有用？而且您必须在下面的某个层甚至客户端执行所有业务逻辑，以保持任何合理水平的性能和可扩展性？

考虑到关于 Node 的所有讨论，我宁愿希望它带来的不仅仅是这个。否则我很想被说服！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T21:37:13.910

在任何给定的系统上，您都有**N** cpus 可用（1-64，或者**N**恰好是）。在任何 CPU 密集型应用程序中，您都会遇到**N** cpus 的吞吐量。没有神奇的方法可以通过添加超过**N**个线程/进程/任何东西来解决这个问题。要么你的代码必须更高效，要么你需要更多的 CPU。更多线程将无济于事。

关于多 CPU 性能的一个鲜为人知的事实是，如果您需要同时运行**N+1 个**CPU 密集型操作，则每个 CPU 的吞吐量会下降很多。CPU 密集型进程在放弃它之前往往会在该 CPU 上挂起很长一段时间，从而使其他任务严重挨饿。在大多数情况下，阻塞 I/O 和伴随的任务切换使现代操作系统的多任务工作和它一样好。如果我们的日常常见任务中有更多受 CPU 限制，我们会发现我们的机器需要比目前更多的 CPU。

Node.js 在效率方面为服务器方带来的好处是对每个线程的彻底使用。理想情况下，您最终会减少任务切换。这不是一个*巨大*的胜利，但是让**N**个线程异步处理**N*C**连接将比在相同数量的 CPU 上运行的**N*C**阻塞线程具有性能优势。但是 CPU 的底线是一样的：如果你有超过**N**的实际 CPU 工作要做，你会感到有些痛苦。

上次我查看 Node.js API 时，有一种方法可以使用一个侦听器和每个 CPU 一个工作线程来启动服务器。如果你能做到这一点，我会倾向于使用 Node.js，前提是满足一些注意事项：

*   Javascript-everywhere 方法为您带来了一些简单性。对于复杂的事情，我会担心异步编程风格会使事情变得更难而不是更容易。
*   Node.js 中的模板处理和其他 CPU 密集型任务并不比您选择的其他语言/平台慢。
*   数据库驱动程序是可靠的。

我可以看到一个缺点：

*   如果一个线程崩溃，您将失去该线程服务的所有连接。

最后，请记住，程序员的时间通常比服务器或带宽更昂贵。

# c# - C# asp.net 应用程序，对 Site.css 的更改似乎不会影响 Site.Master

> ID：13351464
> 
> 赞同：0
> 
> 时间：2012-11-12T20:59:54.483
> 
> 标签：c#, asp.net, css

我刚刚开始了一个 asp.net c# 项目，我试图更改 .title 的文本对齐和 .header 的背景颜色。我将所需的代码添加到样式表中，但表单标题中没有任何变化。我可能在这里遗漏了一些简单的东西，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:03:39.823

样式表通常由浏览器缓存以加快浏览速度。

您可以强制刷新 (SHIFT+F5) 或将值附加到样式表路径以缓存它。

```
style.css?v1 
```

通过`v1`在您希望将更改强制输出到所有浏览器时进行更改，它将替换缓存的版本，因为资源是按 URI 缓存的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:05:32.910

只需尝试停止本地开发服务器并在运行应用程序之前进行清理和构建解决方案。甚至清除您的临时 Internet 文件夹，其中可能包含您的 css 文件的陈旧副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:07:06.087

右键单击标记视图，您应该会看到一个选项，显示在浏览器中查看。这应该重新加载缓存的任何内容。

# ruby-on-rails - 通过多态关联轨道创建对象

> ID：13351467
> 
> 赞同：10
> 
> 时间：2012-11-12T20:59:58.497
> 
> 标签：ruby-on-rails, ruby, polymorphic-associations

我需要（或我认为）在我的模型中实现多态关联，但我有问题。让我们看看我的情况，这是一个简单的问答系统，逻辑如下： - 一个问题可以由 N 个答案来回答。- 答案只能是“文本”异或（一个或另一个，而不是两者）“图片”。

**迁移：**

```
class CreateAnswers < ActiveRecord::Migration
    def change
        create_table :answers do |t|
            t.integer :question_id
            t.references :answerable, :polymorphic => true
            t.timestamps
        end
    end
end

class CreateAnswerTexts < ActiveRecord::Migration
    def change
        create_table :answer_texts do |t|
            t.text :content

            t.timestamps
        end
    end
end

class CreateAnswerPictures < ActiveRecord::Migration
    def change
        create_table :answer_pictures do |t|
            t.string :content

            t.timestamps
        end
    end
end 
```

**型号** * *answer.rb* *

```
class Answer < ActiveRecord::Base
    belongs_to :user_id
    belongs_to :question_id
    belongs_to :answerable, :polymorphic => true

    attr_accessible :answerable_type
end 
```

**answer_text.rb**

```
class AnswerText < ActiveRecord::Base
    TYPE = "text"

    has_one :answer, :as => :answerable

    attr_accessible :content
end 
```

**answer_picture.rb**

```
class AnswerPicture < ActiveRecord::Base
    TYPE = "picture"

    has_one :answer, :as => :answerable

    attr_accessible :content
end 
```

**控制器answers_controller.rb：**

```
...
def create
    post = params[:answer]
    create_answerable(post[:answerable_type], post[:answerable])
    @answer = @answerable.answer.new()
end

private
def create_answerable(type, content)
    @answerable = ('Answer' + type.capitalize).classify.constantize.new(:content => content)
    @answerable.save
end
... 
```

**并查看表单（只有这些字段）：**

```
...
<div class="field">
<%= f.label :answerable_type %><br />
<%= select("answer", "answerable_type", Answer::Types, {:include_blank => true}) %>
</div>
<div class="field">
<%= f.label :answerable %><br />
<%= f.text_field :answerable %>
</div>
... 
```

所以，问题是当我提交表单时出现此错误：

> 未定义的方法`new' for nil:NilClass app/controllers/answers_controller.rb:52:in`创建'

答案？:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-13T11:51:33.690

在一段`has_one`关系中，你必须使用：

```
@answerable.build_answer 
```

或者

```
@answerable.create_answer 
```

代替

```
@answerable.answer.new 
```

有关更多信息，请参阅[参考资料](http://guides.rubyonrails.org/association_basics.html#has_one-association-reference)。

# ubuntu - Ubuntu 未检测到第二个 nVidia GPU

> ID：13351468
> 
> 赞同：4
> 
> 时间：2012-11-12T21:00:07.823
> 
> 标签：ubuntu, cuda, gpu, nvidia

我的系统上安装了 2 个 GPU：一个 GTX660 和一个 8800GTS。两者都在 Windows 8 和 Ubuntu 12.04 32bits 下被检测到并完美运行。

我现在已经在同一系统上安装了 Ubuntu 12.04 64 位，并使用了来自 nVidia 的最新驱动程序（64 位中的 304.64）。在控制台模式（CTR + ALT + F1）下，我可以检测和使用两张卡（例如通过 CUDA 应用程序）。

在 X 模式下（我使用标准 lightdm 服务器），相同的应用程序只检测到 GTX660。从 X 终端运行 lspci 会显示两个 GPU（GTX660 被称为“VGA 兼容控制器”，而 8800GTS 则被明确引用）。

在我看来，它与 X-server 的关系比什么都重要。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T17:23:45.307

问题解决了 - 但我不是 100% 确定为什么。

与此同时，我一直在修改我的 grub 配置（请参阅[此处](http://ubuntuforums.org/showthread.php?t=1613132)），方法是`nomodeset`在该行中添加属性`GRUB_CMDLINE_DEFAULT`，因为我无法访问控制台。

从那以后，问题似乎得到了解决，即我现在即使在 X 下也可以看到我的两个 GPU。

正在返回设备和`ls -l /dev/nvidia*`控制器。

无论如何感谢您的快速帮助！

# image - 局部直方图 - 重新计算图像所有部分的直方图 - Matlab

> ID：13351473
> 
> 赞同：1
> 
> 时间：2012-11-12T21:00:22.050
> 
> 标签：image, matlab, image-processing

我已经有了这个：
`function [h] = histImage (img)
nPix = numel(img);
h = accumarray( img (:)+1 , ones(nPix,1)/nPix, [256 1] , @sum,0)` 

 `this function will return a grayscale histogram for a given img into a 1X256 vector

now i want to build this function: input: img - grayscale image matrix in rage [0..255] windowSize - a 1x2 array [r c] rows and cols.
output: histArray 3d matrix for every i,j the 1D array histArray(i,j,:) is the histogram of img of the size WindowSize whose top left corner is (i,j)` 

```
function [histArray] = localHistograms (img,windowSize)
histArray = zeros(windowSize(1),WindowSize(2),256);
for i = 1:windowSize(1)
    for j = 1:windowSize(2)
        histArray(i,j,:) = histImage(img( i:windowSize(1), j:windowSize(2) ))
    end
end
end 
```

这是我到目前为止所拥有的，你能告诉我我的错误吗？我如何检查我的错误？只需输入一些随机图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:00:41.503

好的，所以我的朋友帮我找出我的错误是工作和测试的代码：

```
function [ histArray  ] = localHistograms ( img,windowSize )
% Given an image returns a 3D array of histograms – 
% one histogram per window in image.
% Input:
%   img - a grayscale image in the range [0..255]
%   windowSize – a 1x2 array [r c]  defining the num rows and num cols 
%                of image windows.      
% Output:
%   histArray – an NxMx256 array.
%
% For every (i,j) the 1D array histArray(i,j,:) is the histogram
% of an image window of size windowSize whose top left corner 
% pixel is (i,j). Histograms of windows that exceed the boundary 
% of the of img are not included in histArray (thus N = number of 
% rows of img less the number of rows of window +1\. 
% Similarly  M=size(img,2)-windowSize(2)+1 ).
%
% Method:   Scans the img pixel by pixel. For each scanned pixel,
% determines the histogram of the image window starting at the 
% pixel and extending  windowSize(1) rows and windowSize(2).

N = size(img,1) - windowSize(1) + 1;
M = size(img,2) - windowSize(2) + 1;
histArray = zeros(N ,M,256);

for i = 1:N
 for j = 1:M
   histArray(i,j,:) = histImage(img(i:i+windowSize(1)-1,j:j+windowSize(2)-1));
 end
end

end 
```

# c++ - C++ - 模板类中模板函数的单独声明/定义

> ID：13351474
> 
> 赞同：16
> 
> 时间：2012-11-12T21:00:21.477
> 
> 标签：c++, oop, templates, methods, implementation

我知道在标头中声明模板类方法并在源文件中定义它的语法如下：

我的班级.h

```
template <typename T>
class MyClass {
  public:
    void method(T input);
  private:
    T privVar;
}; 
```

我的类.cpp

```
template <typename T>
void MyClass<T>::method(T input) {
    privVar = input;
} 
```

但是，如果该方法也是一个模板呢？我正在向`basic_string`类中添加方法，我想知道如何编写函数的实现。

我的字符串.h

```
template <class _Elem   = TCHAR,
          class _Traits = std::char_traits<_Elem>,
          class _Ax     = std::allocator<_Elem>>
class String
    : public std::basic_string<_Elem, _Traits, _Ax> {
  private:
    // Types for the conversion operators.
    typedef       _Elem* _StrTy;
    typedef const _Elem* _ConstStrTy;

    //...

  public:
        // Conversion operators so 'String' can easily be
        // assigned to a C-String without calling 'c_str()'.
    operator _StrTy() const {
        return const_cast<_StrTy>(this->c_str());
    }

    operator _ConstStrTy() const {
        return this->c_str();
    }

    // ... Constructors ...

    /*------------ Additional Methods ------------*/

    //! Converts a value of the given type to a string.
    template <class _ValTy> static String ConvertFrom(_ValTy val);

    //! Converts a string to the given type.
    template <class _ValTy> static _ValTy ConvertTo(const String& str);
    template <class _ValTy> _ValTy ConvertTo(void) const;

    //! Checks if a string is empty or is whitespace.
    static bool IsNullOrSpace(const String& str);
    bool IsNullOrSpace(void) const;

    //! Converts a string to all upper-case.
    static String ToUpper(String str);
    void ToUpper(void);

    // ...
}; 
```

我该如何实施`template <class _ValTy> static String ConvertFrom(_ValTy val);`？因为现在我不仅需要指定类模板，还需要指定函数模板。我打赌我要写的代码是无效的，但它应该显示我想要完成的事情：

我的字符串.cpp

```
template <class _Elem, class _Traits, class _Ax>
template <class _ValTy>
String<_Elem, _Traits, _Ax> String<_Elem, _Traits, _Ax>::ConvertFrom(_ValTy val) {
    // Convert value to String and return it...
} 
```

我对模板一点也不先进。我不仅非常怀疑上述内容是否有效，而且看起来写起来很麻烦，而且可读性也不是很好。我将如何实现模板方法以及返回自己的类类型的静态模板方法？因为我不想在标题中定义它们。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-12T21:34:58.820

模板外的模板成员函数定义语法如下：

```
template <class T> struct A
{
   template <class X> void f();
};

template<class T> template<class X> void A<T>::f()
{
} 
```

所以你的代码是正确的。

需要注意的是，在其中定义模板成员`.cpp`并不是很有用。在这种情况下，您应使用此模板需要使用的所有类型显式实例化它们。或者不要在没有意义的范围之外使用它们`.cpp`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-12T21:19:47.840

在我回答你的问题之前，让我先说：不要这样做。通过使用自由函数来扩展`std::string`，就像标准库实现了许多算法一样。另外，我建议为范围而不是`string`仅针对 s 执行此操作，但这更主观。

另请注意，`std::string`避免隐式转换为 C 字符串不是为了让您的生活更艰难，而是为了保护您的代码免受各种可能由意外隐式转换引起的晦涩错误的影响。对于实施它们，我会考虑很长时间。想一想：`.c_str()`当你写代码的时候，你需要花一些额外的时间来输入一次，在剩下的时间里，任何阅读你的代码的人都会立即知道它被用作 C 风格的字符串，而不是`std::string`.

要回答您的问题，只需将代码放在标题中：

```
//! Converts a value of the given type to a string.
template <class _ValTy> static String ConvertFrom(_ValTy val)
{
    // Code here
} 
```

最后请注意，以下划线+大写字母开头的标识符（以及许多其他以 开头的东西`_`）是为编译器保留的，因此所有关于您的程序功能的赌注都没有。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:20:41.160

您的函数定义是有效的，并且不能在类声明之外以不那么冗长的方式定义。由于您想将函数定义放在 .cpp 文件中，因此您无法利用将函数定义与更简洁的函数声明相结合的优势。通过将函数定义放在 .cpp 文件中，您还必须显式实例化模板类的所有需要​​的特化。

# java - JDeveloper 内存不足错误

> ID：13351476
> 
> 赞同：0
> 
> 时间：2012-11-12T21:00:32.627
> 
> 标签：java, configuration, config, jdeveloper

我正在为我的应用程序使用 JDeveloper。直到昨天它工作正常。我更新了我的 CVS，当我尝试构建时，我收到以下错误：

```
The system is out of resources.
    [javac] Consult the following stack trace for details.
    [javac] java.lang.OutOfMemoryError: Java heap space 
```

我将conf文件更改为`AddVMOption -Xmx512M`但仍然看到相同的问题。从 128-512 更改它并看到同样的问题。我还需要改变什么？

# javascript - Json Parse - Uncaught SyntaxError: Unexpected token T

> ID：13351478
> 
> 赞同：4
> 
> 时间：2012-11-12T21:00:38.290
> 
> 标签：javascript, jquery, json

> **可能重复：**
> [JSON Javascript 转义](https://stackoverflow.com/questions/13180462/json-javascript-escape)

我在 jsonlint 上测试了我的 JSON，它是有效的，但是当我尝试解析它时出现错误，

这是我的 JSON 和要解析的函数：

```
var listVideo = JSON.parse('[{"blobkey":"AMIfv94kAyQziQMwOLOrjqBK-MxqQqeBK96dS4Fh5DgR-yIW4jHq3luUwNvGpTOfUD9qXlFNQUjYXGkYrmmV8_mrZKbiK6MAUJwuSQkhxw-qaQZLVHcpb19gWUEpxiAzh1z4fMyBBBb4","id":41,"linkId":"","price":500,"description":"This building video showcases a luxury building located in the Financial District. It includes shots of the building exterior, lobby, and outdoor areas. A sample apartment is also showcased.","name":"Apartment Building","reel":false,"type":0,"approximateTime":3},{"blobkey":"AMIfv95JWHFzuK0BYadlQM61VQyOuGE5rT-buMuFLmXk7Dj4GFE_AAtniI4nuL5kD94O6K7zor6RvPcnsCKcTbx4KM8oN0apq0BHS5rTlUs4-Xww9MvdVvvANGOVovyrzlAswcI6vFZ6","id":42,"linkId":"","price":0,"description":"My reel showcases snippets from past video projects. It should communicate my personal aesthetic when shooting and editing. ","name":"My Reel","reel":true,"type":0,"approximateTime":0},{"blobkey":"AMIfv97pnf1y8Aek4RCX8c2uaAsLVc91o00JoP5l2Fk7XiWKCxCVBCAxPmMjjV5aUfgmAI2tadxyCfns6FIcQR12Lv-JaTdyJjIYYIUVyWy8iI3eBtKkJ9cxikXaPsprYGt642-U379A","id":43,"linkId":"","price":700,"description":"The Bean is a neighborhood coffee shop located in the East Village. In addition to capturing the physical space, this video contains commentary from regular customers.","name":"Coffee Shop Video","reel":false,"type":0,"approximateTime":3},{"blobkey":"AMIfv96EUXtcTd166Lg0MqeL7UA6zWYGA7AVkw1ltGf088xwkjWXDvhaG3M6rBsf6Jwz6MGTCQkhDJiVRSc-EyMIebt0SVzR9eXNI879sTATNQPvXsp0c3xL4yRJ6WQ2MfT90XMwm8pC","id":44,"linkId":"","price":1500,"description":"This video is a client testimonial for Yesware, an email marketing software company. It contains comments from three Yesware customers. ","name":"Client Testimonial","reel":false,"type":0,"approximateTime":14},{"blobkey":"AMIfv97QwJlN6K3GebdJQASXRRKcrxOjHnZcEocZ_Urab5539_jc6AeuGqDrj6jCv4RVIJcyNeb0b3-5odxGjlLqU76yPPGq8P6Au3AS30arXsy3PWKhniX6y4p4CLAIPv7XJdA0_mxM","id":45,"linkId":"","price":500,"description":"Bond New York, a Manhattan real estate agency, hosts an art event each month. This video recap includes testimonials by attendees as well as b-roll. ","name":"Event Sample","reel":false,"type":0,"approximateTime":4},{"blobkey":"AMIfv96_narMmT6tdnhD5KkVJ_oJ0wZpqGGTvM15xc9tpFlHLTd6vjLLfLw0Ak5awfc5Lge9_zK0W5w1tHktmc8mftQdbPIgXlyPKE02y1X4lGF0bkRtRhX6h7834R0yLnsEluIDwvgu","id":46,"linkId":"","price":1000,"description":"A roundtable discussion with StreetEasy correspondent, Sofia, and John Gomes/Fredrik Eklund of Prudential Douglas Elliman. The pair are established agents in the luxury market -- and you may recognize Fredrik from the Bravo TV series Million Dollar Listing. Watch the video for an animated discussion of contract activity and median prices.","name":"StreetEasy Roundtable Discussion","reel":false,"type":0,"approximateTime":4},{"blobkey":"AMIfv95HNN_nA11jaNdleFkrLfIVlMJvEvLu8kRrUaybhG1VKAj6f2SUZBvdCX7PN_xuScXzpVFE8ci77pJtcXh-D9qoEjgkJ9sK6MAu9M8mgxPg5p43UXcJ1VoyPE23YnOfmWvyCE03","id":47,"linkId":"","price":500,"description":"Client testimonial shot for Clevertech, a software development company. The subject is Amy Epstein, the managing director at ABI, a public relations firm.","name":"Client Testimonial ","reel":false,"type":0,"approximateTime":3},{"blobkey":"AMIfv95tEXCSJtLP1w_MWnmx21L2OlxQGap4PXIc7aqZbbnm0ZMOwiNSbECrXx2nuscDrZyd4Joq6eiRUFBZxKACpCVGQVvLpLfjyVGRHvTUFOYtk9ZnFTzM_GVukKDX3-0dESm5JJMl","id":48,"linkId":"","price":400,"description":"The Bean, a coffee shop located in the East Village, offers a frozen coffee beverage called the Frozen Mona Lisa. This video shows an employee making one from start to finish.","name":"Product Video: Frozen Mona Lisa","reel":false,"type":0,"approximateTime":2},{"blobkey":"AMIfv97s4c7JQtKM147oJzHZFNtFqIBhZARUCxZdrui7xI1RXUfolrRchfRhzCERdcgVtid5_-dE75jnKBHHh3CtBSRDFnnhlQjMpHRVkAhA5kVH0ExezSkrdi0GoPClfHLvaGrFo8gW","id":49,"linkId":"","price":300,"description":"An apartment video shot for East Village Apartments. It includes shots of the building exterior as well as a comprehensive look in the interior: bedroom, bathroom, living room, kitchen etc\u2026","name":"Apartment Video","reel":false,"type":0,"approximateTime":3},{"blobkey":"AMIfv94YHo2Xx_3LVYhvngnm_cSEoLu-8btAgCl57YYrcqHtMbrdAFvdzq9D5fE525xkK5tv0E_e_7zqNU8r_e_DMnFcA_iRBKLdKuHKpp74t8fJrTatTBlLFKPjIGcDcmjiIVx4cpy5","id":53,"linkId":"","price":1000,"description":"","name":"Coffee Shop Overview: The Bean","reel":false,"type":0,"approximateTime":5},{"id":59,"linkId":"SAAIFzlgOhQ","price":0,"description":"dzdzdzdzdzdzdz","name":"zdzddzdzdzdz","reel":false,"type":1,"approximateTime":0},{"id":60,"linkId":"dGghkjpNCQ8","price":2,"description":"effefe","name":"effefe","reel":false,"type":1,"approximateTime":2},{"id":63,"linkId":"1q-ZqbK2g3Y","price":400,"description":"Created for \"The Young Republican\" campaign. Commissioned by the republican activist Geoff Harbough.","name":"3D Motion graphics sample","reel":false,"type":1,"approximateTime":2},{"id":64,"linkId":"kiGkV1_1V3U","price":450,"description":"This unofficial video was edited and presented to the artist Nadia Kay as a one of the broadcast versions. Copyright of Silver Curve Records.","name":"Music video edit sample","reel":false,"type":1,"approximateTime":5}]'); 
```

我收到此错误：“未捕获的语法错误：意外的令牌 T”

JSFiddle：http: [//jsfiddle.net/C4jh5/](http://jsfiddle.net/C4jh5/)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-12T21:05:26.730

您应该正确转义引号：

```
... ,"description":"Created for \\"The Young Republican\\" campaign. Commissioned by the republican activist Geoff Harbough.", ... 
```

**演示：http:** [//jsfiddle.net/C4jh5/1/](http://jsfiddle.net/C4jh5/1/)

# mysql - MySQL 选择变量

> ID：13351479
> 
> 赞同：3
> 
> 时间：2012-11-12T21:00:39.913
> 
> 标签：mysql, execute, prepare

我想在过程中进一步使用从选择中获得的值到执行中，但不知道如何去做。

作为测试，我编写了以下内容，但不能使用 v_1、v_2 或 v_3 变量进行进一步的逻辑，因为它们没有像我预期的那样采用值 1,2 和 3...

```
DROP PROCEDURE IF EXISTS MPT_testing; DELIMITER //  CREATE PROCEDURE MPT_testing() READS SQL DATA BEGIN

  DECLARE v_1 INT;   DECLARE v_2 INT;   DECLARE v_3 INT;
     SET @sql=CONCAT('SELECT 1,2 into v_1, v_2');   PREPARE s1 FROM @sql;   EXECUTE s1;   DEALLOCATE PREPARE s1;

  SET v_3 = v_1 + v_2;

  SELECT v_3;

END //

DELIMITER ; 
```

有人可以帮忙吗？

谢谢，狮子座

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:16:37.133

尝试将 'SELECT 1,2 into v_1, v_2' 更改为

```
'SELECT @v_1:=1, @v_2:=2' 
```

或者至少确保在引用你的变量时使用@。有关更多信息，请参阅此线程： [MySQL DECLARE 中的 SELECT INTO 变量导致语法错误？](https://stackoverflow.com/questions/3075147/select-into-variable-in-mysql-declare-causes-syntax-error)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:41:31.250

如果您不需要过程中的动态 SQL，则可以使用更简单的语法：

```
DECLARE v_1 INT;   DECLARE v_2 INT;   DECLARE v_3 INT;

SELECT 1,2 into v_1, v_2;
SET v_3 = v_1 + v_2;
SELECT v_3; 
```

使用在存储过程中声明的普通变量比用户定义变量 (@-variables) 更安全，因为调用另一个存储过程可能会更改您的用户定义变量值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-30T04:43:49.127

您需要修改少量代码才能正常工作，请参阅我的修改

```
DECLARE v_1 INT;
DECLARE v_2 INT;
DECLARE v_3 INT;

SET @sql=CONCAT('SELECT 1,2 into @v1, @v2');
PREPARE s1 FROM @sql;
EXECUTE s1;

SELECT @v1, @v2 INTO v_1, v_2;
SET v_3 = v_1 + v_2;
SELECT v_3;

DEALLOCATE PREPARE s1; 
```

# c# - 首先删除或更新实体框架代码中的多个实体或直接访问数据库

> ID：13351480
> 
> 赞同：0
> 
> 时间：2012-11-12T21:00:42.207
> 
> 标签：c#, entity-framework, ef-code-first

我想允许用户通过在**列表**中选择它们并按下**删除/确认**按钮来**删除**或**确认多条记录。**

 ****我已经搜索过，似乎`EF`不支持**批量**更新/删除，那么以下方法之间有什么区别 - 直接操作数据库是否有任何负面影响。

1-使用`ExecuteSqlCommand`方法直接运行查询`database`。

2-或`entities`使用选定的 ID 创建，将其设置`state`为**已修改/删除**，然后调用`context.SaveChanges()`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:05:15.873

我会选择第二种选择——你有一个涵盖所有更新的事务，这可能是一件好事。（在某些情况下不是）

这也是执行此操作的最简单/最快的方法。

如果您将遇到性能问题，请继续优化它 - 更改为 SQL 或将 ORM 更改为 NHibernate 或做任何您想做的事情。

此外 - 有一条规则说先写，然后优化。不是反过来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:10:34.283

关于选项1的想法：

1.  您打算如何识别应该删除的记录？
2.  如果您有一个 id 数组，您是否打算迭代 sql 命令 n 次？

关于选项2的想法：

1.  如果您选择实体并需要修改它们，您最终将加载内存中的所有实体。
2.  由于上下文知道实体类型并提供删除方法，因此您可以在延迟执行时调用删除方法。****

# ruby-on-rails - RVMSUDO - 不响应命令，挂起

> ID：13351482
> 
> 赞同：0
> 
> 时间：2012-11-12T21:00:52.607
> 
> 标签：ruby-on-rails, rvm

我刚刚安装了一个全新的 rackspace Ubuntu 12.04 LTS VPS 服务器。

我在这里遵循指南： [https ://www.digitalocean.com/community/articles/how-to-install-rails-and-nginx-with-passenger-on-ubuntu](https://www.digitalocean.com/community/articles/how-to-install-rails-and-nginx-with-passenger-on-ubuntu)

一切都很顺利，直到我进入：

```
rvmsudo passenger-install-nginx-module 
```

我的终端挂起，没有任何反应，除非我 cntrl-C。

一些信息：

```
rvm 1.16.20 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-linux]

rvm rubies

=* ruby-1.9.3-p327 [ x86_64 ]

# => - current
# =* - current && default
#  * - default 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T07:29:38.580

在这里修复：[https ://github.com/wayneeseguin/rvm/issues/1312](https://github.com/wayneeseguin/rvm/issues/1312)

再次更新 RVM：

```
rvm get head 
```

# django - 如何使用开始时间和结束时间在行之间建立缓冲区？

> ID：13351485
> 
> 赞同：0
> 
> 时间：2012-11-12T21:01:08.383
> 
> 标签：django, django-templates, django-views

我正在尝试将空闲空间打印为表格中每一行之间的缓冲区。有没有办法让我在 django 模板中做到这一点？这是我拥有的当前代码。

```
 <table id="upcomingtable" border="1" style="border-collapse:collapse;">
                <tr>
                    <th>Course</th>
                    <th>Title</th>
                    <th>Professor</th>
                    <th>Start</th>
                    <th>End</th>
                </tr>
            {% for next in upcoming %}
                <tr> 
                    <td>{{ next.course }}</td>
                    <td>{{ next.title }}</td>
                    <td>{{ next.prof }}</td>
                    <td>{{ next.stime }}</td>
                    <td>{{ next.etime }}</td>
                </tr>
                <tr><td></tr> <!--Buffer here-->
            {% endfor %}
            </table> 
```

这是我当前即将进行的查询：

```
upcoming = Class.objects.filter(building__exact=b, floor__exact=f, room__exact=r, days__icontains=dayletter(day), etime__gt=datetime.datetime.now().time()).distinct().order_by('stime') 
```

基本上我想获取结束时间（etime）并找到它与下一个开始时间之间的差异，下一个开始时间与下一个开始时间迭代，并在这些行之间建立一个缓冲区。例如，现在的结束时间是下午 3:00，下一个开始时间是下午 3:15 我想在打印出实际行之前制作一个行缓冲区。

```
Ex.
    3:00    info info info
    blank
    blank
    blank
    3:15    info info info 
```

在views.py中循环

```
 for i, item in enumerate(range(len(upcoming)-1)):
    s1 = upcoming[i].etime
    s2 = upcoming[i+1].stime

    d2 = s2.hour*60 + s2.minute
    d1 = s1.hour*60 + s1.minute 

    d = d2 - d1

    if (d>0):
        upcoming[i].span = d/5 
```

谢谢大家，我感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:47:14.063

如果我理解正确，空白行的数量取决于记录之间的时间差，对吧？如果是这样，你可以尝试这样的事情：

```
upcoming = list(upcoming)
for i, item in enumerate(upcoming[:-1]):
    item.span = range(1, upcoming[i+1].sdate - item.edate)   #actually, get the time difference in minutes and divide by some coefficient - how many minutes should pass for the new blank row to be inserted 
```

然后在模板中：

```
{% for row in next.span %}
    <tr><td colspan="5">&nbsp;</td></tr>
{% endfor %} 
```

# big-o - 为内存找到大 o 符号是什么意思

> ID：13351490
> 
> 赞同：12
> 
> 时间：2012-11-12T21:01:20.503
> 
> 标签：big-o

我有一个问题，找到算法所需的内存的大o顺序是什么意思？

就像那和big o操作有什么区别？

例如

一个问题问给定以下伪代码，具有初始化的二维数组 A，两个维度的大小为 n：

```
for  i <- 1  to  n  do
       for  j <- 1  to  n-i  do
                        A[i][j]=  i + j 
```

内存的大 o 符号不只是 n^2 并且计算也是 n^2 吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-12T21:11:03.920

Big-Oh 是关于某事物如何根据其他*事物增长（技术上是某事物如何增长的限制）。*最常见的介绍性用法是*算法*根据输入的大小运行的 *速度。*

没有什么可以说您不能*根据*输入的大小使用多少内存。

在您的示例中，由于数组中有一个存储桶用于存储`i`和中的所有内容`j`，因此空间需求增长为`O(i*j)`，即`O(n^2)`

但是，如果您的算法是跟踪最大和，而不是每个数组中每个数字的总和，则运行时复杂度仍然是`O(n^2)`，而空间复杂度将保持不变，因为算法只需要跟踪当前 i 、电流 j、电流最大值和正在测试的最大值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:10:16.423

Big-O 内存顺序意味着执行算法所需的字节数如何随着处理的元素数量的增加而变化。在您的示例中，我认为 Big-O 顺序是 n 平方，因为数据存储在大小为 nxn 的方形数组中。

运算的大 O 顺序意味着执行算法所需的计算数量如何随着处理的元素数量的增加而变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:11:33.900

是的，您是正确的，上述伪代码的空间和时间复杂度为 n^2。

但是对于下面的代码，空间或内存复杂度为 1，但时间复杂度为 n^2。我通常会在代码中完成分配等，这会给您带来内存复杂性。

对于 i <- 1 到 n 做

```
 for  j <- 1  to  n-i  do

                    A[0][0]=  i + j 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T21:11:00.877

老实说，我从来没有听说过“内存大 O”，但我可以很容易地猜到它与计算时间的关系很松散——可能只是设置了一个下限。

例如，很容易设计一个使用 n^2 内存和 n^3 计算的算法，但我认为反过来是不可能的 - 你不能在计算上处理具有 n 复杂度的 n^2 数据。

您的算法复杂度为 1/2 * n^ 2，因此 O(n^2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-12T19:23:23.757

如果`A`给你的算法，那么空间复杂度是 O(1)。迭代现有的 2D 数组并将值写入现有内存位置不会使用额外的内存。

但是，如果算法*分配* `A`，则空间复杂度为 O(n ² )。

无论哪种方式，时间复杂度都是 O(n ² )。

# python - 在 Python 中获取 XML 节点的路径

> ID：13351494
> 
> 赞同：4
> 
> 时间：2012-11-12T21:01:25.733
> 
> 标签：python, xml

我经常处理非常复杂的文档，我实际上是在进行逆向工程。我需要编写代码来修改某些节点的值，并将遍历的路径作为条件到达节点。

在检查 XML 数据以了解其结构时，在此路径上进行表示会非常有用。然后我可以使用代码中的路径到达该特定节点。

例如，我可以从下面的文档中获取表示 Catalog > Book > Textbook > Author。

Python中是否有任何库允许我这样做？

```
<xml>
    <Catalog>
        <Book>
            <Textbook>
                <Author ="James" />
            </Textbook>
        </Book>
        <Journal>
            <Science>
                <Author ="James" />
            </Science>
        </Journal>
    </Catalog>
</xml> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T21:47:16.717

[lxml](http://lxml.de/)库有一个[etree.Element.getpath](http://lxml.de/xpathxslt.html#xpath)方法（`Generating XPath expressions`在上一个链接中搜索）*“它返回一个结构化的、绝对的 XPath 表达式来查找该元素”*。[这是来自lxml](http://lxml.de/)库文档的示例：

```
>>> a  = etree.Element("a")
>>> b  = etree.SubElement(a, "b")
>>> c  = etree.SubElement(a, "c")
>>> d1 = etree.SubElement(c, "d")
>>> d2 = etree.SubElement(c, "d")

>>> tree = etree.ElementTree(c)
>>> print(tree.getpath(d2))
/c/d[2]
>>> tree.xpath(tree.getpath(d2)) == [d2]
True 
```

# backbone.js - ASP.net Web API：使用数据注释检索模型时包括验证规则

> ID：13351504
> 
> 赞同：2
> 
> 时间：2012-11-12T21:01:45.250
> 
> 标签：backbone.js, asp.net-web-api, data-annotations

我目前正在构建一个 Backbone.js/ASP.net MVC/Web API 应用程序，一切都很顺利:)

当向服务器发送数据时，我知道我可以使用 ModelState 和 ValidationFilter 在那里进行验证。但是，当从服务器检索模型时，我想包含来自数据注释的任何验证规则，以便我可以将它们连接到 JQuery Validate 或我决定的任何内容中。在 ASP.net SPA 中，您可以从 javascript 调用 dataSource.getEntityValidationRules() 来做到这一点。

我想知道是否有办法在我从 Web API 获得带有数据注释的模型而不使用 ASP.net SPA 及其 javascript 库时包含这些规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:41:23.443

主干模型的好处是它们是动态的，因此您可以创建一个解析器来读取来自服务器的验证，并以您的插件需要的方式将这些验证添加到主干模型，如果您只使用它就很容易： required、minlength、max length 和一个正则表达式，但使用范围或其他类型的验证会变得更难。正如我所说，插件这些验证需要一些工作来构建这个解析器，因为我认为没有插件或库。

# java - 拆分用户模式匹配器

> ID：13351506
> 
> 赞同：0
> 
> 时间：2012-11-12T21:01:53.173
> 
> 标签：java, string, pattern-matching

我在日志中有一些条目，我想使用模式匹配器将条目从日志中取出。

日志条目

```
1223-12-23 00:00:00 exception : 1223\. Operation Cannot be done
1223-12-24 00:00:01 exception : 1221\. Operation Cannot be done 
```

我想获得类似的条目

String [] date = {1223-12-23 00:00:00, 1223-12-24 00:00:01} String [] message = {exception : 1223\. Operation cannot be done, exception : 1221\. Operation cannot be完毕}

有没有一种有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:06:49.253

我已经使用[平面文件解析库](http://jffp.sourceforge.net/)来执行类似的任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:38:28.493

比我的其他答案更好：

```
// dynamic list of strings for dates and messages
List<String> dates = new ArrayList<>();
List<String> messages = new ArrayList<>();
// split your logfile by line
String[] lines = yourLogFileContentAsString.split("\n");
for (String line : lines) {
    // dates are characters 0-19
    dates.add(line.substring(0, 20));
    // message starts at character 21
    messages.add(line.substring(21);
}
// you wanted arrays
String[] datesArray = dates.toArray(new String[0]);
String[] messagesArray = messages.toArray(new String[0]); 
```

# azure - Azure 插入在数据库中失败，但查询有效

> ID：13351508
> 
> 赞同：2
> 
> 时间：2012-11-12T21:01:55.697
> 
> 标签：azure, azure-compute-emulator, azure-storage-emulator

我正在尝试进行插入/替换：

```
 insertOrReplaceEntity('myusertables', task, function(error) 
```

它总是进入错误代码，表明没有发生插入。

如何在 Azure 中进行调试？

我正在使用 Azure 模拟器并在代码中有：

```
var account = azure.ServiceClient.DEVSTORE_STORAGE_ACCOUNT;
var accountKey = azure.ServiceClient.DEVSTORE_STORAGE_ACCESS_KEY; 
```

我得到 PUT 失败，出现 403。

```
{ error:
   { [Error: Server failed to authenticate the request. Make sure the value of Authorization header is formed correctl
including the signature.]
     code: 'AuthenticationFailed',
     message: 'Server failed to authenticate the request. Make sure the value of Authorization header is formed correc
y including the signature.' },
  response:
   { isSuccessful: false,
     statusCode: 403,
     body:
      { '@': [Object],
        code: 'AuthenticationFailed',
        message: [Object] },
     headers:
      { 'content-length': '356',
        'content-type': 'application/xml',
        server: 'Microsoft-HTTPAPI/2.0',
        date: 'Mon, 12 Nov 2012 20:57:10 GMT' },
     md5: undefined } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T05:51:07.833

如此[处](http://msdn.microsoft.com/en-us/library/windowsazure/gg433135.aspx)所述，存储模拟器不支持插入或替换实体或插入或合并实体，称为 upsert 功能。这就是为什么当您在代码中使用 insertOrReplaceEntity 时它会返回错误。如果你必须验证代码，你可能需要用真正的 Azure 表存储来检查它。

# grails - geb.env 和 geb.driver 的区别

> ID：13351510
> 
> 赞同：0
> 
> 时间：2012-11-12T21:02:22.793
> 
> 标签：grails, functional-testing, spock, geb

我试图找出 geb.driver 选项与 geb.env 之间的区别。

我找不到关于它们的任何具体文档。我可以理解 geb.env 类似于 grails.env ，除了 geb env 是在 GebConfig.groovy 中定义的。

那么，为什么我们需要geb.driver。更令人困惑的是，如果我指定 geb.driver，但在使用 geb.env 时出现错误，我的功能测试用例工作正常。

```
Cannot find window: _PPIdentityWindow_ 
Build info: version: '2.25.0', revision: '17482', time: '2012-07-18 22:18:01' 
System info: os.name: 'Mac OS X', os.arch: 'x86_64', os.version: '10.7.5', java.version: '1.6.0_35' 
Driver info: driver.version: unknown 
org.openqa.selenium.NoSuchWindowException: Cannot find window: _PPIdentityWindow_ 
Build info: version: '2.25.0', revision: '17482', time: '2012-07-18 22:18:01' 
System info: os.name: 'Mac OS X', os.arch: 'x86_64', os.version: '10.7.5', java.version: '1.6.0_35' 
Driver info: driver.version: unknown 
        at org.openqa.selenium.htmlunit.HtmlUnitDriver$HtmlUnitTargetLocator.window(HtmlUnitDriver.java:943) 
        at geb.Browser.switchToWindow(Browser.groovy:458) 
        at geb.Browser.withWindow(Browser.groovy:470) 
        at geb.spock.GebSpec.methodMissing(GebSpec.groovy:51) 
```

非常感谢任何帮助。我也在 grails 用户邮件列表中问过同样的问题。

[http://grails.1312388.n4.nabble.com/Difference-between-geb-driver-and-geb-env-td4637641.html](http://grails.1312388.n4.nabble.com/Difference-between-geb-driver-and-geb-env-td4637641.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T00:30:51.443

说到文档，[这里描述了 geb.driver ，这里](http://www.gebish.org/manual/current/configuration.html#driver_class_name)[描述](http://www.gebish.org/manual/current/configuration.html#environment_sensitivity)了geb.env 。

不同之处在于您可以使用 geb.driver 只能指定要使用的驱动程序，而使用 geb.env 您可以指定要使用的环境，然后指定任何特定于环境的配置，即基本 url、等待、报告目录以及司机，如果你愿意。

堆栈跟踪似乎与 HtmlUnit 驱动程序而不是 Firefox 驱动程序有关。我可以在您的邮件中看到您将 HtmlUnit 驱动程序指定为默认值，并且即使您使用了 geb.env=firefox 并且在您的 GebConfig.groovy 中有该环境的配置，也没有选择 firefox 驱动程序。 . 我能想到的三个原因是：

*   您没有在 BuildConfig.groovy 中指定对 firefox 驱动程序 jar 的依赖
*   您忘记在 GebConfig.groovy 中导入 FirefoxDriver 类
*   您在命令的错误位置指定了 geb.env 属性 - 您必须在 grails 之后直接指定它（即 grails -Denv.geb=firefox test functional:) 否则它不会被拾取

将来，如果您有 Geb 特定的问题，您应该考虑将它们发布到[Geb 邮件列表](http://xircles.codehaus.org/projects/geb/lists)而不是 Grails 邮件列表，您更有可能在那里得到答案。

# c++ - 插入函数中设置的迭代器

> ID：13351515
> 
> 赞同：0
> 
> 时间：2012-11-12T21:02:42.150
> 
> 标签：c++, insert, iterator

我正在为 Graph 类实现一个迭代器

```
class iterator_node {
    private:
        Graph* gr_;
        Node* curNode_;
    public:
        iterator_node() : gr_(NULL),curNode_(NULL) {}
        iterator_node(Graph& ddg) : gr_(&ddg),curNode_(NULL) {}
        ~iterator_node() {}
} 
```

我也有一个`Graph`我应该实现`insert`功能的类

```
class Graph {
private:
//....
map<NodeID,Node*> nodes_;
public:
pair<iterator_node,bool> insert(const NodeID nodeId,const NodeLabel nodeLabel);
}
pair<iterator_node,bool> Graph::insert(const NodeID nodeId,const NodeLabel nodeLabel)
{
    DDG::iterator_node itNode(*this);
    pair<Graph::iterator_node,bool> res(itNode,false);
    Node* node = new Node(nodeId,false,nodeLabel);
    pair<map<NodeID,Node*>::iterator,bool> nodeInsRet  = nodes_.insert(pair<NodeID,Node*> (nodeId,node));
    if (nodeInsRet.second == false) {
        std::cout << "Node with nodeID=" << nodeId << " already exists \n";
        delete node;
    }
    else {
        res.second = true;
       //!!Question!!!!
       //should update curNode_; in res`s iterator (res.first)
       //what is a relevan correct way to do it?
    }

    return res;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:13:35.610

你的迭代器不能迭代，除非它可以从一个元素移动到下一个元素。随着您当前的代码递增，`iterator_node`您必须在整个代码中搜索`Graph`当前代码`Node`，然后找到下一个......这将非常慢。

您需要将每个链接`Node`到其邻居，或者您`iterator_node`应该存储 a`map<NodeID,Node*>::iterator`而不是 a`Node*`

# html - 将元素浮动到字段集的右上角

> ID：13351517
> 
> 赞同：1
> 
> 时间：2012-11-12T21:02:50.200
> 
> 标签：html, css

有没有办法让我漂浮在 div 右侧的这个盒子，让它与右上角齐平？我已经尝试过制作它`position:relative`，`top:0px`但它仍然顽固地被传说的填充所抵消。

[http://jsfiddle.net/loren_hibbard/dpUM2/](http://jsfiddle.net/loren_hibbard/dpUM2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:11:36.693

您要么需要将位置设置为`absolute`，要么将`#title`元素设置为`float:left`。

`position:absolute`在 #top 和`position:relative`#out 上的示例：

[http://jsfiddle.net/bozdoz/dpUM2/9/](http://jsfiddle.net/bozdoz/dpUM2/9/)

#title 设置为的示例`float:left`：

[http://jsfiddle.net/bozdoz/dpUM2/13/](http://jsfiddle.net/bozdoz/dpUM2/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:18:03.053

Position:relative 在父节点上， position:absolute 在子节点上，注意 -1px 使其与父节点的边框重叠。

```
#out{
width:300px;
height:400px;
background:#efefef;   
border:1px solid gray;   
position:relative;
}
#top{
top:0;
right:-1px;
background-color:#fff;
width:150px;
height:25px;
border:1px solid black;
position:absolute;
} 
```

[http://jsfiddle.net/calder12/dpUM2/14/](http://jsfiddle.net/calder12/dpUM2/14/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:15:15.133

将您的 CSS 更改为如下所示：

```
#out{
        width:300px;
    height:400px;
     background:#efefef;   
         border:1px solid gray;
    padding:0px;    
    }
    #top{
     float:right;   
        background-color:#fff;
        width:150px;
        height:25px;
        border:1px solid black;
        margin:0px;
    }
    #title{
     padding:0px; 
        margin:0px;
        float:left;

    }​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:17:12.913

尝试将其添加到`#top`：

```
position: relative;
top: -24px; 
```

演示：http: [//jsfiddle.net/dpUM2/10/](http://jsfiddle.net/dpUM2/10/)

# php - 应用程序关闭后 HTTP 会话被删除（iPhone 应用程序）

> ID：13351519
> 
> 赞同：1
> 
> 时间：2012-11-12T21:02:58.157
> 
> 标签：php, iphone, session, afnetworking

在我的 iPhone 应用程序中，我使用 AFNetworking 向 PHP API 发出 HTTP 请求。

每次打开应用程序时，我都必须登录，服务器将启动会话。登录后，每次我向 API 发出 HTTP 请求时，API 都知道我有会话，并允许我使用 API 的每个功能。

问题是，在我关闭应用程序后，我认为会话已被破坏，我无法使用 API 中的任何功能而无需再次登录。

我在这里谈论一个使用 AFNetworking 发出 HTTP 请求的 iPhone 应用程序。从我的测试中，我知道会话在应用程序关闭后被破坏。

我想知道这是否属实，并且我想知道制作身份验证系统的最佳方法是什么。我认为该会话不再是解决方案，因为它们在应用程序关闭后被销毁。我的替代方法是每次有人登录时创建一个 auth_token 并将令牌存储在应用程序中，然后每次有人打开应用程序时，他们将发出的第一个 http 请求将包含 auth_token 并且如果该令牌与数据库中的令牌匹配，然后像往常一样初始化会话。我认为这可能会慢一些，前提是每次打开应用程序时都必须发出 HTTPS 请求来初始化客户端和服务器之间的连接。

所以问题是：关闭应用程序后是否可以保持会话处于活动状态？它是我的替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T11:18:38.977

这是我的问题的解决方案。如果您使用 AFNetworking，则在您关闭应用程序后会删除 cookie。因此，要解决此问题，您可以将 cookie 保存在用户默认值中，然后在应用程序打开时加载它们。

保存 cookie（你应该先检查 cookie 的名称，我的是 PHPSESSID，因为你不想保存无用的 cookie）：

```
 NSArray * all = [NSHTTPCookie cookiesWithResponseHeaderFields:[self.response allHeaderFields] forURL:[NSURL URLWithString:@"http://link.to.api" ]];
    for (NSHTTPCookie *cookie in all)
    {
        if([cookie.name compare:@"PHPSESSID"] == NSOrderedSame)
        {
            NSData *data = [NSKeyedArchiver archivedDataWithRootObject:cookie];
            [[NSUserDefaults standardUserDefaults] setObject:data forKey:@"MySavedCookies"];
            [[NSUserDefaults standardUserDefaults] synchronize];
        }
    } 
```

然后，当您在“应用程序 didFinishLaunchingWithOptions”中加载应用程序时，例如：

```
 NSData *cookiesdata = [[NSUserDefaults standardUserDefaults] objectForKey:@"MySavedCookies"];
  if([cookiesdata length])
  {
     NSHTTPCookie *cookie = [NSKeyedUnarchiver unarchiveObjectWithData:cookiesdata];
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie];
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T15:04:58.953

```
NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL: networkServerAddress];
for (NSHTTPCookie *cookie in cookies) 
{
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
} 
```

# java - Weblogic 和递归 JSP 标记

> ID：13351521
> 
> 赞同：6
> 
> 时间：2012-11-12T21:03:00.253
> 
> 标签：java, jsp, spring-mvc, weblogic, jsp-tags

我安装了 Weblogic 10.3.3 并且似乎遇到了递归 JSP 标记的问题。在互联网上，我发现其他一些人遇到了同样的问题（[这里](http://www.coderanch.com/t/428667/BEA-Weblogic/JSP-Tag-Files-used-recursivily)和[这里](https://forums.oracle.com/forums/thread.jspa?threadID=2457534)），但没有解决方案。有人建议它在 Weblogic 12 中已修复，或者在 9 中工作，但我无法证实这一点。

该应用程序是使用 Spring/Spring Roo/Apache Tiles/jspx 构建的。正在显示的模型类类似于：

```
public class Programme {

private String name;
private final List<Programme> programmes = new ArrayList<Programme>();

...(getter/setter)...
} 
```

然后我有一个这样的标签：

```
<jsp:root xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:coursedataimport="urn:jsptagdir:/WEB-INF/tags/coursedataimport" version="2.0">
    <jsp:output omit-xml-declaration="yes" />

    <jsp:directive.attribute name="programme" type="package.Programme" required="true" rtexprvalue="true" />

    <c:out value="${programme.name}" />

    <ul>
        <c:forEach var="p" items="${programme.programmes}">
            <li><coursedataimport:programme programme="${p}" /></li>
        </c:forEach>
    </ul>

</jsp:root> 
```

这行不通。请求页面时，应用程序容器似乎崩溃了（可能是一些堆栈溢出，但我在日志中找不到），并且重新加载了应用程序上下文。在 Tomcat 7 中它工作正常。

显示的异常是这样的，但我不确定它是否相关（因为它谈到了错误页面）：

> [ServletContext@483389576[app:app-ear-0 module:appmodule path:/CONTEXTROOT spec-version:2.5]] 提供错误页面时出现问题。org.springframework.web.util.NestedServletException：请求处理失败；嵌套异常是 java.lang.ClassCastException: org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:894) 处的 org.apache.tiles.ArrayStack org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet. java:779) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:707) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:821) 在 ...

以前有没有人遇到过这些问题，或者有人知道解决方法吗？有关如何调试此问题或如何解决递归标记的任何提示（因为我想显示一棵树，所以有点挑战）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T14:40:35.327

我不知道如何修复标签渲染引擎。但我的答案是解决如何完全消除递归。通过使用 java.util.Stack 可以减少任何递归背后的想法。然后你可以创建一个字段`indentation`来告诉你应该保留多少空间来显示树状结构

带有缩进的构建线性列表的 Java 代码：

```
class FormattedProgramme{
   Programme programme;
   int indent;
}
...
java.util.List<FormattedProgramme> result = new ArrayList<FormattedProgramme>();
java.util.Stack<FormattedProgramme> programmeStack = 
     new java.util.Stack<FormattedProgramme>();
//you should know how to resolve root bean 'programme'
programmeStack.push(new FormattedProgramme(programme, 0/*indent=0*/));

while(!programmeStack.empty()){
    FormattedProgramme parent = programmeStack.pop();
    result.add(parent);
    for(Programme child:parent.programme.programmes ){
         //create child item with indentation + 1 
         //may be you need keep order of items - then reverse this loop
         programmeStack.push(new FormattedProgramme(child, parent.indent+1));
    }
 } 
```

之后在 JSP 中你可以放置一些创建填充的东西（div 的 padding-left 乘以 10px）：

```
<c:forEach var="fp" items="${formatted}">
    <div style='padding-left:${fp.indent * 10}px'>
        <c:out value="${fp.programme.name}" />
    </div>
</c:forEach> 
```

# c# - WCF Json Rest 服务未命中方法

> ID：13351524
> 
> 赞同：1
> 
> 时间：2012-11-12T21:03:10.783
> 
> 标签：c#, wcf, rest, wcf-binding

我正在编写 WCF 服务（json REST），并且在使用 wcftestclient.exe 时它工作正常

当我运行该测试工具时，它会在调试时触发我的断点，并且一切都**按**预期工作。

但是，当使用浏览器导航到服务和方法时，不会触发断点。似乎请求甚至没有到达代码。

使用网络浏览器导航到服务时，我没有收到任何错误，它只是没有获取任何数据，或者触发断点。

抱歉，如果这是重复的，我已经阅读并尝试了在类似问题的答案中找到的许多不同配置，但似乎没有任何效果。

非常感谢您的帮助，我在下面发布了我的代码。

马丁

我有设置：ServiceContract

```
[OperationContract]
[WebGet(BodyStyle = WebMessageBodyStyle.Bare, ResponseFormat = WebMessageFormat.Json)]
List<Country> GetAllCountries(); 
```

服务类：

```
 public List<Country> GetAllCountries()
    {
        ControlServiceRepository rep = new ControlServiceRepository();
        return rep.GetAllCountries().ToList() ;
    } 
```

和我的网络配置

```
<system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="OmniData" behaviorConfiguration="ServiceConfig">
        <!-- Service Endpoints -->
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:55641/"/>
          </baseAddresses>
        </host>
        <endpoint address="" binding="webHttpBinding" contract="ControlService.IOmniData" behaviorConfiguration="rest" />
      </service>
    </services>
      <behaviors>
        <endpointBehaviors>
          <behavior name="rest">
            <webHttp helpEnabled="true"/>
          </behavior>
        </endpointBehaviors>
        <serviceBehaviors>
          <behavior name="ServiceConfig">
            <serviceMetadata httpGetEnabled="true"/>
            <serviceDebug includeExceptionDetailInFaults="false"/>
          </behavior>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <standardEndpoints>
      <webHttpEndpoint>
        <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="false" defaultOutgoingResponseFormat="Json"/>
      </webHttpEndpoint>
    </standardEndpoints>
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:15:44.093

我认为你的合同中缺少一些东西

```
[OperationContract]
[WebInvoke(Method = "GET", UriTemplate = "/GetAllCountries", RequestFormat = WebMessageFormat.Json,ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
List<Country> GetAllCountries(); 
```

试试这个。让我知道它是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:43:12.970

我最终通过删除配置中的所有端点并使用

```
RouteTable.Routes.Add(new ServiceRoute("", new WebServiceHostFactory(), typeof(OmniData))); 
```

如果其他人有问题，这甚至比设置端点更容易，因为您可以在类本身中指定响应类型和端点。

所以：

如果确实存在，请添加 global.asax 并包括以下内容：

```
protected void Application_Start(object sender, EventArgs e)
        {
            RouteTable.Routes.Add(new ServiceRoute("", new WebServiceHostFactory(), typeof(OmniData)));
        } 
```

装饰你的服务类

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)] 
```

这是我的：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class OmniData : IOmniData
{
  public Country[] GetAllCountries()
  {
    ControlServiceRepository rep = new ControlServiceRepository();
    return rep.GetAllCountries().ToArray() ;
  }
} 
```

然后是您使用 WebGet 或 WebInvoke 设置端点和类型的界面

```
public interface IOmniData
    {
        [OperationContract]
        [WebGet(UriTemplate = "OmniData/GetAllCountries", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare)]
        Country[] GetAllCountries();
    } 
```

UriTemplate 是终点，因此要访问您将使用的方法：http: [//MyService.com/OmniData/GetAllCountries](http://MyService.com/OmniData/GetAllCountries)

最后，网络配置

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>
    <standardEndpoints>
      <webHttpEndpoint>
        <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="false"/>
      </webHttpEndpoint>
    </standardEndpoints>
    <services>
      <service name="OmniData">
        <!-- Service Endpoints -->
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:55641"/>
          </baseAddresses>
        </host>
        <endpoint address="" binding="webHttpBinding" contract="ControlService.IOmniData" behaviorConfiguration="rest" />
      </service>
    </services>
    <behaviors>
      <endpointBehaviors>
        <behavior name="rest">
          <webHttp />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="Default">
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

[来自这里](http://geekswithblogs.net/michelotti/archive/2010/08/21/restful-wcf-services-with-no-svc-file-and-no-config.aspx)的很多帮助

但是，重要的是，对于我想要的 json 结果，您需要确保： automaticFormatSelectionEnabled="false" 在那里，因此它将使用界面中指定的响应格式。否则，您最终会使用 XML。

希望这对其他人有帮助

再次感谢提琴手！

马丁

# urlencode - url_encode 的使用

> ID：13351525
> 
> 赞同：3
> 
> 时间：2012-11-12T21:03:12.500
> 
> 标签：urlencode

我尝试使用 Ruby 的 url_encode（[此处](http://rdoc.info/stdlib/erb/1.9.3/ERB/Util%3aurl_encode)为文档。）

它编码`http://www.google.com`为`http%3A%2F%2Fwww.google.com`. 但事实证明，我无法通过浏览器打开后者。如果是这样，这个功能有什么用？当它编码的 URL 甚至无法打开时，它有什么用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:20:58.637

例如，您可以使用`url_encode`对 GET 请求的键/值进行编码。

下面是一个 SO 搜索查询 URL 编码后的示例：

> [https://stackoverflow.com/questions/tagged/c%23+or+.net+or+asp.net](https://stackoverflow.com/questions/tagged/c%23+or+.net+or+asp.net)

如您所见，url 编码似乎只应用于 URL 的最后一部分，在最后一个斜杠之后。

通常，您不能在整个 URL 上使用 url_encode，否则您还将对普通 URL 中的特殊字符进行编码，例如示例中的 ://。

您可以在此处查看解释其工作原理的教程：[http ://www.permadi.com/tutorial/urlEncoding/](http://www.permadi.com/tutorial/urlEncoding/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:29:45.023

一个典型的用途是 HTTP **GET**方法，您需要一个查询字符串。

查询字符串 1：

```
valudA=john&valueB=john2 
```

实际值服务器获取：

*   值A：“约翰”

*   价值B：“约翰2”

**url_encode**用于使键值对能够存储包含一些**非 ASCII 编码字符**（如空格和特殊字符）的字符串。

**假设 valueB 将存储我的名字，代码 4 j，你需要对其进行编码，因为有一些空格。**

```
url_encode("code 4 j")
code%204%20j 
```

查询字符串 2：

值A=约翰&值B=代码%204%20j

实际值服务器获取：

*   值A：“约翰”
*   值B：“代码 4 j”

# html - Css3 Box-shadow 属性出现在除底部之外的所有侧面

> ID：13351526
> 
> 赞同：2
> 
> 时间：2012-11-12T21:03:16.740
> 
> 标签：html, css

这是我要在其上应用阴影的框的代码。

```
width: 295px;
max-width:90%;
height: auto;
padding-bottom:20px;
float:left;
text-align:center;
margin-left:10px;
margin-top:50px;
background-color: white;
-webkit-box-shadow: 0px 0px 5px #CCC;
box-shadow: 0px 0px 5px #CCC;
-moz-box-shadow: 0px 0px 5px #CCC;
position:relative; 
```

Beautiful Design Valid Code Structure 和 Seo Integrated 的 3 个框都带有这个 box-shadow 属性，但它没有出现在底部。

![图片](../Images/588e2c15a84be7ff738e242683793ffa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T18:49:59.813

这些分组元素周围是否有一个边界框，可能对其应用了大小限制，以某种方式切断了最后一个元素底部的框阴影？

你试过清理你的浮动吗？

演示：http: [//jsfiddle.net/uriahjamesgd_73/5fQPV/](http://jsfiddle.net/uriahjamesgd_73/5fQPV/)

```
<!-- HTML -->
<div class="box"></div>
<div class="box"></div>
<div class="box"></div>
<div class="box"></div>

<div class="box clear"></div>
<div class="box"></div>
<div class="box"></div>
<div class="box"></div>​

/* CSS */
.box {
  position:relative;  
  width: 75px;
  max-width:90%;
  height: 75px;
  padding:0 0 20px 0;
  float:left;
  text-align:center;
  margin: 10px 0 0 10px;
  background-color: white;
  -webkit-box-shadow: 0px 0px 5px #CCC;
  -moz-box-shadow: 0px 0px 5px #CCC;
  box-shadow: 0px 0px 5px #CCC; 
}
.clear {
  clear:left;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-22T20:17:12.663

看来问题出在您的 box-shadow 属性上。

尝试这个：

```
.box{
width: 295px;
max-width:90%;
height: auto;
padding-bottom:20px;
float:left;
text-align:center;
margin-left:10px;
margin-top:50px;
background-color: white;
-webkit-box-shadow: 0px 0px 5px 2px #ccc;
-moz-box-shadow: 0px 0px 5px 2px #ccc;
box-shadow: 0px 0px 5px 2px #ccc;
position:relative;
} 
```

查看[此](http://www.cssmatic.com/box-shadow)链接以获取更多实验。

如果它仍然不起作用，看起来某些元素可能应用了大小限制，以某种方式切断了最后一个元素底部的框阴影。

希望能帮助到你 ：）

# android - 模拟调频收音机控制

> ID：13351529
> 
> 赞同：2
> 
> 时间：2012-11-12T21:03:34.817
> 
> 标签：android, input, numbers, controls

我想用我们都知道的模拟 FM 收音机的控件替换普通的 EditText 控件 (inputType="numberDecimal") 来输入一些十进制数字：

![在此处输入图像描述](../Images/1865a318c5dd8b51a94d4a0193db721e.png)

基本上你有一个整数序列，这个序列的一部分是可视化的。您指定一个 minValue 和 maxValue，currentValue 以某种方式突出显示。向左滑动应该增加显示的数字，向右滑动应该减少它们。

任何人都知道类似的东西是否已经在 android 中实现或有任何提示来实现这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T02:07:43.107

我看到的最相似的项目是[Android Wheel](https://github.com/sephiroth74/AndroidWheel)

![截屏](../Images/9d4a6beac11171627f17a10eea7a997c.png)

使用权限具有震动效果

```
<uses-permission android:name="android.permission.VIBRATE" /> 
```

要在当前布局中包含轮子小部件，您应该在布局 xml 中添加以下行：

```
<it.sephiroth.android.wheel.view.Wheel
android:id="@+id/wheel"
xmlns:sephiroth="http://schemas.android.com/apk/res/it.sephiroth.android.wheel"
android:layout_width="match_parent"
android:layout_height="match_parent"
sephiroth:numRotations="6"
sephiroth:ticks="28" /> 
```

其中 numRotations 是轮子可以执行的最大旋转次数， ticks 是轮子将显示的总刻度数。

然后在您的活动中，您可以通过以下方式将 OnScrollListener 侦听器添加到车轮小部件：

```
mWheel = (Wheel) findViewById( R.id.wheel );
mWheel.setOnScrollListener( new OnScrollListener() {

@Override
public void onScrollStarted( Wheel view, float value, int roundValue ) {
}

@Override
public void onScrollFinished( Wheel view, float value, int roundValue ) {
}

@Override
public void onScroll( Wheel view, float value, int roundValue ) {
}
} ); 
```

另一个可能有用的是[DateSlider](https://github.com/bendemboski/DateSlider) ![SS2](../Images/a535437ecf2fde54cef6ae5c6e534812.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:52:26.217

我认为没有内置功能。

我在网上找到了类似的东西 - [http://mobile.tutsplus.com/tutorials/android/android-sdk-creating-a-rotating-dialer/](http://mobile.tutsplus.com/tutorials/android/android-sdk-creating-a-rotating-dialer/)

为了让它像你想要的那样，你必须把它放在 a 中`framelayout`，并在中间放一个 textview 来显示数字。

框架布局 - [http://developer.android.com/reference/android/widget/FrameLayout.html](http://developer.android.com/reference/android/widget/FrameLayout.html)

我没有深入阅读该教程，但我想通过将图像更改为水平刻度盘，并通过更改`onTouchListener`您将能够获得您想要的内容。

如果您对此问题有任何疑问，我会尽力提供帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T00:44:13.740

查看 Wheel Widget：[http ://code.google.com/p/android-wheel/](http://code.google.com/p/android-wheel/)

它可能会做你想做的事。

# java - 词典快速排序

> ID：13351538
> 
> 赞同：0
> 
> 时间：2012-11-12T21:03:54.823
> 
> 标签：java, algorithm, sorting, quicksort

`Strings`我尝试使用 java 中的快速排序算法按字典顺序对数组进行排序。数组通过终端使用 a 读入`Scanner`并保存在`ArrayList`. 稍后将其`ArrayList`转换为我（尝试）应用快速排序算法的数组。我有两种方法：

```
private static void sortA(String[] s, int start, int end) {
    if (end > start) {
        int pivot = partition(s, start, end);
        sortA(s, start, pivot - 1);
        sortA(s, pivot + 1, end);
    }
}

private static int partition(String[] s, int start, int end) {
    String pivot = s[end];
    int left = start;
    int right = end;
    String temp = "";
    do {
        while ((s[left].compareTo(pivot) <= 0) && (left < end))
            left++;
        while ((s[right].compareTo(pivot) > 0) && (right > start))
            right--;
        if (left < right) {
            temp = s[left];
            s[left] = s[end];
            s[right] = temp;
            printRow(s);

        }
    } while (left < right);
    temp = s[left];
    s[left] = s[end];
    s[end] = temp;
    return left;
} 
```

该代码似乎随机工作正常，然后突然不行。例如，数组`{"java", "application", "system"}`排序精细到`{"application", "java", "system"}`. 数组`{"library", "content", "bin"}`排序为`{"bin", "library", "contents"}`，这不是字典顺序。当然，计算机不会随机工作，所以我的代码一定有问题。我试图在纸上制定一个例子，但后来我会发现一些完全错误的东西。但是，我的代码基于对双数组进行排序的快速排序实现，所以我认为我没有犯很大的推理错误。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:13:43.320

您以错误的方式拆分数组：正确的拆分是“pivot-1”“pivot”

```
sortA(s, start, pivot-1);
sortA(s, pivot, end); 
```

# java - JSF2 AJAX h:selectOneMenu 监听器不调用

> ID：13351539
> 
> 赞同：0
> 
> 时间：2012-11-12T21:03:55.213
> 
> 标签：java, ajax, jsf, jsf-2

我尝试在页面上制作 2 h:selectOneMenu 组件。当我从第一个 selectOneMenu 中选择一些主题时，我想将 ajax 与侦听器一起使用，在该监听器中我获得了选定主题的 ID，并在其他 selectOneMenu 中为该主题填写了列表测试。我使用带有会话范围的bean。

```
<f:event type="preRenderView" listener="#{test.getAllSubjects}" />
<h:form prependId="false">          
    <h:panelGroup rendered="#{not empty test.testBean.subjectList}">
                    <h:selectOneMenu value="#{test.testBean.subjectId}" id="subjects">
                        <f:selectItem itemLabel="--Select a subject--" itemValue="0" />
                        <f:selectItems value="#{test.testBean.subjectList}"
                            var="subjectItem" itemValue="#{subjectItem.subjectId}"
                            itemLabel="#{subjectItem.subject}" />
                        <f:ajax event="change" render="tests" listener="#{test.testsBySubjectId}" />                
                    </h:selectOneMenu>

    <h:selectOneMenu value="#{test.testBean.test.testIdentifer.testId}" id="tests">
                    <f:selectItem itemLabel="--Select a test--" itemValue="0" />
                        <f:selectItems value="#{test.testBean.testList}" var="testItem" 
                        itemValue="#{testItem.testIdentifer.testId}" itemLabel="#{testItem.testName}" />                                    
                    </h:selectOneMenu>
    </h:panelGroup>
</h:form> 
```

并在托管 bean 中使用下一个监听器

```
public void getTestsBySubjectId() throws DAOException {
     Long subjectId = testBean.getSubjectId();
     List<Test> testList = testBo.getTestBySubjectId(subjectId);
     testBean.setTestList(testList);
     } 
```

但是永远不会调用此侦听器。

这就是为什么我做了一些技巧，我在`<f:ajax event="change" render="tests" />`没有监听器的情况下更改标签。

但是`h:selectOneMenu`为了测试我做了

```
<f:selectItems value="#{test.testsBySubjectId}" var="testItem"
                        itemValue="#{testItem.testIdentifer.testId}"
                        itemLabel="#{testItem.testName}" /> 
```

在那里我初始化了 bean 测试列表中的值而不是值测试。我尝试初始化为

```
public List<Test> getTestsBySubjectId() throws DAOException {
        Long subjectId = testBean.getSubjectId();
        List<Test> testList = testBo.getTestBySubjectId(subjectId);
        testBean.setTestList(testList);
        return testList;
    } 
```

此变体有效。但我不明白为什么以前的带有监听器的变体不起作用。

我的错在哪里？为了正确的结果应该改变什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:09:56.620

侦听器不是属性。如果您在 java bean 中的方法是`getTestBySubjectId()`，请将其放在属性中（不需要括号）。

```
 <f:ajax event="change" render="tests" listener="#{test.getTestsBySubjectId}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:37:35.273

@SJuan76 你是对的。用听众的名字，但我明白我真正的问题。

```
<f:event type="preRenderView" listener="#{test.getAllSubjects}" /> 
```

此侦听器调用 ajax 回发。我从这篇文章中理解了这一点。[是否可以在回发时禁用 f:event type=“preRenderView” 侦听器？](https://stackoverflow.com/questions/8506033/is-it-possible-to-disable-fevent-type-prerenderview-listener-on-postback)

谢谢@BalusC

我还在`AjaxBehaviorEvent event`监听器方法中添加了 arg

# linux - 通过 USB 进行 NXC 通信

> ID：13351546
> 
> 赞同：2
> 
> 时间：2012-11-12T21:05:08.947
> 
> 标签：linux, usb, nxt, nxc

您将如何通过 USB 端口发送数据并在我的 Linux 机器中接收数据？

```
task main ()
{
byte data[2] = {1,2};
while (1)
{
  Wait(1000);
  SetUSBOutputBuffer(0, 2, data);
}
} 
```

编译它：

```
nbc -d -Z2 usb.nxc 
```

dmesg：

```
usb 2-1.2: reset full-speed USB device number 6 using ehci_hcd 
```

现在如何获取 NXT 发送的“数据”？如何用 C 语言编写一个读取 USB 缓冲区的 Linux 程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-08T17:42:19.630

Fantom SDK 不支持 Linux。相反，请使用 libnxt。Debian 存储库中的那个仍在维护中。

# vb.net - 使用第三方 Ingear.Net .dll 的死锁？

> ID：13351552
> 
> 赞同：0
> 
> 时间：2012-11-12T21:05:30.963
> 
> 标签：vb.net, multithreading, deadlock

我正在使用来自 Ingeardrivers.com 的 .dll。我意识到在那个网站上问这个问题会更合适，并且也已经发布到那里，但是这里有更多的人让我得到更好回答的机会。

我是一名新手程序员，这是我第一次使用线程。基本上我的程序中有两个主循环，当我将每个循环作为“主线程”单独运行时——它们都可以单独工作。问题是当我启动两个线程并在这些线程中运行主循环时，在循环中的某个时刻，它们都试图使用 Ingear.net dll，并且当一个循环已经创建了该类的一个实例时，第二个循环只是坐在构造函数上，不做任何事情。

有人对如何解决有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:40:49.067

我建议您首先与供应商核实，看看该库是否是线程安全的。

但与此同时，您可以尝试创建该类的单个实例并将其作为构造函数的一部分传递给您的两个线程/循环（或使用它设置属性）。

它很可能行不通，但在你尝试之前你不会知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T12:11:47.030

该插件是线程安全的 -

每次我都是通过“controllername.disconnect()”手动断开控制器的连接，出于某种原因，这实际上并没有关闭连接，而且我在 CIP 连接上已经用尽了。当我删除它时，控制器不知何故知道自己断开连接。

奇怪但它有效。

# ruby - 如何通过使用数组而不是链接大量 OR 来测试值是否相等？

> ID：13351554
> 
> 赞同：0
> 
> 时间：2012-11-12T21:05:40.310
> 
> 标签：ruby

如何将所有这些 OR 语句转换为通过数组或迭代器完成的操作？

这是长而不优雅的 OR 链：

```
type = "Open top" if cargo_operation_container_shifting[12] == 1 or cargo_operation_conatiner_shifting[16] ==1 or cargo_operations_container_shifting[99] == 1 
```

（这是一个简短的例子）

到目前为止，这是我在将其制成数组方面所取得的进展：

```
open_top_array  = [12, 16, 99]
type = "Open top" if open_top_array.each { |n| cargo_operation_container_shifting[n] == 1 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:11:21.783

你的[`any?`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-any-3F)方法：

```
open_top_array  = [12, 16, 99]
type = "Open top" if open_top_array.any?{ |n| cargo_operation_container_shifting[n] == 1 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:11:25.633

```
type = 'Open top' if [12, 16, 99].any? do |n| 
  cargo_operation_container_shifting[n] == 1
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:22:33.103

使用`values_at`：

```
type = "Open top" if cargo_operation_container_shifting.values_at(12,16,99).any?{|v| v == 1} 
```

# c++ - 为什么我不能在我的班级中声明这个对象？

> ID：13351556
> 
> 赞同：1
> 
> 时间：2012-11-12T21:05:46.333
> 
> 标签：c++, class, object

当我这样做时，我的编译器会抱怨。出现了 3 个错误，但没有可见的错误消息：

```
#include <stdlib.h>
#include <vector>
#include <string>
#include "ParseException.h"
#include "CycleFoundException.h"
#include "UnknownTargetException.h"

using namespace std;

class Maker
{
 private:
 vector<Node> storage;

 public:
 Maker(string file) throw (ParseException, CycleFoundException, UnknownTargetException);
 vector<string> makeTarget(string targetName);      
};

struct Node
{
    string target;
    vector<string> dependencies;
    string command;
    int discoverytime;
    int finishtime;
    int visited;
    Node* next;
}; 
```

编译器不喜欢我的`vector<Node> storage`声明。相反，当我这样做时`vector<int> storage`，它会毫无怨言地编译。在另一个类中声明一个类的对象是错误的吗？我以为这没问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T21:08:06.520

看起来您需要将 的定义放在 的定义`Node`之前`Maker`。

您在（在行中）`Node`的定义中使用类型名称，但是因为您尚未定义，编译器不知道它是什么。`Maker``vector<Node> storage``Node`

# ruby-on-rails - 在 Rails 3.2.x 中使 mass_assignment 保护错误不沉默？

> ID：13351561
> 
> 赞同：0
> 
> 时间：2012-11-12T21:06:23.967
> 
> 标签：ruby-on-rails, activerecord, mass-assignment

这是一件相当简单的事情，但是由于 Rails 3.2 批量分配保护默认启用，当您尝试通过批量分配设置受保护的属性时，有没有办法让 rails 在开发或测试中引发异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:10:10.540

在 development.rb 中，默认注释掉以下内容。取消注释。

```
config.active_record.mass_assignment_sanitizer = :strict 
```

# java - 如何强加 Google App Engine 的 DeadlineExceededException？

> ID：13351563
> 
> 赞同：2
> 
> 时间：2012-11-12T21:06:35.293
> 
> 标签：java, multithreading, google-app-engine

我想采取的态度是，如果我的服务器端太慢，只需抛出异常并将有意义的错误消息发送回客户端即可。我将这个时间限制任意设置为 5 秒，并会根据需要进行调整。

我看到 App Engine`ApiProxy.getCurrentEnvironment().getRemainingMillis()`提供了我们在抛出 a`DeadlineExceedException`和超时之前剩下的毫秒数。

我想做类似的事情，但是对 GAE 的 60 秒限制施加我自己的 5 秒限制（同样，现在我选择 5 秒还是 40 秒并不重要，只要它们更严格比GAE强加的）。我想编写一个启动 5 秒计时器的服务器端处理程序/servlet。如果请求在该时间内没有返回，它会抛出异常并返回给客户端：

```
public class MyTimedServlet extends HttpServlet {
    public void doGet(HttpServletRequest request, HttpServletResponse response)
        throws IOException {
        // Start 5-second timer
        Timer timer = new Timer(5000);

        try {
            timer.start();
            response = handleRequest(request);
        }
        catch(TimeException timerException) {
            response = ResponseFactory.newTimeExceededResponse();
        }
    }
} 
```

不幸的是，我在 GAE API 中看不到任何与`Timer`我正在寻找的对象相似的东西。

我已经计划通过 对每个请求使用多线程`ThreadManager.currentRequestThreadFactory().newRequestThread(...)`，所以我不想浪费其中一个（我一次只能得到 10 个！）线程来创建背景“*定时器线程*”，除非我绝对必须这样做。

所以我问：GAE 是否有这样的开箱即用的东西，如果我必须自己推出，我该怎么做？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:35:38.167

**代码中的任何异步任务（不遵循正常流程）都涉及新线程执行，在这种情况下，此任务是计算时间。**

但是，您可以使用App-Engine JRE 白名单中包含的类[`Timer`](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)和两者。[`TimerTask`](http://docs.oracle.com/javase/6/docs/api/java/util/TimerTask.html)

示例代码：未测试只是一个指南。

```
public class YourServlet extends HttpServlet {

    Timer timer;
    HttpServletResponse response;   

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)...{
        int seconds = 5;
        timer = new Timer();
        timer.schedule(new DeadLine(), seconds * 1000);     

        /* the rest of your code here */
    }

    class DeadLine extends TimerTask {
        public void run() {      
            response.getWriter().print("Error: deadline reached.");     
        }
      }
} 
```

阅读这篇关于[Java 中的作业调度的文章，](http://oreilly.com/java/archive/quartz.html)了解更多信息。

# c# - 如何在 Visual Studio 中使用 Ghostdoc Pro 在 T4 中添加空白注释行？

> ID：13351565
> 
> 赞同：1
> 
> 时间：2012-11-12T21:06:37.960
> 
> 标签：c#, t4, stringbuilder, comments, ghostdoc

在 GhostDoc Pro 的“规则”设置中，它允许我使用 T4 来格式化我的评论。然而，它随机添加换行符（我已经整理出来），并且也不允许我添加一行三重斜杠。

例如：

```
///======================================================
///Class:    TripleSlash
///                 //<-----How do I add just a blank line like so?
///<summary>
///          Class of the triple slashing breed
///</summary>
///====================================================== 
```

我试过添加一个 StringBuilder.Append("///"); 我试过只是简单地添加三个斜杠。然而，GhostDoc Pro 似乎删除了任何会添加空白三重正斜杠注释行的 T4 或 C# 代码行。

我觉得我忽略了一些简单的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T12:59:44.467

Ghostdoc 的 T4 不支持插入换行符或空行。

不开心的一天。

# vba - 用 VBA 中的另一个单元格引用替换依赖项

> ID：13351571
> 
> 赞同：6
> 
> 时间：2012-11-12T21:07:19.120
> 
> 标签：vba, replace, cut-and-paste

我编写了一些 VBA 代码，它采用单个单元格并在工作簿中标识其所有依赖项（通过 NavigateArrow 分析）并将它们的范围位置添加到数组中。从这里我希望能够更新每个依赖项并将对原始单个单元格的引用更改为另一个指定的单个单元格。

我在这里遇到的特别困难是，虽然我知道每个依赖项在哪里，但对原始单元格的引用可能位于公式的开头、中间或结尾，并且可能是未锚定的、行/列/都锚定的，可能在不同的工作表上，因此在其前面有一个工作表引用，等等等等。因此，由于这些潜在的差异，我无法在每个依赖单元格中轻松查找和替换，而且我想保持原来的锚定在每个单元格引用。

是否有一个优雅的——甚至是不优雅的——VBA 解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-02T19:04:32.713

我认为正则表达式或 Regexp 是您正在寻找的。

以下模式

```
([A-Z0-9]*)!(\${0,1})([A-Z]{1,3})(\${0,1})([0-9]*) 
```

将匹配“Sheet1!A1”、“Sheet1!$A$1”、“Sheet1!$A1”、“Sheet1!A$1”之类的任何内容

解释：

```
([A-Z0-9]*)!  =  Find anything that is before "!"
(\${0,1}) = $ or nothing
([A-Z]{1,3})  = between one and three letters
([0-9]*)  = Any number 
```

您应该能够轻松地修改该模式以仅匹配您想要的。特别是 ([A-Z0-9]*)!(\${0,1})B(\${0,1})1，只会匹配其中包含 B($)1 的内容...使用字符串操作构造正则表达式模式，应该很好。

您需要参考（工具 > 参考）“Microsoft VBScript 正则表达式 5.5”

尝试以下代码，这应该为您提供实现目标的所有工具

```
Sub ReplaceReference()
' Reference: Microsoft VBScript Regular Expressions 5.5

Dim RegEx As Object
Set RegEx = New RegExp

Dim s As String

' Here I have hardcoded the reference to the original cell for demonstration purposes
s = "Sheet1!$AB$2"

' Replacement: New sheetname, New Column, new row number
Dim NewCol As String, NewRow As String
NewCol = "C"
NewRow = "10"

Dim NewSheet As String
NewSheet = "Sheet2"

With RegEx
    .Pattern = "([A-Z0-9]*)!(\${0,1})([A-Z]{1,3})(\${0,1})([1-9]*)"
    .IgnoreCase = True
    .Global = True
End With

Debug.Print RegEx.Replace(s, NewSheet & "!" & "$2" & NewCol & "$4" & NewRow)

End Sub 
```

干杯，朱利安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T21:14:11.857

为什么不让 VBA 剪切和粘贴源单元格？然后，Excel 将调整所有精彩的单元格引用。

我创建了一些带有引用的单元格，然后使用宏记录器查看在选择单元格、剪切和复制内容时生成的 VBA 中会发生什么。行为符合预期，如下所示：

```
Range("A1").Select
Selection.Cut
Range("B1").Select
ActiveSheet.Paste 
```

这将适用于以下工作表：

```
A1  1
A2  =A1
A3  =$A$1
A4  =1+A1
A5  =1+A1+1 
```

运行宏后，所有引用都指向`B1`目标单元格。

# xml - 移除 xmlns 属性并重命名根节点

> ID：13351575
> 
> 赞同：1
> 
> 时间：2012-11-12T21:07:54.253
> 
> 标签：xml, xslt-2.0, xml-namespaces

您好我想`xmlns="http://www.w3.org/1999/xhtml"`从源 xhtml/xml 文件中删除命名空间并重命名根节点，并且想尝试仅使用一个样式表来执行此操作。这可能吗？

这是我的示例源 xml/xhtml：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title/>
  <meta/>
</head>

<body link="#000000" bgcolor="#FFFFFF" leftmargin="0">
<div>
  <p>Here is a paragraph</p>
</div>
</body>
</html> 
```

这是我想要的输出：

```
<document>
  <section>
    <paragraph>Here is a paragraph</paragraph>
  </section>
</document> 
```

目前，我只能使用两个样式表来实现这个结果（见下文），但我希望能够将这些指令组合到一个样式表中。这可能吗？如果可以，怎么做？提前感谢您的帮助。

当前样式表 1：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" version="1.0" encoding="UTF-8"/>

<xsl:template match="*|@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="*|@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="@*">
  <xsl:attribute name="{local-name()}"><xsl:value-of select="."/></xsl:attribute>
<xsl:apply-templates/>`
</xsl:template>`

<xsl:template match="*">
  <xsl:element name="{local-name()}">
    <xsl:apply-templates select="*|@*|node()"/>
  </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

当前样式表 2：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

<xsl:template match="*|@*|text()">
  <xsl:copy>
    <xsl:apply-templates select="*|@*|text()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="html">
  <document>
    <xsl:apply-templates select="*|@*|text()"/>
  </document>
</xsl:template>

<xsl:template match="div">
  <section>
    <xsl:apply-templates select="*|@*|text()"/>
  </section>`
</xsl:template>`

<xsl:template match="p">
  <paragraph>
    <xsl:apply-templates select="*|@*|text()"/>
  </paragraph>
</xsl:template>`

<xsl:template match="head"/>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T00:26:28.937

由于您使用的是 XSLT 2.0，因此您需要做的就是添加

```
xpath-default-namespace="http://www.w3.org/1999/xhtml" 
```

到样式表 2，工作就完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-25T18:06:14.777

对于 xslt 2.0 解决方案，添加到 Michael Kay 的较早答案，以下模板还将停止将命名空间添加到根元素的子元素：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0" xpath-default-namespace="http://www.w3.org/1999/xhtml">

<xsl:template match="*[namespace-uri() = 'http://www.w3.org/1999/xhtml']">
<xsl:element name="{local-name()}">
<xsl:apply-templates select="*|@*|text()"/>
</xsl:element>
</xsl:template> 

</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T03:56:52.997

**只是这个**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:x="http://www.w3.org/1999/xhtml" exclude-result-prefixes="x">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
  <document>
   <xsl:apply-templates/>
  </document>
 </xsl:template>

 <xsl:template match="x:div">
  <section><xsl:apply-templates/></section>
 </xsl:template>

 <xsl:template match="x:p">
  <paragraph><xsl:apply-templates/></paragraph>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title/>
        <meta/>
    </head>
    <body link="#000000" bgcolor="#FFFFFF" leftmargin="0">
        <div>
            <p>Here is a paragraph</p>
        </div>
    </body>
</html> 
```

**产生了想要的正确结果**：

```
<document>
   <section>
      <paragraph>Here is a paragraph</paragraph>
   </section>
</document> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T23:11:33.317

有几种不同的方法可以做到这一点。这是一个。

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xhtml="http://www.w3.org/1999/xhtml"
  exclude-result-prefixes="xsl xhtml">
<xsl:output encoding="UTF-8" indent="yes" omit-xml-declaration="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="*">
  <xsl:element name="{local-name()}">
    <xsl:apply-templates select="@*|node()" />
  </xsl:element>
</xsl:template>

<xsl:template match="@*|comment()|processing-instruction()|text()">
  <xsl:copy />
</xsl:template>

<xsl:template match="/*"><!-- xhtml:html -->
  <document>
    <xsl:apply-templates select="@*|node()" />
  </document>
</xsl:template>

<xsl:template match="xhtml:body">
  <xsl:apply-templates select="@*|node()" />
</xsl:template>

<xsl:template match="xhtml:div">
  <section>
    <xsl:apply-templates select="@*|node()" />
  </section>`
</xsl:template>`

<xsl:template match="xhtml:p">
  <paragraph>
    <xsl:apply-templates select="@*|node()" />
  </paragraph>
</xsl:template>`

<xsl:template match="xhtml:head"/>

</xsl:stylesheet> 
```

**更新** 我忘了将 xhtml: 添加到模板匹配中。现已更正。

# android - 如何测试从 Android 活动中触发的线程/任务

> ID：13351580
> 
> 赞同：0
> 
> 时间：2012-11-12T21:08:12.880
> 
> 标签：android

从我的 SetupActivity 中查看下面的代码片段 - 我如何测试我在此处触发的任务是否正确执行？

例如这一行：

```
new AttachChildGcmTask(app).execute(app.getChildInfo().getId()); 
```

我的活动中的代码片段：

```
....
@Override
public void onClick(View v) {
    if (v.getId() == R.id.btn_proceed) {
        finishSetup();
    }
}

private void finishSetup() {
    UIUtilities.showToast(this, R.string.setup_completed, true);
    final AppBipper app = (AppBipper) getApplication();
    app.setSetupCompleted(true);

    Log.i(TAG, "finishSetup childId: "+app.getChildInfo().getId());
    new AttachChildGcmTask(app).execute(app.getChildInfo().getId());
    Log.i(TAG, "download settings");
    new FetchClientSettings(app).execute();

    Log.i(TAG, "cancel all scheduled alarms");
    ScheduledLocationsHelper helper =
            ScheduledLocationsHelper.getInstance(app.getDBManager(), app);
    helper.cancelAlarms();

    startActivity(new Intent(this, StartupActivity.class));
    finish();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:15:21.007

看看这个，它可能会有所帮助：

[AsyncTask 真的在概念上存在缺陷还是我只是遗漏了什么？](https://stackoverflow.com/questions/3357477/is-asynctask-really-conceptually-flawed-or-am-i-just-missing-something)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:15:24.820

我猜你的意思是活动在任务完成之前就结束了。

因此，将这些测试包含**在**您的`AsyncTask`类中，并让它们以某种方式向您的 UI 报告（广播意图，使用处理程序等等......）

# orbeon - 按名称绑定不同的控件值

> ID：13351582
> 
> 赞同：0
> 
> 时间：2012-11-12T21:08:25.390
> 
> 标签：orbeon

我们通过名称绑定不同的控件值，在 Form Builder 中对表单进行编码。例如：[**表单数据**](http://ideone.com/5mZp8q)。实际上我们需要这样的 xml 数据：[**outputdata.xml**](http://ideone.com/PZpNWa)。正如您在 outputdata.xml 中看到的，带有名称的控件与名称`A_2`绑定的控件是`B2`. 一个等等。A_3 和 B3，...，A_n 和 Bn（n - 数） 我们通过使用 XSLT 转换技术做到了这一点。使用工作流按钮发送和 HTTP 服务调用 jsp。很难对我们的表单进行编码。因为我们可能会犯错。我们怎样才能让它变得容易。我们正在考虑**汽车名称**对于某些部分。例如：我们如何在某些部分为创建的控件自动命名。（每个控件的名称都以A_1、A_2、A_3等开头，不同部分的控件名称分别为B1、B2、B3、B4？

或者也许有任何其他技术可以像在 outputdata.xml 中那样获取 data.xml？先感谢您！xpl处理器呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T06:50:08.887

根据 avernet 的回答，我们必须编写 XSLT，按照该约定重命名元素。

# ios - 如何使用适用于 iOS 的 Facebook SDK 3.1 向用户发送用户请求

> ID：13351584
> 
> 赞同：4
> 
> 时间：2012-11-12T21:08:34.733
> 
> 标签：ios, facebook

我正在尝试邀请用户的 facebook 朋友在 iOS 应用程序中与用户一起参与。我的理解是我想使用用户到用户请求而*不是*应用程序请求。

我不确定如何做到这一点。

根据[发送请求](http://developers.facebook.com/docs/howtos/send-requests-using-ios-sdk/)页面，应该有一个具有“对话”方法的“Facebook”类。不过，这似乎并不存在于 iOS 版 Facebook SDK 3.1 中。

那么如何使用适用于 iOS 的 Facebook SDK 3.1 向用户发送用户请求？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T16:07:27.830

[Facebook 开发者](https://developers.facebook.com/docs/howtos/send-requests-using-ios-sdk/)网站上有关于如何执行此操作的详细指南。

不要忘记遵循指南中提到但很容易错过的这条规则（强调我的）：

> 导入`Facebook.h`头文件并**替换**Facebook框架`<FacebookSDK/FacebookSDK.h>`导入声明

换句话说，如果您想避免编译器出现大量*重复符号*错误，请确保您正在**替换**`FacebookSDK.h`导入，而不是同时`Facebook.h`导入两者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T21:53:50.553

事实证明，解决方案是引用 Facebook deprecated headers

~Documents/FacebookSDK/FacebookSDK.framework/Versions/A/DeprecatedHeaders

然后使用 FBDialog：

```
[self.facebook dialog:@"apprequests"
           andParams:params
         andDelegate:self]; 
```

# php - 创建用于分发 Symfony 应用程序的自安装、包罗万象的包的最佳方法是什么？

> ID：13351585
> 
> 赞同：1
> 
> 时间：2012-11-12T21:08:40.380
> 
> 标签：php, installation, symfony-1.4

我们开发了一个 Symfony 应用程序。我们希望将它作为驻留在我们服务器上的在线服务提供，但我们认为能够为大众提供一键式安装程序会很好，它能够：

1.  安装一个为 Symfony 1.4 预配置的网络服务器（可能是 apache），在“无害”端口（例如 8888）上工作，带有 php 和相关模块（ACP 等）
2.  使用另一个无害的端口安装 DBMS，可能是 MySQL（但也可能是 SQLite）
3.  提取应用程序的源代码
4.  构建数据库并加载必要的装置

当然，它会是一个很好的跨平台安装程序。

你有什么建议？放弃吧？使用虚拟机？使用蟒蛇？

**更新** 似乎另一种可能性是使用诸如 XAMPP 或类似的一体化软件包，可能与应用程序的 phar 存档相结合。我会继续探索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:44:19.050

使用虚拟机。在那里，您可以创建自己的环境，特定于您的包。所以你可以控制事情。但是，创建 php 安装程序是一项相当复杂的任务：在不同环境中与服务器软件有很多细微差别。

此外 - 更容易维护和部署虚拟机。

# javascript - 带有单选按钮的 jQuery post 函数

> ID：13351586
> 
> 赞同：2
> 
> 时间：2012-11-12T21:08:50.677
> 
> 标签：javascript, jquery, django

在我的 Django 应用程序中，我想使用 Twitter 引导单选按钮。然后我想发布这些按钮的值以创建一个对象。

这是我的按钮：

```
 <div class="btn-group" data-toggle="buttons-checkbox">
  <button type="button" class="btn" name="supporting">Team1</button>
  <button type="button" class="btn" name="supporting">Team2</button>
  </div>

  <div class="span6 btn-group ib" data-toggle="buttons-radio">
       <button type="button" class="btn btn-primary active" name="style">relaxed</button>
       <button type="button" class="btn btn-primary active" name="style">strict</button>
  </div>

  <input type="submit" value="create your match"> 
```

我想从这些单选按钮中获取信息并在视图中创建一个与之匹配的对象：

```
 def test(request):
       user=request.user
       if request.method == 'POST':
       style = request.POST['style']
       supporting = request.POST['supporting']
       match = Match.objects.create(user=user, style=style, supporting=supporting)
     return HttpResponse(test) 
```

问题是我不太了解 JavaScript，所以我没有找到如何从按钮中获取值。

然后，我想我必须使用：

```
 $.post('/sportdub/points_dub/', {'style': style , 'supporting': supporting}); 
```

但是我怎样才能使样式和支持与按钮的值相对应，然后仅在用户单击按钮时才发布？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:15:09.363

接受我的[最后一个答案](https://stackoverflow.com/a/13348783/28004)，让我们使用你自己的代码......在你的 HTML 中你有类似的东西：

```
<form action="/sportdub/points_dub/" method="post" class="form-horizontal">

  <div class="btn-group" data-toggle="buttons-checkbox">
    <button type="button" class="btn" name="supporting">Team1</button>
    <button type="button" class="btn" name="supporting">Team2</button>
  </div>

  <div class="span6 btn-group ib" data-toggle="buttons-radio">
    <button type="button" class="btn btn-primary active" name="style">relaxed</button>
    <button type="button" class="btn btn-primary active" name="style">strict</button>
  </div>

  <input type="submit" value="create your match" />

</form> 
```

并且您只需为每个块添加一个隐藏字段，在您的情况下，添加 2。然后您的表单将匹配：

```
<form action="/page" method="post" class="form-horizontal">

  <input type="hidden" id="supporting_team" value="" />
  <input type="hidden" id="supporting_type" value="" />

  <div class="btn-group supporting_team" data-toggle="buttons-checkbox">
    <button type="button" class="btn" name="supporting">Team1</button>
    <button type="button" class="btn" name="supporting">Team2</button>
  </div>

  <div class="span6 btn-group ib supporting_type" data-toggle="buttons-radio">
    <button type="button" class="btn btn-primary active" name="style">relaxed</button>
    <button type="button" class="btn btn-primary active" name="style">strict</button>
  </div>

  <input type="submit" value="create your match" />

</form> 
```

添加一个 jQuery 帮助器，它将在按钮单击时设置这些隐藏字段的值：

```
// whenever a button is clicked, set the hidden helper
$(".supporting_team .btn").click(function() {
    $("#supporting_type").val($(this).text());
}); 
$(".supporting_type .btn").click(function() {
    $("#supporting_team").val($(this).text());
}); 
```

当你点击`create your match`整个表单时会发布到页面设置为`action`表单的属性，你什么都不用做...

如果您想通过调用`post`javascript 手动提交它，您需要记住防止表单再次提交，因为这是`input type="submit"`元素任务，您可以调用您的帖子并序列化整个表单数据，而不是像您的示例中那样一一进行。 ..

喜欢：

```
// when the form is submited...
$("form").submit(function() {

   // submit it using `post`
   $.post('/sportdub/points_dub/', $("form").serialize()); 

   // prevent the form to actually follow it's own action
   return false; 

}); 
```

在您的动态代码中，您将拥有这些变量：

```
supportingTeam = request.POST['supporting_team']
supportingType = request.POST['supporting_type'] 
```

这将是有效的，无论您是否有手动表单提交脚本......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:14:20.070

在您最近发表评论之后，我认为您应该尝试使用 HTML 中提供的输入单选按钮。对按钮进行分组、为输入制作标签以及检索已单击的按钮非常容易。

稍微改变你的 HTML 看起来像这样（标签的 for 属性允许用户能够单击标签并选择单选按钮，而不是直接单击按钮）：

```
 <div>
    <input id="team1" type="radio" name="supporting" value="Team1" /><label for="team1">Team 1</label>
    <input id="team2" type="radio" name="supporting" value="Team2" /><label for="team2">Team 2</label>
  </div>
  <div>
    <input id="relaxed" type="radio" name="style" value="relaxed" /><label for="relaxed">Relaxed</label>
    <input id="strict" type="radio" name="style" value="strict" /><label for="strict">Strict</label>
  </div> 
```

我可以使用以下方法获取已进行的选择：

```
$('input[name="supporting"]').filter(':checked').val();
$('input[name="style"]').filter(':checked').val(); 
```

如果您仍希望使用按钮，`active`则单击时会将类添加到单选按钮。要获取按钮文本，请尝试：

```
$('button[name="supporing"]').filter('.active').text();
$('button[name="style"]').filter('.active').text(); 
```

要将此值放入隐藏输入中，请执行以下操作：

```
$('#hiddenInput1').val($('button[name="supporting"]').filter('.active').text());
$('#hiddenInput2').val($('button[name="style"]').filter('.active').text()); 
```

# ruby-on-rails - 在哈希数组中查找值以创建新的哈希数组

> ID：13351588
> 
> 赞同：4
> 
> 时间：2012-11-12T21:09:11.660
> 
> 标签：ruby-on-rails, ruby, arrays, hash

我有一些从 api 返回的数据，我已将其解析为：

```
[{:a=>value1, :b=>value2, :c=>value3, :d=>value4}, {:a=>value5, :b=>value6, :c=>value7, :d=>value8},{:a=>value9, :b=>value10, :c=>value11, :d=>value12}, ...] 
```

如何使用和的**键和值**`b`创建一个新的哈希数组`c`，给定`key = b`和`key = c`？我想传递密钥并返回值并维护密钥。所以我想结束：

```
[{:b=>value2, :c=>value3}, {:b=>value6, :c=>value7}, {:b=>value10, :c=>value11}, ...] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:14:50.910

### 纯红宝石

```
array = [{:a=>'value1', :b=>'value2', :c=>'value3', :d=>'value4'}, {:a=>'value1', :b=>'value2', :c=>'value3', :d=>'value4'}]

b_and_c_array = array.map{|a| a.select{|k, _| [:b, :c].include?(k)} } 
```

我们使用`map`将返回结果数组的方法获取每个散列。对于每个散列，我们只选择`[:b, :c]`键。您可以在其中添加更多内容。

### 导轨

如果使用 Rails，让我们使用`Hash#slice`, prettier ：

```
b_and_c_array = array.map{|a| a.slice(:b, :c) } 
```

# java - 正确使用单例模式

> ID：13351590
> 
> 赞同：1
> 
> 时间：2012-11-12T21:09:23.407
> 
> 标签：java, multithreading, design-patterns, synchronization, singleton

我正在尝试实现单例模式的示例。我们的问题之一是运行两个线程，每个线程都调用 getInstance() 并验证只创建了 Singleton 对象的一个​​实例。

这是我的单例代码；

```
public class OurSingleton {

    static OurSingleton ourSingleton;
    static int instanceCounter;

    private OurSingleton(){
        instanceCounter++;
    }

    public static synchronized OurSingleton GetSingletonInstance(){

        if( ourSingleton == null){

            ourSingleton = new OurSingleton();

        }
        return ourSingleton;    
    }

    public static int getCounter() {

        return instanceCounter;

    }
} 
```

还有我的主要；

```
public class Main {

    /**
     * @param args
     */
    public static void main(String[] args) {

        OurSingleton mySingleton = null;

        Thread one = new Thread(new GetSingletonInstance(mySingleton));
        Thread two = new Thread(new GetSingletonInstance(mySingleton));

        one.start();
        two.start();

        System.out.println("Main: " + mySingleton.getCounter());
    }   
}

class GetSingletonInstance implements Runnable {

    int count = 0;
    OurSingleton singleton;

    public GetSingletonInstance(OurSingleton ourSingleton){
        singleton = ourSingleton;
    }

    @Override
    public void run() {
        try {
            while (count < 5000000) {
                singleton.getSingletonInstance();
                count++;    
            }

        } catch (Exception e) {

            e.printStackTrace();
        }

        System.out.println("Thread: " + singleton.getCounter());

    }       
} 
```

当我运行此代码时，我得到以下输出；

> 主要：0 线程：1 线程：1

有人可以解释这个输出的原因吗？我以为只有一个 Singleton 实例存在。这是否意味着正在线程中创建另一个对象？任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:16:21.017

您应该避免同步该`getInstance`方法（因为它只是在初始化实例后获取实例的不必要开销）。以下是延迟初始化单例的推荐方法：

```
public class OurSingleton {

    private OurSingleton() { }

    public static OurSingleton getInstance() {
        return Holder.instance;
    }

    private static class Holder {
        private static OurSingleton instance = new OurSingleton();
    }        
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T21:37:43.963

> 以为只有一个 Singleton 实例存在。这是否意味着正在线程中创建另一个对象？

JVM中只存在一个单例实例；您的每个线程都显示只有一个实例的事实。

在 Java 中实现单例模式最简单、最安全的方法是使用枚举：

```
public enum MySingleton {
    INSTANCE;

    public void doStuffHere() {
        //...
    }
}

public class ClientClass {
    public void myMethod() {
        MySingleton mySingleton = MySingleton.INSTANCE;
        mySingleton.doStuff();
    }
} 
```

您只有一个 MySingleton 实例，它是线程安全的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-12T21:15:29.943

您已经从同一类创建了 2 个线程实例。每个打印单例对象的实例数。数字为 1 表示您确实只创建了一个实例，因此您的单例已正确实现。您打印了两次，因为您创建了 2 个线程。

如果你想避免混淆移动线`System.out.println(...)`到你的主要方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-12T21:26:11.580

我会这样解释：

当你加载类`OurSingleton`时，静态计数器`getInstanceCounter`被初始化为零。然后你得到类的新实例多少次，计数器总是1，表明你确实有一个单例。

我建议进行以下更改

1.  将 Singleton 中的静态变量设为私有：`ourSingleton`，`getInstanceCounter`
2.  删除方法上的同步关键字，因为它是不必要的开销

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-12T21:12:29.077

只有一个`OurSingleton`实例，但类`getSingletonInstance`（使用正确的大写字母！）本身不是单例。它就是你放置柜台的地方。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-12T22:08:02.507

查看其他答案以了解如何更好地做到这一点，对于您的问题，您为什么要获得此输出

```
Main: 0 
Thread: 1
Thread: 1 
```

用代码

```
static int getInstanceCounter; 
```

您正在设置声明并将静态变量设置为零。因此，在创建 OurSingleton 的任何实例之前，getInstanceCounter 的值为零。你打电话时

```
System.out.println("Main: " + mySingleton.getCounter()); 
```

没有创建 OurSignleton 的实例，所以 mySignleton.getCounter() 仍然为零。

运行一个或两个线程将导致创建 OurSingleton 的一个实例，而 getInstanceCounter 将是一个。

你的单身人士正在工作。尽管在其他答案中提到了更好的方法。

* * *

顺便说一句，关于您的代码的一些事情可能看起来很挑剔，但会帮助其他人阅读您的代码。

*   请将变量设为私有

    静态int getInstanceCounter；=>
    私有静态 int getInstanceCounter;

*   变量不应该用 get 命名

    私有静态int getInstanceCounter；=>
    私有静态 int instanceCounter;

*   不要在类的实例上引用静态方法

    mySingleton.getCounter() =>
    OurSingleton.getCount()

*   这也意味着永远不应该引用从未分配值的变量 mySingleton 并且应该删除。

    public GetSingletonInstance(OurSingleton ourSingleton){
    singleton = ourSingleton;
    }
    =>
    public GetSingletonInstance(){
    singleton = OurSingleton.getInstance();
    }

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-12T21:24:26.583

`OurSingleton.getInstanceCounter`通过 （静态成员函数）访问（静态成员`OurSingleton.getCounter ()`）是不同步的。这是唯一重要的事情。程序的其余部分只是使事情复杂化。请注意，`main`您是通过在指针`mySingleton.getCounter ()`上调用静态函数！从来没有比.`null``mySingleton``null`

您应该使用`enum`来实现单例模式，或者至少只使用一个静态变量，即持有单例对象的变量。

# git - 永久删除 Git 中的单个旧提交

> ID：13351592
> 
> 赞同：4
> 
> 时间：2012-11-12T21:09:30.997
> 
> 标签：git, github

大约两个月前，我的一位同事将他的虚拟环境添加到了我们的 Git 存储库中并推送了它。

我在随后的提交/推送中将其删除，并将其添加到 .gitignore。

然而，从那时起，我们已经有大约 500 次提交。

有没有办法我可以从 Github 和我们的本地仓库中完全删除他原来的 90k 行提交而不会造成任何问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:12:45.363

Github 有一个[关于删除适用于您的情况的敏感数据的帮助页面](https://help.github.com/articles/remove-sensitive-data)（只有少数 Github 特定的部分可以忽略）。

好消息是您*可以*删除旧的提交。

坏消息是，您*可能会给*您的合作者带来麻烦，除非您能够非常有效地传达存储库的整个历史将发生变化。他们将需要根据新的历史重新调整所有工作分支的基础。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:13:35.097

您可以从问题之前的提交创建一个分支，并在问题之后的第一次提交上创建一个分支。然后将第二个基于第一个。然后，如果您将 master 重置为指向该分支的新提示，并删除另一行的所有 refs，GC 最终将销毁这些项目。

当然，之后您可能希望重新克隆每个人的 repo，因为这是一个涉及更新大量 refs 的侵入性更改（从您的描述中假设自此 repo 上发生了很多事情）。

# bash - Bash脚本字符串比较错误，想不通

> ID：13351597
> 
> 赞同：1
> 
> 时间：2012-11-12T21:09:51.477
> 
> 标签：bash

我修复了下面的代码，使其工作：

```
#!/bin/bash
out="$(cat /proc/acpi/bbswitch)"
if [[ "$out" == *OFF* ]];
then
    tee /proc/acpi/bbswitch <<<ON
    echo "Nvidia card activated."
else
    tee /proc/acpi/bbswitch <<<OFF
    echo "Nvidia card disabled."
fi 
```

这是为了激活或禁用我的 Optimus 卡。第 4 行出现错误：

```
./.bb: line 4: [0000:01:00.0 OFF: command not found
OFF
Nvidia card disabled. 
```

我可以从中读到它试图执行 $out 变量。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:16:50.123

`[`您需要确保括号/`]`和实际变量之间至少有 1 个空格；即：更改您的代码

```
if ["$out" == "$is"]; 
```

至：

```
if [ "$out" == "$is" ]; 
```

它应该工作。

原因是这`[`实际上是 bash 中的“测试”命令。试试你的提示：

```
which [ 
```

你应该看到类似的东西：

```
/usr/bin/[ 
```

另外，`man [`要阅读有关语法的更多信息

（注意，由于参数由空格分隔，因此您的第二个变量之间也需要有一个空格`]`。测试`]`用作终止标记）

# python - QuickFIX 登录问题：发送了多次快速登录尝试

> ID：13351608
> 
> 赞同：1
> 
> 时间：2012-11-12T21:10:27.233
> 
> 标签：python, quickfix

QuickFIX 登录问题：（使用 QuickFIX，在 Python 2.7 中使用 FIX 4.4）

一旦我`initiator.start()`建立了连接，就会发送登录消息。但是，我从来没有看到代理发回的 ACK 和会话状态消息（所有重载的应用程序方法都应该打印出它们收到的内容）。

QuickFIX 立即重新尝试登录（根据代理日志文件），同样的事情发生了，但根据服务器，我已经登录了。

QuickFIX 然后发出一个注销命令，服务器遵守该命令。

我尝试在设置文件中输入超时值，但无济于事。（我是否需要在代码中明确引用这些值才能使用，或者引擎会看到它们并自动采取相应的行动？）

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T21:12:33.460

听起来您没有启用消息日志。如果您的应用拒绝应用程序级别以下的消息（例如，如果 seq no 错误，或者消息格式错误），那么它将在您的自定义消息处理程序甚至看到它之前被拒绝。

如果您使用 ScreenLogStore 启动 Initiator，请将其更改为 FileLogStore。这将创建一个日志文件，其中包含会话中发送和接收的每条消息，无论是否有效。美元到甜甜圈，你会在那里看到你的登录确认以及一些传输层拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T21:19:27.373

解决了！我认为我的数据字典 (FIX44.xml) 文件有问题。我之前看到过它的问题，但我认为我已经解决了它。我在网上获得了一份新副本并将其放入，现在一切似乎都正常了。也许坏字典没有让 FIX 接受登录响应？

# c++ - 将 MinGW64 库与 MSVC 2010 链接

> ID：13351612
> 
> 赞同：0
> 
> 时间：2012-11-12T21:10:57.287
> 
> 标签：c++, visual-c++, linker, mingw, libs

我正在尝试将我现在使用 MinGW 4.7.2 编译的自编译库（zlib、SDL、SDL_Mixer、SDL_Image、PCRE、...）（.dll.a，非静态）与 MSVC 2010 (x64) 链接起来，这很好，但是当我尝试启动应用程序时，我收到了奇怪的错误，例如在 SDL_Mixer.dll 中找不到“deflateInit2”（但这应该在 zlib.dll 中......）。这可能是什么原因造成的？如果我将它们与 MinGW 链接，那么一切正常，没有任何缺陷。我是否必须将我的 *.dll.a 文件转换为 *.lib 文件，以便 MSVC 可以正确使用它们？我必须注意链接顺序吗？

在有人问之前，为什么我不使用官方库，这是因为它们不能与 MinGW 4.7.x 正常工作，他们总是用 MinGW 4.7.x 破坏堆栈。

奇怪的 MessageBox 截图：http: [//i.imgur.com/zUlTt.png](https://i.imgur.com/zUlTt.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:53:10.887

我自己解决了这个问题，方法是使用“dumpbin”从 dll 创建 *.def 导出，使用“lib /def:lib.def”创建 *.lib 导入库。

# c# - 干净地中断 HttpListener 的 BeginGetContext 方法

> ID：13351615
> 
> 赞同：12
> 
> 时间：2012-11-12T21:11:03.620
> 
> 标签：c#, .net, .net-4.0, httplistener

我正在使用[HttpListener](http://msdn.microsoft.com/en-us/library/34xswsd2%28v=vs.100%29.aspx)并使用[BeginGetContext](http://msdn.microsoft.com/en-us/library/system.net.httplistener.begingetcontext%28v=vs.100%29.aspx)来获取我的上下文对象。我想干净地关闭我的 HttpListener 但如果我尝试在侦听器上[关闭](http://msdn.microsoft.com/en-us/library/system.net.httplistener.close%28v=vs.100%29.aspx)我会得到一个异常并导致我的程序退出。

```
using System;
using System.Net;

namespace Sandbox_Console
{
    class Program
    {
        public static void Main()
        {
            if (!HttpListener.IsSupported)
            {
                Console.WriteLine("Windows XP SP2 or Server 2003 is required to use the HttpListener class.");
                return;
            }

            // Create a listener.
            HttpListener listener = new HttpListener();
            listener.Prefixes.Add("http://vwdev.vw.local:8081/BitsTest/");
            listener.Start();
            Console.WriteLine("Listening...");

            listener.BeginGetContext(Context, listener);
            Console.ReadLine();

            listener.Close(); //Exception on this line, but not shown in Visual Studio
            Console.WriteLine("Stopped Listening..."); //This line is never reached.
            Console.ReadLine();

        }

        static void Context(IAsyncResult result)
        {
            HttpListener listener = (HttpListener)result.AsyncState;
            HttpListenerContext context = listener.EndGetContext(result);

            context.Response.Close();
            listener.BeginGetContext(Context, listener);
        }
    }
} 
```

该程序会引发异常，`listener.Close()`但该错误从未在 Visual Studio 中显示，我得到的唯一注释是调试输出屏幕中的以下内容：

> System.dll 中发生了“System.ObjectDisposedException”类型的第一次机会异常
> 程序“[2568] Sandbox Console.vshost.exe: Managed (v4.0.30319)”已退出，代码为 0 (0x0)。

我能够从 Windows 事件查看器中获得真正的执行

```
应用程序：沙盒 Console.exe
框架版本：v4.0.30319
说明：进程因未处理的异常而终止。
异常信息：System.ObjectDisposedException
堆：
   在 System.Net.HttpListener.EndGetContext(System.IAsyncResult)
   在 Sandbox_Console.Program.Context(System.IAsyncResult)
   在 System.Net.LazyAsyncResult.Complete(IntPtr)
   在 System.Net.ListenerAsyncResult.WaitCallback（UInt32，UInt32，System.Threading.NativeOverlapped*）
   在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback（UInt32，UInt32，System.Threading.NativeOverlapped*）

```

我需要做什么才能干净地关闭我的 HttpListener？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-12T22:05:32.973

当您调用 Close 时，最后一次调用上下文，您必须处理可能抛出的对象已处置异常

```
static void Context(IAsyncResult result)
{
    HttpListener listener = (HttpListener)result.AsyncState;

   try
   {
        //If we are not listening this line throws a ObjectDisposedException.
        HttpListenerContext context = listener.EndGetContext(result);

        context.Response.Close();
        listener.BeginGetContext(Context, listener);
   }
   catch (ObjectDisposedException)
   {
       //Intentionally not doing anything with the exception.
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-01T12:42:51.530

你可以添加这一行

```
if (!listener.IsListening) { return; }
HttpListenerContext context = listener.EndGetContext(ctx); 
```

# mysql - 从表中删除所有条目将不起作用

> ID：13351621
> 
> 赞同：0
> 
> 时间：2012-11-12T21:11:42.183
> 
> 标签：mysql, innodb

谁能告诉我为什么这条线不起作用？表是这样的：`id, playerId, points`。
`playerId`是外键。

```
$query = "DELETE FROM `contestants`";   
$result = mysql_query($query) or die("ERROR:QUERY_FAILED timeset 13" . mysql_error()); 
```

两个命令

```
DELETE FROM `contestants` 
```

和

```
TRUNCATE `contestants` 
```

从 phpmyadmin 工作。

有任何想法吗？您是否看到语法错误？php 日志没有显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:03:55.443

您确定您用于应用程序的用户名/密码有权操作所述数据库。因为如果您可以在 PhpMyAdmin 的 SQL 输入框中执行查询，而不是通过 PHP，那么我建议您在 PhpMyAdmin 中使用默认 root 无密码或 root/root 登录。

我有一个类似的问题，为我解决的问题是 phpmyadmin > 选择所述数据库 > 权限 > 选择我的用户名滚动到底部并点击保存。

出于某种原因，即使我的帐户拥有所有数据库的所有角色，我仍然必须这样做。

无论如何，我会运行它以确保：

```
SHOW GRANTS FOR username@localhost; 
```

# linux - 不同组的 Linux 目录权限

> ID：13351622
> 
> 赞同：9
> 
> 时间：2012-11-12T21:11:47.817
> 
> 标签：linux, permissions

我有两个目录：“公共”和“私人”。我有三个用户：“chris”、“john”、“dan”。我有两个组：“pub”、“priv”和“god”。

*   组“上帝”应该完全访问“公共”和“私人”。
*   “pub”组应该是唯一拥有“public”权限的组
*   组“priv”应该是唯一拥有“private”权限的组。

作为根：

`useradd chris`

`useradd john`

`useradd dan`

`usermod -g god chris`

`usermod -g pub john`

`usermod -g priv dan`

`chgrp god public private`

`chgrp pub public`

`chgrp priv private`

`su chris`

作为“克里斯”：

`cd public/`

`touch test`= 权限被拒绝

* * *

其他用户也是如此……在“dan”下我对“private”目录没有权限，尽管“dan”是“priv”组的成员。

你有什么主意吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-14T17:58:42.553

好吧，我知道这相对较旧，但 twalberg 是正确的：实际上有一种相对简单的方法可以使用 POSIX ACL 完成此操作。它们自 90 年代末/2000 年代初就已经存在，所以我不知道为什么更多的人不使用它们。

**怎么做：**像你已经做的那样做，然后简单地执行这个命令：

```
# setfacl -m g:god:rwx public private 
```

并且在一个命令中你得到你想要的。您将永远尝试仅使用传统的 unix 权限来弄清楚如何做到这一点。

Mikic 的建议可能仍然很好（取决于您要完成的工作），并且在您的权限中引用尽可能少的组可能更直接（或者您可能希望“克里斯”不是t 一个普通用户，但一个管理用户，这又取决于您要构建的内容）。

我提供了更接近您想要完成的内容，因为在某些情况下您可能会尝试授予辅助用户/组对目录的访问权限，但您不想在“克里斯”无法访问这两个目录和“chris”可以访问所有其他文件和目录“pub”和“priv”可能有权访问。使用 ACL，您不必做出这些选择，这就是添加它们的原因，现在它们已成为大多数 Unix（以及 BSD 和 Linux）平台的核心部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T22:01:47.577

您说“pub”组应该是唯一拥有“public”权限的组。但是在此之前，您说“上帝”也应该有权访问。所以“pub”不能是唯一可以访问的。“隐私”同上。

你还说：

> 我有两个组：“pub”、“priv”和“god”。

嗯，就是三组。（让我想起那句名言：“世界上有三种人；会数的人和不会数的人。”:-P）

您的基本概念似乎是错误的。其工作方式相当简单。创建两个组，“pub”和“priv”。相应地放置所有需要访问目录的用户。需要访问这两个目录的用户应该属于这两个组。

在这种情况下，“chris”应该放在“pub”和“priv”组中。“john”应该放在“pub”组中。“dan”应该放在“priv”组中。

您试图做的是让目录由两个组拥有。那是不可能的。可以是多个组的一部分的用户，而不是文件或目录。你只是把它倒退了:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:48:21.597

您的方法中有两个问题。第一个是：

```
chgrp god public private
chgrp pub public 
```

使用第二个命令，您丢弃了第一个命令的效果。目录`public`现在属于`pub`组，`god`不再属于。

第二件事是您可能没有将目录的写权限授予`public`拥有它的组（执行命令的用户`touch`属于目录组的事实并不重要）。

尝试这个：

```
chmod 770 public 
```

并与其他目录类似。但是，您最初尝试实现的目标是不可能的，因为该目录只能属于一个组。Nikos 在他的回答中很好地阐述了这一点 - 将用户放在更多组中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-12T22:17:55.873

您将需要使用支持 ACL 的文件系统。如其他答案中所述，基本Linux权限可以拥有`pub`和`priv`组所有权，但要授予对`god`组的访问权限，因为文件/目录只能有一个组标签，需要ACL。大多数当前文件系统都应该支持此功能 - 请参阅 和 的手册`getfacl`页`setfacl`。

# javascript - 如何处理中止的同步 AJAX

> ID：13351623
> 
> 赞同：3
> 
> 时间：2012-11-12T21:11:50.110
> 
> 标签：javascript, ajax, jquery

我的 Web 服务器可以更改其 IP 以响应特定的 HTTP 请求。问题是，浏览器使用同步`$.ajax()`来发布这个请求。由于服务器 IP 已更改，请求在超时后中止（firebug net 选项卡中的“Aborted”）。但是，由于帖子是同步的，因此浏览器（在本例中为 FF）会无限挂起。据我了解，不可能超时或以编程方式中止同步 AJAX。

由于许多实际原因，我无法将请求更改为异步。任何想法如何处理这种情况？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:41:14.230

您有几个可用的选项。

## 更改服务器端行为

更改服务器上的 Web 应用程序以完成其对客户端的响应，然后再更改其 IP 地址。然后，无论调用是否成功，您的应用程序都会收到响应。

## 使用异步 AJAX 调用

不言自明。你不想这样做，但你真的应该这样做，而不仅仅是你现在遇到的问题。如果您的应用程序确实需要进行重大更改才能使其正常工作，那么它可能还有其他设计问题需要重新审视。

无论如何，您目前正在使用即发即弃的方法，所以我真的不明白为什么这会是一个问题。

# android - 如何在googlemaps中将图标更改为其他图标

> ID：13351628
> 
> 赞同：1
> 
> 时间：2012-11-12T21:12:13.110
> 
> 标签：android, android-layout, android-intent

我想知道如何将各种不同的图标添加到谷歌地图？目前我可以添加一个，但想添加从列表中选择的不同的或放置在地图上的任何内容。

这是我的 MainActivity 代码：

```
 public class MainActivity extends MapActivity implements LocationListener {

 MapView map;
 long start;
 long stop;
 MyLocationOverlay compass;
 MapController controller;
 int x, y;
 GeoPoint touchedPoint;
 Drawable d;
 List<Overlay> overlayList;
 LocationManager lm;
 String towers;
 int lat;
 int longi;

@Override
 public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.activity_main);
 map = (MapView) findViewById(R.id.mapview);
 map.setBuiltInZoomControls(true);

 Touchy t = new Touchy();
 overlayList = map.getOverlays();
 overlayList.add(t);
 compass = new MyLocationOverlay(MainActivity.this, map);
 overlayList.add(compass);
 controller = map.getController();
 GeoPoint point = new GeoPoint((int)(-24.0110 * 1E6), (int)(31.4850 * 1E6));
 controller.animateTo(point);
 controller.setZoom(10);
 d = getResources().getDrawable(R.drawable.icon);

 //Placing PinPoint at location
 lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
 Criteria crit = new Criteria();

 towers = lm.getBestProvider(crit, false);
 Location location = lm.getLastKnownLocation(towers);

 if (location != null){
     lat = (int) (location.getLatitude() *1e6);
     longi = (int) (location.getLongitude() *1E6);
     GeoPoint ourLocation = new GeoPoint(lat, longi);
     OverlayItem overlayItem = new OverlayItem(ourLocation, "What's Up", "2nd String");
        CustomPinPoint custom = new CustomPinPoint(d, MainActivity.this);
        custom.insertPinpoint(overlayItem);
        overlayList.add(custom);
 }else{
     Toast.makeText(MainActivity.this, "Couldn't Get Provider", Toast.LENGTH_SHORT).show();
 }

}

  @Override
protected void onPause() {
    // TODO Auto-generated method stub
    compass.disableCompass();
    super.onPause();
    lm.removeUpdates(this);
}

@Override
protected void onResume() {
    compass.enableCompass();
    // TODO Auto-generated method stub
    super.onResume();
    lm.requestLocationUpdates(towers, 500, 1, this);
}

 @Override
 protected boolean isRouteDisplayed() {
 return false;
 }
class Touchy extends Overlay{
public boolean onTouchEvent(MotionEvent e, MapView m){
        if (e.getAction() == MotionEvent.ACTION_DOWN){
            start = e.getEventTime();
            x = (int) e.getX();
            y = (int) e.getY();
            touchedPoint = map.getProjection().fromPixels(x, y);
        }
        if (e.getAction() == MotionEvent.ACTION_UP){
            stop = e.getEventTime();
        }
        if (stop - start > 1500){
            AlertDialog alert = new AlertDialog.Builder(MainActivity.this).create();
            alert.setTitle("Pick an Option");
            alert.setMessage("Option has been Picked");
            alert.setButton(DialogInterface.BUTTON_POSITIVE, "Place a pinpoint", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                //TODO Auto=generated method stub

                OverlayItem overlayItem = new OverlayItem(touchedPoint, "What's Up", "2nd String");
                CustomPinPoint custom = new CustomPinPoint(d, MainActivity.this);
                custom.insertPinpoint(overlayItem);
                overlayList.add(custom);
            }

            });
            alert.setButton(DialogInterface.BUTTON_NEUTRAL, "Address", new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which)
                {
                    //TODO Auto=generated method stub
                    Geocoder geocoder = new Geocoder(getBaseContext(), Locale.getDefault());
                    try{
                        List<Address> address = geocoder.getFromLocation(touchedPoint.getLatitudeE6() / 1E6, touchedPoint.getLongitudeE6() / 1E6, 1);
                        if (address.size() > 0){
                            String display = "";
                            for (int i = 0; i<address.get(0).getMaxAddressLineIndex(); i++){

                                display += address.get(0).getAddressLine(i) + "\n";
                            }
                        Toast t = Toast.makeText(getBaseContext(), display, Toast.LENGTH_LONG);
                        t.show();
                        }
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }finally{

                    }
                    }
                    });
                    alert.setButton(DialogInterface.BUTTON_NEGATIVE, "Toggle View", new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which) {
                    //TODO Auto=generated method stub
                    if (map.isSatellite()){
                        map.setSatellite(false);
                        }else{
                            map.setSatellite(true);
                        }
                }

                });
            alert.show();
            {
        return true;
        }
        }
        return false;
}
}
public void onLocationChanged(Location l) {
    // TODO Auto-generated method stub
    lat = (int) (l.getLatitude() *1E6);
    longi = (int) (l.getLongitude() *1E6);
    GeoPoint ourLocation = new GeoPoint(lat, longi);
    OverlayItem overlayItem = new OverlayItem(ourLocation, "What's Up", "2nd String");
    CustomPinPoint custom = new CustomPinPoint(d, MainActivity.this);
    custom.insertPinpoint(overlayItem);
    overlayList.add(custom);
}

public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}
  } 
```

对于我的 CustomPinPoint 类：

```
import java.util.ArrayList;

import android.content.Context;
import android.graphics.drawable.Drawable;

import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.OverlayItem;

public class CustomPinPoint extends ItemizedOverlay<OverlayItem>{

private ArrayList<OverlayItem> pinpoints = new ArrayList<OverlayItem>();
private Context c;

public CustomPinPoint(Drawable defaultMarker) {
    super(boundCenter(defaultMarker));
    // TODO Auto-generated constructor stub
}
public CustomPinPoint(Drawable m, Context context) {
    this(m);
    c = context;
    // TODO Auto-generated constructor stub
}
@Override
protected OverlayItem createItem(int i) {
    // TODO Auto-generated method stub
    return pinpoints.get(i);
}

@Override
public int size() {
    // TODO Auto-generated method stub
    return pinpoints.size();
}
public void insertPinpoint(OverlayItem item){
    pinpoints.add(item);
    this.populate();
}
} 
```

如果有人能指出我正确的方向或有一个关于锄头的教程，那将非常有帮助，因为从这一点开始，我已经完全陷入困境！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:40:15.137

编辑：我在您的 CustomPinPoint 类中看到您没有对 createItem 进行编程。从技术上讲，您的“CustomPinPoint”类是一个覆盖类；它是具有多个精确点的单层。您创建图层，并向该图层添加点。

用这个：

```
@Override
protected void createItem(Object o, Drawable d) {
OverlayItem i = new OverlayItem(<Geopoint location>,<name>,<title>);
i.setMarker(d);
pinpoints.add(i);  
} 
```

这将使用自定义标记为您的图层添加一个精确点。添加完所有图标后，您应该立即填充（）图层。

所以：

```
CustomPinPoint pinpoint = new CustomPinPoint(); 
```

[...] 在您的地图活动中

```
pinpoint.createItem(o, d); //Where o is the object info you want the marker to be about, and d is the custom drawable. 
```

[...] 在您的地图活动中

> ```
> map.getOverlays(pinpoint); 
> ```

类似的东西。我真的不擅长解释事情，但我希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T05:53:05.437

你可以使用这个库[——Android MapView Balloons](https://github.com/jgilfelt/android-mapviewballoons)。该项目提供了一种在使用 Android 地图时使用简单信息气球注释地图叠加项目的简单方法。

# html - 在现有代码中添加搜索表单

> ID：13351629
> 
> 赞同：-2
> 
> 时间：2012-11-12T21:12:14.307
> 
> 标签：html, css

我的网站上有一个 Megamenu，它适用于除 Google Chrome 之外的所有浏览器。它只是没有出现。

请在 Firefox 上查看主页上的标题，然后在 Google Chrome 中查看。

[网站](http://modatone.com)_

您会在 Chrome 中看到，菜单不存在，但在 Firefox 中存在。

你能明白为什么会这样吗？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:17:04.120

将您的更改`position:fixed`为`position:relative`on`<div id="megamenu"></div>`并显示。

看起来你的 CSS 为它周围的元素扔掉了它，所以这个小修复可能不会让两个浏览器中的所有东西看起来都一样。

# jsf-2 - 从输入文本向 selectManyMenu 添加项目

> ID：13351630
> 
> 赞同：0
> 
> 时间：2012-11-12T21:12:15.490
> 
> 标签：jsf-2

我想从 selectMany 中的输入文本中添加项目，因此我设法使用 ajax 标记将值带入支持 bean。selectManyMenu 值是一个 Map 变量。

但是当我将此代码放入使用 ajax 调用的方法中时，扇区是我添加项目的输入文本中的值。

```
public void addSector (){
    sectores.put(sector,sector);
    System.out.println(sector);
} 
```

但是来自 selectManyMenu 的视图不会添加项目。我想在输入文本中添加这些项目，有人可以给我提示，我很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T02:04:16.897

好的，所以我设法解决了这个问题，支持 bean 需要是**ViewScoped 或 SessionScoped**，这只是逻辑问题，我无法保留 previos 附加值，因为请求会话视图。

我希望这个发现对其他人有帮助！

# string - Delphi XE3：MarshaledString 和 MarshaledAString 用于什么新类型？

> ID：13351633
> 
> 赞同：6
> 
> 时间：2012-11-12T21:12:35.523
> 
> 标签：string, delphi, types, delphi-xe3

在Delphi XE3 中，许多以前定义为和现在的`Winapi.Windows.pas`C 类型分别定义为和（例如, ）：`PWideChar``PAnsiChar``MarshaledString``MarshaledAString``PWChar``LPSTR`

```
 PWChar = MarshaledString;
  LPSTR  = MarshaledAString; 
```

实际上，在`System.pas`和`MarshaledString`中`MarshaledAString`分别等价于`PWideChar`和`PAnsiChar`，

```
 MarshaledString  = PWideChar;
  MarshaledAString = PAnsiChar; 
```

但这个决定背后的背景是什么？我的意思是，为什么 Embarcadero*应该重新定义*这种 C 字符串类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T00:56:05.400

Embarcadero 正在开发用于移动开发的下一代编译器。您看到的变化与该努力有关。技术细节尚未公开，因此任何知道它的信息的人都不能进一步谈论它。

# java - Eclipse：.war 生成的依赖项

> ID：13351634
> 
> 赞同：1
> 
> 时间：2012-11-12T21:12:38.253
> 
> 标签：java, eclipse, dependencies, war, web-project

我有 3 个项目

1.  XXX.web : 一个动态 Web 项目
2.  XXX.persistence：一个普通的java项目
3.  XXX.t1：一个普通的java项目

项目 2 和 3 有其他依赖项，其中包含 jars。

Project1，XXX.web，已经导入了另外两个项目，XXX.presistence 和 XXX.t1，使用：

```
Right Click on XXX.web -> Build Path -> Configure Build Path -> Projects -> add -> XXX.t1 
```

和

```
Right Click on XXX.web -> Build Path -> Configure Build Path -> Projects -> add -> XXX.t1 
```

当我运行 XXX.web 时，Eclipse 解决了依赖关系（我认为在运行时，如果错误，请纠正我）。

但是，我想生成一个 .war 文件，以便我的 Web 项目（它依赖于其他两个项目）可以正常工作。eclipse 本身是不是这个，还是我必须手动将 t1 中的依赖 jars 和持久性复制到 web 的 lib 文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:25:34.907

使用 ant 构建您的战争文件。Ant 可以编译您的项目并从中构建战争。在这里查看更多信息：[如何创建战争文件](https://stackoverflow.com/questions/1001714/how-to-create-war-files)

# php - 尝试访问 phpmyadmin mb_detect_encoding 时出现 PHP 致命错误

> ID：13351635
> 
> 赞同：19
> 
> 时间：2012-11-12T21:12:39.267
> 
> 标签：php, phpmyadmin, fatal-error

不知道发生了什么，但以下是尝试访问 phpmyadmin 时日志给我的内容，请帮忙。试图调试一个不同的问题并遇到了这个问题。真的不可能恢复到它工作的时候。

> PHP 致命错误：在第 177 行的 /usr/share/php/gettext/gettext.inc 中调用未定义函数 mb_detect_encoding()

尝试访问该站点时，出现此错误，我认为这两个错误很可能是相关的：

> 数据库连接错误 (1): MySQL 适配器 'mysqli' 不可用。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-12T21:24:53.173

第一个错误是由 php 引起的，因为扩展 mbstring 未安装或未激活。

第二个错误是 phpMyAdmin/your site 的输出，要求您安装/启用 mysqli 扩展。

要启用 mbstring 和 mysqli，请编辑您的 php.ini 并在 unix 上使用 mbstring.so 和 mysqli.so 或在 windows 上使用 mbstring.dll 和 mysqli.dll 添加/取消注释这两行

Unix /etc/(phpX/)php.ini

```
extension=mysqli.so
extension=mbstring.so 
```

Windows PHP 安装文件夹\etc\php.ini

```
extension=mysqli.dll
extension=mbstring.dll 
```

在此之后不要忘记重新启动您的网络服务器。

编辑：用户在评论中补充说他正在使用 redhat 所以这里是你如何在所有基于 CentOS/Fedora/RedHat/Yum 的 linux 发行版上安装扩展

```
sudo yum install php-mysqli
sudo yum install php-mbstring

restart your werbserver
sudo /etc/init.d/httpd restart 
```

您可以使用文档根目录中的一个小 php 脚本来验证您的安装。这列出了您为 php 安装的所有设置、版本和活动扩展

测试.php

```
<?php
phpinfo(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-05T04:42:46.327

在阅读了关于 extension_dir = "ext" 的信息后，我将这一行添加到 php.ini 但没有用，然后开始查看 apache 错误日志，发现 PHP 实际上无法在指定目录 "ext" 中找到 dll。我评论了 extension_dir 行，重新启动 Apache 并再次查看错误日志，看到 PHP 现在正在 C:/PHP/ext 中查找 dll（我猜默认情况下），但由于我使用其他文件夹，这不是正确的路径，所以我取消了 extension_dir 行的注释并写了这个：

```
extension_dir = "C:/Apache24/PHP/ext" 
```

在我的配置中，这是 dll 的正确路径。

当然，未注释：

```
extension=php_mbstring.dll
extension=php_mysql.dll
extension=php_mysqli.dll 
```

重新启动 Apache 服务器和 Internet 浏览器，现在 phpMyAdmin 可以使用我的 mySQL 登录。

因此，dll 的错误路径和需要在 php.ini 中注释的 dll 是问题所在。

请记住在编辑配置文件后重新启动 Apache 和 Internet 浏览器。

系统规格：Windows 7 HB 64bit httpd-2.4.4-win32-ssl_0.9.8.zip php-5.4.16-Win32-VC9-x86.zip phpMyAdmin-4.0.4.1-all-languages.zip mysql-installer-community- 5.6.11.0.msi

希望这有帮助。谢谢你的评论。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-05-01T15:42:03.727

在 ubuntu 16.04 中，当我尝试连接到 phpmyadmin 时，出现了一个白色的空白页面，所以我运行了上述命令并且 phpmyadmin 工作

```
sudo apt-get install php-mbstring php7.0-mbstring php-gettext 
```

对于 mysql 支持安装

```
sudo apt-get install php7.0-mysql 
```

在 ubuntu 16.04 和 php 7 版本中测试

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-12T21:17:04.040

看起来您的 PHP 安装没有安装[mbstring 扩展](http://www.php.net/manual/en/mbstring.installation.php)和[mysqli 适配器扩展](http://www.php.net/manual/en/mysqli.installation.php)。

请检查您的`phpinfo();`或`php -i | grep 'mbstring\|mysqli'`在终端中运行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-24T09:30:29.793

我在 windows7-32 位上遇到了同样的问题：

> 1.“PHP 致命错误：在第 177 行的 /usr/share/php/gettext/gettext.inc 中调用未定义函数 mb_detect_encoding()”

当我打开我的 php.ini 文件时，“extension_dir”行如下所示：

```
extension_dir = "C:/wamp/bin/php/php5.4.16/ext/" 
```

我改为：

```
extension_dir = "C:\wamp\bin\php\php5.4.16\ext\" 
```

它奏效了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-15T04:37:57.273

在`php.ini`，我不得不改变

```
extension_dir = "ext" 
```

至

```
extension_dir = "C:/PHP/ext" 
```

因为我的 PHP 安装在`C:\PHP`. 我不得不使用，`/`而不是`\`，然后它工作。

也取消注释和`mbstrings`扩展。`mysqli``mysql`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-15T10:38:36.033

帮助我（在 Windows 上使用 XAMPP）是：

*   确保我的路径包含正确的 PHP 路径（我有两个 PHP 安装，一个在下面，另一个是我想使用`c:\php`的 XAMPP 安装 ）`c:\xampp\php`
*   检查
    `extension_dir="C:\xampp\php\ext"`
    `extension=php_mbstring.dll`
    `extension=php_exif.dll ; Must be after mbstring as it depends on it`
    php.ini 文件中的行是否未注释（即`;`开头没有）
*   重新启动 Apache 服务器
*   最后但同样重要的是，在重新加载页面时清除缓存`http://localhost/phpmyadmin/` （例如在 Chrome 中使用 Ctrl-F5）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-25T06:36:22.237

用 mbstring 重新编译 PHP。

`./configure --enable-http --with-apxs2 --with-mysql --with-gd --with-curl --with-mbstring`

```
make 

make install 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-12T21:19:58.807

尝试[安装](http://www.php.net/manual/en/mysqli.installation.php)mysqli 和 pdo。把它放在终端：

```
./configure --with-mysql=/usr/bin/mysql_config  \
--with-mysqli=mysqlnd \
--with-pdo-mysql=mysqlnd 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-26T03:09:20.363

我在 Windows 上尝试过，在启用此功能后遇到了同样的问题`PHP installation folder\etc\php.ini`：

```
extension=mysqli.dll 
extension=mbstring.dl 
```

您还应该在 ini 文件中启用以下功能：

```
extension_dir = "ext" 
```

phpMyadmin 正在工作！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-11T05:53:15.447

一种选择是：禁用此 extension_dir = "ext"

另一个是：

转到 wamp 图标并查看 php，然后单击 php 错误日志，然后从错误日志中您可以找到确切的错误。

仅当未正确设置路径时才会出现此错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-02T00:40:52.510

我遇到了同样的麻烦，这对我有用。

您可以单击 wampserver 图标，然后单击 PHP 错误日志。检查它是否这样说： `Unable to load dynamic library 'c:/wamp/bin/php/php5.5.12/ext/php_ldap.dll'`

如果是，那么您可以重新加载您的 PHP 版本，方法是单击 wampserver 图标，然后单击 PHP，然后单击版本，然后单击您的版本。等待一切再次上线，然后尝试访问 phpmyadmin。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-06T23:33:19.123

1.  某些版本的 Windows 不附带加载 mysql 和 mysqli 扩展所必需的 libmysql.dll。检查它是否在`C:/Windows/System32`（Windows 7、32 位）中可用。如果没有，您可以下载[DLL-files.com](http://www.dll-files.com/dllindex/dll-files.shtml?libmysql)并将其安装在 C:/Windows/System32 下。
2.  如果这种情况仍然存在，请检查您的 apache 日志文件并使用上述解决方案来响应您的服务器记录的错误。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-21T23:14:34.403

在 Windows 2008 服务器中。

我删除了 ”;” 在 php.ini 文件中的 extension=php_mbstring.dll 前面，它起作用了...我按照下面的链接...

[https://bugs.php.net/bug.php?id=64965](https://bugs.php.net/bug.php?id=64965)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-11-12T21:22:51.683

我的猜测是检查您的 PHP 配置中是否启用了 mysqli 扩展。更多信息会很棒（例如操作系统、AMP 堆栈等）。

检查 mysqli 的 php.ini 配置并确保没有 ';' 在扩展的前面。在我的设置中启用的是 php_mysqli_libmysql.dll。

# java - 结果在Android中不是随机的

> ID：13351637
> 
> 赞同：3
> 
> 时间：2012-11-12T21:13:11.870
> 
> 标签：java, android, encryption, private-key

我正在实现一个使用大量数字的加密算法，因此在制作 Java 应用程序时，我必须使用 BigInteger 类。

但是，当我尝试在 android 应用程序中实现相同的构造函数时

```
public BigInteger(int bitLength,int certainty,Random rnd), 
```

没有生成随机 BigInteger（一次又一次生成相同的整数 35879 :P）。在一个简单的 java 应用程序中成功生成了一个随机 BigInteger。

作为参考，

[http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html#constructor_detail](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html#constructor_detail)

另外，如果我导入 java.util.* 形式的东西，请告诉我，它是否可以在任何 android 应用程序中工作？

**如果 Android 不支持 BigInteger 或存在与支持的类似的任何其他类，请发表您的意见？？？**

这里方法 systemoutprintln() 用于将相应的字符串打印到布局中。

这是供您参考的代码，

```
public class keyGenerator {

/**
 * @param args the command line arguments
 */

  static  Vector check = new Vector();

  static protected BigInteger p= new BigInteger("161");
  static protected BigInteger q= new BigInteger("47");
  static protected Random s =new Random();
  static protected BigInteger n = new BigInteger("1");
  static protected BigInteger trails;
  static protected BigInteger lambda ;
  static protected BigInteger nsq  = new BigInteger("1");
  static protected BigInteger g = new BigInteger("1");
  static protected BigInteger temp = new BigInteger("1");
  static protected long timetkn;
  static protected View myview;
  static protected String[] printarray = new String[1000];
  static protected int ii=0;

static protected int maxbit;
private static BigInteger two = new BigInteger("2");

public keyGenerator() {

  //  Activity activity = new Activity();
// et.append("Second Part!!");
// EditText et = (EditText)activity.findViewById(R.string.second);
//    et.append("Working");

    long keyStart = SystemClock.uptimeMillis();
    p = new BigInteger(7,1,s);

            Systemoutprintln("Assumed p :" +p.toString());
  /*  while(!isPrime(p) && ( (p.compareTo(two)==1) || (p.compareTo(two))==0) )
    {
            p = new BigInteger(7,1,s);

    Systemoutprintln(p.toString());
    }*/

    Systemoutprintln("Assumed q :" +p.toString());
    q = new BigInteger(7,1,s); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:26:59.277

如果您查看[文档](http://developer.android.com/reference/java/math/BigInteger.html)，您会发现您正在调用的构造函数中的 rand 参数未使用。

`Implementation Note: the Random argument is ignored. This implementation uses OpenSSL's bn_rand as a source of cryptographically strong pseudo-random numbers.`

Perhaps remove it and supply null as the argument, or remove the certainty argument, in which case it will use your Random object (according to the docs.)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:24:06.990

根据[Random numbers](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#Random%28%29)上的 java 文档，这应该有效。但是，我注意到您使用两个不同的标签打印了两次 bigInteger p。您是否有可能将它们混合在一起？

编辑：在digitaljoel的帮助下，我发现了这个先前的任务：

[是否有与 OpenSSL 的 bn_rand_range 等效的 java？](https://stackoverflow.com/questions/9441598/is-there-a-java-equivalent-to-openssls-bn-rand-range)

本质上，您应该使用 SecureRandom，并使用那里给出的方法，即：

```
Random r = new SecureRandom();    
BigInteger q = something_big;
BigInteger ans;

do
    BigInteger(bits_in_q, r);
while (ans > q) 
```

# ios - 多个 CordovaWebviews，cordova.exec 在一个中定义，但在另一个中未定义

> ID：13351638
> 
> 赞同：1
> 
> 时间：2012-11-12T21:13:20.350
> 
> 标签：ios, cordova

我有一个使用多个 CordovaWebviews (CDDViewControllers) 的 iOS 项目，出于某种原因，cordova.exec 在主 webview (index.html) 中定义，但不在其他 webviews 中。有没有人遇到过这个问题？为什么有多个启用 Cordova 的 webviews 会像这样改变 cordova 全局变量？

我正在使用 Cordova 2.2.0rc2，这在 2.1.0 中不是问题

# authentication - 由于“无法加载主机密钥”，无密码 ssh 身份验证失败

> ID：13351640
> 
> 赞同：4
> 
> 时间：2012-11-12T21:13:32.863
> 
> 标签：authentication, permissions, ssh, private-key

无法设置 ssh 无密码身份验证

* * *

我无法通过 Windows 客户端的无密码身份验证 ssh 到 UBuntu 服务器。UBuntu 上的 ssh 版本是 OpenSSH_5.8p1 Debian-7ubuntu1, OpenSSL 1.0.0e ，而 Windows 客户端上的 SSH 版本是 OpenSSH_5.1p1, OpenSSL 0.9.8k。我打开 ssh 调试并注意到服务器和客户端上的这些消息：

```
/usr/bin/sshd -d -p 2222 on server

adminuser@server:~/.ssh$ /usr/sbin/sshd -d -p 2222

debug1: sshd version OpenSSH_5.8p1 Debian-7ubuntu1

debug1: could not open key file '/etc/ssh/ssh_host_rsa_key': Permission denied

Could not load host key: /etc/ssh/ssh_host_rsa_key

debug1: could not open key file '/etc/ssh/ssh_host_dsa_key': Permission denied

Could not load host key: /etc/ssh/ssh_host_dsa_key

debug1: could not open key file '/etc/ssh/ssh_host_ecdsa_key': Permission denied

Could not load host key: /etc/ssh/ssh_host_ecdsa_key

debug1: setgroups() failed: Operation not permitted

debug1: rexec_argv[0]='/usr/sbin/sshd'

debug1: rexec_argv[1]='-d'

debug1: rexec_argv[2]='-p'

debug1: rexec_argv[3]='2222'

Set /proc/self/oom_score_adj from 0 to -1000

debug1: Bind to port 2222 on 0.0.0.0.

Server listening on 0.0.0.0 port 2222.

debug1: Bind to port 2222 on ::.

Server listening on :: port 2222.

debug1: Server will not fork when running in debugging mode.

debug1: rexec start in 5 out 5 newsock 5 pipe -1 sock 8

debug1: inetd sockets after dupping: 3, 3

Connection from 10.221.84.65 port 2414

debug1: Client protocol version 2.0; client software version OpenSSH_5.1

debug1: match: OpenSSH_5.1 pat OpenSSH*

debug1: Enabling compatibility mode for protocol 2.0

debug1: Local version string SSH-2.0-OpenSSH_5.8p1 Debian-7ubuntu1

debug1: list_hostkey_types: 

No supported key exchange algorithms

debug1: do_cleanup

debug1: do_cleanup

ssh -vvv on client

C:\Documents and Settings\clientuser>ssh -vvv -p 2222 adminuser@server.com

OpenSSH_5.1p1, OpenSSL 0.9.8k 25 Mar 2009

debug2: ssh_connect: needpriv 0

debug1: Connecting to server.com port 2222.

debug1: Connection established.

debug1: identity file /cygdrive/c/Documents and Settings/clientuser/.ssh/identity type -1

debug3: Not a RSA1 key file /cygdrive/c/Documents and Settings/clientuser/.ssh/
id_rsa.

debug2: key_type_from_name: unknown key type '-----BEGIN'

debug3: key_read: missing keytype

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug3: key_read: missing whitespace

debug2: key_type_from_name: unknown key type '-----END'

debug3: key_read: missing keytype

debug1: identity file /cygdrive/c/Documents and Settings/clientuser/.ssh/id_rsa
type 1

debug1: identity file /cygdrive/c/Documents and Settings/clientuser/.ssh/id_dsa
type -1

debug1: Remote protocol version 2.0, remote software version OpenSSH_5.8p1 Debia
n-7ubuntu1

debug1: match: OpenSSH_5.8p1 Debian-7ubuntu1 pat OpenSSH*

debug1: Enabling compatibility mode for protocol 2.0

debug1: Local version string SSH-2.0-OpenSSH_5.1

debug2: fd 3 setting O_NONBLOCK

debug1: SSH2_MSG_KEXINIT sent

Read from socket failed: Connection reset by peer 
```

我验证了主机上的 authorized_keys、.ssh 等权限是正确的。我重新生成了主机密钥以绕过“无法加载主机密钥”并重新启动 ssh 服务，但问题仍然存在。关于什么可能是错的任何建议？主机私钥无法加载，因为它们归“root”用户所有。不允许将其权限更改为模式 600 以外的任何内容。我被困在这一点上..请帮忙！欣赏它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-05T06:31:28.643

您需要以 root 身份运行 SSH 服务器`sudo /usr/sbin/sshd`才能读取服务器的私钥。

# sql-server - 如果有重复记录，则增加 SQL 数据库中的列值

> ID：13351645
> 
> 赞同：3
> 
> 时间：2012-11-12T21:13:37.710
> 
> 标签：sql-server

我在数据库中有如下行：

```
DocumentNumber   LineNumber
1234             1
1234             1 
1453             1
1237             1
1677             1 
```

这些值已经存储在数据库中。如果有多个文档编号，我需要做的是将 linenumber 列增加 1。所以文档编号 1234 的行号为 1 和 2。

无论如何在更新声明中这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:16:11.143

如果您使用的是 SQL-Server 2005 或更高版本，您可以使用`ROW_NUMBER`：

```
WITH CTE AS
(
  SELECT DocumentNumber, LineNumber
     ,   RN = ROW_NUMBER() OVER (PARTITION BY DocumentNumber Order By DocumentNumber)
  FROM tableName
)
UPDATE CTE SET LineNumber = RN 
```

[**演示小提琴在这里**](http://sqlfiddle.com/#!6/9d086/1/0)

# java - 从左到右布局标签

> ID：13351646
> 
> 赞同：1
> 
> 时间：2012-11-12T21:13:39.370
> 
> 标签：java, swing, layout

我需要一些帮助来为我将在运行时添加标签的组件选择或创建布局。例如，组件大小为 400*50，应用程序启动时为空。然后一些动作将在位置 0 添加第一个标签，在第一个标签的宽度位置添加第二个标签，在第一个标签的宽度 + 第二个标签的宽度处添加第三个标签，依此类推。有点像，`FlowLayout`除了我希望我的标签从容器的左侧而不是中心开始。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:16:22.507

您可以使用[FlowLayout(FlowLayout.LEFT)](http://docs.oracle.com/javase/7/docs/api/java/awt/FlowLayout.html#FlowLayout%28int%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:15:29.570

只需使用`FlowLayout`and 调用`setAlignment(FlowLayout.LEFT);`（或使用采用对齐代码的构造函数之一）。

# c# - 如何在 XAML 中使用 C# 自定义子类？

> ID：13351652
> 
> 赞同：8
> 
> 时间：2012-11-12T21:13:49.597
> 
> 标签：c#, wpf, xaml, inheritance

这是我的问题：我想在 MyWindow 中使用 SurfaceInkCanvas 的子类。我创建了一个这样的 C# 类：

```
namespace MyNamespace
{
    public class SubSurfaceInkCanvas : SurfaceInkCanvas
    {
       private MyWindow container;

       public SubSurfaceInkCanvas()
           : base()
       {
       }

       public SubSurfaceInkCanvas(DrawingWindow d) : base()
       {
           container = d;
       }

       protected override void OnTouchDown(TouchEventArgs e)
        {
            base.OnTouchDown(e);     
        }
    }
} 
```

我想在我的 XAML 窗口中使用它。是这样的吗？

```
<MyNamespace:SubSurfaceInkCanvas
    x:Name="canvas"
    Background="White"
    TouchDown="OnTouchDown"/> 
```

我完全走错路了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:24:05.193

您需要导入 Xml 命名空间才能使用类...

```
<Window x:Class="Namespace.SomeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"> ... </Window> 
```

注意命名空间是如何被导入的。默认值（无前缀）可以是您想要的任何内容，但最好将其留给 Microsoft 的演示命名空间。然后是“x”命名空间，它是基本的 xaml 命名空间（当然您可以更改前缀，但您应该保持原样）。

因此，为了向其中添加您自己的命名空间，有两种方法（如果它是本地的，则为一种）。

*   CLR 命名空间：`xmlns:<prefix>="clr-namespace:<namespace>;Assembly=<assemblyName>"`
*   URI 命名空间：`xmlns:<prefix>="<uri>"`

在您的情况下，您可能希望将前缀设置为“本地”并使用 CLR 命名空间（因为它是您可以使用的全部）。

进口：`xmlns:local="clr-namespace:MyNamespace;Assembly=???"`
用途：`<local:SubSurfaceInkCanvas ... />`

* * *

或者，如果这些类位于外部库中，您可以将 CLR-Namespaces 映射到 XML-Namespaces ...请参阅[此答案](https://stackoverflow.com/a/5390146/347172)以获取相关说明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:21:18.167

您需要添加命名空间 (xmlns:myControls)，尝试如下：

```
<Window ...
        xmlns:myControls="clr-namespace:MyNamespace;assembly=MyNamespace"
        ...>
    <myControls:SubSurfaceInkCanvas x:Name="canvas"
                                    Background="White"
                                    TouchDown="OnTouchDown"/>
</Window> 
```

# ruby-on-rails - Rails 路由配置错误

> ID：13351653
> 
> 赞同：1
> 
> 时间：2012-11-12T21:13:58.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我收到以下错误

```
No route matches [POST] "/events" 
```

使用此设置：

### 配置/路由.rb

```
namespace :admin do
  #...
  resources :events
  #...
end 
```

* * *

### (...)admin/events_controller.rb

```
class Admin::EventsController < Admin::AdminController
  def index
    @events = Event.all
  end

  def new
    @event = Event.new
  end

  def create
    @event = Event.new(params[:event])

    if @event.save
      redirect_to [:admin, admin_events_url]
    else
      render :action => "new"
    end
  end

  def edit
    @event = Event.find(params[:id])
  end
end 
```

* * *

### (...)admin/events/_form.html.erb

```
<%= form_for([:admin, @event]) do |f| %> 
```

* * *

我无法弄清楚我做错了什么！

## 更新

当我在创建新事件条目时尝试发布数据时收到此错误

* * *

## 更新 2

里面的开始表单标签`events/new`：

```
<form accept-charset="UTF-8" action="/admin/events" enctype="multipart/form-data" id="new_event" method="post"> 
```

结果`rake routes`：

```
 admin_events GET    /admin/events(.:format)             admin/events#index
              POST   /admin/events(.:format)             admin/events#create 
```

导航到`/admin/events/`使用`GET`效果很好。

* * *

## 更新 3

它在 Ruby 1.9.3、Rails 3.2 和 Mongrel 的 Windows 8 x64 位上运行良好。它*不适*用于 Linux 服务器（主机）上的 Ruby 1.8.7、Rails 3.2 和 Phusion Passenger。

# 更新 4

哦。`multipart/form-data`如果您向它发送带有编码的表单，Rails 似乎不太高兴！删除文件上传解决了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:39:40.913

对于我来说，关于您的控制器的唯一值得怀疑的是您的重定向。你应该能够做到：

```
redirect_to admin_events_path 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:29:41.473

请尝试以这种方式设置您的表单：

```
form_for(@event, { url: admin_events_path, method: "POST" }) do 
```

# c# - 在 mvc 中更改下拉列表的控件 ID

> ID：13351657
> 
> 赞同：0
> 
> 时间：2012-11-12T21:14:19.887
> 
> 标签：c#, asp.net-mvc, razor

我有两个从 ViewData 中获取数据的下拉列表。viewData 包含一个 SelectedListItem，它是一组时间（下午 1 点、下午 2 点、下午 3 点......）时间与模型没有任何关系（因为我将其转换为 UTC）所以这就是我创建它的原因一个viewbag。我在视图中的两个位置使用了它，但是代码产生了相同的 ID

```
@Html.DropDownList("times",null,new {@class="ddl"})

<select class="ddl" id="times" name="times"><option value="0">1PM</option> 
```

我认为更改ID相对容易，我只是在 Html.DropDownList 中找不到确切的位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:41:48.930

更改第一个参数的值，即设置 ID

```
@Html.DropDownList("times1",null,new {@class="ddl"})

@Html.DropDownList("times2",null,new {@class="ddl"}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T12:05:42.770

此外，由于它会自动从 ViewBag 中选择名称，因此对于需要多次显示相同列表的情况，我们可能必须定义多个 ViewBag 属性，所有这些属性都引用相同的后端列表数据。

# java - 如何使用 Java/Android 使 int 出现在 Eclipse 中的 LogCat 中？

> ID：13351658
> 
> 赞同：2
> 
> 时间：2012-11-12T21:14:20.273
> 
> 标签：java, android, eclipse

这是我的 Xcode 和 iOS 代码：

```
NSLog(@"EAN-8: %d", finalNumber); 
```

我如何在 Java 上做同样的事情，让它出现在 LogCat 中？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:16:17.790

```
Log.d("MyApplication", String.format("EAN-8: %d", finalNumber)); 
```

第一个参数称为标签，如果需要，您可以使用它来过滤 Logcat 输出。有关更多信息/日志严重性，请参阅[文档](http://developer.android.com/reference/android/util/Log.html)。

# c++ - 我是否必须使用 weak_ptr.lock() 来测试它是否指向有效对象？

> ID：13351666
> 
> 赞同：9
> 
> 时间：2012-11-12T21:15:01.943
> 
> 标签：c++, shared-ptr, weak-ptr

必须创建一个临时的 shared_ptr 只是为了查看 weak_ptr 是否指向一个有效的对象，这似乎有点低效。我什至不想访问该对象。这是因为我有一个函数从 shared_ptr 的向量返回一个weak_ptr，如果它返回一个空的weak_ptr，那么这意味着该对象不存在该GUID。

所以我只是在测试一个对象是否存在。

有没有另一种方法来检查weak_ptr是否为空，而不创建shared_ptr？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-12T21:16:44.963

您可以使用[`expired()`](http://en.cppreference.com/w/cpp/memory/weak_ptr/expired)成员函数。

# python - 使用 Python 和 win32com 删除 Excel 图中的图例

> ID：13351668
> 
> 赞同：1
> 
> 时间：2012-11-12T21:15:06.497
> 
> 标签：python, excel

我的 Python 脚本将数据放入 Excel 工作表并在同一个工作表上绘制我想要的数据。有谁知道我如何删除/隐藏情节中的图例并调整情节的大小？这是我目前的代码：

```
chart = xlApp.Charts.Add()
series = chart.SeriesCollection(1)
series.XValues = xlSheet.Range("L13:L200")
series.Values = xlSheet.Range("M13:M200")
series.Name = file
chart.Location(2, xlSheet.Name) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:31:56.963

弄清楚 Excel COM API 的第一步是记录一个执行您想要执行的操作的宏并检查它。

我录制了一个删除图例并调整图表大小的宏，这是生成的 VBA：

```
Sub Macro3()
'
' Macro3 Macro
'

'
    ActiveChart.Legend.Select
    Selection.Delete
    ActiveSheet.ChartObjects("Chart 1").Activate
End Sub 
```

遗憾的是，它没有记录图表的大小调整，但确实记录了删除图例。这是翻译成 Python 的 VBA：

```
chart.Legend.Delete() 
```

幸运的是，Google 为我们提供了[如何使用 VBA 更改图表的大小或位置？](http://peltiertech.com/Excel/ChartsHowTo/ResizeAndMoveAChart.html)翻译成 Python：

```
chart.Parent.Height = new_height
chart.Parent.Width = new_width
chart.Parent.Top = v_position
chart.Parent.Left = h_position 
```

**编辑**：这是一个在 Excel 2003 下执行所有这些操作的简短脚本。

```
import win32com.client
import re

xl = win32com.client.Dispatch('Excel.Application')
xl.Visible=True
wb = xl.Workbooks.Add()
ws = wb.Sheets(1)
values = [['a','b','c'],
          [ 1,  2,  3 ],
          [ 4,  5,  6 ]]
for nrow, row in enumerate(values):
    for ncol, item in enumerate(row):
        xl.Cells(nrow+1, ncol+1).Value = item

xl.Range("A1:C3").Select()
chart = xl.Charts.Add()

# chart.Legend.Delete only works while it's a chart sheet.
# so get this done before changing the chart location!
chart.Legend.Delete()

# Excel changes the name of the chart when its location is changed.
# The new name inserts a space between letters and numbers.
# 'Chart1' becomes 'Chart 1'
new_chart_name = re.sub(r'(\D)(\d)', r'\1 \2', chart.Name)
chart.Location(2, ws.Name)

# After changing the location the reference to chart is invalid.
# We grab the new chart reference from the Shapes collection using the new name.
# If only one chart is on sheet you can also do: chart = ws.Shapes(1)
chart = ws.Shapes(new_chart_name)

chart.Top = 1
chart.Left = 1
chart.Width = 500
chart.Height = 400 
```

# sql - 在 Sql 中使用 UNIQUE

> ID：13351670
> 
> 赞同：0
> 
> 时间：2012-11-12T21:15:18.680
> 
> 标签：sql

`GROUP BY`我用这样的and`HAVING`子句写了一个“查找只做了一次预订的 sids”查询：

```
SELECT
  R.sid 
FROM
  Sailors S,
  Reserve R 
WHERE  
  R.sid = S.sid 
GROUP BY 
  R.sid 
HAVING 
  Count(R.sid) = 1 
```

但我也想通过使用`unique`命令找到它。我的朋友问我，但我无法解决。我们不使用分组依据。我们以独特的方式解决它。我试过了，但我无法解决。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:17:40.047

`SELECT UNIQUE`不做你想做的事。在 Oracle 中，它与`SELECT DISTINCT`. 它没有找到唯一的行。它会删除重复项。

你必须使用`GROUP BY ... HAVING ...`.

# sql - SQL 根据多个子表行更新父表字段

> ID：13351679
> 
> 赞同：2
> 
> 时间：2012-11-12T21:15:33.743
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有以下用于`parent`/`child`关系的示例表结构。

`parent`桌子

```
id    LongText
--------------
10    
20 
```

`child`桌子

```
id    char     value
--------------------
10    COLOR    RED
10    HEIGHT   1FT
20    COLOR    BLUE
20    WIDTH    2FT 
```

我有一个要求，指定子表行中的某些字段需要连接在一起并放置在父表中。*如果可能*，我想在单个 SQL 查询中完成此操作。我写的更新声明如下。

```
UPDATE
  parent
SET
  LongText = COALESCE(LongText, N'')
              + child.char + N': ' + child.val + ','
FROM
  parent INNER JOIN child
    ON
      parent.id = child.id 
```

但我只得到以下结果。

```
id    LongText
------------------
10    COLOR: RED,
20    COLOR: BLUE, 
```

我希望（或者我应该说我*想要*）得到这个。

```
id    LongText
------------------
10    COLOR: RED,HEIGHT: 1FT
20    COLOR: BLUE,WIDTH: 2FT 
```

这可能吗？关于我如何做到这一点的任何建议？任何帮助表示赞赏！

这是一个[SQLfiddle](http://www.sqlfiddle.com/#!3/7e108/4)供参考。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:20:51.997

```
update parent
set longtext =
    stuff((
    select ',' + c.char + ': ' + c.val
    from child c
    where c.uid = parent.uid
    for xml path(''), type).value('.','nvarchar(max)'),1,1,''); 
```

我已经用解决方案更新了你的[SQLFiddle](http://www.sqlfiddle.com/#!3/7e108/16/1)。

1.  [STUFF()](http://msdn.microsoft.com/en-us/library/ms188043.aspx)`','`函数从第一个特征中删除前导（逗号）。

2.  [FOR XML](http://msdn.microsoft.com/en-us/library/ms178107.aspx)从查询结果创建 XML 文档。这是 SQL Server 的一个众所周知的技巧 - 因为没有命名列，所以没有生成任何元素，并且只输出（每一行的）原始文本，将它们混合成一行。

互联网上很少有文章试图详细解释它，因为代码本身几乎是作为解释留下的。

# sql - 如何通过传递地址获取经纬度详细信息

> ID：13351685
> 
> 赞同：0
> 
> 时间：2012-11-12T21:15:49.240
> 
> 标签：sql, db2, talend

我在一个表（DB2 数据库）中有地址`field_1`,`Feils_2`和`city_name`, `Country_name`，我需要根据地址进行填充和填充。`Zip_code``Customer``Latitude``Longitude`

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:19:33.287

使用 googlemaps 网络服务，但您每天可以查找的数量是有限制的，而无需支付帐户费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T19:57:25.690

此地理参考信息在 DB2 中不可用（从地址检索一对坐标）。您可以在用 Java 或 C 实现的 DB2 中创建函数，并使用这些函数查询具有此信息的外部系统。一旦函数获得坐标，就可以将其传递给 DB2。

上一个回答，推荐使用GoogleMaps，但是没有说明如何从DB2中使用。使用我的解决方案，您可以在 DB2 中创建一个 Java 函数，该函数将查询 GoogleMaps API 以检索坐标。但是，并非所有国家/地区都在 GoogleMaps 数据库中，您可能需要使用另一个地理参考系统。

# flash - flash builder 4.6 和 sqlite 位置

> ID：13351689
> 
> 赞同：0
> 
> 时间：2012-11-12T21:16:17.157
> 
> 标签：flash, sqlite, location, directory, builder

我正在使用带有嵌入式 sqlite 数据库的 Flash builder 4.6 为 iPad 3rd 开发应用程序。在编译程序之前，我在资产文件夹中复制了数据库：在模拟器上一切正常，但在 iPad 上程序无法无错误地检索数据。这是打开数据库的指令：

stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("/Users/me/Downloads/test.sqlite"));

也尝试更改为

stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("assets/test.sqlite"));

并且，经过测试，再次更改为

stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("test.sqlite"));

但没有运气：我做错了什么？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:36:14.033

我回答自己：放在所有人面前

```
var dbFile:File = File.applicationDirectory.resolvePath("db/test.sqlite");
var dbWorkFile:File = File.documentsDirectory.resolvePath("test.sqlite");

if(!dbWorkFile.exists){
    dbFile.copyTo(dbWorkFile);
} 
```

连接必须在

```
stmt.sqlConnection.open(File.documentsDirectory.resolvePath("test.sqlite")); 
```

[在http://cookbooks.adobe.com/post_Including_a_database_in_an_Adobe_AIR_application-17721.html](http://cookbooks.adobe.com/post_Including_a_database_in_an_Adobe_AIR_application-17721.html)上找到的提示

# c++ - DLL 注入仅在未从 Visual Studio 启动时才有效

> ID：13351691
> 
> 赞同：3
> 
> 时间：2012-11-12T21:16:18.017
> 
> 标签：c++, visual-studio-2010, dll, dll-injection

我正在尝试使用 CreateRemoteThread 将 DLL 注入现有进程。问题是当应用程序从 Visual Studio 2010 中启动时，它根本不起作用。

DLL 注入的工作原理：

1.  手动启动时（从资源管理器）

2.  当手动启动它并在注入前附加 VS 2010 调试器时。

当我选择：在 Visual Studio 2010 中开始调试 (F5) 时，CreateRemoteThread 返回 OK。我什至在注入过程中在 LoadLibraryA 上放置了一个断点，它被命中了。所以**线程启动了，但它没有到达 DllMain**函数。LoadLibraryA 被执行，但模块不会被加载。

注入代码：

```
void InjectDll(DWORD processId, string dllFile)
{
    HANDLE hProcess = OpenProcess(CREATE_THREAD_ACCESS, FALSE, processId);
    if ( hProcess != NULL )
    {
        int lenWrite = dllFile.length();
        LPVOID allocMem = (LPVOID)VirtualAllocEx(hProcess, NULL, lenWrite, MEM_RESERVE|MEM_COMMIT, PAGE_READWRITE);
        WriteProcessMemory(hProcess, allocMem , dllFile.c_str(), lenWrite, NULL);
        LPTHREAD_START_ROUTINE injector = (LPTHREAD_START_ROUTINE) GetProcAddress(GetModuleHandle("kernel32.dll"), "LoadLibraryA"); 

        if(!injector)
            return;
        DWORD threadId;
        HANDLE hThread = CreateRemoteThread(hProcess, NULL, 0, injector, allocMem, 0, &threadId);

        DWORD Result = WaitForSingleObject(hThread, 10*1000); //Time out : 10 secondes
        VirtualFreeEx(hProcess, allocMem, lenWrite, MEM_RELEASE);
        CloseHandle(hProcess);
        CloseHandle(hThread);
    }
} 
```

和 DllMain 代码：

```
BOOL APIENTRY DllMain(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved)
{
    switch (ul_reason_for_call)
    {
        case DLL_PROCESS_ATTACH:
            HelloWorldMessageBox();
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
            break;
    }
    return TRUE;
} 
```

感谢帮助！

**编辑：**

我使用 ollyDbg 在 LoadLibraryA 上放置断点。我已将汇编指令“ret”替换为对 GetLastError 的调用，并且在 EAX 寄存器中得到以下值：126。从 MSDN 系统错误代码 126 表示 ERROR_MOD_NOT_FOUND（找不到指定的模块。）。很奇怪，它只在 Visual Studio 运行注入应用程序时发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:31:33.303

终于我发现了问题！

获取我使用的完整模块路径

```
GetFullPathName("Inj_DLL.dll", MAX_PATH, dll_path, NULL); 
```

它使用当前工作目录来确定文件路径。

当我手动启动应用程序时，工作目录是 exe 文件的路径，但是当它从 Visual Studio 启动时，它使用项目属性->配置属性->调试中的工作目录。

由于默认设置为“$(ProjectDir)”，并且注入的dll在Debug/Release目录下，所以找不到dll文件，所以报错126 ERROR_MOD_NOT_FOUND。

我已将此属性更改为“$(SolutionDir)$(Configuration)\”，现在一切都像魅力一样。

感谢任何试图帮助我解决这个问题的人，我发现了一些调试非工作应用程序的新方法。

# python - Django：实现嵌套的、可重用的组件设计

> ID：13351694
> 
> 赞同：8
> 
> 时间：2012-11-12T21:16:22.953
> 
> 标签：python, django, django-views

我正在 Django 中开发一个大型社交网络应用程序，我希望在其中多次使用某些前端组件，并且通常以这样的方式设计功能，即自定义组件包含其他自定义组件，这些自定义组件可能包含更小的子组件（广告无限）。所有这些组件通常都是动态生成的。我正在尝试找出在 Django 框架中构建它的最佳方法，以便我的组件易于维护并具有清晰的编程接口。严重依赖全局上下文似乎与此相反，但是，我可以看到通过在视图中一次完成所有查询来避免冗余查询的优势。

自定义包含模板标签似乎非常适合实现组件，但我想知道，高度嵌套的模板标签会产生性能问题，还是解析架构会阻止这种情况？在视图级别使其自我记录的最佳方式是什么？渲染主页模板、自定义标签和所有内容需要什么上下文？我认为尝试正确维护代码以设置模板上下文将是一场小噩梦。最后，为这些组件维护 CSS 的最佳方式是什么？

随意提出其他推荐的方法来创建嵌套组件设计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T08:54:03.170

到目前为止，我决定的解决方案是继续使用包含标记库作为我的可重用组件集。我尽可能坚持在我的视图代码中设置所有查询，并在我的上下文中将它们传递给预先设置——没有在模板或标记库代码中生成新查询的函数。包含模板包含项目的所有标记，样式进入主站点样式表，使我的类尽可能通用和可重用，遵循[SMACSS](https://smacss.com/)的指导方针。我仅在 DRY 需要时将组件重构为包含标签。

我最初使我的包含标记函数显式地采用标记模板使用的参数，例如：

**页面模板**

```
<div>{% my_tag param1 param2 %}</div> 
```

**标签库**

```
@register.inclusion_tag('myapp/tagtemplates/my_tag.html')
def my_tag(param1, param2):
    return {'param1': param1, 'param2': param2} 
```

**my_tag.html**

```
<div>Blah: {{ param1 }}</div>
<div>Blip: {{ param2 }}</div> 
```

...显然视图设置了上下文。

但我决定改为使用`takes_context`参数来避免在标记库中显式定义参数。过多的重复导致文档中没有足够的回报。到目前为止，我的组件非常简单，从标签模板的检查中可以清楚地看到依赖关系。我担心这对于复杂的嵌套组件可能是不可接受的，但我总是可以让我的标签库函数在需要的地方变得冗长。

从维护的角度来看，我对这种设置并不完全满意。我不喜欢这样，我将不得不手动跟踪不再需要的上下文数据。我不喜欢我的 CSS 类必须仔细命名以避免冲突的事实。

我仍然对新的解决方案持开放态度，因为我不确定我所决定的是否真的是最佳实践。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T12:26:04.703

这是一个有趣的问题。理想情况下，您应该在渲染之前从数据库中提取所有组件。但是从层次结构来看，制作模板标签是有道理的。这些模板标签将提取适当的数据。出于此问题的目的，假设数据库查询由于搜索局部性而被缓存。

# google-apps-script - 关闭通过脚本接受 Google 表单上的回复

> ID：13351706
> 
> 赞同：2
> 
> 时间：2012-11-12T21:17:17.943
> 
> 标签：google-apps-script

有没有办法通过 Google Apps 脚本以编程方式关闭标准 Google 表单的接受响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-07T13:45:32.273

是的，您可以，但仅适用于旧的 Google 表单。这是一个说明：[http ://cloudlab.newvisions.org/scripts/formlimiter](http://cloudlab.newvisions.org/scripts/formlimiter)

它可以根据响应的数量、时间/日期以及可能非常方便：特定的单元格值来限制响应。这样，您可以例如添加一列（例如“您的组有多少人”）并使用 SUM 单元格值来关闭表单）

是时候有人在新表单中让这一切成为可能（最好是作为常规功能）......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T14:25:52.903

最近发布的表单服务通过[setAcceptingResponses()](https://developers.google.com/apps-script/reference/forms/form#setAcceptingResponses%28Boolean%29)函数提供了此功能。

# delphi - WebBrowser 和 Delphi 2007 的 OLE 控制窗口句柄错误

> ID：13351714
> 
> 赞同：0
> 
> 时间：2012-11-12T21:17:51.247
> 
> 标签：delphi, webbrowser-control, delphi-2007, twebbrowser

几周前我遇到了一个似乎没有合乎逻辑的解释的问题。我正在使用 AlphaControls 和放置在表单上的 WebBrowser 组件使用 Delphi 2007 构建应用程序。从 Web 获取横幅并将其`TWebBrowser`显示到 UI 中。不好的是，一旦显示带有横幅的表单，我就会得到“**无法获得 OLE 控制窗口句柄**”，而浏览器正在表单外显示，在桌面的左上角。

我一直在尝试基本上任何事情来解决这个问题，但是调试器没有提供太多关于正在发生的事情的信息（这就是我得到的全部信息：$ 770C4B32的第一次机会异常。`EOleError`带有消息'无法获得OLE控制窗口句柄的异常类'. 处理 project1.exe (3700))。有趣的是，`TWebBrowser`新项目的 Form1 上的相同工作没有任何问题。

对此的任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:32:47.097

它是由 html 表单被关闭引起的。供应商的论坛显示了一些可以解决问题的代码。 [http://www.bsalsa.com/forum/showthread.php?t=255](http://www.bsalsa.com/forum/showthread.php?t=255)

> 在 OnWindowClosing 事件中将 Cancel 设置为 True，如果它是主 Web 浏览器，则导航到一个空页面。如果您的网络浏览器是一个弹出窗口，您可能需要关闭 EWB 所在的表单。

```
procedure TForm2.EmbeddedWB1WindowClosing(ASender: TObject; IsChildWindow: WordBool; var Cancel: WordBool);
begin
  Cancel := True;
  (ASender as TEmbeddedWB).GoAboutBlank;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-15T16:44:34.207

TWebBrowser 仍然被关注`ActiveControl`并且`TOleControl.HookControlWndProc`正在被调用，`ActiveControl`它不再在内存中。结果`EOleError`引发异常，因为无法获取窗口句柄。您可以通过在关闭应用程序之前设置`ActiveControl`为（更改活动控制焦点）来避免这种情况。`nil`

```
 ActiveControl := nil; 
```

这是导致异常的函数（OleCtrls.pas）：

```
procedure TOleControl.HookControlWndProc;
var
  WndHandle: HWnd;
begin
  if (FOleInPlaceObject <> nil) and (WindowHandle = 0) then
  begin
    WndHandle := 0;
    FOleInPlaceObject.GetWindow(WndHandle);

    // Exception is raised here because WndHandle could not be obtained
    if WndHandle = 0 then raise EOleError.CreateRes(@SNoWindowHandle);

    WindowHandle := WndHandle;
    DefWndProc := Pointer(GetWindowLong(WindowHandle, GWL_WNDPROC));
    CreationControl := Self;
    SetWindowLong(WindowHandle, GWL_WNDPROC, Longint(@InitWndProc));
    SendMessage(WindowHandle, WM_NULL, 0, 0);
  end;
end; 
```

另一种方法是在将销毁消息发送到 TWebBrowser 句柄时`WM_PARENTNOTIFY`使用参数捕获消息，`WM_DESTROY`因为父表单（嵌套 TWebBrowser 的地方）收到一条`WM_PARENTNOTIFY`消息：

```
procedure ParentNotify(var Msg: TMessage); message WM_PARENTNOTIFY; 
```

消息处理程序的实现：

```
procedure TMyForm.ParentNotify(Var Msg: TMessage);
begin
if (Msg.WParamLo = WM_DESTROY) and (Msg.LParam = mywebbrowser.Handle) then close;
end; 
```

# php - 从 mysql 数据库中提取 5 条随机记录

> ID：13351718
> 
> 赞同：-3
> 
> 时间：2012-11-12T21:18:16.950
> 
> 标签：php, mysql, random

我正在尝试编写一个 php / mysql 脚本，该脚本将从数据库中提取 5 条随机记录并显示它们。目前，我正在使用以下方法将一条记录拉出并显示在一个模块中，但我不确定如何一次仅拉出 5 条。我将在数据库中总共有大约 200-300 条记录。

我目前正在使用以下代码随机拉出单个记录：

```
<?php
$result = mysql_query("SELECT * FROM `zgjzb_chronoforms_data_submitbusiness` ORDER BY     RAND() LIMIT 0,4;");
$row = mysql_fetch_array($result);
?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T21:22:33.213

你不想使用`ORDER BY RAND()`. MySQL 必须建立一个临时表。如果你的表有一个唯一的 id 列，这样的事情会更好：

```
SELECT * FROM `zgjzb_chronoforms_data_submitbusiness` 
WHERE id >= (SELECT FLOOR( MAX(id) * RAND()) FROM `table` )
ORDER BY id LIMIT 1; 
```

有关在 php 中运行良好的其他方法，请参阅[此博客文章](http://akinas.com/pages/en/blog/mysql_random_row/)。

# javascript - .js 脚本添加的额外字符

> ID：13351722
> 
> 赞同：7
> 
> 时间：2012-11-12T21:18:33.290
> 
> 标签：javascript, jquery, character-encoding, currency

使用 jQuery 和 formatCurrency 扩展如下：

```
 $(function() {
            $(".currency").blur(function(){ formatCurrencyInput(this) });
        });

        function formatCurrencyInput(input) {
            if($(input).val() != '') {
                if(isNumeric($(input).val())) {
                    $(input).formatCurrency(null,{groupDigits:false,roundToDecimalPlace:2,symbol:'£'});
                    $(input).css('border-color', '');
                }
                else {
                    $(input).css('border-color', '#FFCCCC');
                }
            }
        } 
```

例如，我所有带有“货币”类的文本输入都是从 45 => £45.00 转换而来的。

奇怪的是，如果 formatCurrencyInput 函数在部分中定义它工作正常。如果我将该函数外部化到一个 .js 文件中，它会返回 45.00 英镑（注意 Â 字符）。我想这是一个字符编码问题，但我该如何解决呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T21:20:07.017

尝试：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
    </head>
... 
```

您也可以尝试更改`£`为`&pound;`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T21:44:46.077

如果您在 JavaScript 文件中使用任何非 Ascii 字符，则应确保服务器为其发送正确的 HTTP 标头，以识别字符编码。其他方法，例如用于引用文件`charset`的元素中的参数`script`，或依赖浏览器以某种方式默认编码（例如，来自引用的 HTML 文档），可靠性较低。

但是，如果字符串文字中只有一个非 Ascii 字符，最简单的方法是转义它。井号“£” U+00A3 可以在字符串文字内转义为 as`\xA3`或 as `\u00A3`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-09T23:50:08.100

非 ASCII 字符之前的意外`Â`和`Ã`符号几乎总是意味着：

*   [您保存了一些使用UTF-8](https://en.wikipedia.org/wiki/UTF-8)编码的文本
*   您正在阅读该文本，就好像它是以（通常所说的）[拉丁 1 编码进行编码的](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)

[发生这种情况是因为您会遇到的大多数非 ASCII 字符（至少如果您正在处理使用源自罗马字母](https://en.wikipedia.org/wiki/Latin_alphabet)的语言编写的文本，例如西欧的语言）属于[拉丁 1 unicode块](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block))（包括`£`和大多数重音或修改版本的英文字母，如`é`and ），而 UTF 8 使用以字节或.`æ`开头的两字节序列对该块的所有成员进行编码。但是，这些字节分别代表和latin 1 编码。`C2``C3``Â``Ã`

Python shell 中的快速演示：

```
>>> b'\xc2'.decode('latin1')
'Â'
>>> '£'.encode('utf8')
b'\xc2\xa3'
>>> '£'.encode('utf8').decode('latin1')
'Â£'
>>> 'æ'.encode('utf8')
b'\xc3\xa6'
>>> 'æ'.encode('utf8').decode('latin1')
'Ã¦' 
```

如果这些意外字符出现在您的 JavaScript 中，那么一定是出了问题的是您已经保存了 UTF-8 编码的 JavaScript 文件，但浏览器认为它是 latin1 编码的，因此在解码后得到了错误的字符。

要解决此问题，请确保使用 HTTP 标头正确指定 JavaScript 文件的编码，例如：

```
content-type: text/javascript; charset=utf-8 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-01T13:31:34.400

只需将 charset="UTF-8" 添加到脚本标记即可。 **例如**

```
<script src="myJSFile.js" charset="UTF-8"></script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-06-09T22:38:33.280

```
 var poundSign = '\xA3';

   var dollars = "OK, gonna exchange $ " + dollarsToExchange + " for " + poundSign + guineas ; 
```

# c# - 以编程方式将绑定的 Gridview 添加到 tabPanels

> ID：13351731
> 
> 赞同：1
> 
> 时间：2012-11-12T21:19:23.383
> 
> 标签：c#, asp.net, visual-studio-2010, gridview, tabpanel

我想以`GridView`编程方式在`TabPanel`. 事实上，选项卡面板本身是通过编程方式创建的，所以我想`GridView`为每个`TabPanel`.

这是创建选项卡面板的代码：

```
while (j < l.Count)
{
    AjaxControlToolkit.TabPanel panel = new AjaxControlToolkit.TabPanel();               
    panel.HeaderText = testrub.RubricName.ToString();       
    GridView grid = new GridView();
    grid.DataSource = element.GetElementByRubric(testrub.ID);
    panel.Controls.Add(grid);
    TabContainer1.Tabs.Add(panel);                
    j++;
} 
```

如您所见，我要创建的 gridview 是数据绑定的。我会非常感谢一些帮助。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:34:02.723

将这一行添加到您的代码中

```
GridView grid = new GridView();
grid.DataSource = element.GetElementByRubric(testrub.ID);
grid.DataBind();  //  <------ this new line 
```

# ios - UIView animateWithDuration 导致应用程序崩溃

> ID：13351740
> 
> 赞同：0
> 
> 时间：2012-11-12T21:20:24.390
> 
> 标签：ios, animation, uiview, segmentation-fault

我的代码片段如下。这会导致应用程序崩溃。奇怪的是，该应用程序仅在我创建档案并将档案加载到我的设备上时才会崩溃。如果我直接从 XCode 在设备上运行它，它运行良好。

```
for (int i = 0; i < 8; i++) {
    for (int j = 0; j < 12; j++) {
        UILabel *label = (UILabel *)[self.view viewWithTag:((j+1) * 10 + (i+1))];
        [UIView animateWithDuration:1.0
                         animations:^{
                             label.alpha = 0.0f;
                             label.text = [cryptograms objectAtIndex:i * 12 + j];
                             label.alpha = 1.0f;
                         }];
    }
} 
```

但是，如果我使用以下代码片段创建存档，则可以正常工作。

```
for (int i = 0; i < 8; i++) {
    for (int j = 0; j < 12; j++) {
        UILabel *label = (UILabel *)[self.view viewWithTag:((j+1) * 10 + (i+1))];
        [label setText:[cryptograms objectAtIndex:i * 12 + j]];

    }
} 
```

我已经验证问题不在于数组的大小。数组总是有 96 个元素。崩溃日志显示以下内容..

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x00000017
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libobjc.A.dylib                 0x37148584 _cache_getImp + 4
1   libobjc.A.dylib                 0x37148fa0 lookUpMethod + 24
2   libobjc.A.dylib                 0x3714a1e2 class_respondsToSelector + 26
3   CoreFoundation                  0x382c3638 ___forwarding___ + 372
4   CoreFoundation                  0x3821b204 _CF_forwarding_prep_0 + 20
5   GridSoftToken                   0x000990ae __41-[ViewController updateCryptogramLabels:]_block_invoke_0 (ViewController.m:69)
6   UIKit                           0x375bae80 +[UIView(UIViewAnimationWithBlocks) _setupAnimationWithDuration:delay:view:options:animations:start:completion:] + 492
7   UIKit                           0x37672172 +[UIView(UIViewAnimationWithBlocks) animateWithDuration:animations:] + 54
8   GridSoftToken                   0x0009903c -[ViewController updateCryptogramLabels:] (ViewController.m:66)
9   GridSoftToken                   0x00098dc2 -[ViewController viewDidAppear:] (ViewController.m:44)
10  UIKit                           0x3760b2c8 -[UIViewController _setViewAppearState:isAnimating:] + 132
11  UIKit                           0x37627f24 -[UIViewController _executeAfterAppearanceBlock] + 48 
```

关于如何解决此问题的任何想法？我显然可以摆脱动画，但我想保留它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:34:36.297

**1：**将您的逻辑**放在**动画块中，反之亦然。

`SIGSEV`意味着您的程序尝试在为其分配的内存之外进行读取或写入。我很难在你的代码中看到它的原因。我可能是带有标签的东西，或者由于您同时创建了很多动画，所以动画的范围会以某种方式混淆。

**2：**您的 alpha 更改代码...

```
label.alpha = 0.0f;
label.alpha = 1.0f; 
```

...不会有任何影响，因为您在同一动画中更改了 alpha。
如果您不想将其设置回 1.0f，请在*完成*块中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:35:10.927

使用@yinkou 将逻辑放在动画块中的建议，我重新编写了代码，现在它运行没有任何问题。附上修改后的代码以供参考。希望它会帮助别人。我仍然不确定为什么这有效而以前的版本无效，但就像@yinkou 建议的那样，可能与大量同时动画有关！

```
[UIView animateWithDuration:1.0
                 animations:^{
                     for (int i = 0; i < 8; i++) {
                         for (int j = 0; j < 12; j++) {
                             UILabel *label = (UILabel *)[self.view viewWithTag:((j+1) * 10 + (i+1))];
                             [label setAlpha:0.0f];
                             [label setText:[cryptograms objectAtIndex:i * 12 + j]];
                             [label setAlpha:1.0f];
                         }
                     }
                 } completion:^(BOOL finished) {
                     if (finished) {
                         ...
                     }
                 }]; 
```

# perl - Perl Regex 匹配超过 2 个字符的单词

> ID：13351748
> 
> 赞同：0
> 
> 时间：2012-11-12T21:20:57.057
> 
> 标签：perl

我是 PERL 的新手，正在使用正则表达式来匹配等于或超过 3 个字母的单词。这是我正在尝试的程序。我尝试添加 \w{3,} 因为它应该匹配更多的 3 个字符。但它仍然匹配一个单词中的 <3 个字符。例如，如果我给出“这是一个模式”。我希望我的 $field 只匹配“This”和“Pattern”并跳过“is”和“a”。

```
#!/usr/bin/perl
     while (<STDIN>) {
           foreach my $reg_part (split(/\s+/, $_)) {
                if ($reg_part =~ /([^\w\@\.]*)?([\w{3,}\@\(\)\+\$\.]+)(?::(.+))?/) {
                        print "reg_part = $reg_part \n";
                        my ($mod, $field, $pat) = ($1, $2, $3);
                        print "#$mod#$field#$pat#$negate#\n";
                }
        }
}

exit(0); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:31:08.230

打破你的正则表达式。

你知道你想要三个单词字符，所以指定：-

```
# Match three word characters.

\w{3} 
```

在那之后，你真的不在乎这个词是否有更多的字符，但你也不会阻止它。

```
# Match 0 or more word characters
\w* 
```

最后，您要确保有界限来捕捉单词的结尾。所以，把它们放在一起。要匹配至少包含三个单词字符（可能更多）的单词，请使用：-

```
# Word boundaries at start and end    
\b\w{3}\w*\b 
```

注意 -`\w`匹配字母数字 - 如果它只是你需要的字母： -

```
# Alpha only
\b[A-Za-z]{3}[A-Za-z]*\b 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:39:41.333

你有

```
[\w{3,}...]+ 
```

这与

```
[{},3\w...]+ 
```

我想你想要

```
(?:\w{3,}|[\$\@()+.])+ 
```

# jquery - ajax提交成功，函数未触发

> ID：13351750
> 
> 赞同：0
> 
> 时间：2012-11-12T21:20:59.797
> 
> 标签：jquery, asp.net-ajax

我一直没有使用 jQuery，但是我有这个表单，它可以毫无问题地向我的 MVC 控制器提交数据，正在保存数据，并且我的成功功能正在被击中，因为如果我发出警报（“事情” ) 在那里，它被解雇了。我的 ClearFields() 函数也被解雇了。但是，我使用 ajax 的 GetSamples(projId) 函数为我获取了 projectId 的示例列表，没有触发，但它确实在页面加载时触发。

下面是我的代码......如果有人能指出我正确的方向，那将是很好的，因为我不明白为什么它不工作

```
 $(function () {

    var projectId = "@Model.Project.Id";

    GetSamples(projectId);

    $("#refreshButton").button().click(function () {
        GetSamples(projectId);
    });

    $("#saveSampleButton").button().click(function () {
        $.ajax({
            url: "/PreRegistration/AddSample",
            type: "POST",
            data: { projectId: projectId,
                customerSampleId: $("#CustomerSampleId").val(),
                customerSampleId2: $("#CustomerSampleId2").val(),
                customerSampleId3: $("#CustomerSampleId3").val(),
                customerSampleId4: $("#CustomerSampleId4").val(),
                matrix: $("#Matrix").val(),
                product: $("#Product").val(),
                productGrade: $("#ProductGrade").val(),
                dueDate: $("#DueDate").val()
            },
            success: function (response, projectId, jqXHR) {
                alert("done");
                ClearFields();
                GetSamples(projectId);
            },
            error: function (xyz) {
                alert("Something went wrong : " + xyz.val());
            }               
        });

        return false;
    });

    $("#DueDate").datepicker({ dateFormat: "dd/mm/yy" });

    function ClearFields() {
        $("#CustomerSampleId").val("");
        $("#CustomerSampleId2").val("");
        $("#CustomerSampleId3").val("");
        $("#CustomerSampleId4").val("");
        $("#Matrix").val("");
        $("#Product").val("");
        $("#ProductGrade").val("");
        $("#DueDate").val("");
    }

    function GetSamples(pId) {
        $.ajax({
            url: "/PreRegistration/GetSamples",
            type: "POST",
            data: { Id: pId },
            success: function (response) {
                $("#ProjectSamples tbody").replaceWith(response)
            }
        });
    }

}); 
```

我现在对代码进行了一些更改，因为我可以看到部分导致我的问题的原因，GetSamples() 函数似乎正在触发，但它没有更新表格......

```
$(function () {

    var projectId = "@Model.Project.Id";

    GetSamples(projectId);

    $("#saveSampleButton").button().click(function () {
        $.ajax({
            url: "/PreRegistration/AddSample",
            type: "POST",
            data: { projectId: projectId,
                customerSampleId: $("#CustomerSampleId").val(),
                customerSampleId2: $("#CustomerSampleId2").val(),
                customerSampleId3: $("#CustomerSampleId3").val(),
                customerSampleId4: $("#CustomerSampleId4").val(),
                matrix: $("#Matrix").val(),
                product: $("#Product").val(),
                productGrade: $("#ProductGrade").val(),
                dueDate: $("#DueDate").val()
            },
            success: function (projectId) {
                ClearFields();
                GetSamples(projectId);
            },
            error: function (xyz) {
                alert("Something went wrong : " + xyz.val());
            }
        });

        return false;
    });

    $("#DueDate").datepicker({ dateFormat: "dd/mm/yy" });

    function ClearFields() {
        $("#CustomerSampleId").val("");
        $("#CustomerSampleId2").val("");
        $("#CustomerSampleId3").val("");
        $("#CustomerSampleId4").val("");
        $("#Matrix").val("");
        $("#Product").val("");
        $("#ProductGrade").val("");
        $("#DueDate").val("");
    }

    function GetSamples(projectId) {
        $.ajax({
            url: "/PreRegistration/GetSamples",
            type: "POST",
            data: { Id: projectId },
            success: function (response) {
                $("#ProjectSamples tbody").replaceWith(response)
            }
        });
    }

}); 
```

已调试，并且 projectId (1) 正在正确传递给函数。在 VS 中，在我的控制器操作中，正在获取数据并将其传递回视图......但没有重新填充表

# entity-framework-4 - 现有数据库上的 EF CodeFirst

> ID：13351752
> 
> 赞同：0
> 
> 时间：2012-11-12T21:21:08.130
> 
> 标签：entity-framework-4, ef-code-first

我是 EF CodeFirst 的新手，正在尝试建立实体之间的关系。

我有三个表，它们的关系如下：

![在此处输入图像描述](../Images/378901578d41f16eea97657cc4609f14.png)

当我传递 UserID 时，我应该获得该用户所属组织的所有提供者详细信息。

如何在 CodeFirst(fluent API) 方法中为此场景构建实体及其关系？我在现有数据库上使用 EF CodeFirst。所以这三个表已经存在于数据库中。

任何输入或指针将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T00:12:03.397

Use EF Power Tools. It has Reverse Engineer option that will create a model for an exisiting database. If you want to configure your model with fluent API instead of attributes you can use the above to get you to a starting point where you would manually convert whatever needs to be converted.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:24:40.257

查看MSDN 上的[这篇文章](http://msdn.microsoft.com/en-US/data/jj591620)，它解释了 EF 期望在数据库上定义各种关系的约定。我认为阅读这篇文章将回答您的任何问题。

# c# - C#代码登录社交网站

> ID：13351754
> 
> 赞同：1
> 
> 时间：2012-11-12T21:21:10.130
> 
> 标签：c#, login, social

我已经阅读了几篇关于登录需要电子邮件和密码的网站的帖子，但我找不到关于登录到名为[geni.com](http://www.geni.com/)的特定网站的解决方案..有没有办法

```
 CookieContainer cookie;
        string user = "somemail@somehost.com";
        string pass = "123456";

        string formUrl = "http://www.geni.com/login/";
        string formParams = String.Format("profile_username={0}&password={1}", "MYUSERNAME", "MYPASS");
        string cookieHeader;
        HttpWebRequest myWebRequest;
        WebResponse myWebResponse; 
        String URL = textBox1.Text;
        myWebRequest = (HttpWebRequest)WebRequest.Create("formUrl");
        myWebRequest.ContentType = "application/x-www-form-urlencoded";
        myWebRequest.Method = "POST";
        string login = string.Format("go=&Fuser={0}&Fpass={1}", user, pass);

        byte[] postbuf = Encoding.ASCII.GetBytes(login);

         myWebResponse = myWebRequest.GetResponse(); //Returns a response from an Internet resource
        cookieHeader = myWebResponse.Headers["Set-cookie"];
        cookie = myWebRequest.CookieContainer = new CookieContainer();
        myWebRequest.CookieContainer = cookie;
        Stream streamResponse = myWebResponse.GetResponseStream(); 

        StreamReader sreader = new StreamReader(streamResponse);
        Rstring = sreader.ReadToEnd(); 
```

我有点迷茫，谁能帮帮我？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:23:00.760

这是他们的[API 文档](http://www.geni.com/platform/developer/help/oauth_app_login?version=1)的链接。要登录，您需要像这样调用他们的 API：

```
https://www.geni.com/platform/oauth/request_token?client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&grant_type=client_credentials 
```

# jquery - jvector 地图标记未正确显示

> ID：13351757
> 
> 赞同：2
> 
> 时间：2012-11-12T21:21:21.817
> 
> 标签：jquery, maps, jvectormap

我正在使用[JVectorMap](http://jvectormap.com/)显示美国地图，并希望在 5 个城市上放置标记。我的代码中有他们的经度和纬度，但它似乎不起作用。我看到地图左上角的标记。我不知道为什么他们定位在那里，而不是我的代码中的城市？

如果有人可以提供一些关于标记为什么不能正常工作的见解：

在这里查看我的代码：http: [//jsfiddle.net/xtian/fqqGs/](http://jsfiddle.net/xtian/fqqGs/)

JS：

```
$(function(){
        $('#map').vectorMap({
        map: 'us_aea_en',
        zoomOnScroll: false,
        hoverOpacity: 0.7,
        markerStyle: {
          initial: {
            fill: '#F8E23B',
            stroke: '#383f47'
          }
        },
        markers: [
          {latLng: [41.50, 87.37], name: 'Chicago'},
          {latLng: [32.46, 96.46], name: 'Dallas'},
          {latLng: [36.10, 115.12], name: 'Las Vegas'},
          {latLng: [34.3, 118.15], name: 'Los Angeles'},
          {latLng: [40.43, 74.00], name: 'New York City'}
        ]        
        });
       });​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:00:37.413

您刚刚提供了错误的坐标。经度应该是负数：

```
markers: [
    {latLng: [41.50, -87.37], name: 'Chicago'},
    {latLng: [32.46, -96.46], name: 'Dallas'},
    {latLng: [36.10, -115.12], name: 'Las Vegas'},
    {latLng: [34.3, -118.15], name: 'Los Angeles'},
    {latLng: [40.43, -74.00], name: 'New York City'}
] 
```

这是一个更新的[演示](http://jsfiddle.net/fqqGs/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T07:13:05.657

你能发布你的“网格”吗？像这样的东西？

```
$.fn.vectorMap('addMap', 'map_name',{ 
"insets": [{
    "width": 500, 
    "top": 0, 
    "height": 500, 
    "bbox": [{
        "y": -12000000.0, 
        "x": -19000000.0
    }, {
        "y": 6900000.0, 
        "x": 19000000.0
    }],
}],
"paths": {
... 
```

# java - 从另一个罐子中运行一个罐子

> ID：13351758
> 
> 赞同：3
> 
> 时间：2012-11-12T21:21:33.727
> 
> 标签：java, jar, runnable, auto-update, bootstrapping

在我赏金之前重写它以清楚起见：

我想要做的是为已经以（可执行）jar 形式制作的程序制作引导加载程序。这个引导程序在运行时将有三个简单的目标：

1.  将目标程序的本地 xml 文件与服务器上托管的文件进行比较（以确保它们是相同的版本）

2.  如果不是同一个版本，并且在线版本较新，请下载较新版本。

3.  重新编写 xml 文件以反映此更改。

4.  执行第二个 jar 文件（就像启动可执行文件一样启动它）。

我遇到的问题是第 4 步。尽管查看了 UrlClassLoader 和其他库，但我发现自己很难找到一种可靠的方法来从我的引导程序中启动 jar。

由于一些外部问题，JNLP / Web-start 不是这种情况下的选项。

TL;DR：我需要找到一种从 jar 中下载/启动 jar 的方法，以便在运行引导程序时更新程序。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:29:22.547

Runtime.getRuntime().exec()

如果您的 MyApp.jar 有任何输出，这里有一些陷阱。

查看文档以获取有关如何正确使用 exec 的详细信息...

[http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html)

并看到这个关于一些陷阱的SO帖子......

[Java 运行时.exec()](https://stackoverflow.com/questions/8595748/java-runtime-exec)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:30:16.413

当您说“执行新 jar”时，您的意思是启动一个独立的应用程序吗？一种可能性是简单地从 Updater.jar 引导逻辑执行一个新的 Java 进程，然后退出本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:32:22.107

换句话说，您想要实现可自我更新的应用程序。这是可能的，甚至没有那么困难。

您的程序应设计为包含 2 个部分。加载器（和更新器）和业务逻辑。加载器应该使用单独的类加载器启动业务逻辑。您可以使用`UrlClassLoader`. 加载程序将转到在线服务并检查版本。如果需要，它将创建`URLConnection`、下载新文件`jar`并将其存储在文件系统中的某个位置（例如，在用户主目录中）。然后它将使用已经提到的类加载器运行业务逻辑，该类加载器从刚刚下载的 jar 文件加载类。

这实际上模仿了 JNLP 行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T17:20:41.703

我讨厌不得不回答我自己的问题，但在这种情况下，我觉得需要完成......

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.xpath.XPath;
import javax.xml.xpath.XPathConstants;
import javax.xml.xpath.XPathExpression;
import javax.xml.xpath.XPathFactory;

import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;

import org.w3c.dom.Document;

public class updater {
public static void main(String[] args) throws IOException {
    try{
        DefaultHttpClient httpclient = ClientMaker();
        HttpGet get = new HttpGet("http://encorpops04:8080/Updater-test/Version.xml");
        HttpResponse response = httpclient.execute(get);
        InputStream in = response.getEntity().getContent();

        DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = domFactory.newDocumentBuilder();
        Document doc = builder.parse(in);

        //Parse the Xml.
        XPathFactory factory = XPathFactory.newInstance();
        XPath xpath = factory.newXPath();
        XPathExpression expr = xpath.compile("//version/number/text()");
        String result = (String) expr.evaluate(doc, XPathConstants.STRING);
        System.out.println(result);

        File f = new File(System.getProperty("user.dir")+ "\\Version.xml");
        in = new FileInputStream(f) ;
        doc = builder.parse(in);
        expr=xpath.compile("//version/number/text()");
        String result2 = (String) expr.evaluate(doc, XPathConstants.STRING);
        System.out.println(result2);

        if(Double.parseDouble(result2) < Double.parseDouble(result)){
            HttpGet get2 = new HttpGet("http://encorpops04:8080/Updater-test/MyOutput.jar"); 
            HttpResponse response2 = httpclient.execute(get2);
            InputStream in2 = response2.getEntity().getContent();
            File f2 = new File("MyOutput.jar");
            OutputStream fos = new FileOutputStream(f2);
            byte buf[] = new byte[1024];
            int len;
            while ((len = in2.read(buf)) > 0) {
                fos.write(buf, 0, len);
            }
            fos.close();
            in.close();
        }
        System.out.println("cmd.exe /C  javaw -jar"  +System.getProperty("user.dir") + "\\MyOutput.jar");
        Process p = Runtime.getRuntime().exec("cmd.exe /C  javaw -jar "  +System.getProperty("user.dir") + "\\MyOutput.jar");
        p.waitFor();
        p.destroy();
    }catch(Exception e){ e.printStackTrace(); }

}

public static DefaultHttpClient ClientMaker() {
    int connectiontimeout = 30000; // 1 second int sockettimeout = 1000;
    HttpParams httpparameters = new BasicHttpParams();
    HttpConnectionParams.setConnectionTimeout(httpparameters,
            connectiontimeout);
    HttpConnectionParams.setSoTimeout(httpparameters, connectiontimeout);
    DefaultHttpClient httpclient = new DefaultHttpClient(httpparameters);
    return httpclient;
}

} 
```

Version.xml 看起来像这样：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<version>
    <number>1.0</number>
</version> 
```

旁注-我没有自动更新 version.xml，您可以编辑其中的数字以匹配，或者只需拉出您检查的数字来替换它。

# dynamic - 表达式引擎相关类别

> ID：13351765
> 
> 赞同：0
> 
> 时间：2012-11-12T21:22:23.227
> 
> 标签：dynamic, expressionengine, categories

我一直在尝试让子导航运行很长一段时间，但似乎无法找到解决我的问题的方法。

首先，这是我试图让我的子导航做的最接近的例子。（电视子导航）[http://www.bestbuy.com/site/TV-Home-Theater/Televisions/abcat0101000.c?id=abcat0101000](http://www.bestbuy.com/site/TV-Home-Theater/Televisions/abcat0101000.c?id=abcat0101000)

例如，如果我有 3 个类别的父母（Central、Portable 和 Brands），如果单击“Central”，我希望显示与“Centrals & Brands”相关的所有类别，而忽略与“Portable”有关的任何内容.

另一个例子，如果我点击“品牌”，我希望能够按品牌购物，并且只有与该品牌相关的“Central & Portable”产品。

我目前正在使用 GWcode 类别和 GWcode CatMenu 来尝试使其正常工作。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:19:10.763

[通过使用 Channel Entries + P&T Playa](http://pixelandtonic.com/playa)方法替换原生类别，您可能会更幸运。

1.  创建一个“类别”频道
2.  使用类别频道中的相关类别（条目）向其中添加一个 Playa 字段
3.  在您的产品渠道中，添加一个 Playa 字段，其中包含来自类别渠道的类别（条目）。

百思买网站上的电视子导航将通过将相关类别（在步骤 2 中提到）显示到当前查看的类别来重新创建。

```
{exp:playa:children entry_id="{current_page_category_id}"}
  ...
{/exp:playa:children} 
```

你的旅费可能会改变。

# php - absolute path in subdomain

> ID：13351776
> 
> 赞同：0
> 
> 时间：2012-11-12T21:22:58.140
> 
> 标签：php, url, path, relative-path, absolute

I have made an application (php, css, js) with absolute path like

```
<img src="/images/example.jpg" alt=""/> 
```

and others for including resources (js, css, etc.)

The application was initially destinated to be hosted on a server like [http://domain.com](http://domain.com) Now I need to host the site in a subfolder [http://domain.com/2013/](http://domain.com/2013/)

How can I update my application and make it accessible in the new subfolder without update all the paths.

Maybe with .htaccess ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:29:22.333

Setting the [base href](http://www.w3schools.com/tags/tag_base.asp) should solve your problem. The following should be placed in the `<head>` element of all your pages:

```
<base href="http://domain.com/2013/" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:36:13.310

Or you can to try this code in you .htaccess:

```
RewriteEngine on 
RewriteRule ^(.*)$ /2013/$1 [QSA,L] 
```

# php - 300MB 安全视频流 (PHP)

> ID：13351780
> 
> 赞同：3
> 
> 时间：2012-11-12T21:23:23.477
> 
> 标签：php, security, video, streaming

我们需要您的帮助来解决一个 PHP 项目客户端限制。

他希望从服务器完整下载安全视频，他希望视频存储在公共目录之外，并且视频流必须是 HTML5，没有 Flash。我有一个解决方案，在 php 缓冲区中加载视频并响应它改变标题信息，但是视频大小，或多或少 300MB 是不可能加载到 PHP 缓冲区中的......

有什么好主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:29:21.760

您不需要将任何内容加载到缓冲区中。只需发送标题，然后使用读取的文件跟进它们`readfile()`。该文件位于`.htaccess`禁止直接访问的目录中（下载脚本当然不是），并且 Bob 是你的叔叔。

既然您谈到*将文件加载到缓冲区*中，请注意，这**不是**“流式传输”。大多数 Flash 流媒体所做的实际上是发出 Byte-Range 请求。在这些情况下，您也可以使用 来识别情况、解析范围，然后使用's 和's`if (isset($_SERVER['HTTP_RANGE']))`完成其余的工作。`fseek``fread`

# html - 将元素直接放在可能/可能不会被截断的文本之后

> ID：13351781
> 
> 赞同：0
> 
> 时间：2012-11-12T21:23:24.337
> 
> 标签：html, css

所以我想要这样的东西：

```
Hello [element] 
```

还有这种情况：

```
Hello blahblahblah... [element] 
```

向右浮动元素会这样做，这是我不想要的：

```
Hello                 [element]
Hello blahblahblah... [element] 
```

编辑：

我试过的html是这样的：

```
<h3 id="container">
  <span>[element]</span>
  <a>dynamic text</a>
</h3> 
```

CSS：

```
span{
  float: right;
}

#container {
  width: 100px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
} 
```

另一个问题是 [element] 可能是可变长度的。我想截断 a 标签，使其适合所有 [element] 并将其全部放在一行上。我知道这可能会让这个问题变得更加困难......

编辑2：

意识到我希望容器 h3 具有固定的最大宽度并不清楚。所以基本上如果a标签和span的组合宽度大于最大宽度，span会将截断位置放在左边。像这样：

字符串是：Hello World

所以在这种情况下它可能看起来像这样：

你好世界...[小el]

地狱...[更大的跨度el]

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T02:38:53.810

## 更新的想法

这是我在下面的原始想法的改进版本，但尝试使用额外的 wrap 创建您在聊天中提到的固定宽度的容器和一般外观`div`。我认为这可以完全由 css 工作的唯一方法是让*您事先知道您的“徽章”区域的最大宽度**可能**是*多少，然后将您`max-width`的文本区域设置为容器的宽度减去该潜力徽章区域的最大宽度。这是下面的修改代码和[**小提琴示例**](http://jsfiddle.net/tnPkF/44/)，我假设一个`200px`容器，最多`100px`徽章区域宽度。您最终会“过早地”截断一些文本（如，它似乎可以变得更宽，但我们将其限制在一定的空间内；参见小提琴中的第三行）。

**HTML**

```
<h3 class="container">
  <div>   
  <span>[elem]</span>
  <a>dynamic text</a>
  </div>
</h3> 
```

**CSS**

```
.container {
  width: 200px; /* this defines your right edge */
  background-color: cyan;
  overflow: hidden;
}

.container > div {
  float: left;
  clear: left;
  position: relative;
  padding-right: .1em;
  white-space: nowrap;
}

.container span {
  position: absolute;
  left: 100%;
  white-space: nowrap;
}

.container a {
  display: block; 
    /* the following assumes the span "badge" area is 100px max, 
       so it is 200px - 100px = 100px in width */ 
  max-width: 100px;  
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;   
} 
```

## 创见

也许这会奏效。

```
.container {
  float: left; /* this collapses the container around the 'a' tag */
  position: relative; /* this is going to position the 'span' */
  padding-right: .1em; /* gap to element 'span' */
  white-space: nowrap; 
}

.container span {
  position: absolute;
  left: 100%; /* push behind 'a' tag */
  white-space: nowrap; /* keep this from wrapping */
}

.container a {
  display: block;
  max-width: 100px; /* set your max width for the 'a' tag only */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;   
} 
```

[**看一个小提琴的例子。**](http://jsfiddle.net/tnPkF/21/)

# python - 从有序列表中订购子列表的最 Pythonic 方式

> ID：13351782
> 
> 赞同：1
> 
> 时间：2012-11-12T21:23:28.127
> 
> 标签：python

如果我有子列表A：['E'，'C'，'W']，根据主列表M的顺序对子列表进行排序的最pythonic方法是什么：['C'，'B'，'W ','E','K']

我的解决方案似乎相当初级。我很好奇是否有更“pythonic”的方式来获得相同的结果。

```
ORDER = ['C','B','W','E','K']
possibilities = ['E','C', 'W']
possibilities_in_order = []

for x in ORDER:
    if x in possibilities: possibilities_in_order.append(x) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:25:12.620

```
>>> order = ['C','B','W','E','K']
>>> possibilities = ['E','C','W']
>>> possibilities_in_order = sorted(possibilities, key=order.index)
>>> possibilities_in_order
['C', 'W', 'E'] 
```

这是如何工作的：对于每个`element`in `possibilities`，`order.index(element)`都被调用，并且列表只是按这些相应的位置排序。

更多详细信息：[内置函数 →`sorted`](http://docs.python.org/3/library/functions.html#sorted)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:25:17.703

```
possibilities.sort(key=lambda x : ORDER.index(x)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:30:02.777

这是一个线性时间解决方案：

```
posset = set(possibilities)
[letter for letter in order if letter in posset] 
```

这会仅针对子列表的成员过滤主列表。这是 O(n)，因为它只遍历主列表一次，如果子列表的大小接近主列表，它将表现良好。

这也假设`possibilities`没有重复。但是，如果需要，您可以处理它，尽管它会使代码更复杂。

# oauth - Oauth：成功授权后重定向，如何？

> ID：13351783
> 
> 赞同：0
> 
> 时间：2012-11-12T21:23:37.423
> 
> 标签：oauth

我希望人们通过他们的 Facebook 或 Twitter 帐户登录我们的无线网络。所以我会使用Oauth ..

如果用户成功授权我们的应用程序，他必须将我重定向到我们的网站。最有效的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T17:37:41.013

对于 Twitter (OAuth 1)，您可以通过`oauth_callback`在第一个请求中提供参数或在向 Twitter 注册应用程序时指定回调 URL 来执行此操作。

在 OAuth2（Facebook 使用）中，流程不同，但参数名称为`redirect_uri`.

这些是您唯一的选择。

# assembly - 使用 PIC16F877A 的汇编语言中断

> ID：13351785
> 
> 赞同：0
> 
> 时间：2012-11-12T21:24:00.237
> 
> 标签：assembly, microcontroller, interrupt

我正在尝试做一些微控制器练习，如果这太明显了，我有点抱歉。

基本上，我们拥有的是一个 PIC16F877A，其连接按钮到 RC4 和 RC5 上的 PORTC，配置为输入。这个想法是使用 RC5 来激活中断并等待 TMR0 中断来激活蜂鸣器（我们现在正在使用 LED）。然后，RC4 必须停用中断并停止蜂鸣器/LED（连接到 RC0，配置为输出）。

我们制作了我们的程序，它在 MPLAB 上运行得很好，但我们在让它在真实的东西上运行时遇到了问题。

这是程序：

```
list p=16f877a
include "p16f877a.inc"
__CONFIG _CP_OFF & _DEBUG_OFF & _WRT_OFF & _CPD_OFF & _LVP_OFF & _BODEN_OFF & _PWRTE_ON & _WDT_OFF & _HS_OSC

DELH EQU 0x2C
DELL EQU 0x2F   
DELI EQU 0x2E 
ORG 0x00
GOTO MAIN
ORG 0x04
GOTO INTERRUMPE

MAIN        BCF STATUS,RP0
            BCF STATUS,RP1
            CLRF PORTC
            CLRF PORTB

            BSF STATUS,RP0  
            MOVWF 0xF0
            MOVWF TRISC
            MOVWF 0x00
            MOVWF TRISB
            MOVLW 0x83
            MOVWF OPTION_REG
            BCF STATUS,RP0

TECLA       BTFSS PORTC,5
            GOTO TECLA
            MOVLW  0xB8
            MOVWF INTCON
            MOVLW 0x63
            MOVWF TMR0        

TECLA2      BTFSS PORTC,4
            GOTO TECLA2
            BCF INTCON,7
            BCF PORTC,0
            GOTO TECLA   

INTERRUMPE BTFSS INTCON,2
           GOTO REGRESO
           BSF PORTC,0
           MOVLW 0xBF
           MOVWF TMR0
           BCF  INTCON,T0IF
REGRESO    RETFIE   

END 
```

我们必须遵循最低限度的制度：

[http://prntscr.com/jkz88](http://prntscr.com/jkz88)

在我们将振荡器从 4Mhz 更改为 12Mhz 之前，它什么也没做，使用 12 Mhz 振荡器它有点工作，但有点疯狂。我们也尝试了 20Mhz，但效果也不是很好。我们甚至尝试了不同的配置词，但我们没有得到任何好的结果。

请帮忙，我有点绝望。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:03:44.720

首先，代码

```
 MOVWF 0xF0
        MOVWF TRISC
        MOVWF 0x00
        MOVWF TRISB 
```

不做它应该做的事情，MOVWF 将工作寄存器的内容移动到 GPR 或 SFR 或其地址，所以你正在做的是你正在填充地址 0xF0（一个 GPR）和 0x00（间接寻址寄存器）工作寄存器的未知值。相反，您的代码应以

```
 MOVLW 0xF0
        MOVWF TRISC
        MOVLW 0x00
        MOVWF TRISB 
```

此外，如果 RC4 和 RC4 输入是按钮或开关，请考虑在硬件或软件中实施去抖动解决方案

最后，对于时钟设置，如果您使用 8MHz 或更高的时钟，则 MPLAB 中的配置字应设置为 HS，如果您使用 4 MHz，则应设置为 XT。

# matlab - Matlab并将单个结果排序到矩阵

> ID：13351786
> 
> 赞同：0
> 
> 时间：2012-11-12T21:24:01.017
> 
> 标签：matlab, sorting

```
for i=1:1:k   %k = 100 people
   for j=1:1:l  %l = 5 orders
      Resultx = a + b + d(j); % cost of drink Resultx
      Resulty = f + g + c(j); % cost of food Resulty
   end
   Matrix(i) = [Resultsx1...j Resulty1...j]
end 
```

这些`% notes`是为了帮助我表达我想在脑海中解决的问题，然后在我的脚本中。

让我们声称我们希望每个`i`人都将值存储在它订购的饮料和食物的成本矩阵中。

所以对于人来说`i = 1`，

```
1[1 5] %people 1, first order:  drink costs 1 and food costs 5
2[2 3] %people 1, second order: drink costs 2 and food costs 3
      ...
j[x y] %people 1, j order:      drink and food costs x and y
                 !!!       Matrix(1) = sort (j [x,y])    !!! 
```

为人`i = 2`，

```
1[1 5] %people 2, first order:  drink costs 1 and food costs 5
2[2 3] %people 2, second order: drink costs 2 and food costs 3
     ...
j[x y] %people 2, j order:      drink and food costs x and y
       !!!       Matrix(2) = sort (j [x,y])    !!! 
```

为人`i = k`，

```
1[1 5] %people k, first order:  drink costs 1 and food costs 5
2[2 3] %people k, second order: drink costs 2 and food costs 3
      ...
j[x y] %people k, j order:      drink and food costs x and y
            !!!       Matrix(i) = sort (j [x,y])    !!! 
```

我想按升序将每次迭代`i`^的每个结果形成一个矩阵

```
Matrix(i) = sort (j [x,y]). 
```

也许不是最好的范例，但提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:42:29.860

*（我理解您的陈述的两种方式；我假设您对**2.**解决方案感兴趣。以这种形式`Resultx`并且`Resulty`不`i`以任何方式依赖，因此它们对于所有“人”都是相同的）。*

**1.** `Matrix`是*[k* **x** *2]*数组。*总结了*第二个循环的结果！

 *```
Matrix = zeros(k, 2);                 % pre-allocate space

for i=1:1:k   %k = 100 people
    Resultx = 0;
    Resulty = 0;        
    for j=1:1:l  %l = 5 orders
        Resultx = Resultx + a + b + d(j);       % cost of drink Resultx
        Resulty = Resulty + f + g + c(j);       % cost of food Resulty
    end
    Matrix(i,:) = [Resultx, Resulty]  % save pair
end

Sorted = sortrows(Matrix, [1 2]);     % sort pairs 
```

最后一个命令[对 pair 进行排序](http://www.mathworks.com/help/stats/ordinal.sortrows.html)，首先按第一列，然后按*升序*按第二列。如果您希望这两个条件都*按降序*`[-1 -2]`排列，则可以改用。结合升序和降序也是可能的（例如`[-1 2]`），但在这种情况下，无意义是值得怀疑的。

**2.** `Matrix`是*[ k* **x** *l* **x** *2 ]*数组，其中的结果单独保存，不会在第二个循环中*汇总。*

```
Matrix = zeros(k, l, 2);              % pre-allocate space
Intermediate = zeros(l, 2);           % container used for sorting

for i=1:1:k   %k = 100 people
    for j=1:1:l  %l = 5 orders
        Resultx = a + b + d(j);       % cost of drink Resultx
        Resulty = f + g + c(j);       % cost of food Resulty
        Intermediate(j,:) = [Resultx, Resulty];  %save pair
    end
    Matrix(i,:,:) = sortrows(Intermediate, [1 2]);  % sort pairs
end 
```

* * *

**注意：** *您应该避免在 Matlab 中编写循环，并尽可能使用矢量化解决方案！**

# android - Android JNI字符串加密/解密

> ID：13351787
> 
> 赞同：2
> 
> 时间：2012-11-12T21:24:01.590
> 
> 标签：android, encryption, java-native-interface, aes

我正在尝试在本机代码 C 中进行 aes 加密/解密。加密确实有效，但是当我尝试解密字符串时。它不会以原始字符串结尾。这是基于模式参数加密/解密的 JNI 方法：

```
jbyteArray Java_com_example_hellojni_HelloJni_encrypt( JNIEnv*  env,
                                      jobject  this,
                                      jbyteArray  srcData,
                                      jint mode)
{
  // get length of bytes
  int srcLen=(*env)->GetArrayLength(env,srcData);

  //convert jbyteArray to byte []
  jbyte data[srcLen];
  (*env)->GetByteArrayRegion(env, srcData, 0, srcLen, data);
  (*env)->ReleaseByteArrayElements(env, srcData,data , 0);

  unsigned char* indata=(unsigned char*)data;
   const unsigned char ukey[] = { 'H','A','R','D','C','O','D','E','D',' ','K','E','Y','1','2','3'};
  unsigned char *outdata = NULL;
  outdata = malloc(srcLen);
  AES_KEY key;
  memset(&key, 0, sizeof(AES_KEY));

 if(mode == AES_ENCRYPT)
    AES_set_encrypt_key(ukey, 128, &key);
 else
    AES_set_decrypt_key(ukey, 128, &key);

 AES_ecb_encrypt(indata, outdata, &key, mode);

 jbyteArray bArray = (*env)->NewByteArray(env, srcLen);
 jboolean isCopy;
 void *decrypteddata = (*env)->GetPrimitiveArrayCritical(env, (jarray)bArray, &isCopy);
 memcpy(decrypteddata, outdata, srcLen);

 (*env)->ReleasePrimitiveArrayCritical(env, bArray, decrypteddata, 0);

 return bArray;
} 
```

任何想法为什么解密加密字节与原始字节不同？

正如 Codo 和 owlstead 所建议的，我尝试了更高级别的实现，但仍然存在同样的问题。

这是来自 saju.net.in/code/misc/openssl_aes.c.txt 的代码

```
/**
* Create an 256 bit key and IV using the supplied key_data. salt can be added for taste.
* Fills in the encryption and decryption ctx objects and returns 0 on success
**/
int aes_init(unsigned char *key_data, int key_data_len, unsigned char *salt, EVP_CIPHER_CTX *e_ctx,
         EVP_CIPHER_CTX *d_ctx)
 {
   int i, nrounds = 5;
    unsigned char key[32], iv[32];

   /*
   * Gen key & IV for AES 256 CBC mode. A SHA1 digest is used to hash the supplied key material.
   * nrounds is the number of times the we hash the material. More rounds are more secure but
   * slower.
   */
   i = EVP_BytesToKey(EVP_aes_256_cbc(), EVP_sha1(), salt, key_data, key_data_len, nrounds, key, iv);
   if (i != 32) {
    printf("Key size is %d bits - should be 256 bits\n", i);
    return -1;
 }

 EVP_CIPHER_CTX_init(e_ctx);
 EVP_EncryptInit_ex(e_ctx, EVP_aes_256_cbc(), NULL, key, iv);
 EVP_CIPHER_CTX_init(d_ctx);
 EVP_DecryptInit_ex(d_ctx, EVP_aes_256_cbc(), NULL, key, iv);

 return 0;
}

/*
* Encrypt *len bytes of data
* All data going in & out is considered binary (unsigned char[])
*/
unsigned char *aes_encrypt(EVP_CIPHER_CTX *e, unsigned char *plaintext, int *len)
{
  /* max ciphertext len for a n bytes of plaintext is n + AES_BLOCK_SIZE -1 bytes */
  int c_len = *len + AES_BLOCK_SIZE, f_len = 0;
  unsigned char *ciphertext = malloc(c_len);

  /* allows reusing of 'e' for multiple encryption cycles */
  EVP_EncryptInit_ex(e, NULL, NULL, NULL, NULL);

  /* update ciphertext, c_len is filled with the length of ciphertext generated,
  *len is the size of plaintext in bytes */
  EVP_EncryptUpdate(e, ciphertext, &c_len, plaintext, *len);

  /* update ciphertext with the final remaining bytes */
  EVP_EncryptFinal_ex(e, ciphertext+c_len, &f_len);

 *len = c_len + f_len;
 return ciphertext;
}

/*
* Decrypt *len bytes of ciphertext
*/
unsigned char *aes_decrypt(EVP_CIPHER_CTX *e, const unsigned char *ciphertext, int *len)
{
   /* because we have padding ON, we must allocate an extra cipher block size of memory */
   int p_len = *len, f_len = 0;
   unsigned char *plaintext = malloc(p_len + AES_BLOCK_SIZE);

   EVP_DecryptInit_ex(e, NULL, NULL, NULL, NULL);
   EVP_DecryptUpdate(e, plaintext, &p_len, ciphertext, *len);
   EVP_DecryptFinal_ex(e, plaintext+p_len, &f_len);

   *len = p_len + f_len;
   return plaintext;
} 
```

这是我的称为 java 形式的方法：

```
 /* "opaque" encryption, decryption ctx structures that libcrypto uses to record
 status of enc/dec operations */
 EVP_CIPHER_CTX en, de;

 jint
 Java_com_example_hellojni_HelloJni_aesinit( JNIEnv* env,
                                              jobject obj)
 {
      unsigned int salt[] = {12345, 54321};
      unsigned char key_data[]={ 'G','X','8','j','E','r','0','4','o','6','P','C','+','I','E','+'};
  int key_data_len;

  key_data_len = strlen(key_data);

  /* gen key and iv. init the cipher ctx object */
   if (aes_init(key_data, key_data_len, (unsigned char *)&salt, &en, &de)) {
     printf("Couldn't initialize AES cipher\n");
     __android_log_print(ANDROID_LOG_VERBOSE, APPNAME, "initializing aes failed");
     return 0;
   }
   __android_log_print(ANDROID_LOG_VERBOSE, APPNAME, "initializing aes success");

   return 1;
}

  jint
  Java_com_example_hellojni_HelloJni_aesCleanup( JNIEnv* env,
                                              jobject obj)
  {
EVP_CIPHER_CTX_cleanup(&en);
EVP_CIPHER_CTX_cleanup(&de);
return 1;
  }

  jbyteArray
  Java_com_example_hellojni_HelloJni_encrypt( JNIEnv* env,
                                              jobject obj, jstring  textToEncrypt)
  {

   const char *plainText = (*env)->GetStringUTFChars(env, textToEncrypt, 0);
   int len = strlen(plainText)+1;
   unsigned char *ciphertext = aes_encrypt(&en, (unsigned char *)plainText, &len);

       jbyteArray byteArray=(*env)->NewByteArray(env, strlen(ciphertext));
    (*env)->SetByteArrayRegion(env, byteArray, 0, strlen(ciphertext), (const jbyte*)ciphertext);

   (*env)->ReleaseStringUTFChars(env, textToEncrypt, plainText);

   return byteArray;

  }

  jbyteArray
  Java_com_example_hellojni_HelloJni_decrypt( JNIEnv* env,
                                              jobject obj, jstring  textToDecrypt)
  {

   const  unsigned char *cipherText = (*env)->GetStringUTFChars(env, textToDecrypt, NULL);
   int len = strlen(cipherText)+1;
   char *plainText = (char *)aes_decrypt(&de, cipherText, &len);
   jbyteArray byteArray=(*env)->NewByteArray(env, strlen(plainText));
  (*env)->SetByteArrayRegion(env, byteArray, 0, strlen(plainText), (const jbyte*)plainText);

   (*env)->ReleaseStringUTFChars(env, textToDecrypt, cipherText);

   return byteArray;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:35:07.337

您提供一个 72 位长（9 个字符 x 8 位）的密钥。但它必须是 128 位长（正如您在调用中指定的那样`AES_set_encrypt_key`）。因此，丢失的 56 位或多或少是随机的（取决于`ukey`数组旁边的内容）。

要修复它，请指定更长的密钥或用 0 填充剩余的字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T02:17:24.043

您正在使用 OpenSSL 的低级加密模式。如果您使用更高级别的`EVP_*`方法，例如 AES/CBC 模式加密，您的麻烦可能会消失。另请参阅[此相关问题](https://stackoverflow.com/questions/5132939/c-c-how-to-do-aes-decryption-using-openssl)。

# c# - 从 FORTRAN 77 代码返回值到 C#

> ID：13351798
> 
> 赞同：2
> 
> 时间：2012-11-12T21:24:49.920
> 
> 标签：c#, visual-studio-2010, dll, fortran, return-value

我已经尝试了 2 天，但无法使其正常工作。

我试图做这个人做的同样的事情：-> [从fortran77 dll返回真实值到c#](https://stackoverflow.com/questions/1365958/returning-real-values-from-fortran77-dll-to-c-sharp)

我所做的一切都和他一模一样。即使在同一个编译器中使用相同的参数编译。

但我得到“尝试读取或写入受保护的内存。这通常表明其他内存已损坏。” 错误。

需要帮忙！

这是我的 C# 代码：

```
 [DllImport("Lks.dll",
        CharSet = CharSet.Auto,
        CallingConvention = CallingConvention.StdCall)]
    public static extern void DON(
        [MarshalAs(UnmanagedType.R8)] double DAA,
        [MarshalAs(UnmanagedType.R8)] double DBB,
        [MarshalAs(UnmanagedType.R8)] double DCC
        );

    static unsafe void Main(string[] args)
    {
        //double TIME = 100.0;
        double DAA = 5.5;
        double DBB = 7;
        double DCC = 9;
        //START( ENERIN, VAL1);
        DON(DAA, DBB, DCC);

        Console.Write("val1 = " + DAA);
        Console.Write("val2 = " + DCC);
        Debug.WriteLine("VAR = " + DBB.ToString());
        Console.Write("Press any key to exit");
        Console.ReadKey(false);
    } 
```

这是我的 FORTRAN 77 代码：

```
*$pragma aux DON "DON" export parm(value*8, reference, reference)

  SUBROUTINE DON(DAA,DBB,DCC)
  REAL*8, DAA,DBB,DCC
  DBB=DAA+1
  DCC=DBB+1 
  RETURN
  END 
```

在我看来，一切都一样。所以我认为可能是VS2010的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:54:57.610

`*$pragma aux ...`只有 Open Watcom FORTRAN 77 编译器才能理解辅助编译指示。任何其他编译器都会简单地将它们作为注释忽略。代码示例中的 pragma 的目的是`DAA`按值传递并将例程符号的外部名称固定为`DON`（否则 Fortran 编译器可能会将其重新装饰为类似于`DON_`or的名称`don__`）。其他两个参数仍然是按引用传递。您问题中的`P/Invoke`接口将它们全部指定为按值传递。您需要添加`ref`关键字：

```
[DllImport("Lks.dll",
           CharSet = CharSet.Auto,
           CallingConvention = CallingConvention.StdCall)]
public static extern void DON(
    [MarshalAs(UnmanagedType.R8)] double DAA,
    [MarshalAs(UnmanagedType.R8)] ref double DBB,
    [MarshalAs(UnmanagedType.R8)] ref double DCC
); 
```

如果您使用任何其他不理解 OW 编译指示的 Fortran 编译器，那么所有参数都将是按引用传递的，因此您需要应用于`ref`所有参数：

```
[DllImport("Lks.dll",
           CharSet = CharSet.Auto,
           CallingConvention = CallingConvention.StdCall)]
public static extern void DON(
    [MarshalAs(UnmanagedType.R8)] ref double DAA,
    [MarshalAs(UnmanagedType.R8)] ref double DBB,
    [MarshalAs(UnmanagedType.R8)] ref double DCC
); 
```

Be aware of possible calling conventions mismatch and symbol decorations/mangling. Check with your Fortran compiler's manual.

# multidimensional-array - Xtend 和阵列

> ID：13351801
> 
> 赞同：2
> 
> 时间：2012-11-12T21:24:57.417
> 
> 标签：multidimensional-array, code-generation, language-features, xtend

**xtend**是否支持二维或更多维数组？如果是：我如何创建一个并在以后使用它？我想将字符串存储在这些数组中并将其传递给文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-12T15:29:13.177

这是我创建整数矩阵（行 x 列）的解决方案。唯一的缺点是每一行都是在一个循环中单独分配的。

```
@Pure
static def int[][] newIntArrayOfSize(int nrow, int ncol) {
    newArrayOfSize(nrow).map[ newIntArrayOfSize(ncol) ]
} 
```

演示：

```
// allocate 3 rows by 2 columns
val m = newIntArrayOfSize(3, 2)

// notice that indexes are starting from 0
// here setting value 5 on row=2, col=1
m.get(2).set(1, 5)

for(row : 0 .. 2) {
    for(col : 0..1) {
        print(m.get(row).get(col))
        print("\t")
    }
    println()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T01:15:20.427

很简单，只需将 Guava 库导入到您的 XTend 脚本中。Guava 库中包含多维[MultiSet](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset)。

# asp.net-mvc - 在 asp.net mvc 中使用 unitofwork 测试控制器

> ID：13351804
> 
> 赞同：1
> 
> 时间：2012-11-12T21:25:15.500
> 
> 标签：asp.net-mvc, unit-testing, moq

我有一个模型：

```
public class Post: 
    {
        public string Description { get; set; }
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int Id { get; set; }

        public string Name { get; set; }

        public Guid UniqId { get; set; }

        public DateTime CreatedDate { get; set; }

        public byte[] RowVersion { get; set; }

    } 
```

我有一个具有 EfContext 和 Iunitofwok 模式的 DataLayer

```
using System.Data.Entity;

    namespace Data
    {
        public interface IUnitOfWork
        {
            IDbSet<TEntity> Set<TEntity>() where TEntity : class;
            int SaveChanges();
        }
    }

using System.Data.Entity;
using DomainModel;

namespace Data
{
    public class EfContext : DbContext, IUnitOfWork
    {
        public DbSet<Post> Post { get; set; }
        public DbSet<Comment> Comments { get; set; }
        public DbSet<Category> Categories { get; set; }
        public EfContext()
            : base("TavanGruop")
        {
        }

        #region IUnitOfWork Members

        public new IDbSet<TEntity> Set<TEntity>() where TEntity : class
        {
            return base.Set<TEntity>();
        }

        #endregion
    }
} 
```

在另一个项目中，我有存储库

```
using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Linq;
using Data;

namespace ServiceLayer.ServiceDbSet
{
    public class ServiceContext<T> : IServiceDbSet<T> where T : class
    {
        private readonly IDbSet<T> _dbSet;

        public  ServiceContext(IUnitOfWork iUnitOfWork)
        {
            _dbSet = iUnitOfWork.Set<T>();
        }

        #region IContext<T> Members

        public bool TryGet(Func<T, bool> predicate, out T entity)
        {
            entity = List(predicate).SingleOrDefault();
            return entity != null;
        }

        public T Get(Func<T, bool> predicate)
        {
            return List(predicate).Single();
        }

        public virtual List<T> List(Func<T, bool> predicate = null)
        {
            IEnumerable<T> result = _dbSet.AsEnumerable();
            if (predicate != null)
                result = result.Where(predicate);
            return result.ToList();
        }

        public T Add(T t)
        {
            _dbSet.Add(t);
            return t;
        }

        public void Delete(Func<T, bool> predicate)
        {
            List(predicate).ToList().ForEach(p => _dbSet.Remove(p));
        }

        public void Delete(T t)
        {
            _dbSet.Remove(t);
        }

        #endregion
    }
} 
```

和服务

```
using Data;
using DomainModel;
using ServiceLayer.ServiceDbSet;

namespace ServiceLayer.EfServices
{
    public class EfPostService : ServiceContext<Post>
    {
        public EfPostService(IUnitOfWork uow)
            : base(uow)
        {
        }
    }
} 
```

这是我的服务

```
using Data;
using ServiceLayer.EfServices;

namespace ServiceLayer
{
    public class Services
    {
        private readonly IUnitOfWork _unitOfWork;

        private EfPostService _post;
        private EfCommentService _comment;

        public Services(IUnitOfWork unitOfWork)
        {
            _unitOfWork = unitOfWork;
        }

        public EfPostService Post
        {
            get { return _post ?? new EfPostService(_unitOfWork); }
            set { _post = value; }
        }

        public EfCommentService Comment
        {
            get { return _comment ?? new EfCommentService(_unitOfWork); }
            set { _comment = value; }
        }
    }
} 
```

我使用 tructuremap 进行依赖注入

```
using System;
using System.Web.Mvc;
using System.Web.Routing;
using Data;
using StructureMap;

namespace MVCTemplateProject
{
    public static class StructuremapMvc
    {
        public static void InitStructureMap()
        {
            ObjectFactory.Initialize(x => x.For<IUnitOfWork>().HttpContextScoped().Use(() => new EfContext()));
            ControllerBuilder.Current.SetControllerFactory(new StructureMapControllerFactory());
        }
    }

    public class StructureMapControllerFactory : DefaultControllerFactory
    {
        protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
        {
            return ObjectFactory.GetInstance(controllerType) as Controller;
        }
    }
} 
```

在基本控制器中，我得到 Iunitofwork

```
using System.Web.Mvc;
using Data;
using ServiceLayer;

namespace MVCTemplateProject.Controllers
{
    public class BaseController : Controller
    {
        public readonly IUnitOfWork Context;
        public readonly Services DataContext;

        public BaseController(Data.IUnitOfWork context)
        {
            Context = context;
            DataContext = new Services(context);
        }
    }
} 
```

这是我的家庭控制器

```
using System.Web.Mvc;
using Data;
using DomainModel;

namespace MVCTemplateProject.Controllers
{
    public class HomeController : BaseController
    {
        public HomeController(IUnitOfWork context)
            : base(context)
        {
        }

        public ActionResult Index()
        {
            return View(DataContext.Post.List());
        }
    }
} 
```

我如何用最小起订量测试索引操作我写了这个测试但我得到了错误

```
public void IndxShouldReturnListOfPage()
{
    var posts = new List<Post>
                    {
                        new Post {Name = "Test"},
                        new Post {Name = "Test"},
                        new Post {Name = "Test"},
                        new Post {Name = "Test"}
                    };
    var efContext = new Mock<EfContext>();
    var mockRepository = new Mock<ServiceLayer.Services>(efContext);
    mockRepository.Setup(x => x.Post.List(It.IsAny<Func<Post, bool>>())).Returns(posts);

    var controller = new HomeController(efContext.Object);

    List<Post> model = controller.DataContext.Post.List();
    var result = controller.Index() as ViewResult;

    Assert.AreEqual(model.Count, 4);
    Assert.AreEqual(string.Empty, result.ViewName);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:13:30.073

我明白了，我测试了这个项目

```
 [TestFixture]
    public class PostControllerTest
    {
        #region Setup/Teardown

        [SetUp]
        public void Setup()
        {
            UnitOfWork = TestHelper.TestHelper.GetMockUnitOfWork();
            PostDbSet = TestHelper.TestHelper.GetMockPostDbSet();
            Posts = TestHelper.TestHelper.GetFakePosts();
            TagDbSet = TestHelper.TestHelper.GetMockTagDbSet();
            CategoryDbSet = TestHelper.TestHelper.GetMockCategoryDbSet();

            PostController = new PostController(UnitOfWork.Object, PostDbSet.Object, CategoryDbSet.Object, TagDbSet.Object);
        }

        #endregion

        private Mock<IServiceDbSet<Post>> PostDbSet { get; set; }
        private Mock<IServiceDbSet<Tag>> TagDbSet { get; set; }
        private Mock<IServiceDbSet<Category>> CategoryDbSet { get; set; }
        private PostController PostController { get; set; }
        private List<Post> Posts { get; set; }

        private Mock<IUnitOfWork> UnitOfWork { get; set; }

        [Test]
        public void DetailShouldRedirectToHomePageWhenNotFoundPostOrPostIdIs0()
        {
            PostDbSet.Setup(x => x.Get(It.IsAny<Func<Post, bool>>())).Returns(Posts.Find(post => post.Id == 100));

            var redirectToRoutResult =
                (RedirectToRouteResult) PostController.Details(100);

            Assert.AreEqual("Index", redirectToRoutResult.RouteValues["action"]);
            Assert.AreEqual("Home", redirectToRoutResult.RouteValues["Controller"]);
        }

        [Test]
        public void DetailShouldShowPostById()
        {
            PostDbSet.Setup(x => x.Get(It.IsAny<Func<Post, bool>>())).Returns(Posts.First());
            var result = PostController.Details(1) as ViewResult;
            var model = result.Model as PostViewModel;

            Assert.AreNotEqual(null, model);
            Assert.AreEqual("I Can", model.Title);
            Assert.AreEqual(string.Empty, result.ViewName);
        }

        [Test]
        public void ListOfStringTagMustConvertToListOfTagCollection()
        {
            PostViewModel postViewModel = TestHelper.TestHelper.GetFakePostViewModel();
            PostController.Create(postViewModel);
            //Assert.AreEqual(postViewModel.RawTags[0], postViewModel.RawTags.First().Name);
        } 
```

# shell - 使用 shell 脚本操作文件名：更改文件扩展名

> ID：13351806
> 
> 赞同：2
> 
> 时间：2012-11-12T21:25:21.147
> 
> 标签：shell

我需要编写一个 shell 脚本来将图像格式从 .png 转换为 .tif。脚本如下：

```
#!/bin/sh

for f in `ls *.png`
do
    convert $f $f.tif
done 
```

但这样做会将 .tif 格式附加到现有文件名。即，如果图像是 abc.png，则 $f 将具有 abc.png，并且在转换文件名后变为 abc.png.tif。这不是我想要的。我需要它是 abc.tif。如何操作 $f 以删除 .png？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T21:30:52.460

这应该适合你：

```
#!/bin/bash

for file in *.png
do
    filename=$(basename "$file")
    filename=${filename%.*}
    convert $file $filename.tif
done 
```

这是如何工作的逐行演练：

*   `for file in *.png`- 您不需要命令替换`ls *.png`来获取带有`png`扩展名的文件列表。通配符`*`将在 shell 中自动扩展以匹配 cwd 中的文件列表；在这种情况下，以 . 结尾的文件列表`.png`。
*   `filename=$(basename "$file")`- 这仅适用于防御性编程；它获取文件的实际名称
*   `filename=${filename%.*}`- 这会从`filename`
*   `convert $file $filename.tif`- 运行你的实际转换命令

# c++ - 由 int 数据类型 (low, high) struct 表示的 double 数据类型在 union 中

> ID：13351808
> 
> 赞同：2
> 
> 时间：2012-11-12T21:25:25.590
> 
> 标签：c++

以下是有效的表示吗？我知道字节顺序，这是一个 Windows 环境。如果我定义`Int32Double myVar`；如果是计算值，将`myVar.int32.low`始终相同？ 例如：`myVar.d`
`myVar.d = 0.4 * log(4); printf("%08X\n", myVar.int32.low);`

```
union Int32Double
{
    struct
    {
        int low;
        int high;
    } int32;

    double d;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:29:00.690

不，这是写入`d`和读取`int32`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:47:27.863

首先，整数类型和浮点类型的对象表示通常非常不同。将对象的任何部分重新解释`double`为`int`对象通常不会产生任何类似于原始值的`double`值。结果不会有意义，除非你真的知道你在做什么。如果确实知道自己在做什么，则可以使用*无符号*整数类型进行重新解释。

其次，在 C++ 中使用联合进行内存重新解释是非法的。它会导致未定义的行为。C99 规范的最新技术更正之一实际上使其在 C 语言中合法（当然，具有实现定义的行为，只要我们不尝试访问陷阱表示）。但是 AFAIK 它还没有在 C++ 中。因此，使用风险自负。

PS我不确定你的“将永远是一样的”是什么意思......

# android - Android 中的 Intent 附加功能

> ID：13351811
> 
> 赞同：1
> 
> 时间：2012-11-12T21:25:29.713
> 
> 标签：android, android-intent

在我的 Andoird 应用程序中，我通过以下代码将附加信息传递给其他意图：

```
Intent i = new Intent(getApplicationContext(), NoteDetail.class);
i.putExtra("note_id", note_id);
startActivityForResult(i, 100); 
```

在 noteDetail 中，通过以下代码获取附加信息：

```
if (i.hasExtra(Key_NOTE_ID)) {

    // Must Update the note
    KEY_HAS_NOTE_ID = true;
    noteId = i.getStringExtra(Key_NOTE_ID);
    Log.i("Note Id is >>", noteId.toString());

    ConnectionDetector cd = new ConnectionDetector(
            getApplicationContext());
    if (cd.isConnectedToInternet()) {

        new GetNoteDetail().execute();

    } else {

        Toast.makeText(NoteDetail.this,
                R.string.not_connected_to_internet, Toast.LENGTH_SHORT)
                .show();
    }
} 
```

应用程序正常工作并且附加内容正确传递和接收，直到按下手机上的返回按钮并返回到以前的活动。当我再次按下 noteDetail 按钮并转到 noteDetail 活动时，之前的 note_id 仍然存在且不清楚。当用户按下手机上的返回按钮时，我想清除额外内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:31:52.763

`onPause()`使用中：

```
if (getIntent().hasExtra(Key_NOTE_ID)) getIntent().removeExtra(Key_NOTE_ID); 
```

# python - 使用 Python 2.x 解析 JSON 文件

> ID：13351815
> 
> 赞同：0
> 
> 时间：2012-11-12T21:25:42.820
> 
> 标签：python, json, parsing, python-2.7

我目前正在尝试解析包含许多 Facebook 聊天片段的文本文件。片段存储如下：-

```
{"t":"msg","c":"p_100002239013747","s":14,"ms":[{"msg":{"text":"2what is the best restauran
t in hong kong? ","time":1303115825598,"clientTime":1303115824391,"msgID":"1862585188"},"from":10000
2239013747,"to":635527479,"from_name":"David Robinson","from_first_name":"David","from_gender":1,"to_name":"Jason Yeung","to_first_name":"Jason","to_gender":2,"type":"msg"}]} 
```

我尝试了多种方法来解析/打开 JSON 文件，但无济于事。这是我迄今为止尝试过的： -

```
import json

data = []
with open("C:\\Users\\Me\\Desktop\\facebookchat.txt", 'r') as json_string:
    for line in json_string:
        data.append(json.loads(line)) 
```

*错误：*

```
Traceback (most recent call last):
  File "C:/Users/Amy/Desktop/facebookparser.py", line 6, in <module>
    data.append(json.loads(line))
  File "C:\Program Files\Python27\lib\json\__init__.py", line 326, in loads
    return _default_decoder.decode(s)
  File "C:\Program Files\Python27\lib\json\decoder.py", line 366, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "C:\Program Files\Python27\lib\json\decoder.py", line 382, in raw_decode
    obj, end = self.scan_once(s, idx)
ValueError: Invalid control character at: line 1 column 91 (char 91) 
```

并且：

```
import json

with open("C:\\Users\\Me\\Desktop\\facebookchat.txt", 'r') as json_file:
    data = json.load(json_file) 
```

...但我得到与上面完全相同的错误。

有什么建议么？我在这里搜索了以前的帖子并尝试了替代解决方案，但无济于事。我知道我需要将其视为字典文件，例如，“时间”是一个键，“1303115825598”是相应的时间值，但如果我什至无法将 json 文件处理到内存中，我就没有办法可以解析它。

我哪里错了？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:29:20.503

您的数据包含 JSON 不允许的换行符。您必须再次将线条缝合在一起：

```
data = []
with open("C:\\Users\\Me\\Desktop\\facebookchat.txt", 'r') as json_string:
    partial = ''
    for line in json_string:
        partial += line.rstrip('\n')
        try:
            data.append(json.loads(partial))
            partial = ''
        except ValueError:
            continue  # Not yet a complete JSON value 
```

该代码将行收集到`partial`中，但减去换行符，并尝试解码 JSON。如果成功，`partial`则再次设置为空字符串以处理下一个条目。如果失败，我们循环到下一行追加，直到有*一个*完整的 JSON 值要解码。

# python - 扫描网站内容（快速）

> ID：13351816
> 
> 赞同：4
> 
> 时间：2012-11-12T21:25:45.230
> 
> 标签：python, web-crawler

我在数据库中有数千个网站，我想在所有网站中搜索特定字符串。最快的方法是什么？我认为我应该首先获取每个网站的内容 - 这就是我这样做的方式：

```
import urllib2, re
string = "search string"
source = urllib2.urlopen("http://website1.com").read()
if re.search(word,source):
    print "My search string: "+string 
```

并搜索字符串。但这非常慢。如何在 python 中加速它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:31:55.947

我不认为你的问题是程序 - 这是你正在为数千个站点执行 HTTP 请求的事实。您可以研究涉及某种并行处理的不同解决方案，但无论您使解析代码的效率如何，您都将在当前实现中遇到请求的瓶颈。

这是一个使用`Queue`和`threading`模块的基本示例。我建议阅读多处理与多线程的好处（例如@JonathanV 提到的帖子），但这有望有助于理解正在发生的事情：

```
import Queue
import threading
import time
import urllib2

my_sites = [
    'http://news.ycombinator.com',
    'http://news.google.com',
    'http://news.yahoo.com',
    'http://www.cnn.com'
    ]

# Create a queue for our processing
queue = Queue.Queue()

class MyThread(threading.Thread):
  """Create a thread to make the url call."""

  def __init__(self, queue):
    super(MyThread, self).__init__()
    self.queue = queue

  def run(self):
    while True:
      # Grab a url from our queue and make the call.
      my_site = self.queue.get()
      url = urllib2.urlopen(my_site)

      # Grab a little data to make sure it is working
      print url.read(1024)

      # Send the signal to indicate the task has completed
      self.queue.task_done()

def main():

  # This will create a 'pool' of threads to use in our calls
  for _ in range(4):
    t = MyThread(queue)

    # A daemon thread runs but does not block our main function from exiting
    t.setDaemon(True)

    # Start the thread
    t.start()

  # Now go through our site list and add each url to the queue
  for site in my_sites:
    queue.put(site)

  # join() ensures that we wait until our queue is empty before exiting
  queue.join()

if __name__ == '__main__':
  start = time.time()
  main()
  print 'Total Time: {0}'.format(time.time() - start) 
```

有关`threading`特别好的资源，请参阅 Doug Hellmann 的帖子，[此处](http://www.doughellmann.com/PyMOTW/threading/)是 IBM 文章（[这](http://www.ibm.com/developerworks/aix/library/au-threadingpython/)已成为我的一般线程设置，如上所示）和实际文档[此处](http://docs.python.org/2/library/threading.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:03:55.827

尝试研究使用多处理同时运行多个搜索。多线程也可以工作，但如果管理不当，共享内存可能会变成一个诅咒。查看[此讨论](https://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python)以帮助您了解哪种选择适合您。

# php - 当用户点击谷歌广告链接时，网站表单不起作用

> ID：13351818
> 
> 赞同：0
> 
> 时间：2012-11-12T21:25:47.313
> 
> 标签：php, javascript, html, forms

我们似乎无法弄清楚我们网站上的表格存在问题。如果有人直接访问网站 URL，它会 100% 正确运行。我们为 Google Ads 付费以引导人们访问我们的网站。如果有人点击付费的 Google Adword 并访问我们的网站 - 当他们填写表格时，提交按钮不起作用。然后，我们会收到大约 30 多封相同请求的电子邮件。

我不知道如何解决这个问题。我一直在网上搜索，但找不到类似的问题。

我们通过在 Chrome、IE、Firefox 和 Safari 中直接访问网站来测试该表单。这些都工作正常。

当有人浏览 Google 广告时 - 这些浏览器都不起作用。通常在填写并提交表格后，会出现一个弹出窗口，上面写着“感谢提交...”。在浏览 Google Ads 时，不会出现弹出窗口，并且表单也不会告诉用户它已被提交，并且我们收到了许多通过电子邮件发送给我们的重复请求。

这里有什么想法吗？这听起来很奇怪，但我们已经对此进行了彻底的测试，这就是我们得到的结果。

我们正在使用 PHP 和 HTML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:32:04.697

Google 广告通常会在您的 URL 中添加 GET 参数，这可能会影响您的表单。

例如，如果您的表单位于

```
http://www.mydomain.com/page.php?id=123 
```

Google 广告实际上可能会请求

```
http://www.mydomain.com/page.php?id=123&gclid=DPDCaYGxzrMCFcVY3godsiMAoA 
```

来自 Google 的有关添加这些查询字符串的原因/时间的更多信息

[https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCampaigns](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCampaigns)

# javascript - 如何跟踪实际单击委托的元素？

> ID：13351820
> 
> 赞同：2
> 
> 时间：2012-11-12T21:25:58.683
> 
> 标签：javascript, jquery, delegates, html-table

给定一个表行 (TR)。每当用户单击表格行时，我都想选中该复选框，类似于在 Google Drive / Google Docs 上看到的。

复选框或任何标签例外，`<a>`因为它们具有不同的操作...如果用户单击复选框或`<a>`标签，我不希望复选框自动选中/取消选中。如何设置跟踪点击的绑定并让代码知道是选择复选框还是忽略，因为它是复选框或`<a>`标签点击？

jsfiddle 示例：http: [//jsfiddle.net/xHKUZ/1/](http://jsfiddle.net/xHKUZ/1/)

**示例代码：**

```
<table>
<tr>
        <td class="selector">
            <input type="checkbox" name="folders" value="67">
        </td>
        <td class="name">
            <a>Item 15</a>
        </td>
        <td class="creator">
            <span class="creator">Your Name</span>
        </td>
        <td class="last_modified">
            <time class="" datetime="2012-11-11T00:08:09Z">Nov-10 4:08 PM</time>
        </td>
        <td class="actions">
            <div class="actions-group">
                <a class="dropdown-toggle" data-toggle="dropdown">
                    <i class="icon-gear">Settings</i>
                    <i class="icon-caret"></i>
                </a>
                <ul class="dropdown-menu dropright">
                    <li><a data-rename="true">Rename</a></li>
                    <li><a data-archive="true">Delete</a></li>
                </ul>
            </div>
        </td>
</tr>
</table> 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:29:06.387

我会`e.stopPropagation`在那些你不想处理行点击的元素上使用。见下文，

**选项1：**

```
$("table").on('click', '.noclick', function (e) {
    e.stopPropagation();
}).on("click", "td", function(e) {
    console.log(e);
}); 
```

**HTML：**

```
<input type="checkbox" class="noclick" name="folders" value="67"> 
```

**演示：http:** [//jsfiddle.net/xHKUZ/7/](http://jsfiddle.net/xHKUZ/7/)

**选项 2：**

如果你想阻止整个`TD`，那么你可以简单地

```
$("table").on('click', 'td:not(.noclick)', function (e) {
    console.log(e);
}); 
```

或者只是自己处理。

```
$("table").on('click', 'td', function (e) {
    if ($(this).hasClass('noclick')) { return; }
    console.log(e);
}); 
```

**HTML：**

```
 <td class="selector noclick">
     <input type="checkbox" name="folders" value="67">
 </td> 
```

**演示：http:** [//jsfiddle.net/xHKUZ/16/](http://jsfiddle.net/xHKUZ/16/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:31:26.343

```
$("table").delegate("td", "click", function(e) {
  console.log(e);
  // e.delegateTarget === your table element
  // e.currentTarget === the td clicked
  // e.target === the actual element that you clicked
});​ 
```

您应该能够检查节点类型`e.target`以获得所需的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:29:10.760

jQuery [on()](http://api.jquery.com/on/)方法：

```
$("table").on("click", "input", function(event){
   var clicked_checkbox = $(this);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:42:26.627

干得好：

```
$("tr").click(function(event){
    if(!$(event.srcElement).is("a"))
    {
        var checkbox = $(this).find('input[type="checkbox"]');
        $(checkbox).prop("checked",!$(checkbox).prop("checked"));
    }
});​ 
```

[http://jsfiddle.net/mwk6W/1/](http://jsfiddle.net/mwk6W/1/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-12T21:37:41.357

如果您希望在用户单击`a`or时触发另一个函数`checkbox`，而不触发“默认”函数，只需返回`false`这些其他函数，例如：

```
$("table").delegate("td", "click", function(e) {
    // Default stuff...
    console.log(e);
});

$( 'a' ).click( function() {
    // Do something else...
    return false;
});

$( 'input[type="checkbox"]' ).click( function() {
    // Do something else...
    return false;
}); 
```

​</p>

# svn - 从 SubVersion/SmartSVN 中删除文件

> ID：13351827
> 
> 赞同：6
> 
> 时间：2012-11-12T21:26:43.927
> 
> 标签：svn, smartsvn

我使用 SmartSVN 作为 Subversion 的前端。有时，受存储库控制的源文件会变得多余——我根本不再需要它。在这种情况下，我想删除它，因为更新工作副本不再从存储库中获取文件。但我仍然希望文件的历史记录（即先前提交的修订）保留在存储库中。

如果我没记错的话，SmartSVN 的`Remove`命令会删除文件的历史记录（我显然不愿意验证这一点）。如果我错了，请纠正我。否则：我怎样才能达到预期的效果？

**编辑：**使用虚拟文件，确认`Remove`完全从 SVN 控件中删除文件，并且其历史记录不再可见。所以问题是真实的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T00:46:15.993

Subversion 永远不会从存储库中完全删除文件。事实上，这是一个很好的功能。

您执行`svn delete`or `svn rm`，文件不再在工作副本中。但是，它肯定还在。可能使您确信该文件已被永久删除的是您正在执行以下操作：

```
 $ svn co http://repo/svn/project
 [...]
 $ cd project
 $ svn del foo.txt
 $ svn commit -m "Removed foo.txt"
 committed version 12345
 $ svn ls http://repo/svn/project/foo.txt
 No such file 
```

这是真实的。文件`foo.txt`不再位于 Subversion 的最新版本中。

也许你做了这样的事情：

您知道该文件不在修订版 12345 中，因为您删除了它。但是，让我们看看修订版 12344。该文件应该仍然存在于那个修订版中：

```
 $ svn ls -r12344 http://repo/svn/project/foo.txt
 No such file 
```

你看，12344版本里没有revision，所以已经永久删除了。

没那么快，邦基。您请求的是存储库布局的当前修订版中文件的修订版 12344。您需要做的是了解文件修订版和存储库修订版之间的区别。这被称为[修订挂钩](http://svnbook.red-bean.com/en/1.7/svn.advanced.pegrevs.html)，并且可能是 Subversion 中比较困难的概念之一。

您要查看的是 REPOSITORY 第 12,344 修订版中的文件。为此，您`@`在存储库 URL 的末尾放置一个：

```
 $ svn ls http://repo/svn/project/foo.txt@12344
 foo.txt 
```

现在，我们可以看到该文件，因为它位于该存储库布局的第 12,344 版中。如果您需要取消删除文件，您始终可以从存储库布局的挂钩修订版中复制所需文件的修订版：

```
 $ svn cp -r12344 -m"undeleting foo.txt" \
       http://repo/svn/project/foo.txt@12344 \
       http://repo/svn/project 
```

这会将存储库第 12,344 修订版的文件的修订版 12344 复制`foo.txt`到存储库的当前修订版。

查找已删除文件的最简单方法是查看`svn log`：

```
 $ svn log -rHEAD -v http://repo/svn/project/foo.txt
 r12345 | dweintraub | [...]

 Removed foo.txt

 D  /project/foo.txt
 ----------------------------------------------------- 
```

我在修订版 12345 中删除了文件 `foo.txt。因此，它仍然存在于修订版 12344 中。很高兴知道我是否需要取消删除该文件。

是的，在这种情况下，我必须请求修改文件和 Subversion 布局可能看起来很愚蠢，因为它们都是相同的。但是，情况并非总是如此。文件被移动和复制、删除和取消删除。我想要的文件版本可能与我正在寻找的存储库版本不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-27T13:26:02.597

在 SmartSVN 中：

选择文件/文件夹->右键单击->“在存储库浏览器中打开”->右键单击要删除的文件/文件夹->“删除...”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T16:47:36.877

我接受了 David W. 的回答——它从 Subversion 的角度正确地描述了事物的状态（基于命令行）。由于我使用 SmartSVN 作为 GUI 前端，我想从这个角度添加适当的信息。

要使用 SmartSVN 查看已删除文件的历史记录，

*   打开存储库浏览器（与项目窗口相反）
*   发出`Repository | Show Revision`命令
*   选择`Revision`单选按钮；然后点击`Select`按钮
*   选择要查看的存储库修订

然后，您将看到该文件，前提是它存在于您选择的存储库版本中。

请注意，所选文件夹决定了显示哪些文件（似乎没有办法像在项目窗口中那样显示所有文件），以及显示哪些存储库修订版以供选择。

# ajax - 使用 jsonp 访问 stackoverflow API 会产生意想不到的结果

> ID：13351833
> 
> 赞同：1
> 
> 时间：2012-11-12T21:27:04.503
> 
> 标签：ajax, api, jsonp

我正在尝试通过执行以下操作以 jsonp 作为数据类型访问 Stackoverflow API：

```
$(document).ready(function(){
        $.ajax({
          url: 'http://api.stackoverflow.com/1.1/tags/php/top-answerers/month',
          dataType: 'jsonp',
        });
      }); 
```

一旦我重新加载，我会在控制台中得到以下信息：

```
"Uncaught SyntaxError: Unexpected token :" 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:57:45.440

来自[https://api.stackexchange.com/docs](https://api.stackexchange.com/docs)

> 所有 API 响应都是 JSON，我们确实支持带有回调查询参数的 JSONP。API 中的每个响应都在一个通用的“包装器”对象中返回，以便更轻松、更一致地解析。

所以你应该使用`dataType: 'json'`而不是`jsonp`.

您还应该升级到 2.1 API，1.x API 已弃用 6 个月。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:40:17.727

现在应用程序正在返回 Content-Type: `application/json`。

您可以通过覆盖回调函数名称来解决此问题，该名称`jsonp`将告诉服务器返回 Content-Type: `application/javascript`：

```
$(document).ready(function () {
    $.ajax({
        url: 'http://api.stackoverflow.com/1.1/tags/php/top-answerers/month',
        dataType: 'jsonp',
        jsonp: 'jsonp',
        success: function (data) {
            alert(data.top_users.length + ' users retrieved.');
        }
    });
}); 
```

有关 jsonp ajax 设置的信息：

> **jsonpString**
> 
> 覆盖 jsonp 请求中的回调函数名称。在“callback=?”中将使用该值代替“callback” url 中查询字符串的一部分。所以 {jsonp:'onJSONPLoad'} 会导致 'onJSONPLoad=?' 传递给服务器。从 jQuery 1.5 开始，将 jsonp 选项设置为 false 会阻止 jQuery 将“?callback”字符串添加到 URL 或尝试使用“=?”。为转型。在这种情况下，您还应该明确设置 jsonpCallback 设置。例如，{ jsonp: false, jsonpCallback: "callbackName" }

# html - CSS + 不同大小的文本区域以适合图像

> ID：13351840
> 
> 赞同：0
> 
> 时间：2012-11-12T21:27:49.407
> 
> 标签：html, css

[http://jsfiddle.net/adamadam123/qv2yR/](http://jsfiddle.net/adamadam123/qv2yR/)

以上是我目前正在使用的代码。下面是我想要实现的图像。

![在此处输入图像描述](../Images/c83fdf0450638ff932fc9dea84eb8a27.png)

它基本上是一个聊天框“IM”，我有一个蓝色和粉红色的图像，需要能够获得不同数量的文本才能放在图像中。

我也尝试使用图像作为 CSS 背景，但发现它没有拉伸以适应文本。还尝试了浮动和绝对定位。

任何帮助将不胜感激。

谢谢

```
 <div class="chatMessengerBody">

        <div class="chatMessengerChatBubble chatMessengerChatBubbleBlueWrapper">
            <img src="images/chat-messenger-chat-bubble-blue.png" class="chatMessengerChatBubble chatMessengerChatBubbleBlue"/>
            <p class="chatMessengerChatBubbleContent">Great, thanks for asking. Never better to tell you the truth. So how about those dolphins?
            Great, thanks for asking. Never better to tell you the truth. So how about those dolphins?
            Great, thanks for asking. Never better to tell you the truth. So how about those dolphins?
            </p>
        </div>

        <div class="chatMessengerChatBubble chatMessengerChatBubblePinkWrapper">
            <img src="images/chat-messenger-chat-bubble-pink.png" class="chatMessengerChatBubble chatMessengerChatBubblePink"/>
            <p class="chatMessengerChatBubbleContent">Great, thanks for asking. Never better to tell you the truth. So how about those dolphins?</p>
        </div>

    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:35:27.947

为什么不使用一些 CSS 和 CSS3 圆角来代替图像：

```
.chatMessengerChatBubblePinkWrapper {
    background:#fff8f2;
    border:1px solid #ffeadb;
    -webkit-border-radius: 5px;
    border-radius:5px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:35:41.720

[http://jsfiddle.net/qv2yR/10/](http://jsfiddle.net/qv2yR/10/)

CSS

```
.blue {
    background: #EBF7FF;
    border: 1px solid #D4F1FD;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    color :#6B95B0;
    margin-bottom: 5px;
    padding: 5px;    
    width: 200px;
}

.pink {
    background: #FFF8F2;
    border: 1px solid #FFEEE4;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    color :#D386A8;
    margin-bottom: 5px;
    padding: 5px;    
    width: 200px;
} 
```

HTML

```
<div class="blue">
 this is the blue one
</div>

<div class="pink">
    this is the pink one.
</div> 
```

# apache-flex - 为什么与纯 ActionScript 相比，简单 FLEX 应用程序中的动画如此缓慢？将 MXML 用于游戏？

> ID：13351841
> 
> 赞同：1
> 
> 时间：2012-11-12T21:27:59.383
> 
> 标签：apache-flex, mobile, actionscript, mxml

我在 Android 上创建了一个针对 AIR 的快速渲染速度测试，并制作了 2 个项目；仅限移动 AS3 和 FLEX。他们使用一个嵌入动画并在其中包含一些帧计数逻辑的通用类。我明确地将 scaleMode 设置为 NO_SCALE，将 frameRate 设置为 24，并将 quality 设置为 StageQuality.HIGH。据我所知，编译器选项是相同的，只是 FLEX 项目有更多对框架 SWC 的引用。

结果在 FLEX 中约为 6-8 FPS，而在 AS3 中为 12-14。虽然 FLEX 会更慢是有道理的，但差异比我预期的要大，有什么想法吗？

我正在开发一个使用 MXML 制作手机游戏的项目。我个人认为它极大地影响了性能，这就是我创建上面的简单测试的原因。关于使用 MXML 制作手机游戏的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:45:25.680

Flex 不适用于注重性能的移动开发。它在后台做了很多不必要的事情，会影响性能。如果必须，仅 AS3 代码将为您提供最佳结果。

# php - 检查网站请求的 cookie

> ID：13351843
> 
> 赞同：1
> 
> 时间：2012-11-12T21:28:11.397
> 
> 标签：php, cookies

只是一个简单的问题，有什么方法可以知道您访问网站时请求的 cookie 是什么？

例如，如果我访问 www.some-membership-site.com 并且它正在寻找“isLoggedIn”cookie，则可以通过任何方式获取 cookie 的名称（在本例中为“isLoggedIn”）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:31:08.190

它的工作方式不是让网站“请求”cookie，而是浏览器自动返回该网站之前设置的cookie

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:31:34.507

从技术上讲不是，因为“寻找 cookie”部分是在服务器端完成的。Cookie 随请求一起发送，无论服务器是否需要它们。

但是，如果您使用浏览器工具或其他工具查看该请求数据，您将看到正在使用哪些 cookie，并且可以从中了解需要什么。

# python - 如何强制 Tornado websockets 在握手时生成错误页面

> ID：13351844
> 
> 赞同：1
> 
> 时间：2012-11-12T21:28:16.960
> 
> 标签：python, websocket, tornado

我正在编写一个使用 Tornado websockets 的小应用程序。我使用 cookie 进行身份验证，因此我想在建立 Web 套接字时检查这一点。

所以这是挑战（基于官方 websockets 示例）：

```
class EchoWebSocket(tornado.websocket.WebSocketHandler):
    def open(self):
        userx = self.get_secure_cookie("user")
        if not userx:
            self.send_error(403) #I want to redirect or otherwise stop the user
        print "WebSocket opened"

    def on_message(self, message):
        userx = self.get_secure_cookie("user")
        self.write_message(u"%s said: %s" % (userx, message))

    def on_close(self):
        print "WebSocket closed" 
```

原来这在 Tornado 中不是很流行，抛出这个错误：

```
ERROR:root:Exception in callback <tornado.stack_context._StackContextWrapper object at    0x10fa10db8>
Traceback (most recent call last):
 ....
  File "/Library/Python/2.7/site-packages/tornado-2.4-py2.7.egg/tornado/iostream.py", line 565, in _check_closed
raise IOError("Stream is closed")
IOError: Stream is closed 
```

在 websockets 握手期间甚至可以“验证或取消”吗？这是我的代码有问题，还是 Tornado 有问题/缺少功能？在这种情况下，Tornado 是否能够通过 websockets 发送一些错误条件来触发客户端的 onerror 处理程序（在手册中找不到任何强制错误条件的方法）？

我试图实现的事件顺序是：

1.  用户使用常规 Web 请求登录，会话令牌存储为安全 cookie

2.  用户加载使用 websockets 的页面，javascript 尝试建立套接字

3.  在建立套接字之前，我想检查是否存在有效的会话令牌

    *   如果令牌有效，则建立套接字并且我的应用程序按预期工作
    *   如果令牌无效，则没有套接字，并且用户收到错误消息（或者，服务器会引发 websocket 错误条件）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T07:04:02.433

您可以跟踪您的用户，您可以轻松地做到这一点，因为每个连接到服务器的用户都会创建一个实例，请查看此[SO 链接](https://stackoverflow.com/questions/11695375/tornado-identify-track-connections-of-websockets)。

关于如果他没有通过身份验证你想关闭连接，你可以通过调用 WebSWebSocketHandler 实例中的 close() 方法来做到这一点，如下所示：

```
class WSHandler(tornado.websocket.WebSocketHandler):

def open(self):
    if not condition:
        self.close() 
```

在 Tornado 中检查：`tornado.websocket.WebSocketHandler.WebSocketHandler.close()`

我自己没试过。你可以试试，告诉我它是否适合你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T13:08:39.033

这是？

[http://www.tornadoweb.org/documentation/web.html#tornado.web.RequestHandler.write_error](http://www.tornadoweb.org/documentation/web.html#tornado.web.RequestHandler.write_error)

可以覆盖`handle.write_error`方法，不知道`WebSocketHandler`有没有这个方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T21:36:14.900

看起来这个问题的答案就像 Nikolay Fominyh 建议的那样（尽管我不能接受这个答案，因为它是评论而不是答案）向用户发送消息并关闭连接。这似乎是目前解决这个问题的最佳方法。

# c# - 表示大字节数组的最佳方式

> ID：13351846
> 
> 赞同：3
> 
> 时间：2012-11-12T21:28:24.763
> 
> 标签：c#, arrays

我正在寻找在内存中存储和管理大字节数组的最有效方法。我将需要从数组中的任何位置插入和删除字节。

起初，我认为常规数组是最好的。

```
byte[] buffer = new byte[ArraySize]; 
```

这将允许我访问数组中的任何字节。我也可以调整数组的大小。但是，似乎没有任何内置支持在数组中*移动或移动项目。*

一种选择是有一个循环来逐个移动项目，但这在 C# 中听起来非常低效。另一种选择是创建一个新数组并将字节复制到正确的位置，但这需要复制数组中的所有数据。

没有更好的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:31:39.967

实际上，我刚刚找到了[Buffer Class](http://msdn.microsoft.com/en-us/library/system.buffer.aspx)，它看起来非常适合我的需要。

看起来该`BlockCopy`方法将阻止复制一堆项目并支持在同一数组内复制，甚至可以正确处理重叠项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:35:10.763

我认为在这种情况下最好的选择是常规数组和列表之间的混合。不过，只有兆字节大小的数组才需要这样做。

所以你可以做这样的事情：

```
List<byte[]> buffer; 
```

并且让列表中的每个元素都只是数据的一部分（比如 64K 或一些小且易于管理的东西）

它需要相当多的自定义代码，但在必须在大型数组中移动数据时绝对是最快的选择。

此外，如果你做的字节转换比其他任何事情都多，`LinkedList<T>`可能会更好（但除了一组特定的情况外，它对所有事情都不利）

为了阐明为什么这比数组更正确，请考虑在数组的开头插入 1 个字节。您必须分配另一个数组（双倍内存消耗），然后在插入新字节后将每个字节复制到新数组，然后释放旧数组（可能堆损坏取决于大小）

现在考虑这个带有列表的方法。

如果您必须插入大量字节，您可能希望在`buffer`列表的开头插入。这是一个 O(n) 操作，所以这个操作的结束效率是 O(n/CHUNK_SIZE)

或者，如果您只需要插入一个字节，您可以获取列表的第一个元素并照常复制数组。然后，速度是 O(CHUNK_SIZE)，这并不可怕，特别是如果`n`相比之下非常大（兆字节数据）

# ios - CCTMXTileMap 适用于模拟器但不适用于设备

> ID：13351847
> 
> 赞同：0
> 
> 时间：2012-11-12T21:28:55.527
> 
> 标签：ios, cocos2d-iphone, ios-simulator, device, tmx

我有一个 TMX 平铺地图，用于我正在制作的使用 cocos2d 的应用程序的背景。当我使用模拟器时，一切运行良好。但是，如果我使用该设备，一切都会出错。启动时，它以全屏的加载屏幕开始，但很快过渡到： ![加载后的图像](../Images/62fa0f017c9c90cc90dda920835c2e6f.png)

然后是黑屏。然后它给了我控制台输出：

```
1970-01-02 10:57:56.-721 TankMazeNEW[729:707] cocos2d: surface size: 960x640
1970-01-02 10:57:56.-709 TankMazeNEW[729:707] cocos2d: CCTexture2D: Using RGB565texture since image has no alpha
1970-01-02 10:57:57.-645 TankMazeNEW[729:707] -[CCFileUtils fullPathFromRelativePath:resolutionType:] : cocos2d: Warning: File not found: /Users/vivaanbahl/Desktop/Iphone Apps/TankMazeNEW/TankMazeNEW/tanks.png
1970-01-02 10:57:57.-642 TankMazeNEW[729:707] cocos2d: CCTexture2D. Can't create Texture. cgImage is nil
1970-01-02 10:57:57.-638 TankMazeNEW[729:707] cocos2d: Couldn't add image:/Users/vivaanbahl/Desktop/Iphone Apps/TankMazeNEW/TankMazeNEW/tanks.png in CCTextureCache
1970-01-02 10:57:57.-528 TankMazeNEW[729:707] cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from [3501] to [4669].
1970-01-02 10:57:57.-487 TankMazeNEW[729:707] cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from [4669] to [6226].
1970-01-02 10:57:57.-435 TankMazeNEW[729:707] cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from [6226] to [8302].
1970-01-02 10:57:57.-364 TankMazeNEW[729:707] cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from [8302] to [11070]. 
```

它“未找到”的图像是包含平铺外观图像的源图像，它位于项目文件夹内，位于日志中上面指定的文件路径中。有人可以看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T23:48:11.537

我遇到了同样的问题：对我有用的是将图块集的 .png 文件也添加到 Xcode 项目中。当它在模拟器中运行时，Xcode 知道如何找到 .png 文件，因为它与 .TMX 文件位于同一文件夹中。在将 tile set .png 添加到 Xcode 项目后，它在设备上也可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:12:34.250

```
resizing TextureAtlas capacity from [8302] to [11070]. 
```

我打赌你的瓷砖地图太大了。在模拟器上这并不重要，因为模拟器会使用你的 Mac 内存，它可能在 2 到 16 GB 之间。iPad 可以提供的最大容量是 1 GB，而早期的设备只有 128 到 512 MB。

做一个简单的数学测试：将你的 tilemap 宽度和高度相乘，然后乘以 tilemap 中的 tile 层数。如果每个图块只需要 1 个字节，那么这将为您提供 tilemap 将使用的最小内存量（以字节为单位）。

由于情况并非如此，因此将该数字乘以 50 字节，这更接近于 tile 的实际消耗量（肯定超过 32 个字节）。

具有两层的 1000x1000 瓦片地图消耗近 100 兆字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:19:38.450

tank.png 拼写是否正确？

在记事本中打开 TMX 文件并搜索 tank.png 以查看它是否拼写错误或不在正确的路径中。

# c - 从信号处理程序中杀死子进程

> ID：13351851
> 
> 赞同：2
> 
> 时间：2012-11-12T21:29:14.340
> 
> 标签：c, linux, shell, unix

我正在编写一个简单的 shell，我必须使用 execv 将一个子进程分叉一个外部程序。我必须将信号 TSTP(Cntl+Z) 发送到信号处理程序，然后终止当前正在运行的子进程。我的问题是我找不到将子 pid 传递给信号处理程序的方法。如果我在处理程序中执行 getpid()，它只会返回父 pid。我还尝试在子进程中将子 pid 设置为 getpid() ，并将该变量作为全局变量，但这也不起作用。这是我到目前为止的一些代码。

```
void handler(int);
//in main
if (!built_in_cmd(myArgc,myArgs)) {
    pid_t pid;
    char *x = myArgs[0];
    if((pid=fork())<0)
        printf("Parent: fork() process failed");
    else {
        if (pid == 0) {
            y=getpid();
            printf("Parent: My child has been spawned. %d %d\n",y,getppid());
            execv(x, myArgs);
            exit(0);
        }
        else {
            signal(SIGTSTP,handler);
            wait(0);
            printf("Parent: My child has terminated.\n");
        }
    }
}
return;

//outside main
void handler(int signo){
    kill(idk,SIGKILL);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:42:34.620

信号本质上是异步的，除了通过全局变量之外，没有办法向它们传递任何额外的状态。假设你只有一个线程在等待一个孩子，使用全局是安全的，但除此之外没有多线程安全的方法：

```
// At global scope
pid_t child_pid = (pid_t)-1;
...
void myfunc()
{
    pid_t pid;
    if((pid = fork()) < 0)
        ...
    else if(pid == 0)
        ...
    else
    {
        child_pid = pid;
        ...
    }
} 
```

# javascript - 需要使用 jQuery、javascript 或任何其他插件修复 SVG DOM

> ID：13351862
> 
> 赞同：0
> 
> 时间：2012-11-12T21:29:44.467
> 
> 标签：javascript, jquery, jquery-plugins, svg

我正在使用 SVG 创建一个家谱，下面给出了一个小结构。我需要帮助在将鼠标悬停在类 - “节点”上时添加特定类（比如“选定”），在“g”的每个第一个“矩形”上，这是当前悬停的“节点”的父级。

> $this.addClass('classname') 不起作用。所以我使用 $this.attr('class','classname')
> 
> **无能为力：我需要一个像父母这样的函数（在 jQuery 中）或类似的方法来获取当前悬停的“rect”的所有父“g”。**
> 
> 当前工作 -[点击这里](http://demo.qzion.com/family/pages/tree)

样本结构。

```
<svg style="width:100%;height:455px" id="svg_root" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
    <g id="viewport" >
        <g id="1">
            <rect class="node" y="0" x="0" width="160" height="35" />
            <text class="prof_name" y="14" x="34">Name</text>
            <g id="2">
                <rect class="node" y="40" x="30" width="160" height="35" />
                <text class="prof_name" y="54" x="64">Name</text>
                <g id="7">
                    <rect class="node" y="80" x="90" width="160" height="35" />
                    <text class="prof_name" y="94" x="94">Name</text>
                </g>
            </g>
        </g>
        <g id="18">
            <rect class="node" y="120" x="0" width="160" height="35" />
            <text class="prof_name" y="134" x="34">Name</text>
        </g>
    </g>
</svg> 
```

我认为 jQuery 对 SVG 不友好 :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:09:15.887

我建议您使用 jQuery 插件，让您与 SVG 画布进行交互。正是这个[http://keith-wood.name/svg.html（SVG](http://keith-wood.name/svg.html) DOM 选项卡）

> SVG DOM 与设计 jQuery 的 HTML DOM 不同。特别是，任何可以动画的属性都存储为对象而不是纯字符串。这包括类属性。因此，与类一起使用的 jQuery 函数在 SVG 节点上不起作用。
> 
> 要克服这个问题，您可以使用 jQuery SVG DOM 扩展。

```
<script type="text/javascript" src="jquery.svgdom.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:39:06.260

您可以使用 raphael.js 添加事件处理程序。例如

```
var paper = new Raphael( "id", 200, 200 );
var rect = paper.rect( 0, 0, 160, 35 );

rect.mouseover( function( ) {
    // do stuff
}); 
```

更多信息和演示[在这里](http://raphaeljs.com)。

你的家谱如何在[这里工作的小提琴](http://jsbin.com/oririx/1/edit)

**更新**

尽管 Raphael.js 不提供查找 svg 元素父级的功能，但您仍然可以通过向 raphael 元素添加自定义属性来跟踪您的家谱。

我在这里创建了一个示例[来](http://jsbin.com/oririx/3/edit)展示您如何实现这一目标。希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:44:09.337

这对我有用。

```
$(window).ready(function(){
    $('#viewport .c_node').mouseenter(function(e) {
        paint_parent(e.target.parentNode);
    });
$('#viewport .c_node').mouseleave(function(e) {
        $('#viewport g').each(function(index, element) {
            $(element).attr('class',"");
        }); 
    });
});
function paint_parent(element){
        if(element.id!="viewport"){ // to the parent id viewport
        $('#'+element.id).attr('class',"cnode_parent");
        paint_parent(element.parentNode);
        }
    } 
```

# matlab - 贝叶斯分类器

> ID：13351864
> 
> 赞同：0
> 
> 时间：2012-11-12T21:29:52.927
> 
> 标签：matlab, classification, bayesian

在 matlab 中使用贝叶斯分类器时，避免过度拟合和不准确的最佳方法是什么？

我目前正在使用 1000 个样本作为训练数据，其中 750 个是“正常”，250 个是“异常”（一种特定类型）。

有没有人发现其中很大一部分可以训练分类器，或者每个问题都需要特定数量的训练数据。我会假设后者，但我正在努力弄清楚如何提高准确性，我可以使用什么方法。任何例子将不胜感激。

以下是我目前正在使用的示例：

```
training_data = data;
target_class = Book2(indX,:)

class  = classify(test_data,training_data, target_class, 'diaglinear')
confusionmat(target_class,class)

% Display Results of Naive Bayes Classification
input = target_class;
% find the unique elements in the input
uniqueNames=unique(input)';
% use string comparison ignoring the case
occurrences=strcmpi(input(:,ones(1,length(uniqueNames))),uniqueNames(ones(length(input),1),:));
% count the occurences
counts=sum(occurrences,1);
%pretty printing
for i=1:length(counts)
disp([uniqueNames{i} ': ' num2str(counts(i))])
end

% output matching data
dataSample = fulldata(indX, :) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T18:48:54.873

这是一个老问题，但也许从谷歌来到这里的人仍然可以从答案中受益。我没有在 Matlab 中使用 Naive Bayes，但在其他环境中有经验并编写了[ruby​​ nbayes gem](https://github.com/oasic/nbayes)。您在这里至少有几个问题，所以让我们解开它们。

**过度拟合和准确性。** 不要购买炒作——朴素贝叶斯肯定容易过度拟合，因此在测量分类器的有效性时确保使用交叉验证。我发现良好的特征选择（例如，删除无用的术语/标记）通常会提高准确性，也有助于减少过度拟合。而且，当然，更多的数据永远不会受到伤害（但如果你已经有很多数据可能无济于事）。

**类不平衡问题。** 看起来您正在尝试将新实例分类为“正常”或“异常”。通常，您希望类的平衡与现实世界中存在的内容（您正在建模的内容）相匹配。如果您选择不这样做，可能是因为异常实例太少，那么请确保您手动将类的先验分布设置为其实际值。

有关更详细的信息，我强烈推荐斯坦福 IR 书中的摘录：http: [//nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html](http://nlp.stanford.edu/IR-book/html/htmledition/naive-bayes-text-classification-1.html)

# php - 如何 在预填充的文本区域上转换为换行符

> ID：13351870
> 
> 赞同：2
> 
> 时间：2012-11-12T21:30:17.367
> 
> 标签：php, forms, textarea, newline, nl2br

我遇到了`<BR />`标签出现在预先填充的文本区域表单中的问题（显然没有中断）。所以这些break标签需要转换到`/n`textarea内。正在通过 URL 检索此预填充文本，该 URL 似乎也包含中断标记。

**基本上发生了什么以及我需要什么：**

我必须从前一页（最初是从数据库中提取）中获取一块文本，并将该文本块加载到表单提交页面上的 textarea 字段中。用户然后填写表单字段的其余部分并提交表单，然后此信息将存储到数据库中的特定表中。

为了让文本块在第一页上正确显示，我不得不使用`nl2br`让这部分在页面上正确中断。显然，现在它正在输出带有换行符而不是换行符的文本。

这意味着当您单击链接以填充下一页上的表单时，该链接中包含中断标记，这些标记依次显示在下一页的 textarea 字段内以及 URL 中。

我对我需要做些什么来再次替换那些`<BR />`'s感到困惑`/n`。似乎我可以使用`str_replace`or `preg_replace`，但我还没有找到如何将其中任何一个与以下内容结合使用的示例：

```
<textarea rows="10" cols="50"><? if(isset($_GET['text-property'])){ echo $_GET['text-property']; }?></textarea> 
```

请记住，我仍在学习 PHP 的过程中，所以如果可能的话，我真的需要细节，最好是示例。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:33:06.567

你需要使用`preg_replace`，

```
<textarea rows="10" cols="50"><? if(isset($_GET['text-property'])){ echo preg_replace('/<br[^>]*?>/si', '\n',$_GET['text-property']); }?></textarea> 
```

[演示](http://codepad.org/tYmWOXZJ)

# javascript - 如何从复选框中获取值

> ID：13351871
> 
> 赞同：1
> 
> 时间：2012-11-12T21:30:18.863
> 
> 标签：javascript

这是我的代码。我无法使警报起作用。

```
var chooseObject = document.getElementsByTagName("input");
var objectLength = chooseObject.length;
var hobbyArray = [];
    //hobbyArray("aaa");
    //hobbyArray("bbb");
    //alert(hobbyArray); This one works.
for(var i=0;i<=objectLength;i++){
    if((chooseObject[i].type=="checkbox")&&(chooseObject[i].checked==true)){
         //alert(chooseObject[i].value); This one works.
         hobbyArray.push(chooseObject[i].value); }
}
alert(hobbyArray); 
```

如果我执行最高警报（我已经发表评论），它会起作用。如果我在 for 循环中提醒 chooseObject[i].value ，那很好。但是如果我使用数组，它就失败了。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:34:31.490

你的`for`陈述有一个愚蠢的错误。这个：

```
for(var i=0;i<=objectLength;i++) 
```

应该：

```
for(var i=0;i<objectLength;i++) 
```

`TypeError`当您检查元素的属性（`chooseObject[objectLength]`给`undefined`，它没有属性）时，额外的迭代会导致。

# shopify - Shopify 模板或其他地方是否有数据验证？

> ID：13351874
> 
> 赞同：1
> 
> 时间：2012-11-12T21:30:25.557
> 
> 标签：shopify

我们正在使用 Shopify API 从订单中获取数据，但在履行方面的数据验证方面遇到了一些问题。有什么方法可以将数据验证添加到我们的结帐页面？即使只是 Javascript 验证也将是一个巨大的改进。当我们看到错误时，客户已经脱离了循环，因此我们不得不对用户的数据做出假设，这可能是危险的。

一个例子是用户输入了一个以 1 开头的电话号码，例如 (xxx)-1xx-xxxx，这是无效的。另一个人输入的地址对于我们发送它的运输 API 来说太长了。我们不想截断任意地址，那么有没有办法向客户显示错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:35:15.497

就 API 而言，结账服务器是一个黑盒子。这主要是出于安全原因。

不幸的是，这会阻止您在结帐过程中进行您所询问的那种额外验证。

# iphone - 获取 NSArray 的 EXC_BAD_ACCESS

> ID：13351877
> 
> 赞同：1
> 
> 时间：2012-11-12T21:30:44.333
> 
> 标签：iphone, objective-c, ios, uitableview, nsarray

我收到 NSArray 的 EXC_BAD_ACCESS 错误。还有其他阵列，它们工作正常。我在 viewDidLoad 中初始化了数组。每当我从不同的块访问它时，我都会收到错误消息。但是这个数组是在头文件中定义的。ARC 已开启。这是我的代码

头文件.h

```
@interface PopoverViewController : UITableViewController 
{ 
    NSArray *typeFilterItem; 
    NSArray *changeFilterItem; 
    NSArray *nFragmentFilterItems; 
} 
```

.m 文件

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;

    // set section
    typeFilterItem = [NSArray arrayWithObjects:@"All",
                      @"Type-1",
                      @"Type-2",
                      @"Type-3", nil];
    changeFilterItem = [NSArray arrayWithObjects:@"All",
                        @"Static Change",
                        @"Consistent Change",
                        @"Inconsistent Change", nil];

    nFragmentFilterItems = [NSArray arrayWithObjects:@"Min",
                            @"Max", nil]; // this is the array causing problem
    NSLog(@"count: %d", nFragmentFilterItems.count); // here its ok
    // set filters
    [self setAllTypeFilers];
    [self setAllChangePatternFilters];

} 
```

在合适的数据源中

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.

    /******* getting error at this line *****/
    NSLog(@"count: %d", nFragmentFilterItems.count);
    if (section == 0) {
        return typeFilterItem.count;
    } else if (section == 1) {
        return changeFilterItem.count;
    } else if (section == 2) {
        return 2;
    } else if (section == 3) {
        return 1;
    }
    return 0;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:48:39.637

如果在您的头文件中，您有：

```
@property(nonatomic, strong)NSArray *nFragmentFilterItems; 
```

你必须打电话：

```
self.nFragmentFilterItems = [NSArray arrayWithObjects:@"Min", @"Max", nil]; 
```

您还必须在实现文件中综合您的属性：

```
@synthesize nFragmentFilterItems; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T13:57:03.247

请试试这个

```
nFragmentFilterItems = [[NSArray arrayWithObjects:@"Min",
                            @"Max", nil] retain]; 
```

Tks

# java - java中的类和方法

> ID：13351881
> 
> 赞同：-1
> 
> 时间：2012-11-12T21:31:02.017
> 
> 标签：java, eclipse, javabeans

当我想尝试不是通过方法而是通过类来完成我的工作时，我只是在玩 Java。看看我做了什么。

```
import javax.swing.*;

class foolingAround{
    public static void main(String ARG[]) {
        createMyInterface();
    }

    private static void createMyInterface(){
        JFrame f = new JFrame("Frame from Swing but not from other class");
        f.setSize(100,100);
        f.setVisible(true);
        new createAnotherInterface();
    }

}

class createAnotherInterface{
    public static void main(String arg[]){
        giveMe();
    }

    static JFrame giveMe(){
        JFrame p = new JFrame("Frame from Swing and from another class");
        p.setSize(100,100);
        p.setVisible(true);
        return p;
    }
} 
```

它编译时没有显示任何错误，但`class createAnotherInterface`没有显示框架。为什么？我什么时候做不同的类而不是方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:32:54.363

实例化第二个类不会调用它的“main”方法——你必须`giveMe()`从第一个类显式调用该方法：

```
private static void createMyInterface(){
        JFrame f = new JFrame("Frame from Swing but not from other class");
        f.setSize(100,100);
        f.setVisible(true);
        new createAnotherInterface().giveMe();
    } 
```

“主”函数称为“入口点”，它是 JVM 在“启动”Java 应用程序时跳转到的函数。由于在不同的类中可以有多个 main，这就是为什么在从命令行启动时必须指定“哪个类”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:33:33.303

与`new createAnotherInterface();`您一起创建一个新对象，而不是启动`giveMe()`or `main`。

有多种方法可以“愚弄”来解决您的问题，可能最简单的方法是更改​​：

`new createAnotherInterface();`

进入

`createAnotherInterface.giveMe();`

另外，请注意这`createAnotherInterface`不是一个接口，一旦“foolingAround”阶段完成，您应该遵循[Java 编程语言的代码约定。](http://www.oracle.com/technetwork/java/codeconv-138413.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:34:21.380

你的 createAnotherInterface 类不应该有一个 main 方法，如果有，它就不会被调用。它应该有一个构造函数，或者您应该使用对该类实例的引用来调用 giveMe() 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T21:34:27.863

```
 new createAnotherInterface(); 
```

只会调用`createAnotherInterface`的默认构造函数。

您必须从您的班级`giveMe()`明确调用。`foolingAround`

```
private static void createMyInterface(){
    JFrame f = new JFrame("Frame from Swing but not from other class");
    f.setSize(100,100);
    f.setVisible(true);
    createAnotherInterface.giveMe();
} 
```

或为您的 CreateAnotherInterface 编写构造函数。

```
 class createAnotherInterface{
    public createAnotherInterface(){
    giveMe();
    }
    public class FoolingAround {
    private static void createMyInterface(){
        JFrame f = new JFrame("Frame from Swing but not from other class");
        f.setSize(100,100);
        f.setVisible(true);
        new createAnotherInterface();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T21:41:02.640

事实上，我已经复制了您的代码并进行了测试。文件名为`createAnotherInterface.java`.

它有效并且`JFrame`出来了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T21:42:26.660

您已命名该方法`giveMe`，考虑重构为构造函数`createAnotherInterface`或仅创建一个启动该方法的构造函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-12T21:54:35.107

您只是为 createAnotherInterface 类创建一个新对象，默认情况下它调用其默认构造函数，并且在该默认构造函数中没有调用 giveMe() 方法。

我不确定我是对还是错，但我要求您在“createAnotherInterface”类中创建一个构造函数，并在该构造函数中调用“giveMe()”方法。我希望这能解决你的问题。

或至少打电话

```
new createAnotherInterface().giveMe(); 
```

在您的 createMyInterface() 类中

# c++ - 为什么 UMDH 找不到我的符号？我可以在没有它们的情况下解释堆栈跟踪吗？

> ID：13351892
> 
> 赞同：1
> 
> 时间：2012-11-12T21:31:44.833
> 
> 标签：c++, mfc, symbols, umdh

我正在尝试使用 UMDH 调试内存泄漏。但是，它从未成功加载符号。我很确定我的设置正确 -

```
C:\Documents and Settings\Administrator>set _
_NT_SYMBOL_PATH=SRV*C:\Symbols*http://msdl.microsoft.com/download/symbols;E:\mysymbols

C:\Documents and Settings\Administrator>dir e:\mysymbols
 Volume in drive E is DataApps
 Volume Serial Number is F6F5-37AE

 Directory of e:\mysymbols

11/08/2012  03:20 PM    <DIR>          .
11/08/2012  03:20 PM    <DIR>          ..
11/08/2012  10:02 AM         2,630,656 Gen2EAPI.pdb
11/08/2012  10:07 AM         4,555,776 ObjectCommunicator.pdb
11/08/2012  10:01 AM         2,475,008 ObjSrvCommAPI.pdb
11/08/2012  10:02 AM         3,761,152 ScpmAPI.pdb
               4 File(s)     13,422,592 bytes
               2 Dir(s)  803,125,231,616 bytes free 
```

但 UMDH 拒绝加载 ObjectCommunicator.exe 的符号：

```
// Debug library initialized ...
DBGHELP: ObjectCommunicator - no symbols loaded
DBGHELP: ntdll - public symbols  
        C:\Symbols\ntdll.pdb\F7024C7F15FE4BEA992FF38BE58AC11C2\ntdll.pdb 
```

ObjectCommunicator.exe 是使用这些选项构建的（使用 vc 6.0。是的 - 它很旧，但升级不是一个选项）：

```
/nologo /MD /W3 /GR /GX /Zi /Od /I "..\Scpm Api" /I "..\ScpmImpl" /D "NDEBUG" /D "WIN32" /D "_WINDOWS" /D "_AFXDLL" /D "_MBCS" /D MODULE_NAME=\"ObjectCommunicator\" /Fp"Release/ObjectCommunicator.pch" /Yu"stdafx.h" /Fo"Release/" /Fd"Release/" /FD /c 
```

并与这些选项相关联（减去一些 .libs）：

```
/nologo /subsystem:windows /incremental:no /pdb:"..\Bin\Release/ObjectCommunicator.pdb" /debug /machine:I386 /out:"..\Bin\Release/ObjectCommunicator.exe" /IGNORE:4089 
```

为什么 UMDH 无法加载我的符号？有什么办法可以调试吗？如果没有，有没有办法像这样解释 UMDH 堆栈跟踪：

```
+   42432 (  45424 -   2992)    167 allocs  BackTraceAEB
+     156 (    167 -     11)    BackTraceAEB    allocations

ntdll!RtlAllocateHeapSlowly+41
ntdll!RtlAllocateHeap+E9F
msvcrt!malloc+6C
MFC42!operator new+15
ObjectCommunicator!???+0 : 402F71
ObjectCommunicator!???+0 : 43D6AC
ObjectCommunicator!???+0 : 43C523
ObjectCommunicator!???+0 : 43C3E4
MFC42!_AfxThreadEntry+FB
msvcrt!_endthreadex+A3
kernel32!BaseThreadStart+34 
```

特别是“ObjectCommunicator!???+0 : 43C3E4”是什么意思？例如，我可以对 CDB 做些什么，将其转化为有意义的参考吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-15T18:41:31.810

事实证明，我只需要真正安装调试工具。“高级 Windows 调试”声称可以通过副本安装这些工具，但这似乎不适用于 UMDH。使用官方安装程序安装后，我能够让 UMDH 看到符号。

# c# - 建议什么时候开始制作dll

> ID：13351893
> 
> 赞同：0
> 
> 时间：2012-11-12T21:31:51.427
> 
> 标签：c#, wpf, xna

我只是想知道什么时候建议制作 dll，当你的项目超过 1000 行、5000 行等等时？我还应该为 WinForm 项目使用的 WPF 控件制作 dll 吗？或者当项目达到一定数量的课程时？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:38:14.500

这完全是个人意见的问题，但是如果您由于行数或类数而分解项目，那么您做错了。您应该为解决方案中的每个高级逻辑分组都有一个项目（因此是一个 dll）。你可能有一个数据项目、一个域项目……等等。如果你要跨解决方案重用代码，那么是的，你需要一个 dll，或者一个共享项目，或类似的东西。

# javascript - 使用 jQuery 将由 JavaScript 数组生成的 JSON 字符串发布到服务器

> ID：13351898
> 
> 赞同：0
> 
> 时间：2012-11-12T21:31:59.670
> 
> 标签：javascript, jquery, ajax, json, post

> **可能重复：**
> [jQuery ajax，如何发送 JSON 而不是 QueryString](https://stackoverflow.com/questions/12693947/jquery-ajax-how-to-send-json-in-stead-of-querystring)

我在从“二维”JavaScript 数组创建有效 JSON 字符串时遇到问题。如果我将 jQuery AJAX 请求中的数据类型选项更改为文本，我会收到成功警报。

这是 json 字符串（来自代码中的调试）

```
[
   [
      {"x":16, "y":17, "c":"#000000"}
   ],
   [
      {"x":16, "y":17, "c":"#000000"}
   ],
   [
      {"x":16, "y":17, "c":"#000000"}
   ],
   [
      {"x":16, "y":17, "c":"#000000"}
   ],
   [
      {"x":16, "y":17, "c":"#000000"}
   ]
] 
```

这是我的代码

```
var pixelqueu =[];

function addtoqueu(x,y,color){//x y colorhex
    var p = [];
    p.push({ "x": x, "y":y,"c":color });
    pixelqueu.push(p);

    if(pixelqueu.length==5){
        var string=JSON.stringify(pixelqueu);//debug
        $('body').append(string);//debug
        sendpixels(pixelqueu);
    }
}

function sendpixels(jsonpixels){
    $.ajax({
        type: "POST",
        url: './proc_pixel.php',
        dataType: 'json',
        traditional: true,
        data: JSON.stringify(jsonpixels),
        success: function (data) {
            alert(data);
        }
    });
} 
```

欢迎任何帮助！

# php - 控制粘性发布日期

> ID：13351901
> 
> 赞同：0
> 
> 时间：2012-11-12T21:32:07.467
> 
> 标签：php, wordpress, hook, sticky

当我在后端贴一个帖子时，我希望它被添加一个`meta_key`and `meta_value`。换句话说，为了控制帖子被标记为置顶的日期，我想添加一个`meta_key`like`date`和一个`meta_value`like `date( 'm/d/Y H:i:s')`。

我认为使用 hook 和 是可能的`add_action`，但我不知道如何。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:10:12.513

使帖子具有粘性实际上会更新 WordPress 背景中的博客选项：

```
update_option('sticky_posts', $stickies); (see core in wp-includes/post.php) 
```

所以你的钩子可能是 pre_update_option_sticky_posts （前缀 pre_update_option_ + 选项名称），如下所示：

```
add_action( 'pre_update_option_sticky_posts', 'my_function' );
function my_function( $post_id ) { 
Your code here to save the custom field values
} 
```

# css - chrome PC 上的@font-face 锯齿状别名

> ID：13351902
> 
> 赞同：0
> 
> 时间：2012-11-12T21:32:13.437
> 
> 标签：css, google-chrome

我看过一些关于 PC`chrome`浏览器修复和锯齿`@font-face`输出的帖子，但没有一个能够修复我的示例[http://bit.ly/XyYtRX](http://bit.ly/XyYtRX)
除了 chrome 之外，一切看起来都不错（第一次 IE 不是问题！）

这是我的尝试

```
@font-face {
    font-family: 'Conv_BreeBold';
    src: url('fonts/BreeBold.eot');
    src: local('Conv_BreeBold'), 
    url('fonts/BreeBold.svg') format('svg'), 
    url('fonts/BreeBold.woff') format('woff'), 
    url('fonts/BreeBold.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}
.demo {
    font-family:'Conv_BreeBold',Sans-Serif;
    width:800px;
    margin:10px auto;
    text-align:left;
    border:1px solid #666;
    padding:10px;
    font-size:36px;

text-shadow: 0 1px 0 rgba(0,0,0,0.01);
-webkit-transform: rotate(-0.0000000001deg); 
-webkit-font-smoothing: antialiased; 
-webkit-font-smoothing: subpixel-antialiased;
} 
```

请有任何建议，谢谢。

# c# - 使用 restsharp 调用在 VS 中运行编码的 Web 测试

> ID：13351906
> 
> 赞同：0
> 
> 时间：2012-11-12T21:32:34.670
> 
> 标签：c#, visual-studio-2010, web-testing

我有一个测试库来处理基本的响应处理，比如使用 Restsharp 发送和解析请求。所以对于我写的大多数测试，我只需要做类似的事情

```
ServiceClient client = ServiceProvider.GetClient();
IRestResponse r = client.createItem(item);
Item i = r.data; 
```

等，以及用于创建和获取等的正确 API 被拾取和处理

我想创建一个 Web 测试来运行性能测试，并想知道我是否可以使用同一个库来处理我的请求并让 Visual Studio 知道这些请求。或者我是否必须使用 WebTestRequest 类进行调用，以便 VS 可以拦截它们并适当地返回结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T05:27:03.770

有两种选择：

(1) 两者中较简单的是在 Visual Studio **Unit Tests**中使用您现有的代码。这只需要添加一些特定的单元测试代码。单元测试可用于负载测试。要获得请求的时间，您将按如下方式包装每个需要计时的东西，结果将显示在负载测试结果中：

```
TestContext.BeginTimer("createItem");
IRestResponse r = client.createItem(item);
TestContext.EndTimer("createItem"); 
```

(2) 将您的测试代码转换为 Visual Studio **Coded Web Tests**。正如您所猜测的那样，这将是更多的工作，因为您必须使用 WebTestRequest 类，而不是所有请求细节都被很好地隐藏起来并由 Restsharp 处理。换句话说，您将失去 Restsharp 的所有好处。Web 测试确实具有更好的性能，因为执行引擎使用带有线程池的异步处理，但除非您在负载生成方面受到硬件限制，否则这并不是真正的问题。

# java - Android RAM页面大小？

> ID：13351907
> 
> 赞同：6
> 
> 时间：2012-11-12T21:32:45.637
> 
> 标签：java, android, linux

我想优化 InputStream 的读取，然后我认为最好有一个 RAM 页面大小的 byte[] 缓冲区。

有没有一种方法（可能是静态的）来知道它的大小？

## 编辑：

最后我成功使用了NDK和JNI，我用C写了以下代码：

```
#include <jni.h>
#include <unistd.h>

jlong Java_it_masmil_tests_TestsActivity_pageSize(JNIEnv* env, jobject javaThis) {
    return sysconf(_SC_PAGE_SIZE);
} 
```

在哪里：

*   it.masmil.tests 是包名
*   TestsActivity 是类名
*   pageSize 是方法名
*   env 和 java 这是两个强制参数（在某些场合有用）

我用 NDK 编译了那个文件，然后我用 Java 编写了以下代码：

```
static {
    System.loadLibrary("clibrary");
}
private native long pageSize();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    long page = pageSize();
} 
```

在哪里：

*   clibrary 是我用 NDK 创建的库的名称
*   pageSize 是 C 文件中声明的方法的名称

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:44:33.837

页面大小由 Linux（内核）定义，您可以通过 JNI 通过调用 libc（[仿生](https://github.com/android/platform_bionic/blob/master/libc/include/sys/sysconf.h#L77)）来获取它`sysconf(_SC_PAGESIZE)`。由于 Android 在 Linux 上运行并且主要在 ARM 系统上运行，因此您可以假设 4k 页面大小。

```
#include <unistd.h>
long sz = sysconf(_SC_PAGESIZE); 
```

但是，您不能真正轻松地从 Java/C 中获得这种对齐方式。这意味着即使您要求 4k 块，也没有人保证会与 4k 对齐。

如果您在 Linux 上需要 4k 对齐的块，您应该使用保证页面大小对齐的[mmap 。](http://linux.die.net/man/2/mmap)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T13:59:07.427

您通常可以假设页面大小为 4KB 或更大（可以处理较小页面大小的 MMU 实际上已绝迹）。此外，如果您无法将缓冲区对齐到确切的页面边界，它很可能仍会跨越两个页面。

最后，所有这些努力都完全白费了——如果 MMU 遭受一两次页面丢失，实际 I/O 成本将超过许多数量级。你甚至不可能收回增加的初始化成本，更不用说你花在实现它上的所有时间了。

你做了一个过分热心的优化工作的完美例子，如果你只是分析你的应用程序并在最常调用的方法中减少一两个周期，你可能会花费所有时间来获得更大的回报（例如）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-27T10:57:06.807

很难相信添加 JNI 等真的会收回成本。像其他人一样使用 4096 或 8192。

# c++ - OpenCV HOG 特征数据布局？

> ID：13351913
> 
> 赞同：9
> 
> 时间：2012-11-12T21:33:06.843
> 
> 标签：c++, opencv, computer-vision, histogram, feature-extraction

我正在使用 OpenCV 的 CPU 版本的 Histogram of Oriented Gradients ( [HOG](http://en.wikipedia.org/wiki/Histogram_of_oriented_gradients) )。我正在使用 32x32 图像，其中包含 4x4 单元格、4x4 块、块之间没有重叠和 15 个方向箱。OpenCV`HOGDescriptor`给了我一个长度为 960 的一维特征向量。这是有道理的，因为（32*32 像素）*（15 个方向）/（4*4 单元）= 960。

但是，我不确定这 960 个数字是如何在内存中排列的。我的*猜测*是它是这样的：

```
vector<float> descriptorsValues =
[15 bins for cell 0, 0] 
[15 bins for cell 0, 1]
...
[15 bins for cell 0, 7]
....
[15 bins for cell 7, 0] 
[15 bins for cell 7, 1]
...
[15 bins for cell 7, 7] 
```

当然，这是一个扁平化为 1D 的 2D 问题，所以它实际上看起来像这样：

```
[cell 0, 0] [cell 0, 1] ... [cell 7, 0] ... [cell 7, 7] 
```

## 那么，我对数据布局有正确的想法吗？或者是别的什么？

* * *

这是我的示例代码：

```
using namespace cv;

//32x32 image, 4x4 blocks, 4x4 cells, 4x4 blockStride
vector<float> hogExample(cv::Mat img)
{
    img = img.rowRange(0, 32).colRange(0,32); //trim image to 32x32
    bool gamma_corr = true;
    cv::Size win_size(img.rows, img.cols); //using just one window
    int c = 4;
    cv::Size block_size(c,c);
    cv::Size block_stride(c,c); //no overlapping blocks
    cv::Size cell_size(c,c);
    int nOri = 15; //number of orientation bins

    cv::HOGDescriptor d(win_size, block_size, block_stride, cell_size, nOri, 1, -1,
                              cv::HOGDescriptor::L2Hys, 0.2, gamma_corr, cv::HOGDescriptor::DEFAULT_NLEVELS);

    vector<float> descriptorsValues;
    vector<cv::Point> locations;
    d.compute(img, descriptorsValues, cv::Size(0,0), cv::Size(0,0), locations);

    printf("descriptorsValues.size() = %d \n", descriptorsValues.size()); //prints 960
    return descriptorsValues;
} 
```

* * *

**相关资源：** [这篇 StackOverflow 帖子](https://stackoverflow.com/questions/10862542/hog-features-visualisation-with-opencv-hogdescriptor-in-c)和[本教程](http://www.juergenwiki.de/work/wiki/doku.php?id=public:hog_descriptor_computation_and_visualization)帮助我开始使用 OpenCV HOGDescriptor。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-16T06:00:16.530

***我相信你的想法是对的。***

在其原始论文[Histograms of Oriented Gradients for Human Detection](http://lear.inrialpes.fr/people/triggs/pubs/Dalal-cvpr05.pdf) (Page 2) 中，它说

> [...] 检测器窗口平铺有重叠块的网格，其中提取了定向梯度特征向量的直方图。[...]
> 
> [...] 使用 HOG 描述符的密集（实际上是重叠的）网格平铺检测窗口，并使用组合特征向量 [...]

它所谈论的只是将它们[***平铺***](http://en.wikipedia.org/wiki/Square_tiling)在一起。尽管没有介绍如何将它们精确地平铺在一起的详细信息。我想这里不应该发生什么花哨的事情（否则他们会谈论它），即只是定期连接它们（从左到右，从上到下）。

毕竟，这是合理且最简单的数据布局方式。

* * *

**编辑：**如果你看看[人们如何访问和可视化数据，](http://www.juergenwiki.de/work/wiki/doku.php?id=public%3ahog_descriptor_computation_and_visualization#computing_the_hog_descriptor_using_opencv)你会更信服自己。

```
for (int blockx=0; blockx<blocks_in_x_dir; blockx++)
{
    for (int blocky=0; blocky<blocks_in_y_dir; blocky++)            
    {
        for (int cellNr=0; cellNr<4; cellNr++)
        {
            for (int bin=0; bin<gradientBinSize; bin++)
            {
                float gradientStrength = descriptorValues[ descriptorDataIdx ];
                descriptorDataIdx++;

                // ... ...

            } // for (all bins)
        } // for (all cells)
    } // for (all block x pos)
} // for (all block y pos) 
```

# java - 如何知道数据来自 keyentry 或设备

> ID：13351915
> 
> 赞同：0
> 
> 时间：2012-11-12T21:33:21.820
> 
> 标签：java, jsp, jstl

我有一个从键输入或扫描仪中获取值的字段。

我想区分来自扫描仪或密钥输入的数据。如果它来自扫描仪，我想添加扫描仪作为前缀，否则什么都没有。

我正在使用 Java、Spring 表单标签、Jsp。

如果信息来自扫描仪或密钥输入，我如何获取信息？

我从研究中发现的是输入数据所花费的时间。但是，我该怎么做呢？

非常感谢任何建议或帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:50:41.017

查看[onchange](http://www.w3schools.com/jsref/event_onchange.asp)事件 - 并设置一个计时器以查看用户输入的速度。然而，根据我的经验，我使用的每台扫描仪都将击键速度限制为几乎“人类”的速度，因此系统可能不是 100% 可靠的——也许你应该比实际速度更关注速度的一致性。

# multithreading - “不支持从 MTA 激活单线程类”错误来自 C# 应用程序中使用的 C++ WinRT DLL

> ID：13351917
> 
> 赞同：2
> 
> 时间：2012-11-12T21:33:32.943
> 
> 标签：multithreading, windows-8, windows-runtime

我有一个使用 C++ WinRT DLL 的 C# 程序。C# 程序创建公共 WinRT 类 Foo 的实例，该实例在内部尝试实例化未声明为公共的第二个 WinRT 类 Bar 的对象。在 Bar 类上调用“ref new”时，它会抛出一个异常，提示“不支持从 MTA 激活单线程类”。

如何将 Bar 类配置为在 MTA 样式的线程应用程序中工作？它是按类还是 DLL 范围的设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:41:16.090

它是每个类的行为，由属性`ThreadingModel`和`MarshallingBehavior`. 有关详细信息，请参阅 MSDN - [线程和编组](http://msdn.microsoft.com/en-us/library/windows/apps/hh771042.aspx)。

用法是这样的：

```
using namespace Windows::Foundation::Metadata;
using namespace Platform;

[Threading(ThreadingModel=ThreadingModel::STA]
[MarshalingBehavior(MarshalingType=MarshalingType::None)] 
public ref class MySTAClass
{
}; 
```

# html - 使用 Putty 和 FTP 查找文件

> ID：13351918
> 
> 赞同：2
> 
> 时间：2012-11-12T21:33:45.377
> 
> 标签：html, ftp, putty

我想做的很简单。我想编辑标准 Centos 服务器上的网页的 html 文件。我可以很好地访问它，并且 Apache 设置为在 /var/www/sitename 中查找。这是我的问题：

我要编辑的页面的网址是这样的：[http://www.yoursite/page1](http://www.yoursite/page1)

我认为在 /var/www/sitename 的某个地方，应该有一个名为 page1.html 的文件。但是没有。我在 FileZilla 和 Putty 中运行了搜索功能（使用 find /var/www/yoursite/ -exec grep -l "jeyword-from-page-1" {} \;

这一切看起来都很简单，但我找不到我应该编辑的文件。我应该在哪里寻找它？非常感谢任何想法或提示。提前感谢您的时间！

**编辑：**

谢谢大家的回复。这是我在 htaccess 文件中找到的内容：

```
<FilesMatch "\.(engine|inc|info|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl|svn-base)$|^(code-style\.pl|Entries.*|Repository|Root|Tag|Template|all-wcprops|entries|format)$">
  Order allow,deny
</FilesMatch>

# Set the default handler.
DirectoryIndex index.php

  # If your site is running in a VirtualDocumentRoot at http://example.com/,
  # uncomment the following line:
  RewriteBase /

  # Rewrite URLs of the form 'x' to the form 'index.php?q=x'.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !=/favicon.ico
  RewriteRule ^(.*)$ index.php?q=$1 [L,QSA]
</IfModule> 
```

这些在我看来是可疑的，与其他行没有什么不同。会是这样吗？

EDIT2：我刚刚在我的 index.php 文件中找到了这些行：

```
/**
 * @file
 * The PHP page that serves all page requests on a Drupal installation.
 *
 * The routines here dispatch control to the appropriate handler, which then
 * prints the appropriate page.
 *
 * All Drupal code is released under the GNU General Public License.
 * See COPYRIGHT.txt and LICENSE.txt.
 */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:39:52.020

检查您的服务器块/虚拟主机配置以了解文件所在的位置

这应该在Apache`/etc/apache2/`或Nginx中的某个地方`/etc/httpd/``/etc/nginx/``/opt/local/nginx/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:47:38.150

我认为不必有一个名为该名称的页面。.htaccess 文件可能会覆盖此类请求的默认路由，并且您的页面很可能有一个脚本，该脚本会加载具有完全不同文件名的文件以显示内容。（很抱歉，如果我假设不正确，您并不完全了解您的网络服务器上的网页是做什么的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:43:08.297

我不认为你需要grep。使用这样的名称：find /path/to/site -name "filename"。

# python - Python - 斐波那契函数上的变量值声明之间的区别

> ID：13351921
> 
> 赞同：2
> 
> 时间：2012-11-12T21:33:54.473
> 
> 标签：python, fibonacci, variable-declaration

我是python的初学者。我正在研究一种制作斐波那契函数的类型，

```
def fib(n):
a=0
b=1
while a<n:
    print a
    a,b=b,a+b 
```

我看到了 a,b=b,a+b 声明。所以，我认为 a=b 和 b=a+b 和 a,b=a,b+a 是一样的，所以我把函数改成这样：

```
def fib(n):
a=0
b=1
while a<n:
    print a
    a=b
    b=a+b 
```

我认为这是对的，但是当我执行程序时，我得到了不同的输出。有人可以向我解释这两种声明之间的区别吗？

不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:36:31.183

`b, a+b`创建一个包含这两个值的元组。然后`a, b = ...`解包元组并将其值分配给变量。但是，在您的代码中，您会覆盖第一行的值，因此第二行使用新值。

```
a, b = b, a + b 
```

大致等于：

```
tmp = a
a = b
b = tmp + b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:36:44.803

当 Python 执行时

```
a,b = b, a+b 
```

它首先[评估右侧](http://docs.python.org/reference/expressions.html#evaluation-order)，然后解包元组并将值分配给`a`and `b`。请注意，`a+b`右侧使用的是 的**旧**值`a`。

当 Python 执行时

```
a=b
b=a+b 
```

它评估`b`并将其值分配给`a`。然后它评估`a+b`并将该值分配给`b`。现在请注意，它`a+b`正在使用 的**新**值`a`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:37:30.413

在第一个示例中，直到对整行求值后，a 才会更新为获取 b 的值——因此 b 实际上是 a + b。

在您的示例中，您已经将 a 设置为 b，因此最后一行 (b=a+b) 可以很容易地设置为 b=b+b。

这一切都是按照评估事物的顺序进行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:36:39.660

`a`该语法同时`b`基于当前值分配新值。它不等价的原因是，当您编写两个单独的语句时，第二个赋值使用*新*值 of`a`而不是*旧*值 of `a`。

# silverlight - 从未收到 Mvvm Light Messenger 消息

> ID：13351924
> 
> 赞同：3
> 
> 时间：2012-11-12T21:34:03.240
> 
> 标签：silverlight, mvvm-light, messaging

我有一个奇怪的问题。

我正在使用 GalaSoft 的 MVVM Light 框架，到目前为止一切正常。我使用信使系统在 ViewModel 之间发送消息就好了，直到我尝试执行以下操作：

`GateKeeper`我有一个发送消息的单例类。

此类不是 ViewModel，因此不继承自`ViewModelBase`.

如果它发送一条消息，它不会在任何地方收到。

我尝试了以下方法：

1.  让`GateKeeper`继承自`ViewModeBase`-> 没有成功。
2.  注册`GateKeeper`以接收消息，从而查看它是否会捕获/接收实际从自身发送的消息 -> 不成功。
3.  从单例更改`GateKeeper`为正常实例化 -> 没有成功
4.  创建一个未连接到视图的 MVVM ViewModel，并让它发送消息，就像`GateKeeper`-> no Success

我所有连接到视图的视图模型都可以发送消息，并且它们将被接收。

在信使工作之前，似乎必须将视图模型“链接”到视图，但imo。这是一个主要限制。

以下是当前非常简化的设置。

在 GateKeeper 上调用 ApplicationInitialize 不会触发在 mainviewmodel 或 GateKeeper 类本身上接收到的消息。

我希望有人对这个问题提出建议。

谢谢..

示例设置： **MainViewModel 构造函数：**

```
 public MainViewModel()
    {
        Messenger.Default.Register<LoadViewMessage>(this, (message) =>
        {
            if (message.Sender is GateKeeper) CurrentView = message.View;
            else if (message.Sender is LoginViewModel) CurrentView = message.View;
            else if (message.Sender is MenuItemBarViewModel) CurrentView = message.View;
        }); 
```

**看门人：**

```
 public class GateKeeper : IGateKeeper
{
    private readonly IEmployeeService _employeeService;

    #region Implementation of IGateKeeper

    public void ApplicationInitialize()
    {
        Messenger.Default.Send<LoadViewMessage>(new LoadViewMessage(ObjectLocator.MainMapView), this);
    }

    public void LoginSucceeded(Employee employee)
    {
        //This is where we retrieve the available services for the current employee
        //TODO: add methods for retrieving service info from backend

        //Send a message that should make the mainview load the map into its currentview property
        Messenger.Default.Send(new LoadViewMessage(ObjectLocator.MainMapView), this);
    }

    #endregion

    public GateKeeper(IEmployeeService employeeService)
    {
        _employeeService = employeeService;

        //Test.. Is not triggered
        //Just used for debugging, thus nothing happens inhere.
        Messenger.Default.Register<LoadViewMessage>(this, (message) =>
        {
            if (message.Sender is GateKeeper) ;
            else if (message.Sender is LoginViewModel) ;
            else if (message.Sender is MenuItemBarViewModel);
        });
    } 
```

消息类：**LoadViewMessage**

```
 public class LoadViewMessage : MessageBase
{
    public UserControl View { get; protected set; }

    public LoadViewMessage(UserControl view, object sender): base(sender)
    {
        View = view;
    }

    public LoadViewMessage(UserControl view):this(view, null){}
} 
```

PS：ObjectLocator 是一个 NinJect 类，用于处理对象的所有实例化及其生命周期

@UPDATE LBugnion（MVVM Light 的创建者）指出问题出在 send 方法中，我实际上是在使用带有令牌的 Send 重载。

@这在我的情况下不起作用

```
Messenger.Default.Send(new LoadViewMessage(ObjectLocator.MainMapView), this); 
```

@这将工作

```
Messenger.Default.Send(new LoadViewMessage(ObjectLocator.MainMapView, this)); 
```

**这**应该作为**令牌传递给****loadViewMessage而不是 Send 方法**

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T18:07:55.047

您的问题出在 Send 方法上。您正在使用将令牌作为第二个参数的方法的重载。您将“this”作为令牌传递。这意味着您（可能是错误地）使用消息的发送者作为令牌。

如果您使用令牌发送，您还需要使用相同的令牌注册接收者（在这种情况下，与 Send 方法中使用的实例完全相同）。由于您没有注册令牌，因此消息永远不会由 Messenger 发送，这是一种优化机制。

我的猜测是您误解了 Send 方法中令牌的用法。如果您愿意，令牌只是作为构建“私人消息传递网络”的一种方式，其中两个对象可以使用相同的令牌注册/发送并建立私人通信。

在您的情况下，如果您想将 Sender 与消息一起发送，您需要将 Sender 保存在消息本身中，这就是 MessageBase 和派生类所做的。

希望这可以帮助

洛朗**

# c - 本文所指的“动态标签”是什么意思：

> ID：13351925
> 
> 赞同：1
> 
> 时间：2012-11-12T21:34:05.757
> 
> 标签：c, linux, gcc, debian, elf

[从http://wiki.debian.org/Multiarch/LibraryPathOverview](http://wiki.debian.org/Multiarch/LibraryPathOverview)复制：

> 在请求对象的（已弃用）DT_RPATH 动态标记中命名的任何目录，或者递归地，任何父对象（请注意，如果 DT_RUNPATH 也存在，则忽略 DT_RPATH）

我似乎无法在任何地方找到动态标签的定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:52:45.717

每个动态链接的 ELF 图像（可执行类型`ET_EXEC`或类型库`ET_DYN`）都有一个动态表（您可以通过`objdump -p a.out`或看到`readelf -d a.out`）。表中的每个条目都包含一组`Elf32_Dyn`或`Elf64_Dyn`条目，并且每个条目都有一个`d_tag`和`d_value`成员。文档[在这里](http://uw714doc.sco.com/en/SDK_cprog/OF_DynSection.html)。

是条目，`dynamic tag`它`d_tag`只是一个整数标记（`DT_NEEDED`、`DT_STRTAB`等），描述了`d_value`表中这个特定条目的 代表什么。

动态加载器使用动态表来加载 ELF 图像、查找它需要的库（使用`DT_NEEDED`和`DT_RPATH`或`DT_RUNPATH`条目）、初始化它（使用`DT_INIT`或`DT_INIT_ARRAY`）、查找其中的符号（`DT_SYMTAB`、、、 ） `DT_STRTAB`、`DT_HASH`重新定位它等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:57:51.793

它只是指*动态部分*中的条目（DT 可能代表*动态表*或其他东西）。

您可以使用以下命令查看它们：

```
$ objdump -p program 
```

# gruntjs - gruntjs - 命令行参数

> ID：13351932
> 
> 赞同：17
> 
> 时间：2012-11-12T21:34:28.353
> 
> 标签：gruntjs

我在哪里可以获得命令行参数的句柄？

例如`grunt dist --env=UAT`。我如何获得价值`env`？

当我使用它时，如果未在命令行上设置它，我将如何为其分配默认值？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-13T07:10:59.367

您可以使用`grunt.option()`或更具体地说：

`var env = grunt.option('env') || 'default';`

如果参数不存在，则获取`env`参数或默认为字符串。`'default'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T09:36:49.690

我发现在 grunt 中对默认值的处理非常缺乏。上面概述的方法有效，但是当您有很多选择时，它很快就会变得乏味。

一个小辅助函数可以缓解这个问题：

```
function defaultOptions(options) {
  for(var key in options) {
    if(options.hasOwnProperty(key) && !grunt.option(key)) {
      grunt.option(key, options[key]);
    }
  }
} 
```

然后你可以像这样使用：

```
defaultOptions({
  env : "staging"
}); 
```

在 CLI 中：

```
grunt // { env : "staging" }
grunt --env=UAT // { env : "UAT" } 
```

# java - isFullScreenSupported 对于监视器始终为真

> ID：13351936
> 
> 赞同：3
> 
> 时间：2012-11-12T21:34:49.117
> 
> 标签：java, monitor

给定以下代码

```
 GraphicsDevice screen = GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices()[0];
 if (screen.isFullScreenSupported()) {
      //is it always true for monitors?
 } 
```

`screen.isFullScreenSupported()`显示器总是如此吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:42:40.517

不，这可能不是真的。

SecurityManager 可能不允许您进行全屏控制。主要是因为人们可以轻松地伪造整个屏幕，以便从不知情的用户那里获取密码（您可以模拟银行网站）。

它可能是错误的：

*   在小程序中
*   在 WebStart 应用程序中
*   在无头模式下运行时

GraphicsDevice.isFullScreenSupported的 JavaDOC [：](http://download.java.net/jdk8/docs/api/java/awt/GraphicsDevice.html#isFullScreenSupported%28%29)

> 如果此 GraphicsDevice 支持全屏独占模式，则返回 true。如果安装了 SecurityManager，它的 checkPermission 方法将使用 AWTPermission("fullScreenExclusive") 调用。isFullScreenSupported 仅在授予该权限时才返回 true

# php - 如何选择这个特定 php 数组的最后一个元素？

> ID：13351938
> 
> 赞同：1
> 
> 时间：2012-11-12T21:34:52.670
> 
> 标签：php

我需要选择特定数组中的最后一个元素。例如，我需要此数组中的最后一个元素，该元素当前设置为第四个或 [3] ![在此处输入图像描述](../Images/0354941b9e15bcbb411f2a6655602ed6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:36:14.090

[`end()`](http://php.net/manual/en/function.end.php)将返回数组的最后一个元素。

```
$last = end($categories);
echo $last['category_id']; 
```

**注意：**请注意，这也会设置内部数组指针。

# vim - vim ex 模式：复制模式并粘贴到文件末尾？

> ID：13351939
> 
> 赞同：1
> 
> 时间：2012-11-12T21:34:58.240
> 
> 标签：vim, copy-paste, ex

我正在尝试使用 vim ex 模式使用脚本自动对一组文件进行一些简单的修改。我想要做的是搜索一个模式，将其从当前位置删除（只是模式，而不是整行），然后将其粘贴到文档的末尾。

以下网址有一些有用的建议，但我觉得应该有一种方法可以做到这一点，而无需定义特殊功能。 [http://vim.wikia.com/wiki/Copy_the_search_results_into_clipboard](http://vim.wikia.com/wiki/Copy_the_search_results_into_clipboard)

建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:09:44.187

Ex 命令通常适用于整行。但是，我们可以使用该命令`:s`将所有匹配项“捕获”到一个寄存器中，然后将它们粘贴到文档的末尾。

```
:let @a=""
:%s//\=matchstr(setreg('A',submatch(0),'l'),'')/g
:$put a 
```

解释：

*   清空`a`寄存器通过`let @a=""`
*   替换上次使用的搜索模式：`%s//...`.
*   使用表达式 ,`\=`作为替换
*   `submatch(0)`表示匹配的模式
*   通过以下方式将匹配模式逐行附加到`a`寄存器：`setreg('A',submatch(0),'l')`
*   因为`setreg()`返回零，我们使用 matchstr() 基本上将其转换为空字符串
*   使用`/g`标志来匹配每行多次
*   将收集到的匹配项粘贴到`a`文件末尾`$pu a`

如需更多帮助，请参阅：

```
:h :let
:h :s
:h range
:h :s\=
:h submatch(
:h setreg(
:h matchstr(
:h :pu
:h registers 
```

# java - Servlet 与另一台服务器通信

> ID：13351941
> 
> 赞同：1
> 
> 时间：2012-11-12T21:35:02.627
> 
> 标签：java, jakarta-ee, servlets

> **可能的重复：**
> [远程 servlet 之间的通信](https://stackoverflow.com/questions/3035656/communication-between-remote-servlets)

是否可以在不同服务器上的 servlet 之间发送对象？问题是，当我的 servlet 接收到 http 请求时，在发送响应之前，它需要将一些数据发送到另一个 Web 应用程序（在不同的服务器上），获取响应，然后处理接收到的数据。但是我真的不知道如何解决这个问题。servlet 是否可以向另一个 servlet 发送 http 请求，然后从中获取响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:38:47.703

当然这是可能的——您可以`HttpURLConnection`像在 JavaSE 中一样在其中创建一个。通常我所做的是，如果出现错误，将原始（第二个服务器）HTTP 错误代码转发给客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:18:28.240

这是一个如何使用 HttpURLConnection 与另一个 servlet（或任何 http 服务器）通信的示例......

```
URL url = new URL ("http://host/myservlet");
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setDoOutput (true);
connection.setDoInput (true);
OutputStream os = connection.getOutputStream();
//TODO: optionally, send something through the OutputStream to your servlet
os.flush();
os.close();
InputStream is = connection.getInputStream();
//TODO: retrieve your results from the InputStream
is.close(); 
```

请务必在完成后关闭您的流或使用 try-with-resources 块。您可以根据需要使用 ObjectInputStream 或 InputStreamReader。如果需要，您还可以使用 HttpURLConnection 的 setRequestProperty 方法来定义用户代理或 cookie 等内容。

# boto - 如何使用 excluseive_start_key 使用 boto dynamodb 扫描

> ID：13351945
> 
> 赞同：1
> 
> 时间：2012-11-12T21:35:17.137
> 
> 标签：boto, amazon-dynamodb

我想使用 boto 对 dynamodb 上的表进行扫描，我的问题是我想使用`max_results`and进行分页`exclusive_start_key`
实际上它看起来是访问`LastEvaluatedKey`以传递它的唯一方法，因为它`exclusive_start_key`是手动跟踪主键并传递最后一个一个作为`exclusive_start_key`

但这不是我的问题，我的问题是我不知道我应该传递给`exclusive_start_key`它的格式（什么对象类型）即使表有一个整数 hash_key 也不接受 int？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:59:07.843

根据文档，Scan 的 Layer2 实现需要一个列表或一个元组作为主键的表示。

*   `(hash_key,)`对于单个键表
*   `(hash_key, range_key)`对于组合键表

请注意，还有一种（棘手的）方法可以直接从 Boto 的扫描生成器中读取 esk。

# php - PHP 注意：未定义索引：HTTP_HOST in /var/.../script.php on line 8

> ID：13351948
> 
> 赞同：1
> 
> 时间：2012-11-12T21:35:30.147
> 
> 标签：php, apache, global-variables, error-log

我的 apache 错误日志中出现了与[此问题](https://stackoverflow.com/questions/11363070/php-notice-undefined-index-http-host-in-globalshttp-server-varshttp-host)中描述的相同的错误。唯一的区别是我使用 $_SERVER ，如答案中所述。

第 8 行是：

```
if(strstr($_SERVER['HTTP_HOST'],'127.0.0.1')) 
```

具有完全相同条件的第 59 行出现了相同的错误。告诉网站我们是否在沙盒中是一个条件。据我所知，除了阻塞 apache 错误日志外，没有发生任何不好的事情。

有谁知道为什么会发生这种情况以及如何解决？PHP 版本是 5.3.10。服务器正在运行 Ubuntu 12.04。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:41:30.673

手册暗示此索引可能并不总是设置 [http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

> Host 的内容：当前请求的标头，**如果有的话**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-28T15:26:16.297

FWIW，某些爬虫不发送`HTTP_HOST`信息；Googlebot 就是其中之一。请务必检查您的访问日志，爬虫访问站点的条目将与错误日志中的时间戳一致，例如：

```
8.8.8.8 - - [28/Nov/2016:15:24:23 +0000] "GET / HTTP/1.0" 200 
            20463 "-" "Mozilla/5.0 (compatible; Googlebot/2.1;
            +http://www.google.com/bot.html)" 
```

相应的错误日志条目：

```
[Mon Nov 28 15:24:23.579216 2016] [:error] [pid 28226]
        [client 8.8.8.8:20463] PHP Notice:  Undefined index: HTTP_HOST 
        in /var/www/public_html/site/script.php on line 5 
```

感谢谷歌机器人！

# ios - 选中 searchResultsTableView 中的行

> ID：13351951
> 
> 赞同：0
> 
> 时间：2012-11-12T21:35:51.700
> 
> 标签：ios, uisearchdisplaycontroller

我有一个 tableView，它的数据源是一个包含 400 个静态项目的数组。在我的应用程序中，您可以选择一行，它将在该行上放置一个复选标记。我在另一个数组中跟踪检查项目的 indexPaths，以便以后可以重新加载表并且这些项目仍将被检查。

因为我的表中有很多值，所以我添加了一个 searchDisplayController。开始输入您要查找的内容，它会将列表过滤到这些项目。您可以在 searchResultsTableView 中选择行，它会检查它们，就像在具有 400 个静态行的主表中一样。但是，有一个问题：

假设您输入搜索并将 400 个项目的列表缩小到您要查找的项目，然后选择（复选标记）它。在 400 项的完整列表中，您刚刚搜索的项可能是列表中的第 112 项，但是当您进行搜索并过滤到仅一项时，而不是将第 112 项的 indexPath 添加到我的数组中轨道，它进入了项目 0 的 indexPath，因为它是过滤列表中唯一显示的项目。因此，当您取消搜索并返回主列表而不是第 112 项上的复选标记时，第 0 项上有一个复选标记。

所以我正在寻找一种方法来让我的过滤数组与我的主 tableView 数据源保持同步。

我的 didSelectRowAtIndexPath 方法的相关位：

```
if (tableView == self.searchDisplayController.searchResultsTableView) {
    cell.textLabel.text = [filteredattributesArray objectAtIndex:[indexPath row]];
    if(cell.accessoryType == UITableViewCellAccessoryNone){ 
        cell.accessoryType = UITableViewCellAccessoryCheckmark;

        [selectedItemRows addObject:indexPath]; //Add the index path of checked cell into     array to keep track            

        [tableView reloadData];

    } else {
        if(cell.accessoryType == UITableViewCellAccessoryCheckmark) {
            cell.accessoryType = UITableViewCellAccessoryNone;

            [selectedItemRows removeObject:indexPath]; //Remove that index path of unchecked cell from index array

            [tableView reloadData];
        }
    }
    [tableView deselectRowAtIndexPath:indexPath animated:YES];        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:40:09.900

不要使用 indexPath。在数据数组中的每个项目上设置标签值，然后为“checkedArray”保留标签列表。这样您就可以独立于单元格或 tableView 结构来评估选中的项目。

# java - JavaFX - 如何设置默认活动控件

> ID：13351959
> 
> 赞同：5
> 
> 时间：2012-11-12T21:36:34.497
> 
> 标签：java, javafx-2, javafx

我有一个从 JavaFX 教程之一创建的单窗口 JavaFX 应用程序。

我正在通过以下功能设置新窗口内容：

```
private Initializable replaceSceneContent(final String fxml) throws Exception {

    // wczytanie fxml
    FXMLLoader loader = new FXMLLoader();
    InputStream in = Main.class.getResourceAsStream(fxml);
    loader.setBuilderFactory(new JavaFXBuilderFactory());
    loader.setLocation(Main.class.getResource(fxml));
    AnchorPane page;
    try {
        page = (AnchorPane) loader.load(in);
    } finally {
        in.close();
    }

    Scene scene = new Scene(page, w, h);
    stage.setScene(scene);
    return (Initializable) loader.getController();
} 
```

但我想从这个 fxml 文件中选择一个 TextFields 以默认处于活动状态。这个怎么做？我尝试在控制器的初始化方法中调用 requestFocus 方法，但没有成功。我在 AnchorPane 类中的 TextField 类中都没有找到任何合适的属性（AnchorPane 是 fxml 控件树的根元素）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-12T21:47:09.033

尝试`requestFocus()`用`PlatForm.runlater`

```
Platform.runLater(new Runnable() {
    public void run() {
        textField.requestFocus();
    }
}); 
```

# asp.net-mvc - Asp.Net MVC 4 通用元素

> ID：13351963
> 
> 赞同：0
> 
> 时间：2012-11-12T21:36:45.370
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

对不起，通用标题，但我不知道如何调用我要创建的元素。这就是我需要的......我试图发布图片，但我还没有获得必要的特权。所以我试着描述它。

在stackoverflow上，在问题页面上，每个标题和摘要之后都有一些框显示问题的标签。

我想要完全相同的外观，但这些框应该与单选按钮列表的行为方式相同，而不是链接。I can only choose one of then at a time and when pick one, the selected one ill get different style added to him. 提交表单后，我应该能够恢复控制器中的选定项目。

我正在使用 Asp.Net MVC4，并且制作元素的选项将来自控制器。

对不起，没有代码或我已经制作的东西的问题。但是我有这种必要性，我什至不知道这种样式或元素是否有特定的名称或关键字 D。

你们知道从哪里开始吗（最终结果相似的教程？）？感谢您的帮助，抱歉英语不好。

* * *

查看建议的答案链接后的代码

CSS 代码

输入[类型=收音机] {显示：无；}

.rbLista span { font-family: "Lucida Grande","Lucida Sans Unicode",Arial,Helvetica,Sans-serif;

字体大小：12px；背景：RGB（217,217,217）；边框：1px 纯色 RGB（217,217,217）；} .rbLista span:hover { 边框：1px 实心 RGB(54,52,53); 背景：RGB（54,52,53）；白颜色; }

.rbLista 输入[type=radio]:checked + span { 背景：#D71712; 颜色：#fff; 边框：1px 实心#D71712；}

.rbLista 输入[type=radio]:checked + span:hover { 背景：#D71712; }

并查看代码

```
 <section class="rbLista">
        @foreach (var item in Model.ChamadoDetalhe.Transitos)
        {
            <label>
                @Html.RadioButtonFor(x => x.NovoTransito.Transito, @item.Text, new {                     @id = item.Text, @text = item.Text })<span>@item.Text</span>
            </label>
         }
         @Html.ValidationMessageFor(x => x.NovoTransito.Transito)
     </section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T19:46:58.267

你可以试试[这样的](http://speckyboy.com/2012/09/11/classic-digg-style-radio-buttons-with-css-and-jquery/)。这是一个[工作演示](http://speckyboy.com/demo/digg-style-radio-buttons/index.html)。

# javascript - `node --harmony` 有什么作用？

> ID：13351965
> 
> 赞同：187
> 
> 时间：2012-11-12T21:36:46.920
> 
> 标签：javascript, node.js

一个节点应用程序要求我运行带有和谐标志的节点，例如：

```
node --harmony app.js 
```

这是什么和谐旗？它有什么作用，为什么没有它应用程序不能运行？

我试过查看节点命令行选项（`node --help`），但它也没有提供任何细节。节点文档也没有任何帮助。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2012-11-12T21:45:52.483

打字`man node`在和谐标志上有这个：

```
 --harmony_typeof (enable harmony semantics for typeof)
       type: bool  default: false
 --harmony_scoping (enable harmony block scoping)
       type: bool  default: false
 --harmony_modules (enable harmony modules (implies block scoping))       
        type: bool  default: false
 --harmony_proxies (enable harmony proxies)       
        type: bool  default: false
 --harmony_collections (enable harmony collections  (sets,  maps,  andweak maps))
       type: bool  default: false 
 --harmony (enable all harmony features (except typeof))
       type: bool  default: false 
```

`--harmony`启用所有和谐功能（例如`--harmony_scoping`，`--harmony_proxies`等）的快捷方式也是如此。从[这篇博](http://www.goatslacker.com/post/16000243520/how-to-obtain-harmony-in-your-node-js)文中，和谐似乎启用了该语言中的新 ECMAScript 6 功能。您的文件无法和谐运行的原因`app.js`可能是使用了新 ECMAScript 6 标准中的非向后兼容功能（如块范围、代理、集合、地图等）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-05-15T11:04:06.477

如果要在旧版本的 nodejs 中运行 ECMAScript 6 功能，可以使用 --harmony 标志。最新版本的节点支持 ES6，因此不需要 --harmony 标志

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-12T21:44:43.837

它在节点 js 中启用和谐模块： [http ://wiki.ecmascript.org/doku.php?id=harmony:modules](http://wiki.ecmascript.org/doku.php?id=harmony%3amodules)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-07-10T04:03:04.657

正如节点文档中提到的，--harmony 标志启用了 ES6 的不稳定但即将稳定的特性

> Node.js 上 --harmony 标志的当前行为是仅启用分阶段功能。毕竟，它现在是 --es_staging 的同义词。如上所述，这些是尚未被认为稳定的已完成功能。如果您想安全起见，尤其是在生产环境中，请考虑删除此运行时标志，直到它默认在 V8 上发布，然后在 Node.js 上发布。如果您保持启用此功能，您应该为进一步的 Node.js 升级做好准备，以便在 V8 更改其语义以更紧密地遵循标准时破坏您的代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-06-19T09:53:36.677

**所有 ECMAScript 2015 (ES6) 功能分为三组，分别用于发布、暂存和进行中的功能：**

*   **V8 认为稳定的所有发布特性**在 Node.js 上默认启用，并且不需要任何类型的运行时标志。

*   **Staged features**是 V8 团队认为不稳定的几乎完成的功能，需要一个运行时标志：-- **harmonic**。

*   **进行中的功能**可以通过它们各自的和谐标志单独激活，尽管除非出于测试目的，否则强烈建议不要这样做。注意：这些标志由 V8 公开，并且可能会在没有任何弃用通知的情况下更改。

**来源**：[https ://nodejs.org/en/docs/es6/](https://nodejs.org/en/docs/es6/)

# javascript - 从 JavaScript 中的单个节点创建节点列表

> ID：13351966
> 
> 赞同：16
> 
> 时间：2012-11-12T21:36:49.020
> 
> 标签：javascript, nodes, nodelist

这是其中一个看起来很简单，但我想不出一个好的方法来解决它。

我有一个节点，也许`nodelist = document.getElementById("mydiv");`- 我需要将它规范化为一个节点列表。也不是一个数组：一个真实的、真正的`nodeList`对象。

**不是** `nodelist = [document.getElementById("mydiv")];`

请不要图书馆。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T15:25:35.667

获取 JavaScript 中已经引用的任何元素，给它一个我们可以使用选择器找到的属性，将其作为列表查找，删除属性，返回列表。

```
function toNodeList(elm){
    var list;
    elm.setAttribute('wrapNodeList','');
    list = document.querySelectorAll('[wrapNodeList]');
    elm.removeAttribute('wrapNodeList');
    return list;
} 
```

从 bfavaretto 的回答扩展而来。

* * *

```
function toNodeList(elm, context){
    var list, df;
    context = context // context provided
           || elm.parentNode; // element's parent
    if(!context && elm.ownerDocument){ // is part of a document
        if(elm === elm.ownerDocument.documentElement || elm.ownerDocument.constructor.name === 'DocumentFragment'){ // is <html> or in a fragment
            context = elm.ownerDocument;
        }
    }
    if(!context){ // still no context? do David Thomas' method
        df = document.createDocumentFragment();
        df.appendChild(elm);
        list = df.childNodes;
        // df.removeChild(elm); // NodeList is live, removeChild empties it
        return list;
    }
    // selector method
    elm.setAttribute('wrapNodeList','');
    list = context.querySelectorAll('[wrapNodeList]');
    elm.removeAttribute('wrapNodeList');
    return list;
} 
```

* * *

我最近想到了另一种方法

```
var _NodeList = (function () {
    var fragment = document.createDocumentFragment();
    fragment.appendChild(document.createComment('node shadows me'));
    function NodeList (node) {
        this[0] = node;
    };
    NodeList.prototype = (function (proto) {
        function F() {} // Object.create shim
        F.prototype = proto;
        return new F();
    }(fragment.childNodes));
    NodeList.prototype.item = function item(i) {
        return this[+i || 0];
    };
    return NodeList;
}()); 
```

现在

```
var list = new _NodeList(document.body); // note **new**
list.constructor === NodeList; // all these are true
list instanceof NodeList;
list.length === 1;
list[0] === document.body;
list.item(0) === document.body; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-04T14:20:56.547

恢复这个是因为我最近想起了一些关于*JavaScript*的东西。这取决于如何检查*NodeList*，但是..

```
const singleNode = ((nodeList) => (node) => {
  const layer = { // define our specific case
    0: { value: node, enumerable: true },
    length: { value: 1 },
    item: {
      value(i) {
        return this[+i || 0];
      }, 
      enumerable: true,
    },
  };
  return Object.create(nodeList, layer); // put our case on top of true NodeList
})(document.createDocumentFragment().childNodes); // scope a true NodeList 
```

现在，如果你这样做

```
const list = singleNode(document.body); // for example

list instanceof NodeList; // true
list.constructor === NodeList; // true 
```

并`list`具有属性*长度* `1`和*0*作为您的节点，以及从*NodeList*继承的任何内容。

如果你不能使用`Object.create`，你可以做同样的事情，除了作为带有原型`nodelist`和设置的构造函数`this['0'] = node;`，`this['length'] = 1;`并使用`new`.

* * *

ES5 版本

```
var singleNode = (function () {
    // make an empty node list to inherit from
    var nodelist = document.createDocumentFragment().childNodes;
    // return a function to create object formed as desired
    return function (node) {
        return Object.create(nodelist, {
            '0': {value: node, enumerable: true},
            'length': {value: 1},
            'item': {
                "value": function (i) {
                    return this[+i || 0];
                }, 
                enumerable: true
            }
        }); // return an object pretending to be a NodeList
    };
}()); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-12T21:42:25.137

如果您的目标浏览器支持[`document.querySelectorAll`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)，它将始终返回一个`NodeList`. 所以：

```
var nodelist = document.querySelectorAll("#mydiv"); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-09-06T11:59:12.910

另一种基于 Reflect.construct 的方法：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect/construct](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect/construct)

与其他情况一样，它需要修补 NodeList.prototype.item 才能调用此函数。

```
NodeList.prototype.item = function item(i) {
    return this[+i || 0];
};
let nl = Reflect.construct(Array, [], NodeList); 
```

要使用节点创建它，请将节点数组作为第二个参数。此方法通过检查：

```
list instanceof NodeList; // true
list.constructor === NodeList; // true 
```

使用它创建的数组可以使用`for..of`,`forEach`和其他标准方法进行迭代，您可以使用 simple 向其中添加元素`nl[n] = node;`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-12T21:44:31.107

```
var nodeList = document.createDocumentFragment();
nodeList.appendChild(document.getElementById("myDiv")); 
```

# php - Heroku php buildpack 如何在构建之前编译 sass / yuicompress？

> ID：13351967
> 
> 赞同：0
> 
> 时间：2012-11-12T21:36:51.483
> 
> 标签：php, heroku, sass, buildpack

我有一个简单的 php buildpack（基于此：[https](https://github.com/lenglead/heroku-buildpack-php) ://github.com/lenglead/heroku-buildpack-php ），我想扩展它以在构建时编译我的资产。我不想在我的仓库中包含已编译/缩小的 css/js，但 Heroku 需要它存在。我的想法如下：

*   在我的 repo 中有一个脚本，它编译 sass 并在 javascript/css 文件上调用 yuicompress 并将它们放在特定目录中。
*   在 Heroku 开始捆绑之前在 buildpack 中调用它，这样当它捆绑时，它会将已编译的文件捆绑在适当的位置。

但是，我遇到了问题，因为 Heroku 没有安装 sass/yuicompress。我对 Heroku 很陌生，所以我不确定我应该在这里采取什么方向：

*   在我的 buildpack 中下载并安装 sass/yui-compress，然后运行。（像这样：[https](https://github.com/abhishekmunie/heroku-buildpack-static-css/) ://github.com/abhishekmunie/heroku-buildpack-static-css/ ）
*   通过 .gemfile 将它们永久保存在我的 Heroku 应用程序中。这对于 php 应用程序甚至是可能的还是仅适用于 ruby​​ 的 gemfile？

我还听到人们说 Heroku 是“只读的”，所以也许这甚至不可能？基本上，我只想在 Heroku 上进行编译，而不是将其保存在 repo 中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T01:37:22.220

我自己回答了这个问题。我正在遵循[https://github.com/abhishekmunie/heroku-buildpack-static-css/](https://github.com/abhishekmunie/heroku-buildpack-static-css/)上的代码，并以不错的结果转换为我的需求。我建议其他人查看该代码，因为它似乎与平台无关。

# java - Java 序列化和 JavaBeans

> ID：13351969
> 
> 赞同：2
> 
> 时间：2012-11-12T21:37:01.233
> 
> 标签：java, serialization, javabeans

快速提问，当将对象标记为可序列化时，它是否需要是 JavaBean？我的意思是，你能序列化一个不是 JavaBean 的对象吗？它有任何风险吗？如果您打算将对象序列化，那么始终将其设为 JavaBean 是一种好习惯吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-12T21:41:46.553

你以错误的方式看待它。Java Bean 是**任何**类

1) 实现 Serializable
2) 具有无参数构造函数
3) 具有私有成员和 setter/getter

所以你的问题

> 将对象标记为可序列化，它是否需要是 JavaBean？

有它倒退。通过实现接口，任何类都可以是可序列化的。并非所有可序列化的类都定义了 Java Bean。

> 我的意思是，你能序列化一个不是 JavaBean 的对象吗？

是的。

> 如果您打算将对象序列化，那么始终将其设为 JavaBean 是一种好习惯吗？

在设计类时考虑数据封装是一种很好的做法。这意味着直接限制对字段的访问，并在适当的情况下使用 setter 和 getter。

当然，从 API 的角度来看，并不总是需要一个公共的无参数构造函数。

如果您要使用一个依赖于您的类是 Java Bean 的库，那么您实际上只需要遵循 Java bean 标准。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:50:49.213

Serializable 是一个标记接口。您使用可序列化接口标记的每个对象都可以通过线路发送或保存在文件中。例如，如果您使用可序列化接口标记类 Foo，您可以保护文件中的对象状态并在以后恢复它：

```
public class Foo implements java.io.Serializable{  
  public String name;
}

public main(){
 Foo foo = new Foo();
 foo.name="test";
  try
  {
     FileOutputStream fileOut = new FileOutputStream("foo.file");
     ObjectOutputStream out = new ObjectOutputStream(fileOut);
     out.writeObject(foo);
  }
} 
```

这意味着它不需要是 JavaBean。它可能是一个普通的旧 java 对象，如 Foo 对象示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:38:00.593

如果要序列化类的对象，则该类需要实现可序列化接口，而不管它是具有简单属性的 bean（或）类。

> 序列化对象意味着将其状态转换为字节流，以便字节流可以恢复为对象的副本。如果 Java 对象的类或其任何超类实现了 java.io.Serializable 接口或其子接口 java.io.Externalizable，则它是可序列化的。反序列化是将对象的序列化形式转换回对象副本的过程

本[教程](http://docs.oracle.com/javase/tutorial/jndi/objects/serial.html)可能会对您有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:43:43.007

您可以序列化任何实现 Serializable 接口的对象，无论它是否是 JavaBean。

也就是说，不应轻易做出使对象可序列化的决定，因为它锁定了类的某些实现细节，从而降低了未来的灵活性。

有关实现 Serializable 的信息，请参见[此处](http://www.javapractices.com/topic/TopicAction.do?Id=45)。

# php - ZF2 子路由问题

> ID：13351971
> 
> 赞同：0
> 
> 时间：2012-11-12T21:37:27.020
> 
> 标签：php, zend-framework2

我正在尝试在 ZF2 中完成一些基本路由，但遇到了一些问题。

给我带来麻烦的部分是：

```
'parent-categories' => array(
    'type' => 'literal',
    'options' => array(
        'route' => '/kategorier/',
        'defaults' => array(
            'controller' => 'categories',
            'action' => 'parent-categories',
        ),
    ),
    'may_terminate' => true,
    'child_routes' => array(
        'child-categories' => array(
            'type' => 'segment',
            'options' => array(
                'route' => '/kategorier[/:slug][/:parentCategoryid]/',
                'constraints' => array(
                    'parentCategoryid' => '[0-9]+',
                ),
                'defaults' => array(
                    'controller' => 'categories',
                    'action' => 'child-categories',
                )
            ),
        ),
    ),
), 
```

原始的“父类别”路线工作得很好，没问题。但问题是子类别路线没有做任何事情。我有网址：

> /kategoier/test-test-test-test-test/1/

但这从来没有与任何东西相匹配。我得到错误：

> 请求的 URL 无法通过路由匹配。

如果我将子类别路由从“child_routes”部分中取出，它总是会捕获请求，即使 url 只是 /kategorier/。谁能看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:42:09.723

子路由附加到父路由。即您当前匹配的是

```
/kategorier//kategorier[/:slug][/:parentCategoryid]/ 
```

像这样做

```
'parent-categories' => array(
    'type' => 'literal',
    'options' => array(
        'route' => '/kategorier',
        'defaults' => array(
            'controller' => 'categories',
            'action' => 'parent-categories',
        ),
    ),
    'may_terminate' => true,
    'child_routes' => array(
        'child-categories' => array(
            'type' => 'segment',
            'options' => array(
                'route' => '[/:slug][/:parentCategoryid]',
                'constraints' => array(
                    'parentCategoryid' => '[0-9]+',
                ),
                'defaults' => array(
                    'controller' => 'categories',
                    'action' => 'child-categories',
                )
            ),
        ),
    ),
), 
```

我想这应该可以解决。最好不要使用尾部斜杠，因为理想情况下，您总是希望以一条开始新路线以获得更好的可读性；）

# c# - 过滤网格视图时无法绑定到没有名称错误的数据表

> ID：13351980
> 
> 赞同：0
> 
> 时间：2012-11-12T21:38:14.427
> 
> 标签：c#, sql

我有一个`datagridview`和 5 `ComboBoxes`，我正在尝试使用 ComboBox 的文本值过滤网格的行。网格填充存储过程取决于`FormLoad`事件中的某些条件。`btn_filter`我应该在点击事件中再次填写它吗？

无论如何，这个异常在下面的代码中被捕获：`cannot bind to datatable with no name.`

这是代码`btn_filter`：

```
 private void btnFilter_Click(object sender, EventArgs e)
    {
        String filterStr = "";

        if (cmbGrp.Text.Trim() != String.Empty)
            filterStr +=  "group ='" + cmbGrp.Text.Trim() + "' and";
        if(cmbMdl.Text.Trim() != String.Empty)
            filterStr += " model ='" + cmbMdl.Text.Trim() + "' and";
        if (cmbTrh.Text.Trim() != String.Empty)
            filterStr += " tarh ='" + cmbTrh.Text.Trim() + "' and";
        if (cmbSiz.Text.Trim() != String.Empty)
            filterStr += " size ='" + cmbSiz.Text.Trim() + "' and";
        if (cmbClr.Text.Trim() != String.Empty)
            filterStr += " color ='" + cmbClr.Text.Trim() + "'";            

        if (filterStr.LastIndexOf("and") == filterStr.Length - 3)
            filterStr = filterStr.Remove(filterStr.Length-3,3);

        DataView view = new DataView();
        if (condition1)
            view.Table = Production.usp1(txtProdCode.Text);
        else if (condition2)
            view.Table = Production.usp2();
        else
            return;
        view.RowFilter = filterStr;
        dgv.DataSource = view;    
    } 
```

这是与storedProcedure相关的函数（在`Production`类中）：

```
 public static DataTable usp2()
    {
        SqlCommand cmd = new SqlCommand("usp2");
        return callProc(cmd);
    }

    public static DataTable usp1(String prod_code)
    {
        SqlCommand cmd = new SqlCommand("usp1");
        cmd.Parameters.Add(new SqlParameter("@prod_code", prod_code));
        return callProc(cmd);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:42:52.993

尝试明确指定名称。`DataTable.TableName="Name"`在创建数据视图之前使用。
您的 btnFilter_Click 方法应如下所示：

```
 private void btnFilter_Click(object sender, EventArgs e)
    {
        String filterStr = "";

        filterStr +=      "grp_name " + (cmbGrp.Text.Trim() == String.Empty ? " like '%'" : "='" + cmbGrp.Text.Trim()) + "'";
        filterStr += " and mdl_name " + (cmbMdl.Text.Trim() == String.Empty ? " like '%'" : "='" + cmbMdl.Text.Trim()) + "'";
        filterStr += " and trh_name " + (cmbTrh.Text.Trim() == String.Empty ? " like '%'" : "='" + cmbTrh.Text.Trim()) + "'";
        filterStr += " and siz_name " + (cmbSiz.Text.Trim() == String.Empty ? " like '%'" : "='" + cmbSiz.Text.Trim()) + "'";
        filterStr += " and clr_name " + (cmbClr.Text.Trim() == String.Empty ? " like '%'" : "='" + cmbClr.Text.Trim()) + "'";

        DataView view = new DataView();

        if (condition1)
           {
            var dt = Production.usp1(txtProdCode.Text);
            dt.TableName="usp1";
            view.Table = dt;
            }
        else if (condition2)
            {
            var dt = Production.usp2();
            dt.TableName="usp2";
            view.Table = dt;
            }
        else
            return;
        view.RowFilter = filterStr;
        dgv.DataSource = view;    
    } 
```

要不再使用 DB 中的值重新加载网格，您可以将现有数据源转换为 DataView，如下所示：

```
(dataGridViewFields.DataSource as DataTable).DefaultView.RowFilter 
```

[在这个问题](https://stackoverflow.com/questions/5843537/filtering-datagridview-without-changing-datasource)中阅读更多内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:46:56.237

感谢user1792936，您实现的方式是正确的，但是有一种更简单的方法：[根据此链接和布拉德布鲁斯的回答](https://stackoverflow.com/questions/5843537/filtering-datagridview-without-changing-datasource)

我不需要再次填充网格：

```
(dgv.DataSource as DataTable).DefaultView.RowFilter = filterStr; 
```

# python - 根据字母顺序比较字符串

> ID：13351981
> 
> 赞同：23
> 
> 时间：2012-11-12T21:38:23.673
> 
> 标签：python

编写一个函数，将两个字符串作为参数并返回较长的那个。如果字符串的长度相等，则返回按字母顺序排在第一位的字符串。

这是我到目前为止所拥有的：

```
 def strings(x,y):
        if len(x) > len(y):
            return x
        if len(x)==len(y):
            return 
        else:
            return y 
```

我想知道如何编写代码，以便为第二个 if 语句选择按字母顺序排列的字符串。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-12T21:48:22.340

您可以直接比较字符串。 `x<y`表示“x 是否按字母顺序排在 y 之前？” 因此，您可以将第二个块替换为：

```
if len(x) == len(y) and x < y:
    return x 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-12T21:40:07.810

这应该工作：

```
if len(x)==len(y):
   return min(x,y) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-12T21:45:46.977

```
def f(x,y):
    return len(x) != len(y) and max([x,y],key=len) or min(x,y) 
```

# sql - 加速这个 SQL 查询？

> ID：13351988
> 
> 赞同：0
> 
> 时间：2012-11-12T21:38:48.513
> 
> 标签：sql, sql-server-2008

此查询当前运行大约需要 30 秒。

我想要一些帮助加快它，但不知道如何去做。任何帮助都会很棒。请注意：我目前无法对数据库或其设计进行任何实际更改。

```
SELECT top 1 v.[address], v.[address2], v.[city], v.[state_prov_id],v.[postcode],
        v.[first_name], v.[last_name], v.[client_specific_id], v.[name], v.phone,
        v.Location_id, v.Contact_id, v.Event_ID, v.client_id, v.program_id,
        v.source_code_id, v.file_source_code_id, v.URL, v.ScriptFrame,
        v.calldatemark, v.NumCallMark + 1 as Numcallmark,
        v.NumCallMarkDay + 1 as NumCallMarkDay,
        v.NumCallMarkWeek + 1 as NumCallMarkWeek, v.autoaudio,
        v.autohumantext, v.automachinetext 
   FROM vw_locationcontactdialer v 
  WHERE v.program_id = 10001565
    and v.numcallmark < 3 
    and (dateadd(hh,72,v.calldatemark) < getdate()
        or v.calldatemark = '01/01/1900' or v.calldatemark is null) 
    and  source_code_id = 10015311 
    and v.contact_id not in ( select contact_ID from CALL_HISTORY with (NOLOCK) 
                               where program_ID = 10001565 
                                 and result_id not in ('8','U','N')
                               group by contact_ID)
  order by calldatemark 
```

我得到了一个提示，可以尝试进行 JOIN，但我不确定我将如何完成此操作。我不确定如何进行 JOIN 并确保所有不在子查询中的 contact_id 都已完成。

我想出了这个：

```
SELECT TOP 1 v.[address], v.[address2], v.[city], v.[state_prov_id],v.[postcode],
            v.[first_name], v.[last_name], v.[client_specific_id], v.[name],
            v.phone, v.Location_id, v.Contact_id, v.Event_ID, v.client_id,
            v.program_id, v.source_code_id, v.file_source_code_id, v.URL,
            v.ScriptFrame, v.calldatemark,
            v.NumCallMark + 1 as Numcallmark,
            v.NumCallMarkDay + 1 as NumCallMarkDay,
            v.NumCallMarkWeek + 1 as NumCallMarkWeek, v.autoaudio,
            v.autohumantext, v.automachinetext 
  from vw_locationcontactdialer v 
  JOIN CALL_HISTORY ch on v.Contact_ID = ch.contact_ID
 where v.Program_ID = 10001565
   and v.NumCallMark < 3
   and (DATEADD(hh,72,v.calldatemark) < GETDATE() 
        or v.CallDateMark = '01/01/1900' or v.CallDateMark is null)
   and v.Source_Code_ID = 10015311
   and ch.result_ID not in ('8','U','N')
 group by ch.contact_id
 order by v.CallDateMark 
```

但由于此错误而无法正常工作，我不完全理解：Msg 8120, Level 16, State 1, Line 1 Column 'vw_locationcontactdialer.address' 在选择列表中无效，因为它不包含在任一聚合函数中或 GROUP BY 子句。

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:53:09.190

我可以给你一个小提示：子句 "(DATEADD(hh,72,v.calldatemark) < GETDATE()" 可以防止调用 calldatemark 字段上的索引被使用。它可能有助于将其替换为 "v.calldatemark <日期添加（hh，-72，GETDATE（））“。

另外，忽略“分组依据”。您只对某些contact_Id 感兴趣。如果子选择的结果仅包含几个条目，则将其转换为 JOIN 时不会获得任何性能。

正如评论已经说过的那样，您应该检查并最终发布底层视图的架构，因为它可能是性能不佳的根本原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:54:48.573

您可以将其转换为连接，如下所示：

```
from vw_locationcontactdialer v left outer join
     (select contact_ID
      from CALL_HISTORY with (NOLOCK) 
      where program_ID = 10001565 and 
            result_id not in ('8','U','N')
      group by contact_ID
     ) ch
     on v.contact_id = vh.contact_id
where . . .
      ch.contact_id is null
order by calldatemark 
```

（抱歉，如果我尝试发布整个查询，我会收到错误消息。）

但是，为了使这项工作更好，您可能希望返回原始查询并使用相关子查询：

```
where
      not exists (select 1
                  from CALL_HISTORY ch with (NOLOCK) 
                  where program_ID = 10001565 and 
                        result_id not in ('8','U','N') and
                        ch.contact_id = v.contact_id
                 ) 
```

如果您在 CALL_HISTORY.Contact_Id 上有一个索引，它会有所帮助。更好的是，Call_History 上的多部分索引包含contact_id、result_id 和program_id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T15:37:57.293

我确实想出了一种方法来让它正常工作，这是我的代码：

```
Select top 1 v.[address], v.[address2], v.[city], v.[state_prov_id], v.[postcode], 
v.[first_name], v.[last_name], v.[client_specific_id], v.[name], 
v.phone, v.Location_id, v.Contact_id, v.Event_ID, v.client_id, v.program_id,
v.source_code_id, v.file_source_code_id, v.URL, v.ScriptFrame, v.calldatemark,
v.NumCallMark + 1 as Numcallmark, 
v.NumCallMarkDay + 1 as NumCallMarkDay, 
v.NumCallMarkWeek + 1 as NumCallMarkWeek, v.autoaudio, 
v.autohumantext, v.automachinetext 
from vw_locationcontactdialer v 
left join (select contact_id from CALL_HISTORY 
where program_ID = 10001565 and result_ID not in ('8','U','N') 
group by contact_ID) h on v.Contact_ID = h.contact_ID 
where v.program_id = 10001565 
and v.numcallmark < 3 and (dateadd(hh,72,v.calldatemark) < getdate() 
or v.calldatemark = '01/01/1900' or v.calldatemark is null) 
and  source_code_id = 10015311  
and h.contact_ID is null order by calldatemark 
```

# javascript - 在正则表达式中，匹配一件事或另一件事，或两者都匹配

> ID：13351990
> 
> 赞同：33
> 
> 时间：2012-11-12T21:39:04.107
> 
> 标签：javascript, regex

在正则表达式中，我需要知道如何匹配一件事或另一件事，或两者（按顺序）。但至少其中一件事需要存在。

例如下面的正则表达式

```
/^([0-9]+|\.[0-9]+)$/ 
```

将匹配

```
234 
```

和

```
.56 
```

但不是

```
234.56 
```

而下面的正则表达式

```
/^([0-9]+)?(\.[0-9]+)?$/ 
```

将匹配上面的所有三个字符串，但它也会匹配我们不想要的空字符串。

我需要匹配上面所有三个字符串的东西，但不是空字符串。有没有简单的方法可以做到这一点？

**更新：**

下面的 Andrew 和 Justin 都适用于我提供的简化示例，但它们（除非我弄错了）不适用于我希望解决的实际用例，所以我现在应该把它放进去。这是我正在使用的实际正则表达式：

```
/^\s*-?0*(?:[0-9]+|[0-9]{1,3}(?:,[0-9]{3})+)(?:\.[0-9]*)?(\s*|[A-Za-z_]*)*$/ 
```

这将匹配

```
45
45.988
45,689
34,569,098,233
567,900.90
-9
-34 banana fries
0.56 points 
```

但它不匹配

```
.56 
```

我需要它来做到这一点。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-12T21:45:10.850

给定正则表达式的完全通用方法`/^A$/`是`/^B$/`：

```
/^(A|B|AB)$/ 
```

IE

```
/^([0-9]+|\.[0-9]+|[0-9]+\.[0-9]+)$/ 
```

请注意，其他人已使用您的示例结构进行了简化。具体来说，他们（隐含地）将其分解，以提取左右两边的共同点`[0-9]*`和因数。`[0-9]+`

为此的工作是：

*   交替的所有元素都以 结尾`[0-9]+`，所以把它拉出来：`/^(|\.|[0-9]+\.)[0-9]+$/`
*   现在我们有可能在交替中出现空字符串，所以使用`?`（即使用等价`(|a|b) = (a|b)?`）重写它：`/^(\.|[0-9]+\.)?[0-9]+$/`
*   再一次，一个通用后缀的替换（`\.`这次）：`/^((|[0-9]+)\.)?[0-9]+$/`
*   模式`(|a+)`与 相同`a*`，因此，最后：`/^([0-9]*\.)?[0-9]+$/`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T21:42:01.687

是的，您可以使用这样的表达式匹配所有这些：

```
/^[0-9]*\.?[0-9]+$/ 
```

请注意，它也不匹配空字符串（您的最后一个条件）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-12T21:42:42.900

当然。您需要可选的量词`?`.

```
/^(?=.)([0-9]+)?(\.[0-9]+)?$/ 
```

上面看起来有点尴尬，但我想向你展示你的确切模式，其中包含一些`?`s。在这个版本中，`(?=.)`确保它不接受空字符串，因为我已经将这两个子句都设为可选。一个更简单的版本是这样的：

```
/^\d*\.?\d+$/ 
```

这满足您的要求，包括防止出现空字符串。

请注意，有很多方法可以表达这一点。有些很长，有些非常简洁，但[根据您尝试允许/禁止的内容，它们会变得更加复杂](https://stackoverflow.com/a/5917250/399649)。

# 编辑：

如果您想在更大的字符串中匹配它，我建议使用`/^\d*\.?\d+$/`. 否则，您将面临匹配`aaa.123.456.bbb`或丢失匹配的风险（相信我，您会的。JavaScript 缺乏后向支持确保可以打破我能想到的任何模式）。

如果你知道你不会得到像上面这样的字符串，你可以使用分词而不是`^$`锚点，但它会变得复杂，因为`.`和（空格）之间没有分词。

```
/(\b\d+|\B\.)?\d*\b/g 
```

那应该这样做。它会阻止类似的东西`aaa123.456bbb`，但它会允许`123`,`456`或`123.456`. 它会允许`aaa.123.456.bbb`，但正如我所说，如果你想全面处理它，你需要两个步骤。

# 编辑 2：您的用例

如果您想在开头允许空格，在结尾处允许负/正标记和单词，那么这些实际上是相当严格的规则。这是好事。您可以将它们添加到上面最简单的模式中：

```
/^\s*[-+]?\d*\.?\d+[a-z_\s]*$/i 
```

允许数千组使事情变得非常复杂，我建议你看看我链接到的答案。这是结果模式：

```
/^\s*[-+]?(\d+|\d{1,3}(,\d{3})*)?(\.\d+)?\b(\s[a-z_\s]*)?$/i 
```

确保数字部分以`\b`数字结尾，并且后跟至少一个空格。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-03-07T05:27:25.507

huon 的回答很好（还有一点脑筋急转弯，直到最后）。对于希望快速简单地回答这个问题的标题“在正则表达式中，**匹配一件事或另一件事，或两者**”的任何人，值得一提的是，即使 (A|B|AB) 也可以简化为：

```
A|A?B 
```

如果 B 稍微复杂一点，就很方便。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-01T12:34:17.197

也许这有帮助（给你一个大致的想法）：

```
(?:((?(digits).^|[A-Za-z]+)|(?<digits>\d+))){1,2} 
```

此模式匹配字符、数字或字符后面的数字，但不匹配数字后面的字符。该模式匹配 aa、aa11 和 11，但不匹配 11aa、aa11aa 或空字符串。不要对“.^”感到困惑，它的意思是“一个字符后跟行开始”，它的目的是完全阻止任何匹配。

请注意，这不适用于所有风格的正则表达式，您的正则表达式版本必须支持`(?(named group)true|false)`.

# ant - 如果 makefile 失败，停止 ant 构建

> ID：13351992
> 
> 赞同：4
> 
> 时间：2012-11-12T21:39:15.393
> 
> 标签：ant, java-native-interface, makefile

我有一个执行 makefile 的 ant 构建文件

```
 <target name="jni">
            <exec executable="make">
                <arg line="-f jni/Makefile"/>
            </exec>
        </target> 
```

但是，如果 make 失败，则将执行依赖于此规则的其他规则

如果 jni 规则失败，我该如何阻止 ant？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T21:44:50.793

使用`failonerror`属性，`false`默认情况下：

```
<target name="jni">
    <exec executable="make" failonerror="true">
        <arg line="-f jni/Makefile"/>
    </exec>
</target> 
```

我永远不会停止想知道为什么默认情况下它不是真的...... [请参阅文档。](http://ant.apache.org/manual/Tasks/exec.html)

# javascript - 使用 JQuery 创建自动滚动图库；需要有关正确代码的建议

> ID：13351993
> 
> 赞同：1
> 
> 时间：2012-11-12T21:39:22.673
> 
> 标签：javascript, events, slider, jquery

我正在尝试从头开始创建一个自动滚动的图片库。现在，我已经编写了图像以在发生悬停时进行更改。

我的理论是我可以使用“.ready”并创建这些函数的循环。我试图创建它，但我仍然不知道如何正确调用这些函数。

我将使用什么事件来创建此效果的循环发生？我也在寻找对我的想法的批评，所以我很欣赏在简单答案之外的任何见解。

这是代码！多谢你们！

```
$(document).ready(function() {
$('#blinds_1').show();
$('#blinds_2').hide();

$("#blinds_1").mouseover(function(){
    $('#blinds_1').fadeOut(600);
    $('#blinds_2').slideDown(600);
});

$("#blinds_2").mouseout(function(){
    $('#blinds_1').slideDown(600);
    $('#blinds_2').fadeOut(600);
});

}); 
```

# ruby - Fixnum 字符串转换

> ID：13351994
> 
> 赞同：2
> 
> 时间：2012-11-12T21:39:24.473
> 
> 标签：ruby

我想在 Ruby 中获取当前时间的字符串：

```
"Time is " + Time.new.month + "/" + Time.new.day + "/" + Time.new.year 
```

但它说“无法将 Fixnum 转换为字符串”。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:43:30.450

或者你可以使用正确的工具来完成这项工作：时间格式化。

```
Time.new.strftime "Time is %m/%d/%Y" # => "Time is 11/13/2012" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:41:00.563

你可以使用`to_s`

```
"Time is " + Time.new.month.to_s + "/" + Time.new.day.to_s + "/" + Time.new.year.to_s 
```

但事件更好的是使用`strftime`

```
Time.new.strftime("Time is %-m/%e/%Y") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T21:42:47.690

Ruby 只能将字符串添加到字符串中，因此需要进行转换。请注意，在双引号字符串中插入的元素会自动转换：

```
now = Time.new
"Time is #{now.month}/#{now.day}/#{now.year}" 
```

也可以将它们从一个数组中组合起来，它们也会自动转换：

```
now = Time.new
"Time is " + [ now.month, now.day, now.year ].join('/') 
```

您还可以使用`sprintf`-style 插值：

```
now = Time.new
"Time is %d/%d/%d" % [ now.month, now.day, now.year ] 
```

第二个使您可以更好地控制格式。例如`%02d`将填充`0`到两个地方。

正如 Sergio 指出的那样，这种格式有一个特殊用途的函数，这可能是一个更好的主意。也是*目前*`Time.now`的传统方法，而用于创建任意时间。*`Time.new`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T22:44:17.717

只要有可能，最好使用字符串插值而不是串联。正如您在（[线程](https://stackoverflow.com/questions/10076579/string-concatenation-vs-interpolation-in-ruby)）中清楚地看到的那样，使用字符串插值会自动`to_s`为您调用。

使用字符串插值：

“时间是 #{Time.new.month}/#{Time.new.day}/#{Time.new.year}”*

# xcode - 静态库链接错误

> ID：13351995
> 
> 赞同：1
> 
> 时间：2012-11-12T21:39:38.427
> 
> 标签：xcode, static-libraries

尝试归档我的项目时出现 Apple Mach-O Librarian 错误。

我有一个链接到 FDLibrary 的 Xcode 项目。它是一个包含在同一工作区中的静态库。FDLibrary 链接到 SDLibrary。另一个静态库也包含在工作区中。

我知道拥有多个静态库是非常规的，但是 SDLibrary 包含多个应用程序的许多通用代码，而 FDLibrary 包含许多构建在 SDLibrary 上的通用代码，只有少数应用程序需要。基本上，FDLibrary 包含许多特定的接口模板，而 SDLibrary 几乎是所有数据结构和对象类型。

构建和运行到设备完全正常。但是我今天开始存档并遇到了这个错误。

欢迎所有提示！提前致谢！

```
Libtool "/Users/rpools1951/Library/Developer/Xcode/DerivedData/FunDecks-fqrkiylcrromdnbuuyxoyjotckal/Build/Intermediates/ArchiveIntermediates/Irregular Verbs/IntermediateBuildFilesPath/FDLibrary.build/Release-iphoneos/FDLibrary.build/Objects-normal/armv7s/libFDLibrary.a" normal armv7s
    cd /Users/rpools1951/Projects/Workspaces/FDLibrary
    setenv IPHONEOS_DEPLOYMENT_TARGET 6.0
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool -static -arch_only armv7s -syslibroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.0.sdk "-L/Users/rpools1951/Library/Developer/Xcode/DerivedData/FunDecks-fqrkiylcrromdnbuuyxoyjotckal/Build/Intermediates/ArchiveIntermediates/Irregular Verbs/BuildProductsPath/Release-iphoneos" -LSDLibrary -filelist "/Users/rpools1951/Library/Developer/Xcode/DerivedData/FunDecks-fqrkiylcrromdnbuuyxoyjotckal/Build/Intermediates/ArchiveIntermediates/Irregular Verbs/IntermediateBuildFilesPath/FDLibrary.build/Release-iphoneos/FDLibrary.build/Objects-normal/armv7s/FDLibrary.LinkFileList" -ObjC -framework UIKit -lSDLibrary -framework Foundation -o "/Users/rpools1951/Library/Developer/Xcode/DerivedData/FunDecks-fqrkiylcrromdnbuuyxoyjotckal/Build/Intermediates/ArchiveIntermediates/Irregular Verbs/IntermediateBuildFilesPath/FDLibrary.build/Release-iphoneos/FDLibrary.build/Objects-normal/armv7s/libFDLibrary.a"

/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: -dynamic not specified the following flags are invalid: -ObjC 
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: can't locate file for: -lSDLibrary
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: file: -lSDLibrary is not an object file (not allowed in a library)
Command /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool failed with exit code 1 
```