# StackOverflow 问答 13318000-13318999

# c++ - 如何迭代没有最后一个元素的列表

> ID：13318003
> 
> 赞同：1
> 
> 时间：2012-11-10T00:34:01.003
> 
> 标签：c++, iterator

我想要做的只是迭代 a`std::list`除了最后一个元素。我正在尝试什么：

```
#include <cstdlib>
#include <list>

int main() {
  std::list<int> *list = new std::list<int>(100);
  std::list<int>::iterator it;

  for (it = list->begin(); it != list->end()-1; it++) {
    // some action here...
  }
} 
```

但是，这行不通。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T00:42:16.493

至于为什么会失败：

A`list::iterator`是一个`BidirectionalIterator`。不能使用 递减`operator-`或递增`operator+`。这些操作保留给`RandomAccessIterator`. 但是，您可以使用 减少它`operator--`。

```
std::list<int> x;
// --end(x) would work as well here, but I don't recommend it
auto end = end(x); 
--end;

// or even better
end = std::prev(end(x));

for(auto it = begin(x); it != end; ++it) {

} 
```

另外，请放下指针。您的简单示例已经在泄漏内存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T00:35:27.010

`std::list`使用不支持的双向迭代器`operator-`。改用`std::prev`：

```
for (it = list->begin(); it != std::prev(list->end()); it++) {
  // some action here...
} 
```

# haskell - Haskell 函数中的类型错误

> ID：13318008
> 
> 赞同：0
> 
> 时间：2012-11-10T00:34:39.723
> 
> 标签：haskell, substitution, unification

我写了一个 Haskell 函数，如下所示：

```
shift :: Subst a -> Subst a
shift (S s) = [(x, (subst s' d)) | (x,d) <- s] where 
      s' = [(x,d) | (x,d) <- s, null (vars d)] 
```

像这样的数据类型`data Subst a = S [(String,a)]`

我已经声明`subst`了 as`subst :: Subst a -> a -> a`和`vars`as `vars :: a -> [String]`。当我运行它时，我得到一个类型错误。任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:47:26.220

您的`shift`函数被声明为返回 a `Subst`，但它实际上返回一个列表。您可能打算将`Subst`构造函数包装在列表周围。

然后你的`subst`函数被声明接受一个`Subst`参数，但是你用一个列表来调用它——基本上是同样的问题。

此外，您的`vars`函数也可能包含类型错误，因为正如我在对您之前的问题的回答中指出的那样，您无法定义一个有意义的 type 函数`a -> [String]`。

# c++ - 使用 2D Ising 模型。C++ 新手。我在第 23 行收到错误“在 '{' 标记之前的预期不合格 ID”

> ID：13318009
> 
> 赞同：3
> 
> 时间：2012-11-10T00:34:42.233
> 
> 标签：c++

我正在研究一个应该模拟一张电子的 2D Ising 模型。我有这个在 Python 中工作，但是一旦我试图将它升级太多，它似乎运行得太慢了。我一直在通过 C++ 来尝试翻译它，这就是我所拥有的。虽然功能不全，但我只需要它运行并吐出一些能量和磁化水平。但是，我在 initEnergy() 函数的第 23 行遇到了错误“在 '{' token' 之前的预期不合格 ID。就语法而言，我是否遗漏了什么，或者我犯了其他一些愚蠢的错误？感谢您提供的任何帮助。

```
#include <iostream>
#include <cstdlib>
#include <ctime>
#include <vector>

#define T 2
#define n 10
#define iterations 10000
#define dataInterval 100
#define repeat 4

using namespace std;
using std::vector;

int sweep = n*n;     //number of trials that constitutes one sweep of the system
int trials = sweep * iterations;    //number of trial changes
vector<vector<int> > state;

int initEnergy(int state);{
    int energy = 0;
    for (int i = 0; i < n; i++){
        for (int j = 0; j < n; j++){
            if (i == n-1){
                if (j != n-1){
                    //if you're on the right side and not in the corner
                    energy = energy + state[i][j]*state[i][j+1];    
                }
            }
            //if you're on the bottom edge and not in the corner
            else if (j == n-1){
                energy = energy + state[i][j]*state[i+1][j];    
            }
            else{
                energy = energy + state[i][j]*state[i][j+1]*state[i+1][j];   //add the     energy of dipole and right and bottom partners
            }
        }
    }
    return -energy
}

int initMag(state);{
    int mag = 0;
    for (int i = 0; i < n; i++){
        for (int j = 0; j < n; j++){
            mag = mag + state[i][j];
        }
    }
    return mag
}

int dEnergy(i, j, n, state);{
    if (i != 0)
        left = state[i-1][j];
    else
        left = 0;
    if (i != n-1)
        right = state[i+1][j];
    else
        right = 0;
    if (j != 0)
        top = state[i][j-1];
    else
        top = 0;
    if (j != n-1)
        bottom = state[i][j+1];
    else
        bottom = 0;

    return 2*state[i][j]*(left+right+top+bottom);
}

int main()
{
    srand(time(0));

    state.resize(n);
    for (int i = 0; i < n; i++){
        state[i].resize(n);
        }

    vector<vector<int>> E;
    E.resize(repeat);
    for (int i = 0; i < repeat; i++){
        E[i].resize((iterations-5000)/dataInterval+1)
        }

    vector<vector<int>> M;
    M.resize(repeat);
    for (int i = 0; i < repeat; i++){
        M[i].resize((iterations-5000)/dataInterval+1)
        }

    for (int setup = 1; setup <= repeat; setup++){
        //1\. Establish an initial microstate.
        for (int i = 0; i < n; i++){
            for (int j = 0; j < n; j++){
                if (rand()%1 > 0.5)
                    state[i][j] = 1;
                else
                    state[i][j];
            }
        }

        //2\. Make a random trial change in the microstate.
        Estate = initEnergy(state)
        Mstate = initMag(state)
        for (int m = 1; m <= trials; m++){
            int i = rand()%n;
            int j = rand()%n;
            //3\. Compute dE, the change in the energy of the system due to the trial     change.
            int dE = dEnergy(i, j, n, state);
            //4\. If dE is less than or equal to zero, accept the new microstate and go     to step 8.
            if ((dE <= 0) || (rand() < exp(-dE/T))){
                state[i][j] = -state[i][j];
                Estate = Estate + dE;
                Mstate = Mstate + 2 * state[i][j];
            }
            //5\. If dE is positive, compute the quantity w = e^(-b*dE).
            //6\. Generate a random number r in the unit interval.
            //7\. If r <= w, accept the new microstate; otherwise retain the previous     microstate.
            //8\. Determine the value of the desired physical quantities.
            if (m%(dataInterval*sweep) == 0){
                print("Finished sweep " + str(m/sweep) + " of iteration " + str(setup));
                if (m >= sweep*5000){
                    E[repeat-1][m/(dataInterval*sweep)-5000] = Estate;
                    M[repeat-1][m/(dataInterval*sweep)-5000] = Mstate;
                }
            }
        }

        cout << E + "\n" + M + "\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:35:53.367

```
int initEnergy(int state);{ 
```

那个分号在那里做什么？每个函数签名后都有一个。这是错误的，它们需要被删除。否则它被解释为一个函数原型，后面有一段代码，这是无效的。

```
int initEnergy(int state) {
    // code here
} 
```

是正确的;

# jquery-ui - 在 css 中设置 jquery div 样式

> ID：13318011
> 
> 赞同：-1
> 
> 时间：2012-11-10T00:34:55.893
> 
> 标签：jquery-ui, jquery, jquery-plugins, jquery-selectors

为什么我不能通过上课来设置这个样式

```
<div class="ko">add image</div> 
```

[http://jsfiddle.net/6Mmme/27/](http://jsfiddle.net/6MmMe/27/)

```
$("div").hover(
  function () {
    $("<div class="ko">add image</div>").click(function() {
        $(this).parent().unbind("hover").children("img").attr("src", "http://www.onlinegrocerystore.co.uk/images/goodfood.jpg");
        $(this).remove();
    }).appendTo(this);
  }, 
  function () {
    $(this).find("div:last").remove();
  }
);

//li with fade class
    //$("li.fade").hover(function(){$(this).fadeOut(100);$(this).fadeIn(500);}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T00:37:26.573

通过将类名括在双引号中，您已经关闭了用于创建 div 的字符串。使用单引号（双引号内）来阻止这种情况发生......

```
$("div").hover(
    function () {
        $("<div class='ko'>add image</div>").click(function() {
            $(this).parent().unbind("hover").children("img").attr("src", "http://www.onlinegrocerystore.co.uk/images/goodfood.jpg");
            $(this).remove();
        }).appendTo(this);
    }, 
    function () {
        $(this).find("div:last").remove();
    }
); 
```

看到这个更新小提琴...

[http://jsfiddle.net/6Mmme/28/](http://jsfiddle.net/6MmMe/28/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T00:41:14.567

```
$("<div class=\"ko\">add image</div>") 
```

# c - 关于在 C 中使用扩展符号将 char 转换为 int

> ID：13318014
> 
> 赞同：2
> 
> 时间：2012-11-10T00:35:21.243
> 
> 标签：c, types, integer, char, type-conversion

我正在阅读 Stephen G. Kochan 撰写的关于 C 编程的书 Programming in C。它指出：

“如果使用的字符值不是标准字符的一部分，则在转换为整数时可能会扩展其符号”

然后它说

“C 语言允许将字符变量声明为无符号，这避免了这个潜在的问题”

有人可以解释在从 char 转换为 int 期间扩展符号时可能会出现什么问题吗？为什么这很重要？从字符转换为负整数有什么问题？

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T01:01:39.660

假设您从 <ctype.h> 中获取了一个看起来很无辜的函数，`isupper()`。

它已定义`int isupper(int c);`。所以它需要一个 int 并返回一个 int。

现在，假设您不是一个非常细心的程序员，您只是将 char 传递给该函数。你自己想：“会出什么问题？这是我所知道的最简单的功能！”。

但你错了。在某个地方，有人会让她的 MP3 播放器因为这个可怕的错误而陷入无休止的崩溃循环。

这就是为什么。C 中最烦人的类型是 char。它可以是有符号的，也可以是无符号的，你可以以一种或另一种方式强制编译器（但随后你会打开另一个蠕虫罐），最糟糕的是，标准 C 库到处都使用这种类型！

因此，您使用 char，但您不知道它实际上已在您的环境中签名。你使用它就像世界是一个 ASCII 世界一样。

但世界不是。那个快乐的 MP3 拥有者现在正在听一首著名的德国歌曲，其名称中包含字母 ä（“扩展 ASCII 代码 132”）。

你把这个字符传递给`isupper()`，编译器会做以下恐怖的事情：“啊，它是一个字符，但是函数需要一个整数。我知道！我不会警告程序员，因为那太简单了。我只是转换字符到一个整数并传递它。我该怎么做？让我们检查一下 C 标准......嗯......简单，只需取值并对其进行符号扩展（因为 char 是有符号的，你不知道吗？） . 现在，这个字符的值为-124，所以我将它转换为值为-124的int。这很简单，我不明白大惊小怪。为什么我还要警告程序员？ ！”

现在`isupper()`用 -124 而不是 132 调用。

但这有什么问题呢？什么都没有，除了编译器附带的 C 库`isupper()`使用一个简单的 128 字节数组实现：它只是返回给定索引处的值。除了大写的 ASCII 码为 1 外，该数组在任何地方都初始化为 0。这样一个简单而优雅的实现......

但是等等，如果你将一个负值传递给这个函数会发生什么？好吧，这是不允许的：

> c 参数是一个 int，应用程序应确保其值是可表示为无符号字符的字符或等于宏 EOF 的值。如果参数有任何其他值，则行为未定义。

所以，未定义的行为。在这种情况下，它会尝试访问不属于该进程的内存，然后 BAM！程序崩溃。

所以你看，char 是邪恶的，你不应该使用它，除非你真的了解如何正确使用它。

(*) 正如 Keith Thompson 在评论中所说，当然不可能避免使用`char`. 从`strlen()`到[`curl_easy_escape()`](http://curl.haxx.se/libcurl/c/curl_easy_escape.html)，大家用`char`。但是您应该注意转换为`int`，尤其是当`char`可能包含负数时。<ctype.h> 函数和数组索引是容易犯代价高昂错误的两个地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T00:57:46.527

在 C 中，*plain* `char`可以是有符号或无符号的，选择权留给实现。

从**C99、6.2.5、7**开始：

> char、signed char 和 unsigned char 这三种类型统称为字符类型。实现应将 char 定义为与有符号字符或无符号字符具有相同的范围、表示和行为。

因此，当将字符分配给整数时，是否设置了 char 的符号位会产生歧义，因为它会影响分配*普通*char 的整数的结果值。

我相信，书中引用的文字是指这一点，并且`unsigned char`明确地使用可以避免这个问题。

# perl - uniq 主机名的内核版本

> ID：13318023
> 
> 赞同：3
> 
> 时间：2012-11-10T00:36:37.270
> 
> 标签：perl, bash, sed, awk

我有一个包含以下示例数据的输入文件。

kernel_version 主机名

```
2.6.32-220.el6.x86_64 www01.dc1.domain.com
2.6.32-220.el6.x86_64 www02.dc1.domain.com
2.6.32-220.el6.x86_64 exc01.dc1.domain.com
2.6.32-220.el6.x86_64 exc02.dc1.domain.com
2.6.32-120.el6.x86_64 www03.dc2.domain.com
2.6.32-120.el6.x86_64 www04.dc2.domain.com
2.6.32-120.el6.x86_64 exc03.dc2.domain.com
2.6.32-120.el6.x86_64 exc04.dc2.domain.com
2.6.32-100.el6.x86_64 www05.dc3.domain.com
2.6.32-100.el6.x86_64 www06.dc3.domain.com
2.6.32-100.el6.x86_64 exc05.dc3.domain.com
2.6.32-100.el6.x86_64 exc06.dc3.domain.com
2.6.32-220.el6.x86_64 www07.dc4.domain.com
2.6.32-220.el6.x86_64 www08.dc4.domain.com
2.6.32-220.el6.x86_64 exc07.dc4.domain.com
2.6.32-220.el6.x86_64 exc08.dc4.domain.com 
```

我想输出唯一的内核版本，以及哪个 dcs 正在运行哪个。

例如;

```
2.6.32-220.el6.x86_64 dc1, dc4
2.6.32-120.el6.x86_64 dc2
2.6.32-100.el6.x86_64 dc3 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:42:39.290

我会做这样的事情：

```
#!/usr/bin/perl
use warnings;
use strict;

my %kernels;
open INPUT,"<inputfile";

while (<INPUT>)
{
    my ($version, $hostname) = split(/\s+/,$_);
    if ($kernels{$version}) { $kernels{$version} .= ", $hostname" }
    else { $kernels{$version} = $hostname }
}
close INPUT;    

# Print the summary
foreach my $kernel (keys(%kernels)) {   print "$kernel\t$kernels{$kernel}\n"; } 
```

~~**警告：**我没有测试这个脚本。我不对可能由此代码引起的任何语法错误、竞争条件或 velociraptor 攻击负责。但它应该让你开始~~

**编辑：**我现在已经测试过了。一个句法错误已得到纠正，没有重大的迅猛龙攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T09:10:00.873

这可能对您有用：

```
sed 's/ [^\.]*\.\([^.]*\).*/ \1/' file |
sort -u |
sed ':a;$!N;s/^\(\(.*\) .*\)\n.*\2/\1,/;ta;P;D' 
```

这给出了结果，但不是原始顺序，用于原始顺序：

```
sed 's/ [^\.]*\.\([^.]*\).*/ \1/' file |
cat -n - |
sort -uk2,3 |
sed ':a;$!N;s/^\(.\{7\}\(.*\) .*\)\n.*\2/\1,/;ta;P;D' |
sort -n | 
sed 's/^.\{7\}//' 
```

# java - res.flushBuffer() 与 res.getOutputStream().flush();

> ID：13318024
> 
> 赞同：6
> 
> 时间：2012-11-10T00:36:40.440
> 
> 标签：java, http, web-applications, servlets

call 和有什么区别：

```
res.flushBuffer(); 
```

相对

```
res.getOutputStream().flush(); 
```

这些方法是否刷新相同的缓冲区？

如果是这样，你能给我一个关于 servlet 容器如何管理这个缓冲区的线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:21:01.090

> 打电话有什么区别...

唯一显着的区别是，无论您是以文本模式还是二进制模式编写/打算编写正文，第一个版本都可以使用，而第二个版本仅适用于二进制模式输出。

> 这些方法是否刷新相同的缓冲区？

由于 javadocs 没有给出明确的答案，因此从技术上讲，它取决于实现。然而，在实践中，大多数实现的答案可能是“是”，因为很难想象拥有单独的缓冲区是有意义的。

在 javadoc 中有一些间接证据：

*   javadoc for说：“设置*响应正文的*[`setBufferSize(int)`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#setBufferSize%28int%29)首选缓冲区大小。” 这意味着这个缓冲区与 javadoc 中提到的“缓冲区”相同。*`flushBuffer()`*

**   javadoc for[`flushBuffer()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#flushBuffer%28%29)说：“调用此方法会自动提交响应，这意味着将写入状态代码和标头。” ...这与一个模型一致，即所有事物都有效地使用一个缓冲区。* 

 *要注意的另一件事是，servlet 看到的响应对象*实际上*可能是一个特定于应用程序的包装器，它被插入到过滤器链的更深处。这种包装器的行为方式可能与 javadoc（以及 servlet 规范的其余部分）所说的不一致。

* * *

> 如果是这样，你能给我一个关于 servlet 容器如何管理这个缓冲区的线索吗？

最好的办法是查看容器的源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:25:09.553

如果您一直在使用`getOutputStream`写入正文，它们将刷新相同的缓冲区。另一种选择是`getWriter`用于非二进制数据。如果您一直在使用它，那么调用`res.getOutputStream().flush();`可能不起作用。

管理缓冲区的方式是特定于实现的，但以[Tomcat 实现之一为例](https://github.com/apache/tomcat70/blob/trunk/java/org/apache/catalina/connector/Response.java)。可以看到有一些字段是这样的：

```
/**
 * The associated output buffer.
 */
protected OutputBuffer outputBuffer;
/**
 * The associated output stream.
 */
protected CoyoteOutputStream outputStream;
/**
 * The associated writer.
 */
protected CoyoteWriter writer; 
```

调用`getOutputStream()`创建 a `CoyoteOutputStream`，它使用`outputBuffer`那里显示的字段，同样适用于`getWriter()`。所以他们都会`outputBuffer`根据你使用的来使用它。`flushBuffer`只是这样做：

```
@Override
public void flushBuffer()
    throws IOException {
    outputBuffer.flush();
} 
```*

# php - 每隔几秒刷新一次抓取服务器代码并更新表单元素

> ID：13318026
> 
> 赞同：8
> 
> 时间：2012-11-10T00:36:56.073
> 
> 标签：php, javascript, jquery, html, ajax

首先是应用程序的工作原理：（注意：页面上有多个用户，例如 Patient M、Patient E 等）

1) 患者 X 的姓名旁边是一个标记为**Check In**的按钮。这是在服务器端记录的。

2) 单击**Check In**按钮后，用户会看到一个下拉菜单（替换初始按钮），其中包含用户可以选择的多个位置。从选择中选择位置后，服务器端将再次更新。

3）然后用户可能决定选择多个位置，重复步骤 2

4) 最后，当用户选择完位置后，他在用户在步骤 2 和 3 中单击位置的同一个选择中单击**Check Out 按钮，标题为 Check Out。**单击此按钮后，它将被发送到 checkloc.php 并记录。

5) 最后，下拉菜单消失，出现 Checked Out 字样。

不幸的是，问题在于，如果我现在是计算机 1，并且通过单击签入、选择位置和签出的过程，这与计算机 2 完全不同。

来一张图：

![我想要发生的事情](../Images/7a03fddd59e26a84d30d3ee6b8184244.png)

所以基本上我需要一种方法来每隔几秒钟抓取一次服务器代码并用当前值更新表单元素。我是一个相当新的程序员，所以代码和教程会更有帮助。另外，就像我刚才提到的，我是一名新程序员，所以如果我的代码可以以任何方式清理，那就太好了。

感谢您的任何帮助！我很高兴澄清您的任何问题！

继承人的代码：

```
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>

<script type="text/javascript">
$(document).ready(function() {
$('.locationSelect').hide();  // Hide all Selects on screen
$('.finished').hide();        // Hide all checked Out divs on screen
$('.checkOut').hide();

$('.checkIn').click(function() {
    var $e = $(this);
    var data = $e.data("param").split('_')[1] ;
    // gets the id  of button
    // You can map this to the corresponding button in database...
    $.ajax({
        type: "POST",
        url: "checkin.php",
        // Data used to set the values in Database
        data: { "checkIn" : $(this).val(), "buttonId" : data},
        success: function() {
            // Hide the current Button clicked
            $e.hide();
            // Get the immediate form for the button
            // find the select inside it and show...
            $('.locationSelect').show();
            $('.checkOut').show();
        }
    });
});

$('.locationSelect').change(function() {
    $e = $(this);
    var data = $e.data("param").split('_')[1] ;
    // gets the id  of select
    // You can map this to the corresponding select in database...
    $.ajax({
        type: "POST",
        url: "changeloc.php",
        data: { "locationSelect" : $(this).val(), "selectid" : data},
        success: function() {
            // Do something here
        }
    });
});

$('.checkOut').click(function() {
    var $e = $(this);
    var data = $e.data("param").split('_')[1] ;
    // gets the id  of button
    // You can map this to the corresponding button in database...
    $.ajax({
        type: "POST",
        url: "checkout.php",
        // Data used to set the values in Database
        data: { "checkOut" : $(this).val(), "buttonId" : data},
        success: function() {
            // Hide the current Button clicked
            $e.hide();
            $('.locationSelect').hide();
            // Get the immediate form for the button
            // find the select inside it and show...
            $('.finished').show();
        }
    });
});

});
</script> 
```

和html：

```
<button class="checkIn" data-param="button_9A6D43BE-D976-11D3-B046-00C04F49F230">Check In</button>

<form method='post' class='myForm' action=''>
  <select name='locationSelect' class='locationSelect' data-param="location_9A6D43BE-D976-11D3-B046-00C04F49F230">
    <option value="0">Select a location</option>
    <option value='1'>Exam Room 1</option>
    <option value='2'>Exam Room 2</option>
    <option value='3'>Exam Room 3</option>
    <option value='4'>Exam Room 4</option>
  </select>
</form>
<button class="checkOut" data-param="cbutton_9A6D43BE-D976-11D3-B046-00C04F49F230">Check Out</button>

<div class='finished' style='color:#ff0000;'>Checked Out</div> 
```

继承人服务器端代码（我把它分成三页只是为了测试）

签入.php

```
<?php

date_default_timezone_set('America/Denver');

$apptid = $_REQUEST['buttonId'];
$currentlocationstart = date("Y-m-d H:i:s"); 

if(isset($_REQUEST['checkIn'])){
    $checkin = 0;
}

$hostname = 'localhost';

$username = '*******';

$password = '******';

$conn = new PDO("mysql:host=$hostname;dbname=sv", $username, $password);

$sql = "UPDATE schedule SET currentlocation = ?, currentlocationstart = ? WHERE apptid= ? ";
$q = $conn->prepare($sql);
$q->execute(array($checkin,$currentlocationstart, $apptid));

?> 
```

locationchange.php

```
<?php

date_default_timezone_set('America/Denver');

$apptid = $_REQUEST['selectId'];
$currentlocationstart = date("Y-m-d H:i:s"); 

if(isset($_REQUEST['locationSelect'])){
    $currentLocation = $_REQUEST['locationSelect'];
}

$hostname = 'localhost';
$username = '*****';
$password = '*******';

$conn = new PDO("mysql:host=$hostname;dbname=sv", $username, $password);

$sql = "UPDATE schedule SET currentlocation = ?, currentlocationstart = ? WHERE apptid= ? ";
$q = $conn->prepare($sql);
$q->execute(array($currentlocation,$currentlocationstart, $apptid));

?> 
```

和 checkout.php

```
<?php

date_default_timezone_set('America/Denver');

$apptid = $_REQUEST['buttonId'];
$currentlocationstart = date("Y-m-d H:i:s"); 

if(isset($_REQUEST['checkOut'])){
    $checkin = 1000;
}

$hostname = 'localhost';

$username = '*********';

$password = '********';

$conn = new PDO("mysql:host=$hostname;dbname=sv", $username, $password);

$sql = "UPDATE schedule SET currentlocation = ?, currentlocationstart = ? WHERE apptid= ? ";
$q = $conn->prepare($sql);
$q->execute(array($checkin,$currentlocationstart, $apptid));

?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T16:18:24.747

您指的是一种称为“心跳”的方法。我将在这里发布一个示例，但首先我想给你一些指示，因为正如你所说，你是一个新开发者:)。

1) 使用 JQuery，尽量避免使用类选择器。它是出了名的慢。尽可能使用 id 选择器，如果不可能，则使用缩小搜索范围的 nodename 选择器。浏览器使用 ID 作为 dom 元素的一种“索引”或“键”，因此它是最快的搜索。

2) 预载！即使您要使用类选择器，也不要这样做

```
 $('.locationSelect') 
```

一遍又一遍。如果您要多次引用同一个 DOM 元素，请执行以下操作：

```
 var locationSelect = $('.locationSelect'); //this creates a reference
    $(locationSelect).whatever() //this uses the reference 
```

通过这样做，您只需搜索 DOM 一次。对于较小的应用程序，这似乎没什么大不了的，但是随着您的应用程序变得越来越复杂，在 DOM 中搜索元素需要越来越多的时间。通过使用参考，您只需搜索一次。

3）（可选）我建议使用像 AngularJS（由 Google 编写）这样的 MVC 平台。MVC 或模型视图控制器允许您更新“模型”（基本上是 JavaScript 对象），“视图”（HTML）使用称为 UI 绑定的东西自动调整其值。这是从一开始就开发应用程序的好方法，但如果您已经深入了解简单的简式代码，那么它可能不适合您。我仍然会看看他们的教程，看看它可以为你提供什么： http: [//docs.angularjs.org/tutorial/](http://docs.angularjs.org/tutorial/)

现在回答你原来的问题！是的，这完全可以通过 jQuery 使用一种称为心跳的方法来实现。心跳允许您模拟服务器和客户端之间的数据持久性。心跳越频繁，您的客户端就越同步，但您的网络服务器上的负载也越大。这是一个平衡的行为。
简而言之，它的工作原理如下：

```
 setInterval(function(){
        $.ajax({
           url: 'heartbeatscript.php',
           method: 'post'
           //whatever data you want to send
        }).done(function(data){
           //do whatever with the returned result
        });
    },heartbeatInterval); //heartbeatInterval will be however many MS you want 
```

我还建议使用 JSON 在客户端和服务器之间进行通信。JSON 很容易在两端解析，在客户端它只是解析批量数据的最快机制。JSON 被直接解析为 JavaScript 对象，因为该符号实际上就是 JS 用来在浏览器中存储对象数据的方式。XML 也是一个不错的选择。两者都很容易上手：

客户端：您可以使用 jQuery 解析基本的 XML：

```
 $('nodeName',xml); 
```

您可以像这样将 JSON 解析为 JSO：

```
 var JSO = JSON.parse(JSONString); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T23:23:15.723

看看[Socket.IO](http://socket.io/)，因为正如网站所说：

> ## 什么是 Socket.IO？
> 
> Socket.IO 旨在使每个浏览器和移动设备中的实时应用程序成为可能

尽管 Socket.IO 是在 NodeJS/Javascript 中的，但是关于[将 PHP 与 Socket.IO 结合使用的讨论颇多](https://stackoverflow.com/questions/6398887/using-php-with-socket-io)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-10T00:58:09.183

Web 应用程序的基本原则之一是在客户端启动每个操作，即如果您想更改其中一台计算机上的显示，则必须有人单击*该计算机上的*某些内容。本来如果服务器出事的话，在第二台电脑上更新显示是没有可能的，现在也还没有解决办法。

然而，随着现代浏览器的发展，已经开发出[多种技术，并在 Web 邮件客户端和响应式“Web 2.0”应用程序中广泛使用。](http://en.wikipedia.org/wiki/Push_technology)您必须决定其中一个并自己实施，每个都有其优点和缺点。

最容易实现的一个（除了一个简单的“刷新”按钮）可能是每隔几秒执行一次 AJAX 请求，并根据服务器报告的当前用户状态更新屏幕。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-10T00:59:11.763

基本上，您要做的似乎是在另一台机器上更新来自一台机器的数据，而无需重新加载页面。

很高兴您已经对 AJAX 有所了解，因为这可能是您实现解决方案的方法之一。本质上，您需要的是以某个指定的时间间隔（可能每秒或每隔几秒，取决于您的需要）从网页轮询服务器。您可以使用 AJAX 执行此操作。

当您轮询此服务器时，您可以提取数据（HTML 片段、JSON 数据，以及在您的应用程序中有意义的任何内容）并使用这些数据来更新页面。因此，当用户在计算机 1 上进行更新时，计算机 2 将能够轮询服务器并拉入与计算机 1 上的数据更改相关的更新。

# c++ - 偶尔的分段错误

> ID：13318027
> 
> 赞同：1
> 
> 时间：2012-11-10T00:37:01.223
> 
> 标签：c++, nodes

一如既往地感谢您的时间和帮助！不知道这里发生了什么，但这可能是显而易见的，所以我想我会让其他人看看。

这是我的代码。现在 run 以字符串形式查找具有指定名称的节点的地址。然后返回这个节点对象的地址。有时它工作正常（大部分）但其他运行给我一个分段错误。谁能明白为什么？

```
class ManipulateArray
{
    public:
    Node* formArray();
    Node* findMemAddress(string);
    private:
    GetFileInfo g;
};

Node* ManipulateArray::formArray()
{
    Node *list = new Node[48];
    string null = "*";

    for(int i = 0; i<48; i++)
    {
        for(int j = 0; j<6; j++)
        {   
        string info = g.returnInfo(i,j);

            switch(j)
                {
            case 0:
            list[i].setNodeName(info);
            break;
            case 1:
            if(info.compare(null) == 0)
            {list[i].getAttachedNode(j) = 0;}
            break;
                }
        }
    }   

    return list;
}

Node* ManipulateArray::findMemAddress(string nodeName)
{
    Node* memoryAddress = 0;
    Node* temp;
    for(int i = 0; i<48; i++)
    {
        string name = temp[i].getNodeName();
        temp = formArray();

        if(name.compare(nodeName) == 0)
        {
            memoryAddress = &temp[i];
            break;
        }
    }
    return memoryAddress;
}

int main()
{
    ManipulateArray z;
    //Node *start;
    //Node *finish;

    Node* start;
    start = z.findMemAddress("F1");
    cout << start->getNodeName();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:56:26.367

函数中的“temp”`Node* ManipulateArray::findMemAddress(string nodeName)`尚未初始化。在函数中`int main()`，您应该在取消引用之前检查“开始”的值。希望它有效！

# java - 根据文本字段值修改 select 语句

> ID：13318030
> 
> 赞同：0
> 
> 时间：2012-11-10T00:37:06.770
> 
> 标签：java, mysql, database, jdbc, prepared-statement

我有四个文本字段`FirstName`，分别是`LastName`、`ID`、 和`department`。我让用户通过在文本字段中输入数据来搜索任何学生记录。当用户点击提交按钮时，我会显示一个与他请求的学生记录相对应的表格。因此，例如，如果用户输入`computerScience`文本`department`字段，我应该显示计算机科学系的所有学生。

因此，我的 SQL 选择语句应该能够在运行时执行此操作。

我正在使用这样的准备好的语句：

```
PreparedStatement pre = conn.prepareStatement("select ID,FirstName,LastName,Dept from student where ID = ? or FirstName = ? or lastName = ? or Dept = ?"); 
```

但是，这仅在输入 ID 时才显示结果。但是，假设有人只是输入“Mark”作为姓氏并将所有其他文本字段留空，那么此查询不会显示任何内容，尽管数据库中有姓氏为 Mark 的学生。

有人可以在这里指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T00:54:49.060

使用如下动态查询字符串（假设至少存在一个条件）

```
 String query = "select ID,FirstName,LastName,Dept from student where ";
   String delim = "";
   if(firstName != null){
      query+ = delim + "FirstName = '"+firstName+"'";
      delim = " AND ";
   }
   if(lastName != null){
      query+ = delim + "LastName = '"+lastName +"'";
      delim = " AND ";
   }
   .........
   .........
   PreparedStatement pre = conn.prepareStatement(query); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:28:25.440

您可以使用其他评论和答案中提到的动态方法。但在这种情况下，由于列本身不会在运行时添加，因此也可以使用另一种方法：将您的语句更改为：

```
PreparedStatement pre = conn.prepareStatement("select ID,FirstName,LastName,Dept from student where ID = IFNULL(?,ID) and FirstName = IFNULL(?,FirstName) AND lastName = IFNULL(?,lastName) and Dept = IFNULL(?,Dept)"); 
```

请注意所有更改为“and”而不是“or”的条件。要了解发生了什么：让我们在这里举个例子“Dept = IFNULL(?,Dept)”，如果您传递的值为 null（用户没有选择部门），那么 IFNULL(?,Dept) 的计算结果为 Dept db 中的当前行和整个条件 Dept = IFNULL(?,Dept) 将评估为真，因为 Dept 与自身相等。否则，如果您发送一个值，则 IFNULL(?,Dept) 将评估为该值，并且仅当其中的部门等于该值时才选择该行。其他部分也是如此，这就是使用“和”的原因。实际上，每个条件都确保如果有值，则该行必须具有相同的值才能返回。否则，条件不会阻塞行！

最后一点，您必须确保如果用户在该字段中未选择任何数据，则将 NULL 作为该字段的值传递给数据库（注意空格）。**并且如果字段 ID 是 numeric**，那么您需要将上面的部分更改为如下所示（并确保在用户选择 no id 的情况下发送 0 ）： ID = IFNULL(NULLIF(?,0) ，ID）

```
PreparedStatement pre = conn.prepareStatement("select ID,FirstName,LastName,Dept from student where ID = IFNULL(NULLIF(?,0),ID) and FirstName = IFNULL(?,FirstName) AND lastName = IFNULL(?,lastName) and Dept = IFNULL(?,Dept)"); 
```

# ipad - 如何避免在自定义容器（stackedViewcontroller）内的 UiNavigationcontroller 内调整 UITableView 的大小

> ID：13318031
> 
> 赞同：0
> 
> 时间：2012-11-10T00:37:19.533
> 
> 标签：ipad, uitableview, ios5, uinavigationcontroller, screen-orientation

```
MoveToNewLocViewContoller *move2NewLocVC = [[MoveToNewLocViewContoller alloc] initWithLocItemArray:moveToNewLocArray andSyLocIDArray:syLocIdArray];
        [move2NewLocVC setTitle:cell.textLabel.text];

        UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:move2NewLocVC];
        navController.view.width = PSIsIpad() ? self.view.width : 100;
        [navController.navigationBar setTintColor:BLUE];

        if (navController) {

            [XAppDelegate.menuInterfaceViewController.stackViewController pushViewController:navController fromViewController:nil animated:YES];
            [navController release];
            //[viewController release];
            [moveToNewLocArray release];
            [move2NewLocVC release];
        } 
```

现在我希望上面的导航控制器在我旋转 ipad 时不会调整大小。我试过 navController.view.autoresizesSubviews = NO;

这可行，但有一个问题，它不允许我的 UITableView(MoveToNewLocViewController) 滚动到底部。避免调整大小的主要目的是避免重绘我巨大的自定义 UITableViewcell 以适应方向。我知道我必须在定向后调整 UiTableview 的大小，但问题是在哪里。我试过

```
 -(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation duration:(NSTimeInterval)duration {}

-(void) didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {} 
```

它似乎不起作用。这是因为我将它插入到堆叠的容器视图中吗？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:14:41.997

我通过在 UIView 中包含 UITableView 来解决这个问题，然后将其作为 UIViewController 添加到 UiNavigationController。当设备旋转时，我在 didRotateFrominterfaceOrientation 方法中调整视图大小

```
-(void) didRotateFromInterfaceOrientation:  (UIInterfaceOrientation)fromInterfaceOrientation
  PSStackedViewController *stackController = XAppDelegate.menuInterfaceViewController.stackViewController;
if( [[UIDevice currentDevice] orientation] == UIInterfaceOrientationPortrait || [[UIDevice currentDevice] orientation] == UIInterfaceOrientationPortraitUpsideDown){
    [stackController setLargeLeftInset:50 animated:YES];
    self.navigationController.navigationBar.frame = CGRectMake(self.navigationController.navigationBar.frame.origin.x, self.navigationController.navigationBar.frame.origin.y, self.view.frame.size.width, self.navigationController.navigationBar.frame.size.height);
    self.move2NewLocTableView.height = self.view.height;
}
if( [[UIDevice currentDevice] orientation] == UIInterfaceOrientationLandscapeLeft || [[UIDevice currentDevice] orientation] == UIInterfaceOrientationLandscapeRight) {
    //self.navigationController.view.frame = self.tableView.frame;
    [stackController setLargeLeftInset:320 animated:YES];
    self.move2NewLocTableView.height = 700;
} 
```

# ruby - 使用 Ruby 将 DOC 转换为 TXT：错误后恢复循环

> ID：13318034
> 
> 赞同：1
> 
> 时间：2012-11-10T00:37:27.483
> 
> 标签：ruby

我有这个 Ruby 脚本可以将我的 Word 文档转换为 .txt 格式。它工作正常，可以相互转换多个文件，但有时会出现错误。我如何让脚本继续下一个文件，跳过给出错误的文件？请不要对使用其他技术提出任何建议，我对这个很满意。

```
require 'win32ole'

wdFormatDOSText = 4

word = WIN32OLE.new('Word.Application')
word.visible = false

begin
  ARGV.each do|file|
    myFile = word.documents.open(file)
    new_file = file.rpartition('.').first + ".txt"
    word.ActiveDocument.SaveAs new_file, wdFormatDOSText
    puts new_file
    word.activedocument.close(false) # no save dialog, just close it
  end
rescue WIN32OLERuntimeError => e
  puts e.message
  puts e.backtrace.inspect
  sleep 30
ensure
  word.quit
end
sleep 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:15:52.040

迭代集合时，您可以`begin...rescue...end`在每次迭代开始时启动一个新块并`next`在救援块内调用：

```
[ "puts 'hello'", "raise '!'" , "puts 'world'" ].each do |str|
  begin
    eval str
  rescue
    puts "caught an error, moving on"
    next
  end
end

# => hello
# => caught an error, moving on
# => world 
```

所以在你的情况下，它可能看起来像这样：

```
ARGV.each do |file|
  begin
    # ...
  rescue WIN32OLERuntimeError => e
    puts e.message
    next
  end
end 
```

# jquery - 使用 jquery.dotdotdot，当一个单词溢出时如何截断它？

> ID：13318038
> 
> 赞同：3
> 
> 时间：2012-11-10T00:38:30.697
> 
> 标签：jquery

下面的小提琴演示了这个问题：

[http://jsfiddle.net/inconduit/2z6Xa/](http://jsfiddle.net/inconduit/2z6Xa/)

这是使用 jquery.dotdotdot 插件来截断带有省略号的文本。

当有一个像 a_really_long_filename_with_no_spaces_at_all.txt 这样的单词溢出一个 div 时，这个插件不会截断它。有没有办法做到这一点？

的HTML：

```
 <div id="wrapper">this_does_not_truncate_because_there_are_no_spaces</div>
  <br><br>
  <div id="wrapper2">this one has spaces and is truncated properly</div> 
```

​ javascript:

```
 $("#wrapper").dotdotdot({wrap: 'letter'});
 $("#wrapper2").dotdotdot({wrap: 'letter'}); 
```

的CSS：

```
#wrapper {
    width: 100px;
    height: 20px;
    border: 1px solid red;
}
#wrapper2 {
    width: 100px;
    height: 20px;
    border: 1px solid red;
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T00:44:43.590

你真的需要一个插件来做到这一点吗？你试过使用 CSS`text-overflow:ellipsis`吗？*除了IE 5.5 或以下*或*FF 6 或以下*的真正旧浏览器之外，每个浏览器都支持它。

更多信息`text-overflow`：[https ://developer.mozilla.org/en-US/docs/CSS/text-overflow](https://developer.mozilla.org/en-US/docs/CSS/text-overflow)

演示页面：[http ://davidwalsh.name/demo/css-ellipsis.php](http://davidwalsh.name/demo/css-ellipsis.php)

# c - c - 多行输入

> ID：13318039
> 
> 赞同：0
> 
> 时间：2012-11-10T00:38:46.850
> 
> 标签：c, input, line

我实际上并没有很多代码可以在这里显示，但我似乎无法得到一个现实的答案：我如何接受用户的多行输入？

例如，我可能希望用户说...

```
 name: command
       command
       command 
       command

 name: command
       command 
       command 
```

（命令的数量未知。实际上这与行数有关。）我只是不知道从哪里开始，因为这件事上似乎没有很多资源）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T00:44:58.093

伪代码：

```
do {
    read a line and put it into String variable s
    Push s into an array
} while (s is not empty)
Remove the last element of the array 
```

由于我已经好几个月没有写 C 语言了，这就是我现在可以做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T00:49:53.623

```
enum { MAX_LINES = 100 };
char *lines[MAX_LINES];
int nlines;

char buffer[4096];

while (fgets(buffer, sizeof(buffer), fp) != 0 && nlines < MAX_LINES)
{
    if (buffer[0] == '\n')
        break;
    if ((lines[nlines++] = strdup(buffer)) == 0)
        ...memory allocation failed...
} 
```

命令的行在`lines[0]`... `lines[nlines-1]`如果您不喜欢对行数的硬连线限制，请​​动态分配`lines`指针数组（读者练习）。

# jquery - jQuery 脉动 div

> ID：13318050
> 
> 赞同：1
> 
> 时间：2012-11-10T00:40:49.663
> 
> 标签：jquery, html, css

有谁知道我做错了什么？

我试图点击“minus.png”，它会删除 DIV，但是如果你点击 div 文本，它会删除 div。

我不希望能够单击 div 并在脉动上将其删除，我希望能够单击减号 png 图像并将其删除，您会碰巧知道我做错了什么吗？

我敢肯定这是一个简单的修复，但它让我很烦恼哈哈！

谢谢！

```
<script>
  $(document).ready(function() {

      $(".pane").click(function () {
      $(this).effect("pulsate", { times:2 }, 0000).fadeOut('slow').parents(".pane");
});

  });
  </script>

  <div class="pane">
 <a href=""><img align="right" src="http://uploadir.com/u/6hmr4fr1" alt="delete" class="delete" /></a>  
  Simple jQuery script I'm learning to work with, you mad bro?
  </div>

  <div class="pane">
  <a href=""><img align="right" src="http://uploadir.com/u/6hmr4fr1" alt="delete" class="delete" /></a>  
  Simple jQuery script I'm learning to work with, you mad bro?
  </div>

  <div class="pane">
  <a href=""><img align="right" src="http://uploadir.com/u/6hmr4fr1" alt="delete" class="delete" /></a>  
 Simple jQuery script I'm learning to work with, you mad bro?
  </div>

  <div class="pane">
  <a href=""><img align="right" src="http://uploadir.com/u/6hmr4fr1" alt="delete" class="delete" /></a>  
  Simple jQuery script I'm learning to work with, you mad bro?
  </div> 
```

完整代码在这里：

[http://jsfiddle.net/CgPJv/](http://jsfiddle.net/CgPJv/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T00:48:07.237

**[代码示例](http://jsfiddle.net/CgPJv/11/)**

```
$('.pane a').click(function () {
    $(this).closest('.pane').effect('pulsate', { times:2 }, 0000).fadeOut('slow');
    return false;
}); 
```

您还应该给出`a`标签`href`值。保持空白是违反标准的。您可以使用`href="#"`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-10T00:47:02.833

您需要将点击事件附加到`img`元素，然后使用`closest()`冒泡找到它`.pane`并将其淡出，如下所示：

```
$(document).ready(function() {
      $(".pane img").click(function (e) {
         e.preventDefault();
         $(this).closest('.pane').effect("pulsate", { times:2 }, 0000).fadeOut('slow');
      });
}); 
```

查看工作[**演示**](http://jsfiddle.net/gnel/CgPJv/16/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-10T00:47:54.590

您可以将点击事件附加到实际图像，

```
$(".pane > a > img").on('click... 
```

或者您可以直接获取`alt`图像元素的属性 -

```
$(".pane img[alt='delete']").on('click... 
```

我总是喜欢尽可能详细地使用我的选择器，因为我发现它提高了可读性并使调试更快。

在这两种情况下，要获得您想要实际淡出的元素，您将使用该`closest()`函数。

```
$(".pane img[alt='delete']").on('click',function () {
  var paneElement = $(this).closest('.pane');
  paneElement.effect("pulsate", { times:2 }, 0000).fadeOut('slow');
  return false;
}); 
```

最后，我不太确定你想用`.parents(".pane")`. 它在命令的末尾，根本没有任何效果。你可以把它排除在外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-10T00:47:20.417

也许`$(".pane")`->`$(".pane > a")`

[http://jsfiddle.net/CgPJv/6/](http://jsfiddle.net/CgPJv/6/)

您正在绑定整个 div 上的点击，而不是像您说的那样将它们绑定在**a元素上**

```
$(".pane > a").click(function (event) {
    event.preventDefault();
    $(this).parent().effect("pulsate", { times:2 }).fadeOut('slow');
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-10T00:52:00.970

**[演示](http://jsfiddle.net/CgPJv/19/)**——一个简洁的小`slideUp()`动画与风格保持一致如何？

# javascript - If Else 语句中的 Google Script Long 函数

> ID：13318064
> 
> 赞同：0
> 
> 时间：2012-11-10T00:42:58.353
> 
> 标签：javascript, google-apps-script

所以我设法弄清楚如何控制 tableCell 中的样式：

```
AllCellA1.clear().insertParagraph(0,m2).setSpacingAfter(0).setSpacingBefore(0).setLineSpacing(1); 
```

但这涉及到我必须制作一个带有堆叠功能的非常大的桌子：

```
var ChangeAllCells = file.appendTable();
var AllRow1 = ChangeAllCells.appendTableRow();
var AllCellA1 = AllRow1.appendTableCell();
var AllCellB1 = AllRow1.appendTableCell();
var AllRow2 = ChangeAllCells.appendTableRow();
var AllCellA2 = AllRow2.appendTableCell();
var AllCellB2 = AllRow2.appendTableCell(); 
```

问题是我正在尝试运行 if else 语句，而该表无法正常工作！该脚本不在 if else 语句内运行（太长，语法不正确？），如果它在之前或之后，脚本在 if else 语句之外运行。

```
if(m1 == ""){
    file.insertParagraph(0, "END OF REPORT");
  }else if(m1 || ""){
    if(m10 || ""){
      file.insertParagraph(0, m1);
      ChangeAllCells;
    }else if(m9 || ""){
      file.insertParagraph(0, m1); 
      **ABOVE SCRIPT GOES HERE*;
    } 
```

有什么解决办法吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T00:44:53.263

`||`是 的符号`or`。说`else if(m1 || "")`的没有意义。你必须说类似`else if(m1 == "a" || m1 == "b")`

# javascript - 依赖驱动的自建JS库

> ID：13318065
> 
> 赞同：0
> 
> 时间：2012-11-10T00:42:59.490
> 
> 标签：javascript

（我希望问题标题是解释性的而不是误导性的..）

我想知道那里是否有一个 JavaScript 库/框架，它将解析和分析 Web 开发人员编写的 JS 代码，然后将该库的最小必要子集合成到一个 JS 文件中，用于与这个特定的 Web 应用程序一起部署.

# mysql - LEFT JOIN 不适用于空表

> ID：13318080
> 
> 赞同：0
> 
> 时间：2012-11-10T00:45:57.690
> 
> 标签：mysql, left-join

我在从以下查询中获取结果时遇到问题：

```
SELECT SQL_CALC_FOUND_ROWS App.ID, UserFeedback.Type FROM App 
LEFT JOIN UserFeedback ON App.ID = UserFeedback.App_ID 
```

它没有返回任何东西，我怀疑它与`UserFeedback`空虚有关。表中有一行，`Appointments`当我使用`SELECT * FROM Appointments`.

难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:06:41.953

查询是空的连接表很好，其他东西一定是错的

# python - Python - 不支持的类型：范围和范围

> ID：13318083
> 
> 赞同：10
> 
> 时间：2012-11-10T00:46:04.113
> 
> 标签：python, range, operand

我在尝试运行脚本时遇到了这个奇怪的错误，代码似乎是正确的，但似乎 python (3) 不喜欢这部分：

```
 def function(x):
                  if integer:
                    return int(x)
                else:
                    return x

            non_nil = randrange(21)
            d = dict([(randrange(101), Racional(coeff(randrange(-20,20)),
                                    coeff(choice(range(-30,0)+\
                                                 range(1,30)))))
                     for k in range(non_nil)]) 
```

我收到以下错误：

```
for k in range(non_nil)]) unsupported operand type(s) for +: 'range' and 'range' 
```

我已经尝试将最后四行放在一个中，但 python 返回相同的错误。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-10T00:49:56.480

这是因为 Python 3`range`不返回 a `list`，这与 Python 2 不同。这段代码是为 Python 2 编写的。

应更改此代码：

```
range(-30,0) + range(1,30) 
```

应改为：

```
[*range(-30,0), *range(1,30)] 
```

在 Python 3.5（2015，[PEP 448 - Additional Unpacking Generalizations](https://www.python.org/dev/peps/pep-0448/)）之前，您不能使用`*`内部列表，而必须以这种方式编写（或者您可能更喜欢这样）：

```
list(range(-30,0)) + list(range(1,30)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T03:32:36.567

正如其他人指出的那样，问题是在 Python 3 中，`range()`返回一个迭代器而不是像 Python 2 中那样返回一个列表。

这是一种解决方法：添加类似以下函数的内容：

```
def non_zero_range(lower, upper):
    ret = list(range(lower, upper))
    ret.remove(0)
    return ret 
```

然后将第二个`Racional()`调用参数从：

```
coeff(choice(range(-30,0)+range(1,30))) 
```

简单地说：

```
coeff(choice(non_zero_range(-30,30))) 
```

您将拥有在 Python 2 和 3 中都可以使用的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T00:50:05.680

在你的表情中间你做`range(-30,0) + range(1,30)`。这是导致错误的原因，因为在 Python 3 中`range()`返回一个迭代器，而不是像 Python 2.x 中的列表。

使其工作的一种方法是在添加之前将每个范围转换为列表：

```
d = dict([(randrange(101), Racional(coeff(randrange(-20,20)),
                                coeff(choice(list(range(-30,0))+
                                             list(range(1,30))))))
         for k in range(non_nil)]) 
```

由于您似乎只想`0`从 中排除，因此`range(-30, 30)`您也可以使用`filter(None, range(-30, 30))`.

或者，您可以使用`choice((1, -1)) * choice(range(1, 30))`，这相当于`choice(list(range(-30, 0)) + list(range(1, 30)))`. （**编辑**：实际上，先前的表达式不会在可能性中包含-30，不确定这是否是一个问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-10T00:55:29.920

正如其他答案所说，`range()`作为一个迭代器是你的问题，但是，一个更简单的（在我看来）解决方案是生成列表 from `-30`to`30`然后 remove `0`，而不是避免它：

```
choice([i for i in range(-30, 30) if i != 0]) 
```

自然，如果您的范围更加不同，这可能会变得笨拙。

# sql - 如何在 SQL 中进行多对 2 约束？

> ID：13318089
> 
> 赞同：0
> 
> 时间：2012-11-10T00:46:53.987
> 
> 标签：sql, database

我需要使用 SQL 查询创建两个表，第一个表称为员工，第二个表称为部门。

如何创建表以强制从员工到部门的约束“多到 2”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T04:49:44.197

多对多，如一对多和多对一可以通过多种方式建模 -*规范*的方式是通过映射表：

**员工**

```
EmployeeID | Other | Employee | Fields 
```

**部门**

```
DepartmentID | Other | Department | Fields 
```

**员工部**

```
EmployeeID | DepartmentID 
```

# android - 如何在不关闭锁屏的情况下在锁屏顶部显示活动？

> ID：13318090
> 
> 赞同：1
> 
> 时间：2012-11-10T00:46:58.370
> 
> 标签：android

我正在尝试将我的活动置于 android 的锁定屏幕之上。我的活动不是全屏活动。活动布局就像一个警报，但它是一个活动。使用`FLAG_SHOW_WHEN_LOCKED`，我可以将我的活动置于锁定屏幕之上。唯一的问题是每次启动我的活动时，它都会关闭锁定屏幕，即使它是安全锁定屏幕并且我没有使用`FLAG_DISMISS_KEYGUARD`. 在我的活动完成之前，我会看到设备的主屏幕。一旦我的活动完成，锁定屏幕就会重新成为焦点。有什么方法可以在不关闭锁定屏幕的情况下显示我的活动？

# api - 使用 Applescript 和 cURL 控制飞利浦 Hue 照明系统

> ID：13318093
> 
> 赞同：4
> 
> 时间：2012-11-10T00:47:06.407
> 
> 标签：api, applescript, philips-hue

我看到可以使用以下命令控制飞利浦 Hue 灯：

向（此处为您的 Hue 网站）发出以下 HTTP POST 请求

{"username": "YourAppName", "devicetype": "YourAppName"} 如果您没有按下 Hue Hub 上的按钮，您将收到这样的错误；

{"error":{"type":101,"address":"/","description":"链接按钮未按下"}} 按下集线器上的链接按钮再试一次应该会收到；

{"success":{"username":"key"}} 上面的 key 将是一个 md5 字符串，记住这一点，在以后的所有请求中都需要它

--但我不知道如何使用 Applescript 说那种语言 -- 我知道你可以使用“做 shell 脚本”，也可能在那里使用 cURL，但是，我在实际让代码工作时分崩离析正确。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:22:18.397

对于 shell 脚本，试试这个：

```
curl -d "{\"username\": \"yourname\", \"devicetype\": \"yourhuename\"}" [not a link]http://hueIpAddr/api 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-22T21:26:32.770

我能够让我的python脚本使用curl请求来控制灯光`subprocess`（我认为类似于do shell脚本），使用：

```
curl --request PUT --data \'{"on":true, "xy":[0.4370,0.3706],"bri":255}\' http://{url}/api/{username}/lights/1/state 
```

要使用 curl 创建用户，您可能应该将代码更改为如下所示：

```
curl --request POST --data \'{"devicetype":"your_devicetype", "username":"your_username"}\' http://{url}/api/ 
```

公平地说，我没有用 curl 尝试过，因为我正在努力在 python 中迁移到 urllib2。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T02:10:08.567

另一个 shell 脚本，具有通过 HSB 和转换时间设置颜色的有用功能。

```
#!/bin/sh
#
# Register "patniemeyer" key with this bridge
#
# % curl -d '{"username": "patniemeyer", "devicetype": "Philips hue"}' http://192.168.1.179/api
# [{"success":{"username":"patniemeyer"}}]
#

KEY='patniemeyer'
IP='192.168.1.179'

#
# Light number, hue, saturation, brightness, transition time
#
# hue 0-65535
# sat 0-255?
# transition time 1/10 seconds
#
lightNHSBT() 
{
    _lightNum=$1
    _hue=$2
    _sat=$3
    _brightness=$4
    _ttime=$5
    curl --request PUT --data "{\"hue\":$_hue, \"sat\":$_sat, \"bri\":$_brightness, \"on\":true, \"transitiontime\":$_ttime}" http://$IP/api/$KEY/lights/$_lightNum/state/
}

#
# CIE 1931 X,Y colors
# Light number, X, Y, brightness, transition time
#
# transition time 1/10 seconds
#
lightNXYBT() 
{
    _lightNum=$1
    _x=$2
    _y=$3
    _brightness=$4
    _ttime=$5
    curl --request PUT --data "{\"xy\":[$_x,$_y], \"bri\":$_brightness, \"on\":true, \"transitiontime\":$_ttime}" http://$IP/api/$KEY/lights/$_lightNum/state/
}

# 
for f in 1 2 3 4 5 6 
do
    lightNHSBT $f 0 255 255 5  # full red
done 
```

# r - R中的匹配函数arg

> ID：13318096
> 
> 赞同：5
> 
> 时间：2012-11-10T00:47:21.150
> 
> 标签：r, function, arguments

我在 R 中有一个函数可以采用一些默认值或自定义用户函数：

```
myfun = function(x = c('funA', 'funB', 'funC'), customFUN = NULL)
{
} 
```

如果用户为 x 选择任何默认列出的值，customFUN 将被忽略。在 R 中处理这个问题的最佳方法是什么？

我可以使用

```
myfun = function(x = c('funA', 'funB', 'funC'), customFUN = NULL)
{

  if (! is.null(customFUN)) {
    choosenFUN = match.fun(customFUN)
  }
  else {
    choosenFUN.string = match.arg(x)

    if (choosenFUN == 'funA')
       choosenFUN = algorithmA
    else if (choosenFUN == 'funB')
       choosenFUN = algorithmB
    #...and so on for the other defaults
  }

} 
```

但是添加额外的 arg customFUN 似乎很奇怪，也许有一个聪明的方法可以做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:43:42.670

我想我明白了，感谢评论：

```
myfun = function(x = c('funA', 'funB', 'funC'))
{
  if (is.function(x))
    func = x
  else                  
    func.string = switch(match.arg(x), funA = 'UseA', funB = 'UseB', funC = 'Usec')

  if (func.string == 'UseA') 
    func = algorithmA
  else if (func.string == 'UseB')
    func = algorithmB
  # and so on

  func
} 
```

# visual-studio-2012 - 如何使用 Visual Studio 2012 在 Microsoft Surface 平板电脑上部署应用程序？

> ID：13318098
> 
> 赞同：13
> 
> 时间：2012-11-10T00:47:46.950
> 
> 标签：visual-studio-2012, windows-phone, windows-rt

Microsoft Surface 使用与 Windows Phone 相同的 ARM7。我认为使用 Windows Phone 8 SDK 和 Visual Studio 2012 我可以将应用程序部署到平板电脑。当我为 Windows Phone 开发应用程序时，可以直接在开发中心注册手机，并且使用 Visual Studio 或应用程序部署工具可以轻松推送应用程序。

我使用 Xcode 进行 iOS 开发，我可以将目标设备设置为 iPad 或 iPhone。我错过了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-10T01:00:34.253

为此需要执行几个步骤。Visual Studio 允许您将应用程序远程推送到设备（前提是 PC 和 Surface 都连接到同一网络）。

基本上你去[这里](http://www.microsoft.com/visualstudio/eng/downloads#remote-tools)下载 Visual Studio 2012 的远程工具（靠近页面底部）到你的 Surface（记得下载 ARM 版本）。

然后，您可以在 Surface 上启动此程序。

然后在 Visual Studio 中，您可以单击运行按钮旁边的小下拉箭头并选择“远程设备”。如果您的开发机器和 Surface 在同一个网络上，它应该会自动检测到它（但您可能需要输入 Surface 的 IP 地址）。

首次将应用程序部署到设备上时，Surface 会提示您获取开发人员证书，一旦发生，它应该可以正常工作。

[本指南](http://blogs.msdn.com/b/jasonz/archive/2012/06/12/what-you-need-to-know-about-developing-for-windows-on-arm-woa.aspx)解释得比我好得多，应该为您提供所需的所有信息。

祝你好运！

# node.js - Node.js HTTPS 服务器 ERR_EMPTY_RESPONSE

> ID：13318101
> 
> 赞同：12
> 
> 时间：2012-11-10T00:48:11.327
> 
> 标签：node.js, ssl, https, ssl-certificate

我使用创建了 server.key 和 server.csr 文件`openssl req -nodes -newkey rsa:2048 -keyout server.key -out server.csr`。我使用startssl.com 创建了一个SSL 证书，它给了我一个证书文件。然后在我的 node.js 应用程序中，我读取了密钥和证书文件：

```
var app = module.exports = express.createServer({
  key: fs.readFileSync('server.key'),
  cert: fs.readFileSync('server.cert')
}); 
```

但是，现在我从我的应用程序中得到一个空响应，一条“未收到数据”消息。这可能是什么原因造成的？我对 SSL 以及它是如何工作的非常陌生，因此非常感谢任何帮助。

更多信息：我在我的 VPS 服务器（生产服务器）上生成了两个文件，key 和 csr 文件，现在我正试图让它们在我的本地主机上工作（首先，在我将代码提交到生产环境之前；我有在进行 git 提交之前测试它是否有效）。因此，这可能是因为我的本地主机（开发环境）与我的 VPS 服务器（生产环境）位于不同的域中。会是这样吗？如果是这样，我怎样才能使本地主机和生产环境使用相同的证书？

或者，您会建议我为我的开发环境创建另一个证书吗？我看到的唯一问题是我的开发环境没有域，因为它是在本地完成的。为了简单起见，我宁愿使用相同的证书（即使这意味着 localhost 上的锁图标损坏或其他东西）。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2016-04-25T23:06:23.907

我知道这是一个老问题，但我今天遇到了同样的事情。我会从 express (ERR_EMPTY_RESPONSE) 得到相同的结果。

修复？请务必在您的测试浏览器中指定`https`，而不是`http`（例如，`https://localhost:8443`）。

如果您之前使用中间件将所有 http 请求转发到 https，您之前不会遇到此问题。此外，预计您的浏览器会抱怨证书，但无论如何都要继续（在 chrome 中这需要点击几下）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-10T01:19:01.577

您可以通过使用 连接到您的应用程序来解决错误`curl --insecure --verbose`。通常，您不应在多个主机上使用 SSL 证书。您可以制作一个自签名的在本地测试并在生产中使用startssl。但无论如何，证书中的 CN 需要与用于连接站点的主机名匹配，以避免烦人的浏览器警告。您可以随时为您的机器创建一个域名`sam.local`，并将其放入您的 /etc/hosts 文件中，并在您的自签名证书以及浏览器地址栏中使用它。

# c# - 在 .net 4.5 中尝试使用 HttpClient 使 cookie 无法响应

> ID：13318102
> 
> 赞同：124
> 
> 时间：2012-11-10T00:48:17.323
> 
> 标签：c#, async-await, dotnet-httpclient

我有以下代码可以成功运行。我不知道如何从响应中获取 cookie。我的目标是我希望能够在请求中设置 cookie 并从响应中获取 cookie。想法？

```
private async Task<string> Login(string username, string password)
{
    try
    {
        string url = "http://app.agelessemail.com/account/login/";
        Uri address = new Uri(url);
        var postData = new List<KeyValuePair<string, string>>
        {
            new KeyValuePair<string, string>("username", username),
            new KeyValuePair<string, string>("password ", password)
        };

        HttpContent content = new FormUrlEncodedContent(postData);
        var cookieJar = new CookieContainer();
        var handler = new HttpClientHandler
        {
            CookieContainer = cookieJar,
            UseCookies = true,
            UseDefaultCredentials = false
        };

        var client = new HttpClient(handler)
        {
            BaseAddress = address
        };

        HttpResponseMessage response = await client.PostAsync(url,content);
        response.EnsureSuccessStatusCode();
        string body = await response.Content.ReadAsStringAsync();
        return body;
    }
    catch (Exception e)
    {
        return e.ToString();
    }
} 
```

这是完整的答案：

```
HttpResponseMessage response = await client.PostAsync(url,content);
response.EnsureSuccessStatusCode();

Uri uri = new Uri(UrlBase);
var responseCookies = cookieJar.GetCookies(uri);
foreach (Cookie cookie in responseCookies)
{
    string cookieName = cookie.Name;
    string cookieValue = cookie.Value;
} 
```

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2012-11-10T01:05:19.727

要将 cookie 添加到请求，请在请求之前使用 填充 cookie 容器`CookieContainer.Add(uri, cookie)`。发出请求后，cookie 容器将自动填充来自响应的所有 cookie。然后，您可以调用 GetCookies() 来检索它们。

```
CookieContainer cookies = new CookieContainer();
HttpClientHandler handler = new HttpClientHandler();
handler.CookieContainer = cookies;

HttpClient client = new HttpClient(handler);
HttpResponseMessage response = client.GetAsync("http://google.com").Result;

Uri uri = new Uri("http://google.com");
IEnumerable<Cookie> responseCookies = cookies.GetCookies(uri).Cast<Cookie>();
foreach (Cookie cookie in responseCookies)
    Console.WriteLine(cookie.Name + ": " + cookie.Value);

Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2019-11-20T06:16:54.540

如果您无法访问`HttpClient`并且无法注入`CookieContainer`. 这适用于 .NET Core 2.2：

```
private string GetCookie(HttpResponseMessage message)
{
    message.Headers.TryGetValues("Set-Cookie", out var setCookie);
    var setCookieString = setCookie.Single();
    var cookieTokens = setCookieString.Split(';');
    var firstCookie = cookieTokens.FirstOrDefault();
    var keyValueTokens = firstCookie.Split('=');
    var valueString = keyValueTokens[1];
    var cookieValue = HttpUtility.UrlDecode(valueString);
    return cookieValue;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-08-10T12:55:49.733

您可以使用给定的 URL 轻松获取 cookie 值。

```
private async Task<string> GetCookieValue(string url, string cookieName)
{
    var cookieContainer = new CookieContainer();
    var uri = new Uri(url);
    using (var httpClientHandler = new HttpClientHandler
    {
        CookieContainer = cookieContainer
    })
    {
        using (var httpClient = new HttpClient(httpClientHandler))
        {
            await httpClient.GetAsync(uri);
            var cookie = cookieContainer.GetCookies(uri).Cast<Cookie>().FirstOrDefault(x => x.Name == cookieName);
            return cookie?.Value;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-13T09:29:41.700

并非在所有情况下都可以添加`httpClientHandler`到`httpClient`. 例如，当您使用集成测试`testServer.CreateClient()`或`httpClient`从`IHttpClientFactory`. 所以，我只是从标题中读取值。

```
 public static List<Cookie> GetCookies(this HttpResponseMessage message)
    {
        message.Headers.TryGetValues("Set-Cookie", out var cookiesHeader);
        var cookies = cookiesHeader.Select(cookieString => CreateCookie(cookieString)).ToList();
        return cookies;
    }

    private static Cookie CreateCookie(string cookieString)
    {
        var properties = cookieString.Split(';', StringSplitOptions.TrimEntries);
        var name = properties[0].Split("=")[0];
        var value = properties[0].Split("=")[1];
        var path = properties[2].Replace("path=", "");
        var cookie = new Cookie(name, value, path)
        {
            Secure = properties.Contains("secure"),
            HttpOnly = properties.Contains("httponly"),
            Expires = DateTime.Parse(properties[1].Replace("expires=", ""))
        };
        return cookie;
    } 
```

`CreateCookie`可以修改方法以完全匹配您的 cookie 属性。

# r - 递归反转线性系统 - 得到巨大的错误（精度）

> ID：13318105
> 
> 赞同：0
> 
> 时间：2012-11-10T00:49:23.500
> 
> 标签：r, optimization, linear-algebra, precision, numerical-methods

我有一个 Ax =b 型线性系统 - 其中 A 是上三角矩阵。A的结构定义如下：

```
 comp.Amat <- function(i,j,prob) ifelse(i > j, 0, dbinom(x=i, size=j, prob=prob))

    prob <- 1/4
    A <- outer(1:50, 1:50 , FUN=function(r,c) comp.Amat(r,c,prob) ) 
```

A 中的条目是二项式概率 - 问题是当 A 的大小增长时，对角线条目迅速接近 0。

如果我们也将向量 b 定义如下：

```
 b <- seq(1,50,1); 
```

然后 solve(a=A,b=b) - 给出一个错误：

```
 "  system is computationally singular: reciprocal condition number = 1.07584e-64" 
```

这是有道理的，因为对角线项几乎是 0，所以矩阵变得不可逆。

作为一种变通方法，我编写了以下递归函数 - 它开始计算最后一个对角线条目的值，然后替换前一行中的该值。由于矩阵中的每个条目都是**dbinom(j,i, prob)** for j=>i ：我可以通过这种方式获得解决方案。

```
 solve.for.x.custom <- function(A, b, prob)
    {

      n =length(A[1,])
      m =length(A[,1])

      x = seq(1,n, 1);
      x[x> 0] = -1000;

      calc.inv.Aii <- function(i,j, prob)
      {
        res = (1 / (prob*(1-prob)))^i;
        return(res);

      }

      for (i in m:1 )
      {

        if(i ==m)
        {
  rhs =0;

        }else
        {
          rhs=0;
          for(j in m:(i+1))
          {
            rhs =  dbinom(x=i,size=j,prob=prob)*x[j] + rhs;
          }

        }

        x[i] = (b[i] - rhs)*calc.inv.Aii(i,i);

      }
      print(x)
      return(x)

    } 
```

我的问题是 - 当我将此解决方案*x'*乘以矩阵 A 时，误差 (Ax'- b) 是巨大的。由于我有一个分析解决方案（x_i 中的每个条目都可以描述为二项式概率乘以先前的值） - 我应该得到的错误是每行中的 0-。

由于这些问题，我看到 (1 / (1/a)) 可能不等于 a。但是，当前的错误确实很大（-1.13817489781529e+168）。

```
 x_prime=solve.for.x.custom(A, b, prob)
    A%*%x_prime - b
    #output
                    [,1]
     [1,] -1.13817489781529e+168
     [2,]  2.11872209742428e+167
     [3,] -1.58403954589004e+166
     [4,]  6.52328959209082e+164
     [5,] -1.69562573261261e+163
     [6,]  3.00614551450976e+161
    ***
    [49,]  -7.58010305220250e+08
    [50,]   9.65162608741321e+03 
```

我真的很感激你推荐任何建议或有效的方法。我将 A 和 b 的大小设为 50 - 但我也打算增大它们，因此在这种情况下，错误也会增加。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:07:21.860

如果您的矩阵`A`是上三角矩阵，您可能想要使用`backsolve(A, b)`而不是`solve(A, b)`.

* * *

您可以在 R 中使用 进行任意精度[`Rmpfr`](http://cran.r-project.org/web/packages/Rmpfr/)，这需要编写兼容版本的`backsolve`. 使用break下面的代码，我们可以得到

```
> print(max(abs(b - .b)), digits=5)
1 'mpfr' number of precision  1024   bits 
[1] 2.9686e-267 
```

但是有一个重要的警告：in 中的值`A`可能不够准确，因为它们来自`dbinom`而不是使用`mpfr`对象。根据您的最终目标，您可能需要编写自己的`dbinom`using版本`Rmpfr`。

* * *

```
library(Rmpfr)

logcomp.Amat <- function(i,j,prob) ifelse(i > j, -Inf, dbinom(x=i, size=j, prob=prob, log=TRUE))

nbits <- 1024

.backsolve <- function(A, b) {

    n <- length(b)
    x <- mpfr(numeric(n), nbits)

    for(i in rev(seq_len(n))) {

        known <- i + seq_len(n - i)
        z <- if(length(known) > 0) sum(A[i,known] * x[known]) else 0

        x[i] <- (b[i] - z) / A[i,i]
    }

    return(x)
}

logA <- outer(1:50, 1:50, logcomp.Amat, prob=1/4)
b <- 1:50

A <- exp(mpfr(logA, nbits))
b <- mpfr(b, nbits)

x <- .backsolve(A, b)

.b <- as.vector(A %*% x) 
```

# c - libetpan 和 Gmail SMTP（现在使用 SASL）

> ID：13318106
> 
> 赞同：0
> 
> 时间：2012-11-10T00:49:32.250
> 
> 标签：c, visual-studio-2010, email, smtp, sasl

我正在尝试使用 libetpan 库和下面的代码通过 Google 服务器发送电子邮件。但是，当我运行 mailsmtp_auth 时，它返回 16 (MAILSMTP_ERROR_AUTH_NOT_SUPPORTED)。任何想法为什么？我使用同一个库让 IMAP 运行良好，但由于某种原因，我无法使用 SMTP。我在网上找到了很多示例，但似乎没有一个适用于 Gmail。

```
int ret;
mailsmtp *smtp = NULL;
mailstream_low * low;
int fd;
mailstream_low * new_low;
char smtp_server[100] = "smtp.gmail.com";
char smtp_user[100] = "user";
char smtp_pass[100] = "password";
char smtp_email[100] = "user@gmail.com";
char body[100] = "Test email";

if ( (smtp = mailsmtp_new(0,NULL)) == NULL ){
    return FALSE;
}
if ( (ret = mailsmtp_socket_connect(smtp, smtp_server, 587) != MAILSMTP_NO_ERROR ) ){
    fprintf(stderr, "mail_socket_connect: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
ret = mailesmtp_ehlo(smtp);
if (ret != MAIL_NO_ERROR) {
    fprintf(stderr, "mailsmtp_helo: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
ret = mailesmtp_starttls(smtp);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_starttls: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
// THIS IS WHERE THE ERROR OCCURS
ret = mailsmtp_auth(smtp, smtp_user, smtp_pass);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_auth: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
ret = mailsmtp_mail(smtp, smtp_email);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_mail: %s\n",mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
    ret = mailsmtp_rcpt(smtp, smtp_email);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_rcpt: %s\n",mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
} 
ret = mailsmtp_data(smtp);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_data: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
ret = mailsmtp_data_message(smtp, body, strlen(body));
if (ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_data_meassage: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}
return TRUE; 
```

**--------------------------------------**

**[编辑#1]：SASL**

**--------------------------------------**

我已经设法通过编辑 libetpan 的源代码并在其代码库中修复 Win32 的一些问题来完成这项工作（一旦我得到 100% 的工作，我将发布结果）。但是，Gmail 似乎需要 SASL。在 Windows (Visual Studio 2010) 中编译时，没有关于在 libetpan 中包含 SASL 支持的文档，而且我在查找任何特定于 Windows 的在线信息时遇到了很多麻烦。

获得 SASL 的最简单方法是什么？是否有我可以使用标准 sasl.h 文件的预编译/预构建 windows SASL .lib 文件？

谢谢，本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:07:03.050

尝试`mailsmtp_init`先调用，然后再调用`mailesmtp_ehlo`，`mailesmtp_starttls`如下所示：

```
if ( (ret = mailsmtp_ssl_connect(smtp, smtp_server, 587 ) != MAILSMTP_NO_ERROR ) ){
    fprintf(stderr, "mail_ssl_connect: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}

ret = mailsmtp_init(smtp );
if (ret != MAILSMTP_NO_ERROR) {
    fprintf(stderr, "mailsmtp_init: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}

ret = mailesmtp_starttls(smtp);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_starttls: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}

ret = mailesmtp_ehlo(smtp);
if (ret != MAIL_NO_ERROR) {
    fprintf(stderr, "mailsmtp_helo: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}

ret = mailsmtp_auth(smtp, smtp_user, smtp_pass);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_auth: %s\n", mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
}

ret = mailsmtp_mail(smtp, smtp_email);
if ( ret != MAIL_NO_ERROR ) {
    fprintf(stderr, "mailsmtp_mail: %s\n",mailsmtp_strerror(ret) );
    mailsmtp_free(smtp);
    return FALSE;
} 
```

# python - 带有列表推导的 Python 内存管理

> ID：13318107
> 
> 赞同：0
> 
> 时间：2012-11-10T00:49:34.413
> 
> 标签：python, memory

我正在尝试对通过从磁盘读取文件创建的大型字典进行一些分析。读取操作会导致稳定的内存占用。然后，我有一个方法可以根据我从该字典复制到临时字典中的数据执行一些计算。我这样做是为了让所有的复制和数据使用都在方法范围内，并且我希望在方法调用结束时消失。

可悲的是，我做错了什么。customerdict 定义如下（定义在 .py 变量的顶部）：

```
customerdict = collections.defaultdict(dict) 
```

对象的格式是 {customerid: dictionary{id: 0||1}}

还有一个类似定义的字典，称为 allids。

我有一种计算 sim_pearson 距离的方法（来自 Programming Collective Intelligence 书的修改代码），如下所示。

```
def sim_pearson(custID1, custID2):
si = []

smallcustdict = {}
smallcustdict[custID1] = customerdict[custID1]
smallcustdict[custID2] = customerdict[custID2]

#a loop to round out the remaining allids object to fill in 0 values
for customerID, catalog in smallcustdict.iteritems():
    for id in allids:
        if id not in catalog:
            smallcustdict[customerID][asin] = 0.0

#get the list of mutually rated items
for id in smallcustdict[custID1]:
    if id in smallcustdict[custID2]:
        si.append(id) # = 1

#return 0 if there are no matches
if len(si) == 0: return 0

#add up all the preferences
sum1 = sum([smallcustdict[custID1][id] for id in si])
sum2 = sum([smallcustdict[custID2][id] for id in si])

#sum up the squares
sum1sq = sum([pow(smallcustdict[custID1][id],2) for id in si])
sum2sq = sum([pow(smallcustdict[custID2][id],2) for id in si])

#sum up the products
psum = sum([smallcustdict[custID1][id] * smallcustdict[custID2][id] for id in si])

#calc Pearson score
num = psum - (sum1*sum2/len(si))
den = sqrt((sum1sq - pow(sum1,2)/len(si)) * (sum2sq - pow(sum2,2)/len(si)))

del smallcustdict
del si
del sum1
del sum2
del sum1sq
del sum2sq
del psum

if den == 0:
    return 0

return num/den 
```

通过 sim_pearson 方法的每个循环都会无限地增加 python.exe 的内存占用。我尝试使用“del”方法显式删除局部范围变量。

查看任务管理器，内存以 6-10Mb 的增量增加。设置初始 customerdict 后，占用空间为 137Mb。

有什么想法为什么我这样做内存不足？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:07:57.047

我想问题在这里：

```
smallcustdict[custID1] = customerdict[custID1]
smallcustdict[custID2] = customerdict[custID2]

#a loop to round out the remaining allids object to fill in 0 values
for customerID, catalog in smallcustdict.iteritems():
    for id in allids:
        if id not in catalog:
            smallcustdict[customerID][asin] = 0.0 
```

来自的字典`customerdict`被引用`smallcustdict`- 所以当你添加它们时，它们会持续存在。这是我能看到的唯一一点，你在哪里做任何会持续超出范围的事情，所以我想这就是问题所在。

请注意，通过不使用列表组合，重复做同样的事情，并且不使用通用的方式来做事情，您在许多地方为自己做了很多工作，更好的版本可能如下：

```
import collections
import functools
import operator

customerdict = collections.defaultdict(dict)

def sim_pearson(custID1, custID2):

    #Declaring as a dict literal is nicer.
    smallcustdict = {
        custID1: customerdict[custID1],
        custID2: customerdict[custID2],
    }

    # Unchanged, as I'm not sure what the intent is here.
    for customerID, catalog in smallcustdict.iteritems():
        for id in allids:
            if id not in catalog:
                smallcustdict[customerID][asin] = 0.0

    #dict views are set-like, so the easier way to do what you want is the intersection of the two.
    si = smallcustdict[custID1].viewkeys() & smallcustdict[custID2].viewkeys()

    #if not is a cleaner way of checking for no values.
    if not si:
        return 0

    #Made more generic to avoid repetition and wastefully looping repeatedly.
    parts = [list(part) for part in zip(*((value[id] for value in smallcustdict.values()) for id in si))]

    sums = [sum(part) for part in parts]
    sumsqs = [sum(pow(i, 2) for i in part) for part in parts]
    psum = sum(functools.reduce(operator.mul, part) for part in zip(*parts))

    sum1, sum2 = sums
    sum1sq, sum2sq = sumsqs

    #Unchanged.
    num = psum - (sum1*sum2/len(si))
    den = sqrt((sum1sq - pow(sum1,2)/len(si)) * (sum2sq - pow(sum2,2)/len(si)))

    #Again using if not.
    if not den:
        return 0
    else:
        return num/den 
```

请注意，这完全未经测试，因为您提供的代码不是一个完整的示例。但是，它应该很容易用作改进的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T03:06:33.907

尝试更改以下两行：

```
smallcustdict[custID1] = customerdict[custID1]
smallcustdict[custID2] = customerdict[custID2] 
```

到

```
smallcustdict[custID1] = customerdict[custID1].copy()
smallcustdict[custID2] = customerdict[custID2].copy() 
```

这样，`customerdict`当`sim_pearson()`函数返回时，您对两个字典所做的更改不会持续存在。

# javascript - Chrome 堆快照 - 为什么它不显示所有分配的内存？

> ID：13318109
> 
> 赞同：21
> 
> 时间：2012-11-10T00:49:51.830
> 
> 标签：javascript, google-chrome, webgl, google-chrome-devtools

我正在我拥有的 WebGL 项目中运行一些内存使用测试。如果我在 Google Chrome 上启动页面并在 Developers Tool 的 Profiles 选项卡上拍摄堆快照，它会说我的页面拥有 7.5 MB。

问题是，如果我查看任务管理器，它使用的实际值几乎是 1 GB！这是意料之中的，因为我真的强迫页面有数千个对象，但问题是：为什么 Chrome 向我显示我只使用了 7.5 MB？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-10T06:41:36.820

**更新**

有本机内存快照，可以向您显示本机内存图。不幸的是，我们删除了它，因为它是一段脆弱的代码。它需要数百个类中的重要仪器，并影响二进制大小。我希望我们以后重新实现它。

**曾是**

它拍摄了 Javascript 堆的快照。您所有的 javascript 对象都使用 7.5mb。此大小不包括图像、画布、音频文件、插件数据等。

DevTools 中有一个本机内存快照。它计算渲染器进程使用的非 JavaScript 内存，但这是一个实验性功能。

您需要在 中启用 DevTools 实验功能`chrome://flags`，重新启动浏览器，在 DevTools 设置面板中启用 Native Memory Profiler 实验功能，然后重新打开 DevTools。

完成所有这些步骤后，您将能够在 Profiler 面板中获取 Native Memory Snapshot。并非本机内存堆中的所有内存块都被计算在内，但我们正在努力解决这个问题。

请使用[Chrome 的 Canary 版本](https://tools.google.com/dlpage/chromesxs)。它每天都会更新，并且可以与其他版本的 Chrome 一起使用。

如果您的页面占用了千兆字节的内存并且“其他”栏很大，超过 10%-20%，请向[Google Chrome Developer Tools Foums](https://groups.google.com/forum/?hl=en_US&fromgroups#!forum/google-chrome-developer-tools)发送有关此问题的邮件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-26T20:33:04.810

您仍然可以在配置文件选项卡下拍摄快照，然后单击拍摄头部快照，它会为您提供深入的内存使用统计信息。

# android - ListFragment 多选不显示选择

> ID：13318113
> 
> 赞同：2
> 
> 时间：2012-11-10T00:50:04.703
> 
> 标签：android, fragment, android-listfragment, contextual-action-bar

我正在尝试在我的应用程序中实现上下文操作栏。我正在扩展一个 ListFragment，并且定义了一个自定义 ArrayAdapter 和列表项 xml。单击项目可以正常工作，并且列表项的背景颜色会发生变化。我遇到麻烦的地方是选择多个项目时。上下文操作栏出现，当我触摸它们时我可以告诉我实际上是在选择项目，因为我让它记录选择了哪些项目，但列表项上的背景突出显示颜色没有改变！似乎其他一些人在使用 Fragments API 时也遇到了这个问题，他们想出了一种技巧来让它正常工作。但是，我想知道是否有人对为什么我的列表没有显示所选项目有明确的答案。

为了更好地衡量，这是我的代码：

```
ListView list = getListView();
    list.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);
    list.setSelector(R.drawable.list_selector);

    // configure contextual action bar
    list.setMultiChoiceModeListener(new AbsListView.MultiChoiceModeListener() {
        @Override
        public void onItemCheckedStateChanged(ActionMode actionMode, int position, long id, boolean b) {
            Log.i("debug", "item " + position + " changed state");
        }

        @Override
        public boolean onCreateActionMode(ActionMode actionMode, Menu menu) {
            MenuInflater inflater = actionMode.getMenuInflater();
            inflater.inflate(R.menu.context_menu, menu);
            return true;  
        }

        @Override
        public boolean onPrepareActionMode(ActionMode actionMode, Menu menu) {
            return false;
        }

        @Override
        public boolean onActionItemClicked(ActionMode actionMode, MenuItem item) {
            switch (item.getItemId()) {
                case R.id.delete:
                    Log.i("debug", "delete stuff");
                    return true;
                default:
                    return false;
            }
        }

        @Override
        public void onDestroyActionMode(ActionMode actionMode) {

        }
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T07:02:07.317

我为我的自定义列表项视图提供了一个背景选择器。

```
<selector xmlns:android="http://schemas.android.com/apk/res/android"
    android:exitFadeDuration="@android:integer/config_mediumAnimTime">
<item android:state_activated="true" android:drawable="@drawable/number_bg_pressed" />
<item android:drawable="@android:color/transparent" /> 
```

我参考 APIdemos View/List/List16 示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-26T23:14:46.727

设置 SimpleCursorAdapter 时，我使用 android.R.layout.simple_list_item_activated_1 进行布局。自定义主题可能是更好的解决方案。就我而言，我有一个静态方法来根据 android api 版本检索布局。

# c++ - 在构造函数中为数组赋值

> ID：13318114
> 
> 赞同：1
> 
> 时间：2012-11-10T00:50:09.297
> 
> 标签：c++, arrays, constructor, initialization, stdvector

我正在创建一个二叉树类。我想通过创建一个将数据存储在数组中的类来简化这一点，然后返回并让魔法发生。

但是，以下代码部分中注释掉的行会导致 Visual Studio 产生大量错误。这对我来说很有意义，但由于某种原因它不会编译。我不是 C++ 人，但经过大量谷歌搜索后，没有什么对我有用。

```
 template 
class bin_tree
{
private:
    int *data;

public:
    int getData(int x)
    {
        return 1;
    };
    bin_tree() : data(new int[4])
    {
        //data = {1, 2, 3, 4};
    };
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:55:55.300

如果您的数组的大小是固定的（从您的代码来看，似乎是这种情况），那么您不需要进行动态分配（即“新”）。

[http://coliru.stacked-crooked.com/a/97e112739e8a45de](http://coliru.stacked-crooked.com/a/97e112739e8a45de)

```
class bin_tree
{
private:
    int data[4];

public:
    int getData(int)
    {
        return 1;
    };
    bin_tree()
        : data{1, 2, 3, 4} // C++11
    {
        // or:
        data[0] = 11;
        data[1] = 22;
        // ...
    };
};

#include <iostream>
int main()
{
    bin_tree tr;
    std::cout << "OK";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T01:03:20.347

欢迎使用 C++。用于`std::array`固定大小的数组：

```
#include <array>

class bin_tree {
private:
    std::array<int, 4>data;
public:    
    bin_tree() : data({1, 2, 3, 4}) {
    }
    ...
}; 
```

如果您需要动态调整大小，请`std::vector`改用。

# c - C DMA - 使用带有 malloced 内存的括号

> ID：13318115
> 
> 赞同：2
> 
> 时间：2012-11-10T00:50:15.713
> 
> 标签：c, malloc, dynamic-memory-allocation, square-bracket

自从我写 C 以来已经有一段时间了，所以这个错误让我觉得我疯了。我正在编写一个程序来模拟一个简单的缓存。不要担心细节。

问题是当我初始化缓存时。在 SA_cacheInit 的行中：

```
cur_lru = cache->sets + i;//[i]; 
```

使用括号失败，并且在 GDB 中检查时，即使 i = 0，它最终也会给出一个空指针。但是，如果我只使用普通的指针算术，它就可以工作。我究竟做错了什么？

```
 typedef struct s_LRUnode {
  int tag;
  bool valid;
  bool dirty;
  struct s_LRUnode *next;
  struct s_LRUnode *prev;
} LRUnode;

typedef struct s_LRU {
  size_t size;
  LRUnode *head;
  LRUnode *tail;
} LRU;

typedef struct s_SA_cache {
  size_t blocksize;
  size_t num_blocks;
  size_t set_size;
  LRU **sets;
} SA_cache;

void cachesim_init(int blocksize, int cachesize, int ways) {
  cache = malloc(sizeof(SA_cache));

if ( cache != NULL ) {
    assert( powerOfTwo(cachesize) && powerOfTwo(blocksize) );
    cache->num_blocks = cachesize / blocksize;
    cache->blocksize = blocksize;
    cache->set_size = ways;
    cache->sets = malloc(sizeof(LRU)*cache->num_blocks); //cache->num_blocks*ways);
    if (cache->sets == NULL) {
      printf(stderr, "Malloc failed in %s\n", **func**);
    }
    SA_cacheInit(cache, cache->num_blocks, ways);
  } else {
    fprintf(stderr, "Could not allocate memory for cache\n");
    exit(-1);
  }
}

void SA_cacheInit(SA_cache *cache, size_t num_blocks, size_t size) {
  int i;
  LRU *cur_lru;

for (i = 0; i < num_blocks; i++) {
    cur_lru = cache->sets + i;//[i];
    cur_lru->size = size;
    cur_lru->head = NULL;
    cur_lru->tail = NULL;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T06:50:48.447

在我看来，`SA_cache::sets`应该有 type`LRU*`而不是`LRU**`. 正如 Jamey 指出的那样，否则您在此处发布的内容将无法完全编译。这个答案的其余部分假设类型是`LRU*`.

当你写：

```
cur_lru = cache->sets[i]; 
```

`cur_lru`获取 的第th 元素的*值*，在您的情况下为零（可能是因为您的进程只是第一次看到此内存）。`i``cache->sets`

如果要使用数组下标，则需要使用地址运算符 ( `&`)：

```
cur_lru = &cache->sets[i]; 
```

`cur_lru`然后获取cache->sets的第 th 个元素的*地址。*`i`这在功能上与您发布的指针算法相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T01:15:16.833

既然类型`cache->sets`是`LRU **`，那么类型`cache->sets + i`也是`LRU **`。当您将结果分配给 时`LRU *cur_lru`，我希望您会收到编译器警告。（您是否在没有启用警告的情况下进行构建？）

这种来自不兼容指针类型的赋值意味着您正在写入`sets`数组中的指针，就好像它们是`LRU`结构的字段一样。

* * *

编辑：在更仔细的阅读中，我看到您理解下标应该是正确的，并且您报告说代码只有在您引入这种类型错误时才有效。我支持上述观点，事实上 GCC 报告“警告：来自不兼容指针类型的赋值”，即使没有`-Wall`.

我可以在这段代码中找到的唯一另一个问题是，当您`malloc`使用`sets`数组时，您将每个元素的大小设置为`sizeof(LRU)`，而不是`sizeof(LRU *)`。但是，几乎可以肯定，无论您在哪个平台上，都会使`LRU`结构大于指向 的指针`LRU`，因此这不应该解释您所看到的症状。

请注意，如果您使用优化（`gcc -O2`或类似方法）进行编译，则`gdb`报告的信息可能会产生误导。当您引入类型错误时，您可能会阻止`gcc`优化初始化，并且可能是`gdb`报告您所期望的唯一原因。

我强烈建议您编译`gcc -Wall`并修复所有警告。然后，如果这还没有解决问题，请在[Valgrind](http://valgrind.org/)下运行您的程序以捕获各种内存错误。

# git - 如何在 git web 界面中搜索提交

> ID：13318120
> 
> 赞同：0
> 
> 时间：2012-11-10T00:51:22.927
> 
> 标签：git

如何使用 git web 界面搜索提交。

例如，这里是一个 git web [http://git.kernel.org/?p=git​​/git.git;a=summary](http://git.kernel.org/?p=git/git.git;a=summary)。

它有一个提交 ID，如“8ead1bfe111085ef1ad7759e67340f074996b244”

[http://git.kernel.org/?p=git​​/git.git;a=commit;h=8ead1bfe111085ef1ad7759e67340f074996b244](http://git.kernel.org/?p=git/git.git;a=commit;h=8ead1bfe111085ef1ad7759e67340f074996b244)

但是为什么当我去'http://git.kernel.org/?p=git​​/git.git;a=summary'，选择'commit'并输入'8ead1bfe111085ef1ad7759e67340f074996b244'时，它说'不匹配'？

[http://git.kernel.org/?p=git​​%2Fgit.git&a=search&h=HEAD&st=commit&s=8ead1bfe111085ef1ad7759e67340f074996b244](http://git.kernel.org/?p=git%2Fgit.git&a=search&h=HEAD&st=commit&s=8ead1bfe111085ef1ad7759e67340f074996b244)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:09:51.633

据我所知，你不能用 gitweb 做到这一点。我想他们认为您可以自己将提交哈希作为`h=`参数粘贴到 URL 中？

请注意，至少 gitweb 将对 h 参数进行任意提交，如[http://git.kernel.org/?p=git](http://git.kernel.org/?p=git/git.git;a=commit;h=v1.8.0) ​​/git.git;a=commit;h=v1.8.0 。

根据 gitweb 的[搜索帮助](http://git.kernel.org/?p=git/git.git;a=search_help)，当你选择“Commit”时，然后

> 将为给定模式扫描提交消息和作者信息。

# mysql - PostgreSQL UPDATE 等效于 MySQL 查询

> ID：13318121
> 
> 赞同：3
> 
> 时间：2012-11-10T00:51:45.967
> 
> 标签：mysql, sql, postgresql, sql-update

我有一个简单的 MySQL 查询，我想将其转换为 PostgreSQL。3天后我终于退出了，因为我不明白这里有什么问题：

```
UPDATE webUsers u, 
(SELECT IFNULL(count(s.id),0) AS id, p.associatedUserId FROM pool_worker p 
LEFT JOIN shares s ON p.username=s.username 
WHERE s.our_result='Y' GROUP BY p.associatedUserId) a
SET shares_this_round = a.id WHERE u.id = a.associatedUserId 
```

我试图转换它，但它在 SET 上显示错误。这是我的查询：

```
UPDATE webusers 
SET (shares_this_round) = (a.id)
FROM (SELECT coalesce(count(s.id),0) AS id, p.associatedUserId FROM pool_worker p 
LEFT JOIN shares s ON p.username=s.username WHERE s.our_result='Y' GROUP BY p.associatedUserId) a, webusers w WHERE u.id = a.associatedUserId 
```

谁能告诉我它有什么问题？就因为这个，我睡不着。

```
 ------------------------------EDIT------------------------------------- 
```

股表

```
CREATE TABLE shares (
id bigint NOT NULL,
rem_host character varying(255) NOT NULL,
username character varying(120) NOT NULL,
our_result character(255) NOT NULL,
upstream_result character(255),
reason character varying(50),
solution character varying(1000) NOT NULL,
"time" timestamp without time zone DEFAULT now() NOT NULL
); 
```

网络用户表

```
CREATE TABLE webusers (
id integer NOT NULL,
admin integer NOT NULL,
username character varying(40) NOT NULL,
pass character varying(255) NOT NULL,
email character varying(255) NOT NULL,
"emailAuthPin" character varying(10) NOT NULL,
secret character varying(10) NOT NULL,
"loggedIp" character varying(255) NOT NULL,
"sessionTimeoutStamp" integer NOT NULL,
"accountLocked" integer NOT NULL,
"accountFailedAttempts" integer NOT NULL,
pin character varying(255) NOT NULL,
share_count integer DEFAULT 0 NOT NULL,
stale_share_count integer DEFAULT 0 NOT NULL,
shares_this_round integer DEFAULT 0 NOT NULL,
api_key character varying(255),
"activeEmail" integer,
donate_percent character varying(11) DEFAULT '1'::character varying,
btc_lock character(255) DEFAULT '0'::bpchar NOT NULL
); 
```

pool_works 表

```
CREATE TABLE pool_worker (
id integer NOT NULL,
"associatedUserId" integer NOT NULL,
username character(50),
password character(255),
allowed_hosts text
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T03:58:47.377

首先，我进行了格式化以得到这个不那么令人困惑但仍然**不正确**的查询：

```
UPDATE webusers 
SET   (shares_this_round) = (a.id)
FROM  (
   SELECT coalesce(count(s.id),0) AS id, p.associatedUserId
   FROM   pool_worker p 
   LEFT   JOIN shares s ON p.username=s.username
   WHERE  s.our_result='Y'
   GROUP  BY p.associatedUserId) a
   , webusers w
WHERE u.id = a.associatedUserId 
```

此语句中有多个不同的错误和更多次优部分。错误是第一位的，并以 **大胆**的强调。最后几项只是建议。

1.  **缺少** `u`网络用户的别名。一个微不足道的错误。

2.  **`w`和之间**缺少连接**`a`。导致交叉连接，这几乎没有任何意义，并且就性能而言是一个非常昂贵的错误。这也是完全不需要的，您可以从查询中删除**冗余的第二个实例。`webuser`****

***   `SET (shares_this_round) = (a.id)`是**语法错误**。您不能将列名包含`SET`在括号中的子句中。无论如何，这将毫无意义，就像括号一样`a.id`。不过，后者不是语法错误。

    *   事实证明，在评论和问题更新后，您创建了带有**双引号`"CamelCase"`标识符**的表（我建议永远不要将其用于我们刚刚遇到的那种问题）。阅读手册中的[标识符和关键字](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)一章以了解问题所在。简而言之：非标准标识符（带有大写字母或保留字，..）必须始终用双引号引起来。
    我修改了下面的查询以适应新信息。

    *   根据定义，聚合函数`count()`永远不会返回`NULL`。`COALESCE`在这种情况下是没有意义的。我引用[了关于聚合函数的手册](http://www.postgresql.org/docs/current/interactive/functions-aggregate.html)：

    > 需要注意的是，**除了 count 之外**，这些函数在没有选择行时返回空值。

    强调我的。计数本身有效，因为`NULL`不计算值，所以实际上你得到 0 在没有`s.id`找到的地方。

    *   我还使用了不同的列别名 ( `id_ct`)，因为`id`计数只是误导。

    *   `WHERE s.our_result = 'Y'`...如果`our_result`是 type `boolean`，就像它看起来应该的那样，你可以简化为 just `WHERE s.our_result`。我在这里猜测，因为您没有提供必要的表定义。

    *   避免实际上不会更改任何内容的更新几乎总是一个好主意（适用罕见的例外情况）。我添加了第二个`WHERE`子句来消除这些：

    ```
    AND   w.shares_this_round IS DISTINCT FROM a.id 
    ```

    如果`shares_this_round`已定义`NOT NULL`，则可以使用`<>`代替，因为`id_ct`不能`NULL`。（同样，缺少相关信息。）

    *   `USING(username)`只是可以在此处使用的符号快捷方式。** 

 **把所有东西放在一起，得到这个**正确**的形式：

```
UPDATE webusers w
SET    shares_this_round = a.id_ct
FROM  (
   SELECT p."associatedUserId", count(s.id) AS id_ct
   FROM   pool_worker p 
   LEFT   JOIN shares s USING (username)
   WHERE  s.our_result = 'Y'                        -- boolean?
   GROUP  BY p."associatedUserId"
   ) a
WHERE w.id = a."associatedUserId"
AND   w.shares_this_round IS DISTINCT FROM a.id_ct  -- avoid empty updates 
```**

# java - 如何像 Heroku 一样将 Java 应用程序部署到 EC2？

> ID：13318122
> 
> 赞同：0
> 
> 时间：2012-11-10T00:51:47.380
> 
> 标签：java, git, amazon-ec2

我真的很喜欢 Heroku 风格来提交代码，并且所有内容都部署到服务器上。但是，我正在构建一个需要读/写文件系统的 java web 服务。所以，heroku 对我来说不是最好的选择。所以，我认为我最好的选择是将它托管在 EC2 上。但是，我想设置一些东西，比如当我提交代码并推送到 Github 时，它也会推送到 EC2 服务器。

所以，Github 只是一个源代码控制，但服务器在 EC2 上。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T05:53:15.517

You could use AWS Elastic Beanstalk, which manages server/app container for you.

You can find more information here: [http://aws.amazon.com/elasticbeanstalk/](http://aws.amazon.com/elasticbeanstalk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:03:06.513

是的。[例如，Java on Play 或 Spring 堆栈可以在 Heroku 上运行。](http://blog.heroku.com/archives/2011/8/29/play/)

[查看本文以查看 Heroku 支持的所有堆栈。](https://devcenter.heroku.com/articles/cedar)

# git - 跟踪另一个 git 存储库

> ID：13318123
> 
> 赞同：1
> 
> 时间：2012-11-10T00:51:56.270
> 
> 标签：git, version-control, redmine, gitosis

我尝试建立一个开发环境“redmine”，它应该可以让多人轻松开发和维护我们自己的“redmine”版本，包括我们自己的特性和调整。我对远程分支不太熟悉，但我想到了这样的配置：

*   *master*分支：用于部署
*   *dev*分支：在这里我们正在开发我们的新功能
*   *社区*分支：这是我卡住的地方。我想要一个跟踪 redmine 的 github 社区 repo 的分支，这样我就可以在这个分支中说“git checkout v2.0”，然后在 dev 分支中说“git merge community”并解决由于我们自己的特点在那里。在下一次 redmine 发布之后，我将在社区分支中签出 v2.1 并将其再次合并到 dev 分支，依此类推......

当然，我可以向我的本地分支添加一个遥控器，从社区 repo 中提取并推送到我的原点，但是其他人不会看到这一点，并且必须自己添加社区远程 repo（对吗？）。这是可能的还是解决这个“在我自己的项目中跟踪参考项目”问题的另一种方法？

谢谢

简

顺便说一句：我的*原始*仓库是使用 gitosis 创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T00:17:17.437

无论您是在您的*开发*部门还是*社区*分支（工作领域），您都需要使用功能分支来开发、编辑和提出您的开发，以便能够以结构化的方式将它们组合在一起。也就是说，您应该选择一种方法来合并贡献并将它们提升到更高的水平。[git-scm.com/book/en/Git-Branching-Branching-Workflows](http://git-scm.com/book/en/Git-Branching-Branching-Workflows)

一定要花时间了解遥控器的工作方式，并且跟踪的分支是完全重复的（直到常见的 fetch/push 点），所以你不能计划让不同人的贡献分配到同一个*社区*分支 - 这就是为什么每个人都应该有自己的功能分支。功能完成后，您可以重复使用分支名称。

git 本身（[github.com/git/git](https://github.com/git/git)）有一个已发布的分支序列：- *pu*（潜在更新），*next*，最后是*master*。在*pu*之前有单独的贡献者分支（每个分支都是从 git 列表的情况下的补丁系列提交构建的），如果/当维护者需要时，可以重绕*pu 。**接下来*更稳定。用户获取更新并将他们的工作重新建立在相关的最新版本上。

# php - php mysql 查询条件oop

> ID：13318126
> 
> 赞同：1
> 
> 时间：2012-11-10T00:52:12.367
> 
> 标签：php, mysql, sql, oop, conditional-statements

我想知道如何从 PHP 中的 SelectQuery 对象为 SELECT mysql 查询创建一个通用函数。SelectQuery 扩展了 Query，这意味着它继承了数据库连接、一个 realescape 方法（即 mysqli_real_escape_string()）和一个执行查询的查询方法。除此之外，它还获得一个名为 _sql 的受保护变量，这是 query() 方法传递给数据库的 SQL。它还获得一个名为 _table 的受保护变量，其中包含正在处理的表的（转义）名称。

我的代码：

```
public function select($columns = array('*'), $known = null, $limit = null, $offset = null, $orderby = null, $asc = true) {
    if (!is_array($columns)) {
        new Error('Parameter is not an array.');
        return;
    }

    $select = '';
    foreach($columns as $column) {
        $select .= (($select != '')?', ':'') . '`' . $this->realescape($column) . '`';
    }
    $conditions = '';
    if (is_array($known)) {
        foreach($known as $column => $value) {
            $conditions .= (($conditions != '')?' AND ':'WHERE ') . '`' . $this->realescape($column) . '` = ' . ((is_string($value))?'\'':'') . $this->realescape($value) . ((is_string($value))?'\'':'');
        }
    }
    $domain = '';
    if ($limit !== null) {
        $domain = 'LIMIT ' . $this->realescape($limit);
        if ($offset !== null) {
            $domain .= ' OFFSET = ' . $this->realescape($offset);
        }
    }
    $order = '';
    if ($orderby !== null) {
        $order = 'ORDER BY `' . $this->realescape($orderby) . '` ' . (($asc)?'ASC':'DESC');
    }

    $this->_sql = 'SELECT ' . $select . ' FROM `' . $this->_table . '`';
    if ($conditions != '') {
        $this->_sql .= ' ' . $conditions;
    }
    if ($domain != '') {
        $this->_sql .= ' ' . $domain;
    }
    if ($order != '') {
        $this->_sql .= ' ' . $order;
    }
    return $this->query();
} 
```

$known 变量可能被设置，如果设置它应该是一个数组，其中包含我们正在选择的行的所有“已知”元素。

我的问题：我怎样才能做到这一点，以便 轻松制作`age < 18`或等条件`date > 5120740154`？

另外，如果您认为我制作这项工作的方式是错误的，请说出来。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:36:03.800

## 动态构建可以使用任何运算符的 WHERE 条件

创建一个 $where 数组来保存你的 where 条件。

```
$where = array (
    'age <' => 18,
    'date >' => 5120740154
); 
```

您可以使用如下函数将其构建到 SQL 查询中：

```
private function buildWhereConditions($where) {
    $conditions = 'WHERE 1=1';
    /*1=1 is just so you can easily append ANDs */
    foreach ($where as $key => $value) {
        $conditions .= " AND $key $value ";
    } 
    return $conditions;
} 
```

这将返回要附加到查询的 where 条件：

```
WHERE 1=1 AND age < 18 AND date > 5120740154 
```

# python - Django标签模型设计

> ID：13318128
> 
> 赞同：24
> 
> 时间：2012-11-10T00:52:29.387
> 
> 标签：python, django, tags, scalability

我想知道以下是否是为图像创建标记系统并能够呈现标记云的正确方法：

```
from django.db import models

class Tag(models.Model):
    word        = models.CharField(max_length=35)
    slug        = models.CharField(max_length=250)
    created_at  = models.DateTimeField(auto_now_add=False)

    def __unicode__(self):
        return self.word

class Photo(models.Model):
    slug                = models.CharField(max_length=250)
    filename            = models.CharField(max_length=200)
    extension           = models.CharField(max_length=4)
    size                = models.IntegerField()
    ...
    tags                = models.ManyToManyField(Tag)

    def __unicode__(self):
        return self.slug 
```

请注意，我的数据库表将包含数百万行，每个图像将有 4-8 个标签。

请指教。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-10T01:14:24.193

如果您只想创建一个标签云，那么该数据模型就足够了。我会做一个修改：

```
tags = models.ManyToManyField(Tag,related_name='photos') 
```

这将使您的照片视图中的反向查找更易于阅读和记忆。

但是，我会考虑您的标签的其他用例。标签云是您唯一想使用标签的东西吗？该关系是否应包含任何元数据？

如果您计划拥有数百万行，那么缓存将与数据模型一样重要。

此外，为避免重新发明轮子，请查看是否有其他人构建了一个满足您目的的库：http: [//www.djangopackages.com/grids/g/tagging/](http://www.djangopackages.com/grids/g/tagging/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-20T11:15:43.293

自己处理标签可能是一项艰巨的工作。您可以轻松使用 django 库。用 pip 安装

```
pip install django-taggit 
```

# jquery - 在 dom 之外创建元素并使用 jQuery 操作它们

> ID：13318129
> 
> 赞同：0
> 
> 时间：2012-11-10T00:52:44.560
> 
> 标签：jquery, dom, dom-traversal, jquery-traversing

我尝试查看标题几乎相同的[这篇文章](https://stackoverflow.com/questions/11813691/jquery-selecting-and-manipulating-html-elements-outside-the-dom)，但尽管尝试了看起来合适的答案，但我的代码仍然无法正常工作。

我正在像这样在 dom 之外创建一个元素：

```
var e = $('<div class="alert"><div class="messageBox"><h1>'+type+'</h1><p class="message">'+message+'</p></div></div>'); 
```

在下一行，我试图操纵它。

```
$('.alert',e).width($(window).width()).height($(window).height()); 
```

如您所见，我尝试为选择器定义上下文（我在另一篇文章中看到的建议），但它不起作用。有人可以向我指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T00:56:32.340

`.alert`div 已经在您的变量 DOM 内容的根目录中`e`，因此无需使用上下文参数（这将导致在您的div 中**查找**`.alert`另一个`.alert`div，它不会找到任何东西）所以只需这样做：

```
e.width($(window).width()).height($(window).height()); 
```

如果您要为您的 div 分配一些属性`.messageBox`，那么可以像您一样使用 context 参数：

```
 //this will work as .messageBox is inside your root element(.alert)
 $('.messageBox',e).width(...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T00:57:02.677

`$('.alert',e)`相当于`e.find('.alert')`which 什么都不返回，因为`e`is`.alert`

只需使用：

```
e.width($(window).width()).height($(window).height()); 
```

# python - 在执行长时间操作时锁定 GTK 中的小部件，但允许重绘

> ID：13318133
> 
> 赞同：0
> 
> 时间：2012-11-10T00:54:09.627
> 
> 标签：python, gtk, pygtk, gtk2

我正在用 GTK2（技术上是 pyGTK）编写一个应用程序，并将执行一些长时间的操作。

如果我在主线程中执行长操作（这不是一个好主意），应用程序将变得无响应。

理想的部分是阻止用户修改文本输入小部件的部分，但不理想的部分是窗口不会重新绘制自身。

还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T00:24:14.527

如果 GUI 在昂贵的过程中不需要用户交互，那么它没有理由不能在主线程中。您仍然可以在循环中手动更新 UI（重绘、处理移动/调整窗口大小等）

1.  通过将小部件的`"sensitive"`属性设置为 False 来禁用小部件。`widget.set_sensitive(False)`
2.  在处理循环的每次迭代（或每次迭代`n`）期间，使用以下内容更新 UI：`while gtk.events_pending(): gtk.main_iteration()`。

如果您打算使用线程，来自 ergosys 的评论以及 PyGTK FAQ 的链接应该会有所帮助。您还应该阅读GTK+ 参考文档中的[线程](http://developer.gnome.org/gdk/stable/gdk-Threads.html)。

# python - 保持最短路径会导致缓存（字典）：“str”对象不支持项目分配

> ID：13318136
> 
> 赞同：0
> 
> 时间：2012-11-10T00:54:36.977
> 
> 标签：python, dictionary, shortest-path

我向数据库提出了几个关于最短路径的请求，通常是相同的（76 次迭代，每次迭代有 10'000 到 20'000 个请求；我运行了几次，差异很小，但大多是相同的起点和终点最短路径）。所以我创建了一个缓存。我的缓存是一本字典。

```
 with open('path_to_OD_dict', 'rb') as file:
        my_unpickler=pickle.Unpickler(file)
        OD_dict = my_unpickler.load() 
```

出发地和目的地用 5 位数字编码。如有必要，我用零填充它们，然后将它们放在一起（我们有 origin_route <destination_route）：

```
 origin_route = str(origin_route).zfill(5)
    destination_route = str(destination_route).zfill(5)
    key = origin_route + destination_route 
```

然后我只是尝试找到我刚刚在我的字典中构建的这个键。如果它存在，我直接拥有我的价值。

```
 try:
        result = OD_dict[key] 
```

否则，我请求最短路径并将其添加到字典中：

```
 except:
        result = shortestPathLength(origin_route, destination_route)
        OD_dict[key] = result
        with open('path_to_OD_dict', 'wb') as file:
            my_pickler=pickle.Pickler(file)
            my_pickler.dump(OD_dict) 
```

在线`OD_dict[key] = result`我有错误`TypeError: 'str' object does not support item assignment`。

我也在用[`Multiprocessing`](http://docs.python.org/2/library/multiprocessing.html)。我很可能只是试图同时访问`OD_dict`多个进程。

```
results = []
po = multiprocessing.Pool()
for item in aSet:
    results.append(po.apply_async(aBiggerFunctionWithShortestPathInIt))                    
po.close()
po.join()
for r in results:
    myResult.add(r.get()) 
```

为什么我会收到此特定消息？（类型错误）

另外，我应该如何调整我的代码以能够同时读取`OD_dict`多个进程（或至少不会产生问题），并在必要时按顺序修改它，而不同时修改转储？

# jquery - 如何从其他 div 中的图像中提取标题属性

> ID：13318137
> 
> 赞同：0
> 
> 时间：2012-11-10T00:54:43.107
> 
> 标签：jquery, image, attributes, title, alt

***HTML：***

```
<img class="thumb_img" title="Sample title here" src="http://example.com/test.jpg" /> 
```

我想从中提取`title`属性`img`并将其作为文本添加到`div`.

* * *

*结果：*

```
<img class="thumb_img" title="Sample title here" src="http://example.com/test.jpg" />

<div class="title_container">Sample title here</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:57:59.060

您可以使用 jQuery 的`attr()`函数来获取任何属性的值。

```
var title = $("imgSelector").attr('title'); 
```

然后插入它，`text()`如果您只期望原始文本，您可以使用它。或者`html()`如果内容可以是标记。

```
$("divSelector").text(title); 
```

`imgSelector`并且`divSelector`是图像和目标 div 的选择器。我不确定您是否提供了伪代码或生产代码，因此您必须将其替换为您当前使用的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T00:58:59.650

从图片中获取title属性

```
title = $("img.thumb_img").attr('title'); 
```

将它放在 div 中（并使用更具体的选择器：P）

```
$('div').html(title); 
```

# java - Hashtable 与 Hashmap 有何不同

> ID：13318139
> 
> 赞同：17
> 
> 时间：2012-11-10T00:55:20.840
> 
> 标签：java, hashmap, hashtable

> **可能重复：**
> [HashMap 和 Hashtable 之间的区别？](https://stackoverflow.com/questions/40471/differences-between-hashmap-and-hashtable)

我见过在不同代码中使用的哈希表和哈希映射，但它们看起来就像做同样的事情。它们之间有区别吗？我应该在我的代码中使用哪一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-10T00:57:14.523

**java.util.Hashtable**方法是**同步**的，**java.util.Hashmap**方法不是。如果您使用**Hashtable**，则会**影响性能**，因为没有**两个线程**能够同时访问其方法。如果您关心应用程序中的**线程安全，那么****Hashtable**就是您要走的路。如果你不关心线程安全**Hashmap**是要走的路，因为它比**hashtable 更有效。** java.util.Hashtable 也不允许任何空键，而 java.util.HashMap 允许一个空键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T00:57:18.513

Hashtable 是同步的，而 HashMap 不是。这意味着如果您只有一个线程访问数据，请使用 HashMap，否则使用 Hashtable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:05:18.430

HashTable 不允许空键，而 hashmap 允许一个空键

# html - 在图像上显示 div 单击然后在 x 秒后将其隐藏

> ID：13318140
> 
> 赞同：0
> 
> 时间：2012-11-10T00:55:22.723
> 
> 标签：html, hide, show, fade, smoothing

我试图在单击图像时显示一个 div，然后在给定的秒数后将其隐藏。我找到了两个符合我需要的单独代码示例，但我不知道将它们放在一起。

**使内容在 x 秒后消失的代码：**

```
<script>
    window.setTimeout(function() {
        $('#fadeout').hide(2000);
    }, 4000);
</script> 
```

**使 div 出现在 imageclick 上的代码：**

```
<SCRIPT>
function fade(div_id, button) {

    if(button.value == 'FadeOut') {
        $('#'+div_id).fadeOut('slow');
        button.value = 'FadeIn';
    }
    else {
        $('#'+div_id).fadeIn('slow');
        button.value = 'FadeOut';
    }
}

$('#sometext').fadeOut(2);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T01:51:31.290

也许这会有所帮助：

```
$('#fadeout').hide(); // hide div
$('img').live('click', function(e){ 
    e.preventDefault(); //cancel default action of click
    $('#fadeout').show().delay(5000).fadeOut(1000); //show div on img click then hide after 5 seconds
}); 
```

这是一个工作示例：http: [//jsfiddle.net/7X767/3/](http://jsfiddle.net/7X767/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T07:31:26.940

您可以使用以毫秒为单位的时间值，而不是使用“慢”。

# php - 正则表达式的强词

> ID：13318142
> 
> 赞同：0
> 
> 时间：2012-11-10T00:55:40.970
> 
> 标签：php, regex

我有这个正则表达式：

```
<?PHP
$test = 'this is a #test';
$regex = "#(\#.)#i";
$test = preg_replace($regex, '<strong>$1</strong>', $test);
echo $test;
?> 
```

我希望#之后的单词是strong，但我只有#t in strong，有人有建议吗？多谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:05:52.540

我的建议是这样的 -

```
$regex = "/#(\w+)/i"; 
```

表示`\w`任何[单词字符](http://www.php.net/manual/en/regexp.reference.character-classes.php)。我还使用了`+` [量词](http://php.net/manual/en/regexp.reference.repetition.php)，表示我们必须在井号后面匹配至少一个单词字符。我假设我们不希望只有井号`<strong>` 我还从捕获组中删除了井号 (#)，因为我不太确定你是否希望在用`<strong>`.

我要留给您的最后一点是，如果您发现自己在正则表达式中使用[定界符](http://www.php.net/manual/en/regexp.reference.delimiters.php)，您可能需要考虑将其更改为您通常不会使用的东西。在您的情况下，您必须转义井号，但在我的示例中，我已将分隔符更改为斜杠。它也使它更容易阅读:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T00:58:22.867

用于`+`匹配任何一个或多个数字文字。`*`如果要在 .`0`之后包含出现的文字，请使用`#`.

```
 $regex = "#(\#.+)#i"; 
```

有关详细信息，请参阅[**PHP Regex Repetition**](http://php.net/manual/en/regexp.reference.repetition.php)文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T00:58:34.487

尝试这个：

```
<?PHP
$test = 'this is a #test';
$regex = "#(\#.*)#i";
$test = preg_replace($regex, '<strong>$1</strong>', $test);
echo $test;
?> 
```

问题是 。仅作为单个字符匹配。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-10T00:57:33.850

您需要设置要保存的符号数量：

```
$regex = "#(\#.{4})#i"; 
```

# jquery - jquery 动态 iframe - !document.write 和 IE 问题

> ID：13318143
> 
> 赞同：2
> 
> 时间：2012-11-10T00:55:47.310
> 
> 标签：jquery, internet-explorer, iframe, append, document.write

为什么这在所有浏览器中都有效 - 除了 IE：

```
var $iframe = $("<iframe name=" + strFrameName +"/>");
var $doc = $iframe.contents();
$doc.find("head").append("<link type='text/css' rel='stylesheet' href='" + opt.loadCSS + "'>"); 
```

但是，如果我使用带有 document.write 的非 jquery 对象，它在 IE 中可以正常工作吗？

```
var $iframe = $("<iframe name=" + strFrameName +"/>");
var doc = $iframe[0].contentWindow.document;
doc.write("<link type='text/css' rel='stylesheet' href='" + opt.loadCSS + "'>"); 
```

我重写了一个插件，并想重写它，这样它就不会使用`document.write`

但是，现在 iframe 正在创建，但头部/主体在 IE 中保持为空。

查看原始版本的小提琴（document.write）：http: [//jsfiddle.net/jasonday/Tx4Uv/](http://jsfiddle.net/jasonday/Tx4Uv/)

和更新尝试使用的小提琴，`.append`而不是：http `.write`: [//jsfiddle.net/jasonday/Tx4Uv/4/](http://jsfiddle.net/jasonday/Tx4Uv/4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T03:30:14.370

固定的。

我添加了`setTimeout`2ms 以允许 iframe 在附加到头部和正文之前完全渲染（主要用于 IE）。

# android - 将数据从一个应用程序传输到 Android 上的另一个应用程序

> ID：13318149
> 
> 赞同：1
> 
> 时间：2012-11-10T00:56:42.620
> 
> 标签：android, android-intent

我创建了两个应用程序，我想从一个应用程序获取数据到另一个应用程序。

做这个的最好方式是什么？

1.  我可以从应用程序 1 备份到 sdcard，然后从应用程序 2 的 sdcard 获取数据

2.  （首选）我可以从应用程序 1 打开应用程序 2，使用 Intent 启动它，并使用额外的密钥返回可以从 onActivityResult 获取的数据。

我该怎么办？

有没有更好的数据传输方式？

我要传输的数据是从 sqlite 数据库到另一个数据库的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T05:50:51.240

您需要将您的应用程序声明为内容提供者：

[http://developer.android.com/guide/topics/providers/content-provider-creating.html](http://developer.android.com/guide/topics/providers/content-provider-creating.html)

为每个应用程序分配访问内部定义的权限以访问彼此清单中的所述内容的能力

在每个 Manifest 中定义自己的：

```
<permission /> 
```

在两者中使用它：

```
<uses-permission /> 
```

实际上，您可以从另一个读取一个以及将新数据写入主内容提供程序，甚至将它们都定义为内容提供程序并让它们以这种方式相互寻址。

# c# - MVC4 中模型上的远程验证器到 /api/ 路由

> ID：13318150
> 
> 赞同：1
> 
> 时间：2012-11-10T00:56:58.460
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-4, asp.net-web-api

如何通过数据注释配置远程验证器以在 /api/{controller} 而不是 /{controller}/{action} 进行调用？

我的模型：

```
public class MyModel
{
    [Required]
    public string Name { get; set; }
    [EmailAddress(ErrorMessage="We need a valid email."), Remote(....)]
    public string Email { get; set; }
} 
```

无论我尝试什么，远程验证器调用的 URL 都是 /foo/bar，而不是仅仅访问 /api/foo。

远程验证器中是否支持 WebAPI？

如果可能的话，我希望我的电子邮件唯一性检查使用 .NET 验证器（而不是必须手动进行），我的表单是通过 AJAX 提交的，我想在提交表单之前验证电子邮件，并使用指向 API 控制器的远程验证器似乎是一个自然的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:49:35.320

无法使用 Web API 控制器。这是`RemoteAttribute`. 为避免与 MVC 控制器发生冲突，要匹配 Web API 路由，您必须包含一个`httproute`密钥，但这`RemoteAttribute`是不行的。

您应该能够继承`RemoteAttribute`和覆盖`GetUrl`以使其工作。

# java - 有没有办法使用 Dropbox API 上传到单个用户的 Dropbox？

> ID：13318155
> 
> 赞同：6
> 
> 时间：2012-11-10T00:57:19.327
> 
> 标签：java, dropbox, dropbox-api

我想知道是否可以使用 Dropbox API 为应用程序全局授予访问权限。

这是我的场景。我正在开发一个 Java 应用程序，它允许老师让他的学生提交作业。该应用程序将执行大量任务，但随后会将文件上传到教师的 Dropbox 帐户。

我已经能够让应用程序进行身份验证并上传到每个特定用户的 Dropbox/Apps/LabTab 文件夹，但是有没有办法可以让应用程序始终连接到老师的保管箱并上传到他的 Dropbox/Apps /LabTab 文件夹？

我想一个更简单的说法是说我想要一种方法让用户授予对来自我的单个应用程序的未经身份验证的请求的全局访问权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T09:04:39.297

我在我的 Web 应用程序中做类似的事情，当项目成员授权此应用程序时，项目成员在项目创建者/所有者保管箱应用程序目录中拥有共同的文档位置。

您也（可能）应该在应用程序级别执行此操作。如果您的应用程序是基于 j2se 的（桌面应用程序），您必须将教师的访问令牌硬编码到应用程序中，或者（更好）做一些 Web 界面，它将每个教师的访问令牌与教师的资源连接起来（Dropbox/Apps/YoursApplication 每个教师） . 在这种情况下，最终用户（可能是学生）将能够通过您的应用程序作为这个具体的老师上传/下载/对教师资源采取行动。

# c++ - 通过基指针访问派生类中的模板化函数

> ID：13318157
> 
> 赞同：1
> 
> 时间：2012-11-10T00:57:28.127
> 
> 标签：c++, templates, inheritance

这是我的问题的抽象。

我想开发这样的东西。

```
class Base {
}

template<typename T>
class TypedBase : Base {

    f(const T& input);
} 
```

现在我想通过基指针访问 TypedBase 类的“家族”并调用 f。

像这样的东西

```
Base* base_ptr;
if (condition) {
  base_ptr = new TypedBase<double>();
} else {
  base_ptr = new TypedBase<int>();
}

// Int and double are just examples to get the idea
// Then I Want to call

base_ptr->f(4); 
```

这不会编译。

我尝试向基础添加一个空的虚函数 f()，希望 vtable 能够在运行时负责调用正确的 f() 与 f(T& 输入)，但同样不能像这样工作：

```
class Base {
   virtual f() = 0;
} 
```

那么你是怎么做到的呢？一般来说，我想要一个指向通用 TypedBase 的指针，它允许我通过指向族的通用指针调用 f(...) 。有什么想法吗？

我当然可以这样做：

```
class Base {
    // Repeat for every typename
    virtual f(int& x) = 0;
    virtual f(double& x) = 0;
} 
```

然后每个 TypedBase 将只实现其中一个，因此我仍将在运行时获得类型安全，而无需在代码中进行动态检查。但是，如果我有 N 个要调用的函数和 M 个要使用的类型，那么我将不得不将 M*N 抽象函数添加到 Base 类中。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T22:51:52.237

您必须`static_cast`（如果您知道真实类型）或`dynamic_cast`（如果您需要检查转换是否成功）指向正确类的基指针。如果您知道要传递给方法的内容，则转换为采用该参数的类型应该不是问题。此外，转换应该在具有正确模板类型的模板方法中工作。

以下是否编译？

```
template <typename T>
void callF(Base *p, T input) {
  TypedBase<T> *tp = dynamic_cast<TypedBase<T>*>(p);
  if (tp) tp->f(input);
  // else throw exception or call some Base method or return error or...
} 
```

或者不太安全，只需执行以下操作：

```
static_cast<TypedBase<int>*>(base_ptr)->f(1); 
```

# unit-testing - grails listOrderBy动态查找器中单元测试中的@Mock域对象引发异常

> ID：13318158
> 
> 赞同：1
> 
> 时间：2012-11-10T00:57:29.070
> 
> 标签：unit-testing, grails, mocking, dynamic-finders

我正在为 grails 控制器编写单元测试。这是代码片段：

```
@TestFor(MyController)
@Mock([MyDomain])
class MyControllerTests {

    void testController() {
        ...
        ...
    }
} 
```

下面是域对象的样子：

```
class MyDomain {
    static constraints = {
        name(nullable: false)
        parent(nullable: true)
    }

    static belongsTo = Industry

    static hasMany = [children: Industry]

    Industry parent
    String name
} 
```

我正在测试的控制器中的方法调用这个 GORM 动态方法：

```
MyDomain.listOrderByParent() 
```

当执行到这一行时测试失败，并且异常对我来说没有多大意义，因为 @Mock 注释应该添加了所有动态方法：

```
groovy.lang.GroovyRuntimeException: Cannot compare com.stuff.MyDomain with value 'com.stuff.MyDomain : 1' and com.stuff.MyDomain with value 'com.stuff.MyDomain : 4'
at org.grails.datastore.mapping.simple.query.SimpleMapQuery$_executeQuery_closure63_closure155.doCall(SimpleMapQuery.groovy:78) 
```

运行 grails 应用程序时，控制器工作正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-08T15:08:42.007

您也可以模拟 Industry 域对象：

```
@Mock([MyDomain, Industry]) 
```

# c# - 捕获 va_list 错误

> ID：13318161
> 
> 赞同：1
> 
> 时间：2012-11-10T00:57:38.187
> 
> 标签：c#, c++, try-catch

我目前正在使用以下函数来打印我的调试字符串：

```
void Script::OutputDebugStringN(const char *format, ...)
{
    char outstring[256];
    memset(outstring, 0, sizeof(outstring));

    try
    {
        va_list args = {0};
        va_start(args, format); //args = (va_list) (&format+1);

        vsprintf(outstring, format, args);

        va_end(args);

        OutputDebugString(outstring);
    }
    catch (...) //most likely reference val arg error (va_list doesn't support ref args)
    {
        OutputDebugString("[OutputDebugStringN] Something went wrong\n");
    }
} 
```

每次发送参考值参数时，我都会收到“Editor.exe 中发生‘System.AccessViolationException’类型的未处理异常”错误消息；这是完全可以理解的，但我想知道如何将它封装在一个可能的 try catch 语句中，以防止错误关闭我的整个程序。（以上不起作用）

我目前正在从我的 c# 编辑器中调用自制的 c++ dll（具有上述功能）。

这是c#代码：

```
private void ComponentDispatcher_ThreadIdle(object sender, EventArgs e)
    {
        //render display window (if something is not blocking it)
        if (renderViewHost.Update)
        {
            try { NativeMethods.UpdateRenderWindow(); }
            catch (Exception exc)
            { Debug.WriteLine("[ThreadIdle::UpdateRenderWindow] Exception caught: {0}" + exc); }
        }
    } 
```

我只是觉得打印调试字符串的函数本身就有错误是不可接受的。有任何想法吗？欢迎所有关于不良代码/观察的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:42:11.250

根据 C++ 标准，使用 va_start 传递引用参数在 C++ 中是未定义的行为。这意味着您无法预测编译器会做什么。即使某些东西在这个编译器中有效，它也可能不适用于另一个编译器。它甚至可能不适用于同一编译器的下一个版本。

也就是说，可能有特定于平台的构造可以帮助您导致异常。例如。在 Windows 上，您应该能够使用[_try */* _except](http://msdn.microsoft.com/en-us/library/s58ftw19%28v=vs.80%29.aspx)来捕获异常。但是请注意，这是未定义的行为 - 即使它在此版本的编译器中工作，在下一个版本中，va_start 可能会决定做一些完全不同的事情，这可能会导致其他错误，而不是可能被捕获的崩溃`__try/__except`

# gcc - 编译没有优化？尽可能安全？

> ID：13318162
> 
> 赞同：1
> 
> 时间：2012-11-10T00:57:38.247
> 
> 标签：gcc, compiler-optimization, compiler-flags

我有一些代码表现得很奇怪。奇怪的人指责我的输出并没有真正发生（我希望这会让我的生活更轻松）。该代码在 Windows（ms vc++，gcc）中运行良好，但在 linux（gcc，clang）上失败。

我目前编译`g++ -g -std=c++0x -Wall -c file.cpp`有什么比这更安全的吗？哦，这个段错误（在linux上）即使没有任何警告......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:05:19.510

Seg fault 表示运行时错误，例如堆损坏。无论您使用何种编译选项，它都无助于捕捉所有可能的运行时错误和问题。

*即任何*一组gcc 选项都没有*catch-all-errors*选项。

 *您可以使用静态分析器、valgrind 等工具，也可以检查出现段错误的代码。*

# playframework - 替换静态资产中的简单变量

> ID：13318168
> 
> 赞同：1
> 
> 时间：2012-11-10T00:58:17.140
> 
> 标签：playframework, playframework-2.0, sbt

我想在构建时在静态资产（html、css、js）中替换一些简单的变量（例如版本号或 CDN URL 前缀）。Play 2.x 本身无法做到这一点，但也许有一个通用的 sbt 任务可以在文件中进行变量插值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T06:58:42.037

您可以使用[sbt-editsource](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDYQFjAA&url=https://github.com/bmc/sbt-editsource&ei=VPydUIifJ4Xe4QST5YGABA&usg=AFQjCNEKGUNa6MNkF33bVJmtkBvxLOaZTw&sig2=9OcQYw8ZNK5ZohNnCjkNug)插件。它对源文本进行简单的变量替换。您需要将源目录设置为静态资产所在的位置。这是一个[详细的指南](http://software.clapper.org/sbt-editsource/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T15:01:40.510

虽然我不知道您的需求，并且可能 Kim 的回答已经足够好了，但您也可以通过 application.conf + 小解析方法使 CDN 可配置：

`conf/application.conf`：

```
cdn.cdn1="http://cdn1.domain.tld/"
cdn.cdn2="http://cdn2.domain.tld/" 
```

`Application.java`

```
public static String cdnResource(String cdnId, String filePath) {
    return Play.application().configuration().getString("cdn."+cdnId) + filePath;
} 
```

用法：

```
<script src='@Application.cdnResource("cdn1", "bootstrap/js/bootstrap.min.js")' type="text/javascript"></script>
...
<img src='@Application.cdnResource("cdn2", "template/images/logo.png")' alt="" > 
```

# html - 具有流体布局内容的方形 DIV

> ID：13318169
> 
> 赞同：1
> 
> 时间：2012-11-10T00:58:17.883
> 
> 标签：html, css, fluid-layout

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:17:13.783

这是我实际上已经搞砸了一段时间的事情，并且提出了一个准（但不完全）hacky，仅CSS的解决方案，似乎在过去十年中适用于大多数浏览器。诀窍是使用图像，并以一种棘手的方式定位。考虑以下（简化）您的代码。

标记：

```
<div class="sqr_box">
    your content goes here!
</div> 
```

CSS：

```
.sqr_box
{
    width: 50%; /* or 100px, or 20em, or whatever you want */
    border: solid 2px pink;
    background-color: grey;
    color: white;
} 
```

现在，我们不能用百分比来设置高度，所以我们不会；相反，首先我们将进入 Photoshop，并制作一个 2x2 像素、透明或背景色的图像。接下来，我们将以下内容添加到您的标记中：

```
<div class="sqr_box">
    <img src="images/sizers/2x2.png" class="sizer">
    <div class="content">your content goes here!</div>
</div> 
```

这给你的CSS：

```
.sqr_box
{
    width: 50%; /* or 100px, or 20em, or whatever you want */
    position: relative; /* static positioning is less than ideal for this scenario */
}

.sqr_box > img.sizer
{
    display: block; /* images default to an inline-block like thing */
    width: 100%;
    height: auto; /* CLUTCH!!! this ensures that the image's height changes to maintain proportions with it's width */
    visibility: hidden;
}

.sqr_box > .content
{
    position: absolute;
    top: 0;
    left: 0;

    width: 100%;
    height: 100%;  /* Our parent element now has a dynamically assigned height, this will work */

    border: solid 2px pink;
    background-color: grey;
    color: white;
} 
```

最重要的是，这适用于您想要的任何尺寸比例的盒子！只需改变图像的比例！

希望这一切在 3 个月后仍然与您相关。

-沙

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T07:34:48.427

将所有四列放在一个 div 中。将该 div 设置为 100% 宽度并将字体大小设置为 100em

让你的四列中的每一列都有 25em 而不是 25% 的宽度

将您的徽标宽度和高度分别设置为 25em

# google-chrome-extension - 是否可以将链接放在 chrome 桌面通知中

> ID：13318171
> 
> 赞同：1
> 
> 时间：2012-11-10T00:58:23.313
> 
> 标签：google-chrome-extension

我正在制作一个 chrome 扩展程序，它显示特定事件的桌面通知。我可以很好地接收和显示桌面通知，但是当我尝试将属性标签放入通知时出现问题。Chrome 似乎只是将它们解释为纯文本，而不是将文本作为标签附加到通知的 DOM，从而导致通知的内容只是 html 源代码。

有什么办法可以让我的邮件正文附加为 HTML 而不仅仅是文本，或者我只是运气不好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T05:50:26.327

以前可以，现在不行了。但是您可以使用“丰富通知”并将链接放在按钮上。有关详细信息，请参阅[https://stackoverflow.com/a/13328513/488287](https://stackoverflow.com/a/13328513/488287)。

# cuda - 我们应该在 CUDA 中将宏放在 __global__ 函数的外部还是内部？

> ID：13318175
> 
> 赞同：0
> 
> 时间：2012-11-10T00:58:53.583
> 
> 标签：cuda

我的 CUDA 内核看起来像这样。

```
#define MY_AWESOME_MACRO(foo, bar) (foo * bar * 123 + 456)
__global__ void my_CUDA_kernel(int* cool, float* beans) {
    // Some computation.
} 
```

我应该将宏放在函数内部还是外部？我用谷歌搜索了一下，有些人两者都做。以一种方式或另一种方式这样做有什么害处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T06:51:02.013

从概念上讲，没有区别。您可以在文件中的任何位置定义宏。

当我使用 Compute Visual Profiler 时，在外部定义宏的代码比另一个运行得更快。我建议您对它们都使用分析器并检查哪个适合您的要求。

# jquery - 简单的ajax请求在ie8中不起作用

> ID：13318178
> 
> 赞同：0
> 
> 时间：2012-11-10T00:59:29.943
> 
> 标签：jquery, ajax, internet-explorer-8

`select`当用户更改元素时，我正在尝试执行简单的 ajax 请求。

一切都是通过 jquery .ajax 完成的。当前发生的事情（并且在除ie之外的所有内容中都有效）是：ajax加载一个.html文件，通过它搜索`select`元素提交的值并替换`.results`所选元素中的信息。这是代码片段。我想我已经包含了所有相关的内容。

```
var results = $('.results');
var selector = $('.location-selector');

selector.change(function() {

    var selected = selector.val();
    var dealers = $('.results .dealer');

    $.ajax({
        type: 'GET',
        url: 'dealers.html',
        success: function(data) {
            var test = '.' + selected;
            var search = $(data).filter(test);

            results.animate({
                opacity: '0'
            },
            500, function() {
                results.empty().append(search).animate({
                    opacity: '1'
                },
                500).show();
                $('.results p').linkify({
                    target: "_blank"
                });
                console.log('done');
            });
        },
        dataType: "text"
    });

}); 
```

我这辈子都想不通。我什至在控制台中看到“完成”消息。我感谢任何人可以提供的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:46:50.113

问题解决了：

我正在加载的 html 有一个未关闭的 div 标签。FML。

# c++ - 如何在 Qt 中创建类似 Textmate 的侧面板

> ID：13318179
> 
> 赞同：0
> 
> 时间：2012-11-10T00:59:43.623
> 
> 标签：c++, qt, user-interface, qwidget

如何使用 C++/Qt 在 Textmate 中创建类似于文件资源管理器的侧面板？更准确地说，如下图的左侧面板：

[![textmate 侧面板](../Images/e93f6d862e62454cd25a0d98d7ef49b4.png)](https://i.stack.imgur.com/aJUMw.png)
[（来源：[garzaincredible.com](http://garzaincredible.com/wp-content/uploads/2010/12/624TextMate-Scaled.png)）]

最接近我需要的东西似乎是`QDockWidget`，但我仍然不知道如何使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T15:26:53.493

这就是所谓的“抽屉”。在 Qt 中，有一个特殊的[`Qt::WindowFlags`](http://doc.qt.digia.com/4.7/qt.html#WindowType-enum)标志：`Qt::Drawer`. 目的是在 QDockWidget 上使用这个标志：

```
QDockWidget* dock = new QDockWidget(parent, Qt::Drawer); 
```

这将为停靠小部件创建一个 Cocoa 抽屉。您无需确保`Qt::Drawer`仅在 OS X 上使用；该标志在其他平台上被简单地忽略，因此您可以无条件地指定它。

# css - 居中文本并向右浮动 div

> ID：13318184
> 
> 赞同：9
> 
> 时间：2012-11-10T01:00:59.153
> 
> 标签：css, html, styles

我有一个容器 div，其中包含我想要居中的文本。我还想在向右浮动的容器中插入一个 div，如下所示：

```
<div id="container" style="text-align:center">
  Text
  <div id="child" style="float:right"></div>
</div> 
```

不幸的是，文本不再相对于容器居中，而是向左移动了子元素的宽度。

有谁知道如何使文本居中，同时保持 div 包含在右侧？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-10T01:10:12.517

像这样的东西...

```
<div style='position:relative;'>
  my centered text
  <div style='position:absolute;right:0;top:0'>
    my right div
  </div>
</div> 
```

您显然可以将内联样式放入 CSS 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:05:29.553

可能是这个？？创建 3 个相等的部分。左中右？？

```
<div id="container">
<div id="child1" style="float:right width: 30px;"></div>
<div id="child2" style="float:right width: 30px; text-align:center;">TEXT</div>
<div id="child3" style="float:right width: 30px;"></div>
</div> 
```

# c - 如何从文件中读取两个字符串并将它们存储在两个单独的数组中

> ID：13318187
> 
> 赞同：-1
> 
> 时间：2012-11-10T01:01:24.063
> 
> 标签：c, arrays, string, input, output

期待帮助...我需要从文本文件中读取两个字符串并将它们存储到两个单独的数组中。我搜索了很多代码，其中一个有效，所以我尝试修改它以读取两个字符串。这是我的代码：

```
int main(){
int i = 0;
int BUFSIZE = 1000;
char* words[20];
char* words2[20];
FILE *fp = fopen("input1.txt", "r");
FILE *fp2 = fopen("input2.txt", "r");
if (fp == 0){
    fprintf(stderr, "Error while opening");
    return 0;
}
words[i] = (char*)malloc(BUFSIZE);
words2[i] = (char*)malloc(BUFSIZE);
while (fgets(words[i], BUFSIZE, fp)) {
    i++;
    words[i] = (char*)malloc(BUFSIZE);
} 
while (fgets(words2[i], BUFSIZE, fp2)) {
    i++;
    words2[i] = (char*)malloc(BUFSIZE);
} 
printf("Output: \n");
srand(time(NULL));
int j = rand()%i;
int k = (j+1)%i;
fflush(stdout);
printf("%d - %s %d -%s", j, words[j], k, words[k]); 

int x;
for(x = 0; x<i; x++)
   free(words[x]);
   free(words2[x]);
scanf("%d", x);
fclose(fp);
fclose(fp2);
return 0;
} 
```

但它不会工作。有人知道为什么吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:14:13.433

在第二个循环之前重置 i = 0 并将你的 free(x) 代码括在花括号中

```
int main()
{
    int i = 0;
    int BUFSIZE = 1000;
    char* words[20];
    char* words2[20];
    FILE *fp = fopen("input1.txt", "r");
    FILE *fp2 = fopen("input2.txt", "r");
    if (fp == 0){
        fprintf(stderr, "Error while opening");
        return 0;
    }
    words[i] = (char*)malloc(BUFSIZE);
    words2[i] = (char*)malloc(BUFSIZE);
    while (fgets(words[i], BUFSIZE, fp)) {
        i++;
        words[i] = (char*)malloc(BUFSIZE);
    } 

    // reset i back to zero
    i = 0; 
    while (fgets(words2[i], BUFSIZE, fp2)) {
        i++;
        words2[i] = (char*)malloc(BUFSIZE);
    } 

    printf("Output: \n");
    srand(time(NULL));
    int j = rand()%i;
    int k = (j+1)%i;
    fflush(stdout);
    printf("%d - %s %d -%s", j, words[j], k, words[k]); 

    int x;
    for(x = 0; x<i; x++){
       free(words[x]);
       free(words2[x]);
    }
    scanf("%d", x);
    fclose(fp);
    fclose(fp2);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:10:43.250

需要更多关于正在发生的事情的信息。您是否收到编译错误、运行时消息？你检查文件是否存在？

此外，应该修复一些问题：

1.  您的第一行应包括 stdio.h

2.  在 for() 的主体周围添加大括号以包含对 free 的两个调用。

3.  您的编译器是否接受您在函数中间的 x 声明？如果没有，请将其移至顶部。

# c# - Windows Server 2003 Enterprise Edition Service Pack 2 上的 StackOverflowException

> ID：13318191
> 
> 赞同：0
> 
> 时间：2012-11-10T01:02:37.523
> 
> 标签：c#, com, stack-overflow

我已经构建了一个独立的控制台应用程序，该应用程序仅在安装在 Windows Server 2003 Enterprise Edition Service Pack 2 测试机器上时才会引发间歇性 StackOverFlow 异常。代码过于复杂，无法发布，但详细信息如下：
源代码是 C# VS 2010。源代码
中没有递归调用，但它确实使用了工作线程。
发生 StackOverflowException 时，正在运行的进程不会终止。
当异常发生时，它将始终在同一位置发生。
发生异常时，几乎总是在代码尝试跨 COM 边界初始化时发生，即： CAsset asset = new CAsset() 其中 CAsset 是用 C++ 编写的 COM 对象。
用调用 System.Activator.CreateInstance 替换直接初始化

```
 System.Type assetType = System.Type.GetTypeFromProgID("GDMTCommon.HansenAsset");
            object activated = System.Activator.CreateInstance(assetType);
            asset = activated as CHansenAsset; 
```

不能解决问题，但它确实将故障点移动到代码中的不同位置。上面的代码也没有抛出错误，但是直接转换后资产变量为空。此实例是在初始化 COM 对象时未发生故障的一次。
最令人困惑的行为是我可以在测试机器上的两组不同的源数据上运行该工具，对于一组源数据，代码将运行完成而不会出错，而另一组代码则失败。
我在两台不同的 Windows 7 测试机器上安装了相同的工具，但无法在任何一台机器上重现错误。我还在 Windows Server 2003 Standard Edition Service Pack 2 测试机器上安装了该工具，但无法在该机器上重现错误。
大量搜索发现了其他几个问题，即在一个操作系统上运行的代码在安装在 Windows Server 2003 上时开始抛出 StackOverflowExceptions，但我没有看到任何明确的解决方案。
我发现这篇知识库文章似乎描述了我的问题： http:
[//support.microsoft.com/kb/915750](http://support.microsoft.com/kb/915750)
但根据文章，问题已在 Service Pack 2 中得到解决，并且我已验证 Service Pack 2 已安装在测试机上。
任何帮助将不胜感激。
问候，
杰伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T21:50:08.973

运行 Windows 更新并将所有可用更新应用到机器解决了堆栈溢出问题。仍然不确定是什么首先导致了他们。由于这是我无法访问的客户端计算机，因此我不得不等待他们应用更新。

# shell - 从子 shell 退出 shell

> ID：13318193
> 
> 赞同：2
> 
> 时间：2012-11-10T01:02:58.437
> 
> 标签：shell

我相信我在一个子shell中调用 exit 会导致我的程序继续：

```
#!/bin/bash
grep str file | while read line
do
        exit 0
done
echo "String that should not really show up!" 
```

知道如何退出主程序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T01:14:40.440

您可以简单地重组以避免子shell - 或者更确切地说，`grep`在子shell 内部运行而不是`while read`循环。

```
#!/bin/bash
while read line; do
  exit 1
done < <(grep str file) 
```

请注意，这`<()`是仅限 bash 的语法，不适用于`/bin/sh`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T01:13:44.867

通常，您可以检查生成的子 shell 的返回码，以查看主 main 是否应该继续。

例如：

```
#!/bin/bash

grep str file | while read line
do
        exit 1
done

if [[ $? == 1 ]]; then
    exit 1
fi

echo "String that should not really show up!" 
```

不会打印消息，因为 subshel​​l 以 code 退出`1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:18:30.057

您可以通过从您的子外壳发送信号来“退出”您的外壳：替换`exit 0`为`kill -1 $PPID`

但我不推荐这种方法。我建议你的 subshel​​l 返回一个特殊的意义值，比如`exit 1`

```
#!/bin/bash
grep str file | while read line
do
        exit 1
done
exit 0 
```

那么你可以通过 $ 来检查你的 subshel​​l 的返回值吗？

喜欢`subshell.sh ;if [[ $? == 1 ]]; then exit 1 ;fi`

或者干脆`subshell.sh || exit`

# c# - 绘制图形不起作用

> ID：13318194
> 
> 赞同：0
> 
> 时间：2012-11-10T01:03:04.420
> 
> 标签：c#

我有这段代码，它使表单始终位于顶部，透明并单击。

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Diagnostics;
    using System.Runtime.InteropServices;

    namespace HyperBox
    {

public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();

        this.TopMost = true; // make the form always on top
        this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None; // hidden border
        this.WindowState = FormWindowState.Maximized; // maximized
        this.MinimizeBox = this.MaximizeBox = false; // not allowed to be minimized
        this.MinimumSize = this.MaximumSize = this.Size; // not allowed to be resized
        this.TransparencyKey = this.BackColor = Color.Red; // the color key to transparent, choose a color that you don't use

        // Set the form click-through
        int initialStyle = GetWindowLong(this.Handle, -20);
        SetWindowLong(this.Handle, -20, initialStyle | 0x80000 | 0x20);
    }

    [System.Runtime.InteropServices.DllImport("user32.dll", SetLastError = true)]
    static extern int GetWindowLong(IntPtr hWnd, int nIndex);

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags);

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    static extern int SetParent(int hWndChild, int hWndNewParent);

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern IntPtr FindWindow(
     [MarshalAs(UnmanagedType.LPTStr)] string lpClassName,
     [MarshalAs(UnmanagedType.LPTStr)] string lpWindowName);
    [DllImport("user32.dll")]
    public static extern IntPtr SetParent(
     IntPtr hWndChild,      // handle to window
     IntPtr hWndNewParent   // new parent window
     );

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);
        // draw what you want
        e.Graphics.FillRectangle(Brushes.Red, new Rectangle((SystemInformation.WorkingArea.Width / 2) - 4, (SystemInformation.WorkingArea.Height / 2) - 20, 8, 40));
        e.Graphics.FillRectangle(Brushes.Red, new Rectangle((SystemInformation.WorkingArea.Width / 2) - 20, (SystemInformation.WorkingArea.Height / 2) - 4, 40, 8));

    }
    private void Form1_MouseMove(object sender, MouseEventArgs e)
    {

    }

    private void Form1_Paint(object sender, PaintEventArgs e)
    {

    }

    private void Form1_Load(object sender, EventArgs e)
    {

        IntPtr hwndf = this.Handle;
        IntPtr hwndParent = FindWindow("chrome.exe", null);
        SetParent(hwndf, hwndParent);

    }

}
    } 
```

问题是当我绘制图形时，它什么也没画。当坐标在 100~ 左右时，它可以工作。但是当它执行上述方法时，什么也没有发生。根本就连一个像素都没有。有人可以解释为什么会发生这种情况，或者重新发布一个固定的片段，谢谢。莱恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:58:34.237

`OnPaint`为您的表单提供图形对象，而不是屏幕。您正在根据系统的工作区域填充矩形，而不是表单。您将需要调整矩形坐标并将表单放置在您希望图形出现的位置。位置为 的矩形`(0, 0)`是表单客户区的左上角。您还应该能够通过调用`ClientRectangle`在基 Form 类上公开的来访问该矩形。

看看这个问题以在表单外绘图：[如果](https://stackoverflow.com/questions/3379306/vc-draw-paint-outside-form) 您不想在表单上绘画，那应该让您朝着正确的方向开始，但重新定位和调整表单大小可能会更容易如所须。

**编辑**在调试问题时至少添加某种边框可能是明智的。这将帮助您查看表单的位置以及它在哪个监视器上。然后，您可以在 OnPaint 中的断点检查您的数字，以确保您正确创建了矩形，但是，确保您在表单的客户区域内绘画应该可以解决您的问题。

# visual-c++ - 计算二值图像中的前景对象

> ID：13318197
> 
> 赞同：2
> 
> 时间：2012-11-10T01:03:28.513
> 
> 标签：visual-c++, image-processing, opencv, computer-vision

我有一个图像序列（视频）。我想计算图像序列中的对象数量。但主要目标是将它们计数一次，这意味着不仅仅是在每一帧中，因为一个对象可能存在于几个帧中。我的想法是在物体退出屏幕时对它们进行计数，因为遮挡较少。我正在考虑通过扫描图像底部的非零像素来做到这一点。

我有一个 CV_FILLED 二进制图像（来自矩形函数），我想在其中进行扫描，然后在找到 abject 时在对象上创建一个实例。但是这种扫描不会扫描水平线上的每一个像素，只是扫描某些部分。

就像我们可以在范围上做它，比如某些列，然后跳过一个边距。

附上我拥有的示例二进制图像![CV_FILLED 二值图像](../Images/781a5e02138b3c9931d53218c394ebba.png)。这是从提要中获得的图像。我不想只计算这张图片中的物体，还要计算那些仍在到来的物体。

此处附上检测到的对象的全图。欢迎您的指导或建设性批评 *我不想使用 CVBlob

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T08:23:39.747

如果您不想使用 cvBlobLib，您可以使用 OpenCV 中的轮廓检测。

网站上有教程[。](http://docs.opencv.org/doc/tutorials/imgproc/shapedescriptors/find_contours/find_contours.html)

该方法的文档在[这里](http://opencv.willowgarage.com/documentation/python/imgproc_structural_analysis_and_shape_descriptors.html#findcontours)。您的图像看起来很简单，但是如果您得到带有遮挡的斑点，因此您想查看 CV_RETR_EXTERNAL 常量以仅获取外部轮廓。

这就是我通常使用的方法，尽管它需要更多的工作才能使用该方法的结果。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T20:38:43.797

如果正方形在底部不重叠，我建议如下：

扫描图像的最底行并识别那些连接的白色像素。每条白线将对应一个正方形。保存白线段的中心及其长度。在下一帧中，执行相同操作并将相应的线段与前一帧相关联（长度相同且中心非常接近）。当您再也找不到相应的线段时，正方形已移出图像，这意味着您可以将正方形计数器增加一。请注意，线的左右两端的线段的长度将随着每一帧而减小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T09:42:38.073

谢谢各位。我已经设法解决了这个问题。我沿着正方形的路径使用了小的 ROI，并`countNonZero()`在 ROI 内找到。

我不断检查`boolean`变量以查看 ROI 是否仍有白色像素。如果不是，则递增计数器。工作得很好，我能够数数。

谢谢您的输入...

# opengl - 是否可以在不同的机器上编译？

> ID：13318201
> 
> 赞同：0
> 
> 时间：2012-11-10T01:04:25.470
> 
> 标签：opengl

正在编译 OpenGL 程序，在 VirtualBox 机器 Windows XP 上制作，可能在不同的机器上，例如，如果我在虚拟机上制作程序并想将编译过程发送到作为主机的 Ubuntu。

我在问这个，因为我正在寻找一种将主机的 GPU 用于虚拟机的方法，但我无法做到这一点，找不到任何可能的解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:49:43.993

> 我正在寻找一种将主机的 GPU 用于虚拟机的方法

程序构建的位置和操作系统与此特定问题无关。OpenGL 只是一种 API 规范，当您编译程序以使用 OpenGL 时，它只会遵循 API，但不包含实际上与 GPU 对话的代码片段。这就是驱动程序和它们提供的 OpenGL 实现所做的。

您需要的是虚拟机中的驱动程序，它公开 OpenGL API 并将命令传递给主机 GPU。

# python - Python 服务/守护进程

> ID：13318206
> 
> 赞同：3
> 
> 时间：2012-11-10T01:05:24.797
> 
> 标签：python, linux, service, python-2.7, daemon

我正在编写一个 Python 脚本，我需要在启动时启动它（一旦启动它就应该永远运行）。我希望能够通过运行以下命令来管理服务：

```
sudo service my-service (and either start, stop, restart, etc.) 
```

我已经阅读了很多内容，并且真的很想完成我的项目。我看到了这一点，但如果它要在[Linux Start-up Script](http://peterlairdtech.blogspot.com/2010/05/example-linux-startup-service-for.html)中运行，则需要帮助来实现它。我什至不知道从哪里开始，我真的不知道如何在 bash 中编程，但我对所有解决方案持开放态度。提前谢谢你，我感谢所有的回复！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T09:42:40.347

看看[zdaemon](http://pypi.python.org/pypi/zdaemon)。它提供了一种简单的方式来守护 Python 进程。

然后您可以根据您的操作系统为其编写一个 init.d 脚本。或者你可以使用像 Upstart、supervisord 这样的工具来控制守护进程。

我的 init.d 脚本（在 centos 5.8 上）如下所示：

```
. /etc/rc.d/init.d/functions

. /etc/sysconfig/network

APP_PATH=/path/to/your/app
PYTHON=/usr/local/bin/python
USER=user

start() {
    cd $APP_PATH
    zdaemon -C app.zdconf start
}

stop() {
    cd $APP_PATH
    zdaemon -C app.zdconf stop
}

check_status() {
        cd $APP_PATH
        zdaemon -C app.zdconf status
}

case "$1" in
  start)
        start
        ;;
  stop)
        stop
        ;;
  status)
        check_status
        ;;
  restart)
        stop
        start
        ;;
  *)

esac
exit 0 
```

其中 app.zdconf 是 zdaemon 配置文件。

# dart - 如何从飞镖范围内获取随机数？

> ID：13318207
> 
> 赞同：79
> 
> 时间：2012-11-10T01:05:25.063
> 
> 标签：dart

如何获得类似于 c# Random.Next(int min, int max); 范围内的随机数

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-11-10T01:16:50.683

```
import 'dart:math';

final _random = new Random();

/**
 * Generates a positive random integer uniformly distributed on the range
 * from [min], inclusive, to [max], exclusive.
 */
int next(int min, int max) => min + _random.nextInt(max - min); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-11-10T01:08:34.847

范围可以用一个简单的公式找到，如下所示

```
Random rnd;
int min = 5;
int max = 10;
rnd = new Random();
r = min + rnd.nextInt(max - min);
print("$r is in the range of $min and $max"); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2019-12-10T19:33:34.503

您可以通过`Random`类 object来实现它`random.nextInt(max)`。该`nextInt()`方法需要最大限制。随机数从 开始，`0`最大限制本身是排他的。

```
import 'dart:math';
Random random = new Random();
int randomNumber = random.nextInt(100); // from 0 upto 99 included 
```

如果要添加最小限制，请将最小限制添加到结果中

```
int randomNumber = random.nextInt(90) + 10; // from 10 upto 99 included 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2020-08-24T20:26:23.453

这真的很晚了，但这对于任何仍有疑问的人来说。

获得最小值和最大值之间的随机数的最简单方法如下：

```
import 'dart:math';

int max = 10;

int randomNumber = Random().nextInt(max) + 1; 
```

dart 中的数学模块有一个名为 nextInt 的函数。这将返回一个从 0 （包括 0 ）到 max - 1 （不包括 max ）的整数。我想要一个 1 到 10 的数字，因此我将 1 添加到 nextInt 结果。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-09-27T10:00:35.163

它可以完全按照您的意图通过创建扩展`int`来获得随机 int 值来实现。例如：

```
import 'dart:math';

import 'package:flutter/foundation.dart';

extension RandomInt on int {
  static int generate({int min = 0, @required int max}) {
    final _random = Random();
    return min + _random.nextInt(max - min);
  }
} 
```

您可以像这样在代码中使用它：

```
List<int> rands = [];
for (int j = 0; j < 19; j++) {
  rands.add(RandomInt.generate(max: 50));
} 
```

请注意，不能在类型本身（例如`int.generate(min:10, max:20)`）上调用静态扩展方法，但在此示例中，您必须使用扩展名本身`RandomInt`。有关详细讨论，[请阅读此处](https://github.com/dart-lang/language/issues/723)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-27T15:50:25.867

```
import 'dart:math';

Random rnd = new Random();
// Define min and max value
int min = 1, max = 10;
//Getting range
int num = min + rnd.nextInt(max - min);
print("$num is in the range of $min and $max"); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-08-18T06:43:05.050

生成一个随机整数，均匀分布在从 [min] 到 [max] 的范围内，包括两者。

```
int nextInt(int min, int max) => min + _random.nextInt((max + 1) - min); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-23T21:57:37.257

要在某个范围内生成随机双精度数，请将随机整数乘以随机双精度数。

```
import 'dart:math';
Random random = new Random();
int min = 1, max = 10;
double num = (min + random.nextInt(max - min)) * random.nextDouble(); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-10-05T13:12:38.380

一个更简单的方法是在 Random 中使用 nextInt 方法：

```
// Random 50 to 100:
int min = 50;
int max = 100;
int selection = min + (Random(1).nextInt(max-min)); 
```

[https://api.dartlang.org/stable/2.0.0/dart-math/Random-class.html](https://api.dartlang.org/stable/2.0.0/dart-math/Random-class.html)

# air - 如何使用 adobe air 加密和解密文件？（加密好，但 decrpyt 还没有）

> ID：13318210
> 
> 赞同：1
> 
> 时间：2012-11-10T01:06:14.527
> 
> 标签：air, encryption

我想用 adobe air 加密和解密文件。我成功地用代码加密文件。但我还没有解密加密文件，请帮帮我，我该怎么办？

我正在使用此代码进行加密：

```
import com.hurlant.crypto.symmetric.AESKey;
import com.hurlant.crypto.symmetric.DESKey;
import com.hurlant.util.Hex;
import flash.filesystem.FileStream;
import flash.filesystem.File;
import flash.utils.ByteArray;
import flash.filesystem.FileMode;
import flash.display.BitmapData;
import flash.display.Bitmap;
import com.hurlant.util.ArrayUtil;

stop();

var stream:FileStream;
var stream2:FileStream;
var file:File;

var fileToEncrypt:ByteArray;

encrypt();

function encrypt():void
{
    file = File.applicationDirectory.resolvePath("logo_markatalog.png");

    fileToEncrypt = new ByteArray;

stream = new FileStream();
stream.open( file, FileMode.READ );
stream.readBytes(fileToEncrypt);
stream.close();

var appDir:String = File.applicationDirectory.nativePath;
//file = File(appDir+"logo_markatalog_enc.png");

file = new File(appDir+"/logo_markatalog_enc.png");

var key:ByteArray = Hex.toArray("635232557");
var aes:AESKey = new AESKey(key);

aes.encrypt(fileToEncrypt);

stream2 = new FileStream();
stream2.open( file, FileMode.WRITE );
stream2.writeBytes(fileToEncrypt);
stream2.close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:20:42.453

我不能告诉你你做错了什么，但我可以给你我用来将对象加密到文件中并将它们解密回来的东西。

*someKey* var 是您用于加密和解密的密钥。

*theFileWithEncryptedObject* var 是我在第一个代码部分中保存我的加密对象的文件，我从中读取第二个代码部分中的加密对象。

我在密钥上使用 md5 哈希，这不是必需的。

这是我使用 hurlant.crypto 将对象加密到文件中的方式：

```
var fileStream:FileStream = new FileStream();
fileStream.open(theFileWithEncryptedObject, FileMode.WRITE);
var bytes:ByteArray = new ByteArray();
bytes.writeObject(theObjectToEncrypt);

var key:ByteArray = Hex.toArray(someKey);
var md5:MD5 = new MD5();
key = md5.hash(key);

var pad:IPad = new PKCS5();
var aes:ICipher = Crypto.getCipher("simple-aes-128-cbc", key, pad);
pad.setBlockSize(aes.getBlockSize());
aes.encrypt(bytes);

fileStream.writeBytes(bytes);
fileStream.close(); 
```

在这里我如何解密并从文件中取回我的对象​​：

```
var bytes:ByteArray = new ByteArray();
var fileStream:FileStream = new FileStream();
fileStream.open(theFileWithEncryptedObject, FileMode.READ);
fileStream.readBytes(bytes);
fileStream.close();

var key:ByteArray = Hex.toArray(someKey);
var md5:MD5 = new MD5();
key = md5.hash(key);

var pad:IPad = new PKCS5;
var aes:ICipher = Crypto.getCipher("simple-aes-128-cbc", key, pad);
pad.setBlockSize(aes.getBlockSize());
aes.decrypt(bytes);

var theObjectDecrypted:Object;
bytes.position = 0;
theObjectDecrypted = bytes.readObject(); 
```

希望这可以帮助。

# python - 如何从一个简单的网络应用程序中注销。在 CherryPy，Python

> ID：13318215
> 
> 赞同：2
> 
> 时间：2012-11-10T01:07:16.450
> 
> 标签：python, login, logout, cherrypy

我不熟悉 CherryPy 和 Python，但我需要编写一个非常简单的 Web 应用程序来执行登录 ---> 执行一些命令 ---> 注销。对于登录，我使用以下链接中的代码：

[http://tools.cherrypy.org/wiki/AuthenticationAndAccessRestrictions](http://tools.cherrypy.org/wiki/AuthenticationAndAccessRestrictions)

应用程序是：

```
import cherrypy
import os.path
import struct
from auth import AuthController, require, member_of, name_is

class Server(object):
    led_power=0 
    led_switch=1 #Initial LED on

    _cp_config = {
        'tools.sessions.on': True,
        'tools.auth.on': True
    }   
    auth = AuthController()      
    @cherrypy.expose
    @require()
    def index(self,  switch='', power=''):
        if switch:
            self.led_switch = int(switch)
        if power:
            self.led_power = int(power)  

        html = open('led.html','r').read()

        if self.led_switch:
            print "ON"
        else:
            print "OFF"

        if self.led_power:
            print "Logout"
            cherrypy.session.clear()

        return html
    index.exposed = True

conf = {
    'global' : { 
        'server.socket_host': '0.0.0.0', #0.0.0.0 or specific IP
        'server.socket_port': 8080 #server port
    },

    '/images': { #images served as static files
        'tools.staticdir.on': True,
        'tools.staticdir.dir': os.path.abspath('images')
    },

    '/favicon.ico': {  #favorite icon
        'tools.staticfile.on': True,  
        'tools.staticfile.filename': os.path.abspath("images/bulb.ico")
    }
}
cherrypy.quickstart(Server(), config=conf) 
```

html文件是：

```
<html>
<head>
</head>
<body>
<br>
<a href="?switch=1"><img src="images/on.png"></a>
<a href="?switch=0"><img src="images/off.png"></a>
<p>
<a href="?power=1"><img src="images/Logout.png"></a>
</body>
</html> 
```

一个文件夹包含三个图像。

当我运行应用程序时，我可以在 localhost 上看到带有用户名和密码字段的登录页面，然后我可以访问包含三个按钮“ON、OFF、Logout”的网页。

问题是我必须单击注销按钮两次才能注销，当我再次登录并单击任何按钮（甚至是 ON 或 OFF 按钮）时，页面将注销并再次显示登录页面。我无法以正确的方式注销，请问有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T11:53:38.070

尝试运行此代码。它调用 AuthController().logout() 函数。

```
import cherrypy
import os.path
import struct
from auth import AuthController, require, member_of, name_is

class Server(object):
    led_power=0 
    led_switch=1 #Initial LED on

_cp_config = {
    'tools.sessions.on': True,
    'tools.auth.on': True
}   
auth = AuthController()      
@cherrypy.expose
@require()
def index(self,  switch='', power=''):
    if switch:
        self.led_switch = int(switch)
    if power:
        self.led_power = int(power)  

    html = open('led.html','r').read()

    if self.led_switch:
        print "ON"
    else:
        print "OFF"

    if self.led_power:
        print "Logout"
        AuthController().logout()

        return html
    index.exposed = True

conf = {
    'global' : { 
        'server.socket_host': '0.0.0.0', #0.0.0.0 or specific IP
        'server.socket_port': 8080 #server port
    },

    '/images': { #images served as static files
        'tools.staticdir.on': True,
        'tools.staticdir.dir': os.path.abspath('images')
    },

    '/favicon.ico': {  #favorite icon
        'tools.staticfile.on': True,  
        'tools.staticfile.filename': os.path.abspath("images/bulb.ico")
    }
}
cherrypy.quickstart(Server(), config=conf) 
```

希望这可以帮助。

安德鲁

# mysql - “#1064 - 您的 SQL 语法有错误”当我更改表时

> ID：13318217
> 
> 赞同：-1
> 
> 时间：2012-11-10T01:07:25.500
> 
> 标签：mysql

当我尝试更改表时，出现此错误：

> `#1064`- 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“PRIMARY KEY (id)”附近使用正确的语法

这是我的查询：

```
ALTER TABLE gk
ADD COLUMN id MEDIUMINT NOT NULL AUTO_INCREMENT,  PRIMARY KEY (id); 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:11:26.247

在一个`ALTER TABLE`语句中，单个`ADD`规范不能同时添加列和约束；您需要将它们放在单独的规范中：

```
ALTER TABLE gk ADD COLUMN id MEDIUMINT NOT NULL AUTO_INCREMENT,
               ADD PRIMARY KEY (id); 
```

（参见[*MySQL 5.6 参考手册*](http://dev.mysql.com/doc/refman/5.6/en/alter-table.html)[中的第13.1.6 节“`ALTER TABLE`语法”](http://dev.mysql.com/doc/refman/5.6/en/alter-table.html)*。）*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:15:03.543

```
ALTER TABLE gk  ADD id MEDIUMINT NOT NULL AUTO_INCREMENT PRIMARY KEY 
```*

# java - 播放框架表单提交

> ID：13318227
> 
> 赞同：1
> 
> 时间：2012-11-10T01:09:13.930
> 
> 标签：java, scala, playframework

我遵循了 java play framework 教程并创建了 todo 任务列表，这是本教程的结果：

[http://www.playframework.org/documentation/2.0.4/JavaTodoList](http://www.playframework.org/documentation/2.0.4/JavaTodoList)

我想稍微修改这个项目，以便我有另外两个输入，而不是标签输入表单，起始位置和结束位置。

*首先，我在Models/*的 java 类中包含了我需要的额外变量

 *```
 @Id
    public Long id;

    @Required
    public String starting_location;

    @Required
    public String end_location; 
```

我还将它添加到 index.scala.html 文件中：

```
@form(routes.Application.newJourney()) {

    @inputText(journeyForm("Starting Location"))
    @inputText(journeyForm("End Location")) 
    <input type="submit" value="Create">
} 
```

我得到表单字段“起始位置”和“结束位置”按预期显示，但是当我单击提交时，旅程总数（或播放示例中描述的任务）不会增加，也不会添加到列表中可以删除的当前旅程。

任何帮助表示赞赏，如果需要，我可以发布完整的源代码。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T08:43:36.630

助手 inputText 记录[在这里](http://www.playframework.org/documentation/api/2.0.4/scala/index.html#views.html.helper.inputText%24)。

您在字段名称应位于的位置放置一个标签。

这应该有效：

```
@inputText(
    journeyForm("starting_location"), 
    '_label -> "Starting Location"
) 
```*

# java - 服务器套接字读取长字符串

> ID：13318229
> 
> 赞同：1
> 
> 时间：2012-11-10T01:09:44.240
> 
> 标签：java, sockets, serversocket

我有一个关于从服务器套接字读取字节的问题。我在网络上使用读写 8192b 字节的默认值。问题是有时您需要发送大于缓冲区容量的文件。为了避免增加缓冲区，因为您可以知道那些在不同时间到达的数据包是相关的？

## 客户端片段：

```
{
String c = xxxxx //imagine that it an string format JSON with 64000bites length
OutputStream wsOS = socket.getOutputStream();
wsOS.write(new String(data,"UTF-8"));
wsOS.flush();
} 
```

## 当服务器端收到 JSON 字符串时：

```
{

 byte[] buffer = new byte[8192];
 int size = 0;

 StringBuilder str = new StringBuilder();

 size = wsIS.read(buffer);

if (size > 0) {

    str.append(new String(buffer, "UTF-8")
            .substring(0, size));

    while (wsIS.available() > 0) {
        size = wsIS.read(buffer);
        str.append(new String(buffer, "UTF-8")
                .substring(0, size));
    }

}
} 
```

## 问题：

所有字符串都到达服务器但在块 8192b - 我无法连接字符串，因为我不知道最后一个字符串 JSON 是否是预览的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:18:59.293

即使您增加缓冲区大小，也不能保证在一次调用中读取整个字符串`wsIS.read`。

这意味着您必须有某种机制来知道前一个字符串的结束位置和新字符串的开始位置。一些选择如下：

1.  使用[`ObjectOutputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)/`ObjectInputStream`
2.  在实际写入字符之前写入字符数。在阅读方面，阅读长度，然后阅读那些许多字符

# macos - 如何在 Mac 上使用 crontab 每小时通过 ftp 上传特定文件一次？

> ID：13318235
> 
> 赞同：-2
> 
> 时间：2012-11-10T01:11:05.060
> 
> 标签：macos, ftp, crontab

我的 Mac 上有一个特定文件，我想每小时通过 ftp 将其上传到我的网站空间。我希望它在后台自动发生，没有任何迹象表明它正在上传。我读了一些关于 crontab 的东西，但还没有弄清楚如何使用它。有人可以花点时间向我解释一下吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:14:29.843

你没有说你试过什么，所以我猜你没有。我们在谷歌的朋友有一个神奇的东西，叫做搜索引擎。我在“mac crontab”上搜索并获得了大约 1,000,000 次点击。

第一个是[克罗尼克斯](http://www.macupdate.com/app/mac/7486/cronnix)。它是 GUI，因此您甚至可能不必 RTM。

讽刺的少了点……

Cron 非常基础。它每分钟运行一次，看看是否需要做任何事情。有用户特定的 crontab 和系统 crontab，唯一的区别是系统 crontab 指定了命令运行的用户。以下用户 crontab：

```
#min    hour    mday    month   wday    command
25      2,14     *       *       *      sh path/to/getmybackup.sh 
```

导致备份脚本每天（`*`s）在 0225 和 1425（本地）运行。您可以使用很多快捷方式符号，因此我真的建议您阅读[cron 手册页](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/crontab.1.html)和[crontab (5) 手册页](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man5/crontab.5.html#//apple_ref/doc/man/5/crontab)。我怀疑 cronnix 使其中一些变得不那么神秘了。

# vb.net - 如何以编程方式从 ReadOnly RichTextBox 中删除文本？

> ID：13318238
> 
> 赞同：6
> 
> 时间：2012-11-10T01:12:38.960
> 
> 标签：vb.net, richtextbox

以下代码旨在在`ReadOnly`RichTextBox 中维护一个文本缓冲区，其中存储了最大数量的字符，并且始终保持滚动到底部。它流式传输实时日志。

但是在我试图保持最大字符数的过程中，`rtMessages.TextLength()`之后并没有改变`rtMessages.SelectedText = String.Empty`，因此，如果没有防御`If`块，我最终会出现一个无限循环，试图重复删除缓冲区的第一行。

当我删除`ReadOnly`-ness 时`RichTextBox`，此功能成功。似乎有点奇怪，既然`AppendText`成功了，但我明白选择是另一种野兽。

**我可以让它以`ReadOnly` `RichTextBox`编程方式*修改*吗？**

```
Private Sub onNewData(ByRef data As String) Handles _server.clientSentData

    ' Add new text
    rtMessages.SelectionStart = rtMessages.TextLength()
    rtMessages.AppendText(data)

    ' Delete oldest text line-by-line until the whole buffer is shorter than MAX_TEXT_LENGTH characters
    Const MAX_TEXT_LENGTH = 200
    Dim textLength = rtMessages.TextLength()
    While textLength > MAX_TEXT_LENGTH
        Dim i As Int16 = 0
        Do While rtMessages.GetLineFromCharIndex(i) < 1
            i += 1
        Loop

        rtMessages.Select()
        rtMessages.SelectionStart = 0
        rtMessages.SelectionLength = i
        rtMessages.SelectedText = String.Empty
        rtMessages.SelectionLength = 0

        If rtMessages.TextLength() = textLength Then
            rtMessages.Clear()
            rtMessages.AppendText("[buffer trimming algorithm failed]")
            Exit While
        End If

        textLength = rtMessages.TextLength()
    End While

    ' Scroll down
    rtMessages.SelectionStart = rtMessages.TextLength()
    rtMessages.ScrollToCaret()
End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-30T17:17:13.253

虽然尝试在 ReadOnly RichTextBox 中替换 SelectedText 不起作用，但使用 SelectedRtf 确实有效：

```
 'rtMessages.Select()
  'rtMessages.SelectionStart = 0
  'rtMessages.SelectionLength = i
  'rtMessages.SelectedText = String.Empty
  'rtMessages.SelectionLength = 0

  rtMessages.Select(0, i)
  rtMessages.SelectedRtf = "{\rtf1\ansi}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:43:11.113

```
rtMessages.SelectionLength = i - 1 
```

应该替换为

```
rtMessages.SelectionLength = i 
```

编辑#1

通过将 -1 添加到 SelectionLength，您将丢失第一行的最后一个字符。第二次运行时，第一行只有一个字符（第一次运行时错过的那个）。然后，您将尝试删除 0 的 SelectionLength，并且每隔一次运行您将获得相同的 TextLength，然后您将进入无限循环！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T05:01:41.367

您可以删除只读参数，编写 appendtext 代码，然后再次将 Richtextbox 设为只读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T17:02:44.133

我知道这是一个旧线程，但您可以通过`ReadOnly`替换以下代码来解决这个问题：

```
 rtMessages.Select()
 rtMessages.SelectionStart = 0
 rtMessages.SelectionLength = i
 rtMessages.SelectedText = String.Empty
 rtMessages.SelectionLength = 0 
```

有了这个：

```
 rtMessages.Text = rtMessages.Text.Substring(i) 
```

我不确定这是更好还是更差的性能，但它绕过了`RichTextBox`被设置为`ReadOnly`

编辑：

这是用于测试的完整代码（注意：我将代码添加到 a`Button.Click`进行测试）

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Static X As Integer = 0
    X += 1

    Dim Data As String = "Line " & X.ToString & ControlChars.NewLine
    Me.onNewData(Data)
End Sub

Private Sub onNewData(ByRef data As String)

    ' Add new text
    rtMessages.SelectionStart = rtMessages.TextLength()
    rtMessages.AppendText(data)

    ' Delete oldest text line-by-line until the whole buffer is shorter than MAX_TEXT_LENGTH characters
    Const MAX_TEXT_LENGTH As Integer = 200
    Dim textLength As Integer = rtMessages.TextLength()
    While textLength > MAX_TEXT_LENGTH
        Dim i As Integer = 0
        Do While rtMessages.GetLineFromCharIndex(i) < 1
            i += 1
        Loop

        'rtMessages.Select()
        'rtMessages.SelectionStart = 0
        'rtMessages.SelectionLength = i
        'rtMessages.SelectedText = String.Empty
        'rtMessages.SelectionLength = 0

        rtMessages.Text = rtMessages.Text.Substring(i)

        If rtMessages.TextLength() = textLength Then
            rtMessages.Clear()
            rtMessages.AppendText("[buffer trimming algorithm failed]")
            Exit While
        End If

        textLength = rtMessages.TextLength()
    End While

    ' Scroll down
    rtMessages.SelectionStart = rtMessages.TextLength()
    rtMessages.ScrollToCaret()

End Sub 
```

# javascript - 页面变慢，因为很多“滚动”和“调整大小”事件绑定到窗口

> ID：13318242
> 
> 赞同：0
> 
> 时间：2012-11-10T01:13:06.833
> 
> 标签：javascript, jquery, resize, scroll, window

我是 jquery 和 javascript 的初学者。我的函数有一个很大的问题，它有两个参数——图像源和 img 源数组。

```
function loadPicture(pic_src, _getarray)
{
    var picture_index = _getarray.indexOf(pic_src);
    var array_last = _getarray.length - 1;

    var big_source = pic_src;                       
    var big_source = 'pictures/' + big_source.substring(big_source.search("thumbs/th_")+10);

    var wwidth = $(window).width();
    var wheight = $(window).height();

    $("body").css({ 'overflow' : 'hidden' });

    $("#pic_loader img.single_picture").remove();
    $("#pic_loader").css({ 
                    'width' : wwidth,
                    'height' : wheight      
                    });

    $("#pic_loader").fadeIn();
    $("#pic_loader").append('<img data-original="'+big_source+'" alt="" class="single_picture" />');

    $("img.single_picture").css({ 
        'max-height' : wheight - 120 + 'px',
        'max-width' : wwidth - 120 + 'px',
        'margin-top' : parseInt(wheight/16) + 'px'
    });

    $("img.single_picture").lazyload({
        effect : "fadeIn",
        skip_invisible : false,
        load : function() 
            {
                $("#pic_loader").css({ 'background' : '#000' });
            }
    });

    $("#next_pic").click( function()
    {
        if(picture_index == array_last)
        {
            loadPicture(_getarray[0],_getarray);
            return false;
        }
        else
        {
            loadPicture(_getarray[picture_index+1],_getarray);
            return false;
        }
    } );

    $("#prev_pic").click( function()
    {
        if(picture_index == 0)
        {
            loadPicture(_getarray[array_last],_getarray);
            return false;
        }
        else
        {
            loadPicture(_getarray[picture_index-1],_getarray);
            return false;
        }
    } );
} 
```

当用户单击 prev_pic 或 next_pic 链接时会出现问题，它会正确地将图片加载到查看器（`#pic_loader`）中，但是每次递归发生时它都会加倍`scroll`和`resize`事件，然后浏览器会显着减慢。我不知道如何处理这个。

[“活动截图”](http://i.stack.imgur.com/Xci3z.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:30:56.133

不确定“滚动”和“调整大小”的来源，但您可以尝试在 loadPicture 的开头添加一个 clear ：

```
function loadPicture(pic_src, _getarray)
{
    resize = [];
    scroll = []; 
```

# css - 调整具有属性“display：table-cell”的div的高度

> ID：13318249
> 
> 赞同：0
> 
> 时间：2012-11-10T01:14:17.020
> 
> 标签：css, parent-child, html

我试图将一个 div 垂直居中在另一个 div 中，无论两个 div 的大小如何

我正在这样做：

```
<div id='outer_div'>
    <div id='inner_div'></div>
</div> 
```

CSS：

```
#outer_div {
   display: table-row; 
   height: 200px; 
   width: 200px
}

#inner_div {
   display: table-cell; 
   vertical-align: middle;
   height: 500px; 
   width: 500px
} 
```

我故意为内部 div 设置了更大的尺寸。发生的情况是，即使我设置了 的宽度，由于的宽度（这就是我想要的）`1000px`，宽度的`inner_div`上限也是如此。`200px``outer_div`

但是对于高度，它没有上限，我希望它上限为外部 div 的高度。

我想要的是`inner_div`保持与 相同的大小`outer_div`，无论我`outer_div`在 CSS 中给出什么高度。**我基本上希望它的大小与其 parent 相同**。

* * *

**编辑**：

我只将文本放在那些 div 中。因此，假设我有一个外部 div `200px*200px`(它有`display: table-row`)，内部 div 由 CSS 定义为`500px*500px`，内部有虚拟文本。我的预期结果是将内部 div 缩小到`200px*200px`. 它被外部 div 成功地“缩小”了宽度，但不是高度。我想要的是让它的高度也缩小（所以内部 div 会自动调整，以防我改变外部 div 的高度）

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:39:37.270

那会为你做吗？不过不知道你的局限性。

HTML：

```
<div id="container">
  <div id='outer_div'>
      <div id='inner_div'></div>
  </div>
</div> 
```

CSS：

```
#container
{
   display: block;
   height: 200px;
   width: 200px;
   /* overflow: scroll; */
   overflow: hidden;
   background-color: green;
}

#outer_div {
   display: table-row; 
   height: 200px;
   width: 200px;
   background-color: purple;
}

#inner_div {
   display: table-cell; 
   height: 500px;
   width: 500px;
   background-color: yellow;
} 
```

[在 JSBin 中查看](http://jsbin.com/welcome/46733/)

**编辑：**我不知道你是否可以更改#inner_div，但如果你这样做了 - 那么只需`height`在其规则内删除......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:40:41.983

只需添加`max-height: value`与外部 div 的高度相对应的内部 div 的 CSS，以便内部 div 的高度将是“上限”。

# javascript - 如何使用用户输入完成链接

> ID：13318253
> 
> 赞同：1
> 
> 时间：2012-11-10T01:14:47.410
> 
> 标签：javascript, hyperlink, user-input

我对 javascript 完全陌生，我正在尝试获取一个脚本来完成与用户输入的链接。

即我有一个通用的基本 url `http://www.mystuff.com/`，如果他知道确切的 url，我想创建一个表单让用户访问特定页面。我需要一个基本输入字段，他可以在其中编写一个字符串（如 h5mlf4），该字段将发送他单击提交按钮到`http://www.mystuff.com/h5mlf4`.

我在这个[页面](https://stackoverflow.com/questions/7097573/is-it-possible-to-update-a-url-link-based-on-user-text-input)上找到了这个非常接近我需要的[脚本。](http://jsfiddle.net/Sxz4R/1/)我试图修改它，但我不知道如何在同一个按钮上使用多合一操作来执行这两个操作（添加用户的输入并启动链接）。我不想在页面上创建链接，我只需要立即使用它。

我希望已经清楚了，谢谢大家会照顾这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:17:14.877

做

```
window.location = "http://www.google.com?q=" + userInput; 
```

为用户“单击”该链接（即转到该链接）。

window.location 的文档 >> [https://developer.mozilla.org/en-US/docs/DOM/window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

# android - 将遮罩应用到单个覆盖视图而不遮罩整个活动

> ID：13318255
> 
> 赞同：4
> 
> 时间：2012-11-10T01:14:57.843
> 
> 标签：android, android-layout, view, layer, clipping

我有一个绿色背景的简单活动，我试图提供一个带有透明圆形区域的红色叠加层。这是我想要实现的效果：

[预期图像](http://i.stack.imgur.com/HhVv9.jpg)

使用我在互联网上找到的代码，这就是我所看到的：

[代码结果](http://i.stack.imgur.com/9BOSZ.png)

似乎正在发生的事情是 PorterDuff 将自己应用于活动中的所有视图，而不是我明确告诉它的视图。Stack 上的许多帖子都是关于用另一个位图掩盖一个位图，而我正试图用一个以编程方式创建的圆形来掩盖视图的一部分。这是我尝试使用的代码：

```
public class ClippingTestActivity extends Activity {
    private Paint mPaint;
    ClippingView ddd;
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.test);
        View v = new View(this.getBaseContext());
        v.setBackgroundColor(Color.GREEN);
        this.addContentView(v, new  LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.FILL_PARENT));

         ClippingView r = new ClippingView(this.getBaseContext());
        r.setBackgroundColor(Color.RED);   
        this.addContentView(r, new   LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.FILL_PARENT));
    }

}

    public class ClippingView extends View {
    Paint paint = new Paint();
        Path path = new Path();
        public ClippingView(Context context) {
    super(context);
    }
    @Override
    public void onDraw(Canvas canvas) {
    super.onDraw( canvas );

        paint.setColor(Color.TRANSPARENT);
        paint.setStyle(Style.FILL);

        paint.setXfermode( new PorterDuffXfermode( Mode.CLEAR ) );
        int cx = 200;
        int cy = 200;
        int radius = 50;
        canvas.drawCircle( cx, cy, radius, paint );
    }
} 
```

布局xml文件就是这样

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:app="http://schemas.android.com/apk/res/com.appspot.scruffapp" 
 android:layout_width="fill_parent" 
 android:layout_height="fill_parent"         
 android:layout_centerHorizontal="true"
 android:background="#ff0000"> 
 </RelativeLayout> 
```

有谁知道如何实现效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T17:41:11.727

好的。在朋友的帮助下，我想通了。事实证明，我需要创建一个空的新画布，并将其从一个函数传递到另一个函数，然后在一个稍后添加的新视图上绘制画布。这是对我有用的代码：

```
Bitmap circle = DrawView.makeCircle(drawable);
Bitmap overlayBg = DrawView.makeOverlayBg(canvas.getWidth(),canvas.getHeight());

Bitmap finalImage = Bitmap.createBitmap(canvas.getWidth(),canvas.getHeight(), Bitmap.Config.ARGB_8888);

final android.graphics.Canvas tmpCanvas = new android.graphics.Canvas(finalImage);
tmpCanvas.drawBitmap(overlayBg, 0, 0, null);

final android.graphics.Paint paint = new android.graphics.Paint();
paint.setXfermode(new android.graphics.PorterDuffXfermode(Mode.DST_OUT));
tmpCanvas.drawBitmap(circle, cx - radius, cy - radius, paint);

canvas.drawBitmap(finalImage, 0, 0, null); 
```

# c++ - 对临时与返回值优化的 const 引用

> ID：13318257
> 
> 赞同：23
> 
> 时间：2012-11-10T01:15:03.767
> 
> 标签：c++, optimization, return-value-optimization, temporary-objects, const-reference

我知道将右值分配给 const 左值引用会延长临时对象的生命周期直到作用域结束。但是，我不清楚何时使用它以及何时依赖返回值优化。

```
LargeObject lofactory( ... ) {
     // construct a LargeObject in a way that is OK for RVO/NRVO
}

int main() {
    const LargeObject& mylo1 = lofactory( ... ); // using const&
    LargeObject mylo2 = lofactory( ... ); // same as above because of RVO/NRVO ?
} 
```

根据 Scot Meyers 的“更有效的 C++”（第 20 项），编译器可以优化第二种方法以在适当的位置构造对象（这将是理想的，并且正是`const&`第一种方法试图实现的目标）。

1.  是否有任何普遍接受的规则或最佳实践何时用于`const&`临时人员以及何时依赖 RVO/NRVO？
2.  会不会有使用`const&`方法比不使用更糟糕的情况？（我正在考虑例如 C++11 移动语义，如果`LargeObject`有那些实现的话......）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-10T02:14:26.247

让我们考虑最简单的情况：

```
lofactory( ... ).some_method(); 
```

在这种情况下，从**lofactory**到调用者上下文的副本是可能的——但它可以通过**RVO/NRVO**优化掉。

* * *

```
LargeObject mylo2 ( lofactory( ... ) ); 
```

在这种情况下，可能的副本是：

1.  从**lofactory****临时**返回到调用者上下文 - 可以通过**RVO/NRVO优化掉**
*****   从**临时**复制构建**mylo2** - 可以通过**复制省略进行优化******

 ******* * *

```
const LargeObject& mylo1 = lofactory( ... ); 
```

在这种情况下，仍然可以有一个副本：

1.  从**lofactory****临时**返回到调用者上下文 - 可以通过**RVO/NRVO**优化掉（也是！）

 ****引用将绑定到这个临时。

* * *

所以，

> 是否有任何普遍接受的规则或最佳实践何时使用 const& 来临时以及何时依赖 RVO/NRVO？

正如我上面所说，即使在 的情况下`const&`，也可能会出现不必要的副本，并且可以通过**RVO/NRVO**对其进行优化。

如果您的编译器在某些情况下应用了**RVO/NVRO**，那么它很可能会在第 2 阶段（上图）执行复制省略。因为在这种情况下，复制省略比 NRVO 简单得多。

但是，在最坏的情况下，您将拥有一份该`const&`案例的副本，并在您初始化值时拥有两份副本。

> 会不会出现使用 const& 方法比不使用更糟糕的情况？

我不认为有这样的情况。至少除非你的编译器使用奇怪的规则来区分`const&`. （对于类似情况的一个示例，我注意到 MSVC 不会为聚合初始化执行 NVRO。）

> （例如，如果 LargeObject 实现了那些，我正在考虑 C++11 移动语义......）

在 C++11 中，如果`LargeObject`具有移动语义，那么在最坏的情况下，您将针对该`const&`情况进行一次移动，并且在初始化值时进行两次移动。所以，`const&`还是好一点的。

* * *

> 因此，一个好的规则是始终将临时对象绑定到 const& 如果可能，因为如果编译器由于某种原因未能执行复制省略，它可能会阻止复制？

在不知道应用程序的实际上下文的情况下，这似乎是一个很好的规则。

在 C++11 中，可以将临时绑定到右值引用 - LargeObject&&。所以，这样的临时可以修改。

* * *

顺便说一句，移动语义仿真可通过不同的技巧在 C++98/03 中使用。例如：

*   [Mojo](http://www.drdobbs.com/move-constructors/184403855) / [Boost.Move](http://www.boost.org/doc/libs/1_52_0/doc/html/move.html)

*   Bjarne Stroustrup[描述了在 class 中使用小的可变标志的另一个技巧](http://www.youtube.com/watch?v=OB-bdWKwXsU&t=71m17s)。他提到的示例代码是[here](http://www.stroustrup.com/Programming/Matrix/Matrix.h)。

然而，即使存在移动语义 - 也有无法廉价移动的对象。例如，内部带有双数据[4][4] 的 4x4 矩阵类。因此，即使在 C++11 中，复制省略 RVO/NRVO 仍然非常重要。顺便说一句，当复制省略/RVO/NRVO 发生时 - 它比移动更快。

* * *

PS，在实际情况下，还有一些额外的事情需要考虑：

例如，如果您有返回向量的函数，即使将应用 Move/RVO/NRVO/Copy-Elision - 它仍然可能不是 100% 有效。例如，考虑以下情况：

```
while(/*...*/)
{
    vector<some> v = produce_next(/* ... */); // Move/RVO/NRVO are applied
    // ...
} 
```

将代码更改为：

```
vector<some> v;
while(/*...*/)
{
    v.clear();

    produce_next( v ); // fill v
    // or something like:
    produce_next( back_inserter(v) );
    // ...
} 
```

因为在这种情况下，当 v.capacity() 足够时，可以重新使用 vector 中已经分配的内存，而无需在每次迭代时在 producer_next 中进行新的分配。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-17T06:36:44.540

如果你这样写你的`lofactory`类：

```
LargeObject lofactory( ... ) {
    // figure out constructor arguments to build a large object
    return { arg1, arg2, arg3 }  //  return statement with a braced-init-list
} 
```

在这种情况下，没有 RVO/NRVO，它是直接构造的。标准的第 6.6.3 节说“带有花括号初始化列表的*语句*`return`通过指定初始化列表中的复制列表初始化 (8.5.4) 初始化要从函数返回的对象或引用。”</p >

*然后，如果你用*

 *```
LargeObject&& mylo = lofactory( ... ); 
```

不会有任何复制，寿命会是你所期望的，你可以修改mylo。

并且保证在任何地方都没有复制。***********

# android - 将 Java 可序列化对象发送到字节数组到 web 服务 java.lang.classnotfoundexception

> ID：13318259
> 
> 赞同：0
> 
> 时间：2012-11-10T01:15:25.340
> 
> 标签：android, web-services, bytearray, ksoap2, classnotfoundexception

我有一个实现可序列化的自定义对象，在客户端项目和 web 服务项目中定义。我想通过soap消息将该对象作为字节数组传递，但是当我尝试这样做时，重建对象的web服务中的方法有一个找不到类的异常，如下面的堆栈：

```
java.lang.ClassNotFoundException: com.myproject.biosign.client.vo.Istante 
```

请注意，异常中引用的路径是客户端中对象的路径，并且正确地在 web 服务中找不到。如何在 web 服务中使用相同对象的定义重建对象？

遵循转换、发送和反转换对象的代码。

在客户端方法中：

```
SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

    try {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutput out = null;

          out = new ObjectOutputStream(bos);   
          out.writeObject(istanti.get(0));
          byte[] yourBytes = bos.toByteArray();

          out.close();
          bos.close();

        request.addProperty("lista", yourBytes);                

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

        envelope.dotNet = false;
        envelope.setOutputSoapObject(request);

        Marshal floatMarshal = new MarshalFloat();
        floatMarshal.register(envelope);
        new MarshalBase64().register(envelope);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
        androidHttpTransport.debug = true;

        androidHttpTransport.call(SOAP_ACTION, envelope); 
```

在 WS 方法中：

```
ByteArrayInputStream bis = new ByteArrayInputStream(lista);
          ObjectInput in = null;
          try {
            in = new ObjectInputStream(bis);
            Object o = in.readObject(); 
            Istante ist = (Istante) o;
            System.out.println("eccoci" + ist.getXCoord());
            bis.close();
            in.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:21:08.550

为了以您拥有的方式使用 Java 的序列化，您需要`Istante`在其类路径中的客户端和服务器上都有客户端类。

可以将`Istante`的字节码发送到服务器，然后使用自定义类加载器来解析该类。但我强烈建议你不要这样做。一个不错的简单 JSON 交换格式将是更好的选择。

我应该指出最简单的解决方案是将 jar 包含`Istante`在服务器类路径中。

# c# - 将 .ashx 通用处理程序拆分为部分类

> ID：13318261
> 
> 赞同：0
> 
> 时间：2012-11-10T01:15:35.333
> 
> 标签：c#, asp.net, httphandler

我一直在尝试将我的通用处理程序拆分为多个文件。它旨在从页面接收所有命令和所有请求类型，因此我让它处理 GET、POST、PUT 和 DELETE，每个请求都有多个命令。因此，有很多代码。我想知道我是否可以拆分这个。我尝试使用部分类，但处理程序中的方法看不到部分类文件中的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T13:38:36.467

如果可能的话，使用 WebAPI 真的很容易，因此您不必像这样分离代码。如果您可以这样做，请查看[http://stephenwalther.com/archive/2012/03/05/introduction-to-the-asp-net-web-api.aspx](http://stephenwalther.com/archive/2012/03/05/introduction-to-the-asp-net-web-api.aspx)以更好地解释它。

抱歉，如果这不是你要问的，但我想我会把它扔在那里，以防你不知道。

# node.js - 在建立连接之前使用后备传输进行 Socket.IO 身份验证

> ID：13318263
> 
> 赞同：1
> 
> 时间：2012-11-10T01:15:47.890
> 
> 标签：node.js, session, authentication, web-applications, socket.io

使用 Node.js/Socket.IO 处理需要广泛浏览器兼容性的应用程序，因此预计客户端可能在其浏览器中不支持 WebSocket。我想知道无论底层传输如何，验证用户身份的最可靠方法是什么。

有许多示例在连接/握手时发送带有 sessionID 的 cookie，这是理想的，但我担心这不适用于 Flash 套接字，因为发送的 cookie 不同。

另一种方法是让客户端在用户进行身份验证时存储 SessionID，然后当用户需要 Socket 连接时，您将会话 ID 作为第一条消息发送。这种方法的问题是您会产生建立完整连接的开销，这从负载或安全角度来看并不理想。

无论客户端和服务器之间使用什么底层传输机制，在连接/握手阶段（即不通过连接的套接字发送令牌）使用 Socket.IO 的最佳身份验证模式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:38:19.607

我的想法是，您无法避免在打开的套接字上发送身份验证。即使您将套接字的使用限制在应用程序的实时方面，您也需要将该套接字链接到您内部拥有的东西，除非您提供只读的公共流。

您可以通过另一种机制（例如 Express/Redis）进行身份验证来减少连接开销，并且仅在授权有效时指示客户端打开套接字连接（通过套接字发送会话 ID 作为第一次通信）。您必须在客户端代码中手动执行此操作；没错，cookie 不会通过 Socket.IO 连接自动发送。您可以立即断开传递无效会话 ID 的套接字或发送没有会话 ID 的请求，并且如果您担心 DoS 攻击，则对这些连接有更严格的超时。有关如何实现此功能的示例代码，请参阅[Socket.IO 身份验证。](https://stackoverflow.com/questions/4753957/socket-io-authentication?rq=1)

# java - 为什么Java构造函数中有返回

> ID：13318268
> 
> 赞同：2
> 
> 时间：2012-11-10T01:16:46.347
> 
> 标签：java, constructor

我正在查看一些框架，并注意到其中一个类的构造函数中有返回值。我不明白。它是干什么用的？

它看起来像这样：

```
public class Hello {

    HashMap<String, String> myMap;
    Stack<HashMap<Sting, String>> myStack;

    public Hello() {        
        myMap = new HashMap<String, String>();
        myStack = new Stack<HashMap<String, String>>();
        return;  
    }

    ... more methods
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:18:56.343

直接来自[甲骨文](http://docs.oracle.com/javase/tutorial/java/javaOO/returnvalue.html)

> 任何声明为 void 的方法都不会返回值。它不需要包含 return 语句，但它可以这样做。在这种情况下，可以使用 return 语句从控制流块中分支出来并退出该方法，并且可以像这样简单地使用：
> 
> 返回;

同样适用于**退货；构造函数中声明的语法**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:19:29.290

它什么也不做。

您可以`return`在构造函数中使用语句作为流控制的一种方式

```
public MyClass(boolean male, int children) {
  this.male = male;
  if (this.male) {
    return;
  }
  this.children = children;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:18:02.333

return 只是意味着退出该方法。没有值，它什么也不返回。由于它位于方法的末尾，因此是多余的，因为无论如何该方法都会退出。

# google-maps-api-3 - 您如何设置谷歌地图 v3 密钥的引荐来源网址？

> ID：13318275
> 
> 赞同：0
> 
> 时间：2012-11-10T01:17:49.080
> 
> 标签：google-maps-api-3

我使用的网站是`test.herokuapp.com`.

我尝试过的推荐人是：

```
http://test.herokuapp.com
test.herokuapp.com/*.
*.test.herokuapp.com/*.
test.herokuapp.com/ 
```

我每次得到的错误是：

```
Google has disabled use of the Maps API for this application. The provided key is not a valid Google API Key, or it is not authorized for the Google Maps Javascript API v3 on this site. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T02:25:29.223

试试这个：

```
test.herokuapp.com/* 
```

# java - 仅用于自动驱逐事件的 RemovalListener

> ID：13318277
> 
> 赞同：1
> 
> 时间：2012-11-10T01:17:58.933
> 
> 标签：java, caching, guava

我正在使用带有驱逐策略设置 expireAfterWrite() 的番石榴 LoadingCache。我还使用以下方法使访问条目无效：

```
v = cache.getIfPresent( k );
if( v != null ) {
  cache.invalidate( k );
} 
```

有没有办法添加一个仅在达到写入超时后条目被自动驱逐时才会触发的 RemovalListener？从文档中可以看出，每当删除条目时都会调用 RemovalListener。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T02:11:43.917

是的，`RemovalListener`任何时候删除任何条目时都会调用 a —— 但是`RemovalListener`会收到一个`RemovalNotification`对象，其中包括*cause*，您可以使用它来确定条目是如何被删除的。

```
CacheBuilder.newBuilder()
  .removalListener(new RemovalListener<Foo, Bar>() {
    public void onRemoval(RemovalNotification<Foo, Bar> notification) {
      if (notification.getCause() == RemovalCause.EXPIRED) {
        // we only care about these removals
      }
    }
  })
  .build(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T20:45:39.623

如果您正在寻找性能，这不是一个完美的解决方案。如果你有办法只接收被驱逐的条目，应该会更好。恕我直言

# objective-c - NSPopupButton 中的 NSProgressIndicator

> ID：13318279
> 
> 赞同：0
> 
> 时间：2012-11-10T01:18:05.497
> 
> 标签：objective-c, cocoa, nspopupbutton, nsprogressindicator

我试图弄清楚如何让微调器在 NSPopupButton 的菜单项上设置动画。我无法让微调器设置动画。它出现了，但它什么也没做。

到目前为止，我已经将微调器添加到菜单项中，如下所示：

```
_spinner = [[NSProgressIndicator alloc] initWithFrame:NSMakeRect(0,0,16,16)];
[_spinner setIndeterminate:YES];
[_spinner setStyle:NSProgressIndicatorSpinningStyle];
[_spinner setControlSize:NSSmallControlSize];
[_spinner setDisplayedWhenStopped:YES];
[_spinner setHidden:NO];

NSMenuItem *item = [[button menu] itemWithTag:0];
[item setView:_spinner]; 
```

我正在收听 NSPopUpButtonWillPopUpNotification。当我收到通知时，我会这样做，但微调器会出现并且没有动画：

```
[_spinner setUsesThreadedAnimation:YES];
[_spinner startAnimation:nil]; 
```

我编辑了这个来更新我的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:25:56.810

试试这种方式：

```
[progressIndicator performSelector:@selector(startAnimation:)
                            withObject:self
                            afterDelay:0.0
                               inModes:[NSArray 
                       arrayWithObject:NSEventTrackingRunLoopMode]]; 
```

在 menuWillOpen: 内部，问题似乎是在进度条完成绘制之前调用 startAnimation:。

您如何引用视图中的 NSProgressIndicator（以及窗口中的那个）？例如，您是否有一个将 IBOutlet 连接到进度指示器的控制器类？如果您使用的是 IBOutlet，您确定它已正确连接到 nib 文件中吗？

另外，您在何时何地调用 startAnimation:？（我们需要看一些代码）。

有时会发生的一件事是您忘记在笔尖中连接 IBOutlet。然后，当您尝试在运行时告诉对象在代码中执行某些操作时，IBOutlet 为 nil，因此您认为发送给对象的消息实际上是发送给 nil 的消息。换句话说，它只是被忽略了，实际上看起来它不起作用。

如果您确实（可能）有对 UI 对象的有效引用，那么您将看到的另一个常见问题是开发人员试图在“太早”的时间向对象发送消息时。一般来说，init 方法在控制器对象的生命周期中太早了，无法向用户界面对象发送消息——那些 IBOutlet 仍然是 nil。到 -awakeFromNib 被调用时，IBOutlet 应该是有效的（前提是您在 IB 中连接了它们），然后您可以将消息发送到 UI 对象。

# ios - 在 UITextView 中选择一个单词

> ID：13318283
> 
> 赞同：7
> 
> 时间：2012-11-10T01:18:54.397
> 
> 标签：ios, uilabel, uitextview

编辑：我想我应该使用 UILabel 而不是 UITextView 因为我不希望突出显示使用带有“复制/全选/定义”弹出框的系统范围的蓝色。

我正在尝试构建自定义文本视图，并且正在寻求正确方法的帮助。我是一个 iOS n00b，所以主要是寻找关于如何最好地解决问题的想法。

我想构建一个自定义文本视图，具有以下行为：

1.  视图从小开始。如果它收到点击它会增长（动画）到父视图的大小作为模式窗口（左上图，然后右上图）
2.  在这种大状态下，如果点击单个单词，该单词会以某种方式突出显示，并且调用委托方法传递包含被点击的字符串（左下图）

[![新文本视图](../Images/73cf62d3b8cf4bcaa10dcf604610e5d6.png "新观点")](https://i.stack.imgur.com/58Y5a.png "新观点")
[（来源：[telliott.net](http://telliott.net/static/NewTextView.png)）]

我怀疑复杂性将在于识别被点击的单词，所以让我们从那里开始。我可以想到几种尝试方法：

1.  子类 UILabel。添加触摸手势识别器。当识别到触摸时，以某种方式获取触摸点的 (xy) 坐标，查看视图显示的字符串并根据位置确定必须按下哪个单词。然而，我可以看到这很快就变得非常复杂了。我不确定如何获取触摸的 (x,y) 坐标（尽管我认为这很简单），或者如何获取每个字符的设备相关文本宽度等。我宁愿不走这条路，除非有人可以说服我这不会很可怕！
2.  子类 UIView，并通过为每个单词添加 UILabel 来伪造句子。测量每个 UILabel 的宽度并自己布置它们。这似乎是一种更明智的方法，尽管我担心当我开始尝试时，以这种方式布置文本也会比我想象的更难。

有没有更明智的方法？你能以其他方式检索在 UILabel 中触及的单词吗？

如果我选择选项 2，那么我认为从小文本到大文本的动画可能会很复杂，因为这些文字会以有趣的方式换行。所以我想有另一个子视图——这次是一个 UITextView——来将句子保持在小状态。将此动画放大，然后将其隐藏，同时以每个单词一个视图显示我的 UIView。

任何想法表示赞赏。提前致谢 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T01:58:01.107

**更新**

由于在 CoreText 中添加了 NSLayoutManager，这对于 iOS 7 来说变得容易多了。如果您正在处理 UITextView，您可以将布局管理器作为视图的属性访问。在我的情况下，我想坚持使用 UILabel，所以你必须创建一个相同大小的布局管理器，即：

```
NSTextStorage *textStorage = [[NSTextStorage alloc] initWithAttributedString:labelText];
NSLayoutManager *layoutManager = [[NSLayoutManager alloc] init];
[textStorage addLayoutManager:layoutManager];
CGRect bounds = label.bounds;
NSTextContainer *textContainer = [[NSTextContainer alloc] initWithSize:bounds.size];
[layoutManager addTextContainer:textContainer]; 
```

现在你只需要找到被点击的字符的索引，很简单！

```
NSUInteger characterIndex = [layoutManager characterIndexForPoint:location
                                                  inTextContainer:textContainer
                         fractionOfDistanceBetweenInsertionPoints:NULL]; 
```

这使得查找单词本身变得微不足道：

```
if (characterIndex < textStorage.length) {
  [labelText.string enumerateSubstringsInRange:NSMakeRange(0, textStorage.length)
                                       options:NSStringEnumerationByWords
                                    usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
                                      if (NSLocationInRange(characterIndex, enclosingRange)) {
                                        // Do your thing with the word, at range 'enclosingRange'
                                        *stop = YES;
                                      }
                                    }];
} 
```

**原始答案，适用于 iOS < 7**

感谢@JP Hribovsek 提供了一些使其工作的技巧，我设法解决了这个问题，足以满足我的目的。感觉有点 hacky，并且对于大量文本可能不太适用，但对于一次段落（这是我需要的）它很好。

我创建了一个简单的 UILabel 子类，它允许我设置插入值：

```
#import "WWLabel.h"

#define WWLabelDefaultInset 5

@implementation WWLabel

@synthesize topInset, leftInset, bottomInset, rightInset;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        self.topInset = WWLabelDefaultInset;
        self.bottomInset = WWLabelDefaultInset;
        self.rightInset = WWLabelDefaultInset;
        self.leftInset = WWLabelDefaultInset;
    }
    return self;
}

- (void)drawTextInRect:(CGRect)rect
{
    UIEdgeInsets insets = {self.topInset, self.leftInset,
        self.bottomInset, self.rightInset};

    return [super drawTextInRect:UIEdgeInsetsInsetRect(rect, insets)];
} 
```

然后我创建了一个包含我的自定义标签的 UIView 子类，并在点击时为标签中的每个单词构建文本的大小，直到大小超过点击位置的大小——这就是被点击的单词。它不是完美的，但现在工作得很好。

然后我使用了一个简单的 NSAttributedString 来突出显示文本：

```
#import "WWPhoneticTextView.h"
#import "WWLabel.h"

#define WWPhoneticTextViewInset 5
#define WWPhoneticTextViewDefaultColor [UIColor blackColor]
#define WWPhoneticTextViewHighlightColor [UIColor yellowColor]

#define UILabelMagicTopMargin 5
#define UILabelMagicLeftMargin -5

@implementation WWPhoneticTextView {
    WWLabel *label;
    NSMutableAttributedString *labelText;
    NSRange tappedRange;
}

// ... skipped init methods, very simple, just call through to configureView

- (void)configureView
{
    if(!label) {
        tappedRange.location = NSNotFound;
        tappedRange.length = 0;

        label = [[WWLabel alloc] initWithFrame:[self bounds]];
        [label setLineBreakMode:NSLineBreakByWordWrapping];
        [label setNumberOfLines:0];
        [label setBackgroundColor:[UIColor clearColor]];
        [label setTopInset:WWPhoneticTextViewInset];
        [label setLeftInset:WWPhoneticTextViewInset];
        [label setBottomInset:WWPhoneticTextViewInset];
        [label setRightInset:WWPhoneticTextViewInset];

        [self addSubview:label];
    }

    // Setup tap handling
    UITapGestureRecognizer *singleFingerTap = [[UITapGestureRecognizer alloc]
                                               initWithTarget:self action:@selector(handleSingleTap:)];
    singleFingerTap.numberOfTapsRequired = 1;
    [self addGestureRecognizer:singleFingerTap];
}

- (void)setText:(NSString *)text
{
    labelText = [[NSMutableAttributedString alloc] initWithString:text];
    [label setAttributedText:labelText];
}

- (void)handleSingleTap:(UITapGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateEnded)
    {
        // Get the location of the tap, and normalise for the text view (no margins)
        CGPoint tapPoint = [sender locationInView:sender.view];
        tapPoint.x = tapPoint.x - WWPhoneticTextViewInset - UILabelMagicLeftMargin;
        tapPoint.y = tapPoint.y - WWPhoneticTextViewInset - UILabelMagicTopMargin;

        // Iterate over each word, and check if the word contains the tap point in the correct line
        __block NSString *partialString = @"";
        __block NSString *lineString = @"";
        __block int currentLineHeight = label.font.pointSize;
        [label.text enumerateSubstringsInRange:NSMakeRange(0, [label.text length]) options:NSStringEnumerationByWords usingBlock:^(NSString* word, NSRange wordRange, NSRange enclosingRange, BOOL* stop){

            CGSize sizeForText = CGSizeMake(label.frame.size.width-2*WWPhoneticTextViewInset, label.frame.size.height-2*WWPhoneticTextViewInset);
            partialString = [NSString stringWithFormat:@"%@ %@", partialString, word];

            // Find the size of the partial string, and stop if we've hit the word
            CGSize partialStringSize  = [partialString sizeWithFont:label.font constrainedToSize:sizeForText lineBreakMode:label.lineBreakMode];

            if (partialStringSize.height > currentLineHeight) {
                // Text wrapped to new line
                currentLineHeight = partialStringSize.height;
                lineString = @"";
            }
            lineString = [NSString stringWithFormat:@"%@ %@", lineString, word];

            CGSize lineStringSize  = [lineString sizeWithFont:label.font constrainedToSize:label.frame.size lineBreakMode:label.lineBreakMode];
            lineStringSize.width = lineStringSize.width + WWPhoneticTextViewInset;

            if (tapPoint.x < lineStringSize.width && tapPoint.y > (partialStringSize.height-label.font.pointSize) && tapPoint.y < partialStringSize.height) {
                NSLog(@"Tapped word %@", word);
                if (tappedRange.location != NSNotFound) {
                    [labelText addAttribute:NSForegroundColorAttributeName value:[UIColor blackColor] range:tappedRange];
                }

                tappedRange = wordRange;
                [labelText addAttribute:NSForegroundColorAttributeName value:[UIColor redColor] range:tappedRange];
                [label setAttributedText:labelText];
                *stop = YES;
            }
        }];        
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T03:03:08.250

UITextView 已经有一个在选择更改时触发的委托方法（请注意，在 textview 中移动光标相当于更改选择，用户实际上不需要“选择”任何文本来调用它）：

```
- (void)textViewDidChangeSelection:(UITextView *)textView 
```

每当触发此操作时，获取 selectedRange 如下所示：

```
NSRange range=textView.selectedRange; 
```

如果用户应该能够手动移动光标或选择整个单词，那么你就完成了，否则，只需在 selectedRange 处的字符串周围添加一些处理，以确定光标周围的单词是什么，并突出显示它用你选择的方法。
例如，您可以枚举文本视图中的所有单词，并找出哪个包含当前选择（或光标），然后选择整个单词（这是突出显示先前 iOS 6 的一种方式）

```
- (void)textViewDidChangeSelection:(UITextView *)textView{
NSRange range=textView.selectedRange;
[textView.text enumerateSubstringsInRange:NSMakeRange(0, [textView.text length]) options:NSStringEnumerationByWords usingBlock:^(NSString* word, NSRange wordRange, NSRange enclosingRange, BOOL* stop){
    NSRange intersectionRange=NSIntersectionRange(range,wordRange);
    if(interesectionRange.length>0){
        [textView setSelectedRange:wordRange];
    }
}];
} 
```

# actionscript-3 - AS3 单例实现

> ID：13318290
> 
> 赞同：5
> 
> 时间：2012-11-10T01:19:18.323
> 
> 标签：actionscript-3

我已经看到了很多单例的实现，我只想要一个单例

1.- 第一次调用的实例 2.- 实例只有一次（duh）

那么在性能和最低内存消耗方面，最好的实现是什么？

示例 1

```
package Singletons
{
    public class someClass
    {
        private static var _instance:someClass;

        public function AlertIcons(e:Blocker):void{}

        public static function get instance():someClass{
            test!=null || (test=new someClass(new Blocker()));
            return _instance;
        }
    }
}
class Blocker{} 
```

示例 2

```
public final class Singleton
{
    private static var _instance:Singleton = new Singleton();

    public function Singleton()
    {
        if (_instance != null)
        {
            throw new Error("Singleton can only be accessed through Singleton.instance");
        }
    }

    public static function get instance():Singleton
    {
        return _instance;
    }
} 
```

示例 3

```
package {

    public class SingletonDemo {
        private static var instance:SingletonDemo;
        private static var allowInstantiation:Boolean;

        public static function getInstance():SingletonDemo {
            if (instance == null) {
                allowInstantiation = true;
                instance = new SingletonDemo();
                allowInstantiation = false;
            }
            return instance;
        }

        public function SingletonDemo():void {
            if (!allowInstantiation) {
                 throw new Error("Error: Instantiation failed: Use SingletonDemo.getInstance() instead of new.");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-10T03:15:34.777

示例 2 但有一个转折，因为您应该允许至少调用一次 new Singleton() 并且我不喜欢在需要它们之前实例化事物，因此对 instance() 的第一次调用实际上会创建实例......后续调用抢原版。

编辑：播种如果你打电话，它也可以允许

```
var singleton:Singleton = new Singleton(); 
```

它会工作......但所有未来的尝试都会抛出错误并强制使用 getInstance() 方法

```
public final class Singleton{
    private static var _instance:Singleton;

    public function Singleton(){
        if(_instance){
            throw new Error("Singleton... use getInstance()");
        } 
        _instance = this;
    }

    public static function getInstance():Singleton{
        if(!_instance){
            new Singleton();
        } 
        return _instance;
    }
} 
```

# python - Scrapyd：如何指定已部署项目可以使用的库和公共文件夹？

> ID：13318291
> 
> 赞同：3
> 
> 时间：2012-11-10T01:19:20.710
> 
> 标签：python, scrapyd

Scrapyd 是我们可以部署项目的服务。但是我面临一个问题。我有一个名为 MyScrapers 的项目，其蜘蛛类使用如下导入语句：

`from mylibs.common.my_base_spider import MyBaseSpider`

my_base_spider 的路径是`/home/myprojectset/mylibs/common/my_base_spider`

在设置环境变量`PYTHONPATH=$HOME/myprojectset/`时，我可以使用 scrapy 命令运行 MyScrapers：scrapy crawl MyScrapers。

但是当我使用 scrapyd 通过以下命令部署 MyScrapers 时：scrapy deploy scrapyd2 -p MyScrapers，我收到以下错误：

**服务器响应 (200): {"status": "error", "message": "ImportError: No module named mylibs.common.my_base_spider"}**

请告诉如何使部署的项目使用这些库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:15:17.603

You need to edit your `setup.py` and/or `MANIFEST.in` to declare that it has a `mylibs` package dependency.

See [the distutils documentation](http://docs.python.org/2/distutils/sourcedist.html) for more information.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T13:36:55.577

I found the answer by adding `mylibs` to `site-packages` of python by using `setup.py` inside `mylib` folder. That way I could import everything inside `mylib` in my projects. Actually `mylibs` were way outside from the location where `setup.py` of my deploy-able project is present. `setup.py` looks for packages on same level and inside the folders where it is located.

# javascript - iframe 到父通信：parent.function vs postmessage

> ID：13318292
> 
> 赞同：0
> 
> 时间：2012-11-10T01:19:24.053
> 
> 标签：javascript, html, iframe, security

我正在尝试将对象从 iframe 发送到它所在的父站点。我找到了

[Html5 - 跨浏览器 Iframe 邮件 - 孩子到父母？](https://stackoverflow.com/questions/8822907/html5-cross-browser-iframe-postmessage-child-to-parent)

和

[从 iframe 调用父窗口函数](https://stackoverflow.com/questions/2161388/iframe-function-calling-from-iframe-to-parent-page-javascript-function)

我能够让它在所有浏览器中工作（postmessage 在 IE 中不起作用）

```
var data = {'iframedata': true, 'message':'object received from iframe'};
function sendDataToParent(){
    parent.receiveData(data);
} 
```

我看到的所有帖子都说 parent.postmessage 是在 html5 中的窗口之间发送数据的安全方式，所以调用父函数并传入参数是因为我不安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T11:19:49.867

如果您的 iframe 与托管页面（父级）位于不同的域中，则调用函数将不起作用。

# javascript - 地理编码是否仅限于 Google Maps JS API 3 中的 10 个结果？

> ID：13318295
> 
> 赞同：0
> 
> 时间：2012-11-10T01:19:33.970
> 
> 标签：javascript, google-maps, geocoding

我想使用谷歌地图的地理编码服务并列出所有符合用户要求的位置。根据[此文档页面](https://developers.google.com/maps/documentation/geocoding/index)，有静态和动态服务。第一个是我需要的，但在我看来它不像我希望的那样工作。我想以 JSON 格式获取结果，但服务器不会以符合 JSONP 的方式生成响应。我发现[JSONP 支持已从 API 中删除](https://stackoverflow.com/a/4682673/506695)。

这就是为什么我尝试使用动态 API 的[Geocoder](https://developers.google.com/apps-script/class_geocoder)类。问题是我收到的任何地址请求的结果项都不超过十个（至少我无法猜测超过十个结果项的地址）。我知道这样的限制是针对实时地理编码的，但这是否意味着不可能使用 Google Maps API 获得适合请求的所有可能位置的完整列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T11:55:35.307

您混淆了名称和地址。谷歌地图试图尽可能准确，并在找不到完全匹配时返回一个疯狂猜测的列表。您可以自行决定是否找到符合您名字的最佳地点。Geocding 与邻近搜索无关。当您需要邻近搜索时，您需要使用另一个 api（可能是地点）或使用具有您自己独特地点的数据库自己进行。尤其是当您将区域代码添加到查询中时，这一点更是如此。阅读更多相关信息：[Google Maps API：Geocode 返回与 Google maps 不同的坐标](https://stackoverflow.com/questions/12788664/google-maps-api-geocode-returns-different-co-ordinates-then-google-maps/12790012#12790012)。在此处阅读有关 google 地方的问题：[了解用于网页的 google 地方 api](https://stackoverflow.com/questions/13325946/understand-the-google-places-api-for-using-with-a-webpage)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T10:03:48.733

是的，它每秒限制大约 10 个地理编码请求。解决方法？将每个请求的状态延迟`OVER_QUERY_LIMIT`大约 100 毫秒。

# join - Solr 4：加入后如何维护构面

> ID：13318296
> 
> 赞同：3
> 
> 时间：2012-11-10T01:19:43.237
> 
> 标签：join, solr, faceted-search, facets

我有 2 种数据类型，“car_dealer”，它是“car”的父级。对汽车类型的文档进行索引，包括“品牌”和“型号”2 个字段。在这两个字段上，我使用枢轴分面。

站点访问者需要能够搜索汽车和汽车经销商，通过匹配汽车数据（子）可以找到汽车经销商（父）。为此，我需要加入，幸运的是 solr 4 支持这一点。要将 'cars' 与 'car_dealers' 连接起来，我在汽车类型的文档中添加了一个名为 'dealer' 的字段，它保存了汽车所属的经销商 ID，然后我将其与所有文档都具有的 'id' 字段连接起来.

我想出了以下查询（忽略不相关的字段）..

**汽车搜索：**

`q={!dismax v=$values qf=$fields}&values=porsche&fields=title^10 body^10&facet=true&facet.pivot=brand,model`（方面工作正常）

**汽车经销商搜索：**

`q={!join from=dealer to=id defType=dismax v=$values qf=$fields}&values=porsche&fields=title^10 body^10&facet=true&facet.pivot=brand,model`

最后一个查询很好地显示了汽车经销商，但是由于 car_dealer 类型的文档不包含品牌或型号，因此这些方面不起作用。

**如何在汽车经销商搜索中也返回方面？**这样人们就可以按品牌和型号筛选经销商。

我尝试将 facet.pivot 上的反向连接作为本地参数，但没有任何运气：

`facet.pivot={!join from=id to=dealer}brand,model`

我不确定是否可以将本地参数添加到构面，我已经阅读了我能找到的所有文档，但没有提到这个特定场景。

任何朝着正确方向的推动都将不胜感激:)

# ruby-on-rails - Rails 自动登录，无法注销

> ID：13318299
> 
> 赞同：2
> 
> 时间：2012-11-10T01:20:04.233
> 
> 标签：ruby-on-rails, ruby-on-rails-3, session

已解决：对不起，伙计们，我自己解决了这个问题，方法是执行 db:reset 并修复导致一些问题的之前的过滤器方法之一。

每当我在本地主机上运行我的应用程序时，我都会立即登录。我在多个浏览器上尝试过，每次都会发生同样的事情。退出功能也不起作用。我不知道该怎么做。我在这里有一个应用程序的回购...... [https://github.com/thejourneydude/template](https://github.com/thejourneydude/template)

我的问题是，为什么我的退出功能不起作用，为什么我每次去 localhost 时都会自动登录？我正在关注 Hartl 的教程，但有一些偏差，所以如果你已经完成了教程，这应该看起来很熟悉。

这是会话控制器页面...

```
class SessionsController < ApplicationController

def new
end

def create
  user = User.find_by_email(params[:session][:email].downcase)
  if user && user.authenticate(params[:session][:password])
    #sign user in
    sign_in user
    redirect_back_or user
  else
    #create an error
    render 'new'
    flash.now[:error] = "Invalid email/password combination"
  end
end

def destroy
  sign_out
  redirect_to root_url
end

end 
```

这是会话帮助页面...

```
module SessionsHelper

  def sign_in(user)
    session[:remember_token] = user.remember_token
    self.current_user = user
  end

  def signed_in?
    !current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(session[:remember_token])
  end

  def current_user?(user)
    user == current_user
  end

  def sign_out
    self.current_user = nil
    session.delete(:remember_token)
  end

  def redirect_back_or(default)
    redirect_to(session[:return_to] || default)
    session.delete(:return_to)
  end

  def store_location
    session[:return_to] = request.url
  end

end 
```

这是我的用户模型页面

```
class User < ActiveRecord::Base

  attr_accessible :name, :email, :password, :password_confirmation

  has_secure_password

  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  validates :name,  presence: true, length: { maximum: 50 }

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i

  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX }, uniqueness: { 
  case_sensitive: false }

  validates :password, length: {minimum: 6}

  validates :password_confirmation, presence: true

  private
     def create_remember_token
      self.remember_token = SecureRandom.urlsafe_base64
     end

end 
```

顺便说一句，每当我点击退出按钮时，这里就是我的开发日志。

```
Started DELETE "/signout" for 127.0.0.1 at 2012-11-09 20:38:32 -0500
Processing by SessionsController#destroy as HTML
  Parameters: {"authenticity_token"=>"i9mqiuYTW3YWxNU5h1RdtgTeb/2oOWPJU2yjjZQWMfw="}
Redirected to http://localhost:3000/
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)

Started GET "/" for 127.0.0.1 at 2012-11-09 20:38:32 -0500
Processing by StaticPagesController#home as HTML
  Rendered static_pages/home.html.erb within layouts/application (1.2ms)
  Rendered layouts/_shim.html.erb (0.1ms)
  [1m[36mUser Load (1.1ms)[0m  [1mSELECT "users".* FROM "users" WHERE 
"users"."remember_token" IS NULL LIMIT 1[0m
  Rendered layouts/_header.html.erb (6.9ms)
  Rendered layouts/_footer.html.erb (1.4ms)
Completed 200 OK in 83ms (Views: 81.1ms | ActiveRecord: 1.1ms) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T04:05:35.157

我可以在您发布的代码中看到的唯一问题是当前用户方法当前不检查会话中是否存在 remember_token。

```
 def current_user
    @current_user ||= User.find_by_remember_token(session[:remember_token])
  end 
```

如果没有设置 remember_token，上面的代码将导致一个查询，该查询试图找到一个没有 remember_token 的用户。如果它找到这样的用户，它将登录该用户。

尽管我看到您有一个 after_create 回调来为用户设置记住令牌，但您的开发数据库可能包含在您添加回调之前创建的此类用户。

以这样的方式更改代码可能是个好主意，即在查询数据库之前检查 remember_token 的存在

```
def current_user
 if session_token[:remember_token]
  @current_user ||= User.find_by_remember_token(session[:remember_token])
 end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T04:39:17.947

I solved the issue by doing a db:reset and commenting out redirect_signed_in_user before filter method in Users controller. Thanks for the help everyone.

# ruby-on-rails - Rails：发送延迟作业的视图？

> ID：13318300
> 
> 赞同：0
> 
> 时间：2012-11-10T01:20:04.967
> 
> 标签：ruby-on-rails, ruby, delayed-job

我有一个执行大量非常昂贵的嵌套查询的 Rails 视图。我希望将繁重的工作投入到延迟的工作中，吐出一个缓存文件，并通过 ajax 轮询所述缓存。

我经常做这种事情，但通常我会缓存查询（而不是整个视图）。在这种情况下，编写 SQL 以包含所需的所有内容需要很长时间，我宁愿将整个部分模板渲染到 delay_job 中。

......这就是乐趣开始的地方。我遇到了很多错误，尤其是与 form_helpers、设计身份验证等相关的错误。简而言之，有没有人对以下任何一个有任何建议：

*   在延迟作业中呈现部分视图（或返回动作的呈现）的简单方法？
*   实现上述目标的一种简单方法，无需写出一个令人费解的 SQL/ActiveRecord 查询是什么？

任何想法表示赞赏 - 非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:32:50.870

好吧，以一种相对简单的方式渲染视图本身是可能的，看看[这个教程](http://www.amberbit.com/blog/render-views-and-partials-outside-controllers-in-rails-3)。

但是，我会研究代码和设置，以便能够回答以下问题：

1.  是否可以优化系统以避免延迟渲染？检查您的数据库索引、使用查询和数据库设置可能会将您认为不可能的事情变为真实情况。

2.  在延迟作业中收集数据，将其序列化为 json 并在浏览器端执行演示就足够了吗？通过这样做，如果您发现瓶颈并决定将处理移回 webapp，那么您就可以自行返回。

3.  预计算（使用结构更简单的表）可能有帮助吗？您始终可以在后台填充这些表格，甚至可以使用触发器并让您的应用程序以直接的方式工作。

希望以上任何内容有所帮助:)

# node.js - 如何让 Node.js REST 客户端能够与 ServiceStack JSON 服务通信

> ID：13318301
> 
> 赞同：2
> 
> 时间：2012-11-10T01:20:17.527
> 
> 标签：node.js, servicestack

我在获取用 Node.js 编写的休息客户端以能够将数据（通过 GET）发送到基于 JSON 的 ServiceStack 服务时遇到问题。它给了我一个序列化错误。但是，我已将相同的 JSON（由我的 Node.js REST 客户端生成）复制并粘贴到通过 CURL 发送的对 ServiceStack 服务的调用中，并且 ServiceStack 对 JSON 没有问题——再次......仅作为只要它来自 CURL。

任何人都可以提供的任何指示或进一步的启示将不胜感激！

谢谢，

塔米

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T03:45:31.467

所以我想出了如何在 Node.js 中而不只是在 CURL 中（向 ServiceStack JSON 服务发送/接收 JSON）。

我做了以下事情：

*   使用“restler”包作为我的 http 通信包装器
*   使用restler的“get()”方法...不要使用“json()”方法
    （代码片段如下...）

    ```
    var obj = {};
    obj.objectName = 'foo';
    obj.foos = [{firstname: 'foo1', lastname: 'foo-you'}, {firstname: 'foo2', lastname: 'foo-you-2'}];
    var json = JSON.stringify(obj);
    var options = {
        method: "get",
        data: json,
        headers: {'Content-type': 'application/json', 'Accept': 'application/json'}
    };
    rest.get('http://localhost/servicestack-api/getmethod', options).
        on('complete', function(data, response){
            console.log(data);
            console.log(response.statusCode);

        }); 
    ```

*   确保在上面填写正确的 url 和远程 DTO 到您的 ServiceStack 服务和方法

**供参考**

如果您的 json 没有序列化到 ServiceStack 中的远程 DTO，一种快速的测试方法是将存储在上面“json”变量中的 json 复制并粘贴到 curl 命令中，以查看它是否以这种方式正确序列化。
（下面的示例卷曲片段......）

这就是我最初所做的（请参阅原始问题）以尝试解决序列化问题。它帮助我将问题隔离到 restler/Node.js 方面，因此我可以进行您在上面看到的修改——即不使用 restler 的“json()”方法。

```
 curl -v -H "Accept: application/json" -H "Content-type: application/json" -X GET -d '{"foos":[{"firstname":"foo1","lastname":"foo-you"}, {"firstname": "foo2", "lastname": "foo-you-2"}],"objectName": "foo"}' http://localhost/servicestack-api/getmethod 
```

# vim - 在 Vim 中使用 write 命令时“按我的意思做，而不是按我说的做”

> ID：13318302
> 
> 赞同：1
> 
> 时间：2012-11-10T01:20:29.553
> 
> 标签：vim, save

尽管我是一个相对精确的打字员，但当我在 Vim 中敲回车时，经常会碰到撇号字符是一个常见的错误。尤其是当我尝试键入`:w<CR>`或时会发生这种情况`wq<CR>`。我最终输入了`:w'<CR>`，甚至更糟的是，`:wq'<CR>`除了没有按照我的意图进行操作之外，它还会给出几个大的红色错误消息。有没有可以用来克服这个问题的映射或其他技术？我无法想象我为什么要写一个名为 的文件`'`，所以我不担心完全阻止这种可能性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T01:24:17.300

你可以这样做`cnoremap '<cr> <cr>`。我无法想象命令模式命令会以`'`. 通常如果需要引号，我会使用双引号。如果有，请稍等片刻，然后再按 Enter`''<bs><cr>`或其他东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T05:05:57.270

您必须小心使用命令映射（和缩写），它们通常会在不应该触发时触发，例如在搜索期间或在命令参数中间。我通常更喜欢使用表达式缩写。

将以下内容放入您的`~/.vimrc`:

```
cnoreabbrev <expr> w getcmdtype() == ':' && getcmdline() ==# 'w' ? 'w' . EatChar("'") : 'w'
cnoreabbrev <expr> wq getcmdtype() == ':' && getcmdline() ==# 'wq' ? 'wq' . EatChar("'") : 'wq'

function! EatChar(pat)
  let c = nr2char(getchar(0))
  return (c =~ a:pat) ? '' : c
endfunction 
```

此缩写使用一个名为的函数，该函数`EatChar`采用在缩写展开后将被“吃掉”或忽略的模式。有关`:helpg Eatchar`其用法的不同示例，请参阅。

仅当满足以下所有条件时，缩写词才会扩展并寻找“吃”报价：

*   处于正常前模式：`getcmdtype() == ':'`
*   在命令的开头：`getcmdline() ==# 'w'`

否则缩写扩展为与`{lhs}`ie`w`或`wq`

这种方法的缺点：

*   表达式缩写需要 vim 7+
*   如果出于某种原因您确实要键入`:w'`，则必须键入两次引号，请使用空格将命令与文件名分开，或键入`Ctrl`+`v`后跟`'`
*   必须为每个胖指法场景创建一个额外的缩写

有关更多信息，请参阅：

```
:h abbreviations
:h :map-<expr>
:h getcmdtype(
:h getcmdline(
:helpg Eatchar 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-10T01:20:29.553

这是一种解决方法：

```
cnoremap w'<CR> w<CR>
cnoremap wq'<CR> wq<CR> 
```

这会创建一个命令模式映射，将我错误的命令转换成我想要的。但是，它有两个缺点：

1.  这意味着撇号必须直接在其他字符之后输入。如果有一个暂停，然后我连枷`Enter`键，击中撇号键，我会遇到同样的问题。
2.  在此期间，当 Vim 给你一点时间来输入撇号时，光标不会前进（这是映射的典型行为）。如果您是观看您正在输入的命令的人，这可能会以其他方式使您感到困惑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-10T07:28:14.140

我知道这不是您要的确切答案，但我可能会为您提供不同的解决方案。

在您的情况下，您正在询问保存文件以及保存和退出。也许使用其他方法之一来完成这些任务对你来说会更好。

`Z``Z`如果修改，将保存文件，然后退出窗口。

为了保存文件，我做了一个领导者命令来缩短我必须按下的键数

```
nnoremap <silent> <leader><leader> :write<cr> 
```

您只需按两次前导键即可保存文件。我的领导是`,`。所以我只是点击`,``,`并保存了文件。

# python - Python 套接字 GetAddrInfo (GAI) 错误

> ID：13318304
> 
> 赞同：3
> 
> 时间：2012-11-10T01:20:37.977
> 
> 标签：python, linux, sockets, embedded-linux, ntp

我在嵌入式 linux 系统上运行 Python (2.7.2) 大致具有以下启动顺序：

0) 重启

1) 等待 2 分钟

2) 通过 DHCP 获取网络配置

守护进程使用[ntplib](http://pypi.python.org/pypi/ntplib/)获取当前时间并相应地更新其时钟。

```
import ntplib  # http://pypi.python.org/pypi/ntplib/
...

    self.ntpClient = ntplib.NTPClient()
...

def getDate(self):

    try:
        logging.info('Sending NTP request to %s' % ('pool.ntp.org'))
        response = self.ntpClient.request('pool.ntp.org')
        secs = time.localtime(response.tx_time)
        logging.info('Response returned')
        return secs

    except Exception, e:
        logging.exception(e)
        return RESULT_FAILURE 
```

如果守护进程在 dhcp 运行*之前*开始尝试解析地址信息（步骤 2），则会出现问题。**即使在**DHCP 客户端运行之后，这仍然是一个错误。

这是一个例外：

```
ERROR:[Errno 2] temporary failure in name resolution.
Traceback (most recent call last):
  File "/home/root/ntp_manager/ntp_manager.py", line 34, in getDate
    response = self.ntpClient.request('pool.ntp.org')
  File "/usr/lib/python2.7/ntplib.py", line 265, in request
    addrinfo = socket.getaddrinfo(host, port)[0]
gaierror: [Errno 2] temporary failure in name resolution. 
```

但是，如果 ntpClient在 dhcp*之后进行**第一次*尝试，那么一切正常。

 *就好像错误是某种缓存的产物（？！）

我已经没有想法了，非常感谢一些帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T19:26:55.997

我已经制定了一个不需要任何其他库或脚本的解决方案。

目录中的脚本`/etc/network/if-up.d/`将在启动网络接口时执行。这是一个[参考](https://askubuntu.com/questions/47873/check-if-ip-is-static-or-dynamic-programmatically)。

因此，这确保了一旦系统配置了 DHCP 客户端并因此连接到 Internet，我的 NTP 脚本就会被执行。这是避免我遇到的名称解析问题的正确行为。

我已经把这个简单的脚本（和`chmod +x`它！）放在一起，它检查网络方法是 dhcp，然后初始化我的 NTP 守护进程。

```
#! /bin/sh
# ntp time-sync manager python daemon starter script

set -e

# ... Some Stuff Omitted Here ...

if [ "$METHOD" = dhcp ]; then
  echo -n "Starting $DESC..."
  start-stop-daemon --start --verbose --pidfile $PIDFILE --exec $DAEMON -- $DAEMON_ARGS
  echo "METHOD: $METHOD"
  echo "IFACE: $IFACE"
fi

echo "Exiting if-up.d/ntp_manager"
exit 0 
```

这是系统上发生的情况的转储。请注意这一行：`run-parts /etc/network/if-up.d`在解析 IP 后立即执行。

```
Reconfiguring network interfaces eth0 with DHCP... cat: can't open '/var/run/udh
cpc.eth0.pid': No such file or directory
run-parts /etc/network/if-pre-up.d
ifconfig eth0 up
udhcpc -R -b -p /var/run/udhcpc.eth0.pid -i eth0
udhcpc (v1.13.2) started
Sending discover...
Sending discover...
Sending select for 192.168.1.145...
Lease of 192.168.1.145 obtained, lease time 86400
adding dns 192.168.1.1
run-parts /etc/network/if-up.d
Starting NTP Time Manager...Daemon PID 1059
Redirecting serivice startup output to /home/root/Connect/log/ntp_manager_daemon.log
METHOD: dhcp
IFACE: eth0
Exiting if-up.d/ntp_manager 
```

无论如何，我认为这是一个足够简单和强大的问题解决方案。希望它会在未来对其他人有所帮助。*

# c++ - Matlab fmincons 和 C++ 的 NLP 求解器（如 ipopt）之间的性能差距是多少？

> ID：13318308
> 
> 赞同：6
> 
> 时间：2012-11-10T01:21:24.487
> 
> 标签：c++, matlab, optimization, nonlinear-optimization, ipopt

我即将为实时应用程序编写一个算法，其中涉及一些高维 NLP（非线性规划）。

在实现之前，我需要对我的算法进行计时，看看它是否适用于实时应用程序，因此我使用 Matlab 的内置 fmincons 作为基线。

经验表明，matlab 算法的速度往往比 C++ 算法慢，所以我想估计在这种特殊情况下我可以期待什么样的性能提升？

由于我的工作主要与实时应用程序相关，因此我很少使用 NLP（非线性编程），所以我问了我的同事，他们建议我尝试 ipopt 作为开始，我在其网站上进行了谷歌搜索，那里没有针对 Matlab 的基准，也没有太多关于他们算法细节的话题（至少在Matlab中，不难检查他们的算法细节），所以我基本上对它的准确性/鲁棒性/最优性等知之甚少。

因此，这里有关 NLP 的 C++ 实现的任何帮助都会非常有帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T15:29:15.840

许多这类问题都由大型 O(n^~3) 矩阵乘法支配。如果是这种情况并且两个系统都使用相同的算法，那么性能将相似并且不依赖于语言，因为底层矩​​阵乘法函数无论如何都将在 asm 中本地实现。

如果该算法不是由像这样的简单函数支配，而是需要大量的内存管理，那么 C++ 库将胜出很多（快 3-10 倍）。

（如果性能比许多人使用 OpenCL 将东西移植到专为此类数值计算而设计的 GPU 至关重要，并且价格/性能差异在 20-100 倍范围内。或者您可以将其移植到集群如果您需要更快。）

# validation - 从验证公式中获取动态范围的地址

> ID：13318311
> 
> 赞同：0
> 
> 时间：2012-11-10T01:23:02.893
> 
> 标签：validation, vba, excel

`OFFSET`我的代码使用取决于该单元格地址的公式给出的范围在单元格上设置列表验证。

因为这个验证是在已经有内容的单元格上以编程方式设置的，所以我想要一个函数来确定单元格的现有内容是否违反验证。

我使用以下代码对此进行测试时遇到了问题：

```
Sub test()
    Dim sht As Worksheet
    Dim rng As Range
    Dim formula As String
    Dim rangeName As String
    Set sht = ThisWorkbook.Sheets("Sheet1")
    With sht
        .Range("a1").Value = "a"
        .Range("a2").Value = "aa"
        Set rng = .Range("b1")
        formula = "=OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-1,2,1)"
        rng.Validation.Add Type:=xlValidateList, Formula1:=formula
        rangeName = Replace(formula, "=", "")
        Set ResultRange = .Range(rangeName).Find(rng.Value, lookat:=xlWhole)
        If ResultRange Is Nothing Then
            Debug.Print "violates validation"
        Else
            Debug.Print "validated"
        End If
    End With
End Sub 
```

该测试应将下拉验证分配给具有单元格和`B1`内容的单元格，然后检查的内容是否与这些单元格中的任何一个匹配。但它失败并出现此错误：`A1``A2``B1``Set ResultRange`

`Method 'Range' of object '_Global' failed.`

我认为问题在于，当我调用 时`Range(rangeName)`，Excel 不知道将`ROW()`and应用`COLUMN()`到哪个单元格，因此我需要以某种方式计算`formula`该单元格解析为的地址——在这种情况下`$A$1:$A$2`，，以便我可以分配那个值为`RangeName`。

那么，给定`OFFSET()`我将动态参数传递给的这个公式，我如何获得这个公式为指定范围返回的范围`rng`？

编辑：由于公式可能会根据不同的情况而改变，我正在寻找一种解决方案，给定`OFFSET()`从某个范围开始的公式，返回该公式给出的范围。硬编码的解决方案是不可接受的，因为`OFFSET()`表格中有几个类似这样的不同公式，并且每次更改其中一个公式时更改验证测试的代码是不切实际的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T03:00:45.060

这不漂亮，但会做你喜欢你必须已经定义的事情`rng`，并且`rng`不能在 A 列中：

```
rangeName = .Range(.Cells(rng.Row, rng.Column - 1), .Cells(rng.Row + 1, rng.Column - 1)).Address 
```

另请注意，默认情况下，您的验证将忽略空白，因此您可能需要更新 if 以检查空白：

```
If ResultRange Is Nothing And rng.Value <> "" then
    Debug.Print "violates validation"
Else
    Debug.Print "validated"
End If 
```

根据要求进行编辑，我继续将 OffsetFormula 设为可选，因为它将假定传递的范围具有需要解析的公式：

```
Function ReturnRange(initialRange As Range, Optional OffsetFormula As String) As Range
    Dim parameters
    Dim upBound As Long
    Dim topLeftCell As Range
    Dim bottomRightCell As Range
    On Error Resume Next
    'If an error occurs result will be Nothing
    If OffsetFormula = "" Then OffsetFormula = initialRange.Formula
    If UCase(Left(OffsetFormula, 7)) = "=OFFSET" Then
        parameters = Split(Left(OffsetFormula, Len(OffsetFormula) - 1), ",")
        'Using upbound variable to avoid constant calls to Ubound(parameters)
        upBound = UBound(parameters)
        Set topLeftCell = initialRange.Offset(parameters(upBound - 3), parameters(upBound - 2))
        Set bottomRightCell = topLeftCell.Offset(parameters(upBound - 1) - 1, parameters(upBound) - 1)
        Set ReturnRange = Range(topLeftCell, bottomRightCell)
    End If
End Function 
```

# ios - UICollectionView：不同大小的项目不计算重复使用的项目

> ID：13318317
> 
> 赞同：12
> 
> 时间：2012-11-10T01:24:30.880
> 
> 标签：ios, uicollectionview, uicollectionviewcell

我有一个包含不同项目大小的集合视图，我在其中声明

```
- (CGSize)collectionView:(UICollectionView *)collectionView
                  layout:(UICollectionViewLayout*)collectionViewLayout
  sizeForItemAtIndexPath:(NSIndexPath *)indexPath {

    FeedItem *item = [_imagesLinkArray objectAtIndex:indexPath.row];
    return CGSizeMake(250, 200*item.sizeFactor);
} 
```

当单元格在`collectionView:cellForItemAtIndexPath:` 项目中被重用时，将使用重用的项目大小而不是`sizeForItemAtIndexPath:`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T12:14:20.603

`collectionView:layout:sizeForItemAtIndexPath:`在呈现 CollectionView 之前，似乎在布局准备时调用了一次。

因此，每当您滚动并且单元格出列时，它都会调整为`collectionView:layout:sizeForItemAtIndexPath:`准备阶段提供的大小。您是否希望在具有特定 indexPath 的单元格可见时调用此方法？这样您就可以动态更改单元格大小？似乎这不是这种方法可以使用的方式，它可用于在布局准备阶段确定单元格的大小。

如果您出于某种原因需要重新计算尺寸，您可以使用`[UICollectionViewLayout invalidateLayout]`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T21:01:16.710

集合视图似乎比`UITableView`. 您必须将底层模型的大部分更改通知集合视图，例如通过调用`[collectionView reloadData]`或`[collectionView insertItemsAtIndexPaths:indexPaths]`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-27T13:36:46.407

您需要在**自定义布局类中****重写**此函数。如果您使用自定义布局。

 **```
override func shouldInvalidateLayoutForBoundsChange(newBounds: CGRect) -> Bool {
return true
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-08-25T23:25:12.597

您可以简单地覆盖滚动视图委托

```
func scrollViewDidScroll(_ scrollView: UIScrollView) {
    collectionView.collectionViewLayout.invalidateLayout()
} 
```**

# php - 我需要知道如何判断是否没有设置单选按钮

> ID：13318318
> 
> 赞同：1
> 
> 时间：2012-11-10T01:24:38.210
> 
> 标签：php

我需要知道如何判断是否没有设置单选按钮。我有一个在我的 javascript 验证例程中工作的 jquery 示例，它看起来像这样：

```
function validate_veteran($form) {
    if ($('input[name=veteran]:checked').length <1) {
        return "please make a selection for veteran.<br>";
    }
    return "";
    } 
```

如果我能找到一种在 PHP 中执行此操作的方法，我会做好准备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:29:24.467

```
if (!isset($_POST['veteran']))
{
    echo "please make a selection for veteran.<br>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:29:33.813

根据`value`您在 HTML 标记中为复选框提供的属性，您可以测试那里是否存在值。

假设表单是使用 POST 方法发送的 -

```
if (isset($_POST['veteran'])){
   // there is a value
} 
```

如果你设置一个特定的值，那么你可以测试它。

```
<input type="radio" value="yes" name="veteran" /> 
```

```
if ($_POST['veteran'] == 'yes'){
  // value is set to yes
} 
```

在检测到问题后如何决定采取行动取决于您以及您如何构建您的网站。您可能希望将用户重定向到详细说明问题的错误页面，或者您可能返回带有状态和错误参数的 JSON 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:29:42.063

您可以验证是否将值发送到您的 php 脚本

```
if (empty($_REQUEST['veteran'])) {
    // user did not selected a radio option
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-10T02:30:46.277

**jQuery 解决方案** 如果您想在将表单发送到浏览器之前对其进行验证。我想您的验证按钮是：

```
<input type="submit" id="send" value="Send" /> 
```

您将有一个总结如下的验证过程：

```
jQuery('#send') .click(function(){
if($('#radio_button').is(':checked')){
     alert("Please make a selection for veteran.<br>");
      return false;/*important! prevents the form from being sent  */
     }
}); 
```

**PHP 解决方案** 如果未启用或不支持 javascript 这将适用于 GET 或 POST 方法，但这里是 POST 的示例。

```
if (!isset($_POST['veteran']) || empty($_POST['veteran']))
{
    echo "please make a selection for veteran.<br>";
} 
```

注意：您可能需要检查某些浏览器插件是否没有为单选按钮分配空值。

# mysql - 如何更好地设计这张桌子？

> ID：13318320
> 
> 赞同：2
> 
> 时间：2012-11-10T01:24:48.643
> 
> 标签：mysql, sql, database, database-design

我有一张名为`interests`每个学生的学校科目的表格。

学生**必须**至少有 3 个学科兴趣，最多 7 个。

可能的主题兴趣是：

*   科学
*   数学
*   英语
*   历史
*   艺术
*   体育
*   外语

但是，在我的两种表格设计中，我都无法弄清楚如何规范化表格。

* * *

第一个表：`interests`（8列）

```
student_id(pk) | interest_1 | interest_2 | ... | interest_7 
```

在这个设计`interests_1`中`interest_7`是列。如果一个学生选择科学、数学和英语作为他的兴趣，那么

*   `interest_1`被设定为`science`
*   `interest_2`被设定为`math`
*   `interest_3`被设定为`english`
*   `interest_4`设置`interest_7`为`null`

* * *

第二个表：`interests`（8列）

```
student_id(pk) | science | math | english | ... | foreign_lanaguage 
```

在这个设计中，学校科目现在是列。如果学生的兴趣是科学、数学和英语，则这些列设置为`true`，其余列设置为`false`。

*   `science`被设定为`true`
*   `math`被设定为`true`
*   `english`被设定为`true`
*   `history`被设定为`false`
*   `art`被设定为`false`
*   `physical_education`被设定为`false`
*   `foreign_language`被设定为`false`

* * *

我还能如何设计这张桌子？

而且，我如何只选择特定学生感兴趣的科目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:38:44.987

这实际上取决于您想要的可扩展性。一方面，您的设计有效。

另一方面，如果要添加新类，则必须进入并修改表。

另一种方法是有 3 个表：

**学生** 证、姓名

**类** ID、名称

**StudentInterrests** ID、StudentID、ClassID

如果学生班级组合没有出现在 studentinterrests 表中，则他们对课程不感兴趣

您选择的学生兴趣如下所示：

```
SELECT StudentName, CourseName
FROM Student
LEFT JOIN StudentInterrests ON Student.ID = StudentInterrests.StudentID
LEFT JOIN Class ON StudentInterrests.ClassID = Class.ID 
```

您的结果将是：
*John、Math
John、English
John、SocialStudies*

**对于您的最小和最大要求：**我建议将要求放在应用程序级别，因为它似乎比对数据库的约束更多的是应用程序逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T02:34:19.687

好的，为了满足您的要求，您的设计将起作用。我看到另外两个可以满足给定规范的易于实现的选项。

1.) 7个兴趣表外键为兴趣表的学生表；使用一组独特的约束来确保没有学生有两个相同的兴趣。使用可为空的外键并允许在项目 4-7 上使用空值。

2.) 打破利益表。该规则的工作原理 99% 相同，尽管强制性兴趣只会在选择兴趣后触发约束（因此学生可以有 0 或 3-8 个兴趣）。这是一种稍微合理的方法，因此您可以将学生表与兴趣分开填充。这使事情具有可扩展性。

这两种方法都属于第三范式，适用于符合 ANSI-92 的数据库。SQL server 中#2 的示例实现如下。

![表格布局](../Images/775af74683d86c49a652e817e394da8d.png)

```
USE [DB]
GO
/****** Object:  Table [dbo].[Interests]    Script Date: 11/9/2012 8:32:39 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[Interests](
    [interestID] [int] IDENTITY(1,1) NOT NULL,
    [interestText] [varchar](255) NOT NULL,
    [interestDescription] [varchar](max) NULL,
 CONSTRAINT [PK_Interests] PRIMARY KEY CLUSTERED 
(
    [interestID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[StudentInterests]    Script Date: 11/9/2012 8:32:39 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentInterests](
    [studentInterestID] [int] IDENTITY(1,1) NOT NULL,
    [studentID] [int] NOT NULL,
    [interestID_1] [int] NOT NULL,
    [interestID_2] [int] NOT NULL,
    [interestID_3] [int] NOT NULL,
    [interestID_4] [int] NULL,
    [interestID_5] [int] NULL,
    [interestID_6] [int] NULL,
    [interestID_7] [int] NULL,
    [interestID_8] [int] NULL,
 CONSTRAINT [PK_StudentInterests] PRIMARY KEY CLUSTERED 
(
    [studentInterestID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_1] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_1] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_2] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_2] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_3] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_3] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_4] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_4] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_4] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_5] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_5] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_6] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_6] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_7] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_7] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_8] UNIQUE NONCLUSTERED 
(
    [studentInterestID] ASC,
    [interestID_8] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [IX_StudentInterests_9] UNIQUE NONCLUSTERED 
(
    [studentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Students]    Script Date: 11/9/2012 8:32:39 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[Students](
    [studentID] [int] IDENTITY(1,1) NOT NULL,
    [firstName] [varchar](255) NOT NULL,
    [lastName] [varchar](255) NOT NULL,
 CONSTRAINT [PK_Students] PRIMARY KEY CLUSTERED 
(
    [studentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests] FOREIGN KEY([interestID_1])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests1] FOREIGN KEY([interestID_2])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests1]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests2] FOREIGN KEY([interestID_3])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests2]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests3] FOREIGN KEY([interestID_4])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests3]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests4] FOREIGN KEY([interestID_5])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests4]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests5] FOREIGN KEY([interestID_6])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests5]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests6] FOREIGN KEY([interestID_7])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests6]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Interests7] FOREIGN KEY([interestID_8])
REFERENCES [dbo].[Interests] ([interestID])
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Interests7]
GO
ALTER TABLE [dbo].[StudentInterests]  WITH CHECK ADD  CONSTRAINT [FK_StudentInterests_Students] FOREIGN KEY([studentID])
REFERENCES [dbo].[Students] ([studentID])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[StudentInterests] CHECK CONSTRAINT [FK_StudentInterests_Students]
GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:36:11.053

规范化时，为您正在创建的每个表识别正确的主键很重要。将字段分解为最基本的形式。你有什么？你有 student_id 和兴趣。由于兴趣可以是真或假，您可以将兴趣的名称存储在与其他兴趣相同的列中，因此如果它们不存在于学生 ID 上，则该学生对它们不感兴趣。

这是一个家庭作业问题，所以为你解决这个问题似乎很愚蠢。相反，我会让你走上正轨。student_id 不是您要查找的主键，而是一个索引。您正在寻找最理想的数据结构的 3 列表。

# mongodb - symfony2 应用程序：mongodb 副本集故障转移需要 apache 重启

> ID：13318321
> 
> 赞同：0
> 
> 时间：2012-11-10T01:24:58.040
> 
> 标签：mongodb, symfony, doctrine

我的 Symfony2 应用程序连接到 MongoDB 副本集（2 个完整节点和一个仲裁器）。故障转移完成后（已成功选出新的主节点），许多 Web 请求会导致服务器错误。如果我重新启动 Apache（但不进行其他更改），异常就会消失，应用程序会按预期工作（查询新的主节点，没问题）。

在重新启动 Apache 之前`MongoCursorException`，我收到消息`not master and slaveOk=false`或`couldn't determine master`. 不一致：似乎这取决于我遇到的 Apache 工人。或者其他的东西。无论如何，重新启动 Apache 似乎可以立即修复应用程序，并且所有查询都正常成功。

我的副本集是为了冗余，而不是性能，所以我从不使用 slaveOk=true。

这些选项被传递给 Mongo 构造函数：

*   `connect => TRUE`
*   `replicaSet => foo`

我在用着：

*   PHP 5.3.10
*   APC 3.1.7
*   MongoDB 2.2.1
*   Symfony2 版本 2.0.18

从我的`deps`文件：

*   教义 2.1.7
*   学说-mongodb 1.0.0-BETA1
*   学说-mongodb-odm 1.0.0-BETA5
*   学说通用 2.2.0
*   教义-dbal 2.1.7

闻起来像是 Symfony2 应用程序试图重用过时的 MongoDB 连接。主要的日志支持这种猜测：当我点击应用程序网页并进行查询时，连接会增加，当我重新启动 apache 时，会释放许多连接。

*   我需要强制清除我的 APC 缓存吗？
*   发生故障转移事件后，我是否只需要重新启动所有网络服务器？（其他人到底在做什么？）
*   我需要玩[`mongo.is_master_interval`](http://www.php.net/manual/en/mongo.configuration.php#ini.mongo.is-master-interval)吗？
*   我认为[`retry_query`并且`retry_connect`会自动消除故障转移](https://stackoverflow.com/questions/11125389/doctrine-odm-mongodb-not-retrying-queries)，但事实并非如此。我需要在我的代码中添加 try/catch 块吗？

有关的：

*   [Doctrine ODM / MongoDB 不重试查询？](https://stackoverflow.com/questions/11125389/doctrine-odm-mongodb-not-retrying-queries)（我正在尝试新的`retry_query`和`retry_connect`选项）

可能相关：

*   [使用自动故障转移时的 PHP MongoDB 错误](https://stackoverflow.com/questions/5961951/php-mongodb-errors-when-using-automatic-failover)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T18:47:06.920

假设您使用的是 PHP 驱动程序的 1.2.12 版，我是否正确？鉴于重新启动 Apache 似乎可以解决问题，看起来驱动程序只是在其池中重新使用错误的连接。重新启动 Apache 及其工作程序可以有效地清除所有池，因为每个工作程序都有自己的连接池，可以在其生命周期内服务的请求之间共享。完全有可能一些工作人员在故障转移后刷新了他们的连接，而另一些工作人员没有，这将导致您仍然会收到异常，具体取决于哪个工作人员被击中。

连接处理在 1.3.0 中进行了大修，因此升级后您应该会看到故障转移支持方面的一些改进。[一旦PR #81](https://github.com/doctrine/mongodb/pull/81)被合并， Doctrine MongoDB 应该正确支持 1.3.0 ，ODM 紧随其后。

Doctrine 中的`retry_`选项不支持连续尝试之间的延迟，这使得它们不太适合处理可能需要 10-30 秒的故障转移。我相信 Jon 对他们的初衷是处理掉线和网络故障。

我还要注意，在 PHP 驱动程序 1.3.0 之前，`mongo.is_master_interval`INI 设置从未真正使用过。这已在[PHP-576](https://jira.mongodb.org/browse/PHP-576)中修复。

# java - 这个链表类看起来有效吗？

> ID：13318324
> 
> 赞同：-3
> 
> 时间：2012-11-10T01:25:12.080
> 
> 标签：java, linked-list

我有我制作的这个链表类，我知道如何测试它，你认为它有效吗？或者你能解释一下我如何测试它吗？

```
public class List {

private int size;
private Node head;
private Node current;
private Node prev;
private Node temp;

/**
 * Creates an empty list.
 * @pre none
 * @post and empty list is created
 */ 

public List(){
    head = null;    
}

/**
 * Delete the current element from this list. The element after the deleted element becomes the new current. 
 * If that's not possible, then the element before the deleted element becomes the new current. 
 * If that is also not possible, then you need to recognize what state the list is in and define current accordingly.
 * Nothing should be done if a delete is not possible.
 * @pre there is a current element
 * @post the item current pointed to is removed, the element before or after is the new current
 */

public void delete(){
    if(current.getNext() != null){
        current = current.getNext();
        prev.setNext(current);
        size--;
    }
    else 
        if(current.getNext() == null){
        current = prev;
        current.setNext(null);
        resetPrev();
        size--;
    }
}

/**
 * Get the value of the current element. If this is not possible, throw an IllegalArgumentException.
 * @pre the list is not empty
 * @post the current element's data is returned
 * @return value of the current element.
 */

public char get(){
    return current.getItem();
}

/**
 * Go to the last element of the list. If this is not possible, don't change the cursor.
 * @pre there is a current element
 * @post current is now the last element in the list
 */

public void goLast(){
    while (current.getNext() != null){
        current = current.getNext();
    }
}

/**
 * Advance the cursor to the next element. If this is not possible, don't change the cursor.
 * @pre there is a current element
 * @post current is now the element after what it was
 */

public void goNext(){
    if(current.getNext() != null){
        current = current.getNext();
        }
    //else do nothing
}

/**
 * Retreat the cursor to the previous element. If this is not possible, don't change the cursor.
 * @pre
 * @post
 */

public void goPrev(){
    current = prev;
    resetPrev();
}

/**
 * Go to top of the list. This is the position before the first element.
 * @pre
 * @post
 */

public void goTop(){

}

/**
 * Go to first element of the list. If this is not possible, don't change the cursor.
 * @pre none
 * @post current is now pointing to the first node of the list, the head
 */

public void goFirst(){
    current = head;
}

/**
 * Insert the given parameter after the current element. The newly inserted element becomes the current element.
 * @pre none
 * @post newVal is inserted into the list and is now the current element
 * @param newVal is the value to insert after the current element.
 */ 

public void insert(char newVal){
    if(head == null){
        head = new Node(newVal);
        size++;
    }
    else{
        Node current = head;
        while(current.getNext() != null){
            current = current.getNext();
        }
        Node prev = current;
        current = new Node(newVal);
        prev.setNext(current);
        size++;
    }
}

/**
 * Determines if this list is empty. Empty means this list has no elements.
 * @pre none
 * @post a boolean value of the state of the list is returned
 * @return true if the list is empty.
 */

public boolean isEmpty(){
    return head == null;
}

/**
 * Determines the size of the list. The size of the list is the number of elements in the list.
 * @pre none
 * @post size is accessed and returned
 * @return size which is the number of elements in the list.
 */

public int size(){
    return size;
}

public void resetPrev(){
    //reset prev to prev's previous
    Node temp = head;
    while(temp != current){
        temp = temp.getNext();
    }
    prev = temp;
}

public class Node {

    private char item;
    private Node next;

    public Node(char val) {
        this.item = val;
    }

    public char getItem() {
        return this.item;
    }

    public Node getNext() {
        return this.next;
    }

    public void setNext(Node next) {
        this.next = next;
    }
}

} 
```

感谢您的帮助，我仍然很新，所以我不确定如何做这些，我什至不确定它是否一直有效，这就是我想测试它的原因！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:51:40.187

去测试：

我建议为每种方法编写一些 JUnit 测试用例。这是您需要开始的地方[http://www.junit.org](http://www.junit.org)

如果您使用的是 Eclipse IDE，Lars Vogel 是我最喜欢的资源之一。完成他的[教程](http://www.vogella.com/articles/JUnit/article.html)，如果您有任何具体的进一步问题，请更新您的原始帖子。

# wpf - 字符串绑定错误

> ID：13318325
> 
> 赞同：0
> 
> 时间：2012-11-10T01:25:14.660
> 
> 标签：wpf, vb.net, data-binding, binding

为什么我不能在我的类中创建一个简单的 WPF 字符串数据绑定？

> *错误：重载解析失败，因为没有可访问的“新”接受此数量的参数。*

我[在 MSDN 中遵循了这个示例](http://msdn.microsoft.com/en-us/library/system.windows.data.binding%28v=vs.95%29.aspx)。

```
Dim s As String = "Test string"
Dim b As New Binding("Description of bind")
b.Mode = BindingMode.OneTime
b.Source = s 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T05:35:41.130

我不熟悉 VB，但看起来该行应该是：

```
Dim b As New Binding()
b.Path = New PropertyPath("Description of bind") 
```

我提到了这个[链接](http://msdn.microsoft.com/en-us/library/cc838207%28v=vs.95%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-9)。

# java - 如何检查公钥是否与私钥匹配？

> ID：13318328
> 
> 赞同：2
> 
> 时间：2012-11-10T01:25:37.500
> 
> 标签：java, keystore, public-key-encryption

我正在使用 Java 和 KeyStore。

我在 KeyStore 中有一个公钥和私钥对。

当我读取证书并从证书中获取公钥时。

我如何知道证书中的公钥是否与密钥库中的私钥匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T02:16:29.770

> 我在 KeyStore 中有一个公钥和私钥对。
> 
> 我如何知道证书中的公钥是否与密钥库中的私钥匹配？

由于 Keystore 包含*对*，因此您查找与证书具有相同公钥的对*。*

当然，这只是第一步。接下来，您（或更可能是 PKI 库）需要使用私钥来检查证书的签名。

# javascript - 用户在网页上多次控制，javascript不起作用

> ID：13318330
> 
> 赞同：1
> 
> 时间：2012-11-10T01:26:11.260
> 
> 标签：javascript, user-controls

用户在网页上多次控制：

我有一个带有网格的用户控件和一个列表框网格设置为自动创建列 = True 我将查询传递给控件并在 Page_Load 事件中填充网格用户双击网格上的行以选择这些行已添加到列表中框（第 1 列作为值，第 2 列作为显示）如果用户双击列表框中的行 - 它从选择中删除如果网格行已经存在于列表框中，则系统会忽略它

到目前为止一切顺利，并且运行良好！

扭曲：如果页面上只有一个控件-一切都很好但是如果该控件在网页上多次出现-它无法按预期工作

错误是'因为每个用户控件都复制了相同的 java 脚本，所以只有最后一个在工作

下面是代码...帮助！

```
 <script type="text/javascript">

    function list_DblClick(s, e) {
        s.RemoveItem(s.GetSelectedIndex())
    }

    function grid_DblClick(s, e) {
        var sfn = s.GetColumn(0).fieldName + ';' + s.GetColumn(1).fieldName
        s.GetRowValues(s.GetFocusedRowIndex(), sfn, OnGetRowValues);
    }

    //check for duplicate and add new
    function OnGetRowValues(values) {
        var sFound = "False"
        for (var i = 0; i < selList.GetItemCount(); i++) {
            if (values[0] == selList.GetItem(i).value) {
                sFound = "True"
            }
        };
        if (sFound == "False") {
            selList.AddItem(values[1], values[0])
        };
    }
</script>

<br />
<br />
    <dx:ASPxGridView ID="grdSelection" ClientInstanceName="grid" runat="server" Width="100%">
        <ClientSideEvents RowDblClick="grid_DblClick" />
        <SettingsBehavior AllowFocusedRow="True" />
    </dx:ASPxGridView>
<br />
<br />
    <dx:ASPxListBox ID="listSelected" ClientInstanceName="selList" runat="server" Height="250px" Width="100%" >
     <ClientSideEvents ItemDoubleClick="list_DblClick" />
    </dx:ASPxListBox>
<br />
<br /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:29:37.787

由于您已经在使用用户控件，请尝试使用 Page.RegisterClientScriptBlock（通过键）在代码隐藏中加载 JavaScript 代码，并检查是否已经使用 [IsClientScriptBlockRegistered](http://msdn.microsoft.com/en-us/library/system.web.ui.page.isclientscriptblockregistered%28v=vs.71%29.aspx)加载了该 JS 。这样做效率更高并且应该可以工作，因为您只声明一个函数一次而不是 n 次（这可能是它在客户端引发错误的原因）。

[http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerclientscriptblock(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerclientscriptblock(v=vs.71).aspx)

# jquery - 如何将多个文件附加到页面上并在进度条上显示进度。并将文件上传到服务器

> ID：13318332
> 
> 赞同：0
> 
> 时间：2012-11-10T01:26:13.237
> 
> 标签：jquery, jsf-2, tomahawk, mojarra

我知道 tamawhak 提供了一个文件上传组件。但我的要求是只在页面上显示一个“添加文件”按钮（不需要输入字段）。单击按钮后，应弹出选择文件窗口。选择要附加的文件后，附件应自动以进度条开头，在同一页面上显示附件操作的进度。用户可以执行相同的操作并附加多个文件。用户保持在同一页面上，并在附加所有文件后，单击提交按钮并上传文件。

我使用 JSF2.0 ，我不知道，我该怎么做？...基本上我需要对 gmail 或类似提供的附件实施一个解决方案。

谢谢，阿贾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T02:24:30.817

我以前做过几次这样的事情，使用[blueimp 的 jQuery File Upload 插件](https://github.com/blueimp/jQuery-File-Upload)。自定义它以使其看起来和感觉完全像您想要的那样需要一些修补，特别是修改文件输入看起来像一个按钮。服务器端技术不相关，只要它可以接收文件。

查看演示并浏览文档。不要指望这是一个简单的解决方案，它需要一些工作。

# html - 在图像中链接网页， 标签

> ID：13318333
> 
> 赞同：0
> 
> 时间：2012-11-10T01:26:20.467
> 
> 标签：html, area

我目前正在构建一个基本原型，作为我在大学参加的 HCI 课程的一部分。我对应用程序屏幕进行了建模，现在希望在 html 中链接图像，以便您可以模拟使用和导航。不过，我对 HTML 几乎不熟悉，并且遇到了我正在尝试做的事情的问题。

当我打开此页面时，网址是

桌面/carpark_app_prototype/html/carstatus_page.html

但是在单击一个按钮后，该按钮应该完全通过区域标签嵌入的 url 将您导航到另一个页面，而不是在这里

桌面/carpark_app_prototype/html/carstatus_page.html#carstatussuccess_page

我究竟做错了什么？

```
<html>
<head>
<title>CarPark Application</title>
<h1 id="documentTitle">CarPark Application</h1>
</head>

<body>
<div class="Page" id="pulldownmenu_page">
<div class="ImageContainer">
<img width="320" height="500" src="pages%5Cpulldownmenu.png" usemap="#map_pulldownmenu" />
</div>
<map name="map_pulldownmenu">
<area shape="rect" coords="18,313,296,356" href="carparkstatusscreen_page.html" title="Go to page 'CarParkStatus_Screen'" />
<area shape="rect" coords="18,230,296,273" href="parkinghours_page.html" title="Go to page     'Parking_Hours'" />
<area shape="rect" coords="18,146,296,189" href="carstatus_page.html" title="Go to page     'Car_status'" />
<area shape="rect" coords="18,78,296,123" href="parkcar_page.html" title="Go to page 'Park_car'" />
<area shape="rect" coords="107,394,228,424" href="loginscreen_page.html" title="Go to page         'Login_Screen'" />

</map>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:01:00.937

你可以做两件事：

**在本地服务器上运行您的 HTML** 我建议您使用 Apache 服务器来运行该页面。我猜你正在使用 Windows，所以[**WampServer**](http://www.wampserver.com/en/)将是一个很好且简单的。

1.  将所有文件放在**www**目录中的文件夹中。
2.  在浏览器中输入 localhost 或完整的“本地”url http://localhost/[目录名称]。示例：如果您创建了一个名为 My_Project 的文件夹，并且 heml 文件名为 index.html ：

> `http://localhost/My_Project/index.html`

**放置文件的完整路径，而不仅仅是文件名**

如果您在浏览器上的主要网址（实际上是路径）是：

> file:///C:/Users/your_user/Desktop/carpark_app_prototype/html/carstatus_page.html

对于所有其他 href 放置完整路径，例如：

```
<area shape="rect" coords="18,313,296,356" 
href="file:///C:/Users/your_user/Desktop/carpark_app_prototype/html/carparkstatusscreen_page.html"
 title="Go to page 'CarParkStatus_Screen'" /> 
```

# javascript - jQuery/javascript：背景图像，滚动变化

> ID：13318334
> 
> 赞同：2
> 
> 时间：2012-11-10T01:26:29.213
> 
> 标签：javascript, jquery, arrays, background-image, scrolltop

*我会先说我是初学者，我的代码可能杂乱无章和/或不连贯，但无论如何我都会发布它，希望能发现这些错误。*

我已经搜索了几天的答案和解决方案，我还在这里找到了有人问完全相同问题的主题：http: **[//goo.gl/BwLzp](http://goo.gl/BwLzp)**（被认为是模糊的）所以我会尽可能彻底我知道该怎么做。

到目前为止，我所拥有的是一些教程和摘录的组合：

* * *

**概念：（**会预先加载大量图片并设置为背景图片。理论上，每滚动一个整数（scrollTop），背景图片就会相应变化。）

所有的图像基本上都命名为：imgname1.jpg、imgname2.jpg、imgname3.jpg 等。因此“imgname”与 scrollTop 编号配对。

这是我仅关于滚动（而不是预加载）的内容：

```
$(function getPos() {
    var Pos = $(window).scrollTop();  // "Pos = scrollTop and is added onto imgname
return Pos;
}); 

$(function() {

$(window).scroll(function() { //Defines that this function will be triggered as the scrollbar is moving 

    var image_url = 'http://www.examplehost.com/imgname' + Pos + '.jpg'

    if (getPos()>1) { //If the vertical position of scrollbar is above 1 display imgname + Pos + .jpg (ex: imgname30.jpg) and add to url

        $("body").css('background-image', image_url);                            
    }

    else { //If the vertical position of scrollbar is at 1 display start image
        $("body").css('background-image', url("http://www.examplehost.com/imgname/0.jpg");
    }

});

}); //function ends 
```

我不知道这是多么混乱，是的，我会复习基础知识，因为这在我看来是合乎逻辑的，但我敢肯定这是完全错误的。但是对于这个项目，我的知识只限制了我猜测/想知道以下内容：

*   当函数结束时，我的“}”后面是否需要逗号。前任： }，
*   一切是否正确打开和关闭。
*   这正是我的 js 文件的外观，如果出现函数调用不正确的问题，我不会感到惊讶。
*   也代替 if (getPos()>1) 我想使用 if (getPos()>=1)

**可能有助于/进一步澄清**的额外信息，目标是图像位置保持静止，并且每个滚动增量都会接管一个新的“框架”。最终，我会居中+保持图像全屏，例如：[http ://www.powersmart.ca/](http://www.powersmart.ca/)

感谢您阅读本文，如果我违反了规则，或者这个问题/困境已在我无法找到的地方得到更详细的解决，我深表歉意。

也就是说，想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:36:24.900

尝试改变这个：

```
if (getPos()>1) { //If the vertical position of scrollbar is above 1 display imgname + Pos + .jpg (ex: imgname30.jpg) and add to url

    $("body").css('background-image', image_url);                            
}
else { //If the vertical position of scrollbar is at 1 display start image
    $("body").css('background-image', url("http://www.examplehost.com/imgname/0.jpg");
} 
```

至：

```
if (getPos()>1) { //If the vertical position of scrollbar is above 1 display imgname + Pos + .jpg (ex: imgname30.jpg) and add to url

    $("body").css('background-image', 'url('+image_url+')');                            
}
else { //If the vertical position of scrollbar is at 1 display start image
    $("body").css('background-image', 'url(http://www.examplehost.com/imgname/0.jpg)');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:32:33.113

要使“背景图像位置保持静止”，您需要`object.style.backgroundAttachment="fixed"`

与jQuery有关：

```
$("body").css('background-attachment', 'fixed'); 
```

虽然我建议把它放在你的 CSS 中

```
body { 
    background-attachment: fixed;
} 
```

[http://www.w3schools.com/cssref/pr_background-attachment.asp](http://www.w3schools.com/cssref/pr_background-attachment.asp)

谷歌是你的朋友；）

* * *

**编辑：**只是提出一件事，你确定图片的网址是正确的吗？如果 URL 错误，将导致根本没有背景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:54:16.303

```
function getPos() {
    var Pos = $(window).scrollTop();
    return Pos;
}
$(function() {
      $(window).scroll(
       function() {
        var here=getPos();
        //alert(here);
        $("body").css('background-image', url('http://www.examplehost.com/imgname' + here + '.jpg')); 
      })
}); 
```

从这个开始。但是您需要每个像素一张图像...

# c - 是什么导致“警告：条件表达式中的指针/整数类型不匹配”？

> ID：13318336
> 
> 赞同：5
> 
> 时间：2012-11-10T01:27:07.640
> 
> 标签：c, macros, enums

我有一个枚举、一个宏定义和一个都使用枚举的方法。我无法编译它。考虑以下代码。

```
typedef enum fruits_t
{
    APPLE,
    ORANGE,
    BANANA
} fruits_t;

#define KEY_TO_VALUE(x) ((x == APPLE) ? 0 :  \
                         (x == ORANGE) ? 1 :  \
                         (x == BANANA) ? 2 : \
                         "Undefined")

static void foo(char fruit) {
    if (fruit == KEY_TO_VALUE(APPLE)) {
        /* do something */
    }
} 
```

这可以编译，但我收到以下警告。

`warning: pointer/integer type mismatch in conditional expression`

`warning: comparison between pointer and integer`

为什么？我对 C 很陌生，所以如果你能解释一些对有经验的 C 开发人员来说似乎很明显的事情，我将不胜感激。我的大部分编程知识都是基于 Java 的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-10T01:44:12.990

编译器试图找出程序中每个表达式的类型。

诸如此类的表达式`x > 0 ? 5 : "no"`使编译器摸不着头脑。如果 x 大于零，则类型为`int`，但如果不是，则类型为`const char *`。这是一个问题，因为没有从指针到的自动转换`int`（反之亦然）。所以编译器会警告它。

解决方案是确保无论值`fruit`是什么，值都`KEY_TO_VALUE`具有单一类型。例如`const char *`，您可以使用特殊值，例如 -1，而不是“未定义”（类型为 ，因为它是文字字符串）。

另外，请注意，它`APPLE`是一个值为 0`ORANGE`的常数，是一个值为 1`BANANA`的常数，是一个值为 2 的常数（这就是`enum`工作原理）。所以你不需要`KEY_TO_VALUE`，因为常量已经有了想要的值。您可以简单`fruit`地`APPLE`直接比较：

```
if (fruit == APPLE) { ... } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T02:47:28.810

在 C 语言中，`?:`运算符对其第二个和第三个操作数施加以下要求

> 第二个和第三个操作数应满足以下条件之一：
> 
> *   两个操作数都有算术类型；
> *   两个操作数具有相同的结构或联合类型；
> *   两个操作数都有 void 类型；
> *   两个操作数都是指向兼容类型的合格或不合格版本的指针；
> *   一个操作数是指针，另一个是空指针常量；或者
> *   一个操作数是指向对象或不完整类型的指针，另一个是指向 void 的限定或非限定版本的指针。

在您的代码中，您将算术类型和指针类型（字符串文字衰减为`char *`类型）混合为`?:`. 这是不允许的。

非正式地说，你是怎么想到这个主意的？什么类型的东西`x == BANANA ? 2 : "Undefined"`？`int`? `char *`? 还有什么？

请注意，`0`允许混合指针值和常量，即表达式`x == APPLE ? 0 : "Undefined"`实际上可以毫无问题地编译。但是，`0`将被解释为*空指针常量*，整个表达式将具有指针类型 ( )，并在为真`char *`时计算为空指针。`x == APPLE`这可能不是您想要的。

# java - 对于小 x、大 y 值，什么是有效的 HashCode()？

> ID：13318337
> 
> 赞同：2
> 
> 时间：2012-11-10T01:27:10.020
> 
> 标签：java

我正在使用 HashMap 将 x,y 值映射到笛卡尔平面上。对于非常小的 x、非常大的 y 值，什么是有效的 HashCode？

目前我正在使用：

```
 public int hashCode() {
    return ((y * 31) ^ x);

 // & Typical x,y values would be, (with many collisions on x):
  [4, 1000001] [9, 1000000] [5, 999996] [6, 999995] [4, 999997] 
  [6, 999997] [6, 1000003] [10, 999994] [8, 999997] [10, 999997] 
  [5, 999999] [4, 999998] [5, 1000003] [2, 1000005] [3, 1000004] 
  [6, 1000000] [3, 1000005] 
```

我使用 .put 方法将两个 x,y 对插入到哈希图的键中，以避免任何重复的 x,y 对。也不确定这是否是最有效的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T02:32:42.747

有时，最好的了解方法是在您的范围内进行一些蛮力测试。但最终，您始终可以编写一个哈希函数，如果性能不佳，您可以稍后返回并修复它。过早的优化是邪恶的。尽管如此，测试散列还是很容易的。

我运行了这个程序，得到了 0 次碰撞：

```
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;

public class Testing {

    public static void main(String[] args) {
        int minX = 0;
        int minY = 100000;
        int maxX = 20;
        int maxY = 2000000;

        Map<Integer, Integer> hashToCounts = new HashMap<Integer, Integer>();
        for (int x = minX; x < maxX; x++) {
            for (int y = minY; y < maxY; y++) {
                int hash = hash(x, y);
                Integer count = hashToCounts.get(hash);
                if (count == null)
                    count = 0;
                hashToCounts.put(hash, ++count);
            }
        }

        int totalCollisions = 0;
        for (Entry<Integer, Integer> hashCountEntry : hashToCounts.entrySet())
            if (hashCountEntry.getValue() > 1)
                totalCollisions += hashCountEntry.getValue() - 1;

        System.out.println("Total collisions: " + totalCollisions);
    }

    private static int hash(int x, int y) {
        return 7 + y * 31 + x * 23;
    }
} 
```

和输出：

> 总碰撞数：0

请注意，我的功能是`7 + y * 31 + x * 23`.

当然，不要相信我的话。弄乱范围以将其调整为您的数据集并尝试自己计算。

使用你`(y * 31) ^ x`给我的：

> 碰撞总数：475000

并且只使用`x * y`：

> 碰撞总数：20439039

**请注意**，该程序可以使用相当大的内存和计算能力。我在一个非常强大的服务器上运行它。我不知道它将如何在本地机器上运行。

散列需要遵循的一些好的规则是：

*   混淆你的运营商。通过混合您的运算符，您可以使结果变化更大。在这个测试中简单地使用`x * y`，我有非常多的碰撞。
*   使用素数进行乘法运算。素数具有有趣的二进制特性，导致乘法更加不稳定。
*   Avoid using shift operators (unless you really know what you're doing). They insert lots of zeroes or ones into the binary of the number, decreasing volatility of other operations and potentially even shrinking your possible number of outputs.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T01:53:30.653

似乎`x * y`效果很好，特别是如果结果适合`int`.

您可以使用 HashSet：它在内部是一个 HashMap，只有键，没有值。这将使避免重复的意图更加明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T01:56:36.687

很难预测。HashMap 使用下面显示的 hash() 方法进行一些重新散列，然后获取底部的 X 位。所以，在一个理想的世界里，忽略引起事情的 hash() 方法，你的最低有效位应该分布得很好。

```
static int hash(int h) {
  // This function ensures that hashCodes that differ only by
  // constant multiples at each bit position have a bounded
  // number of collisions (approximately 8 at default load factor).
  h ^= (h >>> 20) ^ (h >>> 12);
  return h ^ (h >>> 7) ^ (h >>> 4);
} 
```

我通常从一些非常简单的东西开始，例如 x^y（或 x 移动了一些东西 ^y 或反之亦然），然后创建 HashMap，看看是否有太多的冲突。

# jquery - JQuery 解析 XML 图像标签

> ID：13318339
> 
> 赞同：0
> 
> 时间：2012-11-10T01:27:25.907
> 
> 标签：jquery, xml, parsing

我有一个使用如下图像标签的 XML 文件：

```
<Entry>
    <?image_0 href="http://url.com"?>
    <?image_1 href="http://url.com"?>
    <?image_2 href="http://url.com"?>
</Entry> 
```

它不能使用 .find("?image_0") 或类似的，因为它没有结束标签。Adobe InDesign 支持这种格式，但是如何获取图像子元素和 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:33:13.533

您可以通过重写内容使其成为有效的 xml：

```
var data = '<Entry> <?image_0 href="http://url.com"?> <?image_1 href="http://url.com"?> <?image_2 href="http://url.com"?> </Entry>';
data = data.replace(/\<\?/g, "<").replace(/\?\>/g, "/>");
alert($(data).find("image_0").attr("href")); 
```

[这是一个小提琴](http://jsfiddle.net/geqQ4/1/)。

# facebook-like - 未登录 Facebook 时，外部网站上的“赞”按钮丢失计数

> ID：13318340
> 
> 赞同：1
> 
> 时间：2012-11-10T01:27:40.450
> 
> 标签：facebook-like, external

两天前，我的外部网站上的“赞”按钮开始出现问题。如果我在登录 Facebook 时查看该网站，那么点赞按钮就可以了。但是，如果我在未登录 Facebook 的情况下查看该页面，那么页面上显示的点赞数只是应有的一小部分。其他网站也会出现此问题，并且所有 Web 浏览器都会出现此问题。我正确安装了“app_id”和所有其他参数，因为这些信息都没有改变。这可能与点赞按钮迁移有关。我知道可以通过迁移管理页面并将类似按钮的 url 更改为迁移的管理页面的 url 来解决上述问题，因为我可以在我的其他页面之一上这样做。然而，我不想为这个特定的外部网站迁移管理页面。有没有办法在不迁移管理页面的情况下解决这个问题？谢谢。

# jsf - a4j:commandButton reRendering rich:datatable

> ID：13318346
> 
> 赞同：5
> 
> 时间：2012-11-10T01:29:27.063
> 
> 标签：jsf, richfaces, jsf-1.2, rerender, richdatatable

我的问题是我试图让我的数据表中的一列默认显示输出文本，并在按下命令按钮时将其替换为输入文本。还没有找到解决办法。顺便说一下第一次发帖。

我有一个 a4j:commandButton 我希望重新渲染这部分数据表

```
<a4j:commandButton reRender="yieldTable" action="#{yieldSearch.activateVisible()}"
id="modify" styleClass="editLargeIcon" value="Modify">
</a4j:commandButton>

<rich:dataTable id="yieldTable" value="#{yieldSearch.yfitem.yielditem}" var="_yield">
<rich:column>
<f:facet name="header">%-YLD</f:facet>
<h:outputText value="#{_yield.yfYield}" rendered="#{not yieldSearch.visible}">
</h:outputText>
<h:inputText rendered="#{yieldSearch.visible}" />
</rich:column> 
```

我想激活这个方法（只显示相关代码）

```
@Name("yieldSearch")
@Scope(ScopeType.CONVERSATION)
public class YieldSearch implements Serializable{

private Boolean visible;

public void activateVisible(){
    this.setVisible(true);
    System.out.print(true);
}

    public void setVisible(Boolean visible) {
    this.visible = visible;
}

public Boolean getVisible() {
    return visible;
} 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T18:44:34.113

您需要将两个组件包装在一个`<a4j:outputPanel id="myPanel" ajaxRendered="true"/>`. 两个组件都无法重新渲染的原因是您设置的组件`rendered="false"`不会在初始视图渲染时发送到浏览器。

```
<a4j:outputPanel id="myPanel" ajaxRendered="true">
<h:outputText value="#{_yield.yfYield}" rendered="#{not yieldSearch.visible}"/>
<h:inputText rendered="#{yieldSearch.visible}" />
</a4j:outputPanel> 
```

ajax 刷新工作的方式是使用 javascript 在 DOM 树中定位 clientId 以使用新标记进行更新，即组件必须已经在 DOM 树中。由于您设置了`rendered="false"`，因此该组件从不在 DOM 树中开始。因此，在 ajax 请求中，浏览器不知道您在说什么，因为它找不到要更新的 clientId。

将 outputPanel 与 一起使用`ajaxRendered="true"`，您将刷新整个 outputPanel，因此 ajax 刷新将更新该组件作为一个整体，以及您在其中嵌套的任何内容

# php - SQL TRIGGER phpMyAdmin - LEAVE 指令

> ID：13318350
> 
> 赞同：1
> 
> 时间：2012-11-10T01:29:58.847
> 
> 标签：php, sql, triggers, phpmyadmin

我在 phpMyAdmin 中有这个触发器

```
DELIMITER $$
CREATE TRIGGER `DuplicateRows` BEFORE INSERT ON `infocontacts` 
FOR EACH ROW
trig : BEGIN 
DECLARE num INTEGER DEFAULT 0;

IF( NEW.phone <> 'NULL' ) THEN
 SELECT COUNT( * ) INTO num FROM infocontacts WHERE phone = NEW.phone;
 IF( num >0 ) THEN 
  INSERT INTO duplicated( name, surname, phone, email, profession, province) 
  VALUES (NEW.name, NEW.surname, NEW.phone, NEW.email, NEW.profession, NEW.province);

  LEAVE trig;

 END IF ;
END IF ;
END 
```

指令“LEAVE trig;” 没有执行即离开触发器并且不运行被触发的插入！

有人能帮我吗？

谢谢

# scala - Unable to import a case class in an abstract class

> ID：13318357
> 
> 赞同：4
> 
> 时间：2012-11-10T01:30:44.103
> 
> 标签：scala

I want to run the class Expr below. I've taken this code from [http://andymaleh.blogspot.ie/2008/04/scalas-pattern-matching-visitor-pattern.html](http://andymaleh.blogspot.ie/2008/04/scalas-pattern-matching-visitor-pattern.html)

Here is what I am trying :

```
import Expr.Sum

object Main {

    def main(args:Array[String]) {

      var expr1 = new Sum(new Num(1), new Prod(new Num(2), new Num(3)))
      print(expr1)
  }

}

abstract class Expr {

  case class Num(n: Int) extends Expr
  case class Sum(l: Expr , r: Expr) extends Expr
  case class Prod(l: Expr, r: Expr) extends Expr

  def evalExpr(e: Expr): Int = e match {
    case Num(n) => n
    case Sum(l, r) => evalExpr(l) + evalExpr(r)
    case Prod(l, r) => evalExpr(l) * evalExpr(r)
  }

  def printExpr(e: Expr) : Unit = e match {
    case Num(n) => print(" " + n + " ")
    case Sum(l, r) => printExpr(l); print("+"); printExpr(r)
    case Prod(l, r) => printExpr(l); print("x"); printExpr(r)
  }

} 
```

But line

```
import Expr.Sum 
```

is causing a compile time error : 'not found: object Expr' . How can I import the class Expr ?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-10T04:02:36.517

You can only import members of instances. So your code would be:

```
object Main {
    def main(args:Array[String]) {
      val expr = new Expr {} // now we have a instance.

      import expr._
      var expr1 = new Sum(new Num(1), new Prod(new Num(2), new Num(3)))
      print(expr1)
  }
} 
```

A simple example explains why you can't import non-instances members:

```
class A(val x:Int) {
  object Print { def print = println(x) }
} 
```

If you could `import A.Print`, which value would be bound to `x`? Now if we do:

```
val a = new A(5); // we have a value bound to x.
import a._
Print.print 
```

This is one reason. The other reason that `new A(5).Print != new A(5).Print`, not only in equality, but also in type: `val (a1, a2) = (new A(5), new A(5)); implicitly[a1.Print <:< a2.Print]` wouldn't compile. This is what Scala calls *path-dependent types*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T01:51:55.763

Moving the case classes out of the abstract class gets it to compile. They are also in the same scope in this case so there is nothing to import.

Also note that an `import` error isn't applicable here since `Main` and `Expr` are defined in the same package. i.e. the default package.

```
object Main {    
    def main(args:Array[String]) {

      var expr1 = new Sum(new Num(1), new Prod(new Num(2), new Num(3)))
      print(expr1)
  }
}

abstract class Expr {
}

case class Num(n: Int) extends Expr
case class Sum(l: Expr , r: Expr) extends Expr
case class Prod(l: Expr, r: Expr) extends Expr

def evalExpr(e: Expr): Int = e match {
  case Num(n) => n
  case Sum(l, r) => evalExpr(l) + evalExpr(r)
  case Prod(l, r) => evalExpr(l) * evalExpr(r)
}

def printExpr(e: Expr) : Unit = e match {
  case Num(n) => print(" " + n + " ")
  case Sum(l, r) => printExpr(l); print("+"); printExpr(r)
  case Prod(l, r) => printExpr(l); print("x"); printExpr(r)
} 
```

Running this gives:

```
scala>Main.main(Array[String]())
Sum(Num(1),Prod(Num(2),Num(3))) 
```

# php - 嵌套 While 循环仅显示第一行数据

> ID：13318360
> 
> 赞同：0
> 
> 时间：2012-11-10T01:31:10.920
> 
> 标签：php, mysql

我是一名新手 PHP 程序员，在理解“嵌套”想法时遇到了问题。当我运行以下代码时，它将显示从表中 $query3 （名字、姓氏等）列出的每个人，但是当它显示第二个和第三个 while 循环（分别使用 $query1 和 $query2）时，它只会这样做在第一条记录上（列出的第一个员工），但没有其他记录。我是否需要/如何为循环的每个实例重置 $employeeID 变量，或者我需要在哪里进行更改？

```
//pen some querying
$query1 = mysql_query("SELECT * FROM employees WHERE position='Supervisor' OR position='Area Manager' ORDER BY area, LastName, EmployeeNumber ");
$query2 = mysql_query("SELECT * FROM meetings WHERE meetingGroup='Management'");

//now write some wicked sick code that will change the world!
while($rows3 = mysql_fetch_array($query1)):
    $firstname = $rows3['FirstName'];
    $lasttname = $rows3['LastName'];
    $area = $rows3['area'];
    $employeeID = $rows3['EmployeeNumber'];

echo "<table border='1' align='center' width='75%'><tr><td width='25%'>$firstname $lasttname</td>";

        while($rows1 = mysql_fetch_array($query2)):
            $meetingID = $rows1['meetingID'];
            $meetingName = $rows1['meetingName'];

            echo "<td width='19%'>$meetingName</td>";

            $query3 = mysql_query("SELECT * FROM meetingattendance WHERE employeeid='$employeeID' AND meetingid='$meetingID'");
            while($rows2 = mysql_fetch_array($query3)):
                $attendanceMark = $rows2['employeeattendance'];
                if($attendanceMark = 1)
                    echo "<td><center><strong>X</strong></center></td>";
                else
                echo "No Record";
            endwhile;

        endwhile;

endwhile;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T03:57:05.443

让我们从嵌套循环开始。我将在此处给出一个示例，该示例将跳过查询以使其更易于理解。

```
<?php
$nested1 = array(10,11,12,13,14,15,16,17);
$nested2 = array(20,21,22,23,24,25,26,27);
$nested3 = array(30,31,32,33,34,35,36,37);

while ($rows3 = next($nested1)) {
  echo "First Level: $rows3\n";

  while ($rows1 = next($nested2)) {
    echo " -- Second Level: $rows1\n";

    while ($rows2 = next($nested3)) {
      echo " -- -- Third Level: $rows2\n";
    }
  }
} 
```

这个结果看起来有点像我期望你看到的

```
First Level: 10
 -- Second Level: 20
 -- -- Third Level: 30
 -- -- Third Level: 31
 -- -- Third Level: 32
 -- -- Third Level: 33
 -- -- Third Level: 34
 -- -- Third Level: 35
 -- -- Third Level: 36
 -- -- Third Level: 37
 -- Second Level: 21
 -- Second Level: 22
 -- Second Level: 23
 -- Second Level: 24
 -- Second Level: 25
 -- Second Level: 26
 -- Second Level: 27
First Level: 11
First Level: 12
First Level: 13
First Level: 14
First Level: 15
First Level: 16
First Level: 17 
```

原因是我们在这个例子中使用了 next ，它将内部指针移动到数组中的下一个元素。由于下次我们通过外部循环时指针永远不会重置，我们将点击 echo "First Level: $rows\n"; 行，然后是下一个 while 循环。由于指针仍在数组的末尾，next() 将失败并继续迭代的其余部分。这与最内层循环 ($rows2) 相同。

我在此示例中使用 next 的原因是它的行为就像查询中使用的 mysql_fetch_array 函数一样，它将到达结果集的末尾，并且指针永远不会重置回开头。

话虽如此，您确实应该考虑在查询中使用 JOIN。具体从 Left JOIN 开始，如下所示

```
SELECT * FROM employees as e
LEFT JOIN meetingattendance as m ON e.EmployeeNumber = m.employeeid
WHERE e.position='Supervisor' OR e.position='Area Manager' 
ORDER BY e.area, e.LastName, e.EmployeeNumber 
```

从那里开始，看看这是否能让你更接近你正在寻找的东西。

# c# - 在 C# 中通过索引关系获取枚举

> ID：13318362
> 
> 赞同：1
> 
> 时间：2012-11-10T01:32:09.687
> 
> 标签：c#, enums

我有以下枚举：

```
public enum UserRole {
  Admin = 1,
  Leader = 2,
  Editor = 3,
  Guest = 4
} // UserRole 
```

以及以下列表：

```
IList<UserRole> roles = new List<UserRole> { UserRole.Leader, UserRole.Editor }; 
```

我想创建两个新列表：

1 - 选择角色中最低索引项的列表，例如，UserRole.Leader = 2 和高于该值的所有 UserRoles。所以我会得到：

```
UserRole.Leader, UserRole.Editor, UserRole.Guest 
```

2 - 选择角色中索引最高的项目的列表，例如，UserRole.Editor = 3 和低于该值的所有 UserRoles。所以我会得到：

```
UserRole.Admin, UserRole.Leader, UserRole.Editor 
```

我怎样才能做到这一点？

谢谢你，米格尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:50:22.553

怎么样

```
public enum UserRole
{
    Admin = 1,
    Leader = 2,
    Editor = 3,
    Guest = 4
}

IList<UserRole> roles = new List<UserRole> { UserRole.Leader, UserRole.Editor };

var min = roles.Min();

var max = roles.Max();

var result1 = Enum.GetValues(typeof(UserRole)).Cast<UserRole>()
                  .Where(x => x >= min);

var result = Enum.GetValues(typeof(UserRole)).Cast<UserRole>()
                 .Where(x => x <= max); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:46:40.473

您可以使用枚举枚举，`Enum.GetValues(typeof(UserRole)));`因此答案是：

```
IList<UserRole> GetHigherRoles(UserRole role)
{
    var roles = new List<UserRole>();
    foreach (var r in Enum.GetValues(typeof(UserRole)))
    {
        if ((UserRole)r >= role)
        {
            roles.Add((UserRole)r);
        }
    }
    return roles;
}

IList<UserRole> GetLowerRoles(UserRole role)
{
    var roles = new List<UserRole>();
    foreach (var r in Enum.GetValues(typeof(UserRole)))
    {
        if ((UserRole)r <= role)
        {
            roles.Add((UserRole)r);
        }
    }
    return roles;
} 
```

# node.js - 如何在 Windows 上部署具有深度 node_modules 结构的 Node.js 应用程序？

> ID：13318364
> 
> 赞同：91
> 
> 时间：2012-11-10T01:32:27.470
> 
> 标签：node.js, windows, deployment, npm, filenames

我遇到了一个奇怪的问题 - 显然某些 Node.js 模块的**文件夹层次结构如此之*****深***，以至于当路径超过 250 时，Windows 复制命令（或`Copy-Item`我们实际使用的 PowerShell）会遇到臭名昭著的“路径太长”错误字符长。

例如，这是单个 Node 模块可以创建的文件夹层次结构：

```
node_modules\nodemailer\node_modules\simplesmtp\node_modules\
xoauth2\node_modules\request\node_modules\form-data\node_modules\
combined-stream\node_modules\delayed-stream\... 
```

这看起来很疯狂，但却是 Node 模块的现实。

我们需要在部署期间使用复制粘贴（我们没有使用像 Heroku 这样的“聪明”目标平台，可以选择 Git 部署），这对 Windows 来说是一个严重的限制。

**是不是有一个 npm 命令或可以压缩`node_modules`文件夹的东西，或者可能只包含运行时实际需要的东西？**（节点模块通常包含`test`我们不需要部署的文件夹等。）任何其他想法如何解决它？不幸的是，不使用 Windows 不是一种选择:)

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-08-27T18:32:03.277

只是添加到这个......帮助我的另一件事是列出所有已安装的模块`npm ls`。

这将为您提供一个模块和版本树......从那里很容易识别哪些是重复的......`npm dedupe`没有为我做任何事情。我不确定这是错误还是什么（Node v 10.16）

因此，一旦您识别出重复的模块，请使用`npm install dupemodule@1.2.3 --save-dev`. **版本很重要。**

之后，我清除了我的 node_modules 目录并做了一个新的`npm install`.

## 简洁版本

1.  `npm ls`获取所有已安装模块的列表。
2.  查看这些模块并识别重复的模块（**版本很重要**）
3.  `npm install module@version --save-dev`在根 node_modules 目录中安装这些模块并更新 package.json。
4.  `rmdir node_modules`删除 node_modules 目录。
5.  `npm install`拉下您的依赖项的新副本。

一旦我这样做了，一切都干净多了。

我还建议评论您的 package.json 文件，以显示哪些文件被删除以展平 node_modules 树。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-11-10T02:39:13.957

鉴于您的限制，我认为没有任何好的解决方案，但这里有一些可能会有所帮助的事情。

*   尝试使用`npm dedupe`来优化您的目录层次结构，这可能会缩短一些路径
*   用于`npm install --production`在没有开发工具的情况下安装
*   获取一些深度嵌套的依赖项（我建议足以避免问题）并将它们移动到顶级 node_modules 目录。只需跟踪它们，以便您知道哪些是您真正的依赖项以及哪些是此问题的解决方法。
*   或者将其中一些深层依赖项移动到最高`node_modules`目录下`your_project/node_modules/pkg_with_deep_deps`，这将允许它们具有足够短的路径但仍然可以工作。所以这将是`your_project/node_modules/pkg_with_deep_deps/node_modules`。
    *   我认为`require`应该能够在运行时正确找到那些。您只需要清楚地记录您手动更改的内容，为什么这样做，并保持您自己的真实依赖关系准确地表示在`package.json`

[这是一个github问题讨论](https://github.com/joyent/node/issues/6960)，详细阐述了这个问题。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-07-07T11:14:43.797

npm v3（最近发布）通过扁平化依赖关系解决了这个问题。在[https://github.com/npm/npm/releases/tag/v3.0.0](https://github.com/npm/npm/releases/tag/v3.0.0)`flat flat`部分查看发布说明。

关于这个问题的最后评论[https://github.com/npm/npm/issues/3697](https://github.com/npm/npm/issues/3697)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-05-04T19:28:00.400

我写了一个名为“npm-flatten”的节点模块，在这里为你扁平化你的依赖：[https ://www.npmjs.org/package/npm-flatten](https://www.npmjs.org/package/npm-flatten)

如果您正在寻找一个发行版，我还编写了一个 NuGet 包，它将完整的 node.js 环境与您的 .NET 项目集成在这里：[http ://www.nuget.org/packages/NodeEnv/](http://www.nuget.org/packages/NodeEnv/)

欢迎反馈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-05T02:12:45.280

帮助我的是将本地驱动器映射到我的 Node.js 文件夹：

净使用 n:\computername\c$\users\myname\documents\node.js /persistent:yes

之前：c:\users\myname\documents\node.js\projectname（45 个字符） 之后：n:\projectname（14 个字符，少 31 个字符）

在许多情况下，这允许安装一些模块。

我会说我今天在尝试将所有代码备份到 USB 驱动器时重新发现了这个问题。

“C:\Users\myname\Documents\Node.js\angular-phonecat\node_modules\karma\node_modules\chokidar\node_modules\anymatch\node_modules\micromatch\node_modules\regex-cache\node_modules\benchmarked\node_modules\file-reader\ node_modules\extend-shallow\benchmark\fixtures 太长。”

即使我尝试使用 N: 驱动器号备份它们，由于路径长度，它在某些情况下仍然失败，但它足以修复上述问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-12T19:38:52.427

1）在发布构建期间，您可以通过将文件夹属性设置**为隐藏文件夹**（只需将其设置为 node_modules）来防止 Visual Studio 扫描这些文件/文件夹。参考：http: [//issues.umbraco.org/issue/U4-6219#comment=67-19103](http://issues.umbraco.org/issue/U4-6219#comment=67-19103)

2) 您可以通过在 CsProject 文件中包含以下 XML 节点来排除打包过程中发布的文件或文件夹。

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
  ...
  <OutputPath>bin\</OutputPath>
   <NoWarn>42016,41999,42017,42018,42019,42032,42036,42020,42021,42022</NoWarn>
  <ExcludeFilesFromDeployment>File1.aspx;File2.aspx</ExcludeFilesFromDeployment>
  <ExcludeFoldersFromDeployment>Folder1;Folder2</ExcludeFoldersFromDeployment>
</PropertyGroup> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-16T12:10:25.813

我从[Microsoft Node.js Guidelines](https://github.com/Microsoft/nodejs-guidelines/blob/master/windows-environment.md#max_path-explanation-and-workarounds)中找到了一种解决方案。

*   从短路径开始（例如 c:\src）
*   `> npm install -g rimraf`删除超过`max_path`
*   `> npm dedupe`将重复的包移动到顶层
*   `> npm install -g flatten-packages`将所有包移动到顶层，但可能导致版本控制问题
*   升级到`npm@3`哪个尝试使`node_modules`文件夹层次结构最大程度地平坦。
    *   随 Node v5 提供
    *   或者…`> npm install –g npm-windows-upgrade`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-08T15:51:15.563

这不是一个合适的解决方案，而是当您赶时间时的一种解决方法，但是您可以使用[7-Zip](http://www.7-zip.org/)压缩您的文件夹，移动压缩文件并解压缩它而不会出现任何问题。

我们使用该解决方案部署了一个无法进行干净 npm 安装的 Node.js 应用程序。

# ruby-on-rails-3 - 在 Rails 3 中使用 attr_accessor

> ID：13318366
> 
> 赞同：1
> 
> 时间：2012-11-10T01:32:34.767
> 
> 标签：ruby-on-rails-3, validation, attr-accessor

我一直在 rails 中遇到 attr_accessor 的一致性问题。我从来没有弄清楚我错过了什么细节......所以，我想我会在这里提出一个问题。

我有以下内容：

```
 ...Controller
  new
     @something = Something.new
     @something.it_should = true
  end 
```

.

```
 ....Model
  attr_accessor :it_should

  def should_validate?
     it_should
  end

  validates_presence_of :name, :if => :should_validate? 
```

因此，我将控制器中的实例变量设置为 true。我通过 attr_accessor 使该变量可用于模型。我将变量放入一个方法中，然后在验证中使用该方法。似乎它应该工作。但是，它什么也没做。it_should 永远不会设置为 true。页面加载正常，但字段未验证。

我什至试过这个......但是，它并没有导致验证执行。

```
 def should_validate?
     true
  end 
```

使用 att_accessor 的技巧是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T02:04:30.080

问题是`@it_should`您使用设置的实例变量`attr_accessor`在请求之间没有持久化，因此尽管您`true`在`new`操作中将其设置为，但一旦提交表单并触发其他操作（可能是`create`或），它将被重置。`update`

如果您想以这种方式验证字段，则必须在表单提交触发的操作中设置它，例如`create`：

```
def create
  @something = Something.new(params[:something])
  @something.it_should = true
  @something.save
  ...
end 
```

`name`这应该会按预期触发验证。

# php - 在 POST、PayPal 表单之前捕获表单数据

> ID：13318370
> 
> 赞同：2
> 
> 时间：2012-11-10T01:33:27.813
> 
> 标签：php, post, paypal

我基本上有一个正常的 POST 到 PayPal 的表单，用于付款。我看过其他网站，能够发布到内部页面，然后重定向到 PayPal 结帐页面。

我需要这样做的原因是因为表单输入之一具有用户生成的值。因此，我需要将数据发布到内部 PHP 脚本，保存相关数据，然后将用户重定向到 PayPal 上的结帐页面。

我该怎么做呢？

问候，哈利

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T05:07:42.613

如果您想先发布到您的服务器并让它转发到 PayPal 的请求是通过 CURL。[从 wp-e-commerce 查看这个类，](http://code.google.com/p/wp-e-commerce/source/browse/trunk/wpsc-merchants/paypal-express.merchant.php)它几乎向您展示了一个完整的实现。

另一种方法是使用 Javascript。使用一个 AJAX 请求将第一个组件提交到您的服务器。然后（在第一次请求成功响应后）以编程方式将 PayPal 表单提交给 PayPal。

# javascript - 在 for 循环或 if 块中声明变量有什么问题吗？

> ID：13318375
> 
> 赞同：0
> 
> 时间：2012-11-10T01:34:17.323
> 
> 标签：javascript, variables

我经常看到这样的习惯：

```
var foo, bar;
for(var i = 0; i < 5; i++) {
    foo = '' + foo + i;
} 
```

它也对我产生了影响，但我刚刚意识到我不知道我为什么要这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:39:41.487

这样做没有真正的问题，但是 javascript 没有块级范围，因此如果您在循环内声明 foo ，它仍然可以在整个函数中访问。

如果您预先声明所有变量，则在进行缩小时有一个小优势，请考虑：

```
// Up front
var a, b, c, aVal, bVal, cVal;

for (a = 0; a < 5; ++a) {
    aVal = a;
}

for (b = 0; b < 5; ++b) {
    bVal = b;
}

for (c = 0; c < 5; ++c) {
    cVal = c;
}

// Inline
for (var a = 0; a < 5; ++a) {
    var aVal = a;
}

for (var b = 0; b < 5; ++b) {
    var bVal = b;
}

for (var c = 0; c < 5; ++c) {
    var cVal = c;
} 
```

在这种情况下，当您缩小时，您的源代码中会出现更多的“var”语句。这不是什么大不了的事，但随着时间的推移，它们肯定会加起来。

# programming-languages - 预测下一个大科技的工具

> ID：13318376
> 
> 赞同：-2
> 
> 时间：2012-11-10T01:34:24.980
> 
> 标签：programming-languages

哪些工具/资源可用于预测下一个大语言和工具集？

**举个例子**，如果我想比较 Node.js+Express.js 和 Ruby+Rails 的未来前景，我应该看哪里？

到目前为止，我想到了这些来源：

*   [谷歌趋势](http://www.google.com/trends/)
*   [按语言分类的 Git 存储库](https://github.com/languages)
*   关于 Quora、StackOverflow 等的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:39:16.400

由公司赞助和/或采用。为新语言（而不是新框架）构建工具和基础设施是困难的、昂贵的和耗时的。

Google 投入大量精力使 Eclipse 更适合 J2SE。同样适用于 Objective-C 的 Apple。微软不只是发布语言，它发布了全新的开发环境。如果您对您的工具链很认真，请选择一种有企业支持的语言:)

# arrays - 如何在 PowerShell 中动态地将元素添加到数组中？

> ID：13318382
> 
> 赞同：22
> 
> 时间：2012-11-10T01:36:08.210
> 
> 标签：arrays, function, dynamic, powershell

我还没有太多 PowerShell 经验，并且正在尝试自学。

我正在尝试为一个更大的项目制作一些概念验证代码。这里的主要目标是使用函数过于动态地创建元素并将元素添加到数组中。

这是我的代码：

```
$testArray = @()
function addToArray($Item1)
{
    $testArray += $Item1
    "###"
}

$tempArray = "123", "321", "453"
$foldertest = "testFolder"

foreach($item in $tempArray)
{
    addToArray $item
}
"###" 
```

每次函数完成时，数组都会变为空。请记住，我的大部分编程经验都来自 Java、PHP、一些 C 和 C++，仅举几例，如果我在 PHP 中执行此操作（当然要调整语言语法），这会很好。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2016-10-03T04:54:41.497

```
$testArray = [System.Collections.ArrayList]@()
$tempArray = "123", "321", "453"

foreach($item in $tempArray)
{
    $arrayID = $testArray.Add($item)
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-10T06:43:23.100

问题是范围之一；在您的 addToArray 函数内将行更改为：

```
$script:testArray += $Item1 
```

...存储到您期望的数组变量中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-10-11T16:51:19.953

如果您要使用动态数量的项目，更精确的解决方案可能是使用列表：

```
$testArray = New-Object System.Collections.Generic.List[System.Object]

$tempArray = "123", "321", "453"

foreach($item in $tempArray)
{
    $testArray.Add($item)
} 
```

注意：在这种情况下，您可以从**.Net**获得 List 的强大功能，因此您可以轻松地应用 linq、合并、拆分以及执行您在 .Net 中对 List 执行的任何操作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-10T17:32:47.590

而不是在每次循环迭代中重新创建数组（这基本上是每次添加时都会发生的事情），而是将循环的结果分配给一个变量：

```
$testArray = foreach($item in $tempArray)
{
    addToArray $item
} 
```

# jquery - jQuery 不显示 .attr('checked')

> ID：13318385
> 
> 赞同：0
> 
> 时间：2012-11-10T01:36:34.620
> 
> 标签：jquery

为什么jQuery不返回'checked'属性的值？

无论里面有什么，它总是返回“已检查”。

```
<div id='div' checked='checked_value'></div>
<script>
    var attr_value = $('#div').attr('checked');
    alert(attr_value);
    // attr_value == 'checked' no matter what
</script> 
```

[http://jsfiddle.net/BbRmH/2/](http://jsfiddle.net/BbRmH/2/)

没关系，在 1.4 中，但是当我升级到 1.8 时，它完全弄乱了我的代码。我经常使用`checked`属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:38:28.150

我相信在最新版本的 jQuery 中，正确的语法应该是 -

```
$("element").prop('checked'); 
```

> 属性和属性之间的区别在特定情况下可能很重要。在 jQuery 1.6 之前，该[`.attr()`](http://api.jquery.com/attr/)方法有时会在检索某些属性时考虑属性值，这可能会导致不一致的行为。从 jQuery 1.6 开始，.prop() 方法提供了一种显式检索属性值的方法，而 .attr() 检索属性。

*   [`prop()`](http://api.jquery.com/prop/)

* * *

但是，我相信您可能错误地使用了此属性。通常，只需测试`checked`选择器的存在。实际上只能有两种状态。检查和未检查。通常，人们会使用这样的东西 -

```
$('.groupOfCheckboxes:checked') 
```

这将返回已选中的所有匹配复选框的列表。您还在`<div>`元素上使用了此属性。这不是有效的 HTML。如果您想要跨浏览器的最一致的结果，您真的应该坚持使用有效标记。

# scheme - 一个返回所有其他元素列表的方案过程

> ID：13318388
> 
> 赞同：3
> 
> 时间：2012-11-10T01:36:47.193
> 
> 标签：scheme

我在 Scheme 中实现这个程序时遇到了一些麻烦，尽管我认为我已经完成了 90% 的工作。不幸的是，我需要对此有点模糊，因为这是一项家庭作业。我想（ABCD）返回（BD）。但我收到一条错误消息，指出作为参数传递给安全车的对象 () 不是一对 | “这是我的代码：

```
(DEFINE (other_el lis)
  (COND
   (( NULL? lis ) '())
   ((LIST? lis)
    (append (CADR lis) (other_el (CDR lis))))
   (ELSE (show " USAGE: (other_el [LIST])")))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T04:01:05.453

这个比你问的上一个问题要简单得多。请记住，您不必在每一步都计算长度（这可能非常低效），或者使用附加操作来解决它（使用 a`cons`代替）；这是答案的结构，因为它看起来像家庭作业，所以我让您填写空白：

```
(define (every-other lst)
  (if (or <???>                    ; if the list is empty 
          <???>)                   ; or the list has a single element
      <???>                        ; then return the empty list
      (cons <???>                  ; otherwise `cons` the second element
            (every-other <???>)))) ; and recursively advance two elements 
```

如果您需要先进行一些错误检查，请在确定参数正确后使用另一个函数并调用上述过程：

```
(define (other_el lst)
  (if (list? lst)
      (every-other lst)
      (error "USAGE: (other_el [LIST])"))) 
```

像这样使用它：

```
(other_el '(A B C D E G))
=> '(B D G) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:28:40.807

在我演示正确的代码之前，应该提到此代码的一些小问题。

1.  不要大写过程的名称，例如 cdr 和 Scheme 中的 define。
2.  不要手动显示错误消息。使用例外。
3.  你应该总是缩进你的代码。（编辑：看起来有人编辑了问题的代码以包含缩进）

无论如何，这是您正在寻找的功能：

```
(define (evens lst)
  (if (or (null? lst)             ; if the list is empty 
          (null? (cdr lst)))      ; or the list has a single element
      '()                         ; then return the empty list
      (cons (cadr lst)            ; otherwise `cons` the second element
            (evens (cddr lst))))) ; and recursively advance two elements 
```

我在 DrRacket 5.3 中测试了该函数，并且 (evens '(ABCD)) 返回 '(BD)，如您指定的那样。如果您有任何问题，请告诉我。祝你的家庭作业好运！

# checkbox - TableView JavaFX中的居中复选框

> ID：13318390
> 
> 赞同：3
> 
> 时间：2012-11-10T01:37:17.597
> 
> 标签：checkbox, tableview, javafx-2, centering

在处理需要居中复选框列的 tableview 时，我发现了一个问题。我能够创建一个带有复选框的列。我还想根据该复选框值在我的模型中设置属性。我用下面的代码做到了：

```
isCanceledCol.setCellValueFactory(new Callback<CellDataFeatures<TransactionModel,CheckBox>,ObservableValue<CheckBox>>() {

            @Override
            public ObservableValue<CheckBox> call(final CellDataFeatures<TransactionModel, CheckBox> p) {
                CheckBox cb = new CheckBox();
                cb.selectedProperty().addListener(new ChangeListener<Boolean>() {

                    @Override
                    public void changed(ObservableValue<? extends Boolean> ov, Boolean t, Boolean t1) {
                        p.getValue().setIsCanceled(t1.booleanValue());
                    }
                }
                        );
                canceledCB.add(cb);
                return new SimpleObjectProperty(cb);
            } 
```

上面代码的问题是，复选框以左对齐出现。我想让它居中，但我也想保留复选框的 changed 事件来更改我的模型属性（ p.getValue().setIsCanceled(t1.booleanValue()); ）。

我真的很感谢你们的帮助。

问候， 克里斯玛安迪卡

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:42:23.130

JavaFX Ensemble（javafx 示例）具有您尝试使用的完美代码。另外，他们提供了一种更好的在 a 中使用 a`CheckBox`的方法`TableView`。

重点是控件`TableCell`使用的范围`TableView`。为了创建`CheckBox`列，应创建并使用以下内容：

```
//CheckBoxTableCell for creating a CheckBox in a table cell
public static class CheckBoxTableCell<S, T> extends TableCell<S, T> {
    private final CheckBox checkBox;
    private ObservableValue<T> ov;

    public CheckBoxTableCell() {
        this.checkBox = new CheckBox();
        this.checkBox.setAlignment(Pos.CENTER);

        setAlignment(Pos.CENTER);
        setGraphic(checkBox);
    } 

    @Override public void updateItem(T item, boolean empty) {
        super.updateItem(item, empty);
        if (empty) {
            setText(null);
            setGraphic(null);
        } else {
            setGraphic(checkBox);
            if (ov instanceof BooleanProperty) {
                checkBox.selectedProperty().unbindBidirectional((BooleanProperty) ov);
            }
            ov = getTableColumn().getCellObservableValue(getIndex());
            if (ov instanceof BooleanProperty) {
                checkBox.selectedProperty().bindBidirectional((BooleanProperty) ov);
            }
        }
    }
} 
```

这`setAlignment(Pos.CENTER)`会将您的控件设置在单元格的中心。

# css - CSS“绝对”不会停留在一个地方

> ID：13318391
> 
> 赞同：1
> 
> 时间：2012-11-10T01:37:37.910
> 
> 标签：css, css-position

[我在我的网站http://www.tonypalazzo.com](http://www.tonypalazzo.com)的某个部分悬挂的丝带有以下 css 。

```
.ribbon {
    float:left;
    padding:5px 0 0 0;
    margin:0;
    width:217px;
    position:absolute;
    left: 965px;
    top: 67px;
    z-index: 999999;
} 
```

当在不同尺寸的显示器中查看时，甚至当我在 Chrome 中放大和缩小（以及 Dreamweaver 设计视图中的一个完全随机的位置）时，它会出现在不同的水平位置。它保持正确的垂直（顶部）定位，但看起来它总是希望与左侧保持 965px 的距离。这使得它在以不同分辨率查看时会出现在完全不同的位置。

使用“相对”位置，它不会覆盖我需要它覆盖的其他 div 框。关于如何让这个 div 位于（覆盖）其他 div 的前景的任何帮助，同时保持与我的社交媒体图标所在位置相同的左/上值（参见网站）？

我读过其他关于这个的帖子，告诉我把它放在我的“父”div中。如果我的“block_header”是父母，我相信它就在其中。这是 html 的快速摘要（忽略 .'s 我把它们放在那里只是为了确保代码显示：

```
<div class="main">
    <div class="header">
        <div class="block_header">
            <div class="logo"></div>
            <div class="social"></div>
            <div class="ribbon">
                <a href="portfolio.html"><img src="images/portf.png" onmouseover="this.src='images/portf1.png'" onmouseout="this.src='images/portf.png'"/></a>
            </div>
        </div>
    </div>
</div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:57:27.650

您的功能区与屏幕左边缘保持 965 像素，就像它应该的那样。如果您希望它相对于其父级定位，请将样式添加`position: relative`到父级。在这种情况下，您应该将其添加到`.block_header`，然后重新定位功能区。

# php - 将数据库中的图像重命名为 md5 但保留扩展名

> ID：13318392
> 
> 赞同：0
> 
> 时间：2012-11-10T01:37:43.913
> 
> 标签：php, mysql

正如标题所说，我想将存储在数据库中的图像名称更改为 md5 但保留图像扩展名，我尝试使用下面的代码但它失败了（可能是因为我不知道我在'正在做）......关于如何实现我的目标的任何想法？

```
function get_file_extension($file_name) {
  return substr(strrchr($file_name,'.'),1);
}

$query  = "SELECT img FROM post";
$result = mysql_query($query);

 while($row = mysql_fetch_array($result)) {

   $name   = substr($row['img'], -4, 4);
   $ext    = get_file_extension($row['img']);
   $notmd5 = $row['img'];
   $md5img = md5($name).'.'.$ext;

 $q = "UPDATE post SET img='$md5img' WHERE img='{$notmd5}'";
 $r = mysql_query($q) or die(mysql_error());

} 
```

..................................................... ...........

***更新***

***回答：***

同时重命名目录/文件夹和数据库名称中的文件：

```
function get_file_extension($file_name) {
  return substr(strrchr($file_name,'.'),1);
}

//path to directory to scan
$directory = "thumbs/";
 $directory2 = "md5/";
//get all image files with a .jpg extension.
$images = glob($directory . "*.*");

//print each file name
foreach($images as $image)
{
$imag = str_replace($directory, '', $image);
$ex   = get_file_extension($imag);

$new = md5($imag).'.'.$ex;

rename($image, $directory2.$new);

 $q = "UPDATE post SET img='$new' WHERE img='{$imag}'";
 $r = mysql_query($q) or die(mysql_error());
} 
```

当我最初问我的问题时，我已经重命名了 dir/folder 中的图像，但我有它们的备份，因此将 to 工作混合在一起并实现了我的目标:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T02:00:54.867

首先，我建议像这样的批量更新只使用纯 SQL 完成，特别是如果业务逻辑如此简单，那么肯定可以在 MySQL 中本地完成。

无论如何..，弹出的一件事是`substr`获取文件的调用`$name`，它被硬编码为仅获取 4 个字符，它实际上获取的是扩展名而不是名称。

试试这个：

```
$ext = get_file_extension($row['img']);  // get ext first

// use length of $row['img'] - length of file extension to extract name
substr($row['img'], 0, strlen($row['img']) - strlen($ext) - 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T02:01:07.673

只需在纯 SQL 中执行：

```
UPDATE post SET img = CONCAT_WS('.',
  MD5(TRIM(TRAILING CONCAT('.', SUBSTRING_INDEX(img, '.', -1)) FROM img)),
  SUBSTRING_INDEX(img, '.', -1)
) 
```

# javascript - 我只是想确认...声明（不分配）已经声明的变量绝对没有任何作用，对吗？

> ID：13318395
> 
> 赞同：0
> 
> 时间：2012-11-10T01:38:15.443
> 
> 标签：javascript, variables

我的测试表明标题确实是正确的。但我不知道是否有一些我没有想到的细微差别。另请参阅：[在 for 循环或 if 块中声明变量有什么问题吗？](https://stackoverflow.com/questions/13318375/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:54:41.103

如果它们在同一范围内，则您的测试是正确的。在同一个范围内重新声明同一个变量没有任何作用。

但是，如果它们不在同一范围内，则在本地范围内重新声明变量将创建一个新变量，该变量将覆盖该范围内的原始变量。

所以，这很好用：

```
var value = "foo";
var value;
console.log(value);   // "foo" 
```

但是，这会在本地范围内创建一个新变量，该变量不具有全局定义的值：

```
var value = "foo";

function test() {
    var value;            // this creates a new variable that is separate
                          // from the globally declared one with the same name
    console.log(value);   // undefined
}

test(); 
```

# mysql - 如何在不增加重复项的 auto_increment 列的情况下进行批量 mysql 插入？

> ID：13318396
> 
> 赞同：5
> 
> 时间：2012-11-10T01:38:17.263
> 
> 标签：mysql, sql, mysql-5.5

这是我的数据库架构

```
+------------------+------------------+------+-----+---------------------+----------------+
| Field            | Type             | Null | Key | Default             | Extra          |
+------------------+------------------+------+-----+---------------------+----------------+
| phone_number     | varchar(64)      | NO   | UNI | NULL                |                |
| id               | int(10) unsigned | NO   | PRI | NULL                | auto_increment |
+------------------+------------------+------+-----+---------------------+----------------+ 
```

我希望能够一次插入多个电话号码（**phone_number**是唯一键），但如果我有重复项，我不想增加 auto_increment 字段。

如果我做

```
INSERT INTO
   phone_numbers (phone_number) 
VALUES
   (
       % 
   VALUES
       % 
   )
   ON DUPLICATE KEY 
   UPDATE
      id = id; 
```

即使重复，auto_increment 也会增加。

这个问题：[Prevent auto increment on MySQL duplicate insert](https://stackoverflow.com/questions/5924762/prevent-autoincrement-on-mysql-duplicate-insert) does not handle bulk inserts。我想做这样的事情：

```
INSERT INTO
   phone_numbers (phone_number) 
   SELECT
      '12345',
      '123456' 
   FROM
      DUAL 
   WHERE
      NOT EXISTS
      (
         SELECT
            phone_number 
         FROM
            phone_numbers 
         WHERE
            phone_number IN 
            (
               '12345',
               '123456'
            ); 
```

但该`DUAL`表并不能很好地处理多个值。

有任何想法吗？MySQL 5.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:43:44.347

在阅读另一篇文章后，一种方法是拥有一个批量插入的临时表。然后从临时表中选择行到我们的实际表中。此时将删除重复的行，并且实际表中的 auto_increment 字段将是正确的。

```
CREATE TABLE PHONE_NUMBERS (id int(10) NOT NULL AUTO_INCREMENT, phone_number varchar(64), primary key (id), unique(phone_number) );

CREATE TEMPORARY TABLE TMP_PHONE_NUMBERS ( phone_number varchar(64), unique(phone_number) );

' bulk insert
INSERT INTO tmp_phone_numbers (phone_number) VALUES (%values%)

' remove phone numbers that already exist. This will create a unique
' set of phone numbers that do not exist in the real table.
DELETE FROM tmp_phone_numbers WHERE phone_number in (SELECT phone_number from phone_numbers);

' copy into real table
INSERT INTO phone_numbers (phone_number) SELECT phone_number FROM tmp_phone_numbers;

' Temp table is dropped when your connection is closed. 
```

这是另一种选择：

如果您知道您不会在第一次批量加载或任何后续批量加载中命中 int(10)，那么您可以使用`INSERT INTO phone_numbers (phone_number) VALUES (%values%) ON DUPLICATE KEY UPDATE id=id;`这将在 id 字段中留下空白。但是在完成批量加载后，您可以删除 ID 列，然后重新添加它，这将重新创建您的所有 id，没有间隙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T03:16:10.790

由于 INSERT IGNORE 确实增加了表上的自动增量计数器（即使没有对数据进行更改），一个简单的解决方法是通过利用引擎逻辑在事务结束时恢复自动增量值当试图强制一个太低的值时，总是选择一个大于当前最高 AI 值的整数：

```
ALTER TABLE phone_numbers AUTO_INCREMENT = 0; 
```

这样做不需要重建表，可以进行如下测试：

```
SELECT MAX(id) FROM phone_numbers;
INSERT IGNORE INTO phone_numbers (phone_number) VALUES ("0123456789");
SELECT MAX(id) FROM phone_numbers;
INSERT IGNORE INTO phone_numbers (phone_number) VALUES ("0123456789");
SELECT MAX(id) FROM phone_numbers;
ALTER TABLE phone_numbers AUTO_INCREMENT = 1;
INSERT IGNORE INTO phone_numbers (phone_number) VALUES ("1000000000");
SELECT MAX(id) FROM phone_numbers;

+---------+
| MAX(id) |
+---------+
|    NULL |
+---------+
1 row in set (0.00 sec)

Query OK, 1 rows affected (0.00 sec)

+---------+
| MAX(id) |
+---------+
|       1 |
+---------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+---------+
| MAX(id) |
+---------+
|       1 |
+---------+
1 row in set (0.00 sec)

Query OK, 1 rows affected (0.33 sec)
Records: 1  Duplicates: 0  Warnings: 0

Query OK, 0 rows affected (0.00 sec)

+---------+
| MAX(id) |
+---------+
|       2 |
+---------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-10T03:57:07.897

只需使用插入忽略。这将忽略任何由于重复键而失败的插入。其余的插入将很好地完成。

# php - 我可以在 HTML5 中创建自定义 HTML 标签吗？

> ID：13318404
> 
> 赞同：5
> 
> 时间：2012-11-10T01:39:39.770
> 
> 标签：php, html, syntax, custom-tag

我想知道是否可以为我的网站创建一个与 Facebook 的 Open Graph 元标记具有相同功能的自定义 HTML 标记。

我在想这样的事情：

```
<mysite title="My website title" description="Some description" 
    image="http://mysite.com/image.png"> 
```

然后使用 PHP 来获取这些数据（我已经可以使用元标记来做到这一点）。

几点：

*   我使用 HTML5，使用这种方法有语法问题吗？

*   Google+ 使用这样的东西：g:plusone

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T01:50:35.317

主要问题是自定义元素在形式上是无效的。

这是文档所说的：

> 作者不得使用本规范或其他适用规范不允许的元素、属性或属性值，因为这样做会使该语言在未来的扩展变得更加困难。

[HTML5 元素](http://dev.w3.org/html5/spec/elements.html#elements)

顺便说一句，对于 W3 错误跟踪器中的自定义元素，有一个可靠的面向未来的[提议](https://www.w3.org/Bugs/Public/show_bug.cgi?id=14011)，但它像往常一样被一个很酷的家伙 Hixie 拒绝了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:57:06.110

是的，如果您将页面呈现为 XHTML (XML)，您应该能够做到这一点。`<html xmlns="http://www.w3.org/1999/xhtml">`在您的开始`<html>`标签中使用。正如 Marat Tanalin 所说，它是“正式”无效的语法。

您可以使用 in use XPATH 以各种方式解析文档`simplexml_load_string()`以查询这些元素。

```
$fileContents = file_get_contents('/path/to/template', FILE_USE_INCLUDE_PATH);
$template     = simplexml_load_string($fileContents);
$myTags       = $template->xpath('//mysite'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-10T02:43:28.320

[Marat Tanalin 是对的](https://stackoverflow.com/a/13318456/1591669)，在 HTML5 中，您不允许“发明”未指定的元素/属性/值。[Alohci 给出了一个很好的例子](https://stackoverflow.com/a/13318529/1591669)，为什么这是原因。

[mmmshuddup 说明](https://stackoverflow.com/a/13318506/1591669)，您可以使用 XHTML5。但是，我认为在这种情况*下*是允许的，如果你扩展词汇表是正确的。毕竟是 XML。不过，它不再是多语言 (X)HTML5 文档了。

我认为可能有一个 (X)HTML5 解决方案可以为您工作（但取决于您的具体用例）：[`data-*`属性](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-*-attributes)：

```
<div data-title="My website title" data-description="Some description" data-image="http://mysite.com/image.png">…&lt;/div> 
```

`data-`您可以“发明”以您可以自由定义的字符串开头的属性。

另一种可能（更复杂）的方法可能是使用具有适合您需求的现有词汇表的[微数据](http://en.wikipedia.org/wiki/Microdata_%28HTML%29)（如果找不到，您可以自己创建一个）。如果您要提供的（元）数据对其他人有价值，我只会这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-10T02:00:13.110

看到这个问题：[Removing Chrome's "translate" DOM Property](https://stackoverflow.com/questions/13113914/removing-chromes-translate-dom-property)

在这里，有人使用了非标准属性名称（非标准元素名称可能存在相同的问题），结果发现该名称现在已在浏览器中进行了标准化和解释，而提问者面临着可怕的变通方法避免大量返工。

我从未见过证明所涉及风险合理的用例。

当然，如果您碰巧像 Google 或 Facebook 一样大，那么您的非标准名称很可能会广为人知，不会因名称冲突而被发现。

# android - 修复了移动触摸设备上的背景图像滚动不会立即更新

> ID：13318406
> 
> 赞同：7
> 
> 时间：2012-11-10T01:39:45.587
> 
> 标签：android, css, scroll, touch, background-image

CSS：

```
body{
margin:0 auto;
background-image:url("someURL"),
background-repeat:no-repeat;
background-attachment:fixed;
background-size:cover;
} 
```

这在现代浏览器中运行良好，滚动时图像保持不变。但是在安卓平板电脑上，图像不会立即更新。图像仅在您释放（将手指移开）后大约半秒更新，平均而言，间隙只是白色。

有没有办法解决这个问题，或者只是某些浏览器的行为方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T12:49:10.540

这是已知的错误，您可以在此处找到详细信息： [http ://code.google.com/p/android/issues/detail?id=3301](http://code.google.com/p/android/issues/detail?id=3301)

# c# - excel COM API - 分配给一系列单元格

> ID：13318408
> 
> 赞同：0
> 
> 时间：2012-11-10T01:40:27.690
> 
> 标签：c#, excel

由于使用 Excel API 通过 C# 代码分配给大工作表中的每个单元格可能效率很低，因此我试图分配给一系列单元格。但是， Range.Value2 仅适用于多维数组。就我而言，我有一个字符串列表。有没有办法做到这一点？在列表和数组之间来回转换可能效率低下。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:00:27.193

Excel 互操作的成本是调用进程外组件的开销。需要做一些工作来跨流程边界编组数据。但这是一个恒定的成本，取决于数据量。数据越少越好，但这不是您的典型选择。

因此，真正的成本首先在于拨打电话的开销。与进行进程内方法调用的成本相比，这是非常可观的。在最坏的情况下，这需要几个 cpu 周期。进程外调用需要两个线程上下文切换，这至少需要 2000 到 10000 个周期，仅用于处理器开销。您处于该线程的高端，因为需要在 Excel 中运行的线程归另一个进程所有，因此处理器缓存是垃圾。添加该线程响应的延迟，高度不可预测。

因此，您有*数万*个 cpu 周期的预算来进行转换并取得成功。明智地使用它们。当然，实际**尝试**一下，没有人可以给你保证。

# vim - Vim：inoremap 在缓冲区中工作，而不是在 .vimrc 中

> ID：13318410
> 
> 赞同：2
> 
> 时间：2012-11-10T01:40:47.150
> 
> 标签：vim

我真的很想在我的 .vimrc 文件中包含以下内容：

```
inoremap <Tab> <C-x><C-u> 
```

如果我将它设置在缓冲区中（通过`:inoremap <Tab> <C-x><C-u>`），它的工作原理与我希望的完全一样。

但是，如果我把它放在我的 .vimrc 中，它似乎根本没有被承认。

我在下面附上了我的 .vimrc。一些东西：

*   .vimrc 文件的其他更改被拾取，所以它不是错误的文件
*   尝试在 .vimrc 的最底部添加 & 仍然不起作用，所以它没有被覆盖

任何想法表示赞赏。非常感谢。

```
" When started as "evim", evim.vim will already have done these settings.
if v:progname =~? "evim"
  finish
endif

" Word complete
" :autocmd BufEnter * call DoWordComplete() 
" let g:WC_min_len = 4

" Use Vim settings, rather than Vi settings (much better!).
" This must be first, because it changes other options as a side effect.
set nocompatible
map j gj
map k gk

set showmatch " Show matching brackets
set mat=5 " Bracket blinking
set noerrorbells " No noise

" Ruby autocomplete

" Autocomplete behaviour
set completeopt=longest,menuone
open omni completion menu closing previous if open and opening new menu without changing the text
inoremap <expr> <C-Space> (pumvisible() ? (col('.') > 1 ? '<Esc>i<Right>' : '<Esc>i') : '') .
            \ '<C-x><C-o><C-r>=pumvisible() ? "\<lt>C-n>\<lt>C-p>\<lt>Down>" : ""<CR>'
" open user completion menu closing previous if open and opening new menu without changing the text
inoremap <expr> <S-Space> (pumvisible() ? (col('.') > 1 ? '<Esc>i<Right>' : '<Esc>i') : '') .
            \ '<C-x><C-u><C-r>=pumvisible() ? "\<lt>C-n>\<lt>C-p>\<lt>Down>" : ""<CR>'

autocmd FileType ruby,eruby set omnifunc=rubycomplete#Complete
autocmd FileType ruby,eruby let g:rubycomplete_buffer_loading = 1
autocmd FileType ruby,eruby let g:rubycomplete_rails = 1
autocmd FileType ruby,eruby let g:rubycomplete_classes_in_global = 1
" highlight Pmenu ctermbg=238 gui=bold "improve autocomplete menu color

" Colours
highlight Pmenu ctermfg=6 ctermbg=238 guibg=grey30

" allow backspacing over everything in insert mode
set backspace=indent,eol,start

" if has("vms")
"   set nobackup        " do not keep a backup file, use versions instead
" else
"   set backup      " keep a backup file
" endif

" Set backupdir to tmp
" Do not let vim create <filename>~ backup files
set nobackup
" set nowritebackup

set history=50      " keep 50 lines of command line history
set ruler       " show the cursor position all the time
set showcmd     " display incomplete commands
set incsearch       " do incremental searching

" Set tab to 2 spaces
set ts=2
set shiftwidth=2

" Ignore case
set ignorecase
set smartcase

" Menu autocomplete
set wildmode=longest,list
set wildmenu

" Call pathogen
call pathogen#infect()

" For Win32 GUI: remove 't' flag from 'guioptions': no tearoff menu entries
" let &guioptions = substitute(&guioptions, "t", "", "g")

" Don't use Ex mode, use Q for formatting
map Q gq

" CTRL-U in insert mode deletes a lot.  Use CTRL-G u to first break undo,
" so that you can undo CTRL-U after inserting a line break.
inoremap <C-U> <C-G>u<C-U>

" In many terminal emulators the mouse works just fine, thus enable it.
if has('mouse')
  set mouse=a
endif

" Switch syntax highlighting on, when the terminal has colors
" Also switch on highlighting the last used search pattern.
if &t_Co > 2 || has("gui_running")
  syntax on
  set hlsearch
endif

" Turn syntax highlighting on (Added by John Bayne, 18/08/2012)
syntax on

" Only do this part when compiled with support for autocommands.
if has("autocmd")

  " Enable file type detection.
  " Use the default filetype settings, so that mail gets 'tw' set to 72,
  " 'cindent' is on in C files, etc.
  " Also load indent files, to automatically do language-dependent indenting.
  filetype plugin indent on

  " Put these in an autocmd group, so that we can delete them easily.
  augroup vimrcEx
  au!

  " For all text files set 'textwidth' to 78 characters.
  autocmd FileType text setlocal textwidth=78

  " When editing a file, always jump to the last known cursor position.
  " Don't do it when the position is invalid or when inside an event handler
  " (happens when dropping a file on gvim).
  " Also don't do it when the mark is in the first line, that is the default
  " position when opening a file.
  autocmd BufReadPost *
    \ if line("'\"") > 1 && line("'\"") <= line("$") |
    \   exe "normal! g`\"" |
    \ endif

  augroup END

else

  set autoindent        " always set autoindenting on

endif " has("autocmd")

" Convenient command to see the difference between the current buffer and the
" file it was loaded from, thus the changes you made.
" Only define it when not defined already.
if !exists(":DiffOrig")
  command DiffOrig vert new | set bt=nofile | r ++edit # | 0d_ | diffthis
          \ | wincmd p | diffthis
endif

" My customisations
" No backup files
set nobackup
set nowritebackup
set noswapfile

" Whitespace identifier
:highlight ExtraWhitespace ctermbg=darkgreen guibg=lightgreen
:match ExtraWhitespace /\s\+$/

" Colour options
" color codeschool
" set guifont=Monaco:h12
" let g:NERDTreeWinPos = "right"
" set guioptions-=T " Removes top toolbar
" set guioptions-=r " Removes right hand scroll bar
" set go-=L " Removes left hand scroll bar
" autocmd User Rails let b:surround_{char2nr('-')} = "<% \r %>" " displays <% %> correctly
" :set cpoptions+=$ " puts a $ marker for the end of words/lines in cw/c$ commands

" Tab behaviour for ultisnips
let g:UltiSnipsExpandTrigger="<tab>" 
let g:UltiSnipsJumpForwardTrigger="<tab>" 
let g:UltiSnipsJumpBackwardTrigger="<s-tab>" 

inoremap <Tab> <C-x><C-u> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-10T05:43:51.773

在这种情况下`:scriptnames`，虽然有用，但并不是查看上次设置映射位置的最佳方式。

```
:verbose map <tab> 
```

更精确。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T01:59:19.037

*在您的.vimrc*被读取 后，可能另一个脚本正在覆盖它。

您可以使用`:scriptnames`查看启动时读取的文件。

# c# - 如何在c#中将带点的十进制数转换为二进制数？

> ID：13318411
> 
> 赞同：1
> 
> 时间：2012-11-10T01:40:47.127
> 
> 标签：c#

```
In this web i see that all answer about thins like converting decimal number to     binary
its refers number without point in the number(int)...
i want to know how to convert the decimal number with point like "332.434" to binary in c# 
```

我看到的例子：

```
 using System;

namespace _01.Decimal_to_Binary
{
    class DecimalToBinary
    {
        static void Main(string[] args)
        {
            Console.Write("Decimal: ");
            int decimalNumber = int.Parse(Console.ReadLine());

            int remainder;
            string result = string.Empty;
            while (decimalNumber > 0)
            {
                remainder = decimalNumber % 2;
                decimalNumber /= 2;
                result = remainder.ToString() + result;
            }
            Console.WriteLine("Binary:  {0}",result);
        }
    }
} 
```

该示例是指从 int 无点转换

感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:58:43.377

只需使用 BitConverter 获取字节，然后循环它们将它们转换为字符串并将当前的位字符串附加到前一个位。

```
byte[] byteArray = BitConverter.GetBytes(MyDouble);
string ByteString = System.String.Empty;
for (int i = 0; i < byteArray.Length; i++)
    ByteString = Convert.ToString(byteArray[i], 2).PadLeft(8, '0'); 
```

您可能需要进行一些修改才能以正确的顺序获取位，但我认为 BysteString 将在左侧具有高位。这是该 ToString 方法的 MSDN 页面[http://msdn.microsoft.com/en-us/library/8s62fh68.aspx](http://msdn.microsoft.com/en-us/library/8s62fh68.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-10T02:16:30.160

您不能简单地将非整数转换为二进制格式。例如，对于 3.145926，计算机保留一个符号 (+/-)，一个数字本身，但始终带有前导零 (0.3141596) 和尾数 (E-1)。所以你需要保留所有 3 个部分。阅读更多维基百科[http://en.wikipedia.org/wiki/Floating_point#Representable_numbers.2C_conversion_and_rounding](http://en.wikipedia.org/wiki/Floating_point#Representable_numbers.2C_conversion_and_rounding)

# javascript - Android 4，如何在更改事件上关闭选择面板

> ID：13318414
> 
> 赞同：2
> 
> 时间：2012-11-10T01:41:22.293
> 
> 标签：javascript, android, webview

在 Android 4 上，html 选择元素会打开一个带有“完成”按钮的面板。用户可以选择一个元素，然后单击“完成”关闭面板。Javascript 更改事件发生在用户选择其中一个元素而不是按下完成按钮时。我想以编程方式关闭更改事件的面板，使用户不必点击完成按钮。

我尝试将焦点发送到其他元素并在选择元素上进行模糊处理，但它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:03:39.153

Calling "blur()" on the select-element works on my Phones: Android-Browser 4.1.2 and Mobile Safari 6.0

```
$('#mySelect').change(function(){
    this.blur();
}); 
```

# codeigniter - 通过 CodeIgniter 从 Aol 帐户 SMTP 发送电子邮件

> ID：13318418
> 
> 赞同：0
> 
> 时间：2012-11-10T01:42:22.083
> 
> 标签：codeigniter, aol

应用程序/配置/email.php

```
<?php

$config['protocol'] = 'smtp';
$config['smtp_host'] = 'tls://smtp.aol.com';
$config['smtp_user'] = 'chris.muench';
$config['smtp_pass'] = 'PASSWORD';
$config['smtp_port'] = '587';
$config['charset']='utf-8';
$config['newline']="\r\n";
$config['crlf'] = "\r\n";

?> 
```

电子邮件调试语句：

```
The following SMTP error was encountered: 0 
Unable to send data: AUTH LOGIN
Failed to send AUTH LOGIN command. Error: 
Unable to send data: MAIL FROM:
from: 
The following SMTP error was encountered: 
Unable to send data: RCPT TO:
to: 
The following SMTP error was encountered: 
Unable to send data: DATA
data: 
The following SMTP error was encountered: 
Unable to send data: User-Agent: CodeIgniter Date: Fri, 9 Nov 2012 20:39:52 -0500 From: "PHP Point Of Sale, Inc"  Return-Path:  To: chris.muench@aol.com Subject: =?utf-8?Q?Reset_password?= Reply-To: "admin@phppointofsale.com"  X-Sender: admin@phppointofsale.com X-Mailer: CodeIgniter X-Priority: 3 (Normal) Message-ID: <509db0685db38@phppointofsale.com> Mime-Version: 1.0 Content-Type: multipart/alternative; boundary="B_ALT_509db0685db40" This is a multi-part message in MIME format. Your email application may not support this format. --B_ALT_509db0685db40 Content-Type: text/plain; charset=utf-8 Content-Transfer-Encoding: 8bit You have requested to reset your password, please click the link below in order to complete the password reset process Reset password --B_ALT_509db0685db40 Content-Type: text/html; charset=utf-8 Content-Transfer-Encoding: quoted-printable You have requested to reset your password, please click the link below in o= rder to complete the password reset process 
```

注意：我可以从 gmail 帐户发送电子邮件。怎么了？

# c++ - 我需要构建 TinyThread++ 吗？

> ID：13318419
> 
> 赞同：0
> 
> 时间：2012-11-10T01:42:58.923
> 
> 标签：c++, multithreading

[我已经从网站上](http://tinythreadpp.bitsnbites.eu/)的 zip 文件中提取了源代码并将它们放在 Code::Blocks 的“包含”文件夹中，但即便如此它也无法编译提供的“hello.cpp”示例。

（以供参考：）

```
#include <iostream>
#include <tinythread.h>

using namespace std;
using namespace tthread;

// This is the child thread function
void HelloThread(void * aArg)
{
  cout << "Hello world!" << endl;
}

// This is the main program (i.e. the main thread)
int main()
{
  // Start the child thread
  thread t(HelloThread, 0);

  // Wait for the thread to finish
  t.join();
} 
```

这些是以下错误：

```
|41|undefined reference to `tthread::thread::thread(void (*)(void*), void*)'|
|44|undefined reference to `tthread::thread::join()'|
|44|undefined reference to `tthread::thread::~thread()'|
|44|undefined reference to `tthread::thread::~thread()'| 
```

wxDev-C++ 也会发生同样的事情。我错过了什么吗？像，我需要建立图书馆或任何东西吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T02:00:08.737

从存档中的 readme.txt ：

> **使用 TinyThread++**
> 
> 要在您自己的项目中使用 TinyThread++，**只需将 tinythread.cpp 和 tinythread.h 添加到您的项目**中。在您自己的代码中，执行以下操作：

```
#include <tinythread.h>
using namespace tthread; 
```

> 如果你想使用 fast_mutex 类，包括 fast_mutex.h：

```
#include <fast_mutex.h> 
```

仅包含标头会导致未解析的符号，因为 .cpp 没有被编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T22:06:22.640

TinyThread 很小。

除了包含标题之外，您只需将 TinyThread.cpp 添加到您的项目或确保它作为您项目的一部分构建。

在我将 CPP 文件添加到我的项目之前，我在 VC++ 中发生了特定错误。

线程类和方法没有被编译。

# json - 单个字符串值是否被视为有效 JSON？

> ID：13318420
> 
> 赞同：44
> 
> 时间：2012-11-10T01:43:01.067
> 
> 标签：json

您是否考虑 JSON 网络响应：

```
"A serialization error occurred" 
```

是否有效？

[一些验证者接受它](http://www.freeformatter.com/json-validator.html)，而另一些则不接受。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-07-17T13:32:34.703

至于新的[JSON RFC](http://www.ietf.org/rfc/rfc7159.txt)， json，仅包含单个值是非常有效的。

> JSON 文本是一个序列化的值。请注意，某些先前的 JSON 规范将 JSON 文本限制为对象或数组。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-08-20T23:01:14.413

[在RFC4627](http://www.ietf.org/rfc/rfc4627.txt)和[RFC7159](https://www.rfc-editor.org/rfc/rfc7159)之间对此有所改变：

**RFC4627**：

> JSON 文本是一个序列化的对象或数组。
> 
> ```
>  JSON-text = object / array 
> ```

**RFC7159**：

> JSON 文本是一个序列化的值。请注意，某些先前
> 的 JSON 规范将 JSON 文本限制为对象或
> 数组。仅生成需要
> JSON 文本的对象或数组的实现将是可互操作的，因为所有
> 实现都将接受这些作为符合标准的 JSON 文本。
> 
> ```
>  JSON-text = ws value ws 
> ```

没有为这种改变心意提供哲学或实践的理由。较早的版本可能更有意义，因为它始终规定同时包含单个列表元素和单个映射元素（一对或元组）。第二个版本只允许不包含单个列表元素。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-11-10T02:11:15.213

According to the grammar exposed in [http://www.json.org/](http://www.json.org/) (which references the [Standard ECMA-262 3rd Edition - December 1999](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf) par.5.1.5 The JSON Grammar) it's wrong:

The initial element must be:

![enter image description here](../Images/dcd98ffa37389f91ae9b542f257dc636.png)

![enter image description here](../Images/21329f923efa34b29e83aaa7d5a2e6f5.png)

and then a value can be a string:

![enter image description here](../Images/6efd60b491e522feab0a72629b5f43e7.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-10T02:00:50.673

来自[RFC4627](http://www.ietf.org/rfc/rfc4627.txt)：

> ```
> A JSON text is a serialized object or array.
>     JSON-text = object / array 
> ```

IE，根元素必须是对象或数组，不能单独为字符串值。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-11-10T01:46:42.573

我不在乎某个验证者是否接受它。这是错的。这是一个良好实践的问题，Json 格式必须是`{"key": "value", .....}`. 如果您认为该文本 Json 可以工作，但对于其他程序员来说，这不是一个严肃的 Json。如果您只使用该文本，那么您不需要 Json。

# android - 我扩展了一个应用程序，我需要数据在应用程序关闭后不保留

> ID：13318424
> 
> 赞同：0
> 
> 时间：2012-11-10T01:43:55.453
> 
> 标签：android

我猜这很简单。

我有一个用户和一些其他对象，我需要在我的应用程序的许多活动中使用它们，所以我决定创建一个类并扩展应用程序以使这些对象“全局”，例如在用户登录后，我有用户对象沿我所有的活动使用。

问题是应用程序关闭后数据不会丢失/重置。所以当我再次打开我的应用程序时，它不会要求我再次登录。所以我需要以某种方式关闭另一个应用程序。我该怎么做？

我发现的一个姑息解决方案是将变量设置为何`null`时`backPressed`调用`MainActivity`（并且我的应用程序已关闭），但我知道这是不对的，必须有一个更优雅的方法来做到这一点。

# azure - 任何基于 IaaS 的云上的云无关工具

> ID：13318429
> 
> 赞同：3
> 
> 时间：2012-11-10T01:45:38.557
> 
> 标签：azure, amazon-web-services, cloud, openstack, amazon-cloudformation

是否有任何像 CloudFormation 之类的技术可以在任何基于 IaaS 的云上工作以做同样的事情？我的意思是你只写一次，然后它就可以在任何基于 IaaS 的云平台上运行，比如 azure、aws、openstack 等等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T23:02:44.190

您的问题是做出一些不太正确的假设 - 有很多不同类型的云 - Google AppEngine、OpenShift、Heroku 和 Azure（例如）与您从 Amazon AWS 获得的云服务在一个非常不同的层工作， CloudStack、OpenStack 等

第一个更多是平台即服务（PaaS）游戏，后者更多是基础设施即服务（IaaS）。话虽如此，鉴于您询问的是 Amazon 的 CloudFormation，值得一提的是，OpenStack 云中有一种等效的技术，称为[HEAT](http://heat-api.org)（尽管我不知道有一种可以与 CloudStack 一起使用）。

要回答您更高级别的问题“有没有办法编写一次并在任何云上运行它？”，今天的答案是合格的“否”。您可以使用许多 API 和帮助程序库来使多个云提供商选项更加兼容，并且一些公司正在为这款游戏（例如 enStratus）赚足了钱。但是它们都没有允许您“在任何地方运行它”——尤其是当您将 IaaS 风格的云与 PaaS 风格的云混为一谈时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T17:24:22.610

我认为您正在寻找的正是 OpenStack Heat 项目[http://wiki.openstack.org/Heat](http://wiki.openstack.org/Heat)该项目正在积极开发中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T14:55:08.990

您所描述的是在多个云上工作的平台即服务 (PaaS)。这里有一个类似的问题：[Cloud Mangement for Amazon IaaS](https://stackoverflow.com/questions/13305454/cloud-mangement-for-amazon-iaas)

答案还链接到 PaaS 选项的比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T23:16:45.923

检出入口。它是一个用于与多个云 API 交互的 UI。因此，您可以在不同的云之间存储和移动图像，然后上下旋转它们。可能是你想要的。

# c++ - C++ 错误：对非类类型“GraphicsManager”的“grmanager”中的成员“...”的请求

> ID：13318430
> 
> 赞同：5
> 
> 时间：2012-11-10T01:45:39.293
> 
> 标签：c++, sdl

我的类 GraphicsManager 出现错误。

图形管理器.cpp：

```
#include "C:\Users\Chris Uzzolina\Desktop\obj\include\GraphicsManager.h"
#include <SDL.h>
#include <string>
GraphicsManager::GraphicsManager(int SCREEN_WIDTH, int SCREEN_HEIGHT, int SCREEN_BPP,  std::string caption, SDL_Surface *screen)
{

}

GraphicsManager::~GraphicsManager()
{
    //dtor
}
bool init(int SCREEN_WIDTH, int SCREEN_HEIGHT, int SCREEN_BPP, std::string caption, SDL_Surface *scr)
{
    //Initialize all SDL subsystems
    if( SDL_Init( SDL_INIT_EVERYTHING ) == -1 )
    {
        return false;
    }

    //Set up the screen
    scr = SDL_SetVideoMode( SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP, SDL_SWSURFACE );

    //If there was an error in setting up the screen
    if( scr == NULL )
    {
        return false;
    }

    //Set the window caption
    SDL_WM_SetCaption( "Event test", NULL );

    //If everything initialized fine
    return true;
}

SDL_Surface *load_image( std::string filename )
{
    //Temporary storage for the image that's loaded
    SDL_Surface* loadedImage = NULL;

    //The optimized image that will be used
    SDL_Surface* optimizedImage = NULL;
    //Load the image
    loadedImage = SDL_LoadBMP( filename.c_str() );
    //If nothing went wrong in loading the image
    if( loadedImage != NULL )
    {
        //Create an optimized image
        optimizedImage = SDL_DisplayFormat( loadedImage );

        //Free the old image
        SDL_FreeSurface( loadedImage );
    }
    //Return the optimized image
    return optimizedImage;
}

void apply_surface( int x, int y, SDL_Surface* source, SDL_Surface* destination )
{
    //Make a temporary rectangle to hold the offsets
    SDL_Rect offset;

    //Give the offsets to the rectangle
    offset.x = x;
    offset.y = y;
    //Blit the surface
    SDL_BlitSurface( source, NULL, destination, &offset );
}

void clean_up(SDL_Surface *image) 
{
    //Free the image
    SDL_FreeSurface( image );
}

void quit_sdl()
{
    SDL_Quit();
} 
```

图形管理器.h：

```
#ifndef GRAPHICSMANAGER_H
#define GRAPHICSMANAGER_H
#include <string>
#include<SDL.h>
class GraphicsManager
{
public:
    GraphicsManager();
    GraphicsManager(int SCREEN_WIDTH, int SCREEN_HEIGHT, int SCREEN_BPP, std::string caption, SDL_Surface *screen);
    virtual ~GraphicsManager();
    bool init(int SCREEN_WIDTH, int SCREEN_HEIGHT, int SCREEN_BPP, std::string caption, SDL_Surface *screen );
    SDL_Surface *load_image(std::string filename);
    void apply_surface( int x, int y, SDL_Surface* source, SDL_Surface* destination );
    void clean_up(SDL_Surface *image);
    void quit_sdl();
protected:
private:
};

#endif // GRAPHICSMANAGER_H 
```

SDLLesson01.cpp：

```
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include <string>
#include "C:\Users\Chris Uzzolina\Desktop\obj\include\GraphicsManager.h"

int SCREEN_WIDTH = 640;
int SCREEN_HEIGHT = 480;
int SCREEN_BPP = 32;
SDL_Surface *message = NULL;
SDL_Surface *background = NULL;
SDL_Surface *screen = NULL;
std::string caption = "THProject";
SDL_Event event;

int main( int argc, char* args[] )
{
    bool quit=false;
    GraphicsManager grmanager();
    grmanager.init(SCREEN_WIDTH , SCREEN_HEIGHT , SCREEN_BPP , caption , screen);
    message = grmanager.load_image( "riku.bmp" );
    background = grmanager.load_image( "abc.bmp" );
    grmanager.apply_surface( 0, 0, background, screen );
    grmanager.apply_surface( 320, 0, background, screen );
    grmanager.apply_surface( 0, 240, background, screen );
    grmanager.apply_surface( 320, 240, background, screen );
    grmanager.apply_surface( 180, 140, message, screen );
    if( SDL_Flip( screen ) == -1 )
    {
        return 1;
    }
    while(quit==false)
    {
        while(SDL_PollEvent(&event))
        {
            if (event.type== SDL_QUIT)
            {
                quit=true;
            }
        }
    }
    grmanager.clean_up(message);
    grmanager.clean_up(background);
    grmanager.quit_sdl();
    return 0;
} 
```

到目前为止，我已经在这个网站上搜索了多个错误，并且被我最新的错误难住了。如果有人可以对这个问题提供一些见解，将不胜感激。我正在运行 Windows Vista 并`Code::Blocks`与`mingw`编译器和`SDL`库一起使用。这是构建消息：

```
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp||In function 'int SDL_main(int, char**)':|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|20|error: request for member 'init' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|21|error: request for member 'load_image' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|22|error: request for member 'load_image' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|23|error: request for member 'apply_surface' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|24|error: request for member 'apply_surface' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|25|error: request for member 'apply_surface' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|26|error: request for member 'apply_surface' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|27|error: request for member 'apply_surface' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|42|error: request for member 'clean_up' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|43|error: request for member 'clean_up' in 'grmanager', which is of non-class type 'GraphicsManager()'|
C:\Users\Chris Uzzolina\Desktop\obj\SDLLesson01.cpp|44|error: request for member 'quit_sdl' in 'grmanager', which is of non-class type 'GraphicsManager()'|
||=== Build finished: 11 errors, 0 warnings ===| 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T10:10:01.790

在您的代码中，您有：

```
GraphicsManager grmanager(); 
```

您认为这是一个名为 grmanager 的 GraphicsManager 类型的 var 声明，并强制调用默认构造函数。但它确实是一个名为 grmanager 的函数声明，它返回一个 GraphicsManager 并且不带任何参数。所以你的编译器不理解

```
grmanager.Init(...) 
```

至于它，grmanager 是一个**函数**名。

尝试用简单的 GraphicsManager grmanager 替换您的声明；

应该没问题，如果你不将参数传递给构造函数，它是被调用的默认值（除非你有一个黑暗的灵魂并且只创建了一个只有带默认值的参数的构造函数）

# math - OpenGL 矩阵 VS DirectX 矩阵

> ID：13318431
> 
> 赞同：5
> 
> 时间：2012-11-10T01:45:55.467
> 
> 标签：math, opengl, matrix, directx

我只处理过 DirectX 矩阵

我读过文章说您不能将 DirectX 矩阵数学库用于 openGL 矩阵。

但我也读过，如果你的数学是一致的，你可以获得类似的结果。这让我更加困惑。

任何人都可以启发我吗？或者如果您不能在 openGL 矩阵上使用 DirectX 数学。有谁知道一个好的openGL矩阵库？

任何有助于理解他们的差异和数学知识的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T01:53:00.800

> 我读过文章说您不能将 DirectX 矩阵数学库用于 openGL 矩阵。

这是错误的。

> 但我也读过，如果你的数学是一致的，你可以获得类似的结果。

唯一的区别在于 OpenGL 和 DirectX 对其标准化设备坐标空间的默认假设。他们使用略有不同的范围和标志。然而，这只转化为一个转换堆栈，上面预乘了一个额外的“适配器”矩阵，你就完成了。

索引排序也很重要，但是现代 OpenGL 允许您选择名称“转置”的 glUniformMatrix 的参数使用哪个顺序

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-10T06:52:56.137

我想通过更清楚地说明 OpenGL 的矩阵和 DirectX 的矩阵之间的主要感知差异是它们分别采用列主要格式和行主要格式来补充 datenwolf 的出色答案。（列优先和行优先是指您将如何以 4x4 格式写出它们。如果翻译出现在第四列，即列优先，反之亦然。）

数学家会告诉你，列优先是表示矩阵的正确方法，主要是因为它使对它们的操作在视觉上（在纸上）更容易。

[然而，对于 OpenGL，整个矩阵在内存中以 16 元素数组的形式连续布局，根据规范](http://www.opengl.org/archives/resources/faq/technical/transformations.htm)，平移占用了第 13、14 和 15 个元素。因此，很容易将数据调整为任一矩阵格式。

# ruby-on-rails - 绝对测试所有内容是一种好习惯还是浪费时间（Rails）？

> ID：13318432
> 
> 赞同：5
> 
> 时间：2012-11-10T01:46:09.897
> 
> 标签：ruby-on-rails, testing, rspec

我最近了解到，**Rspec + Capybara**（我是测试事物的新手）。我一直在测试我创建的一些新模型。现在，我正在考虑将`title`列添加到我的`Post`模型中。这不是一项艰巨的任务，而且我以前做过很多次。但我意识到更新规范文件（例如帖子、帖子页面、用户、用户页面、工厂、sample_data 等）需要我做一些工作。

在这种情况下进行测试是浪费时间吗？或者绝对测试所有内容是一个好习惯？

我还想知道测试宝石是否也是浪费时间？因为他们可能已经被他们的创建者测试过（测试来自可靠教程的东西也是如此）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T02:13:21.713

While the ruby community is known by its focus on testing, every case should be analyzed in context to figure out what the most cost-effective decisions are.

It is useful to think of tests as a technique to manage risk. If you don't think that displaying titles/adding them to the database is a task that is error-prone, complex to perform, or that the cost of adding those tests is higher than the risk of eventually breaking something, them it might be wise to not do it.

That said, since you said that you are new to testing, I would recommend (if you are not time-constrained, of course) to try to take the idea to the extreme of testing absolutely everything, so that you can have an idea of how much of it adds value, and how much is waste of time.

You might want to take a look at this blog post from DHH, the creator of Rails, where he talks about that: [Testing like the TSA](http://37signals.com/svn/posts/3159-testing-like-the-tsa)

About testing gems, it is generally well-accepted that they shouldn't be tested by your application tests, but by their creators. Most of the time you can simply assume that they work the ways they promise.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:21:48.770

测试的主要概念之一是：“不可能测试一切”

# jquery - SSL CORS 不适用于 Zend Guard

> ID：13318436
> 
> 赞同：0
> 
> 时间：2012-11-10T01:46:47.150
> 
> 标签：jquery, ajax, zend-framework, ssl, cors

我已将所有内容添加到我的 Apache htaccess 中：

```
标头集 Access-Control-Allow-Headers: X-Requested-With
标头集访问控制允许方法：选项
标头添加访问控制允许方法：GET
标头添加访问控制允许方法：POST
标头添加 Access-Control-Allow-Headers: Content-Type
标头添加访问控制允许标头：深度
标头添加 Access-Control-Allow-Headers: User-Agent
标头添加 Access-Control-Allow-Headers: X-File-Size
标头添加 Access-Control-Allow-Headers: X-Requested-With
标头添加 Access-Control-Allow-Headers: If-Modified-Since
标头添加 Access-Control-Allow-Headers: X-File-Name
标头添加 Access-Control-Allow-Headers: Cache-Control
标头集 Access-Control-Allow-Origin：http://mysite.com
标头添加 Access-Control-Allow-Origin：https://mysite.com
标头集 Access-Control-Allow-Credentials: true
```

我将此添加到我的 jquery $.ajax 中：

```
xhr字段：{
    withCredentials: 真
}
```

绝对没有任何作用。

我正在做 $.ajax

```
类型：'POST'，
数据类型：'json'
```

我想通过设置上面所有这些标题，我可以做 json 而不是 jsonp（请不要 jsonp。除了 jsonp 之外的任何东西。我无法成功触发。please.god.no）

我已经到了极限。我得到了很好的 ole

```
XMLHttpRequest 无法加载https://mysite.com/aDirectory/aSecureFile.php。Access-Control-Allow-Origin 不允许来源http://mysite.com 。
```

请帮忙。我要死在这里了。我保证我到处都看过，哦，我到处都看过。

提前谢谢了！

**明晰**

我的标题都遇到了。我可以在我的响应标题中看到它们，但我仍然收到上述错误。服务器阻塞了吗？浏览器？我有什么特别的事情要做才能做 https 吗？我必须在 Apache 上设置其他设置以允许 CORS 吗？我的 jQuery $.ajax 正确吗？除了数据、成功和错误（以及 URL 始终是 https）之外，这就是我对 jQuery $.ajax 所做的一切。

再次感谢！

**新的**

[跨域 AJAX 预检失败 Origin 检查](https://stackoverflow.com/questions/7423983/cross-domain-ajax-preflighting-failing-origin-check?rq=1)没有帮助（我不认为）。添加

```
标头集 Access-Control-Allow-Headers: ORIGINS
```

（调整集合和添加）。所有响应标头都来自管道。

**较新**

添加了这些

```
标头添加 Access-Control-Allow-Headers: Origin
标头添加 Access-Control-Allow-Headers: Accept
```

依然没有

**请求标头**

这些有帮助吗？

```
接受：应用程序/json，文本/javascript，*/*；q=0.01
内容类型：application/x-www-form-urlencoded；字符集=UTF-8
来源：http ://mysite.com
引用者： http: //mysite.com/ 
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11
```

**PHP**

```
header("访问控制允许来源：http://mysite.com");
header("Access-Control-Allow-Origin: https://mysite.com");
```

**响应标题清晰**

RESPONSE HEADERS 来自所有正常请求，而不是跨域 https ajax。

**服务器**

CentOS 5.8、Apache 2.2.2、PHP 5.3、cPanel、WHM

**很好，如果 PHP 没有执行**

所以，我匆忙中，直接复制了slashingweapon的cors.php，没有php标签。我使用上面的设置用 $.ajax 制作了一个测试页面。

它工作（因为在 ajax 触发时没有错误）完成了响应标头。一旦我将标签添加到 PHP 中，错误就发生了。我检查了它是否是目录问题，将它放在根目录和子目录中，只要 PHP 没有执行就可以了。

这对任何人都意味着什么？

是否有需要翻转的 PHP 设置？

感谢大家和我一起解决这个问题！

**我们有心跳**

看起来 htacess 中的多个参数使我的服务器崩溃。我将上面的所有选项都减少到了这个（这对我来说很好，但我很遗憾需要更多的傻瓜）：

`<IfModule mod_headers.c> <FilesMatch "\.(php)$"> Header set Access-Control-Allow-Origin: http://mysite.com Header add Access-Control-Allow-Methods: POST </FilesMatch> </IfModule>`

我在 PHP 中放的只是

```
回声“这至少有效”：
```

这就是回应。一旦我弄清楚是什么导致我的 PHP 失败，我会发布它。

再次感谢大家！

**Zend Guard 的问题？**

Sooooooooo，对不起，伙计们。忘记添加我的站点正在运行 Zend Guard。有一种导致它的感觉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T04:33:17.583

首先，您需要确保 mod_headers 已启用

```
a2enmod headers 
```

然后，作为测试，您可以在 .htaccess 文件中将原点设置为通配符

```
Header set Access-Control-Allow-Origin * 
```

我正在查看带有和不带有冒号 (:) 的文档，并且我现在没有可以测试的系统，因此您也可以使用它。

当然，启用标头后，您将需要退回 apache。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T17:30:36.620

当客户端尝试执行 CORS 请求时，它首先发送“预检”请求以确保服务器支持 CORS。如果预检请求通过，则将发送真正的请求。

您的服务器需要向 CORS 请求发送正确的响应。我有一个展示如何做到这一点的[CORS PHP gist。](https://gist.github.com/2202603)

# javascript - 如果http状态码是200还是301，如何告诉Javascript加载的脚本src？

> ID：13318438
> 
> 赞同：2
> 
> 时间：2012-11-10T01:46:58.230
> 
> 标签：javascript, ajax

我试图弄清楚是否有可能创建一个脚本来找出用户的 http 状态代码，例如对于像这样的脚本是 200 还是 301？必须是用户请求状态代码，而不是服务器如何获取它:)

```
 <script type="text/javascript"
         src="https://google.com"
 </script> 
```

可能吗？

编辑：我阅读和研究了更多可能使用 Ajax 请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T03:24:16.563

可悲的是，答案是否定的。
在跨浏览器、最终用户脚本（即：不使用自定义扩展/浏览器插件的脚本）中，对于 HTTP 响应标头值，您无法读取过去的文件请求。

如果您进行 AJAX 调用，您可以读取该特定请求的响应标头（而不是其他任何请求）。因此，理论上，如果您想知道服务器响应是什么，您可以针对与其属性
中使用的脚本请求完全相同的文件发出 AJAX 请求...`src`

但在这种情况下不是。

在这种情况下，除非您的域是 ，否则您`google.com`的浏览器会阻止您发出该请求（因为 AJAX 调用需要从与用户当前所在页面相同的域中进行）在较新的浏览器上可以通过一些方法来解决，但是即使在这些情况下，您也需要拥有`google.com`，以便您的服务器设置为允许来自 AJAX 的调用`mysite.com`

# css - 2个垂直css精灵图像，但结果不同

> ID：13318439
> 
> 赞同：1
> 
> 时间：2012-11-10T01:47:03.353
> 
> 标签：css, css-sprites

我使用 Instant Sprite 创建了新的精灵图像 sprite_main.png 并替换了由 SpritMe 创建的旧精灵图像 spriteme1.png。

我只是更改了图像路径并仅使用了给定的背景位置，但是 sprite_main.png 的结果令人失望。我不明白发生了什么，但那是因为我在精灵图像中添加了另外 20 多个图标吗？

[http://fiddle.jshell.net/6TaQt/40/](http://fiddle.jshell.net/6TaQt/40/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T05:07:55.173

背景位置结果与**sprite_main.png**令人失望，因为 sprite_main.png 的高度与（高于）spriteme1.png 的高度不同，并且两个图像之间的每个图标的位置不同。因此，您必须重新计算顶部背景位置。

这是我对 sprite_main.png 的修订背景位置：http: [//fiddle.jshell.net/Vrf7g/](http://fiddle.jshell.net/Vrf7g/)

# gnu-make - 如何编写基于 GNUMAKE 的测试工具

> ID：13318441
> 
> 赞同：0
> 
> 时间：2012-11-10T01:47:25.667
> 
> 标签：gnu-make

我不太擅长编写make文件。但是我需要编写一个基于 GNUMAKE 的测试工具。我做了一些研究，但我找不到任何有用的东西。所以我什至不知道从哪里开始。

```
TEST_SUITE_DIR:=testSuite

#Get all test names with path  & extention
TEST_SCRIPTS_WITH_PATH:=$(wildcard $(TEST_SUITE_DIR)/*.txt)

#Test name with out path and extention
TEST_SCRIPT_NAME:=$(notdir $(patsubst %.txt,%,$(TEST_SCRIPTS_WITH_PATH)))

vpath %.txt $(TEST_SUITE_DIR)

TEST_LOG_FILE:=$(TEST_SCRIPT_NAME)OutPutFile.txt

#This is the program ./bin/programName being tested
PUT:=man

#Test requrements:
#1) Each test in /testSuite dir should have its own logFile
#2) Each testout will be checked against a goldenout file in /goldenOutput dir to see
#   if the expected resuls match with the test output
#   #3) If the test & golden output file hasnt been modified, we do not want to run that test so
#   we can save time
#   #4) STDERR should be redirected to a stderr.log
#5) During the regression, if a test failed, test name should be written into the regressionReport.log

.PHONY: clean test

test:
        for i in $(TEST_SCRIPTS_WITH_PATH); do \
              echo $$i; \
              $(PUT) `head -n 1 $$i` > $$iOutPutFile.txt; \
        done

#$(foreach i, $(TEST_SCRIPTS_WITH_PATH), $(PUT) `head -n 1 $($i)` > $($i)OutPutFile.txt )
#$(PUT) `head -n 1 $(TEST_SCRIPTS) ` > $(TEST_SCRIPTS)logFile.log

clean:
        rm -f *.d $(OBJ_DIR)/*.o $(PROG)

-include *.d 
```

这是我的 dataFile.txt（目前，我只是想让 1 个命令正常工作），

```
date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:00:45.187

我不确定我是否理解你想要做什么，为什么你需要依赖于测试规则（特别是你把它弄假了）。

此外，如果你想测试文件的内容，你需要使用 diff 而不是测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T14:25:27.943

makefile 是一种自动执行某些任务的方法，因此在您知道如何在没有 Make 的情况下如何做之前，您无法使用 Make 做任何事情。

有不止一种方法可以做你想做的事（Make 的常见情况），你应该考虑你希望 makefile 如何扩展。构造该命令的最简单方法可能是：

```
man `head -n 1 dataFile.txt` > logFile.log 
```

所以这个makefile就足够了：

```
.PHONY: all

all:
    man `head -n 1 dataFile.txt` > logFile.log 
```

这方面的许多进展是可能的，但直到我们知道你打算在此之外做什么。

# html - 如何使用 css 选择器选择具有特定类的所有 li？

> ID：13318442
> 
> 赞同：0
> 
> 时间：2012-11-10T01:47:31.797
> 
> 标签：html, css, css-selectors

我有一个包含 2 个级别的无序列表，我想隐藏“第一级子菜单”并仅在“第一级”li 悬停时显示它们。

这里是代码：

```
<ul>
      <li>first level</li>
               <ul>
                  <li>first level submenuitem 1</li>
                  <li>first level submenuitem 2</li>
               </ul>
      <li>another list item</li>
</ul> 
```

我怎么能用纯 CSS 选择器做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:50:01.417

像这样的东西：

```
ul ul {display: none;}

ul li:hover ul {display: block;} 
```

如果您可能有两个以上的级别，那么您可能想要更具体，例如：

```
ul li > ul {display: none;}

ul li:hover > ul {display: block;} 
```

**[代码示例](http://jsfiddle.net/gssVQ/)**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-10T01:50:48.587

尝试这个，

```
ul li:first-child:hover ul li {
   display: block;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-10T01:56:40.193

我会使用 jQuery

```
<ul>
      <li class="show">first level</li>
           <ul class="child" style="display: none;">
              <li>first level submenuitem 1</li>
              <li>first level submenuitem 2</li>
           </ul>
  <li class="show">another list item</li>
</ul>

<script type="text/javascript" >
     $(".show").hover(function() {
     $(this).find('.child').show();

     });
</script> 
```

# hibernate - JPA @Version 未在数据库中创建

> ID：13318444
> 
> 赞同：2
> 
> 时间：2012-11-10T01:48:25.947
> 
> 标签：hibernate, jpa, version

当我使用 JPA 持久化实体时，我的版本列没有得到更新/设置。我正在使用休眠 jpa。版本是自动创建的还是我必须手动创建？

我有一个抽象基类

```
@MappedSuperclass 
public abstract  class AbstractDomainEO {

private Date createdDate;
@Version 
private Integer version;

public Integer getVersion() {
    return version;
}

public void setVersion(Integer version) {
    this.version = version;
} 
```

以及扩展抽象类的子实体类

```
@SuppressWarnings("serial")
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(discriminatorType = DiscriminatorType.STRING)
@DiscriminatorValue("GENERIC")
public class ArtData extends AbstractDomainEO  implements DomainObject { 
```

* * *

更新#2 .... 所以我决定采用另一个没有继承的简单类，只是为了让版本工作，但也没有运气。我的新课：

```
@Entity
@Table(name = "CAR")
public class CarEO implements Car {

private Date createdDate;

@Version 
private Integer version;

public Integer getVersion() {
    return version;
}
public void setVersion(Integer version) {
    this.version = version;
}

public void setCreatedDate(Date createdDate) {
    this.createdDate = createdDate;
}

@Temporal(TemporalType.TIMESTAMP)
public Date getCreatedDate() { 
    return this.createdDate; 
}

@Id
@GeneratedValue
@Column(name = "CAR_ID")
private Integer id;
private String name;
public CarEO() {
    super();
}

@Override
@GeneratedValue(strategy=GenerationType.SEQUENCE, generator="CAR_ID_SEQ")   
public Integer getId() {
    return this.id;
}

@Override
public void setId(Integer id) {
    this.id = id;
}

@Override
public String getName() {
    return this.name;
}

@Override
public void setName(String name) {
    this.name = name;
} 
```

但是我仍然为版本和 createDate 得到空值（但这是一个单独的问题）

**CarEO[createdDate=,version=0,id=3,name=bmw,comments=[]]**

这是我尝试创建时的输出，为此 EO 对象选择删除：

[org.hibernate.cache.StandardQueryCache]; 使用默认值。[DEBUG] org.hibernate.SQL:111 - 插入 CAR（CAR_ID、createdDate、name、version）值（null、?、?、?）

Hibernate：插入 CAR（CAR_ID、createdDate、name、version）值（null、?、?、?）

[INFO] CarDaoJPASpringTest:64 - ***** ** *** ** *** ** *** ****** [DEBUG] org.hibernate.SQL:111 - 选择 careo0_.CAR_ID 作为 CAR1_1_，careo0_.createdDate 作为 createdD2_1_，careo0_.name 作为 name1_ , careo0_.version 作为版本 1_ 来自 CAR careo0_

休眠：从CAR careo0_中选择careo0_.CAR_ID作为CAR1_1_，careo0_.createdDate作为createdD2_1_，careo0_.name作为name1_，careo0_.version作为version1_

**CarEO[createdDate=,version=0,id=3,name=bmw,comments=[]]** [DEBUG] org.hibernate.SQL:111 - 从 CAR 中删除 CAR_ID=? 和版本=？休眠：从 CAR 中删除 CAR_ID=? 和版本=？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T05:21:45.243

用起来很想念`MappedSuperClass`。`Mapped superclasses`不可查询，也不能用于`EntityManager`or`Query`操作。 `EntityManager`将在执行 DB 操作`Query`时`version`执行操作。现在，这是一个问题，因为您在. 为了避免这个问题，你必须放入或类。`EntityManager``ArtData``version``MappedSuperClass``version``Entity``POJO`

示例 1

```
@MappedSuperclass 
public abstract  class AbstractDomainEO {
    private Date createdDate;
}

@SuppressWarnings("serial")
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(discriminatorType = DiscriminatorType.STRING)
@DiscriminatorValue("GENERIC")
public class ArtData extends AbstractDomainEO  implements DomainObject {

    @Version 
    private Integer version;

    public Integer getVersion() {
        return version;
    }

    public void setVersion(Integer version) {
        this.version = version;
    }
} 
```

示例 2

```
@Entity
public abstract class Parent {
    @Version 
    private Integer version;

    public Integer getVersion() {
        return version;
    }

    public void setVersion(Integer version) {
        this.version = version;
    }
}

@MappedSuperclass 
public class AbstractDomainEO extends Parent {
    private Date createdDate;
}

@SuppressWarnings("serial")
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(discriminatorType = DiscriminatorType.STRING)
@DiscriminatorValue("GENERIC")
public class ArtData extends AbstractDomainEO  implements DomainObject {

} 
```

[参考资料](http://docs.oracle.com/javaee/5/tutorial/doc/bnbqa.html#bnbqn)`MappedSuperclass`。_

# asp.net-mvc - Kendo UI Grid - 内联编辑不更改为数据库

> ID：13318445
> 
> 赞同：1
> 
> 时间：2012-11-10T01:48:35.540
> 
> 标签：asp.net-mvc, razor, kendo-ui

我正在关注演示网格编辑内联它可以工作但不会更改为数据库，它只会更改填充我接下来要做的事情的列表

这里的代码

```
public static IList<Book> All()
    {
        IList<Book> result = (IList<Book>)HttpContext.Current.Session["Books"];

        if (result == null)
        {
            HttpContext.Current.Session["Books"] = result =
                (from book in new LibraryModel().Books
                 select new Book
                 {
                     PKiBookID=book.PKiBookID,
                     SBookName = book.SBookName,
                     SBookWriter= book.SBookWriter,
                     SDescription=book.SDescription,
                     BStatus=book.BStatus,
                     FKiBookType=book.FKiBookType

                 }).ToList();
        }

        return result;
    }
    public static Book One(Func<Book, bool> predicate)
    {
        return All().Where(predicate).FirstOrDefault();
    }
    public static void Insert(Book book)
    {
        //book.PKiBookID = All().OrderByDescending(p => p.PKiBookID).First().PKiBookID + 1;
        All().Insert(0,book);
    }
    public static void Update(Book book)
    {
        Book target = One(p => p.PKiBookID == book.PKiBookID);
        if (target != null)
        {
            target.SBookName = book.SBookName;
            target.SBookWriter = book.SBookWriter;
            target.SDescription = book.SDescription;
            target.BStatus = book.BStatus;
            target.BookType = new LibraryModel().BookTypes.Single(s => s.PKiBookTypeID == book.FKiBookType);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T07:05:38.550

这个例外是[众所周知](https://www.google.com/search?q=telerik%20mvc%20circular%20reference&aq=f&oq=telerik%20mvc%20circular%20reference&sugexp=chrome,mod=4&sourceid=chrome&ie=UTF-8)的，有很多帖子如何避免它。它也包含在[文档](http://docs.kendoui.com/documentation/getting-started/using-kendo-with/aspnet-mvc/helpers/grid/troubleshooting#a-circular-reference-was-detected-while-serializing-an-object-of-type)中。

# python - 如何将信号处理程序添加到用 Py3k/Python 编写的 shell？

> ID：13318447
> 
> 赞同：1
> 
> 时间：2012-11-10T01:49:18.200
> 
> 标签：python, shell, unix, python-3.x, signals

我正在编写一个外壳程序，但是我希望在用户点击即 control-C 或 control-Z 时有存根的信号处理程序。我的代码如下；正如我所调查的那样，我可以让它不在 control-Z 上停止，但仍然在 control-Z 上暂停。

最新发布的代码版本位于[http://JonathansCorner.com/cjsh/download.cgi](http://JonathansCorner.com/cjsh/download.cgi)。我正在处理的代码是：

```
def handle_signal(signal_number, frame):
    print ('''

CJSH does not support the traditional and rather archaic methods of job
control. This arises partly from implementation concerns and partly for reasons
practical concerns.

In ye olden dayes with the green glow of terminals, it was important to have a
sophisticated job handling in place so jobs could be stopped, suspended, put in
the foreground, and so on and so forth, and for that matter this feature is
still used despite the fact that it was essentially a consolation prize for not
having multiple windows.

Don't try to suspend, resume, background, foreground, etc.

There is a more excellent way.

Now we have not the consolation prize but the real thing: unless you're on a
netbook or smaller, you can open another window for another job. If you have no
more use for a job, close the window.

Just open another window, or maybe a tab.

''')

signal.signal(signal.SIGTSTP, handle_signl)
signal.signal(signal.SIGHUP, handle_signal)
signal.signal(signal.SIGINT, handle_signal)
signal.signal(signal.SIGQUIT, handle_signal)
signal.signal(signal.SIGABRT, handle_signal)
signal.signal(signal.SIGALRM, handle_signal)
signal.signal(signal.SIGTERM, handle_signal)

#signal.siginterrupt(signal.SIGTSTP, False)
#signal.siginterrupt(signal.SIGHUP, False)
#signal.siginterrupt(signal.SIGINT, False)
#signal.siginterrupt(signal.SIGQUIT, False)
#signal.siginterrupt(signal.SIGABRT, False)
#signal.siginterrupt(signal.SIGALRM, False)
#signal.siginterrupt(signal.SIGTERM, False) 
```

这里需要改变什么，我应该如何改变它以便调用 handle_signal() 然后事情继续滴答作响？

# api - 流中的自定义 Twitter 图片

> ID：13318448
> 
> 赞同：0
> 
> 时间：2012-11-10T01:49:20.797
> 
> 标签：api, twitter

有多种服务可让您将图片和视频插入 twitter 流。- instagram 和 youtube 是最先想到的两个。

问题是——我该怎么做？

如果我想要一个自定义图像，并且我想将它们链接回我的网站 - 我是否必须使用 /statuses/update_with_media.json 端点（将其添加到 pics.twitter.com）以及我自己的链接？意思是两个链接？

这些网站是如何做到的，或者它们是否得到 Twitter 的官方支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T20:18:44.463

在 Twitter.com 上玩“在线”游戏。只有少数服务允许这样做。

例如，如果是视频，请参阅 Twitter 网站上的这篇文章。

[https://support.twitter.com/groups/31-twitter-basics/topics/109-tweets-messages/articles/75603-how-to-post-videos-on-twitter](https://support.twitter.com/groups/31-twitter-basics/topics/109-tweets-messages/articles/75603-how-to-post-videos-on-twitter)

如果您想在 Twitter 本身上托管图片并将其链接到另一个地方，则需要两个链接。图片超链接将被转换，并且需要在其旁边添加另一个链接。

更多的：

[如何将图像添加到推文或推特如何决定要呈现的图像 URL](https://stackoverflow.com/questions/6931396/how-do-i-add-an-image-to-a-tweet-or-how-does-twitter-decide-which-image-urls-to/)

[是否有公共 API 或元数据与 Twitter 新媒体系统集成？](https://stackoverflow.com/questions/7172666/is-there-a-public-api-or-meta-data-to-integrate-with-twitter-new-media-system/)

（PS 伟大的 CI 文章，感谢您的所有帮助！:)

# puppet - 我应该和木偶一起走多远？

> ID：13318450
> 
> 赞同：5
> 
> 时间：2012-11-10T01:49:38.783
> 
> 标签：puppet

我想先说我是 puppet 的新手。我一直在使用它，`vagrant`并且开始对编写清单感到自在，但我可能缺乏可以回答我的问题的经验或直觉。

我试图掌握 puppet 的范围以及画线的位置。我对这如何应用于模块及其创建和使用特别感兴趣。

一个更具体的例子：`puppletlabs-nginx`模块。因此，假设我正在愉快地进行，为给定的服务器角色创建清单；说这是一个非常简单的静态文件网络服务器，我想使用`nginx`. 该模块显然会帮助我解决这个问题；有`try_files`支持之类的。我什至可以通过这个模块升级到反向代理。但是，如果事情变得更加棘手怎么办？如果我想以编程方式做一些我不能用模块做的事情怎么办？

好吧，也许简短的回答是我自己修复它，做一个拉请求，然后按照我快乐的方式去做。但这在哪里停止？社区木偶模块的目标是支持给定软件包的各个方面吗？这似乎无法控制。另一方面，这不是创建了一堆主要是烘焙的模块，完全从用例构建吗？

然后，有一个 Android UI 的类比：我认为大多数 XML UI 定义都有 setter 方法。在木偶中，如果感觉相似。您可以通过编程方式构建配置文件，或者通过填写 ERB 模板来创建它。换句话说，我觉得 puppet 中的配置文件的程序化创建和配置文件的模板化创建之间的界限是模糊的；我没有找到使用 Android 的最佳方法，所以我不知道使用 puppet 的方法是什么。

**那么，问题来了：**什么是理想的 puppet 模块？它应该更多地依赖模板吗？在清单上？它应该考虑所有配置方案吗？

从更偏僻的角度来看，我几乎想要一些更有主见的东西。Puppet 的强大之处似乎在于灵活性和抽象性，但现有的模块让人感觉不一致且不够充实。

谢谢阅读...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T05:03:47.887

感谢马克。在很短的时间内，我已经切换到与 Chef 一起玩，并且在我表达的许多担忧方面，这些模块似乎更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-16T22:40:23.177

这里的 PuppetLabs 解决方案是为每个功能使用不同类型的模块——组件、配置文件和角色。有关更多信息，请参阅演示[设计 Puppet：角色/配置文件模式](https://puppetlabs.com/presentations/designing-puppet-rolesprofiles-pattern)。

PuppetForge 提供的模块属于“组件”类型。他们的目的是尽可能灵活，同时专注于单一的逻辑软件——例如，apache httpd 服务器或 apache tomcat，但不能两者兼而有之。

您可能编写的用于包装其中一个组件模块的模块类型将是“配置文件”模块的完美示例。这可以将 apache httpd 与 tomcat 和 jboss 以及其他一些组件（如 mysql 和 php）联系在一起。但它是一个逻辑堆栈，包含多个组件。或者也许你有一个 LAMP Profile 模块和一个单独的 tomcat+jboss Profile 模块。

下一个级别是“角色”模块。除了指向相应配置文件模块的“包含”语句之外，它们中不应包含任何内容。

有关更多详细信息，请参阅 PuppetLabs 演示文稿，但此逻辑与在 Chef 世界中看到的“包装食谱”非常相似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-12T10:20:12.650

简而言之，我可以向您解释有关木偶的信息。

Puppet 只不过是一个 IT 自动化工具，我们可以通过在 master 上创建清单（配方或脚本）来在其他机器上安装软件，以便将这些软件安装在目标机器上。这里 master 表示软件的 puppet manifest 的实现。目标机器指示要安装软件的代理。

Puppet 模块由以下结构组成，我们在 master 中执行此操作。

master中进入modules目录的路径是/etc/puppet/modules，前面提到了puppletlabs-nginx module.所以现在我们可以以这个module为例。

在modules目录之后，我们必须创建文件和manifest目录。此外，在manifests目录中我们将创建.pp文件。例如，install.pp，uninstall.pp。这就是模块结构。我们通常使用运行这些脚本包，服务，文件，exec等资源很少。

模板在 puppet manifest 中的作用很小，只是为了硬核价值观。它不是 puppet 的主要部分。manifests 在 puppet 中非常重要。

为了使用 puppet 自动化任何软件，我们可以遵循上述结构。

谢谢你。

# php - 日期和今天之间的 PHP 差异（显示周）

> ID：13318459
> 
> 赞同：0
> 
> 时间：2012-11-10T01:50:49.370
> 
> 标签：php, strtotime

好的，这是我的问题。我不想以秒为单位测量 7 天，而是想计算从日期 #1 到今天有多少周（周日到周六）。

PHP

```
$today1 = date("Y-m-d");  

$diff = strtotime($date1,0) - strtotime($today1,0);
echo (floor($diff / 604800)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:17:00.890

使用秒很好，也许尝试这样的事情：

```
$date1  = "2012-12-25";
$today1 = time();

$diff = strtotime($date1) - $today1;
if($diff < 604800) {
  $week = "this week";
} else {
  $week = (floor($diff / 604800) == 1) 
    ? floor($diff / 604800) . " week away" : floor($diff / 604800) . " weeks away";
}

echo $week; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:05:51.350

如果您以秒为单位计算，为什么在可以使用 time() 时使用 date() - 它给出了当前时间的数字时间签名，使这样的计算更容易。

# clojure - 从 REPL 切换到特定的 clojure 版本

> ID：13318461
> 
> 赞同：1
> 
> 时间：2012-11-10T01:50:56.657
> 
> 标签：clojure, read-eval-print-loop

我有两个应用程序`app1.jar`和`app2.jar`，其中包含 Clojure 1.2`app1`和包含 Clojure 1.4 的`app2`.

当我运行时：

```
java -cp app1.jar:app2.jar clojure.main 
```

要打开 REPL，它使用 Clojure 1.2。有没有办法切换到 Clojure 1.4？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:55:40.840

与许多此类问题一样，分析器**[使用 leiningen](https://github.com/technomancy/leiningen)** lein2 具有[配置文件功能](https://github.com/technomancy/leiningen/blob/master/doc/PROFILES.md)，可让您正确处理多个版本的 clojure。这特别有用，因为这两个版本之间的 clojure.contrib 库非常不同。输入这句话比安装、配置和使用 leiningen 开始一个项目花费了我更长的时间。这真的很值得。

在实践中，您将需要运行两个 clojure 实例，每个配置文件（版本）一个，然后您可以有两个 REPL（每个附加一个）或一个 repl（使用 nrepl）来回切换。

不幸的是，在大规模采用 Leiningen 之前，网上有大量关于 Clojure 的旧文档。

# php - 根据用户位置的天气显示不同风格的最佳解决方案是什么？

> ID：13318462
> 
> 赞同：0
> 
> 时间：2012-11-10T01:50:58.340
> 
> 标签：php, javascript, facebook, html, facebook-graph-api

我正在为一位经营园艺服务并提供杂工服务的朋友开发网站和 Facebook 应用程序，并希望得到以下帮助；

我不仅想在我的 Facebook 应用程序上执行此操作，该应用程序与网站本身非常相似，只是与 Facebook 集成了一点，发布到墙上等等，但在主网站上也是如此。我提到这一点的原因是，您可能知道也可能不知道，在 Facebook 上拥有应用程序的一种方法是告诉 Facebook 目录在哪里，并且病房目录中的任何内容都显示在 iframe 中。

随着 Facebook 进入我选择的目录并通过 iframe 在 Facebook 上显示它，好吧，我不完全知道发生了什么，如果它们在我的网站以及 Facebook 或其他什么上，并且由于对喜欢的人来说还很新PHP，如果这个问题看起来有点混乱，我深表歉意，但我希望我能解释一下自己。

有人告诉我，最好的选择是使用 HTML5 地理定位作为我的主要方法，并回退到更好的 IP 地理定位器是找出他们位置的最佳选择，然后我想通过气象局网站查看他们当前的天气（[http://www.metoffice.gov.uk/datapoint/product/uk-3hourly-site-specific-forecast/detailed-documentation](http://www.metoffice.gov.uk/datapoint/product/uk-3hourly-site-specific-forecast/detailed-documentation)）然后知道应该使用什么样式表。

正在为大多数情况开发不同的样式表，例如：阵雨、大雨、阴天、晴天、下雪等等，直到它们都被开发出来为用户定制体验，并根据他们的天气显示不同的 div 并显示他们的预测。一个 div 的例子可能是：如果下雪了，它会询问他们是否想要犁雪。

最后，我之前也应该问过和提到的事情，我还希望这个功能适用于英国用户以避免任何混淆，以及是否有可能看到用户离他们所在的地方有多远，因为他只告诉过我他会做 100 英里的半径范围，如果这能帮助他支付账单等等，他会去那里，但是有没有办法检查他们离联系表格有多远，或者在屏幕上显示什么的.

概括：

> 根据他们所在位置的天气显示不同的图形，并查看他们离基地的距离，并显示他们的天气预报，如果可能的话，在 3 小时更新时更改天气。通知非英国用户，这是一家仅限英国的企业，去那里会花费太多。

最好的问候，蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T08:56:33.873

您可以通过使用访问者的IP地址，然后追踪用户的位置来实现。找到位置后，使用任何天气报告服务器（如谷歌）来获取该位置的天气。使用提供者返回的值，您可以使用服务器端脚本来更改页面的布局或内容。

这可能很麻烦，并且由于联系和等待天气报告提供者的响应花费的时间延长，可能会减少页面加载时间。

PS：预期的建议和改进。

# c# - 从 Visual Studio 2012 迁移到 vs 2010 后出现实体框架错误

> ID：13318464
> 
> 赞同：0
> 
> 时间：2012-11-10T01:51:27.783
> 
> 标签：c#, visual-studio-2010, frameworks, entity

我使用带有实体框架的 vs2012 创建了一个项目。3 个月的试用期结束了，我要回到 2010 年。当我尝试运行我的项目时，我收到了这个错误。

在我的 gac 中，我看到 system.data.entity v3.5.30729.5420

这似乎与这篇文章有关，但不完全是： [任何人都可以发现为什么我在测试 EF 5 beta 时不断收到此错误](https://stackoverflow.com/questions/9591929/can-anyone-spot-why-i-keep-getting-this-error-testing-the-ef-5-beta)

我卸载并重新安装了nuget包方法未找到：'Void System.Data.Objects.ObjectContextOptions.set_UseConsistentNullReferenceBehavior（Boolean）'。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T06:33:41.337

我尝试删除和阅读几次，但没有成功。我终于用新名字开始了一个新项目并重新制作了我的课程。

# php - 服务器加载包含所有内容的页面需要多长时间

> ID：13318466
> 
> 赞同：1
> 
> 时间：2012-11-10T01:51:42.463
> 
> 标签：php, load-time

我需要知道用浏览器加载的所有必要的 css 和 js 文件加载我的网站需要多长时间。有没有一种简单的方法可以做到这一点，或者我需要分别 file_get_content ？

这些计算需要在 PHP 中而不是在客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:58:35.467

您可以使用窗口 onload 事件，或者如果您使用 jQuery，您可以使用 ready 函数将 AJAX 请求发送回您的服务器，让您知道页面何时完全加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:02:13.700

我想您想知道的是您选择的特定网页的总页面加载时间。您可以使用浏览器提供的工具，`google chrome`例如[http://tools.pingdom.com/fpt/](http://tools.pingdom.com/fpt/)

请注意，结果可能会略有不同。希望这可以帮助

# php - 复选框值未获取 -> 注意：未定义索引：第 27 行 C:\wamp\www\crud_exer1\content.php 中的 name1

> ID：13318468
> 
> 赞同：1
> 
> 时间：2012-11-10T01:51:57.563
> 
> 标签：php, post, checkbox

我正在尝试使用复选框进行多次删除。但作为测试，我试图获取前两个复选框的值，但它不起作用。我做了：

```
<td> <input type="checkbox"  name=" <?php echo $name[$pos]; ?> " value="<?php echo $row["id"]; ?>" /> </td> 
```

要在页面加载时首先显示记录，然后在顶部显示记录，我执行以下操作来打印前 2 个复选框的名称以及打印第一个复选框的值：

```
elseif(isset($_POST["delete"])){
        echo $name[0];
        echo $name[1];
        $value_of_box =  $_POST["$name[0]"];
        echo $value_of_box;
    } 
```

但只有复选框的名称被识别，因为它打印

> 名称 1 名称 2

但我收到了这个错误：“

> 注意：未定义索引：第 27 行 C:\wamp\www\crud_exer1\content.php 中的 name1

“在打印复选框的值时..我认为如果它识别出框的名称，它也应该识别出值，对吧？这有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T11:14:49.107

Now I get it! Must use same name for the checkboxes like:

> checkbox_name[]

rather than using an array there .. ^_^

# css - 伪选择器

> ID：13318470
> 
> 赞同：0
> 
> 时间：2012-11-10T01:52:04.963
> 
> 标签：css, css-selectors

是否有伪选择器或方法来检测`<section>`带有 id 的标签。即`<section id="no_display">`？

我有一个标题，它的底部边距为 35px。但是，我不想在一页上应用下边距，但我想在所有其他页面上应用它。

有没有一种方法可以检测 id 并且不应用边距？

```
<header>
    //stuff here
</header>
<section id="no_display">
    //other stuff here
</section> 
```

因此，如果`<header>`紧随其后的是`section id="no_display"`，则不要应用底部边距

希望这是有道理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T01:55:48.423

您可以使用负边距`section`来补偿`margin-bottom`其先前的兄弟元素：

```
#no_display {
    margin-top: -35px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T01:56:56.887

您通常不使用[伪类](http://www.w3.org/TR/selectors/#pseudo-classes)来表达两个或多个元素之间的关系；你使用[组合器](http://www.w3.org/TR/selectors/#selector-syntax)。在这种情况下，您需要一个前同级组合器。不幸的是，[那不存在](https://stackoverflow.com/questions/1817792/css-previous-sibling-selector)。

确实存在的是跟随兄弟组合器。由于您真的只希望边距在`section`没有该 ID 的情况下存在，因此您可以将底部边距打开`header`为顶部边距 on `section`，并在它确实具有 ID 时使用覆盖规则以从中删除边距：

```
header + section {
    margin-top: 35px;
}

header + section#no_display {
    margin-top: 0;
} 
```

（你真的不需要像这样的选择器，`header + section#no_display`因为 ID 本身就足够具体了，但这样做有助于我一眼看出第二条规则与第一条规则相关。）

# ruby - 如果我使用 DataMapper 的“has n”和“belongs_to”方法，为什么我的一个表没有被填充？

> ID：13318474
> 
> 赞同：0
> 
> 时间：2012-11-10T01:53:20.500
> 
> 标签：ruby, sqlite, associations, datamapper, belongs-to

我现在正在处理 sqlite3 上的 DataMapper。我必须定义创建两个表的模型：“公司”和“应用程序”。

每个应用程序都属于一家公司，每个公司都有许多应用程序。我想在我的模型中表示这种关系，但是我向每个类添加了“has n”和“belongs_to”方法，当在一堆应用程序上调用#create 时，App 类停止工作，它们没有插入到数据库中。

如果我没有关联方法，那么一切正常。

这是我的 DataMapper 代码：

```
DataMapper::setup(:default, "sqlite3://#{Dir.pwd}/app.db")

class Company
    include DataMapper::Resource

    property :id, Serial
    property :company_name,
    property :company_id, Text, :unique => true

    has n, :apps
end

class App
    include DataMapper::Resource

    property :id, Serial
    property :app_id, Integer
    property :bundle_id, Text
    property :game_name, Text
    property :company_name, Text
    property :created_at, DateTime
    property :rank, Integer

    belongs_to :company
end

DataMapper.finalize.auto_upgrade!

puts 'Database and tables created' 
```

这是我用来填充表格的代码

```
companies_in_chart.each do |company|
    @add_company = Company.create(
        :company_name   => company["company_name"],
        :company_id     => company["company_id"]
    )
end
puts "Inserted companies into database"

apps_arr.each do |app|
    @new_app = App.create(
        :app_id         => app["app_id"],
        :bundle_id      => app["bundle_id"],
        :game_name      => app["game_name"],
        :company_name   => app["company_name"],
        :created_at     => app["DateTime"],
        :rank           => app["rank"]
    )
end
puts "Inserted apps into database" 
```

**编辑：新代码**

```
#Set up database and apps table
DataMapper::setup(:default, "sqlite3://#{Dir.pwd}/app.db")

class Company
    include DataMapper::Resource

    property :id, Serial
    property :company_name, Text,    :required => true, :lazy => false
    property :company_id, Text,      :required => true, :lazy => false, :unique => true

    has n, :apps
end

class App
    include DataMapper::Resource

    property :id, Serial
    property :app_id, Integer,      :required => true
    property :bundle_id, Text,      :required => true, :lazy => false
    property :game_name, Text,      :required => true, :lazy => false
    property :company_id, Text,     :required => true, :lazy => false
    property :created_at, DateTime
    property :rank, Integer

    belongs_to :company
end

DataMapper.finalize.auto_upgrade!

puts 'Database and tables created'

#Insert apps and companies into database
apps_arr.each do |app|

    # Creates a new company based on app entry if the company does
    # not exist in the companies table
    @add_company = Company.create(
        :company_name   => app["company_name"],
        :company_id     => app["company_id"]
    )

    @add_app = App.create(
        :app_id         => app["app_id"],
        :bundle_id      => app["bundle_id"],
        :game_name      => app["game_name"],
        :company_id     => app["company_id"],
        :created_at     => app["DateTime"],
        :rank           => app["rank"]
    )
end
puts "Inserted app and companies into database"

@company = Company.first
ap @company # => #<Company @id=1 @company_name="Rovio Entertainment Ltd" @company_id="rovio">

ap @company.apps # => [] --I was hoping it would return all of Rovio's apps in the database 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T03:22:04.933

未创建应用程序，因为您必须在创建应用程序时附加公司。

如果您想添加不附属于任何公司的应用程序，请在您的应用程序模型中使用它：

```
belongs_to :company, :required => false 
```

创建应用程序时附加公司：

```
#Insert apps and companies into database

apps_arr.each do |app|

  # Creates a new company based on app entry if the company does
  # not exist in the companies table

  company = Company.first_or_create(
    :company_name   => app["company_name"],
    :company_id     => app["company_id"]
  )

  app = App.first_or_create(
    :company        => company, # you missed this
    :app_id         => app["app_id"],
    :bundle_id      => app["bundle_id"],
    :game_name      => app["game_name"],
    :company_id     => app["company_id"],
    :created_at     => app["DateTime"],
    :rank           => app["rank"]
  )
end
puts "Inserted app and companies into database" 
```

我成功地在 CIBox 上复制了您的代码，并且运行良好。

## 在此处查看[代码和现场演示](http://cibox.org/slivu/stackoverflow?path=why-is-one-of-my-tables-not-being-populated-if-i-use-datamappers-has-n-and-b&lang=ruby&file=app.rb&run=true)

如您所见，它创建了一个公司并将其附加到创建的应用程序。

`Company.first.apps`返回创建的应用程序，因此关联正常工作。

# google-eclipse-plugin - “新 Web 应用程序”-> 项目方面 wst.jsdt.web 尚未定义。它用于插件 org.eclipse.jst.server.core

> ID：13318475
> 
> 赞同：1
> 
> 时间：2012-11-10T01:53:23.710
> 
> 标签：google-eclipse-plugin

重新 Eclipse Juno 构建 ID：20120920-0800，OS X 10.7.5

插件命令“新建 Web 应用程序”会创建一个骨架，并在 Package Explorer 窗口中指示错误。错误记录的错误是

> 项目方面 wst.jsdt.web 尚未定义。它用于插件 org.eclipse.jst.server.core。

^ 这是什么意思，我该如何解决？

该插件是昨天安装的，应该是最新的。

启动项目应用程序似乎可以运行，但我想在开始构建真正的应用程序之前解决这个问题。

仅供参考，这是一个完全未经修改的 Eclipse + 插件安装，但有一个例外。我将项目“编译器合规性级别”设置为 1.6。该插件创建了 1.4 级的项目，这产生了许多编译器错误。

谢谢

# cocoa - 使用沙盒时 Core Audio 似乎不起作用

> ID：13318480
> 
> 赞同：1
> 
> 时间：2012-11-10T01:53:51.003
> 
> 标签：cocoa, core-audio, sandbox

我刚刚在我的 OS X 应用程序中启用了沙盒，现在我的核心音频代码不起作用。特别是，当我调用时`AUGraphAddNode`，它返回错误`invalidComponentID`，只是说“操作无法完成”。不过，在此之前，许多其他 Core Audio 调用似乎都可以正常工作。

这似乎不是直接的沙盒违规，因为控制台中没有来自沙盒的任何消息，但是当我关闭沙盒时它肯定会起作用。有谁知道为什么会发生这种情况？我唯一能想象的是，它可能正在尝试读取我无权访问的文件，尽管我认为这会给我一个沙盒错误。

更新：

为了澄清，我尝试启用每个沙盒权利，但问题仍然存在。

我也稍微缩小了这个问题的范围。仅当我尝试添加具有组件类型`kAudioUnitType_MusicDevice`和子类型的节点时，该调用才会失败`kAudioUnitSubType_DLSSynth`。

更新 2：

我想出了一个hacky的解决方法。如果我添加一个临时异常权利以启用对用户整个主目录的读写访问，则该错误不再发生。这显然不理想，所以我继续寻找更好的选择。我试图通过为更具体的子目录添加权利来缩小所需的访问范围，但这没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T01:10:05.423

我最近将遇到此问题的应用程序提交给了应用程序商店，但由于使用了我的问题的最后更新中提到的临时例外权利而被拒绝。我被指出[这篇文章](http://developer.apple.com/library/ios/#technotes/tn2247/_index.html)正在讨论这个确切的问题。

事实证明，不幸的是，标准沙盒文档中没有记录另一种权利：`com.apple.security.temporary-exception.audio-unit-host`. 如果用户在运行时授予权限，这将允许音频单元（如 DLSSynth）在主机环境中运行，它需要的权限大于主机环境的沙盒允许的权限。

鉴于此权利也被归类为临时例外，我不确定此解决方案的长期性，但根据 Apple 的说法，这是目前要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T21:11:34.953

如果您使用 Core Audio 进行麦克风输入，请不要忘记将其添加到 Target Summary 和应用程序权利文件中的沙盒权利中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-15T13:35:35.240

此错误可能发生在已沙盒化的音频单元主机应用程序中。

在 Xcode 11 上，您可以通过从 Signing & Capabilities 选项卡中删除沙盒来关闭它：

[![在此处输入图像描述](../Images/dd0196fe3761a3885639dc19f3fa08b8.png)](https://i.stack.imgur.com/iTRFC.png)

# ruby-on-rails - 添加四方场地以及实例 gmaps4rails 的位置

> ID：13318482
> 
> 赞同：0
> 
> 时间：2012-11-10T01:54:02.137
> 
> 标签：ruby-on-rails, gmaps4rails

我有一个应用程序，它的位置模型由用户输入的地址进行地理编码，现在我显示给定位置实例中地理编码的地址的谷歌地图，现在我要做的是显示四方场地及其图标显示位置实例的地图，我怎么能做到这一点，我已经在列表中获得了附近的场地，我如何在地图中显示它们的图标。

这是显示视图和控制器，我想在其中查看带有位置实例的地图以及附近的四方场地......

```
 def show
    @location = Location.find(params[:id])
    @json = Location.where('slug = ?', params[:id]).to_gmaps4rails
  end 
```

风景：

```
<% provide(:title, @location.name) %>
<% if !@location.active? %>
  <%= content_tag(:div, "Location currently deactivated!", class: "alert") %>
<% end %>
<div class="row-fluid">
  <aside class="span4" >
    <section>
      <h1>
        <%= @location.name %>
      </h1>
      <%= gmaps({
        "map_options" => { "auto_zoom" => false, "zoom" => 17 },
        "markers"     => { "data" => @json }
      }) %>        
    </section>
  </aside>
</div> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:11:29.023

好吧，很难猜出你的场地是什么样子，但我可以给你我怀疑可以工作的东西。

假设：

*   `to_gmaps4rails`吐出 JSON

*   场地至少有纬度、经度。也许是图片。

您的目标：将场地中的 json 添加到位置中的 json。

一首曲目：

```
locations_array_of_hashes = JSON.parse(@json)
venues_array_of_hashes = #do what is necessary to build an array containing hashes like { lat: , lng: , marker_picture: }

global_array_of_hashes = locations_array_of_hashes.concat venues_array_of_hashes
@global_json = global_array_of_hashes.to_json 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T12:06:08.457

[foursquare2 gem](https://github.com/mattmueller/foursquare2)可能对您有用。

# java - 需要 Base85 (Ascii85) 编码器的帮助

> ID：13318483
> 
> 赞同：3
> 
> 时间：2012-11-10T01:54:05.083
> 
> 标签：java, math, base85

## Base85 ASCII 编码器/解码器

在这里寻找初始参考 ->> [Base85 维基百科页面](http://en.wikipedia.org/wiki/Ascii85)

我正在为 java 制作 Base85 编码器/解码器，我不希望从完整的编码器中获得我的编程或代码的答案或解决方案。我可以从我的代码中提供源代码，但这是不必要的，因为这个问题更适合理解这个概念。我在我的代码中成功地包含了该维基百科页面上概述的所有步骤，直到 32 位值点，其中以 10 为底的 32 位的总值转换为 base85。

看这里 ->> [Base85 编码表](http://i.stack.imgur.com/cEp4i.png)

所以，具体来说，我已经成功获得了 1298230816 的号码 - 但现在我很难过。如上所示，如何获得以 85 为底的数字？（**24** *85^4；**73** *85^3；**80** *85^2；**78** *85；**61**）。我将通过什么数学过程来找到这些值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T02:04:58.460

目前尚不完全清楚您要问什么，但我猜您想知道如何*计算* .`a, b, c, d, e``N = a * 85^4 + b * 85^3 + c * 85^2 + d * 85 + e`

答案是：

1.  取N余`85`给你`e`。
2.  将 N 除以`85`。
3.  重复`d`，`c`依此类推。

# javascript - 在没有重叠节点的情况下在节点之间绘制连接的算法

> ID：13318489
> 
> 赞同：1
> 
> 时间：2012-11-10T01:54:48.940
> 
> 标签：javascript, algorithm, graph

我在图中有一系列节点。节点由用户放置在特定位置。保证节点不重叠，事实上，它们之间有一个空间缓冲区。这些节点相互连接，每条边在特定点连接到一个节点。我需要在节点之间绘制边缘，使得边缘：

*   （必填）不与父节点重叠
*   （理想情况下）不会与任何节点重叠

我不担心边缘交叉。如果在 Javascript 中实现了这一点，则可以加分。我无法使用 Javascript 之外的任何库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T12:58:25.687

如果您熟悉 C# 和 .NET，您可以通过 ILSpy 探索 Microsoft.GLEE 库（说明在[此处](http://research.microsoft.com/en-us/downloads/f1303e46-965f-401a-87c3-34e1331d32c5/default.aspx)和[此处](http://research.microsoft.com/pubs/64284/gd2007-glee.pdf)），甚至理论上将此源保存到 .csproj，使用[Script#](http://scriptsharp.com/)修改并重新编译为 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T16:32:41.237

一种解决方案可能是使用[**Bézier Curves**](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)：

> “贝塞尔曲线由一组控制点 P0 到 Pn 定义，其中 n 称为其阶数（n = 1 表示线性，2 表示二次等）。 第一个和最后一个控制点始终是曲线的**端点**曲线；但是，**中间控制点（如果有）通常不在曲线上**。”

所以基本思想是使用父节点作为中间控制点。您也可以使用边缘的点作为中间控制点，以避免边缘重叠。

在 wiki 文章中，您可以找到很好的[动画](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Constructing_B.C3.A9zier_curves)来解释它。

对于**javascript 实现**，我查看了以下库：

*   [jsdraw2d](http://jsdraw2d.jsfiction.com/)（LGPL 许可证）带有一个[很好的演示](http://jsdraw2d.jsfiction.com/demo/curvesbezier.htm)和很好的参考。还使用*HTML5 和 SVG*来实现它以提高性能（[jsdraw2dX](http://jsdraw2dx.jsfiction.com/)）。
*   谷歌代码上的[jsbezier](http://code.google.com/p/jsbezier/)

但是如果你用谷歌搜索*“javascript bezier library”*，你可以找到更多。

# c++ - c++ 类函数别名

> ID：13318491
> 
> 赞同：14
> 
> 时间：2012-11-10T01:55:05.520
> 
> 标签：c++, class, function, alias

我想知道是否有一种简单的方法来编写 c++ 类函数的别名。例如，如果我有一些`list`容器对象，一个逻辑函数将是

```
 int list::length() { return len; } 
```

但是程序员可能使用的另一个逻辑别名可能是

```
 int list::size() { return len; } 
```

那么，不是用它们的完整体编写两个函数，有没有办法制作`list::size()`一个别名`list::length()`，使它在编译时不是重复的，而是引用同一个函数？

我已经读到您可以使用 来执行此操作`#define`，但我不想在完全超出范围的某个地方（即“大小”变量）引起与其他代号的任何混淆。
我还读过函数指针可以修复它，但这并不完全是别名（因为它必须应用取消引用），也不能给函数指针声明，给用户提供令人困惑的帮助热线（我想），如果我需要将我的代码嵌套在另一个对象中（我必须调整范围），就会感到困惑。

我的一个猜测是，大多数优化编译器会将以下内容作为直接函数别名：

```
 inline int list::length() { return len; }
    inline int list::size() { return length(); } 
```

或者，C++ 是否有任何严格的“别名”语法？（我找不到任何 - 不确定）
那么，最有效的方法是什么？

**编辑：**我接受答案只是为了结束这个问题，因为这只是我的好奇心。*任何有好的信息的人，请添加评论或回答，*我什至可能会更改我的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T02:19:45.360

我不会使用预处理器和#define 来执行此操作。一般来说，预处理器应该是 C++ 中的最后手段。请参阅[有关内联函数的 C++ 常见问题解答，](http://www.parashift.com/c++-faq/inline-functions.html)其中还包含有关使用预处理器宏的各种弊端的部分。

我将使用的方法是拥有一个具有多个不同别名的函数，该函数具有更复杂的函数和接口，您可以执行以下操作：

```
int list::length(string xString, int iValue) {
  int iReturnValue = 0;  // init the return value
  //  do stuff with xString and iValue and other things
  return iReturnValue;
} 
```

然后对别名执行以下操作。

```
inline int list::size(string xString, int iValue) {return length(xString, iValue);} 
```

内联基本上应该用实际的函数调用替换别名。

另请参阅此[堆栈溢出帖子为函数实现提供多个名称](https://stackoverflow.com/questions/4178028/giving-a-function-implementation-more-than-one-name-in-c?rq=1)。它提供了一些您可能不想这样做的原因。

# macos - 在 Cocoa 应用程序中将静态项添加到“Windows”菜单

> ID：13318496
> 
> 赞同：4
> 
> 时间：2012-11-10T01:56:04.770
> 
> 标签：macos, cocoa, nswindow, nsmenuitem, nsmenu

我有一个有 2 个窗口的应用程序（想想 Twitter 时间线和提及）。现在我一直在“文件”菜单中有“时间线⌘1”和“提及⌘2”菜单，但这是错误的。所以我只是通过拖放将它们移动到“Windows”菜单。

当我打开应用程序时，一切都很好，我可以在“Windows”菜单下看到两个菜单项。但是当我关闭例如“提及”窗口时，菜单项“提及⌘2”消失了，我无法再打开这个窗口了。

我看过其他应用程序，它们中的大多数都有它们的菜单项来在“Windows”菜单中显示窗口，并且在关闭窗口后它们也不会消失。我知道 Cocoa 用“Window”菜单项做 soma 魔法，这样做很好（因为我打开了一些需要从那里出现和消失的其他窗口），但是我怎样才能让这两个物品是静态的，所以它们不会消失？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-15T23:44:13.713

我终于找到了答案，为了让它们不被你需要调用的 Windows 菜单处理

```
[timelineViewWindow setExcludedFromWindowsMenu:YES];
[mentionsViewWindow setExcludedFromWindowsMenu:YES]; 
```

然后将菜单项添加到 Windows 菜单中，它们将不再消失。

# arrays - mongoDB：按嵌入值查找

> ID：13318499
> 
> 赞同：2
> 
> 时间：2012-11-10T01:56:31.860
> 
> 标签：arrays, mongodb

我对 mongoDB 有一些问题，我正在寻找答案，但我找不到任何可以解决我的问题的东西......

```
db.coders.save( {
'name': 'John', 
'languages' : { 'php':'bad','java':'good','brainfuck':'very bad'} 
});

db.coders.save( {
'name': 'Sarah', 
'languages' : { 'php':'good','java':'bad','brainfuck':'very bad'} 
});

db.coders.save( {
'name': 'Tom', 
'languages' : { 'php':'very good','java':'good','brainfuck':'bad'} 
}); 
```

现在我想找到任何懂任何语言“非常好”的编码器......如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T02:37:36.890

你找不到它，因为它是不可能的。没有任何搜索运算符适用于您提供的架构。

最简单的解决方法是稍微更改架构：

```
db.coders.save( {
'name': 'John', 
'languages' : [ { n: 'php', v: 'bad'},{n:'java', v: 'good'},{n : 'brainfuck', v: 'very bad'}] 
}); 
```

在这种情况下，您可以使用以下查询来查询数据：

```
db.coders.find({'languages.v' : 'good'}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T06:18:40.413

我同意萨尔瓦多的观点，即改变架构更好。

但我发现您可以使用 $where 运算符进行搜索。

```
db.coders.find({ $where : function() { for(lang in this.languages) { if (this.languages[lang] == 'very good') { return true; }  } return false;  }}); 
```

正如文档中指出的那样，它可能有点慢。

[http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-JavascriptExpressionsand%7B%7B%24where%7D%7D](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-JavascriptExpressionsand%7B%7B%24where%7D%7D)

# python - Python 列表。查找所有元素不为零的最大行

> ID：13318504
> 
> 赞同：0
> 
> 时间：2012-11-10T01:56:51.837
> 
> 标签：python, list, numpy, max

我有一个看起来有点像这样的 python 列表：

```
[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,90,1,9999,0,0,0,0,0,0,0,00,0],
[0,0,0,0,0,0,0,0,0,0,0,0,00,0],[0,0,90,1,9999,1,2,0,0,9999,0,0,00,0].....till about 30 rows] 
```

我需要从该列表中找到具有 9999 的最大行，或者换句话说，它的所有元素都不为零。请帮我解决一下这个。谢谢！！

我试过了：

```
print max((numpy.where(v1==9999)[0])) 
```

但这只是给了我一些奇怪的错误，比如`'int' object not iterable`或`numpy.where does not accept keywords n`等等！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T02:00:50.967

你想要：

```
idx,row = max(enumerate(lst),key=lambda r: ( sum(r[1])==0, r[0] ) ) 
```

`lst`你的清单在哪里。

或者你想要：

```
next(x for x in reversed(lst) if sum(x) != 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T14:28:45.293

这将返回具有非“全零”行的索引：

```
nonzerorows = [i for i,j in enumerate(a) if any(j)] 
```

以及此类行的最高索引：

```
maxnonzerorows = max([i for i,j in enumerate(a) if any(j)]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T03:03:53.190

```
 python 3.2

    #   if you want to find how many rows in your list has 9999
    v=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,90,1,9999,0,0,0,0,0,0,0,00,0]]

    len([i for i in v if 9999 in i])

 #   if any element in your rows is 9999 then all the elements of that row 
 # cannot be 0\. then if you want to know how many rows have all the elements 0.

     len([i for i in v if sum(i)==0]) 
```

# php - 有什么方法可以将 foreach 与 AND 一起使用？

> ID：13318508
> 
> 赞同：3
> 
> 时间：2012-11-10T01:57:15.390
> 
> 标签：php, foreach, http-post

```
foreach(($_POST["msg"] as $mg) AND ($_POST["control"] as $id))
   {
    echo $mg;
    echo $id;
   } 
```

我需要做这样的事情，有什么办法吗？我正在尝试获取 10 条 mysql 记录并编辑所有记录

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T02:01:16.867

不，那行不通。我能看到的最接近您正在尝试做的事情是：

```
for($i = 0; $i < count($_POST["msg"]); $i++) {
    echo $_POST["msg"][$i];
    echo $_POST["control"][$i];
} 
```

假设“msg”和“control”将始终包含相同数量的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T02:00:41.783

假设两者`$_POST['msg']`和`$_POST['control']`实际上都是数组，具有数字键（感谢[@iMoses](https://stackoverflow.com/questions/13318508/theres-any-way-to-use-foreach-with-and#comment18167751_13318532)），并且具有相同的长度，您可以使用 for 循环 -

```
for ($i = 0; $i < count($_POST["msg"]); $i++){
  $mg = $_POST['msg'][$i];
  $id = $_POST['control'][$i];
} 
```

# iphone - iPhone：setTitle：适用于 onCreate，但不适用于我的方法

> ID：13318510
> 
> 赞同：0
> 
> 时间：2012-11-10T01:58:10.100
> 
> 标签：iphone, ios

我想制作一个按钮，通过更改测试在 2 个不同阶段之间切换。因此，如果它显示添加，则单击 i 更改以删除。如果它说删除它将更改为添加。

该程序不起作用，为了尝试调试它，我将 setTitle 方法放在 oncreate 中，它在那里工作。接下来我在我的方法中设置断点。它检测到它说添加，并执行假设更改文本的行，文本没有更改。我真的不明白为什么它适用于 oncreate 方法而不是我的方法。

## 代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    mFeetImage.contentMode = UIViewContentModeScaleAspectFit;

    [gFileName Reset];
    NSString *ted= [gFileName GetFileName];
    mFeetImage.image= [ UIImage imageNamed :ted];

    // test code
    [ mFavrest setTitle: @"ADD" forState:UIControlStateNormal ];  works
}

-(IBAction) aFavest: (id) sender
{
    NSString *t=mFavrest.currentTitle;
    int i=[ t compare:@"ADD" ];

    if ( i ==0 )
    {
        // set break point here, break point goes off text does not change
        [ mFavrest setTitle: @"REMOVE" forState:UIControlStateNormal ];
    }
    else
    {
        [ mFavrest setTitle: @"ADD" forState:UIControlStateNormal];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T02:08:19.690

试试下面的代码：

```
-(IBAction) aFavest: (id) sender
{
    UIButton *youButton = (UIButton*)sender;
    if ([youButton.currentTitle isEqualToString:@"ADD"])
    {
        // set break point here, break point goes off text does not chnage
        [youButton setTitle: @"REMOVE" forState:UIControlStateNormal ];
    }
    else
    {
        [youButton setTitle: @"ADD" forState:UIControlStateNormal];
    }
} 
```

此外，请确保变量`mFavrest`已正确连接。在某处放置一个断点并检查它是否为零。

如果 IBOutlet mFavrest 连接正确并且 IBAction 也是如此，则此代码应该可以工作。

# ubuntu - 在 Ubuntu 12.10 中总是出现挂起

> ID：13318511
> 
> 赞同：-1
> 
> 时间：2012-11-10T01:58:24.267
> 
> 标签：ubuntu

我的**C 盘中**有**windows xp**。然后我尝试在**Ubuntu 12.10**中安装。在安装过程中，我选择 何时出现和其他选项。有错吗？？完成安装后，我的电脑会变得非常慢并且总是挂起。我的处理器是 Intel Duel-core 2.5，Twin mos 1GB Ram，250 GB 硬盘，默认显卡。****`ext4 extending ...``something else`****

 ****请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T20:46:23.657

格式化硬盘的方式无关紧要。至少你应该选择 ext3 或 ext4 来安装 ubuntu（FAT32 也是可能的，但我更喜欢 ext 格式）。您的视频卡驱动程序可能有问题。由于您没有指定使用哪种卡，我建议您为 radeon 卡安装“fglrx”驱动程序或“nvidia”驱动程序。您可以通过键入轻松找到大多数包（此处为 fglrx）

```
apt-cache search fglrx 
```

在您的终端中并安装它

```
sudo apt-get install fglrx 
```

除此之外，您的 PC 似乎符合 Ubuntu 的要求。也许您也总是在引导您的 Live CD。将 Ubuntu 安装到硬盘驱动器后，将其从 DVD 或 CD ROM 驱动器中取出！这可以解释为什么启动如此缓慢并且操作系统多次“挂起”，因为它必须一直访问 DVD 驱动器。****

# java - Java 泛型方法

> ID：13318517
> 
> 赞同：-1
> 
> 时间：2012-11-10T01:58:40.927
> 
> 标签：java, generics, arraylist, generic-method

原始问题：

> 编写以下返回新 ArrayList 的方法。新列表仅包含原始列表中的元音元素，其中包含英文字符数组 (a,e,i,o,u)。

这就是我到目前为止所拥有的。我相信我创建了正确的通用方法来打印我的字符数组列表我只是在努力将元音放入另一个数组并打印它。有什么建议么？我想我可能需要创建一个“元音”的通用 ArrayList 才能使其运行？我在正确的轨道上吗？

谢谢你的帮助！

到目前为止，这是我的代码：

```
import java.util.*;

public class test5 {

    public static void main(String[] args) {

    Character [] letters ={'a', 'r', 'y', 'i', 'i', 'o', 's', 'p', 'q', 'x', 'd', 'e', 'j'};
    Character [] vowels ={};

    test5.print(letters);
    test5.print(vowels);      

    }  

 public static <E> void print(E[] list) {
 for (int i=0; i < list.length; i++)
     System.out.print(list[i] + "");
     System.out.println();

    }

public <E> void vowels(E[] list){

 for (int i=0; i < list.length; i++)

     if (i=='a')
         vowels.add(i);

     else if (i=='e')
         vowels.add(i);

}

public static <E> void vowelsArray(E[] list){

     for(int i = 0; i<vowels.size(); i++)
       System.out.print(vowels.get(i));

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:49:14.687

听起来这个作业的重点是教你使用 List（ArrayList 是 List 的一种）。

到目前为止，您根本没有使用 ArrayList：您使用的是数组。

有一个很大的不同。

列表很有用，因为与数组不同，它们可以动态增长。

您的老师希望您遍历输入中的字母并将每个元音添加到列表中。

您应该首先查看 List 和 ArrayList 的 JavaDoc：

*   [列出文件](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)
*   [数组列表文档](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)

您的代码现在的方式，不需要泛型。

您也确实不需要通用方法。

您需要一个返回*类型*列表的方法。

这里有一个提示......这是创建 Character 对象列表的方式：

`List<Character> characterList = new ArrayList<Character>();`

# php - PHP 数组比较：为什么 array_uintersect 的回调函数必须返回 -1、0 或 1？

> ID：13318520
> 
> 赞同：2
> 
> 时间：2012-11-10T01:58:52.890
> 
> 标签：php, arrays, multidimensional-array, comparison

在对[array_uintersect](http://php.tonnikala.org/manual/el/function.array-uintersect.php#72841)文档的评论中指出，回调函数必须返回 -1 ($a < $b)、0 ($a === $b) 或 1 ($a > $b)

回调函数的目的是比较 $a 和 $b 以确定是否将它们包含在交集中，或者排除它们。那么为什么返回 -1、0 或 1 而不是简单的布尔值呢？

这是我想要实现的一些（工作）[示例代码](http://3v4l.org/ENYof)，我只是好奇它为什么会这样工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-08T21:05:37.417

值得一提的是，在您的数组输入上的操作*比*人们希望的`array_uintersect()`还要奇怪。人们期望调用会导致每个条目 from和每个条目 from 每次比较一次（优化在找到第一个交叉点后停止对条目的比较）。任何理智的人都会期望每个条目都会出现在回调的参数中，并且每个条目都会出现在它的参数中。*`array_uintersect($firstArray, $secondArray, function ($a, $b) {})``$firstArray``$secondArray``$firstArray``$a``$secondArray``$b`*

 *事实*并非*如此！信不信由你，php 对您的回调的第一次调用已经`$a`设置`$b` **为`$firstArray`**! 您正在调用一个以数组交集命名的函数，但该函数还会比较各个数组中的条目，而不是简单地在数组之间进行比较。真是让人头疼。

因此，`array_uintersect`不能替代**以下**块。用户当心。

```
$intersection = [];
foreach ($firstArray as $a) {
    foreach ($secondArray as $b) {
        if (user_compare_function($a, $b) === 0) {
            $intersection[] = $a;
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:51:47.080

我认为原因在于 PHP Source`usort`和`array_uintersect`其他类似的用户回调比较函数是`php_array_user_compare`

`xref: /PHP_5_3/ext/standard/array.c`

```
568static int php_array_user_compare(const void *a, const void *b TSRMLS_DC) /* {{{ */
569{
570    Bucket *f;
571    Bucket *s;
572    zval **args[2];
573    zval *retval_ptr = NULL;
574
575    f = *((Bucket **) a);
576    s = *((Bucket **) b);
577
578    args[0] = (zval **) f->pData;
579    args[1] = (zval **) s->pData;
580
581    BG(user_compare_fci).param_count = 2;
582    BG(user_compare_fci).params = args;
583    BG(user_compare_fci).retval_ptr_ptr = &retval_ptr;
584    BG(user_compare_fci).no_separation = 0;
585    if (zend_call_function(&BG(user_compare_fci), &BG(user_compare_fci_cache) TSRMLS_CC) == SUCCESS && retval_ptr) {
586        long retval;
587
588        convert_to_long_ex(&retval_ptr);
589        retval = Z_LVAL_P(retval_ptr);
590        zval_ptr_dtor(&retval_ptr);
591        return retval < 0 ? -1 : retval > 0 ? 1 : 0;
592    } else {
593        return 0;
594    }
595} 
```

`retval`如果您查看，这将使用which 是一个整数来比较函数

```
retval < 0 ? -1 : retval > 0 ? 1 : 0 
```

如果您使用的是布尔值并且需要转换，它只能给出`0`或`1`

例子

```
var_dump((int) true); // 1
var_dump((int) false); // 0 
```

这意味着您可能能够`boolean`在相交期间逃脱，因为仅`$a === $b = 0`需要 where 而不是其他实现 `retval < 0`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-10T02:54:12.510

[梨替换](http://pear.php.net/reference/PHP_Compat-latest/__filesource/fsource_PHP_Compat__PHP_Compat-1.6.0a3CompatFunctionarray_uintersect.php.html)接受回调，只返回一个布尔值。php函数没有。所以原因可能是php中的优化。你可以[在这里检查一下](https://github.com/php/php-src/blob/master/ext/standard/array.c)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-10T03:12:21.517

在幕后，是对 C 函数的调用`zend_qsort`。

```
if (behavior == INTERSECT_NORMAL) {
    zend_qsort((void *) lists[i], hash->nNumOfElements, sizeof(Bucket *), intersect_data_compare_func TSRMLS_CC);
} else if (behavior & INTERSECT_ASSOC) { /* triggered also when INTERSECT_KEY */
    zend_qsort((void *) lists[i], hash->nNumOfElements, sizeof(Bucket *), intersect_key_compare_func TSRMLS_CC);
} 
```

[快速排序](http://en.wikipedia.org/wiki/Quicksort)对这些关系很敏感，因此它可以执行其算法的分区组件。*与枢轴*具有相同值的项目被放置在*枢轴*附近和两侧。

 *有趣的是，大于比较运算符`>`适用于对象比较，这是一种未记录的行为。根据一条评论，PHP 会查看公共对象的值以进行比较。这实际上是现在[内部列表上的一个讨论点！](http://www.mail-archive.com/internals@lists.php.net/msg61823.html)**

# java - Gson 排除策略和自定义序列化

> ID：13318522
> 
> 赞同：3
> 
> 时间：2012-11-10T01:59:07.900
> 
> 标签：java, gson

我在我的持久对象上使用 Gson 自定义序列化。同时，我也在使用序列化排除策略。代码如下所示：

```
public class GsonFactory {

    public static Gson build(Type type, final List<String> fieldExclusions,
            final List<Class<?>> classExclusions) {
        GsonBuilder gsonBuilder = new GsonBuilder();
        gsonBuilder.addSerializationExclusionStrategy(new ExclusionStrategy() {
            public boolean shouldSkipField(FieldAttributes f) {
                return fieldExclusions == null ? false : fieldExclusions
                        .contains(f.getName());
            }

            public boolean shouldSkipClass(Class<?> clazz) {
                return classExclusions == null ? false : classExclusions
                        .contains(clazz);
            }
        });
        // Uncommenting this line will produce error
        // gsonBuilder.registerTypeAdapter(type,
        // new PersistentObjectJsonSerializer());
        return gsonBuilder.create();
    }
}

class PersistentObjectJsonSerializer implements
        JsonSerializer<PersistentObject> {

    public JsonElement serialize(PersistentObject src, Type typeOfSrc,
            JsonSerializationContext context) {
        src.setDT_RowId(src.getId());
        Gson gson = new Gson();
        return gson.toJsonTree(src);
    }

} 
```

但是，如果我取消注释`gsonBuilder.registerTypeAdapter(type, new PersistentObjectJsonSerializer());`, 在创建时`gsonBuilder`将给出以下错误：

```
java.lang.StackOverflowError
    com.google.gson.reflect.TypeToken.equals(TypeToken.java:284)
    java.util.HashMap.get(HashMap.java:305)
    java.util.Collections$SynchronizedMap.get(Collections.java:1979)
    com.google.gson.Gson.getAdapter(Gson.java:337)
    com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:55)
    com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:89)
    com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.write(ReflectiveTypeAdapterFactory.java:195)
    com.google.gson.Gson$FutureTypeAdapter.write(Gson.java:883) 
```

我的 PersistentObject java 类：

```
@MappedSuperclass
public abstract class PersistentObject implements Serializable {

....

@Transient
protected long DT_RowId;
// getters, setters not shown

...

} 
```

这就是我在 GenericHibernateDAO 中调用 GsonFactory.build 的方式：

```
public abstract class GenericHibernateDAO<T, ID extends Serializable> {

private Class<T> persistentClass;

@SuppressWarnings("unchecked")
public GenericHibernateDAO() {
    this.persistentClass = (Class<T>) ((ParameterizedType) getClass()
            .getGenericSuperclass()).getActualTypeArguments()[0];
}

public String listAsJsonResponse(){
    ...
    // testing start
    List<Class<?>> classExclusions = new ArrayList<Class<?>>();
    classExclusions.add(Role.class);
    List<String> fieldExclusions = new ArrayList<String>();
    fieldExclusions.add("users");
    fieldExclusions.add("password");
    Gson gson = GsonFactory.build(persistentClass,fieldExclusions, null);
    ...
    return jsonResponse.toString();
}
} 
```

这里`persistentClass`指的是`User`类：

```
@Repository
public class UserDAO extends GenericHibernateDAO<User, Long> {

} 
```

基本上我无法同时使用这两个功能。关于可能导致此问题的任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-27T12:31:51.993

这是一个老问题，但也许我的回答仍然可以帮助某人。

您在序列化程序中创建一个新的 Gson 对象。这个 Gson 对象不再知道 PersistentObjects 的 ExclusionStrategies。如果您的 PersistantObject 具有将再次导致 PersistentObject 的属性对象（在您的情况下，用户可能具有 persistantObject 的属性），那么您将陷入无限循环并进入 stackoverflow 异常。

一种解决方案是再次向序列化程序中的 gson 对象添加排除策略。但是不要再将序列化程序添加到这个 gson 对象中！

```
class PersistentObjectJsonSerializer implements
    JsonSerializer<PersistentObject> {

    public JsonElement serialize(PersistentObject src, Type typeOfSrc,
        JsonSerializationContext context) {
        src.setDT_RowId(src.getId());
        Gson gson = new Gson();
        //add exclusion strategy here again
        return gson.toJsonTree(src);
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T09:06:25.490

Gson 是开源的，您可以获取源代码。为什么不这样做并按照代码查看它在哪一点引发异常？似乎 gson 陷入了无限循环。确实，gson 大量使用递归。如果它实际上是一个错误，您可以将它报告给 Gson 人员，他们将在下一个版本中解决它。

[http://code.google.com/p/google-gson/issues/list](http://code.google.com/p/google-gson/issues/list)

# jquery - 将 Cookie 添加到简单的 jQuery 函数

> ID：13318530
> 
> 赞同：1
> 
> 时间：2012-11-10T02:00:24.077
> 
> 标签：jquery

> **可能重复：**
> [如何使用 jQuery 设置/取消设置 cookie？](https://stackoverflow.com/questions/1458724/how-to-set-unset-cookie-with-jquery)

所以我有这个*非常*简单的 jQuery 函数......我的问题是，当 DIV 隐藏（即淡出）时如何添加 cookie？我希望 cookie 在浏览器或窗口关闭之前一直处于活动状态。

简而言之，当“访问者”单击 DIV 上的指定 X（即 .updateCloseBTN 类）时，它将隐藏 DIV。但如果用户刷新或重新访问页面，DIV 将再次显示。如果用户通过下面的函数关闭了 DIV，则无论用户刷新还是重新访问页面，都不应再次加载它。但是，如果用户关闭浏览器窗口或浏览器本身并返回站点，它将出现...

```
// Update Prompt: Hide on 'X' click 
$('.updateCloseBTN').click(function () {
    $('.upgradeWrap').fadeOut(400);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T02:15:15.270

首先，你需要一个这样的插件:) [https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

拿到插件后...

创建你的 cookie 函数

```
function setsomecookie(){
     $.cookie('the_cookie', 'the_value', { expires: 365 });
} 
```

为fadeOut() 动画使用回调。

```
$('.updateCloseBTN').click(function () {
    $('.upgradeWrap').fadeOut(400, setsomecookie);
}); 
```

这将在fadeOut() 完成后运行“setsomecookie”函数:)

# ruby-on-rails - 如何在Ruby中并行递归下载FTP文件夹？

> ID：13318549
> 
> 赞同：3
> 
> 时间：2012-11-10T02:03:10.123
> 
> 标签：ruby-on-rails, ruby

我需要在 ruby​​ 中本地缓存一个 ftp 文件夹。现在我正在使用[ftp_sync](https://github.com/jebw/ftp_sync)下载 ftp 文件夹，但是速度很慢，你们知道任何可以并行下载文件夹文件的库吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T04:44:43.890

syncftp gem 可以帮助您：

[http://rubydoc.info/gems/syncftp/0.0.3/frames](http://rubydoc.info/gems/syncftp/0.0.3/frames)

Ruby 有一个不错的内置 FTP 库，以防你想自己动手：

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/ftp/rdoc/Net/FTP.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/ftp/rdoc/Net/FTP.html)

要并行下载文件，您可以使用具有超时的多个线程：

[Ruby Net::FTP 超时线程](https://stackoverflow.com/questions/1230172/ruby-netftp-timeout-threads)

完成并行工作的一个好方法是赛璐珞，并发框架：

[https://github.com/celluoid/赛璐珞](https://github.com/celluloid/celluloid)

话虽如此，如果下载速度仅限于您的整体网络带宽，那么这些方法都无济于事。

在这种情况下，为了加快传输速度，请确保您只下载已更改的信息：新文件和现有文件的更改部分。

分段下载在某些情况下可以提供巨大的加速，例如下载的大日志文件只有一小部分文件发生了变化，并且这些变化都在文件的末尾，并且都是附加的。

您还可以考虑使用命令行。有许多工具可以帮助您解决这个问题。一个很好的通用方法是“curl”，它也支持 FTP 文件的简单范围，例如，您可以使用 FTP 获取文档的前 100 个字节，如下所示：

```
curl -r 0-99 ftp://www.get.this/README 
```

您是否对 FTP 以外的其他协议开放？看看“rsync”命令，它非常适合下载同步。rsync 命令有许多优化，可以只传输更改的数据。例如 rsync 可以将远程目录同步到本地目录，如下所示：

```
rsync -auvC me@my.com:/remote/foo/ /local/foo/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T04:52:02.737

看看[路边](https://github.com/taf2/curb)。它是 Curl 的包装器，可以并行进行多个连接。

这是[其中一个示例](https://github.com/gpherguson/curb/blob/master/samples/multi_interface.rb)的修改版本：

```
require 'curb'

urls = %w[
  http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p286.tar.bz2
  http://www.python.org/ftp/python/2.7.3/Python-2.7.3.tar.bz2
]

responses = {}
m = Curl::Multi.new

# add a few easy handles
urls.each do |url|
  responses[url] = Curl::Easy.new(url)
  puts "Queuing #{ url }..."
  m.add(responses[url])
end

spinner_counter = 0
spinner = %w[ | / - \ ]
m.perform do
  print 'Performing downloads ', spinner[spinner_counter], "\r"
  spinner_counter = (spinner_counter + 1) % spinner.size
end
puts

urls.each do |url|
  print "[#{ url } #{ responses[url].total_time } seconds] Saving #{ responses[url].body_str.size } bytes..."
  File.open(File.basename(url), 'wb') { |fo| fo.write(responses[url].body_str) }
  puts 'done.'
end 
```

这将同时引入 Ruby 和 Python 源代码（它们非常大，因此需要大约一分钟，具体取决于您的 Internet 连接和主机）。在最后一个块被写出之前，您不会看到任何文件出现。

# xcode - 如何在子视图中放大 MPMoviePlayerController 控件

> ID：13318550
> 
> 赞同：1
> 
> 时间：2012-11-10T02:03:42.493
> 
> 标签：xcode, ios6, controls, mpmovieplayercontroller

我正在添加一个 MPMoviePlayerController 对象，该对象流式传输 .mp3 并在主视图控制器中显示子视图。请参阅我在开始播放时获得的控件的链接。如果可能的话，我怎样才能放大这个控制栏？

![在此处输入图像描述](../Images/325a45aeb0650687c662afaac324943a.png)

# sqlite - 我可以在 appharbor 中使用 sqlite 吗？

> ID：13318553
> 
> 赞同：2
> 
> 时间：2012-11-10T02:04:49.793
> 
> 标签：sqlite, appharbor

我在我的 appharbor 应用程序中使用 sqlite。数据文件位于“/App_Data”中。在我的开发环境中，它运行良好。但是当我在 appharbor 中部署它时，出现错误：“SQLite error no such table: Items”。似乎所有的桌子都丢失了。

我打印连接字符串，它是“Data Source=D:\websites\f3\d2b85\15729\0x0001_PublishedWebsites\ToolBox\App_Data\d3ah.db;” ，看起来不错。

所以我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T05:21:07.480

我就知道。appharbor 构建我的源代码并部署它。

因此，在 Visual Studio 中，转到解决方案资源管理器并找到您的 sqlite 数据文件。右键单击它，然后单击“属性”，然后将构建操作设置为“内容”。签入源代码。完毕！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T07:52:12.540

不建议在 AppHarbor 上使用 SQLite，因为实例存储不会跨部署持久化。[常见问题解答](http://support.appharbor.com/kb/getting-started/frequently-asked-questions)中有更多详细信息。

# javascript - 需要关于 jquery 图片标题的建议

> ID：13318554
> 
> 赞同：0
> 
> 时间：2012-11-10T02:04:56.243
> 
> 标签：javascript, jquery, css, transparent, caption

[http://www.zurb.com/expo](http://www.zurb.com/expo)

多年来，我一直在寻找这样的标题。但我希望该标题的背景不透明。50% 然后悬停 90% 和半脉动文本效果。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T08:36:33.750

根据您的浏览器支持，这可以[使用 CSS 动画（示例）](http://jsfiddle.net/LLchY/)来完成。

```
h2 {
    background: rgba(0, 0, 0, 0.5);
}

.image:hover h2 {
    background: rgba(0, 0, 0, 0.8);
    -moz-animation: 2s ease 0s normal none infinite pulse;
    -webkit-animation: 2s ease 0s normal none infinite pulse;
}

@-moz-keyframes pulse {
  0% { color: #000 }
  50% { color: #FFF }
  100% { color: #000; }
}

@-webkit-keyframes pulse {
  0% { color: #000 }
  50% { color: #FFF }
  100% { color: #000; }
} 
```

如果您需要旧版浏览器支持，而不是 RGBA，请使用具有 alpha 透明度的 PNG 背景图像和[jQuery animate()](http://api.jquery.com/animate/)而不是 CSS 动画。

# primefaces - start in-cell-editing a row in primefaces datatable using context menu

> ID：13318558
> 
> 赞同：2
> 
> 时间：2012-11-10T02:06:10.343
> 
> 标签：primefaces, contextmenu

I'd like to trigger in-cell-editing in a dataTable from a context menu edit command. I'm using primesfaces 3.4.1\. I only found examples for editing using p:column/p:rowEditor (which is working fine). Context-menu examples span delete/view only but not editing. Thanx in advance hp

# c - 我从文件中读取一个字符串并将其存储到一个数组中，但是我怎么知道数组的长度呢？

> ID：13318560
> 
> 赞同：0
> 
> 时间：2012-11-10T02:07:02.970
> 
> 标签：c, arrays, string, input

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

int main()
{
    int i = 0, len1=0, len2=0;
    int BUFSIZE = 1000;
    char* string1[20];
    char* string2[20];
    FILE *fp1 = fopen("input1.txt", "r");
    FILE *fp2 = fopen("input2.txt", "r");
    if ((fp1 == 0)||(fp2 == 0)){
        fprintf(stderr, "Error while opening");
        return 0;
    }
    string1[i] = (char*)malloc(BUFSIZE);
    string2[i] = (char*)malloc(BUFSIZE);
    while (fgets(string1[i], BUFSIZE, fp1)) {
        i++;
        len1+=strlen(string[i]);
        string1[i] = (char*)malloc(BUFSIZE);
        len1+=strlen(string1[i]);
    }

    i = 0;
    while (fgets(string2[i], BUFSIZE, fp2)) {
        i++;
        string2[i] = (char*)malloc(BUFSIZE);
    }

    printf("Output: \n");
    srand(time(NULL));
    int j = rand()%i;
    int k = (j+1)%i;
    fflush(stdout);
    printf("%d - %s %d -%s", j, string1[j], k, string1[k]);
    printf("%d - %s %d -%s", j, string2[j], k, string2[k]);
    printf("\n");
    printf("%d", len1);

    int x;
    for(x = 0; x<i; x++){
        free(string1[x]);
        free(string2[x]);
    }
    scanf("%d", x);
    fclose(fp1);
    fclose(fp2);
    return 0;
} 
```

感谢user1807597的帮助，我终于实现了读取两个字符串并存入数组。但是我仍然无法获取数组的长度，我尝试将 len+=strlen(string[i]); 在while循环中，但编译器在调试时中断。有人知道为什么吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T02:39:57.293

对于数组的长度，您有两个主要选择。

1.  你把它做得足够大，以至于你认为你永远不会使用更多的条目。

    ```
    enum { MAX_LINES = 16 * 1024 };
    char *lines[MAX_LINES];
    size_t num_lines = 0; 
    ```

2.  您对数组进行动态分配。

    ```
    char **lines = 0;
    size_t max_lines = 0;
    size_t num_lines = 0;

    ...

    if (num_lines >= max_lines)
    {
        size_t new_lines = max_lines * 2 + 2;
        char **space = realloc(lines, new_lines * sizeof(*space));
        if (space == 0)
            ...deal with out of memory...
        lines = space;
        max_lines = new_lines;
    } 
    ```

两个系统都可以工作。动态分配在前几次做的时候稍微复杂一些，但是直到内存用完才遇到问题，而且这些天内存用完需要很长时间。如果您猜错了，固定分配可能会耗尽空间，如果您只处理小文件，则名义上会浪费内存。如今，“浪费”的内存通常非常小。

哪个更好取决于您希望程序处理的问题的规模。如果它们很小，那么固定但慷慨的分配是明智和容易的。如果它们很大，则动态分配更明智。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:35:09.617

我已经修改了代码。我认为现在没问题。你在第一个 while 循环中计数错误。`i++`应该在后面`len1+=strlen(string[i]);`。在最后一个 scanf 语句中`scanf("%d", x);`，你错过了运算符'&'。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

int main()
{
    int i = 0, len1 = 0, len2 = 0;
    int BUFSIZE = 1000;
    /*
       you have too  few lines here,
       If my file contains more than 20 lines,tragedy will occur!
       */
    char* string1[20];
    char* string2[20];

    FILE* fp1 = fopen("input1.txt", "r");
    FILE* fp2 = fopen("input2.txt", "r");

    if ((fp1 == 0) || (fp2 == 0))
    {
        fprintf(stderr, "Error while opening");
        return 0;
    }
    string1[i] = (char*)malloc(BUFSIZE);
    string2[i] = (char*)malloc(BUFSIZE);

    while (fgets(string1[i], BUFSIZE, fp1)!=NULL)
    {
        /*
        i++;
        */

        len1 += strlen(string1[i]);
        i++;
        string1[i] = (char*)malloc(BUFSIZE);
    }

    i = 0;
    while (fgets(string2[i], BUFSIZE, fp2))
    {
        i++;
        string2[i] = (char*)malloc(BUFSIZE);
    }

    printf("Output: \n");
    srand(time(NULL));
    int j = rand() % i;
    int k = (j + 1) % i;
    fflush(stdout);
    printf("%d - %s %d -%s", j, string1[j], k, string1[k]);
    printf("%d - %s %d -%s", j, string2[j], k, string2[k]);
    printf("\n");
    printf("%d", len1);

    int x;
    for (x = 0; x < i; x++)
    {
        free(string1[x]);
        free(string2[x]);
    }
    /*
    scanf("%d", x);
    */
    scanf("%d",&x);
    fclose(fp1);
    fclose(fp2);
    return 0;
} 
```

# c# - 向 TextBox 添加新的数据行

> ID：13318561
> 
> 赞同：57
> 
> 时间：2012-11-10T02:07:09.697
> 
> 标签：c#, .net, winforms, user-interface, textbox

我正在做一个聊天客户端，目前我有一个按钮，单击时将数据显示到多行文本框。这是向多行文本框添加数据的唯一方法吗？我觉得这是非常低效的，因为如果对话变得很长，字符串也会变得很长。

```
private void button1_Click(object sender, EventArgs e)
        {
            string sent = chatBox.Text;
            displayBox.Text += sent + "\r\n";

        } 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-11-10T07:48:46.203

如果您使用 WinForms：

改用该`AppendText(myTxt)`方法`TextBox`（.net 3.5+）：

```
 private void button1_Click(object sender, EventArgs e)
    {
        string sent = chatBox.Text;

        displayBox.AppendText(sent);
        displayBox.AppendText(Environment.NewLine);

    } 
```

文本本身通常具有较低的内存占用（您可以在 f.ex. 10kb 内说很多，这就是“无”）。TextBox 不会渲染缓冲区中的所有文本，只会渲染可见部分，因此您无需过多担心延迟。较慢的操作是插入文本。附加文本相对较快。

如果您需要对内容进行更复杂的处理，您可以`StringBuilder`将其与文本框结合使用。这将为您提供一种非常有效的文本处理方式。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-11-10T03:56:27.343

以下是方法

1.  从代码（你提到的方式） - >

    ```
    displayBox.Text += sent + "\r\n"; 
    ```

    或者

    ```
    displayBox.Text += sent + Environment.NewLine; 
    ```

2.  从 UI
    a) WPF

    ```
    Set TextWrapping="Wrap" and AcceptsReturn="True" 
    ```

    按 Enter 键进入文本框，将创建新行

    b) Winform 文本框

    ```
    Set TextBox.MultiLine and TextBox.AcceptsReturn to true 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-23T15:05:05.787

我发现这种方法节省了大量的打字，并防止了很多错别字。

字符串 nl = "\r\n";

txtOutput.Text = "第一行" + nl + "第二行" + nl + "第三行";

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-10T03:35:31.623

因为您没有指定您使用的前端（GUI 技术），所以很难做出具体的推荐。在 WPF 中，您可以创建一个列表框，并为每一行新的聊天添加一个新的列表框项到集合的末尾。此[链接](http://www.pcreview.co.uk/forums/implement-chat-window-via-winforms-t1324368.html)提供了一些关于如何在 winforms 环境中实现相同结果的建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-25T16:31:04.657

C# - serialData`ReceivedEventHandler`在`TextBox`.

```
SerialPort sData = sender as SerialPort;
string recvData = sData.ReadLine();

serialData.Invoke(new Action(() => serialData.Text = String.Concat(recvData))); 
```

现在 Visual Studio 放弃了我的台词。当然，TextBox 有所有正确的选项。

序列号：

```
Serial.print(rnd);
Serial.( '\n' );  //carriage return 
```

# java - 数组错误（处理多个数组），找不到解决办法

> ID：13318563
> 
> 赞同：0
> 
> 时间：2012-11-10T02:07:25.680
> 
> 标签：java

几个小时以来，我一直在尝试用我的 java 代码修复这个解决方案。我在 eclipse 上遇到错误：

“方法 displayQFunction(int[], int[], int) 对于 Ass1 类型未定义”

我试过改变价值观，尝试改变一切，但这个错误阻碍了我取得进步。

这是我的代码：

```
import java.util.* ;
public class Ass1 {

 static int VIX = 0 ; // Traversing Voltage Component in Component Value Array 
 static int CIX = 1 ; // Traversing Capacitor
 static int LIX = 2; // Traversing Inductor
 static int RIX = 3; // Traversing Resistor

 public static void main (String args[]) { 
  System.out.println("ITI 1120 Fall 2012 , Assignment 3 , Question 3") ; 
  System.out.println("Name : Khalid Awil , Student # 6763004") ; 

  double[] compArr  = getCircuitComp() ; 

  System.out.println("-----------------------------------------------------") ;
  System.out.println(""); 
  System.out.println("Voltage Source V = " + compArr[VIX]+ "volts") ; 
  System.out.println("Capacitor C = " + compArr[CIX]+ "farads");
  System.out.println("Inductor L = " + compArr[LIX] + " henrys") ; 
  System.out.println("Resistor R =" + compArr[RIX] + "ohms") ; 
  System.out.println("-----------------------------------------------------") ; 

  boolean outerLoopFlag ; 
  boolean innerLoopFlag ; 
  int i ; 
  int n = 1  ; 
  int qArray[] = new int[n] ; 
  int timeArr[] = new int [n] ;
  System.out.println("-----------------------------------------------------") ;
  Scanner input = new Scanner (System.in) ;
  while ( outerLoopFlag = true) { 

   System.out.println("Reset Component Values (y/n) ?") ; 
   String answer = input.nextLine() ; 
   char ans = answer.charAt(0) ;  
   if ( ans == 'y') { 
     getCircuitComp() ; 

   } 
   else { 
     } 
   innerLoopFlag = true ; 
   while ( innerLoopFlag = true){ 
    System.out.print("Run a simulation?") ; 
      String answer2 = input.nextLine() ; 
   char ans2 = answer2.charAt(0) ;  
    if (ans2 == 'y'){

    System.out.println("Enter a maximum time :") ; 
    double tMax = input.nextDouble(); 
    System.out.println("Enter a time step:") ; 
    double tStep = input.nextDouble();
       timeArr[n]= genTimeArray(tMax,tStep,n);  
       qArray[n] = genQArray( timeArr , n , compArr) ;  
       displayQFunction(timeArr,qArray,n );

    }
    else{
     innerLoopFlag = false ;
    }
    System.out.println("-----------------------------------------------------") ; 

    while (innerLoopFlag = false) { 
     System.out.println("Do you want to quit (y/n)?") ;
     String answer3 = input.nextLine() ; 
     char ans3 = answer3.charAt(0) ; 
     if ( ans3 =='y' ){ 
      System.exit(0); 
      } 
     else{}

    }

   } 

 }

}
     ////////////////////////////
 ///*getCircuitComp Method // 

 public static double[] getCircuitComp() {
     Scanner input = new Scanner (System.in) ; 
  boolean flag = true ; 
  double compArr [] = new double[4]; 
     do{ 
   System.out.println("Enter a value V ( 4 to 15):") ; 
   compArr[VIX] = input.nextDouble() ;  
   if ((compArr[VIX] >= 4.0) && (compArr[VIX] <= 15.0)){ 
    flag = false ; 
   }
   else{ 
    System.out.println("Bad Value" + compArr[VIX] ) ;
   }

  }  while (  flag );
  flag = true  ; 
  while (flag) { 
   System.out.println("Enter a value for R ( 5 to 10) :") ; 
   compArr[RIX] = input.nextDouble();  
   if((compArr[RIX] >= 5.0) && (compArr[RIX] <= 10.0)){
flag = false;
   }
   else{
    System.out.println("Bad Value:"+ compArr[RIX]) ; 

   }

  }
   flag = true ; 
   while(flag) { 
    System.out.println("Enter a value for C( 1e-9 to 1e-7 ): ") ; 
    compArr[CIX] = input.nextDouble();  
    if (( compArr[CIX] >= Math.pow(10, -9)) && (compArr[CIX] <= Math.pow(10, -7))){
     flag = false ; 
    }
    else{ 
     System.out.println("Bad Value :"+ compArr[CIX]);
    }

   }
    flag = true ; 
    while(flag){ 
     System.out.println("Enter a value for L(1e-3 to 1e-1) "); 
     compArr[LIX] = input.nextDouble(); 
     if(compArr[LIX]>= Math.pow(10,-3) && compArr[LIX] <= Math.pow(10, -1)){
      flag = false ; 
     }
     else{ 
      System.out.println("Bad Value :" + compArr[LIX]) ; 

     }
    }
    return compArr  ; 
   }

////////////////////////////
///*getTimeArray Method //  
 public static int genTimeArray( double tMax , double tStep , int n ) { 

   int t[] = new int[n] ;
    n = 1 ; 
    t[0] = 0 ; 
    if(t[n] < tMax){
    t[n] = (int) (t[n-1] + tStep) ; 
    n = n + 1 ; 
    }
   return t[n] ;

  } 
  public static int genQArray( int timeArr[] , int n , double compArr [] ) {
   double q[] = new double[n] ; 
   n = 1 ;  
   double s = (compArr[VIX])*(compArr[CIX]) ; 
   double t = Math.exp((-compArr[RIX])/(2*compArr[LIX])); 
   double c = (1)/((compArr[LIX])*(compArr[CIX])) ; 
   double v = Math.pow((compArr[RIX])/(2*(compArr[LIX])),2) ;
   double r = (timeArr[n])*(Math.sqrt(c-v)) ;
   q[n] = (s)*(t)*(Math.cos(r)) ; 

   return (int) q[n] ; 
  }
////////////////////////////
///*displayQFunction Method // 
  public static void  displayQFunction(int[] timeArr , int[] qArray ,int n  ){ 

  n = 1 ;
  System.out.println( timeArr[n]  + qArray[n]) ; 

 }
 } 
```

谢谢您的帮助 ！,

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T02:10:03.907

> 方法 displayQFunction(int[], int[], int) 对于 Ass1 类型未定义

这是一个错字：您`Function`在`Fuction`声明方法时拼写错误。

改变

```
public static void  displayQFuction(int[] timeArr , int[] qArray ,int n  ){ 
```

到

```
public static void  displayQFunction(int[] timeArr , int[] qArray ,int n  ){ 
```

# php - php configure - Server error The website encountered an error while retrieving

> ID：13318565
> 
> 赞同：3
> 
> 时间：2012-11-10T02:07:56.313
> 
> 标签：php, configuration, joomla

Someone just upgraded to PHP 5.4.8 and now I get an error:

Google Chrome:

```
The website encountered an error while retrieving http://10.10.1.22/. It may be 
down for maintenance or configured incorrectly. 
```

Firefox: Blank all white window

I did some playing around and found if I put just index.html in the /var/www/html, it display's it. But if I put in a fresh copy of joomla I get that error. I get the same error when trying to access phpmyadmin.

Everything was working fine before the upgrade, any idea's on what I need to configure? Suggestions one things I should look at or try.

I believe LAMP is installed.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:30:43.777

*如果我将 index.html 放在 /var/www/html 中，它就会显示出来。*说明没有php配置问题。

可能存在一些特定于扩展的问题。您可以尝试使用默认的 Joomla 安装并一次添加一个扩展，直到您确定哪些特别有问题，然后咨询扩展开发人员 - 他们可能不知道这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:56:26.780

Html 不需要服务器干预即可显示。

尝试放置一个 php 文件：index.php

里面放了这些代码：

```
<?php

ini_set('display_errors', 1); 
ini_set('log_errors', 1); 
ini_set('error_log', dirname(__FILE__) . '/error_log.txt'); 
error_reporting(E_ALL);

echo "Hello World!";
echo "php is working";
php_info();

//this should generate an error--->
echo $unknown_var;
    ?>
    <html>
    Html is working
    </html> 
```

这应该可以帮助您确定问题所在。

我的猜测是您的服务器可能需要重新启动。

**编辑**

看来您的设置[open_basedir有问题](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)

或 .htaccess 阻止您访问您的 www 导演。

olso 检查**doc_root的值**

# ruby - Sinatra/Ruby time zone troubles between development & production

> ID：13318566
> 
> 赞同：1
> 
> 时间：2012-11-10T02:07:58.693
> 
> 标签：ruby, datetime, timezone, sinatra, datamapper

My Sinatra app is creating a simple object and persisting it to Postgres:

```
post '/' do
  event = Event.new(params)
  event.created_at = Time.now.utc
  event.date = next_date(params[:dayofweek], params[:time]) if params[:dayofweek] && params[:time]

  if event.save
    status 201
    event.to_json
  else
    json_status 400, event.errors.to_hash
  end

def next_date(dayofweek, hour)
  ...
  # some calculations that effectively culminate in the final line below
  ...
  my_time = Time.utc(2012, 11, 9, 12, 0, 0)   ## => 2012-11-09 12:00:00 UTC  
end 
```

Object saves successfully. But when I retrieve the object from my `development` environment I get (json):

```
{ ..., "date":"2012-11-23T20:00:00-08:00" }   #notice the PST offset of -08:00\. 
```

I'm expecting the UTC time zone *or* `+00:00`. For some reason my development workstation, which is in PST, is factoring in its own time zone when saving to Postgres...at least that what it appears to be doing?!?

Sending the same code to the production server (Heroku) stores same data with proper offset of `+00:00`

How can I make my development workstation act like the production one? Or, **how should I be creating a proper UTC Date object in Sinatra?**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T04:15:18.163

首先验证您的数据是否成功往返：

```
event.created_at = Time.now.utc
event.date = ...whatever...
tmp_created_at = event.created_at
tmp_date = event.date
event.save
event.reload!
tmp_created_at == event.created_at or raise "created_at failed"
tmp_date == event.date_at or raise "date failed" 
```

其次，验证 JSON 是否准确。

*   将 JSON 时间字符串与预期时间进行比较
*   JSON 时间字符串具有 -08:00
*   JSON字符串的实际时间是否相同？
*   例如，如果您预计 10:00Z，JSON 是否显示 02:00-08:00（即相同的实际时间）或 10:00-08:00（不同的实际时间 - 这是八小时后） .

如果数据往返有效，并且 JSON 是相同的实际时间，则查看您用于打印字符串的任何 JSON 库。寻找像“iso8601”这样的方法，它将以标准 UTC 格式打印时间。

此外，知道 Postgres 默认保存没有时区的时间戳可能会有所帮助。

> “SQL 标准要求仅写入时间戳等同于不带时区的时间戳，并且 PostgreSQL 尊重这种行为。（7.3 之前的版本将其视为带时区的时间戳。）时间戳被接受为带时区的时间戳的缩写；这是一个 PostgreSQL 扩展。”

您可以通过描述该表来看到这一点，该表可能如下所示：

```
# \d events
Table "public.events"
Column     |            Type             |      Modifiers    
-----------+-----------------------------+-----------------------------------
id         | integer                     | not null default  
name       | character varying(255)      | 
created_at | timestamp without time zone | not null
updated_at | timestamp without time zone | not null
date       | timestamp with time zone    | not null 
```

更多信息基于 OP 的反馈...

OP 说：我正在使用 DataMapper，在他们的网站上四处挖掘后，我发现“时间属性将始终在数据存储设置的时区中存储和检索”，以及指向将强制特定区域的 gem 的链接。

因为往返显示了问题，请尝试使用当前版本的连接库，例如当前的 DataMapper，并尝试使用任何类似库的当前版本，例如 ActiveRecord（撰写本文时版本为 3.2.8）。

# c - 为什么我必须返回指针？

> ID：13318568
> 
> 赞同：2
> 
> 时间：2012-11-10T02:08:20.740
> 
> 标签：c, arrays, sorting, pointers

我试图编写一个使用指针对数组进行排序的函数。我的**p**指针指向**x**数组，但我为什么要返回**x**作为指针？

```
 #include <stdio.h>
    int sort(int x[], int n){
    int *p,k;
    p=x;
    for(int i=0; i<n-1; i++){
        for(int l=i+1; l<n; l++){
            if(*(p+i)>*(p+l)){
                k=*(p+i);
                *(p+i)=*(p+l);
                *(p+l)=k;
            }
        }
    }
    return *x;
}
int main(){
    int n;
    scanf("%d", &n);
    int a[n];
    for(int i=0; i<n; i++){
        scanf("%d",&a[i]);
    }
    sort(a,n);
    for(int i=0; i<n; i++){
        printf("%d ",a[i]);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T02:10:30.720

你的函数返回一个`int`（值），而不是一个指针。您的实现 ( `return *x;`) 按值返回参数的第一个元素`x[]`。

> 为什么我应该将 x 作为指针返回？

返回值应该表示什么？目前尚不清楚为什么在这种情况下你会返回任何东西。在你能回答之前，`void`会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:19:57.443

为什么你“必须”返回一个指针的简短答案是你显然不需要返回任何东西。您*没有*返回指针（而是一个`int`），并且您没有将返回的值用于任何事情。您可以将函数的返回类型更改为`void`并删除该行，`return`它也可以正常工作。

它在不返回任何内容的情况下工作的原因是您将指向数组的指针`a`作为*参数*传递给`sort`，然后在适当的位置修改数组（称为`x`该函数内部）。所以只有一个数组，因此您不必返回另一个数组或指向它的指针，更改在`main`.

# xaml - WinRT-XAML 中的 Click、Tapped 和 PointerPressed 是同义词吗？

> ID：13318569
> 
> 赞同：37
> 
> 时间：2012-11-10T02:08:40.490
> 
> 标签：xaml, event-handling, windows-8, winrt-xaml, windows-store-apps

我是否为 PointerPressed、Click 或 Tapped 创建事件处理程序是否重要？IOW，以下之间是否有任何功能差异：

```
<Button x:Name="BackButton" PointerPressed="BackButton_Click"/>    
<Button x:Name="BackButton" Click="BackButton_Click"/>    
<Button x:Name="BackButton" Tapped="BackButton_Click"/> 
```

?

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-21T12:21:40.453

Click 是为了向后兼容，本质上与 Tapped 相同。Tapped 是一种“高级手势”，它会自动转换为点击、点击、笔压等，这是我推荐使用的。

PointerPressed 不是你想要的。原因如下：如果我按住，PointerPressed 事件将在我最初“按下”时触发，然后 PointerReleased 将在完成后触发。这是更低级别的，您可以决定按下多长时间等。通常，长按不是您想要考虑的“点击”或“点击”，因为根据定义，点击的持续时间较短。因此，对于您想要的，“Tap”最能传达它，因为它使用系统计时为您翻译手势，用于被认为是“Tap”与按住的内容，并自动将点击和笔按下提升到同一事件。无论交互持续多长时间，只要按下按钮或按下手指，PointerPressed 就会触发。

我有一个相当复杂的应用程序，它演示了您可以从[http://windows8applications.codeplex.com](http://windows8applications.codeplex.com)下载的各种交互- 只需参考第 4 章名为“Touch”的示例。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-04-01T06:33:11.567

杰里米的回答并不完全准确。在[另一个线程](https://stackoverflow.com/questions/21820482/winrt-xaml-tapped-event-responds-slowly-while-clicked-responds-rapidly/21842945?noredirect=1#comment34723798_21842945)中，有人报告说在快速连续单击/轻敲时轻敲的工作方式与单击的工作方式不同，并且使用下面的代码很容易重现，并且可以很容易地扩展到指针事件。

```
public sealed partial class MainPage : Page
{
    private int clicks = 0;
    private int taps = 0;
    public MainPage()
    {
        this.InitializeComponent();
        var button = new Button();
        button.Width = 500;
        button.Height = 200;
        button.Content = string.Format("Clicks: {0}, Taps: {1}", clicks, taps);
        button.Click += (s, e) => button.Content = string.Format("Clicks: {0}, Taps: {1}", ++clicks, taps);
        button.Tapped += (s, e) => button.Content = string.Format("Clicks: {0}, Taps: {1}", clicks, ++taps);
        this.Content = button;
    }
} 
```

`Click`是您应该在常规按钮上处理的内容。它具有按钮所期望的逻辑。我能想到的事情包括

*   它可以与键盘和鼠标一起使用
*   即使您按下按钮并缓慢释放它也可以工作
*   当您按下按钮时可以取消它，也可以在之前按下按钮后通过拖回它来恢复
*   它一次仅限于一个按钮，因此如果您尝试同时单击两个按钮 - 第一个触摸不会单击（与支持多用户交互的原始 Surface/PixelSense 不同！）
*   它可能更适用于自动化等功能以及 Windows 的辅助功能
*   它总是有效

如示例代码中所示 -`Tapped`如果您重复点击，该事件不会注册所有点击。我不确定这是否是因为某些底层手势识别逻辑看到了一些双击，或者出于任何其他原因简单地拒绝了其他所有点击。它适用于快速的单点触摸/笔点击或鼠标点击，但它是一个通用事件，您可以处理任何事件，`UIElement`如果您想区分点击、双击、右键点击 (!) 或按住任意 UI 元素，则可以使用它.

指针事件是较低级别的，您可以使用它们来处理框架中尚未内置的稍微高级的交互。正如我所提到的 - 单击包括按钮上发生的按下和伴随的释放，因此可以使用指针事件对类似的交互进行建模。例如，您可以使用它来实现某种类型的 Whac-A-Mole/Twister 组合类型的游戏，在其中您想要同时混合许多 UI 元素，而这是您无法通过点击完成的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-01-03T17:26:12.483

您应该使用 Click for Buttons（以及 ListView、Hyperlink、MenuFlyoutItem、ContentDialog 等）。Tapped 只是一个指针事件，因此如果您使用键盘、访问键或自动化，它不会被调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-08-22T15:14:49.770

我知道这是一个古老的主题，但是当它说**Click**和**Tapped**基本相同时，获胜的答案是不正确的。他们不是。如果您需要在控件中快速单击，Tapped 的**响应**速度与**Click**的响应速度不同。

在非常具体的场景中，比如在定制的数字键盘中，如果用户想要输入像 '11' 这样的值（点击同一个按钮两次），当你使用**Tapped**时，你经常会错过第二个字符，所以你会得到一个 ' 1'，而不是'11'。使用**Click**不会发生这种情况。

ps.：我用的是UWP

# c++ - 如何使用 QPainter 或 QPainterPath 在 Qt 中使用一个形状或一组连接的形状绘制自定义形状

> ID：13318572
> 
> 赞同：7
> 
> 时间：2012-11-10T02:09:08.283
> 
> 标签：c++, qt, qpainter

我怎样才能画出像眼泪一样的形状？我需要在不使用多个形状（椭圆和多边形）的情况下进行绘制，因为 QPen 将为每个形状绘制。我需要连接形状来创建一个新形状，或者告诉 QT 连接两个形状的边框，如下所示：

[![眼泪](../Images/44a45164faa38396f46eef13ea519336.png)](https://i.stack.imgur.com/tRyky.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-11T14:51:24.417

如果您要绘制的形状可以表示为其他形状的分层，就像您链接到的图像一样，这很容易做到：

首先，我们需要构建一个`QPainterPath`来表示形状的外边缘。我们通过将更简单的形状分层来构建它；在您的示例中，我们需要一个圆形和一个正方形。注意使用[`QPainterPath::setFillRule(Qt::WindingFill)`](http://doc.qt.digia.com/qt/qpainterpath.html#setFillRule): 这将影响路径的绘制方式（尝试删除它以查看差异！）。

```
QPainterPath OuterPath;
OuterPath.setFillRule(Qt::WindingFill);
OuterPath.addEllipse(QPointF(60, 60), 50, 50);
OuterPath.addRect(60, 10, 50, 50); 
```

在您给出的示例中，我们还需要从填充形状的中心移除一个圆形区域。让我们将内部“边界”表示为 a `QPainterPath`，然后使用[`QPainterPath::subtracted()`](http://doc.qt.digia.com/qt/qpainterpath.html#subtracted)它减去并`InnerPath`产生`OuterPath`我们的最终形状：

```
QPainterPath InnerPath;
InnerPath.addEllipse(QPointF(60, 60), 20, 20);

QPainterPath FillPath = OuterPath.subtracted(InnerPath); 
```

一旦我们建立了形状路径，我们需要使用它们来填充/勾勒形状。让我们首先创建一个`QPainter`并将其设置为使用抗锯齿：

```
QPainter Painter(this);
Painter.setRenderHint(QPainter::Antialiasing); 
```

然后我们需要填充我们构建的形状：

```
Painter.fillPath(FillPath, Qt::blue); 
```

最后，让我们画出轮廓。请注意，因为我们为内部和外部边界设置了不同的路径，所以我们可以用不同的线条粗细来描边每个边界。还要注意使用[`QPainterPath::simplified()`](http://doc.qt.digia.com/qt/qpainterpath.html#simplified): 这会将一组分层形状转换为一个`QPainterPath`没有交叉点的形状：

```
Painter.strokePath(OuterPath.simplified(), QPen(Qt::black, 1));
Painter.strokePath(InnerPath, QPen(Qt::black, 3)); 
```

* * *

如果我们把所有这些放在一起，它看起来像这样：

```
void Shape::paintEvent(QPaintEvent *)
{
  QPainterPath OuterPath;
  OuterPath.setFillRule(Qt::WindingFill);
  OuterPath.addEllipse(QPointF(60, 60), 50, 50);
  OuterPath.addRect(60, 10, 50, 50);

  QPainterPath InnerPath;
  InnerPath.addEllipse(QPointF(60, 60), 20, 20);

  QPainterPath FillPath = OuterPath.subtracted(InnerPath);

  QPainter Painter(this);
  Painter.setRenderHint(QPainter::Antialiasing);

  Painter.fillPath(FillPath, Qt::blue);
  Painter.strokePath(OuterPath.simplified(), QPen(Qt::black, 1));
  Painter.strokePath(InnerPath, QPen(Qt::black, 3));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-10T10:17:34.553

如果没有良好的数学背景，这实际上是相当困难的。如果您知道创建该形状的公式，则可以将其放入您的`QGraphicsItem::paint()`函数中。但也有一些替代方案：

1.  在像 Inkscape（免费）这样的矢量编辑程序中制作图像，将其保存为 .svg 文件，然后将其加载到[QGraphicsSvgItem](http://qt-project.org/doc/qt-4.8/qgraphicssvgitem.html)中。（这就是我会做的。）

2.  看看[QPainterPath::cubicTo()](http://doc.qt.digia.com/qt/qpainterpath.html#cubicTo)，它允许你制作贝塞尔曲线

# java - 为什么矩形跳跃的高度不同？

> ID：13318574
> 
> 赞同：1
> 
> 时间：2012-11-10T02:09:32.393
> 
> 标签：java, swing, animation, graphics, game-physics

为什么矩形跳跃的高度不同？它似乎进入了一个循环。首先它跳得很低，然后它根本不跳，然后它跳得很高，然后它根本不跳。我不知道为什么使用相同的代码并且它是由相同的事件触发的。

```
import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.event.KeyEvent;

import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.JFrame;
import javax.swing.JPanel;

@SuppressWarnings("serial")
 class Game extends JPanel{
Square square = new Square(this);
 Ground ground = new Ground (this);
public Game() {
    addKeyListener(new KeyListener() {
        @Override
        public void keyTyped(KeyEvent e) {
        }

        @Override
        public void keyReleased(KeyEvent e) {
            square.keyReleased(e);
        }

        @Override
        public void keyPressed(KeyEvent e) {
            square.keyPressed(e);
        }

    });
    setFocusable(true);
}
public static void main(String[] args) throws InterruptedException {

    JFrame frame = new JFrame("My Mario");
    Game game = new Game();
    frame.add(game);
    frame.setSize(600, 700);
    frame.setVisible(true);

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    while (true) {
        game.move();
        game.repaint();
        Thread.sleep(30);

    }

}
private void move() {

    square.move();
}
@Override
public void paint(Graphics g) {
    super.paint(g);
    Graphics2D g2d = (Graphics2D) g;
    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
    square.paint(g2d);
    ground.paint(g2d);
}
}

public class Square {

Square square;
int x,xa;
static int y;
int ya;
private Game game;
public static int fistX,fistY;
static int d = 60;
int wide;
boolean onGround;

public Square(Game game) {
this.game = game;
x = 100;
y = 631;
xa = 0;
ya = 0;
onGround = false;
wide = game.getWidth();
}

public void move() {

if (x + xa > 0 && x + xa < game.getWidth()-30)
    x = x + xa;

if (y + ya > 0 && y + ya < game.getHeight()-60){

    for(int i=12; i< 0; i--);
    ya+=10;
    y = y + ya;
}
if  (  collision()  ) {
    y-=10;
    onGround = true;

}

Square.y+=10;

}

public void paint(Graphics2D g) {
g.setColor(Color.RED);
g.fillRoundRect(x, y-d, 30, d, 10, 10);

}
private boolean collision() {
return game.ground.getBounds().intersects(getBounds());
}
public Rectangle getBounds() {
return new Rectangle(x, y, 30, 60);
}
public void keyReleased(KeyEvent e) {

if (e.getKeyCode() == KeyEvent.VK_LEFT)
xa=0;

if (e.getKeyCode() == KeyEvent.VK_RIGHT)
    xa=0;
if(e.getKeyCode() == KeyEvent.VK_DOWN)
    d = 60;

if(e.getKeyCode() == KeyEvent.VK_UP);

}

public void keyPressed(KeyEvent e) {
// TODO Auto-generated method stub
if (e.getKeyCode() == KeyEvent.VK_LEFT)

    xa = xa -3;

if (e.getKeyCode() == KeyEvent.VK_RIGHT)

    xa = xa + 3;

if(e.getKeyCode() == KeyEvent.VK_DOWN)
    d = 30;

if(e.getKeyCode() == KeyEvent.VK_UP)

        ya  -= 60;

}

}

class Ground {

    int y,x,h,w;
public Ground(Game game){
    x = 0;
    y = game.getHeight()-30;
    w = game.getWidth();
    h = 30;
}
public void paint(Graphics2D g){
    g.setColor(Color.BLACK);
    g.fillRect(0, 700, 99999999, 30);

}
public Rectangle getBounds() {
return new Rectangle(0, 700, 99999999, 30);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T03:11:42.540

1.  不要阻塞 EDT（事件调度线程）——当这种情况发生时，GUI 将“冻结”。而不是为重复的任务（如动画）调用`Thread.sleep(n)`实现 Swing 。有关更多详细信息，`Timer`请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)
2.  `frame.setSize(600, 700);`我建议改为为内容设置首选大小并围绕它打包框架。这表明在不同的 PLAF 或操作系统上游戏的大小是恒定的。
3.  对于顶级容器以外的 Swing 组件（例如`JFrame`或`JWindow`），覆盖`paintComponent(Graphics)`而不是`paint(Graphics)`.
4.  查看键绑定而不是 Swing 的键侦听器。

前 3 个已实现，最后一个（以及代码中注释的其他一个）是 TODO - BNI。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

class SuperMarioGame extends JPanel {

    private static final long serialVersionUID = 1L;
    Square square = new Square(this);
    Ground ground = new Ground (this);

    public SuperMarioGame() {
        // TODO Update to Key Bindings
        addKeyListener(new KeyListener() {
            @Override
            public void keyTyped(KeyEvent e) {
            }

            @Override
            public void keyReleased(KeyEvent e) {
                square.keyReleased(e);
            }

            @Override
            public void keyPressed(KeyEvent e) {
                square.keyPressed(e);
            }

        });
        setFocusable(true);

        // Use a listener/timer combo.
        ActionListener gameAnimation = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                move();
                repaint();
            }
        };
        Timer timer = new Timer(30,gameAnimation);
        timer.start();

        // Set a preferred size for the panel.
        Dimension preferred = new Dimension(600,700);
        this.setPreferredSize(preferred);
    }

    public static void main(String[] args) throws InterruptedException {
        JFrame frame = new JFrame("My Mario");
        SuperMarioGame game = new SuperMarioGame();
        frame.add(game);
        // Pack the frame to the preferred size.
        frame.pack();
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

    private void move() {
        square.move();
    }

    @Override
    // for Swing components, generally override 
    // paintComponent rather than paint
    //public void paint(Graphics g) {
    public void paintComponent(Graphics g) {
        super.paint(g);
        Graphics2D g2d = (Graphics2D) g;
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
        square.paint(g2d);
        ground.paint(g2d);
    }
}

class Square {

    Square square;
    int x,xa;
    static int y;
    int ya;
    private SuperMarioGame game;
    public static int fistX,fistY;
    static int d = 60;
    int wide;
    boolean onGround;

    public Square(SuperMarioGame game) {
        this.game = game;
        x = 100;
        y = 631;
        xa = 0;
        ya = 0;
        onGround = false;
        wide = game.getWidth();
    }

    public void move() {
        if (x + xa > 0 && x + xa < game.getWidth()-30)
            x = x + xa;

        if (y + ya > 0 && y + ya < game.getHeight()-60){
            for(int i=12; i< 0; i--);
            ya+=10;
            y = y + ya;
        }

        if  (  collision()  ) {
            y-=10;
            onGround = true;
        }

        Square.y+=10;
    }

    public void paint(Graphics2D g) {
        g.setColor(Color.RED);
        g.fillRoundRect(x, y-d, 30, d, 10, 10);
    }

    private boolean collision() {
        return game.ground.getBounds().intersects(getBounds());
    }

    public Rectangle getBounds() {
        return new Rectangle(x, y, 30, 60);
    }

    public void keyReleased(KeyEvent e) {
        // TODO Else-if would be better here..
        if (e.getKeyCode() == KeyEvent.VK_LEFT)
            xa=0;
        if (e.getKeyCode() == KeyEvent.VK_RIGHT)
            xa=0;
        if(e.getKeyCode() == KeyEvent.VK_DOWN)
            d = 60;
        if(e.getKeyCode() == KeyEvent.VK_UP);
    }

    public void keyPressed(KeyEvent e) {
        // TODO Else-if would be better here..
        if (e.getKeyCode() == KeyEvent.VK_LEFT)
            xa = xa -3;
        if (e.getKeyCode() == KeyEvent.VK_RIGHT)
            xa = xa + 3;
        if(e.getKeyCode() == KeyEvent.VK_DOWN)
            d = 30;
        if(e.getKeyCode() == KeyEvent.VK_UP)
            ya  -= 60;
    }
}

class Ground {

    int y,x,h,w;

    public Ground(SuperMarioGame game){
        x = 0;
        y = game.getHeight()-30;
        w = game.getWidth();
        h = 30;
    }

    public void paint(Graphics2D g){
        g.setColor(Color.BLACK);
        g.fillRect(0, 700, 99999999, 30);
    }

    public Rectangle getBounds() {
        return new Rectangle(0, 700, 99999999, 30);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-10T04:10:16.097

*   不要以任何方式阻塞事件调度线程，它会阻止 EDT 处理重绘请求（和其他事件），这会使你的程序看起来像是崩溃了。阅读[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)获取更多信息。
*   仅从 EDT 修改 UI，切勿从任何其他线程修改 UI，这包括创建 UI 元素
*   优先使用键绑定`KeyListeners`，它们更能解决焦点问题。阅读[如何使用键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)以获取更多详细信息
*   `paintComponent`更倾向于压倒一切`paint`。Paint 做了很多重要的工作，如果可以的话，你应该避免弄乱这些工作。除了其他任何东西之外，`paintComponent`组件的双缓冲中都将包含 as`paint`不是（`super.paint`设置它）
*   尽可能避免使用`static`状态变量
*   我不知道这是否是故意的，但是，`for (int i = 12; i < 0; i--);`不会有任何结果，因为最后的半科伦意味着，计数 1 什么也不做
*   就个人而言，尽量不要对宽度和高度之类的东西使用绝对值，这实际上依赖于父容器。您还应该在可能的情况下提供大小提示，以允许父容器更好地决定它实际需要多少空间

![在此处输入图像描述](../Images/732aa9bdfdce54b3df78c3fac1150374.png)

**更新**

修复了我的运动代码中的错误：P

我查看了您的碰撞检测代码（在 中`move`），坦率地说，无法对它做出正面或反面。我更正了它并改变了`paint`方法的工作方式，使 x,y 始终是左上角

```
public class TestGame {

    public static void main(String[] args) throws InterruptedException {
        new TestGame();
    }

    public TestGame() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                Game game = new Game();

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(game);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class GameThread extends Thread {

        private Game game;

        public GameThread(Game game) {
            setDaemon(false);
            this.game = game;
        }

        @Override
        public void run() {
            while (true) {
                game.move();
                try {
                    long startedAt = System.currentTimeMillis();
                    SwingUtilities.invokeAndWait(new Runnable() {
                        @Override
                        public void run() {
                            game.repaint();
                        }
                    });
                    long completedAt = System.currentTimeMillis();
                    long sleepFor = 30 - (completedAt - startedAt);
                    if (sleepFor < 0) {
                        sleepFor = 30;
                    }
                    Thread.sleep(sleepFor);
                } catch (Exception exp) {
                    exp.printStackTrace();
                }
            }

        }
    }

    public class Game extends JPanel {

        Square square = new Square(this);
        Ground ground = new Ground(this);

        public Game() {
//            addKeyListener(new KeyListener() {
//                @Override
//                public void keyTyped(KeyEvent e) {
//                }
//
//                @Override
//                public void keyReleased(KeyEvent e) {
//                    square.keyReleased(e);
//                }
//
//                @Override
//                public void keyPressed(KeyEvent e) {
//                    square.keyPressed(e);
//                }
//            });
            setFocusable(true);

            InputMap im = getInputMap(WHEN_IN_FOCUSED_WINDOW);
            ActionMap am = getActionMap();

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0, false), "press-left");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0, false), "press-right");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, false), "press-down");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, false), "press-up");

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0, true), "release-left");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0, true), "release-right");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, true), "release-down");
            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true), "release-up");    

            am.put("press-left", new PressLeftAction(square));
            am.put("press-right", new PressRightAction(square));
            am.put("press-down", new PressDownAction(square));
            am.put("press-up", new PressUpAction(square));

            am.put("release-left", new ReleaseLeftAction(square));
            am.put("release-right", new ReleaseRightAction(square));
            am.put("release-down", new ReleaseDownAction(square));
            am.put("release-up", new ReleaseUpAction(square));

            new GameThread(this).start();

//        public void keyReleased(KeyEvent e) {
//
//
//
//            if (e.getKeyCode() == KeyEvent.VK_LEFT) {
//                xa = 0;
//            }
//
//            if (e.getKeyCode() == KeyEvent.VK_RIGHT) {
//                xa = 0;
//            }
//            if (e.getKeyCode() == KeyEvent.VK_DOWN) {
//                d = 60;
//            }
//
//            if (e.getKeyCode() == KeyEvent.VK_UP);
//        }
//
//        public void keyPressed(KeyEvent e) {
//// TODO Auto-generated method stub
//            if (e.getKeyCode() == KeyEvent.VK_LEFT) {
//                xa = xa - 3;
//            }
//
//            if (e.getKeyCode() == KeyEvent.VK_RIGHT) {
//                xa = xa + 3;
//            }
//
//            if (e.getKeyCode() == KeyEvent.VK_DOWN) {
//                d = 30;
//            }
//
//            if (e.getKeyCode() == KeyEvent.VK_UP) {
//                ya -= 60;
//            }
//
//
//
//
//
//        }
        }

        public void move() {
            square.move();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        // Don't override paint, use paintComponent instead
//        @Override
//        public void paint(Graphics g) {
        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            square.paint(g2d);
            ground.paint(g2d);
            g2d.dispose();
        }
    }

    public class Square {

        Square square;
        private int x, xa;
//        static int y;
        private int y;
        private int ya;
        private Game game;
//        public static int fistX, fistY;
        private int fistX, fistY;
//        static int d = 60;
        private int d = 60;
        private int wide;
        private boolean onGround;

        public Square(Game game) {
            this.game = game;
            x = 100;
            y = 100;
            xa = 0;
            ya = 0;
            onGround = false;
            wide = game.getWidth();
        }

        public void move() {

            y += ya;
            x += xa;

            if (x < 0) {
                x = 0;
            } else if (x + 30 > game.getWidth()) {
                x = game.getWidth() - 30;
            }

            if (y < 0) {
                y = 0;
            } else if (collision()) {
                onGround = true;
                y = game.ground.getBounds().y - d;
            }

//            if (x + xa > 0 && x + xa < game.getWidth() - 30) {
//                x = x + xa;
//            }
//
//            if (y + ya > 0 && y + ya < game.getHeight() - 60) {
//                // This was never going to do anything, look at the
//                // end of the line...the `;` is going to prevent the
//                // statemt ya += 10 from begin called within the loop
////                for (int i = 12; i < 0; i--);
//                for (int i = 12; i < 0; i--) {
//                    ya += 10;
//                }
//                y = y + ya;
//            }
//            if (collision()) {
//                y -= 10;
//                onGround = true;
//
//            }
//
//            y += 10;

        }

        public void paint(Graphics2D g) {
            g.setColor(Color.RED);
            System.out.println(x + "x" + (y - d));
            g.fillRoundRect(x, y, 30, d, 10, 10);
        }

        private boolean collision() {
            return game.ground.getBounds().intersects(getBounds());
        }

        public Rectangle getBounds() {
            return new Rectangle(x, y, 30, 60);
        }
    }

    public class Ground {

        private Game game;

        public Ground(Game game) {
            this.game = game;
        }

        public void paint(Graphics2D g) {
            g.setColor(Color.BLACK);
            g.fillRect(0, game.getHeight() - 30, game.getWidth(), 30);
        }

        public Rectangle getBounds() {
            return new Rectangle(0, game.getHeight() - 30, game.getWidth(), 30);
        }
    }

    public abstract class AbstractSquareAction extends AbstractAction {

        private Square square;

        public AbstractSquareAction(Square square) {
            this.square = square;
        }

        public Square getSquare() {
            return square;
        }

    }

    public class PressLeftAction extends AbstractSquareAction {

        public PressLeftAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().xa = -3;
            System.out.println("pressLeft");
        }

    }

    public class PressRightAction extends AbstractSquareAction {

        public PressRightAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().xa = 3;
        }

    }

    public class PressDownAction extends AbstractSquareAction {

        public PressDownAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().ya = 30;
        }

    }

    public class PressUpAction extends AbstractSquareAction {

        public PressUpAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().ya -= 30;
        }

    }

    public class ReleaseLeftAction extends AbstractSquareAction {

        public ReleaseLeftAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().xa = 0;
        }

    }

    public class ReleaseRightAction extends AbstractSquareAction {

        public ReleaseRightAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().xa = 0;
        }

    }

    public class ReleaseDownAction extends AbstractSquareAction {

        public ReleaseDownAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().ya = 0;
        }

    }

    public class ReleaseUpAction extends AbstractSquareAction {

        public ReleaseUpAction(Square square) {
            super(square);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            getSquare().ya = 0;
        }

    }

} 
```

# windows - Extract SNMP community string on Windows XP

> ID：13318575
> 
> 赞同：1
> 
> 时间：2012-11-10T02:09:51.277
> 
> 标签：windows, service, snmp

I need to script a way to determine the SNMP community string on Windows XP hosts. Basically the command line equivalent to the GUI to examine the SNMP Service Properties.

I thought it may be in the registry, but even though community strings are commonly listed, those are not the actual string set by the GUI.

I'm looking for preferably an existing command line method, or ihow to code it. My task is to add a command to an script that runs periodically verifying a bunch of system configuration items, and now I need to add this as well.

# ios5 - Add UITextField to Navigation Controller's Toolbar as a Bar Button Item through stroryboard

> ID：13318584
> 
> 赞同：1
> 
> 时间：2012-11-10T02:10:41.370
> 
> 标签：ios5, uitextfield, uibarbuttonitem, uitoolbar, xcode-storyboard

I can do this programmatically but I don't prefer it that way. There's got to be some work-around for this. This is what my initial screen looks like:

![Initial Screen](../Images/1001b2dd9283db3a11fe8025a6293ddc.png)

To the toolbar, I dragged on a Bar Button Item and it fell into its proper place. Then i need a Text Field beside that. I dragged that from the library and dropped it beside the Bar Button item, and this is what I get:

![What I get](../Images/f7136657d1ee781a3f4c32e8e9fba350.png)

What am I missing here?

# topology - 如何使用 xbee zb 强制多跳拓扑？

> ID：13318585
> 
> 赞同：4
> 
> 时间：2012-11-10T02:11:06.540
> 
> 标签：topology, zigbee, xbee, mesh-network

我使用一些带有 zb 堆栈的 xbee (s2) 模块进行网状网络评估。因此，必须创建多跳环境。问题是，固件自己处理关联，并且无法像 api 提供的那样深入堆栈。为了强制数据的路径，而不干扰路由机制，我试图测量，我不得不把它们放在他们够不到的地方。只获得关联的下一跳并不是那么容易。我使用了最小功率级别的输出，但测试设置的距离很大，并且环境变化的射频特性未确定。

因此我的问题是，有人遇到过这个问题吗？

问候，托比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:24:20.427

我认为通过软件和协调器/路由器是不可能的。您可以更改节点加入时间 ( `ATNJ`) 以强制新路由器通过特定路由器加入（在除一个以外的所有节点上禁用节点加入），但这只会影响加入。一旦加入网络，路由器将发现其他节点在范围内。

你可以用昏昏欲睡的终端设备来做到这一点。您可以使用该`ATNJ`技巧强制终端设备通过单个路由器加入，并且它将始终将其消息发送到该路由器。但是你不会得到那么多跳——终端设备发送到它的父路由器，它发送到目标的父路由器，它发送到目标终端设备。

您可能需要在物理上限制无线电的范围以强制跳跃，正如您将 Digi 的 K-Node 测试设备与 1000 多个无线电网络链接的视频中所展示的那样。他们将无线电放在射频屏蔽盒中，并使用带有软件控制衰减器的有线天线连接将模块相互连接。

如果您有带有 U.fl 或 RPSMA 连接器的 XBee 模块，并且不连接天线，则应该会显着减小模块的范围。否则，使用线鞭或集成 PCB 天线，您需要将每个收音机放在某种会衰减信号的盒子中。也许其他人可以提供有关在不完全阻挡信号的情况下减小信号范围的材料的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T12:53:33.970

ZigBee 节点尝试自动形成 Ad-Hoc 网络。这就是为什么他们以当时可用的最强连接（最佳网络覆盖）加入网络。这些模块的设计方式使您不必太在意建立可靠的通信。他们将在大多数情况下解决网络问题。

你想做的，是以某种方式迫使不同的情况。你想创建一个特定的拓扑，以获得一些多跳。这不会是点头的正常行为。但是你仍然可以通过一些 AT 命令得到你想要的。

提到的命令“NJ”应该适合你。此命令在一定时间（以秒为单位）后锁定连接。让我们考虑一个具有三个节点的简单 ZigBee 网络：一个协调器、一个路由器和一个终端设备。打开协调器，将“NJ”设置为两分钟。然后快速打开Router，两分钟内就可以和Coordinator关联了。在这两分钟之后，Coordinator 将被锁定并且不会接受更多的加入。那时您可以启动终端设备，它必须与路由器相关联。这样，您将看到终端设备和协调器之间的消息按照您的意愿通过路由器。

您可能会多次应用此想法获得更大的网络，而无需使用模块的天线。您可以远程控制 AT 参数（即从连接到协调器的计算机），因此您可以使用一些代码来帮助您初始化网络。

# ruby - 需要帮助 多线程 SQL 处理

> ID：13318589
> 
> 赞同：0
> 
> 时间：2012-11-10T02:11:43.693
> 
> 标签：ruby, multithreading

我正在处理一个 SQL 表，但它有超过 20,000 行，所以它需要永远。

所以我在考虑有一个线程管理器：发送 10-20 个线程来处理 SQL 结果，然后在它们完成后再发送 10 个。我在数据库中有一个列来指示表是否已被处理。

我正在使用 Sequel 而没有 Rails。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:32:05.663

以下是如何在 ruby​​ 中创建 10 个线程并等待它们完成：

```
threads = []
0..10.times do 
  threads << Thread.new do
    processDb()
  end
end
threads.each { |t| t.join } # wait for thread to finish 
```

# ruby-on-rails - 通过 JSON 搜索以找到正确的“集合”，然后输出值

> ID：13318590
> 
> 赞同：0
> 
> 时间：2012-11-10T02:11:59.093
> 
> 标签：ruby-on-rails, ruby, json, hash

我目前正在尝试从网站的 API JSON 输出中提取信息。这是我所拥有的，它几乎可以完美运行：

```
def get_player_stats
  uri = URI("http://elophant.com/api/v1/euw/getPlayerStats?accountId=#{CGI.escape(@summoner.acctId)}&season=CURRENT&key=KEYID")
  resp = Net::HTTP.get_response(uri)
  hash = JSON(resp.body)

  solo_ranked_elo = hash['playerStatSummaries']['playerStatSummarySet'][2]['maxRating']
  puts solo_ranked_elo

end 
```

问题是 `['playerStatSummarySet'][1]`值会根据玩家而改变。因此，对于一个玩家，他们`maxRating`将在 set 中`[1]`，但另一名玩家`maxRating`将在 set 中`[6]`。

我需要搜索`RankedSolo5x5`值存在的集合，然后我可以输出`maxRating`. 我该怎么办？

这是我用来比较的两个示例文件：

[http://elophant.com/api/v1/euw/getPlayerStats?accountId=22031699&season=CURRENT&key=KEYID](http://elophant.com/api/v1/euw/getPlayerStats?accountId=22031699&season=CURRENT&key=KEYID)

[http://elophant.com/api/v1/euw/getPlayerStats?accountId=23529170&season=CURRENT&key=KEYID](http://elophant.com/api/v1/euw/getPlayerStats?accountId=23529170&season=CURRENT&key=KEYID)

我希望这足够清楚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:47:13.300

这是一个完整的例子

```
#!/usr/bin/env ruby

require 'net/http'
require 'uri'
require 'json'

uri = URI("http://elophant.com/api/v1/euw/getPlayerStats?accountId=#{ARGV[0]}&season=CURRENT&key=KEYID")
resp = Net::HTTP.get_response(uri)
stat_summary = JSON(resp.body)['playerStatSummaries']['playerStatSummarySet']

stat_summary.each_with_index do |obj, i| # it's this loop that answers your question
  next if obj['playerStatSummaryType'] != 'RankedSolo5x5'

  puts obj['maxRating']
  break
end 
```

`ARGV[0]`是 的命令行参数值`accountID`。您将上述内容保存到某个`max_rating`文件中，`chmod +x max_rating`然后运行

```
./max_rating 22031699       # Outputs 1421
./max_rating 23529170       # Outputs 1237 
```

# python - TypeError：期望一个可读的缓冲区对象

> ID：13318591
> 
> 赞同：3
> 
> 时间：2012-11-10T02:12:10.603
> 
> 标签：python, typeerror

当我尝试使用 GET 方法使用 M2Crypto HTTPSConnection 库连接到 API 时遇到以下错误。

```
Traceback (most recent call last):
  File "osg-gridadmin-cert-request", line 665, in <module>
    status = check_quota_limit(request_count)
  File "osg-gridadmin-cert-request", line 543, in check_quota_limit
    conn.request('GET', arguments['quotaurl'], headers)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py", line 941, in request
    self._send_request(method, url, body, headers)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py", line 975, in _send_request
    self.endheaders(body)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py", line 937, in endheaders
    self._send_output(message_body)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py", line 801, in _send_output
    self.send(message_body)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/httplib.py", line 773, in send
    self.sock.sendall(data)
  File "build/bdist.macosx-10.7-intel/egg/M2Crypto/SSL/Connection.py", line 217, in write
    return self._write_nbio(data)
  File "build/bdist.macosx-10.7-intel/egg/M2Crypto/SSL/Connection.py", line 202, in _write_nbio
    return m2.ssl_write_nbio(self.ssl, data)
TypeError: expected a readable buffer object 
```

我正在使用此代码访问 API

```
conn = M2Crypto.httpslib.HTTPSConnection(arguments['host'],
            ssl_context=ssl_context)
        conn.request('GET', arguments['quotaurl'], headers)
        response = conn.getresponse() 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:46:53.063

查看错误信息

```
self._send_request(method, url, body, headers) 
```

这表明您正在传递“标题”，您应该传递“正文”。

所以，试着打电话

```
conn.request('GET', arguments['quotaurl'], None, headers) 
```

# php - Passing two arrays in a jQuery .post() , how do I catch this data in PHP and use it there?

> ID：13318593
> 
> 赞同：0
> 
> 时间：2012-11-10T02:12:29.667
> 
> 标签：php, jquery, ajax, arrays

I'm making a jQuery .post() with the following arrays:

```
'cleanedLinkStructureArray[]': cleanedLinkStructureArray,
'cleanedPermaLinkArray[]': cleanedPermaLinkArray 
```

**The data inside these arrays:** cleanedPermaLinkArray looks like this: ["2012","10","30","hello-world"] and cleanedLinkStructureArray like this: ["year","monthnum","day","postname"]

**Javascript code:**

```
var ajaxPost = $.post(
            enableAJAX.ajaxurl, 
            { action: 'ajaxRequest',
            'ajaxRequestNonce' : enableAJAX.ajaxRequestNonce,
            'cleanedLinkStructureArray[]': cleanedLinkStructureArray,
            'cleanedPermaLinkArray[]': cleanedPermaLinkArray },
            'json'
    );

    ajaxPost.done(function(responseText) { 
        alert(responseText);
        console.log(responseText);
    }); 

    ajaxPost.fail(function() { 
        alert("Oops, I'm afraid we've broken something");
    }); 
```

I don't understand how I catch the two arrays in PHP? and use the data from the arrays inside PHP? Preferably I would create new PHP array with them, where the values inside cleanedLinkStructureArray become the keys for the array and the values inside cleanedPermaLinkArray the values for that new array.

I guess it must be something with this, but I need someone more experienced to tell me what I need to do here.

```
$_POST['cleanedPermaLinkArray[]']
$_POST['cleanedLinkStructureArray[]']; 
```

Any help would be appreciated.

Kind regards,

Marnix

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T02:20:43.067

你的数组将在

```
$_POST['cleanedPermaLinkArray']
$_POST['cleanedLinkStructureArray']; 
```

你可以做一个简单`var_dump($_POST)`的看看数据是如何形成的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T02:23:45.880

首先，在 $.post 中，您不需要方括号，因此这是您的参数之一：

```
'cleanedLinkStructureArray': cleanedLinkStructureArray, 
```

然后在 PHP 中，您必须首先像这样捕获它：

```
$cleanedLinkStructureArray = $_POST["cleanedLinkStructureArray"]; 
```

现在，您可以使用以下内容：

```
foreach ($cleanedLinkStructureArray as $item) {
    // Do something with $item
} 
```

另一种方法是将所有参数从 $.post 传递给 php 将它们设置为 json 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T02:15:09.490

This is all coming down from the server as JSON, right? Just use `json_decode` on the values and the'll be converted to arrays, natively inside of php.

```
$cleanedPermaLinkArray = json_decode($_POST['cleanedPermaLinkArray[]']);
echo cleanedPermaLinkArray[0]; // some value.. 
```

# c++ - C++ - How do I append a char to a char[]?

> ID：13318594
> 
> 赞同：2
> 
> 时间：2012-11-10T02:12:43.803
> 
> 标签：c++, arrays, string, char

I am trying to append a char to the end of a char array:

```
char szBuffer[MAX_PATH];
if(SHGetSpecialFolderPathA(HWND_DESKTOP, szBuffer, CSIDL_PERSONAL, FALSE)){
    szBuffer[sizeof(szBuffer)] = "\\";
} 
```

I know that will not work correctly, but I am unsure how to do it. Also, how would I append a string?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T02:14:40.710

You can use [`strcat`](http://www.cplusplus.com/reference/clibrary/cstring/strcat/), like this:

```
strcat(zsBuffer, "\\"); 
```

This assumes that `MAX_PATH` has enough space to fit the string with the appended character.