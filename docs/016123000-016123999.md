# StackOverflow 问答 16123000-16123999

# python - SQLite3 OperationalError：表 XYZ 没有名为 ABC 的列

> ID：16123010
> 
> 赞同：0
> 
> 时间：2013-04-20T17:11:59.047
> 
> 标签：python, sqlite, peewee

我是peewee的新手，所以如果这是一个愚蠢的问题，请原谅我。我在谷歌和 peewee 食谱上搜索过，但到目前为止没有找到解决方案。

所以，我的四个数据库表有以下模型：

```
class games_def(Model):
    id = PrimaryKeyField()
    name = TextField()
    class Meta:
        database = dbmgr.DB

class users_def(Model):
    id = PrimaryKeyField()
    first_name = TextField()
    last_name = TextField()
    class Meta:
        database = dbmgr.DB

class sessions(Model):
    id = PrimaryKeyField()
    game = ForeignKeyField(games_def, related_name = 'sessions')
    user = ForeignKeyField(users_def, related_name = 'sessions')
    comment = TextField()
    class Meta:
        database = dbmgr.DB

class world_states(Model):
    session = ForeignKeyField(sessions)
    time_step = IntegerField()
    world_state = TextField()
    class Meta:
        database = dbmgr.DB 
```

使用这些模型，我通过 peewee 连接到 SQLite3 数据库，效果很好。建立连接后，我在我的主要 Python 代码中执行以下操作：

```
models.world_states.create(session = 1, time_step = 1) 
```

但是，这给了我以下错误：

```
sqlite3.OperationalError: table world_states has no column named session_id 
```

这基本上是正确的，表 world_state 确实不包含这样的列。
但是，我在我的代码中根本找不到对“session_id”的任何引用。

peewee 想使用那个“session_id”列名？
我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:28:37.563

当您指定`ForeignKeyField()`peewee 时，希望使用`_id`基于他们自己的名称结尾的列。因此，您的`wold_states.session`字段会产生一个名为 的列`session_id`。

您可以通过设置`db_column`该字段来覆盖它：

```
class world_states(Model):
    session = ForeignKeyField(sessions, db_column='session') 
```

# sql - SQL 非空行的百分比

> ID：16123012
> 
> 赞同：1
> 
> 时间：2013-04-20T17:12:09.017
> 
> 标签：sql, sum

我有一排显示包机旅行的副驾驶，不是每个包机旅行都有副驾驶。

我很难弄清楚如何去做。

我想我必须得到该行中不为空的值的计数（意味着有一个 copliot），然后将其除以总数。我不知道如何划分它，我将如何获得该行中的总行数。我可以对其进行硬编码，但如果将更多数据输入数据库，那将无济于事。

有没有办法只计算该行中的列数？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T17:51:01.710

在标准 SQL 中，您可以执行以下操作：

```
select (100.0*count(copilot))/count(*)
from t 
```

在 SQL 中，表达式`count(copilot)`计算非 NULL 值的数量。表达式`count(*)`是总行数。

在某些版本的 SQL 中，将两个整数相除会产生一个整数。所以，1/2 = 0，而不是 0.5。为了确保非整数除法，“100”被表述为非整数常数，而不是`100`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:26:57.730

```
select count(copilot is not null)*100/count(*) as copilot_percent
from charters 
```

您的问题似乎表明表中有多个副驾驶列。首先，这表明糟糕的数据库设计——您应该通过将数据库移动到它们自己的依赖表中来规范化它们。但在这个设计中，你会这样做：

```
select count(copilot1 is not null and copilot2 is not null and copilot3 is not null ...)*100/count(*) as copilot_percent
from charters; 
```

# c++ - 从文件中读取整数 - 逐行

> ID：16123013
> 
> 赞同：4
> 
> 时间：2013-04-20T17:12:31.800
> 
> 标签：c++

如何从文件中读取整数到 c++ 中的整数数组？因此，例如，此文件的内容：

```
23
31
41
23 
```

会成为：

```
int *arr = {23, 31, 41, 23}; 
```

?

我实际上有两个问题。首先是我真的不知道如何逐行阅读它们。对于一个整数来说，这很容易，只`file_handler >> number`需要语法就可以了。我该如何逐行执行此操作？

第二个对我来说似乎更难克服的问题是——我应该如何为这个东西分配内存？:U

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:15:52.440

```
std::ifstream file_handler(file_name);

// use a std::vector to store your items.  It handles memory allocation automatically.
std::vector<int> arr;
int number;

while (file_handler>>number) {
  arr.push_back(number);

  // ignore anything else on the line
  file_handler.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T17:33:55.587

不要使用数组使用向量。

```
#include <vector>
#include <iterator>
#include <fstream>

int main()
{
    std::ifstream      file("FileName");
    std::vector<int>   arr(std::istream_iterator<int>(file), 
                           (std::istream_iterator<int>()));
                       // ^^^ Note extra paren needed here.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:24:31.480

这是一种方法：

```
#include <fstream>
#include <iostream>
#include <iterator>

int main()
{
    std::ifstream file("c:\\temp\\testinput.txt");
    std::vector<int> list;

    std::istream_iterator<int> eos, it(file);

    std::copy(it, eos, std::back_inserter(list));

    std::for_each(std::begin(list), std::end(list), [](int i)
    {
        std::cout << "val: " << i << "\n";
    });
    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:17:48.857

你可以用`file >> number`这个。它只知道如何处理空格和换行符。

对于可变长度数组，请考虑使用`std::vector`.

此代码将使用文件中的所有数字填充向量。

```
int number;
vector<int> numbers;
while (file >> number)
    numbers.push_back(number); 
```

# html - 响应式图像和媒体查询

> ID：16123014
> 
> 赞同：2
> 
> 时间：2013-04-20T17:12:32.020
> 
> 标签：html, css, responsive-design

我有点确定这是不可能的，但我问是因为这似乎令人难以置信。

我有一些用于响应式设计的元素

```
img {max-width:100%;height:auto;} 
```

但图像必须因设备而异（我不会在手机设备上加载宽屏图像）。

由于不支持内联媒体查询，我可以使用 css 背景解决方案，但 background-size 没有得到完全支持，老实说，它看起来更像是一个 hack。

任何人都可以确认“广泛支持的与设备相关的响应图像”是不可能的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T20:39:49.983

如果我正确理解您的问题，您正在寻找一种根据视点提供不同图像的方法。

[自适应图像](http://adaptive-images.com/)可能是您正在寻找的解决方案。很容易设置和确认。

第二种可能会给您更多控制权的是[Adapt.js](http://adapt.960.gs)。我已经在几个网站上成功地使用了它。您在文档的头部加载了一个小的 javascript 文件。这会测试视点宽度，然后根据结果，它将发送适当的 CSS 文件。它比@media 请求具有更广泛的浏览器支持。

如果您可以使用背景图像，那么它会很好地工作，并且由于您可以为不同的视点指定不同的图像，因此您不会使用不了解背景图像大小的浏览器。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:38:06.917

我没有确认任何事情。jquery/javascript 什么都不是。

但事实是，响应式设计有其自身的缺点。换句话说，定义响应式设计是在具有大浏览器分辨率的设备中显示所有内容，并使用 dsiplay:none 以较低的分辨率隐藏某些`CSS`内容。问题是 display:none 不会阻止元素的加载。简而言之，也许没有 CSS解决方案。而且由于响应式设计是关于 CSS 的............

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T16:31:24.257

**2014 年更新**

这里有一个很好的新技术：http: [//filamentgroup.com/lab/responsive_images_experimenting_with_context_aware_image_sizing/](http://filamentgroup.com/lab/responsive_images_experimenting_with_context_aware_image_sizing/)

它需要一个小 js、一个 1x1px 的空白图片、一些额外的 img 标签标记和一些 .htaccess 规则。

到目前为止似乎工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T14:06:07.390

你可以试试[Responsive Img jQuery plugin](http://responsiveimg.com)。

它可以根据容器的宽度在不同的断点处自动创建和交换不同大小的图像。

如果您在创建的图像和服务器上已经有不同的版本，该插件只会在正确的断点大小处交换这些版本。

因此，您可以为所需的所有不同断点大小创建新图像，其余的由插件处理。

它不是 CSS，但它完成了工作。

# android - Android 通知生成器 getNotification() 与 build()

> ID：16123021
> 
> 赞同：5
> 
> 时间：2013-04-20T17:12:59.680
> 
> 标签：android, notifications

根据我看到的文档，Android 通知生成器是在 API 11 中引入的，并且：

*   在 API 11 到 API 15 中，使用方法 .getNotification() 来创建通知对象
*   从 API 16 开始，使用 .build() 创建通知对象。

这听起来很简单，但是如何在 Eclipse 中编写代码，根据 API 版本调用正确的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-20T17:46:52.847

如果您的应用支持 API 级别 11 之前的设备，您应该使用`NotificationCompat.Builder`，在这种情况下，您可以一直使用`build()`。

否则，欢迎您致电`getNotification()`，直到您愿意仅支持 API 级别 16 及更高级别。他们只是简单地重命名了该方法以提高一致性。如果您查看[源代码](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/app/Notification.java)，只需在较新的设备上`getNotification()`调用。`build()`

使用 Raghav 的方法没有任何问题，而且在其他存在 API 级别差异的情况下将需要这种技术。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-20T17:14:51.650

您可以在运行时检查 API 级别。

```
if (android.os.Build.VERSION.SDK_INT>=android.os.Build.VERSION_CODES.JELLY_BEAN) {
  // call something for API Level 16+
} else if (android.os.Build.VERSION.SDK_INT>=android.os.Build.VERSION_CODES.HONEYCOMB) {
  // call something for API Level 11+
} 
```

# knockout.js - 如何使用淘汰数据表扩展更新已编辑行的值？

> ID：16123022
> 
> 赞同：1
> 
> 时间：2013-04-20T17:13:04.350
> 
> 标签：knockout.js

我使用敲除扩展在数据表中加载超过 1000 行。im 使用 map.fromjs 将这些项目映射到可观察数组中，它确实减慢了页面的初始加载速度。

为了避免这种缓慢的初始加载，我尝试将可观察数组设置为仅填充普通 json 对象，这意味着数组中包含的 1000 多个对象是不可观察的。

但是由于对象是不可观察的，因此当对普通对象进行编辑时，由于没有绑定，因此在数据表网格中看不到更改。有没有办法让 ui 改变以适应普通编辑的 json 对象的新值？

我什至尝试从可观察数组中删除已编辑的对象并读取它但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:44:20.743

您应该将每个项目的每个可编辑属性设置为可观察的。例如：

```
self.items = ko.observableArray(ko.utils.arrayMap(
    datasource,
    function(row){
        return {
            id: row.id,
            title: ko.observable(row.title)
        };
    }
)); 
```

*不要关心成千上万的对象；这个数额不是很大。*

看看它是如何与 2,500 个 obj 一起工作的：http: [//jsfiddle.net/HfzvG/](http://jsfiddle.net/HfzvG/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-22T18:32:20.713

2500 个对象并不多... imo... 但是，我有一个项目试图用 90,000 + 行来执行此操作，它实际上杀死了 chrome... 解决方案是服务器端分页... 我创建了淘汰赛绑定分页这将要求每页少量的行。这些参数是在我的存储过程中处理的。您也可以使用服务器端语言处理分页参数。这需要更多的服务器访问，但权衡是非常值得的。

这里有一些 SQL 代码...

```
declare @rowCount int = 25;

Select MainSearchWithRowNumbers.*       
FROM
(SELECT
    ROW_NUMBER() OVER () As RowNumber
    ,Count(*) OVER () as TotalRows
    ,CEILING(CAST(Count(*) OVER () as FLOAT) / CAST(@rowCount as FLOAT)) AS TotalPages
    ,*
FROM
    (
     SELECT 
        -- ROW_NUMBER() OVER (ORDER BY CarcassRemovalId) AS AbsRowNumber
        Count(*) OVER () AS AbsTotalRows
        ,CEILING(CAST(Count(*) OVER () AS FLOAT) / CAST(@rowCount AS FLOAT)) AS AbsTotalPages
        ,*
     FROM YOURTABLE) 
    ) as MainSearch
) as MainSearchWithRowNumbers
WHERE
    (@page is null)
     or (
                (RowNumber <= @page * @rowCount)
            and (RowNumber > (@page - 1) * @rowCount)
    ) 
```

# mysql - 存储可以按距离查询的位置的最佳方法是什么？

> ID：16123026
> 
> 赞同：0
> 
> 时间：2013-04-20T17:13:32.070
> 
> 标签：mysql, hibernate, location

我想实现一个功能，其中可以按与用户位置的距离排序显示附近场所的列表。我现在采用的方法是将 lat 和 lon 值存储为浮点数，并进行查询以查找用户位置的 +/- 值（搜索向北、南、东和西延伸的正方形用户）。然后我对结果集进行快速计算，确定我的业务逻辑中的距离和排序。现在我从主要使用关系数据库的人的角度来处理这个问题（该应用程序正在运行带有 Hibernate 的 MySQL），但是是否有更好的方法（在 Neo4J 等不同的数据库中或使用更好的列类型？）

此外，我的方法对于 0 lat 或 0 lon 或附近的查询有一个半复杂的解决方法）。

至于我对最优的工作定义，我正在寻找可扩展到 10 英里半径范围内的数百个场馆和总共数十万个场馆的方法。换句话说，大约是 SimpleGEO 的 1%，所以如果这个问题的规模不需要最佳解决方案，那么“你没事”也将是一个有趣的答案，尽管我很想知道为什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:36:32.313

你期待 Hibernate Spatial 吗？

Hibernate Spatial 是 Hibernate 的通用扩展，用于处理地理数据。并且 HS 有 MySQL Provider。

[http://www.hibernatespatial.org/](http://www.hibernatespatial.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:17:33.087

MongoDB 具有对地理空间索引的原生支持和对查询语言的扩展，以支持许多不同的查询地理空间文档的方式。

但是，如果您正在寻找关系数据库，请尝试使用 PostGIS 的 PostgreSQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:45:27.380

你可以看看 Lucene/Solr。[Lucene](http://www.ibm.com/developerworks/java/library/j-spatial/)至少从 v2.9 开始支持位置感知搜索。

如果您担心 Lucene 的复杂性，可以使用[Hibernate Search](http://www.hibernate.org/subprojects/search.html)，它旨在将所有数据库更改透明地复制到 Lucene。

# python - Python ConfigParser 模块找不到部分

> ID：16123027
> 
> 赞同：2
> 
> 时间：2013-04-20T17:13:35.730
> 
> 标签：python, parsing, config

我正在使用 Python 2.6 写入一个名为 config.ini 的 .ini 文件。这是我的代码：

```
def saveConfig(self, selection, value, bool):
    Config = ConfigParser.RawConfigParser()
    Config.read("config.ini")
    Config.set(selection, value, bool)
    with open('config.ini', 'w') as configfile:
        Config.write(configfile) 
```

到目前为止还可以，但是当我运行我的脚本时（因此函数`self.saveConfig('Config', 'testoption', 'True')`，我得到了 NoSectionError 异常：

> ConfigParser.NoSectionError：没有部分：“配置”

这看起来很奇怪，因为我实际上有这个部分。

这是我的 config.ini 文件：

```
[Config]
version = 0.1-unstable
testoption = False
testbool = True 
```

我可以使用 .get() 方法读取它们的值，但不能设置不同的值。想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:42:26.113

你的代码对我有用。

但是，`RawConfigParser`'s`read()`方法有点奇怪，因为如果找不到文件，它不会引发异常 - 而是返回它设法读取的文件的列表。

尝试这样的事情......

```
def saveConfig(self, selection, value, bool):
    Config = ConfigParser.RawConfigParser()
    if not Config.read("config.ini"):
        raise IOError, 'cannot load config.ini'
    Config.set(selection, value, bool)
    with open('config.ini', 'w') as configfile:
        Config.write(configfile) 
```

# python - Python：套接字连接仍然打开

> ID：16123028
> 
> 赞同：1
> 
> 时间：2013-04-20T17:13:39.197
> 
> 标签：python, sockets, bots, irc

我在这里阅读了一些关于这个主题的问题，但我无法得到一个简单的答案。我将提供一些代码，以便更容易。

```
import socket

irc = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )

irc.connect((network, port))

# Do the rest of the connection (set nick, user, join chan)
# Okay, now we're connected

while True:

    doAllTheBotStuff() 
```

我有一个`!quit`打破`while True:`循环的命令。但有时我会因为其他原因断开连接，比如 ping 超时，或者我的互联网崩溃。我想做的是：

```
while True:

    doAllTheBotStuff()

    if not stillConnected():
        break 
```

我该怎么做这个`stillConnected()`功能？

* * *

读/写：

我为我的机器人做了一个类，但希望你能在没有所有这些信息的情况下理解它

```
# READING 

ready = select.select([self.irc], [], [], 1)
if ready[0]:
    temp = self.irc.recv(4096)
    # Here I handle the reading. Parse commands and all that stuff. 
```

写作总是对所读内容的回应。我使用这个功能：

```
def send_irc_cmd(self, cmd, args):
    self.irc.send(cmd+" :"+args+"\r\n") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:51:49.460

我*认为*你需要做的就是在行后添加一些东西......

```
temp = self.irc.recv(4096) 
```

...检查是否`temp`为空字符串，这表明远程主机已关闭连接，并使用它来打破你的循环。

我真的不能更准确或更具体，因为您的代码示例不完整，和/或实际代码的简化。

# javascript - 如何从内部函数访问函数参数？

> ID：16123029
> 
> 赞同：0
> 
> 时间：2013-04-20T17:13:43.803
> 
> 标签：javascript, node.js

如何访问 function .exec(function(err, repl) { 中的响应参数？是否可以不创建局部变量？

```
#!/usr/local/bin/node

// Load the http module to create an http server.
var http = require('http');
var redis = require('redis');
var client = redis.createClient();

// Configure our HTTP server to respond with Hello World to all requests.
var server = http.createServer(function (request, response) {
  response.writeHead(200, {"Content-Type": "text/plain"});
  client.multi([
    ['get', 'a'],
    ['get', 'b']
  ]).exec(function(err, repl) {
    console.log(err);
    console.log(repl[0]);
    response.end('Repl: ' + repl[0].toString());
  });
});

// Listen on port 8000, IP defaults to 127.0.0.1
server.listen(8000);

// Put a friendly message on the terminal
console.log("Server running at http://127.0.0.1:8000/"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:23:35.323

只需访问它。参数被自动视为局部变量，内部函数可以访问其包含函数的局部变量（除非它用自己的同名变量隐藏它们）。

# javascript - 你将如何在 JavaScript 中编写 Date 对象？

> ID：16123034
> 
> 赞同：2
> 
> 时间：2013-04-20T17:14:24.417
> 
> 标签：javascript, date

Date 对象可能很好地说明了如何在 JavaScript 中创建对象。它有太多的方法使它成为一个简洁的例子，但我想看看如何构建这样一个对象的框架。

让我们假设有一个裸机值，称为 ClockTick 或类似的东西，它返回毫秒。

因此 Date 对象同时用作 getter：

```
function Date() {
   return ClockTick;
} 
```

和一个二传手：

```
function Date(milliseconds) {
} 
```

重载：

```
function Date(year, month, day, hours, minutes, seconds, milliseconds) {
} 
```

问：如果不详尽，假设还没有内置 Date 对象，您将如何在 JavaScript 中编写 Date 对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:41:18.663

对于您提供的基本示例，您基本上要检查两件事：

1.  `Date`作为构造函数调用，`new`或直接调用。
2.  传递了多少个参数。

我可能会做这样的事情：

```
function Date(year, month, day, hours, minutes, seconds, milliseconds){
    if (!(this instanceof Date)){
        // If 'this' is not a Date, then the function was called without 'new'.
        return /* current date string */
    }
    if (arguments.length === 0) {
        // Populate the object's date with current time
    } else if (arguments.length === 1){
        // Populate the object's date based on 'arguments[0]'
    } else {
        // Populate the object's date based on all of the arguments
    }
} 
```

至于表示实际的日期值，这完全取决于您。仅定义了外部接口，因此您可以将其存储为时间戳，或单独的日/月/年值等。

在存储值方面，您有几个选择：

1.  您可以将值存储在自身上`this`，并添加 on 的所有方法。这种方法可能更快，因为函数都在原型上共享，因此它们不会被重新创建，但这意味着必须存储值，这意味着它们将对使用您的类的人公开可见。`Date``Date.prototype``this`

2.  您可以将值存储在日期构造函数内的第二个对象上，然后将所有`Date`函数分配到`this`构造函数内，捕获对日期值对象的引用。这有隐藏内部值的好处，但意味着您需要为创建的每个新`Date`对象重新创建函数。

例如

```
function Date(...){
   this.dayPrivate = day;
}

Date.prototype.getDay = function(){
   return this.dayPrivate;
}; 
```

对比

```
function Date(...){
    this.getDay = function(){
       return day;
    };
} 
```

# ruby-on-rails-3 - 输入元素的 SimpleForm 自定义标题

> ID：16123037
> 
> 赞同：0
> 
> 时间：2013-04-20T17:14:28.833
> 
> 标签：ruby-on-rails-3, simple-form

如何将我自己的名字添加到输入中，例如文本框？即如何自定义输入旁边显示的输入名称？

这是我的代码：

```
- title "Add a NEO"

= simple_form_for @neo do |f|
    = f.input :name
    br
    - for obs in @observations do
        = simple_form_for obs do |o|
            table 
                tr
                    td = o.input :ra
                    td = o.input :dec
    = f.button :wrapped, "Create NEO" 
```

我想为`o.dec`和指定文本`o.ra`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:20:02.980

```
- title "Add a NEO"

= simple_form_for @neo do |f|
    = f.input :name
    br
    - for obs in @observations do
        = simple_form_for obs do |o|
            table 
                tr
                    td = o.input :ra, :label => "Right Ascension"
                    td = o.input :dec, :label => "Declination"
    = f.button :wrapped, "Create NEO" 
```

# php - 使用 Jquery 和 Ajax 动态填充表单

> ID：16123046
> 
> 赞同：1
> 
> 时间：2013-04-20T17:15:12.243
> 
> 标签：php, javascript, forms, zend-framework, dynamic

我在实现我想要做的事情时遇到了一点问题。

我正在做一个类似页面的邮箱，我想添加一个“响应”按钮，它将用一些值填充表单。

我正在通过 php 中的消息生成我的页面消息。对于每条消息，我都会生成一个带有自己 ID 的输入按钮，当我单击该按钮时，我想在新窗口中打开一个表单，其中预先填写了收件人和标题，用户不可更改，另一个文本区域是用户可以填写他的消息。

为此，我有一个包含 3 个值（收件人、标题和消息）的表单的通​​用模板。所有（目前）都是 text 或 textarea 值。

是否可以使用一个表单向任何人发送消息，或者我是否必须为每条消息生成一个带有预填充值的表单？最后一个解决方案似乎很可怕。

我试图找到只用 javascript 就能做的事情，因为我希望表单由 Ajax 异步提交。我可以创建一个 onClick 事件并将值传递给该函数，但在这种情况下，我将没有用户将输入的 textarea 的值。

有没有一种方法可以做，例如，在 Javascript 中使用我将通过 onClick 事件传递的值的整个表单，从使用这些值填充的表单中获取 textarea 的值，然后通过发送所有内容阿贾克斯？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T22:44:25.297

好吧，这就是我所做的。

对于生成的每个响应按钮，我设置了一个 onClick 事件，将我想在表单中预填充的字段传递给 JS 函数 RespondMessage()

我还在页面底部制作了一个用 CSS 隐藏的表单。此表单包含尽可能多的隐藏字段，因为我想要预填充的数据，以及尽可能多的跨度，因为我想显示信息。

当我调用 RespondMessage 函数时，我使用调用该函数的参数手动设置表单中的隐藏字段。之后，我用我想要显示的信息填充我的跨度（例如，我为我的消息设置了收件人的姓名）。

完成所有这些后，您的表单就可以显示了。所以在表单中设置好字段后，我只是将表单从 display:none 传递到 display:block，并做了很多 css 技巧来使其流畅和美观。

因此，现在您有了预填充的表单，您只需要另一个函数来进行 Ajax 调用以避免在每次响应后重新加载页面，并且您将使用表单提交按钮的 onClick 事件调用它。

我希望这个过程对某人有所帮助。

我不太确定这是不是最好的方法，而且我觉得它很脏而且很容易被利用，所以你需要比平时更多的服务器端检查，但它确实可以完成工作。

我不提供代码，因为它几乎都是特定于您正在设置的应用程序的。

# javascript - 文本！=“”是什么意思？

> ID：16123052
> 
> 赞同：0
> 
> 时间：2013-04-20T17:15:54.313
> 
> 标签：javascript, string, while-loop

这是来自 Eloquent Javascript 的第 6 章：

**代码：**

```
 function splitParagraph(text) {
     var fragments = []; 
     while( text != "" )                         // ?
         if (text.charAt(0) == "*") {
               fragments.push({type: "emphasized"});

 etc... 
```

我无法理解 while 循环在做什么。*文本*是一个字符串。while 循环是否读取“while 文本没有剩余任何字符..” while 循环是否一个接一个地查看字符串中的每个字符以确保还有另一个字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T17:17:29.220

当`while`内部条件为真时，循环继续运行。在这种情况下，`text != ""`如果所讨论的字符串不是空字符串，则为 true。

在这种特殊情况下，我想必须在循环内的某个地方进行更改，否则在这里使用构造`text`是没有意义的。`while`

**注意**：实际上，在 JavaScript 中，`!=`and`==`运算符会以一种非常奇怪的方式求值：例如， 0`[]`和将被认为是相等的：`""`

*   `"" != []`-> 假的
*   `0 != []`-> 假的
*   `0 != ""`-> 假的

`===`并可`!==`用于强制执行严格相等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:17:37.570

它检查文本是否不是空字符串（长度为 0 且不包含字符）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:27:07.537

```
"Is the while loop looking at every character in the string 
one by one making sure there is another character left?" 
```

是的，尽管没有显示整个循环，但这几乎可以肯定是正在做的事情。

while 条件检查`text`字符串是否为空。如果不为空，则循环遍历循环体。检查字符串的`text.charAt(0)`第一个字符。如果找到“*”字符，则将一个元素添加到`fragments`数组中。

在正文中将有代码删除字符串的第一个字符，`text`然后循环处理字符串的下一个字符。

```
while( text != "" )                        
         if (text.charAt(0) == "*") {
               fragments.push({type: "emphasized"}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:22:27.553

> 文本！=“”是什么意思？

这意味着如果 的值`text`不能被强制匹配`""`

考虑这段代码

```
if ("abc" != "") {
    console.log("1 ok");
}

if ([] != "") {
    console.log("2 ok");
}

if (0 != "") {
    console.log("3 ok");
}

if (false != "") {
    console.log("4 ok");
} 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/2Cr7g/)

天哪，案例 2、3 和 4 发生了什么？

# java - 在 Eclipse 中安装 Android 开发者工具时出错

> ID：16123055
> 
> 赞同：1
> 
> 时间：2013-04-20T17:16:23.387
> 
> 标签：java, android, eclipse, eclipse-adt

我尝试使用此[url](https://dl-ssl.google.com/android/eclipse/)安装 ADT 。但我得到了错误。我无法安装 ADT。

```
An error occurred while installing the items
session context was:(profile=epp.package.jee, phase=org.eclipse.equinox.internal.p2.engine.phases.Install, operand=[R]com.android.ide.eclipse.adt 21.0.1.v201212060256-543035 --> [R]com.android.ide.eclipse.adt 21.1.0.v201302060044-569685, action=).
Failed to prepare partial IU: [R]com.android.ide.eclipse.adt 21.1.0.v201302060044-569685. 
```

我正在尝试 ...

1.  WIN 7 电脑。JDK 1.7.0 和 JRE 7。

2.  面向 Web 开发人员的 Eclipse Java EE IDE。

3.  版本：Indigo Service Release 2

4.  版本号：20120216-1857

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:08:14.870

如果您不熟悉 Android 开发和 Eclipse，让我们试试 Google 捆绑包：

[http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)

下载 SDK，解压并编码 :D

# javascript - 引导日期选择器禁用没有当前日期的过去日期

> ID：16123056
> 
> 赞同：39
> 
> 时间：2013-04-20T17:16:26.283
> 
> 标签：javascript, jquery, twitter-bootstrap, bootstrap-datepicker

我想禁用当前日期之前的所有过去日期，而不是当前日期。我正在尝试通过引导 datepicker 库“ [bootstrap-datepicker](https://github.com/eternicode/bootstrap-datepicker) ”并使用以下代码：

```
$('#date').datepicker({ 
    startDate: new Date() 
}); 
```

它工作正常。但它是禁用日期直到今天。

例如，如果今天是 2013 年 4 月 20 日，我通过设置 startDate: new Date() 禁用过去的日期。但我可以从 04-21-2013 中选择日期。

更新：对于 UTC 区域，我可以按以下方式解决：

```
var d = new Date();
options["startDate"] = new Date(d.setDate(d.getDate() - 1)); 
```

或者`startDate: "+0d"`

但是当 UTC 提前一天时，这些方法不起作用。对于我在加利福尼亚的客户，这意味着在下午 5:00 我的客户不能再选择他当地的当前日期作为有效日期。为了解决这个问题，我暂时使用`startDate: "-1d"`，但当然在 5 之前，这意味着昨天是可见的。

现在有没有人想出更好的方法，因为我不想告诉用户输入 UTC 日期？

提前致谢。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-04-20T17:24:58.550

```
var date = new Date();
date.setDate(date.getDate()-1);

$('#date').datepicker({ 
    startDate: date
}); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-04-21T13:09:49.600

HTML

```
<input type="text" name="my_date" value="4/26/2015" class="datepicker"> 
```

JS

```
jQuery(function() {
  var datepicker = $('input.datepicker');

  if (datepicker.length > 0) {
    datepicker.datepicker({
      format: "mm/dd/yyyy",
      startDate: new Date()
    });
  }
}); 
```

这将在打开日历时突出显示默认日期为 2015 年 4 月 26 日（2015 年 4 月 26 日），并禁用当前日期之前的所有日期。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-07-15T09:33:56.657

使用[minDate](https://eonasdan.github.io/bootstrap-datetimepicker/Functions/#minmaxdate)

```
var date = new Date();
var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());

$('#date').datepicker({ 
    minDate: today
}); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-04-06T01:55:43.727

利用

```
startDate: '-0d' 
```

喜欢

```
$("#datepicker").datepicker({
    startDate: '-0d',
    changeMonth: true
}); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-14T11:21:19.040

您可以使用数据属性：

```
<div class="datepicker" data-date-start-date="+1d"></div> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-03-04T07:17:06.700

```
var nowDate = new Date();
var today = new Date(nowDate.getFullYear(), nowDate.getMonth(), nowDate.getDate(), 0, 0, 0, 0);
	$('#date').datetimepicker({
		startDate: today
	});
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-05-13T23:56:36.083

解决方案要简单得多：

```
$('#date').datepicker({ 
    startDate: "now()" 
}); 
```

尝试[在线演示](https://uxsolutions.github.io/bootstrap-datepicker/?markup=embedded&format=&weekStart=&startDate=now()&endDate=&startView=0&minViewMode=0&maxViewMode=4&todayBtn=false&clearBtn=false&language=en&orientation=auto&multidate=&multidateSeparator=&keyboardNavigation=on&forceParse=on#sandbox)并填写输入开始日期：**now()**

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-09-11T10:47:07.943

```
<script type="text/javascript">
$('.datepicker').datepicker({
    format: 'dd/mm/yyyy',
    todayHighlight:'TRUE',
    startDate: '-0d',
    autoclose: true,
}) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-08-23T21:25:37.093

要禁用过去的日期并突出显示今天的日期：

```
$(function () {
    $('.input-daterange').datepicker({
        startDate : new Date(),
        todayHighlight : true
    });
}); 
```

要禁用未来日期并突出显示今天的日期：

```
$(function () {
    $('.input-daterange').datepicker({
        endDate : new Date(),
        todayHighlight : true
    });
}); 
```

有关更多详细信息，请查看[https://bootstrap-datepicker.readthedocs.io/en/latest/options.html?highlight=startdate#quick-reference](https://bootstrap-datepicker.readthedocs.io/en/latest/options.html?highlight=startdate#quick-reference)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-02-07T07:18:02.217

试试看 ：

```
$(function () {
     $('#datetimepicker').datetimepicker({  minDate:new Date()});
}); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-07-28T13:26:52.687

这里是

```
 <script>
          $(function () {
              var date = new Date();
              date.setDate(date.getDate() - 7);

            $('#datetimepicker1').datetimepicker({
                maxDate: 'now',
                showTodayButton: true,
                showClear: true,
                minDate: date
            });
        });
    </script> 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-02-20T08:58:50.480

您可以简单地**在 html 输入标签中添加 data 属性**：

在rails html中：

```
<%= form.text_field :appointment_date, 'data-provide': 'datepicker', 'data-date-start-date': "+0d" %> 
```

HTML：

```
<input data-provide="datepicker" data-date-start-date="+0d" type="text" name="appointment_date" id="appointment_date"> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-01-12T11:16:36.393

禁用所有过去的日期

```
<script type="text/javascript">
        $(function () {
            /*--FOR DATE----*/
            var date = new Date();
            var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());

            //Date1
            $('#ctl00_ContentPlaceHolder1_txtTranDate').datepicker({
              format: 'dd-mm-yyyy',
              todayHighlight:'TRUE',
              startDate: today,
              endDate:0,
              autoclose: true
            });

        });
</script> 
```

禁用所有未来日期

```
 var date = new Date();
 var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());

   //Date1
   $('#ctl00_ContentPlaceHolder1_txtTranDate').datepicker({
       format: 'dd-mm-yyyy',
       todayHighlight:'TRUE',
       minDate: today,
       autoclose: true
   }); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-05-08T10:44:45.227

请参考小提琴[http://jsfiddle.net/Ritwika/gsvh83ry/](http://jsfiddle.net/Ritwika/gsvh83ry/)

```
**With three fields having date greater than the **
<input type="text" type="text" class="form-control datepickstart" />
<input type="text" type="text" class="form-control datepickend" />
<input type="text" type="text" class="form-control datepickthird" />

var date = new Date();
 date.setDate(date.getDate()-1);
$('.datepickstart').datepicker({
 autoclose: true,
 todayHighlight: true,
 format: 'dd/mm/yyyy',
  startDate: date
});
$('.datepickstart').datepicker().on('changeDate', function() {
    var temp = $(this).datepicker('getDate');
    var d = new Date(temp);
  d.setDate(d.getDate() + 1);
  $('.datepickend').datepicker({
 autoclose: true,
 format: 'dd/mm/yyyy',
 startDate: d
}).on('changeDate', function() {
    var temp1 = $(this).datepicker('getDate');
    var d1 = new Date(temp1);
   d1.setDate(d1.getDate() + 1);
  $('.datepickthird').datepicker({
 autoclose: true,
 format: 'dd/mm/yyyy',
 startDate: d1
});
});
}); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-05-24T06:42:17.847

**在 html 中**

```
<input class="required form-control" id="d_start_date" name="d_start_date" type="text" value=""> 
```

**在Js端**

```
<script type="text/javascript">
        $(document).ready(function () {
        var dateToday = new Date();
        dateToday.setDate(dateToday.getDate());

        $('#d_start_date').datepicker({
            autoclose: true,
            startDate: dateToday
        })

    }); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-11-15T10:56:41.877

要禁用过去的日期，只需使用：

```
 $('.input-group.date').datepicker({
       format: 'dd/mm/yyyy',
       startDate: 'today'
  }); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-07T18:08:33.407

以下对我有用

```
$('.input-group.date').datepicker({
     format: 'dd/mm/yyyy',
     startDate: new Date()
}); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-05-02T10:00:54.717

您可以在以下链接中找到您的解决方案：[https ://codepen.io/ahmetcadirci25/pen/NpMNzJ](https://codepen.io/ahmetcadirci25/pen/NpMNzJ)

那对我有用。

我的代码：

```
 var date = new Date();
        date.setDate(date.getDate());

        $('#datetimepicker1').datetimepicker({
            isRTL: false,
            format: 'dd.mm.yyyy hh:ii',
            autoclose: true,
            language: 'tr',
            startDate: date
        }); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-02-25T14:10:09.383

如果您的要求是基于另一个动态禁用 startDate 和 endDate，您可以这样做。

```
$('#date2').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: "dd/mm/yyyy",
            clearBtn : true
        }).on('show', function(e){
            var date = $('#date3').datepicker('getDate');
            if(date){
             $('#date2').datepicker('setEndDate', date);
                }
    });

        $('#date3').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: "dd/mm/yyyy",
            clearBtn : true
        }).on('show', function(e){
            var date = $('#date2').datepicker('getDate');
            if(date){
             $('#date3').datepicker('setStartDate', date);
                }
    }); 
```

如果您的要求只是禁用了过去的日期，那么您可以使用下面的代码段。

```
$('#date2').datepicker({
            todayHighlight: true,
            autoclose: true,
            format: "dd/mm/yyyy",
            clearBtn : true,
            startDate : new Date()
        }) 
```

如果您的要求只是禁用未来日期，那么您可以使用以下代码段。

```
 $('#date2').datepicker({
                todayHighlight: true,
                autoclose: true,
                format: "dd/mm/yyyy",
                clearBtn : true,
                endDate : new Date()
            }) 
```

我希望它会帮助某人。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-10-12T17:11:47.573

这取决于您在日期选择器上放置的格式所以首先我们给了它格式。

```
 var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = yyyy+'-'+mm+'-'+dd; //Here you put the format you want 
```

然后传递日期选择器（取决于您使用的版本，可能是 startDate 或 minDate 这是我的情况）

```
 //Datetimepicker
    $(function () {
        $('#datetimepicker1').datetimepicker({
            minDate: today, //pass today's date
            daysOfWeekDisabled: [0],
            locale: 'es',
            inline: true,
            format: 'YYYY-MM-DD HH:mm', //format of my datetime (to save on mysqlphpadmin)
            sideBySide: true
        });
    }); 
```

# php - Vimeo 嵌入（froogaloop）SQL“while 循环”问题

> ID：16123061
> 
> 赞同：0
> 
> 时间：2013-04-20T17:16:57.627
> 
> 标签：php, mysql, while-loop, vimeo, froogaloop

关联：

> > [这是我正在处理的页面](http://s199881165.onlinehome.us/transfem/looper2.php)

因此，我正在尝试创建一个页面，该页面将生成一个接一个播放的 vimeo 视频播放列表。最终，我将使用 jquery 或其他方式隐藏和显示它们，以便一次只出现一个嵌入式视频 iframe。与此同时，我只是想让 vimeo api 让我控制每个单独的对象。

所以现在想要的结果是让每个设置按钮用相同的 $nummy 值控制每个视频

其中 $nummy 是列表中的顺序

问题是目前只有列表中的最后一个视频响应其自己的按钮集命令。

这是 PHP 的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Test The Loop2</title>
<script type="text/javascript" src="http://a.vimeocdn.com/js/froogaloop2.min.js"></script>
</head>

<body>

<?

//db connect

$con = mysql_connect("d######t","db######104","no#######s");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

//db select

mysql_select_db("db337100104", $con); 

$result = mysql_query("SELECT * FROM vim_playlist1");

while($row = mysql_fetch_array($result))
  {

        $nummy = $row['listnum'] ;
        $url = $row['url'] ;
        $nexty = $nummy+1 ; 

//not an area of php    

?>

 <iframe class="vimeo" id="play<? echo $nummy ?>" src="http://player.vimeo.com/video/<? echo $row['url'] ?>?api=1&player_id=play<? echo $nummy?>" width="500" height="281" frameborder="0"></iframe>
<br />
<button id="playButton<? echo $nummy ?>">Play</button>
<button id="pauseButton<? echo $nummy ?>">Pause</button>
<button id="unloadButton<? echo $nummy ?>">Unload</button>

<script>

 function ready(player_id)
        {

             $f('play<? echo $nummy?>').addEvent('ready', function() 
                        {
             $f('play<? echo $nummy?>').addEvent('finish', onFinish);
                        });

            function onFinish(play<? echo $nummy?>)  
                 {                
            $f('play<? echo $nexty ?>').api('play');
                 }

           document.getElementById('playButton<? echo $nummy ?>').addEventListener('click', function() {
                $f('play<? echo $nummy?>').api('play');
            });

            document.getElementById('pauseButton<? echo $nummy ?>').addEventListener('click', function() {
                $f('play<? echo $nummy?>').api('pause');
            });

           document.getElementById('unloadButton<? echo $nummy ?>').addEventListener('click', function()                                                    {
              $f('play<? echo $nummy?>').api('unload');
            });

             }

        window.addEventListener('load', function() {
            //Attach the ready event to the iframe
            $f(document.getElementById('play<? echo $nummy?>')).addEvent('ready', ready);
        });

    </script>

<hr />

<?

        //end of loop
  }

  ?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:21:27.693

您在循环的每次迭代中都覆盖了您的`ready`函数。所以只会执行最后一个`ready`函数。

一个示例解决方案是替换`ready`为`ready<?php echo $nummy ?>`（我认为这`$nummy`是唯一的）：

```
function ready<?php echo $nummy ?>(player_id) {
    // your function body
}

window.addEventListener('load', function() {
    //Attach the ready event to the iframe
    $f(document.getElementById('play<? echo $nummy?>')).addEvent('ready', ready<?php echo $nummy ?>);
}); 
```

Ps：这*不是*一个理想的解决方案。但一个可能的解决方案。

# javascript - 我可以在 Knockoutjs 中的 if 绑定中的 jquery 调用中访问 $data 吗？

> ID：16123074
> 
> 赞同：1
> 
> 时间：2013-04-20T17:18:04.827
> 
> 标签：javascript, knockout.js

我有一个 foreach 绑定，我只想在页面上还没有的情况下显示和项目，我似乎无法在 jquery 中引用当前元素

```
<tbody data-bind="foreach: fixtures">
        <tr>
           <!-- ko if: $("th:contains($data.date)").length == 0 -->
           <td data-bind="text: date">
           <!-- /ko -->
           </td>
        </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:25:26.737

您只需要使用字符串连接构建您的 jQuery 选择器`+`：

```
<!-- ko if: $("th:contains(" + $data.date + ")").length == 0 --> 
```

# php - UTF-8 法语重音字符问题

> ID：16123076
> 
> 赞同：5
> 
> 时间：2013-04-20T17:18:17.650
> 
> 标签：php, html, mysql, character-encoding

当我使用 phpmyadmin 看到存储在 mysql 数据库中的数据时，这些字符完全存储为 é à ç 但是当我使用 php 在具有以下确切结构的 html 文档上显示这些数据时：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
</head>

<body>
</body>
</html> 
```

我得到的是正方形而不是重音字符，但是，对于尚未从同一页面中的 mysql 加载的静态内容上的任何重音字符，我没有这个问题。

当我在页面的源代码上看到它们似乎是相同的！例如：

源代码上的部分静态数据显示为：

```
éçà 
```

部分mysql原始数据：

```
éçà 
```

我试着更换

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

和

```
<meta http-equiv="Content-Type" content="text/html; charset=windows-1552" /> 
```

结果我得到了一个固定的mysql，带有正方形的静态！

任何提示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T17:22:29.603

这是很常见的字符集问题，您需要为 MySQL 连接手动设置连接编码（这些应该是您在建立连接后执行的第一个查询）：

```
SET NAMES utf8;
SET CHARACTER SET utf8; 
```

并确保每张桌子都`CHARACTER SET`设置为`UTF-8`.

或者您也可以更新[服务器配置](https://stackoverflow.com/questions/3513773/change-mysql-default-character-set-to-utf8-in-my-cnf)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T17:29:10.317

看起来像一个配置错误的问题。很可能您的数据库或驱动程序没有使用 UTF-8。

当您更改为时来自数据库的数据显示正常`windows-1552`而静态文件不显示，这一事实可能意味着您的源文件（正确）采用 UTF-8，但来自数据库的数据以错误的编码格式到达.

无论发生什么，坚持使用 UTF-8。

**更新：**有一个线程解释了如何自动设置连接的编码：

[在 my.cnf 中将 MySQL 默认字符集更改为 UTF-8？](https://stackoverflow.com/questions/3513773/change-mysql-default-character-set-to-utf8-in-my-cnf)

# ruby-on-rails - 如何拆分每个域而不是每个应用实例的应用数据？

> ID：16123077
> 
> 赞同：0
> 
> 时间：2013-04-20T17:18:32.363
> 
> 标签：ruby-on-rails, mongodb, heroku

假设您构建了一个简单的博客系统。

不必在 3 个不同的 Heroku dyno 上发布这个博客系统，这对于如此简单的事情来说会很昂贵（每个至少需要 2 个 dyno，这样它就不会闲置）...... 可以选择拆分 3 个不同域的逻辑在一个应用程序上。

您将如何为应用程序的一个实例获取当前的逻辑和数据，然后将其拆分，以便 3 个不同的域可以使用该域范围内的数据？这是利用现有数据来形成这个系统。

对不起，如果这还不够清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:42:02.710

将所有三个域指向同一个应用程序。

您将需要创建一个域模型来处理此问题。

```
class Domain < ActiveRecord::Base
  has_many :blogs
  belongs_to :admin
  validates_uniqueness_of :domain_string
end

class ApplicationController < ActionController::Base

   before_filter :get_domain

   def get_domain
      @domain = Domain.find_by_domain_string(request.host)
   end

end

class BlogController < ApplicationController

   def index
      @blogs = @domain.blogs.whatever_additional_logic_you_need
   end

end 
```

其他一切都将遵循相同的模式。

# c# - 无法在 winform 中暂停 webBrowser1_Navigating 事件。C＃

> ID：16123078
> 
> 赞同：1
> 
> 时间：2013-04-20T17:18:45.183
> 
> 标签：c#, winforms, webbrowser-control

我尝试通过 winform 应用程序中 webbrowser 控件中的鼠标挂钩记录一些互联网活动。很少发生点击链接并且不记录该点击只是因为一切发生得太快而我的代码在

```
public void WebBrowser1Document_Click(object sender, HtmlElementEventArgs e)
        {    
            tempHtmlElement = webBrowser1.Document.ActiveElement;
            ... 
```

方法无法到达终点。在 90% 的记录中发生了，但有时它会`webBrowser1_Navigating`在之后通过事件，正如我所说`WebBrowser1Document_Click`的，它只是开始并`webBrowser1.Document.ActiveElement`中断。没关系，我有 ActiveElement 的变量，这个变量失去了对某些属性的访问权限，例如 Name。所以我的问题是如何暂停 webbrowser1 活动，直到记录完成。这是一个 STA 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T23:56:43.987

假设 Navigation 在 Click 方法完成之前发生，您可以通过一个棘手的方法暂停。使用全局变量 CanNavigate。

```
bool canNavigate;
public void WebBrowser1Document_Click(object sender, HtmlElementEventArgs e)
        {    
            canNavigate=false;
            tempHtmlElement = webBrowser1.Document.ActiveElement;
            ...
            ...
            //At the End 
            canNavigate=true;
         }

    void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
        {
            do
            {
Application.DoEvents(); Thread.Sleep(100);

            } while (!canNavigate);
        } 
```

# node.js - 获取流星调用以返回条带支付响应

> ID：16123083
> 
> 赞同：5
> 
> 时间：2013-04-20T17:19:13.227
> 
> 标签：node.js, meteor, stripe-payments

我一直在使用 Meteor 和 stripe 包来尝试吸引客户。所以首先我有我的客户端代码，它调用服务器上的一个方法，所以当点击我在 client.js 中：

```
Meteor.call('usersignup', function (error, result) {
    console.log (result);
}); 
```

所以这会调用 server.js 上的方法：

```
var Future = Npm.require('fibers/future');
var stripe = StripeAPI('my key'); // secret stripe API key

Meteor.methods({

    usersignup: function(cusEmail){
        var fut = new Future();

        stripe.customers.create(
            { email: cusEmail },
            function(err, customer) {
                if (err) {
                    console.log(err);
                    fut.ret;
                }
                fut.ret(customer);
            }
            );
        return fut.wait();
    },

    userfail: function(cusid){
        var fut = new Future();

        stripe.customers.retrieve(cusid, function(err, result) {
            if(err){
                    console.log(err);
                    fut.ret;
                }
                fut.ret(err, result);
            });
        return fut.wait();
    }

}); 
```

现在，当我登录到 stripe.com 仪表板时，这可以工作并创建一个客户，但我正在尝试将响应至少返回给客户，至少现在是客户 ID，并在控制台中打印它。这是我似乎无法让它工作的地方。当我执行 console.log(result) 时，它会记录未定义。有任何想法吗？

编辑：所以我现在将光纤和条带键作为全局变量并且没有收到错误，但返回似乎没有返回任何值。所以在客户端我有：

```
'click #signupsubmit': function (event) {
    console.log("hello");
    var whatis = getVal(); // function gets value of forms and returns object
    var testid;
    var cusid = Meteor.call('usersignup', whatis.email, function (error, result) {
        if (error) {
            console.log(err.message);
            return;
        }
        console.log(result);
        console.log("meteor call");
        testid = result;
        return (result);
    });
    console.log("outside call");
    console.log(testid);
    console.log(cusid);
    },
}); 
```

所以我一直在运行一些console.log 测试，它似乎执行了meteor.call 并继续下线。testid 和 cusid 的 Console.log 都返回未定义，但几秒钟后，我收到了 result 的 console.log 和来自 meteor.call 内部的字符串“meteor call”。有没有办法等待流星调用完成然后运行我的点击功能中的其余部分？所以控制台输出将如下所示：

*   “你好”
*   “外线电话”
*   测试ID未定义
*   cusid 未定义
*   “流星呼唤”
*   “结果”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T20:02:29.993

请记住，条带 API 不使用 Fibers。您需要手动将其放入。回调没有到达客户端，因为到那时它已经得到了响应（它的异步）

在将结果返回给客户端之前，您可以使用类似这样的方法来等待条带回调的结果：

```
var stripe = StripeAPI('mykeygoeshere');  // secret stripe API key
var Future = Npm.require('fibers/future');

var fut = new Future();

stripe.customers.create(
    { email: 'hello@example.org' },
    function(err, customer) {
        if (err) {
            console.log(err.message);
            fut.ret;
        }
        fut.ret("customer id", customer.id);
    }
);
return fut.wait(); 
```

这里`Future`使用了 a ，它等待从条带回调接收到结果，然后再将结果返回给客户端。

可以在 Fibers/Futures & Synchronous Callbacks 上找到更多信息，包括如何使用它们以及何时使用它们：

1.  [Meteor：在 Meteor.method 中调用异步函数并返回结果](https://stackoverflow.com/questions/12569712/meteor-calling-an-asynchronous-function-inside-a-meteor-method-and-returning-th)
2.  [https://github.com/laverdet/node-fibers](https://github.com/laverdet/node-fibers)
3.  [https://gist.github.com/possibilities/3443021](https://gist.github.com/possibilities/3443021)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-07T06:48:16.450

这里有一些更简单的东西。Meteor 现在有[Meteor.wrapAsync()](http://docs.meteor.com/#/full/meteor_wrapasync)用于这种情况：

```
var stripe = StripeAPI("key");    
Meteor.methods({

    yourMethod: function(callArg) {

        var charge = Meteor.wrapAsync(stripe.charges.create, stripe.charges);
        charge({
            amount: amount,
            currency: "usd",
            //I passed the stripe token in callArg
            card: callArg.stripeToken,
        }, function(err, charge) {
            if (err && err.type === 'StripeCardError') {
              // The card has been declined
              throw new Meteor.Error("stripe-charge-error", err.message);
            }

            //Insert your 'on success' code here

        });
    }
}); 
```

我发现这篇文章真的很有帮助： [Meteor: Proper use of Meteor.wrapAsync on server](https://stackoverflow.com/questions/26226583/meteor-proper-use-of-meteor-wrapasync-on-server)

# css - 试图让 img 的位置绝对位于其父 div 的底部

> ID：16123087
> 
> 赞同：1
> 
> 时间：2013-04-20T17:19:28.617
> 
> 标签：css, positioning, css-position

据我了解，您可以在其父级内部使用绝对定位将其准确放置在您想要的任何位置。就像这里解释的那样：http: [//css-tricks.com/absolute-positioning-inside-relative-positioning/](http://css-tricks.com/absolute-positioning-inside-relative-positioning/)

我试图让我的 img 元素位于其父 div 的底部，但是当我给 img 一个绝对位置时，布局会中断。似乎我需要为该部分或 div 分配一个高度，但似乎没有任何效果。

请注意，我在 css 中注释掉了图像上的绝对定位，因此布局更美观

```
<head>

</head>

<body>

<section id="artImages">

<div id="artImage1">
    <img src="http://placekitten.com/288/200" alt="" />
</div>

<div id="artImage2">
    <img src="http://placekitten.com/144/160" alt="" />
</div>

<div id="artImage3">
    <img src="http://placekitten.com/673/300" alt="" />
</div>

</section>

</body> 
```

CSS：

```
section {
    margin: 100 auto;
}

section#artImages {
    width: 673px;
    height: auto;
    position: relative;
    display: block;
}

    section#artImages div {
        float: right;
        height: auto;
        position: relative;
    }

        div#artImage1 {
            width: 288px;
        }

        div#artImage2 {
            width: 144px;
        }

    section#artImages div img {
        width: 100%;
        /* position: absolute; */
        bottom: 0;
    } 
```

这是我的 jsfiddle [http://jsfiddle.net/PsMff/](http://jsfiddle.net/PsMff/)下面是我正在寻找的说明。

![div 和图像的插图](https://i.stack.imgur.com/CLZLE.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T13:17:06.430

你是对的......**如果你想保留当前的 ​​html 标记**`div`， s 需要`hight`分配一些。

 ****注意：**您也不需要将 html 元素的标记名与`id`s（例如`div#artImage1`）结合使用，因为`id`在标记中只能引用一个特定元素。

你可以尝试这样的事情（[jsfiddle](http://jsfiddle.net/VrZv4/)），我给了`div`s `hight: 300px`：

```
section {display: block}
#artImages {
    margin: 0 auto;
    width: 673px;
}
#artImages div {
    position:relative;
    float:right;
    height:300px;
}
#artImage1 {
    width: 288px;
}
#artImage2 {
    width: 144px;
}
#artImage3 {
    position:relative;
    width:100%;
    background-color:blue;
}
#artImages div img {
    position:absolute;
    width: 100%;
    bottom: 0;
} 
```

## 另外的选择：

如果您**不想为**div 指定高度，而是让它调整到其中较高的高度，请在上面的两个`div`s 周围包裹另一个容器。在这里，我添加了`#floater` `div`您的标记：

```
<section id="artImages">
    <div id="floater">
        <div id="artImage2">
            <img src="http://placekitten.com/144/160" alt="" />
        </div>
        <div id="artImage1">
            <img src="http://placekitten.com/288/200" alt="" />
        </div>
    </div>
    <div id="artImage3">
        <img src="http://placekitten.com/673/300" alt="" />
    </div>
</section> 
```

现在浮动到右边并在图像上使用`#floater`。像这样的东西：`display:inline-block;``#artImage1``#artImage2``bottom:0;`

```
section {display: block}
#artImages {
    margin: 0 auto;
    width: 673px;
}
#floater, #artImage3 {
    float:right;
}
#artImage1, #artImage2 {
    display:inline-block;
    width: 288px;
}
#artImage2 { width: 144px }
#artImage3 { width: 100% }
#artImages img {
    width: 100%;
    bottom: 0;
} 
```

[jsfiddle 示例](http://jsfiddle.net/VrZv4/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:51:25.490

使用`class`属性代替`id`，然后添加以下代码

```
 position : relative;
  bottom : 0px;
  clear : both; 
```**

# html - 在 Rails 中获取帖子的点赞数

> ID：16123090
> 
> 赞同：2
> 
> 时间：2013-04-20T17:19:35.340
> 
> 标签：html, ruby-on-rails, count, social-networking, social-media-like

在我的 Rails 应用程序中，我使用的是 gem，socialization。我只是不知道如何显示喜欢的数量！

我的后控制器：

```
class PostsController < ApplicationController
  # GET /posts
  # GET /posts.json
  def index
    @posts = Post.all(:order => "created_at DESC")
    @posts_not_signed_in = Post.all(:order => "created_at DESC")

    @post = Post.new
    @users = User.all(:order => "created_at DESC")

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @posts }
    end
  end

  def like
    post.liked_by current_user
    redirect_to root_path
  end

  # GET /posts/1
  # GET /posts/1.json

  def show
    redirect_to posts_path
  end

  # GET /posts/new
  # GET /posts/new.json
  def new
    @post = Post.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @post }
    end
  end

  # GET /posts/1/edit
  def edit
    @post = Post.find(params[:id])
  end

  # POST /posts
  # POST /posts.json
  def create
    @post = current_user.posts.build(params[:post])

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /posts/1
  # PUT /posts/1.json
  def update
    @post = Post.find(params[:id])

    respond_to do |format|
      if @post.update_attributes(params[:post])
        format.html { redirect_to @post, notice: 'Post was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /posts/1
  # DELETE /posts/1.json
  def destroy
    @post = Post.find(params[:id])
    @post.destroy

    respond_to do |format|
      format.html { redirect_to posts_url }
      format.json { head :no_content }
    end
  end
end 
```

我的用户控制器：

```
class UsersController < ApplicationController
  def index
@users = User.all

respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :xml => @users }
end

end
  def show
    @user = User.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @user }
    end
  end

  def follow
      @user = User.find(params[:id])
      current_user.toggle_follow!(params[:id])
      redirect_to root_path
  end

  def unfollow
    @user = User.find(params[:id])
    current_user.stop_following(@user)
    redirect_to root_path
  end

end 
```

我的帖子模型：

```
class Post < ActiveRecord::Base
  attr_accessible :status, :author, :username, :id, :user_id, :user, :website, :bio, :skype, :dob, :age, :email, :motto, :follower, :followable, :votes
  belongs_to :user
  has_many :like
  has_many :likes

  validates :status, :presence => true

  acts_as_likeable
  acts_as_votable

end 
```

我的用户模型：

```
class User < ActiveRecord::Base

  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :user_id, :id, :website, :bio, :skype, :dob, :age, :motto, :follower, :followable

  has_many :posts

  acts_as_liker
  # attr_accessible :title, :body
end 
```

我的观点 ：

```
<% if user_signed_in? %>
  <h1 id="welcome" class="nuvo">Welcome <%= current_user.username %>!</h1>
<% else %>
  <h1 id="welcome" class="nuvo">Log-In to make some posts!</h1>
<% end%>

<div class="follow-row">
  <div class="titan-users nuvo"><h2>BoomIt Users</h2></div>
  <div class="user-row nuvo"><%= link_to 'coreypizzle', user_path(1) %> - <%= link_to 'BoomBoard', dashboard_path(1) %></div>
    <% @users.each do |user| %>
      <div class="user-row nuvo"><%= link_to user.username, user_path(user.id) %> - <%= link_to 'BoomBoard', dashboard_path(user.id) %></div>
    <% end %>
</div>

<div class="statuses">
  <% if user_signed_in? %><div class="status-form"><%= render 'form' %></div><% end %>
  <% if user_signed_in? %>
  <% @posts.each do |post| %>
    <div class="post">
      <div class="tstamp">
        <%= image_tag avatar_url_small(post.user), :class => 'gravatar' %>
        <strong>Posted <%= time_ago_in_words(post.created_at) %> ago by <%= post.user.username %></strong>
      </div>
      <div class="status"><%= post.status %></div>
      <div class="likearea"><%= link_to 'BoomThis', 'posts/like', :class => 'wtxt nuvo' %> - <%= @post.likes.size %></div>
    </div>
  <% end %>
  <% else %>
    <% @posts_not_signed_in.each do |post| %>
    <div class="post">
      <div class="tstamp">
        <%= image_tag avatar_url_small(post.user), :class => 'gravatar' %>
        <strong>Posted <%= time_ago_in_words(post.created_at) %> ago by <%= post.user.username %></strong>
      </div>
      <div class="status"><%= post.status %></div>
    </div>
  <% end %>
  <% end %>
</div> 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T19:29:57.433

老问题，但我也找不到这个。

正确的方法调用似乎是：

```
post.likers(User).count 
```

我仍然不确定为什么您必须传递模型名称，也许您可​​以询问该类别的喜欢者的喜欢数量？

这虽然有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:33:02.363

第一的

```
has_many :like
has_many :likes 
```

我想你的意思只是

```
has_many :likes 
```

所以你会做

```
@likes_num = @post.likes.count 
```

这将为喜欢的数量创建一个查询，而不是实际喜欢的数量。

# python - 使用本地 RDF 存储的 SPARQL 查询

> ID：16123096
> 
> 赞同：1
> 
> 时间：2013-04-20T17:20:36.953
> 
> 标签：python, sparql, triplestore, rdflib, rdfstore

我正在尝试使用本地 RDF 图创建 SPARQL 查询。但它不起作用。我在下面包含了我的代码是我的代码。

我有两个班级，学生和大学。学生类有两个属性（enrolledOn 和 studyAt）。University 类也有两个属性（UniversityLocation 和 UniversityRanking）。此外，我输入了一些数据（RDF 三元组）。Student 类和 University 类都具有**三个**数据实体。

我的 SPARQL 查询位于底部。我想**选择所有在排名前 10 的大学学习的学生**。但目前，我的 SPARQL 查询没有返回任何内容。查询应返回 Khalil 和 Ahmed。

任何帮助都感激不尽。谢谢你。

我的代码：

```
import rdfextras
import rdflib
from rdflib.graph import Graph, Store, URIRef, Literal
from rdflib.namespace import Namespace, RDFS
from rdflib import plugin
from SPARQLWrapper import SPARQLWrapper, JSON

rdflib.plugin.register('sparql', rdflib.query.Processor,
                       'rdfextras.sparql.processor', 'Processor')
rdflib.plugin.register('sparql', rdflib.query.Result,
                       'rdfextras.sparql.query', 'SPARQLQueryResult')

#=====================data for STUDENT class==============================
rdf_xml_Student_data = """<?xml version="1.0"?>
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:Student="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student#">

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student/Harith">
  <Student:enrolledOn>MScComputerScience</Student:enrolledOn>
  <Student:studiesAt>Queen_Mary</Student:studiesAt>
</rdf:Description>

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student/Khalil">
  <Student:enrolledOn>BScComputerScience</Student:enrolledOn>
  <Student:studiesAt>Oxford_University</Student:studiesAt>
</rdf:Description>

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student/Ahmed">
  <Student:enrolledOn>BScComputerScience</Student:enrolledOn>
  <Student:studiesAt>Oxford_University</Student:studiesAt>
</rdf:Description>

</rdf:RDF>
"""

#=====================data for UNIVERSITY class==============================
rdf_xml_University_data = """<?xml version="1.0"?>
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:University="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University#">

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University/Queen_Mary">
  <University:UniversityLocation>London</University:UniversityLocation>
  <University:UniversityRanking>36</University:UniversityRanking>
</rdf:Description>

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University/City_University">
  <University:UniversityLocation>London</University:UniversityLocation>
  <University:UniversityRanking>43</University:UniversityRanking>
</rdf:Description>

<rdf:Description rdf:about="http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University/Oxford_University">
  <University:UniversityLocation>Oxford</University:UniversityLocation>
  <University:UniversityRanking>2</University:UniversityRanking>
</rdf:Description>

</rdf:RDF>
"""

# -- (part1) create and RDF store in memory --
memory_store = plugin.get('IOMemory', Store)()
graph_id = URIRef(u'http://example.com/foo')
g = Graph(store=memory_store, identifier=graph_id)
g.bind('ex','http://example.com/')   

g.parse(data=rdf_xml_Student_data, format="application/rdf+xml")
g.parse(data=rdf_xml_University_data, format="application/rdf+xml")

#===========================SPARQL QUERY====================================
# QUERY - select all students who study at top 10 ranked universities
results = g.query("""PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX student: <http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student#>
PREFIX university: <http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University#>

SELECT ?stu 
WHERE { ?uni university:UniversityRanking ?UniversityRanking.
        ?stu student:studiesAt ?uni.
        FILTER ( ?UniversityRanking < 10)
}
""")

print("\n============QUERY RESULTS===============\n")
for row in results.result:
    print(row) 
```

这就是我运行上述代码后三元组将如何存储在图表中的方式：

```
=========================STUDENT class==================================
Subject         Predicate           Object
========================================================================
Harith          enrolledOn          MScComputerScience
Harith          studiesAt           Queen_Mary
Khalil          enrolledOn          BScComputerScience
Khalil          studiesAt           Oxford_University
Ahmed           enrolledOn          BScComputerScience
Ahmed           studiesAt           Oxford_University

=============================UNIVERSITY class=======================
Subject            Predicate           Object
===============================================================
Queen_Mary             UniversityLocation      London
Queen_Mary             UniversityRanking       36
City_University        UniversityLocation      London
City_University        UniversityRanking       43
Oxford_University        UniversityLocation    Oxford
Oxford_University        UniversityRanking     2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T06:25:26.630

不是真正的答案，但除非您的 RDFLib 超过 3-4 年，否则您的代码可以简单得多：

```
from rdflib import Graph

#=====================data for STUDENT class==============================
rdf_xml_Student_data = """<?xml version="1.0"?> ... <snip>"""

#=====================data for UNIVERSITY class==============================
rdf_xml_University_data = """<?xml version="1.0"?> ... <snip>"""

# -- (part1) create and RDF store in memory --
g = Graph()

g.parse(data=rdf_xml_Student_data)
g.parse(data=rdf_xml_University_data)

#===========================SPARQL QUERY====================================
# QUERY - select all students who study at top 10 ranked universities
results = g.query("""PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX student: <http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/Person/Student#>
PREFIX university: <http://www.semanticweb.org/ontologies/2013/2/Coursework.owl/Thing/University#>

SELECT ?stu 
WHERE { ?uni university:UniversityRanking ?UniversityRanking.
    ?stu student:studiesAt ?uni.
    FILTER ( ?UniversityRanking < 10)
}
""")

print("\n============QUERY RESULTS===============\n")
for row in results.result:
    print(row) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T08:01:21.170

您应该查看 Robv[对此问题](https://stackoverflow.com/questions/4827691/how-do-i-make-a-sparql-query-to-find-the-highest-value-for-a-property)的回答，将您的 UniversityRanking 值转换为整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T12:02:14.673

```
?stu student:studiesAt ?uni. 
```

在您的学生数据中匹配文字字符串。在您的大学数据中，您使用 URI。

一个好的开始方法是在 Turtle 或 N-Triples 中打印出每组数据以查看真实结构。RDF/XML 很难使用。

# java - 如何轻松解析此字符串？

> ID：16123098
> 
> 赞同：0
> 
> 时间：2013-04-20T17:20:45.677
> 
> 标签：java, string, parsing, split

所以我想从表单上的某些东西中提取数据：

“圣地亚哥”——“圣安东尼奥”[1319]

我想在括号[]中提取城市名称和末尾的数字。如果城市是一个单词，则没有“”，如本例所示：

托莱多--斯普林菲尔德 [677]

现在我使用 str.split("--") 然后 str.split(" [")。然而后者是不可行的，如果我尝试使用 split(" ") 它将在两个单词城市的中间分裂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T17:24:32.487

一个正则表达式似乎被占用：

```
"?(.*?)"?--"?(.*?)"? \[(.*?)] 
```

在 Java 中：

```
Pattern p = Pattern.compile("\"?(.*?)\"?--\"?(.*?)\"? \\[(.*?)]");
Matcher m = p.matcher("\"San Diego\"--\"San Antonio\" [1319]");
if (m.find()) {
    System.out.println(m.group(1));
    System.out.println(m.group(2));
    System.out.println(m.group(3));
} 
```

印刷：

```
San Diego
San Antonio
1319 
```

* * *

**正则表达式解释**

*   `"?`意思是*“一个`"`或不是”*
*   `.*?`意思是*“任何字符串”*
*   括号捕获它们之间的数据，这就是为什么之后，我们可以使用`m.group(...)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:38:06.000

按 -- 分割后，使用 contains() 方法检查 " 如果为真，则按空格和 [ 分割。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-21T00:11:47.027

您还可以使用 StringTokenizer 替代正则表达式，在 StringTokenizer 中您可以指定相邻的分隔符，这里假设您想要 -- 和 [ 作为分隔符，所以只需在分隔符部分写入 --[

```
String input="\"San Diego\"--\"San Antonio\" [1319]";
StringTokenizer tok = new StringTokenizer(input, "--[");
while (tok.hasMoreTokens()) 
{
    System.out.println(tok.nextToken());
} 
```

# ruby-on-rails - '语法错误，意外的keyword_ensure'在不存在的行上

> ID：16123099
> 
> 赞同：2
> 
> 时间：2013-04-20T17:20:48.897
> 
> 标签：ruby-on-rails, haml

我收到错误消息：[语法错误，意外的keyword_ensure，期望](http://i.imgur.com/CRu49cQ.png)在我拥有的haml模板上使用$end，但是它提取的提取的源代码行号超出了文件的末尾。我的代码是：

```
%span
* click a gamertag to see detailed medal stats

.seperator{ :id => 'medal-stats', :style => 'margin: 20px 0 20px 0;' }

- @sorted_players.each do |player|
  .medal_stats{ :id => "player_medals_#{Digest::MD5.hexdigest(player['Gamertag'])}" }
    %h3
      #{player['Gamertag']}'s Medals

  %table.team-table.table.table-bordered.table-striped.table-hover
    %thead
      %tr
        - @metadata['MedalsMetadata']['MedalClasses'].each do |medal_class|
          %td
            #{medal_class['Name']}

    %tbody
      - player['MedalStats'] = player['MedalStats'].sort_by { |medal| medal['TotalMedals'] }.reverse
        %tr
          - @metadata['MedalsMetadata']['MedalClasses'].each do |medal_class|
            %td
              - player['MedalStats'].each do |medal|
                - if medal['ClassId'] != medal_class['Id']
                  - next

                .medal-entry{ :style => "background-image: ('#{ X343ApiController.asset_url_generator_basic( medal['ImageUrl']['BaseUrl'],
                medal['ImageUrl']['AssetUrl'], 'medium') }');" }
                  #{medal['TotalMedals']} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:23:42.523

问题是由以下行引起的：

```
- player['MedalStats'] = player['MedalStats'].sort_by { |medal| medal['TotalMedals'] }.reverse
  %tr 
```

`%tr`不应该缩进，你应该将它移回（以及它下面缩进的行）以与上面的行`-player ...`一致。

要了解为什么会产生这个错误，我们需要看看 Haml 是如何解析脚本的。当脚本行下面有一个缩进的部分时，Haml 假定它是一个应该作为脚本的一部分传递的块，并生成适当的代码，包括生成的`end`语句。例如这个哈姆尔：

```
- @things.each do |thing|
  %li= thing 
```

生成看起来像的 Ruby

```
 @things.each do |thing|
_hamlout.buffer << "<li>#{thing
}</li>\n";end; 
```

第一行 ( `@things.each do |thing|`) 直接从 Haml 源复制而来，但对应`end`的是由 Haml 生成的。还要注意它`end`是如何放在尾随行的，因此它与 Haml 中的行不匹配，并且错误似乎来自源代码末尾之外。

如果脚本行没有开始一个块，Haml 不会注意到并仍然假定一个块已被打开并生成该`end`语句。例如哈姆

```
- a_variable = just_set_the_var
  %li= thing 
```

生成以下 Ruby：

```
 a_variable = just_set_the_var
_hamlout.buffer << "<li>#{a_variable
}</li>\n";end; 
```

第一行是直接从 Haml 复制的，由于它不包含 a `do |...|`，因此`end`Haml 生成的 不匹配，从而产生语法错误。

可以说，当以下行缩进时，Haml 应该检查脚本行是否确实开始了一个块，从而创建了一个更具信息性的错误，但目前它没有。

# android - mediaStorageDir.mkdirs() 不创建目录

> ID：16123100
> 
> 赞同：4
> 
> 时间：2013-04-20T17:20:49.240
> 
> 标签：android

有谁知道解决这个问题的方法？我正在使用相机意图拍照。以下方法生成将存储图片的文件。但是，`mkdirs()`无法在设备上创建目录。在这种情况下我有什么选择？

```
private static File getOutputMediaFile() {
    File mediaStorageDir = new File(
        Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),
        "MyCameraApp");
    if (!mediaStorageDir.exists()) {
        if (!mediaStorageDir.mkdirs()) {
            Log.d("MyCameraApp", "failed to create directory");
            return null;
        }
    }
    String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss")
        .format(new Date());
    return new File(mediaStorageDir.getPath() + File.separator + "IMG_"
        + timeStamp + ".jpg");
} 
```

错误日志：

```
04-20 09:56:07.370: D/MyCameraApp(809): failed to create directory
04-20 09:56:07.370: D/AndroidRuntime(809): Shutting down VM
04-20 09:56:07.370: W/dalvikvm(809): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
04-20 09:56:07.441: E/AndroidRuntime(809): FATAL EXCEPTION: main
04-20 09:56:07.441: E/AndroidRuntime(809): java.lang.IllegalStateException: Could not execute method of the activity
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.view.View$1.onClick(View.java:3591)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.view.View.performClick(View.java:4084)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.view.View$PerformClick.run(View.java:16966)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.os.Handler.handleCallback(Handler.java:615)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.os.Handler.dispatchMessage(Handler.java:92)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.os.Looper.loop(Looper.java:137)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.app.ActivityThread.main(ActivityThread.java:4745)
04-20 09:56:07.441: E/AndroidRuntime(809):  at java.lang.reflect.Method.invokeNative(Native Method)
04-20 09:56:07.441: E/AndroidRuntime(809):  at java.lang.reflect.Method.invoke(Method.java:511)
04-20 09:56:07.441: E/AndroidRuntime(809):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
04-20 09:56:07.441: E/AndroidRuntime(809):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
04-20 09:56:07.441: E/AndroidRuntime(809):  at dalvik.system.NativeStart.main(Native Method)
04-20 09:56:07.441: E/AndroidRuntime(809): Caused by: java.lang.reflect.InvocationTargetException
04-20 09:56:07.441: E/AndroidRuntime(809):  at java.lang.reflect.Method.invokeNative(Native Method)
04-20 09:56:07.441: E/AndroidRuntime(809):  at java.lang.reflect.Method.invoke(Method.java:511)
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.view.View$1.onClick(View.java:3586)
04-20 09:56:07.441: E/AndroidRuntime(809):  ... 11 more
04-20 09:56:07.441: E/AndroidRuntime(809): Caused by: java.lang.NullPointerException: file
04-20 09:56:07.441: E/AndroidRuntime(809):  at android.net.Uri.fromFile(Uri.java:441)
04-20 09:56:07.441: E/AndroidRuntime(809):  at com.mycompany.myapp.utils.FileUtils.getOutputMediaFileUri(FileUtils.java:19)
04-20 09:56:07.441: E/AndroidRuntime(809):  at com.mycompany.myapp.MyActivity.dispatchCameraIntent(MyActivity.java:56)
04-20 09:56:07.441: E/AndroidRuntime(809):  ... 14 more
04-20 09:56:10.860: I/Process(809): Sending signal. PID: 809 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:35:34.713

您是否已将[http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE](http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE)和[http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE)添加到清单中？

# regex - sed - 替换匹配模式的几个连续行

> ID：16123102
> 
> 赞同：4
> 
> 时间：2013-04-20T17:20:56.367
> 
> 标签：regex, linux, bash, sed

我正在尝试用我的文本替换文件中的两个连续行。例如：
**testfile.rb**

```
class Test
  def procedure
    nil
  end
end 
```

我正在努力实现这一目标：
**testfile.rb**

```
class Test
  def procedure
    nil
  finish
finish 
```

所以我需要替换最后两行，但这不起作用：

```
sed -i 's/^\s\send\nend/  finish\nfinish/' testfile.rb 
```

我知道它失败了，因为替换是逐行进行的。但是我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T17:31:41.007

```
sed '/end$/N;//s/end/finish/g' testfile.rb 
```

结果

```
class Test
  def procedure
    nil
  finish
finish 
```

*   我们只想查看可能同时包含的一对行`end`，因此仅在第一行以 结尾时才在第二行中读取`end`
*   替换`end`为`finish`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:26:18.470

```
perl -i -0777 -pe 's/\bend\s*\n\s*end$/finish\nfinish/ms' testfile.rb 
```

此代码段在多行模式下工作。`sed`默认情况下是基于一行的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:34:59.287

另一种方式：

```
sed 'N;s/^  end\nend$/  finish\nfinish/;t;P;D' testfile.rb 
```

灵活的缩进：

```
sed 'N;s/^\( *\)end\n\( *\)end$/\1finish\n\2finish/;t;P;D' testfile.rb 
```

要获得更灵活的缩进，请将空格更改为`[[:space:]]`.

# java - Java - 跟踪对象类型

> ID：16123103
> 
> 赞同：2
> 
> 时间：2013-04-20T17:21:00.453
> 
> 标签：java, oop

假设我有抽象类 Car，并且有 x 个扩展类 Car 的具体类（RedCar、BlueCar ...）。然后我有具有属性 Car[] cars 的类 Garage。

我想为 Garage 类编写一个布尔方法，该方法将遍历汽车并在找到搜索汽车（作为参数传递的具体类型之一（RedCar、BlueCar..））时返回 true，否则返回 false。

最好的方法是什么？

现在，我有这样的事情：

```
public boolean hasCar(Class<? extends Car> c) {
    for (int i = 0; i < this.cars.length; i++) {
        if (c.isInstance(this.cars[i])) {
            return true;
        }
    }
    return false;
} 
```

但是如果我创建一个包含所有可能的 Car 类型（Car 的子类）的枚举，向 Car 类添加一个属性，它将保存枚举中的常量并基于它进行比较，这不是更好吗？

像这样的东西：

```
public enum CarType{
    RED_CAR, BLUE_CAR
}

public abstract class Car{
    public CarType type;
    Car(CarType type){
        this.type = type;
    }
}

public class RedCar extends Car{
    public RedCar(){
        super(CarType.RED_CAR);
    }
}

public class BlueCar extends Car{
    public BlueCar(){
        super(CarType.BLUE_CAR);
    }
}

public class Garage{
    private Car[] cars;
    public boolean hasCar(CarType type) {
        for (int i = 0; i < this.cars.length; i++) {
            if(this.cars[i].type == type){
                return true;
            }
        }
        return false;
    }
} 
```

哪一个是更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:32:04.703

如果所有子类都没有向基类添加任何状态，并且没有通过向基类添加或覆盖方法来更改或添加行为，那么您不应该有子类。只需拥有一个带有`type`属性的 Car 类就足够了。

如果子类有充分的理由存在，那么您确实可以使用枚举，但这会阻止添加任何其他类型的汽车（也不会更改枚举）。

拥有一种搜索特定类型汽车的方法对我来说似乎是一种设计气味。这可能意味着 Car 类不够多态：instanceof 和 casts 不是很面向对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:40:18.393

您发布的枚举解决方案仅在您想确认找到某种*类型*的汽车时才有效。不是特定的汽车对象本身。此外，如果您的 Car 子类除了类型变量之外没有任何区别，您可能不需要子类。

第一种方法看起来不错，并且可以像这样缩短（一点）：

```
public boolean hasCar(Class<? extends Car> c) {
    for (Car car : this.cars) {
        if (c.isInstance(car) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:32:37.467

如果您肯定坚持使用不同颜色的汽车作为子类型，我会说您的第一个版本更好 - 您的第二个版本将涉及每次添加新类型汽车时更新枚举并且涉及大量复制和 -为构造函数粘贴样式编码。

但是，我建议如果您想在车库中搜索某些颜色的汽车，将颜色作为汽车的属性而不是检查汽车的类型是有意义的。在您的第二个示例中，代码看起来“更干净”，因为您没有使用反射，但是您基本上得到了重复的信息，因为汽车的颜色由它的类型和它的 CarType 属性表示。简单地拥有一个带有 Color 值的 Car 类型会使这段代码更短更整洁。尽管如此，我不知道你最终想用这个做什么，所以你拥有亚型的方法可能仍然是最好的 - 拿我说的话加点盐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T18:06:28.080

您可以使用的另一种方法是传递一个过滤器对象并询问汽车本身是否与过滤器匹配。过滤器的实现细节可能取决于您的实际示例（甚至可以使用**instanceof()**进行比较），但在您给出的简化示例中，它可能是指定您正在寻找的颜色的字符串或枚举。就像是

```
public class CarFilter()
{
String Color;
} 
```

在汽车的基类中，您有一个方法：

```
public boolean matchesFilter(CarFilter filter){} //maybe abstract? 
```

在派生类 RedCar 中，该方法可能像这样实现：

```
public boolean matchesFilter(CarFilter filter)
{
 return filter.Color == "red"; //MAYBE case insensitive?
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-21T02:24:39.313

要回答这个问题，我必须问自己哪个提供了最简单的可扩展性？我会说第一个实现。

# vb.net - 随机选择文件夹中的文件并移动到另一个文件夹

> ID：16123107
> 
> 赞同：1
> 
> 时间：2013-04-20T17:21:14.490
> 
> 标签：vb.net, copy, move, paste, cut

我需要从一个目录中选择一个文件并移动到另一个目录。为此，我需要随机选择一个文件。

我需要选择一个随机文件（任何分机都可以），但我不知道如何使用`return`，因为我是`VB.NET`. 所以请给出想法和代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:17:00.253

像这样？

```
Sub MoveRandomFile(from$, to$)
    Static r As New Random
    Dim Files = New IO.DirectoryInfo([from]).GetFiles
    Dim FileToMove = Files(r.Next(0, Files.Count))

    IO.File.Move(FileToMove.FullName, FileToMove.FullName.Replace([from], [to]))
End Sub 
```

或者，如果您只想返回一个随机文件：

```
Function GetRandomFile(folder$) As IO.FileInfo
    Static r As New Random
    Dim Files = New IO.DirectoryInfo(folder).GetFiles

    Return Files(r.Next(0, Files.Count))
End Function 
```

static 关键字在第一次调用方法时创建变量，并在下次调用时保留它。我们需要这样做的原因是因为随机对象使用了一个种子，就像在 Minecraft 中一样，并且这个种子是使用有关正在运行的进程的信息生成的。因此，如果您每次创建一个新的随机对象，它每次都会选择相同的文件。

# c# - 如何使用可以接受许多不同类型的参数来 p/调用函数？

> ID：16123108
> 
> 赞同：0
> 
> 时间：2013-04-20T17:21:17.287
> 
> 标签：c#, pinvoke

看一看：

```
[DllImport("User32.dll")]
public static extern StatusCode DisplayConfigGetDeviceInfo(
    ref IDisplayConfigInfo a
); 
```

现在我的结构继承自 IDisplayConfigInfo：

```
var displayConfigTargetDeviceName = new DisplayConfigTargetDeviceName
{
    header = new DisplayConfigDeviceInfoHeader
    {
        adapterId = targetModeInfo.adapterId,
        id = targetModeInfo.id,
        size = Marshal.SizeOf(typeof(DisplayConfigTargetDeviceName)),
        type = DisplayConfigDeviceInfoType.GetTargetName,
    }
};
var configTargetDeviceName = (IDisplayConfigInfo) displayConfigTargetDeviceName;
var retval = CCDWrapper.DisplayConfigGetDeviceInfo(ref configTargetDeviceName); 
```

现在有一个问题。retval 将返回“InvalidParameter”值。这是为什么？这是因为我尝试使用界面，但我不明白为什么。

当我明确地说 DisplayConfigGetDeviceInfo() 接受 DisplayConfigTargetDeviceName 而不是接口，并直接将 displayconfigTargetDeviceName 传递给它时，它就可以工作了。

问题是，我不想为每个结构创建 8-9 个重载。请注意，C++ 版本只有一个重载。它会从我传递的指针中找出其余部分。

// 结构：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
public struct DisplayConfigTargetDeviceName : IDisplayConfigInfo
{
    public DisplayConfigDeviceInfoHeader header;
    public DisplayConfigTargetDeviceNameFlags flags;
    public DisplayConfigVideoOutputTechnology outputTechnology;
    public ushort edidManufactureId;
    public ushort edidProductCodeId;
    public uint connectorInstance;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 64)] 
    public string monitorFriendlyDeviceName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)] 
    public string monitorDevicePath;
}

[StructLayout(LayoutKind.Sequential)]
public struct DisplayConfigDeviceInfoHeader
{
    public DisplayConfigDeviceInfoType type;
    public int size;
    public LUID adapterId;
    public uint id;
} 
```

而 IDisplayConfig 接口为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:40:48.997

感谢大卫，我能够想出聪明的解决方案（imo），它似乎工作得很好。

```
[DllImport("User32.dll")]
private static extern StatusCode DisplayConfigSetDeviceInfo(IntPtr requestPacket);
public static StatusCode DisplayConfigSetDeviceInfo<T>(ref T displayConfig) 
   where T : IDisplayConfigInfo
{
    return WrapStructureAndCall(ref displayConfig, DisplayConfigSetDeviceInfo);
}

[DllImport("User32.dll")]
private static extern StatusCode DisplayConfigGetDeviceInfo(IntPtr targetDeviceName);
public static StatusCode DisplayConfigGetDeviceInfo<T>(ref T displayConfig) 
  where T : IDisplayConfigInfo
{
    return WrapStructureAndCall(ref displayConfig, DisplayConfigGetDeviceInfo);
}

public static StatusCode WrapStructureAndCall<T>(ref T displayConfig,
    Func<IntPtr, StatusCode> func) where T : IDisplayConfigInfo
{
    var ptr = Marshal.AllocHGlobal(Marshal.SizeOf(displayConfig));
    Marshal.StructureToPtr(displayConfig, ptr, false);

    var retval = func(ptr);

    displayConfig = (T)Marshal.PtrToStructure(ptr, displayConfig.GetType());

    Marshal.FreeHGlobal(ptr);
    return retval;
} 
```

# ruby-on-rails - Rails 控制台：属性返回 false，但使用 to_yaml 正确显示

> ID：16123111
> 
> 赞同：0
> 
> 时间：2013-04-20T17:21:29.330
> 
> 标签：ruby-on-rails, db2, rails-activerecord, ruby-on-rails-2

也许我遗漏了一些东西，但我做了研究，无法找出为什么会这样。我正在使用 Rails 2.3.16 和 ruby​​ 1.9.3，由一个巨大的 ibm-db2 支持。

假设我有一个类 Foo （我试图在这里建立一个简短的例子）

```
class Foo < ActiveRecord::Base
end 
```

该类具有属性：电话（整数）和邮件（字符串）。

当我使用 Rails 控制台进行调试时

```
bundle exec ./script/console      , or
RAILS_ENV=production bundle exec ./script/console 
```

我可以通过执行以下操作加载 Foo 实例：

```
f = Foo.find_by_phone(123)
=> #<Foo phone: false, mail: "test@example.org"> 
```

如果我尝试使用 getter-method 来获取`phone`-attribute：

```
f.phone
=> false 
```

但是信息必须在那里，因为 rails i) 找到了对象并且 ii) 您可以执行以下 yaml 输出：

```
y f
---- !ruby/object:Foo
attributes: 
 phone: 123
 mail: test@example.org
attributes_cache: {} 
```

**感谢大家**提前帮助我，我确定我忽略了一些东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T20:29:45.540

问题似乎是，ActiveRecord 将 DB2 短类型解释为布尔值。是否有可能改变这种（愚蠢的？）行为？

# c# - 如何从同一个表中的两个不同列中读取数据并在字符串生成器中返回？

> ID：16123114
> 
> 赞同：2
> 
> 时间：2013-04-20T17:21:41.943
> 
> 标签：c#, asp.net

我在从同一个数据库表中的两个不同列读取数据时遇到问题。（对不起，我的英语不好。）

```
String status = "1";

SqlConnection conn = new SqlConnection("Server=localhost;Integrated Security=true;database=WebsiteDatabase");
conn.Open();
SqlCommand cmdname = conn.CreateCommand();
cmdname.CommandText = "select product, quantity from tlbOrder where status = '1'";

//get product name and quantity
cmdname.Parameters.Add("@status", status);
SqlDataReader dr = cmdname.ExecuteReader();
StringBuilder sb = new StringBuilder();
while (dr.Read())
{
    sb.AppendFormat("{0}, ", dr[0].ToString());
}

label1 = ""+sb.ToString(); 
```

但是，仅返回“产品”详细信息。

预期结果：带有产品名称 + 数量字符串的标签（例如笔记本电脑 1、键盘 3、扬声器 5）等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T17:22:47.103

嗯，在AppendFormat中再添加一个参数是没有问题的

```
while (dremail.Read())
{
    sb.AppendFormat("{0}, {1}", dr[0].ToString(), dr[1].ToString());
} 
```

但是，您的代码将尝试在同一标签中插入可能很长的产品列表。
也许更好的方法应该是使用 List 或 GridView

# javascript - 将 jQuery 代码附加到 iframe 中不起作用

> ID：16123116
> 
> 赞同：0
> 
> 时间：2013-04-20T17:22:05.567
> 
> 标签：javascript, jquery, html, iframe

我遇到了一个很奇怪的问题！

我写了以下代码：

```
<script type="text/javascript" src="jquery-1.8.3.min.js"></script>

<textarea id="code">
    <div id="hello">Hello world!</div>
    <script type="text/javascript">
    $(function(){
        $("#hello").css({"border":"solid 3px red"});
        alert($("#hello").size());
    });
    </script>
</textarea>

<iframe src="iframe.html"></iframe>

<script type="text/javascript">
    $(function(){
        $("iframe").on("load",function(){
            $(this).contents().find("body").append($("#code").val());
        });
    });
</script> 
```

“iframe.html”文件仅包含对 jQuery 库的调用。

结果是“Hello world！” 显示在 iframe 中但没有红色边框！似乎这`$("#hello")`行不通。事实上，如果我这样做`alert($("#hello").size())`，我会得到“0”。

你有什么主意吗？谢谢！

编辑：添加“警报”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:38:36.090

$(this).contents().find("body").append($("#code").val()); 仅获取当前值，因此它可能不会复制与其链接的任何 css 值。 [http://api.jquery.com/val/](http://api.jquery.com/val/)

我建议首先在 1 个文件中对其进行测试，看看它做了什么，所以现在删除 iframe 部分并检查 1 个文件上的 .size() 。这样你就知道 .val 和 .size() 在你的#hello 上的行为了。

试试这个作为下面的脚本：

```
<script type="text/javascript">
$(function(){
$("iframe").on("load",function(){
alert($("#code").val());
    var scriptx = $("#code").val();
    $(this).contents().find("body")[0].innerHTML = scriptx;
        });
    });
</script>
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:34:55.817

我认为html格式是错误的。如果您放置一些 html 元素，那么您将`div`放在文本区域内部和任何文本区域内部，那么这些元素将被简单地视为一些文本，并且 html 元素不会在浏览器中呈现。因此，您可以将 div 元素放在文本区域之外。

```
<textarea id="code"></textarea>
<div id="hello">Hello world!</div> 
```

我希望这会奏效.. :)

# ios - 带有逗号小数分隔符的 NSNumberFormatter

> ID：16123119
> 
> 赞同：22
> 
> 时间：2013-04-20T17:22:41.080
> 
> 标签：ios, objective-c, decimal, separator, nsnumberformatter

我试图将“12000.54”之类的 NSString 转换为“12.000,54”。我写了一个 NSNumberFormatter 实例。

```
NSNumberFormatter *formatter = [[[NSNumberFormatter alloc] init] autorelease];
[formatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
[formatter setGroupingSeparator:@"."];
[formatter setDecimalSeparator:@","]; 
```

但是当我 NSLog 时：

```
NSLog(@"%@",[formatter stringFromNumber:[formatter numberFromString:value]]); 
```

它打印空值。如果我用一个点更改逗号，它就可以正常工作。我只是希望能够为我的分隔符字段（逗号、点、斜杠等）输入我想要的内容，并且我有不同的输出：例如 12/000,54 12.000.54 12,000,54。

你知道我该怎么处理吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-06-23T15:39:58.063

我建议不要对分隔符进行硬编码，以确保基于 iPhone 区域设置的正确分隔符行为。最简单的方法是：

**使用objective-c**

```
NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc]init];
numberFormatter.locale = [NSLocale currentLocale];// this ensures the right separator behavior
numberFormatter.numberStyle = NSNumberFormatterDecimalStyle;
numberFormatter.usesGroupingSeparator = YES;

// example for writing the number object into a label
cell.finalValueLabel.text = [NSString StringWithFormat:@"%@", [numberFormatter stringForObjectValue:numberFromString]]; // your var name is not well chosen 
```

**使用 SWIFT 3**

```
 let formatter = NumberFormatter()
 formatter.locale = NSLocale.current // this ensures the right separator behavior
 formatter.numberStyle = NumberFormatter.Style.decimal
 formatter.usesGroupingSeparator = true

 // example for writing the number object into a label
 // your variable "numberFromString" needs to be a NSNumber object
 finalValueLabel.text = formatter.string(from: numberFromString)! // your var name is not well chosen 
```

我不会使用 var-name "numberFromString" 因为它是一种`NSNumberFormatter`方法。祝你好运！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-04-21T15:04:20.570

所以这个问题是有效的：我自己回答:)

我有一个从 sqlite 读取的十进制值（例如 12000 或 12000.54）直接转换为 NSString。我必须在代码中的某个位置使用不同的分隔符。

```
NSNumberFormatter *formatter = [[[NSNumberFormatter alloc] init] autorelease];
[formatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
[formatter setGroupingSeparator:@""];
[formatter setDecimalSeparator:@"."];

// Decimal values read from any db are always written with no grouping separator and a comma for decimal.

NSNumber *numberFromString = [formatter numberFromString:@"12000.54"]];

[formatter setGroupingSeparator:@" "]; // Whatever you want here
[formatter setDecimalSeparator:@","]; // Whatever you want here

NSString *finalValue = [formatter stringFromNumber:numberFromString];

NSLog(@"%@",finalValue); // Print 12 000,54 
```

问题解决了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-22T19:31:33.943

我最近发现的最简单的解决方案是：

```
NSString *localizedString = [NSString localizedStringWithFormat:@"%@", @1234567]; 
```

也适用于整数：

```
NSString *localizedString = [NSString localizedStringWithFormat:@"%d", 1234567]; 
```

在 Xcode 6 Playground 中验证。但是文档说这个功能一直存在。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-07-09T10:07:40.130

```
NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
[numberFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
numberFormatter.usesGroupingSeparator = YES;
[numberFormatter setMaximumFractionDigits:2];
[numberFormatter setMinimumFractionDigits:2];
NSString *formattedNumberString = [numberFormatter stringFromNumber:@122344.00];` 
```

如果您正在处理小数点，这将解决您的四舍五入问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-12T22:12:19.420

对于货币使用...

```
let numberFormatter = NumberFormatter()

// Produces symbol (i.e. "$ " for en_US_POSIX) and decimal formatting
numberFormatter.numberStyle = .currency

// Produces commas; i.e. "1,234"
numberFormatter.usesGroupingSeparator = true
numberFormatter.groupingSize = 3 
```

示例用法：

```
let value: Double = 12345.6789
numberFormatter.string(from: value as NSNumber) 
```

产量...

```
"$ 12,345.68" 
```

正如人们所期望的那样

# object - 如何获取在 angularjs 中更改的对象？

> ID：16123120
> 
> 赞同：6
> 
> 时间：2013-04-20T17:22:45.857
> 
> 标签：object, angularjs, get, watch

我使用这个函数来观察一组对象的变化：

```
$scope.$watch('Data', function (newVal) { /*...*/ }, true); 
```

如何获取属性已更改的对象，以便可以将其推送到数组中？例如：

```
var myApp = angular.module("myApp", []);

myApp.factory("Data", function(){
var Data = [{id:1, property: "Random"}, {id:2, property: "Random again"}];
return Data;
});

var myBigArray = [];

function tableCtrl($scope, Data){
    $scope.TheData = Data;
    $scope.$watch("TheData", function() {

    //Here an object should be pushed
    myBigArray.push(">>Object in which property has been changed <<<");
    }, true);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-03T20:54:17.837

**编辑**：请注意，这个解决方案被证明是一个不好的做法，因为它添加了很多观察者，这是你不想要的，因为它有性能损失。

=======

我最终想出了这个解决方案：

```
items.query(function (result) {
    _(result).each(function (item, i) {
        $scope.items.push(item);
        $scope.$watch('items[' + i + ']' , function(){
            console.log(item); // This is the item that changed.
        }, true);
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T09:04:30.987

我目前在 Angular 中看不到获取更改对象的方法...我怀疑您可能需要遍历新数组并尝试找到与旧数组的差异...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T12:21:43.120

$watch 仍然没有这样的选项，但你可以使用 jQuery 插件，[http://archive.plugins.jquery.com/project/jquery-diff](http://archive.plugins.jquery.com/project/jquery-diff)

我使用 $watch 使用 AngularJS 实现了撤消/重做，mb 这可以提供帮助

```
//History Manager Factory
.factory('HistoryManager', function () {
    return function(scope) {

        this.container = Array();
        this.index = -1;
        this.lock = false;

        //Insert new step into array of steps
        this.pushDo = function() {
            //we make sure that we have real changes by converting to json, 
            //and getting rid of all hash changes
            if(this.container.length == 0 || (angular.toJson(scope.widgetSlider) != angular.toJson(this.container[this.index][0]))) {
                //check if current change didn't came from "undo" change'
                if(this.lock) {
                    return;
                }
                //Cutting array, from current index, because of new change added
                if(this.index < this.container.length-1) {
                    this.container = this.container.slice(0, this.index+1);
                }

                var currentStepSlider = angular.copy(scope.widgetSlider);
                var selectedWidgetIndex = scope.widgetSlider.widgets.indexOf(scope.widgetCurrent);
                //Initialising index, because of new "Do" added
                this.index = this.container.length;
                this.container.push([currentStepSlider, selectedWidgetIndex]);

                if (this.onDo) {
                    this.onDo();
                }
            }
        }

        //Upon undo returns previous do
        this.undo = function() {
            this.lock = true;
            if(this.index>0){
                this.index--;
                scope.widgetSlider = angular.copy(this.container[this.index][0]);
                var selectedWidgetIndex = this.container[this.index][1];
                scope.widgetCurrent = scope.widgetSlider.widgets[selectedWidgetIndex];
            }
            this.lock = false;
        }

        //Upon redo returns next do
        this.redo = function() {
            if(this.index < this.container.length-1) {
                this.index++;
                scope.widgetSlider = angular.copy(this.container[this.index][0]);
                var selectedWidgetIndex = this.container[this.index][1];
                scope.widgetCurrent = scope.widgetSlider.widgets[selectedWidgetIndex];
            }
        }
    }
}) 
```

;

# android - Android build ant + .bat 未执行所有命令

> ID：16123128
> 
> 赞同：0
> 
> 时间：2013-04-20T17:23:25.277
> 
> 标签：android, ant, batch-file

我正在开发一个脚本来构建引用 lib-project 的 android 项目，因此在启动 ant 之前有一些准备工作，所以我决定将这些操作放入**.bat-file**中。

**.bat 的结构**如下：

```
 1 - #some preparation actions (moving files, updating properties etc.)
    2 - ant debug
    3 - #clean everything that was done in the first section 
```

**所以，问题是在第二部分 - 'ant debug'**之后没有执行任何操作- 尽管构建成功。

任何人都可以阐明我做错了什么以及如何在执行**ant debug** -command 后制作脚本吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T20:56:04.177

尝试以下

```
...
call ant ...
... 
```

# javascript - SetInterval 调用上的严格模式范围错误

> ID：16123130
> 
> 赞同：1
> 
> 时间：2013-04-20T17:23:34.467
> 
> 标签：javascript, jquery

下面是我正在尝试做的一个伪示例

在非严格模式下这有效，但在严格模式下，当 setInterval 触发时，我得到一个未定义的错误。该脚本作为插件从另一个 jquery 脚本调用，然后调用 init 部分。

从这里阅读，这似乎是一个全局范围/上下文问题，但我不知道如何继续

```
(function($, window, document) {
    'use strict'; // remove and things work
    var opts,test;

    test = function(options) {
        opts = $.extend(test.prototype.opts, test.prototype.defaults, options);
    };

    test.prototype.Save = function () {
        console.log('hi');
    };

    test.prototype.defaults = {
        _interval_id: null
    };

    test.prototype.opts = {};

    $.bla.plugins.foobar = function() {
        var base = this,
            bar;

        base.init = function() {
            bar = new test();
            opts = test.prototype.opts;
            bar.Save(); // works
            opts._interval_id = setInterval('bar.Save();', 10000); //  called but bar is not defined
        };
    };
})(jQuery, window, document); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:36:43.187

当一个字符串被 解释时`setInterval`，它在全局范围内，而不是调用它的函数的范围内。传递要调用的实际函数，而不是字符串：

```
setInterval(bar.Save, 10000); 
```

如果您允许`bar`或被`bar.Save`修改，并且您希望自动获取更改，您应该传递一个每次重新评估它的函数：

```
setInterval(function() { bar.Save(); }, 10000); 
```

# prestashop - 如何检测查看的页面是否是子类别

> ID：16123132
> 
> 赞同：0
> 
> 时间：2013-04-20T17:23:39.703
> 
> 标签：prestashop

我实际上正在使用 Prestashop 1.4.9 进行网络商务项目，我想检测当前查看的页面并查找该页面是否是子类别（例如在 category.tpl 文件中）。

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:36:41.127

找到了 ！通过`$category->level_depth`我们可以确定当前页面是类别还是子类别。就我而言，我不得不使用：

```
{if $category->level_depth == 2}
{/if} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T18:03:08.573

对。在 ps_category 表中，每个类别都有列 level_depth。如果 level_depth ==2，这是类别，如果 level_depth ==3 是子类别。在此处查看更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-21T05:47:15.863

您也可以通过 id_parent 检查它。如果一个类别是另一个类别的子类别，则父类别 id 放在 id_parent 列中，否则为 0 。所以你可以检查它

```
{if $category->id_parent != 0}
 ......
 ......
{/if} 
```

级别深度也可以，但它用于类别树中的深度，就像它的深度一样。级别深度 2 表示该类别有没有父类别的父类别，就像该类别有父亲但没有祖父 :) 。而级别 3 意味着该类别有一个父亲，并且该类别也有一个祖父；）。

我认为最好使用 id_parent。

谢谢

# php - 在 if 语句中使用函数时出现“致命错误：调用未定义函数”？

> ID：16123134
> 
> 赞同：1
> 
> 时间：2013-04-20T17:23:57.020
> 
> 标签：php, function, validation, variables, if-statement

好的，所以我刚刚完成了一个用于验证`firstname`表单上的字段的功能。

此功能可自行正常工作。

但由于我想让这个功能可以在多个网站上重复使用，所以我添加了一个`if`是否使用它的声明。下面的代码解释了这一点：

相关PHP代码：

```
//Specify what form elements need validating:
$validateFirstname = true;

//array to store error messages
$mistakes = array();

if ($validateFirstname=true) {
    //Call first name validation function
    $firstname = '';
    if (!empty($_POST['firstname'])) {
        $firstname = mysql_real_escape_string(stripslashes(trim($_POST['firstname'])));
    }
    $firstname = validFirstname($firstname);
    if ($firstname === '') {
        $mistakes[] = 'Your first name is either empty or Enter only ALPHABET characters.';
    }
    function validFirstname($firstname) {
        if (!ctype_alpha(str_replace(' ', '', $firstname))) {
            return '';
        } else {
            return $firstname;
        }
    }
} 
```

因此，如果没有这个`if ($validateFirstname=true)`代码运行良好，但我添加它的那一刻；我收到以下错误消息：

```
Fatal error: Call to undefined function validFirstname() 
```

您根本无法`if`在 PHP 中的语句中使用函数吗？我对以这种方式使用它们还很陌生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T17:30:04.160

条件函数（在条件内定义的函数）**必须**在引用之前定义。[这是手册所说的](http://www.php.net/manual/en/functions.user-defined.php)：

> 函数在被引用之前不需要定义，**除非**一个函数是有条件地定义的，如下面的两个例子所示。
> 
> 当以条件方式定义函数时，例如所示的两个示例。它的定义必须在被调用**之前进行处理。**

因此，如果您想以这种方式使用它，则应将其放在 if 条件的开头或条件之外。

```
// Either:
if ($validateFirstname==true) {
    function validFirstname($firstname) {}
}

// Or, and I'd rather do it this way, because function is
// created during "compilation" phase
function validFirstname($firstname) {}
if ($validateFirstname==true) {
    // ...
} 
```

也不是该函数（即使在条件内创建）被推送到全局范围：

> PHP 中的所有函数和类都具有全局作用域——即使它们是在函数内部定义的，它们也可以在函数外部调用，反之亦然。

因此，一旦代码被评估，它是在条件内声明还是有意在全局范围内声明都无关紧要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T17:28:33.597

在条件上下文（如`if`主体）中声明的函数，只能在声明后使用。

```
if ($validateFirstname == true) {
    //Call first name validation function
    function validFirstname($firstname) {
        // function body
    }
    // $firstname initialisation
    $firstname = validFirstname($firstname);
    // ...
} 
```

（ps：改成`$validateFirstname = true`哪个`$validateFirstname == true`应该是你想要的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:27:18.497

```
if($validateFirstname=true) 
```

您在这里将值“true”分配给 $validateFirstname 您应该使用“==”进行比较，例如

```
 if($validateFirstname==true) 
```

这可能有助于您的“如果”问题

# ios - IOS MDM 服务器 IOS App OTA 部署

> ID：16123139
> 
> 赞同：2
> 
> 时间：2013-04-20T17:24:52.607
> 
> 标签：ios, mdm

我们使用 mac mini 构建了一个 MDM 服务器。我们有 2 个应用程序要推送给许多用户。一个应用程序将毫无问题地在远程设备上推送和下载。另一个显示错误“此时无法安装该应用程序”

第二个应用程序是一个较旧的应用程序。但是我们正在为 6.0 构建它。在控制台中，我们看到了这一点。

```
ipad SpringBoard[65] <Warning>: could not save thumbnail for downloading icon: image=(null) path='/var/mobile/Library/SpringBoard/DownloadingIconImageCache/ 
```

当设备连接到构建计算机时，可以构建和安装此应用程序。我们所有的签名都与第一个应用程序相同。我们还可以归档应用程序而不会出现任何错误。什么会导致这个应用程序无法安装，或者我们应该从什么开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:30:35.520

几个注释/想法：

a）看看这个（他们提到了同样的问题）

[通过 safari 安装 AD-HOC 发行版时遇到问题](https://stackoverflow.com/questions/9354936/trouble-installing-ad-hoc-distribution-through-safari)

[iOs 应用程序在安装时崩溃](https://stackoverflow.com/questions/8878216/ios-application-crash-on-install)

[临时分发失败](https://stackoverflow.com/questions/13495469/ad-hoc-distribution-fail)

[http://community.phonegap.com/nitobi/topics/not_installing_my_application_in_ipod](http://community.phonegap.com/nitobi/topics/not_installing_my_application_in_ipod)

b）您能否发布您的清单（如果您正在安装内部应用程序）？

如果您指向此清单中的图标，请仔细检查链接是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T17:28:37.607

好的，这需要几天时间才能解决...在我的情况下，有时另一个图标被添加到构建设置中。我们确实更改了包的名称，所以我假设 xcode 会自动填充图标信息？

在信息选项卡中检查以确保您只有一个“图标文件”属性（要清楚，您应该能够打开下拉菜单并显示子菜单......我拥有的是 2 个“图标文件”部分.) 在我删除了第二组图标文件后，它推得很好。

希望能帮助其他人找出一个非常令人沮丧的情况

# facebook-graph-api - 错误 OAuthException: (#200) 邀请事件时

> ID：16123140
> 
> 赞同：1
> 
> 时间：2013-04-20T17:24:53.673
> 
> 标签：facebook-graph-api, oauth-2.0, facebook-fql, facebook-php-sdk

我收到错误：致命错误：未捕获的 OAuthException：（＃200）

当我尝试通过应用程序邀请人们参加活动时。

我的步骤： 1\. 获得具有权限的长期令牌：create_event create_note publish_actions publish_stream rsvp_event user_events 2\. 获取尚未被邀请参加活动的朋友的用户 ID。3\. 每个邀请分成 50 人并发送。

邀请码：

```
$friends = $facebook->api(array(
     'method' => 'fql.query',
     'query' => "SELECT uid,name FROM user WHERE uid IN 
(SELECT uid1 FROM friend WHERE uid2=me()) AND NOT 
(uid IN (SELECT uid FROM event_member where eid = '$eventid'))"));

foreach ($friends as $value) 
{
    if (!isset($allids))
    {
        $allids = $value['uid'];
    }
    else
    {
        $allids .= ',' . $value['uid'];
    }
    $count++;
    $invitedusers++;
    if ($count > 49) 
    {
    //$splitinvite = $facebook->api($eventid . '/invited?users=' . $allids, 'POST');
    unset($allids);
    $count = 0;
    }
}

$facebook->api($eventid . '/invited?users=' . $allids, 'POST'); 
```

我已经分离了用户 ID，以确保它们以 Userid_1、Userid_2、Userid_3 格式正确设置我使用图形令牌调试器检查了令牌，并且所有权限都设置正确。任何人的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T09:59:09.647

一种可能性是以下代码。但这工作起来很慢，因为它会为每个人发送一个查询。检查 37 个人需要 30 秒。如上图一次查询 50 人，30 秒内邀请超过 1000 人。

**如果有人可以尝试找到更好的方法，我会appearacheate它！！！**
最好的方法是过滤 FQL 查询（如果可能的话）。

工作缓慢的代码：

```
 foreach ($friends as $value) 
    {       
        try
        {
        $splitinvite = $facebook->api($eventid . '/invited?user=' . $value['uid'],'POST'); 
        $count++;
        }
        catch (Exception $e) 
        {
// Users privacy setting blocked inviting him, has blocked you or has blocked you from inviting 
        }
} 
```

# javascript - jqPlot 从左到右缩放高亮

> ID：16123143
> 
> 赞同：0
> 
> 时间：2013-04-20T17:25:02.407
> 
> 标签：javascript, jquery, jquery-plugins, jqplot

我有一个图表，在 X 轴上显示日期，在 Y 轴上显示一些值，我想做的是：当用户选择“缩放区域”时，荧光笔应该自动从图表的顶部到底部进行选择，这样用户只专注于从左到右选择一个切片。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:33:42.283

啊啊啊找到了

```
curosr -> constrainZoomTo: "x" 
```

# css - CSS在中心对齐图像错误

> ID：16123146
> 
> 赞同：2
> 
> 时间：2013-04-20T17:25:22.940
> 
> 标签：css

我有一个名为容器的 < div > 包装图像和另一个小的 < div >。问题是，我正在尝试将图像对齐到容器的中心。如果是大图。它会放在中间，但如果是小图像，它会向左侧倾斜。如何使图像位置居中？不使用边距。因为如果我使用 margin ，小图像将在中心，但大图像将向右侧倾斜。

我的 CSS

```
 .container{background-color: #ED8713; 
 height: 300px; 
 width: 300px;
 margin: 60px;}

 .box6{background-color: #FFFFFF;
  width: 270px;height:80px;
 margin: 5px;}
 img {margin: 10px;} 
```

我的 HTML

```
<meta charset="utf-8" />
<link rel="stylesheet" href="float.css">

<div class="container"><img src="s.jpg"/>
                    <div class="box6"></div>

</div>

<div class="container"><img src="q.jpg"/>
                    <div class="box6"></div>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:29:00.377

以这种方式更改您的 CSS：

```
img {margin: 10px auto; display: block;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:30:02.483

尝试这个 。[W3C](http://www.w3.org/Style/Examples/007/center.en.html)

[http://jsfiddle.net/QsN6q/](http://jsfiddle.net/QsN6q/)

```
img{
    display: block;
    margin-left: auto;
    margin-right: auto } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:27:11.240

为您的图像创建一个包装器 div 并将包装器 div 的 css 设置为；

```
#wrapper {text-align: center;} 
```

这会将包装器中的所有元素设置到容器的中心，因为包装器 div 将是父 div 的 100% 宽度，因为它是一个块元素。

完整示例

```
#wrapper {text-align: center;}

<div id="container">
    <div id="wrapper"><img /></div>
    <div id="small"><p>Some text</p></div>
</div> 
```

或者您可以使用自动边距自动将边距宽度设置为等于`img`;

```
image {margin: 0 auto;} 
```

但是你说你不想使用保证金，选择权在你！

祝你好运

# php - 刷新页面时出现随机codeigniter错误“无法修改标头信息-标头已发送”

> ID：16123149
> 
> 赞同：0
> 
> 时间：2013-04-20T17:25:31.130
> 
> 标签：php, codeigniter, session, http-headers, codeigniter-2

我已经在这里阅读了半打类似的问题，并且已经仔细检查了我的图书馆之前`<?php`或之后没有空格。`?>`

好的，请注意，我随机收到此**错误**。当我在页面上并多次按 CTRL+R （刷新）时，连续尝试 2 或 3 次，错误消息不存在，然后错误消息出现并保持多试几次..

我得到的确切错误信息是

```
<h4>A PHP Error was encountered</h4>

<p>Severity: Warning</p>
<p>Message:  Cannot modify header information - headers already sent by (output started at A:\work\fast\semi 6\software engineering\project\project2\main\repo\main_proj\application\config\admin_template.php:2)</p>
<p>Filename: libraries/Session.php</p>
<p>Line Number: 672</p> 
```

所以显然罪魁祸首似乎是 admin_template.php 库文件..

我调用库的控制器函数：

```
 public function view_items(){
    $this->session->set_userdata('f');
    $table="F";
    $this->admin_template->display_direct($table,'');
    } 
```

我在这里复制文件

请注意，`<?php` 在第 1 行

```
<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');
class Admin_template{

    private
    $selected_item=-1,

    $menu=
        array(
        'Items'=>
            array(
              'Add Item'=>'admin/items/add_item',
              'View Items'=>'admin/items/view_items',

            ),
        'Administration'=>
            array(
                'View Admins'=>'admin/administration/view_admins',
                'View Representatives'=>'admin/administration/view_representative'
            )
        );

    public function __construct(){
    foreach($this->menu as $key=>$items){
        $this->menu[$key]['size']=sizeof($items);
    }
    $this->ci=&get_instance();
    }

    public function display_direct($view){
    $admin_template_data=array();
    $admin_template_data['content']=$view;
    $admin_template_data['heading']="heading";
    $admin_template_data['menu']=$this->menu;
    $admin_template_data['selected_item']=1;//$this->get_selected_item();

    return $this->ci->load->view('admin/main_template',$admin_template_data);
    }

} 
```

# java - 匹配和完美数学

> ID：16123151
> 
> 赞同：0
> 
> 时间：2013-04-20T17:25:51.017
> 
> 标签：java, c, algorithm, graph

从 Skiena 的书中，这不是硬件，只是我为面试做的准备。

鉴于这个问题，

无向图 G = (V, E) 的匹配是一组边，其中没有两条边有共同的顶点。完美匹配是所有顶点都匹配的匹配。

(a) 构造一个有 2n 个顶点和 n^2 条边的图 G，使得 G 有一个指数级的完美匹配。

(b) 构造一个具有 2n 个顶点和 n^2 条边的图 G，使得 G 恰好有一个唯一的完美匹配。

我只是不知道如何开始。对于a，我选择了n = 3，所以我现在知道我有6个顶点和9条边，并尝试将它们连接起来，但我不知道它是否完美匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:14:52.360

1.  对于 a)：在 2n 个顶点上取一个完整的二分图，两个分区各有 n 个顶点。这些图有 n! 完美匹配，当 n > 2 时大于 2^n。
2.  对于 b)：我们在 (n,n) 个顶点上构建类似于完整二分图的东西。调用分区 A=(1,2,3,...,n) 和 B=(n+1,n+2,n+3,...2n)。

    使A成为一个集团。

    对于 B 中的每个顶点 n+i，为 A 中的每个顶点 j 添加一条边 (n+i,j)，其中 j<=i。例如，顶点 n+1 仅入射到边 (n+1,1)；顶点 n+2 与 (n+2, 1) 和 (n+2,2) 相关；顶点 n+3 与 (n+3,1) (n+3,2) (n+3,3) 相关。

    这迫使唯一的完美匹配是 {e in E | e = (n+i,i) for some i in [1;n]} （尝试证明这一点以练习归纳）。

    由于 A 是 n 个顶点上的团，因此它有 n^2/2 - n/2 条边。A 和 B 之间的边的总和`sum from 1 to n`是 n^2/2 + n/2，所以我们一起得到
    n^2/2 - n/2 + n^2/2 + n/2 = n^2边缘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:02:53.487

这张图可能会帮助你（a）：

V={1,2,a,b}

E={(1,a),(1,b),(2,a),(2,b)}

2*2 个顶点

2^2 边

# javascript - 从外部服务器检索 json 数据

> ID：16123153
> 
> 赞同：2
> 
> 时间：2013-04-20T17:26:02.410
> 
> 标签：javascript, jquery, ajax, json, openstreetmap

我之前问过一个与此类似的问题，但也许这更清楚一点。

我正在尝试从 OSRM 路由服务器（此处的 API：[https](https://github.com/DennisOSRM/Project-OSRM/wiki/Server-api) ://github.com/DennisOSRM/Project-OSRM/wiki/Server-api ）检索 json 数据。

我目前正在使用此代码：

[http://jsfiddle.net/FhfVW/10/](http://jsfiddle.net/FhfVW/10/)

```
$(function () {
$("#getJSON").click(function () {
    var url = "http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001&jsonp=myroute";
    $.ajax({
        dataType: "json",
        url: url,
        jsonpCallback: 'myroute',
        success: function (data) {
            test = data.route_geometry;
            alert(test);
        }
    });
});
}); 
```

但是我没有得到任何回应。显然出了点问题，尽管我已经尝试删除回调和 'jsonp=myroute' 部分，但也没有成功。

谢谢你的帮助。

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:50:24.773

最后，我得到了这个工作

```
$(function () {
    var url = "http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001";
    $.ajax(url, {dataType:"jsonp", jsonp:"jsonp", cache:true}).success(function() {
       console.log(arguments);
    });
}); 
```

如果您将 url 放入由 jquery 生成的浏览器中，那么您会看到 400 错误，因为 jquery 添加了“& *= [TIMESTAMP]”参数。但是您的远程服务器说，然后该 url 格式错误。如果你给 jquery 一个真值的“缓存”选项，它不会附加“* ”参数。

如果您还有其他问题，请尝试将“成功”替换为“始终”回调，因为每次回调成功与否都会通知您。因为有时在 jquery 中会出现错误，而您在开发人员工具中不会注意到

# c++ - 在这种情况下如何使用 NULL？

> ID：16123154
> 
> 赞同：0
> 
> 时间：2013-04-20T17:26:11.863
> 
> 标签：c++, vector

我有一个存储 x、y、z 值的类“向量”。我有一个类'，它有多个'Vector'对象。

```
Camera::Camera(Vector Pos, Vector LookAt, Vector UpDir)
{
}
Camera Cam(Vector(3,3,3), Vector(0,0,0), Vector(0,0,0)); 
```

有时我不想通过 Vector(0,0,0)，我更愿意通过 NULL 并测试 LookAt/UpDir == NULL 与否，但 NULL 不想在这种情况下工作。我应该怎么办？

希望这是有道理的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:30:02.163

定义一个名为 null 的静态成员。

```
class Camera {
  static Vector Null;
}

Vector Null(0,0,0); 
```

然后在需要比较时使用它。

```
if(my_vector == Camera::Null){
} 
```

如果发现这始终是最惯用的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T00:47:58.223

您可以为 Vector 定义一个默认构造函数，并为 Vector 提供知道它为空的能力。如果空 Vector 的条件从包含三个零变为另一个数字或完全不同的东西，那么您可以修改 empty() 函数来处理这些条件，而无需修改 Camera。

```
Camera::Camera(Vector Pos, Vector LookAt, Vector UpDir)
{
  if(LookAt.empty()) 
  { 
    //do something; 
  }
}

Camera Cam(Vector(3,3,3), Vector(), Vector()); 
```

Camera 的静态成员初始化为三个零的一个问题是它会引入其他类的依赖项，这些类也需要检查 Vector 是否为 NULL。他们需要包含 Camera 头文件才能访问声明。对我来说，它使 Vector 依赖于 Camera 来定义 NULL 标准，而不是我认为可能难以维护的其他方式。

在阅读了 Michael Feathers 在有效地使用遗留代码中的依赖破坏技术之后，我受到启发来写这篇文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T00:58:38.160

如果您的`Vector`对象可能具有无效状态，则可以使用以下方法：

```
class Vector
{
public:
   int x, y, z;
   bool valid;

   Vector() : x(0), y(0), z(0), valid(false) {}
   Vector(int x, int y, int z) : x(x), y(y), z(z), valid(true) {}
}; 
```

然后你的`Camera`课：

```
class Camera
{
public:
    Camera(const Vector &pos, const Vector &lookAt, const Vector &upDir)
    {
        if (!lookAt.valid) {...}
    }
}; 
```

用法：

```
Camera c(Vector(1,2,3), Vector(), Vector()); 
```

您可以为默认值定义一个静态实例：

```
class Vector
{
public:
    static Vector INVALID;
private: Vector(); // make invalid constructor private
};

Vector Vector::IVALID; 
```

用法：

```
Camera c(Vector(123), Vector::INVALID, Vector(12,4,5)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:33:30.413

如果可能，将您的界面更改为矢量指针。

```
Camera::Camera(Vector *Pos, Vector *LookAt, Vector *UpDir)
{
} 
```

并用你的向量地址调用它；

```
Camera Cam(&v1, &v2, NULL); 
```

# objective-c - 在字符串中查找子字符串的更简单方法（Obj C）

> ID：16123155
> 
> 赞同：0
> 
> 时间：2013-04-20T17:26:16.307
> 
> 标签：objective-c, string, substring

我只是想知道是否有一种更简单的方法可以在 Objective C 中的字符串中查找子字符串。

我的字符串是这样的问题：（我知道很乱......）

```
filename.cpp - line: 1 "comment 1"\nfilename.cpp - line: 1 "comment 2"\nfilename.cpp - line: 1 "comment 3"\n 
```

所以我想要做的是将引号之间的所有位提取到一个数组中。我一直在搞乱**componentsSeparatedByString**方法，试图操纵字符串足以让我留下“评论”，但这似乎是一种非常混乱的方式。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:52:05.503

也许我不完全理解您的问题，但是：
如果要解析的字符串始终以不包含的内容开头，即如果要提取的第一个子字符串不在字符串的开头，则可以使用

```
NSMutableArray *components = [NSMutableArray arrayWithArray: [yourString componentsSeparatedByString:@"\""]];
for (int i=0; i<components.count; i++) {
   [components removeObjectAtIndex:i];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:08:54.277

您可以使用 NSScanner 扫描`\"`并存储数组中的所有其他子字符串

```
NSString *string = @"filename.cpp - line: 1 \"comment 1\"\nfilename.cpp - line: 1 \"comment 2\"\nfilename.cpp - line: 1 \"comment 3\"\n";
NSScanner *scanner = [NSScanner scannerWithString:string];
NSMutableArray *array = [NSMutableArray array];

while (YES) {
    NSString *s;
    [scanner scanUpToString:@"\"" intoString:NULL];
    [scanner setScanLocation:[scanner scanLocation]+1];
    [scanner scanUpToString:@"\"" intoString:&s];
    if(s)
        [array addObject:s];
    if(![scanner isAtEnd])
        [scanner setScanLocation:[scanner scanLocation]+1];
    else break;
} 
```

结果：

```
array = (
    comment 1,
    comment 2,
    comment 3
) 
```

# oauth-2.0 - OAuth 2 Provider：客户端弹出窗口

> ID：16123157
> 
> 赞同：2
> 
> 时间：2013-04-20T17:26:20.190
> 
> 标签：oauth-2.0, window.open

我很好奇 OAuth 2 提供商（即 Facebook 和 Google）如何在弹出窗口中实现客户端流程。客户端应用程序如何从弹出窗口接收访问令牌？`window.open`我的印象是，除非它具有相同的来源（在这些 OAuth 登录的情况下并非如此），否则无法与另一个窗口（通过创建）进行通信。

谢谢！

# android - Android 开发 - 从 youtube 应用程序中隐藏相关视频

> ID：16123161
> 
> 赞同：3
> 
> 时间：2013-04-20T17:26:55.077
> 
> 标签：android, android-intent, youtube

我得到以下代码来从 Youtube App 打开一个频道：

```
 intent =new Intent(Intent.ACTION_VIEW);
        intent.setPackage("com.google.android.youtube");
        intent.setData(Uri.parse("http://www.youtube.com/user/User_Name"));
        startActivity(intent); 
```

并且工作正常，但是当我看到视频时，我想隐藏“相关视频”部分，可以吗？

我认为，您可以使用：

```
 intent.putExtra("query", "Android"); 
```

要打开搜索，也许有类似的东西：

```
 intent.putExtra("related_videos", "False"); 
```

有可能还是我正在尝试一些不可能的事情？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:35:02.163

不，你不能那样做。您只能指定 youtube 应用应播放的视频。如果您不想显示任何其他视频，您可以使用[Youtube API](https://developers.google.com/youtube/android/player/)并将视频本地嵌入到您的应用中。

# c# - SQL 查询和 OFType

> ID：16123165
> 
> 赞同：0
> 
> 时间：2013-04-20T17:26:59.433
> 
> 标签：c#, linq, entity-framework, entity-framework-6

我确实升级到了 EF 6，但我不知道如何迁移这种情况，如何使用`SQLQuery`和`OFType`？

```
//work - return more than 3000 registers
var a = db.AccountBase.OfType<Payable>()

//doesn't work - return 0 register
var a  = db.AccountBase.SqlQuery(Utils.Query(param, "AccountBase")).OfType<Payable>()
//not compile - ok
var a  = db.AccountBase.OfType<Payable>().SqlQuery(Utils.Query(param, "AccountBase")) 
```

# matlab - 查找矩阵中每一行的出现次数

> ID：16123176
> 
> 赞同：0
> 
> 时间：2013-04-20T17:27:44.227
> 
> 标签：matlab, vectorization

我有一个根据行排序的矩阵。例如，矩阵可能如下

```
M=[
0   3
1   1
1   2
1   2
1   2
1   2
1   3
1   3
2   0
2   2
2   2
2   3
3   2
3   3
3   3
]; 
```

我想在上面的矩阵中找到每个重复行的计数

```
[0  3] count is 1
[1  1] count is 1
[1  2] count is 4
[1  3] count is 2
[2  0] count is 1
[2  2] count is 2
[2  3] count is 1
[3  2] count is 1
[3  3] count is 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:42:07.930

一种解决方案是检索`unique()`出现的行，然后累积其索引：

```
[unM, ~, subs] = unique(M,'rows');
[unM accumarray(subs,1)]
ans =
     0     3     1
     1     1     1
     1     2     4
     1     3     2
     2     0     1
     2     2     2
     2     3     1
     3     2     1
     3     3     2 
```

# xml - xml 按节点名分组元素，节点名按后缀更改

> ID：16123177
> 
> 赞同：1
> 
> 时间：2013-04-20T17:27:45.250
> 
> 标签：xml, transform, nodes

我正在尝试将 XML 转换为特定的输出 XML。但是我无法按 N 更改一组字段的位置进行分组。

```
 <Balances>
        <Balances_Line_Item0>
          <Page>
            <Field>EmpID</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item0>
        <Balances_Line_Item0>
          <Page>
            <Field>Name</Field>
            <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
             <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
         </Page>
        </Balances_Line_Item0>
        <Balances_Line_Item0>
          <Page>
            <Field>Department</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item0>
        <Balances_Line_Item1>
          <Page>
            <Field>EmpID</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item1>
        <Balances_Line_Item1>
          <Page>
            <Field>Name</Field>
            <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
             <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
         </Page>
        </Balances_Line_Item1>
        <Balances_Line_Item1>
          <Page>
            <Field>Department</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item1>
        <Balances_Line_Item2>
          <Page>
            <Field>EmpID</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item2>
        <Balances_Line_Item2>
          <Page>
            <Field>Name</Field>
            <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
             <Letter>53</Letter>
            <Letter>56</Letter>
            <Letter>76</Letter>
         </Page>
        </Balances_Line_Item2>
        <Balances_Line_Item2>
          <Page>
            <Field>Department</Field>
            <Letter>45</Letter>
            <Letter>45</Letter>
            <Letter>45</Letter>
          </Page>
        </Balances_Line_Item2>
    </Balances> 
```

我转换后的 XML 应该是：

```
<Balances>
<Balances_Line_Item0>
<EmpID>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</EmpID>
<Name>
        <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
         <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
</Name>
<Dept>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</Dept>
</Balances_Line_Item0>
<Balances_Line_Item1>
<EmpID>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</EmpID>
<Name>
        <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
         <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
</Name>
<Dept>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</Dept>
</Balances_Line_Item1>
<Balances_Line_Item2>
<EmpID>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</EmpID>
<Name>
        <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
         <Letter>53</Letter>
        <Letter>56</Letter>
        <Letter>76</Letter>
</Name>
<Dept>
        <Letter>45</Letter>
        <Letter>45</Letter>
        <Letter>45</Letter>
</Dept>
</Balances_Line_Item2>
</Balances> 
```

输入的xml如何转换成上面的xml？请建议。

* * *

我对生成的 xml 应用了另一种转换：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="/">
    <xsl:copy>
      <xsl:element name="Balances">
        <xsl:for-each select="Balances/node()[position() mod 5 = 1]">
          <xsl:element name="LineItem">
            <xsl:for-each select=". | following-sibling::node()[not(position() > 4)]">
              <xsl:copy-of select="."/>
            </xsl:for-each>
          </xsl:element>
        </xsl:for-each>
      </xsl:element>
          </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

但是我的 xslt 非常基础，我不能继续使用这样的 XSL 进行更复杂的转换。有人可以建议调整和更好的 xslt，可能是一个 XSLT，而不是 2 个。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T21:14:03.340

以下 XSLT 2.0 样式表完成了这项工作：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="2.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="*">
    <xsl:copy><xsl:apply-templates/></xsl:copy>
  </xsl:template>

  <xsl:template match="Balances">
    <xsl:copy>
      <xsl:for-each-group select="*" group-adjacent="name()">
        <xsl:copy>
          <xsl:apply-templates select="current-group()/*"/>
        </xsl:copy>
      </xsl:for-each-group>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Page">
    <xsl:apply-templates select="Field"/>
  </xsl:template>

  <xsl:template match="Field">
    <xsl:element name="{.}">
      <xsl:apply-templates select="following-sibling::*"/>
    </xsl:element>
  </xsl:template>

</xsl:stylesheet> 
```

# php - 如何使用 JSON 将数组从 PHP 传递到 javascript 以制作 Google Chart？

> ID：16123178
> 
> 赞同：2
> 
> 时间：2013-04-20T17:27:56.753
> 
> 标签：php, json

我想制作一个谷歌图表，我试图将一个 JSON 编码的数组从 PHP 脚本发送到 JavaScript。这两个文件如下：

```
<html>

<head><title>

</title></head>

<body>
<?php
$data[0]=array('State','Values');
$data[1]=array('Correct',6);
$data[2]=array('Incorrect',3);

echo json_encode($data);
?>
</body>
</html> 
```

这被保存为 test.php

javascript文件是：

```
 <html>
   <head>
     <script type="text/javascript" src="jquery-1.9.1.min.js"></script>
     <script type="text/javascript" src="https://www.google.com/jsapi"></script>
     <script type="text/javascript">
       google.load("visualization", "1", {packages:["corechart"]});
       google.setOnLoadCallback(drawChart);

       function drawChart() {

    var jsonData = $.ajax({
            url: "test.php",
            dataType: "json",
            async: false
        }).responseText;

    var data=google.visualization.arrayToDataTable(jsonData);

    var options = {
      title: 'My Chart'
    };

    var chart = new oogle.visualization.PieChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
     </script>
   </head>

   <body>
     <div id="chart_div" style="width: 900px; height: 500px;"></div>
   </body>

 </html> 
```

这被保存为 test2.php。

当我运行 test2.php 时，什么也没有发生，浏览器显示一个空白屏幕。我在哪里错了？请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:31:55.610

您的`test.php`. 相反，只需使用：

```
<?php
$data[0]=array('State','Values');
$data[1]=array('Correct',6);
$data[2]=array('Incorrect',3);

header("Content-Type: application/json");
echo json_encode($data);
?> 
```

HTML 不是 JSON 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:32:36.197

test.php 不需要所有这些 html 标签，只需返回 json。在混合 js 和 PHP 时，有时最好先使用硬编码值，然后在确定 js 已连接并正常工作时让 PHP 创建这些硬编码值。

# twitter - 你可以使用 SuperTweet 阅读和搜索 Twitter API 1.1 吗？

> ID：16123184
> 
> 赞同：0
> 
> 时间：2013-04-20T17:28:41.400
> 
> 标签：twitter, arduino, twitter-search

我正在使用 Arduino 访问 Twitter Search API 1.1。但是，我发现执行新的[OAuth](http://en.wikipedia.org/wiki/OAuth)流程非常困难。此外，在 Arduino 上执行新的 OAuth 过程在内存方面非常昂贵。

在寻找替代选择时，我偶然发现了[SuperTweet](http://www.supertweet.net/)。然而，该网站仅讨论发布推文作为使用其服务的主要示例。是否可以使用他们的服务访问 Twitter 的新搜索 API 和 API 1.1 的其他部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-11T03:39:47.617

您无法搜索，但您可以获取您的家庭时间线并自行搜索。

# ios - -[__NSArrayM text]：无故调用

> ID：16123186
> 
> 赞同：0
> 
> 时间：2013-04-20T17:28:51.537
> 
> 标签：ios, objective-c, nsarray, unrecognized-selector

我有一个里面有事件的日历，我希望用户能够为每个事件添加注释。我通过 UITextView 执行此操作，但在写下第一封信后应用程序崩溃了一段时间

> -[__NSArrayM text]：发送到实例的无法识别的选择器

奇怪的是，我不使用任何代码来跟踪输入，直到用户点击“完成”按钮。我在使用 UITextField 时也遇到了同样的错误，我不知道为什么有时会发生错误，有时它工作得很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:36:34.367

你有一个悬空的参考。您有一个响应`text`消息的对象。你释放了它，但你仍然在某处引用它。您重用了该释放对象的内存来创建一个`NSMutableArray`，然后`text`通过悬空引用发送消息。

在 Zombies 工具下运行您的应用程序以帮助追踪错误。

# excel - Excel VBA - 从网站获取数据

> ID：16123189
> 
> 赞同：3
> 
> 时间：2013-04-20T17:29:06.383
> 
> 标签：excel, vba

我正在使用以下方法**从站点下载表格数据**。但是每次循环迭代大约需要 1.5 秒。我需要加快速度。请问有什么建议吗？

```
Sub GetData_Sai()
    Dim htm As Object
    Dim x As Long, y As Long

    Set htm = CreateObject("htmlFile")
    Application.ScreenUpdating = False

    Row = Sheet2.Cells(Rows.Count, "A").End(xlUp).Row + 1
    For p = Range("F1") To Range("F1") + 200
        Debug.Print p
        Set htm = CreateObject("htmlFile")
        With CreateObject("msxml2.xmlhttp")
            .Open "GET", <site_url_goes_here>, False
            .send
            htm.body.innerhtml = .responsetext
        End With

        With htm.getelementbyid("item")
            Sheet2.Cells(Row, 4).Value = p
            For x = 1 To .Rows.Length - 1
                For y = 0 To .Rows(x).Cells.Length - 1
                    Sheet2.Cells(Row, y + 1).Value = .Rows(x).Cells(y).innertext
                Next y
                Row = Row + 1
            Next x
        End With
        Set htm = Nothing

        If p Mod 10 = 0 Then ThisWorkbook.Save
    Next

    Range("F1") = p

    Application.ScreenUpdating = True
    MsgBox "Done", vbInformation
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T22:56:27.853

您应该考虑只打开一次 MSXML2.XMLHTTP 对象，然后在每次循环迭代中调用`Open`and 。`Send`您可以在开始循环之前将其存储在变量中。我确信大部分时间都花在创建对象而不是实际`Open`调用中。根据您在上面的代码中调用它的方式，您在每次循环迭代中创建一个新对象。

# java - 比较数组中的元素

> ID：16123191
> 
> 赞同：0
> 
> 时间：2013-04-20T17:29:15.630
> 
> 标签：java, arrays

我在比较数组中的元素时遇到了一些问题。我正在创建一个扑克问题，似乎无法编写代码来判断两个元素是否相同。这是我比较元素中的内容的代码

```
public static boolean pairs() {
    for (int i = currentCard; i < deck.length; i++) {
        for (int j = currentCard ; j < deck.length; j++) {
            if (deck[i] == deck[j])
                return pairs == true;
        }
    }
    return pairs;
} 
```

这是构建数组的代码：

```
public CreateDeck() {
    String[] faces = { "Ace", "Deuce", "Three", "Four", "Five", "Six",
        "Seven", "Eight", "Nine", "Ten", "Jack", "Queen", "King" };
    String[] suits = { "Hearts", "Diamonds", "Spades", "Clubs" };

    deck = new Card[NUMBER_OF_CARDS];
    currentCard = 0;

    for (int count = 0; count < deck.length; count++)
        deck[count] = new Card(faces[count % 13], suits[count / 13]);
} 
```

任何帮助将不胜感激，我尝试了很多事情，现在只是随机尝试。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T17:32:19.177

您需要使用和实现 Card.equals(Card) 而不是 ==。（因此还有 hashCode()，这里有很多问题可以回答为什么）。

这将使您的 pairs() 变成这样：

```
public static boolean pairs() {
    {
        for (int i = currentCard; i < deck.length; i++) {
            for (int j = currentCard ; j < deck.length; j++) {
                if (i!=j && deck[i].equals(deck[j]))
                    return true;
            }

        }
    }
    return false;
} 
```

当且仅当一个牌组[i] 等于另一个牌组[j] 时，它才返回真。否则为假。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:36:51.567

对，所以你的牌组数组中的项目是不同的 Card 对象。== 运算符比较*指针*，因此它们对于不同的对象是不同的。如果您尝试比较 Card 对象的*值*，则需要实现一个 equals 方法（覆盖从 Object 继承的方法）和调用 deck[i].equals(deck[j])。

# awk - 用 0 填充文本文件中的空列

> ID：16123193
> 
> 赞同：1
> 
> 时间：2013-04-20T17:29:25.600
> 
> 标签：awk, text-files, post-processing

我有一个数据集，我从 Google 电子表格中剪切并粘贴到我的文本编辑器（Sublime Text 2）中，并且该数据集与我的处理需求不太匹配。

在它来自电子表格的形式中，数据以一行字符串开始，每列一个字符串，然后是多行数据；在数据行中，每一列都有值`1`或为空白。我不知道数据来自电子表格时是否是制表符分隔的，但是在将其粘贴到文本文件中之后却不是。如果`1`一行中的最后一个不在最后一列中，则该行用空格填充，直到*但不包括*最后一列。

我尝试用 做一些事情`awk`，但我不知道如何解决空格既是分隔符又是列值的事实。接下来，我尝试了一些带有 的命令`sed`，包括用零替换重复的空格，并用管道连接到另一个`sed`替换`10`为 的命令`1 0`，但后来我有时会插入额外的零，我不知道在相应的行中发生了什么。

这是一些示例数据（真实文件中有 13 列）。我`$`在最后一个字符之后添加了字符，所以你可以看到这些行被填充了多远。

```
"1" "2" "3" "4"                           "1" "2" "3" "4"
  1 1 $                                   0 1 1 0
1     1 $                                 1 0 0 1
  1   $                                   0 1 0 0
1 1   1 $                                 1 1 0 1 
```

我想得到类似 right 的东西（然后我不关心行结束的地方），所以我可以用`awk`.

顺便说一句，我*已经*看到[了这个问题](https://stackoverflow.com/questions/4656474/filling-space-tab-separated-empty-columns-with-0)，它并没有解决我的问题，因为那里的解决方案基于文件是制表符分隔的事实，在“空”单元格中根本没有任何价值。重申一下，我的文件是用空格分隔的，空单元格中有空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:16:26.973

我的第一次尝试并不好。所以我的~~第二次~~ ~~第三~~次第四次尝试根据修改后的输入自动确定列数：

```
awk 'NR==1{for(;N<NF;++N)sp=" 0"sp}NR>1{$0=" "$0;sub(" +$","");gsub("  "," 0");$0=substr($0sp,2,2*N-1)}1'<<EOT
"1" "2" "3" "4"
  1 1 
1     1 
  1   
1 1   1 
EOT 
```

第一个空格是偶数，中间是奇数，所以我在开头添加了一个空格，以便在两种情况下使用相同的 gsub。目前尚不清楚存在多少尾随空格，因此脚本只是将它们切碎。它包含`0`字段次数的数量。`Substr`从 2 开始剪切添加的前导空格，并持续到`(number of fields)*2-1`字符以剪切尾随空格。

输出：

```
"1" "2" "3" "4"
0 1 1 0
1 0 0 1
0 1 0 0
1 1 0 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:41:26.540

试图解释为什么一个问题很难，这对你解决它的机会是有好处的。正因为想到这里的解释，我也想出了一个解决办法=)

该解决方案`sed`主要分为三个步骤：

1.  用 0替换所有空的*第一*列：

    ```
    cat datafile.txt | sed 's/^ /0 /g' 
    ```

2.  用 0替换所有空的*最后一*列：

    ```
    cat datafile.txt | sed 's/^ /0 /g' | sed 's/  $/  0/g' 
    ```

    在这里，我不得不对正则表达式中的空格数量进行一些试验，以将所有新零对齐。

3.  用 0替换所有空的*内*列：

    ```
    cat datafile.txt | sed 's/^ /0 /g' | sed 's/  $/  0/g' | sed 's/  / 0/g' 
    ```

    在这里，我还尝试将 0 放在替换正则表达式中的第一个或最后一个以使其正确。

当然，完成此操作后，我通过`> datafile-clean.txt`在末尾标记 on 将输出重定向到文件。

可能有一种更优雅的方法可以做到这一点，所以如果你有一个，请发布它，即使我个人不再需要该解决方案。

**更新：**如评论中所示，此解决方案可以改进很多。我将把原始解决方案留在这里，因为我认为它的作用和顺序更清楚，但可能应该使用它。

首先，我们不需要那么多管道；相反，我们在`-e`上使用标志`sed`：

```
sed -e 's/^  /0 /' -e 's/  $/ 0/' -e 's/  / 0/g' datafile.txt 
```

鉴于具有列标题的第一行没有任何双空格，这可以按原样工作。如果是这样，则可以只使用`tail -n +2 datafile`上述`sed`命令读取文件并通过管道传输。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T14:32:54.520

```
sed 's/ /0/g;s/10/1 /g;s/00/0 /g;s/$/0 /' datafile.txt | cut -c 1-7 
```

# javascript - 使用 Jasmine 有效地模拟全局属性

> ID：16123194
> 
> 赞同：2
> 
> 时间：2013-04-20T17:29:28.900
> 
> 标签：javascript, angularjs, google-api, jasmine, google-api-js-client

我的应用程序依赖于 gapi javascript 客户端 ( [https://apis.google.com/js/api.js](https://apis.google.com/js/api.js) ) 和 jsapi ( [https://www.google.com/jsapi](https://www.google.com/jsapi) )。

我使用 AngularJS 构建我的应用程序并使用 Karma（以前称为 Testacular）作为测试运行器。

我设法通过在 Karma 中加载它们并接下来监视一些方法来有效地模拟它们：

```
it('should call gapi on share', inject(function (config, doc) {
        config.appId = 'testAppId';

        var shareClientMock = {
            setItemIds: jasmine.createSpy('setItemIds'),
            showSettingsDialog: jasmine.createSpy('showSettingsDialog')
        };
        spyOn(gapi.drive.share, 'ShareClient').andReturn(shareClientMock);

        scope.share();

        expect(gapi.drive.share.ShareClient).toHaveBeenCalledWith(config.appId);
        expect(shareClientMock.setItemIds).toHaveBeenCalledWith([doc.info.id]);
        expect(shareClientMock.showSettingsDialog).toHaveBeenCalled();
    })); 
```

我想用 Jasmine 模拟它们，但实际上不包括它，但我可以弄清楚如何。我尝试在 beforeEach 中创建一个存根：

```
beforeEach(function () { window.gapi = {...} }); 
```

但它仍然是未定义的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-08T07:59:21.910

Placing @SpoBo's comment as an answer, as it fixed my problem:

```
beforeEach(() => {
  angular.mock.module('moduleName', $provide => {
    $provide.decorator('$window', $delegate => {
      $delegate.gapi = {
        auth2: {
          getAuthInstance: null,
        },
        // ... or whatever else you need to mock
      };
      return $delegate;
    });
  });
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-30T19:03:09.273

我认为您想使用注入器来获取 $window 提供程序，然后您可以将模拟添加到该对象。

```
beforeEach(inject(function($injector){
   window = $injector.get('$window');
   window.gapi = {...};
}); 
```

# opengl - 画一堆FBO好像很慢

> ID：16123195
> 
> 赞同：0
> 
> 时间：2013-04-20T17:29:43.257
> 
> 标签：opengl

我在不同的 FBO 上渲染大约 2000 个对象（每个对象一个 fbo）。

在每一帧，我只是将每个 FBO 的纹理四边形绘制到“最终”帧缓冲区（窗口）中。例如：

```
glBindFramebuffer(0);
loop_over_fbos {
    glBindTexture(fbo_texture);
    glBegin(GL_QUADS);
     glVertex3f(...);
     ...
    glEnd();
} 
```

在普通台式计算机上，这似乎很慢（2000 个对象为 20 fps）。我应该从直接模式切换到 VBO 吗？有这么多 FBO 很常见吗？我可以通过很多 FBO（例如 100k FBO）获得出色的表现吗？

# java - XmlRpcException：无法读取服务器的响应：连接被拒绝：连接

> ID：16123201
> 
> 赞同：2
> 
> 时间：2013-04-20T17:30:36.967
> 
> 标签：java, xml-rpc, rpc

我有 XML-RPC 服务器，我相信它工作正常。我可以使用 telnet 连接到服务器，也可以使用 Web 浏览器，地址是 (dracek:8080) dracek=计算机名称。当我尝试使用我的客户端连接时，我收到此错误：

org.apache.xmlrpc.XmlRpcException：无法读取服务器的响应：连接被拒绝：连接

服务器应该记录“客户端已连接。”，但没有任何反应。

服务器代码：

公共类主要{

```
private static int port = 8080;
private static InetAddress ipAddress = null;

public static void main(String[] args) {

    try
    {
        ipAddress = InetAddress.getLocalHost(); 
    }
    catch (UnknownHostException e)
    {
        System.out.println("UnknownHostException");
        System.exit(0);
    }      

    System.out.println("Starting server.");

    try {        

        WebServer webServer = new WebServer(port, ipAddress); 

        // get XML-RPC Server
        XmlRpcServer xmlRpcServer = webServer.getXmlRpcServer();
        PropertyHandlerMapping phm = new PropertyHandlerMapping();
        phm.addHandler("DBClass", DBClass.class);

        // mapping
        xmlRpcServer.setHandlerMapping(phm);

        // configuration
        XmlRpcServerConfigImpl serverConfig = (XmlRpcServerConfigImpl) xmlRpcServer
                .getConfig();
        serverConfig.setEnabledForExceptions(true); 
        serverConfig.setEnabledForExtensions(true);
        serverConfig.setContentLengthOptional(false); 

        // start server
        webServer.start();            

    }
    catch (Exception e)
    {
        System.out.println(e.getMessage());
    }
    System.out.println("Server succesfully started. IP:" + ipAddress + " Port:" + port + ".");

} 
```

数据库类：

```
 public void testConnection(){
    System.out.println("Client connected.");
} 
```

客户端代码：

```
private static InetAddress ipAddress = null;
private static int port = 8080;
private static String confFile = "";
private static XmlRpcClientConfigImpl config;

public static void main(String[] args) {
    System.out.println("Starting client.");

    if (args.length == 3) {
        try {
            ipAddress = InetAddress.getByName(args[0]);
            port = Integer.parseInt(args[1]);
            confFile = args[2];
        }
        catch (NumberFormatException e) {
    System.out.println("Port number is not valid!");
    System.exit(0);
        }
        catch (UnknownHostException e)
        {
            System.out.println("UnknownHostException");
            System.exit(0);
        }             
}
    else
    {
        System.out.println("Some parameter is missing!");
        System.out.println("Valid parameters are: IP(0) Port(1) Config_file_name(2).");
    }

Client.config = new XmlRpcClientConfigImpl();
try
    {
        Client.config.setServerURL(new URL("http://" + ipAddress + ":" + port)); // nastaveni   
    }
    catch(MalformedURLException me)
    {
        System.out.println("Server URL is not valid!");
        System.exit(0);        
    }

Client.config.setEnabledForExtensions(true);
Client.config.setEnabledForExceptions(true);

Client.config.setConnectionTimeout(60 * 1000); 
Client.config.setReplyTimeout(60 * 1000); 

XmlRpcClient client = new XmlRpcClient();

client.setTransportFactory(new XmlRpcSunHttpTransportFactory(client));

client.setConfig(Client.config);

System.out.println("Connnected to " + ipAddress + " : " + port + ".");

    Tools tools = new Tools(client);

    tools.testConnection();
    } 
```

工具类：

```
public class Tools {

private XmlRpcClient client;

public Tools(XmlRpcClient client)
{
    this.client = client;
}
public void testConnection() {

Object[] params = new Object[] {};

    try
    {   
        this.client.execute("DBClass.testConnection", params);
    }
    catch (XmlRpcException e)
    {
        System.out.println("Error occured when testing connection!"); 
        System.out.println(e.toString());
    }            
} 
```

我使用命令运行客户端：

java -Djava.security.policy=..\Client\src\client\Client.policy -jar ..\Client\dist\Client.jar dracek 8080 ..\data\commands.txt

致以最诚挚的谢意

# c++ - 如何为 bitset、make_bitset 编写类似 make_pair 的函数？

> ID：16123205
> 
> 赞同：0
> 
> 时间：2013-04-20T17:30:49.780
> 
> 标签：c++, templates

因为 c++ 不能从构造函数推导出类模板参数，作为一种解决方法，我们编写了一个像 std::make_pair 这样的 make 函数。

我的问题是：这项工作适用于 std::bitset 吗？换句话说，我可以编写一个返回 bitset<7> 的函数 make_bitset(7) 吗？

我的尝试是：

```
template<size_t N>
bitset<N> make_bitset(size_t N){
    return bitset<N>();
} 
```

好像不行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:42:24.903

正如@mfontanini 所说，“你不会变短`bitset<N>()`”。但是，您可以使用`char const[]`.

```
template<size_t N>
std::bitset<N-1> make_bitset(char const (&in_string)[N])
{
    return std::bitset<N-1>(in_string);
} 
```

因此，`bitset<3> my_bitset("100");`您可以写而不是写`auto my_bitset = make_bitset("100");`。

请注意传入的类型是如何`N`暗示的，而不是实际传入的。

# python - 检查一个值是否已经在列表中

> ID：16123211
> 
> 赞同：0
> 
> 时间：2013-04-20T17:31:41.333
> 
> 标签：python

我正在从 3 个值的差异中产生一个平均值，并希望将它放在一个列表中

我想要平均的列表示例如下所示：

```
...
[6.0, 270.0, -55.845848680633168],
[6.0, 315.0, -47.572000492889323],
[6.5, 0.0, -47.806802767243724],
[6.5, 45.0, -48.511643275159528],
[6.5, 90.0, -45.002053150122123],
[6.5, 135.0, -51.034656702050455],
[6.5, 180.0, -53.266356523649002],
[6.5, 225.0, -47.872632929518339],
[6.5, 270.0, -52.09662072002746],
[6.5, 315.0, -48.563996448937075]] 
```

前 2 列匹配最多有 3 行（这 2 列是极坐标），在这种情况下，我想取第 3 个元素之间的差异，将其平均并附加点的极坐标和平均结果到一个新列表中

```
for a in avg_data:
    comparison = []
    for b in avg_data:
        if a[0] == b[0] and a[1] == b[1]:
            comparison.append(b[2])

    print comparison    
    z = 0   # reset z to 0, z does not need set now in if len(comp) == 1

    if len(comparison) == 2: # if there are only 2 elements, compare them
        z += -(comparison[0]) + comparison[1]
    if len(comparison) == 3: # if all 3 elements are there, compare all 3
        z += -(comparison[0]) + comparison[1]
        z += -(comparison[0]) + comparison[2]
        z += -(comparison[1]) + comparison[2]
        z = z/3 #average the variation

    avg_variation.append([a[0], a[1], z]) #append the polar coordinates and the averaged variation to a list 
```

此代码将正确的数据输出到列表中，但每次遇到匹配的极坐标时都会输出它，所以我最终会得到重复的行。

为了阻止这种情况，我尝试实现一个 if 语句以在 avg_variation 列表中查找匹配的极坐标，然后再次执行平均

```
if a[0] not in avg_variation and a[1] not in avg_variation: 
```

这不起作用，我收到错误

```
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

我不认为任何或全部是我正在寻找的，因为我只想检查前两列而不是第三列与已经附加的值。有人知道如何使我的 if 语句更好吗？

为了更清楚我的实际问题是什么：

我的代码在嵌套列表中搜索第一个 2 个元素匹配的列表，对第三个元素执行计算，然后将它们附加到一个新列表中。我的问题是，如果有 2 或 3 行第一个 2 元素匹配它会将结果附加到新列表 2 或 3 次，我希望它只执行一次

编辑：对不起，我最初的问题是误导我的代码的目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:46:25.020

IIUC，我认为更简单的方法是

```
import numpy as np
from itertools import combinations
from collections import defaultdict

def average_difference(seq):
    return np.mean([j-i for i,j in combinations(seq, 2)]) if len(seq) > 1 else 0

def average_over_xy(seq, fn_to_apply):
    d = defaultdict(list)
    for x,y,z in seq:
        d[x,y].append(z)

    outlist = [[x,y,fn_to_apply(z)] for (x,y),z in sorted(d.items())]
    return outlist 
```

它遍历所有行，创建一个字典，其中 x,y 坐标是元素的键和值列表，然后将该字典转换为列表的排序列表，在`z`. 例如，我们可以使用平均有符号和有序差异，就像在您的代码中一样：

产生

```
>>> seq = [[1, 2, 30], [1, 2, 40], [1, 2, 50], [1, 3, 4], [1, 3, 6], [2, 10, 5]] 
>>> average_over_xy(seq, average_difference)
[[1, 2, 13.333333333333334], [1, 3, 2.0], [2, 10, 0]] 
```

请注意，您定义它的方式（我在上面已经匹配），答案取决于给出元素的顺序，即

```
>>> average_over_xy([[1,2,3],[1,2,4]], average_difference)
[[1, 2, 1.0]]
>>> average_over_xy([[1,2,4],[1,2,3]], average_difference)
[[1, 2, -1.0]] 
```

如果你愿意，你可以使用

```
def average_difference_sorted(seq):
    return average_difference(sorted(seq)) 
```

相反，或者使用标准偏差或任何你喜欢的。（你没有提到你的用例，所以我假设你已经按照你想要的顺序得到了列表，你知道陷阱，你真的需要`average_difference`）。

我们可以做一些`numpy`基于更快的技巧，以及推广它的方法，但是使用 a`defaultdict`来累积值是一种方便的模式，而且它通常足够快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:25:15.420

这是一个可能的解决方案：

```
l=[[6.0, 270.0, -55.845848680633168],
[6.0, 315.0, -47.572000492889323],
[6.5, 0.0, -47.806802767243724],
[6.0, 180.0, -53.266356523649002],
[6.0, 225.0, -47.872632929518339],
[6.0, 270.0, -52.09662072002746],
[6.0, 315.0, -48.563996448937075]]

# First, we change the structure so that the pair of coordinates
# becomes a tuple which can be used as dictionary key
l=[[(c1, c2), val] for c1, c2, val in l]

# We build a dictionary coord:[...list of values...]
d={}
for coord, val in l:
    d.setdefault(coord,[]).append(val)

# Here, I compute the mean of each list of values.
# Apply your own function !

means = [[coord[0], coord[1], sum(vals)/len(vals)] for coord, vals in d.items()]

print means 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:39:57.400

您没有提供所有必要的信息来确保这一点，但我相信您的错误是由对 numpy 数组执行逻辑操作引起的。请参阅[此](https://stackoverflow.com/a/10063039/121495)对具有类似错误的问题的答案。

如果没有更多信息，很难复制您的问题的上下文来尝试它，但也许在`if`语句中更具体的布尔运算会有所帮助。

# c# - 将所有消息发送到一个日志文件，并将 RavenDB 日志发送到另一个日志文件

> ID：16123212
> 
> 赞同：0
> 
> 时间：2013-04-20T17:31:47.733
> 
> 标签：c#, logging, nlog

这听起来微不足道，但我不知何故无法做到。我有以下`NLog.config`

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" autoReload="true" throwExceptions="true">
    <variable name="logDirectory" value="${basedir}/App_Data/logs"/>
    <targets>
        <target name="file" xsi:type="AsyncWrapper">
            <target xsi:type="File" name="f1" fileName="${logDirectory}\log1.txt" layout="${longdate} ${callsite} ${level} ${message} (File 1)"/>
        </target>

        <target xsi:type="File" name="fileGeneral" fileName="${logDirectory}\log_${shortdate}.txt" >
            <layout xsi:type="Log4JXmlEventLayout"/>
        </target>
        <target xsi:type="File" name="fileRaven" fileName="${logDirectory}\raven_${shortdate}.txt" >
            <layout xsi:type="Log4JXmlEventLayout"/>
        </target>

    </targets>
    <rules>
        <logger name="Raven.*" minlevel="Trace" writeTo="fileRaven"></logger>
        <logger name="*" minlevel="Trace" writeTo="fileGeneral"></logger>

    </rules>
</nlog> 
```

这最终将 Raven + ALL 日志记录到“log_[date].txt”，而 RavenDB 的另一个副本记录在“raven_[date].txt”。这应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T00:14:27.427

```
<logger name="Raven.*" minlevel="Trace" writeTo="fileRaven" final="true"></logger> 
```

Where`final="true"`意味着不再`Raven.*`执行规则将按照您的要求执行（如果我理解正确的话）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-21T11:17:03.977

不幸的是，这是不可能的。

原因是记录器是从上到下评估的，将使用第一个匹配的，并且不会评估下面的。

在您的情况下，这意味着在记录与 Raven 相关的任何内容时，将使用第一个记录器并停止流。

# android - Android：每次从头开始打开 PDF 文件

> ID：16123214
> 
> 赞同：0
> 
> 时间：2013-04-20T17:31:55.360
> 
> 标签：android, android-intent, android-button

我的应用程序中有一个按钮，当您按下它时会打开一个 pdf 文件。但是，当我退出 pdf 文件然后再次按下按钮时，它会在我上次打开的页面上打开 pdf 文件。是否可以让我的按钮每次从一开始就打开它？如何做到这一点？下面是我的代码：

```
ImageButton userGuide = (ImageButton) findViewById(R.id.main_menu_user_guide_button);
        userGuide.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                SimpleAudioEngine.sharedEngine(context).playEffect(
                        "sfx/Button_Pop.wav");
                File pdfFile = new File(Environment
                        .getExternalStorageDirectory().getAbsolutePath()
                        + "/MathBarsPDFDocument/userg.pdf");
                Uri path = Uri.fromFile(pdfFile);
                Intent intent = new Intent(Intent.ACTION_VIEW);
                intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                intent.setDataAndType(path, "application/pdf");
                try {

                    startActivity(intent);

                } catch (ActivityNotFoundException e) {
                    // No application to view, ask to download one
                    AlertDialog.Builder builder = new AlertDialog.Builder(
                            HelpMenu.this);
                    builder.setTitle("No Application Found");
                    builder.setMessage("Download one from Android Market?");
                    builder.setPositiveButton("Yes, Please",
                            new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog,
                                        int which) {
                                    Intent marketIntent = new Intent(
                                            Intent.ACTION_VIEW);
                                    marketIntent.setData(Uri
                                            .parse("market://details?id=com.adobe.reader"));
                                    startActivity(marketIntent);
                                }
                            });
                    builder.setNegativeButton("No, Thanks", null);
                    builder.create().show();
                }
            }
        });

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:43:21.473

> 是否可以让我的按钮每次都从一开始就打开它？

不，因为 PDF 查看器的行为取决于该 PDF 查看器的作者。有许多适用于 Android 的 PDF 查看器应用程序，每个都可以按照作者的意愿处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:30:20.177

在您的代码中，您正在发送一个隐含的意图。这使 android OS 可以决定哪个应用程序应该处理这个问题。你已经失去了对系统行为的控制。现在取决于 pdf 查看器应用程序的行为，它可以工作。您无法对其进行任何更改。如果您发现任何操作属性，那么它也不适用于所有应用程序。可以做的一件事是在您的应用程序中创建一个简单的 PDF 查看器活动。

# mysql - 插入数据库时 Python 脚本中的 Mysql 语法错误

> ID：16123220
> 
> 赞同：0
> 
> 时间：2013-04-20T17:32:06.413
> 
> 标签：mysql, xml, syntax-error

我对 python 和 mysql 也很陌生，目前正在尝试“将数据插入表中，我在我的机器上的 WAMP 服务器上为其设置的事件。我需要存储到数据库中的数据存储在各种我的python程序中的数组，这些都已正确存储。我能够通过我的python程序成功连接到localhost数据库，但是在写入数据库时​​我的mysql语法有问题。

我希望有人能够帮助我——我基本上已经设置了一个 for 循环来将存储在数组中的元素写入我在我的机器（localhost）上本地设置的数据库。

```
length = range(len(event_ids))
imageid = 0 

for z in length:
    cur.execute("""INSERT INTO events (event_id, event_title, start_time, stop_time, venue_id, image_id, all_day, venue_name) VALUES (%s, %s, %s, %s, %s, %s, %s, %s""" %(event_ids[z], event_names1[z], start_times1[z], stop_times1[z], venue_ids1[z], imageid, all_day_list1[z], venue_names1[z]))
    db.commit()

cursor.close()
db.close() 
```

我收到的错误包括以下信息。此处显示的元素是从我已成功指定的数组中读取的 "@2013042020, Prodijig Dublin, 2013-04-20 20:00:00, 2013-04-20 23:59:00, V0-001-0 :"。我只是不知道为什么会收到 SQL 语法错误。如果有人能就我可能出错的地方提供任何信息，我将不胜感激。

错误：

```
cur.execute("""INSERT INTO events (event_id, event_title, start_time, stop_time, venue_id, image_id, all_day, venue_name) VALUES (%s, %s, %s, %s, %s, %s, %s, %s""" %(event_ids[z], event_names1[z], start_times1[z], stop_times1[z], venue_ids1[z], imageid, all_day_list1[z], venue_names1[z]))
File "C:\Python27\lib\site-packages\MySQLdb\cursors.py", line 202, in execute
self.errorhandler(self, exc, value)
File "C:\Python27\lib\site-packages\MySQLdb\connections.py", line 36, in  defaulterrorhandler
raise errorclass, errorvalue
ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that    corresponds to your MySQL server version for the right syntax to use near '@2013042020, Prodijig Dublin, 2013-04-20 20:00:00, 2013-04-20 23:59:00, V0-001-0' at line 1") 
```

编辑：在下面的讨论之后，我对此代码进行了修复，但是由于某种原因我目前无法解释，我现在收到“IndexError：列表索引超出范围”错误，并且我的 python 程序在 35 次迭代后终止（当它应该迭代和向数据库插入元素 50 次）。如果有人也可以帮助我，我将不胜感激。但是，这可能与此声明无关-我现在还不确定。

无论如何，我固定的 mysql 插入代码是：

```
cur.execute('INSERT INTO events (event_id, event_title, start_time, stop_time, venue_id, image_id, all_day, venue_name) VALUES (%s, %s, %s, %s, %s, %s, %s, %s)' , (event_ids[z], event_names1[z], start_times1[z], stop_times1[z], venue_ids1[z], imageid, all_day_list1[z], venue_names1[z])) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:50:24.067

您需要在插入的所有字符串值周围加上引号：

```
cur.execute("""INSERT INTO events (event_id, event_title, start_time, stop_time, venue_id, image_id, all_day, venue_name) VALUES ('%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s'""" %(event_ids[z], event_names1[z], start_times1[z], stop_times1[z], venue_ids1[z], imageid, all_day_list1[z], venue_names1[z])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:45:27.480

您正在运行的查询是这样的：

```
INSERT INTO events (
    event_id, 
    event_title, 
    start_time, 
    stop_time, 
    venue_id, 
    image_id, 
    all_day, 
    venue_name) 
VALUES (
    @2013042020, 
    Prodijig Dublin, 
    2013-04-20 20:00:00, 
    2013-04-20 23:59:00, 
    V0-001-0  (rest of query is missing) 
```

MySQL 抱怨这`@2013042020`不是一个有效的值。我假设`event_id`是一个整数列，因此该值不应包含`@`符号。一旦你解决了这个问题，你会注意到 MySQL 对你的查询有更多的抱怨：

```
Prodijig Dublin     should be a string: 'Prodijig Dublin'
2013-04-20 20:00:00 should be a date  : #2013-04-20 20:00:00# (quotes also work)
2013-04-20 23:59:00 should be a date  : #2013-04-20 23:59:00#
V0-001-0            should be as tring: 'V-0-001-0' 
```

# java - 在没有任何线程的情况下计算进度条

> ID：16123222
> 
> 赞同：-1
> 
> 时间：2013-04-20T17:32:15.007
> 
> 标签：java, android

我如何计算进度条并冻结其他任何东西，最多只计算 10 秒（每秒更新一次）。

```
ProgressBar PB;
index=0;
while(index<10)

   {
     /*************  wait(one sec)/*********/
     PB.setProgress(index);
     index++;
   } 
```

任何人都可以告诉我这段代码是做什么的

```
while(index<10)
{

    android.os.SystemClock.sleep(1000);//sleep please here one sec
    PB.setprogressbar(index);         //no i sleep 10 sec and then  index=10!!!!
        index++;
} 
```

我不会使用线程，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T19:47:52.290

没有办法做到这一点，因为循环非常快并且它总是执行`sleep(1000)`.

# java - Android 应用活动问题

> ID：16123226
> 
> 赞同：0
> 
> 时间：2013-04-20T17:32:34.927
> 
> 标签：java, android, xml, android-layout

我无法打开活动。在我的第一个活动 (activity_main) 中，我有 3 个按钮。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:stretchColumns="1">

<TableLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#00FFFF"
    android:id="@+id/root"
    >

    <TableRow android:layout_margin="0dip"
        android:id="@+id/row1">
        <Button android:id="@+id/button01"
            android:background="#FFFFFF"
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:hint="@string/buttonText1"
            android:layout_marginTop="60dip"
            android:layout_marginBottom="15dip"
            android:padding="15dip" />

        </TableRow>

    <TableRow android:layout_margin="0dip"
        android:id="@+id/row2">
        <Button android:id="@+id/button02"
            android:background="#FFFFFF"
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:hint="@string/buttonText2"
            android:padding="15dip" />

        </TableRow>

    <TableRow android:layout_margin="0dip"
        android:id="@+id/row3">
        <Button android:id="@+id/button03"
            android:background="#FFFFFF"
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:layout_marginTop="15dip"
            android:hint="@string/buttonText3"
            android:onClick="browseExercises"
            android:padding="15dip" />

        </TableRow>

</TableLayout>
</LinearLayout> 
```

我单击第三个按钮，然后我的第二个活动打开，其中包含两个附加按钮。

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:stretchColumns="1">

<TableLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#00FFFF"
    android:id="@+id/root"
    >

    <TableRow android:layout_margin="0dip"
        android:id="@+id/row1">
        <Button android:id="@+id/button01"
            android:background="#FFFFFF"
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:hint="@string/alphabetical"
            android:layout_marginTop="60dip"
            android:layout_marginBottom="15dip"
            android:onClick="Alphabetical"
            android:padding="15dip" />

        </TableRow>

    <TableRow android:layout_margin="0dip"
        android:id="@+id/row2">
        <Button android:id="@+id/button99999"
            android:background="#FFFFFF"
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:hint="@string/group"
            android:onClick="muscleGroups"
            android:padding="15dip" />

        </TableRow>

</TableLayout>

</LinearLayout> 
```

我单击这些按钮中的任何一个，然后我收到一条错误消息，告诉我“不幸的是，Test_Project 已停止”。

我已经为这两个按钮中的每一个创建了一个活动，并且这两个按钮的所有内容都以与我创建第二个活动时完全相同的方式进行编码，该活动打开得很好，并且具有我可以单击而不会导致任何错误的按钮。我想我在这里遗漏了一些基本的东西，就像我创建了太多的活动一样，他们无法回顾我的 MainActivity.java 文件来寻找应该打开下一个活动的方法。这是我的 MainActivity.java 代码：

```
package com.example.test_project;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.content.Intent;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    public void browseExercises(View view){
        Intent intent = new Intent(this, BrowseExercises.class);
        startActivity(intent);
    }

    public void Alphabetical(View view){
        Intent intent = new Intent(this, Alphabetical.class);
        startActivity(intent);
    }

    public void muscleGroups(View view){
        Intent intent = new Intent(this, MuscleGroups.class);
        startActivity(intent);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.test_project"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.test_project.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.example.test_project.BrowseExercises"
            android:label="@string/title_activity_browse_exercises" 

            >
        </activity>
        <activity
            android:name="com.example.test_project.MuscleGroups"
            android:label="@string/title_activity_muscle_groups" >
        </activity>
        <activity
            android:name="com.example.test_project.Alphabetical"
            android:label="@string/title_activity_alphabetical" >
        </activity>
    </application>

</manifest> 
```

还有我的 logcat 文件：

```
04-20 13:46:57.632: W/dalvikvm(26747): threadid=1: thread exiting with uncaught exception (group=0x40dc42a0)
04-20 13:46:57.639: E/AndroidRuntime(26747): FATAL EXCEPTION: main
04-20 13:46:57.639: E/AndroidRuntime(26747): java.lang.IllegalStateException: Could not find a method muscleGroups(View) in the activity class com.example.test_project.BrowseExercises for onClick handler on view class android.widget.Button with id 'button99999'
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.view.View$1.onClick(View.java:3587)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.view.View.performClick(View.java:4106)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.view.View$PerformClick.run(View.java:17052)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.os.Handler.handleCallback(Handler.java:615)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.os.Looper.loop(Looper.java:137)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.app.ActivityThread.main(ActivityThread.java:5059)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at java.lang.reflect.Method.invokeNative(Native Method)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at java.lang.reflect.Method.invoke(Method.java:511)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:792)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:555)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at dalvik.system.NativeStart.main(Native Method)
04-20 13:46:57.639: E/AndroidRuntime(26747): Caused by: java.lang.NoSuchMethodException: muscleGroups [class android.view.View]
04-20 13:46:57.639: E/AndroidRuntime(26747):    at java.lang.Class.getConstructorOrMethod(Class.java:460)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at java.lang.Class.getMethod(Class.java:915)
04-20 13:46:57.639: E/AndroidRuntime(26747):    at android.view.View$1.onClick(View.java:3580)
04-20 13:46:57.639: E/AndroidRuntime(26747):    ... 11 more
04-20 13:46:59.202: I/Process(26747): Sending signal. PID: 26747 SIG: 9 
```

可能是一些非常简单的事情，我只是还不知道，但任何帮助将不胜感激！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:18:23.953

您是否为所有活动制作了 Java 文件？就像您要打开其他活动一样，它应该满足以下要求：

1.  应在清单文件中提及并采取适当的措施
2.  应该有一个对应于该活动的 java 文件
3.  应该定义布局文件，或者您应该通过代码创建布局
4.  应正确声明意图。

如果仍然存在问题，请添加更多您的意图调用代码和 java 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:02:38.847

通过查看您的评论，我猜您还没有为其他活动创建 JAVA 文件。例如，您必须`BrowseExercise.java`在主要活动所在的目录中创建文件。然后你需要在`AndroidManifest.xml`文件中定义这个Activity。一个简单的方法是点击`+`左上角（或类似的东西），然后点击 Android ， New Activity 。然后，您只需选择要使用的活动类型。

# facebook - facebook分享按钮图像无法正常工作

> ID：16123235
> 
> 赞同：0
> 
> 时间：2013-04-20T17:33:45.783
> 
> 标签：facebook

我不太懂英语，对此感到抱歉。然后我尝试解释我想将 facebook 分享属性添加到我的网站的问题。下面的代码

头标

```
 <script src="http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script> 
```

身体标签

```
<a name="fb_share" type="button" href="http://www.facebook.com/sharer.php">
<img src="img/pFace.png" alt="Share on Facebook" /></a> 
```

然后测试我的代码链接不起作用但是当删除 img 标签共享工作正常。

错误在哪里？

我发现实际问题是 facebook 共享链接未加载或延迟。在您看来什么是可能的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:45:32.053

共享按钮已弃用。最好使用“喜欢”按钮。请参阅[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

# iphone - AFNetworking 和其他框架的文件下载失败。wifi自动进入睡眠-目标c

> ID：16123236
> 
> 赞同：0
> 
> 时间：2013-04-20T17:33:47.000
> 
> 标签：iphone, ios, objective-c, afnetworking

我正在使用 AFNetworking 框架下载文件。文件在前台模式下下载良好。但是当我将我的应用程序置于后台时，iOS 会在 10 分钟后自动进入睡眠状态，并且我的 AFNetworking 请求失去连接。在我的 AppDelegate 中，我有这段代码来运行后台任务：

```
-(void) runBackgroundTask
{
   if (bgTaskId!=UIBackgroundTaskInvalid)
     [[UIApplication sharedApplication] endBackgroundTask: bgTaskId];

     UIBackgroundTaskIdentifier newTaskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
     [[UIApplication sharedApplication] endBackgroundTask: bgTaskId];
     [self runBackgroundTask];
}];
   bgTaskId = newTaskId;
} 
```

如何禁用自动 WiFi 睡眠？如果我在我的应用程序上运行音乐并下载文件 - 一切正常。WiFi 不会禁用。我该如何解决这个问题？

# java - 如何使用应用程序phoneGap访问谷歌驱动器并创建/编辑表融合

> ID：16123238
> 
> 赞同：1
> 
> 时间：2013-04-20T17:33:52.517
> 
> 标签：java, android, google-app-engine, google-maps-api-3, sencha-touch-2

请如果有人可以帮助我找到一种方法来开发一个功能，让我通过我的应用程序phoneGap（和sencha）访问我的谷歌驱动器的帐户并创建我自己的表（谷歌融合表）；我找到了一个文件 javascript：

```
 <!DOCTYPE html>
<!--
  Copyright 2011 Google Inc. All Rights Reserved.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html>
  <head>
    <title>JavaScript API Example</title>

    <style type="text/css">
      body { font-family: Arial; }
    </style>
    <script type="text/javascript">
      // The clientId and apiKey are available at
      // https://code.google.com/apis/console. For more information, see
      // http://code.google.com/p/google-api-javascript-client/wiki/Authentication.
      var clientId = '958693490238-nti7k45ajor0287286o8a5p4m26um32n.apps.googleusercontent.com';
      var clientSecret = 'p--MYTDoaqliiiSmP4TPFZX5';
      var apiKey = 'AIzaSyCa_oJyC4vX1KAbNoi0n0Zyqf_ZWTp8J7U';
      var scopes = 'https://www.googleapis.com/auth/fusiontables';
      var tableId;

      // Initialize the client, set onclick listeners.
      function initialize() {
        gapi.client.setApiKey(apiKey);
        document.getElementById('create-table').onclick = createTable;
        document.getElementById('insert-data').onclick = insertData;
        document.getElementById('select-data').onclick = selectData;
        window.setTimeout(function() { auth(true); }, 1);
      }

      // Run OAuth 2.0 authorization.
      function auth(immediate) {
        gapi.auth.authorize({
          client_id: clientId,
          client_secret: clientSecret,
          scope: scopes,
          immediate: immediate
        }, handleAuthResult);
      }

      // Handle the results of the OAuth 2.0 flow.
      function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        var createTableButton = document.getElementById('create-table');
        if (authResult) {
          authorizeButton.disabled = true;
          createTableButton.disabled = false;
        } else {
          authorizeButton.disabled = false;
          authorizeButton.onclick = function() { auth(false); return false; };
        }
      }

      // Run a request to create a new Fusion Table.
      function createTable() {
        var tableResource = [];
        tableResource.push('{');
        tableResource.push('"name": "People",');
        tableResource.push('"columns": [');
        tableResource.push('{ "name": "Name", "type": "STRING" },');
        tableResource.push('{ "name": "Age", "type": "NUMBER" }');
        tableResource.push('],')
        tableResource.push('"isExportable": true');
        tableResource.push('}');
        runClientRequest({
          path: '/fusiontables/v1/tables',
          body: tableResource.join(''),
          method: 'POST'
        }, function(resp) {
          var output = JSON.stringify(resp);
          document.getElementById('create-table-output').innerHTML = output;
          tableId = resp['tableId'];
          document.getElementById('table-id-1').innerHTML = tableId;
          document.getElementById('table-id-2').innerHTML = tableId;
          document.getElementById('insert-data').disabled = false;
          document.getElementById('select-data').disabled = false;
          document.getElementById('create-table').disabled = true;
        });
      }

      // Run a request to INSERT data.
      function insertData() {
        var name = document.getElementById('name').value;
        var age = document.getElementById('age').value;
        var insert = [];
        insert.push('INSERT INTO ');
        insert.push(tableId);
        insert.push(' (Name, Age) VALUES (');
        insert.push("'" + name + "', ");
        insert.push(age);
        insert.push(')');
        query(insert.join(''));
      }

      // Run a request to SELECT data.
      function selectData() {
        query('SELECT * FROM ' + tableId);
      }

      // Send an SQL query to Fusion Tables.
      function query(query) {
        var lowerCaseQuery = query.toLowerCase();
        var path = '/fusiontables/v1/query';
        var callback = function(element) {
          return function(resp) {
            var output = JSON.stringify(resp);
            document.getElementById(element).innerHTML = output;
          };
        }
        if (lowerCaseQuery.indexOf('select') != 0 &&
            lowerCaseQuery.indexOf('show') != 0 &&
            lowerCaseQuery.indexOf('describe') != 0) {

          var body = 'sql=' + encodeURIComponent(query);
          runClientRequest({
            path: path,
            body: body,
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded',
              'Content-Length': body.length
            },
            method: 'POST'
          }, callback('insert-data-output'));

        } else {
          runClientRequest({
            path: path,
            params: { 'sql': query }
          }, callback('select-data-output'));
        }
      }

      // Execute the client request.
      function runClientRequest(request, callback) {
        var restRequest = gapi.client.request(request);
        restRequest.execute(callback);
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=initialize"></script>
  </head>
  <body>
    <h1>
      Fusion Tables JavaScript Example
    </h1>
    <h2>
      (1) Authorize using OAuth 2.0
    </h2>
    <p>
      Click Authorize to start the OAuth 2.0 authorization flow. If you have
      already authorized, the button will be disabled.
    </p>
    <input type="button" id="authorize-button" value="Authorize"><br>

    <h2>
      (2) Create Table
    </h2>
    <p>
      Click "Create Table" to create an exportable Fusion Table called "People"
      with columns "Name" with type "STRING" and "Age" with type "NUMBER".
      <pre>
{
  "name": "People",
  "columns": [
    {
      "name": "Name",
      "type": "STRING"
    }, {
      "name": "Age",
      "type": "NUMBER"
    }
  ],
  "isExportable": true
}</pre>
    </p>
    <input type="button" id="create-table" value="Create Table"
        disabled="disabled">
    <p id="create-table-output"><i>table response goes here...</i></p><br>

    <h2>
      (3) Insert data
    </h2>
    <p>
      Insert data into the newly created table.
    </p>
    <pre>INSERT INTO <span id="table-id-1">[table_id]</span> (Name, Age) VALUES ([name], [age])</pre>
    <label>Name:</label>
    <input type="text" id="name"><br>
    <label>Age:</label>
    <input type="age" id="age"><br>
    <input type="button" id="insert-data" value="Insert data"
        disabled="disabled">
    <p id="insert-data-output"><i>insert response goes here...</i></p><br>

    <h2>
      (4) Select all the rows from the table
    </h2>
    <p>
      Select the data that has been inserted into the newly created table.
    </p>
    <pre>SELECT * FROM <span id="table-id-2">[table_id]</span></pre>
    <input type="button" id="select-data" value="Select data"
        disabled="disabled">
    <p id="select-data-output"><i>select response goes here...</i></p>
  </body>
</html> 
```

然后我将它与我自己的客户端 id 和 apiKey 集成到我的应用程序 sencha（在 localhost 中），它可以工作，但是当我将它部署到我的设备 android 中时它不会 :( 我知道我的设备没有检测到帐户的信息（我的 gmail 帐户在设备中处于活动状态，但没有出现授权页面）。

请帮忙！

# java - 在 Java 中添加矩阵

> ID：16123242
> 
> 赞同：1
> 
> 时间：2013-04-20T17:34:23.013
> 
> 标签：java, matrix

我需要编写一个关于如何添加两个矩阵的简短程序。第一个矩阵应该如下所示：

```
1 2 3 4 5 6 7 8 9 10
11 12 13.......19 20
21................30
31................40
41................50
etc..
91...............100 
```

但我并没有真正找到如何增加第一个数组的解决方案.. :S

这是我到目前为止得到的：

```
package uebung05;

public class MatrixAddition
{
    public static void main(String[] argv)
    {
        int firstArray[][]  = new int[10][10];
        int secondArray[][] = new int[10][10];
        int ergArray[][]    = new int[10][10];

        System.out.println("Matrix 1\n----------------------------");

        // Inkrementieren der ersten Matrix
        for(int row = 0; row < firstArray.length; row++)
        {
            for(int column = 0; column < firstArray[row].length; column++)
            {
                // Increment Array here???
                System.out.print(firstArray[row][column] + "  ");
            }
            System.out.println();
        }

        System.out.println("\nMatrix 2\n----------------------------");

        // Dekrementieren der zweiten Matrix
        for(int row = 0; row < secondArray.length; row++)
        {
            for(int column = 0; column < secondArray[row].length; column++)
            {
                // Array mit Werten befüllen
                secondArray[row][column] = column + 1;
                System.out.print(secondArray[row][column] + "  ");
            }
            System.out.println();
        }

        System.out.println("\nAddition beider Matrizen\n----------------------------");

        // Addition firstArray & secondArray
        for(int row = 0; row < ergArray.length; row++)
        {
            for(int column = 0; column < ergArray[row].length; column++)
            {
                // Addition
                ergArray[row][column] = firstArray[row][column] +
                                        secondArray[row][column];

                System.out.print(ergArray[row][column] + "  ");
            }
            System.out.println();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:39:05.420

将第一个和第二个矩阵相加的方法：

```
public static int[][] matrixAdd(int[][] A, int[][] B)
{
    // Check if matrices have contents
    if ((A.length < 0) || (A[0].length < 0)) return B;
    if ((B.length < 0) || (B[0].length < 0)) return A;

    // create new matrix to store added values in
    int[][] C = new int[A.length][A[0].length];

    for (int i = 0; i < A.length; i++)
    {
        for (int j = 0; j < A[i].length; j++)
        {
            C[i][j] = A[i][j] + B[i][j];
        }
    }
    return C;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:38:37.967

> 但我并没有真正找到如何增加第一个数组的解决方案。

```
// Inkrementieren der ersten Matrix
        for(int row = 0; row < firstArray.length; row++)
        {
            for(int column = 0; column < firstArray[row].length; column++)
            {
                firstArray[row][column] = 1+ row*10 + column; 
                System.out.print(firstArray[row][column] + "  ");
            }
            System.out.println();
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:48:37.543

在新的矩阵中求和两个矩阵并返回：

```
public int[][] addMatrixes(int[][] src1, int[][] src2){
  int[][] dst = new int[src1.length][src1[0].length];
  for(int i=0;i<src1.length;i++){
    for(int j=0;j<src1[0].length;j++){
      dst[i][j] = src1[i][j] + src2[i][j];
    }
  }
  return dst;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:57:28.150

不是很通用，但您可以只用一个简单的循环定义您的第一个矩阵：

```
 int dim = 10;
    int size = dim*dim;
    int firstArray[][]  = new int[dim][dim];
    int row, column;

    for (int index = 0; index < size; index++ ){
        row = index/dim;
        column = index%dim;
        firstArray[row][column]=row*10+column+1;

        System.out.print(String.valueOf(firstArray[row][column])+"\t");
        if (column == 9){ System.out.println("");}
    } 
```

# mysql - (1406, "Data too long for column 'sr_number' at row 1") 在 Django 中收到帖子并保存到 DB 后

> ID：16123245
> 
> 赞同：2
> 
> 时间：2013-04-20T17:34:38.020
> 
> 标签：mysql, django, forms, post

任何帮助将不胜感激，我对 django 和开发 Web 应用程序相当陌生，但到目前为止，我已经能够基本上暴力破解所有内容或自行解决；然而，这让我很难过。

出于某种原因，我的代码似乎试图从我的字段中提交整个 html，而不仅仅是它包含的数据，我不知道为什么。

错误消息调试显示：

```
POST Variable       Value
submitter           u'ccroffor'
csrfmiddlewaretoken u'P8s3aL4bkyzZJWHPitQVEIFS6Lxt3s6e'
sac_id              u'892064'
sr_number           u'3-3016786463' 
```

但是查询显示了这一点：

```
 query   
'INSERT INTO `autoed_submission` (`sr_number`, `sac_id`, `submission_time`, `completed_time`, `submitter`, `submission_helpful`, `submission_link`) VALUES (\'<textarea cols=\\"40\\" id=\\"id_sr_number\\" name=\\"sr_number\\" placeholder=\\"ex... 3-3010581928\\" rows=\\"1\\">\\r\\n3-3016786463</textarea>\', \'<textarea cols=\\"40\\" id=\\"id_sac_id\\" name=\\"sac_id\\" placeholder=\\"ex... 890046, 890052, ...\\" rows=\\"1\\">\\r\\n892064</textarea>\', \'2013-04-20\', NULL, \'<textarea cols=\\"40\\" id=\\"id_submitter\\" name=\\"submitter\\" placeholder=\\"ex... ccroffor\\" rows=\\"1\\">\\r\\nccroffor</textarea>\', \'U\', \'undefined\')' 
```

视图.py

```
def mySubView(request):
if request.method == 'POST':                                            #checking request
    form = AutoEdForm(request.POST)
    if form.is_valid():                                                             #validating form
        newSubmission = Submission(sr_number = form['sr_number'], sac_id = form['sac_id'], submitter = form['submitter'], submission_time = datetime.now(tzz))  #formatting form data to db model
        newSubmission.save()    #saving data to db
        return HttpResponseRedirect('/thanks/') #redirecting to thanks page
else:
    form = AutoEdForm() 
return render_to_response('submission.html', {'form':form,}, context_instance=RequestContext(request)) 
```

表格.py

```
class AutoEdForm(forms.Form):
sr_number = forms.CharField(
    max_length=100,
    label=u'SR Number',
    widget=forms.Textarea(
        attrs={
            'placeholder': 'ex... 3-3010581928',
            'rows': '1',
        })
)

sac_id = forms.CharField(
    max_length=100,
    label=u'Sac ID',
    widget=forms.Textarea(
        attrs={
            'placeholder': 'ex... 890046, 890052, ...',
            'rows': '1',
        })
)

submitter = forms.CharField(
    max_length=100,
    label=u'nai-corp Username',
    widget=forms.Textarea(
        attrs={
            'placeholder': 'ex... ccroffor',
            'rows': '1',
        })
)   

def clean(self):
    cleaned_data = super(AutoEdForm, self).clean()
    return cleaned_data 
```

相关的html

```
{% load bootstrap_toolkit %}
     <div class="container well">
    <form class="form-horizontal" action="" method="post">
        {% csrf_token %}
        {% for field in form %}
            {% include "bootstrap_toolkit/field_horizontal.html" %}
        {% endfor %}
            <input type="submit" value="Submit" class="btn btn-primary" style="margin-left:180px">           
    </form>
     </div> <!-- /container --> 
```

模型.py

```
class Submission(models.Model):

ED_VALUE = (
    ('A', 'Averted'),
    ('N', 'Not Averted'),
    ('U', 'Unanswered'),
)

sr_number = models.CharField(max_length=100)
sac_id = models.CharField(max_length=100)
submission_time = models.DateField(null=True)
completed_time = models.DateField(null=True)
submitter = models.CharField(max_length=100)
submission_helpful = models.CharField(max_length=100, choices=ED_VALUE, blank=False, default="U")
submission_link = models.CharField(max_length=100, blank=False,default="undefined") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:51:30.107

保存[清理后的数据](https://docs.djangoproject.com/en/1.5/ref/forms/api/#accessing-clean-data)，而不是表单域

```
if form.is_valid():
    data = form.cleaned_data
    newSubmission = Submission(sr_number = data['sr_number'], sac_id = data['sac_id'], submitter = data['submitter'], submission_time = datetime.now(tzz))  #formatting form data to db model 
```

# vb.net - Visual Basic - 为我的游戏高分设置上限

> ID：16123246
> 
> 赞同：2
> 
> 时间：2013-04-20T17:34:39.277
> 
> 标签：vb.net

我是一名学生，我正准备在 C 级编程中交付我的考试项目。

我在我的项目的最后，我编写了一个高分游戏。高分将分数保存在记事本中，以便在重新启动游戏时再次读取旧的高分。

问题是，每次出现新的高分时，它都会不断添加新的高分。所以如果我玩了 100 场比赛，就会有 100 个高分，我不希望这样。我想对我的高分设置一个限制。我在考虑15。

我有两个想法。第一个想法是程序只读取前 15 个高分。第二个想法是我创建一个读取旧高分列表的子程序，然后将其与新高分进行比较，并检查旧高分列表是否需要更新。

但问题是，我在编程时遇到了很大的麻烦。我现在将上传我的高分潜艇，并向你寻求帮助。

**这是我写高分榜的地方**

```
Private Sub skrivhighscore()
    ReDim Preserve HighscoreNavn(UBound(HighscoreNavn) + 1)
    ReDim Preserve HighscoreLevel(UBound(HighscoreLevel) + 1)

'insets the new highscore on the right place so that level is on top
        For i As Integer = 1 To UBound(HighscoreLevel)
        If (level > HighscoreLevel(i)) Then
            'the new highscore is bigger than highscorecount(i). inset the new here but first move the others 
            For j As Integer = UBound(HighscoreLevel) To i + 1 Step -1
                'kopier array(j-1) til array(j)
                HighscoreNavn(j) = HighscoreNavn(j - 1)
                HighscoreLevel(j) = HighscoreLevel(j - 1)
            Next j
            HighscoreNavn(i) = brugernavn
            ' sets highscore name to username. brugernavn = username
            HighscoreLevel(i) = level
            'set shighscorelvel(I) to the level the user died on.
            Exit For
        End If
    Next i

    'clear username and change level to 0
    brugernavn = ""
    level = 0

    'writes highscore to a file so it can be read next time
    highscoreboardskriv()

End Sub 
```

**这是我将高分列表保存到记事本的地方**

```
 Private Sub highscoreboardskriv()
    ' create a file at the same place as the game 
    'append:=False means overwrite and not repleace

    fileWriter = My.Computer.FileSystem.OpenTextFileWriter("HighScore.txt", append:=False)
    For i As Integer = 1 To UBound(HighscoreLevel)
        ' In every line the name is on the first   20 spaces and the score is from space   22
        'example: "Player1            :   2"
        If (HighscoreNavn(i) IsNot Nothing) AndAlso (HighscoreNavn(i).Trim <> "") Then
            ' If username is empty, it will not be written in the highscorelist. by using this method a highscore can be removed. 
            FileLine = HighscoreNavn(i).PadRight(20) & ":" & HighscoreLevel(i).ToString.PadLeft(5)
            fileWriter.WriteLine(FileLine)
        End If
    Next i

    fileWriter.Close()

End Sub 
```

**这是我展示我的高分榜的地方**

```
Private Sub Highscore()
    'Now we read both information again from the file 

    Dim HighScoreText As String = ""

    'highscorelist line by line
    For i As Integer = 1 To UBound(HighscoreLevel)
        'takes every spaces in an array (we dont use the first line)
        If (HighscoreNavn(i) IsNot Nothing) AndAlso (HighscoreNavn(i).Trim <> "") Then
            If (HighScoreText <> "") Then
                'new line by every highscore except the first line
                HighScoreText = HighScoreText & vbNewLine
            End If
            'line 1 example: "player1            :   230"
            HighScoreText = HighScoreText & HighscoreNavn(i).PadRight(20) & ":" & HighscoreLevel(i).ToString.PadLeft(5)
        End If
    Next i

    'show highscorelist to user
    MsgBox(HighScoreText, Title:="Highscore list")

End Sub 
```

**这是我从记事本中读取我的高分列表的地方：**

```
Public Sub highscoreboardlæs()

Public HighscoreNavn(0) As String
Public HighscoreLevel(0) As Integer
Public level As Integer = 0
Public fileReader As System.IO.StreamReader
Public FileLine As String

    Try
        fileReader = My.Computer.FileSystem.OpenTextFileReader("HighScore.txt")

        FileLine = fileReader.ReadLine()

        While (FileLine <> "") 'loop så længe der er linjer i filen, for at få alle highscores med

            'extend array with 1 extra line

            ReDim Preserve HighscoreNavn(UBound(HighscoreNavn) + 1)
            ReDim Preserve HighscoreLevel(UBound(HighscoreLevel) + 1)

            HighscoreNavn(UBound(HighscoreNavn)) = Mid(FileLine, 1, 20)
            HighscoreLevel(UBound(HighscoreLevel)) = Val(Mid(FileLine, 22, 5))

            'read next line from the file
            FileLine = fileReader.ReadLine()
        End While

        fileReader.Close()
    Catch
        'i use try method, else it will crash if there arent any highscorelist
    End Try
    'MsgBox("Highscore: " & vbNewLine & fileReader.ReadLine() & vbNewLine & fileReader.ReadLine() & vbNewLine & fileReader.ReadLine())
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:37:10.760

如果您只想在文件中保留 15 个分数，您可以将所有分数读入一个数组，对其进行排序并将 15 个最高的写回文件中。如果您有更长的分数列表，我不建议您这样做，因为您将所有分数加载到内存中，这可能会给您一个带有更大列表的 OOM（内存不足）异常，但在您的情况下它完全没问题。

```
Sub AddScore(score%, filePath$)
    Dim Scores As New List(Of Integer)

    ' Loads all the scores into our list
    Using Sr As New IO.StreamReader(filePath)
        Do Until Sr.EndOfStream
            Scores.Add(Sr.ReadLine)
        Loop
    End Using

    Scores.Sort() ' Sort it
    Scores.Reverse() ' Reverse it, as the the highest scores is at the bottom. You would property want to just read trough the last 15 items in the list rather than reversing it, but I'm just being lazy.

    ' Write the first 15
    Using Sw As New IO.StreamWriter(filePath, False)
        For i = 0 To Math.Min(Scores.Count - 1, 14)
            Sw.WriteLine(Scores(i))
        Next
    End Using
End Sub 
```

哦，顺便说一句，你的瑞典语对吗？你介意给我发个 PM，因为我对瑞典的编程学校很感兴趣。

# javascript - 确定嵌套深度以分配节点 D3.js 的大小

> ID：16123253
> 
> 赞同：1
> 
> 时间：2013-04-20T17:35:15.680
> 
> 标签：javascript, svg, d3.js, depth

我正在尝试使用 Flare.json 数据，而无需手动调整 size 属性以获得令人愉悦的结果。理想情况下，我希望大小是嵌套深度的函数，因此在下图中，层次结构树上的节点将是它们所在节点的百分比。我正在使用以下示例：[http ://bl.ocks.org/mbostock/4063530](http://bl.ocks.org/mbostock/4063530)

同样，参考深度的能力将允许动态设置笔画宽度和字体大小。这将解决通过缩放容器而不是通过转换重绘来实现缩放功能时发生的问题。

![在此处输入图像描述](https://i.stack.imgur.com/YwKVk.jpg)

以下是flare1000.json，其中所有大小都是相同的。我想那

```
{  
 "name": "flare",  
 "children": [  
  {  
   "name": "analytics",  
   "children": [  
    {  
     "name": "cluster",
     "children": [  
      {"name": "AgglomerativeCluster" ,"size":  1000},
      {"name": "CommunityStructure" ,"size":  1000},
      {"name": "HierarchicalCluster" ,"size":  1000},
      {"name": "MergeEdge" ,"size":  1000}
     ]  
    }, 
    {  
     "name": "graph",  
     "children": [  
      {"name": "BetweennessCentrality" ,"size":  1000},
      {"name": "LinkDistance" ,"size":  1000},
      {"name": "MaxFlowMinCut" ,"size":  1000},
      {"name": "ShortestPaths" ,"size":  1000},
      {"name": "SpanningTree" ,"size":  1000}
     ]  
    },
    {  
     "name": "optimization",  
     "children": [  
      {"name": "AspectRatioBanker" ,"size":  1000}
     ]  
    }  
   ]  
  } , 
  {  
   "name": "animate",  
   "children": [  
    {"name": "Easing" ,"size":  1000},
    {"name": "FunctionSequence" ,"size":  1000},
    {  
     "name": "interpolate",  
     "children": [  
      {"name": "ArrayInterpolator" ,"size":  1000},
      {"name": "ColorInterpolator" ,"size":  1000},
      {"name": "DateInterpolator" ,"size":  1000},
      {"name": "Interpolator" ,"size":  1000},
      {"name": "MatrixInterpolator" ,"size":  1000},
      {"name": "NumberInterpolator" ,"size":  1000},
      {"name": "ObjectInterpolator" ,"size":  1000},
      {"name": "PointInterpolator" ,"size":  1000},
      {"name": "RectangleInterpolator" ,"size":  1000}
     ]  
    } , 
    {"name": "ISchedulable" ,"size":  1000},
    {"name": "Parallel" ,"size":  1000},
    {"name": "Pause" ,"size":  1000},
    {"name": "Scheduler" ,"size":  1000},
    {"name": "Sequence" ,"size":  1000},
    {"name": "Transition" ,"size":  1000},
    {"name": "Transitioner" ,"size":  1000},
    {"name": "TransitionEvent" ,"size":  1000},
    {"name": "Tween" ,"size":  1000}
   ]  
  } , 
  {  
   "name": "data",  
   "children": [  
    {  
     "name": "converters",  
     "children": [  
      {"name": "Converters" ,"size":  1000},
      {"name": "DelimitedTextConverter" ,"size":  1000},
      {"name": "GraphMLConverter" ,"size":  1000},
      {"name": "IDataConverter" ,"size":  1000},
      {"name": "JSONConverter" ,"size":  1000}
     ]  
    } , 
    {"name": "DataField" ,"size":  1000},
    {"name": "DataSchema" ,"size":  1000},
    {"name": "DataSet" ,"size":  1000},
    {"name": "DataSource" ,"size":  1000},
    {"name": "DataTable" ,"size":  1000},
    {"name": "DataUtil" ,"size":  1000}
   ]  
  }  ,
  {  
   "name": "display" , 
   "children": [  
    {"name": "DirtySprite" ,"size":  1000},
    {"name": "LineSprite" ,"size":  1000},
    {"name": "RectSprite" ,"size":  1000},
    {"name": "TextSprite" ,"size":  1000}
   ]  
  } , 
  {  
   "name": "flex",  
   "children": [  
    {"name": "FlareVis" ,"size":  1000}
   ]  
  },  
  {  
   "name": "physics"  ,
   "children": [  
    {"name": "DragForce" ,"size":  1000},
    {"name": "GravityForce" ,"size":  1000},
    {"name": "IForce" ,"size":  1000},
    {"name": "NBodyForce" ,"size":  1000},
    {"name": "Particle" ,"size":  1000},
    {"name": "Simulation" ,"size":  1000},
    {"name": "Spring" ,"size":  1000},
    {"name": "SpringForce" ,"size":  1000}
   ]  
  } , 
  {  
   "name": "query",  
   "children": [  
    {"name": "AggregateExpression" ,"size":  1000},
    {"name": "And" ,"size":  1000},
    {"name": "Arithmetic" ,"size":  1000},
    {"name": "Average" ,"size":  1000},
    {"name": "BinaryExpression" ,"size":  1000},
    {"name": "Comparison" ,"size":  1000},
    {"name": "CompositeExpression" ,"size":  1000},
    {"name": "Count" ,"size":  1000},
    {"name": "DateUtil" ,"size":  1000},
    {"name": "Distinct" ,"size":  1000},
    {"name": "Expression" ,"size":  1000},
    {"name": "ExpressionIterator" ,"size":  1000},
    {"name": "Fn" ,"size":  1000},
    {"name": "If" ,"size":  1000},
    {"name": "IsA" ,"size":  1000},
    {"name": "Literal" ,"size":  1000},
    {"name": "Match" ,"size":  1000},
    {"name": "Maximum" ,"size":  1000},
    {  
     "name": "methods",  
     "children": [  
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
      {"name": "distinct" ,"size":  1000},
      {"name": "div" ,"size":  1000},
      {"name": "eq" ,"size":  1000},
      {"name": "fn" ,"size":  1000},
      {"name": "gt" ,"size":  1000},
      {"name": "gte" ,"size":  1000},
      {"name": "iff" ,"size":  1000},
      {"name": "isa" ,"size":  1000},
      {"name": "lt" ,"size":  1000},
      {"name": "Maximum" ,"size":  1000},
    {  
     "name": "methods",  
     "children": [  
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
      {"name": "distinct" ,"size":  1000},
      {"name": "div" ,"size":  1000},
      {"name": "eq" ,"size":  1000},
      {"name": "fn" ,"size":  1000},
      {"name": "gt" ,"size":  1000},
 {"name": "Maximum" ,"size":  1000},
    {  
     "name": "methods",  
     "children": [  
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
{"name": "Maximum" ,"size":  1000},
    {  
     "name": "methods" , 
     "children": [  
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
      {"name": "neq" ,"size":  1000},
      {"name": "not" ,"size":  1000},
      {"name": "or" ,"size":  1000},
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
      {"name": "neq" ,"size":  1000},
      {"name": "not" ,"size":  1000},
      {"name": "add" ,"size":  1000},
      {"name": "and" ,"size":  1000},
      {"name": "average" ,"size":  1000},
      {"name": "count" ,"size":  1000},
      {"name": "neq" ,"size":  1000},
      {"name": "not" ,"size":  1000},
      {"name": "or" ,"size":  1000},
      {"name": "orderby" ,"size":  1000},
      {"name": "range" ,"size":  1000},
      {"name": "select" ,"size":  1000},
      {"name": "stddev" ,"size":  1000},
      {"name": "sub" ,"size":  1000},
      {"name": "sum" ,"size":  1000},
      {"name": "update" ,"size":  1000},
      {"name": "variance" ,"size":  1000},
      {"name": "where" ,"size":  1000},
      {"name": "or" ,"size":  1000},
      {"name": "orderby" ,"size":  1000},
      {"name": "range" ,"size":  1000},
      {"name": "select" ,"size":  1000},
      {"name": "stddev" ,"size":  1000},
      {"name": "sub" ,"size":  1000},
      {"name": "sum" ,"size":  1000},
      {"name": "update" ,"size":  1000},
      {"name": "variance" ,"size":  1000},
      {"name": "where" ,"size":  1000},
      {"name": "orderby" ,"size":  1000},
      {"name": "range" ,"size":  1000},
      {"name": "select" ,"size":  1000},
      {"name": "stddev" ,"size":  1000},
      {"name": "sub" ,"size":  1000},
      {"name": "sum" ,"size":  1000},
      {"name": "update" ,"size":  1000},
      {"name": "variance" ,"size":  1000},
      {"name": "where" ,"size":  1000},
      {"name": "xor" ,"size":  1000}
     ]  
    } , 
      {"name": "distinct" ,"size":  1000},
      {"name": "div" ,"size":  1000},
      {"name": "eq" ,"size":  1000},
      {"name": "fn" ,"size":  1000},
      {"name": "gt" ,"size":  1000}
     ]  
    } , 
      {"name": "gte" ,"size":  1000},
      {"name": "iff" ,"size":  1000},
      {"name": "isa" ,"size":  1000},
      {"name": "lt" ,"size":  1000},
      {"name": "lte" ,"size":  1000},
      {"name": "max" ,"size":  1000},
      {"name": "min" ,"size":  1000}
     ]  
    } , 
      {"name": "mod" ,"size":  1000},
      {"name": "lte" ,"size":  1000},
      {"name": "max" ,"size":  1000},
      {"name": "min" ,"size":  1000},
      {"name": "mod" ,"size":  1000},
      {"name": "mul" ,"size":  1000},
      {"name": "neq" ,"size":  1000},
      {"name": "not" ,"size":  1000},
      {"name": "or" ,"size":  1000},
      {"name": "orderby" ,"size":  1000},
      {"name": "range" ,"size":  1000},
      {"name": "select" ,"size":  1000},
      {"name": "stddev" ,"size":  1000},
      {"name": "sub" ,"size":  1000},
      {"name": "sum" ,"size":  1000},
      {"name": "update" ,"size":  1000},
      {"name": "variance" ,"size":  1000},
      {"name": "where" ,"size":  1000},
      {"name": "xor" ,"size":  1000},
      {"name": "_" ,"size":  1000}
     ]  
    } , 
    {"name": "Minimum" ,"size":  1000},
    {"name": "Not" ,"size":  1000},
    {"name": "Or" ,"size":  1000},
    {"name": "Query" ,"size":  1000},
    {"name": "Range" ,"size":  1000},
    {"name": "StringUtil" ,"size":  1000},
    {"name": "Sum" ,"size":  1000},
    {"name": "Variable" ,"size":  1000},
    {"name": "Variance" ,"size":  1000},
    {"name": "Xor" ,"size":  1000}
   ]  
  },  
  {  
   "name": "scale",  
   "children": [  
    {"name": "IScaleMap" ,"size":  1000},
    {"name": "LinearScale" ,"size":  1000},
    {"name": "LogScale" ,"size":  1000},
    {"name": "OrdinalScale" ,"size":  1000},
    {"name": "QuantileScale" ,"size":  1000},
    {"name": "QuantitativeScale" ,"size":  1000},
    {"name": "RootScale" ,"size":  1000},
    {"name": "Scale" ,"size":  1000},
    {"name": "ScaleType" ,"size":  1000},
    {"name": "TimeScale" ,"size":  1000}
   ]  
  },  
  {  
   "name": "util" , 
   "children": [  
    {"name": "Arrays" ,"size":  1000},
    {"name": "Colors" ,"size":  1000},
    {"name": "Dates" ,"size":  1000},
    {"name": "Displays" ,"size":  1000},
    {"name": "Filter" ,"size":  1000},
    {"name": "Geometry" ,"size":  1000},
    {  
     "name": "heap",  
     "children": [  
      {"name": "FibonacciHeap" ,"size":  1000},
      {"name": "HeapNode" ,"size":  1000}
     ]  
    } , 
    {"name": "IEvaluable" ,"size":  1000},
    {"name": "IPredicate" ,"size":  1000},
    {"name": "IValueProxy" ,"size":  1000},
    {  
     "name": "math" ,
     "children": [  
      {"name": "DenseMatrix" ,"size":  1000},
      {"name": "IMatrix" ,"size":  1000},
      {"name": "SparseMatrix" ,"size":  1000}
     ]  
    } , 
    {"name": "Maths" ,"size":  1000},
    {"name": "Orientation" ,"size":  1000},
    {  
     "name": "palette" ,
     "children": [  
      {"name": "ColorPalette" ,"size":  1000},
      {"name": "Palette" ,"size":  1000},
      {"name": "ShapePalette" ,"size":  1000},
      {"name": "SizePalette" ,"size":  1000}
     ]  
    } , 
    {"name": "Property" ,"size":  1000},
    {"name": "Shapes" ,"size":  1000},
    {"name": "Sort" ,"size":  1000},
    {"name": "Stats" ,"size":  1000},
    {"name": "Strings" ,"size":  1000}
   ]  
  },  
  {  
   "name": "vis",  
   "children": [  
    {  
     "name": "axis",  
     "children": [  
      {"name": "Axes" ,"size":  1000},
      {"name": "Axis" ,"size":  1000},
      {"name": "AxisGridLine" ,"size":  1000},
      {"name": "AxisLabel" ,"size":  1000},
      {"name": "CartesianAxes" ,"size":  1000}
     ]  
    },  
    {  
     "name": "controls",  
     "children": [  
      {"name": "AnchorControl" ,"size":  1000},
      {"name": "ClickControl" ,"size":  1000},
      {"name": "Control" ,"size":  1000},
      {"name": "ControlList" ,"size":  1000},
      {"name": "DragControl" ,"size":  1000},
      {"name": "ExpandControl" ,"size":  1000},
      {"name": "HoverControl" ,"size":  1000},
      {"name": "IControl" ,"size":  1000},
      {"name": "PanZoomControl" ,"size":  1000},
      {"name": "SelectionControl" ,"size":  1000},
      {"name": "TooltipControl" ,"size":  1000}
     ]  
    } , 
    {  
     "name": "data",  
     "children": [  
      {"name": "Data" ,"size":  1000},
      {"name": "DataList" ,"size":  1000},
      {"name": "DataSprite" ,"size":  1000},
      {"name": "EdgeSprite" ,"size":  1000},
      {"name": "NodeSprite" ,"size":  1000},
      {  
       "name": "render",  
       "children": [  
        {"name": "ArrowType" ,"size":  1000},
        {"name": "EdgeRenderer" ,"size":  1000},
        {"name": "IRenderer" ,"size":  1000},
        {"name": "ShapeRenderer" ,"size":  1000}
       ]  
      },  
      {"name": "ScaleBinding" ,"size":  1000},
      {"name": "Tree" ,"size":  1000},
      {"name": "TreeBuilder" ,"size":  1000}
     ]  
    },  
    {  
     "name": "events",  
     "children": [  
      {"name": "DataEvent" ,"size":  1000},
      {"name": "SelectionEvent" ,"size":  1000},
      {"name": "TooltipEvent" ,"size":  1000},
      {"name": "VisualizationEvent" ,"size":  1000}
     ]  
    } , 
    {  
     "name": "legend" , 
     "children": [  
      {"name": "Legend" ,"size":  1000},
      {"name": "LegendItem" ,"size":  1000},
      {"name": "LegendRange" ,"size":  1000}
     ]  
    },  
    {  
     "name": "operator",  
     "children": [  
      {  
       "name": "distortion",  
       "children": [  
        {"name": "BifocalDistortion" ,"size":  1000},
        {"name": "Distortion" ,"size":  1000},
        {"name": "FisheyeDistortion" ,"size":  1000}
       ]  
      },  
      {  
       "name": "encoder",  
       "children": [  
        {"name": "ColorEncoder" ,"size":  1000},
        {"name": "Encoder" ,"size":  1000},
        {"name": "PropertyEncoder" ,"size":  1000},
        {"name": "ShapeEncoder" ,"size":  1000},
        {"name": "SizeEncoder" ,"size":  1000}
       ]  
      },  
      {  
       "name": "filter",  
       "children": [  
        {"name": "FisheyeTreeFilter" ,"size":  1000},
        {"name": "GraphDistanceFilter" ,"size":  1000},
        {"name": "VisibilityFilter" ,"size":  1000}
       ]  
      },  
      {"name": "IOperator" ,"size":  1000},
      {  
       "name": "label",  
       "children": [  
        {"name": "Labeler" ,"size":  1000},
        {"name": "RadialLabeler" ,"size":  1000},
        {"name": "StackedAreaLabeler" ,"size":  1000}
       ]  
      },  
      {  
       "name": "layout",  
       "children": [  
        {"name": "AxisLayout" ,"size":  1000},
        {"name": "BundledEdgeRouter" ,"size":  1000},
        {"name": "CircleLayout" ,"size":  1000},
        {"name": "CirclePackingLayout" ,"size":  1000},
        {"name": "DendrogramLayout" ,"size":  1000},
        {"name": "ForceDirectedLayout" ,"size":  1000},
        {"name": "IcicleTreeLayout" ,"size":  1000},
        {"name": "IndentedTreeLayout" ,"size":  1000},
        {"name": "Layout" ,"size":  1000},
        {"name": "NodeLinkTreeLayout" ,"size":  1000},
        {"name": "PieLayout" ,"size":  1000},
        {"name": "RadialTreeLayout" ,"size":  1000},
        {"name": "RandomLayout" ,"size":  1000},
        {"name": "StackedAreaLayout" ,"size":  1000},
        {"name": "TreeMapLayout" ,"size":  1000}
       ]  
      },  
      {"name": "Operator" ,"size":  1000},
      {"name": "OperatorList" ,"size":  1000},
      {"name": "OperatorSequence" ,"size":  1000},
      {"name": "OperatorSwitch" ,"size":  1000},
      {"name": "SortOperator" ,"size":  1000}
     ]  
    },  
    {"name": "Visualization" ,"size":  1000}
   ]  
  }  
 ]  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T20:03:30.217

我在 api 中没有找到对它的显式引用，但是有一个 d.depth 方法可以从根跟踪节点的深度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-22T16:13:43.133

我一直有类似的问题。具体来说，我正在使用的数据具有“大小”属性并没有真正意义，并且将其写入我可能想要显示的所有不同数据中不值得我花时间。要解决该问题，至少您需要查看以下代码：

```
var pack = d3.layout.pack()
    .size([diameter - 4, diameter - 4])
    .value(function(d) { return d.size; }); 
```

并用任何整数替换 d.size 。（我把它作为 Math.random() 的一个函数来获得任意大小的一些变化。）

至于深度，在对 API 和 d3.v3.js 进行了一些研究之后，在我看来，pack 布局默认不包含 d.depth 方法。这超出了我的编码技能水平，但假设您仍然在处理这个项目，您可能能够找出它包含的布局的深度是如何定义的并使用它。祝你好运！

# hadoop - mapreduce如何共享全局const变量

> ID：16123255
> 
> 赞同：2
> 
> 时间：2013-04-20T17:35:30.430
> 
> 标签：hadoop, mapreduce

如何允许我的所有映射器访问一个变量，例如一个`TreeMap`对象，而不需要每个映射器每次都重新构造`TreeMap`？对象一旦构建就永远不会再被修改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T19:05:59.960

考虑将`TreeMap`对象的内容放在[`Distributed Cache`](https://stackoverflow.com/questions/13746561/accessing-files-in-hadoop-distributed-cache). 如果是少量数据，您可以将对象内容放在配置对象中：

```
conf.set("key", "value"); 
```

然后使用 JobConf 对象在您的映射器中访问它。

# jquery - 查询：2个div左右滑动

> ID：16123260
> 
> 赞同：2
> 
> 时间：2013-04-20T17:36:11.063
> 
> 标签：jquery, slider

我有这个 html

```
<div id="container">
    <div id="slide">
        <div id="slide1">
            Content 1
            <a href="#" id="show-slide2">Show Content 2</a>
        </div>
        <div id="slide2">
            Content 2
        </div>
    </div>
</div> 
```

`#container`有`max-width:1250px`。仅`#slide1`应显示 Onload。现在我想点击`a#show-slide2`并且`#slide2`应该从右边滑入。

我需要什么 CSS 和 JS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:50:02.080

`**[LIVE DEMO](http://jsbin.com/aqesiw/3/edit)**`

HTML

```
<div id="slides">
  <div>
    Content 1
    <a href="#" id="show-slide2">Show Content 2</a>
  </div>
  <div>
    Content 2
  </div>
</div> 
```

CSS：

```
#slides{  
  position:relative;
  overflow:hidden;
  margin:0 auto;
  background:#cf5;
  width:400px;
  height:200px;
  white-space:nowrap;
}
#slides div{
  position:relative;
  display:inline-block;
  margin-right:-4px;
  white-space:normal;
  vertical-align:top;
  *display:inline;
  background:#eee;
  width:400px;
  height:200px;
} 
```

jQuery：

```
$(function(){

  var slideW = $('#slides').width();
  $('#show-slide2').click(function( e ){
    e.preventDefault();
    $('#slides').animate({scrollLeft: slideW }, 600);
  });

}); 
```

# javascript - html5 数据库将 '?!& 等作为特殊字符保存在 html5 数据库中

> ID：16123261
> 
> 赞同：1
> 
> 时间：2013-04-20T17:36:14.410
> 
> 标签：javascript, sql, database, string, html

我有一个 HTML5 应用程序，我试图将所有特殊字符保存为特殊字符

例如

eihefrgredirngfdig'dfdfgdfgg ...我希望将 ' 保存为特殊字符。有没有办法进行字符串替换？

```
case 5:
            tx.executeSql('CREATE TABLE IF NOT EXISTS notes(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, now, created DATETIME, title, note)');
            tx.executeSql('INSERT INTO notes(now, created, title, note) VALUES(?, ?, ?, ?)', [now, mytime, notetitle, notenote]); 
```

其他一切正常。我只是希望能够用 html5 特殊字符等效替换任何和所有特殊字符。有人对我可以字符串替换的hosw有什么建议吗？我已经在 php 中完成了它，但我似乎无法让它在 javascript 中正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T15:51:08.470

没有您可以简单使用的功能。但是我不知道您的`tx.executeSql()`功能，但它看起来像一个预先配对的语句（只是连接您使用标签 javascript），您不需要关心正确转义数据库框架应该自己处理的输入字符串。

```
function myReplace(instr) {
    instr.replace("'", "\\'").replace("?","\\?");
} 
```

上面的代码屏蔽了输入字符`'`，`?`并且可以根据您的需要进行简单的扩展。

# null - 如果将空值作为布尔参数传递，则具有布尔标准的 JPA 命名查询不起作用

> ID：16123262
> 
> 赞同：1
> 
> 时间：2013-04-20T17:36:19.293
> 
> 标签：null, boolean, jpa-2.0

这有效：

```
@NamedQuery(name="all_submissions",query="select s from Submission s where (s.id= :id or s.testCode= :code or s.user.email = :email) and s.readOnce != NULL") 
```

### s.readOnce != NULL

但这不起作用

```
@NamedQuery(name="search_submissions",query="select s from Submission s where (s.id= :id or s.user.email = :email or s.testCode = :code) and s.readOnce != :readonceflag") 
```

### s.readOnce != :readonceflag

query.setParameter("readonceflag",null);

```
@Column(name="read_once")
public Boolean readOnce;

#sql
read_once  boolean null, 
```

那么，如何使用布尔属性实现非空检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:40:43.050

有效的语法类似于 SQL : `where s.readOnce is not null`。您必须将 null 视为特殊情况。您无法与 null 进行比较`=`。在 SQL 中，没有任何东西等于 null，甚至不等于 null。

# r - 如何通过R语言中的fUnitRoots包来识别时间序列是否平稳

> ID：16123269
> 
> 赞同：4
> 
> 时间：2013-04-20T17:36:35.693
> 
> 标签：r

我有一个时间序列，比方说

694 281 479 646 282 317 790 591 573 605 423 639 873 420 626 849 596 486 578 457 465 518 272 549 437 445 596 396 259 390

现在，我想通过 ARIMA 模型预测以下值，但是 ARIMA 要求时间序列是平稳的，所以在此之前，我必须确定上面的时间序列是否符合要求，然后 fUnitRoots 出现。

我认为[http://cran.r-project.org/web/packages/fUnitRoots/fUnitRoots.pdf](http://cran.r-project.org/web/packages/fUnitRoots/fUnitRoots.pdf)可以提供一些帮助，但是没有简单的教程

我只想要一个小演示来展示如何识别一个时间序列，有吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:21:32.247

我将给出使用`urca`package in 的示例`R`。

```
library(urca)
data(npext) # This is the data used by Nelson and Plosser (1982)
sample.data<-npext
head(sample.data)
 year      cpi employmt gnpdefl nomgnp interest    indprod gnpperca realgnp wages realwag sp500 unemploy velocity  M
1 1860 3.295837       NA      NA     NA       NA -0.1053605       NA      NA    NA      NA    NA       NA       NA NA
2 1861 3.295837       NA      NA     NA       NA -0.1053605       NA      NA    NA      NA    NA       NA       NA NA
3 1862 3.401197       NA      NA     NA       NA -0.1053605       NA      NA    NA      NA    NA       NA       NA NA
4 1863 3.610918       NA      NA     NA       NA  0.0000000       NA      NA    NA      NA    NA       NA       NA NA
5 1864 3.871201       NA      NA     NA       NA  0.0000000       NA      NA    NA      NA    NA       NA       NA NA
6 1865 3.850148       NA      NA     NA       NA  0.0000000       NA      NA    NA      NA    NA       NA       NA NA 
```

我将用于`ADF`执行单位根检验`industrial production index`作为说明。是根据`lag`选择的`SIC`。我使用趋势，因为日期中有趋势。

```
 ############################################### 
# Augmented Dickey-Fuller Test Unit Root Test # 
############################################### 

Test regression trend 

Call:
lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31644 -0.04813  0.00965  0.05252  0.20504 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.052208   0.017273   3.022 0.003051 ** 
z.lag.1     -0.176575   0.049406  -3.574 0.000503 ***
tt           0.007185   0.002061   3.486 0.000680 ***
z.diff.lag   0.124320   0.089153   1.394 0.165695    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 0.09252 on 123 degrees of freedom
Multiple R-squared: 0.09796,    Adjusted R-squared: 0.07596 
F-statistic: 4.452 on 3 and 123 DF,  p-value: 0.005255 

Value of test-statistic is: -3.574 11.1715 6.5748 

Critical values for test statistics: 
      1pct  5pct 10pct
tau3 -3.99 -3.43 -3.13
phi2  6.22  4.75  4.07
phi3  8.43  6.49  5.47 
```

#Interpretation：`BIC`选择`lag 1`最佳滞后。检验统计`-3.574`量小于`tau3`5% (-3.430) 的临界值。因此，仅在 处拒绝存在单位根的空值`5 percent`。

[此外，请查看此处](http://otexts.com/fpp/8/1/)提供的免费预测书

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T22:17:54.833

当然，您可以进行正式测试，例如 ADF 测试，但我建议您首先进行平稳性的“非正式测试”。

使用可视化检查数据`plot()`将帮助您确定数据是否静止。

下一步是研究数据的自相关函数和偏自相关函数。您可以通过调用`acf()`和`pacf()`函数来做到这一点。这不仅可以帮助您确定数据是否稳定，还可以帮助您确定暂定的 ARIMA 模型，如果它们在执行必要的诊断检查后完全清楚，则可以在以后进行估计和预测。

事实上，您应该注意您提供的数据中只有 30 个观察值。这低于使用 ARIMA 模型进行预测所需的大约 50 个观测值的实际最低水平。

如果有帮助的话，在我绘制数据后不久，我几乎可以肯定数据可能是静止的。估计的 acf 和 pacf 似乎证实了这一观点。有时像这样的非正式测试就足够了。

这本[关于时间序列的小册子](http://a-little-book-of-r-for-time-series.readthedocs.org/en/latest/)可能会对您有所帮助。

# ruby-on-rails - 嵌套表单的另一个质量分配错误

> ID：16123275
> 
> 赞同：0
> 
> 时间：2013-04-20T17:36:59.277
> 
> 标签：ruby-on-rails, nested-forms

我已经这样做了 10 次，每次我似乎都遇到了嵌套表单的一些问题。这是我所拥有的：

客户端控制器：

```
 def new
    @client = Client.new
    @contact = @client.contacts.new
    @header = "New Client"

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @client }
    end
  end 
```

客户端类：

```
class Client < ActiveRecord::Base
  ## ASSOCIATIONS ##
  belongs_to :user
  has_many :contacts, :dependent => :destroy
  has_many :invoices

  ## ACCESSIBLE ##
  attr_accessible :name, :address_line_one, :address_line_two,
                      :contacts_attributes
  ## NESTED ATTRIBUTES ##
  accepts_nested_attributes_for :contacts 
```

形式：

```
 = form_for(@client) do |f|
    = f.fields_for(@contact) do |contact| 
```

但我在提交表单时仍然收到此错误：

```
Can't mass-assign protected attributes: contact 
```

和参数：

```
"client"=>{"name"=>"23",
 "contact"=>{"name"=>"asdf",
 "email"=>"af@gmail.com"}},
 "commit"=>"Save"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:58:01.820

我会做的是：

```
def new
  @client = Client.new
  @client.contacts.build
  @header = "New Client"

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @client }
  end
end 
```

和：

```
= form_for(@client) do |f|
  = f.fields_for(:contacts) do |contact| 
```

# html - HTML ARIA 验证问题 (HTML5)

> ID：16123276
> 
> 赞同：4
> 
> 时间：2013-04-20T17:37:01.850
> 
> 标签：html, html-lists, accessibility, w3c-validation, wai-aria

我几乎可以确保我的网站始终有效。

所以今天，在更改了我网站上的某个项目后，我再次运行了 W3C 验证器。

突然出现大约 20 个错误 - 星期四（2 天前）不存在。

（为了验证，我选择了 HTML5 / UTF8 - 就像上次一样）

出于某种原因，我现在得到一个：

> 元素`li`缺少以下一个或多个属性：aria-checked、aria-expanded、aria-valuemax、aria-valuemin、aria-valuenow、aria-valuetext、role."-我使用的每个列表项的错误。

ARIA 是强制性的吗？如果是，为什么我会突然收到这些错误——而我两天前没有？

可能是我忽略了一些东西。我的网站可以在这里找到：http: [//www.project-voorbeeld3.be/](http://www.project-voorbeeld3.be/)

我不得不承认，ARIA 在这一点上对我来说是新的——但我已经浏览了很多关于它的文章，我似乎无法弄清楚哪里出了问题。

欢迎提供任何线索！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:30:01.877

似乎是虚惊一场（只是某人的错误）。[从 http://lists.w3.org](http://lists.w3.org/Archives/Public/www-validator-cvs/2013Apr/0038.html)找到这条消息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:07:32.673

在 HTML5 中强制使用 ARIA 是完全愚蠢的。有些网站实际上不需要任何 ARIA 功能，这意味着所有用于验证的网页都必须重新完成：大量无意义的工作。另一方面，当我实际使用验证器在我的 HTML 中发现真正的问题时，很难忽略 ARIA 错误。ARIA 很好，但它必须是可选的，而不是强制性的。我希望他们能尽快从验证器中删除这些废话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T13:42:06.630

截至今天，似乎与 ARIA 相关的 HTML5 错误已消失。

可以从这个网站进行 ARIA 验证：http: [//validator.w3.org/nu/](http://validator.w3.org/nu/)
但请注意这个警告：

> W3C Nu 标记验证服务对 ARIA 检查的支持正在进行中，因此不能完全依赖它来提供正确的结果。

# python - 如何控制 lxml xpath text() 函数中的换行符处理？

> ID：16123277
> 
> 赞同：4
> 
> 时间：2013-04-20T17:37:07.487
> 
> 标签：python, xpath, newline, lxml, carriage-return

从 Fedora 17 切换到 18 后，对于相同的 lxml 代码，我得到了不同的解析行为，这显然是由于底层库的版本不同（libxml2 和 libxslt 版本发生了变化）。

这是两个版本的不同结果的 lxml 代码示例：

```
from io import BytesIO
from lxml import etree

myHtmlString = \
    '<!doctype html public "-//w3c//dtd html 4.0 transitional//en">\r\n'+\
    '<html>\r\n'+\
    '<head>\r\n'+\
    '   <title>Title</title>\r\n'+\
    '</head>\r\n'+\
    '<body/>\r\n'+\
    '</html>\r\n'
myFile = BytesIO(myHtmlString)
myTree = etree.parse(myFile, etree.HTMLParser())
myTextElements = myTree.xpath("//text()")
myFullText = ''.join([myEl for myEl in myTextElements])

assert myFullText == 'Title', repr(myFullText) 
```

f17 版本通过了断言，即`xpath("//text()")`只返回 text `'Title'`，而 f18 版本失败并输出

```
Traceback (most recent call last):
  File "TestLxml.py", line 17, in <module>
    assert myFullText == 'Title', repr(myFullText)
AssertionError: '\r\n\r\n   Title\r\n\r\n\r\n' 
```

显然，f18 版本处理换行符和空格的方式与 f17 版本不同。

有没有办法控制这种行为？（某个地方的可选参数？）或者更好的是，有没有一种方法可以让我使用新库恢复旧行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T20:55:57.200

在 XML 中， text() 按原样（未剥离）返回标签内的文本，因此如果您有任何空白字符、制表符、新行，它们将被包括在内。

可能是您使用 + 和 \n\r 构建多行字符串的方式意外测试了两个不同的字符串。

如果您将字符串更改为如下例所示的三引号字符串并对其进行测试。

```
from io import BytesIO
from lxml import etree

html = '''
    <!doctype html public "-//w3c//dtd html 4.0 transitional//en">
    <html>
    <head>
       <title>Title</title>
    </head>
    <body/>
    </html>
'''
tree = etree.parse(BytesIO(html), etree.HTMLParser())
text_elements = tree.xpath("//text()")
full_text = ''.join(text_elements)
assert full_text == 'Title', repr(full_text) 
```

您还可以看到，用空格或换行符包围文本使它们成为 text() 函数返回的一部分。见`title`下文。

```
html = '''
<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <title>   Title   </title>
</head>
<body/>
</html>
'''
tree = etree.parse(BytesIO(html), etree.HTMLParser())
text_elements = tree.xpath("//text()")
full_text = ''.join(text_elements)
assert full_text == '   Title   ', repr(full_text) 
```

如果你不需要空格，你可以自己在字符串上调用 strip() 。如果您确定即使您的标签不包含空格，您也会收到空格，那么您应该将其报告为[lxml 邮件列表](http://lxml.de/index.html#mailing-list)上的错误。

# c++ - 指定容器类型的迭代器类型的部分特化

> ID：16123279
> 
> 赞同：3
> 
> 时间：2013-04-20T17:37:20.070
> 
> 标签：c++, templates, partial-specialization

我有一个模板结构，它接受模板参数的迭代器类型。现在我需要为不同容器的迭代器专门化该类。我试过 std::vector

```
template<typename Iterator>
struct AC {

};

template<typename T, typename Alloc>
struct AC<typename std::vector<T, Alloc>::iterator> { //this doesn't work

}; 
```

但我得到了这个编译器错误（VS11）：'T'：模板参数在部分专业化中未使用或可推导

有人可以告诉我为什么这不起作用吗？以及如何让它发挥作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:42:45.413

您不能推断出嵌套的类型`::`。确实，你的问题毫无意义。考虑这个更简单的反例：

```
template <typename> struct Foo;
template <> struct Foo<bool> { typedef float type; };
template <> struct Foo<char> { typedef float type; };

template <typename> struct DoesntWork;

template <typename T> struct DoesntWork<typename Foo<T>::type> { }; 
```

现在如果我说`DoesntWork<float>`，应该`T`是什么？

关键是没有理由存在*任何* 你想要匹配的东西，即使有，也没有理由让它是独一无二的。`T``Foo<T>::type`

# javascript - 自定义 Bootstrap 的验证工具提示？

> ID：16123284
> 
> 赞同：6
> 
> 时间：2013-04-20T17:37:37.467
> 
> 标签：javascript, validation, twitter-bootstrap, tooltip

有人可以向我解释如何自定义 Bootstrap 的输入 type="email" 验证工具提示，如下所示？

![工具提示 - 请输入电子邮件地址。](https://i.stack.imgur.com/Jldpn.png)

或者更好的是，有人可以解释一下如何自定义 Bootstrap 的验证工具提示吗？

* * *

**编辑：**

[Le_Morri](https://stackoverflow.com/users/2239349/le-morri)已经指出，这实际上是一个 HTML 5 验证工具提示。我将把这个问题留给与我犯同样错误的其他人。

以下问题将有助于 HTML5 验证样式，

*   [您如何设置 HTML5 表单验证消息的样式？](https://stackoverflow.com/questions/5713405/how-do-you-style-the-html5-form-validation-messages)
*   [如何使用 css 设置 html 5 表单验证错误消息的样式？](https://stackoverflow.com/questions/5328883/how-do-i-style-the-html-5-form-validation-error-messages-with-css)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-21T09:50:21.107

据我所知，这些验证工具提示不是来自引导程序。它们是 HTML5 功能，由浏览器提供和设置样式。

[在这里](http://webdesign.tutsplus.com/tutorials/site-elements/bring-your-forms-up-to-date-with-css3-and-html5-validation/)，您可以找到如何创建自己的验证工具提示的指南。

在 Webkit 浏览器中，您可以使用以下方式设置这些工具提示的样式：

```
::-webkit-validation-bubble-message {
    padding: 1em;
} 
```

并且使用 CSS`:invalid`选择器，您可以设置错误输入的样式

# php - 将 UI 标记与静态内容分离的 PHP 模式

> ID：16123285
> 
> 赞同：1
> 
> 时间：2013-04-20T17:37:38.333
> 
> 标签：php, user-interface, decoupling

我处理一个由大量静态内容组成的网站。关于该网站，困扰我的一件事是重复/一次性标记的数量，每次我必须更改或更新 UI 时，我都必须修改很多不同的文件，然后确保我没有打破任何东西。我正在考虑将网站内容移动到 PHP 服务器并重新组织网站内容以使我的工作更轻松。

/* 这对我来说也是一种练习。我想用 PHP 弄湿我的脚。因此，我选择不使用现成的框架。*/

以下模式是否适合用于静态网站？也就是说，假设我想要一个简单的框架来管理我的网站，并且我想将我的网站 UI 与我的内容分离，这是完成它的合理方法吗？我有没有忽略什么？

假设我想为网站上的每个页面声明我的内容，如下所示：

```
/* begin contentStub.php */
<?php $headerUtil->setTitle("Hola Mundo!"); ?>
<p>Hello world</p>
/* end contentStub.php */ 
```

还假设我想为我的网站使用一个简单的模板，如下所示：

```
/* begin UITemplate.php */
<!DOCTYPE html>
<html>
    <head>
        <title><?php echo($headerUtil->getTitle()); ?></title>
    </head>
    <body>
        <?php echo($content); ?> 
    </body>
</html>
/* end UITemplate.php */ 
```

现在假设我将 auto_prepend_file 的 PHP 指令设置为使用以下文件：

```
/* begin file: prepend.php */
<?php
    class HeaderUtil
    {
        private $title;
        public function __construct()
        {
            $this->title = "new page";
        }
        public function getTitle(){return $this->title;}
        public function setTitle($title){$this->title = $title;}

        //TODO: Add methods/collections to deal with css/js/keywords
    }

    $headerUtil = new HeaderUtil();

    ob_start();
        include($_SERVER['SCRIPT_FILENAME']);
    $content = ob_get_contents();
    ob_end_clean();

    include("UITemplate.php");

    die();
?>
/*  end file: prepend.php */ 
```

这个例子似乎按照我的预期运行。这是使用 PHP 将我的网站 UI 与我的内容分离的合理方法吗？更具体地说，假设我的要求不变，使用我的方法是否会面临任何明显和/或重大的安全性、稳定性或资源耗尽风险？

提问的动机：我对 Coldfusion 有一些经验，并且以前使用过 Java ServerFaces 2。对于这些技术，线程/范围很重要，并且在任何语言中，文件访问时间都至关重要。我在这里错过了什么吗？

# html - 重定向 302 在 htaccess 文件中不起作用

> ID：16123291
> 
> 赞同：0
> 
> 时间：2013-04-20T17:38:16.923
> 
> 标签：html, .htaccess

我正在做我认为是一项简单的任务。使用 .htaccess 文件我想从一个页面重定向到另一个页面。

这是我的重定向声明：

```
Redirect 302 /myfavoritebook https://play.google.com/store/books/... 
```

当我输入路径时：

```
www.mywebsite.com/myfavoritebook 
```

它会将我带到我创建的自定义 404 缺失页面。它不会将我重定向到新网站。

关于为什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:48:44.293

> [mod_alias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html)旨在处理简单的 URL 操作任务。对于操作查询字符串等更复杂的任务，请使用 mod_rewrite 提供的工具。

您可以尝试`mod_rewrite`改用：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteRule ^myfavoritebook/?  https://play.google.com/store/books/details/Orson_Scott_Card_Ender_s_Game?id=Ojqi8KbWuLwC&feature=search_result#?t=W251bGwsMSwyLDEsImJvb2stT2pxaThLYld1THdDIl0  [R=302,NC,L] 
```

# html - Rails 国际化，html 标签

> ID：16123292
> 
> 赞同：0
> 
> 时间：2013-04-20T17:38:25.467
> 
> 标签：html, ruby-on-rails, internationalization, rails-i18n

我在我的 Rails 3.2 应用程序中正确加载了 html 标签时遇到了一些问题，但不知道为什么。我设法让它为一条闪光消息工作，但我没有设法通过确认消息来做到这一点。

有任何想法吗 ？

我的 pt.yml 文件提取：

```
 buttons:
    accept_terms: "Aceito os termos e condições"
    save: "Gravar"
    delete: "Apagar"
    add_new_receipt: "+"
    add_receipt_label: "Clique para adicionar novo recibo"
    download_all_html: "Tem a certeza que deseja descarregar todos os ficheiros correspondentes à pesquisa? <br />
    Esta operação pode demorar algum tempo, dependendo do número de ficheiros e da sua ligação à Internet " 
```

我的视图代码：

```
<%= link_to (t :download_all, scope: "pages.home.customers"), user_download_all_path(user_id:current_user.id, is_retailer: params[:controller]=='suppliers' ? true : false), method: :post, class: "btn btn-primary", confirm: t(:download_all_html, scope: "buttons") %> 
```

最后，我的确认消息显示`<br />`原样....

我相信我在这里遵循 rails[指南](http://guides.rubyonrails.org/i18n.html#using-safe-html-translations)，所以任何帮助都将不胜感激。

**编辑**

我已经尝试过 html_safe。

我还有另一个正在运行的示例：

```
tags:
      error_message_html: "O número %{message} ou não existe ou já foi mapeado.<br />
      Por favor verifique que o número corresponde à empresa seleccionada " 
```

我在控制器中调用它：

```
flash[:error] = t :error_message_html, scope: "forms.tags", message: params[:tag][:number] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:20:34.517

Rails 将转义包含在翻译中的 html

您可以允许 html 与`html_safe`

```
<%= link_to (t :download_all, scope: "pages.home.customers").html_safe, user_download_all_path(user_id:current_user.id, is_retailer: params[:controller]=='suppliers' ? true : false), method: :post, class: "btn btn-primary", confirm: t(:download_all_html, scope: "buttons") %> 
```

# jquery - 谷歌地图只显示部分

> ID：16123296
> 
> 赞同：0
> 
> 时间：2013-04-20T17:38:44.670
> 
> 标签：jquery, css, google-maps, google-maps-api-3

您好，我有这个问题，当我加载一个带有隐藏 div 中的地图的页面时，地图只加载了一部分，地图的左上角 1/4，但是当它与容器一起加载时地图渲染得很好隐。

我准备了这个 jsFiddle 示例页面：

[http://jsfiddle.net/Z5AGP/2/](http://jsfiddle.net/Z5AGP/2/)

```
$("#toggleAdvanced").click(function(){
    $("#advancedSearch").slideToggle( "fast", function() {
        google.maps.event.trigger(map, 'resize');
    });
}); 
```

如果你尝试，点击“点击”文本，你会看到地图只是部分加载，如何尝试从 #map_wrapper { display: none; 更改 CSS } 到 #map_wrapper { 显示：块；和地图点击隐藏和显示按钮完美。

正如你所看到的，我在幻灯片效果之后触发了 google.maps.event.trigger(map, 'resize') 事件，所以它应该可以工作......（如我发现的其他问题中所述）

怎么了？或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:53:01.280

您在未显示的 div 上过早调用初始化函数，这意味着当 div 被 jquery 显示时，此过程和地图存在冲突。

看看这里的小提琴。[http://jsfiddle.net/Z5AGP/2/](http://jsfiddle.net/Z5AGP/2/)

```
$(document).ready(function() {

        $("#toggleMap").click(function(){
            $("#map_wrapper").slideToggle( "fast", function() {
                initialize();
                google.maps.event.trigger(map, 'resize');
            });
        });
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-27T20:03:57.187

谢谢丹尼尔乔丹，我是对的，在每个 div 显示/隐藏之后，所有添加的东西都被重置了，为了解决这个问题，我添加了一个变量来检查地图是否已经初始化，现在一切都是正确的。

```
var mapInit = 0;
$(document).ready(function() {
    $("#toggleMap").click(function(){
        $("#map_wrapper").slideToggle( "fast", function() {
            if(mapInit == 0) { initialize(); mapInit = 1; }
            google.maps.event.trigger(map, 'resize');
        });
    });
}); 
```

这就是这个主题的解决方案

如果地图已经初始化（如开始），为什么调用事件调整大小不起作用？（这似乎是一个错误，像这样的许多其他问题都提到了也调用了该事件并且没有发生任何事情。

问候

# string - BASH 按最后一个“字段”排序字符串（在“/”符号之后）

> ID：16123297
> 
> 赞同：3
> 
> 时间：2013-04-20T17:38:47.357
> 
> 标签：string, bash

我正在寻找一种按最后一个“字段”按字母顺序对行进行排序的方法。所以：

如果我的输出是（可能通过 grep 命令）：

```
mike/downloads.png
mike/public/system.png
mike/root/alphabet.png 
```

结果应该是：

```
root/alphabet.png
downloads.png
public/system.png 
```

因为 "alphabet" 、 "downloads" 和 "system" 是按字母顺序排列的。

我应该先用“ cut -f2 -d”/“| sort”对它们进行剪切和排序吗？然后合并路径的其余部分？

还是有更简单的方法？

任何帮助将不胜感激。

谢谢

（示例修改）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T17:42:54.810

Sort 有一个`-t`参数来指定字段分隔符，并`-k`指定要排序的字段，以便您可以编写：

```
sort -t/ -k 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T12:27:28.267

谢谢你们！我终于找到了我想要的东西

第一的

```
awk -F'/' '{print $NF,$0}' 
```

然后

```
sort 
```

最后

```
sed -n 's/[^/]*\///p' 
```

输出将是

```
folder/file.png
file.png
folder/folder2/file.png 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T22:25:56.137

由于字段的数量是动态的，您可以在排序之前将最后一个字段附加到行首并在之后将其删除：

```
$ awk -F'/' '{print $NF,$0}' file | sort | awk '{print $2}'
mike/root/alphabet.png
mike/downloads.png
mike/public/system.png 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:45:41.130

这指定了具有字段分隔符的第三个字段`/`

```
sort -t'/' -k 3 
```

# c# - 如何在代码中以编程方式动态更新列表框中的网格（C# 和 WPF）

> ID：16123302
> 
> 赞同：2
> 
> 时间：2013-04-20T17:39:56.680
> 
> 标签：c#, wpf, listbox, grid, dynamically-generated

我有一个 ListBox，其中的每个项目都有一个 DataTemplate 来定义其结构。它最初有一个包含 6 行和 4 列的 Grid。但是在运行时，我想在那个 DataTemplate 中的那个 Grid 中添加更多的行和列到一个特定的 ListBoxItem。我怎么做？我是否需要创建一个包含添加了行和列的 Grid 的新 DataTemplate？我已经看到了很多看起来像我想要实现的示例，现在这些示例与所有 Bindings、ObservableCollections、ViewModel 等混淆了。我应该怎么办？以下是该特定 ListBox 的 WPF 代码：

```
 <ListBox Margin="0,138,28.58,156" Name="list" HorizontalAlignment="Right" Width="387.235" SelectionChanged="list_SelectionChanged">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                </Grid>

            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:57:46.850

实际上还有另一个操作问类似的问题。你可以看看他的问题。他的问题实际上就是你的答案。

他使用了一个从 Grid 派生的自定义控件，他称之为 Board。此外，他在运行时添加了行和列，这似乎正是您想要实现的。

这是链接： [Board 类中的 wpf MouseMove-Event 不起作用](https://stackoverflow.com/questions/16122896/wpf-mousemove-event-in-board-class-does-not-work)

# javascript - Javascript：计算 OpenSubtitles 哈希 - 得到错误的结果

> ID：16123304
> 
> 赞同：2
> 
> 时间：2013-04-20T17:39:57.313
> 
> 标签：javascript, hash

我正在尝试为 Javascript 中的文件计算正确的 OpenSubtitles 哈希码，但对于大文件，它无法正常工作 - 所以我认为文件大小存在问题（溢出）。此处描述了带有源代码的 OpenSubtitles 哈希：http: [//trac.opensubtitles.org/projects/opensubtitles/wiki/HashSourceCodes](http://trac.opensubtitles.org/projects/opensubtitles/wiki/HashSourceCodes)

我正在使用虚拟 RAR 文件（未打包）测试此代码 - [http://www.opensubtitles.org/addons/avi/dummy.rar](http://www.opensubtitles.org/addons/avi/dummy.rar)，正确结果是**61f7751fc2a72bfb**但此代码给出**61f7751ec2a72bfb** - 所以有一些错误。我不擅长 Javascript。我还发现其他人也遇到了类似的问题： http: [//forum.opensubtitles.org/viewtopic.php?f](http://forum.opensubtitles.org/viewtopic.php?f=8&t=13243) =8&t=13243也许这可行：[https ://github.com/ka2er/node-opensubtitles-api/blob/主/lib/opensubtitles.js](https://github.com/ka2er/node-opensubtitles-api/blob/master/lib/opensubtitles.js)

问题是，需要改变什么，所以我得到正确的哈希？谢谢。

```
function binl2hex(a)
{
    var b = 255;
    a[1] += a[0] >> 8;
    a[0] = a[0] & b;
    a[2] += a[1] >> 8;
    a[1] = a[1] & b;
    a[3] += a[2] >> 8;
    a[2] = a[2] & b;
    a[4] += a[3] >> 8;
    a[3] = a[3] & b;
    a[5] += a[4] >> 8;
    a[4] = a[4] & b;
    a[6] += a[5] >> 8;
    a[5] = a[5] & b;
    a[7] += a[6] >> 8;
    a[6] = a[6] & b;
    a[7] = a[7] & b;
    for (var d = "0123456789abcdef", e = "", c = 7; c > -1; c--) 
        e += d.charAt(a[c] >> 4 & 15) + d.charAt(a[c] & 15);
    return e
}

$(document).ready(function() 
{
    jQuery.event.props.push('dataTransfer');
    $('#search_field').bind('drop', function(e) 
    {
        var files = e.dataTransfer.files;
        $.each(files, function(index, file) 
        {
            if(files.length > 1) 
            {
                $('#top_msg').attr('class', 'msg warn');
                $('#top_msg').html('multiple files are <b>not supported</b> (yet)');   
                return false;
            }        

            if (!files[index].type.match('video.*') && !files[index].name.match(/\.(mkv)$/i)) 
            { 
                //|| !files[index].name.match('/mkv/i')
                $('#top_msg').attr('class', 'msg warn');            
                $('#top_msg').html('search works only for <b>video</b> files.');
                return false;
            }    

            $('#top_msg').html('<b>File upload and hashing in progress</b>...');
            $('#top_msg').attr('class', 'msg indicator');

            var b = 65536;        
            fs = file.size;
            var e = Array(8);
            for (var a = fs, f = 0; f < 8; f++) 
            {
                e[f] = a & 255;
                a = a >> 8
            }
            a = fs;    

            var c = file.slice(0, b);
            var g = new FileReader;   

            g.onloadend = function (h) 
            {
                if (h.target.readyState == FileReader.DONE) 
                {
                    for (var f = h.target.result, d = 0; d < f.length; d++) 
                        e[(d + 8) % 8] += f.charCodeAt(d);
                    c = file.slice(a - b);
                    var g = new FileReader;   

                    g.onloadend = function (c) 
                    {
                        var b = "languages";
                        if (c.target.readyState == FileReader.DONE) 
                        {
                            f = c.target.result;
                            for (d = 0; d < f.length; d++) 
                                e[(d + 8) % 8] += f.charCodeAt(d);  
                            lang = $("#SubLanguageID").multiselect("getChecked").map(function()
                            {
                                return this.value
                            }).get().join(",");
                            if (lang == "") 
                                lang = "all";
                            var url = "http://www.opensubtitles.org/" + $(location).attr('pathname').substr(1,2) + "/search/sublanguageid-" + lang + "/moviehash-" + binl2hex(e);
                            document.location = url;
                        }
                    };

                    g.readAsBinaryString(c)
                }
            };
            g.readAsBinaryString(c)
        });
    });
}); 
```

# nhibernate - 在 nhibernate 中将结构映射为 Id

> ID：16123306
> 
> 赞同：1
> 
> 时间：2013-04-20T17:40:06.267
> 
> 标签：nhibernate, struct, mapping

我有以下结构和类：

```
public struct DepartmentId{
    public int Value {get; set;}
}

public class Department{
    public virtual DepartmentId Id{get;set;}

    public virtual string Name {get; set;}
} 
```

我为部门创建了一个映射文件，如下所示：

```
public class DepartmentMapping : ClassMapping<Department>{
    public DepartmentMapping{
        Table("Department");

        Id(dept => dept.Id, mapper => {
            mapper.Column("Id");
            mapper.Type(new DepartmentIdType());
        });

        Property(dept => dept.Name, mapper => mapper.Column("Name"));
    }
} 
```

其中 DepartmentIdType 实现 IIdentifierType：

```
class DepartmentIdType : PrimitiveType, IIdentifierType
{
    public DepartmentIdType() : base(SqlTypeFactory.Int32)
    {
    }

    public override object DeepCopy(object val, EntityMode entityMode, ISessionFactoryImplementor factory)
    {
        return val;
    }

    public override object Replace(object original, object current, ISessionImplementor session, object owner, IDictionary copiedAlready)
    {
        return original;
    }

    public override Type ReturnedClass
    {
        get { return typeof(DepartmentId); }
    }

    public object StringToObject(string xml)
    {
        return new DepartmentId {Value = int.Parse(xml)};
    }

    public override string Name
    {
        get { return typeof(DepartmentId).Name; }
    }

    public override void Set(IDbCommand cmd, object value, int index)
    {
        var id = (DepartmentId) value;
        ((IDataParameter) cmd.Parameters[index]).Value = id.Value;
    }

    public override object Get(IDataReader rs, int index)
    {
        int value = rs.GetInt32(index);

        return new DepartmentId {Value = value};
    }

    public override object Get(IDataReader rs, string name)
    {
        return Get(rs, rs.GetOrdinal(name));
    }

    public override string ToString(object val)
    {
        if (val == null) return "";
        return val.ToString();

    }

    public override object FromStringValue(string xml)
    {
        return new DepartmentId {Value = Int32.Parse(xml)};
    }

    public override object DefaultValue
    {
        get { return new DepartmentId {Value = 0}; }
    }

    public override string ObjectToSQLString(object value, NHibernate.Dialect.Dialect dialect)
    {
        return value.ToString();
    }

    public override Type PrimitiveClass
    {
        get { return typeof(DepartmentId); }
    }
} 
```

但是，在创建 HbmMapping 时，我收到以下错误：

```
Could not compile the mapping document: mapping_by_code

NHibernate.MappingException: Could not compile the mapping document: 
mapping_by_code ---> NHibernate.MappingException: 
Could not determine type for: Demo.Models.DepartmentId,     Demo.Models, 
for columns: NHibernate.Mapping.Column(Id)
at NHibernate.Mapping.SimpleValue.get_Type()
at NHibernate.Cfg.XmlHbmBinding.ClassIdBinder.CreateIdentifierProperty(HbmId idSchema, PersistentClass rootClass, SimpleValue id)
at NHibernate.Cfg.XmlHbmBinding.ClassIdBinder.BindId(HbmId idSchema, PersistentClass rootClass, Table table)
at NHibernate.Cfg.XmlHbmBinding.RootClassBinder.Bind(HbmClass classSchema, IDictionary`2 inheritedMetas)
at NHibernate.Cfg.XmlHbmBinding.MappingRootBinder.AddRootClasses(HbmClass rootClass, IDictionary`2 inheritedMetas)
at NHibernate.Cfg.XmlHbmBinding.MappingRootBinder.AddEntitiesMappings(HbmMapping mappingSchema, IDictionary`2 inheritedMetas)
at NHibernate.Cfg.XmlHbmBinding.MappingRootBinder.Bind(HbmMapping mappingSchema)
at NHibernate.Cfg.Configuration.AddDeserializedMapping(HbmMapping mappingDocument, String documentFileName) 
```

如何解决此问题（无需将 DepartmentId 从 struct 更改为 class）？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-10T11:04:28.317

对于这种情况，我建议使用**class**而不是 struct 和**ComponentAsId**而不是 Id 方法。如果您不使用 id 生成器，这是一种无需任何黑客攻击的简单方法。

```
public class DepartmentMapping : ClassMapping<Department> {
public DepartmentMapping{
    Table("Department");
    ComponentAsId(dept => dept.Id);
    Property(dept => dept.Name, mapper => mapper.Column("Name"));
}}

public class DepartmentIdMapping : ComponentMapping<DepartmentId> {
public DepartmentIdMapping{
    Property(x=> x.Value, mapper => mapper.Column("Id"));
}} 
```

在调查这种强类型的 id 和 id 生成时，我尝试了你的方法，但我最终决定实现自定义 Hi/Lo 生成器并使用 NHibernate 分配的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-13T18:13:35.027

我只是把这个放在这里作为参考。在 XML 映射中，我通过映射为复合 id 来做到这一点：

```
<class name"Department" ... >
    <composite-id name="Id" access="property"
                  class="DepartmentId">
        <key-property name="Value"
                      column="Id"
                      access="property"
                      type="System.Int32"/>
    </composite-id>
    ... other stuff
</class> 
```

# mongodb - AppFog MongoDb 服务术语

> ID：16123308
> 
> 赞同：1
> 
> 时间：2013-04-20T17:40:17.423
> 
> 标签：mongodb, appfog

就 MongoDb 术语而言，什么是

1.  绑定服务
2.  服务

在 AppFog MongoDb 服务中？

绑定服务是数据库名称吗？或者它是集合名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:02:39.767

服务是指软件（例如 MongoDB）的运行实例。它在那里并且正在运行，但与任何客户端进程无关。当您的 PAAS 提供商管理它时，您不知道它需要什么端点或凭据。

绑定服务意味着使用适当的凭据将服务的端点暴露给您的应用程序。例如：

```
if(process.env.VCAP_SERVICES){
  var env = JSON.parse(process.env.VCAP_SERVICES);
  var mongo = env['mongodb-1.8'][0]['credentials'];
} 
```

这里App进程的环境变量`VCAP_SERVICES`保存了已经绑定到这个App进程的那些服务的连接数据。连接数据由 PAAS 提供商自动为您配置，这里的`mongo`对象已经有了，您不需要记住该服务的 URL、帖子、用户名、密码等。

因此，绑定到您的应用程序的服务可以通过环境变量随时为您提供连接数据。

[在此处](https://docs.appfog.com/services/mongodb)参考 Appfog 的服务文档。

# java - 将新对象放入 HashMap 时陷入无限循环

> ID：16123311
> 
> 赞同：-3
> 
> 时间：2013-04-20T17:40:35.420
> 
> 标签：java, hashmap

我写了一些代码，它在 for 循环中逐行读取文本文件；每一行都是用于在 JPanel 上绘制新形状的命令。我有一个 HashMap 用于存储名称和形状。

```
Map<String, GeoShape> geoObj = new HashMap<String, GeoShape>(); 
```

示例输入是这样的：ADD P1 Point Blue 50 50 10

cmd 是一个 String[] ，它包含拆分的输入命令。问题就在这里：

```
if (cmd[2].equalsIgnoreCase("Point")) 
    geoObj.put(cmd[1], new Point(cmd, graph)); 
```

它陷入无限循环。我在调试模式下运行代码，点类没有问题。

任何帮助是极大的赞赏！

编辑：这是类点

```
public class Point extends Segment {
    private Line2D point;
    private Stroke thickness;
    private Color fColor;
    private double x;
    private double y;

    public Point(String[] cmd, Graphics2D graph) {
        System.out.println("point");
        x = Double.parseDouble(cmd[4]);
        y = Double.parseDouble(cmd[5]);
        try {
            fColor = setColor(cmd[3]);
        } catch (Exception e) {
            e.printStackTrace();
        }
        thickness = new BasicStroke(Integer.parseInt(cmd[6]));

        paint(graph);
    }

    @Override
    public void paint(Graphics2D graph) {
        point = new Line2D.Double(x, y, x, y);

        graph.setStroke(thickness);
        graph.setColor(fColor);
        graph.draw(point);
    }
} 
```

for循环：

```
FileReader fr = new FileReader(file);
BufferedReader br = new BufferedReader(fr);

int linesNum = Integer.parseInt(br.readLine());
String line = br.readLine();
for (int i = 1; i <= linesNum; i++) {
     while (line != null) {
        cmd = line.split(" ");
        if (cmd[0].equalsIgnoreCase("ADD")) {
        if (cmd[2].equalsIgnoreCase("Point")) 
        geoObj.put(cmd[1], new Point(cmd, graph));
            // some else if with the same structure for other shapes
//at the end of for loop I have this:  line = br.readLine(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:44:26.610

您是说一次调用会`put`导致无限循环吗？

这在理论上是可能的，但只有在`HashMap`没有适当同步的情况下由另一个线程更新。（您需要对该`HashMap`类进行详细分析以确定这是否真的可能/可能，但如果两个线程在`HashMap`没有适当同步的情况下同时读取和写入，则哈希链可能会损坏，导致无限循环该`get`调用尝试搜索损坏的链。）

如果这不是问题，那么问题出在您没有向我们展示的代码中。

# redactor - 如何将自定义格式添加到 Redactor

> ID：16123312
> 
> 赞同：0
> 
> 时间：2013-04-20T17:40:39.933
> 
> 标签：redactor

我想知道是否可以向编辑器添加自定义格式？我创建了一个自定义按钮，并且能够更改文本的格式，但只能使用某些元素：

['p', 'blockquote', 'pre', 'h3', 'h4', 'h5']

但是，我无法添加以下任何内容：

['小'，'figcaption']

我按照 Redactor 文档设置了按钮，这是我正在调用的函数：

```
 var selected_html = $('#redactor_content').getSelected();
  $('#redactor_content').execCommand('formatblock', '<small>'); 
```

我还尝试将元素添加到我的“formattingTags”数组中，但似乎没有任何影响。

格式化标签：['p'，'blockquote'，'small'，'pre'，'h3'，'h4']

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T19:58:08.433

我想我想通了。

我在按钮功能中添加了以下内容：

```
var $selected_html = $('#redactor_content').getSelected();
$('#redactor_content').execCommand('inserthtml', '<small>' + $selected_html + '</small>'); 
```

但是，这并不完美，因为它不会替换父标签，并且您可以继续在元素中添加元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T01:23:06.370

像这样的东西：

```
redactorOptionsDefaults = {
    buttonsAdd: {},
    activeButtonsAdd: {},
    buttonsCustom: {}
};

redactorOptionsDefaults.buttonsCustom.small = {
    title: 'small Header',
    callback: function () {
        this.formatBlocks('small');
    }
}
redactorOptionsDefaults.activeButtonsAdd.small = 'small'; 
```

它格式化块，如果需要，在选择块时突出显示按钮。但是不要在重复按钮单击时删除样式

# c# - 将某些泛型类型的类属性转换为泛型类型以执行方法

> ID：16123313
> 
> 赞同：0
> 
> 时间：2013-04-20T17:40:39.503
> 
> 标签：c#, .net, generics, reflection, comparison

首先，我想为混乱的标题道歉。我不太清楚如何用语言表达，所以我将描述这种情况。

我正在为我们的产品编写一个比较引擎，它能够像这样比较不同的产品：

```
public abstract class ComparableProduct
{
    public ComparableProperty<decimal> Weight { get; set; }
    public ComparableProperty<decimal> Width { get; set; }
    public ComparableProperty<decimal> Height { get; set; }
    public ComparableProperty<decimal> Depth { get; set; }
    public bool IsBetterThan(ComparableProduct target){}
} 
```

实际产品派生自 ComparableProduct，如 Screen : ComparableProduct，增加了属性

```
ComparableProperty<decimal> Dimension { get; set; } 
```

这意味着我可以拥有一个具有属性键盘、屏幕、存储设备...等的笔记本电脑类，它们都派生自 ComparableProduct。

它们又具有类似的属性，如下所示：

```
public abstract class ComparableProperty<T> where T : IComparable<T>
{
    T Value { get; set; }
    public ComparisonType ComparisonType { get; set; }
    public bool IsBetterThan(T target)
    {
        if(ComparisonType == ComparisonType.GreaterThan)
            return Value.CompareTo(target) >= 0;
        return Value.CompareTo(target) <= 0;
    }

    public bool IsBetterThan(IEnumerable<T> targets)
    {
        foreach(var target in targets)
        {
            if (ComparisonType == ComparisonType.SmallerThan && Value.CompareTo(target) >= 0)
                return false;
            if (ComparisonType == ComparisonType.GreaterThan && Value.CompareTo(target) <= 0)
                return false;
        }
        return true;
    }

} 
```

我还没有测试过这些，按照所有逻辑它们应该可以工作。我遇到的麻烦......是 ComparableProduct 中的 IsBetterThan 方法。预期的功能是，在顶级类（例如笔记本电脑）上，循环通过其 ComparableProduct 属性并为另一个副本调用 IsBetterThan，这些将循环通过它们的子属性......此外，所有 ComparableProduct ComparableProperty 属性都使用 IsBetterThan 检查与其他类的等效值。

无论如何，这就是我所拥有的，您可以立即看到我遇到的问题。

```
public bool IsBetterThan(ComparableProduct target)
    {
        foreach(var property in GetType().GetProperties().Where(x => x.PropertyType == typeof(ComparableProduct)))
        {
            var compareTo = target.GetType().GetProperty(property.Name).GetValue(target, null) as ComparableProduct;
            var local = property.GetValue(this, null) as ComparableProduct;
            if(local != null && !local.IsBetterThan(compareTo))
                return false;
        }
        foreach(var property in GetType().GetProperties().Where(x => x.PropertyType == typeof(ComparableProperty<>)))
        {
            var compareTo = target.GetType().GetProperty(property.Name).GetValue(target, null) as ComparableProperty<>;
            var local = property.GetValue(this, null) as ComparableProperty<>;
            if(local != null && !local.IsBetterThan(compareTo))
                return false;
        }
    } 
```

如您所见，我试图将其转换为 ComparableProperty<>，这意味着它缺少泛型类型。但是，我不太确定如何获得所涉及属性的泛型。

另外，如果有更好的方法......我会尽我所能，但这是我想到的前半部分体面的方法。

**编辑：**

说得太早了。当我尝试像这样枚举 ComparableProduct 的 IsBetterThan 中的属性时：

```
foreach(var property in GetType().GetProperties())
        {
            var t = property.GetType().GetInterfaces();
            if (!property.GetType().GetInterfaces().Contains(typeof(IComparableProperty))) continue;

            var compareTo = target.GetType().GetProperty(property.Name).GetValue(target, null) as IComparableProperty;
            var local = property.GetValue(this, null) as IComparableProperty;
            if (local == null) continue;
            if(!local.IsBetterThan(compareTo))
                return false;
        } 
```

然后它似乎在接口中找不到 IComparableProperty。我已经浏览了可能包含它的主要方法......但它包含的唯一接口是 ICustomAttributeProvider、_MemberInfo、_PropertyInfo 和 ISerializable。

**编辑2：**

我已经通过回退字符串比较解决了这个问题

```
if (property.PropertyType.Name != "ComparableProperty`1") continue; 
```

在将 T 更改为 ComparableProperty 并将 IEnumerable 更改为 IEnumerable> 之后，整个比较工作完美。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:53:10.347

您可以创建一个非通用接口，然后使用它：

```
 public interface IComparableProperty
    {
        bool IsBetterThan(object target);

        bool IsBetterThan(IEnumerable targets);
    }

    public abstract class ComparableProperty<T>: IComparableProperty where T : IComparable<T>
    {
        T Value { get; set; }
        public ComparisonType ComparisonType { get; set; }
        public bool IsBetterThan(T target)
        {
            if (ComparisonType == ComparisonType.GreaterThan)
                return Value.CompareTo(target) >= 0;
            return Value.CompareTo(target) <= 0;
        }

        public bool IsBetterThan(IEnumerable<T> targets)
        {
            foreach (var target in targets)
            {
                if (ComparisonType == ComparisonType.SmallerThan && Value.CompareTo(target) >= 0)
                    return false;
                if (ComparisonType == ComparisonType.GreaterThan && Value.CompareTo(target) <= 0)
                    return false;
            }
            return true;
        }

        bool IComparableProperty.IsBetterThan(object target)
        {
            return IsBetterThan((T) target);
        }

        bool IComparableProperty.IsBetterThan(IEnumerable targets)
        {
            return IsBetterThan((IEnumerable<T>) (targets));
        }
    } 
```

**编辑0：**

您是否尝试过像这样使用此方法*Type.IsAssignableFrom(Type)*：

```
foreach (var property in GetType().GetProperties())
        {
            if (!typeof(IComparableProperty).IsAssignableFrom(property.PropertyType)) continue;

            var compareTo = target.GetType().GetProperty(property.Name).GetValue(target, null) as IComparableProperty;
            var local = property.GetValue(this, null) as IComparableProperty;
            if (local == null) continue;
            return local.IsBetterThan(compareTo);
        } 
```

# python - 你可以在 Pyramid 的 MAKO 文件中设置会话变量吗？

> ID：16123317
> 
> 赞同：0
> 
> 时间：2013-04-20T17:41:07.700
> 
> 标签：python, pyramid, mako

所以我找到了关于在金字塔视图文件中设置会话变量的答案，然后在 mako 模板中访问它。（[如何访问 Mako 模板和 Pyramid 中的会话变量？](https://stackoverflow.com/questions/13243500/how-to-access-session-variable-in-mako-template-and-pyramid)）

我想知道你是否可以反过来做。所以而不是：

金字塔视图.py

```
def thisView(request):
    session = request.session
    session['selectedclientid'] = 'test' #selectedclient.id
    session.save() 
```

网页.mako

```
${request.session['selectedclientid']} 
```

我可以交换它以便我可以这样做吗？

网页.mako

```
${request.session['selectedclientid'] = '5'} 
```

金字塔视图.py

```
def thisView(request):
    someLogicOn(session['selectedclientid']) 
```

到目前为止，我一直未能成功实现它，我不确定这是否只是由于缺乏了解如何做到这一点，或者它是否是无法完成的事情。任何建议都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:08:30.730

在典型的渲染工作流程中，视图在渲染器*之前*执行。目前尚不清楚您打算如何纠正这一点。我猜，如果你`render`在视图中称呼自己，这是可能的，所以我会展示这一点。

网页.mako：

```
<%
request.session['selectedClientId'] = '5'
%> 
```

代码：

```
def thisView(request):
    response = render_to_response('webpage.mako', {}, request=request)
    someLogicOn(request.session['selectedClientId'])
    return response 
```

虽然这在逻辑上有点落后，所以你可能要三思而后行。

# php - php login 登录时隐藏，未登录时隐藏注销

> ID：16123320
> 
> 赞同：1
> 
> 时间：2013-04-20T17:41:25.890
> 
> 标签：php, login

我想要一个代码在登录时隐藏登录按钮并显示“欢迎，用户名”和注销按钮，当未登录时显示登录按钮... [http://needforgaming.x10.mx/testefinal/home.html](http://needforgaming.x10.mx/testefinal/home.html)这是我的网站，如果我在其中放置错误的代码或代码，您可以看到它的外观

```
<?php 
             session_start();
            if(isset($_SESSION['username'])){ ?>
    <p>Ola; <u><?php echo $_SESSION['username']; ?></u>, </p>
    <p><a href="logout.php">Logout</a></p>
<?php } else{ ?>
    <p><a href="#login-box" class="login-window">Login</a></p>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-17T17:07:32.003

还有另一种简单的方法。您可以先开始会话。然后使用此代码：

```
<?php
    if(!isset($_SESSION['user']))
    {
        echo '<li><a href="login.php">Login</a></li>';
    }
    else
    {
        echo '<li><a href="logout.php">Logout</a></li>';
    }
?> 
```

实际上，此代码用于在 . 您可以在任何需要的地方使用它。只需更改html标签。而已

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:46:39.510

我认为您使用的是**普通** `html`的 .. 您的页面需要`php`在 apache/IIS 服务器上运行此代码，代码足以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:45:23.287

您可能需要检查是否为空。改变：

```
if(isset($_SESSION['username'])){ ?> 
```

至

```
if(isset($_SESSION['username']) && !empty($_SESSION['username'])){ ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T17:46:41.727

您已将 PHP 代码放入`.html`页面。将其切换为`.php`，或将您的服务器配置为也评估`.html`为 PHP。

看看[您的第一个启用 PHP 的页面](http://www.php.net/manual/en/tutorial.firstpage.php)，它应该提供足够的详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T17:47:10.493

你应该把所有的块都变成一个 php 代码：

```
<?php 
     session_start();
     if(isset($_SESSION['username'])){
     echo "<p>Ola; <u> $_SESSION['username']; </u>, </p>";
     echo "<p><a href=\"logout.php\">Logout</a></p>";
     } else{
      echo" <p><a href=\"#login-box\" class=\"login-window\">Login</a></p>";
     } 
```

?>

# javascript - Javascript：获取本地服务器端文件的内容

> ID：16123323
> 
> 赞同：-1
> 
> 时间：2013-04-20T17:41:49.720
> 
> 标签：javascript, jquery, get, server-side

我的网络服务器上有一个文件（test.txt），我需要获取它的内容，然后将其分配给一个变量以进行进一步操作并最终输出到页面，这应该每隔一秒左右发生一次（因此为什么PHP 不是一个真正的选择）。

我尝试过使用 jQuery get、XMLHttpRequest 和 Ajax - 都没有运气。如果有人可以建议我如何解决我的问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:43:57.917

您可以通过这种方式在 var 中加载文件内容 -

```
var txt ="";

$.get('test.txt', function (data) {
    txt = data;
}); 
```

每隔一秒左右加载一次，

```
setInterval(function(){
   $.get('test.txt', function (data) {
      txt = data;
   });
},1000) 
```

# iphone - 使用 flash builder / flex 播放 ios 视频

> ID：16123326
> 
> 赞同：1
> 
> 时间：2013-04-20T17:42:14.300
> 
> 标签：iphone, ios, actionscript-3, apache-flex, flash-builder

您好我正在尝试创建一个从远程服务器（自动创建视频文件）流式传输视频的 iphone 应用程序，我使用的是 flash builder 4.7，mobile flex。

我在 fb / flex 方面的专业知识不是很好，但我已经做到了。

使用 StageWebView 我取得了一些进展，可以流式传输一个简单的 mp4 文件，但是我想要流式传输的文件的扩展名错误，因此 iphone 的内部视频播放器无法播放它们。我无法控制远程服务器，因此无法更改 mime 类型或文件扩展名。这些文件是合法的 mp4 文件，如果我复制一个并更改扩展名，它们就可以正常工作。

有人知道我如何欺骗 ios 视频播放器播放它们吗？

感谢任何帮助，感谢我已经为此工作了数周，它使我转弯

干杯托比

# c++ - 在 SDL 中管理输入？

> ID：16123332
> 
> 赞同：2
> 
> 时间：2013-04-20T17:42:28.043
> 
> 标签：c++, input, sdl, frame-rate, pong

我正在使用 SDL 在 C++ 中创建一个 pong 克隆。桨已准备好并根据用户输入移动。让我担心的是输入很奇怪，我预计两个桨叶都能平稳移动，但是当另一个桨叶移动时一个桨叶会滞后，而当另一个桨叶不动时会加速。我怀疑这是由于没有限制 FPS 还是由于我设法获得多个输入或两者兼而有之的奇怪方式。谁能告诉我我的代码有什么问题以及如何改进它？

我的代码：

```
#include <SDL/SDL.h>
#include <string>
#include "SDL/SDL_image.h"
#include <SDL/SDL_ttf.h>

bool quit = false;
bool keyheld[323]={false};
const int SCREEN_WIDTH = 800;
const int SCREEN_HEIGHT = 600;
const int SCREEN_BPP = 32;
int paddle1x = 0;
int paddle1y = 50;
int paddle2x = 600;
int paddle2y = 500;

SDL_Color color = {255,255,255};
SDL_Event event;
SDL_Surface* screen = NULL;
SDL_Surface* timer = NULL;
SDL_Surface* background = NULL;
SDL_Surface* paddle1 =NULL;
SDL_Surface* paddle2 = NULL;

void apply_surface(int x, int y, SDL_Surface* source, SDL_Surface* destination)
{
    SDL_Rect offset;
    offset.x = x;
    offset.y = y;
    SDL_BlitSurface(source, NULL,destination, &offset);
}

 SDL_Surface *load_image(std::string filename)
    {
        SDL_Surface* loadedimage = NULL;
        SDL_Surface* optimisedimage = NULL;

        loadedimage= IMG_Load(filename.c_str());
        optimisedimage= SDL_DisplayFormatAlpha(loadedimage);
        SDL_FreeSurface(loadedimage);

        return optimisedimage;
    }

int main(int argc, char *args[])
{
    bool quit = false;
    bool keyheld[323]={false};
    int p1score=0;
    int p2score=0;

    SDL_Init(SDL_INIT_EVERYTHING);
    TTF_Init();
    TTF_Font *font=NULL;

    screen = SDL_SetVideoMode(SCREEN_WIDTH,SCREEN_HEIGHT,SCREEN_BPP,SDL_SWSURFACE);

    background = load_image("background.png");
    apply_surface(0,0,background,screen);

    paddle1 = load_image("paddle1.png");
    apply_surface(paddle1x,paddle1y,paddle1,screen);

    paddle2=load_image("paddle2.png");
    apply_surface(paddle2x,paddle2y,paddle2,screen);

    font = TTF_OpenFont("kremlin.ttf", 22);

    timer = TTF_RenderText_Solid(font,"Test!",color);
    apply_surface(0,0,timer,screen);

    SDL_WM_SetCaption("PONG!",NULL);
    SDL_Flip(screen);
    while(quit==false)
    {
            if(SDL_PollEvent(&event))
            {
                SDLKey keyPressed = event.key.keysym.sym;
                if(event.type==SDL_QUIT)
                {
                    return 0;
                }
                else if(event.type==SDL_KEYDOWN)
                {
                    keyheld[keyPressed] = true;
                }
                else if(event.type==SDL_KEYUP)
                {
                    keyheld[keyPressed] = false;
                }

            }
            if(keyheld[SDLK_LEFT])
            {
                paddle1x--;
                apply_surface(0,0,background,screen);
                apply_surface(paddle1x,paddle1y,paddle1,screen);
                apply_surface(paddle2x,paddle2y,paddle2,screen);
            }
            if(keyheld[SDLK_RIGHT])
            {
                paddle1x++;
                apply_surface(0,0,background,screen);
                apply_surface(paddle1x,paddle1y,paddle1,screen);
                apply_surface(paddle2x,paddle2y,paddle2,screen);
            }
            if(keyheld[SDLK_a])
                {
                paddle2x--;
                apply_surface(0,0,background,screen);
                apply_surface(paddle1x,paddle1y,paddle1,screen);
                apply_surface(paddle2x,paddle2y,paddle2,screen);
                }
                if(keyheld[SDLK_d])
                {
                paddle2x++;
                apply_surface(0,0,background,screen);
                apply_surface(paddle1x,paddle1y,paddle1,screen);
                apply_surface(paddle2x,paddle2y,paddle2,screen);
                }

            apply_surface(0,0,timer,screen);
            SDL_Flip(screen);
            SDL_Delay(2);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:37:07.293

问题是因为您为每种类型的桨移动更新了后台缓冲区。如果两个桨都移动，您最终会更新两次。这是您遇到减速的地方。您应该每帧只更新一次后备缓冲区。像这样：

```
if(keyheld[SDLK_LEFT])
{
    paddle1x--;
}
if(keyheld[SDLK_RIGHT])
{
    paddle1x++;
}
if(keyheld[SDLK_a])
{
    paddle2x--;
}
if(keyheld[SDLK_d])
{
    paddle2x++;
}

// Now we do the update. You can always add a flag to see if the update
// really needs to be done and skip it if it doesn't
apply_surface(0,0,background,screen);
apply_surface(paddle1x,paddle1y,paddle1,screen);
apply_surface(paddle2x,paddle2y,paddle2,screen);

apply_surface(0,0,timer,screen);
SDL_Flip(screen);
SDL_Delay(2); 
```

# android - 小部件未更新

> ID：16123338
> 
> 赞同：1
> 
> 时间：2013-04-20T17:43:19.353
> 
> 标签：android, android-widget, android-appwidget

我正在尝试创建一个电池小部件，但应该显示电池状态的 textView 没有更新。仅当手机重新启动时才会更改。代码中缺少什么？

**安卓清单：**

```
 <uses-permission android:name="android.permission.BATTERY_STATS" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".WidgetConfigurationActivity"
        android:excludeFromRecents="true"
        android:launchMode="singleTop" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <action android:name="android.appwidget.action.APPWIDGET_CONFIGURE" />
        </intent-filter>
    </activity>

    <receiver android:name=".MAppWidgetProvider" >
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>

        <meta-data
            android:name="android.appwidget.provider"
            android:resource="@xml/widget_info" />
    </receiver>
</application> 
```

**应用小部件提供者：**

```
 public class MAppWidgetProvider extends AppWidgetProvider
{
    private String batteryLevel="init";

    @Override

public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) 
{       
    context.getApplicationContext().registerReceiver(this, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
  updateView(context);
}

@Override
public void onReceive(Context context, Intent intent) 
{

    int rawlevel = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);  
    int scale = intent.getIntExtra(BatteryManager.EXTRA_SCALE, -1);  
    int level = -1;  
    level = (rawlevel * 100) / scale;  
    batteryLevel = Integer.toString(level);  
    updateView(context); 
    super.onReceive(context, intent);

}

public void updateView(Context context) 
{
    RemoteViews thisViews = new RemoteViews(context.getApplicationContext()
            .getPackageName(), R.layout.widget_layout);
    thisViews.setTextViewText(R.id.textView1, batteryLevel);
    ComponentName thisWidget = new ComponentName(context,
            AnalogClockWidgetProvider.class);
    AppWidgetManager.getInstance(context).updateAppWidget(thisWidget,
            thisViews);
} 
```

}

**信息：**

```
 <appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:minWidth="40dp"
    android:minHeight="40dp"
    android:initialLayout="@layout/widget_layout"
    android:updatePeriodMillis="10000"
    android:configure="in.wptrafficanalyzer.appwidgetclockconfiguration.WidgetConfigurationActivity" 
    android:resizeMode="horizontal|vertical">
</appwidget-provider> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:55:54.467

首先，您需要使用服务来更新您的小部件，因为当您在应用程序之外时，活动处于 onPause 状态。

其次，在服务中注册一个意图过滤器，用于接收电池状态的变化。当它更新时，通知appwidget。

您还可以在服务中保留一个变量，小部件将引用该变量并设置其级别。

# javascript - Trigger.io 解析推送，订阅多个频道

> ID：16123340
> 
> 赞同：2
> 
> 时间：2013-04-20T17:43:54.853
> 
> 标签：javascript, trigger.io, parse-platform

用javascript编写的客户端是否可以通过多次调用parse.subscribe或通过提供多个通道来订阅多个解析通道到单个parse.subscribe通道请求

谢谢大家

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T18:39:53.410

是的，您可以多次调用 subscribe，还有一个 subscribedChannels api 列出所有订阅的频道：http: [//docs.trigger.io/en/v1.4/partners/parse.html#push-subscribedchannels](http://docs.trigger.io/en/v1.4/partners/parse.html#push-subscribedchannels)

# c - 我的链接器会从不需要的源文件中链接对象吗？

> ID：16123341
> 
> 赞同：2
> 
> 时间：2013-04-20T17:43:56.677
> 
> 标签：c, linker

编译项目时，如果我的源文件包含一个没有使用函数的文件，编译器的输出中是否会包含不需要的目标文件？

例如

foo.c

```
int main() {return 0;} 
```

酒吧.c

```
void unusedFunction {;} 
```

编译器执行：

```
gcc foo.c bar.c -o output 
```

如果我从编译器命令中省略 bar.c，输出文件会更小吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T19:23:14.843

大多数链接器会链接不需要的文件，除非您告诉他们不要这样做。有这方面的标志。

假设您链接了两个不需要的文件：一个目标文件和一个库：

```
gcc main.o unneeded.o -lunneeded 
```

对于 GNU Binutils 或 Gold，这些标志`--gc-sections`用于不需要的符号/目标文件和`--as-needed`库。但是，这些是链接器标志，因此它们必须以 . 为前缀`-Wl,`。请注意，这些标志的顺序很重要——标志仅适用于在命令行上出现*在*标志之后的库和目标文件，因此必须首先指定标志。

```
gcc -Wl,--as-needed -Wl,--gc-sections main.o unneeded.o -lunneeded 
```

在 OS X 上，有一个不同的链接器，所以标志是不同的。该`-dead_strip`标志删除不需要的符号/目标文件，该`-dead_strip_dylibs`标志删除不需要的库。

```
gcc -Wl,-dead_strip -Wl,-dead_strip_dylibs main.o unneeded.o -luneeded 
```

## 例子

```
$猫main.c
int main() { }
$猫不需要.c
无效不需要（）{}
$ gcc -c main.c
$ gcc -c 不需要的.c

```

如果我们正常链接，我们会得到一切......

```
$ gcc main.o 不需要的.o -lz
$ nm a.out | 不需要 grep
0000000000400574 T 不需要
$ readelf -d a.out | 需要 grep
 0x0000000000000001（需要）共享库：[libz.so.1]
 0x0000000000000001（需要）共享库：[libc.so.6]

```

有了正确的标志，我们就得到了我们所需要的……

```
$ gcc -Wl,--as-needed -Wl,--gc-sections main.o unneeded.o -lz
$ nm a.out | 不需要 grep
$ readelf -d a.out | 需要 grep
 0x0000000000000001（需要）共享库：[libc.so.6]

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T19:08:11.460

编译命令中引用的每个源文件或目标文件都将包含在最终的可执行文件中。

要仅包含所需的内容，请从您的对象构建一个静态库，并在链接时引用它，而不是单个对象。静态库就是为此目的而发明的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T19:17:07.103

使用 Scons ( [http://www.scons.org/](http://www.scons.org/) ) 或 Gradle ( [http://www.gradle.org/](http://www.gradle.org/) ) 之类的东西来找出依赖关系，然后只链接适当的位（假设您使用的是静态链接)

动态链接是另一回事——你会得到很多，因为其他程序可能需要额外的东西。

但是对于给定的命令行，它将链接它。如果不需要，为什么要首先添加它？

# android - 文件在外部存储中创建，但为空

> ID：16123343
> 
> 赞同：0
> 
> 时间：2013-04-20T17:43:59.117
> 
> 标签：android

我的应用程序的一部分在外部存储中创建了一些文件并写入它们。

一切都像魅力一样工作，直到我改变了一些东西，我不记得是什么了。现在应用程序创建文件但不写任何东西，即文件是空的。

有什么想法有什么问题吗？

这是我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myloader"
    android:versionCode="26"
    android:versionName="1.1" >

    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17"/>
    <uses-feature android:glEsVersion="0x00020000" android:required="true" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
    <uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" 
         android:debuggable="true">
        <activity
            android:name="com.example.myloader.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

这是我写入文件的地方。虽然我没有改变任何东西。工作的时候是这样的

```
public class GraphHelper {
    File directory;
    File myExternalFile;
    PrintWriter writer;
    FileOutputStream outputStream;
    ArrayList<float[]> dataList;
    float []toWrite;
    String strToWrite;
    private String filepath = "MyFileStorage";

public GraphHelper(Context context)
{
      directory = context.getExternalFilesDir(filepath);
}

public GraphHelper(Application application)
{
   directory = application.getExternalFilesDir(filepath);
}

public void writeToFile(String filename,ArrayList <float[]>data)
{
    if(isExternalStorageAvailable()&&!isExternalStorageReadOnly())
    {
        myExternalFile = new File(directory, filename);
     try {
        outputStream = new FileOutputStream(myExternalFile);
        writer = new PrintWriter(outputStream);
        dataList = data;

        for(int i=0;i< data.size();i++)
        {
            toWrite = data.get(i);
            System.out.println("toWrite[1]: "+toWrite[0]+"toWrite[2]: "+toWrite[1]);

         }
        writer.close();
        outputStream.close();

    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }}

}
private static boolean isExternalStorageReadOnly() {  
      String extStorageState = Environment.getExternalStorageState();  
      if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(extStorageState)) {  

       return true;  
      }  
      return false;  
     }  

     private static boolean isExternalStorageAvailable() {  
      String extStorageState = Environment.getExternalStorageState(); 

      if (Environment.MEDIA_MOUNTED.equals(extStorageState)) {  
           return true;  
      }  
     return false;

     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T07:12:24.490

你从不叫[print](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#print%28float%29)

```
for(int i=0;i< data.size();i++) {
    toWrite = data.get(i);
    System.out.println("toWrite[1]: "+toWrite[0]+"toWrite[2]: "+toWrite[1]);
    writer.print(toWrite);
}

writer.flush();
writer.close(); 
```

# jquery - 将 jQuery 小部件添加到 Drupal 页面会导致“$ 不是函数”

> ID：16123344
> 
> 赞同：0
> 
> 时间：2013-04-20T17:44:02.363
> 
> 标签：jquery, drupal

我正在尝试在 Drupal 上的表单中添加一个 datepicker 小部件。

我有一个包含以下代码的页面：

```
<script>
$(function() {
    $( "#datepicker" ).datepicker({
        changeMonth: true,
        changeYear: true
    });
});
</script>
<form action="/scripts/new-customer.php">
<div>Birth date: <input type="text" id="datepicker" name="bday" /></div>
</form> 
```

但不幸的是，我得到了这个主题的错误。我试着写如下：

```
<script>
    (function($) {
        $( "#datepicker" ).datepicker({
            changeMonth: true,
            changeYear: true
        });
    })(jQuery);
</script> 
```

但是我在后面的行中遇到了同样的错误。

不幸的是，我无法进一步了解 Drupal 文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:52:22.803

因为其他 JavaScript 库冲突。使用 jQuery.noConflict()

```
var jq = jQuery.noConflict();

jq(function() {
  jq( "#datepicker" ).datepicker({
        changeMonth: true,
        changeYear: true
    });
}); 
```

初始化前

```
drupal_add_library('system','ui.datepicker') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:09:26.973

不确定，但这可能会有所帮助：

```
jQuery(function($) {
  $("#datepicker").datepicker({
    changeMonth: true,
    changeYear: true
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:51:45.370

Drupal 可能正在使用[jQuery 的 noConflict 选项](http://api.jquery.com/jQuery.noConflict/)。试试`jQuery("#datepicker").datepicker()`吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-15T23:12:14.247

为避免与其他 JS 库发生冲突，“$”不会在全局 .js 文件中创建场景。因此，您应该在 js 代码周围添加以下代码：

```
(function($) {
Drupal.behaviors.naturalessenceTheme = {
attach: function(context, settings) {

$('selector').mouseover(function() {
//now working
});

}
};
})(jQuery); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-15T13:59:06.007

正如泰米尔语所建议的，以下代码运行良好：

```
<head>
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/south-street/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script> 
<script type="text/javascript" src="api/jquery.ui.datepicker-it.js"></script>
<?php drupal_add_library('system','ui.datepicker') ?>
<script>
    var jq = jQuery.noConflict();
    jq(function() {
        jq.datepicker.setDefaults(jq.datepicker.regional['it']);
        jq("#giornoSel").datepicker(
            { 
                dateFormat: 'dd/mm/yy', 
                altField: '#giorno', 
                altFormat: 'yy-mm-dd', 
                showButtonPanel: true
            }
        );
    });
</script> 
```

# eclipse - Eclipse 4 RCP 应用程序（独立！）：在菜单中添加“显示视图”

> ID：16123345
> 
> 赞同：1
> 
> 时间：2013-04-20T17:44:04.657
> 
> 标签：eclipse, eclipse-rcp, e4

在我的独立 RCP 应用程序（我开始使用产品配置）中，我想添加一个菜单条目“显示视图”，其中列出了我在正在**关闭的持久应用程序模型（一个***application.e4xmi*文件）中定义的所有视图。目前我没有使用任何*顾问*课程。

 ***我所做的是为每个视图手动添加*HandledMenuItems并将**CoreExpression*添加为*Visible-When Expression*。

*此表达式测试应用程序上下文*中的特殊键值对。这里的问题是每个视图都需要一个特殊的表达式。

解决这个问题的好模式是什么？或者有没有办法对核心表达式进行参数化？我可以使用任何预定义的 Eclipse 插件/命令/处理程序吗？

**更新**：相反，在我的独立 RCP 应用程序中使用 Window > Show View 结构也是可以的——就像它存在于 Eclipse 工作台中一样。有没有办法通过使用任何预定义/可用的方式来添加这个菜单（条目）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T17:55:32.037

我不确定这是否对您有帮助，因为它是 eclipse 3.7 代码，但您可以尝试一下。

*我向视图*菜单添加了一个动态菜单贡献，如下所示：

```
<menu id="x.y.menu.views label="%menu.window.label">
  <dynamic class="x.y.menu.ViewListMenuContribution" id="viewlist" />
</menu> 
```

在该课程中，我使用了其中一个 eclipse 菜单工厂来实际填充菜单：

```
@Override
public void fill(Menu menu, int index)
{
    super.fill(menu, index);

    IWorkbenchWindow window = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
    IContributionItem item = ContributionItemFactory.VIEWS_SHORTLIST.create(window);

    if (item != null)
        item.fill(menu, index);
} 
```

这应该显示当前关闭的所有视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T20:22:21.210

目前没有办法做到这一点，除了自己跟踪零件并使用`EPartService`***

# javascript - 在javascript中生成随机字母并计算每个字母出现了多少次？

> ID：16123346
> 
> 赞同：3
> 
> 时间：2013-04-20T17:44:18.010
> 
> 标签：javascript, html

我想生成一串随机字母，比如从 az 一个接一个的 10 个字母，即下一个字母应该在一定延迟后显示在前一个字母之后，稍后，我想计算每个字母生成的次数，与我之前所做的不同，即我采用了预定义的字母数组并相应地生成了它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T18:24:25.273

使用以下方式生成此类字符串的更短方法`String.fromCharCode`：

```
for (var i = 0, letter; i < 10; i++) {
    setTimeout(function() {
        letter = String.fromCharCode(97 + Math.floor(Math.random() * 26));
        out.appendChild(document.createTextNode(letter)); // append somewhere
    }, 2000 * i);
} 
```

完整的演示涵盖了这个问题中的所有问题：http: [//jsfiddle.net/p8Pjq/](http://jsfiddle.net/p8Pjq/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T18:05:05.170

使用该`setInterval`方法每隔一段时间运行代码。设置一个数组从一开始就计算每个字符，然后您可以在创建它们时而不是之后计算它们：

```
var text = '';
var chars = 'abcdefghijklmnopqrstuvwxyz';
var cnt = new Array(chars.length);
for (var i = 0; i < cnt.length; i++) cnt[i] = 0;

var handle = window.setInterval(function(){
    var ch = Math.floor(Math.random() * chars.length);
    cnt[ch]++;
    text += chars.charAt(ch);
    $('#display').text(text);
    if (text.length == 20) {
      window.clearInterval(handle);
      // now all characrers are created and counted
    }
}, 2000); 
```

演示：http: [//jsfiddle.net/R8rDH/](http://jsfiddle.net/R8rDH/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:46:21.447

我正在窃取这个答案，但请看这里：[Generate random string/characters in JavaScript](https://stackoverflow.com/questions/1349404/generate-a-string-of-5-random-characters-in-javascript)

```
function makeid()
{
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    for( var i=0; i < 5; i++ )
        text += possible.charAt(Math.floor(Math.random() * possible.length));

    return text;
} 
```

# ember.js - {{bindAttr }} {{action}} [Object] 没有方法替换

> ID：16123347
> 
> 赞同：0
> 
> 时间：2013-04-20T17:44:25.140
> 
> 标签：ember.js, handlebars.js

当 ember.js 尝试呈现包含以下 bindAttr 的模板时。在 handlebars.js 中抛出以下异常

```
Uncaught TypeError: Object [object Object] has no method 'replace'   handlebars.js:848 
```

绑定属性标签：

```
<div class="postWrapper" {{bindAttr style="display:none"}}> 
```

**更新**

当我使用动作助手时也会发生这种情况

```
 <div {{action Toggle}}  class="btn pull-right">
        <i class="postToggler icon-chevron-down " ></i>
    </div> 
```

***更新完整代码***

模板

```
 <script type="text/x-handlebars" data-template-name="Composer">
                <div class="postWrapper">
                                <div class="postContentWrapper" {{bindAttr style="controller.display"}}>  
                    <div class="row-fluid">
                    <div class="pull-left span10">
                                        To :
                            <input id="test2" type="text" style="margin-top: 7px;width:90%" />
                    </div>
                    <div {{action Toggle}}  class="btn pull-right">
                        <i class="postToggler icon-chevron-down " ></i>
                    </div>
                    </div>

                    <div class="row-fluid" style="height:100%" >
                    <div id="wmd-button-bar" style="width:48%;display:inline-block" ></div>
                    <div class="pull-right">
                    <a>Hide preview</a>
                    </div>
                        <div class="wmdWrapper" style="height:80%">
                            <div class="wmd-panel" style="vertical-align: top;">

                                <textarea class="wmd-input" id="wmd-input" style="height: 100%;"></textarea>
                            </div>
                            <div id="wmd-preview" class="wmd-preview pull-right"></div>
                        </div>
                        <br />

                    </div>
                    <div class="row-fluid">

                    <div class="span6  ">
                        <p>
                            Tags :
                            <input id="test" type="text" style="width:80%"/>
                        </p>
                    </div>
                        <div class="span2 pull-right">
                        <button id="btnSubmitPost" class="btn btn-success pull-right">{{controller.buttonText}}</button>
                        <button id="btnCanelPost" class="btn btn-warning pull-right">Cancel</button>
                    </div>

                    </div>
                    <div class="row-fluid">

                    </div>
                    </div>
                </div>
        </script> 
```

查看和渲染

```
 /*
        MODES
            NEW
            REPLY

        */
        Thoughts.ComposerController = Ember.Object.extend({
            mode: 2,
            visible: false,
            messageContent: "",
            buttonText: function () {
                switch (this.get("mode")) {
                    case 1: return "Post";
                    case 2: return "Reply";
                }
            }.property(),

            display: function () {
                if (this.get("visible")) {
                    return 'display:block';
                } else
                    return 'display:none';
            }.property(),

            Toggle: function(){
                console.log('Helllo');
                }
        });

        Thoughts.ComposerController = Thoughts.ComposerController.create(); 
```

**错误信息**

对象转储

```
 string: "data-ember-action="1""
            __proto__: Object
            constructor: function (string) {
            toString: function () {
            __proto__: Object 
```

replace 方法崩溃，因为方法 replace 未定义

```
Handlebars.Utils = {
    escapeExpression: function (string) {
        // don't escape SafeStrings, since they're already safe
        if (string instanceof Handlebars.SafeString) {
            return string.toString();
        } else if (string == null || string === false) {
            return "";
        }

        if (!possible.test(string)) { return string; }
       ----> return string.replace(badChars, escapeChar);
    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T11:04:30.297

我终于找到了一些时间来再次处理这个问题。

我所做的只是替换了 ember 和 handlebars js 文件，现在代码工作正常，谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T21:14:54.140

所以首先你需要定义只需要定义控制器。您不必创建实例。Ember 会在应用程序初始化时为您完成。

如果您定义一个正在观察另一个的属性，换句话说，它的值取决于另一个，您需要将其指定为`property`帮助器的参数。

```
Thoughts.ComposerController = Ember.Controller.extend({
    mode: 2,
    visible: false,
    messageContent: "",

    buttonText: function () {
        switch (this.get("mode")) {
            case 1: return "Post";
            case 2: return "Reply";
        }
    }.property('mode'),

    display: function () {
        return 'display:' + this.get('visible') ? 'block' : 'none';
    }.property('visible'),

    Toggle: function () {
        this.toggleProperty('visible');
        this.set('mode', this.get('mode') == 2 ? 1 : 2);
    }
}); 
```

模板本身似乎是有效的。

您可以通过创建这样的作曲家路线来完成这项工作：

```
this.route('composer'); 
```

或通过在另一个模板中呈现它，如下所示：

```
{{render 'composer'}} 
```

那应该是你的问题的答案。**但**

`{{if}}`使用帮助器根据条件在模板内显示一些内容不是更好吗？

# php - Joomla 模块可以“知道”它的位置吗？(2)

> ID：16123350
> 
> 赞同：4
> 
> 时间：2013-04-20T17:44:40.887
> 
> 标签：php, joomla, module

这是我在 StackOverflow 上的第一个问题。我试图在帖子中发表评论[Joomla 模块可以“知道”它的位置吗？](https://stackoverflow.com/questions/7647730/can-a-joomla-module-know-what-position-its-in?answertab=active#tab-top)，但找不到办法做到这一点，所以我不得不在这里发布另一个问题。非常感谢有关如何正确执行此操作的任何提示。无论如何，这是我的问题：

我尝试了上面帖子中提到的代码，但似乎没有用。我不仅对 PHP 很陌生，而且对编码也很陌生，所以我不确定是我还是代码。这是我对模块的 default.php 文件所做的：

**1）为了确保我在正确的位置插入代码，我插入**

```
 <?php echo(print_r($module)); ?> 
```

并在正确的位置输出 1；

**2）我需要确定的位置名称是“showcase-a”，所以我插入代码**

```
 <?php if ($module->position == 'showcase-a'):?>test<?php endif;?> 
```

到上面的地方，但这次它什么也没显示；

**3）然后我尝试了这段代码：**

```
 <?php if ($module):?><span>test</span><?php endif; ?> 
```

但它仍然没有像我预期的那样在该位置显示“测试”。

**4）我试过了**

```
 <?php if (1):?><span>test</span><?php endif; ?> 
```

并且测试“测试”显示良好。所以我没有将 IF 语句编码错误。

现在我完全迷路了。既然 print_r($module) 输出 1，$module 一定是正数，为什么 PHP 忽略 3) 中的测试？为了 PHP 学习，这只是一个附带问题。我还需要解决的是让模块确定自己在哪个位置。请帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T14:29:07.273

如果 $module->position 不适合你。$module->position 可能仅适用于 joomla 1.7、2.5 和 + 但我不确定。$module->position 在 joomla 2.5 中有效。

否则你需要做一个module.php函数

查看文件

/templates/you-template/html/modules.php

例如，您在模板中设置以下位置（例如 index.php）

```
<jdoc:include type="modules" name="header" style="includeposition" /> 
```

/templates/you-template/html/modules.php 内部

你做一个这样的功能：

```
<?php
function modChrome_includeposition($module, &$params, &$attribs){
    //Set a value to $module->position
    $module->position='WHATEVER YOUWANT';
    ?>
    <div class="moduletable <?php echo $params->get('moduleclass_sfx').' '.$module->name; ?>">
        <?php
        if($module->showtitle){
        ?>
        <div class="modtitle">
            <div class="fleche">
                <span>
                    <?php
                        echo $module->title;
                    ?>
                </span>
            </div>
        </div>
        <?php
        }
        ?>
        <div class="modcontent">
            <?php echo $module->content; ?>
            <div class="clear">
            </div>
        </div>
    </div>
    <?php
}
?> 
```

如果需要，可以创建不同的函数名称来设置不同的值。

函数名称将与您设置的样式匹配：

```
modChrome_includeposition($module, &$params, &$attribs) 
```

因为

```
style="includeposition" 
```

在你的 jdoc 里面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T07:58:58.647

我不确定是否在模板中使用它（尽管它似乎完全没有错）但我的模块经常访问这样的位置：

```
$module->position 
```

在模块中（所以 mod_something.php）所以试着把它放在那里，如果它可用，只需设置一个变量，它也将在视图中可用。

# c++ - C++ 上的链表

> ID：16123360
> 
> 赞同：-1
> 
> 时间：2013-04-20T17:46:04.873
> 
> 标签：c++, pointers, linked-list

我正在学校学习链接列表，但我的教授没有具体说明很多事情。

首先是一个链表是一个内置库吗？程序员需要创建一个节点类吗？

这是我唯一的例子：

```
class node;
typedef node*  nodeptr;

class node {
   public:
      int number;
      nodeptr next;
 };

//--------------------------------
int main ( ) 
{
   nodeptr top; 
```

我也不知道“typedef”是什么意思..我知道指针是什么..如果有人能解释一下..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:59:52.383

> 首先，链表是内置库吗？

嗯，不。链表是一种*数据结构*。`std::list`标准库在和中有两种不同的实现`std::forward_list`。

* * *

> 程序员需要创建一个节点类

从上面的示例中，您的教授似乎希望您这样做。

* * *

> 我也不知道“typedef”是什么意思。

`typedef`是一个关键字。其目的是为现有类型分配替代名称。因此，例如，`double`用另一个名字（比如说`x`）打电话时，你会使用如下内容：

```
typedef double x 
```

现在您可以声明：

```
x name = 13.2 
```

这将被翻译成：

```
double name = 13.2 
```

* * *

> 我知道指针是什么。

指针是一种数据类型，其值可以是特定内存空间的地址。在 C++ 中，要获取特定分配变量的地址，您可以使用`&x`where `x`is 分配的变量。打印`&a`将以 . 格式打印内存地址`0x...`。如果你声明一个带有类型的变量，`T*`你可以使该变量包含一个相同类型的变量的内存地址`T`。`*`指针前面的符号意味着延迟*指针*，这意味着*获取它指向的内存空间的值*。

```
int x = 10
int* y = &x
std::cout << (*y); 
```

在上面的例子中，输出是`10`.

* * *

> 如果有人能解释一下发生了什么，我将不胜感激。

链表最简单的形式可以如下实现：

```
struct node {
      node( x, y = 0 ) : field(x), next(y) {}
      int field;
      node* next;
}; 
```

链表的目的是拥有一个*动态容器*，其中包含所需数量的*单元格*。它背后的想法是主`node`结构应该包含一个成员变量`field`，该变量将存储单个特定值和一个指向下一个`node`将包含另一个值的指针，依此类推。

图形表示可以如下：

```
[ a:10 ] ---> [ b:3 ] ---> [ c:7 ] 
```

在上面的示例中，节点结构将是：

```
node c = node(7, 0);
node b = node(3, &c);
node a = node(10, &b); 
```

where`0`表示*空指针*，是一个特殊值，表示“指向任何东西”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:58:41.677

`typedef`关键字提供了一种从现有类型创建新类型名称的方法。通常`typedef`用于通过创建一个名称比原始类型更容易混淆的新类型名称来简化代码。

在您的情况下，现有类型`node *`用于创建新类型 name `nodeptr`。因为 typedef 语句`nodeptr`可以用来代替`node *`类型名。

```
typedef node* nodeptr; 
```

下面的类有一个类型为 name`node`的数据成员。next 具有 指针类型（AKA nodeptr）。`next``nodeptr``node`

```
class node 
{ public: 
     int number; 
     nodeptr next; 
}; 
```

# python - 如何用新的打印线替换打印线？

> ID：16123361
> 
> 赞同：0
> 
> 时间：2013-04-20T17:46:10.533
> 
> 标签：python, python-3.x

我要做的是用新的打印语句替换打印语句。用外行的话来说，我希望控制台打印，然后在下载完成后立即`Downloading...`替换它。`Downloading...done!`我已经尝试过[这个答案](https://stackoverflow.com/a/5291044/1530429)，但它只是打印一些垃圾，然后在新行上打印语句。我正在使用 Python 3。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:49:32.797

`end=""`在第一个中使用`print`，默认值为`end`a`new line`但您可以通过传递您自己的值来更改它：

```
print("Downloading...",end="")
#your code here
print("Done!") 
```

**输出**：

```
Downloading...Done! 
```

帮助`print`：

```
In [3]: print?
Type:       builtin_function_or_method
String Form:<built-in function print>
Namespace:  Python builtin
Docstring:
print(value, ..., sep=' ', end='\n', file=sys.stdout)

Prints the values to a stream, or to sys.stdout by default.
Optional keyword arguments:
file: a file-like object (stream); defaults to the current sys.stdout.
sep:  string inserted between values, default a space.
end:  string appended after the last value, default a newline. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:50:08.203

一个简单的例子：

```
import time
print("Downloading... ", end='')
time.sleep(3)
print("done.") 
```

您还可以在使用 "\r" 之前替换部分行 printet：

```
import time
print("Downloading... ", end='')
time.sleep(3)
print("\r.............. done.") 
```

这当然只适用于您不在回车符之前的任何地方打印换行符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:50:41.053

```
print ("Print this line, and print a newline")
print ("Print this line, but not a newline", end="") 
```

[http://www.harshj.com/2008/12/09/the-new-print-function-in-python-3/](http://www.harshj.com/2008/12/09/the-new-print-function-in-python-3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T18:06:16.400

如果你想要一个交互式的`...`，即它增长，你可以做这样的事情。只需用更合适的东西更改条件中的条件，`while`甚至在循环内使用`while True`和。`if``break`

```
>>> import time
>>> def dotdotdot():
...     print("Downloading", end="")
...     a = 0
...     while a < 10:
...         print(".", end="")
...         time.sleep(1)
...         a += 1
...     print("done!")
...
>>> dotdotdot()
Downloading..........done! 
```

# function - 在 Nasm 中调用汇编函数

> ID：16123370
> 
> 赞同：3
> 
> 时间：2013-04-20T17:47:03.510
> 
> 标签：function, assembly, x86, nasm, bios

我目前正在从头开始构建一个简单的操作系统，所以我正在测试一些引导扇区代码并使用 Qemu 模拟它。

当操作系统启动时，我的引导扇区代码应该打印“A”。

这是引导扇区代码的第一个版本（不使用函数调用）

```
[org 0x7c00]

mov al,'A'
mov ah,0x0e  ; int 10/ ah = 0eh -> scrolling teletype BIOS routine
int 0x10

jmp $

times 510 -( $ - $$ ) db 0
dw 0xaa55 
```

执行 nasm 生成的二进制文件后，使用：

```
qemu-system-i386 test.bin 
```

结果是正确的，字符“A”出现在它应该出现的位置

但是，在尝试使用打印存储在 al 中的字符的功能后，屏幕上没有打印任何内容

这是test.asm文件的第二个版本（包括这次的函数调用）

```
[org 0x7c00]

mov al,'A'

call my_print_function

jmp $

times 510 -( $ - $$ ) db 0
dw 0xaa55

my_print_function:
    pusha  ; push all registers

    ; same code as the first version to print a character stored in al
    mov ah,0x0e  
    int 0x10

    popa ; pop all registers
    ret 
```

那么为什么它不能正常运行呢？

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T17:59:39.537

您必须在其末尾具有引导扇区的签名。我说的是这部分：

```
times 510 -( $ - $$ ) db 0
dw 0xaa55 
```

现在你`my_print_function`不在引导扇区，甚至没有被 BIOS 加载。

您需要将此功能移至签名之前。

# sass - 精灵生成指南针/SASS

> ID：16123372
> 
> 赞同：0
> 
> 时间：2013-04-20T17:47:20.117
> 
> 标签：sass, compass-sass, sprite

我在一个效果很好的项目中使用 Compass Sprite 助手。然而，精灵的生成增加了项目编译时间的几秒钟，而且大多数时候我不需要重新生成它。

有没有办法关闭精灵生成并让指南针使用最后生成的文件？

我正在使用 CodeKit，我很容易被很多关于命令行/Ruby 的讨论搞糊涂！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T08:22:54.833

我刚刚尝试过，对我来说 Compass 不会重新编译我的精灵，除非我修改精灵文件夹的内容：

```
$ compass compile
unchanged images/sexy-sce786a2ec5.png
overwrite stylesheets/screen.css 
```

`compass`尝试使用命令行工具而不是 CodeKit编译您的项目。如果成功，请检查 CodeKit 是否使用 Compass 编译您的项目，而不是 vanilla SASS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T16:40:02.663

它看起来像一个正在修复的 CodeKit 问题： [https ://github.com/bdkjones/CodeKit/issues/297](https://github.com/bdkjones/CodeKit/issues/297)

在此之前，我使用的是[此处](https://stackoverflow.com/questions/11518037/codekit-compass-vs-less-compilation-when-spriting)详述的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-01T06:51:29.310

似乎`compass compile` *没有其他参数*（根据 Andrey 'lolmaus 的回答）不会导致这种情况，但如果有任何参数，它会将`:force`选项设置为 true，其后果之一是强制重新创建精灵。

这似乎是疯狂的行为？

目前我已经编辑`lib/compass/commands/update_project.rb`（特别是在我的情况下， ）并在该文件末尾`~/.rvm/gems/ruby-1.9.3-p429/gems/compass-0.12.4/lib/compass/commands/update_project.rb`注释掉函数中的`parser.options[:force] = true`行。`parse_arguments!`

（注意`unless arguments.empty?`条件）

这似乎完全禁用了精灵生成（即即使你需要它），但我可以手动启用它`compass compile --force ...`

这对我来说当然已经足够好了。

# wcf - Azure、WCF 服务和限制部分接口？

> ID：16123373
> 
> 赞同：0
> 
> 时间：2013-04-20T17:47:21.553
> 
> 标签：wcf, azure, service, interface

我找不到直接的答案。基本上我有服务 MainService 和 SubService。思路是Client软件调用MainService中的一些方法，而SubService调用MainService中的另一部分服务。

我正在部署到 Azure，我想在 MainService 中有两个单独的接口，一个用于客户端，一个用于 SubService，我不希望客户端服务有任何机会访问 SubService 使用的接口。

鉴于我是 WCF 服务的新手，我不知道如何处理这个问题。我是否需要多个 Web 角色来访问同一个数据库并在那里处理并发问题等的不同接口，或者我是否可以以某种方式包含多个接口但通过例如证书来限制可用性。我不确定 Azure 防火墙规则，但如果 MainService 中用于 SubService 的接口可以映射到防火墙规则后面的单独端口，那也是一个可行的解决方案。

tl;dr：在 WCF 服务中需要两个单独的接口，一个用于客户端软件（对外部世界开放），一个用于子系统服务。这两项服务都将在 Azure 中运行。我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:04:22.873

您可以使用标准 WCF 授权和身份验证。例如：http: [//msdn.microsoft.com/en-us/library/ff647503.aspx](http://msdn.microsoft.com/en-us/library/ff647503.aspx)

如果你想将 Azure 服务总线与中继消息一起使用，你可以使用服务总线提供的一些身份验证和授权。但是，我不确定与仅在 Web 角色中托管 WCF 相比是否有任何额外的价值（在任何一种情况下都必须这样做，但是对服务的访问将通过服务总线与客户端分离）。

# asp.net - 更新服务器端代码 asp.net 中的 Textbox.text

> ID：16123374
> 
> 赞同：0
> 
> 时间：2013-04-20T17:47:21.990
> 
> 标签：asp.net

我的 default.aspx 页面中有一个文本框，我想在事件处理程序中更新它的文本属性，但在执行代码后更改不会发生。

```
void _gsc_Task_Completed(object sender, TaskEventArgs e)
{

  TextBox1.Text = "New Value";

} 
```

但是，如果我在一个简单按钮的单击事件上执行此操作，则 textbox.Text 值
会发生变化。

像 _gsc_Task_Completed 这样的自定义事件处理程序和简单的按钮单击事件有什么区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:51:41.897

文本框是一个`server side control`. 当您更改文本时，此工作（更改文本）是客户端，因此事件`not firing`。但是当我点击一个按钮时，页面将返回服务器并返回，所以事件`is firing.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:57:15.860

您需要考虑页面生命周期：http: [//msdn.microsoft.com/en-us/library/ms178472 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx)

要么您的事件处理程序被提前调用（并被从客户端带回的任何内容所破坏），要么在控件已经呈现后调用它。

如果我是你，我会在那里放置一个断点以及页面 onInit、onLoad 等的正常处理程序。查看调用该处理程序的顺序（如果有的话）以及调用堆栈上它下面的内容。

# html - 在不丢失内容垂直焦点的情况下缩放网站宽度

> ID：16123377
> 
> 赞同：2
> 
> 时间：2013-04-20T17:47:35.090
> 
> 标签：html, css, responsive-design, scale

我有一个基本网站，其中包含很长的大部分文本内容：

HTML 像这样简化：

```
<body>
<div class="content" id="01">
    <p>LONG TEXT</p>
</div>

<div class="content" id="02">
    <p>LONG TEXT</p>
</div>
</body> 
```

大约还有 40 个 id 也是如此。

CSS 会像这样查找这些部分：

```
.content {
    max-width: 600px;
    min-width: 240px;
    margin: 0 auto;
} 
```

所以内容 div 会随着浏览器窗口/视口缩小。这终于把我们带到了我的**问题上：**

每当我缩小浏览器窗口的宽度时，内容 div 的宽度也会缩小，因此内容本身会变得更长，或者应该说更高。这导致内容中当前焦点向下移动的情况。尤其糟糕的是，当将移动设备从横向切换到纵向时，反之亦然。

我现在正在尝试找到可以上下缩放内容高度的解决方案，同时将当前的垂直焦点保持在屏幕上。有谁知道如何在 HTML、CSS 或 JS 中做到这一点？内容 div 具有唯一的 id，单个 div 不是很长，所以我想至少对于 JS，这应该可以通过某种方式跟踪当前显示的 id 来实现？

我希望我对此有所了解，而英语不是我的母语。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:35:40.147

我认为你应该做的是将`<p>`宽度固定为 的最小宽度`div.content`，因此它永远不会改变它的宽度，但父级`<div>`会根据当前方向。

你可以在这里看到一个例子：http: [//jsfiddle.net/dyjXC/1/](http://jsfiddle.net/dyjXC/1/)

CSS：

```
body{ width: 300px; } /* portrait or landscape */
div.content
{ 
    max-width: 600px; 
    min-width: 240px; 
    background: salmon; 
    border-bottom: 1px solid green;
}
div.content > p
{
    text-align: center; /* I centered both the text and... */
    margin: 0px auto;   /* ... the p itself, but you can use default to left */
    width: 240px; 
    background: lightgray;
} 
```

我希望它能按预期工作。

# c - 访问共享内存中的结构后出现段错误？

> ID：16123382
> 
> 赞同：1
> 
> 时间：2013-04-20T17:48:30.277
> 
> 标签：c, struct, posix, shared-memory

我在共享存储在`struct`跨进程中的值时遇到问题。下面我的代码被简化了，只有一个过程，这将增加 value `num2`。每当进程结束时，`waitpid()`将`pid`进程的写入*数组*。这又被简化了，在我更大的项目中，我有大约 100 个进程，它们依次将它们`pid`的 s写入*array*。所以每个进程都会看到*数组*。但是，对于它们中的每一个，其中的整数值`struct`都是不同的。为什么？

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <semaphore.h>
#include <sys/shm.h>

typedef struct{
   int num;
   int num1;
   int num2;
   char *array;
} data;

void c_print(data *a);

int main(int argc, char *argv[])
{
   data *main_data;

   int pam_id=shmget(IPC_PRIVATE,sizeof(data), IPC_CREAT | IPC_EXCL | 0666);
   if (pam_id == -1)
       fprintf(stderr,"error");
   int k=shmat(pam_id,NULL,0);
   if (k==NULL)
       fprintf(stderr,"shmat error");
   main_data=malloc(sizeof(data));
   main_data->num = strtol(argv[1],NULL,10);
   main_data->num1 = strtol(argv[2],NULL,10);
   main_data->num2 = strtol(argv[3],NULL,10); 
```

没有`malloc`下文，访问`main_data`会导致*segfault*。但是，其他进程看不到存储在`struct`数组中的变量。

```
 main_data->array = malloc(main_data->num2*sizeof(char));

  main_data->array[0]=fork();
  if (main_data->array[0]==0){
      main_data->num2+=2;
      exit(9);
  } else {
      waitpid(-1,main_data->array[0],0);
      c_print(main_data);
      return 0;
  }
  return 50;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:06:01.960

你应该使用`k`而不是`malloc()`. 的地址`k`在进程之间共享。我认为您误解了**shm** api。即，替换`main_data->array=...;`为`main_data->array=(void*)k;` 每个进程都会得到一个新的`main_data`. 您需要`shmget`与`num2*sizeof(char)`.

您希望共享的内存应该使用`shmget()`和`shmat()`。 `malloc()`将按进程分配，并将使用父内存的副本进行初始化。如果`num`, `num1`,`num2`是私有的 or `const`，那么您的`data`结构可以使用`malloc()`并且数组应该使用`shget`and `shmat`。如果您需要在所有进程中动态更新两者，则两者都必须使用`shget()`and `shmat()`。

此外，您应该注意数据竞争。

# cordova - 为什么我的 PhoneGap 应用程序在加载时出现损坏？

> ID：16123385
> 
> 赞同：3
> 
> 时间：2013-04-20T17:48:43.343
> 
> 标签：cordova, android-emulator, osx-lion

我创建了一个基于 PhoneGap 2.6.0 的项目。我没有对其进行任何更改。当我尝试在 4.2.2 模拟器中运行它时，视觉效果已损坏，或者我不确定如何放置它。

**PhoneGap 2.6.0 应用程序在 4.2.2 中的屏幕截图** ![PhoneGap 2.6.0 应用程序在 4.2.2 中的屏幕截图](https://i.stack.imgur.com/ObPgl.png)

如果我在暂停应用程序后恢复应用程序，按返回键并重新启动应用程序，那么它可以正常打开。

**该应用程序在暂停后重新启动时看起来很好** ![该应用程序在暂停后重新启动时看起来很好](https://i.stack.imgur.com/SWcdy.png)

谷歌搜索导致我发现`deviceready`事件未触发问题。我不确定这是否与它有关，但无论如何这似乎已在 2.3.0 中修复。

**注意事项：**

*   这在 2.3.3 模拟器中运行良好。
*   我正在运行最新的 Android SDK。
*   我有 OSX 狮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T03:44:18.770

这似乎是计时器执行方式的错误。加载 url 后，您可能需要输入 onCreate 方法：

```
super.appView.resumeTimers(); 
```

所以现在代码看起来像这样：

```
super.loadUrl(url, 10000);        
super.appView.resumeTimers(); 
```

# c# - 显示另一个类中的所有项目

> ID：16123391
> 
> 赞同：2
> 
> 时间：2013-04-20T17:49:52.507
> 
> 标签：c#, list, oop, class

我的问题是我有一个 List<> 变量连接到另一个类，我想从该 List<> 中获取所有项目并将其放入一个字符串中。

在结果字符串中，我想查看 callNum、copyNum、内容、作者、年份、标题

这是我试图将其放入字符串的地方

```
public class CItemControl
    {
        //declare a list variable
        private List<CItem> mItems;
        private CItem mNewItem;
        //a method that instantiates the list
        public CItemControl()
        {
            mItems = new List<CItem>();
        }
        //attribute to get all items
        public List<CItem> Items
        {
            get { return mItems; }
        }
        public CItem NewItem
        {
            get { return mNewItem; }
        }
        //method to add item to the CItem list
        public void AddItem(int callNum, int copyNum, string content, string author, string year)
        {
            mNewItem = new CItem(callNum, copyNum, content, author, year);
            mItems.Add(mNewItem);
        }
        //method to return all items to a string
        public CItem ListAllItems()
        {
            string allItems;

        } 
```

这是我试图从中获取项目的课程。后面会添加变量。

```
class CItem
    {
        //declare attributes
        private string mTitle;
        private string mAuthor;
        private string mContent;
        private string mYear;
        private int mCopyNum;
        private int mCallNum;
        private bool mHold = false;
        private bool mBorrowed = false;
        private bool mShelf = false;

        //overload a constructor
        public CItem(int CallNum, int CopyNum, string Content, string Author, string Year)
        {
            callNum = CallNum;
            copyNum = CopyNum;
            content = Content;
            author = Author;
            year = Year;
        }

        //create the default constructor
        public CItem()
        {
            callNum = 0;
            copyNum = 0;
            content = "";
            author = "";
            year = "";
        }

        //set attributes
        public int callNum
        {
            get { return mCallNum; }
            set { mCallNum = value; }
        }
        public string content
        {
            get { return mContent; }
            set { mContent = value; }
        }
        public string author
        {
            get { return mAuthor; }
            set { mAuthor = value; }
        }
        public string year
        {
            get { return mYear; }
            set { mYear = value; }
        }
        public string title
        {
            get { return mTitle; }
            set { mTitle = value; }
        }
        public int copyNum
        {
            get { return mCopyNum; }
            set { mCopyNum = value; }
        }
        public bool hold
        {
            get { return mHold; }
        }
        public bool borrowed
        {
            get { return mBorrowed; }
        }
        public bool shelf
        {
            get { return mShelf; }
        }

        //display information for users
        public string displayInfo()
        {
            return "Call Number: " + callNum + ". Copy Number: " + copyNum + ". Title: " + title +
                ". Author: " + author + ". Year Published: " + year + ". Content: " + content;
        }

        //new method to display status of item
        public string displayStatus()
        {
            if (borrowed == true)
                return "Item is currently being borrowed.";
            if (shelf == true && hold == false)
                return "Item is available for borrowing.";
            else
                return "Item is on hold";
        } 
```

任何帮助深表感谢！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:58:40.267

```
return String.Join("; ", allItems.Select(item => item.displayInfo())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:01:51.237

您没有提供很多关于您希望在结果字符串中如何以及需要哪些信息的信息。

你不能用一个简单的循环来实现这个目标吗？

```
using System.Text; 
(...)
public string ListAllItems()
{
    StringBuilder allItems = new StringBuilder();

    foreach(CItem itm in Items){
        allItems.AppendLine(itm.displayInfo());
    } 

    return allItems.ToString();      
} 
```

Stringbuilder 是可选的，但比字符串连接更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T17:55:03.677

`ListAllItems`看起来像这样

```
public string ListAllItems()
{
    var sb = new StringBuilder();   // var is of type StringBuilder
    mItems.ForEach(item => sb.Append(item.displayInfo());
    return sb.ToString();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T18:12:20.960

我通常不喜欢将格式化程序方法添加到这样的属性包中。如果您希望灵活地更改有许多格式化实现，您可能希望让一个单独的类来进行格式化。

```
public interface IFormatter<in T>
{
    string Format(T obj);
}

public class CItemFormatter : IFormatter<CItem>
{
    public string Format(CItem item)
    {
        //formatting logic
    }
} 
```

# c# - 无限循环使用 htmlagilitypack 解析表

> ID：16123392
> 
> 赞同：0
> 
> 时间：2013-04-20T17:49:57.937
> 
> 标签：c#, html, html-agility-pack

我正在尝试使用 HtmlAgilityPack 解析 TR，并对第一个、第二个、第三个等 TD 做一些不同的事情。

我快到了，但我的代码（如下）导致无限循环。它只是一遍又一遍地重复第一行：

```
 foreach (HtmlNode row in htmlDoc.DocumentNode.SelectNodes("//table//tr"))
        {
            var node = row.SelectSingleNode("//td[1]");
            if (node != null)
            {
                Console.WriteLine("Node: {0}", node.InnerText);
            }
        } 
```

原始 HTML 正确返回。该表也很标准：

```
<table>
  <tr>
    <th>Header 1</hr>
    <th>Header 2</hr>
    <th>Header 3</hr>
    <th>Header 4</hr>
    <th>Header 5</hr>
  </tr>
  <tr>
    <td>Cell 1</td>
    <td>Cell 2</td>
    <td>Cell 3</td>
    <td>Cell 4</td>
    <td>Cell 5</td>

    ...
  </tr>
</table> 
```

以下代码有效，但它没有按行分组，因此更难操作：

```
 foreach (HtmlNode node in htmlDoc.DocumentNode.SelectNodes("//table//tr//td"))
        {
            Console.WriteLine("Node: {0}", node.InnerText);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T19:48:43.740

这适用于您的示例 html

```
var res = doc.DocumentNode.SelectNodes("//table//tr[td]")
             .Select(row => row.Descendants("td")
                                .Select(td => td.InnerText).ToList())
             .ToList(); 
```

# android - 用户从右向左滑动时的 Viewpager 调用意图

> ID：16123399
> 
> 赞同：0
> 
> 时间：2013-04-20T17:50:41.250
> 
> 标签：android, android-intent, android-viewpager

我`viewpager`用来向用户展示一些介绍，有两个屏幕，当两个屏幕都完成后，我必须通过`intent`. 现在，我已经实施`viewpager`并通过了`intent`.

这是我到目前为止所做的：

编辑了我的源代码：

IntroActivity.java

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final ViewPager viewPager = (ViewPager) findViewById(R.id.view_pager);
    final ImagePagerAdapter adapter = new ImagePagerAdapter();
    viewPager.setAdapter(adapter);

    OnPageChangeListener mListener = new OnPageChangeListener() {

        @Override
        public void onPageSelected(int arg0) {
            // TODO Auto-generated method stub
            selectedIndex = arg0;
            System.out.println("Selecte Page: " + selectedIndex);
        }

        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {
            // TODO Auto-generated method stub
            if (mPageEnd && arg0 == selectedIndex) {
                Log.d(getClass().getName(), "Okay");
                mPageEnd = false;// To avoid multiple calls.
            } else {
                mPageEnd = false;
            }
        }

        @Override
        public void onPageScrollStateChanged(int arg0) {
            // TODO Auto-generated method stub
            if (selectedIndex == adapter.getCount() - 1) {
                mPageEnd = true;
            }
        }
    };
    viewPager.setOnPageChangeListener(mListener);

}

private class ImagePagerAdapter extends PagerAdapter {
    private int[] mImages = new int[] { R.drawable.libin1,
            R.drawable.libin2 };

    @Override
    public int getCount() {
        return mImages.length;

    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == ((ImageView) object);
    }

    @Override
    public Object instantiateItem(ViewGroup container, int position) {
        Context context = MainActivity.this;
        ImageView imageView = new ImageView(context);
        int padding = context.getResources().getDimensionPixelSize(
                R.dimen.padding_medium);
        imageView.setPadding(padding, padding, padding, padding);
        imageView.setScaleType(ImageView.ScaleType.CENTER_INSIDE);
        imageView.setImageResource(mImages[position]);
        ((ViewPager) container).addView(imageView, 0);
        return imageView;
    }

    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        ((ViewPager) container).removeView((ImageView) object);
    }
} 
```

通过这些我可以实现`viewpager`，但是正如你所看到的，`onTouchListener`当用户在第二个屏幕上时，我已经调用了意图。

我的问题是，如果用户愿意，他将无法再次看到第一个屏幕，因为`touchListener()`一旦用户触摸屏幕，就会调用意图。

我尝试过使用`GestureListener`行动`fling`，但这也对我没有帮助。

我该如何克服这个问题？

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T09:07:48.627

首先，我建议你重新考虑你的逻辑。跳转到另一个`Activity`页面，也可以滑动到上一页的动作似乎有点矛盾，当用户到达最后一页时会向用户显示一个通知（邀请他“关闭”这个介绍）我认为这是一个更好的选择.

反正你可以做你想做的。`OnPageChangeListener`在上设置 a`ViewPager`以监听交互：

```
 @Override
        public void onPageScrollStateChanged(int state) {
            mCurrentState = state;
            // if we are at the second page and the user touched the
            // ViewPager post a Runnable with a decent time to schedule our
            // Intent
            if (mViewPager.getCurrentItem() == 1) {
                if (state == ViewPager.SCROLL_STATE_DRAGGING) {
                    mHandler.postDelayed(mRun, INTERVAL);
                }
            }
        } 
```

你需要：

```
private ViewPager mViewPager;
private int mCurrentState = -1;
private static int INTERVAL = ViewConfiguration.getLongPressTimeout();
private Handler mHandler = new Handler();
private Runnable mRun = new Runnable() {

    @Override
    public void run() {
        // we got the Runnable to be executed. If we are on the second page
        // and the user let go of the ViewPager in our time frame then start
        // the Activity(also cancel the dozen Runnables that were posted)
        if (mCurrentState == ViewPager.SCROLL_STATE_IDLE
                && mViewPager.getCurrentItem() == 1) {
            mHandler.removeCallbacks(mRun);// or always set it to run
            Intent i = new Intent(PagerTextTouch.this, MainActivity.class);
            startActivity(i);
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-28T04:31:37.580

您将通过以下方式获得查看页面的位置

```
private static class PageListener extends SimpleOnPageChangeListener{
    public void onPageSelected(int position) {
        Log.i(TAG, "page selected " + position);
           currentPage = position;
          } 

} 
```

调用 pageListner

`pageListener = new PageListener(); ViewPager.setOnPageChangeListener(pageListener);`

现在你可以得到视图的位置

# php - 来自 php 和 mysql 的动态变量值在 html Body 标记中工作

> ID：16123401
> 
> 赞同：0
> 
> 时间：2013-04-20T17:50:42.520
> 
> 标签：php, html, mysql

我有一个 php 标签，我也尝试从数据库中检索以获取一些值。然后将这些值声明给变量，然后使用这些变量将值传递给 html body 标签。

PHP：

```
 <?php 
  $sql = "SELECT * FROM productItem;";
            // Write a statement to open a connection to MySQL server
            $link = mysql_connect("localhost:3306", "root", "6i7yvBku");
            // Write a statement to select the required database
            mysql_select_db("KXCLUSIVE", $link);
            // Write a statement to send the SQL statement to the MySQL server for execution and retrieve the resultset
            $resultset = mysql_query($sql);
            // Write a statement to close the connection
            mysql_close($link);

 $year = $row["year"];
 $month = $row["month"];
 ?> 
```

HTML：

```
 <body onload="countdown(year,month)"> 
```

我应该如何将 php 变量（$year 和 $month）放入 html body 标签中（替换 body 标签中的 year 和 month 变量？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:54:47.427

```
<body onload="<?php echo "countdown($year,$month)" ; ?>"> 
```

这应该可以.. 并且为了将来的参考不要使用 mysql_ 他们被贬值了使用 mysqli/PDO [http://php.net/manual/en/changelog.mysql.php](http://php.net/manual/en/changelog.mysql.php)

# sql - 无法在 VS 2010 Ultimate SP1 中管理 .sdf 文件

> ID：16123407
> 
> 赞同：0
> 
> 时间：2013-04-20T17:51:22.777
> 
> 标签：sql, visual-studio-2010, sql-server-ce

每当我尝试`.sdf`在 VS 2010 SP1 Ultimate 中打开本地数据库文件时，我都会收到此错误

> 找不到连接到本地数据文件所需的数据提供者。该文件将添加到项目中，但不会生成与该文件关联的类型化数据集。

我已经安装了适用于 SQL Server Compact 4.0 的 VS 2010 SP1 工具。

基本上我安装了 VS 2010 Express 并且工作得很好，我已经卸载它并安装了 VS 2010 SP1 Ultimate。

![在此处输入图像描述](https://i.stack.imgur.com/P8nwm.png)

我该如何解决这个恼人的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T07:36:57.490

您还必须为 VS 2010 SP1 安装 SQL Server Compact 4.0 工具，我在这里有一个直接链接：http: [//erikej.blogspot.dk/2011/01/sql-server-compact-40-released.html](http://erikej.blogspot.dk/2011/01/sql-server-compact-40-released.html)

# html - 2 个问题：居中 div + CSS 动画

> ID：16123408
> 
> 赞同：0
> 
> 时间：2013-04-20T17:51:27.667
> 
> 标签：html, css, animation

[http://carloshermoso.com/works/rwd/](http://carloshermoso.com/works/rwd/)

你好，

两个不同的问题：

1.- 我在集中服务时遇到问题。它们的左右边距应该相同，与页面的其余部分相同。

id="webDevelopmentServices" 是 3 个服务。class="service" 是每个服务。

2.- 为什么 CSS 动画在 Firefox 中不能正常工作？他们也没有在 IE 中工作。在 Chrome 中虽然都很顺利。

提前一百万谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:56:37.373

尝试这个

```
#mainContent #webDevelopmentServices .service {
    display: inline-block;
    font-size: 15px;
    line-height: 17px;
    margin: 0 2%;
    vertical-align: top;
    width: 21%;
} 
```

使用 display:inline-block 删除“float:left”；

在我的 Firefox 中，动画正在运行。但是当然，css 动画在早期的 IE 中是行不通的，但这是一个全世界都知道的问题 :)

# java - 主要方法和类，在哪里声明？

> ID：16123410
> 
> 赞同：2
> 
> 时间：2013-04-20T17:51:37.747
> 
> 标签：java, class, methods, static

编程新手，java新手。我似乎了解类及其组件、方法等基本部分，但我不知道如何将它们组合在一起。例如，我正在按照教程并尝试编写一个类 Card ，它可以成为基于构造期间传递的 args 的任何卡片。

我的第一个问题是，如果我将类 Card 声明为 public（第 5 行），编译器会说非法的表达式开始。

如果我删除 public，它会继续 println 语句，它抱怨非静态变量不能从静态环境中引用。那是因为我在 main 方法中工作，它总是静态的，对吧？所以，我需要向 Card 添加方法来读取内部状态并将其提供给 println 语句，这样行吗？

```
public class Deck {
    public static void main(String[] args) {

    class Card {
        public int rank;
        public int suit;

        public Card(int startSuit, int startRank) {
            rank = startRank;
            suit = startSuit;
        }
    }

        Card aceOfSpades = new Card(1, 1);
        System.out.println("Card is ..." + Card.rank + " of " + Card.suit);
    }
} 
```

**第二轮** 这是新代码，文件是 Card.java：

`public class Card {`

 ````
 //declare states
        //rank 1-13 for ace-king
        //suit 1-4 spade,heart,club,diamond
        public int rank;
        public int suit;

        //constructor
        public Card(int startSuit, int startRank) {
            rank = startRank;
            suit = startSuit;

        }

        //methods for Card

        public static void main(String[] args) {
            //call Card constructor
            //make card ace of spades (1,1)
            Card aceOfSpades = new Card(1,1);

            //read internal state of new Card object
            //what kind of card is it?
            System.out.println("Card is ..." + rank + " of " + suit);
        }
} 
````  `我平衡​​了我的大括号，主要方法现在是 Card 类的一部分，我认为它看起来更好。oney 编译错误现在与 println 语句中的变量相关联。（不能从静态上下文中引用非静态变量套装。）我认为这意味着我必须编写 getSuit() 和 getRank() 之类的方法来读取变量状态，然后在我的 println 中使用该方法，而不是变量本身？

这种方法看起来像这样，对吧？

`public int getSuit() {`

 ````
 return suit;

} 
````  `（请多多包涵，我的格式不完全正确，我会努力的）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:48:15.010

您的第二个代码几乎是正确的。您只需像这样修改 main 中的代码：

```
 System.out.println("Card is ..." + aceOfSpades.rank + " of " + aceOfSpades.suit); 
```

您对静态是正确的，主要是静态的，他只能访问静态变量。通过添加 aceOfSpades，您可以指定您创建的对象。你有一个参考，你可以阅读内部价值观等级和西装。

但是正如您所建议的，更好的方法是创建 setter/getter 方法：setRank(int), getRank(), .... 您可以替换

```
public int rank;
by 
private int rank; 
```

因此，您的内部值在对象之外受到保护。
请注意，即使您将排名设置为私有，main() 方法仍然可以直接读取排名的值。这是因为 private 意味着只在类中可见，而 main 是你类的一部分。
但是如果你在你的 Deck 对象中实例化一个 Card 对象，它将无法直接读取内容。

隐藏对象内部值的思想是面向对象的基本思想，称为**封装**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:58:11.693

将类`Card`移出方法体 `main()`。所有这些代码都应该在一个与外部类同名的文件中，`Deck.java`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:54:33.730

您的类的名称必须与其文件的名称相匹配。

但是，从 Bill K 的回答中，[我可以编译一个名称与类不同的 java 文件](https://stackoverflow.com/questions/1841847/can-i-compile-a-java-file-with-a-different-name-than-the-class)：

> 只要它们不是公共的，您就可以在同一个文件中包含辅助类。但是它们仍然可以是“默认”的，因此它们仍然可以被同一个包中的其他类使用。
> 
> 大多数情况下不应该这样做。Java 关于类和包的命名模式是它最大的优势之一——让程序员的生活更轻松，无需任何成本。``

# sql - 如何在单词中显示数值

> ID：16123413
> 
> 赞同：2
> 
> 时间：2013-04-20T17:51:44.790
> 
> 标签：sql, oracle, type-conversion, to-date, to-char

Q. 在 Words 中显示数值，输出应该是这样的

```
SAL        In_Words
--------- -----------------------------------------------------
800       eight hundred
1600      one thousand six hundred
1250      one thousand two hundred fifty 
```

而且，我仍然没有弄清楚，这个查询是如何解决上述输出的。

```
select sal, to_char(to_date(sal,'j'),'Jsp') in_words from emp 
```

`to_date`在这里做什么？有人对此查询有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-13T14:16:33.027

那么查询是如何工作的呢？这就是为什么：

```
select to_char(to_date(:number,'j'),'jsp') from dual; 
```

如果你查看查询 to_date(:number,'j') 的最里面部分，'j' 或 J 是儒略日期（公元前 4713 年 1 月 1 日），基本上这个日期被用于天文研究。

所以 to_date(:number,'j') 它取数字代表的数字，假装它是儒略日期，转换成日期。

如果将 3 传递给数字，那么它将日期转换为 4713 年 1 月 3 日 BC，这意味着 3 被添加到儒略日期。

```
select to_char(to_date(3,'j'),'jsp') from dual; 
```

现在 to_char(to_date(3,'j'),'jsp'), jsp = Now; 取那个 date(to_date(3,'j')) 并拼出它所代表的儒略数，输出是：

```
TO_CH
-----
three 
```

使用儒略日期有一个限制，它的范围从 1 到 5373484。这就是为什么如果你把值放在 5373484 之后，它会抛出一个错误，如下所示：

```
ORA-01854: julian date must be between 1 and 5373484 
```

大家好，这个话题很有趣。我记得当我在 2005 年学习 Oracle 时，一位讲师要求我编写一个 PL/SQL 代码来将数字转换为文字，这是整整两页的代码。

这里有一些参考资料可以帮助我们理解儒略日，这就是我们在这个操作中使用字母“j”或“J”的原因。

首先有一个网站有关于“如何使用 Oracle SQL 查询将数字转换为单词”的示例和说明：

[http://viralpatel.net/blogs/convert-number-into-words-oracle-sql-query/](http://viralpatel.net/blogs/convert-number-into-words-oracle-sql-query/)

其次，如果您想了解有关“朱利安日”的更多信息，请访问：

[http://en.wikipedia.org/wiki/Julian_day](http://en.wikipedia.org/wiki/Julian_day)

第三，如果您想了解更多关于谁在 1583 年提出儒略日数的信息，那是“约瑟夫·斯卡利格”：

[http://en.wikipedia.org/wiki/Joseph_Justus_Scaliger](http://en.wikipedia.org/wiki/Joseph_Justus_Scaliger)

我继续重复这些网站中的另一位作者所做的事情是没有意义的，这就是为什么我刚刚发布了您可以访问它们的链接并阅读您需要了解的查询如何工作：

```
SELECT TO_CHAR (TO_DATE (2447834, 'j'), 'jsp') FROM DUAL; 
```

//输出：244.7834万

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T11:25:53.953

要将十进制数转换为单词，您可以按照以下代码

```
SELECT TO_CHAR(to_date(TRUNC(num),'J'),'Jsp')
  ||' and '
  || TO_CHAR(to_date(to_number(SUBSTR(num-TRUNC(num),instr(num-TRUNC(num),'.')+1)),'J'),'Jsp') Indicator
FROM
  (SELECT &enter_numbr num FROM dual
  ); 
```

希望这会有所帮助！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T05:08:03.663

我从未听说过具有内置功能的 DBMS 可以按照您的要求进行操作。您将需要一个数字名称表，使用模算术将每个数字连接一次，并使用字符串连接来生成一个 In_Words 列。加上一些逻辑来消除前导零。需要时间来写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T13:07:06.517

J 代表儒略日 - 自公元前 4712 年 1 月 1 日以来的天数。表中的数字转换为儒略日期。JSP 拼出日期：

```
SELECT to_char(SYSDATE,'JSP') AS number_of_days_sinse_4712_BC
  FROM dual
/ 
```

# ios - 无法使内容阻力在表格视图单元格中起作用

> ID：16123415
> 
> 赞同：1
> 
> 时间：2013-04-20T17:51:45.587
> 
> 标签：ios, xcode, autolayout

我有一个 UITableViewController，它有一个显示位置的静态字段。这个静态字段的样式是“正确的细节”。单元格的左侧显示用户选择的城市，右侧有一个带有标签“项目位置”的披露指示器。

当用户第一次导航到此控制器时，左侧标签设置为“无位置”，一切看起来都很好，如下所示：（我无法发布图像，因为我没有代表）
“无位置项目位置>”

问题是，如果我设置一个长城市名称（例如“Rancho Santa Margarita, California”），“Item Location”标签会缩小并填充省略号（...）
“Rancho Santa Margarita, California It...>”

我想要发生的是，当用户选择一个长城市名称时，城市标签将占用尽可能多的空间，而不会导致“项目位置”标签缩小。所以基本上它看起来像这样：
“Rancho Santa Margarita, ... Item Location >”

使用界面生成器，我尝试将右侧细节标签（项目位置）的水平内容拥抱优先级和抗压优先级设置为 1000，我什至将城市标签的水平内容拥抱优先级和抗压优先级设置为 1，但这并没有似乎不起作用。（它看起来仍然像第二个屏幕截图）。

还有一件事，当用户选择一个新位置时，我使用以下方法来更新位置文本：

```
- (void)setLocationText:(NSString *)text {
    self.locationField.textLabel.text = text;
    [self.locationField setNeedsLayout];
} 
```

其中 locationField 是位置 UITableViewCell 的一个出口。如果没有城市文本标签的代码，`setNeedsLayout`则无法适应城市名称，这就是我使用它的原因。

我正在使用 XCode 4.6 并针对 iOS 6.1

你们知道可能是什么问题吗？

提前致谢， 伊多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:31:59.903

使用自动布局的另一种选择是使用`UITableViewCell`两个标签出口进行子类化并实现`layoutSubviews`

```
- (void)layoutSubviews {
    [super layoutSubviews];

    CGSize rightLabelSize = [self.rightLabel sizeThatFits:self.contentView.frame.size];

    CGRect rightLabelFrame = CGRectZero;
    rightLabelFrame.origin.x = self.contentView.frame.size.width - rightLabelSize.width;
    rightLabelFrame.size = rightLabelSize;
    self.rightLabel.frame = rightLabelFrame;

    CGRect leftLabelFrame = CGRectZero;
    leftLabelFrame.size.width = self.contentView.frame.size.width - rightLabelSize.width;
    self.leftLabel.frame = rightLabelFrame;
} 
```

请注意，这不会添加填充或真正关心标签的高度，因此您需要进行修改以解决这些问题。

如果您不喜欢子类化，那么您可以在返回控制器`tableView:cellForRowAtIndexPath:`协议方法中的单元格之前构造和调整标签大小。

# java - 完成多个任务时Android执行

> ID：16123417
> 
> 赞同：0
> 
> 时间：2013-04-20T17:51:52.107
> 
> 标签：java, android

我正在开发一个在检测到 NFC 卡后从我的服务器下载信息的应用程序。

当检测到卡时，我开始 - 一个从我的服务器下载一些数据的异步任务 - 屏幕上出现一个弹出动画

在异步任务和动画都完成后，我想启动一个在弹出窗口中显示下载数据的方法。

触发这种新方法的正确方法是什么？只有同时满足两个条件才能启动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:57:45.897

在用于下载数据的异步任务中，添加 onPostExecute 方法以删除动画弹出窗口并显示下载的数据，如下所示：

```
 protected void onPostExecute(Long result) {
     //put code to disable animation popup
     //code for displaying downloaded data popup
 } 
```

有关更多信息，请查看[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:55:16.067

你`Animation`的对象有方法`setAnimationLister`。它将实现接口的类对象作为参数`Animation.AnimationListener`。该接口需要实现三个方法：

```
@Override
public void onAnimationStart(Animation animation) {

}

@Override
public void onAnimationEnd(Animation animation) {

}

@Override
public void onAnimationRepeat(Animation animation) {

} 
```

`onAnimationEnd`动画结束时触发。如果我没有误解你，这就是你需要的

编辑：

你可以有两个布尔值，`boolean animationFinished = false, downloadFinished = false`; 何时`onPostExecute`调用 put`downloadFinished`为 true 并调用`yourMethod`。何时`onAnimationEnd`触发`animationFinished = true`并调用`yourMethod`. `yourMethod` 应该像这样开始：

```
if (!animationFinished || !downloadFinished)
 return; 
```

# html - 如何防止浏览器的宽度影响文本的垂直位置？

> ID：16123419
> 
> 赞同：0
> 
> 时间：2013-04-20T17:52:08.670
> 
> 标签：html, css

我有以下 HTML 和 CSS

```
<body>
<p>Foo Foo Foo</p>
</body>

p {
    font-size: 50px;
    font-weight: 600;
    margin-top: 20%;
} 
```

如果您要在浏览器中打开此代码，减小浏览器的宽度会使文本向上移动。避免这种情况的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:01:12.897

该`margin-top`值是根据视口（屏幕窗口）的宽度计算得出的。

您需要使用另一个相对单位`em`或绝对单位，如`px`.

这部分取决于您尝试创建的效果。

请参阅参考：[http ://www.w3.org/TR/CSS2/box.html#margin-properties](http://www.w3.org/TR/CSS2/box.html#margin-properties)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:07:34.303

我假设你对此无能为力。即使你做了一些事情来让它工作（比如让容器成为内联元素），它也将是一个 hack。

> 百分比是根据生成框的包含块的宽度计算的。'margin-top' 和 'margin-bottom' 也是如此。

[在W3](http://www.w3.org/TR/2011/REC-CSS2-20110607/box.html#margin-properties)阅读更多

# sql - 一个表单的多个实例中的 SQL 查询范围

> ID：16123420
> 
> 赞同：1
> 
> 时间：2013-04-20T17:52:14.227
> 
> 标签：sql, delphi, delphi-xe3

我有一个可以打开多个实例的表单。在那里，我使用 SQL 查询从数据库（在本例中为绝对数据库）读取一些数据。然后我用数据填写一些变量，并在表单的生命周期内使用查询进行其他操作。

问题是，当我打开多个表单实例时，旧表单上的数据会更改为上次打开表单的值。

我在打开表单时创建了查询，所以我认为它们不会共享相同的数据。

我不使用自动创建的表单。

如何避免这种情况发生？

** 编辑 - 添加了一些代码 **

我创建的表格如下：

```
procedure TfrmMain.OpenFormsFunction(Sender: TObject);
var
  Resultater:   TfrmregResultat;
begin
// Some code for checking if forms are already open
// Locate record in table to be used as paramdata in the query in the newly opened form
DataX.tStevneHead.Locate('StevneNummer;GrenType', VarArrayOf([StevneNummer, GrenType), []);
Resultater := TfrmRegResultat.Create(nil);
Resultater.Show; // OnClose action for the form is caFree
end; 
```

从表单的代码中截取

```
// decleared in implementation
Dato:        TDate;
GrenType:    string;
GrenRunder:  integer;
MaxPoeng:    integer;

procedure TfrmRegResultat.FormShow(Sender: TObject);
begin
//-- qStevneHead is a TABSQuery component on the form
//-- DataX is the name of my DataModule
with qStevneHead do
begin
  Close;
  SQL.Clear;
  SQL.Text := 'SELECT * FROM StevneHead WHERE GrenType = :aGrenType AND StevneNummer =  aStevneNummer';
  ParamByName('aGrenType').AsString := DataX.tStevneHead.FieldByName('GrenType').Value;
  ParamByName('aStevneNummer').AsString := DataX.tStevneHead.FieldByName('StevneNummer').Value;
  Open;
end;
GrenRunder := qStevneHead.FieldByName('AntallRunder').Value;
Dato := qStevneHead.FieldByName('Dato').AsDateTime;
GrenType := qStevneHead.FieldByName('GrenType').Value;
MaxPoeng := qStevneHead.FieldByName('MaxPoeng').Value;
// More code to init stringgrid and other stuff on the form
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:21:22.637

问题似乎是您正在使用全局变量。将它们更改为表单的字段，您的问题应该得到解决。IOW，现在你有

```
implementation

var
  Dato:        TDate;
  GrenType:    string;
  GrenRunder:  integer;
  MaxPoeng:    integer; 
```

将其更改为

```
type
  TfrmRegResultat = class(...)
  ...
  private
    Dato:        TDate;
    GrenType:    string;
    GrenRunder:  integer;
    MaxPoeng:    integer;
   ...
  end; 
```

如果您需要从程序的其他部分（即在主窗体中）访问值，则将它们设为公共属性或字段并通过当前活动的窗体变量访问它们。

# jsf - Primefaces 3.5 dataexporter 不导出值 p:cellEditor

> ID：16123422
> 
> 赞同：1
> 
> 时间：2013-04-20T17:52:22.870
> 
> 标签：jsf, primefaces

我想从我的表中导出值。

但是，我的列看起来像这样：

```
<p:column headerText="Special Remarks" style="width:15%">
    <p:cellEditor>
        <f:facet name="output">
            <h:outputText value="#{product.specialRemarks}" />
        </f:facet>
        <f:facet name="input">
            <p:inputText value="#{product.specialRemarks}" style="width:96%" />
        </f:facet>
    </p:cellEditor>
</p:column> 
```

当我导出`org.primefaces.component.celleditor.CellEditor@446d0c6a`每个单元格中的文件时？

知道如何解决吗？

# delphi - 如何确定 StdOut 和 StdError 的正确顺序/缓冲区

> ID：16123427
> 
> 赞同：0
> 
> 时间：2013-04-20T17:53:42.287
> 
> 标签：delphi, console, console-application, pipe

我有一个外部控制台应用程序，我想将它的**完整**输出（StdOut 和 StdError）实时捕获到备忘录中（就像我双击它一样）。

带有屏幕截图的应用程序信息： [Delphi 控制台管道已切换？](https://stackoverflow.com/questions/16122084/delphi-console-pipes-switched)

我写了一个单元来读取管道：

```
unit uConsoleOutput;
interface

uses  Classes,
      StdCtrls,
      SysUtils,
      Messages,
      Windows;

  type
  ConsoleThread = class(TThread)
  private
    OutputString : String;
    procedure SetOutput;
  protected
    procedure Execute; override;
  public
    App           : WideString;
    Memo          : TMemo;
    Directory     : WideString;
  end;

  type
    PConsoleData = ^ConsoleData;
    ConsoleData = record
    OutputMemo          : TMemo;
    OutputApp           : WideString;
    OutputDirectory     : WideString;
    OutputThreadHandle  : ConsoleThread;
  end;

function StartConsoleOutput (App : WideString; Directory : WideString; Memo : TMemo) : PConsoleData;
procedure StopConsoleOutput  (Data : PConsoleData);

implementation

procedure ConsoleThread.SetOutput;
begin
  Memo.Lines.BeginUpdate;
  Memo.Text := Memo.Text + OutputString;
  Memo.Lines.EndUpdate;
end;

procedure ConsoleThread.Execute;
const
  ReadBuffer = 50;
var
  Security    : TSecurityAttributes;
  InputPipeRead,
  InputPipeWrite,
  OutputPipeRead,
  OutputPipeWrite,
  ErrorPipeRead,
  ErrorPipeWrite : THandle;
  start       : TStartUpInfo;
  ProcessInfo : TProcessInformation;
  Buffer      : Pchar;
  BytesRead   : DWord;
  Apprunning  : DWord;
begin
  Security.nlength := SizeOf(TSecurityAttributes) ;
  Security.lpsecuritydescriptor := nil;
  Security.binherithandle := true;
  if Createpipe (InputPipeRead, InputPipeWrite, @Security, 0) then begin
    if CreatePipe(OutputPipeRead, OutputPipeWrite, @Security, 0) then begin
      if CreatePipe(ErrorPipeRead, ErrorPipeWrite, @Security, 0) then begin
        Buffer := AllocMem(ReadBuffer + 1) ;
        FillChar(Start,Sizeof(Start),#0) ;
        start.cb := SizeOf(start) ;
        start.hStdOutput  := OutputPipeWrite;
        start.hStdError   := ErrorPipeWrite;
        start.hStdInput   := InputPipeRead;
        start.dwFlags     := STARTF_USESTDHANDLES + STARTF_USESHOWWINDOW;
        start.wShowWindow := SW_HIDE;
        if CreateProcessW(nil,pwidechar(APP),@Security,@Security,true,NORMAL_PRIORITY_CLASS,nil,pwidechar(Directory),start,ProcessInfo) then begin
          while not(terminated) do begin

          // ====> Stuck here.
            // ReadErrorPipe
            BytesRead := 0;
            if Terminated then break;
            ReadFile(ErrorPipeRead,Buffer[0], ReadBuffer,BytesRead,nil);
            if Terminated then break;
            Buffer[BytesRead]:= #0;
            if Terminated then break;
            //OemToAnsi(Buffer,Buffer);
            if Terminated then break;
            OutputString := Buffer;
            if Terminated then break;
            Synchronize(SetOutput);

            // ReadStdOut
            BytesRead := 0;
            if Terminated then break;
            ReadFile(OutputPipeRead,Buffer[0], ReadBuffer,BytesRead,nil);
            if Terminated then break;
            Buffer[BytesRead]:= #0;
            if Terminated then break;
            //OemToAnsi(Buffer,Buffer);
            if Terminated then break;
            OutputString := Buffer;
            if Terminated then break;
            Synchronize(SetOutput);

            end;
          FreeMem(Buffer);
          CloseHandle(ProcessInfo.hProcess);
          CloseHandle(ProcessInfo.hThread);
          CloseHandle(InputPipeRead);
          CloseHandle(InputPipeWrite);
          CloseHandle(OutputPipeRead);
          CloseHandle(OutputPipeWrite);
          CloseHandle(ErrorPipeRead);
          CloseHandle(ErrorPipeWrite);
        end;
      end;
    end;
  end;
end;

function StartConsoleOutput (App : WideString; Directory : WideString; Memo : TMemo) : PConsoleData;
begin
  result                          := VirtualAlloc(NIL, SizeOf(ConsoleData), MEM_COMMIT or MEM_RESERVE, PAGE_EXECUTE_READWRITE);
  Memo.DoubleBuffered             := TRUE;
  with PConsoleData(result)^ do begin
    OutputMemo                          := Memo;
    OutputApp                           := App;
    OutputDirectory                     := Directory;
    OutputThreadHandle                  := ConsoleThread.Create(TRUE);
    OutputThreadHandle.FreeOnTerminate  := TRUE;
    OutputThreadHandle.Memo             := Memo;
    OutputThreadHandle.App              := App;
    OutputThreadHandle.Directory        := Directory;
    OutputThreadHandle.Resume;
  end;
end;

procedure StopConsoleOutput  (Data : PConsoleData);
begin
  with PConsoleData(Data)^ do begin
    OutputThreadHandle.Terminate;
    while not(OutputThreadHandle.Terminated) do sleep (100);
  end;
  VirtualFree (Data,0, MEM_RELEASE);
end;

end. 
```

我开始这样的应用程序：

```
StartConsoleOutput ('C:\myexternalapp.exe', 'C:\', Memo1); 
```

我想先输出stderror，然后输出stdoutput（或者至少按照控制台输出的1:1顺序）问题是顺序和正确的缓冲区大小。

如何以正确的顺序读取这 2 个管道以及使用哪个缓冲区大小来完成 1:1 输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T03:58:18.900

用于[`PeekNamedPipe()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365779.aspx)确定管道何时可以读取数据以及可以读取多少字节。尽管它的名字，它同时适用于命名管道和匿名管道。

# sql - SQL 对一个表中的列进行配对

> ID：16123430
> 
> 赞同：1
> 
> 时间：2013-04-20T17:54:08.733
> 
> 标签：sql, duplicates, derby

我需要通过他们所在的城市配对 2 个供应商名称。

```
<name supplier a> <name supplier b> <location> 
```

我通过交叉连接一个供应商表获得了该表格 - 现在我需要确保它只有一个记录 - 所以要么在代码块顶部，要么：

```
 <name supplier b> <name supplier a> <location> 
```

例子：

Märzen AG | 迈尔幼儿园 | 乌尔姆

或者

迈尔幼儿园 | Märzen AG | 乌尔姆

因此：我只需要上述结果之一。目前，我从 Crossjoin 中获得了两条记录：

```
 SELECT le.Liefname, le.liefstadt, li.Liefname
 FROM Lieferanten le CROSS JOIN Lieferanten li
 WHERE le.Liefstadt not like '' 
 AND li.Liefstadt not like '' 
 AND le.liefstadt=li.liefstadt; 
```

其中liefstadt 是配对它们的城市，liefname 是我需要输出的名称。

我想做的另一种方法是：

```
SELECT a.LiefName, b.LiefName, LiefStadt 
FROM Lieferanten a, Lieferanten b 
WHERE     a.LiefStadt = b.LiefStadt 
AND a.LiefName <> b.LiefName; 
```

这里的问题是结果中仍然存在重复项。

由于我不是母语人士，我希望我能说的足够让您理解我的问题。（因此可能错过了一个已经存在的对我有帮助的话题）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:04:07.950

你只需要调整你的第一种方法：

```
SELECT le.Liefname, le.liefstadt, li.Liefname
 FROM Lieferanten le CROSS JOIN Lieferanten li
 WHERE le.Liefstadt not like '' 
 AND li.Liefstadt not like '' 
 AND le.liefstadt=li.liefstadt
 AND le.Liefname < li.Liefname 
```

我建议您将查询更改为使用联接，以便表之间的条件显而易见。

```
SELECT le.Liefname, le.liefstadt, li.Liefname
 FROM Lieferanten le JOIN
      Lieferanten li
      on le.liefstadt=li.liefstadt and
         le.Liefname < li.Liefname
 WHERE le.Liefstadt not like '' and 
       li.Liefstadt not like '' 
```

虽然不是必需的，但使用`on`条件子句比较两个表中的字段会比将这些条件放在`where`子句中生成更具可读性和可维护性的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:03:51.960

您可以使用`a.LiefName < b.LiefName`总是首先列出最小的名称。如有必要，`DISTINCT`如果表本身有重复项，请添加。

```
SELECT  DISTINCT a.LiefName
,       b.LiefName
,       a.LiefStadt
FROM    Lieferanten a
JOIN    Lieferanten b 
ON      a.LiefStadt = b.LiefStadt 
WHERE   a.LiefStadt <> ''
        and a.LiefName < b.LiefName 
```

# php - Facebook PHP SDK 聊天 API 返回错误

> ID：16123431
> 
> 赞同：0
> 
> 时间：2013-04-20T17:54:23.133
> 
> 标签：php, facebook, facebook-chat

我正在开发使用 facebook 聊天 API 的 facebook 平台应用程序。我尝试使用来自[https://developers.facebook.com/docs/chat/](https://developers.facebook.com/docs/chat/)的示例代码。它返回错误。我试图了解我到底在哪里得到了错误，我发现这部分代码返回 false。

```
if (!find_xmpp($fp,  'MECHANISM', 'X-FACEBOOK-PLATFORM')) {
return false;
} 
```

另外我有一个 xmpp_login 扩展权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:10:04.263

如果有人感兴趣，我找到了解决方案。在 facebook 提供的示例中，所有`<`和`>`标签都表示为 html 字符`&gt;`，`&lt;`它们必须更改为普通标签等`<auth>`。

# events - 在javascript中单击时我的事件侦听器没有任何反应

> ID：16123432
> 
> 赞同：-1
> 
> 时间：2013-04-20T17:54:25.570
> 
> 标签：events, listener

我有这些功能：

```
 createTreeItem: function (num, val)
    {
        const XUL_NS = "http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";

        var i = document.createElementNS(XUL_NS, "treeitem");
        var r = document.createElementNS(XUL_NS, "treerow");
        var c1 = document.createElementNS(XUL_NS, 'treecell');
        var c2 = document.createElementNS(XUL_NS, 'treecell');
        var c3 = document.createElementNS(XUL_NS, 'treecell');

        i.setAttribute("container", true);
        i.setAttribute("open", true);

        c1.setAttribute("label", num);
        c2.setAttribute("label", val);
        c3.setAttribute("value", false);

        r.appendChild(c1); 
        r.appendChild(c2);
        r.appendChild(c3);

        i.appendChild(r);
        i.addEventListener("click", test, false);

        return i;
    } 

    test: function ()
    {
        alert("zero");
    }

    func: function (liste)
    {
        try
        {
            root = document.getElementById("treeRoot");
            var current;

            for(o in liste)
            {
             current = createTreeItem(liste[o].id, liste[o].nom_scenario);
             root.appendChild(current);
            }       
        }
        catch(e)
        {
        alert(e);
        }
    } 
```

我正在树中创建元素，我想在创建的每个元素上添加事件侦听器。问题是什么都没有发生。在代码中，Liste 是一个 json 请求的响应。它包含我想在我的 xul 文件中创建的所有元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:03:16.553

我对这种语法不是很熟悉，但我敢打赌，测试函数不会因为它的定义方式而被“提升”。尝试将“test”函数移到“createTreeItem”函数之上，或者像这样定义测试：

```
function test() {
   ...
} 
```

这样，当它被评估时，它将被“提升”到顶部，这样当您尝试将其添加为单击事件的操作时，它将被定义。不是 100% 确定这是正确的，但如果我不得不打赌……

# magento - 如何编辑 Magento 网站的产品模板

> ID：16123433
> 
> 赞同：0
> 
> 时间：2013-04-20T17:54:26.020
> 
> 标签：magento, ftp

很抱歉问了一个非常基本的问题。实际上我对magento很陌生，因此找不到解决方案..这是问题：

我有一个 magento 电子商务网站，我想编辑网站的产品模板。我有 magento 和 FTP 凭据。但无法弄清楚实际的产品模板在哪里。

我必须在哪个文件夹中查找产品模板文件？

我想在每个产品页面上附加一些 HTML，因此我正在寻找它。请指教。

希望能得到一些帮助。

问候，丰富

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:40:49.607

刚接触 magento 时，调试此类问题的最佳方法是“打开模板路径提示”

1.  登录管理员

2.  转到 -> 系统 -> 配置，然后在列表底部选择“开发人员”</p>

3.  点击 Debug – 你只会看到“Profiler”。这是诀窍——你必须将“当前配置范围：”[在左上角]切换到网站而不是默认值。选择“主网站”。

4.  现在您将看到模板路径提示的选择 - 选中是。这将显示页面每个块的模板路径，以便您找到东西！您也可以选择“Add Block Names to Hints”来查看该块对应的模型类。

哪个会指向 app/design/frontend/[theme]/default/template/catalog/product/*

阅读更多@ [http://www.redlightblinking.com/blog/magento-debugging-how-to-debug-template-paths-logging-and-display-errors](http://www.redlightblinking.com/blog/magento-debugging-how-to-debug-template-paths-logging-and-display-errors)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T23:05:42.577

除了上一个答案之外，请确保禁用缓存，否则您可能不会立即看到结果。

产品页面附有许多文件，但在我看来，主要是最重要的文件是我

media.phtml 控制你的法师大小、更多视图等，然后你有调用 upsell 产品的 upsell.phtml 和组合所有这些文件的 view.phtml。

您可以在以下位置找到它们

应用程序/设计/前端/基础/默认/模板/目录/产品应用程序/设计/前端/基础/默认/模板/目录/产品/视图

复制这些文件并将它们粘贴到您的主题目录中。不要覆盖它们！并且请记住您有：单一产品、可配置产品等，因此如果需要，您还必须编辑这些文件！

希望这会有所帮助，并且始终感谢其他用户的任何反馈。

# java - Java 7 字符串 - 子字符串复杂度

> ID：16123446
> 
> 赞同：25
> 
> 时间：2013-04-20T17:55:42.370
> 
> 标签：java, java-7

在 Java 6 之前，我们在`String`. 在 Java 7 中，为什么他们决定使用复制`char`数组 - 并降低到线性时间复杂度 - 而类似的东西`StringBuilder`正是为此而生的？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-20T18:21:31.030

为什么他们决定在[Oracle 错误 #4513622 中讨论：（str）保留字段的子字符串会阻止对象的 GC](http://bugs.sun.com/view_bug.do?bug_id=4513622)：

> 在示例中调用 String.substring 时，不会分配用于存储的新字符数组。它使用原始字符串的字符数组。因此，支持原始字符串的字符数组不能被 GC，直到子字符串的引用也可以被 GC'd。这是一个有意的优化，以防止在常见场景中使用子字符串时过度分配。不幸的是，有问题的代码遇到了原始数组的开销很明显的情况。很难针对两种边缘情况进行优化。空间/尺寸权衡的任何优化通常都很复杂，并且通常可能是特定于平台的。

还有这个[注释](http://mail.openjdk.java.net/pipermail/core-libs-dev/2012-May/010257.html)，指出根据测试，曾经的优化已经变成了悲观：

> 长期以来，一直在准备和计划从 java.lang.String 中删除 offset 和 count 字段。这两个字段使多个 String 实例能够共享相同的支持字符缓冲区。共享字符缓冲区是旧基准测试的重要优化，但对于当前现实世界的代码和基准测试，实际上最好不共享后备缓冲区。共享 char 数组后备缓冲区只有在大量使用 String.substring 时才会“获胜”。负面影响的情况可能包括解析器和编译器，但当前的测试表明，总体而言，这种变化是有益的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-20T18:07:23.220

如果您有一个短寿命的大父字符串的长寿命小子字符串，则支持父字符串的大 char[] 将不符合垃圾收集条件，直到小子字符串超出范围。这意味着子字符串占用的内存可能比人们预期的要多得多。

Java 6 方式唯一一次表现得更好是有人从一个大的父字符串中取出一个大的子字符串，这是一种非常罕见的情况。

显然，他们认为这种变化带来的微小性能成本被旧方法引起的隐藏内存问题所抵消。决定因素是问题被隐藏了，而不是有解决方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-17T13:53:58.663

这将对后缀数组等数据结构的复杂性产生相当大的影响。Java 应该提供一些替代方法来获取原始字符串的一部分。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-04-18T05:29:25.953

这只是他们修复一些 JVM 垃圾收集限制的糟糕方式。

在 Java 7 之前，如果我们想避免垃圾回收不工作的问题，我们总是可以复制子字符串而不是保留子字符串引用。这只是对复制构造函数的额外调用：

```
String smallStr = new String(largeStr.substring(0,2)); 
```

但是现在，我们不能再有一个恒定时间的子字符串了。这悲剧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-09T18:52:59.470

`String`我相信，主要动机是它的最终“共同定位” `char[]`。现在它们定位在远处，这是对缓存行的主要惩罚。如果每个人都`String`拥有它`char[]`，JVM 可以将它们合并在一起，读取速度会快得多。

# javascript - 扩展 Ember LinkView

> ID：16123451
> 
> 赞同：1
> 
> 时间：2013-04-20T17:56:05.063
> 
> 标签：javascript, ember.js

Ember.LinkView，把手 {{linkTo}} 帮助器背后的视图类现在在 Ember 1.0 RC2 中是公共的。我想扩展它，这样我就可以创建一个自定义视图，而无需为链接添加额外的嵌套标签。

例如：

```
App.MyLinkView = Ember.LinkView.extend({
    namedRoute: 'another'
}); 
```

然后

```
{{#view App.MyLinkView}}LinkView to another route{{/view}} 
```

仔细查看源代码，运气不佳，因为它不断抛出错误。这是一个标准 {{linkTo}} 工作的 jsfiddle，并且 LinkView 尝试已被注释掉，因此它不会引发错误。

[http://jsfiddle.net/HgmEy/1/](http://jsfiddle.net/HgmEy/1/)

* * *

**编辑：**

这是一个更现实的示例，说明您为什么要这样做：http: [//jsfiddle.net/HgmEy/3/](http://jsfiddle.net/HgmEy/3/)

所需的功能在这里使用常规视图工作，但是最好使用 LinkView 以避免额外的 dom 元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-12T03:23:28.373

我需要这样做来覆盖`Ember.LinkView`的调用`transitionTo`，以便为过渡之间的 jQuery 动画提供解决方案。在我看来，有几种可行的方法可以覆盖 LinkView。我成功的第二个是 Trek 的最后一个选项，而且更简单。这是方法#2：

# 方法#2

```
{{#linkTo 'items' this eventName="myEvent"}} Link to {{title}} {{/linkTo}} 
```

现在重写应用范围的 LinkView：

```
Ember.LinkView.reopen({
  // this handler is still called on click, but
  // if we specify eventName in our template,
  // we can call that handler only when we need to,
  // or not at all
  click: function (e) {
    var evtName = this.get('eventName');

    // transitionTo was already invoked by
    // this._invoke() if evtName was `click`
    if (evtName === 'click') return;

    e.preventDefault();

    // do some stuff here

    var args = [].slice.call(arguments);
    this.trigger.apply(this, [evtName].concat(args));
  }
}); 
```

* * *

# 方法#1

我想出的第一个方法是扩展`Ember.LinkView`和创建自定义 Handlebars 助手。Ember 源代码在这里阅读起来非常方便，但我不得不重写一个私有方法，所以我认为这不是很理想。这是实现。请记住，我试图控制 View 何时触发`transitionTo`：

```
{{#appLinkTo 'items' this}} Link to {{title}} {{/appLinkTo}} 
```

现在编码吧！

```
App.LinkView = Ember.LinkView.extend({
  // always called after this.invoke(),
  // which calls transitionTo
  click: function (e) {
    e.preventDefault();
  },

  // already bound to the click event by this.init().
  // our click handler above always gets called after this one
  _invoke: function (event) {
    // we need to simulate the old _invoke if we
    // want to override its call to transitionTo
    // 
    // https://github.com/emberjs/ember.js/blob/v1.0.0/packages/ember-routing/lib/helpers/link_to.js#L297
    var isSimpleClick = Ember.ViewUtils.isSimpleClick;
    if (!isSimpleClick(event)) { return true; }
    event.preventDefault();
    if (this.bubbles === false) { event.stopPropagation(); }
    if (this.get('_isDisabled')) { return false; }

    if (this.get('loading')) {
      Ember.Logger.warn("This link-to is in an inactive loading state because at least one of its parameters presently has a null/undefined value, or the provided route name is invalid.");
      return false;
    }

    // now we can start messing around
    var routeArgs = this.get('routeArgs');
    // routeArgs seems to have format ['routeName', models for dynamic segments]
    this.set('routeArgs', ['group', routeArgs[1]]);

    // if we use:
    this.get('controller').send('someAction', routeArgs);

    // the controller can do in its `someAction` handler:
    // `this.transitionToRoute.apply(this, routeArgs);`
  }
});

// besides the naming, this is verbatim from the end of:
// https://github.com/emberjs/ember.js/blob/v1.0.0/packages/ember-routing/lib/helpers/link_to.js
Ember.Handlebars.registerHelper('app-link-to', function(name) {
    var options = [].slice.call(arguments, -1)[0],
        params = [].slice.call(arguments, 0, -1),
        hash = options.hash;

    hash.disabledBinding = hash.disabledWhen;
    hash.parameters = {
      context: this,
      options: options,
      params: params
    };

    return Ember.Handlebars.helpers.view.call(this, App.LinkView, options);
});

Ember.Handlebars.registerHelper('appLinkTo', Ember.Handlebars.helpers['app-link-to']); 
```

* * *

# 方法#3

如果你想要两者兼得，你可以结合这两个方法和 extend `Ember.LinkView`，创建一个自定义的 Handlebars 助手，并使用自定义事件名称来表示你想要采取的行动。这样，就不需要覆盖`Ember.LinkView`和覆盖。`_invoke`

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T19:35:01.780

LinkView 旨在通过帮助程序创建，该帮助程序传递（并为某些选项提供默认值）。

尝试确定您的自定义类是否存在时会发生错误 `active`。您需要执行以下操作之一

*   使用 App.MyLinkView 时传递或提供预期的默认选项
*   覆盖`active`函数并实现你需要的
*   只需将选项传递给`{{linkTo}}`您想要的行为
*   重新打开 Ember.LinkView 以提供您想要的应用程序范围的行为

# css - edit_object_path(object) 带我到丢失的模板

> ID：16123452
> 
> 赞同：0
> 
> 时间：2013-04-20T17:56:10.250
> 
> 标签：css, ruby-on-rails

在我的应用程序中，这一行将我带到缺少的模板页面：

`<%= link_to 'Edit', edit_edition_path(edition), :class => "btn btn-custom-primary" %>`

我的控制器看起来正确：

```
def edit
    @edition = Edition.find(params[:id])
end 
```

不知道怎么了。我还有两个其他对象可以使用此方案。我确实通过脚手架创建了它们，并`Edition`手动创建了它们。有任何想法吗？谢谢。

# c# - 在 C# 中读取串行端口的格式不正确

> ID：16123453
> 
> 赞同：0
> 
> 时间：2013-04-20T17:56:23.783
> 
> 标签：c#, arduino

我正在使用 C# 从 Arduino 板上读取数据。

在 C# 中，我有以下内容：

```
// Write a string
port.Write("x");

Thread.Sleep(50);
SerialPortRead(); 
```

...`SerialPortRead()`我有：

```
private static void SerialPortRead()
{
    port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
}

private static void port_DataReceived(object sender,SerialDataReceivedEventArgs e)
{
    Console.WriteLine(port.ReadExisting());
} 
```

并且，输出看起来像：

```
329327

32

7

327

3

26

327

3

26

32

7 
```

我做错了什么？输出应该是 326-329 左右，这个值来自一个指南针，该指南针连接到我从 Arduino 读取的引脚之一。

注意：

在 Arduino 中，我有一个串行读取方法来监视输入字符 x 并返回指南针的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:06:06.127

我猜你的阅读速度比指南针的书写速度要快。因此，您的程序认为它正在接收两个方向，而如果它延迟读取一点，它只会收到一个。

如果您将读取的数据分组为三个数字，我们会在您期望的范围内获得方向，这一假设得到了支持。

在发送触发字符后尝试在读取之前添加延迟，甚至更好 - 添加控制字符以表示指南针已写入整个方向，然后读取直到收到该字符。

编辑：我现在注意到你已经睡了 - 所以剩下的选项是分离/终止字符。

# java - 为什么我的 notify() 不起作用？

> ID：16123456
> 
> 赞同：0
> 
> 时间：2013-04-20T17:56:43.590
> 
> 标签：java, multithreading, wait, synchronized, notify

我的 notifyAll() 方法似乎都没有工作。露西应该等到鲍勃到达然后释放。Bob 应该等待 Lucy 的确认然后释放。这些事情似乎都没有发生。

有人可以让我知道我做错了什么以及如何解决它。提前致谢。

编辑 - 我使用 Grays 的建议修改了我的代码。异常消失了，但 notify() 方法似乎仍然不起作用。

```
import java.util.logging.Level;
import java.util.logging.Logger;

public class PlayDates {
    Thread lucyThread;
    Girl lucy;
    Thread bobThread;
    Boy bob;

    public static void main(String[] args) {
        PlayDates playDates = new PlayDates();
        playDates.run();
    }
    public void run() {
        lucy = new Girl();
        lucyThread = new Thread(lucy);

        bob = new Boy();
        bobThread = new Thread(bob);

        lucyThread.start();
        threadSleep(500);
        bobThread.start();
    }

    public class Girl implements Runnable {
        @Override
        public void run() {
            synchronized(PlayDates.this){
                System.out.println("Girl synchronized hit");
                if(!bob.hasArrived()) {     // Doesnt seem to get past here?
                    System.out.println("Lucy has fallen asleep waiting for Bob");
                    try {
                        PlayDates.this.wait();  // Wait for Bob
                        System.out.println("Lucy has woken up");
                        PlayDates.this.notifyAll();     // Acknowledge Bobs arrival
                    } catch (InterruptedException ex) {
                        Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            }
        }
    }

    public class Boy implements Runnable {
        private boolean hasArrived;

        @Override
        public void run() {
            synchronized(PlayDates.this){
                System.out.println("Bob has arrived to play");
                PlayDates.this.notifyAll();
                try {
                    PlayDates.this.wait();  // Wait for Lucy to acknowledge Bobs arrival
                } catch (InterruptedException ex) {
                    Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
                }

                System.out.println("Bob and Lucy are playing");
            }
        }

        public Boy() {
            hasArrived = true;
        }

        public boolean hasArrived() {
            return hasArrived;
        }
    }

    public void threadSleep(int milli) {
        try {
            Thread.sleep(milli);
        } catch (InterruptedException ex) {
            Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

电流输出

```
Girl synchronized hit
Bob has arrived to play 
```

* * *

编辑 2 我已经按照 Grays 的建议调整了我的代码。hasArrived 现在是 volatile 并且在 playDates 运行方法中。它在内部类 Boys run 方法中更改为 true。输出没有改变，问题似乎是一样的。有什么进一步的建议吗？

更新代码：

```
import java.util.logging.Level;
import java.util.logging.Logger;

public class PlayDates {
    Thread lucyThread;
    Girl lucy;
    Thread bobThread;
    Boy bob;
    volatile boolean hasArrived;

    public static void main(String[] args) {
        PlayDates playDates = new PlayDates();
        playDates.run();
    }
    public void run() {
        hasArrived = false;
        lucy = new Girl();
        lucyThread = new Thread(lucy);

        bob = new Boy();
        bobThread = new Thread(bob);

        lucyThread.start();
        threadSleep(500);
        bobThread.start();
    }

    public class Girl implements Runnable {
        @Override
        public void run() {
            synchronized(PlayDates.this){
                System.out.println("Girl synchronized hit");
                if(hasArrived) {     // Doesnt seem to get past here?
                    System.out.println("Lucy has fallen asleep waiting for Bob");
                    try {
                        PlayDates.this.wait();  // Wait for Bob
                        System.out.println("Lucy has woken up");
                        PlayDates.this.notifyAll();     // Acknowledge Bobs arrival
                    } catch (InterruptedException ex) {
                        Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            }
        }
    }

    public class Boy implements Runnable {
        @Override
        public void run() {
            threadSleep(1000);
            synchronized(PlayDates.this){
                System.out.println("Bob has arrived to play");
                hasArrived = true;
                PlayDates.this.notifyAll();
                try {
                    PlayDates.this.wait();  // Wait for Lucy to acknowledge Bobs arrival
                } catch (InterruptedException ex) {
                    Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
                }
                System.out.println("Bob and Lucy are playing");
            }
        }
    }

    public void threadSleep(int milli) {
        try {
            Thread.sleep(milli);
        } catch (InterruptedException ex) {
            Logger.getLogger(PlayDates.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:58:22.377

您`Girl`在初始化字段之前启动线程，`bob`因此您将获得 NPE。您应该*在之前*`bob`初始化您的字段并将其传递给该线程。您的程序可能在某些情况下工作，但存在不可预测的竞争条件。如果线程启动得足够快，它可能会工作，但您应该在启动线程*之前进行*初始化。 *`Girl``bob` *`Girl`**

 **您还有一些[内存同步问题](http://docs.oracle.com/javase/tutorial/essential/concurrency/memconsist.html)。例如，虽然您在 上进行同步，但线程调用时`PlayDates.this`，`Boy`该类可能尚未初始化和同步。每当在多个线程中访问一个字段时，您需要确保两个线程都看到正确同步的值。您可以通过设置为 be或标记为be来确保这一点。`Girl``bob.hasArrived()``hasArrived``AtomicBoolean``hasArrived``volatile`

**编辑：**

问题正在改变，所以我会努力跟上。我建议*不要*在构造函数中设置`hasArrived`为 true 。`Boy`我认为你应该做到`volatile`并在`run()`方法中设置。您希望`Girl`线程启动、运行一点，然后看到它`Boy`不可用并且`wait()`. 所以`Boy`线程应该稍后开始`hasArrived`，并`true`在.`run()``sleep()`**

# sql - 提取 50 个 RSS 提要并根据数据库检查帖子的唯一性 [效率建议]

> ID：16123457
> 
> 赞同：0
> 
> 时间：2013-04-20T17:56:50.903
> 
> 标签：sql, database, rss, performance

我想尽可能高效地将几个 RSS 提要提取到数据库中。

我的网站每 4 小时会抓取 50 个 RSS 提要 - 我只想将独特的帖子添加到数据库中。我有点坚持如何检查帖子的唯一性。我在想我可以比较 URL 值，当第一篇文章不是唯一的时，我可以跳出循环。

所以我的问题是 - 最好拉出所有帖子并根据数组检查每个提要帖子，直到出现一个重复项（然后中断）。或者最好从每个 RSS 提要中搜索数据库中的第一个帖子 - 然后只将其存储在一个数组中并检查新抓取的帖子。

我想当我在这里时，我不妨问问我是否应该为每个单独的提要创建一个表格。我一次只存储 5 个帖子，所以现在它只有一个表，我只有一个列来标识每个提要。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T05:00:09.267

让 DBMS 处理唯一性：插入所有潜在记录，`where not exists`以筛选出现有记录。

您所说的内容中没有任何内容向我表明您需要为每个提要提供一个表格。

如果不了解相关 DBMS，任何人都无法回答效率问题。但是，根据经验，您最好使用更大的工作块和更少的事务。一次存储 5 行可能比一次存储 5000 行慢很多。

# python - virtualenvwrapper 和 Python 3

> ID：16123459
> 
> 赞同：121
> 
> 时间：2013-04-20T17:57:10.093
> 
> 标签：python, python-3.x, virtualenvwrapper

我在 ubuntu lucid 上安装了 python 3.3.1 并成功创建了一个 virtualenv，如下所示

```
virtualenv envpy331 --python=/usr/local/bin/python3.3 
```

这`envpy331`在我的主目录上创建了一个文件夹。

我也`virtualenvwrapper`安装了。但在文档`2.4-2.7`中只支持的版本。`python`有没有人试图组织`python3`virtualenv ？如果是这样，你能告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2014-06-09T11:25:48.440

如果您已经安装了 python3 以及 virtualenvwrapper，那么在虚拟环境中使用 python3 唯一需要做的就是使用以下命令创建环境：

```
which python3 #Output: /usr/bin/python3
mkvirtualenv --python=/usr/bin/python3 nameOfEnvironment 
```

或者，（至少在 OSX 上使用 brew）：

```
mkvirtualenv --python=`which python3` nameOfEnvironment 
```

开始使用环境，你会看到只要你输入 python，你就会开始使用 python3

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-08-23T15:45:31.413

您可以让 virtualenvwrapper 使用自定义 Python 二进制文件，而不是运行一个 virtualenvwrapper。为此，您需要使用 virtualenv 使用的 VIRTUALENV_PYTHON 变量：

```
$ export VIRTUALENV_PYTHON=/usr/bin/python3
$ mkvirtualenv -a myproject myenv
Running virtualenv with interpreter /usr/bin/python3
New python executable in myenv/bin/python3
Also creating executable in myenv/bin/python
(myenv)$ python
Python 3.2.3 (default, Oct 19 2012, 19:53:16) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information. 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-04-20T18:12:00.153

最新版本的[virtualenvwrapper](https://bitbucket.org/dhellmann/virtualenvwrapper/overview)在 Python3.2 下测试。很有可能它也可以与 Python3.3 一起使用。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-05-23T08:40:43.773

在 Ubuntu 上；using 使用`mkvirtualenv -p python3 env_name`python3 加载 virtualenv。

在 env 中，用于`python --version`验证。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2016-12-06T07:37:01.620

virtualenvwrapper 现在允许您指定没有路径的 python 可执行文件。

所以（至少在 OSX 上）`mkvirtualenv --python=python3 nameOfEnvironment`就足够了。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2018-01-17T04:16:48.727

您可以将其添加到您的 .bash_profile 或类似文件中：

```
alias mkvirtualenv3='mkvirtualenv --python=`which python3`' 
```

然后在要创建 python 3 环境时使用`mkvirtualenv3`而不是。`mkvirtualenv`

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-04-14T10:16:12.357

我发现跑步

```
export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3 
```

和

```
export VIRTUALENVWRAPPER_VIRTUALENV=/usr/bin/virtualenv-3.4 
```

在 Ubuntu 的命令行中强制 mkvirtualenv 使用 python3 和 virtualenv-3.4。还有一件事情要做

```
mkvirtualenv --python=/usr/bin/python3 nameOfEnvironment 
```

创造环境。这是假设您在 /usr/bin/python3 中有 python3，在 /usr/local/bin/virtualenv-3.4 中有 virtualenv-3.4。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-07-10T00:09:56.103

这篇关于[virtualenvwrapper的 bitbucket 问题跟踪器的](http://virtualenvwrapper.readthedocs.org/en/latest/)[帖子](https://bitbucket.org/virtualenvwrapper/virtualenvwrapper/issues/167/virtualenvwrapper_get_site_packages_dir-is)可能很有趣。那里提到，virtualenvwrapper 的大多数函数都可以与 Python 3.3 中的[venv](http://docs.python.org/3/library/venv.html)虚拟环境一起使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-05T17:30:59.963

我像这样添加`export VIRTUALENV_PYTHON=/usr/bin/python3`到我`~/.bashrc`的：

```
export WORKON_HOME=$HOME/.virtualenvs
export VIRTUALENV_PYTHON=/usr/bin/python3
source /usr/local/bin/virtualenvwrapper.sh 
```

然后运行`source .bashrc`

您可以为每个新环境指定 python 版本`mkvirtualenv --python=python2 env_name`

# html - HTML5 验证器错误：元素 li 缺少以下一项或多项属性：aria-checked、aria-expanded、aria-valuemax、aria-valuem

> ID：16123476
> 
> 赞同：2
> 
> 时间：2013-04-20T17:58:33.053
> 
> 标签：html, validation, w3c

几天前使用无错误通过的 HTML 5 代码现在在我通过 W3C 验证器运行时显示错误。错误看起来像这样：

**元素 li 缺少以下一项或多项属性：aria-checked、aria-expanded、aria-valuemax、aria-valuemin、aria-valuenow、aria-valuetext、role。**

知道发生了什么以及如何摆脱这些错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-21T14:36:32.440

这是 W3C 验证器的错误。它将被修复。

来自[http://lists.w3.org/Archives/Public/www-validator-cvs/2013Apr/0038.html](http://lists.w3.org/Archives/Public/www-validator-cvs/2013Apr/0038.html)：

> 这是一个验证器问题。今天我对 ARIA 支持做了一些更新，似乎我可能引入了一些意想不到的变化。感谢您的提醒。我会尽快调查并修复它，然后在这里再次回复。

# iphone - 如何仅取消通知？

> ID：16123483
> 
> 赞同：0
> 
> 时间：2013-04-20T17:59:04.973
> 
> 标签：iphone, ios, xcode, localnotification

我想做点什么。我的通知设置为 11 和 12 小时。我想取消订阅这些设置的通知仅在 11 小时内。我该怎么做？

我的代码；

```
NSCalendar *greg = [[NSCalendar alloc]initWithCalendarIdentifier:NSGregorianCalendar];
        NSDateComponents * component = [greg components:NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit fromDate:[NSDate date]];
        [component setYear:2013];
        [component setMonth:m];
        [component setDay:d];
        [component setHour:x];
        [component setMinute:y];

        UIDatePicker *dd = [[UIDatePicker alloc]init];
        [dd setDate:[greg dateFromComponents:component]];

        UILocalNotification * bildirim = [[UILocalNotification alloc]init];
        [bildirim setAlertBody:newtask.name];
        [bildirim setFireDate:dd.date];
        bildirim.soundName = UILocalNotificationDefaultSoundName;
        bildirim.alertAction = NSLocalizedString(@"Test", nil);
        //[bildirim setFireDate:[NSDate dateWithTimeIntervalSinceNow:0]];
        [bildirim setTimeZone:[NSTimeZone defaultTimeZone]];

        [[UIApplication sharedApplication] scheduleLocalNotification:bildirim]; 
```

我找到了一个代码。不幸的是，此代码正在删除所有通知。

```
[[UIApplication sharedApplication] cancelAllLocalNotifications]; 
```

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:24:49.983

创建时有两件事`local notification`，使用一些唯一标识创建它，以便您可以像下面这样标识

```
UILocalNotification * notification = [[UILocalNotification alloc]init];
notification.userInfo=[NSDictionary dictionaryWithObject:@"UNIQUE_ID" forKey:@"notifcation_id"]; 
```

然后要取消特定的，您需要以下步骤

```
for(UILocalNotification *notificaiton in [[UIApplication sharedApplication] scheduledLocalNotifications]){

    if([[notificaiton.userInfo objectForKey:@"notifcation_id"] isEqualToString:UNIQUE_ID]){
        [[UIApplication sharedApplication] cancelLocalNotification:notificaiton];
        break;
    }
} 
```

一切顺利..

# java - 没有循环的选择排序

> ID：16123487
> 
> 赞同：1
> 
> 时间：2013-04-20T17:59:49.203
> 
> 标签：java, arrays, selection-sort

对于这个程序，我想实现一系列排序和搜索算法。该数组将填充随机数。然后我想将每个数组元素绘制为条形（制作类似于条形图的东西）。我在 GUI 中有一个步骤和运行按钮，该步骤应该使用选择排序。我遇到的问题是：我只知道如何使用循环进行选择排序。但是，我不能使用循环，因为我必须显示正在逐步排序的数组。谁能告诉我如何在没有循环的情况下进行选择排序？我将添加到目前为止的所有代码，因为这是我第一次发布任何内容，并且我想确保我是具体的。

数组查看器：

```
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JButton;
import java.util.Scanner;
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class ArrayViewer 
{
    static int[] array;
    static int size;

    public static void main(String[] args)
    {

        Scanner in=new Scanner(System.in);
        //ask for the size of the array until the user enters a size in the right range
        do
        {
            System.out.print("Enter the size of the array (should be between 10 and 80): ");
            size=in.nextInt();
        }
        while (size<10 || size>80);

        array= ArrayUtil.randomIntArray(size,100);//create a random array of given size and entries ranging from 0 to 100
        final ArrayComponent arrayComp= new ArrayComponent(array); //construct an arrayComponent with the random array   
        class ButtonListener implements ActionListener
        {
            public void actionPerformed(ActionEvent e)
            {
                //I want the selection sort algorithm to go in here so I can just assign this to my stepButton.

            }
        }

        final JFrame frame=new JFrame("Sorting"); //create and setup the frame
        frame.setSize(1200,300);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel buttonPanel= new JPanel(); // panel to hold the buttons        
        JPanel panel=new JPanel(new BorderLayout()); // panel to hold the button panel and the array component; uses BorderLayout: read about it in the API

        JButton stepButton=new JButton("Step"); //button to go through the algorithm step by step
        JButton runButton=new JButton("Run"); //button to run the algorithm 
        ActionListener listener = new ButtonListener();
        stepButton.addActionListener(listener);

        buttonPanel.add(stepButton); 
        buttonPanel.add(runButton);
        panel.add(buttonPanel,BorderLayout.PAGE_START); //add the buttonPanel  at the top of the panel
        panel.add(arrayComp,BorderLayout.CENTER); //add the arraycoponent object in the center of teh panel
        frame.add(panel);
        frame.setVisible(true);         
        //print the entries in the array
        //System.out.println(arrayComp);

    }
} 
```

数组组件：

```
import javax.swing.JComponent;
import java.awt.Rectangle;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Dimension;
import java.awt.Color;

public class ArrayComponent extends JComponent 
{
    private int[] theArray;
    final int dx=6; //the width of thebars (as well as the with of the spaces between bars)
    private int space=0;
    int index1 =0;
    int index2 =0;
    public ArrayComponent(int[] a)
    {
        theArray=a;    
        space=600-12*theArray.length/2; //space amount on the horizontal axes to center the graph                                      
        //600 is the frame width in the viewer program
        //For each bar 12 units on the horixzontal axis is used including the space following it.
        //something.addActionListener(new ButtonListener());
    }

    public void setIndices(int i, int j)
    {
        index1 = i;
        index2= j;
    }

    public void paintComponent(Graphics g)
    {        
        Graphics2D pen= (Graphics2D) g;
        for (int k=0;k<theArray.length;k++)
        {
            pen.drawRect(space+2*k*dx,5,dx,theArray[k]); 
            //space: initial space 
            //2*k*dx:  the (horizontal) distance of te kth bar from the start of the graph
            //5: bars are located on y=5
            //dx: the width of the bars
            //theArray[k]: height of the kth bar
        } 
        pen.fillRect(space+2*index1*dx,5,dx,theArray[index1]);
        pen.fillRect(space+2*index2*dx,5,dx,theArray[index2]);
    }

    public String toString()
    {
        String str=("array=[");
        int k=0;
        for (k=0;k<theArray.length-1;k++)
            str=str+theArray[k]+", ";              
        str=str+theArray[k]+"]";
        return str;
    }

} 
```

ArrayUtil（创建随机数组）：

```
import java.util.Random;

/**
   This class contains utility methods for array manipulation.
*/  
public class ArrayUtil
{ 
   private static Random generator = new Random();

   /**
      Creates an array filled with random values.
      @param length the length of the array
      @param n the number of possible random values
      @return an array filled with length numbers between
      0 and n - 1
   */
   public static int[] randomIntArray(int length, int n)
   {  
      int[] a = new int[length];      
      for (int i = 0; i < a.length; i++)
         a[i] = generator.nextInt(n);

      return a;
   }
} 
```

对不起，如果帖子很长。该程序已经绘制了数组，它只是不对它们进行排序。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:36:18.117

让我们`activeIndex`参考下一个要排序的数组元素的索引（从值 0 开始）。

编写一个方法，比如说 stepSelectionSort，它只执行选择排序的一个步骤并返回。排序从数组[activeIndex] 开始。

{5,4,3,2,1} -> activeIndex=0 -> Step.click -> stepSelectionSort() 在 0 处对数组元素进行排序 -> {1,4,3,2,5} -> draw() - > activeIndix=1 -> Step.click -> stepSelectionSort() 对数组元素 1 进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T05:51:07.520

*   临时编写代码在循环内进行全排序
*   将循环中的所有代码放入一个方法中
*   每次用户单击“步骤”GUI 按钮时，删除循环并调用该方法一次

# unix - 对基于 unix 的系统的依赖

> ID：16123488
> 
> 赞同：0
> 
> 时间：2013-04-20T17:59:49.383
> 
> 标签：unix, dependencies, libraries, package-managers

对于安装软件，每个“平台”都有自己的包管理器：brew、apt、pip、Bundle 等...

但是对于普通的旧编译项目，是否有任何标准可以以可操作的方式声明依赖项，`(brew,apt,yum..) install`所有这些都可以接受？

截至目前，我

*   看看有什么`./configure`抱怨，
*   冲泡安装
*   添加到 -L 路径等...

这是相当乏味和无效的，但我不知道有什么更好的方法。

对于普通的旧源代码，我错过了这样的标准机制吗？

# python - 将列表列表扩展到一个加入列表的更多“pythonic”方式

> ID：16123491
> 
> 赞同：3
> 
> 时间：2013-04-20T18:00:03.657
> 
> 标签：python, python-3.x, python-3.2

这是与python语法相关的问题......有没有*更优雅*和*更pythonic*的方式来做到这一点：

```
>>> test = [[1,2], [3,4,5], [1,2,3,4,5,6]]
>>> result = []
>>> for i in test: result += i
>>> result
[1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 6] 
```

将多个列表（存储在另一个列表中）加入一个长列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T18:01:06.293

使用[`itertools.chain.from_iterable()`](http://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable)类方法：

```
from itertools import chain

result = list(chain.from_iterable(test)) 
```

如果您需要做的只是遍历链表，则不要将其具体化为 a `list()`，只需循环：

```
for elem in chain.from_iterable(test):
    print(elem, end=' ')   # prints 1 2 3 4 5 1 2 3 4 5 6 
```

您也可以直接使用参数解包[`itertools.chain`](http://docs.python.org/3/library/itertools.html#itertools.chain)：

```
for elem in chain(*test): 
```

但仅对较小的列表执行此操作。

# ruby-on-rails - 急切加载多态

> ID：16123492
> 
> 赞同：119
> 
> 时间：2013-04-20T18:00:04.180
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

使用 Rails 3.2，这段代码有什么问题？

```
@reviews = @user.reviews.includes(:user, :reviewable)
.where('reviewable_type = ? AND reviewable.shop_type = ?', 'Shop', 'cafe') 
```

它引发了这个错误：

> 不能急切地加载多态关联：reviewable

如果我删除`reviewable.shop_type = ?`条件，它会起作用。

如何根据`reviewable_type`and `reviewable.shop_type`（实际上是`shop.shop_type`）进行过滤？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-04-20T19:28:38.883

我的猜测是你的模型看起来像这样：

```
class User < ActiveRecord::Base
  has_many :reviews
end

class Review < ActiveRecord::Base
  belongs_to :user
  belongs_to :reviewable, polymorphic: true
end

class Shop < ActiveRecord::Base
  has_many :reviews, as: :reviewable
end 
```

由于多种原因，您无法执行该查询。

1.  ActiveRecord 无法在没有其他信息的情况下构建连接。
2.  没有称为可审查的表

`Review`要解决这个问题，您需要明确定义和之间的关系`Shop`。

```
class Review < ActiveRecord::Base
   belongs_to :user
   belongs_to :reviewable, polymorphic: true
   # For Rails < 4
   belongs_to :shop, foreign_key: 'reviewable_id', conditions: "reviews.reviewable_type = 'Shop'"
   # For Rails >= 4
   belongs_to :shop, -> { where(reviews: {reviewable_type: 'Shop'}) }, foreign_key: 'reviewable_id'
   # Ensure review.shop returns nil unless review.reviewable_type == "Shop"
   def shop
     return unless reviewable_type == "Shop"
     super
   end
end 
```

然后你可以这样查询：

```
Review.includes(:shop).where(shops: {shop_type: 'cafe'}) 
```

请注意，表名是`shops`而不是`reviewable`。数据库中不应该有一个名为可审查的表。

我相信这比显式定义`join`之间更容易和更灵活`Review`，`Shop`因为除了通过相关字段查询之外，它还允许您预先加载。

这样做是必要的原因是 ActiveRecord 无法单独基于可审查的方式构建连接，因为多个表代表连接的另一端，据我所知，SQL 不允许您连接由存储的值命名的表在一列中。通过定义额外的关系`belongs_to :shop`，您可以为 ActiveRecord 提供完成连接所需的信息。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2017-10-19T20:43:56.343

如果你得到一个 ActiveRecord::EagerLoadPolymorphicError，那是因为`includes`决定`eager_load`在多态关联只支持时调用`preload`。它在这里的文档中：http: [//api.rubyonrails.org/v5.1/classes/ActiveRecord/EagerLoadPolymorphicError.html](http://api.rubyonrails.org/v5.1/classes/ActiveRecord/EagerLoadPolymorphicError.html)

所以总是`preload`用于多态关联。对此有一个警告：您不能在 where 子句中查询多态关联（这是有道理的，因为多态关联代表多个表。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-02T15:59:12.930

这为我做了工作

```
 belongs_to :shop, foreign_type: 'Shop', foreign_key: 'reviewable_id' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-08T23:52:31.293

没有足够的声誉来评论扩展上述摩西卢卡斯的回应，我不得不做一个小的调整来让它在 Rails 7 中工作，因为我收到以下错误：

```
ArgumentError: Unknown key: :foreign_type. Valid keys are: :class_name, :anonymous_class, :primary_key, :foreign_key, :dependent, :validate, :inverse_of, :strict_loading, :autosave, :required, :touch, :polymorphic, :counter_cache, :optional, :default 
```

代替 `belongs_to :shop, foreign_type: 'Shop', foreign_key: 'reviewable_id'`

我和 `belongs_to :shop, class_name: 'Shop', foreign_key: 'reviewable_id'`

这里唯一的区别是更改`foreign_type:`为`class_name:`!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-20T20:50:37.110

作为附录，顶部的答案非常好，`:include`如果由于某种原因您使用的查询不包括模型的表并且您遇到未定义的表错误，您还可以指定关联。

像这样：

```
belongs_to :shop, 
           foreign_key: 'reviewable_id', 
           conditions: "reviews.reviewable_type = 'Shop'",
           include: :reviews 
```

如果没有该`:include`选项，如果您仅访问`review.shop`上面示例中的关联，您将收到 UndefinedTable 错误（在 Rails 3 中测试，而不是 4 中测试），因为关联可以`SELECT FROM shops WHERE shop.id = 1 AND ( reviews.review_type = 'Shop' )`。

该`:include`选项将强制执行 JOIN。:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-08-02T13:20:41.023

```
@reviews = @user.reviews.includes(:user, :reviewable)
.where('reviewable_type = ? AND reviewable.shop_type = ?', 'Shop', 'cafe').references(:reviewable) 
```

当您在 WHERE 中使用 SQL 片段时，需要引用才能加入您的关联。

# flash - 用 AI 复制敌人

> ID：16123493
> 
> 赞同：0
> 
> 时间：2013-04-20T18:00:04.153
> 
> 标签：flash, variables, actionscript-2

我正在开发一个与敌人作战的 Flash 游戏。我为一个我称为史莱姆的敌人做了整个 AI。现在我想在场景中放置多个这个敌人，我想知道我是否必须复制所有代码，例如 slime1 slime2 等。

```
if ((img_background.BackGround.wall).hitTest(slime._x + radius, slime._y,true )) { // When the slime hits a right wall
    slime._x -= 8
}

if ((img_background.BackGround.wall).hitTest(slime._x, slime._y + radius, true)) {
    slime._y -= 8;
}
if ((img_background.BackGround.wall).hitTest(slime._x, slime._y - radius, true)) {
    slime._y += 8;
}
if ((img_background.BackGround.wall).hitTest(slime._x - radius, slime._y, true)) {
    slime._x += 8;
}

if ((img_background.BackGround.wall).hitTest(slime._x)){
    SLIwalltouch = 1
}else{
    SLIwalltouch = 0
} 
```

我可以分配一个具有多个值的变量并执行以下操作：“slime”+ numberofslimes .....我是新手，我需要帮助。谢谢。

注意：我使用的是 flash actionscript 2.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:52:56.430

使用函数来包装代码，参数将是您想要的任何影片剪辑。首先，让我们准备一个函数来检查针对“目标”的命中测试。让我们称之为 checkTouch，例如

```
 function checkTouch(target){
      // When the slime hits a right wall
      if ((img_background.BackGround.wall).hitTest(target._x + radius, target._y,true )){ 
        target._x -= 8
      }
      if ((img_background.BackGround.wall).hitTest(target._x, target._y + radius, true)) {
        target._y -= 8;
      }
      if ((img_background.BackGround.wall).hitTest(target._x, target._y - radius, true)) {
        target._y += 8;
      }
      if ((img_background.BackGround.wall).hitTest(target._x - radius, target._y, true)) {
        target._x += 8;
      }

      if ((img_background.BackGround.wall).hitTest(target._x)){
        SLIwalltouch = 1
      }else{
        SLIwalltouch = 0
      }
    } 
```

请注意，我已将所有出现的“粘液”替换为“目标”。此时，您可以使用您喜欢的任何影片剪辑调用该函数，它会检查该影片剪辑是否命中。

要使代码与您的代码完全相同，只需添加以下内容：

```
 checkTouch(slime); 
```

现在这应该是关于如何检查更多对象的提示。如果你有，比方说，敌人叫“史莱姆”，“史莱姆2”，“地狱犬”和“龙”，你可以做

```
 checkTouch(slime);
    checkTouch(slime2);
    checkTouch(hellhound);
    checkTouch(dragon); 
```

但是，如果您最终拥有更多敌人，则将敌人添加到数组中然后在循环中将函数应用于它们会更​​有用：

```
 var all_enemies=[slime, slime2, hellhound, mushroom, ..., enemyN];

    for(enemy in all_enemies){
      checkTouch(enemy);
    } 
```

请注意，为了发挥作用，敌人必须先出现在舞台上，然后才能像这样在数组中声明 then。

如果您不想将数组中的所有敌人都写出来并知道您将拥有的敌人的确切数量 - 您可以利用 flash 的能力来构建影片剪辑名称。

它是这样的，将所有敌人命名为enemy1、enemy2、enemy3……，然后使for循环看起来像这样：

```
 for(i=0; i<numberofenemies; i++){ //replace numberofenemies with the number of enemies
      checkTouch(this["enemy"+i]);
    } 
```

# c - 递归函数——钩子

> ID：16123498
> 
> 赞同：0
> 
> 时间：2013-04-20T18:00:36.323
> 
> 标签：c, linux, hook

假设我们在 .so 中有一个名为“SomeFunction()”的函数。假设这个函数多次调用自身（递归）。

然后，以下代码将不起作用

```
main() {
     [...]
     g_backup_bytes = SetJmpHook(SomeFunction, SomeFunction_hook); // Address of func previously found using dlsym(), contained in SomeFunction
     [...]
}

void SomeFunction_hook(void)
{
     [...]
     // Do stuff here
     [...]
     // Call the real function
     UnsetJmpHook(SomeFunction, g_backup_bytes); // Restore original bytes
     SomeFunction(); // Call
     SetJmpHook(SomeFunction, SomeFunction_hook); // Restore the hook
} 
```

我试图挂钩的函数有 void 参数，但会修改全局变量。每次调用该函数时，我绝对需要修改这些全局变量中的一些字节。现在，我的问题是......当我取消设置挂钩时，就像上面的示例一样，函数调用自身，并且这些调用不会被我的 SomeFunction_hook() 过程捕获（因为 jmp 不再存在）。这带来了一个真正的问题。

你有什么想法我可以成功地挂断每个电话吗？

谢谢！

# r - 根据输入动态更改列名

> ID：16123500
> 
> 赞同：1
> 
> 时间：2013-04-20T18:00:53.220
> 
> 标签：r, function, dataframe, do.call, qdap

我正在尝试根据输入动态命名数据框的输出。

```
get.max2 <- function(data = NULL, column)
{
  #require(qdap)
  col <- eval(substitute(column), data)
  max <- max(eval(substitute(column), data))
  name <- lookup(col, max, rownames(data))
  name <- name[!is.na(name)]
  #title <- do.call('paste', list(paste(match.call()[1])))
  df <- data.frame(name = name, title = max(col))
  print(df)
} 
```

目前，输出如下所示：

```
get.max2(mtcars, mpg)

      name title
Volvo 142E  33.9 
```

但是，我希望它看起来像这样：

```
get.max2(mtcars, mpg)

      name  mpg
Volvo 142E 33.9 
```

我认为答案与 match.call/do.call 有关，但在使用这些函数时，我的知识充其量是模糊的。有谁知道这是否可能？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:34:19.220

你的`title=..`声明几乎没有。

你想改用：

```
 title = paste(match.call()[-(1:2)], collapse=" ")   
 # the collapse argument is optional, it's not clear
 #    how you would like to handle multiple arguments 
```

* * *

请注意与您所拥有的两个主要区别：

1.  使用`[-(1:2)]`而不是`[1]`. 元素 from`match.call()`是您不想要的函数名称。或者，`match.call()[3]`如果您只需要第二个参数，您可以使用。
2.  在这种情况下，不需要`do.call(.)`. `paste`工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:42:36.097

感谢大家的帮助！我发现的另一个解决方法是在处理后重命名数据框。

```
get.max2 <- function(data = NULL, column)
{
  #require(qdap)
  #require(gdata)
  col <- eval(substitute(column), data)
  max <- max(eval(substitute(column), data))
  name <- lookup(col, max, rownames(data))
  name <- name[!is.na(name)]
  df <- data.frame(name = name, title = max(col))
  title2 <- do.call('paste', list(paste(match.call()[3])))
  df <- rename.vars(df, 'title', title2, info = F)
  return(df)
} 
```

返回：

```
get.max2(mtcars, mpg)

      name  mpg
Volvo 142E 33.9 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:12:39.743

您正在寻找类似`?deparse`and的东西`?substitute`。

```
variableName <- function(x) {
  return(deparse(substitute(x)))
}

variableName(title)
# [1] "title"

variableName(mpg)
# [1] "mpg" 
```

# mercurial - Mercurial 中重新捆绑时出现“未知父级”错误

> ID：16123501
> 
> 赞同：1
> 
> 时间：2013-04-20T18:00:58.123
> 
> 标签：mercurial

我不小心剥离了错误的变更集；但是，我保存了备份，但是当我尝试使用`hg unbundle .hg/strip-backup/faa0a1895b97-backup.hg`解绑它们时，出现以下错误：

```
adding changesets
transaction abort!
rollback completed
abort: 00changelog.i@561fe01204b5: unknown parent! 
```

我能做些什么来纠正这个问题？

这是来自的全部输出`hg verify`：

```
checking changesets
checking manifests                                                              
crosschecking files in changesets and manifests                                 
checking files 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T00:51:16.830

如果 unbundle 告诉您它无法应用捆绑包，那么该“第一个”的父级更改设置它的捆绑包，捆绑包基础，在您的存储库中不存在。由于 repos 永远不会使用普通的 mercurial 命令丢失变更集（strip 不正常），因此您似乎使用了 strip 或其他一些 history-altering-not-normal-usage 命令来更改或删除该变更集。

尝试浏览所有`.hg/strip-backup/`文件并一一应用它们。也许其中一个确实适用并包含您尝试应用的条带备份所需的父级。

Tl; Dr：没有正常的 mercurial 命令会删除任何内容，以及创建备份的非正常命令。除非您在带外删除文件，否则数据就在某处。

# c++ - C++ 和 Project Euler #3 编译错误

> ID：16123502
> 
> 赞同：0
> 
> 时间：2013-04-20T18:00:59.200
> 
> 标签：c++, compiler-errors

```
#import <cmath>
#import <iostream>
using namespace std;

int main {
    int a;
    for(int x = 600851475142; x>cmath::sqrt(600851475143); x--) {
        if (600851475143%x==0) { //is it a factor of 600851475143?
            if p(x) { //is it also a prime?
                cout << x;
                return 0;
            }
        }
    }
}

bool p(int n) {
    for(int x = n; x<cmath::sqrt(n)+1; x++) {
        if (n%x==0) {
            return false;
        }
    }
    return true;
} 
```

这是我的项目 euler #3 ( [http://projecteuler.net/problem=3](http://projecteuler.net/problem=3) ) 的代码。我对 C++ 比较陌生。

基本上我的方法是从 600851475143 开始倒数，测试这个数字是否是 600851475143 的因子，然后看看它是否是素数。如果是则返回号码并退出。但是，当我编译我的代码时，我得到了错误：

```
error: function definition does not declare parameters
In function 'bool p(int)':
error: 'cmath' has not been declared 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:25:37.037

查看您的代码，如果您对编程本身不熟悉，那么您似乎至少是 C++ 新手。

1) 在 C++ 中，我们使用 #include 而不是 #import

2）你需要在调用它之前声明一个函数。就像是：

```
bool p(int n); 
```

在主函数之前

3) main 函数中缺少括号。应该是：'int main() {'

4) 对于 sqrt，您不需要 cmath::。写一些类似的东西： (int) sqrt((double)600851475143) 这是因为 sqrt 在参数中不接受整数

5) 'if p(x) {' 应该是 'if (p(x)) {'

6）函数中的for循环总是在增加。

7) 在 for 循环之前而不是在 for 循环中计算 sqrt 是个好主意。

8) 欢迎来到编程世界！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:04:18.467

*标头*的名称是`cmath`，但`sqrt`在命名空间中`std`。

另外：您可能希望在循环之前计算平方根，然后针对该结果进行测试：

```
bool p(int n) { 
    int limit = std::sqrt(n)+1;
    for (int x=n; x<limit; x++)
    // ...
} 
```

# actionscript-3 - 使用 Flashpunk TiledSpritemap 的任何示例？

> ID：16123504
> 
> 赞同：0
> 
> 时间：2013-04-20T18:01:09.543
> 
> 标签：actionscript-3, frameworks, sprite

Flashpunk 框架具有将位图 Spritesheet 应用于实体的“Spritemap.as”类，而且框架包括“TiledSpritemap.as”

问题是 - 我可以使用它为实体应用具有不同动画的单个 spritesheet 文件吗？

目标是 - 使用一个具有不同精灵的敌人类（在一个精灵表中）

如果可能的话，第二个问题是如何设置 X 和 Y 偏移，如果精灵有不同的大小

在此处查看示例 tiledspritemap（来自 VVVVVV） [http://i.piccy.info/i7/12c5057ece64edccbf40af5902a6839d/4-57-1421/62678728/sprites.png](http://i.piccy.info/i7/12c5057ece64edccbf40af5902a6839d/4-57-1421/62678728/sprites.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-20T23:34:24.340

## TiledSpritemap

TiledSpritemap 用于使单个动画精灵平铺（例如，32x32px）跨 X 或 Y（或两者）平铺。例如，如果你有熔岩精灵表，其中包含 7 个沸腾的熔岩精灵，并且你想创建熔岩池，你可以使用这个类。使用示例：

```
// embed a resource somewhere in your class 
[Embed(source = "../../assets/lava.png")]
private var lavaGfx:Class;

public function AnimatedEntity () 
{
  var spriteWidth:uint=32;
  var spriteHeight:uint=32;
  var objectWidth:uint=100; // pool of lava, that has 100px width
  var objectHeight:uint=32;

  var t = new TiledSpritemap(this.lavaGfx, spriteWidth, spriteHeight, objectWidth, objectHeight );
  t.add("boil", [0, 1, 2, 3, 4, 5, 6], 4, true);
  graphic = hb;
  t.play("boil");           
} 
```

其中，您应该使用 spritesheet（例如 32x32）中单个精灵的宽度和高度，而不是 spriteWidth 和 spriteHeight，而不是*objectWidth*和*objectHeight* *-*对象*的*所需宽度和高度。函数*t.add*具有以下属性： 调用“播放”时将使用的动画名称；要进行动画处理的帧索引数组；动画的帧率；布尔值，设置动画是否应该循环。

## 精灵图

Spritemap 可用于从一个 spritesheet 制作一堆不同的动画，使用代码，类似于上面提到的代码：

```
public function AnimatedEntity () 
{
  var spriteWidth:uint= 32;
  var spriteHeight:uint= 32;

  var t = new Spritemap(enemyGfx, spriteWidth, spriteHeight);

  t.add("run", [0, 1, 2], 10, true);
  t.add("jumpUp", [3, 4], 9, true);
  t.add("jumpDown", [5, 6], 9, true);
  t.add("attack", [7, 8, 9], 10, true);
  t.add("standIdle", [10, 11, 12], 10, true);
} 
```

目前，开箱即用的 FlashPunk 无法使用由不同大小的 sprite 组成的 spritesheets（或 Atlases，因为它在其他 2d 游戏引擎中被称为）。

# java - 数据表 - 限制输出

> ID：16123510
> 
> 赞同：0
> 
> 时间：2013-04-20T18:02:08.673
> 
> 标签：java, eclipse, jsf, primefaces

我已经实现了 primefaces[数据表](http://www.primefaces.org/showcase/ui/datatablePagination.jsf) 但是，当我的表中有很多数据时，它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/ImcmN.png)

限制单元大小的可能解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:33:00.240

`p:column`支持属性`width`（以像素或百分比为单位的大小）和`style`（CSS 样式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T01:49:39.643

您可以使用 Javascript 来修剪内容，并且在每次鼠标悬停时，用户都会看到所有内容： UI 页面中的标题（xhtml，...）：

```
 <script type="text/javascript">
        var iLimitTextSize = 20;
        trimtext();
    </script> 
```

JavaScript：

```
 function trimtext(){  
        $(document).ready(function () {                  
            $(".ui-dt-c").each(function () {                            
                if ($.trim($(this).text()).length > iLimitTextSize) {
                    $(this).attr("title",$.trim($(this).text()));
                    $(this).text($.trim($(this).text()).substring(0, iLimitTextSize));
                    $(this).html($(this).html() + '...');
                }
            });
        });
    } 
```

如果您有执行其行为然后更新数据表的组件，则需要再次调用 trimtext() 函数，例如：

```
<p:commandButton value="Ok" update="datatable" oncomplete="trimtext();" /> 
```

# java - JBoss 7 中的多线程问题

> ID：16123516
> 
> 赞同：3
> 
> 时间：2013-04-20T18:02:42.270
> 
> 标签：java, multithreading, spring, hibernate, jboss7.x

我有一个关于 jboss 7 中的多线程的问题（或疑问）。我的情况或多或少类似于[这里](https://stackoverflow.com/questions/13932083/jboss-java-ee-container-and-an-executorservice)描述的情况：我有一段代码在许多线程中运行，现在我必须将它移动到 jboss 服务器。唯一不同的是我不使用 EJB，只使用 spring+hibernate。所以我的问题是：我应该遵循与答案中所写相同的步骤，还是有其他方法可以创建许多线程？（我正在探索 jboss 并且有一些地方可以配置线程工厂和线程池，我不知道它是否是我可以在我的应用程序中使用的工具）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T11:25:22.000

不，不是。在 Java EE 和 servlet 规范下创建线程是“非法的”。您指向它的链接是在 Web/Java EE 容器下进行线程处理的最简单方法 - 使用 @Asynchronous。请注意，如果您想等待结果，可以从这种方法返回 Future

# php - MySQL查询以获取两个日期时间范围内的项目，同时使用大于或等于范围开头的内容

> ID：16123523
> 
> 赞同：0
> 
> 时间：2013-04-20T18:03:19.793
> 
> 标签：php, mysql, datetime

我的数据库表 a`start_time`和`end_time`示例中有两个字段：

```
start_time: 2013-04-20 13:07:00
end_time: 2013-04-20 12:07:00 
```

我的查询当前包含

```
 where `start_time` >= '2013-04-20 14:13:20' AND `end_time` <= '2013-04-20 18:13:20' 
```

由于查询的方式`start_time: 2013-04-20 13:07:00`不会拉入结果，所以我正在寻找如何弥补这一点的想法。为拉取生成的时间已经将时间从当前时间设置回一小时，并将结束时间设置为从当前时间开始的 4 小时。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-20T18:07:40.477

不要使用`>=`并且`<=`在查询中使用类似这样的东西来修复它。 `where (start_time > '2013-04-20 14:13:20' or start_time = '2013-04-20 14:13:20' ) AND (end_time < '2013-04-20 18:13:20' or end_time = '2013-04-20 18:13:20')`

# c++ - Eclipse CDT 链接到共享库

> ID：16123525
> 
> 赞同：3
> 
> 时间：2013-04-20T18:03:33.647
> 
> 标签：c++, macos, shared-libraries, eclipse-cdt

我在 Mac 上的 eclipse CDT 中有两个项目。一个是共享库，另一个是使用共享库的 C++ 项目。我正在尝试使用共享库，并已对其进行编译，但它不会运行。当我尝试运行它时，我得到一个`image not found`错误。

我无法弄清楚如何将我的库添加到路径目录，`ld_library_path`或者我需要将它添加到的每个其他路径，以便它可以在运行时链接到。我已经将它作为参考添加到我的其他项目中，该项目为我正确设置了运行时链接，但我需要帮助设置运行时链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-29T22:58:57.207

当我尝试运行使用另一个共享链接库的程序时，我也想在 Eclipse 中运行该程序。这是我所做的：

在“运行/调试设置”中插入变量环境 LD_LIBRARY_PATH="where you shared lib file is"，问题就解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-05T02:16:44.460

我遇到了一些问题，解决方案：

将变量环境`DYLD_LIBRARY_PATH = ${workspace_loc:/sharedlib/Debug}`插入到运行配置中。

# c - 变量意外更改值

> ID：16123526
> 
> 赞同：0
> 
> 时间：2013-04-20T18:03:34.097
> 
> 标签：c

我的程序中有一个 while 循环，其中一个粒子一直移动，直到它访问了一定数量的地方（由整数给出`placesToVisit`）。

```
int dimensionLength=2;
int placesToVisit=pow(dimensionLength, 3);
while (numPlacesVisited<placesToVisit) {

  // Code which makes no changes or references to placesToVisit
  // at all (except a few printf commands for debugging).

} 
```

我的问题是，在这个循环的多次迭代之后，`placesToVisit`它的值突然变为 1（因此过早地结束了循环）。它应该有一个常量值 8。这个变量只用在`while`循环的条件语句中，没有指向它的指针，也没有其他对它的引用，除了`printf`我为调试而输入的一些命令。什么可能导致`placesToVisit`突然改变它的价值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T18:06:11.713

一种可能的解释是您得到了未定义的行为，因为您通过写入无效的内存位置（很可能写入超出堆栈上数组的边界）以某种方式破坏了调用堆栈。这个变量`placesToVisit`很可能是你被砸的筹码的牺牲品。

但是，如果不查看您的代码，就无法确定。我怀疑您尚未发布的代码在某处显示缓冲区溢出。

# nhibernate - 如何忽略lazy="false" 映射？

> ID：16123528
> 
> 赞同：0
> 
> 时间：2013-04-20T18:03:37.430
> 
> 标签：nhibernate

我有以下课程：

```
public class PurchaseOrder
{
   ...
   Store Store { get; protected set; }
   User CreatedBy { get; protected set; }
   User ApprovedBy { get; protected set; }
   ...
} 
```

User 和 Store 类使用lazy="false" 选项进行映射。

```
<class name="User" lazy="false"> 
```

更具体地说，它们与使用`lazy="false"`选项映射的其他一些实体相关联。**而且我不允许更改它。**这不是“我的”课程，它们属于其他领域。

我的问题是，每次我获取 PurchaseOrder 时，它都会为这些类及其依赖项产生额外的查询，导致我遇到 SELECT N+1 问题。在 99% 的情况下，我不需要所有这些信息 - 存储 id 和用户 id 对我来说就足够了。尝试使用...

```
session.CreateCreteria<PurchaseOrder>()
   ...
   .SetFetchMode("CreatedBy", FetchMode.Lazy)
   .SetFetchMode("ApprovedBy", FetchMode.Lazy)
   .SetFetchMode("Store", FetchMode.Lazy)
   ... 
```

..但这无济于事。

我怎样才能强迫这些关联变得懒惰并忽略`lazy="false"`？

只是要清楚。存储在 User 和 Store 类中的信息对我的域没有用。所以我根本不希望它被获取。此外，如果我在查询中加入用户和商店，它将导致对也映射为lazy="false" 的实体的查询链（不要问为什么，我无法更改它）。我符合某些公司的标准并且必须引用这些类（我不喜欢它，但这是一个规则），但我不想获取他们的数据，我希望它懒惰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T23:53:59.623

你不能覆盖`lazy="false"`.

您可以做的与您所做的完全相反：急切地获取（`FetchMode.Eager`或`FetchMode.Join`，它们是同义词）。

# python - 处理除一个异常外的所有异常

> ID：16123529
> 
> 赞同：43
> 
> 时间：2013-04-20T18:03:46.820
> 
> 标签：python, exception, exception-handling, error-handling

如何处理除一个异常之外的所有异常？

```
try:
    something
except <any Exception except for a NoChildException>:
    # handling 
```

像这样的东西，除了不破坏原始回溯：

```
try:
    something
except NoChildException:
    raise NoChildException
except Exception:
    # handling 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-04-20T18:17:49.310

答案是简单地做一个bare `raise`：

```
try:
    ...
except NoChildException:
    # optionally, do some stuff here and then ...
    raise
except Exception:
    # handling 
```

这将重新引发最后抛出的异常，原始堆栈跟踪完好无损（即使它已被处理！）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-05T15:28:33.000

我会将此作为对已接受答案的改进。

```
try:
    dosomestuff()
except MySpecialException:
    ttype, value, traceback = sys.exc_info()
    raise ttype, value, traceback
except Exception as e:
    mse = convert_to_myspecialexception_with_local_context(e, context)
    raise mse 
```

这种方法通过在捕获 MySpecialException 时维护原始堆栈跟踪来改进已接受的答案，因此当您的顶级异常处理程序记录异常时，您将获得指向原始异常抛出位置的回溯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-23T16:02:05.687

Python 新手……但这不是一个可行的答案吗？我使用它并且显然有效....并且是线性的。

```
try:
    something
except NoChildException:
    assert True
except Exception:
    # handling 
```

例如，我使用它来摆脱（在某些情况下无用）从 os.mkdir 返回异常 FileExistsError。

那就是我的代码是：

```
try:
  os.mkdir(dbFileDir, mode=0o700)
except FileExistsError:
  assert True 
```

我只是接受目录无法以某种方式访问​​的事实作为中止执行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-06-06T20:58:10.487

我发现了一个上下文，其中捕获所有错误但有一个并不是一件坏事，即单元测试。

如果我有一个方法：

```
def my_method():
   try:
      something()
   except IOError, e:
      handle_it() 
```

然后它可能有一个看起来像这样的单元测试：

```
def test_my_method():
   try:
      my_module.my_method()
   except IOError, e:
      print "shouldn't see this error message"
      assert False
   except Exception, e:
      print "some other error message"
      assert False
   assert True 
```

因为您现在已经检测到 my_method 刚刚抛出了一个意外的异常。

# php - Symfony2 在自己的目录中并使用 mod_rewrite

> ID：16123532
> 
> 赞同：0
> 
> 时间：2013-04-20T18:04:07.440
> 
> 标签：php, mod-rewrite, symfony, apache2

我安装了 Symfony2 ，但当我去时`<host>/Symfony/`默认安装在：`.htaccess``/var/www/Symfony/web/`

```
<host>/Symfony/web/app.php/hello/James 
```

我被重定向到：

```
<host>/hello/James 
```

我想被重定向到：

```
<host>/Symfony/hello/James 
```

我认为这与以下内容有关`.htaccess`：

```
RewriteCond %{REQUEST_URI}::$1 ^(/.+)(.+)::\2$
RewriteRule ^(.*) - [E=BASE:%1]
RewriteRule .? %{ENV:BASE}app.php [L] 
```

我不太擅长`mod_rewrite`

**编辑**

```
# Use the front controller as index file. It serves as fallback solution when
# every other rewrite/redirect fails (e.g. in an aliased environment without
# mod_rewrite). Additionally, this reduces the matching process for the
# startpage (path "/") because otherwise Apache will apply the rewritting rules
# to each configured DirectoryIndex file (e.g. index.php, index.html, index.pl).
DirectoryIndex app.php

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Redirect to URI without front controller to prevent duplicate content
    # (with and without `/app.php`). Only do this redirect on the initial
    # rewrite by Apache and not on subsequent cycles. Otherwise we would get an
    # endless redirect loop (request -> rewrite to front controller ->
    # redirect -> request -> ...).
    # So in case you get a "too many redirects" error or you always get redirected
    # to the startpage because your Apache does not expose the REDIRECT_STATUS
    # environment variable, you have 2 choices:
    # - disable this feature by commenting the following 2 lines or
    # - use Apache >= 2.3.9 and replace all L flags by END flags and remove the
    #   following RewriteCond (best solution)
    RewriteCond %{ENV:REDIRECT_STATUS} ^$
    RewriteRule ^app\.php(/(.*)|$) %{CONTEXT_PREFIX}/$2 [R=301,L]

    # If the requested filename exists, simply serve it.
    # We only want to let Apache serve files and not directories.
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule .? - [L]

    # The following rewrites all other queries to the front controller. The
    # condition ensures that if you are using Apache aliases to do mass virtual
    # hosting, the base path will be prepended to allow proper resolution of the
    # app.php file; it will work in non-aliased environments as well, providing
    # a safe, one-size fits all solution.
    RewriteCond %{REQUEST_URI}::$1 ^(/.+)(.+)::\2$
    RewriteRule ^(.*) - [E=BASE:%1]
    RewriteRule .? %{ENV:BASE}app_dev.php [L]
</IfModule>

<IfModule !mod_rewrite.c>
    <IfModule mod_alias.c>
        # When mod_rewrite is not available, we instruct a temporary redirect of
        # the startpage to the front controller explicitly so that the website
        # and the generated links can still be used.
        RedirectMatch 302 ^/$ /app.php/
        # RedirectTemp cannot be used instead
    </IfModule>
</IfModule> 
```

# java - FloatBuffer 损坏的问题

> ID：16123536
> 
> 赞同：2
> 
> 时间：2013-04-20T18:04:36.020
> 
> 标签：java, android, memory, opengl-es

我正在编写基于 DooM 地图布局的 3D 渲染器/引擎并将其移植到 Android。我最初的算法非常慢，我使用 ID 为他们的 iPhone 端口所做的方法对其进行了改进。这是功能：

```
public void renderScene(GL10 gl, Map map) {
    int currentTexture = renderWalls[0].texID;
    gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[currentTexture]);

    cFrame.reset();

    for (int i = 0; i < numWalls; i++) {
        Wall wall = renderWalls[i];

        // Draw if texture change
        if (wall.texID != currentTexture) {
            cFrame.transfer();
            gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
            gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
            gl.glVertexPointer(3, GL10.GL_FLOAT, 4 * 5, cFrame.verts);
            // Create a buffer that points 3 floats past the beginning.
            FloatBuffer texData = cFrame.verts.duplicate();
            texData.position(3);
            gl.glTexCoordPointer(2, GL10.GL_FLOAT, 4 * 5, texData);
            gl.glDrawElements(GL10.GL_TRIANGLE_STRIP, cFrame.numIndices,
                    GL10.GL_UNSIGNED_SHORT, cFrame.indices);
            gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
            gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
            cFrame.reset();
            currentTexture = wall.texID;
            gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[currentTexture]);
        }

        cFrame.vertices[(cFrame.numVerts * 5)] = wall.p1.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 1] = wall.top;
        cFrame.vertices[(cFrame.numVerts * 5) + 2] = wall.p1.y;

        cFrame.vertices[(cFrame.numVerts * 5) + 3] = wall.uv1.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 4] = wall.uv1.y;

        cFrame.numVerts++;

        cFrame.vertices[(cFrame.numVerts * 5)] = wall.p1.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 1] = wall.bottom;
        cFrame.vertices[(cFrame.numVerts * 5) + 2] = wall.p1.y;

        cFrame.vertices[(cFrame.numVerts * 5) + 3] = wall.uv2.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 4] = wall.uv2.y;

        cFrame.numVerts++;

        cFrame.vertices[(cFrame.numVerts * 5)] = wall.p2.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 1] = wall.top;
        cFrame.vertices[(cFrame.numVerts * 5) + 2] = wall.p2.y;

        cFrame.vertices[(cFrame.numVerts * 5) + 3] = wall.uv3.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 4] = wall.uv3.y;

        cFrame.numVerts++;

        cFrame.vertices[(cFrame.numVerts * 5)] = wall.p2.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 1] = wall.bottom;
        cFrame.vertices[(cFrame.numVerts * 5) + 2] = wall.p2.y;

        cFrame.vertices[(cFrame.numVerts * 5) + 3] = wall.uv4.x;
        cFrame.vertices[(cFrame.numVerts * 5) + 4] = wall.uv4.y;

        cFrame.numVerts++;

        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 2);
        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 3);
        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 4);
        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 3);
        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 2);
        cFrame.indexes[cFrame.numIndices++] = (short) (cFrame.numVerts - 1);
    }
    cFrame.transfer();
    gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
    gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    gl.glVertexPointer(3, GL10.GL_FLOAT, 4 * 5, cFrame.verts);
    // Create a buffer that points 3 floats past the beginning.
    FloatBuffer texData = cFrame.verts.duplicate();
    texData.position(3);
    gl.glTexCoordPointer(2, GL10.GL_FLOAT, 4 * 5, texData);
    gl.glDrawElements(GL10.GL_TRIANGLES, cFrame.numIndices,
            GL10.GL_UNSIGNED_SHORT, cFrame.indices);
    gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);   
    gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
} 
```

我遍历 BSP 树并收集将呈现哪些行。这些被放入一个 Walls 数组（存储 vert 和 tex coords/id）并通过纹理 id 对其进行快速排序。然后运行以下函数。

我将问题缩小到前 3 个看跌期权的腐败问题。前三个是一些奇怪的浮点值，然后其余的都是正常的。

cFrame 对象计算顶点/索引的数量并从数组传输到浮点缓冲区。这是类/功能

```
class CurrentFrame {
    public short numVerts, numIndices;
    public FloatBuffer verts;
    public ShortBuffer indices;

    public float vertices[];
    public short indexes[];

    public CurrentFrame(int maxVal) {
        ByteBuffer vertsBB = ByteBuffer.allocateDirect(maxVal * 4);
        vertsBB.order(ByteOrder.nativeOrder());
        verts = vertsBB.asFloatBuffer();

        ByteBuffer indBB = ByteBuffer.allocateDirect(maxVal * 2);
        indBB.order(ByteOrder.nativeOrder());
        indices = vertsBB.asShortBuffer();

        vertices = new float[maxVal];
        indexes = new short[maxVal];
    }

    public void reset() {
        cFrame.numIndices = 0;
        cFrame.numVerts = 0;
        cFrame.verts.position(0);
        cFrame.indices.position(0);
    }

    public void transfer() {
        verts.position(0);
        indices.position(0);
        verts.put(vertices, 0, numVerts * 5);
        indices.put(indexes, 0, numIndices);
        verts.position(0);
        indices.position(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T19:54:08.927

想通了，索引指向 vertBB 而不是 indBB，导致损坏。

```
 verts = vertsBB.asFloatBuffer();
    indices = vertsBB.asShortBuffer(); 
```

# java - Java中的最远点Voronoi图

> ID：16123538
> 
> 赞同：2
> 
> 时间：2013-04-20T18:05:30.017
> 
> 标签：java, algorithm, computational-geometry, voronoi

我正在寻找一种简单的算法来找到最远点的 Voronoi 图。在我需要复杂的东西并且没有我可以找到的 Java 库的情况下，输入大小不会足够大。

我希望有人可以描述一个不应该太难计算的简单算法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T06:23:30.293

[您可以在此处](http://www.nirarebakun.com/voro/efpvoro.html)找到最远点 Voronoi 图的算法伪代码。同一个人写的Java代码在[这里](http://www.nirarebakun.com/voro/fpvoro.java)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-25T17:54:07.120

我知道这是一个较晚的添加，但您可能想看看[Tektosyne](https://github.com/kynosarges/tektosyne)库。

它可以生成 Voronoi 图和 Delaunay 三角剖分，并转换为 DCEL 细分，并支持 A* 寻路、路径覆盖、洪水填充、叹息线等图形算法。

# java - 登录网站以在 Java 中抓取数据

> ID：16123543
> 
> 赞同：1
> 
> 时间：2013-04-20T18:06:05.930
> 
> 标签：java, android, web-scraping, httpclient, jsoup

我正在尝试登录以下网站： http: [//www.deeproute.com](http://www.deeproute.com)。登录表单字段如下：

```
<input type="hidden" name="cookieexists" value="false">
<input size=12 type=name name=name>
<input size=12 type=password name=password>
<input type=submit name=subbera value="Login"> 
```

这是我尝试使用 HttpClient 登录并使用 Jsoup 解析生成的 html 的代码。不幸的是，这会以相同的未登录状态返回页面的原始 html。

```
 HttpResponse res = null;
        Document homePage = null;
        HttpEntity entity = null;

        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://www.deeproute.com");
        String html = null;

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);
        nameValuePairs.add(new BasicNameValuePair("cookieexists", "false"));
        nameValuePairs.add(new BasicNameValuePair("name", username));
        nameValuePairs.add(new BasicNameValuePair("password", pass));

        try {
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            res = httpclient.execute(httppost);

        } catch (IOException e) {

            e.printStackTrace();
        }

        if (res != null) {

            try {
                html = EntityUtils.toString(res.getEntity());
                homePage = Jsoup.parse(html);
            } catch (ParseException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            } 
```

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T22:37:22.320

仅使用 jSoup 代码的工作解决方案。

*   步骤 1\. 获取登录表单
*   第 2 步。发布带有 cookie 和所有参数的表单。

* * *

```
public static void main(String[] args) throws Exception {

    Connection.Response loginForm = Jsoup.connect("http://deeproute.com/deeproute/default.asp")
            .method(Connection.Method.GET)
            .execute();

    Document document = Jsoup.connect("http://deeproute.com/deeproute/default.asp")
            .data("cookieexists", "false")
            .data("name", "username")
            .data("password", "pass")
            .data("subbera", "Login")
            .cookies(loginForm.cookies())
            .post();

} 
```

# ios - 带搜索栏的导航栏 iPad Monotouch

> ID：16123552
> 
> 赞同：1
> 
> 时间：2013-04-20T18:06:40.487
> 
> 标签：ios, ipad, xamarin.ios, uinavigationbar, searchbar

我想要一个这样的页面：

![在此处输入图像描述](https://i.stack.imgur.com/eMDg1.png)

这是iPad地图的地图页面。如您所见，它的顶部有一个位置搜索栏。

当屏幕顶部有导航栏时，是否可以在顶部有这样的搜索栏？

编辑：除了实现这一点之外，重要的是在导航栏上使用搜索栏对苹果指南没有错误。请帮助解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T11:59:18.047

它不是反对 iphone quide 行。我在此搜索栏上的申请已获批准。

下面的代码会将 uisearch 栏添加到您的导航栏：

```
LocationSearchBar = new UISearchBar (new RectangleF (0,0,250,44));
            UIBarButtonItem searchButtonItem = new UIBarButtonItem (LocationSearchBar );
this .NavigationItem .RightBarButtonItem =searchButtonItem; 
```

# r - 矢量未正确设置

> ID：16123553
> 
> 赞同：0
> 
> 时间：2013-04-20T18:06:50.693
> 
> 标签：r

这个 R 代码：

```
avector <- as.vector(top.links.added.overall$Amount)
x <- as.vector(top.links.added.overall[order(avector),])
x$Amount <- factor(x$Amount)
x$color[x$Amount == 100] <- "red"
x$color[x$Amount == 500] <- "blue"
x$color[x$Amount == 1000] <- "darkgreen"
dotchart(x$Amount,
         labels = row.names(x),
         cex=.7,
         groups = x$Amount,
         gcolor = "black",
         color = x$color,
         pch=19,
         main = "Gas Mileage for Car Models\ngrouped by cylinder",
         xlab = "Miles Per Gallon") 
```

返回此错误：

```
Error in dotchart(x$Amount, labels = row.names(x), cex = 0.7, groups = x$Amount,  : 
  'x' must be a numeric vector or matrix 
```

这是 top.links.added.overall 的数据文件：

```
Amount,Name
1000,Google
500,Cnn
100,Yahoo 
```

'x' 是一个向量，那么是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:18:18.380

删除转换为因子`x$Amount <- factor(x$Amount)` 并进行小的更改

```
dotchart(x$Amount,
     labels = row.names(x),
     cex=.7,
     groups = factor(x$Amount),
     gcolor = "black",
     color = x$color,
     pch=19,
     main = "Gas Mileage for Car Models\ngrouped by cylinder",
     xlab = "Miles Per Gallon") 
```

可能这会对你有所帮助。

# php - 将数据库记录从东部时间转换为格林威治标准时间

> ID：16123555
> 
> 赞同：2
> 
> 时间：2013-04-20T18:07:14.200
> 
> 标签：php, mysql, datetime

我的数据库中有几张表，特别是最初是根据东部时间设置的。它有 12k+ 条记录，我试图找到一种理智的方法来覆盖这些表上的数据时间记录，以匹配一个等效的 gmt 日期时间，而不必构建一个循环来逐一更新所有行。是否可以有效地做到这一点，还是我将不得不一个一个地循环它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:14:37.443

您可以使用 CONVERT_TZ() 函数。但在进行任何操作之前，请尝试进行备份（例如，将您的列复制到另一个名为 timetest 的列）

然后试试这个：

```
UPDATE table_name SET timecolumn = CONVERT_TZ(timecolumn,'EST','GMT'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:13:14.420

[`ADDTIME()`](https://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_addtime)功能呢？您可以通过一个简单的查询来更新您需要的所有列

# android - 如何在同一布局中使用两个或多个 autocompletetextview？

> ID：16123560
> 
> 赞同：0
> 
> 时间：2013-04-20T18:07:39.390
> 
> 标签：android, autocompletetextview

我正在尝试用**两个** `AutoCompletetextView`s 进行布局，问题是如何区分`.addTextChangedListener(this)`每个。

我的意思是一个`EditText`可以通过它自己来区分`View.getId()`，并根据这个来做不同的事情`Id`，但我不知道该怎么做`AutoCompleteTextViews`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:16:07.660

添加`this`到侦听器是 jsut 可选实现 - 基本上您需要添加正在实现的事物的实例[`TextWatcher`](http://developer.android.com/reference/android/text/TextWatcher.html)，并且许多人倾向于这样做使`Activity`类实现接口。但是，在您的情况下，如果您有两个内部类以您需要的方式实现接口，则可能会更容易。

`addTextChangedListener`基本上，即使在方法调用中定义了类，您也可以添加侦听器，如下所示：

```
editText.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence s, int start, int before,
             int count) {
        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
             int after) {
        }

        @Override
        public void afterTextChanged(Editable s) {
        }
    }); 
```

# flash - 如何使用列表组件中的选定数据填充动态文本框？

> ID：16123563
> 
> 赞同：0
> 
> 时间：2013-04-20T18:07:51.383
> 
> 标签：flash, actionscript-2

目前我有一个列表组件，它会自动填充来自 mySQL 数据库的数据。代码如下所示。

是否可以从列表中选择一个变量并将其存储为单独的变量？因此，我可以在需要时将其显示给用户。

```
var theXML:XML = new XML();
theXML.ignoreWhite = true;

theXML.onLoad = function() {
    var nodes = this.firstChild.childNodes;
    for(i=0;i<nodes.length;i++) {
        theList.addItem(nodes[i].firstChild.nodeValue,i);
    }
}

theXML.load("http://localhost/fyptest/products.php"); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:19:43.403

`getItemAt(n)`您可以使用其中 n 是所需行的索引来访问列表数据。[您可以在此处](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00002548.html)获取更多详细信息和示例。

例如，在您的情况下`var myLabel = theList.getItemAt(0)`将返回第一个项目值。

# c# - 选择查询返回空记录

> ID：16123564
> 
> 赞同：0
> 
> 时间：2013-04-20T18:08:02.657
> 
> 标签：c#, sql, ms-access, oledb

嘿，基本上我有一个 C# 应用程序，允许用户输入他们对库存汽车的查询（字段是汽车制造商、型号、年龄、升大小）。

查询的内容可能因用户正在查找的字段而异（例如，一个人可能会查找所有福特汽车，或者另一个查询可能是所有 6 岁的福特汽车）。

输入查询后，程序应该将请求的数据返回到表单上的 dataGridView。我的问题是查询执行但只返回一个空白记录，好像它找不到合适的记录（我只输入了肯定会返回记录的查询）这让我相信我的编码有问题（特别是参数）但我无法弄清楚我要去哪里错了，有人可以帮忙吗？

```
 string ConnStr = "Provider = Microsoft.ACE.OLEDB.12.0; Data Source = H:\\School Work\\Computing A Level\\Stock checker\\Program\\Morgan's Motors Database.mdb;";

            OleDbConnection conn_database = new OleDbConnection();
            conn_database.ConnectionString = ConnStr;

            OleDbCommand comm_database = new OleDbCommand();
            comm_database.CommandText = "SELECT * FROM [Car Info] WHERE ? = ?";
            comm_database.Connection = conn_database;
            conn_database.Open();

            OleDbDataAdapter adap_database = new OleDbDataAdapter(comm_database);

            DataTable data_database = new DataTable();

            for (int i = 0; i < ColumnName.Count; i++)
            {
                comm_database.Parameters.AddWithValue("?", ColumnName[i].ToString());
                comm_database.Parameters.AddWithValue("?", EnteredFields[i].ToString());

                adap_database.Fill(data_database);

            }

            BindingSource bind_database = new BindingSource();
            bind_database.DataSource = data_database;

            dataGridView1.DataSource = bind_database; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:19:12.553

有两件事对我来说很奇怪：

```
comm_database.CommandText = "SELECT * FROM [Car Info] WHERE ? = ?"; 
```

1.  字段名称应该是真实的而不是“？” （但“？”对于值是正确的）。
2.  在您的查询中，您只指定一对文件=值，但在您下方循环并将参数添加到您的 dbcommand。因为它们与您的 sql 文本中的任何内容都没有关系，所以它不会按预期工作。

comm_database.CommandText = "SELECT * FROM [汽车信息] WHERE ";

```
for (int i = 0; i < ColumnName.Count; i++)
{

    comm_database.CommandText += (i>0 ? " AND " : "") ColumnName[i].ToString() + " = ?";

    comm_database.Parameters.AddWithValue("?", EnteredFields[i].ToString());

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T20:45:16.247

列名不能绑定参数。这...

```
comm_database.Parameters.AddWithValue("?", ColumnName[i].ToString()); 
```

...被解释为一个值，而不是列名。

*   如果该值与第二个参数的值不同，则不会返回任何行（因为`WHERE ? = ?`计算结果为 false，无论数据库中实际存在什么）。
*   如果它们相等，则将返回*所有行（同样，无论数据库中实际存在什么）。*

这是适合使用动态 SQL 的情况之一：在运行时构造 SQL 文本，一旦知道所有搜索条件（您仍应使用参数作为搜索值），如下所示：

```
"SELECT * FROM [Car Info] WHERE COLUMN1 = ? AND COLUMN2 = ?" (etc...) 
```

确保`COLUMN1`等`COLUMN2`在被插入 SQL 文本之前被列入白名单，或者以其他方式“清理”。

即使面对这种不断变化的搜索条件，也有一些方法可以使用静态 SQL，但这可能会在[性能方面产生意想不到的后果](http://use-the-index-luke.com/sql/myth-directory/dynamic-sql-is-slow)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:17:47.673

我想你的问题是你的选择语句。您必须在命令文本中明确命名参数。您正在使用的语句：

```
"SELECT * FROM [Car Info] WHERE ? = ?" 
```

因此应该改为这样的（取决于你的参数）

```
"SELECT * FROM [Car Info] WHERE BRAND = ? AND ..." 
```

另请参阅：[OleDbCommand 参数顺序和优先级](https://stackoverflow.com/questions/1476770/oledbcommand-parameters-order-and-priority)

# php - 处理 Firstdata 全球网关 API 的 SOAP 响应

> ID：16123568
> 
> 赞同：0
> 
> 时间：2013-04-20T18:08:16.667
> 
> 标签：php, soap

我已经阅读了这里的问题和答案。 [处理 SOAP 响应](https://stackoverflow.com/questions/13649770/processing-soap-response)

所以我有几乎相同的东西，但有些物品的情况不同

我得到错误

> 警告：main() [function.main]：节点不再存在于第 XX 行的 result.php 中，错误的行是 response = ...。

这是我的代码（result.php）

```
<?php 
$result = "<soap-env:envelope xmlns:soap-env='http://schemas.xmlsoap.org/soap/envelope/'><soap-env:header><soap-env:body><fdggwsapi:fdggwsapiorderresponse xmlns:fdggwsapi='http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi'><fdggwsapi:commercialserviceprovider><fdggwsapi:transactiontime>Fri Apr 19 16:35:45 2013</fdggwsapi:transactiontime><fdggwsapi:transactionid><fdggwsapi:processorreferencenumber><fdggwsapi:processorresponsemessage><fdggwsapi:errormessage>SGS-005003: The order already exists in the database.</fdggwsapi:errormessage><fdggwsapi:orderid>25</fdggwsapi:orderid><fdggwsapi:approvalcode><fdggwsapi:avsresponse><fdggwsapi:tdate><fdggwsapi:transactionresult>DUPLICATE</fdggwsapi:transactionresult><fdggwsapi:processorresponsecode><fdggwsapi:processorapprovalcode><fdggwsapi:calculatedtax><fdggwsapi:calculatedshipping><fdggwsapi:transactionscore><fdggwsapi:fraudaction><fdggwsapi:authenticationresponsecode></fdggwsapi:authenticationresponsecode></fdggwsapi:fraudaction></fdggwsapi:transactionscore></fdggwsapi:calculatedshipping></fdggwsapi:calculatedtax></fdggwsapi:processorapprovalcode></fdggwsapi:processorresponsecode></fdggwsapi:tdate></fdggwsapi:avsresponse></fdggwsapi:approvalcode></fdggwsapi:processorresponsemessage></fdggwsapi:processorreferencenumber></fdggwsapi:transactionid></fdggwsapi:commercialserviceprovider></fdggwsapi:fdggwsapiorderresponse></soap-env:body></soap-env:header></soap-env:envelope>"

    print "<br /><hr /><br />";

    $response = "";
    $obj2 = "";
    $obj2 = simplexml_load_string($result);
    $obj2->registerXPathNamespace('soap-env', 'http://schemas.xmlsoap.org/soap/envelope/');
    $obj2->registerXPathNamespace('fdggwsapi','http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi');

    $response = $obj2->children('http://schemas.xmlsoap.org/soap/envelope/')->body->children('http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi')->fdggwsapiorderresponse;

echo $response->transactiontime . "\n";
echo $response->errormessage; 
```

结果产生的 vardump

```
string(1427) "<soap-env:envelope xmlns:soap-env='http://schemas.xmlsoap.org/soap/envelope/'><soap-env:header><soap-env:body><fdggwsapi:fdggwsapiorderresponse xmlns:fdggwsapi='http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi'><fdggwsapi:commercialserviceprovider><fdggwsapi:transactiontime>Fri Apr 19 16:35:45 2013</fdggwsapi:transactiontime><fdggwsapi:transactionid><fdggwsapi:processorreferencenumber><fdggwsapi:processorresponsemessage><fdggwsapi:errormessage>SGS-005003: The order already exists in the database.</fdggwsapi:errormessage><fdggwsapi:orderid>25</fdggwsapi:orderid><fdggwsapi:approvalcode><fdggwsapi:avsresponse><fdggwsapi:tdate><fdggwsapi:transactionresult>DUPLICATE</fdggwsapi:transactionresult><fdggwsapi:processorresponsecode><fdggwsapi:processorapprovalcode><fdggwsapi:calculatedtax><fdggwsapi:calculatedshipping><fdggwsapi:transactionscore><fdggwsapi:fraudaction><fdggwsapi:authenticationresponsecode></fdggwsapi:authenticationresponsecode></fdggwsapi:fraudaction></fdggwsapi:transactionscore></fdggwsapi:calculatedshipping></fdggwsapi:calculatedtax></fdggwsapi:processorapprovalcode></fdggwsapi:processorresponsecode></fdggwsapi:tdate></fdggwsapi:avsresponse></fdggwsapi:approvalcode></fdggwsapi:processorresponsemessage></fdggwsapi:processorreferencenumber></fdggwsapi:transactionid></fdggwsapi:commercialserviceprovider></fdggwsapi:fdggwsapiorderresponse></soap-env:body></soap-env:header></soap-env:envelope>" 
```

这是以更漂亮的形式出现的 SOAP 响应，这就是您正在寻找的

```
<soap-env:envelope xmlns:soap-env='http://schemas.xmlsoap.org/soap/envelope/'>
<soap-env:header><soap-env:body>
<fdggwsapi:fdggwsapiorderresponse xmlns:fdggwsapi='http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi'>
    <fdggwsapi:commercialserviceprovider>
        <fdggwsapi:transactiontime>Fri Apr 19 16:35:45 2013</fdggwsapi:transactiontime>
        <fdggwsapi:transactionid>
            <fdggwsapi:processorreferencenumber>
                <fdggwsapi:processorresponsemessage>
                <fdggwsapi:errormessage>SGS-005003: The order already exists in the database.</fdggwsapi:errormessage>
                <fdggwsapi:orderid>25</fdggwsapi:orderid>
                    <fdggwsapi:approvalcode>
                    <fdggwsapi:avsresponse>
                        <fdggwsapi:tdate>
                        <fdggwsapi:transactionresult>DUPLICATE</fdggwsapi:transactionresult>
                            <fdggwsapi:processorresponsecode>
                                <fdggwsapi:processorapprovalcode>
                                    <fdggwsapi:calculatedtax>
                                        <fdggwsapi:calculatedshipping>
                                            <fdggwsapi:transactionscore>
                                                <fdggwsapi:fraudaction>
                                                    <fdggwsapi:authenticationresponsecode>
                                                    </fdggwsapi:authenticationresponsecode>
                                                </fdggwsapi:fraudaction>
                                            </fdggwsapi:transactionscore>
                                        </fdggwsapi:calculatedshipping>
                                    </fdggwsapi:calculatedtax>
                                </fdggwsapi:processorapprovalcode>
                            </fdggwsapi:processorresponsecode>
                        </fdggwsapi:tdate>
                    </fdggwsapi:avsresponse>
                </fdggwsapi:approvalcode>
                </fdggwsapi:processorresponsemessage>
            </fdggwsapi:processorreferencenumber>
        </fdggwsapi:transactionid>
    </fdggwsapi:commercialserviceprovider>
</fdggwsapi:fdggwsapiorderresponse>
</soap-env:body>
</soap-env:header>
</soap-env:envelope>" 
```

# jquery - Jquery 函数 - 同名复选框

> ID：16123569
> 
> 赞同：2
> 
> 时间：2013-04-20T18:08:18.817
> 
> 标签：jquery

我有大约 20 个同名复选框，但 id 值不一样

```
 <input type="checkbox" name="device" id="1_2"/>
 <input type="checkbox" name="device" id="10_4"/>
 <input type="checkbox" name="device" id="5_6"/>
 <input type="checkbox" name="device" id="4_0"/>
 <input type="checkbox" name="device" id="8_9"/>
 <input type="checkbox" name="device" id="3_4"/> 
```

我想要一个功能，如果我点击一个复选框，那么我会收到一个带有 ID 值的警报

例如，如果我点击第一个复选框

```
alert("Value before _ : 1 - Value after _ : 2") 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:13:45.457

这就是你要找的

```
 $(document).ready(function () {
        $('input[type="checkbox"]').click(function(){
           var vals = this.id.split('_');
           alert("Value before _ : "+vals[0]+" - Value after _ : " + vals[1])
        })
     }) 
```

单击每个复选框时调用此函数。它使用 javascript 的[split](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)函数将 id 属性值*拆分*为一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:14:15.307

这是你需要的吗？ `[Demo](http://jsfiddle.net/Mcqds/)`

```
 $('input:checkbox[name="device"]').click(function(){
    var id = $(this).attr('id');
    alert( 'Value before:' + id.split('_')[0] + ' - Value after:' + id.split('_')[1] );
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T18:16:58.997

这是一个例子：[jsfiddle](http://jsfiddle.net/kz4En/)

希望它是您所需要的，玩得开心。

**HTML** : (向输入添加一个类)

```
 <input class='try' type="checkbox" name="device" id="1_2"/>
 <input class='try' type="checkbox" name="device" id="10_4"/>
 <input class='try' type="checkbox" name="device" id="5_6"/>
 <input class='try' type="checkbox" name="device" id="4_0"/>
 <input class='try' type="checkbox" name="device" id="8_9"/>
 <input class='try' type="checkbox" name="device" id="3_4"/> 
```

**脚本**：（点击事件）

```
$('.try').click(function() {
    var idd= $(this).attr('id');
    var explode = idd.split('_');
    alert('Value before:' + explode[0] + ' - Value after:' + explode[1]);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T18:13:55.683

```
$("input[type=checkbox]").click(function(){
   arr = $(this).attr("id").split("_");
   alert("Value before _ :"+arr[0]+" Value after _ :"+arr[1]);
}); 
```

这是**[jsFiddle](http://jsfiddle.net/5Beck/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T18:16:01.553

```
$("input[type=checkbox]").click(function(){
     alert($(this).attr("id"))
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-20T18:25:20.917

我希望这个能帮上忙：

```
     $('input:checkbox[name="device"]').click( function(){
         var selected_data = $(this).attr('id').split('_');
         alert('_ 之前的值：' + selected_data[0] + ' - ' + '_ 之后的值：' + selected_data[1]);
     });

```

# php - 从 html 文档中回显具有 class="pret" 的内容

> ID：16123571
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:08:34.733
> 
> 标签：php, regex

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:42:24.057

希望您尝试解析有效​​（至少足够有效）的 HTML 文档，您应该使用[`DOM`](http://php.net/manual/en/book.dom.php)它：

```
// Simple example from php manual from comments
$xml = new DOMDocument(); 
$xml->loadHTMLFile($url); 
$links = array(); 

foreach($xml->getElementsByTagName('a') as $link) { 
    $links[] = array('url' => $link->getAttribute('href'),
                     'text' => $link->nodeValue); 
} 
```

注意使用[`loadHTML`](http://php.net/manual/en/domdocument.loadhtmlfile.php)not [`load`](http://php.net/manual/en/domdocument.load.php)（它对错误更健壮）。您也可以设置[`DOMDocument::recover`](http://www.php.net/class.domdocument.php#domdocument.props.recover)（如 hakre 评论中所建议的那样），以便解析器尝试从错误中恢复。

或者你可以使用[`xPath`](http://php.net/manual/en/class.domxpath.php)（[这里是语法的解释](http://www.w3schools.com/xpath/xpath_syntax.asp)）：

```
$xpath = new DOMXpath($doc);
$elements = $xpath->query("//a[@class='pret']");

if (!is_null($elements)) {
    foreach ($elements as $element) {
        $links[] = array('url' => $link->getAttribute('href'),
                         'text' => $link->nodeValue); 
    }
} 
```

对于**无效 HTML**的情况，您可以像这样使用正则表达式：

```
$a1 = '\s*[^\'"=<>]+\s*=\s*"[^"]*"'; # Attribute with " - space tolerant
$a2 = "\s*[^'\"=<>]+\s*=\s*'[^']*'"; # Attribute with ' - space tolerant
$a3 = '\s*[^\'"=<>]+\s*=\s*[\w\d]*' # Unescaped values - space tolerant
# [^'"=<>]* # Junk - I'm not inserting this to regexp but you may have to

$a = "(?:$a1|$a2|$a2)*"; # Any number of arguments
$class = 'class=([\'"])pret\\1'; # Using ?: carefully is crucial for \\1 to work
                                 # otherwise you can use ["']
$reg = "<a{$a}\s*{$class}{$a}\s*>(.*?)</a"; 
```

然后只是`preg_match_all`。[所有的正则表达式都是从我的脑海中写出来的——你可能需要调试它们]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T06:50:47.387

得到这样的链接

```
preg_match_all('/<a[^>]*class="pret">(.*?)<\\/a>/si', $content, $links);
print_r($links[0]); 
```

结果是

```
Array(
[0] => <a href='/word_word_34670_word_number.htm' class="pret"><span>3340.3570 word</span></a>..........) 
```

所以我需要得到里面的第一个数字`href`和之间的数字`span`

# python - 朴素贝叶斯分类器的 K 折交叉验证

> ID：16123572
> 
> 赞同：5
> 
> 时间：2013-04-20T18:08:34.717
> 
> 标签：python, scikit-learn, cross-validation

我使用 nltk 创建了一个分类器，它将评论分为 3 个类 pos、neg 和 neu。

```
def get_feature(word):
    return dict([(word, True)])

def bag_of_words(words):
    return dict([(word, True) for word in words])

def create_training_dict(text, sense):
    ''' returns a dict ready for a classifier's test method '''
    tokens = extract_words(text)
    return [(bag_of_words(tokens), sense)]

def get_train_set(texts):
    train_set = []
    for words, sense in texts:
        train_set = train_set + [(get_feature(word), sense) for word in words]
    return train_set

doc_bow.append((top_tfidf,polarity))

train_set = get_train_set(doc_bow)
classifier = NaiveBayesClassifier.train(train_set)

decision = classifier.classify(tokens) 
```

现在，我想做一个 10 倍交叉验证来测试分类器。我从 sklearn 中找到了一个示例。

```
from sklearn import cross_validation
from sklearn.naive_bayes import MultinomialNB

target = np.array( [x[0] for x in train_set] )
train = np.array( [x[1:] for x in train_set] )
cfr = MultinomialNB()

#Simple K-Fold cross validation. 10 folds.
cv = cross_validation.KFold(len(train_set), k=10, indices=False)
results = []
for traincv, testcv in cv:
    probas = cfr.fit(train[traincv], target[traincv]).predict_proba(train[testcv])
    results.append( myEvaluationFunc(target[testcv], [x[1] for x in probas]) )
print "Results: " + str( np.array(results).mean() ) 
```

我收到此错误

```
raise ValueError("Input X must be non-negative.")
ValueError: Input X must be non-negative. 
```

我不确定我传入的参数是否正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-01T21:32:28.870

MultinomialNB 旨在用于非负特征值。

你试过[GaussianNB](http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.GaussianNB.html#sklearn.naive_bayes.GaussianNB)吗？

# ios - iOS 背景图像在设备上不起作用

> ID：16123573
> 
> 赞同：0
> 
> 时间：2013-04-20T18:08:37.647
> 
> 标签：ios, image, background, device

这是我的问题：

我将此添加到我的代码中：

```
[self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"bgWhiteLight"]]]; 
```

它在iOS模拟器中运行良好，但是当我在真实设备上测试它时，它根本不起作用。请注意，我重新定义了

```
self.navigationItem.titleView 
```

但是模拟器中根本没有pb，只有在真实设备上！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:29:34.667

有时只指定文件名是不够的，你可以这样做

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"bgWhiteLight" ofType:@"jpg"];
self.view.backgroundColor = [[UIColor alloc] initWithPatternImage:[[UIImage alloc] initWithContentsOfFile:path]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:39:13.427

```
[self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"bgWhiteLight.png"]]]; 
```

尝试这个。给出图像的全名

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:24:14.753

在设备上，名称区分大小写。确保它正是名称。

# java - 一个 getInputMap 的多个键

> ID：16123574
> 
> 赞同：1
> 
> 时间：2013-04-20T18:08:42.457
> 
> 标签：java, key-bindings

当我同时按下 2 个按钮时，我正在寻找一种使用某个动作的方法。实际上，如果我先按 D（用于移动）然后按 S（用于运行），角色可以运行。但是当我尝试先按 S 然后按 D 时，角色根本不会移动。我这样做了：

```
GameWindow.eng.getInputMap().put(KeyStroke.getKeyStroke("S D"), "Run and move");

GameWindow.eng.getActionMap().put("Run and move", new AbstractAction(){
    private static final long serialVersionUID = 8491492566619071329L;

    @Override
    public void actionPerformed(ActionEvent e){
        System.out.println("Hi!")
    }
}); 
```

但这似乎不起作用。跳跃也是一样。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:11:09.930

正确使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。这是一个简短的示例来展示如何使用它们。

```
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;

import javax.swing.AbstractAction;
import javax.swing.ActionMap;
import javax.swing.InputMap;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.KeyStroke;

public class KeyBindingsTest {
    JFrame frame = new JFrame();

    public KeyBindingsTest() {
        ActionMap actionMap = frame.getRootPane().getActionMap();
        InputMap inputMap = frame.getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);

        for (Keys direction : Keys.values()) {
            actionMap.put(direction.getText(), new KeyBinding(direction.getText()));
            inputMap.put(direction.getKeyStroke(), direction.getText());
        }

        frame.getRootPane().setActionMap(actionMap);
        frame.getRootPane().setInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW, inputMap);
        frame.setVisible(true);
    }

    private class KeyBinding extends AbstractAction {
        private static final long serialVersionUID = 1L;

        public KeyBinding(String text) {
            super(text);
            putValue(ACTION_COMMAND_KEY, text);
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            String action = e.getActionCommand();
            System.out.println("Key Binding: " + action);
        }
    }

    public static void main(String... args) {
        new KeyBindingsTest();
    }

    private enum Keys {
        ESCAPE ("Escape",    KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0)),
        CTRLC  ("Control-C", KeyStroke.getKeyStroke(KeyEvent.VK_C,      KeyEvent.CTRL_DOWN_MASK)),
        CTRLP  ("Control-P", KeyStroke.getKeyStroke(KeyEvent.VK_P,      KeyEvent.CTRL_DOWN_MASK)),
        UP     ("Up",        KeyStroke.getKeyStroke(KeyEvent.VK_UP,     0)),
        DOWN   ("Down",      KeyStroke.getKeyStroke(KeyEvent.VK_DOWN,   0)),
        LEFT   ("Left",      KeyStroke.getKeyStroke(KeyEvent.VK_LEFT,   0)),
        RIGHT  ("Right",     KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT,  0));

        private String text;
        private KeyStroke keyStroke;

        private Keys(String text, KeyStroke keyStroke) {
            this.text = text;
            this.keyStroke = keyStroke;
        }

        public String getText() {
            return text;
        }

        public KeyStroke getKeyStroke() {
            return keyStroke;
        }

        @Override
        public String toString() {
            return text;
        }
    }
} 
```

# c - c - 提取注释和字符串 - 已编辑

> ID：16123576
> 
> 赞同：0
> 
> 时间：2013-04-20T18:08:47.863
> 
> 标签：c, sliding-window

这是我以前的问题的编辑、更正、更具体的版本。所以我正在做一个家庭作业，我们必须使用一个滑动窗口来打印来自标准输入的输入文件中的注释和字符串。我非常接近，但缺少一些东西。以下是我的代码、输入、当前输出和正确的输出。`//`评论和忽略字符有效。我不完全确定字符串和 /**/ 注释中的问题我无法摆脱最初的星号`/*`而不搞砸它找到`*/`. 感谢任何可以提供帮助的人。

代码：

```
#include <stdio.h>
typedef enum  
{  
    Initial,
    Comment,  
    String,  
    Char,
    CPPComment  
} extrema; 
int main()
{
    int c, c1 = 0, c2 = 0;
    extrema state = Initial;
    extrema next = Initial;
    while(1)
    {
        switch(state)
        {
           case Initial: next = ((c2 == '*' && c1 == '/') ? Comment : (c2 == '\"') ? String : (c2 == '/' && c1 == '/') ? Char : (c2 == '\'') ? CPPComment : Initial); break; 
           case Comment: next = ((c2 == '/' && c1 == '*') ? Initial : Comment); break; 
           case String: next = ((c2 == '\"' && c1 != '\\') ? Initial : String); break;
           case Char: next = ((c2 == '\n') ? Initial : Char); break;
           case CPPComment: next = ((c2 == '\'' && c1 != '\\') ? Initial : CPPComment); break;
           default: next = state; 
        }
        if(state == Comment)
        {
            if(c1 == '*')
            {
                if(c2 != '/')
                    putchar(c1);
                else
                    putchar('\n');  
            }
            else
                putchar(c1);
        }
        else if(state == String)
        {
            if(c2 != '\"' || (c2 == '\"' && c1 != '\\'))
                putchar(c2);
        }
        else if(state == CPPComment)
        {
                putchar(c2);
        }

        c = getchar(); if( c < 0) break;
        c1 = c2; c2 = c; // slide window
//printf("%i",state);
        state = next;
        // c2 is the current input byte and c1 is the previous input byte
    }
    return 0;
} 
```

输入：

```
 /* recognize '...' otherwise see " as start of string: */

     int c='\"', d='\'', e = '\012'; // comment line 3

 /* recognize "..." otherwise see comments here: */

     char s[] = "abc/*not a comment*/efg\"ZZ\'";

     char t[] = "ABC//not a comment//EFG\x012\/\/";

char *p = ""; //

int d = '/*'; // comment line 13

/*/*/
/**/
/*Z*/
/***/
/****/
/**A**/ 
```

我的输出：

```
* recognize '...' otherwise see " as start of string: 
 comment line 3
* recognize "..." otherwise see comments here: 
abc/*not a comment*/efg\ZZ\'"ABC//not a comment//EFG\x012\/\/""
 comment line 13

*
*Z
**
***
**A* 
```

正确的输出：

```
 recognize '...' otherwise see " as start of string: 
 comment line 3
 recognize "..." otherwise see comments here: 
abc/*not a comment*/efg\"ZZ\'
ABC//not a comment//EFG\x012\/\/

 comment line 13
/

Z
*
**
*A* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T19:02:48.103

你可以这样做：

```
 /* recognize '...' otherwise see " as start of string: */

     int c='\"', d='\'', e = '\012'; // comment line 3

 /* recognize "..." otherwise see comments here: */

     char s[] = "abc/*not a comment*/efg\"ZZ\'";

     char t[] = "ABC//not a comment//EFG\x012\/\/";

char *p = ""; //

int dd = '/*'; // comment line 13

/*/*/
/**/
/*Z*/
/***/
/****/
/**A**/

#include <stdio.h>
#include <stdlib.h>

int main(int argc, char** argv)
{
  FILE* f;

  if (argc == 2 && (f = fopen(argv[1], "rt")) != NULL)
  {
    int c[2];

    enum {
      INITIAL,
      CCOMMENT1,
      CCOMMENT2,
      CCOMMENT3,
      CPPCOMMENT1,
      CPPCOMMENT2,
      STRING1,
      STRING2,
      CHAR1,
      CHAR2,
    } state = INITIAL;

    if ((c[0] = fgetc(f)) == EOF)
      return 0;

    while ((c[1] = fgetc(f)) != EOF)
    {
      switch (state)
      {
      case INITIAL:
        if (c[0] == '/' && c[1] == '*')
          state = CCOMMENT1, printf("<C comment>\n");
        else if (c[0] == '/' && c[1] == '/')
          state = CPPCOMMENT1, printf("<C++ comment>\n");
        else if (c[0] == '"')
          state = STRING1, printf("<String literal>\n");
        else if (c[0] == '\'')
          state = CHAR1, printf("<Char literal>\n");
        break;

      case CCOMMENT1:
      case CPPCOMMENT1:
        /* skip * in /* and 2nd / in // */
        state++;
        break;

      case CCOMMENT2:
        if (c[0] == '*' && c[1] == '/')
          state++, printf("\n</C comment>\n");
        else
          printf("%c", c[0]);
        break;

      case CCOMMENT3:
        // skip / in */
        state = INITIAL;
        break;

      case CPPCOMMENT2:
        if (c[0] == '\n')
          state = INITIAL, printf("\n</C++ comment>\n");
        else
          printf("%c", c[0]);
        break;

      case STRING1:
        if (c[0] == '"')
          state = INITIAL, printf("\n</String literal>\n");
        else if (c[0] == '\\')
          state = STRING2, printf("%c", c[0]);
        else
          printf("%c", c[0]);
        break;

      case STRING2:
        // skip escaped character
        state = STRING1, printf("%c", c[0]);
        break;

      case CHAR1:
        if (c[0] == '\'')
          state = INITIAL, printf("\n</Char literal>\n");
        else if (c[0] == '\\')
          state = CHAR2, printf("%c", c[0]);
        else
          printf("%c", c[0]);
        break;

      case CHAR2:
        // skip escaped character
        state = CHAR1, printf("%c", c[0]);
        break;
      }

      c[0] = c[1];
    }

    fclose(f);
  }

  return 0;
} 
```

该程序在其源代码上的输出：

```
<C comment>
 recognize '...' otherwise see " as start of string: 
</C comment>
<Char literal>
\"
</Char literal>
<Char literal>
\'
</Char literal>
<Char literal>
\012
</Char literal>
<C++ comment>
 comment line 3
</C++ comment>
<C comment>
 recognize "..." otherwise see comments here: 
</C comment>
<String literal>
abc/*not a comment*/efg\"ZZ\'
</String literal>
<String literal>
ABC//not a comment//EFG\x012\/\/
</String literal>
<String literal>

</String literal>
<C++ comment>

</C++ comment>
<Char literal>
/*
</Char literal>
<C++ comment>
 comment line 13
</C++ comment>
<C comment>
/
</C comment>
<C comment>

</C comment>
<C comment>
Z
</C comment>
<C comment>
*
</C comment>
<C comment>
**
</C comment>
<C comment>
*A*
</C comment>
<String literal>
rt
</String literal>
<Char literal>
/
</Char literal>
<Char literal>
*
</Char literal>
<String literal>
<C comment>\n
</String literal>
<Char literal>
/
</Char literal>
<Char literal>
/
</Char literal>
<String literal>
<C++ comment>\n
</String literal>
<Char literal>
"
</Char literal>
<String literal>
<String literal>\n
</String literal>
<Char literal>
\'
</Char literal>
<String literal>
<Char literal>\n
</String literal>
<C comment>
 skip * in /* and 2nd / in // 
</C comment>
<Char literal>
*
</Char literal>
<Char literal>
/
</Char literal>
<String literal>
\n</C comment>\n
</String literal>
<String literal>
%c
</String literal>
<C++ comment>
 skip / in */
</C++ comment>
<Char literal>
\n
</Char literal>
<String literal>
\n</C++ comment>\n
</String literal>
<String literal>
%c
</String literal>
<Char literal>
"
</Char literal>
<String literal>
\n</String literal>\n
</String literal>
<Char literal>
\\
</Char literal>
<String literal>
%c
</String literal>
<String literal>
%c
</String literal>
<C++ comment>
 skip escaped character
</C++ comment>
<String literal>
%c
</String literal>
<Char literal>
\'
</Char literal>
<String literal>
\n</Char literal>\n
</String literal>
<Char literal>
\\
</Char literal>
<String literal>
%c
</String literal>
<String literal>
%c
</String literal>
<C++ comment>
 skip escaped character
</C++ comment>
<String literal>
%c
</String literal> 
```

# base64 - PHP 等效于 sha1.toString(CryptoJS.enc.Base64)

> ID：16123580
> 
> 赞同：0
> 
> 时间：2013-04-20T18:09:16.740
> 
> 标签：base64, sha1, cryptojs

我正在将 JS 脚本转换为 PHP。该脚本使用 CryptoJS 库并使用以下行生成哈希：

```
var sha1 = CryptoJS.SHA1("message");
var sig = sha1.toString(CryptoJS.enc.Base64); 
```

我试过这个php代码

```
$sha1 = sha1("message");
$sig = base64_encode($sha1); 
```

但签名不一样，它在 php.ini 中更长。

非常感谢和需要您的帮助！

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:23:09.093

好的，我只需要在 sha1 函数中将 $raw_output 设置为 true ！

```
$sha1 = sha1("message", true); 
```

现在我看起来很傻

# python - 在 Mac Ports 中安装旧版本的 swig-python？

> ID：16123584
> 
> 赞同：1
> 
> 时间：2013-04-20T18:09:42.047
> 
> 标签：python, macos, swig, ports

我使用的工具需要`swig`比当前版本更旧的`MacPorts`.

我可以`swig 2.0.8_2`使用本指南进行安装： [如何安装旧版本的端口](https://trac.macports.org/wiki/howto/InstallingOlderPort) ，它工作正常。

但是，我也需要相应的`swig-python`包。我无法找到旧`swig-python`包。在 mac 端口上搜索只会产生[这个结果](http://www.macports.org/ports.php?by=library&substr=swig-python)，这会将我带到 swig 存储库，并且似乎没有用于 python 绑定的端口文件。

**问题：**

*   *如何找到`swig-python`我需要的旧版本？*
*   *它是 swig repo 的一部分吗？*

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T03:04:18.273

弄清楚了。将 subport=swig-python 安装在与 swig 的 portfile 相同的目录中。

# haskell - 这种特殊的函子结构叫什么？

> ID：16123588
> 
> 赞同：13
> 
> 时间：2013-04-20T18:10:50.407
> 
> 标签：haskell, category-theory, applicative

假设 F 是具有附加定律的应用函子（使用 Haskell 语法）：

1.  `pure (const ()) <*> m` === `pure ()`
2.  `pure (\a b -> (a, b)) <*> m <*> n` === `pure (\a b -> (b, a)) <*> n <*> m`
3.  `pure (\a b -> (a, b)) <*> m <*> m` === `pure (\a -> (a, a)) <*> m`

如果我们省略（3.），结构叫什么？

我在哪里可以找到有关这些法律/结构的更多信息？

## 评论评论

满足 (2.) 的函子通常称为可交换函子。

现在的问题是，（1.）是否暗示（2.）以及如何描述这些结构。我对满足 (1-2.) 但不满足 (3.) 的结构特别感兴趣

例子：

*   读者单子满足 (1-3.)
*   可交换幺半群上的 writer monad 仅满足 (2.)
*   下面给出的 monad`F`满足 (1-2.) 但不满足 (3.)

的定义`F`：

```
{-# LANGUAGE GeneralizedNewtypeDeriving #-}
{-# LANGUAGE RankNTypes #-}
import Control.Monad.State

newtype X i = X Integer deriving (Eq)

newtype F i a = F (State Integer a) deriving (Monad)

new :: F i (X i)
new = F $ modify (+1) >> gets X

evalF :: (forall i . F i a) -> a
evalF (F m) = evalState m 0 
```

我们只导出类型`X`、、、、`F`和实例`new`。`evalF`

检查以下是否成立：

*   `liftM (const ()) m` === `return ()`
*   `liftM2 (\a b -> (a, b)) m n`===`liftM2 (\a b -> (b, a)) n m`

另一方面，`liftM2 (,) new new`不能替换为`liftM (\a -> (a,a)) new`：

```
test = evalF (liftM (uncurry (==)) $ liftM2 (,) new new)
    /= evalF (liftM (uncurry (==)) $ liftM (\a -> (a,a)) new) 
```

## 评论 CA McCann 的回答

我有一个证明草图，证明 (1.) 暗示 (2.)

```
pure (,) <*> m <*> n 
```

=

```
pure (const id) <*> pure () <*> (pure (,) <*> m <*> n) 
```

=

```
pure (const id) <*> (pure (const ()) <*> n) <*> (pure (,) <*> m <*> n) 
```

=

```
pure (.) <*> pure (const id) <*> pure (const ()) <*> n <*> (pure (,) <*> m <*> n) 
```

=

```
pure const <*> n <*> (pure (,) <*> m <*> n) 
```

= ... =

```
pure (\_ a b -> (a, b)) <*> n <*> m <*> n 
```

= 见下文 =

```
pure (\b a _ -> (a, b)) <*> n <*> m <*> n 
```

= ... =

```
pure (\b a -> (a, b)) <*> n <*> m 
```

=

```
pure (flip (,)) <*> n <*> m 
```

**观察**

对于缺失的部分，首先考虑

```
pure (\_ _ b -> b) <*> n <*> m <*> n 
```

= ... =

```
pure (\_ b -> b) <*> n <*> n 
```

= ... =

```
pure (\b -> b) <*> n 
```

= ... =

```
pure (\b _ -> b) <*> n <*> n 
```

= ... =

```
pure (\b _ _ -> b) <*> n <*> m <*> n 
```

**引理**

我们使用以下引理：

```
pure f1 <*> m  ===   pure g1 <*> m
pure f2 <*> m  ===   pure g2 <*> m 
```

暗示

```
pure (\x -> (f1 x, f2 x)) m  ===  pure (\x -> (g1 x, g2 x)) m 
```

我只能间接地证明这个引理。

**缺失的部分**

有了这个引理和第一个观察，我们可以证明

```
pure (\_ a b -> (a, b)) <*> n <*> m <*> n 
```

=

```
pure (\b a _ -> (a, b)) <*> n <*> m <*> n 
```

这是缺少的部分。

**问题**

这是否已经在某个地方得到证明（可能是广义的形式）？

## 评论

(1.) 暗示 (2.) 但否则 (1-3.) 是独立的。

为了证明这一点，我们还需要两个例子：

*   下面给出的 monad`G`满足 (3.) 但不满足 (1-2.)
*   下面给出的 monad`G'`满足 (2-3.) 但不满足 (1.)

的定义`G`：

```
newtype G a = G (State Bool a) deriving (Monad)

putTrue :: G ()
putTrue = G $ put True

getBool :: G Bool
getBool = G get

evalG :: G a -> a
evalG (G m) = evalState m False 
```

我们只导出类型`G`、`putTrue`、`getBool`、`evalG`和`Monad`实例。

的定义`G'`与 的定义类似，但`G`有以下区别：

我们定义和导出`execG`：

```
execG :: G' a -> Bool
execG (G m) = execState m False 
```

我们**不出口** `getBool`。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-20T19:29:40.060

你的第一定律是一个非常强烈的要求；这意味着函子不能有独立于参数部分的可区分的“形状”。这排除了任何包含额外值 ( `State`, `Writer`, &c.) 的仿函数以及任何使用 sum 类型 ( `Either`, `[]`, &c.) 的仿函数。所以这将我们限制在固定大小的容器之类的东西上。

您的第二定律需要交换性，这意味着嵌套顺序（即函子组合）无关紧要。这实际上可能由第一定律暗示，因为我们已经知道函子不能包含除参数值之外的任何信息，并且您明确要求在此处保留该信息。

您的第三定律要求函子也是幂等的，这意味着使用 fmap 将某些内容嵌套在自身内部等同于自身。这可能意味着如果函子也是单子，则`join`涉及某种“取对角线”。基本上，这意味着`liftA2 (,)`应该表现得像`zip`，而不是笛卡尔积。

第二个和第三个一起意味着无论函子可能有多少“原语”，任何组合都相当于以任何顺序组合每个原语中的最多一个。第一个意味着如果你丢弃参数信息，任何原语组合都与完全不使用相同。

总之，我认为你所拥有的是[同构于`Reader`](http://hackage.haskell.org/packages/archive/representable-functors/3.1/doc/html/Data-Functor-Representable.html). 也就是说，仿函数`f a`描述了`a`由其他类型索引的类型值，例如自然数的子集（对于固定大小的容器）或任意类型（如`Reader`）。

不幸的是，我不确定如何令人信服地证明上述大部分内容。

# java - Android SQLite 数据库删除行 NullPointerException

> ID：16123590
> 
> 赞同：0
> 
> 时间：2013-04-20T18:11:27.547
> 
> 标签：java, android, sqlite

当我尝试在我的管理类中删除我的用户名/密码/电子邮件列表视图行之一时，我从我的 DBAdapter 类中的 deletePlayer 收到 NullPointerException。我知道 NPE 来自我的删除方法，因为我删除了数据库。删除，打开和关闭我的 toast 可以在 onclick 上运行，但是当我实现它们时，我得到了 NPE。我很确定这是我的删除方法，但我已经尝试过寻找可以使用的正确删除方法，但我是找不到涉及删除数据库中用户的 USERNAME、PASSWORD 和 EMAIL 列的内容。

更新：我包含了 DBAdapter(context) 并将我的光标包含在我的数据库中的 deletePlayer 方法中，但现在我得到了一个代码 1 语法错误，如 LogCat 中所示

日志猫

```
 04-20 14:56:51.289: E/Trace(20896): error opening trace file: No such file or directory (2)
04-20 14:56:51.664: D/dalvikvm(20896): GC_FOR_ALLOC freed 78K, 11% free 8200K/9119K, paused 34ms, total 34ms
04-20 14:56:52.344: D/libEGL(20896): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
04-20 14:56:52.797: D/libEGL(20896): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
04-20 14:56:52.805: D/libEGL(20896): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
04-20 14:56:53.360: D/OpenGLRenderer(20896): Enabling debug mode 0
04-20 14:57:00.000: D/dalvikvm(20896): GC_CONCURRENT freed 66K, 3% free 9899K/10147K, paused 14ms+2ms, total 86ms
04-20 14:59:07.102: E/Trace(21554): error opening trace file: No such file or directory (2)
04-20 14:59:07.164: D/dalvikvm(21554): GC_FOR_ALLOC freed 61K, 11% free 8200K/9119K, paused 29ms, total 29ms
04-20 14:59:07.696: D/libEGL(21554): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
04-20 14:59:07.891: D/libEGL(21554): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
04-20 14:59:07.899: D/libEGL(21554): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
04-20 14:59:08.149: D/OpenGLRenderer(21554): Enabling debug mode 0
04-20 14:59:10.672: E/SQLiteLog(21554): (1) near ".": syntax error
04-20 14:59:10.672: D/AndroidRuntime(21554): Shutting down VM
04-20 14:59:10.672: W/dalvikvm(21554): threadid=1: thread exiting with uncaught exception (group=0x419742a0)
04-20 14:59:10.891: E/AndroidRuntime(21554): FATAL EXCEPTION: main
04-20 14:59:10.891: E/AndroidRuntime(21554): android.database.sqlite.SQLiteException: near ".": syntax error (code 1): , while compiling: DELETE FROM PLAYERS WHERE _id = android.database.sqlite.SQLiteCursor@4230c108
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteStatement.<init>(SQLiteStatement.java:31)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.database.sqlite.SQLiteDatabase.delete(SQLiteDatabase.java:1491)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at com.fullfrontalgames.numberfighter.DBAdapter.deletePlayer(DBAdapter.java:106)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at com.fullfrontalgames.numberfighter.Admin$MyListAdapter$1.onClick(Admin.java:66)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.view.View.performClick(View.java:4106)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.view.View$PerformClick.run(View.java:17052)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.os.Handler.handleCallback(Handler.java:615)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.os.Looper.loop(Looper.java:137)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at android.app.ActivityThread.main(ActivityThread.java:5059)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at java.lang.reflect.Method.invokeNative(Native Method)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at java.lang.reflect.Method.invoke(Method.java:511)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:792)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:555)
04-20 14:59:10.891: E/AndroidRuntime(21554):    at dalvik.system.NativeStart.main(Native Method)
04-20 14:59:10.961: D/dalvikvm(21554): GC_CONCURRENT freed 88K, 3% free 9886K/10147K, paused 13ms+5ms, total 75ms
04-20 14:59:13.172: I/Process(21554): Sending signal. PID: 21554 SIG: 9
04-20 15:03:13.141: E/Trace(22194): error opening trace file: No such file or directory (2)
04-20 15:03:13.399: D/dalvikvm(22194): GC_FOR_ALLOC freed 79K, 11% free 8200K/9119K, paused 57ms, total 58ms
04-20 15:03:13.844: D/libEGL(22194): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
04-20 15:03:13.883: D/libEGL(22194): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
04-20 15:03:13.891: D/libEGL(22194): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
04-20 15:03:14.055: D/OpenGLRenderer(22194): Enabling debug mode 0
04-20 15:03:17.352: E/SQLiteLog(22194): (1) near ".": syntax error
04-20 15:03:17.375: D/AndroidRuntime(22194): Shutting down VM
04-20 15:03:17.375: W/dalvikvm(22194): threadid=1: thread exiting with uncaught exception (group=0x419742a0)
04-20 15:03:17.414: E/AndroidRuntime(22194): FATAL EXCEPTION: main
04-20 15:03:17.414: E/AndroidRuntime(22194): android.database.sqlite.SQLiteException: near ".": syntax error (code 1): , while compiling: DELETE FROM PLAYERS WHERE _id = android.database.sqlite.SQLiteCursor@4230c2a8
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteStatement.<init>(SQLiteStatement.java:31)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.database.sqlite.SQLiteDatabase.delete(SQLiteDatabase.java:1491)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at com.fullfrontalgames.numberfighter.DBAdapter.deletePlayer(DBAdapter.java:106)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at com.fullfrontalgames.numberfighter.Admin$MyListAdapter$1.onClick(Admin.java:66)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.view.View.performClick(View.java:4106)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.view.View$PerformClick.run(View.java:17052)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.os.Handler.handleCallback(Handler.java:615)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.os.Looper.loop(Looper.java:137)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at android.app.ActivityThread.main(ActivityThread.java:5059)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at java.lang.reflect.Method.invokeNative(Native Method)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at java.lang.reflect.Method.invoke(Method.java:511)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:792)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:555)
04-20 15:03:17.414: E/AndroidRuntime(22194):    at dalvik.system.NativeStart.main(Native Method) 
```

DBAdapter 类

```
package com.fullfrontalgames.numberfighter;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DBAdapter {
    static final String KEY_ROWID = "_id";

    static final String KEY_USERNAME = "USERNAME";

    static final String KEY_PASSWORD = "PASSWORD";

    static final String KEY_EMAIL = "EMAIL";

    static final String KEY_NUMBERINPUT = "NUMBERINPUT";

    static final String KEY_SCORE = "SCORE";

    static final String KEY_FRIENDS = "FRIENDS";

    static final String TAG = "DBAdapter";

    static final String DATABASE_NAME = "NFDatabase";

    static final String DATABASE_TABLE1 = "PLAYERS";

    static final String DATABASE_TABLE2 = "FRIENDSLIST";

    static final int DATABASE_VERSION = 2;

    static final String DATABASE_CREATE_TABLE1 = "create table PLAYERS ( _id integer primary key autoincrement, "
            + "USERNAME text not null,PASSWORD text not null,EMAIL text,NUMBERINPUT text,SCORE text);";

    static final String DATBASE_CREATE_TABLE2 = "create table FRIENDSLIST (_id integer primary key autoincrement,"
            + "FRIENDS text not null,USERNAME text not null,NUMBERINPUT text,SCORE text);";

    final Context context;

    DatabaseHelper DBHelper;

    static SQLiteDatabase db;

    public DBAdapter(Context ctx) {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper {

        public DatabaseHelper(Context context) {
            // TODO Auto-generated constructor stub
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub
            try {
                db.execSQL(DATABASE_CREATE_TABLE1);
                db.execSQL(DATBASE_CREATE_TABLE2);
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            Log.w(TAG, "Upgrading database from version " + oldVersion + " to " + newVersion
                    + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS PLAYERS");
            db.execSQL("DROP TABLE IF EXISTS FRIENDSLIST");
            onCreate(db);
        }

    }

    public DBAdapter open() throws SQLiteException {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    public void close() {
        DBHelper.close();
    }

    // PLAYERS TABLE CRUD

    public void insertPlayer(String Username, String Password, String Email) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("USERNAME", Username);
        initialValues.put("PASSWORD", Password);
        initialValues.put("EMAIL", Email);

        db.insert("PLAYERS", null, initialValues);
    }

    public boolean deletePlayer(Cursor playeraccounts) {
        return db.delete("PLAYERS", KEY_ROWID + " = " + playeraccounts, null) > 0;
    }

    public Cursor getAllPlayers() {
        return db.query(false, "Players", new String[] {
                "_id", "USERNAME", "PASSWORD", "EMAIL"
        }, null, null, null, null, null, null);

    }

    public String getData() {
        String[] columns = new String[] {
                "_id", "USERNAME", "PASSWORD"
        };
        Cursor mCursor = db.query("PLAYERS", columns, null, null, null, null, null);
        String result = "";
        int iRow = mCursor.getColumnIndex(KEY_ROWID);
        int iName = mCursor.getColumnIndex(KEY_USERNAME);

        for (mCursor.moveToFirst(); !mCursor.isAfterLast(); mCursor.moveToNext()) {
            result = mCursor.getString(iRow) + " " + mCursor.getString(iName) + "/n";
        }
        return result;
    }

    public Cursor getPlayer(long rowid) throws SQLException {
        Cursor mCursor = db.query(true, "PLAYERS", new String[] {
                "_id", "USERNAME"
        }, KEY_ROWID + " =  " + "_id", null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public String getUsername(String username) {
        // TODO Auto-generated method stub
        String[] columns = new String[] {
                "_id", "USERNAME"
        };
        Cursor mCursor = db.query("PLAYERS", columns, null, null, null, null, null);
        String result = "";
        int iRow = mCursor.getColumnIndex(KEY_ROWID);
        int iName = mCursor.getColumnIndex(KEY_USERNAME);

        for (mCursor.moveToFirst(); !mCursor.isAfterLast(); mCursor.moveToNext()) {
            result = mCursor.getString(iRow) + " " + mCursor.getString(iName) + "/n";
        }
        return result;
    }

    public String getSinlgeEntry(String Username) {
        Cursor cursor = db.query("PLAYERS", null, " USERNAME=?", new String[] {
            Username
        }, null, null, null);
        if (cursor.getCount() < 1) // UserName Not Exist
        {
            cursor.close();
            return "NOT EXIST";
        }
        cursor.moveToFirst();
        String password = cursor.getString(cursor.getColumnIndex("PASSWORD"));
        cursor.close();
        return password;
    }

    public boolean updatePlayer(long _id, String Username, String Password, String Email) {
        ContentValues args = new ContentValues();
        args.put("USERNAME", Username);
        args.put("PASSWORD", Password);
        args.put("EMAIL", Email);
        return db.update("PLAYERS", args, KEY_ROWID + " = " + _id, null) > 0;
    }

    // FRIENDS TABLE CRUD

    public void insertFriend(String Friend) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("FRIENDS", Friend);
        db.insert("FRIENDSLIST", null, null);
    }

    public boolean deleteFriend() {
        return db.delete("FRIENDSLIST", KEY_ROWID + " = " + "_id", null) > 0;
    }

    public Cursor getAllFriends() {
        return db.query(null, new String[] {
                "_id", "FRIENDS"
        }, null, null, null, null, null, null);
    }

    public Cursor getFriend(long rowid) throws SQLException {
        Cursor mCursor = db.query(true, "FRIENDSLIST", new String[] {
                "_id", "FRIENDS"
        }, KEY_ROWID + " =  " + "_id", null, null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public boolean updateFriend(long _id, String Friends) {
        ContentValues args = new ContentValues();
        args.put("FRIENDS", Friends);

        return db.update("FRIENDSLIST", args, KEY_ROWID + " = " + _id, null) > 0;
    }

} 
```

管理类

```
package com.fullfrontalgames.numberfighter;

import android.app.ListActivity;
import android.content.Context;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.ResourceCursorAdapter;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class Admin extends ListActivity {

    DBAdapter db;

    @SuppressWarnings("deprecation")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.admin);

        DBAdapter db = new DBAdapter(this);
        db.open();

        ListView UsernameList = (ListView)findViewById(android.R.id.list);
        Button deleteplayer = (Button)findViewById(R.id.PlayerDelete);

        Cursor playeraccounts = db.getAllPlayers();
        startManagingCursor(playeraccounts);
        setListAdapter(new MyListAdapter(this, R.layout.admin, playeraccounts));

    }

    private class MyListAdapter extends ResourceCursorAdapter {
        DBAdapter db;

        public MyListAdapter(Context context, int layout, Cursor cursor) {
            super(context, R.layout.admin, cursor);
            // TODO Auto-generated constructor stub

        }

        @Override
        public void bindView(View view, final Context context, final Cursor playeraccounts) {

            final TextView PlayerName = (TextView)findViewById(R.id.AdminUsername);
            final TextView PlayerPass = (TextView)findViewById(R.id.AdminPassword);
            final TextView PlayerEmail = (TextView)findViewById(R.id.AdminEmail);

            PlayerName.setText(playeraccounts.getString(playeraccounts.getColumnIndex("USERNAME")));
            PlayerPass.setText(playeraccounts.getString(playeraccounts.getColumnIndex("PASSWORD")));
            PlayerEmail.setText(playeraccounts.getString(playeraccounts.getColumnIndex("EMAIL")));
            Button deleteplayer = (Button)findViewById(R.id.PlayerDelete);
            deleteplayer.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View view) {
                    // TODO Auto-generated method stub
                    DBAdapter db = new DBAdapter(context);
                    db.open();
                    db.deletePlayer(playeraccounts);
                    Toast.makeText(getBaseContext(), "Player Deleted", Toast.LENGTH_SHORT).show();
                    MyListAdapter.this.notifyDataSetChanged();
                    db.close();

                }
            });

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:19:03.943

你的分贝即为`DBAdapter`空，

当您尝试对其执行操作时

IE

`db.open();`会抛出`NullPointerException`

所以尝试`db`在你的适配器的构造函数中实例化

```
db=new DBAdapter(context); when you are using them in separate classess. 
```

或声明`db`为字段，然后使用它。删除适配器中的新对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:21:38.130

你有两个`DBAdapter db`对象。一个 in`onCreate()`被初始化，而一个 in`MyListAdapter class`保持为空。

您应该只维护一个`db`对象，或同时初始化两者。

这应该有效。

```
public class Admin extends ListActivity {

DBAdapter db;

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.admin);

    db = new DBAdapter(this);
    db.open();

    ListView UsernameList = (ListView)findViewById(android.R.id.list);
    Button deleteplayer = (Button)findViewById(R.id.PlayerDelete);

    Cursor playeraccounts = db.getAllPlayers();
    startManagingCursor(playeraccounts);
    setListAdapter(new MyListAdapter(this, R.layout.admin, playeraccounts));

}

private class MyListAdapter extends ResourceCursorAdapter {

    public MyListAdapter(Context context, int layout, Cursor cursor) {
        super(context, R.layout.admin, cursor);
        // TODO Auto-generated constructor stub

    }

    @Override
    public void bindView(View view, Context context, Cursor playeraccounts) {

        final TextView PlayerName = (TextView)findViewById(R.id.AdminUsername);
        final TextView PlayerPass = (TextView)findViewById(R.id.AdminPassword);
        final TextView PlayerEmail = (TextView)findViewById(R.id.AdminEmail);

        PlayerName.setText(playeraccounts.getString(playeraccounts.getColumnIndex("USERNAME")));
        PlayerPass.setText(playeraccounts.getString(playeraccounts.getColumnIndex("PASSWORD")));
        PlayerEmail.setText(playeraccounts.getString(playeraccounts.getColumnIndex("EMAIL")));
        Button deleteplayer = (Button)findViewById(R.id.PlayerDelete);
        deleteplayer.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View view) {
                // TODO Auto-generated method stub
                db.open();
                db.deletePlayer(0);
                Toast.makeText(getBaseContext(), "Player Deleted", Toast.LENGTH_SHORT).show();
                MyListAdapter.this.notifyDataSetChanged();
                db.close();

            }
        });

    }

}

} 
```

# ruby-on-rails - 安装 rails 4 beta 后可以启动新的 rails 3.2 项目

> ID：16123599
> 
> 赞同：1
> 
> 时间：2013-04-20T18:12:50.093
> 
> 标签：ruby-on-rails, gem, ruby-on-rails-4

我安装了 rails 4 beta1 来试用。现在，我正在尝试使用[rails version hack](http://www.42.mach7x.com/2010/10/03/create-a-rails-app-in-a-specific-version/)`rails 3.2`创建一个新应用程序，但它不起作用。

```
$ gem list rails

*** LOCAL GEMS ***

rails (4.0.0.beta1, 3.2.13, 3.1.0)

$ rails -v
Rails 4.0.0.beta1

$ rails _3.2.13_ demo
/home/gaurish/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/site_ruby/2.0.0/rubygems.rb:317:in `bin_path': can't find gem rails (["3.2.13"]) with executable rails (Gem::GemNotFoundException)
    from /home/gaurish/.rvm/gems/ruby-2.0.0-p0/bin/rails:19:in `<main>'
    from /home/gaurish/.rvm/gems/ruby-2.0.0-p0/bin/ruby_noexec_wrapper:14:in `eval'
    from /home/gaurish/.rvm/gems/ruby-2.0.0-p0/bin/ruby_noexec_wrapper:14:in `<main>'

$ gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.25
  - RUBY VERSION: 2.0.0 (2013-02-24 patchlevel 0) [i686-linux]
  - INSTALLATION DIRECTORY: /home/gaurish/.rvm/gems/ruby-2.0.0-p0
  - RUBY EXECUTABLE: /home/gaurish/.rvm/rubies/ruby-2.0.0-p0/bin/ruby
  - EXECUTABLE DIRECTORY: /home/gaurish/.rvm/gems/ruby-2.0.0-p0/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-linux
  - GEM PATHS:
     - /home/gaurish/.rvm/gems/ruby-2.0.0-p0
     - /home/gaurish/.rvm/gems/ruby-2.0.0-p0@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => 1
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "gem" => "--no-rdoc --no-ri --verbose"
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

出了什么问题，我该如何解决这个问题，以便我可以同时安装 rails 4 和 rails 3.2？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-20T19:46:03.557

将您的 ruby​​gems 更新到 2.0.3

```
gem update --system 
```

不要惊慌！这只是 Rails 3

```
rails _3.2.13_ new demo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:19:18.307

今天早些时候有同样的问题。

删除 rails 4.0.0.beta1 并重新安装它，然后`rails _3.2.13__`按照您的问题中所述使用解决了我的问题。

# vb.net - 如何通过 ID 获取产品？

> ID：16123601
> 
> 赞同：0
> 
> 时间：2013-04-20T18:13:07.870
> 
> 标签：vb.net, select

> 数据库：Microsoft Access 创建了名为 ConnStr 的设置，值为 provider=Microsoft.ACE.OLEDB.12.0; Data Source=c:\sm.accdb 产品表有4列：ProductID、Description、Category、Price 我有3个类：Manager、Product、ProductManager

```
Public MustInherit Class Manager
    Private _connectionString As String
    Protected Property ConnectionString() As String
        Get
            Return _connectionString
        End Get
        Set(ByVal value As String)
            _connectionString = value
        End Set
    End Property

    Public Sub New(ByVal connStr As String)
        ConnectionString = connStr
    End Sub
End Class

Public Class Product
    Private _id As Integer
    Public Property ID() As Integer
        Get
            Return _id
        End Get
        Set(ByVal value As Integer)
            _id = value
        End Set
    End Property

    Private _description As String
    Public Property Description() As String
        Get
            Return _description
        End Get
        Set(ByVal value As String)
            _description = value
        End Set
    End Property

    Private _category As String
    Public Property Category() As String
        Get
            Return _category
        End Get
        Set(ByVal value As String)
            _category = value
        End Set
    End Property

    Private _price As Double
    Public Property Price() As Double
        Get
            Return _price
        End Get
        Set(ByVal value As Double)
            _price = value
        End Set
    End Property
End Class

    Imports System.Data.OleDb
    Public Class ProductManager
Inherits Manager
        Public Function GetProductByID(ByVal id As Integer) As Product
                Dim con = New System.Data.OleDb.OleDbConnection
                Dim sql As String = "SELECT * FROM Product WHERE ProductID=@id"
                con.Open()
                Try
                    Dim description As String
                    Dim category As String
                    Dim price As Double
                    Dim cmd As New System.Data.OleDb.OleDbCommand(sql, con)
                    cmd.Parameters.Add(id.ToString, "@id")
                    cmd.Parameters.Add(description, "@description")
                    cmd.Parameters.Add(category, "@category")
                    cmd.Parameters.Add(price.ToString, "@price")
                    cmd.ExecuteNonQuery()
                    cmd.Dispose()
                    cmd = Nothing
                Catch ex As Exception
                    Throw New Exception(ex.ToString(), ex)
                Finally
                    con.Close()
                End Try
                Return nothing
        End Function
    End Class 
```

我无法从数据库中获取产品！我认为问题出在 ProductManager 类中！我感到很困惑！请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:33:29.170

你必须使用`cmd.ExecuteReader()`方法

```
Dim myReader As OledbDataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection)
    While myReader.Read()
        Console.WriteLine(myReader.GetString(0))
    End While
    myReader.Close() 
```

# android - Android SQLite 数据库 insert() 方法导致 NullPointerException

> ID：16123604
> 
> 赞同：0
> 
> 时间：2013-04-20T18:13:18.823
> 
> 标签：android, database, sqlite, nullpointerexception

`NullPointerException`当我试图在我的数据库中插入一行时，我得到了一个。我检查了很多类似的问题并尝试了很多东西，但我就是看不出问题出在哪里。

我`NullPointerException`在这里开始`getDatabase().insert(TABLE_NAME_BUSSES, null, values);`

我正在使用这样的数据库类`new MyDatabase(context).addOrUpdate(bus);`

该类`Bus`只是一个只有 getter/setter 的模型类，我在调试期间检查了值，我没有访问任何空值。

这是我的数据库类：

```
public class MyDatabase implements IDatabaseOperations<Bus>
{
    public static final String KEY_BUSSES_NUMBER = "busNumber";
    public static final String KEY_BUSSES_SOURCE = "busSource";
    public static final String KEY_BUSSES_DESTINATION = "busDestination";
    public static final String KEY_BUSSES_ROUTE = "busRoute";
    public static final String KEY_BUSSES_ISSTARRED = "busIsStarred";
    public static final String KEY_BUSSES_TIMESH = "busTimesH";
    public static final String KEY_BUSSES_TIMESC = "busTimesC";
    public static final String KEY_BUSSES_TIMESP = "busTimesP";

    private static final String DATABASE_NAME = "database";
    private static final int DATABASE_VERSION = 1;

    private static final String TABLE_NAME_BUSSES = "busses";

    private static final String CREATE_SQL = "CREATE TABLE " + TABLE_NAME_BUSSES + " ("
                                            + KEY_BUSSES_NUMBER + " INTEGER PRIMARY KEY NOT NULL, "
                                            + KEY_BUSSES_SOURCE + " TEXT NOT NULL, "
                                            + KEY_BUSSES_DESTINATION + " TEXT NOT NULL, "
                                            + KEY_BUSSES_ROUTE + " TEXT, "
                                            + KEY_BUSSES_ISSTARRED + " TEXT NOT NULL, "
                                            + KEY_BUSSES_TIMESH + " TEXT, "
                                            + KEY_BUSSES_TIMESC + " TEXT, "
                                            + KEY_BUSSES_TIMESP + " TEXT);";

    private SQLiteDatabase myDatabase;

    protected boolean isOpened = false;

    private MyDatabaseHelper myHelper;

    public static final String LOG_TAG = "Database";

    private static class MyDatabaseHelper extends SQLiteOpenHelper
    {
        public MyDatabaseHelper(Context context)
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db)
        {
            db.execSQL(CREATE_SQL);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
        {
            db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME_BUSSES);
            onCreate(db);
        }
    }

    public MyDatabase(Context context)
    {
        myHelper = new MyDatabaseHelper(context);
    }

    public MyDatabase openDB() throws SQLException
    {
        isOpened = true;

        myDatabase = myHelper.getWritableDatabase();

        return this;
    }

    public void closeDB()
    {
        isOpened = false;

        myHelper.close();
    }

    public SQLiteDatabase getDatabase()
    {
        return myDatabase;
    }

    @Override
    public boolean addOrUpdate(Bus entry)
    {
        /* Result flag */
        boolean result = true;

        /* If the database is not opened, open it */
        if(!isOpened)
        {
            openDB();
        }

        /* Set the row */
        ContentValues values = new ContentValues();
        values.put(KEY_BUSSES_NUMBER, entry.getNumber());
        values.put(KEY_BUSSES_SOURCE, entry.getSource());
        values.put(KEY_BUSSES_DESTINATION, entry.getDestination());
        values.put(KEY_BUSSES_ROUTE, (entry.getRoute() != null ? entry.getRoute() : ""));
        values.put(KEY_BUSSES_ISSTARRED, (entry.isStarred() ? 1 : 0));
        values.put(KEY_BUSSES_TIMESH, (entry.getTimesH() != null ? new Gson().toJson(entry.getTimesH()) : ""));
        values.put(KEY_BUSSES_TIMESC, (entry.getTimesC() != null ? new Gson().toJson(entry.getTimesC()) : ""));
        values.put(KEY_BUSSES_TIMESP, (entry.getTimesP() != null ? new Gson().toJson(entry.getTimesP()) : ""));

        try
        {
            /* Check if the entry is already in the database */
            int temp = get(entry);
            if(temp != -1 && temp == entry.getNumber())
            {
                /* Updating */
                getDatabase().update(TABLE_NAME_BUSSES, values, KEY_BUSSES_NUMBER + "=" + entry.getNumber(), null);
            }
            else
            {
                /* Adding */
                getDatabase().insert(TABLE_NAME_BUSSES, null, values);
            }
        }
        catch(Exception e)
        {
            Log.e(LOG_TAG, "Error occurred while adding to/updating database!", e);

            result = false;
        }

        /* If the database is opened, close it */
        if(isOpened)
        {
            closeDB();
        }

        /* Return the result */
        return result;
    }

    @Override
    public int get(Bus entry)
    {
        /* Resulting number */
        int number = -1;

        /* If the database is not opened, open it */
        if(!isOpened)
        {
            openDB();
        }

        /* Column to select which is just number */
        String[] columns = new String[]
        {
            KEY_BUSSES_NUMBER
        };

        /* Cursor to query the database */
        Cursor cursor = getDatabase().query(TABLE_NAME_BUSSES, columns,
                                            KEY_BUSSES_SOURCE + "=" + (entry.getSource() != null ? "\"" + entry.getSource() + "\"" : "NULL") + " AND " +
                                            KEY_BUSSES_DESTINATION + "=" + (entry.getDestination() != null ? "\"" + entry.getDestination() + "\"" : "NULL") + " AND " +
                                            KEY_BUSSES_ROUTE + "=" + (entry.getRoute() != null ? "\"" + entry.getRoute() + "\"" : "NULL") + " AND " +
                                            KEY_BUSSES_ISSTARRED + "=" + (entry.isStarred() ? 1 : 0) + " AND " +
                                            KEY_BUSSES_TIMESH + "=" + (new Gson().toJson(entry.getTimesH()) != null ? "\"" + new Gson().toJson(entry.getTimesH()) + "\"" : "NULL") + " AND " +
                                            KEY_BUSSES_TIMESC + "=" + (new Gson().toJson(entry.getTimesC()) != null ? "\"" + new Gson().toJson(entry.getTimesC()) + "\"" : "NULL") + " AND " +
                                            KEY_BUSSES_TIMESP + "=" + (new Gson().toJson(entry.getTimesP()) != null ? "\"" + new Gson().toJson(entry.getTimesP()) + "\"" : "NULL"),
                                            null, null, null, null);

        /* If successfully queried */
        if(cursor != null)
        {
            /* If any match is found */
            if(cursor.getCount() > 0)
            {
                /* Go to the first match */
                cursor.moveToFirst();

                /* Set the resulting number */
                number = cursor.getInt(cursor.getColumnIndex(KEY_BUSSES_NUMBER));
            }
        }

        /* If the database is opened, close it */
        if(isOpened)
        {
            closeDB();
        }

        /* Return the result */
        return number;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:32:19.810

在`int temp = get(entry);`你关闭数据库。您不应该在数据库类中打开和关闭数据库。在实例化数据库类的类中打开和关闭。

# php - 附件没有在php中发送？

> ID：16123609
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:13:51.983
> 
> 标签：php

将 html 文件作为附件发送的这段代码工作正常。但是在下一个代码片段中，当我将附件更改为图像时，它没有被发送。为什么会这样？

```
<?php
$file_path = "file.html"; // server path where file is placed
$file_path_type = "text/html"; // File Type
$file_path_name = "newfilename.html"; // this file name will be used at reciever end 

$from = "xyz@gmail.com"; // E-mail address of sender
$to = "abc@gmail.com"; // E-mail address of reciever
$subject = "Please check the Attachment."; // Subject of email
$message = "This is the message body.&lt;br&gt;&lt;br&gt;Thank You!&lt;br&gt;&lt;a href='http://7tech.co.in'&gt;7tech.co.in Team&lt;/a&gt;"; 

$headers = "From: ".$from; 

$file = fopen($file_path,'rb');
$data = fread($file,filesize($file_path));
fclose($file); 

$rand = md5(time());
$mime_boundary = "==Multipart_Boundary_x{$rand}x"; 

$headers .= "\nMIME-Version: 1.0\n" .
"Content-Type: multipart/mixed;\n" .
" boundary=\"{$mime_boundary}\""; 

$message .= "This is a multi-part message in MIME format.\n\n" .
"--{$mime_boundary}\n" .
"Content-Type:text/html; charset=\"iso-8859-1\"\n" .
"Content-Transfer-Encoding: 7bit\n\n" .
$message .= "\n\n"; 

$data = chunk_split(base64_encode($data)); 

$message .= "--{$mime_boundary}\n" .
"Content-Type: {$file_path_type};\n" .
" name=\"{$file_path_name}\"\n" .
"Content-Disposition: attachment;\n" .
" filename=\"{$file_path_name}\"\n" .
"Content-Transfer-Encoding: base64\n\n" .
$data .= "\n\n" .
"--{$mime_boundary}--\n";  

if(@mail($to, $subject, $message, $headers)) {
echo "File send!";

} else {
echo 'Failed';
}
?> 
```

现在，当我将附件更改为图片（即 screenshot.png）时，它无法发送消息。

```
<?php
    $file_path = "screenshot.png"; // server path where file is placed
    $file_path_type = "image/png"; // File Type
    $file_path_name = "screenshot.png"; // this file name will be used at reciever end 

    $from = "xyz@gmail.com"; // E-mail address of sender
    $to = "abc@gmail.com"; // E-mail address of reciever
    $subject = "Please check the Attachment."; // Subject of email
    $message = "This is the message body.&lt;br&gt;&lt;br&gt;Thank You!&lt;br&gt;&lt;a href='http://7tech.co.in'&gt;7tech.co.in Team&lt;/a&gt;"; 

    $headers = "From: ".$from; 

    $file = fopen($file_path,'rb');
    $data = fread($file,filesize($file_path));
    fclose($file); 

    $rand = md5(time());
    $mime_boundary = "==Multipart_Boundary_x{$rand}x"; 

    $headers .= "\nMIME-Version: 1.0\n" .
    "Content-Type: multipart/mixed;\n" .
    " boundary=\"{$mime_boundary}\""; 

    $message .= "This is a multi-part message in MIME format.\n\n" .
    "--{$mime_boundary}\n" .
    "Content-Type:text/html; charset=\"iso-8859-1\"\n" .
    "Content-Transfer-Encoding: 7bit\n\n" .
    $message .= "\n\n"; 

    $data = chunk_split(base64_encode($data)); 

    $message .= "--{$mime_boundary}\n" .
    "Content-Type: {$file_path_type};\n" .
    " name=\"{$file_path_name}\"\n" .
    "Content-Disposition: attachment;\n" .
    " filename=\"{$file_path_name}\"\n" .
    "Content-Transfer-Encoding: base64\n\n" .
    $data .= "\n\n" .
    "--{$mime_boundary}--\n";  

    if(@mail($to, $subject, $message, $headers)) {
    echo "File send!";

    } else {
    echo 'Failed';
    }
    ?> 
```

你们能指出错误吗？我也尝试在 1-2 个地方更改内容类型，但它不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:27:36.540

咨询[PhpMailer 与 SwiftMailer？](https://stackoverflow.com/questions/303783/phpmailer-vs-swiftmailer)

您当然可以继续使用繁琐的手动邮件构建代码。但是请不要将额外的调试工作卸载给其他人。你的选择，你的问题。

如果您有点聪明，请使用现有解决方案之一，而不是创可贴代码。

# asp.net - 如何在我的 EF 模型中刷新 DBContext 类的程序？(ASP.NET + ADO EDM)

> ID：16123618
> 
> 赞同：1
> 
> 时间：2013-04-20T18:14:58.540
> 
> 标签：asp.net, entity-framework, ado.net

**你好！**

从数据库创建 .edmx 后，我向 DB 添加了更多存储过程。之后我打开模型图并按“从数据库更新模型”，选择这个程序。但我不能在代码中使用它们，也不能在 *.tt 文件中看到它们。模型浏览器包含它们。

## tt文件## ![EDM的tt文件](https://i.stack.imgur.com/dRwid.png)

模型浏览器： ![模型浏览器](https://i.stack.imgur.com/7n4WV.png)

怎么了？

**谢谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T21:15:52.327

需要做的：1）打开edmx文件模型图。从数据库按更新...好的。2) 构建|重建解决方案。3）右键单击解决方案资源管理器中.edmx文件下的文件...找到运行自定义工具之类的项目。

就这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T23:37:15.830

我发现只是删除 .tt 文件并再次添加 dbcontext 生成器。但我使用属性进行验证，在此过程中，所有实体都被删除并再次创建。所以这对我来说不是一个好方法..;/

# java - App Engine 连接的 android 项目中的错误

> ID：16123619
> 
> 赞同：7
> 
> 时间：2013-04-20T18:15:06.843
> 
> 标签：java, android, google-app-engine, google-cloud-endpoints, eclipse-adt

我下载了带有所有必要工具的 Eclipse 谷歌插件。当我在 Eclipse 中创建一个新的“App engine connected android”项目时，尽管 App engine 项目工作正常，但在 android 项目中立即出现以下 4 个错误（不涉及代码）。

*   对于文件 GCMIntentService.java 中的类型，该方法`getDeviceInfo(String)`未定义。`Deviceinfoendpoint`

*   对于文件 GCMIntentService.java 中的类型，该方法`insertDeviceInfo(DeviceInfo)`未定义。`Deviceinfoendpoint`

*   对于文件RegisterActivity.java 中的类型，该方法`listMessages()`未定义。`MessageEndpoint`

*   对于文件 GCMIntentService.java 中的类型，该方法`removeDeviceInfo(String)`未定义。`Deviceinfoendpoint`

似乎缺少一些 jar 或安装，但我检查了所有内容并重新安装了 Google 插件以及 SDK 管理器中的所有安装和附加内容。我还检查了版本，我认为它们还可以。我总是遇到同样的问题。出了什么问题，我该怎么办？

非常感谢您的任何回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-05T22:19:29.223

在我看来，您应该检查任何实体是否具有注释、getter、setter 和默认构造函数。右键单击您在应用引擎端 google-> 生成云端点类上可能拥有的任何实体类。右键单击应用引擎项目google->生成客户端库

# android - 如何从另一个 Activity 类调用 Activity 类方法

> ID：16123620
> 
> 赞同：0
> 
> 时间：2013-04-20T18:15:16.620
> 
> 标签：android

我的 MainActivity 课程是：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    UserInterface_Main  UIMain = new UserInterface_Main();
    setContentView(R.layout.activity_main);
    UIMain.ExpendableListView();
} 
```

另一个 Activity 类是：

```
public class UserInterface_Main extends Activity{

ExpandableListView exv;

public void ExpendableListView()
{

    Context context = getApplicationContext();
    exv=(ExpandableListView)findViewById(R.id.elv1);
    exv.setAdapter(new MAdapter(context));
} 
```

现在告诉我如何从类中调用`ExpendableListView()`方法。`MainActivity`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:33:16.813

```
Intent myIntent = new Intent(MainActivity.this, NextActivity.class);
MainActivity.this.startActivity(myIntent); 
```

您可能还想在 activity_main.xml 中实现一个 UI 元素来触发传输。也许您应该添加一个按钮并在 xml 中使用 android:onCLick。

IE。

{xml}

```
<Button
       android:id="@+id/button2"
       android:layout_width="200dp"
       android:layout_height="100dp"
       android:text="coolbutton" 
       android:onClick="blah"  /> 
```

{MainActivity.java}

```
public void blah(View view){
    Intent myIntent = new Intent(MainActivity.this, NextActivity.class);
    MainActivity.this.startActivity(myIntent);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-01T21:55:06.533

要从另一个活动（不是主要活动）调用活动，您必须指定上下文：

```
 Intent i = new Intent(getApplicationContext(), secondActivity.class);
                getApplicationContext().startActivity(i); 
```

# performance - 手机性能慢 - flash air actionscript 游戏

> ID：16123622
> 
> 赞同：0
> 
> 时间：2013-04-20T18:15:32.780
> 
> 标签：performance, flash, actionscript

我是新手，我正在尝试使用 Flash 和 Adob​​e AIR 制作游戏。

游戏目前在我的电脑上运行良好，当我测试它时，但当我把它放在手机上时，它运行得非常慢。我想我希望得到一些关于手机性能缓慢的一般提示。

游戏中有一个垂直滚动环境中的角色，可以拾取可以提升他向上的物体（类似于 HyperJump）。

对于新开发人员来说，有什么常见的陷阱会严重影响性能吗？

在此先感谢您的帮助！（很抱歉没有发布代码......我真的不确定是什么让事情变慢，因为它在我的电脑上运行良好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T19:49:08.837

你的电脑比你的手机有更多的演出。您拥有的内存越多，运行速度就越快。为了让您的游戏在手机上运行得更快，您需要减少每帧的事件和 hitTest 次数等。

最重要的是降低帧速率。如果你的 frameRate 太高，所有事件都会每秒调用那个次数，你就会有巨大的内存泄漏。

少放一些动画。每帧动画大约是 0.01 字节。

在数组中，不要将事件添加到整个类。只需将您的事件与数组一起放在主时间轴中，因为您拥有的事件越少，您的游戏就会越快。

将所有类似的事件放在一个事件中。如果您有多个输入帧事件等，则将它们全部放在一个地方。

在 mouseEvents 中，将所有 Button 放在一个事件中。只需通过执行检查它是哪个`if(event.currentTarget == yourbtn) { etc. }`

希望这有帮助。

# jquery - jQuery 3d 立方体旋转不顺畅

> ID：16123623
> 
> 赞同：0
> 
> 时间：2013-04-20T18:15:34.423
> 
> 标签：jquery, css, cube

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:45:35.827

您忘记了您需要两个不同的转动轴。请参阅 JsFiddle 更新：http: [//jsfiddle.net/yZd3v/1/](http://jsfiddle.net/yZd3v/1/)

```
 degX = 0;
    degY = 0;
    $(document).keydown(function(key){
        if (key.keyCode == 37) {
            // left 37
            degY -= 10;
        } else if (key.keyCode == 39) {
            // right 39
            degY += 10;
        } else if (key.keyCode == 38) {
            // up 38
            degX += 10;
        } else if (key.keyCode == 40) {
            // down 40
            degX -= 10;
        } 

        $('#cube').css('-webkit-transform','translateZ(-100px) rotateX('+degX+'deg) rotateY(' + degY+'deg)');
        return false;
    }); 
```

请注意，您的度数有两个变量，并且您每次都在旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:28:27.997

你可以使用 **$('#cube').css({"transform": "rotateY("+deg+"deg)"});** 在几种情况下。我已经测试过了。。

并寻求帮助[http://css3.bradshawenterprises.com/transforms/](http://css3.bradshawenterprises.com/transforms/)

请看看这个。并获得一些帮助..

[http://jsfiddle.net/j35Ad/](http://jsfiddle.net/j35Ad/)

```
<div id="transDemo4" class="shadow hover">
<div id="rotateX">rotateX</div>
<div id="rotateY">rotateY</div>
<div id="rotateZ">rotateZ</div>
<p class="center">Hover me</p>
<div class="clear"></div>
</div>

#transDemo4 {
    border: 1px solid #AAAAAA;
    height: 190px;
    margin: 0 auto 10px;
    padding: 10px;
    width: 400px;
}
.shadow {
    box-shadow: 5px 5px 5px #AAAAAA;
}
#transDemo4 div:not(.clear) {
    border: 1px solid blue;
    float: left;
    height: 130px;
    margin: 10px 20px;
    padding: 10px;
    perspective: 800px;
    perspective-origin: 50% 100px;
    transition: all 2s ease-in-out 0s;
    width: 70px;
}

.clear {
    clear: both;
}

#transDemo4 div {
  transition:all 2s ease-in-out;
  perspective: 800px;
  perspective-origin: 50% 100px;
}
#transDemo4:hover #rotateX {
  transform:rotateX(180deg);
}
#transDemo4:hover #rotateY {
  transform:rotateY(180deg);
}
#transDemo4:hover #rotateZ {
  transform:rotateZ(180deg);
} 
```

# openstack - Keystone 返回带有元数据 is_admin = 0 的令牌

> ID：16123625
> 
> 赞同：1
> 
> 时间：2013-04-20T18:15:46.037
> 
> 标签：openstack, keystone

我最近安装了 devstack 来使用 Openstack API。

在[Openstack API 快速入门](http://docs.openstack.org/api/quick-start/content/index.html "Openstack API 快速入门")之后，我运行以下命令来获取身份验证令牌：

```
curl -d '{"auth":{"passwordCredentials":{"username": "admin", "password": "openstack"}, "tenantId": "793e8386d75f47b1bd078a3c0ddd9a49"}}' -H "Content-type: application/json" http://192.168.1.20:5000/v2.0/tokens 
```

然后我得到回报：

```
{"access": {"token": {"issued_at": "2013-04-20T17:53:58.538559", "expires": "2013-04-21T17:53:58Z", "id": "MIIKVgYJKoZIhvcNAQcCoIIKRzCCCkMCAQExCTAHBgUrDgMCGjCCCS8GCSqGSIb3DQEHAaCCCSAEggkceyJhY2Nlc3MiOiB7InRva2VuIjogeyJpc3N1ZWRfYXQiOiAiMjAxMy0wNC0yMFQxNzo1Mzo1OC41Mzg1NTkiLCAiZXhwaXJlcyI6ICIyMDEzLTA0LTIxVDE3OjUzOjU4WiIsICJpZCI6ICJwbGFjZWhvbGRlciIsICJ0ZW5hbnQiOiB7ImVuYWJsZWQiOiB0cnVlLCAiZGVzY3JpcHRpb24iOiBudWxsLCAibmFtZSI6ICJkZW1vIiwgImlkIjogIjc5M2U4Mzg2ZDc1ZjQ3YjFiZDA3OGEzYzBkZGQ5YTQ5In19LCAic2VydmljZUNhdGFsb2ciOiBbeyJlbmRwb2ludHMiOiBbeyJhZG1pblVSTCI6ICJodHRwOi8vMTkyLjE2OC4xLjIwOjg3NzQvdjIvNzkzZTgzODZkNzVmNDdiMWJkMDc4YTNjMGRkZDlhNDkiLCAicmVnaW9uIjogIlJlZ2lvbk9uZSIsICJpbnRlcm5hbFVSTCI6ICJodHRwOi8vMTkyLjE2OC4xLjIwOjg3NzQvdjIvNzkzZTgzODZkNzVmNDdiMWJkMDc4YTNjMGRkZDlhNDkiLCAiaWQiOiAiMDYxNGU5OWM5ODZlNGZhZjg2NmZmZjMyZTNkNDA2OTIiLCAicHVibGljVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6ODc3NC92Mi83OTNlODM4NmQ3NWY0N2IxYmQwNzhhM2MwZGRkOWE0OSJ9XSwgImVuZHBvaW50c19saW5rcyI6IFtdLCAidHlwZSI6ICJjb21wdXRlIiwgIm5hbWUiOiAibm92YSJ9LCB7ImVuZHBvaW50cyI6IFt7ImFkbWluVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6MzMzMyIsICJyZWdpb24iOiAiUmVnaW9uT25lIiwgImludGVybmFsVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6MzMzMyIsICJpZCI6ICI0YzI3ZmYxNDNkNjI0NDVkOWNmMzQ4MWY0N2ExZGUwMyIsICJwdWJsaWNVUkwiOiAiaHR0cDovLzE5Mi4xNjguMS4yMDozMzMzIn1dLCAiZW5kcG9pbnRzX2xpbmtzIjogW10sICJ0eXBlIjogInMzIiwgIm5hbWUiOiAiczMifSwgeyJlbmRwb2ludHMiOiBbeyJhZG1pblVSTCI6ICJodHRwOi8vMTkyLjE2OC4xLjIwOjkyOTIiLCAicmVnaW9uIjogIlJlZ2lvbk9uZSIsICJpbnRlcm5hbFVSTCI6ICJodHRwOi8vMTkyLjE2OC4xLjIwOjkyOTIiLCAiaWQiOiAiM2I0NDBiN2NkNWFlNDcyOGI4OGE4NzA2YjRkMmYwZTUiLCAicHVibGljVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6OTI5MiJ9XSwgImVuZHBvaW50c19saW5rcyI6IFtdLCAidHlwZSI6ICJpbWFnZSIsICJuYW1lIjogImdsYW5jZSJ9LCB7ImVuZHBvaW50cyI6IFt7ImFkbWluVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6ODc3Ni92MS83OTNlODM4NmQ3NWY0N2IxYmQwNzhhM2MwZGRkOWE0OSIsICJyZWdpb24iOiAiUmVnaW9uT25lIiwgImludGVybmFsVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6ODc3Ni92MS83OTNlODM4NmQ3NWY0N2IxYmQwNzhhM2MwZGRkOWE0OSIsICJpZCI6ICI3NWUxYjk1ZTE5ODM0ZmY3ODk3MmZjYjczMjc5Yzc3ZCIsICJwdWJsaWNVUkwiOiAiaHR0cDovLzE5Mi4xNjguMS4yMDo4Nzc2L3YxLzc5M2U4Mzg2ZDc1ZjQ3YjFiZDA3OGEzYzBkZGQ5YTQ5In1dLCAiZW5kcG9pbnRzX2xpbmtzIjogW10sICJ0eXBlIjogInZvbHVtZSIsICJuYW1lIjogImNpbmRlciJ9LCB7ImVuZHBvaW50cyI6IFt7ImFkbWluVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6ODc3My9zZXJ2aWNlcy9BZG1pbiIsICJyZWdpb24iOiAiUmVnaW9uT25lIiwgImludGVybmFsVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6ODc3My9zZXJ2aWNlcy9DbG91ZCIsICJpZCI6ICI4N2Q3NWE4ODlmNGY0ZmRiODFiMDU2YmRjNTllM2E5YSIsICJwdWJsaWNVUkwiOiAiaHR0cDovLzE5Mi4xNjguMS4yMDo4NzczL3NlcnZpY2VzL0Nsb3VkIn1dLCAiZW5kcG9pbnRzX2xpbmtzIjogW10sICJ0eXBlIjogImVjMiIsICJuYW1lIjogImVjMiJ9LCB7ImVuZHBvaW50cyI6IFt7ImFkbWluVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6MzUzNTcvdjIuMCIsICJyZWdpb24iOiAiUmVnaW9uT25lIiwgImludGVybmFsVVJMIjogImh0dHA6Ly8xOTIuMTY4LjEuMjA6NTAwMC92Mi4wIiwgImlkIjogIjAyZDA5Mzg0NWY3MzQ0NDJiZjk4MTMxZTNmMDZmODA1IiwgInB1YmxpY1VSTCI6ICJodHRwOi8vMTkyLjE2OC4xLjIwOjUwMDAvdjIuMCJ9XSwgImVuZHBvaW50c19saW5rcyI6IFtdLCAidHlwZSI6ICJpZGVudGl0eSIsICJuYW1lIjogImtleXN0b25lIn1dLCAidXNlciI6IHsidXNlcm5hbWUiOiAiYWRtaW4iLCAicm9sZXNfbGlua3MiOiBbXSwgImlkIjogIjMyOWE3MDc3NjZlNDRiMmE4NWUzMmQxMzQ2ZjQ1NDI5IiwgInJvbGVzIjogW3sibmFtZSI6ICJhZG1pbiJ9XSwgIm5hbWUiOiAiYWRtaW4ifSwgIm1ldGFkYXRhIjogeyJpc19hZG1pbiI6IDAsICJyb2xlcyI6IFsiMzk3MmVmOTc5YzM5NGVmNzg3ZTFkMGI0ODIyOTY3OWMiXX19fTGB-zCB-AIBATBcMFcxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIEwVVbnNldDEOMAwGA1UEBxMFVW5zZXQxDjAMBgNVBAoTBVVuc2V0MRgwFgYDVQQDEw93d3cuZXhhbXBsZS5jb20CAQEwBwYFKw4DAhowDQYJKoZIhvcNAQEBBQAEgYCu8vRsIpBqcWqbqDKqHguQ92y6B7h4pkieEYgu5i34NDeM-0niAnLrvCK7T8iKAODtSaycgL7jolvLwztVdR2ps6JVtck67w05TZqdE7CNbHkZP22BS87tT1aXqnYxvXl9UvQvxOzOLTBraGad+kutyCMlHjIdz+p3x-u1jnqZAA==", "tenant": {"enabled": true, "description": null, "name": "demo", "id": "793e8386d75f47b1bd078a3c0ddd9a49"}}, "serviceCatalog": [{"endpoints": [{"adminURL": "http://192.168.1.20:8774/v2/793e8386d75f47b1bd078a3c0ddd9a49", "region": "RegionOne", "internalURL": "http://192.168.1.20:8774/v2/793e8386d75f47b1bd078a3c0ddd9a49", "id": "0614e99c986e4faf866fff32e3d40692", "publicURL": "http://192.168.1.20:8774/v2/793e8386d75f47b1bd078a3c0ddd9a49"}], "endpoints_links": [], "type": "compute", "name": "nova"}, {"endpoints": [{"adminURL": "http://192.168.1.20:3333", "region": "RegionOne", "internalURL": "http://192.168.1.20:3333", "id": "4c27ff143d62445d9cf3481f47a1de03", "publicURL": "http://192.168.1.20:3333"}], "endpoints_links": [], "type": "s3", "name": "s3"}, {"endpoints": [{"adminURL": "http://192.168.1.20:9292", "region": "RegionOne", "internalURL": "http://192.168.1.20:9292", "id": "3b440b7cd5ae4728b88a8706b4d2f0e5", "publicURL": "http://192.168.1.20:9292"}], "endpoints_links": [], "type": "image", "name": "glance"}, {"endpoints": [{"adminURL": "http://192.168.1.20:8776/v1/793e8386d75f47b1bd078a3c0ddd9a49", "region": "RegionOne", "internalURL": "http://192.168.1.20:8776/v1/793e8386d75f47b1bd078a3c0ddd9a49", "id": "75e1b95e19834ff78972fcb73279c77d", "publicURL": "http://192.168.1.20:8776/v1/793e8386d75f47b1bd078a3c0ddd9a49"}], "endpoints_links": [], "type": "volume", "name": "cinder"}, {"endpoints": [{"adminURL": "http://192.168.1.20:8773/services/Admin", "region": "RegionOne", "internalURL": "http://192.168.1.20:8773/services/Cloud", "id": "87d75a889f4f4fdb81b056bdc59e3a9a", "publicURL": "http://192.168.1.20:8773/services/Cloud"}], "endpoints_links": [], "type": "ec2", "name": "ec2"}, {"endpoints": [{"adminURL": "http://192.168.1.20:35357/v2.0", "region": "RegionOne", "internalURL": "http://192.168.1.20:5000/v2.0", "id": "02d093845f734442bf98131e3f06f805", "publicURL": "http://192.168.1.20:5000/v2.0"}], "endpoints_links": [], "type": "identity", "name": "keystone"}], "user": {"username": "admin", "roles_links": [], "id": "329a707766e44b2a85e32d1346f45429", "roles": [{"name": "admin"}], "name": "admin"}, "metadata": {"is_admin": 0, "roles": ["3972ef979c394ef787e1d0b48229679c"]}}} 
```

我注意到从 JSON 元数据输出它返回**"is_admin": 0**。

这是为什么？

我期待 Keystone 返回 1。

问候

# regex - Perl - 将正则表达式公式存储在变量中，然后使用它来匹配正则表达式

> ID：16123626
> 
> 赞同：0
> 
> 时间：2013-04-20T18:15:55.933
> 
> 标签：regex, perl, variables, match

我有一个文件，其中包含这样的长行：

```
XEP.101     :1804 000000:I:XEPInfoFormat:Status=ok:TID=00000000516F6161-000874C3-00003E19-62F2B0C6:CallType=gprs:CallStart=20130415210553:CallDuration=4334:ServedParty=724044024363999:ServedLocation=724:OtherParty=TIM:OtherLocation=tim.br:ServedZone=ZO00001:OtherZone=ZP32363:TariffZone=ZN1261:CUST_ID=58922505:CO_ID=58891164:account=8327813:MSISDN=554599836655:theoretical_cost_value=33.323525:BA_Line_Main_value=NA:Tariff=TM_PL5PR:FU_Packs_used=FU_PLWI2:SNCODE_FU=1350_1250_1_BA_FU_PLWI2_Byt_Internet2:MCs_used=NO:bcd=20100319,bcp=P1M:InputFilename=201304172345.000020:EipFilename=/gold/rte/data/RatedEvents/EIP/10/101201304172345.000020:RtxFilename=/gold/rte/data/RatedEvents/RTX/01/OPSCGOLD_20130418000000_1011917.xml:BadrateFilename=/gold/rte/data/BadRate/bad_rate_xep10.201304172345.000020.tmp:FILE=/gold/rte/data/IncomingCDRs/ASN1/010/GPRS99+GPRS99-46299-1304172357-SA.TTF;TICKET=660 
```

所以我有这个条件，要匹配 Perl 中的这一行：

```
if ( $line =~ m/XEP.[0-9].*:(\d{4}) (\d{2})(\d{2})(\d{2}).*XEPInfoFormat:Status=(\w*):TID=(\S*):CallType=(\w*):CallStart=(\d*):CallDuration=(\d*):ServedParty=(\d*):ServedLocation=(\d*):OtherParty=(\w*):OtherLocation=(\w*):ServedZone=(\w*):OtherZone=(\w*):TariffZone=(\w*):CUST_ID=(\d*):CO_ID=(\d*):account=(\d*):MSISDN=(\d*):theoretical_cost_value=(\d*)\.(\d*):BA_Line_Main_value=(\w*):Tariff=(\w*):FU_Packs_used=(\w*):SNCODE_FU=(\w*):MCs_used=(\w*):bcd=(\d*),bcp=(\w*):InputFilename=(\d*)\.(\d*):EipFilename=\/\w*\/\w*\/\w*\/\w*\/\w*\/(\d*)\/(\d*)\.(\d*).*FILE=\/\w*\/\w*\/\w*\/\w*\/\w*\/(\d*)\/(\w*)\+(\w*)-(\d*)-(\d*)-(\w*).(\w*);TICKET=(\d*)/ ) { 
```

所以对我来说没关系，这是匹配并给我带来结果。但是，我想让它更灵活，例如，如果我想匹配这一整行并在我的匹配项中指定一个字段作为我的脚本中的一个选项，例如（包含在 TID= 之前），那么，什么我想做的是：

```
use Getopt::Std;
getopts("Ch:t:",\%opts);

if ( $opts{t} ) {
    $TIDS = $opts{t};
} else {
    $TIDS = '/S*';
} 
```

所以，我正在尝试这样做，我的匹配替换变量 $TIDS，使用 getopts -t

```
if ( $line =~ m/XEP.[0-9].*:(\d{4}) (\d{2})(\d{2})(\d{2}).*XEPInfoFormat:Status=(\w*):TID=(${TIDS}) 
```

因此，如果我使用 -t 选项指定参数，例如：

```
perl-script.pl -t 888894343 
```

我希望它在我的整个正则表达式中像这样匹配：

```
if ( $line =~ m/XEP.[0-9].*:(\d{4}) (\d{2})(\d{2})(\d{2}).*XEPInfoFormat:Status=(\w*):TID=(888894343) 
```

但是，如果我不指定这个，我希望它像这样匹配：

```
if ( $line =~ m/XEP.[0-9].*:(\d{4}) (\d{2})(\d{2})(\d{2}).*XEPInfoFormat:Status=(\w*):TID=(/S*) 
```

我知道我可以简单地将所有行与 (/S*) 匹配，然后像下面这样放置一些简单的 if 条件，但是这样我会失去性能，因为有很多行像我举的例子一样，所以我会喜欢灵活搭配

```
print "$line\n" if $6 eq $TIDS; 
```

有人有什么想法吗？我尝试使用quotemeta，加上简单的引号，双引号我的正则表达式，但没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:16:01.883

另一个建议。无需一次检查`TID`并解析该行的值：您可以先对记录进行非常快速的检查，然后解析（使用散列技术或使用您选择的正则表达式）它，如果它是兴趣。

```
while (<>) {
  next if $opts{t} and $line !~ /:TID=$opts{t}:/;
  # Parse and process record
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:41:02.573

您的代码不起作用的主要原因是您使用的是`'/S*'`，它匹配一个斜杠后跟零个或多个`S`字符，而不是`'\S*'`，它是零个或多个空白字符。

但是，与其使用正则表达式，我认为最好将每条记录拆分为使用`split /:/`. 此外，前四个之后的所有字段都是 for `name=value`，因此可以方便地将这些字段放入哈希中以便于访问。那么你所要做的就是检查`if ($ch{t} eq $params{TID}) { ... }`。

此代码演示。我曾经用来`Data::Dump`显示`%params`构建的哈希的内容。目前尚不清楚前四个字段中的信息是否重要，但我已将它们提取出来`@params`以备不时之需。

```
use strict;
use warnings;

use Data::Dump;

my %opts = (t => 888894343);

while (my $line = <DATA>) {
  chomp $line;
  my %params = $line =~ /([^:=]+)=([^:=]+)/g;
  ddx \%params;
  #next if $opts{t} and $params{TID} ne $opts{t};
  my @params = (split /:/, $line, 5)[0..3];
  ddx \@params;
  #print $line;
}

__DATA__
XEP.101     :1804 000000:I:XEPInfoFormat:Status=ok:TID=00000000516F6161-000874C3-00003E19-62F2B0C6:CallType=gprs:CallStart=20130415210553:CallDuration=4334:ServedParty=724044024363999:ServedLocation=724:OtherParty=TIM:OtherLocation=tim.br:ServedZone=ZO00001:OtherZone=ZP32363:TariffZone=ZN1261:CUST_ID=58922505:CO_ID=58891164:account=8327813:MSISDN=554599836655:theoretical_cost_value=33.323525:BA_Line_Main_value=NA:Tariff=TM_PL5PR:FU_Packs_used=FU_PLWI2:SNCODE_FU=1350_1250_1_BA_FU_PLWI2_Byt_Internet2:MCs_used=NO:bcd=20100319,bcp=P1M:InputFilename=201304172345.000020:EipFilename=/gold/rte/data/RatedEvents/EIP/10/101201304172345.000020:RtxFilename=/gold/rte/data/RatedEvents/RTX/01/OPSCGOLD_20130418000000_1011917.xml:BadrateFilename=/gold/rte/data/BadRate/bad_rate_xep10.201304172345.000020.tmp:FILE=/gold/rte/data/IncomingCDRs/ASN1/010/GPRS99+GPRS99-46299-1304172357-SA.TTF;TICKET=660 
```

**输出**

```
# para.pl:11: {
#   account                => 8327813,
#   BA_Line_Main_value     => "NA",
#   BadrateFilename        => "/gold/rte/data/BadRate/bad_rate_xep10.201304172345.000020.tmp",
#   bcd                    => "20100319,bcp",
#   CallDuration           => 4334,
#   CallStart              => 20130415210553,
#   CallType               => "gprs",
#   CO_ID                  => 58891164,
#   CUST_ID                => 58922505,
#   EipFilename            => "/gold/rte/data/RatedEvents/EIP/10/101201304172345.000020",
#   FILE                   => "/gold/rte/data/IncomingCDRs/ASN1/010/GPRS99+GPRS99-46299-1304172357-SA.TTF;TICKET",
#   FU_Packs_used          => "FU_PLWI2",
#   InputFilename          => "201304172345.000020",
#   MCs_used               => "NO",
#   MSISDN                 => 554599836655,
#   OtherLocation          => "tim.br",
#   OtherParty             => "TIM",
#   OtherZone              => "ZP32363",
#   RtxFilename            => "/gold/rte/data/RatedEvents/RTX/01/OPSCGOLD_20130418000000_1011917.xml",
#   ServedLocation         => 724,
#   ServedParty            => 724044024363999,
#   ServedZone             => "ZO00001",
#   SNCODE_FU              => "1350_1250_1_BA_FU_PLWI2_Byt_Internet2",
#   Status                 => "ok",
#   Tariff                 => "TM_PL5PR",
#   TariffZone             => "ZN1261",
#   theoretical_cost_value => 33.323525,
#   TID                    => "00000000516F6161-000874C3-00003E19-62F2B0C6",
# }
# para.pl:14: ["    XEP.101     ", "1804 000000", "I", "XEPInfoFormat"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:23:50.747

如果您尝试在命令行参数等变量上使用 quotemeta，则需要执行以下操作：

```
$foo = quotemeta($ARGV[0]); 
```

# asp.net-mvc - MVC 4 - 如何在视图中正确执行 URL？

> ID：16123635
> 
> 赞同：1
> 
> 时间：2013-04-20T18:17:00.530
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我有一个 MVC 4 视图。其中一个属性是“Url”。我在此视图的字段中显示 URL 的值，当用户单击它时，我想执行 URL。我有这个代码：

```
<div class="display-label">
     @Html.DisplayName("Url")
</div>
<div class="display-field">
    <a href="@Model.Url">@Model.Url</a>
</div> 
```

问题是当用户单击此 URL（我使用 www.microsoft.com 作为测试）时，我收到以下错误：

```
Requested URL
   http://localhost:52070/HousingBuyerSearch/Details/www.microsoft.com 
```

所以似乎我做错了什么，因为它试图调用控制器上的方法。我对这一切还很陌生，所以我不完全确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:29:25.840

在这种情况下，问题是您`Url`没有以协议 (IE `http://`) 开头 - 因此浏览器将其解释为文档的相对 url。您需要向您的应用程序添加一些逻辑，以确保外部 url 以协议开头，如下所示：

```
var url = "www.microsoft.com";
if (!string.IsNullOrWhiteSpace(url) && !url.StartsWith("http://")) {
    url = "http://" + url;
} 
```

# c# - 如何根据另一个下拉列表的操作设置下拉列表的值？

> ID：16123639
> 
> 赞同：0
> 
> 时间：2013-04-20T18:17:36.883
> 
> 标签：c#, asp.net

我是 C# 和 asp.net 的初学者。

在我的工作中，一个特定的网络表单包含两个下拉列表，其 ID 分别为“DepartFrom”和“DepartTo”。每个列表都包含相同的文本项。文本是“达卡、吉大港、锡尔赫特、考克斯巴扎尔”。

现在我想采取如下行动：

1.  当我在“DepartFrom”列表中选择“Dhaka”时，它不会出现在“DepartTo”列表中，但其他人会出现。
2.  当我在“DepartFrom”列表中选择“文本”时，“Dhaka”除外，“DepartTo”列表中只会出现“Dhaka”。

我已经尝试过了，但它不起作用。

```
`protected void Page_Load(object sender, EventArgs e)
        {

                if (DepartFrom.Items.ToString() == "达卡")
                {
                    DepartTo.Items.Clear();
                    DepartTo.Items.Add("吉大港");
                    DepartTo.Items.Add("Cox'sbazar");
                    DepartTo.Items.Add("锡尔赫特");
                    DepartTo.SelectedIndex = 0;
                }

                别的
                {
                    DepartTo.Items.Clear();
                    DepartTo.Items.Add("达卡");
                    DepartTo.SelectedIndex = 0;
                }

        }
`

```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:22:44.300

您可以设置`AutoPostBack="true"`定义第二个下拉列表行为的下拉列表，并`SelectedIndexChanged`在此下拉列表上定义事件

```
asp:DropDownList ID="DepartTo" runat="server" AutoPostBack="True" 
        onselectedindexchanged="itemSelected">
    </asp:DropDownList> 
```

代码背后

```
protected void itemSelected(object sender, EventArgs e)
{
   var control = (DropDownList)sender; 
   if(control.SelectedValue == "")
   {
     .....
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:46:02.237

这是一个很长但易于理解的方法：

```
<asp:DropDownList ID="DepartFrom" runat="server" AutoPostBack="True" 
        onselectedindexchanged="fromSelected">
    </asp:DropDownList>

<asp:DropDownList ID="DepartTo" runat="server">
 </asp:DropDownList> 
```

代码背后。

```
string[] items={"Dhaka", "Chittagong", "Sylhet", "Cox'sbazar"};
protected void fromSelected(object sender, EventArgs e)
{

 if((sender as DropDownList)!=null)
  {
   DepartTo.Items.Clear();
   foreach(string str in items)
    {
       if((sender as DropDownList).SelectedItem.ToString()!=str)
       {
        DepartTo.Items.Add(str);
       }
     }
   }

} 
```

# c# - Membus 和 Simple Injector - 通过接口自动连接命令处理程序

> ID：16123641
> 
> 赞同：2
> 
> 时间：2013-04-20T18:17:46.123
> 
> 标签：c#, simple-injector, message-bus, membus

我在 Membus 中看到了 IoC 功能，我尝试将其连接到 Simple Injector

```
IEnumerable<object> IocAdapter.GetAllInstances(Type desiredType)
{
var found = SimpleInjectorContainer.GetAllInstances(desiredType);
return found;
} 
```

这个想法是我将自动注册我的所有类型`RegisterManyForOpenGeneric(typeof<CommandHandler<>),typeof<CommandHandler<>).Assembly)`。

毫无疑问，通常有充分的理由，SimpleInjector 不允许多次注册 - 但是，我想这样做是为了让不同的处理程序实现命令处理的不同方面/问题。

```
public void MembusBootstrap()
{
    this.Bus = BusSetup.StartWith<Conservative>()
    .Apply <IoCSupport>(c =>
    {
        c.SetAdapter(SimpleInjectorWiring.Instance)
           .SetHandlerInterface(typeof(HandleCommand<>));
    })
    .Construct();
}

public void SimpleInjectorBootstrap()
{
    this.Container.Register<HandleCommand<AccountCreatedCommand>,
        SetupNewAccountCommandHandler();

    // next line will throw
    this.Container.Register<HandleCommand<AccountCreatedCommand>,
        LogNewAccountRequestToFile>();
} 
```

当然，`IEnumerable<object> IocAdapter.GetAllInstances(Type desiredType)`来自 membus 的接口需要一个集合，因此可以调用多个处理程序。

将 Membus 与 SimpleInjector IoC 结合的最佳方式是什么？

**脚注**

我已经看到了按照惯例连接menbus的其他方法：

```
public interface YetAnotherHandler<in T> {
  void Handle(T msg);
}

public class CustomerHandling : YetAnotherHandler<CustomerCreated>
...

var b = BusSetup  
  .StartWith<Conservative>()  
  .Apply<FlexibleSubscribeAdapter>(c => c.ByInterface(typeof(YetAnotherHandler<>))  
  .Construct();

var d = bus.Subscribe(new CustomerHandling()); 
```

但我真的很想坚持使用 IoC 容器来处理生命周期范围，并避免实例化命令处理程序并在需要它们之前手动连接它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T20:13:21.630

您可以有多个注册。这是一个例子（抱歉，我的电脑今天死了，我在记事本上写这个）：

```
SimpleInjectorContainer.RegisterManyForOpenGeneric(typeof(CommandHandler<>),
    AccessibilityOption.PublicTypesOnly,
    (serviceType, implTypes) => container.RegisterAll(serviceType, implTypes),
    AppDomain.CurrentDomain.GetAssemblies()
); 
```

并且可以通过以下方式检索它们：

```
public IEnumerable<CommandHandler<T>> GetHandlers<T>()
    where T : class
{
    return SimpleInjectorContainer.GetAllInstances<CommandHandler<T>>();
} 
```

你会发现[这里](http://simpleinjector.codeplex.com/wikipage?title=Advanced-scenarios&referringTitle=Home#Batch-Registration)`RegisterManyForOpenGeneric`描述的这些版本的和`GetAllInstances`方法

我使用这种技术来支持发布/订阅框架。你可以有*n*个**独立** `CommandHandler`的

# php - 如何接收 facebook graph api 返回的数据？

> ID：16123644
> 
> 赞同：0
> 
> 时间：2013-04-20T18:17:54.953
> 
> 标签：php, facebook-graph-api

我是stackoverflow和编程的新手。我只是在学习 php，并决定使用 facebook place search api 来进行练习。

我在php中编写了以下代码：

```
$FacebookGraphURL = 'https://graph.facebook.com/search?q='.$keyword.'&type=place' . htmlentities('&center=') .$center.'&distance='.$distance.'&access_token='.ACCESS_TOKEN;

$FacebookGraphJSON = @file_get_contents($FacebookGraphURL);
$dataArray = json_decode($FacebookGraphJSON); 
```

但它不返回任何东西。我认为这不是从图形 api 获取的合适方法。我搜索了很多，但找不到一个我能理解的，因为我是新手。

谁能帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T23:19:51.733

1)`htmlentities('&center=') .$center`应该是`&center=' . htmlentities($center) .`

2）当您的文件请求失败时，不要在`file_get_contents`此之前使用 @ 将抑制错误（在这种情况下为警告）。

试试下面的代码：

```
error_reporting(E_ALL);
ini_set('display_errors', 'On');
define('ACCESS_TOKEN','**********************************************');
$keyword = 'coffee';
$center= urlencode('37.76,-122.427');
$distance=1000;
$FacebookGraphURL = 'https://graph.facebook.com/search?q='.$keyword.'&type=place&center='.$center.'&distance='.$distance.'&access_token='.ACCESS_TOKEN;
$FacebookGraphJSON = file_get_contents($FacebookGraphURL);
$dataArray = json_decode($FacebookGraphJSON);
var_dump($dataArray);
exit; 
```

# java - 可以在 Java 中创建新的原始数据类型

> ID：16123645
> 
> 赞同：10
> 
> 时间：2013-04-20T18:18:00.393
> 
> 标签：java, types

首先我想在这里澄清一下，这个问题是出于好奇。我没有遇到任何问题。

`byte`在 Java 、`short`、等中有许多可用的原始类型`int`。现在假设我想创建一个新的原始类型（例如`mediumint`或其他任何东西）。我们可以这样做吗？如果是，那怎么办？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-20T18:19:43.380

原始类型是由语言本身定义的类型。在`Java`您只能将新类型定义为`Classes`所有从名为`Object`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T18:24:53.383

你可以，但它就不再是 Java 了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T18:19:58.090

您不能创建自己的原始数据类型。

正如 Java 文档所解释[的：原始类型由语言预定义并由保留关键字命名。](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T18:19:58.883

不，您不能创建原始数据类型。

原始数据类型是指语言特征中提供和存在的数据类型。基本上Java出于性能原因支持这一点并执行算术运算。

`class`您可以使用和的概念创建用户定义的数据类型`object`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-30T15:28:13.740

你们都错了。是的。你可以。通常，您不需要全新的原始类型。因此，您不需要重建 JVM。通常，您只需要将新的原始类型“打包”或“转换”为现有类型，并使用其包装器定义一些操作，如“+”。

您可以使用原始 JVM 相对简单地执行此操作，但使用您自己的 Java 编译器。祝你好运！

# javascript - 所有图片库链接上的 Div 弹出窗口

> ID：16123650
> 
> 赞同：0
> 
> 时间：2013-04-20T18:18:46.727
> 
> 标签：javascript, html, ajax

谁能告诉我这段代码有什么问题？我有一个图片库，我想为画廊的每张图片添加一个弹出窗口，但它只在同一张图片上打开。我尝试了许多不同的示例，它们大部分时间仅适用于一个链接，而不适用于所有画廊链接。

点击购物车图标

[这是我的小提琴....](http://jsfiddle.net/tqTcS/43/)

```
 $(document).ready(function(){

//Image pop on mouseover
$("#gallery2 a").append('<span id=myspan class=myspanclass><a  id=deleteimg href="#"      class="delete" ></a><a href="#" class="showreranks" id="d" ><img      src="images/insert_to_shopping_cart.png" class="imgOpa" size=20 width=20 border=0></a></span>');

$(this).find('#gallery2 a.showreranks').append('<div id="popupdiv" class="closemediv"><div class="closemediv"><a href=""><img src="http://icons.iconarchive.com/icons/kyo-tux/aeon/16/Sign-Close-icon.png" width="16"></a></div><div id="list_preview" class="popupcontent"><p>Some Text!</div></div>');

//makes sure when deleting image it does not pops the fancybox
 $('span a').bind('click', function(e) {
e.stopPropagation();

 });

  $(".photo-link").on({

mouseenter: function () {

 $(this).find('span').stop().delay(100).fadeIn(200);
},
mouseleave: function () {
  $(this).find('span').stop(true).fadeOut(0);
 }
   });

 //Popup Div Start
  $(function () {
   $('a.showreranks').click(function () {
     position = $(this).position();
    $('body').append('<div class="overlay"></div>')
    $('#popupdiv').fadeIn(300);
    $('#popupdiv').css('top', position.top + 17);
    return false;
  });
    });

     (function (a) { 
      jQuery.fn.screencenter = function () {
     this.css("position","absolute");
    this.css("top", (($(window).height() - this.outerHeight()) / 2) +            $(window).scrollTop() + "px");
    this.css("left", (($(window).width() - this.outerWidth()) / 2) +   $(window).scrollLeft() + "px");
    return this;
}  
         })(jQuery);
      //Popup Div End

         }); 
       </SCRIPT> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:56:05.367

两个图像中的弹出窗口都有相同的 id（id 选择器用于指定唯一元素，因此当您想要重复样式时使用类）。所以 `$('#popupdiv').fadeIn(300);`适用于最后一张图片中的最后一个 popupdiv。使用一个类`.popupdiv`。此外，您不需要通过 JS 设置最高值。只需在 CSS 中给出 top 和 left 值。

CSS

```
.popupdiv {
  BORDER-BOTTOM: black 1px solid;
  POSITION: absolute;
  BORDER-LEFT: black 1px solid;
  BACKGROUND-COLOR: #fffff2;
  WIDTH: 90px;
  DISPLAY: none;
  MARGIN-LEFT: 0px;
  OVERFLOW: hidden;
  BORDER-TOP: black 1px solid;
  BORDER-RIGHT: black 1px solid;
  border-radius: 6px;
  text-shadow: none;
  padding: 3px;
  z-index: 100;
  left: 0;
  top: 20px;
} 
```

JS

```
$('.popupdiv',$(this)).fadeIn(300); 
```

见[小提琴](http://jsfiddle.net/tqTcS/45/)

更新：

使用最新的 Jquery 1.9+`on`来工作

对于鼠标离开

```
$('.popupdiv', $(this)).on('mouseleave', function () {
    $(this).hide();
}); 
```

点击关闭

```
$('.closemediv').on('click',function(e){
    e.stopPropagation();
    $(this).closest('.popupdiv').hide();
 }) 
```

见[小提琴](http://jsfiddle.net/tqTcS/48/)

# javascript - AJAX 请求 - cookie 认证

> ID：16123657
> 
> 赞同：2
> 
> 时间：2013-04-20T18:19:22.410
> 
> 标签：javascript, ruby-on-rails, firefox, firefox-addon

我正在构建一个需要通过 AJAX 与 RoR Web 应用程序交互的小部件（使用 JavaScript）。用户的工作流程如下所示：

1.  登录到 RoR 网络应用程序
2.  获取浏览器扩展或小书签（两者共享相同的代码库），无论哪个
3.  转到网站并激活小部件
4.  在你想保存的那个网站上点东西，按确定
5.  您会在 Web 应用程序上获取包含捕获内容的 URL

小部件代码中的工作流程类似于：

1.  从 DOM 收集东西并发出相关的 jQuery JSONP 请求
2.  如果响应中有一条自定义状态消息读取“未授权”，请打开一个`<iframe />`来自 Web 应用程序的授权页面 - 如果响应中的身份验证成功，则会有一个`Set-Cookie`标头设置后续 AJAX 请求所需的身份验证 cookie
3.  如果需要身份验证，请再次尝试 JSONP 请求

这仅适用于书签。但是，对于 Firefox 扩展程序，Web 应用程序会接收已去除 auth cookie 的请求。事实上，去掉了所有的 cookie。似乎请求是沙盒的。现在我知道有`@mozilla.org/cookieService`扩展可用。问题是：

1.  如何将 cookie 从扩展的 main.js 传递到内容脚本中的 JSONP 请求？
2.  如何使用 url localhost:3000 获取开发环境的 cookie？`cookieService`返回 null 作为该 url 的cookie
3.  将身份验证的解析方式从 cookie 更改为其他方式是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T16:09:47.893

这些请求并不是真正的沙盒，但缺少原始文档。因为网络代码不知道请求是*第一方*请求还是*第三方*请求，并且默认将其视为后者。Firefox 不久前禁止向第三方服务器发送 cookie，这就是您的请求中没有 cookie 的原因。

在 XUL/XPCOM 附加组件中你会做（最简单的方法）：

```
var req = <construct xmlhttprequest>;
...
req.open(...);
if (req.channel instanceof Components.interfaces.nsIHttpChannelInternal) {
  req.channel.forceAllowThirdPartyCookie = true;
} 
```

附加 SDK 用户在使用时可以执行以下操作`net/xhr`：

```
const { XMLHttpRequest, forceAllowThirdPartyCookie } = require("sdk/net/xhr");
var req = new XMLHttpRequest();
...
req.open(...);
forceAllowThirdPartyCookie(req); 
```

更高级别的`request`模块总是自动调用`forceAllowThirdPartyCookie`。

现在回到你的问题：

1.  不要使用`JSONP`. `eval()`这与在（有点）安全的上下文中获取远程、不受信任的代码基本相同。您永远不知道周围是否存在中间人攻击者（如果使用不安全的连接）或服务器是否受到威胁（所有连接）。

    无论如何，内容脚本不能使用上述方法，因此您必须在特权代码（例如`main.js`）中执行请求并使用消息传递将响应传递给内容脚本。

2.  你真的不应该`nsICookieService*`直接使用。如果您真的喜欢使用该服务，请阅读[文档](https://developer.mozilla.org/en-US/search?q=nsicookieservice)。

3.  我猜你总是可以切换到另一个身份验证方案。使用哪一个以及如何使用取决于您的要求（即太宽泛而无法回答）。

# java - 带有嵌入式码头服务器的 Spring MVC 资源

> ID：16123658
> 
> 赞同：2
> 
> 时间：2013-04-20T18:19:31.570
> 
> 标签：java, spring, spring-mvc

我无法让我的 spring mvc webapp 工作。我正在使用带有嵌入式码头服务器的 Spring MVC。

问题是我的 mvc:resources 标签不起作用，我不知道为什么。

以下是标签：

```
<mvc:resources mapping="/css/**" location="/css/"/>
<mvc:resources mapping="/js/**" location="js/"/> 
```

我的目录结构：

*   源代码
    *   主要的
        *   爪哇
        *   资源
            *   元信息
                *   应用程序上下文.xml
                *   网络上下文.xml
        *   网络应用
            *   css
                *   main.css
            *   js
                *   main.js

现在，当我转到 时`http://localhost:8080/css/main.css`，我在调试输出中看到了这一点：

```
Looking up handler method for path /css/main.css
Did not find handler method for [/css/main.css]
URI Template variables for request [/css/main.css] are {}
Mapping [/css/main.css] to HandlerExecutionChain with handler [org.springframework.web.servlet.resource.ResourceHttpRequestHandler@223c78ba] and 1 interceptor
Last-Modified value for [/css/main.css] is: -1
Trying relative path [main.css] against base location: ServletContext resource [/css/]
No matching resource found - returning 404 
```

为什么这不起作用？是我的目录结构，还是我错过了一些配置？

我会很感激你的帮助。

**编辑**更多信息

我使用 Maven 来构建一个带有 shade 插件的胖罐子。我现在在我的 pom.xml 中添加了这个

```
<resources>
    <resource>
        <directory>src/main/webapp</directory>
    </resource>
    <resource>
        <directory>src/main/resources</directory>
    </resource>
</resources> 
```

现在我的最终 jar 确实包含 css 目录，但仍然没有运气。

这是我启动嵌入式码头服务器的代码

```
int port = config.getInt("server.port");

final Server server = new Server();
final ServerConnector serverConnector = new ServerConnector(server);
serverConnector.setPort(port);
server.setConnectors(new Connector[]{serverConnector});

final DispatcherServlet servlet = new DispatcherServlet();
servlet.setContextConfigLocation("classpath:META-INF/web-context.xml");

ServletContextHandler context = new ServletContextHandler();
context.setContextPath("/");
context.addServlet(new ServletHolder("defaultServlet", servlet), "/*");

HandlerCollection handlers = new HandlerCollection();
handlers.setHandlers(new Handler[]{context, new DefaultHandler()});
server.setHandler(handlers);

server.start();
server.join(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T01:06:09.717

您可能需要为您的 servlet 上下文进行一些额外的配置，就像这样，以便在您通过正在构建的 jar 运行它时正确设置类路径内容：

```
final Resource base = Resource.newClassPathResource(".");

if (base != null) {
    context.setBaseResource(base);
} else {    
    // running in a jar
    final URI uri = Service.class.getProtectionDomain().getCodeSource().getLocation().toURI();
    context.setBaseResource(Resource.newResource("jar:" + uri + "!/"));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T08:35:54.803

确保您的应用程序上下文中提到了 mvc 架构 xsd。

```
xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd 
```

带有 mvc 的基本应用程序 xml 文件，上下文模式应如下所示：

```
<beans:beans xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

//your beans go here

</beans:beana> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:47:27.443

也许您缺少 url 中的上下文路径？

```
http://localhost:8080/<<context>>/css/main.css 
```

# ios - UIView 后面的地图问题，类似于 FourSquare 场地细节

> ID：16123661
> 
> 赞同：3
> 
> 时间：2013-04-20T18:19:52.530
> 
> 标签：ios, uiview, map, uiscrollview, foursquare

我目前正在使用来自@yonel 的**[出色解决方案](https://stackoverflow.com/a/11233650/1216394)**来制作类似于 FourSquare 场地详细信息页面的内容。在我的故事板中，我有这个：

![在此处输入图像描述](https://i.stack.imgur.com/rWl70.png)

问题是：因为滚动有点滞后，所以当我快速滚动时，我会收到“收到内存警告”。我的控制台中的消息。奇怪的是，如果我删除里面的所有标签和按钮`UIView`（就在下面`Map View`）内的所有标签和按钮，一切正常。

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T20:07:08.400

正如上面的海报所提到的，如果没有实际看到您的项目的一些代码，很难为您提供任何权威信息 - 我知道您已经找到了一个可行的解决方案。但是，如果其他用户发现此问题具有类似的响应：

错误消息的性质表明您的应用程序中可能存在某种内存泄漏。开始调试此类问题的最佳方法是使用`Instruments.app`. 有关如何执行此操作的详细信息，请查看 Apple 开发人员网站上的[此链接](https://developer.apple.com/library/mac/#documentation/developertools/Conceptual/InstrumentsUserGuide/MemoryManagementforYouriOSApp/MemoryManagementforYouriOSApp.html#//apple_ref/doc/uid/TP40004652-CH11-SW1)。

特别是如果某些在屏幕上或在屏幕外滚动的项目具有与之相关的图形信息（背景图像等） - 破坏屏幕外的东西可能有助于提高性能。当然，您必须在这些项目重新出现在屏幕上时重新创建它们。

如果上述方法没有帮助，请查看以下一些问题/答案，这些问题/答案可以深入了解发生此错误的其他问题。也许您的问题与/相关：

*   [收到内存警告的未知原因](https://stackoverflow.com/questions/15548033/unknown-reason-to-receive-memory-warning)
    1.  打开的图形太多
    2.  不使用延迟加载
*   [即使我正在释放，Iphone App 由于收到内存警告而崩溃](https://stackoverflow.com/questions/13156789/iphone-app-crashing-due-to-received-memory-warning-even-if-i-am-releasing)
    *   检查`Zombies`是否未打开（在低内存设备中崩溃更快）
*   [我收到内存警告，我的应用程序崩溃了。它会杀死自动释放对象吗？](https://stackoverflow.com/questions/9965749/i-received-memory-warning-and-my-app-crashed-does-it-kill-autorelease-objects)
    *   对象及其范围的不当分配/释放

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T13:10:02.800

不幸的是，经过几天的搜索，我找不到解决方案。但我设法找到了一些东西来替换我所拥有的东西，使用`UITableView`.

我为 UITableView 找到了这个 ParallelView：[https ://github.com/zhigang1992/ZGParallelView](https://github.com/zhigang1992/ZGParallelView)

感谢所有的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T09:21:39.710

收到内存警告，当我在设备中进行测试时，此警告显示在控制台中一次。但是当我关闭空闲应用程序时，错误消失了。所以尝试删除在后台运行的应用程序并重试。如果存在，我认为问题在于当您使用滚动时，地图图块或其他东西会出现某种内存泄漏。使用仪器并分析是否存在一些内存泄漏。

这可能会帮助你

[内存管理目标c教程](http://www.raywenderlich.com/2657/memory-management-in-objective-c-tutorial)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T09:12:17.617

我不熟悉 Foursquare 中的 Venue Detail 视图，但是我认为如果不看一些代码我们就无法帮助您解决这个问题。

乍一看，我注意到您还没有展开另一个视图。也许那里有一些沉重的东西，但我认为您需要为这些视图显示一些代码，因为您更有可能执行一些内存密集型任务，这就是导致问题的原因。

如果您也可以使用 scrollViewDidScroll 方法，则最好 :) 一旦您发布了某些内容，我会尽力查看。或者，如果您不想在此处公开发布，也可以直接与我联系并提供示例代码。

# linux - 提高 NIC 接收性能

> ID：16123665
> 
> 赞同：0
> 
> 时间：2013-04-20T18:20:08.387
> 
> 标签：linux, kernel, nic

我有一个英特尔 82598EB 10GBE 网卡。

我需要在不丢失数据包的情况下接收流量。

数据速率为 4-5 Gbps，数据包大小为 1500-9600 字节。

我已经配置了 smb 和 irq 亲和力。我还尝试使用数据包套接字（ PF_PACKET ）。

这些都没有帮助。小损失总是存在的。

现在我计划通过禁用任何增加 sk_buff 大小的配置设置并禁用 IOMMU 来编译内核。

还有哪些其他方法可以提高 rx 性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-04T17:55:33.633

如果您的系统是 numa 节点设置，则 Rx 或 Tx 性能可能会下降。如果您的系统有 numa 节点，则在将 10G 卡放入 PCI_E 插槽时，检查您要放置的 CPU PCI-E 插槽，然后根据将 irq 分配给特定 CPU 内核，看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T19:05:26.170

白天我正在更改驱动程序设置和网络子系统设置。发现只有 net.core.rmem_default 有影响（我使用的是 UDP）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-16T14:57:04.823

某些 nic 默认 rx 未默认设置为 max。可以使用 找到 rx/tx 的默认值和最大值`ethtool -g <interface>`，并使用 command 进行修改`ethtool -G <interface> rx value`。

# php - 新数据库插入后报价表未更新

> ID：16123666
> 
> 赞同：0
> 
> 时间：2013-04-20T18:20:23.573
> 
> 标签：php, mysql, sql, join

一切都正确连接，我有一个产品报价表，通过“product_id”链接到我的产品表。我刚刚在产品报价表中添加了一个新报价，它运行良好，但该新报价尚未在前端网站上更新。

报价表仍然只显示三个在报价的产品，而不是四个！

这是报价表的代码：

```
<?php 

$sql="SELECT a.product_id, a.Options_id, b.product_name, b.product_price, b.product_url, d.product_id, d.image_id, e.filename, e.image_id, h.product_id, h.Offer_price
FROM ProductOptions a
JOIN Products b ON a.product_id = b.product_id
JOIN ProductImage d ON d.product_id = b.product_id
JOIN image e ON e.image_id = d.image_id
JOIN ProductOffer h ON h.product_id = b.product_id
GROUP BY product_name
ORDER BY product_name DESC";

$result = mysql_query($sql);

if (!$result)

{

echo "An error occurred ".mysql_error();

exit;

}

echo "<table border=1>\n<tr><th><th></th></th><th bgcolor=\"#DFE8EC\">Name</th><th bgcolor=\"#DFE8EC\">Price OFFER!</th><th bgcolor=\"#DFE8EC\"></th><th>Product URL</th></tr>\n";

while ($line = mysql_fetch_array($result)) {

$name = $line["product_name"];

$url=$line["product_url"];

$image=$line["filename"];

$offer=$line["Offer_price"];

echo "<tr><td></td><td><img src=\"http://www.ehustudent.co.uk/cis21318867/cis3122/Tiersco%20Pro%20BodyBuilding/storeadmin/images/$image\" border=0></td><td bgcolor=\"#DFE8EC\">$name</td><td bgcolor=\"#DFE8EC\">£$offer</td><td bgcolor=\"#DFE8EC\"></td><td><a href= $url > More Info </a></td></tr>\n";

}

echo "</table>\n";

?> 
```

当新的报价插入数据库时​​，while 循环肯定会继续更新

# c# - 是否可以将字符串和 int 存储在一个列表中？

> ID：16123667
> 
> 赞同：0
> 
> 时间：2013-04-20T18:20:33.183
> 
> 标签：c#, xna

我想做一个分数列表。此外，孩子的名字也应该保存在该列表中。将分数和名称添加到列表后，对列表进行排序，使最低分数成为列表中的第一个条目。但我总是收到此错误消息：

> 使用泛型类型“System.Collections.Generic.List”需要 1 个类型参数

怎么了？不能将姓名和分数存储在一个列表中吗？我应该改变什么？

```
SpriteFont Scores;
Random random = new Random();
List<string> NamesList = new List<string>();
List<string,int> NamesAndPointsList = new List<string,int>();

protected override void LoadContent()
{
  spriteBatch = new SpriteBatch(GraphicsDevice);
  Scores = Content.Load<SpriteFont>("Arial");

  NamesList.Add("Veronica");
  NamesList.Add("Michael");
  NamesList.Add("Christina");

  for (int j = 0; j <= NamesList.Count - 1; j++)
  {
    int Points = random.Next(101);
    NamesAndPointsList.Add(NamesList[j],Points);
  }
  NamesAndPointsList.Sort();
}
protected override void Draw(GameTime gameTime)
{
  GraphicsDevice.Clear(Color.CornflowerBlue);
  spriteBatch.DrawString(Scores, NamesAndPointsList[0].ToString() + ";" + NamesAndPointsList[1].ToString() + ";" + NamesAndPointsList[2].ToString(), new Vector2(200, 200), Color.White);

        base.Draw(gameTime);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:25:34.003

定义是 List ，它确实需要一个类型。

但是是什么阻止您定义该类型？

```
public struct User
{
   public string Name { get; set;}
   public int Score { get; set;}
}

var users = List<User>(); 
```

或者如果您不想定义类

```
var users = List<Tuple<string, int>>(); 
```

但是，如果您只是想要一个可以容纳多种类型实例的列表，那么没有什么可以阻止您使用“ArrayList”或对象列表。尽管我会避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T20:20:24.033

您可以使用 a `Tuple`，创建您自己的`Object`，或使用[Dictionary](http://www.dotnetperls.com/dictionary)，这非常适合您尝试做的事情。与 a 相比，A在这种情况下`Dictionary`会*更好地*`List`工作，因为它可以轻松执行查找。

该`Dictionary`类型提供了带有键的快速查找以获取值。有了它，我们可以使用任何类型的键和值，包括整数和字符串。

```
Dictionary<string,int> Users = new Dictionary<string,int>(); 
```

基本上，作为 a的**Key**`string`是用户名，作为 an的**Value**`int`是分数。

要添加新用户，您可以这样做

```
 Users.Add("Michael",0); //Create new user named Michael, who starts with 0 points 
```

现在你可能想得到迈克尔分数，你可以通过这样做快速找到它

```
 int Score = Users["Michael"]; 
```

我也不认为需要一个`Names`和`NameAndPoints`列表，你可以只使用一个。

# c - 初始化数据结构

> ID：16123668
> 
> 赞同：1
> 
> 时间：2013-04-20T18:20:33.830
> 
> 标签：c, arrays

我有这个数据结构：

```
typedef struct
{
    float XYZW[4];
    float RGBA[4];
} Vertex;

    Vertex axisVertices[] =
{   
    { { -0.885f, -0.885f, 0.0f, 1.0f }, { 1.0f, 1.0f, 1.0f, 1.0f } }, 
    { { -0.885f,  0.885f, 0.0f, 1.0f }, { 0.0f, 0.0f, 1.0f, 1.0f } }, 
    { { 0.885f, -0.885f,  0.0f, 1.0f }, { 0.0f, 1.0f, 0.0f, 1.0f } }
}; 
```

我习惯了java，所以这种事情我认为C是不可能的。我该怎么做：

```
float temp1 = -0.04f;
float temp2 = -0.08f;
float temp3[] = { -0.885f,  0.885f, 0.0f, 1.0f };

Vertex axisVertices3[] =
{   
    { { temp1 , temp2 , 0.0f, 1.0f }, { 1.0f, 1.0f, 1.0f, 1.0f } }, 
    { temp3, { 0.0f, 0.0f, 1.0f, 1.0f } }, 
    { { 0.885f, -0.885f,  0.0f, 1.0f }, { 0.0f, 1.0f, 0.0f, 1.0f } }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:07:51.083

这有效：

```
Vertex axisVertices3[] =
{   
    { { temp1 , temp2 , 0.0f, 1.0f }, { 1.0f, 1.0f, 1.0f, 1.0f } }, 
    { {temp3[0],temp3[1],temp3[2],temp3[3]}, { 0.0f, 0.0f, 1.0f, 1.0f } }, 
    { { 0.885f, -0.885f,  0.0f, 1.0f }, { 0.0f, 1.0f, 0.0f, 1.0f } }
}; 
```

这并不完全是您想要实现的目标，但它已经足够接近了。

# umbraco - Umbraco 安装向导错误 - 创建用户步骤

> ID：16123672
> 
> 赞同：0
> 
> 时间：2013-04-20T18:20:51.497
> 
> 标签：umbraco

我正在使用 Umbraco 6.0.3、VS2012 和 SQL Server 2008 Express 我在安装向导时遇到了一些问题；尝试继续“创建用户”步骤（步骤 4）时，它不断抛出以下错误。

数据库正在成功创建，所以我不知道出了什么问题；任何帮助是极大的赞赏！

谢谢！

这是堆栈跟踪：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   umbraco.BusinessLogic.User.setupUser(Int32 ID) +166
   umbraco.BusinessLogic.User..ctor(Int32 ID) +140
   umbraco.BusinessLogic.User.GetUser(Int32 id) +139
   umbraco.presentation.install.steps.Definitions.DefaultUser.Completed() +53
   umbraco.cms.businesslogic.installer.InstallerStepCollection.GotoNextStep(String key) +184
   umbraco.presentation.install._default.GotoNextStep(String currentStep) +70
   umbraco.presentation.install.Helper.RedirectToNextStep(Page page) +118
   umbraco.presentation.install.steps.detect.gotoNextStep(Object sender, EventArgs e) +52
   System.Web.UI.WebControls.LinkButton.OnClick(EventArgs e) +116
   System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String eventArgument) +101
   System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +9643314
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1724 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:32:03.447

啊! 整理好了！

项目中没有包含很多很多文件/文件夹，而 BusinessLogic dll 和 xml 就是其中的一些文件。

他们现在被包括在内，它正在工作......现在！

# arrays - Rails：从多维数组创建一维数组

> ID：16123673
> 
> 赞同：0
> 
> 时间：2013-04-20T18:20:51.860
> 
> 标签：arrays, ruby-on-rails-3

我有一个多维数组：@line_items

它具有与模型、产品和用户的链接。

我想从@line_items 生成一个包含用户电子邮件的一维数组。

像这样的东西：

```
 emails = @line_items.product.user.email 
```

但它不起作用并给出错误：

```
 undefined method `user' for #<Array:0xb1a12e74> 
```

对于单个 line_item 它有效。

```
 email = @line_item.product.user.email 
```

我试图生成这样的数组：

```
 @line_items.each do |i|
        @foodio.each do |j|
            @foodio[j] = i.product.user.email
        end
    end 
```

但它给

```
 undefined method `each' for nil:NilClass 
```

因为 foodio 是零。

任何机构都可以在这里提供帮助吗？

谢谢阅读！

**更新**

我的 UserMailer 模型：

```
class UserMailer < ActionMailer::Base
  default :from => "email@mealnut.com"

  def welcome_email(user, order)
@user = user
    @order = order
    @line_items = @order.line_items
    @foodio = @line_items.map do |line_item|
  line_item.product.user.email
end   

    mail(:to => user.email, :cc => ["care@mealnut.com", "#{foodio}"], :subject => "Order no. #{order.id}")
   end

  end 
```

订单控制器：

```
 def process_order
   @order = current_order
   @line_items = @order.line_items
    if @line_items.size > 0
         session[:order_id] = nil
         UserMailer.welcome_email(current_user, @order).deliver
    else
      render :action => "cart"
   end

 end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:23:18.610

我认为这就是你想要的：

```
array_of_emails = @line_items.map do |line_item|
  line_item.product.user.email
end 
```

**升级版**。如果您有真正的多元素数组，请使用[`Array#flatten`](http://ruby-doc.org/core-2.0/Array.html#method-i-flatten)：

```
my_array = [ [1,2], [3,4], [5,6] ]
my_array.flatten # => [ 1, 2, 3, 4, 5, 6 ] 
```

# batch-file - 使用批处理文件简化编译..？

> ID：16123675
> 
> 赞同：0
> 
> 时间：2013-04-20T18:21:02.747
> 
> 标签：batch-file

情况如下：

我正在开发具有相同编译过程/文件结构的各种项目。我想，而不是打字，`javac dir\*.class`我只想使用批处理文件“compile.bat”

文件结构通常是 com\jseb{project name}.java 文件，但我希望尽可能抽象，以便将来使用多个包。这是我到目前为止所拥有的（不起作用）：

```
@echo off
javac com\*\*.java 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T04:38:18.827

如果要编译所有项目，那么

```
@echo off
for /f "delims=" %%i in ('dir /b /ad com\*') do javac "com\%%i\*.java" 
```

连续构建所有项目（一次一个）

或者

```
@echo off
for /f "delims=" %%i in ('dir /b /ad com\*'
 ) do start "Compiling %%i" javac "com\%%i\*.java" 
```

并行构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:31:39.663

您可以拥有一个包含目录名称的通用批处理文件。

编译.bat：

```
@echo off
javac com\%1\*.java 
```

`%1`替换传入批处理文件的第一个参数的方法。

从命令行使用：

```
compile proj-dir 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T19:16:03.337

不。

转向更好的软件工程方法和技术，以及更复杂、强大和高效的软件开发工具。

1.  学习和使用构建系统。**从Ant**开始，然后转到**Maven**。

2.  并学习和使用 IDE。尝试**Eclipse**。

只需很少的努力，从提供的示例 ant 脚本开始，您就可以实现这样的解决方案，通过依赖检查自动编译复杂目录结构中的所有代码文件。

# c++ - C ++中的写时复制指针对象

> ID：16123676
> 
> 赞同：2
> 
> 时间：2013-04-20T18:21:03.403
> 
> 标签：c++, shared-ptr, smart-pointers, copy-on-write

我试图按照这篇文章 [http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Copy-on-write](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Copy-on-write)了解如何在 C++ 中实现写入时复制指针。问题是，它对我不起作用。

对象的症结在于重载解引用运算符 (*) 以进行后台复制，如果它应该返回一个非常量引用：

```
 const T& operator*() const
    {
        return *m_sp;
    }
    T& operator*()
    {
        detach();
        return *m_sp;
    } 
```

可悲的是，似乎只运行了第二个版本。C-outing 我指向的对象会创建一个副本，甚至执行类似的操作

```
 CowPtr<string> my_cow_ptr(new string("hello world"));
   const string& const_ref=*my_cow_ptr; 
```

导致`detach()`函数运行。

关于为什么它没有像宣传的那样工作的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:45:43.423

`const`成员函数将在对象`const`上调用。所以：

```
const CowPtr<std::string> my_const_cow_ptr(new std::string("Hello, world"));
const std::string& str = *my_const_cow_ptr; 
```

或者

```
CowPtr<std::string> my_cow_ptr(new std::string("Hello, world"));
const std::string& str = *static_cast<const CowPtr<std::string>&>(my_cow_ptr); 
```

# c# - 将二进制数据读入ac#结构

> ID：16123679
> 
> 赞同：1
> 
> 时间：2013-04-20T18:21:23.797
> 
> 标签：c#, struct, binary-data

我有一个包含二进制数据的文件，其格式与此结构匹配：

```
struct MyStruct {
    UInt32 count;
    UInt32[] items;
} 
```

二进制数据可以是任意长度，因为可以有任意数量的项目，但项目的数量是在 count 中定义的。使用`Marshal.PtrToStructure`似乎不允许这种二进制格式，其中有可变数量的项目？使用属性可以设置项目数组的大小，但这必须是一个常量，有没有办法告诉它在`count`读取数据时查看？

我想过用XML定义格式，并用我自己的代码用它来读入结构，但这会是很多重复的数据，如果文件格式改变了，我必须改变XML和结构，而不仅仅是结构。

而且我考虑过在`items`字段上使用自定义属性，并编写自己的代码来读取数据，但是为了枚举结构的字段，我必须使用反射？哪个慢？

（我也可以自己手动阅读，但我已经为这个问题修剪了结构，并且如果结构发生变化，我希望不必更改阅读代码）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:46:24.470

`.Read()`在 的实例上使用方法`Stream`，读入 a `byte[]`，然后使用`System.BitConverter.ToUInt32(bytearray, startindex)`将二进制数据转换为`uint32`形式。

# ruby - 切换接收器和 `Enumerable#inject` 的参数

> ID：16123680
> 
> 赞同：0
> 
> 时间：2013-04-20T18:21:30.210
> 
> 标签：ruby, enumerable

使用 时`Enumerable#inject`，大多数时候，我们希望结果与作为`inject`. 例如，我们像这样使用它：

```
[1, 2, 3, 4, 5]
.inject(5){|i, e| i += e}
# => 20

[3, 4, 5]
.inject(1 => 1, 2 => 1){|h, e| h[e] = h[e - 1] + h[e - 2]; h}
# => {1=>1, 2=>1, 3=>2, 4=>3, 5=>5} 
```

从这个操作取初值并修改成最终输出来看，以初值作为接收者，这样写会更自然：

```
5
.foo([1, 2, 3, 4, 5]){|i, e| i += e}
# => 20

{1 => 1, 2 => 1}
.foo([3, 4, 5]){|h, e| h[e] = h[e - 1] + h[e - 2]; h}
# => {1=>1, 2=>1, 3=>2, 4=>3, 5=>5} 
```

where`Object#foo`将被定义为

```
def foo enum, &pr; enum.inject(self, &pr) end 
```

在某些类似于此的库中是否有现成的方法`foo`？

# java - 具有动态名称的多个 JTable

> ID：16123685
> 
> 赞同：0
> 
> 时间：2013-04-20T18:21:52.063
> 
> 标签：java, swing, jtable

我正在开发我的第一个 java 程序。我正在制作一个项目经理程序。

基本想法是我有一个`JList`包含同事姓名的名称。如果您双击其中一个名称，`JTabbedPane`将弹出一个新选项卡，并将填充`JTable`包含特定人员任务的内容。

棘手的部分来了。我想用它`JTable`来修改数据，所以我需要给它一个特定的名称，`JTable`这样我以后可以在我的方法中使用它来调用它。

问题是如何为这些表创建动态名称，以便稍后调用它（例如：table+tabID）。

或者

我的问题有更好的解决方案吗？

非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T21:56:09.013

我解决了。解决方案是：

我做了一个`ArrayList<JTables>`来存储表格，我正在使用选项卡索引来获取正确的表格。

# css - CSS：即使配置为显示背景图像也不显示在打印预览中

> ID：16123686
> 
> 赞同：0
> 
> 时间：2013-04-20T18:21:52.917
> 
> 标签：css, printing, background-image, print-preview

在 Chrome 和 Firefox 的打印预览中，我切换了“显示背景颜色和图像”，我可以看到简单的彩色背景打开和关闭，但有一个根本不显示的背景图像。当页面在浏览器中正常呈现时，它显示正常。为什么不出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:14:39.597

如果页面具有将背景图像设置为无的打印媒体特定样式表，则浏览器将不会打印出图像。

# javascript - application.js 很大——把它分开？

> ID：16123690
> 
> 赞同：0
> 
> 时间：2013-04-20T18:22:05.663
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, asset-pipeline

我的 application.js 文件具有以下内容：

```
//= require jquery
//= require jquery_ujs
//= require jquery.ui.all
//= require bootstrap
//= require_tree . 
```

它在我的 javascript 文件夹树中包含另外 18 个 js 文件。该文件变得非常大。

我使用多个 cloudfront 实例来提供我的其他资产（即图像），并注意到 application.js 可能需要一秒钟才能加载（即使在被 gzip 压缩后）。

我如何将 application.js （和 application.css ）分成 4-5 个块，以便它可以更快地加载？这是可能的，甚至是正确的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T21:03:04.423

没有什么不同的。如果你把它们分开，那么你仍然需要加载完全相同数量的 JS。

相反，可能会查看仅在特定页面上需要的脚本并将其提取出来并仅在相关页面上加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:58:38.913

您可以删除所有 jquery 内容并单独加载它们。权衡是两个 HTTP 请求（或更多），而不是应用程序的单个请求，但它可能是值得的。

或者您可以从谷歌的 CDN 加载 jquery，如果用户已经缓存了该缓存，则可以节省更多时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T23:19:11.673

通常编写 JavaScript 是为了与页面上的特定元素进行交互。如果是这样，浏览器将评估每个页面上的 JavaScript，但只有在存在适当的页面元素时才会激活它。该页面所需的 JavaScript 可以是站点范围的 application.js 脚本的一部分，也可以通过视图模板或应用程序布局中的 javascript_include_tag 语句包含在页面中。

JavaScript 执行可以通过以下方式确定

*   页面上存在独特元素或
*   HTML body 标签中的属性。

更有条理的方法是测试 HTML body 标签中的属性：

*   在页面的 body 元素上设置 class 或 id 属性。
*   在 JavaScript 中使用解析这些类或 id 并调用适当函数的函数。

首先，您必须修改应用程序布局。替换**app/views/layouts/application.html.erb**文件`<body>`中的语句：

 **```
<body class="<%= params[:controller] %>"> 
```

假设页面由 Projects 控制器生成，呈现的页面将包括：

```
<body class="projects"> 
```

在您的 JavaScript 代码中使用此条件：

```
$('document').ready(function() {
  if ($('body.projects').length) {
    console.log("Page generated by the projects controller.");
  }
}); 
```

（...来自[RailsAppsProject，“Unholy Rails：向 Rails 添加 Javascript”](http://railsapps.github.io/rails-javascript-include-external.html#specific)。阅读！**

# c# - 在运行时继续绘制表格

> ID：16123691
> 
> 赞同：0
> 
> 时间：2013-04-20T18:22:16.087
> 
> 标签：c#, .net

我正在制作一个从 C# .NET 中的 URL 绘制图像的应用程序。问题是，在加载此元素时，它会冻结应用程序并且不会绘制表单的其余部分。有没有办法防止这种情况发生？

我想说的是有一种方法可以在执行此操作的同时继续运行程序的其余部分，就像其他语言中的协同程序一样。

```
 WebRequest aReq = WebRequest.Create(avatarURL);
        WebResponse aRes = aReq.GetResponse();

        Image img = Image.FromStream(aRes.GetResponseStream());

        e.Graphics.DrawImage(img, 10, 10, 55, 55); 
```

我尝试使用线程，但我无法让它工作我的代码现在看起来像这样：

```
 Thread drawavatar = new Thread(new ThreadStart(() => drawAvatarDetails(e)));
        while (a_img != null)
        {
            e.Graphics.DrawImage(a_img, 10, 10, 55, 55);
        } 
```

在 drawAvatarDetaails 中，我将全局 a_img 分配给化身的图像

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:29:17.920

简单地使用一个`BackGroundWorker`. 并在`DoWork`事件中执行此操作。当然，我建议将图像保存在全局变量中，并在 Form 的 Paint（或控制绘制）事件中绘制它。

```
 BackgroundWorker bw;
    Image img;
    private void Form1_Load(object sender, EventArgs e)
    {
        bw = new BackgroundWorker();
        bw.DoWork += new DoWorkEventHandler(bw_DoWork);
        bw.RunWorkerAsync();
        this.Paint += new PaintEventHandler(Form1_Paint);
    }

    void Form1_Paint(object sender, PaintEventArgs e)
    {
        if (img != null)
        {
            e.Graphics.DrawImage(img, 10, 10, 55, 55);
        }
    }

    void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        WebRequest aReq = WebRequest.Create(avatarURL);
        WebResponse aRes = aReq.GetResponse();
        img = Image.FromStream(aRes.GetResponseStream());
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:56:28.930

如果您在主 UI 线程之外访问用户控件，则会出现`cross thread operation not valid`异常。因此，如果您使用的是 .Net 4.5，我建议您使用[async/await](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)

```
async void Draw(string avatarURL)
{
    HttpClient client = new HttpClient();
    Image img = Image.FromStream(await client.GetStreamAsync(avatarURL));

    // Your drawing code
    // for ex, this.BackgroundImage = img;

} 
```

# algorithm - 关注深度优先搜索

> ID：16123692
> 
> 赞同：0
> 
> 时间：2013-04-20T18:22:17.127
> 
> 标签：algorithm, graph, depth-first-search, breadth-first-search

证明如果 G 是一个无向连通图，那么它的每条边要么在深度优先搜索树中，要么是后边。

现在，从直觉和 Steven Skiena 的课堂讲授中，我知道上面的说法是正确的，因为它一直向下俯冲，然后将绳子扔回之前的顶点。我也知道 DFS 非常适合寻找周期。

但是，我的问题是我不知道如何“证明”边缘是树边缘或后边缘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:03:03.243

考虑可能的 4 种情况（理论上）。边缘可以是：

1.  树的边缘
2.  后缘
3.  树边缘和后边缘
4.  既不是树边缘也不是后边缘

为了证明需要什么，您需要证明情况 3 和 4 不可能发生，即导致矛盾。

# javascript - 使用特定时区的 Javascript 时钟

> ID：16123694
> 
> 赞同：1
> 
> 时间：2013-04-20T18:22:30.837
> 
> 标签：javascript, time, clock, zone

我有以下 javascript 函数可以正常工作，但是无论查看者的时区是什么，它都应该只显示 CST (GMT-5) 中的时间。我该如何修改它来做到这一点？

```
function updateClock () {
    var currentTime = new Date();
    var currentHours = currentTime.getHours();
    var currentMinutes = currentTime.getMinutes();
    var currentSeconds = currentTime.getSeconds();

    currentMinutes = (currentMinutes < 10 ? "0" : "") + currentMinutes;
    currentSeconds = (currentSeconds < 10 ? "0" : "") + currentSeconds;

    var timeOfDay = (currentHours < 12) ? "AM" : "PM";
    currentHours = (currentHours > 12) ? currentHours-12 : currentHours;
    currentHours = (currentHours == 0) ? 12 : currentHours;

    var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;

    document.getElementById("clock").firstChild.nodeValue = currentTimeString;
} 
```

# ios - 操作错误：应用程序中的@selector

> ID：16123696
> 
> 赞同：0
> 
> 时间：2013-04-20T18:22:49.660
> 
> 标签：ios, uiactionsheet

我正在创建一个应用程序，用户应该能够报告帖子。当用户按下报告按钮时，我想要一个操作表。这是我的代码：

```
[self.avatarImageView.profileButton addTarget:self action:@selector(didTapReportButtonAction:) forControlEvents:UIControlEventTouchUpInside]; 
```

这是 didTapReportButtonAction 代码：

```
- (void)didTapReportButtonAction:(UIButton *)button {
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Title" delegate:nil cancelButtonTitle:@"Cancel" destructiveButtonTitle:@"Destructive" otherButtonTitles:@"Other1", @"Other2", nil];
    actionSheet.actionSheetStyle = UIActionSheetStyleBlackTranslucent;
    [actionSheet addButtonWithTitle:@"Add"];
    [actionSheet showInView:[UIApplication sharedApplication].keyWindow];
} 
```

但是当我现在尝试按下报告按钮时，什么也没有发生。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:34:37.140

你可以试试这个：

```
[actionSheet showInView:self.view]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:30:24.597

如果 avatarImageView 是 UIImageView，则其 userinteraction 属性默认为 false。这意味着该事件不会被调用。

确保`avatarImageView.userInteraction = YES`

# oauth - Facebook Canvas 应用登录 URL 看起来不像其他登录

> ID：16123697
> 
> 赞同：2
> 
> 时间：2013-04-20T18:22:52.187
> 
> 标签：oauth, facebook-login, facebook-oauth

所以这是一个画布应用程序，旨在在 FB chrome 中运行。

我正在使用 FB php SDK。

我正在通过以下方式创建我的登录网址：

```
$loginUrl = $facebook->getLoginUrl( array('scope'=>'email,publish_actions', 'redirect_uri'=>$fbCanvas)); 
```

然后使用此脚本重定向：

```
print "<script> top.location.href='" . $loginUrl . "'</script>"; 
```

而不是看到“常规” fb 应用程序身份验证对话框，例如：

[我想看的](https://dl.dropboxusercontent.com/u/30126/DesiredAuth.png)

我得到一个像这样的对话框：

[我所看到的](https://dl.dropboxusercontent.com/u/30126/GettingAuth.png)

任何想法我做错了什么？

如果新用户单击“确定”按钮，他们就会登录到应用程序，正确重定向并且一切正常，我只是希望它看起来像/像其他所有应用程序一样工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T12:18:56.903

Facebook 正在重新设计登录对话框（再次），请参阅[https://developers.facebook.com/docs/concepts/login/permissions-login-dialog/#login-dialog](https://developers.facebook.com/docs/concepts/login/permissions-login-dialog/#login-dialog)

与 Facebook 一样，此次推出不会同时影响所有用户或所有应用程序，而是逐步推出。所以有一段时间用户可能会看到两个版本的登录对话框，但最终所有应用程序都将使用新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T11:24:43.373

你没有做错什么。
我怀疑 Facebook 已经根据应用程序可用的数据改变了它显示授权/权限窗口的方式。如果您的应用程序缺少“App Detail”、“Image”、“Privacy Policy Link”等，那么您将获得授权窗口，如 What [major apps show](https://dl.dropboxusercontent.com/u/30126/DesiredAuth.png) else you would get the window you [get right now](https://dl.dropboxusercontent.com/u/30126/GettingAuth.png)。
早些时候没有这样的区别，但自本月以来，它可能已经改变，因为我之前曾经获得完整的成熟授权窗口，但现在没有。

# javascript - 验证输入日期的 Javascript

> ID：16123699
> 
> 赞同：2
> 
> 时间：2013-04-20T18:23:16.803
> 
> 标签：javascript, jquery, html

我是`Javascript`编程新手，我正在尝试验证`<input>`从外部`Javascript`文件获取的日历片段中输入的日期。我正在尝试验证日期以检查用户是否输入了过去的日期。如果输入的日期是过去的日期，那么我需要打印一条警告消息以输入未来期间的有效日期。

我接受以下`HTML`代码中的输入日期字段：

```
<input size="12" id="inputField" name="inputField"  autofocus="" type="date"     oninput="return dateValidate(inputField)"/> 
```

我验证输入日期的 Javascript 函数是：

```
<script type="text/javascript">
function dateValidate(inputField)
{

 var v2 = document.getElementById('inputField');
 var pickeddate = new Date(v2.Value);
 todayDate = new Date();
 if(pickeddate > todayDate){
    return true;
 } else {
    alert("Enter a valid Date");
 }
} 
```

但是这段代码似乎不起作用。`<input>`当我在字段中输入过去的日期并跳出时，我希望运行这个 Javascript 函数。我想在字段中输入日期时验证日期，而不是在提交表单时验证日期。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:48:32.757

它不起作用，因为您的代码中存在问题，只需替换它：

```
var pickeddate = new Date(v2.Value); 
```

有了这个：

```
var pickeddate = new Date(v2.value);   // 'value' should be in lower case 
```

因为，它不正确，所以`pickeddate`总是`undefined`和代码不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T19:04:33.947

你可以试试这个

**HTML**

```
<input size="12" id="inputField" name="inputField"  autofocus="" type="date"     onblur="return dateValidate(this)"/> 
```

**JS**

```
function dateValidate(inputField)
{
    var pickeddate =  new Date(inputField.value);
    var todayDate =  new Date();
    if( pickeddate > todayDate )
    {
       return true;
    }
    else
    {
        alert("Enter a valid Date");
    } 
} 
```

[**演示。**](http://jsfiddle.net/w5yEL/1/)

# java - 带有 BasicGameState 的 Slick2D 中的文本字段不回答

> ID：16123701
> 
> 赞同：1
> 
> 时间：2013-04-20T18:23:31.073
> 
> 标签：java, textfield, lwjgl, slick2d

我目前正在用 Java 中的 Slick2D 开发一个简单的多人游戏。菜单结构会稍微复杂一些，因为我需要几个文本字段来获取连接哪个服务器地址、允许玩多少玩家、昵称等信息。

我在 3 个类中重现了我的问题：主类 ( )`ExampleGame`从`StateBasedGame`和从扩展。`Play``Menu``BasicGameState`

这些类每个都有一个文本字段和一个按钮`Play`。`Menu`我的问题是我只能在文本字段中输入这些类之一。单击文本字段时，另一个文本字段不显示任何光标响应。

这是主类 ExampleGame：

```
public class ExampleGame extends StateBasedGame  {

public static final int MAIN_MENU_STATE = 0;
public static final int GAME_PLAY_STATE = 1;

public ExampleGame(String name) {
    super(name);

    this.addState(new Menu(MAIN_MENU_STATE));
this.addState(new Play(GAME_PLAY_STATE));

this.enterState(MAIN_MENU_STATE);
}

/**
 * @param args
 */
public static void main(String[] args) {
     AppGameContainer appgc;
 try{
    appgc = new AppGameContainer(new ExampleGame("ExampleGame"));
    appgc.setDisplayMode(640, 360, false);
    appgc.setTargetFrameRate(50);
    appgc.start();
 }catch(SlickException e){
    e.printStackTrace();
 }
}

@Override
public void initStatesList(GameContainer arg0) throws SlickException {
    // TODO Auto-generated method stub
    this.getState(GAME_PLAY_STATE);
    this.getState(MAIN_MENU_STATE);

System.out.println(this.getStateCount() + ", " + this.getCurrentStateID());
this.enterState(MAIN_MENU_STATE);
} 
```

}

ExampleGame 自动调用 MainMenu (Menu.java)：

```
public class Menu extends BasicGameState {

private int stateID;
private Image background;
private UnicodeFont font;
private TextField textfield;
private Image createGameOption;
private int menuX = 50;
private int menuY = 250;

public Menu(int stateID) {
    this.stateID = stateID;
}

@Override
public void init(GameContainer arg0, StateBasedGame arg1) throws SlickException {

    System.out.println("StateID: " + arg1.getState(this.getID()) + " , State: " + arg1.getCurrentState());

    background = new Image("images/background_1024x640_v1.jpg");
    createGameOption = new Image("images/btn_CreateGame_for_1024x640_v1.png");

    textfield = new TextField(arg0, arg0.getDefaultFont(), 100, 100, 200, 30);
}

@Override
public void render(GameContainer arg0, StateBasedGame arg1, Graphics arg2) throws SlickException {
    // TODO Auto-generated method stub
    background.draw(0, 0);
    createGameOption.draw(menuX, menuY);
    textfield.render(arg0, arg2);

}

@Override
public void update(GameContainer arg0, StateBasedGame arg1, int arg2) throws SlickException {

    Input input = arg0.getInput();

    int mouseX = input.getMouseX();
    int mouseY = input.getMouseY();

    // if mouse is over a button
    if ((mouseX >= menuX && mouseX <= menuX + createGameOption.getWidth()) && (mouseY >= menuY && mouseY <= menuY + createGameOption.getHeight())) {

        if (input.isMouseButtonDown(Input.MOUSE_LEFT_BUTTON)) {
            // fx.play();
            arg1.enterState(ExampleGame.GAME_PLAY_STATE);
        }

    }

}

@Override
public int getID() {
    // TODO Auto-generated method stub
    return stateID;
} 
```

}

在这里，我可以在文本字段中书写。到目前为止，一切都很好。通过单击按钮，我调用了下一页（Play.java）：

```
public class Play extends BasicGameState {

private int stateID;
private Image background;
private UnicodeFont font;
private TextField textfield;
private Image createGameOption;
private int menuX = 350;
private int menuY = 250;

public Play (int stateID) {
    this.stateID = stateID;
}

@Override
public void init(GameContainer arg0, StateBasedGame arg1) throws SlickException {

    System.out.println("StateID: " + arg1.getCurrentStateID() + " , State: " + arg1.getCurrentState());
    arg1.inputStarted();

    background = new Image("images/background_1024x640_v1.jpg");
    createGameOption = new Image("images/btn_CreateGame_for_1024x640_v1.png");

    textfield = new TextField(arg0, arg0.getDefaultFont(), 150, 100, 200, 30);
}

@Override
public void render(GameContainer arg0, StateBasedGame arg1, Graphics arg2) throws SlickException {
    // TODO Auto-generated method stub
    background.draw(0,0);
    createGameOption.draw(menuX, menuY);
    textfield.render(arg0, arg2);
}

@Override
public void update(GameContainer arg0, StateBasedGame arg1, int arg2) throws SlickException {

    Input input = arg0.getInput();

    int mouseX = input.getMouseX();
    int mouseY = input.getMouseY();

    if ((mouseX >= menuX && mouseX <= menuX + createGameOption.getWidth()) 
            && (mouseY >= menuY && mouseY <= menuY + createGameOption.getHeight())) {

        if (input.isMouseButtonDown(Input.MOUSE_LEFT_BUTTON)) {
            arg1.enterState(ExampleGame.MAIN_MENU_STATE);
        }
    }
}

@Override
public int getID() {
    // TODO Auto-generated method stub
    return stateID;
} 
```

}

该类`Play`具有几乎相同的代码，`Menu`但似乎文本字段`Play`不响应鼠标和键。它似乎处于非活动状态，因为您看不到任何更改。但事实并非如此。如果我在文本字段中单击，输入一些内容并通过单击按钮返回菜单，您可以看到您输入的文本。似乎两个文本字段（来自 Menu 和 from 的那个`Play`）都以某种方式连接到。但我不知道问题出在哪里。

有没有人建议我如何解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T02:56:12.770

[光滑的文本字段不起作用](https://stackoverflow.com/questions/21530022/slick-textfield-not-working/21743633#21743633)

这是我不久前回答的您正在寻找的确切答案。该用户遇到了与您相同的问题，并通过按照我的 wiki 链接通过如何使用 StateBasedGame 的示例解决了该问题

# c - 在函数调用之间保留文件指针

> ID：16123702
> 
> 赞同：3
> 
> 时间：2013-04-20T18:23:39.447
> 
> 标签：c, file-io, binaryfiles

我有一个代码，我在其中多次访问二进制文件。每次我调用该函数时，它都会打开文件进行读取，并且只读取所需的字节数（`n`每次都说字节数）。

二进制文件包含时间序列数据，我希望它能够通过循环运行函数调用，每次我调用函数打开同一个文件时，它都需要读出下一个块数据，*即，*我不希望每次都重置文件指针。有没有办法做到这一点？

该函数如下所示：

```
int readBinary(float *binImage, int gelements) {
    imageFile = fopen("tmpImageFile", "r");
    if (imageFile == NULL) {
       fprintf(stderr, "Error opening file\n");
       return (1);
    }
    fread(binImage, sizeof(float), gelements, imageFile);
    return 0;
} 
```

在我的主代码中，我想通过一个循环运行它，每次都给它一个`binImage`大小数组。如果可以避免的话，`gelements`我宁愿不给它一个大小数组。`gelements * nLoop`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T18:29:11.373

使用静态变量，以便保留文件指针：

```
int readBinary(float *binImage, int gelements) {
    static FILE *imageFile = NULL;
    if (imageFile == NULL) {
       imageFile = fopen("tmpImageFile", "r");
       if (imageFile == NULL) {
          perror("Error opening file: ");
          return (1);
       }
    }
    fread(binImage, sizeof(float), gelements, imageFile);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-20T19:07:02.127

快速的经验法则是

“*如果你适当地划分职能之间的责任，生活会变得更轻松*”

和

“*如果使用静态或全局变量，生活会变得复杂*”。

在这种情况下，让`readBinary`函数既负责管理数据又负责`FILE`读取数据就太过分了。

**请注意，该函数不会关闭句柄。**

如果句柄是函数中的局部静态，则无法关闭它。这也意味着该函数将永远被锁定为仅使用“tmpImageFile”（从函数的签名或缺少的文档中无法立即看出这一点）

如果句柄是全局的，则可能会过早关闭它。

请注意，如果您删除“打开文件”职责，则该`readBinary`函数只是对`fread`.

处理此问题的最佳方法是完全跳过该`readBinary`功能。

你说你有一个循环读取数据的调用者。让这个调用者负责打开`FILE`，`fread`直接在循环中使用并在完成后关闭文件。

现在，这可能会给*调用者*过多的责任。只需让调用者接受`FILE*`作为参数并将文件管理责任交给调用者即可。或者调用者的调用者的调用者，这取决于管理文件生命周期的意义所在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-20T18:38:51.350

我会将`FILE*`as 参数传递给函数：

```
int readBinary(float *binImage, int gelements, FILE *imageFile) {
    int bytes = fread(binImage, sizeof(float), gelements, imageFile);
    return bytes != -1 ? 0 : 1;
} 
```

我还添加了简单的`fread`返回值检查并将其转换为您的返回值约定。虽然这个函数看起来很简单，但你可以直接调用`fread`，除非你想添加错误打印之类的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T18:28:49.513

您可以将文件指针设为静态并将其初始化为 NULL。然后下一次如果它不是NULL，那么它包含打开的文件。此外，在关闭文件时，请确保再次将其设为 NULL。全局指针也可以这样做

```
int readBinary(float *binImage, int gelements) {
static imageFile = NULL;
if(imageFile == NULL ) imageFile = fopen("tmpImageFile", "r");
if (imageFile == NULL) {
   fprintf(stderr, "Error opening file\n");
   return (1);
}
fread(binImage, sizeof(float), gelements, imageFile);
return 0;
} 
```

# angularjs - 使用选项组时，如何使用 Angular UI 正确初始化 Select2 标记？

> ID：16123704
> 
> 赞同：8
> 
> 时间：2013-04-20T18:23:47.307
> 
> 标签：angularjs, jquery-select2, angular-ui

我一直在尝试让我的 angular ui select2 指令初始化，但无法让它与选项组一起使用。

**编码：**

```
function testCtrl1($scope)
{
    $scope.selectedOptions = ['1'];
    $scope.categories = [
            {label: 'cat1', options: [{desc: 'one', value: 1}]}, 
            {label: 'cat2', options: [{desc: 'two', value: 2}]}
    ];
} 
```

**的HTML：**

```
<select multiple ui-select2 ng-model="selectedOptions" style="width: 300px">
    <optgroup ng-repeat="category in categories" label="{{category.label}}">
      <option ng-repeat="option in category.options" value="{{option.value}}">{{option.desc}} - {{option.value}}</option>
    </optgroup>
</select> 
```

**小提琴：** 我创建了以下[jsfiddle](http://jsfiddle.net/tadchristiansen/QRRYf/)。

这样做时，我注意到如果我包含第二个不包含选项组的 select2 指令（奇怪），它将正确初始化。在包含第二个 select2 时，我注意到其他一些奇怪的行为，但我不太关心它，因为我的目标只是让 testCtrl1 工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-14T09:59:15.683

下载最新的 angular-ui select2 并更新第 24 行：

```
repeatOption = tElm.find( 'optgroup[ng-repeat], optgroup[data-ng-repeat], option[ng-repeat], option[data-ng-repeat]' ); 
```

现在它支持选项组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-15T12:15:29.733

好吧，我遇到了同样的障碍，想分享我的解决方案。Select2 没有观察 optgroup ng-repeat 属性。您必须将此添加到您的 angular ui select2 指令中。

改变这个：

```
repeatOption = tElm.find('option[ng-repeat], option[data-ng-repeat]'); 
```

对此：

```
repeatOption = tElm.find('optgroup[ng-repeat], optgroup[data-ng-repeat], option[ng-repeat], option[data-ng-repeat]'); 
```

不确定这是否是一个干净的解决方案，但它对我有用。

[Github问题](https://github.com/angular-ui/ui-select2/issues/57)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T19:21:46.670

`select2`支持`<optgroup>`通过分层数据，您可以将结构化对象作为数据传递而不是使用`ng-repeat`，请参阅
[http://ivaynberg.github.io/select2/#data_array](http://ivaynberg.github.io/select2/#data_array)
也可以在页面中搜索“Example Hierarchical Data”。

JS：

```
$scope.model = {
    data: [
        // both 'id' and 'text' are needed unless you write custom functions
        { text: 'cat1', children: [{id: 1, text: 'one'}] },
        { text: 'cat2', children: [{id: 2, text: 'two'}] }
    ]
]; 
```

HTML：

```
<input type="hidden" multiple ui-select2="model" 
    ng-model="selectedOptions" style="width: 300px"> 
```

`selectedOptions`将是一个**对象**数组：`[ {id: 1, text: 'one'} ]`。

有关通过指令的传递，请参阅 Angular UI 的演示：
[http ://plnkr.co/edit/gist:4279651?p=preview](http://plnkr.co/edit/gist:4279651?p=preview)

编辑：更新代码和对站点的引用

# c# - 鼠标向上事件不会被触发

> ID：16123709
> 
> 赞同：0
> 
> 时间：2013-04-20T18:24:20.963
> 
> 标签：c#, panel, mouseup

我有以下问题：我有一个具有特定颜色的面板，比如红色。当用户按下鼠标时，这个面板的颜色被存储在一个变量中。然后用户移动，他的鼠标仍然按下，移到另一个面板。当他在那里释放鼠标时，该面板应该获得已存储在变量中的第一个背景颜色。我的代码看起来像这样：

```
 public Color currentColor;
    private void ColorPickMouseDown(object sender, MouseEventArgs e)
    {
        Panel pnlSender = (Panel)sender;                   
        currentColor = pnlSender.BackColor;
    }

    private void AttempsColorChanger(object sender, MouseEventArgs e)
    {
        Panel pnl = (Panel)sender;
        pnl.BackColor = currentColor;
    } 
```

我需要首先确定发送者，因为有很多可能的面板可以触发此事件。第一个 MouseDown 方法工作得很好，颜色很好地存储在变量中。然而，当用户执行我上面描述的操作时，第二个甚至不会被触发。当服务器单击第二个面板时，它可以工作（我猜在单击中也有一个 MouseUp 部分）。

这里有什么问题？为什么之前用户按住鼠标键没有触发事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:45:12.647

（此答案假设您使用的是 Windows 窗体。）

可能是您需要通过`this.Capture = true`在源代码管理的 MouseDown 中设置来捕获鼠标。（[见`Control.Capture`](http://msdn.microsoft.com/en-gb/library/system.windows.forms.control.capture.aspx)）

如果你这样做了，*源*窗口会得到`MouseUp`事件，*源*窗口必须在鼠标坐标下确定目标窗口。您可以使用`Control.GetChildAtPoint()`（参见Stack Overflow 上的[这个答案）来做到这一点。](https://stackoverflow.com/questions/2411062/how-to-get-control-under-mouse-cursor)

**[改用 Windows 窗体拖放支持！](http://msdn.microsoft.com/en-us/library/aa984430%28v=vs.71%29.aspx)**<- 点击了解更多

我将建议您硬着头皮使用 .Net 拖放方法来执行此操作。它需要一些阅读，但使用它会*更好*。

`MouseDown`您可以通过调用来开始拖动以响应事件[`Control.DoDragDrop()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dodragdrop.aspx)。

然后您需要处理[`Control.DragDrop`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dragdrop.aspx)放置目标控件中的事件。

您可能还需要做一些其他事情来设置它；[`Control.DoDragDrop()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dodragdrop.aspx)有关示例，请参阅文档。

（[有关 WPF 拖放支持，请参见此处。](http://msdn.microsoft.com/en-us/library/hh144799.aspx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T19:47:49.520

当您的鼠标进入目标控件时，鼠标按下触发并获取目标背景颜色！您需要在代码中添加一个布尔标志：

```
 public Color currentColor;       
 bool flag=false;
    private void ColorPickMouseDown(object sender, MouseEventArgs e)
    {
        if(flag==false)
        {
        flag=true
        Panel pnlSender = (Panel)sender;                   
        currentColor = pnlSender.BackColor;
       }
    }
    //assume mouse up for panles
    private void AttempsColorChanger(object sender, MouseEventArgs e)
    {
       if(flag==true)
       {  
        Panel pnl = (Panel)sender;
        pnl.BackColor = currentColor;
        flag=flase;
       }
    } 
```

而且您还需要在 mouseMove( if ) 中更改您的标志

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T21:12:52.663

正如我在评论中提到的鼠标事件由原始控件捕获，您最好使用`DragDrop`Windows 窗体中内置的功能。像这样的东西应该适合你。我分配了通用事件处理程序，因此它们可以分配给您的所有面板并正常工作。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void panel_MouseDown(object sender, MouseEventArgs e)
    {
       ((Control)sender).DoDragDrop(((Control)sender).BackColor,DragDropEffects.All);
    }

    private void panel_DragDrop(object sender, DragEventArgs e)
    {
        ((Control)sender).BackColor = (Color)e.Data.GetData(BackColor.GetType());
    }
    private void panel_DragEnter(object sender, DragEventArgs e)
    {
        e.Effect = DragDropEffects.Copy;
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-07T11:10:40.357

我知道这是一个老问题，但我遇到了同样的问题，以上答案都不适合我。在我的情况下，我必须处理目标控件中的 MouseMove 事件并检查鼠标是否被释放。我确实在我的目标面板上设置了“BringToFront”，以防万一有帮助。

```
public Color currentColor;
private void ColorPickMouseDown(object sender, MouseEventArgs e)
{
    Panel pnlSender = (Panel)sender;                   
    currentColor = pnlSender.BackColor;
}

private void panelTarget_MouseMove(object sender, MouseEventArgs e)
{
    //the mouse button is released
    if (SortMouseLocation == Point.Empty)
    {
        Panel pnl = (Panel)sender;
        pnl.BackColor = currentColor;
    }
} 
```

# javascript - 如何将图像添加到跨度子元素？

> ID：16123710
> 
> 赞同：0
> 
> 时间：2013-04-20T18:24:21.650
> 
> 标签：javascript, html, image, dom

我正在尝试添加图像并执行与下面的代码等效的操作，但不是创建文本节点，而是如何创建图像元素？

```
//create the DOM object

var newSpan = document.createElement('span');

// add the class to the 'span'

newSpan.setAttribute('class', 'ABC');
document.getElementById('text').appendChild(newSpan);   
var selectedTextNode = document.createTextNode(); 
newSpan.appendChild(selectedTextNode); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:29:01.757

```
<div id="text"></div>

//create the DOM object

var newSpan = document.createElement('span');

// add the class to the 'span'

newSpan.setAttribute('class', 'ABC');
document.getElementById('text').appendChild(newSpan);

var image = document.createElement("img");
image.src = "http://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Fairfax-harrison-1913.jpg/100px-Fairfax-harrison-1913.jpg"

newSpan.appendChild(image); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/qPMAb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:43:21.300

如果我要做很多*节点*创建，我通常会为它编写一个函数，这样我就不必重复自己了。

```
//                     String,  Object,  String
function createElement(tagName, attribs, text) {
    var elm = document.createElement(tagName), a;
    if (attribs) // if given
        for (a in attribs) // for each property
            if (attribs.hasOwnProperty(a)) // that is not inherited
                elm.setAttribute(a, attribs[a]); // set attribute
    if (text) // if given
        elm.appendChild(document.createTextNode(text)); // append text
    return elm; // node out
} 
```

现在容易多了；

```
// create the elements
var span = createElement('span', {'class': 'ABC'}),
    img = createElement('img', {'src': 'http://www.google.com/favicon.ico'});

span.appendChild(img); // put image in span
document.getElementById('text').appendChild(span); // append wherever 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:28:31.170

```
//create the DOM element
var newImg = document.createElement('img');

// add the class to the image
newImg.setAttribute('class', 'ABC');

// set the src URL
newImg.setAttribute('src', 'http://example.com/media/image.png');

// append to the container element
document.getElementById('text').appendChild(newImg); 
```

# php - 图像“[blah]”无法显示，因为它包含错误

> ID：16123715
> 
> 赞同：0
> 
> 时间：2013-04-20T18:24:54.110
> 
> 标签：php, html, server-side-scripting

```
 <?php
                ob_start();
                session_start();
                require_once('name.php');
                   if(!isset($_GET['e']))
                   {
                    header('HTTP/1.1 204 No Content');
                    exit();
                    }
                    if(empty($_SESSION['id']))
                    {
                    header('Location: login.php');
                        exit();
                    }
                    $id=$_GET['e'];

                    //database login information removed

                    $statement2=$db->prepare('select * from event2 where id=:id and userid=:uid');
                    $statement2->execute(array('id' => $id,
                               'uid' => $_SESSION['id']));
                    if($statement2->rowCount()==0)
                    {
                header('HTTP/1.1 204 No Content');
                exit();
                    }
                    $row=$statement2->fetch();
                    $image=$row['image'];
                    $realimage=imagecreatefromstring($image);

                header('Content-type: image/jpeg');
               $realimage;
                ob_end_flush();
                ?> 
```

我收到“无法显示图片‘图片链接’，因为它包含错误。” 我尝试将内容标题位置更改为各个位置，但无法使其正常工作。我直接从数据库中下载了图像，它确实可以正确复制。在 chrome 中打开页面时，我会看到一张小小的绿色图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:26:10.520

输出图像呢？

```
imagejpeg($realimage); 
```

你`imagejpeg`在`$realimage;`. （`imagejpeg`或其他适当的图像*功能用于输出。）

* * *

对了，你为什么不直接输出`$image`（via `echo`）而不是先将图像数据解析为图像呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:26:46.817

`<?php`开始标签前有空格。删除它们。

# python - python用逗号分割并忽略引号中的那个

> ID：16123719
> 
> 赞同：0
> 
> 时间：2013-04-20T18:25:03.077
> 
> 标签：python, split

目前，我想解析一个每行有 4 个项目并用逗号分隔的 csv 文件。例如：

`1, "2,3", 4, 5`

我怎样才能把它分成：

`[1,"2,3",4,5]`

我尝试使用`csv.reader`，但结果仍然是错误的方式。任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:41:07.043

`csv.reader`不会进行类型转换，但可能是这样的：

```
In [1]: import csv

In [2]: data = ['1, "2,3", 4, 5']

In [3]: next(csv.reader(data, skipinitialspace=True))
Out[3]: ['1', '2,3', '4', '5'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:25:14.450

```
"""
[xxx.csv]
1, "2,3", 4, 5
"""

import re
f = open("xxx.csv")
line = f.readline() # line = '1, "2,3", 4, 5'
startUnit = False # " is for start or end
token = ""
answer=[]
for i in line:
    if startUnit==False and re.match("[0-9]", i):
        answer.append(int(i))
    elif i=='"':
        if startUnit==True:
            answer.append(token)
        startUnit = not startUnit
    elif startUnit==True:
        token+=i
    elif startUnit==False:
        token=""

print answer 
```

这是一个简单的例子。它可能会产生其他异常，因为该代码仅适用于您的示例。(1, "2,3", 4, 5) 希望对你有帮助

# c# - 从列表中，返回每个原始列表属性的新列表？

> ID：16123720
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:25:07.337
> 
> 标签：c#, list, class

比如说，我的 Dog 班还有另一个班，Flea。

```
class Dog
{
   public Flea flea;
} 
```

现在，如果我有一个 Dogs 列表：`List<Dogs> manyDogs` 我怎样才能把这个列表变成一个`List<Flea> fleaInEachDogs`？

目前我会这样做：

```
List<Flea> fleaInEachDogs = new List<Flea>();
foreach(Dog d in manyDogs)
{
    fleaInEachDogs.Add(d.flea);
} 
```

`List`但我认为所有班级肯定都可以使用更方便的聚合方法。有没有存在？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T18:26:29.670

您可以使用 LINQ 的`Select`扩展使其更简洁，尽管没有什么比“pluck”方法更能按名称获取属性（因为这需要反射）：

```
var fleaInEachDogs = manyDogs.Select(dog => dog.flea); 
```

（使用`ToList()`它`IEnumerable`来获得与原始代码完全相同的列表。）

# html - 如何在 SVG 中“使用”本地“defs”

> ID：16123721
> 
> 赞同：36
> 
> 时间：2013-04-20T18:25:07.703
> 
> 标签：html, svg

我有多个 SVG 图片嵌入到单个 HTML 页面中。每个 SVG 都有自己的`defs`部分，我在我的`use`元素中引用了这些部分。看起来我无法在多个内部定义具有相同 id 的元素`defs`并引用它。第二个 SVG`use`将从第一个 SVG`defs`部分中选择定义，并忽略本地重新定义。

有人知道我如何参考 LOCAL`defs`部分吗？

Chrome 和 Firefox 也是如此。

1.  请参见下面的示例：

    ```
    <html><head></head><body>
    <svg height="50" width="50">
     <defs>
      <rect id="mybox" height="40" width="40" style="fill:#00F;"></rect>
     </defs> 
     <use xlink:href="#mybox"/>
    </svg>
    <svg height="50" width="50">
     <defs>
      <rect id="mybox" height="20" width="20" style="fill:#F00;"></rect>
     </defs> 
     <use xlink:href="#mybox"/>
    </svg>
    </body></html> 
    ```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-20T21:51:54.357

[根据http://www.w3.org/TR/SVG/struct.html#IDAttribute](http://www.w3.org/TR/SVG/struct.html#IDAttribute)，具有多个相同 ID 的 SVG 文件无效

您的选择是使所有 ID 唯一或将 SVG 移动到单独的文件中并通过`<object>`或`<iframe>`标记引用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-08T03:35:16.157

我创建了一个工具来随机化定义 id，以避免内联 svg 引用相同 #id 的问题，希望它对其他人有用。[http://hugozap.com/randomize_svg_def_ids.html](http://hugozap.com/randomize_svg_def_ids.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-28T03:05:59.900

解决这个问题的一种方法是使用[svgo](https://github.com/svg/svgo)

```
svgo --enable=prefixIds *.svg 
```

svgo 可以通过 npm 安装，也可以作为库使用

# javascript - jQuery 插件 TDD 起点

> ID：16123724
> 
> 赞同：4
> 
> 时间：2013-04-20T18:25:24.610
> 
> 标签：javascript, tdd, bdd, agile, mocha.js

我有一些现有的 Javascript 代码希望移植到 jQuery 插件。代码本身并不复杂：具有不同照片尺寸的 Flickr API 照片库，还有一些其他的东西。我快速编码它并且它足够稳定，但我想以“正确的方式”重做它。

我用 Grunt 和 Mocha 建立了一个基于 Yeoman 的简单 TDD 环境，它运行良好。我遇到的问题是我的插件将像大多数 jQuery 插件一样工作，具有一个简单的入口点：

`$( '#ele' ).myAwesomePlugin( { ... } ); // Do all the things`

我正在摸索从哪​​里开始编写测试。虽然我已经拥有完成插件的大部分代码，但我正在尝试通过测试驱动开发的动作，我不知道如何从这个高级点过渡到较小的部分的代码。

程序流程的一些阶段是：与 Flickr 通信、收集照片（或不收集照片）、将它们分成各种尺寸，并将它们排列到一个容器中。

插件本身（理想情况下）只有一种可公开访问的方法，但是，如果是这种情况，我的测试应该如何与我更深层次的逻辑挂钩？我是否应该将我的代码拆分成更小的、可测试的不是 jQuery 插件的块，然后将它们组合起来？我很好奇是否有一种方法可以让测试本身来推动这种发展。

任何有关阅读材料或文章的建议都会非常有帮助。我很高兴终于能做 TDD！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T17:04:11.300

这是使用 Jasmine 进行 jquery 插件的测试驱动开发的链接。

[使用 Jasmine 对 jQuery 插件进行 BDD 测试](http://blog.davidpadbury.com/2010/10/11/bdd-testing-of-jquery-plugins-using-jasmine/)

Jasmine 与 Mocha 类似，因此您可以按照教程使用 Jasmine 或 Mocha。

# ruby-on-rails - Activerecord 事务并发竞争条件问题

> ID：16123725
> 
> 赞同：3
> 
> 时间：2013-04-20T18:25:28.377
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord, transactions

我目前正在对我正在为 Android 制作的游戏进行现场测试。这些服务是用 rails 3.1 编写的，我使用的是 Postgresql。我的一些更精通技术的测试人员已经能够通过记录他们对服务器的请求并以高并发重放它们来操纵游戏。我将尝试简要描述下面的场景，而不会陷入代码中。

*   一个用户可以购买多个项目，每个项目在数据库中都有自己的记录。
*   该请求转到一个控制器操作，该操作创建一个购买模型来记录有关交易的信息。
*   贸易模型有一个方法来设置物品的购买。它基本上会执行一些合乎逻辑的步骤来查看他们是否可以购买该物品。最重要的是，他们在任何给定时间每个用户都限制为 100 个项目。如果所有条件都通过，则使用一个简单的循环来创建他们请求的项目数。

因此，他们正在做的是，通过代理记录 1 个有效的购买请求。然后以高并发重播它，这实际上是每次都允许一些额外的东西通过。因此，如果他们将其设置为购买 100 个数量，他们可以将其增加到 300-400 个，或者如果他们购买 15 个数量，他们可以将其增加到 120 个。

上面的购买方式被包裹在一个事务中。但是，即使它被包装了，它也不会在请求几乎同时执行的某些情况下停止它。我猜这可能需要一些数据库锁定。另一个需要知道的转折是，在任何给定时间，rake 任务都在针对用户表的 cron 作业中运行，以更新玩家的健康和能量属性。所以，这也不能被阻止。

任何帮助都会非常棒。这是我的小爱好项目，我想确保游戏对每个人来说都是公平和有趣的。

非常感谢！

控制器动作：

```
 def hire
    worker_asset_type_id = (params[:worker_asset_type_id])
    quantity = (params[:quantity])

    trade = Trade.new()

    trade_response = trade.buy_worker_asset(current_user, worker_asset_type_id, quantity)

    user = User.find(current_user.id, select: 'money')

    respond_to do |format|
      format.json {
        render json: {
            trade: trade,
            user: user,
            messages: {
                messages: [trade_response.to_s]
            }
        }
      }
    end
  end 
```

交易模型方法：

```
def buy_worker_asset(user, worker_asset_type_id, quantity)
    ActiveRecord::Base.transaction do

      if worker_asset_type_id.nil?
        raise ArgumentError.new("You did not specify the type of worker asset.")
      end

      if quantity.nil?
        raise ArgumentError.new("You did not specify the amount of worker assets you want to buy.")
      end

      if quantity <= 0
        raise ArgumentError.new("Please enter a quantity above 0.")
      end

      quantity = quantity.to_i
      worker_asset_type = WorkerAssetType.where(id: worker_asset_type_id).first

      if worker_asset_type.nil?
        raise ArgumentError.new("There is no worker asset of that type.")
      end

      trade_cost = worker_asset_type.min_cost * quantity

      if (user.money < trade_cost)
        raise ArgumentError.new("You don't have enough money to make that purchase.")
      end

      # Get the users first geo asset, this will eventually have to be dynamic
      potential_total = WorkerAsset.where(user_id: user.id).length + quantity

      # Catch all for most people
      if potential_total > 100
        raise ArgumentError.new("You cannot have more than 100 dealers at the current time.")
      end

      quantity.times do
        new_worker_asset = WorkerAsset.new()
        new_worker_asset.worker_asset_type_id = worker_asset_type_id
        new_worker_asset.geo_asset_id = user.geo_assets.first.id
        new_worker_asset.user_id = user.id
        new_worker_asset.clocked_in = DateTime.now

        new_worker_asset.save!
      end

      self.buyer_id = user.id
      self.money = trade_cost
      self.worker_asset_type_id = worker_asset_type_id
      self.trade_type_id = TradeType.where(name: "market").first.id
      self.quantity = quantity

      # save trade
      self.save!

      # is this safe?
      user.money = user.money - trade_cost

      user.save!
    end
  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-21T05:50:09.257

听起来您需要幂等请求，以便请求重放无效。在可能的情况下实施操作，以便重复它们没有效果。在不可能的情况下，给每个请求一个唯一的请求标识符并记录请求是否得到满足。您可以将请求 ID 信息保存`UNLOGGED`在 PostgreSQL 或 redis/memcached 的表中，因为您不需要它是持久的。这将防止一整类漏洞利用。

为了解决这个问题`AFTER INSERT OR DELETE ... FOR EACH ROW EXECUTE PROCEDURE`，在用户项目表上创建一个触发器。有这个触发器：

```
BEGIN
    -- Lock the user so only one tx can be inserting/deleting items for this user
    -- at the same time
    SELECT 1 FROM user WHERE user_id = <the-user-id> FOR UPDATE;

    IF TG_OP = 'INSERT' THEN
        IF (SELECT count(user_item_id) FROM user_item WHERE user_item.user_id = <the-user-id>) > 100 THEN
            RAISE EXCEPTION 'Too many items already owned, adding this item would exceed the limit of 100 items';
        END IF;
    ELIF TG_OP = 'DELETE' THEN
       -- No action required, all we needed to do is take the lock
       -- so a concurrent INSERT won't run until this tx finishes
    ELSE 
        RAISE EXCEPTION 'Unhandled trigger case %',TG_OP;
    END IF;
    RETURN NULL;
END; 
```

或者，您可以在 Rails 应用程序中实现相同的功能，方法是在添加或删除任何项目所有权记录之前对客户 ID 进行行级锁定。我更喜欢在触发器中做这种事情，你不能忘记在某个地方应用它，但我知道你可能更喜欢在应用程序级别做。请参阅[悲观锁定](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html)。

乐观锁定不太适合此应用程序。您可以通过在添加/删除项目之前增加用户的锁定计数器来使用它，但它会导致用户表上的行流失，并且当您的事务无论如何都很短时确实没有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:49:33.053

除非您向我们展示您的相关架构和查询，否则我们无能为力。我想你会做类似的事情：

```
$ start transaction;
$ select amount from itemtable where userid=? and itemid=?;
15
$ update itemtable set amount=14 where userid=? and itemid=?;
commit; 
```

您应该执行以下操作：

```
$ start transaction;
$ update itemtable set amount=amount-1 returning amount where userid=? and itemid=?;
14
$ commit; 
```

# html - 将文本框输入保存到 HTML 中的 XML 或 txt 文件

> ID：16123727
> 
> 赞同：0
> 
> 时间：2013-04-20T18:25:36.507
> 
> 标签：html, input, textbox, save

我正在开发一个 HTML 页面项目，其中有 2 个文本框，基本上我想保存用户放入文本框中的输入数据。我们在我的 C# 类中所做的是将所有输入保存到 XML 文件中，所以我假设有类似的方法？到 XML 或其他可以存储文本的文件？

有谁知道解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T11:36:10.597

我推荐以下 php 脚本

```
 <?php
// check that form was submitted
//   (you'll need to change these indices to match your form field names)
if( !empty( $_POST['firstname'] ) && !empty( $_POST['lastname'] ) ){
    // remove html tags from submission
    //   (since you don't want them)
    $firstname = strip_tags( $_POST['firstname'] );
    $lastname = strip_tags( $_POST['lastname'] );
    // create the date
    //   (you can change the format as desired)
    $date = date( 'Y-m-d' );
    // create an array that holds your info
    $record = array( $firstname,$lastname,$date );
    // save the record to your .txt file (I still recommend JSON)
    $json = json_encode( $record );
    $file = '/_server_/path/to/yourfile.txt';
    file_put_contents( $json,$file );
} 
```

# python - Python，从文件中删除特定列

> ID：16123732
> 
> 赞同：0
> 
> 时间：2013-04-20T18:26:02.873
> 
> 标签：python, text, text-processing

我有以下格式的文件；

```
string1     string2         ........    stringN

value1,1    value1,2    ........    value1,N
   .            .       ........        .
   .            .       ........        .
   .            .       ........        .
valueM,1    valueM,2    ........    valueM,N 
```

M 在 10000 的范围内 N 在 100 的范围内

我需要的；

*   删除空行
*   删除前两列
*   保留第 7、14、21 ... 列并删除其余列

分别来自这个文件。

使用 numpy 变得非常棘手，因为该数据中也有字符串（每列的标题）。我将不胜感激任何指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:39:08.500

您有一个自定义的类似 ASCII 表的格式，其中包含固定列：

```
*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
*    Row   * Instance * test_string * test_string * test_string * test_string * test_string * test_string * test_string * string__722 * string__722 * string__722 * string__722 * string__722 * string__722 * string__722 * string__720 * string__720 * string__720 * string__720 * string__720 * string__720 * string__720 * HCAL_SlowDa * HCAL_SlowDa * HCAL_SlowDa * HCAL_SlowDa * HCAL_SlowDa * HCAL_SlowDa * HCAL_SlowDa * string__718 * string__718 * string__718 * string__718 * string__718 * string__718 * string__718 * string__719 * string__719 * string__719 * string__719 * string__719 * string__719 * string__719 * string__723 * string__723 * string__723 * string__723 * string__723 * string__723 * string__723 * string__721 * string__721 * string__721 * string__721 * string__721 * string__721 * string__721 * another_str * another_str * another_str * another_str * another_str * another_str * another_str * another_str * another_str *
*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
*        0 *        0 *           0 *    50331648 * test_string *           2 *           1 *          13 * 5.76460e+18 *           0 *    50331648 * string__722 *           2 *           1 *         606 * 5.83666e+18 *           0 *    50331648 * string__720 *           2 *           1 *         575 * 5.83666e+18 *           0 *    50331648 * HCAL_SlowDa *           2 *           1 *          36 * 5.76460e+18 *           0 *    50331648 * string__718 *           2 *           1 *         529 * 5.83666e+18 *           0 *    50331648 * string__719 *           2 *           1 *         529 * 5.83666e+18 *           0 *    50331648 * string__723 *           2 *           1 *         529 * 5.83666e+18 *           0 *    50331648 * string__721 *           2 *           1 *         529 * 5.83666e+18 *           0 *    50331648 *      212135 *       15080 *           1 *           1 *        3340 *        1057 * 1.399999976 *
*        0 *        1 *           0 *    50331648 *             *           2 *           1 *          13 *           0 *           0 *    50331648 *             *           2 *           1 *         606 *       53440 *           0 *    50331648 *             *           2 *           1 *         575 *       53440 *           0 *    50331648 *             *           2 *           1 *          36 *           0 *           0 *    50331648 *             *           2 *           1 *         529 *       53440 *           0 *    50331648 *             *           2 *           1 *         529 *       53440 *           0 *    50331648 *             *           2 *           1 *         529 *       53440 *           0 *    50331648 *             *           2 *           1 *         529 *       53440 *           0 *    50331648 *      212135 *             *           1 *           1 *        3340 *        1057 * 1.399999976 *
*        0 *        2 *           0 *    50331648 *             *           2 *           1 *          13 *  4294970636 *           0 *    50331648 *             *           2 *           1 *         606 * 1.09780e+16 *           0 *    50331648 *             *           2 *           1 *         575 * 1.09780e+16 *           0 *    50331648 *             *           2 *           1 *          36 * 2.70217e+16 *           0 *    50331648 *             *           2 *           1 *         529 * 1.09780e+16 *           0 *    50331648 *             *           2 *           1 *         529 * 1.09780e+16 *           0 *    50331648 *             *           2 *           1 *         529 * 1.09780e+16 *           0 *    50331648 *             *           2 *           1 *         529 * 1.09780e+16 *           0 *    50331648 *      212135 *             *           1 *           1 *        3340 *        1057 * 1.399999976 *
*        0 *        3 *           0 *    50331648 *             *           2 *           1 *          13 *   352321545 *           0 *    50331648 *             *           2 *           1 *         606 * 2.30610e+18 *           0 *    50331648 *             *           2 *           1 *         575 * 2.30610e+18 *           0 *    50331648 *             *           2 *           1 *          36 * 7.30102e+18 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *      212135 *             *           1 *           1 *        3340 *        1057 * 1.399999976 *
*        0 *        4 *           0 *    50331648 *             *           2 *           1 *          13 *           0 *           0 *    50331648 *             *           2 *           1 *         606 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         575 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *          36 * 2.82590e+16 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *             *           2 *           1 *         529 * 1.15294e+19 *           0 *    50331648 *      212135 *             *           1 *           1 *        3340 *        1057 * 1.399999976 * 
```

如果我们假设实际数据字段本身都不包含星号，那么读取每一行的最简单方法是使用正则表达式来拆分行。

要输出，我仍然会使用[`csv`module](http://docs.python.org/2/library/csv.html)，因为这将使以后的处理变得更加容易：

```
import csv
import re
from itertools import islice

row_split = re.compile('\s*\*\s*')

with open(someinputfile, 'rb') as infile, open(outputfile, 'wb') as outfile:
    writer = csv.writer(outfile, delimiter='\t')

    next(islice(infile, 3, 3), None) # skip the first 3 lines in the input file

    for line in infile:
        row = row_split.split(line)[1:-1]
        if not row: continue
        writer.writerow(row[8::7]) 
```

这会跳过空行，只写入每第 7 列（从第 9 列开始计数）并跳过其余列。

因此，第一行是：

```
['5.76460e+18', '5.83666e+18', '5.83666e+18', '5.76460e+18', '5.83666e+18', '5.83666e+18', '5.83666e+18', '5.83666e+18', '3340'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:38:13.017

这是删除空行：

```
filtered = filter(lambda x: not re.match(r'^\s*$', x), original) 
```

要删除特定列（我假设您的数据存储在文本文件中）：

```
f = open("textfile.txt","r")
lines = f.readlines()
f.close()
f = open("newfile.txt","w") 
```

写回你的行，除了你想删除的行：

```
list = [0, 1, 6, 13, 20] # remove first,second as well as 7th, 14th and 21th line
for i,line in enumerate(lines):
  if i not in list:
    f.write(line) 
```

最后，再次关闭文件。

```
f.close() 
```

# jquery - 超大滑块：标题

> ID：16123735
> 
> 赞同：0
> 
> 时间：2013-04-20T18:26:17.130
> 
> 标签：jquery, html, title, supersized

在 Supersized 中，如何让每张幻灯片有不同的 div 而不是仅使用“标题”查询？

```
{image : 'http://buildinternet.s3.amazonaws.com/projects/supersized/3.2/slides/wojno-1.jpg', title : 'Image Credit: Colin Wojno', ... 
```

我想要一个不同的“div”，每张幻灯片都有不同的样式，而不是仅仅改变文本（“Image Credit...”）。我怎样才能做到这一点？

谢谢！

# load - Sencha Touch 2.2.0 加载非常缓慢。正常吗？

> ID：16123743
> 
> 赞同：3
> 
> 时间：2013-04-20T18:26:54.913
> 
> 标签：load, sencha-touch, sencha-touch-2

我是 Sencha Touch 的新手。我已经从示例中设置了页面。但是它加载非常缓慢。正常吗？可以做些什么来减少加载时间？

这是页面[http://m.odtu.lu/odtu/](http://m.odtu.lu/odtu/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T05:50:31.473

正如@TDeBailleul 所说，您需要缩小和聚合项目 JS 文件以使其快速加载，因为加载时间与传输的字节数和触发的请求数成正比。Sencha Cmd 提供了使用以下命令缩小和打包应用程序以提高连击性能的工具：

```
sencha app build package 
```

由于您是 Sencha touch 的新手，请花时间了解[Sencha Cmd](http://docs.sencha.com/touch/2.2.0/#!/guide/command_app)，因为它可以帮助您创建、编译和捆绑您的应用程序以及许多其他有用的东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T09:06:33.830

首先你应该了解[Sencha Cmd](http://docs.sencha.com/touch/2.2.0/#!/guide/command)

您将使用的关键命令是：

```
sencha app build production 
```

注意配置步骤（尤其是**app.json**），确保不会遗漏任何内容。

# mysql - 导入 XML (CDATA)

> ID：16123745
> 
> 赞同：1
> 
> 时间：2013-04-20T18:26:59.433
> 
> 标签：mysql, xml, cdata

下午好 ！

我在所有网络上进行了研究，但我还没有找到任何关于它的信息。这很奇怪，可能是个人问题。因为任何人都有像我这样的问题。

所以，我在 mysql 中做了一个简单的命令来完成这项工作

```
LOAD XML LOCAL INFILE 
    'person.xml'
INTO TABLE 
    person
ROWS IDENTIFIED BY 
    '<person>' 
```

文件 person.xml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<list>
  <person>
      <field name="person_id">5</field>
      <field name="fname"><![CDATA[Ronström]]></field>
      <field name="lname">Ulin</field>
  </person>
  <person>
      <field name="person_id">6</field>
      <field name="fname"><![CDATA[Mikael]]></field>
      <field name="lname">Sköld</field>
  </person>
</list> 
```

INSERT 没有问题，关键是不要在标签 CDATA 内插入值，它返回 NULL。有一些方法可以去除该标签，只返回值？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-10T01:15:15.550

我无法使用`LOAD XML INFILE`这两种方法来实现它——它似乎吃掉了 CDATA 的内容。

不过，我确实使用普通的旧版本让它工作`LOAD DATA INFILE`。给定您的示例 XML 文件和此表：

```
CREATE TABLE `people` (
  `person_id` int(11) NOT NULL PRIMARY KEY,
  `fname` text,
  `lname` text
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

运行它会将文件中的数据导入表中：

```
LOAD DATA INFILE 
    '/tmp/person.xml'
INTO TABLE 
    people
CHARACTER SET 'utf8'
LINES STARTING BY '<person>' TERMINATED BY '</person>'
(@person)
SET
  person_id = ExtractValue(@person, '//field[@name="person_id"]'),
  fname     = ExtractValue(@person, '//field[@name="fname"]'),
  lname     = ExtractValue(@person, '//field[@name="lname"]')
; 
```

这通过告诉 LOAD DATA INFILE 每个`<person>...</person>`都是逻辑“行”来工作，它存储在局部变量`@person`中。然后我们将它作为 XML 片段传递给[ExtractValue()](http://dev.mysql.com/doc/refman/5.1/en/xml-functions.html#function_extractvalue)函数，使用适当的 XPath 表达式从中选择我们想要的值并将结果存储在适当的列中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-27T16:52:18.640

罗纳尔多，这可能与您的问题有关，也可能与您的问题无关（您可能已经找到了解决方案），但对于其他任何人：

如果您使用 php 加载 xml 文件：

您需要加载设置了 LIBXML_NOCDATA 标志的 xml 文件。这将正确地拉进去。

所以如果你以前有： `$xml = simplexml_load_file('some/file/path.xml');`

你要这个：

`$xml = simplexml_load_file('some/file/path.xml',null,LIBXML_NOCDATA);`

# php - 登录/用户管理 - 位置信任系统：如何在数据库中处理这个问题？

> ID：16123754
> 
> 赞同：0
> 
> 时间：2013-04-20T18:28:04.440
> 
> 标签：php, sql, database, login, trust

我正在构建一个安全的登录系统，并希望实现一个跟踪用户位置 [IP] 的功能。我宁愿根据设备来做，但显然我无法通过 PHP 获取 MAC 地址。在创建帐户时，[IP] 会被记录并注明为受信任。如果用户尝试从不同的 IP 登录，信任系统将向他们的电子邮件发送一个小的验证密钥，并要求他们在继续登录之前输入密钥。

从数据库的角度来看，实现这一点有多好？

我在想我会创造：

**表**：位置信任

**列**：[locationTrustID]、[accountID]、[ip]、[date]

VIA PHP 然后，我会将客户的每次登录与存储的受信任 IP 进行比较，如果它们对密钥有效，则让它们进入或添加一个新的。或者，我可以在帐户表中添加一列，并将多个位置存储在一个由标识符分隔的字段中。

这有意义吗？

# java - Play Framework：表单数据未传递

> ID：16123763
> 
> 赞同：3
> 
> 时间：2013-04-20T18:29:07.540
> 
> 标签：java, playframework

我正在尝试基于播放框架示例“zentask”创建一个登录页面。

当我尝试在登录页面中提交表单时，user_name 和 user_pass 为空。

命令提示符输出：

```
[info] play - database [default] connected at jdbc:mysql://localhost/smgts2
[info] play - Application started (Dev)
null null 
```

应用程序.java：

```
package controllers;

import play.*;
import play.mvc.*;
import play.data.*;
import static play.data.Form.*;

import models.*;
import views.html.*;

public class Application extends Controller {

    // -- Authentication

    public static class Login {

        public String user_name;
        public String user_pass;

        public String validate() {
            if(Accounts.authenticate(user_name, user_pass) == null) {
                return "Invalid user or password";
            }
            return null;
        }

    }

    /**
     * Login page.
     */
    public static Result login() {
        return ok(
            login.render(form(Login.class))
        );
    }

    /**
     * Handle login form submission.
     */

    public static Result authenticate() {
        Form<Login> loginForm = form(Login.class).bindFromRequest();
        if(loginForm.hasErrors()) {
            return badRequest(login.render(loginForm));
        } else {
            session("user_name", loginForm.get().user_name);
            return redirect(
                routes.Home.index()
            );
        }
    }

    /**
     * Logout and clean the session.
     */

    public static Result logout() {
        session().clear();
        flash("success", "You've been logged out");
        return redirect(
            routes.Application.login()
        );
    }
} 
```

login.scala.html

```
@(form: Form[Application.Login])

@main(Html("School Management System")) {
    <style type="text/css">
    body {
            padding-top: 60px;
            padding-bottom: 40px;
            background-color: #f5f5f5;
    }
    </style>

    @helper.form(routes.Application.authenticate, 'class -> "form-signin") {

            <h2 class="form-signin-heading">Sign-in to SMGTS</h2>

            @if(form.hasGlobalErrors) { 
                <p class="text-error">
                    @form.globalError.message
                </p>
            }

            @if(flash.contains("success")) {
                <p class="text-success">
                    @flash.get("success")
                </p>
            }

            <p>
                <input type="text" class="input-block-level" name="user_name" placeholder="Username" value='@form("user_name").value'>
            </p>
            <p>
                <input type="password" class="input-block-level" name="user_pass" placeholder="Password">
            </p>
            <p>
                <button class="btn btn-large btn-primary" type="submit">Sign in</button>
            </p>

}
} 
```

路线文件：

```
# Routes
# This file defines all application routes (Higher priority routes first)
# ~~~~

# Home page
GET     /                           controllers.Home.index()

# Authentication
GET     /login                      controllers.Application.login()
POST    /login                      controllers.Application.authenticate()
GET     /logout                     controllers.Application.logout()

# Map static resources from the /public folder to the /assets URL path
GET     /assets/*file               controllers.Assets.at(path="/public", file) 
```

Accounts.java（模型类）：

```
package models;

import java.util.*;
import javax.persistence.*;

import play.db.ebean.*;
import play.data.format.*;
import play.data.validation.*;

import com.avaje.ebean.*;

@Entity
@Table(name="user_account")
public class Accounts extends Model {

    @Id
    @Constraints.Required
    public Long acc_id;

    @Constraints.Required
    @Formats.NonEmpty
    public String user_name;

    @Constraints.Required
    @Formats.NonEmpty
    public String user_pass;

    @Constraints.Required
    public int group_id;

    // Queries

    public static Finder<Long,Accounts> find = new Finder<Long,Accounts>(Long.class, Accounts.class);

    public static Accounts authenticate(String user_name, String user_pass) {

        System.out.println(user_name + " " + user_pass); // Check if form data is passed.

        return find.where()
            .eq("user_name", user_name)
            .eq("user_pass", user_pass)
            .findUnique();

    }

}

I've been checking if the variable names in Application.java and they're the same with the input fields in login.scala.html. 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-06-07T17:17:40.637

尝试运行 play clean。它应该神奇地修复它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-28T19:39:35.583

在阅读“Play for Java”一书时，我偶然发现了同样的问题。我使用的是 Play 2.5.x，示例使用的是 2.2.x。经过几个小时的搜索解决方案，与其他示例进行比较，我终于找到了解决方案：

**模型类中缺少 setter 和 getter。**

在我添加了 getter 和 setter 之后，表单数据终于通过了。

替代解决方案：[PlayEnhancer](https://www.playframework.com/documentation/2.5.x/PlayEnhancer)

# java - 在播放声音 Android 时一直调高音量

> ID：16123773
> 
> 赞同：2
> 
> 时间：2013-04-20T18:30:14.537
> 
> 标签：java, android, sdk

我想在播放声音时将 Android 手机的音量调高。我正在使用`MediaPlayer`，`start()`如果有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T20:03:02.410

我正在开发一个应用程序来检测一个人的滑落。
当发生滑动或掉落时，应用程序需要在播放声音的同时将音量一直调高一段时间。

即使它侵犯了用户，我认为在这种情况下也是合适的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T22:17:56.827

有点晚了，但这应该可以解决问题：

```
AudioManager audioManager = (AudioManager)getSystemService(AUDIO_SERVICE);
audioManager.setStreamVolume(AudioManager.STREAM_MUSIC, audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC), 0); 
```

如果您想在播放完声音后将音量设置回原来的值，请查看这篇文章：[Android：如何以最大音量播放音乐？](https://stackoverflow.com/questions/9599259/android-how-to-play-music-at-maximum-possible-volume)

# ruby-on-rails - 嵌套表单无法保存 client_id 和 user_id

> ID：16123775
> 
> 赞同：0
> 
> 时间：2013-04-20T18:30:16.203
> 
> 标签：ruby-on-rails, nested-forms

我有用户，用户有很多客户和联系人。客户也有许多联系人（一个联系人属于用户和客户）。

在我的客户视图中，我想创建一个新客户并在同一个表单上允许用户为该客户创建第一个联系人。最初，我认为使用嵌套属性可以解决问题，但我遇到了一些问题。当我在clients_controller#create 中保存@client 时，我无法保存，因为user_id 不能为空且client_id 不能为Contact 的空白。这是我到目前为止所拥有的：

客户端控制器索引（新客户端表单所在的位置）：

```
 def index
    @clients = current_user.clients
    @client = Client.new
    @contact = @client.contacts.build

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @clients }
    end
  end 
```

和创建方法：

```
 def create
    @client = current_user.clients.new(params[:client])

    respond_to do |format|
      if @client.save 
```

和形式：

```
 = form_for(@client) do |f|
          = f.fields_for(:contacts) do |contact| 
```

但是当我去保存它时，它需要一个 client_id 和 user_id ......但我不能真正使用嵌套属性来设置它们。我怎样才能做到这一点？有更好的方法吗？这是我的参数：

```
{"name"=>"asdf", "contacts_attributes"=>{"0"=>{"name"=>"asdf", "email"=>"asdf@gmail.com"}}} 
```

我只是尝试将缺失值直接添加到contacts_attributes，但由于@client 尚未保存，我无法将client.id 分配给联系人：

```
params[:client][:contacts_attributes]["0"].merge!(:user_id => current_user.id)
params[:client][:contacts_attributes]["0"].merge!(:client_id => @client.id) 
```

即使设置了 user_id ......它仍然说用户丢失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:01:29.307

你添加`accepts_nested_attributes_for`到你的模型中了吗？你需要这样的东西：

```
class Client < ActiveRecord::Base
  has_many :contacts
  accepts_nested_attributes_for :contacts
end 
```

此外，您应该`build`在创建操作中使用：

```
@client = current_user.clients.build(params[:client]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:19:54.550

这是适用于您的示例的设置：

`app/models/user.rb`：

```
class User < ActiveRecord::Base
  attr_accessible :name, :clients_attributes

  has_many :clients

  accepts_nested_attributes_for :clients
end 
```

`app/models/client.rb`：

```
class Client < ActiveRecord::Base
  attr_accessible :company, :contacts_attributes

  belongs_to :user
  has_many :contacts

  accepts_nested_attributes_for :contacts
end 
```

`app/models/contact.rb`：

```
class Contact < ActiveRecord::Base
  attr_accessible :email

  belongs_to :client
end 
```

`app/controllers/users_controller.rb`：

```
class UsersController < ApplicationController
  # ...

  def new
    @user    = User.new
    @client  = @user.clients.build
    @concact = @client.contacts.build

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user }
    end
  end

  # ...
end 
```

实际形式：

```
<% # app/views/users/new.erb %>

<%= form_for(@user) do |f| %>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>

  <div class="field">
    <%= f.fields_for :clients do |client_form| %>
      <h5>Client</h5>
      <%= client_form.label :company, "Company name" %>
      <%= client_form.text_field :company %>

      <div class="field">
        <h5>Contact</h5>
        <%= client_form.fields_for :contacts do |contact_form| %>
          <%= contact_form.label :email %>
          <%= contact_form.text_field :email %>
        <% end %>
      </div>
    <% end %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

表格如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/Ow3AG.png)

表单发送的参数如下所示：

```
{
  "utf8"=>"✓",
  "authenticity_token" => "bG6Lv62ekvK7OS86Hg/RMQe9S0sUw0iB4PCiYnsnsE8=",
  "user" => {
    "name" => "My new user",
    "clients_attributes" => {
      "0" => {
        "company" => "Client's Company Name LLC",
        "contacts_attributes" => {
          "0" => {
            "email" => "emailbox@client.com"
          }
        }
      }
    }
  },
  "commit" => "Create User"
} 
```

**更新**

要在之后添加更多公司/联系人，请将`UsersController#edit`操作更改为：

```
class UsersController < ApplicationController
  # ...

  def edit
    @client  = current_user.clients.build
    @concact = @client.contacts.build

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user }
    end
  end

  # ...
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T15:02:12.123

以下验证可能会导致此问题，因为在为其运行验证时父 id 尚未分配给子对象。解决方法是删除这些验证或将它们设置为仅在更新时运行。这样，您就失去了对 create 方法的这些验证，但它可以工作。

```
# client.rb
validates :user, presence: true

# contact.rb
validates :client, presence: true 
```

# macros - Racket with-hash 宏和重命名转换器

> ID：16123781
> 
> 赞同：4
> 
> 时间：2013-04-20T18:30:47.340
> 
> 标签：macros, scheme, racket, renaming, transformer

我创建了这个：

```
(define-syntax (with-hash stx)
  (syntax-parse stx
    [(_ obj:id ((~or key:id [new-key:id hash-key:id]) ...) body:expr ...+)
     #'(let ([key (hash-ref obj 'key)] ...
             [new-key (hash-ref obj 'hash-key)] ...)
         (begin body ...))])) 
```

这样我就可以做到这一点：

```
 (require rackunit)
  (define h (hash 'id 1 'name "scott"))
  (with-hash h (id [new-name name])
    (check-equal? id 1)
    (check-equal? new-name "scott")) 
```

如何添加一个替代模式，在本地自动绑定所有哈希键，而无需客户端在调用中指定它们？

IE：

```
(define h (hash 'id 1 'name "scott"))
(with-hash h
  (check-equal? id 1)
  (check-equal? name "scott")) 
```

我怀疑它涉及重命名转换器，但我是否能够根据运行时哈希声明语法参数并动态重命名它们？

另外，我认为这样的事情可能在正确的轨道上：

```
(define-syntax (with-hash stx)
  (syntax-parse stx
    [(_ obj:id (key:id ...) body:expr ...+)
     #'(let ([key (hash-ref obj 'key)] ...)
         (begin body ...))]
    [(_ obj:id body:expr ...+)
     #'(with-hash obj (id title) body ...)])) 
```

我记得宏并解析出要绑定的数据，但在这种情况下，即使宏以其他方式工作，id 和 title 变量也不会绑定。

显然我在我的理解中遗漏了一些东西。

任何见解都值得赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:55:48.467

我建议采取另一个方向并坚持提供标识符。在 Scheme 程序的评估环境中创建/添加标识符时总是有点可疑。是的，它是允许的并且可以安全地完成，但它会混淆人们对绑定的内容、时间和地点的理解。

因此，我建议将您`with-hash`视为一个绑定结构，它允许访问`hash`. 像这样使用：

```
(with-hash h ((the-id 'id) (the-name 'name)) ...) 
```

或者，使用默认名称，

```
(with-hash h (id name) ...) 
```

它将像这样实现：

```
(define-syntax with-hash
  (syntax-rules ()
    ((_ "gen" hash ((fname fkey) ...) body ...)
     (let ((obj hash))
       (let ((fname (hash-ref obj 'fkey)) ...)
         body ...))))
    ...
    )) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T05:28:48.383

你不能，真的。变量作用域是一个静态属性，而哈希的键是一个动态属性，所以任何解决方案都会出错。但是既然你问了，有两个错误的解决方案与你所要求的有点相似。

您可以做的一件事是使用`eval`. 但是当您调用时，`eval`您将丢失任何局部变量；请参阅[文档](http://docs.racket-lang.org/guide/reflection.html)。您可能可以自己编写代码。

您可以做的另一件事是通过 shadowing 更改未绑定变量引用的含义`#%top`，这是隐式包装对未绑定（或“可能由顶级环境绑定”）变量的变量引用的语法。但这意味着这`with-hash`将*无法*隐藏任何已经具有本地或模块级绑定的键。无论如何，这就是代码的样子：

```
(define-syntax (with-hash stx)
  (syntax-case stx ()
    [(with-hash h . body)
     (with-syntax ([#%top (datum->syntax stx '#%top)])
       #'(let-syntax ([#%top
                       (syntax-rules ()
                         [(#%top . x)
                          (hash-ref h 'x)])])
           (begin . body)))])) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-21T05:58:50.280

当我试图想出一个答案时，Ryan 回应了 :) 无论如何，这是一个 eval 的解决方案，与其他人已经表达的相同警告。

```
#lang racket

(require (for-syntax syntax/parse))

(define-syntax (with-hash stx)
  (syntax-parse stx 
   [(_ h:expr body:expr ...+)
    #'(begin
        (define-namespace-anchor a)
        (let ([keys (hash-keys h)])
          (define (mk-bind k) `[,k (hash-ref h (quote ,k))])
          (eval 
           `(let ,(map mk-bind keys) 
              ,@(quote (body ...))) 
           (namespace-anchor->namespace a))))]))

(require rackunit)
(define h (hash 'id 1 'name "scott"))
(with-hash h
  (check-equal? id 1)
  (check-equal? name "scott")) 
```

编辑：

作为替代方案，如果你知道你只会以特定方式使用它，你可以用这样的东西来伪造它。

```
#lang racket

(require (for-syntax syntax/parse))

(define-syntax (with-hash stx)
  (syntax-parse stx #:datum-literals (check-equal?)
    [(_ h:expr (check-equal? key:id val:expr) ...)
     #'(let ([keys (hash-keys h)])
         (check-true (hash-has-key? h (quote key))) ...
         (check-equal? (hash-ref h (quote key)) val) ...)]))

(require rackunit)
(define h (hash 'id 1 'name "scott"))
(with-hash h
  (check-equal? id 1)
  (check-equal? name "scott")) 
```

# r - 在 lapply 中加速垃圾收集

> ID：16123783
> 
> 赞同：1
> 
> 时间：2013-04-20T18:31:22.173
> 
> 标签：r, garbage-collection, lapply

`lapply`在函数或循环中进行垃圾收集的最快方法是什么？对我来说似乎很明显的事情大大减慢了速度。我做错了吗？有更快的方法吗？

```
x <- 1:10000
system.time(xx <- lapply(1:length(x), function(xi) sum(x[1:xi])))
 user  system elapsed 
   0.02    0.00    0.02 
system.time(xx <- lapply(1:length(x), function(xi) sum(x[1:xi], invisible(gc(v=FALSE)))))
   user  system elapsed 
  22.49    0.00   22.57 # a thousand times increase in time taken!! 
```

在我的实际用例中，该函数有点复杂，并且在没有`gc`每个实例之后都会失败。我可以切换到具有更多 RAM 的机器，但会不太方便，所以我很好奇是否有更快的`gc`方法可用。

**更新**根据 Martin Morgan 的建议，稍微重新安排一些事情会使速度接近`lapply`没有`gc`（现在在不同的机器上工作，这就是为什么时间与上面不同）：

```
x <- 1:10000
system.time(x1 <- lapply(1:length(x), function(xi) sum(x[1:xi])))
   user  system elapsed 
   3.47    0.00    3.56 
# define a function to make a sequence of a function followed by gc
sum_gc <- function(x) sum(x); invisible(gc(v=FALSE))
system.time(x3 <- lapply(1:length(x), function(xi) sum_gc(x[1:xi])))
   user  system elapsed 
   3.52    0.02    3.56 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T21:35:31.737

不是真正的答案，但比评论更长。本，这个

```
fun0 = function(x) sum(x, gc()) 
```

定义一个计算“x 和 gc() 返回的值”之和的函数。这个

```
fun1 = function(x) sum(x); gc() 
```

定义一个返回 x 和的函数。`gc()`在定义函数后运行，但不是函数定义的一部分。

```
fun2 = function(x) {
    result = sum(x)
    gc()
    result
} 
```

定义一个函数，计算 x 的总和并将其保存到`result`函数内部存在的变量中。然后它评估函数`gc()`。然后它返回包含在 中的值`result`，即 x 的总和。除了时间之外，值得比较结果

```
test_case = 1:5
identical(sum(test_case), fun0(test_case))  # FALSE
identical(sum(test_case), fun1(test_case))  # TRUE, but no garbage collection
identical(sum(test_case), fun2(test_case))  # TRUE 
```

在第一次被评估之后，调用`gc()`in并没有真正完成任何事情。没有已分配但不再与符号关联的内存，因此无需收集垃圾。这是我们分配一些内存，使用它，删除对它的引用，然后运行垃圾收集以释放内存的情况。`fun2``fun2`

```
fun3 = function(x) {
   m = rnorm(length(x))
   result = sum(m * x)
   rm(m)
   gc()
   result
} 
```

*但是显式垃圾收集在这里没有任何用处*——当 R 需要比可用内存更多的内存时，垃圾收集器会自动运行。如果`fun3`已被多次调用，则每次调用中都会使用不再被符号引用的内存，因此将在垃圾收集器自动运行时被收集。通过直接调用`gc()`，您断言您的天真的垃圾收集策略（一直这样做）比 R 更好（在需要更多内存时这样做）。

哪一个可以做（写一个更好的垃圾收集器）。

但这里不是这样。

我提到，当遇到性能或内存问题时，退后一步看看你的算法和实现通常是值得的。我知道这是一个“玩具”示例，但还是让我们看看。您正在计算的是 x 元素的累积和。我会把你的实现写成

```
fun4 = function(i, x) sum(x[seq_len(i)])
sapply(seq_along(test_case), fun4, test_case) 
```

这给

```
> x0 <- sapply(seq_along(test_case), fun4, test_case)
> x0
[1]  1  3  6 10 15 
```

但是 R 有一个函数`cumsum`可以在内存和速度方面更有效地执行此操作。

```
> x1 <- cumsum(test_case)
> identical(x0, x1)
[1] TRUE
> test_case = seq_len(10000)
> system.time(x0 <- sapply(seq_along(test_case), fun4, test_case))
   user  system elapsed 
  2.508   0.000   2.517 
> system.time(x1 <- cumsum(test_case))
   user  system elapsed 
  0.004   0.000   0.002 
```

# javascript - 使总数计数似乎增加

> ID：16123784
> 
> 赞同：0
> 
> 时间：2013-04-20T18:31:31.733
> 
> 标签：javascript, jquery

基本上我有一个类计数系统，它显示类的数量并将它们显示在一个`span`元素中。下面是代码：

```
$.get('other.html', function(data) {
$('#total').html($('.doc', data).length);
}); 
```

这完美地工作，但是我想要一种方法让数字一个一个地增加，因为页面加载时 span 元素包含 0 。这是一个[例子（这里的数字在增加）。](http://www.worldometers.info/)

为此，我已经尝试过`setTimeout`，尽管这无论如何都不起作用，但我发布它只会延迟功能，然后显示结束编号。我听说过`periodical`或使用过类似的东西，但在示例源代码中找不到。

对于更糟糕的措辞，我真的很抱歉。如果您不知道我的意思，那么请询问，我会尝试改写或找到更好的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:39:54.630

关键是增加数字的功能应该在终止之前设置一个 setTimeout 来调用自己。这样它总是会被再次调用。如果您想要停止递增的选项，您可以添加一个全局变量，并且该函数只会在该变量为真时设置新的超时。

例子：

```
var doIncrement = true;
var numberToIncrement = 0;

function increment {
    numberToIncrement++;
    $('#mySpan').text(numberToIncrement);
    if (doIncrement) {
        setTimeout(increment, 1000);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:42:36.800

您可以使用`setInterval`允许您在某些时间间隔运行代码的功能。`clearInterval`允许停止任务。

[http://jsfiddle.net/d52Pw/](http://jsfiddle.net/d52Pw/)

```
var $totalEl = $('#total');

$.get('other.html', function(data) {
    var len = $('.doc', data).length,
        count = 0,
        int = setInterval(function () {
            if (++count === len) {
               //when we reach len, we stop the task
               clearInterval(int);
            }

            $totalEl.html(count);
        }, 500); //run every 1/2 sec
}); 
```

# javascript - 在ajax完成之前回调以防止循环

> ID：16123785
> 
> 赞同：0
> 
> 时间：2013-04-20T18:31:32.943
> 
> 标签：javascript, ajax, asynccallback

我已经阅读了无数类似帖子的请求帮助示例以及回调背后理论的解释，但我就是无法理解。我已经到了我宁愿为我的特定场景找到解决方案并继续前进的阶段，即使我并不真正理解它的“为什么/如何”工作。我有一个需要循环的 ajax 调用，并且需要找到一种方法来防止在前一个调用完成之前进行下一个调用。您能否建议我如何使用回调或其他方法来实现这一点。

这是代码（有效，但不运行 ajax 调用 1-by-1 所以我遇到内存错误和页面崩溃）。运行的功能非常密集，最多可能需要 20 秒（但只需 1 秒）

```
function returnAjax(startLoc,startRow)
{
        var url='index.php?option=com_productfinderrtw&format=raw&task=goThroughProcess';
        var data = 'startloc='+startLoc+'&starttour='+startRow;
                            var request = new Request({
                            url: url,
                            method:'get',
                            data: data,
                            onSuccess: function(responseText){
    document.getElementById('fields-container').innerHTML= responseText;  
//I realise this is where on-success code cneeds to go- is this where the callback belongs? 
                            }
                            }).send();

}

function iterator (startLoc,startRow) {
    if (startRow <20)
        {
        startRow++;
        }
        else
        {
        startRow = 1;
        startLoc++;
        }
    return [startLoc, startRow];
}

function runRAA() {
    var startLoc = 0;
    var startRow = 1;

    while (startLoc < 47)
    {
    returnAjax(startLoc,startRow);
    $counter = iterator(startLoc,startRow);
        var newLoc = $counter[0];
        var newRow = $counter[1];

        startLoc = newLoc;
        startRow = newRow;
    }
} 
```

`runRAA()`是在按钮按下时运行的主要功能。如何重新安排它以确保 returnAjax 在上一次完成之前不会运行？

在此先感谢您。我知道有人问过类似的问题，所以我请求您不要将我引向其他解释——我可能已经阅读过它们，但只是不理解这个概念。

干杯!

PS。我了解 iterator() 函数仅在 returnAjax() 完成时才需要运行，因为 iterator() 为 returnAjax() 函数的每个实例设置新参数值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:15:20.660

允许传递`callback`将在 ajax 调用完成时调用的参数。

```
function returnAjax(startLoc, startRow, callback) {
    //...
    onSuccess: function(responseText) {
        document.getElementById('fields-container').innerHTML= responseText;
        if (callback) {
            callback.apply(this, arguments); //call the callback
        }
    }
    //...
} 
```

然后你可以做这样的事情：

```
 function runRAA(startLoc, startRow) {
        startLoc =  startLoc || 0;
        startRow = startRow || 1;

        if (startLoc < 47) {
            returnAjax(startLoc, startRow, function (responseText) {
                var counter = iterator(startLoc, startRow);

                //do something with the response

                //perform the next ajax request
                runRAA(counter[0], counter[1]);

            }));
        }
    }

    runRAA(); //start the process 
```

# mod-rewrite - Lighttpd 的 mod_rewrite 模块

> ID：16123787
> 
> 赞同：0
> 
> 时间：2013-04-20T18:31:38.540
> 
> 标签：mod-rewrite, url-rewriting, lighttpd, subdirectory, lighty

我对 Lighty 的 mod_rewrite 模块有疑问。

我正在尝试这样做：example.com/index.php?search=whatever，显示为 example.com/whatever 或 example.com/search/whatever（尚未决定——对 SEO 不太了解）

虽然我希望它像上面那样运行，但我还想从重写中排除所有物理目录和所有文件，例如目录 /images/ 和文件 index.php、favicon.ico、style.css 等，因为它行为怪异。

我将如何实现这一目标？我尝试了以下方法，这对于我想要的效果很好，但在排除目录和文件时并没有真正起作用：

```
url.rewrite-once = (
"^/([a-zA-Z0-9_-]+)" => "/index.php?search=$1",
"^/(images|js|wp-content)/(.*)" => "$0",
"(.*\.php|.*\.css|favicon.ico)" => "$0" ) 
```

顺便说一句，这之间有什么区别：

```
"^/([a-zA-Z0-9_-]+)" => "/index.php?search=$1", 
```

和这个：

```
"^/(.*)$" => "/index.php?search=$1" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T21:10:47.797

为了避免必须添加大量 RewriteCond 指令来检查访问者的请求不是实际文件而不是人工路径，我建议使用该`/search/whatever`模式以支持该`/whatever`模式。然后，只要您从不创建名为“search”的实际目录，您就永远不需要检查以 开头的路径是否`/search`是实际文件路径。所以你的 RewriteRule 变得这么简单：

```
RewriteRule ^/search/([a-zA-Z0-9_-]+)$ /index.php?search=$1 
```

（我对 Lighty 不熟悉，所以我不确定如何将其转换为 url.rewrite-once 指令，但这是一个如此简单的重写，应该很简单。）

但是，访问者的浏览器现在会认为他们正在查看一个位于名为“搜索”的子目录中的页面，因此如果您有任何使用相对路径（未锚定到根目录的路径）指定的图像元素或 CSS 文件，例如或者然后浏览`src="images/photo.jpg"`器`href="stylesheets/clean.css"`会认为这些路径是相对于“搜索”目录的，并会分别向您的网络服务器询问`/search/images/photo.jpg`和`/search/stylesheets/clean.css`。

有两种方法可以做到这一点。第一个是将所有页面装饰（图像、样式表、JavaScript）路径更改为绝对路径。也就是说，更改路径，使其以代表网站根目录的正斜杠开头。因此，您的图像路径需要更改为`src="/images/photo.jpg"`，您的样式表路径需要更改为`href="/stylesheets/clean.css"`. 开头的正斜杠告诉 Web 浏览器该路径从站点的根目录开始，因此没有歧义。

第二个选项是创建复杂的 RewriteRules 以将图像、样式表、脚本文件等的请求重定向到正确的目录。如果您在许多不同的目录中有许多媒体类型并且您需要它们从许多不同的子目录（虚拟和/或其他）工作，这往往会变得丑陋和脆弱。

您选择哪个选项取决于您的要求和偏好。

关于您关于`[a-zA-Z0-9_-]+`和`.*`第一个模式之间的区别的问题，仅允许字母 a 到 z（小写或大写）、数字、下划线和连字符。第二种模式允许任何字符。出于安全和调试原因，通常最好使用将字符限制为仅应允许的字符的模式。所以我会使用第一个模式，如果需要，添加额外的允许字符，而不是允许所有字符。

# jquery - jQuery循环（）转到页面名称？

> ID：16123802
> 
> 赞同：0
> 
> 时间：2013-04-20T18:33:43.953
> 
> 标签：jquery, jquery-cycle

请如何设置 jQuery .cycle() 插件以链接`<a href=""`到循环幻灯片名称？例子。

```
<div id="slides">
<div name="slide_blue"> content of slide name slide_blue</div>
<div name="slide_red"> content of slide name slide_red</div>
</div> 
```

我需要创建链接：

```
<a href=".cycle() to div name slide_blue">Blue<a>
<a href=".cycle() to div name slide_red">Red<a> 
```

jQuery 设置示例

```
$("#slides").cycle({
fx: 'ScrollHorz'
}); 
```

abybody 可以帮我创建设置幻灯片周期名称的链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T08:41:29.657

现场[演示 && 代码](http://jsfiddle.net/QBmBK/1/)

像这样，根据您的需要进行修改：

```
<div id="slides">
<div name="slide_blue"> content of slide name slide_blue</div>
<div name="slide_red"> content of slide name slide_red</div>
<div name="slide_yellow"> content of slide name slide_yellow</div>
</div>

<div>
    <a href=".cycle() to div name slide_blue" class="slide_blue">Blue<a>
    <a href=".cycle() to div name slide_red" class="slide_red">Red<a>
    <a href=".cycle() to div name slide_yellow" class="slide_yellow">Yellow<a>
</div>

<script>
(function() {

    $("#slides").cycle({
       fx: 'scrollRight'
    });

    var cycleTo = function() {
        var className = $(this).attr('class');
        var divSelected = $('#slides div[name='+className+']');
        var slideIndex = $('#slides div').index(divSelected);
        $('#slides').cycle(slideIndex); 
        return false; 
    }

    $('div a').click(cycleTo); 

}())
</script> 
```

# visual-studio-2010 - ReportViewer10 - 在报告和工具栏周围显示额外的行

> ID：16123806
> 
> 赞同：0
> 
> 时间：2013-04-20T18:34:08.357
> 
> 标签：visual-studio-2010, ssrs-2008, reportviewer

我创建了一个 Web 应用程序，它在 VS2010 中使用 reportviewer 10.0.0.0 来呈现 SSRS 2008 报告。报告和工具栏确实呈现，但它们以奇怪的布局显示。我看到报告和工具栏周围环绕着许多不必要的行（如屏幕截图所示）。我没有关于如何解决这个问题的想法。是否有一些我错过了导致此问题的报告查看器的设置？我该如何解决这个问题？谢谢你。

aspx：

```
<rsweb:ReportViewer ID="ReportViewer1" runat="server" Font-Names="Verdana" Font-  
Size="8pt" InteractiveDeviceInfos="(Collection)" ProcessingMode="Remote" 
WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" Width="100%" 
ShowParameterPrompts="false" ShowPrintButton="true"></rsweb:ReportViewer> 
```

后面的代码：

```
 ReportViewer1.ProcessingMode = Microsoft.Reporting.WebForms.ProcessingMode.Remote;
    ReportViewer1.ServerReport.ReportServerUrl = new Uri(GlobalProperties.SSRSBasePath); // Report Server URL
    ReportViewer1.ServerReport.ReportPath = "/" + folder_name + "/" + report_name; // Report Name
    ReportViewer1.ServerReport.SetParameters(reportParameterCollection);
    ReportViewer1.ServerReport.Refresh(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T02:15:28.007

听起来您遇到了我开始使用 ReportViewer 时遇到的问题。尝试查看您的CSS。检查网站集上的所有表格是否有任何可能导致问题的边框和其他格式。

# python - boto S3 和烧瓶错误 - 授权标头无效 - 需要一个且只有一个“”（空格）

> ID：16123807
> 
> 赞同：0
> 
> 时间：2013-04-20T18:34:11.220
> 
> 标签：python, amazon-s3, flask, boto

我有一些昨天运行良好的代码 - 现在我遇到了一个错误。

```
s3 = get_s3_connection()
b_temp = s3.get_bucket(current_app.config['AWS_S3_BUCKET_TEMP'])
b_assets = s3.get_bucket(current_app.config['AWS_S3_BUCKET_ASSETS']) 
```

我得到以下堆栈跟踪，它转储响应：

```
ResponseError: S3ResponseError: 400 Bad Request

<?xml version="1.0" encoding="UTF-8"?>
<Error>
  <Code>InvalidArgument</Code>
  <Message>Authorization header is invalid -- one and       only one ' ' (space required</Message>

<ArgumentValue>AWS &lt;flask.app.Flask objecat0x1043d2e90&gt;:AbKV0ZvU6B0XXXXXXXXXX=       
</ArgumentValue>
<ArgumentName>Authorization</ArgumentName> 
```

获取 b_temp 工作正常。错误发生在第二个`get_bucket`- 为什么 boto 这样做？

# java - 我正在尝试调整 ImageIcon 的大小，但它部分不在屏幕上......我该如何解决这个问题？

> ID：16123809
> 
> 赞同：0
> 
> 时间：2013-04-20T18:34:18.077
> 
> 标签：java, image, resize

所以......我正在尝试调整一张快乐的脸图像的大小：
![在此处输入图像描述](https://i.stack.imgur.com/3Zb91.png)
它在框架上显示正常，但后来我意识到它的一部分没有显示。我的意思是它没有调整大小，它只是被切断了。然后我添加了一些调整大小的代码（到处都是，在每个站点上几乎都是一样的），结果证明它不起作用。

换句话说，我明白了。 ![在此处输入图像描述](https://i.stack.imgur.com/NNcAH.png) 如果有的话，这里有什么问题？谢谢！

```
public class RockPaperScissors {

//global resources
final static Dimension SCREEN_SIZE = Toolkit.getDefaultToolkit().getScreenSize();
final static int WIDTH = (int) SCREEN_SIZE.getWidth();
final static int HEIGHT = (int) SCREEN_SIZE.getHeight();
final static ImageIcon RPS_LOGO = new ImageIcon("images/rps.png");

/**
 * @param args
 */
public RockPaperScissors() {

    ImageIcon icon = RPS_LOGO;
    Image img = icon.getImage(); 
    BufferedImage bi = new BufferedImage(img.getWidth(null), img.getHeight(null), BufferedImage.TYPE_INT_ARGB); 
    Graphics g = bi.createGraphics(); 
    g.drawImage(img, 0, 0, HEIGHT, HEIGHT, null); 
    ImageIcon newIcon = new ImageIcon(bi);
    JLabel RPS_LOGO_LABEL = new JLabel(newIcon);

    JFrame window = new JFrame();
    window.setName("Rock, Paper, Scissors!");
    window.setSize(WIDTH, HEIGHT);
    window.setVisible(true);
    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Container frameContents = window.getContentPane();
    frameContents.setLayout(null);
    frameContents.add(RPS_LOGO_LABEL);
    Rectangle logo = new Rectangle(0,0,HEIGHT,HEIGHT);
    RPS_LOGO_LABEL.setBounds(logo);

}

public static void main(String args[]) {
    new RockPaperScissors();
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:37:52.810

使用[`getScaledInstance()`](http://docs.oracle.com/javase/7/docs/api/java/awt/Image.html#getScaledInstance%28int,%20int,%20int%29)：

```
Image scaled = image.getScaledInstance(width, height, 5); 
```

此代码应缩放图像以适合您的整个框架。

# mysql - MySQL UNION 仅包含第一个表

> ID：16123811
> 
> 赞同：1
> 
> 时间：2013-04-20T18:34:20.507
> 
> 标签：mysql, left-join, union, right-join

我需要在两个表上执行 FULL OUTER JOIN，我正在尝试使用 LEFT JOIN/RIGHT JOIN/UNION ALL 技术在 MySQL 中实现它。

以下是原始表格：

```
giving_totals:
+--------------+---------------+-------------+
| country_iso2 | total_given   | supersector |
+--------------+---------------+-------------+
| AE           | 1396986989.02 |           3 |
| AE           |  596757809.20 |           4 |
| AE           |  551810209.87 |           5 |
| AE           |   25898255.77 |           7 |
| AE           |      32817.63 |           9 |
...
+--------------+---------------+-------------+

receiving_totals:
 +--------------+----------------+-------------+
| country_iso2 | total_received | supersector |
+--------------+----------------+-------------+
| AE           |    34759000.00 |           3 |
| AE           |      148793.82 |           7 |
| AE           |         734.30 |           9 |
| AF           |  6594479965.85 |           1 |
| AF           |  2559712971.26 |           2 |
+--------------+----------------+-------------+ 
```

我希望结果表为每个超级部门代码的每个国家/地区都有一个条目，即使它没有为该部门提供或收款（如果有人熟悉，这来自 AidData 项目数据集。）我想通过这样做来实现这一点LEFT JOIN（获取所有给予条目）和 RIGHT JOIN（获取所有接收条目）的 UNION。这是我尝试的查询：

```
SELECT g.country_iso2 AS country_iso2, g.total_given AS `total_given`,R.total_received AS `total_received`,g.supersector AS `supersector` 
FROM (`giving_totals` `g` 
LEFT JOIN `receiving_totals` `r` 
ON(((g.country_iso2 = r.country_iso2) 
AND (g.supersector = r.supersector)))) 

UNION ALL

SELECT g.country_iso2 AS country_iso2, g.total_given AS `total_given`,R.total_received    AS `total_received`,g.supersector AS `supersector` 
FROM (`giving_totals` `g` 
RIGHT JOIN `receiving_totals` `r` 
ON(((g.country_iso2 = r.country_iso2) 
AND (g.supersector = r.supersector)))) 
```

但这只会返回第一个连接，无论我是先放置右连接还是左连接。我想我可能会误解 UNION 操作，因为个人加入每个都会返回我的预期。一如既往地感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:42:37.080

这是执行以下操作的另一种方法`full outer join`：

```
SELECT driver.country_iso2 AS country_iso2,
       g.total_given AS `total_given`,
       R.total_received AS `total_received`,
       driver.supersector AS `supersector` 
from ((select distinct country_iso2, supersector
       from giving_totals
      ) union
      (select distinct country_iso2, supersector
       from receiving_totals
      )
     ) driver left outer join
     giving_totals gt
     on gt.country_iso2 = driver.country_iso2 and
        gt.supersector = driver.country_iso2 left outer join
     receiving_totals rt
     on rt.country_iso2 = driver.country_iso2 and
        rt.supersector = driver.country_iso2 
```

也就是说，将联合作为子查询来获取您感兴趣的所有组合。然后您可以`left outer join`对该表执行操作。

您的问题的原因是第二个查询中的别名。你可以试试这个：

```
SELECT r.country_iso2 AS country_iso2, g.total_given AS `total_given`,R.total_received    AS `total_received`,r.supersector AS `supersector` 
FROM (`giving_totals` `g` 
RIGHT JOIN `receiving_totals` `r` 
ON(((g.country_iso2 = r.country_iso2) 
AND (g.supersector = r.supersector)))) 
```

对于这些值，原始表单将具有 NULL。

# qt4 - 如何正确链接到 CMake 中的 QT4 库？

> ID：16123817
> 
> 赞同：4
> 
> 时间：2013-04-20T18:35:15.070
> 
> 标签：qt4, cmake

所以我正在尝试构建一个最初是用**CMake**而不是**.pro**文件制作的程序。但是，我无法构建它，因为库声明有问题。例如，以下内容将不起作用：

```
#include <QtGui/QApplication> 
```

但是，这或多或少有效，但不完全有效：

```
#include <qt4/QtGui/QApplication> 
```

如果我使用上面的，那么我会得到大量的错误，因为编译器说它找不到其他头文件指向的头文件。问题是**qt4**的前缀。如何在 CMake 文件中正确链接它，以便可以在 qt4 下找到每个标题，而无需更改 QT-SDK 附带的所有标题？

* * *

CMAKE 文件：（来源：[http](http://code.metager.de/source/xref/kde/Support/polkit-qt-1/examples/CMakeLists.txt) ://code.metager.de/source/xref/kde/Support/polkit-qt-1/examples/CMakeLists.txt ）

```
install(FILES org.qt.policykit.examples.policy DESTINATION ${SHARE_INSTALL_PREFIX}/polkit-1/actions/)

include_directories(
${CMAKE_CURRENT_SOURCE_DIR}
${CMAKE_CURRENT_BINARY_DIR}
${CMAKE_SOURCE_DIR}/gui
)

set(polkit_example_SRCS
main.cpp
PkExample.cpp
)

SET(polkit_example_RESOUCES
icons/icons.qrc
)

FIND_PACKAGE(Qt4 REQUIRED)

QT4_WRAP_CPP(polkit_example_MOC_SRCS
PkExample.h
)

QT4_WRAP_UI(polkit_example_UI_SRCS
PkExample.ui
)

QT4_ADD_RESOURCES (qtsourceview_RC_SRCS  ${polkit_example_RESOUCES})

add_executable(polkit-example
${polkit_example_SRCS}
${polkit_example_MOC_SRCS}
${polkit_example_UI_SRCS}
${qtsourceview_RC_SRCS}
)

target_link_libraries(polkit-example
${QT_QTCORE_LIBRARY}
${QT_QTGUI_LIBRARY}
polkit-qt-gui-1
polkit-qt-core-1
)

#--------Helper Application

# This macro is defined in FindPolkitQt.cmake
macro(dbus_add_activation_system_service _sources)
foreach (_i ${_sources})
    get_filename_component(_service_file ${_i} ABSOLUTE)
    string(REGEX REPLACE "\\.service.*$" ".service" _output_file ${_i})
    set(_target ${CMAKE_CURRENT_BINARY_DIR}/${_output_file})
    configure_file(${_service_file} ${_target})
    install(FILES ${_target} DESTINATION ${SHARE_INSTALL_PREFIX}/dbus-1/system-services )
    #install(FILES ${_target} DESTINATION ${_install_dir})
endforeach (_i ${ARGN})
endmacro(dbus_add_activation_system_service _sources)

set(polkit_example_helper_SRCS
PkExampleHelper.cpp
mainHelper.cpp
)

qt4_add_dbus_adaptor(polkit_example_helper_SRCS
org.qt.policykit.examples.xml
PkExampleHelper.h
PkExampleHelper
)

QT4_WRAP_CPP(polkit_example_helper_MOC_SRCS
PkExampleHelper.h
)

add_executable(polkit-example-helper
${polkit_example_helper_SRCS}
${polkit_example_helper_MOC_SRCS}
)

# see our helper is pretty small :D
target_link_libraries(polkit-example-helper
${QT_QTCORE_LIBRARY}
polkit-qt-core-1
)

dbus_add_activation_system_service(org.qt.policykit.examples.service.in)

install(FILES org.qt.policykit.examples.conf DESTINATION ${SYSCONF_INSTALL_DIR}/dbus-1/system.d) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T19:22:25.510

据我所知，你已经很接近了。在您`FIND_PACKAGE(Qt4 REQUIRED)`包含以下行之后：

> 包括（${QT_USE_FILE}）

根据[文档](http://cmake.org/cmake/help/cmake2.6docs.html#module:FindQt4)

> 指向的文件将通过添加包含目录、预处理器定义和填充包含所有 Qt 库及其依赖`QT_USE_FILE`项的变量来设置您的编译环境。`QT_LIBRARIES`

因此，这应该为您设置正确的路径。

# c# - 在 .NET 中获取州和省

> ID：16123819
> 
> 赞同：4
> 
> 时间：2013-04-20T18:35:23.083
> 
> 标签：c#, asp.net, web-services, api, geolocation

以下网络服务将为我提供所有国家/地区。我想得到所有的州和省。我怎样才能做到这一点？

[http://ws.geonames.org/countryInfo](http://ws.geonames.org/countryInfo)

似乎唯一的方法是在这里[http://www.geonames.org/export/web-services.html](http://www.geonames.org/export/web-services.html)注册一个 API 用户名，然后尝试调用类似[http://api.geonames.org/ postalCodeSearch?country=COUNTRY_CODE&username=demo](http://api.geonames.org/postalCodeSearch?country=COUNTRY_CODE&username=demo)其中 COUNTRY_CODE 是一个变量，我必须通过遍历每个国家来填充。

是否有更简单/更好的方法来获取所有州/省信息？像[http://ws.geonames.org/stateInfo](http://ws.geonames.org/stateInfo)这样的东西会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T23:14:38.877

我发现的最好的是：

```
CREATE TABLE `countries` (
  `id` smallint(5) unsigned NOT NULL auto_increment,
  `name` varchar(40) NOT NULL,
  `abbreviation` varchar(4) NOT NULL,  
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE `states` (
  `id` smallint(5) unsigned NOT NULL auto_increment,
  `country_id` smallint(5) unsigned NOT NULL,
  `name` varchar(100) NOT NULL,
  `abbreviation` varchar(3) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

INSERT INTO countries (name, abbreviation) VALUES ('Canada', 'CAN');
INSERT INTO countries (name, abbreviation) VALUES ('United States of America', 'USA');

INSERT INTO states (country_id, name, abbreviation) VALUES ('1', 'Alberta', 'AB');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1', 'British Columbia', 'BC');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Manitoba', 'MB');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'New Brunswick', 'NB');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Newfoundland and Labrador', 'NL');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Northwest Territories', 'NT');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Nova Scotia', 'NS');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1', 'Nunavut', 'NU');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Ontario', 'ON');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Prince Edward Island', 'PE');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Québec', 'QC');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Saskatchewan', 'SK');
INSERT INTO states (country_id, name, abbreviation) VALUES ('1',  'Yukon Territory', 'YT');

INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Alaska', 'AK');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Alabama', 'AL');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Arizona', 'AZ');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Arkansas', 'AR');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'California', 'CA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Colorado', 'CO');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Connecticut', 'CT');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Delaware', 'DE');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'District of Columbia', 'DC');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Florida', 'FL');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Georgia', 'GA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Hawaii', 'HI');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Idaho', 'ID');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Illinois', 'IL');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Indiana', 'IN');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Iowa', 'IA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Kansas', 'KS');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Kentucky', 'KY');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Louisiana', 'LA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Maine', 'ME');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Maryland', 'MD');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Massachusetts', 'MA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Michigan', 'MI');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Minnesota', 'MN');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Mississippi', 'MS');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Missouri', 'MO');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Montana', 'MT');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Nebraska', 'NE');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Nevada', 'NV');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'New Hampshire', 'NH');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'New Jersey', 'NJ');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'New Mexico', 'NM');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'New York', 'NY');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'North Carolina', 'NC');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'North Dakota', 'ND');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Ohio', 'OH');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Oklahoma', 'OK');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Oregon', 'OR');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Pennsylvania', 'PA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Puerto Rico', 'PR');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Rhode Island', 'RI');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'South Carolina', 'SC');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'South Dakota', 'SD');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Tennessee', 'TN');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Texas', 'TX');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Utah', 'UT');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Vermont', 'VT');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Virginia', 'VA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Washington', 'WA');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'West Virginia', 'WV');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Wisconsin', 'WI');
INSERT INTO states (country_id, name, abbreviation) VALUES ('2', 'Wyoming', 'WY'); 
```

我从这里得到的[http://www.prioninteractive.com/2011/02/mysql-sql-for-generating-canada-and-usa-provincestate-tables/](http://www.prioninteractive.com/2011/02/mysql-sql-for-generating-canada-and-usa-provincestate-tables/)

这是平常的事；想不到这么难找...

希望这对其他人有帮助。

# matlab - matlab中的旋转高斯滤波器

> ID：16123820
> 
> 赞同：0
> 
> 时间：2013-04-20T18:35:33.237
> 
> 标签：matlab

我正在尝试在 matlab 中创建和旋转高斯滤波器。这是我的代码：

```
function f = createGaussianArray(length, sigma, theta)
    half = length/2;
    [x,y] = meshgrid(-half:half, -half:half);
    x2 = cos(theta)*(x)-sin(theta)*(y);
    y2 = sin(theta)*(x)+cos(theta)*(x);
    matrix = exp(- (x2.^2+y2.^2) / (2*sigma.^2));
    f = matrix ./ sum(matrix(:));
end 
```

当我调用这个函数时（函数在 gauss.m 文件中）：

```
filter = gauss(31, 10, pi/2);
imagesc(filter) 
```

它适用于 pi/3, pi/6 vs. 但是当我发送 3pi/4, 0, pi 或 2*pi 作为参数时，它只显示一条直线。我的代码有什么问题，我不明白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:41:53.983

旋转变换为：

```
x2 = cos(theta)*(x)-sin(theta)*(y);
y2 = sin(theta)*(x)+cos(theta)*(y);  % last term is not cos(theta)*(x) 
```

# algorithm - 如何找到节点之间的最短路径？

> ID：16123821
> 
> 赞同：4
> 
> 时间：2013-04-20T18:35:39.490
> 
> 标签：algorithm, math, graph-theory, graph-algorithm, shortest-path

我正在开发一个地图应用程序，它可以找到用户想要的东西之间的最短路径。用户想要的每样东西（例如面包或汽油）都有多个可能的位置。目前，我只是在规划用户和每个项目的最接近用户的实例之间的路线，但是；这并不总是最好的路线。如下图所示，最快的路线有时涉及访问更远节点的集群： ![在此处输入图像描述](https://i.stack.imgur.com/FBFqT.png) 对于每个项目，我有多达 50 个可能的节点（位置）。如何规划访问每个节点的最短路径（以任何顺序）？虽然指向如何解决这个问题的具体示例的指针会很棒，但我真正要寻找的只是一个开始解决这个问题的正确方向的点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:44:36.413

可以通过引入一个新图*G'*来找到该问题的解决方案：

*   *G'*中的节点是通过原始图的简单路径
*   当两个节点对应于部分路径 p 和 p' 时，在两个节点之间存在一条边，可以*通过*向其*添加*节点将 p' 扩展为*p* *'*。

在这个图表中（它很大，所以不要在内存中明确表示它），您可以使用类似 A* 搜索的方式找到您想要的游览。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:50:58.780

## 少量物品

如果您的项目数量很少，您可以通过在新图表上使用 Djikstra 来解决它。

为每个位置组合和您收集的项目创建一个节点。

使用 Djikstra 找到从起点到收集所有项目的任何节点的最短路线。

对于 L 个位置和 N 个项目，这些新节点将有 L*2^(N-1) 个，因此这仅适用于小 N。

## 大量项目

我发现蚁群优化对于我最近看到的一个类似[问题](https://stackoverflow.com/questions/15485473)给出了非常好的结果，所以这可能也值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T19:18:12.637

您可能想查看[本论文](http://www.diegm.uniud.it/ceschia/uploads/bibliography/Sara_phdthesis.pdf)的第 3 章，了解解决车辆路径问题的技术概述。

首先，我会根据每个节点到下一个最近的资源节点的距离为每个节点分配一个权重，例如，距离 Bread 节点 5 且距离 Walmart 节点距离 8 的 Gas 节点的权重为 13；现在转到权重最小的 Gas 节点 + 与当前位置的距离。

这种启发式的问题在于它没有考虑 Bread 和 Walmart 节点之间的距离——它们可能彼此相邻，或者它们之间的距离可能达到 13。另一种启发式方法是找到由 Gas-Bread-Walmart 三角形（或正方形或五边形等，具体取决于您需要访问的位置类型）形成的子图的[质心](http://en.wikipedia.org/wiki/Centroid)，将质心到点的距离相加子图，并将其用作顶点权重。

# ios - JASidePanel iOS：导航栏上的样式左按钮

> ID：16123823
> 
> 赞同：1
> 
> 时间：2013-04-20T18:35:53.290
> 
> 标签：ios, uinavigationbar, uibarbuttonitem

所以我一直在尝试为导航栏上的左栏按钮设置样式。主要是我不想取消样式的按钮样式（与设置为自定义的 UIButton 样式相同的样式）。

有谁知道怎么做？谢谢你，詹姆斯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-20T19:10:45.300

在 JASidePanelController.m 中查看这个函数

```
+ (UIImage *)defaultImage {
    static UIImage *defaultImage = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        UIGraphicsBeginImageContextWithOptions(CGSizeMake(20.f, 13.f), NO, 0.0f);

        [[UIColor blackColor] setFill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 0, 20, 1)] fill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 5, 20, 1)] fill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 10, 20, 1)] fill];

        [[UIColor whiteColor] setFill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 1, 20, 2)] fill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 6,  20, 2)] fill];
        [[UIBezierPath bezierPathWithRect:CGRectMake(0, 11, 20, 2)] fill];   

        defaultImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

    });
    return defaultImage;
} 
```

这是在 customButton 上制作 3 行的部分。

它被这个调用：

```
- (UIBarButtonItem *)leftButtonForCenterPanel {
    return [[UIBarButtonItem alloc] initWithImage:[[self class] defaultImage] style:UIBarButtonItemStylePlain target:self action:@selector(toggleLeftPanel:)];
} 
```

因此，使其自定义是例如：

```
- (UIBarButtonItem *)leftButtonForCenterPanel {
UIImage *faceImage = [UIImage imageNamed:@"facebook.png"];
UIButton *face = [UIButton buttonWithType:UIButtonTypeCustom];
face.bounds = CGRectMake( 0, 0, faceImage.size.width, faceImage.size.height );
[face setImage:faceImage forState:UIControlStateNormal];
[face addTarget:self 
             action:@selector(toggleLeftPanel:) 
   forControlEvents:UIControlEventTouchUpInside];
return [[UIBarButtonItem alloc] initWithCustomView:face];
} 
```

请根据您的情况进行更改。希望这可以帮助...

# asp.net-mvc - 没有数据库的 ASP MVC 成员资格

> ID：16123824
> 
> 赞同：1
> 
> 时间：2013-04-20T18:35:59.080
> 
> 标签：asp.net-mvc, asp.net-membership, database-connection, membership-provider

是否可以在没有数据库的情况下使用 WebSecurity 或 SimpleMembersshipProvider？这主要是因为我的 Web 服务器将使用来自“中央服务器”的所有逻辑，而不是直接访问数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T21:52:33.187

当然。请参阅如何实现自定义会员提供程序：http: [//www.codeproject.com/Articles/165159/Custom-Membership-Providers](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)

基本上你需要做的是继承 MembershipProvider 类并实现 ValidateUser 等基本方法，一旦完成在 web.config 中注册新的提供者。您可以使用任何您喜欢的数据存储。

另一种选择是手动处理用户身份验证并使用 FormsAuthentication.Authenticate() 发送带有用户请求的身份验证 cookie。此方法也适用于 [Authorize] 过滤器，如果您愿意，我可以向您发送代码示例。

编辑：

```
public class CustomAuthorizeFilter : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var authenCookie = httpContext.Request.Cookies.Get(FormsAuthentication.FormsCookieName);
        if (authenCookie == null) return false;

        return true;
    }

    protected override void HandleUnauthorizedRequest(AuthorizationContext filterContext)
    {
        filterContext.Result = new RedirectResult("/");
    }
} 
```

登录方式：

```
var ticket = new FormsAuthenticationTicket(1, // version 
                                   token, // user name
                                   DateTime.Now, // create time
                                   DateTime.Now.AddDays(1), // expire time
                                   model.RememberMe, // persistent
                                   ""); // user data, such as roles
var strEncryptedTicket = FormsAuthentication.Encrypt(ticket);
var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, strEncryptedTicket);
Response.Cookies.Add(cookie); 
```

# python - Django RateLimit 403 页面没有被替换

> ID：16123825
> 
> 赞同：2
> 
> 时间：2013-04-20T18:36:07.640
> 
> 标签：python, django, rate-limiting, ratelimit

我已经在我的项目上设置了 django-ratelimit，它似乎工作正常，除了当访问者达到他们的限制时我无法删除丑陋的 403 错误页面。正如他们在他们的文档中所说的那样，我正在尝试替换它，内容如下：

> 有一个可选的中间件可以使用自定义视图来处理 Ratelimited 异常。要使用它，请将 ratelimit.middleware.RatelimitMiddleware 添加到您的 MIDDLEWARE_CLASSES（靠近列表底部）并将 RATELIMIT_VIEW 设置为您要使用的视图的完整路径。
> 
> RATELIMIT_VIEW 中指定的视图将获得两个参数，请求对象（在 ratelimit 处理之后）和异常。

这是我的代码中的内容：

设置：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
    'ratelimit.middleware.RatelimitMiddleware',
)

RATELIMIT_VIEW = 'myapp.views.beenLimited'

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
    'myapp',
    'ratelimit',
)

RATELIMIT_USE_CACHE = 'default'

CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
        'LOCATION': 'ratelimit-tests',
    },
} 
```

意见：

```
from ratelimit.decorators import ratelimit

@ratelimit(method='POST', block=True, rate='10/m')
def pullFromDatabase(request):
...

def beenLimited(request):
    message = "A few too many tries for today buddy. Please try again tomorrow."
    HttpResponse(message) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T19:08:49.977

我不确定这是否有帮助，但尝试修复`beeLimited`视图以更正一个

```
def beenLimited(request, exception):
    message = "A few too many tries for today buddy. Please try again tomorrow."
    return HttpResponse(message) 
```

另一种方法是检查视图中的`request.limited`属性`pullFromDatabase`。这将需要 set `block=True`。

# php - PHP中的多个复选框过滤器

> ID：16123826
> 
> 赞同：0
> 
> 时间：2013-04-20T18:36:14.267
> 
> 标签：php, sql, filter, checkbox

我一直试图弄清楚这一点，但我没有得到任何结果。我已经阅读了这里和互联网上发布的许多其他问题，但无法找到解决方案。特别是在使用多个复选框的情况下。

当我试图解释我面临的问题时，请耐心等待。

在一个页面上，我有一个人员列表及其相应的位置，我使用 php/sql 从数据库中提取。我想要实现的是能够使用复选框根据位置过滤列表。

这是我目前用于复选框的代码。

```
<ul>
    <li><input type="checkbox" name="check_list[]" value="sydney">Sydney</li>
    <li><input type="checkbox" name="check_list[]" value="durban">Durban</li>
    <li><input type="checkbox" name="check_list[]" value="delhi">Delhi</li>
    <li><input type="checkbox" name="check_list[]" value="cairo">Cairo</li>
    <li><input type="checkbox" name="check_list[]" value="madrid">Madrid</li>
    <li><input type="submit"></li>
</ul> 
```

这是我用来检查复选框是否被选中并相应地修改 SQL 查询的代码

```
if (empty ($_POST['check_list'])) {

    $SQLquery = 'SELECT * FROM `people`';
    $query = $conn->query($SQLquery);

} elseif (!empty($_POST['check_list'])) {

    foreach($_POST['check_list'] as $check)

    $location = $check;

    $query = $conn->prepare('SELECT * FROM `people` WHERE `p_location` = :location');
    $query->execute(array('location' => $location));

} 
```

现在，当仅选中一个复选框时，此代码可以正常工作。但是，当检查多个复选框时，这将失败。它什么也没显示。

我知道我可以使用`OR`运算符修改 SQL 查询以添加其他位置，如下所示：

```
$query = $conn->prepare('SELECT * FROM `people` WHERE `p_location` = 'Delhi' OR `p_location` = 'Madrid') 
```

但是，我无法弄清楚如何首先检查选中了哪些所有复选框，然后以一种在选择多个城市时过滤结果的方式创建 SQL 语句。

我也想知道这是否是实现此类目标的最佳方法。我对在 php/sql 范围内实现这一目标的替代方法持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:43:38.257

未经测试，但应该让你知道你应该做什么。

答案已修改！

```
$markers = str_repeat('?, ', count($_POST['check_list']) - 1) . '?';

$query = $conn->prepare('SELECT * FROM `people` WHERE `p_location` IN (' . $markers . ')');
$query->execute($_POST['check_list']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:51:01.767

试试这个方法：

```
if (empty ($_POST['check_list'])) {

    $SQLquery = 'SELECT * FROM `people`';
    $query = $conn->query($SQLquery);

} else if (!empty($_POST['check_list'])) {
    $params = implode(",", array_fill(0, count($_POST['check_list']), "?"));

    $sql = 'SELECT * FROM `people` WHERE `p_location` IN ($params)';

    $stmt   = $conn->prepare($sql);

    $stmt->execute($_POST['check_list']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:40:56.970

做这样的事情

```
where p_location in (the values for your checkboxes) 
```

# javascript - 如果源设置为透明像素，则图像标签背景图像不显示

> ID：16123832
> 
> 赞同：0
> 
> 时间：2013-04-20T18:37:37.200
> 
> 标签：javascript, css, image, background-image, sprite

在将 src 属性设置为透明像素后，我在 img 标签上显示背景图像时遇到了一些问题。

HTML：

```
<img class="test-class" src="http://upload.wikimedia.org/wikipedia/commons/e/e7/Mozilla_Firefox_3.5_logo_256.png"> 
```

CSS：

```
.test-class {
    border: 1px black solid;
    width: 256px;
    height: 256px;
} 
```

JavaScript：

```
var transparentPng = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAE0lEQVR4XgXAAQ0AAABAMP1L38IF/gL+/AQ1bQAAAABJRU5ErkJggg==";
var spriteUrl = "url(http://upload.wikimedia.org/wikipedia/commons/9/9a/Google_Chrome_screenshot.png)"

// Why doesn't background image show?
$(".test-class").attr("src", transparentPng);

// It does show if src is set to a broken URL, though.
//$(".test-class").attr("src", "invalidurl");

$(".test-class").css("background-image", spriteUrl); 
```

这是一个现场测试用例：http: [//jsfiddle.net/rmjaD/1/](http://jsfiddle.net/rmjaD/1/)

我真正想做的是显示一个精灵，但是由于精灵图像会非常大并且只会在事件中显示，所以我使用图像标签的 src 属性来显示初始图像。当事件发生时，我想用精灵替换该图像。为此，我的想法是用透明像素替换源图像并设置背景图像。但由于某种原因，背景图像没有显示出来。

你能告诉我我需要在测试用例中更改什么以使更大的图像（代表精灵）可见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:53:17.677

您使用的图像似乎有问题。

使用此图像。有用。

```
var transparentPng = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII="; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T19:23:59.047

base64 图像以某种方式损坏，请参阅[http://jsfiddle.net/David_Knowles/3SvJU/](http://jsfiddle.net/David_Knowles/3SvJU/)

```
var transparentPng = "data:image/gif;base64,R0lGODlhEAAQAMQAAORHHOVSKudfOulrSOp3WOyDZu6QdvCchPGolfO0o/XBs/fNwfjZ0frl3/zy7////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAABAALAAAAAAQABAAAAVVICSOZGlCQAosJ6mu7fiyZeKqNKToQGDsM8hBADgUXoGAiqhSvp5QAnQKGIgUhwFUYLCVDFCrKUE1lBavAViFIDlTImbKC5Gm2hB0SlBCBMQiB0UjIQA7"; 
```

# jquery - Nikebetterworld 视差效果演示：图像尺寸

> ID：16123833
> 
> 赞同：0
> 
> 时间：2013-04-20T18:37:37.730
> 
> 标签：jquery, css, parallax

我正在尝试调整[Nikebetterworld 视差效果演示](http://ianlunn.co.uk/articles/recreate-nikebetterworld-parallax/)以适应我的网站需求，但是当我将演示中给出的图像更改为我需要的图像时，它们似乎以某种方式重叠并相互隐藏。我尝试在 CSS 中使用 height 属性，但没有成功。[你可以在这里](http://froindster.com/demo/)看到它的作用

任何想法我应该如何为每个部分使用不同的图像尺寸？

谢谢，丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T19:09:53.467

您是否尝试将第二个 Div 的位置设置为`relative`？似乎背景`#second`开始在页面更高的位置，也许尝试设置它的[背景位置](http://www.w3schools.com/cssref/pr_background-position.asp)：

```
background-position:top; 
```

请记住，这个插件基本上是制作Div移动负载的背景。Div 像普通网页一样从上到下排列，但它们各自的背景移动到内部，以及任何后续引用的图像。考虑到这一点，只要背景图像大小超过 Div 大小并且在正确的位置，你应该没问题

# c++ - 当数组大小太大时，C++ 程序停止工作

> ID：16123842
> 
> 赞同：0
> 
> 时间：2013-04-20T18:39:33.367
> 
> 标签：c++, visual-c++, visual-c++-2010

我在 MVC++ 2010 中用 C++ 编写了代码。在其中，程序迭代一维指针数组（双 *）的元素。但是，当我将输入（指针数组的大小）设置为非常大（例如 15000）并运行程序时，它会停止工作并显示一个窗口来关闭程序，因为它没有响应！有什么问题？

这是构建我正在谈论的数组的代码的一部分：

```
map<int, double *> CF;
CoefficientMap(CF);

double *T = new double[I * J];
for (int r = 1; r <= I * J; ++r)
    T[r] = 100;
SOR(T, CF, 1.8); 
```

这是迭代器函数：

```
void SOR(double *T, map<int, double *> &CF, double w)
{
int iter = 0;
cout << "Stage 2: Solving the linear system of equations using SOR method... ";

const double tol = 0.00001;
double error = tol + 1;

double *TOld = new double[I * J];
for (int i = 1; i <= I * J; ++i)
    TOld[i] = 100;

while (abs(error) > tol)
{
    ++iter;
    for (int i = 1; i <= I * J; ++i)
        T[i] = (CF[i][0] + CF[i][1] * T[i + 1] + CF[i][2] * T[i + J] + CF[i][3] * T[i - J] + CF[i][4] * T[i - 1]) * w + (1 - w) * T[i];

    error = errorCalc(TOld, T, I * J);

    for (int i = 1; i <= I * J; ++i)
        TOld[i] = T[i];

    if (iter % 100 == 0)
    {
        cout << endl << endl;
        cout << "100 iterations done, please wait..." << endl << "Total accumulative error till this point: " << error << endl;
    }

    if (iter > 10000)
        return;
}

cout << "Done!" << endl << endl;
cout << "Converged after " << iter << " iterations!" << endl;
cout << "Final accumulative error: " << error << endl << endl; 
```

}

现在，当 (I * J) 变得足够大（例如 15000）时，程序停止工作！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:43:50.353

最可能的解释是，您的堆栈空间不足。简单的解决方法是使数组静态或全局。您也可以`new`从堆中分配它。两者都将数组移出堆栈。

最好的可能是使用智能指针并将其放入堆中：

```
std::unique_ptr<double[]> arrayOfDoubles(new double[size]); 
```

当智能指针变量超出范围时，这将负责释放内存，无需手动删除。

为了获得更好的答案，请编辑问题以包含代码...

* * *

您添加的代码至少在数组索引方面存在问题。索引从 0 开始，数组大小减一。正确循环：

```
double *T = new double[I * J];
for (int r = 0; r < I * J; ++r)
    T[r] = 100; 
```

你在其他循环中也有同样的错误，同样的修复。

替代解决方案：如果您想从 1 开始索引（例如，因为您以这种方式编写了伪代码算法并且不想更改索引），最简单的方法是分配一个更大的数组而不使用索引 0：

```
double *T = new double[I * J + 1]; 
```

有了它，您可以使用当前的循环。

* * *

这种缓冲区溢出一个数组元素是令人讨厌的，因为通常在分配的内存块的末尾可能有未使用的空间，因此在您更改数组大小并且未使用的空间消失之前，错误可能会完全被忽视。即使溢出导致堆损坏，它也可能被忽视，直到您更改代码和损坏更改的效果。因此，例如，如果您不走运，添加调试代码可能会隐藏问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T18:44:15.163

听起来您正在堆栈上分配一个普通数组，如下所示：

```
void f()
{
    double a[123456];
    ...
} 
```

堆栈的大小是有限的 - 您应该分配`new`或（更好）使用 a `std::vector`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T18:53:52.353

您在堆栈上分配了太多空间，因此没有足够的内存来满足您的请求。作为替代方案，您可以为对象提供静态存储持续时间，或者您可以将其放在免费存储中`new`：

```
std::unique_ptr<int[]> ptr(new int[size]); 
```

# ruby-on-rails - FactoryGirl Rspec 的模型验证失败，验证似乎被忽略

> ID：16123843
> 
> 赞同：0
> 
> 时间：2013-04-20T18:39:49.537
> 
> 标签：ruby-on-rails, validation, rspec

我的 Rails 模型验证测试有问题。验证正常运行（它拒绝格式不正确的电子邮件），但测试失败。

这是我的 user.rb 模型中的重要信息

```
class User < ActiveRecord::Base

  attr_accessible :first_name, :middle_name, :last_name, :email, :password, :address, :city, :state, :zip_code, :phone_home, :phone_cell, :phone_work, :status_id, :password_confirmation, :is_test, :parent_paramed_id, :company, :logo, :is_agent, :is_paramed, :additional_emails

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i

  validate :validates_single_email_format
  validates_presence_of :email
  validates_uniqueness_of :email

  def validates_single_email_format
    User.validates_single_email_format(self.email)
  end

  def self.validates_single_email_format(email)
    email =~ VALID_EMAIL_REGEX
  end 
```

这是我的 user_spec.rb

```
describe User do
  context "validate email address on create" do
    before { User.delete_all }

    context "fails" do
      let(:user) { FactoryGirl.build(:user, :email => 'blah') }
      before { user.save; binding.pry }
      specify { user.should_not be_valid }
    end

    context "succeeds" do
      let(:user) { FactoryGirl.build(:user, :email => 'matt@google.com' ) }
      before { user.save; binding.pry }
      specify { user.should be_valid }
    end

  end
end 
```

这是此测试的输出，因为它在每次保存后使用 binding.pry 执行，以查看调用保存后用户对象的样子：

```
From: /project/spec/models/user_spec.rb @ line 96 :

     91:   context "validate email address on create" do
     92:     before { User.delete_all }
     93:
     94:     context "fails" do
     95:       let(:user) { FactoryGirl.build(:user, :email => 'blah') }
 =>  96:       before { user.save; binding.pry }
     97:       specify { user.should_not be_valid }
     98:     end
     99:
    100:     context "succeeds" do
    101:       let(:user) { FactoryGirl.build(:user, :email => 'matt@google.com' ) }

[1] pry(#<RSpec::Core::ExampleGroup::Nested_1::Nested_4::Nested_1>)> user
=> #<User id: 178, first_name: "Martha", middle_name: nil, last_name: "Magdalena", email: "blah", additional_emails: nil, password_hash: "$2a$10$HF1t3cIwQiwj7PN/DkBgwOJw667FFixFB3srksZypHxR...", password_salt: "$2a$10$HF1t3cIwQiwj7PN/DkBgwO", password_reset_token: nil, password_reset_sent_at: nil, address: nil, city: nil, state: nil, zip_code: nil, phone_home: nil, phone_cell: nil, phone_work: nil, status_id: 1, is_test: false, parent_paramed_id: nil, company: nil, logo: nil, is_agent: true, is_paramed: false, created_at: "2013-04-20 18:13:02", updated_at: "2013-04-20 18:13:02">
[2] pry(#<RSpec::Core::ExampleGroup::Nested_1::Nested_4::Nested_1>)> exit
F
From: /project/spec/models/user_spec.rb @ line 102 :

     97:       specify { user.should_not be_valid }
     98:     end
     99:
    100:     context "succeeds" do
    101:       let(:user) { FactoryGirl.build(:user, :email => 'matt@google.com' ) }
 => 102:       before { user.save; binding.pry }
    103:       specify { user.should be_valid }
    104:     end
    105:
    106:   end
    107:

[1] pry(#<RSpec::Core::ExampleGroup::Nested_1::Nested_4::Nested_2>)> user
=> #<User id: 179, first_name: "Martha", middle_name: nil, last_name: "Magdalena", email: "matt@google.com", additional_emails: nil, password_hash: "$2a$10$LEA28MGLIdLuk6lPEPGmH.lW3QwkR9KoXgbULPHJZa4v...", password_salt: "$2a$10$LEA28MGLIdLuk6lPEPGmH.", password_reset_token: nil, password_reset_sent_at: nil, address: nil, city: nil, state: nil, zip_code: nil, phone_home: nil, phone_cell: nil, phone_work: nil, status_id: 1, is_test: false, parent_paramed_id: nil, company: nil, logo: nil, is_agent: true, is_paramed: false, created_at: "2013-04-20 18:13:11", updated_at: "2013-04-20 18:13:11">
[2] pry(#<RSpec::Core::ExampleGroup::Nested_1::Nested_4::Nested_2>)> exit
.

Failures:

  1) User validate email address on create fails
     Failure/Error: specify { user.should_not be_valid }
       expected valid? to return false, got true
     # ./spec/models/user_spec.rb:97:in `block (4 levels) in <top (required)>'

Finished in 16.9 seconds
2 examples, 1 failure

Failed examples:

rspec ./spec/models/user_spec.rb:97 # User validate email address on create fails 
```

出于某种原因，失败的测试返回 true，即使它认为电子邮件值为“blah”。如果我在对象上运行验证方法，它会通过说不匹配来响应。但由于某种原因，“预期有效？” 测试返回真。我不确定为什么会发生这种情况。

任何帮助将不胜感激。我可以在现有问题中找到任何类似的问题。

编辑：删除路径中的计算机特定信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:20:22.990

两件事情。您的`validates_single_email_format`方法不仅需要 return `false`，还必须调用`errors.add(:email, "Email is in wrong format!")`才能产生效果。

该`valid?`方法不仅运行验证，还将错误消息添加到最后`errors`并`errors`为空，则认为模型有效。

无论如何，您可以使用：

```
validates_format_of :email, with: VALID_EMAIL_REGEX 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T07:09:03.990

验证的语法不正确。在两行中尝试这个正确的一个。

```
EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
validates :email, presence: true, uniqueness: true, format: {with: EMAIL_REGEX} 
```

# javascript - 在 javascript 中访问 HTML 表单值

> ID：16123847
> 
> 赞同：1
> 
> 时间：2013-04-20T18:40:06.727
> 
> 标签：javascript

这是我想要实现的目标，但由于某种原因，它不起作用：

**Javascript：**

```
<script type="text/javascript">         
  function  calculate() {             
     var n1 = getElementById("1").value
     var n2 = getElementById("2").value
     var answer = n1+n2
     alert(answer)
  }
</script> 
```

**HTML：**

```
<form id="form">
<input id="1" type="text" />
<input id="2" type="text" />
<input type="button onClick="calculate()" value="Go" />
</form> 
```

我不确定我哪里出错了，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:41:25.793

您不应该以数字开头 ID - 在 HTML4 和 CSS 中[是不允许](http://www.w3.org/TR/html4/types.html)的，在 HTML5 中是允许的，但这样做不是一个好习惯。

此外，*在这种*情况下，它在 HTML5 中是非法的 - 因为以数字开头的 ID 后面[至少需要一个字母](http://www.w3.org/html/wg/drafts/html/master/dom.html#the-id-attribute)。

因此，首先用字母/单词替换编号的 ID。

* * *

除此之外，您需要修复下面提到的语法错误：

替换`getElementById("id").value`为`document.getElementById("id").value;`

并替换`<input type="button onClick="calculate()" value="Go" />`

with `<input type="button" onClick="calculate()" value="Go" />`（注意有一个结尾`"`缺少`"button"`）。

**这是一个工作** [**jsFiddle**](http://jsfiddle.net/mubd8/1/)。

* * *

这是 jsFiddle 中使用的代码：

**Javascript：**

```
function  calculate() {
   var n1 = document.getElementById("aItem").value;
   var n2 = document.getElementById("bItem").value;
   var answer = n1+n2;
   alert(answer);
} 
```

**HTML：**

```
<form id="form">
   <input id="aItem" type="text" />
   <input id="bItem" type="text" />
   <input type="button" onClick="calculate()" value="Go"/>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T19:04:43.800

HTML：

```
<input id="val1" type="text" value="100" />
<input id="val2" type="text" value="200"/>
<input type="button" onclick="calculate()" value="Go" /> 
```

JavaScript：

```
function  calculate() {
          var n1 = +(document.getElementById("val1").value);
          var n2 = +(document.getElementById("val2").value);
          var answer = n1+n2;
          alert(answer);
         } 
```

这将添加输入的 2 个数值，而不是将它们连接起来。

# php - 像 php POST 这样的 Javascript 函数

> ID：16123848
> 
> 赞同：1
> 
> 时间：2013-04-20T18:40:07.703
> 
> 标签：php, php, javascript, jquery, twitter-bootstrap

我有一个用 Bootstrap 构建的输入表单。正确数据的检查由 javascript 处理，并设置为单击“提醒我”按钮会弹出一个通知，提示一切正确。弹出通知的最后一部分由 php POST 方法处理，我希望显示相同的弹出窗口，但使用 javascript 而不是[php](/questions/tagged/php "显示标记为“php”的问题")。

HTML 是：

```
 <form class="form-horizontal" id="registerHere" method='post' action=''>
  <fieldset>
    <div class="control-group">
      <div class="controls">
        <input type="text" class="span3" id="user_name" name="user_name" rel="popover" data-content="Enter your first and last name." data-original-title="Full Name" placeholder="First name Last name">

      </div>
</div>

 <div class="control-group">
      <div class="controls">
        <input type="text" class="span3" id="user_email" name="user_email" rel="popover" data-content="What’s your email address?" data-original-title="Email" placeholder="me@somewhere.com">

      </div>
</div>

<div class="control-group">
<div class="controls controls-row">
    <input type="text" class="span1" id="inputPLZ" name="inputPLZ" placeholder="Postal" data-content="Insert your area postal code.">
    <input type="text" class="span2" id="inputOrt" name="inputOrt" placeholder="Place" data-content="Where are you from?">
</div>
</div>

<div class="control-group">
    <label class="control-label" for="input01"></label>
      <div class="controls">
       <button type="submit" class="btn btn-success" rel="tooltip" title="first tooltip">Remind me</button>

      </div>

</div>

  </fieldset>
</form> 
```

和 Javascript 是

```
 <script type="text/javascript">
  $(document).ready(function(){
        $('#registerHere input').hover(
            function(){
        $(this).popover('show')
            },
            function(){
        $(this).popover('hide') 
            }
        );
        $("#registerHere").validate({
            rules:{
                user_name:"required",
                user_email:{
                        required:true,
                        email: true
                    },
            },
            messages:{
                user_name:"Enter your first and last name",
                user_email:{
                    required:"Enter your email address",
                    email:"Enter valid email address"
                },
            },
            errorClass: "help-inline",
            errorElement: "span",
            highlight:function(element, errorClass, validClass) {
                $(element).parents('.control-group').addClass('error');
            },
            unhighlight: function(element, errorClass, validClass) {
                $(element).parents('.control-group').removeClass('error');
                $(element).parents('.control-group').addClass('success');
            }
        });
    });
  </script> 
```

这是我想用 Javascript 替换的 PHP 部分：

```
 <?php if($_POST) { ?>
<div class="alert alert-success">
  Thanks, we have your info, and expect our contact really soon!
</div>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:58:05.340

你说的逻辑不正确。[服务器端](/questions/tagged/server-side "显示标记为“服务器端”的问题")的耳朵是 PHP。没有 PHP 就不可能知道发布的表单和数据是否传递到服务器。

# c++ - 如何“选择”当前目录？

> ID：16123853
> 
> 赞同：0
> 
> 时间：2013-04-20T18:40:54.900
> 
> 标签：c++, macos

我正在写一个比例计算器。在程序开始时，它从同一文件夹中的 .txt 加载一个 ascii 文本艺术图片。

这是我的做法：

```
//Read picture
string line;
ifstream myfile("/Users/MYNAME/Desktop/MathScripts/Proportions/Value Finder/picture.txt");
if (myfile.is_open()) {
  while (!myfile.eof()) {
    getline(myfile, line);
    cout << line << endl;
  }
  myfile.close();
} else cout << "Unable to load picture!!!" << endl;
//Finish reading txt 
```

我听说如果 .txt 在同一个文件夹中，您可以只使用名称而不必说目录。代替的意思

```
/Users/MYNAME/Desktop/MathScripts/Proportions/Value Finder/picture.txt 
```

我可以只使用“picture.txt”。这对我不起作用，我希望用户能够在“Value Finder”文件夹中移动而无需编辑任何代码。

我在**Mac**上，我正在使用**CodeRunner**；有什么奇怪的吗？

请不要告诉我要确保 picture.txt 与我的代码在同一个文件夹中。这是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:37:56.963

为了在`picture.txt`不使用完全限定路径的情况下打开它，它必须驻留在当前工作目录中。当 IDE 启动应用程序时，它会将当前工作目录设置为应用程序所在的目录。如果与应用程序位于`picture.txt`不同的目录中，您将无法仅使用其名称打开它。如果您需要获取当前工作目录，可以[`getcwd`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/getcwd.3.html)这样调用。

```
char temp[MAXPATHLEN];
getcwd(temp, MAXPATHLEN); 
```

如果你想让用户指定哪个目录`picture.txt`在你可以让他们在命令行上传递一个参数。然后，您可以使用提供的目录和图片文件名创建一个完全限定的路径。

```
int main(int argc, const char **argv)
{
    // Add some logic to see if the user passes a path as an argument
    // and grab it. here we just assume it was passed on the command line.
    const string user_path = arg[1];

    //Read picture
    string line;
    ifstream myfile(user_path + "/picture.txt");
    if (myfile.is_open())
    {
        while (!myfile.eof()) {
            getline(myfile, line);
            cout << line << endl;
        }
        myfile.close();
    }
    else
    {
        cout << "Unable to load picture!!!" << endl;
    }
    //Finish reading txt

    return 0;
} 
```

现在您可以执行以下操作：

```
myapp "/user/USERNAME/Desktop/MathScripts/Proportions/Value Finder" 
```

它将在该目录中查找该`picture.txt`文件。（因为路径名中有空格，所以需要引号）。

注意：您可以调用`setcwd()`更改应用程序的当前工作目录。

# java - 将动作侦听器添加到另一个类中的 jbutton

> ID：16123859
> 
> 赞同：0
> 
> 时间：2013-04-20T18:41:26.710
> 
> 标签：java, swing, model-view-controller, jbutton, actionlistener

我正在尝试根据 MVC 设计模式对我的小项目进行建模。因此，我试图将我的 JButton(submit)（在 UI 类中）的 ActionListener 分配给模型类中的评估方法，我在下面的第三类（控制器）代码中执行所有这些操作。

```
public class ExpressionController implements ActionListener {

ExpressionModel model;
ExpressionUI view;

public ExpressionController(ExpressionModel m, ExpressionUI v) {
    model = m;
    view = v; 

            //ERROR: The method is undefined for the type Expression Controller
    actionListenerComponenets(this);
}

@Override
public void actionPerformed(ActionEvent e) {
    try {
        double result;
        result = model.evaluate(Double.parseDouble(view.input.getText()));
        view.result.setText(String.valueOf(result));
    }catch (Exception ex) {
        ex.printStackTrace();
    }

}
public void actionListenerComponenents(ActionListener ae) {
    view.submit.addActionListener(ae); 
} 
```

我的问题是在 UI 类之外分配动作侦听器（请参阅代码中的注释）......有没有更好的方法来做到这一点？我知道这只是一个简单的例子，但我想熟悉 MVC 设计。

# java - Spring JDBCTemplate 更新语句

> ID：16123867
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:42:49.213
> 
> 标签：java, spring, spring-jdbc

在 Spring 中有一个如下配置的数据源。

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" 
      destroy-method="close">
    <property name="driverClassName" value="${prop_jdbc.driverClassName}"/>
    <property name="url" value="${prop_jdbc.url}"/>
    <property name="username" value="${prop_jdbc.username}"/>
    <property name="password" value="${prop_jdbc.password}"/>
    <property name="initialSize" value="2"/>
    <property name="maxActive" value="5"/>
    <property name="maxIdle" value="2"/>
    <property name="poolPreparedStatements" value="true"/>
    <property name="maxOpenPreparedStatements" value="-1"/>
    <!-- property name="defaultAutoCommit">
       <value>false</value>
    </property-->
</bean> 
```

现在，我首先使用从上面的数据源创建的 jdbcTemplate 进行 DROP TABLE，然后在下一个语句中，我再次创建相同的 TABLE，最后尝试在第三个语句中立即 DROP 它。

```
jdbcTemplate.update( dropSql,new Object[] { });
jdbcTemplate.update( createSql,new Object[] { });
jdbcTemplate.update( dropSql,new Object[] { }); 
```

## 在@Brian 评论后编辑

在第一条语句之后，表立即被删除，第二条语句也立即创建它，但第二次，DROP 没有发生..也没有错误..

JdbcTemplate 是否立即或定期执行 DROP，因为这很难理解，使用相同的数据源为什么不发生第二次 DROP 时第一次发生 2 行之前..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T23:32:31.877

DDL - 像创建和删除一样不是事务性的。请分享正在执行的实际 ddl。我建议在没有实际的 SQL 审查的情况下使用执行方法而不是 jdbcTemplate 上的更新方法。

您在代码的每次失败尝试之间删除表是做什么的？

# c++ - 截断浮点数，使其只有两位小数

> ID：16123874
> 
> 赞同：2
> 
> 时间：2013-04-20T18:43:42.290
> 
> 标签：c++, floating-point, truncate, rounding, fractions

**C++**

我想`cout` `float f = 2.3333`，但只有两位小数。我怎么做？我记得这样的事情，但它不起作用：

```
cout << f:2 << endl; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T18:47:30.133

使用流操纵器[`fixed`](http://en.cppreference.com/w/cpp/io/manip/fixed)和[`setprecision`](http://en.cppreference.com/w/cpp/io/manip/setprecision)：

```
#include <iomanip>

float f = 2.3333;
std::cout << std::setprecision(2) << std::fixed << f; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T05:30:05.587

我设法在没有 iomanip 的情况下解决了它：

```
cout << (((int)f*100) % 100)/100; 
```

# php - Gmail Star 喜欢使用 jQuery 做书签

> ID：16123877
> 
> 赞同：2
> 
> 时间：2013-04-20T18:43:52.420
> 
> 标签：php, javascript, jquery, ajax

我正在尝试使用 jQuery 创建一个像书签一样的明星。不幸的是，我所拥有的只是一种方式。这意味着如果一个链接没有加星标，那么它会成功加注星标，但是如果一个链接已经加星标并且我想取消星标，那么星标图像会从页面上完全消失，但是在后端它确实有效，但在前端星号图像完全消失。

我的 HTML 中有以下内容：

```
require_once('connection.inc.php');
$con = dbConnect('read');
$sql = "SELECT * FROM trn_bookmark";
$result = $con->query($sql) or die(mysqli_error());
while($row = $result->fetch_assoc()) {
    $className  = "star";
    if($row['bookmark_flag'] == 'Y'){
        $className = "favorited";
    }
    echo '<div id="'.$row['bookmark_id'].'"><a href="javascript:void(0);" class="'.$className.'"></a> <span>'.$row['bookmark_desc'].'</span></div>';
} 
```

CSS：

```
.star {
background-color: transparent;
background-image: url('star-off.png');
background-repeat:no-repeat;
display: block;  
height:16px;
width:16px;
float:left;
}
.favorited {
 text-indent: -5000px;
background-color: transparent;
background-image: url('star-on.png');
background-repeat:no-repeat;   
height:16px;
width:16px;
float:left;
} 
```

JavaScript 函数是这样的：

```
$(document).ready(function(){   
 $('.star,.favorited').click(function() {
        var id = $(this).parents('div').attr('id');             
        var className = $(this).attr('class');
        var flag  = (className=='star') ? 'Y':'N';
        var $this = $(this);
        $.ajax({
                type: "post",
                url: "conversation.php",
                cache: false,               
                data:{'bookmarkId': id,'flag':flag},
                success: function(response){
                    if(response=='true'){                               
                        $this.toggleClass("favorited");
                    }   
                },
                error: function(){                      
                    alert('Error while request..');
                }
             });
  });
}); 
```

而conversation.php：

```
$bookmarkId = $_POST['bookmarkId'];
$flag = $_POST['flag'];
require_once('connection.inc.php');
$con = dbConnect('read');
$stmt = $con->stmt_init();
$sql = "UPDATE trn_bookmark SET bookmark_flag = ? WHERE bookmark_id = '$bookmarkId'";
    if ($stmt->prepare($sql)) {
        $stmt->bind_param('s', $flag);
        $done = $stmt->execute();
    }

    echo 'true'; 
```

我已经上传了它，这样你就可以看到正在发生的事情。您可以在此链接中查看此处发生的情况：[http ://www.rytenet.com/starrating/index.php](http://www.rytenet.com/starrating/index.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T06:09:10.727

试试这个

当页面加载时，如果明星是最喜欢的，它会存储 $className = "favorited" 而不是 className="star favorited"

```
while($row = $result->fetch_assoc()) {
    $className  = "star";
    if($row['bookmark_flag'] == 'Y'){
        $className .= " favorited";
    }
    echo '<div id="'.$row['bookmark_id'].'"><a href="javascript:void(0);" class="'.$className.'"></a> <span>'.$row['bookmark_desc'].'</span></div>';
} 
```

# google-maps - 我的 Places API 返回“ZERO_RESULTS”

> ID：16123878
> 
> 赞同：0
> 
> 时间：2013-04-20T18:44:00.380
> 
> 标签：google-maps, google-places-api

我的网站显示 Gmap 的地点类别很少（咖啡馆、药房、银行等），有些类别总是返回“ZERO_RESULTS”，而只有两个返回结果。

这是一个很好的请求示例- `https://maps.googleapis.com/maps/api/js/PlaceService.FindPlaces?1m6&1m2&1d32.0644854235794&2d34.78186263896919&2m2&1d32.073468576420595&2d34.79246336103074&2siw&6sparking&callback=_xdc_._pocujy&token=76152`

这是一个错误请求的示例- `https://maps.googleapis.com/maps/api/js/PlaceService.FindPlaces?1m6&1m2&1d32.0644854235794&2d34.78186263896919&2m2&1d32.073468576420595&2d34.79246336103074&2siw&6sbank&callback=_xdc_._g07omw&token=49745`

如您所见，“坏”请求返回此-

`_xdc_._g07omw && _xdc_._g07omw( { "html_attributions" : [], "results" : [], "status" : "ZERO_RESULTS"` })

*   对于我地图上的任何位置，答案都是零（以色列地图）
*   这些地方确实存在并且应该出现（如在 maps.google.co.il 中）

你知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T10:58:27.497

这种行为的原因很可能是因为 Google 尚未将实际类别 ( `types`) 添加到其数据库中的所有位置。因此，例如，一个您实际上知道它应该返回的地方`"types" : [ "cafe", "restaurant", "establishment" ]`，它只会返回`"types" : [ "establishment" ]`。

因此，在包含缺失项之前`types`，一个不太精确的解决方法可能是按`name`或`keyword`参数过滤这些类别，这可能会增加返回（至少一些）相关结果的机会。

# inno-setup - InnoSetup，如何将自定义文本加载到 RTFText

> ID：16123879
> 
> 赞同：1
> 
> 时间：2013-04-20T18:44:06.320
> 
> 标签：inno-setup, pascal, rtf, pascalscript

我正在尝试将 InfoBefore 文本文件的文本存储到一个变量中，然后使用自定义字体颜色和背景色将其加载到 RTFEditor 中。

当我尝试从变量加载文本时，它显示“只写属性”

我需要一个明确的例子来说明如何一起做这两件事（将文本存储在 var 中，使用自定义颜色和背景色加载 RTF 中的文本）而不会使事情过于复杂，因为我不知道 Pascal。

这是代码：

```
const
 FontColor: AnsiString = 'cf0'; 
 BackColor: AnsiString = 'cf1'

 var
  OldText: AnsiString; 

procedure InitializeWizard();
begin

// I try to store the text in a variable
Oldtext := WizardForm.InfoBeforeMemo.RTFText; 

// I try to load from the variable, with a new font color for ALL the text, and a new BackColor.
WizardForm.InfoBeforeMemo.RTFText := Oldtext + FontColor

end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T21:37:47.453

与其在事后尝试修改它，只需在写字板中加载您的 .txt 文件，进行所需的格式更改，然后将其保存为 .rtf 格式。然后，您可以直接将此文件用作您的文件`InfoBeforeFile`，而无需使用任何代码。

编辑：如果你想改变整个备忘录的背景颜色，那么你仍然需要一行代码。例如：

```
[Code]
procedure InitializeWizard();
begin
    WizardForm.InfoBeforeMemo.Color := clBlack;
end; 
```

# php - 在 zend-developer-toolbar ZF2 中激活 BjyAuthorize 的问题

> ID：16123881
> 
> 赞同：3
> 
> 时间：2013-04-20T18:44:10.317
> 
> 标签：php, zend-framework2, developer-tools, user-roles, bjyauthorize

**有人可以给我一些关于如何将用户角色放入我的 zf2-toolbar 的说明。**

我无法从我的角色实体中获取用户角色，在我的 zend-developer-toolbar 中可见。通常我会解决自己的问题，但在这种情况下，我没有想法。我正在使用 ZfcUser、BjyAuthorize 和 Doctrine2。我找不到有关如何使用户角色显示在工具栏上的任何说明。我使用 Composer 安装所有依赖项。我的作曲家文件如下所示：

```
"require": {
    "php": ">=5.3.3",
    "zendframework/zendframework": "2.*",
    "doctrine/common": ">=2.3-dev,<2.5-dev",
    "zf-commons/zfc-user": "0.*",
    "bjyoungblood/bjy-authorize": "1.2.*",
    "doctrine/doctrine-orm-module": "0.*",
    "zendframework/zftool": "dev-master",
    "zendframework/zend-developer-tools": "dev-master",
    "zf-commons/zfc-user-doctrine-orm": "dev-master",
    "bjyoungblood/bjy-profiler": "dev-master"
} 
```

在工具栏中，我仍然收到消息：

```
Error
You have to install or enable @bjyoungblood's Zend\Db Profiler to use this feature. 
```

在我的 config/autoload/module.zenddevelopertools.local.php 中，我确实将探查器设置为启用并且它也已安装，至少我用我的 composer.phar 进行了检查。

```
'profiler' => array(
    'enabled' => true,

    ...
), 
```

如果有人可以帮助我，那就太好了，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-14T07:23:22.357

我通过搜索错误消息找到了这个线程，`You have to install or enable @bjyoungblood's Zend\Db Profiler to use this feature`因为当我第一次安装 ByjProfiler 时，我无法让它在开发人员工具栏中显示查询统计信息。

自述文件和文档在工具栏中激活探查器的代码略有不同，但经过一番玩弄后，我得到了它的工作。

在*config/autoload/global.php*中，我已经设置了以下内容：

```
return array(
    // ...
    'service_manager' => array(
        'factories' => array(
            'Zend\Db\Adapter\Adapter' => 'Zend\Db\Adapter\AdapterServiceFactory',
        ),
    ),
); 
```

为了让 ByjProfiler 在 ZDT 工具栏中工作，我将其更改为：

```
return array(
    //...
    'service_manager' => array(
        'factories' => array(
            //'Zend\Db\Adapter\Adapter' => 'Zend\Db\Adapter\AdapterServiceFactory',
            'Zend\Db\Adapter\Adapter' => function($sm) {
                $config = $sm->get('Configuration');
                $modules = $sm->get('ModuleManager')->getLoadedModules();

                if (isset($modules['BjyProfiler'])) { // module is enabled in application.config.php
                    $adapter = new BjyProfiler\Db\Adapter\ProfilingAdapter($config['db']);
                    $adapter->setProfiler(new BjyProfiler\Db\Profiler\Profiler());
                    if (isset($config['db']['options']) && is_array($config['db']['options'])) {
                        $options = $config['db']['options'];
                    } else {
                        $options = array();
                    }
                    $adapter->injectProfilingStatementPrototype($options);
                } else {
                    $adapter = new Zend\Db\Adapter\Adapter($config['db']);
                }

                return $adapter;
            }
        ),
    ),
); 
```

*我从byj-profiler/config/module.config.php*派生了大部分代码，但将其更改为检查加载的 BjyProfiler 模块是否处于活动状态。如果不是，它会回退到常规的 Zend\Db\Adapter\Adapter，否则会尝试使用应用程序配置中的 DB 设置来配置 BjyProfiler。

希望有帮助！

* * *

编辑：

为了进一步详细说明，让 BjyProfiler 默认工作的问题似乎与使用`AdapterServiceFactory`for 有关`Zend\Db\Adapter\Adapter`。

如果我启用了 BjyProfiler，但从服务管理器中删除了数据库工厂，则分析器会自动工作而无需额外的代码或配置，但如果我从 application.config.php 中删除 BjyProfiler，那么我的数据库连接就会中断。

如果我`AdapterServiceFactory`在服务管理器中启用了字符串并启用了 BjyProfiler，它似乎会覆盖使用 BjyProfiler 作为数据库适配器，因此不会让探查器在工具栏中工作。

# blackberry-10 - BlackBerry Cascades：如何将数据加载到 ListView

> ID：16123882
> 
> 赞同：2
> 
> 时间：2013-04-20T18:44:12.620
> 
> 标签：blackberry-10, blackberry-cascades

您好，我有一个与此类似的问题： [BlackBerry 10 Cascades：如何将数据加载到 DropDown 中？](https://stackoverflow.com/questions/13248396/blackberry-10-cascades-how-do-i-load-data-into-a-dropdown) 我唯一想知道的是如何使用 ListView 而不是下拉菜单来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T00:45:08.283

[ListView](https://developer.blackberry.com/cascades/reference/bb__cascades__listview.html)显示来自抽象数据类型[DataModel](https://developer.blackberry.com/cascades/reference/bb__cascades__datamodel.html)的数据。您使用哪种特定类型的数据模型取决于您的数据来源。您将数据放在适当的数据模型中，然后将数据模型分配给 ListView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-23T18:58:59.710

要将数据加载到下拉列表中，而不是列表视图，请使用以下代码：

```
DropDown {
    id: dropdown
    attachedObjects: [
        ComponentDefinition {
            id: compDefDD
            Option {
                description: "your default value for each Option"
            }
        },
        DataSource {
            id: dropDownDataSource
            // Load the data from an SQL database, based on a specific query
            source: "asset:///database.sql
            query: "select * from <yourtable>"
            onDataLoaded: {
                //the method is the code above
                for (var i = 0; i < data.length; i ++) {
                    var option = compDefDD.createObject();
                    option.text = data[i].SQLcolumn1;
                    option.value = data[i].SQLcolumn2;
                    dropdown.add(option);
                }
            }
            onError: {
                console.debug(errorMessage + " : " + errorType);
            }
        }
    ]
    onCreationCompleted: {
        dropDownDataSource.load();
    }
} 
```

在此示例中，我从 sql 数据库加载数据。如果您使用其他数据源，请参阅[页面参考](https://developer.blackberry.com/native/reference/cascades/bb__data__datasource.html)以获取更多详细信息。

# php - 我可以像 Django 的“python manage syncdb”那样在 Laravel 中自动创建数据库表吗？

> ID：16123888
> 
> 赞同：0
> 
> 时间：2013-04-20T18:44:44.117
> 
> 标签：php, django, laravel, syncdb

我来自 Django(Python) 背景，这些天我正在开发一个基于 Laravel(PHP) 的项目。我有一些选项，比如自动生成数据库表吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T19:02:53.620

是的，使用[Schema Builder](http://laravel.com/docs/database/schema)和[Migrations](http://laravel.com/docs/database/migrations)。

首先，您需要将迁移表安装到数据库：

```
$ php artisan migrate:install 
```

然后创建迁移

```
$ php artisan migrate:make create_users_table 
```

这将在`application/migrations`. 您现在可以编辑它以获得您想要的设置，即

```
<?php 

class Create_Users_Table
{

    public function up()
    {
        Schema::create('users', function($table)
        {
            $table->increments('id');
            $table->string('username');
            $table->string('email');
            $table->string('phone')->nullable();
            $table->text('about');
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::drop('users');
    }

} 
```

并使用执行它

```
$ php artisan migrate 
```

每次更改数据库结构时，您都必须创建一个新的迁移并在之后执行它。

假设您想要`users`一个新列`hometown`而不是`phone`创建一个新的迁移

```
$ php artistan migrate:make users_table_add_hometown 
```

并编辑新文件以包含

```
<?php 

class Users_Table_Add_Hometown
{

    public function up()
    {
        Schema::table('users', function($table)
        {
            $table->string('hometown');
            $table->drop_column('phone');
        });
    }

    public function down()
    {
        Schema::table('users', function($table)
        {
            $table->string('phone')->nullable();
            $table->drop_column('hometown');
        });
    }

} 
```

您现在有两个迁移，一个创建表，一个修改它。

该`artisan migrate`命令足够聪明，只执行系统新的迁移。因此，如果您的一位同事在长假后回家并且有一些新的迁移，它会自动只导入他离开后创建的迁移。

# java - 休眠Java Web应用程序

> ID：16123890
> 
> 赞同：0
> 
> 时间：2013-04-20T18:44:50.183
> 
> 标签：java, hibernate, jsp, web-applications

我正在开发一个使用休眠框架的 Java JSP Web 应用程序。

我是 JSP/hibernate 的初学者，我似乎无法让 hibernate 工作。我已按照本教程进行操作：[https](https://netbeans.org/kb/docs/web/hibernate-webapp.html) ://netbeans.org/kb/docs/web/hibernate-webapp.html 一切正常。我将 xampp 与 phpmyadmin 一起使用，我可以通过 hibernate.cfg.xml 文件执行 HQL 查询。

然后我对用于 Web 应用程序的数据库进行了同样的尝试。遵循所有步骤并完成所有向导。但我无法执行 HQL 查询。

给出以下错误：

```
org.hibernate.MappingException: An association from the table campingsperfestival refers to an unmapped class: festivalOverview.Campings
    at org.hibernate.cfg.Configuration.secondPassCompileForeignKeys(Configuration.java:1252)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1170)
    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:324)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1286)
    at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:859) 
```

我遵循了数据库向导中的 Hibernate 映射文件和 POJO，它为数据库中的所有表生成了一个 .java 和 .hbm.xml 文件，除了一个表：“campingsperfestival”表。我再次完成了几次向导并重新开始，但它仍然没有为“campingsperfestival”表生成 .java 和 .hbm.xml 文件。

'campingsperfestival' 表是一个有 2 个 id 的表，它们都有一个外键。有些节日和露营都有 ID，“campingsperfestival”在一张桌子上匹配这 2 个 ID。

露营.hbm.xml：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 20-apr-2013 12:04:37 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="festivalOverview.Campings" table="campings" catalog="groep11_festivals">
        <id name="campId" type="java.lang.Integer">
            <column name="camp_id" />
            <generator class="identity" />
        </id>
        <property name="campAdres" type="string">
            <column name="camp_adres" not-null="true" />
        </property>
        <property name="campCap" type="int">
            <column name="camp_cap" not-null="true" />
        </property>
        <set name="festivalses" inverse="true" table="campingsperfestival">
            <key>
                <column name="camp_id" not-null="true" />
            </key>
            <many-to-many entity-name="festivalOverview.Festivals">
                <column name="fest_id" not-null="true" />
            </many-to-many>
        </set>
        <set name="facpercamps" inverse="true">
            <key>
                <column name="camp_id" not-null="true" />
            </key>
            <one-to-many class="festivalOverview.Facpercamp" />
        </set>
    </class>
</hibernate-mapping> 
```

Festivals.hbm.xml：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 20-apr-2013 12:04:37 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="festivalOverview.Festivals" table="festivals" catalog="groep11_festivals">
        <id name="festId" type="java.lang.Integer">
            <column name="fest_id" />
            <generator class="identity" />
        </id>
        <property name="festNaam" type="string">
            <column name="fest_naam" length="100" not-null="true" />
        </property>
        <property name="festLocatie" type="string">
            <column name="fest_locatie" length="200" not-null="true" />
        </property>
        <property name="festDatum" type="date">
            <column name="fest_datum" length="10" not-null="true" />
        </property>
        <property name="festDuur" type="byte">
            <column name="fest_duur" not-null="true" />
        </property>
        <set name="ticketses" inverse="true">
            <key>
                <column name="fest_id" not-null="true" />
            </key>
            <one-to-many class="festivalOverview.Tickets" />
        </set>
        <set name="bandsperfestivals" inverse="true">
            <key>
                <column name="fest_id" not-null="true" />
            </key>
            <one-to-many class="festivalOverview.Bandsperfestival" />
        </set>
        <set name="campingses" inverse="false" table="campingsperfestival">
            <key>
                <column name="fest_id" not-null="true" />
            </key>
            <many-to-many entity-name="festivalOverview.Campings">
                <column name="camp_id" not-null="true" />
            </many-to-many>
        </set>
        <set name="tickettypesperfestivals" inverse="true">
            <key>
                <column name="fest_id" not-null="true" />
            </key>
            <one-to-many class="festivalOverview.Tickettypesperfestival" />
        </set>
    </class>
</hibernate-mapping> 
```

我只是hibernate的初学者，真的不知道如何解决这个问题。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:17:19.770

我假设 campingsperfestival 是 Campings 和 Festival 这两个类之间的连接表？您是否定义了这两个类及其映射？

你那里的错误是说它不能创建campingsperfestival，因为它指的是露营，它没有被定义为休眠类。因此，请确保定义了 Campings 并且您的映射正确。

如果您仍然不清楚，如果您展示您为露营和节日准备的 java/mappings，我们可能会提供更多帮助。

顺便说一句，如果这是您正在进行的一个新项目，我真的建议您使用基于注释的休眠类。您可能还会发现自己创建 hibernate 实体类而不是使用 netbeasns 是一种更有成效的学习体验——但这取决于个人喜好。

# titanium - 在 Windows 上面临“无法找到 CLI 可执行文件”

> ID：16123892
> 
> 赞同：1
> 
> 时间：2013-04-20T18:45:07.187
> 
> 标签：titanium, titanium-mobile

我刚刚安装了 Titanium，我对这个 IDE 并不是很熟悉。我添加了 Android SDK 来启动我的第一个应用程序，在我尝试在 Android Emulator 中查看我的应用程序之前，一切看起来都很酷。我越来越无法找到 CLI 可执行文件。*请重新启动 Studio 或使用帮助 > 检查 Titanium 更新来安装 Titanium CLI。*并**检查 Titanium 更新**说**没有可用的 Titanium 更新**。并且多次**重新启动工作室也没有用。**我什至无法在网络浏览器中预览我的应用程序。我究竟做错了什么？

我正在使用Titanium Studio，在 Windows Server 2008 R2 上**构建：3.1.0.201304151600**
一切都是最新的 Node.js、Android SDK 等。
我正在尝试创建一个基于 Web 的应用程序 frt Android 2.2+ 和移动网络。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T16:49:56.990

感谢 'Mukund Samant' 提供了有用的解决方法，我设法通过删除`node.js`和安装旧版本（0.8.22）然后`node.acs`通过运行以下命令手动安装包来解决这个问题[尽管我遇到了另一个问题] `npm -g install acs`：. 现在 Titanium 不会在启动时给我任何错误或更新消息。

*请注意，我发现我必须以管理员身份运行 Titanium Studio！*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T06:50:59.787

法里德，

您可以尝试几件事。

1.在你的命令行中输入titanium并回车。如果它给出'not identify as an internal or external command'，这意味着Titanium包没有正确安装。

2.尝试使用 npm Titan uninstall 命令仅卸载 Titanium node.js 包。

3.卸载后，打开Titanium studio。它会提示您安装Titanium CLI。按照步骤安装Titanium CLI。

4.如果这些步骤不起作用，则卸载节点并从工作室本身安装所有内容，而不是从命令行安装。

有时从命令行安装 Titanium CLI 会失败。

编辑：在您在命令提示符下尝试所有这种类型的节点之前，看看是否节点命令被识别。如果不是，您必须将其设置为 PATH 变量。

# wpf - 在 WPF 中动态地在 Datagrid 单元格中添加组合框

> ID：16123894
> 
> 赞同：0
> 
> 时间：2013-04-20T18:45:13.457
> 
> 标签：wpf, datagrid

我正在 WPF 中开发一个应用程序，该应用程序的一部分涉及从三个 Excel 表中提取和合并数据并在数据网格中显示。现在，如果 datagrid 中的一行有一个对应于多个应用程序的队列，那么它将显示一个组合框，通过在该 excel 表中查找相应的队列名称，将从另一个 excel 表中提取其项目。

我以前在 ASP.NET 中使用过相同的功能，并且使用以下代码很容易实现：

```
 for (int i = 0; i < dt.Rows.Count; i++)
  {
    //Filling datatable dsq from excel sheet
    //dsq contains the data where it is found out how many applications are there for               
   //ith row in Gridview

     count[i] = dsq.Tables[0].Rows.Count;

     foreach (GridViewRow row in gvApplications.Rows)
     {

     // Transferring gridview rows to a datatable
     if (row.Cells[0].Text.Trim().Equals(dt.Rows[i][0].ToString().Trim()))
       {
    //Dropdownlist is added only when no. of applications for each queue , i.e. , 
    /count[i] is greater than 1 , else level control is added.

         if (count[i] > 1)
            {
               DropDownList drp = new DropDownList();
               drp.DataSource = dsq.Tables[0];
                drp.DataTextField = "Application Name";
                drp.DataValueField = "Application Name";
                drp.DataBind();
               row.Cells[7].Controls.Add(drp);
             }
          }
           else
          {
             Label l = new Label();
            l.Text = dsq.Tables[0].Rows[0][0].ToString().Trim();
             l.ID = "label" + row.RowIndex.ToString();
            row.Cells[7].Controls.Add(l);

           }

                        } 
```

现在我想要 WPf 中的相同功能。请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T20:25:20.637

您可以在其中使用[DataGridTemplateColumn](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridtemplatecolumn.aspx)，您可以在其中放置一个`ContentControl`with [DataTemplateSelector](http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx)。

# ruby-on-rails - 捆绑安装时出错 - `Bundler 找不到 gem "rails" 的兼容版本`

> ID：16123898
> 
> 赞同：0
> 
> 时间：2013-04-20T18:45:20.620
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, gem, bundle

我正在尝试安装一个 gem，我在 gemfile 中更新了它，然后`bundle install`.

我收到以下错误消息：

```
Bundler could not find compatible versions for gem "rails":
  In Gemfile:
    merchant_samples (>= 0) ruby depends on
      rails (~> 3.2.9) ruby

    rails (3.2.7) 
```

这是什么意思？我能做些什么？我正在使用 rvm，我需要切换到另一个版本的 ruby​​ 吗？铁轨？如果是这样，是哪一个以及如何？为什么:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:57:58.450

这意味着 Mercer_samples gem 需要 rails`3.2.9`或更高版本，而您正在使用 version `3.2.7`。因此，要使用它，您需要`3.2.9`至少将您的 rails 版本升级到，但实际上您应该更新到最新`3.2.*`版本，因为旧版本存在一些安全问题。目前最新版本是`3.2.13`

您可以升级将 Gemfile 更改为：

```
gem 'rails', '3.2.13' 
```

然后你必须运行`bundle`，一切都应该正常工作。

# servicestack - Service.OrmLite 中的谓词错误地返回枚举值

> ID：16123899
> 
> 赞同：2
> 
> 时间：2013-04-20T18:45:22.593
> 
> 标签：servicestack, ormlite-servicestack

我正在使用 ServiceStack.OrmLite（版本 3.8.5）并且我有以下内容：

```
var report = dbCommand.Select<UploadedMediaReport>(x => x.Id == message.Id &&
                       (int)x.BitRate == (int)message.BitRate &&
                       (int)x.MediaFormat == (int)message.Format
                        ).FirstOrDefault(); 
```

在哪里

```
public class UploadedMediaReport
{
    public MediaBitRate BitRate { get; }
    public MediaFormat Format { get; }
    ..
} 
```

对于生成的 SQL，使用枚举的字符串值而不是 int 值，即。错误的 SQL 是：

```
 select ... bitRate = 'High' and Format = 'MP4' 
```

它应该在哪里

```
 select ... bitRate = 1 and Format = 3 
```

如何更改它以使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T16:19:22.590

我不确定您所看到的是否是错误，但可能的解决方法是：

```
var report = dbCommand.Where<UploadedMediaReport>(
    new {
        Id = message.Id,
        BitRate = (int)message.BitRate,
        MediaFormat = (int)message.Format
    }).FirstOrDefault(); 
```

# php - 如何更改 - 间隔 7 天？

> ID：16123903
> 
> 赞同：0
> 
> 时间：2013-04-20T18:45:36.290
> 
> 标签：php, mysql, intervals

我有这个 sql，我总是不得不通过文件编辑来更改间隔值

```
$sqlresult = mysql_query("UPDATE chassis SET oktodo = '1' 
             WHERE dtmcreated < '$date' - INTERVAL 7 DAY",$link) 
             or die(' Query failed: '.mysql_error().": ".$query); 
```

我添加了一段代码来更改数据库配置表中的值如何更改`INTERVAL 7 DAY`以从数据库配置表字段中获取数字

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T19:37:10.390

之后得到它的工作，谢谢你的帮助戈登。

更新机箱交叉连接配置 SET chassis.oktodo = '1' WHERE config.vckey = 'set_date' AND chassis.dtmcreated < '$date' - INTERVAL CAST(config.vcvalue AS UNSIGNED) DAY

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:10:14.313

您可以使用一个变量作为间隔。因此，您可以加入`config`表格：

```
UPDATE chassis c cross join
       config
     SET c.oktodo = '1' 
     WHERE c.dtmcreated < '$date' - INTERVAL config.NumDays DAY 
```

它仍然是基本相同的想法：

```
UPDATE chassis c cross join
     SET c.oktodo = '1' 
     WHERE config.vckey = 'set_date' and
           c.dtmcreated < '$date' - INTERVAL cast(config.vcvalue as int) DAY 
```

# asp.net-mvc - 调试应用程序后无法在 Visual Studio 中打开文件

> ID：16123905
> 
> 赞同：1
> 
> 时间：2013-04-20T18:45:47.323
> 
> 标签：asp.net-mvc, debugging, visual-studio-2012

我正在 Visual Studio 2012 中开发一个 ASP.net mvc 项目。遇到了这个问题，这在调试我的应用程序时非常烦人。假设每当我使用 F5 构建和启动调试会话时，我的编辑器中打开了 n 个文件。好的，所以编辑器照常关闭所有打开的文档，我执行调试任务。现在; 当我停止调试并想要重新打开之前打开的文件时，我不允许这样做。当我单击这些文件时，什么都没有发生，直到我重新启动 VS2012。

如果我在调试之前关闭所有打开的文档，则在正常工作后打开它们并按照预期的方式打开它们。此外，我所有的新项目或现有项目都是这种情况。我安装了 ReSharper 7.1.2 运行。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T14:36:40.513

要在调试后停止关闭所有文件，只需转到

```
Tools > Import and Export Settings > Reset Settings 
```

这将修复此错误，我保存了导致此错误的旧设置，但我不确定在设置中具体导致它的原因。在令人沮丧地寻找这个问题的明确答案之后，我希望这可以帮助其他可能遇到这个问题的人。

*请注意，我的 VS 2012 实例中也有您的错误，但没有您的扩展。我建议卸载您的扩展程序会删除导致错误的设置。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:07:49.593

你试过清洗溶液吗？

转到`Build`然后单击`Clean`解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T13:41:48.247

经过一番反复试验，我发现是[AnkhSVN](https://ankhsvn.open.collab.net/)导致了这个问题。

每当我尝试签入（或签出）代码时，都会导致一些异常。

我不知道，为什么这会禁止我在调试后打开文件，但在删除 AnkhSVN 后它可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-24T14:50:07.630

我也有这个问题。我无法解决它。就我而言，该文件是打开的，但它是不可见的。在文件仍然打开但“不可见”的情况下再次调试后，`file doesn't exist`当我导航到页面时出现错误（我在处理 ASP.NET 项目时遇到了这个问题）。

我建议重新安装[VS](https://www.visualstudio.com/)，以防您弄乱了所有调试和窗口设置。

# c# - 由于某种原因，进度条比我今天可以编码更多

> ID：16123908
> 
> 赞同：0
> 
> 时间：2013-04-20T18:46:04.597
> 
> 标签：c#, .net, multithreading, progress-bar

我在进度条方面遇到严重问题。我正在构建一个自定义备份实用程序，它允许用户现在通过单击按钮强制更新。当他们单击该按钮时，它会调用一个隐藏控制台窗口的控制台应用程序运行完整备份过程，然后完成。在整个过程中没有状态或进度条，因为安装完成后它对用户是透明的......用户引起的问题我们都知道。在 GUI 交互期间，需要有一些东西告诉管理员它正在做某事。这是我的代码：

```
private void forback_Click(object sender, EventArgs e)
    {
        BackgroundWorker bg = new BackgroundWorker();
        bg.DoWork += new DoWorkEventHandler(MethodToGetInfo);
        bg.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bg_RunWorkerCompleted);
        progressBar1.Style = ProgressBarStyle.Marquee;
        bg.RunWorkerAsync();
    }

    void MethodToGetInfo(Object sender, DoWorkEventArgs args)
    {
        Process info = new Process();
        info.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        info.StartInfo.FileName = "C:\\Rameses\\Program\\Day_Cloud_Backup.exe";
        info.StartInfo.UseShellExecute = false;
        info.StartInfo.CreateNoWindow = true;
        info.StartInfo.RedirectStandardOutput = true;
        info.Start();
    }

    void bg_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs args)
    {
        MessageBox.Show("it's f***ing done");
    } 
```

我到底做错了什么。我单击按钮，应用程序运行......但消息框立即显示并且进度条没有停止。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:52:39.270

这里有两件事。

要让进度条停止，您需要在 RunWorkerCompleted 回调中告诉它停止（在您的情况下，更改样式）。

为了使线程不立即返回，您需要阻塞线程以等待您启动的进程完成。一种方法是使用 WaitForExit Process 方法：

```
...
info.Start();
info.WaitForExit(); 
```

[http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)

这将使线程在调用 WorkerCompleted 回调之前等到您的进程完成。

# macos - OpenCL 工作组大小在 OS X CPU 运行时是否重要？

> ID：16123912
> 
> 赞同：0
> 
> 时间：2013-04-20T18:47:05.177
> 
> 标签：macos, opencl, grand-central-dispatch

在 OS X OpenCL CPU 运行时，[这里的文档](https://developer.apple.com/library/mac/#documentation/Performance/Conceptual/OpenCL_MacProgGuide/Performance/Performance.html#//apple_ref/doc/uid/TP40008312-CH113-SW7)表示“工作项目安排在提交给 Grand Central Dispatch 的不同任务中”。这似乎表明工作组本质上是无操作的，你应该为（​​工作项数）=（硬件线程数）而（工作组数）无关紧要。然而，在其他实现中，同一工作组中的项目之间通过本质上的协程（setjmp 和 longjmp）进行低成本切换，这将使安排更多工作项目的成本大大降低（因为您避免了完整的操作系统管理的线程项目之间的上下文切换），这反过来将更容易在 CPU 和 GPU 目标之间重用代码。根据“使用 OpenCL 进行异构计算”，AMD 的 CPU 运行时会这样做，我隐约记得一些文档表明英特尔也是如此。

任何人都可以确认 OS X CPU 运行时中工作组的行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T19:06:02.017

如文档后面所述（请参阅 Autovectorizer 部分），CPU 上的工作组大小与自动矢量化代码相关联。

自动向量化器将几个连续的工作项聚合到一个调用向量指令（SSE、AVX）的内核函数中。

将工作组大小设置为 1 会禁用自动矢量化器。较大的值将在可用时启用矢量代码。在大多数情况下，生成的代码能够有效地使用所有 CPU 资源。

在所有情况下，CPU 上的 OpenCL 在少量硬件线程上运行。

**更新**：回答评论中的问题。

它通常工作得很好。从“标量”​​内核开始并对其进行基准测试以查看自动矢量化器提供的加速，然后仅当加速不够好时才“手动矢量化”。为了帮助编译器，避免使用“if”，而更喜欢条件赋值和位操作。

# javascript - 如何通过 jquery-ui resizable 手动开始调整大小？

> ID：16123913
> 
> 赞同：0
> 
> 时间：2013-04-20T18:47:05.910
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-resizable

我正在尝试做这样的事情：

```
$('#wrapper').mousemove(function(){
    $newContainer.trigger('resize');
}) 
```

它不起作用，也不应该起作用。有什么方法可以开始调整大小，而不是单击 .ui-resizable-handle 元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:02:15.993

实际上，您可以在 mousemove 上调整元素的大小。但是为此，您可以创建一个 css 类，并在触发该事件后，您可以简单地将类添加到该元素。或者您可以使用边距、填充、高度、宽度来调整大小。

```
 $('#wrapper').mousemove(function(){
        $newContainer.addClass('css_class_name');
    });

    or 

    $('#wrapper').mousemove(function(){
        $newContainer.height('200');//according to your need
        $newContainer.width('200');
    }); 
```

# python - 标注尺寸逐帧变化的动态轮廓

> ID：16123916
> 
> 赞同：0
> 
> 时间：2013-04-20T18:47:18.950
> 
> 标签：python, opencv, image-processing

有没有一种方法可以识别和标记轮廓，其大小会随着 openCV 逐帧变化
一些轮廓也可能在几帧后消失。几
帧后可能会出现一些轮廓等，

任何想法？谢谢。

# ruby - 计算器中的正则表达式有错误的答案

> ID：16123919
> 
> 赞同：1
> 
> 时间：2013-04-20T18:47:40.943
> 
> 标签：ruby, regex, calculator

下面的代码旨在成为我可以针对数学表达式运行的计算器脚本。输出显然是错误的。我认为它是无限循环的。如果有人能在这里找到错误，我将不胜感激。

我不能`eval`在我的解决方案中使用。你在这里看到的一般格式是我必须使用的。我也 99% 确定我也不能使用`case`声明。

**编码**

```
expression = (ARGV[0]).gsub(/\s/, '')
def theCalculator (expression)
  while expression =~ /\D/
    if expression =~ /\(.*\)/
        expression = expression.scan(/\((.*)\)/)
        expression = $` + (theCalculator(expression)).to_s + $'
    elsif expression =~ /\^/
        expression = expression.scan(/(\d*|\d*\.\d*)(\^)(\d*|\d*\.\d*)/)
        expression = $1.to_f ** $3.to_f
        expression = $` + expression.to_s + $'
    elsif expression =~ /\*|\//
        expression = expression.scan(/(\d*|\d*\.\d*)(\*|\/)(\d*|\d*\.\d*)/)
        if $2 == "*"
          expression = $1.to_f * $3.to_f
        else
          expression = $1.to_f / $3.to_f
        end
      expression = $` + expression.to_s + $'
    elsif expression =~ /\+|\-/
      expression = expression.scan(/(\d*|\d*\.\d*)(\+|\-)(\d*|\d*\.\d*)/)
        if $2 == "+"
          expression = $1.to_f + $3.to_f
        else
          expression = $1.to_f - $3.to_f
        end
      expression = $` + expression.to_s + $'
    end
end
return expression
end
expression = theCalculator(expression)
puts expression 
```

**输入**

```
ruby calc.rb "2 ^ (4 - 1.0) + 1" 
```

**输出**

```
(big ol infinite loop) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T21:33:07.050

一个好的起点是[regex 上的这个资源](http://www.regular-expressions.info/)。如果您觉得有必要以这种方式进行试验，也知道有几个在线正则表达式评估器。

只是给出几个非常重要的提示，它们应该会让你更接近自己完成你的任务：

*   找到调试代码的方法！你已经知道了`puts`，你可以用它开始
*   仔细看看你的`while`情况（`\D`）：在我看来`[^\d.]`更好
*   另外，在我看来`[*\/]`，可以分别`[+-]`替换`\*|\/`和`\+|\-`
*   `.to_s`在您的递归调用中，我得到了更好的结果`expression`
*   注意贪婪：~~使用*惰性*量词进行括号匹配~~
    **编辑**：使用表达式匹配没有任何内部括号的括号...</li>
*   `\d*|\d*\.\d*`不一样`\d*(?:\.\d*)?`

请仔细查看上面的列表并尝试理解我的建议。
你能让你的脚本给出和我一样的结果吗？( `9.0`)

# mysql - 在 MySQL 中一起使用 COUNT 和 SUM 需要帮助

> ID：16123922
> 
> 赞同：2
> 
> 时间：2013-04-20T18:48:16.180
> 
> 标签：mysql, sql, database

我有 2 张桌子：学院和课程

```
Institute
---------
i_id       i_name      i_city
------     --------    --------
1          Name 1      London
2          Name 2      Manchester
3          Name 3      London

Course
-------
c_id       i_id        stream
------     -------     --------
1          1           Engineering
2          1           Engineering
3          2           Engineering
4          3           Engineering 
```

现在我正在努力实现三件事：

a) 每个城市提供工程课程的学院数量。b) 提供工程课程的学院总数（不同）。

我开始写下面的查询来实现这一点：

```
SELECT institute.i_city, 
COUNT( DISTINCT institute.i_id ) AS institute_count_per_city
FROM institute, course
WHERE institute.i_id = course.i_id
AND course.stream =  'Engineering'
GROUP BY institute.i_city 
```

我得到以下结果：

```
i_city      institute_count_per_city
-------     -------------------------
London      2
Manchester  1 
```

现在我已经达到了每个城市的机构数量。

我不知道如何获得同一查询中的机构总数，在上面的示例中为 3 (2+1)

我非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:50:52.683

使用[`ROLLUP`](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)：

```
SELECT institute.i_city, 
COUNT( DISTINCT institute.i_id ) AS institute_count_per_city
FROM institute, course
WHERE institute.i_id = course.i_id
AND course.stream =  'Engineering'
GROUP BY institute.i_city WITH ROLLUP 
```

它将使用`SUM`您的聚合值添加额外的行。

***更新***

*`GrandTotal`*版本：

```
SELECT IFNULL(institute.i_city, 'GrandTotal'), 
COUNT( DISTINCT institute.i_id ) AS institute_count_per_city
FROM institute, course
WHERE institute.i_id = course.i_id
AND course.stream =  'Engineering'
GROUP BY institute.i_city WITH ROLLUP 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:52:09.520

联合查询有帮助吗？

```
 your existing query
 union
 select 'total' I_city, count(*) institute_count_per_city
 FROM institute, course
 WHERE institute.i_id = course.i_id
 AND course.stream =  'Engineering'
 GROUP BY 'total' 
```

# objective-c - 在 IB 中禁用圆形按钮大小

> ID：16123923
> 
> 赞同：0
> 
> 时间：2013-04-20T18:48:16.243
> 
> 标签：objective-c, xcode, cocoa, interface-builder

有没有办法在 Interface Builder（OSX 项目）中更改圆形按钮的大小？我正在尝试实现 Xcode 工具栏中的 Run/Stop 按钮之类的功能。当我将圆形按钮放到工具栏上并转到大小检查器时，宽度和高度被禁用。我只需要增加按钮的大小并向其添加图像。

我是否需要创建自定义视图并将其放到工具栏上？

# php - 未发送带有附件的邮件（奇怪的情况）？

> ID：16123928
> 
> 赞同：0
> 
> 时间：2013-04-20T18:48:34.713
> 
> 标签：php

将 html 文件作为附件发送的这段代码工作正常。但是在下一个代码片段中，当我将附件更改为未发送的图像时。为什么会这样？我不想使用 phpmailer 或 swift mail！

```
<?php
$file_path = "file.html"; // server path where file is placed
$file_path_type = "text/html"; // File Type
$file_path_name = "newfilename.html"; // this file name will be used at reciever end 

$from = "xyz@gmail.com"; // E-mail address of sender
$to = "abc@gmail.com"; // E-mail address of reciever
$subject = "Please check the Attachment."; // Subject of email
$message = "This is the message body.&lt;br&gt;&lt;br&gt;Thank You!&lt;br&gt;&lt;a href='http://7tech.co.in'&gt;7tech.co.in Team&lt;/a&gt;"; 

$headers = "From: ".$from; 

$file = fopen($file_path,'rb');
$data = fread($file,filesize($file_path));
fclose($file); 

$rand = md5(time());
$mime_boundary = "==Multipart_Boundary_x{$rand}x"; 

$headers .= "\nMIME-Version: 1.0\n" .
"Content-Type: multipart/mixed;\n" .
" boundary=\"{$mime_boundary}\""; 

$message .= "This is a multi-part message in MIME format.\n\n" .
"--{$mime_boundary}\n" .
"Content-Type:text/html; charset=\"iso-8859-1\"\n" .
"Content-Transfer-Encoding: 7bit\n\n" .
$message .= "\n\n"; 

$data = chunk_split(base64_encode($data)); 

$message .= "--{$mime_boundary}\n" .
"Content-Type: {$file_path_type};\n" .
" name=\"{$file_path_name}\"\n" .
"Content-Disposition: attachment;\n" .
" filename=\"{$file_path_name}\"\n" .
"Content-Transfer-Encoding: base64\n\n" .
$data .= "\n\n" .
"--{$mime_boundary}--\n";  

if(@mail($to, $subject, $message, $headers)) {
echo "File send!";

} else {
echo 'Failed';
}
?> 
```

现在，当我将附件更改为图片（即 screenshot.png）时，它无法发送消息。

```
<?php
    $file_path = "screenshot.png"; // server path where file is placed
    $file_path_type = "image/png"; // File Type
    $file_path_name = "screenshot.png"; // this file name will be used at reciever end 

    $from = "xyz@gmail.com"; // E-mail address of sender
    $to = "abc@gmail.com"; // E-mail address of reciever
    $subject = "Please check the Attachment."; // Subject of email
    $message = "This is the message body.&lt;br&gt;&lt;br&gt;Thank You!&lt;br&gt;&lt;a href='http://7tech.co.in'&gt;7tech.co.in Team&lt;/a&gt;"; 

    $headers = "From: ".$from; 

    $file = fopen($file_path,'rb');
    $data = fread($file,filesize($file_path));
    fclose($file); 

    $rand = md5(time());
    $mime_boundary = "==Multipart_Boundary_x{$rand}x"; 

    $headers .= "\nMIME-Version: 1.0\n" .
    "Content-Type: multipart/mixed;\n" .
    " boundary=\"{$mime_boundary}\""; 

    $message .= "This is a multi-part message in MIME format.\n\n" .
    "--{$mime_boundary}\n" .
    "Content-Type:text/html; charset=\"iso-8859-1\"\n" .
    "Content-Transfer-Encoding: 7bit\n\n" .
    $message .= "\n\n"; 

    $data = chunk_split(base64_encode($data)); 

    $message .= "--{$mime_boundary}\n" .
    "Content-Type: {$file_path_type};\n" .
    " name=\"{$file_path_name}\"\n" .
    "Content-Disposition: attachment;\n" .
    " filename=\"{$file_path_name}\"\n" .
    "Content-Transfer-Encoding: base64\n\n" .
    $data .= "\n\n" .
    "--{$mime_boundary}--\n";  

    if(@mail($to, $subject, $message, $headers)) {
    echo "File send!";

    } else {
    echo 'Failed';
    }
    ?> 
```

你们能指出错误吗？我也尝试在 1-2 个地方更改内容类型，但它不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:58:49.993

利用

`file_get_contents('http://www.example.com/');`

代替

```
$file = fopen($file_path,'rb');
$data = fread($file,filesize($file_path));
fclose($file); 
```

并尝试使用此代码..

```
$random_hash = md5(time());

$headers .= "\r\nContent-Type: multipart/alternative; boundary=\"PHP-alt-".$random_hash."\"";

$headers .= "\r\nMIME-Version 1.0";

$attachment = chunk_split(base64_encode(file_get_contents($filename)));

$message = 
"--PHP-alt-$random_hash
Content-Type: text/plain

Dear Same,

We would like to thank you for your registration to be held on Saturday August 25, 2012 at the....

--PHP-alt-$random_hash
Content-Type: application/pdf; name=$filename
Content-Transfer-Encoding: base64
Content-Disposition: attachment

$attachment
--PHP-alt-$random_hash--";

@mail($to, $subject, $message, $headers); 
```

# java - 在实现接口的类中使用接口中存在的变量

> ID：16123929
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:48:40.887
> 
> 标签：java, variables, interface

我有一个接口。有三个类实现了这个接口。

在界面中，我有两个变量，例如： double x; 双 y;

现在，我可以在这三个类中使用 x 和 y 做什么。在这些类对象中，我可以使用它们自己的 x 和 y 值吗？（我不能使用它，如果有办法，请告诉我）我可以以任何方式更改它吗？

我对接口感到困惑。我可以为实现它的三个类中的接口内的变量做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T18:51:31.930

快速谷歌，在接口中定义的变量被 JVM 视为公共最终静态。所以你可以通过 Interface.x 访问它们，但不能设置它们。这是有道理的，因为接口用于定义事物，而不是*事物*。

[http://www.coderanch.com/t/408233/java/java/Instance-variables-interface](http://www.coderanch.com/t/408233/java/java/Instance-variables-interface)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T18:52:13.080

是的..因为接口变量是公共静态最终的。

您可以使用您的静态方式访问它

```
InterfaceName.x and InterfaceName.y 
```

一旦分配了值，您就不能更改它们，因为它们是恒定的。

# java - 使用外部 jar 运行 bat 文件时出现 NoclassDefFoundError 异常

> ID：16123931
> 
> 赞同：1
> 
> 时间：2013-04-20T18:49:03.233
> 
> 标签：java

我正在使用 Eclipse，在我的 Java 项目中，我添加了一个外部 jar 文件。它编译成功并且运行顺利。

当我开始在 Eclipse IDE 之外运行它时，就会出现问题。我在 bin 文件夹（包含所有已编译的类的文件夹）中创建了一个 bat 文件。这个bat文件是：

```
java package.ClassToRun 
```

但是当我执行这个 bat 文件时，我收到错误：`NoclassDefFoundError`因为 java 找不到类 X（我的外部 jar 文件中的类 X）。

我该如何解决这个问题。（意思是：我可以在 IDE 之外运行这个类）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:56:56.187

您可以将外部添加`.jar`到您的类路径中：

> java -cp /usr/local/jar/foobar.jar com.your.main.classname

* * *

`lib`您还可以在您拥有文件的文件夹中创建一个文件夹（类似于） `.jar`。

`Manifest.MF`内容可以是：

```
Main-Class: com.your.main.classname
Class-Path: lib/one.jar lib/two.jar 
```

文件夹内容：

```
mainFolder/
   * lib/one.jar
   * lib/two.jar
   * my-main.jar 
```

执行：

```
java -jar my-main.jar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T18:52:46.770

您应该在执行程序时将外部 jar 添加到 -classpath。

# jquery - UberMenu Javascript API 函数。

> ID：16123932
> 
> 赞同：1
> 
> 时间：2013-04-20T18:49:07.997
> 
> 标签：jquery, wordpress, api, megamenu

所以这是我在文档准备好时触发下拉菜单的解决方案：它可以工作，但我无法使用我的 unbermenu 插件在 WP 中工作...帮助

jsfiddle 中的代码：< [http://jsfiddle.net/IMAGINEUX/AQrNs/4/](http://jsfiddle.net/IMAGINEUX/AQrNs/4/) >

```
jQuery(document).ready(function($) {
$('#menu-item-156').mouseover(function(){
    $(this).find('ul').slideDown();
});

$('#menu-item-156').trigger('mouseover');
}); 
```

查看 UberMenu Javascript API 函数后：

我把它改成了这个；

```
jQuery(document).ready(function ($) {
$(‘#menu - item - 156′).mouseover(function () {
    uberMenu_openMega(‘#menu - item - 15′);
});
$(‘#menu - item - 156′).trigger(‘mouseover’);
}); 
```

我觉得这必须是你能做的最简单的任务之一，我要疯了。

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T01:09:05.883

请检查您的 HTML。您在 JS 小提琴中有一个错字（小提琴突出显示，以红色开头）。第 5 行应该是：

```
<li id='menu-item-156'><a href="#">About Us</a> 
```

（在 menu-item-156 之前添加了 '）

还有一个额外的

```
 </li>
</ul> 
```

在代码的末尾。

解决这个问题，您实际上不需要任何 jQuery；该菜单仅适用于 CSS。除非我误解了你的最终结果意图。

请看这个小提琴：http: [//jsfiddle.net/AQrNs/5/](http://jsfiddle.net/AQrNs/5/)

# mysql - 如何将主要属性从一个属性更改为另一个属性。mysql

> ID：16123935
> 
> 赞同：0
> 
> 时间：2013-04-20T18:49:36.653
> 
> 标签：mysql, sql, primary-key, surrogate-key, candidate-key

我有一个数据库，我在其中声明了一个主键。后来在实现数据库时，我意识到我必须创建一个自动递增代理键并将我当前的主键切换到那个，因为我当前的主键不可避免地会出现多次。我已经探索了堆栈溢出的深度和其他寻找答案的网站，但我找不到合理的解决方案。

具体来说，我正在为兄弟会制作这个数据库，其中每个成员都以唯一的滚动编号启动。使用滚动编号作为主键似乎是一个好主意，直​​到我意识到拥有多个学习专业的成员将有两个元组（一个表示每个专业，数据库必须在 3NF 中）。考虑到这一点，创建代理键是可行的方法，还是有更合理的问题解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:03:08.330

您将需要成员和研究领域之间的多对多关系。所以是的，你需要一个代理键。

# javascript - 总是需要清除缓存

> ID：16123937
> 
> 赞同：0
> 
> 时间：2013-04-20T18:49:44.253
> 
> 标签：javascript, facebook, caching, localhost

我有一个我正在测试的 facebook 应用程序`localhost`。我总是需要清除缓存才能在进行更改后重新加载，这很烦人。知道如何解决这个问题吗？

我从一些朋友那里听说一些 Javascript 代码可能会有所帮助，但我不知道实际该怎么做。
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:01:25.240

你试过谷歌浏览器开发者工具吗？他们可以选择在打开时禁用所有缓存。

我通常打开开发工具（mac：command+alt+i），禁用缓存（单击右下角的设置按钮），然后按住 shift 并单击重新加载以确保清除所有缓存。

![开发工具设置](https://i.stack.imgur.com/0ztMB.png)

# asp.net - Asp.net 成员资格 WebSecurity.InitializeDatabaseConnection 错误

> ID：16123938
> 
> 赞同：1
> 
> 时间：2013-04-20T18:49:57.367
> 
> 标签：asp.net, asp.net-membership

当我尝试访问网站管理工具 (WAT)（Visual Studio 中的项目-> ASP.NET 配置）时，出现以下错误

> 在调用“WebSecurity”类的任何其他 > 方法之前，您必须调用“WebSecurity.InitializeDatabaseConnection”方法。此调用应放在站点根目录下的 _AppStart.cshtml 文件中。

这是我的连接字符串：

```
<add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|Database1.mdf;User Instance=true" providerName="System.Data.SqlClient" /> 
```

我还启用了简单的会员资格

```
<add key="enableSimpleMembership" value="true" /> 
```

我的 roleshipprivider 配置看起来像这样

```
<roleManager enabled="true" defaultProvider="MySqlRoleProvider">
  <providers>
    <clear />
    <add connectionStringName="DefaultConnection" applicationName="/"
      name="MySqlRoleProvider" type="WebMatrix.WebData.SimpleRoleProvider, WebMatrix.WebData" />
  </providers>
</roleManager> 
```

还有我的会员资格

```
 <membership defaultProvider="MyOwnSqlMembershipProvider">
  <providers>
    <clear/>
    <add connectionStringName="DefaultConnection" enablePasswordRetrieval="false"
      enablePasswordReset="true" requiresQuestionAndAnswer="false"
      requiresUniqueEmail="true" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"
      minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
      name="MyOwnSqlMembershipProvider" type="WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData" />
  </providers>
</membership> 
```

有人知道错误在哪里吗？

在此先感谢 Mateusz Urban

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-16T19:25:52.247

您应该将下面的代码添加到`Global.aspx.cs`内部`protected void Application_Start()`，并且应该出现在任何其他注册之前的顶部。这样，它将始终`Initialized`在其他操作之前。

```
if (!WebSecurity.Initialized)
            WebSecurity.InitializeDatabaseConnection("DefaultConnection", 
"UserProfile", "UserId", "UserName", autoCreateTables: true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T19:13:56.413

您需要包含代码以实际初始化成员资格提供程序。_AppStart.cshtml 中的以下内容应该可以工作：

```
@{   
if (!WebSecurity.Initialized)
{
    WebSecurity.InitializeDatabaseConnection("dbContext", "Users", "Id", "Login", autoCreateTables: false); 
}
} 
```

# sql - 编写 Postgres 获取或创建 SQL 查询

> ID：16123944
> 
> 赞同：18
> 
> 时间：2013-04-20T18:50:33.137
> 
> 标签：sql, postgresql

我想写一个 Postgres SQL 语句，说寻找颜色 X 和亮度 Y 的用户。如果该用户存在，则返回其所有行数据。如果没有，请创建一个新行并传递其他信息。这两个单独的语句会做这样的事情：

```
Select (color, brightness, size, age) FROM mytable WHERE color = 'X' AND brightness= 'Y'; 
```

如果这没有返回任何东西，那么执行这个：

```
INSERT INTO mytable (color, brightness, size, age) VALUES (X, Y, big, old); 
```

有没有办法将这些组合成一个查询？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-21T04:52:36.680

在 SQL DBMS 中，select-test-insert 方法是一个错误：没有什么能阻止另一个进程在您的`select`and`insert`语句之间插入“缺失”行。改为这样做：

```
INSERT INTO mytable (color, brightness, size, age)
SELECT color, brightness, size, age 
FROM mytable
WHERE NOT EXISTS (
    select 1 from 
    from mytable
    where color = 'X' and brightness = 'Y'
);
SELECT (color, brightness, size, age) 
FROM mytable 
WHERE color = 'X' AND brightness= 'Y'; 
```

您应该能够将整个文本作为单个“查询”传递给 DBMS。您可能需要考虑将其制成存储过程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-20T20:51:45.063

```
with sel as (
    select color, brightness, size, age
    from mytable
    where color = 'X' and brightness = 'Y'
), ins as (
    insert into mytable (color, brightness, size, age)
    select 'X', 'Y', 6.2, 40
    where not exists (
        select 1 from sel
    )
    returning color, brightness, size, age
)
select color, brightness, size, age
from ins
union
select color, brightness, size, age
from sel 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-01-02T16:43:50.467

在这里添加我的解决方案。这与@Clodoaldo Neto 和@astef 的解决方案有点不同。

```
WITH ins AS (
  INSERT INTO mytable (color, brightness, size, age)
  VALUES ('X', 'Y', 'big', 'old')
  ON CONFLICT (color) DO NOTHING
  RETURNING *
)
SELECT * FROM ins
UNION
SELECT * FROM mytable
  WHERE color = 'X'; 
```

我发现 astef 的解决方案不适合我的目的：它不执行“获取或创建”的“获取”部分！如果该值已经存在，则不会发生任何事情。

语句末尾的联合确保如果没有插入该值（因为它已经存在），我们仍然从表中检索该值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-01T10:06:09.343

如果您的列参与唯一索引约束，您可以使用自 9.5 版以来可用的方法：

```
INSERT INTO mytable (color, brightness, size, age)
VALUES ('X', 'Y', 'big', 'old')
ON CONFLICT (color) DO NOTHING; 
```

（假设您在 上具有唯一索引`color`）。

文档是基尔：[https ://www.postgresql.org/docs/9.5/static/sql-insert.html](https://www.postgresql.org/docs/9.5/static/sql-insert.html)

# html - 验证器中的杂散开始标记HTML？

> ID：16123945
> 
> 赞同：9
> 
> 时间：2013-04-20T18:50:47.393
> 
> 标签：html, validation

我正在尝试在[http://validator.w3.org/#validate_by_input](http://validator.w3.org/#validate_by_input)中验证此 HTML 文档，但出现以下错误：

第 3 行，第 47 列：杂散开始标记 html。

```
<!--[if IE 7]><!--><html lang="en" class="ie7"><!--<![endif]--> 
```

第 4 行，第 47 列：杂散开始标记 html。

```
<!--[if IE 8]><!--><html lang="en" class="ie8"><!--<![endif]--> 
```

第 5 行，第 47 列：杂散开始标记 html。

```
<!--[if IE 9]><!--><html lang="en" class="ie9"><!--<![endif]--> 
```

第 6 行，第 46 列：杂散开始标记 html。

```
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]--> 
```

这是我输入的 HTML：

```
<!DOCTYPE html>
<html lang="en-US">
<!--[if IE 7]><!--><html lang="en" class="ie7"><!--<![endif]-->
<!--[if IE 8]><!--><html lang="en" class="ie8"><!--<![endif]-->
<!--[if IE 9]><!--><html lang="en" class="ie9"><!--<![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en"><!--<![endif]-->
<head>
<title>Test</title>
</head>
<body>
</body>
</html> 
```

有什么想法我哪里出错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T18:53:29.343

正确的条件注释：

```
<!--[if IE 7]><html lang="en" class="ie7"><![endif]-->
<!--[if IE 8]><html lang="en" class="ie8"><![endif]-->
<!--[if IE 9]><html lang="en" class="ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><html lang="en"><![endif]-->
<!--[if !IE]><html lang="en-US"><![endif]--> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T18:53:42.257

你不关闭它们。就是这样，您现在定义了 2 个 html 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T18:54:09.617

您从始终存在的 html-tag 开始，然后根据 IE 的版本添加 html-tags，因此您很可能最终会得到多个 html-tags。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-07-10T20:21:45.497

```
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> 
```

使用此文件，然后开始标记...

# android - 如何在我刚开始开发的应用程序中实现 facebook 登录？

> ID：16123950
> 
> 赞同：0
> 
> 时间：2013-04-20T18:51:21.583
> 
> 标签：android, facebook, authentication, login

我对开发 android 应用程序非常陌生，并且在开发此类应用程序时只有基础知识。

我试图从实现 Facebook 登录功能开始，但我在 Facebook 上找到的指南让一切都变得比应有的更糟。

我希望有人可以从头到尾给我一个彻底的演练如何制作一个 facebook 登录起始页面并使用一个 facebook 帐户进行正确的身份验证..？

记住我对此很陌生..

最好的问候托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T00:07:47.707

对于不熟悉将 Facebook 集成到他们的应用程序中的人，尤其是对于 Android 编程的新手来说， `Facebook SDK`for`Android`可能非常复杂。这些教程非常详细，但经常引用已经创建的代码，因此您必须在您面前拥有该代码（来自 Facebook 示例）才能继续学习。

但是，使用新`Facebook SDK`的 . 登录时“非常容易”。这是通过`LoginButton`. 请注意，我将“非常容易”放在引号中，因为这当然是一个见仁见智的问题。让我试着把它分解成一个易于遵循的方法，并强调我遇到的一些重要的事情和问题。

首先，[看一下入门页面。](http://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)特别看一下第 3 步（“将 SDK 导入 Eclipse”）、第 4 步的结尾（“运行示例”）和第 5 步（“创建 Facebook 应用程序”）。第 4 步的结尾是您生成`keyhash`将在下一步中使用的地方。请注意，当命令提示符代码引用时`openssl`，它意味着将整个路径放入`openssl`应用程序。如果你没有它，你需要下载它。此外，此步骤很重要，因为除非正确，否则您将无法登录。

接下来，保存您在上面收到的应用程序 ID（在开始的第 5 步中）并将其保存到字符串资源，如下所示：

```
<string name="app_id">YOUR_APP_ID_HERE</string> 
```

然后，在您的清单文件中，将其放在所有其他`Activity`声明的下方，但在`Application`标签内：

```
 <activity android:name="com.facebook.LoginActivity"
              android:theme="@android:style/Theme.Translucent.NoTitleBar"
              android:label="@string/app_name" />
    <meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/> 
```

此外，在您的清单中，请确保您具有以下权限：

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

现在，在您想要的布局 xml 文件中`LoginButton`，放置如下内容：

```
 <com.facebook.widget.LoginButton
    android:id="@+id/login_button"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:layout_margin="10dp"
    android:layout_gravity="center_horizontal"/> 
```

最后，在您的`Activity`or`Fragment`中，您可以设置一个`OnErrorListener`，如下所示：

```
 // Set an error listener for the login button
    LoginButton loginButton = (LoginButton) v.findViewById(R.id.login_button);
    if (loginButton != null) {
        loginButton.setOnErrorListener(new OnErrorListener() {

            @Override
            public void onError(FacebookException error) {
                if (error != null && !(error instanceof FacebookOperationCanceledException)) {
                    // Failed probably due to network error (rather than user canceling dialog which would throw a FacebookOperationCanceledException)
                    ((HangmanActivity) getActivity()).showError(getResources().getString(R.string.network_error), false);
                }
            }

        });
    } 
```

您可以将上述代码放在`onCreate`or`onCreateView`方法中。上面的代码查看是否由于 Internet 连接丢失而出现错误。现在，如果您运行您的应用程序，您应该能够点击`LoginButton`，它会将您登录到 facebook，然后它会切换到说“注销”（再次单击时会将您注销）。这就是登录的全部内容，但是，如果您想添加更多功能，我建议您查看 Facebook 的其他[类似教程。](http://developers.facebook.com/docs/tutorials/androidsdk/3.0/games/)请注意，我刚才所说的教程引用了他们随 SDK 提供的示例项目。它还使用了很多片段，因此请确保您也熟悉它们。好吧，我希望这会有所帮助！

# python-sphinx - 如何在 Sphinx TOC 中包含主页？

> ID：16123951
> 
> 赞同：31
> 
> 时间：2013-04-20T18:51:23.603
> 
> 标签：python-sphinx, toctree

假设我有一个 Sphinx 项目，其来源如下：

```
index.rst
installation.rst
templating/
    index.rst
    module.rst
    fieldtype.rst 
```

index.rst（主页）具有以下目录树：

```
.. toctree::
   :titlesonly:

   installation
   templating/index 
```

我希望我的模板包含一个侧边栏，列出所有 3 个顶级页面（主页、安装、模板/索引）。

我尝试在主页中添加第二个隐藏的 TOC 树：

```
.. toctree::
   :hidden:

   index

.. toctree::
   :titlesonly:

   installation
   templating/index 
```

这实际上给了我想要的结果，*除了*它将`next`变量设置为当前页面。所以我的模板中的这段代码：

```
Next up: <a href="{{ next.link }}">{{ next.title }}</a> 
```

…总是从主页输出主页链接。不好。

我一直试图将实际的主页链接硬编码到模板的侧边栏中：

```
{% set homeClass = 'current' if pagename == 'index' else '' %}
<ul class="{{ homeClass }}">
    <li class="toctree-l1 {{ homeClass }}"><a class="{{ homeClass }} reference internal" href="/index.html">Home</a></li>
</ul>
{{ toctree() }} 
```

这也有效，除了我不想强制在 web 服务器的 webroot 上访问文档——我希望它们也可以从文件系统中工作。

我不能简单地将 URL 设置为“index.html”，因为当您在模板/中的文件中时，这将不起作用。

我错过了一些明显的东西吗？必须有一种方法可以将主页放入 TOC，而不会破坏`next`链接，并且具有适用于本地文件系统的动态路径，即使是在子文件夹中也是如此。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-30T14:50:49.853

原来答案隐藏在 Sphinx 的[目录树页面上](http://sphinx-doc.org/markup/toctree.html)：

> 特殊条目名称`self`代表包含 toctree 指令的文档。如果您想从目录树生成“站点地图”，这很有用。

添加`self`到 TOC 树就完美了！如果你把它放在一个单独的、隐藏的 toctree 指令中，它也不会出现在主页的目录中：

```
.. toctree::
   :hidden:

   self

.. toctree::
   :titlesonly:

   installation
   templating/index 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T15:55:29.873

您是否可以重命名 Sphinx 项目的根目录树页面，或者，模板/索引页面？该`master_doc`变量允许您在项目中命名包含根 toctree 指令的文件，并且不必`index.rst`在我们的文档项目中调用它来解决非常类似的问题，我们有一个`template/index.html`文件和我们的根 toctree page 实际上被称为`reference.rst`.

# ember.js - 如何以 json 格式从服务器响应中填充 ember.js 模型？

> ID：16123953
> 
> 赞同：0
> 
> 时间：2013-04-20T18:51:32.473
> 
> 标签：ember.js

我有一个关于**emberjs**的列表。我想使用来自服务器的数据创建该列表的新元素。数据通过 ajax 以 json 格式传输，如下所示：

```
{
  "status": "success",
  "material": 
  [
    {
      "user1": "test",
      "create_datetime": "2013-03-30 10:36:24+00:00"
    }
  ]
} 
```

如何填写`ember.js`我的列表中的模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T22:56:58.617

这可以通过迭代您返回的材料数据来完成。（咖啡稿）

楷模

```
App.Material = Ember.Object.extend
  userId: null
  createDateTime: null

App.Item = Ember.Object.extend
  status: null
  materials: [] 
```

控制器

```
App.ItemController = Ember.ObjectController.extend

  init: ->
    @loadData()

  loadData: =>
    $.ajax
      url: "/api/items"
      success: (data) =>
        if data?    
          # create an item object
          item = App.Item.create
                   status: data.status

          # loop through all materials for current item
          for material in data.material
            # push materials onto item.material stack
            item.materials.pushObject App.Material.create
                                        userId: material.user1
                                        createDateTime: material.create_datetime

          # set the controllers content to the item
          @set('content') item 
```

# android - DiskLruImageCache 避免在关闭时删除缓存

> ID：16123954
> 
> 赞同：3
> 
> 时间：2013-04-20T18:51:34.797
> 
> 标签：android, caching

我正在使用 DiskLruImageCache 将位图存储到 DickCache 中。事情是，每次应用程序关闭时，它都会删除 diskCache 文件夹的内容。我不会发生 onPause，只是 onClose。有什么建议可以避免这种情况吗？

谢谢

# varnish - 如何让 Varnish 满足 Cloudcontrol 上静态文件的请求？

> ID：16123955
> 
> 赞同：1
> 
> 时间：2013-04-20T18:51:52.410
> 
> 标签：varnish, cloudcontrol

我正在从（希望）无 cookie 域提供静态文件（图像、javascript、css 文件），该域也映射到我的 cloudcontrol 部署。这是请求和响应标头。我在请求中没有看到 cookie 标头，ETag 和日期检查应该满足，所以我希望 cloudcontrol 部署前面的清漆代理会获取请求并提供服务，但每次我尝试它时，所有静态文件都是从Apache 根据响应标头进行处理。任何小费表示赞赏。

```
Request URL:http://static.hotelpress.mobi/bundles/viermediamagazine/icons/social/Facebook_64.png
Request Method:GET
Status Code:304 Not Modified 
```

请求标头

```
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:de-DE,de;q=0.8,en-US;q=0.6,en;q=0.4
Cache-Control:max-age=0
Connection:keep-alive
Host:static.hotelpress.mobi
If-Modified-Since:Sat, 20 Apr 2013 18:23:31 GMT
If-None-Match:"6008d436-1108-4daceeec74ec0"
Referer:---stripped out or my boss kills me---
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.65 Safari/537.31 
```

响应标头

```
Accept-Ranges:bytes
Age:0
Connection:keep-alive
Date:Sat, 20 Apr 2013 18:31:33 GMT
ETag:"6008d436-1108-4daceeec74ec0"
Last-Modified:Sat, 20 Apr 2013 18:23:31 GMT
Server:Apache
Via:1.1 varnish
X-Varnish:995972028
X-varnish-cache:MISS 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T20:24:44.393

假设 Varnish 正在通过所有 Apache 标头，您似乎没有设置任何标头告诉 Varnish 进行缓存。

Varnish 默认情况下会静默缓存 2 分钟，没有标题，但您可能想要更多。

出于您所说的原因，您还应该删除 Etag。关于 Etags 的更多信息在[这里](http://developer.yahoo.com/blogs/ydn/high-performance-sites-rule-13-configure-etags-7211.html)。

如果您有指纹资产（每次部署/更改），您应该在 Apache 中设置 1 年。

只要你能站起来，任何其他人都可以（请记住，这可能会阻止你经常更新这些资产，因为它们可能被缓存在某个地方）。

以下是您在 apache 中需要的行：

```
<LocationMatch "^/path/to/fingerprinted/assets/.*$">
    Header unset ETag
    FileETag None
    # RFC says only cache for 1 year
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
    Header append Cache-Control "public"
</LocationMatch> 
```

对于其他人：

```
<LocationMatch "^/bundles/viermediamagazine/icons/.*$">
    Header unset ETag
    FileETag None
    ExpiresActive On
    ExpiresDefault "access plus 1 week"
    Header append Cache-Control "public"
</LocationMatch> 
```

您可以使用任意数量的位置 - 只需确保它们不重叠！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T20:29:28.533

您发布的示例请求包含

```
Cache-Control:max-age=0 
```

这可以防止缓存的答案iirc。`Cache-Control: max-age=<x>`如果在响应中设置标题有帮助，您也可以尝试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T11:11:38.613

扩展其他答案：这是对 cloudControl 上的应用程序的示例请求，它缓存（当 ?c=1 时）。在任何情况下，多次发送请求，直到你得到一致的命中，以确保所有 Varnish 实例都缓存了响应。

```
$ curl -v http://impresstw.cloudcontrolled.com/?c=1
* About to connect() to impresstw.cloudcontrolled.com port 80 (#0)
*   Trying 46.137.184.215...
* connected
* Connected to impresstw.cloudcontrolled.com (46.137.184.215) port 80 (#0)
> GET /?c=1 HTTP/1.1
> User-Agent: curl/7.27.0
> Host: impresstw.cloudcontrolled.com
> Accept: */*
> 
< HTTP/1.1 200 OK
< Content-Type: text/html; charset=UTF-8
< Server: TornadoServer/2.4.1
< Cache-Control: max-age=36000, must-revalidate
< Expires: Tue, 23 Apr 2013 20:18:12 GMT
< Content-Length: 13
< Accept-Ranges: bytes
< Date: Tue, 23 Apr 2013 10:18:28 GMT
< X-Varnish: 1434600184 1434599691
< Age: 16
< Via: 1.1 varnish
< Connection: keep-alive
< X-varnish-cache: HIT
< 
```

# cakephp - Cakephp 2.x。如何从特定的 .po 文件中获取翻译？

> ID：16123961
> 
> 赞同：0
> 
> 时间：2013-04-20T18:52:14.643
> 
> 标签：cakephp, localization

有没有办法从具有特定语言的 .po 文件中获取翻译？

例如，即使我的默认蛋糕语言设置为希腊语，我也想从 .po 文件中获取英文翻译。

当然，我可以将默认的蛋糕语言设置更改为英语，然后再改回希腊语，但我觉得这样做效率不高。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T20:41:11.653

该`__()`函数在内部使用该`I18n::translate()`函数。所以你可以像这样直接调用它：

```
App::uses('I18n', 'I18n');
$translation = I18n::translate('το κείμενό μου', null, null, 6, null, 'eng'); 
```

# performance - 在 Fortran 中对多个矩阵进行加权和求和的最有效方法

> ID：16123970
> 
> 赞同：2
> 
> 时间：2013-04-20T18:53:20.357
> 
> 标签：performance, fortran

我正在尝试在 Fortran 中编写一个函数，它将多个具有不同权重的矩阵相乘，然后将它们加在一起形成一个矩阵。我已经确定这个过程是我程序中的瓶颈（这个权重将在程序的单次运行中进行*多次*，具有不同的权重）。现在我正试图通过从 Matlab 切换到 Fortran 来使其运行得更快。我是 Fortran 的新手，所以我感谢所有帮助。

在 Matlab 中，我发现进行此类计算的最快方法如下所示：

```
function B = weight_matrices()
n = 46;
m = 1800;
A = rand(n,m,m);
w = rand(n,1);
tic;
B = squeeze(sum(bsxfun(@times,w,A),1));
toc; 
```

在我的机器（Matlab R2012b，MacBook Pro 13" Retina，2.5 GHz Intel Core i5，8 GB 1600 MHz DDR3）上分配的行在`B`大约 0.9 秒内运行。应该注意的是，对于我的问题，张量`A`将是整个程序运行（初始化后）相同（常量），但 w 可以取任何值。此外，这里使用`n`和的典型值`m`，这意味着张量`A`在内存中的大小约为 1 GB。

我能想到的用 Fortran 写这个的最清晰的方法是这样的：

```
pure function weight_matrices(w,A) result(B)
    implicit none
    integer, parameter :: n = 46
    integer, parameter :: m = 1800
    double precision, dimension(num_sizes), intent(in) :: w
    double precision, dimension(num_sizes,msize,msize), intent(in) :: A
    double precision, dimension(msize,msize) :: B
    integer :: i
    B = 0
    do i = 1,n
        B = B + w(i)*A(i,:,:)
    end do
end function weight_matrices 
```

当使用 gfortran 4.7.2 编译时，使用 -O3（使用“call cpu_time(t)”计时的函数调用），此函数在大约 1.4 秒内运行。如果我手动将循环解包到

```
B = w(1)*A(1,:,:)+w(2)*A(2,:,:)+ ... + w(46)*A(46,:,:) 
```

该函数需要大约 0.11 秒才能运行。这很棒，意味着与 Matlab 版本相比，我得到了大约 8 倍的加速。但是，我仍然对可读性和性能有一些疑问。

首先，我想知道是否有更快的方法来执行矩阵的加权和求和。我查看了 BLAS 和 LAPACK，但找不到任何似乎适合的功能。我还尝试将`A`枚举矩阵的维度作为最后一个维度（即从元素切换`(i,j,k)`到`(k,i,j)`元素），但这会导致代码变慢。

其次，这个快速版本不是很灵活，而且实际上看起来很丑，因为对于这样一个简单的计算来说，它包含了太多的文本。对于我正在运行的测试，我想尝试使用不同数量的权重，以便 w 的长度会有所不同，以了解它如何影响我的算法的其余部分。但是，这意味着我`B`每次重写作业都相当繁琐。有什么方法可以让这更灵活，同时保持性能相同（或更好）？

第三，`A`如前所述，张量将在程序运行期间保持不变。我在我的程序中使用他们自己模块中的“参数”属性设置了常量标量值，并使用“使用”表达式将它们导入到需要它们的函数/子例程中。为张量做等效事情的最佳方法是什么`A`？我想告诉编译器这个张量在 init. 之后将是常量，以便可以进行任何相应的优化。请注意，`A`它的大小通常约为 1 GB，因此直接在源文件中输入它是不切实际的。

提前感谢您的任何意见！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T21:05:35.793

也许你可以尝试类似

```
 do k=1,m
       do j=1,m
          B(j,k)=sum( [ ( (w(i)*A(i,j,k)), i=1,n) ])
       enddo
    enddo 
```

方括号是 (/ /) 的一种更新形式，即一维矩阵（向量）。in`sum`是一个维度矩阵，对`(n)`所有`sum`这些元素求和。这正是您展开的代码所做的（并且不完全等于`do`您拥有的循环）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T08:48:06.817

我不会隐藏任何循环，因为这通常比较慢。您可以显式地编写它，然后您会看到内部循环访问超过了最后一个索引，从而使其效率低下。因此，您应该通过存储 A 来确保您的`n`维度是最后一个`A(m,m,n)`：

```
B = 0
do i = 1,n
    w_tmp = w(i)
    do j = 1,m
        do k = 1,m
            B(k,j) = B(k,j) + w_tmp*A(k,j,i)
        end do
    end do
end do 
```

这应该更有效，因为您现在正在内部循环中访问内存中的连续元素。

另一种解决方案是使用 1 级 BLAS 子例程 _AXPY (y = a*x + y)：

```
B = 0
do i = 1,n
    CALL DAXPY(m*m, w(i), A(1,1,i), 1, B(1,1), 1)
end do 
```

使用英特尔 MKL，这应该更有效，但您应该再次确保最后一个索引是在外部循环中发生变化的索引（在这种情况下是您正在编写的循环）。您可以在此处找到此调用的必要参数：[MKL](http://software.intel.com/sites/products/documentation/hpc/mkl/mklman/GUID-A491FDF5-ACA0-4EDC-8F74-00306D0EBE05.htm)

编辑：您可能还想使用一些并行化？（我不知道 Matlab 是否利用了这一点）

EDIT2：在凯尔的回答中，内部循环超过不同的值`w`，这比`n`重新加载的时间更有效，`B`因为`w`可以保存在缓存中（使用`A(n,m,m)`）：

```
B = 0
do i = 1,m
    do j = 1,m
        B(j,i)=0.0d0
        do k = 1,n
            B(j,i) = B(j,i) + w(k)*A(k,j,i)
        end do
    end do
end do 
```

这种显式循环的性能比使用全数组操作的 Kyle 代码要好 10%。带宽`ifort -O3 -xHost`约为 6600 MB/s，`gfortran -O3`约为 6000 MB/s，使用任一编译器的全阵列版本也约为 6000 MB/s。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T09:40:18.557

我试图完善 Kyle Vanos 的解决方案。

因此，我决定使用`sum`Fortran 的矢量功能。

*我不知道结果是否正确，因为我只寻找时间！*

**版本 1：（**用于比较）

```
B = 0
do i = 1,n
    B = B + w(i)*A(i,:,:)
end do 
```

**版本 2：（**来自 Kyle Vanos）

```
do k=1,m
   do j=1,m
      B(j,k)=sum( [ ( (w(i)*A(i,j,k)), i=1,n) ])
   enddo
enddo 
```

**版本 3：（**混合索引，一次处理一行/列）

```
do j = 1, m
    B(:,j)=sum( [ ( (w(i)*A(:,i,j)), i=1,n) ], dim=1)
enddo 
```

**版本 4：（**完整矩阵）

```
B=sum( [ ( (w(i)*A(:,:,i)), i=1,n) ], dim=1) 
```

**定时**

如您所见，我不得不混合索引以获得更快的执行时间。第三种解决方案真的很奇怪，因为矩阵的数量是中间索引，但这是内存顺序原因所必需的。

```
V1: 1.30s
V2: 0.16s
V3: 0.02s
V4: 0.03s 
```

最后，我想说的是，如果您有可能以任意顺序更改矩阵索引的顺序，您可以获得巨大的加速。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-30T10:06:10.170

我知道这是一篇旧帖子，但是当我使用大多数已发布的解决方案时，我很乐意带来我的贡献。

通过为权重循环添加本地展开（来自​​ Steabert 的回答），与完整展开版本相比（使用不同大小的矩阵从 10% 到 80%），我可以稍微加快速度。部分展开可以帮助编译器在一个 SSE 调用中向量化 4 个操作。

```
pure function weight_matrices_partial_unroll_4(w,A) result(B)
  implicit none
  integer, parameter  :: n = 46
  integer, parameter  :: m = 1800
  real(8), intent(in) :: w(n)
  real(8), intent(in) :: A(n,m,m)
  real(8)             :: B(m,m)
  real(8)             :: Btemp(4)
  integer             :: i, j, k, l, ndiv, nmod, roll
  !==================================================
  roll = 4
  ndiv = n / roll
  nmod = mod( n, roll )

  do i = 1,m
    do j = 1,m
        B(j,i)=0.0d0
        k = 1
        do l = 1,ndiv
          Btemp(1) = w(k  )*A(k  ,j,i)
          Btemp(2) = w(k+1)*A(k+1,j,i)
          Btemp(3) = w(k+2)*A(k+2,j,i)
          Btemp(4) = w(k+3)*A(k+3,j,i)
          k = k + roll
          B(j,i) = B(j,i) + sum( Btemp )
        end do

        do l = 1,nmod !---- process the rest of the loop
          B(j,i) = B(j,i) + w(k)*A(k,j,i)
          k = k + 1
        enddo
    end do
  end do
end function 
```

# html - 在大量 HTML 页面上放置一个通用的可调整大小的标题

> ID：16123972
> 
> 赞同：0
> 
> 时间：2013-04-20T18:53:33.270
> 
> 标签：html, html-table

我正在使用一个在 90 年代中期设计的旧网站，该网站的编码非常原始：通过表格完成的左侧菜单，没有 CSS 等。该网站由一堆 .html 页面组成。我不想重新编码站点，而是想保留所有内容，但在每个页面上放置一个标题，并带有标有“转到新站点”或类似内容的横幅。

这样横幅看起来很现代，但其他所有内容都可以保留复古外观（包括最重要的 URL 结构）。标题应为 100 像素高并填充整个水平空间，无论其下方的表格如何编码。计划是将新代码批量复制并粘贴到每个单独的页面中。

编写此标头的最佳方法是什么？

# linux - 获取 Linux 内核模块中现有设备类（结构类）的指针

> ID：16123973
> 
> 赞同：7
> 
> 时间：2013-04-20T18:53:36.507
> 
> 标签：linux, driver, device

获取`struct class`Linux 内核模块中现有设备类 ( ) 的指针

大家好！

我正在尝试在现有设备类中注册设备，但无法获取指向现有类的指针。内核版本为 Linux 3.3.6。我可以在模块中创建一个类，获取指向它的指针，然后使用它来注册设备：

```
*cl = class_create(THIS_MODULE, className);
dev_ret = device_create(*cl, NULL, *dev, NULL, driverName); 
```

但是，我需要使用另一个模块在同一类中注册另一个设备，但我找不到获取指向现有类的指针的方法。而且我无法在另一个模块中再次创建该类，因为由于类已经存在`class_create`返回 NULL 而不是指向`device_create`. 我发现：

[http://lwn.net/Articles/102500/](http://lwn.net/Articles/102500/)

通过名称返回指向类的指针的函数：

```
struct class * class_find(char * name) 
```

但是，当我尝试编译函数时，编译器说它不存在。我以为这个函数是由内核导出的（我的模块有 GPL 许可证），但它似乎不是。也许我需要包含一些标题？

我试图重写这个函数，因为它的代码在上面的链接中列出。但是当我尝试迭代`class_subsys`时：

```
list_for_each_entry(this_class, &class_subsys.kset.list, subsys.kset.kobj.entry) 
```

`class_subsys`现在找不到符号。我再次认为它已导出到内核。

我不确定缺少什么。一些标题？我做错了吗？还有另一个功能可以做到吗？

我想如果我可以从头开始遍历`sysfs`，我可以获得指向现有类的指针。但我也没有找到如何开始遍历`sysfs`。我见过的所有函数都需要一个指向`kobject`或`kset`开始遍历的指针。但是我什至没有指向根`sysfs`对象或内核对象的指针，所以我无法开始遍历树来获取类指针。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T15:44:06.087

我认为输入核心是这样完成的，这里是片段

看看：[https ://github.com/torvalds/linux/blob/master/drivers/input/input.c#L1720](https://github.com/torvalds/linux/blob/master/drivers/input/input.c#L1720)

此致！

# java - MediaPlayer 和 AudioTrack 不输出相同的声音

> ID：16123975
> 
> 赞同：0
> 
> 时间：2013-04-20T18:53:47.660
> 
> 标签：java, android, audio, signal-processing

我有一个名为“new.wav”的 wav 文件，我想通过 android 中的 MediaPlayer 和 AudioTrack 播放它：

```
String baseDir = Environment.getExternalStorageDirectory().getAbsolutePath();
String fileName = "new.wav";
File f = new File(baseDir + File.separator + fileName);
byte[] b = null;

try {
    b=this.readFile(f);
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

Log.i("123"," "+"length is "+b.length);
truncated=new byte[b.length-44];
truncated=Arrays.copyOf(b, b.length-44);
at=new AudioTrack(AudioManager.STREAM_MUSIC, 48000, AudioFormat.CHANNEL_OUT_MONO, AudioFormat.ENCODING_PCM_16BIT, truncated.length /* 1 second buffer */, AudioTrack.MODE_STREAM);
at.write(truncated, 0, truncated.length);
at.play();

mp = new MediaPlayer();

try {
    mp.setDataSource(baseDir + File.separator + fileName);
} catch (IllegalArgumentException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (SecurityException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IllegalStateException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

try {
    mp.prepare();
} catch (IllegalStateException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

两种方法都试过后，我发现他们的声音不一样，AudioTrack没有输出wav文件中的原声。我认为我的采样率很好，有人可以帮我解决这个问题吗？谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T18:39:33.427

正如我在上面的评论中所说，问题在于渠道的选择。

# silverlight - XAML 页面在发布模式下的行为不同

> ID：16123976
> 
> 赞同：2
> 
> 时间：2013-04-20T18:53:49.013
> 
> 标签：silverlight, windows-phone-7, xaml

我正在开发一个包含几页的 WP7 应用程序。在调试模式下一切看起来都很好，但是当更改为发布模式时，会发生两件坏事：

1.  一页保持完全空白（黑色主题中的黑色）而不会引发任何错误。但是，在 WYSIWYG XAML 编辑器中，它看起来完美无瑕。此外，执行后面的代码（使用调试器查看）。
2.  在另一个页面上，一个`ListBox`元素在完成后仍然为空`InitializeComponent()`。它在最初隐藏的内部`Popup`。

可能导致这些问题的发布版本和调试版本之间有什么区别？我不知道。

**更新**

当我逐步注释所有内容并重新注释时，第一个问题自行解决了。最后它在没有任何实际更改的情况下工作，所以我猜这是 Visual Studio 左右的缓存问题。

对于第二个问题，我找到了一种解决方法：将容器设置`Popup`为`IsOpen="True"`XAML 并在页面构造函数的最后关闭它（在`InitializeComponent()`调用之后）。但我仍然看不到它的原因。

# mysql - mysql 最多算每个国家两张表

> ID：16123977
> 
> 赞同：0
> 
> 时间：2013-04-20T18:53:50.050
> 
> 标签：mysql, greatest-n-per-group

对于统计数据，我想展示每个国家/地区的“最佳生产商”。有两个表：dog 和 owner。在主人有国家在狗是所有其他nessecary。我计算 dog.id 是父亲身份的频率。

对于我指定的一个国家

```
 $result = mysql_query("
    SELECT 
    dog.father_id,  dog1.id, dog1.dogname, dog1.owner_id, dog.date_of_birth,
    COUNT(dog.father_id) anzahl,
    owner.country_short
    FROM 
    dog

    LEFT JOIN dog as dog1 ON
    (dog.father_id = dog1.id)
    LEFT JOIN owner  ON
    (dog1.owner_id = owner.id)

    WHERE dog.father_id !=0     
    AND dog1.date_of_birth >= DATE_SUB(CURDATE(), INTERVAL 10 YEAR)

    AND owner.country_short ='de'

    AND owner.kennel_note =''
    GROUP BY 
    dog.father_id
    ORDER BY 
    anzahl DESC 
    LIMIT 3

     ", $db) OR die(mysql_error());

    while($row = mysql_fetch_array($result))
    { .... 
```

我该如何为每个国家做（从数据库中自动获取）？使用 SET @ 的解决方案会给我一个解析错误。非常感谢您的帮助。

# asp.net - ASP.NET 会话保持为“0”

> ID：16123980
> 
> 赞同：0
> 
> 时间：2013-04-20T18:54:09.407
> 
> 标签：asp.net, vb.net, session, session-state

我有一个包含以下代码的母版页：

```
<script runat="server">

    Protected Sub Page_Load(sender As Object, e As EventArgs)

        If Session("userid") = Nothing Then
            txtLoginUser.Visible = True
            txtLoginPass.Visible = True

        Else

            Dim conn As New SqlConnection("Data Source=BRIAN-PC\SQLEXPRESS;Initial Catalog=master_db;Integrated Security=True")
            Dim useridComm As String = "SELECT name, surname FROM users WHERE user_id=@userid"
            Dim sqlUserID As New SqlCommand

            conn.Open()

            Dim userid As String = Session("UserID")

            sqlUserID = New SqlCommand(useridComm, conn)
            sqlUserID.Parameters.AddWithValue("@userid", Convert.ToInt32(userid))
            Dim datareader As SqlDataReader = sqlUserID.ExecuteReader()

            datareader.Read()
            If datareader.HasRows Then

                userid = Session("UserID")

                lblLoggedIn.Text = "[Welcome, " + datareader("name").ToString() & " " & datareader("surname").ToString() + " ]"
                txtLoginUser.Visible = False
                txtLoginPass.Visible = False
                lblUsername.Visible = False
                lblRegister.Visible = False
                btnLogin.Visible = False
                lblUsername0.Visible = False

            End If
            datareader.Close()
            conn.Close()

        End If
    End Sub

   Protected Sub Button1_Click(sender As Object, e As EventArgs)

        Dim loginSQL As New SqlCommand
        Dim loginComm As String

        Dim CommonFunctions As New CommonFunctions()
        Dim dec_pass As String = CommonFunctions.EncryptPassword(txtLoginPass.Text.Trim)

        Dim conn As New SqlConnection("Data Source=BRIAN-PC\SQLEXPRESS;Initial Catalog=master_db;Integrated Security=True")

        loginComm = "SELECT user_id FROM users WHERE username=@username and password=@password"

        conn.Open()

        loginSQL = New SqlCommand(loginComm, conn)
        loginSQL.Parameters.AddWithValue("@username", txtLoginUser.Text.ToString)
        loginSQL.Parameters.AddWithValue("@password", dec_pass)
        Dim dr As SqlDataReader = loginSQL.ExecuteReader()
        dr.Read()

        If dr.HasRows Then
            Session("UserID") = dr("user_id")

        ElseIf dr.HasRows = False Then

            lblRegister.ForeColor = Drawing.Color.Red
            lblRegister.Text = "Incorrect Username/Password."
        End If

        dr.Close()
        conn.Close()

        Response.Redirect("Default.aspx")

    End Sub
</script> 
```

在 Button1 上单击脚本应该使用 获取 user_id`datareader`并创建 a`Session("UserID")`并将其传递给`Default.aspx`. `Default.aspx`然后获取`Session("UserID")`并搜索`user_id`具有相同值的 a 并使用`user_roles`表检查角色，如果`role_id`是 4 则`tblAdmin`显示，否则不显示。

这是 Default.aspx 的代码：

```
Imports System.Data.SqlClient

Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load

        Dim UserID As Integer = Convert.ToInt32(Session("UserID"))

        Dim conn As New SqlConnection("Data Source=BRIAN-PC\SQLEXPRESS;Initial Catalog=master_db;Integrated Security=True")
        Dim userTypeCommand As String = "SELECT role_id FROM users_role WHERE user_id=@UserID"
        Dim userTypeSQL As New SqlCommand

        conn.Open()

        Try

            userTypeSQL = New SqlCommand(userTypeCommand, conn)
            userTypeSQL.Parameters.AddWithValue("@UserID", UserID)

            Dim datareader As SqlDataReader = userTypeSQL.ExecuteReader

            If datareader("role_id").ToString = "4" Then

                tblAdmin.Enabled = True
                tblAdmin.Visible = True

            ElseIf datareader("role_id").ToString IsNot "4" Then

                tblAdmin.Visible = False

            End If

        Catch ex As Exception

        End Try

        conn.Close()

    End Sub

    Protected Sub btnCreateArticle_Click(sender As Object, e As EventArgs) Handles btnCreateArticle.Click

        Response.Redirect("addArticle.aspx")

    End Sub

    Protected Sub btnAdmin_Click(sender As Object, e As EventArgs) Handles btnAdmin.Click
        Response.Redirect("Admin.aspx")
    End Sub
End Class 
```

当我调试时，当我按下“登录”按钮后，user_id (Session('UserID') 保持为 0，而我用来登录的用户的 user_id 在表中为“12”。

我究竟做错了什么？

我正在使用 ASP.NET/VB.NET 和 SQL Server 2012。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:09:12.340

解决它。有一个失踪`datareader.Read()`。

# alfresco - 在 Alfresco 中部署 XML 工作流

> ID：16123985
> 
> 赞同：0
> 
> 时间：2013-04-20T18:54:38.520
> 
> 标签：alfresco

嗨盖兹，

我正在尝试在露天部署以下测试工作流定义，从 2 天开始 :(

```
<?xml version="1.0" encoding="UTF-8"?>
<process-definition xmlns="urn:jbpm.org:jpdl-3.1" name="helloWorld">
<start-state name="start">
<transition name="" to="hello"></transition>
</start-state>
<node name="hello">
<transition name="" to="end1">
<action class="org.alfresco.repo.workflow.jbpm.AlfrescoJavaScript">
<script>
logger.log("Hello World!");
</script>
</action>
</transition>
</node>
<end-state name="end1"></end-state>
</process-definition>" 
```

但是当我要通过“work-flow.jsp”在 alfresco 社区 4.2 中部署上述工作流定义时，它给了我以下错误消息。

“org.alfresco.service.cmr.workflow.WorkflowException：03200027 引擎 ID 'jbpm' 的工作流组件未注册”

请帮忙 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T17:50:03.627

默认情况下禁用 JBPM！

在线文档：[http ://docs.alfresco.com/4.1/topic/com.alfresco.enterprise.doc/tasks/adminconsole-workflow.html](http://docs.alfresco.com/4.1/topic/com.alfresco.enterprise.doc/tasks/adminconsole-workflow.html)

片段：在您的 alfresco-global.properties 中设置以下属性。

```
system.workflow.engine.jbpm.enabled=true
system.workflow.engine.jbpm.definitions.visible=true 
```

# google-chrome-extension - 在 Chrome 扩展中获得 tabid 后 window.open 不起作用

> ID：16123986
> 
> 赞同：1
> 
> 时间：2013-04-20T18:54:42.753
> 
> 标签：google-chrome-extension, tabs, window.open

我正在尝试在获取当前 tabid 后打开一个新选项卡，以便可以将新打开的选项卡中的消息传递到上一个选项卡，我正在这样做：

**myscr.js：**

```
var myvar = 0;
chrome.tabs.query({
  currentWindow: true,
  active: true
}, function (tabs) {
  console.log(tabs[0]);
  myvar = tabs[0].id;
  //console.log(myvar);
});
var string_url = "getfilehandler.html/?" + "tabid=" + myvar;
window.open(string_url); 
```

**清单.json：**

```
"permissions": [
    "tabs",
    "contextMenus", "fileBrowserHandler"
],
"content_scripts": [
  {
    "matches": ["file:///home/user/Desktop/itproject/test.html"],
    "js": ["myscr.js"]
  }
], 
```

我的问题是当我打开文件时`test.html`，浏览器似乎什么都没有发生！

新窗口在我使用时`window.open(...)`打开`myscr.js`。我不确定为什么会这样！任何帮助将不胜感激！

变化：

```
chrome.tabs.query({
    active: true,                              // Select active tabs
    windowId: chrome.windows.WINDOW_ID_CURRENT // In the current window
}, function(array_of_Tabs) {
    // Since there can only be one active tab in one active window, 
    //  the array has only one element
    var tab = array_of_Tabs[0];
    // Example:
    var url = tab.url;
console.log(url);
    // ... do something with url variable
}); 
```

# coffeescript - 如何更正 CoffeeScript 蛋糕文件

> ID：16123987
> 
> 赞同：0
> 
> 时间：2013-04-20T18:54:57.150
> 
> 标签：coffeescript

以下 CoffeeScript cakefile 不显示任何输出：

```
{exec} = require 'child_process'
task 'watch', 'watch current directory and corrects the map file', (cb)->
    console.log 'hello world'
    exec 'coffee -w -b -m -c .' ,(err,stdout,stderr) ->
        console.log err
        console.log stdout
        throw err if err
        console.log stdout + stderr 
```

它正在编译所有文件，但是当我在咖啡文件中出错时，它不会抛出错误，也不会显示任何关于编译文件的信息。但是 exec 命令在单独尝试时确实会显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T04:43:50.027

尝试 spawn 而不是 exec。我的猜测是 exec 期待一个缓冲区，但咖啡正在提供一个流。

# java - DatePicker 未选择属性 onkeypress="return false"

> ID：16123990
> 
> 赞同：-2
> 
> 时间：2013-04-20T18:55:29.630
> 
> 标签：java, javascript, html, webdriver

我必须从日期选择器 UI 中选择任何日期。
上述场景在自动化我的测试脚本时遇到了两次，对于第一个测试用例，我能够成功地从日期选择器中选择日期，而在第二个测试用例中，我无法从日期选择器中选择日期。

第一个测试用例中日期选择器字段的 html 如下

```
input id="start-date" class="dateClass" type="text" name="startDate" 
```

而对于第二个测试用例，HTML 是

```
 input id="from-date" class="dateClass" type="text" autocomplete="off" onkeypress="return false" required="" name="fromDate" 
```

我认为由于 onkeypress 属性，我的第二个测试脚本无法选择日期选择器。

是否有任何可能的方法来更改 onkeypress 以在我的脚本中返回 true 并像我在第一个测试脚本中所做的那样选择日期选择器。我正在使用 Selenium WebDriver 来自动化我的脚本。

请提出一些自动选择日期并将所选值发布到日期字段的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T14:47:51.457

HTML 中没有“日期选择器”之类的东西（至少在 HTML5 之前`<input type="date"/>`）。相反，有许多不同的实现使用一些 HTML 和/或 JavaScript 集合来模拟某种日历小部件。这些实现中的每一个都是不同的，需要在 WebDriver 中进行不同的处理。您显示的 HTML 片段表明您拥有众多 JavaScript 版本之一，但不是哪个版本。

# ios - 从 UICollectionViewCell 到 UIScrollView 中的正确位置

> ID：16123991
> 
> 赞同：1
> 
> 时间：2013-04-20T18:55:38.207
> 
> 标签：ios, objective-c, uiscrollview, uicollectionview

我的 中有一些图像`UIScrollView`，如果我点击它们，我希望有一个`UIScrollView`可以滚动浏览所有图像的位置（就像在照片的应用程序中一样）。我得到了这个代码：

集合视图控制器：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    //ImageDetailSegue
    if ([segue.identifier isEqualToString:@"ScrollView"]) {
        Cell *cell = (Cell *)sender;
        NSIndexPath *indexPath = [self.collectionView indexPathForCell:cell];

        int imageNumber = indexPath.row % 9;

        ScrollViewController *divc = (ScrollViewController *)[segue destinationViewController];
        divc.img = [UIImage imageNamed:[NSString stringWithFormat:@"full%d.png", imageNumber]];
    }
} 
```

滚动视图控制器：

```
for (int i = 1; i < 4; i++) {
    UIImageView *image = [[UIImageView alloc] initWithImage:[UIImage imageNamed:[NSString stringWithFormat:@"full%d.png", i]]];

    image.frame = CGRectMake((i - 1) * 320, 0, 320, 240);
    [imageScroller addSubview:image];
}
imageScroller.contentSize = CGSizeMake(320 * 6, 240); 
```

我怎样才能连接这两个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T02:06:18.193

如果您的收藏视图有 50 张图片，并且您单击 #5，您是说您想查看一个滚动视图，其中包含相同的 50 张图片，但从图片 #5 开始？

基本上，这都是模型支持`UICollectionView`控制器的功能。例如，假设集合视图有一个数组（可能是图像名称数组，也可能是图像文件名是其中一个属性的对象数组），如下所示：

```
@property (nonatomic, strong) NSMutableArray *objects; 
```

然后第二个场景可能有一个反映该属性的属性，例如：

```
@property (nonatomic, weak) NSArray *objects; 
```

第一个属性将是对支持其集合视图的主视图控制器数组的不可变引用。

你的滚动视图也应该有一些索引属性，所以你可以告诉它你选择了哪个单元格：

```
@property (nonatomic) NSInteger index; 
```

第二个视图控制器可以使用这个`index`属性来确定从哪里开始它的`contentOffset`.

然后第一个控制器`prepareForSegue`看起来很像你建议的：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"ScrollView"])
    {
        Cell *cell = (Cell *)sender;
        NSIndexPath *indexPath = [self.collectionView indexPathForCell:cell];

        ScrollViewController *divc = (ScrollViewController *)[segue destinationViewController];
        divc.objects = self.objects;
        divc.index = indexPath.item;
    }
} 
```

请注意，我建议集合视图和滚动视图都不要维护图像数组（因为您可能会很快遇到内存问题）。如果它是一组图像名称或图像 URL，那就更好了。然后您可以`cellForItemAtIndexPath`根据需要检索图像，但随后您可以享受集合视图的全部内存效率。我建议滚动视图采用类似的技术。（为了让自己的生活更轻松，您可能想要考虑将第二个场景设置为水平集合视图（每个单元格本身占据全屏），或者为自己找到一个很好的无限滚动滚动视图类，可以有效地处理其内存。）

# opengl - 如何将 Direlect3 与 Mono-D 一起使用

> ID：16123992
> 
> 赞同：0
> 
> 时间：2013-04-20T18:55:46.583
> 
> 标签：opengl, monodevelop, d

我想知道在 Mono-D 中是否可以使用 Direlect3，我在这里下载了所有内容：[https](https://github.com/aldacron/Derelict3/blob/master/README.markdown) ://github.com/aldacron/Derelict3/blob/master/README.markdown但我不知道如何组合使用它与 Mono-D。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T15:15:07.670

据我了解，Derelict3 只是一个框架（一个库，为了简化）。如果它在您项目的搜索路径中（编译器的 -I 标志），那么 Mono-D 将为您提供代码完成。当然你必须自己配置你的 Mono-D 项目。如果您自己编写 Makefile（更多/更少），您会做同样的事情。真的应该直截了当。

# php - 如果我想开发一种新的“注册和登录”方法，我应该使用什么编程语言？

> ID：16123993
> 
> 赞同：0
> 
> 时间：2013-04-20T18:55:46.883
> 
> 标签：php, mysql, security, login, registration

如果我想开发一种具有不同逻辑的新“注册和登录”方法，使用数学方程式和简单算法来提高当前注册和登录步骤的安全性，我应该使用什么编程语言？我寻求编码的简单性和处理脚本的高速能力。

我发现我可以使用 PHP ..！这是一个正确的选择吗？或者有一种最简单的编程语言可以帮助我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:00:54.480

如果您使用的是 Web 界面，那么它可能是正确的解决方案，因为您的复杂性不会太高。对于非常高的复杂性（长时间运行），可能使用 PHP 调用的 C。

如果您使用某些（桌面）游戏，那么存在更好的解决方案，例如真正的编译语言。

最好使用一些预定义的算法，你知道它们是安全的。您自己的算法可能存在您自己无法想象的安全问题。

# c# - 如何指定以应用程序域中立的方式加载程序集

> ID：16123995
> 
> 赞同：4
> 
> 时间：2013-04-20T18:56:06.893
> 
> 标签：c#, .net, dynamics-crm-2011

有没有办法指示 CLR 将类库程序集加载为域中立？用例是 MSCRM 插件，其中每个插件都加载到单独的应用程序域中，并且需要“实用程序”库的服务，该库可能非常大（10 多兆），并且能够加载单个副本会很整洁跨所有应用程序域共享的代码页，从而减少整个进程的内存占用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T22:57:40.483

您可以将程序集加载为域中性，您需要将属性 LoaderOptimization 应用为 MultiDomain。查看这篇[文章](http://msdn.microsoft.com/en-us/library/43wc4hhs%28v=vs.100%29.aspx)以了解如何做到这一点。

# c - 下面的代码可能出了什么问题？

> ID：16123997
> 
> 赞同：-1
> 
> 时间：2013-04-20T18:56:13.153
> 
> 标签：c, multithreading, buffer, buffer-overflow

```
char* function (char* s)
{
    char buffer[1024];
    strcpy(buffer,s);
    buffer[strlen(s)-1]='\n';
    return buffer;
} 
```

对于此功能，我认为此代码可能会失败的三件事：

1.  如果 s 大于缓冲区，strcpy 会失败吗？
2.  如果 s 为空，那么函数中的第三行会失败吗？
3.  在多线程的情况下，这段代码会发生什么？它只会影响strcpy吗？（函数中的第二行）

你怎么看？还有更多可能失败的事情吗？我的假设之一错了吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:18:06.133

就多线程而言，如果指向的内存`s`被另一个线程修改或变得无效（例如它被另一个线程释放），这个函数将无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:00:26.983

首先，`gcc-4.8 -Wall`给你一个警告： `function returns address of local variable`

您不能有意义地返回本地数组（或字符串）。至少，声明它`static`（但这不是多线程友好的）。

然后，`strcpy`应该`if (s) strncpy(buffer, s, sizeof(buffer))`避免缓冲区溢出，并避免取消引用空指针（如果`s == NULL`）。

并且您想在换行符之后将字符串归零，因此编写类似的代码

```
size_t slen = s?strlen(s):0;
if (slen>=sizeof(bufber)-1) slen=sizeof(bufber)-2;
memcpy(buf, s, slen);
buffer[slen-1] = '\n';
buffer[slen] = (char)0; 
```

除非`buffer`是静态的，否则您希望`return strdup(buffer);`调用者应确保它`free`稍后变为 -d。

你**真的想要** `strdup`或者最好[是 asprintf](http://linux.die.net/man/3/asprintf)

```
char* addnewline(const char*s)
{
   char* dynbuf = NULL;
   if (!s) return NULL;
   asprintf(&dynbuf, "%s\n", s);
   return dynbuf;
} 
```

具有重要*约定*，**调用者`addnewline`应确保结果为`free`-d**。

您应该返回堆分配的内存，并且您应该有一个约定来定义谁将释放它。

您甚至可以使用[Boehm 的 GC](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)，即它`GC_strdup`而不用费心释放自己的结果。

如果你不想使用`asprintf`，因为它只是 GNU，那么代码

```
char* addnewline(const char*s) {
  if (!s) return NULL;
  size_t sz = strlen(s);
  char* dynbuf = malloc(sz+2);
  if (!dynbuf) { perror("addnewline malloc"); exit(EXIT_FAILURE); };
  memcpy(dynbuf, s, sz);
  dynbuf[sz] = '\n';
  dynbuf[sz+1] = (char)0;
  return dynbuf;
} 
```

但是您确实希望结果`addnewline`是堆分配的约定，并且应该`free`在调用后使用 -d 。