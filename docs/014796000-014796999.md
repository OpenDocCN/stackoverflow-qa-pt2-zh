# StackOverflow 问答 14796000-14796999

# jquery - 如何读取通过 ajax/jquery 发送的 perl 中的 json 数据？

> ID：14796000
> 
> 赞同：-1
> 
> 时间：2013-02-10T08:30:49.270
> 
> 标签：jquery, ajax, json, perl

在 html 字段中输入 id 后，我尝试在同一页面上执行简单的 mysql 返回。

我通过 ajax 将它发送到一个 perl 脚本，该脚本应该在数据库中进行搜索并获得名称的结果。

我在网上搜索尝试了不同的选项，但我找不到我正在寻找的正确答案。

我正在尝试获取一个 ID 号，将其发送到数据库并获取此 ID 联系人的姓名。

这是我的html代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<head>
<script language="javascript" type="text/javascript">
var xmlHttp = new XMLHttpRequest();
</script>
<META charset="utf-8">
<TITLE>Ajax-tool</TITLE> 
</head>

<body>
<form id="procform" name="procform" method="POST" action="">
<b>Contact ID:</b>
<fieldset>
<input type="text" id="CID" name="CID" size="20" />
<p><input type="submit"></p>
</fieldset>
</form>
<p></p>
<div id="content"></div>

<SCRIPT type="text/javascript" src="/js/jquery.js"></SCRIPT>
<SCRIPT type="text/javascript" src="js/jquery-ui.min.js"></SCRIPT>
<SCRIPT type="text/javascript" src="/js/ajax01.js"></SCRIPT>
</body>
</HTML> 
```

jQuery 脚本：

```
$(document).ready(function() {
    $("form#procform").submit(function() {
    var id =    $("#CID").val();
    var jsondata = { 'CID' : id };
        $.ajax({
            type: "POST",
            url: "http://192.168.10.1/cgi-bin/ajax01.pl",
                async: false,
                contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: {CID: id},
            success: function(result) {
                $("div#content").text("data.success: " + data);
                //alert(data);
            },
            error: function (request, status, error) {
                alert(request.responseText);
            }
        });
//alert( + id + "");
    });
}); 
```

和 perl 脚本：

```
#!/usr/bin/perl -T

use CGI ":all";
use DBI;
#use strict;
use warnings;
use Encode;
use JSON;
use Storable;
#$foo = CGI->new;

#$foo->charset('utf-8');
$json = JSON->new->allow_nonref;

$dbh = DBI->connect('mylogin)
                || die "Could not connect to database: $DBI::errstr";
#my $cidID   = CGI->new->param( 'CID' );

my $cidID   = $json->decode('CID');
#my $cidID  = $foo->param('CID');
#$cidID = 44;

#########    select contact name from contacts    ##############
$sth0 = $dbh->prepare("SELECT * FROM  contacts WHERE cid= $cidID")or "can't prepare : $DBI::errstr\n";

$sth0->execute()or die "Can't execute: $DBI::errstr\n";

@row0 = $sth0->fetchrow_array;

my $VCName3 = $row0[1];

$sth0->finish();
print $VCName3;

my $json1 = $json->encode($VCName3);

print $foo->header(-type => "application/json", -charset => "utf-8");
print $json1; 
```

如果我在 perl 脚本中给 cidID 一个值并删除 json 头部的整个定义，我会得到 cidID 的正确结果。

但问题是从 ajax 获取正确的数据到 cidID 中。

**更新**

我是新来的，所以我不知道是要删除上面的部分还是留给其他人学习..

但是-作为示例，我再次查看了网络并对代码进行了一些更改-

在 ajax 中，我将方法从“POST”更改为“GET”

现在它正在工作，我不知道为什么它不能与 POST 一起工作，有什么想法吗？

但是当我想在 DIV 中显示结果时，它只会闪烁片刻并且不会停留在那里。

有什么方法可以将结果返回到变量中以便在 jquery 中进一步使用？我试过 -

```
var result = $(data.userid); 
```

没有任何成功。

这是它们工作方式的代码-

**HTML**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<head>
<script language="javascript" type="text/javascript">
var xmlHttp = new XMLHttpRequest();
</script>
<META charset="utf-8">
<TITLE>Ajax-tool</TITLE> 
</head>

<body>

<form id="procform" name="procform" method="POST" action="">
<b>Contact ID:</b>
<fieldset>
<input type="text" id="CID" name="CID" size="20" />
<p><input type="submit"></p>
</fieldset>
<p></p>
<div id="content"></div>
</form>
<SCRIPT type="text/javascript" src="http://192.168.10.1/js/jquery.js"></SCRIPT>
<SCRIPT type="text/javascript" src="http://192.168.10.1/js/jquery-ui.min.js"></SCRIPT>
<SCRIPT type="text/javascript" src="http://192.168.10.1/js/ajax01.js"></SCRIPT>
</body>
</HTML> 
```

**查询**

```
$(document).ready(function() {
    $("form#procform").submit(function() {
    var id =    $("#CID").val();
    var jsondata = { 'CID' : id };
        $.ajax({
            type: "GET",
            url: "http:/cgi-bin/ajax01_1.pl",
                async: false,
                contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: "CID=" + id,
            success: function(data) {
                $("div#content").append("Name: " + data.userid);
                //alert("Name: " + data.userid);
            },
            error: function (request, status, error) {
                alert(request.responseText);
            }
        });
    });
}); 
```

**PERL**

```
use DBI;
use strict;
use warnings;
use Encode;
my $foo = CGI->new;
my $cidID = $foo->param("CID");

my $dbh = DBI->connect('here goes my login passw ect..')
                || die "Could not connect to database: $DBI::errstr";

my @row0;
#########    select contact name from contacts    ##############
my $sth0 = $dbh->prepare("SELECT * FROM  contacts WHERE cid= ?")or "can't prepare : $DBI::errstr\n";

$sth0->execute($cidID)or die "Can't execute: $DBI::errstr\n";

@row0 = $sth0->fetchrow_array;

my $VCName3 = $row0[1];

$sth0->finish();
print $VCName3;

my $json1 = ($VCName3)? 
  qq{{"success" : "login is successful", "userid" : "$VCName3"}} : 
  qq{{"error" : "username or password is wrong"}};;

print $foo->header(-type => "application/json", -charset => "utf-8");
print $json1; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T10:22:19.360

你的 Perl 脚本充满了古怪。我建议在想知道是否可能存在实际问题之前先解决这些奇怪的问题。

1.  `use strict`. 严重地。这将指出许多错误来源。它会强制你声明你的变量（用`my`）。这是一件好事。
2.  取消注释`$foo = CGI->new`，因为您稍后会实际*使用*该对象。但是为此，该变量确实应该使用对象进行初始化。此外，将其重命名为合理的名称，并声明变量：`my $cgi = CGI->new;`。[→ 不朽的 CGI 文档](https://metacpan.org/module/CGI)
3.  你忘了一个报价`'mylogin`。
4.  哦，当你`die`ing 的时候：如果你死了，那条错误信息最终会出现在你的日志中。该程序将产生更多错误，因此您应该积累了相当多的条目。看看他们也许，并解决问题！此外，您可能希望在开发期间向浏览器发送错误。用`use CGI::Carp qw/fatalsToBrowser/;`. [→ CGI::Carp 文档](https://metacpan.org/module/CGI::Carp)
5.  阅读[JSON 文档](https://metacpan.org/module/JSON)。确保那`decode`不是`decode_json`你真正想要的东西（`decode_json`假设是 UTF-8）。两种方法都需要一个 JSON 字符串。Perl 字符串`my $not_json = q/CID/`不是*有效*的JSON。那将是`my $json = q/"CID"/`。看到报价了吗？
6.  我仍然假设您想从 POST 或 GET 请求中读取参数。一旦你遵循提示№ 2，那应该会再次起作用。
7.  我不知道 SQL，但我知道你做错了。永远不要在 SQL 语句中插入变量，否则您正在*招致*注入攻击！使用参数化语句：`my $sth = $dbh->prepare('SELECT * FROM contacts WHERE cid = ?') or die ...`，然后以实际变量作为参数执行它`$sth->execute($cidID) or die ...`。
8.  `$sth->fetchrow_array`仅获取一行，但您选择*了所有*行。要么修复你的 SQL，所以你只选择第一行，或者遍历所有行！`while (my @row = $sth->fetchrow_array){ do something @row }`. [→ DBI 文档](https://metacpan.org/module/DBI)
9.  你`print $VCName3`在打印标题之前！这可能会产生很多`500`错误。不要那样做。
10.  您指定您的 JSON 以`UTF-8`. 也许您应该使用`encode_json`.

[[在这里插入关于十诫的笑话]]

解决这些问题后，问题可能会或可能不会仍然存在。如果是这样，请更新您的问题并发表您这样做的评论。然后，我们将研究如何解决这些*实际*问题。

# c++ - 节点n和新节点之间的区别

> ID：14796001
> 
> 赞同：-2
> 
> 时间：2013-02-10T08:31:11.043
> 
> 标签：c++

如果我在 C++ 中声明一个结构节点，之后我声明：

```
n = new node; 
```

或者

```
node n; 
```

这两个符号代表同一个东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:34:18.950

不。

```
n = new Node; 
```

是一个指针，正确的代码是

```
Node* n = new Node; 
```

或者，使用[C++11](http://en.wikipedia.org/wiki/C++11)（2011 年发布的最新 C++ 标准，ant 尚未被多个编译器实现，即使最新的 GCC 4.7 或即将发布的 4.8 已经很近了）

```
auto n = new Node; 
```

实际上，不赞成使用像上面这样的原始指针。您应该考虑使用[智能指针](http://en.wikipedia.org/wiki/Smart_pointer#C.2B.2B_smart_pointers)，例如

```
std::shared_ptr<Node> n = new Node; 
```

指向的节点将被稍后调用（可能是间接的）销毁

```
delete n; 
```

^(（请注意，智能指针会“神奇地”为您做到这一点）)

但

```
Node n; 
```

声明一个类型的变量`Node`。该`Node`数据在当前范围的末尾被销毁（即在`}`包含大括号的右括号处）。

另请阅读有关[RAII](http://en.wikipedia.org/wiki/RAII)的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T08:33:12.073

1.  `node* n = new node;`在堆上分配
2.  `node n;`在堆栈上分配

**情况 1.**当您使用`new`必须使用的关键字在堆上分配时，`node*`因为您保存的是指向对象而不是对象本身的指针。当您要在当前范围之外使用对象时，使用堆分配特别有用，尽管您必须始终记住调用`delete n;`使用关键字分配的每个对象`new`（除非您正在使用`std::shared_ptr`或任何类似的东西）。

```
node* make_node()
{
    node* n = new node;
    n->do_something();
    return n;
} // node n does not go out of scope here, but you'll have to call delete on it when you're done 
```

**在情况 2.**对象正在堆栈上分配，虽然您不必`delete`在这里调用，但这个对象将在当前块的末尾超出范围：

```
void function()
{
    node n;
    n.do_something();
} // node n goes out of scope here. 
```

* * *

有关[std::shared_ptr](http://en.cppreference.com/w/cpp/memory/shared_ptr)和其他`<memory>` [好东西](http://en.cppreference.com/w/cpp/memory)的附加信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T08:33:05.193

虽然它们代表相同的东西，`n`但在第二种情况下是在堆栈上创建的，而`n`in`n = new node;`是在堆存储上创建的，必须手动`delete`d.

此外，`n`in`n = new node`必须是一个指针，像这样创建：`node* n;`

# redirect - 防止 Google 图片搜索中的图片盗链

> ID：14796003
> 
> 赞同：11
> 
> 时间：2013-02-10T08:31:27.303
> 
> 标签：redirect, search-engine, hotlinking

就在最近，谷歌推出了他们的图片搜索的新界面。从 2013 年 1 月 25 日起，全尺寸图像直接在 Google 内部显示，无需将访问者引导至源站点。**我遇到了一个网站，该网站显然开发了一种复杂的方法，通过动态**引入某种水印来防止用户从 Google 抓取图像。要查看此内容，请在新的 Google 图片搜索界面中搜索“fansshare.com”的图片。这个链接应该可以工作：[谷歌图片搜索](https://www.google.com/search?hl=en&tbo=d&tbm=isch&q=jessica%20biel%20gq&oq=&gs_l=&biw=1183&bih=708&sei=3VkXUcLdFsnHswbd4oHIDQ#hl=en&tbo=d&tbm=isch&sa=1&q=site%3afansshare.com&oq=site%3afansshare.com&gs_l=img.3...0.0.2.10846.0.0.0.0.0.0.0.0..0.0...0.0...1c..2.img.AWfe_f3vWxE&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42080656,d.Yms&fp=da7d521736767550&biw=1183&bih=708)。如果没有，只需在 Google 搜索输入字段中输入“site:fansshare.com”。不过，请务必使用新的搜索界面。

fanshare.com 是如何做到这一点的？我想不通...

**更新：**

fanshare.com 将 GET 参数添加到他们所有的图像 URL，例如*?rnd=69*。示例图片网址： http: [//fansshare.com/media/content/570_Jessica-Biel-talks-Kate-Beckinsale-Total-Recall-fight-5423.jpg?rnd=62](http://fansshare.com/media/content/570_Jessica-Biel-talks-Kate-Beckinsale-Total-Recall-fight-5423.jpg?rnd=62)

此图像 URL 可以使用几个调用或几秒钟，然后重定向到缓存的带水印图像： [http ://fansshare.com/cached/?version=media/content/570_Jessica-Biel-talks-Kate-Beckinsale -Total-Recall-fight-5423.jpg&rnd=5810](http://fansshare.com/cached/?version=media/content/570_Jessica-Biel-talks-Kate-Beckinsale-Total-Recall-fight-5423.jpg&rnd=5810)

**编辑：**

我们终于成功地完全模仿了 FansShare 的热链接保护，我们在以下内容广泛的博客文章中发布了我们的发现：

**[http://pixabay.com/en/blog/posts/hotlinking-protection-and-watermarking-for-google-32/](http://pixabay.com/en/blog/posts/hotlinking-protection-and-watermarking-for-google-32/)**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T18:13:14.673

有一个解决方案，但就像其他解决方案一样，由 Google 将其解释为根据自己的意愿进行伪装和禁止。这是一个很长的问题，可能需要进一步修改才能为您的案例工作。（提前抱歉的长度）

**设置**

为了这个例子，让我们这么说：

*   网站：`www.thesite.com`和
*   ImageURL 基础：`images.thesite.com`

（但 ImageURL 基础很容易`www.thesites.com/wp-content/uploads`）

**目标**

我们的目标是做到这一点，（1）如果谷歌图像搜索请求全尺寸图像，则仅显示带有水印/叠加层的图像，并且（2）不要破坏以前工作的东西。

**解决方案**

所以理论上的解决方案如下。

**1)**检查用户代理，如果它包含，`Googlebot`则提供“陷阱”URL。陷阱 URL 是您当前的图像 URL，但稍有更改，因此您可以区别对待它，而不是当前的正常 URL：

`http://images.thesite.com/wallpapers/awesome.jpg`

您应该为 Googlebots 打印：

`http://cacheimages.thesite.com/wallpapers/awesome.jpg`

（`cacheimages`你想要的东西在哪里）

**2）**现在是主菜；您应该能够将请求定位到`http://cacheimages.thesite.com/`并具有如下行为的脚本：

```
 If the request comes from a bot (check user-agent headers)
     Then serve the normal image without watermark
 Else (if the request seems to be from a normal user)
     Then check the referer: If it's from google (but NOT http://www.google.com/blank.html)
          Redirect to the Post of the image (Note 1.)
     Else if the refer is your site
          Show the raw normal image
     Else (any other referer, including http://www.google.com/blank.html)
          Show watermarked image (Note 2.) 
```

*注 1*：当人们点击“查看原始图片”或图片本身时会发生这种情况

*注意 2*：当人们尝试从谷歌图片搜索结果中查看全尺寸图片时会发生这种情况（如果他们以某种方式到达图片的陷阱 url）

**3）**如果用户代理是 Googlebots，您可以 HTTP 将旧图像重定向到新的 ImageURL 基础，因此覆盖/水印技巧可以更快地开始处理旧图像（如果您使用图像子域，甚至可以使用 Google 网站管理员工具）并且您是确保保留 SEO 汁液。

**进一步行动**

如果你想认真一点，你可以做更多的改变。

1.  而不是显示带水印的图像重定向到更动态`http://cacheimages.thesite.com/preview?p=/wallpapers/awesome.jpg&r=23535` 的 url 或更现代地使用 HTTP 标头来无索引： `X-Robots-Tag: noindex`
2.  当然缓存带水印的图像
3.  检查`Accept`http 标头以查找我没有想到的情况，并相应地提供图像或重定向图像帖子。

**笔记**

您可能还需要考虑国际流量，而不是`google.com`您想检查`google.[a-z-\.]+/`

**结论**

这可以适用于任何系统，我是为在子域上有图像的系统做的，所以它可能不会与 wordpress 等其他系统完全相同。另外，我相信谷歌会改变他们的图像在接下来的几个月中搜索以解决此问题。

可以在[Github](https://github.com/sevastos/google-image-trap)上找到该想法的未经测试的示例实现。

**免责声明**

这尚未经过彻底测试，您可能会被禁止，它仅用于研究和教育目的。我不对任何损坏等负责。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T05:53:47.893

一些新的 wordpress 插件可用于处理 google 和 bing 热链接图像：

[http://wordpress.org/extend/plugins/imaguard/](http://wordpress.org/extend/plugins/imaguard/) [http://wordpress.org/extend/plugins/google-break-dance/](http://wordpress.org/extend/plugins/google-break-dance/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:04:48.623

嗨，这里有一个新插件可以解决 WordPress 上的这个问题

[https://github.com/mompracem/direct-images-redirect](https://github.com/mompracem/direct-images-redirect)

它不使用带水印的图像，而是将尝试直接访问图像的用户重定向到该图像最初附加到的帖子或页面。

这是一个新插件，因此可能有一些错误，请通过 github 测试并报告问题，谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T01:59:33.500

嗯...关于向 Googlebots 发送不同的图片或网址，与普通用户相比是不行的！图像应该是静默重定向（）。

对于 Wordpress 博客，我认为**WP-PICShield**是最好的选择之一！

*   缓存支持，
*   直通图像请求
*   反 IFRAME 保护，
*   自定义图像透明度
*   自定义PNG水印
*   图像上的主机名作为 url 和/或 QR-BarCode !!!
*   将直接链接重定向到：附件、单个/图库或主页
*   防止未经授权的请求
*   避免大文件的内存错误
*   允许在线翻译
*   允许社交网站的分享按钮：Facebook、Pinterest、Thumblr、Twitter、Google Plus
*   通过 RPC 允许 Wordpress，通过 OAuth 允许 Twitter
*   手动清除缓存脚本避免 php 限制执行
*   允许远程ip列表
*   +++ CDN 工具和帮助

和更多...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-31T00:59:10.027

我终于找到了一种方法来[阻止 Google 图片搜索在](http://inthelimelight.net/stop-google-image-search-from-hotlinking-your-photos-without-a-plugin-bing-too/)不使用插件的情况下对我的照片进行热链接。我希望这对仍在处理谷歌这一完全邪恶决定的后果的人有所帮助。

# java - JQuery AJAX Done 没有执行

> ID：14796008
> 
> 赞同：0
> 
> 时间：2013-02-10T08:32:55.583
> 
> 标签：java, jquery, ajax, json

```
$('#loginForm').submit(function(e){

        var $inputs = $(this).find("input");
        var serializedData = $(this).serialize();   
        $inputs.prop("disabled", true);

        var request = $.ajax({
            url: "myurl",
            dataType: "json",
            type: "GET",
            data: serializedData,
        });

        request.done(function (response, textStatus, jqXHR){
            $('#loginMessage').text('GOOD');
        });

        request.fail(function (jqXHR, textStatus, errorThrown){
            $('#loginMessage').text('Some error occured. Please try again');
            console.error("The following error occured: ",errorThrown,jqXHR);
        });

        request.always(function () {
            $inputs.prop("disabled", false);
        });
        // prevent default posting of form
        e.preventDefault();         
    }); 
```

我是 jquery 的新手，在上面的代码中 .done 块没有执行，firebug 控制台显示此消息：-

`GET myurl?userID=aman&password=aman`200 OK 37ms jquery....min.js（第 2 行）

发生以下错误：（空字符串）`Object { readyState=0, status=0, statusText="error"}`

**服务器端脚本**

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter("userID");
        String password = request.getParameter("password");
        System.out.println("GET");
        response.setContentType("application/json");
        PrintWriter out = response.getWriter();
        Gson gson = new Gson();
        if(username.equals("aman") && password.equals("aman")){
            out.println(gson.toJson(new Boolean("true")));
        }else{
            out.println(gson.toJson(new Boolean("false"))); 
        }
        out.close();
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T09:05:00.967

问题可能是您没有发送完整的 JSON。我输出结果

```
out.println(gson.toJson(new Boolean("true"))); 
```

你得到的只是真实的词。试着把它改成这样。

```
HashMap<String, Boolean> hm = new HashMap<String, Boolean>();
hm.put("success", true);
out.write(gson.toJson(hm)); 
```

运行我得到 {"success":true} 这是有效的 JSON。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T08:44:00.787

可能没有调用 done ，因为调用了 fail 。由于http请求本身似乎有效，另一个可能的问题是它没有返回正确的json内容，而回复被解释为这样（因为dataType：“json”）。

因此，您应该调查服务器返回的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-16T08:19:05.657

我不知道为什么，但有时 firebug 断点给人的印象是 request.done() 中的代码没有执行。也许它只是被引导到控制台。

尝试在 firebug 中测试没有断点的代码。

# ios - 使用音频单元在 iOS 中同时播放多个 MIDI 音符

> ID：14796012
> 
> 赞同：1
> 
> 时间：2013-02-10T08:33:23.837
> 
> 标签：ios, core-audio

我需要在我的应用程序中同时播放多个曲目。音轨可能是普通的音频文件或一组 MIDI 音符。因此，我配置了一个音频图并将各种音频单元（文件播放器 AU 和采样器 AU）连接到多通道混音器，其输出连接到远程 io 单元以播放音频文件和 MIDI 音符。采样器单元加载了各种乐器的 sf2 文件。所有这一切都很好，但是一旦我有两个以上的 midi 采样器音频单元并尝试使用 MusicDeviceMIDIEvent 函数通过这些单元同时播放 MIDI 音符，输出声音会在几个循环后失真/中断。我需要同时播放大约 10 个乐器音轨，并且在我添加第三个 midi 单元后问题就开始了。如果这种方法有问题，有人可以指出我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:20:12.763

在不同的轨道上播放多个 Midi 音符应该不是问题。我让它工作正常。确保在演奏新音符之前停止正在播放的 MIDI 音符。您可以使用相同的功能来停止 MIDI 音符，如下所示

```
UInt32 noteCommand =     kMIDIMessage_NoteOff << 4 | 0;
UInt32 velocity = 0;

MusicDeviceMIDIEvent (samplerUnit,                //audiounit
                                 noteCommand,    
                                 note,            //note being played
                                 velocity,
                                 0); 
```

# ant - ANT 没有正确加载我的环境变量

> ID：14796015
> 
> 赞同：0
> 
> 时间：2013-02-10T08:34:09.843
> 
> 标签：ant, environment-variables, backslash

我的 ant 脚本有问题，所以我添加了一些回声来查找错误的来源。我猜它可能是我的 Android SDK 的环境变量，所以我添加了

```
<echo level="info">     sdk.dir= ${sdk.dir} </echo> 
```

它打印

```
[echo]      sdk.dir= c:UsersSpongeDocumentsMy DropboxAndroid SDK 
```

我像这样设置环境变量（我用户Win7）：

```
Name: ANDROID_HOME
Value: C:\Users\Sponge\Documents\My Dropbox\Android SDK 
```

我对 ANT 没有太多经验，所以可能只是 echo 命令的行为，即删除了反斜杠并且路径正确，或者这就是脚本找不到资源 anttasks.properties 的问题，例如，哪个位于 SDK 文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T08:43:50.723

在属性文件中，必须转义反斜杠（使用另一个反斜杠）：

```
Name: ANDROID_HOME
Value: C:\\Users\\Sponge\\Documents\\My Dropbox\\Android SDK 
```

我不会打扰反斜杠，而是使用冲突，ant（和一般的 Java）支持得很好，即使在 Windows 上：

```
Name: ANDROID_HOME
Value: C:/Users/Sponge/Documents/My Dropbox/Android SDK 
```

# hadoop - 修改hadoop源代码

> ID：14796020
> 
> 赞同：1
> 
> 时间：2013-02-10T08:34:37.340
> 
> 标签：hadoop

如何通过Eclipse修改Hadoop的源代码，并编译一个jar文件，修改后的代码。是否需要重新安装集群才能使更改在集群中生效，或者我们可以替换创建的jar文件？ ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:05:32.530

您可以通过 eclipse 的 import maven project 导入 eclipse 中的 maven 项目，然后进行更改。要构建，如果您安装了 eclipse 的 maven 插件，您可以从 eclipse 构建它，否则您可以从命令行 maven 工具构建。

我认为更换相关的罐子应该没问题，但这又取决于。如果您对 Hdfs jar 进行了更改，并且 Hdfs 正在运行，那么它将需要重新启动。但为了安全起见，重启是最安全的选择

# windows-8 - 如何在 Windows XP 上构建 Windows Phone 8 应用程序？

> ID：14796021
> 
> 赞同：0
> 
> 时间：2013-02-10T08:34:43.160
> 
> 标签：windows-8, windows-xp, windows-phone-8

是否可以在 Windows XP 上构建 Windows Phone 8 应用程序？SDK 似乎需要 Windows 8。

我唯一的选择是使用安装了 Windows 8 的 Virtual PC 吗？

Windows 8 应用程序是否也可以在 Windows Phone 8 上运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T08:39:30.113

不。

为了开发 Windows Phone8 应用程序，您需要在 Windows8 机器上构建代码。您可以通过在您的开发机器上安装 Windows8 来做到这一点，或者使用安装了 Windows8 的虚拟机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T08:46:00.247

> Windows 8 应用程序是否也可以在 Windows Phone 8 上运行？

不幸的是没有，因为不同的 .NET 框架： http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/jj681690%28v=vs.105%29.aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj681690%28v=vs.105%29.aspx)（Windows Phone 8 和 Windows 8 平台比较）

# sql - 设计用于分解需求预测的简单模式

> ID：14796023
> 
> 赞同：1
> 
> 时间：2013-02-10T08:35:18.440
> 
> 标签：sql, oracle, database-design, oracle11g

**编辑**：[*详细信息*]我正在做一个简单的数据库设计任务作为培训练习，我必须为以下情况提出一个基本的模式设计：

我有一个产品的父子层次结构（原材料>正在进行的工作>最终产品）。

订单在每个级别下。

在接下来的 6 个月中，应在每周存储桶中查看订单数量。

可以对每个产品级别进行需求预测。

对未来 6 个月的每周桶进行需求预测。

它通常在层次结构的更高级别（原材料或正在进行的工作）中完成

它必须分解到较低的级别（最终产品）

有两种方法可以将需求预测从较高层次分解到较低层次：

1.  用户指定最终产品的百分比分布。说，有 1000 的预测工作正在进行中.. 用户说我想要 40% 的最终产品 1 和 60% 的最终产品 2 在桶 10.. 然后从现在开始的第 10 周（周日到周六），预测值最终产品 1 为 400，最终产品 2 为 600。

2.  用户说，只是根据对桶 5 中终端产品的订单进行分解，桶 5 中终端产品 1 和 2 的订单分别为 200 和 800，那么 EP1 的预测值为 ((200/1000) * 100)%对于 EP2，将是“正在进行的工作”预测的 ((800/1000) * 100)%。

未来 6 个月的预测应在每周存储桶中查看，理想的格式应为：

`product name | bucket number | week start date | week end date | forecast value`

这种要求的基本理想模式是什么？

* * *

**Product_Hierarchy**表可能如下所示：

```
id  |   name                |   parent_id
__________________________________________
1   |   raw material        |   (null)
2   |   work in progress    |   1
3   |   end product 1       |   2
4   |   end product 2       |   2 
```

* * *

这是存储订单的好方法吗？

**订单**

```
id | prod_id | order_date | delivery_date | delivered_date 
```

在哪里，

`prod_id`是引用`id`product_hierarchy 表的外键，

每周26桶的订单可以选择为

```
SELECT
    COUNT(*) TOTAL_ORDERS,
    WIDTH_BUCKET(
        delivery_date,
        SYSDATE,
        ADD_MONTHS(sysdate, 6), 
        TO_NUMBER( TO_CHAR(SYSDATE,'DD-MON-YYYY') - TO_CHAR(ADD_MONTHS(sysdate, 6),'DD-MON-YYYY') ) / 7
    ) BUCKET_NO
FROM
    orders_table
WHERE
    delivery_date BETWEEN SYSDATE AND ADD_MONTHS(sysdate, 6); 
```

但这将给出从今天开始的每周存储桶，无论哪一天。我希望他们在星期天到星期六星期。

请帮助设计这个数据库结构。

（将使用 Oracle 11g）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T19:30:33.163

你最后的评论正是我的意思。很高兴看到你得到它！

自从我开始做以来，我完成了一个示例代码。与您所说的不同之处在于，仅使用一周的日期（即*monday*）和各种检查约束来区分会改变的和不会改变的（`raw_material`VS ）。`raw_material_hist`

 *```
CREATE TABLE raw_material 
  ( 
     material_id     NUMBER PRIMARY KEY, 
     material_blabla VARCHAR2(20) 
  ); 

CREATE TABLE wip 
  ( 
     wip_id     NUMBER PRIMARY KEY, 
     parent_raw NUMBER REFERENCES raw_material(material_id), 
     wip_desc   VARCHAR2(20) 
  ); 

CREATE TABLE end_product 
  ( 
     end_product_id NUMBER PRIMARY KEY, 
     parent_wip     NUMBER REFERENCES wip(wip_id), 
     description    VARCHAR2(20) 
  ); 

CREATE TABLE rm_histo 
  ( 
     material_id NUMBER REFERENCES raw_material(material_id), 
     week_start  DATE CHECK (To_char(week_start, 'D')=1), 
     forecast    NUMBER(8) CHECK (forecast >0), 
     CONSTRAINT pk_rm_histo PRIMARY KEY (material_id, week_start) 
  ); 

CREATE TABLE wip_histo 
  ( 
     wip_id            NUMBER REFERENCES wip(wip_id), 
     week_start        DATE CHECK(To_char(week_start, 'D')=1), 
     wip_user_forecast NUMBER(8) CHECK (wip_user_forecast>0), 
     CONSTRAINT pk_wip_histo PRIMARY KEY (wip_id, week_start) 
  ); 

CREATE TABLE end_prod_histo 
  ( 
     end_product_id         NUMBER REFERENCES end_product(end_product_id), 
     week_start             DATE CHECK(To_char(week_start, 'D')=1), 
     end_prod_user_forecast NUMBER(8) CHECK (end_prod_user_forecast >0) 
  ); 
```

最后，您确实使用视图来查看预测的事物，或者如果您拥有大量数据，则使用物化视图。通过使用视图，您不会复制数据，因此更改/更新更安全、更容易。

对于您的用例 1 或 2，这不涉及数据库模式。归根结底，它只是为预测更新一些值，用例 1 或 2 的逻辑可以进入 PL/SQL 过程或您用于接口的任何内容。

编辑：同样从您的最后一条评论中，您提到手动设置预测值与计算值。所以我添加了这样一个专栏，但学分归你

编辑之二：至于桶号，只需对日期使用适当的掩码，例如`IW`or `WW`。这两个变化是一年中的第一周。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:08:34.417

好的，这就是我想出的数据模型。

PRODUCT——存储产品信息，维护父子层次结构

```
id  NUMBER  "Primary Key Not Null"                  
level_code  VARCHAR2    Not Null                    
name    VARCHAR2    Not Null                    
description VARCHAR2                        
parent_id   NUMBER  Foreign Key references PRODUCT(id) 
```

ORDERS -- 存储产品订单

```
id  NUMBER  "Primary Key Not Null"                  
prod_id     NUMBER  "Foreign Key references PRODUCT(id) Not Null"                   
order_type  VARCHAR2    "Not Null Default 'Default'"
order_qty   NUMBER  Not Null
order_date  NUMBER  Foreign Key references DATE_INFO(date_key)
delivery_date   NUMBER  "Foreign Key references DATE_INFO(date_key)
Check delivery_date >= order_date" 
```

FORECAST - 存储产品的预测值（存储更高级别的值，从父级分解后存储更低级别的值）

```
id  NUMBER  "Primary Key Not Null"
product_id  NUMBER  "Foreign Key references PRODUCT(id) Not Null"
forecast_value  NUMBER  Not Null
week    NUMBER  "Foreign Key references DATE_INFO(date_key) Not Null" 
```

DISAGGREGATION_RULES -- 存储用于将值从较高级别分解到较低级别的方法以及分配到较低级别的百分比

```
id  NUMBER  "Primary Key Not Null"
parent_product_id   NUMBER  "Foreign Key id references PRODUCT(id) Not Null"
child_product_id    NUMBER  "Foreign Key id references PRODUCT(id) Not Null"
method  VARCHAR2    Not Null                    
from_week   NUMBER  "Foreign Key references DATE_INFO(date_key) Not Null"
to_week NUMBER  "Foreign Key references DATE_INFO(date_key) Not Null Check end_week >= start_week"
percent_distribution    NUMBER  Not Null 
```

DATE_INFO -- 日期维度，包含有关开始日期（必须是星期六）和结束日期的信息，对应于特定日期所在的周

```
date_key    NUMBER  "Primary Key
Not Null"                   
full_date   DATE    Not Null                    
week_begin_date DATE    Not Null                    
week_end_date   DATE    Not Null 
```

至于桶数/周的事情..我正在使用以下函数计算周开始日期（在我的情况下是星期六的日期）

```
CREATE OR REPLACE FUNCTION get_week_start_date(v_bucket_num IN NUMBER)
  RETURN DATE
IS
  week_start_date DATE;
BEGIN
  SELECT (TRUNC(SYSDATE+2, 'IW')-2) + ((v_bucket_num-1) * 7)
  INTO week_start_date FROM dual;
  RETURN week_start_date;
END; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-10T08:51:26.163

这是 SQL Server 语法，你可以谷歌搜索等效的 oracle 函数

```
DATEADD(week, DATEDIFF(week, GETDATE(), 0), 0) 
```

这将在当前一周的第一天为您提供午夜 (0:00:00)。这是哪一天取决于您的系统设置 - 您可以使用 Oracle 等效的 DATEADD 将其移动到您需要的那一天。

我会重新考虑你的模式，从你的描述来看，heirachy 并不是我脑海中闪现的概念——它听起来更像是一个序列。我认为您最好从业务对象开始并返回数据库，而不是相反。*

# android - Android facebook 无法更改活动的个人资料图片

> ID：14796028
> 
> 赞同：0
> 
> 时间：2013-02-10T08:35:49.563
> 
> 标签：android, facebook, events

我使用旧`facebook android api`的来创建事件。一切正常，除非我试图`profile picture`为活动发布。`facebook Graph api`说 **您可以通过向 /EVENT_ID/picture 发出 HTTP POST 请求来向事件添加个人资料图片，该请求具有事件管理员的 create_event 权限，并**具有以下参数：

```
source  multipart/form-data 
```

如果请求成功，则返回 true。

所以我使用了这段代码：

```
Bundle picture_parameters = new Bundle();
picture_parameters.putString("source", "https://foursquare.com/mapproxy/59.3280/18.0506/map.png");
response = Utility.mFacebook.request(eventId + "/picture", picture_parameters, "POST");
JSONObject myjson = Util.parseJson(response);
Log.v("INFO", "!!!picture posted "+ response); 
```

确实返回 true 但没有图片！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T17:42:27.027

“来源”需要是实际图片本身，而不是网址。这就是为什么内容类型是 multipart/form-data，而不是字符串的原因。

# php - 用石墨保存一个新的 RDF 文档

> ID：14796029
> 
> 赞同：0
> 
> 时间：2013-02-10T08:37:05.090
> 
> 标签：php, rdf

我是语义网的新手，我打算用 PHP 构建一个语义网应用程序。我正在使用 Graphite 和 ARC 库，但我找不到任何关于如何创建和保存新 RDF 文档的好教程。我要做的是从用户那里获取一些注册信息并将其保存到 RDF 文件中以供以后使用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T21:24:32.263

将数据加载到 Graphite 图形后，您可以使用[Graphite 类](http://graphite.ecs.soton.ac.uk/#graphiteclass)`serialize`的方法 来获取可以写入文件的内容：

> **打印 $graph->serialize( [$serializer="RDFXML"] );**
> 
> 使用 Arc2 的序列化程序之一返回内存中整个 RDF 图的序列化。默认情况下使用 RDF/XML 序列化程序，但也可以使用其他（尝试传递“Turtle”或“NTriples”） - 请参阅 Arc2 文档。

# java - 为什么这个套接字程序每次连接到它时都会占用不同的端口

> ID：14796033
> 
> 赞同：0
> 
> 时间：2013-02-10T08:38:32.260
> 
> 标签：java, sockets, port

服务器端程序

```
import java.net.*;
import java.io.*;

public class GreetingServer extends Thread
{
    private ServerSocket serverSocket;
    public GreetingServer(int port) throws IOException
    {
        serverSocket = new ServerSocket(port);
        serverSocket.setSoTimeout(10000);
    }

    public void run()
    {
        while(true)
        {
            try
            {
                System.out.println("Waiting for client on port " +
                        serverSocket.getLocalPort() + "...");
                Socket server = serverSocket.accept();
                System.out.println("Just connected to "
                        + server.getRemoteSocketAddress());
                DataInputStream in =
                    new DataInputStream(server.getInputStream());
                System.out.println(in.readUTF());
                DataOutputStream out =
                    new DataOutputStream(server.getOutputStream());
                out.writeUTF("Thank you for connecting to "
                        + server.getLocalSocketAddress() + "\nGoodbye!");
                server.close();
            }catch(SocketTimeoutException s)
            {
                System.out.println("Socket timed out!");
                break;
            }catch(IOException e)
            {
                e.printStackTrace();
                break;
            }
        }
    }
    public static void main(String [] args)
    {
        int port = Integer.parseInt(args[0]);
        try
        {
            Thread t = new GreetingServer(port);
            t.start();
        }catch(IOException e)
        {
            e.printStackTrace();
        }
    }
} 
```

客户端程序

```
import java.net.*;
import java.io.*;

public class GreetingClient
{
    public static void main(String [] args)
    {
        String serverName = args[0];
        int port = Integer.parseInt(args[1]);
        try
        {
            System.out.println("Connecting to " + serverName
                    + " on port " + port);
            Socket client = new Socket(serverName, port);
            System.out.println("Just connected to "
                    + client.getRemoteSocketAddress());
            OutputStream outToServer = client.getOutputStream();
            DataOutputStream out = new DataOutputStream(outToServer);

            out.writeUTF("Hello from " + client.getLocalSocketAddress());
            InputStream inFromServer = client.getInputStream();
            DataInputStream in =
                new DataInputStream(inFromServer);
            System.out.println("Server says " + in.readUTF());
            client.close();
        }catch(IOException e)
        {
            e.printStackTrace();
        }
    }
} 
```

如果可能的话，任何文件都可以发送和接收。我尝试了很多，但我无法弄清楚为什么使用不同的端口和文件操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:42:01.483

> 为什么这个套接字程序每次连接到它时都会占用不同的端口

这就是操作系统在您连接未绑定套接字时所做的事情。它选择一些可用的源端口（称为“*临时端口*”）并使用它。如果你想确保它选择你需要的某个端口到[`bind`](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/Socket.html#bind%28java.net.SocketAddress%29)套接字。

# iphone - 运行代码时状态栏隐藏

> ID：14796034
> 
> 赞同：0
> 
> 时间：2013-02-10T08:38:57.360
> 
> 标签：iphone, ios, objective-c

出于某种原因，每当我在我的应用程序中运行以下代码时，状态栏就会消失。我在上面的 applicaitonLaunchOptions 结束时运行返回 YES。

有谁知道为什么会这样？

下面的代码询问人们是否要升级到新的应用程序版本。

```
NSString * version = @"";
NSString * nstri = [NSString stringWithFormat: @"http://itunes.apple.com/lookup?id=%@", APPID];
NSURL *url = [NSURL URLWithString: nstri];

ASIFormDataRequest * versionRequest = [ASIFormDataRequest requestWithURL:url];

[versionRequest setRequestMethod:@"GET"];
[versionRequest setDelegate:self];
[versionRequest setTimeOutSeconds:150];
[versionRequest addRequestHeader:@"Content-Type" value:@"application/json"];
[versionRequest startSynchronous];

//Response string of our REST call
NSString* jsonResponseString = [versionRequest responseString];

NSDictionary *loginAuthenticationResponse = [jsonResponseString objectFromJSONString];

NSArray *configData = [loginAuthenticationResponse valueForKey:@"results"];

for (id config in configData)
{
    version = [config valueForKey:@"version"];
}

NSLog(@"app version: %@", version);

//Check your version with the version in app store
if (![version isEqualToString: APPVERSION])
{
    UIAlertView *createUserResponseAlert = [[UIAlertView alloc] initWithTitle:@"New Version!" message: @"A new version of Handybook app is available to download. Please update your app for the latest features." delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles: @"Download", nil];
    [createUserResponseAlert show];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:01:35.607

可能是您的 AppDeleget.m 中有此代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *) launchOptions {
    [[UIApplication sharedApplication] setStatusBarHidden:YES with Animation:NO];
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
} 
```

如果是，则熄灭：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES with Animation:NO]; 
```

因为那行代码隐藏了状态栏

# asp.net-mvc-3 - 在文本框更改事件 MVC 上动态绑定复选框

> ID：14796037
> 
> 赞同：1
> 
> 时间：2013-02-10T08:40:03.160
> 
> 标签：asp.net-mvc-3

在我的模型中

```
namespace Mvcautocomplete.Models
{
    public class Product
    {
        public string productName { get; set; }
        public int productId { get; set; }
        public List<Product> GetProducts()
        {
            List<Product> lst = new List<Product>();
            lst.Add(new Product { productName = "Andhra Pradesh",productId=1 });
            lst.Add(new Product { productName = "Assam" ,productId=2});
            lst.Add(new Product { productName = "Hyderabad",productId=3 });
            lst.Add(new Product { productName = "India",productId=4 });
            lst.Add(new Product { productName = "Bangalore",productId=5 });

        return lst;

    }

    public List<Dose> DoseCollection
    {
        get
        {
            List<Dose> lst = new List<Dose>();
            lst.Add(new Dose {doseId = 1, doseName = "A.05", prodId = new Product { productId = 1 } });
            lst.Add(new Dose {doseId=2, doseName = "B.05",prodId=new Product{productId=1} });
            return lst;
        }
    }

}

public class Dose
{
    public int doseId { get; set; }
    public string doseName { get; set; }
    public Product prodId { get; set; }
    public bool isSelected { get; set; }
} 
```

}

在控制器中

```
 [HttpGet]
    public ActionResult Create()
    {          

        Product obj = new Product();
        return View(obj);
    } 
```

在视图中，我有 ProductName 的文本框，它是自动完成的。现在我想根据更改事件的文本框上的 productName 填充 Dosename。

现在如何根据输入的产品名称创建和绑定复选框？

# ios6 - 仅在 ios6 中将一个视图控制器更改为横向

> ID：14796041
> 
> 赞同：0
> 
> 时间：2013-02-10T08:40:46.103
> 
> 标签：ios6, uinavigationcontroller, rotation, landscape

我在这里找到了似乎是我的问题的答案：

[iOS 6：如何将某些视图限制为纵向并允许其他视图旋转？](https://stackoverflow.com/questions/12630359/ios-6-how-do-i-restrict-some-views-to-portrait-and-allow-others-to-rotate?rq=1)

但我不明白答案。我很困惑我应该将 UINavigationController 的代码放在哪里。它不能在 UINavigationController.h 文件中，因为那是锁定的。有人请帮忙

莱斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:17:41.640

`UINavigationController.h`您应该创建一个名为*MainNavigationController*的新类并继承，而不是将代码放入`UINavigationController`.

*然后，您可以在名为LandscapeOK*的新类中添加一个布尔值，然后`ViewController`从*MainNavigationController*继承而不是`UINavigationController`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T15:15:12.147

**在 View did load set direction 中使用这个**

```
 UIViewController *c = [[UIViewController alloc]init];
    [self presentModalViewController:c animated:NO];
    [self dismissModalViewControllerAnimated:NO]; 
```

# java - 如何使用 java 7 中的方法句柄类调用底层 void 方法？

> ID：14796043
> 
> 赞同：4
> 
> 时间：2013-02-10T08:41:31.990
> 
> 标签：java, exception, methods

我正在尝试在 Java 7 中使用 MethodHandles。

我在这里有一堂课：

```
public class TestCase {
    MethodType mt;

    public static void main(String args[])
    {
        Android a = new Android();
        MethodHandleExample.doSomething(a);
    }
}

class Android {
    public void thisIsMagic()
    {
        System.out.println("Might be called from the method handel");
    }
} 
```

并且方法句柄示例调用在这个类中：

```
public class MethodHandleExample {

    public static void doSomething(Object obj)
    {
        MethodHandle methodHandle = null ;
        MethodType mt = MethodType.methodType(void.class);
        MethodHandles.Lookup lookup = MethodHandles.lookup();

        try{
            try {
                methodHandle = lookup.findVirtual(obj.getClass(),"thisIsMagic",mt);
            } catch (NoSuchMethodException e) {
                e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
            } catch (IllegalAccessException e) {
                e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
            }
        }
        finally {

        }
        try {
            methodHandle.invoke();
        } catch (Throwable throwable) {
            throwable.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }
    }
} 
```

但是当我尝试运行此代码时，会出现如下异常：

```
java.lang.invoke.WrongMethodTypeException: cannot convert MethodHandle(Android)void to ()void
    at java.lang.invoke.MethodHandle.asType(MethodHandle.java:691)
    at java.lang.invoke.InvokeGeneric.dispatch(InvokeGeneric.java:103)
    at com.generic.exception.AnnotationParser.doSomething(AnnotationParser.java:35)
    at com.generic.exception.TestCase.main(TestCase.java:18)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

我得到的例外是在线：

```
 methodHandle.invoke(); 
```

不确定在这种情况下如何调用底层方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T09:07:16.473

添加：

```
methodHandle.invoke(obj) 
```

您必须提供一个对象来运行该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:00:18.273

您需要调用*对象*的方法句柄。

```
methodHandle.invoke(obj); 
```

# javascript - 在 AngularJS 中是否可以在经典的 javascript 函数中使用数据绑定？

> ID：14796047
> 
> 赞同：0
> 
> 时间：2013-02-10T08:42:03.043
> 
> 标签：javascript, model-view-controller, data-binding, angularjs

我有一个关于**Angularjs 数据绑定**功能的问题。

如果我写：

```
<div>Hello {{name}}!</div> 
```

我在**controller.js**中有类似的东西：

```
$scope.name = 'Bruno'; 
```

结果将是“Hello Bruno！”……这太棒了！现在我编辑了模板：

```
<div>Hello <span id="name"></span>!</div> 
```

我还在关闭正文之前添加了这个javascript函数：

```
<script src="lib/angular/angular.js"></script>
<script src="js/app.js"></script>
<script src="js/services.js"></script>
<script src="js/controllers.js"></script>
<script src="js/filters.js"></script>
<script src="js/directives.js"></script>

<script type="text/javascript">

  function fillName(subject) {
    $("#name").text("Hello " + subject);
  }

  fillName({{name}}); // this throws "SyntaxError: invalid property id"

</script>
</body> 
```

* * *

所以我的问题是：

**在 AngularJS 中是否可以在经典的 javascript 函数中使用数据绑定？**

* * *

**更新：**

```
// i changed: fillName({{name}}); with:
fillName('{{name}}'); 
```

这解决了错误......但仍然没有出现名称......我仍在努力......

建议总是受欢迎的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:53:12.817

[更新]好吧，看来我误解了您的问题，因为您似乎已经解决了您的问题，但也许其他人会根据问题的标题偶然发现此信息。

* * *

我将在我的答案前加上以下警告：如果您正在编写 AngularJS 应用程序，您将希望使用 Angular 提供的功能（如指令）来执行此类操作，而不是超出 Angular 应用程序生命周期并编写全局函数等。然而，为了对这个问题的学术答案感兴趣，这里是。

## 概述

您试图在这里获得的 Angluar 魔法基于一些设施：

**范围**（[文档](http://docs.angularjs.org/api/ng.%24rootScope.Scope)）

作用域为 Angular 表达式（你放入属性和双花括号的东西）提供了一个上下文，并提供了必要的函数来观察这些表达式在该上下文中的评估变化。例如，[`Scope#$watch`](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24watch)允许您注册一个回调，该回调在表达式的评估发生更改时执行。

**$interpolate** ([文档](http://docs.angularjs.org/api/ng.%24interpolate))

Interpolate 接受一个字符串，该字符串可以包含双花括号内的表达式，并将其转换为一个新字符串，并将表达式结果插入到原始字符串中。（调用`$interpolate(str)`返回一个函数，当针对提供范围的对象调用该函数时，返回一个字符串。）

## 把它放在一起

在编写 Angular 应用程序时，您通常不必担心这些细节——您的控制器会自动传递一个范围，并且您的 DOM 文本会自动插入。由于您试图在Angular 应用程序的生命周期*之外*访问这些东西，因此您必须跳过其中一些以前隐藏的障碍。

**angular.injector** ([文档](http://docs.angularjs.org/api/angular.injector))

`app.controller`当您使用、等在模块上注册服务、过滤器、指令等时`app.factory`，注入器会调用您提供的功能。Angular 在 Angular 应用程序中为您创建一个，但由于我们不使用一个，您需要`angular.injector`自己创建一个。

一旦有了注入器，就可以使用它`injector.invoke(fn)`来执行函数`fn`并注入任何依赖项（如`$interpolate`）以在函数内部使用。

**一个简单的例子**

这是一个非常基本的例子

*   在输入和变量之间提供双向数据绑定
*   提供数据绑定到 HTML 视图使用`$interpolate`

```
Name: <input id="name" type="text" autocomplete="off">
<button id="setname">Set name to Bob</button>
<div id="greeting"></div> 
```

```
var injector = angular.injector(['ng']);

injector.invoke(function($rootScope, $interpolate) {
  var scope = $rootScope.$new();
  var makeGreeting = $interpolate("Hello {{name}}!");

  scope.$watch('name', function() {
    var str = makeGreeting(scope);
    $("#greeting").text(str);
    $("#name").val(scope.name);
  });

  var handleInputChange = function() {
    scope.$apply(function() {
      scope.name = $('#name').val();
    });
  };

  var setNameToBob = function() {
    scope.$apply(function() {
      scope.name = "Bob";
    });
  };

  $("#name").on('keyup', handleInputChange);
  $("#setname").on('click', setNameToBob);
  handleInputChange();
}); 
```

这是一个演示该技术的 jsFiddle：http: [//jsfiddle.net/BinaryMuse/fTZu6/](http://jsfiddle.net/BinaryMuse/fTZu6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:01:44.590

fillName 是全局的，所以在你的控制器中你可以做

```
$scope.name = 'John';
fillName($scope.name); 
```

但这样做是完全错误的。您正在尝试使用 AngularJS 来解决它创建的问题。

# c# - 如何使用文本框搜索并给出建议列表？

> ID：14796049
> 
> 赞同：-2
> 
> 时间：2013-02-10T08:42:57.287
> 
> 标签：c#, asp.net

我正在开发一个邮件系统，我想通过文本框搜索电子邮件并在用户输入第一个字母时给出一些建议。

我怎样才能做到这一点，你能帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:20:09.720

有几种方法可以实现这一点。[这是](http://www.asp.net/ajaxlibrary/act_AutoComplete_Simple.ashx)一个简单的asp中自动完成文本框的示例，但建议您使用jquery及其[`autocomplete()`](http://jqueryui.com/autocomplete/)更简单的功能：

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>jQuery UI Autocomplete - Default functionality</title>

  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
  <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>

  <script>
  $(function() {
    var availableTags = [
      "ActionScript",
      "AppleScript",
      "Asp",
      "BASIC",
      "C",
      "C++",
      "Clojure",
      "COBOL",
      "ColdFusion",
      "Erlang",
      "Fortran",
      "Groovy",
      "Haskell",
      "Java",
      "JavaScript",
      "Lisp",
      "Perl",
      "PHP",
      "Python",
      "Ruby",
      "Scala",
      "Scheme"
    ];

    $( "#tags" ).autocomplete({
      source: availableTags
    });
  });
  </script>
</head>
<body>

<div class="ui-widget">
  <label for="tags">Tags: </label>
  <input id="tags" />
</div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T08:55:22.500

您想使用 TextBox.AutoCompleteMode 属性。

```
var source = new AutoCompleteStringCollection();
source.AddRange(new string[]
                {
                    "January",
                    "February",
                    "March",
                    "April",
                    "May",
                    "June",
                    "July",
                    "August",
                    "September",
                    "October",
                    "November",
                    "December"
                });

//Add datasource to textbox
textbox.AutoCompleteCustomSource = source;
textbox.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
textbox.AutoCompleteSource = AutoCompleteSource.CustomSource; 
```

# bash - echo 从输出中删除最后一行空白

> ID：14796050
> 
> 赞同：2
> 
> 时间：2013-02-10T08:43:13.853
> 
> 标签：bash, shell, echo, tail

我正在使用脚本使用命令获取文件的最后 n-2 行，然后使用 echo 将这些行打印到文件中。

```
last_n2_lines=`tail -n+3 $file`
echo "$last_n2_lines" >> $file 
```

这里的这个回显从文件末尾删除了一个尾随的新行。供参考

> 尾 -n+3 文件 > file.new

运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:39:03.580

来自手册： [http ://www.gnu.org/software/bash/manual/bashref.html#Command-Substitution](http://www.gnu.org/software/bash/manual/bashref.html#Command-Substitution)

> 3.5.4 命令替换
> 
> 命令替换允许命令的输出替换命令本身。当命令包含如下时，会发生命令替换：
> 
> ```
> $(command) 
> ```
> 
> 或者
> 
> ```
> `command` 
> ```
> 
> Bash 通过执行命令并将命令替换替换为命令的标准输出来执行扩展，并***删除任何尾随的换行符***。嵌入的换行符不会被删除，但它们可能会在分词过程中被删除。命令替换 $(cat file) 可以替换为等效但更快的 $(< file)。
> 
> 当使用旧式反引号形式的替换时，反斜杠保留其字面含义，除非后面跟着“$”、“`”或“\”。前面没有反斜杠的第一个反引号终止命令替换。使用 $(command) 形式时，括号之间的所有字符组成命令；没有人受到特殊对待。
> 
> 命令替换可能是嵌套的。要在使用反引号形式时嵌套，请使用反斜杠转义内部反引号。
> 
> 如果替换出现在双引号中，则不会对结果执行分词和文件名扩展。

强调我的。所以这不是一个错误。这是一个特点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:05:10.360

您可以通过使用来保存尾随的空行`readarray`来保存数据和`printf`输出。

就像是：

```
readarray last_n2_lines < <(tail -n+3 $file)
printf "%s" "${last_n2_lines[@]}" > ${file}.new 
```

演示：

```
$ cat test; echo end 
1
2
3
4

end
$ tail -n+3 test ; echo end
3
4

end
$ readarray data < <(tail -n+3 test)
$ printf "%s" "${data[@]}" ; echo end  
3
4

end 
```

解释：

*   `readarray data`将标准输入中的行读入名为`data`.
*   `cmd1 < <(cmd2 param1 param2 ...)`将 的输出重定向`cmd2 param1 param2 ...`到标准输入 if `cmd1`。小心语法：它必须是`< [space] <(...)`, 之间没有空格 , 两者之间`<(`需要空格`< <`。

所以在第一行之后，`data`包含所有`tail -n+3`输出的行。数组中的每一项都是*包含行终止符*的输入行。
以下是访问每个元素的方法。请注意，为数组中定义的每个项目打印两行：数组中的一行（包含换行符），以及由添加的换行符`echo`。

```
$ echo "${data[0]}"
3

$ echo "${data[1]}"
4

$ echo "${data[2]}"

$ echo "${data[3]}"

$ echo "${data[4]}"  # out of bounds

$ 
```

*   `${data[@]}`扩展到数组的所有元素`data`
*   `printf "%s" param1 param2 ...`打印其所有参数不变（即不添加或删除行终止符）。

所以第二条语句打印回读入的所有内容，保持不变。

# sql - 如何找到连续缺勤10天以上的员工？

> ID：14796059
> 
> 赞同：4
> 
> 时间：2013-02-10T08:44:20.767
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有一个表名 Att。其中有 2 列：EmpID 和日期。日期列包含员工在场的所有日期。我需要写一个查询来查找是否有员工**连续**缺勤超过 10 天。

```
EmpID | Date
  101 | 1/1/2012
  101 | 2/1/2012
  101 | 7/1/2012
  101 | 18/1/2012
  101 | 21/1/2012
  101 | 25/1/2012
  101 | 30/1/2012
  102 | 1/1/2012
  102 | 2/1/2012
  102 | 5/1/2012
  102 | 9/1/2012
  102 | 14/1/2012
  102 | 19/1/2012
  102 | 24/1/2012
  102 | 25/1/2012
  102 | 28/1/2012
  102 | 29/1/2012
  102 | 30/1/2012 
```

结果应该是101。如何做到这一点？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:54:18.650

如果你正在使用`SQL Server 2012`，你可以使用`LEAD`分析函数

```
WITH recordList
AS
(
  SELECT EmpID, Date FromDate,
         LEAD(Date) OVER (PARTITION BY EmpID ORDER BY Date ASC) ToDate
  FROM   tableName
)
SELECT DISTINCT EmpID
FROM recordList 
WHERE DATEDIFF(d, FromDate ,ToDate) >= 10 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!6/808d6/2)
*   [SQLFiddle 演示（*其他*）](http://www.sqlfiddle.com/#!6/808d6/3)

其他链接

*   [日期差异](http://msdn.microsoft.com/en-us/library/ms189794.aspx)
*   [带领](http://msdn.microsoft.com/en-us/library/hh213125.aspx)

**更新 1**

```
WITH firstList
AS
(
  SELECT EmpID, Date,
         ROW_NUMBER() OVER (PARTITION BY EmpID ORDER BY Date ASC) RN
  FROM   tableName
)
SELECT  DISTINCT a.EmpID
FROM    firstList a
        INNER JOIN firstList b
          ON a.RN + 1 = b.RN
WHERE   DATEDIFF (d, a.Date , b.Date ) >= 10 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!6/808d6/10)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T08:52:08.070

您想使用子查询。就像是

```
select * from Att a1
where day(a1.date)-10 > all
(select day(a2.date) from Att a2 where a2.empid = a1.empid and a2.date < a1.date) 
```

这个想法是，我们选择一个日期的行，即使我们减去 10 天，对于相同的 EmpID，它仍然大于按时间顺序更早出现的所有行的日期。

`day(date)`应该是返回自纪元以来发生的天数的函数，而不是一个月中的一天或一周中的一天。或者，您可以执行类似`date-10*ticksinday`. 无论您做什么都将取决于您的 SQL 风格 :)

一旦这对您有意义，请实施它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T09:26:17.377

OUTER APPLY 和 EXISTS 的另一种选择

```
SELECT t1.[EmpID], t1.[Date], o.[EmpID], o.[Date],
       DATEDIFF(d, o.[Date], t1.[Date]) AS diff        
FROM TableName t1 
OUTER APPLY (
             SELECT t2.[EmpID], t2.[Date]
             FROM TableName t2
             WHERE EXISTS (
                           SELECT 1
                           FROM TableName t3
                           WHERE  t1.[Date] > t3.[Date] 
                             AND t1.EmpID = t2.EmpID
                           HAVING MAX(t3.[Date]) = t2.[Date]
                           ) 
             ) o
WHERE DATEDIFF(d, o.[Date], t1.[Date]) >= 10 
```

[**SQLFiddle**](http://www.sqlfiddle.com/#!3/bde49/1/0)上的演示[](http://www.sqlfiddle.com/#!3/bde49/1/0)

# java - Java中需要的静态块输出说明

> ID：14796060
> 
> 赞同：0
> 
> 时间：2013-02-10T08:44:25.413
> 
> 标签：java, class, methods, static, println

我的代码是：-

```
class Test
{
  static int a = 11;
  static
  {
    System.out.println("Hello static! " + main() + a);
  }

  public static void main(String[]args)
  {
    System.out.println("Hello String!");
  }

  public static char main()
  {
    System.out.println("Hello char!");
    return 'H';
  }
} 
```

输出：-

```
Hello char!
Hello static! H11
Hello String! 
```

为什么是“你好 char！” 在“你好静态！”之前打印？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:50:55.127

1.  静态块首先执行。
2.  它在组装要打印的字符串时调用不带参数的 main()。
3.  main() 打印一些输出。
4.  静态块打印其输出。
5.  静态块退出。
6.  您的 main(String[]) 方法执行并打印其输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T08:47:58.190

> 为什么是“你好 char！” 在“你好静态！”之前打印？

因为，方法在语句打印`main()`完成之前被调用和执行。`sysout``Hello static`

这是执行顺序： -

*   类已加载。
*   `static`变量`a`被加载并初始化为`11`.
*   `static`块被执行。
*   从`sysout`那里的语句，`main()`调用静态方法。此时`Hello static`还没有打印出来，因为`sysout`语句不完整。
*   执行控制转到`main()`方法。因为没有它，当前的 sysout 语句将无法完成。
*   `main()`方法打印`"Hello char"`，然后返回`'H'`。
*   执行回到`static`块，在里面`sysout`。
*   `sysout`完成执行，并打印`"Hello static! H11"`

**注意**： -`sysout`以上表示 - `System.out.println()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T08:48:19.630

让我们分解一下。

运行的第一件事是静态初始化程序块。所以我们运行这一行：

```
System.out.println("Hello static! " + main() + a); 
```

但在调用该方法之前，我们必须调用 main()，因为我们必须首先对所有参数进行全面评估。

所以这在静态初始化程序中的 println 之前被调用：

```
public static char main()
{
  System.out.println("Hello char!");
  return 'H';
} 
```

这打印了`Hello char!`我们在第一行看到的。

它返回 H，它被打印在旁边`Hello static!`

最后，调用 main(string[]) 开始程序。我们看到了`Hello String!`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T08:49:01.127

这里的一般执行逻辑如下：

1.  类被加载，因此静态构造函数被执行。
2.  在构造函数内部，对 String （参数 to `System.out.println()`）进行求值，它调用`char main()`方法。
3.  评估该`char main()`方法。
4.  在`char main()`字符串内部打印：**第一个输出行**
5.  静态构造函数中的字符串已构建，因此可以打印：**第二个输出行**
6.  实际`void main()`可以执行，打印第三行：**3rd output line**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-10T08:49:38.637

在你的行

> System.out.println("你好静态！" + main() + a);

main() 在 System.out.println 之前执行，因此 char main() 中的 print 语句将在外部打印语句“Hello Static”之前执行是有道理的。

# apache - 如何使用 Camel 订阅主题

> ID：14796062
> 
> 赞同：0
> 
> 时间：2013-02-10T08:44:47.757
> 
> 标签：apache, apache-camel, ibatis

我想使用骆驼订阅 activemq 主题。任何人都可以共享路由配置或示例以进行相同的操作。

我的要求是每当发布有关该主题的新数据时，我都想使用 ibatis 将内容推送到数据库。

谢谢洛克什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:12:55.447

您对 jms 组件进行正常设置，并在路由开始时使用以下内容：

所以关键是写jms:topic:而不是jms:。这告诉骆驼冒号后面的名称是主题名称而不是队列名称。这使骆驼为该主题安装了一个侦听器。因此，对于发送到主题的每条消息，都会调用您的路由。

# opengl - 我们可以在链接着色器程序之后删除顶点和片段着色器吗

> ID：14796063
> 
> 赞同：1
> 
> 时间：2013-02-10T08:44:49.857
> 
> 标签：opengl, glsl

正如标题所说，我可以在我的程序中这样做：

```
vertex = glCreateShader(GL_VERTEX_SHADER);
/* ... */
fragment = glCreateShader(GL_FRAGMENT_SHADER);
/* ... */
program = glCreateProgram();
glAttachShader(program, vertex);
glAttachShader(program, fragment);
glLinkProgram(program);
/* All things done */

glDeleteShader(vertex); /* <~ Can I do this now? */
glDeleteShader(vertex); /* <~ Can I do this now? */

/* And in render procedure */
glUseProgram(program); /* <~ Still use program without any problem? */
/* ... */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:18:54.923

是的，这完全有效。着色器对象仍然由程序对象在内部引用，并且在程序对象被删除时将被隐式释放。

# android - android在这里我们使用expandlistview

> ID：14796064
> 
> 赞同：2
> 
> 时间：2013-02-10T08:44:50.677
> 
> 标签：android, expandablelistview

我知道这个问题是错误的，但请你回答我好吗？

我有一个允许用户输入许多地址的应用程序。我想向他展示他的所有地址，因此我选择`ExpandedListView`处理每个地址的标签，当用户单击任何地址时`label`，他可以看到该地址的城市和街道。我想问一下，使用的`ExpandListView`是就在这里？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T08:51:04.360

`ExpandableListView`在这种情况下，我看不出使用错误的任何原因。

是的，你可以使用它。这就是我的想象：

![在此处输入图像描述](../Images/2635267562ad9658fa930b208357c722.png)

`Address 2`目前在哪里扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:30:48.797

当然，您可以使用可扩展的列表视图。

首选网址：

[http://androidtrainningcenter.blogspot.in/2012/07/android-expandable-listview-simple.html](http://androidtrainningcenter.blogspot.in/2012/07/android-expandable-listview-simple.html)

![像那样](../Images/0b5f13cc3684fbd67fbf580847bfea9c.png)

# c# - 如何用正则表达式表达英语的某个句子

> ID：14796065
> 
> 赞同：0
> 
> 时间：2013-02-10T08:44:52.957
> 
> 标签：c#, regex

我有一个 ASP.NET 正则表达式验证器，我该如何表达：

> “如果要测试的值为空或包含 [a-zA-Z0-9\s]+ 元素？”

在正则表达式？

我必须在 ASP.NET 中测试一个 TextBox，并且在提交请求时，我希望附加到 TextBox 的正则表达式验证器允许提交包含字符、数字或为空的表单。

匹配示例 1。`"This is a good 1"`

匹配示例 2。`""`（空）

无与伦比的示例 1\. `"what is this ****?"`（因为它包含 '*' 和 '?'）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:23:48.887

由于还没有人真正将其发布为答案...

只需在您的正则表达式中更改`+`为 a 即可`*`。前者意味着匹配1个或更多，而后者匹配0个或更多。这是你想要的，因为你想允许空白。

# ruby-on-rails-3 - 如何在 Rails 中使用 json 响应

> ID：14796068
> 
> 赞同：0
> 
> 时间：2013-02-10T08:45:38.760
> 
> 标签：ruby-on-rails-3, json

我有一个简单的方法

```
 def country_list

    @countries = User.find(:all).map(&:country).uniq

    render :json => @countries

  end 
```

如果它的路径是`country_list_path`，我如何将响应用作自动完成源的列表，或者只是显示？

如果我放在任何地方`country_list_path`，我会得到 url 而不是响应

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T08:58:33.337

如果您想直接获取 JSON 数据，您应该放置`User.find(:all).map(&:country).uniq.to_json`而不是检索该数据的 URL。

# animation - 游戏/动画模型/原型工具

> ID：14796069
> 
> 赞同：4
> 
> 时间：2013-02-10T08:45:49.813
> 
> 标签：animation, 2d, prototyping, 2d-games, mockup-tool

可用于游戏/动画原型制作的高级模型/原型工具。

我需要添加我的图像，然后缩放、旋转、旋转、移动它们，然后获取所有参数：坐标、角度、比例 %。

我见过的所有模型都不允许这样做。Adobe Flash Professional 画布是一个“理想”的候选者，但这种工具的价格令人无法接受。

Mac 首选，但 Win 也可以。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-17T06:37:11.063

Construct2 真的很好，而且完全免费。 [https://www.scirra.com/construct2](https://www.scirra.com/construct2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:06:14.213

看看这些： [GameMaker](http://www.yoyogames.com/gamemaker/studio/free)，提供免费和高级功能。

[Flixel](http://www.flixel.org/)，开源且免费，基于 ActionScript 3。

# objective-c - 未找到 AdSupport 框架

> ID：14796077
> 
> 赞同：1
> 
> 时间：2013-02-10T08:47:28.807
> 
> 标签：objective-c, ios6, xcode4.3

我已经能够使用此处描述的技术使 xCode 4.3.2 与 iOS 6.0 一起工作。[是否有可能在 Snow Leopard 上获得适用于 Xcode 4.2 的 iOS 5.1 SDK？](https://stackoverflow.com/questions/9613565/is-it-possible-to-get-the-ios-5-1-sdk-for-xcode-4-2-on-snow-leopard)

当我添加 AdSupport.framework 或其他 iOS 6 特定框架时，​​它可以很好地针对没有连接设备的 iOS 设备方案构建。但是，一旦我连接了 iOS 设备，它就会给出错误“找不到框架 AdSupport”。它甚至不能针对 iOS Simulator 5.1 进行编译

我使用 iOS 6.0 作为基础 sdk 并尝试了 4.3 到 5.1 的部署目标，但仍然出现相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T19:43:58.807

AdSupport.framework 仅从 iOS6 开始可用。

您应该将框架标记为可选（弱引用）并确保在低于 6 的 iOS 版本上运行时，不会调用 AdSupport 代码。

# php - 哈希值长度

> ID：14796078
> 
> 赞同：3
> 
> 时间：2013-02-10T08:47:42.633
> 
> 标签：php, encryption

当引用 PHP 中的 sha1 或 md5 等哈希值的长度时，将其解释为*内存*中哈希的大小而不是文字中存在的字符数是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T08:50:39.927

是的，它确实。然而，这个大小与字符串中的字符数量密切相关——如果你得到一个原始字符串，你将得到每 8 位 1 个字符；如果您获得十六进制数字（默认值），则每 4 位获得 1 个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T08:51:22.003

这是明确存储散列所需的最小位数。

```
>>> len(hashlib.md5('foo').digest()) * 8
128
>>> len(hashlib.sha1('foo').digest()) * 8
160
>>> len(hashlib.sha512('foo').digest()) * 8
512 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:00:35.333

安全散列函数的主要输出始终以位定义。因此，当提到散列函数的输出时，密码学家总是谈论例如 128 位用于损坏的 MD5 算法，160 位用于 SHA1，显然 256 位用于 SHA-256。

然而，大多数加密 API 仅适用于字节。这意味着如果存在特定方法来指示哈希大小，则通常会返回以字节为单位的大小。因此，对于上述算法，这将是 16、20 和 32 个字节。

当然，字节以例如十六进制返回，那么字符串*的字符*长度将是其两倍。字符串长度应返回 32、40 或 64 个字符。如果转换为相同的字节数取决于字符编码（例如，使用 UTF-16 会使字节数加倍）。

散列函数确实具有很大的内部状态，因此运行实现所占用的字节数远高于输出中的位数。不过，它并没有你在现代 PC 上注意到的那么高。

# iphone - 如何找出当前在 Xcode 中正在编译的文件

> ID：14796082
> 
> 赞同：0
> 
> 时间：2013-02-10T08:48:08.043
> 
> 标签：iphone, xcode

当 Xcode Xcode 编译时，它会显示 sth like`compiling 28 out of 68 source files`

如何找出它当前正在处理的文件？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:00:51.317

在Xcode中，点击`cmd+7`显示日志导航器，最上面的是当前任务的日志，你可以点击日志查看状态。它将显示编译了哪个文件以及正在编译哪个文件。

# eclipse - 在 Eclipse 构建期间触发 Maven 安装

> ID：14796085
> 
> 赞同：0
> 
> 时间：2013-02-10T08:48:52.773
> 
> 标签：eclipse, maven, maven-install-plugin

最近，我注意到每当我在 Eclipse 中运行构建时，也会`maven-install-plugin`触发（复制我机器本地工件存储库中的 jars）。

我还尝试将它从带有`org.eclipse.m2e:lifecycle-mapping`插件的 Eclipse 构建中排除，但没有任何改变。

这是标准行为（老实说我从未意识到）还是我的错？

斯特凡诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:23:59.777

这绝对不是标准行为。请参阅[如何解释 M2E 中的生命周期映射对话框？](https://stackoverflow.com/questions/13329634/how-to-interpret-the-lifecycle-mapping-dialog-box-in-m2e)有关如何解释映射的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T19:57:08.937

这不是标准行为。这个工作区是否有可能在 Window -> Preferences -> Maven ->“更新项目配置时运行的目标”下定义了“安装”？此设置默认为“进程资源”

# c# - 在 SQL Server 中存储图像的最佳方法

> ID：14796086
> 
> 赞同：1
> 
> 时间：2013-02-10T08:48:58.920
> 
> 标签：c#, asp.net, sql-server, image, entity-framework

在 SQL Server 中存储图像的正确方法是什么？有没有办法用 ADO.NET Entity Framework 存储它们？我需要一些关于如何以最好和现代的方式做到这一点的好资源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T09:04:07.033

如果您决定在 SQL Server 中存储图像，正确的方法是使用[FILESTREAM](http://technet.microsoft.com/en-us/library/bb933993%28v=sql.105%29.aspx)类型。

> 有没有办法用 ADO.NET Entity Framework 存储它们？

问题是 FILESTREAM 是 SQL Server 特定的列，而 EF 被设计为与数据库无关。因此，您可以`byte[]`在模型上拥有类型属性，但 EF 不会利用流式传输。它将作为标准加载`varbinary(max)`。

您还可以使用本机[`SqlFileStream`](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlfilestream.aspx)类直接处理 ADO.NET 中的 FILESTREAM 列类型。这是一个[`blog post`](http://lennilobel.wordpress.com/2011/08/22/using-sqlfilestream-in-c-to-access-sql-server-filestream-data/)显示示例的示例。

您可能还决定将文件存储在文件系统上并仅将文件路径保存在数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T10:23:21.720

您可以以 varbinary 格式存储图像。在 sql 数据库表中创建两列类型`varbinary(MAX)`和`varchar(MAX)`（您可以使用任何大小）并选中“允许空值”。

向您的实体模型添加两个属性：

```
public byte[] ImageData { get; set; } //Your image stored in binary data in the database
public string ImageMimeType { get; set; ) //just a string representation of Your image type,
                                          //this property is optional ) 
```

你`ImageMimeType`可以申请`HiddenInputAttribute(DisplayValue=false)`。您不需要应用它来`ImageData`导致框架不可视化字节数组的编辑器。

将图像保存在数据库中：（如您在此处看到的模型对象称为“产品”）

```
if (image != null) {
product.ImageMimeType = image.ContentType; 
product.ImageData = new byte[image.ContentLength];
image.InputStream.Read(product.ImageData, 0, image.ContentLength);
} 
```

希望这可以帮助。

ps 我将图像存储在文件流中，并将“文件路径”保留在数据库中。

# angularjs - 在 AngularJS 中使用 ng-repeat 过滤结果 6 到 10，共 100 个

> ID：14796087
> 
> 赞同：77
> 
> 时间：2013-02-10T08:49:01.000
> 
> 标签：angularjs

我在文档中看到了`limitTo`过滤器，它允许我限制前 5 个或最后 5 个结果，但我想设置限制的开始位置，以便显示第二组 5 个结果。

有内置过滤器吗？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-02-10T09:09:33.107

从 Angular 1.4.0 开始，[`limitTo`过滤器](https://docs.angularjs.org/api/ng/filter/limitTo)采用一个可选`begin`参数：

```
<div ng-repeat="item in items | limitTo:5:5">{{item}}</div> 
```

在旧版本中，编写自定义过滤器相当简单。这是一个基于`Array#slice`（注意您传递第一个和最后一个索引，而不是计数）的幼稚实现：

```
app.filter('slice', function() {
  return function(arr, start, end) {
    return (arr || []).slice(start, end);
  };
}); 
```

```
<div ng-repeat="item in items | slice:6:10">{{item}}</div> 
```

工作 jsFiddle：http: [//jsfiddle.net/BinaryMuse/vQUsS/](http://jsfiddle.net/BinaryMuse/vQUsS/)

或者，您可以简单地窃取[整个 Angular 1.4.0 实现`limitTo`](https://github.com/angular/angular.js/blob/master/src/ng/filter/limitTo.js)：

```
function limitToFilter() {
  return function(input, limit, begin) {
    if (Math.abs(Number(limit)) === Infinity) {
      limit = Number(limit);
    } else {
      limit = toInt(limit);
    }
    if (isNaN(limit)) return input;

    if (isNumber(input)) input = input.toString();
    if (!isArray(input) && !isString(input)) return input;

    begin = (!begin || isNaN(begin)) ? 0 : toInt(begin);
    begin = (begin < 0 && begin >= -input.length) ? input.length + begin : begin;

    if (limit >= 0) {
      return input.slice(begin, begin + limit);
    } else {
      if (begin === 0) {
        return input.slice(limit, input.length);
      } else {
        return input.slice(Math.max(0, begin + limit), begin);
      }
    }
  };
} 
```

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2013-07-19T22:04:10.067

AngularJS 提供了开箱即用的功能。如果您仔细阅读 limitTo 文档，它允许您为限制指定负值。这意味着最后有 N 个元素，因此如果要在偏移 5 后处理 5 个结果，则需要执行以下操作：

`<div ng-repeat="item in items | limitTo: 10 | limitTo: -5">{{item}}</div>`

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2014-08-27T20:02:43.093

我开始使用客户过滤器，但后来发现您可以在表达式`slice`内部调用：`ng-repeat`

```
<div ng-repeat="item in items.slice(6, 10)">{{item}}</div> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-11T15:57:41.667

正如蓝屏所说，它可以只使用`limitTo`过滤器来完成，尽管处理Harry Oosterveen 注意到的*最后一页问题需要一些额外的工作。*

即使用**ui-bootstrap** `pagination`指令属性：

```
ng-model       = page  // current page
items-per-page = rpp   // records per page
total-items    = count // total number of records 
```

表达式应该是：

```
<div ng-repeat="item in items | limitTo: rpp * page | limitTo: rpp * page < count ? -rpp : rpp - (rpp * page - count)">{{item}}</div> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-01-07T21:34:46.980

这是一个关于如何使用偏移量和限制过滤列表的功能示例：

```
<!doctype html>
<html lang="en" ng-app="phonecatApp">
<head>
    <script src="lib/angular/angular.js"></script>
    <script src="js/controllers.js"></script>
</head>

<body ng-controller="PhoneListCtrl">

Offset: <input type="text" ng-model="offset" value="0" /><br />
Limit: <input type="text" ng-model="limit" value="10" /><br />
<p>offset limitTo: {{offset - phones.length}}</p>

<p>Partial list:</p>
<ul>
    <li ng-repeat="phone in phones | limitTo: offset - phones.length | limitTo: limit">
        {{$index}} - {{phone.name}} - {{phone.snippet}}
    </li>
</ul>
<hr>
<p>Whole list:</p>
<ul>
    <li ng-repeat="phone in phones">
        {{$index}} - {{phone.name}} - {{phone.snippet}}
    </li>
</ul>   
</body>

</html> 
```

该示例基于[AngularJS 教程的第二步](http://docs.angularjs.org/tutorial/step_02)。

请注意，如果要涵盖限制为 uknnown 的一般情况，则必须将偏移量过滤器作为第一个过滤器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-09T10:03:53.617

来自蓝屏答案：

```
<div ng-repeat="item in items | limitTo: 10 | limitTo: -5">{{item}}</div> 
```

您可能还会发现需要**将第 N 项直到最后一项**的场景，这是使用 limitTo 的另一种方式：

```
<div ng-repeat="item in items | limitTo:-(items.length-5)>{{item}}</div> 
```

负号将与最后一个 items.length 一样多，然后括号内的负 5 将跳过前 5 个项目

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-15T14:28:41.057

有一种更简洁的方法可以做到这一点，而不必调用过滤器，并且表现得更像分页器：

```
$scope.page = 0;
$scope.items = [ "a", "b", "c", "d", "e", "f", "g" ];
$scope.itemsLimit = 5;

$scope.itemsPaginated = function () {
    var currentPageIndex = $scope.page * $scope.itemsLimit;
    return $scope.items.slice(
        currentPageIndex, 
        currentPageIndex + $scope.itemsLimit);
}; 
```

并坚持你的观点：

```
<ul>
    <li ng-repeat="item in itemsPaginated() | limitTo:itemsLimit">{{item}}</li>
</ul> 
```

然后你可以增加/减少`$scope.page`：

```
$scope.page++; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-17T23:03:47.687

您还可以像这样创建自己的可重用过滤器 startFrom：

```
myApp.filter('startFrom', function () {
    return function (input, start) {
        start = +start;
        return input.slice(start);
    }
}); 
```

然后像这样在你的 ng-repeat 中使用它：

```
ng-repeat="item in items | startFrom: 5 | limitTo:5 
```

这样它是“本着 AngularJs 过滤器的精神”完成的，可测试的，如果需要可以有一些“额外的”逻辑，等等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-09T21:47:21.183

@bluescreen 的 ans 和 @Brandon 的 ans 不等价。

例如：

```
var pageSize = 3;  
var page = 2;
var items = [1, 2, 3, 4]; 
```

--

```
item in items | limitTo: page*pageSize | limitTo: -1*pageSize 
```

产生 [2, 3, 4]

```
item in items | slice: (page-1)*pageSize : page*pageSize 
```

生产 [4]

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-08T12:11:25.753

对于基于 Ionic 的项目，请找到以下解决方案：

主页.html：

```
<ion-view view-title="My Music">
  <ion-content>
    <ion-list>
      <ion-item ng-repeat="track in tracks | limitTo: limit | limitTo: -10 ">
        {{track.title}}
      </ion-item>
    </ion-list>
    <div class="list"></div>
    <div align="center">
         <button class="button button-small button-positive" ng-disabled="currentPage == 0" ng-click="decrementLimit()">
            Back
        </button>
        <button class="button button-small button-energized">
        {{currentPage+1}}/{{numberOfPages()}}
        </button>
        <button class="button button-small button-positive" ng-disabled="currentPage >= data_length/pageSize - 1" ng-click="incrementLimit()">
            Next
        </button>
    </div>
  </ion-content>
</ion-view> 
```

控制器.js：

```
var myApp = angular.module('musicApp.controllers', []);

myApp.controller('AppCtrl', function($scope, $http) {
  console.log('AppCtrl called');
  // $scope.tracks = MusicService.query();

  $http.get('api/to/be/called').then(function(result){
    $scope.tracks = result.data['results'];
    $scope.data_length = $scope.tracks.length;
    console.log(result)
    // console.log($sco pe.tracks.length)
  });

  var currentPage = 0;
  $scope.pageSize = 10;

  $scope.numberOfPages = function(){
    return Math.ceil($scope.tracks.length/$scope.pageSize);
  }

  var limitStep = 10;
  $scope.limit = limitStep;
  $scope.currentPage = currentPage;

  $scope.incrementLimit = function(){
    $scope.limit += limitStep;
    $scope.currentPage += 1
  };

  $scope.decrementLimit = function(){
    $scope.limit -= limitStep;
    $scope.currentPage -= 1
  }

}); 
```

# ruby-on-rails-3 - --deployment 标志需要 Gemfile.lock

> ID：14796095
> 
> 赞同：7
> 
> 时间：2013-02-10T08:49:49.970
> 
> 标签：ruby-on-rails-3, capistrano

我花了几个小时但无法解决这个问题。

当我尝试使用将本地 Rails 应用程序部署到生产服务器`capistrano`时，出现以下错误：

```
The --deployment flag requires a Gemfile.lock. Please make sure you have checked your Gemfile.lock into version control before deploying. 
```

关于如何解决这个问题的任何想法？

我的 rails 应用程序文件夹使用 Git 进行版本控制。我已将本地 git repo 推送到 github，Gemfile.lock 就在 github 上。所以它在版本控制之下。然而 capistrano 继续给出同样的错误。

Deploy.rb 文件：[https ://gist.github.com/brahmadpk/4748991](https://gist.github.com/brahmadpk/4748991)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2018-12-10T10:39:51.130

`BUNDLE_FROZEN: "true"`从`.bundle/config`文件中删除并再次运行`bundle`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-10T09:22:53.773

确保发布文件夹中没有任何内容不是发布。有关更多详细信息，请参阅[有关捆绑程序问题的此评论。](https://github.com/carlhuda/bundler/issues/1109#issuecomment-1125098)

这篇题为[Capistrano Deployment Trouble](http://www.octolabs.com/posts/2011/4/22/capistrano_deployment_trouble)的博文解释了同样的问题。

**编辑以包括评论中讨论的结论**

参数未`deploy_to`设置为绝对路径；因此`capistrano`无法找到要部署的文件夹，导致此错误消息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-08T13:10:23.603

我解决了这个问题：

```
set :bundle_gemfile, "your_app_name/Gemfile" 
```

在 deploy.rb

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-19T10:35:23.983

即使发布文件夹中没有文件或文件夹，我也遇到了同样的问题。原来这是一件愚蠢的小事：我的 repo 中的 gemfile.lock 文件是**小写的**出于某种原因**的，而 capistrano 需要 Gemfile.lock 和大写 G**。

这就是我解决它的方法：

1.  删除 gemfile.lock
2.  从你的 repo 中删除 gemfile.lock (git rm ...)
3.  跑`bundle install`
4.  将新的 Gemfile.lock 文件添加到您的存储库中：`git add Gemfile.lock`
5.  从服务器中删除文件夹（不知道这是否真的需要，反正做了）
6.  部署

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T08:52:33.993

运行`bundle`并将您的添加`Gemfile.lock`到您的版本控制中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-22T00:54:52.427

我遇到了完全相同的问题。

我的发布文件夹中没有任何内容（完全没有 - 我的部署冷一直回滚）。

我的 gemfile.lock 已签入 Subversion。

我得到：

```
** [out :: localhost] The --deployment flag requires a Gemfile.lock. Please make sure you   have checked your Gemfile.lock into version control before deploying. 
```

有什么方法可以停止回滚，以便我可以看到发布文件夹在尝试运行时的样子

```
cd /var/qlarity/releases/20130222003607 && bundle install --gemfile /var/qlarity/releases/20130222003607/Gemfile --path /var/qlarity/shared/bundle --deployment --quiet --without development test 
```

之后....

我发现我可以通过注释掉代码来防止回滚，如下所示

```
gems\capistrano-2.14.1\lib\capistrano\recipes\deploy.rb

task :update_code, :except => { :no_release => true } do
  # on_rollback { run "rm -rf #{release_path}; true" }
  strategy.deploy!
  finalize_update
end 
```

这使我能够检查我的发布文件夹，果然，里面没有 Gemfile.lock。原来我在我的 Rails 项目文件结构中得到了一个不必要的文件夹，而不是

```
myapp/trunk/app
myapp/trunk/config
...
myapp/trunk/Gemfile 
```

我有

```
myapp/trunk/myapp/app
myapp/trunk/myapp/config
...
myapp/trunk/myapp/Gemfile 
```

这意味着我最终得到了一个包含我的 Gemfile 的文件夹

```
releases/nnnn/myapp 
```

并且 bundle 正在寻找 Gemfile

```
releases/nnnn 
```

当我将 Capistrano 配置从

```
deploy.rb 

set :repository, "file:///D:/_SVN//myapp/trunk" 
```

至

```
deploy.rb 

set :repository, "file:///D:/_SVN//myapp/trunk/myapp" 
```

现在一切都很好。接下来真的应该看看修复文件夹结构！

# c# - 如何使用 HyperDescriptor 加快转换速度？

> ID：14796097
> 
> 赞同：1
> 
> 时间：2013-02-10T08:50:34.023
> 
> 标签：c#, asp.net, generics, .net-3.5, datatable

我有一个对象列表如下：

```
List<UserTransactionDTO> 
```

* * *

我想将此列表转换为`Datatable`.

我搜索并找到以下链接：

[将通用列表/可枚举转换为数据表？](https://stackoverflow.com/questions/564366/convert-generic-list-enumerable-to-datatable)

它对我有用，但我不知道如何实现`HyperDescriptor`以使其更快。是否有一些 dll 可以使用？

* * *

我只是在上一个链接中使用以下代码，它工作正常：

```
public static DataTable ToDataTable<T>(this IList<T> data)
{
    PropertyDescriptorCollection props =
        TypeDescriptor.GetProperties(typeof(T));
    DataTable table = new DataTable();
    for(int i = 0 ; i < props.Count ; i++)
    {
        PropertyDescriptor prop = props[i];
        table.Columns.Add(prop.Name, prop.PropertyType);
    }
    object[] values = new object[props.Count];
    foreach (T item in data)
    {
        for (int i = 0; i < values.Length; i++)
        {
            values[i] = props[i].GetValue(item);
        }
        table.Rows.Add(values);
    }
    return table;        
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T15:03:55.290

这很简单。在您的项目中引用 HyperDescriptor 库，并在您的应用程序初始化中为每种类型调用一次，以使每种类型的描述符为“超”：

```
Hyper.ComponentModel.HyperTypeDescriptionProvider.Add(typeof(MyType)) 
```

或者，您可以使用我`HyperTypeDescriptionProvider`在项目注释中提供的版本：[HyperDescriptor at CodeProject](http://www.codeproject.com/Articles/18450/HyperDescriptor-Accelerated-dynamic-property-acces?msg=4510470#xx4510470xx)。它修复了我发现的几个问题，包括尝试将类型及其基类型添加到`HyperTypeDescriptionProvider`. 如果你这样做，你可以简单地`Add()`在你的函数中进行调用，并且不会发生不好的事情，因为具有相同类型的第二次调用不会在我的版本中添加两次类型。在`ToDataTable<T>()`函数的顶部，添加以下行：

```
Hyper.ComponentModel.HyperTypeDescriptionProvider.Add(typeof(T)) 
```

无论您采用哪种方式，都不要忘记在之前/之后进行基准测试，以确保您获得性能优势。

PS 我要非常感谢[Marc Gravell](https://stackoverflow.com/users/23354/)在 HyperDescriptor 上所做的工作，我认为这是一些非常漂亮和有用的魔法。

# authentication - 如何在 Windows Store 应用程序中使用 Signalr 设置连接用户名

> ID：14796107
> 
> 赞同：1
> 
> 时间：2013-02-10T08:51:55.493
> 
> 标签：authentication, windows-store-apps, signalr, signalr-hub

我在使用 HTML5/Javascript 的 Windows Store 应用程序中使用 SignalrR。

我想将用户名和密码传递给我的 signalR 集线器。

到目前为止我的代码：

```
connection = $.connection.hub;
connection.url = "http://******/signalr";

gamehub = $.connection.game;
connection.start(function () {
     console.log('connection started!');
}) 
```

它工作正常，连接正常，我可以调用集线器的功能，我可以得到答案。但是我想对用户进行身份验证，所以在连接中传递一些信息。

我试图设置标题，但由于它的 XSS，它不是一个工作选项。据我了解，在 Windows 商店应用程序中设置 cookie 不是一个选项。

请帮助我，如何将凭据传递到集线器。

谢谢

# c# - 接受引用类型和可空类型以适应“as”关键字的通用函数？

> ID：14796112
> 
> 赞同：1
> 
> 时间：2013-02-10T08:52:56.813
> 
> 标签：c#, generics, nullable, overload-resolution, as-keyword

这纯粹是好奇/挑战，根本没有实际意义。**所以我不是在寻找完成工作的替代解决方案。**

从这个问题[最有效的方法来检查 DBNull 然后分配给一个变量？](https://stackoverflow.com/questions/221582/most-efficient-way-to-check-for-dbnull-and-then-assign-to-a-variable)我发现[这个答案](https://stackoverflow.com/a/749234/661933)看起来像：

```
oSomeObject.IntMemeber = oRow["Value"] as int? ?? iDefault;
oSomeObject.StringMember = oRow["Name"] as string ?? sDefault; 
```

我可以将上述表达式移动到一个通用函数（或两个，或更多），以便它同时接受两者`int?`，`string`并且我可以这样称呼它：

```
oSomeObject.IntMemeber = oRow.Read<int?>("Value", 0); //iDefault is now 0
//or
oSomeObject.IntMemeber = oRow.Read<int>("Value"); //iDefault is now default(int)

//and 
oSomeObject.StringMember = oRow.Read<string>("Name"); //sDefault is now default(string) 
```

*要求：*

1) 在 s 的情况下，我需要一个选项来指定默认值`DBNull`。`default(T)`如果我没有指定默认值，我还需要一个返回选项。所以这行不通：

```
public static T Read<T>(this IDataRecord dr, string field, T defaultValue) where T : class
{
    return dr[field] as T ?? defaultValue;
}

public static T? Read<T>(this IDataRecord dr, string field, T? defaultValue) where T : struct
{
    return dr[field] as T? ?? defaultValue;
} 
```

因为我不能打电话`oSomeObject.StringMemeber = oRow.Read<string>("Name")`

它不必是可选参数，甚至可以是重载：

```
public static T Read<T>(this IDataRecord dr, string field) where T : class
{
    return dr[field] as T ?? default(T);
}

public static T? Read<T>(this IDataRecord dr, string field) where T : struct
{
    return dr[field] as T? ?? default(T?);
}

public static T Read<T>(this IDataRecord dr, string field, T defaultValue) where T : class
{
    return dr[field] as T ?? defaultValue;
}

public static T? Read<T>(this IDataRecord dr, string field, T? defaultValue) where T : struct
{
    return dr[field] as T? ?? defaultValue;
} 
```

这不会编译，因为方法 1 和 2 具有相同的签名。

2) 泛型函数（在重载的情况下）应该具有相同的名称。

3)`as`关键字必须使用检查和强制类型。正如我之前所说，我并不是真的在寻找解决方案来读取`IDataRecord`或增强性能或其他东西。

* * *

有类似的问题

1.  [使用引用类型和可为空值类型的 C# 泛型类](https://stackoverflow.com/questions/7490050/c-sharp-generic-class-using-reference-types-and-nullable-value-types)

2.  [是否可以创建一个接受（可为空）值类型和引用类型的 C# 泛型方法？](https://stackoverflow.com/questions/4003026/is-creating-a-c-sharp-generic-method-that-accepts-nullable-value-type-and-refe)

3.  [通用方法可以同时处理引用和可空值类型吗？](https://stackoverflow.com/questions/303287/can-a-generic-method-handle-both-reference-and-nullable-value-types)

但这是非常特定于`as`关键字的。所以那里的答案不适用。

附录：我知道不会有一个单一的解决方案。我会接受哪个是最优雅的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:02:44.863

您链接到的答案似乎很清楚地表明，没有一种好方法可以让泛型方法以您想要的干净方式处理引用类型和值类型。如图所示，答案似乎是给它们起不同的名字。

但是，您可以通过使用`defaultValue`参数的默认值将代码减少到只有两种方法而不是四种方法：

```
public static T Read<T>(this IDataRecord dr, string field, 
                        T defaultValue = null) where T : class
{
    return dr[field] as T ?? defaultValue;
}

public static T? ReadNullable<T>(this IDataRecord dr, string field, 
                                 T? defaultValue = null) where T : struct
{
    return dr[field] as T? ?? defaultValue;
} 
```

`dr.ReadNullable(field)`当您希望结果为 null 且无法强制转换该值以及`dr.ReadNullable(field, someValue)`您想要指定默认值时，您可以使用这种方式。

正如下面所讨论的，在您的原始代码中使用`default(T)`and`default(T?)`是不必要的，因为无论如何它们都将始终为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:53:29.413

似乎没有一种方法。JLRishe 的回答很好。它依赖于重命名重载。这是一些不重命名函数，但在调用方便性上的妥协（即少一个可选参数）

```
static T Read<T>(this object obj, T defaultValue) where T : class
{
    return obj as T ?? defaultValue;
}

static T? Read<T>(this object obj, T? defaultValue) where T : struct
{
    return obj as T? ?? defaultValue;
}

public static T Read<T>(this IDataRecord dr, string field, 
                        T defaultValue) where T : class //no optional parameter here :(
{
    return dr[index].Read<T>(defaultValue);
}

public static T? Read<T>(this IDataRecord dr, string field, T? defaultValue = null) 
                        where T : struct
{
    return dr[index].Read<T>(defaultValue);
} 
```

并调用，例如：

```
Session s = new Session();
s.Id = r.Read("", (byte[])null);
s.UserId = (int)r.Read<int>("");
s.LoginTime = (DateTime)r.Read<DateTime>("");
s.LogoutTime = r.Read("", default(DateTime?));
s.MachineFingerprint = r.Read("", (string)null); 
```

如您所见，需要指定引用类型的默认值。没那么优雅。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T09:59:07.597

想法是使用`is`而不是`as`. 以下方法可以解决问题：

```
 public static T Read<T>(this IDictionary<string, object> dr, string field, T defaultValue)
    {
        var v = dr[field];
        return v is T ? (T)v : defaultValue;
    }

    public static T Read<T>(this IDictionary<string, object> dr, string field)
    {
        var v = dr[field];
        return v is T ? (T)v : default(T);
    } 
```

用法：

```
 Dictionary<string, object> d = new Dictionary<string, object>();

    d["s"] = "string";
    d["i"] = 5;
    d["db.null"] = DBNull.Value;

    Console.WriteLine(d.Read("i", 7));                        // 5
    Console.WriteLine(d.Read("s", "default string"));         // string
    Console.WriteLine(d.Read("db.null", "default string"));   // default string
    Console.WriteLine(d.Read("db.null", -1));                 // -1
    Console.WriteLine(d.Read<int>("i"));                      // 5
    Console.WriteLine(d.Read<string>("s"));                   // string
    Console.WriteLine(d.Read<int>("db.null"));                // 0
    Console.WriteLine(d.Read<string>("db.null") ?? "null");   // null 
```

我已经使用`Dictionary`了快速示例，`IDataRecord`其行为方式相同。

# vba - 创建“新专辑”窗口

> ID：14796115
> 
> 赞同：0
> 
> 时间：2013-02-10T08:53:43.170
> 
> 标签：vba, ms-office, powerpoint

如何使用 VBA 代码调用/创建“新专辑”窗口（具有图像预览和一些选项的窗口）？我正在使用 PowerPoint 2007 或 2010。

我不是在问如何将图像导入幻灯片，而是如何使用 VBA 代码显示“新专辑”窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:47:15.863

Application.CommandBars.ExecuteMso（“PhotoAlbumInsert”）

# android - Android UI 模式：水平滚动

> ID：14796119
> 
> 赞同：0
> 
> 时间：2013-02-10T08:54:27.573
> 
> 标签：android, android-layout

我正在寻找这种模式的代码提示：[http ://www.androidpatterns.com/uap_pattern/horizo​​ntal-scrolling-page-indicators](http://www.androidpatterns.com/uap_pattern/horizontal-scrolling-page-indicators)

我尝试了几个 Android 库，例如[https://github.com/pakerfeldt/android-viewflow](https://github.com/pakerfeldt/android-viewflow)，但无法获得所需的布局。

谁能在这里告诉我如何实现所需的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:32:55.867

看看[`ViewPager`](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)类和[`ViewPagerIndicator`](https://github.com/JakeWharton/Android-ViewPagerIndicator)库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:55:16.103

您可以使用`ViewPager`查看[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

# c# - 当前上下文中不存在 InitializeComponent，使用 Mono C# 编译器

> ID：14796123
> 
> 赞同：1
> 
> 时间：2013-02-10T08:55:37.020
> 
> 标签：c#, linux, ubuntu, mono, initializecomponent

我在 Ubuntu 12.04 中使用 mcs 版本 2.10.8.1，我有以下代码：

```
using System;
using System.Drawing;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            OpenFileDialog dlg = new OpenFileDialog();
            dlg.ShowDialog();

            if (dlg.ShowDialog() == DialogResult.OK)
            {
                string fileName;
                fileName = dlg.FileName;
                MessageBox.Show(fileName);
            }
        }
    }
} 
```

我使用命令编译

```
$ mcs source_code.cs -r:System.Windows.Forms.dll -r:System.Drawing.dll 
```

我收到错误

```
source_code.cs(11,13): error CS0103: The name `InitializeComponent' does not exist in the current context
Compilation failed: 1 error(s), 0 warnings 
```

在使用 Visual Basic 的情况下，我已经看到了很多关于这个问题的答案。我想知道我应该怎么做才能解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:04:42.593

您的 C# 代码最初是在 Visual Studio 中创建的吗？如果是这样，那么您可能会拥有一个`Form1.Designer.cs`文件以及包含您手工编写的代码的文件。您需要在命令行中包含该文件。

如果这*不是*最初在 Visual Studo 中创建的 C# 代码，您甚至可能没有`InitializeComponent`方法……但在这种情况下，您将需要更多代码来在表单中执行任何有用的操作（例如创建按钮并连接其`Click`事件）。

# c# - 将文件夹与 .Net 应用程序捆绑在一起

> ID：14796127
> 
> 赞同：1
> 
> 时间：2013-02-10T08:56:06.820
> 
> 标签：c#, asp.net, winforms

如何将文件夹与一键式应用程序捆绑在一起并在之后引用这些文件/文件夹？

看起来很简单，但我就是不知道怎么做。

例如，我在文件`index.html`夹中有文件`UI`，我想将它与应用程序打包，然后我想用字符串`"/UI/index.html"`而不是`index.html`整个网站获取该文件的流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:47:14.510

将文件夹添加到您的 VS 项目中，右键单击它并选择“嵌入为资源”。这将使文件夹中的文件嵌入到 .NET 程序集中。要获取程序中的文件内容，您可以使用以下内容：

```
public class ReadResource
{
    public string ReadInEmbeddedFile (string filename) {
        // assuming this class is in the same assembly as the resource folder
        var assembly = typeof(ReadResource).Assembly;

        // get the list of all embedded files as string array
        string[] res = assembly.GetManifestResourceNames ();

        var file = res.Where (r => r.EndsWith(filename)).FirstOrDefault ();

        var stream = assembly.GetManifestResourceStream (file);
        string file_content = new StreamReader(stream).ReadToEnd ();

        return file_content;
     }
} 
```

在上述函数中，我假设您的文件是 text/html 文件；如果没有，您可以将其更改为不返回字符串而是返回 byte[]，并为此使用二进制流阅读器。我还选择了`file.EndsWith()`足以满足我需求的文件；如果您的文件夹具有深层嵌套结构，则需要修改该代码以解析文件夹级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:31:24.123

也许有更好的方法，但鉴于内容不是太大，您可以将二进制文件作为 base64 字符串直接嵌入到您的程序中。在这种情况下，它需要是文件夹的存档。您还需要嵌入用于解压缩该存档的 dll（如果我理解正确，您希望拥有单个 .exe，仅此而已）。

这是一个简短的例子

```
// create base64 strings prior to deployment
string unzipDll = Convert.ToBase64String(File.ReadAllBytes("Ionic.Zip.dll"));
string archive = Convert.ToBase64String(File.ReadAllBytes("archive.zip")); 
```

* * *

```
string unzipDll = "base64string";
string archive = "probablyaverylongbase64string";

File.WriteAllBytes("Ionic.zip.dll", Convert.FromBase64String(unzipDll));
File.WriteAllBytes("archive.zip", Convert.FromBase64String(archive);

Ionic.Zip.ZipFile archive = new Ionic.Zip.ZipFile(archiveFile);
archive.ExtractAll("/destination"); 
```

* * *

解压库是 DotNetZip。这很好，因为您只需要一个 dll。[http://dotnetzip.codeplex.com/downloads/get/258012](http://dotnetzip.codeplex.com/downloads/get/258012)

编辑：想一想，只要将 Ionic.dll 写入 .exe 的工作目录，就不需要使用动态 dll 加载，所以我删除了该部分以简化答案（它仍然需要在你达到它的方法之前写）。

# css - CSS属性上边距不显示在萤火虫中

> ID：14796128
> 
> 赞同：0
> 
> 时间：2013-02-10T08:56:12.810
> 
> 标签：css

## 案子

我正在制作一个单页网站，它使用 [One Page Navigation](https://github.com/davist11/jQuery-One-Page-Nav) jQuery 插件进行平滑滚动。内容分为三页：

1.  **主页.html**
2.  **能力.html**
3.  **投资组合.html**

这个想法是当用户在 home.html 中时，一个 jQuery 函数 (js/pop4.js) 会在 div 中使用各自的名称加载其他两个页面的内容：**#abilities-wrapper**和**#portfolio-wrapper** ，反之亦然abilities.html 脚本加载当前页面中的其他两个页面。

我还使用了一个 jQuery 脚本，它`possition:fixed,'top':0, 'left':0`在向下滚动`.hidden` 并向其他两个 div 添加或删除类后添加到菜单中。

## 问题：

*   我希望 div 有一个 margin-top：120 px。我在css文件中设置了这个

**那是我的css文件：**

```
#home-wrapper{
margin-top:120 px;
}
#abilities-wrapper{
margin-top:120 px;
}
#portfolio-wrapper{
margin-top:120 px;
} 
```

**这是我在 Firebug 中得到的：**

```
#home-wrapper{   
}
#abilities-wrapper{   
}
#portfolio-wrapper{    
} 
```

### 整个代码有点长：[你可以在这里看到](http://boxofsand.org/current/home.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:00:40.327

因为你有语法错误。为什么在值和测量单位之间有空格？它应该是这样的：

```
#home-wrapper{
margin-top:120px;
}
#abilities-wrapper{
margin-top:120px;
}
#portfolio-wrapper{
margin-top:120px;
} 
```

该`margin-top`属性未设置，因为您的代码中有错误，因此也不被视为该 div 的样式。

[小提琴](http://jsfiddle.net/B5Hn3/)

# r - 在 R 中绘图时出现非数字矩阵范围错误

> ID：14796129
> 
> 赞同：1
> 
> 时间：2013-02-10T08:56:23.403
> 
> 标签：r

运行此示例的代码时，我在最后一行收到以下错误：

> 矩阵中的错误（平均值（范围），ncol = ncol（x），nrow = nrow（x），dimnames = dimnames（x））：非数字矩阵范围

但是，我记得几个月前看到过其他案例，其中库 arulesViz 使用分类数据类型。

```
landing.data=read.csv2("http://archive.ics.uci.edu/ml/machine-learning-databases/shuttle-landing-control/shuttle-landing-control.data", 
                           sep=",", header=F, dec=".")
    landing.data=as.data.frame(sapply(landing.data,gsub,pattern="\\*",replacement=10))
    library(arules)
    landing.system <- as(landing.data, "transactions")
    rules <- apriori(landing.system, parameter=list(support=0.01, confidence=0.6))
    rulesLandingManual <- subset(rules, subset=rhs %in% "V1=1" & lift>1.2)
    library(arulesViz)
    plot(head(sort(rulesLandingManual, by="confidence"), n=3),
         method="graph",control=list(type="items")) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:30:20.413

`traceback()`运行代码后执行以下操作：

```
6: matrix(mean(range), ncol = ncol(x), nrow = nrow(x), dimnames = dimnames(x))
5: map(m, c(5, 20))
4: graph_arules(x, measure = measure, shading = shading, control, 
       ...)
3: plot.rules(head(sort(rulesLandingManual, by = "confidence"), 
       n = 3), method = "graph", control = list(type = "items"))
2: plot(head(sort(rulesLandingManual, by = "confidence"), n = 3), 
       method = "graph", control = list(type = "items"))
1: plot(head(sort(rulesLandingManual, by = "confidence"), n = 3), 
       method = "graph", control = list(type = "items")) 
```

所以，基本上错误来自`6:`. 该错误意味着任何参数`matrix(.)`都不是数字。为了说明这一点：

```
> matrix(1:4, ncol=2)

#      [,1] [,2]
# [1,]    1    3
# [2,]    2    4

> matrix(1:4, ncol="x")
# Error in matrix(1:4, ncol = "x") : non-numeric matrix extent 
```

你看到错误了吗？我认为随着包的扩展和类的对象，`graph`您在这里无能为力。因此，这可能与开发人员方面有很大关系。如果确实如此，可能值得写/联系开发人员。`map``matrix``rules`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T02:59:09.397

我在挖掘规则的一些数据上遇到了完全相同的问题，在做了一些测试后，我发现这个错误来自于使用 sort() 和 head() 命令，当有更多规则满足条件时质量措施超出要求。

例如，在您的代码中，您要求在 rulesLandingManual 中绘制 3 个置信度最高的规则，但是如果您检查（rulesLandingManual），您会发现有 216 个置信度为 1（最大置信度）的规则，因此，当您要求对顶部进行子集化时n （n 小于 217），在这个新规则对象中生成的矩阵变得混乱，至少对于 plot 函数中的 graph 方法。

为了测试我正在解释的内容，在您的代码中，将 n 更改为 217 到 224 之间的任何值（224 是 rulesLandingManual 中的规则数），它将绘制图形，而 n = 216 或更少将导致上述错误。

我不知道这是打算以这种方式工作还是它是一个错误，我现在正试图弄清楚，所以解释会非常方便。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-10T09:33:08.723

`range`是一个函数。你的意思是`mean(range(x)), ...`？

平均意思。呵呵。

# mysql - 在我的页面上显示西里尔文字

> ID：14796132
> 
> 赞同：0
> 
> 时间：2013-02-10T08:57:22.683
> 
> 标签：mysql, text, collation

我在整个互联网上搜索了这个对其他人来说似乎很容易但对我来说并不容易的问题。我的数据库中有西里尔文文本，但它只显示????。连接后我在网上找到了关于 SET NAMES utf8 的信息，我这样做了，但没有任何改变。我也把数据库中的排序规则改成了utf8_unicode_ci，还是一样。我也有符号，比如 ÐŸÑŠÑ€Ð²Ð°Ñ‚Ð 但我通过浏览器（Chrome）的编码来解决这个问题。但是来自数据库的文本仍然带有??????。我正在使用 xampp 服务器。如果有人帮我解决这个问题，我会很高兴，我尝试了我在网上找到的所有东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:03:13.233

确保 MySQL 以 UTF-8 返回结果。使用以下 Mysql 命令：

```
SET CHARACTER SET utf8; 
```

命令`SET NAMES`不影响发送给 MySQL 使用的数据。它只是告诉 MySQL，您的查询将使用 UTF-8。

还要确保浏览器知道您的页面使用“UTF-8”。通常这是通过像这样添加`;charset=utf8-8`到`Content-Type`标题字段来完成的：

```
ContentType: text/html; charset=utf-8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T18:18:32.183

在搜索设置西里尔文字数小时后，我找到了答案。它是如此简单，这是我的错误。当我将信息放入数据库时​​，我没有将排序规则设置为 utf-8_unicode_ci 而是其他。那是错误。在那之后我做到了。所以我通过再次创建它来解决这个问题，但是在我将任何信息放入其中之后，我将排序规则设置为 utf8_unicode_ci。我希望这个答案对像我这样的其他人有所帮助。我要感谢所有试图帮助我的人。

# django - 异常代码的 AttributeError

> ID：14796140
> 
> 赞同：0
> 
> 时间：2013-02-10T08:58:35.150
> 
> 标签：django, exception

我有这个包含 try 和 except 的函数。我在获取异常代码时遇到问题。

我先写了这样的代码：

```
def _runQuery(self, query, request=None)
    try:
        //request codes here
    except Exception, e:
        messages.error(
            request,
            'Error connecting to OFX server. URL: {0} ERROR: {1} {2}'.format(
                self.account.bank.ofx_url, e.code, e.msg))
        return '' 
```

我的异常总是给我一个 AttributeError ，即 e 对象没有属性“代码”。所以我认为有时异常没有代码渲染或为空。我再次重写我的代码，这是最新的。

```
 except Exception, e:
        code = ""
        if e.code:
            code = e.code
        messages.error(
            request,
            'Error connecting to OFX server. URL: {0} ERROR: {1} {2}'.format(
                self.account.bank.ofx_url, code, e.msg)) 
```

现在它给了我不同的错误 - AttributeError: 'SSLError' object has no attribute 'code'

如何解决这个问题？并获得没有这个问题的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T17:31:17.700

尝试这个：

```
except Exception, e:
    code = ""
    if hasattr(e, 'code'):
        code = e.code
    messages.error(
        request,
        'Error connecting to OFX server. URL: {0} ERROR: {1} {2}'.format(
            self.account.bank.ofx_url, code, e.msg)) 
```

当您检查异常是否存在时，您可以使用`hasattr()`which 将返回 False 而不是抛出另一个异常，而不是尝试访问异常的 code 属性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-10T10:23:48.917

查看[hasattr 和 getattr](http://docs.python.org/2/library/functions.html#hasattr)函数：

```
messages.error(
        request,
        'Error connecting to OFX server. URL: {0} ERROR: {1} {2}'.format(
            self.account.bank.ofx_url, getattr(e, 'code', ''), e.msg)) 
```

# c# - 使用 T4 自定义一些自动生成的代码

> ID：14796145
> 
> 赞同：2
> 
> 时间：2013-02-10T08:59:45.493
> 
> 标签：c#, templates, customization, t4, auto-generate

我首先在 EF 代码中使用“EF 4.x DbContext Fluent Genarator”生成我的 poco 类、映射文件和上下文文件。（实际上“EF 4.x DbContext Fluent Genarator”使用 3 个 T4 文件）现在我想申请自动生成代码的一些更改：

1.  更改某些类的命名空间。
2.  将某些类的某些字段标记为 [NonSerializable]
3.  更改我添加到 T4 模板的 pocos 上的一些自动生成的自定义方法的主体。

我如何继续使用 T4 文件来完成这些工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:04:27.150

对于#3。这应该有帮助

这些类是分部类，因此您可以创建一个与分部具有相同类的新 .cs 文件。添加自定义方法。

我想不出#1 的直截了当的方式。& #.2 因为当有人再次更新/构建时，对自动生成的类的更改将丢失。

# c++ - 查找指针指向的数组的大小

> ID：14796147
> 
> 赞同：0
> 
> 时间：2013-02-10T09:00:17.003
> 
> 标签：c++

我有以下代码：

```
int* d = (int*) malloc(100 * sizeof(int));
cout<<"size of d which is pointer is: " << sizeof(d)<<endl; 
```

我知道 sizeof 输出 4 因为 d 是一个 ptr。但是，如何使用 sizeof 找到整个数组的大小

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T09:04:39.723

您不能 -`sizeof`是编译时操作，因此不是动态的。

当您使用 c++ 时，请`std::vector`改用。否则创建一个结构来存储数组的指针和大小。而是通过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:07:56.853

指针为您提供了存储数据的内存位置，这就是为什么您不能仅从该信息中获取其大小的原因。

这类似于通过知道我的地址知道我的房子有多大（没有先验知识或使用谷歌地图等工具）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T09:16:28.993

直接回答。不，你不能，但你可以试试这个：

```
int x[]={1,2,3,4};
int *ptr=x;
decltype(sizeof(*ptr)) size=0;
while(*ptr<5){
          size =size+sizeof(*ptr);
          ptr++;
          }
          cout<<"Size is : "<<size; 
```

输出：

`Size is:16`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T09:29:28.123

你可能会争辩说你已经知道整个数组的大小了`sizeof`- 你在原来的`malloc`调用中已经知道了 - `100 * sizeof(int)`。尽管`malloc`机器必须在内部知道与指针关联的内存量（它需要它进行相应的`free`调用），并且显然某些实现提供了返回此信息的函数，但据我所知，没有实现独立和可移植的方式这样做而不自己处理。

# javascript - 使对象可观察

> ID：14796148
> 
> 赞同：10
> 
> 时间：2013-02-10T09:00:23.933
> 
> 标签：javascript, design-patterns, observable

我最近一直在研究诸如 Angular 和 Meteor 之类的 JavaScript 框架，我想知道他们如何知道对象属性何时发生更改，以便他们可以更新 DOM。

我有点惊讶 Angular 使用普通的旧 JS 对象，而不是要求您调用某种 getter/setter 以便它可以挂钩并进行必要的更新。我的理解是他们只是定期轮询对象以进行更改。

但是随着[JS 1.8.5](https://developer.mozilla.org/en-US/docs/JavaScript/New_in_JavaScript/1.8.5)中 getter 和 setter 的出现，我们可以做得更好，不是吗？

作为一个小小的概念验证，我整理了这个脚本：

（**编辑：**更新代码以添加依赖属性/方法支持）

```
function dependentProperty(callback, deps) {
    callback.__dependencies__ = deps;
    return callback;
}

var person = {
    firstName: 'Ryan',
    lastName: 'Gosling',
    fullName: dependentProperty(function() {
        return person.firstName + ' ' + person.lastName;
    }, ['firstName','lastName'])
};

function observable(obj) {
    if (!obj.__properties__) Object.defineProperty(obj, '__properties__', {
        __proto__: null,
        configurable: false,
        enumerable: false,
        value: {},
        writable: false
    });
    for (var prop in obj) {
        if (obj.hasOwnProperty(prop)) {
            if(!obj.__properties__[prop]) obj.__properties__[prop] = {
                value: null,
                dependents: {},
                listeners: []
            };
            if(obj[prop].__dependencies__) {
                for(var i=0; i<obj[prop].__dependencies__.length; ++i) {
                    obj.__properties__[obj[prop].__dependencies__[i]].dependents[prop] = true;
                }
                delete obj[prop].__dependencies__;
            }
            obj.__properties__[prop].value = obj[prop];
            delete obj[prop];
            (function (prop) {
                Object.defineProperty(obj, prop, {
                    get: function () {
                        return obj.__properties__[prop].value;
                    },
                    set: function (newValue) {
                        var oldValue = obj.__properties__[prop].value;
                        if(oldValue !== newValue) {
                            var oldDepValues = {};
                            for(var dep in obj.__properties__[prop].dependents) {
                                if(obj.__properties__[prop].dependents.hasOwnProperty(dep)) {
                                    oldDepValues[dep] = obj.__properties__[dep].value();
                                }
                            }
                            obj.__properties__[prop].value = newValue;
                            for(var i=0; i<obj.__properties__[prop].listeners.length; ++i) {
                                obj.__properties__[prop].listeners[i](oldValue, newValue);
                            }
                            for(dep in obj.__properties__[prop].dependents) {
                                if(obj.__properties__[prop].dependents.hasOwnProperty(dep)) {
                                    var newDepValue = obj.__properties__[dep].value();
                                    for(i=0; i<obj.__properties__[dep].listeners.length; ++i) {
                                        obj.__properties__[dep].listeners[i](oldDepValues[dep], newDepValue);
                                    }
                                }
                            }
                        }
                    }
                });
            })(prop);
        }
    }
    return obj;
}

function listen(obj, prop, callback) {
    if(!obj.__properties__) throw 'object is not observable';
    obj.__properties__[prop].listeners.push(callback);
}

observable(person);

listen(person, 'fullName', function(oldValue, newValue) {
    console.log('Name changed from "'+oldValue+'" to "'+newValue+'"');
});

person.lastName = 'Reynolds'; 
```

哪些日志：

> 名称从“瑞恩·高斯林”更改为“瑞恩·雷诺兹”

我看到的唯一问题是定义方法，例如`fullName()`依赖于其他两个属性的 person 对象。这需要对对象进行一些额外的标记，以允许开发人员指定依赖项。

除此之外，这种方法有什么缺点吗？

[提琴手](http://jsfiddle.net/mnbayazit/vQ6Lf/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:24:06.757

> JS 1.8.5 中 getter 和 setter 的出现——这种方法有什么缺点吗？

*   除了观察到的变化之外，您不会捕获任何属性变化。当然，这对于建模实体对象来说已经足够了，对于我们可以使用代理的任何其他东西来说，这已经足够了。
*   它仅限于支持 getter/setter 的浏览器，甚至可能是代理。但是，嘿，谁关心过时的浏览器呢？:-) 在受限环境（Node.js）中，这根本不成立。
*   访问器属性（带有 getter 和 setter）比真正的 get/set 方法慢得多。当然我不希望它们被用在关键部分，它们可以让代码看起来更漂亮。但是，您需要将其牢记在心。此外，花哨的代码可能会导致误解——通常您会期望属性分配/访问是一个简短的 ( `O(1)`) 操作，而使用 getter/setter 可能会发生更多事情。您需要注意不要忘记这一点，并且使用实际方法可能会有所帮助。

因此，如果我们知道自己在做什么，是的，我们*可以*做得更好。

尽管如此，我们需要记住一个重要的点：同步/异步（也看看[这个优秀的答案](https://stackoverflow.com/a/9693933/1048572)）。Angular 的脏检查允许您在下一个事件循环轮次触发事件*之前*一次更改一堆属性。这有助于避免（传播）语义上无效的状态。

然而，我也将同步 getter/setter 视为一个机会。它们确实允许我们*声明*属性之间的依赖关系并由此定义有效状态。它将自动确保模型的正确性，而我们一次只需更改一个属性（而不是一直更改`firstName`，`fullName`就`firstName`足够了）。然而，在依赖解决期间，这可能不成立，所以我们需要关心它。

因此，与依赖管理无关的监听器应该被异步触发。只是`setImmediate`他们的循环。

# python - 如何从 python urllib 的 urlopen 获取 HTTP 返回码？

> ID：14796153
> 
> 赞同：5
> 
> 时间：2013-02-10T09:01:18.003
> 
> 标签：python, urllib, python-2.5

我有以下代码：

```
f = urllib.urlopen(url)
html = f.read() 
```

我想知道打开上面的 url 后的 HTTP 状态代码（HTTP 200、404 等）。

有人知道怎么做吗？

PS我使用python 2.5。

谢谢！！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T09:06:53.577

您可以使用`.getcode()`返回的对象的方法`urlopen()`

```
url = urllib.urlopen('http://www.stackoverflow.com/')
code = url.getcode() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T09:59:57.413

`getcode()`仅在 Python 2.6 中添加。据我所知，在 2.5 中无法从请求本身获取状态代码，但 FancyURLopener 提供了一组函数，这些函数在某些错误代码上被调用——您可能会使用它来将状态代码保存在某处。我将它分类以告诉我何时发生 404

```
import urllib

class TellMeAbout404s(urllib.FancyURLopener):
    def http_error_404(self, url, fp, errcode, errmsg, headers, data=None):
        print("==== Got a 404")

opener = TellMeAbout404s()
f = opener.open("http://www.google.com/sofbewfwl")
print(f.info()) 
```

`info()`提供 HTTP 标头但不提供状态代码。

# android - Android中的strace shell命令问题

> ID：14796156
> 
> 赞同：0
> 
> 时间：2013-02-10T09:01:44.070
> 
> 标签：android, shell, adb, strace

我正在构建一个监视器应用程序，它在后台运行并使用*strace*命令记录当前正在运行的应用程序执行的系统调用。

```
String cmd="strace -p "+processID+" -o /mnt/sdcard/traceFile_"+processID+".txt";
Runtime.getRuntime().exec(cmd); 
```

这里的*processID*是当前运行的进程的 PID，它是从其他一些实现的方法中获得的。它记录了它正确监控的第一个应用程序的系统调用以及所有已执行的系统调用信息。但是当一个新的应用程序启动时（第二个开始），*processID*被正确更新，但是文件**traceFile_processID**被写为一个空文件。我无法弄清楚它为什么会发生。是不是因为监控的第一个应用程序的 strace 执行仍然存在？如果是这样，我如何执行 ^C 来终止该会话并像在 adb shell 命令提示符中那样启动一个新会话？请帮助我......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:30:46.407

如果您想像您所说的那样“^C”，那么您真正要求的是如何将名为 SIGINT 的信号提升到给定的 processID。您可以通过简单地做到这一点`kill(processID, SIGINT);`- 这相当于在目标进程的键盘上按 Ctrl-C。

# c# - 如何使用 C# 安装 Windows 字体

> ID：14796162
> 
> 赞同：9
> 
> 时间：2013-02-10T09:02:44.990
> 
> 标签：c#, fonts, access-denied, unauthorized

如何使用 C# 安装字体？

我尝试使用复制字体，但由于访问权限限制 ( ) `File.Copy()`，我不被允许。`UnauthorizedException`

我该怎么办？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-10T09:17:36.023

您将需要一种不同的方法来安装字体。

*   使用安装程序（创建安装项目）安装字体
*   使用本机方法的另一种（更简单）方法。

声明 dll 导入：

```
 [DllImport("gdi32.dll", EntryPoint="AddFontResourceW", SetLastError=true)]
    public static extern int AddFontResource(
        [In][MarshalAs(UnmanagedType.LPWStr)]
        string lpFileName); 
```

在您的代码中：

```
 // Try install the font.
    result = AddFontResource(@"C:\MY_FONT_LOCATION\MY_NEW_FONT.TTF");
    error = Marshal.GetLastWin32Error(); 
```

来源：

[http://www.brutaldev.com/post/2009/03/26/Installing-and-removing-fonts-using-C](http://www.brutaldev.com/post/2009/03/26/Installing-and-removing-fonts-using-C)

我把它放在一个单元测试中，我希望能有所帮助：

```
[TestFixture]
public class Tests
{
    // Declaring a dll import is nothing more than copy/pasting the next method declaration in your code. 
    // You can call the method from your own code, that way you can call native 
    // methods, in this case, install a font into windows.
    [DllImport("gdi32.dll", EntryPoint = "AddFontResourceW", SetLastError = true)]
    public static extern int AddFontResource([In][MarshalAs(UnmanagedType.LPWStr)]
                                     string lpFileName);

    // This is a unit test sample, which just executes the native method and shows
    // you how to handle the result and get a potential error.
    [Test]
    public void InstallFont()
    {
        // Try install the font.
        var result = AddFontResource(@"C:\MY_FONT_LOCATION\MY_NEW_FONT.TTF");
        var error = Marshal.GetLastWin32Error();
        if (error != 0)
        {
            Console.WriteLine(new Win32Exception(error).Message);
        }
    }
} 
```

这应该可以帮助你:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-09T17:37:28.370

```
 internal static void InstalarFuente(string NombreFnt,string RutaFnt)
    {
        string CMD = string.Format("copy /Y \"{0}\" \"%WINDIR%\\Fonts\" ", RutaFnt);
        EjecutarCMD(CMD);

        System.IO.FileInfo FInfo = new System.IO.FileInfo(RutaFnt);
        CMD = string.Format("reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\" /v \"{0}\" /t REG_SZ /d {1} /f", NombreFnt, FInfo.Name);
        EjecutarCMD(CMD);
    }

    public static void EjecutarCMD(string Comando)
    {
        System.Diagnostics.ProcessStartInfo Info = new System.Diagnostics.ProcessStartInfo("cmd.exe");
        Info.Arguments = string.Format("/c {0}", Comando);
        Info.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
        System.Diagnostics.Process.Start(Info);
    } 
```

# java - 在 Java 中使用对象作为数组

> ID：14796166
> 
> 赞同：-2
> 
> 时间：2013-02-10T09:03:14.227
> 
> 标签：java

我想创建一个名为 User 的类的数组对象，当我单击复选框时，应该创建该类的新对象。当我运行并单击复选框错误：线程“AWT-EventQueue-0”java.lang 中的异常。空指针异常

```
public class User
{
    public int user_amt;
    int user_location;
    String user_name;
    private boolean user_isSelected()
    {
            return true;
    }
    int user_id;
User()
{
    user_amt = 0;
    user_location = 0;
    user_name = "NUL";
    user_id = 0;
    user_isSelected();

} 
```

}

```
class main()
{
 int users_active;
 private void jCheckBox1ActionPerformed(java.awt.event.ActionEvent evt) {

        users_active++;
        User[] user = new User();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:05:12.987

只需尝试：

```
User[] user = new User[5];
user[0] = new User(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:20:24.610

您的代码的问题是您正在创建一个引用数组，但每个引用都必须在堆上创建。

所以`User[] user = new User[5]`<- 创建 5 个引用

`user[0] = new User();`<-`User`在堆上创建 1 个类型的对象并将其分配给`user[0]`引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T09:21:18.733

以下是完全错误的。

```
User[] user = new User(); 
```

`User[] user`是用户数组，而`new User()`是用户的单个实例。

其次，当您使用 C++、C# 或 Java 编码时，您需要放弃所有关于 Visual Basic 的知识，因为您需要在向数组添加成员之前预先分配数组的大小。

你不能做

```
User[] users;
for(int i=0; i<10; i++){
  users[i] = new User();
} 
```

你必须

```
User[] users = User[10];
for(int i=0; i<10; i++){
  users[i] = new User();
} 
```

或者

```
User[] users = {
  new User(), new User(), new User(), new User(), new User(), 
  new User(), new User(), new User(), new User(), new User()
} 
```

这就是您应该考虑使用 ArrayList 的原因，因为它们是可扩展的。虽然数组不可扩展。

```
List<User> users = new ArrayList<User>();
for(int i=0; i<10; i++){
  users.add(new User());
} 
```

要获得第 5 个成员，

```
users.get(4); 
```

# c++ - Qt QScrollArea 自动滚动

> ID：14796170
> 
> 赞同：3
> 
> 时间：2013-02-10T09:04:12.820
> 
> 标签：c++, qt

我在使用 QLabel 和 QScrollArea 时遇到问题。我试图让 QScrollArea 自动滚动，但找不到任何关于它的信息..

首先，我在 QScrollArea 内使用 QLabel，然后在 QScrollArea 外使用 QLineEdit。当我在 QLineEdit 中键入文本时，它会写入 QLabel 和新行。每当它到达区域末尾时，QScrollArea 不会自动滚动。我该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T05:48:35.993

你不能使用 QLineEdit 本身而不是 Qlabel（如果你只使用文本）吗？这样你也不必使用 QScrollArea。

[编辑] 如果将 verticalSlider 位置设置为 Label->height() 会怎样

```
void MainWindow::on_lineEdit_returnPressed() 
{ 
  ui->label->setText(ui->label->text() + ui->lineEdit->text() + "\n"); 

  ui->ScrollArea->verticalScrollBar()->setSliderPosition(label->height())

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:37:16.273

看看这个例子： http: [//qt-project.org/forums/viewthread/23790/](http://qt-project.org/forums/viewthread/23790/) 没有看到你的代码很难更精确......

[编辑]试试这个：

```
void MainWindow::on_lineEdit_returnPressed() 
{ 
  ui->label->setText(ui->label->text() + ui->lineEdit->text() + "\n"); 

  ui->lineEdit->moveCursor (QTextCursor::Start) ;
  ui->lineEdit->ensureCursorVisible() ;

  ...
} 
```

# jquery - 如何将单个 jquery ui 对话框用于多种用途

> ID：14796174
> 
> 赞同：0
> 
> 时间：2013-02-10T09:04:32.057
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我想为多个目的使用相同的 jquery ui 对话框。

在这种情况下，我在每一行都有一个带有复选框的数据网格。用户可以通过按下按钮（删除）来删除他检查的行。每当按下按钮时，都会显示一个 jquery ui 对话框（确认框），其中包含您要删除的消息吗？是还是不是

但是当没有选中复选框并且用户按下删除按钮时，我想在内容中显示具有不同标题和 msg（未选择行）的 jquery ui 对话框。我怎样才能做到这一点 ？

目前我的代码如下所示：

```
 $(document).ready(function() {
            $( "#dialog" ).dialog({
                autoOpen: false,
                width:"400px",
                modal: true,
                resizable: true,
                buttons: [
                    {
                        text: "Yes",
                        click: function() {
                            $('#form_list_action').submit();
                        }
                    },
                    {
                        text: "Cancel",
                        click: function() {
                            $( this ).dialog( "close" );
                        }
                    }
                ]
            });
            $( "#action-delete" ).on('click', function(event) {
                event.preventDefault();
                $( "#dialog" ).dialog( "open" );

            });

<div id="dialog" title="Delete Selected Items">
 <p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;">   </span>These items will be permanently deleted and cannot be recovered. Are you sure?</p>
</div>

 <a href="" class="action-delete" id="action-delete">Delete</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:23:33.943

当我需要一个对话框时，我正在使用这个函数来动态创建一个对话框。

```
function showPopup(title,url,height,width,data,showCloseBtn)
{
    showCloseBtn = showCloseBtn || false;
    height = height || 'auto';
    width = width || 'auto';

    //Create popup container if needed or remove content
    if($('#popup').length == 0)
        $('body').append('<div id="popup"></div>');
    else
        $('#popup').empty();

    //Reset dialog widget if needed
    try{$('#popup').dialog('destroy');}catch(e){}

    if(showCloseBtn)
        btnCode = {"Fermer": function(){$( this ).dialog( "close" );}}
    else
        btnCode = null;

    //Load content if the data provided is html code
    if(url.search('<') >= 0)
    {
        $('#popup').html(url);
        $('#popup').dialog({
                resizable: false,
                modal: true,
                width: width,
                height : height,
                buttons:btnCode,
                title : title
            });        
    }
    else
    {
        var data = data || {};
        //Load data from url
        $('#popup').load(url,data,function(){
            $(this).dialog({
                resizable: false,
                modal: true,
                width: width,
                height : height,
                buttons:btnCode,
                title : title
            });        
        });                           
    }    
} 
```

# android - 如何为android活动背景设置动画

> ID：14796186
> 
> 赞同：1
> 
> 时间：2013-02-10T09:06:11.043
> 
> 标签：android, animation, background

在我的 android 应用程序中，我想显示一个背景动画。我通过随时间更改图像来使用图像完成它。但是我的问题是通过为每一帧动画使用图像，应用程序的大小变得越来越大，我知道这不是一个好方法。

我想以高效和良好的方式做到这一点。

如果我通过使用图像来做到这一点，这是最好的方式。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:04:22.800

图像总是在 android 中使用更多内存的东西。如果您正在使用图像，则无法使应用程序使用更少的内存，它只会根据图像大小使用内存，但我有一种方法可以遵循。如果需要带有图像的背景动画，那么我会使用优化的图像。优化就像使用适合屏幕分辨率、大小等的图像。此外，我会为不同的屏幕分辨率使用不同尺寸的图像，这样对于较小的屏幕分辨率，图像的尺寸会更小。希望至少对您有所帮助。

编辑 ：

[在使用配置限定符下，您](http://developer.android.com/guide/practices/screens_support.html)将找到有关拥有 XML 文件的信息。您应该为此使用计时器，因为您需要及时更改图像。如果您不想使用计时器，请使用[this](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:51:05.593

搜索了一段时间后，我开始了解这个（[http://www.edumobile.org/android/android-development/frame-animation/](http://www.edumobile.org/android/android-development/frame-animation/)）解决方案。

# neo4j - 索引集合弹簧数据neo4j

> ID：14796189
> 
> 赞同：1
> 
> 时间：2013-02-10T09:06:53.047
> 
> 标签：neo4j, spring-data-neo4j

我正在试验/学习弹簧数据neo4j。我有一个非常简单的应用程序，可以存储来自 twitter 的推文。请看下面的片段。

```
@NodeEntity
public class Tweet {

    @GraphId
    private Long id;

    private String tweet;

    @Indexed
    Set<String> hashtags; 
```

问题是，存储哈希标签的最佳方式是什么，以便我可以快速获取它们所属的推文？我能想到的要么是在 Set 上使用 @Indexed，要么实际上创建一个单独的 Hashtag NodeEntity 并在它和推文之间建立关系。我找不到任何关于在 NodeEntity 中为集合建立索引的文档，所以我不确定是在集合对象上创建索引还是集合中的每个字符串都被索引。任何建议都会很好。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T15:44:24.193

当你这样做时，`@Indexed`它会被放入 Neo4j 的索引系统中，即 Lucene。Lucene 实际上并不索引集合，而是集合的字符串表示。

至于您的数据模型，我将创建一个`HashTag`节点，每个推文都将连接到该节点。对于更常见的哈希标签，您最终会遇到密集节点问题，但总的来说，它允许您进行更多分析，例如获取具有相同哈希标签的所有推文。

# java - Gson - 无法解析的日期

> ID：14796195
> 
> 赞同：27
> 
> 时间：2013-02-10T09:07:44.580
> 
> 标签：java, gson

我必须将 Json 对象与具有 Date 的 java 对象绑定。我的 Json 上的日期格式如下：

2013-01-04T10:50:26+0000

我正在使用 GsonBulder 如下：

```
Gson gson = new GsonBuilder().setDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").create(); 
```

但我得到以下异常：

```
The RuntimeException could not be mapped to a response, re-throwing to the HTTP container
com.google.gson.JsonSyntaxException: 2013-01-04T10:50:26+0000
at com.google.gson.internal.bind.DateTypeAdapter.deserializeToDate(DateTypeAdapter.java:81)
.....
Caused by: java.text.ParseException: Unparseable date: "2013-01-04T10:50:26+0000"
at java.text.DateFormat.parse(DateFormat.java:337)
at com.google.gson.internal.bind.DateTypeAdapter.deserializeToDate(DateTypeAdapter.java:79) 
```

我正在尝试使用 Gson 加载此请求：

```
https://graph.facebook.com/me?fields=id,username,email,link,updated_time&access_token=accessToken 
```

回应是

```
{"id":"12345","username":"myusername","email":"myemail\u0040yahoo.it","link":"http:\/\/www.facebook.com\/mysusername","updated_time":"2013-01-04T10:50:26+0000"} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-10T12:49:34.560

反序列化失败，因为 json 字符串中的引号丢失。

以下作品：

```
 Gson gson=  new GsonBuilder().setDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").create();

    String date = "\"2013-02-10T13:45:30+0100\"";
    Date test = gson.fromJson(date, Date.class);
    System.out.println("date:" + test); 
```

输出：

> 日期：2013 年 2 月 10 日星期日 13:45:30 CET

高温高压

**编辑完整示例：**

```
import java.util.Date;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

public class FacebookResponse {

int id;
String username;
String email;
String link;
Date updated_time;

@Override
public String toString() {
    return "ID: " + id + " username: " + username + " email: " + email + " link: " + link + " updated_time: " + updated_time;
};

/**
 * @param args
 */
public static void main(String[] args) {        
    String json = "{\"id\":\"12345\",\"username\":\"myusername\",\"email\":\"myemail\u0040yahoo.it\",\"link\":\"http://www.facebook.com/mysusername\",\"updated_time\":\"2013-01-04T10:50:26+0000\"}";
    Gson gson=  new GsonBuilder().setDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").create();

    FacebookResponse response = gson.fromJson(json, FacebookResponse.class);
    System.out.println(response);
} 
```

}

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-03-24T17:44:37.403

```
@PUT
@Produces(MediaType.APPLICATION_JSON)
@Consumes(MediaType.APPLICATION_JSON)
public Response put(@HeaderParam
                    final String userFromString,
                    @Context final HttpServletRequest req) {

    JSONObject jsonObject = new JSONObject(userFromString);
    ReturnCode resultCode = null;
    UserDto user= new UserDto();
    Gson gson=  new GsonBuilder().setDateFormat("yyyy-MM-dd").create();
    user= gson.fromJson(userFromString,UserDto.class); 
```

# c# - 时间戳通过代码生成的数据类型

> ID：14796202
> 
> 赞同：3
> 
> 时间：2013-02-10T09:09:02.887
> 
> 标签：c#, sql-server

我的 SQL Server 数据库中应该有时间戳数据类型行。我正在使用代码优先的方法，所以我想从我的域 util 类中生成这个字段。

那么，如何将该属性声明为数据库中的时间戳呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T09:11:22.130

您可以使用用[`[Timestamp]`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.timestampattribute.aspx)属性修饰的字节数组：

```
[Timestamp] 
public byte[] SomeTimestamp { get; set; } 
```

您可能还想检查[`following article`](http://www.undisciplinedbytes.com/2012/03/creating-a-timestamp-column-with-entity-framework/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:16:33.083

你可以使用这个样本

```
...
       public byte[] TimeStamp { get; set; }
    }

     public class UserModelConfiguration: EntityTypeConfiguration<User> {
            public UserModelConfiguration() {
                Property(p => p.TimeStamp).IsRowVersion();            
            }
        } 
```

# bash - 如何知道后台运行的进程的退出代码

> ID：14796204
> 
> 赞同：0
> 
> 时间：2013-02-10T09:09:05.797
> 
> 标签：bash

我正在编写一个脚本，它在后台运行一个进程，同时显示一个进度条，直到提到的进程结束。我的问题是，如何检查该进程的退出代码？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T09:16:22.723

[`wait`](http://www.gnu.org/software/bash/manual/bashref.html#Job-Control-Builtins)如果您指定 PID 或作业规范，则内置函数将返回等待进程的退出代码。（请注意，如果您不指定其中任何一个，它将返回零。）

以下是您可以使用它的方法：

```
#! /bin/bash

(exit 10)&
pid=$!
wait $pid
echo $? 
```

这将打印`10`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T09:12:05.437

你可以使用 $? 多变的：

```
command & #run command in background
pid=$!    #get pid
wait $!   #wait for the sucker to finish
status=$? #exitcode for pid 
```

# python - 使用 Google Apps Engine 时出现 Python 错误

> ID：14796210
> 
> 赞同：1
> 
> 时间：2013-02-10T09:11:19.933
> 
> 标签：python, google-app-engine, post

我在 Google Apps Engine 上托管一个网站，并尝试使用 Python 的邮件 API 来获取 POST 数据并发送电子邮件。

这是我的脚本：

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.api import mail

class SendEmail(webapp.RequestHandler):
    def post(self):

        name = self.request.get('name')
        # self.response.out.write(name)
        email = self.request.get('email')
        tempSubject = self.request.get('subject')
        msg = self.request.get('message')

        if name is None:
            self.response.out.write("Error: You did not enter a name.")
        elif email is None:
            self.response.out.write("Error: You did not enter an email.")
        elif tempSubject is None:
            self.response.out.write("Error: You did not enter a subject.")
        elif msg is None:
            self.response.out.write("Error: You did not enter a message.")
        else:
            _subject = "Msg from: " + name + "Re: " + tempSubject

            message = mail.EmailMessage(sender = "foo@bar.com", to = "bar@foo.com", subject = _subject, body = msg, reply_to = email)
            message.send()

def runApp():
    application = webapp.WSGIApplication([('/email', SendEmail)], debug=True)
    run_wsgi_app(application)

if __name__ == '__main__':
    runApp() 
```

这是服务器上日志的回溯：

```
<type 'exceptions.NameError'>: name 'name' is not defined
Traceback (most recent call last):
  File "/base/data/home/apps/s~alex-young/1.365202894602706277/email.py", line 5, in <module>
    class SendEmail(webapp.RequestHandler):
  File "/base/data/home/apps/s~alex-young/1.365202894602706277/email.py", line 14, in SendEmail
    if name is None: 
```

我在本地运行脚本没有任何错误，但是一旦我尝试在服务器上运行它，它就会一直坚持`name`我声明的变量不存在。知道为什么会这样吗？

另外，如果我注释掉那一行，它`email`会说不存在，依此类推

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T23:15:32.617

事实证明，有时我使用空格来缩进，而其他时候我使用制表符。Python 不喜欢这样。这是最终代码：

```
import cgi
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.api import mail

class SendEmail(webapp.RequestHandler):
    def post(self):
        name = self.request.get('name', '')
        email = self.request.get('email', '')
        tempSubject = self.request.get('subject', '')
        msg = self.request.get('message', '')

        if name is None:
            self.response.out.write("Error: You did not enter a name.")
        elif email is None:
            self.response.out.write("Error: You did not enter an email.")
        elif tempSubject is None:
            self.response.out.write("Error: You did not enter a subject.")
        elif msg is None:
            self.response.out.write("Error: You did not enter a message.")
        else:
            _subject = "Message from: " + name + ", Re: " + tempSubject
            msg += "\n\nI can be reached at "
            msg += email

            message = mail.EmailMessage(sender = "foo@bar.com", to = "bar@foo.com")
            message.subject = _subject
            message.body = msg
            message.send()

            self.redirect('/')

def runApp():
    application = webapp.WSGIApplication([('/email', SendEmail)], debug=True)
    run_wsgi_app(application)

if __name__ == '__main__':
    runApp() 
```

# git - 吉特帮助！远程和本地文件被删除

> ID：14796213
> 
> 赞同：1
> 
> 时间：2013-02-10T09:11:49.693
> 
> 标签：git

我正在研究 git，但`git fetch`在推送之前我忘记了。发生的事情是所有文件都被删除了，包括我的本地文件。在日志上说他们被剥夺了。我尝试还原，但没有任何反应。谁能帮我？

**编辑：**顺便说一句，我们的 git 主机是 bitbucket

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:27:07.510

如果您要推送到 git 托管站点（GitHub、BitBucket），则需要联系该站点以恢复那些被剥离的提交。
[正如我之前提到](https://stackoverflow.com/a/14770490/6309)的，无法从这些上游存储库访问引用日志。

例如，参见“ [bitbucket 剥离 git 修订版](https://stackoverflow.com/questions/9481346/bitbucket-stripped-git-revisions)”。

如果您可以访问上游存储库，那么 reflogs 可以帮助您，例如“[恢复丢失的提交](http://gitready.com/advanced/2009/01/17/restoring-lost-commits.html)”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:21:56.863

你可以使用

```
git reflog 
```

查看您的 git 分支指向的历史记录。如果您在执行此推送之前看到发生的事情，只需使用

```
git checkout <sha1> 
```

结帐到您之前的状态。

# floating-point - 将二进制浮点数转换为十六进制浮点数

> ID：14796216
> 
> 赞同：0
> 
> 时间：2013-02-10T09:11:57.873
> 
> 标签：floating-point, binary, hex, octal

例如我有`0 100 1110` `sign exponent mantisa`这个等于`3.75`。如何将其转换为十六进制或八进制形式？我已经努力搜索了几个小时。请帮忙。

你能帮我吗？这`100`是`4` `1110`不可能`7/8`的。`(7/8) * 2^4``3.75`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:18:06.810

标志应该很明显。

尾数的意思是，1 + 1/2*first bit + 1/4*second bit + 1/8*third bit...听起来很熟悉？它基本上是二进制计数，除了它是“小数点后”。

指数意味着，将尾数乘以 2^exponent。但是你如何得到`exponent`它所代表的价值呢？我做了一些谷歌搜索，显然如果设置了最高位，其余的是`0`（10、100、1000 ...等），那么你有`1`，如果它是`101`你有`2`，等等。意思是如果它是`011`你有`0`，`010`你有`-1`等等上。所以在这种情况下，我们有`1`指数。

因此，在这种情况下，您要计算 1.875 (mantisa) *2^1 (2^exponent) 并将其设为正数（符号）。

阅读更多：[http](http://en.wikipedia.org/wiki/Double-precision_floating-point_format) ://en.wikipedia.org/wiki/Double-precision_floating-point_format （它适用于双精度大小，但所有原则都应该“适用于”任何大小的浮点）

编辑：这是关于指数的更好解释。

首先，在 IEEE 浮点中，指数的最小值和最大值具有特殊含义 - 全零表示“这是零或次正规数”，全一表示“这是无穷大或 NaN”。因此，即使我们有 3 位指数 - `000`to `111`，仅`001`用于`110`表示普通指数 - 也只有 6 个值。

现在，使用所谓的“指数”偏差将这个 1...6 范围转换为负值和正值 - 特别是，您需要一个 -2...3 范围（最大正指数 > 最大值负指数，所以你不能通过做 1/ 来溢出`smallest normalized number`。但是， 1/`denormalized number`可以产生`Infinity`。）

我们通过取指数中的值来得到这个，如果不是特殊情况，我们从它的二进制值中减去 3 并将其作为它的指数值。

`0 100 1110`因此

`0`-> 正号

`100`-> 二进制值 4，减 3，指数 1

`1110`-> 1 + 7/8

(1+7/8)*2^1 = 3.75

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:22:45.607

只需转换位，就好像它是一个整数。忽略您正在处理浮点数的事实。

`01001110`转换为`4E`十六进制，因为`0100`is`4`和`1110`is `E`。（注意我是如何分成四组的。）

八进制也一样，它变成`116`，因为`01`is `1`，`001`is`1`和`110`is `6`。（注意我是如何分成三组的，除了第一组。）

# cuda - 更改 CUDA 中多个单元格的值

> ID：14796220
> 
> 赞同：0
> 
> 时间：2013-02-10T09:12:07.877
> 
> 标签：cuda, pycuda

它必须是一个简单的，虽然我找不到答案。我正在编写一个必须计算元胞自动机状态的程序，为了了解 CUDA 的工作原理，我首先尝试编写一个非常简单的程序。它需要一个矩阵，每个线程都必须在其单元格以及该单元格上方和下方的单元格中增加一个值。所以，如果我给它以下矩阵：

```
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0]
[0 0 0 0 0 0 0] 
```

我希望得到以下结果：

```
[2 2 2 2 2 2 2]
[3 3 3 3 3 3 3]
[3 3 3 3 3 3 3]
[3 3 3 3 3 3 3]
[3 3 3 3 3 3 3]
[3 3 3 3 3 3 3]
[2 2 2 2 2 2 2] 
```

第一行的值为 2，因为它上面没有可以将第一行的值再增加一次的行。并且以类似的方式，最后一行的值为 2。
但我得到的矩阵如下所示：

```
[2 2 2 2 2 2 2]
[3 3 3 3 3 3 3]
[3 3 3 3 3 3 3]
[3 3 3 3 2 2 2]
[2 2 2 2 2 2 2]
[2 2 2 2 3 3 3]
[2 2 2 2 2 2 2] 
```

而且我不明白为什么第 4 行、第 5 行和第 6 行的值为 2 - 必须是 3，而不是 2。
这是我的代码：

```
import numpy
import pycuda.autoinit
import pycuda.driver as cuda

from pycuda.compiler import SourceModule

w = 7

mod = SourceModule("""
        __global__ void diffusion(  int* result, int width, int height) {

            int xIndex = blockDim.x * blockIdx.x + threadIdx.x;
            int yIndex = blockDim.y * blockIdx.y + threadIdx.y;

            int flatIndex = xIndex + width * yIndex;
            int topIndex = xIndex + width * (yIndex - 1);
            int bottomIndex = xIndex + width * (yIndex + 1);

            int inc = 1;

            result[flatIndex] += inc;

            result[bottomIndex] += inc;

            result[topIndex] += inc;
        }

        """)

diff_func   = mod.get_function("diffusion")

def diffusion(res):

    height, width = numpy.int32(len(res)), numpy.int32(len(res[0]))

    diff_func(
        cuda.InOut(res),
        width,
        height,
        block=(w,w,1)
        )

def run(res, step):

    diffusion(res)
    print res

res   = numpy.array([[0 \
                        for _ in xrange(0, w)]\
                        for _ in xrange(0, w)], dtype='int32')

run(res, 0) 
```

一件更有趣的事情：如果我评论以下行之一：

```
result[bottomIndex] += inc;
result[topIndex] += inc; 
```

一切都按预期工作，没有任何意外的值。在某些情况下，CUDA 似乎无法在一个线程中处理三个相邻单元格的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:20:41.503

您有所谓的内存竞争：多个独立线程试图同时更新内存中的相同值。CUDA 内存模型没有定义当两个线程尝试同时更新同一个内存位置时会发生什么。

解决方案是使用原子内存操作（有关更多信息，请参阅 CUDA 编程指南），或者使用不同的方法来更新相邻单元格（例如，为网格着色并像在网格的不同通道上的彩色单元格一样更新）。

# android - 在不影响像素质量的情况下将可绘制的方形转换为可绘制的圆形

> ID：14796222
> 
> 赞同：0
> 
> 时间：2013-02-10T09:12:30.167
> 
> 标签：android, android-camera, android-canvas, android-drawable, android-capture

我有一个从相机拍照的应用程序。通常这些图片有矩形或方形。但由于这些图片是圆形的，我将形状限制为只有正方形。所以现在我的问题是将这张方形图片变成一个圆形，半径为宽度或高度的一半。剪下的部分应从图片中删除。

就像从正方形中画一个圆一样，它触及正方形所有面的中点。我对画布或其他内置绘图功能没有任何经验。

![在此处输入图像描述](../Images/90965c271babb2aeaaa16e5849c214f5.png)

例如，我一开始有正方形，现在我想让图像变成圆形，这样箭头所指的部分应该从图像中剪掉。

注意：因为我必须使用相机图像。质量是关键因素。所以请提出不会影响像素质量和其他重要因素的可能方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:20:49.320

您可以通过使用您想要的形状遮盖图像来做到这一点，有关详细信息，请参阅[此帖子](https://plus.google.com/113818537733281601685/posts/dUsQbRPohs6)。示例代码：

```
Resources resources = context.getResources();
Bitmap original = BitmapFactory.decodeResource(resources,R.drawable.original);
Bitmap mask = BitmapFactory.decodeResource(resources,R.drawable.mask);
Bitmap result = Bitmap.createBitmap(mask.getWidth(), mask.getHeight(), Config.ARGB_8888);
Canvas c = new Canvas(result);
Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);
paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_IN));
c.drawBitmap(original, 0, 0, null);
c.drawBitmap(mask, 0, 0, paint);
paint.setXfermode(null);
imageView.setImageBitmap(result); 
```

# iis-7.5 - 如果启用静态压缩，则 IIS 中的 gzip js 不会被压缩

> ID：14796225
> 
> 赞同：5
> 
> 时间：2013-02-10T09:12:43.007
> 
> 标签：iis-7.5, gzip, squishit

我使用 Squishit 来缩小和捆绑 JS 并压缩捆绑文件我在 IIS 7.5 中启用了选项（启用静态内容压缩）

问题是 Js 没有被压缩，我只是得到了缩小的 js，但是如果我启用动态内容压缩，那么 Js 会被压缩。

现在动态压缩的问题是它不缓存文件，并且在每个请求上都必须进行占用 CPU 时间的压缩。

有人可以帮我弄清楚为什么js在静态内容压缩模式下没有被压缩

这是在客户端发送js的理想方式吗

```
JS -> Minify JS (Squishit) -> Compress (Static /Dynamic) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-23T09:08:24.837

静态文件的压缩是动态处理的，而 IIS 认为该文件*不常见*。一旦文件被认为是*频繁*的，它将被压缩和缓存。缓存的版本将继续提供，直到它再次变得不常见。您可以在 IIS 中使用 2 个配置设置来配置常用文件：

**system.webServer/serverRuntime:**

*   `frequentHitThreshold`: 同一个文件应该被请求多少次，才会被认为是频繁和缓存？默认为 2。
*   `frequentHitTimePeriod`: 同一文件应该被请求 {frequentHitThreshold} 次的时间间隔，以便被缓存。默认为 10 秒。

请注意，无论您设置的频繁HitTimePeriod 是多少，如果在 1 分钟后没有请求频繁文件，它总是会变得不频繁。我不知道配置中是否有此设置。

例如，设置`frequentHitThreshold`为 1 将意味着 IIS 始终认为该文件是频繁的，即使从第一个请求开始也是如此。这将反过来绕过动态压缩并仅通过静态压缩处理。

`staticCompressionIgnoreHitFrequency`或者，您可以通过设置为 true 来完全绕过命中频率：

`appcmd set config -section:system.webServer/httpCompression /staticCompressionIgnoreHitFrequency:"True"`

请注意，动态（默认 0）和静态（默认 7）压缩的压缩级别不同，因此将返回 2 个不同的文件大小。

这也是我首先遇到这个问题的原因：即使您对两者使用相同的级别，动态和静态压缩之间的同一文件的 ETag 也是不同的。

希望这可以帮助。

# sql - oracle join 查询示例

> ID：14796230
> 
> 赞同：0
> 
> 时间：2013-02-10T09:13:34.760
> 
> 标签：sql, oracle, join, sample

我是 Oracle 新手，正在学习联接。在我目前使用的 pdf 中，每种连接类型只有一个示例。我还在互联网上搜索了几个例子，但我只能找到 1-2 个例子的解释。

我正在寻找一个学习指南或网站，它为我提供了一组 40-50 个示例和答案，以便我可以验证我的答案。

有人可以给我推荐一个很好的网站，我可以在其中练习或下载包含查询和答案的 pdf。

提前致谢

-瓦伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:17:38.890

这是我最喜欢的关于 SQL 连接的文章之一：[A Visual Explanation of SQL Joins](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

# ios - 推送通知可以跳过通知中心吗？

> ID：14796232
> 
> 赞同：0
> 
> 时间：2013-02-10T09:13:48.197
> 
> 标签：ios, objective-c, cocoa-touch, cocoa, apple-push-notifications

是否可以在不进入通知中心的情况下向我的用户发送推送通知？我想显示一个在确认或取消后会消失的弹出窗口。我知道这在 ios 4 中是可能的，并被通知中心取代，但我必须要求确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:17:41.293

作为开发人员，您没有**办法。**这可以在每个应用程序的设置中进行*设置：*

![在此处输入图像描述](../Images/921dd625a7328d1e72fffdbe779d30f3.png)

# .net - 如何将视图添加到我的主窗口

> ID：14796233
> 
> 赞同：0
> 
> 时间：2013-02-10T09:13:48.137
> 
> 标签：.net, xaml, mvvm, binding

我正在尝试在我的 MainWindow 中显示一个视图。

过去，我将 View（UserControl 类型）传递到 MainWindow 上的 TabControl 中，并将其转换为 TabItem，这样效果很好。

在我的新应用程序中，我没有使用 TabControl，遗憾的是，这是我知道如何将视图插入主窗口的唯一方法。我假设我现在可以使用 ContentControl 来显示我的视图。

我的问题是，我不知道如何将我的 View 绑定到我的`ContentControl`.

到目前为止，我的 XAML 非常简单，看起来像

> ```
> <Window x:Class="BackUps.Logging.MainWindow"
>     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
>     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
>     xmlns:viewModels="clr-namespace:BackUps.Logging"
>     Title="Logging Results" Height="350" Width="700">
> 
> <Grid>
>     <Grid.Resources> 
>           <ContentControl 
>                    Content="{x:Type nameOfViewModel}"
>           />
> 
>     </Grid.Resources>
> </Grid> </Window> 
> ```

以上不起作用，似乎我的方法是错误的，因为我在技术上对其进行了硬编码，只允许显示 1 个视图。但是，就我的理解而言，这很好！

所以，我的两个问题是：

1）我的视图必须是什么类型（窗口、页面或用户控件，或者它可以与这些中的任何一个一起使用 3）2）我如何设置 ContentControl 以绑定到我的视图？

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:57:18.740

你的 View 应该是 type `UserControl`。

在 XAML 中，您可以使用以下代码：

```
<Window x:Class="ContentBinding.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        xmlns:views="clr-namespace:ContentBinding"
        >
    <Window.Resources>
        <views:MyView x:Key="myView" />
    </Window.Resources>
    <Grid>
        <ContentControl Content="{StaticResource myView}" />
    </Grid>
</Window> 
```

# c# - 连接到 Google Analytics Reporting API

> ID：14796234
> 
> 赞同：3
> 
> 时间：2013-02-10T09:13:51.710
> 
> 标签：c#, google-api, google-analytics-api

我正在尝试连接到 Google Analytics 报告 API 以获取基本的综合浏览量统计信息。我正在尝试遵循本教程（[http://www.arboundy.com/2012/04/getting-started-with-google-analytics-in-c/](http://www.arboundy.com/2012/04/getting-started-with-google-analytics-in-c/)）。我无法设置正确的位来获得成功的身份验证，因为谷歌最近似乎对 API 进行了很多更改，因此原始配置似乎不起作用。

这是我目前拥有的：

```
 Service = new AnalyticsService("MyDemoApp");
        Service.setUserCredentials("user@gmail.com", "password");

        AccountQuery AccountsQuery = new AccountQuery("https://www.googleapis.com/analytics/v3/data/ga"/*Not sure what goes here this gives a 400*/);
        AccountFeed AccountsFeed = Service.Query(AccountsQuery); // 400 error here 
```

任何想法如何通过 V3 api 连接到这个（这似乎是我从 NuGet 得到的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T03:28:32.980

这必须在 c# 中为你工作。（我已经尝试过并且工作过）

```
 string username = "youremailuser@domain.com";
    string pass = "yourpassword";
    string gkey = "?key=YourAPIkEY";

    string dataFeedUrl = "https://www.google.com/analytics/feeds/data" + gkey;
    string accountFeedUrl = "https://www.googleapis.com/analytics/v2.4/management/accounts" + gkey;

    AnalyticsService service = new AnalyticsService("WebApp");
    service.setUserCredentials(username, pass);

    DataQuery query1 = new DataQuery(dataFeedUrl);

    query1.Ids = "ga:12345678";
    query1.Metrics = "ga:visits";
    query1.Sort = "ga:visits";

    query1.GAStartDate = new DateTime(2012, 1, 2).ToString("yyyy-MM-dd"); 
    query1.GAEndDate = DateTime.Now.ToString("yyyy-MM-dd");
    query1.StartIndex = 1;        

    DataFeed dataFeedVisits = service.Query(query1);

    foreach (DataEntry entry in dataFeedVisits.Entries)
    {
        string st = entry.Title.Text;
        string ss = entry.Metrics[0].Value;
        visits = ss;
    } 
```

了解更多详情[从 Google 数据 API 读取数据](http://tilr.blogspot.com/2013/02/read-data-from-google-data-api-when-you.html)

# html - 调整代码以在一行上显示表格

> ID：14796240
> 
> 赞同：0
> 
> 时间：2013-02-10T09:15:38.697
> 
> 标签：html

我需要调整我需要复制到我的 .php 页面中的代码，以便文本全部显示在一行上。现在，“订阅”提交按钮位于“输入电子邮件地址...”字段的另一行。`

```
 <!--Begin MailChimp Signup Form -->
    <div id="mc_embed_signup" style="display:none">
    <form action="http://tradingliberation.us6.list-manage2.com/subscribe/post?u=391b0d0328b13e63321867c4b&amp;id=9fce6d2cd6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <label for="mce-EMAIL">Stay Connected & Take One Step Closer Towards Liberation</label>
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="enter email address..." required><div class="clear">
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </form>
    </div>
    <!--End mc_embed_signup--> 
```

这是我页面的链接，以防您需要查看我在说什么。[它是博客](http://tradingliberation.com)页面顶部的欢迎栏

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:19:25.057

试试这个 ：

```
 <!--Begin MailChimp Signup Form -->
    <div id="mc_embed_signup" style="display:none">
    <form action="http://tradingliberation.us6.list-manage2.com/subscribe/post?u=391b0d0328b13e63321867c4b&amp;id=9fce6d2cd6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <label for="mce-EMAIL">Stay Connected & Take One Step Closer Towards Liberation</label>
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="enter email address..." required>
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
    </form>
    </div>
    <!--End mc_embed_signup--> 
```

# ios - 在不拉伸内部的情况下调整图像大小

> ID：14796243
> 
> 赞同：2
> 
> 时间：2013-02-10T09:15:58.527
> 
> 标签：ios

我经常使用 UIimage 的 resizeableImageWithCapInsets 方法。然而，我现在想做相反的事情，即调整被盖子覆盖的区域的大小，让未加盖的区域保持不变。这可能吗？

# android - TCP打孔，不能在android上重用地址

> ID：14796264
> 
> 赞同：0
> 
> 时间：2013-02-10T09:18:28.427
> 
> 标签：android, tcp, hole-punching

我有一个托管 HTTP 服务器的 android 设备并且是 NATed（在路由器后面）。我想从未经过 NAT 的公共服务器访问它。我在一个线程中的 8080 端口在 android 设备上运行一个 HTTP 服务器，一段时间后，我启动一个客户端线程，它试图从 android 上的本地端口号 8080 连接到远程公共服务器。由于某种原因，我在端口 8080 上启动服务器后，android 客户端将无法连接。它也不会产生任何异常。这是我的代码：

```
Thread server = new Thread(new Runnable() {
public void run() {
    super.run();

    try {
        ServerSocket serverSocket = new ServerSocket();
        serverSocket.setReuseAddress(true);
        serverSocket.bind(new InetSocketAddress("192.168.1.102", 8080));

        while(isRunning){
            try {
                System.out.println("Listening for new connection");
                Socket socket = serverSocket.accept();
                System.out.println("incoming connection accepted");
                new Thread(new ConnectionHandler(socket)).start();    
            } catch (IOException e) {
                e.printStackTrace();
            }                             
        }
        serverSocket.close();
    } 
    catch (IOException e) {
        e.printStackTrace();
    }
}
});
server.start();

// sleep several seconds before launch of client
Thread.currentThread().sleep(5 * 1000);

Thread client = new Thread(new Runnable() {
public void run() {
    super.run();
    try {
        /* .. */
        Inet4Address localaddr = (Inet4Address) InetAddress
                .getByName("192.168.1.102");
        // Inet4Address remoteaddr = (Inet4Address)
        // InetAddress.getByName("122.176.73.10");
        System.out.println("connecting to 122.176.73.10");

        Socket socket = new Socket();

        socket.setReuseAddress(true);
        System.out.println("[Client]socket.isBound():" + socket.isBound());
        socket.bind(new InetSocketAddress("192.168.1.102", 8080));

        for (int i = 1; i < 5; i++) {
            try {
                socket.connect(new InetSocketAddress("122.176.73.10", 4040));
                System.out.println("connected to 122.176.73.10");
                break;
            } catch (Exception e) {
                System.out.println("[Client]fail to connect ");
                Thread.currentThread().sleep(i * 2 * 1000);
            }
        }
    }
}
});
client.start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:29:15.863

端口号不能同时用于侦听传入连接和建立传出连接。您的侦听套接字`8080`可防止使用该端口的任何其他内容。

# asp.net - Ajax 返回多个值

> ID：14796266
> 
> 赞同：0
> 
> 时间：2013-02-10T09:18:48.893
> 
> 标签：asp.net, ajax, webmethod

我正在尝试返回多个值，如下所示，但一个值仅在成功时返回。

这就是我想要做的：

```
<script type="text/javascript">
        $(document).ready(function () {
                $("#getdetails").click(function () {
                $.ajax({
                    type: "POST",
                    url: "Default.aspx/Gettext",
                    data: JSON.stringify({ SampleText: $('#sampletext').val(), FontType: $('#fonttype').val()}),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        $("#Result").text(msg.d);
                    }
                });

        $("#FontLists").change(function () {
            $('#fonttype').val($('#FontLists option:selected').text());
        });
    });
</Script> 
```

HTML：

```
Enter Text :<input id="sampletext" type="text" />
<select id="FontLists">
    <option value="Aharoni">Aharoni</option>
    <option value="Algerian">Algerian</option>
    <option value="Andalus">Andalus</option>
</select>
<input id="fonttype" type="hidden" /> 
```

代码隐藏：

```
<WebMethod()> _
<ScriptMethod(ResponseFormat:=ResponseFormat.Json)>
Public Shared Function Gettext(ByVal SampleText As String, ByVal FontType As String) As String
    Return SampleText
    Return FontType
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:20:31.910

您可以设计一个具有 2 个属性的类，然后让您的 WebMethod 返回此类的一个实例（对不起，如果我打错了，我的 VB.NET 技能已经生疏了）。

```
Public Class MyModel
    Public Property SampleText as String
    Public Property FontType as FontType
End Class 
```

然后调整您的方法以返回此模型：

```
<WebMethod()> _
<ScriptMethod(ResponseFormat:=ResponseFormat.Json)>
Public Shared Function Gettext(ByVal SampleText As String, ByVal FontType As String) As MyModel
    Dim model = New MyModel()
    model.SampleText = SampleText
    model.FontType = FontType
    Return model
End Function 
```

在客户端上，您可以使用它们的名称访问 2 个属性：

```
success: function (msg) {
    alert(msg.d.SampleText);
    alert(msg.d.FontType);
} 
```

# javascript - TinyMCE - 插入组合框和带有格式的选定值

> ID：14796269
> 
> 赞同：2
> 
> 时间：2013-02-10T09:19:14.703
> 
> 标签：javascript, formatting, tinymce

我正在尝试找出 TinyMCE。我看过这些例子，但似乎这些例子使用不同的方式来完成任务。而且我很难把它放在一起来得到我需要的东西。

基本上，我需要两个带有一组值的组合框。第三个按钮用于插入两个第一个组合框中的选定值。如果可能的话，我想用一个特定的 CSS 类来插入这些格式（我认为是）。

这是我到目前为止的代码。我真的很感激这方面的一些帮助！

```
// Creates a new plugin class and a custom listbox
tinymce.create('tinymce.plugins.ExamplePlugin', {
    createControl: function(n, cm) {
        switch (n) {
            case 'comboboxChordsPrimary':
                var mlb = cm.createListBox('comboboxChordsPrimary', {
                     title : 'Akkorder',
                     onselect : function(v) {
                         tinyMCE.activeEditor.windowManager.alert('Value selected:' + v);
                     }
                });

                // Add some values to the list box
                mlb.add('C', 'C');
                mlb.add('C#-Db', 'C#-Db');
                mlb.add('D', 'D');
                mlb.add('D# -Eb', 'D# -Eb');
                mlb.add('E', 'E');
                mlb.add('F', 'F');
                mlb.add('F# -Gb', 'F# -Gb');
                mlb.add('G# -Ab', 'G# -Ab');
                mlb.add('A', 'A');
                mlb.add('A# -Bb', 'A# -Bb');
                mlb.add('B', 'B');

                // Return the new listbox instance
                return mlb;

        case 'comboboxChordsSecondary':
                var mlb2 = cm.createListBox('comboboxChordsSecondary', {
                     title : 'Akkorder',
                     onselect : function(v) {
                         tinyMCE.activeEditor.windowManager.alert('Value selected:' + v);
                     }
                });

                // Add some values to the list box
                mlb2.add(' ', ' ');
                mlb2.add('m', 'm');
                mlb2.add('dim', 'dim');
                mlb2.add('aug', 'aug');
                mlb2.add('7', '7');
                mlb2.add('m7', 'm7');
                mlb2.add('maj7', 'maj7');

                // Return the new listbox instance
                return mlb2;

        case 'btnAddChord':
                var mlb3 = cm.createButton('btnAddChord', {
                     title : 'Add',
                     onselect : function(v) {
            cm.focus();
            cm.selection.setContent(comboboxChordsPrimary.value + comboboxChordsSecondary.value);
                     }
                });

                // Return the new listbox instance
                return mlb3;

        }   

        return null;
    }
});

// Register plugin with a short name
tinymce.PluginManager.add('example', tinymce.plugins.ExamplePlugin);

// Initialize TinyMCE with the new plugin and listbox
tinyMCE.init({
    plugins : '-example', // - tells TinyMCE to skip the loading of the plugin
    mode : "textareas",
    theme : "advanced",
    theme_advanced_buttons1 : "comboboxChordsPrimary,comboboxChordsSecondary,btnAddChord,bold,italic,underline,separator,strikethrough,justifyleft,justifycenter,justifyright,justifyfull,bullist,numlist,undo,redo,link,unlink",
    theme_advanced_buttons2 : "",
    theme_advanced_buttons3 : "",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom"    
}); 
```

我什至不确定我是否以正确的方式完成了这项任务。我以前在 VB.NET 中已经做到了这一点，但 Javascript 真的让我感到困惑。这是因为那些该死的括号：p

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T12:14:27.693

您将需要添加一个 tinymce 按钮，该按钮将读取选定的值。这是一个工作的tinymce小提琴，它应该指向正确的方向： http: [//fiddle.tinymce.com/gJcaab](http://fiddle.tinymce.com/gJcaab)

如果您遇到任何问题 - 请告诉我。

# javascript - Crossrider setPopup() 小宽度

> ID：14796278
> 
> 赞同：0
> 
> 时间：2013-02-10T09:20:45.553
> 
> 标签：javascript, firefox-addon, crossrider

我的 Crossrider 插件使用 setPopup() 函数在单击 browserAction 图标时弹出一个窗口。

问题是当我单击图标时，弹出窗口又长又薄且无法使用。

**这是它的外观截图......**

![又高又瘦的弹出窗口... :(](../Images/a1f22ae4a20f8feb23ed3914ed684351.png)

**我的 background.js 代码：**

```
appAPI.ready(function() {
    appAPI.browserAction.setResourceIcon('icons/logo38.gif');
    appAPI.browserAction.setTitle('Click here for iStyla preferences');
    appAPI.browserAction.setPopup({resourcePath:'popup.html'});
}); 
```

我的**popup.html**有一个有限的最小宽度，所以我不知道为什么弹出窗口的宽度这么小。我正在使用 Firefox 18.0.2。

请帮助我使弹出窗口更宽...谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:53:44.117

**您可以从popup.html**文件中控制弹出窗口的宽度和高度。只需使用所需的*高度*和*宽度*属性设置**body**标签的样式。例如：

 **```
<body style="height:200px; width:300px;">
...
</body> 
```

有关详细信息，请参阅[setPopup](http://docs.crossrider.com/#!/api/appAPI.browserAction-method-setPopup)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T10:48:28.743

也可以通过api控制popup的宽高

```
appAPI.browserAction.setPopup({
    resourcePath:'html/popup.html',
    height: 300,
    width: 300 
```

});**

# java - 用于创建图标的junit方法

> ID：14796286
> 
> 赞同：-1
> 
> 时间：2013-02-10T09:21:53.577
> 
> 标签：java, junit

我有一个方法

图标 getMoleculeIcon(分子 mol)

我想测试。这样做的正确方法是什么？我正在考虑检查返回是 Icon.class 还是比较 hashCodes 的东西。后者对我来说似乎更好，但我真的不确定。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:16:37.497

如果您传递需要存储在一个文件或类中的 Icon 对应对象的分子 mol，您的结果必须是确定的。

图标是javax.swing 界面图标吗？

如果是这样，您必须确定返回的类型是否可以是 ImageIcon。

当你有一个 ImageIcon 你可以 getImage();

当您拥有 Image 对象时，您可以使用 PixelGrabber 类来使用它

[http://www.java-tips.org/java-se-tips/java.awt.image/how-to-use-pixelgrabber-class-to-acquire-pixel-data-from-an-image-o。 html](http://www.java-tips.org/java-se-tips/java.awt.image/how-to-use-pixelgrabber-class-to-acquire-pixel-data-from-an-image-o.html)

* * *

另一个有趣的转换是使用 BufferedImage [http://www.java.net/node/646586](http://www.java.net/node/646586)

* * *

现在，当您了解在 Java 中有太多的类可以使用图像时，并且您拥有两个图像的像素数组（由您的代码传递确定的参数生成，以及存储在您的类中或由文件加载的图像）传递特定参数的确定性结果）。

您已准备好比较图像。逐个像素或使用大脑密集型方法。

* * *

另一种解决方案是使用 Icon 界面创建对象并定义您的比较方法

[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html)

* * *

还有其他有趣的建议：

[使用 Java 的图像比较技术](https://stackoverflow.com/questions/4328187/image-comparison-techniques-with-java)

[https://stackoverflow.com/questions/6971966/how-to-measure-percentage-similarity-between-two-images](https://stackoverflow.com/questions/6971966/how-to-measure-percentage-similarity-between-two-images)

有人做了一些很棒的库

[http://mindmeat.blogspot.it/2008/07/java-image-comparison.html](http://mindmeat.blogspot.it/2008/07/java-image-comparison.html)

* * *

这是一项真正复杂的检查，但对某些产品来说确实很重要。我不知道您的情况是否如此，以及您是否有足够的时间来完成这项任务。

我希望有用。

# iphone - UIScrollview在垂直和水平ios中滚动

> ID：14796292
> 
> 赞同：1
> 
> 时间：2013-02-10T09:23:08.623
> 
> 标签：iphone, ios, uiscrollview, uiimageview

我相信这个问题听起来很普遍。我试图实现双向滚动（垂直和水平），但一次滚动一个（不应该是对角线）。我正在下载图像并将其放置在具有 3 个图像视图的滚动视图上（以循环方式使用它们）。但我不确定如何进行图像的垂直滚动，因为我可以水平滚动。我目前在水平滚动上进行分页。例如：

```
1.0   2.0   3.0    4.0
      2.1   3.1
      2.2
      2.3 
```

我能够通过水平延迟加载实现无限滚动。如何显示 1.1、1.2 或 2.1、2.2 等图像？实现水平垂直滚动的最佳方法是什么？

```
 1.0   2.0   3.0    4.0 
```

非常感谢，

雷诺琼斯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:29:28.900

您可以禁用对角滚动

```
scrollView.directionalLockEnabled = YES; 
```

仍然不清楚你的问题是什么......如果你可以水平滚动，你应该能够让它垂直工作。

# android - 有没有办法以另一种方式在列表视图（Android）上显示项目？

> ID：14796293
> 
> 赞同：0
> 
> 时间：2013-02-10T09:23:19.403
> 
> 标签：android, android-listview

假设我有一些数据并且它们一个一个地加载，有没有办法让适配器添加到列表视图的每个项目都来自屏幕底部，然后转到它们的原始位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:32:43.250

只需使用：

```
list.setStackFromBottom(true); 
```

它将使所有项目从列表底部添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:22:53.293

您只想更改订单吗？然后，您应该更改适配器中的 getView() 方法，以在数据中使用镜像位置。

所以，你应该像这样使用

```
Type object = data.get(data.size() - position); 
```

# python - Google App Engine 中的 get_serving_url 在生产中失败 Caught InvalidBlobKeyError while rendering

> ID：14796294
> 
> 赞同：1
> 
> 时间：2013-02-10T09:23:21.043
> 
> 标签：python, django, google-app-engine, blobstore

并感谢您花时间阅读我的问题。

我已经成功实现了表单中的用户上传。我也成功地在我的开发服务器上显示上传的文件（图像）。

但是，我无法让它们在生产中显示。

我目前正在对图像使用以下过滤器：

```
@register.simple_tag
def media_file_url(file_obj):
    file_location = file_obj.name.split('/')[0]
    #gives just the key
    return get_serving_url(str(file_location)) 
```

并在模板中：

```
 <img class='visual' src='{% media_file_url promotion.image %}' 
    alt='image description' width='70' height='88' /> 
```

我已经尝试了上述方法，但没有拆分 file_location。

我在views.py中尝试了一个自定义url处理程序，如下所示：

```
def images(request, resource):
    clean_key = urllib2.unquote(resource)
    return HttpResponseRedirect(get_serving_url(clean_key)) 
```

以上所有在开发中工作，但不是生产。

有没有人有什么建议？

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:47:10.233

blob 信息存储在模型的文件信息中。

我能够在我的过滤器中获取服务网址，如下所示：

```
from google.appengine.api import images

...

@register.simple_tag
def media_file_url(file_obj):
    try:
        return images.get_serving_url(file_obj.file.blobstore_info)
    except:
        return None 
```

# javascript - 如何排除某些文件在 Typescript 中编译？

> ID：14796295
> 
> 赞同：3
> 
> 时间：2013-02-10T09:23:21.120
> 
> 标签：javascript, visual-studio-2012, typescript

我在我的 TypeScript 项目中使用了不同的 JS 库。我希望 TypeScript 按原样处理这些文件，而不进行错误检查。

如何从编译中排除某些文件，这样我就不会看到它们的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T00:17:37.490

我正在将一个约 100,000 行的项目迁移到 TypeScript，作为迁移的一部分，我只想将所有 .js 文件重命名为 .ts，引入一个构建步骤，然后提交结果。这样我就可以在主开发分支中逐渐添加类型信息，同时在同一个文件中继续常规开发。这个想法是为了减少合并冲突，而且效果非常好（在我看来，像这样的步骤中迁移的能力是 TS 的优势之一）。

我最终向编译器添加了一个 --ignoretypeerrors 标志：

[https://github.com/turbulenz/typescript](https://github.com/turbulenz/typescript)

它不会打印类型错误，并使编译器以 0 退出。不过，它仍然会捕获语法错误。那里还有一个 --failonerror 标志，如果类型检查失败（这可能会混淆某些构建系统），它会阻止编译器输出 .js 文件。

我没有使用 Visual Studio 插件，所以这可能无法直接帮助您，但有些人可能会觉得它很有价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:49:12.173

如果您使用的是 Visual Studio，则可以更改要排除的打字稿文件的构建操作。右键单击文件，然后转到属性，然后更改`Build Action`为无。

# c# - 序列化列表 使用带有 protobuf-net 异常的代理

> ID：14796296
> 
> 赞同：6
> 
> 时间：2013-02-10T09:23:22.210
> 
> 标签：c#, null, deserialization, protocol-buffers, protobuf-net

我正在使用 protobuf-net（版本 2.0.0.621）并且在序列化 List 类型时遇到问题，其中 T 是我自己的类（它包含什么并不重要）并且为 T 设置了一个代理项。

代理设置如下：

```
ProtoBuf.Meta.RuntimeTypeModel.Default.Add(typeof(MyClass), false).SetSurrogate(typeof(MyClassSurrogate)); 
```

我的课：

```
public class MyClass
{
    public int Number { get; set; }
}

[ProtoContract]
MyClassSurrogate
{
    [ProtoMember(1)]
    public int Number { get; set; }
} 
```

然后我创建一个 MyClass 实例类型的通用列表，用项目填充它并像这样序列化它：

```
ProtoBuf.Serializer.Serialize(stream, list); 
```

问题发生在反序列化上，我在隐式运算符转换中的代理项中不断得到“null”：

```
static public implicit operator MyClassSurrogate(MyClass myClass) 
```

那么“myClass”为空。

如果我删除代理并使用 proto 属性装饰 MyClass ，一切正常。

你能告诉我我做错了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T09:59:58.547

向隐式运算符转换添加空检查似乎可以解决问题，即：

```
public static implicit operator MyClassSurrogate(MyClass myClass)
{
    return myClass != null ? new MyClassSurrogate { Number = myClass.Number } : null;
} 
```

隐式运算符最初在反序列化时使用空值调用一次，结果似乎被忽略。

MyClassSurrogate 的完整实现：

```
[ProtoContract]
public class MyClassSurrogate
{
    [ProtoMember(1)]
    public int Number { get; set; }

    public static implicit operator MyClassSurrogate(MyClass myClass)
    {
        return 
            myClass != null 
            ? new MyClassSurrogate { Number = myClass.Number } 
            : null;
    }

    public static implicit operator MyClass(MyClassSurrogate myClass)
    {
        return new MyClass { Number = myClass.Number };
    }
} 
```

全序列化/反序列化示例：

```
var model = ProtoBuf.Meta.RuntimeTypeModel.Default;
model.Add(typeof(MyClassSurrogate), true);
model.Add(typeof(MyClass), false).SetSurrogate(typeof(MyClassSurrogate));
var stream = new System.IO.MemoryStream();
var list = new List<MyClass>();
for (int x = 0; x < 10; x++) list.Add(new MyClass { Number = x });            
ProtoBuf.Serializer.Serialize(stream, list);
stream.Seek(0, SeekOrigin.Begin);
var xs = ProtoBuf.Serializer.Deserialize<List<MyClass>>(stream);
foreach (var x in xs) Debug.WriteLine(x.Number); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:01:35.587

值 null 经常使用，包括在反序列化期间。您应该能够通过告诉转换运算符将 null 转换为 null 来解决此问题：

```
if(value == null) return null; 
```

考虑一下，我可能可以安全地添加“如果两者都是引用类型，则自动将 null 转换为 null”。

# android - 在带有边框的android中创建非传统形状工具提示

> ID：14796298
> 
> 赞同：0
> 
> 时间：2013-02-10T09:23:39.787
> 
> 标签：android, xml, styles, shapes

你好安卓设计师，

我现在正在努力创建看起来像这张图片上的 xml 工具提示：

![预览](../Images/3836cbf80c9242b742fcfda3e3c6a44e.png)

不幸的是，这似乎是一个地狱般的工作。到目前为止，我只能创建一个像这样的简单圆角矩形：

![预览 2](../Images/5f97a74556073225feec23752c848b79.png)

实际上是否可以使用 xml 样式创建我在第一张照片上呈现的这种形状，或者我应该尝试以编程方式创建它（这可能需要大量时间并且创建边框会非常困难）？或者也许最简单的解决方案是最好的，我应该使用部分透明的 png 图像和我选择的形状？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:31:14.057

您可以使用[可拉伸的 9-patch](http://developer.android.com/tools/help/draw9patch.html)可绘制对象来绘制它。

您可以在那里指定哪些部分是固定的（左侧和角落的小旋钮），哪些是可拉伸的（所有其他部分）

# google-maps - 有没有办法提高 Google Maps KmlLayer 中图标图像的质量？

> ID：14796300
> 
> 赞同：2
> 
> 时间：2013-02-10T09:23:44.413
> 
> 标签：google-maps, google-maps-markers, kml

我正在尝试实现`google.maps.KmlLayer`在服务器端呈现数百个标记，而不是`google.maps.Marker`为每个数据点创建，这会降低浏览器的速度。但是，谷歌服务器渲染的图块质量似乎有点低，您可以 [在我的测试页上查看比较](http://www.bussup.com/testkmllayer.html)

（有阴影的是用 Marker 类创建的，而没有阴影的是来自 KML 层。两者都是从相同的 .png 图像生成的）

这似乎是位深度或其他东西的问题，因为`<scale>`KML 中的标签已经设置为 1 。那么，有没有办法提高 KmlLayer 的图像质量，或者如果我认为低质量的图标图像不可接受，我应该求助于其他方法吗？

提前致谢。

# excel - 如何将邮件项目导出到 Excel 文件

> ID：14796304
> 
> 赞同：1
> 
> 时间：2013-02-10T09:24:14.560
> 
> 标签：excel, email, export

我需要您的帮助才能将电子邮件正文导出到 Excel 文件。

Excel 文件应包含以下字段：

1.  序号\N。
2.  RMA 编号
3.  到达 RMA 站点 1 级的日期
4.  从 RMA 第一级到第二级的转发日期
5.  RMA 发现 1 级
6.  当前状态
7.  当前分配团队

以上所有数据都位于电子邮件正文中。

这是电子邮件正文的示例：

```
 [ https://jira.sandisk.com/browse/CSSFIRSTLEVELFA-571?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Tony Wang updated CSSFIRSTLEVELFA-571:
--------------------------------------

    Summary:  RMA#60022453 --> **RMA Number**(QSS RMA#CD1S0064) GS2 unit Failed:Quanta F5-APPLE-20130125(1pcs, without FA log files)  (was:  RMA#xxxxxx (QSS RMA#xxxxxx) GS2 unit Failed:Quanta F5-APPLE-20130125(1pcs, without FA log files))

Goods arrived at QSS/RMA site on: Feb 5th, 2013 -->**Arrived Date to RMA site 1st level**

1st Level FA findings: 
AI result: Pass --> **RMA Finding 1st level**
X-Ray result: Pass 

SKU# SD5SG2-256G-1052E
S/N:124310409056 --> **Serial Number**

QSMC/F5 - Apple feedback NG information:HDFU1 --> **Status** Units moved to SanDisk 2nd level FA Lab (Feb 6th, 2013) --> **Forward Date from RMA 1st level to 2nd level**

All the below information is unnecessarily..

>  RMA#60022453(QSS RMA#CD1S0064) GS2 unit Failed:Quanta 
> F5-APPLE-20130125(1pcs, without FA log files)
> ----------------------------------------------------------------------
> ------------------------------
>
>                 Key: CSSFIRSTLEVELFA-571
>                 URL: https://jira.sandisk.com/browse/CSSFIRSTLEVELFA-571
>             Project: CSS - OSS and 1st level FA
>          Issue Type: RMA-FA
>         Environment: MATIS
>            Reporter: Ming Li
>            Assignee: Ming Li
>
> S/N#124310409056 history step: 
> 1\. OSS request date:1/24
> 2\. OSS visit date:1/25\. (124310409056) error code:7080; apply for RMA. 
> SKU#SD5SL2-256G-1205E

--
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators: https://jira.sandisk.com/secure/Administrators.jspa
-
For more information on JIRA, see: http://www.atlassian.com/software/jira 
```

# sql - 在两列上分组和最大值

> ID：14796306
> 
> 赞同：0
> 
> 时间：2013-02-10T09:25:34.983
> 
> 标签：sql, max

我有一个包含这些列的表：

```
id | series_id | season_id | episode_id |  title | type ... 
```

我想获得具有唯一`series_id`位置`season_id`和`episode_id`最大值的行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:28:08.263

一种解决方案是这样做：

```
SELECT t1.*
FROM YourTable AS t1
INNER JOIN 
(
   SELECT 
     series_id, 
     MAX(season_id)  AS MAxSeasonId, 
     MAX(Episode_id) AS MAXEpisodeID
   FROM yourTable 
   GROUP BY series_id
) AS t2  ON t1.series_id  = t2.series_id
        AND t1.season_id  = t2.MaxSeasonId
        AND t1.episode_id = t2.MaxEpisode_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T19:47:19.710

我认为这可能有点矫枉过正，但这是我发现对我有用的唯一方法。

```
DECLARE @SeriesInfo TABLE
(
    id          INT,
    series_id   INT,
    season_id   INT,
    episode_id  INT,
    title       VARCHAR(50),
    type        CHAR(1)
);
INSERT INTO @SeriesInfo VALUES ( 1, 1, 1, 1, 'Series 1 Season 1 Episode 1', 'A'),
                               ( 2, 1, 1, 2, 'Series 1 Season 1 Episode 2', 'A'),
                               ( 3, 1, 1, 3, 'Series 1 Season 1 Episode 3', 'A'),
                               ( 4, 1, 2, 1, 'Series 1 Season 2 Episode 1', 'A'),
                               ( 5, 1, 2, 2, 'Series 1 Season 2 Episode 2', 'A'),
                               ( 6, 2, 1, 1, 'Series 2 Season 1 Episode 1', 'A'),
                               ( 7, 2, 1, 2, 'Series 2 Season 1 Episode 2', 'A'),
                               ( 8, 2, 1, 3, 'Series 2 Season 1 Episode 3', 'A'),
                               ( 9, 2, 1, 4, 'Series 2 Season 1 Episode 4', 'A'),
                               (10, 2, 2, 1, 'Series 2 Season 2 Episode 1', 'A'),
                               (11, 2, 2, 2, 'Series 2 Season 2 Episode 2', 'A'),
                               (12, 2, 2, 3, 'Series 2 Season 2 Episode 3', 'A');
SELECT  id,
        series_id,
        season_id,
        episode_id,
        title,
        type
FROM    (
         SELECT ROW_NUMBER() OVER(PARTITION BY series_id ORDER BY season_id DESC, episode_id DESC) RowNum,
                *
         FROM   @SeriesInfo
        )   X
WHERE   X.RowNum = 1;

--SELECT ROW_NUMBER() OVER(PARTITION BY series_id ORDER BY season_id DESC, episode_id DESC) RowNum, * FROM @SeriesInfo; 
```

（样本数据过多见谅）

关键是，如果我们只取 series_id 和 season_id 的最大值，我们将不会得到任何一个系列的有效配对。在这两种情况下，第 1 季的剧集都比第 2 季多。ROW_NUMBER() 子句将每行返回一个唯一编号，但由于“PARTITION BY”，它将为每个 series_id 重新启动（参见注释掉的行）。如果我们只返回 ROW_NUMBER 为 1 的行，我们将得到每个 series_id 的一行，它将是 max season_id 中具有最大 episode_id 的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T02:17:17.220

尝试这个..

```
SELECT * FROM TABLE
HAVING MAX(season_id) AND MAX(episode_id)
GROUP BY series_id 
```

:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T11:10:09.110

```
SELECT *
FROM TableName t1
WHERE EXISTS (
              SELECT 1
              FROM t2
              WHERE t1.series_id = t2.series_id
              HAVING MAX(t2.season_id) = t1.season_id
                AND MAX(t2.episode_id ) = t1.episode_id
              ) 
```

# c++ - 无法让 OpenGL 中的 Gouraud 着色工作

> ID：14796313
> 
> 赞同：1
> 
> 时间：2013-02-10T09:26:47.937
> 
> 标签：c++, opengl, gouraud

我正在尝试使形状由于光源而具有一些阴影，但我希望形状都是一种颜色。

我的问题是，无论我多么努力，我似乎​​都无法在单一颜色模型上获得任何阴影。我已将模型简化为单个三角形，以使此示例更清晰：

```
#include <GL/glut.h>
#include <math.h>
#include <iostream>

#include<map>
#include<vector>

using namespace std;

/* Verticies for simplified demo */
float vertices[][3] = {
            {0.1, 0.1, 0.1},
            {0.2, 0.8, 0.3},
            {0.3, 0.5, 0.5},
            {0.8, 0.2, 0.1},
           };
const int VERTICES_SIZE = 4;
/* Polygons for simplified demo */
int polygon[][3] = {
                {0, 1, 3},
                {0, 2, 1},
                {0, 3, 2},
                {1, 2, 3},
            };
const int POLYGON_SIZE = 4;
/* Average point for looking at */
float av_point[3];

/*
 * Holds the normal for each vertex calculated by averaging the
 * planar normals that each vertex is connected to.
 * It holds {index_of_vertex_in_vertices : normal}
 */
map<int, float*> vertex_normals;

/*
 * Calculates average point in list of vertices
 * Stores in result
 */
void averagePoint(float vertices[][3], int length, float result[3]) {
  for(int i = 0; i < length; i++) {
    result[0] += vertices[i][0];
    result[1] += vertices[i][1];
    result[2] += vertices[i][2];
  }

  result[0] /= length;
  result[1] /= length;
  result[2] /= length;
}

/*
 * Performs inplace normalisation of vector v
 */
void normalise(float v[3]) {
  GLfloat length = sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);
  v[0] /= length;
  v[1] /= length;
  v[2] /= length;
}

/*
 * Performs cross product of vectors u and v and stores
 * result in result
 * Normalises result.
 */
void crossProduct(float u[], float v[], float result[]) {
  result[0] = u[1] * v[2] - u[2] * v[1];
  result[1] = u[2] * v[0] - u[0] * v[2];
  result[2] = u[0] * v[1] - u[1] * v[0];
}

/*
 * Calculates normal for plane
 */
void calculate_normal(int polygon[3], float vertices[][3], float normal[3]) {
  GLfloat u[3], v[3];
  for (int i = 0; i < 3; i++) {
    u[i] = vertices[polygon[0]][i] - vertices[polygon[1]][i];
    v[i] = vertices[polygon[2]][i] - vertices[polygon[1]][i];
  }

  crossProduct(u, v, normal);
  normalise(normal);
}

/*
 * Populates vertex_normal with it's averaged face normal
 */
void calculate_vertex_normals (map<int, float*> &vertex_normal){
  map<int, vector<int> > vertex_to_faces;
  map<int, float*> faces_to_normal;
  // Loop over faces
  for (int i = 0; i < POLYGON_SIZE; i++) {
    float* normal = new float[3];
    calculate_normal(polygon[i], vertices, normal);
    for (int j = 0; j < 3; j++) {
     vertex_to_faces[polygon[i][j]].push_back(i);
    }
    faces_to_normal[i] = normal;
  }

  vertex_normal.clear();
  // Loop over vertices
  for (int v = 0; v < VERTICES_SIZE; v++) {
    vector<int> faces = vertex_to_faces[v];
    int faces_count = 0;
    float* normal = new float[3];
    for (vector<int>::iterator it = faces.begin(); it != faces.end(); ++it){
      normal[0] += faces_to_normal[*it][0];
      normal[1] += faces_to_normal[*it][1];
      normal[2] += faces_to_normal[*it][2];
      faces_count++;
    }
    normal[0] /= faces_count;
    normal[1] /= faces_count;
    normal[2] /= faces_count;
    vertex_normal[v] = normal;
  }

  // Delete normal declared in first loop
  for (int i = 0; i < POLYGON_SIZE; i++) {
    delete faces_to_normal[i];
  }
}

/*
 * Draws polygons in polygon array.
 */
void draw_polygon() {
  for(int i = 0; i < POLYGON_SIZE; i++) {
    glBegin(GL_POLYGON);
    for(int j = 0; j < 3; j++) {
      glNormal3fv(vertex_normals[polygon[i][j]]);
      glVertex3fv(vertices[polygon[i][j]]);
    }
    glEnd();
  }
}

/*
 * Sets up lighting and material properties
 */
void init()
{
  // Calculate average point for looking at
  averagePoint(vertices, VERTICES_SIZE, av_point);

  // Calculate vertices average normals
  calculate_vertex_normals(vertex_normals);

  glClearColor (0.0, 0.0, 0.0, 0.0);
  cout << "init" << endl;

  // Intialise and set lighting parameters
  GLfloat light_pos[] = {1.0, 1.0, 1.0, 0.0};
  GLfloat light_ka[] = {0.2, 0.2, 0.2, 1.0};
  GLfloat light_kd[] = {1.0, 1.0, 1.0, 1.0};
  GLfloat light_ks[] = {1.0, 1.0, 1.0, 1.0};

  glLightfv(GL_LIGHT0, GL_POSITION, light_pos);
  glLightfv(GL_LIGHT0, GL_AMBIENT,  light_ka);
  glLightfv(GL_LIGHT0, GL_DIFFUSE,  light_kd);
  glLightfv(GL_LIGHT0, GL_SPECULAR, light_ks);

  // Initialise and set material parameters
  GLfloat material_ka[] = {1.0, 1.0, 1.0, 1.0};
  GLfloat material_kd[] = {0.43, 0.47, 0.54, 1.0};
  GLfloat material_ks[] = {0.33, 0.33, 0.52, 1.0};
  GLfloat material_ke[] = {0.0, 0.0, 0.0, 0.0};
  GLfloat material_se[] = {10.0};

  glMaterialfv(GL_FRONT_AND_BACK, GL_AMBIENT,  material_ka);
  glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE,  material_kd);
  glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR,  material_ks);
  glMaterialfv(GL_FRONT_AND_BACK, GL_EMISSION,  material_ke);
  glMaterialfv(GL_FRONT_AND_BACK, GL_SHININESS, material_se);

  // Smooth shading
  glShadeModel(GL_SMOOTH);

  // Enable lighting
  glEnable (GL_LIGHTING);
  glEnable (GL_LIGHT0);

  // Enable Z-buffering
  glEnable(GL_DEPTH_TEST);
}

/*
 * Free's resources
 */
void destroy() {
  for (int i = 0; i < VERTICES_SIZE; i++) {
    delete vertex_normals[i];
  }
}

/*
 * Display simple polygon
 */
void display (){
  glClear  (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
  draw_polygon();
  glutSwapBuffers();
}

/*
 * Sets up camera perspective and view point
 * Looks at average point in model.
 */
void reshape (int w, int h)
{
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  gluPerspective(70, 1.0, 0.1, 1000);
  glMatrixMode(GL_MODELVIEW);
  glLoadIdentity();
  gluLookAt(0, 0, 1, av_point[0], av_point[1], av_point[2], 0, 0.5, 0);
}

int main (int argc, char **argv)
{

  // Initialize graphics window
  glutInit(&argc, argv);
  glutInitWindowSize(256, 256);
  glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE);

  // Initialize OpenGL
  init();

  glutCreateWindow("Rendering");
  glutDisplayFunc(display);
  glutReshapeFunc(reshape);

  glutMainLoop   ();

  destroy();

  return 1;
} 
```

我对OpenGL真的很陌生，所以我希望它很简单。因为我记得设置我的法线，所以我不确定还有什么问题。

最终目标是为我的课程使用 Gouraud 着色（然后是纹理）渲染一张脸，但是我们几乎只能自己弄清楚 OpenGL（1.4 - 课程要求），而且我们不允许使用着色器。我正在尝试创建类似于这张图片的东西（取自谷歌）： ![在此处输入图像描述](../Images/5c09c510c3db4039f967a61203367fbe.png)

和我的三角形。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T12:12:29.847

> 由于光源造成的阴影，但我希望形状都是一种颜色。

这两个要求不是互斥的吗？你想要的结果到底是什么。你能画出你想象中的样子吗？在实现方面，使用着色器比处理大量的 OpenGL 状态机开关要容易得多*。*

### 更新

无论如何，这是我修改后的 OPs 代码，它绘制了一个受 Gourad 照明影响的三角形。这段代码编译并绘制了一个带有镜面反射提示的三角形。

让我们来看看我做了什么。首先是三角形的原始设置。这里没有什么特别的~~，也没有任何改变（除了一些包括）~~ *（编辑）第二次看我做了改变。std::map 的使用完全无法解释。我们知道顶点的数量并且可以预先分配法线的内存。*

```
#include <GL/glut.h>
#include <math.h>

// for memcpy
#include <string.h>

#include <map>
#include <vector>
#include <iostream>

using namespace::std;

/* Verticies for simplified demo */
const int VERTICES_SIZE = 4;
float vertices[VERTICES_SIZE][3] = {
            {0.1, 0.1, 0.1},
            {0.2, 0.8, 0.3},
            {0.3, 0.5, 0.5},
            {0.8, 0.2, 0.1},
           };

// this is now a plain array
float vertex_normals[VERTICES_SIZE][3];

/* Polygons for simplified demo */
const int POLYGON_SIZE = 4;
int polygon[POLYGON_SIZE][3] = {
                {0, 1, 3},
                {0, 2, 1},
                {0, 3, 2},
                {1, 2, 3},
};

/* Average point for looking at */
float av_point[3];

/*
 * Calculates average point in list of vertices
 * Stores in result
 */
void averagePoint(float vertices[][3], int length, float result[3]) {
  for(int i = 0; i < length; i++) {
    result[0] += vertices[i][0];
    result[1] += vertices[i][1];
    result[2] += vertices[i][2];
  }

  result[0] /= length;
  result[1] /= length;
  result[2] /= length;
}

/*
 * Performs inplace normalisation of vector v
 */
void normalise(float v[3]) {
  GLfloat length = sqrtf(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);
  v[0] /= length;
  v[1] /= length;
  v[2] /= length;
}

/*
 * Performs cross product of vectors u and v and stores
 * result in result
 * Normalises result.
 */
void crossProduct(float u[], float v[], float result[]) {
  result[0] = u[1] * v[2] - u[2] * v[1];
  result[1] = u[2] * v[0] - u[0] * v[2];
  result[2] = u[0] * v[1] - u[1] * v[0];
}

/*
 * Calculates normal for plane
 */
void calculate_normal(int polygon[3], float vertices[][3], float normal[3]) {
  GLfloat u[3], v[3];
  for (int i = 0; i < 3; i++) {
    u[i] = vertices[polygon[0]][i] - vertices[polygon[1]][i];
    v[i] = vertices[polygon[2]][i] - vertices[polygon[1]][i];
  }

  crossProduct(u, v, normal);
  normalise(normal);
} 
```

*编辑：我的下一个变化是在这里。看评论*

```
/*
 * Populates normals with it's averaged face normal
 *
 * Passing the normal output buffer as a parameter was a bit
 * pointless, as this procedure accesses global variables anyway.
 * Either pass everything as parameters or noting at all,
 * be consequent. And doing it mixed is pure evil.
 */
void calculate_vertex_normals()
{
  // We love RAII, no need for new and delete!
  vector< vector<int> > vertex_to_faces(POLYGON_SIZE);
  vector< vector<float> > faces_to_normal(POLYGON_SIZE);

  // Loop over faces
  for (int i = 0; i < POLYGON_SIZE; i++) {
    vector<float> normal(3);
    calculate_normal(polygon[i], vertices, &normal[0]);
    for (int j = 0; j < 3; j++) {
     vertex_to_faces[polygon[i][j]].push_back(i);
    }
    faces_to_normal[i] = normal;
  }

  // Loop over vertices
  for (int v = 0; v < VERTICES_SIZE; v++) {
    // avoid a copy here by using a reference
    vector<int> &faces = vertex_to_faces[v];
    int faces_count = 0;
    float normal[3];
    for (vector<int>::iterator it = faces.begin(); it != faces.end(); ++it){
      normal[0] += faces_to_normal[*it][0];
      normal[1] += faces_to_normal[*it][1];
      normal[2] += faces_to_normal[*it][2];
      faces_count++;
    }
    // dividing a vector obtained by a number of unit length vectors
    // summed by the number of unit vectors summed does not normalize
    // it. You need to normalize it properly!
    normalise(normal);

    // memcpy is really be best choice here
    memcpy(vertex_normals[v], normal, sizeof(normal));
  }
} 
```

draw_polygon 是这个函数的一个相当不愉快的名字。它绘制一个三角网格。*编辑：也可以通过使用顶点数组（自 1994 年开始使用 OpenGL-1.1）编写得更好。

```
/* 
 * Draws polygons in polygon array.
 */
void draw_polygon() {
  glEnableClientState(GL_VERTEX_ARRAY);
  glEnableClientState(GL_NORMAL_ARRAY);

  glVertexPointer(3, GL_FLOAT, 0, &vertices[0][0]);
  glNormalPointer(GL_FLOAT, 0, &vertex_normals[0][0]);

  glDrawElements(GL_TRIANGLES, POLYGON_SIZE*3, GL_UNSIGNED_INT, polygon);
} 
```

这里变得有趣了。一个常见的误解是，人们认为 OpenGL 已“初始化”。事实并非如此。你初始化的是数据。在您的情况下，您的几何数据

```
/*
 * Sets up lighting and material properties
 */
void init_geometry()
{
  // Calculate average point for looking at
  averagePoint(vertices, VERTICES_SIZE, av_point);

  // Calculate vertices average normals
  calculate_vertex_normals(vertex_normals);
} 
```

棘手的部分来了：OpenGL 固定功能照明与其他一切一样是一种状态。当您调用 glLightfv 时，它会根据调用时的状态设置内部参数。调用此位置时，模型视图会转换位置。但是如果没有设置正确的模型视图，您将无法设置照明。因此我把它放到了它自己的函数中，我们在绘图函数中设置好模型视图后立即调用它。

```
void setup_illumination()
{
  // Intialise and set lighting parameters
  GLfloat light_pos[] = {1.0, 1.0, 1.0, 0.0};
  GLfloat light_ka[] = {0.2, 0.2, 0.2, 1.0};
  GLfloat light_kd[] = {1.0, 1.0, 1.0, 1.0};
  GLfloat light_ks[] = {1.0, 1.0, 1.0, 1.0};

  glLightfv(GL_LIGHT0, GL_POSITION, light_pos);
  glLightfv(GL_LIGHT0, GL_AMBIENT,  light_ka);
  glLightfv(GL_LIGHT0, GL_DIFFUSE,  light_kd);
  glLightfv(GL_LIGHT0, GL_SPECULAR, light_ks);

  // Initialise and set material parameters
  GLfloat material_ka[] = {1.0, 1.0, 1.0, 1.0};
  GLfloat material_kd[] = {0.43, 0.47, 0.54, 1.0};
  GLfloat material_ks[] = {0.33, 0.33, 0.52, 1.0};
  GLfloat material_ke[] = {0.0, 0.0, 0.0, 0.0};
  GLfloat material_se[] = {10.0};

  glMaterialfv(GL_FRONT_AND_BACK, GL_AMBIENT,  material_ka);
  glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE,  material_kd);
  glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR,  material_ks);
  glMaterialfv(GL_FRONT_AND_BACK, GL_EMISSION,  material_ke);
  glMaterialfv(GL_FRONT_AND_BACK, GL_SHININESS, material_se);

  // Smooth shading
  glShadeModel(GL_SMOOTH);

  // Enable lighting
  glEnable (GL_LIGHTING);
  glEnable (GL_LIGHT0);
} 
```

对于绘图功能，一些事情发生了变化。查看代码中的注释

```
/*
 * Display simple polygon
 */
void display (void)
{
  // float window sizes are usefull for view volume calculations
  //
  // requesting the window dimensions for each drawing iteration
  // is just two function calls. Compare this to the number of function
  // calls a typical application will do for the actual rendering
  // Trying to optimize away those two calls is a fruitless microoptimization
  float const window_width  = glutGet(GLUT_WINDOW_WIDTH);
  float const window_height = glutGet(GLUT_WINDOW_HEIGHT);
  float const window_aspect = window_width / window_height;

  // glViewport operates independent of the projection --
  // another reason to put it into the drawing code
  glViewport(0, 0, window_width, window_height);

  glClearDepth(1.);
  glClearColor (0.0, 0.0, 0.0, 0.0);
  glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

  // It's a often made mistake to setup projection in the window resize
  // handler. Projection is a drawing state, hence should be set in
  // the drawing code. Also in most programs you will have multiple
  // projections mixed throughout rendering a single frame so there you
  // actually **must** set projection in drawing code, otherwise it
  // wouldn't work.
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  gluPerspective(70, window_aspect, 1, 100);

  glMatrixMode(GL_MODELVIEW);
  glLoadIdentity();
  gluLookAt(0, 0, -3, av_point[0], av_point[1], av_point[2], 0, 1, 0);

  // Fixed function pipeline light position setup calls operate on the current
  // modelview matrix, so we must setup the illumination parameters with the
  // modelview matrix at least after the view transformation (look-at) applied.
  setup_illumination();

  // Enable depth testing (z buffering would be enabled/disabled with glDepthMask)
  glEnable(GL_DEPTH_TEST);

  draw_polygon();

  glutSwapBuffers();
}

int main (int argc, char **argv)
{    
  // Initialize graphics window
  glutInit(&argc, argv);
  glutInitWindowSize(256, 256);
  glutInitDisplayMode    (GLUT_DEPTH | GLUT_DOUBLE);

  // we actually have to create a window
  glutCreateWindow("illuination");

  // Initialize geometry
  init_geometry();

  glutDisplayFunc(display);

  glutMainLoop();

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:36:27.103

您似乎在几个地方有一个名为`vertices`（这是正确的拼写）的数组和另一个名为的数组（是最明显的例子）。这是一个错误吗？如果您从第一个数组中获取一个坐标，但从另一个不相关的数组中获取第二个坐标，这可能会打乱您的正常计算。`verticies``calculate_normal`

# php - PHP MySQL关联数组使用array_push

> ID：14796315
> 
> 赞同：1
> 
> 时间：2013-02-10T09:27:15.603
> 
> 标签：php, mysql, ajax, json

我正在尝试使用 PHP 创建一个关联数组。我正在使用调用 json 文件的 ajax 脚本。

我已经使用以下 PHP 代码测试了脚本：

```
$testLocs = array(
'loc5' => array( 'info' => 'Some random info', 'lat' => 0, 'lng' => 60 ),
'loc6' => array( 'info' => 'Some random info', 'lat' => 0, 'lng' => 40.345 )
);
echo json_encode($testLocs); 
```

这呼应：

```
{"loc1":{"info":"Some random info","lat":0,"lng":60},"loc1":{"info":"Some random info","lat":0,"lng":40.345}} 
```

ajax 代码将正常工作。现在我正在尝试编写一个 PHP 脚本，该脚本将从数据库中获取信息。我的PHP代码如下

```
$query = "Select * from table";
$result = mysql_query($query);

$json_data = array();

while ($row = mysql_fetch_assoc($result)) {
$id = $row['id'];
$lat = $row['lat'];
$lon = $row['lon'];
$page = $row['page'];
array_push($json_data, array('info' => 'Some random info', 'lat' => $lat, 'lng' => $lon)); 
}

echo json_encode($json_data); 
```

这呼应：

```
{"info":"Some random info","lat":"-31.9522","lng":"115.8614"},{"info":"Some random info","lat":"40.7842","lng":"-73.8422"} 
```

我无法弄清楚如何放在`'loc' =>`每个数组的前面。ajax 使用 locNUM 作为唯一 ID。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:31:56.767

尝试

```
$json_data = array();
$i = 0;

while ($row = mysql_fetch_assoc($result)) {
$id = $row['id'];
$lat = $row['lat'];
$lon = $row['lon'];
$page = $row['page'];
$json_data["loc" . ($i++)] = array('info' => 'Some random info', 'lat' => $lat, 'lng' => $lon); 
} 
```

而不是`array_push`. `array_push`表示纯数组函数，而不是哈希操作函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:34:07.757

If`$row['id']`是 locNUM 的唯一 ID：

```
$json_data["loc".$id] = array('info' => 'Some random info', 'lat' => $lat, 'lng' => $lon) 
```

[`array_push()`](http://php.net/manual/en/function.array-push.php)与 相同`$array[] = $var;`，它为您提供递增的数字键。

# objective-c - 井字游戏代码不起作用

> ID：14796318
> 
> 赞同：0
> 
> 时间：2013-02-10T09:28:06.833
> 
> 标签：objective-c

我在 xcode 中做一个井字游戏。这是我的代码

```
 - (IBAction)c1Button:(id)sender {
if ((status.text = @"X goes now"))
{
    c1.text = @"X";
    if ([c1.text isEqualToString: @"X"])
    {
        status.text = @"O goes now";
    }
    else
    {
        status.text = @"X goes now";
    }
}
else if ((status.text = @"O goes now"))
{
    c1.text = @"O";
    if ((c1.text = @"O"))
    {
        status.text = @"X goes now";
    }
    else
    {
        status.text = @"O goes now";
    }
}
} 
```

单击第一个单元格时，会出现应有的 X。现在状态标签更改为 O 。但是当单击单元格时，它仍然写 X 而不是 O。有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:31:13.297

在第一个`if`语句中，您分配为字符串而不是比较它。这个：

```
if ((status.text = @"X goes now")) 
```

应该：

```
if ([status.text isEqualToString:@"X goes now"]) 
```

第二个陈述也是如此。

此外，最好保留状态（作为整数或布尔值）而不是每次都使用标题来解析状态。

```
#define X_TURN    0
#define O_TURN    1

// ....

if (turn == X_TURN)
{
    c1.text = @"X";
    status.text = @"O goes now";
    turn = O_TURN;
}
else
{
    c1.text = @"O";
    status.text = @"X goes now";
    turn = X_TURN;
} 
```

# python - input() :: 使用退格键和箭头键

> ID：14796323
> 
> 赞同：11
> 
> 时间：2013-02-10T09:28:42.533
> 
> 标签：python, python-3.x

我有一个 python 脚本，它通过内置的 input() 函数从用户那里获取信息。

我的问题是为什么退格键和箭头键不能正常工作，我该如何修复它以使其按预期工作。

我遇到的问题的一个简单例子......

```
#!/usr/bin/env python3
while 1:
  x=input("enter integer: ")
  y=int(x)*17
  print(y) 
```

这是一个使用它的例子。

```
./tester 
enter integer: 3
51
enter integer: 17
289
enter integer: 172^[[D^[[D^H
Traceback (most recent call last):
  File "./tester", line 4, in <module>
    y=int(x)*17
ValueError: invalid literal for int() with base 10: '172\x08' 
```

在尝试使用箭头键和退格键删除“1”时，^[[D^[[D^H 出现而不是删除向左移动两个空格并删除“1”，并且该值使程序崩溃。

我该如何解决这个问题，以便所有键都按预期工作？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-10T09:43:18.137

`readline`从标准库中导入模块。它会自动包装标准输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:38:17.707

查看 tkinter 库：

[http://wiki.python.org/moin/TkInter](http://wiki.python.org/moin/TkInter)

在 SO 上也有一个关于库的很好的讨论：

[箭头键输入代码在 tkinter 中不起作用](https://stackoverflow.com/questions/14595284/python-tkinter-arrow-key-input-code-not-functioning)

# backbone.js - 定义一个新的骨干集合

> ID：14796325
> 
> 赞同：5
> 
> 时间：2013-02-10T09:28:53.387
> 
> 标签：backbone.js, backbone.js-collections

我试图扩展骨干集合，第一种方式是我在声明中做 new，第二种方式是我先声明，然后创建一个新实例。是做第一个错，有什么区别？

```
var AppointmentList = new Backbone.Collection.extend({
  model: Appointment
}); 
```

和

```
var AppointmentList = Backbone.Collection.extend({
  model: Appointment
});

var aptlist = new AppointmentList(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T10:34:15.660

第一个会断

```
var Appointment = Backbone.Model.extend({
    defaults: {
        "time": "0000",
        "note": "This is an appointment"
    }
});

var AppointmentList = new Backbone.Collection.extend({

    model: Appointment

});

var aptlist = new AppointmentList(); 
```

在 Backbone.js 中，我们有

```
 var extend = function(protoProps, staticProps) {

    var parent = this;
    var child;

    if (protoProps && _.has(protoProps, 'constructor')) {
      child = protoProps.constructor;
    } else {
      child = function(){ return parent.apply(this, arguments); };
    }

    _.extend(child, parent, staticProps);

    var Surrogate = function(){ this.constructor = child; };

    Surrogate.prototype = parent.prototype;

    child.prototype = new Surrogate;

    if (protoProps) _.extend(child.prototype, protoProps);

    child.__super__ = parent.prototype;

    return child;

  }; 
```

如果您使用`new`运算符实例化 Backbone.Collection.extend，那么 the`var parent = this`将引用扩展对象，但如果您不使用`new`then`var parent = this`将引用`Backbone.Collection`并且由于您只能调用`.apply`函数，因此代码将在此处中断：

```
child = function(){ return parent.apply(this, arguments); }; 
```

`parent`将是一个对象。`Backbone.Collection`是一个函数

# iphone - 获取指定格式的日期

> ID：14796327
> 
> 赞同：-4
> 
> 时间：2013-02-10T09:29:04.283
> 
> 标签：iphone, objective-c, nsdate, nsdateformatter

我正在`"2013-02-10 09:26:52 +0000"`使用`[NSDate date]`.
我想要格式的日期，如`"Feb 10"`.

任何人都可以建议正确`dateFormat`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:27:19.030

它在我的情况下工作：

```
 NSDateFormatter* dateFormatterBegin = [[NSDateFormatter alloc] init];
            [dateFormatterBegin setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSSZZZ"];
            NSString *dateStringBegin = @"2013-02-10 09:26:52 +0000";
            NSDate* datebegin = [dateFormatterBegin dateFromString:[dateStringBegin stringByReplacingOccurrencesOfString:@":" withString:@"" options:0 range:NSMakeRange(dateStringBegin.length-3, 1)]];
            [dateFormatterBegin setDateFormat:@"MMM-dd"];
            NSString *beginDate = [[NSString alloc] initWithFormat:@"%s%@","Start Date : ",[dateFormatterBegin stringFromDate:datebegin]];

            NSLog(@"Your date is : %@",beginDate); 

            [dateFormatterBegin release];
            [beginDate release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:39:41.947

使用 NSDateFormatter 类：

```
NSDateFormatter * myFormatter = [[NSDateFormatter alloc] init];
[myFormatter setDateFormat:@"ddMMyy" options:0 locale:[NSLocale currentLocale]];

NSString * formattedDate = [myFormatter stringFromDate:[NSDate date]]; 
```

在这里，您可以选择 setDateFormat 的输出格式：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T09:56:39.593

```
NSString *string = @"2013-02-10 09:26:52 +0000"; // The date in a string

//Convert the string to date with the same format 
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init]; 
[dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss zzz"]; // Set format
NSDate *date = [dateFormat dateFromString:string];

//Create the new date format using NSDateFormatter 
NSDateFormatter *dateFormat1 = [[NSDateFormatter alloc] init];
[dateFormat1 setDateFormat:@"MMM dd"]; // Set format

//Convert the date using dateFormat1
NSDate *formatDate= [dateFormat1 dateFromString:date]; // date with MMM dd 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T10:21:26.250

嗨，像这样设置日期格式化程序

```
 [dateFormatter setDateFormat:@"MMM d, yyyy hh:mm:ss"]; 
```

希望它会工作

# iphone - 在uitableview中选择时如何更改自定义单元格图像和标签字体颜色？

> ID：14796328
> 
> 赞同：0
> 
> 时间：2013-02-10T09:29:15.280
> 
> 标签：iphone, xcode, uitableview, uiimageview

我有一个带有图像视图和标签的自定义单元格。当用户在表格视图中选择特定单元格时，我想更改其图像和标签字体颜色。我该怎么做？我想避免默认的单元格选择方式（突出显示单元格蓝色）并使用上述方法代替。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:44:08.633

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

     MyCustomCell *selectedCell = (MyCustomCell *)[tableView cellForRowAtIndexPath:indexPath];

     //selectedCell.textLabel.textColor = <#your color#>
     //selectedCell.myImage = <#your image>

} 
```

如果您想更改选定的单元格背景颜色，请尝试此操作。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
     NSString *cellId = @"cellIdentifier";

     UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellId forIndexPath:indexPath];
     if(!cell)
     {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId];

        UIView *bgColorView = [[UIView alloc] init];
        [bgColorView setBackgroundColor:[UIColor redColor]];
        [cell setSelectedBackgroundView:bgColorView];
     }
} 
```

# encryption - 与对称密码学相比，HMAC 有什么好处？

> ID：14796330
> 
> 赞同：9
> 
> 时间：2013-02-10T09:29:19.087
> 
> 标签：encryption, hmac

不知何故，我没有得到 HMAC。

我[曾经问过，当我们确实有公钥签名时，为什么我需要 HMAC？](https://stackoverflow.com/questions/14372628/why-do-i-need-hmacs-when-we-do-have-public-key-signatures)，我想我得到了这个。更容易计算，等等......

但是，我不明白为什么我们需要 HMAC，它们分别解决了什么样的问题。

据我了解，HMAC ...

*   提供一种方法来确保消息未被篡改，
*   由秘密但对称的密钥“保护”。

因此，为了计算 HMAC（无论是初始还是验证），我都需要知道密钥。

现在，如果我可以在不被篡改的情况下以秘密方式交换此密钥，我也可以以相同的秘密方式交换消息而不会被篡改，不是吗？

好的，现在您可以争辩说您只需要交换一次密钥，但您可能有多个消息。没关系。

但是，如果我们现在有一个必须由各方保密的密钥，我们也可以直接使用对称加密，使用相同的密钥来加密消息，不是吗？

当然，HMAC 应该提供防止篡改的解决方案，但是如果我只有一条没有密钥和合理加密算法的加密消息，我无法以 a) 解密仍然有效的方式更改该加密消息，并且 b)出现有意义的解密消息。

那么我实际上需要一个 HMAC 是为了什么？或者 - 我错过的重点在哪里？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-10T09:50:45.763

您假设在不知道用于加密的密钥的情况下不可能篡改加密消息。事实并非如此，这是一个危险的假设。即使您只能访问密文，也有几件事可能：

*   消息后缀损坏：这可能会通过错误消息、时间和可能的其他方式泄漏有关内容的信息。
*   某些模式（ECB、CFB 和可能的其他模式）的消息范围损坏：与上述相同，但攻击者有更多方法来触发想要的行为。
*   翻转单个块中的任意位（虽然不知道它们的初始值）和破坏下一个块（CFB）：如果攻击者知道某些位，他可以将它们设置为他想要的值。
*   翻转整个消息中的任意比特流密码或分组密码的流密码等效模式：这可以完全避免损坏。

因此，在处理解密内容的单个字节之前验证没有攻击者篡改消息非常重要。由于使用临时验证或简单散列进行此操作时再次存在一些缺陷，因此需要 MAC，其中 HMAC 就是一个示例。

# ios - 如何使用 CaptainHook 挂钩协议方法

> ID：14796335
> 
> 赞同：0
> 
> 时间：2013-02-10T09:30:42.903
> 
> 标签：ios, tweak, theos

我确实找到了使用 Theos Logos 执行此操作的示例：

[https://github.com/DHowett/theos-logos-examples/blob/master/logos.uiapplicationdelegate/Tweak.xm](https://github.com/DHowett/theos-logos-examples/blob/master/logos.uiapplicationdelegate/Tweak.xm)

但我想知道如何使用 CaptainHook 来做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:07:51.210

所以你想使用这个名为`MSHookMessageEx()`.

# go - 如何停止 io.CopyN

> ID：14796337
> 
> 赞同：3
> 
> 时间：2013-02-10T09:30:48.643
> 
> 标签：go

我有一些从文件复制到 tcp 套接字（如 ftp 服务器）的代码，并且希望能够在需要时中止此复制。

我只是使用 io.CopyN(socket, file, size) 并且看不到发出中止信号的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T10:49:14.567

关闭输入文件怎么样？ `io.CopyN`然后将返回错误并中止。

这是一个演示（如果不在 Linux 上运行，请更改`/dev/zero`并`/dev/null`为您的操作系统等效！）

```
package main

import (
    "fmt"
    "io"
    "log"
    "os"
    "time"
)

func main() {
    in, err := os.Open("/dev/zero")
    if err != nil {
        log.Fatal(err)
    }

    out, err := os.Create("/dev/null")
    if err != nil {
        log.Fatal(err)
    }

    go func() {
        time.Sleep(time.Second)
        in.Close()
    }()

    written, err := io.CopyN(out, in, 1E12)
    fmt.Printf("%d bytes written with error %s\n", written, err)
} 
```

运行时它将打印类似

```
9756147712 bytes written with error read /dev/zero: bad file descriptor 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T09:40:44.530

`CopyN`努力复制 N 个字节。如果您想选择性地复制少于 N 个字节，那么首先不要使用 CopyN。我可能会将原始代码改编为（未经测试的代码）：

```
func copyUpToN(dst Writer, src Reader, n int64, signal chan int) (written int64, err error) {
    buf := make([]byte, 32*1024)
    for written < n {
        select {
        default:
        case <-signal:
            return 0, fmt.Errorf("Aborted") // or whatever
        }

        l := len(buf)
        if d := n - written; d < int64(l) {
            l = int(d)
        }
        nr, er := src.Read(buf[0:l])
        if nr > 0 {
            nw, ew := dst.Write(buf[0:nr])
            if nw > 0 {
                written += int64(nw)
            }
            if ew != nil {
                err = ew
                break
            }
            if nr != nw {
                err = io.ErrShortWrite
                break
            }
        }
        if er != nil {
            err = er
            break
        }
    }
    return written, err
} 
```

# c++ - 修改菜单项

> ID：14796341
> 
> 赞同：1
> 
> 时间：2013-02-10T09:31:00.357
> 
> 标签：c++, mfc

我有一个弹出菜单，我想在显示之前对其进行修改。我实际上可以很好地修改菜单项的字符串。问题是，这使它无用，因为单击修改后的菜单项时没有任何反应。

```
CMenu* pPopup = menu.GetSubMenu(0);
ASSERT(pPopup != NULL);

CWnd* pWndPopupOwner = this;
while(pWndPopupOwner->GetStyle() & WS_CHILD)
    pWndPopupOwner = pWndPopupOwner->GetParent();

// modify string
pPopup->ModifyMenu(1, MF_BYPOSITION | MF_STRING, NULL, oss.str().c_str());

pPopup->TrackPopupMenu(TPM_LEFTALIGN | TPM_RIGHTBUTTON, point.x, point.y, pWndPopupOwner); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:32:56.660

您的调用`ModifyMenu`是将菜单的 ID 设置为零（通过第三个参数）。您需要保持该 ID 相同。

如果这很尴尬，`SetMenuItemInfo`API 允许您在不更改 ID 的情况下更改字符串。

# drupal - 实体引用在视图模式中使用其他字段

> ID：14796345
> 
> 赞同：0
> 
> 时间：2013-02-10T09:31:32.180
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-commerce

我在 drupal 7 中有一个学生书籍产品，他们有一个同伴教师的书籍产品。我想制作一个视图模式，显示学生书籍（产品展示）以及对教师书籍的实体引用，这也是书籍产品。问题是我可以显示 id、title 或呈现的实体，但不能显示其他实体字段。我要显示的是这样的：

学生的 ISDN： ***_* __ *_* __**

教师的 ISDN：***_* __ *_* __**

... 其他产品领域（学生） ...

我已经尝试了几个模块，如显示套件，但没有，你能帮忙吗？我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:36:59.797

一个快速的解决方案是为您的内容类型创建一个新的节点模板。例如：`node--student.tpl.php`，然后使用以下代码作为示例：

```
$referenced_node = node_load($node->field_ref[LANGUAGE_NONE]['0']['target_id']);
print node_view($referenced_node, "teaser"); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T08:40:33.790

我是这样做的：

```
 // Initial weight
  $weight = 2;
  // Student's book entity
  $student_book_entity = $node->field_student_book[LANGUAGE_NONE][0]['entity'];

  // Get Student's book ISBN and alter some attributes
  $student_isbn_field = array_merge(field_view_field('commerce_product', $student_book_entity, 'field_book_isbn'), array(
      '#field_name' => 'field_students_book_isbn',
      '#title' => t('Student\'s Book ISBN'),
      '#weight' => $weight++,
    )
  );
  $node->content['field_students_book_isbn'] = $student_isbn_field;

  // Teacher's book entity
  $teachers_book_entity = $node->field_teacher_book[LANGUAGE_NONE][0]['entity'];

  // Get Teacher's book ISBN and alter some attributes
  $teacher_isbn_field = array_merge(field_view_field('commerce_product', $teachers_book_entity, 'field_book_isbn'), array(
      '#field_name' => 'field_teachers_book_isbn',
      '#title' => t('Teacher\'s Book ISBN'),
      '#weight' => $weight++,
    )
  );
  $node->content['field_teachers_book_isbn'] = $teacher_isbn_field; 
```

# javascript - Javascript 不适用于 ajax 帖子

> ID：14796350
> 
> 赞同：0
> 
> 时间：2013-02-10T09:31:56.330
> 
> 标签：javascript, jquery, youtube, youtube-api, youtube-javascript-api

我正在使用 Youtube Iframe API 并使用他们的脚本播放器加载正常。但是当我对包含 javascript 代码的 php 文件进行 ajax 调用以运行播放器时，它不会执行。

```
function get_content(song_id,url,song_title) {
if (song_id == null)
    return;
    document.title = song_title + browser_title_suffix;
    $.get('/ajax/player.php',{song_id:song_id}, function(data) {
        $('#main_content').html(data).css({'opacity':0}).animate({'opacity':1});
        });
        } 
```

/ajax/player.php 包含此代码 - [https://developers.google.com/youtube/iframe_api_reference#Loading_a_Video_Player](https://developers.google.com/youtube/iframe_api_reference#Loading_a_Video_Player)

但是，玩家不会再这样做了。我什至尝试过 player.remove() 但这也无济于事。

**更新 1：** 我的 PHP 文件：

```
var tag = document.createElement('script');
tag.src = "//www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

$(document).ready(function(){
get_content('.$row[song_id].',null,"'.$row[title].'");
});

</script> 
```

我的 javascript 文件：

```
function get_content(song_id,url,song_title) {
if (song_id != null) {
    $.get('/ajax/player.php',{song_id:song_id}, function(data) {
        video_id = data;
        player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: video_id,
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    });

}
} 
```

**但是，视频播放器不会加载。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T20:33:55.540

您无法通过 ajax 获取 javascript，然后运行刚刚收到的 javascript。您要做的只是通过 ajax 发送 youtube 视频 ID，然后使用这样的函数来放置播放器：

```
function get_content(song_id,url,song_title) {
    if (song_id != null) {
        $.get('/ajax/player.php',{song_id:song_id}, function(data) {
            video_id = data;

            player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: video_id,
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        });
    }
} 
```

更好的是，尝试使用 JSON 通过 Jquery 发送和接收数据。

# ios - Theos 偏好加载器 + 调整错误

> ID：14796354
> 
> 赞同：0
> 
> 时间：2013-02-10T09:32:14.653
> 
> 标签：ios, objective-c, cydia, tweak, theos

我正在使用 iPhone 中的 theos 对偏好包进行 cydia 调整

但是我收到了这个错误！

![在此处输入图像描述](../Images/72bd010164d484119b9d16893cf5d212.png)

这是我的代码：

PSListController

（我不知道我的代码中的错误在哪里。代码太长，无法粘贴到这里。我做了一个指向我的代码的链接） [http://pastebin.com/gQvYvB89](http://pastebin.com/gQvYvB89)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-16T09:31:59.753

这不是答案，但不允许我发表评论。

IOSOpenDev 的一个很好的替代品是 Theos，这更像是你习惯的，因为它与你的 iPhone 上的工作方式相同。您使用 make 命令并拥有模板。

安装相当复杂，但这里有一个很好的指南。

[http://brandontreb.com/beginning-jailbroken-ios-development-getting-the-tools](http://brandontreb.com/beginning-jailbroken-ios-development-getting-the-tools)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-10T11:16:21.260

您应该`#import <UIKit/UIKit.h>`在头文件的开头添加（这是一个常见的事情：如果您遇到系统定义的类或协议 - 基本上每个类都以 NS 或 UI 和其他一些开头 - 您应该删除由 class-dump 生成的头文件并导入系统头文件，这将为您省去很多麻烦）。

顺便说一句，你真的不应该在设备上编译东西，因为 Cydia 上的 GCC 已经过时了（我认为它是从 iOS 3.x 时代开始的），而且使用 Theos 无论如何都是一件痛苦的事情：还有另一个框架'将帮助您构建首选项包（以及调整、siri 扩展、SBSettings 的切换，...​​），它被称为[iOSOpenDev](http://www.iosopendev.com/)，它允许您将 Xcode 用于这些项目，这是对从命令行在设备上编译的重大改进（所以没有代码完成、语法高亮和 Xcode 可以给你的所有这些伟大的改进）。

PS：如果您选择迁移到 iOSOpenDev，请随时要求解释，我有一些经验；）

# c# - LayoutAwarePage 的 MVVM 够用吗？

> ID：14796355
> 
> 赞同：3
> 
> 时间：2013-02-10T09:32:35.990
> 
> 标签：c#, mvvm, windows-8

目前我正在使用 MVVM Light，但我看到 Windows Store Apps 中的 LayoutAwarePage 提供了自己的基本 MVVM 实现。为 Windows Store App 推荐什么样的 MVVM 实现？似乎使用 MVVM Light，我可以添加冗余代码。也许可以集成两个系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-12T21:18:00.560

您可能还对查看 Okra 应用程序框架 ( [http://okra.codeplex.com](http://okra.codeplex.com) ) 感兴趣。它是一个 MVVM 框架，专为 Windows 8 开发而设计，允许您仍然使用 LayoutAwarePage 来显示视觉状态。

安迪

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T11:44:20.703

我最近在我最近做的一个项目的所有页面中都使用了 LayoutAwarePage。我发现它在支持设备方向更改、导航和进程生命周期管理方面很有用，即：与空白页面相比，Windows 应用商店特定的东西。LayoutAwarePages DefaultViewModel 非常适合快速轻松地启动和运行，但如果您想要在可测试性、组件松散耦合/关注点分离和最少使用代码隐藏方面实现 MVVM 模式可能在 MVVM 灯的正确线上。

无论如何，希望这对您的项目有所帮助并祝您好运。

安德鲁

# android - android expandlistview 箭头

> ID：14796359
> 
> 赞同：0
> 
> 时间：2013-02-10T09:32:57.793
> 
> 标签：android

我知道如何制作扩展列表视图，但我不知道应该用什么来查看向下和向上的箭头，请问如何？

就像当我打开一个组时，箭头变为向下，当我关闭它时，箭头变为向上

### 主要的 xml

![在此处输入图像描述](../Images/182641c90bf84a873136e868acf4edb9.png)

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

 <ExpandableListView

    android:id="@+id/ExpList"

    android:layout_height="match_parent"

    android:layout_width="match_parent"

    android:groupIndicator="@null" /> 

</LinearLayout> 
```

### 组 xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="55dip"
    android:background="#FF0000"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/tvGroup"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginRight="15dp"
        android:textColor="#000000"
        android:textSize="17dip" />

</LinearLayout> 
```

### 子xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="55dip"
    android:background="#FF0000"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/tvChild"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="#000000"
        android:textSize="17dip" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:22:56.010

从您的 xml 代码中删除此行`android:groupIndicator="@null"`

# sql-server-2005 - 将多行插入 SQL Server

> ID：14796363
> 
> 赞同：0
> 
> 时间：2013-02-10T09:33:47.110
> 
> 标签：sql-server-2005, insert

我有两张桌子

```
Product (product_id, productName)
ProductSerialNumber (ProductSerialNumber_id, product_id, serialNumber, status) 
```

我有产品的序列号`12345679000`（`123456790100`数量：90）：`MILK`

有没有办法在不使用多个插入的情况下做到这一点，即

```
$Sn = 12345679000;
while ($Sn <= 123456790100 )
{
  INSERT INTO ProductSerialNumber VALUES(...,...,$Sn,...)
  $Sn++;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:40:28.970

你可以这样做：

```
WITH Temp
AS
(
   SELECT n
   FROM(VALUES(0), (1), (2), (3), (4), (5), (6), (7), (8), (9)) AS Temp(n)
), nums
AS
(
   SELECT id = t1.n * 10 + t2.n + 1
   FROM temp AS T1
   CROSS JOIN temp AS t2
)
INSERT INTO ProductSerialNumber(serialnumber)
SELECT 12345679000 + id AS Serialnumber  -- You can insert into other columns too
FROM nums; 
```

[**SQL 小提琴演示**](http://www.sqlfiddle.com/#!3/d84d2/1)。

**请注意：**此语法`FROM(VALUES(0), (1), ..., (9)) AS Temp(n)`是 SQL Server-2008 的新语法，您可以使用旧版本`SELECT ... UNION ALL SELECT ...`代替。

**但是**，如果可能，您可以更改此表并将此列设为`SerialNumber`an [**`IDENTITY(12345679000, 1)`**](http://msdn.microsoft.com/en-us/library/ms186775.aspx)，它将自动递增。

* * *

## 更新 1

对于 SQL Server 2005，试试这个：

```
WITH Temp
AS
(
  SELECT 1 AS id
  UNION ALL
  SELECT 2
  UNION ALL
  SELECT 3
  UNION ALL
  SELECT 4
), nums
AS
(
  SELECT ROW_NUMBER() OVER(ORDER BY t1.id) AS id
  FROM temp t1, temp t2, temp t3, temp t4
)
INSERT INTO ProductSerialNumber(serialnumber)
SELECT 12345679000 + id AS Serialnumber
FROM nums
WHERE id <= 100; 
```

[**更新了 SQL Fiddle 演示**](http://www.sqlfiddle.com/#!3/1995a/1)。

* * *

## 更新 2

**这个查询是如何工作的？**

首先，我定义了一个只有四个值的虚拟表：

```
 SELECT 1 AS id
  UNION ALL
  SELECT 2
  UNION ALL
  SELECT 3
  UNION ALL
  SELECT 4 
```

我在[*Common table expression(CTE)*](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)中定义了它，以便以后重用。

然后在以下 CTE 中，我使用了：

```
FROM temp t1, temp t2, temp t3, temp t4 
```

这将与它自己连接表`temp`四次，因此它会给你：**4 ⁴ = 256**行。然后我使用[排序函数`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms189798%28v=sql.90%29.aspx)作为一个工作循环来生成一个从 1 到 265 的数字序列号。

最后一件事是`INSERT INTO ... SELECT ...`选择`<= 100`我们已经从上一步生成的数字的数字并将它们插入到表中的语法。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T12:48:21.617

这是另一种使用过程插入多行的方法

```
CREATE PROCEDURE autoInsert
@SerialNumberStart bigint,
@SerialNumberEnd bigint,
@status int,
@productID int
AS   
while @SerialNumberStart <= @SerialNumberEnd
begin
BEGIN TRAN

INSERT INTO ProductSerialNumber VALUES(@SerialNumberStart)
--print @SerialNumberStart

COMMIT TRAN;
set @SerialNumberStart=@SerialNumberStart+ 1
end 
```

# c# - 当我在 C# 中移动 Form2 时移动 Form1

> ID：14796367
> 
> 赞同：2
> 
> 时间：2013-02-10T09:34:12.723
> 
> 标签：c#, winforms

我有两种形式。`Form2`正在从 中打开`Form1`，如下所示：

```
Form2.ShowDialog(); 
```

`StartPosition`of`Form2`配置为`centerParent`.

我需要将位置固定`Form2`在 Form1 的中心，这样当我移动时`Form2`，`Form1`也会改变它的位置。我尝试了许多解决方案，但都没有成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:48:39.800

调用 ShowDialog 函数时必须包含父引用，但还必须在使用 LocationChanged 事件*之前记录初始位置差异。*

```
Form2 f2 = new Form2();
f2.StartPosition = FormStartPosition.CenterParent;
f2.ShowDialog(this); 
```

然后在对话框中，你可以像这样连接它：

```
Point parentOffset = Point.Empty;
bool wasShown = false;

public Form2() {
  InitializeComponent();
}

protected override void OnShown(EventArgs e) {
  parentOffset = new Point(this.Left - this.Owner.Left,
                           this.Top - this.Owner.Top);
  wasShown = true;
  base.OnShown(e);
}

protected override void OnLocationChanged(EventArgs e) {
  if (wasShown) {
    this.Owner.Location = new Point(this.Left - parentOffset.X, 
                                    this.Top - parentOffset.Y);
  }
  base.OnLocationChanged(e);
} 
```

此代码不进行任何错误检查，仅演示代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T14:17:38.257

请注意，这通常是一个**非常**不受欢迎的 UI 功能。对话框很烦人，因为它们会禁用应用程序中的其余窗口。这会阻止用户激活窗口以查看其内容。用户所能做的就是将对话框移开。您故意阻止此操作。

Anyhoo，很容易通过 LocationChanged 事件实现。将此代码粘贴到对话框表单类中：

```
 private Point oldLocation = new Point(int.MaxValue, 0);

    protected override void OnLocationChanged(EventArgs e) {
        if (oldLocation.X != int.MaxValue && this.Owner != null) {
            this.Owner.Location = new Point(
                this.Owner.Left + this.Left - oldLocation.X,
                this.Owner.Top + this.Top - oldLocation.Y);
        }
        oldLocation = this.Location;
        base.OnLocationChanged(e);
    } 
```

# java - 如何告诉休眠使用“更新/删除限制”生成外键约束

> ID：14796369
> 
> 赞同：0
> 
> 时间：2013-02-10T09:34:34.403
> 
> 标签：java, sql, database, hibernate, foreign-keys

Hibernate 在 PostgreSQL 中生成这样的外键约束：

```
 ADD CONSTRAINT fk4027e58ea8b36313 FOREIGN KEY (fk_responsible_person)
      REFERENCES employee (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION; 
```

我想

```
ON UPDATE RESTRICT ON DELETE RESTRICT 
```

我目前的注释：

```
 @ManyToOne(optional = true, fetch = FetchType.EAGER)
  @JoinColumn(name = "fk_responsible_person", updatable = true, nullable = true)
  public Employee getResponsiblePerson()
  {
    return m_responsiblePerson;
  } 
```

我必须使用什么样的配置/注释来获得“限制”而不是“不采取行动”？

# javascript - 通过 onload 在画布上绘制文本时，文本呈颗粒状/模糊

> ID：14796370
> 
> 赞同：4
> 
> 时间：2013-02-10T09:35:00.010
> 
> 标签：javascript, html, canvas

如果我尝试在 onload 事件中将文本绘制到画布上，文本会显示模糊。我稍后通过另一个功能的按钮单击绘制到同一个画布，这很好。但是如果我从按钮调用这个函数，它仍然是模糊的。有人能看出这段代码有什么问题吗？

```
window.onload = initCanvasRender;

function initCanvasRender() {
  var c = document.getElementById("canvas");
  var ctx = c.getContext('2d');
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillStyle = 'black';
  ctx.font = '20px Times New Roman';
  ctx.fillText('hello...', c.width/2, c.height/2);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:00:34.520

可能有一些问题

```
ctx.fillText('hello...', c.width/2, c.height/2); 
```

因为如果您例如使用 css 设置画布的宽度，那么`c.width`并且`c.height`将是画布的默认大小，即 300x150，而不是在 css 中定义的大小。尝试为应用程序的全局宽度和高度设置两个变量。例如

```
var canvasWidth = 400;
var canvasHeight = 200;
c.width = canvasWidth;
c.height = canvasHeight;
/* ... */ 
```

然后稍后在您的代码中您可以使用`canvasWidth`and `canvasWeight`：

```
ctx.fillText('hello...', canvasWidth/2, canvasHeight/2); 
```

看看这个测试： http: [//jsfiddle.net/EsQfb/7/](http://jsfiddle.net/EsQfb/7/)在你的情况下使用`canvas.width`而不是使用很重要`canvas.style.width`。

看看这个以获取更多信息：http: [//www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width)

# c++ - Visual Studio 2012 Express - 图像不会被编译/复制

> ID：14796372
> 
> 赞同：4
> 
> 时间：2013-02-10T09:35:23.700
> 
> 标签：c++

也许这里有人可以帮助我。我是一名业余程序员，主要在 C# 方面有经验。

过去几天我开始更多地研究 C++，但遇到了一个我无法弄清楚的问题。我正在为 Windows 桌面使用 Microsoft Visual Studio 2012 Express。

每当我通过解决方案资源管理器将图像（jpg、png、bmp）等资源添加到我的解决方案时，它们都不会被复制到硬盘驱动器上的解决方案文件夹中。更大的问题是当我编译我的项目时这些图像没有被复制/编译！因此，程序无法运行。如果我手动将文件复制到调试文件夹，在这种情况下，一切正常。我将文件属性中的“内容”属性以及“添加到项目”属性设置为 True。

我这辈子都想不通。:( 在 MS Visual Studio 2010 Express C# 中它总是有效。新版本中我缺少什么吗？

顺便说一句，对不起，如果其中一些没有任何意义。英语不是我的母语，我使用的是德语的 Visual Studio。

希望有人能给我一个答案！

此致，

迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:41:17.530

在解决方案资源管理器中，右键单击文件并选择“属性”。然后将“复制到输出目录”更改为“始终”。可能还将“构建操作”更改为“内容”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-28T05:16:22.770

我在 Visual Studio 2013 中的 C++ 项目中遇到了同样的问题。我找不到“如果更新则复制”或“始终复制”选项。如果 C++ 中有一个，请告诉我。

为了解决这个问题，我编辑了 [Projectname].vcxproj 文件。

寻找这样的一行：

```
<None Include="./yourcontentfile.dll" /> 
```

或者

```
<Content Include="./yourcontentfile.dll" /> 
```

将该行更改为以下内容：

```
<None Include="./yourcontentfile.dll">
  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</None> 
```

或者

```
<Content Include="./yourcontentfile.dll">
  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</Content> 
```

这将在您构建时将该文件复制到输出目录。

# python - 将 Popen() 与 env 一起使用时如何使“adb 设备”工作

> ID：14796376
> 
> 赞同：0
> 
> 时间：2013-02-10T09:36:20.120
> 
> 标签：python, subprocess, adb, popen

原始代码在[这里](https://stackoverflow.com/questions/14779146/how-can-i-get-the-info-in-cmd-when-i-set-adb-trace-adb/)

```
import subprocess as sp

cmd = ["adb","push","file","/mnt/sdcard/file"]
mysp = sp.popen(cmd, env={'ADB_TRACE':'adb'}, stdout=sp.PIPE, stderr=sp.PIPE)
stdout,stderr = mysp.communicate()

if mysp.returncode != 0:
    print stderr
else:
    print stdout 
```

没有`env={'ADB_TRACE':'adb'}`.

用 env 变量执行任何命令`adb`，我得到一个错误：

```
ADB server didn't ACK
* failed to start daemon *
error: cannot connect to daemon 
```

杀死 adb 服务器后似乎不起作用

整个输出在[这里](http://pastebin.com/CxbByGDW)

操作系统：win7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:46:13.550

我怀疑 adb 还需要其他环境变量（例如`$HOME`）。您应该克隆现有环境并添加`ADB_TRACE`到其中。

```
import os
new_env = os.environ.copy()
new_env['ADB_TRACE'] = 'adb'

# sp.popen() 
```

从文档：

```
If env is not None, it must be a mapping that defines the environment variables
for the new process; these are used instead of inheriting the current process’
environment, which is the default behavior. 
```

编辑：

看来，这与环境本身无关。相反，如果`ADB_TRACE`设置了 adb 服务器，则会损坏。尝试在没有`ADB_TRACE`.

# python - Ruby 删除以 '.' 结尾的单词

> ID：14796378
> 
> 赞同：-1
> 
> 时间：2013-02-10T09:36:41.697
> 
> 标签：python, ruby

我希望删除一系列名称中的所有中间首字母。我发现我可以用 Python 做到这一点，所以我想我会在 Rruby 中尝试它。在 Python 中，我可以使用 endswith 命令删除*csv 文件*中的所有中间首字母，因为它们是唯一以“。”结尾的项目。

例子

```
steve A. walkins

michael todd

Angel, Blair C. 
```

并非所有名称都遵循固定模式，但所有中间名首字母都遵循。因此，为了自学一些红宝石，试图找出我可以在 python 中完成的功能的等效命令和用法。

我的示例 Python 代码适用于此。

```
 print ' '.join(i for i in name.split(' ') if not i.endswith('.')) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:42:43.460

不要假装我的答案比 Ivaylo Strandjev 建议的要好，但如果你想要一个将你的 python 代码“翻译”为 ruby​​ 的 oneliner：

```
name.split.select{|t| !t.end_with?('.')}.join(' ') 
```

或者，更清晰（感谢@ŁukaszNiemier）

```
name.split.reject{|t| t.end_with?('.')}.join(' ') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:45:56.623

在 ruby​​ 中有一个方法`end_with?`。

这是一些示例 ruby​​ 代码来执行您想要的操作：

```
def remove_initial name
   names = name.split
   names.select{|t| !t.end_with?(".")}.inject{|a,b| a + " " + b}
end 
```

和一个简短的解释：

第一行`name.split`使用默认的空格分隔符简单地拆分名称。

`names.select{|t| !t.end_with?(".")}`将仅过滤不以 a 结尾的名称，`.`然后`inject{|a,b| a + " " + b}`将累积剩余的名称，并在它们之间添加一个空白。

# xml - 如何根据 XPath 中的另一个元素属性值查找元素值

> ID：14796379
> 
> 赞同：3
> 
> 时间：2013-02-10T09:36:55.523
> 
> 标签：xml, xpath

我正在尝试学习 XPath，但发现它很困难，因为我正在谷歌上搜索它。这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
    <details>
        <signature id="sig1">
            <name>mr. Barry Smith</name>
            <telephone type="fixed">01234 123456</telephone>
            <telephone type="mobile">071234562</telephone>
        </signature>

        <signature id="sig2">
            <name>mr. Harry Smith</name>
            <telephone type="fixed">01234 123456</telephone>
        </signature>
    </details> 
```

我怎样才能找到有手机的人的名字，我可以得到一个或两个，但不能同时得到。

我一直在尝试这样的事情：

```
staffdetails/signature/telephone[@type='mobile']name 
```

另外，是否有使用 XPAth 的参考指南，以便我可以轻松找出我想要的任何查询？使用我找到的在线教程解释了 XPath 的工作原理，但这些示例还不够全面。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T13:59:16.643

这里不需要使用`following-sibling::`或嵌套谓词。只需这样做：

```
/details/signature[telephone/@type = 'mobile']/name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:44:47.497

这应该有效：

```
//signature/name[following-sibling::telephone[@type='mobile']] 
```

内容如下：

> 选择任何`name`具有`signature`父级和`telephone`兄弟级的`type`= `mobile`。

关于参考，我实际上从[规范中的示例](http://www.w3.org/TR/xpath/#path-abbrev)中学到了最多！

# python - 如果循环中有循环，如何中断程序？

> ID：14796382
> 
> 赞同：0
> 
> 时间：2013-02-10T09:37:20.087
> 
> 标签：python, loops

我一直在尝试在 Python 上制作对数计算器。我离完成它只有一步之遥。这是代码：

```
import math
print("Welcome to logarithm calculator")

while True:
    try:
        inlog = int(input("Enter any value greater than zero to lookup its logarithm to    the base 10\n"))
        outlog = math.log(inlog, 10)
        print(outlog)

        # Here, the program will ask the user to quit or to continue
        print("Want to check another one?")
        response = input("Hit y for yes or n for no\n")

        if response == ("y" or "Y"):
            pass
        elif response == ("n" or "N"):
            break
        else:
            #I don't know what to do here so that the program asks the user to quit or continue if the response is invalid?

    except ValueError:
        print("Invalid Input: Make sure your number is greater than zero and no alphabets. Try Again.") 
```

在 else 语句之后，我希望程序要求用户一次又一次地响应，直到它是一个有效的响应，如“y”或“Y”和“n”或“N”。如果我在这里添加另一个 while 循环，如果用户输入“y”，它会很好地使用 pass 语句。但是当用户响应为“n”时它不会破坏程序，因为它会使我们陷入外循环。那么如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T09:49:02.060

您可以将该测试移至不同的功能：

```
def read_more():
    while True:
        print("Want to check another one?")
        response = input("Hit y for yes or n for no\n")

        if response == ("y" or "Y"):
            return True
        elif response == ("n" or "N"):
            return False
        else:
            continue 
```

然后在你的函数中，只测试这个方法的返回类型：

```
while True:
    try:
        inlog = int(input("Enter any value greater than zero to lookup its logarithm to    the base 10\n"))
        outlog = math.log(inlog, 10)
        print(outlog)

        if read_more():
            continue
        else:
            break 
```

请注意，如果用户继续输入错误的输入，您可以进入无限循环。您可以限制他最多尝试一些最大尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:49:50.180

你可以这样做：

```
stop=False
while True:
    try:
        inlog = int(input("Enter any value greater than zero to lookup its logarithm to    the base 10\n"))
        outlog = math.log(inlog, 10)
        print(outlog)

        # Here, the program will ask the user to quit or to continue
        print("Want to check another one?")

        while True:
            response = input("Hit y for yes or n for no\n")
            if response == ("y" or "Y"):
                stop = False
                break
            elif response == ("n" or "N"):
                stop = True
                break
            else:
                continue
        if stop:
            break
except ValueError:
        print("Invalid Input: Make sure your number 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T09:41:42.460

您可以在初始值为“false”的值之外定义一个布尔参数。在外循环的每次运行开始时，您可以检查此布尔值，如果为真，则也中断外循环。之后，当你想在内循环内结束外循环时，只需在打破内循环之前将值设为真。这样外循环也会中断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T09:51:40.927

试试这个：

```
import math
class quitit(Exception):
    pass
print("Welcome to logarithm calculator")

while True:
    try:
        inlog = int(input("Enter any value greater than zero to lookup its logarithm to    the base 10\n"))
        outlog = math.log(inlog, 10)
        print(outlog)

        # Here, the program will ask the user to quit or to continue
        print("Want to check another one?")
        while True: 
            response = input("Hit y for yes or n for no\n")
            if response == ("y" or "Y"):
                break
            elif response == ("n" or "N"):
                raise quitit
except quitit:
        print "Terminated!"        
except ValueError:
        print("Invalid Input: Make sure your number is greater than zero and no alphabets. Try Again.") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T10:03:04.407

如果用户输入一个小于或等于零的数字，这将产生一个您没有考虑到的异常。

就跳出循环而言，它不是太嵌套以至于您不能已经跳出。如果您有更深的嵌套，那么我建议您使用以下模板来打破嵌套循环。

```
def loopbreak():
  while True:
    while True:
      print('Breaking out of function')
      return
  print('This statement will not print, the function has already returned') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T11:29:41.770

```
stop=False
while not stop:
    try:
        inlog = int(input("Enter any value greater than zero to lookup its logarithm to the base 10\n"))
        outlog = math.log(inlog, 10)
        print(outlog)

        # Here, the program will ask the user to quit or to continue
        print("Want to check another one?")

        while True:
            response = raw_input("Hit y for yes or n for no\n")
            if response == ("y" or "Y"):
                break
            elif response == ("n" or "N"):
                stop = True
                break
    except ValueError:
        print("Invalid Input: Make sure your number") 
```

# ruby-on-rails - 动态创建复选框

> ID：14796383
> 
> 赞同：1
> 
> 时间：2013-02-10T09:37:51.717
> 
> 标签：ruby-on-rails, arrays, ruby-on-rails-3, forms, checkbox

我想使用用户数组在表单中动态创建复选框。应该保存到数组中的值 (param[:project][:members]) 应该包含用户单击的所有复选框中的 user_id。

我一直在四处寻找，但还没有找到我要找的东西。

我应该为复选框编写什么代码？

**视图中的表格：**

```
<%= form_for @project do |f| %>
    <div class="text_field">
        <%= f.label :title%>
        <%= f.text_field :title%>
    </div>
    <div class="text_field">
        <%= f.label :description%>
        <%= f.text_field :description%>
    </div>
    <div class="dropdown">
        <%= f.label :start_date%>
        <%= f.date_select :start_date %>
    </div>
    <div class="dropdown">
        <%= f.label :end_date%>
        <%= f.date_select :end_date %>
    </div>
    <div class="checkboxes">
        <% @users.each do |user| %>
            // <%= check_box_tag "users[]", user.id %> <--- ???
        <% end %>
    </div>
    <div class="submit">
        <%= f.submit "Spara" %>
    </div>
<% end %> 
```

**控制器：**

```
def new
  @project = Project.new
  @users = (current_user.blank? ? User.all : User.find(:all, :conditions => ["id != ?", current_user.id]))
end 
```

**呈现的html：**

```
[ ] Jules Smith    // user_id: 1
[X] Carl Jones     // user_id: 2 
[X] Lily Stevens   // user_id: 3

// param[:project][:members] // <-- 2, 3 (user_id's) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:23:42.137

```
<% @users.each do |user| %>
    <%= check_box_tag "project[members][]", user.id, checked_or_not, :id => "user_#{user.id}" %> 
    <%= label_tag "user_#{user.id}", user.name_login_or_smth_else %>
<% end %> 
```

替换`checked_or_not`为指示 user.id 已在成员数组中的代码。例如，如果您`has_and_belongs_to_many`像这样设置项目和用户之间的关系：

```
class Project < ActiveRecord::Base
    has_and_belongs_to_many :members, :class_name => 'User'
end 
```

那么形式将是：

```
<% @users.each do |user| %>
    <%= check_box_tag "project[member_ids][]", user.id, @project.member_ids.include?(user.id), :id => "user_#{user.id}" %> 
    <%= label_tag "user_#{user.id}", user.name_login_or_smth_else %>
<% end %> 
```

更新：

check_box_tag 的第二个参数`user.id`是复选框的值，第三个`@project.member_ids.include?(user.id)`是复选框是否选中。[你可以在这里](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-check_box_tag)阅读更多关于它的信息。

has_and_belongs_to_many 添加`collection_ids`了返回所有关联对象 id 数组的方法。由于我们要命名关联`members`，因此我们正在使用以下选项设置关联`class_name`：

```
has_and_belongs_to_many :members, :class_name => 'User' 
```

和`collection_ids`方法变成`member_ids`. 因此`@project.member_ids.include?(user.id)`，如果成员已经包含用户，则设置复选框，否则不选中。

从另一个你的问题我可以假设你设置这样的关联：

```
has_and_belongs_to_many :users 
```

然后它将添加`user_ids`方法和您应该使用的形式

```
check_box_tag "project[user_ids][]", user.id, @project.user_ids.include?(user.id) 
```

您可以阅读[此处](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_and_belongs_to_many)了解详细信息。

# powershell - get-childitem 中的递归标志作为字符串

> ID：14796384
> 
> 赞同：1
> 
> 时间：2013-02-10T09:37:59.720
> 
> 标签：powershell

我正在尝试学习一点 Powershell，并且一直在将一个长存档脚本从 Dos 转换为 Powershell。这一直很好，但现在我正在探索重写以下部分的选项，如果 xml 文档中的字段 Recursive 为真，get-childitem 必须使用 -Recurse 标志。如果我能在一句话中做到这一点，那将是很好的，有什么想法吗？：

```
if ($parameter.Recursive -eq "true")
        { $items = Get-ChildItem $parameter.ProcesDir -Recurse | where {!$_.PsisContainer -and $_.CreationTime -lt (get-date).adddays(-$parameter.Retention)}} 
    else 
        { $items = Get-ChildItem $parameter.ProcesDir | where {!$_.PsisContainer -and $_.CreationTime -lt (get-date).adddays(-$parameter.Retention)}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:00:26.307

这是一种方法：

```
$recurse = if($parameter.Recursive -eq "true") {$true} else {$false}

$items = Get-ChildItem $parameter.ProcesDir -Recurse:$recurse | 
where {!$_.PsisContainer -and $_.CreationTime -lt (get-date).adddays(-$parameter.Retention)} 
```

# c++ - 使用 glPointSize 的像素宽度 - 无效

> ID：14796387
> 
> 赞同：6
> 
> 时间：2013-02-10T09:38:13.713
> 
> 标签：c++, c, visual-c++, opengl

我有这个代码滴点。我想增加点大小。现在我使用这个命令`glPointSize`但没有任何反应。磅值是默认值。它不会增加。
如何增加我的点数？

```
glBegin(GL_POINTS);

glColor3f (a, b, c);
glPointSize(20.0f); 

glVertex2i(px, py);
glEnd(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-10T09:42:55.050

`glPointSize(20.0f);`必须放在前面 `glBegin()`，否则不会有任何效果。像这样做：

```
glPointSize(20.0f); 

glBegin(GL_POINTS);
   glColor3f (a, b, c);
   glVertex2i(px, py);
glEnd(); 
```

在 OpenGL[文档](http://www.talisman.org/opengl-1.1/Reference/glBegin.html)中，您可以阅读：

> 在 glBegin 和 glEnd 之间只能使用 GL 命令的子集。这些命令是 glVertex、glColor、glIndex、glNormal、glTexCoord、glEvalCoord、glEvalPoint、glArrayElement、glMaterial 和 glEdgeFlag。此外，可以使用 glCallList 或 glCallLists 来执行仅包含上述命令的显示列表。如果在 glBegin 和 glEnd 之间执行了任何其他 GL 命令，则设置错误标志并忽略该命令。

# linq - 无法隐式转换类型'System.Collections.Generic.IEnumerable ' 到 'System.Linq.IQueryable'

> ID：14796389
> 
> 赞同：0
> 
> 时间：2013-02-10T09:38:39.913
> 
> 标签：linq

我想定义一个包含 Linq 查询的函数，如下所示：

```
public IQueryable GetBasket(Guid userId)
{
    DabbaghanDataContext db = new DabbaghanDataContext();

    int rowNo = 0;
    var query = (from c in db.Carts
                 join co in db.CartOrders on c.Id equals co.Cart_Id
                 join p in db.Products on co.Product_Id equals p.Id
                 where c.UserId == userId && c.Issued == false
                 select new
                 {
                     co.Quantity,
                     co.TotalPrice,
                     p.Code,
                     p.Price,
                     p.Thumbnail
                 }).AsEnumerable().Select(r => new
                 {
                     RowNumber = ++rowNo,
                     Quantity = r.Quantity,
                     TotalPrice = r.TotalPrice,
                     Code = r.Code,
                     Price = r.Price,
                     Thumbnail = r.Thumbnail
                 });

    return query;
} 
```

我收到错误

> *无法将类型“System.Collections.Generic.IEnumerable”隐式转换为“System.Linq.IQueryable”。*

上`return query`线。

问题是什么？我怎么解决这个问题？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:41:28.847

你的问题是调用 `AsEnumerable`- 它转换`IQueryable`为 a `IEnumerable`; 因此，您不能将其作为`IQueryable`.

如果我错了，请纠正我，但第二次选择似乎只将行号添加到结果中。您不妨与初始选择一起执行此操作，并跳过对`AsEnumerable()`.

可能的解决方案：将查询重写为不使用`AsEnumerable`（如果您想要`IQueryable`返回），或者您可以将返回类型更改为`IEnumerable`，如果这更适合您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T16:01:18.007

在返回查询；将其更改为返回 query.AsQueryable(); 并尝试更改方法签名以使用 IQueryable 而不是非泛型的

# scala - 找不到 scala.reflect.ClassManifest[T] 类型的证据参数的隐式值

> ID：14796390
> 
> 赞同：19
> 
> 时间：2013-02-10T09:38:48.017
> 
> 标签：scala, types

看来我不明白一些重要的事情，也许是关于擦除（该死）。

我有一个方法，我想创建一个大小数组，其中`n`填充了以下值`gen`：

```
def testArray[T](n: Int, gen: =>T) {
  val arr = Array.fill(n)(gen)
  ...
} 
```

并使用它，例如：

```
testArray(10, util.Random.nextInt(10)) 
```

但我得到错误：

```
scala: could not find implicit value for evidence parameter of type scala.reflect.ClassManifest[T]
val arr = Array.fill(n)(gen)
                       ^ 
```

请解释我做错了什么，为什么会出现这个错误，以及它使什么样的代码变得不可能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T10:14:59.473

那是因为在编译时不知道`testArray`具体类型。`T`您的签名必须看起来像`def testArray[T : ClassManifest](n: Int, gen: =>T)`，这将为您的方法添加一个类型的隐式参数，该参数`ClassManifest[T]`会自动传递给调用，`testArray`然后进一步传递给`Array.fill`调用。这称为`context bound`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-10T12:19:10.997

该`Array.fill`方法具有以下签名：

```
def fill[T](n: Int)(elem: => T)(implicit arg0: ClassManifest[T]): Array[T] 
```

为了获得一个实例，`ClassManifest[T]`您需要知道具体类型。A`ClassManifest`可以这样获得：

```
implicitly[ClassManifest[String]] 
```

A`ClassManifest`对于每种具体类型都是隐式可用的。

对于任何`implicit`错误，您可以使用 type 参数将所需的隐式添加到方法中：

```
def wrap[T](n:Int)(elem: => T)(implicit c:ClassManifest[T], o:Ordering[T]) 
```

如果您自己没有介绍`ClassManifest`or `Ordering`，那么库的作者（很可能）为您提供了合理的默认值。

如果您要调用该`wrap`方法：

```
wrap(2)(3) 
```

它是这样展开的：

```
wrap[Int](2)(3)(implicitly[ClassManifest[Int]], implicitly[Ordering[Int]]) 
```

如果你`Person`在这里引入了一个自定义类，你会因为找不到`Ordering[Person]`. 图书馆的作家不可能知道如何订购`Person`。你可以这样解决：

```
class Person

implicit val o = new Ordering[Person] { // implement required methods }

wrap(2)(new Person) 
```

Scala 编译器在不同的范围内寻找隐式，`Ordering`通常不会像这样指定。我建议您在互联网上查找隐式分辨率以了解更多信息。

# c++ - 如何从函数指针和参数调用c++中的函数

> ID：14796393
> 
> 赞同：2
> 
> 时间：2013-02-10T09:39:02.023
> 
> 标签：c++, function-pointers, invoke

我想通过具有未知参数的函数指针调用函数。存储输入参数和函数并稍后运行。`call_user_func_array`像在php中的一些东西

例如：

```
// example function definition
void foo(int arg1, const char *arg2,const char *arg3){
    //some other code
}
void bar(int arg1, int arg2){
    //some other code
}

// function definition
void store_function_call(int param,void *function,... args){
    // store param , function, and other arguments
    // in php save to global variable for use later
}
void call_later(){
    // execute stored param, function, arguments
    // in PHP use call_user_func_array
}
// use:
int main(){
    store_function_call(10,bar,4,5);
    // store_function_call(5,foo,5,"yyy","sss");

    call_later();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:57:30.690

您可以通过一些模板元编程来完成您在 C++11 中尝试做的事情：

```
#include <tuple>
#include <iostream>

template<int ...> struct seq {};
template<int N, int ...S> struct gens : gens<N-1, N-1, S...> {};
template<int ...S> struct gens<0, S...>{ typedef seq<S...> type; };

double foo(int x, float y, double z) {
  return x + y + z;
}

template <typename R, typename ...Args>
struct save_it_for_later {
  std::tuple<Args...> params;
  R (*func)(Args...);

  R call_later() {
    return callFunc(typename gens<sizeof...(Args)>::type());
  }

  template<int ...S>
  R callFunc(seq<S...>) {
    return func(std::get<S>(params) ...);
  }
};

template <typename R, typename ...Args>
save_it_for_later<R, Args...> store_function_call(R (*func)(Args...), Args&& ...args) {
  return save_it_for_later<R, Args...>{std::tuple<Args...>(std::forward<Args>(args)...), func};
}

int main() {
  auto saved = store_function_call(foo,1,1.f,1.);
  std::cout << saved.call_later() << "\n";
} 
```

[此答案已修改以匹配您从这个答案到我问的类似问题](https://stackoverflow.com/a/9288547/168175)的场景。我添加了返回类型推导和一个助手来将类型推导为您的`store_function_call`.

（我会使用[`std::forward_as_tuple`](https://stackoverflow.com/a/7867285/168175)而不是笨重的元组构造函数+前向构造，但我测试的编译器没有那个）

# c++ - 如何使用 STM32 MCU 生成 REAL 随机数？

> ID：14796398
> 
> 赞同：7
> 
> 时间：2013-02-10T09:39:39.153
> 
> 标签：c++, random, embedded, microcontroller, stm32

我正在使用 keil microvision IDE 中的 STM32F103E arm cortex-m3 MCU 进行项目。
我需要为某些目的生成随机数，但我不想使用标准 C++ 库正在生成的伪随机数，所以我需要一种使用硬件功能生成 REAL 随机数的方法，但我不知道如何我能做到。
任何的想法？（我是软件工程师而不是电子专业人士，所以请简单描述一下：P）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-10-10T19:14:55.383

这是我刚刚遇到的一个老问题，但我想回答，因为我不觉得其他答案令人满意。

“我需要随机数来生成 RSA 密钥。”

这意味着 PRNG 例程（经常被错误地称为 RNG，我的一个小毛病）是不可接受的，并且不会提供所需的安全性。

外部真正的 RNG 是可以接受的，但最优雅的答案是切换到 STM32F2xx 或 STM32F4xx 微控制器，它具有内置的 TRUE 随机数发生器，专门用于此类应用。对于开发，我想你可以使用 thr F1 和任何 PRNG，但是在使用真正的 RNG 之前会有“它有效，让我们发货”的诱惑，当 RIGHT 组件（当然是 ST F4，我认为自从提出这个问题之前，F2 芯片也已经存在）可用。

由于非技术原因，这个答案可能是不可接受的（芯片已经指定，OP 没有输入所需的功能），但是选择芯片的人应该根据应用程序所需的片上外围设备和功能来选择它.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-10T11:13:27.753

正如所指出的，该芯片没有硬件 RNG。

但是你可以自己滚动。通常的方法是测量独立时钟之间的抖动。独立意味着这两个时钟由不同的 christals 或 RC 振荡器支持，而不是源自相同的。

我会使用：

*   SysTick 定时器/计数器源自系统时钟（MHz 范围）
*   kHz 范围 RC 振荡器之一

在 kHz 范围的 RC 振荡器上设置一个计数器，以每秒为您提供多次中断。在中断处理程序中，您读取 SysTick 计数器的当前值。无论 SysTick 是否用于其他目的（调度），低 5 位左右都是不可预测的。

要从中获取随机数，请使用普通的伪 RNG。使用上面收集的熵来不可预测地改变伪 RNG 的内部状态。对于密钥生成，不要一次读取所有位，而是允许发生几个突变。

对此的攻击是显而易见的：如果攻击者可以测量或控制高达 MHz 精度的 kHz 范围 RC 振荡器，那么随机性就会消失。如果您对此感到担心，请使用智能卡或其他安全协处理器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-10T10:06:22.243

F1 系列似乎没有 RNG（硬件随机数生成器），因此您唯一的选择是使用伪随机数或询问外部输入（有些人认为例如人手运动随机）。您经常使用一些加密库而不是标准 C++ 库来获得更好的伪随机数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-11T16:47:48.450

我发现并测试了另一种方法，效果很好。它可以生成真正的随机 32 位数字，我从未检查过它有多快，每个数字可能需要几毫秒。这是怎么回事：

*   以尽可能快的速度读取嘈杂的内部温度，以产生最大的 ADC 噪声
*   通过硬件 CRC 生成器运行值，大多数（全部？）STM32 芯片上都可用

重复几次，我发现 8 次给出了很好的随机性。我通过按升序对输出值进行排序并将它们绘制在 excel 中来检查随机性，使用好的随机数会生成一条直线，糟糕的随机性或某些数字的“聚集”立即可见。这是STM32F03的代码：

```
uint32_t getTrueRandomNumber(void) {

ADC_InitTypeDef ADC_InitStructure;

//enable ADC1 clock
RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC1, ENABLE);

// Initialize ADC 14MHz RC
RCC_ADCCLKConfig(RCC_ADCCLK_HSI14);
RCC_HSI14Cmd(ENABLE);
while (!RCC_GetFlagStatus(RCC_FLAG_HSI14RDY))
    ;

ADC_DeInit(ADC1);
ADC_InitStructure.ADC_ContinuousConvMode = DISABLE;
ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right;
ADC_InitStructure.ADC_Resolution = ADC_Resolution_12b;
ADC_InitStructure.ADC_ScanDirection = ADC_ScanDirection_Backward;
ADC_InitStructure.ADC_ExternalTrigConvEdge = ADC_ExternalTrigConvEdge_None;
ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_T1_TRGO; //default
ADC_Init(ADC1, &ADC_InitStructure);

//enable internal channel
ADC_TempSensorCmd(ENABLE);

// Enable ADCperipheral
ADC_Cmd(ADC1, ENABLE);
while (ADC_GetFlagStatus(ADC1, ADC_FLAG_ADEN) == RESET)
    ;

ADC1->CHSELR = 0; //no channel selected
//Convert the ADC1 temperature sensor, user shortest sample time to generate most noise
ADC_ChannelConfig(ADC1, ADC_Channel_TempSensor, ADC_SampleTime_1_5Cycles);

// Enable CRC clock
RCC_AHBPeriphClockCmd(RCC_AHBPeriph_CRC, ENABLE);

uint8_t i;
for (i = 0; i < 8; i++) {
    //Start ADC1 Software Conversion
    ADC_StartOfConversion(ADC1);
    //wait for conversion complete
    while (!ADC_GetFlagStatus(ADC1, ADC_FLAG_EOC)) {
    }

    CRC_CalcCRC(ADC_GetConversionValue(ADC1));
    //clear EOC flag
    ADC_ClearFlag(ADC1, ADC_FLAG_EOC);
}

//disable ADC1 to save power
ADC_Cmd(ADC1, DISABLE);
RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC1, DISABLE);

return CRC_CalcCRC(0xBADA55E5); 
```

}

# php - PHP 结构化技术

> ID：14796400
> 
> 赞同：-4
> 
> 时间：2013-02-10T09:39:45.490
> 
> 标签：php, optimization

我正在用 PHP 编写一个网站，其目的是允许用户输入一些月度数据，这些数据存储在 MySQL 中，并且在任何时候用户都可以查看统计数据以处理那里的数据。我已经完成了所有基础知识，但是我的代码完全不可读，它是大量的 if 语句，没有明显的结构，即使带有注释，它也是相当不透明的。我应该如何优雅地构建我的代码，以及我应该以什么方式利用 PHP 的 OOP 特性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:53:11.410

我建议阅读代码内聚和松散耦合，如果您要构建出色的、可维护的应用程序，这些都是您需要熟悉的重要概念。

您还应该了解设计模式和常见用例，如果不是全部的话 - 至少是 IMO 中的大型案例：单例、工厂、DI 和 IoC（您可以全面了解这些）。

一旦你有了理论思考，你应该开始以一种行业标准的方式编写你的代码，对于 PHP 来说就是 MVC——你可以使用一个框架，只要你学会了一个框架 - 阅读大量其他项目的代码将非常容易，因为它通常遵循相同的模式，其中一些写得比其他更好。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:53:50.503

您需要一个框架来构建您的代码。幸运的是，这个问题已经被许多人解决了。CodeIgniter、Cake、Zend、Kohana、Symfony、Yii、Slim、Laravel、Fuel，不胜枚举。

我强烈建议您将[CodeIgniter](http://ellislab.com/codeigniter)作为您的第一个 PHP 框架。文档和社区都是首屈一指的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:16:17.717

嗯..我只能告诉你我通常做什么，而不是它是否是“最好”的方式或者是否有更透明的工作流程......只是它对我很有效;）

第一件事，也是最重要的：摆脱 php 中的所有非 php 代码，对于 html 显示使用模板，要么自己制作模板系统，要么得到一个现成的（例如聪明的）。

尝试识别您经常使用的结构（如 sql 连接和访问）并将它们放入类文件中（如果需要，您可以轻松更改 sql 系统，只需编辑一个文件，而不是无数其他文件）现在找到重复的代码流（大部分相同的 if-else-structures 等）并为它们创建函数以用所述函数替换原始代码。甚至可能为属于某个任务的函数创建更多类。

所以你最终会得到一个用于 db 的类，一个用于用户信息和编辑，一个用于添加、编辑和删除信息，还有一个用于 html 输出（甚至更多）

现在相应地设置您的文件系统（将类文件放入子文件夹，将模板放入另一个文件夹，对于图像，javascripts etc.pp 也是如此）

下一步：查找所有“设置”所有可能需要更改的预定义值，并将它们放入设置文件（例如 init.php）中，甚至可以作为类构造。

作为最后一部分，清理你无法进一步减少的单个 phps 中的所有混乱。首先：所有设置，包括您需要设置的文件（类）定义此脚本所需的常量等。其次：所有脚本功能按字母顺序或逻辑顺序。最后是代码流。

就是这样（很多工作......）但你最终会得到一个我觉得易于维护的结构。如果您需要编辑设置，而不是 init.php 中的设置，您想更改一些数据库结构或更改您的数据库，那么您只需要更新您的 sql.php 等。

如果其他人也必须维护代码，您很可能也必须正确注释每个文件，我个人也为自己使用注释，因为我有一些脚本需要在五年或更长时间后更改，这样我仍然知道去哪里;）

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T09:43:49.807

你可以使用某种 PHP 框架，例如 Yii、Zend、Symfony 或 Kohana。MVC 分离将是你的好朋友。

# jquery - jQuery执行顺序

> ID：14796405
> 
> 赞同：1
> 
> 时间：2013-02-10T09:40:31.150
> 
> 标签：jquery

我想知道为什么在我的示例 #1 中，警报以正确的顺序 1、2 触发，但在示例 #2 中，我添加了一个 ajax 调用，触发顺序然后变为 2,1。也有人可以建议如何使用 ajax 调用来实现所需的 1、2 触发顺序......我很难过。

示例 #1

```
uploader.bind('BeforeUpload', function (up, file, policy, sinature) {
    //alert('1');

    test();
    function test() {
        alert('1');
    }
});

uploader.bind('UploadFile', function (up, file, policy, signature) {
    test2();
    function test2() {
        alert('2');
    }
}); 
```

示例 #2

```
uploader.bind('BeforeUpload', function (up, file, policy, sinature) {
    //alert('1');

    test();
    function test() {
        data = { alc: 'private', bucket: 'PhotojimaDev', file: file.name, key: path };
        $.ajax({
            url: sf.getServiceRoot('photojima') + "Upload/getPolicy",
            type: 'POST',
            data: data,
            beforeSend: sf.setModuleHeaders
        }).done(function (response, status) {
            if (status == "success") {
                policy = response.policy;
                signature = response.signature;
                alert('1');
            }
        }).fail(function (xhr, result, status) {
            alert("Uh-oh, something broke: " + status);
        });
    }
});

uploader.bind('UploadFile', function (up, file, policy, signature) {
    test2();
    function test2() {
        alert('2');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:50:00.163

ajax in`BeforeUpload`创建了一个非阻塞后台工作程序，显然直到之后才完成`UploadFile`

如果您需要`BeforeUpload`先完成，那么您必须`$.ajax`通过添加来告诉不要异步运行`async = false`

```
function test() {
    data = { alc: 'private', bucket: 'PhotojimaDev', file: file.name, key: path };
    $.ajax({
        async: false,
        url: sf.getServiceRoot('photojima') + "Upload/getPolicy",
        type: 'POST',
        data: data,
        beforeSend: sf.setModuleHeaders
    }).done(function (response, status) {
        if (status == "success") {
            policy = response.policy;
            signature = response.signature;
            alert('1');
        }
    }).fail(function (xhr, result, status) {
        alert("Uh-oh, something broke: " + status);
    });
} 
```

在手册中搜索异步：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:42:44.753

`ajax`默认情况下是异步的，所以发送一个 ajax 请求，然后执行之后的代码，
所以在第二种情况下你得到 2 , 1
因为只有当 ajax 请求 a 时才会触发 1`success response`

要获得所需的 1,2 执行，您可以从成功处理程序中调用函数 test2()
或者
只是使 ajax 请求同步。这可以`async to false`在发送 ajax 请求时进行设置。但不推荐

# java - Spring 3.2 mvc 测试发布请求

> ID：14796408
> 
> 赞同：3
> 
> 时间：2013-02-10T09:40:54.793
> 
> 标签：java, spring-mvc

从春季教程..

```
MvcResult mvcResult = 
mockMvc.perform(post("/person")).andExpect(status().isOk()).andReturn(); 
```

这很好，但如果我的控制器有签名

```
@RequestMapping(value = "/person", method = RequestMethod.POST)
public String postPerson(Person person) {} 
```

其中 person 是一个简单的 DTO，通常通过 jsp 中的 spring 表单填充（例如两个字符串字段和 getter/setter）；如何在测试中提交该数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T11:04:09.490

假设类`Person`具有属性`name`和`age`.

在构建您的请求时，您可以这样做：

```
post("/person")
  .param("name", "John")
  .param("age", "45") 
```

# c++ - Extreme Confusion on Forks and Execlp

> ID：14796410
> 
> 赞同：0
> 
> 时间：2013-02-10T09:41:19.373
> 
> 标签：c++, linux, operating-system, fork, exe

this is my first post. I have a task to use a fork to create multiple processes and then use execlp to run another program to add 2 numbers.

The problem I am having is we are supposed to use the exit() call in the execlp to return the small integer. This is a bad way to communicate but it's what we are supposed to do for the sake of this program.

Here is my "coordinator" program

```
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <unistd.h>
#include <sys/types.h> 
#include <sys/wait.h> 
#include <stdlib.h>

using namespace std;

int main (int argc,char* argv[])

{
const int size = argc-1;

int sizeArray = 0;

int numofProc =0;

int arrayofNum[size];

int status;

int value;

for(int y=1; y<argc; y++)
{

arrayofNum[y-1] = atoi(argv[y]);

sizeArray++;

}

if(sizeArray % 2 !=0)

{

arrayofNum[sizeArray]  = 0;

sizeArray++;

}

numofProc = sizeArray/2;

//declaration of a process id variable

pid_t pid;

//fork a child process is assigned 

//to the process id

pid=fork();

//code to show that the fork failed

//if the process id is less than 0

if(pid<0)

{

    cout<<"Fork Failed";// error occurred

    exit(-1); //exit

}

//code that runs if the process id equals 0

//(a successful for was assigned

else 

if(pid==0)

{

    //this statement creates a specified child process

     execlp("./worker", "worker", arrayofNum[0], arrayofNum[1]);//child process

}

//code that exits only once a child 

//process has been completed

else

{

waitpid(pid, &status, 0);

cout<<status;

}

//main

} 
```

and here is the execlp process

```
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>

using namespace std;

int main(int argc, char* argv[])

{

int arrayofNum[argc-1];

arrayofNum[0] = atoi(argv[1]);

arrayofNum[1] = atoi(argv[2]);

int sum = arrayofNum[0] + arrayofNum[1];

exit(sum);

} 
```

My problem is NO MATTER WHAT I DO, the status is ALWAYS printing a 0, I do not know how to retrieve the sum that is returned from the worker process.

My professor told me ""Only the higher byte of status will have the value returned by the worker. you need to extract it. It can be done by many ways. ""

In a nut shell, my question is, How do I retrieve that "sum" that is being sent from my worker process.

Please, I am so confused and have been up for 2 nights wondering about this

Thanks,

John

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:45:29.610

First up, you need to pass strings to your program, but you say:

```
execlp("./worker", "worker", arrayofNum[0], arrayofNum[1]); 
```

And `arrayofNum` is an array of integers. Also, with execlp you also need to pass a `NULL` as the last argument. [The standard](http://pubs.opengroup.org/onlinepubs/009695399/functions/exec.html) says:

> The arguments represented by arg0,... **are pointers to null-terminated character strings**. These strings shall constitute the argument list available to the new process image. **The list is terminated by a null pointer**.

Second, after you call to `waitpid(2)` you need to do:

```
if (WIFEXITED(status))
    code = WEXITSTATUS(status); 
```

# powershell - 提示在 powershell 中输入

> ID：14796413
> 
> 赞同：1
> 
> 时间：2013-02-10T09:41:54.420
> 
> 标签：powershell, batch-file, cmd, powershell-2.0

我希望脚本提示选择字符串中的字符串模式。我怎样才能做到这一点 ？

```
$FileExists = (Test-Path C:\Users\v-hshabb\Desktop\text.txt)
echo $FileExists
If (($FileExists)) 
{
echo $FileExists
  Remove-Item C:\Users\v-hshabb\Desktop\text.txt
}

GET-CHILDITEM  -recurse C:\Enlistment\DAX62\source\*| SELECT-STRING -pattern "@GLS150005"    >text.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:47:17.903

在调用 Get-ChildItem 之前使用 Read-Host。

```
$pattern = Read-Host
gci -recurse C:\Enlistment\DAX62\source\*| SELECT-STRING -pattern $pattern >text.txt 
```

# ruby-on-rails-3 - 如何在 twitter 引导程序中使用 Best In Place

> ID：14796415
> 
> 赞同：2
> 
> 时间：2013-02-10T09:42:33.757
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, best-in-place, bootstrap-typeahead

我还没有看到这方面的任何文件..

如果我有

```
<%= best_in_place @user, :city,  type=> :input, %> 
```

我需要包括 data-provide="typeahead"

```
<%= best_in_place @user, :city, type=> :input,:data => {:provide => "typeahead"} %> 
```

并包括来源

```
<%= best_in_place @user, :city, :type=> :input, :data => {:provide => "typeahead", :source => City.getcities.to_json} %> 
```

假设`City.getcities.to_json`返回带有城市名称的正确 json 列表

这行不通...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T16:12:30.910

使用该`:data`选项，您可以`data-`在生成的`span`而不是`input`自身上设置属性。

如果要在生成的`input`元素上添加属性，则需要使用以下`:html_attrs`选项：

```
<%= best_in_place @user, :city, :type=> :input, 
    :html_attrs => {:'data-provide' => "typeahead", 
                    :'data-source' => City.getcities.to_json} %> 
```

但是 - 正如[@Nick Ginanto](https://stackoverflow.com/users/972789/nick-ginanto)指出的那样 - 预输入选择仅适用于使用键盘而不是鼠标（可能是因为引导程序中的[错误](https://github.com/twitter/bootstrap/issues/4018)或者因为没有针对引导程序的最佳[官方支持）](https://github.com/bernat/best_in_place/issues/212)

但是下面的代码片段似乎解决了这个问题：

```
$('ul.typeahead').live('mousedown', function(e) { e.preventDefault(); }); 
```

# codeigniter - 如何在codeigniter中从父控制器传递数据

> ID：14796416
> 
> 赞同：1
> 
> 时间：2013-02-10T09:42:38.037
> 
> 标签：codeigniter, controller, codeigniter-2

我试图防止自己在每个控制器中一遍又一遍地重复相同的代码。所以我将获取数据的函数放在父控制器中，并且我试图在子控制器中传递该数据。

```
class Frontend_Controller extends MY_Controller
{
    public function __construct() 
    {
        parent::__construct();  
        $this->load->model('configOptionsModel');
    $this->db->where('configid = "2"');
        $specialdata['bgimage'] = $this->configOptionsModel->get();       
    }    
} 
```

这是子控制器的代码

```
 class Home extends Frontend_Controller {

public function __construct() {
        parent::__construct(); 
        print_r($this->specialdta); // line where error occurs
        die();
    }

    public function index()
{   
    $data['main_content'] = 'home';
    $this->load->view('frontEnd/template',$data);   
}   
 } 
```

我收到以下错误：

```
A PHP Error was encountered
Severity: Notice
Message: Undefined property: Home::$specialdta
Filename: controllers/home.php
Line Number: 9 
```

果然，第9行是： print_r($this->specialdta);

我知道如果你扩展一个控制器（类），你可以从父控制器（类）访问方法和属性，因为它们被声明为公共的。

谁能解释我做错了什么？

问候，佐兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:00:29.423

CodeIgniter 并不神奇，它遵循 PHP 类规范和规则。像任何继承模型一样，要从父类访问变量，您必须将它们分配给父类`$this`。

`$this->specialdata = $this->configOptionsModel->get();`在父构造函数中对你有用，但要小心像这样疯狂地分配数据属性。在底层，以及继承链中的许多类，CodeIgniter 的核心可能保留了一些公共属性，您不想覆盖它们。

# android - Android：是否可以应用 alpha 动画的方向？

> ID：14796418
> 
> 赞同：1
> 
> 时间：2013-02-10T09:42:48.730
> 
> 标签：android, android-animation, android-xml

在我的 android 应用程序中，我想在 imageView 上设置 alpha 效果。我想将 imageView 从 alpha 值 0.0 设置为 1.0，以便 imageView 逐渐变得可见。

我的动画 xml 在这里给出：

 **```
<?xml version="1.0" encoding="utf-8"?>
<set  xmlns:android="http://schemas.android.com/apk/res/android"   android:interpolator="@android:anim/accelerate_decelerate_interpolator" android:fillEnabled="true"  android:fillAfter="true">
<alpha android:fromAlpha="0.0" android:toAlpha="1.0"  android:duration="1200"/> 
</set> 
```*  *现在我想为可见性设定方向。我希望 imageView 将开始从左侧和右侧可视化。我该如何为此设定方向？...使用“枢轴”或其他东西！**

# android - 如何通过安卓应用向蓝牙打印机发送数据？

> ID：14796422
> 
> 赞同：15
> 
> 时间：2013-02-10T09:42:57.610
> 
> 标签：android, bluetooth, thermal-printer

我正在开发一个应用程序，它将通过蓝牙将数据发送到打印机进行打印（用于收据的热敏打印机）。我已按照此链接中的代码进行操作。

[http://pastie.org/6203514](http://pastie.org/6203514)这个链接也是[http://pastie.org/6203516](http://pastie.org/6203516)

当我将数据发送到打印机时，我能够看到设备及其 MAC 地址及其名称（打印机上的 LED 指示灯停止闪烁并变为标准，即打印机已与我的 android 手机连接）但是当我发送它没有打印数据，也没有给出任何错误。我用谷歌搜索了很多，我发现了很多代码并尝试了所有代码集但无法打印。

请任何人都可以帮助我离开这里。我听说使用 Intents 可以轻松完成，但无法使用 Intents 获得确切的解决方案。

任何帮助将不胜感激在此先感谢

加内什

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T16:18:57.240

最后我自己解决了这个问题，问题是我发送到打印机的标题字节是真正的罪魁祸首。实际上我发送的是 170,1（其中 170 是打印机必须接收的第一个字节，第二个字节是打印机 ID，我的意思是一些 com 端口，这两个值是由打印机控制卡设计者给出的）。实际上，我必须发送 170,2 ，其中 2 是打印机 ID，以便它提供正确的打印，并且对于每台打印机，通常会根据其控制卡发送数据。

非常感谢朋友，这是我的代码，您可以将这些代码用于所有类型的打印机（用于 POS 热敏打印机）

```
public void IntentPrint(String txtvalue)
{
    byte[] buffer = txtvalue.getBytes();
    byte[] PrintHeader = { (byte) 0xAA, 0x55,2,0 };
    PrintHeader[3]=(byte) buffer.length;
    InitPrinter();
    if(PrintHeader.length>128)
    {
        value+="\nValue is more than 128 size\n";
        txtLogin.setText(value);
    }
    else
    {
        try
        {
            for(int i=0;i<=PrintHeader.length-1;i++)
            {
                mmOutputStream.write(PrintHeader[i]);
            }
            for(int i=0;i<=buffer.length-1;i++)
            {
                mmOutputStream.write(buffer[i]);
            }
            mmOutputStream.close();
            mmSocket.close();
        }
        catch(Exception ex)
        {
            value+=ex.toString()+ "\n" +"Excep IntentPrint \n";
            txtLogin.setText(value);
        }
    }
} 
```

其余的代码：

```
public void InitPrinter()
{
    try
    {
        if(!bluetoothAdapter.isEnabled())
        {
           Intent enableBluetooth = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
           startActivityForResult(enableBluetooth, 0);
        }

        Set<BluetoothDevice> pairedDevices = bluetoothAdapter.getBondedDevices();

        if(pairedDevices.size() > 0)
        {
            for(BluetoothDevice device : pairedDevices)
            {
                if(device.getName().equals("Your Device Name")) //Note, you will need to change this to match the name of your device
                {
                    mmDevice = device;
                    break;
                }
            }

            UUID uuid = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); //Standard SerialPortService ID
            //Method m = mmDevice.getClass().getMethod("createRfcommSocket", new Class[] { int.class });
            //mmSocket = (BluetoothSocket) m.invoke(mmDevice, uuid);
            mmSocket = mmDevice.createRfcommSocketToServiceRecord(uuid);
            bluetoothAdapter.cancelDiscovery();
            if(mmDevice.getBondState()==2)
            {
                mmSocket.connect();
                mmOutputStream = mmSocket.getOutputStream();
            }
            else
            {
                value+="Device not connected";
                txtLogin.setText(value);
            }
        }
        else
        {
            value+="No Devices found";
            txtLogin.setText(value);
            return;
        }
    }
    catch(Exception ex)
    {
        value+=ex.toString()+ "\n" +" InitPrinter \n";
        txtLogin.setText(value);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T09:56:01.403

您是否针对特定的打印协议？（对于特定的打印机？）

**如果没有，**并且无论打印机是否连接，都可以进行通用打印，您可以使用以下代码片段：

将其写入您要打印特定文件的位置：

```
 Intent intent = Tools.getSendToPrinterIntent(
                    DisplayActivity.this, mPdfAsPictures,
                    mPrintCurrentIndex);

            // notify the activity on return (will need to ask the user for
            // approvel)
            startActivityForResult(intent, ACTIVITY_PRINT); 
```

这是辅助方法：

```
public static Intent getSendToPrinterIntent(Context ctx, String[] fileFullPaths, int indexToPrint){
    Intent sendIntent = new Intent(Intent.ACTION_SEND_MULTIPLE);

    // This type means we can send either JPEG, or PNG
    sendIntent.setType("image/*");

    ArrayList<Uri> uris = new ArrayList<Uri>();

    File fileIn = new File(fileFullPaths[indexToPrint]);
    Uri u = Uri.fromFile(fileIn);
    uris.add(u);

    sendIntent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uris);

    return sendIntent;
} 
```

最后，您将在以下位置收到答案：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == ACTIVITY_PRINT) {

        switch (resultCode) {
        case Activity.RESULT_CANCELED:
            Log.d(TAG(), "onActivityResult, resultCode = CANCELED");
            break;
        case Activity.RESULT_FIRST_USER:
            Log.d(TAG(), "onActivityResult, resultCode = FIRST_USER");
            break;
        case Activity.RESULT_OK:
            Log.d(TAG(), "onActivityResult, resultCode = OK");
            break;
        }
    }
}; 
```

祝你好运！

# ruby-on-rails - 从 S3 存储桶将音频发布到 Soundcloud？

> ID：14796423
> 
> 赞同：0
> 
> 时间：2013-02-10T09:43:12.823
> 
> 标签：ruby-on-rails, amazon-s3, soundcloud, open-uri

我已经成功地遵循了 Soundcloud 的 API 文档，但遇到了一个让我卡住的错误。

使用他们的[示例](http://developers.soundcloud.com/docs#uploading)上传/发布文件时，我在本地计算机上对文件进行硬编码时没有问题。我真正想做的是传输存储在 S3 上的文件。这一直失败，并出现*Errno::ENOENT - No such file or directory*错误。包括 Open-URI，我通过在另一台服务器上对公众可用的文件进行硬编码来测试它，但它仍然失败。因此，我不认为 S3 或我的 generate_secure_s3_url 有问题，因为我在其他地方成功使用了我的 generate_secure_s3_url。

我的代码如下，有人可以帮忙吗？

```
def product_tracks_to_soundcloud(access_token)
  require 'soundcloud'
  require 'open-uri'
  # create a client object with access token
  client = Soundcloud.new(:access_token => access_token)

    self.producttracklistings.each do |pt|
        filebase = URI.encode(pt.track.track_file_name, Regexp.new("[^#{URI::PATTERN::UNRESERVED}]"))
        fileurl = generate_secure_s3_url(filebase)
        # upload an audio file
    track = client.post('/tracks', :track => {
      :title => pt.track.name,
      :asset_data => File.new(fileurl, 'rb')
    })
    end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T16:45:36.617

好的，我自己设法解决了这个问题，这很烦人。首先，在上述任何一点上，我实际上都没有调用 Open-URI。一旦我怀疑这一点，那就只是修改这个的一个例子：

```
:asset_data => File.new(fileurl, 'rb') 
```

对此：

```
:asset_data => open(fileurl) 
```

我希望这对其他人有帮助。

# windows-phone-7 - 如何覆盖 Windows Phone 应用程序中的相机按钮？

> ID：14796431
> 
> 赞同：2
> 
> 时间：2013-02-10T09:44:56.387
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8, windows-phone, windows-phone-7.1.1

市场上有一个名为 Flashlight-X 的应用程序，它会覆盖此按钮以允许用户打开/关闭手机的 LED 闪光灯。无论您做什么，按下该应用程序内的相机按钮都不会调出相机应用程序。你如何做到这一点？

我的意思是，我知道如何订阅相机按钮事件，但是如何防止发生默认操作？如覆盖默认行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T19:02:39.293

在 MSDN 上有一篇文章描述了这一点：
[How to access the hardware camera shutter button in Windows Phone](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202963%28v=vs.105%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T02:27:45.360

在 WP7 中，您可以通过使用 Assembly.Load 访问 Microsoft 不受支持的（仅供内部使用）“Microsoft.Phone.Media.Extended”DLL 来执行此操作，然后使用反射访问相机并处理按下快门的事件。不幸的是，这个 DLL 在 WP8 中不存在，并且已被其他媒体 API 取代，这些 API 去除了该程序集的一些复杂性（不需要反射），但也去除了它的一些关键特性（例如，能够使用相机锁屏下的按钮）。

在 WP8 中，您可以使用 AudioVideoCaptureDevice.OpenAsync 来访问相机设备，但相机按钮事件已移至名为 CameraButtons 的静态类。您可以使用这些事件来覆盖应用程序中相机按钮的行为。在此处了解有关它们的更多信息：http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/hh202963 (v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202963(v=vs.105).aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-10T13:06:15.807

您不能（您不应该）覆盖特殊按钮（相机、后退、开始、增大音量、减小音量、搜索）的默认行为。

问候

# c++ - 如何在 C++ 中以干净的方式处理异常

> ID：14796433
> 
> 赞同：3
> 
> 时间：2013-02-10T09:45:04.020
> 
> 标签：c++, exception, coding-style, readability, throw

我的问题是我正在编写一个将来应该可读的程序，并且该程序有很多异常情况。所以每当我必须抛出异常时，我必须编写超过 10 行来初始化我的异常类并将程序中的信息附加到它。例如如下：

```
MyExceptionClass ex;
ex.setErrorMessage("PIN_CANNOT_GO_IN");
ex.setErrorDetails("The pin is asked to go to the state IN while the depth of the r-coordinate does not support it");
ex.setResolutionMessage("Configure your coordinates-file to move first to the correct position before changing the state of the pin");
ex.VariableList().resize(5);
ex.VariableList()[0].push_back("Pin state: ");
ex.VariableList()[0].push_back(ToString(pin.getPinState()));
ex.VariableList()[1].push_back("Pin target state: ");
ex.VariableList()[1].push_back(ToString(coordinatesData[coordinatesIndex].targetPinState));
ex.VariableList()[2].push_back("Current r Value: ");
ex.VariableList()[2].push_back(ToString(EncoderPosition.r));
ex.VariableList()[3].push_back("Current phi Value: ");
ex.VariableList()[3].push_back(ToString(EncoderPosition.phi));
ex.VariableList()[4].push_back("Current z Value: ");
ex.VariableList()[4].push_back(ToString(EncoderPosition.z));

ex.printLog();
ex.writeLog(exceptionLogFilePath.getValue());

throw ex; 
```

所以只有 5 个变量，我必须写下所有这些......

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T09:57:37.020

您可以使用一个通用函数 (fill_out_exception_parameters) 填充通用异常的 VariableList 对象，并在您编写的任何新异常类中重新使用它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T09:53:55.983

如果添加到异常类的数据仅用于显示错误消息，则可以使用字符串连接来减少使用次数`push_back()`。

例如，您可以使用：

```
ex.VariableList()[0].push_back(string("Pin state: ") + ToString(pin.getPinState()); 
```

您甚至可以连接所有其他消息，而不是为每个消息使用单独的索引（1、2、3、4 等）。

此外，对于每个字段，您可以使用专用的 setter 方法来提供适当的值。例如：

```
ex.VariableList()[0].setPinState(ToString(pin.getPinState())); 
```

然后将`"Pin state: "`零件移到*打印*错误信息的地方。

* * *

更进一步，您的异常类可能有一个专用方法，该方法接受所有导致错误消息的对象，并改为调用该消息。例如：

```
void MyExceptionClass::setMessage(Pin& pin, CoordinatesData& cd, EncoderPosition& ep) {
    setPinState(ToString(pin.getPinState()));
    // set whatever else you want here
} 
```

此外，将`ToString()`部件移动到打印消息的任何位置，只需将值存储在异常类中即可。例如，将上面的行更改为（您需要相应地更改签名）：

```
setPinState(pin.getPinState()); 
```

并让打印逻辑决定如何将其转换为字符串。另一个优点是它允许您以不同的格式打印相同的消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T07:27:27.513

您可以使用 Boost Exception 简化向异常对象添加任意数据的流程，并在它们冒泡调用堆栈时使用更多相关数据来扩充它们。您不必担心预先定义可能需要存储在异常中的所有内容，因为您可以根据需要存储任何异常数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T10:30:11.703

我想我有最干净的方法来做到这一点。请让我听听你的想法。

所以我将所有相关变量封装在一个模板化类中，如下所示（只是一个简单粗暴的例子）

```
class VarBase
{
VarBase();
static std::vector<VarBase*> __allParams;
string getStringValue() = 0;
};

template <typename T>
class Var : public VarBase
{
    T value;
    string name;
    string description;
    toString();
    operator T();
    string getStringValue();
};

VarBase::VarBase()
{
    __allParams.push_back(this);
}
VarBase::~VarBase()
{
    //handle removing from __allParams vector or whatever container
}
template <typename T>
std::string Var<T>::getStringValue()
{
    std::stringstream s;
    s << paramValue;
    return s.str();
} 
```

现在，如果我的异常类是 VarBase 类的朋友，它可以访问 __allParams 并循环遍历它并调用 getStringValue() ，它会自动将值转换为字符串并在必要时将其添加到我的异常类中:)

任何其他想法都将受到高度赞赏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T14:01:52.133

I had a similar issue: how does one *enrich* an exception with contextual information ?

Boost proposes one solution: `try/catch` and enrich the exception in the `catch` block before rethrowing it. It does enrich the exception, but not *automatically*.

The solution I came up with in the end is extremely simple, and based on C++ destructors strength. But first, how to use it:

```
void foo(int i) {
    LOG_EX_VAR(i);
    // do something that might throw
} 
```

Yep, that's all, a single macro call and `i` is added to an exception context along with the function name, file name and line number the macro was expanded at.

What's behind ? The [most important const](http://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/) and a bit of magic.

```
class LogVar {
public:
    LogVar(LogVar const&) = delete;
    LogVar& operator=(LogVar const&) = delete;

    virtual ~LogVar() {}

protected:
    LogVar();
}; // class LogVar

template <typename T>
class LogVarT: public LogVar {
public:
    LogVarT(char const* fc, char const* fl, int l, char const* n, T const& t):
        _function(fc), _filename(fl), _line(l), _name(n), _t(t) {}

    ~LogVar() {
        ContextInterface::AddVariable(_function, _filename, _line, _name, _t);
    }

private:
    char const* _function;
    char const* _filename;
    int _line;

    char const* _name;
    T const& _t;
}; // class LogVarT

template <typename T>
LogVarT make_log_var(char const* fc,
                     char const* fl,
                     int l,
                     char const* n,
                     T const& t)
{
    return LogVarT(fc, fl, l, n, t);
}

#define LOG_EX_VAR(Var_)                                                      \
    LogVar const& BOOST_PP_CAT(_5416454614, Var_) =                           \
        make_log_var(__func__, __FILE__, __LINE__, #Var_, Var_); 
```

This works fairly well, if you can get the difficult part (the `ContextInterface::AddVariable()` function) to work.

If you don't want to bother with it, then go for a `thread_local` `std::vector<LogVar*>` as you did. Just be aware that you'll be doing a lot of work for nothing.

If you are interested in it, then follow on.

1.  Let's realize that the most important part here is to get something that is thread-safe. So the context will be global... per thread (aka `thread_local`). But even then one might accidentally leak a reference to it outside.
2.  It is important to realize that several exceptions may coexist, though only one is uncaught at any point in time: that is an exception may be thrown within a `catch` clause.
3.  We can only instrument the exceptions we throw ourselves, so we need some kind of default policy for the others. Logging, for example.

So, let's get the interface straight:

```
class ContextInterface {
public:
    typedef std::unique_ptr<ContextInterface> UPtr;
    typedef std::shared_ptr<ContextInterface> SPtr;
    typedef std::weak_ptr<ContextInterface> WPtr;

    static UPtr SetDefault(UPtr d) {
        std::swap(d, DefaultContext);
        return d;
    }

    template <typename T, typename... Args>
    static SPtr SetActive(Args&&... args) {
        SPtr ci = ExceptionContext.lock();
        if (ci.get()) { return ci; }

        ci.reset(new T(std::forward<Args>(args)...));
        ExceptionContext = ci;
        return ci;
    }

    template <typename T>
    static void AddVariable(char const* fc,
                            char const* fl,
                            int l,
                            char const* n,
                            T const& t)
    {
        SPtr sp = ExceptionContext.lock();
        ContextInterface* ci = sp.get();

        if (not ci) { ci = DefaultContext.get(); }

        if (not ci) { return; }

        ci->report(fc, fl, l, n) << t;
    }

    virtual ~ContextInterface() {}

private:
    static thread_local UPtr DefaultContext;
    static thread_local WPtr ExceptionContext;

    virtual std::ostream& report(char const* fc,
                                 char const* fl,
                                 int l,
                                 char const* n) = 0;
}; // class ContextInterface 
```

And finally, the last missing piece (well, apart from the actual contexts you would want I guess): an example of the base exception class.

```
class ContextualException: public virtual std::exception {
public:
    ContextualException(): _c(ContextInterface::SetActive<ExceptionContext>()) {}

    ContextInterface const& context() const { return *_c; }

private:
    ContextInterface::SPtr _c;
}; // class ContextualException 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T14:11:37.840

这些文本描述应该与异常类固有地相关联，而不是作为运行时数据写入每个实例。

类似地，所有信息数据都应该是异常类的成员，您可以将其格式化以便稍后输出为文本（可能在异常类本身的成员函数中）。

# objective-c - 在 NSUserDefaults 中存储 SegmentedControl 段状态

> ID：14796434
> 
> 赞同：0
> 
> 时间：2013-02-10T09:45:07.490
> 
> 标签：objective-c, nsuserdefaults

我正在尝试将 a 的段索引存储`SegmentedControl`在`NSUserDefaults`.

这是加载首选项和首选项“保存”按钮的代码。

```
- (void)viewDidLoad
{
   [super viewDidLoad];
   // Get the stored data before the view loads
   NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

   int yPrefSegment = [defaults integerForKey:@"yPref"];

   prefYsegmentedControl.selectedSegmentIndex = yPrefSegment;

}

- (IBAction)savePrefButton:(id)sender
{

   int yPref = [[prefYsegmentedControl.selectedSegmentIndex] integerValue];

   NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
   [defaults synchronize];

   NSLog(@"Data saved");
} 
```

我在线上（在 中`savePrefButton`）遇到错误：

```
int yPref = [[prefYsegmentedControl.selectedSegmentIndex] integerValue]; 
```

错误是： `Expected Identifier`

我在这里迷路了。不知道它在说什么。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T09:52:16.380

您有一个语法错误和两个语义错误。

语法错误：

```
[prefYsegmentedControl.selectedSegmentIndex] 
```

选择一种方法调用或点表示法来访问属性。使用任一

```
[prefYsegmentedControl selectedSegmentIndex] 
```

或者

```
prefYsegmentedControl.selectedSegmentIndex 
```

第一个语义错误：

```
prefYsegmentedControl.selectedSegmentIndex 
```

已经是一个整数。无需调用`integerValue`它。（无论如何，您都不能将消息发送到原始类型。这不是 Smalltalk。）

第二个语义错误：您实际上并未将索引存储在`NSUserDefaults`. 插入

```
[defaults setInteger:yPref forKey:@"yPref"]; 
```

在同步用户默认值之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:52:58.140

您将属性视为对象。它不是。只需使用

```
int yPref = prefYSegmentedControl.selectedSegmentIndex; 
```

# ruby-on-rails - 如何使用带有 rails form helper 的图标创建这个 HTML5 按钮？

> ID：14796437
> 
> 赞同：3
> 
> 时间：2013-02-10T09:46:48.090
> 
> 标签：ruby-on-rails, ruby-on-rails-3

这是我想要的输出：

```
<button type="submit" class="btn btn-large btn-search btn-primary">
  <i class="icon icon-search"></i> Find Your Apartment
</button> 
```

如果我为链接而不是按钮执行此操作，我可能会执行以下操作：

```
<%= link_to root_path do %>
  <i class="icon icon-search"></i> Find Your Apartment
<% end %> 
```

但鉴于我使用的是 Rails 表单助手，我不太确定如何使用`f.submit`.

我试过了：

```
<%= f.submit, :class => "btn btn-large btn-search btn-primary" do %>
  <i class="icon icon-search"></i> Find Your Apartment
<% end %> 
```

这给了我一个语法错误。

想法？

**编辑1：**

对于它的价值，这不会给我语法错误，但不会呈现图标或“查找您的公寓”文本：

```
<%= f.submit "Find Your Apartment", :class => "btn btn-large btn-search btn-primary" do %>
  <i class="icon icon-search"></i> Find Your Apartment
<% end %> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T10:17:39.433

你可以使用按钮标签

```
<%= button_tag(type: 'submit', class: "btn btn-large btn-search btn-primary") do %>
 <i class="icon icon-search"></i> Find Your Apartment
<% end %> 
```

# winforms - 我需要担心我的 Winforms 应用程序中的全球字体吗？

> ID：14796443
> 
> 赞同：0
> 
> 时间：2013-02-10T09:47:18.737
> 
> 标签：winforms, unicode, fonts, internationalization, globalization

我希望我的软件可供全球观众使用，因此我有点担心我的程序 GUI（Winforms、.NET3.5、C#）中使用的字体。

假设我为所有内容选择“Microsoft Sans Serif”（由于某种原因，我听说[https://stackoverflow.com/a/7045886/848344](https://stackoverflow.com/a/7045886/848344)比默认的 8.25 尺寸更好）。现在，我知道当字符在 Microsoft Sans Serif 中不可用时，会自动使用“后备”字体。因此，应该只是“Microsoft Sans Serif”的文本块可能同时也使用“Arial Unicode MS”和“SimSun-ExtB”。这三种字体似乎涵盖了大部分基础。

不幸的是，某些系统可能缺少这些字体中的一种或多种（或没有最新版本）。例如，Arial Unicode MS 仅随 Office 提供。此外，WinXP（无 SP）仅支持 Microsoft Sans Serif - [v1.33](http://www.microsoft.com/typography/fonts/font.aspx?FMID=844)，而 XP SP2 使用[v1.41](http://www.microsoft.com/typography/fonts/font.aspx?FMID=1130)，Vista/Server 2008 有[v5.00](http://www.microsoft.com/typography/fonts/font.aspx?FMID=1599)。Microsoft Sans Serif 的更高版本提供改进的西里尔文、拉丁文和阿拉伯文支持。

但是，我需要担心这个吗？我是否可以假设这些类型的用户将至少升级到 XP SP2 或失败，Winforms 可以回退到支持任何缺失字符的字体？当然，如果我的程序对他们来说出错了，那么任何程序对他们来说也是错误的，所以也许他们有适当的字体（包括我没有列出的字体），Winforms 无论如何都会回退？

总之，如果我想覆盖至少 90-95% 的用户（家庭和商业）？请记住，事情不一定要完美，因为我的应用程序更像是一种阅读/显示类型的应用程序，而不是编辑应用程序，尽管对于需要额外准确性的其他人来说，任何答案都可能涵盖这两种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:10:48.283

您所描述的内容通过平台内置的字体回退机制成为非问题，并且如果用户希望使用给定的语言，这样的用户将安装必要的语言支持组件，包括字体和输入法。

不过，在制作面向世界的应用程序方面，还有很多其他事情需要注意。涵盖所有这些的一本书（但现在已经很老了）是微软的[开发国际软件](https://rads.stackoverflow.com/amzn/click/com/0735615837)。您提到的其中之一是需要使用更大的字体，以便诸如中文之类的字形清晰易读（并不意味着您需要在所有语言中使用更大的字体，但您需要能够增加语言的字体大小需要它）。另一个大问题是日期和数字的特定于区域设置的格式问题。有趣的是，大写是特定于语言环境的，如[土耳其语 i 问题](http://www.codinghorror.com/blog/2008/03/whats-wrong-with-turkey.html)所示。

# android - 如何在使用 LinkMovementMethod 时捕获异常 (ActivityNotFoundException)

> ID：14796446
> 
> 赞同：6
> 
> 时间：2013-02-10T09:48:06.350
> 
> 标签：android, textview, linkmovementmethod, activitynotfoundexception

我目前有一个带有一些 HTML 电话号码和 url 的 TextView。

我注意到我们可以使用 setMovementMethod 使这些链接可点击：

```
tv.setText("Phone number is: +32485123456 and url is http://www.blabla.com");
tv.setMovementMethod(LinkMovementMethod.getInstance()); 
```

这很好用，但在某些设备上，它会因 ActivityNotFoundException 而崩溃，这是可以理解的。（见下面的代码）

这些问题出现在我的开发者控制台中，我无法重现它们。

我面临的最大问题是我无法在我的活动中尝试/捕获代码，因为点击是由 LinkMovementMethod 处理的

关于如何避免此类错误的任何想法？

```
android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.VIEW dat=www.vlaamsbrabant.be/zoutleeuw (has extras) }
    at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1408)
    at android.app.Instrumentation.execStartActivity(Instrumentation.java:1378)
    at android.app.Activity.startActivityForResult(Activity.java:2817)
    at android.support.v4.app.FragmentActivity.startActivityForResult(FragmentActivity.java:817)
    at android.app.Activity.startActivity(Activity.java:2923)
    at android.text.style.URLSpan.onClick(URLSpan.java:62)
    at android.text.method.LinkMovementMethod.onTouchEvent(LinkMovementMethod.java:216)
    at android.widget.TextView.onTouchEvent(TextView.java:6788)
    at android.view.View.dispatchTouchEvent(View.java:3766)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1896)
    at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1159)
    at android.app.Activity.dispatchTouchEvent(Activity.java:2086)
    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1880)
    at android.view.ViewRoot.handleMessage(ViewRoot.java:1811)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:4627)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:521)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-29T22:21:21.110

您总是可以扩展 LinkMovementMethod 并在那里捕获错误。

就像是：

```
private class MovementCheck extends LinkMovementMethod {

    @Override
    public boolean onTouchEvent( TextView widget, Spannable buffer, MotionEvent event ) {
        try {
            return super.onTouchEvent( widget, buffer, event ) ;
        } catch( Exception ex ) {
            Toast.makeText( MainActivity.this, "Could not load link", Toast.LENGTH_LONG ).show();
            return true;
        }
    }

} 
```

如果没有应用程序设置来处理意图，将显示错误消息。

另一种选择是使用[此问题](https://stackoverflow.com/questions/7050068/check-if-intent-uri-is-available)中的方法提前确定是否准备好处理您的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T13:09:57.817

如果您的 textview 他的来源是 xml，您可以尝试在[此处](https://stackoverflow.com/questions/2734270/how-do-i-make-links-in-a-textview-clickable)定义的方法。
Maby（我几乎可以肯定。）但操作系统会为你处理这个问题。

如果这不起作用，那么您必须为平板电脑和手机编写独立于设备的代码。在这种情况下，也许[这篇](https://stackoverflow.com/questions/11330363/how-to-detect-device-is-android-phone-or-android-tablet)文章会指导你。当它是电话时，您将允许链接，否则您不会。

可能会在 2 个文本视图中分离 2 个链接，因为操作系统可以通过任一方式执行链接（网站）之一，这样当您尝试单击第一个电话号码时，它可能会使其可点击并崩溃

希望这可以帮助。

# wpf - 命令未访问绑定到 ViewModel - wpf

> ID：14796451
> 
> 赞同：0
> 
> 时间：2013-02-10T09:49:44.397
> 
> 标签：wpf, mvvm, icommand, relaycommand

我有一个 Wpf DataGrid，通过单击键盘上的删除键，我想在我的 ViewModel 中调用一个函数，DataGrid 绑定到 ViewModel 中的一个列表。代码如下所示：

数据网格：

```
<DataGrid  CanUserDeleteRows="False" ColumnWidth="*"  ItemsSource="{Binding MyViewModel.MyList}" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTextColumn  Header="Name" Binding="{Binding Name}"></DataGridTextColumn>
            <DataGridTextColumn  Header="Value" Binding="{Binding Value}"></DataGridTextColumn>
        </DataGrid.Columns>
        <DataGrid.InputBindings>
            <KeyBinding Key="Delete" Command="{Binding DataContext.SomeCmd
                         RelativeSource={RelativeSource AncestorType=DataGrid}}" />
        </DataGrid.InputBindings>
</DataGrid> 
```

**此类的 DataGrid 的 DataContext 在其中包含 ViewModel**

我的视图模型：

```
public class MyViewModel: INotifyPropertyChanged
{

    private IList<xx> myList= new List<xx>();
    public IList<xx> MyList
    {
        get
        {
            return myList;
        }
        set
        {
            myList= value;
            NotifyPropertyChanged("MyList");
        }
    }

    public void XM()
    {
       //DO SOMETHING
    }

    RelayCommand someCmd;
    public ICommand SomeCmd
    {
        get
        {
            if (someCmd== null)
            {
                someCmd= new RelayCommand(param => this.XM());
                NotifyPropertyChanged("SomeCmd");
            }
            return someCmd;
        }
    }

}

#region Relay Command
public class RelayCommand : ICommand
{
    #region Fields

    readonly Action<object> _execute;
    readonly Predicate<object> _canExecute;

    #endregion

    #region Constructors

    public RelayCommand(Action<object> execute)
        : this(execute, null)
    {
    }

    public RelayCommand(Action<object> execute, Predicate<object> canExecute)
    {
        if (execute == null)
            throw new ArgumentNullException("execute");

        _execute = execute;
        _canExecute = canExecute;
    }
    #endregion

    #region ICommand Members

    public bool CanExecute(object parameter)
    {
        return _canExecute == null ? true : _canExecute(parameter);
    }

    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    public void Execute(object parameter)
    {
        _execute(parameter);
    }

    #endregion 
```

在 XX 类上有一个名称（字符串）和值（整数）

绑定到命令不起作用，并在 InitializeComponent() 上给出错误消息：

```
Object reference not set to an instance of an object. 
```

如果我按以下方式编写命令的链接，则不会给出错误，但不会通过按删除来进入函数：

```
 <KeyBinding Key="Delete" Command="{Binding SomeCmd}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:41:28.367

XAML 应如下所示：

```
<DataGrid CanUserDeleteRows="False" ColumnWidth="*"  ItemsSource="{Binding MyList}"
          AutoGenerateColumns="False">
    <DataGrid.Columns>
        <DataGridTextColumn  Header="Name" Binding="{Binding Name}"></DataGridTextColumn>
        <DataGridTextColumn  Header="Value" Binding="{Binding Value}"></DataGridTextColumn>
    </DataGrid.Columns>
    <DataGrid.InputBindings>
        <KeyBinding Key="Delete" Command="{Binding SomeCmd}" />
    </DataGrid.InputBindings>
</DataGrid> 
```

不要忘记设置`DataContext`：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        this.DataContext = new MyViewModel();
    }
} 
```

# c# - 使用 jet.oledb.4.0 导入 excel 表，将第一行设置为列名

> ID：14796454
> 
> 赞同：2
> 
> 时间：2013-02-10T09:50:24.350
> 
> 标签：c#, excel, oledb, jet

我正在尝试使用**Jet.Oledb**将 excel 文件导入数据表。这是我的代码：

```
 string sourceConstr = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" + HttpContext.Current.Server.MapPath("~/" + fileName) + "';Extended Properties='Excel 8.0;HDR=No;IMEX=1'";
            OleDbConnection con = new OleDbConnection(sourceConstr);
            OleDbCommand oleDbCmd = new OleDbCommand();
            con.Open();
            oleDbCmd.Connection = con;
            DataTable dt = con.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);

            string firstExcelSheetName=dt.Rows[0][2].ToString();
            string query = "select * from [" + firstExcelSheetName + "]";
            OleDbDataAdapter data = new OleDbDataAdapter(query, con);
            data.TableMappings.Add("Table", "dtExcel");
            data.Fill(dtExcel); 
```

在 excel 文件中，第一行具有列名。但我的数据表将 (f1,f2,f3,...) 作为列名，将 Excel 文件的第一行作为第一行。所以我猜我必须告诉第一行包含columnName。但我怎样才能让它发生呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T09:56:20.593

从[connectionstrings.com](http://www.connectionstrings.com/excel)引用：

> “HDR=是的；” 表示第一行包含列名，而不是数据。“HDR=否；” 表示相反。

因此，您可以尝试将连接字符串更改为 set `HDR=Yes`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:01:45.953

如下所示，在您的情况下，连接字符串（即 sourceConstr）中只有一点点变化。

```
HDR=Yes 
```

代替

```
HDR=No 
```

改变后会是

```
string sourceConstr = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" + HttpContext.Current.Server.MapPath("~/" + fileName) + "';Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'"; 
```

# haskell - Haskell 中的诊断输出

> ID：14796457
> 
> 赞同：3
> 
> 时间：2013-02-10T09:50:36.403
> 
> 标签：haskell

我学习了命令式语言的编程，主要是 C++ 和 C，所以函数式方法对我来说是非常新的。

当我之前编写函数/方法时，我通常采用“增量”方法（可能大多数人都这样做）：编写一小部分代码，然后检查到目前为止的结果是否符合预期（通常只是将它们打印到使用 printf 或 std::cout 的标准输出），改进算法，增强算法，然后检查目前的结果是否符合预期（通常只需使用 printf 或 std::cout 将它们打印到标准输出），改进......我非常很少将整个方法写在一篇文章中。

这种“增量”方法的基本要素是具有诊断输出的能力（在我上面的示例中为 printf 或 std::cout）。但是在 Haskell 中（据我目前所知），如果我想使用“putStrLn”向标准输出写入内容，则必须更改函数的签名，因为“putStrLn”只返回一个 IO Monad 包含我想要打印的信息，但在调用“putStrLn”时不打印它，对吧？因此，每次我想使用“putStrLn”进行诊断输出时，我都必须更改当前函数的签名以及我所有其他函数调用它的方式等等……</p>

那么有没有一种便宜又简单的方法可以将函数的“局部变量”的值打印到标准输出？

或者仅仅是我要求的事实表明我不了解 Haskell 编程的基本部分？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-10T10:07:50.170

没有什么好方法可以做你想做的事。你可以接近，`Debug.Trace`但我不建议在学习时这样做，因为 Haskell 的非标准评估顺序。Haskell 不能像 C 和 C++ 这样的语言通过顺序设置“变量”的值来工作。因为它是惰性的，所以 Haskell 表达式的求值顺序取决于使用情况，所以增量值的事情并没有真正起作用。

Haskell 是一种*面向表达式的语言*。利用它来发挥你的优势：

1.  编写简短的函数。以这种方式更容易看到每个函数的作用。大多数函数应该是每个方程一行，真正的“一行”应该是常见的。
2.  使用 REPL。你应该不断地在 GHCi 中试验你的代码
3.  使用类型系统。Haskell 的类型系统比大多数命令式语言中的类型系统有用几个数量级。以机器检查的方式键入文档意图。你不能指望在不理解类型的情况下理解代码。编写代码时，一旦你得到正确的类型，你就完成了大部分工作。

结合以上建议。您可以使用`:t`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-10T14:56:33.530

这很奇怪，因为我发现在你习惯使用的语言中没有 Read Eval Print Loop (REPL)，我一直对测试我的代码的工作量感到沮丧。REPL 是我增量代码开发的基础；您可以使用它来测试您的代码*，而*无需添加一堆打印语句。

*   在编辑器的同时打开 GHCi。
*   编写更小的、单一用途的函数。起初这似乎很奇怪，但函数应用程序是 Haskell 中的基本工作单元，并且没有命令式语言中的那种开销。
*   每次编写函数时，`:r`在 GHCi 中执行并使用各种输入对其进行测试。
*   Haskell 非常密集，因此在屏幕上值得制作成单独函数的内容比您习惯的要短得多。

有时，您最终会陷入冗长的单子计算或其他事情中。GHCi 允许您设置断点 - 优先使用这些断点，而不是在代码中添加打印语句，因为您可以在不编辑代码的情况下搞砸和调查更多内容，最重要的是，您不需要在类型签名上添加 Show 约束。

完成后，您可以手动内联简短的辅助函数并使用`ghc -O2`.

`Debug.Trace`（与我的经验相比，使用手动添加的打印语句或模块是一种完全的痛苦。）

**摘要**：尽可能避免在测试代码时对其进行编辑。大量使用 GHCi。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:03:42.297

[可以使用Debug.Trace](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Debug-Trace.html)模块的`trace`功能将不纯的调试输出快速添加到纯函数中。它是一个函数，它返回其第二个参数，并在强制第二个参数/返回值时打印第一个参数的附加副作用。

我认为暂时使用它进行调试是完全可以接受的，只要它不会出现在任何最终提交或其他永久代码中。此外，打印消息的顺序与评估顺序相匹配，这对调试也很有用，但并不总是输出的首选顺序。

如果您需要经常使用它，这也可能表明您需要将代码分解为更小的函数，这样只需指定参数并查看返回值，就可以更轻松地检查它们的行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T10:07:50.410

首先，您可以通过将它们加载到其中`ghci`并在那里使用它们来调试您的函数。

然后，您可以在计算表达式时使用`trace`from打印字符串。[`Debug.Trace`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Debug-Trace.html)但是请注意，由于 Haskell 使用惰性求值，在大多数情况下，表达式的求值时间与您预期的不同。另请参阅[Wikibooks](http://en.wikibooks.org/wiki/Haskell/Debugging)和[Haskell wiki](http://www.haskell.org/haskellwiki/Debugging#Printf_and_friends)。（内部`trace`使用不安全的调用，即使在纯代码中也可以打印输出。通常你不应该使用它们，但在这种特殊情况下它是可以的。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-11T11:13:20.033

Approximation:

1.  GHCi debugging is the way to print local variables without cluttering your code.

2.  A WriterT monad transformer, either strict or lazy, can serialize your logs if you return your traced value, paired with the result.

```
{-# LANGUAGE PackageImports #-}
-- import qualified "transformers" Control.Monad.Trans.Writer.Strict as W
import qualified "transformers" Control.Monad.Trans.Writer.Lazy as W

compute:: Int -> Int -> (Int, Int)
compute x y = (result, local)
  where
    local = 2 * x
    result = local + y

test :: (Monad m) => W.WriterT String m Int
test = do
  let (r1, local1) = compute 5 3
  W.tell $ "local1= " ++ show local1 ++ "\n"

  let (r2, local2) = compute 2 2
  W.tell $ "local2= " ++ show local2 ++ "\n"

  return $ r1 + r2

main = do
  (r, logs) <- W.runWriterT test
  putStrLn logs
  putStrLn $ "result= " ++ show r 
```

outputs:

```
local1= 10
local2= 4

result= ...

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T12:03:43.017

这里有一个相当简短的示例，[说明](http://en.wikibooks.org/wiki/Haskell/Practical_monads#Generic_monads)如何构建与您描述的内容相似的东西。如果我没看错，作者创建了一个简单的 monad，可以让你在计算过程中打印出来，可以这么说。

# php - php自动数组换行，正则表达式异常

> ID：14796458
> 
> 赞同：0
> 
> 时间：2013-02-10T09:50:36.370
> 
> 标签：php, regex, arrays

我在变量中有文本：

```
$string = "foo
    bar
    cel
    [except this title:]
    one
    naa
"; 
```

我需要将它转换为数组但排除“[除了这个标题：]”：

```
Array
        (
            [0] => foo
            [1] => bar
            [2] => cel
            [3] => one
            [4] => naa
        ) 
```

我试过这个代码：

```
$string = "foo
    bar
    [except this title:]
    cel
    one
    naa";
$array = preg_split("/(\r\n|\n|\r)/", $string);
$i = 1;
foreach($array as $key => $value) {
  echo "$i: $value <br>";
  $i++;
} 
```

但显示：

```
1: foo
2: bar
3: [except this title:]
4: cel
5: one
6: naa 
```

我想要这样的显示代码：

```
1.foo
2.bar

except this title:
3.cel
4.one
5.naa 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:31:12.003

怎么样：

```
$string = "foo
    bar
    [except this title:]
    cel
    one
    naa";
$array = preg_split("/[\r\n]+/", $string);
$i = 1;
foreach($array as $key => $value) {
  $value = trim($value);
    if ($value[0] == '[') {
        $value = preg_replace('/[[\]]/', '', $value);
        echo "<br>$value<br>";
    } else {
        echo "$i.$value<br>";
        $i++;
    }
} 
```

**输出：**

```
1.foo
2.bar

except this title:
3.cel
4.one
5.naa 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:31:21.200

```
$a = preg_split("~[\n]+\s*~", $string, -1, PREG_SPLIT_NO_EMPTY);
$i = 0;
foreach ($a as $v) {
    $v = trim($v);
    if ($v[0] == "[") {
        echo trim($v, "\x5b..\x5d") ."\n";
        continue;
    }
    echo (++$i) .".$v\n";
} 
```

出去;

```
1.foo
2.酒吧
3.cel
除了这个标题：
4.一个
5.naa

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:02:09.553

```
$array  = explode("\n", $string);
foreach($array as $key => $value) {
  $value = trim($value);
  if ($value[0] != "[") {
    echo ($key+1).": $value <br>\n";
  }
} 
```

# string - 使用 Shell 脚本拆分 GST 命令

> ID：14796464
> 
> 赞同：1
> 
> 时间：2013-02-10T09:51:43.157
> 
> 标签：string, shell, split, gstreamer

我想使用 shell 脚本将以下 GST 命令分成两半。

`/GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink: caps = application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075`

拆分必须发生在 caps = 两个新行应该存储在两个变量 $var1 和 $var2

$var1 应该包含 `/GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink:`

并且 $var2 应该包含 `application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075`

请记住，输入字符串中有两个反斜杠。所以做一个回声只会给出一个反斜杠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:55:14.187

```
a="/GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink: caps = application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075" 
```

**你可以用空格**来切割字符串。

```
var1=`echo $a | cut -d' ' -f1` 

$var1 = /GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink:

var2=`echo $a | cut -d' ' -f4-` 

$var2 = application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T12:19:00.000

使用[shell 参数扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)：

```
$ cmd='/GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink: caps = application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075'

$ first=${cmd% caps = *}; echo ">>$first<<"
>>/GstPipeline:pipeline0/GstUDPSink:udpsink0.GstPad:sink:<<

$ second=${cmd#* caps = }; echo ">>$second<<"
>>application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264, sprop-parameter-sets=(string)\"Z0KAHukBQHpCAAAH0AAB1MAI\\,aM48gA\\=\\=\", payload=(int)96, ssrc=(uint)2416890621, clock-base=(uint)518578781, seqnum-base=(uint)24075<< 
```

# javascript - 我怎样才能得到所有的父母 我的代码中的项目

> ID：14796468
> 
> 赞同：0
> 
> 时间：2013-02-10T09:52:00.120
> 
> 标签：javascript

我有以下标记：

```
<ul class="MenuBarVertical" id="Ul1">
            <li id="MBVItem3732874">
                <div class="MainMenuBarBackgrounImage">
                    <a class="MenuBarItemSubmenu" href="/%D7%A7%D7%98%D7%92%D7%95%D7%A8%D7%99%D7%94%2D1.html">category 1</a></div>
                <ul>
                    <li id="SMBVItem3732879">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D1%2D1.html" tabindex="-1">page 1.1</a></li>
                    <li id="SMBVItem3732880">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D1%2D2.html" tabindex="-1">page 1.2</a></li>
                    <li id="SMBVItem3732881">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D1%2D3.html" tabindex="-1">page 1.3</a></li>
                    <li id="SMBVItem3732882">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D1%2D4.html" tabindex="-1">page 1.4</a></li>
                    <li id="SMBVItem3732883">
                        <a href="/1%2D5.html" tabindex="-1">1.5</a></li>
                </ul>
            </li>
            <li id="MBVItem3732875">
                <div class="MainMenuBarBackgrounImage">
                    <a class="MenuBarItemSubmenu" href="/%D7%A7%D7%98%D7%92%D7%95%D7%A8%D7%99%D7%94%2D2.html" tabindex="-1">category 2</a></div>
                <ul>
                    <li id="SMBVItem3732884">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D2%2D1.html" tabindex="-1">page 2.1</a></li>
                    <li id="SMBVItem3732885">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D2%2D2.html" tabindex="-1">page 2.2</a></li>
                    <li id="SMBVItem3732886">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D2%2D3.html" tabindex="-1">page 2.3</a></li>
                    <li id="SMBVItem3732887">
                        <a href="/%D7%A2%D7%9E%D7%95%D7%93%2D2%2D4.html" tabindex="-1">page 2.4</a></li>
                </ul>
            </li>

        </ul> 
```

我想使用 java 脚本`<li>`显示父 UL 的所有 id（但目前它显示了 UL 中的`<li>`所有id）。`<ul>`

我的代码是：

```
window.onload = function () {
    var list = document.getElementById("Ul1");
    var items = list.getElementsByTagName("li");
    for (var i = 0, size = items.length; i < size; i++) {

        alert(items[i].parnetnode.id);

    }
} 
```

谁能帮助我，让我知道是否有办法做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:01:35.737

将您的拼写 parnetnode 更改为`parentNode`并为父“ul”提供一个 id

```
alert(items[i].parentNode.id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:09:39.677

您的代码**正在`<li>`获取`#Ul1`**. 当你迭代和调用`items[i].parentNode.id`时，有些人会给你正确的 ID，但有些人会给你`#Ul1`。

相反，尝试只获取第二级`<ul>`，然后访问父节点的 ID：

```
window.onload = function () {
    var list = document.getElementById("Ul1");
    var items = list.getElementsByTagName("ul"); // <-- i.e. select #Ul1 ul
    for (var i = 0, size = items.length; i < size; i++) {
        alert(items[i].parentNode.id);
    }
} 
```

*注意：此解决方案取决于您描述的 HTML 结构，只要没有第三（或更深）级`<ul>`标签就可以工作。*

**工作示例：http: [//jsfiddle.net/U5pNS/](http://jsfiddle.net/U5pNS/)**

# scala - 有没有更好的方法来重写这个函数？

> ID：14796469
> 
> 赞同：-3
> 
> 时间：2013-02-10T09:52:06.177
> 
> 标签：scala, functional-programming, higher-order-functions

有没有更好的方法来重写`foo[T]`函数？

```
implicit def stringConverter(s: String) = new {
  def convert[T](): Option[T] = { //converts s: String to Option[T] }
}
def foo[T](m: Map[String,Buffer[String]], k: String): List[T] = 
  m.get(k).flatMap { x => x.map(_.convert[T]).filterNot(_ == None).map(_.get).toList }.getOrElse(List()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:43:18.600

这是我的建议（如果我的逻辑正确的话）：

```
import scala.collection.mutable.Buffer

// Implementation.
trait StringConverter[T] {
  def convert(string: String): Option[T]
}

def foo[T](m: Map[String,Buffer[String]], k: String)
          (implicit converter: StringConverter[T]): List[T] = 
  for {
    lookupFromMap <- m.get(k).toList
    valueFromList <- lookupFromMap.toList
    convertedValueFromList <- converter.convert(valueFromList).toList
  } yield convertedValueFromList

// Instance.
implicit val intConverter: StringConverter[Int] = new StringConverter[Int] {
  def convert(string: String): Option[Int] = Some(string.length)
}

val map = Map("one" -> Buffer("1", "11"), "two" -> Buffer("2", "222222222"))

println(foo[Int](map, "one"))
println(foo[Int](map, "two"))
println(foo[Int](map, "three")) 
```

我把它分成两个主要部分，一个是基本的通用实现，另一个是它正在使用的实例。convert 方法已被移动到具有 StringConverter 特征的类型类使用风格中，因为原始的 convert 方法本身并不能真正起作用。

除此之外，主要变化只是将所有内容转换为 for 理解中的列表：

*   首先，我们将 Option 从 .get 调用转换为 List。
*   然后将Buffer变成一个List。
*   转换的结果变成了一个List。

# java - “编码到接口”的OOP原则？

> ID：14796478
> 
> 赞同：0
> 
> 时间：2013-02-10T09:53:18.647
> 
> 标签：java, arraylist

我在某处读到我们应该像这样多态地实例化一个 ArrayList：

```
List myList = new ArrayList(); 
```

但如果我使用

```
ArrayList myList = new ArrayList(); 
```

这种方法我可以在输入时看到更多的方法`myList.(ctrl+space)`

请指导我了解它们之间的差异（利弊）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T09:56:08.173

通常，您对接口进行编码的原因是，如果有意义的话，您可以在以后换出您正在使用的具体类。例如，如果您因为发现内存碎片/重新分配问题而需要`ArrayList`交换`LinkedList`。您只需要更改构造对象的行，而不是您的其他代码，因为您对`List`接口进行了编码，并且这两个具体类都实现了`List`.

如果您*需要*使用接口`ArrayList`上没有的方法之一`List`，则可以更改声明并使用该方法。那么，您只需要注意，您将代码紧密耦合到`ArrayList`一个特定的具体类，而不是`List`一个由各种类实现的接口。

您的默认位置应该是对接口进行编码，因为这可以为您提供最大的灵活性/最小的耦合。但这并不意味着您在需要时不直接使用该类，只是您开始尽可能灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:57:33.670

如果您使用您建议的方法，您将严格执行容器的特定实现，这在许多情况下都不好。如果您需要使用仅存在于中的方法，则`ArrayList`有两个选项 - 声明`myList`为，或在您需要仅在 中找到的方法时`ArrayList`向下转换。`myList``ArrayList`

# actionscript-3 - 非常小的 3d 渲染

> ID：14796487
> 
> 赞同：0
> 
> 时间：2013-02-10T09:53:59.953
> 
> 标签：actionscript-3, papervision3d

我正在根据这篇文章编写一小段关于 3D 模型再现的代码：http: [//active.tutsplus.com/tutorials/3d/quick-tip-displaying-a-3d-model-with-papervision3d/](http://active.tutsplus.com/tutorials/3d/quick-tip-displaying-a-3d-model-with-papervision3d/)

我下载了一个免费的 DAE 文件 (car_shell_001.dae) 和一个纹理 (vehicle_texture.jpg)。

我只是从示例中复制了代码，将文件指针更改为我的文件。这是代码：

```
public class Tarini extends BasicView
    {
        [Embed(source="Assets/car_shell_001.dae", mimeType="application/octet-stream")]
        private var bikeModelClass:Class;

        [Embed(source="./Assets/vehicle_texture.jpg")]
        private var bikeTextureClass:Class;

        private var bikeModelDAE:DAE;

        public function Tarini() 
        {
            this.loaderInfo.addEventListener ( Event.COMPLETE, onFullyLoaded ) ;
        }

        private function onFullyLoaded(e:Event):void 
        {
                var bitmap:Bitmap = new bikeTextureClass ( ) ;

                var bitmapMaterial:BitmapMaterial = new BitmapMaterial ( bitmap.bitmapData ) ;

                var materialsList:MaterialsList = new MaterialsList ( ) ;
                materialsList.addMaterial ( bitmapMaterial, "all" ) ;

                var byteArray:ByteArray = new bikeModelClass ( ) ;

                bikeModelDAE = new DAE ( ) ;
                bikeModelDAE.load ( byteArray, materialsList ) ;

                this.scene.addChild ( bikeModelDAE ) ;

                this.camera.z = 500;

                this.startRendering ( ) ;
        }

    } 
```

这很简单，我喜欢它。我用 mxmlc 编译，我没有编译错误。当我打开生成的 swf 时，我在浏览器的中心获得了一个非常小的再现。

有什么问题？我需要以某种方式强制尺寸？如果您认为拥有 dae 和 jpg 文件会有用，请告诉我 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:12:25.053

3D 引擎和 3D 编辑器之间的测量单位不同是很常见的（实际上只是在编辑器之间，您可以观察到：只需从 Blender 导出一个立方体，然后在 Sketchup/3dsmax/等中检查它。）

您可以做的最简单的事情是在初始化模型后放大模型：

```
bikeModelDAE.scale = 10;//or any other value that works best for you 
```

另一个有效的选项是使用相机变焦/对焦选项。如果您只有一个模型要显示，您可以使用任一方法（对象比例、相机属性），但如果您有多个模型，最好确保在模型之间使用相似的比例。

有点跑题了，我假设你知道 Papervision 自 2010 年以来就没有更新过。我建议尝试使用仍在开发中的引擎，例如[Away3D](http://away3d.com/)。

# php - 检索 php 服务器会话超时

> ID：14796492
> 
> 赞同：13
> 
> 时间：2013-02-10T09:54:22.970
> 
> 标签：php, session

我想`session.gc_maxlifetime`从 PHP 服务器设置中检索 的值（在没有活动后会话过期的时间）。非常重要：我不想更改它，我只想检索它的值（可能值因服务器而异）并且我想使用我制作的 PHP 脚本来正确警告用户，具体取决于那些服务器。

谢谢你。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-10T09:57:53.783

这就是`ini_get` 功能发挥作用的地方：

```
$maxlifetime = ini_get("session.gc_maxlifetime"); 
```

从手册中我们读到：

> **session.gc_maxlifetime** *整数* session.gc_maxlifetime 指定数据将被视为“垃圾”并可能被清理的秒数。垃圾收集可能在会话开始期间发生（取决于 session.gc_probability 和 session.gc_divisor）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-27T04:00:10.307

`session.gc_maxlifetime`不是在没有活动后会话过期的时间。这里的 gc 可能是垃圾收集。正如php[手册](http://php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime)所说，

> session.gc_maxlifetime 指定数据将被视为“垃圾”并可能被清理的秒数。垃圾收集可能在会话开始期间发生（取决于 session.gc_probability 和 session.gc_divisor）。
> 
> 注意：如果不同的脚本具有不同的 session.gc_maxlifetime 值，但共享相同的存储会话数据的位置，则具有最小值的脚本将清理数据。在这种情况下，将此指令与 session.save_path 一起使用。

有关更多信息，请参阅此[帖子](https://stackoverflow.com/a/1270960/6521116)。

# c++ - VS2012 C++ Win32 - 颜色混乱

> ID：14796493
> 
> 赞同：0
> 
> 时间：2013-02-10T09:54:33.513
> 
> 标签：c++, colors, visual-studio-2012, syntax-highlighting, win32-process

我刚刚开始使用 VS2012（更新 1）编写一些 C++ 代码。我多年来一直使用 C# 与 VS 产品合作，但使用 C++ 语法时，我遇到了奇怪的突出显示颜色：

[图片样本 http://img213.imageshack.us/img213/409/67556947.png](http://img213.imageshack.us/img213/409/67556947.png)

代码编译没有错误（忘记警告），但老实说这真的很奇怪。我没有使用扩展\插件。它经常发生，我还没有找到摆脱它的程序。

系统规格：
操作系统：Windows 7 Ultimate x64
RAM：8 GB

Microsoft Visual Studio Ultimate 2012 版本 11.0.51106.01 更新 1 Microsoft .NET Framework 版本 4.5.50709 已安装版本：Ultimate

# jquery - 获取父母父母的文字？

> ID：14796494
> 
> 赞同：0
> 
> 时间：2013-02-10T09:54:36.203
> 
> 标签：jquery, jquery-mobile

我在 jQuery Mobile 中有以下代码：

```
<ul data-role="listview" data-theme="d" id="#listview" data-divider-theme="d">
    <li data-role="list-divider" class="name">Mr. Sam</li>
            <li data-icon="false" class="details">
                       <a onclick="getInfo()"> 
```

而在我的`onclick`，我想访问`Mr. Sam`. 这是我在 JS 中尝试的以下代码：

`var info = $(this).parent().parent().text();`

因为，我点击`<a>`，它的父级是`<li>`，它的父级`<li>`包含 Mr. Sam。但我做错了什么，因为`alert(info);`警告一个空白输出。我需要改变什么？我什至试过，`.html()`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:56:45.200

在您的标记中，目标`li`不是单击元素的祖父元素，而是父元素的前一个兄弟元素：

```
<li data-role="list-divider" class="name">Mr. Sam</li>
                                               ---^ 
```

您可以使用`prev`方法：

```
var info = $(this).parent().prev().text(); 
```

另请注意，在您的代码中`this`引用窗口对象，您可以传递`this`给您的函数：

```
<a onclick="getInfo(this)"> 
```

```
function getInfo(elem) {
   var info = $(elem).parent().prev().text(); 
} 
```

[http://jsfiddle.net/F8wt8/](http://jsfiddle.net/F8wt8/)

由于您使用的是 jQuery（`#`从`ul`s ID 属性中删除后）而不是`onclick`属性，因此您可以使用`click`方法。

```
$('#listview li.details a').click(function(event){
   event.preventDefault();
   var info = $(this).parent().prev().text();
   // console.log(info);
}) 
```

# django - “渲染”这个词在 django 中是什么意思？

> ID：14796495
> 
> 赞同：3
> 
> 时间：2013-02-10T09:54:45.897
> 
> 标签：django, django-templates

我正在尝试阅读 django 的权威指南。但是我感觉不到“渲染”这个词，我在书中遇到了模板章节。作者从未提及它的含义，即使我已经阅读了介绍性模板章节。

在英文词典中，render 是

```
to cause to be or become; make: to render someone helpless. 
```

但这在 django 中没有意义（当然，我无法理解这一点，因为我使用英语作为第二语言。

你能给出“渲染”这个词的定义吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:02:53.060

[Sense 7](http://en.wiktionary.org/wiki/render#Verb)，转换模板并提供变量以呈现给用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:04:26.870

在 django 中，*模板被渲染为 HTTPResponse*。即模板被解释并翻译成适当的输出。在 django 中，模板可以呈现为 http 响应 ( `render_to_response`) 或字符串 ( `render_to_string`)。

我的字典中很少有相关的英语单词含义是

```
render:
    give an interpretation or rendition of 
        The pianist rendered the Beethoven sonata beautifully
    restate (words) from one language into another language
        She rendered the French poem into English 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-07-31T20:17:13.583

合并您的模板和代码以创建适当的页面

# c# - LongListSelector 专注于项目

> ID：14796499
> 
> 赞同：1
> 
> 时间：2013-02-10T09:55:20.237
> 
> 标签：c#, .net, silverlight, windows-phone-7, listbox

我的应用页面中有这个 LongListSelector：

```
<Controls:LongListSelector x:Name="searchList" Margin="0,0,0,0"  Background="White" SelectionChanged="DidPressSelectSearchList" HorizontalContentAlignment="Stretch" Grid.Row="1">
            <Controls:LongListSelector.ItemTemplate>
                <DataTemplate>
                        <local:SearchTemplateSelector Content="{Binding}" HorizontalContentAlignment="Stretch">
                        <local:SearchTemplateSelector.GoogleSuggestTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Rectangle Height="1" HorizontalAlignment="Stretch" VerticalAlignment="Top" Fill="Black" Opacity="0.3"/>
                                    <TextBlock Text="{Binding}" FontSize="25" Foreground="Black" TextWrapping="Wrap" Grid.Row="1" Margin="0,10"/>
                                </Grid>
                            </DataTemplate>
                        </local:SearchTemplateSelector.GoogleSuggestTemplate>

                        <local:SearchTemplateSelector.VideoTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Rectangle Height="1" HorizontalAlignment="Stretch" VerticalAlignment="Top" Fill="Black" Opacity="0.3" />
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Image Margin="0" Source="{Binding Path=ImgUrl}" HorizontalAlignment="Left" Width="100" Height="100" Tag="{Binding idStr}"/>
                                        <Grid Grid.Column="1" Margin="10,0,8,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="60"/>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Text="{Binding Name}" FontSize="20" Foreground="Black" TextWrapping="Wrap" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                                            <StackPanel Orientation="Horizontal" Margin="0,-5,0,0" Grid.Row="1">
                                                <TextBlock Text="Views:  " FontSize="20" Foreground="Black"/>
                                                <TextBlock Text="{Binding ViewCount}" FontSize="20" Foreground="Black"/>
                                            </StackPanel>

                                            <Grid Grid.Row="2">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Text="{Binding TimeStr}" FontSize="20" Foreground="Black" Margin="0,0,0,0" />
                                                <TextBlock Text="Cached" FontSize="20" Foreground="Red" Margin="20,0,0,0" Grid.Column="1" />
                                            </Grid>
                                        </Grid>
                                    </Grid>

                                </Grid>

                            </DataTemplate>
                        </local:SearchTemplateSelector.VideoTemplate>

                    </local:SearchTemplateSelector>
                </DataTemplate>

            </Controls:LongListSelector.ItemTemplate>
        </Controls:LongListSelector> 
```

而且我注意到，当我按下列表中的一个项目时，用户无法知道他按下了哪个项目，例如当他按下它时聚焦该项目。在iPhone中，选定的行变成蓝色，当释放蓝色选择消失时，在windows phone中也有一些等价的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T07:50:51.507

使用`TiltEffect`Silverlight Toolkit for Windows Phone，详细信息在此处[http://www.geekchamp.com/articles/silverlight-for-wp7-toolkit-tilteffect-in-depth](http://www.geekchamp.com/articles/silverlight-for-wp7-toolkit-tilteffect-in-depth)。`Button`还可以`ItemTemplate`通过`EmptyButtonStyle` [http://www.jeff.wilcox.name/2011/10/hyperlinkbutton-empty-style-for-phone/](http://www.jeff.wilcox.name/2011/10/hyperlinkbutton-empty-style-for-phone/)使效果更具表现力。

# ios - 为 ios 应用程序生成详细崩溃报告的好库？

> ID：14796500
> 
> 赞同：0
> 
> 时间：2013-02-10T09:55:29.160
> 
> 标签：ios, coding-style, app-store, crash-reports

在提交到应用商店以生成详细的崩溃报告之前，任何人都可以建议我在 IOS 应用中包含的最佳方式/程序/库是什么，而不影响应用效率。

iTune 连接程序是否可靠？任何人都可以建议我任何好的图书馆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:00:03.263

这是对各种库的一个很好的概述，我知道 Crittercism 的声誉，但值得自己评估：http: [//www.jeremyfuller.net/2011/06/the-battle-of-the-ios-crash-reporters/](http://www.jeremyfuller.net/2011/06/the-battle-of-the-ios-crash-reporters/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:21:57.270

随着时间的推移，iTunes Connect 变得越来越可靠。他们目前的崩溃报告正在为我们解决问题。Flurry 也有一种方法可以捕获使我们的应用程序崩溃的异常，所以这也很有用。

# r - 是否可以从 RStudio 中的 R markdown (.Rmd) 调用外部 R 脚本？

> ID：14796501
> 
> 赞同：11
> 
> 时间：2013-02-10T09:55:37.617
> 
> 标签：r, knitr, rstudio, r-markdown

根据[此 R Sweave 示例](http://yihui.name/knitr/demo/externalization/)加载外部 R 脚本相当简单：

```
<<external-code, cache=FALSE>>=
read_chunk('foo-bar.R')
@ 
```

可以对 R Markdown 做同样的事情吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-10T09:55:37.617

是的。

把它放在你的 R Markdown 文件的顶部：

```
```{r setup, echo=FALSE}
opts_chunk$set(echo = FALSE, cache=FALSE)
read_chunk('../src/your_code.R')
``` 
```

使用以下提示分隔您的代码`knitr`（就像 @yihui 在[示例](https://bitbucket.org/stat/knitr/downloads/Stat579-HW8-Xie.R)中所做的那样）：

```
## @knitr part1
plot(c(1,2,3),c(1,2,3))

## @knitr part2
plot(c(1,2,3),c(1,2,3)) 
```

在您的 R Markdown 文件中，您现在可以在线评估代码段：

```
Title
=====

Foo bar baz...

```{r part1}
```

More foo...

```{r part2}
``` 
```

# java - 需要了解一项 PMD 规则

> ID：14796503
> 
> 赞同：0
> 
> 时间：2013-02-10T09:55:44.167
> 
> 标签：java, optimization, code-cleanup

我使用 PMD 工具来查找 java 代码中的错误（如果有）。PMD 给出的一个常见建议是“局部变量 {local_variable} 可以声明为最终变量”。如果它的状态没有进一步改变，是否有必要将所有局部变量声明为最终变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:59:55.473

> 如果它的状态没有进一步改变，是否有必要将所有局部变量声明为最终变量？

不，没有必要，除非在一种情况下：如果您需要在匿名类中访问该变量。

> 当所有局部变量不改变时，将它们设为最终变量是一种好习惯吗？

这显然是主观的——我个人认为它不必要地使代码混乱，如果你遵循良好的编码实践，你的方法应该足够短并且足够自我解释，以至于不需要让你的变量最终化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:16:49.450

好吧，将变量显式设置为 final 并让`final`关键字出现在周围也是语言设计的一个问题。在 scala 中，默认设置是所有内容都是最终的和不可变的，从而推动了更具功能性的设计。如果您想知道为什么要使用 final，请查看 scala - 这应该会给您一些想法。

顺便说一句，我认为不使用 final 是不好的风格。最终变量——在这个意义上是好的或常数——不能改变。这是一种编程合同。您只是在带有最终变量的代码中减少了副作用。如果您将其省略，您也可以省略所有私有字段。何必？

在eclipse中，当您打开对话框“Source/Clean Up ...”时，您可以自动添加所有必需的final字段和许多其他被认为“更干净”的东西（所以我猜它被称为“Clean Up” *，因为*不使用final会被认为是不洁的）。

这取决于您 - 使用它 - 或离开它。使用它 - 并特别查看无法应用 final 的代码。也许该代码可以改进为最终版本？

**所以：是的！这是个好习惯！**

# c# - 从 ComboBox 的模板设置 ComboBoxItem 的样式

> ID：14796506
> 
> 赞同：1
> 
> 时间：2013-02-10T09:55:55.183
> 
> 标签：c#, .net, wpf, xaml, templates

我正在为 WPF 中的一些 ComboBox 控件制作模板。但我还想在这个模板中设置 ComboBoxItems 的样式。我只找到了如何从创建控件的位置应用样式，而不是从 ComboBox 的模板中应用样式。

我正在使用的模板取自这里：http: [//msdn.microsoft.com/en-us/library/ms752094.aspx](http://msdn.microsoft.com/en-us/library/ms752094.aspx)

但是那里的 ComboBoxItem 样式（位于底部）适用于所有 ComboBoxItems（由于`x:Key="{x:Type ComboBoxItem}"`.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-10T10:55:38.563

您应该交换 msdn 示例的样式定义

```
<Style x:Key="{x:Type ComboBox}"
       TargetType="{x:Type ComboBox}"> 
```

与以下一个

```
<Style x:Key="MyComboBox" TargetType="{x:Type ComboBox}"> 
```

然后通过以下方式将样式显式分配给您的组合框

```
<ComboBox Style="{StaticResource MyComboBox}" /> 
```

[x:关键指令](http://msdn.microsoft.com/en-us/library/ms742804.aspx)

> x:Key 的属性值可以是 XamlName 语法中定义的任何字符串，也可以是通过标记扩展评估的对象。

msdn 示例中定义样式的方式说明了如何覆盖组合框的默认样式，以显式指定样式，使用字符串而不是标记扩展名来指定组合框资源中的样式。

编辑

ComboBoxItems 样式也应该这样做，所以交换代码

```
<Style x:Key="{x:Type ComboBoxItem}" TargetType="{x:Type ComboBoxItem}"> 
```

用代码

```
<Style x:Key="MyComboBox" TargetType="{x:Type ComboBox}"> 
```

并在 ComboBox 样式的代码中添加以下指令

```
<Setter Property="ItemContainerStyle" Value="{StaticResource MyComboxItem}"/> 
```

这是一个简短示例，说明如何在同一个窗口中拥有样式组合框和另一个具有默认样式的组合框。

XAML

```
<Window x:Class="WpfComboTemplate.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:coll="clr-namespace:System.Collections.ObjectModel;assembly=System"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <!--Control colors.-->
        <Color x:Key="WindowColor">#FFE8EDF9</Color>
        <Color x:Key="ContentAreaColorLight">#FFC5CBF9</Color>
        <Color x:Key="ContentAreaColorDark">#FF7381F9</Color>

        <Color x:Key="DisabledControlLightColor">#FFE8EDF9</Color>
        <Color x:Key="DisabledControlDarkColor">#FFC5CBF9</Color>
        <Color x:Key="DisabledForegroundColor">#FF888888</Color>

        <Color x:Key="SelectedBackgroundColor">#FFC5CBF9</Color>
        <Color x:Key="SelectedUnfocusedColor">#FFDDDDDD</Color>

        <Color x:Key="ControlLightColor">White</Color>
        <Color x:Key="ControlMediumColor">#FF7381F9</Color>
        <Color x:Key="ControlDarkColor">#FF211AA9</Color>

        <Color x:Key="ControlMouseOverColor">#FF3843C4</Color>
        <Color x:Key="ControlPressedColor">#FF211AA9</Color>

        <Color x:Key="GlyphColor">#FF444444</Color>
        <Color x:Key="GlyphMouseOver">sc#1, 0.004391443, 0.002428215, 0.242281124</Color>

        <!--Border colors-->
        <Color x:Key="BorderLightColor">#FFCCCCCC</Color>
        <Color x:Key="BorderMediumColor">#FF888888</Color>
        <Color x:Key="BorderDarkColor">#FF444444</Color>

        <Color x:Key="PressedBorderLightColor">#FF888888</Color>
        <Color x:Key="PressedBorderDarkColor">#FF444444</Color>

        <Color x:Key="DisabledBorderLightColor">#FFAAAAAA</Color>
        <Color x:Key="DisabledBorderDarkColor">#FF888888</Color>

        <Color x:Key="DefaultBorderBrushDarkColor">Black</Color>

        <!--Control-specific resources.-->
        <Color x:Key="HeaderTopColor">#FFC5CBF9</Color>
        <Color x:Key="DatagridCurrentCellBorderColor">Black</Color>
        <Color x:Key="SliderTrackDarkColor">#FFC5CBF9</Color>

        <Color x:Key="NavButtonFrameColor">#FF3843C4</Color>

        <LinearGradientBrush x:Key="MenuPopupBrush"
                     EndPoint="0.5,1"
                     StartPoint="0.5,0">
            <GradientStop Color="{DynamicResource ControlLightColor}"
                Offset="0" />
            <GradientStop Color="{DynamicResource ControlMediumColor}"
                Offset="0.5" />
            <GradientStop Color="{DynamicResource ControlLightColor}"
                Offset="1" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="ProgressBarIndicatorAnimatedFill"
                     StartPoint="0,0"
                     EndPoint="1,0">
            <LinearGradientBrush.GradientStops>
                <GradientStopCollection>
                    <GradientStop Color="#000000FF"
                    Offset="0" />
                    <GradientStop Color="#600000FF"
                    Offset="0.4" />
                    <GradientStop Color="#600000FF"
                    Offset="0.6" />
                    <GradientStop Color="#000000FF"
                    Offset="1" />
                </GradientStopCollection>
            </LinearGradientBrush.GradientStops>
        </LinearGradientBrush>

        <ControlTemplate x:Key="ComboBoxToggleButton"
                 TargetType="{x:Type ToggleButton}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="20" />
                </Grid.ColumnDefinitions>
                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup x:Name="CommonStates">
                        <VisualState x:Name="Normal" />
                        <VisualState x:Name="MouseOver">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).
                (GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                          Storyboard.TargetName="Border">
                                    <EasingColorKeyFrame KeyTime="0"
                                   Value="{StaticResource ControlMouseOverColor}" />
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>
                        <VisualState x:Name="Pressed" />
                        <VisualState x:Name="Disabled">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).
                (GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                          Storyboard.TargetName="Border">
                                    <EasingColorKeyFrame KeyTime="0"
                                   Value="{StaticResource DisabledControlDarkColor}" />
                                </ColorAnimationUsingKeyFrames>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).
                (SolidColorBrush.Color)"
                                          Storyboard.TargetName="Arrow">
                                    <EasingColorKeyFrame KeyTime="0"
                                   Value="{StaticResource DisabledForegroundColor}" />
                                </ColorAnimationUsingKeyFrames>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.BorderBrush).
                (GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                          Storyboard.TargetName="Border">
                                    <EasingColorKeyFrame KeyTime="0"
                                   Value="{StaticResource DisabledBorderDarkColor}" />
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>
                    </VisualStateGroup>
                    <VisualStateGroup x:Name="CheckStates">
                        <VisualState x:Name="Checked">
                            <Storyboard>
                                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).
                (GradientBrush.GradientStops)[1].(GradientStop.Color)"
                                          Storyboard.TargetName="Border">
                                    <EasingColorKeyFrame KeyTime="0"
                                   Value="{StaticResource ControlPressedColor}" />
                                </ColorAnimationUsingKeyFrames>
                            </Storyboard>
                        </VisualState>
                        <VisualState x:Name="Unchecked" />
                        <VisualState x:Name="Indeterminate" />
                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>
                <Border x:Name="Border"
            Grid.ColumnSpan="2"
            CornerRadius="2"
            BorderThickness="1">
                    <Border.BorderBrush>
                        <LinearGradientBrush EndPoint="0,1"
                             StartPoint="0,0">
                            <GradientStop Color="{DynamicResource BorderLightColor}"
                        Offset="0" />
                            <GradientStop Color="{DynamicResource BorderDarkColor}"
                        Offset="1" />
                        </LinearGradientBrush>
                    </Border.BorderBrush>
                    <Border.Background>

                        <LinearGradientBrush StartPoint="0,0"
                             EndPoint="0,1">
                            <LinearGradientBrush.GradientStops>
                                <GradientStopCollection>
                                    <GradientStop Color="{DynamicResource ControlLightColor}" />
                                    <GradientStop Color="{DynamicResource ControlMediumColor}"
                            Offset="1.0" />
                                </GradientStopCollection>
                            </LinearGradientBrush.GradientStops>
                        </LinearGradientBrush>

                    </Border.Background>
                </Border>
                <Border Grid.Column="0"
            CornerRadius="2,0,0,2"
            Margin="1" >
                    <Border.Background>
                        <SolidColorBrush Color="{DynamicResource ControlLightColor}"/>
                    </Border.Background>
                </Border>
                <Path x:Name="Arrow"
          Grid.Column="1"
          HorizontalAlignment="Center"
          VerticalAlignment="Center"
          Data="M 0 0 L 4 4 L 8 0 Z" >
                    <Path.Fill>
                        <SolidColorBrush Color="{DynamicResource GlyphColor}"/>
                    </Path.Fill>
                </Path>
            </Grid>
        </ControlTemplate>

        <ControlTemplate x:Key="ComboBoxTextBox"
                 TargetType="{x:Type TextBox}">
            <Border x:Name="PART_ContentHost"
          Focusable="False"
          Background="{TemplateBinding Background}" />
        </ControlTemplate>

        <Style x:Key="MyComboxItem"
       TargetType="{x:Type ComboBoxItem}">
            <Setter Property="SnapsToDevicePixels"
          Value="true" />
            <Setter Property="OverridesDefaultStyle"
          Value="true" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                        <Border x:Name="Border"
                Padding="2"
                SnapsToDevicePixels="true"
                Background="Transparent">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected" />
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                Storyboard.TargetProperty="(Panel.Background).
                    (SolidColorBrush.Color)">
                                                <EasingColorKeyFrame KeyTime="0"
                                         Value="{StaticResource SelectedBackgroundColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="SelectedUnfocused">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                Storyboard.TargetProperty="(Panel.Background).
                    (SolidColorBrush.Color)">
                                                <EasingColorKeyFrame KeyTime="0"
                                         Value="{StaticResource SelectedUnfocusedColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ContentPresenter />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MyComboBox"
       TargetType="{x:Type ComboBox}">
            <Setter Property="SnapsToDevicePixels"
          Value="true" />
            <Setter Property="OverridesDefaultStyle"
          Value="true" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
          Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
          Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll"
          Value="true" />
            <Setter Property="MinWidth"
          Value="120" />
            <Setter Property="MinHeight"
          Value="20" />
            <Setter Property="ItemContainerStyle" Value="{StaticResource MyComboxItem}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal" />
                                    <VisualState x:Name="MouseOver" />
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetName="PART_EditableTextBox"
                                                Storyboard.TargetProperty="(TextElement.Foreground).
                      (SolidColorBrush.Color)">
                                                <EasingColorKeyFrame KeyTime="0"
                                         Value="{StaticResource DisabledForegroundColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="EditStates">
                                    <VisualState x:Name="Editable">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)"
                                                 Storyboard.TargetName="PART_EditableTextBox">
                                                <DiscreteObjectKeyFrame KeyTime="0"
                                            Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames
                      Storyboard.TargetProperty="(UIElement.Visibility)"
                                                 Storyboard.TargetName="ContentSite">
                                                <DiscreteObjectKeyFrame KeyTime="0"
                                            Value="{x:Static Visibility.Hidden}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Uneditable" />
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ToggleButton x:Name="ToggleButton"
                        Template="{StaticResource ComboBoxToggleButton}"
                        Grid.Column="2"
                        Focusable="false"
                        ClickMode="Press"
                        IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, 
              RelativeSource={RelativeSource TemplatedParent}}"/>
                            <ContentPresenter x:Name="ContentSite"
                            IsHitTestVisible="False"
                            Content="{TemplateBinding SelectionBoxItem}"
                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                            Margin="3,3,23,3"
                            VerticalAlignment="Stretch"
                            HorizontalAlignment="Left">
                            </ContentPresenter>
                            <TextBox x:Name="PART_EditableTextBox"
                   Style="{x:Null}"
                   Template="{StaticResource ComboBoxTextBox}"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Bottom"
                   Margin="3,3,23,3"
                   Focusable="True"
                   Background="Transparent"
                   Visibility="Hidden"
                   IsReadOnly="{TemplateBinding IsReadOnly}" />
                            <Popup x:Name="Popup"
                 Placement="Bottom"
                 IsOpen="{TemplateBinding IsDropDownOpen}"
                 AllowsTransparency="True"
                 Focusable="False"
                 PopupAnimation="Slide">
                                <Grid x:Name="DropDown"
                  SnapsToDevicePixels="True"
                  MinWidth="{TemplateBinding ActualWidth}"
                  MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder"
                      BorderThickness="1">
                                        <Border.BorderBrush>
                                            <SolidColorBrush Color="{DynamicResource BorderMediumColor}" />
                                        </Border.BorderBrush>
                                        <Border.Background>
                                            <SolidColorBrush Color="{DynamicResource ControlLightColor}" />
                                        </Border.Background>
                                    </Border>
                                    <ScrollViewer Margin="4,6,4,6"
                            SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True"
                            KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems"
                   Value="false">
                                <Setter TargetName="DropDownBorder"
                    Property="MinHeight"
                    Value="95" />
                            </Trigger>
                            <Trigger Property="IsGrouping"
                   Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll"
                    Value="false" />
                            </Trigger>
                            <Trigger SourceName="Popup"
                   Property="AllowsTransparency"
                   Value="true">
                                <Setter TargetName="DropDownBorder"
                    Property="CornerRadius"
                    Value="4" />
                                <Setter TargetName="DropDownBorder"
                    Property="Margin"
                    Value="0,2,0,0" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <ComboBox VerticalAlignment="Top"
                  ItemsSource="{Binding}">

        </ComboBox>
        <ComboBox VerticalAlignment="Top" 
                  Grid.Row="1" 
                  Style="{StaticResource MyComboBox}" 
                  ItemsSource="{Binding}">

        </ComboBox>
    </Grid>
</Window> 
```

C# 后面

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfComboTemplate
{
    /// <summary>
    /// Logica di interazione per MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            DataContext = new ObservableCollection<string>() {"Hello", "ComboBox"};
        }
    }
} 
```

使用默认样式的组合框的截图 ![默认组合框](../Images/9e2c46be2553d93d89d048fb37b2ced8.png)

带有样式组合框的截图 ![样式组合框](../Images/4a381328b74366d6dea5420d092dbad4.png)

# jquery - jQuery拖放问题

> ID：14796509
> 
> 赞同：1
> 
> 时间：2013-02-10T09:56:16.130
> 
> 标签：jquery, jquery-ui

我有两个 div 元素 1\. div (id="draggable") & div (id="dropper")。它们中的每一个都包含几个 div 。我想将孩子从可拖动的拖放到滴管。在我这样做之后，我想在滴管中移动它们。到目前为止，我已经设法完成了所有事情，但我无法完成最后一部分。因为可拖动的孩子可以在整个文档中移动。谁能帮我做到这一点？

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>New Web Project</title>
    <link href="css/jquery-ui-1.10.0.custom.css" rel="stylesheet" type="text/css"/>
    <link href="css/style.css" rel="stylesheet" type="text/css"/>

    <script type="text/javascript" src="script/jquery-1.9.0.js"> </script>
    <script type="text/javascript" src="script/jquery-ui-1.10.0.custom.js"> </script>
    <script type="text/javascript" src="script/script.js"> </script>
</head>
<body>

    <div id="draggable" class="drop">
        <h4>Drag From Here</h4>
        <div id="wrapper1" class="floatLeft">item1 </div> 
        <div id="wrapper2" class="floatLeft">item2 </div> 
        <div id="wrapper3" class="floatLeft">item3 </div> 
        <div id="wrapper4" class="floatLeft">item4 </div> 

    </div>

    <div id="dropper" class="drop">
        <h4>Drop'em here</h4>
        <div class="floatLeft">item1 </div> 
        <div class="floatLeft">item2 </div> 
        <div class="floatLeft">item3 </div> 
        <div class="floatLeft">item4 </div> 
    </div>
</body> 
```

```
#draggable{
height:100px;
border-style:solid;
border-bottom-color:black;
margin-right: 10px;
}

.floatLeft{
    float:left;
    margin:10px 10px 10px 10px;
    border-style:solid;
    border-color: gray;
    cursor: pointer;
}

#dropper{
height: 80px;
/*width: 50%;*/
border-style:solid;
border-bottom-color:black;
margin-right: 10px;
}

$(function(){

$("#draggable").each(function(){

    $("#draggable div").draggable();
}   

);

$("#dropper").droppable(

);

$("#dropper div").draggable({ containment: "parent" });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T16:41:17.797

在我看来，您希望一个已删除的项目会自动插入到可放置的 DOM 结构中 - 但事实并非如此。这就是为什么你的代码没有给你想要的东西。但是，您可能正在寻找可排序的插件。放置的 div 将集成到目标的 DOM 结构中，这一事实很容易满足您的要求：

```
$("#draggable").sortable ({
    connectWith: "#dropper",
    items: "> div"
});
$("#dropper").sortable({
    containment: "parent",
    items: "> div"
}); 
```

点击链接查看[使用 sortable 插件的 jsfiddle](http://jsfiddle.net/martyk/VYRSg/1/)

# php - return 如何以递归方式工作？

> ID：14796510
> 
> 赞同：0
> 
> 时间：2013-02-10T09:56:20.067
> 
> 标签：php, recursion, return

我们可以说当`$number <2` 它不再调用`factirial()`函数时吗？或者它调用 factorial() 函数，但它总是将 factorial 设置为 factorial(1)。如果是这样，我认为递归使用更多内存。我对么？

```
<?php function factorial($number){

                if ($number < 2) { 
                return 1; 
                } else { 
                return ($number * factorial($number-1)); 
                } 
            }

echo factorial(5);
?> 
```

这就是我在函数中的猜测

```
3*factorial(2)
2*factorial(1)
1*factorial(1)
1*factorial(1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:58:42.103

> 我们可以说当 $number <2 时它不会再次调用 factirial() 函数吗？

是的

# c++ - Qt 5.0.1 中的“配置”无法识别

> ID：14796518
> 
> 赞同：2
> 
> 时间：2013-02-10T09:56:48.020
> 
> 标签：c++, qt, ssl, mingw, qt5

我已经下载了适用于 Windows 32 位 (MinGW) 的 Qt 5.0.1，并想再次对其进行配置以支持 OpenSSL，但我找不到`confiure.exe`.

顺便说一句，当我使用 Qt 5.0.1 命令提示符使用`configure`时，它说“`configure.exe`无法识别”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:24:08.670

configure.exe 是 Qt 源代码的一部分 - 所以请确保您安装了它。

但无论如何，如果您想自己构建 Qt，我建议您从[这里](https://qt-project.org/downloads)下载源代码并在单独的文件夹中开始（如果您下载源代码，请确保您从下载中获取 .zip，tar.gz 用于 linux 并且不'没有 Windows configure.exe)

# ruby-on-rails - 使用 Jquery 在 Rails 中使帖子的评论可切换

> ID：14796520
> 
> 赞同：0
> 
> 时间：2013-02-10T09:57:20.107
> 
> 标签：ruby-on-rails, jquery

场景：一个帖子有很多评论。在帖子的索引页面中，当用户点击显示链接（link_to post）时，其评论将显示在帖子下方。

在这里，我使用 append() 添加评论： `$('#edit_post_<%= @post.id %>').append('<%= j render "comments/comments" %>')`因此，当用户单击显示链接时，评论将被加载并显示。

但是我怎样才能再次隐藏这些评论（即使评论可切换）？

帖子/索引

```
<h1>Posts</h1>
<% @posts.each do |post| %>
    <%= form_for post, remote: true do |f| %>
        <%=  post.content %>
        <div id="post_<%= post.id %>">
          <%= link_to "show", post, remote: true  %>
        </div>
    <% end %>
<% end %> 
```

帖子/show.js.erb

```
$('#edit_post_<%= @post.id %>').append('<%= j render "comments/comments" %>') 
```

评论/_comments.html.erb

```
<% @comments.each do |comment| %>
    <%= comment.content %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:33:53.907

我想你没有新评论的事件绑定。

你应该使用类似的东西

```
$('.container-of-your-comments').on('click', '.the-toggle-button', function (e) {
  // toggle
}); 
```

所以切换适用于所有（以及未来）元素。

**编辑：**

鉴于问题的变化：如果切换意味着只是隐藏整个评论列表，您必须手动进行。

我建议你有单独的显示/隐藏按钮（你也可以在改变状态时显示和隐藏按钮），因为如果没有，它会变得更复杂。

例如，在帖子/索引中：

```
<h1>Posts</h1>
<% @posts.each do |post| %>
    <%= form_for post, remote: true do |f| %>
        <%=  post.content %>
        <div id="post_<%= post.id %>">
          <%= link_to "show", post, remote: true %>
        </div>

        <div class="post-comments" id="post_comments_<%= post.id %>">
        </div>
    <% end %>
<% end %> 
```

在评论/_comments.html.erb

```
<% @comments.each do |comment| %>
    <%= comment.content %>
<% end %>
<%= link_to "hide", '#', class: "hide-comments"  %> 
```

并在帖子/show.js.erb

```
$('#post_comments<%= @post.id %>').html('<%= j render "comments/comments" %>') 
```

并在 assets/javascripts/posts.js 中（确保将其包含在 application.js 中）

```
$(document).ready(function() {
    $('.hide-comments').click(function(e) {
      e.preventDefault();
      $(this).parent().hide();
    });
}); 
```

主干.js 是一个很棒的工具，如果你要用这些评论做很多事情，比如 CRUD 等，你需要留在一个页面上 - 使用主干.js。如果没有，请坚持使用 jQuery。

# c++ - 如何以干净的方式初始化这个数组？

> ID：14796527
> 
> 赞同：0
> 
> 时间：2013-02-10T09:57:56.867
> 
> 标签：c++

我正在尝试用 C++ 初始化这个数组：

**C++**

```
#include<iostream>
using namespace std;

int main(){
int arr[100];
int i = 10;
    while(i){
        cin >> arr[--i];
    }
return 0;
} 
```

这会`array`完美地初始化，但它会返回一个`negative status`. 我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:03:50.907

状态码意味着程序没有到达你的 main() 函数的最后一行（它应该是 return 0），而是被杀死了。我猜你只是用 CTRL+C 停止了它。

# javascript - jquery中使用值的公式化

> ID：14796530
> 
> 赞同：0
> 
> 时间：2013-02-10T09:58:26.383
> 
> 标签：javascript, jquery

我正在学习 jquery，所以我在这里创建了这个小提琴[http://jsfiddle.net/8FXFE/17/](http://jsfiddle.net/8FXFE/17/)

这是我的 html 代码

```
<div class="textForm">
<input type="radio" name="txtNumber" value="100" checked="checked" />100
<input type="radio" name="txtNumber" value="200" />200
<input type="radio" name="txtNumber" value="500" />500
<input type="radio" name="txtNumber" value="1000" />1000
<input type="radio" name="txtNumber" value="10000" />10000
<input type="radio" name="txtNumber" value="other" />other
<input type="text" name="other_field" id="other_field" onblur="checktext(this);"
/>
</div>
<div class="formText">
    <input type="radio" name="txtSpace" value="RJ" checked="checked"
    />Space 1.
    <br />
    <input type="radio" name="txtSpace" value="SM" />Space 2.
    <br />
</div>

<h3>Output:</h3> 
```

这是CSS

```
#other_field {
 display: none;
} 
```

这是jQuery

```
$(document).ready(function () {
console.log("parsed");
$("input[name='txtNumber'],input[name='txtSpace']").change(function () {
    $("#output").text("Changed to "+$("input[name='txtNumber']:checked").val() + " "                                    +$("input[name='txtSpace']:checked").val() + " +++++SOME FIXED VALUE OF TXTSPACE (i.e. SAY if RJ = 100 or if SM = 50) x VALUE OF TXTNUMBER++++++"
                    ); 
});
});

$(':radio').on('change', function () {
$('#other_field')[$(this).val() === 'other' ? 'show' : 'hide']();
});

$('#other_field').on('blur', function () {
var val = $(this).val();

if(isNaN(val)) {
alert('only numbers are allowed..');
}
else if(parseInt(val, 10) % 10 > 0) {
alert('only multiples of 10..');
}
}); 
```

我怎样才能实现那些在+++++++++++里面用大写字母显示的实际输出 TXTSPACE 的一些固定值（即如果 RJ = 100 或 SM = 50）x VALUE OF TXTNUMBER

另外我如何添加隐藏的 other_field 的动态值（如果选择）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:44:24.397

```
var value = $("input[name='txtNumber']:checked").val();
if(value == "other"){
    value = parseInt($("#other_field").val());
}
if(!value || isNaN(value)) value = 0;
var type = $("input[name='txtSpace']:checked").val();
var fixedMultiplier;
switch(type){
    case "RJ": fixedMultiplier = 100; break;
    case "SM": fixedMultiplier = 50; break;
    default: fixedMultiplier = 1; break;
}
var computedValue = value * fixedMultiplier;
$("#output").text("Changed to "+ value + " " + type + " (" + computedValue + ")"); 
```

[http://jsfiddle.net/8FXFE/19/](http://jsfiddle.net/8FXFE/19/)

Maybe you should also add a handler to the textfield to update output on keyup.

# mysql - Grails 2.2.0 mysql访问权限和权限

> ID：14796531
> 
> 赞同：0
> 
> 时间：2013-02-10T09:58:27.883
> 
> 标签：mysql, grails

我已经开始在 Mac OS X 上运行 grails 2.2.0 和 mysql（mysql Ver 14.14 Distrib 5.6.10，for osx10.7 (x86_64) using EditLine wrapper）出现奇怪的访问被拒绝错误。

```
引起：java.sql.SQLException：用户'nfuser'@'localhost'的访问被拒绝（使用密码：YES）
```

示例代码

```
数据源 {
    汇集=真
    driverClassName = "com.mysql.jdbc.Driver"
    用户名 = “nfuser”
    密码=“nfuser”
    方言 = org.hibernate.dialect.MySQL5InnoDBDialect
}
..
    发展 {
        数据源 {
            dbCreate = "create-drop" // 'create'、'create-drop'、'update'、'validate'、'' 之一
            url = "jdbc:mysql://localhost:3306/nf_dev"
        }
    }

```

通常的 grants 和 db create 在运行 grails 之前。

```
GRANT all ON nf_dev.* TO 'nfuser'@'%' 由 'nfuser' 标识；
```

用一个全新的项目进行测试，当然它可以工作..想法？

/S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:23:35.407

Duuh，dataSource.password 上的外部属性文件覆盖..

# java - 对树形图进行排序不起作用

> ID：14796535
> 
> 赞同：1
> 
> 时间：2013-02-10T09:59:06.807
> 
> 标签：java, android, sorting, treemap

我有一个基于以下结构的嵌套树形图，然后它从“2”继续：{具有相同的结构..

[http://pastebin.com/uKwAVz5L](http://pastebin.com/uKwAVz5L)

如您所见，它已经按“c13”子项（剧集编号）排序。但是当我在我的应用程序中使用树形图时，它显示如下：

[http://i50.tinypic.com/15o9vno.png](http://i50.tinypic.com/15o9vno.png)

他们甚至没有远程排序..但我不明白为什么？:O

在我的android应用程序中使用它时同样的问题..

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:05:56.230

[以下是有关TreeMap](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/TreeMap.html)的一些有价值的信息：

> SortedMap 接口的基于红黑树的实现。*此类保证映射将按键升序排序，根据键类的自然顺序*（请参阅**[Comparable](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html)**）或创建时提供的比较器排序，具体取决于使用的构造函数。
> 
> 请注意，如果该排序映射要正确实现 Map 接口，则**排序映射维护的排序**（无论是否提供显式比较器）**必须与 equals 一致。**（参见 Comparable 或 Comparator 以获得与 equals 一致的精确定义。）**这是因为 Map 接口是根据 equals 操作定义的，但是 map 使用它的 compareTo（或 compare）方法执行所有键比较**，所以两个键从排序图的角度来看，这种方法认为相等的元素是相等的。已排序映射的行为是明确定义的，即使它的排序与 equals 不一致；它只是不遵守 Map 接口的一般合同。

您是否正确实施了上述方法？

[Collections](http://docs.oracle.com/javase/1.4.2/docs/guide/collections/index.html)框架也有不同的实现（[这里](http://docs.oracle.com/javase/1.4.2/docs/guide/collections/overview.html)有一个概述）。如果 TreeMap 没有提供您想要的功能，您可以实现另一个并根据您的需要对其进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:26:08.603

尝试使用比较器：

```
TreeMap map = new TreeMap<Obj1, Obj2>(new ObjComparator());

private class ObjComparator() implements Comparator<Obj1> {
    public int compareTo(Obj1 o1, Obj1 o2) {
        return o1.compareTo(o2); // do your logic here
    }
} 
```

# java - 三元运算符

> ID：14796537
> 
> 赞同：6
> 
> 时间：2013-02-10T09:59:32.000
> 
> 标签：java, ternary

为什么以下代码的输出是 9.0 而不是 9 ？如果三元运算符只不过是 if-else 分支的简短形式，那么为什么 java 编译器将 int 提升为 double ？

```
public class Ternary
  {
public static void main(String args[])
     {
    int a = 5;
    System.out.println("Value is - " + ((a < 5) ? 9.9 : 9));
     }
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-10T10:02:52.767

> 如果三元运算符只不过是 if-else 分支的简短形式，那么为什么 java 编译器将 int 提升为 double ？

条件表达式具有单一类型，第二个和第三个操作数都将根据需要转换为单一类型。JLS 给出了确定表达式类型的规则，由于自动拆箱，这些规则稍微复杂一些。

条件运算符只是/构造的简写，但不是我认为您期望的那种简写*。*所以你的代码相当于这个：`if``else`

```
double value;
if (a < 5) {
    value = 9.9;
} else {
    value = 9;
}
System.out.println("Value is - " + value); 
```

它*不是*以下简称：

```
if (a < 5) {
    System.out.println("Value is - " + 9.9);
} else {
    System.out.println("Value is - " + 9);
} 
```

有关更多详细信息，请参阅[Java 语言规范的第 15.25 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.25)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:03:39.197

因为在这种情况下`conditional operator`（是的，它是*条件运算符*而不是*三元运算符*）的类型将是第三个操作数的提升类型，因为第二个和第三个操作数的类型不同。

[这在JLS 部分 - 15.25](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.25)中明确列出： -

> 否则，如果第二个和第三个操作数具有可转换（第 5.1.8 节）为数字类型的类型，则有以下几种情况：
> 
> *   如果其中一个操作数是 byte 或 Byte 类型，而另一个是 short 或 Short 类型，> 则条件表达式的类型是 short。
>     
>     
> *   如果其中一个操作数是 T 类型，其中 T 是 byte、short 或 char，而另一个操作数是 int 类型的常量表达式（第 15.28 节），其值可在类型 T 中表示，则条件表达式的类型为T。
>     
>     
> *   如果其中一个操作数是 T 类型，其中 T 是 Byte、Short 或 Character，而另一个操作数是 int 类型的常量表达式（第 15.28 节），其值可在 U 类型中表示，这是应用拆箱的结果转换为 T，则条件表达式的类型为 U。
>     
>     
> *   否则，二进制数值提升（第 5.6.2 节）将应用于操作数类型，条件表达式的类型是第二个和第三个操作数的提升类型。

请参阅最后一点，这在这里很有用。因此，在这种情况下，作为规则`binary numeric promotion`- 请参阅[JLS 第 5.6.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.6.2)： -

> *   如果任一操作数是 double 类型，则另一个操作数将转换为 double。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:02:19.447

因为整个表达式的类型是`double`，因为运算符的操作数之一是 a `double`。包含三元的表达式的类型由操作数决定，它们必须是相同的类型。在您的表达式的情况下，将`9`强制转换为 a`double`以使其与`9.9`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T10:03:12.037

Java 需要在编译时知道结果的类型。因此，由于此三元运算符可以生成 int 或 double，编译器选择 double 作为结果类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T10:02:30.930

实际上，三元运算符严格来说并不是 if/else 的缩写形式，因为它会在需要时执行类型转换。特别是，在您的情况下，[JLS 15.25](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.25)要求：

> 二进制数值提升（第 5.6.2 节）应用于操作数类型，条件表达式的类型是第二个和第三个操作数的提升类型。

如果您点击[§5.6.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.6.2)的链接：

> 如果任一操作数是 double 类型，则另一个操作数将转换为 double。

# android - 如何使用微调器和列表视图制作转换器

> ID：14796538
> 
> 赞同：0
> 
> 时间：2013-02-10T09:59:32.740
> 
> 标签：android

我为转换器制作了这个 xml，我需要它从微调器中的值转换，如英亩、公顷和......并在列表视图中给我结果

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".Main" >

<Spinner
    android:id="@+id/spinner1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true" />

<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/spinner1"
    android:layout_centerHorizontal="true"
    android:ems="10"
    android:inputType="number" >

    <requestFocus />
</EditText>

<ListView
    android:id="@+id/listView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/editText1"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="60dp" >
</ListView>

</RelativeLayout> 
```

我用java编写了这段代码：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.area);

    Spinner s1 = (Spinner) findViewById(R.id.spinner1);
    ListView lv1 = (ListView) findViewById(R.id.listView1);

    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
            this, R.array.Area, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.select_dialog_singlechoice);
    s1.setAdapter(adapter);
    lv1.setAdapter(adapter);
} 
```

我需要的是从微调器中获取值（如英亩值）并将结果插入到列表视图中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:07:34.197

您必须从微调器中选择选定的值，然后添加到列表视图。

# c# - 相同类型的对象的 InvalidCastException - 自定义控件加载

> ID：14796546
> 
> 赞同：28
> 
> 时间：2013-02-10T10:00:19.293
> 
> 标签：c#, asp.net, compiler-construction, user-controls, dynamic-compilation

我有一个非常有线的错误，我的一个自定义控件似乎是创建两个编译文件，当我尝试动态加载它时`LoadControl()`只是失败，因为无法将一个转换为另一个 - 即使它们完全相同。我写消息看，都是一样的，只是改了编译好的dll。

```
System.Web.HttpUnhandledException (0x80004005):     
 Exception of type 'System.Web.HttpUnhandledException' was thrown. --->             
    System.InvalidCastException:
[A]ASP.Modules_OneProduct_MedioumImage cannot be cast to
[B]ASP.Modules_OneProduct_MedioumImage.         

   Type A originates from 'App_Web_kg4bazz1, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'
in the context 'Default'
    at location 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\80ed7513\10eb08d9\App_Web_kg4bazz1.dll'.          

   Type B originates from 'App_Web_oneproduct_mediumimage.ascx.d1003923.4xoxco7b, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' 
in the context 'Default'    
    at location 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\80ed7513\10eb08d9\App_Web_oneproduct_mediumimage.ascx.d1003923.4xoxco7b.dll'. 
```

## 编码

这是我完全遵循[MSDN 上所写内容](http://msdn.microsoft.com/en-us/library/c0az2h86(v=vs.100).aspx)后的代码：

```
foreach (int OneProductID in TheProductIdArrays)
{
    // here is the throw.
    ASP.Modules_OneProduct_MedioumImage OneProduct = 
        (ASP.Modules_OneProduct_MedioumImage)LoadControl(@"~/mod/OneProduct_MediumImage.ascx");

    // do some work with 
    //OneProduct
} 
```

以前我没有加载控件，`ASP.`但是在出现此错误并寻找解决方案之后，我严格遵循 MSDN 上的内容。无论我做什么，错误仍然存​​在。

我也尝试过这两种方法，一种是单独的，另一种是一起的（再次失败）

```
<%@ Register src="~/mod/OneProduct_MediumImage.ascx" tagname="OneProduct_MediumImage" tagprefix="uc1" %>
<%@ Reference Control="~/mod/OneProduct_MediumImage.ascx" %> 
```

## 配置

我的 web.config，我尝试了`maxBatchSize`20、100、1000，也有`optimizeCompilations`true 或 false，但错误再次出现。

```
<compilation debug="false" defaultLanguage="C#" batch="true"
maxBatchSize="800" batchTimeout="10800" optimizeCompilations="false"
targetFramework="4.0"> 
```

## 现在有一些关于

*   该错误是随机的，在某些编译中出现，在其他一些不出现。
*   这个项目很大，页面上每分钟都有很多人要求看东西，但当里面没有人时也会出现。
*   在 64 位 dot.net 4 上运行，集成
*   作为网络花园运行，但也经过测试，单独使用一个池（并遇到相同的问题）
*   整个项目的会议已结束。
*   这些页面是从 2007 年开始运行的，但这个问题是在上个月出现的，不幸的是我找不到开始的位置和方式，或者是什么触发了它，因为我迟到了几天才看到它。
*   似乎只有一个自定义控件加载，调用繁重的那个。
*   我已经将代码更改了 4 次，进行了小更改或大更改，但仍然存在。
*   我尝试过`optimizeCompilations`真假和同样的问题。
*   我也尝试过停止网络，删除所有临时文件，重新打开，然后又出现了。
*   当应用程序开始只锁定一个编译时，我尝试在 global.asax 上放置一个互斥锁，但这也失败了。
*   从起作用的那一刻起，一切都很好，但如果不起作用，则不会自动更正。
*   我加载此自定义控件的代码存在并在代码的多个位置、不同页面上调用。
*   其他具有类似负载的自定义控件没有任何问题。
*   此自定义控件禁用 ViewState。
*   我也尝试重新定位一些代码，通过微优化更改完整的函数调用，不再失败。
*   ~~在开发计算机上工作正常~~。我`batch="true"`放在 web.config 上，错误立即出现。
*   没有其他类似的问题，例如我们无论如何都无法修复的错误。系统运行了好几天，池根本没有回收，内存稳定，还有更多的免费使用。该程序已运行多年，但我们几乎每天都在更新。
*   在相同的核心代码下运行多个站点（例如 stackexchange）并且都具有相同的随机问题。
*   AutoEventWireup 为假
*   它出现在我以相同方式加载的其他自定义控件上。

当出现此错误时，我现在做的解决方法是：我只是强制项目重新编译并进行少量更改，然后错误消失，直到下一次更新。

我有一个错误，试图解决最后几周的树，却找不到原因。我已经尝试了几乎所有我能做的事情，但都失败了，并且错误再次出现。所以我在这里发帖也许有些人可以帮助我并找到解决办法。

最后一句话：这个错误很疯狂，自定义控件是一样的，我在它上面做任何事情我只动态加载它并繁荣，编译器出于某种只有他知道的原因有两次不同的时间 - 随机。

## 更新 1

我能够在开发人员机器上重现该错误。在那里我发现包含这个自定义控件的两个 dll 模块有不同的。

一个是捆绑在一起的 4 个自定义控件。另一个模块是单独的自定义控件。

## 解决方法

在尝试修复此错误的树数周后，我最终发现，当编译器批量编译目录并将许多不同的自定义控件捆绑在同一个 dll 中时，会出现此错误。所以当我尝试单独加载它时抛出这个异常。

所以我将有问题的自定义控件单独移动到不同的目录中，似乎我现在避免使用它。

## 更新 2

再次出现，即使在我将一些文件移动到不同的目录之后。是随机的，找不到明确的关联是什么触发了它。

## 更新 3

因为我们发现这里的主要问题是在`batch="true"`同一个 dll 上编译许多自定义控件的批处理编译 ()，所以对编译器说不要这样做的一种方法是[`maxBatchGeneratedFileSize`](http://msdn.microsoft.com/en-us/library/system.web.configuration.compilationsection.maxbatchgeneratedfilesize.aspx)参数。我使用它的值为 100，问题再次出现，现在我将它降低到 40 并测试它。

```
maxBatchGeneratedFileSize="40" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T17:13:46.830

当您打开批处理并在目录级别具有某种形式的循环引用时，可能会发生这种情况。

请参阅此[答案](https://stackoverflow.com/questions/14784369/error-cs0433-in-large-precompiled-asp-net-website-project)以确切了解我在这种情况下所说的“循环引用”是什么意思，因为含义非常微妙。

如果您设法打破循环（例如，通过将用户控件移动到别处），您将不会遇到此问题。

## 更新 1

我认为从理论上讲，这只能由循环引起，但有时它们很难被发现。

我会给你一个我认为可行并且很容易尝试的替代解决方案（即使它有点小技巧）。在给您带来问题的用户控件中，在指令中添加以下属性：

```
<%@ Control Language="C#" [...] CompilerOptions="/define:dummy1" %> 
```

如果您在其他一些控件中看到此内容，则可以添加相同的内容，但使用 dummy2、dummy3 等...

这将产生不批处理这一用户控件的效果，因为它与其他用户控件具有不同的编译需求。从技术上讲，您可以添加任何 C# 命令行作为 . `CompilerOptions`，但虚拟`/define`是最简单和最无害的。

但与全局关闭批处理不同，性能影响将是最小的，因为只有很小的页面子集不会被批处理。

顺便说一句，不言而喻，您看到的是 ASP.NET 中的一个错误，而且该错误可能已经存在 10 多年了！也许在某个时候它应该得到解决:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T09:46:51.267

为了跟踪问题的原因，我认为了解您的控件是如何创建的很重要。请参考这篇文章：[Turing an .ascx User Control into a Redistributable Custom Control](http://msdn.microsoft.com/en-us/library/aa479318.aspx)。

> **步骤 1：创作用户控件**
> 
> 要创作用户控件，最好从一个只包含 ascx 的空应用程序开始。虽然用户控件的创作使用“标准”技术，但您需要注意一些限制，以便成功地将其转换为独立的自定义控件。 **主要限制是用户控件需要自包含**。也就是说，它不能依赖于应用程序全局的东西，如 App_Code 或 global.asax。这样做的原因是，由于目标是将 UserControl 变成一个独立的 DLL，**如果它依赖于不属于该 DLL 的代码，它将在其他应用程序中中断**. 此规则的一个例外是 UserControl 可以依赖于 bin 目录（或 GAC）中的程序集。当您在其他应用程序中使用自定义控件时，您只需确保其他程序集始终可用。

和

> **第 3 步：使用 Publish 命令预编译站点**
> 
> (...) 选择“使用固定命名和单页程序集”。**这将保证您的用户控件将被编译成一个单独的程序集，该程序集的名称基于 ascx 文件**。如果您不选中此选项，您的用户控件可能会与其他页面和用户控件（如果有的话）一起编译，并且程序集将收到一个更难以使用的随机名称。

在我看来，您很可能将用户控件编译并在 GAC 中注册为一个单独的程序集，并且还包含在您的 Web 应用程序 DLL 中。

*注意：也许这应该是评论，但我想包括上述链接中的引号。我希望它会有所帮助。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-14T23:43:25.173

在升级的 ASP.NET 网站上进行大量调试后，我的最后一个错误是运行时的这个错误。

我刚刚检查了构建/发布选项“使用固定命名和单页程序集”，它解决了我的情况:)

这里有一些有用的链接：[https ://msdn.microsoft.com/en-us/library/hh475319(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/hh475319(v=vs.110).aspx)

[https://msdn.microsoft.com/en-us/library/aa479044.aspx](https://msdn.microsoft.com/en-us/library/aa479044.aspx)

[http://forums.asp.net/t/960707.aspx](http://forums.asp.net/t/960707.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T22:51:55.757

我最近在编译 asp.net MVC 4 的修改版本并将新的 DLL 导入项目时遇到了类似的问题。

不知何故，我在 web.config 中引用了旧版本的 DLL（包括视图文件夹中的 web.config）

在我的情况下，由于两个 DLL 是不同的版本而引发了错误。4.0.0 和 4.1.0。也许你应该调查一下。也许指定编译文件的版本（我猜是 DLL）

我希望这可以帮助您解决问题。

其他提示：我猜你有某种版本控制系统？如果是，请在此开始之前恢复所有更改，并仔细查看代码以及哪些模型/控件更改以及如何更改。如果您不使用 VCS……您无法恢复更改。你应该开始使用 VCS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T09:04:56.553

我注意到有时设计器会创建第二个 CodeBehind 设计器文件，例如您将拥有：

```
OneProduct_MediumImage.ascx
OneProduct_MediumImage.ascx.cs
OneProduct_MediumImage.ascx.designer.cs
OneProduct_MediumImage.ascx.designer1.cs 
```

如果解决方案资源管理器集中没有“显示所有文件”选项，您不会注意到，但对于 Web 项目，编译器将编译文件夹中的所有文件，而不仅仅是项目中包含的文件。

其次，如果您的项目是“网站项目”，则没有命名空间，这可能会导致许多奇怪的错误。看看这个 SO 问题：[Namespace problem .net](https://stackoverflow.com/a/5173232/928483)

最后，我设法通过`ClassName`在控制文件上设置属性来解决看似随机的 UserControl 错误，例如：

```
<%@ Control Language="cs" 
    AutoEventWireup="false" 
    CodeBehind="OneProduct_MediumImage.ascx.cs" 
    Inherits="ASP.Modules_OneProduct_MedioumImage"
    ClassName="OneProduct_MediumImageControl" %> 
```

# jquery - 从 Jquery 对话框返回数据时，布尔验证返回错误值

> ID：14796547
> 
> 赞同：0
> 
> 时间：2013-02-10T10:00:23.850
> 
> 标签：jquery, jquery-ui

我遇到了一个新的头痛。谁能告诉我 2500 > 30 什么时候是假的？这是我现在遇到的头痛类型，这与我的 JQuery UI 混淆了，因为我需要这些布尔验证才能工作。

这就是我所拥有的：

```
function execute () {
        amountReturn = ($('#modalInputAmount').val());
        console.log(amountReturn);
        console.log(available);
        var isValid = (available < amountReturn)? false : true;
        console.log('AmountReturn:' + amountReturn + ' ; available:' + available + ':' + isValid);        
        if ((isNaN(amountReturn)) || !(isValid)) {
            $('#amountDialog').dialog('close');
            $("#weHaveANaN").dialog("open");
        } else {
            //dosomething         
        }
} 
```

所以，在我第一次在我的页面上打开对话框后，它就可以正常工作了。然而，在关闭它并重新打开它之后，它只在某些时候起作用。从字面上看，只是有时。始终收到来自 amountReturn 和 available 的正确值。但是，对于事情的阴暗面，我现在得到了这样的回应： ![奇怪的回报](../Images/525c8a3c1715291d4bd7dfe2adfc6f2a.png)

正如我所指出的，这些值是从 Jquery 对话框输入框返回的。尽管如此，这仍然不应该干扰我的布尔表达式，并且如此处所示，超过可用（30）的amountReturn（2500）应该是无效的，它被标记为有效。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:08:52.783

不确定，但你可以在比较之前先做 parseInt，比如

```
var amountReturn = parseInt( $('#modalInputAmount').val(), 10);
var available = parseInt( available, 10 );
//then compare
var isValid = (available < amountReturn)? false : true; 
```

# animation - 将动画添加到 BlackBerry 中的按钮

> ID：14796551
> 
> 赞同：0
> 
> 时间：2013-02-10T10:00:45.667
> 
> 标签：animation, button, blackberry, imagebutton

我想在我在 BlackBerry 应用程序中创建的按钮上使用动画。当我第一次单击按钮时，动画效果很好。第一次单击时，按钮开始动画（闪烁）。在第二次单击时闪烁停止。但是，当我再次单击该按钮（第三次）时，应该会再次开始闪烁。但是，我收到一个错误：

```
App Error 104 Uncaught: IllegalStateException 
```

创建Button和添加动画的代码如下：

```
 final Bitmap image000 = Bitmap.getBitmapResource("panic.png");
 final Bitmap image001 = Bitmap.getBitmapResource("panicon.png");

 final Timer animationTimer = new Timer();

 final BitmapField animationField = new BitmapField(image000,BitmapField.FOCUSABLE){

     protected boolean navigationClick(int status, int time)
     {
           if(flag){
                   animationTask.cancel();
                   flag=false;
           }else{
                   animationTimer.scheduleAtFixedRate(animationTask, 0, 100);
                   flag=true;
           }

        return true;
     }

 };

 animationTask = new TimerTask() {
     public void run() {
         if(counter == 0){
             animationField.setBitmap(image000);
         }
         if(counter == 1){
             animationField.setBitmap(image001);
             counter = -1;
         }

         counter++;
     }
 };

 add(animationField); 
```

编辑：我调试了我的代码，错误发生在启动线程的循环中。取消线程似乎很好。我迷路了是什么问题。请指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T05:35:56.050

尝试这个 -

```
TimerTask animationTask;
BitmapField animationField;
final Bitmap image000 = Bitmap.getBitmapResource("panic.png");
final Bitmap image001 = Bitmap.getBitmapResource("panicon.png");
final Timer animationTimer = new Timer();
animationField = new BitmapField(image000,BitmapField.FOCUSABLE){
    protected boolean navigationClick(int status, int time)
           {
             if(flag){
                 animationTask.cancel();
                 flag=false;
             }else{
                 animationTask = new TimerTask() {
                        public void run() {
                            if(counter == 0){
                                animationField.setBitmap(image000);
                            }
                            if(counter == 1){
                                animationField.setBitmap(image001);
                                counter = -1;
                            }
                    counter++;
                        }
                     };
                 animationTask.run();
                 animationTimer.scheduleAtFixedRate(animationTask, 0, 100);
                 flag=true;
             }

              return true;
           }

     };
 animationTask = new TimerTask() {
        public void run() {
            if(counter == 0){
                animationField.setBitmap(image000);
            }
            if(counter == 1){
                animationField.setBitmap(image001);
                counter = -1;
            }
counter++;
        }
     };

add(animationField); 
```

# .net - C# 中有没有办法分别用另一个集合替换一个字符集合？

> ID：14796552
> 
> 赞同：1
> 
> 时间：2013-02-10T10:00:47.530
> 
> 标签：.net, regex, string, replace

在 C# 中有没有办法将一个字符集合分别替换为另一个集合，如下所示：

```
"ABCDEF.KindOfReplace( "AE", "12"); // the result: "1BCD2F" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:14:35.983

不，没有，但在我看来，您的代码相当于：

```
var myString = "ABCDEF";
var newString = myString.Replace("A", "1").Replace("E", "2"); 
```

您可能可以编写一个扩展方法来使它更好，但对于大型替换数组，它不会特别有效。

编辑：

正如下面评论中所指出的，您可以`StringBuilder`在需要替换大量字符串/字符的情况下使用 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:11:23.673

不，不是直接的。您必须使用字符串原语或正则表达式自己构建它。

一个简单的实现可能是：

```
public static string KindOfReplace(this string original, string charsToReplace, string replacements)
{
    var replacementDic = charsToReplace.Select((ch,i) => new { ch, i }).ToDictionary(x => x.ch, x => replacements[x.i]);
    var result = original.Select(ch => replacementDic.ContainsKey(ch) ? replacementDic[ch] :ch);
    return new String(result.ToArray());
} 
```

（上面是一个例子，记得为相同长度的字符串添加保护，等等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T11:06:12.207

开箱即用没有这样的功能。如果您手工制作某些东西，这可能是许多可能的解决方案之一。它操作一个字符数组并使用[IndexOfAny](http://msdn.microsoft.com/en-us/library/system.string.indexofany.aspx)来查找要替换的字符。

```
public static string KindOfReplace( this string src, string find, string repl)
{
    char[] target = src.ToCharArray();
    char[] findChars = find.ToCharArray();
    int finder = src.IndexOfAny(findChars);
    while(finder>-1)
    {
        int charFind = find.IndexOf(src[finder]);
        target[finder] = repl[charFind];
        finder = src.IndexOfAny(findChars, finder+1);
    }
    return new String(target);
} 
```

# asp.net - 如何使用 ajax post & knockout 将 JSON 数据发布到 SQL

> ID：14796553
> 
> 赞同：0
> 
> 时间：2013-02-10T10:01:02.063
> 
> 标签：asp.net, json, knockout.js

我有一个非常简单的视图模型：

```
 var ProjectViewModel = {
        ProjectName: ko.observable().extend({ required: "" }),
        ProjectDescription: ko.observable().extend({ required: "" }),
        ProjectStartDate: ko.observable(),
        ProjectEndDate: ko.observable()
    }; 
```

我想将位于我的视图模型中的这些数据保存到我的 SQL 服务器。我有一个类在我的服务器端代码中定义这个视图模型：

```
 public class Projects
{
    public string ProjectName { get; set; }
    public DateTime ProjectStartDate { get; set; }
    public DateTime ProjectEndDate { get; set; }
    public string ProjectDescription { get; set; }

} 
```

我也有这个网络方法来接收代码：

```
 [WebMethod]
    public bool SaveProject(string[] JSONDATA)
    {
        TaskNinjaEntities entities = new TaskNinjaEntities();

        foreach (var item in JSONDATA)
        {
            Console.WriteLine("{0}", item);
        }

        return true;      

    } 
```

最后我有这个不想将数据发送到服务器的 POST：

```
function SaveMe() {

        var data = ko.toJSON(ProjectViewModel);
        $.post("CreateProject.aspx/SaveProject", data, function (returnedData) {
        });
    } 
```

我从这个 post 方法中返回的数据中什么也没得到，还在服务器端代码中添加了断点，它根本没有命中它。我的 URL 是正确的，并且 Viewmodel 可以毫不费力地转换为 JSON。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:15:12.133

使 Web 方法静态化。

```
[WebMethod]
public static bool SaveProject(string[] JSONDATA)
{
    TaskNinjaEntities entities = new TaskNinjaEntities();

    foreach (var item in JSONDATA)
    {
        Console.WriteLine("{0}", item);
    }

    return true;         

} 
```

# mysql - 此相关子查询的更高效版本

> ID：14796554
> 
> 赞同：1
> 
> 时间：2013-02-10T10:01:09.900
> 
> 标签：mysql, sql, subquery, correlated-subquery

我有 3 个不同的表，我需要从其中 2 个中提取数据一次，从第三个中提取两次。这些表是`jobs`、`customers`和`customers_attributes`。我正在尝试为特定工作提取数据，其中部分数据是有关拥有该工作的客户的信息。客户数据存储在`customers_attributes`数据类型定义为与类型对应的整数的位置（为简单起见，此处使用字符串），然后内容字段包含数据本身。

`customers_attributes`在这种情况下，我需要从与工作对应的客户对应的表中提取 2 行。'PhoneNumber' 的一行，'CustomerInfo' 的另一行。我对其中一个使用了 INNER JOIN，但是因为我不能为两者放置 WHERE 值，所以我对另一个使用了子查询。我认为这真的很讨厌，我相信必须有一种更清洁的方式来做到这一点：

```
SELECT jobs.*, customers.Name AS CustomerName,
       customers_attributes.Content AS PhoneNumber,
       (     SELECT `Content`
             FROM customers_attributes
             WHERE Type = 'CustomerInfo' AND ForeignCustomer = jobs.Customer
             LIMIT 1) AS CustomerInfo
FROM jobs
INNER JOIN customers ON jobs.Customer = customers.ID
INNER JOIN customers_attributes ON jobs.Customer = customers_attributes.ForeignCustomer
WHERE jobs.ID = $jobID AND customers_attributes.Type = 'PhoneNumber'
LIMIT 1 
```

我应该提一下，如果客户有超过 1 个工作，则同一属性可能有多个行，理想情况下，此查询应该返回最新信息，或者与工作同时提交的信息（基于相应的身份证件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:36:59.063

只需以不同的别名再次加入同一个表。

```
SELECT j.*, c.Name AS CustomerName,
       ca.Content AS PhoneNumber,
       ca2.Content as CustomerInfo
FROM jobs j
INNER JOIN customers c ON j.Customer = c.ID
INNER JOIN customers_attributes ca ON (j.Customer = ca.ForeignCustomer)
INNER JOIN customers_attributes ca2 ON (j.Customer = ca2.ForeignCustomer)
WHERE j.ID = '$jobID' 
  AND ca.Type = 'PhoneNumber'
  AND ca2.Type = 'CustomerInfo'
LIMIT 1 
```

**警告**
看起来您正在使用 PHP。如果您*必须*坚持使用过时的`mysql_`库而不是改进很多的`mysqli_`库。请记住使用`mysql_real_escape_string()`并引用您的`$vars`.
否则，您将被 SQL 注入问题所掩盖。

# python - Python 字典排序

> ID：14796561
> 
> 赞同：0
> 
> 时间：2013-02-10T10:01:50.667
> 
> 标签：python, sorting, dictionary

我有一本像

```
>>> x = {'a':2, 'c': 1, 'b':3} 
```

字典中没有可用的方法来按值对字典进行排序。我使用

```
>>> sorted_x = sorted(x.iteritems(), key=operator.itemgetter(1))
>>> sorted_x
[('c', 1), ('a', 2), ('b', 3)] 
```

`sorted_x`但是现在当我使用循环再次转换为字典时。喜欢

```
>>> new_dict = {}
>>> for i in sorted_x:
    new_dict[i[0]] = i[1]
>>> new_dict
{'a': 2, 'c': 1, 'b': 3} 
```

再次未`new_dict`排序。为什么python字典不能按键排序？任何人都可以阐明它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:05:44.360

字典未排序。它们只是键和值之间的映射。

如果要排序字典，请使用`collections.OrderedDict`：

```
>>> import collections
>>> d = collections.OrderedDict(sorted_x)
>>> d
    OrderedDict([('c', 1), ('a', 2), ('b', 3)])
>>> d['c']
    1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:07:32.330

python中的字典是哈希映射。键被散列以保持对元素的快速访问。

这意味着在内部必须根据它们生成的哈希对元素进行排序，而不是根据您要给出的顺序。

# c++ - 为什么这比 memcmp 慢

> ID：14796562
> 
> 赞同：3
> 
> 时间：2013-02-10T10:01:51.903
> 
> 标签：c++, visual-c++, sse, memcmp

我正在尝试比较两行`pixel`s。

A`pixel`被定义为`struct`包含 4 个`float`值 (RGBA) 的 a。

我不使用的原因`memcmp`是因为我需要返回第一个不同像素的位置，但这`memcmp`是不行的。

我的第一个实现使用`SSE`内在函数，并且比以下速度慢约 30% `memcmp`：

```
inline int PixelMemCmp(const Pixel* a, const Pixel* b, int count)
{
    for (int i = 0; i < count; i++)
    {
        __m128 x = _mm_load_ps((float*)(a + i));
        __m128 y = _mm_load_ps((float*)(b + i));
        __m128 cmp = _mm_cmpeq_ps(x, y);
        if (_mm_movemask_ps(cmp) != 15) return i;
    }
    return -1;
} 
```

然后我发现将值视为整数而不是浮点数会加快速度，现在只比`memcmp`.

```
inline int PixelMemCmp(const Pixel* a, const Pixel* b, int count)
{
    for (int i = 0; i < count; i++)
    {
        __m128i x = _mm_load_si128((__m128i*)(a + i));
        __m128i y = _mm_load_si128((__m128i*)(b + i));
        __m128i cmp = _mm_cmpeq_epi32(x, y);
        if (_mm_movemask_epi8(cmp) != 0xffff) return i; 
    }
    return -1;
} 
```

从我读到的其他问题来看，MS 的实现`memcmp`也是使用`SSE`. 我的问题是 MS 实现还有哪些我没有的技巧？即使进行逐字节比较，它如何仍然更快？

对齐是个问题吗？如果`pixel`包含 4 个浮点数，是否已经在 16 字节边界上分配了像素数组？

我正在编译`/o2`所有优化标志。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T11:02:39.090

您可能想检查这个[memcmp SSE 实现](https://gist.github.com/karthick18/1361842)，特别是`__sse_memcmp`函数，它从一些健全性检查开始，然后检查指针是否对齐：

```
aligned_a = ( (unsigned long)a & (sizeof(__m128i)-1) );
aligned_b = ( (unsigned long)b & (sizeof(__m128i)-1) ); 
```

如果它们*没有*对齐，它会逐字节比较指针，直到对齐地址的开始：

```
 while( len && ( (unsigned long) a & ( sizeof(__m128i)-1) ) )
{
   if(*a++ != *b++) return -1;
   --len;
} 
```

然后将剩余内存与类似于您的代码的 SSE 指令进行比较：

```
 if(!len) return 0;
while( len && !(len & 7 ) )
{
__m128i x = _mm_load_si128( (__m128i*)&a[i]);
__m128i y = _mm_load_si128( (__m128i*)&b[i]);
.... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T11:25:28.527

我已经使用 SSE（和 MMX/3DNow！）编写了 strcmp/memcmp 优化，第一步是确保数组尽可能对齐 - 您可能会发现您必须执行第一个和/或最后一个字节“一个一次”。

如果您可以在数据进入循环之前对齐数据[如果您的代码进行分配]，那么这是理想的。

第二部分是展开循环，所以你不会得到这么多“如果循环不在结尾，跳回循环的开头”——假设循环很长。

您可能会发现在执行“我们现在离开”条件之前预加载输入的下一个数据也有帮助。

编辑：最后一段可能需要一个例子。此代码假定至少有两个展开循环：

```
 __m128i x = _mm_load_si128((__m128i*)(a));
 __m128i y = _mm_load_si128((__m128i*)(b));

 for(int i = 0; i < count; i+=2)
 {
    __m128i cmp = _mm_cmpeq_epi32(x, y);

    __m128i x1 = _mm_load_si128((__m128i*)(a + i + 1));
    __m128i y1 = _mm_load_si128((__m128i*)(b + i + 1));

    if (_mm_movemask_epi8(cmp) != 0xffff) return i; 
    cmp = _mm_cmpeq_epi32(x1, y1);
    __m128i x = _mm_load_si128((__m128i*)(a + i + 2));
    __m128i y = _mm_load_si128((__m128i*)(b + i + 2));
    if (_mm_movemask_epi8(cmp) != 0xffff) return i + 1; 
} 
```

大致是这样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:12:57.250

我无法直接帮助您，因为我使用的是 Mac，但有一种简单的方法可以弄清楚会发生什么：

您只需在调试模式下进入 memcpy 并切换到反汇编视图。由于 memcpy 是一个简单的小函数，您将轻松找出所有实现技巧。

# wordpress - WordPress 处理 $_POST 内部解析请求

> ID：14796568
> 
> 赞同：3
> 
> 时间：2013-02-10T10:02:32.037
> 
> 标签：wordpress, rewrite

我正在编写一个应用程序来接收和处理 wordpress 中的即时付款通知消息。它是对带有重写规则的“虚拟”url 发出的 POST 请求。然而问题是只有 GET 变量是可访问的，我无法访问 post 变量：

两者： 导致一个空数组`print_r($wp->query_vars['ccustfirstname']);
print_r($_POST);`

我修改了现有代码以匹配我的情况：

```
function ao_add_rewrite_rule() {
        print_r($_REQUEST);
     $ipn_parameters=array("ccustfullname","ccustfirstname", ... );
    foreach ($ipn_parameters as $key => $value) {
    add_rewrite_tag("%$value%",".");    
    }

  add_rewrite_tag("%arevico_api%",".","");
  add_rewrite_rule( 'ipn', 'index.php?&arevico_api=ipn', 'top');
  add_rewrite_rule( 'hoplink', 'index.php?&arevico_api=hop', 'top');
  add_rewrite_rule( 'pay', 'index.php?&arevico_api=pay', 'top');
  flush_rewrite_rules();//TODO: call only when needed
}

add_action( 'parse_request', 'wpse9870_parse_request' );
function wpse9870_parse_request( &$wp )
{   

    if (!empty($wp->query_vars['arevico_api'])) {

        switch ($wp->query_vars['arevico_api']){
            case "ipn":
            print_r($wp->query_vars['ccustfirstname']); 
            print_r($_POST);    

            die();
        //  require_once(AREVICO_PLG_BP . "ipn.php");
        //  $ArevicoIPN=new ArevicoIPN();
            break ;

            default:

            break;
        }
    } 
    return;
} 
```

请注意，arevico_api get 参数确实会达到低谷，但 POST 参数不会。我正在通过用于 chrome 的 Simple Rest Client 发送示例发布数据来测试应用程序。如何访问帖子参数

# iphone - 如何在ios启动画面上实现mp4动画？

> ID：14796569
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:02:46.373
> 
> 标签：iphone, ios

我想知道如何将启动画面替换为 mp4 电影。

如果可能的话，请告诉我如何使用代码。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:19:19.243

这在 iOS 下是不可能的（也许有一天）

许多应用程序模拟它的方法是将视频的第一帧静态加载为 png 闪屏，然后快速完成并从 applicationDidFinishLaunching 返回 YES 甚至在加载任何内容之前：D

然后他们以全屏视图和背景显示视频，真正加载应用程序！

* * *

1.  将静态图像作为 Default.png
2.  等待调用 applicationDidFinishLaunching：
3.  放置一个电影视图全屏并播放您的视频
    3b。开始真正加载应用程序：视图控制器、核心数据堆栈……随便什么
4.  等待调用 applicationDidReallyLaunch（或任何您选择的名称），删除视频

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:33:46.900

1.  同步 Default.png 图像和 mp4 视频首屏。
2.  在调用应用程序 didFinishLaunchingWithOptions 时使用 AVPlayer 播放 mp4 视频全屏：
3.  视频，如果播放器确实到达结束，则删除 AVPlayer 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:48:39.403

如果你想把闪屏当作mp4动画，那么闪屏就没有意义了。因为

> 基本上，闪屏是您的应用程序首次加载时的样子的图像。使用闪屏可确保在加载应用程序时，用户不会从空白屏幕开始。而是显示初始屏幕。这会立即让用户与您的应用程序互动。当它完全加载时，启动屏幕然后消失，您的应用程序显示其第一个屏幕，准备使用。这通过创建您的应用程序立即加载的印象来改善用户体验。
> 
> 虽然 Apple 已明确表示启动屏幕旨在改善应用程序的用户体验，而不是为其显示“启动屏幕”。但许多开发人员正在利用此功能为他们的应用程序显示启动屏幕。

如果您想在开始时显示，则仅将视频的第一帧显示为启动画面，然后真正开始您的 mp4 动画。

# javascript - 为什么开发人员使用 href 等于 javascript？

> ID：14796575
> 
> 赞同：0
> 
> 时间：2013-02-10T10:03:05.810
> 
> 标签：javascript, href

为什么开发人员使用`href="javascript:;"`

例如：A 标签的内容：

```
<a class="anchor" title="title" href="javascript:;" id="someId">...</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:05:17.870

伪协议告诉浏览器下面`javascript:`是点击链接时应该执行的 JavaScript 代码。您的示例中接下来的内容是无操作的，因此单击该链接不会执行任何操作。通常，当链接不用作链接而是用作按钮时，将使用此选项，其中编码器想要的实际行为由`click`处理程序指定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:08:00.223

根据我的使用经验，如果人们使用`<a href="www.google.com">`我可以右键单击并在新选项卡上打开它。但如果是`href=javascript:openLink()`我无法在新标签页上打开它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T20:46:21.980

好问题。这样他们的链接就不会做任何事情。开发人员可能正在使用 Jquery 的[点击事件](http://api.jquery.com/click/)或类似的东西动态添加 javascript 函数。

这似乎是人们遗留下来的坏习惯。他们可能想要 href 的样式，但不想要它的功能。您可以轻松地做到这一点，而无需使用 href。在某种程度上，他们说“这是链接的价值”，然后立即“忽略我的链接的价值”。

这里有一个很好的讨论：[Unobtrusive Javascript](https://stackoverflow.com/questions/134845/href-attribute-for-javascript-links-or-javascriptvoid0#answer-9440536)

[根据 w3schools](http://www.w3schools.com/tags/att_a_href.asp)，href 的值应该是 url 或脚本。当有人这样做`href="javascript:;"`

他们正在使用什么都不做的脚本。他们只是这样做，以便他们可以使用 href 提供的样式/标签...在我看来，应该以另一种方式完成，例如使用 css 类。

同样根据[w3schools](http://www.w3schools.com/tags/tag_a.asp)，如果 href 不存在，则该标签不能使用某些其他属性，但在 HTML5 中，该标签只能用于超链接。

# c++ - c++ 中的 std::sort ？

> ID：14796577
> 
> 赞同：0
> 
> 时间：2013-02-10T10:03:13.643
> 
> 标签：c++, algorithm, sorting, vector, containers

我想在 C++ 中对`vector`使用算法进行排序。`sort`

`str`是`std::vector<int>`我要排序的名称。

这有什么区别：

```
std::sort(str.rend(),str.rbegin()) 
```

还有这个：

```
std::sort(str.begin(),str.end()) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T10:16:52.147

假设您打算使用`std::sort`对字符串进行排序（因为既没有方法`std::vector`也没有`std::string`方法`sort`），则第一个语句不正确并导致**未定义的行为**（UB）：

```
std::sort(str.rend(),str.rbegin()); 
```

在这里，`std::sort`将尝试取消引用`str.rend()`，这是一个“结束”迭代器。取消引用这样的迭代器是 UB。

正确使用反向迭代器是

```
std::sort(str.rbegin(),str.rend()); 
```

这将导致字符串/向量按降序排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T10:10:52.303

许多容器和其他东西（如 ）上的标准库中的迭代器`std::string`有多种以[(](http://en.cppreference.com/w/cpp/string/basic_string/rbegin)[等](http://en.cppreference.com/w/cpp/string/basic_string/rbegin)[)](http://en.cppreference.com/w/cpp/string/basic_string/rbegin)`reverse`开头。这些将以相反的顺序迭代。使用 just and将从头到尾以正确的格式对字符串进行排序。`r` [`rbegin()``rend`](http://en.cppreference.com/w/cpp/string/basic_string/rbegin)`begin``end`

尽量避免使用反向迭代器，只使用常规的`begin()`和`end()`你的字符串：

```
std::string str = "bacd";
std::sort( str.begin(),str.end() );
std::cout << str << std::endl; // should produce "abcd" on your output, without quotes 
```

编辑：

所以......你想`vector<int>`被排序吗？如果是这样，请执行与上述相同的操作，除了使用`std::sort`您的.`begin()``end()``std::vector<int>`

# javascript - 指令模板不评估表达式

> ID：14796579
> 
> 赞同：2
> 
> 时间：2013-02-10T10:03:16.763
> 
> 标签：javascript, angularjs

我今天刚开始玩 AngularJS 并且卡住了。请原谅咖啡稿和哈姆尔。

```
# some-js-file.js.coffee
app.directive "sr", ->
  restrict: "C"
  replace: true
  transclude: true
  scope:
    serviceRequest: "@servReq"
  template: "<div>" + "<div class=\"name\">{{service_request}}</div>" + "<div class=\"body\" ng-transclude></div>" + "</div>"
  link: (scope, element, attrs) ->
    scope.$watch 'serviceRequest', (serviceRequest) ->
      console.log scope.serviceRequest, serviceRequest
    # cool stuff

# index.html.haml
# more cool stuff...
.row{'ng-repeat' => 'service_request in service_requests'}
  .sr{'serv-req' => '{{service_request}}'}
    {{service_request.description}} 
```

循环和基本模板正在显示，除了 {{service_request}} 表达式没有被评估 - 只是空白。

您会注意到，在“链接：”部分中，我必须 $watch 才能使 console.log 工作的范围——它也没有评估 serviceRequest。这是怎么回事？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:10:35.720

如果`service_request`是一个对象（如`service_request.description`最后一行所示），那么您不能使用插值 ( `{{service_request}}`) 和基于属性的绑定 ( `@servReq`) 将其传递到指令中。

相反，您希望传递*实际*的JavaScript 值，因此您需要将 Haml 更改为

```
.sr{'serv-req' => 'service_request'} 
```

并更新您的指令以使用基于属性的双向绑定

```
scope:
  service_request: "=servReq" 
```

（您还需要在`service_request`此处下划线，因为这就是它在模板中的使用方式。）

很难真正说出你想要做什么，但这里有一个 jsFiddle 演示了这些变化：http: [//jsfiddle.net/BinaryMuse/Z7Bru/](http://jsfiddle.net/BinaryMuse/Z7Bru/)

# c# - 在 C# 安装程序中安装 3rd 方应用程序

> ID：14796583
> 
> 赞同：0
> 
> 时间：2013-02-10T10:03:50.617
> 
> 标签：c#, installation, custom-action

我在 VS2010 中创建了一个安装程序来安装我的应用程序，但它有一些第 3 方的先决条件，例如 python。我尝试将其他安装程序作为嵌入式资源包含在内，将它们提取为文件并运行它们（作为自定义操作）。它可以工作，但似乎不可能同时运行 2 个安装程序，所以当从我的安装程序安装这些安装程序时，我得到一个错误。

在我的应用程序安装期间如何安装这些 3rd 方应用程序？（属性页中的“先决条件”没有帮助，因为它们仅与 .NET 和 sql server 等 ms 内容相关......）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:14:20.420

您可以为此使用 System.Diagnostics.Process。它可以执行给定路径上的文件，例如 MySQL 服务器安装程序。[看到这个](https://stackoverflow.com/questions/8432858/how-to-install-3rd-party-prerequisites-on-c-sharp-msi)但是你需要提供可执行文件。正如 Ramhound 在他的评论中建议的那样，看看商业产品来创作你的安装程序。有几个，包括我个人最喜欢的 Advanced Installer，提供了可以满足您初始要求的免费版本的工具。

根据先决条件的打包方式（MSI 或 EXE），如果不使用自定义操作或引导程序，您的 MSI 可能无法直接安装 prereq，该引导程序将在目标系统中搜索 prereq 并在它不存在时安装它目标系统。

顺便说一句，我与 Advanced Installer 没有任何关系，除了我已经成为付费客户几年了。除了可靠的产品外，他们的服务也非常出色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-09T18:27:08.660

我刚刚遇到了同样的问题。我使用[Bootstrapper Manifest Generator](http://archive.msdn.microsoft.com/bmg)来创建我的引导程序包，然后在我的安装项目中我选择了这些作为先决条件。先决条件之一也是 Python。根据安装日志，Python 安装将以代码 0 和状态“InstallFailed”退出。

我发现安装实际上成功了，但是 0 没有被识别为成功的退出代码。我在 BMG 的安装文件属性中修复了这个问题。有一个退出代码选项卡，您可以在其中手动输入退出代码和结果。我在 Success 的结果中添加了 0，重新构建了包，将其复制到 bootstrapper 包文件夹，最后重新构建了我的安装项目。之后安装工作正常。这是我的 BMG 设置的屏幕截图：

![在此处输入图像描述](../Images/2476b97b84773dbe91e4605dd29de507.png)

如果您不使用 BMG，您可以手动编辑 Product.xml 的 Commands 节点，如下所示：

```
<Commands Reboot="Defer">
   <Command PackageFile="python-2.7.5.msi" Arguments="/q /norestart">
      <ExitCodes>
         <ExitCode Value="0" Result="Success" />
            <DefaultExitCode Result="Fail" String="Anunexpectedexitcodewasr" FormatMessageFromSystem="true" />
      </ExitCodes>
   </Command>
</Commands> 
```

# azure - Log4Net 在本地开发结构中工作正常，工作角色也可以，但在 Web 角色中不行

> ID：14796587
> 
> 赞同：1
> 
> 时间：2013-02-10T10:04:23.307
> 
> 标签：azure, log4net, azure-web-roles

我有一个奇怪的情况：

我已将自定义 log4net Appender 配置为写入 Azure 表存储。我有 WorkerRole 和 WebRole。这两个角色都使用 osFamily="3" (Windows Server 2012)，我在这两个角色中都使用 .NET 4.5，并为 WebRole 使用 ASP.NET MVC4。一切都在本地配置并正常工作 - 工作人员和 Web 角色都正确记录。但是，当我部署到 Azure 时，只有 Worker 角色日志成功，webrole 不会产生任何日志（任何！），而它应该。

我已经在 WebRole 上配置了 log4net 来调试并将 log4net 调试数据发送到 Trace 以检查一些问题，但它没有发送任何错误/警告。它也不会发送日志消息。

下面是 log4net 调试产生的日志（剥离敏感数据）：

> log4net：log4net 程序集 [log4net，版本=1.2.11.0，文化=中性，PublicKeyToken=669e0ddf0bb1aa2a]。从 [D:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\59a01799\5b6b1a2\assembly\dl3\8d97587f\b9d49402_c202ce01\log4net.dll] 加载。（Microsoft Windows NT 6.2.9200.0 上的 .NET 运行时 [4.0.30319.18010]） log4net：defaultRepositoryType [log4net.Repository.Hierarchy.Hierarchy] log4net：为程序集创建存储库 [_my_referenced_assembly_，版本 = 1.3.0.20282，文化 = 中性，PublicKeyToken = null] log4net：程序集 [_my_referenced_assembly_, Version=1.3.0.20282, Culture=neutral, PublicKeyToken=null] 从 [D:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\59a01799\ 5b6b1a2\assembly\dl3\8cc98c20\594c5b41_6f07ce01_my_referenced_assembly_.dll] log4net：程序集 [_my_referenced_assembly_, Version=1.3.0.20282, Culture=neutral, PublicKeyToken=null] 没有指定 RepositoryAttribute。log4net：使用存储库 [log4net-default-repository] ​​和存储库类型 [log4net.Repository.Hierarchy.Hierarchy] 组装 [_my_referenced_assembly_, Version=1.3.0.20282, Culture=neutral, PublicKeyToken=null] log4net：创建存储库 [log4net-default-存储库] 使用类型 [log4net.Repository.Hierarchy.Hierarchy] 加载“Microsoft.WindowsAzure.ServiceRuntime, Version=1.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”从 ServiceRuntime 获取“_some_setting_1_”：PASS (_my_value1_)。从 ServiceRuntime 获取“_some_setting_2_”：PASS (_my_value2_)。从 ServiceRuntime 获取“_some_setting_3_”：PASS (_my_value3_)。从 ServiceRuntime 获取“Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString”：PASS (_my_conn_string_)。从 ServiceRuntime 获取“_some_setting_4_”：PASS (_my_value4_)。log4net：为程序集创建存储库 [_my_WEB_assembly_, Version=1.3.0.20283, Culture=neutral, PublicKeyToken=null] log4net: Assembly [_my_WEB_assembly_, Version=1.3.0.20283, Culture=neutral, PublicKeyToken=null] 从 [D:\Windows \Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\59a01799\5b6b1a2\assembly\dl3\f695181f\98c73242_6f07ce01_my_WEB_assembly_.dll] log4net：程序集 [_my_WEB_assembly_，版本=1.3.0.20283，CultureToken=neutral，PublicKey =null] 没有指定 RepositoryAttribute。log4net：程序集 [_my_WEB_assembly_，版本=1.3.0.20283，文化=中性，PublicKeyToken=null] 使用存储库 [log4net-default-repository] ​​和存储库类型 [log4net.Repository.Hierarchy.Hierarchy] log4net：存储库 [log4net-default-repository] ​​已经存在，使用存储库类型 [log4net.Repository.Hierarchy.Hierarchy]从 ServiceRuntime 获取“acs:idps”：失败。从 ConfigurationManager 获取“acs:idps”：通过（[my_value]）。

这是我的 app.config（用于工作人员）和 web.config（用于 Web 角色）文件的示例（我也将其设置为 WaIISHost.config 以防万一，但结果仍然相同 - 完全静音的 WebRole）：

```
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
    ...
  </configSections>
 ...
  <log4net>
    <appender name="AzureTableStoreAppender" type="_MyAssembly_.Logging.AzureTableStorageAppender, MyAssembly">
    </appender>
    <root>
      <level value="ALL" />
      <appender-ref ref="AzureTableStoreAppender" />
    </root>
  </log4net>
</configuration> 
```

我通过程序集级别属性配置 log4net。因此，在工人角色大会中，我有：

```
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

在网络角色中，我有：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "Web.config", Watch = true)] 
```

正如我所说，一切正常，并且在本地运行时可以正常写入表实体。我的本地环境是 Windows 8 Pro，在 IIS 服务器（不是 IIS Express）中运行 Web 角色，即 IIS8。我也尝试将 WebRole executionContext 标记为，`elevated`但仍然没有任何反应。它就像 log4net 的一个黑洞。

我的自定义附加程序在 Web 和 Worker 项目中都引用的类库类型的单独程序集 .net Framework 4.5（完整）中定义。如前所述 - 在本地一切正常。定义我的自定义附加程序的程序集肯定已加载，因为它还包含我的 Web 应用程序的业务逻辑，它也可以在 Azure 中部署。

**更新**

有趣的发现。当我使用`Debug`构建配置时，一切都可以在任何地方运行（也可以使用 azure web 角色）。但是当我使用`Release`配置（这是打包和生产代码的默认配置）时，我似乎无法让 log4net 在任何地方工作。这意味着我无法使 Log4Net 甚至在本地使用`Release`config 运行。没有引发异常，也没有记录错误。多么奇怪……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:46:21.100

事实证明，`Release`构建导致问题。根据[log4net 的 FAQ 部分](http://logging.apache.org/log4net/release/faq.html#log-early)，通过程序集级别属性配置 log4net 可能在配置中表现`DEBUG`不同`RELEASE`。

在我的设置中，我使用的是`static readonly property`在声明时初始化的（基本控制器）。这似乎破坏了记录器配置。我将我的 Logger 实例移动到`instance property`我的 Web 应用程序类型，并将我的控制器属性更改为只返回应用程序的属性。现在在所有构建配置中一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-26T11:29:10.930

关于 Azure，我遇到了同样的问题。我遇到过，在发布配置中没有记录任何内容，即使本地调试和发布都可以正常工作。我的问题不是 log4net 的配置，而是它的初始化。

我是这样的：

```
private static readonly log4net.ILog log = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); 
```

所以然后我用以下行替换了它，它有帮助：

```
private readonly log4net.ILog log = log4net.LogManager.GetLogger(typeof(WorkerRole)); 
```

# opencl - OpenCL - 相同的代码，在 Apple 上正确 + Xcode 在 Win XP + MSVS 2008 + Nvidia CUDA 5 上不正确

> ID：14796590
> 
> 赞同：1
> 
> 时间：2013-02-10T10:04:29.633
> 
> 标签：opencl, nvidia

我在配备 Nvidia GTX580 的 MacPro 上运行相同的 OpenCL 代码，运行以下任一：

*   带有 Xcode 4.6 的 OS X 10.8.2
*   带有 Visual C++ 2008 企业版和 Nvidia CUDA 工具包 5.0 的 Windows XP 32 位

但是我在 Win XP 中得到了错误的结果。

要定义使用的工作项数，我指定工作组大小 (192)、工作组数 (256) 并将使用的工作项的全局数设置为工作组大小 x 工作组 (192 x 256 = 49152)。

当我在 Apple 平台上运行它时，我的所有结果都是正确的，但是当我在 Win XP 平台上运行它时，我得到的结果是 1/8 倍。

做一些检查，我让 GPU 存储它认为的全局大小，并将预期数字报告为 49152 但是如果我改为让每个工作组的第一个工作项以原子方式将本地大小添加到计数器，我只会得到 6144，正好是全球规模的 1/8。

这个问题似乎是工作项设置数量的函数，如果我将工作组大小设置为 32 或 64，我将得到正确答案（当工作组大小保持在 192 时）。但是，对于任何其他值，我都会遇到此问题，并且我的结果可能会偏离 1/8、1/4 或 1/2，具体取决于使用的工作项的数量。

是否有任何原因会发生这种情况，例如 32 位寻址限制或 NVidia 库中的积极优化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T21:34:01.653

在 Apple OpenCL 库中，对于数字数据类型，全局只写内存初始化为 0，在 Windows Nvidia 库中，全局只写内存未初始化。

因此，当全局内存中的计数器增加时，起始值未定义。当怀疑这是在内核开始处放置了一个快速而愚蠢的初始化循环时，这当然会导致稍后执行的工作组将结果归零 之前执行的工作组给出观察到的结果减少与每个执行的内核数量成比例计算单元。

# php - PHP Object To JSON format

> ID：14796596
> 
> 赞同：4
> 
> 时间：2013-02-10T10:05:27.417
> 
> 标签：php, json

Consider this stripdown class:

```
class foo {

    private $fooVar;

    public getFooVar(){

    }

}

$fooObj = new foo(); 
```

want i want/need to do is convert this to JSON format so I thought of putting

```
echo json_encode($fooObj); 
```

however it doesnt work, i don't have fooVar and im guessing because $fooVar is private..

any other way I can do this without having to compromise and make $fooVar public?

Thanks a bunch!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:34:48.277

If you're using PHP 5.3 (or earlier), you can't really do what you're asking for easily. You won't get the methods encoded in JSON because JSON is a data format and doesn't include functions, and you won't get the property because it's a private property. You know this much already, but it's worth re-iterating to point out that you're right, it's not easy. Even writing the getter as a magic `__get()` method to turn it into a read-only public property won't work in this case.

In PHP 5.3, there are a couple of work arounds you could use.

*   `Reflection`. PHP includes a Reflection API, which allows you to access details about objects and classes, including reading values from private members. Obviously, however, this would mean writing a fair bit of code to get at the value, and it won't be fast either.

*   Write the `json_encode` call inside the class. That way you can include private properties. I would suggest using `get_object_vars($this)` inside the object to get at the private properties in a JSON friendly way.

If you're using PHP 5.4, you have an additional option:

*   PHP 5.4 introduces a `JsonSerializable` interface. Add `implements JsonSerializable` to your class, and write a method called `jsonSerialize()`. This method should return the data that you want to be in the JSON string. You can include or exclude whichever public or private properties you want.

PHP 5.5 hasn't been released yet, but it will add another option for you:

*   ~~PHP 5.5 will introduce a more complex syntax for defining properties, which will allow you to define properties as public but read-only, or to include more complex logic for them in the getter and setter, but still have them as properties. It will work much like the `__get()` and `__set()` methods do now, but with the variables explicitly defined as properties, which will mean that they should be accessible to the JSON serialiser, whereas currently with `__get()` they're not.~~
    ***[EDIT]*** *- note, the above paragraph is incorrect; the feature described did not make it into the PHP 5.5 release. Too early yet to say yet whether it'll get into 5.6 or not.*

Hope that helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:36:56.153

JSON decoding is a bit tricky with custom types, since you do not have information about type in JSON. All you have is generic objects (hash tables) and arrays.

But to serialize objects to JSON, you can implement [`JsonSerializable`](http://www.php.net/manual/en/class.jsonserializable.php) interface. Then `json_encode` function will do what you want.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:23:36.607

This would print a JSON with all of the properties (public, private and protected) of class `foo`:

```
$reflection = new ReflectionClass('foo');
$properties = $reflection->getdefaultProperties();

echo json_encode($properties); 
```

# javascript - 如何知道街景全景是在室内还是室外

> ID：14796604
> 
> 赞同：16
> 
> 时间：2013-02-10T10:06:31.583
> 
> 标签：javascript, google-maps, google-maps-api-3, google-street-view

如今，越来越多的企业使用街景从室内展示公寓。

我的程序提供了根据所选业务显示街景的能力。但我不想在室内展示。仅限户外。因为 Indoors 阻止我移动，只能 360 度旋转。

**如果我要在室内或室外展示，有谁知道如何从街景 API 中获取一些价值？**

非常感谢你，

到目前为止，这是我根据所选地址打开街景的代码片段：

```
function load_map_and_street_view_from_address(address) {

var geocoder = new google.maps.Geocoder();
geocoder.geocode( {
    'address': address
}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
        var gps = results[0].geometry.location;
        create_map_and_streetview(gps.lat(), gps.lng(), 'map_canvas', 'pano');
    }
 });
}

function create_map_and_streetview(lat, lng, map_id, street_view_id) {
var googlePos = new google.maps.LatLng(lat,lng);

addLatLng = new google.maps.LatLng(lat,lng);
var service = new google.maps.StreetViewService();
service.getPanoramaByLocation(addLatLng, 50, showPanoData);

}

function showPanoData(panoData, status) {
if (status != google.maps.StreetViewStatus.OK) {
    $('#pano').html('No StreetView Picture Available').attr('style', 'text-align:center;font-weight:bold').show();
    return;
}
$('#pano').show();
var angle = computeAngle(addLatLng, panoData.location.latLng);

var panoOptions = {
    position: addLatLng,
    addressControl: false,
    linksControl: false,
    panControl: false,
    zoomControlOptions: {
        style: google.maps.ZoomControlStyle.SMALL
    },
    pov: {
        heading: angle,
        pitch: 10,
        zoom: 1
    },
    enableCloseButton: true,
    visible:true
};

panorama.setOptions(panoOptions);

}

function computeAngle(endLatLng, startLatLng) {
var DEGREE_PER_RADIAN = 57.2957795;
var RADIAN_PER_DEGREE = 0.017453;

var dlat = endLatLng.lat() - startLatLng.lat();
var dlng = endLatLng.lng() - startLatLng.lng();

var yaw = Math.atan2(dlng * Math.cos(endLatLng.lat() * RADIAN_PER_DEGREE), dlat)
* DEGREE_PER_RADIAN;
return wrapAngle(yaw);
}

function wrapAngle(angle) {
if (angle >= 360) {
    angle -= 360;
} else if (angle < 0) {
    angle += 360;
}
return angle;
}; 
```

主要想法是获取全景位置并验证到 360 度左右最近地点的距离。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-22T08:16:23.867

我似乎找不到任何正式的 API（也许将来他们会实现一个），而且我认为你不能确定室内瓷砖的描述是空的。

我发现对我有用的是使用这个API：运行一个HTTP GET到这个地址：“ [http://cbk0.google.com/cbk?output=xml&ll=52.358445,4.88103](http://cbk0.google.com/cbk?output=xml&ll=52.358445,4.88103) ”和ll=LONG,LAT

这是用于查找目标位置 pano_id 的内部 API。它还为我们提供了一些关于我们可以用它做什么的信息：缩放级别、您所在的街道等。

我注意到具有室内街景图像的坐标的所有结果都包含`scene="_number" level_id="_id"` 在全景图的`data_properties`标签中。因此，对于每个位置，您都可以运行此请求并在结果 XML 的 data_properties 中查找这些值

一些例子：

```
indoors:
http://cbk0.google.com/cbk?output=xml&ll=52.358445,4.88103
http://maps.google.com/cbk?output=xml&ll=32.051626,34.7613

outdoors:
http://cbk0.google.com/cbk?output=xml&ll=52.358766,4.880494
http://maps.google.com/cbk?output=xml&ll=32.07782,34.785789 
```

资料来源：[黑客谷歌街景](http://diddling.blogspot.co.il/2008/01/hacking-google-street-view.html)

**更新**

似乎要让本地企业正确 pano_id 您需要添加`&it=all`到请求示例中：

```
http://cbk0.google.com/cbk?output=xml&hl=x-local&ll=34.058593,-118.240673&it=all 
```

这是此地点的正确 pano_id，您可以使用此 API 进行验证

```
http://cbk0.google.com/cbk?output=tile&panoid=70o9Pukc2KSjO-PfeHussw&zoom=3&x=5&y=1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T22:30:31.500

这是我向 Google 提交的功能请求：
“禁用室内街景的选项”
[https://code.google.com/p/gmaps-api-issues/issues/detail?id=4831](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4831)

随意给票加注星标，以帮助它获得一些关注

（这在礼仪方面可以吗？...不是一个真正的答案（还），但似乎值得在这里分享，所以有兴趣的人可以加注/跟踪票）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-19T13:34:34.917

过滤掉室内街景全景图的功能是前段时间在 Google Maps JavaScript API 中实现的。

您可以使用 StreetViewService 仅搜索室外全景图。在请求中，您应该将源指定为户外

[https://developers.google.com/maps/documentation/javascript/reference/3/#StreetViewSource](https://developers.google.com/maps/documentation/javascript/reference/3/#StreetViewSource)

查看以下示例代码，该代码演示了如何仅获取室外全景图

```
var panorama;
function initialize() {
    var svService = new google.maps.StreetViewService();
    var panoRequest = {
        location: new google.maps.LatLng(37.800953,-122.436738),
        preference: google.maps.StreetViewPreference.NEAREST,
        radius: 50,
        source: google.maps.StreetViewSource.OUTDOOR
    };

    svService.getPanorama(panoRequest, function(panoData, status){
        if (status === google.maps.StreetViewStatus.OK) {
            panorama = new google.maps.StreetViewPanorama(
                document.getElementById('street-view'),
                {
                    pano: panoData.location.pano,
                    pov: {
                        heading: 10,
                        pitch: 10
                    }
                });
        } else {
            //Handle other statuses here
        }
    });
}
```

```
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}
#street-view {
  height: 100%;
}
```

```
<div id="street-view"></div>
<script async defer
         src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDztlrk_3CnzGHo7CFvLFqE_2bUKEq1JEU&callback=initialize">
    </script>
```

我希望这有帮助！

# javascript - JavaScript将当前url与带有通配符的字符串匹配？

> ID：14796605
> 
> 赞同：3
> 
> 时间：2013-02-10T10:06:49.023
> 
> 标签：javascript, regex

我试图匹配以下字符串：

```
http://*/*/checkout 
```

到这个网址：

```
http://www.url.com/sub-folder/checkout 
```

最终，我要做的是找到一种方法，通过允许添加上述条件来在某些页面上显示我的 JavaScript 小部件。

我如何使用字符串来查看当前 URL 是否匹配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:09:46.557

使用正则表达式：

```
> /^http:\/\/.*?\/.*?\/checkout$/.test('http://www.url.com/sub-folder/checkout')
true 
```

这是一个更易读的版本：

```
RegExp('^http://.*?/.*?/checkout$').test('http://www.url.com/sub-folder/checkout') 
```

# php - 按单词列表从字符串中删除特定单词

> ID：14796608
> 
> 赞同：0
> 
> 时间：2013-02-10T10:07:01.720
> 
> 标签：php

我有这个函数可以从字符串中删除一个特定的单词，这个函数使用一个单词列表。所以我有一个查询，我想删除每种类型的字符串，例如（数字，数字）
这是我的代码：

```
$wordlist = array("LIMIT", "0, 5");

 foreach ($wordlist as &$word) {
      $word = '/\b' . preg_quote($word, '/') . '\b/';
  }

 $sql = preg_replace($wordlist, '', $sql);
 var_dump($sql); 
```

如您所见，如果函数获取 LIMIT 或 0,5 它将被删除，我如何删除任何类型的单词，例如“数字，数字”，因此查询将 LIMIT 10, 40 它也将被删除。
知道一个字符串是否具有“is_number,is_number”的格式。
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-08T08:22:52.937

如[http://snipplr.com/view/65038/](http://snipplr.com/view/65038/)所述，一种简单的方法是：

```
function stripCp($string )
{
  $wordlist = array("CP", "case", "postale","Case","Postale","cp");
  foreach($wordlist as $word)
  {
    $string = str_replace($word, "", $string);
  }
  return $string;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:51:42.387

使用 preg_replace() 删除正则表达式中标记的字符串

```
$pattern = '/\d+,\s*\d+/';
$replacement = '';

//wordlist version
$wordlist = array("LIMIT", "0, 5");
foreach($wordlist as &$string){
    $string=preg_replace($pattern, $replacement, $string);
}
//query version
$query="SELECT * FROM table LIMIT 0, 5";
$result=preg_replace($pattern, $replacement, $query); 
```

# windows - Windows Phone 是否有 _pipe() 函数？

> ID：14796609
> 
> 赞同：0
> 
> 时间：2013-02-10T10:07:10.030
> 
> 标签：windows, windows-phone-7, windows-phone-8

我有

```
int from_fd[2], to_fd[2];
BOOST_ASSERT(_pipe(from_fd, 256, O_TEXT) != -1); 
```

将线程的标准输入/输出重定向到管道。它适用于个人电脑。不幸的是，_pipe 似乎甚至没有为 Windows Phone 定义。编译器报告找不到该函数。还有其他选择吗？

我正在尝试将标准输出中的所有内容转发到进程中另一个线程可以读取的管道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:44:35.737

Windows RT 不支持管道。使用 Windows 套接字而不是 IPC 管道。

# gcc - C代码中堆栈的三重错误

> ID：14796611
> 
> 赞同：12
> 
> 时间：2013-02-10T10:07:25.007
> 
> 标签：gcc, assembly, x86, stack, osdev

我正在编写一个用于学习目的的玩具内核，但我遇到了一些麻烦。我制作了一个简单的引导加载程序，它从软盘（用 32 位代码编写）加载一个段，然后引导加载程序启用 A20 门并打开保护模式。如果我用汇编程序编写它，我可以很好地跳转到 32 位代码，但是如果我用 C 编写它，我会遇到三重错误。当我反汇编 C 代码时，我可以看到前两条指令涉及建立一个新的堆栈帧。这是工作 ASM 代码和失败的 C 代码之间的主要区别。我将 NASM v2.10.05 用于 ASM 代码，并将 DJGPP 4.72 集合中的 GCC 用于 C 代码。

这是引导加载程序代码：

```
org 7c00h
BITS 16

entry:
mov [drive], dl         ;Save the current drive

cli
mov ax,cs               ; Setup segment registers
mov ds,ax               ; Make DS correct
mov ss,ax               ; Make SS correct        

mov bp,0fffeh
mov sp,0fffeh           ;Setup a temporary stack
sti

;Set video mode to text
;===================
mov ah, 0
mov al, 3
int 10h
;===================

;Set current page to 0
;==================
mov ah, 5
mov al, 0
int 10h
;==================

;Load the sector
;=============
call load_image
;=============

;Clear interrupts
;=============
cli
;=============

;Disable NMIs
;============
in ax, 70h
and ax, 80h ;Set the high bit to 1
out 70h, ax
;============

;Enable A20:
;===========
mov ax, 02401h
int 15h
;===========

;Load the GDT
;===========
lgdt [gdt_pointer]
;===========

;Clear interrupts
;=============
cli
;=============

;Enter protected mode
;==================
mov eax, cr0
or eax, 1       ;Set the low bit to 1
mov cr0, eax
;==================

jmp 08h:clear_pipe  ;Far jump to clear the instruction queue

;======================================================
load_image:
reset_drive:
    mov ah, 00h
    ; DL contains *this* drive, given to us by the BIOS
    int 13h
    jc reset_drive

read_sectors:
    mov ah, 02h
    mov al, 01h
    mov ch, 00h
    mov cl, 02h
    mov dh, 00h
    ; DL contains *this* drive, given to us by the BIOS

    mov bx, 7E0h
    mov es, bx
    mov bx, 0

    int 13h
    jc read_sectors

ret
;======================================================

BITS 32 ;Protected mode now!
clear_pipe:

mov ax, 10h             ; Save data segment identifier
mov ds, ax              ; Move a valid data segment into the data segment register
mov es, ax
mov fs, ax
mov gs, ax
mov ss, ax              ; Move a valid data segment into the stack segment register
mov esp, 90000h        ; Move the stack pointer to 90000h
mov ebp, esp

jmp 08h:7E00h           ;Jump to the kernel proper

;===============================================
;========== GLOBAL DESCRIPTOR TABLE ==========
;===============================================

gdt:                    ; Address for the GDT

gdt_null:               ; Null Segment
    dd 0
    dd 0

gdt_code:               ; Code segment, read/execute, nonconforming
    dw 0FFFFh       ;   LIMIT, low 16 bits
    dw 0            ;   BASE, low 16 bits           
    db 0            ;   BASE, middle 8 bits
    db 10011010b    ;   ACCESS byte
    db 11001111b    ;   GRANULARITY byte
    db 0            ;   BASE, low 8 bits

gdt_data:               ; Data segment, read/write, expand down
    dw 0FFFFh
    dw 0
    db 0
    db 10010010b
    db 11001111b
    db 0

gdt_end:                ; Used to calculate the size of the GDT

gdt_pointer:                       ; The GDT descriptor
    dw gdt_end - gdt - 1    ; Limit (size)
    dd gdt                  ; Address of the GDT
;===============================================
;===============================================

drive: db 00    ;A byte to store the current drive in
times 510-($-$$) db 00
db 055h
db 0AAh 
```

这是内核代码：

```
void main()
{
    asm("mov byte ptr [0x8000], 'T'");
    asm("mov byte ptr [0x8001], 'e'");
    asm("mov byte ptr [0x8002], 's'");
    asm("mov byte ptr [0x8003], 't'");
} 
```

内核只是将这四个字节插入内存，当我在 VMPlayer 虚拟机中运行代码时，我可以检查这些字节。如果出现字节，那么我知道代码正在运行。如果我在 ASM 中编写如下所示的代码，则程序可以工作：

```
org 7E00h
BITS 32

main:
mov byte [8000h], 'T'
mov byte [8001h], 'e'
mov byte [8002h], 's'
mov byte [8003h], 't'

hang:
    jmp hang 
```

因此，唯一的区别是我在反汇编的 C 代码中发现的两个堆栈操作，它们是：

```
push ebp
mov ebp, esp 
```

对此问题的任何帮助将不胜感激。我想我在这里遗漏了一些相对较小但至关重要的东西，因为我知道这种事情是可以做到的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T05:09:13.600

尝试在此处使用该技术：

[有没有办法让 gcc 输出原始二进制文件？](https://stackoverflow.com/questions/1647359/is-there-a-way-to-get-gcc-to-output-raw-binary)

从您的目标文件中生成 .text 部分的平面二进制文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T12:00:45.250

我会尝试将您的受保护模式堆栈的地址移动到其他位置 - 比如说 0x80000 - 其中（据此：[http://wiki.osdev.org/Memory_Map_(x86)](http://wiki.osdev.org/Memory_Map_(x86))）是保证免费使用的 RAM（如与您当前使用的地址相反 - 0x90000 - 显然可能不存在 - 取决于您用作测试环境的内容）。

# java - 持续存在的 java 实体引用问题

> ID：14796614
> 
> 赞同：0
> 
> 时间：2013-02-10T10:07:42.900
> 
> 标签：java, reference, persistence

我正在做一个个人项目，我有一个奇怪的问题，即使经过数小时的研究和调试，我似乎也无法解决，所以很明显它一定很简单，我忽略了......无论如何，上下文是：JPA + PostgresSQL + Glassfish。我有一个实体（由 netbeans 生成），MvUser，具有：

```
@Id
@Basic(optional = false)
@NotNull
@Column(name = "id")
@SequenceGenerator(name="mv_user_autoincrement_gen",sequenceName     ="mv_user_autoincrement",allocationSize=1)  
@GeneratedValue(strategy=GenerationType.IDENTITY, generator="mv_user_autoincrement_gen") 
private Long id; 
```

然后，我有一个 AbstractFacade，其中包含所有样板持久性代码的泛型。
在这里，我有一个没有太大作用的方法，只是：

```
@Override
public void create(T entity) {
    getEntityManager().persist(entity);
} 
```

现在，假设我在我的服务类中调用它：首先我注入我的外观：

```
@EJB
IMvUserFacade userFacade; 
```

然后我会用它：

```
@Override
public void saveUser(MvUser user)
{
    userFacade.create(user);
    // more business specific code follows
} 
```

我这样打电话给服务

```
MvUser = new MvUser();
... setters etc
mvUserService.saveUser(user); 
```

现在，发生的事情是在创建方法中对象被持久化，我拥有生成的 id 和所有内容。因为在整个链上我有对象参数，我假设在 saveUser 级别会找到相同的对象，但不，我留下了一个分离的实体。我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:22:37.370

如果我理解正确，您想搜索您在 create() 中保存的对象。我认为该对象尚未持久化到数据库中，您检索的是来自一级缓存[http://www.tutorialspoint.com/hibernate/hibernate_caching.htm](http://www.tutorialspoint.com/hibernate/hibernate_caching.htm)的对象，因为您仍在事务中。如果您尝试按以下方式检索对象并且方法 saveUser() 不在事务中，您将从数据库中获取用户对象（但由于外部事务而分离）：

```
public void saveUser(MvUser user)
{
userFacade.create(user);
userFacade.get(userId);
// more business specific code follows
} 
```

# boost-asio - 从 Qt 迁移到 Boost - 网络

> ID：14796615
> 
> 赞同：1
> 
> 时间：2013-02-10T10:07:44.903
> 
> 标签：boost-asio

我正在使用 Qt 构建 Udp 和 Tcp 服务器/客户端。现在在最近的项目中，不允许使用 Qt，我应该使用 Boost。经历了 boost::asio 之后，我感到很困惑，因为有很多功能和用法与 Qt 非常不同。对于 Udp（多播、广播等），我现在或多或少地清楚了。但是对于 Tcp 我在理解上有问题：

（必须做所有异步）

1.  TCP 是面向流的，因此无法知道已到达的字节数。所以我们使用`asio::ip::tcp::socket::async_read_some()`. 然而，在 Qt 中，我们有`readAll()`一个套接字，它可以读取`readyRead()`信号上的所有数据并返回 a `QByteArray`，我们不需要指定它的大小，因为它可以增长。我如何在 Boost 中实现这一点？`readyRead()`我认为信号会大致映射到`async_read_some()`，其余的（`readAll()`和“可增长的” `buffer`/array？

2.  `disconnected`如果 TCP 连接断开（服务器/客户端关闭、局域网电缆拔出等），则在 Qt 中发出 () 信号。Boost 中的等效检查是什么？我需要一个计时器来定期发送和期待自己的心跳消息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:33:53.097

1.  使用一些具有适当完成条件的`async_read` [自由函数](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/async_read.html)重载。如您所见，此函数接受`asio::streambuf`自动增长的 。

2.  是的，唯一可移植且可靠的方法是发送一些心跳。我不知道 Qt 是怎么做到的，但是试着剪断网线，看看你是否收到来自 Qt 的任何通知......

# sql - Google 电子表格“=QUERY”join() 等效函数？

> ID：14796620
> 
> 赞同：79
> 
> 时间：2013-02-10T10:08:14.563
> 
> 标签：sql, google-sheets, google-query-language

这个问题是关于使用 =QUERY 函数在 Google 电子表格中加入两个数据库

我在 A1:C3 范围内有一张这样的表

```
a d g
b e h
c f i 
```

我还有一张桌子

```
c j m
a k n
b l o 
```

我希望决赛桌看起来像这样

```
a d g k n
b e h l o 
c f i j m 
```

我可以很容易地在单元格 D1 中使用 vlookup 函数并将其粘贴下来，但我的数据集很大。我需要一整页的 vlookups 和谷歌电子表格告诉我在我的复杂性极限。

我查看了 Google 的查询语言参考……似乎没有提到一种“加入”函数。你会认为这将是一个简单的“加入 A”类型的操作。

任何人都可以在没有 vlookup 的情况下解决这个问题吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2016-03-25T04:42:35.447

# 简短的回答

[Google QUERY 语言](https://developers.google.com/chart/interactive/docs/querylanguage)版本 0.7 (2016) 不包含 JOIN (LEFT JOIN) 运算符，但这可以通过使用数组公式来实现，其结果可用作 QUERY 函数的输入或其他用途。

# 解释

数组公式和[Google 表格的数组处理功能](https://support.google.com/docs/answer/6208276?hl=en)可以在两个简单的表之间进行 JOIN。为了更易于阅读，建议的公式使用命名范围而不是范围引用。

## 命名范围

*   表 1：工作表 1！A1：C3
*   表2：Sheet2！A1：C3
*   编号：Sheet1!A1:A3

## 公式

```
=数组公式（
   {
     表格1，
     vlookup(ID,table2,COLUMN(间接("R1C2:R1C"&COLUMNS(table2),0)),0)
   }
)

```

评论：

*   使用开放式范围是可能的，但这可能会使电子表格变慢。
*   加快重新计算时间：

1.  替换`Indirect("R1C2:R1C"&COLUMNS(table2),0)`为从 2 到 table2 列数的常量数组。
2.  从电子表格中删除空行

# 例子

有关示例，请参[见此表](https://docs.google.com/spreadsheets/d/1MF-lPdlptcgmBz5wiyo4Hjg1rxZatm5P82lCj_7h87g/edit#gid=92922776)

# 笔记

2017年谷歌对QUERY、[QUERY函数](https://support.google.com/docs/answer/3093343?hl=en)的英文官方帮助文章进行了改进。它仍然不包括这样的主题，但可能有助于理解它是如何工作的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-06-11T02:31:43.567

您可以使用[`ARRAYFORMULA`](https://support.google.com/docs/table/25273?hl=en)或直接拖动此公式：在导入或`QUERY`-ing 第一个表之后；在 D 列中：

```
=QUERY(Sheet2!A1:C3, "Select B,C WHERE A='" & A1 & "'", 0) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-03-17T16:57:49.960

因此，这回答了您如何使用 Vlookup 功能进行操作，但仅在一个单元格中。
在您的示例中，假设每个数据表都具有以下单元格引用：

表 1：Sheet1!A1:C3

```
a d g
b e h
c f i 
```

表 2：Sheet2!A1:C3

```
c j m
a k n
b l o 
```

这就是应该如何构建公式的方式。

# **加入公式**

```
=ArrayFormula(
   {
     Sheet1!A1:C,
     vlookup(Sheet1!A1:A, {Sheet2!A1:A, Sheet2!B1:C}, {2,3}, false)
   }
) 
```

让这个公式起作用的关键是了解如何在 Vlookup Range 中使用大括号。您基本上将 Range 的第一个单元格引用定义为与 Vlookup Search_Key 匹配的列。范围中的其余单元格引用与您要加入的列有关。

Index 写成 {2,3} 以返回 Range 的第二列和第三列（Range 总共由 3 列组成）；大括号与 Vlookup 索引中的 Arrayformula 无关，但对于从 Vlookup 函数返回多列是必需的。不写 {1,2,3} 的原因是您不想包含用于加入目的的列。

## table2 中用于连接的列位于不同列中的示例（在要连接的数据的右侧）

即使第二个表中的连接列位于该表的第三列，也可以使用这种连接公式。假设此示例中的原始数据如下所示：

表 1（表 1）：

```
a d g
b e h
c f i 
```

表 2（表 2）：

```
j m c
k n a
l o b 
```

如果你这样写公式，你仍然会得到想要的结果（如连接数据表中所示）：

```
=ArrayFormula(
   {
     Sheet1!A1:C,
     vlookup(Sheet1!A1:A, {Sheet2!C1:C, Sheet2!A1:B}, {2,3}, false)
   }
) 
```

连接数据表：

```
a d g k n
b e h l o 
c f i j m 
```

在 Join-formula 中，注意 Table2 的第三列位于 Vlookup Range 中的第一个单元格引用！
这样做的原因是，当您在 Range 中使用大括号（与 Arrayformula 一起使用）时，Vlookup Search_Key 不会在原始数据中查找列作为公分母，而是使用其中的 Array花括号作为参考来查找作为公分母的列（默认情况下，这是 Range 的第一列）。

我写了一个关于这个主题的综合指南，叫做：

### [“掌握 Google 表格中的联接公式”](https://docs.google.com/spreadsheets/d/14fVgEfdxsiBZGAqEP9qpySM1W28HEFzFYcXd6daNH38/edit?usp=sharing)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-16T04:59:35.403

我通过使用 Javascript LINQ（语言集成查询）解决了这个问题。

它允许您指定具有复杂连接条件的 Javascript。您还可以执行其他 SQL 查询，例如对工作表进行分组、投影、排序和过滤，就好像它们是数据库表一样。看看下面的链接。

请注意，在 LINQ 查询语言中，我用下划线替换了列名中的所有空格，以使它们成为有效的 JS 标识符。

[https://docs.google.com/spreadsheets/d/1DHtQlQUlo-X_YVfo-Wo-b7315sSk2pxL5ci4Y9lxvZo/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1DHtQlQUlo-X_YVfo-Wo-b7315sSk2pxL5ci4Y9lxvZo/edit?usp=sharing)

[https://script.google.com/d/1R5L2ReHJrBRwyoSoVOFLzEQZiGtxidPfPkAeVownt7SWX6TpacY7gA7j/edit?usp=sharing](https://script.google.com/d/1R5L2ReHJrBRwyoSoVOFLzEQZiGtxidPfPkAeVownt7SWX6TpacY7gA7j/edit?usp=sharing)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-17T18:56:59.850

如果您可以将每个“索引”（a、b、c）映射到特定的行或列，那么您可以使用该[`INDEX`](https://support.google.com/docs/answer/3098242)函数。

在这种情况下，您可以将“a”映射到 A 列（或第 1 行），将“b”映射到 B 列（或第 2 行），依此类推。

此外，[合并表](https://support.google.com/fusiontables/answer/171254?hl=en)似乎解决了这个确切的用例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-15T02:37:58.563

使用 A5:C7 中的“其他”表，请尝试：

```
=query({A1:C3,query(sort(A5:C7,1,TRUE),"Select Col2,Col3")}) 
```

# mysql - 使用 mySQL 将键链接到多个条目

> ID：14796626
> 
> 赞同：0
> 
> 时间：2013-02-10T10:09:27.287
> 
> 标签：mysql, regex, search, key, unique

我正在为我的网站创建一个搜索功能，因此我从主表中获取了关键字，并将它们总结为通过 id 链接到主表的辅助表中的键。
我的设置如下所示：
-------------------------------------------- ---------
| 物品 |
-------------------------------------------------- ---
| 身份证 | 姓名 | 价格 |
-------------------------------------------------- ---
| 1 | 中央处理器 | 199.95 |
| 2 | 显卡 | 249.95 |
| 3 | 显卡 | 225.95 |
-------------------------------------------------- ---

------------------------------------------------------------ ------
| 键 |
-------------------------------------------------- ---
| 身份证 | 项目名称 | item_id |
-------------------------------------------------- ---
| 1 | 中央处理器 | 1 |
| 2 | 显卡 | 2 |
| 3 | 显卡 | 3 |
-------------------------------------------------- ---
请记住我的表更复杂，为每一行生成许多键。
我的问题是，如果有很多重复的关键字，关键字表会变得非常大。因此，我的问题是：
是否有可能以某种方式将 mySQL 中的每个唯一 item_name 的 id 分组，所以如果有人搜索 GPU，输出将是 2 和 3？
我认为您可以使用例如分隔字符串中的值。像这样的逗号：
--------------------------------------------- --------
| 2 | 显卡 | 2,3 |
-------------------------------------------------- ---
但是，我觉得当项目中的一个项目被删除并且我需要更新我的键表并可能从字符串“1,3,5,7,10,15”中删除一个 Id=5 时，它会变得复杂......
是有一种将同名键链接到多个条目的聪明方法吗？或者我是否总是需要一个正则表达式，甚至可能是 PHP，来分隔这些值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:22:09.600

不要在数据库表中使用 CSV，而是使用连接来选择数据。

您应该能够像这样生成输出：

```
select count(*) as cnt
      ,k.item_name
      ,group_concat(k.item_id) as ids
from keys k
inner join items i ON (i.id = k.id)
where i.price = 199.95 
```

将`group_concat`即时生成 CSV，因此您不必将 CSV 存储在数据库中。如果需要多行输出，可以使用`group by`子句。

请参阅：[http ://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

请注意，这与正则表达式无关。

# java - 如何将图像放入链表？

> ID：14796631
> 
> 赞同：0
> 
> 时间：2013-02-10T10:09:54.773
> 
> 标签：java, android, linked-list

只是想问一下如何将图像放入链表？因为到目前为止我所看到的基础是字符串 char 是用于存储在链表中的最多对象。所以我只是好奇是否可以将图像放入链表，如果可以的话，请给我一个关于如何将图像放入链表的语法。因为我目前正在创建一个应用程序，您在单击完成按钮后使用键盘输入一个单词，如“A”，字母 A 的图像将出现在下一个活动中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:23:41.857

查看您的额外信息，我建议您查看 Hashtables 而不是 LinkedList，这样您就可以存储可搜索的搜索词以及图像参考。

因为您的图像存储在资源可绘制文件夹中，所以您的图像路径实际上是一个“int” R.drawable...是 int 的，Hashtables 需要这个的对象版本，所以“整数”。

```
 Hashtable<String, Integer> images = new Hashtable<String, Integer>();
    images.put("A",R.drawable.A);       
    String search = "A";
    if(images.containsKey(search)){
        ImageView img = new ImageView(context);
        img.setImageResource(images.get("A"));
    } 
```

上面的一个快速粗略的示例用于更简单的搜索，尝试试验并查找 Hashtable 以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:14:47.560

在java中它看起来像这样。

`List<Image> images = new LinkedList<Image>()`;

在android中我会使用Bitmap，如下所示，

```
List<Bitmap> images = new LinkedList<Bitmap>(); 
```

> 我目前正在创建一个应用程序，您在单击完成按钮后使用“A”之类的键盘输入一个单词，字母 A 的图像将出现在下一个活动中。

我猜你在某处存储图像。在这种情况下，您可以使用图像路径而不是位图本身，因为存储位图会占用大量内存。在这里使用[HashMap](http://developer.android.com/reference/java/util/HashMap.html)将是一个不错的选择。

```
 HashMap< String, String> s = new HashMap<String, String>(); 
```

Hashmap 将具有键和值。

```
 s.put("A", "filepath to image which has a"); 
```

现在您可以使用如下键值获取该文件的路径。

```
 s.get("A"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:15:21.723

您可以使用`LinkedList<Bitmap>`，请记住，这会浪费大量内存

# c - 通过指针表示法写入二维数组

> ID：14796635
> 
> 赞同：1
> 
> 时间：2013-02-10T10:10:48.827
> 
> 标签：c, arrays, pointers, gcc, lvalue

我无法理解为什么在下面的 pnArryCpy 中递增指针是不正确的。我想出了如何以不同的方式使用指针表示法复制数组，但我需要了解这有什么问题（例如`(* tgt_s)++;`where `int (*tgt_s)[cs]`），以及为什么`tgt_s`是左值（例如`tgt_s++`有效）但`*tgt_s` *不是*（真的）左值。

```
int main(void)
{

    int arr1[2][4] = { {1, 2, 3, 4}, {6, 7, 8, 9} }; 
    int arr2[2][4];                             

    pnArrCpy(4, arr1, arr2, arr2+2); // copies 2d array using pointer notation 
                                     // - this is where the problem is.
    printarr(2, 4, arr2); // this just prints the array and works fine - not at issue

    putchar('\n');
    return 0;
}

void pnArrCpy(int cs, int (*src)[cs], int (*tgt_s)[cs], int (*tgt_e)[cs])
{
    while (tgt_s < tgt_e)
    {

        **tgt_s=**src;  
        (* tgt_s)++; // older versions of gcc warn "target of assignment not really
                     // an lvalue", latest versions throw an error
        (* src)++;   // but no errors are runtime

    }

    return;
}

// trucated rest of program since it's not relevant, just the function for printing
// the array 
```

在较旧的 gcc 下，程序编译并显示正确的结果，即：

```
1 2 3 4 
6 7 8 9 
```

Mac OS 10.8.2
gcc 4.7.2 给了我错误
gcc 4.2.1 只给了我警告

谢谢！！

编辑：我使用可变长度数组的原因：这个函数是另一个程序的一部分，而这个只是我用来排除 pnArrCpy 故障的驱动程序。在实际程序中，数组维度和内容是用户定义的，因此使用 VLA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:17:08.663

事情是：

*   `int (*tgt_s)[cs]`是**指向数组**的指针。花几秒钟想一想，这有点奇怪
*   `*tgt_s`因此是一个数组
*   数组不是可修改的左值

最难理解的是您使用 C99 的传递特性`cs`，然后在参数列表中使用它的方式。

如果您想了解有关 VLA 作为函数参数的更多信息，请查看[这篇出色的文章](http://gustedt.wordpress.com/2011/01/13/vla-as-function-arguments/)。

# eclipse - Eclipse / EGit 只能在先前的控制台连接后连接

> ID：14796638
> 
> 赞同：1
> 
> 时间：2013-02-10T10:11:05.373
> 
> 标签：eclipse, egit, gitolite, ssh-keys

我正在使用 Windows 7 / Eclipse Juno / Git Extension 2.43

我已经用 UbuntuS 服务器和 Gitolite 建立了一个 VM 服务器并添加了一个 repo。之后我用 Git Extensions 克隆了 repo。到目前为止一切都很好。我还能够通过 Eclipse 与 Egit 连接。两者都使用 ssh 密钥。

但现在我有一个问题，重启后 Eclipse 没有连接到 repo。当我尝试使用 Git Extension 时，一切正常。奇怪的是，在与 Git Extensions 连接成功后，Eclipse 也是能够连接的。

下次重启后同样的问题。

还要提到的是，Eclipse 从不要求 ssh 密钥的密码，但 Git Extensions 会。

也许 Git Extensions 以某种方式缓存了密钥的密码？

每次重新启动后，我总是可以启动 Git 扩展，但这并不是我真正想做的。

任何想法？

提前谢谢！

# php - mysql join select 解释

> ID：14796639
> 
> 赞同：0
> 
> 时间：2013-02-10T10:11:06.737
> 
> 标签：php, mysql, join

我有两个表：'posts' 和 'users' 每个帖子都有一个 'ref_id' 列来获取发布它的用户 ID。

现在，我以这种方式收到帖子：

```
$this->db->query("SELECT * FROM posts WHERE time > '$timeLimit' LIMIT 50"); 
```

我不明白如何加入每个结果以获取海报相关数据。我现在正在做的基本上是一个循环内的循环，其中 foreach 的结果，获取他们的用户信息。但很明显这是非常错误的，

显然我需要开始使用连接，但是怎么做呢？我想这应该是一个非常简单的例子。

有什么帮助吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:12:35.283

```
SELECT posts.*, users.* 
FROM posts 
INNER JOIN users 
  ON posts.posted_by = users.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:12:54.753

像这样：

```
SELECT
  posts.*,,
  users.Username
FROM posts
INNER JOIN users ON posts.ref_id = users.user_id; 
```

* * *

## 解释：

对于`JOIN`任何一张桌子，有两件事；类型和`JOIN`连接条件。有三种主要的连接类型：

*   `INNER JOIN`，只有符合连接条件的行才会从两个表中返回，不再有行。但：

*   `LEFT OUTER JOIN`，当您连接两张表时，您将在 join 关键字的左侧看到一张，另一张在右侧：

    FROM Table1 <------------- 这是左表。LEFT OUTER JOIN table2 .... <------------- 这是正确的表。

`LEFT OUTER JOIN`左表中不匹配的行将包含在结果集中。

*   `RIGHT OUTER JOIN`右表中不匹配的行将包含在结果集中。

*   `CROSS JOIN`这将从两个表中执行笛卡尔积。

`users`在我们的查询中，只有当`ref_id`等于表中的`user_id`列时，查询才会从表中返回所有用户`posts`。

更多信息和解释：

*   [**SQL 连接的可视化解释**](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

*   [**SQL 连接的另一种可视化表示**](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)。

*   [**MySQL中的连接语法**](http://dev.mysql.com/doc/refman/5.0/en/join.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:14:52.110

```
SELECT user.name
FROM users
INNER JOIN posts
ON posts.ref_id == user.id
AND posts.time > 50 
```

[http://www.w3schools.com/sql/sql_join_inner.asp](http://www.w3schools.com/sql/sql_join_inner.asp)

# c# - 为什么这么多时间函数 Color.FromValues

> ID：14796650
> 
> 赞同：0
> 
> 时间：2013-02-10T10:12:56.710
> 
> 标签：c#, performance, colors, color-profile, color-management

为使用 ICC 配置文件的颜色转换编写了一个小测试。转换功能的工作速度要慢 1,000 倍！

有什么问题？

```
 Uri iccUri = new Uri("C:\\temp\\AdobeRGB1998.icc");
    private Color AdobeColor(int r, int g, int b)
    {
        float[] colorValues = new float[3];
        colorValues[0] = (float)r / 255.0f;
        colorValues[1] = (float)g/255.0f;
        colorValues[2] = (float)b/255.0f;
        return Color.FromValues(colorValues,iccUri);
    }

    public void Test()
    {
        Stopwatch sw = new Stopwatch();
        sw.Start();
        for (int n = 0; n < 10; n++)
        {
            Color a = AdobeColor(n, n, n);//very very slow
            //Color a = Color.FromRgb((byte)n, (byte)n, (byte)n);//very fast

        }

        sw.Stop();
        TimeSpan ts;
        ts = sw.Elapsed;
        Console.WriteLine("result: {0}\n", ts.Seconds);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:25:53.190

两种可能的解释：

*   `Color.FromValues`可能需要为每个调用查找 ICC 配置文件，这很昂贵（至少，比创建一个新的简单 Color 对象要贵几个数量级）
*   如果`Color.FromValues`缓存配置文件，则您的特定配置文件可能存在问题，导致缓存不起作用。

现在，由于`FromValues`需要磁盘访问，并且`FromRgb`是一个非常简单的算术运算，然后创建单个`Color`对象，`FromValues`IS 将慢几个数量级。我尝试了一个简单的基准测试并得到：

```
FromValues 37.6278 ms
FromRgb     0.0029 ms 
```

因此，至少在我的系统上，FromValues 似乎比 FromRgb 慢了大约 10000 倍。

# video - 如何在嵌入式 Youtube 播放列表中显示视频列表？

> ID：14796653
> 
> 赞同：1
> 
> 时间：2013-02-10T10:13:37.453
> 
> 标签：video, youtube, youtube-api, youtube-javascript-api

我只是想在我的网站中嵌入一个 Youtube 播放列表，同时允许用户从播放列表中选择他们想要查看的视频。（显示播放列表按钮）

**试验#1：**

```
<iframe width="1280" height="720" src="http://www.youtube.com/embed/WanDvtvv_xY?version=3&showinfo=1" frameborder="0" allowfullscreen></iframe> 
```

**试验#2：**

```
<iframe width="1280" height="720" src="http://www.youtube.com/embed/WanDvtvv_xY" frameborder="0" allowfullscreen></iframe> 
```

**试验#3：**

```
<iframe width="1280" height="720" src="http://www.youtube.com/embed/WanDvtvv_xY?showinfo=1" frameborder="0" allowfullscreen></iframe> 
```

上述代码似乎都不起作用。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-10T10:45:19.817

解决方案如下：

`list=[List ID]`必须添加到嵌入代码中。

# php - 为什么 cron 不能正确执行我的 PHP 脚本？

> ID：14796656
> 
> 赞同：7
> 
> 时间：2013-02-10T10:13:53.680
> 
> 标签：php, cron

我有一个 PHP 脚本（只是一个简单的脚本），我正试图让它作为一个 cronjob 运行。每次它执行 PHP 脚本时，我都会收到一封带有 PHP 脚本本身的邮件。

我该如何解决这个问题？我在谷歌上搜索了很多，但我找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T11:23:02.943

在您的 DirectAdmin 面板中，转到“cronjobs”部分，我假设您已经为您的 cronjob 配置了时间间隔，因此您只需要调整“command”选项，所以尝试：

**第一个选项：**

```
/usr/bin/php -f /home/your_user/public_html/your_script.php 
```

这样，您将使用 php 解释器调用 php 脚本。

**第二种选择：**

```
lynx -source http://yourdomain.com/your_script.php 
```

这样，您将执行基于文本的 Web 浏览器 lynx 并打开所需的 url，以便可以运行 php 脚本。Lynx 默认安装在大多数 linux 服务器上。

此外，我相信 DirecAdmin cronjobs 部分中有一个名为“阻止电子邮件”的选项检查，以便您不会收到电子邮件。

# twitter - 如何让用户在授权应用后自动注销

> ID：14796659
> 
> 赞同：0
> 
> 时间：2013-02-10T10:14:10.640
> 
> 标签：twitter, tweepy

我使用[Tweepy Oauth](http://pythonhosted.org/tweepy/html/auth_tutorial.html#oauth-authentication)来获取 access_token。用户必须授权我，所以他需要重定向到 Twitter 网站。拿到access_token后，也说明用户处于登录状态。

有什么方法可以让用户在授权我后自动注销。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:20:39.243

如果用户手动接受应用程序，他必须自己连接，接受，然后断开连接。如果应用程序/库通过自动连接用户来处理自己的令牌，则用户将不会在他自己的浏览器中“真正”连接，因为会话 cookie 是特定于浏览器的。

# javascript - 获取的 JSON 未填充到主干模型中

> ID：14796661
> 
> 赞同：2
> 
> 时间：2013-02-10T10:14:13.053
> 
> 标签：javascript, jquery, json, backbone.js, underscore.js

我正在使用这样的模型：

```
var SidebarCategory = Backbone.Model.extend({
    urlRoot: 'sidebar',
    defaults : {
        title  : '',
        items: ''
    }
}); 
```

并通过 GET 获取此 JSON：

```
{"id":"foo","title":"TITLE","items":"bar baz"} 
```

但是模型本身并不接受传入的数据。

```
var foo = new SidebarCategory({id: 'foo'});
foo.fetch();

console.log(foo.toJSON()); 
```

只需获取 id 并忽略其余部分。

我错过了什么？可能是什么问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T11:45:48.267

正如@CD 指出的那样，它`fetch`是异步的，所以你有 2 个选项可以像这样进行回调：

```
foo.fetch({
success : function(data){
   console.log(JSON.stringify(data));
}
}); 
```

或者

```
foo.fetch();

foo.on('reset',function(data){
  console.log(JSON.stringify(data));
},this); 
```

您可以使用上述任何一种方法来处理异步调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T10:22:16.257

[`fetch`](http://backbonejs.org/#Model-fetch)执行异步 HTTP (Ajax) 请求，因此您应该传递[`fetch`](http://backbonejs.org/#Model-fetch)一个成功回调：

```
foo.fetch({
   success: function(){
       console.log(foo.toJSON());  
   }
}); 
```

# struts2 - Struts2标签：获取一个请求属性，其名称本身就是另一个请求属性的值

> ID：14796663
> 
> 赞同：1
> 
> 时间：2013-02-10T10:14:29.400
> 
> 标签：struts2, iterator, ognl

我在请求属性“BillSummaryTables”中有一个表名列表。我正在遍历列表，我想使用每个表名来获取该特定表名的请求属性。对应于每个表名，我在请求属性中有另一个列表，我想遍历它。

这就是我正在做的事情。

```
<s:iterator value='#request.BillSummaryTables' var="tableName" status="itStatus">
<div class="contentbox" role="content">
    <table class="rpt">
    <s:iterator value="#request.get('%{#tableName}').getData()" var="ocRow" status="itStatus">
        <tr style="border:1px solid #CCCCCC">
        <s:iterator value='#ocRow' var="cell" status="itStatus2">
            <td>
            <s:property value="#cell.getValue()"/>
            </td>
        </s:iterator>
        </tr>
    </s:iterator>
        <tr>
        <s:iterator value="#request.get('%{#tableName}').getData()" var="ocTotal">
            <td>
            <s:property value="#ocTotal"/>
            </td>
        </s:iterator>
        </tr>
    </table>    
</div>
</s:iterator> 
```

我也试过

```
#request[<s:property value="#tableName" />].getData() 
```

和

```
#request['<s:property value="#tableName" />'].getData() 
```

和

```
#request.%{#tableName} 
```

但在任何情况下都不会返回任何内容。但是，如果我对这些值进行硬编码，则此代码可以正常工作。即如果我使用：`#request['other_charges'].getData()`

注意：我能够检索 tableName ( `#request.BillSummaryTables`) 的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T09:54:04.003

**#1)**你正在使用三个嵌套的迭代器，但是第一个和第二个都有一个名为 IteratorStatus 的实例`itStatus`；他们必须有不同的名字才能工作。

**#2)**如果`List`对应于表名的 s 实际上是一个列表，那么你应该迭代列表，而不是`getData()`东西（那是什么？）

**#3)** 为什么使用 request ？为什么不简单地在 Action 上使用 HashMap（使用 getter），使用`table name`s 作为 key 动态添加元素？

**#4)**`#request[<s:property value="#tableName" />].getData()`如果放在另一个 Struts2 标记中，这显然不起作用，例如迭代器（不能嵌套 Struts2 标记）。

但是，尝试这样的事情（我剥离了第二个迭代器，让它在之前运行，然后添加东西），看看它是否有效（以及它打印的内容）：

```
<s:iterator value='#request.BillSummaryTables' var="tableName" status="statusAllTables">
    <div class="contentbox" role="content">

        <br/>==== START DEBUG ====
        <br/>Current table name: [<s:property value="#tableName"/>]
        <br/>Corresponding request object: [<s:property value="#request['%{#tableName}']"/>]
        <br/>getData on that object:   [<s:property value="#request['%{#tableName}'].getData()"/>]
        <br/>===== END DEBUG =====

        <table class="rpt">
            <s:iterator value="#request['%{#tableName}'].getData()" var="ocRow" status="statusThisTable">
                <tr style="border:1px solid #CCCCCC">
                    <s:iterator value='#ocRow' var="cell" status="statusThisField">
                        <td>
                            <s:property value="#cell.getValue()"/>
                        </td>
                    </s:iterator>
                </tr>
            </s:iterator>
        </table>    
    </div>
</s:iterator> 
```

**编辑**

好的，但是你为什么要使用`request.setAttribute`？操作是按请求创建的...只需将 a`private List<MyObjects> myObjects`与它的 getter ( `public List<MyObject> getMyObjects()`) 一起使用，然后从 JSP 中调用它`<s:iterator value="myObjects">`(在您的情况下，`<s:iterator value="myObjects.data">`.

请注意`.getData()`in`OGNL`应该成为`.data`（我之前没有注意到），删除 get，降低方法的第一个字母，并删除圆括号......

重试并告诉我们。

# c++ - 将指针推送到 C++ 向量中并进行清理

> ID：14796670
> 
> 赞同：3
> 
> 时间：2013-02-10T10:15:01.070
> 
> 标签：c++, pointers, memory-leaks, vector, push-back

我正在不同系统之间转换一些代码，并且我有一个关于 c++ 向量的问题。

如果我做这样的事情：

在头文件中：

```
struct Vertex
{
    float x;
    float y;
    float z;
}

struct submesh
{
    Vertex *meshdata;
}

std::vector<submesh> meshes; 
```

在 c++ 文件中的例程中：

```
{
    Vertex *data = new Vertex[1024];

    submesh g;
    g.meshdata = data;
    meshes.push_back(g);

    delete [] data;
} 
```

我会遇到麻烦吗？**我的假设是该向量将包含一个指向数据的指针，一旦我对其调用删除**，该指针将不再有效。我是否需要为**Vertex**编写一个复制构造函数以便首先复制数据？

**额外的：**

问题更多与如何将指向已分配内存的指针放入 std::vector<> 并仍然清理本地分配的数据有关。本质上，我如何将数据复制到向量中，以便我仍然可以清理我的副本。

原始代码在 DirectX 中。我正在将它移植到 iPhone 上。原始代码在例程中本地分配了一个子网格，使用：

```
{
    ID3DXMesh* subMesh = 0;
    D3DXCreateMesh(SubGrid::NUM_TRIS, SubGrid::NUM_VERTS, D3DXMESH_MANAGED, elems, gd3dDevice, &subMesh));

    //
    // ... do some magical things to submesh
    //

    SubGrid g;
    g.mesh = subMesh;
    g.box  = bndBox;
    mSubGrids.push_back(g);
} 
```

我试图复制 ID3DXMesh 如何能够添加到向量中，然后在例程中失去它的范围。

由于我无法访问 D3DXCreateMesh()，我想我只需分配我需要的顶点，将它们放入向量中，然后进行清理。

抱歉，我想保留细节，因为问题只是我如何分配一块数据，将指针放入 std::vector<>，然后清理本地分配的内存。:)

我假设必须在某处编写一个复制构造函数。只是不确定在哪里或如何。

子网格如下所示：

```
struct SubGrid
{
    ID3DXMesh* mesh;
    AABB box;

    // For sorting.
    bool operator<(const SubGrid& rhs)const;

    const static int NUM_ROWS  = 33;
    const static int NUM_COLS  = 33;
    const static int NUM_TRIS  = (NUM_ROWS-1)*(NUM_COLS-1)*2;
    const static int NUM_VERTS = NUM_ROWS*NUM_COLS;
}; 
```

他们添加到的向量看起来像：

```
std::vector<SubGrid> mSubGrids; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:21:43.410

是的，当然，vector 会有一个指向已删除内存的指针。您需要的是：

1.  `submesh`为（不是`Vertex`）创建复制构造函数。或

2.  更改`submesh`为具有顶点数组（不仅仅是指针）。

复制构造函数可以这样完成：

```
struct submesh
{
    Vertex *meshdata;
    unsigned meshsize;
    submesh(Vertex* v = 0, unsigned s= 0) : meshdata(v), meshsize(s){}
    submesh(const submesh& s)
    {
        if(meshdata) /*we have stored data, delete it.*/ delete(meshdata);
        meshdata = new Vertex[s.meshsize];
        meshsize = s.meshsize;
        memcpy(meshdata, s.meshdata, sizeof(Vertex) * meshsize);
    }
}; 
```

当然，非常推荐使用 [unique_ptr](http://www.cplusplus.com/reference/memory/unique_ptr/)（如果您使用 c++11）或旧 c++ 的[auto_ptr](http://www.cplusplus.com/reference/memory/auto_ptr/)。尽可能避免内存管理的噩梦。

检查[如何在 C++ 中使用指向动态分配对象的指针向量时避免内存泄漏？](https://stackoverflow.com/questions/1361139/c-vector-pointers-to-objects)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:30:29.927

您的代码在单线程应用程序中看起来不错。您的代码只分配`data`一次内存`delete [] data`。

> 我是否需要为 Vertex 编写一个复制构造函数以便首先复制数据？

如您所示，您的代码很干净，`meshes`仅指向已分配`data`。如果您打算`data`在 call 时复制`meshes.push_back(g)`，那么您的代码不会按照您的意图进行。

您可能想`std::vector`改用：

```
struct submesh
{
    std::vector<Vertex> meshdata;
}

vector<submesh> meshes;

void Func()
{
    meshes.emplace_back(submesh());
    meshes.at(0).meshdata.resize(100);
} 
```

STL 容器使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)习惯用法，它会自动为您管理内存释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T19:16:51.830

不要在不需要时直接动态分配，在这种情况下你不需要。由于您正在填充自己的子网格数据而不是使用`ID3DXMesh`，因此该数据的容器应该符合 RAII。如果我对此进行编码，我将`submesh`完全删除该类并仅使用：

```
// vector containing list of vertices.
typedef std::vector<Vertex> SubMesh; 
```

然后，您的`SubGrid`类可以成为一个简单的容器，其中包含一个`submesh`集合作为其属性之一。我注意到您还有一个`AABB`用于盒子对象的类。你会继续把它藏在里面`SubGrid`。我不必在这里工作，所以我正在制作其中的一些，但类似于以下内容：

```
// a simple 3-value triplet of floats
struct Vertex
{
    float x,y,z;
};

// a Submesh is an arbitrary collection of Vertex objects.
typedef std::vector<Vertex> SubMesh;

// I'm defining AABB to be an 8-vertex object. your definition
//  is likely different, but I needed something to compile with =)
typedef Vertex AABB[8];

class SubGrid
{
public:
    SubGrid() {};

    // comparator for container ordering
    bool operator <(const SubGrid&);

    // submesh accessors
    void setSubmesh(const SubMesh& mesh) { submesh = mesh;}
    SubMesh& getSubmesh() { return submesh; }
    const SubMesh& getSubmesh() const { return submesh; }

    // box accessors
    AABB& getBox() { return box; }
    const AABB& getBox() const { return box;}

private:
    SubMesh submesh;
    AABB box;
};

// arbitrary collection of SubGrid objects
typedef std::vector<SubGrid> SubGrids; 
```

将此添加到您的全局`SubGrid`集合`g`时，您有多种可能性。你可以这样做：

```
// declared globally 
Subgrids g;

// in some function for adding a subgrid item
SubGrid subgrid;
AABB& box = subgrid.getBox();
SubBesh& submesh = subgrid.getSubmesh();

// ... initialize your box and submesh data ...

g.push_back(subgrid); 
```

但是你会复制很多数据。要加强内存访问，您总是可以这样做：

```
// push an empty SubGrid first, then set it up in-place
g.push_back(SubGrid());
Subgrid& subgrid = *(g.back());
AABB& box = subgrid.getBox();
SubMesh& submesh = subgrid.getSubmesh();

//... initialize your box and submesh data ... 
```

这将建立对`SubGrid`刚刚添加到全局集合的引用，然后允许您就地修改它。这只是许多可能的设置选项之一。应该注意的是，如果您的工具链中有 C++11（并且如果您在 MacOS 或 iOS 上执行此操作，您可能会这样做，因为 Apple LLVM 4.2 的 clang 在 C++11 合规性方面非常好）这个明智地使用**move-constructors**和**move-assignment-operators**可以提高效率。

最重要的是，不是一个`new`或被`delete`看到的。

无论如何，我希望这能给你一些想法。

# c++ - 比较链表中的值

> ID：14796671
> 
> 赞同：-4
> 
> 时间：2013-02-10T10:15:19.317
> 
> 标签：c++, visual-c++

这是我的课

```
class Element
{
  public:
    comparegreater(Element* temp1, Element* temp2)

  private:
    int row
    int col
    int value
    Element* next
}; 
```

我有一个链表，我需要一个函数的帮助，该函数假设比较链表中的第一个元素（int 值）和第二个元素（int 值）。

我该如何比较这两个值？这是我迄今为止尝试过的，我确信这是错误的。我知道答案

```
bool Element::comparegreater(ElementPtr temp1,ElementPtr temp2)
{
  if (temp1 > temp2)
  {
    return 1;
  }
  else
  {
    return 0;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:49:44.920

> 我该如何比较这两个值？

通过比较值：

```
return temp1->value > temp2->value; 
```

# php - PHP/pthreads 线程类不能使用数组？

> ID：14796674
> 
> 赞同：12
> 
> 时间：2013-02-10T10:15:37.110
> 
> 标签：php, multithreading, pthreads

我发现 PECL pthread`Thread`不能使用数组对象。我该怎么做才能找到原因？

代码示例：

```
 class my extends Thread {

           public function __construct() {
                   $this->arr = array();
                   $this->id  = 0;
           }
           public function run() {
                   while (true) {
                           $this->wait();
                   }
           }

           public function add() {
                   $this->id = rand(0, 1000);
                   $this->arr[] = rand(0, 1000);
                   var_dump($this->id);//this is rand
                   var_dump($this->arr);//this is empty array()
                   $this->notify();
           }
   }

   $my = new my();
   $my->start();
   while (true) {
           sleep(1);
           $my->add();
   } 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-10T17:12:29.523

# 问题

PHP 是一个无共享的环境：这意味着每个进程（或线程）必须拥有自己的解释器副本、所有模块和用户代码。

该`HashTable`结构不仅支持 PHP 数组，而且在整个 PHP 代码库中都使用，从未打算由多个上下文操作。

每当您设置数组的新成员（相当于 malloc）、未设置一个成员（相当于 free）或更新一个成员（相当于 free 然后 malloc）时，都会调用内存管理器，它是 shared nothing 的组成部分架构，除其他外，专门设计为禁止任何上下文释放由另一个上下文分配的内存，因为这构成了对无共享的违反。

虚拟机假定它是唯一操作数组的上下文。

所有扩展代码都做出相同的假设。

忽略规则的后果——什么都不分享——是可怕的：你让 PHP 崩溃了。

所有这些都使您无法在多个上下文中存储和操作实际数组，并且无论如何都应该使它变得不受欢迎。

# PHP5

数组将在将它们设置为`Threaded`对象的成员时被序列化。

您应该用`Threaded`对象替换数组的使用。

可以`Threaded`像操作数组*一样操作对象。*

这里有一些让你开始的东西：

```
<?php
class Test extends Thread {
    public function __construct(Threaded $storage) {
        $this->storage = $storage; 
    }

    public function run(){
        $i = 0;
        while(++$i < 10) {
            $this->storage[]=rand(0,1000);
        }

        $this->synchronized(function($thread){
            $thread->stored = true;
            $thread->notify();
        }, $this);
    } 
}

$storage = new Threaded();
$my = new Test($storage);
$my->start();

$my->synchronized(function(Thread $thread){
    while (!$thread->stored) {
        $thread->wait();
    }
}, $my);

var_dump($storage);
?> 
```

# PHP7

pthreads v3 (PHP7) 引入了`Threaded`对象自动不变性的概念。

引用我关于 pthreads v3 中不变性的[博客文章：](http://blog.krakjoe.ninja/2015/09/addendum-letter-from-future.html)

> 在 pthreads v3 中，将一个`Threaded`对象 ( *A* ) 的成员设置为另一个`Threaded`对象 ( *B* ) 会使*A对**B*持有的引用不可变。

不变性是一种性能优化。

显然，数组的大多数用例都涉及改变数组，而`Threaded`对象现在并不总是能够支持。

*`Threaded`在这种特殊情况下，数组的所有成员都不是`Threaded`.*

pthreads v3 (PHP7) 引入了`Volatile`对象的概念。

> **易变**的，*形容词*：容易迅速和不可预测地变化，尤其是变得更糟。

`Volatile`对象比`Threaded`对象慢，因为它们无法从不变性允许我们进行的性能优化中受益。

`Volatile`在 pthreads v3 中，对象确实可以很好地替代数组。`Volatile`当将数组设置为对象的成员时，pthread 会将数组强制转换为`Threaded`对象：

```
<?php
class Test extends Thread {
    public function run(){
        $array = [
            "Hello",
            "World"
        ];

        var_dump($array);

        $this->array = $array;

        var_dump($this->array);
    } 
}

$test = new Test();
$test->start() && $test->join();
?> 
```

将产生：

```
array(2) {
  [0]=>
  string(5) "Hello"
  [1]=>
  string(5) "World"
}
object(Volatile)#2 (2) {
  [0]=>
  string(5) "Hello"
  [1]=>
  string(5) "World"
} 
```

这会导致`$this->array`在`Thread`.

有一个副作用，如下代码的输出所示：

```
<?php
class Test extends Thread {
    public function __construct(array $array) {
        $this->array = $array;
    }

    public function run(){
        var_dump($this->array);
    } 
}

$array = [
    "Hello",
    "World"
];
$test = new Test($array);
$test->start() && $test->join();
var_dump($array);
?> 
```

将产生：

```
object(Volatile)#2 (2) {
  [0]=>
  string(5) "Hello"
  [1]=>
  string(5) "World"
}
array(2) {
  [0]=>
  string(5) "Hello"
  [1]=>
  string(5) "World"
} 
```

请注意， 中的`Volatile`对象与提供给其构造函数的对象`Thread`断开连接`array`，因此主上下文仍在操作`array`.

`Thread`当 a操作从另一个源传入的数组时，自动强制用于降低每分钟 wtfs 的速率。

明确一点总是更好；不依赖强制是最好的选择。

如果您已经知道某些依赖项将是数组，那么在将它们设置为成员之前处理它，完全避免强制。

`Volatile`通过使用显式强制转换可以避免自动强制转换：

```
<?php
class Test extends Thread {
    public function run() {
        $this->result = (array) [
            "Hello" => "World"
        ];
    }
}

$test = new Test();
$test->start() && $test->join();
var_dump($test->result);
?> 
```

将产生

```
array(1) {
  ["Hello"]=>
  string(5) "World"
} 
```

如示例代码所示，当您确实想要使用数组来存储结果时，这很有用。与 PHP5 一样，数组将被序列化以进行存储。

# c# - 保存滚动条状态/位置

> ID：14796675
> 
> 赞同：0
> 
> 时间：2013-02-10T10:15:54.150
> 
> 标签：c#, .net, winforms, scrollbar

我有一个面板，可以在其中动态添加自定义控件。如果控件超出面板边界，水平/垂直滚动条会自动显示 ( `AutoScroll == true`) 并且滚动条将通过以下代码跟随控件：

```
if(panelDiagram.VerticalScroll.Visible || panelDiagram.HorizontalScroll.Visible) {
    panelDiagram.ScrollControlIntoView(tempNode);
} 
```

这样，在移动 tempNode 时，滚动条将跟随它。

当我从数据库再次加载所有内容时，有什么方法可以保留滚动条的状态？我尝试了很多东西，`ScrollControlIntoView(lastAddedControl)`但没有任何效果。也许我必须关闭`AutoScroll`并手动管理所有内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:24:20.400

`Panel`派生自`ScrollableControl`它公开了一些您可能会发现有用的属性：

*   `AutoScrollPosition`
*   `VerticalScroll`
*   `HorizontalScroll`

看起来`autoScrollPosition`就是你所追求的；它是一个`Point`实例，其中包含每个滚动条的当前 X 和 Y 滚动坐标。`X`如果您只进行垂直滚动，则为零。

像这样保存它：

```
public override void OnLoad(Object sender, EventArgs e) {

    this.panel1.AutoScrollPosition = GetSavedScrollPoint();

}

public override void OnFormClosing(Object sender, EventArgs e) {

    SavePointSomewhere( this.panel1.AutoScrollPosition );
} 
```

# gcc - GCC 函数后缀 .constprop 是什么意思？

> ID：14796686
> 
> 赞同：19
> 
> 时间：2013-02-10T10:17:04.010
> 
> 标签：gcc, name-mangling

查看 C++ 程序的反汇编，我看到了类似`_Z41__static_initialization_and_destruction_0ii.constprop.221`. `constprop`在这种情况下是什么意思？它在外观上似乎与[isra](https://stackoverflow.com/questions/13963150/what-does-the-gcc-function-suffix-isra-mean)后缀相似（有时还结合在一起，例如`.isra.124.constprop.226`），但它的含义不同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T10:24:08.507

从我读过的源代码注释中 - 它们表示在优化期间已克隆的函数。

**编辑**：这可能是答案，也许不是。

> 简单的常数传播
> 
> 该文件实现了常量传播和合并。它查找仅涉及常量操作数的指令，并将它们替换为常量值而不是指令。例如：
> 
> ```
> add i32 1, 2 
> ```
> 
> 变成
> 
> ```
> i32 3 
> ```
> 
> 注意：这个 pass 习惯于使定义失效。在运行此通道后的某个时间运行 DIE（死指令消除）通道是一个好主意。

[来源](http://llvm.org/docs/Passes.html)

# iphone - 带有自定义标题的 UIBarButtonItem

> ID：14796687
> 
> 赞同：0
> 
> 时间：2013-02-10T10:17:08.960
> 
> 标签：iphone, ios, objective-c, ipad

我有以下代码：

```
 UIBarButtonItem *promoteButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonItemStyleBordered target:self action:@selector(promoteToInstagram:)];
    [promoteButton setTitle:@"Promote"];
    self.navigationItem.rightBarButtonItem = promoteButton; 
```

我正在尝试创建一个带有自定义标题的 UIBarButtonItem。为什么上面说取消而不是推广？

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:18:48.013

也许使用正确的初始化程序？

```
- (id)initWithTitle:(NSString *)title style:(UIBarButtonItemStyle)style target:(id)target action:(SEL)action 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:20:46.657

```
UIBarButtonItem  btnSort = [[UIBarButtonItem alloc]initWithTitle:@"Descending" style:UIBarButtonItemStyleBordered target:self action:@selector(pressAscending)];
    [[self navigationItem] setRightBarButtonItem:btnSort]; 
```

# loadrunner - 使用 LoadRunner web_custom_request 操作页面元素

> ID：14796692
> 
> 赞同：0
> 
> 时间：2013-02-10T10:18:15.720
> 
> 标签：loadrunner

在我的富 Internet 应用程序 (RIA) 上录制 http-protocol vuser 脚本会导致某些 CLICK 未被录制。

如点击图标打开隐藏菜单，选择单选按钮并点击提交（不创建任何http-traffic（请求/响应）。

是否可以使用 web_custom_request 在隐藏菜单上手动执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T02:43:11.890

没有 web_custom_request() 是协议级别的选项，其级别仅高于 Winsocket。这几乎是一个原始的 HTTP 请求。因此，调用离开，然后进入堆栈。GUI 级别的操作需要调用堆栈，这对于客户端-服务器操作来说是反直觉的，因为调用通常是横向或堆栈（OSI 模型）并且结果返回堆栈。

# uml - 视觉范式类图绘制

> ID：14796695
> 
> 赞同：0
> 
> 时间：2013-02-10T10:19:01.507
> 
> 标签：uml, class-diagram, visual-paradigm

我需要用一些*模型包*创建一个类图。我必须使用 Visual Paradigm 作为建模编辑器。我正在寻找的目标是这样的图表：

![在此处输入图像描述](../Images/1971ddd96299858deb8901542b26f111.png)

我的问题如下：如何创建一个像这张图片中的类一样的类？

我正在尝试使用默认的 Class 命令：

![在此处输入图像描述](../Images/482d59180e0cdfc081e7afeb4df26a64.png)

但这不是我要找的。类名必须居中且没有分隔线。我怎样才能做到这一点？

我也尝试过重叠矩形和文本框，但在这种情况下，我无法在类之间绘制关联。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T14:53:50.837

解决方案非常简单：您必须隐藏所有类属性和方法（谢谢，clapas！）

# popup - Prestashop 的时事通讯订阅弹出脚本

> ID：14796697
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:19:30.283
> 
> 标签：popup, prestashop

每当有新客户访问我们的网站时，我喜欢显示时事通讯订阅弹出窗口。一旦他注册，除非他不会清除 cookie，否则他将无法再次找到相同的窗口。

我希望为 prestashop 做这件事。

如果有人帮助我，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:37:02.367

您可能已经知道，PrestaShop 模块扩展了核心功能，将功能添加到 PrestaShop，而无需编辑其核心文件。模块创建在开发人员指南中的[创建 PrestaShop 模块](http://doc.prestashop.com/display/PS15/Creating+a+PrestaShop+module)部分进行了说明。

如果您找不到适合您需求的已编写模块（免费或付费），您将不得不自己创建一个。基本上你必须：

*   扩展您设置模块属性的 Prestashop `Module class`，
*   钩住你的模块，查看[可用的钩子](http://doc.prestashop.com/display/PS15/Hooks+in+PrestaShop+1.5)（`displayHeader`钩子可能适合你），
*   编写钩子事件处理程序，即将呈现您的内容的代码。Prestashop 使用 Smarty 引擎，所以在这里为您的模板设置变量，
*   编写模板代码，在您的情况下，这可能是一些 Javascript 检查条件（作为 Smarty 变量传递）来检查弹出窗口是否应该显示，以及弹出代码（fe 使用 jQuery-ui 弹出窗口）与需要内容，fe 电子邮件表单输入等。

# android - 为 BlackBerry 重新打包 .apk - 签名和发布

> ID：14796699
> 
> 赞同：1
> 
> 时间：2013-02-10T10:19:55.440
> 
> 标签：android, blackberry-10, blackberry-android

根据他们的在线检查工具，我有一个与 BlackBerry-10 兼容的 Android .apk。我有一个 BlackBerry 开发人员帐户，并通过电子邮件（RDK 和 PBDT）收到了 2 个 .cjs 文件。将我的 .apk 转换为 BlackBerry-10 兼容格式、对其进行签名和发布的下一步是什么？我需要什么软件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:48:11.980

您可以使用[在线重新打包工具](https://bdsc.webapps.blackberry.com/android/bpaa/)或 BB [Eclipse 插件](http://developer.blackberry.com/android/documentation/install_plugin_prerequisites_1895476_11.html)。

# c++ - 使用 asio 进行 C++11 类型推断

> ID：14796700
> 
> 赞同：2
> 
> 时间：2013-02-10T10:20:06.703
> 
> 标签：c++, boost-asio, typedef

我正在使用`boost::asio::steady_timer _timer`，但我发现如果使用 -std=c++11 标志，编译器将在以下位置报告无法转换类型的错误：

```
boost::asio::steady_timer::time_point now() {
    return boost::asio::steady_timer::clock_type::now();
} 
```

并且在以下位置没有 operator+() 的匹配函数：

```
_timer.expires_at(now()+boost::chrono::milliseconds(100)); 
```

似乎编译器无法在 c++11 模式下推断出正确的类型。但相反我使用

```
boost::asio::basic_waitable_timer<boost::chrono::steady_clock> _timer; 
```

并更改`boost::asio::steady_timer::time_point` 为 `boost::chrono::steady_clock::time_point`

没关系。但是，它们是相同的，并且在没有 0x 或 11 模式的 g++ 中可以正常工作。

C++11 对 typedef 推断有什么不同吗？还是boost配置问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T10:45:11.923

该类`basic_waitable_timer`可以使用`std::chrono`或`boost::chrono`。在最近的 g++ 上，它`std::chrono`默认使用。要强制使用`boost::chrono`，请定义`BOOST_ASIO_DISABLE_STD_CHRONO`.

这记录[在这里](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/overview/cpp2011/chrono.html)

# ruby-on-rails - Rails：方法返回对象而不是属性

> ID：14796709
> 
> 赞同：0
> 
> 时间：2013-02-10T10:20:57.660
> 
> 标签：ruby-on-rails, rails-activerecord

我正在构建我的第一个 Rails 应用程序，知道这可能是一个简单的修复程序，我快疯了。我无法从方法返回正确的对象和属性。我有三个模型：用户、Feed 和订阅。

用户：

```
class User < ActiveRecord::Base
.
.
  has_many :subscriptions, dependent: :destroy
  has_many :feeds, through: :subscriptions

  def subscribe!(feed_id)
    subscriptions.create!(feed_id: feed.id)
  end
end 
```

订阅：

```
class Subscription < ActiveRecord::Base
.
.
  belongs_to :user, class_name: "User"
  belongs_to :feed, class_name: "Feed"

  validates :user_id, presence: true
  validates :feed_id, presence: true
end 
```

喂养：

```
class Feed < ActiveRecord::Base
.
.
  belongs_to :subscriptions

  def self.create_feed(feed_url)
    feed = Feedzirra::Feed.fetch_and_parse(feed_url)

    unless exists? :feed_url => feed.url
      create!(
        :title => feed.title,
        :feed_url => feed.feed_url,
        :url => feed.url,
        :etag => feed.etag,
        :last_modified=> feed.last_modified
      )
    end
  end
end 
```

每当我从控制台显式调用 user.subscriptions.create!(feed) 时，它工作得很好，但使用它的测试没有通过。有问题的测试：

```
describe "subscribing" do
  let(:feed) { Feed.create_feed("http://www.somevalidfeed.com/feed/") }
  before { @user.subscribe!(feed) }
end 
```

这将返回：

```
NameError: undefined local variable or method `feed' for #<User:0x007f9c951b3b98> 
```

我不明白为什么这会返回一个对象，或者为什么它试图找到 User 的 id 而不是传递给它的 Feed 对象。搜索了几个小时后，我似乎无法指出正确的方向，因此非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:25:12.427

可能是这里的问题：

```
 def subscribe!(feed_id)
    subscriptions.create!(feed_id: feed.id)
  end 
```

可能你的意思是

```
 def subscribe!(feed_id)
    subscriptions.create!(feed_id: feed_id)
  end 
```

甚至

```
 def subscribe!(feed)
    subscriptions.create!(feed_id: feed.id)
  end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:25:49.820

在你的`User`课堂上，我认为你的订阅方法是错误的，应该是

```
def subscribe!(feed)
  subscriptions.create!(feed_id: feed.id)
end 
```

# objective-c - 为什么 lcov 不报告异常覆盖率？

> ID：14796711
> 
> 赞同：1
> 
> 时间：2013-02-10T10:21:10.353
> 
> 标签：objective-c, lcov

请参阅[此覆盖率报告](http://jasperblues.github.com/Typhoon/coverage/Source/Factory/TyphoonComponentFactory.m.gcov.html)。. 我知道我的测试用例正在执行异常处理，但是这些行仍然被报告为未涵盖。. . 一段时间以来，我所有的objective-c项目都是这种情况。. . . 有没有办法来解决这个问题？

# asp.net - ListView 中的 ItemTemplate 更新后如何切换回 EditTemplate

> ID：14796714
> 
> 赞同：1
> 
> 时间：2013-02-10T10:21:30.727
> 
> 标签：asp.net, listview, itemtemplate, edititemtemplate

它有一个带有 LayoutTemplate、ItemTemplate 和 EditTemplate 的 ListView。列表视图只显示一项。ItemTemplate 作为带有 CommandName = 'Edit' 的 EditButton，单击时触发...

```
Protected Sub ListView1_ItemEditing(ByVal sender As Object, ByVal e As ListViewEditEventArgs) Handles ListView1.ItemEditing

    ListView1.EditIndex = e.NewEditIndex

    'Create SQL and load result in datatable and bind to listview 
    LoadData(Session("SID"))

End Sub 
```

EditTemplate 有一个带有 CommandName 'Update' 的 UpdateButton，单击它会触发...

```
Protected Sub ListView1_Command(ByVal sender As Object, ByVal e As ListViewCommandEventArgs) Handles ListView1.ItemCommand

    If e.CommandName = "Update" Then

        'Use StringBuilder to build up an UPDATE TSql script
        SqlStr = sb.ToString
        'Execute Update
        ExecuteSQLScript(SqlStr)

    End If 
```

上面的效果很好。我的问题是我现在如何回到 ItemTemplate 视图。我知道我必须使用类似于上述 ItemEditing 方法工作方式的 ItemUpdating 方法，但我已经没有想法了......感谢任何帮助。我现在只有...

```
 Protected Sub ListView1_Updating(ByVal sender As Object, ByVal e As ListViewUpdateEventArgs) Handles ListView1.ItemUpdating

    'ListView1.ItemIndex = e.ItemIndex  'This does not work

    LoadData(Session("SID"))

End Sub 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:27:25.910

设置`EditIndex`为`-1`。

```
ListView1.EditIndex = -1 
```

# asp.net - 我想在网格视图可编辑文本框中插入数据库值，我可以从中更新该文本框

> ID：14796718
> 
> 赞同：-4
> 
> 时间：2013-02-10T10:22:03.533
> 
> 标签：asp.net, gridview, visual-studio-2008

```
<asp:GridView ID="grdAttendance1" runat="server" AutoGenerateColumns="False" CellPadding="4"
                        ForeColor="#333333" GridLines="None" Width="100%" HorizontalAlign="Center">
                        <AlternatingRowStyle BackColor="White" />
                        <Columns>
                            <asp:BoundField DataField="InstID" HeaderText="College ID" />
                            <asp:BoundField DataField="Fid" HeaderText="Employee ID" />
                            <asp:BoundField DataField="FName" HeaderText="Employee Name" />
                            <asp:BoundField DataField="Designation" HeaderText="Designation" />
                            <asp:BoundField DataField="Department" HeaderText="Department" />
                            <asp:BoundField DataField="Date" HeaderText="Date" />
                            <asp:TemplateField HeaderText="In Time">
                                <ItemTemplate>
                                    <asp:TextBox ID="txtIntime1" runat="server"></asp:TextBox>
                                </ItemTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderText="Out Time">
                                <ItemTemplate>
                                    <asp:TextBox ID="txtOuttime1" runat="server"></asp:TextBox>
                                </ItemTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderText="Leave Type">
                                <ItemTemplate>
                                    <asp:TextBox ID="txtLeaveType1" runat="server"></asp:TextBox>
                                </ItemTemplate>
                             </asp:TemplateField>
                        </Columns>
                        <EditRowStyle BackColor="#2461BF" />
                        <FooterStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" />
                        <HeaderStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" />
                        <PagerStyle BackColor="#2461BF" ForeColor="White" HorizontalAlign="Center" />
                        <RowStyle BackColor="#EFF3FB" />
                        <SelectedRowStyle BackColor="#D1DDF1" Font-Bold="True" ForeColor="#333333" />
                        <SortedAscendingCellStyle BackColor="#F5F7FB" />
                        <SortedAscendingHeaderStyle BackColor="#6D95E1" />
                        <SortedDescendingCellStyle BackColor="#E9EBEF" />
                        <SortedDescendingHeaderStyle BackColor="#4870BE" />
                    </asp:GridView> 
```

我拿了这个，但它没有与数据库绑定，文本框显示为空白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:18:02.737

一、推荐浏览[微软的ASP.NET数据访问教程](http://www.asp.net/web-forms/tutorials/data-access)

**我会给你一个通用指南，让你走上正轨**

1.  添加如下命令字段：`<asp:CommandField ButtonType=”Link” ShowEditButton=”true” ShowDeleteButton=”true” ShowCancelButton=”true” />`
2.  设置您不想编辑的任何字段`readonly="true"`
3.  添加`EditItemTemplates`可编辑的模板字段。
4.  填写您的事件处理程序，例如 editindexchanged、updated、deleted、edit-canceled 等。[请参阅此处的 GV Events (MSDN)](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview_events.aspx)
    *   在 Row_Updating 事件中实现您的保存到数据库代码。

第一次做这件事可能有点棘手，但一旦你完成它就很容易了。

# javascript - javascript 谷歌浏览器扩展获取域名

> ID：14796722
> 
> 赞同：4
> 
> 时间：2013-02-10T10:22:20.413
> 
> 标签：javascript, google-chrome, google-chrome-extension, cross-domain

我尝试使用`alert(document.domain);`但在站点中测试它时没有获得正确的域，

我得到“hiecjmnbaldlmopbbkifcelmaaalcfib”这个奇怪的输出。

我也在清单中添加了这个

```
 "content_scripts": [
        {
        "js": ["inject.js"]

        }
  ], 
```

警报（文档.域）；是inject.js 中唯一的文本行。

之后我将其合并`<script type="text/javascript" src="inject.js"> </script>`到主 html 文件中`popup.js`

关于为什么我没有得到正确的域 url 的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T05:40:29.910

如果您在弹出或背景或选项页面中，则有一种间接方法可以获取页面域。

您可以参考以下代码作为参考。

# 示范

### 清单.json

已注册的内容脚本、后台和弹出脚本以及清单文件以及相关权限

```
{
    "name": "Domain Name",
    "description": "http://stackoverflow.com/questions/14796722/javascript-google-chrome-extension-getting-domain-name",
    "version": "1",
    "manifest_version": 2,
    "content_scripts": [
        {
            "matches": [
                "<all_urls>"
            ],
            "js": [
                "myscript.js"
            ]
        }
    ],
    "browser_action": {
        "default_popup": "popup.html"
    },
    "background": {
        "scripts": [
            "background.js"
        ]
    },
    "permissions": [
        "tabs",
        "<all_urls>"
    ]
} 
```

### myscript.js

```
console.log(document.domain);// Outputs present active URL of tab 
```

### popup.html

注册`popup.js`超越CSP。

```
<html>

    <head>
        <script src="popup.js"></script>
    </head>

    <body></body>

</html> 
```

### popup.js

添加了事件监听器`DOM Content Loaded`，并带来了用户所在选项卡的活动 URL。

```
document.addEventListener("DOMContentLoaded", function () {
    console.log(document.domain);//It outputs id of extension to console
    chrome.tabs.query({ //This method output active URL 
        "active": true,
        "currentWindow": true,
        "status": "complete",
        "windowType": "normal"
    }, function (tabs) {
        for (tab in tabs) {
            console.log(tabs[tab].url);
        }
    });
}); 
```

### 背景.js

```
console.log(document.domain); //It outputs id of extension to console
chrome.tabs.query({ //This method output active URL 
    "active": true,
    "currentWindow": true,
    "status": "complete",
    "windowType": "normal"
}, function (tabs) {
    for (tab in tabs) {
        console.log(tabs[tab].url);
    }
}); 
```

# 输出

你会找到

> fgbhocadghoeonlokakijhnlplgkolbg

作为 console.log(document.domain) 的输出；在所有扩展页面和

和

> [http://somedomain.com/](http://somedomain.com/)

用于`tabs.query()`输出。

但是，内容脚本输出总是

> [http://somedomain.com/](http://somedomain.com/)

# 参考

*   [选项卡 API](https://developer.chrome.com/extensions/tabs.html#method-query)
*   [内容脚本](https://developer.chrome.com/extensions/content_scripts.html)

# java - 方法重载澄清或以不同的方式使用它

> ID：14796723
> 
> 赞同：2
> 
> 时间：2013-02-10T10:22:30.513
> 
> 标签：java, polymorphism, overloading

我有方法应该在同一过程结束时获得不同的参数，因为需要以不同的方式执行该过程

我的问题是这是最好的方法，假设这是 API

```
void action(String a,String b){
    functionA();
    functionB();
    functionC();
}

void action(String a){
    functionA();
    functionC();
}

void action(String a,String B,String C){
    functionA();
    functionC();
    functionD();
} 
```

我问的原因是你可以看到我总是使用**functionA 和 functionC**？在java中有更优雅的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:26:42.677

您可以在重载函数之间共享代码，重载函数之间共享代码是非常合乎逻辑的。

```
//this delegates what happens to 'a' to the lower link, passing the responsibility to it along the 'chain'
void action(String a,String b){
    action(a);
    functionB();
}
//this delegates what happens to 'a' to the lower link, passing the responsibility to it along the 'chain'
void action(String a,String B,String C){
    action(a);
    functionD();
}
//this is the lowest link in your chain of responsibility, it handles the one parameter case
void action(String a){
    functionA();
    functionC();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:31:15.350

你的问题不是很清楚，但是看看[Command Pattern](http://en.wikipedia.org/wiki/Command_pattern#Java)。您实际上可以从不同的子命令构建命令。

像这样的东西？

```
public class CommandExample {

    private final Map<String, Command> availableCommands;

    CommandExample() {
        availableCommands = new HashMap<>();
        List<Command> cmds = Arrays.asList(new Command[]{new CommandA(), new CommandB(), new CommandC(), new CommandD()});
        for (Command cmd:cmds)
            availableCommands.put(cmd.getId(), cmd);
    }
    public interface Command {
        public String getId();
        public void action();
    }

    public class CommandA implements Command {
        @Override 
        public String getId() {
            return "A";
        }
        @Override
        public void action() {
            // do my action A
        }
    }
    public class CommandB implements Command {
        @Override 
        public String getId() {
            return "B";
        }
        @Override
        public void action() {
            // do my action B
        }
    }
    public class CommandC implements Command {
        @Override 
        public String getId() {
            return "B";
        }
        @Override
        public void action() {
            // do my action C
        }
    }
    public class CommandD implements Command {
        @Override 
        public String getId() {
            return "C";
        }
        @Override
        public void action() {
            // do my action D
        }
    }

    public void execute(String[] input) {
        for (String in: input) {
            availableCommands.get(in).action();
        }
    }
} 
```

# c# - 是否有任何实用程序可以在运行时动态生成实现接口的对象？

> ID：14796726
> 
> 赞同：2
> 
> 时间：2013-02-10T10:22:49.337
> 
> 标签：c#, dynamic

我见过大量在 C# 中实现动态编程的开源框架。有没有一个可以在没有任何实际具体类的情况下生成接口的实现？

具体来说，假设您有：

```
interface IThing {
  int Id { get; set; } 
  string Name { get; set; }
} 
```

你也有想要映射到 IThing 实例的对象：

```
class Foo {
  public int FooBarId { get; set; }
  public string FooBarName { get; set; }
} 
```

我假设的助手会让我写如下内容：

```
IThing concreteThing = helper.Implement<IThing, Foo>()
  PropertyGetter(x => x.Id).Returns(foo => foo.FooBarId)
  PropertyGetter(x => x.Name).Returns(foo => foo.FooBarName); 
```

我想在我的假装示例中，它会将异常抛出存根放入我没有提供的其他属性的设置器中......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T17:20:08.503

我有一个开源框架[ImpromptuInterface](http://code.google.com/p/impromptu-interface/)（在 nuget 中），它给定一个接口，将生成 DLR 调用的存根（[甚至递归](http://blog.markrendle.net/2012/10/12/howto-dial-up-the-static-on-simple-data/)）。[这意味着您可以通过DynamicObject](http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject.aspx)的实现在其后面添加您喜欢的任何逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:25:40.037

看这个[例子](http://www.codeproject.com/Articles/16074/DuckTyping-Runtime-Dynamic-Interface-Implementatio)。通过使用反射，你可以避免在实现中指定每个可能的类型，但是你还有其他缺点：

owner 参数不公开函数预期的任何类型信息。您需要手动检查它们。反射开销会降低每次调用的性能。反射降低了可维护性（方法必须以不同的方式实现）。一些操作（如索引器）很难用反射处理。在像 C# 这样的静态类型语言中，类的接口定义了支持哪些操作。支持的操作可能是调用具有指定签名的方法，或者获取或设置属性，或者能够附加到特定事件。在大多数情况下，这很有意义，因为编译器能够验证指定类型是否支持操作。

# backbone.js - 模板中的 Marionette + i18n

> ID：14796727
> 
> 赞同：1
> 
> 时间：2013-02-10T10:22:54.087
> 
> 标签：backbone.js, internationalization, marionette

我想在我的应用程序中做一些基本的 i18n

我将 i18n 插件（来自 require.js）加载到我的应用程序并创建了一个目录`nls`，其中我有几个文件，例如`project.js`

`main.js`我在文件中设置了默认位置，例如

```
config : {
    i18n : {
        locale : 'de-de'
    }
} 
```

我现在想使用我的视图/模板中的文件。有人可以向我解释这是如何完成的吗？模板设置在一个 template.js 文件中

我的观点：

```
define(['marionette', 'templates', 'i18n!nls/project'], function (marionette, templates, msg) {

    return marionette.CompositeView.extend({
        template : templates.project
    });

}); 
```

我的模板：

```
<div class="container">
    <div class="well">
        <h2>Projects</h2>
    </div>
</div> 
```

有人可以向我解释如何在我的视图/模板中使用该文件吗？提前致谢！

编辑：

我通过一些尝试和错误找到了解决方案。当我通过 require.js tpl 加载模板时！插件如果我调用它们，我不需要编译它们`require('tpl!templates/dashboard.tmpl')`。我可以简单地传递我加载的 i18n 文件`'i18n!nls/dashboard'`。在 Marionette 中，视图默认呈现，所以我这样做了：

```
define(['marionette', 'templates', 'i18n!nls/dashboard'], function (Marionette, templates, msg) {

    return Marionette.CompositeView.extend({

        template : function () {
            return templates.dashboard(msg);
        },

        initialize : function() {

        }
    });

}); 
```

i18n 插件的文件在这里得到了很好的解释： [http ://requirejs.org/docs/api.html#i18n](http://requirejs.org/docs/api.html#i18n)

我必须一步一步地做这个，首先我错过了根，然后我想知道为什么我的德语语言环境没有加载，但我只是忘记`de-de : true`在根文件中设置。现在一切都像魅力一样运作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-11T07:40:00.033

首先，您通过 require.js 将 i18 文件加载到您的视图中。我在此示例中使用车把模板。

```
define([
    'marionette',
    'handlebars',
    'text!modules/tableModule/templates/myTmpl.html',
    'i18n!nls/dashboard',
],
function(Marionette, Handlebars, tmpl, locals) { ... 
```

然后你用 i18 对象编译和加载你的模板。

```
var template = Handlebars.compile(tmpl);
this.template = template(locals.myVar); 
```

你也可以去做复杂的组合

```
 var template = Handlebars.compile(tmpl);  
  var data =_.extend(options, {lang:locals});
  this.template = template(data); 
```

您的 nls 文件将如下所示

```
define({

    "root": {
         "myVar" : "some text in",
         "canBeAnObjectTo": {
                      "title"   : "my title ",
                      "contact" : "Contact",
            } 
```

你的观点将是这样的：

```
 <div class="cssClass">
<div class="table-caption pull-left">{{this.myVar}}</div>
  </div> 
```

希望有帮助

# c++ - 插入字符串 C++

> ID：14796728
> 
> 赞同：1
> 
> 时间：2013-02-10T10:23:29.367
> 
> 标签：c++, string, insert, stdstring

如果我想在用户输入的字符串中多次插入相同的字符例如：

```
int n=30;
string s="";
for(int i=0; i<n; i++) {
    s=s+"M";
} 
```

有没有更有效的方法可以在更短的时间内完成相同的过程？因为如果 n 是一个很大的数字，程序将需要很长时间才能运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:25:23.667

根据：[http](http://www.cplusplus.com/reference/string/string/append/) ://www.cplusplus.com/reference/string/string/append/ Case n°5：填充字符串

```
str.append (14, 'd'); 
```

将在您的字符串中附加 14 次字符“d”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:25:30.273

不确定它是否更快，但肯定是更好的风格：

```
s += std::string('M', n); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:32:33.587

答案很可能是不，没有更有效的方法来做到这一点。大多数操作实际上在计数上是线性的。包括构造一个替代字符串，使用`std::string::append`和附加到它`std::fill`。一个可能加快速度的好方法是通过使用`s.push_back('M')`并可能进行备用调用，但即使那样它也不会明显更快，如果有的话。

# google-app-engine - 谷歌应用引擎mapreduce管道库不使用webapp2吗？

> ID：14796733
> 
> 赞同：1
> 
> 时间：2013-02-10T10:23:51.303
> 
> 标签：google-app-engine

mapreduce 管道代码似乎没有使用 webapp2 和 ndb，并且需要关闭线程安全。这是否意味着我必须更新代码才能使用 webapp2 和线程安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T08:34:30.987

假设您拥有[最新的 MapReduce 框架](http://appengine-mapreduce.googlecode.com/svn/trunk/python/src/mapreduce)：

1.  MapReduce 支持 db 和 ndb。

2.  MapReduce 使用 webapp，但您不需要升级到 webapp2。它们都使用 WSGI 标准并且并排运行得很好。

3.  MapReduce`threadsafe: true`与小改动一起工作正常。

    ### mapreduce/main.py：

    ```
    def create_application():
        return webapp.WSGIApplication(create_handlers_map(),
                                      debug=True)

    mapreduce_app = create_application() 
    ```

    ### 应用程序.yaml：

    ```
    - url: /mapreduce/pipeline/images
      static_dir: mapreduce/lib/pipeline/ui/images
    - url: /mapreduce(/.*)?
      script: mapreduce.main.mapreduce_app
      login: admin 
    ```

# mysql - INNER JOIN 同一张表

> ID：14796738
> 
> 赞同：32
> 
> 时间：2013-02-10T10:24:24.283
> 
> 标签：mysql, sql, join, self-join

我正在尝试从同一张表中获取一些行。这是一个用户表：用户拥有`user_id`和`user_parent_id`。

我需要得到`user_id`行和`user_parent_id`行。我编写了这样的代码：

```
SELECT user.user_fname, user.user_lname
FROM users as user
INNER JOIN users AS parent
ON parent.user_parent_id = user.user_id
WHERE user.user_id = $_GET[id] 
```

但它没有显示结果。我想显示用户记录及其父记录。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-10T10:40:04.860

我认为问题在于你的`JOIN`情况。

```
SELECT user.user_fname,
       user.user_lname,
       parent.user_fname,
       parent.user_lname
FROM users AS user
JOIN users AS parent 
  ON parent.user_id = user.user_parent_id
WHERE user.user_id = $_GET[id] 
```

**编辑**`LEFT JOIN`：如果有没有父母的用户，您可能应该使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:35:51.433

您也可以使用 UNION 之类的

```
SELECT  user_fname ,
        user_lname
FROM    users 
WHERE   user_id = $_GET[id]
UNION
SELECT  user_fname ,
        user_lname
FROM    users 
WHERE   user_parent_id = $_GET[id] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-19T06:54:08.510

让我们尝试用一个简单的场景来回答这个问题，其中包含 3 个**`MySQL`**表，即**datetable**、**colortable**和**jointable**。

***首先***查看分配给**dateid**的`table` **datetable**值：`primary key``column`

 **```
mysql> select * from datetable;
+--------+------------+
| dateid | datevalue  |
+--------+------------+
|    101 | 2015-01-01 |
|    102 | 2015-05-01 |
|    103 | 2016-01-01 |
+--------+------------+
3 rows in set (0.00 sec) 
```

现在转到我们的***第二个*** `table`值**colortable**并`primary key`分配给`column` **colorid**：

```
mysql> select * from colortable;
+---------+------------+
| colorid | colorvalue |
+---------+------------+
|      11 | blue       |
|      12 | yellow     |
+---------+------------+
2 rows in set (0.00 sec) 
```

我们最后的***第三个*** **可**`table` **连接对象**没有，值是： **`primary keys`**

 **```
mysql> select * from jointable;
+--------+---------+
| dateid | colorid |
+--------+---------+
|    101 |      11 |
|    102 |      12 |
|    101 |      12 |
+--------+---------+
3 rows in set (0.00 sec) 
```

**现在**我们的条件是找到**dateid 的**，它同时具有*蓝色*和*黄色的***颜色**值。

 **所以，我们的查询是：

```
mysql> SELECT t1.dateid FROM jointable AS t1 INNER JOIN jointable t2
    -> ON t1.dateid = t2.dateid
    -> WHERE
    -> (t1.colorid IN (SELECT colorid FROM colortable WHERE colorvalue = 'blue'))
    -> AND
    -> (t2.colorid IN (SELECT colorid FROM colortable WHERE colorvalue = 'yellow'));
+--------+
| dateid |
+--------+
|    101 |
+--------+
1 row in set (0.00 sec) 
```

希望，这会帮助很多人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T10:26:13.600

也许这应该是选择（如果我正确理解了这个问题）

```
select user.user_fname, user.user_lname, parent.user_fname, parent.user_lname
... As before 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-10T10:26:28.703

您的查询应该可以正常工作，但您必须使用别名`parent`来显示父表的值，如下所示：

```
select 
  CONCAT(user.user_fname, ' ', user.user_lname) AS 'User Name',
  CONCAT(parent.user_fname, ' ', parent.user_lname) AS 'Parent Name'
from users as user
inner join users as parent on parent.user_parent_id = user.user_id
where user.user_id = $_GET[id]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-28T14:35:31.990

我不知道表是如何创建的，但试试这个......

```
SELECT users1.user_id, users2.user_parent_id
FROM users AS users1
INNER JOIN users AS users2
ON users1.id = users2.id
WHERE users1.user_id = users2.user_parent_id 
```******

# html - 插入框阴影不起作用

> ID：14796739
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:24:27.220
> 
> 标签：html, css

我正在尝试在 Chrome 中的输入字段上获得内部阴影。不幸的是，到目前为止，这并没有真正奏效。您可以在这里查看 jsfiddle：http: [//jsfiddle.net/XgsPT/2/](http://jsfiddle.net/XgsPT/2/)

我的 CSS：

```
input {
margin-top: 15px;
margin-left: 15px;
-moz-box-shadow:    inset 0 0 10px #000000;
-webkit-box-shadow: inset 0 0 10px #000000;
box-shadow:         inset 0 0 10px #000000;
} 
```

而这个简单的 HTML：

```
<input type="text" width="30"> 
```

但是没有出现阴影......（Chrome 24）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T16:41:09.260

为输入字段提供边框，box-shadow 最终将起作用。

[http://jsfiddle.net/Jx8xF/](http://jsfiddle.net/Jx8xF/)

```
input {
    margin-top: 15px;
    margin-left: 15px;
   -moz-box-shadow:    inset 0 0 10px #aaa;
   -webkit-box-shadow: inset 0 0 10px #aaa;
   box-shadow:         inset 0 0 10px #aaa;
    border: 1px solid #aaa;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T17:12:01.973

基本上，WebKit 不允许我们为具有原生外观的表单控件添加 box-shadow。我们需要删除 nativa 外观。

```
input {
    -webkit-appearance: none;
    box-shadow: inset 0 0 10px #000000;
} 
```

此外，一些 CSS 属性（例如边框和背景）暗示 -webkit-appearance:none。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:29:18.320

的背景颜色`input`搞砸了。看看[这个更新的小提琴](http://jsfiddle.net/jeroenheijmans/m5ybK/)，对 CSS 进行了这个更改：

```
input {
    /* ... rest as before ...*/
    background-color: transparent;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T12:44:01.723

与其将背景设置为透明，不如将其设置为白色或您喜欢的任何颜色，您只需要声明它，然后它就会正常工作

# mysql - 具有许多连接的 MySQL 查询执行时间过长

> ID：14796740
> 
> 赞同：0
> 
> 时间：2013-02-10T10:24:34.543
> 
> 标签：mysql, query-optimization

我有这个查询，加载时间太长（大约 40 秒）。

```
SELECT
  `auxiliary_table_2`.`entry_id`,
  `auxiliary_table_2`. `name`,
  COUNT(`auxiliary_table_2`.`entry_id`) AS `auxiliary_table_2_count`
FROM (SELECT
    `data_table`.*
      FROM `data_table`
    LEFT JOIN `exp_channels`
      ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    LEFT JOIN `exp_channel_titles`
      ON `exp_channel_titles`.`entry_id` = `data_table`.`entry_id`
      WHERE `exp_channels`.`channel_name` = 'main_table'
      AND `exp_channel_titles`.`status` = 'open'
      GROUP BY `data_table`.`entry_id`) AS `main_table`
  JOIN `mapping_table` AS `mapping_table_1`
    ON `mapping_table_1`.`rel_id` = `main_table`.`field_id_9`
  JOIN (SELECT
      `data_table`.`entry_id`,
      `data_table`.`field_id_8`       AS `name`
    FROM `data_table`
      LEFT JOIN `exp_channels`
        ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    WHERE `exp_channels`.`channel_name` = 'auxiliary_table_channel_name_1'
    GROUP BY `data_table`.`entry_id`) AS `auxiliary_table_1`
    ON `auxiliary_table_1`.`entry_id` = `mapping_table_1`.`rel_child_id`
  JOIN `mapping_table` AS `mapping_table_2`
    ON `mapping_table_2`.`rel_id` = `main_table`.`field_id_39`
  JOIN (SELECT
      `data_table`.`entry_id`,
      `data_table`.`field_id_38`      AS `name`
    FROM `data_table`
      LEFT JOIN `exp_channels`
        ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    WHERE `exp_channels`.`channel_name` = 'auxiliary_table_channel_name_2'
    GROUP BY `data_table`.`entry_id`) AS `auxiliary_table_2`
    ON `auxiliary_table_2`.`entry_id` = `mapping_table_2`.`rel_child_id`
  JOIN `mapping_table` AS `mapping_table_3`
    ON `mapping_table_3`.`rel_id` = `main_table`.`field_id_5`
  JOIN (SELECT
      `data_table`.`entry_id`,
      `data_table`.`field_id_1`       AS `name`
    FROM `data_table`
      LEFT JOIN `exp_channels`
        ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    WHERE `exp_channels`.`channel_name` = 'auxiliary_table_channel_name_3'
    GROUP BY `data_table`.`entry_id`) AS `auxiliary_table_3`
    ON `auxiliary_table_3`.`entry_id` = `mapping_table_3`.`rel_child_id`
  JOIN `mapping_table` AS `mapping_table_4`
    ON `mapping_table_4`.`rel_id` = `main_table`.`field_id_16`
  JOIN (SELECT
      `data_table`.`entry_id`,
      `data_table`.`field_id_18`      AS `name`
    FROM `data_table`
      LEFT JOIN `exp_channels`
        ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    WHERE `exp_channels`.`channel_name` = 'auxiliary_table_channel_name_4'
    GROUP BY `data_table`.`entry_id`) AS `auxiliary_table_4`
    ON `auxiliary_table_4`.`entry_id` = `mapping_table_4`.`rel_child_id`
  JOIN `mapping_table` AS `mapping_table_5`
    ON `mapping_table_5`.`rel_id` = `main_table`.`field_id_49`
  JOIN (SELECT
      `data_table`.`entry_id`,
      `data_table`.`field_id_48`      AS `name`
    FROM `data_table`
      LEFT JOIN `exp_channels`
        ON `exp_channels`.`channel_id` = `data_table`.`channel_id`
    WHERE `exp_channels`.`channel_name` = 'auxiliary_table_channel_name_5'
    GROUP BY `data_table`.`entry_id`) AS `auxiliary_table_5`
    ON `auxiliary_table_5`.`entry_id` = `mapping_table_5`.`rel_child_id`
GROUP BY `auxiliary_table_2`.`entry_id` 
```

它的要点是`data_table`在通过映射表映射的辅助表中具有辅助数据。`main_table`只是一个过滤的数据表。

这里有什么可能导致它运行缓慢吗？

`data_table`只有少量的行（大约 200+）所以我认为这是一个查询问题。

这是解释结果

```
id  select_type     table           type    possible_keys           key             key_len     ref                                     rows        Extra 
1   PRIMARY     <derived4>          ALL     NULL                    NULL            NULL        NULL                                    3           Using temporary; Using filesort
1   PRIMARY     <derived6>          ALL     NULL                    NULL            NULL        NULL                                    5           Using join buffer
1   PRIMARY     <derived7>          ALL     NULL                    NULL            NULL        NULL                                    6           Using join buffer
1   PRIMARY     <derived3>          ALL     NULL                    NULL            NULL        NULL                                    21          Using join buffer
1   PRIMARY     <derived2>          ALL     NULL                    NULL            NULL        NULL                                    20          Using join buffer
1   PRIMARY     <derived5>          ALL     NULL                    NULL            NULL        NULL                                    143         Using join buffer
1   PRIMARY     auxiliary_table_1   eq_ref  PRIMARY,rel_child_id    PRIMARY         4           main_table.field_id_9                   1           Using where
1   PRIMARY     auxiliary_table_2   eq_ref  PRIMARY,rel_child_id    PRIMARY         4           main_table.field_id_39                  1           Using where
1   PRIMARY     auxiliary_table_3   eq_ref  PRIMARY,rel_child_id    PRIMARY         4           main_table.field_id_5                   1           Using where
1   PRIMARY     auxiliary_table_4   eq_ref  PRIMARY,rel_child_id    PRIMARY         4           main_table.field_id_16                  1           Using where
1   PRIMARY     auxiliary_table_5   eq_ref  PRIMARY,rel_child_id    PRIMARY         4           main_table.field_id_49                  1           Using where
7   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
7   DERIVED     exp_channel_data    ref     channel_id              channel_id      4           devthree_ee.exp_channels.channel_id     17  
6   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
6   DERIVED     exp_channel_data    ref     channel_id              channel_id      4           devthree_ee.exp_channels.channel_id     17  
5   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
5   DERIVED     exp_channel_data    ref     channel_id              channel_id      4           devthree_ee.exp_channels.channel_id     17  
4   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
4   DERIVED     exp_channel_data    ref     channel_id              channel_id      4           devthree_ee.exp_channels.channel_id     17  
3   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
3   DERIVED     exp_channel_data    ref     channel_id              channel_id      4           devthree_ee.exp_channels.channel_id     17  
2   DERIVED     exp_channels        ref     PRIMARY,channel_name    channel_name    122                                                 1           Using where; Using temporary; Using filesort
2   DERIVED     exp_channel_data    ref     PRIMARY,channel_id      channel_id      4           devthree_ee.exp_channels.channel_id     17  
2   DERIVED     exp_channel_titles  eq_ref  PRIMARY,status          PRIMARY         4           devthree_ee.exp_channel_data.entry_id   1           Using where 
```

MYSQL 版本：

我正在使用 MySQL 5.1.66-cll

表格：

数据表

```
#   Name        Type        Collation       Attributes      Null    Default Extra
1   entry_id    int(10)                     UNSIGNED        No      None        
2   site_id     int(4)                      UNSIGNED        No      1       
3   channel_id  int(4)                      UNSIGNED        No      None        
4   field_id_1  text        utf8_general_ci                 Yes     NULL        
5   field_ft_1  tinytext    utf8_general_ci                 Yes     NULL        
6   field_id_2  text        utf8_general_ci                 Yes     NULL        
7   field_ft_2  tinytext    utf8_general_ci                 Yes     NULL        
8   field_id_3  text        utf8_general_ci                 Yes     NULL        
9   field_ft_3  tinytext    utf8_general_ci                 Yes     NULL        
10  field_id_4  int(11)                                     Yes     0       
11  field_ft_4  tinytext    utf8_general_ci                 Yes     NULL        
12  field_id_5  int(10)                                     Yes     0       
13  field_ft_5  tinytext    utf8_general_ci                 Yes     NULL        
14  field_id_6  text        utf8_general_ci                 Yes     NULL
..... 
```

映射表

```
#   Name                Type        Collation       Attributes      Null    Default     Extra   
1   rel_id              int(6)                      UNSIGNED        No      None        AUTO_INCREMENT
2   rel_parent_id       int(10)                                     No      0           
3   rel_child_id        int(10)                                     No      0           
4   rel_type            varchar(12) utf8_general_ci                 No      None        
5   rel_data            mediumtext  utf8_general_ci                 No      None        
6   reverse_rel_data    mediumtext  utf8_general_ci                 No      None 
```

PS 出于匿名目的，我已将表名替换为通用名称。

# typescript - 如何将只读属性添加到声明文件？

> ID：14796751
> 
> 赞同：5
> 
> 时间：2013-02-10T10:25:47.497
> 
> 标签：typescript

我正在为一个尚不存在的库创建一个声明文件，但其中有一些类具有只读属性。我怎样才能把它放在声明中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T11:40:29.127

奇怪的是，您不能在接口或环境声明上指定 getter 和 setter。

您可以获得的最接近的是：

```
interface Test {
    Prop: number;
}

class Example implements Test {
    private prop: number;

    get Prop() :number {
        return this.prop;
    }
} 
```

不幸的是，这不会阻止实现允许设置器，并且在环境声明的上下文中，它不会阻止调用者尝试设置值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-10T16:58:23.493

使用 TypeScript 2.0，您现在可以声明只读属性，例如

```
interface Point {
    readonly x: number;
    readonly y: number;
}

var p1: Point = { x: 10, y: 20 };
p1.x = 5;                            // Error, p1.x is read-only

var p2 = { x: 1, y: 1 };
var p3: Point = p2;                  // Ok, read-only alias for p2
p3.x = 5;                            // Error, p3.x is read-only
p2.x = 5;                            // Ok, but also changes p3.x because of aliasing 
```

请参阅[此处](https://github.com/Microsoft/TypeScript/wiki/What%27s-new-in-TypeScript "TypeScript 的新功能")了解更多详细信息。

# javascript - Physijs：将脉冲/力施加到 3d 身体中的特定点

> ID：14796756
> 
> 赞同：0
> 
> 时间：2013-02-10T10:26:14.890
> 
> 标签：javascript, 3d, three.js, webgl

我有一个 3d 模型，我想对其施加力/脉冲，并让物理引擎 Physijs 应用适当的旋转和平移速度，给定对象的质量分布。

怎样才能最好地做到这一点？据我所知，它只有设置旋转速度和向身体质心施加冲量的方法。但是，鉴于物体可以碰撞并产生旋转速度，我认为它至少必须在内部具有这种能力。

如果这对 Physijs 的要求太多，也许有一个替代的 javascript 物理库可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:59:28.073

我意识到这`applyImpulse()`确实做我想要的，而不是`applyCentralImpulse()`.

# php - 正则表达式提取此字符串或使用 json 解码

> ID：14796760
> 
> 赞同：1
> 
> 时间：2013-02-10T10:26:29.733
> 
> 标签：php, regex, string, curl, json

在 PHP 中，考虑到它是动态的并且总是在状态之后，正则表达式从下面提取“采取”的方式是什么：

```
HTTP/1.0 200 OK
Date: Sat, 09 Feb 2013 23:07:09 GMT
Accept-Ranges: bytes
Server: Noelios-Restlet-Engine/1.1.7
Content-Type: application/json;charset=UTF-8
Content-Length: 147
X-Cache: MISS from geonisis-2.eurodns.com
X-Cache-Lookup: MISS from geonisis-2.eurodns.com:80
Via: 1.0 geonisis-2.eurodns.com (squid/3.1.10)
Connection: keep-alive

{"service":"availability","domain":"","timestamp":1360451229,"content":{"domainList":[{"status":"taken","name":""}]}} 
```

下面显示我应该使用 json 解码。一个人将如何实现这一目标？

以上生成使用：

```
$process = curl_init($host);
curl_setopt($process, CURLOPT_HTTPHEADER, array('Content-Type: application/xml', $additionalHeaders));
curl_setopt($process, CURLOPT_HEADER, 1);
curl_setopt($process, CURLOPT_USERPWD, $username . ":" . $password);
curl_setopt($process, CURLOPT_TIMEOUT, 30);
curl_setopt($process, CURLOPT_POST, 1);
curl_setopt($process, CURLOPT_POSTFIELDS, $payloadName);
curl_setopt($process, CURLOPT_RETURNTRANSFER, TRUE);
$return = curl_exec($process); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:36:18.917

通过更改从响应中删除标头：

```
curl_setopt($process, CURLOPT_HEADER, false); 
```

然后使用以下命令解码 JSON 字符串：

```
$data = json_decode($curlResponse, true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:31:32.183

如果您从响应中丢弃标头，则可以使用：

```
$json = '{"service":"availability","domain":"","timestamp":1360451229,
"content":{"domainList":[{"status":"taken","name":""}]}}';
$data = json_decode($json, TRUE);
echo $data['content']['domainList'][0]['status']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:33:01.920

为什么要关心标题？这是一个 JSON 字符串，只需对其进行解码，您将拥有一个可以轻松访问的对象

在 php 中：

```
$jsonobj = json_decode('{"service":"availability","domain":"","timestamp":1360451229,    "content":{"domainList":[{"status":"taken","name":""}]}}'); 
```

在 JavaScript 中：

```
var jsonobj = JSON.parse('{"service":"availability","domain":"","timestamp":1360451229,"content":{"domainList":[{"status":"taken","name":""}]}}'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T10:35:04.473

```
$string = '
    HTTP/1.0 200 OK
    Date: Sat, 09 Feb 2013 23:07:09 GMT
    Accept-Ranges: bytes
    Server: Noelios-Restlet-Engine/1.1.7
    Content-Type: application/json;charset=UTF-8
    Content-Length: 147
    X-Cache: MISS from geonisis-2.eurodns.com
    X-Cache-Lookup: MISS from geonisis-2.eurodns.com:80
    Via: 1.0 geonisis-2.eurodns.com (squid/3.1.10)
    Connection: keep-alive

    {"service":"availability","domain":"","timestamp":1360451229,"content":{"domainList":[{"status":"taken","name":""}]}}';

$parts = explode("\n", $string);
$json = end($parts);
$data = json_decode($json);

$status = $data->content->domainList[0]->status; die;

echo $status; 
```

* * *

*编辑（基于问题更新）：*

从您的 cURL 请求中删除 CURLOPT_HEADER 行。这将简化响应并使其更易于解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T10:48:50.157

如果您需要使用标题，您有两种选择；

```
// first: regex
preg_match('~"status":"(.*?)"~i', $return, $match);
// print_r($match);
echo $match[1]; // taken

// second: json encode
$response = explode("\r\n\r\n", $return, 3);
// print_r($response);
$json_object = json_decode($response[2]);
$json_array  = json_decode($response[2], true); // toArray
// echo $json_object->content->domainList[0]->status;
echo $json_array['content']['domainList'][0]['status']; 
```

# php - 为什么我的 ZF2 MVC 应用程序使用 PhpRenderer 而不是 FeedRenderer？

> ID：14796763
> 
> 赞同：2
> 
> 时间：2013-02-10T10:26:55.110
> 
> 标签：php, zend-framework2, atom-feed, uncaught-exception

我有一个扩展的控制器类`Zend\Mvc\Controller\AbstractActionController`。我想要一种操作方法来生成原子提要。

我启用了`ViewFeedStratagy`module.config.php 中的：

```
return array(
    'view_manager' => array(
        'stratagies' => array(
            'ViewFeedStratagy',
        ),
        ...
    ),
    ...
); 
```

在我的控制器中，代码如下所示：

```
<?php
namespace Blog\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;
use Zend\Feed\Writer\Feed;
use Zend\View\Model\FeedModel;

class BlogController extends AbstractActionController
{
    // other action methods

    public function atomAction()
    {
        $feed = new Feed;
        // set feed data
        $feed->export('atom');

        $feedModel = new FeedModel();
        $feedModel->setFeed($feed);
        return $feedModel;
    }
} 
```

当我请求页面时，我得到：

```
PHP Fatal error:
Uncaught exception 'Zend\View\Exception\RuntimeException' with message
'Zend\View\Renderer\PhpRenderer::render:
Unable to render template "blog/blog/atom";
resolver could not resolve to a file' 
```

为什么它仍在尝试使用`Zend\View\Renderer\PhpRenderer`而不是`Zend\View\Renderer\FeedRenderer`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-03T22:40:00.743

`'strategies'`, 不是`'stratagies'`;)

另外`'ViewFeedStrategy'`，不`'ViewFeedStratagy'`

# c# - 通过 C 库在 C# 应用程序之间共享数据

> ID：14796771
> 
> 赞同：0
> 
> 时间：2013-02-10T10:28:11.800
> 
> 标签：c#, c, console-application, data-interchange

我这里有一个非常具体的问题，我在实践中从未见过，我希望你能帮助我证明我做错了什么：

因此，如果有两个 C-sharp 控制台应用程序和一个库，它具有共享内存段并用于数据（即状态位）交换。

在库中（为简单起见，我不能发布完整的代码，还有更多的东西）看起来像这样：

```
#pragma data_seg("shared")
int hbStatus = 0;
bool hbExit = false;
#pragma data_seg()
#pragma comment(linker, "/SECTION:shared,RWS")

extern "C" __declspec(dllexport) void __stdcall SetHBStatus(int status)
{
    hbStatus = status;
} 
```

和类似`int GetHBStatus()`which 返回`hbStatus`，以及 getter 和 setter 为`hbExit`一个

在主应用程序（名为“master”）中导入状态获取器和退出设置器，如下所示

```
class Program
    {
       const string dllimport = @"interchange.dll";
       [DllImport(dllimport)]
        public static extern int GetHBStatus();
       [DllImport(dllimport)]
        public static extern void SetHBExit(bool value);
... 
```

在从属应用程序 (HB.exe) 中导入`SetHBStatus`并`GetHBExit`具有以下逻辑：

```
static void Main(string[] args)
        {

            Initialize(); //after initialize, SetHBStatus is set to 1 if succeed, otherwise -1
            InitializeHeartbeatTimer(); //timer period is set in initialize and thorows an events, which doing main logic, so we may have empty while cycle
            while (!GetHBExit()) { }
            Console.WriteLine("HB exit status: " + GetHBExit());
            Console.ReadLine();
            Deinitialize();
            hbTimer.Dispose(); 
```

并且此状态用于主应用程序继续：

```
Console.ForegroundColor = ConsoleColor.Green;
Console.WriteLine("SUCCESS!");
Console.ForegroundColor = ConsoleColor.Yellow;
Console.WriteLine("Invoking heartbeat application");
try
{         
    Process.Start(System.AppDomain.CurrentDomain.BaseDirectory + "\\HB.exe");
}
catch (Exception e)
{
    Console.ForegroundColor = ConsoleColor.Red;
    Console.WriteLine("Failed to invoke HB application. Ending...");
    Console.WriteLine("Message: " + e.Message);
    break;
}
Console.ForegroundColor = ConsoleColor.Green;
Console.WriteLine("SUCCESS!");
SetHBExit(false); //clearing junk in library, if any
Console.ForegroundColor = ConsoleColor.Yellow;
Console.WriteLine("Waiting for HB app initializes");
while (GetHBStatus() == 0) //waiting for response HB.exe
{ }
if (GetHBStatus() > 0)
{
    Console.ForegroundColor = ConsoleColor.Green;
    Console.WriteLine("SUCCESS! Heartbeat send and ticking by interval");
}
if (GetHBStatus() < 0)
{
    Console.ForegroundColor = ConsoleColor.Red;
    Console.WriteLine("HB application fails. Check HB_log.txt for more details. Ending...");
    break;
}
Console.ForegroundColor = ConsoleColor.Yellow;
Console.WriteLine("Generating file for.....
... 
```

如果我们需要告诉 HB 应用程序取消初始化并杀死自己，我们将从 master 调用，这个调用我只在一个地方进行，并且存在问题（`hbStatus`在库中有“1”标志，在它的`Deini`t 中设置`hbStatus`到“0”），它期待主人，像这样：

```
Console.ForegroundColor = ConsoleColor.Yellow;
Console.WriteLine("Disconnecting heartbeat");
SetHBExit(true);
while (GetHBStatus() > 0) { }
Console.ForegroundColor = ConsoleColor.Green;
Console.WriteLine("HB killed and disconnected");
Console.WriteLine("\nAll disconnected, invoking main menu");
ShowOptions(); 
```

现在是我的问题：当我执行一个master应用程序时，它调用HB.exe，让它初始化，HB返回成功标志，master将继续正常工作，但是HB突然在Deinit结束并关闭自己，作为收到退出标志，但是标志 NOTHING 和 NOBODY 通过调用适当的函数设置（并且未显示有关断开连接和终止的消息）。

当我尝试将 SetHBExit 导入 HB.exe 并在初始化后以 false 调用时，问题仍然出现。

这只能在 32 位应用程序和库上看到，如果我将其编译到 64 位版本，应用程序运行顺畅且符合需要。但是，我不能使用 64 位版本，因为应用程序是给我的客户的，他不能在 64 版本中运行它（这也是一个奇怪的问题，他有一个 64 位的 W7，但是在程序尝试第一次调用时收到 BadImageFormatException库函数（在我的机器上它运行正常。奇怪，奇怪）

有什么建议我错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:17:52.000

更新和可能的解决方案：

“旧”C 不支持“bool”类型，如果我使用 BOOL，即 typedef int，32 位应用程序可以正常运行。所以我认为这个问题已经解决了:)

64 位机器上的 64 位应用程序的次要问题仍未解决，BadImageFormat 异常，但在我的机器上效果很好

# javascript - Jquery将字符串传递给函数

> ID：14796774
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:28:54.680
> 
> 标签：javascript, jquery

我想将列表的名称传递给我的函数，但它无法正常工作。我正在尝试将一个数组和一个字符串传递给我的函数。我想将“#myGallery_2”替换为动态的。我将如何正确地做到这一点？这就是我目前正在尝试的。

```
var src = $('#'+id+ li:nth-child('+index+')')

<ul id="myGallery_2">
<li></li>
<li>
</ul> 
```

* * *

```
var images= [
    'IMG_3872_s.jpg',
    'IMG_3926_s.jpg',
    'IMG_3929_s.jpg',
    'IMG_3930_s.jpg'
         ];  

$('#menu li:nth-child(2)').click(function(){
addThumbs(images, '#myGallery_2');
}); 
```

* * *

## 功能

```
function addThumbs(paths,id) {

        $.each(paths,function(index, value) {
        var str = value; 
        var big_img=str.replace("_s","_b");
        var src = $('#myGallery_2 li:nth-child('+index+')').find('img').attr('data-frame', value);
        var src = $('#myGallery_2 li:nth-child('+index+')').find('img').attr('src', big_img);
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:48:36.970

第一件事：修正报价

```
var src = $('#' + id + ' li:nth-child(' + index + ')') 
```

# shell - 使用 shell 命令进行货币解析和转换

> ID：14796775
> 
> 赞同：0
> 
> 时间：2013-02-10T10:29:14.390
> 
> 标签：shell, sed, awk

我正在寻找一个shell one-liner，它将以下示例货币字符串**PHP10000**解析为**$245**。我需要从字符串中解析数字，将其与预设的转换因子相乘，然后在结果中添加“$”前缀。

到目前为止，我所拥有的只是这个：

```
echo PHP10000 | sed -e 's/PHP//' 
```

结果`10000`是。

现在，我被困在如何对该结果进行乘法运算。

我想`awk`也可以解决这个问题，但我是 shell 命令的初学者。

**更新：**

我试过：

```
echo PHP10000 | expr `sed -e 's/PHP//'` \* 2 
```

并且乘法仅适用于整数。我不能使用浮点数，因为它给了我这个错误：`expr: not a decimal number: '2.1'`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T12:27:47.700

```
value=PHP10000
factor=40.82
printf -v converted '$%.2f' "$(bc <<< "${value#PHP} / $factor")"
echo $converted    # => $244.98 
```

*   该`${value#PHP}`部分是[参数扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)，从字符串的前面删除 PHP`$value`字符串
*   该`<<<`部分是 bash [here-string](http://www.gnu.org/software/bash/manual/bashref.html#Here-Strings)，因此您将公式传递给 bc 程序
*   bash 不做浮点运算，所以调用[`bc`](http://man.cx/bc)来执行计算
*   `printf -v varname`相当于其他语言`varname = sprintf(...)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:38:06.100

就像是：

```
echo PHP10000 | awk '/PHP/ { printf "$%.0f\n", .0245 * substr($1,4) }' 
```

它可以很容易地扩展到多币种版本，可以转换成一种货币（称为报价货币），例如：

```
awk '
BEGIN {
    rates["PHPUSD"]=.01
    rates["GBPUSD"]=1.58
}
/[A-Z]{3}[0-9.]+/ {
    pair=substr($1,1,3) "USD"
    amount=substr($1,4)
    print "USD" amount * rates[pair]
}
' <<EOF
PHP100
GBP100
EOF 
```

输出：

```
USD1
USD158 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:43:07.277

单程：

```
echo "PHP10000" | awk -F "PHP" '{ printf "$%d\n", $2 * .0245 }' 
```

结果：

```
$245 
```

或打印到小数点后两位：

```
echo "PHP10000" | awk -F "PHP" '{ printf "$%.2f\n", $2 * .0245 }' 
```

结果：

```
$245.00 
```

**编辑：**

Bash 不支持浮点运算。改用`bc`：

```
echo "PHP10000" | sed 's/PHP\([0-9]\+\)/echo "scale=2; \1*.0245\/1" | bc/e' 
```

结果：

```
245.00 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T13:34:57.987

还有另一种选择：

```
$ echo "PHP10000" | awk 'sub(/PHP/,""){ print "$" $0 * .0245 }'
$245 
```

# c# - 电子邮件排队和发送无延迟

> ID：14796779
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:29:56.700
> 
> 标签：c#, .net, windows, scheduled-tasks

我需要不间断地从 DB 中获取一些数据，并且需要通过循环访问 DB 中的结果来发送邮件。如何将电子邮件排队并在没有时间延迟的情况下发送它们。在 .NET 中实现此目的的建议方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:34:14.760

您可以创建一个批处理文件并在您的操作系统中使用任务计划程序附加它，您也可以在页面加载中调用数据库并将您的表保存在数据表中，之后您可以使用开关案例过滤 dt，在在这种情况下，您只需在页面加载中检查一次数据库..

# ruby-on-rails - 无法创建目录权限被拒绝

> ID：14796785
> 
> 赞同：1
> 
> 时间：2013-02-10T10:30:59.977
> 
> 标签：ruby-on-rails, linux, capistrano

我正在将我的 rails 应用程序部署到 vps。在`cap deploy:setup`我收到 mkdir: cannot create directory `/apps' 的错误。

我`set :user_sudo, false`在我的 deploy.rb 文件中使用。

我是 linux 新手，如何授予当前用户创建目录的权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:34:02.793

您将没有（或不应该）将目录创建到根 ('/') 目录的权限。

更改`mkdir`命令以在进程具有适当权限的目录中创建目录。

# html - 如何在 twitter bootstrap 的顶部导航栏前重叠图像？

> ID：14796786
> 
> 赞同：0
> 
> 时间：2013-02-10T10:31:02.137
> 
> 标签：html, css, twitter-bootstrap

我想在我的 Twitter Bootstrap 页面上放置一个横幅图像，图像的顶部重叠并位于顶部导航栏的前面。

我的html代码如下所示。它适用于小屏幕宽度，但对于更宽的屏幕，图像的顶部出现在导航栏的后面。我正在使用 Bootstrap v2.2.2。

任何想法如何使它适用于所有屏幕尺寸？非常感激！

```
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
       ...
    </div>
    <style type="text/css">
        .mypic {margin: -120px 0 -20px 10px;}
    </style>
    <div class="container">
        <div class="mypic">
            <img src="..." width="300"/>
        </div>
    </div>
    ...
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T01:59:14.763

我无法完全想象你的目标，但这是一个开始吗？
[http://jsfiddle.net/panchroma/xdv9m/](http://jsfiddle.net/panchroma/xdv9m/)

您可能需要使用媒体查询来优化小窗口大小的结果。

**CSS**

```
.mypic {
margin: -120px 0 -20px 10px; /* play with these to position the image */
position:absolute;
z-index:100;
width:300px;
} 
```

祝你好运！

# java - Java中的信号量实现

> ID：14796792
> 
> 赞同：2
> 
> 时间：2013-02-10T10:31:46.747
> 
> 标签：java, multithreading, concurrency, semaphore

我还没有使用`Semaphore`足够奇怪的......
无论如何我正在审查一些使用它的代码，并看到与锁不同，许可证可以由另一个线程释放（即没有所有权）。
我看了看`Concurrency in Action`，上面写着（第 98 页）：

> 该实现没有实际的许可对象......所以一个线程获得的许可可以被另一个线程释放

我之前没有注意到这个细节，并查看了我所说的操作系统教科书（我的重点）：

> 当一个进程修改信号量值时，**没有其他进程** ....etc

那么这是 Java 特定的设计决策吗？我的意思是信号量不属于线程。
还是我误解了信号量的概念？

**注意：**这不是一个好/坏设计等问题。我只是想确保我理解这个概念

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:38:02.313

根据维基百科，[信号量](http://en.wikipedia.org/wiki/Semaphore_%28programming%29)不会跟踪获取/释放*的*对象，而只会跟踪数量。因此，“所有权”在这里不适用。阅读“重要观察”部分！

因此没有所有权。在这方面，Java 信号量是正确的。Unix 信号量（参见 semop(2)）也以这种方式工作。

然而，*一些*教科书似乎相当自由地混合了术语“互斥锁”、“锁”和“信号量”——你可以自己判断这些文本的质量。

**编辑：**

我简直不敢相信 Tannenbaum 在信号量和互斥量之间没有区别，所以我搜索了“当一个进程修改信号量值 [...]”的完整引用并想出了这个问题（不知道是否他们来自坦南鲍姆）：

> [...] P 和 V 操作中对 S 的修改是不可分割地执行的：也就是说，当一个进程修改信号量值时，没有其他进程可以同时修改相同的信号量值。[...]

其他报价非常相似，我怀疑复制和粘贴:-)

关键是：如果您的文本内容相同，那么您误解了该段落的意图-这与“所有权”无关，而“仅”与并发访问有关。当多个线程试图同时访问一个信号量时，线程必须被序列化并且值的修改*（记住——**所有*资源的信号量内只有*一个*值）必须是原子的。

# java - 可点击的图像列表视图

> ID：14796794
> 
> 赞同：0
> 
> 时间：2013-02-10T10:31:59.007
> 
> 标签：java, listview, clickable-image

我有包含图像的列表视图，我想为每个图像打开活动。在我的代码（来自示例）中，有用于单击图像的 Toast。我想将其更改为开放活动，但我不知道如何。请帮我。这是我的代码：

```
public class ListOfAllAircraft extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.list_of_all_aircraft);

    final ArrayList<ItemDetails> image_details = GetSearchResults();

    final ListView lv1 = (ListView) findViewById(R.id.listV_main);
    lv1.setAdapter(new ItemListBaseAdapter(this, image_details));

    lv1.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(final AdapterView<?> a, final View v, final int position, final long id) { 
            final Object o = lv1.getItemAtPosition(position);
            final ItemDetails obj_itemDetails = (ItemDetails)o;
            Toast.makeText(ListOfAllAircraft.this, "You have chosen : " + " " + obj_itemDetails.getName(), Toast.LENGTH_LONG).show();
        }  
    });
}

private ArrayList<ItemDetails> GetSearchResults(){
    final ArrayList<ItemDetails> results = new ArrayList<ItemDetails>();

    ItemDetails item_details = new ItemDetails();

    item_details.setImageNumber(1);
    results.add(item_details);

    item_details = new ItemDetails();
    item_details.setImageNumber(2);
    results.add(item_details);

    item_details = new ItemDetails();
    item_details.setImageNumber(3);
    results.add(item_details);

    item_details = new ItemDetails();
    item_details.setImageNumber(4);
    results.add(item_details);

    item_details = new ItemDetails();
    item_details.setImageNumber(5);
    results.add(item_details);

    item_details = new ItemDetails();

    item_details.setImageNumber(6);
    results.add(item_details);

    return results;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:33:41.943

in `onItemclicklistner` of the listview do somthing like that.

```
 lv1.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(final AdapterView<?> a, final View v, final int position, final long id) { 

if(position == 0){

Intent intent = new Intent (ListOfAllAircraft.java, yourOtherActivityName1.class);
startActivity(intent);
}else if(position == 1){

Intent intent = new Intent (ListOfAllAircraft.java, yourOtherActivityName2.class);
startActivity(intent);

//.... and son

}

}  
}); 
```

also don't forget to add your Activity in your `manifest File`.

# jquery - 响应式等高 div

> ID：14796795
> 
> 赞同：0
> 
> 时间：2013-02-10T10:32:00.507
> 
> 标签：jquery

我有四个并排的 div，其中包含大致相同数量的文本，但有些浏览器呈现文本略有不同，以使某些 div 比其他 div 更高/更短。

我知道有 jQuery 插件可以让您将多个 div 设置为与最高的高度相同的高度，但是我的网站是响应式的，并且 div 的高度会随着响应式网站的平板电脑和移动“版本”而变化。

有没有办法设置这四个 div 让它们都是最高的高度，并且随着浏览器调整大小以触发布局切换到平板电脑或移动版本，div 将能够相应地调整它们的大小，并再次使所有的高度都与最高的 div 相等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:54:47.750

```
function resizeMy4Div(){
    var maxHeight = 0;
    $my4div.css("height","auto").each(function()
    {   var h = $(this).height();
        if(h > maxHeight) maxHeight = h;
    }).height(maxHeight);
}

$(window).on("resize",resizeMy4Div);
resizeMy4Div(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:28:11.100

好的，这是第二种解决方案，但假设更大的 div 总是相同的:-)

```
var biggerDiv = $();
var maxHeight = 0;

$my4div.each(function()
{   var $t = $(this);
    var h = $t.height();
    if(h > maxHeight)
    {   maxHeight = h;
        $biggerDiv = $t;
    }
}).not($biggerDiv).height(maxHeight);

$(window).on("resize",function()
{   $my4div.not($biggerDiv).height($biggerDiv.height());
}); 
```

# ms-access - 如何选择名称中包含最新日期的文件？

> ID：14796796
> 
> 赞同：2
> 
> 时间：2013-02-10T10:32:24.420
> 
> 标签：ms-access, vba

我正在将 CSV 文件导入 MS Access 中的表中。但是，文件夹中有许多具有相同扩展名的文件，并且名称包括*“mm_dd_yyyy”*格式的日期。

示例：假设我有两个 CSV 文件：

*   *my_music_02_10_2013_01_58_07_PM.csv*
*   *my_music_02_11_2013_03_04_07_PM.csv*

这两个文件都在同一个文件夹*myfolder*中。我想导入名称包含最新日期的文件。

这是我的代码的一小段：

```
strPath = "F:\myfolder\"
strFile = Dir(strPath & "my_music" & "*.csv") 
```

如何确定我的*“my_music*.csv”*中哪个是最新的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:12:31.443

在我看来，关键是从每个文件名中提取日期/时间，以便您可以比较它们以找出其中最新的。

这是一个立即窗口会话，用于测试下面包含的功能。如果找不到表示有效日期的字符串，该函数将返回 null。

```
? DateFromFilename("my_music_02_10_2013_01_58_07_PM.csv")
2/10/2013 1:58:07 PM 
? DateFromFilename("my_music_no_date_here.csv")
Null

Public Function DateFromFilename(ByVal pFileName As String) As Variant
    Dim strBaseName As String
    Dim strDate As String
    Dim strPieces() As String
    Dim varReturn As Variant

    varReturn = Null
    strBaseName = Split(pFileName, ".")(0)
    'Debug.Print "strBaseName: " & strBaseName
    strPieces = Split(strBaseName, "_")
    If UBound(strPieces) = 8 Then
        strDate = strPieces(4) & "-" & strPieces(2) & _
            "-" & strPieces(3) & " " & strPieces(5) & ":" & _
            strPieces(6) & ":" & strPieces(7) & " " & strPieces(8)
    End If
    'Debug.Print "strDate: " & strDate
    If IsDate(strDate) Then
        varReturn = CDate(strDate)
    End If
    DateFromFilename = varReturn
End Function 
```

# php - 如何在其他 PHP 代码中将 PHP 代码显示为字符串

> ID：14796797
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:32:26.073
> 
> 标签：php, paypal

我需要将此代码粘贴到管理面板，然后在网站上显示 Paypal 按钮。

```
<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="6UKjJ8hU6ML5f">
<input type="hidden" name="custom" value="<?php print($_SESSION['mid'].'-'.$_SESSION['mps']);?>">
<input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.sandbox.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

然后，需要使用以下代码在网站上显示此代码。

```
print $rs->fields("ppbutton"); 
```

现在，问题是由于 Paypal 表单中的 PHP 代码，每当我尝试在网站上打印高于值（paypal 按钮）时，由于另一个 PHP 代码中的 PHP 代码，它会给出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:42:01.697

我也认为，打印 htmlentities($rs->fields("ppbutton"));

是您的最佳选择。

您可以从此站点获取有关该功能的最新更新。

[http://php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:35:03.803

```
print htmlentities($rs->fields("ppbutton")); 
```

# html - Struts jQuery CKEditor 总是输出 UBB 而不是传统的 HTML

> ID：14796801
> 
> 赞同：1
> 
> 时间：2013-02-10T10:32:54.043
> 
> 标签：html, jsp, struts2, ckeditor, struts2-jquery

我的问题是使用这个 CKEditor 插件：Java/JSP Struts2 中的“ [http://code.google.com/p/struts2-jquery/wiki/CkeditorEditor](http://code.google.com/p/struts2-jquery/wiki/CkeditorEditor) ”。

我总是得到ubb代码（如`[b][i]test[/i][/b]`），而不是html代码（如`<b><i>test</i></b>`）。

我已经在网上搜索了几个小时的资源，但仍然找不到任何解决方案......很少有人使用这个插件，而且很少能找到资源......

我的 struts 配置和 ckeditor 工作正常。

我的代码：

```
<sjr:ckeditor 
            id="richtextEditor" 
            name="richtextEditor" 
            rows="8" 
            cols="80" 
            width="800"
            uploads="false"
            loadingText="Loading..."
            toolbar="MyToolbar"
            skin="kama"
            dataType="html"
            customConfig="/xxx/js/ckeditor.config.js"
    /> 
```

请帮忙~~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:32:57.013

执行有效搜索的两个重要规则是：

*   搜索时使用专有名称：`UBB`是[`Ultimate Bullettin Board`论坛软件](http://en.wikipedia.org/wiki/UBB.classic)，而代码本身则称为`BBCode`，[`Bullettin Board Code`](http://en.wikipedia.org/wiki/BBCode)。很难找到搜索 UBB 而不是 BBCode 的东西；
*   当插件包含第三方软件时，始终（首先）搜索第三方软件本身，而不是插件定制：您会发现更多信息搜索`CKEditor`而不是`Struts2-jQuery-Richtext`插件。

也就是说，两者都默认在模式`CKEditor`下启动，您必须明确要求在启动时打开模式；`Struts2-jQuery-Richtext``HTML``BBCode`

尝试使用默认配置重新启动，然后一次添加一次，尝试直到它中断。然后，绕过该参数...

[**您可以在Struts-jQuery**](http://struts.jgeppert.com/struts2-jquery-showcase/index.action)的 Showcase 上找到默认配置（在 Widgets -> Richtext 下）：

```
<sjr:ckeditor 
                    id="richtextEditor" 
                    name="echo" 
                    rows="10" 
                    cols="80" 
                    width="730"
                    height="250"
                    uploads="true"
                    onFocusTopics="focusRichtext"
                    onBlurTopics="blurRichtext"
                    onChangeTopics="highlightRichtext"
                    value="Cras dictum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aenean lacinia mauris vel est. Suspendisse eu nisl. Nullam ut libero. Integer dignissim consequat lectus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos."
                /> 
```

希望有帮助

# ping - 如果服务器拒绝 ping 请求，请检查延迟

> ID：14796806
> 
> 赞同：15
> 
> 时间：2013-02-10T10:33:35.777
> 
> 标签：ping, latency

我需要检查延迟的服务器拒绝 PING 请求，还有其他方法可以检查我的服务器延迟吗？提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-12-11T03:21:42.980

使用基于 TCP 的 ping。

如果您可以访问 Windows 机器，请使用[http://technet.microsoft.com/en-us/sysinternals/jj729731.aspx](http://technet.microsoft.com/en-us/sysinternals/jj729731.aspx)

下载压缩包，解压。从 CMD 提示符 cd 到解压文件夹，然后使用 -t 标志运行，如下所示：

```
psping.exe -t www.anywebsite.com:80 
```

![psping 到具有开放 TCP 端口的远程主机](../Images/fb9927a7ebb8ea78d7cd47e94b3d9cfd.png)

请注意：这假设您有一个在远程主机上运行的网站（上面示例中的端口 80）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T01:18:47.597

Some people recommend [hping](http://www.hping.org/) which can use other protocols like TCP (for when ICMP is denied).

Note that I haven't tried it so I would be curious to know your experience if you do.

# sql-server - 在给定的字符串集中查找字符串 bt 逗号分隔

> ID：14796815
> 
> 赞同：0
> 
> 时间：2013-02-10T10:34:35.910
> 
> 标签：sql-server, sql-server-2008, substring

我需要从下面的字符串中获取第三个子字符串是示例，使用 SQL Server 2008。

**字符串1：-**

```
('C20080703115333MCTTtettett','24','6101349328','Bundled Standard','4','2.00','Testing Insert for New SP',','PD2013021002584832540') 
```

**期望的结果：-** `6101349328`

**字符串2：-**

```
('C20080703115333MCTTetew','24','7101349328','Bundled Standard','4','2.00','Testing Insert for New SP',','PD2013021002584832540') 
```

**期望的结果：-** `7101349328`

**字符串3：-**

```
('C20080703115333MCTTteetew','24tt','8101349328','Bundled Standard','4','2.00','Testing Insert for New SP',','PD2013021002584832540') 
```

**期望的结果：-** `8101349328`

**字符串4：-**

```
('C20080703','24','111101349328','Bundled Standard','4','2.00','Testing Insert for New SP',','PD2013021002584832540') 
```

**期望的结果：-** `111101349328`

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:56:15.310

尝试这样的事情：

```
select val = substring
  (
    str
    , charindex(',', str, charindex(',',str, 0) + 1) + 2
    , charindex(',', str, charindex(',', str, charindex(',',str, 0) + 1) + 1)
       - (charindex(',', str, charindex(',',str, 0) + 1) + 3)
  )
from strings 
```

这使：

```
6101349328
7101349328
8101349328
111101349328 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/494ac/1)。

# php - mysql连接不起作用

> ID：14796816
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:34:38.053
> 
> 标签：php, mysql, sql, join

我有两个表：“用户”和“帖子”。帖子表有一个“post”列和一个“poster_id”列。我正在开发一个 PHP 页面，该页面显示*每个人*的最新帖子，如下所示：

```
SELECT * FROM posts WHERE id < '$whatever' LIMIT 10 
```

这样，我可以像这样打印每个结果：

```
id: 43, poster_id:'4', post: hello, world
id: 44, poster_id:'4', post: hello, ward
id: 45, poster_id:'5', post: oh hi!
etc... 
```

而不是 id，我想显示海报的名称（在“用户”表中有一个列）

我尝试了以下方法：

```
SELECT * 
FROM posts 
WHERE id < '$whatever' 
       INNER JOIN users 
           ON posts.poster_id = users.id LIMIT 10 
```

这是此任务的正确联接类型吗？在了解联接​​之前，我会查询用户表以获取每个帖子结果。结果应该最终看起来类似于：

```
id: 43, poster_id:'4', name:'foo', post: hello, world
id: 44, poster_id:'4', name:'foo', post: hello, ward
id: 45, poster_id:'5', name:'fee', post: oh hi!
etc... 
```

感谢您提前提供帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:35:35.207

`WHERE`子句必须在`FROM`子句之后。

```
SELECT  posts.*, users.*   // select your desired columns
FROM    posts 
        INNER JOIN users ON posts.poster_id = users.id 
WHERE   id < '$whatever'
LIMIT   10 
```

SQL 操作顺序如下：

*   FROM 子句
*   WHERE 子句
*   GROUP BY 子句
*   HAVING 子句
*   选择子句
*   ORDER BY 子句

**更新 1**

*对于两个表上都存在的*那些列名，在它们上添加一个`ALIAS`，以便可以唯一标识。例子，

```
SELECT  post.colName as PostCol, 
        users.colName as UserCol, ....
FROM .... 
```

在上面的示例中，两个表都有列 name `colName`。为了同时获得它们，您需要在它们上添加别名，以便在前端使用`PostCol`并`UserCol`获取它们的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:36:00.843

尝试：

```
SELECT *
FROM posts
INNER JOIN users ON posts.poster_id = users.id
WHERE posts.id < '$whatever'
LIMIT 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:36:38.457

语法有点不正确。

应该

```
SELECT * FROM posts
INNER JOIN users ON posts.poster_id = users.id
WHERE id < '$whatever' LIMIT 10 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T11:08:37.863

已经给出的答案告诉您查询根本不起作用的主要原因（即`WHERE`子句应该在`JOIN`子句之后），但是，我想补充几点：

*   我建议`OUTER JOIN`为此使用 an 。它可能不会有太大区别，但是如果 post 记录具有 invalid `poster_id`， an`INNER JOIN`将意味着记录从结果中删除，而 an`OUTER JOIN`将意味着记录被包含，但`users`表中的值将是`null`. 我想您不希望`poster_id`在`posts`表上出现无效数据，但即使在监管最好的系统中也会发生损坏的数据，并且在这些情况下仍然从查询中获取数据是有帮助的。

*   我强烈建议不要这样做`SELECT *`，而是逐项列出要从查询中返回的字段。`SELECT *`有很多问题，但是当您在查询中有多个表时尤其糟糕，因为如果您在两个表上都有同名的字段（例如`id`），那么很难区分您正在使用哪个表，因为您的 PHP 记录集不会包含表引用。逐项列出字段可能会使您的查询字符串更长，但不会使其变慢 - 如果有的话，它会更快 - 从长远来看，它会更容易使用。

Neither of these points are essential; the query will work without them (as long as you switch the `WHERE` clause to after the `JOIN`), but they may improve your query and hopefully also improve your understanding of SQL.

# c++ - 从 VC++ 目录切换到用于 Boost 的用户宏的问题

> ID：14796824
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:35:46.320
> 
> 标签：c++, visual-studio-2010, boost, visual-studio-macros

再会，

我之前通过在项目设置中使用 VC++ 目录下的 Include 和 Library Directory 路径成功地在 Visual Studio 2010 中使用了 boost。但是不久前，由于我学习的一位新讲师，我被迫改用“用户宏”进行链接。

将我的其他库移动到使用用户宏没有问题，我在创建宏时只是使用了相同的包含和库路径。然而，Boost 的表现并不好。虽然在 VC++ 目录下链接了 boost 文件夹，但它应该可以正常工作，但是当我尝试将包含和库路径移动到用户宏时，Visual Studio 拒绝识别路径并且我收到以下正常错误：

```
error C1083: Cannot open include file: 'boost/filesystem.hpp': No such file or directory 
```

当我回到使用 VC++ 目录时，它又可以工作了。

是否有任何简单的解释为什么 boost 不想与宏链接，而我所有的其他库都完全没问题？到目前为止，其他库包括 DevIL、SDL、glew、glm 和 assimp。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-10T11:46:18.010

我似乎找到了解决方案。我必须在“项目设置 - C/C++ - 附加包含目录”和“项目设置 - 链接器 - 附加库目录”下添加我的 boost 宏名称。

不知何故，我制作的其他宏自动出现在这两个列表中，我不确定为什么 boost 宏也没有自动添加。现在它可以正常工作了，所以我就这样继续下去。

# objective-c - 如何让 CATextLayer 平滑其文本？

> ID：14796826
> 
> 赞同：8
> 
> 时间：2013-02-10T10:35:53.027
> 
> 标签：objective-c, macos, core-animation, antialiasing, subpixel

根据[文档](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CATextLayer_class/Introduction/Introduction.html)，可以在 CATextLayer 中启用字体平滑：

`Text can only be drawn using sub-pixel antialiasing when it is composited into an existing opaque background at the same time that it's rasterized.`

以下是我对这句话的理解：

```
@implementation CATextLayerWithFontSmoothing
-(id)init {
    self=[super init];
    if (self) {
    CALayer * whiteBackground = [CALayer layer];
    CATextLayer * blackText = [CATextLayer layer];

    [whiteBackground setBounds:NSMakeRect(0, 0, 300, 300)];
    [blackText setBounds:NSMakeRect(0, 0, 300, 300)];

    [whiteBackground setBackgroundColor:[NSColor whiteColor].CGColor];
    [blackText setForegroundColor:[NSColor blackColor].CGColor];
    [blackText setString:@"CATextLayer"];

    [blackText setShouldRasterize:YES];

    [self addSublayer:whiteBackground];
    [self addSublayer: blackText];

    }
    return self; 
```

这是行不通的。不使用亚像素抗锯齿绘制文本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-10T11:47:38.577

[此处](http://www.cocoabuilder.com/archive/cocoa/202561-catextlayer-and-subpixel-anti-aliasing.html)描述的方法有效：

案例 2：如果您直接使用 CATextLayer，则需要继承 CATextLayer 并在绘图代码中执行以下操作：

```
- (void)drawInContext:(CGContextRef)ctx
{
CGContextSetRGBFillColor (ctx, r, g, b, a);
CGContextFillRect (ctx, [self bounds]);
CGContextSetShouldSmoothFonts (ctx, true);
[super drawInContext:ctx];
} 
```

这是平滑与非平滑的比较：

![常规 CATextLayer 上的文本](../Images/a1da16ed9ea1587bc0b55921e12019f2.png)

![具有亚像素 aa 的文本](../Images/13093f77fe7bd5a33b4d5471e550bc4b.png)

![两个图层的 800% 缩放](../Images/d12fd9d28648a974ea55919cf52eaf53.png)

PS：不要在 CRT 上看这个答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-10T03:28:42.110

可能会迟到。但我看到这个问题有一个完美的解决方案，正如史蒂夫的回答和 nacho4d 的评论：

[如何使 CATextLayer 中的文本清晰](https://stackoverflow.com/questions/3815443/how-to-get-text-in-a-catextlayer-to-be-clear)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T10:52:59.380

我理解这个文档的方式，它说`CATextLayer` *总是*禁用子像素抗锯齿。您引用的句子只是作为对此的解释，而不是作为如何启用它的说明 - 它后面是：

> 将图层的 opacity 属性设置为`YES`不会更改渲染模式。

...这意味着即使您为图层使用不透明背景，这也不会改变`CATextLayer`不使用子像素 aa 的事实。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-04T23:54:33.407

如果您来寻找 CATextLayer 在 OSX 中渲染稍微模糊的文本的问题，经过多次撞墙后，我通过执行以下操作得到了清晰的文本：

```
text_layer.contentsScale = self.window!.backingScaleFactor
text_layer.zPosition = 0 
```

（我还将视图背景层 contentsScale 设置为相同）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-21T10:15:13.430

接受的答案对我不起作用。

我在[Ignacio Nieto 博客上找到了可行的解决方案](https://digitalleaves.com/blog/2014/11/avoid-blurriness-in-catextlayer-text/)

```
textLayer.contentsScale = UIScreen.mainScreen().scale 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-04T09:14:23.260

最常见的情况是有清晰锐利的可见字体，所以在 Objective-C 中它看起来像......

```
CATextLayer *text = [CATextLayer layer];
text.allowsEdgeAntialiasing = NO;
text.allowsFontSubpixelQuantization = YES;
// the following is a CGFloat, so can even be scaled down, to make it pixelish
text.contentsScale = [UIScreen mainScreen].scale;
text.frame = CGRectInset(self.frame, 0, 5);
text.foregroundColor = UIColor.orangeColor.CGColor;
text.fontSize = 36.0;
text.font = (__bridge CFTypeRef _Nullable)([UIFont fontWithName:@"HelveticaNeue-UltraLight" size:text.fontSize]);
[self.layer addSublayer:text]; 
```

`.fontSize`设置属性时忽略文本，`.font`但在使用桥接设置字体之前，它可用于在创建字体时存储字体大小

# android - Android PhoneGap 上的 Jqplot 错误

> ID：14796828
> 
> 赞同：0
> 
> 时间：2013-02-10T10:36:01.013
> 
> 标签：android, cordova, jqplot

尝试在我的 Android PhoneGap 应用程序中使用 jqplot 时，出现此错误：

```
Uncaught TypeError: Object function (a,b){return new e.fn.init(a,b,h)} has no method 'jqplot' at file: 
```

该图应该在按下按钮后显示。

我有完全相同的代码在 Chrome 的网页上正常运行，这表明代码是正确的。

下面的链接有同样的问题，但没有人回答它，所以我想我会看看是否有人找到了解决方法。

[如何在 Android 的 phonegap 应用程序中绘制 jqplot 图表](https://stackoverflow.com/questions/10280770/how-to-plot-jqplot-chart-inside-phonegap-app-for-android/14791954#14791954)

包括：

```
<script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
<link rel="stylesheet" href="jquery.mobile/jquery.mobile-1.2.0.min.css" />
<script type="text/javascript" src="jquery.mobile/jquery-1.8.0.min.js"></script>  
<script type="text/javascript" src="jquery.mobile/jquery.mobile-1.2.0.min.js"></script>     
<!--[if lt IE 9]><script type="text/javascript" src="excanvas.js"></script><![endif]-->
<script type="text/javascript" src="jqplot/jquery.jqplot.js"></script>
<link rel="stylesheet" type="text/css" href="jqplot/jquery.jqplot.css" />
<script type="text/javascript" src="jqplot/jqplot.canvasAxisLabelRenderer.min.js"></script>
<script type="text/javascript" src="jqplot/jqplot.canvasTextRenderer.js"></script> 
```

jqplot代码：

```
function makegraph() {
    $.jqplot('chartdiv',  [[[1, 2],[3,5.12],[5,13.1],[7,33.6],[9,85.9],[11,219.9]]]);
} 
```

HTML：

```
<div id="chartdiv" style="height:400px;width:300px; "></div> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T15:46:51.890

找到了答案：

将 data-ajax="false" 放在 href 标记中以强制重新加载页面并加载 jqplot 脚本。

否则将 jqplot 脚本和 css 文件放在 data-role="page" 标记之后，脚本将在每个页面转换时加载。

# java - 关闭正在运行的单个线程

> ID：14796834
> 
> 赞同：2
> 
> 时间：2013-02-10T10:37:05.740
> 
> 标签：java, multithreading, shutdown

假设在我运行期间我想**优雅地关闭一个线程！**

我不想使用`Thread.stop()`也不`Thread.destroy()`因为他们的不安全行为。

注意：我熟悉使用`ExecutorService.shutdown()`选项。但我想知道另一种实现方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:44:05.467

停止线程的标准方法是调用`thread.interrupt();`. 为了让它工作，你需要确保你的线程响应中断，例如：

```
Thread t = new Thread(new Runnable() { public void run {
    while(!Thread.currentThread().isInterrupted()) {
        //your code here
    }
}});
t.start();
t.interrupt(); 
```

这仅在定期检查条件时才有效。请注意，您可以将中断机制委托给可中断的方法（通常是 I/O、阻塞队列、睡眠/等待提供可以阻塞直到被中断的方法）。

注意：在此示例中，您还可以使用：

```
 while(!interrupted()) {
        //your code here
    } 
```

`interrupted()``Thread.currentThread().isInterrupted()`除了中断标志被重置之外，它做同样的事情。因为它是你的线程，所以没关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:41:06.793

`run()`由于某种原因，您必须使线程的方法终止。如何实现这一点取决于*线程的作用*。

*   如果线程正在循环，您可以通过引发标志来停止它（通过循环条件检查）。
*   如果线程正在等待某个`Socket`流或任何其他流，则只需关闭该流。
*   如果线程在可以抛出 的调用上被阻塞`InterruptedException`，您可以`interrupt()`使用该线程并忽略异常。
*   如果线程正在消耗阻塞队列的元素，请使用*毒丸*方法，这意味着将一个元素放入队列中，这意味着“停止循环”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T10:42:08.523

你可以`isStopped()`在你的代码中有标志。并且正在运行的线程应该定期检查这个标志，看它是否应该停止。请注意，优雅地停止线程需要以允许停止的方式编写正在运行的代码。

[您可以查看this question以获得更详细的答案](https://stackoverflow.com/questions/3194545/how-to-stop-a-java-thread-gracefully)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T10:40:21.083

如果您的`run()`方法中有一个循环，`Thread`那么一个选项是您的循环在每次迭代时检查标志的值。

您可以从代码外部设置标志，例如您的线程将在开始下一次迭代之前停止执行。

# c++ - Ncurses：在列之间创建填充空间

> ID：14796838
> 
> 赞同：0
> 
> 时间：2013-02-10T10:37:43.347
> 
> 标签：c++, c, ncurses, curses

我正在使用 ncurses 创建一个可滚动的列表，类似于`aptitude`（apt-get front end）中的列表。

我应该如何在列之间创建填充空间？我打算使用`wprintw()`.

例如

```
pizza      spicy      10
steak      normal     10
burritoes  guacamole  20 
```

每行使用 wprintw()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T14:05:07.483

以下将为您提供 2 个空格填充、左对齐、10 个字符宽的字符串列，每个后跟一个空格，然后是 2 位十进制列。

```
wprintw(win,"%-10s %-10s %2d\n", "pizza", "spicy", 10); 
```

# matrix - 如何在二维排序数组中找到中位数？

> ID：14796842
> 
> 赞同：1
> 
> 时间：2013-02-10T10:39:15.023
> 
> 标签：matrix, median, sorted

假设您有一个按行和列排序的数字矩阵。

你如何找到中位数。

我在网上搜索并找到了很多答案，例如：

有一种算法可以在 O(logn) 中找到两个排序数组的中位数 - 应用这个 n 次。我认为这没有任何意义。

否则我会得到一些研究论文。不过，这个问题似乎并不那么有趣。

谁能给我一个精确的算法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-15T06:54:24.983

鉴于它是按行和按列排序的矩阵 (mxn)，我们可以使用优先队列找到 O(m*n*log(m)) 中的中位数。

伪代码是，

```
PriorityQueue<Pair<int, int>> pq(m); 
//Pair<int, int> is the coordinate of the matrix element
for i <- 0 to m
    pq.add(Pair(i, 0))
count <- 0
k = (m*n)/2
Pair<int, int> xy
while count < k:
    count++
    xy <- pq.poll()
    x <- xy.first
    y <- xy.second
    if y+1 < n:
        pq.add(Pair(x, y+1))
return matrix[xy.first][xy.second] 
```

# java - 为什么这个while循环在java中运行？

> ID：14796843
> 
> 赞同：0
> 
> 时间：2013-02-10T10:39:19.067
> 
> 标签：java, networking, while-loop

**更新：**我是个白痴。服务器有一条线路`out.println((String) null);`，客户端用来知道何时停止和断开连接。原来那行是不必要的，*可能*是“null”来自哪里（我不知道 tat 是如何变成字符串的，但是......）但是谢谢大家的帮助！

我正在编写一个客户端-服务器程序，在该程序中，一旦服务器将其发送为空，客户端就会终止。有问题的循环是：

```
while ((message = in.readLine()) != null) {
    System.out.println("C: Recieved " + message + " from server");
} 
```

输出是：

```
C: Recieved Hi from server
C: Recieved null from server 
```

服务器`null`在发送 hi 之后和调用`close()`客户端之前向客户端发送一个。我可能应该在前面提到这一点，但我在 java.net 中使用了 Socket 和 ServerSocket 类。但是为什么 while 循环运行两次，即使在 message 是时也进入`null`？

编辑：服务器发送空值的行是`out.println((String) null);`. 这会转换为字符串“null”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:41:02.597

*字符串* 与`"null"`值不同`null`。该值`null`由`readline()`没有更多数据的地方返回。

根据 Java 文档，`readline`返回：

> 包含行内容的字符串，不包括任何行终止字符，如果已到达流的末尾，则为 null。

如果您的服务器正在发送 string `"null"`，那实际上是非空数据。

# javascript - 为什么在 javascript 函数中无法识别此全局变量？

> ID：14796847
> 
> 赞同：0
> 
> 时间：2013-02-10T10:39:37.910
> 
> 标签：javascript, variables, global

尽管谷歌搜索过多，我只是不明白为什么我的函数 doSomething 在下面的情况下什么都不做。知道为什么它不起作用吗？

非常感谢，戈登

```
var arrAttend=new object();
arrAttend["Blob"]='hello';

function doSomething() {
alert (arrAttend["Blob"]);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T10:43:25.853

这是一个错字，您应该使用`new Object`（大写 O）。或使用[Object Literal](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals?redirectlocale=en-US&redirectslug=Core_JavaScript_1.5_Guide/Values,_Variables,_and_Literals#Object_literals)：

```
var arrAttend = {Blob: 'hello'};

function doSomething() {
  alert (arrAttend.Blob);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:44:41.950

两个问题：

*   `object`未定义
*   你不调用你的函数

尝试这个 ：

```
var arrAttend= {}; // that's the simplest way to create a new javascript object
arrAttend["Blob"]='hello';

function doSomething() {
   alert (arrAttend["Blob"]);
}
doSomething(); 
```

请注意，当您查看控制台时，很容易发现第一种错误：显示错误。我建议您使用开发人员工具（例如[Chrome 的](https://developers.google.com/chrome-developer-tools/docs/overview)工具），以免您盲目开发。顺便说一句，您会发现使用`console.log`代替`alert`通常更方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:42:31.963

尝试这个 ：

```
var arrAttend=new Object();
arrAttend["Blob"]='hello';

function doSomething() {
alert (arrAttend["Blob"]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T10:44:20.833

您的代码中有拼写错误。并且应该像下面一样使用一个对象 -

```
var arrAttend= {
        name:'Blob'
    };
function doSomething() {
alert (arrAttend.name);
}
      doSomething(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T10:44:54.060

尝试这个：

```
// create object
var arrAttend=new Object();
arrAttend["Blob"]='hello';

function doSomething() {
alert (arrAttend["Blob"]);
}

// call function
doSomething(); 
```

# wpf - 在 windows phone 7.1 上播放 .pls

> ID：14796848
> 
> 赞同：0
> 
> 时间：2013-02-10T10:39:47.583
> 
> 标签：wpf, windows-phone-7, wpf-controls, windows-phone-7.1, windows-phone

我在 windows phone 7 媒体元素上播放 .pls 直播频道时遇到问题。我之前也问过这个问题，有人说你需要解析 .pls 中的地址，因为 .pls 是一种播放列表格式，你有在其中播放音频的链接，但是当我解析时：
**http://69.175.103.226:8540 /listen.pls**我得到**http://69.175.103.226:8540** 你可以通过在浏览器上输入 http://69.175.103.226:8540/listen.pls 并下载 .pls 并用记事本打开它来检查**它**不是windows phone 玩的

知道怎么做吗？请帮助我，我被困住了

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T15:35:25.847

据我所知，这是一个 48kbps MP3 流。我不明白为什么它不起作用，除非你在设置媒体源的方式上做错了什么。

应该：

```
mediaElement.Source = new Uri("URL_TO_STREAM",UriKind.Absolute);
mediaElement.Play(); 
```

# sql-server - 在主表中添加客户特定记录

> ID：14796849
> 
> 赞同：2
> 
> 时间：2013-02-10T10:39:52.317
> 
> 标签：sql-server, database, sql-server-2008, database-design, multi-tenant

我已经设计了下表。

> 现在新的要求是我需要为所有租户显示一些类别。此外，每个租户都应该能够将他们的新类别添加到主类别中。所以他们可以看到所有大师+他们的特定类别

**租户表**

```
TenantId
Name 
```

**组表**

```
GroupId
Name 
```

**类别表**

```
CategoryId
Name 
```

**租户X类别**

```
TenantId
CategoryId 
```

我可以在上面的表格中做哪些改变来实现它？我在下面试过这个

修改类别表如下。

**类别表**

```
CategoryId
Name
TenantId NULL // This indicates tenant specific category 
```

为 TenantId 和 Name 添加唯一键

然后查询

```
SELECT *
  FROM Category where TenantId = 1
  UNION
SELECT *
  FROM Category where TenantId IS NULL 
```

> 但问题是如果两个租户只想查看特定类别，我需要在 Category 表中添加一个带有其他 TenantId 的新行。这意味着我正在查找表中创建重复条目。有什么建议可以实现新要求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T08:33:40.850

因此，租户 A 可能会看到：

*   (1) 主类别，
*   (2) 属于租户 A 的类别，
*   (3) 属于另一个租户并且另一个租户明确允许租户 A 看到的类别

您当前的架构似乎满足要求。特别是，前两个规则确实可以使用表`TenantId`中的可空列来实现`Category`，其中 NULL 代表主类别，非 NULL 值将引用类别的创建者/所有者，因此表示特定于租户的类别. （为了更清楚起见，我可能会将列重命名为类似`OwnerTenantId`的名称，但这可能只是我。）

要仅检索主类别或属于指定租户的类别，您可以使用您在问题中发布的查询或此查询（这可能会产生与您的查询相同的执行计划）：

```
SELECT
  CategoryId,
  CategoryName,
  CASE
     WHEN TenantId = @TenantId    THEN 'Mine'
     WHEN TenantId IS NULL        THEN 'Master'
  END AS Ownership
FROM Category
WHERE TenantId = @TenantId
   OR TenantId IS NULL
; 
```

要实施第三条规则，*除了*可以使用前两条规则访问的类别之外，您还可以使用`TenantXCategory`表来存储租户可用的类别。也就是说，如果租户 M 允许租户 N 看到租户 M 的某些类别，则类别的 ID 将与租户 N 的 ID 一起插入。*`TenantXCategory`*

 *因此，要查询特定租户可用的所有类别，您可以执行以下操作：

```
SELECT
  c.CategoryId,
  c.CategoryName,
  CASE
     WHEN c.TenantId = @TenantId    THEN 'Mine'
     WHEN c.TenantId IS NULL        THEN 'Master'
     WHEN tc.CategoryId IS NOT NULL THEN 'Someone else''s'
  END AS Ownership
FROM Category c
LEFT JOIN TenantXCategory tc
  ON tc.CategoryId = c.CategoryId AND tc.TenandId = @TenantId
WHERE c.TenantId = @TenantId
   OR c.TenantId IS NULL
   OR tc.CategoryId IS NOT NULL
; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T16:01:12.253

如果您要添加其他类别，您可能应该*有*一个标识符来区分主类别和用户定义的类别。

```
CREATE TABLE CategoryType (
    [CategoryTypeID] int primary key identity,
    [Description]
)

CREATE TABLE Category (
    [CategoryID] int primary key identity,
    [CategoryName] nvarchar(max)
    [CategoryTypeID] int
)

/*  CategoryTypes
    1    Master
    2    User-defined  */ 
```

显示特定租户的类别

```
SELECT *
FROM TenantXCategory txc
JOIN Tenant t
    ON t.TenantID = txc.TenantID
JOIN Category c
    ON c.CategoryID = txc.CateoryID
WHERE t.TenantName = N'user1909604'
    -- AND c.CategoryTypeID = 1 -- Only show master categories
    -- AND c.CategoryTypeID = 2 -- Only show user-defined categories
    -- AND c.CategoryID in (1, 2) -- Only show specific categories 
```

要为用户添加类别，请将类别存储在交叉引用表中。如果类别不存在，您必须先将其添加到类别表中。

```
INSERT TenantXCategory (TenantID, CategoryID)
SELECT @TenantID, @CategoryID 
```

--

除非您要存储创建类别的人（出于审计目的），否则这应该有效。如果不是，我误解了你的问题，你应该澄清你想要做什么。*

# ruby - 如何使用 Sinatra/Foreman 打印调试消息？

> ID：14796854
> 
> 赞同：1
> 
> 时间：2013-02-10T10:41:01.863
> 
> 标签：ruby, sinatra, foreman

我刚开始使用 Ruby 和 sinatra 框架。我现在已经用 heroku 进行了设置，我完全惊讶于它的运行效果。只有一件事我想不通。我如何调试东西？可能听起来很奇怪，但我有这个变量，我想打印出来看看，最好是在终端或类似的地方。我如何在福尔曼运行的红宝石中做到这一点？当我写打印或在工头日志中没有显示任何内容时......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T16:48:57.040

如果您正在使用`Foreman`，请尝试将`log:`进程添加到您的`Procfile`. 对于 Rails 应用程序，我`Procfile`看起来像这样：

```
web: bundle exec rails server thin -p $PORT -e $RACK_ENV
log: tail -f -n 0 log/development.log 
```

在我的示例中，您需要将 Sinatra 配置为登录到文件`log/development.log`。

在本地，`Foreman`将自动启动一个`log`进程并将日志吐出到终端，类似于您在 Heroku 上看到的内容。在 Heroku 上，`log`除非您手动缩放它（无论如何您都不想要），否则不会运行任何进程。

# c# - Linq to SQL - 如何使用条件进行选择并返回 IQueryable

> ID：14796856
> 
> 赞同：0
> 
> 时间：2013-02-10T10:41:04.783
> 
> 标签：c#, linq-to-sql, repository-pattern

我找不到如何实现以下场景的答案（我不知道要寻找什么方法）。我使用`C#`, `.NET FW4.5`,`Linq`到 SQL 和设计模式存储库。

如果我想选择所有设备，请使用以下代码：

```
/// <summary>
/// Get all Devices
/// </summary>
/// <returns></returns>
public IQueryable<Device> GetDevices()
{
    return myDataContext.Devices;
} 
```

如果我想按 ID 选择设备，请使用以下代码：

```
/// <summary>
/// Get Device by ID
/// </summary>
/// <param name="id"></param>
/// <returns></returns>
public Device GetDevice(int id)
{
    return myDataContext.Devices.SingleOrDefault(
        d => d.intDeviceId == id);
} 
```

但是我该如何实现以下情况？

选择所有设备，其中有一些条件（并返回`IQueryable<Device>`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:44:18.507

尝试：

```
return myDataContext.Devices.Where(
        d => yourConditions).AsQueryable(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:46:52.547

你可以像这样使用它：

```
public IQueryable<Device> GetDeviceUsingPredicate(Expression<Func<Device,bool>> predicate)
{
    return myDataContext.Devices.Where(predicate).AsQueryable();
} 
```

要与泛型一起使用：

```
public IQueryable<T> GetDeviceUsingPredicate(Expression<Func<T,bool>> predicate)
{
    return myDataContext.GetTable<T>().Where(predicate).AsQueryable();
} 
```

# enterprise-library-5 - 如何部署使用企业库的应用程序

> ID：14796858
> 
> 赞同：1
> 
> 时间：2013-02-10T10:41:07.293
> 
> 标签：enterprise-library-5

我有一个使用统一和日志记录应用程序块的应用程序。添加这些程序集后，我最近从存储库中签出了应用程序，但出现了一些错误。最终我在我的电脑上安装了企业库，它现在可以工作了。我的问题是我必须在每台使用它的电脑上安装 Enterprise Library 吗？如果是这样，有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:33:41.473

问题是您引用企业库程序集的项目正在引用企业库的安装位置 - 可能是 Program Files 目录。[您可以通过 Nuget](http://nuget.org/packages/EnterpriseLibrary.Logging)添加企业库引用，而不是在那里引用它们，然后将包作为项目的一部分签入源代码管理。这样您就可以将项目及其依赖项集中在一个地方，并且不必在任何地方安装企业库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T10:41:42.863

嗨，我不知道我是如何解决的。我认为我的问题是我使用的是企业图书馆实验室的 dll 和配置 exe。我应该在我的电脑上安装了 ent lib 5。我在我的 ci 服务器中遇到了同样的问题，所以我从存储库中删除了我的项目并在我的本地工作时再次添加它。

因此，简而言之。安装 entlib 5 并且不要在项目中使用来自实验室的 dll。我不需要在我的部署中安装 ent lib，我只需要复制 dll。

# android - 如何在 EditText Android 中创建蓝色水平线

> ID：14796861
> 
> 赞同：0
> 
> 时间：2013-02-10T10:41:31.563
> 
> 标签：android

在我的问题标题中，它是 Android 中的默认主题还是我需要手动完成？我想从 Froyo 设备及更高版本中获取它。有任何指导或提示来实现它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:58:17.453

您是否要求为 3.0 之前的 Android 版本提供 Holo 主题？如果你这样做了，那么看看 HoloEverywhere 库：[https ://github.com/ChristopheVersieux/HoloEverywhere](https://github.com/ChristopheVersieux/HoloEverywhere)

许多开发人员使用它，它完全符合您的期望。

# regex - 如何使用正则表达式（VB.NET）提取文件位置

> ID：14796862
> 
> 赞同：0
> 
> 时间：2013-02-10T10:41:34.907
> 
> 标签：regex, vb.net, pattern-matching

我遇到了一个问题，给我一个包含文件路径和文件名的字符串，我只想提取路径（没有文件名）

例如，我会收到类似的东西

> C:\Users\OopsD\Projects\test.acdbd

从那个字符串中我只想提取

> C:\Users\OopsD\Projects

我试图创建一个正则表达式来匹配一个反斜杠后跟一个单词，然后是一个点，然后是另一个单词 - 这是为了匹配

> \test.acdbd

部分并将其替换为空字符串，以便最终结果为

> C:\Users\OopsD\Projects

任何熟悉 RegEx 的人都可以帮我解决这个问题吗？另外，我将来会大量使用正则表达式。我可以下载一个（免费）程序来创建正则表达式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:46:57.723

您正在寻找的正则表达式如下：

```
[^/]+$ 
```

其中， `^ (caret):`匹配应用正则表达式模式的字符串的开头。匹配一个位置而不是一个字符。大多数正则表达式风格都可以选择在换行符之后（即在文件中的行首）进行插入符匹配。

`$ (dollar):`匹配应用正则表达式模式的字符串末尾。匹配一个位置而不是一个字符。大多数正则表达式风格都可以选择在换行之前（即在文件中的行尾）进行美元匹配。如果字符串以换行符结尾，则在最后一个换行符之前也匹配。

`+ (plus):`重复上一个项目一次或多次。贪婪，因此在尝试与前一项匹配较少的排列之前，将匹配尽可能多的项，直到前一项仅匹配一次。

可以在[此](http://www.regular-expressions.info/reference.html)链接中找到更多参考。

许多正则表达式软件和工具都在那里。他们之中有一些是：

1.  [www.gskinner.com/RegExr/](http://www.gskinner.com/RegExr/)
2.  [www.txt2re.com](http://www.txt2re.com)
3.  [Rubular](http://www.rubular.com/) - 它不仅适用于 Ruby。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:01:36.983

你真的确定你需要使用正则表达式来完成简单的任务吗？这个怎么样：

```
Dim file As New IO.FileInfo(" C:\Users\OopsD\Projects\test.acdbd")
MsgBox(file.Directory.FullName) 
```

关于 Regex 上的免费程序，我肯定会推荐[http://www.gskinner.com/RegExr/](http://www.gskinner.com/RegExr/) - 一直使用它。但是在采用正则表达式之前，您总是必须考虑替代方案。

# database - 跟踪没有主键的数据变化

> ID：14796864
> 
> 赞同：1
> 
> 时间：2013-02-10T10:41:39.480
> 
> 标签：database, database-design, primary-key

我正在编写一个使用[CC-CEDICT](http://cc-cedict.org/wiki/)的应用程序，CC-CEDICT是 CC 许可的中英词典。

该词典仅作为[压缩文本文件 (4MB)](http://www.mdbg.net/chindict/export/cedict/cedict_1_0_ts_utf-8_mdbg.zip)提供，条目格式如下：

```
Traditional Simplified [pin1 yin1] /English equivalent 1/equivalent 2/ 
```

这是样本数据：

```
是 是 [shi4] /is/are/am/yes/to be/
昰 是 [shi4] /variant of 是[shi4]/used in given names/
時 时 [Shi2] /surname Shi/
時 时 [shi2] /o'clock/time/when/hour/season/period/ 
```

我特意选择了这些台词来说明我的问题。数据没有可以识别单个单词的可识别键。

英文的定义是可以改变的，而且随着词典的不断更新，但是假设在一次更新中 时 时 的两个定义发生了变化，所以下一个下载包含以下几行：

```
時 时 [Shi2] /last name Shi/
時 时 [shi2] /o'clock/time period/when/hour/season/ 
```

我如何知道哪些记录已更新？当翻译是一个完全改变的单词时，这一点非常明显。

我正在制定关于如何键入这本字典的策略。到目前为止，我最好的想法是将 (Simplified, Traditional) 作为键，并将重复项视为特殊情况 - 也许在他们自己的表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:19:13.977

问题是一种观点。

您说您的记录没有密钥，但实际上***整条记录*都是密钥**- 假设您没有相同的重复记录。

因此**没有*更新***，只有**插入**和**删除**。

您可以跟踪哪些记录被删除，哪些记录被插入，以突出字典中的更改。

* * *

如果您*真的*想将定义替换视为更新，那么您将不得不提出一个方案，该方案 (a) 为记录创建唯一键，并且 (b) 允许您识别何时应考虑新的定义列表对现有定义列表的修改。

(a) 部分很简单，添加您自己的代理键。这在所有定义中可能是唯一的，或者只是在（简体、繁体）的组合中是唯一的。

(b) 部分更难。你在什么时候说“姓施”与“姓施”有关？我建议提出某种产生数字分数的文本比较函数。为这个分数选择一个阈值，在这个阈值上你称之为更新而不是删除和插入。这将是任意的，但您可能会发现两个人可能会就什么是更新和什么不是从一个案例到另一个案例存在分歧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:16:59.227

这不是解决方案，但可能会为您（或其他人）提供一些想法。

将其建模为层次结构怎么样，单词->含义->翻译。计算翻译的哈希值，将所有翻译的哈希值相加并将其存储在相应的“含义”记录中，然后将所有含义的哈希值相加并将其存储在 Word 记录中。（是的，这是非规范化的）。

您每次都必须重新计算文件中所有记录的所有哈希值。然后，您可以简单地将当前存储的“单词”哈希值与您刚刚计算的哈希值进行比较。如果它们不同，则某些情况发生了变化。要么有新的含义，要么有新的翻译或翻译被删除，等等。然后，您可以完全删除该词（级联）并重新插入新的“子树”。如果您想使事情复杂化，您也可以进入层次结构并尝试准确检测发生了什么变化。

# ssms - 自定义对象资源管理器

> ID：14796865
> 
> 赞同：0
> 
> 时间：2013-02-10T10:41:41.873
> 
> 标签：ssms

对象资源管理器显示了这一点： ![在此处输入图像描述](../Images/82fb20038b5ce003524cb7ff9af0bcdf.png)

但是我只想在单击数据库加号图标时看到展开的 Keys and Columns 文件夹。像这样： ![我编辑了截图](../Images/8d0a69a7a668d25872ec661abd01ca26.png)

有没有办法通过脚本或其他方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T14:19:39.447

没有内置的方法来完成它。但是可以通过编写加载项来实现。

如果您愿意 - 您可以尝试编写自己的。这是我编写的 SSMS2012 示例“hello world”加载项：[http](http://www.ssmsboost.com/create-own-ssms-2012-add-in-sample-code-with-download) ://www.ssmsboost.com/create-own-ssms-2012-add-in-sample-code-with-download 如果你没有时间，您可以在项目的网站上提交功能请求。

# java - 在java中组织数据（在mac上）

> ID：14796867
> 
> 赞同：0
> 
> 时间：2013-02-10T10:41:48.107
> 
> 标签：java, storage

我正在编写一个分析股市数据的工具。为此，我下载数据，然后将与股票对应的所有数据作为`double[][]`20*100000 数组保存在我的 hd 上的 data.bin 中，我知道我应该把它放在某个数据库中，但这只是性能方面最好的方法。

现在这是我的问题：我需要对数据进行更新和搜索： 更新：随着时间的推移，我必须将新数据附加到数组的末尾。搜索：我想遍历不同的数据文件以找到最小值或计算移动平均值等。

我可以通过读取整个文件并更新它写入或在特定区域进行搜索来完成这两个操作......但这有点矫枉过正，因为我不需要整个数据。

所以我的问题是：是否有一个库（在 Java 中）或类似于打开/读取/更改二进制文件的部分而不必打开整个文件的东西？或者从特定点开始搜索文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:49:46.927

RandomAccessFile 允许查找文件中的特定位置并更新文件的某些部分或在末尾添加新数据，而无需重写所有内容。请参阅此处的教程：http: [//docs.oracle.com/javase/tutorial/essential/io/rafs.html](http://docs.oracle.com/javase/tutorial/essential/io/rafs.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:50:41.287

您可以尝试查看随机访问文件：

教程：[http ://docs.oracle.com/javase/tutorial/essential/io/rafs.html](http://docs.oracle.com/javase/tutorial/essential/io/rafs.html)

API：[http ://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html)

...但是您仍然需要找出要在二进制文件中读取的确切位置。

您可能需要考虑迁移到数据库，可能是像 H2 （[http://www.h2database.com](http://www.h2database.com)）这样的小型嵌入式数据库

# c++ - 双向链表始终只包含 1 条记录

> ID：14796872
> 
> 赞同：1
> 
> 时间：2013-02-10T10:42:23.857
> 
> 标签：c++, gcc, linked-list, structure, doubly-linked-list

我正在编写一个简单的程序来处理 C++ 中的结构，但是有一个我无法解决的问题。

我的程序接收很少的结构作为输入。它应该通过键对它们进行排序并打印它们。但是对于我的代码，我的列表中总是只有一个结构：

```
#include "iostream"
#include "string.h"
#include "limits"  //ignore max
#include "stdlib.h"//atof
using namespace std; 

struct Struct {
    char text[10];
    int age;
    Struct* prev;
    Struct* next;
};

int input(string msg) {
    char str[2];
    int check = 0, len = 0,
    var = 0,
        i = 0;
    while (1) {
        cout << msg;
        cin.getline(str, 2);
        if (cin.fail()) {
            cin.clear();
            cin.ignore(numeric_limits<streamsize>::max(), '\n');
        }
        len = strlen(str);
        check = 0;
        for (i = 0; i < len; i++) {
            if (isdigit(str[i])) {
                check++;
            }
        }
        if (check == len && !(check == 1 && str[0] == '-') && check != 0 && atoi(str) != 0) {
            var = atoi(str);
            return var;
        } else {
            cout << "Error!" << endl;
        }

    }
}

Struct* add_struct_to_list(Struct* prev) {
    Struct* NewStruct = 0;
    char str[10];
    int age;
    cout << "Name: ";
    cin.getline(str, 10);
    if (cin.fail()) {
        cin.clear();
        cin.ignore(numeric_limits <streamsize>::max(), '\n');
    }
    age = input("Age: ");
    NewStruct = new Struct;
    strcpy(NewStruct->text, str);
    NewStruct->age = age;
    NewStruct->prev = prev;
    NewStruct->next = 0;
    return NewStruct;
}

Struct* start_new_list(int number) {
    Struct* NewList = 0;
    NewList = add_struct_to_list(0);
    Struct* NewStruct = NewList;
    int counter = 1;
    for (counter; counter < number; counter++) {
        NewStruct = add_struct_to_list(NewStruct);
    }
    return NewList;
}

void delete_all_list(Struct* list_begin) {
    Struct* to_delete = list_begin->next;
    Struct* next = 0;
    delete[] list_begin;
    if (to_delete != 0) {
        do {
            next = to_delete->next;
            delete[] to_delete;
        } while (next != 0);
    }
}

void sort_by_age(Struct* list_begin) {
    Struct* node = 0;
    Struct* node2 = 0;
    int age;
    for (node = list_begin; node; node = node->next) {
        for (node2 = list_begin; node2; node2 = node2->next) {
            if (node->age < node2->age) {
                age = node->age;
                node->age = node2->age;
                node2->age = age;
            }
        }
    }
}

void print_list(Struct* list_begin) {
    for (Struct* node = list_begin; node; node = node->next) {
        cout << "Age: " << node->age << "; Name: " << node->text << endl;
    }
}

int main() {
    int number = input("Number of students: ");
    Struct* NewList = start_new_list(number);
    sort_by_age(NewList);
    print_list(NewList);
    delete_all_list(NewList);
    return 0;
} 
```

输入：

```
 Number of students: 3
 Name: as
 Age: 1
 Name: as
 Age: 2
 Name: as
 Age: 3 
```

输出：

```
Age: 1; Name: as 
```

另请注意，这是作业，我**必须**使用`struct`s.

UPD：感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:58:49.850

`node->next`您正在尝试使用指针遍历您的列表：

```
for (Struct* node = list_begin; node; node = node->next) {
    cout << "Age: " << node->age << "; Name: " << node->text << endl;
} 
```

但是您将 new `Struct`s 添加到列表中的方式是错误的，因为您始终设置`next`为`0`：

```
Struct* add_struct_to_list(Struct* prev) {
    ...
    NewStruct->prev = prev;
    NewStruct->next = 0;
    return NewStruct;
} 
```

即使您分配 3 个 new `Struct`，它们都将具有指向`next`equal to的指针`0`。将新添加到列表的正确方法`Struct`如下所示：

```
Struct* start_new_list(int number) {
    Struct* prevStruct = NULL;
    Struct* newList = NULL;                 // pointer to the first struct
    for (int counter = 0; counter < number; counter++) {
        Struct* newStruct = add_struct_to_list(prevStruct);
        if (prevStruct)                     // if there was previous struct:
            prevStruct->next = newStruct;   // make it point to new struct
        if (counter == 0)                   // if it is first allocated struct:
            newList = newStruct;            // store its address
        prevStruct = newStruct;             // store last struct as "prev"
    }
    return newList;
} 
```

另请注意，当您通过调用分配内存时`new`，您应该通过调用释放它`delete`。您正在使用`delete[]`，分配时应使用`new[]`。清理您的列表应如下所示：

```
void delete_all_list(Struct* list_begin) {
    Struct* structToDelete = NULL;
    Struct* node = list_begin;
    while (node->next) {
        structToDelete = node;
        node = node->next;
        delete structToDelete;
    }
    delete node;
} 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:11:03.057

NewStruct->next 始终为 0。这是您所期望的吗？

此外，您可能希望将结构作为一个单元进行排序，而不是改变人们的年龄！

# windows-phone-8 - 捕获的音频缓冲区在 Windows Phone 8 上都是无声的

> ID：14796877
> 
> 赞同：3
> 
> 时间：2013-02-10T10:42:48.597
> 
> 标签：windows-phone-8, wasapi, windows-phone-voip

我正在尝试使用 WASAPI 捕获音频。我的代码主要基于[ChatterBox VoIP 示例应用程序](http://code.msdn.microsoft.com/wpapps/ChatterBox-VoIP-sample-app-b1e63b8b)。我正在获取音频缓冲区，但它们都是无声的（标记为 AUDCLNT_BUFFERFLAGS_SILENT）。

我正在为 Windows Phone 使用 Visual Studio Express 2012。在模拟器上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-10T17:56:02.410

如果我将 Visual Studio 设置为本机调试并在任何时候单步执行代码，我遇到了完全相同的问题并设法在 ChatterBox 示例应用程序中重现它。

此外，在不经过“停止”程序的情况下关闭应用程序并停止 AudioClient 将要求您重新启动模拟器/设备，然后才能再次捕获音频数据。

在我弄清楚前面提到的问题之前，它几乎让我发疯，但我终于让它工作了。

所以.. 1\. 一定不要做原生调试 2\. 总是调用 IAudioClient->Stop(); 在终止应用程序之前。3\. 确保将正确的参数传递给 IAudioClient->Initialize()；

我已经包含了一段对我来说 100% 有效的代码。为了清楚起见，我省略了错误检查..

```
LPCWSTR pwstrDefaultCaptureDeviceId =
  GetDefaultAudioCaptureId(AudioDeviceRole::Communications);
HRESULT hr = ActivateAudioInterface(pwstrDefaultCaptureDeviceId,
  __uuidof(IAudioClient2), (void**)&m_pAudioClient);
hr = m_pAudioClient->GetMixFormat(&m_pwfx);
m_frameSizeInBytes = (m_pwfx->wBitsPerSample / 8) * m_pwfx->nChannels;
hr = m_pAudioClient->Initialize(AUDCLNT_SHAREMODE_SHARED,
  AUDCLNT_STREAMFLAGS_NOPERSIST | AUDCLNT_STREAMFLAGS_EVENTCALLBACK, 
  latency * 10000, 0, m_pwfx, NULL);
hr = m_pAudioClient->SetEventHandle(m_hCaptureEvent);
hr = m_pAudioClient->GetService(__uuidof(IAudioCaptureClient),
  (void**)&m_pCaptureClient); 
```

就是这样。在调用此代码之前，我已经启动了一个工作线程，它将监听 m_hCaptureEvent 并调用 IAudioCaptureClient->GetBuffer(); 每当触发捕获事件时。

当然，使用 Microsoft.XNA.Audio.Microphone 可以正常工作，但引用 XNA 框架并不总是一种选择.. :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-27T14:07:19.753

这是一个非常烦人的问题，浪费了我大约 2 天的时间。我的问题通过设置`AudioClientProperties.eCatagory`为`AudioCategory_Communications`而不是`AudioCategory_Other`.

经过这么长的尝试和错误期后，我不确定这个问题将来是否会重复，因为 API 的行为不是很稳定，每次运行都可能返回不同的结果。

编辑：是的，我的猜测是正确的。重新启动 wp 模拟器会使缓冲区再次静音。但是将其更改`AudioClientProperties.eCatagory`为`AudioCategory_Other`再次解决它。我仍然不知道它有什么问题以及最终的解决方案是什么。

我再次遇到同样的问题，这次评论（删除） `properties.eCategory = AudioCategory_Communications;` 解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-04T15:45:47.587

我可以添加我对 Windows Phone 8.1 的建议。我做了以下实验。

1.  打开捕获设备。缓冲区不是静默的。
2.  使用 AudioDeviceRole::Communications 打开渲染设备。缓冲区立即静音。
3.  关闭渲染设备。缓冲区不是静默的。

然后我用 AudioDeviceRole::Communications 打开捕获设备，捕获设备一直工作正常。

对于 Windows 10 捕获设备始终有效，无论您是否使用 AudioDeviceRole::Communications 打开它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-27T11:59:04.350

我有同样的问题。似乎您既可以使用 only ，也可以`AudioCategory_Other`创建一个实例`VoipPhoneCall`and use only `AudioCategory_Communications`。

所以我的解决方案是使用`AudioCategory_Communications`并创建一个传出的`VoipPhoneCall`. [您应该像在Chatterbox VoIP 示例应用程序](http://code.msdn.microsoft.com/wpapps/ChatterBox-VoIP-sample-app-b1e63b8b)中那样实现后台代理`VoipCallCoordinator`才能正常工作。

# c# - C# 更新数据库

> ID：14796878
> 
> 赞同：0
> 
> 时间：2013-02-10T10:42:55.247
> 
> 标签：c#, database, sql-update

我正在使用这个字符串来更新数据库，在这种情况下，它工作正常。它`Znesek_nakupa`在最后一行更新：

```
string sqlUpd = "UPDATE Racun SET Znesek_nakupa='10' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun)"; 
```

但是，当我尝试插入变量而不仅仅是 10 时，它给了我错误：

> *将数据类型 varchar 转换为数字时出错。*

代码示例：

```
double totalPrice = 1.1;
string sqlUpd = "UPDATE Racun SET Znesek_nakupa='totalPrice' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun)"; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T10:45:58.037

这个问题与 SQL 关系不大，而与在 C# 中使用字符串和变量有关。

为了在 C# 中的字符串中插入变量的值，不能只将变量的名称放在字符串中。字符串不“知道”它包含一个变量。以下是一些可行的方法：

```
double totalPrice = 1.1;

// string concatenation
string sqlUpd =
    "UPDATE Racun SET Znesek_nakupa='" +
    totalPrice +
    "' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun)";

// with string.Format
string sqlUpd = string.Format(
    "UPDATE Racun SET Znesek_nakupa='{0}' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun)",
    totalPrice); 
```

然而，像这样在 SQL 查询中嵌入变量值的方法并不被认为是*最佳实践*，因为它存在 SQL 注入攻击的风险。通常你会想要使用[参数化的 SQL 查询](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)。

您的查询的参数化版本如下所示（从上面链接的页面中提取示例）：

```
SqlConnection conn = new SqlConnection(_connectionString);
conn.Open();
string s = "UPDATE Racun SET Znesek_nakupa='@totalPrice' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun";
SqlCommand cmd = new SqlCommand(s);
cmd.Parameters.Add("@totalPrice", totalPrice);
SqlDataReader reader = cmd.ExecuteReader(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T16:08:12.800

好，我知道了。当我尝试在数据库中保存变量 totalPrice 时出现错误，因为 C# 有逗号作为分隔符。在数据库中，我必须改为发送点。所以我简单地用点替换逗号，现在它完美无缺。

所以代码现在看起来像这样：

```
string sqlUpd = "UPDATE Racun SET Znesek_nakupa='" + Convert.ToString(totalPrice).Replace(',', '.') + "' WHERE Id_racun= (SELECT MAX(Id_racun) FROM Racun)"; 
```

# jquery - jQuery菜单不在页面之间切换

> ID：14796884
> 
> 赞同：0
> 
> 时间：2013-02-10T10:43:36.853
> 
> 标签：jquery, html

我在编写一些 jQuery 菜单时遇到问题，它似乎不允许我在我设置的“div 页面”之间切换。我已经上传了我在这里所做的[http://jsfiddle.net/UxNMT/](http://jsfiddle.net/UxNMT/)并且非常感谢任何对我做错了什么的洞察力。

**jQuery**

```
$(function () {
    $("#menu").menu();
});

$(document).ready(function () {
    $('#1').show();

    $("#1").click(function () {
        $('.content').hide();
        $('#1').show();
    });

    $("#2").click(function () {
        $('.content').hide();
        $('#2').show();
    });

    $("#3").click(function () {
        $('.content').hide();
        $('#3').show();
    });
}); 
```

**HTML**

```
<div style="width:150px; background-color: #EFEFEF; float:left;">
    <ul id="menu" style="border: 0px; background:none">
        <li><a id="1" style="cursor: pointer">1</a>

        </li>
        <li><a id="2" style="cursor: pointer">2</a>

        </li>
        <li><a id="3" style="cursor: pointer">3</a>

        </li>
    </ul>
</div>
<div style="float:right; width: 595px; text-align:left; font-family: Verdana; 
padding: 10px; ">
    <div id="1" style="display: none" class="content">1</div>
    <div id="2" style="display: none" class="content">2</div>
    <div id="3" style="display: none" class="content">3</div>
</div> 
```

# cakephp - 如何在 CakePHP 中累积过滤数据

> ID：14796889
> 
> 赞同：0
> 
> 时间：2013-02-10T10:43:57.290
> 
> 标签：cakephp

我对 CakePHP 和面向对象编程比较陌生。我以前在 CakePHP 中构建过应用程序，但从来没有达到这个程度，因此我寻求帮助的原因。

我有一个大型产品管理数据库，用户需要能够设置过滤条件以找到最接近的产品匹配项。

products 表包含与各个表相关的 category_id、manufacturer_id、type_id、status_id。

我有一个带有每个过滤器下拉框的侧边栏，并希望所有过滤器一起工作，例如，如果选择了制造商和产品类型，则显示这些过滤结果，并将状态和类别下拉列表更改为仅包含来自已经过滤的结果。

在过去，我通过使用基于用户输入的动态查询设置条件来实现这一点，每次应用过滤器时都附加 where 子句。

到目前为止，我只能使用单独过滤的结果

```
$this->Product->recursive = 0;
    $mid = (isset($this->params['named']['mid'])) ? $this->params['named']['mid'] : '';
    if(!empty($mid)){
        $this->paginate = array(
            'conditions' => array('Product.manufacturer_id' => $mid),
            'limit' => 10
        );
    }
    $products = $this->paginate('Product');
    $this->set(compact('products')); 
```

其中“mid”是制造商 ID，这是在 url 中手动输入“mid”

如果用户设置 category_id、manufacturer_id、type_id、status_id 或任何组合，我如何获得累积过滤结果？我将使用哪些查询来重新填充下拉列表？

（最终我将使用 ajax，但现在假设我有 4 个带有提交按钮的下拉框）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:21:50.577

漫长的道路将是：

```
var $conditions = array();

if (isset($this->params['named']['mid']) && !empty($this->params['named']['mid'])){
   $conditions['Product.manufacturer_id'] = $this->params['named']['mid']);
}
if (isset($this->params['named']['catid']) && !empty($this->params['named']['catid'])){
   $conditions['Product.category_id'] = $this->params['named']['catid']);
}
if (isset($this->params['named']['statid']) && !empty($this->params['named']['statid'])){
   $conditions['Product.status_id'] = $this->params['named']['statid']);
}

$this->paginate['conditions'] = $conditions;
$this->paginate['limit'] = '10';
$this->set('products', $this->paginate('Product')); 
```

一旦掌握了窍门，就可以将所有检查放入一个循环中。

# php - 使用 CakePHP 下载文件

> ID：14796891
> 
> 赞同：0
> 
> 时间：2013-02-10T10:44:08.190
> 
> 标签：php, cakephp, download

我正在使用 CakePDF 编写一个网络应用程序，但我在下载文件时遇到了困难。根据文档（[http://book.cakephp.org/2.0/en/controllers/request-response.html#sending-files](http://book.cakephp.org/2.0/en/controllers/request-response.html#sending-files)），它看起来很简单，我的代码实际上只是一个复制和粘贴工作：

```
public function download($request_id) {
    $filename = $this->getFilename($request_id);
    $file = $this->Attachment->getFile($filename);
    $this->response->file($file['path']);
    return $this->response; 
} 
```

不幸的是，这引发了一个错误：

```
Fatal error: Call to a member function getFile() on a non-object in C:\xampp\htdocs\quickanalyses\app\Controller\DocumentController.php on line 7 
```

我已经查看了文档，但它并没有说你需要做任何事情来获取附件参考，所以我无法弄清楚它为什么会失败。我也试过了`var $uses = array('Attachment')`，在控制器中但没有任何`var $components = array('Attachment')`帮助`var $helpers = array('Attachment')`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:55:00.400

现在觉得很傻。我没有下载最新版本的cake，而是修改了一个旧项目，所以我使用的是2.1.0而不是2.3，这意味着我需要使用媒体视图来代替

# java - 错误：解析 XML 时出错：android 标签不匹配

> ID：14796898
> 
> 赞同：0
> 
> 时间：2013-02-10T10:45:01.307
> 
> 标签：java, android, xml

该项目运行良好，然后突然出现此错误，尽管我没有添加或更改任何内容。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/AppName"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="18.15"
        android:textSize="20px" >

    </TextView> 
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:57:10.453

当我尝试这段代码时，它没有给出任何错误。尝试使用任何 IDE 提供的 clean 选项来清理项目。

# c# - 无法将 IQueryable 转换为 ObjectSet

> ID：14796900
> 
> 赞同：0
> 
> 时间：2013-02-10T10:45:12.223
> 
> 标签：c#, asp.net, asp.net-mvc, entity-framework

在我的 C# 类中，我有以下代码：

```
var myData= Db.SetName;
myData = myData.Where(p => p.Set2.Date >= start
                && p.Set2.Date <= end); 
```

哪个 Db 是我的 DbObject（或 DbContext）

但我收到以下错误：

```
Error:Cannot implicitly convert type 'System.Linq.IQueryable<SetName>' to 
'System.Data.Objects.ObjectSet<SetName>'. An explicit conversion exists 
(are you missing a cast?) 
```

哪里有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T19:04:12.410

这一行：

```
var myData = Db.SetName; 
```

创建并分配一个名为`myData`type的变量`ObjectSet<SetName>`。以下行：

```
myData = myData.Where(p => p.Set2.Date >= start && p.Set2.Date <= end); 
```

...尝试将类型的值分配给`IQueryable<SetName>`同一变量。尽管`ObjectSet<SetName>`implements `IQueryable<SetName>`，但您不能将后一种类型的值分配给前一种类型的变量，原因与您不能将 type 的值分配给 type`IAnimal`的变量相同`Dog`。

根本问题是（某种）使用`var`，因为这隐藏了错误的类型`myData`并掩盖了错误的原因。这应该有效：

```
IQueryable<SetName> myData = Db.SetName;
myData = myData.Where(p => p.Set2.Date >= start && p.Set2.Date <= end); 
```

...应该这样：

```
var myData = (IQueryable<SetName>)Db.SetName;
myData = myData.Where(p => p.Set2.Date >= start && p.Set2.Date <= end); 
```

...因为两者都明确声明`myData`了 type `IQueryable<SetName>`，因此以后可以分配给该类型的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T14:40:26.107

您隐式声明`myData`为一种类型，然后尝试将其值分配给另一种类型。改为这样做：

`var myData= Db.SetName.Where(p => p.Set2.Date >= start && p.Set2.Date <= end).AsQueryable();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T15:08:53.043

我不确定，因为我不在我的机器上，但你可以`.AsQueriable()`在之后追加`Where()`，你很高兴。

# joomla - Joomla 事件没有被触发

> ID：14796901
> 
> 赞同：0
> 
> 时间：2013-02-10T10:45:13.420
> 
> 标签：joomla

这是我的插件：

```
// no direct access
defined( '_JEXEC' ) or die( 'Restricted access' );

// Import library dependencies
jimport('joomla.plugin.plugin');

class plgContentEya extends JPlugin
{

 function plgContentEya( &$subject, $config )
 {
    parent::__construct( $subject, $config );

 }
/**
 * Plugin method with the same name as the event will be called automatically.
 */
 function onAfterDisplayContent( &$article, &$params, $limitstart)
 {//Echo script there
echo "script works";
        // Plugin code goes here.
        // You can access parameters via $this->params.
    return "<script src='http://widget.eya.com/sprk.1.0.2.js' type='text/javascript'></script>";
 }
}

http://docs.joomla.org/Plugin/Events/Content 
```

根据他们的文件

```
 Return Value
String. Returned value from this event will be displayed in a placeholder. Most templates display this placeholder after the article separator. 
```

当我安装它时，该插件会显示并且不会引发错误。但该事件永远不会被触发。我在文档中没有看到

```
<install version="2.5" type="plugin" group="content">
   <name>plg_content_eya</name>
   <author>eya</author>
   <creationDate>February 2013</creationDate>
   <copyright>(C) 2013 Open Source Matters. All rights reserved.</copyright>
   <license>GNU General Public License version 2 or later; see LICENSE.txt</license>
   <authorEmail>anattaligg@graeit.com</authorEmail>
   <authorUrl>www.eya.com</authorUrl>
   <version>2.5.0</version>
   <description>Adds eya plugin ot your site</description>
   <files>
     <filename plugin="eya">eya.php</filename>
   </files>

</install> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T22:41:50.110

根据`version="2.5"`您的 XML，您的插件没有被调用，因为您有错误的事件名称。

[自Joomla](http://docs.joomla.org/Plugin/Events/Content)的插件/事件/内容以来，事件名称已更改！[1.5](http://docs.joomla.org/Plugin/Events/Content)文件写好了。我已将其标记为 1.5 文档以说明这一点。

事件被重命名以更加一致（域/期间/事件，例如*Content/After/Display*），因此，您想要的事件现在被调用，您可以在文章“[将 Joomla 1.5 扩展适配到 Joomla](http://docs.joomla.org/Adapting_a_Joomla_1.5_extension_to_Joomla_1.6#Renamed_Events)`onContentAfterSave` ”中找到有关重命名事件的更多信息[1.6](http://docs.joomla.org/Adapting_a_Joomla_1.5_extension_to_Joomla_1.6#Renamed_Events) "

如果你想支持 Joomla！1.5 在您的插件中，您还必须添加一个兼容层来捕获 2.5 调用并将其重定向到您的方法。例如

```
// Catch 2.5
public function onContentAfterDisplay($article, $params, $limitstart)
{
    $result = $this->onAfterDisplayContent($article, $params, $limitstart);
    return $result;
} 
```

*注意 刚刚输入的未经测试的代码...*

# c# - 使用家长控制手柄禁用默认哔声

> ID：14796903
> 
> 赞同：1
> 
> 时间：2013-02-10T10:45:25.840
> 
> 标签：c#, winforms, winapi

我对自定义 winforms 控件有一个烦人的问题。

我使用一个标准的空 UserControl，它由一个自定义表单托管。

当我按任意键时，Windows 默认蜂鸣声触发。

我覆盖了 KeyDown/KeyPress，但似乎在我的控件接收到事件之前发生了哔哔声。

创建控件的代码非常简单：

```
 public class GUITemplateTestNode : UserControl, IPluginEvaluate
{
    public GUITemplateTestNode()
    {
        //setup the gui
        InitializeComponent();
    }

    void InitializeComponent()
    {

    }

    public void Evaluate(int SpreadMax)
    {

    }
} 
```

我无权访问表单代码，因为它托管在另一个应用程序（Delphi）中，但我可以访问主表单句柄。

如果我创建一个简单的独立（纯 winforms）应用程序，则不会出现哔声。

有没有办法使用这个父表单 HWND 来禁用哔哔声？

# php - 访问php中嵌套循环中每个循环的父级

> ID：14796905
> 
> 赞同：0
> 
> 时间：2013-02-10T10:45:47.347
> 
> 标签：php, loops

我有一个使用循环运行的数组，代码如下：

```
foreach($arry as $parentkey => $parentvalue){
  $secondloop = explode(",",$parentvalue);
  foreach($secondloop as $childvalue){
    echo $parentkey.' '.$childvalue ;
  }
} 
```

当我运行它时，它不显示父键。php不支持那种循环吗？如何让它显示父键？遍历循环以获得所需结果的最佳方法是什么？

原始数组

```
 Array ( [1] => 2,3,10,11,27,28,35,36,165,37,38,40,41,42,43,44,46,49,50,61,62,65,66,75,67,71,69,72,73,74,76,96,90,91,97,107,118,147,119,122,139,142,148,149,168,169,170,171,172,173,174,181 [2] => 39,102,94,98,92,121 [3] => 45,77,117,103,109,99 [4] => 47,78,146,105,113,115,104 [5] => 48,79,106,114,120,110 [6] => 68,93,116,111,112 [7] => 140,150 [8] => 141,151 [9] => 143,144,166,153 [10] => 145,154,159 [11] => 157,155 [12] => 158,156 [13] => 160 [14] => 161 [15] => 162 [16] => 163 [17] => 164 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:10:18.760

鉴于给出的信息，您的代码可以工作，请参阅以下清理示例。

```
<?php

$arry = array(
    1 => '2,3,10,11,27,28,35,36,165,37,38,40,41,42,43,44,46,49,50,61,62,65,66,75,67,71,69,72,73,74,76,96,90,91,97,107,118,147,119,122,139,142,148,149,168,169,170,171,17$
    2 => '39,102,94,98,92,121',
    3 => '45,77,117,103,109,99',
    4 => '47,78,146,105,113,115,104',
    5 => '48,79,106,114,120,110',
    6 => '68,93,116,111,112',
    7 => '140,150',
    8 => '141,151',
    9 => '143,144,166,153',
    10 => '145,154,159',
    11 => '157,155',
    12 => '158,156',
    13 => '160',
    14 => '161',
    15 => '162',
    16 => '163',
    17 => '164'
);

foreach($arry as $parentkey => $parentvalue){
        $secondloop = explode(",",$parentvalue);
        foreach($secondloop as $childvalue){
                echo 'Parent key: ' . $parentkey . ', child value: ' . $childvalue . PHP_EOL;
        }
} 
```

# python - 返回包含指定扩展名的目录列表

> ID：14796909
> 
> 赞同：0
> 
> 时间：2013-02-10T10:46:26.023
> 
> 标签：python

我想获取包含 mp3 的当前目录下的目录列表。

我可以很容易地使用`os.walk`. 我可以很容易地使用 获得完整路径`os.path.join(os.path.abspath(root), file)`，但我只想要一个包含匹配目录的列表。我试过使用`os.path.dirname`and `os.path.pardir`，但我得到的只是`'..'`.

```
import os
l = []
for root, dirs, files in os.walk('.'):
    for file in files:
         if file.endswith('.mp3'):
             l.append(os.path.dirname(file)) 
```

我可能遗漏了一些明显的东西？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:49:13.827

`root`已经在每个循环中为您提供了目录名称；只需将其设为绝对并添加到`l`列表中即可。然后移动到下一个目录（一个匹配就足够了）：

```
import os
l = []
for root, dirs, files in os.walk('.'):
    if any(file.endswith('.mp3') for file in files):
        l.append(os.path.abspath(root)) 
```

`any()``True`一旦找到包含的可迭代对象中的第一个元素，即返回`True`；所以第*一个*以结尾的文件`.mp3`将导致`any()`返回 True 并且当前目录被添加到匹配列表中。

# json - 使用表单或表示更新 RESTful API 中的资源

> ID：14796912
> 
> 赞同：1
> 
> 时间：2013-02-10T10:46:32.623
> 
> 标签：json, rest, xhtml

我看到了许多在 RESTful API 中使用 XHTML 以通过 OAuth 或 OpenID 进行授权的示例。虽然这看起来很自然，但我问自己**是否还有其他优势，提交表单比 POST/PUT 资源表示更好**？我最感兴趣的是机器对机器的交互，然后是人机交互。

如果我理解得很好，其中一个方面是内容协商，其中 XHTML 表单是否可以返回给客户端（因为默认情况下 JSON 和 XML 不支持表单）取决于`Accept`请求中的标头。

假设我们有一个简单的场景，`Item`可以将资源添加到`Cart`资源中。API 仅支持 JSON 和 XML。我通常做的是我希望客户端对资源`POST`进行`Item`资源表示`Cart`，这很好用。但是客户端应该知道语义并且需要准确地知道`Item`资源表示的结构，否则它将遇到错误 400（错误请求）。

然后我认为使用表单会更容易**，因为它们为**客户提供了一些关于将内容发布到`Cart`. 但是还有一个问题，因为例如 XHTML 支持 OOTB，但 JSON 或 XML 不支持（除非使用 Collection-JSON 等）。然后，我可以提供一些自定义实现以支持 JSON 和 XML 中的表单，但这需要客户端理解语义，并且**使用表单而不是发布资源表示没有任何好处**。

**问题：** 您能否澄清一下是否存在应该使用表单的场景，或者这种用法比发布资源表示更可取？有官方指导吗？

**问题 2：** 您是否会费心使用 XHTML 格式的表单，其中 API 和客户端之间的所有通信大多使用 JSON 或 XML，或者您是否会修改 XML/JSON 以包含自定义表单？

也许我错过了一些东西，所以不要犹豫，让我走上正确的轨道:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-02T09:23:27.013

如果您想将商品添加到购物车，有 2 个选项。

1\. 购物车是 REST 客户端状态的一部分，因此您不要将该信息存储在 REST 服务中。在这种情况下，您可以将项目和金额存储在客户端、cookie 或服务器端 REST 客户端中，这并不重要。您应该存储项目的 url、项目的 id 和数量，也许还有价格......所有这些都来自 REST 服务......

2.购物车存储在REST服务中，所以它是一种资源，任何改变都会影响服务的资源状态。在这种情况下，您可以创建一个带有`POST /carts`请求的购物车，之后您将获得一个唯一的购物车 ID：

```
201
{
    id: 123,
    _links: {
        self: {href: "/carts/123"}
    }
} 
```

您的客户必须记住这一点，因此，如果您通过目录获得链接模板，例如`/items?search=@keywords&cart=@cart.id`，您可以在其上填写购物车 ID...

通过浏览目录，您可以通过以下方式获取项目：`GET /items?search="red pullover"&cart=123`。之后，您将获得`add-cart`任何项目的链接：

```
{
    id: 567,
    name: "red pullover",
    _links: {
        "add-cart": {
            href: "/cart-items",
            fields: {
                cart: {type: "hidden", value: 123},
                item: {type: "hidden", value: 567},
                amount: {type: "select", value: 1, min: 1, max: 10}
            }
        }
    }
} 
```

`session.cart.id`如果客户端中存在该链接，您可以从该链接创建一个表单和一个按钮。如果没有，那么您可以忽略该链接。如果您在生成的表单中按下按钮，它将向服务发送如下内容：

```
POST /cart-items
{
    cart: 123,
    item: 567,
    amount: 1
}

201
{
    id: 22222,
    _links: {
        self: {href: "/cart-items/22222"}
    }
} 
```

因此，如果您希望您的服务保持 RESTful，您的客户端绝不能生成链接。它总是从服务中获取链接。该服务从不存储客户端状态，客户端状态始终以 queryString 或 postData ...

您可以将 HTML 格式的响应发送到您的 REST 客户端，REST 客户端决定如何处理响应以及如何显示它。最好以数据格式发送响应，例如 HAL+JSON 或 JSON-LD 或 ATOM+XML，因为它们已经存在序列化器和反序列化器。HTML 没有序列化器/反序列化器，只有一个慢速解析器，所以如果你使用 HTML，你必须自己编写那部分代码。

您可以使用 HAL+JSON 找到您自己的表单表示，或者您可以使用现有的模式。JSON-LD 和 ATOM+XML 和 HAL+HTML 可以绑定到现有的 RDF 模式，或者可能绑定到微格式，所以也许有一个关于如何描述表单的模式。您可以浏览已经存在的模式，例如在[schema.org](http://schema.org/)上，或者您可以在这里找到已经存在的链接关系：[link-relations](http://www.iana.org/assignments/link-relations/link-relations.xhtml)。几乎所有事情都有许多其他解决方案，不仅仅是关于显示表单，还有关于表示数据。您可以通过关键字找到更多信息：链接数据、链接开放数据等...

# c# - 未使用 Visual C# 2010 使用 SQL 命令将数据插入数据库

> ID：14796915
> 
> 赞同：-5
> 
> 时间：2013-02-10T10:46:50.830
> 
> 标签：c#, sql, sql-server, connection

```
private void button1_Click(object sender, EventArgs e)
{
        SqlConnection con = new SqlConnection();

        con.ConnectionString = @"Data Source=YUVV-PC\SQLEXPRESS;Initial Catalog=barcode;Integrated Security=True";
        con.Open();

        //MessageBox.Show("connection open");

        SqlDataAdapter ada = new SqlDataAdapter();
        //ada.SelectCommand = new SqlCommand("select * from barcode", con);
        ada.MissingSchemaAction = MissingSchemaAction.AddWithKey;
        ada.InsertCommand = new SqlCommand("INSERT INTO barcode (bcd) " +
    "VALUES (@bcd)", con);
        ada.InsertCommand.Parameters.Add("@bcd", SqlDbType.NChar, 20,"bcd").Value = textBox1.Text;
        ada.SelectCommand = new SqlCommand("select bcd from barcode", con);

        DataSet ds = new DataSet();
        ada.Fill(ds, "barcode");
        dataGridView1.DataSource = ds.Tables[0].DefaultView;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:51:33.397

您有 2 个选项来修改您的代码，如下（在 之后`con.Open()`）：

```
ada.InsertCommand.Parameters.Add("@bcd", SqlDbType.NChar, 20,"bcd").Value = textBox1.Text;
//add this line
//without it you are never executing your `InsertCommand`.
ada.InsertCommand.ExecuteNonQuery();

ada.SelectCommand = new SqlCommand("select bcd from barcode", con);
... 
```

或者，您可以使用`SqlCommand`这样的：

```
using (var cmd = new SqlCommand("INSERT INTO barcode (bcd) VALUES (@bcd)", con))
{
    cmd.CommandType = CommandType.Text;
    cmd.Parameters.Add("@bcd", SqlDbType.NChar, 20,"bcd").Value = textBox1.Text;
    cmd.ExecuteNonQuery();
}

SqlDataAdapter ada = new SqlDataAdapter();
//ada.SelectCommand = new SqlCommand("select * from barcode", con);
ada.MissingSchemaAction = MissingSchemaAction.AddWithKey;

ada.SelectCommand = new SqlCommand("select bcd from barcode", con);

DataSet ds = new DataSet();
ada.Fill(ds, "barcode");
dataGridView1.DataSource = ds.Tables[0].DefaultView; 
```

我还建议在您的和实例`using`周围使用语句，以确保正确处理所有资源。`SqlConnection``SqlDataAdapter`

# javascript - AngularJS，ng-switch 如果未包装到 div 中将失败：无法设置未定义的属性“nodeValue”

> ID：14796919
> 
> 赞同：2
> 
> 时间：2013-02-10T10:47:56.053
> 
> 标签：javascript, angularjs, angularjs-directive

我有两个指令：

```
app.directive('uiElement', function () {
  return {
    restrict: 'A',
    replace: true,
    scope: {element: "=uiElement", search: "=search"},
    templateUrl: "/views/uiElement.html",
    link: function (scope, elem, attrs) {
      scope.isImage = function () {
        return (scope.element.type === 'image/png' || scope.element.type === 'image/jpeg');
      };
      scope.isList = function () {
        return (scope.element.type === 'text/list');
      };
      scope.isTodo = function () {
        return (scope.element.type === 'text/todo');
      };
    }
  };
}); 
```

以及相关的模板：

```
<article class="uiElement" ng-class="{typeImage: isImage(), typeList:isList(), typeTodo:isTodo()}" ng-switch on="element.type">
  <div><div class="inside" ng-switch-when="image/png">
    <i ui-image="element"></i>
  </div></div>
  <div><div class="inside" ng-switch-when="image/jpeg">
    <i ui-image="element"></i>
  </div></div>
  <div><div class="inside" ng-switch-default>{{element.name}}</div></div>
</article> 
```

如您所见，每个`ng-switch-when`都有：

```
<div><div class="inside" ng-switch-default>{{element.name}}</div></div> 
```

双 div，我认为这是不好的模板。但是，如果我删除 div：

```
<article class="uiElement" ng-class="{typeImage: isImage(), typeList:isList(), typeTodo:isTodo()}" ng-switch on="element.type">
  <div class="inside" ng-switch-when="image/png">
    <i ui-image="element"></i>
  </div>
  <div class="inside" ng-switch-when="image/jpeg">
    <i ui-image="element"></i>
  </div>
  <div class="inside" ng-switch-default>{{element.name}}</div>
</article> 
```

**更新：**我收到此错误：

```
TypeError: Cannot set property 'nodeValue' of undefined
    at Object.<anonymous> (http://127.0.0.1:3003/js/angular.min.js:47:448)
    at Object.applyFunction [as fn] (http://127.0.0.1:3003/bubble/5116f5a9cfbecf42ad000006:440:50)
    at Object.e.$digest (http://127.0.0.1:3003/js/angular.min.js:84:307)
    at Object.e.$apply (http://127.0.0.1:3003/js/angular.min.js:86:376)
    at Object.$delegate.__proto__.$apply (http://127.0.0.1:3003/bubble/5116f5a9cfbecf42ad000006:500:30)
    at e (http://127.0.0.1:3003/js/angular.min.js:92:400)
    at n (http://127.0.0.1:3003/js/angular.min.js:95:472)
    at XMLHttpRequest.q.onreadystatechange (http://127.0.0.1:3003/js/angular.min.js:96:380) 
```

但是，如果我直接在 html 页面中使用没有 div 的模板代码（不使用指令，它可以工作）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-09-05T13:48:35.947

我有同样的问题。

我在指令模板中使用了一个 JQuery 组件，我在控制器中像这样初始化它：

```
$element.find('.crappy-component-target').crappyComponent(); 
```

原来这个组件/库搞砸了 Angular。这个问题有两种解决方案：

1.  将组件初始化代码移动到指令的链接函数中。
2.  `.crappy-component-target`将元素包裹在`<div>`元素中。

以上任何一个都解决了我的问题。我想这是很多情况，其中蹩脚的 JQuery 样式组件不适合 Angular。而且大多数时候是 Angular 承担了责任……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-13T19:07:04.753

我有同样的错误信息。代码是这样的：

```
<div><div class="foo">Some element</div></div>
<div class="bar">{{String I'm trying to add to previously working div}}</div> 
```

我将我正在编辑的 div 移到了双 div 元素上方（这些的顺序无关紧要）并且效果很好。不确定到底是什么问题，但嵌套 div 似乎是一个因素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-08T01:23:31.030

我也有类似的问题。我不知道为什么，但删除`replace: true`（将其设置为 false）指令可以解决这个问题。

也许我应该提出这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-09T16:13:17.533

我有同样的问题

```
 <select ng-model="approvals.TimeFilterSelected"
                ng-options="item.name for item in approvals.TimeFilterSelect"></select>

        <p>Selected: {{approvals.TimeFilterSelected || 'None'}}</p> 
```

如果该代码位于嵌套 div 中，该 div 在包含 ng-controller 的 div 之后的某些级别 - 它不起作用。在控制器 div 之后移动它可以正常工作。如果我们想保持 html 的相同结构，在这些情况下应该怎么做？！！那可能是Angular错误吗？我没有看到我的 HTML 格式有任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-18T03:07:18.910

我遇到了同样的问题，但错误略有不同：

```
TypeError：无法读取未定义的属性“childNodes”
    在 CompositeLinkFn (angular.js:3841:35)
    在 nodeLinkFn (angular.js:4217:24)
    在 CompositeLinkFn (angular.js:3827:14)
    在 nodeLinkFn (angular.js:4217:24)
    在 angular.js:4358:15
    在 nodeLinkFn (angular.js:4217:24)
    在 angular.js:4357:13
    在 angular.js:8625:11
    在 WrappedCallback (angular.js:6586:59)
    在 angular.js:6623:26

```

这是 AngularJS v1.0.1

我还可以确认将我的 ng-switch-when 与另一个一起解决了这个问题。但是很高兴知道它为什么会发生以及如何避免它。

# wordpress - 如何让 Wordpress TwentyTwelve comments.php 在另一个主题上工作？

> ID：14796920
> 
> 赞同：0
> 
> 时间：2013-02-10T10:48:04.223
> 
> 标签：wordpress, themes, wordpress-theming

目前，我正在使用基于[Foundation](https://github.com/drewsymo/Foundation)构建的 Wordpress 主题。但是，该主题没有自己的`comment.php`文件，并且目前正在使用即将`comments.php`从`wordpress\wp-includes\theme-compat`文件夹中弃用的主题。

所以我所做的是将`comments.php`TwentyTwelve 主题文件夹中的最新文件复制/粘贴到我当前的主题文件夹中。但是，这会导致错误：

```
Warning: call_user_func() expects parameter 1 to be a valid callback, function 'twentytwelve_comment' not found or invalid function name in C:\xampp\htdocs\wordpress\wp-includes\comment-template.php on line 1334 
```

...因为它没有正确接线。我应该怎么做才能`comments.php`正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:35:29.537

TwentyTwelve 使用它自己的函数来格式化评论—— [`twentytwelve_comment`](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-content/themes/twentytwelve/functions.php#L269). 在你复制的文件中`comments.php`——你应该看到这一行：

```
<?php wp_list_comments( array( 'callback' => 'twentytwelve_comment', 'style' => 'ol' ) ); ?> 
```

该回调是针对您的主题中不存在的函数的，因为它是在 TwentyTwelve 中定义的`functions.php`，而不是您的。你可以...

*   移除回调——这部分`'callback' => 'twentytwelve_comment',`。它是可选的。WordPress 将使用一个默认的格式化函数[——](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/comment-template.php#L1328)[实际上是`method`一个`Walker_comment`](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/comment-template.php#L1328). 它有点难找。:)
*   将 TwentyTwelve 的回调函数复制到您的主题；不要做任何事情来掩饰你得到它的地方
*   创建自己的回调

# java - 如何将 javadoc 链接到私有字段？

> ID：14796921
> 
> 赞同：105
> 
> 时间：2013-02-10T10:48:29.907
> 
> 标签：java, javadoc

如何将 javadoc 链接到私有字段？

```
class Foo {
  private String bar;
  public String getBar() { return bar; }
} 
```

`{@link Foo#getBar()}`作品。

`{@link Foo#bar}`没有。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-02-10T11:15:33.587

语法很好，以下两个都在一个类中工作（并且没有理由链接到来自不同类的私有字段）：

```
public class Demo {
  private int num = 0;
  /**
  * Access field {@link Demo#num} / {@link #num}  ...
  */
  private void foo() { ... }
... 
```

在生成 javadoc 时，例如，通过 ant，只需指定应包含私有字段（默认的最小访问权限是“受保护”，而不是“私有”）：

```
<target name="javadoc" depends="compile" description="gen javadoc">
  <javadoc destdir="build/docs"
           author="true"
           version="true"
           use="true"
           access="private"
           windowtitle="Demo API">

    <fileset dir="src/main" defaultexcludes="yes">
      <include name="com/**"/>
    </fileset>

    <doctitle><![CDATA[<h1>Test</h1>]]></doctitle>
    <link offline="true" href="http://download.oracle.com/javase/6/docs/api/" packagelistLoc="doc"/>
  </javadoc>
</target> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-10T10:54:53.953

我认为你在评论中写的很好，你只需要告诉 JavaDoc 在文档中也包含私有字段。JavaDoc 为此提供了一个选项 -private。检查[这个答案](https://stackoverflow.com/questions/3101339/java-javadoc-include-private)。

# sql - SQL 加入后消除一个结果

> ID：14796930
> 
> 赞同：1
> 
> 时间：2013-02-10T10:49:47.403
> 
> 标签：sql, join, sql-server-2008-r2, duplicates

我在加入表格时遇到一个常见问题，每个条件我得到两个结果，我需要消除一个。

例如，我现在正试图找出我拥有的产品代码的库存以及是否有任何订单以及到期时间。我只想查看每个产品代码一次，并且在我刚刚展示时它工作正常订购的数量，但现在我想要我必须做左连接的截止日期。现在我得到每个产品代码的两个结果。我得到一个显示它有什么库存，另一个显示有什么东西在订购以及何时到期。我只想查看库存，如果没有订单，如果有订单，库存和订单作为一条线，而不是两者分开。

```
DECLARE @cat VARCHAR(150) 

SET @cat = 'crumb' --Put your search string in the single speech marks 
SELECT category_treeview_node.ctn_description               AS 
       [Product Category], 
       variant_detail.vad_variant_code                      AS [Variant Code], 
       variant_detail.vad_description                       AS 
       [Variant Description], 
       Sum(variant_transaction_header.vth_current_quantity) AS [Physical Stock], 
       variant_stock_quantity.vasq_free_stock_quantity      AS [Free Stock], 
       variant_stock_location.vsl_stock_on_purchase_order   AS [Stock on order], 
       purchase_order_header.poh_required_date              AS [Due Date] 
FROM   variant_stock_quantity 
       INNER JOIN (variant_detail 
                   INNER JOIN variant_category 
                           ON variant_detail.vad_id = 
                              variant_category.vac_vad_id 
                   INNER JOIN category_treeview_node 
                           ON category_treeview_node.ctn_id = 
                              variant_category.vac_ctn_id) 
               ON variant_stock_quantity.vasq_vad_id = variant_detail.vad_id 
       INNER JOIN variant_stock_location 
               ON variant_detail.vad_id = variant_stock_location.vsl_vad_id 
       LEFT JOIN (variant_transaction_header_total 
                  INNER JOIN variant_transaction_header 
                          ON variant_transaction_header_total.vtht_vth_id = 
                             variant_transaction_header.vth_id) 
              ON variant_detail.vad_id = variant_transaction_header.vth_vad_id 
       LEFT JOIN purchase_order_line 
              ON purchase_order_line.pol_id = 
                 variant_transaction_header.vth_pol_id 
                 AND variant_detail.vad_id = purchase_order_line.pol_vad_id 
       LEFT JOIN purchase_order_header 
              ON purchase_order_header.poh_id = purchase_order_line.pol_poh_id 
WHERE  category_treeview_node.ctn_description = @cat 
GROUP  BY category_treeview_node.ctn_description, 
          variant_detail.vad_variant_code, 
          variant_detail.vad_description, 
          variant_stock_quantity.vasq_free_stock_quantity, 
          variant_stock_location.vsl_stock_on_purchase_order, 
          purchase_order_header.poh_required_date 
HAVING variant_stock_quantity.vasq_free_stock_quantity >= 0 
```

我得到一个结果，它显示了实物库存、免费库存、订单中的内容和到期日期为空，然后一个结果显示没有实物库存、免费库存、订单中的内容和到期日。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:00:20.497

I'm not sure I completely understand the question. But in general, you don't want to use SQL to do what you're describing. Use SQL to return the data (like your query does now), and use a report writer to hide repeating values, summarize data in headers and footers, etc.

It's a simple division of labor. SQL returns the data; report writers (or their equivalent) handle the presentation and layout.

# android - WebViewCore 内部线程中的 StatFs 中的 IllegalArgumentException

> ID：14796931
> 
> 赞同：10
> 
> 时间：2013-02-10T10:49:53.500
> 
> 标签：android, multithreading, exception

Google play 在某些设备上报告了一个异常（都是“其他”和一个“LG-E400”，所以它可能是一些自定义的 android 版本）

例外是：

```
java.lang.IllegalArgumentException
at android.os.StatFs.native_setup(Native Method)
at android.os.StatFs.<init>(StatFs.java:32)
at android.webkit.CacheManager.init(CacheManager.java:199)
at android.webkit.BrowserFrame.<init>(BrowserFrame.java:210)
at android.webkit.WebViewCore.initialize(WebViewCore.java:201)
at android.webkit.WebViewCore.access$500(WebViewCore.java:54)
at android.webkit.WebViewCore$WebCoreThread$1.handleMessage(WebViewCore.java:631)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:653)
at java.lang.Thread.run(Thread.java:1019) 
```

问题是我不能忽略这个异常，因为它在单独的线程中。这个问题有什么解决办法吗？或者我能用它做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T09:54:17.833

很可能是设备操作系统错误。我对 AudioRecord 库有很多问题 - 它在 Yusu、Micromax、Alcatel 和其他低档设备等许多设备上的本地初始化中也失败了。它们在 GooglePlay 报告中都显示为“其他”。此外，我还发现一些[Cyanogenmod](http://www.cyanogenmod.org/) ROM 在 AudioRecord 中存在错误 - 在我的 HTC One V 上它工作正常，直到我刷新 CM10。了解确切的设备型号、logcats、mem 和其他有关这些设备上发生的情况的信息的一种好方法是使用一些高级崩溃报告工具，如[ACRA](http://acra.ch/) 在我收到报告说设备的制造商固件肯定有问题后，我将其列入黑名单它在 GooglePlay 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T14:11:28.837

您在 Statfs 构造函数中提供的路径不存在

```
 String path = "path to some directory";
StatFs statFs = null;
statFs = new StatFs(path); 
```

并且您必须在清单文件中具有外部存储权限

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-21T09:21:28.850

看起来某些固件与 StatFs 有问题

我对 Samsung Galaxy Stratosphere™ II (Verizon) SCH-I415, Android:4.1.2 有类似的问题当我打电话时：

```
 StatFs statFs = null;
 statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath()); 
```

我有例外：

```
 java.lang.IllegalArgumentException
 at android.os.StatFs.native_setup(Native Method)
 at android.os.StatFs.<init>(StatFs.java:32) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-14T08:20:17.220

我有类似的问题，我的日志看起来像

```
03-14 13:41:55.715: E/PayPalService(14037): Risk component failed to initialize, threw null
03-14 13:41:56.295: E/(14037): statfs /storage/sdcard0 failed, errno: 13
03-14 13:41:56.365: E/AndroidRuntime(14037): FATAL EXCEPTION: Thread-1219
03-14 13:41:56.365: E/AndroidRuntime(14037): java.lang.IllegalArgumentException
03-14 13:41:56.365: E/AndroidRuntime(14037): at android.os.StatFs.native_setup(Native Method)
03-14 13:41:56.365: E/AndroidRuntime(14037): at android.os.StatFs.<init>(StatFs.java:32) 
```

我通过查看前两行发现了与 sd 卡相关的问题。然后我检查了设备设置，发现我已经检查了他们的选项**应用程序必须有权读取 sd 卡**，而我正在安装的应用程序没有**READ SD CARD**权限显现。所以可能这些事情是相关的，对我来说可能的解决方案要么在清单中添加许可，要么取消选中该选项。希望它有助于进一步的研究。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-14T10:38:27.700

从 Lollipop 开始，Android 对访问外部 SD 卡设置了相当严格的限制。您可以使用：

```
 StatFs stat;
    try {
        stat = new StatFs(path);
    } catch (IllegalArgumentException e) {
        // Handle the failure gracefully or just throw(e)
    } 
```

解决该错误。

对于我的应用程序，我只是跳过不可用的目录，基本上将用户限制在内部存储中。这不是一个理想的解决方案，但不会崩溃的有限应用程序比崩溃的应用程序要好。

# javascript - JavaScript 正则表达式：匹配和识别替代分隔符并捕获周围的文本

> ID：14796934
> 
> 赞同：0
> 
> 时间：2013-02-10T10:50:10.047
> 
> 标签：javascript, regex, match, capture, delimiter

假设以下任何字符串都可以使用##, ?? 和 :: 是分隔符...

```
test1 = 'Foo##Bar'
test2 = 'Foo Bar??Baz Mumbe'
test3 = 'SomeFoo::Some Bar'
test4 = 'Foo Bar Baz' 
```

现在，我想...

1.  知道##, ?? 或 :: 匹配，如果匹配，是哪一个
2.  捕获分隔符之前和之后的任何内容

字符串操作有效，但看起来太复杂了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:55:57.513

好的，我想我实际上有点能够构建 RegExp ......

```
var reg = /(.*)(\#\#|::|\?\?)(.*)/g; 
```

# 例子

现在，使用 RexExp 的 exec 函数，我得到...

```
var match = reg.exec('foo bar##baz mumble'); 
```

=>`match = ["foo bar##baz mumble", "foo bar", "##", "baz mumble"];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:59:53.687

你可以使用类似的东西

```
var m,
    before,
    after,
    delimiter,
    test = 'Foo##Bar';

if ( m = test.match( /^(.*?)(##|\?\?|::)(.*)$/ ) ) {
    before = m[1];
    delimiter = m[2];        
    after = m[3];
} 
```

分隔符将是先出现的`##`，`??`或`::`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T11:01:23.550

```
test1 = 'Foo##Bar'
test2 = 'Foo Bar??Baz Mumbe'
test3 = 'SomeFoo::Some Bar'
test4 = 'Foo Bar Baz'

function match(s){
    if(typeof s === "undefined") return "";
    var res = /(.*)(##|\?\?|::)(.*)/g.exec(s);
    return res;
}

console.log(match(test2)[1]); // before the delimiter
console.log(match(test2)[3]); // after the delimiter 
```

# javascript - 如何检测 CSS 动画何时以 JavaScript 开始和结束？

> ID：14796936
> 
> 赞同：25
> 
> 时间：2013-02-10T10:50:37.940
> 
> 标签：javascript, css, animation

我习惯于使用 JavaScript 为元素制作动画。我发现使用 CSS3 更简单。

使用 JavaScript 如何检测 CSS 动画何时开始以及何时结束？有什么办法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-10T10:57:17.017

将适当的事件绑定到元素，例如

```
el.addEventListener("animationstart", function() {}, false);
el.addEventListener("animationend", function() {}, false);
el.addEventListener("animationiteration", function() {}, false); 
```

[https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_animations#Using_animation_events](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_animations#Using_animation_events)

注意：您可能还需要添加适当的前缀事件，例如`webkitAnimationEnd`

# asp.net-mvc - 如何组合 2 个 Linq 谓词 -C#

> ID：14796944
> 
> 赞同：1
> 
> 时间：2013-02-10T10:51:34.217
> 
> 标签：asp.net-mvc, linq, linq-to-sql

我有以下功能

```
public virtual ICollection<T> initData<T>(System.Data.Entity.DbSet<T> set, System.Linq.Expressions.Expression<Func<T, bool>> filter) where T : CModel<T>
        {
            var x = (from dc in set select dc);
            if (!this.db.valid)
            {
                System.Linq.Expressions.Expression<Func<T, bool>> active = a => a.active;
                filter = (Expression<Func<T, bool>>)Expression.Lambda(Expression.AndAlso(filter, active));
                x.Where(filter);

            }
            else
            {
                x.Where(filter);
            }
            return (ICollection<T>)x.ToList();
        } 
```

每当我尝试将 2 个谓词与`AndAlso`i 结合时都会引发异常：

```
The binary operator AndAlso is not defined for the types 'System.Func`2[namespace.Models.MyClass,System.Boolean]' and 'System.Func`2[namespace.Models.MyClass,System.Boolean]'. 
```

我怎样才能结合这两个条件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:09:41.730

我认为你让自己的生活变得艰难。您可以像这样多次使用 Where 扩展方法：

```
public virtual ICollection<T> initData<T>(System.Data.Entity.DbSet<T> set, System.Linq.Expressions.Expression<Func<T, bool>> filter) where T : CModel<T>
{
    var x = (from dc in set select dc);
    x = set.Where(filter);

    if (!this.db.valid)
    {
        x = x.Where(a => a.active);
    }

    return x.ToList();
} 
```

请注意，在您使用的代码中，`x.Where(filter);`
这是没用的，因为 Where 不会改变 x，所以结果基本上被丢弃了。要保留结果，您需要将其分配给某些东西： `x = x.Where(filter);`.
这与使用字符串时的想法相同。

**第二个答案：**

有一个内置的委托，称为`Predicate<T>`. 我认为使用这种类型可能比使用 更幸运`Func<T, bool>`，即使它们本质上具有相同的含义。我认为这就是编译器错误想要表达的意思。

# c++ - 不能将静态类转换为整数

> ID：14796946
> 
> 赞同：-7
> 
> 时间：2013-02-10T10:52:08.710
> 
> 标签：c++, static-cast

为什么当我尝试将 element* 静态转换为 int 时出现错误

```
typedef Element* ElementPtr

int Element::getVP (ElementPtr item)
{
return static_cast <int>(item); // I have a class called Element
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T10:58:54.267

不太确定你的问题是什么，但我觉得你想要隐式转换功能。要转换`Element`为 int，您需要`operator int()`

```
struct Element
{
  operator int()
  {
    return i;
  }
  int i;
};

int Element::getVP (Element* item)
{
  return (*item); // I have a class called Element
} 
```

但是仍然不清楚为什么需要`getVP`在 Element 类中。

它只是为了向您展示如何将 struct/class 转换为 int 类型。如果不是你想要的，我会删除我的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T11:03:32.923

假设您正在尝试`int`从 Element 获取 a 并且您已经重载了`Element`该类的强制转换运算符，如下所示：

```
operator int() { return m_some_int; } 
```

你可以使用（假设项目是一个指针）

```
return (int)(*item); 
```

相反，如果您尝试获取指针的地址，您可以执行以下操作：

```
std::size_t Element::get_address(Element* item)
{
    return reinterpret_cast<std::size_t>(item);
} 
```

# ruby-on-rails - ActiveRecord 上的 Ruby on Rails chaning 方法不起作用？

> ID：14796949
> 
> 赞同：0
> 
> 时间：2013-02-10T10:52:25.323
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我得到了这段代码，当我尝试使用第二种更优雅的方法时，我得到了“缺失方法”。我认为位于[http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)的文档没有帮助或不完整。有任何想法吗？

顺便说一句，请随时帮助为此编写一个更加“单行”的优雅方法:)

```
 def index
@sortby = params[:sort_by]

# THIS WORKS

#if @sortby == nil
#  @movies = Movie.all
#else
#  @movies = Movie.order(@sortby)
#end

# THIS DOESNT. WHY? I THOUGHT METHOD CHAINING AND LAZYLOAD WOULD WORK.
@movies = Movie.all
@movies = @movies.order(@sortby) unless @sortby == nil 
```

结尾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:02:34.810

您可以在一行中完成此操作。

```
@movies = params[:sort_by].nil? ? Movie.all : Movie.order(params[:sort_by]).all 
```

在您的情况下，我想您会收到有关“数组的未定义方法顺序”的错误。ActiveRecord 方法 .all 返回数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:57:21.627

`all`加载记录并返回数组。尝试使用[作用域](http://apidock.com/rails/ActiveRecord/NamedScope/ClassMethods/scoped)：

```
@movies = Movie.scoped
@movies = @movies.order(@sortby) unless @sortby.nil? 
```

# svn - 设置代理远程 SVN 服务器的本地 SVN 服务器？

> ID：14796951
> 
> 赞同：0
> 
> 时间：2013-02-10T10:52:36.877
> 
> 标签：svn

我开始了一份新工作，我的项目代码位于另一个部门管理的不同建筑物中的 SVN 服务器中。因此，以任何方式修改 SVN 服务器都是管理上的噩梦。

我想向远程 SVN 服务器添加一些提交挂钩，以便提交生成差异电子邮件并通知持续集成服务器。我自己无法做到这一点，远程服务器的管理员需要很长时间才能做到这一点。

我想知道是否可以设置代理远程 SVN 服务器的本地 SVN 服务器。本地 SVN 服务器会将所有请求转发到远程 SVN 服务器，并报告来自远程 SVN 服务器的任何响应（使用发出初始 SVN 请求的人的凭据）。在本地 SVN 服务器上，我想添加上面提到的提交后挂钩。

我对SVN服务器了解不够。这可能吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T10:59:44.577

您可以使用`svnsync`但 IIRC，它主要用于存储库的单向镜像。对于提交，您仍然需要提交到主服务器。

如果您可以让主服务器的管理员安装提交挂钩，他们的服务器可以“ping”您的服务器以重新同步。但这对于获得“实时镜像”也非常有用。

然后有许多类似的工具`svk`允许您在本地提交，然后在需要时将您的更改推送到上游。

还有`tailor`，它甚至可以同步不同的存储库。但是我不确定当您有多个可写副本时它的效果如何。我试过了，但发现它对`svnsync`我的使用更有效。

无论哪种方式，您的问题可能应该在 superuser.SE 而不是这里。

# jquery - 在 php 站点中使用 jquery 切换 html 多个块的显示

> ID：14796953
> 
> 赞同：0
> 
> 时间：2013-02-10T10:52:46.807
> 
> 标签：jquery, html

我有 3 个 html 块，如下所示，

```
<table class="">
    <tr>
        <td>
            <a class="breakdown" href="#">test</a>                                                
            <div style="display: none;padding: 10px;" class="breakdown_details">
                <br/>content here2<br/>
            </div>
        </td>

    </tr>
    <tr>
        <td>
            <a class="breakdown" href="#">test</a>                                                
            <div style="display: none;padding: 10px;" class="breakdown_details">
                <br/>content here3
            </div>
        </td>

    </tr>
</table> 
```

最初显示测试链接但不显示 div 的内容，当我单击测试链接时，相应的 div 会滑动打开并执行切换操作。我使用以下脚本但不正确..

```
$('.breakdown').click(function(){
    $(this).next(".breakdown_details").slideToggle("slow", function(){

    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:11:48.293

您可以尝试使用以下脚本，

```
 $('.breakdown').click(function(){
      $(this).next(".breakdown_details").slideToggle("slow", function(){
             $(".breakdown_details").not(this).slideUp("slow");
       });
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T10:57:15.837

我不确定为什么您的脚本无法正常工作，因为它是正确的。也许您在 html 中缺少 jQuery 参考？或者也许你已经包含了你的脚本而没有`$(document).ready(function () { ... });`? 无论哪种方式，这个[jsfiddle 都](http://jsfiddle.net/Deif/UxNMT/4/)表明它正在工作。

# jquery - jquery mobile - for循环中的ajax加载复选框不适用于.trigger（）

> ID：14796954
> 
> 赞同：0
> 
> 时间：2013-02-10T10:52:52.817
> 
> 标签：jquery, ajax, jquery-mobile, checkbox

所以这是我在互联网上看到的一个问题，但我一生都无法弄清楚为什么它不起作用。

对于那些会知道我正在尝试什么的人 - 我已经使用 .html(contentVariable) 加载了静态输入内容并且它工作正常但是一旦我将复选框创建放入 for 循环中，一切都会进入锅，只有第一个复选框元素似乎正在工作并应用了样式。

所以我在服务器上运行一个查询，它返回一个 json 对象以填充我的复选框。在 JS 中，我使用 ajax 来获取这个 json 对象并遍历内容以填充复选框。下面示例中的“结果”变量返回 3 个结果，并且这方面工作正常（如果人们意识到我实际上并没有从返回的对象中回显结果）。

所以我的猜测是我没有在正确的地方或根本没有正确使用 .trigger() 。任何帮助，将不胜感激。

非常感谢。

HTML

```
 <!-- register page -->
    <div data-role="page" id="two">
        <script type="text/javascript" src="js/friendsList.js"></script>
        <div data-role="header">
            <h1>New Project</h1>
            <a href="#two" class="ui-btn-left"  data-rel="back" data-icon="back" data-transition="flip">Back</a>
        </div>
        <div data-role="content">
            <form id='registerUser' action="" method="POST">
                <div data-role="fieldcontain" class="checkWrap">

                </div>
                <button type="button" aria-disabled="false">Submit</button>
            </form>
        </div>
    </div><!-- /page two --> 
```

JS

```
$(document).delegate('#two', 'pageshow', function() {

var userId = localStorage.getItem('userId');
var friendsListContent = "";

$.ajax({
    url: 'http://www.mysite.co.uk/app/friends/listFriends.php',
    type: 'post',
    data: {'userId': userId},
    dataType: 'json',
    crossDomain : true,
    timeout: 5000,

    success: function(result){
    friendsListContent = "<fieldset data-role='controlgroup'><legend>Choose as many snacks as you'd like:</legend>";

        for(var i = 0; i < result.length; i++){
            friendsListContent += "<input type='checkbox' name='checkbox-1a' id='checkbox-1a' class='custom' /><label for='checkbox-1a'>Cheetos</label>";           
        }

    friendsListContent += "</fieldset>";

    $('.checkWrap').html(friendsListContent);
    $('.checkWrap').trigger('create');
    $("input[type='checkbox']").checkboxradio("create");
    },

    error: function(){
        alert('There was an error loading the data. Contact the admin.');
    }

});

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:44:38.620

好的，答案是类和名称中的数字没有与每个复选框项目一起迭代。

在for循环中，我将其更改为...

```
friendsListContent += "<input type='checkbox' name='checkbox-" + i + "a' id='checkbox-" + i + "a' class='custom' /><label for='checkbox-" + i + "a'>Cheetos</label>"; 
```

# sql - SQL Server 2005 中的交叉表报表

> ID：14796957
> 
> 赞同：0
> 
> 时间：2013-02-10T10:53:18.963
> 
> 标签：sql, tsql, sql-server-2005, pivot

我的桌子看起来像这样

```
Year  S.Person Orange Mango 
2001   BOB       10    12    
2001   JOY       1     25    
2001   KENT      2      5     
2002   BOB       6      3     
2002   JOY       4      7     
2002   KENT      5      4 
```

我的要求是产生这样的输出：

```
Year   BOB-Orange BOB-MANGO  JOY-ORANGE JOY-MANGO KENT-ORANGE KENT-MANGO
2001    10         12         1          25        2           5
2002    6           3          4         7         5           4 
```

注意 S.Person 是动态的和橙色的，芒果是固定的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:16:34.600

由于您想动态执行此操作，请尝试以下操作：

```
DECLARE @cols AS NVARCHAR(MAX);
DECLARE @query AS NVARCHAR(MAX);

WITH Unpivoted
AS
(
  SELECT 
  Year, 
  SPerson + '-' + ITem AS SPersonItem, 
  value
  FROM
  (
    SELECT * FROM Table1
  ) AS t
  UNPIVOT 
  (
    Value FOR ITem IN(Orange, Mango)
  ) AS u
)
select @cols = STUFF((SELECT distinct ',' +
                        QUOTENAME(SPersonItem)
                      FROM Unpivoted
                      FOR XML PATH(''), TYPE
                     ).value('.', 'NVARCHAR(MAX)') 
                        , 1, 1, '');

SELECT @query = 
  'WITH Unpivoted 
   AS  
   ( 
      SELECT 
        Year, 
        SPerson + ''-'' + ITem AS SPersonItem, 
        value 
      FROM ( SELECT * FROM Table1  ) AS t 
      UNPIVOT 
      ( 
        Value FOR ITem IN( Orange, Mango) 
       ) AS u  
    ) 
    SELECT *  FROM Unpivoted AS u 
    PIVOT 
    ( 
      SUM(value) 
      FOR SPersonItem IN ( ' + @cols + ' ) 
     ) AS p ';

 execute(@query); 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/21cf2/13)

这会给你：

```
| YEAR | BOB-MANGO | BOB-ORANGE | JOY-MANGO | JOY-ORANGE | KENT-MANGO | KENT-ORANGE |
-------------------------------------------------------------------------------------
| 2001 |        12 |         10 |        25 |          1 |          5 |           2 |
| 2002 |         3 |          6 |         7 |          4 |          4 |           5 | 
```

# ios - 防止 UITextview 中的 typingAttributes 自动重置？

> ID：14796958
> 
> 赞同：2
> 
> 时间：2013-02-10T10:53:34.777
> 
> 标签：ios, uitextview, nsattributedstring

我正在尝试使用一些关键字突出显示功能来实现富文本编辑器。我在自己的类中实现了 UITextviewDelegate，并`attributedText`在

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text; 
```

而且，`typingAttributes`每当我更改`attributedText`或更改所选范围时，我都会重置 。

它工作正常。但是如果我启用`autocapitalizationType`and `autocorrectionType`，当出现自动更正视图时，应用程序会挂起或崩溃。我调试了源代码，发现根本原因是方法'setTypingAttributes：'挂起太多。文件说：`@property(nonatomic,copy) NSDictionary *typingAttributes NS_AVAILABLE_IOS(6_0); // automatically resets when the selection changes`

有什么方法可以防止它改变吗？

# jsf - JSF selectBooleanCheckbox required=true 不验证复选框是否被选中

> ID：14796961
> 
> 赞同：8
> 
> 时间：2013-02-10T10:54:08.987
> 
> 标签：jsf, jsf-2, jboss7.x

我正在编写 JSF 页面，该页面要求用户单击一个复选框（类似于接受许可协议）我有以下代码：

```
<h:selectBooleanCheckbox value="#{checkBoxManagedBean.checkBoxValue}" required="true"  id="jsfcheckBox" >
</h:selectBooleanCheckbox>
<h:outputLabel value="accept rule label" for="jsfcheckBox" />
<h:message for="jsfcheckBox"/>
<br/>
<h:commandButton id="loginButton" value="Submit" 
   action="#{checkBoxManagedBean.testAction}"/> 
```

我正在设置 required=true，但没有对复选框进行验证。我没有看到任何消息显示在复选框的页面中。

我试过 f:validateRequired，即使这不起作用。

```
<h:selectBooleanCheckbox value="#{checkBoxManagedBean.checkBoxValue}" required="true"  id="jsfcheckBox" >
        <f:validateRequired for="jsfcheckBox"></f:validateRequired>
        </h:selectBooleanCheckbox>
        <h:outputLabel value="CheckBox label" for="jsfcheckBox" />
        <h:message for="jsfcheckBox"/>
        <br/>
         <h:commandButton id="loginButton" value="Submit" 
                    action="#{checkBoxManagedBean.testAction}"/> 
```

该页面没有任何时间问题，复选框，按钮一切可见，我的期望是在按下按钮之前未选中复选框时收到验证消息。

顺便说一句，是 JSF 规范 required=true 并没有真正执行任何验证吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-10T11:17:31.087

`required=true`对于 jsf 输入字段意味着该字段的值不能为空或 null。这似乎是 jsf 实现中的错误，但是当`h:selectBooleanCheckbox`不检查时，它的值是`false`而不是空或`null`. 所以这不会触发验证。[BalusC 在这里写了一篇很好的文章](http://balusc.blogspot.com/2008/09/validate-required-checkbox.html#RequiredCheckboxValidator)。他为此实施了一个验证器，可以帮助您克服这种情况。感谢[BalusC](https://stackoverflow.com/users/157882/balusc)。

# node.js - 猫鼬模式参考

> ID：14796962
> 
> 赞同：12
> 
> 时间：2013-02-10T10:54:13.450
> 
> 标签：node.js, mongodb, mongoose

是否有可能有一个模式来引用 Mongo 中的另一个模式？

我有以下内容，我希望 Line 模式中的用户成为 UserSchema 中的用户

```
var UserSchema = new Schema({
    name: {type: String, required: true},
    screen_name: {type: String, required: true, index:{unique:true}},
    email: {type: String, required: true, unique:true},
    created_at: {type: Date, required: true, default: Date}
});

var LineSchema = new Schema({
    user: [UserSchema],
    text: String,
    entered_at: {type: Date, required: true, default: Date}
});

var StorySchema = new Schema ({
    sid: {type: String, unique: true, required: true},
    maxlines: {type: Number, default: 10}, // Max number of lines per user
    title: {type: String, default: 'Select here to set a title'},
    lines: [LineSchema],
    created_at: {type: Date, required: true, default: Date}
});

var Story = db.model('Story', StorySchema);
var User = db.model('User', UserSchema); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-10T11:01:31.463

是的，有可能

```
var LineSchema = new Schema({
    user: {type: Schema.ObjectId, ref: 'UserSchema'},
    text: String,
    entered_at: {type: Date, required: true, default: Date}
}); 
```

还有一句话，你为什么打电话给`LineSchema`他们`UserSchema`？你可以打电话给他们`Line`，`User`他们毕竟代表了一条线和一个用户:)

# html - 滚动时如何使表格标题保持静态

> ID：14796963
> 
> 赞同：-1
> 
> 时间：2013-02-10T10:54:27.340
> 
> 标签：html, css, html-table

这个问题已经出现过很多次了。我希望在向下滚动时固定表格的标题，我该怎么做？我的表格代码如下所示

```
<table class="specifictableheight table table-striped">
<h3>TEST</h3>
<thead>
<tr>
<th>Places</th>
<th>Hits</th>
</tr>
</thead>
<tbody>
<?php
foreach ($top3overRestaruants as $key => $value)
{
?>
<tr class="<?= $isactive ? 'alert-success' : ''; ?>">
<td><?= $key ?></td>

<td><?= $value ?></td>
</tr>
<?php
}
?>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:50:07.423

干得好。

**HTML：**

```
<div class="wrapper">
    <table class="specifictableheight table table-striped">
        <h3 class="table_title">TEST</h3>
        <br />
        <thead>
            <tr class="tr_first">
                <th>Places</th>
                <th>Hits</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
            <tr>
                <td>entry</td>
                <td>entry</td>
            </tr>
        </tbody>
    </table>
</div> 
```

**CSS：**

```
.table_title {
    position: fixed;
    background: #000;
    color: #fff;
}

.tr_first {
    top: 150px;
    position: relative;
}

.wrapper {
    height: 150px;
    overflow: scroll;
} 
```

jsfiddle 上的演示：http: [//jsfiddle.net/q2jRu/](http://jsfiddle.net/q2jRu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-08T02:36:35.660

简单：请先为 head 制作单独的 div 并为该 div ei 提供 id 然后在 css 规则中制作 #head{position:fixed;} 现在解决您的问题。

# clojure - 如何检查 clojure 对象是否是字节数组？

> ID：14796964
> 
> 赞同：11
> 
> 时间：2013-02-10T10:54:38.093
> 
> 标签：clojure

如何编写`bytes?`返回以下内容的函数：

```
(bytes? [1 2 3]) ;; => false
(bytes? (byte-array 8)) ;; => true 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T11:32:17.010

到目前为止，我这样做的方式是创建一个该类型的数组并测试它的类。为了防止每次都创建不必要的实例，请创建一个关闭该特定数组类型的类的函数。

```
(defn test-array
  [t]
  (let [check (type (t []))]
    (fn [arg] (instance? check arg))))

(def byte-array?
  (test-array byte-array))

=> (byte-array? (byte-array 8))
true

=> (byte-array? [1 2 3])
false 
```

不过，Mobyte 的示例似乎要简单得多，而且似乎我将在使用它的地方进行一些重构:)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-10T11:27:52.527

```
(defn bytes? [x]
  (if (nil? x)
    false
    (= (Class/forName "[B")
       (.getClass x)))) 
```

**更新。**[在这里测试对象是否是 Clojure 中的 Java 原始数组](https://stackoverflow.com/questions/9090396/testing-whether-an-object-is-a-java-primitive-array-in-clojure)已经问过同样的问题。谷歌在你的问题“如何检查 clojure 对象是否是字节数组？”中给出了准确的页面。;)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-04-10T09:30:54.547

Clojure.core 1.9 及以上版本支持一个`bytes?`函数。这是[Clojuredocs 链接](https://clojuredocs.org/clojure.core/bytes_q)

# javascript - 如何在 dgrid 中使用 dnd 实现行重新排序

> ID：14796968
> 
> 赞同：15
> 
> 时间：2013-02-10T10:54:59.620
> 
> 标签：javascript, drag-and-drop, dojo, dgrid

我在 dgrid 中创建了一个连接到 JsonRest 存储的网格。这会从金字塔后端加载数据。我还在商店中添加了 DnD 扩展。DnD 有效，但是当我拖动行时，我不知道如何让它发送任何有意义的数据。目前它发送两个请求，一个 GET 和一个 PUT，但 PUT 只包含行中的数据，但没有任何东西可以用来更新数据库中的顺序。

那么在我的网格中需要什么配置，以便我可以获得新的订购信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T02:38:11.353

这就是我所做的：

1.  在数据库中维护一`position`列
2.  当一行被删除时调用 store.put，传递被删除项目的 id 和它被删除的位置。
3.  更新位置时，相应地移动其他项目

这是我的`onDropInternal`功能。它也处理删除多行：

```
 onDropInternal: function(nodes, copy, targetItem) {

            var store = this.grid.store, grid = this.grid, targetRow, targetPosition;

            if (!this._targetAnchor) return

            targetRow = grid.row(this._targetAnchor);
            targetPosition = parseInt(targetRow.data[grid.orderColumn]);
            responses = 1;

            nodes.forEach(function(node, idx){
                targetPosition += idx;
                var object = {id:grid.row(node).id};
                object[grid.orderColumn] = targetPosition;
                store.put(object).then(function() {
                        if (responses == nodes.length) grid.refresh();
                        else responses++;
                });
            });

        } 
```

这是我用来更新位置的 PHP 代码。`$fields`是一个关联数组，表示要存储的记录。它还假设存在两个函数：`query`和`query_row`，如果您选择使用此技术，我相信您可以处理替换。

```
$table = "my_table";
$field = "position_field";
if (empty($fields['id'])) {
    //for new records, set the position field to the max position + 1
    $h = query_row("SELECT MAX(`$field`) as highest FROM $table LIMIT 1");
    $fields[$field] = $h['highest']+1;
} else if (is_numeric($fields[$field])) {
    //we want to move the row to $target_position
    $target_position = $fields[$field];
    //first get the original position
    $row = query_row("SELECT id,$field FROM $table WHERE id='$fields[id]' LIMIT 1");
    //start a list of ids
    $ids = $row['id'];
    //if the original position is lower than the target postion, set the incrementor to -1, otherwise 1
    $increment = ($row[$field] < $target_position) ? -1 : 1;
    //start a while loop that goes as we long as we have a row trying to take a filled position
    while (!empty($row)) {
        //set the position
        query("UPDATE $table SET $field='$target_position' where id='$row[id]'");
        //get the other row with this position (if it exists)
        $row = query_row("SELECT id,$field FROM $table WHERE id NOT IN ($ids) && `$field`='$target_position' LIMIT 1");
        //add it's id to the list of ids to exclude on the next iteration
        $ids .= ", ".$row['id'];
        //increment/decrement the target position
        $target_position += $increment;
    }
} 
```

您可以通过使用一次更新多条记录的查询来提高效率，但这样做的好处是它可以很好地处理位置编号中的意外间隙。

# c# - 如何使用 EF 5 包含与唯一约束映射的表？

> ID：14796979
> 
> 赞同：0
> 
> 时间：2013-02-10T10:57:14.343
> 
> 标签：c#, sql, asp.net-mvc, entity-framework, entity-framework-5

我有2张桌子，

```
Application
ID  varchar(50)
Version varchar(50)

Page
ID          int 
ApplicationVersion  varchar(50) 
```

它们与版本而不是 ID 连接。我可以使用 EF 5 Include 来加载受尊重的实体吗？这对我不起作用。

```
context.Pages.Where(p => p.ID == id).Include(p => p.Application).FirstOrDefault() 
```

# haskell - 同类型类的两个实例为同一个类型

> ID：14796983
> 
> 赞同：4
> 
> 时间：2013-02-10T10:57:28.803
> 
> 标签：haskell, types, typeclass

想象一下，我们有一个使用库的 Haskell 程序。该程序从其依赖项之一为类型 T 提供类型类 TC 实例。在同一库的下一个版本中，库作者为类型 T 提供了类型类 TC 的另一个实例。

我们想使用这两个类型类实例。我们怎么能这样做？

PS newtype 解决方案不起作用。这两个实例都驻留在我们无法控制的库中。

PPS 我没有真实代码的例子。这是一个理论问题。我只想了解类型类如何与库可组合性一起工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T11:44:19.843

[Haskell 2010 报告](http://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-750004.3)§4.3.2指出

> *   一个类型不能在程序中多次声明为特定类的实例。

所以在标准的 Haskell 中是不可能的。

我不知道有任何 GHC 扩展允许您在 GHC 中执行此操作。

这是（一个？）为什么孤立实例（在与类型和类型类不同的模块中定义实例）通常被认为是一个坏主意的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T11:49:21.737

一般来说，同一类型的多个类型类实例是不可能的。但是，如果一个类型在不同的包中定义，或者是同一包的旧版本，ghc 会认为它是不同的类型。所以理论上你可以为它定义和实例，并为它`foo-1.1`定义和实例，并将两者一起使用。`Foo``foo-1.2``Foo`

然而，在实践中，这不会很好地工作。函数仅适用于一种类型或另一种类型。当您编写一个对 a 进行操作的函数时`Foo`，它将仅对一个特定的 进行操作`Foo`，而不是两者。本质上，您有两种完全独立的、无可争议的类型。使用起来会很尴尬，与构建的尴尬程度完全不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-10T11:33:52.953

我可以肯定地说，使用 Cabal 你只能依赖同一个库的一个版本。

虽然您至少可以将实例的替代版本的源代码复制粘贴到您的项目中，但您仍然只能在每个模块中导入其中一个。如果您将冲突的实例导入模块，您将遇到无法确定的实例问题，您将没有实际的解决方案。

说实话，我无法想象为什么要为同一个库发出的同一种类型拥有同一个类的不同实例。这似乎非常不切实际。尽管我对可能对您的情况有所帮助的猜测是有两个具有相应实例的类型类：一个来自库的当前版本，另一个 - 旧版本的重命名源代码副本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-13T21:48:48.397

如果您想要更好的灵活性和可组合性，请将类型类具体化为记录。`RankNTypes`可能是必要的。

例如，以下是如何具体化 Applicative 类型类

```
{-# LANGUAGE RankNTypes #-}

data ApplicativeInstance f = ApplicativeInstance
  { pure :: forall a. a -> f a
  , amap :: forall a b. (a -> b) -> f a -> f b
  , ap :: forall a b. f (a -> b) -> f a -> f b
  }

listApplicative = ApplicativeInstance
  { pure = \a -> [a]
  , amap = map
  , ap = \fs xs -> case fs of
      [] -> []
      f:fs' -> map f xs ++ ap cartesianListApplicative fs' xs
  }

zipListApplicative = ApplicativeInstance
  { pure = \a -> [a]
  , amap = map
  , ap = \fs xs -> case (fs, xs) of
      ([], _) -> []
      (_, []) -> []
      (f:fs', x:xs') -> f x : ap zipListApplicative fs' xs'
  } 
```

现在，我们获得了指定我们想要的实例的能力。然而，我们失去了隐式选择实例的能力：选择现在必须是显式的。

```
ghci> ap listApplicative [(+1), (*3)] [1 .. 5]
[2,3,4,5,6,3,6,9,12,15]
ghci> ap zip
zip                 zipListApplicative  zipWith3
zip3                zipWith
ghci> ap zipListApplicative [(+1), (*3)] [1 .. 5]
[2,6] 
```

另见： http: [//lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/](http://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-10T14:02:36.357

在依赖树上链接同一个包的不同版本，现在是不可能的，因为它会导致[依赖冲突](http://www.haskell.org/cabal/FAQ.html#dependencies-conflict)。

但这在未来是可能的，正如这个[GHC 状态更新视频](http://www.youtube.com/watch?v=2Pucbf8_hGQ#t=19m45s)中所述，只要我猜它们在同一个库中只使用一个版本。

# java - 需要以管理员身份运行 Java 应用程序？

> ID：14796985
> 
> 赞同：0
> 
> 时间：2013-02-10T10:57:30.117
> 
> 标签：java, file-io, directory, admin, directory-listing

我有个问题。这是我的代码：

```
File root = new File(path);
String[] entries = root.list();
LinkedList<String> out = new LinkedList<String>();
for(String entry : entries) {
 ....
} 
```

在我的代码中，我试图列出目录的内容`C:`。但是这段代码让我`null`在 for 循环开始时返回。在网络上的某个地方，我发现`null`当文件不是目录或者我没有管理员权限时它会返回。我试图以管理员身份运行 Eclipse，然后运行我的程序，但我仍然得到`NullPointerException`，我不知道如何移动。有谁知道我该如何编辑我的代码或如何让它工作？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T11:02:05.020

为什么不让自己成为管理员并进行测试。

转到控制面板用户帐户并将您的用户帐户类型更改为管理员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T11:04:36.183

也许您应该在尝试其他任何操作之前尝试调用[`File.isDirectory()`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#isDirectory%28%29)该对象并检查其结果。`root`

很可能有问题的路径实际上并不引用目录，或者它甚至可能根本不存在......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T11:06:58.380

您必须以管理员身份启动您的 java**程序**。

一种方法是以管理员身份打开控制台并启动您的程序：例如开始->所有程序->附件->命令提示符（右键单击它，“以管理员身份运行”）

然后，在此控制台中，您可以使用管理员权限启动 java 进程：

> java yourpackage.YourProgram

# c# - foreach 到对象列表

> ID：14796991
> 
> 赞同：0
> 
> 时间：2013-02-10T10:58:27.853
> 
> 标签：c#, foreach

给定一个对象列表，我将它们保存到这样的文本文件中：

```
public void Save(PhoneBook pb)
{
   foreach (PhoneBookGroup item in pb.Items)
   {
        File.WriteAllText(path, item.GroupName + "@");
        foreach (Contect contect in item.Items)
       {
           File.WriteAllText(path, "Group :" + item.GroupName + "#"+
                                   "Name : " + contect.Name + "$" +
                                   "Number : " + contect.Number + "$" +
                                   "Addres : " + contect.Addres + "$");
       }
   }
} 
```

结果是： Group :group Aaa#Name : Ziv$Number : 1$Addres : Sokolov$

现在我想从该文件加载，同时保持逻辑并将每个组添加到列表中。使用查找（# 代表对象名称和 $ 代表属性名称）示例的字符查找器：

```
Aaa(object)  
ziv(attributes)  
1(attributes)  
sokolov(attributes) 
```

等等

```
bbb(object)  
jon(attributes)  
2(attributes)  
somewhere(attributes) 
```

.

```
public void Load()
{
   List<PhoneBook> phoneBookList = new List<PhoneBook>();

   string line = File.ReadAllText(path);
   foreach (var item in line)
   {

   }
   return phoneBookList; 
```

}

# c++ - 使用指针对并行数组进行 Qsort

> ID：14796992
> 
> 赞同：0
> 
> 时间：2013-02-10T10:58:31.797
> 
> 标签：c++, 2d, qsort

我正在尝试在 C++ 中进行并行 qsort 。我有一个排序好的数字数组，我想要一个并行的二维字符数组随着它的数字上下移动。这就是我到目前为止所拥有的。

```
 int compare (const void * a, const void * b)
    {
        //this is for qsort
        return ( *(int*)b - *(int*)a );
    }

    void sort_scores(char** myArray, int *votes)
    {
        qsort ((myArray, votes ), 5, sizeof(int), compare);
    } 
```

我对数字进行了排序，但没有一次移动一个角色，我似乎无法让它发挥作用。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:07:36.553

您可以创建一个指向投票的指针数组（即指向数组每个元素的指针`votes`数组），然后对这些指针进行排序，而不是对投票本身进行排序。（请记住相应地更新比较函数！它现在将接收您必须转换为的参数`int **`）。对新数组进行排序后，只需遍历它，并使用指针差异来获取原始数组中元素的索引。