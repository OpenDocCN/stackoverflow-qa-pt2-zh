# StackOverflow 问答 14962000-14962999

# mysql - 使用 MYSQL 数据库的单用户登录 Visual Basic 桌面应用程序

> ID：14962000
> 
> 赞同：0
> 
> 时间：2013-02-19T16:08:47.637
> 
> 标签：mysql, visual-studio-2010, authentication, login

我正在寻找一种方法来创建一个 Visual Basic 桌面应用程序，该应用程序连接到我可以监控登录的 mysql 数据库。我希望用户一次只能在一个位置登录..任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:15:12.787

您可以限制单个用户的并发连接数：

`GRANT ... TO 'user'@'host' WITH MAX_USER_CONNECTIONS 1;`

[资源](http://dev.mysql.com/doc/refman/5.5/en//user-resources.html)

# php - PHP的PDF格式错误

> ID：14962001
> 
> 赞同：0
> 
> 时间：2013-02-19T16:08:49.737
> 
> 标签：php, file, download, formatting

我创建了一个带有以下标头的 download.php：

```
 header('Content-Description: File Transfer');
            header('Content-Type: application/octet-stream');
            header('Content-Disposition: attachment; filename='.$archivo);
            header('Content-Transfer-Encoding: binary');
            header('Expires: 0');
            header('Cache-Control: must-revalidate');
            header('Pragma: public');
            header('Content-Length: ' . filesize($ruta));
            readfile($ruta); 
```

但我看不到文件。我认为它已损坏，但我不知道为什么。这是输出的开始：

```
%PDF-1.4 %âãÏÓ 3 0 obj <>stream xœ–wTSÙ‡Ï½7½P’Š”ÐkhRH ½H‘.*1 JÀ"6DTpDQ‘¦2(à€£C‘±"Š…Q±ëDÔqp–Id­ß¼yïÍ›ß÷~kŸ½ÏÝgï}ÖºüƒÂLX €¡XáçÅˆ‹g`ðlàp³³BøF™|ØŒl™ø½º ùû*Ó?ŒÁÿŸ”¹Y"1P˜ŒçòøÙ\É8=Wœ%·OÉ˜¶4MÎ0JÎ"Y‚2V“sò,[|ö™e9ó2„&lt;ËsÎâeðäÜ'ã9¾Œ‘`çø¹2¾&cƒtI†@Æoä±|N6(’Ü.æsSdl-c’(2‚-ãyàHÉ_ðÒ/XÌÏËÅÎÌZ.$§ˆ&\S†“‹áÏÏMç‹ÅÌ07#â1Ø™YárfÏüYym²";Ø8980m-m¾(Ô]ü›’÷v–^„îDøÃöW~™ °¦eµÙú‡mi]ëP»ý‡Í`/Š²¾u}qº|^RÄâ,g+«ÜÜ\KŸk)/èïúŸC_|ÏR¾Ýïåaxó“8’t1C^7nfz¦DÄÈÎâpùæŸ‡øþuü$¾ˆ/”EDË¦L L–µ[Èˆ™B†@øŸšøÃþ¤Ù¹–‰ÚøÐ–X¥!@~(* {d+Ðï}ÆGùÍ‹Ñ™˜ûÏ‚þ}W¸LþÈ$ŽcGD2¸QÎìšüZ4 E@ê@èÀ¶À¸àA(ˆq`1à‚D €µ ”‚­`'¨u 4ƒ6ptcà48.Ë`ÜR0ž€)ð Ì@„…ÈR‡t CÈ²…XäCP”%CBH@ë R¨ª†ê¡fè[è(tº C· Qhúz#0 ¦ÁZ°l³`O8Ž„ÁÉð28.‚·À•p|î„OÃ—àX ?§€:¢‹0ÂFB‘x$ !«¤i@Ú¤¹ŠH‘§È[EE1PL”Ê…â¢–¡V¡6£ªQP¨>ÔUÔ(j õMFk¢ÍÑÎèt,:‹.FW ›Ðè³èô8úƒ¡cŒ1ŽL&³³³ÓŽ9…ÆŒa¦±X¬:ÖëŠ År°bl1¶ {{{;Ž}ƒ#âtp¶8_\¡8áú"ãEy‹.,ÖXœ¾øøÅ%œ%GÑ.....and so on 
```

如果我用记事本打开相同的pdf：

```
%PDF-1.4
%âãÏÓ
3 0 obj
<</Alternate/DeviceRGB/Length 2596/N 3/Filter/FlateDecode>>stream
xœ–wTSÙ‡Ï½7½P’Š”ÐkhRH
½H‘.*1  JÀ...and so on 
```

有什么问题？当然，zip 或其他格式也会发生同样的情况，但我会使用 pdf。

**编辑：我认为问题在于我在标题之前做了 is_file($file) 。如果我删除它，就可以了。为什么？**

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:18:45.083

```
header('Content-disposition: attachment; filename=yourfile.pdf');
header('Content-type: application/pdf');
readfile('yourfile.pdf'); 
```

应该管用...

# sql-server - 按类型组合连续的日期时间间隔

> ID：14962003
> 
> 赞同：5
> 
> 时间：2013-02-19T16:08:54.590
> 
> 标签：sql-server, tsql

假设我们有这样一张桌子：

```
declare @periods table (
    s date, 
    e date,
    t tinyint
); 
```

具有按开始日期（s）排序的无间隔的日期间隔

```
insert into @periods values
('2013-01-01' , '2013-01-02', 3),
('2013-01-02' , '2013-01-04', 1),
('2013-01-04' , '2013-01-05', 1),
('2013-01-05' , '2013-01-06', 2),
('2013-01-06' , '2013-01-07', 2),
('2013-01-07' , '2013-01-08', 2),
('2013-01-08' , '2013-01-09', 1); 
```

所有日期间隔都有不同的类型 (t)。

需要组合相同类型的日期间隔，它们不会被其他类型的间隔打破（所有间隔都按开始日期排序）。

因此结果表应如下所示：

```
 s     |      e     |  t
------------|------------|-----
 2013-01-01 | 2013-01-02 |  3
 2013-01-02 | 2013-01-05 |  1
 2013-01-05 | 2013-01-08 |  2
 2013-01-08 | 2013-01-09 |  1 
```

任何想法如何在没有光标的情况下做到这一点？

* * *

我有一个可行的解决方案：

```
declare @periods table (
    s datetime primary key clustered, 
    e datetime,
    t tinyint,
    period_number int   
);

insert into @periods (s, e, t) values
('2013-01-01' , '2013-01-02', 3),
('2013-01-02' , '2013-01-04', 1),
('2013-01-04' , '2013-01-05', 1),
('2013-01-05' , '2013-01-06', 2),
('2013-01-06' , '2013-01-07', 2),
('2013-01-07' , '2013-01-08', 2),
('2013-01-08' , '2013-01-09', 1);

declare @t tinyint = null;  
declare @PeriodNumber int = 0;
declare @anchor date;

update @periods
    set  period_number = @PeriodNumber, 
    @PeriodNumber = case
                        when @t <> t
                            then  @PeriodNumber + 1
                        else
                            @PeriodNumber
                    end,
    @t = t,
    @anchor = s
option (maxdop 1);

select 
    s = min(s),
    e = max(e),
    t = min(t)
from 
    @periods    
group by 
    period_number
order by 
    s; 
```

但我怀疑我是否可以依赖 UPDATE 语句的这种行为？

我使用 SQL Server 2008 R2。

* * *

**编辑：**

感谢 Daniel 和这篇文章：[http ://www.sqlservercentral.com/articles/T-SQL/68467/](http://www.sqlservercentral.com/articles/T-SQL/68467/)

我发现上述解决方案中遗漏了三件重要的事情：

1.  表上必须有聚集索引
2.  必须有锚变量和聚集列的调用
3.  更新语句应该由一个处理器执行，即没有并行性

我已根据这些规则更改了上述解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T21:44:05.663

由于您的范围是连续的，因此问题本质上变成了[差距和孤岛](/questions/tagged/gaps-and-islands "显示标记为“差距和岛屿”的问题")问题。如果您有一个标准来帮助您区分具有相同`t`值的不同序列，您可以使用该标准对所有行进行分组，然后`MIN(s), MAX(e)`对每个组进行分组。

获得这种标准的一种方法是使用两次`ROW_NUMBER`调用。考虑以下查询：

```
SELECT
  *,
  rnk1 = ROW_NUMBER() OVER (               ORDER BY s),
  rnk2 = ROW_NUMBER() OVER (PARTITION BY t ORDER BY s)
FROM @periods
; 
```

对于您的示例，它将返回以下集合：

```
s           e           t   rnk1  rnk2
----------  ----------  --  ----  ----
2013-01-01  2013-01-02  3   1     1
2013-01-02  2013-01-04  1   2     1
2013-01-04  2013-01-05  1   3     2
2013-01-05  2013-01-06  2   4     1
2013-01-06  2013-01-07  2   5     2
2013-01-07  2013-01-08  2   6     3
2013-01-08  2013-01-09  1   7     3 
```

`rnk1`和排名的有趣之`rnk2`处在于，如果您从另一个中减去一个，您将获得与 一起`t`唯一标识具有相同 的行的*每个*不同序列的值`t`：

```
s           e           t   rnk1  rnk2  rnk1 - rnk2
----------  ----------  --  ----  ----  -----------
2013-01-01  2013-01-02  3   1     1     0
2013-01-02  2013-01-04  1   2     1     1
2013-01-04  2013-01-05  1   3     2     1
2013-01-05  2013-01-06  2   4     1     3
2013-01-06  2013-01-07  2   5     2     3
2013-01-07  2013-01-08  2   6     3     3
2013-01-08  2013-01-09  1   7     3     4 
```

知道了这一点，您可以轻松地应用分组和聚合。这是最终查询的样子：

```
WITH partitioned AS (
  SELECT
    *,
    g = ROW_NUMBER() OVER (               ORDER BY s)
      - ROW_NUMBER() OVER (PARTITION BY t ORDER BY s)
  FROM @periods
)
SELECT
  s = MIN(s),
  e = MAX(e),
  t
FROM partitioned
GROUP BY
  t,
  g
; 
```

如果您愿意，可以[在 SQL Fiddle](http://sqlfiddle.com/#!3/01a4a/1)上使用此解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T18:54:47.443

这个怎么样？

```
declare @periods table (
    s datetime primary key, 
    e datetime,
    t tinyint,
    s2 datetime
);

insert into @periods (s, e, t) values
('2013-01-01' , '2013-01-02', 3),
('2013-01-02' , '2013-01-04', 1),
('2013-01-04' , '2013-01-05', 1),
('2013-01-05' , '2013-01-06', 2),
('2013-01-06' , '2013-01-07', 2),
('2013-01-07' , '2013-01-08', 2),
('2013-01-08' , '2013-01-09', 1);

update @periods set s2 = s;

while @@ROWCOUNT > 0
begin
    update p2 SET s2=p1.s
    from @periods p1
    join @PERIODS P2 ON p2.t = p1.t AND p2.s2 = p1.e;
end

select s2 as s, max(e) as e, min(t) as t
from @periods
group by s2
order by s2; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T19:27:13.657

避免更新和游标的可能解决方案应该是使用公用表表达式...

像这样...

```
 declare @periods table (
        s date, 
        e date,
        t tinyint
    );

    insert into @periods values
    ('2013-01-01' , '2013-01-02', 3),
    ('2013-01-02' , '2013-01-04', 1),
    ('2013-01-04' , '2013-01-05', 1),
    ('2013-01-05' , '2013-01-06', 2),
    ('2013-01-06' , '2013-01-07', 2),
    ('2013-01-07' , '2013-01-08', 2),
    ('2013-01-08' , '2013-01-09', 1);

    with cte as ( select 0 as n
                        ,p.s as s
                        ,p.e as e
                        ,p.t
                        ,case when p2.s is null then 1 else 0 end fl_s
                        ,case when p3.e is null then 1 else 0 end fl_e
                  from @periods p
                  left outer join @periods p2
                  on p2.e = p.s
                  and p2.t = p.t
                  left outer join @periods p3
                  on p3.s = p.e
                  and p3.t = p.t

                  union all 

                  select  n+1 as n
                        , p2.s as s
                        , p.e as e
                        ,p.t
                        ,case when not exists(select * from @periods p3 where p3.e =p2.s and p3.t=p2.t) then 1 else 0 end as fl_s
                        ,p.fl_e as fl_e
                  from cte p
                  inner join @periods p2
                  on p2.e = p.s
                  and p2.t = p.t
                  where p.fl_s = 0

                  union all 

                  select  n+1 as n
                        , p.s as s
                        , p2.e as e
                        ,p.t
                        ,p.fl_s as fl_s
                        ,case when not exists(select * from @periods p3 where p3.s =p2.e and p3.t=p2.t) then 1 else 0 end as fl_e
                  from cte p
                  inner join @periods p2
                  on p2.s = p.e
                  and p2.t = p.t
                  where p.fl_s = 1
                  and p.fl_e = 0
    )
    ,result as (select s,e,t,COUNT(*) as count_lines
                 from cte
                 where fl_e = 1
                 and fl_s = 1
                 group by s,e,t
                 )
    select * from result
    option(maxrecursion 0) 
```

结果集达到...

```
 s           e           t   count_lines
    2013-01-01  2013-01-02  3   1
    2013-01-02  2013-01-05  1   2
    2013-01-05  2013-01-08  2   3
    2013-01-08  2013-01-09  1   1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T07:17:04.710

万岁！我找到了适合我的解决方案，并且无需迭代即可完成

```
with cte1 as (   
    select s, t  from @periods
    union all
    select max(e), null from @periods
),
cte2 as (
    select rn = row_number() over(order by s), s, t from cte1   
),
cte3 as (
    select 
        rn = row_number() over(order by a.rn),
        a.s,
        a.t 
    from 
        cte2 a 
        left join cte2 b on a.rn = b.rn + 1 and a.t = b.t
    where
        b.rn is null 
)
select 
    s = a.s, 
    e = b.s, 
    a.t  
from 
    cte3 a 
    inner join cte3 b on b.rn = a.rn + 1; 
```

感谢大家分享您的想法和解决方案！

* * *

细节：

cte1 返回日期链及其*后*的类型：

```
s          t
---------- ----
2013-01-01 3
2013-01-02 1
2013-01-04 1
2013-01-05 2
2013-01-06 2
2013-01-07 2
2013-01-08 1
2013-01-09 NULL  -- there is no type *after* the last date 
```

ct2 只需将行号添加到上述结果中：

```
 rn       s       t
---- ----------  ----
 1    2013-01-01  3
 2    2013-01-02  1
 3    2013-01-04  1
 4    2013-01-05  2
 5    2013-01-06  2
 6    2013-01-07  2
 7    2013-01-08  1
 8    2013-01-09  NULL 
```

*如果我们在不带where*条件的情况下输出 cte3 中查询的所有字段，我们会得到以下结果：

```
select * from cte2 a left join cte2 b on a.rn = b.rn + 1 and a.t = b.t;

rn       s        t       rn      s          t
---- ----------  ----    ------ ----------  ----
1    2013-01-01  3       NULL   NULL        NULL
2    2013-01-02  1       NULL   NULL        NULL
3    2013-01-04  1       2      2013-01-02  1
4    2013-01-05  2       NULL   NULL        NULL
5    2013-01-06  2       4      2013-01-05  2
6    2013-01-07  2       5      2013-01-06  2
7    2013-01-08  1       NULL   NULL        NULL
8    2013-01-09  NULL    NULL   NULL        NULL 
```

对于重复类型的日期，结果右侧有值。所以我们可以删除右侧存在值的所有行。

所以 cte3 返回：

```
rn    s           t
----- ----------  ----
1     2013-01-01  3
2     2013-01-02  1
3     2013-01-05  2
4     2013-01-08  1
5     2013-01-09  NULL 
```

请注意，由于删除了一些行，因此在 rn 序列中存在一些间隙，因此我们必须再次对其重新编号。

从这里只剩下一件事 - 将日期转换为句点：

```
select 
    s = a.s, 
    e = b.s, 
    a.t  
from 
    cte3 a 
    inner join cte3 b on b.rn = a.rn + 1; 
```

我们得到了所需的结果：

```
s          e          t
---------- ---------- ----
2013-01-01 2013-01-02 3
2013-01-02 2013-01-05 1
2013-01-05 2013-01-08 2
2013-01-08 2013-01-09 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T19:18:53.773

这是您的解决方案，表格上有不同的数据..

```
 declare @periods table (
        s datetime primary key, 
        e datetime,
        t tinyint,
        period_number int   
    );

    insert into @periods (s, e, t) values
    ('2013-01-01' , '2013-01-02', 3),
    ('2013-01-02' , '2013-01-04', 1),
    ('2013-01-04' , '2013-01-05', 1),
    ('2013-01-05' , '2013-01-06', 2),
    ('2013-01-09' , '2013-01-10', 2),
    ('2013-01-10' , '2013-01-11', 1);

    declare @t tinyint = null;  
    declare @PeriodNumber int = 0;

    update @periods
        set  period_number = @PeriodNumber, 
        @PeriodNumber = case
                            when @t <> t
                                then  @PeriodNumber + 1
                            else
                                @PeriodNumber
                        end,
        @t = t;

    select 
        s = min(s),
        e = max(e),
        t = min(t)
    from 
        @periods    
    group by 
        period_number
    order by 
        s; 
```

哪里有差距

```
 ('2013-01-05' , '2013-01-06', 2),
 --and
 ('2013-01-09' , '2013-01-10', 2), 
```

您的解决方案结果集是..

```
 s           e           t
    2013-01-01  2013-01-02  3
    2013-01-02  2013-01-05  1
    2013-01-05  2013-01-10  2
    2013-01-10  2013-01-11  1 
```

不是这样的结果集..??

```
 s           e           t
    2013-01-01  2013-01-02  3
    2013-01-02  2013-01-05  1
    2013-01-05  2013-01-06  2
    2013-01-09  2013-01-10  2
    2013-01-10  2013-01-11  1 
```

也许我确实误解了你的问题的规则......

# ruby-on-rails - 如何访问资产/图像

> ID：14962005
> 
> 赞同：0
> 
> 时间：2013-02-19T16:08:57.583
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我确实有调用`18.png`图像`assets/images/languages/`

那么我确实有一个名为`language`
Assuming, current_user.language =的属性`18`

如何访问和显示视图中的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:11:10.023

只需将用户语言属性附加到视图内的相对语言资产路径即可。

```
<%= image_tag "languages/#{current_user.language}.png" %> 
```

如果这是您要在整个应用程序中使用的东西，您应该将其移至辅助方法中，例如：

```
def user_locale_tag
  image_tag "languages/#{current_user.language}.png"
end 
```

在您的身份验证系统中，您需要确保 current_user 事先存在。

# c# - 三个带有自动回发的下拉列表

> ID：14962006
> 
> 赞同：1
> 
> 时间：2013-02-19T16:08:58.080
> 
> 标签：c#, combobox, webforms

我有`dropdownlist`三个`autopostback = true`。首先选择国家并在第二个中显示城市，`dropdownlist`然后从第二个中选择城市`dropdownllist`并在第三个下拉列表中显示区域。但问题是，当我在第一个`dropdownlist`（例如美国）中选择第三个值，然后在第二个下拉列表中选择一个值（例如`Los angles`）时，页面被刷新并选择了美国，然后第二个中的第一个值`dropdownlist`被选择（我不能选择另一个值，因为页面刷新时第一个值再次选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:12:11.257

您需要设置一个默认值（例如“请选择...”）

```
<asp:DropDownList ID="ddl1" AppendDataBoundItems="true" runat="server">
    <asp:ListItem Text="Please Select..." Value="" />
</asp:DropDownList> 
```

* * *

或者在您`SelectedIndexChanged`的第一个下拉列表的事件中，绑定第二个下拉列表，然后根据第二个选择的值立即绑定第三个下拉列表。

理论上：

```
public void ddl1_selectedindexchanged(){
   BindDdl2();
   BindDdl3();
}

public void ddl2_selectedindexchanged(){
   BindDdl3();
}

private void BindDdl2(){
   int selectedvalue = ddl1.SelectedValue;
   //bind ddl2
}

private void BindDdl3(){
   int selectedvalue = ddl2.SelectedValue;
   //bind ddl3
} 
```

# linux - 使用错误检查功能在我的脚本中重击意外的 EOF 以获取存档并提取它

> ID：14962008
> 
> 赞同：1
> 
> 时间：2013-02-19T16:09:02.093
> 
> 标签：linux, bash, eof

我编写了简单的 bash 脚本来从 iblocklist.com 获取存档并将其提取到我的传输阻止列表目录中。在它多次运行失败后，我发现 iblocklist 推送的 .gz 存档已损坏，但 .zip 没有，所以我决定实现一些错误捕获和完成任务的替代方法。重写脚本后，我收到意外的 EOF 错误，我找不到问题所在。我绝不是 bash 的高级用户，但我通常可以通过反复试验和谷歌来完成我想要的。今天不行。我一直在寻找明显缺失的 }、fi 和 ;，但它对我来说看起来不错。不确定这是否重要，但在这台机器上，我正在运行一个 Backtrack linux 发行版，它或多或少地迫使你始终成为 root。我是初学者所以请温柔:)

```
#!/bin/bash

function test {
    "$@"
        STATUS=$?
    if [ $STATUS -ne 0 ]; then
        echo "error with $1";
    fi

    return $STATUS
}

function askyn {
    read -p "The operation failed. Try alternate means? [Y/n] " -n 1 -r
    if [[ "$REPLY" =~ ^[Yy] ]] || [[ "$REPLY" = "" ]]; then YN=1;
    else YN=0; fi
    return $YN
}

function cleanup {
    if [ $ALT == 0 ]; then {
        test rm /root/scripts/.lvl1/dl/level1.gz
        if [ $STATUS -ne 0 ]; then {
            echo Removal of archive failed
        }fi
    }else {
        test rm /root/scripts/.lvl1/dl/level1.zip
        if [ $STATUS -ne 0 ]; then {
            echo Removal of archive failed
        }fi
    }fi
    return
}

ALT=0
YN=-1
test wget "http://list.iblocklist.com/?list=bt_level1&fileformat=p2p&archiveformat=gz" -O /root/scripts/.lvl1/dl/level1.gz
if [ $STATUS -ne 0 ]; then { #wget failed first try
    askyn
    if [ $YN == 1 ]; then ALT=1;else exit;fi #prompt for alternate; exit if not
}else { #wget worked first try
    test file-roller -e /root/.config/transmission/blocklists /root/scripts/.lvl1/dl/level1.gz
    if [ $STATUS -ne 0 ]; then { #file-roller failed to extract the list
        askyn
        if [ $YN == 1 ]; then ALT=1;else exit;fi #prompt for alternate; exit if not
    }else { #everything worked first try
        echo Download and extraction successful
        cleanup
    }fi
}fi
if [ $ALT == 1 ]; then { #try to wget .zip
    test wget "http://list.iblocklist.com/?list=bt_level1&fileformat=p2p&archiveformat=zip" -O /root/scripts/.lvl1/dl/level1.zip
    if [ $STATUS -ne 0 ]; then { #wget of .zip failed
        echo Alternate means failed.  Exiting.
        exit
    }else { #wget of .zip worked 
        test unzip -o -d /root/.config/transmission/blocklists /root/scripts/.lvl1/dl/level1.zip #try to unzip .zip
        if [ $STATUS -ne 0 ]; then { #unzip failed
            echo Alternate means failed.  Exiting.
            exit
        }else { #everything worked second try
            echo Download and extraction successful using alternate means
            cleanup
        }fi
    }fi
}fi 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:22:29.557

问题是您使用`}fi`来终止`if`. 令牌`}fi`不是`fi`. 所以文件末尾的 shell 有很多 open`if`缺少它们`fi`的 s。

您迫切需要阅读 shell 手册、理解 shell 语法并询问当地的 shell 专家。编写的脚本是 fubar，即使语法错误已更正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:09:12.170

像你一样使用大括号是一种有点不寻常的风格，但它没有任何问题。然而，shell 对空格有点挑剔：

```
if cmd; then {
    : commands
} else {
    : other commands
} fi 
```

注意 和 之间的`}`空格`fi`。

还有，你工作太辛苦了。而不是一直明确检查`$?`并编写错误消息，只需执行以下操作：

```
if rm /root/scripts/.lvl1/dl/level1.gz; then
    : # perform some commands if the remove succeeded
else
    : # perform some commands on failure, but DO NOT PRINT AN ERROR MESSAGE
fi 
```

不打印错误消息的原因是该`rm`命令应该已经打印了一个。如果您打算在命令失败时退出，您可以简化事情并执行以下操作：

```
rm /p/a/t/h || exit 1 
```

您可以通过执行以下操作进一步简化：

```
#!/bin/sh -e
rm /p/a/t/h 
```

通过设置`-e`，shell 将在任何命令失败时立即退出。

# c++ - Eclipse 项目参考 C

> ID：14962009
> 
> 赞同：2
> 
> 时间：2013-02-19T16:09:02.293
> 
> 标签：c++, c, eclipse, optimization, eclipse-cdt

我在[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)中有两个项目，每个项目都有一个包含其库的文件夹。

我想将第一个项目中的头文件包含到第二个项目的库中，而无需键入以下内容：

```
#include "../../first_project_name/lib/Mylib.h" 
```

我只想打字

```
#include "Mylib.h" 
```

我试图在部分项目参考中转到第二个项目的首选项并检查第一个项目，但没有任何反应。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:34:28.820

转到**项目 -> 属性 -> C/C++ 构建 -> 设置 -> 工具设置 -> 包含**并添加正确的包含路径。

# php - 使用 CodeIgniter 锚定到一个部分

> ID：14962010
> 
> 赞同：2
> 
> 时间：2013-02-19T16:09:04.887
> 
> 标签：php, codeigniter, anchor

我正在尝试为页面元素创建一个锚点。有一个选项卡界面。在 html 中我可以看到他们的链接是这样的：

```
http://example.com/index.php/service#tab-1
http://example.com/index.php/service#tab-2
http://example.com/index.php/service#tab-3
http://example.com/index.php/service#tab-4 
```

所以我有 4 个 div，id 为 tab-1、tab-2 等。

如何从另一个视图文件为它们创建锚点？当我尝试这个时：

```
<a href="<?=site_url();?>/service#tab-1">give it a try</a> 
```

它转到页面 /service 但不专注于 #tab-1 。它正在使用纯 html，但我无法使用 codeigniter

感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:19:58.840

我刚刚在我的 CodeIgniter 上尝试了同样的事情，它运行良好，所以我建议仔细检查你的 ID 是否正确。除了尝试

```
<a href="<?=site_url('/service#tab-1');?>">give it a try</a> 
```

或者

```
<a href="<?=site_url('/service');?>#tab-1">give it a try</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:17:59.210

您需要将`#tab-1`等的目标放在您的页面中。因此，在您的 div 中，您需要包含一个命名的锚点，例如：

```
<a name="tab-1"></> 
```

这将导致页面跳转到该元素。

# wordpress - Wordpress：制作插件选项以修改 jquery

> ID：14962015
> 
> 赞同：0
> 
> 时间：2013-02-19T16:09:20.360
> 
> 标签：wordpress, plugins

我正在尝试添加插件选项来更新 jquery，但不知道如何做到这一点。我正在使用 wp_enqueue_script() 添加 jquery，因此不允许将 php 函数（ get_option() ）添加到 jquery 代码中。请帮我解决这个问题。

jQuery代码：

```
jQuery(document).ready(function(){

    $cnt = 0;

    jQuery('#add-photo-button').click(function(){

    if($cnt == 3){ // where 3 should replaced with plugin option function/varible
        jQuery('#add-photo-button').prop('disabled', true);
        jQuery('#add-photo-button').addClass('disabled');
    }
    $cnt++;
        var current_count = jQuery('input[type="file"]').length;
        //var next_count = current_count + 1;

        jQuery('#file-upload').prepend('<p><input type="file" name="photo[]" /></p>');    

    });  

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:39:24.377

请参阅[wp_localize_script()](http://codex.wordpress.org/Function_Reference/wp_localize_script)函数。

您必须将您的脚本排入队列，然后本地化（或者更确切地说：将数据作为内联 JavaScript 传递）您想要在 JavaScript 中引用的数据，最后更新您的脚本以引用新本地化的全局对象。请看我下面的例子。

* * *

## 例子

1-将您的脚本排入您的插件中，然后使用`wp_localize_script()`. 确保对两个函数调用使用相同的句柄。

```
<?php

// !! Edit the variables below to suit your plugin

$add_photo_button_handle = 'some_handle';
$add_photo_button_js = plugins_url( '/add_photo_button.js', __FILE__ );

$photo_num = get_option( 'add_photo_button_cnt' ); // Here you fetch the option data.

// Enqueue your script
wp_enqueue_script( $add_photo_button_handle, $add_photo_button_js );

// Set the data you want to pass to your script here
$data = array( 'photo_button_cnt' => $photo_num );

// Localize the script, the 'photo_button_cnt' value will now be accessible as a property in the global 'add_photo_button' object.
wp_localize_script( $add_photo_button_handle, 'add_photo_button', $data );
?> 
```

2-更改脚本以引用本地化对象

```
<script type="text/javascript">
jQuery(document).ready(function(){

    $cnt = 0;

    jQuery('#add-photo-button').click(function(){

    //============================================
    // See how we access the localized object.
    //============================================

    if($cnt == add_photo_button.photo_button_cnt ){ 
        jQuery('#add-photo-button').prop('disabled', true);
        jQuery('#add-photo-button').addClass('disabled');
    }
    $cnt++;
        var current_count = jQuery('input[type="file"]').length;
        //var next_count = current_count + 1;

        jQuery('#file-upload').prepend('<p><input type="file" name="photo[]" /></p>');    

    });  
});
</script> 
```

# ruby-on-rails - 将 ExtJS 与 Rails 资产管道一起使用

> ID：14962016
> 
> 赞同：2
> 
> 时间：2013-02-19T16:09:20.473
> 
> 标签：ruby-on-rails, extjs, asset-pipeline

对于使用 ExtJS 4.1 构建在 Rails (3.1.8) 之上的应用程序，我们有以下文件布局：

```
app/
  assets/
  javascript/
    application.coffee
    WID/
      Lots of coffeescript files and folders.
public/
  extjs/
    ext-all-debug-w-comments.js and the whole ExtJS framework. 
```

我们的应用程序严重依赖 Ext 加载器 (Ext.Require) 来根据用户权限/允许的模块动态加载文件。我们希望尽可能地保留此功能，因此仅从服务器请求所需的文件。带宽并不是真正的问题，因为应用程序是基于 Intranet 的（在 LAN 上）。

在开发环境中，一切运行顺利。然而，在生产环境中，我们遇到了问题。看起来“rake assets:precompile”任务正在将所有文件连接到一个 application.js 文件中，然后在访问我们的应用程序时，Ext 加载程序抱怨它找不到单个文件（因为 assets/WID/... /file.js 没有由 rails 服务器提供服务）。

所以现在，我不确定最好采取什么措施......有没有人能够帮助我们成功地完成 Rails + ExtJS 生产设置，充分利用资产管道？

谢谢，

皮埃尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:18:11.793

我认为当您处于开发环境中时，您应该将您的 javascripts（通常是所有资产）从您的设备中`public`移入。`vendor/assets/javascripts`通过这种方式，资产管道开始负责。

编辑：您可以考虑将清单文件恢复为`application.js`，而不是`application.coffee`. 通常，重命名这些特殊文件是一个坏主意：`application.css`和`application.js`。如果您要添加一些咖啡脚本，只需创建一个新文件并将其放在资产目录中。

# javascript - 检测和修复 JavaScript 中的循环引用

> ID：14962018
> 
> 赞同：78
> 
> 时间：2013-02-19T16:09:28.173
> 
> 标签：javascript

鉴于我在一个大型 JavaScript 对象中有一个循环引用

我尝试`JSON.stringify(problematicObject)`

浏览器抛出

> “TypeError：将循环结构转换为 JSON”

（这是预期的）

那我想找这个循环引用的原因，最好用Chrome开发者工具？这可能吗？如何在大对象中查找和修复循环引用？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-02-19T16:29:39.100

从[http://blog.vjeux.com/2011/javascript/cyclic-object-detection.html](http://blog.vjeux.com/2011/javascript/cyclic-object-detection.html)中提取。添加了一行来检测循环在哪里。将其粘贴到 Chrome 开发工具中：

```
function isCyclic (obj) {
  var seenObjects = [];

  function detect (obj) {
    if (obj && typeof obj === 'object') {
      if (seenObjects.indexOf(obj) !== -1) {
        return true;
      }
      seenObjects.push(obj);
      for (var key in obj) {
        if (obj.hasOwnProperty(key) && detect(obj[key])) {
          console.log(obj, 'cycle at ' + key);
          return true;
        }
      }
    }
    return false;
  }

  return detect(obj);
} 
```

这是测试：

```
> a = {}
> b = {}
> a.b = b; b.a = a;
> isCyclic(a)
  Object {a: Object}
   "cycle at a"
  Object {b: Object}
   "cycle at b"
  true 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2016-01-20T19:45:42.847

当我发现这个问题时，@tmack 的答案绝对是我想要的！

不幸的是，它会返回许多误报——如果在 JSON 中复制了一个对象，它会返回 true，这**与**循环性不同。圆形意味着一个对象是它自己的孩子，例如

```
obj.key1.key2.[...].keyX === obj 
```

我修改了原始答案，这对我有用：

```
function isCyclic(obj) {
  var keys = [];
  var stack = [];
  var stackSet = new Set();
  var detected = false;

  function detect(obj, key) {
    if (obj && typeof obj != 'object') { return; }

    if (stackSet.has(obj)) { // it's cyclic! Print the object and its locations.
      var oldindex = stack.indexOf(obj);
      var l1 = keys.join('.') + '.' + key;
      var l2 = keys.slice(0, oldindex + 1).join('.');
      console.log('CIRCULAR: ' + l1 + ' = ' + l2 + ' = ' + obj);
      console.log(obj);
      detected = true;
      return;
    }

    keys.push(key);
    stack.push(obj);
    stackSet.add(obj);
    for (var k in obj) { //dive on the object's children
      if (Object.prototype.hasOwnProperty.call(obj, k)) { detect(obj[k], k); }
    }

    keys.pop();
    stack.pop();
    stackSet.delete(obj);
    return;
  }

  detect(obj, 'obj');
  return detected;
} 
```

以下是一些非常简单的测试：

```
var root = {}
var leaf = {'isleaf':true};
var cycle2 = {l:leaf};
var cycle1 = {c2: cycle2, l:leaf};
cycle2.c1 = cycle1
root.leaf = leaf

isCyclic(cycle1); // returns true, logs "CIRCULAR: obj.c2.c1 = obj"
isCyclic(cycle2); // returns true, logs "CIRCULAR: obj.c1.c2 = obj"
isCyclic(leaf); // returns false
isCyclic(root); // returns false 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-01-21T03:50:40.950

`JSON.stringify()`以下是 MDN在循环对象上使用时检测和修复循环引用的方法： [https](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value) ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value ：

> 在如下的圆形结构中

```
var circularReference = {otherData: 123};
circularReference.myself = circularReference; 
```

> `JSON.stringify()`将失败：

```
JSON.stringify(circularReference);
// TypeError: cyclic object value 
```

> 要序列化循环引用，您可以使用支持它们的库（例如[cycle.js](https://github.com/douglascrockford/JSON-js/blob/master/cycle.js)）或自己实现解决方案，这需要通过可序列化的值查找和替换（或删除）循环引用。
> 
> 下面的代码片段说明了如何使用[以下的 replacer 参数查找和过滤（](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_replacer_parameter)***从而导致数据丢失***）循环引用：[`JSON.stringify()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_replacer_parameter)

```
const getCircularReplacer = () => {
      const seen = new WeakSet();
      return (key, value) => {
        if (typeof value === "object" && value !== null) {
          if (seen.has(value)) {
            return;
          }
          seen.add(value);
        }
        return value;
      };
    };

JSON.stringify(circularReference, getCircularReplacer());
// {"otherData":123} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-04-24T06:42:10.527

您也可以使用`JSON.stringify`try **/catch**

```
function hasCircularDependency(obj)
{
    try
    {
        JSON.stringify(obj);
    }
    catch(e)
    {
        return e.includes("Converting circular structure to JSON"); 
    }
    return false;
} 
```

**演示**

```
function hasCircularDependency(obj) {
  try {
    JSON.stringify(obj);
  } catch (e) {
    return String(e).includes("Converting circular structure to JSON");
  }
  return false;
}

var a = {b:{c:{d:""}}};
console.log(hasCircularDependency(a));
a.b.c.d = a;
console.log(hasCircularDependency(a));
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-09-11T19:43:21.317

# 循环参考检测器

这是我的*CircularReferenceDetector*类，它输出循环引用值实际所在的所有属性堆栈信息，并显示罪魁祸首引用的位置。

这对于巨大的结构特别有用，在这些结构中，哪个值是伤害的来源不是很明显。

它输出字符串化的循环引用值，但所有对自身的引用都替换为“[Circular object --- fix me]”。

**用法：**
`CircularReferenceDetector.detectCircularReferences(value);`

**注意：** 如果您不想使用任何日志记录或没有可用的记录器，请删除 Logger.* 语句。

**技术说明：**
递归函数遍历对象的所有属性并测试 JSON.stringify 是否成功。如果它不成功（循环引用），那么它通过用一些常量字符串替换 value 本身来测试它是否成功。这意味着如果它成功使用这个替换器，这个值就是循环引用的值。如果不是，它将递归地遍历该对象的所有属性。

同时它还跟踪属性堆栈，为您提供罪魁祸首值所在的信息。

# 打字稿

```
import {Logger} from "../Logger";

export class CircularReferenceDetector {

    static detectCircularReferences(toBeStringifiedValue: any, serializationKeyStack: string[] = []) {
        Object.keys(toBeStringifiedValue).forEach(key => {
            var value = toBeStringifiedValue[key];

            var serializationKeyStackWithNewKey = serializationKeyStack.slice();
            serializationKeyStackWithNewKey.push(key);
            try {
                JSON.stringify(value);
                Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" is ok`);
            } catch (error) {
                Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" JSON.stringify results in error: ${error}`);

                var isCircularValue:boolean;
                var circularExcludingStringifyResult:string = "";
                try {
                    circularExcludingStringifyResult = JSON.stringify(value, CircularReferenceDetector.replaceRootStringifyReplacer(value), 2);
                    isCircularValue = true;
                } catch (error) {
                    Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" is not the circular source`);
                    CircularReferenceDetector.detectCircularReferences(value, serializationKeyStackWithNewKey);
                    isCircularValue = false;
                }
                if (isCircularValue) {
                    throw new Error(`Circular reference detected:\nCircularly referenced value is value under path "${Util.joinStrings(serializationKeyStackWithNewKey)}" of the given root object\n`+
                        `Calling stringify on this value but replacing itself with [Circular object --- fix me] ( <-- search for this string) results in:\n${circularExcludingStringifyResult}\n`);
                }
            }
        });
    }

    private static replaceRootStringifyReplacer(toBeStringifiedValue: any): any {
        var serializedObjectCounter = 0;

        return function (key: any, value: any) {
            if (serializedObjectCounter !== 0 && typeof(toBeStringifiedValue) === 'object' && toBeStringifiedValue === value) {
                Logger.error(`object serialization with key ${key} has circular reference to being stringified object`);
                return '[Circular object --- fix me]';
            }

            serializedObjectCounter++;

            return value;
        }
    }
}

export class Util {

    static joinStrings(arr: string[], separator: string = ":") {
        if (arr.length === 0) return "";
        return arr.reduce((v1, v2) => `${v1}${separator}${v2}`);
    }

} 
```

# 从 TypeScript 编译的 JavaScript

```
"use strict";
const Logger_1 = require("../Logger");
class CircularReferenceDetector {
    static detectCircularReferences(toBeStringifiedValue, serializationKeyStack = []) {
        Object.keys(toBeStringifiedValue).forEach(key => {
            var value = toBeStringifiedValue[key];
            var serializationKeyStackWithNewKey = serializationKeyStack.slice();
            serializationKeyStackWithNewKey.push(key);
            try {
                JSON.stringify(value);
                Logger_1.Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" is ok`);
            }
            catch (error) {
                Logger_1.Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" JSON.stringify results in error: ${error}`);
                var isCircularValue;
                var circularExcludingStringifyResult = "";
                try {
                    circularExcludingStringifyResult = JSON.stringify(value, CircularReferenceDetector.replaceRootStringifyReplacer(value), 2);
                    isCircularValue = true;
                }
                catch (error) {
                    Logger_1.Logger.debug(`path "${Util.joinStrings(serializationKeyStack)}" is not the circular source`);
                    CircularReferenceDetector.detectCircularReferences(value, serializationKeyStackWithNewKey);
                    isCircularValue = false;
                }
                if (isCircularValue) {
                    throw new Error(`Circular reference detected:\nCircularly referenced value is value under path "${Util.joinStrings(serializationKeyStackWithNewKey)}" of the given root object\n` +
                        `Calling stringify on this value but replacing itself with [Circular object --- fix me] ( <-- search for this string) results in:\n${circularExcludingStringifyResult}\n`);
                }
            }
        });
    }
    static replaceRootStringifyReplacer(toBeStringifiedValue) {
        var serializedObjectCounter = 0;
        return function (key, value) {
            if (serializedObjectCounter !== 0 && typeof (toBeStringifiedValue) === 'object' && toBeStringifiedValue === value) {
                Logger_1.Logger.error(`object serialization with key ${key} has circular reference to being stringified object`);
                return '[Circular object --- fix me]';
            }
            serializedObjectCounter++;
            return value;
        };
    }
}
exports.CircularReferenceDetector = CircularReferenceDetector;
class Util {
    static joinStrings(arr, separator = ":") {
        if (arr.length === 0)
            return "";
        return arr.reduce((v1, v2) => `${v1}${separator}${v2}`);
    }
}
exports.Util = Util; 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-12-22T21:37:59.500

这是**@Trey Mack**和**@Freddie Nfbnm**在`typeof obj != 'object'`条件下的答案的修复。相反，它应该测试该`obj`值是否不是对象的实例，以便它在检查熟悉对象的值时也可以工作（例如，函数~~和符号~~（符号不是对象的实例，但仍然可以解决，顺便说一句。））。

我将其发布为答案，因为我还不能在此 StackExchange 帐户中发表评论。

PS.：随时要求我删除此答案。

```
function isCyclic(obj) {
  var keys = [];
  var stack = [];
  var stackSet = new Set();
  var detected = false;

  function detect(obj, key) {
    if (!(obj instanceof Object)) { return; } // Now works with other
                                              // kinds of object.

    if (stackSet.has(obj)) { // it's cyclic! Print the object and its locations.
      var oldindex = stack.indexOf(obj);
      var l1 = keys.join('.') + '.' + key;
      var l2 = keys.slice(0, oldindex + 1).join('.');
      console.log('CIRCULAR: ' + l1 + ' = ' + l2 + ' = ' + obj);
      console.log(obj);
      detected = true;
      return;
    }

    keys.push(key);
    stack.push(obj);
    stackSet.add(obj);
    for (var k in obj) { //dive on the object's children
      if (obj.hasOwnProperty(k)) { detect(obj[k], k); }
    }

    keys.pop();
    stack.pop();
    stackSet.delete(obj);
    return;
  }

  detect(obj, 'obj');
  return detected;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-06-20T09:43:21.473

[这是由@Aaron V](https://stackoverflow.com/a/34909127/3305789)和[@user4976005](https://stackoverflow.com/a/41292020/3305789)的答案混合而成的Node ES6 版本，它解决了调用hasOwnProperty 的问题：

```
const isCyclic = (obj => {
  const keys = []
  const stack = []
  const stackSet = new Set()
  let detected = false

  const detect = ((object, key) => {
    if (!(object instanceof Object))
      return

    if (stackSet.has(object)) { // it's cyclic! Print the object and its locations.
      const oldindex = stack.indexOf(object)
      const l1 = `${keys.join('.')}.${key}`
      const l2 = keys.slice(0, oldindex + 1).join('.')
      console.log(`CIRCULAR: ${l1} = ${l2} = ${object}`)
      console.log(object)
      detected = true
      return
    }

    keys.push(key)
    stack.push(object)
    stackSet.add(object)
    Object.keys(object).forEach(k => { // dive on the object's children
      if (k && Object.prototype.hasOwnProperty.call(object, k))
        detect(object[k], k)
    })

    keys.pop()
    stack.pop()
    stackSet.delete(object)
  })

  detect(obj, 'obj')
  return detected
}) 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-04-06T01:36:19.743

这里有很多答案，但我想我会将我的解决方案添加到组合中。它类似于[@Trey Mack](https://stackoverflow.com/users/237012/trey-mack)的答案，但该解决方案需要 O(n^2)。此版本使用`WeakMap`而不是数组，将时间缩短到 O(n)。

```
function isCyclic(object) {
   const seenObjects = new WeakMap(); // use to keep track of which objects have been seen.

   function detectCycle(obj) {
      // If 'obj' is an actual object (i.e., has the form of '{}'), check
      // if it's been seen already.
      if (Object.prototype.toString.call(obj) == '[object Object]') {

         if (seenObjects.has(obj)) {
            return true;
         }

         // If 'obj' hasn't been seen, add it to 'seenObjects'.
         // Since 'obj' is used as a key, the value of 'seenObjects[obj]'
         // is irrelevent and can be set as literally anything you want. I 
         // just went with 'undefined'.
         seenObjects.set(obj, undefined);

         // Recurse through the object, looking for more circular references.
         for (var key in obj) {
            if (detectCycle(obj[key])) {
               return true;
            }
         }

      // If 'obj' is an array, check if any of it's elements are
      // an object that has been seen already.
      } else if (Array.isArray(obj)) {
         for (var i in obj) {
            if (detectCycle(obj[i])) {
               return true;
            }
         }
      }

      return false;
   }

   return detectCycle(object);
} 
```

这就是它在行动中的样子。

```
> var foo = {grault: {}};
> detectCycle(foo);
false
> foo.grault = foo;
> detectCycle(foo);
true
> var bar = {};
> detectCycle(bar);
false
> bar.plugh = [];
> bar.plugh.push(bar);
> detectCycle(bar);
true 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-03-16T19:05:02.393

您还可以使用符号 - 由于这种方法，您不必改变原始对象的属性，除了添加符号来标记访问节点。

它更干净，应该比收集节点属性并与对象进行比较更快。如果您不想序列化大的嵌套值，它还具有可选的深度限制：

```
// Symbol used to mark already visited nodes - helps with circular dependencies
const visitedMark = Symbol('VISITED_MARK');

const MAX_CLEANUP_DEPTH = 10;

function removeCirculars(obj, depth = 0) {
  if (!obj) {
    return obj;
  }

  // Skip condition - either object is falsy, was visited or we go too deep
  const shouldSkip = !obj || obj[visitedMark] || depth > MAX_CLEANUP_DEPTH;

  // Copy object (we copy properties from it and mark visited nodes)
  const originalObj = obj;
  let result = {};

  Object.keys(originalObj).forEach((entry) => {
    const val = originalObj[entry];

    if (!shouldSkip) {
      if (typeof val === 'object') { // Value is an object - run object sanitizer
        originalObj[visitedMark] = true; // Mark current node as "seen" - will stop from going deeper into circulars
        const nextDepth = depth + 1;
        result[entry] = removeCirculars(val, nextDepth);
      } else {
        result[entry] = val;
      }
    } else {
      result = 'CIRCULAR';
    }
  });

  return result;
} 
```

这将导致对象的所有循环依赖项都被剥离，并且不会比给定的更深`MAX_CLEANUP_DEPTH`。

只要您不对对象执行任何元编程操作，使用符号是安全的 - 它们是透明的并且不可枚举，因此 - 它们不会显示在对象的任何标准操作中。

此外，如果您需要对其执行任何其他操作，则返回一个新的、已清理的对象具有不会改变原始对象的优点。

如果您不想`CIRCULAR`标记，您可以稍微修改代码，因此在实际执行操作之前跳过对象（在循环内）：

```
 originalObj[visitedMark] = true; // Mark current node as "seen" - will stop from going deeper into circulars
 const val = originalObj[entry];

 // Skip condition - either object is falsy, was visited or we go too deep
 const shouldSkip = val[visitedMark] || depth > MAX_SANITIZATION_DEPTH;

 if (!shouldSkip) {
   if (typeof val === 'object') { // Value is an object - run object sanitizer
    const nextDepth = depth + 1;
    result[entry] = removeCirculars(val, nextDepth);
  } else {
    result[entry] = val;
  }
 } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-19T16:26:25.297

我刚做了这个。它可能很脏，但无论如何都可以使用...：P

```
function dump(orig){
  var inspectedObjects = [];
  console.log('== DUMP ==');
  (function _dump(o,t){
    console.log(t+' Type '+(typeof o));
    for(var i in o){
      if(o[i] === orig){
        console.log(t+' '+i+': [recursive]'); 
        continue;
      }
      var ind = 1+inspectedObjects.indexOf(o[i]);
      if(ind>0) console.log(t+' '+i+':  [already inspected ('+ind+')]');
      else{
        console.log(t+' '+i+': ('+inspectedObjects.push(o[i])+')');
        _dump(o[i],t+'>>');
      }
    }
  }(orig,'>'));
} 
```

然后

```
var a = [1,2,3], b = [a,4,5,6], c = {'x':a,'y':b};
a.push(c); dump(c); 
```

说

```
== DUMP ==
> Type object
> x: (1)
>>> Type object
>>> 0: (2)
>>>>> Type number
>>> 1: (3)
>>>>> Type number
>>> 2: (4)
>>>>> Type number
>>> 3: [recursive]
> y: (5)
>>> Type object
>>> 0:  [already inspected (1)]
>>> 1: (6)
>>>>> Type number
>>> 2: (7)
>>>>> Type number
>>> 3: (8)
>>>>> Type number 
```

这表明 cx[3] 等于 c，并且 cx = cy[0]。

或者，对这个函数进行一点编辑可以告诉你你需要什么......

```
function findRecursive(orig){
  var inspectedObjects = [];
  (function _find(o,s){
    for(var i in o){
      if(o[i] === orig){
        console.log('Found: obj.'+s.join('.')+'.'+i); 
        return;
      }
      if(inspectedObjects.indexOf(o[i])>=0) continue;
      else{
        inspectedObjects.push(o[i]);
        s.push(i); _find(o[i],s); s.pop(i);
      }
    }
  }(orig,[]));
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-28T05:02:39.847

我将 Freddie Nfbnm 的答案转换为 TypeScript：

```
export class JsonUtil {

    static isCyclic(json) {
        const keys = [];
        const stack = [];
        const stackSet = new Set();
        let detected = false;

        function detect(obj, key) {
            if (typeof obj !== 'object') {
                return;
            }

            if (stackSet.has(obj)) { // it's cyclic! Print the object and its locations.
                const oldIndex = stack.indexOf(obj);
                const l1 = keys.join('.') + '.' + key;
                const l2 = keys.slice(0, oldIndex + 1).join('.');
                console.log('CIRCULAR: ' + l1 + ' = ' + l2 + ' = ' + obj);
                console.log(obj);
                detected = true;
                return;
            }

            keys.push(key);
            stack.push(obj);
            stackSet.add(obj);
            for (const k in obj) { // dive on the object's children
                if (obj.hasOwnProperty(k)) {
                    detect(obj[k], k);
                }
            }

            keys.pop();
            stack.pop();
            stackSet.delete(obj);
            return;
        }

        detect(json, 'obj');
        return detected;
    }

} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-02T01:58:47.067

只是为了把我的版本混在一起......下面是[@dkurzaj 代码](https://stackoverflow.com/a/50945094/235704)的混音（它本身是@Aaron V、@user4976005、@Trey Mack 和最后@Freddie Nfbnm 的混音） s [删除？] 代码）加上[@darksinge 的`WeakMap`想法](https://stackoverflow.com/a/55545121/235704)。所以......我猜这个线程的Megamix :)

在我的版本中，可以选择将报告（而不是`console.log`'ed 条目）作为对象数组返回。如果不需要报告，则在第一次看到循环引用（a'la @darksinge 的代码）时停止测试。

此外，`hasOwnProperty`已被删除为`Object.keys`仅返回`hasOwnProperty`属性（请参阅：[https](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys ）。

```
function isCyclic(x, bReturnReport) {
    var a_sKeys = [],
        a_oStack = [],
        wm_oSeenObjects = new WeakMap(), //# see: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap
        oReturnVal = {
            found: false,
            report: []
        }
    ;

    //# Setup the recursive logic to locate any circular references while kicking off the initial call
    (function doIsCyclic(oTarget, sKey) {
        var a_sTargetKeys, sCurrentKey, i;

        //# If we've seen this oTarget before, flip our .found to true
        if (wm_oSeenObjects.has(oTarget)) {
            oReturnVal.found = true;

            //# If we are to bReturnReport, add the entries into our .report
            if (bReturnReport) {
                oReturnVal.report.push({
                    instance: oTarget,
                    source: a_sKeys.slice(0, a_oStack.indexOf(oTarget) + 1).join('.'),
                    duplicate: a_sKeys.join('.') + "." + sKey
                });
            }
        }
        //# Else if oTarget is an instanceof Object, determine the a_sTargetKeys and .set our oTarget into the wm_oSeenObjects
        else if (oTarget instanceof Object) {
            a_sTargetKeys = Object.keys(oTarget);
            wm_oSeenObjects.set(oTarget /*, undefined*/);

            //# If we are to bReturnReport, .push the  current level's/call's items onto our stacks
            if (bReturnReport) {
                if (sKey) { a_sKeys.push(sKey) };
                a_oStack.push(oTarget);
            }

            //# Traverse the a_sTargetKeys, pulling each into sCurrentKey as we go
            //#     NOTE: If you want all properties, even non-enumerables, see Object.getOwnPropertyNames() so there is no need to call .hasOwnProperty (per: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)
            for (i = 0; i < a_sTargetKeys.length; i++) {
                sCurrentKey = a_sTargetKeys[i];

                //# If we've already .found a circular reference and we're not bReturnReport, fall from the loop
                if (oReturnVal.found && !bReturnReport) {
                    break;
                }
                //# Else if the sCurrentKey is an instanceof Object, recurse to test
                else if (oTarget[sCurrentKey] instanceof Object) {
                    doIsCyclic(oTarget[sCurrentKey], sCurrentKey);
                }
            }

            //# .delete our oTarget into the wm_oSeenObjects
            wm_oSeenObjects.delete(oTarget);

            //# If we are to bReturnReport, .pop the current level's/call's items off our stacks
            if (bReturnReport) {
                if (sKey) { a_sKeys.pop() };
                a_oStack.pop();
            }
        }
    }(x, '')); //# doIsCyclic

    return (bReturnReport ? oReturnVal.report : oReturnVal.found);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-30T14:08:16.657

这是适用于节点[的@Thomas 答案：](https://stackoverflow.com/a/39439980/39396)

```
const {logger} = require("../logger")
// Or: const logger = {debug: (...args) => console.log.call(console.log, args) }

const joinStrings = (arr, separator) => {
  if (arr.length === 0) return "";
  return arr.reduce((v1, v2) => `${v1}${separator}${v2}`);
}

exports.CircularReferenceDetector = class CircularReferenceDetector {

  detectCircularReferences(toBeStringifiedValue, serializationKeyStack = []) {
    Object.keys(toBeStringifiedValue).forEach(key => {
      let value = toBeStringifiedValue[key];

      let serializationKeyStackWithNewKey = serializationKeyStack.slice();
      serializationKeyStackWithNewKey.push(key);
      try {
        JSON.stringify(value);
        logger.debug(`path "${joinStrings(serializationKeyStack)}" is ok`);
      } catch (error) {
        logger.debug(`path "${joinStrings(serializationKeyStack)}" JSON.stringify results in error: ${error}`);

        let isCircularValue;
        let circularExcludingStringifyResult = "";
        try {
          circularExcludingStringifyResult = JSON.stringify(value, this.replaceRootStringifyReplacer(value), 2);
          isCircularValue = true;
        } catch (error) {
          logger.debug(`path "${joinStrings(serializationKeyStack)}" is not the circular source`);
          this.detectCircularReferences(value, serializationKeyStackWithNewKey);
          isCircularValue = false;
        }
        if (isCircularValue) {
          throw new Error(`Circular reference detected:\nCircularly referenced value is value under path "${joinStrings(serializationKeyStackWithNewKey)}" of the given root object\n`+
              `Calling stringify on this value but replacing itself with [Circular object --- fix me] ( <-- search for this string) results in:\n${circularExcludingStringifyResult}\n`);
        }
      }
    });
  }

  replaceRootStringifyReplacer(toBeStringifiedValue) {
    let serializedObjectCounter = 0;

    return function (key, value) {
      if (serializedObjectCounter !== 0 && typeof(toBeStringifiedValue) === 'object' && toBeStringifiedValue === value) {
        logger.error(`object serialization with key ${key} has circular reference to being stringified object`);
        return '[Circular object --- fix me]';
      }

      serializedObjectCounter++;

      return value;
    }
  }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-09-18T08:58:04.793

大多数其他答案仅显示如何*检测*对象树具有循环引用 - 他们没有告诉您如何*修复*这些循环引用（即用例如替换循环引用值`undefined`）。

以下是我用来替换所有循环引用的函数`undefined`：

```
export const specialTypeHandlers_default = [
    // Set and Map are included by default, since JSON.stringify tries (and fails) to serialize them by default
    {type: Set, keys: a=>a.keys(), get: (a, key)=>key, delete: (a, key)=>a.delete(key)},
    {type: Map, keys: a=>a.keys(), get: (a, key)=>a.get(key), delete: (a, key)=>a.set(key, undefined)},
];
export function RemoveCircularLinks(node, specialTypeHandlers = specialTypeHandlers_default, nodeStack_set = new Set()) {
    nodeStack_set.add(node);

    const specialHandler = specialTypeHandlers.find(a=>node instanceof a.type);
    for (const key of specialHandler ? specialHandler.keys(node) : Object.keys(node)) {
        const value = specialHandler ? specialHandler.get(node, key) : node[key];
        // if the value is already part of visited-stack, delete the value (and don't tunnel into it)
        if (nodeStack_set.has(value)) {
            if (specialHandler) specialHandler.delete(node, key);
            else node[key] = undefined;
        }
        // else, tunnel into it, looking for circular-links at deeper levels
        else if (typeof value == "object" && value != null) {
            RemoveCircularLinks(value, specialTypeHandlers, nodeStack_set);
        }
    }

    nodeStack_set.delete(node);
} 
```

具体而言`JSON.stringify`，只需在字符串化之前调用上面的函数（注意它*确实会*改变传入的对象）：

```
const objTree = {normalProp: true};
objTree.selfReference = objTree;
RemoveCircularLinks(objTree); // without this line, the JSON.stringify call errors
console.log(JSON.stringify(objTree)); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-01-18T09:40:19.580

如果您只需要查看该圆形对象的内容，只需使用 console.table(circularObj)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-02-19T16:11:34.153

尝试`console.log()`在 chrome/firefox 浏览器上使用以确定问题所在。

在使用 Firebug 插件的 Firefox 上，您可以逐行调试您的 javascript。

## 更新：

请参阅下面的循环引用问题示例并已处理：-

```
// JSON.stringify, avoid TypeError: Converting circular structure to JSON
// Demo: Circular reference
var o = {};
o.o = o;

var cache = [];
JSON.stringify(o, function(key, value) {
    if (typeof value === 'object' && value !== null) {
        if (cache.indexOf(value) !== -1) {
            // Circular reference found, discard key
            alert("Circular reference found, discard key");
            return;
        }
        alert("value = '" + value + "'");
        // Store value in our collection
        cache.push(value);
    }
    return value;
});
cache = null; // Enable garbage collection

var a = {b:1};
var o = {};
o.one = a;
o.two = a;
// one and two point to the same object, but two is discarded:
JSON.stringify(o);

var obj = {
  a: "foo",
  b: obj
};

var replacement = {"b":undefined};

alert("Result : " + JSON.stringify(obj,replacement)); 
```

参考示例**[LIVE DEMO](http://jsfiddle.net/SivaCharan/AsPK7/)**

# linux - Ant可以修改Linux文件权限吗

> ID：14962019
> 
> 赞同：3
> 
> 时间：2013-02-19T16:09:29.337
> 
> 标签：linux, ant, installation, debian, file-permissions

有没有办法在**Linux中使用****Ant**设置文件所有权和权限？我找到了**Ant**和任务，但它们仅适用于 Unix。 我正在尝试通过**Ant**和**ant-deb-task**添加 Debian 安装程序，在将所有必需的文件移动到部署目录后，我需要设置它们的所有权和权限。 ****`chmod``chown`**** 

 ******* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-09T19:23:33.537

使用内置的 Ant chmod 任务 - [http://ant.apache.org/manual/Tasks/chmod.html](http://ant.apache.org/manual/Tasks/chmod.html)

单个文件：

```
<chmod file="${dist}/start.sh" perm="ugo+rx"/> 
```

多个文件：

```
<chmod perm="g+w">
  <fileset dir="shared/sources1">
    <exclude name="**/trial/**"/>
  </fileset>
</chmod> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:14:14.300

我目前无法在 Linux 上访问 Ant（将在家里进行）但尝试看看这是否有效

```
<target name="chmod_task">
  <exec executable="chmod">
    <arg value="755"/>
    <arg value="/path/filename.ext"/>
  </exec>
</target> 
```******

# ms-access - 在 ms 访问中以编程方式更改 RecordsetType 或更好的方法

> ID：14962021
> 
> 赞同：1
> 
> 时间：2013-02-19T16:09:31.220
> 
> 标签：ms-access, vba, recordset

在 ms 访问中，我有一个表单，它也有一个子表单。当子表/子表单具有一对多关系中的关联记录时，我想以编程方式将主表单中的 RecordsetType 更改为快照。我写了一些 vba 代码来做到这一点，但我遇到了一些非常奇怪的行为。

然后我发现这是因为当我更改 RecordsetType 时，表单会刷新并导航回第一条记录。然后，这会导致 On Current 事件和相关代码在子表单和主表单中触发两次。我正在考虑使用 DoCmd.SearchForRecord 导航回原始记录，但很快意识到它不起作用，因为 DoCmd.SearchForRecord 中的 WHERE 条件在事件第二次触发时被覆盖。无论如何，这一切都显得如此低效。

还有其他方法可以做我想做的事情吗？我真的不想将表单中的控件设置为“禁用”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:01:10.750

MS Access 有一系列适合的表单属性：AllowEdits、AllowDeletions 和 AllowAdditions。这些可以单独设置或一起设置。在这种情况下，您似乎需要将 AllowAddition 设置为 Yes 并将 AllowEdits 设置为 No。

![表单属性](../Images/4a7673c84e27aa90e710968d47812ccc.png)

# c++ - GCC - 类型声明的确切位置

> ID：14962022
> 
> 赞同：1
> 
> 时间：2013-02-19T16:09:33.033
> 
> 标签：c++, gcc, crash, segmentation-fault, libuv

我有一个依赖于[libuv](http://github.com/joyent/libuv)库（C 代码）的 C++ 代码。由于段错误，它崩溃了。我缩小了问题范围：[libuv](http://github.com/joyent/libuv)使用`struct stat`from `<sys/stat.h>`. 如果我在代码中打印此结构的大小：

```
printf("struct stat size: %d\n", sizeof(struct stat)); 
```

它显示 88。如果我在 libuv 库中打印相同的内容，它显示 96。这是段错误的原因。我有点卡在这里。如何找到类型声明的确切位置？还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:24:53.147

您可以使用 预处理源`cc -E xxx.c`，并在其中查找有问题的定义。预处理中的`#file`and指令将指向你的罪魁祸首的大致位置。或者只是在一开始（在库中的任何东西之前），编译器应该尖叫你重新定义;-)`#line``xxx.i``#include <sys/stat.h>``struct`

# c++ - linux的gethostbyname函数的独立源码

> ID：14962024
> 
> 赞同：0
> 
> 时间：2013-02-19T16:09:43.017
> 
> 标签：c++, linux, dns

我在哪里可以获得`gethostbyname`可以使用的源代码，而无需为 linux 链接其他库（只是套接字）？

我发现了这个： [https ://github.com/gnif/ARMT/blob/master/common/CDNS.cc](https://github.com/gnif/ARMT/blob/master/common/CDNS.cc)

但这不起作用，解决时出错

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:24:30.153

“单个 .c 文件中的非阻塞 DNS 解析器库。支持存根和递归模式。”

[http://25thandclement.com/~william/projects/dns.c.html](http://25thandclement.com/~william/projects/dns.c.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:15:40.687

DNS解析很复杂。为什么*不*使用图书馆？当我需要时，我会使用 c-ares。

如果您不想将其用作库，则可以将其所有源代码文件直接填充到您的项目中，尽管这很奇怪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:19:20.143

`gethostbyname`绝非易事，因为它必须找出当前为此类数据配置的源是什么（本地文件、NIS、NIS+、DNS，也许还有其他），按什么顺序在那里搜索，如果查找每个文件该怎么办失败（`nsswitch.conf(5)`等人），并进行查找和杂项簿记和缓存。

# c# - 为什么我这里有锁？

> ID：14962030
> 
> 赞同：21
> 
> 时间：2013-02-19T16:09:57.447
> 
> 标签：c#, .net, multithreading, performance, locking

请参阅以下表示并行 foreach 完成的工作的并发性能分析：

![在此处输入图像描述](../Images/ba96b15b44da2b61c258debab4e70cb8.png)

在循环内部，每个线程从数据库中读取数据并进行处理。线程之间没有锁，因为每个线程处理不同的数据。

由于未知原因，foreach 的所有线程中似乎都存在周期性锁（参见黑色垂直矩形）。如果您看到选定的锁定段（深红色段），您将看到堆栈显示在 StockModel.Quotation 构造函数中锁定的线程。那里的代码只是构造了两个空列表！

我在某处读到这可能是由 GC 引起的，因此我将垃圾收集更改为在服务器模式下运行：

```
<runtime>
    <gcServer enabled="true"/>
</runtime> 
```

我有一个小的改进（大约快 10% - 15%），但我仍然到处都有垂直锁。

我还在所有数据库查询中添加了 WITH(NOLOCK)，因为我只读取数据而没有任何区别。

关于这里发生了什么的任何提示？

进行分析的计算机有 8 个内核。

**编辑：**启用 Microsoft 符号服务器后，所有线程都在调用 wait_gor_gc_done 或 WaitUntilGCComplete 时被阻塞。我认为启用 GCServer 我为每个线程都有一个 GC，因此我会避免“垂直”锁定，但似乎并非如此。我错了吗？

第二个问题：由于机器没有内存压力（使用了 8 个 gigs 中的 5 个），有没有办法延迟 GC 执行或暂停它直到并行 foreach 结束（或将其配置为较少触发）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:29:15.703

如果您的 StockModel.Quotation 类允许，您可以创建一个池来限制创建的新对象的数量。这是他们有时在游戏中使用的一种技术，以防止垃圾收集器在渲染过程中停止。

这是一个基本的池实现：

```
 class StockQuotationPool
    {

        private List<StockQuotation> poolItems;
        private volatile int itemsInPool;

        public StockQuotationPool(int poolSize)
        {
            this.poolItems = new List<StockQuotation>(poolSize);
            this.itemsInPool = poolSize;

        }

        public StockQuotation Create(string name, decimal value)
        {
            if (this.itemsInPool == 0)
            {
                // Block until new item ready - maybe use semaphore.
                throw new NotImplementedException();
            }

            // Items are in the pool, but no items have been created.
            if (this.poolItems.Count == 0)
            {
                this.itemsInPool--;
                return new StockQuotation(name, value);
            }

            // else, return one in the pool
            this.itemsInPool--;

            var item = this.poolItems[0];
            this.poolItems.Remove(item);

            item.Name = name;
            item.Value = value;

            return item;
        }

        public void Release(StockQuotation quote)
        {
            if (!this.poolItems.Contains(quote)
            {
                this.poolItems.Add(quote);
                this.itemsInPool++;
            }
        }

    } 
```

假设 StockQuotation 看起来像这样：

```
 class StockQuotation
    {
        internal StockQuotation(string name, decimal value)
        {
            this.Name = name;
            this.Value = value;
        }

        public string Name { get; set; }
        public decimal Value { get; set; }
    } 
```

然后，您无需调用新的 StockQuotation() 构造函数，而是向池请求一个新实例。池返回一个现有实例（如果需要，您可以预先创建它们）并设置所有属性，使其看起来像一个新实例。您可能需要反复尝试，直到找到足够大的池大小以同时容纳线程。

这是您从线程中调用它的方式。

```
 // Get the pool, maybe from a singleton.
    var pool = new StockQuotationPool(100);

    var quote = pool.Create("test", 1.00m);

    try
    {
        // Work with quote

    }
    finally
    {
        pool.Release(quote);
    } 
```

最后，这个类目前不是线程安全的。如果您需要任何帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:17:46.133

您可以尝试`GCLatencyMode.LowLatency;`在此处使用查看相关问题：[Prevent .NET Garbage collection for short period of time](https://stackoverflow.com/questions/6005865/prevent-net-garbage-collection-for-short-period-of-time)

我最近尝试过这个没有运气。在我正在显示的表单上缓存图标大小的位图图像时，仍在调用垃圾收集。对我有用的是使用 Ants 性能分析器和反射器来查找导致 GC.Collect 的确切调用并解决它。

# c# - 通过套接字接收/发送数据不完全工作，只接收一次值

> ID：14962031
> 
> 赞同：0
> 
> 时间：2013-02-19T16:10:05.187
> 
> 标签：c#, sockets

这是从客户端接收值的函数。但问题是我只收到一次。无论我发送多少次数据，MainWindows 上的标签都只会更改一次。

我在这里做错了什么？

```
private void HandleClientComm(object client)
{
    tcpClient = (TcpClient)client;
    NetworkStream clientStream = tcpClient.GetStream();

    byte[] message = new byte[4096];
    int bytesRead;

    while (true)
    {
        bytesRead = 0;

        try
        {
            bytesRead = clientStream.Read(message, 0, 4096);
        }
        catch
        {
            break;
        }

        if (bytesRead == 0)
        {
            break;
        }

        if (String.IsNullOrWhiteSpace(data))
        {
            ASCIIEncoding encoder = new ASCIIEncoding();
            data = encoder.GetString(message, 0, bytesRead);

            MainWindow.Change(data);
            tcpClient.Close();
        }

        tcpClient.Close();

    } 
```

在客户端，我有以下示例：

```
try
{
    TcpClient tcpclnt = new TcpClient();
    Console.WriteLine("Connecting.....");
    tcpclnt.Connect("127.0.0.1", 8001);
    Console.WriteLine("Connected");
    while (true)
    {
        Console.Write("Enter the string to be transmitted : ");
        String str = Console.ReadLine();
        Stream stm = tcpclnt.GetStream();
        ASCIIEncoding asen = new ASCIIEncoding();
        byte[] ba = asen.GetBytes(str);
        Console.WriteLine("Transmitting.....");
        stm.Write(ba, 0, ba.Length);
        stm.Flush();
        Console.WriteLine("Sent.....");
    }

    tcpclnt.Close();
    Console.Read();
}
catch (Exception e)
{
    Console.WriteLine("Error..... " + e.StackTrace);
} 
```

只是一个快速的例子，所以当我输入字符串名称时，值第一次改变但是当我第二次输入或者如果我退出客户端程序并重新输入没有任何变化时，标签内容的值等于第一次发送价值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:40:25.300

如果你在 tcpClient.Close() 之后使用 clientStream.Read()，它会抛出一个异常，这将运行你的 catch 块并让你跳出循环。（并且您在循环中的两个位置调用 tcpClient.Close() ，*因此**仅*删除一个将无济于事。这两个都是错误的。）

 *除非您完全完成连接，否则不应调用 tcpClient.Close() （此外，它只应调用一次。）

还，

“在发送和接收数据时必须关闭NetworkStream。关闭TcpClient不会释放NetworkStream。”

因此，请确保关闭 TcpClient 和 NetworkStream，但前提是您完全完成了循环中的处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:51:07.987

[您必须使用异步服务器套接字...请参阅 MSDN链接](http://msdn.microsoft.com/en-us/library/fx6588te.aspx)中的此示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:33:44.720

在您调用的第一次成功读取之后，它看起来像：

```
tcpClient.Close(); 
```

这将阻止任何未来的读取成功。

如果您想避免此类套接字问题，您是否考虑过使用网络库？我是图书馆 networkComms.net 的开发人员，您可以在[这里](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)找到一个简短的示例或我的意思。*

# javascript - 比较两个不同编码的字符串

> ID：14962033
> 
> 赞同：0
> 
> 时间：2013-02-19T16:10:07.383
> 
> 标签：javascript, encoding, character-encoding, greasemonkey

我正在写一个 Greasemonkey 脚本。我需要比较两个字符串，其中一个等于`document.location.href`.

如果`document.location.href`等于，`"http://lema.rae.es/drae/?val=ñáñara"`那么我需要做一些额外的事情，但我无法确定两个字符串是否相等，因为`document.location.href`被转换为另一个字符集。这是一个例子：

```
var currentLocation = document.location.href.toString();
var targetLocation = 'http://lema.rae.es/drae/?val=ñáñara';

alert(currentLocation + '\n' + targetLocation);

/* OUTPUT:

    http://lema.rae.es/drae/?val=%C3%B1%C3%A1%C3%B1ara
    http://lema.rae.es/drae/?val=ñáñara
*/ 
```

如何将两个字符串转换为相同的字符集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:13:15.383

只需使用：

```
var url = decodeURI(window.location.href); 
```

应该够了。

请参阅：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/decodeURI](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/decodeURI)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:14:23.340

或者反过来：`encodeURI("http://lema.rae.es/drae/?val=ñáñara")`

# java - 在 ScrollView 周围放置黑线边框 - Android

> ID：14962036
> 
> 赞同：7
> 
> 时间：2013-02-19T16:10:27.370
> 
> 标签：java, android, border, scrollview

我的问题是，是否有办法在 a 周围放置一个简单的黑线边框，`ScrollView`以便用户准确了解`ScrollView`起点、终点和宽度。我在 Android 文档中找不到任何类型的 XML 或 java 代码说明如何执行此操作。我知道这必须是可能的。

下面是我`ScrollView`需要有边框的 XML 代码。

```
<LinearLayout
          .... />

    <TextView
        ... />

//BORDER STARTS HERE        
    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="94.5"
        android:paddingBottom="5dp"
        android:fillViewport="true" >

        <LinearLayout
            ... > 

            <TextView
                ... />

        </LinearLayout>
    </ScrollView>
//BORDER ENDS HERE

    <Button
        ... />
</LinearLayout> 
```

**编辑**

我刚刚添加了一个`scrollviewborder.xml`带有以下代码的背景作为`ScrollView`.

```
<?xml version="1.0" encoding="utf-8"?>
<shape 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <stroke
        android:width="2dp"
        android:color="#000000"/>
</shape> 
```

下面的截图是它产生的：

![在此处输入图像描述](../Images/e8ed5be50cb6c46103d28651a2c5e4cf.png)

这不是我想要的。我想要一条细黑线，而不是黑框。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T16:17:04.233

您可以将其背景设置为可通过描边[绘制的形状。](http://developer.android.com/guide/topics/resources/drawable-resource.html#Shape)

例子：

```
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="0dip"
    android:layout_weight="94.5"
    android:paddingBottom="5dp"
    android:background="@drawable/stroke_bg"
    android:fillViewport="true" > 
```

在您的 drawables 文件夹中，有一个 stroke_bg.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <stroke
        android:width="2dp"
        android:color="#000000"/>
</shape> 
```

这应该会产生一个带有宽度为 2dp 的黑色边框的滚动视图。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-19T16:17:27.767

根据您的新要求，请尝试以下代码：

```
<?xml version="1.0" encoding="utf-8"?>
    <shape xmlns:android="http://schemas.android.com/apk/res/android"
        android:shape="rectangle">
    <solid
        android:color="@android:color/transparent"/>
    <stroke
        android:width="2dp"
        android:color="#000000"/>
</shape> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T16:17:44.180

[有没有一种简单的方法可以在 Android 视图的顶部和底部添加边框？](https://stackoverflow.com/questions/1598119/is-there-an-easy-way-to-add-a-border-to-the-top-and-bottom-of-an-android-view)

我能想到的Android中没有内置的“边框”概念。您可以通过布局来模拟一个，例如：

将 TextView 包装在 LinearLayout 中，并在其上方和下方添加一个普通 View，这些 View 具有所需的 android:background 颜色和适当的 android:layout_height（例如，1px、1dip）。

将 TextView 包装在 LinearLayout 中，并在上方和下方添加带有所需边框图像的 ImageView 小部件。

将 TextView 包裹在 RelativeLayout 中，添加一个固定在顶部的普通视图（具有适当的背景和高度），另一个固定在底部的普通视图，并将您的 TextView 固定在顶部和底部。这利用了 RelativeLayout 的 z 轴支持，因此边框将位于 TextView 占用的空间内，而不是像前两种方法那样位于 TextView 之外。

为 TextView 提供一个包含九个补丁的 PNG 文件作为具有边框的背景。从 XML 的角度来看，这是最简单的，但是您必须制作一个适当的九个补丁图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T16:24:25.580

不要像某些人建议的那样将其包装在布局中。这将使您的应用程序的渲染速度变慢一些（可能不明显，但仍然如此）。相反，创建一个只定义一个孩子的形状并将其用作 ScrollView 的背景。

# django - 外键。如何获取数据？

> ID：14962040
> 
> 赞同：0
> 
> 时间：2013-02-19T16:10:37.660
> 
> 标签：django

```
class Property(models.Model):
    title = models.CharField(max_length=255)

class CurrentPrice(models.Model):
    current = models.ForeignKey(Current)
    prop = models.ForeignKey(Property)
    price = models.DecimalField(max_digits=5, decimal_places=2)

class Current(models.Model):
    name = models.CharField(max_length=20) 
```

视图.py：

```
...
p = Property.objects.all()
return render_to_response('index.html',{'p':p},context_instance=RequestContext(request)) 
```

如何获取并在我的模板`price`中显示它？`Property`

模板：

```
{% for item in p %}
{{ item.title }}
{{ item.price }} # ???
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:25:00.487

如果 Property 可以有多个 CurrentPrice 对象（默认情况下是什么）：

```
{% for item in p %}
    {{ item.title }}
    {% for current_price in item.currentprice_set.all %}
        {{ current_price.price }}
    {% endofor %}
{% endfor %} 
```

如果只有一个（但在这种情况下，最好使用 o2o 字段而不是 FK 字段，否则您可以防止多个 CurrentPrice 记录指向同一属性）：

```
{% for item in p %}
    {{ item.title }}
    {{ item.currentprice_set.get.price }}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:23:11.777

我不确定您的模型目的/设计是什么，从您展示的内容来看，这看起来不合适。

`CurrentPrice`每个对象都有很多`Property`，所以在模板中你可以做的是

```
{% for item in p %}
    {{ item.title }}
    {% for cp in item.currentprice_set.all %}
        {{ cp.price }}
    {% endfor %}
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T17:56:33.720

我认为您正在尝试做的事情如下所示。

```
class Property(models.Model):
    title = models.CharField(max_length=255)

    @property
    def current_price(self):
        # The current price is the last price that was given.
        if self.pricing_history.count() > 0:
            return self.pricing_history.order_by('-when')[0].amount
        return None

class Price(models.Model):
    prop = models.ForeignKey(Property, related_name='pricing_history')
    amount = models.DecimalField(max_digits=5, decimal_places=2)
    when = models.DateTimeField(auto_now_add=True) 
```

模板中的示例：

```
{% for item in p %}
    {{ item.title }}
    {{ item.current_price }}
{% endfor %} 
```

# ios - CordovaBrowser 应用程序 iOS - 插件入门示例

> ID：14962041
> 
> 赞同：2
> 
> 时间：2013-02-19T16:10:37.880
> 
> 标签：ios, cordova

我试图弄清楚如何使用本地网络服务器和适用于 iOS 的[CordovaBrowser](https://itunes.apple.com/app/id573787308)应用程序在 iPad 上运行加速度计示例。

我相信 CordovaBrowser 应用程序将所有插件都内置到本机托管应用程序中，我需要做的就是包含 cordova.ios.js 并且所有插件都可用。

**当我*从 CordovaBrowser 应用程序*中浏览到该页面时，我只得到指示`navigator.accelerometer`是的输出`null`。**

这是HTML：

```
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>PhoneGap</title>
    <script src="js/cordova.ios.js"></script>
    <script src="Scripts/jquery-1.9.1.js"></script>
    <script src="ts/app.js"></script>
</head>
<body>
    <form id="form1" runat="server">
    <div id="Output">
    </div>
    </form>
</body>
</html> 
```

这是 app.js：

```
$(function () {
    var output = $('#Output');

    try  {
        output.text('Loading ...');

        if(navigator) {
            output.text('Loaded Navigator ...');
        }

        if(navigator.accelerometer) {
            output.text('Loaded Accelerometer ...');
        }

        var watchID = navigator.accelerometer.watchAcceleration(function (acceleration) {
            output.text('Acceleration X: ' + acceleration.x + ', ' + 
                'Acceleration Y: ' + acceleration.y + ', ' + 
                'Acceleration Z: ' + acceleration.z + ', ' + 
                'Timestamp: ' + acceleration.timestamp);
        }, function () {
            output.text('Error!');
        }, {
            frequency: 300
        });
    } catch (e) {
        alert(e);
    }
}); 
```

所有引用的 js 文件都已正确加载。还缺少什么吗？

该应用程序的支持站点上几乎没有活动 - 这是一个重定向到 GitHub。并且基于唯一的问题，GitHub 仅适用于 Android，而不适用于 iOS 版本。这可能只是一个新应用程序中的错误，但也可能是 PhoneGap 开发有很多陷阱。

我会使用其他东西来保证为任意文件提供适当的 PhoneGap 环境。我使用了去年发布的一款名为[Hyperlab](https://itunes.apple.com/us/app/hyperlab/id525490328?mt=8)的应用程序，它非常酷，但它不适用于 iPad，有一些怪癖，并且没有看到任何更新。

我没有/想要一台 Mac，我不想花 99 美元来愚弄这个。如果我们决定走使用 PhoneGap 开发原生应用程序的路线，也许稍后会。苹果很可笑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:37:30.080

您应该为 deviceready 事件添加一个事件侦听器，然后从那里开始：

```
 document.addEventListener("deviceready", onDeviceReady, false);

 function onDeviceReady() {
    // Now safe to use the Cordova API
 } 
```

注意：如果您没有 mac 或无法在实际设备上测试，您可以使用 chrome 进行调试和测试，并使用 chrome 工具更改加速度计值。脚步：

1-右键单击页面并单击检查元素

2-在右上角选择设置

3-选择覆盖并覆盖设备方向

注意：如果您使用的是 Chrome，则永远不会调用设备就绪事件，因此您应该在页面加载时调用它

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-19T23:07:09.297

Cordova 加速度计依赖于仅与本机应用程序一起安装的cordova 库插件。在 Safari 中加载 JS 不会有同样的效果。您必须使用 iOS 设备支持的公共 JS API。我[找到了一个](http://www.murraypicton.com/2011/01/exploring-the-iphones-accelerometer-through-javascript/)适用于我的 iPad 的。

# objective-c - 多个windows mac应用程序

> ID：14962044
> 
> 赞同：2
> 
> 时间：2013-02-19T16:10:42.670
> 
> 标签：objective-c, macos, cocoa, nswindowcontroller, nsviewcontroller

我想制作一个多窗口 mac 应用程序，但我被多窗口部分卡住了！

我可以通过创建一个 xib 文件并使用此方法来显示一些窗口：

```
-(void)popView:(NSString *)viewName {
    _windowController = [[AddProdutWindowController alloc] initWithWindowNibName:viewName];
    [_windowController showWindow:nil];
} 
```

和 `@property (strong, nonatomic) AddProdutWindowController *windowController;`

在我的头文件中并`AddProductViewController`继承自`NSWindowViewController`

我已将`NSViewController`Xcode 中的子类链接到我的`xib`文件。

现在我想将一些数据发送到我的新视图并显示它们，但`NSTextField`我不知道该怎么做！

我对`WindowsController`and很困惑`ViewController`，我不完全知道如何/在哪里使用它们。

谢谢你的帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:16:20.407

试试这个：

你的第一个WindowController.h：

```
#import <Cocoa/Cocoa.h>
@class SecondWindowController;

@interface ResultWindowController : NSWindowController{
   SecondWindowController *swc;
}
@property  (assign) NSNumber *xyz;
... 
```

你的第一个WindowController.m：

```
#import "FirstWindowController.h"
#import "SecondWindowController.h"

@implementation FirstWindowController
@synthesize xyz;

- (IBAction)openSecondWindow:(id *)sender {
if (!swc)
{
    swc = [[SecondWindowController alloc] init];
}
[Swc setFwc:self];
[Swc showWindow:self]; 
```

你的第二个WindowController.h：

```
#import <Cocoa/Cocoa.h>
@class FirstWindowController;
@interface SecondWindowController : NSWindowController {
   FirstWindowController *fwc;
}
@property (retain) IBOutlet FirstWindowController *fwc;

@end 
```

你的第二个WindowController.m：

```
#import "SecondWindowController.h"
#import "FirstWindowController.h"

@implementation SecondWindowController
@synthesize fwc;

- (id)init
{
if(![super initWithWindowNibName:@"SecondWindow"])
    return nil;
NSLog(@"_init: %@", NSStringFromClass([self class]));

return self;
}

- (void)windowDidLoad
{
[super windowDidLoad];

NSLog(@"swc didload self=%p", self); //thats your second window controller

NSLog(@"fwc value is %@", fwd.xyz);  // here you should be able to see the value from FirtsWindowController
} 
```

# security - 如何从网页自动下载 .exe（无需用户交互）？

> ID：14962046
> 
> 赞同：-2
> 
> 时间：2013-02-19T16:10:48.420
> 
> 标签：security

也就是说，当有人打开此网页时，.exe 会自动下载到他的系统中，而无需任何用户交互。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:12:40.867

通常这被认为是为病毒打开了一个洞。大多数浏览器会警告用户他们即将下载可执行文件并且没有办法解决它。

# haskell - Haskell：这个方法有什么作用

> ID：14962047
> 
> 赞同：2
> 
> 时间：2013-02-19T16:10:52.127
> 
> 标签：haskell, semantics

在我的考试中，一个问题是，这种方法是做什么的。

`dos a = ([x | x <- [2..div a 2], mod a x == 0] == [])`

我是 Haskell 的新手，但据我所知，它会检查结果`dos a = ([x | x <- [2..div a 2], mod a x == 0])`是否为空列表。x 也是`a`除以 2 且 %number == 0 的所有数字。因此这都是偶数吗？似乎它检查数字是否可被 2 整除，如果是 -> false，否则。谁能详细解释一下语义？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T16:21:12.293

你很接近正在发生的事情。有几个组件需要理解。

首先，`[2 .. div a 2]`生成从 2 到 的数字列表`floor(a / 2)`。

接下来，`mod a x == 0`过滤掉从 2 到`floor(a / 2)`除数的值`a`（例如，它找到 的所有因数`a`）。因此，由生成的列表

```
[x | x <- [2 .. div a 2], mod a x == 0] 
```

包含除 的所有数字`a`。

最后，`== []`检查该列表是否为空（例如`a`，没有因子）。所以，这个函数实际上做的是通过尝试生成它的因子来确定一个数字是否是素数，当你`dos`用作过滤器的谓词时很容易看到：

```
Prelude> let dos a = ([x | x <- [2..div a 2], mod a x == 0] == [])
Prelude> :t dos
dos :: Integral t => t -> Bool
Prelude> filter dos [2 .. 100]
[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97] -- Prime goodness 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-19T16:22:41.180

它是检查数字是否为素数的基本算法。它遍历从`2`to的所有数字`a/2`并检查其中是否有任何除以`a`，如果列表为空，则表示它之间没有因子`2`，`a/2`这意味着该数字是素数。

# vim - 如何在 Vim 中获取 Backbone.js AutoComplPop？

> ID：14962048
> 
> 赞同：0
> 
> 时间：2013-02-19T16:10:53.933
> 
> 标签：vim, backbone.js

如何让 Vim 和 AutoComplPop 使用 Backbone.js 语法？

AutoComplPop 适用于 HTML、CSS、PHP 和 JavaScript。它在插入模式下会自动弹出，也可以手动弹出。如何让 Backbone.js 语法做同样的事情？

我试过没有成功：

*   [mklabs vim-backbone 插件](https://github.com/mklabs/vim-backbone)-> 自动/手动完成不起作用，但语法突出显示起作用

*   [wei ko kao's/othree's javascript-libraries-syntax](http://www.vim.org/scripts/script.php?script_id=4428) -> 自动/手动完成未激活

*   [igetgames 的 vim-backbone-jscomplete](https://github.com/igetgames/vim-backbone-jscomplete/blob/master/autoload/js/backbone.vim) -> 自动/手动完成未激活

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:24:13.410

首先，是否有任何完成与手动触发一起工作？我不知道那些插件，但他们大概使用了*omni-completion*，在插入模式下通过`<C-X><C-O>`.

如果你有那个工作，下一步是在 AutoComplPop 中启用它。我从未尝试过，但您可能需要在其中配置一些东西（`g:acp_behaviorUserDefinedMeets`？）。您可以查看 AutoComplPop 的帮助及其对 Perl、XML、CSS 等的内置支持的实现。

# neo4j - JCR（JackRabbit，ModeShape）与图（Neo4j）

> ID：14962052
> 
> 赞同：1
> 
> 时间：2013-02-19T16:11:07.563
> 
> 标签：neo4j, jackrabbit, jcr, modeshape

为了存储分层数据，可以将图形数据库 (Neo4j) 视为基于 JCR 的解决方案（ModeShape、JackRabbit）的替代方案吗？还是它们属于 2 个不同的抽象级别，这意味着 JCR 实现可以在后台使用 Neo4j？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T07:02:00.727

两者，人们都在使用 Neo4j 作为存储后端构建 CMS 应用程序（参见[http://structr.org](http://structr.org)）

JCR 实现也可以使用 Neo4j 来完成，过去有人做过，我们也有一个小组使用 Neo4j 作为 Apache Shindig 的后端存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T09:26:20.923

您可能还想看看 OrientDB ( [http://www.orientdb.org/](http://www.orientdb.org/) )，它结合了 Graph-DB（如 Neo4j）和 Document-DB 的特性。甚至似乎有一个原型实现使用 OrientDB 作为 Jackrabbit ( [https://github.com/eiswind/jackrabbit-orient](https://github.com/eiswind/jackrabbit-orient) ) 的存储适配器，它说明了这种混合方法的实现。

# java - 开始 Java 决策结构和数学对象 Switch 语句

> ID：14962054
> 
> 赞同：0
> 
> 时间：2013-02-19T16:11:09.943
> 
> 标签：java, if-statement, switch-statement

好的，这就是我被告知要做的 1.让用户输入两个整数以用于以下任务。2.编写一个简单的 if then 结构来检查用户输入的数字的值，并显示它是否大于 0、大于 10 或负数。3.编写一个决策结构，使用布尔表达式来确定并显示第一和第二是否为正数。4.使用switch语句检查数字2从1到5的值并显示适当的值。找到值后结构应该退出。如果未找到值，请包含一个操作以显示未找到的值。

我自己已经到了 4，但如果第二个数字不是 1-5，我不知道如何让 switch 语句退出。我知道如何显示“未找到值”，但知道如何告诉它显示它是 1-5 未输入。让我知道一个简单的方法，谢谢！这是我到目前为止所拥有的：

```
package ICS4UIReviewTest;
import java.util.Scanner;
import java.lang.Math;

public class PartOneDecisionStructuresAndMathObject {

    public static void main (String [] args) {
        int int1, int2;

        Scanner input = new Scanner (System.in);

        System.out.print("Enter the first integer: ");
        int1 = input.nextInt();

        System.out.print("Enter the second integer: ");
        int2 = input.nextInt();

        if (int1 > 0 && int1 < 10){
            System.out.println("The first number is > 0.");
            } else {
                 if (int1 > 10){
                     System.out.println("The first number is > 10.");
                } else {
                  System.out.println("The first number is negative.");
                    }
                }
            if (int1 > 0 && int2 > 0) {
             System.out.println("The 1st & 2nd number are postiive.");
                }
        switch (int2) {
            case 1: System.out.println("The second number entered is 1."); break;
            case 2: System.out.println("The second number entered is 2."); break;
            case 3: System.out.println("The second number entered is 3."); break;
            case 4: System.out.println("The second number entered is 4."); break; 
            case 5: System.out.println("The second number entered is 5."); break;
                }

         }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:15:54.560

利用中的失败`switch`（并添加`default`案例）：

```
switch (int2) {
    case 1: 
    case 2: 
    case 3: 
    case 4: 
    case 5: System.out.println("The second number entered is " + int2 + ".");
            break;
    default: System.out.println("Number entered not between 1 and 5");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:13:42.217

您可以使用`default`. 如果没有匹配的情况，则执行默认子句。

```
 switch (int2) {
        case 1: 
            System.out.println("The second number entered is 1.");
            break;
        case 2: 
            System.out.println("The second number entered is 2."); 
            break;
        case 3: 
            System.out.println("The second number entered is 3."); 
            break;
        case 4: 
            System.out.println("The second number entered is 4."); 
            break; 
        case 5: 
            System.out.println("The second number entered is 5."); 
            break;
        default: 
            System.out.println("Number not in range"); 
   } 
```

# cakephp - 在 CakePHP 中实现管理面板的最佳方式

> ID：14962058
> 
> 赞同：6
> 
> 时间：2013-02-19T16:11:18.817
> 
> 标签：cakephp, admin, cakephp-2.1

我正在尝试从 CodeIgniter 迁移到 CakePHP，但无法找出实现管理面板的最佳方式。在 CI 中，我会创建两个不同的应用程序，一个用于前端，一个用于管理面板。

在谷歌搜索之后，我发现了三种在 CakePHP 中实现管理面板的方法：

1.  路由 - 我不想使用它，因为我希望控制器/模型将前端和管理面板分开
2.  插入
3.  两个独立的应用程序

我应该使用插件来实现管理面板还是应该有单独的应用程序？一个比另一个有什么好处？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-19T19:30:39.427

我通常将管理/后端开发为插件。这使您的后端/管理控制器/视图/模型与前端分离，并且您不必跳过箍来拥有单独的样式表、布局等。

另一个优点是前端和后端仍然是同一个应用程序的一部分，因此如果需要，您*可以*共享逻辑/组件，例如，您可以将可用于前端和后端的助手放在*另一个*插件中（例如插件/共享或插件/Handytexttools）并在任何地方使用它们

根据经验; 将可能可用于其他项目的组件放在单独的插件中，这样您就可以将这些插件添加到其他项目而不会出现问题。保持你的插件简单；创建一个只包含一两个助手或模型和几个 JavaScript 文件的插件是没有问题的。这将使您更容易“挑选”项目所需的插件。一旦 Cake 已经“缓存”了插件中所有类的文件位置，单独插件的开销应该是最小的。

回到“管理员”插件。尝试只在您的管理插件中包含*此*项目的特定代码，并在另一个插件中包含*可重用部分（例如，管理面板的通用样式表和布局）。*您将能够以最少的编码为您的下一个项目启动一个管理插件

祝你的项目好运，享受 CakePHP

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T16:56:21.693

如果你想让你的控制器和模型分开 - 我会使用一个单独的应用程序，尽管你最终会在应用程序之间得到一堆重复的代码（维护头痛等待发生）。

我的选择是管理路由和管理主题。

在 /app/Config/core.php 中启用管理路由

在 AppController beforeFilter() 中：

```
$this->theme = isset($this->params['admin']) ? "Admin" : "Site"; 
```

将所有站点视图和资产移动到 /app/View/Themed/Site/

在 /app/View/Themed/Admin 中创建您的管理主题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:30:46.587

旧的，指的是 CakePHP 1.3，但仍然是一个你应该检查的问题：[CakePHP 管理面板](https://stackoverflow.com/questions/1926252/cakephp-admin-panel)

*蛋糕*的方式是路由。我会使用像[CakeDC Users](https://github.com/CakeDC/users)这样的插件，它可以让事情变得更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T17:10:47.367

您可以使用管理员路由。查看：

[http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing](http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing)

另一个解决方案——我发现它很容易实现——是这样的：

在您的**AppController**中：

```
public function beforeFilter(){
        $this->set('current_user', $this->Auth->user());
         } 
```

这使得 $current_user 在您的应用程序中可用。

然后在您的视图文件中，您可以检查：

```
 <?php if ($current_user['role'] == 'admin'){/*place code for admin users to see here*/} ?>
  <?php if ($current_user){/*place code for logged-in users to see here*/} ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-23T10:30:42.643

我知道这是一个旧线程。但是想问一下是否有人在将管理面板作为插件实现时遇到了麻烦。特别是代码重复。

例如，您正在实施一个电子商务网站。您在主插件和管理插件中都有一个 OrderController。你不觉得在两个地方保持逻辑有点困难吗？

只使用一个主控制器怎么样。它有两个目的。一个作为 API，然后是您的 Admin webapp 的控制器。

然后，您的公共方面将基本上通过 API 进行通信以获取数据。

你认为这是个好主意吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-23T11:31:07.563

您可以使用像 admin_index.ctp 这样的管理视图，只需更改它

//配置::write('Routing.admin', 'admin');

到

配置::write('Routing.admin', 'admin');

在 core.php 和控制器中添加 admin_index() 函数

# c# - CS0436：类型与导入的类型冲突

> ID：14962066
> 
> 赞同：28
> 
> 时间：2013-02-19T16:11:42.717
> 
> 标签：c#, warnings

我使用 Add As Link 选项在多个程序集中包含相同源文件的实例。我特别需要在这些程序集中包含相同源的实例，因为它负责必须在程序集内部进行的许可证验证。跨模块边界执行许可证调用可能会带来安全风险。

我的解决方案中包含代码的一些项目依赖于也包含它的其他模块，从而导致警告[CS0436](http://msdn.microsoft.com/en-us/library/h6ys1ykk%28v=vs.90%29.aspx)：

> “[licence.cs 完整路径] 中的类型 [type] 与 [依赖项目也包括 licence.cs] 中的导入类型 [LicenceClass] 冲突。使用 [licence.cs 完整路径] 中定义的类型”。

我曾尝试声明一个类别名，但 licence.cs 内部的定义会导致相同的警告。在别名中，必须有对导致相同警告的重复类名的引用。

我知道在程序集之间复制源代码是不好的做法，但在这种情况下是故意的。我宁愿保留每个程序集链接到的中央实例，而不是具有重命名类的专用实例以避免警告。

我的解决方法是简单地使用`#pragma`. 有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2016-01-29T14:04:29.500

值得注意的是，获得此类警告的另一种方法是简单地在 Visual Studio 中设置一个项目以引用自身：References -> Solution -> etc etc（我如何计算出这个 gem 留给读者作为练习...... )

Visual Studio 将很高兴地遵守，只是在构建期间抛出 OP 描述的类型的警告墙，这是可以预期的（在反射时），因为每个类等都被定义了两次。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-22T17:49:17.890

唯一发生冲突的情况是两个依赖类包含同一个类。有两种解决方法：

1.  禁用导致 CS0436 的类中的警告：

    ```
    #pragma warning disable 0436 
    ```

2.  有一个单独的类实例，在每个客户项目中唯一命名（从维护的角度来看是不可取的）。

编辑：还有一个解决方案：按照下面的 Mark 建议做，并标记重复的类`internal`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-03-31T12:45:15.540

当我迁移到 VS2015 时，我有一个从 ASP.NET 3.5 转换为 4.5 的 Web 应用程序。我开始将此视为警告，但解决方案仍然可以编译。没有循环引用，清理解决方案并删除`bin`and`obj`文件夹没有帮助。

事实证明，VS2015 对我在 App_Code 文件夹中的一些类不满意。此处的类与父文件夹中的其余网页具有相同的命名空间。一旦我将这些类移出 App_Code 文件夹并移至 Web 应用程序的顶层，警告就消失了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-03T11:49:53.427

在 .NET Core 中，您还可以禁用 project.json 中的警告：

```
{
  "buildOptions":
  {
    "nowarn":
    [
      "CS0436"
    ]
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-10T06:53:57.950

我有这个错误，但不是 2 个不同的类！
每个新班级都与自己发生冲突，所以很明显我有那个`CS0436 Error`。

经过一番挣扎后，我发现它是关于`Mirror Asset`我在多人 Unity 项目中使用的。Mirror 不知何故包含了我创建的每个新类（并继承自`NetworkBehavior`）。

我的外部编辑器是`VSCode`（Visual Studio 代码，解决方案也可能适用于 Visual Studio）。

**解决方案**

在
`Edit / Preferences / External tools / "Generate .csproj files for:"`
我开始测试不同的设置时，这对我有用：（
不确定确切的设置是否适用于所有人，但项目中没有正确的文件会导致此错误。就像我的情况一样。）

[![](../Images/5470751c9f2566dd3691129fe6412e7d.png)](https://i.stack.imgur.com/oazFb.png)

`Regenerate project files`应用这些设置（或适合您项目的设置）后，单击并重新启动 Unity 和 VSCode。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-14T16:40:35.827

我在临时删除一些源文件并稍后恢复它们时遇到过这种情况。IDE（在我的例子中是 Rider）碰巧尝试恢复这些类，所以当它们丢失时，它只是添加了对生成的 exe 的引用。显然，当我恢复文件时，它们看起来是重复的。插入的参考 IDE 如下所示，只需将其删除即可修复：

```
<Reference Include="AppName, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null">
  <HintPath>bin\x86\Debug\AppName.exe</HintPath>
</Reference> 
```

# authentication - 使用 clientAuth=want 的 tomcat 客户端身份验证

> ID：14962069
> 
> 赞同：9
> 
> 时间：2013-02-19T16:12:02.173
> 
> 标签：authentication, tomcat, client

我的应用程序需要对特定 URL 进行客户端身份验证，在客户端身份验证成功后，应用程序本身也会对客户端证书主题进行一些验证（使用 spring security x509 过滤器）。我想配置 tomcat 以强制客户端身份验证 (clientAuth=true) 用于特定 URL，但根据这篇文章，我似乎不能仅使用 tomcat 执行此操作 -[仅为特定 URL 模式配置 tomcat 进行客户端身份验证](https://stackoverflow.com/questions/14937833/configure-tomcat-for-client-authentication-only-for-specific-url-patterns)。

我的问题是，如果我使用 clientAuth=want，当服务器请求证书时，会如下所示：

1.  如果设备有身份证书但不被tomcat truststoreFile中配置的CA信任，则不会通过证书，并且在spring安全过滤器中请求将失败（证书将为空）
2.  如果设备具有在 tomcat truststoreFile 中配置的 CA 信任的身份证书，但该身份证书无效（不确定进行了哪些验证）或已过期，则身份验证将在 tomcat 中失败（在安全过滤器之前）或如选项 1 一样，没有证书将被通过并且请求将在spring安全过滤器中失败（证书将为空）

使用这种想要 + 安全过滤器的配置是否存在我可能会丢失的安全漏洞？我想问题是 - 如果证书最终从设备传递到服务器，服务器将始终验证它（未过期，受信任等），即使使用 clientAuth=want 并且如果证书是不允许客户端继续无效的？未通过证书的情况由将检查证书不为空的安全过滤器覆盖。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-02T18:59:56.697

您在 1\. 和 2\. 中的假设都是正确的。Tomcat 将不允许不受信任或无效的证书通过您的应用程序。如果您获得一个空证书，您可以假设没有通过任何证书，或者通过了不受信任/无效的证书。

在我正在处理的项目中，我们有与您相同的要求：仅限某些 URL 的客户端证书。我们通过实验发现了“clientAuth=want”的工作原理。

# css - 为什么这种技术通常使用负文本缩进？

> ID：14962070
> 
> 赞同：4
> 
> 时间：2013-02-19T16:12:05.017
> 
> 标签：css, text-indent

假设您想用图像替换锚点，并将该图像作为锚点的背景。出于可访问性的原因，您仍然希望由锚点包裹的文本存在，但您不希望它可见。一个众所周知的技术是使用类似 text-indent: -9999px; 连同溢出：隐藏；

假设我们的锚框是 50px x 50px，我们为什么不直接做 text-indent: 50px 呢？这会将文本推入锚的隐藏溢出中，*无论它得到多长时间！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:44:35.230

好吧，让我们看看当你这样做时会发生什么

[http://jsfiddle.net/C29Ma/](http://jsfiddle.net/C29Ma/)

```
<div class="image">Hide me please</div>

div.image {
    width: 50px;
    height: 50px;
    background: url(http://placehold.it/50x50) no-repeat;
    text-indent: 50px;
} 
```

因为文本的宽度超过 50 像素，所以它会环绕。只有第一行缩进 50px。

在广泛支持伪元素或控制自动换行之前，负缩进技术就出现了。它做得足够好，所以当出现更新/更好的方法时，人们不会改变他们做事的方式。

不过，您的建议非常接近现代技术之一

[http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)

```
.hide-text {
     text-indent: 100%;
     white-space: nowrap;
     overflow: hidden;
 } 
```

# c++ - Visual Studio 2008 中的 POD

> ID：14962071
> 
> 赞同：7
> 
> 时间：2013-02-19T16:12:06.823
> 
> 标签：c++, visual-studio-2008

以下代码

```
#include <iostream>
#include <new>
#include <cstring>
#include <type_traits>

template<typename T>
void is_pod(char* c)
{
    cout << "Type " << c;
    if(std::is_pod<T>::value)
        ::std::cout << " is POD" << endl;
    else
        ::std::cout << " is not!" << endl;
}

#define CHECK_TYPE(ty) ::is_pod<ty>(#ty)

struct POD_Parent{};
struct POD_Child : public POD_Parent{int y;};
struct POD_Child2 {int x; POD_Parent y; POD_Child ssd;};

int main()
{
    CHECK_TYPE(POD_Parent);
    CHECK_TYPE(POD_Child);
    CHECK_TYPE(POD_Child2); 
```

给出以下结果： 这很奇怪！

```
Type POD_Parent is POD
Type POD_Child is not!
Type POD_Child2 is POD 
```

POD_Child 怎么可能不是 POD？！而 POD_Child2 是 POD？！！

请注意，我使用 MinGW 编译它（使用选项 -std=c++11），它说它们都是 POD。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:58:19.680

根据`[MSDN][1]`具有基类的类型并非如此，`POD`而是因为编译器可能会忽略基类的一些错误`POD_Child``POD``POD_Child2``ssd`

# powershell - PowerShell 脚本从文件夹和子文件夹中回显文件，然后删除超过 X 天的文件

> ID：14962076
> 
> 赞同：0
> 
> 时间：2013-02-19T16:12:12.263
> 
> 标签：powershell, powershell-2.0, powershell-3.0, powershell-1.0

我很想了解在文件夹和子文件夹中回显文件并生成说明文件名的输出的可能方法，这些文件名被拾取以删除 X 天前的文件。

我想在两个不同的层次上写这个脚本

级别 1：PowerShell 脚本仅用于回显文件名并为我提供已确定要删除的文件的输出。这应该包括文件，包括文件夹和子文件夹。

Level2：通过添加删除功能组合level1脚本，这将删除文件夹和子文件夹中的文件。

我有一个要删除的移动脚本和一个直接脚本，但我想确保选择了正确的文件，并且我想知道正在删除的文件名。

非常感谢任何帮助。

**编辑**从评论中添加

我一直在以一种非常简单的方式尝试这样的事情

```
Get-ChildItem -Path c:\test | where {$_.lastWriteTime -lt (Get-Date).addDays(-60)} 
```

我想添加一些参数，它会在不同的文件夹位置生成文件名的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:32:27.487

我认为这符合您的需求，我向您介绍了一些您可能不知道的概念，例如[cmdletbinding](http://blogs.technet.com/b/heyscriptingguy/archive/2012/07/07/weekend-scripter-cmdletbinding-attribute-simplifies-powershell-functions.aspx)，它允许您使用 -whatif 参数来干运行脚本。您还可以提供 -verbose 以查看沿途发生的情况，此时您还可以使用[Add-Content](http://technet.microsoft.com/en-us/library/ee156791.aspx) cmdlet 附加到日志。

所以你可以这样运行它：

```
.\DeleteOldFiles.ps1 -Path c:\test -Age 50 -WhatIf -Verbose 
```

然后，当您准备好删除文件时，您可以在没有 -WhatIf 参数的情况下运行它：

```
.\DeleteOldFiles.ps1 -Path c:\test -Age 50 -Verbose 
```

这并不能回答您的所有问题，但应该可以帮助您入门，我在代码中添加了大量注释，因此您应该能够全部遵循。

```
# Add CmdletBinding to support -Verbose and -WhatIf 
[CmdletBinding(SupportsShouldProcess=$True)]
param
(
    # Mandatory parameter including a test that the folder exists       
    [Parameter(Mandatory=$true)]
    [ValidateScript({Test-Path $_ -PathType 'Container'})] 
    [string] 
    $Path,

    # Optional parameter with a default of 60
    [int] 
    $Age = 60   
)

# Identify the items, and loop around each one
Get-ChildItem -Path $Path | where {$_.lastWriteTime -lt (Get-Date).addDays(-$Age)} | ForEach-Object {

    # display what is happening 
    Write-Verbose "Deleting $_ [$($_.lastWriteTime)]"

    # delete the item (whatif will do a dry run)
    $_ | Remove-Item
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:48:05.930

这个问题有点模糊，但我认为这就像你想要的。
我喜欢大卫马丁的回答，但根据您的技能水平和需求，它可能有点过于复杂。

```
param(
    [string]$Path,
    [switch]$LogDeletions
)

foreach($Item in $(Get-ChildItem -Path $Path | where {$_.lastWriteTime -lt (Get-Date).addDays(-60)}))
{
    if($LogDeletions)
    {
        $Item | Out-File "C:\Deleted.Log" -Append
    }
    rm $Item
} 
```

# binding - LISP 负绑定

> ID：14962078
> 
> 赞同：1
> 
> 时间：2013-02-19T16:12:21.267
> 
> 标签：binding, lisp

我正在尝试理解以下 LISP 代码：

```
 (x- (sin q2))
 (x (/ (* m2 x-)
       (+ m1 m2))) 
```

x- 和 x 是单独的变量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:21:31.640

是的，在大多数 Lisp 方言中，您可以使用具有此类名称的符号。`x-`是一个符号，因此可以用作变量名。

LispWorks：

```
CL-USER 1 > 'x-
X-

CL-USER 2 > (describe 'x-)

X- is a SYMBOL
NAME          "X-"
VALUE         #<unbound value>
FUNCTION      #<unbound function>
PLIST         NIL
PACKAGE       #<The COMMON-LISP-USER package, 57/64 internal, 0/4 external>

CL-USER 3 > (eq 'x- 'x)
NIL 
```

# php - How to install PHP API for sphinx

> ID：14962079
> 
> 赞同：-1
> 
> 时间：2013-02-19T16:12:39.033
> 
> 标签：php, ubuntu, sphinx

I've installed the sphinx tool on my Ubuntu machine using `sphinxsearch`. I cannot find any Ubuntu package to support php-sphinx.

Where should I get PHP API for sphinx from?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:22:57.847

The PHP API is only a PHP file you have to include.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:25:00.590

Sphinx API is PHP file with functions. You can download it from sphinx site.

But now most recommended use SphixQL - this is language similar to SQL and you can use it with php-mysql extension.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:17:02.927

Googling "Sphinx php installation" gave the following result:

[http://php.net/manual/en/sphinx.installation.php](http://php.net/manual/en/sphinx.installation.php)

# c# - 在c#中使用WINAPI单击消息框的“确定”按钮

> ID：14962081
> 
> 赞同：8
> 
> 时间：2013-02-19T16:12:47.610
> 
> 标签：c#, winapi, messagebox

我正在尝试使用 winapi 在 C# windows 窗体的消息框中单击“确定”按钮。下面是我正在处理的代码。

```
private const int WM_CLOSE = 16;
private const int BN_CLICKED = 245;

[DllImport("user32.dll", CharSet=CharSet.Auto)]
        public static extern int SendMessage(int hWnd, int msg, int wParam, IntPtr lParam);

[DllImport("user32.dll", SetLastError = true)]
        public static extern IntPtr FindWindowEx(IntPtr parentHandle, IntPtr childAfter, string className,  string  windowTitle);

//this works
hwnd = FindWindow(null, "Message");
if(hwnd!=0)
      SendMessage(hwnd, WM_CLOSE, 0, IntPtr.Zero);

//this doesn't work.
hwndChild = FindWindowEx((IntPtr)hwnd, IntPtr.Zero, "Button", "ok");
SendMessage((int)hwndChild, BN_CLICKED, 0, IntPtr.Zero); 
```

虽然我得到了一个值`hwndChild`，但它没有识别`BN_CLICKED`。我不确定我错过了什么。有什么帮助吗？

我正在尝试关闭另一个应用程序的消息框按钮，这就是我正在做的事情。但是，我仍然缺少一些东西。

```
IntPtr hwndChild = IntPtr.Zero;
hwndChild = FindWindowEx((IntPtr)hwnd, IntPtr.Zero,' '"Button", "OK");
SendMessage((int)hwndChild, WM_COMMAND, (BN_CLICKED '<<16) | IDOK, hwndChild); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T16:18:29.860

BN_CLICKED 不是消息。您需要发送一条 WM_COMMAND 消息，其中包含[BN_CLICKED](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761825.aspx)通知和 中的按钮 ID`wParam`以及 中的按钮句柄`lParam`。

> 按钮的父窗口通过 WM_COMMAND 消息接收到这个通知代码。

```
private const uint WM_COMMAND = 0x0111;
private const int BN_CLICKED = 245;
private const int IDOK = 1;

[DllImport("user32.dll", CharSet=CharSet.Auto)]
        public static extern int SendMessage(IntPtr hWnd, uint msg, int wParam, IntPtr lParam);

[DllImport("user32.dll", SetLastError = true)]
        public static extern IntPtr FindWindowEx(IntPtr parentHandle, IntPtr childAfter, string className,  string  windowTitle);

SendMessage(hwndChild, WM_COMMAND, (BN_CLICKED << 16) | IDOK, hwndChild); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-19T18:26:33.107

Finallu，这对我有用。第一次单击可能会激活窗口，第二次单击可能会单击按钮。

```
SendMessage(btnHandle, WM_LBUTTONDOWN, 0, 0);
SendMessage(btnHandle, WM_LBUTTONUP, 0, 0);
SendMessage(btnHandle, WM_LBUTTONDOWN, 0, 0);
SendMessage(btnHandle, WM_LBUTTONUP, 0, 0); 
```

# java - 关闭扫描仪而不关闭 System.in

> ID：14962082
> 
> 赞同：12
> 
> 时间：2013-02-19T16:12:51.090
> 
> 标签：java, java.util.scanner, system.in

我正在尝试将我的应用程序的一个大且经常使用的部分重新分解为单独的方法，以使其更易于维护。

其中一些方法要求用户输入并进行输入验证，所以我使用了 Scanner 和 System.in 但是当我关闭我的 Scanner 时，我也关闭了 System.in

所以我的问题是，我只能通过使用 CloseShieldInputStream 屏蔽 System.in 来防止它被关闭，还是应该开始将 Scanner 传递给方法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-11-11T12:26:37.247

只需使用自定义 FilterInputStream 而不是 System.in：

```
new FilterInputStream(System.in) {
    @Override
    public void close() throws IOException {
        //don't close System.in! 
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T16:27:08.090

您可以通过实现自定义装饰器来忽略关闭。

```
public class UnClosableDecorator extends InputStream {

    private final InputStream inputStream;

    public UnClosableDecorator(InputStream inputStream) {
        this.inputStream = inputStream;
    }

    @Override
    public int read() throws IOException {
        return inputStream.read();
    }

    @Override
    public int read(byte[] b) throws IOException {
        return inputStream.read(b);
    }

    @Override
    public int read(byte[] b, int off, int len) throws IOException {
        return inputStream.read(b, off, len);
    }

    @Override
    public long skip(long n) throws IOException {
        return inputStream.skip(n);
    }

    @Override
    public int available() throws IOException {
        return inputStream.available();
    }

    @Override
    public synchronized void mark(int readlimit) {
        inputStream.mark(readlimit);
    }

    @Override
    public synchronized void reset() throws IOException {
        inputStream.reset();
    }

    @Override
    public boolean markSupported() {
        return inputStream.markSupported();
    }

    @Override
    public void close() throws IOException {
        //do nothing
    }
} 
```

并在 main 中使用它

```
public static void main(String[] args) throws Exception {
        System.setIn(new UnClosableDecorator(System.in));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:20:09.067

你可以让它不关闭它，只需将持有变量设置为 null

# mongodb - 是否有可靠的（单服务器）MongoDB 替代方案？

> ID：14962084
> 
> 赞同：11
> 
> 时间：2013-02-19T16:12:54.223
> 
> 标签：mongodb, database, nosql

我喜欢文档数据库的想法，尤其是 MongoDB。它允许更快的开发，因为我们不必调整数据库模式。但是 MongoDB 不支持多文档事务，并且不保证修改会像普通数据库一样立即写入磁盘（我知道您可以使刷新之间的时间非常短，但仍然不能保证）。

我们的大多数项目都没有那么大，以至于他们需要多服务器环境之类的东西。所以请记住这一点。是否有任何支持多文档事务和可靠刷新到磁盘的单服务器类似 MongoDB 的文档数据库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-11-27T13:57:20.933

看看[ArangoDB](http://www.arangodb.org/ "ArangoDB")可能是值得的。它是一个多模型数据库，具有用于文档、图形和键值的灵活数据模型。关于您的特定要求，ArangoDB 数据库具有完整的 ACID 事务，可以跨越同一集合中的多个文档以及多个集合（请参阅[ArangoDB 中的事务](http://www.arangodb.org/manuals/current/Transactions.html "ArangoDB 中的事务")）。也就是说，您可以在一个事务中一起对您的文档执行一组操作，并保证原子性和隔离性。如果您另外设置`waitForSync: true` （如所述页面中进一步描述的那样），您可以在事务报告完成之前保证同步到磁盘。请注意，如果您的事务跨越多个集合，则会自动发生这种情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-22T04:33:06.987

对您的特定（但简短）要求的非常简短的回答：

> 是否有任何支持多文档事务和可靠刷新到磁盘的单服务器类似 MongoDB 的文档数据库？

1.  RavenDB [ [1](http://ravendb.net) ] 提供对多文档事务 [ [2](http://ravendb.net/docs/client-api/advanced/transaction-support) ] 的支持。不幸的是，我不知道它处理耐用性。

2.  CouchDB [ [3](http://couchdb.apache.org) ] 提供持久写入，但没有多文档事务

3.  RethinkDB [ [4](http://www.rethinkdb.com) ] 提供持久写入，但不提供多文档事务。

所以你可能想知道这 3 种解决方案有什么不同？大多数时候是他们的查询支持（我想说 RethinkDB 有最先进的支持几乎所有类型的查询：子查询、JOIN、聚合等），他们的历史（阅读：生产准备——这里我可能会说 CouchDB 处于领先地位），他们的分发模型（您提到这对您来说并不有趣），他们的许可（RavenDB：商业，CouchDB：Apache License，Rethinkdb：AGPL）。

下一步是让您简要查看他们的功能集并找出哪个更接近您的需求并试一试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-27T15:04:37.297

我对 CouchDB 和 ArangoDB 有一些经验，可以分享：

您可以在启用持久性的情况下运行 CouchDB (delayed_commits = false)，这样它也会将您的数据同步到磁盘。但是，这是一个全局设置，因此它会影响所有写入。AFAIK 您不能在每个集合级别上设置它（“集合”的 CouchDB 术语将是“数据库”）。

关于多文档操作：CouchDB 有 MVCC，因此从同一个数据库中读取多个文档即使面对并行写入者也能提供一致的结果。对于特殊情况，例如在使用批量文档 API 时，也可以将多个文档写入同一个数据库。但是没有办法在 CouchDB 中执行跨数据库操作。这不是故意的。

在 ArangoDB 上：在 ArangoDB 中，您可以在每个集合级别打开立即同步到磁盘：您可以为不能容忍任何数据丢失的集合打开它。您可以为不那么重要的集合关闭立即同步性能原因。然后，它仍会频繁地将修改同步到磁盘，但不会立即同步。它提供多文档和多集合交易。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-15T10:24:19.480

检查以下内容：

1.  [阿兰戈德](http://www.arangodb.org/)

2.  [重新思考数据库](http://www.rethinkdb.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-28T17:20:38.277

我建议你看看 Couchbase。

Couchbase 可以在单个服务器上运行，如果需要，您可以稍后添加节点。

Couchbase 集成了 memcached，因此您可以快速缓存常见数据，并使用可靠的方法将更新写入磁盘。

他们还有一种名为 NQL（“Nickel”）的新查询语言（正在开发中，但您现在可以使用它），如果这对您很重要，它可以为您提供类似 SQL 的访问权限。

通过跨数据中心复制，您可以使不同机器或数据中心上的两个数据库保持同步，这对于进行异地备份很有好处。如果您希望为这些类型的查询提供全文搜索引擎，这也允许您添加弹性搜索。

简而言之，Couchbase 是一个非常完整的解决方案，全部开源并且具有智能（在我看来）架构来解决分布式数据库的典型问题（例如：每个文档都由给定节点“拥有”，因此所有更改都针对该节点节点，然后复制更新，我认为这比说 Riak 更好，你可以将更新转到两个节点，然后必须进行协调。）

您可以在一个节点上使用 Couchbase 为多个项目运行数据库，方法是将项目分成不同的存储桶。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-19T18:11:58.803

有这么多的nosql数据库，绝对很难选择一个。您必须提出适当的要求并确切地知道您想要什么。以下链接比较了几乎所有流行的 nosql 数据库 [http://kkovacs.eu/cassandra-vs-mongodb-vs-couchdb-vs-redis](http://kkovacs.eu/cassandra-vs-mongodb-vs-couchdb-vs-redis)

我希望这有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-06T16:19:33.667

Berkeley DB 是我们使用的一种。它支持酸。它确实有交易，但至于您的术语“多文档”是否适用，我不完全确定。我想只要每个数据库（即单个文档）共享相同的 BDB 环境（即存储事务的位置），那么也许就能得到你想要的。BDB 确实有其他权衡。由于具有完全的持久​​性和高并发性，提交非常慢。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-06-17T08:03:24.890

试试看：[http ://www.orientdb.org/](http://www.orientdb.org/)

*“OrientDB 具有 Document 数据库的灵活性和 Graph 数据库管理关系的能力。它可以在无模式模式、全模式模式或两者混合模式下工作。支持 ACID 事务、快速索引、本机等高级功能和 SQL 查询。它以 JSON 格式导入和导出文档。OrientDB 使用一种称为 MVRB-Tree 的新索引算法，该算法源自红黑树和 B+Tree，具有以下优点：快速插入和超快速查找”。*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-19T16:50:13.320

您不必调整文档数据存储中的模式，但这并不意味着您不需要某种模式，因为您可能希望对数据做一些有意义的事情。看来您想要一个 ACID 数据库。如果您有关系数据，并且您需要与该数据进行事务处理，那么听起来很像您需要一个关系数据库。

使用像 Mongo 这样的“NoSQL”数据库，你正在放弃 ACID 来获得许多可写副本、分片和快速访问文档数据等功能。听起来您并没有从中受益，那么为什么要进行权衡呢？很多人最近一直在使用 PostgreSQL 进行混合方法，将文档作为 JSON 块存储在关系表中。有了这个，您可以在不需要的地方将数据存储为非严格结构化的列。

因此，如果您有多个文档需要在更新时进行事务处理，您可以列出键，并有一个列“文档”或其他内容，它只是一个 JSON 数据块，您可以在其中对其进行序列化和反序列化。这并不是批评 Mongo 或其他文档存储作为数据库，但对于事务性多文档数据来说，它并不是一个好的选择。我相信 MarkLogic 也会对多个文档进行 ACID。

我认为很多人因为没有模式而对 mongodb 有吸引力，但我认为最终他们会因为试图将关系模型硬塞到其中而受到影响。因此，与往常一样，数据库的选择取决于您的数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-20T01:34:46.877

如果我是你，我会仔细看看 Solr。底层数据层 (Lucene) 是迄今为止最成熟的 NoSQL 数据库，Solr 使单主机 lucene 存储的安装、配置和集成变得轻而易举。

在回答您的问题时，它支持用户描述的交易。Lucene 的读取优化特性可能使其不适用于许多应用程序，但其中大多数非常适合 Solr/Lucene+[SQL,Cassandra,CouchDB,RDF]，具体取决于需求。

就我个人而言，我倾向于从 Solr+SQL 或 Solr+RDF 开始，但我认识一些喜欢整个 NodeJS+CouchDB 风格的人，我相信所提供的灵活性的价值。

最重要的是，有足够的 NoSQL 和 SQL 扩展来关心数据完整性，以满足您的任何要求，而不必损害您或您的用户的数据。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-02-19T18:57:11.520

我个人认为你真的需要检查你的要求是什么。

由于服务器操作系统如何工作的动态性，即使您告诉它，所有东西“立即”都进入磁盘是很复杂的。当然，我知道像 SQL 这样的 ACID 技术很容易因未完成的业务而受到部分损坏，并且当单个服务器出现故障时会在特定窗口内丢失操作，不幸的是，这是使用单个服务器的问题之一；你别无选择，只能接受。

我应该注意，事务并不能确保您的服务器在失败之前会接收到全部数据（[http://en.wikipedia.org/wiki/Database_transaction](http://en.wikipedia.org/wiki/Database_transaction)），我的意思是如果服务器在事务中途死亡怎么办？

您可以基于事务的约束执行安全回滚，但很少有数据库会提供继续播放事务的能力，除非它们已经收到所有必要的数据（通常情况并非如此），到那时数据甚至可能无论如何都是陈旧的。

事实上，由于某些事务的权重和在其中执行的查询量，我认为使用事务可能会比在 MongoDB 上的 60 毫秒写入磁盘窗口中获得更大的操作损失窗口。但这当然取决于滥用，但是，就像存储过程一样，这种滥用很常见。

事务在级联删除和典型场景（例如在银行帐户中转账）上大放异彩，但是，级联删除通常最好通过 cronjob 完成（就像大多数站点一样），应用程序将行标记为已删除（以避免显示的事务回滚已删除的数据再次返回给用户）；这样，您可以做很多事情来确保一致性，而在用户使用您的应用程序时您无法实时做到这一点。

所以你真的应该质疑为什么你需要一种技术以及它会成功做什么，atm你的问题的简洁告诉我你完全不确定你的要求。

# javascript - createReadStream().pipe() 回调

> ID：14962085
> 
> 赞同：18
> 
> 时间：2013-02-19T16:12:57.507
> 
> 标签：javascript, node.js

提前抱歉，我有几个关于 createReadStream() 的问题。

基本上我正在做的是动态构建一个文件并在完成后使用 fs 将其流式传输给用户。我正在使用 .pipe() 来确保我正确地进行了节流（如果缓冲区已满，则停止读取，一旦没有则重新开始，等等）这是我到目前为止的代码示例。

```
http.createServer(function(req, res) {
  var stream = fs.createReadStream('<filepath>/example.pdf', {bufferSize: 64 * 1024})

  stream.pipe(res);

}).listen(3002, function() {
  console.log('Server listening on port 3002')
}) 
```

我读过另一个 StackOverflow 问题（对不起，丢了），如果您使用常规 res.send() 和 res.end() ，那么 .pipe() 效果很好，因为它调用了 .send 和 .end并增加了节流。

这在大多数情况下都可以正常工作，除了我想在流完成后删除文件并且不使用 .pipe() 意味着我将不得不自己处理节流以获得回调。

所以我猜我想创建我自己的假“res”对象，它有一个 .send() 和 .end() 方法，可以做 res 通常做的事情，但是在 .end() 我会放置额外的代码来清理生成的文件。我的问题基本上是我将如何做到这一点？

非常感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-19T18:45:57.150

关于下载的第一部分可以通过[从 NodeJS 服务器下载文件](https://stackoverflow.com/questions/7288814/download-file-from-nodejs-server)来回答。

至于在文件全部发送后删除文件，您只需添加自己的事件处理程序即可在发送完所有文件后删除文件。

```
var stream = fs.createReadStream('<filepath>/example.pdf', {bufferSize: 64 * 1024})
stream.pipe(res);

var had_error = false;
stream.on('error', function(err){
  had_error = true;
});
stream.on('close', function(){
  if (!had_error) fs.unlink('<filepath>/example.pdf');
}); 
```

处理程序不是 100% 需要的`error`，但是如果在您尝试发送文件时出现错误，您不会删除该文件。

# wpf - 两端具有固定宽度渐变的 LinearGradientBrush

> ID：14962087
> 
> 赞同：3
> 
> 时间：2013-02-19T16:13:06.387
> 
> 标签：wpf, lineargradientbrush

我想使用 LinearGradientBrush 用渐变填充画布上的矩形范围。问题是，无论矩形有多大，我都希望矩形两侧的渐变看起来相同。

我试图画的是这样的：

![http://imgur.com/B5efn7c](../Images/1ae5435baf792f4e5ca81099ad7e229d.png)

这是我的第一次尝试：

```
LinearGradientBrush brush = new LinearGradientBrush();
brush.SpreadMethod = GradientSpreadMethod.Reflect;
brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#FF0000FF"), 0.0));
brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#22FFFFFF"), 0.25));
brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#22FFFFFF"), 0.75));
brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#FF0000FF"), 1.00));
brush.StartPoint = new Point(0, 0);
brush.EndPoint = new Point(1, 0);

Rectangle rect = new Rectangle();            
rect.Width = 100;
rect.Height = 100;
rect.Fill = brush;
Canvas.SetLeft(rect, 50);
Canvas.SetTop(rect, 50);
MyCanvas.Children.Add(rect);

Rectangle rect2 = new Rectangle();
rect2.Width = 300;
rect2.Height = 100;
rect2.Fill = brush;
Canvas.SetLeft(rect2, 50);
Canvas.SetTop(rect2, 200);
MyCanvas.Children.Add(rect2); 
```

不太对；矩形越大，渐变越宽：

![http://imgur.com/CRnXPdV](../Images/98825b0506a6eb9a536c6d86b6deff90.png)

我尝试将 MappingMode 设置为 Absolute，但这也不起作用。

```
LinearGradientBrush brush = new LinearGradientBrush();
brush.MappingMode = BrushMappingMode.Absolute;
brush.SpreadMethod = GradientSpreadMethod.Reflect;

brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#FF0000FF"), 0.0));
brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#22FFFFFF"), 0.25));

brush.StartPoint = new Point(0, 0);
brush.EndPoint = new Point(50, 0);   //I want the gradient to be across 50 pixels

Rectangle rect = new Rectangle();    
//Everything else is the same 
```

这给了我一些看起来像这样的东西：

![http://imgur.com/EBuxP7D](../Images/5bddcbd0be0b89cbfcd649a13ba0018a.png)

这是很遥远的事情。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:16:24.200

实现此目的的一种方法是创建一个`custom control`. 在;
上用 3 个矩形组成它`Grid`

*   1 列，50 像素宽，矩形填充线性渐变
*   1 列“内容”矩形填充剩余部分
*   1 列，50 像素宽，带有一个填充有线性渐变的矩形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-14T14:50:40.973

您可以使用将矩形的背景绑定到其 ActualHeight 并使用转换器，计算该宽度的百分比表示预期宽度（使用绝对值，您也可以直接设置像素）：

```
class HeightToBrushComplexPropertyConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        double height = (double)value;
        double percent = 50.0 / height;

        LinearGradientBrush brush = new LinearGradientBrush();
        brush.StartPoint = new Point(0, 0);
        brush.EndPoint = new Point(1, 0);

        brush.MappingMode = BrushMappingMode.RelativeToBoundingBox;
        brush.SpreadMethod = GradientSpreadMethod.Pad;

        brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#FF0000FF"), 0.0));
        brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#22FFFFFF"), percent));
        brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#22FFFFFF"), 1 - percent));
        brush.GradientStops.Add(new GradientStop((Color)ColorConverter.ConvertFromString("#FF0000FF"), 1));

        return brush;

    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

对此转换器的改进：接受像素数和颜色作为参数。

# sql-server-2008 - 创建新表过程

> ID：14962088
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:06.467
> 
> 标签：sql-server-2008

我正在尝试创建一个向数据库添加/删除表的过程。我在 SQL Server 中工作。查询有效（成功），但表未添加到数据库中。

我确实刷新了...

```
ALTER procedure [dbo].[upgrade_1]
as
begin
    create table awards (
    ID int NOT NULL IDENTITY,   
    name nvarchar(256) DEFAULT 'award',
    description nvarchar(256)
    PRIMARY KEY (ID)
    )
    /*update goto_vs
    set current_version = 1*/
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:25:07.593

您在问题中的脚本只会修改 PROCEDURE。需要执行该过程才能执行所需的任务，例如创建表

使用此语句执行过程

```
EXEC upgrade_1 
```

那应该创建表

# javascript - AppJs 作为浏览器

> ID：14962089
> 
> 赞同：1
> 
> 时间：2013-02-19T16:13:06.437
> 
> 标签：javascript, node.js, browser, chromium, appjs

我最近开发了一个运行在 node.js 上的 Web 应用程序，可以在 nodejitsu 上在线获取。现在我的客户想要一个独立的桌面应用程序，而我的想法是在 AppJS 上。所以现在的问题是，有没有办法将 AppJS 用作“浏览器”，因为它基于 Chromium。这会很整洁，因为完整的 App Logic 和前端位于服务器上，所以我只需将 AppJS 引用到 URL 即可。DesktopApp 感觉将被服务，并且导航都在前端。不需要后退和前进浏览器按钮或地址栏。

这么多的目标。我只是通过将 AppJS index.html 重定向到我的服务器 URL 来尝试这个。第一个站点显示正常，但是当我尝试登录时，遇到了这个错误：

```
app.sh: line 4:  1734 Bus error: 10           $basedir/data/bin/node --harmony $basedir/data/app.js 
```

有什么建议么 ？AppJS 有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T12:53:41.333

您的问题类似于我在上一篇文章中回答的问题（[如何将 appjs 连接到 nodejs 服务器并显示其内容](https://stackoverflow.com/questions/14880557/how-to-connect-appjs-to-nodejs-server-and-show-its-content/15407709#15407709)）。因此，我将在这里重复相同的内容，希望它能满足您的需求。

是的，可以让 AppJS 作为您网站的浏览器。

为了让您的网站像 Web 浏览器一样显示在 AppJS 窗口中，这是 AppJS 的主要意图之一，您可以采取以下两 (2) 步骤中的任何一个；

1.  在位于“data/content/”的 index.html 文件中创建一个 IFRAME（填充宽度和高度）。

    将 IFRAME SRC 设置为您的网站 url。

    例如 <iframe src="http://www.YourWebsite.com">

    当 app.exe 启动时，这将在 AppJS 窗口中显示您的网站。

    注意：您可能希望使用 CSS 使 iframe 填充窗口的 100% 宽度和 100% 高度。

2.  更改“data/node_modules/appjs/lib/settings.js”处的代码行

    从

    网址：'ht tp://appjs',

    至

    网址：' [http](http://www.YourWebsite.com) ://www.YourWebsite.com '

大多数时候我选择第一个选项，因为它允许我使用 CSS 做很多事情。这包括在 IFRAME 的背景上放置一个动画 GIF，以指示在启动时页面加载。

只有当我想让我的实际网站 URL 在尝试黑客攻击时更难找到时，我才会选择第二个选项。同时仍然保留“数据/内容”目录及其内容未删除。

我希望这对你有用。

# spring - Spring FilterSecurityInterceptor 按主机过滤 url

> ID：14962092
> 
> 赞同：2
> 
> 时间：2013-02-19T16:13:14.837
> 
> 标签：spring, spring-security

我正在尝试在我的 Web 应用程序中实现 Spring Security。问题是我的网络可以在两种环境下工作，b2b 和 b2c。

b2b环境需要通过用户名和密码进行spring安全控制，b2c只需要几页。

例如：

```
 www.myb2b.com/home  -> login required
  www.myb2c.com/home  -> no login required
  www.myb2c.com/private/admin  -> login required 
```

最重要的过滤器是第一个和第二个，第三个过滤器可以通过其他系统实现。

我怎样才能做到这一点？

我正在尝试配置自定义 FilterSecurityInterceptor 来覆盖 doFilter 功能。但我有冲突的错误。

我的 appContext-web-security.xml （不完全是因为仍在开发中）：

```
<beans:beans
xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                    http://www.springframework.org/schema/security
                    http://www.springframework.org/schema/security/spring-security-3.1.xsd">
    <http auto-config="false" use-expressions="true" entry-point-ref="loginUrlAuthenticationEntryPoint">
        <custom-filter position="FILTER_SECURITY_INTERCEPTOR" ref="filterSecurityInterceptor" />

        <intercept-url pattern="/**" access="ROLE_USER" />
    </http>

    <beans:bean id="loginUrlAuthenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
        <beans:property name="loginFormUrl" value="/login"/>
    </beans:bean>

    <beans:bean id="filterSecurityInterceptor" class="com.hotelbeds.tuiuk.web.spring.CustomSecurityInterceptor">
        <beans:property name="observeOncePerRequest" value="true"/>
        <beans:property name="authenticationManager" ref="authenticationManager" />
        <beans:property name="accessDecisionManager" ref="accessDecisionManager" />
    </beans:bean>

    <beans:bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
        <beans:property name="decisionVoters">
            <beans:list>
                <beans:bean class="org.springframework.security.access.vote.RoleVoter" />
            </beans:list>
        </beans:property>
    </beans:bean>

    <authentication-manager alias="authenticationManager">
        <authentication-provider>
            <password-encoder hash="sha-256" />
            <user-service>
                <user name="admin"
                    password="8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918"
                    authorities="ROLE_ADMIN" />
                <user name="user"
                    password="04f8996da763b7a969b1028ee3007569eaf3a635486ddab211d512c85b9df8fb"
                    authorities="ROLE_USER" />
            </user-service>
        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:41:59.580

如果我清楚您的要求，则无需任何代码级自定义即可轻松实现：

```
<bean id="b2bHostMatcher" class="org.springframework.security.web.util.ELRequestMatcher">
    <constructor-arg value="hasHeader('host','myb2b.com')"/>
</bean>

<bean id="b2cHostMatcher" class="org.springframework.security.web.util.ELRequestMatcher">
    <constructor-arg value="hasHeader('host','myb2c.com')"/>
</bean>

<security:http request-matcher-ref="b2bHostMatcher" ...>
    <!-- config for b2b requests -->
</security:http>

<security:http request-matcher-ref="b2cHostMatcher" ...>
    <!-- config for b2c requests -->
</security:http> 
```

请注意，您的 IDE 可能会抱怨这两个`<http>`元素都没有`pattern`属性，但您可以放心地忽略它，因为只有当它们都使用 default 时才会出现问题`AntPathRequestMatcher`。

# search - PayPal NVP API 在 TransactionSearch 中跳过交易

> ID：14962093
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:18.163
> 
> 标签：search, transactions, paypal, missing-data, paypal-nvp

我正在使用 PayPal NVP API 来搜索和下载交易。当STARTDATE 和ENDDATE 之间的时间间隔太大，即4 个月左右时，就会出现问题。然后我收到 100 笔交易/电话，但其中一些丢失了。如果间隔更小，即一个月，则会出现更多的事务，这些事务以前被跳过。

什么会导致这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:29:24.213

发生这种情况是因为 PayPal 以相反的顺序发送数据，并且每次调用返回 100 笔交易的限制。

因此，如果您指定 1 年前的开始日期和今天的结束日期，您将获得从今天开始的 100 个最近的交易，而不是从您的开始日期开始的 100 个最旧的交易。

我知道避免此问题的唯一方法是确保您使用较小的日期范围并在下载大量数据时进行多次 API 调用。建立历史数据后，您只需在未下载的交易数量超过 100 之前进行常规 API 调用。

编辑：同样重要的是要注意 PayPal 在两个单独的行上返回实际交易及其对该交易的费用扣除。因此，尽管他们说一次调用最多返回 100 笔交易，但实际上只有 50 笔实际交易加上 50 笔费用“交易”。如果您请求的下载时间范围内有超过 50 笔实际交易，您几乎可以肯定最终会丢失交易。

# jquery - 查找并复制 FORM 标签

> ID：14962094
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:19.880
> 
> 标签：jquery

我需要在元素中找到一个表单标签并复制它。我觉得我已经很接近了，但还不是很接近。他是我到目前为止所拥有的：

**JS**

```
if ($('#myElement').find('form').length > 0) {
        var myFormTag= $('#myElement').find('form').html();         
} 
```

**HTML**

```
<div id="myElement">
    <h1>
        blah
    </h1>

    <form action="blah.php" method="post">              

        <table>
        <tr>
            <td>
                <select>
                    <option>option
                </select>
            </td>
            <td>
                <input type="text">
            </td>
        </tr>
        </table>
    </form>
</div> 
```

我只需要返回开始标签：

```
<form action="blah.php" method="post"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:19:54.630

**更新：**

[演示](http://jsbin.com/omedet/6/)

```
$(document).ready(function(){
  var $myForm = $('#myElement').find('form').clone().empty();
  var myFormTag = $myForm[0].outerHTML.split("</")[0];
}); 
```

**结果：** `<form action="blah.php" method="post">`

# java - 使用 powermock 模拟枚举实例化

> ID：14962095
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:21.207
> 
> 标签：java, unit-testing, junit, easymock, powermock

我有以下代码要测试：

```
Public MyClass() {

    public static final boolean myFunc(int param1, String param2, long param3) {

        SomeInterface var1 = SomeEnumImplementingSomeInterface.INSTANCE;
        SomeOtherInterface var2 = var1.getInstanceOfSomeOtherInterface();

        String str = var2.getValue();

        if (str.equals("ABCD"))
            return true;
        else 
            return false;
    }
} 
```

有什么方法可以在这里将模拟对象分配给 var1 吗？

我能想到的一种解决方法是将 var1 声明为类变量（在这种情况下它必须是静态的，因为访问它的方法是静态的），然后通过白盒将模拟对象分配给它。但我不想仅仅为了测试而改变设计。

请避免建议我更改课程设计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:00:51.590

您可以使用包或受保护的方法来设置 var1 值，并且在您的测试中，如有必要，您可以覆盖您的类来设置模拟对象，类似于：

```
public MyClass() {

    public static final boolean myFunc(int param1, String param2, long param3) {

        SomeInterface var1 = getVar1();
        SomeOtherInterface var2 = var1.getInstanceOfSomeOtherInterface();

        String str = var2.getValue();

        if (str.equals("ABCD"))
            return true;
        else 
            return false;
    }

    SomeInterface getVar1() {
        return SomeEnumImplementingSomeInterface.INSTANCE;
    }
}

public MyClassTest {

    private MyClass myClassUnderTest = new MyClass() {
        @Override
        SomeInterface getVar1() {
            return SomeEnumImplementingSomeInterface.INSTANCE;
        }
    } 

    public void testMyFunc() {
        // do test stuff with myClassUnderTest
    }
} 
```

# php - 子域上无法识别 Cookie

> ID：14962098
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:29.347
> 
> 标签：php, javascript, cookies

我有一个域和一个子域，我都需要它们来识别主域设置的 cookie。在 www.mydomain.com 上，我使用 Javascript 设置 cookie，如下所示：

```
var d = new Date();
d.setDate(d.getDate() + 30);
var c = "all; expires=" + d.toUTCString() + "; path=/;domain=mydomain.com";
document.cookie = "cookies=" + c; 
```

在 PHP 中，我使用了一个简单的`if (isset($_COOKIE['cookies'])) ...`This 适用于 www.mydomain.com，但不适用于 sub.mydomain.com。

有什么建议么？我是否必须在 PHP 中以不同的方式调用 cookie？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:17:00.680

更改`domain=mydomain.com`为`domain=.mydomain.com`（注意前面的点）。然后 cookie 将应用于所有子域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:15:39.833

```
var d = new Date();
d.setDate(d.getDate() + 30);
var c = "all; expires=" + d.toUTCString() + "; path=/;domain=.mydomain.com";
document.cookie = "cookies=" + c; 
```

# io - 错误的输入流

> ID：14962100
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:39.820
> 
> 标签：io, stream, common-lisp

我正在尝试将一些参数传递给一个将列添加到平面文件的新函数。电话是这样的：

```
(add-col-to-ff '(:absolute "home" "lambda" "Documents") "test-col-col"
               '(:absolute "home" "lambda" "Documents") "test-col-ff"     
               '(:absolute "home" "lambda" "Documents") "test-col-new.txt") 
```

但是 SLIME 返回错误：

```
#<SB-SYS:FD-STREAM for "file /home/lambda/Documents/test-col-new.txt" 
{B50D7E1}> is not a character input stream.
[Condition of type SIMPLE-TYPE-ERROR]
Backtrace:
  0: (SB-KERNEL:ILL-IN #<SB-SYS:FD-STREAM for "file /home/lambda/Documents/test-    
     col-new.txt" {B50D7E1}>) 
```

我想知道，我在这里错过了什么？流布局似乎很好：

```
(defun add-col-to-ff (col-dir col-file 
                      ff-dir ff-file 
                      out-dir out-file)
  (let ((M (make-ff-array ff-dir ff-file))
        (vec (vec-from-1col-ff col-dir col-file))
        (path (make-pathname :name out-file 
                             :directory out-dir)))
    (with-open-file (addcol-str path :direction :output)
      (do ((line (read-line addcol-str nil 'eof)
                 (read-line addcol-str nil 'eof))
           (i 0 (1+ i)))
          ((eql i (array-dimension M 1))) 
          (dotimes (k (array-dimension M 0))
            (cond ((eql (1+ k) (array-dimension M 0))
                   (format addcol-str "~A ~A~%" (aref M i k) (svref vec k)))
                  ((and (eql (1+ i) (array-dimension M 1)) 
                        (eql (1+ k) (array-dimension M 0)))
                   (format addcol-str "~A ~A"  (aref M i k) (svref vec k)))
                  (t (format addcol-str "~A " (aref M i k))))))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:25:57.707

你打开一个**输出**流。**但随后**您尝试使用`READ-LINE`. 这自然是行不通的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:52:40.610

按照接受的答案，我将`do`宏替换`dotimes`为如下：

```
(defun add-col-to-ff (col-dir col-file 
                      ff-dir ff-file 
                      out-dir out-file)
  (let ((M (make-ff-array ff-dir ff-file))
        (vec (vec-from-1col-ff col-dir col-file))
        (path (make-pathname :name out-file 
                             :directory out-dir)))
    (with-open-file (addcol-str path :direction :output)
      (dotimes (i (array-dimension M 0)) 
          (dotimes (k (array-dimension M 1))
            (cond ((eql (1+ k) (array-dimension M 0))
                   (format addcol-str "~A ~A~%" (aref M i k) (svref vec k)))
                  ((and (eql (1+ i) (array-dimension M 0)) 
                        (eql (1+ k) (array-dimension M 1)))
                   (format addcol-str "~A ~A"  (aref M i k) (svref vec k)))
                  (t (format addcol-str "~A " (aref M i k))))))))) 
```

奇迹般有效。

# bash - [bash]如何给 ftp 传输的文件添加时间戳

> ID：14962101
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:41.973
> 
> 标签：bash, ftp, timestamp

我的 bash 脚本得到一个 txt 文件，由用户名和密码组成，通过 ftp 扫描它并连接到具有这些凭据的主机。

然后它会尝试做一些 ncftpput。我想在传输的文件中添加它们的创建日期。

我怎样才能做到这一点？

```
PSEUDOCODE

while read a b{
      ncftpput -u $a -p $b hostFTP $folder_src $folder_dest
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:49:21.590

我不熟悉`ncftpput`，但您可以使用该`date`命令获取时间戳：

```
TIME_STAMP=`date +"%Y%m%d_%H%M%S"`
# Becomes something like 20130219_115000 
```

只需将`$TIME_STAMP`变量用作结果文件名的一部分。

# iphone - NSOperationQueue 在 1 分钟（60 秒）内完成并发操作

> ID：14962103
> 
> 赞同：1
> 
> 时间：2013-02-19T16:13:43.400
> 
> 标签：iphone, ios

我在使用`NSOperationQueue`and `NSOperation`with 时遇到问题`AFNetworking`。当我启动一个`NSOperation`与 WebService 连接的连接，`MaxConcurrentOperationCount > 1`然后在收到超时 1 分钟后。

相反，如果启动相同的操作，`MaxConcurrentOperationCount = 1`则操作会在 2 分钟后正确完成。

有任何想法吗？

提前致谢。

# c# - 如何为折叠的属性设置动画？

> ID：14962106
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:46.940
> 
> 标签：c#, .net, wpf, animation

我需要`COLLAPSED`通过 C# 为属性设置动画。

我有下面的代码，除了没有折叠动画外，它几乎可以正常工作。

有什么线索吗？

```
var myElement = stackObj.Children[n];

Duration d = TimeSpan.FromSeconds(2);
Storyboard sb = new Storyboard() { Duration = d };
DoubleAnimation DA = new DoubleAnimation() { From = 1, To = 0, Duration = d };

ObjectAnimationUsingKeyFrames objectAnimationUsingKeyFrames = new ObjectAnimationUsingKeyFrames();

var discreteObjectKeyFrame = new DiscreteObjectKeyFrame()
{
   KeyTime = KeyTime.FromTimeSpan(TimeSpan.FromSeconds(2)) 
};

objectAnimationUsingKeyFrames.KeyFrames.Add(discreteObjectKeyFrame);

Storyboard.SetTarget(objectAnimationUsingKeyFrames, myElement);
Storyboard.SetTargetProperty(objectAnimationUsingKeyFrames, new PropertyPath("Visibility.Collapsed"));

sb.Children.Add(DA);
string myObjectName = "r" + n;
Storyboard.SetTargetName(DA, myObjectName);

Storyboard.SetTargetProperty(DA, new PropertyPath("Opacity"));
sb.Begin(this);

n++; 
```

我知道在 XAML 中应该是这样的

```
<BeginStoryboard>
    <Storyboard>
        <DoubleAnimation
            Storyboard.TargetProperty   = "Opacity"
            To                          = "0"
            BeginTime                   = "0:0:0"
            Duration                    = "0:0:2" />
         <ObjectAnimationUsingKeyFrames
            Storyboard.TargetProperty   = "Visibility">
            <DiscreteObjectKeyFrame KeyTime="0:0:2"   Value="{x:Static Visibility.Collapsed}" />
         </ObjectAnimationUsingKeyFrames>
    </Storyboard>
</BeginStoryboard> 
```

但我不知道我必须实现哪个 C# 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:07:03.560

对于需要这种动画的人，您可以复制/粘贴代码并且它正在工作！:)

**XAML**

```
 <StackPanel Background="bLACK" Name="stackObj">
            <Rectangle Name="r0" Width="100" Height="50" Fill="#FFDA2121" ></Rectangle>
            <Rectangle Name="r1" Width="100" Height="50" Fill="#FFDA2121" ></Rectangle>
            <Rectangle Name="r2" Width="100" Height="50" Fill="#FFD8C828" ></Rectangle>
            <Rectangle Name="r3" Width="100" Height="50" Fill="#FF17D829" ></Rectangle>
            <Rectangle Name="r4" Width="100" Height="50" Fill="#FF0DE080" ></Rectangle>
            <Rectangle Name="r5" Width="100" Height="50" Fill="#FF2E5CF9" ></Rectangle>
            <Rectangle Name="r6" Height="50" Width="100" Fill="#FFDA2121"/>
            <Rectangle Name="r7" Height="50" Width="100"  Fill="#FFDA2121"/>
            <Rectangle Name="r8" Height="50" Width="100" Fill="#FFDA2121"/>
        </StackPanel> 
```

**C＃**

```
 public partial class MainWindow : Window
    {
        DispatcherTimer timer = new DispatcherTimer(DispatcherPriority.Background);

        public MainWindow()
        {
            InitializeComponent();
            Loaded += MainWindow_Loaded;
        }

        void MainWindow_Loaded(object sender, RoutedEventArgs e)
        {
            timer.Interval = TimeSpan.FromSeconds(3);
            timer.Tick += timer_Tick;
            timer.Start();

            sb = new Storyboard();
        }
        int n = 0;
        bool isWorking;
        Storyboard sb;
        void timer_Tick(object sender, EventArgs e)
        {
            if (isWorking == false)
            {
                isWorking = true;
                try
                {
                    var myElement = stackObj.Children[n];

                    var dur = TimeSpan.FromMilliseconds(2000);

                    var f = CreateVisibility(dur, myElement, false);

                    sb.Children.Add(f);

                    Duration d = TimeSpan.FromSeconds(2);
                    DoubleAnimation DA = new DoubleAnimation() { From = 1, To = 0, Duration = d };

                    sb.Children.Add(DA);
                    string myObjectName = "r" + n;
                    Storyboard.SetTargetName(DA, myObjectName);

                    Storyboard.SetTargetProperty(DA, new PropertyPath("Opacity"));

                    sb.Begin(this);

                    n++;
                }
                catch (Exception ex)
                {
                    Debug.WriteLine(ex.Message + "   " + DateTime.Now.TimeOfDay);
                }

                isWorking = false;
            }
        }

        private static ObjectAnimationUsingKeyFrames CreateVisibility(Duration duration, UIElement element, bool show)
        {
            var _Two = new DiscreteObjectKeyFrame { KeyTime = new TimeSpan(duration.TimeSpan.Ticks / 2), Value = (show ? Visibility.Visible : Visibility.Collapsed) };

            var _Animation = new ObjectAnimationUsingKeyFrames { BeginTime = new TimeSpan(0) };
            _Animation.KeyFrames.Add(_Two);
            Storyboard.SetTargetProperty(_Animation, new PropertyPath("Visibility"));
            Storyboard.SetTarget(_Animation, element);
            return _Animation;
        }

    } 
```

# php - 页面标题字段中的 JavaScript clean-URL

> ID：14962108
> 
> 赞同：2
> 
> 时间：2013-02-19T16:13:51.850
> 
> 标签：php, javascript, regex, short-url

我的表单中有一个字段，其中提供了我要添加到我的 CMS 的新页面的名称。

我在这里有一个 PHP 代码，它小写，设置“-”而不是“”，并使短 URL 看起来不错：

```
$clean = iconv('UTF-8', 'ASCII//TRANSLIT', $string);
$clean = preg_replace("/[^a-zA-Z0-9\/_| -]/", '', $clean);
$clean = strtolower(trim($clean, '-'));
$clean = preg_replace("/[\/_| -]+/", '-', $clean); 
```

我对 JavaScript 的 RegEx 没有经验，所以任何人都可以帮我将这段 PHP 代码转换为 JavaScript。

谢谢你们！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T16:25:01.637

一口气：

```
var string = "The   new page's future name!"
,   clean = string.replace(/(^\-+|[^a-zA-Z0-9\/_| -]+|\-+$)/g, '')
            .toLowerCase()
            .replace(/[\/_| -]+/g, '-')
;
console.log(clean); // "the-new-pages-future-name" 
```

第一个`replace`处理所有不需要的字符并在开始和结束时修剪所有额外的破折号。第二个替换用连字符替换所有（组）斜线、下划线、竖线和空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:24:26.623

您不需要在 javascript 中的字符集之间进行转换。这是其余部分的非常文字版本。

```
clean = clean.replace(/[^a-zA-Z0-9\/_| -]/g, '');
clean = clean.replace(/^[\-]+/, ''); // trim start
clean = clean.replace(/[\-]+$/, ''); // trim end
clean = clean.toLowerCase();
clean = clean.replace(/[\/_| -]+/g, '-'); 
```

或者在一个声明中

```
 clean = clean.replace(/[^a-zA-Z0-9\/_| -]/g, '').replace(/^[\-]+/, '').replace(/[\-]+$/, '').toLowerCase().replace(/[\/_| -]+/g, '-'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T16:18:11.777

尝试这个：

```
var string = "Some string to clean up";
string.replace(/[^a-zA-Z0-9-]+/g, '-').toLowerCase(); 
```

在我的浏览器控制台中，它产生

```
"some-string-to-clean-up" 
```

# php - PHP 将文件从一个 FTP 传输到另一个

> ID：14962109
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:52.260
> 
> 标签：php, ftp

在我的 PHP 脚本中，我需要将文件从一个 FTP 站点传输到另一个站点。我找到了一种方法，但由于文件很大，它会超时。我无法控制服务器，因此无法增加脚本执行时间。

因此，我想知道是否可以向 FTP 站点发送请求以复制文件，但 PHP 脚本会继续执行，而复制发生在后台？

如果有任何其他建议可以解决我的问题，我将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T01:46:07.407

如果您可以控制网络服务器的操作系统，最好使用该`shell_exec()`命令并使用您的本地系统资源来启动 FTP 传输。

就系统资源而言，这将更快、更有效。因为我不知道你的操作系统，所以我将由你决定在 shell 中使用 FTP 传输哪些命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T01:29:43.023

尝试 FXP ( [http://en.wikipedia.org/wiki/File_eXchange_Protocol](http://en.wikipedia.org/wiki/File_eXchange_Protocol) ) 将文件直接从服务器传输到服务器，而无需传输到客户端/从客户端传输。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:27:36.920

在脚本顶部使用[`set_time_limit(0)`](http://php.net/manual/en/function.set-time-limit.php)，请确保您不会在代码中意外创建任何无限循环，否则您必须拥有 shell 访问权限才能杀死所有僵尸进程。

# c# - 使用通用接口列表

> ID：14962110
> 
> 赞同：0
> 
> 时间：2013-02-19T16:13:53.377
> 
> 标签：c#, generics

这篇文章基于我昨天的[原始帖子](https://stackoverflow.com/questions/14941947/passing-multiple-generic-interfaces-to-a-method/14950073#14950073)。但我对我的需求不够精确，所以我会在这里再试一次。

请查看我当前的代码：

```
public interface IPosterGenerator<T> 
{
    IQueryable<T> GetPosters();
}

public class PetPosterGenerator : IPosterGenerator<PetPoster>
{
    IQueryable<PetPoster> GetPosters()
    {
        return busLogic.GetPetPosters();
    }
}

public class FlowerPosterGenerator : IPosterGenerator<FlowerPoster>
{
    IQueryable<FlowerPoster> GetPosters()
    {
        return busLogic.GetFlowerPosters();
    }
}

public class PinBoard
{
    protected List<IPosterGenerator> PosterGenerators { get; set; }  // 1\. compiler error

    public PinBoard(List<IPosterGenerator> generators)  // 2\. compiler error
    {
        this.PosterGenerators = generators;
    }

    public List<BasePoster> GetPosters()
    {
        var posters = new List<BasePoster>();

        foreach (var generator in PosterGenerators)
        {
            posters.Add(generator.GetPosters());
        }

        return posters;
    }
} 
```

我的目标是创建一个可以返回海报列表的“PinBoard”。每张海报可以是不同的类型（例如宠物海报、花卉海报等）。每张海报都有完全不同的外观、内容等。但它们都继承自 BasePoster 类。

总而言之，我将拥有大约 100 种不同类型的海报。一个具体的 PinBoard 实例可以很容易地包含 1000 张海报以及更多各种不同类型的海报（以不同的顺序）。

为了填充某个 PinBoard 的海报，我需要向 PinBoard 提供某些海报生成器的列表（生成器的数量和类型将根据上下文而变化）。每个海报类型将有一个海报生成器（例如，生成宠物海报集合的 PetPosterGenerator）。

我认为如果我所有的海报生成器都可以共享相同的（类型安全）界面会很好。这就是我介绍 IPosterGenerator 接口的原因。

**我的问题是代码无法编译**。有两个编译器错误带有相同的错误消息：*使用泛型类型“myApp.IPosterGenerator”需要 1 个类型参数*

我对错误消息并不感到惊讶，因为我没有在这些位置定义任何类型。如果我能在第一个错误的行中做这样的事情，那就太好了：

```
protected List<IPosterGenerator<T>> PosterGenerators { get; set; } 
```

但是当我这样做时，编译器找不到类型或命名空间 T。

现在我有点迷路了。也许使用通用 IPosterGenerator 接口毕竟不是一个好主意。但我确信在我的应用程序中的某个时刻，我需要知道或访问某个 IPosterGenerator 所代表的具体海报类型。

你们将如何处理这个问题？非常感谢您提前的支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:16:20.277

你通常会定义一个非泛型接口，然后让你的泛型接口继承它。像这样：

```
public interface IPosterGenerator 
{
    IQueryable GetPosters();
}

public interface IPosterGenerator<T> :
    IPosterGenerator 
{
    new IQueryable<T> GetPosters();
} 
```

要实现这个接口，你会做类似的事情

```
public class PetPosterGenerator : 
    IPosterGenerator<PetPoster>
{
    IQueryable<PetPoster> GetPosters()
    {
        return busLogic.GetPetPosters();
    }

    // Explicit interface implementation on non-generic method
    IQueryable IPosterGenerator.GetPosters()
    {
        // Invokes generic version
        return this.GetPosters();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:25:28.310

没有神奇的解决方案。如果你想使用泛型，*你仍然需要使用它们*。我的意思是你无法避免它们。

另一方面，您可以利用*协方差*来让`IPosterGenerator<T>` `T`参数接受`BasePoster`：

```
// Check the "out" keyword in the generic parameter!
// "out" makes the T parameter covariant.
public interface IPosterGenerator<out T> where T : BasePoster
{
     IQueryable<T> GetPosters();
} 
```

现在你可以这样做：

```
public class PinBoard
{
    protected List<IPosterGenerator<BasePoster>> PosterGenerators { get; set; }

    public PinBoard(List<IPosterGenerator<BasePoster>> generators)
    {
        this.PosterGenerators = generators;
    }

    public List<BasePoster> GetPosters()
    {
        var posters = new List<BasePoster>();

        foreach (var generator in PosterGenerators)
        {
            posters.Add(generator.GetPosters());
        }

        return posters;
    }
} 
```

太简单！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:28:25.247

使用泛型是可能的：

```
public abstract class BasePoster { }
public class PetPoster : BasePoster { }
public class FlowerPoster : BasePoster { }

// NOTE the out keyword here.
public interface IPosterGenerator<out T> where T : BasePoster
{
    IQueryable<T> GetPosters();
}

public class PetPosterGenerator : IPosterGenerator<PetPoster>
{
    public IQueryable<PetPoster> GetPosters()
    {
        return Enumerable.Range(0, 5).Select(i =>
        {
            return new PetPoster();
        }).AsQueryable();
    }
}

public class FlowerPosterGenerator : IPosterGenerator<FlowerPoster>
{
    public IQueryable<FlowerPoster> GetPosters()
    {
        return Enumerable.Range(0, 5).Select(i =>
        {
            return new FlowerPoster();
        }).AsQueryable();
    }
}

public class PinBoard
{
    protected List<IPosterGenerator<BasePoster>> PosterGenerators
    {
        get;
        private set; // fixes compiler warning #1
    }

    public PinBoard(List<IPosterGenerator<BasePoster>> generators) // specify the generic type, fixes compiler warning #2
    {
        this.PosterGenerators = generators;
    }

    public List<BasePoster> GetPosters()
    {
        var posters = new List<BasePoster>();

        foreach (var generator in PosterGenerators)
        {
            posters.AddRange(generator.GetPosters()); // call AddRange not Add
        }

        return posters;
    }
} 
```

然后这个工作：

```
var generators = new List<IPosterGenerator<BasePoster>>();
generators.Add(new FlowerPosterGenerator());
generators.Add(new PetPosterGenerator());

var pinBoard = new PinBoard(generators); 
```

# cordova - Phonegap 和 Jquery Ajax 调用无法在具有正确证书的 HTTPS 上工作

> ID：14962112
> 
> 赞同：0
> 
> 时间：2013-02-19T16:14:11.953
> 
> 标签：cordova, jquery-mobile

我在用：

Phongap 2.2.0
Jquery-Mobile 1.2.0
Jquery 1.7.1

我有一个从 phonegap 应用程序到具有 HTTPS 和有效证书的服务器的 ajax 调用。

我做过的事情：

1) ajax 调用适用于 HTTP。
2) 验证证书有效（firefox 和 chrome 是这样说的）
3) 我在 plist 中有外部主机 *（如果不是，它不适用于 HTTP）

你知道问题可能是什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:39:30.180

似乎是某个地方的缓存问题。
基本上它是在设备上缓存旧的 HTTPS 证书，旧证书是无效的。
清洁一切后，现在它工作正常。

感谢您的评论。

# ios - RestKit 是否在不同的线程上执行请求？

> ID：14962126
> 
> 赞同：0
> 
> 时间：2013-02-19T16:14:32.897
> 
> 标签：ios, multithreading, restkit

正如标题所述，[RestKit](http://restkit.org/ "休息套件")是否会自动在新线程上执行我的请求？还是我必须自己做的事情？我查看了他们所有的功能描述，但没有看到任何具体的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T11:17:27.930

我快速浏览了 Restkit 源代码，发现**RKHTTPRequestOperation**是 AFHTTPRequestOperation 的子类**，**而后者又是**AFURLConnectionOperation**的子类。这是我在最后一个中发现的：

```
+ (NSThread *)networkRequestThread {
    static NSThread *_networkRequestThread = nil;
    static dispatch_once_t oncePredicate;

    dispatch_once(&oncePredicate, ^{
        _networkRequestThread = [[NSThread alloc] initWithTarget:self selector:@selector(networkRequestThreadEntryPoint:) object:nil];
        [_networkRequestThread start];
    });

    return _networkRequestThread;
} 
```

所以，回答你的问题：是的。Restkit 为请求创建一个新线程。请注意，它只为请求创建一个线程，它不会为每个请求生成一个线程。

# text - AWK 或 Sed 提取单词

> ID：14962129
> 
> 赞同：1
> 
> 时间：2013-02-19T16:14:46.163
> 
> 标签：text, sed, awk

我不知道怎么做，所以我需要一些帮助，我正在处理一个文件，只需要提取这个文件的一些子字符串。每条线用分号分隔；我只需要第一个字段和另一个字段。类似的东西如下：

输入文件：

```
nakamed;   ecd.bat  ;\\DomainD\userhome_n\nakamed;"\\DomainD\userhome_n\nakamed";"\\serverfile66\userhome\nakamed";"Migrated from standalone DFS"
tanreka;   ecd.bat serverfile60_D  ;;
tayljka;   ecd.bat  ;\\DomainD\userhome_t\tayljka;"\\DomainD\userhome_t\tayljka";"\\serverfile47\userhome_d\tayljka";"Migrated from standalone DFS"
taylpoo;   ecd.bat  ;\\DomainD\userhome_t\taylpoo;"\\DomainD\userhome_t\taylpoo";"\\serverfile32\userhome\taylpoo";"Migrated from standalone DFS"
thomcet;   ecd.bat  ;\\DomainD\userhome_t\thomcet;"\\DomainD\userhome_t\thomcet";"\\serverfile32\userhome\thomcet";"Migrated from standalone DFS"
thomdop;   ecd.bat  ;\\DomainD\userhome_t\thomdop;"\\DomainD\userhome_t\thomdop";"\\serverfile66\userhome\thomdop";"Migrated from standalone DFS" 
```

所需的输出文件：

```
nakamed;   serverfile66
tanreka;   serverfile60
tayljka;   serverfile47
taylpoo;   serverfile32
thomcet;   serverfile32
thomdop;   serverfile66 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:19:28.213

尝试使用`sed`：

```
sed -r 's/^([a-zA-Z0-9]+);.*(serverfile[0-9]+).*/\1;   \2/' file.txt 
```

或与`awk`：

```
awk '{print $1, " ", gensub(/.*(serverfile[0-9]+).*/, "\\1", $0)}' file.txt 
```

## 输出

```
nakamed;   serverfile66
tanreka;   serverfile60
tayljka;   serverfile47
taylpoo;   serverfile32
thomcet;   serverfile32
thomdop;   serverfile66 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:19:36.860

您可以通过将分号设置为分隔符来打印出第一个字段：

```
awk 'BEGIN { FS = ";" } ; { print $1 }' file 
```

# batch-file - 使用批处理文件启用组策略

> ID：14962132
> 
> 赞同：0
> 
> 时间：2013-02-19T16:14:49.117
> 
> 标签：batch-file, group-policy, gpo

如果想要永久启用或禁用 GPO，如何使用批处理文件来实现呢？我正在尝试创建一个批处理文件来更改“始终使用自定义登录背景”的设置，使其成为我公司的自定义背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:44:48.767

以编程方式修改组策略既麻烦又危险。（请参阅[此示例](https://stackoverflow.com/questions/10377617/#14690214)以将启动脚本添加到组策略。）我不确定注册表中“始终使用自定义登录背景”的设置具体在哪里，但我确定您将有多个值必须修改您期望的结果。

使用 Windows 的[组策略管理编辑器](http://mikecrowley.wordpress.com/2011/02/17/how-to-set-windows-7s-login-wallpaper-with-group-policies/)真的会更好。

# c# - 从 MVC 4 Web Api 返回匿名类型失败并出现序列化错误

> ID：14962134
> 
> 赞同：18
> 
> 时间：2013-02-19T16:14:52.170
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4, asp.net-web-api

我刚刚开始使用 MVC 4 Web API，我似乎误解了它的工作原理。

在 Web API 之前，我有一个简单的 MVC 操作方法，如下所示：

```
public JsonResult User()
{
    return Json(new
    {
        firstName = "Joe",
        lastName = "Jacobs",
        email = "joe.jacobs@gmail.com"
    });
} 
```

那会很好用。在新的 Web API 控制器中，我正在尝试做类似的事情。

```
public object User()
{
    return new
    {
        firstName = "Joe",
        lastName = "Jacobs",
        email = "joe.jacobs@gmail.com"
    }
} 
```

这失败并出现序列化错误：

> “ObjectContent`1”类型无法序列化内容类型“application/xml”的响应正文；字符集=utf-8'。

内部异常：

> 类型 '<>f__AnonymousType1`3[System.String,System.String,System.String]' 无法序列化。考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。如果该类型是一个集合，请考虑使用 CollectionDataContractAttribute 对其进行标记。有关其他支持的类型，请参阅 Microsoft .NET Framework 文档。

关于从 API 控制器返回匿名类型，我不明白什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-19T16:29:17.687

如果您查看 Fiddler（此处的示例我使用 Firefox）

![在此处输入图像描述](../Images/24d55ee4a677aedf175ade96df1a9a4d.png)

默认情况下，来自浏览器的请求将*接受*application/xml，而不是 application/json

但是，您可以通过添加一个标头从 Fiddler创建*虚假请求：*

```
Accept: application/json 
```

它会工作

从[链接](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization#json_anon)：

> XML 序列化程序不支持匿名类型或 JObject 实例。如果您将这些功能用于 JSON 数据，则应从管道中删除 XML 格式化程序，如本文后面所述。

如何删除`XmlFormatter`：

```
 var configuration = GlobalConfiguration.Configuration;
  configuration.Formatters.Remove(configuration.Formatters.XmlFormatter); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-13T13:51:09.037

您也可以使用 JsonMediaTypeFormatter，这样就不需要 JSONObject 和相关类。然后你可以在你的控制器类中返回一个动态类型。

```
public static void Register(HttpConfiguration config)
{
    config.Formatters.Clear();            
    config.Formatters.Add(new JsonMediaTypeFormatter());
    config.MapHttpAttributeRoutes();
}

public class YourController : ApiController
{        
    [HttpGet, Route("getstuff/{stuffId}")]
    public dynamic Get(string stuffId)
    {
        var stuff = Model.Stuff.Get(stuffId);

        return new {
            success= stuff != null,
            stuffId = stuff.Id,
            name = stuff.Name
        };
    }
} 
```

如果您还想支持 Jsonp，您可以继承 JsonMediaTypeFormatter 并创建自己的 JsonpMediaTypeFormatter（也可以在 stackoverflow 上找到：[https](https://stackoverflow.com/a/12492552/1138266) ://stackoverflow.com/a/12492552/1138266 ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-01T04:43:51.687

我发现 API 不喜欢返回原始列表。相反，我必须创建一个对象，并将对象的值设置为我的列表；请参阅第一个 return 语句。

例子：

```
public IHttpActionResult GetMessages(int messageFeedId, int lastMessageId) {
    List<Message> messageDomainObjects = MessageService.GetMessages(messageFeedId, lastMessageId);

    if (messageDomainObjects.Any())
    {
        var messages = messageDomainObjects.Select(m => new MessageModel(
            m.Id,
            m.Message,
            m.CreatedDate,
            m.IsActive,
            new UserModel(
                m.User.Id,
                m.User.FirstName,
                m.User.LastName
            )
        ));

        return Ok(new { messages = messages });
    }
    else
    {
        return Ok(new { });
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-21T11:50:54.323

我遇到了类似的问题，解决方案是在 `Global.asax.cs`文件中添加一个片段。

要添加的代码段如下：

```
GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings
            .ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
        GlobalConfiguration.Configuration.Formatters
            .Remove(GlobalConfiguration.Configuration.Formatters.XmlFormatter); 
```

我还将上述代码行添加到 Application_Start 方法的最顶部，使该方法看起来像这样：

```
protected void Application_Start()
    {
        GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings
            .ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
        GlobalConfiguration.Configuration.Formatters
            .Remove(GlobalConfiguration.Configuration.Formatters.XmlFormatter);

        AreaRegistration.RegisterAllAreas();
        GlobalConfiguration.Configure(WebApiConfig.Register);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
    } 
```

# jquery - jquery可排序不起作用

> ID：14962141
> 
> 赞同：0
> 
> 时间：2013-02-19T16:15:00.850
> 
> 标签：jquery, jquery-ui-sortable

我可以使用 jquery 对单个列表进行排序并在列表之间进行排序。但是，当我尝试两者都做时，单个排序的效果非常差。（貌似最后只能找到空间）好像和指定li的宽度有关。有任何想法吗。谢谢大家-我挣扎了太久。其位于的网站是： [http ://s95311055.onlinehome.us/midwives2012/sortFields-test.php](http://s95311055.onlinehome.us/midwives2012/sortFields-test.php)

jQuery

```
$(function() {
 $( "#category1, #category2" ).sortable({items: "li:not(.ui-state-disabled)",connectWith: "#removed"}).disableSelection(); 
```

});

CSS

```
._32 {
 width: 28%;
display: inline;
float: left;
padding-left: 2%;
padding-right: 2%;
padding-bottom: 2%;
margin:5px;
background-color: #FFC; 
```

}

```
 <ul class="category" id="category1"><span class="categoryHeader">List1<br></span>
  <li class="_32">num1</li>    
  <li class="_32">num2</li>    
  <li class="_32">num3</li>    
  <li class="_32">num4</li>    
  <li class="_32">num5</li>    
  <li class="_32">num6</li>                                  
  <li class="_32">num7</li>    
  <li class="_32">num8</li>    
  <li class="_32">num9</li>    
  <li class="_32">num10</li>    
  <li class="_32">num11</li>    
  <li class="_32">num12</li>        
</ul>
<ul class="category" id="category2"><span class="categoryHeader">List2<br></span>
  <li class="_32">num21</li>    
  <li class="_32">num22</li>    
  <li class="_32">num23</li>    
  <li class="_32">num24</li>    
  <li class="_32">num25</li>    
  <li class="_32">num26</li>                                  
  <li class="_32">num27</li>    
  <li class="_32">num28</li>    
  <li class="_32">num29</li>    
  <li class="_32">num30</li>    
  <li class="_32">num31</li>    
  <li class="_32">num32</li>        

</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T09:16:32.510

您的问题是 jquery sortable 中的一个已知问题。这是[错误报告](http://bugs.jqueryui.com/ticket/8792)

# java - 从列表视图连接到蓝牙设备

> ID：14962145
> 
> 赞同：2
> 
> 时间：2013-02-19T16:15:09.240
> 
> 标签：java, android, eclipse, bluetooth, connection

我试图从列表视图连接到配对的蓝牙设备，但我似乎无法正确连接。我的代码看起来不错，但是当我在手机上运行它时它什么也没做。任何帮助将不胜感激。谢谢你。

```
import java.io.IOError;
import java.io.IOException;
import java.io.InvalidObjectException;
import java.util.Set;
import java.util.UUID;
import android.app.ListActivity;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothSocket;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

public class Devices extends ListActivity {

     private ArrayAdapter<String> btArrayAdapter;
     private BluetoothAdapter btAdapter;

     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         btArrayAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
         btAdapter = BluetoothAdapter.getDefaultAdapter();
         getPairedDevices();
     }

    private void getPairedDevices() {

Set<BluetoothDevice> pairedDevices = btAdapter.getBondedDevices();
if(pairedDevices.size()>0){
    for (BluetoothDevice device :pairedDevices){
        String name = device.getName();
        btArrayAdapter.add(name);
    }
 }

 setListAdapter(btArrayAdapter);
   }

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {

Set<BluetoothDevice> device = btAdapter.getBondedDevices();
//System.out.println(device.getClass());

Thread ConnectThread = new Thread();
ConnectThread.start();

   }

   public class ConnectThread extends Thread{

private final BluetoothSocket mmSocket;
private final BluetoothDevice mmDevice;
private final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); 

public ConnectThread(BluetoothDevice device){
    BluetoothSocket tmp = null;
    mmDevice = device;

    try{
        tmp = device.createInsecureRfcommSocketToServiceRecord(MY_UUID);
    } catch (IOException e){}
    mmSocket = tmp;
}

public void run(){
    btAdapter.cancelDiscovery();

    try{
        mmSocket.connect();
    }catch (IOException connectException){

        try{
            mmSocket.close();
        }catch (IOException closeException){}
        return;

    }

    //Work to manage connection
}

public void cancel(){
    try{
        mmSocket.close();
    }catch (IOException e){}
}
 }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:38:39.423

在您的 onCreate() 方法中，您需要为您的 ListView 设置适配器。

IE

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    btArrayAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
    btAdapter = BluetoothAdapter.getDefaultAdapter();
    setListAdapter(btArrayAdapter);
    getPairedDevices();
} 
```

# php - 从容器继承 javascript onclick 并隐藏选项 我正在为我的公司创建一个内部 Web 应用程序，我遇到了 javascript 函数和 onclick 问题。有问题的页面有一个从数据库返回生成的动态列表。我遇到的唯一问题是我为我的列表项 div 容器设置了一个 onclick，它在其中将颜色更改为灰色（悬停颜色是下面看到的浅蓝色），我最近添加了一个 <select>下拉到每个项目清单。我将可见性设置为隐藏，以在未选择项目时设置为可见，在选择时设置为可见。我的问题 ID：14962148 赞同：2 时间：2013-02-19T16:15:26.457 标签：php, javascript 回答 #1 赞同：3 时间：2013-02-19T16:30:44.473 我认为防止默认行为的解决方案是： onClick=" event.preventDefault() ;" 这里的事件作为参数传递给函数。 在 IE 8 和其他一些可能存在一些问题，所以最兼容的选项是： if (event.preventDefault) event.preventDefault(); else event.returnValue = false ; 回答 #2 赞同：0 时间：2013-02-19T16:24:42.117 您需要做的是阻止事件冒泡 dom。您可以event.stopPropagation()在正确的事件处理程序中使用（单击一个选项？）。 要获得更详细的答案，您必须发布 html 和所有 javascript。据我所知，php 在这里不相关。</select>

# pdf - 混合外部参照表和外部参照流

> ID：14962151
> 
> 赞同：1
> 
> 时间：2013-02-19T16:15:29.080
> 
> 标签：pdf, pdf-generation, pdf-parsing

您确实不能在 PDF 文件中包含通用外部参照表和外部参照流吗？我以为这就是所谓的“混合 PDF 文档”！

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T18:36:08.050

混合参考文件在[ISO 32000-1](http://www.adobe.com/devnet/acrobat/pdfs/PDF32000_2008.pdf)的第 7.5.8.4 节*与不支持压缩参考流的应用程序的兼容性中进行了解释。*

> 可以构建一个称为混合参考文件的文件，该文件可供读者阅读，仅支持 PDF 1.5 之前的 PDF 版本。除了交叉引用流引用的对象流中的对象之外，此类文件还包含标准交叉引用表引用的对象。

**PS：**不过，不能随意混合两种风格。正如 Leonard Rosenthol（Adobe *PDF 架构师和首席科学家*以及相关标准化委员会成员）所说，

> 你不能“跨越溪流”（引用经典电影阶段）。
> 
> 如果原始 PDF 使用经典外部参照，则需要在附加时使用相同的外部参照。如果它使用流，则需要使用流。

*（[将外部参照表添加到带有外部参照流的 PDF？](http://forums.adobe.com/thread/1034273?tstart=30)在 Adob ​​e [PDF 语言和规范](http://forums.adobe.com/community/design_development/pdf_language_and_specifications)论坛上）*

# ios - 核心情节不缩放

> ID：14962155
> 
> 赞同：0
> 
> 时间：2013-02-19T16:15:39.130
> 
> 标签：ios, core-plot

我无法让所有绘图点都适合我的视图。

![在此处输入图像描述](../Images/46c4460c033fa569fec127e435d5b421.png) 上面屏幕截图中显示的坐标是：`x=1, y=10 and x=2, y=0`。

这是我的`UIViewController`( `GraphingViewController`) 的屏幕截图，我在这里嵌套了一个单独的视图，它是图表的主机视图。[我的图形代码与SimpleScatterPlot.m](http://code.google.com/p/core-plot/source/browse/examples/CorePlotGallery/src/plots/SimpleScatterPlot.m)完全相同，但我自定义的生成数据方法除外：

```
-(void)generateData
{
    NSMutableArray *contentArray = [NSMutableArray array];
    int counter = 0;
    for (NSNumber * entryValue in self.plotDataArray) {
        counter++;
        id x = [NSDecimalNumber numberWithInt:counter];
        id y = [NSDecimalNumber numberWithInt:[entryValue intValue]];
        [contentArray addObject:[NSMutableDictionary dictionaryWithObjectsAndKeys:x, @"x", y, @"y", nil]];
        NSLog(@"setting values for graph x: %@ and y: %@",x,y);
    }
    plotData = [contentArray retain];
} 
```

另一件奇怪的事是我可以左右滚动，但不能上下滚动。我在之前的更改中有 x,y 从开始`0,0`但隐藏了 x 轴，所以虽然它是我想要的，但我不能隐藏那条线。

如何开始图表`0,0`并能够对其进行缩放以不仅可以查看所有点，还可以查看标签（“ `X Axis`”，“ `Y Axis`”）？如您所见，Y 轴也经过`.2`，X轴经过。`.5`这些应该是`1`因为我所有的数字都是整数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:43:49.637

我实现它的方式是一样的。我跟踪数据中的最小和最大 X 和 Y 值，然后相应地设置绘图范围。

```
// Adjust the plot space according to the min and max x/y values
plotSpace.xRange = [[CPTPlotRange alloc] initWithLocation:CPTDecimalFromInt([self.minTime intValue]) length:CPTDecimalFromInt ([self.maxTime intValue] - [self.minTime intValue])];
plotSpace.yRange = [[CPTPlotRange alloc] initWithLocation:CPTDecimalFromInt([self.minScore intValue]) length:CPTDecimalFromInt (([self.maxScore intValue] - [self.minScore intValue]))]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T23:54:57.870

保持轴标签可见的简单方法是*不*设置`titleLocation`. 的默认值`NAN`会将标签定位在绘图区域的中心。

这`globalYRange`是防止垂直滚动。的默认值`nil`不限制滚动。如果您确实想要限制滚动，但需要更改绘图范围以显示新数据，请将全局范围设置为`nil`，更新绘图范围并重置全局范围。

刻度位置和轴标签由轴标签策略控制。默认的固定间隔策略将起作用，只需保留`majorIntervalLength`默认值一 (1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T18:16:27.833

你试过 scaleToFitPlots 方法吗？

```
 [plotSpace scaleToFitPlots:[NSArray arrayWithObjects:scatterPlot, nil]]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:12:07.873

我解决了问题的一部分，即没有显示的高点。这行代码限制了最大值`Y Axis`

```
CPTPlotRange *globalYRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0f)
                                                          length:CPTDecimalFromFloat(2.0f)]; 
```

所以我创建了一个属性来跟踪最大值并将其设置为：

```
CPTPlotRange *globalYRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0f)
                                                          length:CPTDecimalFromFloat(self.largestYvalue)]; 
```

所以现在我有了这个：

![在此处输入图像描述](../Images/66f6dd345d734731c62579cd12a598b7.png)

我仍然需要弄清楚如何让`X Axis`标签显示（如果我弄清楚或仍然接受答案，我会更新）。

# java - 将点与大多边形列表中的多边形匹配

> ID：14962156
> 
> 赞同：2
> 
> 时间：2013-02-19T16:15:39.753
> 
> 标签：java, algorithm, gis, polygon

我有一个很大的多边形列表（比如说大小 250,000）和一个很大的点列表（比如说大小 100,000）。我需要做的是找出每个点属于哪个多边形。

多边形始终是具有 5 个点的矩形/菱形，其中第一个点和最后一个点相同。它们还具有与多边形相关的近似中心点。示例多边形如下： Polygon(a;b;c;d;a) = (3,1; 5,3; 3,5; 1,3; 3,1) 和中心点 (x) = (3 , 3). 见下图示例：

```
 c (3,5)
         /\
        /  \
(1,3) d/    \b (5,3)
       \ x  /
        \  /
         \/
          a (3,1) 
```

这是一个简化的例子。这些点中的大多数都是经纬度/GIS 坐标。

输入的点列表可能与任何多边形都不匹配，或者可能与多边形列表中的一个或多个多边形匹配。

目前我有一个函数，它需要一个点和一个多边形来查看该点是否在多边形内。每当我想看到一个点在多边形中时，我必须遍历完整的多边形列表以查看它是否匹配。此外，由于一个点可能位于多个多边形中，因此我每次都必须遍历完整列表。这是非常低效的。

我正在寻找的是将这些多边形排序为 HashMap 或其他东西，以便我可以快速获取一些需要检查每个点的多边形，而不是完整的多边形列表。由于这些点同时具有 x 和 y 参数，因此我无法找到对多边形进行排序的好方法。另请注意，每个多边形都有一个中心点。那么有没有办法根据这些中心点作为关键点对多边形进行排序，以便我们轻松查找？

对此有任何想法/想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:02:25.403

使用 kd 树，这是一种有效的空间分区

[http://en.wikipedia.org/wiki/K-d_tree](http://en.wikipedia.org/wiki/K-d_tree)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:20:26.343

将您的 2D 空间拆分为方形单元，每个单元存储与单元相交的多边形列表。当需要检查点时，首先找到该单元点所属的单元格点，然后遍历与该单元格相交的所有多边形并进行测试。选择像元大小，以便每个像元有合理数量的多边形。

如果您的多边形分布不均匀，您可能需要使用[四叉树](http://en.wikipedia.org/wiki/Quadtree)而不是方形单元格。

# elasticsearch - 弹性搜索中的平局

> ID：14962163
> 
> 赞同：1
> 
> 时间：2013-02-19T16:15:46.563
> 
> 标签：elasticsearch

如果我使用自定义分数过滤器对 ElasticSearch 进行查询，它如何处理文档具有相同分数的情况？

它们是按照插入的顺序返回的，还是我可以指定应该如何处理这种情况？

理想情况下，如果可能的话，我希望它们以随机顺序返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T23:17:53.353

现在你正在排序`_score`。因此，您可以添加第二个排序键，其中将包含带有随机数生成器的脚本。有关几个不同的示例，请参阅[Random order & pagination Elasticsearch 。](https://stackoverflow.com/questions/9796470/random-order-pagination-elasticsearch)

# event-handling - jQuery智能事件解绑

> ID：14962167
> 
> 赞同：0
> 
> 时间：2013-02-19T16:16:01.813
> 
> 标签：event-handling, jquery

我正在尝试智能地取消绑定 jquery 中的事件，以便我可以轻松地启用/禁用它们。我试图避免使用状态变量，因为它不应该是必需的，而且它使我的共享函数非常混乱。这是我最初尝试的方法，但没有奏效。

```
var dragStart = $('#ruler').mousedown(function(e){
   position = container.offset();
   mousePosition = {
      x: e.pageX,
      y: e.pageY
   };

   var dragging = $(document).mousemove(function(e){
       var x = e.pageX - mousePosition.x;
       var y = e.pageY - mousePosition.y;

       container.offset({
           left: position.left + x,
           top: position.top + y
       });
   });

   var dragStop = $(document).mouseup(function(){
      dragStart.unbind();
      dragging.unbind();
      dragStop.unbind();
   });
}); 
```

我发现这不起作用，因为 jQuery 的事件处理函数返回对选择器中元素的引用，因此所有内容都与 $(document) 解除绑定，这在我的环境中是一个问题。

我知道我可以提出函数名称并进行有针对性的取消绑定，但是对于我必须做的所有不同的函数（不仅仅是显示的），这会使代码难以通过。有什么方法可以让我的功能类似于我在上面的代码中想要的功能？我在想这样的事情：

```
var foo;
$(<selector>).<eventType>(foo = function(){
   // DO SOMETHING
   $(<unbind button>).click(function(){
      // foo.unbind();
      // OR
      // $(<selector>).unbind(foo);
      // ???????
   });
}); 
```

我什至愿意接受创造性的解决方案。我现在可以让它工作，但我想看看我是否能以这种特殊的方式做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:03:51.203

您应该以一种赋予您对它们更多权力的方式来[命名](http://docs.jquery.com/Namespaced_Events)您的事件，所以如果说，您有一些委托事件之王`click`一直上升到`document`这样的情况：

```
$(document).on('click','a', doSomething); 
```

你可能有更多这样的东西，它一直被委托给身体，所以如果你想删除其中一个，当你`click`从文档中取消绑定事件时，你实际上会杀死所有其余的。

更好的是：

```
$(document).on('click.someName','a', doSomething);  // bind
$(document).off('click.someName','a');  // unbind 
```

想象一下页面上可能还有更多代码可能一直使用事件委托到文档，t 或其他一些元素，所以如果没有命名空间，在绑定/取消绑定事件时会发生串通

# php - 循环数据与 mysql WHERE

> ID：14962171
> 
> 赞同：0
> 
> 时间：2013-02-19T16:16:14.460
> 
> 标签：php, mysql, performance

什么会更快：

*   运行查询：
    JOIN 2 个表（18000 行，15500 行）并使用多个 WHERE（9-12 WHERE's）过滤数据，这样我只得到 15 行结果。

    我需要使用不同的 WHERE 过滤器运行此查询 4 ​​次，并且每次将结果项添加到不同的数组（4 个数组）。

或者

*   运行一次查询：
    JOIN 2 个表（18000 行，15500 行）取回所有数据，并循环遍历结果，在循环中我将有 4 个 if 语句（基本上将替换 WHERE 过滤器）并添加匹配项到数组。

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:36:00.110

用一个语句来做*这两个*怎么样：`case`

```
select (case when <where1> then 1 else 0 end) as Where1,
       (case when <where2> then 1 else 0 end) as Where2,
. . . 
```

然后，您可以带回一小部分行，并确定它们在应用程序中的位置。

您的问题很难回答，因为它取决于处理查询、返回结果以及通过应用程序中的结果集所花费的时间。一般来说，与只返回几行相比，我认为返回数万行将是一件坏事（性能方面）。但是，在某些环境中，这可能是更好的方法。

如果您的所有`where`子句都返回不相交的行集，那么您可以将它们放在单个派生列中：

```
select (case when <where1> then 'where1'
             when <where2> then 'where2'
             . . .
        end) as which 
```

# javascript - Chrome 插件 Dropbox 集成

> ID：14962174
> 
> 赞同：1
> 
> 时间：2013-02-19T16:16:20.940
> 
> 标签：javascript, google-chrome, dropbox

我想开发一些支持 Dropbox 的 Chrome 插件，以将用户数据文件保存在用户的 Dropbox 帐户中。

*   用户应登录 Dropbox 帐户
*   用户数据应以 JSON 格式存储在 Dropbox 中

那么，仅使用 Dropbox Javascipt API 就可以实现这样的集成场景吗？或 实现此目的的步骤是什么？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:53:46.223

是的。[在此处](https://www.dropbox.com/developers/apps)注册应用程序，您应该只需要应用程序文件夹权限。一旦完成，您就可以通过[Core API](https://www.dropbox.com/developers/core)作为文件系统完全访问该文件夹。[您可以创建一个文件并使用writeFile](http://coffeedoc.info/github/dropbox/dropbox-js/master/classes/Dropbox/Client.html#writeFile-instance)将其写入用户的 Dropbox，然后在必要时将其读回。您需要注意的一个问题是用户编辑文件并弄乱了一些东西。如果您要将有用的副本存储在某个地方，您可以检查它是否已更改并拒绝用户更改，但需要注意一些事项。希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:19:20.183

将数据保存在与 Chrome 同步的 Google 帐户上会更有意义，尤其是对于诸如设置之类的琐碎数据。

[如何同步不同电脑上的 Chrome 扩展数据？](https://stackoverflow.com/questions/4901024/how-to-synchronize-chrome-extension-data-on-different-computers)

# html - 在表格单元格的右下角添加下标

> ID：14962178
> 
> 赞同：6
> 
> 时间：2013-02-19T16:16:23.917
> 
> 标签：html, css, html-table

我正在尝试将子脚本添加到 html 表格单元格中，使其看起来像这样：

![在此处输入图像描述](../Images/5e8f53a90f4fb019ee444bba5efee9f3.png)

（单元格中的 5 和右下角的 99）

这是一些示例html：

```
<table class="yearTable">
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td class="dayCell">5
            <div class="daySubscript">99</div>
        </td>
    </tr>
</table> 
```

和我正在使用的 CSS：

```
.yearTable td{
    border:1px solid #CCCCCC;
    width:45px;
    height:45px;
    text-align:center;
    vertical-align:middle;
}

.dayCell 
{
    color:Black;
    background-color:Aqua;
    position: relative;
}

.daySubscript {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;  
      z-index: 10;
    text-align:right;
    vertical-align:bottom;
} 
```

问题是下标显示在IE8的右上角，而在Firefox中根本不显示

IE 中的示例输出：

![在此处输入图像描述](../Images/f91ddef9a97866d6082860b7591c52b2.png)

我尝试将单元格中的测试移动到一个单独的 div 中，我可以覆盖它们但不能偏移它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T17:12:10.423

尝试将您的元素定位在右下角，

要查看这项工作：http: [//jsfiddle.net/bfSVk/](http://jsfiddle.net/bfSVk/)

```
.daySubscript {
    /* width: 100%; */
    /* height: 100%; */
    position: absolute;
    bottom:0; /* top: 0; */
    right:0; /* left: 0; */
    z-index: 10;
    text-align:right;
    vertical-align:bottom;
}

.yearTable td{
    border:1px solid #CCCCCC;
    width:45px;
    height:45px;
    text-align:center;
    vertical-align:middle;
    position:relative; /* establish relationship with children position absolute */
}

.yearTable {
    position:relative;
    /* establish relationship with children-children position absolute */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:37:12.463

html 中有一个子元素专门用于下标，尝试使用它并查看它的外观而不对其应用任何样式。

[用下面的替代解决方案编辑]

```
 .dayCell sub {
    position: absolute;
    margin-top: 13px;
    margin-left: 3px;
    font-size: 11px;
  } 
```

示例 jsFiddle：http: [//jsfiddle.net/functionfirst/hjyvJ/](http://jsfiddle.net/functionfirst/hjyvJ/)

此替代解决方案使用您的原始绝对位置但不设置顶部/左侧位置，而是使用边距来偏移下标文本。此方法从文档工作流程中取出，但不会设置其*相*对于元素的位置，因为您没有指定顶部/左侧位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T17:14:07.950

放那个，我将最高值更改为 10 并且它可以工作。尝试，

```
.daySubscript {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 10;
    left: 0;  
      z-index: 10;
    text-align:right;
    vertical-align:bottom;
} 
```

# joomla - 在 Joomla 2.5 中创建两个具有相同名称的日期字段

> ID：14962180
> 
> 赞同：1
> 
> 时间：2013-02-19T16:16:35.397
> 
> 标签：joomla, joomla2.5

我正在构建 joomla 组件，因此在管理部分，我正在添加多个记录，例如，如果我按下添加两个新的文本框，其中 Joomla 日期字段创建为同名，依此类推。但是 datepicker 正在处理前两个盒子，它不适用于新创建的盒子。

这是 datepicker 正在处理这两个的示例代码：

开始日期：

结束日期：

因此，如果我按添加新它会创建其他两个具有相同名称的框，并且 datepicker 无法在其中工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:59:55.217

datepicker 是一个 javascript 库，您需要调用它（它不附加到 dom 元素本身，它由如下脚本加载：

```
window.addEvent('domready', function() {Calendar.setup({
                ... 
```

您应该在复制字段后调用它。这来自 com_content（管理员，您编辑文章的地方）；但是，在创建具有 id: **jform_date_id_1的新日期字段之后，您至少需要在另一个组件中拥有**

```
Calendar.setup({
    inputField: "jform_date_id_1",
    ifFormat: "%Y-%m-%d %H:%M:%S",
//  button: "jform_created_img",
    align: "Tl",
    singleClick: true,
    firstDay: 1
}); 
```

确保根据需要调整选项。由于这些来自后端组件，因此从 php 准备选项对象可能是明智的，如果您想要正确的本地化，只需在运行时编辑 inputField。

# c# - 获取 ASP MVC 4 中的 RadioButtons 表作为字典（不适用于 RadioButtonList）

> ID：14962187
> 
> 赞同：0
> 
> 时间：2013-02-19T16:16:57.533
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我有一个需要在不使用 JavaScript 的情况下发布到服务器的表单。为此，我提交了表单并创建了一个模型来解析必要的参数。

我拥有的一件事是一张 RadioButtons 表。

也就是说，我有一个包含几行的表，并且在每一行中都有一些带有单选按钮的列。每行的单选按钮属于同一个列表，即每行可以选择一个选项，但可以多于一行（例如：您可以在第 1 行选择 Radiobutton 2，在第 2 行选择 RB 3，但不能在第 1 行选择 RB2和第 1 行中的 RB3 - 但是，您可以在未选中任何 RB 的情况下保留行-)。

有什么数据结构可以让我的模型解析这个单选按钮表吗？我发现我不能使用 RadioButtonFor 和属性的名称，因为这样所有的单选按钮都属于同一个列表（并且我只能整体选择一个选项）。我不知道如何让程序知道它们应该属于同一个属性，因为据我了解，MVC 通过该属性解析每个表单元素。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:39:47.170

我建议一个`Dictionary<int, List<SelectListItem>>`. 字典的 int 键是行号，List 是每个单选按钮组的选项。

我使用“RadioButtonListFor”助手将 SelectListItems 集合转换为单选按钮组（代码如下）。在您的视图中，您将对此代码进行修改，以放入各个单选按钮周围的表格单元格中。您可以为这个函数添加一个包装 HTML 块的参数：

```
// jonlanceley.blogspot.com/2011/06/mvc3-radiobuttonlist-helper.html
        public static MvcHtmlString RadioButtonListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper,
            Expression<Func<TModel, TProperty>> expression, IEnumerable<SelectListItem> listOfValues)
        {
            var metaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
            var sb = new StringBuilder();
            sb.Append("<span class='RadioButtonListFor'> ");

            if (listOfValues != null)
            {
                // Create a radio button for each item in the list
                foreach (SelectListItem item in listOfValues)
                {
                    // Generate an id to be given to the radio button field
                    var id = string.Format("{0}_{1}", metaData.PropertyName, item.Value);

                    // Create and populate a radio button using the existing html helpers

                    var htmlAttributes = new Dictionary<string, object>();
                    htmlAttributes.Add("id", id);

                    if (item.Selected)
                        htmlAttributes.Add("checked", "checked");

                    var radio = htmlHelper.RadioButtonFor(expression, item.Value, htmlAttributes);

                    // Create the html string that will be returned to the client
                    // e.g. <label<input data-val="true" data-val-required="You must select an option" id="TestRadio_1" name="TestRadio" type="radio" value="1" />Line1</label>
                    sb.AppendFormat("<label>{0} {1}</label> ", radio, HttpUtility.HtmlEncode(item.Text));
                }
            }

            sb.Append(" </span>");
            return MvcHtmlString.Create(sb.ToString());
        } 
```

# php - 如果没有 Google 地球插件，则加载“Google 地图”

> ID：14962191
> 
> 赞同：1
> 
> 时间：2013-02-19T16:17:05.620
> 
> 标签：php, javascript, google-maps-api-3, google-earth-plugin

我正在使用地理编码位置搜索和 KMZ 覆盖在 Google 地球中创建地图。事实证明，由于必须下载插件，Google 地球可能不是构建它的最佳方式。与其完全放弃使用 Google 地球的所有工作，我希望我能找到一种方法来确定客户端 PC 是否具有 Google 地球插件，如果有，则加载选项一，如果没有，则加载选项 2。

有谁知道解决这个问题的最佳方法是什么？

这是当前的实现： [http ://www.plexicomm.net/coverage/](http://www.plexicomm.net/coverage/)

虽然我在 PHP 方面的技能低于标准，而在 JS 方面则更差，但我确信通过一些指示，我可以拼凑一些东西，使“选择”部分要么在页面内（使用 Java 脚本的一些修改，甚至失败时的简单重定向）或使用一些 PHP<->JS 代码将没有插件的人完全发送到不同的页面。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T18:34:25.203

加载 earth-API 并在加载时使用该方法`isInstalled()`检查插件是否可用。

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script  type="text/javascript">

google.load("earth", "1");
google.setOnLoadCallback(function(){
  if(google.earth.isInstalled()){
   //do something with google earth
  }else{
   //do something with google maps
  }
});
</script> 
```

# llvm - 如何选择 clang 使用的 LLVM 版本？

> ID：14962192
> 
> 赞同：2
> 
> 时间：2013-02-19T16:17:07.010
> 
> 标签：llvm, clang

也许这太明显了，但我还没有看到答案：

我尝试在 Ubuntu 下使用 clang 编译我的项目，但不幸的是 llvm 因堆栈转储而崩溃。

```
$ clang --version
Ubuntu clang version 3.0-6ubuntu3 (tags/RELEASE_30/final) (based on LLVM 3.0)
Target: i386-pc-linux-gnu
Thread model: posix 
```

我想尝试一下 LLVM 2.9，安装了它，但是我该如何选择呢？例如：

```
$ ll /usr/bin/llvm-ar*
lrwxrwxrwx 1 root root 27 Sep 12 16:43 /usr/bin/llvm-ar -> ../lib/llvm-3.1/bin/llvm-ar*
lrwxrwxrwx 1 root root 27 May 21  2012 /usr/bin/llvm-ar-2.9 -> ../lib/llvm-2.9/bin/llvm-ar*
lrwxrwxrwx 1 root root 27 Aug 27 20:31 /usr/bin/llvm-ar-3.0 -> ../lib/llvm-3.0/bin/llvm-ar*
lrwxrwxrwx 1 root root 27 Aug 28 17:49 /usr/bin/llvm-ar-3.1 -> ../lib/llvm-3.1/bin/llvm-ar*
$ ll /usr/bin/clang*
-rwxr-xr-x 1 root root 12686228 Apr 25  2012 /usr/bin/clang*
lrwxrwxrwx 1 root root        5 Apr 25  2012 /usr/bin/clang++ -> clang* 
```

Clang 作为命令只存在一次，我没有看到它的命令行选项来选择 llvm 后端。我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T20:46:41.903

Clang 与 LLVM 静态链接，因此您无法在此处尝试暗示的意义上将两者分开。

您可以按照通常的编译器安装说明单独安装 Clang 2.9，然后使用它编译您的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-13T20:47:51.807

我尝试了很多选择，这里最适合我。

删除所有现有版本的 llvm/clang。要获得完整列表，请运行以下命令：

```
dpkg -l | egrep -i "clang|llvm" 
```

就我而言，我必须至少保留“libllvm5.0:amd64”，因为许多软件包都依赖它。

[从http://releases.llvm.org/download.html](http://releases.llvm.org/download.html)下载预构建版本并验证签名。

```
gpg --verify clang+llvm-[VERSION].tar.xz.sig 
```

将内容提取到某个文件夹。

```
sudo tar -xf archive.tar -C /opt/clang+llvm-[VERSION] 
```

将此行添加到 .bashrc 的完整末尾或手动运行以更改版本。

```
export PATH="/opt/clang+llvm-[VERSION]/bin:$PATH" 
```

另一种选择可能是使用更新替代方案。

```
#!/bin/bash -ex

DIR=/opt/clang+llvm-[VERSION]/bin

sudo update-alternatives \
--install /usr/bin/clang        clang       "$DIR/clang" 100 \
--slave   /usr/bin/clang++      clang++     "$DIR/clang++" 
```

如果安装了超过 1 个版本，则使用此命令。

```
sudo update-alternatives --config clang 
```

检查系统是否配置正确。

```
llvm-config --prefix --version
clang --version 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T11:26:51.087

由于 LLVM 3.2 已经发布并且我在 Ubuntu 上，因此可以轻松修复它：

```
sudo add-apt-repository ppa:georgekola/clang
sudo apt-get update
sudo apt-get install clang 
```

# android - 缩放时增加位图的大小

> ID：14962193
> 
> 赞同：0
> 
> 时间：2013-02-19T16:17:07.190
> 
> 标签：android, bitmap, zooming, overlays

我有一个类可以处理地图上的绘制位图，问题是当你缩小图像时，图像会变大，而接近时会变小。我想做相反的事情，当你接近时变大，当你离开时变小。

我把绘画类对象：

```
public class OverlayMapa extends Overlay {

private Double latitud = 40.654722 * 1E6;
private Double longitud = -4.694444 * 1E6;

    public void draw(Canvas canvas, MapView mapView, boolean shadow) 
    {
    Projection projection = mapView.getProjection();
        GeoPoint geoPoint = new GeoPoint(latitud.intValue(), longitud.intValue());
        GeoPoint picture = new GeoPoint(latitud.intValue(),longitud.intValue());
        int zoom = mapView.getZoomLevel();

        if (shadow == false)
        {
            Point centro = new Point();
            projection.toPixels(geoPoint, centro);

            Point pPicture = new Point();
            projection.toPixels(picture, pPicture);

            Bitmap bmPicture = BitmapFactory.decodeResource(mapView.getResources(), R.drawable.picture);

            if(zoom == 21)
                Bitmap.createScaledBitmap(bmPicture, 293, 173, false);
            if(zoom == 20)
                Bitmap.createScaledBitmap(bmPicture, 260, 150, false);
            if(zoom == 19)
                Bitmap.createScaledBitmap(bmPicture, 229, 126, false);
            if(zoom == 18)
                Bitmap.createScaledBitmap(bmPicture, 200, 100, false);

            canvas.drawBitmap(bmPicture, pPicture.x - (bmPicture.getWidth()/2),pPicture.y - (bmPicture.getHeight()/2), null);
        }
    }
} 
```

# vb.net - 不同范围的可变背景颜色？

> ID：14962197
> 
> 赞同：1
> 
> 时间：2013-02-19T16:17:28.443
> 
> 标签：vb.net, visual-studio-2008, syntax-highlighting, scope

我想知道对于 vb.net / c# 是否有任何类型的 VS（最好是 2008 年）的加载项或功能可以根据变量的范围（即方法范围、内部范围）以不同方式突出显示变量（即在 if...else 内部） )、类作用域、全局作用域等等。

看起来 ReSharper 可能具有此功能，但最好使用免费软件。不过，如果您认为 ReSharper 很棒，我会全力以赴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:23:33.817

嗯，

也许你可以看到这个[问题](https://stackoverflow.com/questions/32494/visual-studio-identical-token-highlighting)的答案，我想你会找到你想要的

# html - 内容 100% 高度到窗口高度

> ID：14962198
> 
> 赞同：0
> 
> 时间：2013-02-19T16:17:32.370
> 
> 标签：html, css

我想在我的网站上有一个高度的页眉，并在页面底部固定一个页脚。我对内容块高度有疑问。

我想让内容在没有太多内容文本时拉伸到整个窗口高度，并在它大于窗口高度时拉伸到内容的整个高度。

当我将内容块设置为“高度：100%”时，它会超出屏幕（忽略标题块高度）。

考虑到标题的高度，如何使它伸展到整个窗口高度？

基本示例（现在如何）：

[http://cssdesk.com/Tcs98](http://cssdesk.com/Tcs98)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:55:34.020

您遇到的问题是 CSS 中没有办法说如果这个元素是 X 高那么这个元素应该是 Y 高。[（还没有）](http://www.w3.org/TR/css3-conditional/)

您需要使用脚本来获取窗口的高度并将其与内容的高度进行比较。

我为此使用 jQuery，因为它很简单，并且不需要一大堆特定于浏览器的检查即可在许多浏览器上工作：

```
$(function(){
    if($('.content').height() < $(window).height() - 225){
        $('.content').css('height',($(window).height() - 225) + 'px');
    }
}); 
```

这将获取 DOM 就绪时内容的高度，并将其与 Window 的高度减去页眉和页脚的高度进行比较。

如果它小于窗口高度减去页眉和页脚（实际上是您的内容区域），那么它将高度设置为该值。

那么你需要修改当前的 CSS 并移除内容的 100% 高度并在底部添加 25px 的填充为页脚腾出空间。

[这是一个大内容的例子。](http://jsfiddle.net/WZvzg/2/)[这是一个小内容的](http://jsfiddle.net/WZvzg/1/)例子

当然这是一个简单的例子，不处理窗口大小调整。

编辑：在花了一天的时间思考之后，我意识到让它完全响应并不难。

```
var initialHeight, contentHeight;

$(function(){    
    initialHeight = $('.content').height();
    contentHeight = $(window).height() - 225;

    if(initialHeight < contentHeight ){
        $('.content').css('height',contentHeight + 'px');
    }

    $(window).resize(function(){
        contentHeight = $(window).height() - 225;
        if(initialHeight < contentHeight){
            $('.content').css('height',contentHeight + 'px');    
        }else{
            $('.content').css('height',initialHeight + 'px');
        }
    });
}); 
```

使用上面的代码，窗口和内容高度无关紧要；它总是会调整大小以适应“内容”区域。

您将“内容”区域定义为未被页脚和页眉占用的“窗口”数量。然后在第一次加载窗口时获取内容元素的高度。如果内容区域比内容元素大，则设置与内容区域匹配的新高度，如果变小，则将高度设置为与开始时相同的高度。

[这是小提琴](http://jsfiddle.net/aK9Lk/)

# ruby-on-rails - 有数组时，Rails 使用哪种方法在 DB 中创建行？

> ID：14962199
> 
> 赞同：0
> 
> 时间：2013-02-19T16:17:35.537
> 
> 标签：ruby-on-rails, ruby

这是数组数据：

```
data =  [

        # == DB Seeds == 
            ["name", "Peter", "Pan", "Ulla"],
            ["t_u_a", "4405", "6710", "8010"],
            ["t_u_b", "5590", "5590", "9080"]

] 
```

它是列名、值、值、值。

Rails 有一个很好的数组创建方法吗？

而不是我必须写：

```
 Product.create([{ name: 'Peter', tu_a_a: '4405', tu_a_b: '5590' },

    { name: 'Pan', tu_a_a: '6710', tu_a_b: '5590'  }, 

    { name: 'Ulla', tu_a_a: '8010', tu_a_b: '9080'  }]) 
```

更新：

```
[{"name"=>"name", "Peter"=>"Peter", "Pan"=>"Pan", "Ulla"=>"Ulla", nil=>nil}, 

{"name"=>"t_u_a", "Peter"=>"4405", "Pan"=>"6710", "Ulla"=>"8010", nil=>nil}, 

{"name"=>"t_u_b", "Peter"=>"5590", "Pan"=>"5590", "Ulla"=>"9080", nil=>nil}] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:29:32.337

您可以使用[ActiveRecord 创建函数](http://apidock.com/rails/ActiveRecord/Base/create/class)，但首先您需要将数据重新格式化为哈希数组，而不是二维数组，其中第一个数组是列名。这是一个快速的功能（如果你使用它，请确保你测试它，因为我没有） -

```
def convert_to_hashes(my_array)
    keys = my_array.map {|d| d[0]}
    new_array = []
    count = 0

    (1..my_array[0][0].length-1).each do |values|
        new_hash = {}
        count += 1
       (0..keys.length-1).each do |index|
            new_hash[keys[index]] = my_array[index][count]
        end
        new_array << new_hash
    end

    new_array
end 
```

所以你最终得到`[your model name].create(convert_to_hashes(my_data))`

# wpf - 带有大图像的 WPF 崩溃。HRESULT 0x88980406

> ID：14962200
> 
> 赞同：0
> 
> 时间：2013-02-19T16:17:35.460
> 
> 标签：wpf, image, canvas

我有一个非常宽的 UserControl，`60 x 50,000`它显示音频文件的波形。几个用户报告了一个 hresult 的崩溃，而谷歌`0x88980406`没有提供任何有用的信息。该应用程序使用 .Net 4.0。

```
 if (mainCanvas.Children.Count > 0)
            mainCanvas.Children.Clear();

        for (int i = 0; i < CurrentSong.waveformLines.Length; i++)
        {
            mainCanvas.Children.Add(CurrentSong.waveformLines[i]);
        }

        RenderTargetBitmap renderBitmap = new RenderTargetBitmap((int)Width, (int)Height, 96d, 96d, PixelFormats.Pbgra32);

        // needed otherwise the image output is black 
        mainCanvas.Measure(new Size((int)Width, (int)Height));
        mainCanvas.Arrange(new Rect(new Size((int)Width, (int)Height)));
        renderBitmap.Render(mainCanvas);

        Image img = new Image();
        img.Source = renderBitmap;

        if (mainCanvas.Children.Count > 0)
            mainCanvas.Children.Clear();
        mainCanvas.Children.Add(img); 
```

我正在做的是将样本值绘制为线段，然后将它们全部添加到数组中并将它们放在画布上。然后我从画布创建位图，删除所有线段，然后将位图作为 Image 控件的源添加回画布。

它崩溃了`mainCanvas.Children.Add(img)`；

# java - 为什么输出中有一个单词 null ？

> ID：14962204
> 
> 赞同：-1
> 
> 时间：2013-02-19T16:17:53.697
> 
> 标签：java

当我单击应用程序的计算按钮时，它会在 JTextField 中显示输出。但是总是前面有字符串“null”，我无法向自己解释为什么会发生这种情况。

这是相关的代码：

```
total1.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        String timeIn = tIn1.getText();
        String timeInArr[] = strtimein.split(":");
        double dblTimeInHr = Double.parseDouble(timeInArr[0]);
        double dblTimeInMin = Double.parseDouble(timeInArr[1]);
        double dblTotalTimeIn = dblTimeInHr + (dblTimeInMin/60);

        String timeOut = tOut1.getText();
        String timeOutArr[] = strtimeout.split(":");
        double dblTimeOutHr = Double.parseDouble(timeOutArr[0]);
        double dblTimeOutMin = Double.parseDouble(timeOutArr[1]);
        double dblTotalTimeOut = dblTimeOutHr + (dblTimeOutMin/60);

        totalHours = totalHours + (dblTotalTimeOut - dblTotalTimeIn);

        tal1.setText(totalHours);
     }
}); 
```

这是我的 GUI 屏幕： [![考勤卡](../Images/ae72108895898a85dda32d28615e3497.png)](https://i.stack.imgur.com/AsU12.png)

为什么会有空值？请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:22:18.577

如果您最后一个问题的代码是最近的，我猜是那一行：

```
totalHours = totalHours + (dblTotalTimeOut - dblTotalTimeIn); 
```

如果`totalHours`是`null`它将“null”与结果连接起来（由于连接而`dblTotalTimeOut - dblTotalTimeIn`隐式转换为）。`String`

请注意，`totalHours`您的代码中不包含 of 的声明，因此我不得不猜测它是 a `String`（这没有多大意义），因为您调用了`tal1.setText(totalHours);`.

# php - 如何使用 PHP heredoc 输出 Bash heredoc 块

> ID：14962213
> 
> 赞同：2
> 
> 时间：2013-02-19T16:18:12.917
> 
> 标签：php, heredoc

我需要在没有任何格式的网页上显示 bash 脚本。

bash 脚本使用标准的“此处文档”块。当我尝试使用 PHP heredoc 函数输出脚本时，它会在遇到 '<<' 子字符串时切断输出。我认为 PHP heredoc 函数不需要转义。

如何正确输出此脚本？

```
<?php

$string = $_GET["string"];

$bashscript = <<<MYMARKER
<pre>

#!/bin/sh
rm /tmp/blue.sh
cat <<INSTALL > /tmp/blue.sh
#!/bin/sh
cd /tmp
mkdir output
cd output
cat <<EOF > interface.conf
remote $string
EOF
INSTALL

</pre>
MYMARKER;

echo $bashscript;

?> 
```

我在页面上得到的输出是

```
#!/bin/sh
rm /tmp/blue.sh
cat < /tmp/blue.sh
#!/bin/sh
cd /tmp
mkdir output
cd output
cat < interface.conf
remote 
EOF
INSTALL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:23:57.597

那是因为`<INSTALL >`and`<EOF >`被解释为浏览器中的标签（虽然无法识别）。右键单击打开它->查看源代码，您会正确看到它。只需移出`<pre>`并使用[`htmlspecialchars()`](http://php.net/htmlspecialchars)即可正确显示：

```
$bashscript = <<<MYMARKER
... everything without the <pre> tags ...
MYMARKER;

echo '<pre>'.htmlspecialchars($bashscript).'</pre>'; 
```

# vba - 用于仅从某些表格单元格中删除颜色的 Word 宏

> ID：14962214
> 
> 赞同：1
> 
> 时间：2013-02-19T16:18:24.980
> 
> 标签：vba, foreach, ms-word

我正在使用以下宏来遍历 Word 文档并从其中的所有表中删除颜色，但第一个表除外。

由于使用合并字段自动填充这些文档的应用程序存在表单保护问题，我们的文档绝对不能与表单字段一起使用。所以，下一个最好的事情是只标记仍然需要用阴影填充的内容，然后在打印文档之前移除阴影。但是，当此代码遍历文档时，它会删除某些表格的一些边框。

我绝对不想要这个，我只想去除阴影。我不知道它为什么这样做，所以如果有人对此有任何见解，那将是最有帮助的。如果没有，如果我可以调整此宏以仅更改具有非白色背景颜色的单元格，那也可以。

我尝试了嵌套循环的几种变体，但无法让它以这种方式运行。

```
Sub decolordocument()
    Dim tbl As Table
    Dim first As Boolean

    first = True

    For Each tbl In ActiveDocument.Tables
        If first Then
            first = False
        Else
            tbl.Shading.BackgroundPatternColor = wdColorWhite
        End If
    Next

    MsgBox "Shaded cells in tables have been updated."
End Sub 
```

我也尝试了这段代码，并得到了相同的边框被删除效果：

```
Sub decolordocument()

    Dim tbl As Table
    Dim tblCount As Long
    Dim i As Long
    Dim first As Boolean

    tblCount = ActiveDocument.Tables.Count

    For i = 2 To tblCount
        With ActiveDocument.Tables(i).Shading
            .BackgroundPatternColor = wdColorWhite
        End With
    Next
    MsgBox "Shaded cells in tables have been updated."

End Sub 
```

编辑：虽然我仍然看不出是什么使这些表格失去了边界，但我发现以某种方式拆分表格会导致它们不会失去边界。我已经尽力将其隔离，但没有运气，因为似乎只有某种事物的组合会导致边界的丧失。但是，至少我有一些有用的东西。如果任何人都可以提供一个宏来按照最初的要求遍历各个单元格，那么放在后袋中可能不是一个坏选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:37:33.997

您必须使用`.Shading`删除背景。

我将在一份文件中进行演示。请根据您的代码进行调整。

假设您的文档如下所示

![在此处输入图像描述](../Images/5221c326025a580a6e9a952d38e01c92.png)

试试这个代码

```
Option Explicit

Sub Sample()
    Dim tblCount As Long
    Dim i As Long

    '~~> Get the Tables Count
    tblCount = ActiveDocument.Tables.Count

    '~~> If number of tables is less than 2 then exit sub
    If tblCount < 2 Then Exit Sub

    '~~> Start with 2nd table and loop
    For i = 2 To tblCount
        '~~> Remove background
        With ActiveDocument.Tables(i).Shading
            .Texture = wdTextureNone
            .ForegroundPatternColor = wdColorAutomatic
            .BackgroundPatternColor = wdColorAutomatic
        End With
    Next
End Sub 
```

这是代码运行后文档的外观

![在此处输入图像描述](../Images/220a63894300a60f3b8650d46eea93a4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:31:01.447

终于想出了一个宏来遍历单元格。出于某种原因，在我尝试这个之前，我无法让每个循环的嵌套工作。所有带阴影的单元格都是相同的灰色阴影，所以我只是比较了每个单元格，只有当它是灰色时才更改它。这不是最有效的方法，但由于这些文档很小，所以效果很好。

```
Sub decolordocument()

Dim tbl As Table
Dim tblCount As Long
Dim cll As Word.Cell
Dim i As Long

tblCount = ActiveDocument.Tables.Count

For i = 2 To tblCount
    For Each cll In ActiveDocument.Tables(i).Range.Cells
        If cll.Shading.BackgroundPatternColor = RGB(217, 217, 217) Then
            cll.Shading.BackgroundPatternColor = wdColorWhite
        End If
    Next
Next
MsgBox "Color in shaded cells has been removed."

End Sub 
```

# javascript - 包裹在标签中的可点击 img 在 IE8 中不起作用

> ID：14962216
> 
> 赞同：0
> 
> 时间：2013-02-19T16:18:28.547
> 
> 标签：javascript, jquery, html, internet-explorer

我有以下标记和 Javascript：

**[JSFiddle](http://jsfiddle.net/chridam/ft4Hb/)**

HTML：

```
<form method="get" action="some-url-here">
 <div class="UserFilter">
  <ul class="UserFilter">
   <li>
      <label class="Selected" for="1">
          <input id="1" type="radio" value="1" name="Profile" />
          <img title="User 1" alt="User 1" src="img-url-here" style="width: 50px;height: 50px" />
          User 1
      </label>
   </li>
   <li>
      <label class="Selected" for="2">
          <input id="2" type="radio" value="2" name="Profile" />
          <img title="User 2" alt="User 2" src="img-url-here" style="width: 50px;height: 50px" />
          User 2
      </label>
   </li>
  </ul>
 </div>
</form> 
```

JavaScript：

```
var labelID;
$("label img").live("click", function() {
        labelID = $(this).parent().attr('for');
        $('#'+labelID).trigger('click');        
});

$('ul.UserFilter input').click(function () {
        $('ul.UserFilter input:not(:checked)').parent().removeClass("Selected");
        $('ul.UserFilter input:checked').parent().addClass("Selected");
        //$(this).closest("form").submit();     
});

$('input:checked').parent().addClass("Selected"); 
```

CSS：

```
div.UserFilter {
    background: none repeat scroll 0 0 #EAE5DA;
    border-bottom: 1px solid #F1EEE6;
    border-top: 3px solid #0888A5;
    box-shadow: 0 5px 10px #F1F1F1;
}
div.UserFilter ul {
    display: inline-block;
}
ol, ul {
    list-style: none outside none;
}
div.UserFilter ul li label.Selected {
    background: none repeat scroll 0 0 #0888A5;
    border: 1px solid #16758B;
    color: #FFFFFF;
    text-shadow: 0 1px 0 #16758B;
}
div.UserFilter ul li label.Selected {
    background: none repeat scroll 0 0 #688ABD;
    border: 1px solid #688ABD;
    color: #FFFFFF;
    cursor: pointer;
    text-shadow: 0 1px 0 #52688A;
    transition: border-color 0.218s ease 0s;
}
div.UserFilter ul li label {
    background: none repeat scroll 0 0 #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 2px 2px 2px 2px;
    display: inline-block;
    letter-spacing: normal;
    padding: 0 5.666px 0 0;
    transition: background 0.218s ease 0s;
    word-spacing: normal;
} 
```

单击文本可以很好地选择与之关联的单选按钮（在 Firefox、Chrome 和 IE9+ 中测试）。但是，在 IE8- 中，单击图像不会选择或触发单选按钮的单击事件。任何想法、解决方案或建议都非常受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:16:57.463

我喜欢[Brad](https://stackoverflow.com/a/5601578/994820)使用`<span>`带有背景图像的解决方案。通过这种方式，您无需使用 JavaScript 即可摆脱问题。

您的 HTML 代码变为：

```
<form method="get" action="some-url-here">
 <div class="UserFilter">
  <ul class="UserFilter">
   <li>
      <label class="Selected" for="1">
          <input id="1" type="radio" value="1" name="Profile" />
          <span title="User 1" style="background-image: url('img-url-here')width: 50px;height: 50px;display: inline-block;"></span>
          User 1
      </label>
   </li>
   <li>
      <label class="Selected" for="2">
          <input id="2" type="radio" value="2" name="Profile" />
          <span title="User 2" style="background-image: url('img-url-here')width: 50px;height: 50px;display: inline-block;"></span>
          User 2
      </label>
   </li>
  </ul>
 </div>
</form> 
```

JavaScript 变得更小。您也可以删除该`$('input:checked').parent().addClass("Selected");`行，因为您`Selected`在 HTML 代码中将类设置为标签：

```
$('ul.UserFilter input').click(function () {
        $('ul.UserFilter input:not(:checked)').parent().removeClass("Selected");
        $('ul.UserFilter input:checked').parent().addClass("Selected");
        //$(this).closest("form").submit();     
}); 
```

CSS 保持不变，但您可以删除其中一个`div.UserFilter ul li label.Selected`选择器。

更新的 jsFiddle：http: [//jsfiddle.net/ft4Hb/1/](http://jsfiddle.net/ft4Hb/1/)

# java - 不按任何键的键的启动事件

> ID：14962218
> 
> 赞同：0
> 
> 时间：2013-02-19T16:18:32.353
> 
> 标签：java, android

我想启动一个键（back pe）的事件，但不按任何键。我看到了`onKeyDown`or之类的功能`onKey`，但是对于这些功能，我需要一个相应的键事件。

我也尝试在`KeyEvent`这里初始化一个：

```
KeyEvent telo = new KeyEvent(0,0,0,4,0,0,0,158,72);
onKeyDown(KeyEvent.KEYCODE_BACK, telo); 
```

但它不起作用，可能是因为我不知道`downTime`,`eventTime`和的值`deviceId`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:31:42.233

如果您希望这样做是为了测试目的。[Instrumentation](http://developer.android.com/reference/android/app/Instrumentation.html) API 允许您将关键事件发送到您自己的活动。

具体来说：

```
Instrumentation.sendKeyDownUpSync(KeyEvent.KEYCODE_BACK); 
```

看起来像你在找什么。

**编辑：**

此代码段将返回键事件发送到活动窗口。请注意，`sendKeyDownUpSync()`不能从主线程调用该方法。

```
final Instrumentation i = new Instrumentation();
Thread t = new Thread(){
    public void run(){
      i.sendKeyDownUpSync(KeyEvent.KEYCODE_BACK);
    }
};
t.start(); 
```

# javascript - jquery datepicker getTime不是UTC

> ID：14962222
> 
> 赞同：7
> 
> 时间：2013-02-19T16:18:38.723
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-datepicker, utc

我有以下代码可以正常工作，直到日期选择器达到 BST。

```
var i;
function showEventDates(date) {
  for (i = 0; i < startDates.length; i++) {
    if (date.getTime() == startDates[i]) {
      return [true, 'eventDay'];
    }
  }    
  return [false, ''];
}
var startDates = new Array();

$("select.startdates").find("option").each( function() {
  startDates.push(Date.UTC.apply(Date, this.value.split(",").map(Number)));
});

$('#mydate').datepicker({
    beforeShowDay: showEventDates
}); 
```

在 BST 期间，该行`if (date.getTime() == startDates[i]) {`返回 false，因为有一个小时的差异。

有什么想法可以让这些匹配吗？我认为日期选择器时间不是UTC。

编辑：

select.startdates 中的一个选项示例是

```
<option value="2013, 2, 1">01/03/2013</option> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T12:06:49.840

看起来 datepicker 不返回 UTC 日期，而是返回本地日期（这实际上是 Javascript 中的默认值）。

要将您构建的日期转换为当地时间：

```
$("select.startdates").find("option").each( function() {
  var d = Date.UTC.apply(Date, this.value.split(",").map(Number));
  d = d + new Date(d).getTimezoneOffset() * 60000; // convert UTC to local
  startDates.push(d);
}); 
```

通常，我会使用`new Date(year, month, day)`构造函数而不是`Date.UTC`函数，但不能`apply`与`Date`构造函数一起使用。

如果您希望将 startDates 数组保留为 UTC，则需要将 datepicker 的日期转换为 UTC：

```
function showEventDates(date) {
  date = date - new Date(date).getTimezoneOffset() * 60000; // convert local to UTC
  // for ...
} 
```

注意：选择这些方法中的一种*或*另一种，而不是两者，否则你最终会遇到同样的问题...... :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T20:19:45.193

我听说 jQuery datetimepicker 有一些时区更新，因此您可能需要先检查该站点，但是这是我为获取 UTC 格式的选定日期和时间所做的。

首先创建 datetimepicker 并使用城市而不是 +0500 GMT，因为如果您使用 GMT 偏移量，您必须考虑夏令时 - 这是一场噩梦。

```
 // create ye datetimepicker with timezone options 
 $('#datetimepicker').datetimepicker({
    showTimezone: true,
    onSelect: onSelect,
    timezoneList: [
      { value: 'America/New_York', label: 'New York'},
      { value: 'America/Chicago', label: 'Chicago' } ,
      { value: 'America/Denver', label: 'Denver' },
      { value: 'America/Los_Angeles', label: 'Los Angeles' }
    ]); 
```

[接下来，从Github 上的 mde](https://github.com/mde/timezone-js)获取 timezoneJS.Date 库（注意：您还需要为您的地区下载适当的时区文件，只需按照 README 说明进行操作）

现在，当用户选择日期时，会调用 onSelect 方法。

```
function onSelect(dateText, dateInst) {
  // get the date without the timezone data
  var d = $('#datetimepicker').datepicker('getDate');

  // init timezoneJS
  timezoneJs.timezone.zoneFileBasePath = '/tz';
  timezoneJs.timezone.init();

  // get the selected timezone
  var tz = $('#datetimepicker').data('datepicker').settings.timepicker.timezone

  // construct the utcDate with the help of the timezoneJS.Date lib
  var utcDate = new timezoneJS.Date(
    d.getFullYear(),
    d.getMonth(),
    d.getDate(),
    d.getHours(),
    d.getMinutes(),
    tz)
  var utcLinuxTimestamp = utcDate.getTime() / 1000    
} 
```

并非完全无痛，但它会为您处理夏令时。

使用 UTC 时间戳中的日期和时区填充 datetimepicker 的反面如下所示：

```
// init timezone JS
timezoneJs.timezone.zoneFileBasePath = '/tz';
timezoneJs.timezone.init();

// get timezone date JS object
var tz = 'America/New York';
var d = new timezoneJS.Date( timestamp * 1000, tz);

$('#datetimepicker').datetimepicker({
  showTimezone: true,
  timezoneList: [ 
      { value: 'America/New_York', label: 'New York'},
      { value: 'America/Chicago', label: 'Chicago' } ,
      { value: 'America/Denver', label: 'Denver' },
      { value: 'America/Los_Angeles', label: 'Los Angeles' }
    ],
  timezone: tz,
  defaultDate: d._dateProxy,
  onSelect: onSelect
}).datepicker('setDate',d._dateProxy); 
```

我不确定您是否需要最后一行的 setDate 部分，但不会受到伤害。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-28T00:41:04.613

基于@Martijn 评论：

```
var offset = date.getTimezoneOffset();

if (date.getTime() - offset == startDates[i]) 
{
      return [true, 'eventDay'];
} 
```

# r - 在R中将数字转换为指数形式

> ID：14962224
> 
> 赞同：1
> 
> 时间：2013-02-19T16:18:40.030
> 
> 标签：r

我有一个文件，其中一个变量是 0.00234 和 2.34e-05 的组合。所以有人可以帮助我如何将所有内容转换为指数格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T16:47:21.593

如果您不介意将格式从`numeric`to更改为以科学计数法`string`查看列的结果，请使用：`p-values`

```
x <- c(1, .1, .01, .001, .0001)
> x
# [1] 1.0000 0.1000 0.0100 0.0010 0.0001

> format(x, scientific=TRUE) # converts to character vector/string
# [1] "1e+00" "1e-01" "1e-02" "1e-03" "1e-04" 
```

请注意，除了具有科学记数法之外，它还被转换为字符串。例如，如果您有兴趣使用这种格式写入文件（当然，除了查看结果之外），可以使用它。但是，如果您想保留数字格式，但只想在 R 中以科学计数法查看所有值，那么您可以使用 @Josh 通过设置推荐的解决方案`options(scipen = -10)`。

```
options(scipen = -10)
> x # numeric
# [1] 1e+00 1e-01 1e-02 1e-03 1e-04
options(scipen = 2)
> x # numeric
[1] 1.0000 0.1000 0.0100 0.0010 0.0001 
```

# git - 使用 Git 时 Drupal 中的 /sites/default/files 目录

> ID：14962227
> 
> 赞同：1
> 
> 时间：2013-02-19T16:18:47.303
> 
> 标签：git, drupal, drupal-6, migration, sync

我们正在将我们的 Drupal 6 站点迁移到 Git 中。我注意到 Drupal 7 实际上带有一个默认的 .gitignore 文件，它忽略了 settings.php 文件和 sites/default/files 目录。所以我假设这是标准做法，我不应该对文件目录进行版本控制。我的问题是，在迁移过程中将这些文件从开发移动到测试再到运行的最佳方法是什么？实时站点可能包含人们上传到实时站点的目录中的大量图像，但是 DEV 服务器上的目录将包含一些开发人员可能已添加到他们创建的内容中的新图像。目前，当内容编辑器以页面节点的方式添加内容时，例如在开发站点上，我们有一个所见即所得的编辑器，允许他们上传最终在 /sites/default/files/images 中的图像并放置在他们的内容中。在各种服务器之间同步此文件目录的最简单方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:47:16.117

您不会将数据库从开发同步到生产，对吗？所以你也不应该需要同步文件目录。drupal 文件目录只能用于通过网站添加的内容。如果您的开发人员正在添加生产中所需的资源，则应将它们置于版本控制之下的其他地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T02:10:52.420

根据上面对@Brian 的回答，提问者确实有两个问题：

1.  为什么我不应该在源代码管理中包含文件目录
2.  Deploy模块是否支持IMCE上传的图片

**#1，不应该在源代码管理中包含文件目录的原因：**

*   @Brian 给出了上面的原因 #1，但实际上，听起来你确实将数据从开发人员推送到产品。
*   文件目录不太适合源代码管理。（您很少想要恢复或查看 files 目录的提交历史记录）
*   files 目录可能会变得很大，这可能会成为 repo 存储问题
*   我通常在drupal安装之外对文件目录进行符号链接，所以如果服务器路径发生变化，我不需要移动它（同样，因为它可能很大）
*   files 目录中的许多文件很可能是其他文件的派生文件（在图像缓存的情况下）。`/files/img.png`即使您要证明将 files 目录置于源代码管理下是合理的，跟踪and也是没有意义的`/files/imagecache/small/img.png`。

**#2，为图像部署模块支持：**
简短的回答是否定的；Deploy 不支持 IMCE 为 D6 上传的图片。请参阅：[添加 IMCE 图像支持](http://drupal.org/node/1757760)。

但是[sarjeet.singh](http://drupal.org/user/200296)在上面链接的问题中为 D7提供了一个[补丁。](http://drupal.org/files/add-imce-support-1757760-1.patch)鉴于 dev/prod 上的文件目录路径相同，您应该能够针对 Drupal 6 进行调整。

# c++ - 调试断言失败，字符串下标超出范围

> ID：14962228
> 
> 赞同：0
> 
> 时间：2013-02-19T16:18:58.317
> 
> 标签：c++, winapi

我正在尝试编写一个函数，该函数从列表框中获取数据，检索帐户名称，然后使用 SQL 更改帐户类型。但是，由于某种原因，当列表框项包含“fdsa\t\tdungeon master”但不包含“asdf\t\tuser”时，此代码可以正常工作。在后来的测试中，它以 'auser\t\tuser' 失败。消息框功能指示正在检索正确的数据。什么可能导致这种情况？

```
void ChangeAccountType(HWND hwnd, std::string NewType)
{
using namespace std;
string strQuery;
string strAccountName;
string strBuffer;
int nIndex = SendMessage(GetDlgItem(hwnd, IDC_LIST1), LB_GETCURSEL, 0, 0);
SendMessage(GetDlgItem(hwnd, IDC_LIST1), LB_GETTEXT, (WPARAM)nIndex, (LPARAM)strBuffer.c_str());
MessageBox(hwnd, strBuffer.c_str(), "", NULL);
for(int iii = 0; strBuffer[iii] != '\t'; iii++)
{
    strAccountName += strBuffer[iii];
};
strQuery = "UPDATE account SET `account type` = \"" + NewType + "\" WHERE `User Name` = \"" + strAccountName + "\"";
} 
```

该错误似乎发生在 for 循环中的某处，因为它上方的消息框运行良好。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:22:32.460

`string strBuffer`是一个空字符串，具有 size `0`，并且在您尝试访问之前，您的代码中没有任何内容会`strBuffer[iii]`更改`iii`equal `0`。这将返回对已初始化值的引用`char`，即空终止字符。下一次，您访问 position `1`，这是超出范围的，因此是未定义的行为。

我怀疑您正在篡改字符串的内部`char`数组数据，从而导致未定义的行为。大概是您传递给的一个或多个函数[`c_str()`](http://en.cppreference.com/w/cpp/string/basic_string/c_str)尝试修改它。这本身会导致未定义的行为。您不能将`std::string`'s[`c_str()`](http://en.cppreference.com/w/cpp/string/basic_string/c_str)用作可写字符缓冲区。

从**21.4.7.1 [string.accessors**`const charT* c_str() const noexcept` ]和`const charT* data() const noexcept`：

> *要求*：程序不得更改存储在字符数组中的任何值。

# python - Django 斜杠仅在 home.html 上附加

> ID：14962230
> 
> 赞同：0
> 
> 时间：2013-02-19T16:19:09.057
> 
> 标签：python, django, lighttpd

我尝试让 django 不在我的网址中附加斜杠

我已经设定

```
APPEND_SLASH = False 
```

在我的 settings.py

现在有我的 urlpatterns ：

```
url(r'^foo.html$', 'SensorMonitoring.views.foo'),
url(r'^home.html$', 'SensorMonitoring.views.foo'), 
```

我在 lighttpd 服务器上运行它，当我调用 127.0.0.1/foo.html 时没有附加斜杠，但是当我调用 127.0.0.1/home.html 时，它会将我重定向到 127.0.0.1/home.html/ 和我不希望这样，因为如果 urd 以斜杠结尾，则不会加载 CSS

我真的不明白为什么我只有 home.html 才有这种行为……我尝试了许多其他的 url，它们都可以工作

我使用 django 1.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T16:45:04.167

尝试：

`from django.http import HttpResponseRedirect`

`url(r'^foo.html$', 'SensorMonitoring.views.foo'),`

`url(r'^foo.html/$', lambda x: HttpResponseRedirect('/foo.html')),`

# selenium - Selenium webdriver - 无法找到正确的 Xpath/ID 输入字段

> ID：14962235
> 
> 赞同：0
> 
> 时间：2013-02-19T16:19:25.423
> 
> 标签：selenium, xpath

我试图为下面的 html 代码找到正确的 xpath，经过多次试验并在我放弃并需要帮助的问题上花费了 3 天。记录后从 IDE 检查（执行代码），它正确识别了名为 accountID 的 webeditbox，但在运行测试脚本时它无法写入。请注意它在 iframe 中，并且在许多类和 div 框中。

IDE：Eclipse Juno 浏览器：FireFox Selenium 2 Webdriver

用于识别 Web 编辑框的 HTML 代码： `<input id="accountId" name="accountId" class="text" type="text" value="" maxlength="10">`

使用的硒代码：

1)`WebElement AccountID = driver.findElement(By.xpath("//[@id='accountId']")); AccountID.sendKeys("1234");`

2）类似地`//*[@id="customPMform"]/p/label`

3）类似地`//*[@id="customPMform"]/p`

我也尝试过`by.id`，但没有收获。请问有谁知道正确的硒代码应该是什么？

进一步的 HTML 代码：

```
<div class="portlet-borderless-container" style=""> 
    <form id="customPMform" action="https://webcashier-stg1.egalacoral.com/web/galabingostg1-backup/prepaidcard?p_p_id=prePaidCardDeposit_WAR_prePaidCardbaseVersion60610_INSTANCE_Jl3g&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_col_id=column-1&amp;p_p_col_count=2&amp;_prePaidCardDeposit_WAR_prePaidCardbaseVersion60610_INSTANCE_Jl3g_action=submit" method="POST" onsubmit="return false;"> 
        <input id="methodCode" name="methodCode" type="hidden" value="PrePaidCard"> 
        <input id="depositSuccessUrl" name="depositSuccessUrl" type="hidden" value="/ppcdepositsuccess"> 
        <input id="quickSuccessUrl" name="quickSuccessUrl" type="hidden" value="/ppcquickdepositsuccess"> 
        <h2><span class="text-msg" name="prePaidCardDeposit.title">PrePaid Card</span></h2> 
        <p class="form"> 
            <label for="accountId">
                <span class="text-msg" name="prePaidCardDeposit.accountId">Account ID</span>
            </label>
            <input id="accountId" name="accountId" class="text" type="text" value="" maxlength="10"> 
        </p> 
    </form>  
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:27:14.063

`By.xpath("//input[@id='accountId']")`应该让你选择正确的元素

`//[@id='accountId']`没有指定标签，可以如上更正

`//*[@id="customPMform"]/p/label`选择标签，并且您不能将键发送到标签元素

`//*[@id="customPMform"]/p`选择`<p>`元素。和上面一样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:17:22.003

In firebug, if you right click the element and choose Copy XPath, that may give you what you are looking for.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T14:56:27.817

框架应作为单独的页面处理，您应该在查找和使用框架的任何 Web 元素之前切换到该框架。

作为一个好的做法，开发人员应该提前告诉您页面上使用的帧数、flash 元素、小程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:53:50.927

如果它在**iframe**中，您应该在访问其中的任何元素之前将控件切换到 iframe。

```
driver.switchTo().frame("frameName/Id/index");
driver.findElement(By.id("accountId")).sendKeys("1234"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T12:03:38.843

我在搜索 name="cardNumber" 的字段时遇到了类似的问题。我想有一些字段名称掩码 selenium 防止被发现。

在我的情况下，解决方法是使用绝对位置。您的问题可能如下：

```
//form[@id='customPMform']//input[4] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-29T11:26:59.683

最好的方法是，使用 selenium ide 找到 xpath 并将其复制到您的代码中。因为有时会有多个输入，如果你使用 firebug，它可能不会给你正确的 xpath。（例如：使用 firebug 生成的 xpath 可能是 .// *[@id='title'] 但使用 selenium ide 捕获时它可能是 (.//* [@id='title'])[2]）。您也可以选择生成绝对xpath并尝试。

# ruby-on-rails - 不是重定向。页面未正确重定向。Refinerycms 中的翻译

> ID：14962241
> 
> 赞同：0
> 
> 时间：2013-02-19T16:19:35.820
> 
> 标签：ruby-on-rails, ruby, internationalization, translation, refinerycms

我有一个德语名称为“kontakt”的页面，但访问权限是 /contact。我开始解决这个错误，思考翻译，并在以下方面进行了更改：

（控制器）查询-controller.rb：更改

```
 def find_page
    @page = ::Refinery::Page.find_by_link_url("/kontakt")
  end 
```

i18n.rb：

```
config.enabled = true
config.default_locale = :de
config.current_locale = :de
config.default_frontend_locale = :de
config.frontend_locales = [:en, :de]
config.locales = { :en => 'English', :de => 'Deutsch' } 
```

我更改了（模型）setting.rb：

```
def confirmation_subject(locale="de")... 
```

而不是“en”。

我将refinerycms 中的重定向更改为/kontakt。

我在浏览器中收到错误“页面未正确重定向”。

控制台：

> 在 2013-02-19 17:07:27 +0100 开始 GET "/kontakt" for 127.0.0.1 由 Refinery::PagesController#show as HTML 参数处理：{"path"=>"kontakt", "locale"=> :de} Refinery::Role Load (0.2ms) SELECT "refinery_roles".* FROM "refinery_roles" WHERE "refinery_roles"."title" = 'Refinery' LIMIT 1 Refinery::User Load (0.2ms) SELECT "refinery_users"。 * FROM "refinery_users" INNER JOIN "refinery_roles_users" ON "refinery_users"."id" = "refinery_roles_users"."user_id" WHERE "refinery_roles_users"."role_id" = 1 Refinery::Page Load (0.4ms) SELECT "refinery_pages"。 * FROM "refinery_pages" INNER JOIN "refinery_page_translations"ON "refinery_page_translations"."refinery_page_id" = "refinery_pages"."id" WHERE "refinery_page_translations"."locale" IN ('en', 'de') AND "refinery_page_translations"."slug" = 'kontakt' AND "refinery_pages" ."parent_id" IS NULL LIMIT 1 重定向到 ../kontakt Refinery::User Load (0.1ms) SELECT "refinery_users".* FROM "refinery_users" WHERE "refinery_users"."id" = 3 LIMIT 1 Refinery::Role Load (0.1ms) SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id"= 3 完成 302 在 8 毫秒内找到（ActiveRecord：1.1 毫秒）缓存：[GET /kontakt] 未命中缓存：[GET /kontakt] 未命中

development.log 的日志：

> 在 2013-02-19 17:07:27 +0100 开始 GET "/kontakt" for 127.0.0.1 由 Refinery::PagesController#show as HTML 参数处理：{"path"=>"kontakt", "locale"=> :de} [1m[35mRefinery::Role Load (0.1ms)[0m SELECT "refinery_roles".* FROM "refinery_roles" WHERE "refinery_roles"."title" = 'Refinery' LIMIT 1
> [1m[36mRefinery::User Load (0.2ms)[0m [1mSELECT "refinery_users".* FROM "refinery_users" INNER JOIN "refinery_roles_users" ON "refinery_users"."id" = "refinery_roles_users"."user_id" WHERE "refinery_roles_users" ."role_id" = 1[0m [1m[35mRefinery::Page Load (0.2ms)[0m SELECT "refinery_pages".* FROM "refinery_pages" INNER JOIN "refinery_page_translations" ON "refinery_page_translations"."refinery_page_id" = "refinery_pages"。 "id" WHERE "refinery_page_translations"."locale" IN ('en', 'de') AND "refinery_page_translations"."slug" = 'kontakt' AND "refinery_pages"."parent_id"IS NULL LIMIT 1 重定向到 //../kontakt [1m[36mRefinery::User Load (0.1ms)[0m [1mSELECT "refinery_users".* FROM "refinery_users" WHERE "refinery_users"."id" = 3 LIMIT 1[ 0m [1m[35mRefinery::Role Load (0.1ms)[0m SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users" ."user_id" = 3 Completed 302 Found in 6ms (ActiveRecord: 0.8ms)1ms)[0m SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id" = 3 完成 302 发现时间为 6ms （活动记录：0.8ms）1ms)[0m SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id" = 3 完成 302 发现时间为 6ms （活动记录：0.8ms）

我在文件中有翻译：en.yml 和 de.yml

我在[http://refinerycms.com/edge-guides/translate-refinery](http://refinerycms.com/edge-guides/translate-refinery)中看到了信息， 但我找不到解决方案。

如果我尝试使用 /contact 输入，效果很好，即使进行了所有更改。

此外，在页面的公式中，验证正在读取英文值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:17:31.527

我在我的网站上遇到了同样的问题，并尝试了很多不同的方法来解决它。最后，简单的解决方案奏效了。尝试这样做：

转到插件。全选 - 勾选每个复选框 选择停用测试网站 - 在此“重新激活”所有插件之后，它可能会或可能不会工作。

希望能解决它。在做了很多其他事情之后，我尝试这样做并且效果很好！我希望我会先这样做。

# c# - 从另一个 DLL（或应用程序）触发 DLL 事件

> ID：14962244
> 
> 赞同：0
> 
> 时间：2013-02-19T16:19:47.767
> 
> 标签：c#, events, dll

我有2个项目。在第一个：

```
public delegate _Event(int code);
public event _Event TestEvent; 
```

现在我想在我的第二个项目中做这样的事情

```
public void TestFunc()
{
   TestEvent(11); //Project1.MyClass.TestEvent(11);
} 
```

即我想触发 Project1 的事件表单 Project2。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:46:32.490

1.您缺少委托的返回类型。

2.您只能从声明类型中触发事件。您可以做的是在声明触发它的事件的类型上声明一个公共方法。

```
public delegate void _Event(int code);
public event _Event TestEvent;
public void FireEvent(int val){TestEvent(val);} 
```

# wcf - 如何让 encoding=utf-8 出现 WCF xml 响应？

> ID：14962246
> 
> 赞同：1
> 
> 时间：2013-02-19T16:19:53.513
> 
> 标签：wcf, utf-8

如何确保 WCF 响应的根元素前面有包含 encoding="UTF-8" 属性的 XML 声明？

似乎默认响应是 utf-8，但没有出现在标题中。我正在寻找我的响应文档以这个标题开头：

```
<?xml version="1.0" encoding="utf-8"?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:22:56.017

默认编码 ( `TextMessageEncodingBindingElement`) 不会发出 UTF-8 编码的 XML 声明。因此，您需要为此使用不同的编码。“[自定义消息编码器：自定义文本编码器](http://msdn.microsoft.com/en-us/library/ms751486.aspx)”示例应该让您完全控制 XML 编写器，包括可用于强制输出 XML 声明的编写器设置。

# javascript - 如何在js中处理一个非常大的数组

> ID：14962247
> 
> 赞同：3
> 
> 时间：2013-02-19T16:19:53.553
> 
> 标签：javascript

我有数千个简单对象的数组，我想处理它。

例子：

```
var array = [
   {name:"1"}, {name:"2"}, ..., {name:"32,000"}
] 
```

而且我只想处理数组（我在其他地方引用了对象）。那么，下一个例子足以杀死数组吗？

例子：

```
var a1 = {name:"1"}, a2 = {name:"2"}, ... , a32000 = {name:"32,000"};

var array = [ a1, a2, ... , a32000 ];

array = null; 
```

或者我应该做类似的事情：

```
for(var index in array) array[index] = null;
array = null; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T16:21:46.147

如果删除对数组的所有引用，则数组中未保留引用的任何元素都将被释放，即垃圾收集器将能够回收其空间。

您不需要手动设置`null`数组的元素。你的最后一个循环完全没用。

如果您只想回收数组的空间，而不是它的元素，只需删除对它的引用，方法是

```
array = undefined; 
```

如果您的数组不是存储在变量中而是存储在属性中，例如定义为`window.array = []`，那么您也可以使用`delete`：

```
delete window.array; // or yourObject.array 
```

但是您仍然必须删除对该数组的所有引用。

# erlang - 更改erlang中所有行的数据

> ID：14962248
> 
> 赞同：0
> 
> 时间：2013-02-19T16:19:54.103
> 
> 标签：erlang

我有两个表**sms_sent** 和**sms_sent_backup**

sms_sent 和 sms_sent_backup 的格式是：

```
 -record(sms_sent, {id, text}).
  -record(sms_sent_backup, {id, text}). 
```

sms_sent 在 mnesia 中包含此值

```
1     test1

2     test2

3     test3 
```

并且 sms_sent_backup 在 mnesia 中包含此值

```
8     hi

9     hello 
```

我想开发一个函数来检索 sms_sent_backup 的最后一个 id （值**9**），然后我想更改 sms_sent 的所有 id，这个 id 的新值是以前的值 + 值 9 （最后一个 id sms_sent_backup)

意味着 sms_sent 的新格式是：

```
10     test1

11     test2

12     test3 
```

我尝试获取**sms_sent_backup**的最后一个键，但出现此错误

```
 1> model:testkey().
** exception exit: {aborted,no_transaction}
     in function  mnesia:abort/1 
```

我用这个功能测试：

```
testkey()->
    LastKey = mnesia:last(sms_sent_backup). 
```

但我想说**sms_sent_backup** 包含密钥但不是按顺序

例如**sms_sent_backup**的含义包含以下值：

```
 8     hi

    9     hello

    11     hi1

    10     hello1 
```

所以我需要这个值： **11** 来自表 **sms_sent_backup**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:29:23.623

有多种方法可以做到这一点

1.  如果您的 sms_sent_backup 表的类型为 ordered_set，那么您可以这样做`LastKey = mnesia:last(sms_sent_backup).`这将为您提供最后一个键值。稍后您可以在插入新记录时执行 LastKey + 1。

2.  在每次插入期间，将键的值存储在本地状态中，并将其用于插入下一条记录。第一次你可以做 mnesia:foldl 来找到最大的。

3.  使用 . 创建您自己的 mnesia 计数器表`mnesia:create_table(my_auto_inc,[{type,set}]).`。在插入备份表期间，您可以执行`NextKey = mnesia:dirty_update_counter(my_auto_inc,lastrec,1).`可用于插入新记录的操作。

# javascript - MongoDB - javascript 查询语言

> ID：14962257
> 
> 赞同：3
> 
> 时间：2013-02-19T16:20:13.357
> 
> 标签：javascript, mongodb

MongoDB的repl有完整的参考吗？我想知道我可以使用的所有可用 JS 命令，因为我想将界面移植到浏览器中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T18:00:06.677

以下 mongodb.org 文章对 mongodb 命令有很好的描述 [http://docs.mongodb.org/manual/reference/javascript/](http://docs.mongodb.org/manual/reference/javascript/)

以下链接包含所有 javascript 命令 [http://docs.mongodb.org/manual/reference/method/](http://docs.mongodb.org/manual/reference/method/)

以下链接有 SQL 到 MongoDB 映射表 [http://docs.mongodb.org/manual/reference/sql-comparison/](http://docs.mongodb.org/manual/reference/sql-comparison/)

我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:40:24.783

有一个关于 mongodb for javascript 的文档，

[http://api.mongodb.org/js/](http://api.mongodb.org/js/)

有关于那个的命令和更多的东西。

docs.mongodb.org/manual/reference/commands

有一个如何使用它的教程

[http://www.hacksparrow.com/the-mongodb-tutorial.html](http://www.hacksparrow.com/the-mongodb-tutorial.html)

# javascript - 如何检查日期（格式为 dd/mm/yyyy）在 DOJO 中是否已经过去

> ID：14962258
> 
> 赞同：0
> 
> 时间：2013-02-19T16:20:15.190
> 
> 标签：javascript, dojo

我想知道一个日期是否已经过去，如果有，我会让输入框不可编辑。

我的输入框代码是：

```
<input id="inserviceInputId" type="text" value="09/05/2003" name="inserviceInput" style="width:7em"> 
```

以及我目前拥有的 Dojo 代码：

```
var date1 = new Date;
    dojo.query("[name=inserviceInput]").forEach(function(evnt,i){

    console.log(evnt.value)

    }); 
```

所以，我确实在这里得到了输入框的值。但问题是如何减去今天的日期和值中的日期。

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:37:50.780

首先，我认为您的语法不正确。看起来您正在尝试编写事件处理程序（ function(evnt, i) ）而不是对来自节点的值执行一些操作。

我在下面附上了一些更正的代码，为了解释我添加了内联注释：

```
dojo.query("input[name='inserviceInput']").forEach(function(node){
   var date1 = new Date();  // get the current date and time

   var date2 = new Date(node.value); // turn the input from the input field into a date

   if (date1>date2) { // compare the two dates, 

     //if the current date is larger than the date from the input field... 
     // do something here  
   } 
```

});

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:41:52.607

使用 将`dojo/date/locale`值解析为 javascript Date 对象，然后只比较日期对象。

```
require(["dojo/query", "dojo/date/locale"], function(query, locale){

  query("[name=inserviceInput]").forEach(function(node){

    var dtNow = new Date();
    var dtValue = locale.parse(node.value, {
        selector: 'date',
        datePattern: 'dd/MM/yyyy'
    });

    // validation
    if(dtValue < dtNow) {
      // error condition...
    }

  });
}); 
```

[用 JavaScript 比较两个日期](https://stackoverflow.com/questions/492994/compare-dates-with-javascript)

# mysql - mysql查询（根据活动获取用户数）

> ID：14962259
> 
> 赞同：1
> 
> 时间：2013-02-19T16:20:23.043
> 
> 标签：mysql

我有 2 个 MySQL 表（用户和评论） - 我想做的是获取一份报告，告诉我有多少用户发表了 1 条评论，有多少用户发表了 2 条评论，有多少用户发表了 3 条评论以及有多少用户发表了 4 条以上评论评论，按月和年分组。

我有这个查询来获取按年/月分组的每个用户发表的评论数

```
select year(c.datecreated) as comment_year, month(c.datecreated) as comment_month,      
count(c.id) as num_comments
from tblcomments c
inner join tbluser u on u.id = c.userid
where 
c.datecreated <= '2013-02-19' and c.datecreated >= '2012-03-01'
group by c.userid, year(c.datecreated), month(c.datecreated) 
```

如何修改此查询以提供我想要的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:32:41.267

再次使用子查询对结果进行分组：

```
SELECT   ym, 
         SUM(c = 1) AS `num_1`,
         SUM(c = 2) AS `num_2`,
         SUM(c = 3) AS `num_3`,
         SUM(c>= 4) AS `num_4+`
FROM (
  SELECT   DATE_FORMAT(datecreated, '%Y-%m') AS ym, COUNT(*) AS c
  FROM     tblcomments
  WHERE    datecreated BETWEEN '2012-03-01' AND '2013-02-19'
  GROUP BY ym, userid
) t
GROUP BY ym 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:34:14.810

这是一种方法——不确定你是否需要加入 tbluser，但我把它留在那里：

```
SELECT comment_year, comment_month,
  COUNT(userId) userCnt,
  Num_Comments 
FROM (
  select 
    year(c.datecreated) as comment_year, 
    month(c.datecreated) as comment_month,      
    c.userid,
    CASE WHEN count(c.id) >= 4 THEN '4+' ELSE CAST(COUNT(c.id) as varchar) END as num_comments
  from tblcomments c
    inner join tbluser u on u.id = c.userid
  where 
    c.datecreated <= '2013-02-19' and c.datecreated >= '2012-03-01'
  group by c.userid, year(c.datecreated), month(c.datecreated)
  ) t
GROUP BY comment_year, comment_month, Num_Comments; 
```

还有一些小提琴样本：[http ://sqlfiddle.com/#!3/5fb5c/5](http://sqlfiddle.com/#!3/5fb5c/5)

# ios - 具有多个类的故事板 UIViewController

> ID：14962260
> 
> 赞同：3
> 
> 时间：2013-02-19T16:20:23.247
> 
> 标签：ios, objective-c, xcode, uiviewcontroller, storyboard

我希望我的故事板中有一个 UIViewController 由几个类实例化。所以我让我的故事板中的“类”字段为空（所以默认情况下，它的`UIViewController`？）。然后我用“”填充情节提要 ID `MyGenericView`。

这是一些类：

```
@interface ClassA: UIViewController

@interface ClassB: UIViewController 
```

`MyGenericView`包含我在 ClassA 和 ClassB 中构建视图所需的所有原型。这是我如何实例化我的`ClassA`：

```
ClassA *myClass = (ClassA*)[storyboard instantiateViewControllerWithIdentifier:@"MyGenericView"]; 
```

最后，我的视图显示在应用程序中，但我`ClassA`的代码从未被调用。返回的对象`instantiateViewControllerWithIdentifier`是一个`UIViewController`，强制转换不起作用。

我不想用 ClassA 填充字段“类”，因为我想将此视图重用于`ClassB`. 但是我不想在我的故事板中复制这个视图。

不知道你是否清楚，我为我糟糕的英语道歉:)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T17:07:27.637

我很想找到这个问题的解决方案，但唯一可行的方法（我认为）是使用**委托**而不是子类化。

我的意思是，你可以实现 3 个类：ClassP、ClassC1、ClassC2；将您的情节提要与实现委托协议的 ClassP 链接，然后在呈现之前（进入*prepearForSegue*？）您可以将 *segue.destinationViewController*（P 类型）的委托设置为您的 ClassC1 或 ClassC2 之一，这显然实现了协议。

示例代码（未测试）：

P类

```
@protocol ClassPDelegate <NSObject>

- (void)foo;

@end

@interface ClassP : UIViewController
...
@end 
```

C1 类和 C2 类

```
#import "ClassP.h"
@property (nonatomic, weak) id <ClassPDelegate> delegate; 
```

调用者类

```
...
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"mySegue"])
    {
        ClassC1 *classC1 = [[ClassC1 alloc] init];
        [(ClassP *)segue.destinationViewController setDelegate:classC1];
    }
}
... 
```

我希望它有效！ps：对不起，你的英文比我的好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-17T08:30:22.690

只有当我用 xib 文件替换情节提要中的几乎所有内容时，我的生活才变得比以前容易得多！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-19T17:04:36.123

What you want to do, and what are possible aren't always the same thing. Casting doesn't magically turn a UIViewController into a ClassA view controller. You need to change the class in the storyboard to ClassA or ClassB. You can copy and paste the view you've created into as many other view controllers as you want. What's wrong with that?

# mapreduce - Mongoose mapreduce：使用 array.some 的映射函数

> ID：14962270
> 
> 赞同：1
> 
> 时间：2013-02-19T16:20:45.383
> 
> 标签：mapreduce, mongoose

这个 Javascript 在我的 map 函数之外可以正常工作：

```
var cribs = ["list","tree"];

if ( cribs.some(function(i){return (new RegExp(i,'gi')).test("a long list of words");}) ) {
 console.log('match');
} 
```

（它只是用数组中的值搜索一个字符串）。

虽然在我的地图功能中使用它不起作用：

```
var o = {};
o.map = function () { 
    if ( cribs.some(function(i){return (new RegExp(i,'gi')).test(this.name);}) ) {
        emit(this, 1) ;
    }
}
o.out = { replace: 'results' }
o.verbose = true;
textEntriesModel.mapReduce(o, function (err, model, stats) {
    model.find(function(err, data){
        console.log(data);
    });
}) 
```

它不发出任何东西，所以我有一个空的结果集。没有错误。

如果我不使用array.some，而是使用普通的正则表达式，那么它可以正常工作：

```
o.map = function () { 
    if(this.name.match(new RegExp(/list/gi))) {
        emit(this, 1) ;
    }
} 
```

所以我的问题是，为什么上面的 array.some 函数在我的 map 函数中不起作用？

我有一长串需要匹配的单词，所以我真的不想单独为它们写一个正则表达式，上面*应该可以*工作。

这是我试图在我的地图函数中使用的函数的 jsfiddle：http: [//jsfiddle.net/tnq7b/](http://jsfiddle.net/tnq7b/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:54:58.030

您需要通过将其添加到选项来使`cribs`该功能可用：`map``scope`

```
var cribs = ["list","tree"];
var o = {};
o.map = function () { 
    if (cribs.some(function(i){return (new RegExp(i,'gi')).test(this.name);})) {
        emit(this, 1);
    }
}
o.out = { replace: 'results' };
o.scope = { cribs: cribs };
o.verbose = true;
textEntriesModel.mapReduce(o, function (err, model, stats) {
    model.find(function(err, data){
        console.log(data);
    });
}); 
```

# ruby-on-rails - 用于迁移的 Rails 任务

> ID：14962274
> 
> 赞同：0
> 
> 时间：2013-02-19T16:21:15.393
> 
> 标签：ruby-on-rails, task

我有这个迁移，但我想通过使用 rails 任务来做到这一点。我该怎么做？

```
User.all.each do |user|
  user.deliver = :twice if user.deliver == :none
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:29:03.717

```
namespace :my_cool_app do
  task :do_this => :environment do
    User.all.each do |user|
      user.deliver = :twice if user.deliver == :none
    end 
  end
end 
```

要运行此任务类型`rake my_cool_app:do_this`。更多关于 rake 任务的信息在[这里](http://www.ultrasaurus.com/sarahblog/2009/12/creating-a-custom-rake-task/)发布，有点过时，但值得一读

# android - 如何刷新 ListView 以使所选项目在页脚出现并与其重叠时变得完全可见？

> ID：14962275
> 
> 赞同：0
> 
> 时间：2013-02-19T16:21:18.407
> 
> 标签：android

我有`ListView`一些复选框和一个页脚，我必须在检查其中一个复选框时显示。

我想要实现的是，如果我单击将被此页脚重叠的项目，则会`ListView`自动滚动以显示该项目。请注意，`ListView`放置正确，可以进一步滚动。

我已经在 onItemClicked 函数中尝试过，但到目前为止还没有奏效：

```
if (mFooterView.getVisibility() != View.VISIBLE) {
    mFooterView.setVisibility(View.VISIBLE);

    mImagesListView.smoothScrollToPosition(position);
} 
```

问题似乎是 smoothScrollToPosition 使用当前测量值，该测量值被`mFooterView.setVisibility(View.VISIBLE)`. 然而，新的测量值似乎要到下一次重绘才可用。

无论如何我可以达到这个效果吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:42:36.653

在检查了`ListView`一段时间的源代码后，我设法从`ListView.onSizeChanged()`. 关键是在 ListView 实际调整大小后进行滚动。我们可以通过使用`post`函数来做到这一点。

这是代码（注意它不会滚动，只是设置正确的位置，但你明白了）：

```
public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

    if (mFooterView.getVisibility() == View.GONE) {
        mFooterView.setVisibility(View.VISIBLE);

        // at this point, the listview's height hasn't changed yet
        int listOldHeight = parent.getHeight();

        if (mItemAutoVisibilityScroller == null) {
            mItemAutoVisibilityScroller = new ItemAutoVisibilityScroller();
        }

        // allow the list to resize
        mFooterView.post(mItemAutoVisibilityScroller.setup(listOldHeight, position, view.getTop(), view.getHeight()));
    } else {
        mFooterView.setVisibility(View.GONE);
    }
}

private class ItemAutoVisibilityScroller implements Runnable {
    private int mListOldHeight;
    private int mPosition;
    private int mItemTop;
    private int mItemHeight;

    public ItemAutoVisibilityScroller setup(int listOldHeight, int position, int itemTop, int itemHeight) {
        mListOldHeight = listOldHeight;
        mPosition = position;
        mItemTop = itemTop;
        mItemHeight = itemHeight;
        return this;
    }

    public void run() {
        final int textTop = mFooterView.getTop();

        // is the item cut by the footer?
        if (mItemTop + mItemHeight > textTop) {

            int newItemTop = mListOldHeight - mFooterView.getHeight() - mItemHeight;
            if (newItemTop < 0) {
                newItemTop = 0;
            }

            // move the item just above the footer
            mListView.setSelectionFromTop(mPosition, newItemTop);
        }
    }
} 
```

# jquery - 在使用 Ajax 加载 html 时显示加载 gif

> ID：14962276
> 
> 赞同：1
> 
> 时间：2013-02-19T16:21:20.753
> 
> 标签：jquery, ajax, loader

我想在加载我用 Ajax 加载的 html 时显示加载图像，以下代码似乎不起作用。

```
$('#loading-image').bind('ajaxStart', function(){
          $(this).show();
    }).bind('ajaxStop', function(){
          $(this).hide();
        }); 
```

我希望在将 game.html 的内容加载到 .content 元素时出现加载图像。

```
$('body').on('click', '.mch-ajax', function(e){
        e.preventDefault();
        $('#mch-overlay').fadeOut(300);
        $( ".content" ).load("game.html", function() {
                $( ".note" ).delay(400).fadeIn(700);
                $( ".route" ).delay(800).fadeIn(700);
                $( ".start-btn" ).delay(1200).fadeIn(700);
        }); 
    }); 
```

当您点击“播放”时，“开始游戏”按钮执行以下代码：

```
$( ".content" ).load("game.html".... 
```

HTML和CSS：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:34:55.217

请参考[jquery 1.9.0 的升级指南。](http://jquery.com/upgrade-guide/1.9/)

> AJAX 事件应附加到文档
> 
> 从 jQuery 1.9 开始，全局 AJAX 事件（ajaxStart、ajaxStop、ajaxSend、ajaxComplete、ajaxError 和 ajaxSuccess）仅在文档元素上触发。更改程序以侦听文档上的 AJAX 事件。例如，如果代码当前如下所示：
> 
> $("#status").ajaxStart(function(){ $(this).text("Ajax 开始"); });
> 
> 将其更改为：
> 
> $(document).ajaxStart(function(){ $("#status").text("Ajax 开始"); });

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:28:11.503

尝试使用`beforeSend`并`complete`输入`$.ajaxSetup`

```
$.ajaxSetup({
    beforeSend: function(){
        $('#loading-image').show();
    },
    complete: function(){
        $('#loading-image').hide();
    }
}); 
```

# java - 忽略获取策略

> ID：14962277
> 
> 赞同：0
> 
> 时间：2013-02-19T16:21:24.240
> 
> 标签：java, hibernate

我们有一个使用 Hibernate 2.5 的简单关联：

我们希望这是一个`LEFT OUTER JOIN`. 但即使我们明确设置`OUTER-JOIN`为 true，我们仍然会得到一个`INNER JOIN`.

这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:36:09.150

请参阅此 Hibernate 常见问题解答：[https ://community.jboss.org/wiki/HibernateFAQ-AdvancedProblems#Hibernate_ignores_my_outerjointrue_or_fetchjoin_setting_and_fetches_an_association_lazily_using_n1_selects](https://community.jboss.org/wiki/HibernateFAQ-AdvancedProblems#Hibernate_ignores_my_outerjointrue_or_fetchjoin_setting_and_fetches_an_association_lazily_using_n1_selects)

您有 2 个选项，使用 Criteria API（将使用外连接设置）或在 HQL 查询中显式使用 LEFT OUTER JOIN。

# java - Google Maps API，检索最近的地方

> ID：14962280
> 
> 赞同：0
> 
> 时间：2013-02-19T16:21:30.313
> 
> 标签：java, android, api, google-maps

我正在制作一个需要从用户当前位置显示最近的超市的应用程序。

我已经看到与此问题类似的问题，答案差异很大。目前，我能够在特定位置显示地图，上面有一个标记。

查找和展示最近的超市的最佳方式是什么？

我读过反向地理编码一个位置可以给出地址。但是查看附近所有超市地址的最佳方法是什么？我可以使用 HTTP 连接到从我的位置在给定半径内搜索的数据库，然后使用某种覆盖来显示它们吗？

我已经阅读了许多教程，但大多数只展示了显示地图的基础知识......放置当前位置的标记......然后获得纬度/经度位置。

如果有人知道任何教程来展示我想要在上面做什么，那就太好了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T17:19:59.950

Google Places 有一个 RESTful API 可以满足您的需求。本质上，您只需输入您的经纬度位置、与您想要查找的内容（健身房、餐馆等）和您想要搜索的半径相对应的键。

您确实必须注册一个 api 密钥，但这真的很容易。这是文档：[https ://developers.google.com/places/documentation/](https://developers.google.com/places/documentation/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:52:23.927

您应该拥有所有超市的某种数据库。如果您不这样做，您可以例如使用[Google Geocoding API](https://developers.google.com/places/documentation/)、[Foursquare API](https://developer.foursquare.com/docs/venues/search)或[其他东西](https://stackoverflow.com/questions/5232242/)。这些记录既可以存储在数据库中，也可以存储[`HashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)在[`SQlite`](http://developer.android.com/reference/android/database/sqlite/package-summary.html)数据库中。

遍历这些位置并计算从超市到您的用户位置的距离（这可以通过[lat/long distance](https://stackoverflow.com/questions/837872)来完成）。这可以从客户端或服务器端完成（假设您有自己的服务器）。获得所有超市的距离后，只需选择`n`最近的并在地图上显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:25:40.493

你有自己的超市数据库吗？如果是这样，并且它们在插入时被地理编码为纬度/经度，那么将它们放在设定的半径内应该是微不足道的数学运算，并使用设置标记的基本示例。

如果你没有自己的数据库，你首先需要从一些 web 服务中提取 POI，并受制于它可能有的怪癖。

# android - Fragment onActivityResult requestCode 比较失败

> ID：14962281
> 
> 赞同：1
> 
> 时间：2013-02-19T16:21:30.150
> 
> 标签：android, variables, android-intent, fragment

我在 FragmentActivity 中有一个由 Viewpager 托管的片段。

我在那个片段中做了一个意图并开始一个新的活动

```
...
private static final int INSERT_SPOT = 0;

public void onMapLongClick(LatLng point) {      
    Intent intent = new Intent(getActivity(), SpotAddActivity.class);
    intent.putExtra(MainActivity.SPOTLAT, point.latitude);
    intent.putExtra(MainActivity.SPOTLNG, point.longitude);
    startActivityForResult(intent, INSERT_SPOT);
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {on
    //@TODO why doesnt that work?
    if (requestCode == INSERT_SPOT) {
        int test = requestCode; 
    }
} 
```

我可以在调试器中看到 onActivityResult() 被调用，但是 requestCode （即 0 表示调试器）与我的 contant 的比较失败。我很困惑，怎么会失败？

问候

# javascript - 设置优雅相似的语句而不重复它

> ID：14962284
> 
> 赞同：0
> 
> 时间：2013-02-19T16:21:31.517
> 
> 标签：javascript, jquery, if-statement

我正在使用 JavaScript 中的下一个代码为 id 设置类，每次我只想要一个`div`带有边框类的时候：

```
 if (counter) {
            $('#car1').addClass('border');
            $('#car2').removeClass('border');
        }
        else {
            $('#car2').addClass('border');
            $('#car1').removeClass('border');
        } 
```

`counter`它只是一个布尔变量，可以是任何东西......

我想知道，我可以做得更优雅吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:33:15.467

if`counter`是一个布尔值，您可以将其用作 toggleClass 的开关：

```
$('#car1').toggleClass('border', counter);
$('#car2').toggleClass('border', !counter); 
```

--[文档](http://api.jquery.com/toggleClass/)->

> .toggleClass（类名，开关）
> 
> "switch" : Boolean 一个布尔值（不仅仅是真/假），用于确定是否应该添加或删除类。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-19T16:32:17.917

案例陈述如何

```
switch(counter)
{
  case 1:
   $('#car1').addClass('border');
   $('#car2').removeClass('border');
   break;
  case 2:
    $('#car2').addClass('border');
    $('#car1').removeClass('border');
   break;
  default:
   ....
} 
```

# c# - 如何在其中心 XNA 旋转 3D 立方体？

> ID：14962285
> 
> 赞同：5
> 
> 时间：2013-02-19T16:21:33.630
> 
> 标签：c#, matrix, xna, rotation, transform

我尝试从它的中心而不是边缘旋转一个 3D 立方体。这是我使用的代码。

```
public rotatemyCube()
{
    ...
    Matrix newTransform = Matrix.CreateScale(scale) * Matrix.CreateRotationY(rotationLoot) * Matrix.CreateTranslation(translation);
    my3Dcube.Transform = newTransform;
    ....

public void updateRotateCube()
{
    rotationLoot += 0.01f;
} 
```

我的立方体旋转得很好，但不是从中心旋转。这是解释我的问题的示意图。 ![在此处输入图像描述](../Images/196f5a3f757fddcf849567a4c4a38716.png)

我需要这个： ![在此处输入图像描述](../Images/baf6041efb645f061c18bba033882fdd.png)

我的完整代码

```
private void updateMatriceCubeToRotate()
    {
        foreach (List<instancedModel> ListInstance in listStructureInstance)
        {
            foreach (instancedModel instanceLoot in ListInstance)
            {
                if (my3Dcube.IsAloot)
                {

                    Vector3 scale;
                    Quaternion rotation;
                    Vector3 translation;
                    //I get the position, rotation, scale of my cube
                    my3Dcube.Transform.Decompose(out scale,out rotation,out translation);

                    var rotationCenter = new Vector3(0.1f, 0.1f, 0.1f);

                    //Create new transformation with new rotation
                    Matrix transformation =
                        Matrix.CreateTranslation(- rotationCenter)
                        * Matrix.CreateScale(scale)
                        * Matrix.CreateRotationY(rotationLoot)
                        * Matrix.CreateTranslation( translation);

                    my3Dcube.Transform = transformation;

                }
            }
        }
        //Incremente rotation 
        rotationLoot += 0.05f;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T19:04:39.993

旋转矩阵围绕坐标系的**原点旋转顶点。**为了围绕某个点旋转，您必须将其设为原点。这可以通过简单地从形状中的每个顶点中减去旋转点来完成。

![三幅图从顶部显示了一个旋转的立方体](../Images/11a25017472385b9f4381b4ed21816c8.png)

```
var rotationCenter = new Vector3(0.5f, 0.5f, 0.5f);

Matrix transformation = Matrix.CreateTranslation(-rotationCenter)
    * Matrix.CreateScale(scaling) 
    * Matrix.CreateRotationY(rotation) 
    * Matrix.CreateTranslation(position); 
```

# c# - 我已成功地将 CefSharp 嵌入到 .NET 4.0 应用程序中。是否可以让 jQuery 调用在 DOM 上工作？

> ID：14962287
> 
> 赞同：7
> 
> 时间：2013-02-19T16:21:36.593
> 
> 标签：c#, jquery, cefsharp

我试图找出这是否可能。我已经浏览了 GitHub 示例[https://github.com/chillitom/CefSharp](https://github.com/chillitom/CefSharp)，它为我提供了类的源代码（尽管我无法从这个 GITHUB 构建 CefSharp 本身。

但是，我确实尝试了从此链接[https://github.com/downloads/ataranto/CefSharp/CefSharp-1.19.0.7z](https://github.com/downloads/ataranto/CefSharp/CefSharp-1.19.0.7z)下载二进制文件，然后通过引用这些示例构建了我的 C# win32 应用程序，这相当顺利，之后8 小时左右，我有了一个可以工作的嵌入式浏览器，yipeee。但是，我现在正处于要操作 DOM 的地步——我已经读到您只能使用 webView.EvaluateScript("some script"); 和 webView.ExecuteScript("一些脚本"); 因为无法通过 cefsharp 直接访问 DOM

所以我想知道的是。我可以调用 jQuery 方法吗？如果我加载的页面已经加载了jQuery，我可以在c#中执行以下操作吗？

```
webView.ExecuteScript("$(\"input#some_id\").val(\"user@example.com\")")); 
```

目前这会引发异常。我试图找出答案；我什至应该尝试使用 cefsharp DLL 中的 jQuery，还是我必须坚持使用标准的老式 JavaScript，这将花费我 5 倍的时间来编写......？

我希望堆垛机会有答案。我已经尝试过 cefsharp 的 wiki 和论坛，但它们提供的线索不多；我发现的唯一例子是老式的 JavaScript。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T20:25:09.220

是的，您可以使用 jQuery，但是您只能在 DOM 完全加载后才能使用它。为此，您需要使用 WebView 的 PropertyChanged 事件来检查 IsLoading 属性何时更改为 false 并且 IsBrowserInitialized 属性设置为 true。

请参阅下面的片段，了解我如何在我的一个项目中做到这一点。正如你所看到的，一旦 IsLoading 属性发生变化，我就会调用一些方法来设置 WebView 中的内容，这是通过 ExecuteScript 调用 jQuery 来完成的。

```
/// <summary>
/// Initialise the WebView control
/// </summary>
private void InitialiseWebView()
{
    // Disable caching.
    BrowserSettings settings = new BrowserSettings();
    settings.ApplicationCacheDisabled = true;
    settings.PageCacheDisabled = true;

    // Initialise the WebView.
    this.webView = new WebView(string.Empty, settings);
    this.WebView.Name = string.Format("{0}WebBrowser", this.Name);
    this.WebView.Dock = DockStyle.Fill;

    // Setup and regsiter the marshal for the WebView.
    this.chromiumMarshal = new ChromiumMarshal(new Action(() => { this.FlushQueuedMessages(); this.initialising = false; }));
    this.WebView.RegisterJsObject("marshal", this.chromiumMarshal);

    // Setup the event handlers for the WebView.
    this.WebView.PropertyChanged += this.WebView_PropertyChanged;
    this.WebView.PreviewKeyDown += new PreviewKeyDownEventHandler(this.WebView_PreviewKeyDown);

    this.Controls.Add(this.WebView);
}

/// <summary>
/// Handles the PropertyChanged event of CefSharp.WinForms.WebView.
/// </summary>
/// <param name="sender">The source of the event.</param>
/// <param name="e">The event arguments.</param>
private void WebView_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
{
    // Once the browser is initialised, load the HTML for the tab.
    if (!this.webViewIsReady)
    {
        if (e.PropertyName.Equals("IsBrowserInitialized", StringComparison.OrdinalIgnoreCase))
        {
            this.webViewIsReady = this.WebView.IsBrowserInitialized;
            if (this.webViewIsReady)
            {
                string resourceName = "Yaircc.UI.default.htm";
                using (Stream stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName))
                {
                    using (StreamReader reader = new StreamReader(stream))
                    {
                        this.WebView.LoadHtml(reader.ReadToEnd());
                    }
                }
            }
        }
    }

    // Once the HTML has finished loading, begin loading the initial content.
    if (e.PropertyName.Equals("IsLoading", StringComparison.OrdinalIgnoreCase))
    {
        if (!this.WebView.IsLoading)
        {
            this.SetSplashText();
            if (this.type == IRCTabType.Console)
            {
                this.SetupConsoleContent();
            }

            GlobalSettings settings = GlobalSettings.Instance;
            this.LoadTheme(settings.ThemeFileName);

            if (this.webViewInitialised != null)
            {
                this.webViewInitialised.Invoke();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T19:41:45.630

您在评论中更清楚地表明您想要做的是将 jQuery 加载到还没有它的页面中。int0x90 关于`ExecuteScript`在 jQuery 源的本地副本上运行的建议可能对您有用。不过我想提醒您，许多页面与他们的作者从未放在那里的所有额外 JS 不兼容。谷歌和 Facebook 是两个重要的例子。这两个都定义了一个`$`不是 jQuery 的运算符`$`，所以踩它几乎肯定会破坏它们。

底层 CEF 库公开了很多从 C++ 直接操作 DOM 元素的方法，CefSharp 没有公开这些方法，因为对它们的需求还不是很大。不过，这听起来确实是您想要在这里使用的。如果您查看 CefSharp 源代码，公开它们可能不会做太多工作，但我自己还没有尝试过。如果您想尝试，也可以将问题发布到[https://groups.google.com/forum/#!forum/cefsharp](https://groups.google.com/forum/#!forum/cefsharp)

# go - Go 中的特殊包名

> ID：14962288
> 
> 赞同：2
> 
> 时间：2013-02-19T16:21:36.890
> 
> 标签：go

导入名为的自定义子包`qp`时

```
"pkgname/qp" 
```

编译器抱怨

```
... imported and not used: "pkgname/qp"
... undefined: qp 
```

所以很明显包名似乎有问题`qp`，因为当我把它改成

```
qp "pkgname/qp" 
```

错误消失了。

是否有任何“保留”或无效的包名称？为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T17:58:24.503

我猜想包 qp 中的文件不是以一行开头的

```
package qp 
```

他们可能指定了不同的包名称。导入包时，包声明中的名称是可用的名称；如果这与导入路径不匹配，您可能会收到这样的错误。

换句话说，您导入了“pkgname/qp”，但编译器将其称为其他名称，因为您在 package 语句中将其称为其他名称。您没有在代码中引用 somethingElse，因此未使用导入。然后你引用 qp，它没有在任何地方定义（即使它看起来是这样），因为“pkgname/qp”没有定义 qp。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T17:28:08.153

唯一具有特殊含义的包名称是“main”、“C”和以“_something”结尾的（测试和平台特定代码）。

您应该显示您声称由于名称而产生错误的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T17:47:25.857

包名称`qp`有效。例如，

```
package main

import "fmt"

import "local/qp"

func main() { fmt.Println(qp.QP()) } 
```

编译并运行没有错误。

# python - 糟糕的 Django / uwsgi 性能

> ID：14962289
> 
> 赞同：53
> 
> 时间：2013-02-19T16:21:40.690
> 
> 标签：python, django, uwsgi, django-rest-framework

我正在使用 nginx 和 uwsgi 运行 django 应用程序。这是我运行 uwsgi 的方式：

```
sudo uwsgi -b 25000 --chdir=/www/python/apps/pyapp --module=wsgi:application --env DJANGO_SETTINGS_MODULE=settings --socket=/tmp/pyapp.socket --cheaper=8 --processes=16  --harakiri=10  --max-requests=5000  --vacuum --master --pidfile=/tmp/pyapp-master.pid --uid=220 --gid=499 
```

& Nginx 配置：

```
server {
    listen 80;
    server_name test.com

    root /www/python/apps/pyapp/;

    access_log /var/log/nginx/test.com.access.log;
    error_log /var/log/nginx/test.com.error.log;

    # https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-in-production
    location /static/ {
        alias /www/python/apps/pyapp/static/;
        expires 30d;
    }

    location /media/ {
        alias /www/python/apps/pyapp/media/;
        expires 30d;
    }

    location / {
        uwsgi_pass unix:///tmp/pyapp.socket;
        include uwsgi_params;
        proxy_read_timeout 120;
    }

    # what to serve if upstream is not available or crashes
    #error_page 500 502 503 504 /media/50x.html;
} 
```

问题来了。在服务器上执行“ab”（ApacheBenchmark）时，我得到以下结果：

nginx版本：nginx版本：nginx/1.2.6

uwsgi 版本：1.4.5

```
Server Software:        nginx/1.0.15
Server Hostname:        pycms.com
Server Port:            80

Document Path:          /api/nodes/mostviewed/8/?format=json
Document Length:        8696 bytes

Concurrency Level:      100
Time taken for tests:   41.232 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      8866000 bytes
HTML transferred:       8696000 bytes
Requests per second:    24.25 [#/sec] (mean)
Time per request:       4123.216 [ms] (mean)
Time per request:       41.232 [ms] (mean, across all concurrent requests)
Transfer rate:          209.99 [Kbytes/sec] received 
```

在 500 并发级别上运行时

```
oncurrency Level:      500
Time taken for tests:   2.175 seconds
Complete requests:      1000
Failed requests:        50
   (Connect: 0, Receive: 0, Length: 50, Exceptions: 0)
Write errors:           0
Non-2xx responses:      950
Total transferred:      629200 bytes
HTML transferred:       476300 bytes
Requests per second:    459.81 [#/sec] (mean)
Time per request:       1087.416 [ms] (mean)
Time per request:       2.175 [ms] (mean, across all concurrent requests)
Transfer rate:          282.53 [Kbytes/sec] received 
```

正如您所看到的......服务器上的所有请求都失败并出现超时错误或“客户端过早断开连接”或：

```
writev(): Broken pipe [proto/uwsgi.c line 124] during GET /api/nodes/mostviewed/9/?format=json 
```

下面是关于我的应用程序的更多信息：基本上，它是反映包含所有内容的 MySQL 表的模型集合。在前端，我有 django-rest-framework 为客户端提供 json 内容。

我已经安装了 django-profiling 和 django 调试工具栏来看看发生了什么。在 django-profiling 上，这是我在运行单个请求时得到的结果：

```
Instance wide RAM usage

Partition of a set of 147315 objects. Total size = 20779408 bytes.
 Index  Count   %     Size   % Cumulative  % Kind (class / dict of class)
     0  63960  43  5726288  28   5726288  28 str
     1  36887  25  3131112  15   8857400  43 tuple
     2   2495   2  1500392   7  10357792  50 dict (no owner)
     3    615   0  1397160   7  11754952  57 dict of module
     4   1371   1  1236432   6  12991384  63 type
     5   9974   7  1196880   6  14188264  68 function
     6   8974   6  1076880   5  15265144  73 types.CodeType
     7   1371   1  1014408   5  16279552  78 dict of type
     8   2684   2   340640   2  16620192  80 list
     9    382   0   328912   2  16949104  82 dict of class
<607 more rows. Type e.g. '_.more' to view.>

CPU Time for this request

         11068 function calls (10158 primitive calls) in 0.064 CPU seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.064    0.064 /usr/lib/python2.6/site-packages/django/views/generic/base.py:44(view)
        1    0.000    0.000    0.064    0.064 /usr/lib/python2.6/site-packages/django/views/decorators/csrf.py:76(wrapped_view)
        1    0.000    0.000    0.064    0.064 /usr/lib/python2.6/site-packages/rest_framework/views.py:359(dispatch)
        1    0.000    0.000    0.064    0.064 /usr/lib/python2.6/site-packages/rest_framework/generics.py:144(get)
        1    0.000    0.000    0.064    0.064 /usr/lib/python2.6/site-packages/rest_framework/mixins.py:46(list)
        1    0.000    0.000    0.038    0.038 /usr/lib/python2.6/site-packages/rest_framework/serializers.py:348(data)
     21/1    0.000    0.000    0.038    0.038 /usr/lib/python2.6/site-packages/rest_framework/serializers.py:273(to_native)
     21/1    0.000    0.000    0.038    0.038 /usr/lib/python2.6/site-packages/rest_framework/serializers.py:190(convert_object)
     11/1    0.000    0.000    0.036    0.036 /usr/lib/python2.6/site-packages/rest_framework/serializers.py:303(field_to_native)
    13/11    0.000    0.000    0.033    0.003 /usr/lib/python2.6/site-packages/django/db/models/query.py:92(__iter__)
      3/1    0.000    0.000    0.033    0.033 /usr/lib/python2.6/site-packages/django/db/models/query.py:77(__len__)
        4    0.000    0.000    0.030    0.008 /usr/lib/python2.6/site-packages/django/db/models/sql/compiler.py:794(execute_sql)
        1    0.000    0.000    0.021    0.021 /usr/lib/python2.6/site-packages/django/views/generic/list.py:33(paginate_queryset)
        1    0.000    0.000    0.021    0.021 /usr/lib/python2.6/site-packages/django/core/paginator.py:35(page)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/core/paginator.py:20(validate_number)
        3    0.000    0.000    0.020    0.007 /usr/lib/python2.6/site-packages/django/core/paginator.py:57(_get_num_pages)
        4    0.000    0.000    0.020    0.005 /usr/lib/python2.6/site-packages/django/core/paginator.py:44(_get_count)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/db/models/query.py:340(count)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/db/models/sql/query.py:394(get_count)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/db/models/query.py:568(_prefetch_related_objects)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/db/models/query.py:1596(prefetch_related_objects)
        4    0.000    0.000    0.020    0.005 /usr/lib/python2.6/site-packages/django/db/backends/util.py:36(execute)
        1    0.000    0.000    0.020    0.020 /usr/lib/python2.6/site-packages/django/db/models/sql/query.py:340(get_aggregation)
        5    0.000    0.000    0.020    0.004 /usr/lib64/python2.6/site-packages/MySQLdb/cursors.py:136(execute)
        2    0.000    0.000    0.020    0.010 /usr/lib/python2.6/site-packages/django/db/models/query.py:1748(prefetch_one_level)
        4    0.000    0.000    0.020    0.005 /usr/lib/python2.6/site-packages/django/db/backends/mysql/base.py:112(execute)
        5    0.000    0.000    0.019    0.004 /usr/lib64/python2.6/site-packages/MySQLdb/cursors.py:316(_query)
       60    0.000    0.000    0.018    0.000 /usr/lib/python2.6/site-packages/django/db/models/query.py:231(iterator)
        5    0.012    0.002    0.015    0.003 /usr/lib64/python2.6/site-packages/MySQLdb/cursors.py:278(_do_query)
       60    0.000    0.000    0.013    0.000 /usr/lib/python2.6/site-packages/django/db/models/sql/compiler.py:751(results_iter)
       30    0.000    0.000    0.010    0.000 /usr/lib/python2.6/site-packages/django/db/models/manager.py:115(all)
       50    0.000    0.000    0.009    0.000 /usr/lib/python2.6/site-packages/django/db/models/query.py:870(_clone)
       51    0.001    0.000    0.009    0.000 /usr/lib/python2.6/site-packages/django/db/models/sql/query.py:235(clone)
        4    0.000    0.000    0.009    0.002 /usr/lib/python2.6/site-packages/django/db/backends/__init__.py:302(cursor)
        4    0.000    0.000    0.008    0.002 /usr/lib/python2.6/site-packages/django/db/backends/mysql/base.py:361(_cursor)
        1    0.000    0.000    0.008    0.008 /usr/lib64/python2.6/site-packages/MySQLdb/__init__.py:78(Connect)
  910/208    0.003    0.000    0.008    0.000 /usr/lib64/python2.6/copy.py:144(deepcopy)
       22    0.000    0.000    0.007    0.000 /usr/lib/python2.6/site-packages/django/db/models/query.py:619(filter)
       22    0.000    0.000    0.007    0.000 /usr/lib/python2.6/site-packages/django/db/models/query.py:633(_filter_or_exclude)
       20    0.000    0.000    0.005    0.000 /usr/lib/python2.6/site-packages/django/db/models/fields/related.py:560(get_query_set)
        1    0.000    0.000    0.005    0.005 /usr/lib64/python2.6/site-packages/MySQLdb/connections.py:8() 
```

..ETC

但是，django-debug-toolbar 显示以下内容：

```
Resource Usage
Resource    Value
User CPU time   149.977 msec
System CPU time 119.982 msec
Total CPU time  269.959 msec
Elapsed time    326.291 msec
Context switches    11 voluntary, 40 involuntary

and 5 queries in 27.1 ms 
```

问题是“顶部”显示负载平均值迅速上升，我在本地服务器和网络中的远程机器上运行的 apache 基准测试表明我每秒没有服务很多请求。问题是什么？这是我在分析代码时所能达到的，所以如果有人能指出我在这里做什么，我将不胜感激。

**编辑（23/02/2013）：根据 Andrew Alcock 的回答添加更多详细信息：** 需要我注意/回答的要点是 (3)(3) 我在 MySQL 上执行了“显示全局变量”并发现 MySQL 配置max_connections 设置有 151 个，这足以为我开始为 uwsgi 服务的工人提供服务。

(3)(4)(2) 我正在分析的单个请求是最重的。它根据 django-debug-toolbar 执行 4 个查询。发生的情况是所有查询分别运行：3.71、2.83、0.88、4.84 毫秒。

(4) 这里你指的是内存分页？如果是这样，我怎么知道？

(5) 在 16 个工作人员，100 个并发率，1000 个请求上，平均负载上升到 ~ 12 我在不同数量的工作人员上运行测试（并发级别为 100）：

1.  1 个工作人员，平均负载 ~ 1.85，19 个请求/秒，每个请求的时间：5229.520，0 个非 2xx
2.  2 个工作人员，平均负载 ~ 1.5，19 个请求/秒，每个请求的时间：516.520，0 个非 2xx
3.  4 个工作人员，平均负载 ~ 3，16 个请求/秒，每个请求的时间：5929.921，0 个非 2xx
4.  8 个工作人员，平均负载 ~ 5，18 个请求/秒，每个请求的时间：5301.458，0 个非 2xx
5.  16 个工作人员，平均负载 ~ 19，15 个请求/秒，每个请求的时间：6384.720，0 个非 2xx

如您所见，我们拥有的工人越多，系统上的负载就越大。我可以在 uwsgi 的守护进程日志中看到，当我增加工人数量时，响应时间（以毫秒为单位）会增加。

在 16 个工作人员上，运行 500 个并发级别的请求 uwsgi 开始记录错误：

```
 writev(): Broken pipe [proto/uwsgi.c line 124] 
```

负载也上升到 ~ 10。并且测试不需要太多时间，因为非 2xx 响应是 1000 中的 923，这就是为什么这里的响应非常快，因为它几乎是空的。这也是对摘要中您的第 4 点的回复。

假设我在这里面临的是基于 I/O 和网络的操作系统延迟，那么建议采取什么措施来扩大它？新硬件？更大的服务器？

谢谢

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2013-02-23T06:53:14.330

**编辑 1**看到你有 1 个虚拟核心的评论，通过所有相关点添加评论

**编辑 2**来自 Maverick 的更多信息，所以我正在消除排除的想法并开发已确认的问题。

**编辑 3**填写了有关 uwsgi 请求队列和扩展选项的更多详细信息。改进语法。

**编辑**Maverick 的 4 更新和小改进

评论太少，所以这里有一些想法：

1.  平均负载基本上是有多少进程正在运行或等待 CPU 关注。对于具有 1 个 CPU 内核的完美负载系统，负载平均值应为 1.0；对于 4 核系统，它应该是 4.0。运行 Web 测试的那一刻，线程迅速增加，并且您有*很多*进程在等待 CPU。除非负载平均值大大超过 CPU 内核的数量，否则这不是问题
2.  第一个 'Time per request' 值 4s 与请求队列的长度相关 - 1000 个请求几乎是瞬间转储到 Django 上的，平均需要 4 秒来服务，其中大约 3.4 秒在队列中等待。这是由于请求数量 (100) 与处理器数量 (16) 之间的严重不匹配导致 84 个请求在任何时候都在等待一个处理器。
3.  以 100 的并发运行，测试需要 41 秒，每秒 24 个请求。您有 16 个进程（线程），因此每个请求的处理时间约为 700 毫秒。鉴于您的交易类型，每个请求需要*很长时间。*这可能是因为：

    1.  ~~在 Django 中，每个请求的 CPU 成本都很高（鉴于调试工具栏中的 CPU 值较低，这不太可能）~~
    2.  操作系统经常切换任务（尤其是在平均负载高于 4-8 的情况下），延迟纯粹是因为进程太多。
    3.  ~~没有足够的数据库连接为 16 个进程提供服务，因此进程正在等待有一个可用。每个进程是否至少有一个可用连接？~~
    4.  ~~数据库周围有*相当大*~~的延迟，要么：

        1.  ~~数十个小请求，每一个需要 10 毫秒，其中大部分是网络开销。如果是这样，您能否引入缓存或将 SQL 调用减少到更小的数量。或者~~
        2.  ~~一个或几个请求占用了 100 毫秒。要检查这一点，请在数据库上运行分析。如果是这样，您需要优化该请求。~~
4.  尽管总 CPU 较低，但系统和用户 CPU 成本之间的分配在系统中异常高。这意味着 Django 中的大部分工作都是与内核相关的，例如网络或磁盘。在这种情况下，它可能是网络成本（例如接收和发送 HTTP 请求以及接收和发送请求到数据库）。有时这会因为*分页*而很高。如果没有分页，那么您可能根本不必担心这一点。

5.  您已将进程设置为 16，但平均负载较高~~（您未说明多高）~~。理想情况下，您应该始终至少有*一个*进程在等待 CPU（这样 CPU 就不会空转）。这里的进程似乎不受 CPU 限制，但具有显着的延迟，因此您需要比内核更多的进程。还有多少？尝试使用不同数量的处理器（1、2、4、8、12、16、24 等）运行 uwsgi，直到获得最佳吞吐量。如果更改平均进程的延迟，则需要再次调整。
6.  500并发水平肯定是有问题的~~，但是是客户端还是服务端？该报告称 50 个（100 个）的内容长度不正确，这意味着服务器存在问题。非 2xx 似乎也指向那里。是否可以捕获非 2xx 响应以进行调试 - 堆栈跟踪或特定错误消息将非常有用~~（编辑），并且是由运行默认值为 100 的 uwsgi 请求队列引起的。

所以，总结一下：

![在此处输入图像描述](../Images/36236d00c67492b97e9291fd4ceaaec2.png)

1.  Django 看起来不错
2.  负载测试的并发性（100 或 500）与进程（16）之间的不匹配：您将太多的并发请求推送到系统中，无法处理的进程数。一旦超过了进程数，将会发生的只是你将延长 Web 服务器中的 HTTP 请求队列
3.  有很大的延迟，所以要么

    1.  进程 (16) 和 CPU 内核 (1) 不匹配：如果平均负载 > 3，则可能是进程过多。使用较少数量的进程重试

        1.  ~~平均负载 > 2 -> 尝试 8 个进程~~
        2.  ~~平均负载 > 4 -> 尝试 4 个进程~~
        3.  平均负载 > 8 -> 尝试 2 个进程
    2.  ~~如果平均负载<3，则可能是在数据库中，因此对数据库进行分析以查看是否存在大量小请求（额外导致延迟）或一两个 SQL 语句的问题~~

5.  ~~如果不捕获失败的响应，关于 500 并发的失败我无话可说~~

**发展思路**

您在单核机器上的平均负载 > 10*真的很*讨厌，并且（正如您所观察到的）会导致大量任务切换和一般的缓慢行为。我个人不记得看到一台平均负载为 19 的机器（你有 16 个进程） - 恭喜它变得如此之高；）

数据库性能很棒，所以我现在就说清楚了。

**分页**：回答您有关如何查看分页的问题 - 您可以通过多种方式检测操作系统分页。例如，在顶部，标题有页入和页出（见最后一行）：

```
进程：总共 170 个，运行 3 个，卡住 4 个，休眠 163 个，线程 927 个 15:06:31
平均负载：0.90、1.19、1.94 CPU 使用率：1.37% 用户、2.97% 系统、95.65% 空闲共享库：144M 驻留，0B 数据，24M 链接。
MemRegions：总共 31726 个，2541M 常驻，120M 私有，817M 共享。PhysMem：1420M 有线，3548M 活跃，1703M 不活跃，6671M 使用，1514M 免费。
虚拟机：392G vsize，1286M 框架 vsize，1534241(0) 个分页，0(0) 个分页。网络：数据包：789684/288M 输入，912863/482M 输出。磁盘：读取 739807/15G，写入 996745/24G。
```

**进程数**：在您当前的配置中，进程数太高了*。***将进程数缩放回 2**。我们可能会在稍后提高这个值，这取决于进一步转移该服务器的负载。

**Apache Benchmark 的位置**：一个进程的平均负载为 1.85，这表明您在与 uwsgi 相同的机器上运行负载生成器 - 对吗？

如果是这样，您确实需要从另一台机器上运行它，否则测试运行不代表实际负载 - 您从 Web 进程中获取内存和 CPU 以在负载生成器中使用。此外，负载生成器的 100 或 500 个线程通常会对您的服务器造成压力，而这在现实生活中是不会发生的。事实上，这可能是整个测试失败的原因。

**数据库的位置**：一个进程的平均负载也表明您在与 Web 进程相同的机器上运行数据库 - 这是正确的吗？

如果我对数据库的看法是正确的，那么开始扩展的第一个也是最好的方法是将数据库移动到另一台机器上。我们这样做有几个原因：

1.  数据库服务器需要与处理节点不同的硬件配置文件：

    1.  磁盘：数据库需要大量快速、冗余、备份的磁盘，而一个处理节点只需要一个基本磁盘
    2.  CPU：处理节点需要你能负担得起的最快的 CPU，而 DB 机器通常可以不用（通常它的性能受磁盘和 RAM 的限制）
    3.  RAM：DB 机器通常需要尽可能多的 RAM（最快的 DB 将*所有*数据都保存在 RAM 中），而许多处理节点需要的内存要少得多（每个进程需要大约 20MB - 非常小
    4.  扩展性：**原子**数据库通过拥有具有许多 CPU 的巨型机器实现最佳扩展性，而 Web 层（没有状态）可以通过插入许多相同的小盒子来扩展。
2.  CPU 亲和性：CPU 的平均负载最好为 1.0，进程与单个核心具有亲和性。这样做可以最大限度地利用 CPU 缓存并最大限度地减少任务切换开销。通过分离 DB 和处理节点，您可以在硬件中强制执行这种关联。

**500并发异常**上图中的请求队列最多为100——如果uwsgi在队列满的时候接收到请求，请求会被拒绝并报5xx错误。我认为这发生在您的 500 并发负载测试中 - 基本上队列被前 100 个左右的线程填满，然后其他 400 个线程发出剩余的 900 个请求并立即收到 5xx 错误。

要每秒处理 500 个请求，您需要确保两件事：

1.  请求队列大小配置为处理突发：使用`--listen`参数`uwsgi`
2.  如果 500 是正常情况，系统可以处理每秒超过 500 个请求的吞吐量，或者如果 500 是峰值，则略低于每秒。请参阅下面的缩放说明。

我想 uwsgi 将队列设置为较小的数字以更好地处理 DDoS 攻击；如果置于巨大的负载下，大多数请求会立即失败，几乎没有任何处理，从而使整个盒子仍然可以响应管理员。

**扩展系统的一般建议**

您最重要的考虑可能是**最大化吞吐量**。另一个可能需要最小化响应时间，但我不会在这里讨论这个。在最大化吞吐量时，您正在尝试最大化*系统*，而不是单个组件；一些局部降低可能会提高整体系统吞吐量（例如，*为了提高数据库的性能而进行的更改恰好增加了 Web 层的*延迟是净收益）。

具体到：

1.  **将数据库移动到单独的机器上**。`top`在此之后，通过运行和您最喜欢的 MySQL 监控工具在负载测试期间分析数据库。您需要能够配置文件。将数据库移动到单独的机器上会为每个请求引入一些额外的延迟（几毫秒），因此希望稍微增加 Web 层的进程数以保持相同的吞吐量。
2.  使用参数确保`uswgi`请求队列足够大以处理突发流量`--listen`。这应该是您的系统每秒可以处理的最大稳态请求数的几倍。
3.  在 web/app 层：**平衡进程数与 CPU 内核数和进程中**的固有延迟。进程过多会降低性能，过少则意味着您永远无法充分利用系统资源。没有固定的平衡点，因为每个应用程序和使用模式都不同，所以要进行基准和调整。作为指导，使用进程的延迟，如果每个任务都有：

    *   0% 延迟，那么每个核心需要 1 个进程
    *   50% 延迟（即 CPU 时间是实际时间的一半），那么每个核心需要 2 个进程
    *   67% 的延迟，那么每个核心需要 3 个进程
4.  在测试期间检查`top`以确保您的 CPU 利用率高于 90%（对于每个核心）*，并且*您的平均负载略高于 1.0。如果平均负载较高，请缩减进程。如果一切顺利，在某些时候你将无法实现这个目标，而 DB 现在可能是瓶颈

5.  在某些时候，您将需要 Web 层的更多功能。您可以选择向机器添加更多 CPU（相对容易）并因此添加更多进程，**和/或**您可以添加更多处理节点（水平可扩展性）。后者可以使用[Łukasz Mierzwa](https://stackoverflow.com/users/1154047/ukasz-mierzwa)讨论的方法[在uwsgi 中实现](https://stackoverflow.com/a/15050495/1395668)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-24T09:44:55.957

请运行超过一分钟（至少 5-10 分钟）的基准测试，你真的不会从这么短的测试中获得太多信息。并使用 uWSGI 的 carbon 插件将统计信息推送到 carbon/graphite 服务器（您需要拥有一个），您将获得更多用于调试的信息。

当您向您的应用程序发送 500 个并发请求并且它无法处理此类负载时，每个后端上的侦听队列将很快被填满（默认情况下为 100 个请求），您可能希望增加它，但如果工作人员无法处理请求快速和侦听队列（也称为积压）已满，linux 网络堆栈将丢弃请求，您将开始收到错误。

您的第一个基准测试表明您可以在 ~42 毫秒内处理单个请求，因此单个工作人员最多可以处理 1000 毫秒 / 42 毫秒 = 每秒约 23 个请求（如果 db 和应用程序堆栈的其他部分没有随着并发性的增加而减慢） . 因此，要处理 500 个并发请求，您至少需要 500 / 23 = 21 个工作人员（但实际上我会说至少 40 个），您只有 16 个，难怪它在这样的负载下会中断。

编辑：我混合了并发率 - 至少 21 个工作人员将允许您每秒处理 500 个请求，而不是 500 个并发请求。如果您真的想处理 500 个并发请求，那么您只需要 500 个工作人员。除非您将在异步模式下运行您的应用程序，否则请检查 uWSGI 文档中的“Gevent”部分。

PS。uWSGI 带有带有后端自动配置的出色负载均衡器（阅读“订阅服务器”和“FastRouter”下的文档）。您可以将其设置为允许您根据需要热插拔新后端，您只需在新节点上启动工作人员，他们将订阅 FastRouter 并开始获取请求。这是水平扩展的最佳方式。借助 AWS 上的后端，您可以自动执行此操作，以便在需要时快速启动新的后端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T06:47:02.673

添加更多工作人员并获得更少的 r/s 意味着您的请求“是纯 CPU”，并且没有 IO 等待另一个工作人员可以用来服务另一个请求。

如果要扩展，则需要使用具有更多（或更快）cpu 的另一台服务器。

然而，这是一个综合测试，您获得的 r/s 数量是您正在测试的确切请求的上限，一旦投入生产，就会有更多变量会影响性能。

# android - 在 Android 中实现动画屏幕旋转

> ID：14962291
> 
> 赞同：2
> 
> 时间：2013-02-19T16:21:45.487
> 
> 标签：android, animation, screen-rotation

如何在 Android 中实现动画屏幕旋转。目前从我看到的实现中，android 切换屏幕突然显示。

在另一个操作系统 iOS 中，屏幕旋转是动画的。

我见过一个 Android 应用程序似乎截取了当前界面的屏幕截图并旋转它。有一点滞后。

使用屏幕截图方法，如何在无根设备中获取该信息，特别是如果目标受众回到 Android 2.2 或 2.3

最终，如何在 Android 应用中实现动画屏幕旋转？

# haskell - 在 Haskell 中使用 HXT 对 html 表行进行分组

> ID：14962293
> 
> 赞同：1
> 
> 时间：2013-02-19T16:21:47.160
> 
> 标签：haskell, html-table, hxt

我想处理一个（定义非常差的）html，它的信息成对分组，如下所示：

```
<html>
<body>
<table>
 <tr>
     <td>
         <font >
         <a href="a">ABC</a></font>
     </td>
 </tr>
 <tr>
     <td height="50">
         <font>When:</font><font>19-1-2013</font>
          <b><font>&nbsp; </font></b>
         <font>Where:</font><font>Here</font>
         <font>Who:</font><font>Me</font>
     </td>
 </tr>
 <tr>
     <td>
        <font >
             <a href="b">EFG</a>
        </font>
     </td>
 </tr>
 <tr>
     <td height="50">
         <font>When:</font><font>19-2-2013</font>
         <b><font>&nbsp; </font></b>
         <font>Where:</font><font>There</font>
         <font>Who:</font><font>You</font>
     </td>
 </tr>
 <tr>
     <td>
        <font >
            <a href="c">HIJ</a>
        </font>
     </td>
 </tr>
 <tr>
     <td height="50">
         <font>When:</font><font>19-3-2013</font><b>
         <font>&nbsp; </font></b>
         <font>Where:</font><font>Far away</font>
         <font>Who:</font><font>Him</font>
     </td>
 </tr>
</table>
</body>
</html> 
```

对此，经过几次迭代，我得到了这段代码来实现我想要的：

```
import Data.List
import Control.Arrow.ArrowNavigatableTree
import Text.XML.HXT.Core
import Text.HandsomeSoup

group2 [] = []
group2 (x0:x1:xs) = [x0,x1]:(group2 xs)

countRows html = html >>> deep (hasName "tr") >. length

parsePage sz html = let
  n x = deep (hasName "tr") >. (( -> a !! x) . group2 ) >>> unlistA
  m = deep (hasName "td") >>> css "a" /> getText
  o = deep (hasName "td") >>> hasAttr "height" >>> (css "font" >. (take 1 . drop 4)) >>> unlistA /> getText
  p x = (((n x) >>> m) &&& ((n x) >>> o))
  in html >>> catA [p x | x <- [0..sz]]

main = do
    dt <- readFile "test.html"
    let html = parseHtml dt
    count <- (runX . countRows) html
    let cnt = ((head count) `div` 2) - 1
    prcssd <- (runX . (parsePage cnt)) html
    print prcssd 
```

结果是： [("ABC","Here"),("EFG","There"),("HIJ","Far away")]

但是，我认为这不是一个很好的方法，必须先计算行数。有没有更好的方法使用 HXT 进行这种分组？我已经尝试过 &&& 运算符，但运气不佳。

[我相信，使用 hxt 提取多个 html 表](https://stackoverflow.com/questions/10911918/extract-multiples-html-tables-with-hxt)的问题虽然有用，但呈现出更简单的情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T18:58:28.583

几周前我用 hxt 做了一些 html 解析，并认为[xpath](http://www.w3schools.com/xpath/xpath_syntax.asp)非常方便。不幸的是，我没有为您的问题想出一个完美的解决方案，但这可能是一个新尝试的开始。

```
import Text.XML.HXT.Core
import Text.XML.HXT.XPath.Arrows

type XmlTreeValue a = a XmlTree String
type ParsedXmlTree a = a XmlTree XmlTree
type IOXmlTree = IOSArrow XmlTree XmlTree

-- parses a given .html file
parseHtml :: FilePath -> IOStateArrow s b XmlTree
parseHtml path = readDocument [withParseHTML yes, withWarnings no] path

-- "" for stdout
saveHtml :: IOXmlTree
saveHtml = writeDocument [withIndent yes] ""

extract :: IOXmlTree
extract = processChildren (process `when` isElem)

-- main processing functon
processHtml :: FilePath -> IO ()
processHtml src =
  runX (parseHtml src >>> extract >>> saveHtml)
   >> return ()

-- process the html structure
process :: ArrowXml cat => ParsedXmlTree cat
process =
  -- create tag <structure> for the expression given next
  selem "structure"
    -- navigate to <html><body><table><tr>...
    [(getXPathTrees "/html/body/table/tr")
      -- then combine the results
      >>> (getTheName <+> getWhere)]

 -- selects text at path <td><font><a...> </a></font></td> and creates <name>-Tag
 -- (// means that all <td>-tags are analysed,
 --  but I'm not quite sure why this is relevant here)
 getTheName :: ArrowXml cat => ParsedXmlTree cat
 getTheName = selem "name" [getXPathTrees "//td/font/a/text()"]

 -- selects text at path <td><font><a...> </a></font></td>
 -- (where the forth font-tag is taken) and creates <where>-Tag
 getWhere  :: ArrowXml cat => ParsedXmlTree cat
 getWhere = selem "where" [getXPathTrees "//td/font[4]/text()"] 
```

结果如下所示：

```
*Main> processHtml "test.html"
<?xml version="1.0" encoding="UTF-8"?>
<structure>
 <name>ABC</name>
 <where/>
 <name/>
 <where>Here</where>
 <name>EFG</name>
 <where/>
 <name/>
 <where>There</where>
 <name>HIJ</name>
 <where/>
 <name/>
 <where>Far away</where>
</structure> 
```

就像我说的，不是很完美，但希望是一个开始。

编辑：也许这看起来更像你的方法。尽管如此，我们不会删除您不关心的元素，而是首先选择所有适合并过滤结果的元素。我认为对于这样的问题没有通用的方法是非常有趣的。因为，不知何故，字体[4] 选择不适用于我的其他方法 - 但也许我不是一个好的 xpath 用户。

```
processHtml :: FilePath -> IO [(String,String)]
processHtml src = do
  names <- runX (parseHtml src >>> process1)
  fontTags <- runX (parseHtml src >>> process2)
  let wheres = filterAfterWhere fontTags
  let result = zip names wheres
  return result
 where filterAfterWhere [] = []
       filterAfterWhere xs = case dropWhile (/= "Where:") xs of
                               []     -> []
                               [x]    -> [x]
                               _:y:ys -> y : filterAfterWhere ys

process1 :: ArrowXml cat => XmlTreeValue cat
process1 = textNodeToText getTheName

process2 :: ArrowXml cat => XmlTreeValue cat
process2 =  textNodeToText getWhere

getTheName :: ArrowXml cat => ParsedXmlTree cat
getTheName = getXPathTrees "//td/font/a/text()"

getWhere  :: ArrowXml cat => ParsedXmlTree cat
getWhere = getXPathTrees "//td/font/text()"

-- neet function to select a value within a XmlTree as String
textNodeToText :: ArrowXml cat => ParsedXmlTree cat -> XmlTreeValue cat
textNodeToText selector = selector `when` isElem >>> getText 
```

这样，您将获得问题中显示的结果：

```
*Main> processHtml "test.html"
[("ABC","Here"),("EFG","There"),("HIJ","Far away")] 
```

编辑2：

有趣的事实：看起来 hxt-xpath 库对于这样的索引选择不太合适。[在线 XPath 评估器](http://www.freeformatter.com/xpath-tester.html#ad-output)显示`//td/font[4]/text()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T11:08:16.820

这是一个更简单的实现。

```
import Text.XML.HXT.Core
import Text.HandsomeSoup

group2 :: [a] -> [(a, a)]
group2 [] = []
group2 (x0:x1:xs) = (x0, x1) : group2 xs

parsePage :: ArrowXml a => a XmlTree (String, String)
parsePage = let
    trPairs    = deep (hasName "tr") >>. group2
    insideLink = deep (hasName "a") /> getText
    insideFont = deep (hasName "font") >>. (take 1 . drop 4) /> getText

    in trPairs >>> (insideLink *** insideFont)

main = do
    dt <- readFile "test.html"
    let html = parseHtml dt
    prcssd <- runX $ html >>> parsePage
    print prcssd 
```

[`>>.`](http://hackage.haskell.org/packages/archive/hxt/latest/doc/html/Control-Arrow-ArrowList.html#v%3a-62--62--46-)可以使用操作员代替，这样`>.`您以后就不需要打电话`unlistA`了。

我更改了`group2`函数以返回对列表，因为它更好地映射了我们想要实现的目标，并且更容易使用。

的类型`trPairs`是

```
trPairs :: ArrowXml a => a XmlNode (XmlNode, XmlNode) 
```

即它是一个箭头，它接收节点并输出一对节点（即成对的`<tr>`节点）。现在我们可以使用[`***`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Arrow.html#v%3a-42--42--42-)操作符 from[`Control.Arrow`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Arrow.html)将转换应用于该对的任何一个元素，`insideLink`对于第一个元素和`insideFont`第二个元素。通过这种方式，我们可以通过一次遍历 HTML 树来收集和分组我们需要的所有内容。

# c# - C# 中的可空字符串

> ID：14962298
> 
> 赞同：1
> 
> 时间：2013-02-19T16:22:04.287
> 
> 标签：c#, nullable

我知道 C# 中的字符串可以通过使用 null 来“为空”。

但是，可空类型的全部意义在于我从编译器那里获得了帮助[编辑：又名，类型错误：无法将苹果添加到香蕉中]

并且使用这种“可空性取决于底层类型”的“类型系统hack-ish”打破了我可能拥有的任何保证（这不是一个小壮举，因为这似乎是首先使用类型系统的全部意义...... )

如果有人愿意，在 C# 中处理这个问题的标准方法是什么？我应该推出自己的“可空”类吗？

**编辑**

让我重新表述一下这个问题：

在 C# 中，确保您注释为可为空的变量不会被分配给您未注释为可为空的变量的标准方法是什么。

那就是：**所有类型**的标准方法是什么，究竟是什么**？**关键字为您提供值类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T17:21:35.143

如果您要询问一种方法来确保某个方法的返回类型不是`null`，那么有一个解决方案：该方法必须返回一个值类型。每个返回引用类型的方法都可能返回`null`. 您对此无能为力。

因此，您可以创建一个`struct`这样的函数来返回值类型：

```
public struct SurelyNotNull<T>
{
    private readonly T _value;

    public SurelyNotNull(T value)
    {
        if(value == null)
            throw new ArgumentNullException("value");
        _value = value;
    }

    public T Value
    {
        get { return _value; }
    }
} 
```

您应该返回字符串的方法现在可以返回`SurelyNotNull<string>`。

这种方法的问题是：
它不起作用。虽然方法的返回值保证为 not `null`，但 的返回值`SurelyNotNull<T>.Value`不是。乍一看，它似乎保证不为空。但它可能是这样的：
每个结构都有一个隐式的、公共的、无参数的构造函数，*即使定义了另一个构造函数*。
以下代码是有效的，并与`struct`上面的代码一起编译：

```
new SurelyNotNull<string>(); 
```

**结论：**
在 C# 中，您无法实现您想要做的事情。
您仍然可以使用这种方法，您只需要了解有人可以使用这种类型并仍然产生空值。要在这种情况下快速失败，最好在 getter 中添加检查，如果为 null `Value`，则抛出异常。`_value`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T17:38:06.800

正如 Daniel Hilgarth 指出的那样，没有万无一失的方法可以实现这一目标。我的建议与他的类似，但增加了一些安全性。您可以自己决定在整个程序中使用包装器类型的好处是否超过成本。

```
struct NonNull<T> where T : class {
    private readonly T _value;
    private readonly bool _isSafe;

    public NonNull(T value) {
        if (value == null)
            throw new ArgumentNullException();
        _value = value;
        _isSafe = true;
    }
    public T Value {
        get {
            if (_isSafe) return _value;
            throw new ArgumentNullException();
        }
    }
    public static implicit operator T(NonNull<T> nonNull) {
        return nonNull.Value;
    }
}

static class NonNull {
    public static NonNull<T> Create<T>(T value) where T : class {
        return new NonNull<T>(value);
    }
} 
```

包装器类型主要是为了使您的意图自我记录，因此您不太可能使用零初始化结构绕过它，但它保留一个标志以指示它无论如何都已正确初始化。在那种公认的不寻常的情况下，它会`ArgumentNullException`在访问该值时抛出一个。

```
class Program {
    static void Main(string[] args) {
        IsEmptyString(NonNull.Create("abc")); //false
        IsEmptyString(NonNull.Create("")); //true
        IsEmptyString(null); //won't compile
        IsEmptyString(NonNull.Create<string>(null)); //ArgumentNullException 
        IsEmptyString(new NonNull<string>()); //bypassing, still ArgumentNullException
    }

    static bool IsEmptyString(NonNull<string> s) {
        return StringComparer.Ordinal.Equals(s, "");
    }
} 
```

现在，这比偶尔的 NRE 更好吗？也许。它可以节省大量样板 arg 检查。您需要确定它是否适合您的情况。缺少编译器支持，就像 F# 提供的那样，没有办法提供编译时空安全性，但您可以（可以说）简化运行时安全性。

您可能希望在 Microsoft 的客户反馈网站上对此问题进行投票：[在 C# 中添加不可为空的引用类型](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2320188-add-non-nullable-reference-types-in-c-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T18:02:18.287

您想要类似 NotNull 属性的东西。使用这些会给你编译时警告和错误，并且在某些情况下 IDE 反馈关于将 NULL 值分配给 NotNull 属性。

看到这个问题：[C#：如何实现和使用 NotNull 和 CanBeNull 属性](https://stackoverflow.com/questions/792531/c-how-to-implement-and-use-a-notnull-and-canbenull-attribute)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:26:58.687

所有[引用类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)都可以为空。字符串是引用类型。

# asp.net - ASP.NET MVC3 实体框架 - 数据检索

> ID：14962299
> 
> 赞同：0
> 
> 时间：2013-02-19T16:22:05.923
> 
> 标签：asp.net, asp.net-mvc-3, entity-framework, poco

我正在使用 ASP.NET MVC3 和实体框架为我的老板开发一个报告工具。我正在使用 POCO 模型和 DBContext 从我们的数据库中检索数据并创建数据层。当我创建一些示例数据时，它很简单：2 个包含少量列的表，而且它的工作方式很有魅力。现在我正在尝试在我们的测试环境中测试我的应用程序，这就是问题出现的地方。

我正在使用的数据库有 137 个表，但我只需要其中两个表中的数据。我已经模拟了我需要数据的两个表并相应地设置了我的应用程序，但没有骰子。所以我的问题是我是否必须为每个表创建一个类，即使我的应用程序只使用数据库中的两个表？此外，我在此环境中具有只读权限。这应该没问题，因为我的应用程序只是选择数据，而不是操作它。

**更新**

我收到的错误是这样的：

EntityCommandExecutionException 未被用户代码处理。执行命令定义时发生错误。

详细信息：System.Data.SqlClient.SqlException：列名无效

列名是我要加入的另一个表的 PK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:30:12.167

是的。您需要为数据库中的每个表创建一个类或生成类。使用实体框架，数据库必须与您的 DbContext 类匹配。您将希望生成您的类，因为您已经创建了数据库。

[http://msdn.microsoft.com/en-us/data/jj206878.aspx](http://msdn.microsoft.com/en-us/data/jj206878.aspx)

# ios - 多声道音频 iOS（需要 4 个同时输入）

> ID：14962300
> 
> 赞同：1
> 
> 时间：2013-02-19T16:22:09.013
> 
> 标签：ios, audio, ios6, core-audio, remoteio

我正在做一个项目，我需要同时处理 4 个音频输入流。到目前为止，我一直在使用立体声音频流，其中数据来自专为 iOS 设计的基于 USB 的音频设备，例如 Tascam iM2。

*   iOS 6 是否支持更多的 2 通道同时输入？
*   如果是这样，有哪些设备可用于此？

编辑：我已经看到 4 通道 Apogee 四重奏与 iOS 兼容。是否可以使用此设备同时录制 4 个音频通道？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:27:27.410

去年夏天我做过一个类似的项目，如果我没记错的话，如果你想同时处理多个流，你需要使用音频队列服务。

它是一头野兽，并且没有很好的文档记录。

如果您可以处理一些早期代码，我编写了一个示例项目，它使用音频队列服务 ( [https://github.com/acopp/Streamer/tree/master/Streamer](https://github.com/acopp/Streamer/tree/master/Streamer) ) 播放声音。您显然需要对其进行调整，但我相信这是一个很好的起点。

# java - 正在为 Java 读取的文本文件中的注释

> ID：14962307
> 
> 赞同：0
> 
> 时间：2013-02-19T16:22:27.417
> 
> 标签：java, comments

当用 Java 编写程序并且您想读取文件时，用户是否可以通过使某个文件的行或字符更多地成为“注释”来让程序完全忽略某些行或字符？就像程序员在编程时可以使用“//”或“/* */”一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:25:51.303

如果它是一种属性文件格式并且您正在使用`Properties`它来读取它，则可以使用井号字符。否则，不，你需要自己实现一些东西。

```
my.prop1=val1
#some comment
my.prop2=val2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:26:04.833

当然。如果程序使用这样的代码从文件中读取行：

```
BufferedReader reader = 
    new BufferedReader (
        new InputStreamReader (new FileInputStream (inputFile)));

String line;
while ((line = reader.readLine ()) != null)
{
    if (line.startWith ("#") || line.trim ().isEmpty ())
        continue; // Ignore the line

    // Process the line
} 
```

用户可以通过在它们前面加上井号 ('#') 字符来将某些行标记为注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:28:38.510

您可以跳过以特定模式开头的行（例如“//”或“#”）。

这里有一个关于如何在 Java 中逐行读取文件的示例：[http ://www.roseindia.net/Java/beginners/java-read-file-line-by-line.shtml](http://www.roseindia.net/Java/beginners/java-read-file-line-by-line.shtml)

您可以像这样更改while循环：

```
while ((strLine = br.readLine()) != null)   {
  if (!strLine.startWith("#"))
    System.out.println (strLine);
} 
```

在此示例中，以“#”开头的行将不会被打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:49:45.633

如果您只想转换新文件，这取决于您要完成的任务，然后您可以使用`BufferedReader reader`逐行读取文件，然后检查每一行以查看它是否符合某些标准，并采取必要的措施，`if (line.startWith ("#") || line.trim ().isEmpty ())`否则最好使用标准库对您的文件执行操作，例如压缩文件，将文件更改为不同的格式等

# c# - 如何在二维矩阵中设置值

> ID：14962312
> 
> 赞同：-6
> 
> 时间：2013-02-19T16:22:35.143
> 
> 标签：c#

给定字符串：“a”，“b”，“c”，“d”，“e”，“f”，“g”，“h”，我该如何排列它们：

```
-1-  -2- -3-    
 "a" "b" "c"  

-1-  -2- -3-  
"d"  "e"  "f"  

-1-  -2- -3-  
"g"  "h"  "df" 
```

1,2,3 是列名。（在数据表中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:30:03.733

这是使用的 Linq 方法`Enumerable.GroupBy`：

```
List<string> strings = new List<string>() { "a", "b", "c", "d", "e", "f", "g", "h" };
var trios = strings
    .Select((s, i) => new { Str = s, Index = i })
    .GroupBy(x => x.Index / 3);
foreach(var trio in trios){
    var newRow = table.Rows.Add(); // your DataTable here
    newRow.ItemArray = trio.Select(x => x.Str).ToArray();
} 
```

如果列表**不能**被三整除，这种方法也适用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:31:13.283

```
foreach (var data in new[] { "a", "b", "c", "d", "e", "f", "g", "h", "df" }.Select((s, i) => new { Value = s, Column = i % 3 + 1 }))
{
    Insert(data.Column, data.Value);
} 
```

# sql - 从 SQL 错误日志中的文本中提取登录信息

> ID：14962313
> 
> 赞同：0
> 
> 时间：2013-02-19T16:22:37.093
> 
> 标签：sql, substring

我正在尝试跟踪 SQL 登录成功和失败，并将它们存储在 SQL 表中以进行查询。我写了一个有效的查询，但我的问题是，当登录名包含域时，它可以正常工作，但如果它不包含域，它会添加额外的文本。我希望有人可以帮助我查看我的代码并查看如何删除登录名后的额外内容。

它返回的示例：Domain\BBruning

域\SQLServ

域\BSmith

域\JHarris'。

scgWeb'。原因：F

cpadmin'。原因：

```
CREATE TABLE [dbo].[#TmpErrorLog]
([LogDate] DATETIME NULL,
[ProcessInfo] VARCHAR(20) NULL,
[Text] VARCHAR(MAX) NULL);

CREATE TABLE [dbo].[#TmpErrorLog2]
([LogDate] DATETIME NULL,
[ProcessInfo] VARCHAR(20) NULL,
[Text] VARCHAR(MAX) NULL,
[LoginAttempt] VARCHAR(20) NULL,
[ServerName] VARCHAR(20) NULL);

INSERT INTO #TmpErrorLog ([LogDate], [ProcessInfo], [Text])
EXEC [master].[dbo].[xp_readerrorlog] 0 ;

INSERT INTO #TmpErrorLog2 ([LogDate], [ProcessInfo], [Text], [LoginAttempt])
Select LogDate, ProcessInfo, Text, SUBSTRING(Text,0,16) as LoginAttempt
From #TmpErrorLog
Where LogDate > GETDATE() - 120 and 
[ProcessInfo] = 'Logon' and 
Text like '%Login%' and text not like '%untrusted%'

INSERT INTO [MyTABLE] ([LogDate], [LoginAttempt], [LoginUser], [ServerName], [Log_date_key])
Select 
LogDate, 
Case LoginAttempt When 'Login succeeded' Then 'Successful' ELSE  'Failed' End as    LoginAttempt,
SUBSTRING(SUBSTRING(Text, CHARINDEX('''', Text,1), CHARINDEX('''', Text, 0) - 4),2,50)    as LoginUser, @@SERVERNAME, (Convert(INT, LogDate, 112))
From #TmpErrorLog2
Where LogDate Not In(Select LogDate From [MyTable]) 

Drop Table #TmpErrorLog
Drop Table #TmpErrorLog2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:41:07.230

在最终选择中，您的子字符串使用情况有点偏离。

你有

```
SUBSTRING(SUBSTRING(Text, CHARINDEX('''', Text,1), CHARINDEX('''', Text, 0) - 4),2,50) 
```

你需要的是

```
SUBSTRING(
    Text, 
    CHARINDEX('''', Text,1)+1, 
    CHARINDEX('''', Text, CHARINDEX('''', Text,1)+1) - CHARINDEX('''', Text,1)-1
) 
```

您提供了开始位置和结束位置，tsql 需要开始位置和您希望返回的字符串的长度。

# html - 如何在 SQL Server 2008 中将 varbinary 列关联到“.html” - 需要创建全文索引

> ID：14962322
> 
> 赞同：0
> 
> 时间：2013-02-19T16:23:07.377
> 
> 标签：html, sql-server-2008, html-parsing, full-text-search, varbinarymax

我需要索引一个存储 HTML 数据的列，并且我想忽略标记。这是我所知道的：

1.  将列存储为 varbinary(MAX)

2.  将其关联的文件类型设置为“.html”

3.  在列上启用全文搜索。

这可能是一个愚蠢的问题，但我无法弄清楚第 2 步。如何将 varbinary(MAX) 列关联为“.html”？我已经确认我已经安装了 HTML 过滤器。

# javascript - 使用 Json api 下载 Google Storage Media

> ID：14962328
> 
> 赞同：4
> 
> 时间：2013-02-19T16:23:23.270
> 
> 标签：javascript, google-cloud-storage

我正在尝试使用 Javascript json api 从 Google Storage 下载文件。我可以使用下面的代码检索对象信息，但是我不确定如何获取实际媒体。我对 Java 库方法 getMediaHttpDownloader 很熟悉，但在 JS 中没有看到等效方法。任何帮助，将不胜感激！

```
gapi.client.storage.objects.get({"bucket":"bucketName","object":"objectName"}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T01:07:09.740

Javascript 库目前不支持直接下载媒体。您仍然可以访问数据，但您必须以另一种方式访问​​它。

根据您的网站所在的域和您正在读取的存储桶，您需要设置 CORS：[https ://developers.google.com/storage/docs/cross-origin](https://developers.google.com/storage/docs/cross-origin)

然后，您需要直接通过 XML API 请求对象。例如，您可以执行以下操作：

```
var accessToken = gapi.auth.getToken().access_token;
var xhr = new XMLHttpRequest();
xhr.open('GET', 'https://'+bucket+'.storage.googleapis.com/'+object);
xhr.setRequestHeader('Authorization', 'Bearer ' + accessToken);
xhr.send(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T00:48:56.557

我最终没有使用 api（不确定您是否可以使用 api 下载，如果您知道如何下载，则感兴趣）而是使用 XmlHttpRequest。为此，我必须为我的谷歌存储桶设置 CORS，以允许我的站点跨域访问。下面是我的代码：

```
var myToken = gapi.auth.getToken();
    var req = new XMLHttpRequest;

    req.open('GET','https://storage.googleapis.com/bucket/object',
                    true);
    req.setRequestHeader('Authorization', 'Bearer ' + myToken.access_token);

    req.send(null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-01T08:37:52.990

我是用 gapi 和 jQuery 做的。

在我的情况下，对象是公开的。（必须检查存储浏览器中的*公共链接）。*如果您不希望您的对象公开，请使用 $.post 而不是 $.get 并提供assess_token 作为标题，就像在其他答案中所做的那样。
`Storage.getObjectInfo`检索对象元数据。 `Storage.getObjectMedia`检索对象内容。

```
var Storage = function() {};
Storage.bucket = 'mybucket';
Storage.object = 'myfolder/myobject'; //object name, got by gapi.objects.list 

Storage.getObjectMedia = function(object, callback) {
    function loadObject(objectInfo) {
      var mediaLink = objectInfo.mediaLink;
      $.get(mediaLink, function(data) {   //data is actually object content
        console.log(data);
        callback(data);
      });
    }
    Storage.getObjectInfo(object, loadObject);
};
Storage.getObjectInfo = function(object, callback) {
  var request = gapi.client.storage.objects.get({
    'bucket' : Storage.bucket,
    'object' : Storage.object
  });
  request.execute(function(resp) {
    console.log(resp);
    callback(resp);
  });
}; 
```

当我们需要下载对象的内容时，也是比较少见的情况。在大多数情况下，存储在 Storage 中的对象是媒体文件，例如图像和声音，然后我们实际上需要的是`mediaLink`，必须将其插入到适当的 dom 元素（或）`src`的属性值中。`img``audio`

# java - 使用属性文件为变量赋值的问题

> ID：14962331
> 
> 赞同：0
> 
> 时间：2013-02-19T16:23:27.480
> 
> 标签：java

大家好，我有一个问题，我有一个属性文件，它存储了所有的保存位置，我通过以下方式从这个文件中获取数据：

```
public void loadProp() {
        System.out.println("Loading properties");
        InputStream in = this.getClass().getClassLoader().getResourceAsStream("config.properties"); //points to a properties file, this will load up destinations instead of having to declare them here
        try {
            configProp.load(in);
            System.out.println(configProp.getProperty("destinationPDF"));
            System.out.println(configProp.getProperty("destination"));
            System.out.println(configProp.getProperty("fileList"));
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.println("called get username");
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
        System.out.println(username);

    } 
```

然后我这样做以将值分配给目标

```
public String destination = configProp.getProperty("destination"); 
```

但是每当我使用目的地时，我都会得到一个空值，但是如果我使用 configProp.getProperty("destination") 我会得到完整的路径，我在这里做错了什么，因为我希望该值指向目的地，因为其他类取决于它

编辑 ：

```
This class is called on by a command button (web app)

    @ViewScoped
    @ManagedBean(name = "fileUploadController")
    public class FileUploadController {

        public boolean isUploadComplete() { //to enable the next button once finished
            return uploadComplete;
        }

        public void setUploadComplete(boolean uploadComplete) {
            this.uploadComplete = uploadComplete;
        }

        public boolean isUploadComplete2() {
            //to disable the file upload button, this will stop users uploading multiple files and over writing them as only the last file uploaded will be used
            return uploadComplete;
        }

        public void setUploadComplete2(boolean uploadComplete) {
            this.uploadComplete = uploadComplete;
        }
        /*
         public void handleFileUpload(FileUploadEvent event) {
         System.out.println("called");
         FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
         FacesContext.getCurrentInstance().addMessage(null, msg);
         }
         }
         */
        //
        //Strings for fileUpload
        //oadProp() 
        //public String fileList = "D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/Directory Files/directoryFiles.txt"; //
        private Properties configProp = new Properties();

        @PostConstruct
        //System.out.println(destinationPDF);
        //System.out.println(destination);
    // Get the username from the login page, this is used to create a folder for each user
        public void loadProp() {
            System.out.println("Loading properties");
            InputStream in = this.getClass().getClassLoader().getResourceAsStream("config.properties"); //points to a properties file, this will load up destinations instead of having to declare them here
            try {
                configProp.load(in);
                System.out.println(configProp.getProperty("destinationPDF"));
                System.out.println(configProp.getProperty("destination"));
                System.out.println(configProp.getProperty("fileList"));
            } catch (IOException e) {
                e.printStackTrace();
            }
            System.out.println("called get username");
            username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
            System.out.println(username);

        }
//String destinationPDF = configProp.getProperty("destinationPDF"); Always makes a null no idea why yet
    //private String destinationPDF = configProp.getProperty("destinationPDF");
    public String destination = configProp.getProperty("destination");
    private String username;
    //public static String destination = "D:/Documents/NetBeansProjects/printing~subversion/fileupload/uploaded/"; // main location for uploads//TORNADO ONLY //"D:/My Documents/NetBeansProjects/printing~subversion/fileupload/uploaded/"; // USE ON PREDATOR ONLY 
    public static String NewDestination;
    public static String UploadedfileName;
    public static String CompletefileName;
    //
    //Strings for file copy
    //
    //private String destinationPDF = "D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/"; //USE ON TORNADO//"D:/My Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/";//USE ON PREDATOR    
    private String NewdestinationPDF;
    public static String PdfLocationViewable;
    private boolean uploadComplete;
    private boolean uploadComplete2;

    //
    public void File() { 
```

以上是该类的第一段代码

控制台中的输出是：

```
INFO: buttonToUploadText invoked
INFO: Loading properties
INFO: D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/
INFO: D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/
INFO: D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/Directory Files/directoryFiles.txt
INFO: called get username
INFO: null
INFO: destination is null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:36:32.123

替换此行

```
public String destination = configProp.getProperty("destination"); 
```

和

```
public String destination; 
```

并提供一个构造函数：

```
public FileUploadController() {
    loadProp();
    this.destination = configProp.getProperty("destination");
} 
```

现在，`loadProp()`将由构造函数调用，您不必再这样做了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:40:50.537

您的订单已关闭。这是当你的 bean 被容器实例化时会发生的情况：

1.  构造函数将被调用
2.  所有注入的字段都将被解析
3.  PostConstruct 将被调用。

目前，您在加载属性***之前***`destination`设置值。这个问题的一个非常简单的解决方案是简单地在你的 @PostConstruct 处理程序中设置值。*`destination`*

 *```
@PostConstruct
public void loadProp() {
    InputStream in = this.getClass().getClassLoader()
            .getResourceAsStream("config.properties");
    try {
        configProp.load(in);
    } catch (IOException e) {
        e.printStackTrace();
    }

    destination = configProp.getProperty("destination");
} 
```

与其他方法相比，此方法的一个优点是`destination`每次`loadProp`调用该方法时都会正确设置该属性（而不是只调用一次）。*

# c# - 非管理员的 HttpListenerException “访问被拒绝”

> ID：14962334
> 
> 赞同：22
> 
> 时间：2013-02-19T16:23:35.423
> 
> 标签：c#, exception, httplistener, non-admin

`HttpListener`我已经编写了一个用于监听 HTTP 请求的 C# 应用程序- 很明显！我使用的命名空间前缀也是`netsh`为当前用户注册的（正如 SO 上的每个人所建议的那样）。

问题是尽管使用了 netsh，但我的应用程序仍然会为非管理员用户抛出“访问被拒绝”异常。操作系统是 Windows 7。

`netsh`更新：当我使用非管理员用户运行它时，我的应用程序似乎没有执行该命令。我的代码有问题吗？没有抛出异常。

```
 AddAddress("http://localhost:8400/", Environment.UserDomainName, Environment.UserName);

    HttpListener _listener = new HttpListener();
    _listener.Prefixes.Add("http://localhost:8400/");
    _listener.Start();

    ...

    /** method stolen from an SO thread. sorry can't remember the author **/
    static void AddAddress(string address, string domain, string user)
    {
        string args = string.Format(@"http add urlacl url={0}", address) + " user=\"" + domain + "\\" + user + "\"";

        ProcessStartInfo psi = new ProcessStartInfo("netsh", args);
        psi.Verb = "runas";
        psi.CreateNoWindow = true;
        psi.WindowStyle = ProcessWindowStyle.Hidden;
        psi.UseShellExecute = true;

        Process.Start(psi).WaitForExit();
    } 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-20T05:04:43.753

我在做 HttpListener 时使用的行是：

```
netsh http add urlacl url=http://+:8008/ user=Everyone listen=yes 
```

用户可以是个人用户或用户组。因此，如果您只希望管理员有权访问，例如：

```
netsh http add urlacl url=http://+:8008/ user=Administrators listen=yes 
```

您可以获得有关命令的帮助：

```
netsh http add urlacl help 
```

请注意，这`url=`是可选的。此外，旧版本的命令需要 true 或 false 的 listen 参数。当前版本使用是或否。

# java - 我的时钟没有显示秒数增加

> ID：14962336
> 
> 赞同：1
> 
> 时间：2013-02-19T16:23:38.087
> 
> 标签：java, swing, time

为什么我的时钟没有显示秒数增加？

```
public class timeTest extends javax.swing.JFrame {

    public timeTest() {
        initComponents();
        showTime();
    }

    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new timeTest().setVisible(true);
            }
        });
    }

    private javax.swing.JLabel timeLable;

    private void showTime() {
        Timer timer = new Timer(100, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                Calendar time = Calendar.getInstance();
                timeLable.setText(time.getTime().toString());
            }
        });
        timer.setRepeats(false);
        timer.start();
    }
} 
```

我还没有编写代码，它是由 IDE 生成的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T16:27:19.777

您的计时器不会重复。

```
timer.setRepeats(true); 
```

将其设置为重复。

实际上你甚至不需要这个，它默认设置为true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:40:43.213

代替

```
timer.setRepeats(false); 
```

和

```
timer.setRepeats(true); 
```

我只是为漂亮的外观添加了一个日期格式化程序

```
public class timeTest extends javax.swing.JFrame {

  SimpleDateFormat date_format = new SimpleDateFormat("MMM dd, yyyy HH:mm:ss");

    public timeTest() {
        initComponents();
        showTime();
    }

    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new timeTest().setVisible(true);
            }
        });
    }

    private javax.swing.JLabel timeLable;

    private void showTime() {
        Timer timer = new Timer(100, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                Calendar time = Calendar.getInstance();
                timeLable.setText(date_format.format(time.getTime()));
            }
        });
        timer.setRepeats(true);
        timer.start();
    }
} 
```

# c# - 接口合约混淆静态检查器

> ID：14962341
> 
> 赞同：3
> 
> 时间：2013-02-19T16:24:04.080
> 
> 标签：c#, code-contracts

假设以下简单代码：

```
public class Foo // : IFoo
{
    private string _field;

    public string Property
    {
        get { return _field; }
    }

    private void SetField()
    {
        _field = " foo ";
    }

    private string Method()
    {
        SetField();
        return Property.Trim();
    }
} 
```

静态检查器能够证明它在使用`Property`时不会为空`Method`。

现在，我引入了一个接口和一个合约，静态检查器开始抱怨：“可能在空引用 'this.Property' 上调用一个方法。

**这是一个错误还是我错过了什么？**

* * *

带有接口的代码如下所示：

```
public class Foo : IFoo
{
    private string _field;

    public string Property
    {
        get { return _field; }
    }

    private void SetField()
    {
        _field = " foo ";
    }

    private string Method()
    {
        SetField();
        return Property.Trim();
    }
}

[ContractClass(typeof(IFooContract))]
public interface IFoo
{
    string Property { get; }
}

[ContractClassFor(typeof(IFoo))]
public abstract class IFooContract : IFoo
{
    public string Property
    {
        get { throw new System.NotImplementedException(); }
    }
} 
```

我的设置是这样的：

![](../Images/7c0b3d619a7aa22246e334a52e775814.png)

我得到以下输出：

```
[...]
C:\{path}\CC2.cs(11,19): message : CodeContracts: Suggested ensures: Contract.Ensures(Contract.Result<System.String>() == this._field);
C:\{path}\CC2.cs(16,13): message : CodeContracts: Suggested ensures: Contract.Ensures(this._field != null);
C:\{path}\CC2.cs(21,13): message : CodeContracts: Suggested ensures: Contract.Ensures(Contract.Result<System.String>() != null);
C:\{path}\CC2.cs(21,13): message : CodeContracts: Suggested ensures: Contract.Ensures(this._field != null);
C:\{path}\CC2.cs(21,13): message : CodeContracts: Suggested ensures: Contract.Ensures(this.Property.Trim() != null);
C:\{path}\CC2.cs(21,13): message : CodeContracts: Suggested ensures: Contract.Ensures(Contract.Result<System.String>() == this.Property.Trim());
[...]
C:\{path}\CC3.cs(33,13): warning : CodeContracts: Possibly calling a method on a null reference 'this.Property'
[...] 
```

我正在使用带有 .NET 4 的 Visual Studio 2010 Ultimate 作为目标框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:24:14.443

不是一个完整的答案，而是对这个问题的一些想法。这不是混淆代码契约的接口契约。我已经设法用没有`ContractClass`接口的简单示例重现了这一点。只需将第二个示例更改为简单

```
//Foo's declaration

public interface IFoo
{
    string Property { get; }
} 
```

你会得到同样的错误。即使添加`Contract.Assume(_field != null);`属性字段也不能修复它（它将修复它添加`Assume`到`SetField`方法中）。我也没有设法用不变量来抑制空引用异常警告。唯一有效的是一个非常丑陋的解决方案，您必须为接口合同提供后置条件，并`assume`在属性字段中为代码合同提供提示。完整代码如下所示

```
public class Foo  : IFoo
{
    private string _field;

    public string Property
    {
        get
        {
            Contract.Assume(_field != null);
            return _field;
        }
    }

    private void SetField()
    {
        _field = " foo ";

    }

    private string Method()
    {
        SetField();
        return Property.Trim();
    }
} 
```

* * *

```
[ContractClass(typeof(IFooContract))]
public interface IFoo
{
    string Property { get; }
}

[ContractClassFor(typeof(IFoo))]
public abstract class IFooContract : IFoo
{
    public string Property
    {
        get
        {
            Contract.Ensures(Contract.Result<string>() != null);
            throw new NotImplementedException();
        }
    }
} 
```

编辑：因为`_field`可以为空，我建议使用此方法体向分析器提供提示，这样它就不会受到空引用警告的困扰。

```
private string Method()
{
    SetField();
    Contract.Assume(Property != null);
    return Property.Trim();
} 
```

ps 正如 John Sonmez 在[有关代码合同的复数视力培训中](http://pluralsight.com/training/courses/TableOfContents?courseName=code-contracts&highlight=john-sonmez_code-contracts-m1-overview%2a1,2,3!john-sonmez_code-contracts-m2-basic!john-sonmez_code-contracts-m3-digging!john-sonmez_code-contracts-m4-advanced#code-contracts-m1-overview)所说的那样， “静态分析是一项复杂而神秘的任务，如果没有提示分析器起诉 Assume 方法调用，几乎无法解决它”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T12:23:19.393

如果问题仅在类内的代码中表现出来——就像我的例子中的情况一样——实用的解决方案很简单：

使用支持字段而不是属性：

```
public class Foo : IFoo
{
    private string _field;

    public string Property
    {
        get { return _field; }
    }

    private void SetField()
    {
        _field = " foo ";
    }

    private string Method()
    {
        SetField();
        return _field.Trim();
    }
} 
```

# java - udp 文件传输项目 - 是否需要错误检查？

> ID：14962342
> 
> 赞同：5
> 
> 时间：2013-02-19T16:24:05.913
> 
> 标签：java, file, udp, protocols, transfer

我被赋予了使用 UDP 传输文件的经典任务。在不同的资源上，我已经阅读过检查数据包上的错误（将 CRC 与数据一起添加到数据包）是必要的，并且 UDP 已经检查损坏的数据包并丢弃它们，所以我只需要担心重新发送丢弃的数据包。

其中哪一项是正确的？我是否需要手动对到达的数据包执行完整性检查，或者不正确的数据包已经被丢弃？

顺便说一下，该项目的语言是 Java。

编辑：一些消息来源（课程书籍、互联网）说校验和仅涵盖标题，因此确保发送者和接收者 IP 是正确的等。一些消息来源说校验和*也*涵盖数据段。一些消息来源说校验和*可能*涵盖数据段，但它是可选的，由操作系统决定。

编辑2：问我的教授，他们说数据段的UDP错误检查在IPv4中是可选的，在IPv6中是默认的。但我仍然不知道它是否在程序员的控制，或操作系统，或另一层......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T18:13:32.323

第一个事实：

UDP 有一个 16 位校验和字段，从数据包头的第 40 位开始。这有（至少）两个弱点：

*   校验和不是强制性的，所有设置为 0 的位都定义为“无校验和”
*   它是严格意义上的 16 位校验**和**，因此容易受到未检测到的损坏。

这意味着，UDP 的内置校验和可能足够可靠，也可能不够可靠，具体取决于您的环境。

第二个事实：

比传输过程中的数据损坏更现实的威胁是丢包重新排序：USP 不保证

*   所有到（最终）的数据包都到达
*   数据包以与发送相同的顺序到达

事实上，UDP 根本没有内置机制来处理大于单个数据包的有效负载，这是因为它不是为此而构建的。

结论：

在没有额外措施的情况下在接收到的数据包后附加数据包必然会产生与发送流不同的接收流，但在最有利的环境中除外。这使得它不是直接文件传输的最佳协议。

如果您**确实**想要或必须使用 UDP 来传输文件，您需要构建这些部分，它们是 TCP 不可或缺的部分，而不是 UDP 到应用程序中的一部分。不过有一种说法，这很可能会导致 TCP 的重新实现效果不佳。

成功的实现包括许多对等文件共享协议，其中保护连接中断和数据包丢失或重新排序无论如何都需要成为应用程序功能的一部分，以击败或减轻过滤器。

实施建议：

对我们有用的是分块窗口实现：有效负载被分成固定且方便长度的块，（我们使用 1023 字节）在发送端和接收端保存 N 个这样的块的状态数组。

在发送方：

*   发起一个 UDP 消息，其中包含这样的块、其在流中的序列号（不止一次）以及校验和或哈希。
*   状态数组将此块标记为“已发送/待处理”并带有时间戳
*   发送停止，如果完整的状态数组（发送窗口）被消耗

在接收方：

*   接收到的数据包根据它们的校验和进行检查，
*   如果序列号的所有副本都同意，则损坏的数据包被否定确认，否则丢弃
*   OK 数据包在状态数组中标记为“已接收/待处理”并带有时间戳
*   如果已接收到足够的块来填充 ack 数据包，或者最旧的“接收/待处理”的时间戳变得太旧（从几毫秒到大约 100 毫秒），则确认通过发送一个 ack 数据包来工作。
*   Ack 数据包需要校验和，但不需要排序。
*   已发送 ack 的块在状态数组中被标记为“ack/pending”并带有时间戳

在发送方：

*   接收并检查确认数据包，丢弃损坏的数据包
*   收到 ack 的块在状态数组中被标记为“ack/done”
*   如果状态数组中的第一个块被标记为“确认/完成”，则状态数组向上滑动，直到它的第一个块再次没有完成。
*   这可能会释放一个或多个要发送的未发送块。
*   对于处于“已发送/待处理”状态的块，时间戳超时会触发该块的新发送，因为原始块可能已丢失。

在接收方：

*   接收块 i+N（N 是窗口宽度）将块 i 标记为 ack/done，向上滑动接收窗口。如果不是所有滑出接收窗口的块都被标记为“ack/pending”，这构成了一个不可恢复的错误。
*   对于状态为“ack/pending”的块，时间戳超时会触发该块的新 ack，因为原始 ack 消息可能已丢失。

显然，发送端需要一个特殊的消息类型，如果发送窗口滑出文件的末尾，来表示接收到一个 ack 而不发送块 N+i，我们通过简单地发送 N 个多于的块来实现它存在，但没有有效载荷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T17:45:31.940

您可以确定您收到的数据包与发送的数据包相同（即，如果您发送数据包 A 和接收数据包 A，您可以确定它们是相同的）。对数据包的传输层 CRC 检查确保了这一点。但是，由于 UDP 不能保证交付，您需要确保收到所有发送的内容，并且需要确保正确订购。

换句话说，如果数据包 A、B 和 C 以该顺序发送，您实际上可能只收到 A 和 B（或没有）。你可能会让它们乱序，C、B、A。所以你的检查需要照顾 TCP 提供的保证交付方面（验证排序，确保所有数据都在那里，并通知服务器重新发送你没有的任何东西' t 接收）*到您需要的任何程度*。

首选 UDP 而不是 TCP 的原因是，对于某些应用程序而言，数据排序和数据完整性都不重要。例如，当流式传输 AAC 音频数据包时，单个音频帧非常小，以至于可以安全地丢弃其中的一小部分或乱序播放，而不会在很大程度上破坏聆听体验。如果 99.9% 的数据包被正确接收和排序，你可以很好地播放流并且没有人会注意到。这适用于某些蜂窝/移动应用程序，您甚至不必担心重新发送丢失的帧（请注意，在某些情况下，Shoutcast 和其他一些服务器确实使用 TCP 进行流传输 [以促进带内元数据]，但它们不不必）。

如果您需要确保所有数据都在那里并且正确排序，那么您应该使用 TCP，它将负责验证数据是否都在那里，正确排序，并在必要时重新发送。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T18:21:24.990

UDP 协议使用与 TCP 协议相同的策略来检查带有错误的数据包 - 数据包标头中的 16 位校验和。

UDP 数据包结构是众所周知的（以及 TCP），因此如果不加密，数据包很容易被篡改，添加另一个校验和（例如 CRC-32）也会使其更加健壮。如果目的是加密数据（手动或通过 SSL 通道），我不会费心添加另一个校验和。

还请考虑一个数据包可以发送两次。确保你相应地处理。

You can check both packet structure on Wikipedia, both have checksums:

*   [Transmission Control Protocol](http://en.wikipedia.org/wiki/User_Datagram_Protocol)
*   [User Datagram Protocol](http://en.wikipedia.org/wiki/User_Datagram_Protocol)

You can check the TCP packet structure with more detail to get tips on how to deal with dropped packets. TCP protocol uses a "Sequence Number" and "Acknowledgment Number" for that purpose.

I hope this helps, and good luck.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T17:34:39.920

UDP 将丢弃不符合内部每个数据包校验和的数据包；CRC 检查有助于在应用层确定，一旦有效负载看起来完整，接收的内容是否实际完整（没有丢弃的数据包）并且与发送的内容匹配（没有中间人或其他攻击） .

# javascript - (JavaScript) 随机文本输出 - 建议？

> ID：14962344
> 
> 赞同：1
> 
> 时间：2013-02-19T16:24:08.047
> 
> 标签：javascript, random

所以我所拥有的是[http://garrettstelly.com](http://garrettstelly.com)，它在启动时会吐出二十个术语之一。代码很重，我很好。

我打算做一个网站来随机吐出一个名字，问题是我可以有无穷无尽的名字。对于我目前使用的 js，我使用随机滚动甚至 0 到 1 之间的部分来读取名称。这样做的问题是我不能只添加一个短语，我必须一次添加一个块才能使概率相等。

> 如何制作一个脚本，一次添加一个无限可能？

这是 garrettstelly.com 的 javascript：

```
var roll = Math.random()
if (roll<0.05)
{document.write('<a href="http://www.facebook.com/abroheem.vonclinxenburg">Bro-Heem</a>');}
else if (roll<0.10)
{document.write('I am too white for my own good');}
else if (roll<0.15)
{document.write('I love the way you paste those stickers.');}
else if (roll<0.20)
{document.write('You probably were not just thinking about Wichita');}
else if (roll<0.25)
{document.write('Yummy, Adhesive!');}
else if (roll<0.30)
{document.write('<a href="http://www.rolex.com/">Rolex</a>');}
else if (roll<0.35)
{document.write('There is a 5% chance that you will see this when you first visit this website.');}
else if (roll<0.40)
{document.write('Making Money.<br>Choppas How We Do Today.');}
else if (roll<0.45)
{document.write('45, get your bills roll em high.');}
else if (roll<0.50)
{document.write('I WILL teach you how to fish');}
else if (roll<0.55)
{document.write('I am a gangsta.');}
else if (roll<0.60)
{document.write('Please get out of my website');}
else if (roll<0.65)
{document.write('<a href="http://www.facebook.com/luke.immel?fref=ts">derriere</a>');}
else if (roll<0.70)
{document.write('I think YOU are a Q T PIE');}
else if (roll<0.75)
{document.write('X=Fries');}
else if (roll<0.80)
{document.write("Idle hands are the Devil's playground.<br>The Devil is smaller than hands.");}
else if (roll<0.85)
{document.write('I am about to be late for class');}
else if (roll<0.90)
{document.write('"Hipster"');}
else if (roll<0.95)
{document.write('I am late for class');}
else
{document.write('Please refrain from drinking the water located within the wishing well, thank you.');} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:31:55.107

将可能性存储在数组中并获取数组的随机元素：

[演示](http://jsfiddle.net/KMGQW/1/)

```
function getRandomName()
{
    var names = [
        'John',
        'Sue',
        'Bob',
        'Sandeep'
    ];

    return names[Math.floor(Math.random() * names.length)];
}

document.write( getRandomName() ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:31:39.027

您应该将所有想要吐出的东西放入一个数组中。例如：

```
var arr = [
    '<a href="http://www.facebook.com/abroheem.vonclinxenburg">Bro-Heem</a>',
    'I am too white for my own good',
    // other entries...
    'Please refrain from drinking the water located within the wishing well, thank you.'
]; 
```

然后你的滚动应该仍然`Math.random()`乘以数组的长度：

```
var roll = (Math.floor(Math.random()) * arr.length); 
```

然后使用适当的数组索引编写结果，在您的情况下使用`document.write`（尽管可能有更好的方法）：

```
document.write(arr[roll]); 
```

现在，您可以随意添加到阵列中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:31:28.447

我会使用一个数组：

```
var outputTextArr = ['text 1', 'text 2', 'text 3', 'text 4', 'more text', 'some text']; 
```

然后随机定位数组中的项目：

```
function randomRange(from, to){
    return Math.floor(Math.random() * (to - from + 1) + from);
}

var outputText = outputTextArr[randomRange(0, outputTextArr.length - 1)];//var output text will have a random item 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:32:08.947

像这样的东西应该工作

```
var sentences = 
[
    "I am too white for my own good",
    "I love the way you paste those stickers.",
    "You probably were not just thinking about Wichita"
    // Add more sentences if you want to
];

var index = Math.floor(Math.random() * sentences.length);
alert(sentences[index]); // This will be your random value 
```

[CodePen 示例](http://codepen.io/anon/pen/fGCci)。

# html - 使页面卷曲透明图像与纯色背景颜色一起使用

> ID：14962345
> 
> 赞同：3
> 
> 时间：2013-02-19T16:24:08.857
> 
> 标签：html, background-image, css

我有一个带有透明区域的小 png，我想充当纯色 div 的右下角，但我似乎无法用 css 想出一种优雅的方式来做到这一点。

**我当前的CSS：**

```
div.example {
  border-radius: 9px;
  background-color: #fff;
  background-image: url(bottom-right-corner-peel.png);
  background-repeat: no-repeat;
  background-position: right bottom;
} 
```

上面代码的问题是div( `#fff`)的背景色透过png的透明部分显示出来，破坏了效果。我可以想到一些非常老套的方法来解决这个问题（例如 - 创建另一个 div （或使用`::after`）将一个元素放在有问题的 div 下面，并使用一些技巧来完成这项工作，但必须有更好的方法，对?

* * *

**查看 [修订] 演示：**

> [http://jsbin.com/abacey/8/](http://jsbin.com/abacey/8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:26:37.917

我的想法是使用 png 来覆盖 div 的整个角落。让我们假设你的 png 是 40x40px，左上部分是白色的，而下部分是透明的。您可以使用

```
border-bottom-right-radius: 40px; 
```

“切断” div 的一角。因此，您可以看到背景图像。现在，您将 png 放在它上面以掩盖丑陋的圆角。

[http://jsfiddle.net/Xd8CD/](http://jsfiddle.net/Xd8CD/) （需要更好的 png...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:59:58.937

这是您的问题的解决方案：http: [//jsfiddle.net/promatik/uZFpZ/](http://jsfiddle.net/promatik/uZFpZ/)

我在`#content-bottom`旁边添加了一个`#content`：

```
<div id="content">
    <h1>Corner Peel Demo</h1>
</div>
<div id="content-bottom">
    <div id="content-space"></div>
    <div id="content-corner"></div>
</div> 
```

并在 CSS 中添加：

```
div#content{
    ...
    border-bottom-right-radius: 0px;
    border-bottom-left-radius: 0px;
}
div#content-bottom {
    height: 30px;
    position: relative;
}
div#content-space {
    height: 27px;
    border-bottom-left-radius: 9px;
    background-color: #fff;
    margin-right: 42px;
}

div#content-corner {
    position: absolute;
    top: 0px;
    right: 0px;
    height: 27px;
    width: 42px;
    background-color: transparent;
    background-image: url(data:image/png;base64,...');
} 
```

# c# - 在运行时更改数据集连接字符串 vs2010

> ID：14962346
> 
> 赞同：2
> 
> 时间：2013-02-19T16:24:09.507
> 
> 标签：c#, sql, dataset

我找到了一个解决方案，该解决方案必须适用于 vs2010 的旧版本。我想知道如何为vs2010做到这一点？有人知道吗？

[http://www.csharpbydesign.com/2008/01/overriding-dataset-settings-co.html](http://www.csharpbydesign.com/2008/01/overriding-dataset-settings-co.html)

让我更详细地解释一下。

我有 ac# 生成的数据集。如何更改连接字符串，以便可以将数据集与另一个（结构相同但填充不同）数据库一起使用？这必须在运行时发生，因为我在编译时不知道服务器或数据库名称。我正在使用 vs2010 和 SQL Server 2008 R2 Express

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T16:42:21.757

我认为没有简单的方法，您不能以编程方式更改整个连接字符串，`DataSet`因为它是为每个`TableAdapter`.

您需要使用/创建的部分类`TableAdapter`来更改连接字符串，因为`Connection`属性是`internal`（如果您的 DAL 在不同的程序集中）。不要更改designer.cs 文件，因为它会在设计器的下一次更改后自动重新创建。要创建它，只需右键单击 DataSet 并选择“显示代码”。

例如（假设`TableAdapter`被命名`ProductTableAdapter`）：

```
namespace WindowsFormsApplication1.DataSet1TableAdapters
{
    public partial class ProductTableAdapter 
    {
        public string ConnectionString {
            get { return Connection.ConnectionString; }
            set { Connection.ConnectionString = value; }
        }
    }
} 
```

现在您可以轻松更改它：

```
var productTableAdapter = new DataSet1TableAdapters.ProductTableAdapter();
productTableAdapter.ConnectionString = someOtherConnectionString; 
```

这是我的示例数据集和创建的文件的屏幕截图`DataSet1.cs`：

![在此处输入图像描述](../Images/c89752bf2f13e3103a09856b95ee9c33.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-27T19:24:54.497

实际上有一种更简单的方法来更改连接字符串。转到设置屏幕，其中连接字符串显示为连接字符串。首先标记并复制显示的连接字符串。然后将类型从连接字符串更改为字符串。字符串的文本将更改为包含 xml。然后将复制的连接字符串粘贴到 xml 文本上。然后将范围从应用程序更改为用户。

当我想更改连接字符串时，我使用以下代码。

```
// assign the path to use to the variable fullpath (or whatever)
string newConnection = String.Format("Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0}", fullpath);            
Properties.Settings.Default.HootConnectionString = newConnection;
Properties.Settings.Default.Save(); 
```

就我而言，我有一个全局数据集处于活动状态，因此我必须让 tableadapter 重新读取数据。而且，当然，您必须添加错误控制以确保数据库仍然存在。

您会注意到这不会更改应用程序设置中显示的内容。这些是默认值。

这适用于 Access 数据库；所以您的里程和要求可能会有所不同。

编辑：警告。安装后，连接字符串可以很好地打开和读取数据库内容，但它抱怨在尝试更新数据库时没有连接字符串。

# c++ - 添加两个有符号或无符号整数

> ID：14962349
> 
> 赞同：9
> 
> 时间：2013-02-19T16:24:16.807
> 
> 标签：c++, c, integer, twos-complement

自从我上次在位和字节级别编程以来已经有很长时间了，我想确认一下我似乎记得的那些日子：

假设我有两个长度相等的整数（1、2、4、8 字节；没关系），我将它们相加：如果它们是有符号或无符号的，求和的逐位结果是否不同。换句话说：无论它们是有符号整数还是无符号整数，这些位最终会相同吗？

我的直觉和脆弱的记忆告诉我他们会的，但我只是想确认一下。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T16:28:01.760

假设实现使用 2 的补码作为有符号整数的表示，那么结果将是相同的。在其他表示中，他们不会。

**编辑**

正如评论中所指出的，有符号加法中的溢出是未定义的行为，这意味着在这种情况下对结果无话可说。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T16:53:09.023

我知道这已经得到解答，但是我曾经使用过的所有处理器（大约有十几种不同的架构——我的意思是架构，而不是不同的风格）只有一种类型的 ADD 指令——它可能有不同的大小选项，但是这是一条指令。这同样适用于减法。它在乘法和除法上有所不同，它通常具有有符号和无符号的变体——或者需要以某种方式对输入进行“符号调整”。

区分有符号和无符号的唯一其他指令是条件指令，例如“小于分支”将具有“无符号小于”的一种变体和“有符号小于”的一种变体（其中一个通常称为“小于”以外的其他内容，例如“低于”或“进位设置”等）。

# extjs4.1 - ExtJS 使用 C#.net 与 SQL Server 连接

> ID：14962351
> 
> 赞同：-4
> 
> 时间：2013-02-19T16:24:20.617
> 
> 标签：extjs4.1

我已经使用 ExtJS 4.1.1 创建了一个表单和网格，用于在 Visual Studio 2010 的 MVC 模式中插入、更新、删除。我想用 SQL Server 执行这些 CRUD 任务（我已经创建了过程）但我不知道如何我可以在 SQL Server 和 C# 中使用 ExtJS。即使在 Sencha 网站上也只有 PHP 和 MySQL 的教程。

因此，我希望将 ExtJS 与 SQL 连接起来。我需要一步一步的教程和指导，我可以完成我的官方项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:26:57.230

Ext JS 是一个与服务器无关的 UI 框架……因此，虽然您看到的一些示例是在 PHP 和 MySQL 中使用的，但它最终不会影响 JavaScript 代码。例如，REST 代理：

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.proxy.Rest](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.proxy.Rest)

这个代理（就像 Ext JS 中的所有代理一样）连接到远程数据服务。该服务发送/接收 XML、JSON 或其他一些数据格式。

一旦接收到数据，远程数据服务（用 .NET、PHP、Java 或其他任何东西编写）对数据的处理与 Ext JS 无关。

在我看来，您需要一个用 C# 编写 Web 服务的教程。

# c# - C#中的通用列表类

> ID：14962358
> 
> 赞同：5
> 
> 时间：2013-02-19T16:24:30.867
> 
> 标签：c#, generics, generic-list

我目前正在制作自己的非常基本的*通用列表类*（以便更好地了解预定义的列表类是如何工作的）。我唯一的问题是我无法像您通常使用“ `System.Collections.Generic.List`”所说的那样到达数组内的元素。

```
GenericList<type> list = new GenericList<type>();
list.Add(whatever); 
```

这很好用，但是当尝试访问我希望能够编写的“任何内容”时**：**

```
list[0]; 
```

但这显然是行不通的，因为我显然在代码中遗漏了一些东西，我需要将什么添加到我原本完全正常工作的泛型类中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T16:25:49.467

它被称为[indexer](http://msdn.microsoft.com/en-us/library/vstudio/6x16t2tx.aspx)，写法如下：

```
public T this[int i]
{
    get
    {
        return array[i];
    }
    set
    {
        array[i] = value;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T17:04:04.473

我认为您需要做的就是实现`IList<T>`，以获得所有基本功能

```
 public interface IList<T>  
  {

    int IndexOf(T item);

    void Insert(int index, T item);

    void RemoveAt(int index);

    T this[int index] { get; set; }
  } 
```

# php - 如何使用 file_get_contents 或 file_get_html？

> ID：14962359
> 
> 赞同：13
> 
> 时间：2013-02-19T16:24:37.140
> 
> 标签：php, file-get-contents, simple-html-dom

我已经阅读了很多关于这里的问题，我不确定我是否应该使用`file_get_contents`或`file_get_html`为此。

我要做的就是使用 PHP 在我的网站上显示此页面上的两个表：http: [//www.statmyweb.com/recently-analyzed/](http://www.statmyweb.com/recently-analyzed/)

我当然知道如何获取他们的完整页面并将其显示在我的网站上，但我无法弄清楚我如何能够在不获取页眉/页脚的情况下仅拉出这两个表。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-20T01:24:20.193

您想要`file_get_html`因为`file_get_contents`会将响应正文加载到字符串中，但`file_get_html`会将其加载到 simple-html-dom 中。

```
$dom = file_get_html($url);
$tables = $dom->find('table');
echo $tables[0];
echo $tables[1]; 
```

或者，您可以`file_get_contents`使用`str_get_html`：

```
$dom = str_get_html(file_get_contents($url)); 
```

但那将是愚蠢的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T16:27:52.270

您不能指定 in`file_get_contents()`只是为了检索表。

您必须获得`file_get_contents()`使用的返回值：

```
$result = file_get_contents("urlHere"); 
```

然后分析`$result`变量并提取你需要输出的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:34:10.613

获取完整的网站内容`file_get_contents()`，然后将 preg_match 应用于您使用`<table>`and获得的内容`</table>`。这将为您带来表格标签下的所有内容。在您的网页中显示它时，只需在末尾添加 a `<table>`then echo 您匹配的内容和 a 。`</table>`

# ruby-on-rails-3 - 在 Rails 应用程序中查找“孤儿”路线等？

> ID：14962360
> 
> 赞同：1
> 
> 时间：2013-02-19T16:24:41.153
> 
> 标签：ruby-on-rails-3

我们正处于开发阶段，我们的 Rails 馅饼中有许多不同的手指，并且我们*知道*目前存在的东西没有被使用等等。我正在寻找的是某种以编程方式确定是否控制器中有任何孤儿路由，可能会获取 rails 路由的输出并查看代码中是否有任何无关的东西。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:40:01.847

听起来您要寻找的东西被称为代码指标，特别是我能想到的一种解决方案涵盖了您的需求。它被称为[rails_best_practices](https://github.com/railsbp/rails_best_practices) gem，它检查的许多事情之一是未使用的控制器操作。此外，它会通知您自动生成的路线（例如，索引、显示、编辑、更新等）在并非全部使用时需要限制。

例如，以下行将为您的`Foo`控制器创建七个 RESTful 路由，无论它们是否实际实现过：

```
resources :foo 
```

但是，如果您的控制器仅使用 index、show、new、create 操作，它会告诉您将`:only`指令添加到这些操作的路由映射中。

可能有一些其他选项更符合您的需要，我建议您查看 Ruby 工具箱的代码指标类别并查看其中的内容。这是链接：[https ://www.ruby-toolbox.com/categories/code_metrics](https://www.ruby-toolbox.com/categories/code_metrics)

# c++ - VARIANT 在 COM 接口中的专有使用

> ID：14962362
> 
> 赞同：-1
> 
> 时间：2013-02-19T16:24:50.917
> 
> 标签：c++, windows, com, idl

我继承了一个包含 COM DLL 的项目。我对 COM 有点陌生，但似乎有些不对劲。IDL 中定义的接口仅使用`VARIANT`所有属性和方法返回/参数的类型。这有什么可能的理由吗？我有一种感觉，以前的开发人员只是在做一些事情，但我想确定一下。

这是我的 IDL 的样子：

```
interface IMyComInterface : IDispatch
{
    [id(1), helpstring("method CheckMessage")] HRESULT CheckMessage([in] VARIANT vMsg);
    [id(2), helpstring("method CheckFolder")] HRESULT CheckFolder([in] VARIANT Folder, [out] VARIANT *pCount, [out, retval] VARIANT *pErrorCount);
    [propget, id(3), helpstring("property Flags")] HRESULT Flags([out, retval] VARIANT *pVal);
    [propput, id(3), helpstring("property Flags")] HRESULT Flags([in] VARIANT newVal);
    [propget, id(4), helpstring("property MessageStore")] HRESULT MessageStore([out, retval] VARIANT *pVal);
    [propput, id(4), helpstring("property MessageStore")] HRESULT MessageStore([in] VARIANT newVal);
    [propget, id(5), helpstring("property Directory")] HRESULT Directory([out, retval] VARIANT *pVal);
    [propput, id(5), helpstring("property Directory")] HRESULT Directory([in] VARIANT newVal);
    [propget, id(6), helpstring("property MessageCount")] HRESULT MessageCount([out, retval] VARIANT *pVal);
}; 
```

非常感谢。

编辑：

为了清楚起见，所有这些`VARIANT`s 都可以用显式类型代替。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:45:28.453

您的接口派生自`IDispatch`which 意味着它是一个双重接口 - 您可以直接从接口调用方法，也可以通过[`iDispatch::Invoke`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221479%28v=vs.85%29.aspx). 传递给的参数`Invoke`必须都是类型`VARIANTARG`，这只是 的另一个名称`VARIANT`，请参阅[http://msdn.microsoft.com/en-us/library/ms891678.aspx](http://msdn.microsoft.com/en-us/library/ms891678.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:01:20.683

如果您需要性能或简化，您可以更改 VARIANT 类型以获得适当的值，更接近使用的类型。请记住，这是一个界面中断。
查看要使用的有效值：
[COM 数据类型](http://msdn.microsoft.com/en-us/library/sak564ww.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:50:02.760

对于假设使用`VB`脚本语言的某些类型的双接口，最好使用`VARIANT`该直接类型。例如，最好使用`VARIANT`几乎所有类型的`SAFEARRAY`和接口指针。但是您可以测试并查看。

# c# - 如何将情节提要用于 1 个以上的目标对象？

> ID：14962365
> 
> 赞同：3
> 
> 时间：2013-02-19T16:25:00.090
> 
> 标签：c#, wpf, storyboard

我有 ac# 类，我们称之为`TwoButtonsHolder`. 在这堂课中，我有 2 个`UIElements`我想使用 StoryBoards 制作动画。让我们称它们为`ButtonA`and `ButtonB`。因为我想让他们两个同时制作动画，所以我决定将他们所有的动画放在一个 Storyboard 对象中（或者有更好的方法吗？）。所以现在我正试图在后面的代码中创建故事板对象，但我被困在我必须定义目标属性的部分。通常，当我声明动画时，我使用这样的代码来设置属性

```
Storyboard.SetTargetProperty(myDoubleAnimation,
                             new PropertyPath(UIElement.OpacityProperty)); 
```

现在我在 TwoButtonsHolder 类型的目标对象中有 UIElement。如何创建故事板并将动画目标属性设置为`TwoButtonsHolder.ButtonA.UIElement.OpacityProperty`？使用单个故事板为多个对象设置动画以使动画同时运行，这种设计是否糟糕？（仅供参考，我想在后面的代码中尝试这个，还不想进入 XAML，因为我发现它太复杂且难以学习恕我直言）。谢谢

编辑：只是想补充一点，这两个按钮有不同的动画，我把它们放在同一个故事板中的唯一原因是让它们同时开始动画

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T16:50:53.420

在一个 Storyboard 中包含多个对象的动画绝对不是糟糕的设计。

你会这样写：

```
var animationA = new DoubleAnimation(...);
Storyboard.SetTarget(animationA, ButtonA);
Storyboard.SetTargetProperty(animationA, new PropertyPath(UIElement.OpacityProperty));

var animationB = new DoubleAnimation(...);
Storyboard.SetTarget(animationB, ButtonB);
Storyboard.SetTargetProperty(animationB, new PropertyPath(UIElement.OpacityProperty));

var storyboard = new Storyboard();
storyboard.Children.Add(animationA);
storyboard.Children.Add(animationB);
storyboard.Begin(); 
```

# shell - users 命令并查找当前活动用户并非所有登录用户

> ID：14962373
> 
> 赞同：0
> 
> 时间：2013-02-19T16:25:19.380
> 
> 标签：shell, command

我知道“用户”命令将按字母顺序列出所有登录用户。如何获取当前活动用户的名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:13:55.893

几种方式。`id`命令、和`USER`变量`LOGNAME`。变量不安全，可以更改。在 Bash 中，您可以使用它`UID`来获取用户 ID，这是只读的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:35:08.057

我相信有两种方法可以做到这一点。

```
gawk -F: '{ print $1 }' /etc/passwd 
```

或者

```
who 
```

# vim - 如何为文本文件创建语法文件？

> ID：14962375
> 
> 赞同：0
> 
> 时间：2013-02-19T16:25:24.283
> 
> 标签：vim, text, formatting

我希望我可以在标准文本文件中格式化文本。
我想选择一个短语或一个单词，调用一个简单的命令，并使用以下格式对其进行格式化：

*   大胆的
*   斜体
*   强调
*   红色字体颜色
*   黄色背景色

那可能吗？（类似于 vim 文件中的语法突出显示，但在我的情况下是选定的文本）

我知道 vim 中有一个 Txtfmt 插件，去年我尝试了 2 次，但每次都卸载它。
这就是为什么：

1.  无法直观地选择文本并对其进行格式化，您必须在命令行中插入开始代码写入文本并在命令行中插入结束代码。
2.  您无法复制文本，因为 Txtfmt 插件会在文本中插入隐藏的格式代码
3.  在命令行中插入开始代码和结束代码太复杂（调用通用命令后），代码太复杂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:07:51.757

这可能是我认为您想要的最简单的实现。它允许使用您描述的颜色/样式在当前缓冲区中突出显示自定义字符串。您选择突出显示的自定义字符串无法在 Vim 会话之间保存。

首先，`SpecialTxt`为您的定制突出显示定义突出显示组：

```
au ColorScheme * hi SpecialTxt guibg=yellow guifg=red gui=bold,underline,italic 
```

（请注意，这必须通过 autocmd 完成，以便加载新的配色方案不会覆盖它）。

现在您可以使用以下命令选择任何正则表达式来继承此颜色：

```
call matchadd( 'SpecialTxt', [YOUR_REGEX], 1 ) 
```

或者你可以编写一个简单的命令来设置匹配：

```
command! -nargs=1 Special :call matchadd('SpecialTxt',"<args>",1) 
```

或者创建一个地图，以便双击一个单词将其设置为这种颜色：

```
nnoremap <silent> <2-LeftMouse> :call matchadd('SpecialTxt',expand('<cword>'),1)<CR> 
```

希望有帮助。道歉，如果它不是你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:57:31.183

需要在文本中插入一种标记。Vim 在纯文本上运行，它没有像文字处理器那样单独的元数据层。通过语法高亮和新的*隐藏*功能，您可以部分地使 Vim 看起来是所见即所得的，但实际上您仍在对原始文本进行操作。

如果您对这个限制没有问题，并且想坚持使用 Vim 来完成您的编辑任务，我建议您使用现有的标记解决方案，而不是从头开始发明一个新的标记解决方案。到目前为止，有多种语法可供选择，其中*Markdown*可能是最受欢迎的。（在 Stack Overflow 上也使用了它！）使用现有语法，您可以利用所有现有的插件/映射/命令，甚至一些外部工具（例如，用于转换为 HTML）。

# php - 从此对象/数组中提取数据？怎么做

> ID：14962379
> 
> 赞同：1
> 
> 时间：2013-02-19T16:25:29.567
> 
> 标签：php, arrays, object

这是 $wp_scripts 的打印片段

```
WP_Scripts Object
(

[base_url] => http://*****
[content_url] => http://*****
[default_version] => 3.5.1
[in_footer] => Array
    (
    )

[concat] => 
[concat_version] => 
[do_concat] => 
[print_html] => 
[print_code] => 
[ext_handles] => 
[ext_version] => 
[default_dirs] => Array
    (
        [0] => /wp-admin/js/
        [1] => /wp-includes/js/
    )

[registered] => Array
    (
        [utils] => _WP_Dependency Object
            (
                [handle] => utils
                [src] => /wp-includes/js/utils.min.js
                [deps] => Array
                    (
                    ) 
```

我将如何提取一些数据，例如“/wp-includes/js/utils.min.js”？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:26:44.670

```
$wp_scripts->registered['utils']->src 
```

通过访问对象属性`->`

通过访问数组元素`[/* String or integer here*/]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:28:28.160

```
$object = new WP_Scripts;
$src = $object->registered['utils']->src; 
```

# matlab - matlab：将一串十六进制值转换为十进制值？

> ID：14962380
> 
> 赞同：1
> 
> 时间：2013-02-19T16:25:31.633
> 
> 标签：matlab

我编写了将 100,000 个十六进制字符串转换为值的函数，但在整个数组上执行需要 10 秒。Matlab 是否具有执行此操作的功能，以便它更快，...即：数组少于 1 秒？

* * *

```
function x = hexstring2dec(s)
[m n] = size(s);

x = zeros(1, m);
for i = 1 : m
    for j = n : -1 : 1
       x(i) = x(i) + hexchar2dec(s(i, j)) * 16 ^ (n - j);
    end
end 
```

* * *

```
function x =  hexchar2dec(c)

if c >= 48 && c <= 57
    x = c - 48;
elseif c >= 65 && c <= 70
    x = c - 55;
elseif c >= 97 && c <= 102
    x = c - 87;
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T16:30:42.673

尝试使用[hex2dec](http://www.mathworks.com/help/matlab/ref/hex2dec.html)。它应该比循环遍历每个字符要快得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T16:37:58.537

[shoelzer 的](https://stackoverflow.com/a/14962512/1714410)回答显然是最好的。
但是，如果您想自己进行转换，那么您可能会发现这很有用：

假设`s`是一个 char 矩阵：所有十六进制数字的长度相同（必要时填充零）并且每一行都有一个数字。然后

```
ds = double( upper(s) ); % convert to double
sel = ds >= double('A'); % select A-F
ds( sel ) = ds( sel ) - double('A') + 10; % convert to 10 - 15
ds(~sel)  = ds(~sel) - double('0'); % convert 0-9
% do the sum through vector product
v = 16.^( (size(s,2)-1):-1:0 );
x = s * v(:); 
```

# oracle - 插入sql中的Oracle自己的类型重载构造函数

> ID：14962381
> 
> 赞同：0
> 
> 时间：2013-02-19T16:25:35.667
> 
> 标签：oracle, types, insert, overloading

我创建了一个自己的类型，构造函数重载：

```
CREATE TYPE foo_type AS OBJECT(
       foo_type INTEGER,
       foo_number NUMBER(28, 28),
       foo_varchar2 VARCHAR2(4000 CHAR),

       CONSTRUCTOR FUNCTION foo_type (data NUMBER) RETURN SELF AS RESULT,
       CONSTRUCTOR FUNCTION foo_type (data VARCHAR2) RETURN SELF AS RESULT
)

CREATE TYPE BODY foo_type AS
  CONSTRUCTOR FUNCTION foo_type (data NUMBER) RETURN SELF AS RESULT
  IS
  BEGIN
       foo_type := 1;
       foo_number := data;
       return;
  END;

  CONSTRUCTOR FUNCTION foo (data VARCHAR2) RETURN SELF AS RESULT
  IS
  BEGIN
       foo_type := 2;
       foo_varchar2 := data;
       return;
  END;
END; 
```

虽然只要它有效，我就不会超载：

```
insert into test_table (field) values ( foo_type(1, 2.2, 'bar') ) 
```

但是当我编写构造函数时，它根本不起作用：

```
insert into test_table (field) values ( foo_type(2.2) ) 
```

或者

```
insert into test_table (field) values ( foo_type('bar') ) 
```

此时 oracle 说：“ORA-06553：太多声明 'foo_type' 匹配此调用”，因此：

```
insert into test_table (field) values ( foo_type(foo_varchar2 => 'bar') ) 
```

说：“ORA-009007：缺少右括号”。

我应该改变它的工作原理？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:43:01.617

如果我更正语法错误，以便对象的声明和主体编译

*   您不能拥有与对象类型同名的成员变量
*   对象主体中的第二个构造函数不需要命名`foo_type`——`foo`构造函数总是使用对象的名称。

给我留下类似的东西

```
CREATE TYPE foo_type AS OBJECT(
       foo_int INTEGER,
       foo_number NUMBER(28, 28),
       foo_varchar2 VARCHAR2(4000 CHAR),
       CONSTRUCTOR FUNCTION foo_type (data NUMBER) RETURN SELF AS RESULT,
       CONSTRUCTOR FUNCTION foo_type (data VARCHAR2) RETURN SELF AS RESULT
);
/

 CREATE OR REPLACE TYPE BODY foo_type AS
   CONSTRUCTOR FUNCTION foo_type (data NUMBER) RETURN SELF AS RESULT
   IS
   BEGIN
        foo_int := 1;
        foo_number := data;
        return;
   END;
   CONSTRUCTOR FUNCTION foo_type (data VARCHAR2) RETURN SELF AS RESULT
   IS
   BEGIN
        foo_int := 2;
        foo_varchar2 := data;
        return;
   END;
 END; 
```

如果我更改为传递一个对`NUMBER(28,28)`列有效的数字（2.2 不是），重载就可以了

```
SQL> ed
Wrote file afiedt.buf

  1   declare
  2     l_foo foo_type;
  3   begin
  4     l_foo := foo_type( 0.2 );
  5     dbms_output.put_line( l_foo.foo_int );
  6     l_foo := foo_type( 'bar' );
  7     dbms_output.put_line( l_foo.foo_int );
  8*  end;
SQL> /
1
2

PL/SQL procedure successfully completed. 
```

或插入表格

```
SQL> create table test_table( foo_column foo_type );

Table created.

SQL> insert into test_table values( foo_type( 0.2 ) );

1 row created.

SQL> insert into test_table values( foo_type( 'bar' ) );

1 row created. 
```

在我看来，当您尝试在示例中分配 2.2 的值时，您真的想`foo_number`成为一个特别的人似乎不太可能。`NUMBER(28, 28)`如果您的实际对象类型是这样声明的，那么您的默认构造函数将失败。

# sql-server - 链接ms访问sql server

> ID：14962384
> 
> 赞同：0
> 
> 时间：2013-02-19T16:25:46.987
> 
> 标签：sql-server, ms-access, sql-server-2008-r2

我想通过 SQL Server R2 实例访问我的 MS Access 数据库。

是否可以？如果是，比怎么样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:42:26.123

简短的回答：

开放数据源

[http://msdn.microsoft.com/en-us/library/ms179856.aspx](http://msdn.microsoft.com/en-us/library/ms179856.aspx)

[我这里](http://granadacoder.wordpress.com/2009/12/22/sql-server-data-to-a-jet-database/)有几个例子

恕我直言，我的示例不是“直接命中”，但很有帮助。

来自 MSDN 文章的示例：

```
SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0',
'Data Source=C:\DataFolder\Documents\TestExcel.xls;Extended Properties=EXCEL 5.0')...[Sheet1$] ; 
```

这是一个更长的版本。但是，您需要列出您的 Sql Server 版本（32 或 x64）、您的操作系统。x64 Sql Server 与 Jet 数据库通信时会出现一些问题。

```
/* Setup */

/*
--Run this ONCE  

sp_configure 'show advanced options', 1;
 GO
 RECONFIGURE;
 GO
 sp_configure 'Ad Hoc Distributed Queries', 1;
 GO
 RECONFIGURE;
 GO

EXEC master.dbo.sp_MSset_oledb_prop N'Microsoft.ACE.OLEDB.12.0', N'AllowInProcess', 1
 GO
 EXEC master.dbo.sp_MSset_oledb_prop N'Microsoft.ACE.OLEDB.12.0', N'DynamicParameters', 1
 GO

 RECONFIGURE;
 GO

*/

CREATE VIEW [dbo].[vwJetDatabaseWrapper]

AS

/*
SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0',
'Data Source=C:\work2\DotNet\MultiRDBMSSupport\DataStores\AccessDatabaseCopy\Nwind.mdb;')...[Customers] ;
*/

/* OR  */

SELECT * FROM OPENDATASOURCE('Microsoft.ACE.OLEDB.12.0',
'Data Source=C:\work2\DotNet\MultiRDBMSSupport\DataStores\AccessDatabaseCopy\Nwind.mdb;')...[Customers] ;

GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:43:33.437

您将使用链接服务器。这是我发现的一个链接，其中包含一个几乎与您的问题完全相同的问题，并就如何设置它进行了很好的讨论。

[http://social.msdn.microsoft.com/Forums/en/sqlgetstarted/thread/589ca193-3541-4c5e-965c-4c515d6b476b](http://social.msdn.microsoft.com/Forums/en/sqlgetstarted/thread/589ca193-3541-4c5e-965c-4c515d6b476b)

# bash - Ubuntu Shellscript 路径变量

> ID：14962390
> 
> 赞同：1
> 
> 时间：2013-02-19T16:25:56.457
> 
> 标签：bash, shell, path, cron, crontab

我有以下从我的 crontab 调用的 Shellscript，它可以正常工作，直到它调用涉及 wget 或 find 等 shell 命令的 php 代码。

```
#!/bin/sh
PATH=/opt/server/php/bin:/usr/bin/wget:/bin/egrep:/usr/bin/find
cd /opt/server/apache2/htdocs/webapp/ 
php oil refine job:handler 
```

对于每个命令，我都执行了*which 命令*来查找路径，然后将其添加到路径变量中。然而，它没有找到命令，我收到如下消息：

```
sh: wget: not found
sh: find: not found 
```

我将如何解决这个问题？我知道这是一个常见问题，但我在 stackoverflow 上没有找到很好的解释。另外：我知道从 bash 与 crontab 调用脚本可能会导致不同的环境设置，但无论如何我都会收到这些错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:10:00.173

好先生，这`PATH`是一个描述包含可执行文件的**目录的字符串，而不是可执行文件本身。**

也许使用这样的东西

```
PATH=/opt/server/php/bin:/usr/bin:/bin 
```

# java - 这两个 arrayList 定义有什么不同？

> ID：14962399
> 
> 赞同：-3
> 
> 时间：2013-02-19T16:26:13.013
> 
> 标签：java, arraylist

我使用这两个语句来定义 ArrayList：

```
ArrayList<String> my = new ArrayList<>();
List<String> my2 = new ArrayList<>(); 
```

我应该使用哪一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:28:10.180

使用您的第二个定义，您可以稍后将 ArrayList 构造函数替换为另一种类型的列表，例如 LinkedList 或高性能列表，或将来可能存在的任何其他类型的列表。在您的第一个定义中，您永远与 ArrayList 实现相关联。您无法更改它，因为您的代码的其余部分相信此引用是明确的 ArrayList。

相反，通过使用接口，您的代码依赖于接口的契约，而不是特定实现（如 ArrayList）。这使您能够在不影响其用户的情况下更改实现。改变是我们必须促进和提前计划的事情，仅仅是因为我们无法阻止事情发生变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:27:25.673

后者。对接口进行编程，而不是对实现进行编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:30:42.053

取决于你需要什么。如果可能，通常建议使用接口（因此是列表），否则你会坚持使用实现类。比如说，您使用 ArrayList 作为某些方法的输入参数。出于某种原因（例如性能），您决定在某个时候从 ArrayList 切换到 LinkedList。因此，您还必须更改输入参数的类型。如果您使用接口（List），您可以更自由地切换实现，而无需重构代码。

# php - POST请求中标签被截断后的所有内容

> ID：14962405
> 
> 赞同：0
> 
> 时间：2013-02-19T16:26:31.103
> 
> 标签：php, javascript, html, ajax, post

我有一个网页，其中包含一个在单击时运行脚本的按钮。该脚本应该提交两个文本输入字段的内容，并提交属性设置为`innerHTML`的 a 。问题是，如果有人将文本加粗，然后在输入几个单词后切换到普通字体，则提交的内容包括结束标记**之前的所有内容。**我通过在被调用的脚本中回显来解决这个问题。如何将所有内容传递给脚本？`<div>``contenteditable``true`**`</b>``$_POST`**

 **编辑：我的 HTML 是：

```
<p>Contents:</p><br/>
<div contenteditable="true" style="border-style:solid; border-width:1px; background-color:#FFFFFF" id="contents"><br/></div>
<button onclick="submit_form();">Submit</button> 
```

我的 Javascript 是：

```
function submit_form()
{
    var request = new XMLHttpRequest();
    request.open("POST", "/path/to/script.php", false);
    request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    request.send("file=<?php echo $_GET['file']?>" + "&x=" + document.getElementById("x").value + "&y=" + document.getElementById("y").value + "&contents=" +  document.getElementById("results").innerHTML);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:41:04.830

您可以在提交时简单地调用 javascript 函数来删除标签：

```
function cleanText(str) {
    return String(str).replace(/\<[^\>]*>/g, '');
} 
```

或者如果您也需要传递标签：

```
function htmlEntities(str) {
    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
} 
```**

# ruby-on-rails - 如何使用 Devise 恢复密码（Ruby on Rails）

> ID：14962408
> 
> 赞同：4
> 
> 时间：2013-02-19T16:26:36.640
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我正在尝试使用 devise 恢复用户的密码，但它会生成以下错误

```
undefined method `reset_password_sent_at=' for #<User:0x007fb78cfafb68> 
```

任何人都可以帮我解决这个问题，因为我是 Ruby on Rails 的新手？

使用 Devise 恢复密码并向用户发送电子邮件的最佳方法是什么？非常感谢你...

我正在使用设计（2.2.3）

`User.rb`

```
require 'digest/md5'

class User < ActiveRecord::Base

  # Setup accessible (or protected) attributes for your model
  belongs_to :shop

  before_create :compute_email_md5

  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable,
    :recoverable,
    :rememberable,
    :trackable,
    :validatable,
    :token_authenticatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email,
    :email_md5,
    :password,
    :password_confirmation,
    :shop_id,
    :role,
    :terms,
    :name,
    :notify_on_order_received

  validates :terms, :acceptance => true, :on => :create
end 
```

**解决方案是将 reset_password_sent_at 列添加到用户表**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T17:37:38.630

正如您所发现的，密码恢复要求模型有一个`reset_password_sent_at`列。通过迁移添加它应该可以解决这个问题。

至于发生这种情况的*原因*，我猜您在最初生成启用设计的模型（用户）*后*`:recoverable`添加了密码恢复（模块）。这就是 Devise 的生成器没有为您创建该列的原因。

# macos - NSSpeechRecognizer 委托从未被调用

> ID：14962410
> 
> 赞同：2
> 
> 时间：2013-02-19T16:26:37.403
> 
> 标签：macos, cocoa, speech-recognition, speech

我试图让语音识别在 MacBook（OS 10.8.2）上工作，但我*从来没有*在委托方法上得到任何回调。将 XCode 4.6 与 ARC 一起使用，这是我的简单测试代码。我确实在控制台中得到了“监听”输出。“麦克风”出现在屏幕上，如果我按 ESC 键，那么我可以在麦克风的显示屏上看到我的讲话模式，但仍然没有代表回调。必须有一些基本的东西，但我还没有找到。

我看过很多 SO 问题，但没有一个能解决这个问题。有些人谈论控制面板中的校准，但我没有找到任何校准（也许那是以前的操作系统？）。

[github](https://github.com/progrmr/RB2/tree/origin/RB2)中提供了完整的项目源代码。

```
#import "RBListener.h"

@interface RBListener() <NSSpeechRecognizerDelegate>

@property (nonatomic, strong, readonly) NSSpeechRecognizer* recognizer;
@property (nonatomic, strong)           NSArray*            commands;

@end

@implementation RBListener

@synthesize recognizer = _recognizer;

- (id)init
{
    self = [super init];
    if (self) {
        // initialize
        _commands = @[@"hi", @"yes", @"no", @"hello", @"good", @"time"];

        _recognizer = [[NSSpeechRecognizer alloc] init];
        _recognizer.delegate = self;
        _recognizer.commands = _commands;
        _recognizer.listensInForegroundOnly = NO;
        _recognizer.blocksOtherRecognizers  = YES;
        [_recognizer startListening];
        DLog(@"listening");
    }
    return self;
}

#pragma mark -
#pragma mark NSSpeechRecognizerDelegate methods
- (void)speechRecognizer:(NSSpeechRecognizer*)sender didRecognizeCommand:(id)command
{
    DLog(@"command: %@", command);
}

@end 
```

![口述时的屏幕截图](../Images/b7c7adaa29ee148093531bb507260ee8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:22:55.140

很可能您的 RBListener 实例没有留下来（或者甚至从未创建），所以在一切都设置好之后，没有 RBListener 实例来接收委托消息。

最简单的做法是在您的 XIB 中创建一个插座并将其连接到一个 RBListener 实例。也就是说，将一个基本的“NSObject”（普通立方体）从库中拖到您的 xib 中，并将其类更改为“RBListener”。然后可以通过您的插座引用此实例（一旦您在 IB 中连接它）并且应该保留在内存中。

如果您以编程方式分配/初始化 RBListener 实例，请确保将其存储在某处（例如作为其他一些对象上的实例变量 - 您的应用程序委托或您的 NSDocument 子类 - 以适合您的设计为准）。如果您不将其存储到属性中或使其成为单例（另一种可能的方法），ARC 会在您有机会使用它之前将其杀死，因为您没有采取任何措施来保留它。

我希望这有帮助。

# extjs4.1 - Ext JS 4：无法在“日期字段”中显示记录中的日期

> ID：14962413
> 
> 赞同：2
> 
> 时间：2013-02-19T16:26:52.897
> 
> 标签：extjs4.1

我正在尝试在表单中加载记录。其中一种字段类型是“datefield”，记录中的字段以毫秒为单位。

分娩记录数据：

```
topAccount:"ALPINE"
tradeDate:1360167174553
tradeId:"2110720401" 
```

观点是

```
 xtype: 'datefield',
 name: 'tradeDate',
 itemId: 'tradeDate',
 margin: 8,
 fieldLabel: 'Trade Date:',
 renderer: Ext.util.Format.dateRenderer('Y/m/d'), 
```

但是，当表单加载记录时，我得到空字段。

有人可以帮我解决这个问题吗？

谢谢塔拉汉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T20:28:19.473

`1360167174553`不是用于此目的的有效日期。`1920-12-01T13:00`是。

如果您查看[Date 数据类型](http://docs.sencha.com/ext-js/4-1/source/Types.html#Ext-data-Types)，您会看到：

```
 DATE: {
        convert: function(v) {
            var df = this.dateReadFormat || this.dateFormat,
                parsed;

            if (!v) {
                return null;
            }
            if (Ext.isDate(v)) {
                return v;
            }
            if (df) {
                return Ext.Date.parse(v, df);
            }

            parsed = Date.parse(v);
            return parsed ? new Date(parsed) : null;
        },
        sortType: st.asDate,
        type: 'date'
    }
}); 
```

有了数字，`Ext.isDate()`就会失败。然后两者都`Ext.Date.parse`期望`Date.parse`一个字符串，其标记不支持毫秒。

如果你坚持使用毫秒试试这个：

```
Ext.define('YourModel', {
    extend: 'Ext.data.Model',
    fields: [
        {name: 'tradeDate',  dateFormat: 'u' }
    ]
}); 
```

# python - 在 EC2 启动和停止上运行脚本

> ID：14962414
> 
> 赞同：1
> 
> 时间：2013-02-19T16:26:53.643
> 
> 标签：python, linux, amazon-web-services, amazon-ec2, amazon-rds

我有一个 Amazon Ubuntu 实例，我停止并启动（不终止）。我想知道是否可以在服务器启动和停止时运行脚本。具体来说，我正在考虑编写一个 python boto 脚本以在 EC2 服务器未运行时使我的 RDS 卷脱机。

谁能告诉我这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:53:39.027

有可能的。您只需要编写一个初始化脚本并在 /etc/rc#.d 目录中设置正确的符号链接。它将使用参数启动，`start`或者`stop`取决于机器是启动还是关闭。

# web - 通过数据库覆盖 Web 应用程序指定的数据源池的 Jetty 集群

> ID：14962415
> 
> 赞同：0
> 
> 时间：2013-02-19T16:26:54.820
> 
> 标签：web, jetty, load-balancing

目标是为当前在单个 Jetty 实例中运行的 Web 应用程序创建一个集群环境。添加集群配置时，似乎会阻止应用程序数据源池初始化。附加远程调试会话并逐步执行代码显示应用程序在启动时挂起，同时等待连接从池中释放。检查池的详细信息显示没有创建连接。c3p0 用于池化实现。当服务器在没有集群配置的情况下启动时，c3p0 会生成一条日志消息，显示它正在初始化。在配置集群的情况下启动时，看不到日志消息。让我相信应用程序数据源池永远不会初始化，因为集群数据源池正在以某种方式篡夺它。

为了获得集群行为，我将以下内容添加到 %JETTY_HOME%/etc/jetty.xml。

```
<New id="DSClustering" class="org.eclipse.jetty.plus.jndi.Resource">
    <Arg></Arg>
    <Arg>jdbc/DSClustering</Arg>
    <Arg>
        <New class="com.mchange.v2.c3p0.ComboPooledDataSource">            
            <Set name="driverClass">oracle.jdbc.OracleDriver</Set>
            <Set name="jdbcUrl">jdbc:oracle:thin:@xxxxx:1521:xe</Set>
            <Set name="User">xxxx</Set>
            <Set name="Password">xxxx</Set>

        </New>
    </Arg>
</New>

<Set name="sessionIdManager">
    <New id="jdbcidmgr" class="org.eclipse.jetty.server.session.JDBCSessionIdManager">
        <Arg><Ref id="Server"/></Arg>
        <Set name="workerName">jetty1</Set>
        <Set name="DatasourceName">jdbc/DSClustering</Set>
        <Set name="scavengeInterval">60</Set>
    </New>
</Set>
<Call name="setAttribute">
    <Arg>jdbcIdMgr</Arg>
    <Arg><Ref id="jdbcidmgr"/></Arg>
</Call> 
```

并将以下内容添加到应用程序 jetty-web.xml

```
<Set name="sessionHandler">
    <New class="org.eclipse.jetty.server.session.SessionHandler">
        <Arg>
            <New class="org.eclipse.jetty.server.session.JDBCSessionManager">
                <Set name="idManager">
                    <Ref id="jdbcidmgr"/>
                </Set>
            </New>
        </Arg>
    </New>
</Set> 
```

应用程序数据源池配置为 Spring bean -

```
<bean id="sysContextAwareDataSource" class="com.mycompany.datasource.SysContextAwareDataSource">
    <property name="targetDataSource" ref="myPoolDataSource"/>
    <property name="connectionWaitLoggingThreshold" value="1000"/>
</bean>

<bean id="myPoolDataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
    <property name="driverClass" value="${jdbc.driverClassName}"/>
    <property name="jdbcUrl" value="${jdbc.url}"/>
    <property name="user" value="${jdbc.username}"/>
    <property name="password" value="${jdbc.password}"/>
    <property name="acquireIncrement" value="${jdbc.pool.acquireIncrement}"/>
    <property name="minPoolSize" value="${jdbc.pool.minPoolSize}"/>
    <property name="maxPoolSize" value="${jdbc.pool.maxPoolSize}"/>
    <property name="initialPoolSize" value="${jdbc.pool.initialPoolSize}"/>
    <property name="acquireRetryAttempts" value="${jdbc.pool.acquireRetryAttempts}"/>
    <property name="testConnectionOnCheckin" value="${jdbc.pool.testConnectionOnCheckin}"/>
    <property name="idleConnectionTestPeriod" value="${jdbc.pool.idleConnectionTestPeriod}"/>
    <property name="preferredTestQuery" value="${jdbc.pool.preferredTestQuery}"/>
    <property name="maxIdleTime" value="${jdbc.pool.maxIdleTime}"/>
    <property name="acquireRetryDelay" value="${jdbc.pool.acquireRetryDelay}"/>
    <property name="maxStatements" value="${jdbc.pool.maxStatements}"/>
    <property name="maxStatementsPerConnection" value="${jdbc.pool.maxStatementsPerConnection}"/>
</bean>

<bean id="userDAO" class="com.mycompany.dataaccess.UserDAOImpl">
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="dataSource" ref="transactionAwareDataSourceProxy"/>
</bean> 
```

环境：jetty 8.1.9、Oracle 11g、Windows 7 Enterprise、JDK 1.6.0_38

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:36:12.453

弄清楚了！这是因为我有 2 个 ojdbc-10.2.0.4.0.jar 正在被访问。为了让会话管理数据库实现工作，我在 JETTY_HOME\lib\ext 中添加了一个 ojdbc jar。这为 Jetty 服务器提供了 Oracle 类。应用程序 lib 目录中还包含一个 ojdbc jar，供应用程序使用。出现问题是因为 ojdbc jar 是“密封”的 jar。意思是，一旦从其中一个 jar 加载了一个类，尝试从另一个 jar 加载相同的类会导致引发安全异常。因此，Jetty 服务器将从 jar 的 lib/ext 版本中加载一个 Oracle 类。然后应用程序将尝试从其 ojdbc jar 加载相同的类，从而导致安全异常。花了一段时间才弄清楚，因为收到异常的 c3p0 类，默默吞下异常，然后再次尝试建立连接。这发生在另一个线程上，然后是我正在查看的线程。那是为池建立连接的线程，而我正在查看正在等待来自池的连接的线程。啊！

# sql - SQL Server 的 LIKE 运算符是否区分大小写？

> ID：14962419
> 
> 赞同：116
> 
> 时间：2013-02-19T16:27:04.087
> 
> 标签：sql, sql-server-2005, varchar, sql-like

在[有关 LIKE 运算符的文档中](http://msdn.microsoft.com/en-us/library/ms179859.aspx)，没有说明它的大小写敏感性。是吗？如何启用/禁用它？

如果这很重要，我正在查询`varchar(n)`Microsoft SQL Server 2005 安装上的列。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-02-19T16:40:48.980

区分大小写的不是运算符，而是列本身。

执行 SQL Server 安装时，会为实例选择默认排序规则。除非另有明确说明（检查下面的 collat​​e 子句），否则在创建新数据库时，它会从实例继承排序规则，当创建新列时，它会从其所属数据库继承排序规则。

类似的排序`sql_latin1_general_cp1_ci_as`规则指示应如何处理列的内容。CI 代表不区分大小写，AS 代表区分重音。

完整的排序规则列表可在[https://msdn.microsoft.com/en-us/library/ms144250(v=sql.105).aspx获得](https://msdn.microsoft.com/en-us/library/ms144250(v=sql.105).aspx)

**(a) 检查实例排序规则**

```
select serverproperty('collation') 
```

**(b) 检查数据库排序规则**

```
select databasepropertyex('databasename', 'collation') sqlcollation 
```

**(c) 使用不同的排序规则创建数据库**

```
create database exampledatabase
collate sql_latin1_general_cp1_cs_as 
```

**(d) 使用不同的排序规则创建列**

```
create table exampletable (
    examplecolumn varchar(10) collate sql_latin1_general_cp1_ci_as null
) 
```

**(e) 修改列排序规则**

```
alter table exampletable
alter column examplecolumn varchar(10) collate sql_latin1_general_cp1_ci_as null 
```

可以更改实例和数据库排序规则，但不会影响先前创建的对象。

也可以动态更改列排序规则以进行字符串比较，但这在生产环境中是非常不推荐的，因为它非常昂贵。

```
select
  column1 collate sql_latin1_general_cp1_ci_as as column1
from table1 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-07-18T14:32:56.297

所有这些关于整理的讨论似乎有点过于复杂。为什么不使用类似的东西：

```
IF UPPER(@@VERSION) NOT LIKE '%AZURE%' 
```

那么无论排序规则如何，您的支票都不区分大小写

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-19T16:52:30.303

如果您想在不更改列/数据库/服务器的排序规则的情况下实现区分大小写的搜索，您始终可以使用该`COLLATE`子句，例如

```
USE tempdb;
GO
CREATE TABLE dbo.foo(bar VARCHAR(32) COLLATE Latin1_General_CS_AS);
GO
INSERT dbo.foo VALUES('John'),('john');
GO
SELECT bar FROM dbo.foo 
  WHERE bar LIKE 'j%';
-- 1 row

SELECT bar FROM dbo.foo 
  WHERE bar COLLATE Latin1_General_CI_AS LIKE 'j%';
-- 2 rows

GO    
DROP TABLE dbo.foo; 
```

如果您的列/数据库/服务器区分大小写并且您不想要区分大小写的搜索，则也可以以另一种方式工作，例如

```
USE tempdb;
GO
CREATE TABLE dbo.foo(bar VARCHAR(32) COLLATE Latin1_General_CI_AS);
GO
INSERT dbo.foo VALUES('John'),('john');
GO
SELECT bar FROM dbo.foo 
  WHERE bar LIKE 'j%';
-- 2 rows

SELECT bar FROM dbo.foo 
  WHERE bar COLLATE Latin1_General_CS_AS LIKE 'j%';
-- 1 row

GO
DROP TABLE dbo.foo; 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-19T16:30:44.363

您可以在定义表时定义*排序规则*。如果您定义区分大小写的顺序，您的`LIKE`操作符将以区分大小写的方式运行；如果您定义不区分大小写的排序规则，则`LIKE`运算符也会忽略字符大小写：

```
CREATE TABLE Test (
    CI_Str VARCHAR(15) COLLATE Latin1_General_CI_AS -- Case-insensitive
,   CS_Str VARCHAR(15) COLLATE Latin1_General_CS_AS -- Case-sensitive
); 
```

这是一个[关于 sqlfiddle 的快速演示，](http://www.sqlfiddle.com/#!3/005388/4)显示了使用`LIKE`.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-02-19T16:56:39.827

运算符采用`like`两个字符串。这些字符串必须具有兼容的排序规则，这[在此处](http://msdn.microsoft.com/en-us/library/ms179886%28v=sql.105%29.aspx)进行了解释。

在我看来，事情会变得复杂。以下查询返回一个错误，指出排序规则不兼容：

```
select *
from INFORMATION_SCHEMA.TABLES
where 'abc' COLLATE SQL_Latin1_General_CP1_CI_AS like 'ABC' COLLATE SQL_Latin1_General_CP1_CS_AS 
```

在这里的随机机器上，默认排序规则是`SQL_Latin1_General_CP1_CI_AS`. 以下查询成功，但不返回任何行：

```
select *
from INFORMATION_SCHEMA.TABLES
where 'abc' like 'ABC' COLLATE SQL_Latin1_General_CP1_CS_AS 
```

在区分大小写的世界中，值“abc”和“ABC”不匹配。

换句话说，没有排序规则和使用默认排序规则是有区别的。当一侧没有排序规则时，则从另一侧“分配”一个显式排序规则。

（当显式排序规则在左侧时，结果相同。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-19T16:29:56.483

试试跑步，

```
SELECT SERVERPROPERTY('COLLATION') 
```

然后找出您的排序规则是否区分大小写。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-06T01:31:34.830

您可以更改每个项目的属性。

[![区分大小写](../Images/15e2e10b681424191eae4166c74b384f.png)](https://i.stack.imgur.com/wK0kQ.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-13T08:23:54.783

您可以在 Microsoft SQL Server Management Studio 中轻松更改排序规则。

*   右键单击表格-> 设计。
*   选择您的列，向下滚动 i 列属性到排序规则。
*   通过选中“区分大小写”设置您的排序首选项

# mysql - MySQL 在将 COUNT 与 LEFT OUTER JOIN 和 GROUP BY 一起使用时包含零行

> ID：14962420
> 
> 赞同：2
> 
> 时间：2013-02-19T16:27:03.737
> 
> 标签：mysql, count, group-by, left-join

如何避免消除零会议的用户？我知道有类似的问题，但是这段代码要复杂得多。

```
SELECT user.userID, user.contactName, user.email, COUNT( * ) AS meetingsCount
FROM user
LEFT OUTER JOIN meeting ON user.userID = meeting.userID
WHERE user.userID NOT 
IN ( 1, 2, 3, 4, 5, 59, 62, 63, 64, 66, 69, 71, 72, 73, 78, 107 ) 
AND SUBSTRING( meeting.meetingCode, 5, 2 ) 
BETWEEN 12 
AND 22 
AND SUBSTRING( meeting.meetingCode, 7, 2 ) 
BETWEEN 01 
AND 12 
AND SUBSTRING( meeting.meetingCode, 9, 2 ) 
BETWEEN 01 
AND 31 
GROUP BY user.userID, contactName, email
ORDER BY meetingsCount DESC 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T16:33:55.507

您需要将会议代码表的逻辑放入您的联接中。否则，与您从会议表中过滤掉的记录匹配的用户将从您的结果中过滤掉。使您的 JOIN 本质上是一个 INNER 连接。我认为您还应该在 BETWEEN 子句中的值周围加上单引号。

```
SELECT  user.userID, user.contactName, user.email, COUNT( meeting.userID ) AS meetingsCount

FROM    user

        LEFT OUTER JOIN meeting ON user.userID = meeting.userID
        AND SUBSTRING( meeting.meetingCode, 5, 2 ) BETWEEN '12' AND '22'
        AND SUBSTRING( meeting.meetingCode, 7, 2 ) BETWEEN '01' AND '12'
        AND SUBSTRING( meeting.meetingCode, 9, 2 ) BETWEEN '01' AND '31' 

WHERE user.userID NOT IN ( 1, 2, 3, 4, 5, 59, 62, 63, 64, 66, 69, 71, 72, 73, 78, 107 ) 

GROUP BY user.userID, contactName, email

ORDER BY meetingsCount DESC 
```

# php - 为什么 nginx 作为 apache 前端代理不加载 .html 文件？

> ID：14962421
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:04.007
> 
> 标签：php, apache, ubuntu, nginx, apache2

我正在关注本教程[https://www.digitalocean.com/community/articles/how-to-configure-nginx-as-a-front-end-proxy-for-apache](https://www.digitalocean.com/community/articles/how-to-configure-nginx-as-a-front-end-proxy-for-apache)来设置 nginx 处理静态内容和所有 php 文件都由 apache 在新的 ubuntu 盒子上处理。一切顺利，我在服务器上安装了一个 php 脚本。

但是，它不加载任何 .html 文件。所有 .php 文件正在加载并且工作正常。每当浏览器请求 html 文件时，浏览器都会重定向回 index.php（尽管以 .html 结尾的 url 仍保留在地址栏中）

我已经仔细检查过，我已经按照教程完成了所有工作。什么可能会阻止 nginx 加载 html 文件？

这是我的 nginx 配置：

```
server {
    listen   80; 

    root /var/www/; 
    index index.php index.html index.htm;

    server_name example.com; 

    location / {
    try_files $uri $uri/ /index.php;
    }

    location ~ \.php$ {

    proxy_set_header X-Real-IP  $remote_addr;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header Host $host;
    proxy_pass http://127.0.0.1:8080;

     }

     location ~ /\.ht {
            deny all;
    } 
```

以下是 nginx 错误日志：

[http://d.pr/f/voxs](http://d.pr/f/voxs)

# jquery - 花哨的盒子覆盖

> ID：14962423
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:05.467
> 
> 标签：jquery, fancybox

如何让覆盖层与花哨的盒子一起使用？我正在使用下面的代码，我对 jquery 几乎没有了解。我让框弹出很好，但背景中没有任何内容。我知道在某个地方我需要一些简单的代码，但由于某种原因我找不到它或者我忽略了它。帮助将不胜感激。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery  /1.7/jquery.min.js"></script>

<link rel="stylesheet" href="css/jquery.fancybox.css" type="text/css" media="screen" />
<script type="text/javascript" src="js/jquery.fancybox.pack.js?v=2.0.5"></script>

<!-- fancyBox buttons -->
<link rel="stylesheet" href="css/jquery.fancybox-buttons.css?v=2.0.5" type="text/css" media="screen" />
<script type="text/javascript" src="../js/jquery.fancybox-buttons.js?v=2.0.5"></script>

<!-- fancyBox thumbnails -->
<link rel="stylesheet" href="css/jquery.fancybox-thumbs.css?v=2.0.5" type="text/css" media="screen" />
<script type="text/javascript" src="js/jquery.fancybox-thumbs.js?v=2.0.5"></script>

<script type="text/javascript">

$(document).ready(function() {
     $(".vimeo").fancybox({
         width: 700,
         height: 393,
         type: 'i frame',
         'autoScale': false,
         'autoDimensions': false,
         'transitionIn' : 'fade',
         'transitionOut' : 'fade',
         'transitionIn' : 'elastic',
         'transitionOut' : 'elastic',
         'speedIn' : 600, 
         'speedOut' : 200, 
         'overlayColor' : '#E71313'
     });

     $("#various1").fancybox({
                               'title Position' : 'inside',
                               'transitionIn' : 'none',
                               'transitionOut' : 'none',
                               'transitionIn' : 'elastic',
                               'transitionOut' : 'elastic',
                               'speedIn' : 600, 
                               'speedOut' : 200,
                               'overlayColor' : '#E71313'
     });
});

</script>
</body> 
```

# javascript - 从嵌套循环中删除剔除函数中的父级

> ID：14962424
> 
> 赞同：1
> 
> 时间：2013-02-19T16:27:07.147
> 
> 标签：javascript, knockout.js, knockout-2.0

在我看来，我正在循环一个 observableArray (itemGroup)，它有一个属性也是 observableArray (item)。我有一个删除整个 itemGroup 的方法和一个从 itemGroup 中删除一个项目的方法，但我想添加一些逻辑沿着它的行，组中只剩下一个项目，删除该项目也应该删除 itemGroup。

这是我的视图模型和视图的相关部分的示例。

我的 JS

```
var ItemModel = function(item) {
   var self = this;
   self.name = ko.observable(item.name);
   self.price = ko.observable(item.price);
};

var ItemGroupModel = function(itemGroup) {
   var self = this;
   self.order = ko.observable(itemGroup.order);
   self.items = ko.observableArray(ko.utils.arrayMap(itemGroup.items, function(item){
      return new ItemModel(item);
   }));
   self.type = ko.observable(item.type);

   self.removeItem = function(item) {
      self.items.remove(item);
   }
};

var ViewModel = function(data) {
   var self = this;
   self.itemGroups = ko.observableArray(ko.utils.arrayMap(data.itemGroups, function(itemGroup) {
     return new ItemGroupModel(item);
   }));

  // some other properties and methods
   self.removeItemGroup = function(itemGroup) {
     self.itemGroups.remove(itemGroup);
  }
}; 
```

我的观点

```
<ul data-bind="foreach: {data: VM.itemGroups, as: 'itemGroup'}">
   <li>
       <button data-bind="click: $root.VM.removeItemGroup">X</button>
       <ul data-bind="foreach: {data: itemGroup.items, as: 'item'}">
          <li>
             <!-- ko if: itemGroup.items().length > 1 -->
             <button data-bind="click: itemGroup.removeItem">X</button>
             <!-- /ko -->
             <!-- ko ifnot: itemGroup.items().length > 1 -->
             <button data-bind="click: function () { $root.VM.removeItemGroup($parent) }">X</button>
             <!-- /ko -->
           </li>
       </ul>
   </li>
</ul> 
```

这可行，但对我来说并不理想。据我了解，淘汰赛应该可以帮助我摆脱使用像“function () { $root.VM.removeItemGroup($parent) }”这样的匿名函数，但我不确定如何以另一种方式做到这一点。删除 if 和 ifnot 语句也可以很好地清理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T13:53:42.013

**我想给出我的解决方案**

将 itemGroups 和项目的索引作为参数发送到 remove 方法。

**希望你知道如何发送索引**

然后检查 itemGroups 的长度

```
self.remove(itemGroupsIndex,itemsIndex) {
 var itemGroupsLength = self.itemGroups()[itemGroupsIndex].items().length;
  if(itemGroupsLength = 1) {

   self.itemGroups.remove(itemGroupsIndex);

  }
  else {

   self.itemGroups()[itemGroupsIndex].items.remove(itemsIndex);

  }
 }; 
```

# c# - asp.net 文件夹访问

> ID：14962426
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:13.507
> 
> 标签：c#, asp.net, file-permissions

我正在尝试在新创建的文件夹中读取刚刚上传到服务器的文件（文件夹名称是会话 ID）

> 异常详细信息：System.UnauthorizedAccessException：对路径“...\UploadFiles\jeiqw1qxya33e3r00idwlceo”的访问被拒绝。

我不确定要授予哪个用户访问权限，在网上查看它说要添加运行应用程序池的身份，对我来说，这对我来说是 ApplicationPoolIdentity ...但我找不到要添加的用户文件夹权限。所以我添加了“每个人”并给予完全控制......只是为了试验头脑，我仍然得到上面的错误。

这与我在这里的最后一个问题有关... [带有制表符分隔文本文件的 StreamReader](https://stackoverflow.com/questions/14954437/streamreader-with-tab-delimited-text-file/14954905#14954905)

使用 ' `File.ReadAllLines()`' 方法，这是有异常的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:21:32.690

找出应用程序在哪个特定帐户下运行的另一种方法是在代码中：System.Security.Principal.WindowsIdentity.GetCurrent().Name

但是，如果您已授予该帐户或所有人完全控制权并且您仍然收到拒绝访问错误，那么新上传的文件是否可能被锁定？您是否将上传的文件保存到虚拟目录内的位置？有时，如果文件保存到可浏览的位置，IIS 会临时锁定文件。病毒扫描程序有时也会导致文件锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:33:31.610

授予对动态创建的文件夹的读取访问权限是不切实际的 - 正如您所说的文件夹名称是会话 ID。

但是，您可以像这样将文件流式传输回给用户。

```
HttpResponse response = HttpContext.Current.Response;
response.Clear();
response.Charset = "utf-8";
response.ContentType = "text/xls";
response.AddHeader("content-disposition", 
   string.Format("attachment; filename={0}", fileName));
response.BinaryWrite(File.ReadAllBytes(filePath));
response.End(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:38:00.473

如果您运行的是 IIS 7.5 或更高版本，那么与您的应用程序池一起运行的用户通常是“IIS APPPool{POOL NAME}”，其中 {POOL NAME} 是池/站点的名称。

如果您使用具有应用程序池标识的 IIS 7，我认为它仍然是您的站点运行的“网络服务”。

顺便说一句，您可以直接看到 yoru apppool(w3wp.exe) 在任务管理器/进程资源管理器等工具中运行的用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T09:10:05.043

我要感谢大家的回复。

今天早上我用新的眼光看代码时，我注意到我的代码中有一个错误......

我有...

```
var records = File.ReadAllLines(Server.MapPath("~/UploadFiles/") + Session.SessionID).ToList(); 
```

它指向文件夹，而不是目标文件。

我改成...

```
var records = File.ReadAllLines(Server.MapPath("~/UploadFiles/") + Session.SessionID + "/ediFile.txt").ToList(); 
```

这现在有效！难怪这让我感到困惑，因为权限设置毕竟是正确的！:)

# javascript - 时钟不工作？

> ID：14962430
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:17.997
> 
> 标签：javascript, clock

所以我遵循了一个非常严格的视频教程，通过 JS 在你的网页中添加时钟。我有完全相同的代码，但它不适用于我的。有什么建议么？谢谢！

这是我的代码：

```
<body>

    <div id="clockDisplay">00:00</div>

<!-- JAVASCRIPT starts here -------------------------------------------------------->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" language="JavaScript">

$(window).load(function renderTime() {
    var currentTime = new Date () ;
    var diem = "AM" ;
    var h = currentTime.getHours() ;
    var m = currentTime.getminutes() ;
    var s = currentTime.getSeconds() ;

    if (h == 0) {
        h = 12;
    } else if (h > 12) {
    h = h -12;
    diem = "PM" ;
    }
    if (h < 10) {
        h = "0" + h;
    }
    if (m < 10) {
        m = "0" + m;
    }
    if (s < 10) {
        s = "0" + s;
    }

    var myClock = document.getElementyID('clockDisplay');
    myClock.textContent = h + ":" + m + ":" + s + " " + diem;
    setTimeout(renderTime()' ,1000) ;
};
renderTime() ;

</script>

<!-- JAVASCRIPT ends here --------------------------------------------------------->

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:32:56.770

您的 setTimeout 代码中有语法错误（引号不匹配）。永远不要使用字符串作为 setTimeout 的第一个参数。

```
setTimeout(renderTime, 1000); 
```

`$(window).load()`如果将 Javascript 代码放在元素之后，则不需要`id="clockDisplay"`

```
function renderTime() {
   ...
}
renderTime(); 
```

这些也需要改变。

```
getElementById()
getMinutes() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:31:38.790

不知道你下面的教程，但我会改变这一行：

```
myClock.textContent = h + ":" + m + ":" + s + " " + diem; 
```

对此：

```
myClock.innerHTML = h + ":" + m + ":" + s + " " + diem; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:44:45.507

这里要解决的事情太多，这是我的代码：

```
<body>

    <div id="clockDisplay">00:00</div>

<!-- JAVASCRIPT starts here -------------------------------------------------------->

<script type="text/javascript" language="JavaScript">

function renderTime() {
    var currentTime = new Date () ;
    var diem = "AM" ;
    var h = currentTime.getHours() ;
    var m = currentTime.getMinutes() ;
    var s = currentTime.getSeconds() ;

    if (h == 0) {
        h = 12;
    } else if (h > 12) {
    h = h -12;
    diem = "PM" ;
    }
    if (h < 10) {
        h = "0" + h;
    }
    if (m < 10) {
        m = "0" + m;
    }
    if (s < 10) {
        s = "0" + s;
    }

    var myClock = document.getElementById('clockDisplay');
    myClock.textContent = h + ":" + m + ":" + s + " " + diem;

}
window.onload = renderTime;
setInterval(renderTime ,1000) ;

</script>

<!-- JAVASCRIPT ends here --------------------------------------------------------->

</body> 
```

要查看详细信息修复，请访问：[已修复问题详细信息链接](http://chopapp.com/#yfig64nr)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-01T13:54:46.190

我在我的个人开发网站上创建了一个数字时钟，但它没有动画......我的 javascript 如下：

下午 7 点 23 分 45 秒

```
<script>
function webClock() {
  var pos = "PM";
  var pickTime = new Date();
  var h = pickTime.getHours();
  var m = pickTime.getMinutes();
  var s = pickTime.getSeconds();

  if(h == 0){
    h = 12;

  }else if(h>12){
     h = h-12;
     pos="AM";
  }

 if(h<10){
      h = "0" + h;

  }
  if(m<10){
      m = "0" + m;

  }
  if(s<10){
      s = "0" + s;

  } 

   document.getElementById('MyClock').innerHTML= h + ":" + m + ":" + s + " " +"pos"; 

   setTimeout(webClock, 500);
}
webClock();

}
</script> 
```

# javascript - 在javascript中动态调用对象的函数

> ID：14962435
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:26.637
> 
> 标签：javascript

我正在尝试编写一个通用函数，它将采用以下参数：JavaScript 类的对象（类型对象）、方法名称（类型字符串）和传递参数（类型对象）。有点像下面我编写了名为 InvokeFunction 的函数：

```
function InvokeFunction(objPerson , eventName, objParam)
{
 // now here I want to invoke an function(eventName) which is present in  objPerson(an javascript class) and also pass an objParam as it is an parametrized function
} 
```

**需要这样做：**

因为我想要一个常见的地方，我将只传递一个对象和事件名称以及该函数需要的参数。

它将在 try catch 块中处理，因此如果传递的事件名称不存在于对象中，我将处理异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:28:34.257

语法是：

```
objPerson[eventName](objParam); 
```

在 JavaScript 中，“方法”只是附加到属性的函数，通过查找属性并在同一表达式中调用函数来调用。

在 JavaScript 中，您可以通过两种方式引用属性：使用点表示法和文字名称：

```
obj.foo(); 
```

或使用括号表示法和字符串：

```
obj["foo"](); 
```

字符串可以是任何表达式的结果，因此它可以是字符串文字、变量引用、计算结果等等。

# entity-framework-5 - 告诉 EF 处理唯一的复合索引

> ID：14962438
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:31.247
> 
> 标签：entity-framework-5

我设置了一个 3 列索引，该索引在我的表中必须是唯一的。我怎么能告诉 EF 呢？我目前正在`DbUpdateException`尝试保存更改。

`Cannot insert duplicate key row in object 'sm.SkillAssignations' with unique index 'IX_SkillAssignations'. The duplicate key value is (8285, 1, 2, 2).\r\nThe statement has been terminated.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:17:17.087

为了避免异常检查具有您要插入的唯一索引值的实体是否已经存在：

```
if (!context.SkillAssignations.Any(s =>
        s.Value1 == newSkillAssignation.Value1 &&
        s.Value2 == newSkillAssignation.Value2 &&
        s.Value3 == newSkillAssignation.Value3))
    context.SkillAssignations.Add(newSkillAssignation);
else
    // your own error handling
    // - or do you want to UPDATE the existing entity in this case? 
```

`Any`如果其他人在调用（EXISTS 查询）和`Add`（INSERT 语句）之间插入具有该键的实体，它仍然可能失败。我不知道有什么魔法可以为你省去这张支票。

# google-maps - KML：显示多个地标

> ID：14962443
> 
> 赞同：2
> 
> 时间：2013-02-19T16:27:43.307
> 
> 标签：google-maps, google-maps-markers, kml

我想在一个 KML 文件中显示起点、目的地和中间路线。我的文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
 <Document id="raptor">
  <name>Raptor.kml</name>
  <visibility>1</visibility>
  <open>1</open>
  <Placemark id="start">
    <name>Start</name>
    <Point id="startpoint">
      <coordinates>
        0.16212,51.5454
      </coordinates>
    </Point>
  </Placemark>
  <Placemark id="target">
    <name>Target</name>
    <Point id="targetpoint">
      <coordinates>
        0.06146,51.5529
      </coordinates>
    </Point>
  </Placemark>
  <Placemark id="route">
    <name>Route</name>
    <LineString id="routelines">
      <coordinates>
        0.16212,51.5454
        0.16619,51.5445
        0.16553,51.5442
        0.05228,51.5394
        0.05113,51.5381
        0.0589,51.5528
        0.06146,51.5529
      </coordinates>
    </LineString>
  </Placemark>
 </Document>
</kml> 
```

当我将它加载到谷歌地图（使用我的地图 -> 创建新地图 -> 导入）时，它有时只显示起点，有时只显示起点和目标点，有时只显示路线，......

我定义多个元素的方式似乎有问题。我该怎么做？

**编辑：** 当我将文件上传到服务器并将 URL 插入谷歌地图搜索字段时，它可以工作。这是谷歌地图中的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:08:16.343

我也检查了你在谷歌地球上发布的 kml 上面它运行良好，所有开始目标和路线都清晰可见。

代码没有问题，再次检查。

# php - 隐藏文件夹 .htaccess

> ID：14962444
> 
> 赞同：0
> 
> 时间：2013-02-19T16:27:50.383
> 
> 标签：php, .htaccess, directory

我需要从 url 隐藏一个文件夹。

一个例子：

如果我输入 www.mysite.com/jango.php 我需要你阅读目录：www.mysite.com/users/jango.php 但不想看到 /users 我只想在地址栏中看到这个： www.mysite.com/jango.php

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:31:34.657

你应该使用 mod_rewrite

对你来说，示例规则将

```
RewriteRule ^jango\.php$ /users/jango.php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:31:46.393

在你的`.htaccess`：

```
RewriteEngine On
RewriteRule ^/users/([^/]*)$ /$1 [L] 
```

# gcc - 飞思卡尔 iMX6q ARM 处理器的 gcc 选项

> ID：14962447
> 
> 赞同：9
> 
> 时间：2013-02-19T16:27:52.497
> 
> 标签：gcc, arm, toolchain

我正在尝试为我正在设置的工具链找出 gcc 选项，用于开发板：Sabre-lite，它基于飞思卡尔的 iMX6q 四核处理器。

现在我知道 iMX6 基本上是一个 cortex-a9 处理器，它有协处理器 vfpv3 和 neon，还有矢量图形、2D 甚至 3D 引擎。

但是，发行说明和使用指南文档对如何启用可以在 gcc 中启用的任何选项并不太清楚。

事实上，我可以“玩”的选项如下。

```
-march= armv7-a                - ok this one is pretty obvious.
-mfpu= vfpv3/neon              - i can use only the vfpv3 co-processor, or both (respectively, depends on option)
-mfloat-abi=softfp/soft/hard   - I guess I can choose hard here, as there is hardware for fp operations
-mcpu=cortex-a9                - is it option even necessary? it is not clear if it just an alias for -march or something else. 
```

我应该启用其他选项吗？为什么工具链具有构建 linux kernel/uboot/packages 的默认选项：

```
-march= armv7-a -mfpu= vfpv3 -mfloat-abi=softfp 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T17:30:16.343

使用`-mthumb -O3 -march=armv7-a -mcpu=cortex-a9 -mtune=cortex-a9 -mfpu=neon -mvectorize-with-neon-quad -mfloat-abi=softfp`. 请注意，默认情况下，编译器不会使用 NEON 对浮点运算进行矢量化，因为 NEON 不支持非正规数。`-ffast-math`如果您对精度有所损失感到满意，您可以通过添加开关使 gcc 使用 NEON 进行浮点运算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-06T22:35:34.223

我无法回答所有问题，但“--softfp”表示使用 FPU，但要与不使用的代码保持兼容性。

[稍微过时的 ARM FP 文档](https://wiki.debian.org/ArmHardFloatPort#Background_information)

# git - 适合 Node.js 的 .gitignore

> ID：14962451
> 
> 赞同：15
> 
> 时间：2013-02-19T16:28:05.610
> 
> 标签：git, node.js, github, npm, gitignore

## 树形结构

这就是我的 Node.js 项目的组织方式：

```
/
| - node_modules               [+ INCLUDE]
|   | - my-mod1
|   |   | - node_modules       [- IGNORE]
|   |   |   | - external-mod1 
|   |   |   | - external-mod2 
|   |   | - src
|   |   |   | - node_modules   [+ INCLUDE]
|   |   |   |   | - my-mod2 
|   |   |   |   | - my-mod3
|   | - my-mod4 
```

## 我的计划

将我的项目发布到 GitHub 时：

*   我**想**包括**`my-mod`s**。
*   我**不想**包括 **`external-mod`s**。

这意味着：

*   我**想**包含顶级`/node_modules`文件夹。
*   我**不想**包含作为模块文件夹`node_modules`的**直接子文件夹的文件夹。**
*   但我**想**包括`node_moduels`文件夹**的子`src`**文件夹。

## 我做了什么

我将以下几行添加到`/.gitignore`：

```
#################  
## npm
#################

npm-debug.log
node_modules/
!/node_modules/
!src/node_modules/ 
```

## 我的问题

我需要哪些**`.gitignore`规则****来包含正确的`node_modules`**文件夹（如上所述）？

谢谢 - 如果有任何不清楚的地方，请发表评论。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-20T14:03:25.737

由于您的结构非常有条理，您可以使用此模式来完成任务。

```
/node_modules/*/node-modules/ 
```

上述模式将忽略模块文件夹下的 node_modules、my-mod1、my-mod4 等。

当您推送到 github 时，上面的行仍然允许包含 src 目录下的 node_modules。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-19T16:44:14.983

`node_modules/**/node_modules`应该适用于您正在尝试做的事情。

提示：[GitHub](https://github.com/github/gitignore/blob/master/)`.gitignore`为各种语言（如[Node](https://github.com/github/gitignore/blob/master/Node.gitignore) ）提供标准。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-23T15:19:18.600

感谢您的回答。

我重新考虑了条件并决定以另一种方式声明条件 - 它完美地工作：

```
node_modules/*/node_modules 
```

我希望这能够在未来帮助任何人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:41:43.447

```
node_modules/*
!node_modules/**/node_modules 
```

也许？

# c# - C# Word 文档 - 如何清理格式？

> ID：14962455
> 
> 赞同：0
> 
> 时间：2013-02-19T16:28:13.680
> 
> 标签：c#, replace, formatting, ms-word

困境相当简单。我需要创建一个小应用程序，它将清除所有字体背景颜色（保持表格单元格背景颜色不变），并删除 word 文档中所有带删除线的文本，然后将文档保存到另一个文件夹中。否则文档的格式应该保持不变。

下面是一个从谷歌提供的随机示例中收集的大型示例，展示了如何将特定类型的格式应用于使用 Find.Execute() 找到的随机字符串。但是，我不知道如何仅按照上述方式进行操作。

```
public static string searchDoc(string fileNameRef)
    {

        Microsoft.Office.Interop.Word._Application word = new Microsoft.Office.Interop.Word.Application(); ;
        Microsoft.Office.Interop.Word._Document doc = new Microsoft.Office.Interop.Word.Document();
        object missing = System.Type.Missing;

        try
        {
            System.IO.FileInfo ExecutableFileInfo =
                    new System.IO.FileInfo(System.Reflection.Assembly.GetEntryAssembly().Location);

            object fileName =
                System.IO.Path.Combine(ExecutableFileInfo.DirectoryName, fileNameRef);

            doc = word.Documents.Open(ref fileName, ref missing, ref missing, ref missing
                , ref missing, ref missing, ref missing, ref missing, ref missing, ref missing
                , ref missing, ref missing, ref missing, ref missing, ref missing, ref missing);
            doc.Activate();

            //object findStr = "hello"; //sonething to find
            // THIS is the part where I fail, I can't find of a way to Find.Execute on formatting
            // as opposed to mere strings.
            //while (word.Selection.Find.Execute(ref findStr))  //found...
            //{
            //    //change font and format of matched words
            //    word.Selection.Font.Name = "Tahoma"; //change font to Tahoma
            //    word.Selection.Font.ColorIndex = Microsoft.Office.Interop.Word.WdColorIndex.wdRed;  //change color to red
            //}

            object saveFileName = ExecutableFileInfo.DirectoryName + "\\New\\" + fileNameRef;

            doc.SaveAs(ref saveFileName, ref missing, ref missing, ref missing, ref missing
                , ref missing, ref missing, ref missing, ref missing, ref missing, ref missing
                , ref missing, ref missing, ref missing, ref missing, ref missing);

        }
        catch (Exception)
        {
        }
        finally
        {
            doc.Close(ref missing, ref missing, ref missing);
            word.Application.Quit(ref missing, ref missing, ref missing);
        }

        return fileNameRef;
    } 
```

谢谢你的帮助！我的意思是，我想，简单地开始如何发现格式将有很大帮助。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:14:19.193

这不是特定于 C# 的问题；[这是一个词对象模型问题（我在这里](https://stackoverflow.com/questions/13445538/handling-ms-word-with-vbs-on-windows/13446037#13446037)和[这里](https://stackoverflow.com/questions/13509207/ms-word-r-w-in-python-python-docx-issue-and-win32com-references/13509702#13509702)指给你）。

至于您的具体问题，我建议您在 Word 中打开宏录制器，执行操作，然后查看生成的 VBA 代码。然后你可以在 C# 中应用它。

试试这个：

```
using System;
using Microsoft.Office.Interop.Word;
using System.IO;
using System.Reflection;

namespace WordFormattingFindReplace {
    class Program {
        static void Main(string[] args) {
        }

        public static string searchDoc(string fileName) {
            _Application word = new Application(); ;
            _Document doc;

            string folderName = Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
            string filePath = Path.Combine(folderName,fileName);

            doc = word.Documents.Open(filePath);

            var find=doc.Range().Find;
            find.Text="Hello";
            find.Format=true;
            find.Replacement.Font.Name="Tahoma";
            find.Replacement.Font.ColorIndex=WdColorIndex.wdRed;
            find.Execute(Replace:WdReplace.wdReplaceAll);

            doc.SaveAs2(Path.Combine(folderName,"New",fileName));

            doc.Close();

            //We need to cast this to _Application to resolve which Quit method is being called
            ((_Application)word.Application).Quit();

            return fileName;
        }
    }
} 
```

一些注意事项：

*   为了清楚起见，使用`using`语句。而不是`Microsoft.Office.Interop.Word._Application word`, 添加`using Microsoft.Office.Interop.Word`在文件的顶部，然后您可以只写`_Application word`
*   如果您只需要文件夹名称，请使用静态`Path.GetDirectoryName`方法并保存为`string`变量，而不是创建`FileInfo`对象
*   `Documents.Open`从 .NET 4 开始，您可以在调用和`Document.SaveAs`时跳过可选参数`Document.Close`。这也意味着您不需要`object missing`.
*   这里没有用户真正需要查看的内容，因此`Document.Activate`无需调用
*   重用实例可能更好`Word.Application`，而不是为每次调用重新创建它。

# spring - Spring 论坛集成

> ID：14962457
> 
> 赞同：0
> 
> 时间：2013-02-19T16:28:18.407
> 
> 标签：spring, glassfish, forum

我的应用程序使用 Spring Security 和 Spring MVC，并托管在 Glassfish 3.1.2 上。

我正在寻找可以轻松集成到我的应用程序中的论坛软件（类似phpBB）。

有人知道一些吗？

我找到了 JForum，但它是一个需要安装的网络应用程序......也许我应该安装它并将目录复制到我的应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:45:13.650

我尝试了 jForum，即使该项目似乎没有继续，它也适合我的应用程序。

为了让它与 Spring 一起使用，我必须通过修改 jForum 配置来使用**SSO**（单点登录）。

在文件**SystemGlobals.properties**中，我不得不将属性更改`authentication.type = default`为`authentication.type = sso`.

jForum 将使用请求上下文的远程用户。

有关更多信息，请参阅下面的课程

*   网络.jforum.JForum
*   net.jforum.ControllerUtils
*   net.jforum.sso.RemoteUserSSO
*   网络.jforum.sso.SSOUtils

# error-handling - 解析 XML 文件时的错误处理

> ID：14962458
> 
> 赞同：2
> 
> 时间：2013-02-19T16:28:19.947
> 
> 标签：error-handling, smalltalk, visualworks

我有一些代码可以解析这样的 XML 文件：

```
[doc := (XML.XMLParser new) parse: aFilename asURI] on: XML.SAXParseException
    do: [:ex | MyCustomError raiseSignal: ex description]. 
```

我现在想通过将 XML 文件移动到名为“Failed”的文件夹来处理堆栈中更高的 MyCustomError，但由于解析器没有机会关闭文件，所以我收到了共享冲突错误。

如果我像这样更改我的代码，它可以工作，但我想知道是否有更好的方法：

```
[doc := (XML.XMLParser new) parse: aFilename asURI] on: XML.SAXParseException
        do: [:ex | description := ex description].
description ifNotNil: [MyCustomError raiseSignal: description]. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:45:44.000

对于可恢复的错误（非致命），代码可以发出异常信号；如果您捕获这样的错误，您不能确定 XMLParser 不打算继续运行。例如，不知道是在交互模式还是批处理模式下调用的代码可能会发出简单信息消息的异常信号；调用者将知道是以交互方式（例如使用消息提示）还是批处理方式（将消息写入日志文件）来处理它。

为了使其工作，以这种方式进行通信的代码片段必须知道它们正在处理什么样的错误。（这通常使用严重级别来完成，通过异常对象中的状态或通过引发不同类别的异常进行编码。）如果您检查 ex 对象，您可能会看到此信息。

无论如何，证据表明 XMLParser 将 SAXParseException 视为可恢复的错误（否则，它应该自行清理）。既然如此，您的“修复”似乎足够合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T10:21:45.453

您还可以在 ReadStream 而不是 URL 上运行解析器。然后，您可以将代码包装在关闭 readStream 的确保块中。

# html - HTML div，如何包装内容？

> ID：14962459
> 
> 赞同：15
> 
> 时间：2013-02-19T16:28:21.947
> 
> 标签：html, css

我在这张图片上有 3 个 div：

![在此处输入图像描述](../Images/828ff5c26ccd8714e8974fa60eccab18.png)

div1 具有固定宽度但可变高度，所以我想要的是，如果 div1 高度大于 div2 高度，则 div3 保持在 div2 下方和 div1 右侧，如下所示：

![在此处输入图像描述](../Images/fd1888a1b977e107a03ffd5576ca10f8.png)

关于如何做到这一点的任何想法？目前，我创建了一个容器：

```
<div class="colcontainer">
    <div class="col-left">
    {% block news %}{% endblock %}
    </div>  
    <div id="main_content">
        <div class="col-right">
            {% block rightcol %}{% endblock %}
        </div> 
        <div id="content">
            <div class="contentwrap">
                <div class="itemwrap">
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>

    <div class="content-bottom"><div class="content-bottom-left"></div></div>
    </div>
</div> 
```

我的 CSS 是这样的：

```
.col-left {
    float:left;
    padding:0;
    margin:0;
    width: 300px;
    min-height:198px;
}

.col-right {
    text-align:left;
    padding:0;
    margin:0 0 0 200px;
}

#content {
    background: none repeat scroll 0 0 #FFFFFF;
    float: left;
    margin-top: 10px;
    padding: 10px;
    width: 980px;
} 
```

这是[JSFiddle 演示](http://jsfiddle.net/JRbFy)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T16:48:05.750

Atlast，我明白了 :) 只需将所有这三个元素包装在父元素中，如下所示。

**HTML**

```
<div class="main">
   <div class="div1"></div>  <!-- Change height to see result -->
   <div class="div2"></div>
   <div class="div3"></div>
</div> 
```

**CSS**

```
.main{width:200px;height:200px;border:1px solid black;overflow:hidden;}
.div1{width:100px;min-height:100px;float:left;background-color:green;}
.div2{width:100px;display:inline-block;height:100px;background-color:blue;}
.div3{width:100px;display:inline-block;height:100px;background-color:red;margin-top:-4px;} 
```

[**工作小提琴**](http://jsfiddle.net/Ujwb6/4/)

如果你想让第三个 div 的宽度比它本身宽，那么我强烈建议你使用 jQuery。

```
.div3{width:200px;}  /* Keeping width wide enough with the container */ 
```

* * *

**jQuery**

```
$(function(){
    if($('.div1').height() > 100)
       $('.div3').width(100)
}); 
```

[**工作小提琴**](http://jsfiddle.net/Ujwb6/3/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T17:03:38.053

如果你`#content`这样设计它就可以了。

```
#content {
    background: #fbb;
    padding: 10px;
} 
```

注意没有浮动。

jsFiddle：http: [//jsfiddle.net/JRbFy/1/](http://jsfiddle.net/JRbFy/1/)

具有等高左列和内容效果的jsFiddle：http: [//jsfiddle.net/JRbFy/2/](http://jsfiddle.net/JRbFy/2/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T16:53:40.067

由于 CSS 还没有为这项工作提供任何东西，您将不得不使用 Javascript。

我会首先在您的第一张图片上创建一个页面。然后我会用

```
$("#div").height() 
```

，它返回您的 div 的高度并将其与您的第二个 div 的高度进行比较：

```
if($("#div1").height() > $("div2").height())
  //change website... 
```

在 if 正文中放置所需的 css 更改......这应该可以解决问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T17:03:00.320

如果我理解正确，你想要这样的东西吗？

```
<style>
    #container1
    {
        width: 100%;
    }

    #left
    {
        width: 30%;
        background: #123456;
        float: left;
        height: 50%;
    }
    #right
    {
        width: 70%;
        float: left;
        height: 50%;
    }
    #right_top
    {
        background: #111111;
        height: 30%;
    }
    #right_bottom
    {
        background: #777777;
        height: 70%;
    }
</style>

<div id="container1">
    <div id="left">Div 1</div>
    <div id="right">
        <div id="right_top">Div 2</div>
        <div id="right_bottom">Div 3</div>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-19T17:07:42.640

这应该对您有用，至少可以为您指明正确的方向。

CSS：

```
.box {border:1px dashed black;}
#content {width:1000px;}
#clear {clear:both;}

#left {float:left; width:200px; height:100px; margin-right:15px;}
#top {float:left; width:780px; height:200px;}
#main {float:left; min-width:780px; max-width:1000px;} 
```

HTML：

```
<html>
<head>
<link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="box" id="content">
<div class="box" id="left">Left</div>
<div class="box" id="top">Top</div>
<div class="box" id="main">Main</div>
<div id="clear"></div>
</div>

</body>
</html> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-19T17:24:19.603

最后我的解决方案也来了:)

演示：http: [//jsfiddle.net/JRbFy/3/](http://jsfiddle.net/JRbFy/3/)

只需使用`margin: 10px auto;`，并`content div`取出`main_content div`：

HTML

```
<div class="colcontainer">
    <div class="col-left">
    {% block news %}{% endblock %}
        <br/>
        <b>Hover on me to increase my height </b>
    </div>  
    <div id="main_content">
        <div class="col-right">
            {% block rightcol %}{% endblock %}
        </div> 
    </div>
    <div id="content">
        <div class="contentwrap">
            <div class="itemwrap">
                {% block content %}{% endblock %}
            </div>
        </div>

    <div class="content-bottom"><div class="content-bottom-left"></div></div>
    </div>
</div> 
```

CSS

```
.colcontainer{
    width: auto;
}

.col-left {
    background: none repeat scroll 0 0 silver;
    float:left;
    padding:0;
    margin:0;
    width: 300px;
    min-height:198px;
}

.col-left:hover{    
    height: 300px;
}

.col-right {
    background: none repeat scroll 0 0 steelblue;
    text-align:left;
    padding:0;
    margin:0 0 0 200px;
    height:198px;
}

#content {
    background: none repeat scroll 0 0 yellowgreen;    
    margin: 10px auto;
    padding: 10px;
} 
```

希望有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-03T07:06:56.727

看到每个人都喜欢 jQuery，我决定把一些东西放在一起，实际上可以满足你的要求。玩得开心 ：）

```
<div id="div1">
    <p>Test</p>
    <p>Test</p>
    <p>Test</p>
</div>
<div id="div2">
    <p>Test</p>
    <p>Test</p>
    <p>Test</p>
</div>
<div id="div3">
    <p>Test</p>
    <p>Test</p>
    <p>Test</p>
</div>
<div id="div4">
    <p>Test</p>
    <p>Test</p>
    <p>Test</p>
</div> 
```

加入一些CSS

```
#div1, #div2, #div3, #div4 {
    border:3px double #000;
    background:#fff
}
#div1 {
    width:200px;
    float:left;
}
#div4 {
    clear:both;
} 
```

最后是你的 jQuery。

```
$(function () {
    $('#div2').css({
        marginLeft: $('#div1').outerWidth()
    });
    if ($('#div2').height() < $('#div1').height()) {
        $('#div3').css({
            marginLeft: $('#div1').outerWidth()
        });
    }
}); 
```

现在。我并不是在提倡这种方法，只是说它实际上实现了您的要求，而这里没有其他任何东西；）

在[这个 jsFiddle](http://jsfiddle.net/fm67v/)看到它。只需向 div1 添加一个 <p>Test</p> ，您就会看到 div3 根据您的图像转到 div1 的右侧。

现在，我知道有人会说“但是 div1 并没有占据所有的高度！”，不用担心。检查[更新的 jsFiddle](http://jsfiddle.net/fm67v/1/)并在 javascript 中添加一个片段，以查看您的问题也得到了解答。只需从 div1 中删除 <p>Test</p> 之一。

```
$(function () {
    $('#div2').css({
        marginLeft: $('#div1').outerWidth()
    });
    if ($('#div2').height() < $('#div1').height()) {
        $('#div3').css({
            marginLeft: $('#div1').outerWidth()
        });
        $('#div1').css({
            height: $('#div2').outerHeight() + $('#div3').height()
        });
    }
}); 
```

我必须重申，这个解决方案依赖于 Javascript。关闭它，设备不支持它，这停止工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-12T15:12:16.290

我可能错过了阅读这个问题，但这没有你想要的布局。

[https://jsfiddle.net/94ohw4hq/](https://jsfiddle.net/94ohw4hq/)

```
<div id="container">
<div class="left">
Left
</div>
<div class="right">
Right
</div>
<div class="bottom">
Bottom
</div>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-18T15:12:10.473

不一定能回答问题，但我想您可能想知道在 CSS 3 中您可以使用这种样式 - {word-wrap: break-word;} - 将长字符串放入 div 中。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2013-11-29T05:37:43.767

利用

> 书签插件

解决你的问题

# jquery - Jquery 函数在 Bootstrap 模式下不起作用

> ID：14962460
> 
> 赞同：4
> 
> 时间：2013-02-19T16:28:21.070
> 
> 标签：jquery, twitter-bootstrap, modal-dialog, external

我在我的项目中使用 Bootstrap v2.X，我想使用模态函数打开一个外部文件。

首先，我应该使用的代码是：

```
<a href="view_graphics.php" class="btn btn-warning btn-large" data-toggle="modal">Graphics</a> 
```

但这对我不起作用。然后我使用：

```
<a href="view_graphics.php" id="graphics" class="btn btn-warning btn-large">Graphics</a> 
```

我把代码Jquery：

```
$('a#graphics').click(function(e) {
            e.preventDefault();
            var url = $(this).attr('href');
            if (url.indexOf('#') == 0) {
                $(url).modal('open');
            } else {
                $.get(url, function(data) {
                    $('<div class="modal hide fade modal-graphics">' + data + '</div>').modal();
                }).success(function() { $('input:text:visible:first').focus(); });
            }
        }); 
```

它有效！

嗯，但这不是主要问题。问题是当模式打开时，不要使用我的代码 jQuery。

这是我的模态外部：

```
<div class="modal-header">
    <a class="close" data-dismiss="modal">x</a>
    <h3>Titulo modal</h3>
</div>
<div class="modal-body">
    <div class="window">
        <div class="nom_epi"></div>
    </div>
</div>
<div class="modal-footer">
    <a class="btn btn-primary" href="javascript:print();">Imprimir</a>
    <a class="btn" data-dismiss="modal">Cerrar</a>
</div> 
```

如果我将代码放在原始文件中：

```
$(document).ready(function() {
$('.nom_epi').click(function() { alert("hello"); });
}); 
```

它不起作用！外部模态忽略原始文件的 Jquery 代码。这很奇怪，因为引导 CSS 解释得很好。

我认为这是由于我用来打开外部模式的 jQuery 代码。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-19T16:32:40.017

您正在将事件绑定到文档就绪，因此它仅绑定到当时存在的元素。我建议改用该`on()`功能。

大卫在他的评论中给出的建议应该可以正常工作：

> $('body').on('click', '.nom_epi', function() { alert("hello"); })

通常，您会尝试将函数绑定到 DOM 树的更下方，但这些模态通常是`<body>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-13T19:29:39.853

考虑一下，如果您单击所需 DOM 对象之外的任何地方，它仍然会触发函数执行；这将是一种混乱。因此，不推荐将事件绑定`click`到，因为这将是大量事件绑定。`body`尝试使用`window.onLoad`函数，而不是`document.ready`在其中使用相同的 DOM 对象保持绑定函数执行。

```
$(window).load(() => {

  $('.nom_epi').click((e) => { 
      console.debug("it is working"); 
  });

}); 
```

# java - 无法从 MarkLogic Java API 访问文件

> ID：14962461
> 
> 赞同：1
> 
> 时间：2013-02-19T16:28:23.283
> 
> 标签：java, marklogic

在演示一些访问本地 MarkLogic 服务器的新 Java 代码的过程中，我遇到了以下错误。每当我尝试加载文件或访问其元数据时，它都会弹出：

`Only XML and JSON error messages supported by MarkLogic server.`

`TextDocumentManager.readMetadata()`这在对and的调用中被触发`TextDocumentManager.read()`。该代码在我的机器上运行良好，但在我的主管的机器上运行良好（他是看到错误的人），这让我认为我在开发过程中调整了数据库配置中的某些内容，但没有写下来。不幸的是，我想不出那会是什么。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:06:52.340

该消息表明服务器响应错误，但没有将错误内容声明为 JSON 或 XML 的 Content-Type 标头。

到目前为止，我们只在服务器未初始化为 REST 服务器时才看到 Java 异常。

因此，请检查您的连接参数。如果有疑问，请使用 curl 之类的 HTTP 客户端发出 REST 服务器的等效请求，以验证请求是否被接受。

如果 REST 服务器似乎可以运行，您还可以在 REST 服务器上打开错误日志记录以帮助调试 Java 客户端。

* * *

要回答后续问题（StackOverFlow 在初始答案时超时）：

InfoStudio 数据库配置中有一个用于创建 REST 服务器的 UI。

*   转到 /appservices/ 路径中的端口 8000。
*   从下拉列表中选择数据库，然后单击配置
*   在页面底部附近添加一个 REST API 实例

还有一个 REST 接口供管理员用户（不是 REST 管理员用户）在端口 8002 上创建 REST 实例。有关这些服务的信息，请参阅

[http://docs.marklogic.com/REST/client/service-management](http://docs.marklogic.com/REST/client/service-management)

# html - 如何在全高应用程序中结合 flexbox 和垂直滚动？

> ID：14962468
> 
> 赞同：129
> 
> 时间：2013-02-19T16:28:35.083
> 
> 标签：html, css, flexbox

我想使用一个使用 flexbox 的全高应用程序。我在这个链接中找到了我想要使用旧的 flexbox 布局模块（`display: box;`和其他东西）的东西：[CSS3 Flexbox full-height app and overflow](https://stackoverflow.com/questions/9251447/css3-flexbox-full-height-app-and-overflow)

对于只支持旧版 flexbox CSS 属性的浏览器来说，这是一个正确的解决方案。

如果我想尝试使用较新的 flexbox 属性，我将尝试使用作为 hack 列出的同一链接中的第二个解决方案：使用带有`height: 0px;`. 它使显示垂直滚动。

我不太喜欢它，因为它引入了其他问题，而且它更像是一种解决方法而不是解决方案。

```
html, body {
    height: 100%;    
}
#container {
	display: flex;
	flex-direction: column;
	height: 100%;
}
#container article {
	flex: 1 1 auto;
	overflow-y: scroll;
}
#container header {
    background-color: gray;
}
#container footer {
    background-color: gray;
}
```

```
<section id="container" >
    <header id="header" >This is a header</header>
    <article id="content" >
        This is the content that
        <br />
        With a lot of lines.
        <br />
        With a lot of lines.
        <br />
        This is the content that
        <br />
        With a lot of lines.
        <br />
        <br />
        This is the content that
        <br />
        With a lot of lines.
        <br />
        <br />
        This is the content that
        <br />
        With a lot of lines.
        <br />
    </article>
    <footer id="footer" >This is a footer</footer>
</section>
```

我还准备了一个带有基本示例的 JSFiddle：http: [//jsfiddle.net/ch7n6/](http://jsfiddle.net/ch7n6/)

这是一个全高的 HTML 网站，由于内容元素的 flexbox 属性，页脚位于底部。我建议你移动 CSS 代码和结果之间的栏来模拟不同的高度。

* * *

## 回答 #1

> 赞同：272
> 
> 时间：2013-02-19T18:38:59.783

感谢[https://stackoverflow.com/users/1652962/cimmanon](https://stackoverflow.com/users/1652962/cimmanon)给了我答案。

解决方案是为垂直可滚动元素设置高度。例如：

```
#container article {
    flex: 1 1 auto;
    overflow-y: auto;
    height: 0px;
} 
```

该元素**将**具有高度，因为 flexbox 会重新计算它，除非您想要一个*最小高度*，因此您可以使用`height: 100px;`它与以下内容完全相同：`min-height: 100px;`

```
#container article {
    flex: 1 1 auto;
    overflow-y: auto;
    height: 100px; /* == min-height: 100px*/
} 
```

所以如果你想`min-height`在垂直滚动中最好的解决方案：

```
#container article {
    flex: 1 1 auto;
    overflow-y: auto;
    min-height: 100px;
} 
```

如果您只想完全垂直滚动以防没有足够的空间来查看文章：

```
#container article {
    flex: 1 1 auto;
    overflow-y: auto;
    min-height: 0px;
} 
```

最终代码：http: [//jsfiddle.net/ch7n6/867/](http://jsfiddle.net/ch7n6/867/)

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2015-12-18T19:31:59.193

Flexbox 规范编辑器在这里。

这是一种鼓励使用 flexbox 的方法，但是您应该调整一些东西以获得最佳行为。

*   不要使用前缀。大多数浏览器都很好地支持无前缀的 flexbox。始终以无前缀开头，并且仅在必要时添加前缀以支持它。

*   由于您的页眉和页脚不是要弯曲的，因此它们都应该`flex: none;`设置在它们上面。现在，由于某些重叠效果，您有类似的行为，但您不应该依赖它，除非您以后想不小心弄糊涂。（默认是`flex:0 1 auto`，所以它们从它们的自动高度开始，可以缩小但不能增长，但它们也是`overflow:visible`默认的，这会触发它们的默认值`min-height:auto`以防止它们完全缩小。如果你在它们上设置了一个，改变`overflow`的行为`min-height:auto`（切换到零而不是最小内容），它们会突然被超高的`<article>`元素压扁。）

*   您也可以简化`<article>` `flex`- 只需设置`flex: 1;`好就可以了。尽量坚持[https://drafts.c](https://drafts.csswg.org/css-flexbox/#flex-common) ​​sswg.org/css-flexbox/#flex-common 中的通用值，除非你有充分的理由去做更复杂的事情——它们更容易阅读并涵盖大部分行为你会想要调用。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-02-19T18:50:18.120

当前的规范说明了这一点`flex: 1 1 auto`：

> 根据`width`/`height`属性调整项目大小，但使它们完全灵活，以便它们吸收沿主轴的任何可用空间。如果所有项目都是`flex: auto`、`flex: initial`或`flex: none`，则在调整项目大小后的任何正可用空间都将平均分配给具有 的项目`flex: auto`。

[http://www.w3.org/TR/2012/CR-css3-flexbox-20120918/#flex-common](http://www.w3.org/TR/2012/CR-css3-flexbox-20120918/#flex-common)

在我看来，如果你说一个元素是 100px 高，它更像是一个“建议”大小，而不是绝对大小。因为它被允许收缩和增长，所以它占用了尽可能多的空间。这就是为什么将此行添加到您的“主要”元素的原因：（ `height: 0`或任何其他小数字）。

# rtsp - 使用 RED5 媒体服务器录制电视频道流？

> ID：14962471
> 
> 赞同：0
> 
> 时间：2013-02-19T16:28:43.590
> 
> 标签：rtsp, red5, recording, wowza

我想录制直播电视频道流。我知道，在 wowza 媒体服务器中，您可以重新流式传输 rtsp 流（用于电视频道）并使用 HTTPLiveStreamRecord 插件进行录制。我可以使用 RED5 媒体服务器进行此类录制吗？如果是，如何？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T04:23:37.100

是的，您通过使用带有 NetStream 对象的 Flash。oflademo 就是一个例子。

# iphone - 我的阴影重绘了自己？

> ID：14962474
> 
> 赞同：0
> 
> 时间：2013-02-19T16:28:50.590
> 
> 标签：iphone, ios5, ios6, uinavigationcontroller, uinavigationbar

我已经对 UINavigationController 进行了子类化，在方法 viewDidApper: 上添加了一个阴影，来自 UINavigationController，如下所示：

```
 - (void)viewDidAppear:(BOOL)animated
{
    // Add shadow to Navigation Bar
    CAGradientLayer *newShadow = [[CAGradientLayer alloc] init];
    newShadow.shadowColor = [[UIColor blackColor] CGColor];
    newShadow.shadowOffset = CGSizeMake(0.0f, 4.0f);
    newShadow.shadowOpacity = 1.0f;
    CGRect shadowPath = CGRectMake(self.navigationBar.layer.bounds.origin.x - 10, self.navigationBar.layer.bounds.size.height - 6, self.navigationBar.layer.bounds.size.width + 20, 5);
    newShadow.shadowPath = [UIBezierPath bezierPathWithRect:shadowPath].CGPath;
    newShadow.shouldRasterize = YES;
    self.navigationBar.clipsToBounds = NO;
    [self.navigationBar.layer addSublayer:newShadow];
    [super viewDidAppear:animated];
} 
```

当我在 ModalViewController 中使用这个 NavigationController 时，阴影会一遍又一遍地重绘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:31:25.343

因为`- viewDidAppear:`每次视图**出现时都会调用该方法。**您可能希望将此代码移动到`- viewDidLoad`方法中。

# php - Symfony 2 或 PHP 框架一般和复杂的表单/子表单

> ID：14962476
> 
> 赞同：2
> 
> 时间：2013-02-19T16:28:52.397
> 
> 标签：php, forms, symfony

我是 Zend Framework 用户，我正在寻找一些替代方案。我过去对 Symfony 很感兴趣。

我最近写了一些非常复杂的表格，这是我公司的 UX 想法，可以在一页上编辑调查。

**调查包括：**

*   调查有很多步骤
*   步骤有很多问题
*   问题有很多答案

所以你可以看到它正在使用 4 个连接的模型。每个模型都由子表单表示。我可以通过 ajax 添加步骤/问题/答案。

当然，我必须编写很多自定义代码，例如。在填充通过 POST 发送到表单的数据时，我需要创建子表单并填充它们，但所有逻辑都保留在表单对象中。对于透明的控制器。我在控制器中需要做的就是使用 POST 或 Database Survey Row 对象填充表单，并且它正在工作。

我想知道如何在 symfony2 中完成它？

读完之后：[http](http://symfony.com/doc/current/book/forms.html) ://symfony.com/doc/current/book/forms.html我认为这真的很难。

**有人可以简要描述如何完成这个吗？**

如何动态创建子表单并将它们附加到 symfony 中的表单？子表单可以有其他子表单，例如我的调查->步骤->问题->答案连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:22:57.903

如果适合您的情况，嵌入表单集合非常容易。[http://symfony.com/doc/2.0/cookbook/form/form_collections.html](http://symfony.com/doc/2.0/cookbook/form/form_collections.html)

# java - 关于 Spring Framework 应用程序中 JDBC 逻辑的一些信息

> ID：14962480
> 
> 赞同：1
> 
> 时间：2013-02-19T16:28:57.687
> 
> 标签：java, spring, spring-mvc, jdbc, prepared-statement

我正在学习如何在 Spring 应用程序中使用 JDBC，但我对此有些怀疑。

所以，让我解释一下我对一个实际例子的怀疑：

如果我有一个实现我的 DAO 接口的类，并且该类包含以下在我的数据库的 Student 表中插入新行的方法：

```
public void create(String name, Integer age) {
    String SQL = "insert into Student (name, age) values (?, ?)";

    jdbcTemplateObject.update(SQL, name, age);
    System.out.println("Created Record Name = " + name + " Age = " + age);
    return;
} 
```

此方法有 2 个输入参数：与我的数据库表中的两列（NAME 和 AGE）相关的**名称**和**年龄**

好的...我认为 SQL 字符串 rappresent 我的 SQL 查询必须执行才能在我的表中插入新行

我有一些问题要理解这段代码的确切含​​义：**值（？，？）**

我认为，当我在 JdbcTemplate 对象上调用 update() 方法时，会向它传递 SQL 查询以及**名称**和 **年龄*值这些？占位符替换为这些值。

这样查询就可以执行了。

这样对吗？

是替换这些占位符的 update() 方法吗？

我还读到使用了这些占位符，所以我不必担心转义我的值......究竟是什么意思**转义一个值**？

最后一个问题是关于**PreparedStatment**的使用……阅读我读过的 Spring 文档，我还可以将 PreparedStatment 传递给 update() 方法……有什么区别？在这种情况下是 Spring 使用 SQL 字符串和 2 输入参数创建一个新的 PreparedStatment 还是我使用了不同的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:39:32.487

主要是为了避免SQL注入。

如果你刚刚这样做：

```
"insert into Student (name, age) values ('"+name+"', "+age+")" 
```

`name`考虑如果是会发生什么`"mary', 3), ('john', 13)--"`

查询变为：

```
insert into Student (name, age) values ('mary', 3), ('john', 13)--', 24) 
```

当您忽略 SQL 注释时`--`：

```
insert into Student (name, age) values ('mary', 3), ('john', 13) 
```

将插入 2 条记录。

您当然可以转义或过滤名称字符串，但这很容易出错并且很容易忘记并使某些查询易受攻击，不妨使用准备好的语句来使这成为不可能。

转义意味着在任何 SQL 元字符之前添加一个转义字符，以便其含义发生变化。

如果您对名称进行了转义，则查询将是：

```
insert into Student (name, age) values ('\', 3), (\'john\', 13)--', 24) 
```

IE 这个名字实际上是`"', 3), ('john', 13)--"`，并且没有发生 SQL 注入。

# python - 在字典中递归查找键

> ID：14962485
> 
> 赞同：41
> 
> 时间：2013-02-19T16:29:21.167
> 
> 标签：python, search, recursion, dictionary

我正在尝试编写一个非常简单的函数来递归搜索可能嵌套的（在最极端的情况下十级深）Python 字典并返回它从给定键中找到的第一个值。

我不明白为什么我的代码不适用于嵌套字典。

```
def _finditem(obj, key):
    if key in obj: return obj[key]
    for k, v in obj.items():
        if isinstance(v,dict):
            _finditem(v, key)

print _finditem({"B":{"A":2}},"A") 
```

它返回`None`。

但是，它确实适用于`_finditem({"B":1,"A":2},"A")`，返回`2`。

我确定这是一个简单的错误，但我找不到。我觉得标准库中可能已经有一些东西了`collections`，但我也找不到。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-02-19T16:30:33.710

当你递归时，你需要`return`得到结果`_finditem`

```
def _finditem(obj, key):
    if key in obj: return obj[key]
    for k, v in obj.items():
        if isinstance(v,dict):
            return _finditem(v, key)  #added return statement 
```

要修复实际的算法，您需要意识到如果没有找到任何东西就会`_finditem`返回，因此您需要明确检查以防止提前返回：`None`

```
def _finditem(obj, key):
    if key in obj: return obj[key]
    for k, v in obj.items():
        if isinstance(v,dict):
            item = _finditem(v, key)
            if item is not None:
                return item 
```

当然，如果您`None`在任何字典中有值，那将失败。在这种情况下，你可以为这个函数设置一个哨兵`object()`，并在你没有找到任何东西的情况下返回它——然后你可以检查`sentinel`你是否找到了一些东西。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-11-27T23:06:02.300

这是一个搜索包含嵌套字典和列表的字典的函数。它创建结果值的列表。

```
def get_recursively(search_dict, field):
    """
    Takes a dict with nested lists and dicts,
    and searches all dicts for a key of the field
    provided.
    """
    fields_found = []

    for key, value in search_dict.iteritems():

        if key == field:
            fields_found.append(value)

        elif isinstance(value, dict):
            results = get_recursively(value, field)
            for result in results:
                fields_found.append(result)

        elif isinstance(value, list):
            for item in value:
                if isinstance(item, dict):
                    more_results = get_recursively(item, field)
                    for another_result in more_results:
                        fields_found.append(another_result)

    return fields_found 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-04-03T12:37:09.170

这是一种使用“堆栈”和[“迭代器堆栈”模式的方法](http://garethrees.org/2016/09/28/pattern/)（感谢 Gareth Rees）：

```
def search(d, key, default=None):
    """Return a value corresponding to the specified key in the (possibly
    nested) dictionary d. If there is no item with that key, return
    default.
    """
    stack = [iter(d.items())]
    while stack:
        for k, v in stack[-1]:
            if isinstance(v, dict):
                stack.append(iter(v.items()))
                break
            elif k == key:
                return v
        else:
            stack.pop()
    return default 
```

将`print(search({"B": {"A": 2}}, "A"))`打印`2`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-19T11:14:30.563

只是想让它更短：

```
def get_recursively(search_dict, field):
    if isinstance(search_dict, dict):
        if field in search_dict:
            return search_dict[field]
        for key in search_dict:
            item = get_recursively(search_dict[key], field)
            if item is not None:
                return item
    elif isinstance(search_dict, list):
        for element in search_dict:
            item = get_recursively(element, field)
            if item is not None:
                return item
    return None 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-28T20:50:22.433

我必须创建一个通用版本，在包含多个嵌套字典和列表的字典中找到唯一指定的键（指定所需值的路径的最小字典）。

对于下面的示例，创建了一个目标字典进行搜索，并使用通配符“???”创建了键。运行时，它返回值“D”

```
def lfind(query_list:List, target_list:List, targ_str:str = "???"):
    for tval in target_list:
        #print("lfind: tval = {}, query_list[0] = {}".format(tval, query_list[0]))
        if isinstance(tval, dict):
            val = dfind(query_list[0], tval, targ_str)
            if val:
                return val
        elif tval == query_list[0]:
            return tval

def dfind(query_dict:Dict, target_dict:Dict, targ_str:str = "???"):
    for key, qval in query_dict.items():
        tval = target_dict[key]
        #print("dfind: key = {}, qval = {}, tval = {}".format(key, qval, tval))
        if isinstance(qval, dict):
            val =  dfind(qval, tval, targ_str)
            if val:
                return val
        elif isinstance(qval, list):
            return lfind(qval, tval, targ_str)
        else:
            if qval == targ_str:
                return tval
            if qval != tval:
                break

def find(target_dict:Dict, query_dict:Dict):
    result = dfind(query_dict, target_dict)
    return result

target_dict = {"A":[
    {"key1":"A", "key2":{"key3": "B"}},
    {"key1":"C", "key2":{"key3": "D"}}]
}
query_dict = {"A":[{"key1":"C", "key2":{"key3": "???"}}]}

result = find(target_dict, query_dict)
print("result = {}".format(result)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-18T15:58:06.727

由于缺乏声誉，我无法对@mgilston 提出的已接受解决方案添加评论。如果要搜索的键在列表中，则该解决方案不起作用。

遍历列表的元素并调用递归函数应该扩展功能以查找嵌套列表中的元素：

```
def _finditem(obj, key):
    if key in obj: return obj[key]
    for k, v in obj.items():
        if isinstance(v,dict):
            item = _finditem(v, key)
            if item is not None:
                return item
        elif isinstance(v,list):
            for list_item in v:
                item = _finditem(list_item, key)
                if item is not None:
                    return item

print(_finditem({"C": {"B": [{"A":2}]}}, "A")) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-27T20:47:22.490

以为我会把我的帽子扔在戒指上，这将允许对任何实现`__getitem__`方法的递归请求。

```
def _get_recursive(obj, args, default=None):
    """Apply successive requests to an obj that implements __getitem__ and
    return result if something is found, else return default"""
    if not args:
        return obj
    try:
        key, *args = args
        _obj = object.__getitem__(obj, key)
        return _get_recursive(_obj, args, default=default)
    except (KeyError, IndexError, AttributeError):
        return default 
```

# android - 调用 clearView() 后 Android WebView 闪烁

> ID：14962490
> 
> 赞同：3
> 
> 时间：2013-02-19T16:29:27.993
> 
> 标签：android, android-webview

我使用 android.webkit.WebView 向用户显示一些 HTML 格式的信息。每当我在我的应用程序中“分页”时，我都会重用屏幕上的所有图形元素，并用不同的内容填充它们。默认情况下，WebView 会增加其大小以适应内容，但如果内容缩小则不会减小。

为了解决这个问题，我调用`webView.clearView()`清除视图，然后`webView.loadDataWithBaseURL(null, html, "text/html", "utf-8", null)`用数据重新加载它。它可以工作，但它会产生一种非常奇怪的行为，即视图开始持续闪烁。闪烁区域的大小似乎与填充较小内容后的空白区域大小相同。

我无法用言语更好地描述这一点，所以我制作了一个简短的视频来说明这个问题： [http ://www.youtube.com/watch?v=yL7tQpRSFe0](http://www.youtube.com/watch?v=yL7tQpRSFe0)

WebView 是屏幕下方的黄色框。

我做错了什么，还是一个错误？如果这是一个 Android 错误，是否有更好的方法来调整视图大小以规避此问题？

# windows-phone-8 - 在 Hold 事件中为 LongListSelector 项设置动画

> ID：14962492
> 
> 赞同：0
> 
> 时间：2013-02-19T16:29:33.657
> 
> 标签：windows-phone-8

当我持有它时，我正在尝试为 longlistselectoritem 设置动画。我正在检查事件保持以从 AppResources 中的故事板启动动画，但是，FrameworkElement 在 Windows Phone 中没有 BeginStoryboard。

我只是想改变颜色并对持有的物品进行变换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T11:35:31.130

在将我的头撞到墙上几个小时后，我放弃了并从模板中制作了一个 UserControl，在那里我能够控制 VisualStates 并为我的控件设置动画。不是一个非常干净的解决方案，但它工作得很好，只需一点点工作就可以使控件与任何模板一起使用。

# html - 无法在状态更新中更改我的网站的 Facebook 图标

> ID：14962501
> 
> 赞同：2
> 
> 时间：2013-02-19T16:30:01.580
> 
> 标签：html, facebook, facebook-graph-api

当我在状态更新中链接到我的网站时，我无法显示正确的图像。它要么从首页抓取我不希望它使用的图像（指向首页的链接），要么根本没有图像（指向特定页面的链接）。

我找到了几个教程，它们都给出了关于使用元标记来指定要使用的图像的相同建议，我已经这样做了。[示例教程](https://www.facebook.com/notes/hyperarts-web-design/set-up-your-website-to-control-images-text-in-facebook-status-update-links/10150320031290844)。例子：

```
<link rel="image_src" href="http://URL-TO-IMAGE" /> 
```

这没有效果。文章提到 Facebook 缓存了这些查找并提供了指向[URL Debugger](https://developers.facebook.com/tools/debug)的链接，该链接应该为我清理该缓存。我用它来验证我的元标记是否正确插入（确实如此），但它对新的状态更新没有影响。我错过了什么吗？教程的方式告诉我，使用此调试器将清除页面的 Facebook 缓存，以便下一次查找将加载并重新缓存正确的图像。相反，似乎所有这一切都是为了测试目的而绕过缓存这一次。

有没有办法真正强制清除这个缓存，还是我只需要等待？已经好几天了。这个缓存需要多长时间才能过期？

**重现步骤：**

1.  访问 Facebook 动态消息或时间线
2.  在状态更新中输入我的网站的 URL（如果需要可以提供）

**预期结果**

我网站的 Favicon 被加载为状态更新的图标

**实际结果**

一个人的图像（出现在我们网站的侧边栏中）用作图标（用于指向首页的链接。指向网站内页的链接根本不加载任何图标。）

**更远：**

1.  访问 URL 调试器
2.  输入网站网址
3.  验证正确的图标正在加载
4.  在新状态更新中发布链接。

**预期结果**

FB 的缓存将更新，现在将使用 Favicon。

**实际结果**

不......仍然是首页链接侧边栏中的人，内页链接根本没有图标。

**2013 年 2 月 22 日更新：**

当我将我的 URL 发布到 Facebook 时加载的图像已更改！但这仍然是错误的:(。

我今天早上去测试它，现在我有一个额外的图像作为选项，这意味着 Facebook 确实更新了它从网站加载的内容，但它仍然不是我在标签中指定的图像。它只是从我的另一个边栏中抓取另一张图片，而我仍然没有为我的内页获取图片。

这很奇怪.... URL 调试器工具抓取了正确的图像，所以我认为问题不在于我的 Meta 标签。这就是 URL 调试器应该帮助我识别的内容。我认为查找和 Facebook 实际发布的内容之间存在一些脱节。我认为这是 Facebook 的问题，除非我遗漏了一些巨大的东西，但我没有看到它......

**2013 年 2 月 25 日更新：**

我取得了进展，但仍有一些奇怪的事情发生。Martey 让我直接使用 og: 元标签，而不仅仅是标签。我一直在关注的教程说忽略 Open Graph 警告，但是一旦我开始关注它们，我就得到了一些很好的信息。就像，它实际上说我的图像太小，它将使用另一个图像。我想我应该注意了:)

无论如何，所以问题是图标太小了。根据 Open Graph 警告，它需要在两个方向上都是 200 像素。所以我抓住了实际的标题标志并尝试使用它。它的宽度为 340 像素。糟糕，它只有 164 像素高。

因此，我使用 The GIMP 将其设置为 200 像素高的透明背景并再次尝试，但它仍然告诉我它太小了。它不再告诉我它需要 200 像素。它只是说它太小了。

我又懵逼了……

**2013 年 2 月 25 日更新：问题已解决**

问题是透明度。我用白色填充背景并再次尝试，现在加载正常。

谢谢你的帮助，马蒂！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:55:56.163

[您应该参考Facebook 的官方 OpenGraph 文档](https://developers.facebook.com/docs/technical-guides/opengraph/built-in-objects/)，而不是使用第三方教程。他们建议使用`og:image`元标记来引用文档图像。

正如我在[评论](http://facebook.stackoverflow.com/questions/14962501/unable-to-change-facebook-icon-for-my-website-on-status-updates#comment21007757_14962501)中指出的那样，Facebook 上数据未更新的问题可能是 OpenGraph 元标记格式错误或错误的结果。如果没有麻烦页面的 URL，或者 URL Debugger 的警告信息，很难推荐解决方案。

# sql - SQL 语句中的 ROUND 与舍入标量结果

> ID：14962510
> 
> 赞同：1
> 
> 时间：2013-02-19T16:30:37.413
> 
> 标签：sql, vb.net

这更像是一个风格问题而不是编码问题。我有一个函数，该函数根据该申请上每个行项目的数量 * 成本相乘来返回申请的总数。结果只能有两位小数，因为它是美元金额。

这是我当前的 SQL 语句：

```
SELECT SUM(Quantity * Cost) 
FROM LineItems
WHERE RequisitionID = @requisitionID 
```

这是我在 vb 中的返回语句：

```
Return CDec(FormatNumber(selectCommand.ExecuteScalar, 2)) 
```

`ROUND()`在 SQL 语句中使用函数而不是舍入标量结果有什么好处吗？

代码工作得很好，但我想找到最有效的解决方案。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:37:56.023

我宁愿对标量结果进行四舍五入，因为您仍然可以操作标量命令返回的记录。

它为我提供了灵活性，因为谁知道代码将来会有一些变化。

# android - 输入电子邮件文本android

> ID：14962513
> 
> 赞同：6
> 
> 时间：2013-02-19T16:30:41.767
> 
> 标签：android, android-edittext

EditText 中的正确内容是什么`inputType`？`email`

```
<EditText
  android:id="@+id/email"
  android:layout_width="200dip"
  android:layout_height="wrap_content"
  android:layout_below="@+id/textEmail"
  android:inputType=""/> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T16:35:24.433

```
android:inputType="textEmailAddress" 
```

如果您在 Eclipse 中点击`Ctrl`+ `Space`，那么它将显示可用选项菜单并在您键入时缩小它们的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T16:32:29.177

你不需要一个，默认就可以了。当你想要特殊行为时，你只需要一个输入类型——只有数字、密码等。

编辑：如果您想要一个电子邮件地址，请按照其他人的建议使用 textEmailAddress 。电子邮件的正文，即我阅读问题的方式，可以是默认的。主题有 textEmailSubject，但往往被忽略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-02T20:07:55.387

```
 ticketMail1 = findViewById(R.id.ticketMail);

    private boolean validateEmail(EditText email){
    String emailinput = ticketMail1.getText().toString();

    if(!emailinput.isEmpty() && Patterns.EMAIL_ADDRESS.matcher(emailinput).matches()){

        return true;
    }else{
        Toast.makeText(this,"Invalid Email Address",Toast.LENGTH_SHORT).show();
        return false;
    }
} 
```

# lua - NSE 脚本 - 在表的功能上使用 self 感到困惑

> ID：14962514
> 
> 赞同：0
> 
> 时间：2013-02-19T16:30:42.190
> 
> 标签：lua

美好的一天，我正在尝试了解更多基于 Lua 的 NSE 脚本，但是在将函数用作表中的元素时，我无法理解与语法相关的一些内容。我将展示我迷路的部分脚本 nmap/scripts/broadcast-rip-discover.nse：

```
RIPv2 = {

    -- The Request class contains functions to build a RIPv2 Request
    Request = {

        -- Creates a new Request instance
        --
        -- @param command number containing the RIPv2 Command to use
        -- @return o instance of request
        -- code ommitted (give values to the table o) 
            setmetatable(o, self)
            self.__index = self
            return o
        end,

        -- Converts the whole request to a string
        __tostring = function(self)
            --- -- code ommitted  ( Override the metafunction __tostring) 
            return data
        end,

    },

    -- The Response class contains code needed to parse a RIPv2 response
    Response = {

        -- Creates a new Response instance based on raw socket data
        --
        -- @param data string containing the raw socket response
        -- @return o Response instance
        new = function(self, data)
            local o = { data = data }

            -- code ommitted (Read from data and pass values to o) 

            setmetatable(o, self)
            self.__index = self
            return o
        end,

    }

} 
```

从脚本的“动作”部分，我们有这样的用途

```
 local rip = RIPv2.Request:new(RIPv2.Command.Request) 
 local response = RIPv2.Response:new(data) -- Data has been already give a value 
```

我知道为这两行创建 Table RIPv2 的新实例是“相似的”。由于所有函数都在一个表内（这不是一个类，因为 Lua 只有基本工具可以使事物相似但与类不同）所以“自我”参数对于 Lua 来说是强制性的，知道该放在哪里。

但是我不明白为什么要尝试覆盖从表 RIPv2 到表 o 的函数，我的意思是目标有什么行？： setmetatable(o, self) ）

我知道变量表 o 现在可以具有与 RIPv2 将他自己的值组合在一起的相同功能，但这部分让我抓狂，我在 Nmap 的论坛上找不到直接的答案。

Pd 这将是用“本地”声明 RiPv2 的区别（确保这不是全局变量）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:49:12.790

> 由于所有函数都在表内，因此 Lua 必须知道“self”参数的位置。

所有函数*不一定*是表的一部分。元表允许您指定 table 中的查找`a`可以解析为 table 中的查找`b`，这正是这里所做的。

> 但是我不明白为什么要尝试覆盖从表 RIPv2 到表 o 的函数，我的意思是目标有什么行？： setmetatable(o, self) ）

`o`是一个类的*实例*，它只包含实例数据。这些*方法*存储在类对象`Request`或`Response`. 元表允许尝试`o`通过类对象来解析索引。

[请参阅关于类*的 Lua 编程*章节。](http://lua-users.org/wiki/SimpleLuaClasses)

# .net - 从 StdContentComboBox 获取选定的值

> ID：14962518
> 
> 赞同：0
> 
> 时间：2013-02-19T16:30:48.560
> 
> 标签：.net, openxml, openxml-sdk, docx

我想从 StdContentComboBox 中获取选定的值，这是放置在 docx 文档中的内容控件。我需要在 .NET 中获取选定的值，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:50:06.673

尝试这个：

```
using (WordprocessingDocument myDoc = WordprocessingDocument.Open("yourDocPath", true))
{
    var sdtElements = myDoc.MainDocumentPart.Document.Body.Descendants<SdtElement>();
    var contentControlsWithComboBoxes = sdtElements.Where(x => x.SdtProperties.Elements<SdtContentComboBox>().Any());

    var contentRuns =
        contentControlsWithComboBoxes.Select(x => x.Elements<SdtContentRun>());
    var selectedValues  = contentRuns.Select(x => x.FirstOrDefault().InnerText); // Your selected combobox values 

} 
```

# hibernate - 有没有一种方法可以基于 jta-data-source 配置 Hibernate Dialect？

> ID：14962519
> 
> 赞同：2
> 
> 时间：2013-02-19T16:30:48.210
> 
> 标签：hibernate, jakarta-ee, jpa, ejb

假设 ejb-jar 具有以下 persistence.xml 配置：

```
 <?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">
  <persistence-unit name="com.mystrotv.mdn.admanager.entity">
    <jta-data-source>/dataSource/MystroDS_Tx</jta-data-source>
    <properties>
      <property name="jboss.entity.manager.jndi.name" value="java:/EntityManagers/AdManagerPersistenceContext"/>
      <property name="jboss.entity.manager.factory.jndi.name" value="java:/EntityManagers/AdManagerPersistenceUnit"/>
      <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect"/>
      <property name="hibernate.hbm2ddl.auto" value="validate"/>
      <property name="hibernate.max_fetch_depth" value="5"/>
      <property name="hibernate.validator.apply_to_ddl" value="false" />
      <property name="hibernate.validator.autoregister_listeners" value="false" />
    </properties>
  </persistence-unit>
</persistence> 
```

我想根据 JTA 数据源定义休眠方言。如果是 oracle，我使用下面指出的方言，如果是 postgres，我使用不同的方言。有谁知道如何做到这一点，或者可以指出我如何做到这一点的文档？谷歌未能提供所需的信息。该应用程序将部署在 JBoss 应用程序服务器中，但我也想支持其他应用程序服务器。此外，我们有两种部署模型，一种使用 postgres，一种使用 oracle 和 Id，而不必构建两个 Ears 来支持配置文件中的一行差异。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T17:22:39.533

就在我发布问题之后，我找到了答案；

[http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#portability-dialectresolver](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#portability-dialectresolver)

具体来说，如果没有指定方言，从 3.2 开始的 hibernate 版本应该从 JTA 数据源自动检测它，因此正确的过程是完全不使用方言规范。

# ios - Xcode 项目中的两个 info.plist 文件如何工作？

> ID：14962543
> 
> 赞同：0
> 
> 时间：2013-02-19T16:32:01.063
> 
> 标签：ios, xcode, localization, internationalization, info.plist

我在 Xcode 项目中有两个 info.plist 文件，并在下面标记。有人可以解释这些如何与本地化一起工作吗？

```
Project - EN-Info.plist
Project - FR-Info.plist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:09:57.397

使用 Xcode 4.6 只需选择文件“EN-Info.plist”并在右侧窗格中显示文件检查器并在本地化部分检查英语，对“FR-Info.plist”执行相同操作并检查法语

# tsql - 出发日期大于到达日期

> ID：14962546
> 
> 赞同：1
> 
> 时间：2013-02-19T16:32:11.520
> 
> 标签：tsql

如何确保我的出发日期大于以下代码中的到达日期。

```
SELECT ArrivalDate, DATEADD(day, RAND(checksum(NEWID()))*1.5
* LengthOfStay.LengthofStay, ArrivalDate) AS DepartureDate    
FROM Bookings, LengthOfStay
ORDER BY ArrivalDate 
```

谢谢

韦恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:39:28.450

[`DATEADD`](http://msdn.microsoft.com/en-us/library/ms186819.aspx)取一个整数......并且从随机化返回的任何十进制值都将被截断。因此，您可能只是添加`0`到`ArrivalDate`，导致两个日期相等。

您可以通过`1`在随机化中添加最少的来解决此问题：

```
SELECT ArrivalDate, DATEADD(day, 1 + RAND(checksum(NEWID()))*1.5
* LengthOfStay.LengthofStay, ArrivalDate) AS DepartureDate    
FROM Bookings, LengthOfStay
ORDER BY ArrivalDate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:39:11.317

试试这个查询

```
SELECT * FROM
    (
      SELECT 
          ArrivalDate, 
          DATEADD(day, RAND(checksum(NEWID()))*1.5   * LengthOfStay.LengthofStay, ArrivalDate) AS DepartureDate    
      FROM   
          Bookings, LengthOfStay
    ) a
WHERE a.DepartureDate > a.ArrivalDate
ORDER BY a.ArrivalDate 
```

# php - 如何在具有从 mysql_fetch_array 获取的数据的列中插入行？

> ID：14962548
> 
> 赞同：0
> 
> 时间：2013-02-19T16:32:18.377
> 
> 标签：php, mysql, sql, sql-insert

我有 2 张桌子：STD 和 SMS。我需要做的是从表 STD 中选择将结果复制到数组中，然后将数组的每个元素插入到另一个表 SMS 中。

这是我的代码：

```
$query=mysql_query("Select from STD WHEre <my conditions>");
$result=mysql_fetch_array($query)
foreach($result as $value)
mysql_query("INSERT INTO SMS set SMS.column='$value'") 
```

它根本不更新 SMS 表。这里有人可以有更好的主意或告诉我代码有什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:44:55.447

试试这个，**但这会像您的实际查询一样更新表的所有值**：

```
 $query=mysql_query("Update SMS set 
    SMS.column=(Select <column_name> from STD where <my conditions> limit 1)"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:45:15.897

你关于更新或插入数据？如果您想插入[用户 JW 已经回答](https://stackoverflow.com/a/14962602/1880351)，否则您必须在更新查询上设置条件。

```
$query=mysql_query("Select from STD WHEre <my conditions>");
$result=mysql_fetch_array($query)
foreach($result as $value)
mysql_query("Update SMS set SMS.column='$value' where SMS.std_id = '{$value['id']}'"); /// fieldnames are my example, You must generate Your condition.. 
```

或者您可以使用[另一个表中的更新](https://stackoverflow.com/a/6935776/1880351)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:44:41.607

我假设您正在尝试从`STD`表中获取所有行并将它们插入`SMS`表中，并且表定义与`SMS`表定义相同`STD`？

如果是这样，这应该工作：

```
$result = mysql_query('SELECT * FROM `STD` WHERE <my_conditions>');
while (($row = mysql_fetch_assoc($result)) !== FALSE) // Loop over all rows selected
{
  $columns = implode(', ', array_keys($row)); // returns string of column names e.g. "col1, col2, col3" etc.
  $values = "'" . implode("', '", array_values($row)) . "'"; // returns string of quoted values e.g. "'val1', 'val2', 'val3'"
  mysql_query("INSERT INTO `SMS` ($columns) VALUES ($values)"); // inserts the row into the SMS database table
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:34:28.397

你可以在一个查询中做到这一点，使用`INSERT INTO...SELECT`语句。

```
INSERT INTO SMS (col1, col2, ...., Coll3)
SELECT col1, col2, ...., Coll3
FROM STD 
```

# xcode - 分享 xcode 项目

> ID：14962551
> 
> 赞同：4
> 
> 时间：2013-02-19T16:32:25.670
> 
> 标签：xcode, macos, file-sharing, code-sharing

我搜索了这个，但我没有找到我正在寻找的确切答案。我正在尝试通过电子邮件向朋友/同事发送我正在处理的已保存 xcode 项目。如果我在他打开电子邮件时将保存的文件附加到电子邮件中，那么一切都有点红色，并且没有代码或任何东西。我如何发送整个项目以便他可以访问它？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T16:49:32.710

听起来您只是向他发送 Xcode 项目文件，但您将需要所有源文件。

如果您假设您的项目位于：

```
/Users/me/Projects/MyDeadGoodProject/
    MyDeadGoodProject                     (folder with source)
    MyDeadGoodProject.xcodeproj           (project bundle) 
```

（这是相当标准的）

然后你需要发送整个顶层项目目录结构。

这最好通过压缩整个批次来完成，这可以通过右键单击并选择“Compress MyDeadGoodProject”或从命令行（Terminal.app）使用*Finder*`zip`来完成：

```
$ cd ~/Projects
$ zip -r9 MyDeadGoodProject.zip MyDeadGoodProject 
```

然后将 .zip 文件通过电子邮件发送给他。

如果您在常规基础上与其他人合作，那么最好让一些中央 git 托管运行，因为这将更**容易**管理。

# c# - Windows phone 8 按钮样式

> ID：14962554
> 
> 赞同：0
> 
> 时间：2013-02-19T16:32:29.627
> 
> 标签：c#, wpf, silverlight, windows-phone

我想为我的按钮创建一种新样式`Blend`：

```
<Style x:Key="ButtonStyle1" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="BorderThickness" Value="{StaticResource PhoneBorderThickness}"/>
        <Setter Property="FontFamily" Value="{StaticResource PhoneFontFamilySemiBold}"/>
        <Setter Property="FontSize" Value="{StaticResource PhoneFontSizeMedium}"/>
        <Setter Property="Padding" Value="10,5,10,6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid Background="Transparent">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentContainer">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneButtonBasePressedForegroundBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="ButtonBackground">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <ImageBrush ImageSource="favouritesBWIcon@2x.png" Stretch="Uniform"/>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentContainer">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneDisabledBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="BorderBrush" Storyboard.TargetName="ButtonBackground">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="ButtonBackground">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates"/>
                        </VisualStateManager.VisualStateGroups>
                        <Border x:Name="ButtonBackground" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="0" Margin="{StaticResource PhoneTouchTargetOverhang}">
                            <ContentControl x:Name="ContentContainer" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Padding="{TemplateBinding Padding}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

如您所见`<VisualState x:Name="Pressed">`，我希望画笔背景将是具有一点不透明度的原始图像，它将是我想要的所有按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-19T03:54:00.507

仅更改您的 VisualState “按下”：

```
<VisualState x:Name="Pressed">
  <Storyboard>
    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Opacity" Storyboard.TargetName="ButtonBackground">
      <DiscreteObjectKeyFrame KeyTime="0" Value="0.4"/>
    </ObjectAnimationUsingKeyFrames>
  </Storyboard>
</VisualState> 
```

# ios - 使用 facebook 3.1 SDK 从 ios 应用程序在 facebook 上发布状态

> ID：14962565
> 
> 赞同：1
> 
> 时间：2013-02-19T16:32:43.157
> 
> 标签：ios, objective-c, facebook, facebook-graph-api

我正在为一个 iOS 应用程序工作，我想集成 Facebook sdk 3.1 以在 facebook 上发布状态，但我真的不知道该怎么做。任何人都可以为我提供简单教程的链接或如何操作的分步方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:51:44.997

要设置您的 Xcode 项目，请阅读[Facebook 开发者网站](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)上的说明。

您可以使用创建/打开会话`[FBSession openActiveSessionWithAllowLoginUI:YES];`

要发布到您的时间线，您需要使用写入权限进行授权：

```
[[FBSession activeSession] reauthorizeWithPublishPermissions:@[ @"publish_stream" ] defaultAudience:FBSessionDefaultAudienceEveryone completionHandler:^(FBSession *authSession, NSError *authError) {

    // If auth was successful, create a status update FBRequest
    if (!authError) {
        FBRequest *postRequest = [FBRequest requestForPostStatusUpdate:@"Hello, world!"];

        [postRequest startWithCompletionHandler:^(FBRequestConnection *connection, id result, NSError *error) {

             // TODO: Check for success / failure here

         }];
    }

}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:39:08.980

试试这个：

```
 [FBRequestConnection startForPostStatusUpdate:@"I've been through the storm, future, present and past.. Light as a feather, swift as a cat.. Clickety clack, clickety clack!!" completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
        NSLog(@"posted");
    }]; 
```

希望这可以帮助。

# bash - 在别名中使用 xargs 以交互方式删除 svn 未版本控制的文件？

> ID：14962569
> 
> 赞同：0
> 
> 时间：2013-02-19T16:32:50.297
> 
> 标签：bash, xargs

我正在尝试创建一个 bash 别名以交互方式删除所有 svn 未版本控制的文件。我已经做到了

```
svn st | grep '^\?'| sed 's/^?       //' 
```

获取此类文件的列表。输入 xargs -p rm 只会给我一个所有文件的提示，例如

`rm fileA fileB fileC fileD ?...`

而我想单独确认每个文件。在命令行上，我可以做

```
rm -i $(svn st | grep '^\?'| sed 's/^?       //') 
```

获得所需的行为，但是当我将它粘贴在别名或函数中时它不起作用。

# c# - 优先级队列的工作线程性能缓慢

> ID：14962576
> 
> 赞同：2
> 
> 时间：2013-02-19T16:33:14.463
> 
> 标签：c#, priority-queue, worker-thread, pairing-heap

当我注意到在更多线程上使用独立优先级队列实际上会降低性能时，我试图使用工作线程来加速更大的算法。所以我写了一个小测试用例。

在其中我查询要启动多少个线程，将每个线程设置为自己的处理器，并从我的优先级队列中推送和弹出很多东西。每个线程都拥有自己的优先级队列，它们是单独分配的，所以我不怀疑错误共享。

我把测试用例放在[这里](http://pastie.org/6226061)，因为它比一个片段长。（处理器亲和位来自[NCrunch](http://blog.ncrunch.net/post/How-to-set-a-threads-processor-affinity-in-NET.aspx)）

优先级队列是我自己创建的，因为 .NET 没有内置队列。如果这有什么不同，它会使用[配对堆。](http://en.wikipedia.org/wiki/Pairing_heap)

无论如何，如果我用一个线程和一个核心运行程序，它的使用率大约是 100%。 ![一芯](../Images/d6e861b87dc66b45e4e42bec756e4bc4.png) 两个线程/两个内核的使用率下降 ![两个核心](../Images/099c89b8da007ec5d617d1704ef0dcfd.png) 最终所有 8 个内核的使用率下降到 30%。 ![八核](../Images/bcb1b93fa8ee45f24b4394b29199f404.png)

这是一个问题，因为性能下降抵消了多线程带来的任何好处。是什么导致性能下降？每个队列完全独立于其他线程的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:38:51.910

解决 pi 等一些问题更适合并行化，而超线程实际上可以加快速度。当您处理像您这样的严重内存问题时，超线程无济于事，实际上可能会造成伤害。查看 CPU 架构中的“流水线”。

没有多少实际问题可以通过使用 2-cpus 获得 2 倍的加速。cpu 越多，开销越大。在您的测试用例算法中，我怀疑内核必须等待内存子系统。如果您调整内存需求，您将看到性能（和利用率）的提高，因为您将内存需求移近 CPU 缓存大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:55:23.060

操作系统正在将处理分配给它想要的任何 CPU。因此，您会看到每个处理器都在做一些工作。

此外，当您说“性能下降”时，您是否检查过系统正在创建多少争用？您可能也在减轻线程之间的争用。

# java - 使用 Gson 反序列化 JSON 数据

> ID：14962577
> 
> 赞同：1
> 
> 时间：2013-02-19T16:33:14.280
> 
> 标签：java, json, deserialization, gson

我试图反序列化包含 GeoJSON 字符串的 JSON 字符串。

```
point: {
    type: "Point",
    coordinates: [
        7.779259,
        52.21864
    ]
} 
```

我要创建的对象是类型

```
com.vividsolutions.jts.geom.Point 
```

我们使用这个类是因为使用 PostGis 数据库存储空间数据。不幸的是，该类没有需要的非参数构造函数。但不知何故，它也实现了 CoordinateSequence [CoordinateSequence](http://www.vividsolutions.com/jts/javadoc/com/vividsolutions/jts/geom/CoordinateSequence.html)，它既没有非参数构造函数。每当我尝试反序列化传入的 json 字符串时，都会出现错误

```
java.lang.RuntimeException: Unable to invoke no-args constructor for 
interface com.vividsolutions.jts.geom.CoordinateSequence. 
Register an InstanceCreator with Gson for this type may fix this problem. 
```

我尝试按照[此处](http://google-gson.googlecode.com/svn/tags/1.2.3/docs/javadocs/com/google/gson/InstanceCreator.html)的示例为 CoordinateSequence 的接口创建一个 InstanceCreator，但没有成功。子类化 Point 也没有带来答案，因为问题在于使用的 CoordinateSequence 接口。

我会感谢任何帮助或提示，这会引导我找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:00:19.190

我们使用自定义 JsonDeserializer 解决了它。当然，这只是一个快速而肮脏的解决方案。应该检查其他类型和错误。但这应该给出一个想法。

```
public class GeometryDeserializer implements JsonDeserializer<Geometry> {

@Override
public Geometry deserialize(JsonElement json, Type typeofT,
        JsonDeserializationContext context) throws JsonParseException {

    String type = json.getAsJsonObject().get("type").toString();

    JsonArray coordinates = json.getAsJsonObject().getAsJsonArray("coordinates");

    GeometryFactory geometryFactory = JTSFactoryFinder.getGeometryFactory(null);
    Coordinate coord = new Coordinate(coordinates.get(0).getAsDouble(), coordinates.get(1).getAsDouble());
    Geometry point = geometryFactory.createPoint(coord);

    return point;
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:39:10.947

我假设该课程来自您无法更改的库。您是否尝试对类进行子类化并在子类中放置一个无参数构造函数只是为了帮助序列化过程？我以前做过，并取得了一些成功。

```
// .... content I cant change.
public class LibraryPOJOClass {
  public LibraryPOJOClass(final int id) { 
    // ...
  }
}

public class MyLibraryPojoClass extends LibraryPOJOClass {
  MyLibraryPojoClass() {
    super(0); // I will change this later, with reflection if need be. 
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T18:54:20.960

做服务器端：

```
SELECT ST_GeomFromGeoJSON('{"type":"Point","coordinates":[7.779259,52.21864]}'); 
```

[注意：问题中提供的示例看起来与The GeoJSON Format Specification](http://www.geojson.org/geojson-spec.html)略有不同。

# jquery - Jquery 十六进制颜色选择和替换

> ID：14962581
> 
> 赞同：0
> 
> 时间：2013-02-19T16:33:25.040
> 
> 标签：jquery, css

这是我需要使用 jquery 来查找和替换表中的某些背景颜色的问题。

```
<table>
<tr bgcolor="#9BB9FB"><td>contect</td></tr>
<tr bgcolor="#cccccc"><td>contect</td></tr>
</table> 
```

我目前正在使用这个 jauery 声明：

```
 <script type="text/javascript" >
 $(document).ready(function() {

 $('*').filter(function() {
 var match = 'rgb(155, 185, 251)';
 return ( $(this).css('background-color') == match );
 }).css('background-color', '#E6B8B7'); 

 }); 
```

但我需要搜索#color 而不是 rgb。另外我需要寻找几种不同的颜色并分别改变它们的颜色。

任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:40:25.273

我不明白你为什么需要过滤器，但如果你使用 jQuery，你可以使用属性选择器进行选择：

```
$('tr[bgcolor="#9BB9FB"]').attr('bgcolor','#000000'); 
```

无需其他代码，冲洗并重复 :)

**编辑：** IE 兼容性需要在属性选择器值周围加上引号

# wpf - WPF 设计器异常；“已添加具有相同密钥的项目”

> ID：14962588
> 
> 赞同：4
> 
> 时间：2013-02-19T16:33:52.907
> 
> 标签：wpf, visual-studio-2010, exception, fonts, designer

我正在开发一个使用 WPF 的应用程序。在设计器中，每当我在“属性”窗口打开并展开“文本”部分时选择标签对象时，设计器会在一秒钟内消失并被一个无模式的错误对话框替换：

> (X) 发生了未处理的异常
> 
> 单击此处重新加载设计器
> 
> 细节：
> 
> > System.ArgumentException
> > 
> > 已添加具有相同密钥的项目
> > 
> > *   在 System.ThrowHelper.ThrowArgumentException（ExceptionResource 资源）
> > *   在 System.Collections.Generic.Dictionary`2.Insert(...)
> > *   在 MS.Internal.FontFace.PhysicalFontFamily.ConvertDictionary(...)

我很确定其余部分无关紧要。

我仍在开发代码；它甚至没有运行。VS Designer 的代码中发生异常。

显然我的一种字体有问题。我怎样才能解决这个问题？

**编辑**我们已经尝试停止与字体相关的服务并清除字体缓存。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-03-12T11:30:41.757

**（解决了）**

经过数小时的调试终于找到了解决方案。

我安装了 Visual Studio 2015 Preview，当我尝试打开 XAML 文件时出现错误：

> System.ArgumentException
> 
> 已添加具有相同密钥的项目
> 
> 在 System.ThrowHelper.ThrowArgumentException(ExceptionResource Resource) 在 System.Collections.Generic.Dictionary`2.Insert(...) 在 MS.Internal.FontFace.PhysicalFontFamily.ConvertDictionary(...)

这个错误没有多大帮助。所以我创建了一个本地帐户并使用该新帐户登录。然后我收到一条消息

> 您的计算机上有一个名为 C:\Program 的文件或文件夹，它会导致某些应用程序无法正常运行。将其重命名为 C:\Program1 将解决此问题。您现在要重命名它吗？

一旦我删除了该文件，XAML 文件似乎正在工作。

所以检查你的 C:\ 如果有什么不同。确保您还检查了所有隐藏文件。

# http - 上传内容时 HTTP 请求中的 Content-Type 值是什么？

> ID：14962592
> 
> 赞同：35
> 
> 时间：2013-02-19T16:33:56.553
> 
> 标签：http, http-upload

我需要从 http-trafic 中提取上传。怎么可能这样做？首先，请求方法将是 POST。其次，会有一个 Content-Type 头域。我不想提取公式数据，而是像邮件附件一样上传。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-19T16:52:36.643

内容类型[符合规范](http://www.faqs.org/rfcs/rfc2388.html) `multipart/form-data`。

这是一种特殊的内容类型，可以在一个大请求中可视化为多个子请求。这些子请求中的每一个（一个表单数据元素）都有自己的一组标题。实际数据的内容类型在那里。

这是一个使用 1 个普通字段和 1 个文件字段的示例（在 HTML 术语中，使用 时`<input name="textfield"><input type="file" name="filefield">`）：

```
Content-Type: multipart/form-data;boundary=SOME_BOUNDARY

--SOME_BOUNDARY
content-disposition: form-data;name="textfield"
content-type: text/plain;charset=UTF-8

value of textfield here
--SOME_BOUNDARY
content-disposition: form-data;name="filefield";filename="some.ext"
content-type: application/octet-stream

binary file content here

--SOME_BOUNDARY-- 
```

至于解析和提取这些数据，几乎每种编程语言都有内置/第三方 API。由于您没有说明您使用的是哪一个，因此不可能给出有针对性的答案。例如，在 Java 的情况下，可以是第三方库 Apache Commons FileUpload，或者当您使用 API 提供的`request.getPart()`方法 Servlet 3.0 时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-22T09:34:32.870

如果（我绝不是说这是正确的方法）您只想从字节数组中保存数据，您应该查看如何读取 POST 正文： [Reading POST body with bottle.py](https://stackoverflow.com/questions/14988887/reading-post-body-with-bottle-py) Reading the data and then创建一个新文件应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-17T05:59:25.230

基于@BalusC 的解决方案，我为.NET 的内置WebClient 类做了一个小扩展方法，它不支持开箱即用的Multipart 上传。

### 用法

只需混合字符串值和文件（用#括起来）

```
 public void UploadMultipart()
    {
        var fileName = "/some/existing/file.ext";
        using (var client = new WebClient())
        {
            var values = new NameValueCollection();
            values.Add("id", Guid.NewGuid().ToString());
            values.Add("name", Path.GetFileNameWithoutExtension(fileName));
            values.Add("file", $"#{fileName}#");

            var result = client.UploadMultipart(address, method, values);
            var content = client.Encoding.GetString(result);
        }
    } 
```

### 扩展方法

```
 public static byte[] UploadMultipart(this WebClient client,
        string address, string method, NameValueCollection values)
    {

        string boundary = DateTime.Now.Ticks.ToString("x");

        client.Headers.Add("Content-Type", "multipart/form-data; boundary=" + boundary);

        var sb = new StringBuilder()
            .AppendLine();

        foreach (var key in values.AllKeys)
        {
            var contentDispositon = $"form-data;name=\"{key}\"";
            var contentType = $"text/plain;charset={client.Encoding.WebName}";

            var value = values[key];

            if (value.StartsWith("#") && value.EndsWith("#"))
            {
                // if a value is enclosed in hashes we expect this to be a path to a file
                // file=#/path/to/file.ext#
                var fileName = value.Trim('#');
                var file = File.ReadAllBytes(fileName);
                value = client.Encoding.GetString(file);

                contentType = "application/octet-stream";
                contentDispositon = $"form-data;name=\"{key}\"filename=\"{Path.GetFileName(fileName)}\"";
            }

            sb.AppendLine($"--{boundary}")
              .AppendLine($"Content-Disposition: {contentDispositon}")
              .AppendLine($"Content-Type: {contentType}")
              .AppendLine()
              .AppendLine(value);
        }

        sb.AppendLine($"--{boundary}--");

        var data = client.Encoding.GetBytes(sb.ToString());

        return client.UploadData(address, method, data);

    } 
```

# opencl - OpenCL 从私有减少到本地然后是全局？

> ID：14962597
> 
> 赞同：1
> 
> 时间：2013-02-19T16:34:08.117
> 
> 标签：opencl, gpu, gpgpu, reduction, amd-processor

下面的内核计算声压场，每个线程计算它自己的`pressure`向量私有实例，然后需要将其汇总到全局内存中。我很确定计算`pressure`向量的代码是正确的，但我仍然无法让它产生预期的结果。

```
int gid       = get_global_id(0);
int lid       = get_local_id(0);
int nGroups   = get_num_groups(0);
int groupSize = get_local_size(0);
int groupID   = get_group_id(0);

/* Each workitem gets private storage for the pressure field.
 * The private instances are then summed into local storage at the end.*/
private float2    pressure[HYD_DIM_TOTAL];
local   float2    pressure_local[HYD_DIM_TOTAL];

/* Code which computes value of 'pressure' */

//wait for all workgroups to finish accessing any memory
barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);

/// sum all results in a workgroup into local buffer:
for(i=0; i<groupSize; i++){

    //each thread sums its own private instance into the local buffer
    if (i == lid){
        for(iHyd=0; iHyd<HYD_DIM_TOTAL; iHyd++){
            pressure_local[iHyd] += pressure[iHyd];
        }
    }
    //make sure all threads in workgroup get updated values of the local buffer
    barrier(CLK_LOCAL_MEM_FENCE);
}

/// copy all the results into global storage
//1st thread in each workgroup writes the group's local buffer to global memory
if(lid == 0){
    for(iHyd=0; iHyd<HYD_DIM_TOTAL; iHyd++){
        pressure_global[groupID +nGroups*iHyd] = pressure_local[iHyd];
    }
}

barrier(CLK_GLOBAL_MEM_FENCE);

/// sum the various instances in global memory into a single one
// 1st thread sums global instances
if(gid == 0){

    for(iGroup=1; iGroup<nGroups; iGroup++){

        //we only need to sum the results from the 1st group onward
        for(iHyd=0; iHyd<HYD_DIM_TOTAL; iHyd++){

            pressure_global[iHyd] += pressure_global[iGroup*HYD_DIM_TOTAL +iHyd];
            barrier(CLK_GLOBAL_MEM_FENCE);
        }
    }
} 
```

关于数据维度的一些注意事项： 线程总数将在 100 到 2000 之间变化，但有时可能超出此区间。
`groupSize`将取决于硬件，但我目前使用的值介于 1(cpu) 和 32(gpu) 之间。
`HYD_DIM_TOTAL`在编译时已知并且在 4 到 32 之间变化（通常但不一定是 2 的幂）。

这个缩减代码有什么明显的错误吗？

PS：我在带有 AMD APP SDK 2.8 的 i7 3930k 和 NVIDIA GTX580 上运行它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:46:40.693

我注意到这里有两个问题，一个大，一个小：

*   此代码表明您对障碍的作用存在误解。屏障永远不会跨多个工作组同步。它仅在工作组内同步。CLK_GLOBAL_MEM_FENCE 使它看起来像是全局同步，但实际上并非如此。该标志只是屏蔽了当前工作项对全局内存的所有访问。因此，在带有此标志的屏障之后，未完成的写入将是全局可观察的。但它不会改变屏障的同步行为，这只是在工作组的范围内。除了启动另一个 NDRange 或任务之外，OpenCL 中没有全局同步。
*   第一个 for 循环导致多个工作项覆盖彼此的计算。使用 iHyd 对 pressure_local 的索引将由具有相同 iHyd 的每个工作项完成。这将产生不确定的结果。

希望这可以帮助。

# perl - Perl while 循环不起作用

> ID：14962606
> 
> 赞同：-2
> 
> 时间：2013-02-19T16:34:34.103
> 
> 标签：perl, loops, while-loop

如果在之前的讨论中已经回答了这个问题，我对 perl 很陌生，并且很抱歉。我有一个脚本需要在循环外使用声明的变量，但只有一个循环在工作，即使我已经在循环外声明了变量，代码是：

```
my $sample;
open(IN, 'ls /*_R1_*.gz |');
while (my $sample = <IN>) {
    chomp $sample;
    print "sample = $sample\n";
    my $fastq1="${sample}"; #need to use fastq1 later on hence it's declared here

    my $sample2;
    open(IN, 'ls /*_R2_*.gz |');
    while (my $sample2 = <IN>) {
        chomp $sample2;
        print "sample2 = $sample2\n";
        my $fastq2="${sample2}"; #need to use fastq2 later on hence it's declared here
    }
} 
```

Sample2 有效，但 sample1 无效，仅输出第一个样本，然后循环进入 sample2，输出为：

```
sample =/sample1_R1_001.fastq.gz
sample2 =/sample1_R2_001.fastq.gz
sample2 =/sample2_R2_001.fastq.gz
sample2 =/sample3_R2_001.fastq.gz 
```

ETC..

任何人都可以解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:00:07.557

根据您的评论，我认为您的问题可能是您声明`$fastq1`并`$fastq2`在循环内。这意味着它们将超出循环之外的范围，并且无法访问。你需要类似的东西：

```
my ($fastq1, $fastq2);
while ( ... ) {
    ....
    $fastq1 = $sample;
} 
```

请注意，这只会保存该变量循环中的最后一个值。其他的当然会在每个循环迭代中被覆盖。如果您有更多值要保存，请使用数组或散列。

关于您的代码的其他一些注释。

* * *

您应该始终使用

```
use strict;
use warnings; 
```

不这样做是一个非常糟糕的主意，因为它只会隐藏错误和警告，而不是解决它们。

* * *

```
my $sample; 
```

您声明此变量两次。

* * *

```
open(IN, 'ls /*_R1_*.gz |'); 
```

这在所有可能的层面上都是糟糕的：

*   除非没有替代方案，否则系统调用始终是最不理想的选择
*   Perl 有*多种*读取文件名的方法
*   解析的输出`ls`很脆弱且不可移植
*   通过 open 管道系统命令的结果加剧了这种方法的其他缺陷。

推荐的解决方案：使用 opendir + readdir 或 glob：

```
for my $files (</*_R1_*.gz>) { ... }
# or
opendir my $dh, "/" or die $!;
while (my file = readdir $dh) { 
    next unless $file =~ /_R1_.*\.gz$/;
    ...
} 
```

* * *

```
my $fastq1 = "${sample}"; 
```

*   您不需要引用变量。也不使用支撑花括号。
*   在循环内声明变量时`my`，它只保留单循环迭代的值。由于您从不使用此变量，因此我假设您打算在循环之外使用它。但这将超出范围。

这个可以写

```
my $fastq1 = $sample; 
```

但是您可能想在 while 循环之外声明这些变量，否则它们将超出范围。当然，您应该知道这只会保存这些变量的最后一个值。

* * *

此外，正如 Rohit 所说，您的循环是嵌套的，我认为这不是您想要的。这很可能是因为您没有使用适当的文本编辑器来编写代码，因此您的缩进全都搞砸了，而且很难看到一个循环在哪里结束。听从 Rohit 的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:36:33.220

您将在第二个 while 循环结束后关闭第一个 while 循环。因此，您的第二个 while 循环成为您的第一个 while 循环的一部分，其中，您将*文件处理程序 - IN*重新分配给不同的文件。而且由于您在内部 while 循环中耗尽了它，因此您的外部 while 循环永远不会再次运行。

在开始下一个 while 之前，您应该关闭大括号：

```
while(my $sample = <IN>){
    chomp $sample;
    print "sample = $sample\n";
    my $fastq1="${sample}";
}  # You need this

my $sample2;
open(IN, 'ls /data_n2/vmistry/Fluidigm_Exome/300bp_fastq/*_R2_*.gz |');
while(my $sample2 = <IN>){
    chomp $sample2;
    print "sample2 = $sample2\n";
    my $fastq2="${sample2}";

}
# }  # Remove this 
```

# c# - 如何将项目中的文件作为流打开？

> ID：14962608
> 
> 赞同：2
> 
> 时间：2013-02-19T16:34:48.070
> 
> 标签：c#, windows-8, resources, xna, monogame

我的项目中有一组文本文件，其中包含我想作为流加载并在 XNA 中读取的关卡信息。我正在使用 MonoGame XNA 并针对 Windows RT。假设我想将 /Content/Levels/Level1.txt 作为流打开。我该怎么做？

在使用 C# 的其他一些平台上，我会将文件的构建操作设置为资源和使用

```
Application.GetResourceStream 
```

但这在 XNA 中不可用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:01:30.293

XNA 游戏中有两种存储：Title Storage 和 User Storage。请参阅[什么是存储？](http://msdn.microsoft.com/en-us/library/bb200105.aspx) 要从 Title Storage 读取数据，请使用[TitleContainer.OpenStream](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.titlecontainer.openstream.aspx)，如[本例所示](http://msdn.microsoft.com/en-us/library/bb199094.aspx)。

# javascript - jquery 将先前的输入设置为 0

> ID：14962611
> 
> 赞同：0
> 
> 时间：2013-02-19T16:34:52.713
> 
> 标签：javascript, jquery

我在 5 个输入和一个下拉列表的末尾有一个复选框。我正在尝试通过 jquery 将复选框之前的所有输入和下拉列表设置为 0。

将列出许多员工，因此只能是复选框之前的员工。

我对 jquery 的微弱尝试。我有 .on 因为有时它会通过 ajax 调用

```
$(document).ready(function () {

    $(document).on('click', '.fasCheck', function(){

    if ($(this).attr("checked") == "checked"){
        $(this).prev().parent().prev(".payWeek").next('input').prop('checked', true);;
    } else {

    }
    });     

}); 
```

的HTML：

```
<div class="returns" id="employee">
<h3>David Wilson</h3>
<div class="payWeek">
        <label for="MonthlyReturn0PayWeek1">Pay Week1</label>
        <input type="number" id="MonthlyReturn0PayWeek1" value="" maxlength="12" step="any" name="data[MonthlyReturn][0][pay_week1]">
    </div>
   <div class="payWeek">
        <label for="MonthlyReturn0PayWeek2">Pay Week2</label>
        <input type="number" id="MonthlyReturn0PayWeek2" value="" maxlength="12" step="any" name="data[MonthlyReturn][0][pay_week2]">
   </div>
   <div class="payWeek">
        <label for="MonthlyReturn0PayWeek3">Pay Week3</label>
        <input type="number" id="MonthlyReturn0PayWeek3" value="" maxlength="12" step="any" name="data[MonthlyReturn][0][pay_week3]">
   </div>
   <div class="payWeek">
        <label for="MonthlyReturn0PayWeek4">Pay Week4</label>
        <input type="number" id="MonthlyReturn0PayWeek4" value="" maxlength="12" step="any" name="data[MonthlyReturn][0][pay_week4]">
    </div>
    <div class="payWeek">
         <label for="MonthlyReturn0PayWeek5">Pay Week5</label>
         <input type="number" id="MonthlyReturn0PayWeek5" value="" maxlength="12" step="any" name="data[MonthlyReturn][0][pay_week5]">
     </div>
     <div class="payWeek">
          <label for="MonthlyReturn0PayWeeks">Pay Weeks</label>
          <select id="MonthlyReturn0PayWeeks" name="data[MonthlyReturn][0][pay_weeks]">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option selected="selected" value="4">4</option>
                <option value="5">5</option>
           </select>
      </div>                        
      <div class="payWeek">
           <label for="FAS">FAS</label>
           <input type="checkbox" class="fasCheck" name="FAS">
      </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:43:26.583

*   `$(this).attr("checked") == "checked"`行不通，你已经知道使用`.prop()`. 或者只使用`this.cecked`没有任何 jQuery。
*   `.prev().parent()`-`prev`绝对没有必要，所有兄弟姐妹都有相同的父节点。
*   `.prev(".payWeek")`- 好像你想[`.prevAll()`](http://api.jquery.com/prevAll/)改用。
*   `.next('input')`- 你不想找到下一个兄弟姐妹，而是一个后代。使用[`.children()`](http://api.jquery.com/children/)或[`.find()`](http://api.jquery.com/find/)。
*   `.prop('checked')`- 虽然适用于复选框，但您在这里有数字输入，需要`value`通过[`.val()`](http://api.jquery.com/val/).

所以改成

```
$(document).ready(function() {
    $(document).on('click', '.fasCheck', function() {
        if (this.checked) {
            $(this)
              .parent()
              .prevAll(".payWeek")
              .find('input')
              .val('0');
        }
    });     
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:44:03.463

从单击的复选框中，找到最接近的`payWeek`，然后选择所有先前`payWeeks`的 ，并找到其中的所有输入`payWeeks`并将值设置为零：

```
$(document).ready(function () {
    $(document).on('click', '.fasCheck', function(){
        if ( this.checked ) {
            $(this).closest('.payWeek')
                   .prevAll('.payWeek')
                   .find('input')
                   .val('0');
        } else {

        }
    });     
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:45:20.890

```
$(document).on('click', '.fasCheck', function(){

    var $this = $(this),
        $parent = $(this).parents('.returns').eq(0),
        $inputs = $parent.find('input');

    if ($this.prop("checked")){
        $inputs.val('0');
    } 
}); 
```

# python - 将 QML 元素锚定到窗口

> ID：14962613
> 
> 赞同：1
> 
> 时间：2013-02-19T16:34:57.737
> 
> 标签：python, qt4, pyqt4, qml

我对 QML 真的很陌生，我正在努力在 QML 中定义基本布局。如何将元素锚定到窗口，以便在用户调整窗口大小时调整大小？我想添加一个填充窗口中所有可用空间的矩形，但我还没有找到从 qml 文件中执行此操作的方法。到目前为止，我发现的所有示例都使用固定宽度和高度，但这意味着当窗口大小发生变化时，元素将保持其预设大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T04:39:35.830

对于您的具体问题：

1.  根据父母（兄弟姐妹）锚定*所有元素。*
2.  始终使您的顶级 qml 元素填充查看器空间，如此[处](http://wiki.meego.com/QML/Full-creen_applications#Configuring_the_viewer.27s_window_size)所述。

* * *

添加到它。每当您需要进行此类调整大小时，您需要从一侧到另一侧通知几何形状的变化。我的意思是，从 qml 到 C++ 或从 C++ 到 qml。

**告诉 qml 在顶部窗口中调整大小：**

您在 qml 中的顶级父元素不会收到有关调整小部件大小的任何信号。您需要手动完成。

1.  要获取顶部小部件实际调整大小的信息，您需要实现[resizeEvent](http://qt-project.org/doc/qt-4.8/qwidget.html#resizeEvent)函数。

2.  每当您的实现被调用时，您需要向 qml 方发出信号，表明发生了一些调整大小，因此顶级 qml 父级也应该自行调整大小。

**告诉 C++ 调整顶部 qml 元素的大小：**

同样，您在 C++ 中的小部件不会收到任何关于调整顶部 qml 元素大小的信号。您需要手动执行此操作：

1.  从 C++ 端向 qml 公开一个类。
2.  每当顶部 qml 元素发生变化时，调用此类的函数来通知此更改，并要求它也调整顶部小部件的大小。

您可以[在此处](http://www.qtcentre.org/threads/21770-resizing-widgets-depending-on-a-main-widget-size)和[此处](https://stackoverflow.com/questions/14418811/qt-quick-main-window-size/14419544#14419544)了解这些方法的基本概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:45:41.627

对此的简单答案是使用

```
Item {
  anchors.fill: parent
} 
```

这相当于

```
Item {
  anchors {
    top: parent.top
    left: parent.left
    right: parent.right
    bottom: parent.bottom
  }
} 
```

其中 parent 是您希望将项目锚定在其中的对象。虽然这通常是父级，但从技术上讲，它可以锚定到任何东西上。

我想补充一点，通常您静态地调整顶级元素的大小，因为使用 qml 应用程序中的默认选项，应用程序窗口的大小将调整为主 qml 文件中根元素的大小。如果您想做一些更棘手的事情，您将需要修改为您的应用程序生成 QDeclarativeView 的 C++。

# performance - 性能 - 在 opengl 中绘制许多 2d 圆圈

> ID：14962614
> 
> 赞同：3
> 
> 时间：2013-02-19T16:34:57.867
> 
> 标签：performance, opengl, gpu, geometry, particles

我正在尝试在 opengl 中为我的 2d 游戏绘制大量的 2d 圆圈。它们的大小相同，质地相同。许多精灵重叠。最快的方法是什么？

[我正在制作的效果示例 http://img805.imageshack.us/img805/6379/circles.png](http://img805.imageshack.us/img805/6379/circles.png)

（需要注意的是，黑边只是由于圆圈的扩大爆炸造成的。截屏后不久就被填充了。

目前我正在使用一对带纹理的三角形来制作每个圆圈。我在纹理边缘周围有透明度，以使其看起来像一个圆圈。事实证明，为此使用混合非常慢（并且 z 剔除是不可能的，因为它们被渲染为深度缓冲区的正方形）。相反，我没有使用混合，而是让我的片段着色器丢弃任何 alpha 为 0 的片段。这有效，但这意味着早期 z 是不可能的（因为片段被丢弃）。

速度受到大量透支和 gpu 填充率的限制。绘制圆圈的顺序并不重要（前提是它不会在创建闪烁的帧之间发生变化），所以我一直在努力确保屏幕上的每个像素只能写入一次。

我通过使用深度缓冲区尝试了这一点。在每一帧开始时，它被清除为 1.0f。然后，当绘制一个圆圈时，它会将深度缓冲区的那部分更改为 0.0f。当通常在那里绘制另一个圆时，它不是因为新圆的 az 也为 0.0f。这不小于深度缓冲区中当前存在的 0.0f，因此它不会被绘制。这有效，并且应该减少必须绘制的像素数量。然而; 奇怪的是它并没有更快。我已经问过一个关于这种行为的问题（[当点具有相同的深度时，opengl 深度缓冲区很慢](https://stackoverflow.com/questions/14949375/opengl-depth-buffer-slow-when-points-have-same-depth/14949763)）并且建议是使用相等的 z 值时 z 剔除没有被加速。

相反，我必须给我所有的圈子从 0 向上分开假 z 值。然后，当我使用 glDrawArrays 和默认值 GL_LESS 进行渲染时，由于 z 剔除，我们正确地获得了速度提升（尽管早期 z 是不可能的，因为碎片被丢弃以使圆圈成为可能）。然而，这并不理想，因为我不得不为 2d 游戏添加大量与 z 相关的代码，而这根本不需要它（如果可能的话，不传递 z 值会更快）。然而，这是我目前找到的最快的方式。

最后我尝试使用模板缓冲区，这里我使用

```
glStencilFunc(GL_EQUAL, 0, 1);
glStencilOp(GL_KEEP, GL_INCR, GL_INCR); 
```

模板缓冲区每帧重置为 0。这个想法是在一个像素被绘制到第一次之后。然后在模板缓冲区中将其更改为非零。然后不应再次绘制该像素，从而减少透支量。然而，事实证明，这并不比仅在没有模板缓冲区或深度缓冲区的情况下绘制所有内容快。

人们发现写我正在尝试的最快方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T18:03:18.060

根本问题是您的*填充受限*，这是 GPU 无法在您期望的时间内对您要求它绘制的所有片段进行着色。您使用深度缓冲技巧无效的原因是处理中最耗时的部分是对片段进行着色（通过您自己的片段着色器或通过固定功能着色引擎），这发生*在*深度之前测试。使用模板也会出现同样的问题；对像素进行着色是在模板制作之前进行的。

有一些事情可能会有所帮助，但它们取决于您的硬件：

*   使用深度缓冲从前到后渲染您的精灵。现代 GPU 通常会尝试确定一组片段是否可见，然后再将它们发送出去进行着色。粗略地说，检查深度缓冲区（或它的表示）以查看即将被着色的片段是否可见，如果不可见，则在该点终止处理。这应该有助于减少需要写入帧缓冲区的像素数量。
*   使用片段着色器立即检查纹素的 alpha 值，并在任何其他处理之前丢弃片段，如：

    ```
    varying vec2 texCoord;
    uniform sampler2D tex;

    void main()
    {
        vec4 texel = texture( tex, texCoord );

        if ( texel.a < 0.01 ) discard;

        // rest of your color computations
    } 
    ```

（您也可以在固定功能片段处理中使用 alpha 测试，但无法确定是否会在片段着色完成之前应用该测试）。

# c# - 使用 NHibernate 从分离的条件中选择别名属性

> ID：14962617
> 
> 赞同：0
> 
> 时间：2013-02-19T16:35:12.697
> 
> 标签：c#, sql-server, nhibernate

我基本上是在尝试在标准中创建这个 sql 查询。sql 查询非常简单，但要使用条件查询来执行此操作，我必须从分离条件中选择一个属性。任何帮助将不胜感激。

```
Select y0_ from 
(
    SELECT distinct TOP (1000) this_.Id as y0_, this_.InstrumentNumber as y1_ 
    FROM [SearchRecorderInstrument] this_ 
    inner join [SearchRecorderName] name1_ on this_.Id=name1_.SearchRecorderInstrument_id 
    inner join [NameType] nt4_ on name1_.NameType_id=nt4_.Id 
    inner join [SearchRecorderPropertyLegal] pl5_ on this_.Id=pl5_.SearchRecorderInstrument_id 
    inner join [DocumentType] dt2_ on this_.DocumentType_id=dt2_.Id 
    inner join [DocumentCategory] dc3_ on dt2_.DocumentCategory_id=dc3_.Id 
    WHERE name1_.FIPSCode = '26049' and name1_.LastName like 'smith%' and not (1=0) 
    ORDER BY this_.InstrumentNumber desc
) [b] 
```

这就是我到目前为止所拥有的：

```
var criteria4 = DetachedCriteria.For(typeof(SearchRecorderInstrument), "instr");

            criteria4.CreateCriteria("instr.Names", "name", NHibernate.SqlCommand.JoinType.InnerJoin);

            criteria4.CreateCriteria("instr.DocumentType", "dt", NHibernate.SqlCommand.JoinType.InnerJoin);

            criteria4.CreateCriteria("dt.DocumentCategory", "dc", NHibernate.SqlCommand.JoinType.InnerJoin);

            criteria4.CreateCriteria("name.NameType", "nt", NHibernate.SqlCommand.JoinType.InnerJoin);

            criteria4.CreateCriteria("instr.PropertyLegals", "pl", NHibernate.SqlCommand.JoinType.InnerJoin);

            criteria4.Add(Expression.Eq("name.FIPSCode", fipsCode));

            criteria4.Add(Expression.Like("name.LastName", lastName, MatchMode.Start));

            if (partyIndicator != null && partyIndicator > 0)
            {
                criteria4.Add(Expression.Eq("name.PartyIndicator", partyIndicator));
            }

            if (firstName != null && firstName != string.Empty)
            {
                criteria4.Add(Expression.Like("name.FirstName", firstName, MatchMode.Start));
            }

            if (beginDate != null)
            {
                criteria4.Add(Expression.Ge("instr.RecordedDate", beginDate.Value));
            }

            if (endDate != null)
            {
                criteria4.Add(Expression.Lt("instr.RecordedDate", endDate.Value.AddDays(1)));
            }

            if (consFrom != null)
            {
                criteria4.Add(Expression.Ge("instr.Consideration", consFrom));
            }

            if (consTo != null)
            {
                criteria4.Add(Expression.Le("instr.Consideration", consTo));
            }

            if (documentTypeIds != null && documentTypeIds.Any())
            {
                disabledDocTypes = documentTypeIds.Where(x => !disabledDocTypes.Contains(x)).ToList();
                criteria4.Add(Expression.In("dt.Id", disabledDocTypes));
            }
            else
            {
                criteria4.Add(Expression.Not(Expression.In("dt.Id", disabledDocTypes)));
            }

            foreach (var item in legalSearchCriteria)
            {
                var val = item.Filter.FilterType.Value;
                switch (val)
                {
                    case "LIKE":
                        criteria.Add(Expression.Like("pl." + item.Filter.Field, item.Value));
                        break;
                    case ">=":
                        criteria.Add(Expression.Ge("pl." + item.Filter.Field, item.Value));
                        break;
                    case "<=":
                        criteria.Add(Expression.Le("pl." + item.Filter.Field, item.Value));
                        break;
                    case "=":
                        criteria.Add(Expression.Eq("pl." + item.Filter.Field, item.Value));
                        break;
                }
            }

            foreach (var item in sortDescriptors)
            {
                if (item.SortDescriptorDirection.ToString() == "ASC")
                {
                    criteria4.AddOrder(Order.Asc(item.ColumnName));
                }
                else
                {
                    criteria4.AddOrder(Order.Desc(item.ColumnName));
                }
            }

            criteria4.SetProjection(
                Projections.ProjectionList()
                .Add(Projections.Distinct(Projections.Property("instr.Id")), "InstrumentId")
                .Add(Projections.Property("instr.InstrumentNumber"), "InstrumentNumber"));

            criteria4.SetFirstResult(skip).SetMaxResults(rowsViewed); 
```

我只需要从此 Detached 查询中选择 InstrumentId。所以到目前为止我已经想出了这样的东西，但我认为这不会奏效：

```
var criteria5 = sess.CreateCriteria<SearchRecorderInstrument>("instr");
            criteria5.Add(Subqueries.Select(criteria4)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:46:07.077

我假设你加入 .CreateCriteria("ForeignCollection")
加入别名可以通过额外的重载 .CreateCriteria("ForeignCollection", "aliasname")

在 Where 部分中，您可以使用“aliasname”，例如“aliasname.Id”（即使这是 DetachedCriteria 中的名称，但您的查询看起来不需要分离条件）

**更新**

我认为您应该考虑在分离标准（即标准4）中仅选择仪器IDS，而不是仪器编号。
接下来，您可以将条件 4 用于子查询，例如：

```
Subqueries.PropertyEq("instr.InstrumentId", criteria4) 
```

其中 instr 是标准 5 中的别名

使用criteria5选择对应的instrumentnumbers

# jquery - 页面加载后加载 Google Visualization API

> ID：14962620
> 
> 赞同：0
> 
> 时间：2013-02-19T16:35:16.553
> 
> 标签：jquery, google-visualization

我正在使用 Google Visualization API 在页面上创建表格。这些表从需要大量时间的查询中获取数据。由于 Google Visualization 的默认行为是调用 API 在页眉中绘制图表，因此会减慢页面加载时间。

我想用临时“加载”图像加载页面，然后在页面完全加载后执行脚本，以便页面感觉更灵敏。有没有办法做到这一点？

我试过使用`jQuery(window).load`，但没有奏效。

**更新：分页表看起来像是这个问题的临时解决方案（例如 table.draw(data, {page: 'enable' ,pageSize: 100})），它绝对不是稳定的解决方案，但它是一些东西，问题是它解决了表格而不是图表的这个问题，所以我将继续我的更新

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T04:47:25.280

`<div>`在您拥有图表的顶部创建一个带有“正在加载”图像的元素`<div>`。在页面加载时显示此元素（启动页面时将默认显示“正在加载”）。

使用表格图表的[`ready`事件](https://developers.google.com/chart/interactive/docs/gallery/table#Events)，您可以创建一个侦听器，该侦听器将在表格可供使用时触发。在这种情况下，您创建了一个函数，`<div>`用 CSS 隐藏“加载”图像，使其不再显示。

[请参阅此处](http://jsfiddle.net/heZUE/)的示例。代码如下：

```
google.load('visualization', '1', {packages: ['table']});
google.setOnLoadCallback(drawVisualization);

function drawVisualization() {
    var dataTable = new google.visualization.DataTable();
    dataTable.addColumn('string', 'Label');
    dataTable.addColumn('number', 'foo');
    dataTable.addColumn('number', 'bar');
    dataTable.addColumn('number', 'caz');
    dataTable.addColumn('number', 'cad');
    for (var i = 0; i < 500; ++i) {
        dataTable.addRow(['Label ' + i, Math.random()*100, Math.random()*100, Math.random()*100, Math.random()*100])
    }

    var table1 = new google.visualization.Table(document.getElementById('table'));

    google.visualization.events.addListener(table1, 'ready', function() {
        document.getElementById('loading').style.display='none';
        alert("Chart is Ready!");
    });

    table1.draw(dataTable, null);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-25T19:56:44.960

解决方案很简单。在 google.load 中调用您的图表渲染函数作为回调。

例如，改变这个：

```
 $(document).ready(function() {
      google.load("visualization", "1", {packages:["corechart"]});
  }); 
```

对此：

```
 $(document).ready(function() {
     google.load("visualization", "1", {packages:["corechart"],"callback":chartRender});
  }); 
```

# javascript - Javascript IE 7 获取 OBJECT 元素

> ID：14962621
> 
> 赞同：0
> 
> 时间：2013-02-19T16:35:20.707
> 
> 标签：javascript, dom

我正在编写一个代码，从页面中删除视频播放器，然后在需要时将其放回原处（即使元素没有 id）。我发现 IE7 的问题这是我的代码：

```
var weboElem, weboElemPar, weboElemIndex, weboStored;
function weboRemoveVideoplayer(vpId){
    weboElem = document.getElementById(vpId);
    if(!weboElem) return false;
    weboElemPar = weboElem.parentNode;
    weboElemIndex = 0;
    var child = weboElem;
    while( (child = child.previousSibling) != null ) 
      weboElemIndex++;
    weboElemPar.removeChild(weboElem);
    return true;
}
function weboPlaceVideoplayerBack(){
    if(weboElemPar.insertBefore !== undefined && weboElemPar.childNodes !== undefined)
    {
        weboElemPar.insertBefore(weboElem, weboElemPar.childNodes[weboElemIndex]);
        return true;
    }
    return false;   
}

var result = document.evaluate(     
    '//*/param[contains(@value, "autoplay=1")]/..', // XPath expression 
    document, // context node
    null, // namespace resolver
    XPathResult.ORDERED_NODE_SNAPSHOT_TYPE
);

if(result.snapshotLength > 0)
{
    var node = result.snapshotItem(0);
    node.id = "webo";
    document.getElementById('info').innerHTML = node.nodeName.toLowerCase()+" -> "+node.id;
} else document.getElementById('info').innerHTML = "not found"; 
```

（请注意 document.evaluate WORKS，因为我导入了 javascript-xpath 库）在 IE7 上，如果 XPath 找到 IFRAME 则没有问题并且它可以工作，但是如果它找到一个 OBJECT 什么都不做并停止，`weboElem = document.getElementById(vpId);`就好像它没有找到 id .

我尝试像这样修改代码：

```
if(result.snapshotLength > 0)
{
    var node = result.snapshotItem(0);
    node.id = "webo";
    node.parentNode.removeChild(node);
    document.getElementById('info').innerHTML = node.nodeName.toLowerCase()+" -> "+node.id;
    if(node.nodeName.toLowerCase() == "object") weboStored = node;
    else weboStored = null;
} else document.getElementById('info').innerHTML = "not found"; 
```

它有效，视频播放器在页面加载时消失。不过我想使用这个函数，所以我编辑了这样的所有内容（将节点存储到一个全局变量中，稍后我会在 weboRemoveVideoplayer 函数中获得）：

```
var weboElem, weboElemPar, weboElemIndex, weboStored;
function weboRemoveVideoplayer(vpId){
    if(!weboStored) weboElem = document.getElementById(vpId);
    else weboElem = weboStored;
    if(!weboElem) return false;
    weboElemPar = weboElem.parentNode;
    weboElemIndex = 0;
    var child = weboElem;
    while( (child = child.previousSibling) != null ) 
      weboElemIndex++;
    weboElemPar.removeChild(weboElem);
    alert("5");
    return true;
}
function weboPlaceVideoplayerBack(){
    if(weboElemPar.insertBefore !== undefined && weboElemPar.childNodes !== undefined)
    {
        weboElemPar.insertBefore(weboElem, weboElemPar.childNodes[weboElemIndex]);
        return true;
    }
    return false;   
}

// bind XPath methods to document and window objects
// NOTE: This will overwrite native XPath implementation if it exists
//XPathJS.bindDomLevel3XPath(); //solo per xpathJs
var result = document.evaluate( 
    '//*/param[contains(@value, "autoplay=1")]/..', // XPath expression 
    document, // context node
    null, // namespace resolver
    XPathResult.ORDERED_NODE_SNAPSHOT_TYPE
);

if(result.snapshotLength > 0)
{
    var node = result.snapshotItem(0);
    node.id = "webo";
    node.parentNode.removeChild(node);
    document.getElementById('info').innerHTML = node.nodeName.toLowerCase()+" -> "+node.id;
    if(node.nodeName.toLowerCase() == "object") weboStored = node;
    else weboStored = null;
} else document.getElementById('info').innerHTML = "not found"; 
```

这样，代码在尝试检索父节点时会自行阻塞。

有人可以建议我在这里做什么吗？

PS：使用 chrome 和 firefox，代码在我发布的第一个版本中完美运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:15:20.733

修复！我通过将 OBJECT 包装在一个带有我选择的 id 的 div 中解决了这个问题，我可以随时检索它。我在 resolveXpath 函数中执行此操作。

这里的代码：

```
var weboElem, weboElemPar, ieObject = false;
var weboElemIndex = 0;
function weboRemoveVideoplayer(vpId){
    var child;      
    if(!ieObject) weboElem = document.getElementById(vpId);
    else weboElem = document.getElementById('my_usage');
    if(!weboElem) return false;
    weboElemPar = weboElem.parentNode;
    weboElemIndex = 0;
    child = weboElem;
    while( (child = child.previousSibling) != null ) weboElemIndex++;
    if(typeof weboElemPar.removeChild !== 'undefined') weboElemPar.removeChild(weboElem);
    else return false;

    return true;
}
function weboPlaceVideoplayerBack(){
    if(typeof weboElemPar.insertBefore !== 'undefined' && typeof weboElemPar.childNodes !== 'undefined' && typeof weboElemPar.appendChild !== 'undefined'){
        if(weboElemPar.childNodes.length > 0 && weboElemIndex < weboElemPar.childNodes.length) weboElemPar.insertBefore(weboElem, weboElemPar.childNodes[weboElemIndex]);
        else weboElemPar.appendChild(weboElem);
        return true;
    }
    return false;   
}
function resolveXpath(path)
{
    //XPathJS.bindDomLevel3XPath(); //solo per xpathJs
    var result = document.evaluate(path,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);      
    if(result.snapshotLength > 0){
        var child, node = result.snapshotItem(0);
        if(node.nodeName.toLowerCase() == 'object'){
            ieObject = true;        
            child = node;
            while( (child = child.previousSibling) != null ) weboElemIndex++;
            var div = document.createElement('div');
            div.id = 'my_usage';        
            if(typeof node.parentNode.insertBefore !== 'undefined' && typeof node.parentNode.childNodes !== 'undefined' && typeof node.parentNode.appendChild !== 'undefined'){
                if(node.parentNode.childNodes.length > 0 && weboElemIndex < node.parentNode.childNodes.length) node.parentNode.insertBefore(div,node.parentNode.childNodes[weboElemIndex]);
                else node.parentNode.appendChild(div);
                div.appendChild(node);
            } else return false;
        } else node.id = 'my_usage';            
        return true;
    } else return false;
}
resolveXpath('//*/param[contains(@src, "autoplay=1")]/..'); 
```

# json - 我的 MVC 控制器如何生成以下格式的 JSON？

> ID：14962629
> 
> 赞同：-1
> 
> 时间：2013-02-19T16:35:42.797
> 
> 标签：json, asp.net-mvc-4, controller, jquery-validation-engine

我正在尝试将[jQuery 验证引擎](http://posabsolute.github.com/jQuery-Validation-Engine/)与我的 MVC 项目集成以执行内联验证。我在 jQuery 表单中有一个字段，它正在调用 MVC 控制器并期望 JSON 响应。根据插件作者写的[这篇文章...](http://www.position-absolute.com/articles/using-form-ajax-validation-with-the-jquery-validation-engine-plugin/)

> 现在这会将 ajax 中的字段发送到定义的 url，并等待响应，响应需要是按照以下语法以 json 编码的数组：**["id1", boolean status]**。
> 
> 所以在 php 中你会这样做： echo json_encode($arrayToJs);

如何在 ASP.NET MVC4 中实现这一点？

我当前的控制器看起来像这样。

```
public JsonResult FunctionName(string fieldValue)
{
        return Json((new { foo = "bar", baz = "Blech" }), JsonRequestBehavior.AllowGet);
} 
```

响应正文显示它返回如下所示的键值对

```
{"foo":"bar","baz":"Blech"} 
```

如何以预期格式返回 JSON？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:12:04.400

方括号表示 JSON 对象中的数组。

见这篇文章：[http ://www.w3schools.com/json/json_syntax.asp](http://www.w3schools.com/json/json_syntax.asp)

此测试代码：

```
return Json(new object[] { "id1", false }, JsonRequestBehavior.AllowGet); 
```

应该返回：

```
["id1",false] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:54:18.023

如果你想在 json 中返回一个数组，我想你会这样做。然后你可以返回一个字典。由于您传入的匿名类型，您现在在 json 输出中看不到数组是两个键值。

```
public JsonResult MyMethodName(string name)
{
    IDictionary<string, bool> myDict = LoadDictionaryFromSomewhere();
    return Json(myDict, JsonRequestBehaviour.AllowGet);
} 
```

# excel - 如果发现错误，使用 VBA 播放声音

> ID：14962631
> 
> 赞同：8
> 
> 时间：2013-02-19T16:35:48.463
> 
> 标签：excel, vba

我目前有这个代码：

```
Option Explicit 

Private Declare Function sndPlaySound32 Lib "winmm.dll" _ 
Alias "sndPlaySoundA" (ByVal lpszSoundName _ 
As String, ByVal uFlags As Long) As Long 

Private Sub Worksheet_Change(ByVal Target As Range) 

Dim Cell            As Range 
Dim CheckRange      As Range 
Dim PlaySound       As Boolean 

Set CheckRange = Range("C:C") 
For Each Cell In CheckRange 
    If Cell.Value = "#N/A" Then 
        PlaySound = True 
    End If 
Next 
If PlaySound Then 
    Call sndPlaySound32("C:\windows\media\chord.wav", 1) 
End If      
End Sub 
```

我正在尝试获取它，以便如果 C 列有错误，则会播放可听见的声音，但是它不起作用，有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T16:41:21.260

你不需要这个 API

你也可以使用`Beep`。

```
Sub Sample()
    Beep
End Sub 
```

**例子**

**方式 1**

如果工作表中的任何地方发生更改，此代码将运行

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell            As Range
    Dim CheckRange      As Range

    Set CheckRange = Range("C:C")

    For Each Cell In CheckRange
        If Cell.Text = "#N/A" Then
            Beep
            Exit For
        End If
    Next
End Sub 
```

**方式 2**

上述代码的替代方案

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell As Range

    For Each Cell In Columns(3)
        On Error Resume Next
        If CVErr(Cell) = CVErr(2042) Then
            Beep
            Exit For
        End If
        On Error GoTo 0
    Next
End Sub 
```

**方式3**

如果您只想在 Col C 的任何位置进行手动更改时才检查 Col C

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell As Range

    If Not Intersect(Target, Columns(3)) Is Nothing Then
        For Each Cell In Columns(3)
            On Error Resume Next
            If CVErr(Cell) = CVErr(2042) Then
                Beep
                Exit For
            End If
            On Error GoTo 0
        Next
    End If
End Sub 
```

**方式4**

如果您想检查特定单元格中是否有手动更改

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell As Range

    If Not Intersect(Target, Columns(3)) Is Nothing Then
        On Error Resume Next
        If CVErr(Target) = CVErr(2042) Then
            Beep
            Exit Sub
        End If
        On Error GoTo 0
    End If
End Sub 
```

**方式 5**

方式4的变化

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell As Range

    If Not Intersect(Target, Columns(3)) Is Nothing Then
        If Target.Text = "#N/A" Then
            Beep
            Exit Sub
        End If
    End If
End Sub 
```

**跟进（发表评论）**

> 活动单元格将在 b 列中，因此它应该在 d 列中检查一个右侧 – Sam Cousins 1 分钟前

我猜你的意思是 Col C 而不是 Col D。你必须使用`Worksheet_SelectionChange`这个

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Not Intersect(Target, Columns(2)) Is Nothing Then
        If Target.Offset(, 1).Text = "#N/A" Then
            Beep
        End If
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T16:41:38.763

只需粘贴以下代码并运行，看看它是否有效......

```
Option Explicit

Private Declare Function sndPlaySound32 Lib "winmm.dll" _
Alias "sndPlaySoundA" (ByVal lpszSoundName _
As String, ByVal uFlags As Long) As Long

Private Sub Worksheet_Change(ByVal Target As Range)

    Dim Cell As Range
    Dim PlaySound As Boolean

    If Target.Column = 3 Then
        For Each Cell In Target
            If WorksheetFunction.IsNA(Cell.Value) Then
                PlaySound = True
            End If
        Next

        If PlaySound Then
            Call sndPlaySound32("C:\windows\media\chord.wav", 1)
        End If

    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:51:29.537

将 Cell.Value 更改为 Cell.Text

如果存在公式错误，则单元格值将类似于错误 2042，但您的 if 语句正在查找文本“#N/A”

我还建议只使用使用过的范围而不是整个列，因为这会减少运行时间。

如果发现错误，您也可以立即退出 for。

使用 Beep 不会让您播放任何声音，但它会发出可听见的声音，并且不需要 API 调用或计算机具有指定的音频文件。

-编辑- 我刚刚测试了下面的代码，它似乎对我来说可以正常工作。

-EDIT2- 更正的代码

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim Cell As Range
    Dim CheckRange As Range

    Set CheckRange = Range(Cells(1, 3), Cells(ActiveSheet.UsedRange.Rows.Count, 3))
    For Each Cell In CheckRange
        If Cell.Text = "#N/A" Then
            Beep
            Exit For
        End If
    Next
End Sub 
```

-EDIT3-原始帖子的工作副本

```
Option Explicit

Private Declare Function sndPlaySound32 Lib "winmm.dll" _
                                        Alias "sndPlaySoundA" (ByVal lpszSoundName _
                                                               As String, ByVal uFlags As Long) As Long

Private Sub Worksheet_Change(ByVal Target As Range)

    Dim Cell As Range
    Dim CheckRange As Range
    Dim PlaySound As Boolean

    Set CheckRange = Range(Cells(1, 3), Cells(ActiveSheet.UsedRange.Rows.Count, 3))
    For Each Cell In CheckRange
        If Cell.Text = "#N/A" Then
            PlaySound = True
            Exit For
        End If
    Next
    If PlaySound Then
        Call sndPlaySound32("C:\windows\media\chord.wav", 1)
    End If
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:38:02.210

尝试替换为`If PlaySound = True Then`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T16:50:28.120

我认为您检查 PlaySound 值的 If 语句应该在您的 For 循环中。您编写它的方式只会在 CheckRange = "#N/A" 中的最后一个单元格时发出噪音，因为 PlaySound 将保存从循环中分配给它的最后一个值。

# php - PHP/sql 问卷和适合性匹配

> ID：14962634
> 
> 赞同：0
> 
> 时间：2013-02-19T16:35:56.443
> 
> 标签：php, mysql, matching

我正在开发一种解决方案，用于将人们与他们可能对使用 PHP 和 mySQL 完成的问卷感兴趣的某些事物进行匹配。基本上，用户回答问题，创建用户档案，然后将其与数据库中可能适合其个性的某些内容进行比较。它不是约会网站，但我想它的工作方式类似于约会网站的工作方式，人们可以在其中进行问卷调查，并且可以根据这些与百分比匹配值进行匹配。

我已经开始开发这个，但我认为我使用的方法可能不是最有效的。我希望您可以按最佳匹配对匹配进行排序。

有什么建议最好的方法是什么？

谢谢， 德克兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:42:35.343

将答案连接成一个字符串。如果它们是/否，它看起来有点像二进制，但是如果你有 >16 和 <100 选项，或者使用分隔符等，使用其他数字或十六进制或对没有害处。

要找到最接近的匹配，比较每个位置的每个字符并对结果进行排名。

**rank = 给定比较字符串中相同字符的数量**，例如“0101101001”

```
0101101001 against 0101101001 gives a rank of 10 
0101101001 against 1101101001 gives a rank of 9
0101101001 against 1111111001 gives a rank of 7
0101101001 against 0001100111 gives a rank of 6 
```

作为 SQL

```
table `yesno`
| user_id | answers    |
|    1    | 0101101001 |
|    2    | 1101101001 |
etc

SELECT answers,
    ( #looking for 0101101001
    IF (substring(answers,1,1)=0, 1, 0) 
    + IF (substring(answers,2,1)=1, 1, 0)
    + IF (substring(answers,3,1)=0, 1, 0)
    + IF (substring(answers,4,1)=1, 1, 0)
    + IF (substring(answers,5,1)=1, 1, 0)
    + IF (substring(answers,6,1)=0, 1, 0)
    + IF (substring(answers,7,1)=1, 1, 0)
    + IF (substring(answers,8,1)=0, 1, 0)
    + IF (substring(answers,9,1)=0, 1, 0)
    + IF (substring(answers,10,1)=1, 1, 0)
    ) 
AS rank
FROM yesno 
ORDER BY 
    ( #looking for 0101101001
    IF (substring(answers,1,1)=0, 1, 0) 
    + IF (substring(answers,2,1)=1, 1, 0)
    + IF (substring(answers,3,1)=0, 1, 0)
    + IF (substring(answers,4,1)=1, 1, 0)
    + IF (substring(answers,5,1)=1, 1, 0)
    + IF (substring(answers,6,1)=0, 1, 0)
    + IF (substring(answers,7,1)=1, 1, 0)
    + IF (substring(answers,8,1)=0, 1, 0)
    + IF (substring(answers,9,1)=0, 1, 0)
    + IF (substring(answers,10,1)=1, 1, 0)
    ) 
DESC 
```

作为 PHP

```
#usage $rs=getUsersByRank("0101101001");

function getUsersByRank($lookslike) {
    /* expects "binary" string
    returns user_id, answers and rank (0 to string length) ordered by closest match first 
    */  

    $ifs=array();
    foreach (str_split($lookslike) as $i=>$bit){
        $ifs[]='IF (substring(answers,' . ($i+1) . ',1)=' . $bit . ', 1, 0) ';
    }

    // use your db class
    return $db->select_many('
        SELECT user_id, answers,
            ( '. implode(' + ', $ifs) .' ) 
        AS rank
        FROM yesno 
        ORDER BY 
            ( '. implode(' + ', $ifs) .' ) 
        DESC
    ');
} 
```

如果要保留每个用户与其他用户的比较，则需要另一个表来存储 user1、user2、match_rank。

您可能希望限制 getUsersByRank() 中的结果。

*我还没有实际测试过它是否有效，只是把它写出来。*

# string - 从 NSIS 脚本中查找文件中的字符串模式

> ID：14962645
> 
> 赞同：2
> 
> 时间：2013-02-19T16:36:21.230
> 
> 标签：string, find, nsis

在 NSIS 安装程序脚本中，我正在尝试检查给定的 httpd.conf 文件是否包含以下行：

> 包括“c:\xxx\yyy.conf”

如果是这样，那么我的安装程序脚本不会将其附加到文件中，否则，它将附加它。

我已经通过 {LineFind} 但不确定这是否真的实现了我想要实现的目标。

从 NSIS 脚本对文本文件执行某种“grep”的最简单方法是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:49:27.630

这是一个在文件中搜索给定行的示例，使用 LogicLib 以简化语法。找到该行后立即停止搜索。此示例适用于示例脚本本身：

```
# find.nsi : sample for LineFind from TextFunc.nsh
!include "textfunc.nsh"
!include "logiclib.nsh"
OutFile "find.exe"

!define lookfor `Section`   ;will find
;!define lookfor `Sectionn` ;will not find
Var found

Section
    StrCpy $found 0
    ${LineFind} "find.nsi" "/NUL" "1:-1" "GrepFunc"

    ${if} $found = 1 
        MessageBox MB_OK "string found"
    ${else}
        MessageBox MB_OK "string NOT found"
    ${endIf}

SectionEnd

Function GrepFunc
    ${TrimNewLines} '$R9' $R9
    DetailPrint "test for line $R8 `$R9`"
    ${if} $R9 == "${lookfor}" 
        StrCpy $found 1         ;set flag
        Push "StopLineFind"     ;stop find
    ${else}
        Push 0                  ;ignore -> continue
    ${endIf}
FunctionEnd 
```

# python - Pyinstaller 和 guidata

> ID：14962646
> 
> 赞同：2
> 
> 时间：2013-02-19T16:36:30.187
> 
> 标签：python, pyinstaller

我在使用 pyinstaller 和 guidata 时遇到问题。

我的脚本 form.py 是[http://pythonhosted.org/guidata/examples.html的基本示例](http://pythonhosted.org/guidata/examples.html)

然后我创建form.exe： python pyinstaller.py -F form.py

但是当我运行 form.exe 时，我得到：

```
Traceback (most recent call last):
  File "<string>", line 8, in <module>
  File "C:\Python27\pyinstaller-2.0\PyInstaller\loader\iu.py", line 386, in impo
rtHook
    mod = _self_doimport(nm, ctx, fqname)
  File "C:\Python27\pyinstaller-2.0\PyInstaller\loader\iu.py", line 480, in doim
port
    exec co in mod.__dict__
  File "C:\Users\usuario\Documents\test\build\
pyi.win32\form\out00-PYZ.pyz\guidata", line 540, in <module>
  File "C:\Python27\pyinstaller-2.0\PyInstaller\loader\iu.py", line 386, in impo
rtHook
    mod = _self_doimport(nm, ctx, fqname)
  File "C:\Python27\pyinstaller-2.0\PyInstaller\loader\iu.py", line 480, in doim
port
    exec co in mod.__dict__
  File "C:\Users\usuario\Documents\test\build\
pyi.win32\form\out00-PYZ.pyz\guidata.config", line 19, in <module>
  File "C:\Users\usuario\Documents\test\build\
pyi.win32\form\out00-PYZ.pyz\guidata.configtools", line 100, in add_image_module
_path
  File "C:\Users\usuario\Documents\test\build\
pyi.win32\form\out00-PYZ.pyz\guidata.configtools", line 86, in add_image_path
WindowsError: [Error 123] El nombre de archivo, el nombre de directorio o la sin
taxis de la etiqueta del volumen no son correctos: u'C:\\Users\\usuario\\Documen
ts\\test\\dist\\form.exe?175104\\guidata\\images\\*.*' 
```

有什么帮助吗？

# android - 切换活动时android中的NullPointerException

> ID：14962649
> 
> 赞同：-2
> 
> 时间：2013-02-19T16:36:39.700
> 
> 标签：android, android-activity, nullpointerexception, switching

美好的每一天！

我是 android 开发的初学者，当我从第二个活动切换到第三个活动时遇到了一些麻烦：我在第三个活动的 onCreate 函数中遇到了一个由 NullPointerExeception 引起的强制子句。我阅读了堆栈跟踪，发现我的问题来自第二个活动的第 60 行。

```
name_server = thisIntent.getExtras().getString("ip"); 
```

我不明白为什么，所以我不知道如何解决它：/

以下是来源：

第一项活动：

```
package Smart.Wifi.Mote.v2;
import android.net.wifi.SupplicantState;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.view.Gravity;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class SmartWifiMotev22 extends Activity 
{

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);        

    /**********************************
           Clic sur "connexion"
    **********************************/
    OnClickListener clic = new OnClickListener()
    {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            // déclaration de la nouvelle fenêtre
            // @1 : fenêtre actuelle
            // @2 : nouvelle fenêtre
            Intent newpage = new Intent(SmartWifiMotev22.this, mainActivityv22.class);
            System.out.println("lancement fenêtre");

            // récupération de la valeur contenue dans la zone de texte (adresse ip)
            EditText a_IP = (EditText) findViewById(R.id.T_IP);
            String adresse_IP = a_IP.getText().toString();

            System.out.println("adresse_IP : " + adresse_IP);

            // ajout des valeurs à l'intent (fenêtre)
            newpage.putExtra("ip", adresse_IP);

            startActivity(newpage); // lancement de la fenêtre
                    }

    } //

} // 
```

第二个 ：

```
package Smart.Wifi.Mote.v2;

import java.io.IOException;
import java.net.Socket;
import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.text.Editable;
import android.text.TextWatcher;
import android.util.DisplayMetrics;
import android.view.Gravity;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.inputmethod.EditorInfo;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.TextView.OnEditorActionListener;

public class mainActivityv22 extends Activity 
{

public String name_server = null;
public Socket s = null;
public String message = null;

public float startXPosition;
public float startYPosition;
public float endXPosition;
public float endYPosition;
public int moveX, moveY;

public Thread cThread;
public Thread sendThread;
public Thread alive;
public Intent thisIntent;
public boolean stopconnection = false;

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);

    thisIntent = getIntent();

    // récupération de l'adresse IP envoyé en paramètre via intent.putExtra()
    name_server = thisIntent.getExtras().getString("ip");
    System.out.println("adresse page2 : " + name_server);
} // public void onCreate(Bundle savedInstanceState) 

public boolean onCreateOptionsMenu(Menu menu) 
{
    //Création d'un MenuInflater qui va permettre d'instancier un Menu XML en un objet Menu
    MenuInflater inflater = getMenuInflater();
    //Instanciation du menu XML spécifier en un objet Menu
    inflater.inflate(R.menu.menu, menu);

    return true;
 }

   //Méthode qui se déclenchera au clic sur un item
  public boolean onOptionsItemSelected(MenuItem item) 
  {
     //On regarde quel item a été cliqué grâce à  son id et on déclenche une action
     switch (item.getItemId()) 
     {
        case R.id.Internet:
            //((TextView)findViewById(R.id.texte)).setText("Option"); 
            break;

        case R.id.Presentation:
            Intent intent_presentenation = new Intent(mainActivityv22.this, Presentationv22.class);
            startActivity(intent_presentenation);               
            break;

     }
     return true;
  } 
```

最后一个：

```
package Smart.Wifi.Mote.v2;

import android.os.Bundle;
...
import android.widget.ImageButton;

public class Presentationv22 extends mainActivityv22
{

@Override
protected void onCreate(Bundle savedInstanceState) {
    System.out.println("Activity Presentation §§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§");
    System.out.println("Constructeur classe mère");
    super.onCreate(savedInstanceState);
    System.out.println("Affichage");
    setContentView(R.layout.presentation);

    /*********************************
           Appui sur Start
    *********************************/
    OnClickListener Start = new OnClickListener()
    {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub              
        }
    };

    ImageButton start = (ImageButton) findViewById(R.id.ibStart);
    start.setOnClickListener(Start);

    /*********************************
          Appui sur Stop
    *********************************/
    OnClickListener Stop = new OnClickListener()
       {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
        }
    };

    ImageButton stop = (ImageButton) findViewById(R.id.ibStop);
    stop.setOnClickListener(Stop);

        }

        /**********************************
                       Menu
        **********************************/
        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.menu, menu);
            return true;
        }
    } 
```

谢谢你的帮助 ：）

PS：堆栈跟踪

```
02-19 16:54:43.085: I/System.out(16968): Activity Presentation §§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§
02-19 16:54:43.085: I/System.out(16968): Constructeur classe mère
02-19 16:54:43.095: D/AndroidRuntime(16968): Shutting down VM
02-19 16:54:43.095: W/dalvikvm(16968): threadid=1: thread exiting with uncaught exception (group=0x2aac8578)
02-19 16:54:43.105: E/AndroidRuntime(16968): FATAL EXCEPTION: main
02-19 16:54:43.105: E/AndroidRuntime(16968): java.lang.RuntimeException: Unable to start activity ComponentInfo{Smart.Wifi.Mote.v2/Smart.Wifi.Mote.v2.Presentationv22}: java.lang.NullPointerException
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1659)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1675)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread.access$1500(ActivityThread.java:121)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:943)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.os.Looper.loop(Looper.java:130)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread.main(ActivityThread.java:3701)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at java.lang.reflect.Method.invokeNative(Native Method)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at java.lang.reflect.Method.invoke(Method.java:507)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:866)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:624)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at dalvik.system.NativeStart.main(Native Method)
02-19 16:54:43.105: E/AndroidRuntime(16968): Caused by: java.lang.NullPointerException
02-19 16:54:43.105: E/AndroidRuntime(16968):    at Smart.Wifi.Mote.v2.mainActivityv22.onCreate(mainActivityv22.java:60)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at Smart.Wifi.Mote.v2.Presentationv22.onCreate(Presentationv22.java:19)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-19 16:54:43.105: E/AndroidRuntime(16968):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1623)
02-19 16:54:43.105: E/AndroidRuntime(16968):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:45:42.123

您的第三个活动调用`super.onCreate()`，这意味着 mainActivityv22`onCreate()`被调用，它试图从 Intent 中获取额外的字符串。但是没有任何，因为这个活动，第三个活动不是以一个有意图的意图开始的。

您应该`super.onCreate()`从第三个活动中删除 ，然后尝试。

另外我真的不知道你为什么延长`mainActivityv22`。扩展它会更简单`Activity`。我看不到您正在重用的任何代码。

**编辑：**

正如山姆指出的那样，我错了。在 's onCreate() 中检查 null`mainActivityv22`将是您最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:46:29.087

`null`并非每个 Activity 都以 Intent 或 extras 启动，您应该在尝试访问它们之前检查这些值是否存在。

```
thisIntent = getIntent();
if(thisIntent != null && thisIntent.getExtras() != null) {
    name_server = thisIntent.getExtras().getString("ip");
}
else { // Add a default case like this if you want
    name_server = "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:47:50.300

在这个部分：

```
 case R.id.Presentation:
        Intent intent_presentenation = new Intent(mainActivityv22.this, Presentationv22.class);
        startActivity(intent_presentenation);               
        break; 
```

您正在开始没有额外的字符串“ip”的活动。我不确定，但是当您调用 Presentationv22 活动时，onCreate 可能会尝试在 super() 方法上访问此额外内容。您能否尝试将额外内容添加到上述意图中以进行测试？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T16:48:49.800

为避免出现您遇到的错误，您应该首先检查您的 Intent for Extras，例如

```
Bundle getExtraData = getIntent().getExtras();
String blah;
if (getData != null) {
    blah= getExtraData .getString("blah");
} 
```

大多数问题似乎是因为您在没有正确的额外内容的情况下实例化 Presentationv22（无论如何您都应该对其进行测试）。由于它派生自您的其他类，因此它正在启动异常：

```
case R.id.Presentation:
        Intent intent_presentenation = new Intent(mainActivityv22.this, Presentationv22.class);
        startActivity(intent_presentenation); 
```

# java - 无法创建半熟解析器

> ID：14962650
> 
> 赞同：3
> 
> 时间：2013-02-19T16:36:45.300
> 
> 标签：java, parboiled

根据[这个简单的例子](https://github.com/sirthias/parboiled/wiki/Simple-Java-Example)，我为 parboiled 框架创建了一个解析器类：

```
package my.package;

import org.parboiled.BaseParser;
import org.parboiled.annotations.BuildParseTree;

@BuildParseTree
public class QueryParser extends BaseParser<Object> {
    //some rules
} 
```

如果我尝试创建解析器，如示例所示

```
QueryParser parser = Parboiled.createParser(QueryParser.class); 
```

我在那一行遇到了一个例外：

```
java.lang.ClassCastException: my.package.QueryParser$$parboiled cannot be cast to org.parboiled.BaseParser
    at org.parboiled.Parboiled.createParser(Parboiled.java:56)
    ... 
```

我真的没有做示例中没有做的任何特别的事情。唯一的区别是解析器和调用它的类在不同的项目中，但我无法想象为什么这很重要。项目（即 Eclipse 插件项目）之间的依赖关系应该没问题。

谁能告诉我我做错了什么或错误可能在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:17:04.457

它实际上似乎与运行配置有关。我将所有煮熟的相关代码移到一个项目中，它可以工作。我想我会保持这种方式，因为无论如何它是更好的封装。

# android - 为什么 ListView 总是构建前三个元素？

> ID：14962651
> 
> 赞同：0
> 
> 时间：2013-02-19T16:36:47.167
> 
> 标签：android, listview

我正在使用 ListView：

```
private class myAdapter extends BaseAdapter {
...
    public View getView(int position, View convertView, ViewGroup parent) {
        if(parent == null)
            return null;

        Log.d(TAG, "getView: " + position);
        ...
    }
} 
```

我在 logcat 中看到的是这种模式：

0,1,2,3,0,1,2,4,0,1,2,5...

这种行为有解释吗？我正在处理大型图形，每次 getView 调用都很昂贵。有没有办法阻止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T10:47:59.343

不知道这背后的原因是什么。在 getView 主体中进行了一些优化之后，整个事情开始以更合理的方式工作 - 当时加载一个结果视图。

# c++ - libzip 中的 zip_source_zip：第一个参数是什么？

> ID：14962657
> 
> 赞同：0
> 
> 时间：2013-02-19T16:36:57.960
> 
> 标签：c++, function, zip, arguments, static-libraries

我正在使用 libzip 以便从另一个 zip 中移动 zip 中的文件。因此，首先我使用 zip_source_zip 从我的 zip 中的文件创建 zip_source，然后使用 zip_add 最终将文件添加到 zip。

但是有一个论点，我不明白它代表什么。zip_source_zip 的第一个参数。这是它的原型：

```
struct zip_source * zip_source_zip(struct zip *archive, struct zip *srcarchive, zip_uint64_t srcidx, int flags, zip_uint64_t start, zip_int64_t len) 
```

srcarchive 是我获取文件的 zip，srcidx 是我想要的文件在 zip 中的位置，标志是标志：P，开始是我要获取文件的第一个字节，而 len 是来自的字节数开始。

但我不明白第一个参数档案代表什么。我放置了目标 zip 的指针，但它不起作用。

你知道第一个论点代表什么吗？谢谢！

PS：这里是描述功能的页面：http: [//www.nih.at/libzip/zip_source_zip.html](http://www.nih.at/libzip/zip_source_zip.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:43:23.360

每个都`zip_source`应该与它将操作的 ZIP 存档相关联（例如，该`zip_add()`功能可用于将源的内容添加到该特定 zip 存档）。无论您是`zip_source`从内存缓冲区（使用`zip_source_buffer()`）、另一个打开以供读取的 ZIP 存档（您正在做什么）还是使用任何其他方法创建 都无关紧要。基本上，第一个 ZIP 存档是添加对象内容时将修改的`zip_source`目标，第二个 ZIP 存档参数是将内容复制到源的参数。

# java - 再次运行应用程序时，值将从数据库中删除

> ID：14962664
> 
> 赞同：1
> 
> 时间：2013-02-19T16:37:31.343
> 
> 标签：java, spring, hibernate, zk

我在 Spring + Hibernate + ZK 框架中制作了一个示例应用程序。在 Hibernate 配置文件中，我将属性 hbm2ddl.auto 保持在“更新”模式。仍然每当我再次运行应用程序时，我都没有得到更早保留的值。

以下是几个配置文件供参考：

BeanLocations.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <!-- Database Configuration -->
    <import resource="../database/DataSource.xml"/>
    <import resource="../database/Hibernate.xml"/>

    <!-- Auto scan the components -->
    <context:component-scan 
        base-package="com.nagarro" />

</beans> 
```

数据源.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location">
            <value>properties/database.properties</value>
        </property>
    </bean>

    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${jdbc.driverClassName}" />
        <property name="url" value="${jdbc.url}" />
        <property name="username" value="${jdbc.username}" />
        <property name="password" value="${jdbc.password}" />
        <!-- <property name="hibernate.current_session_context_class" value = "${hibernate.current_session_context_class}" /> -->
    </bean>

</beans> 
```

休眠.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"
    xmlns:tx="http://www.springframework.org/schema/tx">

    <!-- Hibernate session factory -->
    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource">
            <ref bean="dataSource" />
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>

            </props>
        </property>

        <property name="annotatedClasses">
            <list>

                <value>com.nagarro.model.ItemAttribute</value>
                <value>com.nagarro.model.ItemAttributeGroup</value>
            </list>
        </property>
    </bean>

</beans> 
```

控制器/视图模型类

```
public class ItemAttributeRenderer {

    /*
     * The Logger reference variable used for Logging.
     */
    static private final Logger LOG = LoggerFactory.getLogger(ItemAttributeRenderer.class);

    @Autowired
    private ItemAttributeService itemAttrService;

    private List<ItemAttribute> itemList = new ArrayList<ItemAttribute>();

    private void prepareAndSaveItemAttributeData(){
        ItemAttribute item = null;
        int counter;
        for(int index = 0; index < 5; index++){
            counter = index+1;
            item = new ItemAttribute("Item "+counter, "Attirbute Value"+counter, "Qualifier Value"+counter);
            itemAttrService.save(item);
        }
    }
    /**
     * @return the itemList
     */
    public List<ItemAttribute> getItemList() {
        ApplicationContext appContext = new ClassPathXmlApplicationContext("/spring/config/BeanLocations.xml");
        itemAttrService = (ItemAttributeService)appContext.getBean("itemAttrService");
        prepareAndSaveItemAttributeData();
        itemList = itemAttrService.getItemAttributeList();
        return itemList;
    }

    @Command
    public void save(){
        for(ItemAttribute item : itemList){
            itemAttrService.update(item);
        }

    }

    /**
     * @param itemList the itemList to set
     */
    public void setItemList(List<ItemAttribute> itemList) {
        this.itemList = itemList;
    }
    /**
     * @return the itemAttrService
     */
    public ItemAttributeService getItemAttrService() {
        return itemAttrService;
    }
    /**
     * @param itemAttrService the itemAttrService to set
     */

    public void setItemAttrService(ItemAttributeService itemAttrService) {
        this.itemAttrService = itemAttrService;
    }

} 
```

查看文件：

```
<?page title="Result"?>
<zk>
    <custom-attributes center="${arg.center }" />
    <window apply="org.zkoss.bind.BindComposer"
        viewModel="@id('vm') @init('com.nagarro.viewmodel.ItemAttributeRenderer')"
        title="Result Window" border="normal">
        <div>
            <grid>
                <rows>
                    <row>
                        <listbox model="@bind(vm.itemList)">
                            <listhead>
                                <listheader label="Item Name"
                                    style="text-align:center;">
                                </listheader>
                                <listheader label="Attribute Value"
                                    style="text-align:center;">
                                </listheader>
                                <listheader label="Qualifier Value"
                                    style="text-align:center;">
                                </listheader>
                            </listhead>
                            <template name="model" var="item">
                                <listitem value="${item }">
                                    <listcell label="@load(item.name)"
                                        style="text-align:center;">

                                    </listcell>
                                    <listcell style="text-align:center;">
                                    <textbox value="@bind(item.attributeValue)"
                                        style="text-align:center;"/>

                                    </listcell>
                                    <listcell
                                        label="@load(item.qualifierValue)"
                                        style="text-align:center;">
                                    </listcell>
                                </listitem>
                            </template>
                        </listbox>
                    </row>
                </rows>
            </grid>
        </div>
        <div style="text-align:right; padding:10px;">
            <button label="Save" mold="trendy"
                onClick="@command('save')">
            </button>

        </div>
    </window>
</zk> 
```

服务等级

```
@Service("itemAttrService")
public class ItemAttributeServiceImpl implements ItemAttributeService{

    @Autowired
    ItemAttributeDao itemAttrDao;

    public void setItemAttrDao(ItemAttributeDao itemAttrDao) {
        this.itemAttrDao = itemAttrDao;
    }

    public void save(ItemAttribute item){
        itemAttrDao.save(item);

    }

    public void update(ItemAttribute item){
        itemAttrDao.update(item);

    }

    public void delete(ItemAttribute item){
        itemAttrDao.delete(item);
    }

    public ItemAttribute findByItemAttributeName(String name){
        return itemAttrDao.findByItemAttributeName(name);
    }

    public List<ItemAttribute> getItemAttributeList(){
        return itemAttrDao.getItemAttributeList();
    }

} 
```

DAO 类

```
@Repository("itemAttrDao")
public class ItemAttributeDaoImpl extends CustomHibernateDaoSupport  implements ItemAttributeDao {

    public void save(ItemAttribute itemAttribute) {
        getHibernateTemplate().save(itemAttribute);
        //getHibernateTemplate().getSessionFactory().getCurrentSession().getTransaction().commit();
    }

    public void update(ItemAttribute itemAttribute) {
        getHibernateTemplate().update(itemAttribute);
        //getHibernateTemplate().getSessionFactory().getCurrentSession().getTransaction().commit();
    }

    public void delete(ItemAttribute itemAttribute) {
        getHibernateTemplate().delete(itemAttribute);
        //getHibernateTemplate().getSessionFactory().getCurrentSession().getTransaction().commit();
    }

    public ItemAttribute findByItemAttributeName(String name) {
        List list = getHibernateTemplate().find("from ItemAttribute where name=?",name);
        if(list == null){

        }else if(list.isEmpty()){

        }
        return (ItemAttribute)list.get(0);
    }

    public List<ItemAttribute> getItemAttributeList() {
        List<ItemAttribute> itemList = getHibernateTemplate().find("from ItemAttribute ");
        return itemList;
    }

} 
```

pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.abc</groupId>
    <artifactId>ZKSpringHibernateExample</artifactId>
    <packaging>war</packaging>
    <version>1.0-SNAPSHOT</version>
    <name>SpringHibernateExample</name>
    <url>http://maven.apache.org</url>

    <repositories>
        <repository>
            <id>java.net</id>
            <url>http://download.java.net/maven/2/</url>
        </repository>
    </repositories>
    <properties>
        <org.springframework.version>3.0.5.RELEASE</org.springframework.version>
    </properties>

    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <!-- Spring framework -->

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${org.springframework.version}</version>
        </dependency>

                    <!-- MySQL database driver -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.9</version>
        </dependency>

        <!-- Hibernate framework -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>3.6.3.Final</version>
        </dependency>

        <dependency>
            <groupId>javassist</groupId>
            <artifactId>javassist</artifactId>
            <version>3.12.1.GA</version>
        </dependency>

        <!-- Hibernate library dependecy start -->
        <dependency>
            <groupId>dom4j</groupId>
            <artifactId>dom4j</artifactId>
            <version>1.6.1</version>
        </dependency>

        <dependency>
            <groupId>commons-logging</groupId>
            <artifactId>commons-logging</artifactId>
            <version>1.1.1</version>
        </dependency>

        <dependency>
            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>3.2.1</version>
        </dependency>

        <dependency>
            <groupId>antlr</groupId>
            <artifactId>antlr</artifactId>
            <version>2.7.7</version>
        </dependency>
        <!-- Hibernate library dependecy end -->

        <!-- ZK Dependency start -->
        <dependency>
            <groupId>org.zkoss.zk</groupId>
            <artifactId>zkplus</artifactId>
            <version>6.0.0</version>
        </dependency>
        <dependency>
            <groupId>org.zkoss.zk</groupId>
            <artifactId>zhtml</artifactId>
            <version>6.0.0</version>
        </dependency>
        <dependency>
            <groupId>org.zkoss.zk</groupId>
            <artifactId>zkbind</artifactId>
            <version>6.0.0</version>
        </dependency>
        <dependency>
            <groupId>org.zkoss.zk</groupId>
            <artifactId>zul</artifactId>
            <version>6.0.0</version>
        </dependency>
        <!-- ZK Dependency Ends -->

    </dependencies>
</project> 
```

我的问题是当我再次运行应用程序时，即使我已将 hbm2ddl.auto 属性设置为更新模式，之前保存的所有数据都会消失。我已将 show_sql 属性设置为“true”以检查被触发的查询，但没有被触发的删除查询。我在这里还缺少其他重要的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:53:12.303

[在此处](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/)查看评论并阅读 Hibernate 手册

```
<property name="hbm2ddl.auto">update</property> 
```

在启动时设置以上属性删除并重新创建数据库架构

考虑以下来自休眠手册的评论。

Hibernate 的持久性上下文的自动会话管理在这种情况下特别有用。hbm2ddl.auto 选项打开直接将数据库模式自动生成到数据库中。这也可以通过删除配置选项来关闭，或者在 SchemaExport Ant 任务的帮助下重定向到文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:53:14.777

`hbm2ddl.auto`用于验证数据库模式，这里没有任何意义。

您必须提交您的值，否则它们不会永久存储在数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T09:49:33.243

我找到了解决方案。我的 Tomcat 中有很多混乱的项目依赖项，所以我删除了那个 Tomcat 实例并为我的项目重新配置了它。然后我清理了我的项目，现在一切正常。感谢您花时间发布答案。

# php - 什么是行长“软限制”，我如何在 PSR-2 约定中解释这一点？

> ID：14962667
> 
> 赞同：43
> 
> 时间：2013-02-19T16:37:49.337
> 
> 标签：php, coding-style, conventions

我不明白这部分 php 的[PSR-2](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md)约定：

> 行长的软限制必须是 120 个字符；自动样式检查器**必须**警告但**不能**在软限制处出错。
> 
> 行**不应**超过 80 个字符；超过这个长度的行**应该**分成多个后续行，每行不超过 80 个字符。

我认为“软限制”的意思是*“尽量坚持这个限制，但额外的几个字符不是问题”*。但是后来我读了第二行，现在我不明白。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-08-28T18:17:47.357

这很容易：

*   0-80：总是好的
*   80-120：可接受（如果有充分的理由，例如，包裹它的字符串会很难看）
*   120+：Lint 工具、IDE 等必须显示警告（但绝不是错误！），因为该行可能很难看/不可读/...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-08-28T18:17:21.027

PSR-2没有**硬性限制**。

**MUST (NOT)**指的是自动样式检查器，而不是作为程序员的你。

另请注意`no error`超过软限制时应发出的部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-08-02T17:22:20.017

## 让我在上面的答案中添加一些内容

### 编辑器设置

我也在阅读无花果标准，我偶然发现了同样的问题。

在深入了解我的 IDE 设置 (PhpStorm) 后，我在一般“代码样式”页面下方发现了一个小注释，您不会在 php 代码部分看到该注释。

**笔记报告：**

> “指定一个指南 (80) 或多个 (80, 120)”

**这可以更好地解释 PSR 规则，我现在是这样阅读的：**

> “你不应该写超过**80 个**字符的行，但如果你需要，你可以写。如果你超过 80 个字符，无论如何都要避免超过**120 个**字符的行”。

如果您有两个垂直标尺，这是完全可能的：将它们设置为**80、120，**您将知道何时超过第一个限制（警告），以及何时超过第二个限制（停止！）。

如果您使用自动代码格式化（我这样做，但人们*讨厌我*），那么您可以在 php 代码样式页面中设置**Hard wrap at: 120**。此设置将确保遵循 PSR 规则。

### 个人强项

老实说，现在我们的显示器比旧显示器宽很多***，***因为它们使用 16:9 的纵横比而不是 4:3。所以我不认为遵循 120 个字符规则的紧迫性，因为 16:9 显示器可以轻松处理一行 200 多个字符（我在屏幕上打印了 224 个字符）。

无论如何，*我不喜欢打破规则的想法*，如果可以的话，我会在谈到编码标准时尝试遵循它们。也许我看不出规则的意义，但如果整个团队都在讨论这个话题，并决定将限制设置为 120 个字符，那么这个决定背后可能有我看不到的原因，所以我只是坚持下去。这就是标准对我的意义所在。

### 为什么 120 是一个很好的折衷方案

事实上，在过去的几周里，我已经开始垂直拆分编辑器的窗口，将一些文件类型保留在左侧，而将其他一些类型（通常是 JavaScript）保留在右侧。一开始可能有点奇怪，我是那种对错位的东西非常不安的人。但现在我已经习惯了，因为在实践中，这样效果更好！

我在某处读到，我们的视线不能很好地跟上超过一定长度的线条，你可以很容易地理解为什么。尝试阅读行数超过 200 行的文档，您会更容易失去焦点。可能你会多次忽略这一点并再次阅读整行......如果你能找到它的开始！

取而代之的是，最大长度在 80 到 120 之间的文档将有更多行，但更具可读性，并且您还可以在大多数情况下水平拆分屏幕，而无需滚动。

我只想说一下我在 PhpStorm 上的发现，和往常一样，*我最终写了一张纸莎草纸。***我道歉 ：）**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T08:08:39.493

我很确定我在某处看到了另一种解释……我不知道这是不是真的，但我觉得我应该分享它=）

好的，就是这样：任何行都不应超过 80，*但这并不能说明 indentation*。使用缩进，限制为 120。

所以，如果你当前的缩进是 80（考虑“守卫”，顺便说一句……）——你只剩下 40 个字符了。但如果您当前的缩进是 40 或更少 - 您最多可以为实际代码使用 80 个字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-31T18:47:29.347

理解*所有*FIG 标准的关键是正确解释[RFC 中使用的关键词](https://www.rfc-editor.org/rfc/rfc2119)。

> **行长不能**有硬性限制。

虽然没有人会拿枪指着你的头……</p>

> 行长度的软限制**必须**是 120 个字符。

... 最好不要超过 120 个字符的长度...</p>

> 行**不应**超过 80 个字符；超过这个长度的行应该分成多个后续行，每行不超过 80 个字符。

…但是，作为建议，尝试拆分超过 80 个字符的行。

* * *

这一切都归结为可读性。针对数字文本的易读性研究表明，与印刷文本一样，行长会影响阅读速度（[扫视](https://en.wikipedia.org/wiki/Saccade)）。此外，事实证明，当跳到下一行时，潜意识是充满活力的（只要它不经常发生）。在每条新行的开头，读者都会集中注意力，但随着行的持续时间，这种注意力会逐渐消失（“Typographie”，E. Ruder）。

# javascript - 文件输入标签点击的解决方法 (Firefox) - jQuery 1.9

> ID：14962674
> 
> 赞同：2
> 
> 时间：2013-02-19T16:38:06.077
> 
> 标签：javascript, jquery, firefox, input, label

首先，这非常类似于： [文件输入标签单击的解决方法（Firefox）](https://stackoverflow.com/questions/7742278/workaround-for-file-input-label-click-firefox)

但提供的解决方案不适用于 jQuery 1.9+

$.browser 变量不再存在，因为现在我们必须进行[特征检测](http://api.jquery.com/jQuery.support/)。

我非常想检测我需要的功能，但 jQuery 中似乎没有这样的支持。浏览器检测不见了，功能检测似乎无法检测到我需要的东西，有没有好的解决方案？Modernizr 解决方案也将受到赞赏，并且也接受 plain-vanilla-js 解决方案

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:46:32.433

```
if ( window.mozIndexedDB !== undefined ) {
   //do firefox things
} 
```

这只会在 Firefox 中返回 true，afaik。

示例测试：

```
if ( window.mozIndexedDB !== undefined ) {
   alert('You are using Firefox');
} 
```

您可以尝试查看 window.navigator.userAgent 但我不推荐它，一堆其他浏览器标识为 Mozilla，请参阅此问题以获取一些示例：[为什么 javaScript 中的“navigator.userAgent”返回字符串“Mozilla”时在谷歌浏览器浏览器中试过吗？](https://stackoverflow.com/questions/7050521/why-does-navigator-useragent-in-javascript-returns-the-string-mozilla-when-t)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:41:55.153

不是最佳实践，但你为什么不试试[jQuery Migrate 插件](http://code.jquery.com/jquery-migrate-1.1.1.js)呢？它带回了 $.browser，以及其他一些已删除的功能。

# python - 在 Python 中计算素数之和——这行代码有什么作用？

> ID：14962679
> 
> 赞同：0
> 
> 时间：2013-02-19T16:38:52.393
> 
> 标签：python, calculator

我有一个简短的函数，可以计算所有素数的总和，直到一个限制。这是上下文的完整代码：

```
def primes_sum(limit):
    limitn = limit+1
    not_prime = [False] * limitn
    primes = []

    for i in range(2, limitn):
        if not_prime[i]:
            continue
        for f in xrange(i*2, limitn, i):
            not_prime[f] = True

        primes.append(i)

    return sum(primes) 
```

其中大部分对我来说很有意义，但我不明白这部分：

```
not_prime = [False] * limitn 
```

这样做的具体目的是什么？它是如何工作的，它如何确定一个数字是否是素数？我已经尝试查找它，但我找不到答案。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:40:15.047

您只是在创建一个`list`长度`limitn`，并将其所有元素初始化为`False`.

`*`是重复运算符。当应用于`List`以`integer`值`n`作为`right`操作数的 a 时，它会重复`list` `n`次数。

您也可以在字符串上使用它：

```
>>> [False] * 2
[False, False]
>>> "rohit" * 2
rohitrohit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:40:16.117

它初始化一个`limitn` `False`值列表。例如：

```
>>> [False]*3
[False, False, False] 
```

基本上它可以防止你`IndexError`以后得到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:56:47.673

`[False]*n`用 n 个全部为 False 的元素初始化列表。当您预先知道列表将包含多少元素时，这种初始化方式通常用作一种优化方式——它比使用 .append() 添加元素*要*快得多。

# java - 使用 Java Robots 类在屏幕上定位东西

> ID：14962680
> 
> 赞同：4
> 
> 时间：2013-02-19T16:38:57.353
> 
> 标签：java, artificial-intelligence, awtrobot

我想知道是否可以使用此类查找文件或程序。我知道有一些方法可以使用鼠标坐标或简单地找到一个应用程序并运行它，但这不是我想要做的。

更清楚的例子是：假设我的桌面上有 Google Chrome、Firefox 和 Safari，我将它们随机播放。如何让我的鼠标找到我正在寻找的浏览器，而无需简单地使用“运行应用程序”命令。

我希望澄清它！感谢您的帮助 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:56:49.823

最简单的方法（据我所知，使用`Robot`）是记录构成您要查找的内容的像素并逐个像素地查找它（您可以将当前屏幕截图与存储在文件中的图像进行比较）。去做这个：

截取您要查找的图标并将其保存到文件（只需保存图标）（不是 .jpg，因为这不是无损的，可能只是 .bmp）。

然后您可以执行以下操作：

```
Robot robot = new Robot();
BufferedImage current = robot.createScreenCapture(
  new Rectangle(Toolkit.getDefaultToolkit().getScreenSize()));

static void getScreenStart()
{
  BufferedImage icon = ImageIO.read(new File("chromeIcon.bmp"));
  for (int x = 0; x < current.getWidth (); x++)
  for (int y = 0; y < current.getHeight(); y++)
  {
     boolean matches = true;
     for (int x2 = 0; x2 < icon.getWidth () && matches; x2++)
     for (int y2 = 0; y2 < icon.getHeight() && matches; y2++)
        if (icon.getRGB(x2, y2) != current.getRGB(x+x2, y+y2))
           matches = false;
     if (matches)
     {
        X_START = x;
        Y_START = y;
        return;
     }
  }
} 
```

但通常尽量避免这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:43:35.253

不，我认为使用 Robot 类不容易做到这一点。这是因为 Java 是一种跨平台语言，不能/没有可用于集成到本机环境和窗口管理器的库。

Java 代码需要在任何带有 JDK 的平台上运行，将这些功能添加到每个 JDK 将是一项艰巨的任务。我会研究其他可以提供此功能的 Java 库，Robots 不会提供您正在寻找的东西。

对于 Windows，我建议使用[AutoHotkey](http://www.autohotkey.com/)，它是一种用于桌面自动化的脚本语言并且非常强大。Mac OSX 也有一个作为[IronAHK](http://www.ironahk.net/)的端口。

至于 Java 库，取决于您希望完成的任务，您可以查看一些 GUI 自动化测试解决方案，例如[TestComplete](http://smartbear.com/products/qa-tools/automated-testing-tools)甚至[Selenium](http://docs.seleniumhq.org/)。看看 Java 的测试自动化工具，你会发现更多！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-07T09:55:49.713

我正在为网络爬行做类似的事情，我可以告诉你，下面帖子中的工具不会那么简单。我将 Selenium 用于其他目的，但它不适用于在所有可见区域顶部都有画布的图像。为此，您应该使用机器人类，但之前您必须知道您期望的坐标。要使用某种 GUI 自动化测试工具，您必须让字段可供选择。我认为您不会在某些网页上轻松找到它。可能要获得可行的解决方案，您必须进行数字图像处理，这非常好，而且并不难。有很多 Java 库可以做到这一点。试试 OpenCV，我认为它的 lib 名称是 JavaCV，它很强大。

# pcap - pcap - 引用文件标准时是否正确大写？

> ID：14962689
> 
> 赞同：0
> 
> 时间：2013-02-19T16:39:19.640
> 
> 标签：pcap, libpcap

在为文档编写有关它的文档时，如何正确地以简写方式引用数据包捕获文件？

我在各个领域和 wiki 中看到了 PCAP、PCap 和 pcap 之间的混合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T02:05:40.533

引用数据包捕获文件的正确方法是“数据包捕获文件”；“pcap”/“PCap”/“pcap”通常用来指一种*特定类型*的抓包文件，那些以libpcap/WinPcap支持写入的格式编写的抓包文件。还有其他几种捕获文件格式，其中一种 Wireshark 和 libpcap 1.1.0 及更高版本可以读取（pcap-ng），还有几种 Wireshark 可以读取（还有一些 Wireshark 无法读取）。

我（作为 libpcap、tcpdump 和 Wireshark 的核心开发人员）会说以上述格式引用文件的正确方法是“pcap”，没有额外的大写；“pcap”来自“libpcap”，而不是直接来自“packet capture”，并且“libpcap”不是大写的（它是一个 UN*X 库，并且这些库的名称往往全小写，因为几乎所有 UN *X 文件系统区分大小写）。

其他人可能称其为“PCAP”，可能是因为计算机和网络领域的许多术语是首字母缩写词或其他首字母缩写词，他们认为“PCAP”也必须如此，或者称其为“PCap”，因为他们认为它是站立的用于“数据包捕获”而不是指 libpcap 和 WinPcap，但话说回来，人们也将 Sun Microsystems 称为“SUN”（它确实来自斯坦福大学网络项目，但不是“斯坦福大学网络微系统” ，它只是“Sun Microsystems”）。

# elasticsearch - 如何使用 ElasticSearch 集群和 NEST？

> ID：14962690
> 
> 赞同：4
> 
> 时间：2013-02-19T16:39:23.030
> 
> 标签：elasticsearch, nest

我真的很喜欢 NEST API，当然还有 ElasticSearch。很大一部分吸引力在于能够非常轻松地扩展集群。我有 3 个节点，包括 1 个主节点和 2 个读取从节点。NEST 客户端是否为跨集群的负载平衡和故障转移提供任何支持？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T09:16:04.387

不，选择。

负载平衡基于每个应用程序不同的许多启发式方法。许多设置已经在 elasticsearch 集群前面有硬件/软件负载均衡器。

最重要的是，elasticsearch 已经实现了负载平衡，因此即使客户端一直点击一个节点，集群也可以让其他节点协调搜索。

当然，故障转移是需要在应用程序中处理的事情（如果硬件/负载平衡器还没有处理这个问题），我可能会发布一个简单的实现作为一个单独的 nuget 包，它可以保留一个客户端池，但现在我的主要重点是完善 NEST 的 API 以使其 1.0 稳定/完整记录。

**2014 年更新**

由于 NEST 1.0 集群故障转移和连接池内置在客户端中：

```
var node = new Uri("http://mynode.example.com:8082/apiKey");
var connectionPool = new SniffingConnectionPool(new[] { node1, node2, node3 });
var config = new ConnectionConfiguration(connectionPool);
var client = new ElasticsearchClient(config); 
```

[http://nest.azurewebsites.net/elasticsearch-net/cluster-failover.html](http://nest.azurewebsites.net/elasticsearch-net/cluster-failover.html)

[http://nest.azurewebsites.net/elasticsearch-net/connecting.html](http://nest.azurewebsites.net/elasticsearch-net/connecting.html)

[http://nest.azurewebsites.net/nest/connecting.html](http://nest.azurewebsites.net/nest/connecting.html)

# javascript - 无法将值添加到数组

> ID：14962694
> 
> 赞同：0
> 
> 时间：2013-02-19T16:39:29.020
> 
> 标签：javascript

几周前，我发布了我的代码，它应该向数组添加值，然后在画布上绘制矩形。这个想法是在其他完成的地方开始绘制一个矩形。你写下宽度和高度值，点击一个按钮，四舍五入这个值并绘制它。但不幸的是它确实有效。问题是第一个值被添加到数组中，而不是下一个值。我正在使用 JavaScript。这是我的代码，欢迎任何帮助。

```
var arrayLargo = [];
var arrayAncho = [];
var ancho = 0;
var largo = 0;

function corta() {
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var medida2 = document.getElementById('medida2').value;
var medida1 = document.getElementById('medida1').value;
  var corte1 = Math.round(medida1);
  var corte2 = Math.round(medida2);

  arrayLargo.push(corte2);
  arrayAncho.push(corte1);
  //ancho, largo

//metodo para el ancho

    for (var i = 0; i < arrayAncho.length ; i++) {
        ancho += arrayAncho[i];
    }
    if (arrayAncho.length == 1) {
        ctx.fillStyle = "#58FA58";
        ctx.fillRect(0, largo, corte1, corte2);
    }else
    if (medida1 > 122 - ancho) {
            ctx.fillStyle = "#58FA58";
            ctx.fillRect(ancho, largo, corte1, corte2);//ancho, largo
        }
    else {
        ctx.fillStyle = "#58FA58";
        ctx.fillRect(ancho, largo, corte1, corte2);//ancho, largo
    }

    medida1 = 0;
    medida2 = 0;

    /*  
   //metodo para el largo
   if (arrayLargo.length >= 1) {
    for (var i = 0; i < arrayLargo.length ; i++) {
        largo += arrayLargo[i];
        if (medida1 > 244- largo) {
            ctx.fillRect(0, largo, corte1, corte2);//ancho, largo
        }
       }
   }*/ 
```

}

当您单击按钮时调用函数 corta

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:59:25.047

一些技巧可以帮助您获得有用的答案（或者更好的是，让您自己解决问题）

1.  您希望代码做什么，它会做什么？
2.  您收到错误消息吗？（不要忘记检查错误控制台）。如果是这样，它是什么，它发生在哪条线上？
3.  您是否尝试过在更简单的设置中重现问题？（制作一个[jsFiddle](http://jsfiddle.net)会很有帮助。）如果是这样，结果如何？

# c# - GridView 通过后面的代码更新存储过程

> ID：14962696
> 
> 赞同：0
> 
> 时间：2013-02-19T16:39:31.287
> 
> 标签：c#, asp.net, sql-server, visual-studio

任何人都可以帮助我。我已经设法让 RowEditing 的功能正常工作，现在正试图让 RowUpdating 继续工作。我的 gridview 设置如下

```
<asp:GridView ID="CountryGridView" runat="server" AutoGenerateColumns="false" CssClass="mGrid" OnRowEditing="CountryGridView_RowEditing" OnRowCancelingEdit="CountryGridView_RowCancelingEdit" >
                    <Columns>
                        <asp:BoundField ReadOnly="true" DataField="i_SK_Accom" HeaderText="i_SK_Accom" Visible="false" />
                        <asp:BoundField ReadOnly="true" DataField="Accom_Code" HeaderText="Accom Code" />
                        <asp:BoundField ReadOnly="true" DataField="Accom_Name" HeaderText="Accom Name" />
                        <asp:BoundField DataField="OP49_Required" HeaderText="OP49 Required?" />
                        <asp:BoundField DataField="Weekly" HeaderText="Weekly" />
                        <asp:BoundField DataField="Daily" HeaderText="Daily" />
                        <asp:CommandField ShowEditButton="true" ButtonType="Image" EditImageUrl="~/Images/Edit.gif" UpdateImageUrl="~/Images/save.png" CancelImageUrl="~/Images/cancel.png" ControlStyle-CssClass="ImageButton" />
                    </Columns>
                </asp:GridView> 
```

我试图让 RowUpdating 传递由于要更新为 MS SQL 上预编译存储过程的参数的列。通常的方法如下，但我正在努力让 gridview 工作。

```
SqlCommand commEditConsultant = new SqlCommand("IFACE_JFA_ACCOM", conn.sbConn);
    commEditConsultant.CommandType = CommandType.StoredProcedure;

    try
    {
        commEditConsultant.Parameters.Add("@Statement", SqlDbType.VarChar).Value = "AccomUpdate";
        commEditConsultant.Parameters.Add("@Page", SqlDbType.VarChar).Value = "OP49";
        commEditConsultant.Parameters.Add("@PC_Username", SqlDbType.VarChar).Value = HttpContext.Current.User.Identity.Name.ToString();
        commEditConsultant.Parameters.Add("@Season_Name", SqlDbType.VarChar).Value = Season.Text;
        commEditConsultant.Parameters.Add("@i_SK_Accom", SqlDbType.VarChar).Value = Request["i_SK_Accom"].Trim().ToString();
        commEditConsultant.Parameters.Add("@OP49_Required", SqlDbType.VarChar).Value = ddl_OP49Required.SelectedItem.Value;
        commEditConsultant.Parameters.Add("@Weekly", SqlDbType.VarChar).Value = ddl_OP49Weekly.SelectedItem.Value;
        commEditConsultant.Parameters.Add("@Daily", SqlDbType.VarChar).Value = ddl_OP49Daily.SelectedItem.Value;
    } 
```

上面指定的字段与 gridview 所需的字段相同，但我正在努力将 gridview`rRowEditing`值转换为变量/参数以传递给 SQLCommand。

感兴趣的ID：

```
 DataBinder - BindCountryGrid
  DataReader - CountryGridSelectReader 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T13:02:10.750

最终解决了：

背后的代码需要重新启用以下内容：

```
protected void CountryGridView_RowUpdating(object sender, GridViewUpdateEventArgs e)
        {
            Label Textbox_Accom = (Label)gv_CountryGridView.Rows[e.RowIndex].FindControl("lbl_Accom_Code");
            Label Textbox_Accom_Name = (Label)gv_CountryGridView.Rows[e.RowIndex].FindControl("lbl_Accom_Name");
            DropDownList Textbox_OP49 = (DropDownList)gv_CountryGridView.Rows[e.RowIndex].FindControl("ddl_OP49");
            DropDownList Textbox_Weekly = (DropDownList)gv_CountryGridView.Rows[e.RowIndex].FindControl("ddl_Weekly");
            DropDownList Textbox_Daily = (DropDownList)gv_CountryGridView.Rows[e.RowIndex].FindControl("ddl_Daily");
            TextBox Textbox_FRRStartDate = (TextBox)gv_CountryGridView.Rows[e.RowIndex].FindControl("txt_FRRStartDate");

            SqlCommand commEditConsultant = new SqlCommand("IFACE_JFA_ACCOM", ConnJFA);
            commEditConsultant.CommandType = CommandType.StoredProcedure;

            commEditConsultant.Parameters.Add("@Statement", SqlDbType.VarChar).Value = "AccomGridUpdate";
            commEditConsultant.Parameters.Add("@Page", SqlDbType.VarChar).Value = "OP49";
            commEditConsultant.Parameters.Add("@PC_Username", SqlDbType.VarChar).Value = HttpContext.Current.User.Identity.Name.ToUpper().ToString();
            commEditConsultant.Parameters.Add("@Season_Name", SqlDbType.VarChar).Value = txt_Season.Text;
            commEditConsultant.Parameters.Add("@Accom_Code", SqlDbType.VarChar).Value = Textbox_Accom.Text;
            commEditConsultant.Parameters.Add("@i_FK_SeasonID", SqlDbType.VarChar).Value = Request["i_FK_SeasonID"].Trim().ToString();
            commEditConsultant.Parameters.Add("@OP49_Required", SqlDbType.VarChar).Value = Textbox_OP49.Text;
            commEditConsultant.Parameters.Add("@Weekly", SqlDbType.VarChar).Value = Textbox_Weekly.Text;
            commEditConsultant.Parameters.Add("@Daily", SqlDbType.VarChar).Value = Textbox_Daily.Text;
            commEditConsultant.Parameters.Add("@FRR_StartDate", SqlDbType.VarChar).Value = Textbox_FRRStartDate.Text;

            ConnJFA.Open();
            commEditConsultant.ExecuteNonQuery();
            gv_CountryGridView.EditIndex = -1;
            Error_Dashboard.Text = Textbox_Accom.Text + " - " + Textbox_Accom_Name.Text + " Updated Successfully!";
            ConnJFA.Close();
            BindCountryGrid();

        } 
```

# binary - 0-1整数线性规划逼近算法

> ID：14962699
> 
> 赞同：1
> 
> 时间：2013-02-19T16:39:32.683
> 
> 标签：binary, integer, linear-programming, approximation

您好我正在寻找 0-1 整数线性规划的近似算法。目前，我发现的近似算法需要将区间放宽为 [0,1]。但是，我的问题只能将 0 或 1 视为解决方案。

有人有想法吗？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:19:00.783

获得积分解的经典过程是分支定界的。如果这不是您想要的，请提供更多详细信息。

# delphi - 接口和属性可见性

> ID：14962700
> 
> 赞同：4
> 
> 时间：2013-02-19T16:39:35.833
> 
> 标签：delphi, oop, interface, delphi-7

我有一个简单的界面

```
 ISomeProperties = interface
  ['{3AD52E4E-5190-4ABE-8AFC-062295E3A352}']
    function GetPort: integer;
    procedure SetPort(const Port: integer);
  end; 
```

GetFunction 和 SetFunction 在代码完成中可见。但是在我添加这样的属性之后

```
 ISomeProperties = interface
  ['{3AD52E4E-5190-4ABE-8AFC-062295E3A352}']
    function GetPort: integer;
    procedure SetPort(const Port: integer);
    property Port: integer read GetPort write SetPort;
  end; 
```

GetPort 和 SetPort 方法消失了，只有属性 Port 是可见的——太好了。

现在我实现一个接口

```
 TSomeProperties = class(TInterfacedObject, ISomeProperties)
  private
    function GetPort: integer;
    procedure SetPort(const Port: integer);
  end; 
```

但是属性**Port**在实现接口的类中是不可见的！这是理想的行为还是我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:57:22.670

类不是接口。接口上的属性只是语法糖，暴露了 Delphi 的 GetPort 和 SetPort 方法。

这个属性并不是真正必须或可以实现的东西（只有访问器方法），所以它在实现类中是不可见的，除非你也在那里定义了一个属性。您唯一可以实现的就是方法。

FWIW，当您定义属性时，这些方法不会“消失”。你仍然可以打电话给他们。接口的所有成员都具有相同的可见性。

# python - 使用bbox时没有设置python matplotlib文本颜色

> ID：14962705
> 
> 赞同：1
> 
> 时间：2013-02-19T16:39:47.750
> 
> 标签：python, matplotlib

如果我使用以下代码，则不会设置文本颜色。（文字颜色为黑色）

```
textBbox=dict(facecolor='w', edgecolor='None',alpha=0.9)

ax.text(0.5, 0.5 ,text,
    horizontalalignment='right',
    verticalalignment='top',
    bbox=textBbox,
    rotation="horizontal",
    size='x-small',
    weight='light',
    color="red",
    alpha=0.50,
    transform=trans) 
```

如果我删除该行

```
bbox=textBox, 
```

那么它将正常工作。

如何使用 bbox 并设置文本颜色？

# javascript - Jquery 中的多个 Javascript 函数

> ID：14962706
> 
> 赞同：1
> 
> 时间：2013-02-19T16:39:53.953
> 
> 标签：javascript, jquery, ajax, jquery-mobile

我已经有同样的问题很长时间了，我想知道是否有人可以教我我做错了什么。

我创建了一个多页 Jquery（如下例中的那个）但是，当我去添加对我保存的 .js 文件的引用时，它总是倾向于不加载页面内容，或者如果它只是定位在其他地方根本行不通！

我的 HTML 代码如下：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Find A Deal</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <style>
        img.fullscreen {
            max-height: 100%;
            max-width: 100%;
        }
        </style>

<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script type="text/javascript">
    $(document).on('pagebeforeshow', '#index', function(){
        $("#list").empty();
        var url="http://localhost/tmp/json4.php";
        $.getJSON(url,function(json){
            //loop through deals
            $.each(json.deals,function(i,dat){
                $("#list").append("<li><a id='"+dat.dealid+"' data-restaurantid=" + dat.restaurantid + " data-image=" + dat.image + "><h1>"+dat.name+"</h1><h6>"+dat.dname+"</h6><h5>"+dat.description+"</h5></a></li>");
                $(document).on('click', '#'+dat.dealid, function(event){  
                    if(event.handled !== true) // This will prevent event triggering more then once
                    {
                        dealObject.dealID = $(this).attr('id'); 
                        dealObject.restaurantid = $(this).attr('data-restaurantid');
                        dealObject.shortName = $(this).find('h1').html(); 
                        dealObject.image = $(this).attr('data-image');
                        //dealObject.dname = $(this).find('input').html();
                        //dealObject.dname = $(this).find('desc').val();
                        dealObject.dealName = $(this).find('h6').html();
                        dealObject.description = $(this).find('h5').html(); 
                        //dataObject.dname=$(this).find('p').html()
                        //dealObject.name = $(this).find('desc').eq(0).val(dealObject.name);

                        $.mobile.changePage( "#index2", { transition: "slide"} );
                        event.handled = true;
                    }
                });            
            });
            $("#list").listview('refresh');
        });
    });

    $(document).on('pagebeforeshow', '#index2', function(){       
        //$('#index2 [data-role="content"]').html('You have selected Link' + dealObject.dname);
        $('#index2 [data-role="content"]').find('#deal-img').attr('src',dealObject.dealObject);
        $('#index2 [data-role="content"]').find('#title').html(dealObject.name);
        //$('#index2 [data-role="content"]').find('#description').html(dealObject.dname);
                $('#index2 [data-role="content"]').find('input#desc').val(dealObject.description);
                $('#index2 [data-role="content"]').find('input#tname').val(dealObject.dealName);
                $('#index2 [data-role="content"]').find('input#dealid').val(dealObject.dealID);

    });

    var dealObject = {
        dealID : null,
        restaurantid : null,
        shortName : null,
        image : null,
        dealName : null,
        description: null
    }    
</script>

</head>     
<body>    
<div data-role="page" id="index">
    <div data-role="header" data-position="fixed">
        <h1>Current Deals</h1>
    </div>

    <div data-role="content">
        <div class="content-primary">
            <ul id="list" data-role="listview" data-filter="true"></ul>
        </div>
    </div>

    <div data-role="footer" data-position="fixed">
        <div data-role="navbar">
            <ul>
                <li><a href="http://localhost/findadeal/index.html" data-icon="home">Home</a></li>
                <li><a href="http://localhost/findadeal/mydeal.html" data-icon="grid">My Deals</a></li>
            </ul>
        </div>
    </div>
</div>

<!--New Page --> 
<div data-role="page" id="index2">
<!--<script src="js/ammend.js"></script>--!>
<div data-role="header">
        <h1> Find A Deal </h1> 
    </div>

    <div data-role="content">

 <!--       <?php
    if( !isset( $_SESSION ) ){
     session_start();
        }

    if( isset( $_SESSION['username'] ) ){
        echo ".";
        } ?>   --!>

        <form id="test">
        <label for="name">Deal Name:</label>
        <input type="text" value="" name="tname" id="tname"/>
        <label for="desc">Description</label>
        <input type="text" value="" name="desc" id="desc"/>  
        <a data-role="button" id="amend" data-icon="star" data-iconpos="left">Amend Deal </a>
        <input type="text" value="" name="dealid" id="dealid"/>

        <h3></h3>
        <!--<img src="" width="100px" height="100px" id="deal-img">
        <h1 id="title"></h1>
        <h3 id="description"></h3>
        <p id="name"></p>--!> 
    </div>

    <footer data-role="footer" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="index.html" data-icon="home">Home</a></li>
                <li><a href="#index" data-icon="grid">My Deals</a></li>
            </ul>
        </nav>
    </footer>   
</div>
</body>
</html> 
```

如果阅读困难，请见谅。这个 javascript 函数本身就可以正常工作。单击 index 中的项目时，它会将您带到 index2 中的新页面。在索引 2 上有一个提交按钮，连接到引用的文件`<script src="js/ammend.js"></script>`。对我来说，这就是事情通常出问题的地方，就像他们正在相互抵消或只是不合作。

该位置的 js 文件是：

```
$(document).on('pagebeforeshow', '#index2', function(){ 
$('#amend').on('click', function(){
    if($('#tname').val().length > 0 && $('#desc').val().length > 0 && $('#dealid').val().length > 0){
        userObject.tname = $('#tname').val(); // Put username into the object
        userObject.desc = $('#desc').val(); // Put password into the object
        userObject.dealid = $('#dealid').val();
        // Convert an userObject to a JSON string representation
        var outputJSON = JSON.stringify(userObject);
        // Send data to server through ajax call
        // action is functionality we want to call and outputJSON is our data
        ajax.sendRequest({action : 'index2', outputJSON : outputJSON});
    } else {
        alert('Please fill all nececery fields');
    }
 });    
});

$(document).on('pagebeforeshow', '#index2', function(){ 
if(userObject.name.length == 0){ // If username is not set (lets say after force page refresh) get us back to the login page
    $.mobile.changePage( "#index2", { transition: "slide"} ); // In case result is true change page to Index  
}
$(this).find('[data-role="content"] h3').append('Deal Amended:' + userObject.name); // Change header with added message
//$("#index").trigger('pagecreate');
});

// This will be an ajax function set
var ajax = {
sendRequest:function(save_data){
    $.ajax({url: 'http://localhost/test/login/amend.php',
        data: save_data,
        async: true,
        beforeSend: function() {
            // This callback function will trigger before data is sent
            $.mobile.showPageLoadingMsg(true); // This will show ajax spinner
        },
        complete: function() {
            // This callback function will trigger on data sent/received complete
            $.mobile.hidePageLoadingMsg(); // This will hide ajax spinner
        },
        success: function (num) {
            if(num == "true") {
                $.mobile.changePage( "#index", { transition: "slide"} ); // In case result is true change page to Index
            } else {
                alert('Deal has been added successfully'); // In case result is false throw an error
                $.mobile.changePage( "#index", { transition: "slide"} );
            }
            // This callback function will trigger on successful action
        },
        error: function (request,error) {
            // This callback function will trigger on unsuccessful action                
            alert('Error: " . mysql_error() . "Query: " . $query;');
        }
    });
}
}

// We will use this object to store username and password before we serialize it and send to server. This part can be done in numerous ways but I like this approach because it is simple
var userObject = {
tname : "",
desc : "",
dealid: ""
} 
```

按下按钮时应该调用上面的内容，但是大多数情况下，一旦我将引用添加到此代码中，我什至无法进入看到按钮的阶段。

如果有人以前遇到过与此相同的问题，或者可以对这个问题有所了解，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T14:42:00.733

您的问题与 jQuery Mobile 页面处理有关。

因为您正在使用通过 ajax 加载到 DOM 中的多个 HTML 页面，所以必须从第一个 HTML 文件中引用所有 js 脚本。所有其他 HTML 文件将仅部分加载，仅加载 BODY 部分，而 HEAD 将被丢弃。

# ios - 我们可以在 Facebook SDK 3.1 中使用 DeprecatedHeaders 多长时间？

> ID：14962708
> 
> 赞同：1
> 
> 时间：2013-02-19T16:40:01.037
> 
> 标签：ios, objective-c, facebook, apprequests

我需要从我的 iOS 应用程序向朋友发送邀请。我知道我可以使用“apprequests”和对话框来做到这一点，但是这个选项只有在我们使用“DeprecatedHeaders”时才有效。我们可以在 Facebook API 中使用 DeprecatedHeaders 多长时间？他们将来会支持它吗？是否有任何选项可以从 iOS 应用程序向朋友发送邀请？

我更喜欢使用 SDK 3.1 而不是旧版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T04:16:55.573

Facebook SDK 3.2 版于 2 月 24 日发布，这解决了已弃用的问题。

请参阅：[https ://developers.facebook.com/ios/features/whats-new-ios-sdk-3.2/](https://developers.facebook.com/ios/features/whats-new-ios-sdk-3.2/)

如果您需要，升级指南：[https ://developers.facebook.com/docs/tutorial/iossdk/upgrading-from-3.1-to-3.2/](https://developers.facebook.com/docs/tutorial/iossdk/upgrading-from-3.1-to-3.2/)

# ios - NSDateFormatter 格式化日期的星期

> ID：14962710
> 
> 赞同：0
> 
> 时间：2013-02-19T16:40:04.603
> 
> 标签：ios, objective-c, nsdate, nsdateformatter

我一直在寻找一种格式化以下 NSDate 对象的方法：

```
19 Feb 2013 
```

像那样

```
18-25 Feb 2013 
```

19 发生在 2 月 18 日至 25 日之间的一周内。

我没有一个简单的方法可以做到这一点，NSDateFormater 中是否有内置功能？我应该自己实施吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:00:58.340

我认为 NSDateFormatter 中没有内置功能可以做到这一点。但是，Apple 有一个[示例](https://developer.apple.com/Library/ios/#documentation/Cocoa/Conceptual/DatesAndTimes/Articles/dtCalendricalCalculations.html)，说明如何获取给定日期的一周的第一天和最后一天的 NSDate 值。这是他们获取本周星期日的示例：

```
NSDate *today = [[NSDate alloc] init];
NSCalendar *gregorian = [[NSCalendar alloc]
          initWithCalendarIdentifier:NSGregorianCalendar];

// Get the weekday component of the current date
NSDateComponents *weekdayComponents = [gregorian components:NSWeekdayCalendarUnit
          fromDate:today];

/*
Create a date components to represent the number of days to subtract from the current date.
The weekday value for Sunday in the Gregorian calendar is 1, so subtract 1 from the number of days to subtract from the date in question.  (If today is Sunday, subtract 0 days.)
*/
NSDateComponents *componentsToSubtract = [[NSDateComponents alloc] init];
[componentsToSubtract setDay: 0 - ([weekdayComponents weekday] - 1)];

NSDate *beginningOfWeek = [gregorian dateByAddingComponents:componentsToSubtract
          toDate:today options:0];

/*
Optional step:
beginningOfWeek now has the same hour, minute, and second as the original date (today).
To normalize to midnight, extract the year, month, and day components and create a new date from those components.
*/
NSDateComponents *components =
     [gregorian components:(NSYearCalendarUnit | NSMonthCalendarUnit |
          NSDayCalendarUnit) fromDate: beginningOfWeek];
beginningOfWeek = [gregorian dateFromComponents:components]; 
```

由于星期日不是所有语言环境中的一周的开始，它们还显示了如何获取日历语言环境定义的一周的开始：

```
NSDate *today = [[NSDate alloc] init];
NSDate *beginningOfWeek = nil;
BOOL ok = [gregorian rangeOfUnit:NSWeekCalendarUnit startDate:&beginningOfWeek
                     interval:NULL forDate: today]; 
```

# objective-c - 我应该释放传递给 NSBezierPath 的 setLineDash:count:phase: 方法的 C 数组吗？

> ID：14962714
> 
> 赞同：0
> 
> 时间：2013-02-19T16:40:18.677
> 
> 标签：objective-c, memory-management, nsbezierpath

我在 NSBezierPath 实例上设置划线样式：

```
NSBezierPath *path = [NSBezierPath path];
// Get the path information...

NSInteger count = 0;
// Get the array count...

CGFloat *dashLengths = (CGFloat *)malloc(sizeof(CGFloat) * count);
// Populate the array...

CGFloat phase = 0.0f;
// Get the phase...

[path setLineDash:dashLengths count:count phase:phase]; 
```

我应该在 dashLengths 上调用 free() 以防止内存泄漏吗？或者稍后释放数组会导致错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:49:13.253

你为什么首先使用`malloc`？只需声明

```
CGFloat dashLengths[count]; 
```

现在`dashLengths`是一个自动变量。无需内存管理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:42:27.167

不，你必须`free()`自己`malloc()`布置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:43:36.817

您应该在自由路径之后立即在 dashLengths 上调用 free()。NSBezierPath 没有办法保留它，因为它只是一个普通的 ol 指针，所以在 NSBezierPath 消失之前你不应该拿走那个内存。

# android - 更新eclipse后Android XML错误

> ID：14962717
> 
> 赞同：0
> 
> 时间：2013-02-19T16:40:26.233
> 
> 标签：android, xml

最近更新 eclipse 后，我不断收到一条错误消息，提示“与元素类型“RelativeLayout”关联的属性名称“android:tools”必须后跟“=”字符。

它在第 9 行说，但那里没有任何 android:tool 。我已经尝试清理并重新启动 Eclipse，但仍然没有解决方案。我从来没有改变过文件的任何部分，有趣的是我所有的其他活动都是一样的，没有任何错误。任何帮助将不胜感激。

编辑...我通过删除文件并创建一个新文件来解决问题。文件一定已经损坏或什么的。感谢大家的投入，对于运行混乱感到抱歉。

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@color/backtext"
    tools:context=".Brakes"
    android:screenOrientation="portrait" >

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="@string/brakes1"
        android:textColor="@color/textviews"
        android:textSize="15sp" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView2"
        android:text="@string/brakes2"
        android:textColor="@color/textviews"
        android:textSize="15sp" />
    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView3"
        android:text="@string/brakes3"
        android:textColor="@color/textviews"
        android:textSize="15sp"/>
    <TextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView4"
        android:text="@string/brakes4"
        android:textColor="@color/textviews"
        android:textSize="15sp"/>

</RelativeLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:45:06.477

尝试移动这条线：

```
xmlns:tools="http://schemas.android.com/tools" 
```

到你`ScrollView`的，而不是`RelativeLayout`现在的地方。

看起来您`RelativeLayout`曾经是您的根视图，并且您稍后添加了 ScrollView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:45:18.647

你在你的根父母中失踪`xmlns:tools="http://schemas.android.com/tools"`了，请包括它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:57:13.113

`xmlns:android="http://schemas.android.com/apk/res/android"`从您的 RelativeLayout 中删除。布局根元素中应该只有其中之一。

# c# - 将 byte[] 转换为对象

> ID：14962720
> 
> 赞同：1
> 
> 时间：2013-02-19T16:40:29.850
> 
> 标签：c#, serialization, memorystream

我正在尝试将我在 a`byte[]`中的对象转换为对象。我试过使用我在网上找到的这段代码：

```
object byteArrayToObject(byte[] bytes)
    {
        try
        {
            MemoryStream ms = new MemoryStream(bytes);
            BinaryFormatter bf = new BinaryFormatter();
            //ms.Position = 0;
            return bf.Deserialize(ms,null);
        }
        catch
        {
            return null;
        }
    } 
```

> SerializationException：“在解析完成之前遇到流结束。”。

我`ms.Position = 0`当然也尝试过使用未注释的行... `bytes[]`只有 8 个字节长，每个字节都不是`null`.

建议？

[编辑]

byte[] 是从 C++ 程序使用类似于以下内容的东西写入二进制文件的

```
void WriteToFile (std::ostream& file,T* value)
{
    file.write(reinterpret_cast<char*>(value), sizeof(*T))
} 
```

其中 value 可能是许多不同的类型。我可以使用 BitConverter 从文件中转换为一些对象，但是 BitConverter 没有涵盖的任何内容我都做不到..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:15:32.000

正如 cdhowie 所说，您将需要手动反序列化编码数据。根据可用的有限信息，您可能需要对象数组或包含数组的对象。看起来您有一个 long 但无法从您的代码中知道。您将需要以真实形式重新创建对象，因此以下面的 myLong 作为单个长数组的简单示例。由于未指定，我假设您想要一个包含如下数组的结构：

```
public struct myLong {
    public long[] value;
} 
```

您可以对结构数组或对下面发布的代码进行细微更改的类执行相同的操作。

您的方法将是这样的：（在编辑器中编写）

```
private myLong byteArrayToObject(byte[] bytes) {
    try
    {
        int len = sizeof(long);
        myLong data = new myLong();
        data.value = new long[bytes.Length / len];
        int byteindex = 0;
        for (int i = 0; i < data.value.Length; i++) {
           data.value[i] = BitConverter.ToInt64(bytes,byteindex);
           byteindex += len;
        }            
        return data;
    }
    catch
    {
        return null;
    }
} 
```

# python - 减少 Flask 和 Flask-SQLAlchemy 中的重复代码

> ID：14962721
> 
> 赞同：0
> 
> 时间：2013-02-19T16:40:31.633
> 
> 标签：python, flask, flask-sqlalchemy

我正在使用 Flask-SQLAlchemy，并且我有一个包含各种表和关系的数据库。我希望用户能够在表中创建一个条目，例如（类别）编辑表中的条目并查看该表中的所有条目。

所以我有两个类Category和Revision。类别只有一个名称，而修订有一个名称和一个版本。

我要添加和编辑的代码是：

## 类别

```
def addCategory(name):
    cat = models.Category(name=name)
    db.session.add(cat)
    try:
        db.session.commit()
    except sqlalchemy.exc.IntegrityError:
        print "adding a row that violates the unique constraint" 
```

## 修订

```
def addRevision(name, version):
    cat = models.Revision(name=name, version=version)
    db.session.add(cat)

    try:
        db.session.commit()
    except sqlalchemy.exc.IntegrityError:
        print "adding a row that violates the unique constraint" 
```

## 类别

```
def editCategory(name, newName):
    cat = models.Category.query.filter_by(name=name).first()
    if cat:
        cat.name = newName
        db.session.add(cat)
        try:
            db.session.commit()
            return True
        except sqlalchemy.exc.IntegrityError:
            print "That Category already exists"
    return False 
```

## 修订

```
def editRevision(name, version, newName, newVersion):
    rev = models.Revision.query.filter_by(name=name, version=version).first()
    if rev:
        rev.name = newName
        rev.version = newVersion
        db.session.add(rev)
        try:
            db.session.commit()
            return True
        except sqlalchemy.exc.IntegrityError:
            print "That Revision already exists"
    return False 
```

我的模板也是如此。查看所有类别与查看所有修订非常相似。添加修订与添加类别类似。ETC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:05:32.287

[可插入视图](http://flask.pocoo.org/docs/views/#pluggable-views)应该可以帮助您减少重复的代码。

# console-application - 如何在 EWL 中配置服务器端控制台项目？

> ID：14962734
> 
> 赞同：1
> 
> 时间：2013-02-19T16:41:00.223
> 
> 标签：console-application, worker, enterprise-web-library

我知道我必须在 Development.xml 中定义这一部分：

```
<serverSideConsoleProjects>
    <project>
        <Name>Program</Name>
        <AssemblyName>Assembly</AssemblyName>
    </project>
</serverSideConsoleProjects> 
```

我还需要做什么吗？这实际上对解决方案或任何包管理器控制台操作有什么影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T13:09:26.313

本质上，声明服务器端控制台项目会导致该项目的构建输出包含在控制台操作`Logic Packages`在您的解决方案文件夹中创建的文件夹中。`ExportLogic`据我所知，EWL 目前对这些项目没有任何其他作用。

# javascript - 如何从这个 jsFiddle 动态添加延迟到承诺？

> ID：14962737
> 
> 赞同：6
> 
> 时间：2013-02-19T16:41:06.600
> 
> 标签：javascript, events, deferred, promise, when-js

关于[这个 jsFiddle](http://jsfiddle.net/ditman/hc7pS/)，我正在尝试动态添加一个在事件触发时创建的“延迟”，因此只有在解决所有延迟时才调用 done 回调，包括稍后添加的回调：

相关代码：

```
var promises = [ deferred1, ... ];
var p = when.all(promises).then(function() {
  console.log('All done!!');
  //! trigger
});

promises.push( deferredFromEvent ); // << ignored 
```

更新：欢迎使用 Q 或 jQuery 的建议，我正在寻找一个可行的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T03:52:38.613

将您的固定承诺视为一个单独的捆绑包，而不是动态承诺。

等待捆绑的 Promise，然后通过初始空数组上的a[管道](http://api.jquery.com/deferred.pipe/)它们的组合结果。`$.when()`您可以随时将新的 Promise 动态推送到该数组中。

[http://jsfiddle.net/atesgoral/YVkVa/1/](http://jsfiddle.net/atesgoral/YVkVa/1/)

HTML：

```
<p>You have 5 seconds to inject!</p>
<button id="inject">Inject Deferred 3</button>
<button id="resolve">Resolve Deferred 3</button>
<p>Deferred 1: <span id="dfd1">pending<span></p>
<p>Deferred 2: <span id="dfd2">pending<span></p>
<p>Deferred 3: <span id="dfd3">pending<span></p>
<h1 id="result"></h1> 
```

JavaScript：

```
var dfd1 = $.Deferred(),
    dfd2 = $.Deferred(),
    fixed = [ dfd1.promise(), dfd2.promise() ],
    multiplexed = $.when.apply($, fixed), // Bundle the fixed ones
    reservoir = []; // Reservoir for dynamic promises

// The solution to your problem lies here. The rest is scaffolding.
var ultimate = multiplexed.pipe(function () {
    return $.when.apply($, reservoir);
});

ultimate.done(function() {
    $("#result").text("Done!");
});

window.setTimeout(function () {
    dfd1.resolve();
    $("#dfd1").text("resolved");
}, 2500);

window.setTimeout(function () {
    dfd2.resolve();
    $("#dfd2").text("resolved");
}, 5000);

var dfd3 = $.Deferred();

$("#inject").click(function () {
    reservoir.push(dfd3.promise());
});

$("#resolve").click(function () {
    dfd3.resolve();
    $("#dfd3").text("resolved");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T04:45:38.927

“......所以只有在解决所有延迟时才调用完成的回调，包括后来添加的那些”没有意义，但我想我知道你的意思。

如果我理解正确，那么您想要可能被称为“可重新触发 when()”的东西 - 类似这样的东西（基于 jQuery）：

```
function PromiseSet(memory, once) {//javascript Constructor
    var flags = [];
    if(memory) flags.push('memory');
    if(once) flags.push('once');
    var promises = [],
        doneCallbacks = $.Callbacks(flags.join(' ')),
        failCallbacks = $.Callbacks(flags.join(' '));
    this.add = function(promise, val) {
        promises.push(promise);
        if(val) { this.fire(val); }
        return this;
    };
    this.done = function(fn) {
        doneCallbacks.add(fn);
        return this;
    };
    this.fail = function(fn) {
        failCallbacks.add(fn);
        return this;
    };
    this.fire = function(val) {
        val = val || null;
        $.when.apply($, promises).then(
            function() { doneCallbacks.fire(val); },
            function() { failCallbacks.fire(val); }
        );
        return this;
    };
    return this;
} 
```

*未经测试*

所有方法都返回 this 以使它们可链接。

如果我正确编写了构造函数，那么您可以通过将布尔值传递给`new PromiseSet()`. 对于您提议的用法，我认为您需要通过`(true, false)`，但尝试其他设置以查看会发生什么。

样本序列：

```
var myPromiseSet = new PromiseSet(true, false);
myPromiseSet.add(promise1);
myPromiseSet.add(promise2).add(promise3);
myPromiseSet.done(myDoneFunction).fail(myFailFunction);
myPromiseSet.fire("foo");
myPromiseSet.add(promise4).fire(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-23T09:32:49.017

看看这个解决方案。通过这种实现，您可以跟踪许多动态添加的 Promise。如果您使用的是 jQuery Deferred，您可以这样做。 [jsFiddle](http://jsfiddle.net/hc7pS/13/)

请注意，我使用[了 _.every](https://lodash.com/docs#every)来自 lodash 库的方法，因此您也需要安装 lodash

```
function doAlotOfAsyncThings(callback) {
    var promises = [];
    var def = $.Deferred();
    console.log('Adding first promise');
    promises.push(def.promise());

    setTimeout(function() {
        // Dinamically adding second promise. Important note: last added promise must be added to array BEFORE previous promise has been resolved
        var def2 = $.Deferred();
        var def3 = $.Deferred();
        console.log('Dinamically adding second and third promises');
        promises.push(def2.promise());
        promises.push(def3.promise());
        console.log('Resolving first promise');
        def.resolve();

        setTimeout(function() {
            console.log('Resolving second and third promises');
            def2.resolve();
            def3.resolve();
        }, 1500);
    }, 1000);

    function checkAllDone() {
        console.log('Checking $.when');
        $.when.apply(null, promises).then(function() {
            // we have to check state of every promise in array
            var all_resolved = _.every(promises, function(elem) { return elem.state() == 'resolved'; });
            if(all_resolved) {
                console.log('All promises are resolved! callback();')
                callback();
            } else {
                console.log('Hm, seems that some promises were dinamically added, waiting for them..');
                checkAllDone();
            }
        });
    }
    checkAllDone();
}

doAlotOfAsyncThings(function(){
    console.log('Done');
}); 
```

使用 Q.js，它甚至更短。
在这个解决方案中，我使用[_.any](https://lodash.com/docs#some)来自 lodash 库的方法

```
function doAlotOfAsyncThings(callback) {
    var promises = [];
    var def = Q.defer();
    console.log('Adding first promise');
    promises.push(def.promise);

    setTimeout(function() {
        // Dinamically adding second promise. Important note: last added promise must be added to array BEFORE previous promise has been resolved
        var def2 = Q.defer();
        var def3 = Q.defer();
        console.log('Dinamically adding second and third promises');
        promises.push(def2.promise);
        promises.push(def3.promise);
        console.log('Resolving first promise');
        def.resolve();

        setTimeout(function() {
            console.log('Resolving second and third promises');
            def2.resolve();
            def3.resolve();
        }, 1500);
    }, 1000);

    function checkAllDone() {
        console.log('Checking $.when');
        Q.all(promises).then(function() {
            // Q remove resolved promises from array so we have to check if array contains some non-undefined elements (those elements would be non-resolved dinamically added promises)
            if(_.any(promises)) {
                console.log('Hm, seems that some promises were dinamically added, waiting for them..');
                checkAllDone();
            } else {
                console.log('All promises are resolved! callback();')
                callback();
            }
        });
    }
    checkAllDone();
}

doAlotOfAsyncThings(function(){
    console.log('Done');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T17:59:02.210

预先创建您知道需要的所有承诺。与他们建立一个`.when`。保存从`.when`. 当您添加需要新承诺的新事件时，请`.when`使用之前的承诺添加新的`.when`s，以及您已完成的任何新承诺。

`single points of failure`如果您使用 final`.when`作为“继续使用应用程序” ，您的应用程序将有多个。IE：如果任何一个承诺在任何时候失败，那么之后`.when`创建的任何承诺也将失败。

...但是如果这是您的意图，或者您有一些可靠的错误处理，那么您应该这样做。

我试图让这个库与库无关——通常，我使用自己的实现，它介于 jQuery 所做的事情和 Crockford 在最近一次谈话中所做的事情之间，但如果我们假设：

函数返回promise-handlers
“当”返回promise-handler promise-handlers 至少有一个`.done`and `.fail`-- 或者接受两个参数，或者函数内部发生的任何事情和任何事情都将控制promise是`rejected/resolved`or `kept/broken`（或其他），然后你最终可能会得到一堆看起来像这样的功能：

```
var doing = doSomething(),     // returns promise
    making = makeSomething(),  // returns promise
    loading = loadSomething(), // returns promise

    dependencies_lvl_1 = when(doing, making, loading); 
```

稍后，您可能会添加一个新模块或小部件——也许它会节省一些工作：

```
var saving = saveSomething(), //returns promise
    dependencies_lvl_2 = when(dependencies_lvl_1, saving); 
```

也许在那之后，您需要切换页面，但是您需要先缓存数据

```
var caching = cacheData(),   // returns promise
    when(dependencies_lvl_2, caching)
        .done(goToNextPage)
        .fail(handleError); 
```

如果您查看它，您就会知道一个事实，即只要`when`返回一个只有在所有承诺都被遵守（并且当所有承诺都被遵守时）才会成功的承诺，并且它们都没有破坏，那么`dependencies_lvl_2`就包括来自 的所有依赖项`dependencies_lvl_1`，加上额外的承诺。

那么， level-3`.when`的分辨率取决于添加到链中的每一件事。

只要你不断地将你的承诺缓存到变量中（或某种未来的访问），你就可以继续将它们链接在一起，成为永恒。

# python - 在 matplotlib 的参数图中添加箭头

> ID：14962739
> 
> 赞同：2
> 
> 时间：2013-02-19T16:41:09.920
> 
> 标签：python, matplotlib

我正在做多个变量随时间变化的模拟。有时，绘制变量而不是相对于时间轴（x(t) 与 t）而是相对于彼此（x(t) 与 y(t)）很有用。在这些情况下，如果我可以添加某种箭头（覆盖在曲线上）来指示时间流向，那就太好了。

我的问题：有没有人知道一个简单或内置的方法来做到这一点，或者我应该自己破解一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:05:23.623

试试这个（来自 matplotlib 食谱[http://www.scipy.org/Cookbook/Matplotlib/Arrows](http://www.scipy.org/Cookbook/Matplotlib/Arrows)）：

```
from pylab import *
from numarray import *

x = arange(10)
y = x

# Plot junk and then a filled region
plot(x, y)

# Now lets make an arrow object
arr = Arrow(2, 2, 1, 1, edgecolor='white')

# Get the subplot that we are currently working on
ax = gca()

# Now add the arrow
ax.add_patch(arr)

# We should be able to make modifications to the arrow.
# Lets make it green.
arr.set_facecolor('g') 
```

![在此处输入图像描述](../Images/ff16d964c6dd3843f6dac89393d91cdb.png)

# cocos2d-iphone - 单声道触摸中的子类绑定类型

> ID：14962741
> 
> 赞同：3
> 
> 时间：2013-02-19T16:41:13.977
> 
> 标签：cocos2d-iphone, xamarin.ios

当我对绑定 obj-C 类型的类型进行子类化时，我遇到了一个问题。在某些情况下，它会在构建时失败。

我现在可以用 cocos2d 绑定和 CCSprite 重现这个。这是我的子类

```
public class MySprite : CCSprite
{
    public MySprite (string filename) : base (filename)
    {}
} 
```

当我实例化它时，它失败了：

```
Stacktrace:

  at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging.void_objc_msgSendSuper_IntPtr (intptr,intptr,intptr) <IL 0x00025, 0xffffffff>
  at MonoTouch.Cocos2D.CCSprite.set_Texture (MonoTouch.Cocos2D.CCTexture2D) <IL 0x00048, 0x00137>
  at (wrapper runtime-invoke) <Module>.runtime_invoke_void__this___object (object,intptr,intptr,intptr) <IL 0x00052, 0xffffffff>
  at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSendSuper_IntPtr (intptr,intptr,intptr) <IL 0x00027, 0xffffffff>
  at MonoTouch.Cocos2D.CCSprite..ctor (string) <IL 0x00072, 0x001a3>
  at Demo.MySprite..ctor (string) <IL 0x00002, 0x00027>
 [...]

Native stacktrace:

    0   Demo                       0x00115b5c mono_handle_native_sigsegv + 284
1   Demo                       0x00089c38 mono_sigsegv_signal_handler + 248
2   libsystem_c.dylib                   0x962af86b _sigtramp + 43
3   ???                                 0xffffffff 0x0 + 4294967295
4   Demo                       0x0003b9d2 -[CCSprite setOpacityModifyRGB:] + 47
5   Demo                       0x0003c18c -[CCSprite updateBlendFunc] + 267
6   Demo                       0x0003c37c -[CCSprite setTexture:] + 488
7   ???                                 0x11cadc94 0x0 + 298507412
8   ???                                 0x11cada78 0x0 + 298506872
9   ???                                 0x11cadbf6 0x0 + 298507254
10  Demo                       0x0008dff2 mono_jit_runtime_invoke + 722
11  Demo                       0x001f0b7e mono_runtime_invoke + 126
12  Demo                       0x00293736 monotouch_trampoline + 3686
13  Demo                       0x0003909e -[CCSprite initWithTexture:rect:rotated:] + 614
14  Demo                       0x0003914d -[CCSprite initWithTexture:rect:] + 70
15  Demo                       0x0003934c -[CCSprite initWithFile:] + 275
16  ???                                 0x11cad803 0x0 + 298506243
17  ???                                 0x11cad6ec 0x0 + 298505964
18  ???                                 0x11cace30 0x0 + 298503728
19  ???                                 0x11cac958 0x0 + 298502488
20  ???                                 0x11ca7f04 0x0 + 298483460
21  ???                                 0x0d7f7258 0x0 + 226456152
22  ???                                 0x0d7f0a7c 0x0 + 226429564
23  ???                                 0x0d7f0dc5 0x0 + 226430405
24  Demo                       0x0008dff2 mono_jit_runtime_invoke + 722
25  Demo                       0x001f0b7e mono_runtime_invoke + 126
26  Demo                       0x00293736 monotouch_trampoline + 3686
27  UIKit                      0x016c59d6 -[UIApplication _callInitializationDelegatesForURL:payload:suspended:] + 1292
28  UIKit                      0x016c68a6 -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 508
29  UIKit                      0x016d5743 -[UIApplication handleEvent:withNewEvent:] + 1027
30  UIKit                      0x016d61f8 -[UIApplication sendEvent:] + 68
31  UIKit                      0x016c9aa9 _UIApplicationHandleEvent + 8196
32  GraphicsServices           0x042bafa9 PurpleEventCallback + 1274
33  CoreFoundation             0x037231c5 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 53
34  CoreFoundation             0x03688022 __CFRunLoopDoSource1 + 146
35  CoreFoundation             0x0368690a __CFRunLoopRun + 2218
36  CoreFoundation             0x03685db4 CFRunLoopRunSpecific + 212
37  CoreFoundation             0x03685ccb CFRunLoopRunInMode + 123
38  UIKit                      0x016c62a7 -[UIApplication _run] + 576
39  UIKit                      0x016c7a9b UIApplicationMain + 1175
40  ???                        0x0d7ebbc5 0x0 + 226409413
41  ???                        0x0d7e5020 0x0 + 226381856
42  ???                        0x0d7e4390 0x0 + 226378640
43  ???                        0x0d7e44e6 0x0 + 226378982
44  Demo                       0x0008dff2 mono_jit_runtime_invoke + 722
45  Demo                       0x001f0b7e mono_runtime_invoke + 126
46  Demo                       0x001f4d74 mono_runtime_exec_main + 420
47  Demo                       0x001fa165 mono_runtime_run_main + 725
48  Demo                       0x000eb4d5 mono_jit_exec + 149
49  Demo                       0x002889f5 main + 2005
50  Demo                       0x00086f81 start + 53 
```

让我担心的是，我有类似的代码在不同的应用程序中工作。

完整地说，如果我覆盖 Texture 属性以代理到 base，它不会再崩溃，但不会显示任何内容，所以我怀疑本机对象的形状不好。

我还尝试了 [注册] 类，并添加默认构造函数覆盖。

**[更新]**我将这个项目与另一个正在运行的项目进行了比较。事实上，**两者**都在设备上工作，并且在模拟器中**都**以相同的方式失败。

**[UPDATE2]**这是一个触发行为的示例：[https](https://github.com/StephaneDelcroix/mt-subclassbug) ://github.com/StephaneDelcroix/mt-subclassbug这`Cocos2D.dll`是今天早上从`monotouch-bindings` `master`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T12:16:00.610

回答我自己的问题。该错误不在绑定定义中，也不在用于生成它们的工具中，而是在 cocos2d 的 2.1rc0 版本中。升级到 2.1rc0a 修复了它。

然后这会触发一个新问题，但可以追溯到绑定定义，并在此处修复[https://github.com/mono/monotouch-bindings/pull/97](https://github.com/mono/monotouch-bindings/pull/97)

# kendo-ui - 当使用新选项刷新时，iframe 模式下的剑道弹出窗口不会获取新的 url

> ID：14962742
> 
> 赞同：1
> 
> 时间：2013-02-19T16:41:13.783
> 
> 标签：kendo-ui

编辑：我已经放弃了条件结构，只是每次都创建新鲜的窗口。这样可行。仍然想知道 refresh() 是否适用于 url。

我有一个类似于这个的条件结构：

[将新内容加载到剑道窗口的正确方法是什么？](https://stackoverflow.com/questions/14505160/what-is-the-proper-way-to-load-new-content-into-a-kendo-window)

如果剑道窗口已经存在，请刷新（）窗口而不是重新创建它。

不同之处在于，我使用的是带有 url 的 iframe。

问题：我在调用 refresh() 之前使用 setOptions 设置了不同的查询字符串，但是再次从服务器请求*原始url。*

```
 if (!kwindow) {
        kwindow =  $("#messagewindow").kendoWindow({ 
        iframe: true,
        width: "400px",
        height: "600px",               
        title: "original title", 
        content: "foo.htm?id=1",
        type: "GET"
    }).data("kendoWindow");    

  }else {

     kwindow.setOptions({
        iframe: true,
        type: "GET",
        title: aDifferentTitle,                    
        url : "foo.htm?id=2" 
     });
     kwindow.refresh(); 

  }
   kwindow.open(); 
```

我知道**setOptions**方法将选项传递给剑道窗口，因为窗口的标题栏正确显示*aDifferentTitle*。但是，查看网络流量监视器，从服务器请求的 url`foo.htm?id=1`应该是`foo.htm?id=2`.

我看不出我的代码有什么问题，如果有人能向我指出错误，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-03T05:50:31.517

您正在寻找的答案是

kwindow.options.content.url = url;

然后刷新图标/方法将适用于新的 url

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T11:33:17.587

我使用了以下内容，它似乎在 MVC 项目中工作：

```
 window.setOptions({
        title: "New Title"
     });

    window.refresh({
        url: "/ControllerName/Action"
    });

    window.open(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:28:49.957

要从不同的 URL 刷新，您需要通过选项对象将其传递给**refresh**方法（您不需要使用 setOptions）。这是[文档](http://docs.kendoui.com/api/web/window#refresh)中的片段：

```
var windowObject = $("#window").data("kendoWindow");
windowObject.refresh("/feedbackForm");

windowObject.refresh({
    url: "/feedbackForm"        
}); 
```

# actionscript-3 - 流式音频和视频 AS3

> ID：14962746
> 
> 赞同：0
> 
> 时间：2013-02-19T16:41:18.830
> 
> 标签：actionscript-3, flash

我有几个正在流式传输的视频。我从 开始`video_1.flv`并且 在它完成之后`video_2.flv`正在运行和循环 直到用户采取一些动作来播放其他电影`video_3.flv`。所以我需要`video_2.flv`在后台播放时播放音频文件`sound.mp3`，女巫将被循环播放，女巫我设法做到了。但我需要他们两个独立运行。因为现在当视频循环播放时，音频正在循环播放。而且我需要仅在播放时`video_2.flv`播放音频。谢谢你。

```
var nc:NetConnection = new NetConnection();
nc.connect(null);

var ns:NetStream = new NetStream(nc);
loader.vid.Video_1.attachNetStream(ns);

var listener:Object = new Object();
listener.onMetaData = function(evt:Object):void {};
ns.client = listener;

ns.play("http://media.easyads.bg/ads/display_ads_richmedia/video/avon/maria_ilieva/video_1.flv");
ns.addEventListener(NetStatusEvent.NET_STATUS, NCListener);

var clipTimer:Timer = new Timer(4000);

function NCListener(e:NetStatusEvent){

    if (e.info.code == "NetStream.Play.Stop") {

        ns.play("http://media.easyads.bg/ads/display_ads_richmedia/video/avon/maria_ilieva/video_2.flv");
        sound.load(req);
        shaker(null);
        }
};

    var sound:Sound = new Sound();
    var soundChannel:SoundChannel;
    var req:URLRequest = new URLRequest("sound.mp3");
    sound.addEventListener(Event.COMPLETE, onSoundLoadComplete);

    function onSoundLoadComplete(e:Event):void{
        sound.removeEventListener(Event.COMPLETE, onSoundLoadComplete);
        soundChannel = sound.play();
        soundChannel.addEventListener(Event.SOUND_COMPLETE, onSoundChannelSoundComplete);
    }

    function onSoundChannelSoundComplete(e:Event):void{
        e.currentTarget.removeEventListener(Event.SOUND_COMPLETE, onSoundChannelSoundComplete);
        soundChannel = sound.play();
    }
loader.button_01.addEventListener(MouseEvent.CLICK, play_video_01);
loader.button_01.addEventListener(MouseEvent.ROLL_OVER, play_effect_01);

function play_video_01 (event:MouseEvent){

    clipTimer.stop();
    ns.play("http://media.easyads.bg/ads/display_ads_richmedia/video/avon/maria_ilieva/video_3.flv");
    loader.button_01_mc.gotoAndPlay (41);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T14:29:24.533

也许本教程对您有帮助...我是 AS 的新手，但我宁愿将整个 s.... 的东西打包成一个（可重用的）类...

[加载的 SWF 文件的行为与影片剪辑的行为](http://www.flashandmath.com/howtos/swfs/index.html)

问候

哎呀

# django - Django模型错误超出最大递归深度

> ID：14962748
> 
> 赞同：3
> 
> 时间：2013-02-19T16:41:24.283
> 
> 标签：django, django-models

我正在按照本[指南](http://www.acedevs.com/blog/2011/07/25/quick-qr-codes-django/)进行操作，但在保存时出现以下错误...

```
RuntimeError at /admin/products/product/2/
maximum recursion depth exceeded 
```

为什么我会收到此错误？我在下面包含了完整的模型。

谢谢

**模型.py：**

```
class Product(models.Model):
    title = models.CharField(max_length=60)
    qr_url = models.URLField(blank=True)
    qr_image = models.ImageField(
        upload_to="public/uploads/",
        height_field="qr_image_height",
        width_field="qr_image_width",
        null=True,
        blank=True,
        editable=False
    )
    qr_image_height = models.PositiveIntegerField(null=True, blank=True, editable=False)
    qr_image_width = models.PositiveIntegerField(null=True, blank=True, editable=False)

    #FK
    category = models.ManyToManyField(ProductCategory)
    attribute_answers = models.ManyToManyField(AttributeAnswers)
    # Custom Managers

    def __unicode__(self):
        return self.title

    def qr_code(self):
        return '' % self.qr_image.url
    qr_code.allow_tags = True

def product_pre_save(sender, instance, **kwargs):
    if not instance.pk:
        instance._QRCODE = True
    else:
        if hasattr(instance, '_QRCODE'):
            instance._QRCODE = False
        else:
            instance._QRCODE = True

models.signals.pre_save.connect(product_pre_save, sender=Product)

def product_post_save(sender, instance, **kwargs):
    if instance._QRCODE:
        instance._QRCODE = False
    if instance.qr_image:
        instance.qr_image.delete()
    qr = QRCode(4, QRErrorCorrectLevel.L)
    qr.addData(instance.qr_url)
    qr.make()
    image = qr.makeImage()

    #Save image to string buffer
    image_buffer = StringIO()
    image.save(image_buffer, format='JPEG')
    image_buffer.seek(0)

    #Here we use django file storage system to save the image.
    file_name = 'UrlQR_%s.jpg' % instance.id
    file_object = File(image_buffer, file_name)
    content_file = ContentFile(file_object.read())
    instance.qr_image.save(file_name, content_file, save=True)

models.signals.post_save.connect(product_post_save, sender=Product) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T16:57:13.033

您的 post save 信号调用 save 调用 post save 信号调用 save ...

这基本上是一个无限循环，运行时会因最大递归错误而终止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T17:02:17.913

你从教程中以错误的方式复制:)

```
def product_post_save(sender, instance, **kwargs):
    if instance._QRCODE:
        instance._QRCODE = False
        if instance.qr_image:
            instance.qr_image.delete()
        qr = QRCode(4, QRErrorCorrectLevel.L)
        qr.addData(instance.qr_url)
        qr.make()
        image = qr.makeImage()

        #Save image to string buffer
        image_buffer = StringIO()
        image.save(image_buffer, format='JPEG')
        image_buffer.seek(0)

        #Here we use django file storage system to save the image.
        file_name = 'UrlQR_%s.jpg' % instance.id
        file_object = File(image_buffer, file_name)
        content_file = ContentFile(file_object.read())
        instance._already_saving = True
        instance.qr_image.save(file_name, content_file, save=True) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-03T06:10:39.537

为了解决这个问题，你应该在数据库中增加一个字段，这个字段将描述插入的记录是通过简单的视图或信号插入的。然后在接收器函数中，您应该检查是否通过信号插入了实例，如果是，则不要应用接收器函数

```
@receiver(post_save) def my_callback(using,sender,instance,**kwargs):
   if not(instance.added_by == 'signal'):
       obj = Student1()
       obj.name = instance.name
       obj.city = instance.city
       obj.state = instance.state
       obj.postal_code = instance.postal_code
       obj.age = instance.age
       obj.added_by = 'signal'
       obj.save() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-06T03:42:02.070

我的方法只是使用 QuerySet 对象的 udpate 方法，而不是从模型中保存一个：

```
Model.objects.filter(pk=obj.pk).update(fieldx=valuey) 
```

# authentication - 从 iFrame 登录 Google

> ID：14962750
> 
> 赞同：1
> 
> 时间：2013-02-19T16:41:28.953
> 
> 标签：authentication, iframe, joomla, openid

我已经看到不可能从 iframe 显示任何 Google 页面。显示错误信息：无法显示，在新窗口中打开。

我需要从 Joomla 中的 iFrame 登录到 Google（OpenId 身份验证）（无法更改）。有解决方法吗？我以为我可以在新窗口中打开身份验证页面，然后尝试杀死该窗口并重新加载原始窗口，但我不确定我能做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:44:04.420

好吧，您可以只获取表单（html 代码）并将其放入 iframe 中，但这会变得非常混乱，例如，您可能还需要包含某些 JS 文件。

重定向到谷歌是实现它的最佳方式。由于安全原因，某些公司有时不允许使用 IFrame。

# jquery - Jquery 切换事件改为切换可见性

> ID：14962752
> 
> 赞同：0
> 
> 时间：2013-02-19T16:41:33.860
> 
> 标签：jquery, toggle

这是我的 jQuery：

```
$('#help').toggle(function () {
  $('#center').animate({
    paddingTop: '70px'
  }, 200);
  $('.child_help').slideDown(300);
}, function () {
  $('#center').animate({
    paddingTop: '50px'
  }, 200);
  $('.child_help').slideUp(300);
}); 
```

当我加载页面时，它会切换`#help`. 我想要做的是当你点击它时，它应该`.child_help`向上或向下滑动，并做一些填充动画。
在 jQuery API 上，它只说：
`Note: jQuery also provides an animation method named .toggle() that toggles the visibility of elements. Whether the animation or the event method is fired depends on the set of arguments passed.`

我可以看到的触发事件或切换可见性之间的唯一区别是，如果它是`$('#help').toggle(function () { do something here })`，而不是`$('#help').toggle('slow');`

我在这里缺少什么吗？

编辑：以下是我的 HTML

```
<div id="center">
  <div class="child_help">
    some help text here
  </div>
  <div class="child">
    <b>Account Activation</b>
    <img src="/css/images/help.png" alt="" id="help" />
  </div>
  <form method='post'>
    <input type="text" name="code" value="Code" class="code" />
    <span class="case">Case-sensitive</span>
    <input type="submit" name="submit" value="Activate" class="submit" />
  </form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:45:15.667

[演示](http://jsfiddle.net/9x6Vx/1/)

```
$(function(){
  $("#help").click(function(){
     var padding="70px";
     if($(".child_help").css("display")=="none") padding="50px";

     $('#center').animate({
         paddingTop: padding
     }, 200);

     $(".child_help").slideToggle();
  });
}); 
```

# iphone - ios从不同类调用方法的不同方式

> ID：14962754
> 
> 赞同：-6
> 
> 时间：2013-02-19T16:41:42.963
> 
> 标签：iphone, ios, function, ios4

从多个类调用函数的不同方法是什么？

我知道协议、通知，但任何人都可以用例子来描述所有这些，哪一个是最好的？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:24:14.430

我不认为这是一个如此可怕的问题。很多人对这个问题的“最佳”方面做出了否定的反应。一个简单的改写可能是“什么情况最适合每种对象间通信”。

总结起来比较常见的有以下几种：

*   直接调用（google Objective-C 语言方法）- 最常见、最直接、紧密协作的对象。
*   KVO (google "Objective-C KVO") - 让一个特定对象观察另一个特定值的变化。
*   NSNotification (google "NSNotification") - 让任何/许多感兴趣的对象观察另一个对象想要广播的任何事件
*   委托（谷歌“Objective-C 委托”）——当一个对象需要其他对象代表它完成工作时，它会发布一个委托协议。其他对象可以实现这个协议（“符合它”），然后被分配为委托。（在我看来，这个被过度使用了）

有大量关于如何实现每一个的网络材料（谷歌他们以获取详细信息）。

# php - Codeigniter 2.1 - 表单上传相同的文档两次

> ID：14962757
> 
> 赞同：1
> 
> 时间：2013-02-19T16:41:47.650
> 
> 标签：php, codeigniter, codeigniter-2

我对文件上传有点问题。我正在尝试上传两个文件，但由于某种原因，第一个文件被上传了两次，并且没有第二个文件的踪迹。我究竟做错了什么？

文件上传功能（模型）：

```
public function file_upload($folder, $allowed_type, $max_size = 0, $max_width = 0, $max_height = 0)
{
    $folder = $this->path . $folder;

    $files = array();
    $count = 0;

    foreach ($_FILES as $key => $value) :
        $file_name = is_array($value['name']) ? $value['name'][$count] : $value['name'];
        $file_name = $this->global_functions->char_replace($file_name, '_');
            $count++;
            $config = array(
            'allowed_types' => $allowed_type,
            'upload_path'   => $folder,
            'file_name'     => $file_name,
            'max_size'      => $max_size,
            'max_width'     => $max_width,
            'max_height'    => $max_height,
            'remove_spaces' => TRUE
             );

        $this->load->library('image_lib');
        $this->image_lib->clear();
        $this->load->library('upload', $config);

        if (!$this->upload->do_upload($key)) :
            $error = array('error' => $this->upload->display_errors());
            return FALSE;
        else :
            $file = $this->upload->data();
            $files[] = $file['file_name'];
        endif;

    endforeach;
    if(empty($files)):
        return FALSE;
    else:
        return implode(',', $files);
    endif;
} 
```

功能表单文件上传（控制器）：

```
public function dokument_insert()
{
    $this->admin_login_check();

    $dokument =explode(',', $this->doc->file_upload('/doc', 'pdf|PDF|doc|docx') );
    var_dump($dokument);
    $data = array(
        'naziv'         => $this->input->post('naziv_srb'),
        'opis'          => $this->input->post('opis_srb'),
        'path_pdf'      => $dokument[0],
        'path_doc'      => $dokument[1],
        'kategorija_id' => $this->input->post('kategorija'),
        'jezik_id'      => $this->input->post('jezik')
    );
    $this->doc->save($data);
} 
```

文件表格的一部分（查看）：

```
<label for="dokument_pdf">Dokument PDF</label>
<input type="file" name="pdf" id="dokument_pdf">

<label for="dokument_doc">Dokument DOC</label>
<input type="file" name="doc" id="dokument_doc"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:37:23.233

您必须在每次上传时初始化上传库。

```
$this->load->library('upload');
$this->upload->initialize($config); 
```

用户指南：[https ://www.codeigniter.com/user_guide/libraries/file_uploading.html](https://www.codeigniter.com/user_guide/libraries/file_uploading.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T11:45:46.387

看起来因为你有 2 个文档字段，它无论如何都会循环 2 次......

如果您只想要一个，您应该只通过表单发送一个，或者不要使用 ForEach 并使用它们的固定名称手动处理每个。

# windows - 如何更改远程服务器上的 IIS 7 应用程序池？

> ID：14962758
> 
> 赞同：1
> 
> 时间：2013-02-19T16:41:49.303
> 
> 标签：windows, iis-7, scripting, nant

我希望在远程服务器上创建新的虚拟目录并将应用程序池设置为默认配置以外的配置。我正在使用 NAnt，但对任何其他可以完成此操作的命令都持开放态度。

这是我尝试过的：

```
<mkiisdir iisserver="${remote.server}" dirpath="${install.path}" vdirname="${vir.dir.name}" /> 
```

上述方法在为远程服务器创建 VD 时工作正常，但 nant 任务没有用于指定应用程序池的参数。奇怪为什么不！

我考虑使用 powershell[更新应用程序池](http://www.iisonthe.net/2012/07/25/changing-application-pool-identities-in-iis-78-using-powershell/)，因为我已经创建了虚拟目录，但由于我的 Windows 操作系统限制，我无法安装更新 IIS 应用程序池所需的 WebAdministration 模块。

有没有我没有考虑过的现有方法来完成这个？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-21T20:07:10.823

您可以使用位于 System32 文件夹中的 AppCmd.exe。

```
appcmd set app /app.name:"Default Web Site/MyVirtualDirectoryName" /applicationPool:"MyAppPool" 
```

如果您需要远程更新其他服务器上的 Web 应用程序目录，则可以使用`PSExec \\RemoteServerHostname appcmd set app /app.name:"Default Web Site/MyVirtualDirectoryName" /applicationPool:"MyAppPool"`

# javascript - 将 Safari 6 控制台的上下文更改为页面上的 iframe

> ID：14962759
> 
> 赞同：9
> 
> 时间：2013-02-19T16:41:52.433
> 
> 标签：javascript, safari, console, web-inspector

我知道[Chrome](https://stackoverflow.com/questions/7961229/is-there-a-way-to-change-context-to-iframe-in-javascript-console)让您通过下拉菜单选择控制台执行的上下文，而 Firebug 让您`cd()`进入 iframe。我不知道如何更改 Safari 控制台中的上下文。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T09:16:09.350

与 chrome 和 firefox 不同，Safari 并没有真正支持此功能，唯一的选择似乎是从控制台访问 window 对象。正如您正确指出的那样，这将触发跨域策略问题，但是如果您在 mac 上运行（这在 Windows 上由于某种原因不起作用），您可以使用

```
open -a '/Applications/Safari.app' --args --disable-web-security 
```

绕过这个。接下来在你的 jsbin 上你可以使用类似的东西

```
window.frames[0] 
```

访问页面的窗口。据我所见，Windows 没有类似的解决方案，因为

```
Safari.exe --disable-web-security 
```

显然不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:30:10.060

iframe 元素本身是控制台中的类型窗口

```
<iframe id="frame" src="about:blank"/> 
```

在 Safari 控制台中，您只需使用

```
frame.document.write('bla'); 
```

请注意“框架”是简写`document.getElementById('frame')`

# xml - SOAP PHP 问题“编码：对象没有‘模式’属性”

> ID：14962761
> 
> 赞同：0
> 
> 时间：2013-02-19T16:41:54.030
> 
> 标签：xml, soap, php, ota

我正在尝试通过 SOAP 调用 Web 服务。我觉得 PHP 请求看起来不错。下面是 SOAP PHP 代码和 XML。请让我知道可能出了什么问题。从技术上讲，我不断得到对象的响应没有属性。

**这是错误消息：**

> 致命错误：未捕获的 SoapFault 异常：[Client] SOAP-ERROR: Encoding: object has no 'schema' property

```
$client = new SoapClient(
    'Link.asmx?wsdl',
    array(
        'soap_version' => SOAP_1_1,
        'trace'        => 1,
    )
);

$result = $client->OTA_VehAvailRate(
    array(
        'OTA_VehAvailRateRQ' => array(
            'VehAvailRQCore' => array(
                'VehRentalCore' => array(
                    'type'           => 'VehicleRentalCoreType',
                    'PickUpLocation' => array(
                        'LocationCode' => 'ERLAX01',
                    ),
                    'PickUpDateTime' => '2013-03-14T12:00:00',
                    'ReturnDateTime' => '2013-03-16T12:00:00',
                    'ReturnLocation' => array(
                        'LocationCode' => 'ERLAX01',
                    ),
                ),
                'VendorPrefs'   => array(
                    'VendorPref' => array(
                        'Code'        => '*****',
                        'CodeContext' => '******',
                    ),
                ),
                'VehPrefs'      => array(
                    'VehPref' => array(
                        'Code' => 'HFG',
                    ),
                ),

                'RateQualifier' => array(
                    'PromotionCode' => '',
                    'RateQualifier' => '',
                ),
            ),
        )
    )
);

print_r($result); 
```

这是 XML 模式。

```
<SOAP-ENV:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    <SOAP-ENV:Body>
        <tns:OTA_VehAvailRate xmlns:tns="http://www.opentravel.org/OTA/2003/05" xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:tnsC="http://www.w3.org/1999/xhtml" xmlns:vs="http://schemas.microsoft.com/Visual-Studio-Intellisense" xmlns:tnsB="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <AA:OTA_VehAvailRateRQ xmlns:AA="http://www.opentravel.org/OTA/2003/05" xmlns:xs="http://www.w3.org/2001/XMLSchema-instance" Version="0">
                <AA:VehAvailRQCore>
                    <AA:VehRentalCore xs:type="AA:VehicleRentalCoreType" PickUpDateTime="2013-03-14T12:00:00" ReturnDateTime="2013-03-16T12:00:00">
                        <AA:PickUpLocation LocationCode="ERLAX01" />
                        <AA:ReturnLocation LocationCode="ERLAX01" />
                    </AA:VehRentalCore>
                    <AA:VendorPrefs>
                        <AA:VendorPref Code="****" CodeContext="******" />
                    </AA:VendorPrefs>
                    <AA:VehPrefs>
                        <AA:VehPref Code="HEG" />
                    </AA:VehPrefs>
                    <AA:RateQualifier PromotionCode="" RateQualifier="" />
                </AA:VehAvailRQCore>
            </AA:OTA_VehAvailRateRQ>
        </tns:OTA_VehAvailRate>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

请让我知道我做错了什么。多谢

```
POST /OTA2011A/OTASrvc.asmx HTTP/1.1
Content-Type: text/xml; charset=utf-8
Content-Length: length
SOAPAction: "http://www.opentravel.org/OTA/2003/05/OTA_VehAvailRate"

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <OTA_VehAvailRate xmlns="http://www.opentravel.org/OTA/2003/05">
      <OTA_VehAvailRateRQ>
        <xsd:schema>schema</xsd:schema>xml</OTA_VehAvailRateRQ>
    </OTA_VehAvailRate>
  </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-12T10:26:48.163

如果你在做OTA，我真的建议你试试[https://github.com/goetas-webservices/soap-client](https://github.com/goetas-webservices/soap-client)

是完全不依赖于 PHP 的 PHP SOAP 客户端`ext-soap`。它已经支持 PSR7、多客户端，并允许通过 IDE 生成用于类型提示的类。

[https://github.com/goetas-webservices/soap-client-demo](https://github.com/goetas-webservices/soap-client-demo)是一个演示项目，可让您了解如何使用客户端来使用通用 SOAP Web 服务。

该项目基于[https://github.com/goetas-webservices/xsd2php](https://github.com/goetas-webservices/xsd2php)，内部使用OTA作为测试套件（并且测试套件正在通过）。

# ruby-on-rails - REST API 分页和客户端缓存

> ID：14962771
> 
> 赞同：0
> 
> 时间：2013-02-19T16:42:28.417
> 
> 标签：ruby-on-rails, http, caching, microformats

使用 Rails，我有一个 HTTP 端点，它返回一个链接到 JSON 格式的播放列表的记录（媒体文件）数组。

客户端缓存是通过检查播放列表的日期并`stale?(@playlist)`在`/playlist/id/media_files.json`响应中使用 Rails 生成适当的 etag 来完成的。

现在我想实现分页，但在某种程度上试图保持客户端缓存。

是否有一些我可以采取的聪明方法，或者我是否被迫以 200 响应所有请求并始终将数据通过网络传输到客户端？

您如何处理 API 中的分页（服务器、客户端）缓存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:38:22.173

当我在 Rails 中使用页面缓存并且必须处理分页时，我只需将页面放在 URL 中。因此，例如，如果我有一个如下所示的资源：

```
resource :users 
```

我将其更改为（添加新行）：

```
get 'users/page/:page', to: 'users#index'
resource :users 
```

我不确定您使用的是哪个客户端，但这里的想法是您要单独缓存各个页面。由于该页面现在是 URL 的一部分，因此您已经缓存了每个页面，您的问题应该得到解决:)

# android - 如何在Android上捕获点击坐标？

> ID：14962776
> 
> 赞同：0
> 
> 时间：2013-02-19T16:42:45.093
> 
> 标签：android

如何在Android上捕获点击坐标？我的意思是当“指针位置”启用时可见的 XY 坐标`Settings -> Developer options`。坐标应该一直被捕获，与系统上当前发生的事情无关。

坐标应该写入文件，打印到 logcat，通过 TCP 套接字或其他方式发送。

相关问题：[通过Java编程语言在android中读取/dev/input/event](https://stackoverflow.com/q/8786520/986533)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T22:23:17.553

**2016 年 6 月 4 日编辑**：有一个工具，[RERAN](http://www.androidreran.com/)。它的错误修复代码可在[GitHub 上的这个分支中找到](https://github.com/frankhuhu/RERAN)。

* * *

有一个工具可以截取 avd / 真实设备的屏幕截图，并使用从屏幕截图上的鼠标点击获取的坐标生成交互式 monkeyRunner 脚本：[wGetAndroidSnapshot](http://blogs.wittwer.fr/whiler/2011/07/01/editeur-monkeyrunner/)

我能想到的一件骇人听闻的事情是捕获底层操作系统的鼠标点击坐标，并将它们映射到正在运行的 AVD 的坐标上，在该坐标上点击了鼠标。更骇人听闻的方法是在启用“指针位置”时捕获 AVD 上坐标值的屏幕截图并对其进行 OCR :)

也有商业解决方案。

# python - Django Lettuce 并行运行两次测试

> ID：14962780
> 
> 赞同：2
> 
> 时间：2013-02-19T16:42:55.917
> 
> 标签：python, django, integration-testing, lettuce

我正在尝试使用生菜从我的步骤定义中获取一些输出。当我运行测试时，我看到它闪烁我的输出一秒钟，然后被相同的测试覆盖。但是，我可以看到在输出中调用了两次步骤。一种是很深（几乎是黑色）的颜色，另一种是绿色或红色。输出在下面突出显示。 ![幻象测试](../Images/db044024d6f154d2913a9a76a4f80b17.png)

这让我很头疼，因为调试信息显示在另一个正在运行的测试中，而不是这个。我很难阐明这一点，但我认为屏幕截图有助于说明这一点：我应该只看到每个步骤被​​调用一次，但现在情况并非如此。

对此的任何帮助将不胜感激。

**特征**

```
Feature: Navigation
As a persion looking for information on specific machine
In order to view up to date machine inventory
I should be able to navigate to a individual machine

Background:
    Given the following users exist:
        | username | first_name | last_name | password |
        | johndoe  | John       | Doe       | testpass |
    And the following machines exist:
        | msnbr     | machine_name     | brand_name | brand_slug | division | product_group | machine_type | price | model  | location |
        | 111111    | Router           | Altendorf  | altendorf  | All      | All           | All          | 100   | model7 | Zenith   |
        | 222222    | CNC Router       | Belfab     | belfab     | All      | All           | All          | 200   | model6 | Echo     |
        | 333333    | Saw              | Durst      | durst      | All      | All           | All          | 300   | model5 | Xalpha   |
        | 444444    | Another Router   | Belfab     | belfab     | All      | All           | All          | 250   | model4 | Beta     |
        | 555555    | eh Router        | Belfab     | belfab     | All      | All           | All          | 250   | model4 | Water    |
        | 666666    | Router 6         | Belfab     | belfab     | All      | All           | All          | 250   | model2 | River    |
        | 777777    | Router 8         | Belfab     | belfab     | All      | All           | All          | 250   | model1 | Snake    |
    And I am logged in as "johndoe" with password "testpass"

Scenario: As an executive, I can see all brands
    Given I see "Brand"
    Then I should see "Altendorf"
    And I should see "Belfab"
    And I should see "Durst"
    Then I click "Logout"

Scenario: As an executive, I can navigate into brands
    Given I see "Brand"
    When I click "Belfab"
    Then I should see "5" machines
    And the machines should be in the following order:
        | model  |
        | model2 |
        | model4 |
        | model5 |
        | model6 |
        | model7 | 
```

**步骤（格式有点不对）**

```
from lettuce import step, world
from lettuce_webdriver.util import assert_true
from django.contrib.auth.models import User
from website.factories import *
from website.models import *

@step(u'the following machines exist:')
def the_following_machines_exist(step):
for machine_hash in step.hashes:
    brand, created = Brand.objects.get_or_create(
        name=machine_hash['brand_name'],
        slug=machine_hash['brand_slug']
    )

    division, created = Division.objects.get_or_create(
        name=machine_hash['division']
    )

    product_group, created = ProductGroup.objects.get_or_create(
        name=machine_hash['product_group']
    )

    machine_type, created = MachineType.objects.get_or_create(
        name=machine_hash['machine_type']
    )

    machine = Machine(
        machine_year = "2000",
        hold_for = "john",
        us_destination = "el paso",
        voltage = "500",
        last_update_on = "January 10",
        port_of_entry = "LAX",
        msnbr = machine_hash['msnbr'],
        description = "Machine description",
        location=machine_hash['location'],
        model=machine_hash['model'],
        age=15,
        price=machine_hash['price'],
        active=True,
        division=division,
        product_group=product_group,
        machine_type=machine_type,
        brand=brand
    )
    machine.save()

@step(u'I should see "([^"]*)" machines')
def i_should_see_n_machines(step, n):
selector = "#left-main ol li"
elements = world.browser.find_elements_by_css_selector(selector)
if len(elements) != int(n):
    raise Exception("Error: Number of machines does not match: %d != %d" % (len(elements), int(n)))

@step(u'the machines should be in the following order:')
def the_machines_should_be_in_the_following_order(step):
selector = "#left-main ol li"
elements = world.browser.find_elements_by_css_selector(selector)
for i in range(0, len(elements)):
    el_text = elements[i].find_element_by_css_selector(".name").text
    if step.hashes[i]['model'] != el_text:
        print "FAIL"
    else:
        print el_text
        print step.hashes[i]['model'] 
```

**设置**

```
# Django settings for stiles_aml project.
import os.path
root = os.path.dirname(__file__).replace('\\','/')

DEBUG = False
TEMPLATE_DEBUG = DEBUG

ADMINS = ( *** )

MANAGERS = ADMINS

DATABASES = { *** }

# Local time zone for this installation. Choices can be found here:
# http://en.wikipedia.org/wiki/List_of_tz_zones_by_name
# although not all choices may be available on all operating systems.
# On Unix systems, a value of None will cause Django to use the same
# timezone as the operating system.
# If running in a Windows environment this must be set to the same as your
# system time zone.
TIME_ZONE = 'America/Detroit'

# Language code for this installation. All choices can be found here:
# http://www.i18nguy.com/unicode/language-identifiers.html
LANGUAGE_CODE = 'en-us'

SITE_ID = 1

# If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
USE_I18N = True

# If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale.
USE_L10N = True

# If you set this to False, Django will not use timezone-aware datetimes.
USE_TZ = True

# Absolute filesystem path to the directory that will hold user-uploaded files.
# Example: "/home/media/media.lawrence.com/media/"
MEDIA_ROOT = root + '/../media/'

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = '/media/'

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
STATIC_ROOT = root + '/../static/'

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

# Additional locations of static files
STATICFILES_DIRS = (
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    root + "/../shared_static",
)

# List of finder classes that know how to find static files in
# various locations.
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

# Make this unique, and don't share it with anybody.
SECRET_KEY = '***'

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
)

TEMPLATE_CONTEXT_PROCESSORS = (
    'django.contrib.auth.context_processors.auth',
    'django.core.context_processors.debug',
    'django.core.context_processors.i18n',
    'django.core.context_processors.media',
    'django.core.context_processors.request',
    'django.core.context_processors.static',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    # 'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
    'django.middleware.gzip.GZipMiddleware',
    'debug_toolbar.middleware.DebugToolbarMiddleware',
)

ROOT_URLCONF = '***_aml.urls'

# Python dotted path to the WSGI application used by Django's runserver.
WSGI_APPLICATION = '***_aml.wsgi.application'

TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    root + '/../templates'
)

# Sentry key
SENTRY_DSN = '****'

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'django.contrib.humanize',

    # 3rd party
    'south',
    'debug_toolbar',
    'tastypie',
    'django_extensions',
    'shell_plus',
    'raven.contrib.django',
    'django_nose',
    'lettuce.django',

    # Authored
    'website',
)

# Email settings
EMAIL_HOST = '****'
REQUEST_QUOTE_EMAIL = ['****'] 
```

# android - 自定义小部件集成

> ID：14962785
> 
> 赞同：0
> 
> 时间：2013-02-19T16:43:09.407
> 
> 标签：android, android-view, custom-widgets

我创建了一个视图，我想像自定义小部件一样使用它来在我的布局中绘制。但是一开始我有这个错误，我可以解决它。所以请帮忙！

这是我的主要布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <com.example.SignatureView
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

这是我的 SignatureView 类：

```
public class SignatureView extends View {

      private static final float STROKE_WIDTH = 5f;

      /** Need to track this so the dirty region can accommodate the stroke. **/
      private static final float HALF_STROKE_WIDTH = STROKE_WIDTH / 2;

      private Paint paint = new Paint();
      private Path path = new Path();

      /**
       * Optimizes painting by invalidating the smallest possible area.
       */
      private float lastTouchX;
      private float lastTouchY;
      private final RectF dirtyRect = new RectF();

      public SignatureView(Context context, AttributeSet attrs, int background) {
        super(context, attrs);
        setBackgroundResource(background);
        paint.setAntiAlias(true);
        paint.setColor(Color.BLACK);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeWidth(STROKE_WIDTH);

      }

      public void setColor(int color){
          paint.setColor(color);
      }

      /**
       * Erases the signature.
       */
      public void clear() {
        path.reset();

        // Repaints the entire view.
        invalidate();
      }

      @Override
      protected void onDraw(Canvas canvas) {
        canvas.drawPath(path, paint);
      }

      @Override
      public boolean onTouchEvent(MotionEvent event) {
        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);
            lastTouchX = eventX;
            lastTouchY = eventY;
            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            // Start tracking the dirty region.
            resetDirtyRect(eventX, eventY);

            // When the hardware tracks events faster than they are delivered, the
            // event will contain a history of those skipped points.
            int historySize = event.getHistorySize();
            for (int i = 0; i < historySize; i++) {
              float historicalX = event.getHistoricalX(i);
              float historicalY = event.getHistoricalY(i);
              expandDirtyRect(historicalX, historicalY);
              path.lineTo(historicalX, historicalY);
            }

            // After replaying history, connect the line to the touch point.
            path.lineTo(eventX, eventY);
            break;

          default:
//          Log.("Ignored touch event: " + event.toString());
            return false;
        }

        // Include half the stroke width to avoid clipping.
        invalidate(
            (int) (dirtyRect.left - HALF_STROKE_WIDTH),
            (int) (dirtyRect.top - HALF_STROKE_WIDTH),
            (int) (dirtyRect.right + HALF_STROKE_WIDTH),
            (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
      }

      /**
       * Called when replaying history to ensure the dirty region includes all
       * points.
       */
      private void expandDirtyRect(float historicalX, float historicalY) {
        if (historicalX < dirtyRect.left) {
          dirtyRect.left = historicalX;
        } else if (historicalX > dirtyRect.right) {
          dirtyRect.right = historicalX;
        }
        if (historicalY < dirtyRect.top) {
          dirtyRect.top = historicalY;
        } else if (historicalY > dirtyRect.bottom) {
          dirtyRect.bottom = historicalY;
        }
      }

      /**
       * Resets the dirty region when the motion event occurs.
       */
      private void resetDirtyRect(float eventX, float eventY) {

        // The lastTouchX and lastTouchY were set when the ACTION_DOWN
        // motion event occurred.
        dirtyRect.left = Math.min(lastTouchX, eventX);
        dirtyRect.right = Math.max(lastTouchX, eventX);
        dirtyRect.top = Math.min(lastTouchY, eventY);
        dirtyRect.bottom = Math.max(lastTouchY, eventY);
      }
    } 
```

这就是我在主要 Draw 类中的内容：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        } 
```

最后这就是我在 logCat 中得到的

```
02-19 17:41:51.708: E/AndroidRuntime(7530): FATAL EXCEPTION: main
02-19 17:41:51.708: E/AndroidRuntime(7530): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example/com.example.Draw}: android.view.InflateException: Binary XML file line #6: Error inflating class com.example.SignatureView
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1662)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1678)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread.access$1500(ActivityThread.java:118)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:932)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.os.Looper.loop(Looper.java:130)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread.main(ActivityThread.java:3698)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at java.lang.reflect.Method.invokeNative(Native Method)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at java.lang.reflect.Method.invoke(Method.java:507)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:875)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:633)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at dalvik.system.NativeStart.main(Native Method)
02-19 17:41:51.708: E/AndroidRuntime(7530): Caused by: android.view.InflateException: Binary XML file line #6: Error inflating class com.example.SignatureView
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.createView(LayoutInflater.java:508)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:570)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:207)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.Activity.setContentView(Activity.java:1657)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at com.example.Draw.onCreate(Draw.java:13)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1626)
02-19 17:41:51.708: E/AndroidRuntime(7530):     ... 11 more
02-19 17:41:51.708: E/AndroidRuntime(7530): Caused by: java.lang.NoSuchMethodException: SignatureView(Context,AttributeSet)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at java.lang.Class.getMatchingConstructor(Class.java:643)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at java.lang.Class.getConstructor(Class.java:472)
02-19 17:41:51.708: E/AndroidRuntime(7530):     at android.view.LayoutInflater.createView(LayoutInflater.java:480)
02-19 17:41:51.708: E/AndroidRuntime(7530):     ... 21 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:47:26.490

该错误非常自我解释：

```
Caused by: java.lang.NoSuchMethodException: SignatureView(Context,AttributeSet) 
```

你没有一个只需要一个上下文和一个属性集的构造器。将该构造函数添加到您的 SignatureView 类，如下所示：

```
public SignatureView(Context c, AttributeSet as){
    super(c, as);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:48:41.030

```
02-19 17:41:51.708: E/AndroidRuntime(7530): Caused by: java.lang.NoSuchMethodException: ***SignatureView(Context,AttributeSet)*** 
```

看起来你缺少一个构造函数？尝试为 SignatureView(Context,AttributeSet) 添加一个构造函数，看看它是如何工作的。

而不是传入`int background`te 构造函数，尝试将其作为 xml 属性传递。这样，您仍然在回复默认构造函数，它使您可以灵活地从 xml 设置背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T16:46:50.687

您需要一个接受 Context 和 AttributeSet 的构造函数。您向您的参数添加了第三个参数。通过 xml 进行膨胀时，这将不起作用，它需要确切的签名才能工作。

此外，这会使事情变得更加混乱，因为如果应用了默认样式，那么 xml inflater 会查找 3 参数版本（第三个是主题的资源 id），这会错误地调用您当前的 3 参数方法。最终结果将是您尝试设置随机主题 ID 的背景资源，我不知道会产生什么结果，但我的猜测是崩溃。

# string - 我可以使用富文本命令在 VB6 中格式化字符串吗？

> ID：14962789
> 
> 赞同：1
> 
> 时间：2013-02-19T16:43:16.553
> 
> 标签：string, vb6, richtextbox

我需要将字符串添加到富文本格式的电子邮件中。我无法像往常一样通过选择文本框来格式化文本。我可以只修改字符串吗？我怎么能这样做？

目前，文本以 HTML 格式格式化，但这不再是一个选项。看起来像这样

```
string = vbCrLf & vbCrLf & "<B><FONT face=Arial color=#365f91 size=2>" & _
                        strName & "</FONT>" & _
                        "<FONT face=Arial size=2><BR>" & _
                        "<I>" & strPosition & "</I>" & _
                        "</FONT></B><BR/><B><FONT face=Arial size=2>" & _
                        strAddress1 & "</FONT></B><BR/><FONT face=Arial size=1>" & _
                        strAddress2 & "<BR>" & strCity & ", " & _
                        strProvince & ", " & strPostalCode & _
                        "<BR>" & strCountry & "<BR>Office: " & strPhone & _
                        "<BR>" & strEmail & "<BR>www.website.com<BR>" & _
                        "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" & _
                        "<I><FONT face=Arial size=2>" & strImageCaption & "</FONT>" & _
                        "<BR/><BR/><BR/></I><FONT face=Arial size=1>" & strDisclaimer & _
                        "</FONT></P>" 
```

我在网上找不到任何关于格式化富文本的资源，而这些资源目前不在富文本框中，所以我认为这可能是不可能的。

# .net - TreeView - 动态更改文本块的文本绑定（项目模板的一部分）

> ID：14962791
> 
> 赞同：0
> 
> 时间：2013-02-19T16:43:18.960
> 
> 标签：.net, wpf, xaml, wpf-controls

我有一个包含 TreeView 控件的用户控件。我想根据TreeViewUserControl 类的依赖属性的值来设置's中使用`**binding**`的`Text`属性的值。`TextBlock``TreeView``ItemTemplate``NodeDisplayProperty`

我尝试了类似于下面显示的内容（但为 设置了正确的数据上下文`NodeDisplayProperty`），但它不起作用，因为拒绝“双重绑定”的`Text`属性。`TextBlock`

的属性`DisplayMemberPath`也`TreeView`无法设置，因为我使用的是项目模板。

任何不涉及编写新绑定类的建议？理想情况下，我想要一个 XAML 解决方案，但如果您在后面的代码中执行此操作，您如何访问 XAML 定义的项目模板中代码块的绑定？

**编辑：**树中显示的项目来自模型，因此它们对 UI 元素不可见。

谢谢！

```
 <UserControl x:Class="TreeViewUserControl">
        <Grid>
            <TreeView ItemsSource="{Binding Path=Hierarchy}" HorizontalAlignment="Stretch" Name="treeHierarchy" SelectedItemChanged="treeHierarchySelectedItemChanged" >
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Nodes}">
   <!-- Here --- -->    <TextBlock Text="{Binding Path={Binding NodeDisplayProperty}}" VerticalAlignment="Center" FontSize="13" >
                            <TextBlock.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Command="userControls:Commands.RemoveNode">
                                    </MenuItem>
                                </ContextMenu>
                            </TextBlock.ContextMenu>
                        </TextBlock>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
                <TreeView.ItemContainerStyle>
                    <Style TargetType="{x:Type TreeViewItem}">
                        <Style.Triggers>
                            <!-- ... -->
                        </Style.Triggers>
                    </Style>
                </TreeView.ItemContainerStyle>
            </TreeView>
        </Grid>
    </UserControl> 
```

# mysql - Rails：ActiveRecord 类抛出“NameError：未初始化的常量”——这是命名问题吗？

> ID：14962794
> 
> 赞同：2
> 
> 时间：2013-02-19T16:43:28.517
> 
> 标签：mysql, ruby-on-rails, rails-activerecord, nameerror

我有一个名为的模型文件：

```
r_i_o_modules_and_instrument.rb 
```

...其中包含类似这样的内容...

```
class RIOModulesAndInstrument < ActiveRecord::Base
  belongs_to :parentmodel
  attr_accessible :attribute_1, :attribute_2, :attribute_3
end 
```

对应的 MySQL 表名是：

```
 r_i_o_modules_and_instruments 
```

但是：总的来说，从...

```
> RIOModulesAndInstrument.count 
```

...我得到：

```
NameError: uninitialized constant RIOModulesAndInstrument 
```

有没有人知道问题是什么以及解决方法？（是命名限制问题吗？）

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:44:39.280

尝试这个：

将模型文件名更改为`rio_modules_and_instrument.rb`

在模型中`rio_modules_and_instrument.rb`

```
class RIOModulesAndInstrument < ActiveRecord::Base
  set_table_name "r_i_o_modules_and_instruments" #if you are using rails v > 3.1.0 use self.table_name = "r_i_o_modules_and_instruments"
  belongs_to :parentmodel
  attr_accessible :attribute_1, :attribute_2, :attribute_3
end 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-02-19T16:51:38.067

## 标题##try RIOModulesAndInstruments，那是因为活动记录使它成为复数

# jquery - JQuery：ul悬停下拉

> ID：14962799
> 
> 赞同：1
> 
> 时间：2013-02-19T16:43:44.277
> 
> 标签：jquery, hover, mouseleave

尝试使用 jQuery 的悬停来显示/隐藏 ul 项目以提供下拉效果。

这是jQuery。忽略警报功能

```
$(document).ready(function () { 

    $('ul.drop li').hover(
        function () {
            alert("asa");
            //show its submenu
            var isVisible = $(this).next('ui').is(':visible');
            alert("dvData is " + isVisible);
            var isHidden = $(this).next('ui').is(':hidden');
            alert("dvData is " + isHidden);

            $(this).next('ul').css({visibility: "visible", display: ""});

        }, 
        function () {
            //hide its submenu
            $(this).next('ul').css({visibility: "hidden", display: ""});
        }
    );

}); 
```

这是jsp页面

```
<ul class="drop">
<li><a href="#">Main</a></li>
<li>Reporting
 <ul >
    <li><a href="#" target="_blank">Magellan Reports</a></li>
    <li><a href=""/>"  target="_blank">Script Reports</a></li>
 </ul>

<li><a href="<c:url value="#"/>"   target="_blank">CMS</a></li>
<li><a href="<c:url value="#"/>"  target="_blank">Operations</a></li>
</ul> 
```

这是CSS

```
ul#nav {padding-left:16px;background-image:url(../images/buehne_5_intra.gif)}
clear {clear:both}
ul.drop a {color:#87A7CE;line-height:14px;display:block;text-decoration: none;
background-repeat:no-repeat;background-image:url(../images/diagonale_hauptnavigation.gif);background-position:right;
    height:10px;padding-right:22px; float:left;}
ul.drop, ul.drop li, ul.drop ul { list-style: none; margin: 0; padding: 0; background: #039;
color: #fff;}
ul.drop { position: relative; z-index: 597; float: left; }
ul.drop li { float: left; line-height: 1.0em; vertical-align: middle; zoom: 1; padding: 5px 10px; }
ul.drop li ul { visibility: hidden; position: absolute; top: 100%; left: 20px; z-index: 598; width: 150px; margin-left:50px;}
ul.drop ul a {color:#87A7CE;line-height:14px;display:block;text-decoration: none;height:10px;padding-left:10px; float:left;background-image:none;}
ul.drop ul li { float: none; }
ul.drop ul ul { top: -2px; left: 100%; }
.drop img{width:22px;height:24px;background-color:#039;margin-left:-20px;vertical-align:top} 
```

我 cud 只用 css 完成了它，但是一些必需的、长的和损坏的 css 文件不允许我这样做..请帮助 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:57:07.007

`next()`寻找下一个兄弟姐妹，它不匹配，因为您没有`<ul>`兄弟姐妹来触发`<li>`. 相反，您想要寻找孩子，因此请尝试`children()`找到匹配的孩子。将您的 JS 修改为以下内容：

```
$('ul.drop li').hover(
    function () {
        $(this).children('ul').css({visibility: "visible", display: ""});
    }, 
    function () {
        $(this).children('ul').css({visibility: "hidden", display: ""});
    }
); 
```

您可以在此处查看演示 - [http://jsfiddle.net/GoranMottram/Uxj2B/3/](http://jsfiddle.net/GoranMottram/Uxj2B/3/) - CSS 看起来需要一些工作，但至少 JS 可以工作。

# c# - 从高音扬声器到 C# 格式的 JSON 日期

> ID：14962803
> 
> 赞同：14
> 
> 时间：2013-02-19T16:43:54.480
> 
> 标签：c#, json, json.net, date-format

如何将从 twitter 获得的 JSON 日期格式化为 C# DateTime ？这是我收到日期的格式：

```
"Tue, 19 Feb 2013 13:06:17 +0000" 
```

我可以用 JSON.NET 做吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-19T16:56:12.627

解决了使用`DateTime.ParseExact`

-> [http://blog.kevinyu.org/2012/07/handling-json-in-net.html](http://blog.kevinyu.org/2012/07/handling-json-in-net.html)

**链接更新：**链接的博客文章已离线。它的缓存副本仍然可以[通过 Way Back Machine Internet Archive](https://web.archive.org/web/20170310125132/http://blog.kevinyu.org/2012/07/handling-json-in-net.html)进行引用。

从博文中复制的常见 .NET 代码是：

```
public const string Const_TwitterDateTemplate = "ddd MMM dd HH:mm:ss +ffff yyyy";

DateTime createdAt = DateTime.ParseExact((string)jo["created_at"], 
Const_TwitterDateTemplate, new System.Globalization.CultureInfo("en-US")); 
```

在哪里

*   变量`jo`是表示`created_at`日期属性的 JSON 对象，但实际上 Twitter 日期字符串会进入此参数

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-06-22T21:05:42.030

流的答案中的部分代码。

```
public const string Const_TwitterDateTemplate = "ddd MMM dd HH:mm:ss +ffff yyyy";

DateTime createdAt = DateTime.ParseExact((string)jo["created_at"], Const_TwitterDateTemplate, new System.Globalization.CultureInfo("en-US")); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-03-01T04:54:38.197

上面使用 ffff 格式说明符的答案似乎返回了正确的结果，但从技术上讲这是错误的。ffff 是千分之一秒的格式说明符，Twitter 日期中的 +0000 表示与 UTC 的小时和分钟偏移量。请参阅以下格式：

```
string twitterTime = "Wed Feb 22 15:49:01 +0000 2017";
string twitterTimeformat = "ddd MMM dd HH:mm:ss zzz yyyy";

DateTime dateTime = DateTime.ParseExact(twitterTime, twitterTimeformat,
    CultureInfo.InvariantCulture, DateTimeStyles.AdjustToUniversal);
Console.WriteLine(dateTime); 
```

结果：2017 年 2 月 22 日下午 3:49:01

如果需要，您可以编辑 DateTimeStyles 枚举以返回本地时间而不是 UTC。

[自定义日期和时间格式字符串](https://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

[日期时间样式枚举](https://msdn.microsoft.com/en-us/library/91hfhz89(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T16:57:09.507

这是 DateTimeOffset 而不是 DateTime。以下应该工作。

```
DateTimeOffset parsed = DateTimeOffset.Parse("Tue, 19 Feb 2013 13:06:17 +0000"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-05T19:58:43.530

我需要这些答案的 PowerShell 变体，以下对我有用。

```
PS> $Created_At = 'Fri Jun 05 18:15:48 +0000 2020'
PS> [datetime]::ParseExact($Created_At,'ddd MMM dd HH:mm:ss zzz yyyy',(Get-Culture))

Friday, June 5, 2020 1:15:48 PM 
```

# android - Android获取Tcp连接日志

> ID：14962808
> 
> 赞同：2
> 
> 时间：2013-02-19T16:44:12.077
> 
> 标签：android

我在获取所有应用程序的 Tcp 连接日志时遇到了一些麻烦。基本上，我只是阅读此处使用的日志文件“/proc/Pid/net/tcp”：http://code.google.com/p/iptableslog/source/browse/src/com/googlecode/networklog/NetStat [。 java?r=60cb640ac27f8b4fb06f11d9d81c94591a531862](http://code.google.com/p/iptableslog/source/browse/src/com/googlecode/networklog/NetStat.java?r=60cb640ac27f8b4fb06f11d9d81c94591a531862)

但是所有的目标 IP 地址都是 0.0.0.0，尽管有些应用程序正在连接到 Internet。

这是我的源代码：

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.net.InetAddress;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.List;

import android.os.Bundle;
import android.app.Activity;
import android.app.ActivityManager;
import android.app.ActivityManager.RunningAppProcessInfo;
import android.content.Context;
import android.content.Intent;
import android.hardware.Camera;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        final TextView textmpid = (TextView) findViewById(R.id.textView2);

        Button buttonLoadTrafficStats = (Button) findViewById(R.id.button1);
        buttonLoadTrafficStats.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                ActivityManager mActivityManager = (ActivityManager) getApplicationContext().getSystemService(Context.ACTIVITY_SERVICE);
                List<RunningAppProcessInfo> mRunningProcess = mActivityManager.getRunningAppProcesses();
                int i = 1;
                int a;
                String b;
                int c;
                for (ActivityManager.RunningAppProcessInfo amProcess : mRunningProcess){
                    //Get name, Pid, Uid of all running process
                    System.out.println("Application: " +i+ " PID: " + amProcess.pid+ " (processName= " + amProcess.processName + " UID= "+amProcess.uid+")");
                    Log.i("Application", (i++) + "PID: " + amProcess.pid + "(processName=" + amProcess.processName + "UID="+amProcess.uid+")");
                    i++;
                    textmpid.setText("PID: "+ String.valueOf(amProcess.pid));
                    a = amProcess.pid;
                    b = String.valueOf(amProcess.pid);

                    ArrayList<Connection> connections = new ArrayList<Connection>();

                        try {
                            BufferedReader in = new BufferedReader(new FileReader("/proc/" + a + "/net/tcp"));
                            String line = b;
                            int z; 
                            while((line = in.readLine()) != null) {
                                System.out.println(" tcp Netstat line: " + line);
                                line = line.trim();
                                String[] fields = line.split("\\s+", 10);
                                int fieldn = 0;
                                for(String field : fields) {
                                    System.out.println(" tcp Field " + (fieldn++) + ": [" + field + "]");
                                    int m = fieldn; 
                                    String n = field;
                                }

                                if(fields[0].equals("sl")) {
                                    continue;
                                }
                                  Connection connection = new Connection();

                                    String src[] = fields[1].split(":", 2);
                                    String dst[] = fields[2].split(":", 2);

                                    System.out.println(" tcp Netstat: fields[1] " + fields[1]+"  fields[2] " + fields[2]);
                                    System.out.println(" tcp Netstat: src[0] " + src[0] +" src[1] " + src[1]);
                                    connection.src = getAddress(src[0]);
                                    System.out.println(" tcp Netstat: connection.src " + connection.src);
                                    connection.spt = String.valueOf(getInt16(src[1]));
                                    System.out.println(" tcp Netstat: connection.spt " + connection.spt);
                                    connection.dst = getAddress(dst[0]);
                                    System.out.println(" tcp Netstat: connection.dst " + connection.dst);
                                    connection.dpt = String.valueOf(getInt16(dst[1]));
                                    System.out.println(" tcp Netstat: connection.dpt " + connection.dpt);
                                    connection.uid = fields[7];
                                    System.out.println(" tcp Netstat: connection.uid " + connection.uid);

                                    connections.add(connection);

                            }

                        }
                        catch(Exception e) {
                            System.out.println(" checknetlog() Exception: " + e.toString());
                        }                                               
                    }

                }

        });

    }

      public class Connection {
        String src;
        String spt;
        String dst;
        String dpt;
        String uid;
      }

      final String states[] = { "ESTBLSH",   "SYNSENT",   "SYNRECV",   "FWAIT1",   "FWAIT2",   "TMEWAIT",
        "CLOSED",    "CLSWAIT",   "LASTACK",   "LISTEN",   "CLOSING",  "UNKNOWN"
      };

      private final String getAddress(final String hexa) {
        try {
          final long v = Long.parseLong(hexa, 16);
          final long adr = (v >>> 24) | (v << 24) |
            ((v << 8) & 0x00FF0000) | ((v >> 8) & 0x0000FF00);
          return ((adr >> 24) & 0xff) + "." + ((adr >> 16) & 0xff) + "." + ((adr >> 8) & 0xff) + "." + (adr & 0xff);
        } catch(Exception e) {
          Log.w("NetworkLog", e.toString(), e);
          return "-1.-1.-1.-1";
        }
      }

      private final String getAddress6(final String hexa) {
        try {
          final String ip4[] = hexa.split("0000000000000000FFFF0000");

          if(ip4.length == 2) {
            final long v = Long.parseLong(ip4[1], 16);
            final long adr = (v >>> 24) | (v << 24) |
              ((v << 8) & 0x00FF0000) | ((v >> 8) & 0x0000FF00);
            return ((adr >> 24) & 0xff) + "." + ((adr >> 16) & 0xff) + "." + ((adr >> 8) & 0xff) + "." + (adr & 0xff);
          } else {
            return "-2.-2.-2.-2";
          }
        } catch(Exception e) {
          Log.w("NetworkLog", e.toString(), e);
          return "-1.-1.-1.-1";
        }
      }

      private final int getInt16(final String hexa) {
        try {
          return Integer.parseInt(hexa, 16);
        } catch(Exception e) {
          Log.w("NetworkLog", e.toString(), e);
          return -1;
        }
      }
} 
```

我还添加了权限“uses-permission android:name="android.permission.INTERNET"。

有人可以指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:25:49.583

哦，当我检查这个日志“/proc/Pid/net/tcp6”时，我找到了正确的目标IP地址。似乎连接类型是 tcp6 而不是 tcp。

# vsto - VSTO: MS Project - 激活项目窗口

> ID：14962810
> 
> 赞同：2
> 
> 时间：2013-02-19T16:44:16.653
> 
> 标签：vsto, ms-project

我有 2 个应用程序 - 一个 VSTO 应用程序（作为 MS Project 内的插件运行）和一个辅助应用程序，它使用 VBA 启动 MS Project 并调用插件。

问题是当我使用 VBA 打开 MS Project 时，MS Project 窗口没有获得焦点，用户必须手动单击标题栏中的窗口才能将其置于前台。

不幸的是，我找不到为 MS Project 执行此操作的方法。帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T18:53:32.080

如果您在 Excel 等 Office 应用程序中使用 VBA，则可以使用此方法：

```
ActivateMicrosoftApp xlMicrosoftProject 
```

或者，您可以使用此方法：

```
AppActivate "Microsoft Project" 
```

# php - 如何加密我的 cookie 或会话以使用 phppass？

> ID：14962811
> 
> 赞同：0
> 
> 时间：2013-02-19T16:44:20.643
> 
> 标签：php, cookies, bcrypt

我目前正在使用[http://www.openwall.com/phpass/](http://www.openwall.com/phpass/)来散列我的密码。

即使输入相同的密码，散列也会产生不同的散列。

我检查密码是这样的：

```
$verify = $hasher->CheckPassword($password, $info['password']); 
```

`$password`是输入的值，`$info['password']`是数据库中的哈希值。

现在，我正在设置这样的cookie：

```
setcookie(user, $_POST['username'], $hour, $path); 
setcookie(pass, $_POST['password'], $hour, $path); 
```

这导致我的 cookie 是没有任何散列的密码。如何使存储密码的 cookie 更安全？

如果我不能将它们存储在 cookie 中，我将它们存储在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:56:36.270

**不要在任何地方存储密码，特别是不要在 Cookie 中。**

要让用户保持登录状态，请使用会话。*会话 cookie*只包含一个无意义的随机 id，而在服务器端您只需将用户的 id 存储在会话中：

```
$data = /* get user record from database based on username */;

if ($hasher->CheckPassword($_POST['password'], $data['password'])) {
    session_start();
    $_SESSION['userid'] = $data['userid'];
} 
```

不需要更多了。您无需将密码存储在任何地方或重复此密码检查。只需查看`$_SESSION['userid']`以识别用户。

阅读手册中有关会话的更多信息：[http ://www.php.net/manual/en/book.session.php](http://www.php.net/manual/en/book.session.php)

# sql - 使用日期参数列表查询日期范围列

> ID：14962814
> 
> 赞同：0
> 
> 时间：2013-02-19T16:44:28.197
> 
> 标签：sql, oracle10g

我有一个包含 2 个日期列、DATE_VALID_FROM 和 DATE_VALID_TO 的 Oracle 10g 表。

MY_TABLE：

```
DATE_VALID_FROM |   DATE_VALID_TO   |   VALUE

15-FEB-13       |   17-FEB-13       |   1.833
14-FEB-13       |   14-FEB-13       |   1.836
13-FEB-13       |   13-FEB-13       |   1.824
12-FEB-13       |   12-FEB-13       |   1.82
11-FEB-13       |   11-FEB-13       |   1.822
08-FEB-13       |   10-FEB-13       |   1.826
07-FEB-13       |   07-FEB-13       |   1.814
06-FEB-13       |   06-FEB-13       |   1.806
05-FEB-13       |   05-FEB-13       |   1.804
04-FEB-13       |   04-FEB-13       |   1.796
01-FEB-13       |   03-FEB-13       |   1.801 
```

日期列的范围并不总是一天（周末）。

我可以像这样检索单个日期的值，

```
select DATE_VALID_FROM, DATE_VALID_TO, VALUE 
from MY_TABLE
where DATE_VALID_FROM <= TO_DATE('16-FEB-13', 'dd-MON-yy')
and DATE_VALID_TO >= TO_DATE('16-FEB-13', 'dd-MON-yy') 
```

**是否可以在单个查询中检索多个随机日期的值？**

例如 2 月 1 日、5 日、6 日、11 日和 16 日的值。

生成此结果集：

```
DATE_VALID_FROM |   DATE_VALID_TO   |   VALUE

15-FEB-13       |   17-FEB-13       |   1.833
11-FEB-13       |   11-FEB-13       |   1.822
06-FEB-13       |   06-FEB-13       |   1.806
05-FEB-13       |   05-FEB-13       |   1.804
01-FEB-13       |   03-FEB-13       |   1.801 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:00:20.367

尝试：

```
select DATE_VALID_FROM, DATE_VALID_TO, VALUE 
from MY_TABLE M
JOIN (SELECT TO_DATE('01-FEB-2013') DATE_PARAM FROM DUAL UNION ALL
      SELECT TO_DATE('05-FEB-2013') DATE_PARAM FROM DUAL UNION ALL
      SELECT TO_DATE('06-FEB-2013') DATE_PARAM FROM DUAL UNION ALL
      SELECT TO_DATE('11-FEB-2013') DATE_PARAM FROM DUAL UNION ALL
      SELECT TO_DATE('16-FEB-2013') DATE_PARAM FROM DUAL) D
  ON M.DATE_VALID_FROM <= D.DATE_PARAM and M.DATE_VALID_TO >= D.DATE_PARAM 
```

[SQLFiddle在这里](http://sqlfiddle.com/#!4/073a7/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:07:57.357

您可以为此使用集合：

```
SQL> create type mydatetab as table of date;
  2  /

Type created.

SQL> with dates as (select /*+ cardinality(t, 5) */ t.column_value thedate
  2                   from table(mydatetab(TO_DATE('16-FEB-13', 'dd-mon-rr'),
  3                                        TO_DATE('13-FEB-13', 'dd-mon-rr'))) t)
  4  select DATE_VALID_FROM, DATE_VALID_TO, VALUE
  5  from MY_TABLE, dates
  6  where dates.thedate between DATE_VALID_FROM and DATE_VALID_TO;

DATE_VALI DATE_VALI      VALUE
--------- --------- ----------
13-FEB-13 13-FEB-13      1.824
15-FEB-13 17-FEB-13      1.833 
```

如果您没有权限来创建一个（即这只是一个临时的事情）。可能有一些你可以使用的公共的。检查`select * from all_coll_types where elem_type_name = 'DATE'`这些。

ps 使用日期时应始终指定格式。即不这样做：

```
TO_DATE('16-FEB-13') 
```

反而：

```
TO_DATE('16-FEB-13', 'dd-MON-rr') 
```

# javascript - javascript time() 使用更多零值？

> ID：14962817
> 
> 赞同：0
> 
> 时间：2013-02-19T16:44:34.637
> 
> 标签：javascript

我正在研究这个 javascript Jquery 插件

[http://code.google.com/p/flot/](http://code.google.com/p/flot/)

例如它使用时间线将其转换为实时

喜欢

```
var data = [
    {
        label: "United States",
        data: [[1220565600000, 0], [1320565600000, '13']]
    }
]; 
```

这个时间线是否与 php`time()`值相同？

因为当我用 php 值替换它们时，`time()`它会在 2 年后显示

# tinymce - 防止 TinyMCE 移除 span 元素

> ID：14962819
> 
> 赞同：12
> 
> 时间：2013-02-19T16:44:39.037
> 
> 标签：tinymce

**这是问题演示**

你可以在这里试试：http: [//fiddle.tinymce.com/SLcaab](http://fiddle.tinymce.com/SLcaab)

这是 TinyMCE 默认配置

*   少了所有插件
*   带有扩展有效元素：“跨度”

1 - 打开 Html 源代码编辑器

2 - 将此 html 粘贴到 Html 源代码编辑器中：

```
<p><span>Hello</span></p>
<p><a href="http://www.google.com">Google 1</a></p>
<p><a href="http://www.google.com">Google 2</a></p> 
```

3 - 在 Html Source Editor 中单击 update 以将 html 粘贴到编辑器中

4 - 请记住，“Hello”周围有一个跨度。

5 - 将光标放在 Google 2 之前并按退格键（两个链接应合并在同一个段落元素内）。

6 - 使用 Html 源代码编辑器查看生成的 html。

**结果（问题）**：即使我们在 TinyMCE 设置中的扩展有效元素中添加了“跨度”，html 文档中也没有跨度。

**注意：**我删除了所有插件以确保问题出在 TinyMCE 的核心。

**编辑 1 - 我也试过：** valid_children : "+p[span]" - 仍然不起作用

**编辑 2：**仅在 WebKit 上复制（在 Firefox 和 IE 上正常）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-02-20T14:55:04.870

插入：`extended_valid_elements : 'span'`_`tinymce.init`

```
tinymce.init({
    selector: 'textarea.tinymce',
    extended_valid_elements: 'span',
    //other options
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-02-07T01:24:35.077

我有同样的问题，我找到了解决方案。Tiny MCE 删除了没有任何属性的 SPAN 标签。尝试我们跨类或其他属性，例如：

```
<h3><span class="emptyClass">text</span></h3> 
```

在 TinyMCE 4+ 中，这种方法效果很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-03T04:32:52.673

Tinymce 删除没有任何属性的 span 标签。我们可以将 span 与任何属性一起使用，这样它就不会被删除。

```
e.g <span class="my-class">Mahen</span> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-04T13:11:29.673

试试这个 3.5.8：

1.  将 tiny_mce_src.js（第 1121 行）中的 cleanupStylesWhenDeleting 替换为：

    ```
     function cleanupStylesWhenDeleting() {
            function removeMergedFormatSpans(isDelete) {
                    var rng, blockElm, wrapperElm, bookmark, container, offset, elm;
                    function isAtStartOrEndOfElm() {
                            if (container.nodeType == 3) {
                                    if (isDelete && offset == container.length) {
                                            return true;
                                    }

                                    if (!isDelete && offset === 0) {
                                            return true;
                                    }
                            }
                    }

                    rng = selection.getRng();
                    var tmpRng = [rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset];

                    if (!rng.collapsed) {
                            isDelete = true;
                    }

                    container = rng[(isDelete ? 'start' : 'end') + 'Container'];
                    offset = rng[(isDelete ? 'start' : 'end') + 'Offset'];

                    if (container.nodeType == 3) {
                            blockElm = dom.getParent(rng.startContainer, dom.isBlock);

                            // On delete clone the root span of the next block element
                            if (isDelete) {
                                    blockElm = dom.getNext(blockElm, dom.isBlock);
                            }

                            if (blockElm && (isAtStartOrEndOfElm() || !rng.collapsed)) {
                                    // Wrap children of block in a EM and let WebKit stick is
                                    // runtime styles junk into that EM
                                    wrapperElm = dom.create('em', {'id': '__mceDel'});

                                    each(tinymce.grep(blockElm.childNodes), function(node) {
                                            wrapperElm.appendChild(node);
                                    });

           blockElm.appendChild(wrapperElm);
                            }
                    }

                    // Do the backspace/delete action
                    rng = dom.createRng();
                    rng.setStart(tmpRng[0], tmpRng[1]);
                    rng.setEnd(tmpRng[2], tmpRng[3]);
                    selection.setRng(rng);
                    editor.getDoc().execCommand(isDelete ? 'ForwardDelete' : 'Delete', false, null);

                    // Remove temp wrapper element
                    if (wrapperElm) {
                            bookmark = selection.getBookmark();

                            while (elm = dom.get('__mceDel')) {
                                    dom.remove(elm, true);
                            }

                            selection.moveToBookmark(bookmark);
                    }
            }

                editor.onKeyDown.add(function(editor, e) {
                    var isDelete;

                    isDelete = e.keyCode == DELETE;
                    if (!isDefaultPrevented(e) && (isDelete || e.keyCode == BACKSPACE) && !VK.modifierPressed(e)) {
                            e.preventDefault();
                            removeMergedFormatSpans(isDelete);
                    }
            });

            editor.addCommand('Delete', function() {removeMergedFormatSpans();});
    }; 
    ```

2.  在 tiny_mce.js 下方的 html 中放置指向 tiny_mce_src.js 的外部链接

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-04T21:38:39.573

可以通过将其编写为 JavaScript 脚本来使用该工作，以防止 WYSIWIG 剥离空标签。在这里，我的问题是包含使用空 <i> 或 <span> 标签的 Font Awesome 图标。

```
<script>document.write('<a href="https://www.facebook.com" target="_blank"><i class="fa fa-facebook"></i></a>');</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-11T10:21:53.140

遇到这个问题，对提供的所有答案都不满意。

我们确实需要在某个时候更新 wordpress，因此更改核心文件不是一种选择。为元素添加属性只是为了修复 tinyMCE 行为似乎也不是正确的事情。

使用文件中的以下钩子，`functions.php`tinyMCE 将不再删除空`<span></span>`标签。

```
function tinyMCEoptions($options) {
    // $options is the existing array of options for TinyMCE
    // We simply add a new array element where the name is the name
    // of the TinyMCE configuration setting.  The value of the array
    // object is the value to be used in the TinyMCE config.

    $options['extended_valid_elements'] = 'span';
    return $options;
}
add_filter('tiny_mce_before_init', 'tinyMCEoptions'); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-28T10:36:36.857

在 Tinymce 插件参数中启用：使用 Joomla 文本过滤器。

确保您的用户组在全局配置 > 文本过滤器中设置了“无过滤”选项。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-22T08:03:04.297

我遇到了同样的问题。正在删除空的 SPAN 标记。我找到的解决方案是

`verify_html: false`,

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-19T19:01:57.917

您正在运行最新版本的 TinyMCE 吗？我遇到了相反的问题——新版本的 TinyMCE 会添加不需要的跨度元素。降级到 v3.2.7 为我解决了这个问题，如果您愿意使用旧版本，这也可能对您有用。

已经报告了类似的错误，请参阅以下链接以了解在“跨度”元素上过滤的错误： [http ://www.tinymce.com/develop/bugtracker_bugs.php#!order=desc&column=number&filter=span&status=open,verified&type=bug](http://www.tinymce.com/develop/bugtracker_bugs.php#!order=desc&column=number&filter=span&status=open,verified&type=bug)

# vim - 如何根据文件是否通过来选择 NERDTree 窗口 Vim 关注的内容

> ID：14962830
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:00.920
> 
> 标签：vim, nerdtree

我目前在我的 .vimrc 中有以下内容：

```
au VimEnter * NERDTree
au BufWinEnter * NERDTreeMirror 
```

我相信当我打开 Vim 以及使用插件打开新选项卡时会启动 NERDTree。目前，当我使用启动 Vim

```
vim 
```

在命令行中，光标位于 NERDTree 中，可供我浏览我的文件，这很棒。但是，当我使用

```
vim my-file.txt 
```

光标保留在 NERDTree 窗口中。我知道我可以将它添加到我的 .vimrc 中：

```
au BufNew * wincmd l 
```

但这意味着光标将始终放置在 NERDTree 右侧的窗口中，即使我没有指定文件。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T17:02:53.067

你可以使命令以参数是否传递给 Vim 为条件：

```
:au VimEnter * if argc() > 0 | wincmd l | endif 
```

（我会`VimEnter`为此使用该事件；只需确保此 autocmd 出现在打开 NERDTree 的那个之后。）

PS：这里有几个相关的问题：

*   [在“每个”选项卡中自动打开 NERDTree](https://stackoverflow.com/q/1979520/813602)
*   [你如何将 NERDTree 添加到你的 vimrc 中？](https://stackoverflow.com/q/1447334/813602)

# c - c中的登录模拟器，取消引用不完整的类型错误

> ID：14962835
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:08.737
> 
> 标签：c, unix, pointers, login

作为学校计算机实验室的一项准备工作，我们被要求编写 ac 程序来模拟 UNIX 中的登录过程。该程序应该从终端读取用户名和密码，将其与本地文件中的散列值进行比较，该文件应该类似于 /etc/passwd。

这是我所拥有的：

```
/*
 * Program mylogin.c
 *
 * This program prompts the user for a login name and password
 *
 */

#define _XOPEN_SOURCE
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <pwd.h>
#include <sys/types.h>
#include <string.h>

/* define some error constants */
#define NOUSER -1

/* define max size of a username */
#define USERNAME_SIZE 32
#define PASSWORD_SIZE 32
#define HASH_SIZE 32
#define FAILED_LIMIT 5
#define AGE_LIMIT 10

int read_username(char *username)
{

    printf("login: ");
    fgets(username,USERNAME_SIZE,stdin);

    /* remove the CR included by getline() */
    username[strlen(username)-1]='\0';
    return(0);
}

int read_password(char *password)
{

    printf("password: ");
    fgets(password,PASSWORD_SIZE,stdin);
    //getpass(password);

    /* remove the CR included by getline() */
    password[strlen(password)-1]='\0';
    return(0);
}

int user_exists(const char *username)
{
    struct pwdb_passwd *pw_entry;

    pw_entry=getpwnam(username);
    return((pw_entry)!=NULL);
}

int main(int argc,char **argv)
{
    char username[USERNAME_SIZE];
    char* password;

    /* write "login:" and read user input */
    read_username(username);
    read_password(password);

    if (!user_exists(username))
    {
        printf("Unknown user or authentication\n");
        main(argc, argv);
    }
    struct pwdb_passwd *pw_entry = getpwnam(username);
    char* hashed_password = crypt(password,pw_entry->pw_passwd);
    if(strcmp(hashed_password,  pw_entry->pw_passwd)==0)
    {
        if((pw_entry->pw_failed)<FAILED_LIMIT)
        {
            printf("User authenticated successfully\n");
            pw_entry->pw_age++;
            pw_entry->pw_failed = 0;
            pwdb_update_user(pw_entry);
        }else{
            printf("User account locked\n");
            main(argc, argv);
        }
    }
    else
    {
        printf("Unknown user or authentication\n");
        pw_entry->pw_failed++;
        if(pw_entry->pw_failed>5){
            printf("Too many failed attempts. Username now locked\n");
        }
        pwdb_update_user(pw_entry);
        main(argc, argv);
    }
    return(0);
} 
```

struct pwdb_passwd 定义在文件 pwdb_lib.c 和 pwdb_lib.h 中，它们已经编写好了。

当我编译程序时，我得到了几个错误。例如在第 73 行，我得到：“错误：取消引用指向不完整类型的指针”

我不明白为什么。它似乎不喜欢这样`pw_entry->pw_passwd`的事情。更重要的是，在 Windows 下使用 Code::Blocks（使用 gcc）编译时，与在 Ubuntu 下使用 gcc 编译时出现不同的错误。我觉得这很奇怪。我怀疑这可能是因为我导入了 pwd.h 并且它只存在于 Linux 而不是 Windows。这可能是对的吗？我尝试创建自己的 pwd.h 文件并将其保存在同一目录中，但它仍然无法正常工作。移动到 ubuntu 计算机，我没有从 pwd.h 中得到错误，而是得到错误：“取消引用指向不完整类型的指针”

我的代码有什么问题？

我还怀疑 user_exists 函数存在内存泄漏，但我不确定它是否会影响整个程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:50:49.597

即使`pwdb_lib.c`已经编写好，您也需要将其包含在源文件中。

添加

```
#include "pwdb_lib.h" 
```

到您的源代码并确保您编译/链接`pwdb_lib.c`

通过`#include`ing 这个文件，您可以让您的源文件知道其中的定义，而无需提供实现。最后，当您使用（或链接其目标文件，如果您正在这样做）编译程序时`pwdb_lib.c`，您让包含这些定义的任何源知道它们在哪里实现（因此，让它们能够使用它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:50:51.027

如果标题被命名`pwdb_lib.h`，那么为什么你的程序不做`#include`呢？它似乎包含一个不同的标题 ( `pwd.h`)，它是什么？

如果声明丢失，您将得到的错误是您所期望的。

# html - 如何为列和行部分创建带有标题的 html 表

> ID：14962836
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:11.127
> 
> 标签：html, css, html-table

我正在尝试制作一个类似于此的 html 表：

![在此处输入图像描述](../Images/3a77d0aab7c11c9b49b80a3b06d10d4c.png)

我对表格的数据不感兴趣，只对准系统感兴趣：可能性、后果、列名（次要、中等等）和行（几乎可以肯定、可能等）。

这是我到目前为止所拥有的：http: [//jsfiddle.net/PQHR6/](http://jsfiddle.net/PQHR6/)

我不知道如何制作这些`Likelihood`和`Consequence`标题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:55:22.420

您需要`th`与属性一起使用`colspan`。

```
 <tr>
        <th>Table header</th>
        <th colspan="5">Table header</th>
    </tr>
    <tr>
        <th>&nbsp; <!-- EMPTY --></th>
        <th>Minor</th>
        <th>Lorem 1</th>
        <th>Lorem 2</th>
        <th>Lorem 3</th>
        <th>Lorem 4</th>
    </tr>
    <tr>
        <th>Almost Certain</th>
        <td>Table cell 1</td>
        <td>Table cell 2</td>
        <td>Table cell 3</td>
        <td>Table cell 4</td>
        <td>Table cell 5</td>
    </tr> 
```

**jsfiddle：http: [//jsfiddle.net/nPQfz/](http://jsfiddle.net/nPQfz/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:50:16.347

使用表格标题`th`并将`colspan`属性添加到第二个标题以跨越 5 列：

```
<tr>
    <th>Likelyhood</th>
    <th colspan="5">Consequence</th>
</tr> 
```

[更新了 jsfiddle](http://jsfiddle.net/PQHR6/2/)

# c# - 使用 C# 将多个文件写入一个文件时出现行结束问题

> ID：14962841
> 
> 赞同：1
> 
> 时间：2013-02-19T16:45:19.330
> 
> 标签：c#, file-io, streamwriter

我正在尝试将 4 组 15 个 txt 文件写入 4 个大 txt 文件，以便更容易导入另一个应用程序。

这是我的代码：

```
using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace AggregateMultipleFiles
{
    class AggMultiFilestoOneFile
    {/*This program can reduce multiple input files and grouping results into one file for easier app loading.*/
    static void Main(string[] args)
    {

        TextWriter writer = new StreamWriter("G:/user/data/yr2009/fy09_filtered.txt");  
        int linelen =495; 
        char[] buf = new char[linelen];
        int line_num = 1;

        for (int i = 1; i <= 15; i++)
        {
                TextReader reader = File.OpenText("G:/user/data/yr2009/fy09_filtered"+i+".txt"); 
            while (true)
            {
                int nin = reader.Read(buf, 0, buf.Length);
                if (nin == 0 )
                {
                    Console.WriteLine("File ended");
                    break;
                }
                writer.Write(new String(buf));

                line_num++;
            }
            reader.Close();

        }
        Console.WriteLine("done");
        Console.WriteLine(DateTime.Now);
        Console.ReadLine(); 
        writer.Close();

    }
  }
} 
```

我的问题出在调用文件末尾的某个地方。它没有完成文件的最后一行的写入，然后在前一个文件的最后一行的中间开始写入下一个文件的第一行。

这会丢弃它导入的应用程序中的所有列和数据。

有人建议我可能需要在 15 个文件的每一行的末尾用回车符和回车符来填充，\r\n。

1.  为什么我的东西不起作用？
2.  填充会起作用吗？我该怎么写？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T16:49:31.063

我强烈怀疑这是问题所在：

```
writer.Write(new String(buf)); 
```

您总是从*所有*字符创建一个字符串，`buf`而不仅仅是第一个`nin`字符。如果您的任何文件都很短，您最终可能会得到“空”Unicode 字符（即 U+0000），这在某些应用程序中可能被视为字符串终止符。

甚至不需要创建一个字符串 - 只需使用：

```
writer.Write(buf, 0, nin); 
```

（顺便说一句，我还强烈建议使用`using`语句而不是手动调用`Close`。）

还值得注意的是，没有*什么*可以保证您真的一次阅读一行。您不妨将缓冲区大小增加到 32K，以便以可能更少的块读取文件。

此外，如果文件足够小，您可以将每个文件完全读入内存，这将使您的代码更简单：

```
using (var writer = File.CreateText("G:/user/data/yr2009/fy09_filtered.txt"))
{
    for (int i = 1; i <= 15; i++)
    {
        string inputName = "G:/user/data/yr2009/fy09_filtered" + i + ".txt";
        writer.Write(File.ReadAllText(inputName));
    }
} 
```

# php - iPhone上的PHP电子邮件无法正确显示

> ID：14962844
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:27.547
> 
> 标签：php, iphone, email

我有一个向网站所有者和表单提交者发送电子邮件的表单。它在任何地方看起来都很棒，但在 iPhone 上它包含所有的 html 代码。

这是我处理表单的代码：

```
 <?php

 $name_field = $_POST['name'];
 $email_field = $_POST['email'];
 $phone = $_POST['phone'];
 $message = $_POST['message'];
 $link = $_POST['link'];
 $to = 'me@me.com';
 $toCust = $email_field;
 $subject = 'Lead From Website';
 $random_hash = md5(date('r', time()));
 $headers = "From: me@me.com\r\nReply-To: $email; ";
 $headers .= "\r\nContent-Type: multipart/alternative; boundary=\"PHP-alt-".$random_hash."\"";
 ob_start();
 ?>

 --PHP-alt-<?php echo $random_hash; ?> 
 Content-Type: text/html; charset="UTF-8"
 Content-Transfer-Encoding: 7bit

 <h3>Contact Form Submission From Website</h3>
 <table width="39%" cellpadding="10" border="0">
   <tr>
     <td width="47%"><strong>Name:</strong></td>
     <td width="53%" style='color:#990000'><?php echo $name_field; ?></td>
   </tr>
   <tr>
     <td><strong>Email:</strong></td>
     <td style='color:#990000'><?php echo $email_field; ?></td>
   </tr>
   <tr>
     <td><strong>Phone Number:</strong></td>
     <td style='color:#990000'><?php echo $phone; ?></td>
   </tr>
   <tr>
     <td><strong>Message:</strong></td>
     <td style='color:#990000'><?php echo $message; ?></td>
   </tr>

 </table>

 --PHP-alt-<?php echo $random_hash; ?>--
 <?
 $message = ob_get_clean();
 if(isset($_POST['link']) && $_POST['link'] == ''){

     $mail_sent = @mail( $to, $subject, $message, $headers );
$mail_sent = @mail( $toCust, $subject, $message, $headers );
header('Location: thankyou.html');
 }
 echo $mail_sent ? "Your email has been sent." : "The message failed to send. Our form thinks   you're spam. If you're not, please give us a call";
 ?> 
```

这是我在 iPhone 上以纯文本形式显示的：

```
--PHP-alt-1962a6e1cb0d62a23c8e1743bd157401 
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: 7bit

<html>
<body>
<h3>Contact Form Submission From Website</h3>
<table width="39%" cellpadding="10" border="0">
  <tr>
    <td width="47%"><strong>Name:</strong></td>
    <td width="53%" style='color:#990000'>Dave</td>
  </tr>
  <tr>
    <td><strong>Email:</strong></td>
    <td style='color:#990000'>me@me.com</td>
  </tr>
  <tr>
    <td><strong>Phone Number:</strong></td>
    <td style='color:#990000'>666-666-6666</td>
  </tr>
  <tr>
    <td><strong>Message:</strong></td>
    <td style='color:#990000'>test of iphone</td>
  </tr>

</table>
</body>
</html>
--PHP-alt-1962a6e1cb0d62a23c8e1743bd157401-- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:14:38.043

您的问题可能在这里：

```
 Content-Type: text/html; charset="UTF-8"
 Content-Transfer-Encoding: 7bit 
```

UTF-8 和 7 位编码几乎是互斥的，因为 UTF-8 是一种多字节编码。您可能应该切换到quoted-printable 并使用[`quoted_printable_encode()`](http://php.net/manual/en/function.quoted-printable-encode.php). 如果您使用的是 PHP < 5.3，则评论中有直接替换。

## 编辑

```
$part_header = <<<_EOI_

 --PHP-alt-$random_hash
 Content-Type: text/html; charset="UTF-8"
 Content-Transfer-Encoding: quoted-printable

_EOI_;

$part_body = <<<_EOI_
 <html>
 <body>
 <h3>Contact Form Submission From Website</h3>
 <table width="39%" cellpadding="10" border="0">
   <tr>
     <td width="47%"><strong>Name:</strong></td>
     <td width="53%" style='color:#990000'>$name_field</td>
   </tr>
   <tr>
     <td><strong>Email:</strong></td>
     <td style='color:#990000'>$email_field</td>
   </tr>
   <tr>
     <td><strong>Phone Number:</strong></td>
     <td style='color:#990000'>$phone</td>
   </tr>
   <tr>
     <td><strong>Message:</strong></td>
     <td style='color:#990000'>$message</td>
   </tr>
 </table>
 </body>
 </html>

 --PHP-alt-$random_hash--
 _EOI_;

$message = $part_header . quoted_printable_encode($part_body); 
```

# javascript - 使用自定义回调时的 Javascript 范围性能建议

> ID：14962847
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:37.760
> 
> 标签：javascript, performance

当我使用传递给 jQuery.animate() 的自定义回调函数时，我有一个关于范围界定的小问题。考虑下面的代码。

```
;var WebApi = (function projectInit (WebApi, $, Modernizr, window, document, undefined) {

    $(element).on('click.skiptodocumentpart', function skipToDocumentPart (e) {
        WebApi.scrollTo(
            $(this.getAttribute('href')).offset().top, 
            1000, 
                $pageNav.length ? repositionPageNav($pageNav, $(this)) : null
        );
        return false;
    });

    function repositionPageNav ($pageNav, $elm) {
        console.log(this); // undefined
    };

    WebApi.scrollTo = function (yPos, iSpeed, callback) {
        $('html,body').animate({ 
            scrollTop : yPos 
        },{ 
            duration : typeof iSpeed === 'number' ? iSpeed : 1000, 
            complete : typeof callback === 'function' ? callback : null
    });
};

return WebApi;

}(WebApi || {}, jQuery, Modernizr, this, this.document)); 
```

当我在 repositionPageNav 回调中记录函数上下文时，我得到一个未定义的，理想情况下，我会让上下文引用单击的元素，就像 jQuery 本身通常所做的那样。我可以通过将回调调用更改为 WebApi.scrollTo 来做到这一点，如下所示：

```
WebApi.scrollTo(
        yPos, 
        1000, 
        as$pageNav.length ? (function (scope) {
                return repositionPageNav.call(scope, $pageNav);
            }(this)) : null
        ); 
```

通过创建闭包，回调中的上下文现在指的是按我的意图单击的元素，但这会损害性能吗？我无法理解的一件事是为什么在第一个示例中上下文未定义？是因为我没有将回调称为 callback.call(context) 吗？有什么建议/想法吗？

非常感谢，

缺口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:59:11.957

[`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)更像是一个上下文*，*它**不是**[变量]*范围*。

但是，问题似乎更多是您立即调用`repositionPageNav`函数（在两个版本中），而不是传递回调函数。如果您这样做，`this` *将*引用调用动画的 DOM 元素。

# asp.net-mvc - MVC 单选按钮

> ID：14962849
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:43.237
> 
> 标签：asp.net-mvc, razor

我有以下几点：

```
 <div class="editor-field">
       @Html.RadioButtonFor(m => m.TotalCol, "Yes")  @Html.Label("Yes")&nbsp;&nbsp; 
       @Html.RadioButtonFor(m => m.TotalCol, "No") @Html.Label("No") 
```

请注意，TotalCol 是一个字符串。

```
 public string TotalCol { get; set; } 
```

我使用以下内容来获取值：

```
 var TotalCo = $('#TotalCol').val();
    alert(TotalCo); 
```

警报显示是。

如果我在提交表单时发出警报而不选择是或否，我仍然会得到是。这是为什么。为什么它不只是返回空白。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:12:22.703

通过查看您的代码，我看到您的 RadioButtons 实际上被“分组”为#TotalCol，因此 jquery 只能抓住第一个元素并为您显示来自该组特定元素的 val。例如，如果你要反转这个，你会得到相反的结果（警报会像这样返回“否”）：

```
@Html.RadioButtonFor(m => m.TotalCol, "No") @Html.Label("No")
@Html.RadioButtonFor(m => m.TotalCol, "Yes")  @Html.Label("Yes")&nbsp;&nbsp; 
```

我希望这是有道理的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:21:23.453

当您有两个具有相同名称（或 ID）的单选按钮时，您需要找出选择了哪一个。您可以使用选择器来做到这一点`:checked`。

例子：

```
 $('#TotalCol:checked').val(); 
```

或者

```
 $('input[name=TotalCol]:checked').val(); 
```

# php - PHP+Apache 失去会话

> ID：14962853
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:53.593
> 
> 标签：php, apache2, session-cookies

我有一个 PHP 应用程序，它在我与一些同事共享的 LAMP VPS 上一段时间后失去了会话。

同一个应用程序在我的本地 MAMP 服务器上没有这个问题。

我过去在使用相同的 VPS 时也遇到过同样的问题，但我不记得我是如何（或什至*是否*）修复它的，我也不知道是什么原因造成的。我玩过 cookie 参数，但没有帮助。

我是这样开始的：

```
session_name($COOKIE_NAME);
session_set_cookie_params($COOKIE_LIFE,$COOKIE_PATH,$COOKIE_DOMAIN);
session_start(); 
```

在这`path`两种情况下都设置为“/”，域设置在`xxx.localhost:8888`我的 MAMP 和`xxx.mydomain.net`VPS 上，两台服务器的寿命相同。

我也尝试过使用空`domain`参数，因为这在过去修复了类似的问题，但没有任何改变：它仍然在本地工作并且在 VPS 上被破坏。

有谁知道我可以在哪里调查以找到这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T14:22:59.023

显然我在这个问题中强调了同样的问题[，](https://stackoverflow.com/questions/12251550/php-resetting-session-after-some-time)并以同样的方式解决了它。

# android - 我如何在android设备上制作折线图？

> ID：14962857
> 
> 赞同：0
> 
> 时间：2013-02-19T16:45:58.810
> 
> 标签：android, ios, titanium

我正在使用钛 SDK。我想在我的应用程序中添加折线图工具。我的应用程序与设备兼容（android 和 iphone）。对于折线图，我使用的是 google graph api。（[https://developers.google.com/chart/interactive/docs/gallery/linechart](https://developers.google.com/chart/interactive/docs/gallery/linechart)）。但仅适用于 iphone，而不适用于 android。与 iphone 工作得很好。但是，不适用于android。错误消息是：[表达式'c[0]'[null] 的结果不是对象。] 我如何消除这个问题我正在使用这个代码。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {

            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Month'); // Implicit domain label col.
            data.addColumn('number', 'Sales'); // Implicit series 1 data col.
            data.addColumn({type:'string', role:'annotation'}); // annotation role col.
            data.addRows([
                ['April',1000,    'A'],
                ['May',  1170,   'B'],
                ['June',  660,   'C'],
                ['July', 1030,  'c']
            ]);
            var options = {
              title: 'Company Performance'
            };

            var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
            chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

请帮助我，提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T07:29:12.797

这段代码对我有用。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
                width: 400, height: 400, annotationColumns:[{column:2, size:15, type:'flag', priority:'high'},], title: ''
        };

        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

谢谢大家。

# backbone.js - Backbone - 在渲染视图之前执行多个 fetch()

> ID：14962858
> 
> 赞同：16
> 
> 时间：2013-02-19T16:46:06.763
> 
> 标签：backbone.js

我想知道这里的最佳模式/方法。这是我的路由器中的一个功能，因此用户点击“quotes/:id”，但要呈现该视图，我需要他们的项目、客户和货币的列表。`quotesEdit`在尝试实例化视图之前确保所有 3 个 fetches() 都发生的最佳方法是什么？当用户点击某些东西时获取所有信息是否被认为是不好的做法？

```
 quotesEdit: function(id) {
        kf.Collections.quotes = kf.Collections.quotes || new kf.Collections.Quotes();
        kf.Collections.projects = kf.Collections.projects || new kf.Collections.Projects();
        kf.Collections.currencies = kf.Collections.currencies || new kf.Collections.Currencies();
        //do a fetch() for the 3 above
        kf.Collections.customers = kf.Collections.customers || new kf.Collections.Customers();
        var quote = kf.Collections.quotes.where({Id: parseInt(id, 10)});
        kf.Utils.ViewManager.swap('sectionPrimary', new kf.Views.section({
          section: 'quotesEdit',
          model: quote[0]
        }));
    } 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-19T16:55:08.133

我发现[jQuery deferreds](http://api.jquery.com/category/deferred-object/)和 underscore 的组合[`invoke`](http://underscorejs.org/#invoke)可以优雅地解决这个问题：

```
//call fetch on the three collections, and keep their promises
var complete = _.invoke([quotes, projects, currencies], 'fetch');

//when all of them are complete...
$.when.apply($, complete).done(function() {
   //all ready and good to go...
}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-19T16:55:22.063

承诺！特别[是 jQuery.when](http://api.jquery.com/jQuery.when/)

你可以这样做：

```
$.when(
  kf.Collections.quotes.fetch(),
  kf.Collections.projects.fetch(),
  kf.Collections.currencies.fetch()
).then(function(){
  // render your view.
}); 
```

jQuery.ajax（以及通过扩展骨干提取）返回一个承诺，`$.when`一旦多个承诺得到解决，您就可以使用它来设置回调函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T16:55:29.737

Backbone`fetch`返回一个 jQuery`Deferred`对象（一个承诺）。所以你可以使用 jQuery 的[when 函数](http://api.jquery.com/jQuery.when/)来等待所有的 Promise 解决：

```
 quotesEdit: function(id) {
  kf.Collections.quotes = kf.Collections.quotes || new kf.Collections.Quotes();
  kf.Collections.projects = kf.Collections.projects || new kf.Collections.Projects();
  kf.Collections.currencies = kf.Collections.currencies || new kf.Collections.Currencies();

  //do a fetch() for the 3 above
  var quotePromise = kf.Collections.quotes.fetch();
  var projectsPromise = kf.Collections.projects.fetch();
  var currenciesPromise = kf.collections.currencies.fetch();

  // wait for them to all return
  $.when(quotePromise, projectsPromise, currenciesPromise).then(function(){

    // do stuff here, now that all three have resolved / returned

    kf.Collections.customers = kf.Collections.customers || new kf.Collections.Customers();
    var quote = kf.Collections.quotes.where({Id: parseInt(id, 10)});
    kf.Utils.ViewManager.swap('sectionPrimary', new kf.Views.section({
      section: 'quotesEdit',
      model: quote[0]
    }));

  };

} 
```

我在这里写了一些关于 Promise 和 jQuery 的内容：

[http://lostechies.com/derickbailey/2012/03/27/providing-synchronous-asynchronous-flexibility-with-jquery-when/](http://lostechies.com/derickbailey/2012/03/27/providing-synchronous-asynchronous-flexibility-with-jquery-when/)

[http://lostechies.com/derickbailey/2012/07/19/want-to-build-win8winjs-apps-you-need-to-understand-promises/](http://lostechies.com/derickbailey/2012/07/19/want-to-build-win8winjs-apps-you-need-to-understand-promises/)

第二个链接仍然有效，尽管主要主题是 Win8 JS

# jquery - 页面显示之前的事件

> ID：14962859
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:07.007
> 
> 标签：jquery, jquery-mobile

在我的单页 jquery 移动应用程序中，我`$('#div').on('pageshow', function(){})`用于从 json Web 服务加载我的一些页面上的数据（我还在其他不需要每次查看时都重新加载的页面上使用 pageinit）。

虽然这一直很好，但我遇到了页面加载空白的问题，然后在加载数据后重新绘制。我确信这是预期的性能，但我真的很想在页面呈现之前加载数据，这样访问者就不会首先看到空白页面。

是否有页面加载前事件？另外，是否有一个可以在页面上调用的事件的好列表`.on()`？我已经搜索了几个小时，但找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:02:22.930

这只是您担心页面闪烁的问题吗？

如果是这样，你总是可以这样做：

```
body { display:none } 
```

然后在使用 jquery 加载数据后

```
$("body").show(); 
```

您还可以在屏幕上“加载” gif 图形（[http://www.ajaxload.info](http://www.ajaxload.info)），而不是仅仅不显示任何内容......这将是一个更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T22:36:59.367

你应该使用**`pagebeforeshow`**事件：

```
$('#div').on('pagebeforeshow', function(){}) 
```

看看我的另一篇**[文章](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**，有一个完整的页面事件触发列表，从第一个到最后一个。或者可以在**[这里](https://stackoverflow.com/a/14469041/1848600)**找到。

# android - Android WebView 错误

> ID：14962861
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:08.700
> 
> 标签：android, webview

我是学习Android的初学者，请帮助我。我不断收到此错误：

> 02-19 16:55:00.330: E/AndroidRuntime(2335): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.mkyong.android/com.mkyong.android.WebViewActivity}: java.lang.NullPointerException

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.webview);
    WebView mywebview = (WebView) findViewById(R.id.webView1);
    webView.getSettings().setJavaScriptEnabled(true);
    WebSettings webSettings = mywebview.getSettings();
    mywebview.loadUrl("http://www.google.com");
} 
```

我的 xml 文件：

```
<WebView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/webView1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:00:02.497

我想是这条线

> webView.getSettings().setJavaScriptEnabled(true);

你永远不会说 webView 是什么。您声明了 mywebview，但没有声明 webView

# java - 无法使用 apktool 编译应用程序：“资产包包括未找到”

> ID：14962863
> 
> 赞同：1
> 
> 时间：2013-02-19T16:46:11.410
> 
> 标签：java, android, compilation

我正在尝试编译一个应用程序，但我没有运气。我什至无法编译一个未修改的应用程序，即，如果我反编译 mms.apk（完全没有错误）并且我试图继续编译，它就不起作用！当我仍然使用 Windows 7 时，我已经这样做了，所以我知道为什么它不工作。

我注意到的一件事是安装框架`C:\Windows\system32\config\systemprofile\apktool\framework\1.apk` 可以吗？如果这有什么不同，我现在正在使用 Windows 8。

无论如何，这是我得到的输出：

[![图片](../Images/2edca6e595927b250753cb9b841f2fba.png)](https://i.stack.imgur.com/EE8Ua.png)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:56:24.893

像这样安装手机的框架

```
apktool if framework-res.apk 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-26T14:17:39.383

我认为您应该使用更新版本的 APKTtool：

[下载APK工具](http://ibotpeaches.github.io/Apktool/)

将所有三个文件（*aapt.exe*、*apktool.jar*和*apktool.bat*）放在一个文件夹中。

然后使用 cmd 转到该文件夹​​目录并键入`apktool d apkname.apk`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T13:28:23.423

`C:\Windows\system32\config\systemprofile\apktool\framework\1.apk`无法正确读取位于的文件。

这可能是由于您在`apktool if framework-res.apk`命令期间最初没有写入文件的权限。如您所见，在反编译期间，apktool 必须加载框架，以便在反编译期间正确解析资源。该错误的前几行表明 apktool 无法正确提取该文件。

我会按照克里斯蒂上面所说的去做，除了确保你在管理员启动的命令提示符窗口中，这样你就有权读取/写入 C 驱动器的所有部分。

# javascript - 我可以用javascript给一个按钮两个命令吗？

> ID：14962866
> 
> 赞同：1
> 
> 时间：2013-02-19T16:46:18.170
> 
> 标签：javascript, html, css, button, horizontal-scrolling

我创建了一个页面，分为七个部分和每个页面上的两个列 div。当我单击右按钮时，我滚动到下一列，当我单击左侧时，我滚动到左列。问题是，假设我在第一页，我从第二列滚动到第三列，我离开了页面，必须手动移动 x 滚动条。有没有办法我可以只编程按钮来强制 x 溢出？

谢谢

CSS

```
<style>
#contents {
width: 3500px; <!--Total size of the large container-->
height: 200px;
position: absolute; }

#container {
height: 500px;
overflow: hidden;
position: relative;
border: 1px #000 solid;
   }
#container, .col {
width: 500px;<!--total size of each column.-->
}
.col {

float: left;
 }
</style> 
```

HTML

```
 <!--Column 1--> 
  <div class="col">
<p>Put your content here...</p>
<button class="left">Left</button>
<button class="right">right</button>
 </div><!--end div column 1--> 
```

我又做了 6 列。

JAVASCRIPT

```
<script>
   var colwidth = $('#container').width(),
contwidth = $('#contents').width(),
getOffset = function() {
    return parseInt($('#container').css('margin-left'));
};

 $(".left").click(function(){
if (getOffset() === 0) return false;

$("#contents").animate({left: '+=' + colwidth},500);
$("#container").animate({'margin-left': '-=' + colwidth},500);
});
$(".right").click(function(){
if (getOffset() === contwidth - colwidth) return false;

$("#contents").animate({left: '-=' + colwidth},500);
$("#container").animate({'margin-left': '+=' + colwidth},500);
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:50:38.900

要将多个功能分配给单击，您可以从现有功能中调用一个功能，或创建一个专门用于调用其他 2 个功能的新功能。

# java - 合并两个具有时间戳优先级的文件夹

> ID：14962867
> 
> 赞同：1
> 
> 时间：2013-02-19T16:46:20.573
> 
> 标签：java, copy

我们的一个团队最近将大量遗留数据迁移到包含所有当前数据的文件夹中。一些团队成员不知道这些更改，因此他们继续在旧文件夹中进行修改。

我想通过时间戳检查来整合数据。我可以为此编写一个脚本，但我本质上想要对两个文件夹进行 Windows 资源管理器合并，其中选择的选项始终是冲突中的“较新”选项。也就是说，如果源具有较新的文件，则将源复制到 dest。如果 dest 较新，请不要将源复制到 dest。如果源存在但目标不存在，则复制源。

我正在用 Java 编写一个快速脚本，但遇到了一些问题，我想知道是否有更简单的解决方案来简单地始终选择“更新”选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:48:24.460

复制文件 在 Java 中复制文件[的标准简洁方法？](https://stackoverflow.com/questions/106770/standard-concise-way-to-copy-a-file-in-java)

获取时间戳[http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified%28%29](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified%28%29)

# c# - 在 C# 中的占位符中创建一个表单

> ID：14962875
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:31.780
> 
> 标签：c#, asp.net

```
StringBuilder str=new StringBuilder();
str.Append("<div style='font-style:oblique;font-size:24px;text-align:left;margin-bottom:25px;'>");
str.Append("Products");
str.Append("</div>");
str.Append("<div style='font-style:oblique;font-size:18px;text-align:right;margin-bottom:25px;'>");
str.Append("<asp:TextBox ID='txtSearch' runat='server'></asp:TextBox> &nbsp;&nbsp; <asp:Button ID='btbSearch' runat='server' Text='Search'/>");
str.Append("</div>");
str.Append("<table width='100%' border='1' cellpadding='0' cellspacing='0'>"); 
```

在第二个`<div>`中，我尝试创建一个文本框和一个按钮并将它们添加到占位符中。当我使用浏览器控制台进行调试时，我在 html 代码中看到它们，但它无法在浏览器中显示，它只是在浏览器上显示表格。有什么例子可以处理这些案例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:52:48.023

`<asp:`标签完全是服务器端标签。它们将由 ASP 引擎翻译成纯 HTML 标记。

通过将这些标记直接写入响应，您绕过了 ASP 引擎将它们重构为正确 HTML 的能力。当浏览器获取它们时，它不知道如何呈现它们，所以它只是忽略它们。

您应该将控件创建为对象，而不是字符串，例如：

```
TextBox txtSearch = new TextBox();
txtSearch.ID= "txtSearch";
placeHolder1.Controls.Add(txtSearch);

Button btbSearch = new Button();
btbSearch.ID = "btbSearch";
btbSearch.Text = "Search";
placeHolder1.Controls.Add(btbSearch); 
```

或者，更好的是，您可以将该文本放在标记文件中，而不是使用后面的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T16:55:50.303

很可能您没有生成要在服务器上呈现的 ASPX 页面，而是将 StringBuilder 的输出发送到浏览器。由于`asp:TextBox`浏览器无法呈现类似的 ASP.Net 元素，因此您在视图中什么也看不到（节点也存在，因为它们不会使 HTML 完全无效）。

您想要生成`<INPUT...>`元素而不是`asp:TextBox`在浏览器中查看输出。

注意：可能有更好的方法来实现您的目标（即客户端模板，或视图中的常规渲染），但您需要先拼写您的实际问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T17:33:44.163

您可以使用这样的代码

```
var tableBody=""; // here you have to define the table body yourself

var form=
    new {
        method=@"get", // decide for your request method get/post
        action=@"http://www.google.com" // the page processes the request
    };

var html=@"
<div style='font-style: oblique; font-size: 24px; text-align: left; margin-bottom: 25px'>Products</div>

<div style='font-style: oblique; font-size: 18px; text-align: right; margin-bottom: 25px'>
    <form method='"+form.method+@"' action='"+form.action+@"'>
        <input id='txtSearch' name='txtSearch'>
        &nbsp;&nbsp;
        <input type='button' id='btbSearch' text='Search' onclick='this.parentNode.submit();'>
    </form>
</div>

<table width='100%' border='1' cellpadding='0' cellspacing='0'>"+tableBody+@"
</table>
"; 
```

html的固定部分代码不一定与`StringBuffer`. 如果要动态生成 html，请考虑使用 LINQ。

自己应该做的在代码的注释中。请注意，`txtSearch`不仅给出了`id`，而且还给出了`name`。

# vb.net - VB.Net 在数据表中搜索新出现的值

> ID：14962877
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:33.233
> 
> 标签：vb.net, search, datatable

我正在尝试在一个数据表中搜索字符串，因此如果出现新的命中，则会触发操作。怎么做？

我当前的代码：

```
If searchvalue <> "" Then
                foundRows = table.Select("Name LIKE '%" & searchvalue & "%'")
                If foundRows.Length = 0 Then
                    'none found
                Else
                    For Each r In foundRows
                        notif("Found "&r.itemarray(0) & " in " & r.itemarray(1))
                    Next
                End If
            End If 
```

每次调用 sub 时，每次点击都会调用“notif”函数；但我希望它为每个独特的命中调用一次。怎么做？

使用案例：比如说，当表是这样时，第一次调用 sub ：

```
something foo
smthelse bar 
```

搜索字符串是“some”，Notif 调用了一次“something foo”。下一次 sub 被称为 table 是这样的：

```
something foo
something else 
smthelse bar 
```

现在 Notif 应该只为“其他东西”调用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:57:40.557

我建议`Linq-To-DataSet`改用它，它可以使您的代码更具可读性、可维护性，并且还具有一些不错的功能，例如分组：

```
If searchvalue.Length <> 0 Then
    Dim foundNamegroups = From row In table
                          Let Name = row.Field(Of String)("Name")
                          Where Name.Contains(searchvalue)
                          Group row By Name Into NameGroup = Group
    If foundNamegroups.Any() Then
        For Each grp In foundNamegroups
            ' note that the DataRows are in  grp.NameGroup
            Dim msg = String.Format("Found {0} rows for name {1}", grp.NameGroup.Count(), grp.Name)
            notif(msg)
        Next
    End If
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T07:59:09.080

找到了解决方案 - 我使用了 row.RowState 属性。

每次更改或添加行时，它的 row.RowState 属性等于 DataRowState.Added 或 DataRowState.Modified，并且当 row.AcceptChanges() 调用它时，它变为 DataRowState.Unchanged 。

# ios - 将本地文件移动到 iCloud 时如何确定本地文件是否较新？

> ID：14962878
> 
> 赞同：2
> 
> 时间：2013-02-19T16:46:33.180
> 
> 标签：ios, objective-c, cocoa-touch, icloud, uidocument

当用户在我的应用中启用 iCloud 时，我需要将所有本地文件移动到 iCloud。在这里，我`setUbiquitous:itemAtURL:destinationURL:error:`用来移动每个文件。问题是，如果（对于任何本地文件）相同的文件 URL 已存在于 iCloud 上，此方法将失败。

我的问题是，如何确定哪个文件更新（本地与 iCloud），以便我可以覆盖 iCloud 版本或丢弃每个文件的本地版本？或者，我能否以某种方式强制 iOS 执行上传并将文件状态设置为 iCloud 上的冲突，以便我的冲突解决方法将接管并处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:03:00.977

FWIW，来自 Apple 的 dox，他们建议采用全有或全无的 iCloud 方法 - 即，在某一时刻询问用户是否应该启用 iCloud，然后不要更改。

也就是说，对于您的情况，我建议在用户启用 iCloud 后执行以下步骤：

1) 运行具有普遍作用域的 NSMetaDataQuery 以获取该应用程序已在云中的文件列表。（请注意，查询必须在主线程上运行，否则您将一无所获）。

2）如果你有一个同名的文件，你可以在 NSMetaData 中使用最后修改的日期键（NSMetadataItemFSContentChangeDateKey）来确定你应该使用哪个（或者你想使用什么方法来解决冲突）

3) 如果文件还没有在云中，那么使用 setUbiquitous 方法将它放在那里。

# java - Netty 连接池

> ID：14962879
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:40.050
> 
> 标签：java, client, netty

Netty 连接池

我想知道哪些选项或如何在 netty 中实现客户端连接池。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:36:53.703

我还没有实现这个，所以这只是一些有根据的猜测，但我会考虑结合以下内容：

*   [Apache Commons GenericKeyedObjectPool](http://commons.apache.org/proper/commons-pool/api-2.4.2/org/apache/commons/pool2/impl/GenericKeyedObjectPool.html)
*   [Netty 频道组](http://netty.io/3.10/api/org/jboss/netty/channel/group/ChannelGroup.html)

通用对象池将支持您创建连接缓存，以远程套接字地址作为键，因此您可能会发出如下请求：

```
pool.borrowObject("www.google.com:80"); 
```

不确定通道组，除了它是一次性针对所有包含的通道发出指令的好方法（例如 close()），因此让池的[PooledObjectFactory](http://commons.apache.org/proper/commons-pool/api-2.4.2/org/apache/commons/pool2/BaseKeyedPooledObjectFactory.html)始终将其创建的所有通道插入到频道组也是如此。它是自我维护的，因为通道在关闭时会从组中弹出。

在许多情况下，Commons Pooling 对我来说都非常有用，尽管主要是在我试图汇集和重用*昂贵的*资源时。这是您查看客户端连接的方式吗？

2017 年 8 月 30 日更新：

在 Netty 4.x 中执行此操作的首选方法是使用 ChannelPool。Netty 4.0：[通道池](http://netty.io/4.0/api/io/netty/channel/pool/ChannelPool.html) Netty 4.1：[通道池](http://netty.io/4.1/api/io/netty/channel/pool/ChannelPool.html)

# r - 使用 R 在大型数据集中计算单词的最快方法是什么？

> ID：14962880
> 
> 赞同：0
> 
> 时间：2013-02-19T16:46:43.483
> 
> 标签：r, mapreduce, bigdata

我有一个包含 700 万多条记录的 SQL 数据库，每条记录都包含一些文本。在我想要执行文本分析的每条记录中，说计算特定单词的出现次数。我已经`tokenize`在包中尝试了 R 的功能，该功能`openNLP`非常适用于小文件，但是 700 万条记录 * 每条记录 1-100 字之间变得太大，R 无法保存在`data.frame`. 我考虑过使用 R`bigmemory`或`ff`包，甚至`mapReduce`包。你们有这种分析的首选方法或包吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:12:32.873

也许并行处理它。我使用`parLapply`b/c 我相信它适用于所有三个操作系统。

```
wc <- function(x) length(unlist(strsplit(x, "\\s+")))

wordcols <- rep("I like icecream alot.", 100000)

library(parallel)
cl <- makeCluster(mc <- getOption("cl.cores", detectCores()))
clusterExport(cl=cl, varlist=c("wc", "wordcols"), envir=environment())
output <- parLapply(cl, wordcols, function(x) {
        wc(x)
    }
)
stopCluster(cl)  
sum(unlist(output)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T17:42:38.353

在 SQL 方面，您也可以为每个条目提取`len`，然后对其应用一个`replace(" yourWord ","")`（带有侧翼空格...），再次计算总字符串长度，然后取这两者之间的差异，这应该可以解决问题。我的 SQL 技能不太好，我可以在这里轻松地展示一个运行示例，对此感到抱歉......

# java - 本机共享库在 Android 中加载速度变慢

> ID：14962881
> 
> 赞同：4
> 
> 时间：2013-02-19T16:46:43.400
> 
> 标签：java, android-ndk, java-native-interface, shared-libraries

我在 libs/armeabi 文件夹中放置了一个共享库。它是使用加载的

```
System.loadLibrary("library_name.so"); 
```

库的大小约为 3MB。加载时间很长。它有时会持续近 20 秒。它阻止了我的 GUI。我试图放入`System.loadLibrary("library_name.so");`一个不同的线程，但我的 GUI 仍然被阻止。我知道其他应用程序使用更大的 .so 文件，但加载时间并没有那么大。可能是什么问题呢？

编辑

3MB 是调试版本的大小。发布版本大约是 800KB，但问题是一样的。一些附加信息：

*   .so 包含我的两个循环连接的 c++ 库
*   运行`arm-linux-androideabi-nm -D -C -g library_name.so`显示很多函数和变量
*   我不再`LOCAL_WHOLE_STATIC_LIBRARIES`使用
*   以下是通过使用获得的节标题表`arm-linux-androideabi-readelf-tool`：

> ```
> Section Headers:
>   [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
> 
>   [ 0]                   NULL            00000000 000000 000000 00      0   0  0
> 
>   [ 1] .dynsym           DYNSYM          00000114 000114 00b400 10   A  2   1  4
> 
>   [ 2] .dynstr           STRTAB          0000b514 00b514 015b0c 00   A  0   0  1
> 
>   [ 3] .hash             HASH            00021020 021020 004d1c 04   A  1   0  4
> 
>   [ 4] .rel.dyn          REL             00025d3c 025d3c 006e98 08   A  1   0  4
> 
>   [ 5] .rel.plt          REL             0002cbd4 02cbd4 000468 08   A  1   6  4
> 
>   [ 6] .plt              PROGBITS        0002d03c 02d03c 0006b0 00  AX  0   0  4
> 
>   [ 7] .text             PROGBITS        0002d6f0 02d6f0 08e6e0 00  AX  0   0  8
> 
>   [ 8] .ARM.extab        PROGBITS        000bbdd0 0bbdd0 00bad0 00   A  0   0  4
> 
>   [ 9] .ARM.exidx        ARM_EXIDX       000c78a0 0c78a0 005b80 08  AL  7   0  4
> 
>   [10] .rodata           PROGBITS        000cd420 0cd420 005cc0 00   A  0   0  4
> 
>   [11] .data.rel.ro.loca PROGBITS        000d46d8 0d36d8 0006e4 00  WA  0   0  4
> 
>   [12] .fini_array       FINI_ARRAY      000d4dbc 0d3dbc 000008 00  WA  0   0  4
> 
>   [13] .init_array       INIT_ARRAY      000d4dc4 0d3dc4 00009c 00  WA  0   0  4
> 
>   [14] .data.rel.ro      PROGBITS        000d4e60 0d3e60 00384c 00  WA  0   0  8
> 
>   [15] .dynamic          DYNAMIC         000d86ac 0d76ac 000100 08  WA  2   0  4
> 
>   [16] .got              PROGBITS        000d87ac 0d77ac 000854 00  WA  0   0  4
> 
>   [17] .data             PROGBITS        000d9000 0d8000 000648 00  WA  0   0  8
> 
>   [18] .bss              NOBITS          000d9648 0d8648 047271 00  WA  0   0  8
> 
>   [19] .comment          PROGBITS        00000000 0d8648 000026 01  MS  0   0  1
> 
>   [20] .note.gnu.gold-ve NOTE            00000000 0d8670 00001c 00      0   0  4
> 
>   [21] .ARM.attributes   ARM_ATTRIBUTES  00000000 0d868c 00002d 00      0   0  1
> 
>   [22] .shstrtab         STRTAB          00000000 0d86b9 0000d8 00      0   0  1 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T07:34:31.583

尝试减少共享库中导出函数的数量。您可以使用

```
arm-linux-androideabi-nm -D -C -g library_name.so 
```

并检查该列表是否不必要地长，并删除您不使用的列表（将它们声明为静态）。您可以查阅`nm`'s manual by`$man nm`并阅读有关如何使用和解释它的信息。

如果您需要使用大量函数，请使用[RegisterNatives()](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/design.html)来注册您的函数，而不是依赖名称修改和查找 - 这就是您为函数命名时所做的事情，例如`Java_your_path_YourClass_yourFunction`.

如果它有符号，您也可以尝试`strip`（arm-linux-androideabi-strip）您的库。

为避免阻塞 UI，您可以尝试在不同的线程中尽早加载共享库并等待它。

如果公开静态库不是我最终想要的，我不会使用 LOCAL_WHOLE_STATIC_LIBRARIES。

> > LOCAL_WHOLE_STATIC_LIBRARIES
> > 
> > *   这些是您想要包含在模块中的静态库，而不允许链接器从中删除死代码。
> > *   如果您想将静态库添加到共享库并让静态库的内容从共享库中公开，这将非常有用。

尝试解决该问题，而不是解决一些构建问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T08:55:56.730

问题是某些构造函数中的静态初始化需要很长时间才能完成

# yeoman - Yeoman 自定义生成器

> ID：14962885
> 
> 赞同：6
> 
> 时间：2013-02-19T16:47:16.053
> 
> 标签：yeoman

我想用最新版本的 yeoman 制作一个自定义生成器，但我遇到了一些困难。我一直在挖掘各种文档和示例资源（如 webapp 和角度生成器），但我仍有一些问题。

1.  测试生成器的工作流程是什么？如果我有一个生成器本身的项目，我是否会继续创建新目录来运行`yo my-generator`？

2.  生成器框架在 1.0 的 beta 版本中是否发生了变化`yo`？是否发生了重大变化？

3.  生成器如何将自己注册到全局`yo`二进制文件中？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-10T07:30:20.567

这个问题已经有几个月的历史了，但我认为现在发现它的任何人都知道在[http://yeoman.io/generators.html中已经解释了更多内容。](http://yeoman.io/generators.html)

问题一：

在本地测试您的发电机很容易。例如，如果您的生成器被称为“generator-mtv-raps”

```
$ cd ~/dev/generator-mtv-raps/
$ npm link 
```

现在，如果你这样做：

```
$ cd ~/dev/mytest/
$ yo mtv-raps 
```

它将建立。

此外，使用 mocha 对生成器进行单元测试非常简单。内置了一组测试助手。您需要测试的基础知识可以在 generator-webapp 的测试[https://github.com/yeoman/generator-webapp/blob/master/test/test 中找到。 js](https://github.com/yeoman/generator-webapp/blob/master/test/test.js)

1.  测试发电机可以在不损坏的情况下使用。
2.  模拟你的提示`helpers.mockPrompt`
3.  测试您要创建的所有文件是否通过`helpers.assertFiles`
4.  测试您模拟的提示值是否插入到创建的文件中。

数字 4 有点棘手，可以将预期文件的数组传递给正则表达式进行检查。如果您想了解更多关于测试助手的信息，源是最好的地方。[https://github.com/yeoman/generator/blob/master/lib/test/helpers.js](https://github.com/yeoman/generator/blob/master/lib/test/helpers.js)

问题 2：btford 已经回答

问题 3：

生成器`yo`通过全局安装（或如上所述链接它们）并使用命名约定来绑定。所有生成器都以“generator”开头，然后是“-”，然后是“name”。

因此`generator-mtv-raps`通过访问`$ yo mtv-raps`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-19T19:08:38.560

> 测试生成器的工作流程是什么？

我将在接下来的几天内为生成器角度工作。你可以[在 Github 上跟踪我的进度](https://github.com/yeoman/generator-angular/issues/5)。`yeoman`不幸的是，由于从一个命令到使用`yo`并列`bower`的过渡，还没有太多示例`yo`。我想会有一定程度的单元测试`Generator.prototype.method`，以及涉及编写 bash 脚本来运行`yo`、`npm`、`bower`和`grunt`.

> 在 yo 1.0 的 beta 版本中，生成器框架是否发生了变化？是否发生了重大变化？

根据我移植生成器角度的经验，我没有看到太多变化。有一个新的、可选的[简化 API](https://github.com/yeoman/generator/issues/152)，它可能很有用。

> 生成器如何将自己注册到全局`yo`二进制文件中？

现在的答案是没有。您在项目目录中安装/使用生成器。由于错误的符号链接，我不知何故让它工作了，但这不是推荐的方法。

# asp.net - 如何在融合图中使用链接图

> ID：14962888
> 
> 赞同：0
> 
> 时间：2013-02-19T16:47:21.317
> 
> 标签：asp.net, fusioncharts

我正在尝试使用融合图表中的弹出窗口来使用链接图表，但我似乎无法根据我在网上看到的使用弹出窗口的链接图表的一些示例来修改我的代码。我的代码当前打开一个新页面，但我宁愿使用弹出窗口。这是我在网上看到的示例，但无法翻译并修改我的代码：

```
<set label="2004" value= "37800" link="P-nameOfWindow, resizable=no-showChildChart.asp"/> 
```

这是我打开一个新页面的代码：

```
 while (reader.Read())
            {
                // Construct the chart data in XML format
               xmlStr.AppendFormat("<set label='{0}' value='{1}' link='{2}'/>", reader["cat_name"].ToString(), reader["Total"].ToString(), Server.UrlEncode("DrillDown1.aspx?AppName=" + reader["cat_name"].ToString()));

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T21:27:55.170

只需将 P- 放在文件名的前面，就可以了..

```
..Server.UrlEncode("P-DrillDown1.aspx?AppName="... 
```

# x86 - x86 找出指令的操作数大小仅给出十六进制机器代码？

> ID：14962890
> 
> 赞同：10
> 
> 时间：2013-02-19T16:47:21.790
> 
> 标签：x86, disassembly, instruction-encoding

例如，给定一个十六进制： `83 E4 F0`

通过查看英特尔开发人员手册，我可以弄清楚这`83`意味着. 看着，我可以解码源/目标寄存器是 SP 或 ESP。`and``FO``-16``E4`

因此，我可以得出结论，十六进制表示要么`and $-16, %ESP`要么`and $-16, %SP`。但是，在手册中，这两者都被列为`83 /4 ib`.

我怎样才能区分这两者？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T13:27:19.057

正如哈罗德所说，默认操作数大小未在指令中编码，但取决于当前处理器模式。

在实模式和 16 位保护模式下，默认操作数大小为 16 位，因此`83 E4 F0`解码为`and $-16, %sp`.

在 32 位模式下，操作数大小默认为 32 位，所以它是`and $-16, %esp`.

在 x64 模式下，大多数指令再次默认为 32 位操作数大小（分支和间接使用堆栈的指令除外，例如推送、弹出、调用和返回），因此它再次解码为`and $-16, %esp`.

可以使用前缀覆盖默认操作数大小。例如，前缀 66h 在 32 位和 16 位操作数大小之间切换，因此`66 83 E4 F0`解码为`and $-16, %esp`16 位模式和`and $-16, %sp`32 位或 64 位模式。要获得 64 位操作数大小，您需要使用设置了 W 位的[REX 前缀](http://www.sandpile.org/x86/opc_enc.htm)，因此`48 83 E4 F0`解码为`and $-16, %rsp`（但仅限于 64 位模式！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:54:55.013

在保护模式下，只能是 32 位版本，16 位和 64 位版本都需要前缀大小覆盖字节，在这种情况下，16 位版本需要 0x66 前缀覆盖，所以你得到`66:83 E4 F0`. 英特尔在 AND 的描述中明确说明了这一点：

> 在 64 位模式下，指令的默认操作大小为 32 位。

以及 066H 的参考，第 2.2.1 章：

> 操作数大小覆盖前缀允许程序在 16 位和 32 位操作数大小之间切换。任何一种尺寸都可以是默认值；使用前缀选择非默认大小。

# java - 在 Azure 中创建空 CloudBlockBlob

> ID：14962893
> 
> 赞同：1
> 
> 时间：2013-02-19T16:47:36.713
> 
> 标签：java, azure

我希望这个问题的答案很简单，但是在查看 Azure Java API 文档后我无法让它工作。

我正在尝试创建一个空的 CloudBlockBlob，稍后会将块上传到它。我之前已经成功上传了块，当在上传第一个块时创建 blob 时，但是当我尝试创建一个没有任何内容的新 blob 时，我似乎什么也得不到（“指定的 blob 不存在”）数据，然后访问它。我需要这个，因为在我的服务中，首先调用以在 Azure 中创建新的 blob，然后使用稍后的调用上传块（此时会检查 blob 是否存在）。是否可以在 Azure 中创建一个空 blob，然后将数据上传到它？我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T14:38:27.193

我没有使用过 Java SDK，所以我可能错了，但我尝试使用 C# 代码（存储客户端库 2.0）创建一个空 blob，如果我上传一个空输入流，则会创建一个零字节大小的空 blob。我做了类似以下的事情：

```
 CloudBlockBlob emptyBlob = blobContainer.GetBlockBlobReference("emptyblob.txt");
        using (MemoryStream ms = new MemoryStream())
        {
            emptyBlob.UploadFromStream(ms);//Empty memory stream. Will create an empty blob.
        } 
```

我确实在 Github 上查看了 Azure SDK for Java 源代码：[https ://github.com/WindowsAzure/azure-sdk-for-java/blob/master/microsoft-azure-api/src/main/java/com/ microsoft/windowsazure/services/blob/client/CloudBlockBlob.java](https://github.com/WindowsAzure/azure-sdk-for-java/blob/master/microsoft-azure-api/src/main/java/com/microsoft/windowsazure/services/blob/client/CloudBlockBlob.java)并找到了这个“上传”功能，您可以在其中指定输入流。试试看它是否适合你。

# qt - QT - 将自己的列添加到 QFileSystemModel

> ID：14962902
> 
> 赞同：2
> 
> 时间：2013-02-19T16:47:57.237
> 
> 标签：qt

我可以扩展 QFileSystemModel 并添加带有文本/图标的新列吗？

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T17:36:15.180

我将首先对模型进行子类化，提供附加列并向其提供数据。

所以至少我会在两种情况下重新实现 columnCount() 和 data() 调用基类并相应地操作结果。

```
class yourSystemModel : public QFileSystemModel
{
    Q_OBJECT

    int columnCount(const QModelIndex& parent = QModelIndex()) const
    {
        return QFileSystemModel::columnCount()+1;
    }

    QVariant data(const QModelIndex& index,int role) const
    {
       if(!index.isValid()){return QFileSystemModel::data(index,role);}
       if(index.column()==columnCount()-1)
       {
           switch(role)
           {
              case(Qt::DisplayRole):
                  {return QString("YourText");}
              case(Qt::TextAlignmentRole):
                  {return Qt::AlignHCenter}
              default:{}
           }
       }
       return QFileSystemModel::data(index,role);
   }
} 
```

官方文档概述了抽象项目模型的最小重新实现的一些基础，但在这种情况下，您可以用更少的东西逃跑。 [http://doc.qt.digia.com/stable/qabstractitemmodel.html](http://doc.qt.digia.com/stable/qabstractitemmodel.html) - 子类化部分。

# java - Java Robot() 屏幕捕获

> ID：14962905
> 
> 赞同：0
> 
> 时间：2013-02-19T16:48:06.057
> 
> 标签：java, minecraft, awtrobot

我正在尝试在 minecraft（绑定到 F2）中截取屏幕截图，将其转换为 base64，然后将其发送到我的网站，但我的屏幕截图都没有返回图像，但尺寸在那里，这是一个示例[http:// /minebook.co.uk/screenshot/48462846](http://minebook.co.uk/screenshot/48462846)

```
Rectangle screenRectangle = new Rectangle(width, height);
Robot robot = new Robot();
BufferedImage image = robot.createScreenCapture(screenRectangle);

ByteArrayOutputStream os = new ByteArrayOutputStream();
OutputStream b64 = new Base64.OutputStream(os);
if( ImageIO.write(image, "png", b64) ) {
    String base64String = os.toString("UTF-8");

    // Send screenshot Base 64 to website
    String postData = "account=" + ModLoader.getMinecraftInstance().thePlayer.username + "&screenshot=" + base64String;
    URL url = new URL("http://minebook.co.uk/ingame/screenshot");
    URLConnection conn = url.openConnection();
    conn.setDoOutput(true);
    OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());

    //write parameters
    writer.write(postData);
    writer.flush();

    // Get the response
    StringBuffer answer = new StringBuffer();
    BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
    String line;
    while ((line = reader.readLine()) != null) {
        answer.append(line);
    }
    writer.close();
    reader.close();
    ModLoader.getMinecraftInstance().thePlayer.sendChatToPlayer(answer.toString());
} 
```

任何帮助将不胜感激，如果您需要更多信息，请告诉我

文尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-21T06:53:10.640

**使用机器人类的**最佳屏幕捕获程序：

```
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Calendar;

import javax.imageio.ImageIO;

public class JavaScreenCaptureUtil {

    public static void main(String args[]) throws Exception {

        /**
         * This class (Robot.java) is used to generate native system input events for the
         * purposes of test automation, self-running demos, and other
         * applications where control of the mouse and keyboard is needed.
         * The primary purpose of Robot is to facilitate automated testing
         * of Java platform implementations.
         */
        Robot robot = new Robot();

        /**
         * Get the current screen dimensions.
         */
        Dimension d = new Dimension(Toolkit.getDefaultToolkit().getScreenSize());
        int width = (int) d.getWidth();
        int height = (int) d.getHeight();

        /**
         * Delay the robot for 5 seconds (5000 ms) allowing you to switch to proper
         * screen/window whose screenshot is to be taken.
         *
         * You can change the delay time as required.
         */
        robot.delay(5000);

        /**
         * Create a screen capture of the active window and then create a buffered image
         * to be saved to disk.
         */
        Image image = robot.createScreenCapture(new Rectangle(0, 0, width,
                height));

        BufferedImage bi = new BufferedImage(width, height,
                BufferedImage.TYPE_INT_RGB);
        Graphics g = bi.createGraphics();
        g.drawImage(image, 0, 0, width, height, null);

        /**
         * Filename where to save the file to.
         * I am appending formatted timestamp to the filename.
         */
        String fileNameToSaveTo = "ScreenCaptured_"
                + createTimeStampStr() + ".jpg";

        /**
         * Write the captured image to a file.
         * I am using PNG format. You can choose PNG, JPG, GIF.
         */
        writeImage(bi, fileNameToSaveTo, "PNG");

        System.out.println("Screen Captured Successfully and Saved to :\n In Your Folder with Name :- "+fileNameToSaveTo);

    }

    /**
     * This method writes a buffered image to a file
     *
     * @param img -- > BufferedImage
     * @param fileLocation --> e.g. "C:/testImage.jpg"
     * @param extension --> e.g. "jpg","gif","png"
     */
    public static void writeImage(BufferedImage img, String fileLocation,
            String extension) {
        try {
            BufferedImage bi = img;
            File outputfile = new File(fileLocation);
            ImageIO.write(bi, extension, outputfile);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     *
     * @return String representation of timestamp
     * in the format of yyyyMMdd_hhmmss (e.g. 20100426_111612)
     * @throws Exception
     */
    public static String createTimeStampStr() throws Exception {
        Calendar mycalendar = Calendar.getInstance();
        SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd_hhmmss");
        String timeStamp = formatter.format(mycalendar.getTime());

        return timeStamp;

    } 
} 
```

希望这篇文章对您有所帮助：

谢谢...

# qt - 修复 qml 项目行为

> ID：14962908
> 
> 赞同：0
> 
> 时间：2013-02-19T16:48:33.727
> 
> 标签：qt, qml, qt5

我有关于 qml 的代码，它应该通过点击将它分成 4 个正方形。

```
import QtQuick 2.0

Rectangle {
    Component {
        id: squareComponent
        Rectangle {
            property int sideLenght: 500
            width: sideLenght
            height: sideLenght
            color: "orange"
            MouseArea {
                anchors.fill: parent
                onClicked: {
                    var first = squareComponent.createObject(parent)
                    var second = squareComponent.createObject(parent)
                    var third = squareComponent.createObject(parent)
                    var fourth = squareComponent.createObject(parent)

                    var sideLenght = parent.sideLenght / 2

                    first.sideLenght = sideLenght
                    second.sideLenght = sideLenght
                    third.sideLenght = sideLenght
                    fourth.sideLenght = sideLenght

                    var x = parent.x
                    var y = parent.y
                    console.log(x, y)

                    first.x = x
                    first.y = y
                    first.color = "red"
                    console.log("first", first.x, first.y)

                    second.x = first.x + sideLenght
                    second.y = first.y
                    second.color = "orange"
                    console.log("second", second.x, second.y)

                    third.x = first.x
                    third.y = first.y + sideLenght
                    third.color = "blue"
                    console.log("third", third.x, third.y)

                    fourth.x = first.x + sideLenght
                    fourth.y = first.y + sideLenght
                    fourth.color = "black"
                    console.log("fourth", fourth.x, fourth.y, "\n\n")

                    parent.sideLenght = 0
                }
            }
        }
    }

    Component.onCompleted: squareComponent.createObject(parent)
} 
```

它们被划分，但只划分正确的平方 (0, 0)，其他的则与 x 或 y 的偏移量为父项的数量。Qt 5.0.1。我该如何解决这种行为，这是一个错误吗？

记录表明这些元素是正确的，但实际上并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:20:39.817

这就是我得到的输出`QtQuick 1.1`。这在 Qt 5.0.1 中有什么不同吗？

![输出](../Images/32994aef3b895b3a254054e2c604aff5.png)

# android - 如何在android sqlite数据库中具有少量列详细信息的行的列表视图中显示计数

> ID：14962910
> 
> 赞同：0
> 
> 时间：2013-02-19T16:48:41.170
> 
> 标签：android, sqlite

以下是我尝试获取应用程序名称 (KEY_NAME)、application_category (KEY_CATEGORY) 和 application_permissions(KEY_PERM) 详细信息的代码

**但我真正想要的是使用应用程序名称和类别来显示权限数量（计数）**我该怎么做我在列表视图中显示它

处理程序

```
public Cursor queueAll() {
        String[] columns = new String[] { KEY_ID, KEY_NAME, KEY_CATEGORY,
                "count" + KEY_PERM };
        Cursor cursor = sqlitedb.query(MYDATABASE_TABLE, columns, null, null,
                KEY_NAME, null, null);
        return cursor;
    } 
```

主要活动

```
mySQLiteAdapter = new Handle(this);
        mySQLiteAdapter.openToWrite();
        cursor = mySQLiteAdapter.queueAll();
        String[] from = new String[] { Handle.KEY_NAME, Handle.KEY_PERM,
                Handle.KEY_CATEGORY };
        int[] to = new int[] { R.id.appname, R.id.numbpermcount, R.id.category };
        cursorAdapter = new SimpleCursorAdapter(this,
                R.layout.activity_main_row, cursor, from, to);
        listContent.setAdapter(cursorAdapter); 
```

先感谢您。

我试着再这样做一次。

处理程序

```
public static final String KEY_ID = "_id";
public static final String KEY_NAME = "application_name";
public static final String KEY_PACK = "application_package";
public static final String KEY_PERM = "application_permission";
public static final String KEY_LEVEL = "application_level";
public static final String KEY_CATEGORY = "application_category";

public Cursor queueAll() {
        String[] columns = new String[] { KEY_ID, KEY_NAME, KEY_CATEGORY,
                "count(" + KEY_PERM +")" };
        Cursor cursor = sqlitedb.query(MYDATABASE_TABLE, columns, null, null,
                KEY_NAME, null, null);
        return cursor;
    } 
```

主要活动

和上面一样。。。

错误

```
02-19 22:51:04.049: E/AndroidRuntime(1192): java.lang.RuntimeException: Unable to start activity ComponentInfo{db.database/db.database.MainActivity}: java.lang.IllegalArgumentException: column 'application_permission' does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:47:47.050

我认为你想要做的有点超出内置`query`方法所能做的。相反，您需要`rawquery`，您可以向其传递任意 SQL。听起来你需要

```
public static final String KEY_ID = "_id";
public static final String KEY_NAME = "application_name";
public static final String KEY_PACK = "application_package";
public static final String KEY_PERM = "application_permission";
public static final String KEY_LEVEL = "application_level";
public static final String KEY_CATEGORY = "application_category";

public static final String KEY_PERM_COUNT = "application_permission_COUNT";

public Cursor queueAll() {
    Cursor cursor = sqlitedb.rawquery(
        "SELECT "+KEY_ID+", "+KEY_NAME+", "+KEY_CATEGORY
        +", count("+KEY_PERM+") AS "+KEY_PERM_COUNT
        +" FROM "+MYDATABASE_TABLE
        +" GROUP BY "+KEY_ID+", "+KEY_NAME+", "+KEY_CATEGORY
    );
    return cursor;
} 
```

然后将您的适配器设置为也读取`Handle.KEY_PERM_COUNT`.

# sql - 如何将外键链接到 Oracle 中的自动递增主键？

> ID：14962911
> 
> 赞同：1
> 
> 时间：2013-02-19T16:48:44.370
> 
> 标签：sql, oracle, auto-increment

我有两个表，它们的公共字段是 Load_ID。第一个的PK与第二个的FK是一对多的关系。例如：

```
Table1:
1, someValue

Table2:
1, value1, ...  
1, value2, ... 
1, value3, ... 
```

我已经在一个 ASP.NET 类中嵌入了实际的插入语句，其中的值取自用户输入：

```
 "INSERT INTO Compare_Header_Table VALUES
(compare_sequence.nextval, //other values are inserted here) 
```

我用来自动增加 P​​K 的序列是`CREATE SEQUENCE compare_sequence;` 即使没有创建触发器或指定任何参数，这似乎也可以工作，因为序列默认为增量 1 和初始值 1，这对我的目的来说很好。

**我遇到问题的地方是尝试将 FK 从第二个表链接到第一个表的 PK。**我不能简单地使用`compare_sequence.currval`，因为我有一个单独的方法来插入每个表，所以我每次都创建一个新连接。我不想将这些组合成一种方法，因为这将涉及更改我的 C# 类的逻辑结构，我宁愿保持原样。

关于如何完成这项工作的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:57:55.733

您可以做的是使用 RETURNING 原因来获取分配的值：

```
 INSERT INTO Compare_Header_Table (ID) VALUES
        (compare_sequence.nextval)
 returning id into some_value; 
```

这`some_value`是一个局部变量，您需要将其从第一堂课传递到第二堂课。你这样做的精确程度取决于你的架构。

顺便说一句，我确实希望当您说“我每次都在创建一个新连接”时，这是一些 c# 行话，并且您并不是每次都真正创建一个新的数据库连接。因为那是一项相当昂贵的手术。

另一件事是，如果您在不同的会话中创建父记录和子记录，那么事务会发生什么？您必须提交每个插入（否则，当您尝试插入子项时，外键验证将看不到新的父记录）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:56:03.523

如果您希望`INSERT`在单独的会话中完成操作，则需要从第一条语句中检索生成的密钥并将其传递给将数据插入到`table2`. 在不需要数据库往返的情况下检索生成的密钥的一种方法是执行类似的操作

```
INSERT INTO compare_header_table
  VALUES( compare_sequence.nextval,
          ... )
 RETURNING name_of_primary_key_column
      INTO :bind_variable 
```

# excel - 从多个电子表格复制的宏

> ID：14962914
> 
> 赞同：-1
> 
> 时间：2013-02-19T16:49:05.770
> 
> 标签：excel, vba

我正在寻找一些从文件夹中提取文件并将其中的数据粘贴到目标电子表格中的代码。

我有一个文件夹，其中包含所有格式相同的报告，报告每周生成并每周保存到一个新文件夹中，因此我并不总是从同一个文件夹中挑选文件。我想要一个提供“浏览文件夹”对话框的宏，然后当我选择文件夹时，它会依次打开该文件夹中的每个 Excel 文件，复制数据（范围 A：W），将其粘贴回目标电子表格，关闭电子表格，然后移至文件夹中的下一个文件。

在报告中，标题下的行数并不总是相同，可能只有 1 行或 2 行以上，所以我还需要使用代码检查每行中是否存在数据，如果只有 1 行将复制该行，如果超过 1 它将全部复制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:56:25.807

您可以使用类似这样的方法来循环浏览所选文件夹中的文件夹：

```
Dim sPath As String
Dim sFil As String
Dim FolderPath As String
   Dim diaFolder As FileDialog

   ' Open the file dialog
   Set diaFolder = Application.FileDialog(msoFileDialogFolderPicker)
    diaFolder.AllowMultiSelect = False
    diaFolder.Show
    FolderPath = diaFolder.SelectedItems(1)

     ' Cycle through spreadsheets in selected folder

sPath = FolderPath & "\" 'location of files

sFil = Dir(sPath & "*.csv") 'change or add formats
Do While sFil <> "" 'will start LOOP until all files in folder sPath have been looped       through

Set oWbk = Workbooks.Open(sPath & "\" & sFil) 'opens the file
' do something

oWbk.Close True
sFil = Dir

Loop 
```

然后你可以把你的代码复制到它说的地方`'do something`

# c# - 启用静态合同检查器以证明基于其他属性的属性非空

> ID：14962920
> 
> 赞同：1
> 
> 时间：2013-02-19T16:49:25.437
> 
> 标签：c#, code-contracts

假设以下代码：

```
public class CC3
{
    private string _field;
    private bool _someFlag;

    public string Property
    {
        get { return _field; }
    }

    public bool SomeFlag
    {
        get { return _someFlag; }
    }

    public void SetField()
    {
        _field = " foo ";
        _someFlag = true;
    }

    public string Method()
    {
        Contract.Requires(SomeFlag);
        return Property.Trim();
    }
} 
```

Code Contracts 的静态检查器抱怨以下`return`声明`Method`：

> 可能在空引用“this.Property”上调用方法

我必须做什么才能使静态检查器证明`Property`永远不可能`null`if `SomeFlag`is `true`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T18:30:59.923

证明它不为空的唯一方法是证明它不为空。理想情况下，如果要转换为自动属性，则可以使用不变量。对于此示例，您可以重写属性以确保 null 不是可能的结果：

```
public string Property
{
    get {
        Contract.Ensures(Contract.Result<string>() != null);
        return _field ?? String.Empty;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:00:12.727

您可以使用以下方法为静态分析提供帮助`Contract.Assume`：

```
public string Method()
{
    Contract.Requires(SomeFlag);
    Contract.Assume(Property != null);
    return Property.Trim();
} 
```

或者实际上将支票添加为`Contract.Requires`自己的权利。毕竟，仅仅因为你现在可以手动证明它是正确的，你不能保证当代码被修改时总是这样。事实上，考虑一下是否`SomeFlag`真的是一个要求。也许这是一个更清洁的解决方案：

```
public string Method()
{
    Contract.Requires(Property != null);
    return Property.Trim();
} 
```

# ruby-on-rails - 如何在 ActiveRecord 中分离持久性？

> ID：14962921
> 
> 赞同：2
> 
> 时间：2013-02-19T16:49:25.287
> 
> 标签：ruby-on-rails, persistence, abstraction, rails-activerecord

我目前正在用 Ruby（不是 Rails）构建一个应用程序，它使用 ActiveRecord 作为 ORM 和 sqlite 作为数据库。

一个示例代码，只是为了澄清我的问题：

```
class User < ActiveRecord::Base
  has_many :logins, :foreign_key => :user_id
  has_many :categories, :foreign_key => :user_id
  has_many :news, :foreign_key => :user_id
  has_many :settings, :foreign_key => :user_id

  class << self
    def get_user_by_id(id)
      find(id)
    end

    def insert(username, password)
      create(:username => username, :password => password)
    end
  end
end 
```

代码（关系、模型等）现在一点也不复杂。但是，当我的模型开始变大时，我不想在同一个类中混合业务逻辑和持久性逻辑。我希望能够更改我的持久性方法（文件、内存中、其他数据库结构）。有没有既定的方法来解决这个问题？我读到在 Rails 中，“瘦控制器，胖模型”很常见，但我正在寻找解决这个问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:01:31.360

不幸的是，ActiveRecord 模式可能不是适合您的情况的最佳解决方案。[Active Record 模式的定义](http://martinfowler.com/eaaCatalog/activeRecord.html)说：

> 一个对象同时携带数据和行为。这些数据大部分是持久的，需要存储在数据库中。Active Record 使用最明显的方法，将数据访问逻辑放在域对象中。这样，所有人都知道如何在数据库中读取和写入数据。

也许您可能想研究 Data Mapper 模式（和[Data Mapper ORM](http://datamapper.org/)），它是专门为分离业务逻辑和持久性而设计的。

也就是说，如果你真的必须使用 ActiveRecord，我会加入一些组合，比如：

```
class UserRepository < ActiveRecord::Base
  # all the persistence stuff goes in here
end

class User
  def initialize(login, repository=UserRepository)
    @repository = repository
    @user = @repository.find_by_login(login)
  end

  def instanography
    #complicated business logic
  end

  def method_missing(m, *args, &block)
    @user.send(m, *args, &block)
  end
end 
```

如上面的示例所示，我会让 User 对象充当真实活动记录对象的代理，保留所有业务逻辑并隐藏持久性内容。

# javascript - jQuery 点击事件在页面上不起作用，但它们在 jsFiddle 上起作用

> ID：14962922
> 
> 赞同：2
> 
> 时间：2013-02-19T16:49:28.707
> 
> 标签：javascript, jquery, html, css

我检查了js标签很好，一切都关闭了，但是js突然决定不工作。我有在[JSFiddle](http://jsfiddle.net/PRVm8/110/)中工作的代码，所以我知道它必须是我所做的，或者可能是服务器。我只需要一些外部影响来确保它不是疏忽。

这是有问题[的网站](http://reinhardtcreative.com/clients/dev/gcn/testing.php)。这是代码：

```
$(document).ready(function(){
    $(".designers").show();
    $('.list').hide();
});

$(".but").click(function(){
    $(".designers").hide();
    $(".list").show("slide", { direction: "down" }, 1000);
});

$(".but2").click(function(){
    $(".designers").show();
    $(".list").hide("slide", { direction: "down" }, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T16:50:58.453

事件处理程序也应该进入 ready 函数：

```
$(document).ready(function(){
    $(".designers").show();
    $('.list').hide();

    $(".but").click(function(){
        $(".designers").hide();
        $(".list").show("slide", { direction: "down" }, 1000);
    });

    $(".but2").click(function(){
        $(".designers").show();
        $(".list").hide("slide", { direction: "down" }, 1000);
    });
}); 
```

JsFiddle 会自动将所有内容粘贴到准备好的文档中，这就是为什么它可以在那里而不是在您的网站上工作，因为您试图在将元素添加到 DOM 之前获取它们。

# asp.net-mvc - ClientTemplate 中的 Kendo UI 条件按钮

> ID：14962925
> 
> 赞同：1
> 
> 时间：2013-02-19T16:49:30.107
> 
> 标签：asp.net-mvc, kendo-ui

我正在尝试让条件客户端模板在 Kendo Grid 中工作，该模板将使用简单的 userName 字符串作为参数调用我的控制器，但我无法弄清楚使其正常工作的语法。

我的模板在我看来是这样的：

```
 columns.Bound(user => user.IsLockedOut).ClientTemplate(
                "# if (IsLockedOut == true) { #" +

                    "<input type='button' value='Unlock Acc' onclick='location.href=" + @Url.Action("UnlockAccount", "Administration", new { userName = "#= UserName #" + }) + "/>" +

                "# } else { #" +
                    "Unlocked" +
                "# } #"
            ); 
```

控制器的动作方法如下：

```
 public void UnlockAccount(string userName)
    {
    } 
```

目前产生的错误是：

CS1525：无效的表达式术语“}”

我已经看了几个小时了，现在我看不到树木的树林。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:40:56.457

您有一些实际上不需要的“+”加号。此外，您不需要在助手前面的“at”符号@。

```
 new { userName = "#= UserName #" + }) //<- that last plus 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T22:05:01.990

这种方法对我有用。

```
const string ShowUpdateButton = "#if (IsNetReversal == false) {#<a class='k-button k-button-icontext k-grid-edit' href='\\#'><span class='k-icon k-edit'></span>Update</a>#}#";
const string ShowReverseButton = "#if (IsNetReversal == false) {#<a class='k-button k-button-icontext k-grid-reverse' href='/JournalDetail/Reverse/#: ID #'  ><span class='k-icon k-reverse'></span>Reverse</a>#}#";
const string ShowDeleteButton = "#if (IsAdjustment == true) {#<a class='k-button k-button-icontext k-grid-delete' href='\\#'><span class='k-icon k-delete'></span>Delete</a>#}#"; 
```

您可以内联模板，但如果您声明常量然后使用 string.format 连接它们，我发现它更容易（特别是对于多个按钮）。

```
col.Template(o => o).ClientTemplate(string.Format("{0}{1}{2}", ShowUpdateButton, ShowDeleteButton, ShowReverseButton)); 
```

好处是它将与弹出编辑器一起使用，而当用户取消编辑时，jquery hacks 将忽略条件状态。弹出编辑器中的取消将从视图模型或 Kendo 存储它的任何位置恢复网格行，这会导致任何 jquery/javascript hack 之前的按钮状态。上面的方法也将自动连接标准命令，因为我为客户端模板复制了它们的 HTML 输出。

不利的一面是，如果 Kendo 更改命令按钮的模式，客户端模板可能会失败。我厌倦了除此之外的其他几种方法，这种方法的缺点似乎比其他方法更好。

关于剑道论坛的注意事项：截至本文发布之日，他们似乎不允许不支付支持费用的人在论坛上发帖，所以我建议在这里发布问题。他们监控 Stack Overflow，根据我的经验，他们似乎在这里更快地回答问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T10:34:30.397

我需要更进一步，但只能通过手动编写这样的 URL：

```
"<input type='button' value='Unlock Acc' onclick='location.href=/Administration/TryUnlockAccount?userName=#= UserName #'/>" 
```

虽然仍然没有调用我的控制器方法，但它确实具有正确的参数值......

# java - 在 RCP 插件中显示类的变量/方法

> ID：14962928
> 
> 赞同：0
> 
> 时间：2013-02-19T16:49:37.240
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, rcp

我正在开发一个 Eclipse RCP 插件，其中一个功能是显示某些类中的所有变量和方法以供用户查看。

目前，我已经使用遍历文件结构的 File Walker 实现了这一点，当它找到一个 .class 文件时，它使用 ClassLoader API 加载该类，因此我可以反映该类以获取声明的字段和方法等，然后显示它们。

但是，我想知道是否可以使用内置的 Eclipse Outline 视图作为插件的一部分？我的意思是它是一个可以在我的插件中实例化和定位的元素吗？

另外，我将在某个时候向我的插件添加一个小的 Java 编辑区域，因此与其自己创建一个，是否可以再次创建 Elcipse 编辑区域的实例并将其放在我的应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:56:36.650

与其重新创建 Eclipse Java 编辑器，不如直接用您感兴趣的 Java 类打开一个编辑器视图？

这类似于 Eclipse 对您正在使用的类文件的源代码所做的操作。

```
IFile fileToBeOpened = ...;
IEditorInput editorInput = new FileEditorInput(fileToBeOpened);
IWorkbenchWindow window=PlatformUI.getWorkbench().getActiveWorkbenchWindow();
IWorkbenchPage page = window.getActivePage();
page.openEditor(editorInput, "org.eclipse.jdt.internal.ui.javaeditor"; 
```

# python - 是否有与 HighLine 等效的 Python？

> ID：14962930
> 
> 赞同：7
> 
> 时间：2013-02-19T16:49:44.057
> 
> 标签：python, ruby, console, highline

[HighLine](http://highline.rubyforge.org)是一个用于简化控制台输入和输出的 Ruby 库。它提供了允许您请求输入并对其进行验证的方法。在 Python 中是否有提供与它类似的功能的东西？

要显示 HighLine 的作用，请参见以下示例：

```
require 'highline/import'

input = ask("Yes or no? ") do |q|
  q.responses[:not_valid] = "Answer y or n for yes or no"
  q.default = 'y'
  q.validate = /\A[yn]\Z/i
end 
```

它会询问“是或否？”并让用户输入一些内容。只要用户不输入 y 或 n（不区分大小写），它就会打印“Answer y or n for yes or no”并让用户再次输入答案。此外，如果用户按 Enter，则默认为 y。最后，完成后，输入存储在`input`. 这是用户首先输入“EH???”的示例结果 然后是“y”：

```
是还是不是？|是| 诶？？？
回答 y 或 n 表示是或否
? 是的

```

在 Python 中是否有类似的简单方法可以做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T17:40:14.283

以下内容对您来说*应该*是类似的，尽管它与 Ruby 中的询问方式并不完全相同。

```
class ValidInput(object):
    def __init__(self,prompt,default="",regex_validate="",
             invalid_response="",correct_response=""):
        self.prompt=prompt
        self.default=default
        self.regex_validate=regex_validate
        self.invalid_response=invalid_response
        self.correct_response=correct_response
    def ask(self):
        fin=""
        while True:
            v_in=raw_input(self.prompt)
            if re.match(v_in,self.regex_validate):
                fin=v_in
                print self.correct_response
                break
            else:
                print self.invalid_response
                if self.default=="break":
                      break
                continue
        return fin 
```

你会像这样使用它：

```
my_input=ValidInput("My prompt (Y/N): ",regex_validate="your regex matching string here",
                    invalid_response="The response to be printed when it does not match the regex",
                    correct_response="The response to be printed when it is matched to the regex.")

my_input.ask() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T10:08:47.970

您可以使用 Python 3 模块[**cliask**](https://github.com/Sleft/cliask)。该模块的灵感来自[IT Ninja 的回答](https://stackoverflow.com/a/14963929/789593)，修复[了其中的一些缺陷，](https://stackoverflow.com/questions/14962930/is-there-a-python-equivalent-to-highline#comment21030520_14963929)并允许通过正则表达式、谓词、元组或列表进行验证。

获取模块的最简单方法是通过[pip](https://pypi.python.org/pypi/pip)安装它（有关其他安装方式，请参阅[自述文件](https://github.com/Sleft/cliask/blob/master/README.org)）：

```
sudo pip install cliask 
```

然后，您可以通过像以下示例中那样导入来使用该模块：

```
import cliask

yn = cliask.agree('Yes or no? ',
                  default='y')
animal = cliask.ask('Cow or cat? ',
                    validator=('cow', 'cat'),
                    invalid_response='You must say cow or cat')

print(yn)
print(animal) 
```

以下是运行示例时会话的外观：

```
是还是不是？|是| 诶？？？
请输入“是”或“否”
是还是不是？|是| 是的
牛还是猫？兔子
你必须说牛或猫
牛还是猫？猫
真的
猫

```

# python - 用另一个列表的内容替换列表项

> ID：14962931
> 
> 赞同：2
> 
> 时间：2013-02-19T16:49:45.287
> 
> 标签：python, list-comprehension

与[此问题](https://stackoverflow.com/questions/2582138/finding-and-replacing-elements-in-a-list-python)类似，但不是用另一个项目替换一个项目，而是我想用列表的内容替换任何一个项目的出现。

```
orig = [ 'a', 'b', 'c', 'd', 'c' ]
repl = [ 'x', 'y', 'z' ]
desired = [ 'a', 'b', 'x', 'y', 'z', 'd', 'x', 'y', 'z' ]

# these are all incorrect, or fail to compile
[ repl if x == 'c' else x for x in orig ]
[ [a for a in orig] if x == 'c' else x for x in orig ]
[ (a for a in orig) if x == 'c' else x for x in orig ]
[ a for a in orig if x == 'c' else x for x in orig ] 
```

编辑：明确表示我的意思是替换*所有*出现的项目，而不仅仅是第一个。（向没有在回答中涵盖该案例的任何人道歉。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T16:51:10.270

```
>>> orig = [ 'a', 'b', 'c', 'd' ]
>>> repl = [ 'x', 'y', 'z' ]
>>> desired = list(orig)  #can skip this and just use `orig` if you don't mind modifying it (and it is a list already)
>>> desired[2:3] = repl
>>> desired
['a', 'b', 'x', 'y', 'z', 'd'] 
```

当然，如果您不知道它`'c'`位于索引 2，您可以使用它`orig.index('c')`来查找该信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T16:59:43.503

不同的方法：当我做替换时，我更喜欢用字典来思考。所以我会做类似的事情

```
>>> orig = [ 'a', 'b', 'c', 'd' ]
>>> rep = {'c': ['x', 'y', 'z']}
>>> [i for c in orig for i in rep.get(c, [c])]
['a', 'b', 'x', 'y', 'z', 'd'] 
```

最后一行是标准的扁平化习语。

这种方法的一个优点（缺点？）是它可以处理多次出现的`'c'`.

[更新：]

或者，如果您愿意：

```
>>> from itertools import chain
>>> list(chain.from_iterable(rep.get(c, [c]) for c in orig))
['a', 'b', 'x', 'y', 'z', 'd'] 
```

关于修改后的测试用例：

```
>>> orig = [ 'a', 'b', 'c', 'd', 'c' ]
>>> rep = {'c': ['x', 'y', 'z']}
>>> list(chain.from_iterable(rep.get(c, [c]) for c in orig))
['a', 'b', 'x', 'y', 'z', 'd', 'x', 'y', 'z'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T16:52:52.850

不需要任何花哨的东西：

```
desired = orig[:2] + repl + orig[3:] 
```

要找到`2`您可以搜索`orig.index('c')`.

```
x = orig.index('c')
desired = orig[:x] + repl + orig[x+1:] 
```

如果 repl 不是列表，只需使用`list(repl)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T17:23:26.743

如果您向后枚举，您可以随时扩展列表，因为您移动的项目已经通过了枚举。

```
>>> orig = [ 'a', 'b', 'c', 'd', 'c' ]
>>> repl = [ 'x', 'y', 'z' ]
>>> desired = [ 'a', 'b', 'x', 'y', 'z', 'd', 'x', 'y', 'z' ]
>>> for i in xrange(len(orig)-1, -1, -1):
...     if orig[i] == 'c':
...             orig[i:i+1] = repl
... 
>>> orig
['a', 'b', 'x', 'y', 'z', 'd', 'x', 'y', 'z'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T18:25:32.053

还有一种方式：

```
>>> import operator
>>> orig = [ 'a', 'b', 'c', 'd', 'c' ]
>>> repl = [ 'x', 'y', 'z' ]
>>> output = [repl if x == 'c' else [x] for x in orig]
>>> reduce(operator.add, output)
['a', 'b', 'x', 'y', 'z', 'd', 'x', 'y', 'z']
>>> 
```

# google-apps-script - 在发送到 Google Apps 脚本仪表板之前使用 QUERY URL 对数据进行分组

> ID：14962933
> 
> 赞同：1
> 
> 时间：2013-02-19T16:49:53.820
> 
> 标签：google-apps-script, google-sheets

我有一个 Google 电子表格，其中包含一个键“ABCKEY”，并且希望在使用 Google Apps 脚本仪表板中的数据之前对数据执行 QUERY (SQL) 函数。

```
var ss = SpreadsheetApp.openById('ABCKEY');
var mydata = ss.getDataRange(); 
```

[本文](https://support.google.com/drive/bin/answer.py?hl=en&answer=1388882)解释了如何使用电子表格中数据的 QUERY 功能来生成分组数据。

以下查询生成了我想用作我的 Google Apps 脚本仪表板数据源的正确分组数据：

```
https://spreadsheets.google.com/a/mybusinessappdomain.com/tq?key=ABCKEY&tq=select%20A%2CC%2Csum(F)%2Csum(G)%20group%20by%20A%2C%20C 
```

因此，我基本上想填充`mydata`用上面 SQL 查询的结果填充上面的变量，这会产生一个 JSON 输出字符串。

如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T03:44:50.717

我提出的方法是这样的：

1.  用于`UrlFetchApp.fetch()`将查询 uri 的结果放入脚本中的变量中。查询 URI 返回 javascript 以设置 google 可视化服务的结果。
2.  删除结果中的任何无关内容，只留下查询结果的 JSON 表示。一个简单的正则表达式提取可以做到这一点，然后我们可以将提取的字符串解析为 JSON 对象。
3.  将 JSON 对象解码为二维数组，`mydata`. 这需要了解表在可视化查询中如何表示为 JSON 对象。

JSON 查询结果的结构如下：

```
{
  "version": "0.6",
  "status": "ok",
  "sig": "862651648",
  "table": {
    "cols": [
      {
        "id": "A",
        "label": "",
        "type": "string",
        "pattern": ""
      },
      {
        "id": "D",
        "label": "Population Density",
        "type": "number",
        "pattern": "#0.###############"
      }
    ],
    "rows": [
      {
        "c": [
          {
            "v": "Indonesia"
          },
          {
            "v": 117,
            "f": "117"
          }
        ]
      },
      {
        "c": [
          {
            "v": "China"
          },
          {
            "v": 137,
            "f": "137"
          }
        ]
      },
      {
        "c": [
          {
            "v": "Nigeria"
          },
          {
            "v": 142,
            "f": "142"
          }
        ]
      },
      {
        "c": [
          {
            "v": "Pakistan"
          },
          {
            "v": 198,
            "f": "198"
          }
        ]
      },
      {
        "c": [
          {
            "v": "India"
          },
          {
            "v": 336,
            "f": "336"
          }
        ]
      },
      {
        "c": [
          {
            "v": "Japan"
          },
          {
            "v": 339,
            "f": "339"
          }
        ]
      },
      {
        "c": [
          {
            "v": "Bangladesh"
          },
          {
            "v": 1045,
            "f": "1045"
          }
        ]
      }
    ]
  }
} 
```

您会注意到该`table`对象由一组对象组成，这些`cols`对象描述了表中的列。对于您的数组，您感兴趣的部分是`label`列。

之后，该`table`对象包含一个`rows`对象数组，每个对象都有一个对象数组，其中包含`c`行中每一列的数据。对于您的数组，它`v`是您感兴趣的 or 值。（`f`包含相同数据的格式化版本）

因此，我们的解析器将首先遍历列标题，然后遍历表的每一行，将`push`感兴趣的值放入二维数组中`mydata`。

对于此示例，我正在访问[查询语言参考](https://developers.google.com/chart/interactive/docs/querylanguage#Setting_the_Query_from_JavaScript)中提供的[交互式代码示例](https://code.google.com/apis/ajax/playground/?type=visualization#using_the_query_language)中使用的公共电子表格，并且还使用了他们的示例查询。我已经编写了示例，因此可以轻松修改它以使用您自己的查询访问您自己的电子表格。这是代码：

```
 // Specify the spreadsheet key and the query to be retrieved
  var ssKey = 'pCQbetd-CptGXxxQIG7VFIQ';
  var query = encodeURIComponent('SELECT A,D WHERE D > 100 ORDER BY D');

  // Build url to peform query
  var url = 'http://spreadsheets.google.com/tq?key=%KEY%&tq=%QUERY%'
          .replace('%KEY%',ssKey)
          .replace('%QUERY%',query);

  // Use UrlFetchApp to get the results of the query as a string.
  var response = UrlFetchApp.fetch(url);
  var content = response.getContentText();
  //Logger.log(content);

  // Extract the JSON object from the response. Note that the response contains
  // multiple lines of Javascript, and that it's the second line that has our
  // data table in it.
  var regex = /.*google.visualization.Query.setResponse\((.*)\)/g
  var jsonContent = regex.exec(content)[1];
  Logger.log(jsonContent);
  var objectContent = Utilities.jsonParse(jsonContent);

  var numCols = objectContent.table.cols.length;
  var numRows = objectContent.table.rows.length;

  // Decode objectContent into a two-dimensional array.
  var mydata = []
  // Start with the header row.
  mydata[0] = [];
  for (var col = 0; col < numCols; col++ ) {
    mydata[0].push(objectContent.table.cols[col].label);
  }
  // Then data rows
  for (var row = 0; row < numRows; row++) {
    mydata[row+1] = [];
    for (var col = 0; col < numCols; col++ ) {
      mydata[row+1].push(objectContent.table.rows[row].c[col].v);
    }
  }

  // Done - mydata is now a two-dimensional array with the results of the query
  debugger;  // If debugging, pause to examine results 
```

根据您计划在仪表板中使用数据的`table`目的，您可能只想在调用`jsonParse()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T07:07:56.517

我认为 json 解析器不适`var objectContent = Utilities.jsonParse(jsonContent)`用于那些将日期作为单元格值之一的可视化查询响应，例如下面的示例

```
{
    "v": newDate(2013,
    11,
    31),
    "f": "31-Dec-2013",
    "p": {
        "style": "color: rgb(0, 0, 0);font-family:Dialog;"
    }
} 
```

# ruby-on-rails - 为什么 Rails 在使用 yield 时会重复资产？

> ID：14962938
> 
> 赞同：0
> 
> 时间：2013-02-19T16:50:09.067
> 
> 标签：ruby-on-rails, asset-pipeline, sprockets

我已经阅读并尝试了这里的解决方案（[Ruby On Rails 3.1 - 资产管道 - 资产渲染两次](https://stackoverflow.com/questions/8170039/ruby-on-rails-3-1-assets-pipeline-assets-rendered-twice)），但它不适用于我的场景，如下所示：

布局：

```
<!DOCTYPE html>
<html>
<head>...</head>
<body>
...
<!-- including :application -->
<%= javascript_include_tag :application %>
<!-- yielding :body_script -->
<%=  yield :body_script %>
</body>
</html> 
```

然后，在“用户”视图中：

```
<%= content_for :body_script do %>
    <%= javascript_include_tag 'users' %>
<% end %>
...
...
... 
```

我的 javascript 依赖项是：

*   application.js “需要” jquery、bootstrap 和 self
*   users.js “需要” worker_interface.js
*   worker_interface.js “需要” jquery、淘汰赛和应用程序

当“用户”视图被渲染时，**我在 body 的末尾得到了重复的 jquery 和 application.js**，其中一个是因为 被渲染的，`javascript_include_tag :application`另一个是因为 被渲染的`yield :body_script`，就像这样：

```
<!-- including :application -->
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/bootstrap.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script>
<!-- yielding :body_script -->
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/knockout.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script>
<script src="/assets/worker_interface.js?body=1" type="text/javascript"></script>
<script src="/assets/users.js?body=1" type="text/javascript"></script> 
```

我知道我在这里有多余的依赖项，因为我要求不止一次（间接地）包含 jquery 和应用程序。但是，**Rails 不应该保证不会呈现重复的文件**吗？**我仍然可以保留“冗余”依赖项并且只渲染一次文件吗**吗？

顺便说一句，我使用的是 Rails 版本 3.2.9。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:21:54.877

> Rails 不应该保证不会呈现重复的文件吗？我仍然可以保留“冗余”依赖项并且只渲染一次文件吗？

简单的回答：没有

资产是预编译的，因此在生产中是“静态的”。您可以通过多种方式包含资产。因此，rails 无法“知道”在渲染页面的上下文中应该删除哪些文件。

您需要确保没有重复。

# apache - 如何将 Apache 文档根目录指向 Ubuntu 中的特定文件夹？

> ID：14962942
> 
> 赞同：12
> 
> 时间：2013-02-19T16:50:18.770
> 
> 标签：apache, ubuntu

我有一个根指向 /var/www 的站点 我在 /var/www 下设置了两个文件夹

1.  /var/www/旧
2.  /var/www/新

对于旧文件夹，我使用以下内容拒绝任何访问：

```
touch /var/www/old/.htaccess && echo deny from all >> /var/www/old/.htaccess 
```

我现在希望服务器将根目录指向 /var/www/new，这样当人们访问[http://example.com](http://example.com)时，/var/www/new 中的内容就会生效，我该怎么办？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-19T20:09:38.677

在 Ubuntu 中，Apache 配置位于**/etc/apache2**。应该有两个文件夹，**sites-available**和**sites-enabled**。在启用站点的内部是指向站点可用配置文件的符号链接。

您只需在激活的配置中更改文档根目录。那可能是**/etc/apache2/sites-enabled/000-default**

查看**DocumentRoot**并将其更改为**/var/www/new**，然后重新加载您的 apache。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T16:54:48.403

很大程度上取决于您的 apache 服务器的配置方式。

我没有 Ubuntu 机器，但您正在寻找的是 DocumentRoot 指令。在基于 RedHat 的机器上，它通常位于 /etc/httpd/conf/httpd.conf 中，但如果内存服务于基于 Debian 的系统，则使用 apache 而不是 httpd。

如果这不起作用，请务必检查 /etc/httpd/conf.d，因为那里的文件是动态加载的。

希望这可以帮助 ：）

# umbraco - 使用 Umbraco 的自定义网址

> ID：14962943
> 
> 赞同：2
> 
> 时间：2013-02-19T16:50:22.863
> 
> 标签：umbraco

我正在创建一个使用 Umbraco 6 制作的博客，并且我想自定义网址。

当我创建博客帖子时，帖子按年/月/日结构组织，帖子的 url 是 blog.com/2013/2/19/title.aspx。

我想保留文件夹组织，但我想将 url 更改为 blog.com/title.aspx

那可能吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T17:22:00.503

一种方法是使用[umbracoUrlAlias](http://our.umbraco.org/wiki/reference/umbraco-best-practices/umbracourlalias)属性。在发布时，您可以将 umbracoUrlAlias 设置为标题。您可能希望包含一些确保 url 唯一的逻辑。如果存在一个而不是 NiceUrl，您还必须修改导航宏以使用 umbracoUrlAlias。

# c# - Word 互操作错误：80040154 类未注册

> ID：14962954
> 
> 赞同：0
> 
> 时间：2013-02-19T16:50:52.537
> 
> 标签：c#, office-interop

关于这个错误有很多问题，但我找不到适合我的答案。我正在使用 word interop，并且在我的开发机器上它可以工作。当我进行发布构建并运行它时，我收到了这个错误；

System.Runtime.InteropServices.COMException：检索具有 CLSID {...} 的组件的 COM 类工厂失败，原因是以下错误：80040154 未注册类。

我尝试过的解决方案是将项目属性更改为发布到 64 位 CPU。构建服务器是 64 位环境，Windows 2008。

接下来我应该尝试什么？我应该将项目属性重置为任何 CPU 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:58:57.687

更改启动可执行文件上的构建设置以制作 x86 版本（32 位）。Office 仅提供 32 位版本（直到最近），因此您很可能正在运行 32 位版本的 Office。您引用的任何剩余程序集都可能是 ANY_CPU。它们将作为 32 位加载到 32 位进程中或将 64 位加载到 64 位进程中。ANY_CPU 可执行文件将在 64 位系统上加载为 64 位，在 32 位系统上加载为 32 位。这将不允许您在 64 位系统上访问 32 位办公室安装。

# html - 在 uiwebview 顶部画一条线，即在 uiwebview 顶部自定义绘图

> ID：14962962
> 
> 赞同：0
> 
> 时间：2013-02-19T16:51:11.290
> 
> 标签：html, ios, uiwebview, drawing

如何在 uiwebview 上画一条线？

在我的应用程序中，当用户在 uiwebview 上触摸手指并移动手指（底层 html 内容是纯文本且不可点击）时，我想要画一条线。

这可能吗？Apple 是否允许在 uiwebview 之上进行自定义绘图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T17:06:00.903

You can put a `UIView` above the `UIWebView` with `frame` equal to the `UIWebView` and set its background color to `clearColor`. Then draw on it.

# android - 放置两个图像以占据整个屏幕

> ID：14962966
> 
> 赞同：0
> 
> 时间：2013-02-19T16:51:38.607
> 
> 标签：android, view, android-imageview

我想在各自的图像视图中放置两个图像，以便它们占据整个屏幕。到目前为止，我只到了这里:(（要添加正在测试的设备，我使用 S3）

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ImageView
    android:id="@+id/white"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:onClick="onClick"
    android:src="@drawable/up" />

    <ImageView                
    android:id="@+id/blue"
    android:layout_height="fill_parent"
            android:layout_width="fill_parent"
            android:src="@drawable/blue"
            android:onClick="onClick"
            android:layout_below="@id/white"/>

</RelativeLayout> 
```

图像为 1080 X 1920 并缩放至屏幕。问题是下面的图像缩放不正确或者它们没有正确连接。我在顶部和底部有一个黑色区域

抱歉，图片大小不一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:24:07.783

您可以通过添加 weightSum 来实现。替换此 xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity1" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical"
        android:weightSum="1" >

        <ImageView
            android:id="@+id/white"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight=".5"
            android:onClick="onClick"
            android:src="@drawable/up" />

        <ImageView
            android:id="@+id/blue"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_below="@id/white"
            android:layout_weight=".5"
            android:onClick="onClick"
            android:src="@drawable/blue" />
    </LinearLayout>

</RelativeLayout> 
```

它看起来像： ![在此处输入图像描述](../Images/d054fbbfe26fdaacc4eea09675311378.png) 更多帮助。请添加评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T16:55:16.537

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:weightSum="2" >

<ImageView
    android:id="@+id/white"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:onClick="onClick"
    android:src="@drawable/up" />

<ImageView
    android:id="@+id/blue"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:onClick="onClick"
    android:src="@drawable/blue" />

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:55:30.957

您应该使用带有`layout_weight`set 的 LinearLayout：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
<ImageView
    android:id="@+id/white"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:onClick="onClick"
    android:src="@drawable/up" />

<ImageView                
    android:id="@+id/blue"
    android:layout_height="0dp"
    android:layout_width="fill_parent"
    android:layout_weight="1"
    android:src="@drawable/blue"
    android:onClick="onClick"
    android:layout_below="@id/white"/>
</LinearLayout> 
```

对于缩放问题，我建议查看[scaleType](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)

# c# - 如何使用异步来提高 WinForms 性能？

> ID：14962969
> 
> 赞同：26
> 
> 时间：2013-02-19T16:51:48.650
> 
> 标签：c#, asynchronous, tesseract

我正在执行一些处理器繁重的任务，每次我开始执行该命令时，我的 winform 都会冻结，而在任务完成之前我什至无法移动它。我使用了微软的相同程序，但似乎没有任何改变。

我的工作环境是带有 .net 4.5 的 Visual Studio 2012

```
private async void button2_Click(object sender, EventArgs e)
{
    Task<string> task = OCRengine();          
    rtTextArea.Text = await task;
}

private async Task<string> OCRengine()
{
    using (TesseractEngine tess = new TesseractEngine(
           "tessdata", "dic", EngineMode.TesseractOnly))
    {
        Page p = tess.Process(Pix.LoadFromFile(files[0]));
        return p.GetText();
    }
} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-19T16:56:26.097

是的，您仍在*UI 线程上完成*所有工作。使用`async`不会自动将工作卸载到不同的线程上。你可以这样做：

```
private async void button2_Click(object sender, EventArgs e)
{
    string file = files[0];
    Task<string> task = Task.Run(() => ProcessFile(file));       
    rtTextArea.Text = await task;
}

private string ProcessFile(string file)
{
    using (TesseractEngine tess = new TesseractEngine("tessdata", "dic", 
                                                      EngineMode.TesseractOnly))
    {
        Page p = tess.Process(Pix.LoadFromFile(file));
        return p.GetText();
    }
} 
```

的使用`Task.Run`将意味着`ProcessFile`（繁重的工作）在不同的线程上执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T23:21:29.837

您也可以通过在新线程中启动您的任务来做到这一点。只需使用 Thread.Start 或 Thread。参数化ThreadStart

请参阅这些供您参考：

[http://msdn.microsoft.com/en-us/library/system.threading.parameterizedthreadstart.aspx](http://msdn.microsoft.com/en-us/library/system.threading.parameterizedthreadstart.aspx)

[带参数启动线程](https://stackoverflow.com/questions/11465076/start-thread-with-parameters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-17T05:22:22.623

您可以使用*BackgroundWorker*组件。

# tsql - SQL查询，如果值为null则返回1

> ID：14962970
> 
> 赞同：76
> 
> 时间：2013-02-19T16:51:51.593
> 
> 标签：tsql, null, ssms

我有一个查询返回我们系统中设置的汇率值。并非每个订单都有汇率 (currate.currentrate)，因此它返回空值。

我可以让它返回 1 而不是 null 吗？

类似 if 语句的东西可能：

```
 if isnull(currate.currentrate) then 1 else currate.currentrate 
```

下面是我的查询。我非常感谢您的帮助！

```
 SELECT     orderhed.ordernum, orderhed.orderdate, currrate.currencycode,  currrate.currentrate
 FROM         orderhed LEFT OUTER JOIN
                  currrate ON orderhed.company = currrate.company AND orderhed.orderdate = currrate.effectivedate 
```

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2013-02-19T16:53:18.537

您可以使用`CASE`语句。

```
SELECT 
    CASE WHEN currate.currentrate IS NULL THEN 1 ELSE currate.currentrate END
FROM ... 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-02-19T16:54:11.953

您可以使用[`COALESCE`](http://msdn.microsoft.com/en-us/library/ms190349.aspx)：

```
SELECT  orderhed.ordernum, 
    orderhed.orderdate, 
    currrate.currencycode,  
    coalesce(currrate.currentrate, 1) as currentrate
FROM orderhed 
LEFT OUTER JOIN currrate 
    ON orderhed.company = currrate.company 
    AND orderhed.orderdate = currrate.effectivedate 
```

甚至[`IsNull()`](http://msdn.microsoft.com/en-us/library/ms184325.aspx)：

```
SELECT  orderhed.ordernum, 
    orderhed.orderdate, 
    currrate.currencycode,  
    IsNull(currrate.currentrate, 1) as currentrate
FROM orderhed 
LEFT OUTER JOIN currrate 
    ON orderhed.company = currrate.company 
    AND orderhed.orderdate = currrate.effectivedate 
```

这是一篇帮助在`COALESCE`和之间做出决定的文章`IsNull`：

[http://www.mssqltips.com/sqlservertip/2689/deciding-between-coalesce-and-isnull-in-sql-server/](http://www.mssqltips.com/sqlservertip/2689/deciding-between-coalesce-and-isnull-in-sql-server/)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-05-31T16:31:32.273

```
SELECT 
    ISNULL(currate.currentrate, 1)  
FROM ... 
```

比获胜答案更简洁，并且做同样的事情

[https://msdn.microsoft.com/en-us/library/ms184325.aspx](https://msdn.microsoft.com/en-us/library/ms184325.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-05-16T11:18:50.023

a) 如果你想要 0 当值为 null

```
SELECT isnull(PartNum,0) AS PartNumber, PartID
FROM Part 
```

b) 如果你想要 0 当 value 为 null 否则 1

```
SELECT 
  (CASE
    WHEN PartNum IS NULL THEN 0
    ELSE 1
  END) AS PartNumber,
  PartID
FROM Part 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-19T16:55:04.607

```
SELECT orderhed.ordernum, orderhed.orderdate, currrate.currencycode,  

case(currrate.currentrate) when null then 1 else currrate.currentrate end

FROM orderhed LEFT OUTER JOIN currrate ON orderhed.company = currrate.company AND orderhed.orderdate = currrate.effectivedate 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T16:56:03.530

尝试如下...

```
CASE 
WHEN currate.currentrate is null THEN 1
ELSE currate.currentrate
END as currentrate 
```

# jquery - 适用于所有元素的验证规则

> ID：14962973
> 
> 赞同：3
> 
> 时间：2013-02-19T16:52:03.613
> 
> 标签：jquery, jquery-validate, unobtrusive-validation

我需要通过`id`not将验证规则分配给特定的输入元素`name`。

为此，我正在执行以下代码：

```
 $("#cvc").rules("add", { required: true, validateCvc: true });
   $("#cardNumber").rules("add", 
     { creditcard: true, messages: { creditcard: "Invalid Card Number" } }); 
```

但是，这实际上是将规则分配给表单上的所有输入。我可以通过记录附加到不同输入的规则来验证这一点：

```
 console.log($("#name").rules()); 
```

输出：

```
Object {required: true, validateCvc: true, creditcard: true} 
```

### 更新

看起来这可能与 jQuery Validate Unobtrusive 插件有关，我开始发现它比它的价值更麻烦。设置验证的代码`validate`在我添加规则之前调用：

```
function validationInfo(form) {
    var $form = $(form),
        result = $form.data(data_validation),
        onResetProxy = $.proxy(onReset, form);

    if (!result) {
        result = {
            options: {  // options structure passed to jQuery Validate's validate() method
                errorClass: "input-validation-error",
                errorElement: "span",
                errorPlacement: $.proxy(onError, form),
                invalidHandler: $.proxy(onErrors, form),
                messages: {},
                rules: {},
                success: $.proxy(onSuccess, form)
            },
            attachValidation: function () {
                $form
                    .unbind("reset." + data_validation, onResetProxy)
                    .bind("reset." + data_validation, onResetProxy)
                    .validate(this.options);
            },
            validate: function () {  // a validation function that is called by unobtrusive Ajax
                $form.validate();
                return $form.valid();
            }
        };
        $form.data(data_validation, result);
    }

    return result;
} 
```

### 更新 2

这是一个回购 - [http://jsfiddle.net/benfosterdev/emZB8/](http://jsfiddle.net/benfosterdev/emZB8/)

您可以在控制台中看到，这显然是为这两个字段设置了“必需”规则，即使它没有在第二个字段中指定。

如果您想直接使用验证插件，您最好删除对不显眼插件的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-17T20:26:59.613

**如果输入没有唯一的名称属性，jQuery Validate 将不起作用。**

我浪费了大约 2 个小时来完成这项工作。当我没有正确使用他们的插件时，为什么开发人员不会抛出错误？！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T17:10:56.283

您发布的代码无法满足您的要求。提供一个简洁的工作演示来展示。

请参阅此演示，其中`rule`仅适用于指定元素。

[http://jsfiddle.net/tyCvL/](http://jsfiddle.net/tyCvL/)

**jQuery** :

```
$(document).ready(function () {

    $('#myform').validate({  // initialize the plugin
        // options 
    });

    $("#field1").rules("add", { required: true });

}); 
```

**HTML**：

```
<form id="myform">
    <input type="text" name="field1" id="field1"/>
    <input type="text" name="field2" id="field2"/>
</form> 
```

* * *

**编辑：**

根据上面的示例，该`name`属性不是可选的。jQuery Validate 插件将始终要求在所有情况和案例`name`的所有元素上都存在一个属性。`input`

**OP 的 jsFiddle 已修复：http: [//jsfiddle.net/emZB8/5/](http://jsfiddle.net/emZB8/5/)**

```
<form id="myform">
    <input type="text" name="field1" id="field1"/>
    <input type="text" name="field2" id="field2"/>
</form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-05T09:30:07.120

我有一个类似的问题，其中一个字段的验证将应用于所有其他字段。将“debug”设置为 true 后，jquery validate 开始在控制台中抛出“'field' has no name assigned”。我在那些有问题的字段上设置了 name 属性，瞧……问题解决了。

所以我猜 jquery validate 不喜欢未命名的字段。

# javascript - PhoneGap 文件删除不起作用

> ID：14962974
> 
> 赞同：4
> 
> 时间：2013-02-19T16:52:06.277
> 
> 标签：javascript, html, xcode, cordova

我正在构建一个基本的应用程序，它具有相当多的 PhoneGap 功能，因为我试图确定它可以/不能做什么。我已经到了要删除已在应用程序上下载的文件的阶段，但它不起作用。我使用的大部分代码来自[http://docs.phonegap.com/en/2.4.0/cordova_file_file.md.html#FileEntry](http://docs.phonegap.com/en/2.4.0/cordova_file_file.md.html#FileEntry)；

```
 function removefile(){
        fileSystem.root.getFile("readme.txt", {create: false, exclusive: false}, gotRemoveFileEntry, fail);

    }

    function gotRemoveFileEntry(fileEntry){
        console.log(fileEntry);
        fileEntry.file(gotFile, fail);
        entry.remove(success, fail);
    }

    function success(entry) {
        console.log("Removal succeeded");
    }

    function fail(error) {
        console.log("Error removing file: " + error.code);
    } 
```

我用 HTML 调用它；

```
 <button onclick="removefile();">remove file</button> 
```

代码有问题吗？我看不到它。

顺便说一句，我正在为 iOS 编码并在 Xcode 中使用 JavaScript、HTML 和 PhoneGap/Cordova。

我对 iPhone 开发相当陌生，所以任何帮助都会非常感谢:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T19:16:07.447

Your code is slightly off. Try:

```
function removefile(){
    fileSystem.root.getFile("readme.txt", {create: false, exclusive: false}, gotRemoveFileEntry, fail);
}

function gotRemoveFileEntry(fileEntry){
    console.log(fileEntry);
    fileEntry.remove(success, fail);
}

function success(entry) {
    console.log("Removal succeeded");
}

function fail(error) {
    console.log("Error removing file: " + error.code);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-07T04:43:28.400

旧条目。API可能已经改变，但我能够这样做：

```
function success(entry) {
  console.log("Removal succeeded");
}

function fail(error) {
  console.log("Error removing file: " + error.code);
}

resolveLocalFileSystemURL(cordova.file.dataDirectory + 'assets/icons/test.png', function(entry) {
  console.log(entry);
  entry.remove(success, fail);
}) 
```

# git - 运行 git svn fetch 时以错误的路径获取新的 SVN 分支的文件

> ID：14962978
> 
> 赞同：0
> 
> 时间：2013-02-19T16:52:21.390
> 
> 标签：git, branch, git-svn, fetch

不久前，我有一个使用标准布局从 SVN 克隆的 git 存储库。（它是用 git svn init 和 git svn fetch 完成的）。现在我使用的是 git 1.7.9。我的 svn-remote 配置部分如下所示：

```
[svn-remote "svn"]
        url = https://myhost/svn/myProject
        fetch = trunk:refs/remotes/trunk
        branches = branches/*:refs/remotes/*
        tags = tags/*:refs/remotes/tags/* 
```

最初提取的所有分支都正常工作，后续提取在这些分支和主干上也是正确的。每个分支下的目录结构如下所示：

```
subProject1\src\myPackage
subProject2\src\
subProject3\src\ 
```

现在创建了一个名为 2_7_1 的新分支，它与所有其他分支和主干的目录结构相匹配。

现在，当我运行*git svn fetch*时，它开始从 r1 获取每个修订版，而不是仅从从主干创建 2_7_1 分支的修订版中获取它。原因似乎是它假设：*src\myPackage*目录结构而不是*subProject1\src\myPackage*，因此它开始获取从 r1 开始的所有修订。

当我在浏览器中浏览 SVN 存储库时，我发现目录结构没有任何区别。我注意到只有一个区别，新分支称为 2_7_1@18813（18813 是新分支的起始修订号），其中所有其他分支不包含修订，只有分支名称。

我不想使用此处提供的解决方案：[How do I tell git-svn about a remote branch created after I fetch the repo?](https://stackoverflow.com/questions/296975/how-do-i-tell-git-svn-about-a-remote-branch-created-after-i-fetched-the-repo) ，因为它会失去主干和 2_7_1 分支的共同父级。

***编辑：*** 在完成完整的*git svn fetch*之后，我很清楚我的 git svn 看到了两个分支：2_7_1 和 2_7_1@18813。2_7_1@18813 是从修订版 #1 中获取的。这弄乱了我之前跟踪 SVN 主干的主分支。

现在我的分支结构看起来像这样（一团糟）：

```
------------------------------------------- X -- Y -- Z  ==  masterNew/trunk

-- A -- B -- C -- D -- E -- F -- G ----  == 2_7_1@18813
                                    \  \
                                     \  \ - J - K - L == master (old trunk)
                                      \
- A' - B' - C' - D' - E' - F' - G' -- H -- I == 2_7_1 
```

***编辑#2：*** 使用 git svn clone 对 SVN 存储库进行完整克隆后，问题仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:10:04.060

You could branch from the common parent into the 2_7_1 branch, then rig that branch to git-svn with the instructions from [How do I tell git-svn about a remote branch created after I fetched the repo?](https://stackoverflow.com/questions/296975/how-do-i-tell-git-svn-about-a-remote-branch-created-after-i-fetched-the-repo)

# c++ - 为什么未压缩视频的 cv::VideoCapture 会崩溃？

> ID：14962985
> 
> 赞同：2
> 
> 时间：2013-02-19T16:52:42.590
> 
> 标签：c++, opencv, video-capture

我有一些在大多数情况下都可以使用的标准视频阅读代码。但是，当我尝试从我拥有的一组特定视频中读取帧时，我收到了访问冲突错误。这些视频的独特之处在于其数据速率超过 20,000 kbps，而大多数压缩视频低于 1000 kbps。为什么这是一个问题，我怎样才能绕过它或抓住它？

这是一个简单的代码示例：

```
cv::VideoCapture capture;
capture.open(video_filename);

if (!capture.isOpened())
{
    // throw an error
}

cv::Mat frame;
capture >> frame; // crashes here. 
```

# asp.net-mvc - EF 模型首先使用 MVC 存储库模式

> ID：14962992
> 
> 赞同：1
> 
> 时间：2013-02-19T16:53:08.577
> 
> 标签：asp.net-mvc, entity-framework, repository-pattern, ef-model-first

尝试使用 EF 和模型优先方法创建 MVC 项目。

为了以 Web 和数据部分松散耦合的方式实现它，我正在尝试实现存储库模式，但是，在阅读了许多文章之后，我仍然试图掌握我的 Repository 接口应该返回哪些对象或它们如何返回应该绑定/映射到我的 MVC 项目中的“M”模型。

这是我要问的一个非常简单的例子。

```
//Repository Interface
public interface IMemberRepository
{
    Member GetById(int id);
    IEnumerable<Member> FindByName(string name);
}

//Repository Interface Implementation
public class MemberRepository : IMemberRepository
{
    //My DB Context object created by EF
    private MyContainer context;

    public MemberRepository(MyContainer context)
    {
        this.context = context;
    }

    public Member GetById(int id)
    {
        return context.Members.SingleOrDefault(x => x.Id == id);
    }

    public IEnumerable<Member>  FindByName(string name)
    {
        return context.Members.Find(x => x.name == name);
    }

} 
```

因此，使用 Ninject 作为我的 DI 框架，我可以从我的控制器中调用它，如下所示：

```
public class GroupsController : Controller
{
    public ViewResult Find(string name)
    {
        IMemberRepository repo = 
          ObjectFactory.Instance.CreateInstance<IMemberRepository>();
        return repo.FindByName(name);
    }
 } 
```

在这一点上，我只是不理解我的成员对象（来自 EF 模型）应该如何绑定/映射到我的“MVC”成员模型对象。看来我一定是缺少某种映射层，或者我完全偏离了轨道。如果我要直接引用我的 EF 生成的类，那感觉就像我在否定使用接口和 DI 框架的意义。在这一点上的任何建议或方向将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:00:11.090

您的`IMemberRepository`界面及其实现`MemberRepository`对我来说很合适。这也是我构建数据库代码的方式。

转到 MVC 世界，我将创建您从数据模型中填充的视图模型。这将使您可以灵活地在视图中添加所需的任何属性或附加属性。

这将是工作流程：

1.  从存储库中获取对象
2.  使用存储库对象中的所有数据填充视图模型对象
3.  将视图模型从控制器返回到您的视图

# ruby-on-rails-3 - 工作没有使用hirefire在heroku上触发

> ID：14962993
> 
> 赞同：1
> 
> 时间：2013-02-19T16:53:09.923
> 
> 标签：ruby-on-rails-3, delayed-job, hirefire

我正在使用 gem "delayed_job_active_record" 和 heroku 上的雇佣火来在后台运行作业。我还使用我的 heroku 帐户设置了 heroku 环境变量。我在 gem 文件中的序列如下

```
 gem 'delayed_job_active_record'
   gem 'daemons'
   gem 'hirefire' 
```

它也在当地环境中进行开发和生产。但是工作没有从延迟的工作表中触发 heroku。首先，我尝试在 intilizer 中没有配置文件hirefire.rb，但没有成功。在我添加并将此代码放在下面之后。

```
 HireFire.configure do |config|

             if Rails.env.production?
              config.max_workers = 5 # default is 1
              config.min_workers = 0 # default is 0
              config.job_worker_ratio = [
               {:jobs => 1, :workers => 1},
               {:jobs => 15, :workers => 2},
               {:jobs => 35, :workers => 3},
               {:jobs => 60, :workers => 4},
               {:jobs => 80, :workers => 5}
              ]
        end
      end 
```

但没有成功。虽然hirefire也正在加载，请参见下面的屏幕截图 ![在此处输入图像描述](../Images/90b1e9283d82957a6b76bfa5c73486be.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:30:24.867

可能不应该在`Rails.env.production?`那里检查并把它放进去`config/environments/production.rb`。

要查看如何在 Heroku 中设置延迟作业活动记录，请阅读以下内容：[https ://devcenter.heroku.com/articles/delayed-job](https://devcenter.heroku.com/articles/delayed-job)

# delphi - 跨库事务监控

> ID：14962997
> 
> 赞同：3
> 
> 时间：2013-02-19T16:53:15.397
> 
> 标签：delphi, transactions, interbase

我对 Interbase 7.5 中的事务有一个非常奇怪的问题，它似乎被卡住了。

我可以使用 IBConsole 跟踪问题 -> 右键单击​​ DB -> Performance Monitor -> Transactions

通常这个列表应该只显示几个活跃的事务。但是当我启动我的应用程序时，我得到了数百个活动事务（使用 Delphi 7 Interbase 组件的 apache 网络服务器的 Web 模块，例如 IBQuery、IBTransaction ......）

事务类型总是被列为快照，如果这是相关的。

我已经对所有 sql 语句进行了三次检查，但找不到任何会产生此类问题的东西......

有没有办法获取特定事务的 sql 语句？

非常欢迎任何其他关于如何找到此类问题的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T17:07:47.687

活动 IBX 数据集始终需要活动事务。如果您没有活动数据集，请不要忘记提交所有活动事务。

如果您有活动的数据集，您可以将所有组件配置为使用相同的对象，您还可以通过和属性`TIbTransaction`配置唯一的 TIbTransaction 以在空闲超时期限后提交或回滚。`IdleTimer``DefaultAction`

终止事务（通过手动或自动提交或回滚）将关闭所有链接的数据集（`TIBQuery`等`TIBTable`）。

您可能想使用`CommitRetaining`or`RollbackRetaining`方法在不关闭相关数据集的情况下*终止*事务，但这可能会影响服务器的性能，我的建议是始终避免使用它。

如果你想改进你的应用程序，你应该考虑改变你的数据库连接层或引入一个内存中的数据集`IBX`，例如 Delphi 的`TClientDataSet`，它允许你检索数据并将其保留在内存中，同时关闭所有底层数据集（和事务），同时允许您使用传统的插入/追加/编辑/删除方法来修改数据，然后在新的短时事务中将更改应用到数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T15:45:50.580

> 有没有办法获取特定事务的 sql 语句？

是的，您可以从 SELECT 中选择`TMP$STATEMENTS WHERE TRANSACTION_ID = ...`。这是从记忆中，但应该让你开始。

在 IB Performance Monitor 中，您可以使用工具栏上的按钮从报表选项卡中找到交易。不记得您是否可以在该应用程序中采用其他方式。好久没写了！